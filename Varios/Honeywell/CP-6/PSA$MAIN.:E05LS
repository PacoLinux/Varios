VERSION E05

PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:1    
        1        1        /*M* PSA$MAIN  Main STATS modules                                             */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,SQB,AND,ENI=0,SDI=3,CSI=0,ECI=0,IND=0,IAD=3,MOC,MEC,CLM=0,MCL=1,EXM=0,NTB
                 7         */
        8        8        PSA$MAIN: PROC MAIN;
        9        9
       10       10        %INCLUDE PS_DATA_R;
       11     5306        %INCLUDE PS_PERR_C;
       12     5337
       13     5338    1   DCL PSE$GRIPE ENTRY (5);
       14     5339    1   DCL PSA$INIT ENTRY;
       15     5340    1   DCL PSA$RESTART ENTRY;
       16     5341    1   DCL PSA$INPUT ENTRY;
       17     5342    1   DCL PSA$DOIT ENTRY;
       18     5343
       19     5344    1      CALL PSA$INIT;
       20     5345
       21     5346    1      REMEMBER RESTART IN PS_BAILOUT;
       22     5347
       23     5348    2   RESTART: DO FOREVER;
       24     5349
       25     5350    2         CALL PSA$RESTART;
       26     5351
       27     5352    2         CALL PSA$INPUT;
       28     5353
       29     5354    2         CALL PSA$DOIT;
       30     5355
       31     5356    2      END;
       32     5357
       33     5358    1   END PSA$MAIN;
       34     5359        %EOD;

PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:2    
--  Include file information  --

   PS_PERR_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure PSA$MAIN.

   Procedure PSA$MAIN requires 18 words for executable code.
   Procedure PSA$MAIN requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:3    

 Object Unit name= PSA$MAIN                                   File name= PSA$MAIN.:E05TOU
 UTS= JUL 30 '97 04:25:36.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$DO
    2   DCB   even  none     0      0  M$SI
    3   DCB   even  none     0      0  F$LOG
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$HLPCG
    6  RtLbCm even  none    30     36  PS_FDS
    7  RtLbCm even  none    32     40  PS_SELECT_RPN
    8  RtLbCm even  none    17     21  PS_STATS_RPN
    9  RtLbCm even  none    34     42  PS_STATS_BUCKET
   10   Proc  even  none    18     22  PSA$MAIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes            yes      Main       0  PSA$MAIN
PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:4    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 PSA$INIT
         yes           Std       0 PSA$RESTART
         yes           Std       0 PSA$INPUT
         yes           Std       0 PSA$DOIT
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$LO                                  M$DO                                  M$SI
     F$LOG                                 M$ME                                  M$HLPCG
     PS_BAILOUT                            PS_BUFFER                             PS_STATS$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:5    


        1        1        /*M* PSA$MAIN  Main STATS modules                                             */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* PLM=3,SQB,AND,ENI=0,SDI=3,CSI=0,ECI=0,IND=0,IAD=3,MOC,MEC,CLM=0,MCL=1,EXM=0,NTB
                 7         */
        8        8        PSA$MAIN: PROC MAIN;

      8 10 000000   000000 700200 xent  PSA$MAIN     TSX0  ! X66_MAUTO
        10 000001   000004 000000                    ZERO    4,0

        9        9
       10       10        %INCLUDE PS_DATA_R;
       11     5306        %INCLUDE PS_PERR_C;
       12     5337
       13     5338    1   DCL PSE$GRIPE ENTRY (5);
       14     5339    1   DCL PSA$INIT ENTRY;
       15     5340    1   DCL PSA$RESTART ENTRY;
       16     5341    1   DCL PSA$INPUT ENTRY;
       17     5342    1   DCL PSA$DOIT ENTRY;
       18     5343
       19     5344    1      CALL PSA$INIT;

   5344 10 000002   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000003   000000 701000 xent               TSX1    PSA$INIT
        10 000004   000000 011000                    NOP     0

       20     5345
       21     5346    1      REMEMBER RESTART IN PS_BAILOUT;

   5346 10 000005   000010 635000 10                 EAA     RESTART
        10 000006   000000 452400 xsym               STP2    PS_BAILOUT
        10 000007   000001 755000 xsym               STA     PS_BAILOUT+1

PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:6    
       22     5347
       23     5348    2   RESTART: DO FOREVER;

   5348 10 000010                       RESTART      null
       24     5349
       25     5350    2         CALL PSA$RESTART;

   5350 10 000010   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000011   000000 701000 xent               TSX1    PSA$RESTART
        10 000012   000000 011000                    NOP     0

       26     5351
       27     5352    2         CALL PSA$INPUT;

   5352 10 000013   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000014   000000 701000 xent               TSX1    PSA$INPUT
        10 000015   000000 011000                    NOP     0

       28     5353
       29     5354    2         CALL PSA$DOIT;

   5354 10 000016   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000017   000000 701000 xent               TSX1    PSA$DOIT
        10 000020   000000 011000                    NOP     0

       30     5355
       31     5356    2      END;

   5356 10 000021   000010 710000 10                 TRA     RESTART
       32     5357
       33     5358    1   END PSA$MAIN;
       34     5359        %EOD;

PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:7    
--  Include file information  --

   PS_PERR_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure PSA$MAIN.
PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:8    

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 PS_BAILOUT                 0-0-0/c CHAR(140)   r     1 PS_BUFFER
     0-0-0/w PTR         r     1 PS_STATS$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$LO                       0-0-0/c ASTR(9)     r     1 TEXTC


   Procedure PSA$MAIN requires 18 words for executable code.
   Procedure PSA$MAIN requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:9    
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=PSA$MAIN File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:10   
          MINI XREF LISTING

PSA$DOIT
      5342**DCL-ENT  5354--CALL
PSA$INIT
      5339**DCL-ENT  5344--CALL
PSA$INPUT
      5341**DCL-ENT  5352--CALL
PSA$RESTART
      5340**DCL-ENT  5350--CALL
PS_BAILOUT
      4839**DCL      5346<<REMEMBR
PS_BUFFER
      4841**DCL      4876--DCLINIT  4878--DCLINIT
PS_COLLECT.CALCNT
      4996**DCL      4996--REDEF
PS_COLLECT.USRSRV
      4993**DCL      4994--REDEF
PS_HLPCGBUF.DSPMSK
      5253**DCL      5259--REDEF
PS_HLPCGBUF.SLCMSK
      5294**DCL      5301--REDEF
PS_OLD_COLLECT.CALCNT
      5000**DCL      5001--REDEF
PS_OLD_COLLECT.USRSRV
      4998**DCL      4998--REDEF
PS_STATS$
      5002**DCL      5004--IMP-PTR
RESTART
      5348**LABEL    5346--REMEMBR
TEXTC.LEN
      5006**DCL      5006--IMP-SIZ

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:11   
       35        1        /*T***********************************************************/
       36        2        /*T*                                                         */
       37        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       38        4        /*T*                                                         */
       39        5        /*T***********************************************************/
       40        6        PSA$INIT: PROC;
       41        7
       42        8        %INCLUDE PS_DATA_R;
       43     5304        %INCLUDE CP_6_SUBS;
       44     5844        %INCLUDE CP_6;
       45     5925        %INCLUDE F$DCB;
       46     5974        %INCLUDE F_ERRORS_C;
       47     6214        %INCLUDE B$JIT;
       48     6504        %INCLUDE PS_PERR_C;
       49     6535        %INCLUDE XU_PERR_C;
       50     6726        %INCLUDE XU_MACRO_C;
       51     9832        %INCLUDE XUR_ENTRY;
       52     9864        %INCLUDE XUH_MACRO_C;
       53     9948        %INCLUDE XUF_ENTRY;
       54     9956
       55     9957        %B$TCB (STCLASS="BASED(B$TCB$)");
       56     9960
       57     9961        %B$EXCFR;
       58     9979
       59     9980        %B$ALT;
       60     9988
       61     9989        %XUR_INIT (ABORT=PSA$BREAK,
       62     9990         WORK=XUR_WORK_AREA);
       63    10089
       64    10090    1   DCL XUR_WORK_AREA(0:1023) UBIN WORD STATIC DALIGNED;
       65    10091
       66    10092
       67    10093        %XUH_PARAM (PROCNAME=STATSNAME,
       68    10094         OUTDCB1=M$DO,
       69    10095         OUTDCB2=M$LO);
       70    10156
       71    10157        %VLP_NAME (FPTN=STATSNAME,
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:12   
       72    10158         NAME='STATS');
       73    10185
       74    10186        %FPT_READ (FPTN=READ_COMMAND,
       75    10187         DCB=M$SI,
       76    10188         BUF=PS_COMMAND,
       77    10189         WAIT=YES);
       78    10228
       79    10229        %FPT_WRITE (FPTN=ECHO_COMMAND,
       80    10230         DCB=M$LO,
       81    10231         WAIT=YES);
       82    10262
       83    10263        %FPT_CLOSE (FPTN=CLOSE_LO,
       84    10264         DCB=M$LO,
       85    10265         DISP=SAVE);
       86    10307
       87    10308        %FPT_CLOSE(FPTN=CLOSE_HLPCG,
       88    10309         STCLASS=STATIC,
       89    10310         DCB=M$HLPCG);
       90    10352
       91    10353        %FPT_DEVICE (FPTN=ZAP_HEADER,
       92    10354         DCB=M$LO,
       93    10355         HDR=ERASE);
       94    10373
       95    10374        %FPT_OPEN (FPTN=OPEN_LO,
       96    10375         HDR=ERASE,
       97    10376         DCB=M$LO);
       98    10485
       99    10486        %FPT_OPEN (FPTN=OPEN_SI,
      100    10487         DCB=M$SI,
      101    10488         FUN=IN);
      102    10597
      103    10598        %FPT_CLOSE (FPTN=CLOSE_LOGFILE,
      104    10599         DCB=F$LOG,
      105    10600         DISP=SAVE,
      106    10601         RELG=YES,
      107    10602         STCLASS="STATIC");
      108    10644
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:13   
      109    10645        %FPT_SINPUT;
      110    10682
      111    10683        %FPT_SMOUSE;
      112    10696
      113    10697        %FPT_OPEN (FPTN=OPEN_M$SI,
      114    10698         DCB=M$SI,
      115    10699         SCRUB=YES,
      116    10700         NAME=VLP_NAME,
      117    10701         ASN=FILE,
      118    10702         FUN=IN);
      119    10811
      120    10812        %FPT_CLOSE (FPTN=CLOSE_M$SI,
      121    10813         DCB=M$SI,
      122    10814         DISP=SAVE);
      123    10856
      124    10857        %VLP_NAME (NAME=':STATSSI');
      125    10884
      126    10885        %FPT_PRIV (FPTN=SET_PM_PRIV,
      127    10886         AUTH=YES,
      128    10887         PRIV=%PR_PM#);
      129    10902
      130    10903        %FPT_CORRES (FPTN=COMPARE_M$ME_AND_M$LO,
      131    10904         DCB1=M$ME,
      132    10905         DCB2=M$LO);
      133    10919
      134    10920        %FPT_INT (UENTRY=XUR$BREAK);
      135    10934
      136    10935        %FPT_FID (TEXTFID=NIL,
      137    10936         NAME=PS_FID_PARAMS.NAME@,
      138    10937         ACCT=PS_FID_PARAMS.ACCT@,
      139    10938         PASS=PS_FID_PARAMS.PASS@,
      140    10939         RES=PS_FID_PARAMS.RES@,
      141    10940         SN=PS_FID_PARAMS.SN@,
      142    10941         ASN=PS_FID_PARAMS.ASN@,
      143    10942         RESULTS=VLR_FID,
      144    10943         SNAME=YES,
      145    10944         SACCT=YES,
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:14   
      146    10945         SPASS=YES,
      147    10946         SRES=YES,
      148    10947         SSN=YES);
      149    10970        %VLR_FID;
      150    10989
      151    10990        %FPT_UNFID (TEXTFID=STATUS_FID,
      152    10991         NAME=PS_FILE_PARAMS.NAME@,
      153    10992         ACCT=PS_FILE_PARAMS.ACCT@,
      154    10993         RES=PS_FILE_PARAMS.RES@,
      155    10994         SN=PS_FILE_PARAMS.SN@,
      156    10995         ASN=PS_FILE_PARAMS.ASN@);
      157    11013
      158    11014        %FPT_TIME (FPTN=GET_TODAYS_DATE,
      159    11015         SOURCE=CLOCK,
      160    11016         DEST=LOCAL,
      161    11017         DATE=TODAYS_DATE);
      162    11036
      163    11037        %FPT_TIME (FPTN=GET_PS_TODAYS_DATE,
      164    11038         SOURCE=CLOCK,
      165    11039         DEST=EXT,
      166    11040         DATE=PS_TODAYS_DATE);
      167    11059
      168    11060        %FPT_TIME (FPTN=CONVERT_TO_UTS,
      169    11061         SOURCE=LOCAL,
      170    11062         DEST=UTS,
      171    11063         DATE=DATE_AREA.VECTOR_PORTION.REAL,
      172    11064         TIME=TIME_AREA);
      173    11083
      174    11084        %FPT_PROMPT (FPTN=SET_PROMPT,
      175    11085         DCB=M$UC,
      176    11086         VFC=NO);
      177    11114
      178    11115        %FPT_TRAP (FPTN=SET_TRAP_CONTROL,
      179    11116         ARITHMETIC=PSA$TRAPPED,
      180    11117         DIVIDE_CHECK=TRAP,
      181    11118         OVERFLOW=TRAP,
      182    11119         ERRORS=PSA$TRAPPED,
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:15   
      183    11120         COMMAND=TRAP,
      184    11121         IPR=TRAP,
      185    11122         LOCKUP=TRAP,
      186    11123         MEMORY=TRAP,
      187    11124         MISSING_PAGE=TRAP,
      188    11125         MISSING_SEG=TRAP,
      189    11126         SECURITY_1=TRAP,
      190    11127         SECURITY_2=TRAP,
      191    11128         PMME=PSA$TRAPPED,
      192    11129         PROGRAMMED=PSA$TRAPPED,
      193    11130         DERAIL=TRAP,
      194    11131         FAULT_TAG=TRAP,
      195    11132         MME=TRAP,
      196    11133         HISTORY_REGS=YES);
      197    11156
      198    11157        %FPT_KEYIN;
      199    11176
      200    11177        %FPT_EXIT ;
      201    11192
      202    11193    1   DCL B$TCB$ PTR SYMREF;
      203    11194    1   DCL B$JIT$ PTR SYMREF;
      204    11195
      205    11196        %PARSE$OUT (STCLASS="BASED(CMD$)");
      206    11241
      207    11242    1   DCL CMD$ PTR;
      208    11243    1   DCL 1 ERR REDEF CMD$,
      209    11244    1          2 FCG BIT (12),
      210    11245    1          2 MID BIT (6),
      211    11246    1          2 MON BIT (1),
      212    11247    1          2 CODE UBIN (14) UNAL,
      213    11248    1          2 SEV UBIN (3) UNAL;
      214    11249
      215    11250        %PARSE$SYM (STCLASS=BASED);
      216    11288
      217    11289        %REF_RPN (NAME=BASED_RPN, STCLASS=BASED);
      218    11300
      219    11301        %DUMMY_BUCKET (NAME=BASED_BUCKET, STCLASS=BASED);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:16   
      220    11307
      221    11308    1   DCL I UBIN WORD;
      222    11309    1   DCL J SBIN;
      223    11310    1   DCL K SBIN;
      224    11311    1   DCL L SBIN;
      225    11312    1   DCL LYR SBIN;
      226    11313    1   DCL OPTN UBIN;
      227    11314    1   DCL CHANGE_MODE UBIN;
      228    11315    1   DCL FLAGS$ PTR;
      229    11316    1   DCL FEP_FLAGS$ PTR;
      230    11317    1   DCL IX UBIN;
      231    11318    1   DCL FEP_IX UBIN;
      232    11319        %PS_FEPMASK(NAME=DISP,STCLASS=AUTO);
      233    11385        %PS_FEPMASK(NAME=SLCT,STCLASS=AUTO);
      234    11451    1   DCL 1 HANDLER CHAR(8) CALIGNED AUTO ;
      235    11452
      236    11453    1   DCL 1 FEP_MASK(0:0) BASED ALIGNED,
      237    11454        %PS_FEPMASK(LVL=2, STCLASS=BASED);
      238    11520
      239    11521    1   DCL 1 FEP_LYR_MASKS CONSTANT ALIGNED,
      240    11522        %PS_FEPMASK(NAME=LNK, LVL=2, STCLASS=CONSTANT, LAST=",", ASYNC=YES, BSC=YES,
      241    11523         FEI=YES, HDLC=YES, URP=YES);
      242    11589        %PS_FEPMASK(NAME=NTW, LVL=2, STCLASS=CONSTANT, LAST=",", X25=YES);
      243    11655        %PS_FEPMASK(NAME=PRS, LVL=2, STCLASS=CONSTANT, LAST=",", VDH=YES, APE=YES);
      244    11721        %PS_FEPMASK(NAME=APL, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES,
      245    11722         PLDVIP=YES, RBT=YES, NODADM=YES, IO=YES, X29=YES);
      246    11788        %PS_FEPMASK(NAME="*", LVL=2, STCLASS=CONSTANT, LAST=",");
      247    11854        %PS_FEPMASK(NAME="*", LVL=2, STCLASS=CONSTANT, LAST=",");
      248    11920        %PS_FEPMASK(NAME="*", LVL=2, STCLASS=CONSTANT);
      249    11986
      250    11987    1   DCL 1 FEP_DISP_MODE_MASKS CONSTANT ALIGNED,
      251    11988    1          2 SUMMARY BIT(36) INIT('400000000000'O),
      252    11989    1          2 EXTENDED BIT(36) INIT('200000000000'O) ;
      253    11990
      254    11991    1   DCL 1 FEP_SLCT_MODE_MASKS CONSTANT ALIGNED,
      255    11992    1          2 HANDLER BIT(36) INIT('400000000000'O) ;
      256    11993
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:17   
      257    11994    1   DCL 1 FEP_DISP_MASKS CONSTANT ALIGNED,
      258    11995    1          2 * BIT(36) INIT ('0'O), /* Not Used; Must be first */
      259    11996        %PS_FEPMASK ( NAME=ALL, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES,
      260    11997         APE=YES,
      261    11998         ASYNC=YES,
      262    11999         FEI=YES,
      263    12000         HDLC=YES,
      264    12001         IO=YES,
      265    12002         MONITOR=YES,
      266    12003         PLDVIP=YES,
      267    12004         RBT=YES,
      268    12005         URP=YES,
      269    12006         VDH=YES,
      270    12007         X25=YES,
      271    12008         X29=YES ) ;
      272    12074        %PS_FEPMASK ( NAME=T3270, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES ) ;
      273    12140        %PS_FEPMASK ( NAME=ASSYNC, LVL=2, STCLASS=CONSTANT, LAST=",", ASYNC=YES ) ;
             12140            /* Must be last */
      274    12206        %PS_FEPMASK ( NAME=FEI, LVL=2, STCLASS=CONSTANT, LAST=",", FEI=YES ) ;
      275    12272        %PS_FEPMASK ( NAME=HDLC, LVL=2, STCLASS=CONSTANT, LAST=",", HDLC=YES ) ;
      276    12338        %PS_FEPMASK ( NAME=MON, LVL=2, STCLASS=CONSTANT, LAST=",", MONITOR=YES ) ;
      277    12404        %PS_FEPMASK ( NAME=POLLVIP, LVL=2, STCLASS=CONSTANT, LAST=",", PLDVIP=YES ) ;
      278    12470        %PS_FEPMASK ( NAME=RBT, LVL=2, STCLASS=CONSTANT, LAST=",", RBT=YES ) ;
      279    12536        %PS_FEPMASK ( NAME=URP, LVL=2, STCLASS=CONSTANT, LAST=",", URP=YES ) ;
      280    12602        %PS_FEPMASK ( NAME=VDH, LVL=2, STCLASS=CONSTANT, LAST=",", VDH=YES ) ;
      281    12668        %PS_FEPMASK ( NAME=X25, LVL=2, STCLASS=CONSTANT, LAST=",", X25=YES ) ;
      282    12734        %PS_FEPMASK ( NAME=X29, LVL=2, STCLASS=CONSTANT, LAST=",", X29=YES ) ;
      283    12800        %PS_FEPMASK ( NAME=NONE, LVL=2, STCLASS=CONSTANT, LAST=";" ) ;
      284    12866    1   DCL 1 FEP_DISP_MASKS$ PTR ALIGNED CONSTANT INIT ( ADDR(FEP_DISP_MASKS) ) ;
      285    12867
      286    12868    1   DCL 1 FEP_DISP_TOKENS(0:13) CHAR(16) CONSTANT ALIGNED INIT (
      287    12869    1   '    .', /* Not Used; Must be First */
      288    12870    1    'all .',
      289    12871    1    '3270 .',
      290    12872    1    'Async .',
      291    12873    1    'FEI .',
      292    12874    1    'HDLC .',
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:18   
      293    12875    1    'Monitor .',
      294    12876    1    'Polled VIP .',
      295    12877    1    'RBT .',
      296    12878    1    'URP .',
      297    12879    1    'VDH .',
      298    12880    1    'X25 .',
      299    12881    1    'X29 .',
      300    12882    1    'none .' /* Must be last */ ) ;
      301    12883
      302    12884    1   DCL 1 FEP_SLCT_MASKS CONSTANT ALIGNED,
      303    12885    1          2 HANDLER BIT(36) INIT ( '437777777777'O ), /* Must be first */
      304    12886        %PS_FEPMASK ( NAME=ALL, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES,
      305    12887         ASYNC=YES,
      306    12888         BSC=YES,
      307    12889         FEI=YES,
      308    12890         HDLC=YES,
      309    12891         MONITOR=YES,
      310    12892         NODADM=YES,
      311    12893         PLDVIP=YES,
      312    12894         RBT=YES,
      313    12895         URP=YES ) ;
      314    12961        %PS_FEPMASK ( NAME=T3270, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES ) ;
      315    13027        %PS_FEPMASK ( NAME=ASSYNC, LVL=2, STCLASS=CONSTANT, LAST=",", ASYNC=YES ) ;
      316    13093        %PS_FEPMASK ( NAME=BISYNC, LVL=2, STCLASS=CONSTANT, LAST=",", BSC=YES ) ;
      317    13159        %PS_FEPMASK ( NAME=COUPLER, LVL=2, STCLASS=CONSTANT, LAST=",", FEI=YES ) ;
      318    13225        %PS_FEPMASK ( NAME=HDLCX25, LVL=2, STCLASS=CONSTANT, LAST=",", HDLC=YES ) ;
      319    13291        %PS_FEPMASK ( NAME=MONITOR, LVL=2, STCLASS=CONSTANT, LAST=",", MONITOR=YES ) ;
      320    13357        %PS_FEPMASK ( NAME=NODEADMN, LVL=2, STCLASS=CONSTANT, LAST=",", NODADM=YES ) ;
      321    13423        %PS_FEPMASK ( NAME=PLDVIP, LVL=2, STCLASS=CONSTANT, LAST=",", PLDVIP=YES ) ;
      322    13489        %PS_FEPMASK ( NAME=RBT, LVL=2, STCLASS=CONSTANT, LAST=",", RBT=YES ) ;
      323    13555        %PS_FEPMASK ( NAME=UNITREC, LVL=2, STCLASS=CONSTANT, LAST=",", URP=YES ) ;
      324    13621        %PS_FEPMASK ( NAME=NONE, LVL=2, STCLASS=CONSTANT, LAST=";" ) ; /* Must be last */
      325    13687
      326    13688    1   DCL 1 FEP_SLCT_MASKS$ PTR ALIGNED CONSTANT INIT ( ADDR(FEP_SLCT_MASKS) ) ;
      327    13689
      328    13690    1   DCL 1 FEP_SLCT_TOKENS(0:12) CHAR(16) CONSTANT ALIGNED INIT (
      329    13691    1   'Handler .', /* Not Used; Must be first */
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:19   
      330    13692    1    'all .',
      331    13693    1    '3270 .',
      332    13694    1    'ASYNC .',
      333    13695    1    'BISYNC .',
      334    13696    1    'COUPLER .',
      335    13697    1    'HDLCX25 .',
      336    13698    1    'MONITOR .',
      337    13699    1    'NODEADMN .',
      338    13700    1    'PLDVIP .',
      339    13701    1    'RBT .',
      340    13702    1    'UNITREC .',
      341    13703    1    'none .' /*  Must be last */ ) ;
      342    13704
      343    13705
      344    13706    1   DCL 1 FEP_TOKEN(0:22) CHAR(16) CONSTANT ALIGNED INIT(
      345    13707    1    'Summary .',
      346    13708    1    'Extended .',
      347    13709    1   'all .', /* just as good as all */
      348    13710    1    'Monitor .',
      349    13711    1    'Link .',
      350    13712    1    'Async .',
      351    13713    1    'BSC .',
      352    13714    1    'FEI .',
      353    13715    1    'HDLC .',
      354    13716    1    'URP .',
      355    13717    1    'Network .',
      356    13718    1    'X25 .',
      357    13719    1    'Presentation .',
      358    13720    1    'VDH .',
      359    13721    1    'APE .',
      360    13722    1    'Application .',
      361    13723    1    '3270 .',
      362    13724    1    'PolledVIP .',
      363    13725    1    'RBT .',
      364    13726    1    'NodeAdmin .',
      365    13727    1    'IO .',
      366    13728    1    'X29 .',
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:20   
      367    13729    1    'none .');
      368    13730
      369    13731    1   DCL 1 B_VERSION CALIGNED SYMREF,
      370    13732    1          2 L UBIN BYTE CALIGNED,
      371    13733    1          2 C CHAR(6) CALIGNED;
      372    13734    1   DCL 1 B_VERSION_ CALIGNED BASED,
      373    13735    1          2 L UBIN BYTE CALIGNED,
      374    13736    1          2 C CHAR(B_VERSION.L) CALIGNED;
      375    13737
      376    13738    1   DCL P$ PTR;
      377    13739    1   DCL STRANGLING LOGICAL STATIC INIT (%NO#);
      378    13740    1   DCL PS_CMDS BIT(36) ALIGNED SYMREF;
      379    13741
      380    13742    1   DCL 1 STATUS_FORMAT CONSTANT,
      381    13743    1          2 P3 CHAR (0) INIT ('Interval%10-%D'),
      382    13744    1          2 P4 CHAR (0) INIT ('%/File%10-%A'),
      383    13745    1          2 P5 CHAR (0) INIT ('%/Time%10-%A'),
      384    13746    1          2 P6 CHAR (0) INIT ('%/Select%10-%A%/');
      385    13747
      386    13748    1   DCL STATUS_DI_FMT CHAR(0) CONSTANT INIT('%/Display%10-%A');
      387    13749    1   DCL STATUS_LOG_FMT CHAR(0) CONSTANT INIT('Log%10-%A');
      388    13750    1   DCL STATUS_FEPS_FMT CHAR(0) CONSTANT INIT('%10-Fep %A');
      389    13751    1   DCL STATUS_FEPN_FMT CHAR(0) CONSTANT INIT('%10-Fep %D %A');
      390    13752
      391    13753    1   DCL FEP_BLURT_FMT CHAR(0) CONSTANT INIT('..fep %D "%A" %A');
      392    13754
      393    13755    1   DCL STATUS_MISC CHAR (120);
      394    13756
      395    13757    1   DCL STATUS_FID CHAR (120) STATIC;
      396    13758    1   DCL STATUS_FEP_LOG CHAR (120);
      397    13759    1   DCL STATUS_TIME CHAR (40);
      398    13760    1   DCL STATUS_SELECT CHAR (120);
      399    13761
      400    13762    1   DCL 1 COMPLAINT,
      401    13763    1          2 SKIP_ONE CHAR(1),
      402    13764    1          2 STRING CHAR(255),
      403    13765    1          2 BYTES (0:254) REDEF STRING CHAR(1);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:21   
      404    13766    1   DCL COMPLAINT_BUFFER REDEF COMPLAINT CHAR (256);
      405    13767
      406    13768    1   DCL 1 TIME_AREA STATIC,
      407    13769    1          2 PORTION (0:1),
      408    13770    1             3 DIGITS CHAR(2),
      409    13771    1             3 SEP CHAR(1),
      410    13772    1          2 ENDIT CHAR(5);
      411    13773    1   DCL TIME_AREA_C REDEF TIME_AREA CHAR(11);
      412    13774
      413    13775    1   DCL 1 DATE_AREA STATIC,
      414    13776    1          2 PORTION (0:2),
      415    13777    1             3 DIGITS CHAR(2),
      416    13778    1             3 SEP CHAR(1),
      417    13779    1          2 VECTOR_PORTION REDEF PORTION,
      418    13780    1             3 REAL CHAR(8),
      419    13781    1             3 * CHAR(1);
      420    13782
      421    13783    1   DCL STATS_PROMPT CHAR (0) CONSTANT INIT ('#');
      422    13784    1   DCL CONTINUE_PROMPT CHAR (0) CONSTANT INIT ('>#');
      423    13785    1   DCL PROMPT_VECTOR BIT (72) DALIGNED STATIC INIT (VECTOR(NIL));
      424    13786    1   DCL TEMP_START_UTS UBIN WORD;
      425    13787    1   DCL TEMP_END_UTS UBIN WORD;
      426    13788    1   DCL DEFAULT_START_TIME CHAR(11) CONSTANT INIT ('00:00:00.00');
      427    13789    1   DCL DEFAULT_END_TIME CHAR(11) CONSTANT INIT ('23:59:59.99');
      428    13790    1   DCL TODAYS_DATE CHAR(8) STATIC;
      429    13791    1   DCL X$PARSE ENTRY (1) ALTRET;
      430    13792    1   DCL PSR$RPN ENTRY (2);
      431    13793    1   DCL PSR$UN_RPN ENTRY (4);
      432    13794    1   DCL PSM$ALLOC ENTRY (2);
      433    13795    1   DCL PSM$FREESEG ENTRY(1);
      434    13796    1   DCL PSE$ERRMSG ENTRY(5);
      435    13797    1   DCL PSE$ELUCIDATE ENTRY;
      436    13798    1   DCL PSE$CLARIFY ENTRY;
      437    13799    1   DCL PSE$GRIPE ENTRY (5);
      438    13800    1   DCL PSD$DISP ENTRY;
      439    13801    1   DCL PSA$BREAK ENTRY ASYNC;
      440    13802    1   DCL PSA$TRAPPED ENTRY ASYNC;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:22   
      441    13803    1   DCL PSA$CONTINUE ENTRY (1);
      442    13804        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:23   
      443    13805    1      STRANGLING = %NO#;
      444    13806
      445    13807    1      PS_PMDAT_SIZE = 0;
      446    13808    1      PS_MOUSE_SIZE = 0;
      447    13809    1      PS_STATS_SIZE = 0;
      448    13810    1      PS_OLD_PMDAT_SIZE = 0;
      449    13811    1      PS_OLD_MOUSE_SIZE = 0;
      450    13812    1      PS_NEEDED_PMDAT_SIZE = 2048;
      451    13813    1      PS_NEEDED_LOGFILE_SIZE = 2048;
      452    13814    1      PS_NEEDED_MOUSE_SIZE = 1024;
      453    13815    1      PS_DISPLAY_FLAGS = PS_DEFAULT_DISPLAY_FLAGS;
      454    13816    1      PS_LOG_FLAGS = PS_DEFAULT_LOG_FLAGS;
      455    13817    1      PS_INTERVAL = PS_DEFAULT_INTERVAL;
      456    13818    1      PS_INPUTTING = %NO#;
      457    13819    1      PS_MOUSEING = %NO#;
      458    13820    1      PS_FILE_PARAMS = PS_DEFAULT_FILE_PARAMS;
      459    13821
      460    13822    1      CALL M$TIME ( GET_PS_TODAYS_DATE ) ;
      461    13823
      462    13824    1      CALL M$SPRIV (SET_PM_PRIV);
      463    13825
      464    13826    1      CALL XUR$INIT(XUR_INIT);
      465    13827
      466    13828    1      CALL PSE$GRIPE(E$PS_HI_THERE, ,VECTOR(ADDR(B_VERSION)->B_VERSION_.C));
      467    13829
      468    13830    1      CALL M$INT (FPT_INT) ALTRET (BAILOUT);
      469    13831
      470    13832    1      CALL M$TRAP (SET_TRAP_CONTROL);
      471    13833
      472    13834    1      CALL M$OPEN (OPEN_SI) ALTRET (UNABLE_TO_OPEN_M$SI);
      473    13835
      474    13836    1      RETURN;
      475    13837
      476    13838    1   UNABLE_TO_OPEN_M$SI:
      477    13839
      478    13840    1      CALL PSE$ERRMSG( , FATAL#);
      479    13841
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:24   
      480    13842        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:25   
      481    13843    1   PSA$RESTART: ENTRY;
      482    13844
      483    13845    1   FREESEG: PROC (SEGMENT$, SEGSIZE);
      484    13846
      485    13847    2   DCL SEGMENT$ PTR;
      486    13848    2   DCL SEGSIZE UBIN WORD;
      487    13849
      488    13850    2      IF SEGSIZE > 0
      489    13851    3      THEN DO;
      490    13852
      491    13853    3         CALL PSM$FREESEG (SEGMENT$);
      492    13854
      493    13855    3         SEGSIZE = 0;
      494    13856
      495    13857    3      END;
      496    13858
      497    13859    2      SEGMENT$ = ADDR(NIL);
      498    13860
      499    13861    2      RETURN;
      500    13862
      501    13863    2   END FREESEG;
      502    13864
      503    13865    1      IF DCBADDR(DCBNUM(M$HLPCG))->F$DCB.FCD
      504    13866    1      THEN CALL M$CLOSE(CLOSE_HLPCG) ALTRET (BAILOUT);
      505    13867
      506    13868    1      CALL FREESEG (PS_FEP$, PS_FEP_SIZE);
      507    13869    1      CALL FREESEG (PS_OLD_FEP$, PS_OLD_FEP_SIZE);
      508    13870    1      CALL FREESEG (PS_PMDAT$, PS_PMDAT_SIZE);
      509    13871    1      CALL FREESEG (PS_OLD_PMDAT$, PS_OLD_PMDAT_SIZE);
      510    13872    1      CALL FREESEG (PS_MOUSE$, PS_MOUSE_SIZE);
      511    13873    1      CALL FREESEG (PS_OLD_MOUSE$, PS_OLD_MOUSE_SIZE);
      512    13874    1      CALL FREESEG (PS_STATS$, PS_STATS_SIZE);
      513    13875    1      CALL FREESEG (PS_LOGFILE$, PS_LOGFILE_SIZE);
      514    13876
      515    13877    1      IF DCBADDR(DCBNUM(F$LOG)) -> F$DCB.FCD
      516    13878    1      THEN
      517    13879    1      CALL M$CLOSE (CLOSE_LOGFILE) ALTRET (BAILOUT);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:26   
      518    13880
      519    13881    1      IF DCBADDR(DCBNUM(M$LO)) -> F$DCB.FCD
      520    13882    1      THEN
      521    13883    1      CALL M$DEVICE (ZAP_HEADER);
      522    13884
      523    13885    2      DO FOREVER;
      524    13886
      525    13887    2         CALL M$CLRSTK ALTRET (ALL_CLEAR);
      526    13888    2      END;
      527    13889
      528    13890    1   ALL_CLEAR: ;
      529    13891
      530    13892    1      RETURN;
      531    13893
      532    13894    1   BAILOUT: ;
      533    13895
      534    13896    1      IF STRANGLING
      535    13897    1      THEN
      536    13898    1      IF B$TCB.ALT$ ~= ADDR(NIL)
      537    13899    1        AND B$TCB.ALT$ -> B$EXCFR.ERR ~= PS_ERR
      538    13900    1      THEN
      539    13901    1      CALL PSE$ERRMSG (, FATAL#);
      540    13902    1      ELSE
      541    13903    1      CALL M$ERR;
      542    13904
      543    13905    1      STRANGLING = %YES#;
      544    13906
      545    13907    1      CALL PSE$ERRMSG (, SERIOUS#);
      546    13908
      547    13909        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:27   
      548    13910    1   PSA$INPUT: ENTRY;
      549    13911
      550    13912    1      CALL XUR$GETCMD (PS_CMDS, CMD$, VECTOR(STATS_PROMPT))
      551    13913    1        ALTRET (INVALID_COMMAND);
      552    13914
      553    13915
      554    13916    1      CALL XUR$ECHOIF (DCBNUM(M$LO));
      555    13917
      556    13918    1      RETURN;
      557    13919
      558    13920    1   INVALID_COMMAND:
      559    13921
      560    13922    1      IF ERR.MON /* monitor error occurred during input/parse */
      561    13923    1        OR ERR.CODE ~= %E$SYNERR /* parser error other than "syntax error" */
      562    13924    1      THEN
      563    13925    1      CALL PSE$ERRMSG (ERR, FATAL#);
      564    13926
      565    13927    1      CALL XUR$ECHOIF (DCBNUM(M$ME));
      566    13928
      567    13929    1      CALL XUR$ERRPTR ( , DCBNUM(M$ME));
      568    13930
      569    13931    1      CALL M$CORRES (COMPARE_M$ME_AND_M$LO) ALTRET (DONT_OUTPUT_TO_M$LO);
      570    13932
      571    13933    1      CALL XUR$ECHOIF (DCBNUM(M$LO));
      572    13934
      573    13935    1      CALL XUR$ERRPTR ( , DCBNUM(M$LO));
      574    13936
      575    13937    1   DONT_OUTPUT_TO_M$LO:
      576    13938
      577    13939    1      CALL PSE$ERRMSG (ERR, WARNING#);
      578    13940
      579    13941    1      GOTO BAILOUT;
      580    13942
      581    13943        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:28   
      582    13944    1   PSA$DOIT: ENTRY;
      583    13945
      584    13946    2      DO CASE (OUT$BLK.CODE);
      585    13947
      586    13948    2      CASE (0 /* specify-command */);
      587    13949
      588    13950    2         OPTN = 0;
      589    13951
      590    13952    3         DO CASE (OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE);
      591    13953
      592    13954    3         CASE (0 /* also */);
      593    13955
      594    13956    3            OPTN = 1;
      595    13957    3            CHANGE_MODE = 1 /* Add flags */;
      596    13958
      597    13959    3         CASE (1 /* dont */);
      598    13960
      599    13961    3            OPTN = 1;
      600    13962    3            CHANGE_MODE = 2 /* Delete flags */;
      601    13963
      602    13964    3         CASE (2 /* neither prefix */);
      603    13965
      604    13966    3            CHANGE_MODE = 0;
      605    13967
      606    13968    3         END;
      607    13969
      608    13970    3         DO CASE (OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.SUBLK$(0) ->
      609    13971    3           OUT$BLK.CODE);
      610    13972
      611    13973    3         CASE (0 /* display */);
      612    13974
      613    13975    3            FLAGS$ = ADDR(PS_DISPLAY_FLAGS);
      614    13976    3            FEP_FLAGS$ = ADDR(PS_FEP_DISP_FLAGS);
      615    13977
      616    13978    3         CASE (1 /* log */);
      617    13979
      618    13980    3            FLAGS$ = ADDR(PS_LOG_FLAGS);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:29   
      619    13981    3            FEP_FLAGS$ = ADDR(PS_FEP_LOG_FLAGS);
      620    13982
      621    13983    3         END;
      622    13984
      623    13985    2         IF CHANGE_MODE=0
      624    13986    3         THEN DO;
      625    13987    3            FEP_FLAGS$ -> PS_FEP_BASED_FLAGS = '0'B;
      626    13988    3         END;
      627    13989
      628    13990    2         OPTN = OPTN + 1;
      629    13991
      630    13992    2         PS_WORKING_FLAGS = '0'B;
      631    13993
      632    13994    3         DO WHILE (OPTN < OUT$BLK.NSUBLKS);
      633    13995
      634    13996    4            DO CASE (OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.CODE);
      635    13997
      636    13998    4            CASE (0 /* pmdat */);
      637    13999
      638    14000    4               PS_WORKING_FLAGS.CPU = %YES#;
      639    14001    4               PS_WORKING_FLAGS.RESOURCES = %YES#;
      640    14002    4               PS_WORKING_FLAGS.SCPU = %YES#;
      641    14003    4               PS_WORKING_FLAGS.DEVICES = %YES#;
      642    14004    4               PS_WORKING_FLAGS.PROCS = %YES#;
      643    14005    4               PS_WORKING_FLAGS.CHANNELS = %YES#;
      644    14006    4               PS_WORKING_FLAGS.HISTOGRAMS = %YES#;
      645    14007    4               PS_WORKING_FLAGS.SUMMARY = %YES#;
      646    14008    4               PS_WORKING_FLAGS.FAULT = %YES#;
      647    14009
      648    14010
      649    14011    4            CASE (1 /* all */);
      650    14012
      651    14013    4               PS_WORKING_FLAGS.CPU = %YES#;
      652    14014    4               PS_WORKING_FLAGS.RESOURCES = %YES#;
      653    14015    4               PS_WORKING_FLAGS.SCPU = %YES#;
      654    14016    4               PS_WORKING_FLAGS.DEVICES = %YES#;
      655    14017    4               PS_WORKING_FLAGS.PROCS = %YES#;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:30   
      656    14018    4               PS_WORKING_FLAGS.CHANNELS = %YES#;
      657    14019    4               PS_WORKING_FLAGS.HISTOGRAMS = %YES#;
      658    14020    4               PS_WORKING_FLAGS.SUMMARY = %YES#;
      659    14021    4               PS_WORKING_FLAGS.FAULT = %YES#;
      660    14022    4               PS_WORKING_FLAGS.FEP = %YES#;
      661    14023    4               PS_WORKING_FLAGS.MOUSE = %YES#;
      662    14024        /*N* FEPS HERE */
      663    14025
      664    14026
      665    14027    4            CASE (2 /* none */);
      666    14028
      667    14029    4               PS_WORKING_FLAGS = %NO#;
      668    14030
      669    14031    4            CASE (3 /* cpu */);
      670    14032
      671    14033    4               PS_WORKING_FLAGS.CPU = %YES#;
      672    14034
      673    14035    4            CASE (4 /* resources */);
      674    14036
      675    14037    4               PS_WORKING_FLAGS.RESOURCES = %YES#;
      676    14038
      677    14039    4            CASE (5 /* feps */, 16 /* fep summary */, 17 /* fep extended */);
      678    14040
      679    14041    4               CALL FEPBITS(DISP, OUT$BLK.SUBLK$(OPTN)->OUT$BLK.SUBLK$(1),
      680    14042    4                 FEP_DISP_MASKS ) ;
      681    14043    4               CALL FEPBITS(SLCT, OUT$BLK.SUBLK$(OPTN)->OUT$BLK.SUBLK$(2),
      682    14044    4                 FEP_SLCT_MASKS ) ;
      683    14045
      684    14046    4               IF OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.CODE = 16 THEN
      685    14047    4               DISP = DISP | FEP_DISP_MODE_MASKS.SUMMARY ;
      686    14048    4               IF OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.CODE = 17 THEN
      687    14049    4               DISP = DISP | FEP_DISP_MODE_MASKS.EXTENDED ;
      688    14050
      689    14051        /*          DO LYR=0 TO ((SIZEW(FEP_LYR_MASKS)/SIZEW(FEP_MASK))-1);
      690    14052                       IF NOT (DISP & ADDR(FEP_LYR_MASKS)->FEP_MASK(LYR))
      691    14053                       THEN DISP = DISP | ADDR(FEP_LYR_MASKS)->FEP_MASK(LYR);
      692    14054                    END;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:31   
      693    14055        */
      694    14056    4               IF OUT$BLK.SUBLK$(OPTN) ->
      695    14057    4                 OUT$BLK.SUBLK$(0) ->
      696    14058    4                 OUT$BLK.NSUBLKS = 0
      697    14059    5               THEN DO PS_FEPNO=0 TO %PS_MAXFE#;
      698    14060    5                  CALL UPBITS;
      699    14061    5               END;
      700    14062
      701    14063    5               ELSE DO IX = 0 TO OUT$BLK.SUBLK$(OPTN) ->
      702    14064    5                 OUT$BLK.SUBLK$(0) ->
      703    14065    5                 OUT$BLK.NSUBLKS-1;
      704    14066    5                  CALL CHARBIN (PS_FEPNO, OUT$BLK.SUBLK$(OPTN) ->
      705    14067    5                    OUT$BLK.SUBLK$(0) ->
      706    14068    5                    OUT$BLK.SUBLK$(IX) ->
      707    14069    5                    OUT$SYM.TEXT);
      708    14070    5                  CALL UPBITS;
      709    14071    5               END;
      710    14072
      711    14073    4               PS_FEPING = %NO#;
      712    14074    5               DO PS_FEPNO = 0 TO %PS_MAXFE#;
      713    14075    5                  IF PS_FEP_DISP_FLAGS.DISP(PS_FEPNO) OR
      714    14076    5                    PS_FEP_DISP_FLAGS.SLCT(PS_FEPNO) OR
      715    14077    5                    PS_FEP_LOG_FLAGS.DISP(PS_FEPNO) OR
      716    14078    5                    PS_FEP_LOG_FLAGS.SLCT(PS_FEPNO)
      717    14079    6                  THEN DO;
      718    14080    6                     PS_FEPING = '1'B;
      719    14081    6                     GOTO L_FEPING;
      720    14082    6                  END /* IF */;
      721    14083    5               END /* DO PS_FEPNO */;
      722    14084    4   L_FEPING:
      723    14085    4               PS_WORKING_FLAGS.FEP = %YES#;
      724    14086
      725    14087    4            CASE (6 /* devices */);
      726    14088
      727    14089    4               PS_WORKING_FLAGS.DEVICES = %YES#;
      728    14090
      729    14091    4            CASE (7 /* scpu */);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:32   
      730    14092
      731    14093    4               PS_WORKING_FLAGS.SCPU = %YES#;
      732    14094
      733    14095    4            CASE (8 /* mouse */);
      734    14096
      735    14097    4               PS_WORKING_FLAGS.MOUSE = %YES#;
      736    14098
      737    14099    4            CASE (10 /* procs */);
      738    14100
      739    14101    4               PS_WORKING_FLAGS.PROCS = %YES#;
      740    14102
      741    14103    4            CASE (11 /* summary */);
      742    14104
      743    14105    4               PS_WORKING_FLAGS.SUMMARY = %YES#;
      744    14106
      745    14107    4            CASE (12 /* channels */);
      746    14108
      747    14109    4               PS_WORKING_FLAGS.CHANNELS = %YES#;
      748    14110
      749    14111    4            CASE (13 /* i/o */);
      750    14112
      751    14113    4               PS_WORKING_FLAGS.DEVICES = %YES#;
      752    14114    4               PS_WORKING_FLAGS.CHANNELS = %YES#;
      753    14115
      754    14116    4            CASE (14 /* histograms */);
      755    14117
      756    14118    4               PS_WORKING_FLAGS.HISTOGRAMS = %YES#;
      757    14119
      758    14120    4            CASE (15 /* fault */);
      759    14121
      760    14122    4               PS_WORKING_FLAGS.FAULT = %YES#;
      761    14123
      762    14124    4            END;
      763    14125
      764    14126    3            OPTN = OPTN + 1;
      765    14127
      766    14128    3         END;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:33   
      767    14129
      768    14130    3         DO CASE (CHANGE_MODE);
      769    14131
      770    14132    3         CASE (0 /* new flags */);
      771    14133
      772    14134    3            FLAGS$ -> PS_BASED_FLAGS = PS_WORKING_FLAGS;
      773    14135
      774    14136    3         CASE (1 /* Add flags */);
      775    14137
      776    14138    3            FLAGS$ -> PS_BASED_FLAGS =
      777    14139    3              FLAGS$ -> PS_BASED_FLAGS | PS_WORKING_FLAGS;
      778    14140
      779    14141    3         CASE (2 /* Delete flags */);
      780    14142
      781    14143    3            FLAGS$ -> PS_BASED_FLAGS =
      782    14144    3              FLAGS$ -> PS_BASED_FLAGS & ~ PS_WORKING_FLAGS;
      783    14145
      784    14146    3         END;
      785    14147
      786    14148
      787    14149
      788    14150        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:34   
      789    14151    2      CASE (1 /* interval */);
      790    14152
      791    14153    2         PS_INTERVAL = 0;
      792    14154
      793    14155    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;
      794    14156
      795    14157    3            CALL CHARBIN (J, OUT$BLK.SUBLK$(I) -> OUT$SYM.TEXT);
      796    14158    3            PS_INTERVAL = (PS_INTERVAL * 60) + J;
      797    14159
      798    14160    3         END;
      799    14161
      800    14162    2         IF PS_INTERVAL = 0
      801    14163    2         THEN PS_INTERVAL = PS_DEFAULT_INTERVAL;
      802    14164
      803    14165        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:35   
      804    14166    2      CASE (2 /* file */);
      805    14167
      806    14168    2         FPT_FID.TEXTFID_ = VECTOR(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
      807    14169
      808    14170    2         CALL M$FID (FPT_FID) ALTRET (BAILOUT);
      809    14171
      810    14172    2         IF PS_FID_PARAMS.ASN@ ~= %FILE#
      811    14173    2         THEN CALL PSE$ERRMSG (E$PS_NEED_FILE, WARNING#);
      812    14174
      813    14175    2         PS_FILE_PARAMS = PS_FID_PARAMS;
      814    14176
      815    14177        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:36   
      816    14178    2      CASE (6 /* punt */, 12 /* snap */);
      817    14179
      818    14180    2         IF OUT$BLK.NSUBLKS = 0
      819    14181    3         THEN DO;
      820    14182
      821    14183    3            IF OUT$BLK.CODE = 12 /* snap */
      822    14184    3            THEN PS_PUNT_COUNT = 0;
      823    14185    3            ELSE PS_PUNT_COUNT = 99999999;
      824    14186
      825    14187    3         END;
      826    14188
      827    14189    3         ELSE DO;
      828    14190
      829    14191    4            DO CASE (OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE);
      830    14192
      831    14193    4            CASE (0 /* "punt once" */);
      832    14194
      833    14195    4               PS_PUNT_COUNT = 1;
      834    14196
      835    14197    4            CASE (1 /* "punt forever" */);
      836    14198
      837    14199    4               PS_PUNT_COUNT = 99999999;
      838    14200
      839    14201    4            CASE (2 /* "punt N" */);
      840    14202
      841    14203    4               CALL CHARBIN (PS_PUNT_COUNT, OUT$BLK.SUBLK$(0) ->
      842    14204    4                 OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      843    14205
      844    14206    4            END /* do case */;
      845    14207
      846    14208    3         END /* else do */;
      847    14209
      848    14210    2         PS_MODE = DISPLAY_MODE#;
      849    14211
      850    14212    2         CALL PSD$DISP;
      851    14213
      852    14214    2      CASE (7 /* end */);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:37   
      853    14215
      854    14216    2         CALL M$CLOSE (CLOSE_LO);
      855    14217
      856    14218    2         FPT_EXIT.V.STEPCC# = PS_STEPCC ;
      857    14219    2         CALL M$EXIT ( FPT_EXIT ) ;
      858    14220
      859    14221    2      CASE (8 /* null command */);
      860    14222
      861    14223        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:38   
      862    14224    2      CASE (9 /* reset */);
      863    14225
      864    14226    2         IF OUT$BLK.NSUBLKS = 0 /* default reset command */
      865    14227    3         THEN DO;
      866    14228
      867    14229    3            PS_DISPLAY_FLAGS = PS_DEFAULT_DISPLAY_FLAGS;
      868    14230    3            PS_LOG_FLAGS = PS_DEFAULT_LOG_FLAGS;
      869    14231    3            PS_FEP_DISP_FLAGS = '0'B;
      870    14232    3            PS_FEP_LOG_FLAGS = '0'B;
      871    14233    3            PS_INTERVAL = PS_DEFAULT_INTERVAL;
      872    14234    3            PS_FILE_PARAMS = PS_DEFAULT_FILE_PARAMS;
      873    14235    3            PS_START_UTS = 0;
      874    14236    3            PS_END_UTS = BITBIN('777777777777'O);
      875    14237    3            PS_SELECT_RPN.INFO.USED# = 0;
      876    14238    3         END;
      877    14239
      878    14240    3         ELSE DO I = 0 TO OUT$BLK.NSUBLKS - 1;
      879    14241
      880    14242    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE);
      881    14243
      882    14244    4            CASE (0 /* reset display */);
      883    14245
      884    14246    4               PS_DISPLAY_FLAGS = PS_DEFAULT_DISPLAY_FLAGS;
      885    14247    4               PS_FEP_DISP_FLAGS = '0'B;
      886    14248
      887    14249    4            CASE (1 /* reset log */);
      888    14250
      889    14251    4               PS_LOG_FLAGS = PS_DEFAULT_LOG_FLAGS;
      890    14252    4               PS_FEP_LOG_FLAGS = '0'B;
      891    14253
      892    14254    4            CASE (2 /* reset interval */);
      893    14255
      894    14256    4               PS_INTERVAL = PS_DEFAULT_INTERVAL;
      895    14257
      896    14258    4            CASE (3 /* reset file */);
      897    14259
      898    14260    4               PS_FILE_PARAMS = PS_DEFAULT_FILE_PARAMS;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:39   
      899    14261
      900    14262    4            CASE (4 /* reset time */);
      901    14263
      902    14264    4               PS_START_UTS = 0;
      903    14265    4               PS_END_UTS = BITBIN('777777777777'O);
      904    14266
      905    14267    4            CASE (5 /* reset select */);
      906    14268
      907    14269    4               PS_SELECT_RPN.INFO.USED# = 0;
      908    14270
      909    14271    4            END /* do case */;
      910    14272
      911    14273    3         END /* do I */;
      912    14274
      913    14275        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:40   
      914    14276    2      CASE (10 /* initiate */);
      915    14277
      916    14278    2         CALL CHECK_FOR_EXPM;
      917    14279
      918    14280    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;
      919    14281
      920    14282    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE - 8);
      921    14283
      922    14284    4            CASE (0 /* code 8 = MOUSE */);
      923    14285
      924    14286    4               IF OUT$BLK.SUBLK$(I) -> OUT$BLK.NSUBLKS = 0
      925    14287    4               THEN
      926    14288    4               FPT_SMOUSE.V.SYSID# = 0;
      927    14289    4               ELSE
      928    14290    4               CALL CHARBIN (FPT_SMOUSE.V.SYSID#, OUT$BLK.SUBLK$(I) ->
      929    14291    4                 OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      930    14292
      931    14293    4               CALL M$SMOUSE(FPT_SMOUSE) ALTRET(BAILOUT);
      932    14294    4               CALL PSE$GRIPE (E$PS_MOUSE_GO);
      933    14295
      934    14296
      935    14297    4            END;
      936    14298
      937    14299    3         END /* do I */;
      938    14300
      939    14301        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:41   
      940    14302    2      CASE (11 /* terminate */);
      941    14303
      942    14304    2         CALL CHECK_FOR_EXPM;
      943    14305
      944    14306    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;
      945    14307
      946    14308    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE - 8);
      947    14309
      948    14310    4            CASE (0 /* code 8 = MOUSE */);
      949    14311
      950    14312    4               CALL M$XMOUSE ALTRET(BAILOUT);
      951    14313    4               CALL PSE$GRIPE (E$PS_MOUSE_STOP);
      952    14314
      953    14315    4            END;
      954    14316
      955    14317    3         END /* do I */;
      956    14318        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:42   
      957    14319    2      CASE (13 /* summarize */);
      958    14320
      959    14321    2         PS_SUMMARY_ITEMS = OUT$BLK.NSUBLKS;
      960    14322
      961    14323    2         IF PS_SUMMARY_ITEMS > SIZEW(PS_SUMMARY_LIST)
      962    14324    2         THEN PS_SUMMARY_ITEMS = SIZEW(PS_SUMMARY_LIST);
      963    14325
      964    14326    3         DO I = 0 TO PS_SUMMARY_ITEMS - 1;
      965    14327
      966    14328    3            PS_SUMMARY_LIST(I) = OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE;
      967    14329
      968    14330    3         END;
      969    14331
      970    14332    2         PS_DISPLAY_FLAGS = %NO#;
      971    14333    2         PS_DISPLAY_FLAGS.SUMMARY = %YES#;
      972    14334
      973    14335        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:43   
      974    14336    2      CASE (14 /* replay */);
      975    14337
      976    14338    2         PS_MODE = REPLAY_MODE#;
      977    14339    2         PS_PUNT_COUNT = BITBIN('777777777777'O);
      978    14340
      979    14341    2         CALL PSD$DISP;
      980    14342        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:44   
      981    14343    2      CASE (15 /* histogram */);
      982    14344
      983    14345    2         PS_HISTOGRAM_FLAGS = '0'B;
      984    14346
      985    14347    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;
      986    14348
      987    14349    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE);
      988    14350
      989    14351    4            CASE (0 /* all histograms */);
      990    14352
      991    14353    4               PS_HISTOGRAM_FLAGS = '777777777777'O;
      992    14354
      993    14355    4            CASE (1 /* response histogram */);
      994    14356
      995    14357    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.RESPONSE);
      996    14358
      997    14359    4            CASE (2 /* user-size histogram */);
      998    14360
      999    14361    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.USER_SIZE);
     1000    14362
     1001    14363    4            CASE (3 /* PMME service time histogram */);
     1002    14364
     1003    14365    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.PMME_TIMES);
     1004    14366
     1005    14367    4            CASE (4 /* Interaction compute time */);
     1006    14368
     1007    14369    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.INTERACTION_TIME);
     1008    14370
     1009    14371    4            END /* do case */;
     1010    14372
     1011    14373    3         END /* do I */;
     1012    14374
     1013    14375    2         PS_DISPLAY_FLAGS = %NO#;
     1014    14376    2         PS_DISPLAY_FLAGS.HISTOGRAMS = %YES#;
     1015    14377        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:45   
     1016    14378    2      CASE (16 /* time */);
     1017    14379
     1018    14380    2         IF OUT$BLK.NSUBLKS = 0
     1019    14381    3         THEN DO;
     1020    14382
     1021    14383    3            PS_START_UTS = 0;
     1022    14384    3            PS_END_UTS = BITBIN('777777777777'O);
     1023    14385    3         END;
     1024    14386
     1025    14387    3         ELSE DO;
     1026    14388
     1027    14389    3            P$ = OUT$BLK.SUBLK$(0);
     1028    14390
     1029    14391    3            TEMP_START_UTS = PS_START_UTS;
     1030    14392    3            TEMP_END_UTS = PS_END_UTS;
     1031    14393
     1032    14394    3            CALL M$TIME (GET_TODAYS_DATE);
     1033    14395
     1034    14396    4            DO CASE (P$->OUT$BLK.CODE);
     1035    14397
     1036    14398    4            CASE (0 /* both begin and end limits specified */);
     1037    14399
     1038    14400    4               CALL SET_TIME (TEMP_START_UTS, P$->OUT$BLK.SUBLK$(0)->OUT$BLK,
     1039    14401    4                 DEFAULT_START_TIME);
     1040    14402
     1041    14403    4               CALL SET_TIME (TEMP_END_UTS, P$->OUT$BLK.SUBLK$(1)->OUT$BLK,
     1042    14404    4                 DEFAULT_END_TIME);
     1043    14405
     1044    14406    4            CASE (1 /* begin limit only specified */);
     1045    14407
     1046    14408    4               CALL SET_TIME (TEMP_START_UTS, P$->OUT$BLK.SUBLK$(0)->OUT$BLK,
     1047    14409    4                 DEFAULT_START_TIME);
     1048    14410
     1049    14411    4            CASE (2 /* end limit only specified */);
     1050    14412
     1051    14413    4               CALL SET_TIME (TEMP_END_UTS, P$->OUT$BLK.SUBLK$(0)->OUT$BLK,
     1052    14414    4                 DEFAULT_END_TIME);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:46   
     1053    14415
     1054    14416    4            END;
     1055    14417
     1056    14418    3            PS_START_UTS = TEMP_START_UTS;
     1057    14419    3            PS_END_UTS = TEMP_END_UTS;
     1058    14420
     1059    14421    3         END;
     1060    14422
     1061    14423        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:47   
     1062    14424    2      CASE (17 /* select */);
     1063    14425
     1064    14426    2         PS_SELECT_RPN.INFO = '0'B;
     1065    14427
     1066    14428    3         DO CASE (OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);
     1067    14429
     1068    14430    3         CASE (0 /* select all */);
     1069    14431
     1070    14432    3   /* nothing to do in this case! */;
     1071    14433
     1072    14434    3         CASE (1 /* select ....... */);
     1073    14435
     1074    14436    3            CALL PSR$RPN (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK,
     1075    14437    3              PS_SELECT_RPN);
     1076    14438
     1077    14439    3         END;
     1078    14440        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:48   
     1079    14441    2      CASE (18 /* statistics */, 19 /* analyze */);
     1080    14442
     1081    14443    2         IF OUT$BLK.NSUBLKS = 0
     1082    14444    2         THEN
     1083    14445    2         PS_STATS_EXPRESSIONS = ITEMS#;
     1084    14446    2         ELSE
     1085    14447    2         PS_STATS_EXPRESSIONS = OUT$BLK.NSUBLKS;
     1086    14448
     1087    14449    2         CALL PSM$ALLOC (PS_STATS_EXPRESSIONS, 0);
     1088    14450
     1089    14451    3         DO I = 0 TO PS_STATS_EXPRESSIONS - 1;
     1090    14452
     1091    14453    3            CALL SETUP_STATS_ENTRY (OUT$BLK, I,
     1092    14454    3              MAX_PLOT_VALUES#);
     1093    14455    3         END;
     1094    14456
     1095    14457    2         IF OUT$BLK.CODE = 18 /* statistics */
     1096    14458    2         THEN
     1097    14459    2         PS_MODE = STATISTICS_MODE#;
     1098    14460    2         ELSE
     1099    14461    2         PS_MODE = ANALYZE_MODE#;
     1100    14462
     1101    14463    2         PS_PUNT_COUNT = 99999999;
     1102    14464
     1103    14465    2         CALL PSD$DISP;
     1104    14466        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:49   
     1105    14467    2      CASE (20 /* plot */);
     1106    14468
     1107    14469    2         PS_STATS_EXPRESSIONS = OUT$BLK.NSUBLKS;
     1108    14470    2         PS_GRAPHS = PS_STATS_EXPRESSIONS / 2;
     1109    14471
     1110    14472    2         CALL PSM$ALLOC (PS_STATS_EXPRESSIONS, PS_GRAPHS);
     1111    14473
     1112    14474    3         DO I = 0 TO PS_GRAPHS - 1;
     1113    14475
     1114    14476    3            CALL SETUP_STATS_ENTRY (OUT$BLK, I*2,
     1115    14477    3              Y_AXIS_POINTS#);
     1116    14478
     1117    14479    3            CALL SETUP_STATS_ENTRY (OUT$BLK, I*2+1,
     1118    14480    3              X_AXIS_POINTS#);
     1119    14481
     1120    14482    3            PS_GRAPH_PEAK(I) = 0;
     1121    14483
     1122    14484    3         END;
     1123    14485
     1124    14486    2         PS_MODE = PLOT_MODE#;
     1125    14487    2         PS_PUNT_COUNT = 99999999;
     1126    14488
     1127    14489    2         CALL PSD$DISP;
     1128    14490        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:50   
     1129    14491    2      CASE (21 /* glom */);
     1130    14492
     1131    14493    2         PS_MODE = GLOM_MODE#;
     1132    14494
     1133    14495    2         PS_PUNT_COUNT = 1;
     1134    14496
     1135    14497    2         CALL PSD$DISP;
     1136    14498        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:51   
     1137    14499    2      CASE (22 /* message */);
     1138    14500
     1139    14501        /*   For message command, find message text in parse
     1140    14502             output blocks and pass it to M$KEYIN.                         */
     1141    14503    2         FPT_KEYIN.MESS_ = VECTOR(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1142    14504
     1143    14505    2         CALL M$KEYIN (FPT_KEYIN);
     1144    14506        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:52   
     1145    14507    2      CASE (23 /* bargraph */);
     1146    14508
     1147    14509    2         PS_STATS_EXPRESSIONS = 1;
     1148    14510
     1149    14511    2         CALL PSM$ALLOC (1, 0);
     1150    14512
     1151    14513    2         CALL SETUP_STATS_ENTRY (OUT$BLK, 0, X_AXIS_POINTS#);
     1152    14514
     1153    14515    2         PS_MODE = BARGRAPH_MODE#;
     1154    14516
     1155    14517    2         PS_PUNT_COUNT = BITBIN('777777777777'O);
     1156    14518
     1157    14519    2         CALL PSD$DISP;
     1158    14520        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:53   
     1159    14521    2      CASE (25 /* status */);
     1160    14522
     1161    14523    2         CALL M$UNFID (FPT_UNFID) ALTRET (UNFID_BURPED);
     1162    14524
     1163    14525    3         DO NEVER;
     1164    14526
     1165    14527    3   UNFID_BURPED:
     1166    14528
     1167    14529    3            CALL PSE$ERRMSG ( , SERIOUS#);
     1168    14530
     1169    14531    3         END;
     1170    14532
     1171    14533    2         IF PS_SELECT_RPN.INFO.USED# = 0
     1172    14534    2         THEN
     1173    14535    2         STATUS_SELECT = 'all';
     1174    14536    2         ELSE
     1175    14537    2         CALL PSR$UN_RPN(PS_SELECT_RPN, STATUS_SELECT, I,
     1176    14538    2           LENGTHC(STATUS_SELECT));
     1177    14539
     1178    14540    2         IF PS_START_UTS = 0
     1179    14541    3         THEN DO;
     1180    14542
     1181    14543    3            IF PS_END_UTS = BITBIN('777777777777'O)
     1182    14544    3            THEN
     1183    14545    3            STATUS_TIME = 'all';
     1184    14546
     1185    14547    4            ELSE DO;
     1186    14548
     1187    14549    4               STATUS_TIME = '- ';
     1188    14550    4               CALL CONVERT_UTS (PS_END_UTS, SUBSTR(STATUS_TIME, 2));
     1189    14551    4            END;
     1190    14552
     1191    14553    3         END;
     1192    14554
     1193    14555    3         ELSE DO;
     1194    14556
     1195    14557    3            STATUS_TIME = 'mm/dd/yy,hh:mm -';
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:54   
     1196    14558    3            CALL CONVERT_UTS (PS_START_UTS, STATUS_TIME);
     1197    14559
     1198    14560    3            IF PS_END_UTS ~= BITBIN('777777777777'O)
     1199    14561    3            THEN
     1200    14562    3            CALL CONVERT_UTS (PS_END_UTS, SUBSTR(STATUS_TIME, 17));
     1201    14563
     1202    14564    3         END;
     1203    14565
     1204    14566    2         CALL SETUP_TOKENS (STATUS_MISC, PS_DISPLAY_FLAGS);
     1205    14567    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_DI_FMT), VECTOR(STATUS_MISC));
     1206    14568    2         CALL SETUP_FEP(STATUS_MISC, PS_FEP_DISP_FLAGS(0));
     1207    14569    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPS_FMT), VECTOR(STATUS_MISC));
     1208    14570    3         DO FEP_IX = 1 TO %PS_MAXFE#;
     1209    14571    4            IF PS_FEP_DISP_FLAGS(FEP_IX) ~= PS_FEP_DISP_FLAGS(0) THEN DO;
     1210    14572    4               CALL SETUP_FEP(STATUS_MISC, PS_FEP_DISP_FLAGS(FEP_IX));
     1211    14573    4               CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPN_FMT),
     1212    14574    4                 VECTOR(FEP_IX), VECTOR(STATUS_MISC));
     1213    14575    4            END;
     1214    14576    3         END;
     1215    14577
     1216    14578    2         CALL SETUP_TOKENS (STATUS_MISC, PS_LOG_FLAGS);
     1217    14579    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_LOG_FMT), VECTOR(STATUS_MISC));
     1218    14580    2         CALL SETUP_FEP(STATUS_MISC, PS_FEP_LOG_FLAGS(0));
     1219    14581    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPS_FMT), VECTOR(STATUS_MISC));
     1220    14582    3         DO FEP_IX = 1 TO %PS_MAXFE#;
     1221    14583    4            IF PS_FEP_LOG_FLAGS(FEP_IX) ~= PS_FEP_LOG_FLAGS(0) THEN DO;
     1222    14584    4               CALL SETUP_FEP(STATUS_MISC, PS_FEP_LOG_FLAGS(FEP_IX));
     1223    14585    4               CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPN_FMT),
     1224    14586    4                 VECTOR(FEP_IX), VECTOR(STATUS_MISC));
     1225    14587    4            END;
     1226    14588    3         END;
     1227    14589
     1228    14590    2         CALL X$WRITE (PS_FDS, VECTOR(STATUS_FORMAT),
     1229    14591    2           VECTOR(PS_INTERVAL),
     1230    14592    2           VECTOR(STATUS_FID),
     1231    14593    2           VECTOR(STATUS_TIME),
     1232    14594    2           VECTOR(STATUS_SELECT));
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:55   
     1233    14595
     1234    14596        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:56   
     1235    14597    2      CASE (26 /* understood command, didn't grok options */);
     1236    14598
     1237    14599    2         CALL XUR$ECHOIF (DCBNUM(M$ME));
     1238    14600
     1239    14601    2         CALL XUR$ERRPTR ( , DCBNUM(M$ME));
     1240    14602
     1241    14603    2         CALL M$CORRES (COMPARE_M$ME_AND_M$LO) ALTRET (REPORT_PARTIAL_ERROR);
     1242    14604
     1243    14605    2         CALL XUR$ECHOIF (DCBNUM(M$LO));
     1244    14606
     1245    14607    2         CALL XUR$ERRPTR ( , DCBNUM(M$LO));
     1246    14608
     1247    14609    2   REPORT_PARTIAL_ERROR:
     1248    14610
     1249    14611    2         CALL PSE$ERRMSG (OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE, WARNING#);
     1250    14612
     1251    14613    2      CASE (ELSE);
     1252    14614
     1253    14615    2         CALL M$ERR;
     1254    14616
     1255    14617    2      END;
     1256    14618
     1257    14619    1      RETURN;
     1258    14620
     1259    14621        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:57   
     1260    14622    1   PSA$BLURTFEP: ENTRY;
     1261    14623
     1262    14624    1      CALL SETUP_FEP(STATUS_MISC, PS_HLPCGBUF.DSPMSK);
     1263    14625    1      CALL X$WRITE(PS_FDS, VECTOR(FEP_BLURT_FMT), VECTOR(PS_HLPCGBUF.NODE_NUM),
     1264    14626    1        VECTOR(PS_HLPCGBUF.HANDLER), VECTOR(STATUS_MISC));
     1265    14627    1      RETURN;
     1266    14628        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:58   
     1267    14629    1   FEPBITS: PROC ( FEPMASK, NODE$, MASKS ) ;
     1268    14630
     1269    14631    2   DCL NODE$ PTR ;
     1270    14632        %PS_FEPMASK ( NAME=FEPMASK, STCLASS=PARAM ) ;
     1271    14698        %PS_FEPMASK ( NAME="MASKS(0:0)", STCLASS=PARAM ) ;
     1272    14764
     1273    14765    2   DCL IT UBIN;
     1274    14766
     1275    14767    2      FEPMASK = '0'B ;
     1276    14768    2      HANDLER = ' ' ;
     1277    14769
     1278    14770    2      IF NODE$->OUT$BLK.NSUBLKS = 0 THEN
     1279    14771    2      FEPMASK = MASKS(1 /* all */ ) ;
     1280    14772    2      ELSE
     1281    14773    3      DO IT = 0 TO NODE$->OUT$BLK.NSUBLKS-1 ;
     1282    14774
     1283    14775    3         IF NODE$->OUT$BLK.SUBLK$(IT)->OUT$BLK.CODE = 0 /* handler */
     1284    14776    4         THEN DO ;
     1285    14777    4            HANDLER = NODE$->OUT$BLK.SUBLK$(IT)->OUT$SYM.TEXT ;
     1286    14778    4         END ;
     1287    14779
     1288    14780    3         FEPMASK = FEPMASK | MASKS(NODE$->OUT$BLK.SUBLK$(IT)->OUT$BLK.CODE) ;
     1289    14781    3      END;
     1290    14782    2   END FEPBITS;
     1291    14783        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:59   
     1292    14784    1   UPBITS: PROC;
     1293    14785
     1294    14786    3      DO CASE (CHANGE_MODE);
     1295    14787
     1296    14788    3      CASE (0 /* new flags */);
     1297    14789
     1298    14790    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) = DISP;
     1299    14791    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) = SLCT;
     1300    14792    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.HANDLER(PS_FEPNO) = HANDLER ;
     1301    14793
     1302    14794    3      CASE (1 /* Add flags */);
     1303    14795
     1304    14796    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) =
     1305    14797    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) | DISP;
     1306    14798    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) =
     1307    14799    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) | SLCT;
     1308    14800    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.HANDLER(PS_FEPNO) = HANDLER ;
     1309    14801
     1310    14802    3      CASE (2 /* Delete flags */);
     1311    14803
     1312    14804    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) =
     1313    14805    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) & ~ DISP;
     1314    14806    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) =
     1315    14807    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) & ~ SLCT;
     1316    14808    4         IF SLCT & FEP_SLCT_MODE_MASKS.HANDLER THEN DO ;
     1317    14809    4            FEP_FLAGS$->PS_FEP_BASED_FLAGS.HANDLER(PS_FEPNO) = ' ' ;
     1318    14810    4         END ;
     1319    14811
     1320    14812    3      END /* CASE */;
     1321    14813    2   END UPBITS;
     1322    14814        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:60   
     1323    14815    1   GENERATE_SCALE: PROC (LOW, HIGH, SCALE, POINTS, VALUE);
     1324    14816
     1325    14817    2   DCL LOW UBIN;
     1326    14818    2   DCL HIGH UBIN;
     1327    14819    2   DCL SCALE UBIN;
     1328    14820    2   DCL POINTS UBIN;
     1329    14821    2   DCL POINTS_SBIN REDEF POINTS SBIN;
     1330    14822    2   DCL VALUE (0:0) UBIN;
     1331    14823
     1332    14824    2   DCL I UBIN;
     1333    14825    2   DCL DX SBIN;
     1334    14826    2   DCL FACTOR UBIN;
     1335    14827    2   DCL FACTOR_SBIN REDEF FACTOR SBIN;
     1336    14828    2   DCL MFACTOR UBIN;
     1337    14829    2   DCL MFACTOR_SBIN REDEF MFACTOR SBIN;
     1338    14830    2   DCL KEEP_SCANNING LOGICAL;
     1339    14831
     1340    14832    3      DO CASE (SCALE);
     1341    14833
     1342    14834    3      CASE (0 /* linear */);
     1343    14835
     1344    14836    3         VALUE(0) = LOW;
     1345    14837
     1346    14838    3         IF (HIGH - LOW) / POINTS_SBIN > 20
     1347    14839    3         THEN
     1348    14840    3         FACTOR = 10;
     1349    14841    3         ELSE
     1350    14842    3         FACTOR = 1;
     1351    14843
     1352    14844    4         DO I = 1 TO POINTS-1;
     1353    14845
     1354    14846    4            VALUE(I) = ((FACTOR/2 + LOW + (((HIGH-LOW) * I) /
     1355    14847    4              (POINTS_SBIN-1))) / FACTOR_SBIN ) * FACTOR;
     1356    14848
     1357    14849    4            IF VALUE(I) <= VALUE(I-1)
     1358    14850    4            THEN
     1359    14851    4            VALUE(I) = VALUE(I-1) + 1;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:61   
     1360    14852
     1361    14853    4         END;
     1362    14854        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:62   
     1363    14855    3      CASE (1 /* log */);
     1364    14856
     1365    14857    3         FACTOR = 1100;
     1366    14858    3         DX = 100;
     1367    14859
     1368    14860    3         IF LOW = 0
     1369    14861    3         THEN
     1370    14862    3         LOW = 1;
     1371    14863
     1372    14864    4         DO WHILE (DX ~= 0);
     1373    14865
     1374    14866    4            KEEP_SCANNING = %YES#;
     1375    14867
     1376    14868    5            DO WHILE (KEEP_SCANNING);
     1377    14869
     1378    14870    5               MFACTOR = FACTOR;
     1379    14871    5               VALUE(0) = LOW;
     1380    14872
     1381    14873    6               DO I = 1 TO POINTS-1;
     1382    14874
     1383    14875    6                  VALUE(I) = (LOW * MFACTOR) / 1000;
     1384    14876
     1385    14877    6                  IF VALUE(I) <= VALUE(I-1)
     1386    14878    6                  THEN
     1387    14879    6                  VALUE(I) = VALUE(I-1) + 1;
     1388    14880
     1389    14881    6                  MFACTOR = (MFACTOR * FACTOR) / 1000;
     1390    14882
     1391    14883    6               END;
     1392    14884
     1393    14885    5               IF VALUE(POINTS-1) = HIGH
     1394    14886    6               THEN DO;
     1395    14887
     1396    14888    6                  DX = 0;
     1397    14889    6                  KEEP_SCANNING = %NO#;
     1398    14890    6               END;
     1399    14891
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:63   
     1400    14892    6               ELSE DO;
     1401    14893
     1402    14894    6                  IF (VALUE(POINTS-1) > HIGH AND DX > 0)
     1403    14895    6                    OR (VALUE(POINTS-1) < HIGH AND DX < 0)
     1404    14896    7                  THEN DO;
     1405    14897
     1406    14898    7                     KEEP_SCANNING = %NO#;
     1407    14899    7                     DX = -DX / 10;
     1408    14900    7                  END;
     1409    14901
     1410    14902    7                  ELSE DO;
     1411    14903
     1412    14904    7                     IF (FACTOR <= 1000 AND DX < 0)
     1413    14905    8                     THEN DO;
     1414    14906
     1415    14907    8                        DX = 0;
     1416    14908    8                        KEEP_SCANNING = %NO#;
     1417    14909    8                     END;
     1418    14910
     1419    14911    8                     ELSE DO;
     1420    14912
     1421    14913    8                        FACTOR = FACTOR + DX;
     1422    14914    8                     END;
     1423    14915
     1424    14916    7                  END;
     1425    14917
     1426    14918    6               END;
     1427    14919
     1428    14920    5            END /* do while (keep_scanning) */ ;
     1429    14921
     1430    14922    4         END /* do while (dx ~= 0) */ ;
     1431    14923
     1432    14924    3         FACTOR = HIGH - LOW;
     1433    14925
     1434    14926    3         MFACTOR = VALUE(POINTS-1) - LOW;
     1435    14927
     1436    14928    4         DO I = 1 TO POINTS-1;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:64   
     1437    14929
     1438    14930    4            VALUE(I) = LOW + ((VALUE(I) - LOW) * FACTOR) / MFACTOR_SBIN ;
     1439    14931
     1440    14932    4            IF VALUE(I) <= VALUE(I-1)
     1441    14933    4            THEN
     1442    14934    4            VALUE(I) = VALUE(I-1) + 1;
     1443    14935
     1444    14936    4         END;
     1445    14937
     1446    14938    3      END /* do case (scale) */ ;
     1447    14939
     1448    14940    2      RETURN;
     1449    14941
     1450    14942    2   END GENERATE_SCALE;
     1451    14943        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:65   
     1452    14944    1   SET_FLAGS: PROC (BLOCK_NUM, FLAGS);
     1453    14945
     1454    14946    2   DCL BLOCK_NUM UBIN;
     1455    14947
     1456    14948
     1457    14949    2   DCL 1 FLAGS UNAL, /* Yes, I know. */
     1458    14950    2          2 SNAP LOGICAL,
     1459    14951    2          2 ALL LOGICAL;
     1460    14952
     1461    14953    2   DCL CODA UBIN;
     1462    14954
     1463    14955    2      IF OUT$BLK.SUBLK$(BLOCK_NUM) -> OUT$BLK.NSUBLKS = 0
     1464    14956    2      THEN
     1465    14957    2      CODA = 0;
     1466    14958    2      ELSE
     1467    14959    2      CODA = OUT$BLK.SUBLK$(BLOCK_NUM) -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;
     1468    14960
     1469    14961    3      DO CASE (CODA);
     1470    14962
     1471    14963    3      CASE (0 /* both */);
     1472    14964
     1473    14965    3         FLAGS.SNAP = %YES#;
     1474    14966    3         FLAGS.ALL = %YES#;
     1475    14967
     1476    14968    3      CASE (1 /* snap */);
     1477    14969
     1478    14970    3         FLAGS.SNAP = %YES#;
     1479    14971    3         FLAGS.ALL = %NO#;
     1480    14972
     1481    14973    3      CASE (2 /* all */);
     1482    14974
     1483    14975    3         FLAGS.SNAP = %NO#;
     1484    14976    3         FLAGS.ALL = %YES#;
     1485    14977
     1486    14978    3      END;
     1487    14979
     1488    14980    2      RETURN;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:66   
     1489    14981
     1490    14982    2   END SET_FLAGS;
     1491    14983        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:67   
     1492    14984    1   SETUP_STATS_ENTRY: PROC (CMD$BLK, I, POINTS);
     1493    14985
     1494    14986        %PARSE$OUT (NAME=CMD$BLK, STCLASS=" ");
     1495    15031
     1496    15032        %PARSE$OUT (NAME=ENTRY$BLK, STCLASS="BASED(BLOCK$)");
     1497    15077    2   DCL I UBIN;
     1498    15078    2   DCL POINTS UBIN;
     1499    15079
     1500    15080    2   DCL J UBIN;
     1501    15081    2   DCL LOW UBIN;
     1502    15082    2   DCL HIGH UBIN;
     1503    15083    2   DCL SCALE UBIN;
     1504    15084    2   DCL CPOS1 UBIN;
     1505    15085    2   DCL CPOS2 UBIN;
     1506    15086    2   DCL DOING_ALL LOGICAL;
     1507    15087    2   DCL TITLE CHAR (24);
     1508    15088    2   DCL BLOCK$ PTR;
     1509    15089    2   DCL P$ PTR;
     1510    15090    2   DCL Q$ PTR;
     1511    15091
     1512    15092    2      IF I < CMD$BLK.NSUBLKS
     1513    15093    3      THEN DO /* it's a valid item */;
     1514    15094
     1515    15095    3         BLOCK$ = CMD$BLK.SUBLK$(I);
     1516    15096
     1517    15097    3         DOING_ALL = %NO#;
     1518    15098
     1519    15099    3         CALL PSR$RPN (ENTRY$BLK.SUBLK$(0)->OUT$BLK,
     1520    15100    3           PS_STATS.RPN$(I)->BASED_RPN);
     1521    15101
     1522    15102    3         J = PS_STATS.RPN$(I)->BASED_RPN.INFO.SYMBOL_ID#;
     1523    15103
     1524    15104    3      END;
     1525    15105
     1526    15106    3      ELSE DO /* zero-length command list ("STATISTICS ALL") - fake it */;
     1527    15107
     1528    15108    3         DOING_ALL = %YES#;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:68   
     1529    15109
     1530    15110    3         J = I;
     1531    15111
     1532    15112    3         PS_STATS.RPN$(I)->BASED_RPN.INFO.SYMBOL_FOUND# = %YES#;
     1533    15113    3         PS_STATS.RPN$(I)->BASED_RPN.INFO.SYMBOL_ID# = J;
     1534    15114    3         PS_STATS.RPN$(I)->BASED_RPN.INFO.USED# = 1;
     1535    15115    3         PS_STATS.RPN$(I)->BASED_RPN.ITEM.OPCODE#(0) = PUSH_SYMBOL#;
     1536    15116    3         PS_STATS.RPN$(I)->BASED_RPN.ITEM.ARG#(0) = J;
     1537    15117
     1538    15118    3      END;
     1539    15119
     1540    15120    2      PS_STATS.SCALE(I) = V_TABLE.SCALE(J);
     1541    15121    2      PS_STATS.LOW(I) = V_TABLE.LOW(J);
     1542    15122    2      PS_STATS.HIGH(I) = V_TABLE.HIGH(J);
     1543    15123
     1544    15124    2      IF NOT DOING_ALL
     1545    15125    2        AND ENTRY$BLK.NSUBLKS = 2
     1546    15126    3      THEN DO;
     1547    15127
     1548    15128    3         P$ = ENTRY$BLK.SUBLK$(1);
     1549    15129
     1550    15130    4         DO J = 0 TO P$->OUT$BLK.NSUBLKS - 1;
     1551    15131
     1552    15132    4            Q$ = P$->OUT$BLK.SUBLK$(J);
     1553    15133
     1554    15134    5            DO CASE (Q$->OUT$BLK.CODE);
     1555    15135
     1556    15136    5            CASE (4 /* limits */);
     1557    15137
     1558    15138    5               CALL CHARBIN (PS_STATS.LOW(I), Q$->OUT$BLK.SUBLK$(0)->
     1559    15139    5                 OUT$SYM.TEXT);
     1560    15140
     1561    15141    5               CALL CHARBIN (PS_STATS.HIGH(I), Q$->OUT$BLK.SUBLK$(1)->
     1562    15142    5                 OUT$SYM.TEXT);
     1563    15143
     1564    15144    5               IF PS_STATS.LOW(I) >= PS_STATS.HIGH(I)
     1565    15145    5               THEN
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:69   
     1566    15146    5               CALL PSE$ERRMSG (E$PS_BAD_LIMITS, SERIOUS#);
     1567    15147
     1568    15148    5            CASE (ELSE);
     1569    15149
     1570    15150    5               PS_STATS.SCALE(I) = Q$->OUT$BLK.CODE;
     1571    15151
     1572    15152    5            END;
     1573    15153
     1574    15154    4         END;
     1575    15155
     1576    15156    3      END;
     1577    15157
     1578    15158    2      LOW = PS_STATS.LOW(I);
     1579    15159    2      HIGH = PS_STATS.HIGH(I);
     1580    15160    2      SCALE = PS_STATS.SCALE(I);
     1581    15161
     1582    15162    2      CALL GENERATE_SCALE (LOW, HIGH, SCALE,
     1583    15163    2        PS_STATS.BUCKET$(I) -> BASED_BUCKET.SIZE,
     1584    15164    2        PS_STATS.BUCKET$(I) -> BASED_BUCKET.DATA);
     1585    15165
     1586    15166    2      CALL GENERATE_SCALE (LOW, HIGH, SCALE, POINTS-1,
     1587    15167    2        PS_STATS.PLOT$(I) -> PS_PLOT_VALUES);
     1588    15168
     1589    15169    2      RETURN;
     1590    15170
     1591    15171    2   END SETUP_STATS_ENTRY;
     1592    15172        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:70   
     1593    15173    1   CHECK_FOR_EXPM: PROC;
     1594    15174
     1595    15175    2      IF (B$JIT.PRIV.ACTIVE & %PR_EXPM#) = '0'B
     1596    15176    2      THEN
     1597    15177    2      CALL PSE$ERRMSG (E$PS_NEED_EXPM, WARNING#);
     1598    15178
     1599    15179    2      RETURN;
     1600    15180
     1601    15181    2   END CHECK_FOR_EXPM;
     1602    15182        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:71   
     1603    15183    1   SET_TIME: PROC (UTS_RESULT, TIME$BLK, DEFAULT_TIME);
     1604    15184
     1605    15185        %PARSE$OUT (NAME=TIME$BLK, STCLASS=" ");
     1606    15230    2   DCL UTS_RESULT UBIN;
     1607    15231    2   DCL DEFAULT_TIME CHAR(11);
     1608    15232
     1609    15233    2      TIME_AREA_C = DEFAULT_TIME;
     1610    15234    2      DATE_AREA.VECTOR_PORTION.REAL = TODAYS_DATE;
     1611    15235
     1612    15236    3      DO CASE (TIME$BLK.CODE);
     1613    15237
     1614    15238    3      CASE (0 /* date,time specified */);
     1615    15239
     1616    15240    3         CALL MOVE_DATE (TIME$BLK.SUBLK$(0)->OUT$BLK);
     1617    15241    3         CALL MOVE_TIME (TIME$BLK.SUBLK$(1)->OUT$BLK);
     1618    15242
     1619    15243    3      CASE (1 /* time,date specified */);
     1620    15244
     1621    15245    3         CALL MOVE_TIME (TIME$BLK.SUBLK$(0)->OUT$BLK);
     1622    15246    3         CALL MOVE_DATE (TIME$BLK.SUBLK$(1)->OUT$BLK);
     1623    15247
     1624    15248    3      CASE (2 /* date specified */);
     1625    15249
     1626    15250    3         CALL MOVE_DATE(TIME$BLK.SUBLK$(0)->OUT$BLK);
     1627    15251
     1628    15252    3      CASE (3 /* time specified */);
     1629    15253
     1630    15254    3         CALL MOVE_TIME (TIME$BLK.SUBLK$(0)->OUT$BLK);
     1631    15255
     1632    15256    3      END;
     1633    15257
     1634    15258    2      CONVERT_TO_UTS.TSTAMP_ = VECTOR(UTS_RESULT);
     1635    15259
     1636    15260    2      CALL M$TIME (CONVERT_TO_UTS) ALTRET (TIME_ERROR);
     1637    15261
     1638    15262    2      RETURN;
     1639    15263
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:72   
     1640    15264    2   TIME_ERROR:
     1641    15265    2      CALL PSE$ERRMSG ( , SERIOUS#);
     1642    15266
     1643    15267    2   END SET_TIME;
     1644    15268        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:73   
     1645    15269    1   MOVE_DATE: PROC (TIME$BLK);
     1646    15270
     1647    15271        %PARSE$OUT (NAME=TIME$BLK, STCLASS=" ");
     1648    15316    2   DCL I UBIN;
     1649    15317    2   DCL J UBIN;
     1650    15318
     1651    15319    3      DO I = 0 TO TIME$BLK.NSUBLKS - 1;
     1652    15320
     1653    15321    3         CALL CHARBIN (J, TIME$BLK.SUBLK$(I)->OUT$SYM.TEXT);
     1654    15322    3         CALL BINCHAR (DATE_AREA.PORTION.DIGITS(I), J);
     1655    15323    3      END;
     1656    15324
     1657    15325    2      RETURN;
     1658    15326
     1659    15327    2   END MOVE_DATE;
     1660    15328
     1661    15329    1   MOVE_TIME: PROC (TIME$BLK);
     1662    15330
     1663    15331        %PARSE$OUT (NAME=TIME$BLK, STCLASS=" ");
     1664    15376    2   DCL I UBIN;
     1665    15377    2   DCL J UBIN;
     1666    15378
     1667    15379    3      DO I = 0 TO 1;
     1668    15380
     1669    15381    3         CALL CHARBIN (J, TIME$BLK.SUBLK$(I)->OUT$SYM.TEXT);
     1670    15382    3         CALL BINCHAR (TIME_AREA.PORTION.DIGITS(I), J);
     1671    15383    3      END;
     1672    15384
     1673    15385    2      RETURN;
     1674    15386
     1675    15387    2   END MOVE_TIME;
     1676    15388        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:74   
     1677    15389    1   INSERT_TOKEN: PROC (STRING, TOKEN, FLAG);
     1678    15390
     1679    15391    2   DCL STRING CHAR (120);
     1680    15392    2   DCL TOKEN CHAR (15);
     1681    15393    2   DCL FLAG BIT(1) UNAL; /* Yes, I know. */
     1682    15394
     1683    15395    2   DCL CPOS UBIN;
     1684    15396    2   DCL TOKEN_LEN UBIN;
     1685    15397
     1686    15398    2      IF ADDR(FLAG) ~= ADDR(NIL)
     1687    15399    2        AND NOT FLAG
     1688    15400    2      THEN
     1689    15401    2      RETURN;
     1690    15402
     1691    15403    2      CALL INDEX (TOKEN_LEN, '.', TOKEN);
     1692    15404
     1693    15405    2      CALL INDEX1R (CPOS, '.', STRING);
     1694    15406
     1695    15407    2      IF CPOS = LENGTHC(STRING)
     1696    15408    2      THEN
     1697    15409    2      CPOS = 0;
     1698    15410
     1699    15411    2      IF CPOS >= LENGTHC(STRING) - TOKEN_LEN
     1700    15412    2      THEN
     1701    15413    2      RETURN;
     1702    15414
     1703    15415    2      CALL INSERT (STRING, CPOS, , SUBSTR(TOKEN, 0, TOKEN_LEN), '.');
     1704    15416
     1705    15417    2      RETURN;
     1706    15418
     1707    15419    2   END INSERT_TOKEN;
     1708    15420
     1709    15421        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:75   
     1710    15422    1   SETUP_TOKENS: PROC (STRING, FLAGS);
     1711    15423
     1712    15424    2   DCL STRING CHAR (120);
     1713    15425    2   DCL FLAGS BIT (36) ALIGNED;
     1714    15426
     1715    15427
     1716    15428        %SUB FLAG="ADDR(FLAGS)->PS_BASED_FLAGS";
     1717    15429
     1718    15430    2      STRING = ' ';
     1719    15431
     1720    15432    2      IF FLAG.CPU AND FLAG.RESOURCES AND FLAG.DEVICES
     1721    15433    2        AND FLAG.CHANNELS AND FLAG.SCPU AND FLAG.PROCS
     1722    15434    2        AND (FLAG.SUMMARY OR PS_SUMMARY_ITEMS = 0)
     1723    15435    2        AND FLAG.HISTOGRAMS AND FLAG.FAULT
     1724    15436    3      THEN DO;
     1725    15437
     1726    15438    3         IF FLAG.MOUSE AND FLAG.FEP
     1727    15439    3         THEN
     1728    15440    3         STRING = 'all';
     1729    15441    3         ELSE
     1730    15442    3         CALL INSERT_TOKEN (STRING, 'PM data, .');
     1731    15443
     1732    15444    3      END;
     1733    15445
     1734    15446    3      ELSE DO;
     1735    15447
     1736    15448    3         CALL INSERT_TOKEN (STRING, 'CPU, .', FLAG.CPU);
     1737    15449    3         CALL INSERT_TOKEN (STRING, 'SCPU, .', FLAG.SCPU);
     1738    15450    3         CALL INSERT_TOKEN (STRING, 'resources, .', FLAG.RESOURCES);
     1739    15451    3         CALL INSERT_TOKEN (STRING, 'devices, .', FLAG.DEVICES);
     1740    15452    3         CALL INSERT_TOKEN (STRING, 'channels, .', FLAG.CHANNELS);
     1741    15453    3         CALL INSERT_TOKEN (STRING, 'processors, .', FLAG.PROCS);
     1742    15454    3         CALL INSERT_TOKEN (STRING, 'faults, .', FLAG.FAULT);
     1743    15455    3         CALL INSERT_TOKEN (STRING, 'summary, .', FLAG.SUMMARY);
     1744    15456    3         CALL INSERT_TOKEN (STRING, 'histograms, .', FLAG.HISTOGRAMS);
     1745    15457
     1746    15458    3      END;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:76   
     1747    15459
     1748    15460    2      IF STRING ~= 'all'
     1749    15461    3      THEN DO;
     1750    15462
     1751    15463    3         CALL INSERT_TOKEN (STRING, 'MoUsE, .', FLAG.MOUSE);
     1752    15464
     1753    15465    3         IF STRING = ' '
     1754    15466    3         THEN
     1755    15467    3         STRING = 'Host none';
     1756    15468
     1757    15469    4         ELSE DO;
     1758    15470
     1759    15471    4            CALL INDEX1R (I, ',', STRING);
     1760    15472    4            CALL INSERT (STRING, I, , '  ');
     1761    15473    4         END;
     1762    15474
     1763    15475    3      END;
     1764    15476
     1765    15477    2      RETURN;
     1766    15478
     1767    15479    2   END SETUP_TOKENS;
     1768    15480
     1769    15481        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:77   
     1770    15482    1   SETUP_FEP: PROC (STRING, FLAGS) ;
     1771    15483
     1772    15484    2   DCL 1 STRING CHAR (120) ;
     1773    15485    2   DCL 1 FLAGS ALIGNED,
     1774    15486        %PS_FEPMASK ( NAME=DISP, LVL=2, LAST="," ) ;
     1775    15552        %PS_FEPMASK ( NAME=SLCT, LVL=2, LAST="," ) ;
     1776    15618    2          2 HANDLER CHAR(8) CALIGNED ;
     1777    15619
     1778    15620    2   DCL 1 MASK ALIGNED,
     1779    15621        %PS_FEPMASK ( NAME=DISP, LVL=2, LAST="," ) ;
     1780    15687        %PS_FEPMASK ( NAME=SLCT, LVL=2, LAST="," ) ;
     1781    15753    2          2 HANDLER CHAR(8) CALIGNED,
     1782    15754    2          2 PERIOD CHAR(2) CALIGNED ;
     1783    15755    2   DCL ENT UBIN;
     1784    15756
     1785    15757    2      STRING = ' ';
     1786    15758    2      MASK = FLAGS;
     1787    15759    2      MASK.PERIOD = ' .' ;
     1788    15760
     1789    15761    2      IF ( MASK.DISP & FEP_DISP_MODE_MASKS.SUMMARY ) =
     1790    15762    3        FEP_DISP_MODE_MASKS.SUMMARY THEN DO ;
     1791    15763    3         CALL INSERT_TOKEN ( STRING, 'Summary .', '1'B ) ;
     1792    15764    3         MASK.DISP = MASK.DISP & ~FEP_DISP_MODE_MASKS.SUMMARY ;
     1793    15765    3      END ;
     1794    15766    2      ELSE IF ( MASK.DISP & FEP_DISP_MODE_MASKS.EXTENDED ) =
     1795    15767    3        FEP_DISP_MODE_MASKS.EXTENDED THEN DO ;
     1796    15768    3         CALL INSERT_TOKEN ( STRING, 'Extended .', '1'B ) ;
     1797    15769    3         MASK.DISP = MASK.DISP & ~FEP_DISP_MODE_MASKS.EXTENDED ;
     1798    15770    3      END ;
     1799    15771
     1800    15772    3   D: DO ENT = 1 TO (SIZEW(FEP_DISP_MASKS)/SIZEW(FEP_MASK))-1 ;
     1801    15773    3         IF ( MASK.DISP & FEP_DISP_MASKS$->FEP_MASK(ENT) ) =
     1802    15774    4           FEP_DISP_MASKS$->FEP_MASK(ENT) THEN DO ;
     1803    15775    4            CALL INSERT_TOKEN ( STRING, FEP_DISP_TOKENS(ENT), '1'B ) ;
     1804    15776    4            MASK.DISP = MASK.DISP & ~FEP_DISP_MASKS$->FEP_MASK(ENT) ;
     1805    15777    4            IF MASK.DISP = '0'B THEN EXIT D ;
     1806    15778    4         END ;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:78   
     1807    15779    3      END ;
     1808    15780
     1809    15781    2      CALL INDEX ( I, ' .', STRING ) ;
     1810    15782    2      CALL INSERT ( STRING, I, , ' for .' ) ;
     1811    15783
     1812    15784    3   S: DO ENT = 0 TO (SIZEW(FEP_SLCT_MASKS)/SIZEW(FEP_MASK))-1 ;
     1813    15785    3         IF ( MASK.SLCT & FEP_SLCT_MASKS$->FEP_MASK(ENT) ) =
     1814    15786    4           FEP_SLCT_MASKS$->FEP_MASK(ENT) THEN DO ;
     1815    15787    4            IF ENT = 0 THEN
     1816    15788    4            CALL INSERT_TOKEN ( STRING, MASK.HANDLER, '1'B ) ;
     1817    15789    4            ELSE
     1818    15790    4            CALL INSERT_TOKEN ( STRING, FEP_SLCT_TOKENS(ENT), '1'B ) ;
     1819    15791    4            MASK.SLCT = MASK.SLCT & ~FEP_SLCT_MASKS$->FEP_MASK(ENT) ;
     1820    15792    4            IF MASK.SLCT = '0'B THEN EXIT S ;
     1821    15793    4         END ;
     1822    15794    3      END ;
     1823    15795
     1824    15796    2      CALL INDEX ( I, ' .', STRING )
     1825    15797    3      WHENRETURN DO ;
     1826    15798    3         CALL INSERT ( STRING, I, , ' ' ) ;
     1827    15799    3      END ;
     1828    15800
     1829    15801    2   END SETUP_FEP;
     1830    15802        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:79   
     1831    15803    1   CONVERT_UTS: PROC (UTS, CHAR_AREA);
     1832    15804
     1833    15805    2   DCL UTS UBIN;
     1834    15806
     1835    15807    2   DCL 1 CHAR_AREA,
     1836    15808    2          2 DATE@ CHAR (8),
     1837    15809    2          2 COMMA CHAR (1),
     1838    15810    2          2 TIME@ CHAR (5);
     1839    15811
     1840    15812    2   DCL TIME@ CHAR (11);
     1841    15813
     1842    15814
     1843    15815        %FPT_TIME (SOURCE=UTS,
     1844    15816         DEST=LOCAL);
     1845    15835
     1846    15836    2      FPT_TIME.TSTAMP_ = VECTOR(UTS);
     1847    15837    2      FPT_TIME.DATE_ = VECTOR(CHAR_AREA.DATE@);
     1848    15838    2      FPT_TIME.TIME_ = VECTOR(TIME@);
     1849    15839
     1850    15840    2      CALL M$TIME (FPT_TIME) ALTRET (TIME_URPED);
     1851    15841
     1852    15842    3      DO NEVER;
     1853    15843
     1854    15844    3   TIME_URPED:
     1855    15845
     1856    15846    3         CHAR_AREA.DATE@ = '??/??/??';
     1857    15847    3         CHAR_AREA.TIME@ = '??:??:??.??';
     1858    15848
     1859    15849    3      END;
     1860    15850
     1861    15851    2      CHAR_AREA.TIME@ = TIME@;
     1862    15852    2      CHAR_AREA.COMMA = ',';
     1863    15853
     1864    15854    2      RETURN;
     1865    15855
     1866    15856    2   END CONVERT_UTS;
     1867    15857
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:80   
     1868    15858    1   END;
     1869    15859        %EOD;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:81   
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   PS_PERR_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PSA$INIT.

   Procedure PSA$INIT requires 2629 words for executable code.
   Procedure PSA$INIT requires 242 words of local(AUTO) storage.

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:82   

 Object Unit name= PSA$INIT                                   File name= PSA$MAIN.:E05TOU
 UTS= JUL 30 '97 04:25:59.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$DO
    2   DCB   even  none     0      0  M$SI
    3   DCB   even  none     0      0  F$LOG
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$HLPCG
    6  RtLbCm even  none    30     36  PS_FDS
    7  RtLbCm even  none    32     40  PS_SELECT_RPN
    8  RtLbCm even  none    17     21  PS_STATS_RPN
    9  RtLbCm even  none    34     42  PS_STATS_BUCKET
   10   DCB   even  none     0      0  M$UC
   11   Data  even  none  2692   5204  PSA$INIT
   12  RoData even  UTS    335    517  PSA$INIT
   13   Proc  even  none  2629   5105  PSA$INIT
   14  RoData even  none   127    177  PSA$INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        0  PSA$INIT
    13    107                  yes      Std        0  PSA$RESTART
    13    314                  yes      Std        0  PSA$INPUT
    13    441                  yes      Std        0  PSA$DOIT
    13   2742                  yes      Std        0  PSA$BLURTFEP
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:83   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 PSA$BREAK
 yes     yes           Std       2 XTX$ADAPT
         yes          Async      0 XUR$BREAK
         yes          Async      0 PSA$TRAPPED
         yes           Std       2 PSM$ALLOC
         yes           Std       4 PSR$UN_RPN
         yes           Std       5 PSE$GRIPE
 yes     yes           Std       6 XUR$GETCMD
         yes           Std       5 PSE$ERRMSG
 yes     yes           Std       1 XUR$ECHOIF
         yes           Std       0 PSD$DISP
 yes     yes           Std       3 XUR$INIT
         yes           Std      22 X$WRITE
 yes     yes           Std       2 XUR$ERRPTR
         yes           Std       2 PSR$RPN
         yes           Std       1 PSM$FREESEG
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:84   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$LO                                  M$DO                                  M$SI
     F$LOG                                 M$ME                                  M$HLPCG
     PS_PMDAT$                             PS_OLD_PMDAT$                         PS_LOGFILE$
     PS_MOUSE$                             PS_OLD_MOUSE$                         PS_FEP$
     PS_OLD_FEP$                           PS_PMDAT_SIZE                         PS_OLD_PMDAT_SIZE
     PS_NEEDED_PMDAT_SIZE                  PS_LOGFILE_SIZE                       PS_NEEDED_LOGFILE_SIZE
     PS_MOUSE_SIZE                         PS_OLD_MOUSE_SIZE                     PS_NEEDED_MOUSE_SIZE
     PS_FEP_SIZE                           PS_OLD_FEP_SIZE                       PS_DISPLAY_FLAGS
     PS_LOG_FLAGS                          PS_DEFAULT_DISPLAY_FLAGS              PS_DEFAULT_LOG_FLAGS
     PS_WORKING_FLAGS                      PS_FEP_DISP_FLAGS                     PS_FEP_LOG_FLAGS
     PS_HISTOGRAM_FLAGS                    PS_MOUSEING                           PS_ERR
     PS_STEPCC                             PS_INPUTTING                          PS_BUFFER
     PS_COMMAND                            PS_INTERVAL                           PS_DEFAULT_INTERVAL
     PS_PUNT_COUNT                         PS_TODAYS_DATE                        V_TABLE
     PS_FILE_PARAMS                        PS_FID_PARAMS                    r    PS_DEFAULT_FILE_PARAMS
     PS_STATS$                             PS_STATS_SIZE                         PS_STATS_EXPRESSIONS
     PS_GRAPHS                             PS_GRAPH_PEAK                         PS_SUMMARY_LIST
     PS_SUMMARY_ITEMS                      PS_MODE                               PS_START_UTS
     PS_END_UTS                            PS_FEPNO                              PS_FEPING
     PS_HLPCGBUF                           M$UC                                  B$TCB$
     B$JIT$                                B_VERSION                             PS_CMDS
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:85   


       35        1        /*T***********************************************************/
       36        2        /*T*                                                         */
       37        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       38        4        /*T*                                                         */
       39        5        /*T***********************************************************/
       40        6        PSA$INIT: PROC;

      6 13 000000   000000 700200 xent  PSA$INIT     TSX0  ! X66_AUTO_0
        13 000001   000362 000000                    ZERO    242,0

       41        7
       42        8        %INCLUDE PS_DATA_R;
       43     5304        %INCLUDE CP_6_SUBS;
       44     5844        %INCLUDE CP_6;
       45     5925        %INCLUDE F$DCB;
       46     5974        %INCLUDE F_ERRORS_C;
       47     6214        %INCLUDE B$JIT;
       48     6504        %INCLUDE PS_PERR_C;
       49     6535        %INCLUDE XU_PERR_C;
       50     6726        %INCLUDE XU_MACRO_C;
       51     9832        %INCLUDE XUR_ENTRY;
       52     9864        %INCLUDE XUH_MACRO_C;
       53     9948        %INCLUDE XUF_ENTRY;
       54     9956
       55     9957        %B$TCB (STCLASS="BASED(B$TCB$)");
       56     9960
       57     9961        %B$EXCFR;
       58     9979
       59     9980        %B$ALT;
       60     9988
       61     9989        %XUR_INIT (ABORT=PSA$BREAK,
       62     9990         WORK=XUR_WORK_AREA);
       63    10089
       64    10090    1   DCL XUR_WORK_AREA(0:1023) UBIN WORD STATIC DALIGNED;
       65    10091
       66    10092
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:86   
       67    10093        %XUH_PARAM (PROCNAME=STATSNAME,
       68    10094         OUTDCB1=M$DO,
       69    10095         OUTDCB2=M$LO);
       70    10156
       71    10157        %VLP_NAME (FPTN=STATSNAME,
       72    10158         NAME='STATS');
       73    10185
       74    10186        %FPT_READ (FPTN=READ_COMMAND,
       75    10187         DCB=M$SI,
       76    10188         BUF=PS_COMMAND,
       77    10189         WAIT=YES);
       78    10228
       79    10229        %FPT_WRITE (FPTN=ECHO_COMMAND,
       80    10230         DCB=M$LO,
       81    10231         WAIT=YES);
       82    10262
       83    10263        %FPT_CLOSE (FPTN=CLOSE_LO,
       84    10264         DCB=M$LO,
       85    10265         DISP=SAVE);
       86    10307
       87    10308        %FPT_CLOSE(FPTN=CLOSE_HLPCG,
       88    10309         STCLASS=STATIC,
       89    10310         DCB=M$HLPCG);
       90    10352
       91    10353        %FPT_DEVICE (FPTN=ZAP_HEADER,
       92    10354         DCB=M$LO,
       93    10355         HDR=ERASE);
       94    10373
       95    10374        %FPT_OPEN (FPTN=OPEN_LO,
       96    10375         HDR=ERASE,
       97    10376         DCB=M$LO);
       98    10485
       99    10486        %FPT_OPEN (FPTN=OPEN_SI,
      100    10487         DCB=M$SI,
      101    10488         FUN=IN);
      102    10597
      103    10598        %FPT_CLOSE (FPTN=CLOSE_LOGFILE,
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:87   
      104    10599         DCB=F$LOG,
      105    10600         DISP=SAVE,
      106    10601         RELG=YES,
      107    10602         STCLASS="STATIC");
      108    10644
      109    10645        %FPT_SINPUT;
      110    10682
      111    10683        %FPT_SMOUSE;
      112    10696
      113    10697        %FPT_OPEN (FPTN=OPEN_M$SI,
      114    10698         DCB=M$SI,
      115    10699         SCRUB=YES,
      116    10700         NAME=VLP_NAME,
      117    10701         ASN=FILE,
      118    10702         FUN=IN);
      119    10811
      120    10812        %FPT_CLOSE (FPTN=CLOSE_M$SI,
      121    10813         DCB=M$SI,
      122    10814         DISP=SAVE);
      123    10856
      124    10857        %VLP_NAME (NAME=':STATSSI');
      125    10884
      126    10885        %FPT_PRIV (FPTN=SET_PM_PRIV,
      127    10886         AUTH=YES,
      128    10887         PRIV=%PR_PM#);
      129    10902
      130    10903        %FPT_CORRES (FPTN=COMPARE_M$ME_AND_M$LO,
      131    10904         DCB1=M$ME,
      132    10905         DCB2=M$LO);
      133    10919
      134    10920        %FPT_INT (UENTRY=XUR$BREAK);
      135    10934
      136    10935        %FPT_FID (TEXTFID=NIL,
      137    10936         NAME=PS_FID_PARAMS.NAME@,
      138    10937         ACCT=PS_FID_PARAMS.ACCT@,
      139    10938         PASS=PS_FID_PARAMS.PASS@,
      140    10939         RES=PS_FID_PARAMS.RES@,
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:88   
      141    10940         SN=PS_FID_PARAMS.SN@,
      142    10941         ASN=PS_FID_PARAMS.ASN@,
      143    10942         RESULTS=VLR_FID,
      144    10943         SNAME=YES,
      145    10944         SACCT=YES,
      146    10945         SPASS=YES,
      147    10946         SRES=YES,
      148    10947         SSN=YES);
      149    10970        %VLR_FID;
      150    10989
      151    10990        %FPT_UNFID (TEXTFID=STATUS_FID,
      152    10991         NAME=PS_FILE_PARAMS.NAME@,
      153    10992         ACCT=PS_FILE_PARAMS.ACCT@,
      154    10993         RES=PS_FILE_PARAMS.RES@,
      155    10994         SN=PS_FILE_PARAMS.SN@,
      156    10995         ASN=PS_FILE_PARAMS.ASN@);
      157    11013
      158    11014        %FPT_TIME (FPTN=GET_TODAYS_DATE,
      159    11015         SOURCE=CLOCK,
      160    11016         DEST=LOCAL,
      161    11017         DATE=TODAYS_DATE);
      162    11036
      163    11037        %FPT_TIME (FPTN=GET_PS_TODAYS_DATE,
      164    11038         SOURCE=CLOCK,
      165    11039         DEST=EXT,
      166    11040         DATE=PS_TODAYS_DATE);
      167    11059
      168    11060        %FPT_TIME (FPTN=CONVERT_TO_UTS,
      169    11061         SOURCE=LOCAL,
      170    11062         DEST=UTS,
      171    11063         DATE=DATE_AREA.VECTOR_PORTION.REAL,
      172    11064         TIME=TIME_AREA);
      173    11083
      174    11084        %FPT_PROMPT (FPTN=SET_PROMPT,
      175    11085         DCB=M$UC,
      176    11086         VFC=NO);
      177    11114
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:89   
      178    11115        %FPT_TRAP (FPTN=SET_TRAP_CONTROL,
      179    11116         ARITHMETIC=PSA$TRAPPED,
      180    11117         DIVIDE_CHECK=TRAP,
      181    11118         OVERFLOW=TRAP,
      182    11119         ERRORS=PSA$TRAPPED,
      183    11120         COMMAND=TRAP,
      184    11121         IPR=TRAP,
      185    11122         LOCKUP=TRAP,
      186    11123         MEMORY=TRAP,
      187    11124         MISSING_PAGE=TRAP,
      188    11125         MISSING_SEG=TRAP,
      189    11126         SECURITY_1=TRAP,
      190    11127         SECURITY_2=TRAP,
      191    11128         PMME=PSA$TRAPPED,
      192    11129         PROGRAMMED=PSA$TRAPPED,
      193    11130         DERAIL=TRAP,
      194    11131         FAULT_TAG=TRAP,
      195    11132         MME=TRAP,
      196    11133         HISTORY_REGS=YES);
      197    11156
      198    11157        %FPT_KEYIN;
      199    11176
      200    11177        %FPT_EXIT ;
      201    11192
      202    11193    1   DCL B$TCB$ PTR SYMREF;
      203    11194    1   DCL B$JIT$ PTR SYMREF;
      204    11195
      205    11196        %PARSE$OUT (STCLASS="BASED(CMD$)");
      206    11241
      207    11242    1   DCL CMD$ PTR;
      208    11243    1   DCL 1 ERR REDEF CMD$,
      209    11244    1          2 FCG BIT (12),
      210    11245    1          2 MID BIT (6),
      211    11246    1          2 MON BIT (1),
      212    11247    1          2 CODE UBIN (14) UNAL,
      213    11248    1          2 SEV UBIN (3) UNAL;
      214    11249
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:90   
      215    11250        %PARSE$SYM (STCLASS=BASED);
      216    11288
      217    11289        %REF_RPN (NAME=BASED_RPN, STCLASS=BASED);
      218    11300
      219    11301        %DUMMY_BUCKET (NAME=BASED_BUCKET, STCLASS=BASED);
      220    11307
      221    11308    1   DCL I UBIN WORD;
      222    11309    1   DCL J SBIN;
      223    11310    1   DCL K SBIN;
      224    11311    1   DCL L SBIN;
      225    11312    1   DCL LYR SBIN;
      226    11313    1   DCL OPTN UBIN;
      227    11314    1   DCL CHANGE_MODE UBIN;
      228    11315    1   DCL FLAGS$ PTR;
      229    11316    1   DCL FEP_FLAGS$ PTR;
      230    11317    1   DCL IX UBIN;
      231    11318    1   DCL FEP_IX UBIN;
      232    11319        %PS_FEPMASK(NAME=DISP,STCLASS=AUTO);
      233    11385        %PS_FEPMASK(NAME=SLCT,STCLASS=AUTO);
      234    11451    1   DCL 1 HANDLER CHAR(8) CALIGNED AUTO ;
      235    11452
      236    11453    1   DCL 1 FEP_MASK(0:0) BASED ALIGNED,
      237    11454        %PS_FEPMASK(LVL=2, STCLASS=BASED);
      238    11520
      239    11521    1   DCL 1 FEP_LYR_MASKS CONSTANT ALIGNED,
      240    11522        %PS_FEPMASK(NAME=LNK, LVL=2, STCLASS=CONSTANT, LAST=",", ASYNC=YES, BSC=YES,
      241    11523         FEI=YES, HDLC=YES, URP=YES);
      242    11589        %PS_FEPMASK(NAME=NTW, LVL=2, STCLASS=CONSTANT, LAST=",", X25=YES);
      243    11655        %PS_FEPMASK(NAME=PRS, LVL=2, STCLASS=CONSTANT, LAST=",", VDH=YES, APE=YES);
      244    11721        %PS_FEPMASK(NAME=APL, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES,
      245    11722         PLDVIP=YES, RBT=YES, NODADM=YES, IO=YES, X29=YES);
      246    11788        %PS_FEPMASK(NAME="*", LVL=2, STCLASS=CONSTANT, LAST=",");
      247    11854        %PS_FEPMASK(NAME="*", LVL=2, STCLASS=CONSTANT, LAST=",");
      248    11920        %PS_FEPMASK(NAME="*", LVL=2, STCLASS=CONSTANT);
      249    11986
      250    11987    1   DCL 1 FEP_DISP_MODE_MASKS CONSTANT ALIGNED,
      251    11988    1          2 SUMMARY BIT(36) INIT('400000000000'O),
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:91   
      252    11989    1          2 EXTENDED BIT(36) INIT('200000000000'O) ;
      253    11990
      254    11991    1   DCL 1 FEP_SLCT_MODE_MASKS CONSTANT ALIGNED,
      255    11992    1          2 HANDLER BIT(36) INIT('400000000000'O) ;
      256    11993
      257    11994    1   DCL 1 FEP_DISP_MASKS CONSTANT ALIGNED,
      258    11995    1          2 * BIT(36) INIT ('0'O), /* Not Used; Must be first */
      259    11996        %PS_FEPMASK ( NAME=ALL, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES,
      260    11997         APE=YES,
      261    11998         ASYNC=YES,
      262    11999         FEI=YES,
      263    12000         HDLC=YES,
      264    12001         IO=YES,
      265    12002         MONITOR=YES,
      266    12003         PLDVIP=YES,
      267    12004         RBT=YES,
      268    12005         URP=YES,
      269    12006         VDH=YES,
      270    12007         X25=YES,
      271    12008         X29=YES ) ;
      272    12074        %PS_FEPMASK ( NAME=T3270, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES ) ;
      273    12140        %PS_FEPMASK ( NAME=ASSYNC, LVL=2, STCLASS=CONSTANT, LAST=",", ASYNC=YES ) ;
             12140            /* Must be last */
      274    12206        %PS_FEPMASK ( NAME=FEI, LVL=2, STCLASS=CONSTANT, LAST=",", FEI=YES ) ;
      275    12272        %PS_FEPMASK ( NAME=HDLC, LVL=2, STCLASS=CONSTANT, LAST=",", HDLC=YES ) ;
      276    12338        %PS_FEPMASK ( NAME=MON, LVL=2, STCLASS=CONSTANT, LAST=",", MONITOR=YES ) ;
      277    12404        %PS_FEPMASK ( NAME=POLLVIP, LVL=2, STCLASS=CONSTANT, LAST=",", PLDVIP=YES ) ;
      278    12470        %PS_FEPMASK ( NAME=RBT, LVL=2, STCLASS=CONSTANT, LAST=",", RBT=YES ) ;
      279    12536        %PS_FEPMASK ( NAME=URP, LVL=2, STCLASS=CONSTANT, LAST=",", URP=YES ) ;
      280    12602        %PS_FEPMASK ( NAME=VDH, LVL=2, STCLASS=CONSTANT, LAST=",", VDH=YES ) ;
      281    12668        %PS_FEPMASK ( NAME=X25, LVL=2, STCLASS=CONSTANT, LAST=",", X25=YES ) ;
      282    12734        %PS_FEPMASK ( NAME=X29, LVL=2, STCLASS=CONSTANT, LAST=",", X29=YES ) ;
      283    12800        %PS_FEPMASK ( NAME=NONE, LVL=2, STCLASS=CONSTANT, LAST=";" ) ;
      284    12866    1   DCL 1 FEP_DISP_MASKS$ PTR ALIGNED CONSTANT INIT ( ADDR(FEP_DISP_MASKS) ) ;
      285    12867
      286    12868    1   DCL 1 FEP_DISP_TOKENS(0:13) CHAR(16) CONSTANT ALIGNED INIT (
      287    12869    1   '    .', /* Not Used; Must be First */
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:92   
      288    12870    1    'all .',
      289    12871    1    '3270 .',
      290    12872    1    'Async .',
      291    12873    1    'FEI .',
      292    12874    1    'HDLC .',
      293    12875    1    'Monitor .',
      294    12876    1    'Polled VIP .',
      295    12877    1    'RBT .',
      296    12878    1    'URP .',
      297    12879    1    'VDH .',
      298    12880    1    'X25 .',
      299    12881    1    'X29 .',
      300    12882    1    'none .' /* Must be last */ ) ;
      301    12883
      302    12884    1   DCL 1 FEP_SLCT_MASKS CONSTANT ALIGNED,
      303    12885    1          2 HANDLER BIT(36) INIT ( '437777777777'O ), /* Must be first */
      304    12886        %PS_FEPMASK ( NAME=ALL, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES,
      305    12887         ASYNC=YES,
      306    12888         BSC=YES,
      307    12889         FEI=YES,
      308    12890         HDLC=YES,
      309    12891         MONITOR=YES,
      310    12892         NODADM=YES,
      311    12893         PLDVIP=YES,
      312    12894         RBT=YES,
      313    12895         URP=YES ) ;
      314    12961        %PS_FEPMASK ( NAME=T3270, LVL=2, STCLASS=CONSTANT, LAST=",", T3270=YES ) ;
      315    13027        %PS_FEPMASK ( NAME=ASSYNC, LVL=2, STCLASS=CONSTANT, LAST=",", ASYNC=YES ) ;
      316    13093        %PS_FEPMASK ( NAME=BISYNC, LVL=2, STCLASS=CONSTANT, LAST=",", BSC=YES ) ;
      317    13159        %PS_FEPMASK ( NAME=COUPLER, LVL=2, STCLASS=CONSTANT, LAST=",", FEI=YES ) ;
      318    13225        %PS_FEPMASK ( NAME=HDLCX25, LVL=2, STCLASS=CONSTANT, LAST=",", HDLC=YES ) ;
      319    13291        %PS_FEPMASK ( NAME=MONITOR, LVL=2, STCLASS=CONSTANT, LAST=",", MONITOR=YES ) ;
      320    13357        %PS_FEPMASK ( NAME=NODEADMN, LVL=2, STCLASS=CONSTANT, LAST=",", NODADM=YES ) ;
      321    13423        %PS_FEPMASK ( NAME=PLDVIP, LVL=2, STCLASS=CONSTANT, LAST=",", PLDVIP=YES ) ;
      322    13489        %PS_FEPMASK ( NAME=RBT, LVL=2, STCLASS=CONSTANT, LAST=",", RBT=YES ) ;
      323    13555        %PS_FEPMASK ( NAME=UNITREC, LVL=2, STCLASS=CONSTANT, LAST=",", URP=YES ) ;
      324    13621        %PS_FEPMASK ( NAME=NONE, LVL=2, STCLASS=CONSTANT, LAST=";" ) ; /* Must be last */
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:93   
      325    13687
      326    13688    1   DCL 1 FEP_SLCT_MASKS$ PTR ALIGNED CONSTANT INIT ( ADDR(FEP_SLCT_MASKS) ) ;
      327    13689
      328    13690    1   DCL 1 FEP_SLCT_TOKENS(0:12) CHAR(16) CONSTANT ALIGNED INIT (
      329    13691    1   'Handler .', /* Not Used; Must be first */
      330    13692    1    'all .',
      331    13693    1    '3270 .',
      332    13694    1    'ASYNC .',
      333    13695    1    'BISYNC .',
      334    13696    1    'COUPLER .',
      335    13697    1    'HDLCX25 .',
      336    13698    1    'MONITOR .',
      337    13699    1    'NODEADMN .',
      338    13700    1    'PLDVIP .',
      339    13701    1    'RBT .',
      340    13702    1    'UNITREC .',
      341    13703    1    'none .' /*  Must be last */ ) ;
      342    13704
      343    13705
      344    13706    1   DCL 1 FEP_TOKEN(0:22) CHAR(16) CONSTANT ALIGNED INIT(
      345    13707    1    'Summary .',
      346    13708    1    'Extended .',
      347    13709    1   'all .', /* just as good as all */
      348    13710    1    'Monitor .',
      349    13711    1    'Link .',
      350    13712    1    'Async .',
      351    13713    1    'BSC .',
      352    13714    1    'FEI .',
      353    13715    1    'HDLC .',
      354    13716    1    'URP .',
      355    13717    1    'Network .',
      356    13718    1    'X25 .',
      357    13719    1    'Presentation .',
      358    13720    1    'VDH .',
      359    13721    1    'APE .',
      360    13722    1    'Application .',
      361    13723    1    '3270 .',
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:94   
      362    13724    1    'PolledVIP .',
      363    13725    1    'RBT .',
      364    13726    1    'NodeAdmin .',
      365    13727    1    'IO .',
      366    13728    1    'X29 .',
      367    13729    1    'none .');
      368    13730
      369    13731    1   DCL 1 B_VERSION CALIGNED SYMREF,
      370    13732    1          2 L UBIN BYTE CALIGNED,
      371    13733    1          2 C CHAR(6) CALIGNED;
      372    13734    1   DCL 1 B_VERSION_ CALIGNED BASED,
      373    13735    1          2 L UBIN BYTE CALIGNED,
      374    13736    1          2 C CHAR(B_VERSION.L) CALIGNED;
      375    13737
      376    13738    1   DCL P$ PTR;
      377    13739    1   DCL STRANGLING LOGICAL STATIC INIT (%NO#);
      378    13740    1   DCL PS_CMDS BIT(36) ALIGNED SYMREF;
      379    13741
      380    13742    1   DCL 1 STATUS_FORMAT CONSTANT,
      381    13743    1          2 P3 CHAR (0) INIT ('Interval%10-%D'),
      382    13744    1          2 P4 CHAR (0) INIT ('%/File%10-%A'),
      383    13745    1          2 P5 CHAR (0) INIT ('%/Time%10-%A'),
      384    13746    1          2 P6 CHAR (0) INIT ('%/Select%10-%A%/');
      385    13747
      386    13748    1   DCL STATUS_DI_FMT CHAR(0) CONSTANT INIT('%/Display%10-%A');
      387    13749    1   DCL STATUS_LOG_FMT CHAR(0) CONSTANT INIT('Log%10-%A');
      388    13750    1   DCL STATUS_FEPS_FMT CHAR(0) CONSTANT INIT('%10-Fep %A');
      389    13751    1   DCL STATUS_FEPN_FMT CHAR(0) CONSTANT INIT('%10-Fep %D %A');
      390    13752
      391    13753    1   DCL FEP_BLURT_FMT CHAR(0) CONSTANT INIT('..fep %D "%A" %A');
      392    13754
      393    13755    1   DCL STATUS_MISC CHAR (120);
      394    13756
      395    13757    1   DCL STATUS_FID CHAR (120) STATIC;
      396    13758    1   DCL STATUS_FEP_LOG CHAR (120);
      397    13759    1   DCL STATUS_TIME CHAR (40);
      398    13760    1   DCL STATUS_SELECT CHAR (120);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:95   
      399    13761
      400    13762    1   DCL 1 COMPLAINT,
      401    13763    1          2 SKIP_ONE CHAR(1),
      402    13764    1          2 STRING CHAR(255),
      403    13765    1          2 BYTES (0:254) REDEF STRING CHAR(1);
      404    13766    1   DCL COMPLAINT_BUFFER REDEF COMPLAINT CHAR (256);
      405    13767
      406    13768    1   DCL 1 TIME_AREA STATIC,
      407    13769    1          2 PORTION (0:1),
      408    13770    1             3 DIGITS CHAR(2),
      409    13771    1             3 SEP CHAR(1),
      410    13772    1          2 ENDIT CHAR(5);
      411    13773    1   DCL TIME_AREA_C REDEF TIME_AREA CHAR(11);
      412    13774
      413    13775    1   DCL 1 DATE_AREA STATIC,
      414    13776    1          2 PORTION (0:2),
      415    13777    1             3 DIGITS CHAR(2),
      416    13778    1             3 SEP CHAR(1),
      417    13779    1          2 VECTOR_PORTION REDEF PORTION,
      418    13780    1             3 REAL CHAR(8),
      419    13781    1             3 * CHAR(1);
      420    13782
      421    13783    1   DCL STATS_PROMPT CHAR (0) CONSTANT INIT ('#');
      422    13784    1   DCL CONTINUE_PROMPT CHAR (0) CONSTANT INIT ('>#');
      423    13785    1   DCL PROMPT_VECTOR BIT (72) DALIGNED STATIC INIT (VECTOR(NIL));
      424    13786    1   DCL TEMP_START_UTS UBIN WORD;
      425    13787    1   DCL TEMP_END_UTS UBIN WORD;
      426    13788    1   DCL DEFAULT_START_TIME CHAR(11) CONSTANT INIT ('00:00:00.00');
      427    13789    1   DCL DEFAULT_END_TIME CHAR(11) CONSTANT INIT ('23:59:59.99');
      428    13790    1   DCL TODAYS_DATE CHAR(8) STATIC;
      429    13791    1   DCL X$PARSE ENTRY (1) ALTRET;
      430    13792    1   DCL PSR$RPN ENTRY (2);
      431    13793    1   DCL PSR$UN_RPN ENTRY (4);
      432    13794    1   DCL PSM$ALLOC ENTRY (2);
      433    13795    1   DCL PSM$FREESEG ENTRY(1);
      434    13796    1   DCL PSE$ERRMSG ENTRY(5);
      435    13797    1   DCL PSE$ELUCIDATE ENTRY;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:96   
      436    13798    1   DCL PSE$CLARIFY ENTRY;
      437    13799    1   DCL PSE$GRIPE ENTRY (5);
      438    13800    1   DCL PSD$DISP ENTRY;
      439    13801    1   DCL PSA$BREAK ENTRY ASYNC;
      440    13802    1   DCL PSA$TRAPPED ENTRY ASYNC;
      441    13803    1   DCL PSA$CONTINUE ENTRY (1);
      442    13804        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:97   
      443    13805    1      STRANGLING = %NO#;

  13805 13 000002   005116 450000 11                 STZ     STRANGLING

      444    13806
      445    13807    1      PS_PMDAT_SIZE = 0;

  13807 13 000003   000000 450000 xsym               STZ     PS_PMDAT_SIZE

      446    13808    1      PS_MOUSE_SIZE = 0;

  13808 13 000004   000000 450000 xsym               STZ     PS_MOUSE_SIZE

      447    13809    1      PS_STATS_SIZE = 0;

  13809 13 000005   000000 450000 xsym               STZ     PS_STATS_SIZE

      448    13810    1      PS_OLD_PMDAT_SIZE = 0;

  13810 13 000006   000000 450000 xsym               STZ     PS_OLD_PMDAT_SIZE

      449    13811    1      PS_OLD_MOUSE_SIZE = 0;

  13811 13 000007   000000 450000 xsym               STZ     PS_OLD_MOUSE_SIZE

      450    13812    1      PS_NEEDED_PMDAT_SIZE = 2048;

  13812 13 000010   004000 235007                    LDA     2048,DL
        13 000011   000000 755000 xsym               STA     PS_NEEDED_PMDAT_SIZE

      451    13813    1      PS_NEEDED_LOGFILE_SIZE = 2048;

  13813 13 000012   000000 755000 xsym               STA     PS_NEEDED_LOGFILE_SIZE

      452    13814    1      PS_NEEDED_MOUSE_SIZE = 1024;

  13814 13 000013   002000 236007                    LDQ     1024,DL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:98   
        13 000014   000000 756000 xsym               STQ     PS_NEEDED_MOUSE_SIZE

      453    13815    1      PS_DISPLAY_FLAGS = PS_DEFAULT_DISPLAY_FLAGS;

  13815 13 000015   000000 236000 xsym               LDQ     PS_DEFAULT_DISPLAY_FLAGS
        13 000016   777600 376003                    ANQ     -128,DU
        13 000017   000000 756000 xsym               STQ     PS_DISPLAY_FLAGS

      454    13816    1      PS_LOG_FLAGS = PS_DEFAULT_LOG_FLAGS;

  13816 13 000020   000000 236000 xsym               LDQ     PS_DEFAULT_LOG_FLAGS
        13 000021   777600 376003                    ANQ     -128,DU
        13 000022   000000 756000 xsym               STQ     PS_LOG_FLAGS

      455    13817    1      PS_INTERVAL = PS_DEFAULT_INTERVAL;

  13817 13 000023   000000 235000 xsym               LDA     PS_DEFAULT_INTERVAL
        13 000024   000000 755000 xsym               STA     PS_INTERVAL

      456    13818    1      PS_INPUTTING = %NO#;

  13818 13 000025   000000 450000 xsym               STZ     PS_INPUTTING

      457    13819    1      PS_MOUSEING = %NO#;

  13819 13 000026   000000 450000 xsym               STZ     PS_MOUSEING

      458    13820    1      PS_FILE_PARAMS = PS_DEFAULT_FILE_PARAMS;

  13820 13 000027   000000 100400                    MLR     fill='000'O
        13 000030   000000 000105 xsym               ADSC9   PS_DEFAULT_FILE_PARAMS   cn=0,n=69
        13 000031   000000 000105 xsym               ADSC9   PS_FILE_PARAMS           cn=0,n=69

      459    13821
      460    13822    1      CALL M$TIME ( GET_PS_TODAYS_DATE ) ;

  13822 13 000032   005016 630400 11                 EPPR0   GET_PS_TODAYS_DATE
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:99   
        13 000033   020004 713400                    CLIMB   8196
        13 000034   402000 401760                    pmme    nvectors=5

      461    13823
      462    13824    1      CALL M$SPRIV (SET_PM_PRIV);

  13824 13 000035   004676 630400 11                 EPPR0   SET_PM_PRIV
        13 000036   020012 713400                    CLIMB   8202
        13 000037   400000 401760                    pmme    nvectors=1

      463    13825
      464    13826    1      CALL XUR$INIT(XUR_INIT);

  13826 13 000040   000000 630400 14                 EPPR0   0
        13 000041   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 000042   000000 701000 xent               TSX1    XUR$INIT
        13 000043   000000 011000                    NOP     0

      465    13827
      466    13828    1      CALL PSE$GRIPE(E$PS_HI_THERE, ,VECTOR(ADDR(B_VERSION)->B_VERSION_.C));

  13828 13 000044   000000 236000 xsym               LDQ     B_VERSION
        13 000045   000033 772000                    QRL     27
        13 000046   000064 737000                    LLS     52
        13 000047   000140 135007                    SBLA    96,DL
        13 000050   000001 236000 14                 LDQ     1
        13 000051   200334 757100                    STAQ    KEEP_SCANNING+2,,AUTO
        13 000052   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000053   200340 450500                    STP0    KEEP_SCANNING+6,,AUTO
        13 000054   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 000055   000002 235000 14                 LDA     2
        13 000056   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 000057   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 000060   000021 631400 xsym               EPPR1   B_VECTNIL+17
        13 000061   000000 701000 xent               TSX1    PSE$GRIPE
        13 000062   000000 011000                    NOP     0

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:100  
      467    13829
      468    13830    1      CALL M$INT (FPT_INT) ALTRET (BAILOUT);

  13830 13 000063   004706 630400 11                 EPPR0   FPT_INT
        13 000064   410002 713400                    CLIMB   alt,+4098
        13 000065   400000 401760                    pmme    nvectors=1
        13 000066   000256 702000 13                 TSX2    BAILOUT

      469    13831
      470    13832    1      CALL M$TRAP (SET_TRAP_CONTROL);

  13832 13 000067   005060 630400 11                 EPPR0   SET_TRAP_CONTROL
        13 000070   010004 713400                    CLIMB   4100
        13 000071   400400 401760                    pmme    nvectors=2

      471    13833
      472    13834    1      CALL M$OPEN (OPEN_SI) ALTRET (UNABLE_TO_OPEN_M$SI);

  13834 13 000072   004376 630400 11                 EPPR0   OPEN_SI
        13 000073   450000 713400                    CLIMB   alt,open
        13 000074   410400 401760                    pmme    nvectors=18
        13 000075   000077 702000 13                 TSX2    UNABLE_TO_OPEN_M$SI

      473    13835
      474    13836    1      RETURN;

  13836 13 000076   000000 702200 xent               TSX2  ! X66_ARET

      475    13837
      476    13838    1   UNABLE_TO_OPEN_M$SI:
      477    13839
      478    13840    1      CALL PSE$ERRMSG( , FATAL#);

  13840 13 000077   000003 236000 14    UNABLE_TO_O* LDQ     3
        13 000100   000001 235000 xsym               LDA     B_VECTNIL+1
        13 000101   200334 757100                    STAQ    KEEP_SCANNING+2,,AUTO
        13 000102   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:101  
        13 000103   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000104   000000 701000 xent               TSX1    PSE$ERRMSG
        13 000105   000000 011000                    NOP     0
        13 000106   000111 710000 13                 TRA     s:13843+2

      479    13841
      480    13842        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:102  
      481    13843    1   PSA$RESTART: ENTRY;

  13843 13 000107   000000 700200 xent  PSA$RESTART  TSX0  ! X66_AUTO_0
        13 000110   000362 000000                    ZERO    242,0
        13 000111   000131 710000 13                 TRA     s:13865

      482    13844
      483    13845    1   FREESEG: PROC (SEGMENT$, SEGSIZE);

  13845 13 000112   200274 741300       FREESEG      STX1  ! TEMP_END_UTS+2,,AUTO

      484    13846
      485    13847    2   DCL SEGMENT$ PTR;
      486    13848    2   DCL SEGSIZE UBIN WORD;
      487    13849
      488    13850    2      IF SEGSIZE > 0

  13850 13 000113   200276 470500                    LDP0    @SEGSIZE,,AUTO
        13 000114   000000 235100                    LDA     0,,PR0
        13 000115   000124 600000 13                 TZE     s:13859

      489    13851    3      THEN DO;

      490    13852
      491    13853    3         CALL PSM$FREESEG (SEGMENT$);

  13853 13 000116   200275 630500                    EPPR0   @SEGMENT$,,AUTO
        13 000117   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 000120   000000 701000 xent               TSX1    PSM$FREESEG
        13 000121   000000 011000                    NOP     0

      492    13854
      493    13855    3         SEGSIZE = 0;

  13855 13 000122   200276 470500                    LDP0    @SEGSIZE,,AUTO
        13 000123   000000 450100                    STZ     0,,PR0

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:103  
      494    13856
      495    13857    3      END;

      496    13858
      497    13859    2      SEGMENT$ = ADDR(NIL);

  13859 13 000124   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 000125   200275 471500                    LDP1    @SEGMENT$,,AUTO
        13 000126   100000 756100                    STQ     0,,PR1

      498    13860
      499    13861    2      RETURN;

  13861 13 000127   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 000130   000001 702211                    TSX2  ! 1,X1

      500    13862
      501    13863    2   END FREESEG;
      502    13864
      503    13865    1      IF DCBADDR(DCBNUM(M$HLPCG))->F$DCB.FCD

  13865 13 000131   000000 236007 xsym               LDQ     M$HLPCG,DL
        13 000132   000004 470400 14                 LDP0    4
        13 000133   000000 471500                    LDP1    0,,PR0
        13 000134   100000 473506                    LDP3    0,QL,PR1
        13 000135   300031 236100                    LDQ     25,,PR3
        13 000136   020000 316007                    CANQ    8192,DL
        13 000137   000144 600000 13                 TZE     s:13868

      504    13866    1      THEN CALL M$CLOSE(CLOSE_HLPCG) ALTRET (BAILOUT);

  13866 13 000140   004234 630400 11                 EPPR0   CLOSE_HLPCG
        13 000141   450001 713400                    CLIMB   alt,close
        13 000142   406000 401760                    pmme    nvectors=13
        13 000143   000256 702000 13                 TSX2    BAILOUT

      505    13867
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:104  
      506    13868    1      CALL FREESEG (PS_FEP$, PS_FEP_SIZE);

  13868 13 000144   000005 236000 14                 LDQ     5
        13 000145   200276 756100                    STQ     @UTS+1,,AUTO
        13 000146   000006 236000 14                 LDQ     6
        13 000147   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000150   000112 701000 13                 TSX1    FREESEG
        13 000151   000000 011000                    NOP     0

      507    13869    1      CALL FREESEG (PS_OLD_FEP$, PS_OLD_FEP_SIZE);

  13869 13 000152   000007 236000 14                 LDQ     7
        13 000153   200276 756100                    STQ     @UTS+1,,AUTO
        13 000154   000010 236000 14                 LDQ     8
        13 000155   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000156   000112 701000 13                 TSX1    FREESEG
        13 000157   000000 011000                    NOP     0

      508    13870    1      CALL FREESEG (PS_PMDAT$, PS_PMDAT_SIZE);

  13870 13 000160   000011 236000 14                 LDQ     9
        13 000161   200276 756100                    STQ     @UTS+1,,AUTO
        13 000162   000012 236000 14                 LDQ     10
        13 000163   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000164   000112 701000 13                 TSX1    FREESEG
        13 000165   000000 011000                    NOP     0

      509    13871    1      CALL FREESEG (PS_OLD_PMDAT$, PS_OLD_PMDAT_SIZE);

  13871 13 000166   000013 236000 14                 LDQ     11
        13 000167   200276 756100                    STQ     @UTS+1,,AUTO
        13 000170   000014 236000 14                 LDQ     12
        13 000171   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000172   000112 701000 13                 TSX1    FREESEG
        13 000173   000000 011000                    NOP     0

      510    13872    1      CALL FREESEG (PS_MOUSE$, PS_MOUSE_SIZE);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:105  

  13872 13 000174   000015 236000 14                 LDQ     13
        13 000175   200276 756100                    STQ     @UTS+1,,AUTO
        13 000176   000016 236000 14                 LDQ     14
        13 000177   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000200   000112 701000 13                 TSX1    FREESEG
        13 000201   000000 011000                    NOP     0

      511    13873    1      CALL FREESEG (PS_OLD_MOUSE$, PS_OLD_MOUSE_SIZE);

  13873 13 000202   000017 236000 14                 LDQ     15
        13 000203   200276 756100                    STQ     @UTS+1,,AUTO
        13 000204   000020 236000 14                 LDQ     16
        13 000205   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000206   000112 701000 13                 TSX1    FREESEG
        13 000207   000000 011000                    NOP     0

      512    13874    1      CALL FREESEG (PS_STATS$, PS_STATS_SIZE);

  13874 13 000210   000021 236000 14                 LDQ     17
        13 000211   200276 756100                    STQ     @UTS+1,,AUTO
        13 000212   000022 236000 14                 LDQ     18
        13 000213   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000214   000112 701000 13                 TSX1    FREESEG
        13 000215   000000 011000                    NOP     0

      513    13875    1      CALL FREESEG (PS_LOGFILE$, PS_LOGFILE_SIZE);

  13875 13 000216   000023 236000 14                 LDQ     19
        13 000217   200276 756100                    STQ     @UTS+1,,AUTO
        13 000220   000024 236000 14                 LDQ     20
        13 000221   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 000222   000112 701000 13                 TSX1    FREESEG
        13 000223   000000 011000                    NOP     0

      514    13876
      515    13877    1      IF DCBADDR(DCBNUM(F$LOG)) -> F$DCB.FCD
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:106  

  13877 13 000224   000000 236007 xsym               LDQ     F$LOG,DL
        13 000225   000004 470400 14                 LDP0    4
        13 000226   000000 471500                    LDP1    0,,PR0
        13 000227   100000 473506                    LDP3    0,QL,PR1
        13 000230   300031 236100                    LDQ     25,,PR3
        13 000231   020000 316007                    CANQ    8192,DL
        13 000232   000237 600000 13                 TZE     s:13881

      516    13878    1      THEN
      517    13879    1      CALL M$CLOSE (CLOSE_LOGFILE) ALTRET (BAILOUT);

  13879 13 000233   004470 630400 11                 EPPR0   CLOSE_LOGFILE
        13 000234   450001 713400                    CLIMB   alt,close
        13 000235   406000 401760                    pmme    nvectors=13
        13 000236   000256 702000 13                 TSX2    BAILOUT

      518    13880
      519    13881    1      IF DCBADDR(DCBNUM(M$LO)) -> F$DCB.FCD

  13881 13 000237   000000 236007 xsym               LDQ     M$LO,DL
        13 000240   000004 470400 14                 LDP0    4
        13 000241   000000 471500                    LDP1    0,,PR0
        13 000242   100000 473506                    LDP3    0,QL,PR1
        13 000243   300031 236100                    LDQ     25,,PR3
        13 000244   020000 316007                    CANQ    8192,DL
        13 000245   000251 600000 13                 TZE     s:13887

      520    13882    1      THEN
      521    13883    1      CALL M$DEVICE (ZAP_HEADER);

  13883 13 000246   004272 630400 11                 EPPR0   ZAP_HEADER
        13 000247   050006 713400                    CLIMB   20486
        13 000250   401000 401760                    pmme    nvectors=3

      522    13884
      523    13885    2      DO FOREVER;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:107  

      524    13886
      525    13887    2         CALL M$CLRSTK ALTRET (ALL_CLEAR);

  13887 13 000251   410013 713400                    CLIMB   alt,+4107
        13 000252   000000 401760                    pmme    nvectors=0
        13 000253   000255 702000 13                 TSX2    ALL_CLEAR

      526    13888    2      END;

  13888 13 000254   000251 710000 13                 TRA     s:13887

  13887 13 000255                       ALL_CLEAR    null
      527    13889
      528    13890    1   ALL_CLEAR: ;
      529    13891
      530    13892    1      RETURN;

  13892 13 000255   000000 702200 xent               TSX2  ! X66_ARET

  13887 13 000256                       BAILOUT      null
      531    13893
      532    13894    1   BAILOUT: ;
      533    13895
      534    13896    1      IF STRANGLING

  13896 13 000256   005116 234000 11                 SZN     STRANGLING
        13 000257   000302 605000 13                 TPL     s:13905

      535    13897    1      THEN
      536    13898    1      IF B$TCB.ALT$ ~= ADDR(NIL)

  13898 13 000260   000000 470400 xsym               LDP0    B$TCB$
        13 000261   000000 236100                    LDQ     0,,PR0
        13 000262   000001 116000 xsym               CMPQ    B_VECTNIL+1
        13 000263   000300 600000 13                 TZE     s:13903
        13 000264   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:108  
        13 000265   100102 236100                    LDQ     66,,PR1
        13 000266   000000 116000 xsym               CMPQ    PS_ERR
        13 000267   000300 600000 13                 TZE     s:13903

      537    13899    1        AND B$TCB.ALT$ -> B$EXCFR.ERR ~= PS_ERR
      538    13900    1      THEN
      539    13901    1      CALL PSE$ERRMSG (, FATAL#);

  13901 13 000270   000003 236000 14                 LDQ     3
        13 000271   000001 235000 xsym               LDA     B_VECTNIL+1
        13 000272   200334 757100                    STAQ    KEEP_SCANNING+2,,AUTO
        13 000273   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000274   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000275   000000 701000 xent               TSX1    PSE$ERRMSG
        13 000276   000000 011000                    NOP     0
        13 000277   000302 710000 13                 TRA     s:13905

      540    13902    1      ELSE
      541    13903    1      CALL M$ERR;

  13903 13 000300   000002 713400                    CLIMB   err
        13 000301   000000 401760                    pmme    nvectors=0

      542    13904
      543    13905    1      STRANGLING = %YES#;

  13905 13 000302   400000 236003                    LDQ     -131072,DU
        13 000303   005116 756000 11                 STQ     STRANGLING

      544    13906
      545    13907    1      CALL PSE$ERRMSG (, SERIOUS#);

  13907 13 000304   000002 236000 14                 LDQ     2
        13 000305   000001 235000 xsym               LDA     B_VECTNIL+1
        13 000306   200334 757100                    STAQ    KEEP_SCANNING+2,,AUTO
        13 000307   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000310   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:109  
        13 000311   000000 701000 xent               TSX1    PSE$ERRMSG
        13 000312   000000 011000                    NOP     0
        13 000313   000316 710000 13                 TRA     s:13912

      546    13908
      547    13909        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:110  
      548    13910    1   PSA$INPUT: ENTRY;

  13910 13 000314   000000 700200 xent  PSA$INPUT    TSX0  ! X66_AUTO_0
        13 000315   000362 000000                    ZERO    242,0

      549    13911
      550    13912    1      CALL XUR$GETCMD (PS_CMDS, CMD$, VECTOR(STATS_PROMPT))

  13912 13 000316   000030 236000 14                 LDQ     24
        13 000317   200336 756100                    STQ     KEEP_SCANNING+4,,AUTO
        13 000320   200004 630500                    EPPR0   CMD$,,AUTO
        13 000321   200335 450500                    STP0    KEEP_SCANNING+3,,AUTO
        13 000322   000031 236000 14                 LDQ     25
        13 000323   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 000324   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000325   000021 631400 xsym               EPPR1   B_VECTNIL+17
        13 000326   000000 701000 xent               TSX1    XUR$GETCMD
        13 000327   000341 702000 13                 TSX2    INVALID_COMMAND

      551    13913    1        ALTRET (INVALID_COMMAND);
      552    13914
      553    13915
      554    13916    1      CALL XUR$ECHOIF (DCBNUM(M$LO));

  13916 13 000330   000000 236007 xsym               LDQ     M$LO,DL
        13 000331   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 000332   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000333   200335 450500                    STP0    KEEP_SCANNING+3,,AUTO
        13 000334   200335 630500                    EPPR0   KEEP_SCANNING+3,,AUTO
        13 000335   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 000336   000000 701000 xent               TSX1    XUR$ECHOIF
        13 000337   000000 011000                    NOP     0

      555    13917
      556    13918    1      RETURN;

  13918 13 000340   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:111  

      557    13919
      558    13920    1   INVALID_COMMAND:
      559    13921
      560    13922    1      IF ERR.MON /* monitor error occurred during input/parse */

  13922 13 000341   200004 236100       INVALID_COM* LDQ     CMD$,,AUTO
        13 000342   400000 316007                    CANQ    -131072,DL
        13 000343   000350 601000 13                 TNZ     s:13925
        13 000344   200004 236100                    LDQ     CMD$,,AUTO
        13 000345   377770 376007                    ANQ     131064,DL
        13 000346   000010 116007                    CMPQ    8,DL
        13 000347   000360 600000 13                 TZE     s:13927

      561    13923    1        OR ERR.CODE ~= %E$SYNERR /* parser error other than "syntax error" */
      562    13924    1      THEN
      563    13925    1      CALL PSE$ERRMSG (ERR, FATAL#);

  13925 13 000350   000003 236000 14                 LDQ     3
        13 000351   200335 756100                    STQ     KEEP_SCANNING+3,,AUTO
        13 000352   200004 630500                    EPPR0   CMD$,,AUTO
        13 000353   200334 450500                    STP0    KEEP_SCANNING+2,,AUTO
        13 000354   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000355   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000356   000000 701000 xent               TSX1    PSE$ERRMSG
        13 000357   000000 011000                    NOP     0

      564    13926
      565    13927    1      CALL XUR$ECHOIF (DCBNUM(M$ME));

  13927 13 000360   000000 236007 xsym               LDQ     M$ME,DL
        13 000361   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 000362   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000363   200335 450500                    STP0    KEEP_SCANNING+3,,AUTO
        13 000364   200335 630500                    EPPR0   KEEP_SCANNING+3,,AUTO
        13 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 000366   000000 701000 xent               TSX1    XUR$ECHOIF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:112  
        13 000367   000000 011000                    NOP     0

      566    13928
      567    13929    1      CALL XUR$ERRPTR ( , DCBNUM(M$ME));

  13929 13 000370   000000 236007 xsym               LDQ     M$ME,DL
        13 000371   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 000372   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000373   200337 450500                    STP0    KEEP_SCANNING+5,,AUTO
        13 000374   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 000375   200336 756100                    STQ     KEEP_SCANNING+4,,AUTO
        13 000376   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 000377   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000400   000000 701000 xent               TSX1    XUR$ERRPTR
        13 000401   000000 011000                    NOP     0

      568    13930
      569    13931    1      CALL M$CORRES (COMPARE_M$ME_AND_M$LO) ALTRET (DONT_OUTPUT_TO_M$LO);

  13931 13 000402   004702 630400 11                 EPPR0   COMPARE_M$ME_AND_M$LO
        13 000403   460000 713400                    CLIMB   alt,+24576
        13 000404   400000 401760                    pmme    nvectors=1
        13 000405   000430 702000 13                 TSX2    DONT_OUTPUT_TO_M$LO

      570    13932
      571    13933    1      CALL XUR$ECHOIF (DCBNUM(M$LO));

  13933 13 000406   000000 236007 xsym               LDQ     M$LO,DL
        13 000407   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 000410   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000411   200335 450500                    STP0    KEEP_SCANNING+3,,AUTO
        13 000412   200335 630500                    EPPR0   KEEP_SCANNING+3,,AUTO
        13 000413   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 000414   000000 701000 xent               TSX1    XUR$ECHOIF
        13 000415   000000 011000                    NOP     0

      572    13934
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:113  
      573    13935    1      CALL XUR$ERRPTR ( , DCBNUM(M$LO));

  13935 13 000416   000000 236007 xsym               LDQ     M$LO,DL
        13 000417   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 000420   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000421   200337 450500                    STP0    KEEP_SCANNING+5,,AUTO
        13 000422   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 000423   200336 756100                    STQ     KEEP_SCANNING+4,,AUTO
        13 000424   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 000425   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000426   000000 701000 xent               TSX1    XUR$ERRPTR
        13 000427   000000 011000                    NOP     0

      574    13936
      575    13937    1   DONT_OUTPUT_TO_M$LO:
      576    13938
      577    13939    1      CALL PSE$ERRMSG (ERR, WARNING#);

  13939 13 000430   000032 236000 14    DONT_OUTPUT* LDQ     26
        13 000431   200335 756100                    STQ     KEEP_SCANNING+3,,AUTO
        13 000432   200004 630500                    EPPR0   CMD$,,AUTO
        13 000433   200334 450500                    STP0    KEEP_SCANNING+2,,AUTO
        13 000434   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 000435   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000436   000000 701000 xent               TSX1    PSE$ERRMSG
        13 000437   000000 011000                    NOP     0

      578    13940
      579    13941    1      GOTO BAILOUT;

  13941 13 000440   000256 710000 13                 TRA     BAILOUT

      580    13942
      581    13943        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:114  
      582    13944    1   PSA$DOIT: ENTRY;

  13944 13 000441   000000 700200 xent  PSA$DOIT     TSX0  ! X66_AUTO_0
        13 000442   000362 000000                    ZERO    242,0

      583    13945
      584    13946    2      DO CASE (OUT$BLK.CODE);

  13946 13 000443   200004 470500                    LDP0    CMD$,,AUTO
        13 000444   000000 720100                    LXL0    0,,PR0
        13 000445   000033 100003                    CMPX0   27,DU
        13 000446   000450 602010 13                 TNC     s:13946+5,X0
        13 000447   002737 710000 13                 TRA     s:14615
        13 000450   000503 710000 13                 TRA     s:13950
        13 000451   001162 710000 13                 TRA     s:14153
        13 000452   001217 710000 13                 TRA     s:14168
        13 000453   002737 710000 13                 TRA     s:14615
        13 000454   002737 710000 13                 TRA     s:14615
        13 000455   002737 710000 13                 TRA     s:14615
        13 000456   001250 710000 13                 TRA     s:14180
        13 000457   001315 710000 13                 TRA     s:14216
        13 000460   002741 710000 13                 TRA     s:14619
        13 000461   001327 710000 13                 TRA     s:14226
        13 000462   001443 710000 13                 TRA     s:14278
        13 000463   001520 710000 13                 TRA     s:14304
        13 000464   001250 710000 13                 TRA     s:14180
        13 000465   001557 710000 13                 TRA     s:14321
        13 000466   001610 710000 13                 TRA     s:14338
        13 000467   001620 710000 13                 TRA     s:14345
        13 000470   001712 710000 13                 TRA     s:14380
        13 000471   002011 710000 13                 TRA     s:14426
        13 000472   002033 710000 13                 TRA     s:14443
        13 000473   002033 710000 13                 TRA     s:14443
        13 000474   002106 710000 13                 TRA     s:14469
        13 000475   002170 710000 13                 TRA     s:14493
        13 000476   002200 710000 13                 TRA     s:14503
        13 000477   002215 710000 13                 TRA     s:14509
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:115  
        13 000500   002737 710000 13                 TRA     s:14615
        13 000501   002241 710000 13                 TRA     s:14523
        13 000502   002652 710000 13                 TRA     s:14599

      585    13947
      586    13948    2      CASE (0 /* specify-command */);

      587    13949
      588    13950    2         OPTN = 0;

  13950 13 000503   200012 450100                    STZ     OPTN,,AUTO

      589    13951
      590    13952    3         DO CASE (OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE);

  13952 13 000504   000003 471500                    LDP1    3,,PR0
        13 000505   100000 721100                    LXL1    0,,PR1
        13 000506   000003 101003                    CMPX1   3,DU
        13 000507   000511 602011 13                 TNC     s:13952+5,X1
        13 000510   000526 710000 13                 TRA     s:13970
        13 000511   000514 710000 13                 TRA     s:13956
        13 000512   000520 710000 13                 TRA     s:13961
        13 000513   000525 710000 13                 TRA     s:13966

      591    13953
      592    13954    3         CASE (0 /* also */);

      593    13955
      594    13956    3            OPTN = 1;

  13956 13 000514   000001 235007                    LDA     1,DL
        13 000515   200012 755100                    STA     OPTN,,AUTO

      595    13957    3            CHANGE_MODE = 1 /* Add flags */;

  13957 13 000516   200013 755100                    STA     CHANGE_MODE,,AUTO
        13 000517   000526 710000 13                 TRA     s:13970
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:116  

      596    13958
      597    13959    3         CASE (1 /* dont */);

      598    13960
      599    13961    3            OPTN = 1;

  13961 13 000520   000001 235007                    LDA     1,DL
        13 000521   200012 755100                    STA     OPTN,,AUTO

      600    13962    3            CHANGE_MODE = 2 /* Delete flags */;

  13962 13 000522   000002 236007                    LDQ     2,DL
        13 000523   200013 756100                    STQ     CHANGE_MODE,,AUTO
        13 000524   000526 710000 13                 TRA     s:13970

      601    13963
      602    13964    3         CASE (2 /* neither prefix */);

      603    13965
      604    13966    3            CHANGE_MODE = 0;

  13966 13 000525   200013 450100                    STZ     CHANGE_MODE,,AUTO

      605    13967
      606    13968    3         END;

      607    13969
      608    13970    3         DO CASE (OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.SUBLK$(0) ->

  13970 13 000526   200012 722100                    LXL2    OPTN,,AUTO
        13 000527   000003 473512                    LDP3    3,X2,PR0
        13 000530   300003 474500                    LDP4    3,,PR3
        13 000531   400000 723100                    LXL3    0,,PR4
        13 000532   000002 103003                    CMPX3   2,DU
        13 000533   000535 602013 13                 TNC     s:13970+7,X3
        13 000534   000550 710000 13                 TRA     s:13985
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:117  
        13 000535   000537 710000 13                 TRA     s:13975
        13 000536   000544 710000 13                 TRA     s:13980

      609    13971    3           OUT$BLK.CODE);
      610    13972
      611    13973    3         CASE (0 /* display */);

      612    13974
      613    13975    3            FLAGS$ = ADDR(PS_DISPLAY_FLAGS);

  13975 13 000537   000033 236000 14                 LDQ     27
        13 000540   200014 756100                    STQ     FLAGS$,,AUTO

      614    13976    3            FEP_FLAGS$ = ADDR(PS_FEP_DISP_FLAGS);

  13976 13 000541   000034 236000 14                 LDQ     28
        13 000542   200015 756100                    STQ     FEP_FLAGS$,,AUTO
        13 000543   000550 710000 13                 TRA     s:13985

      615    13977
      616    13978    3         CASE (1 /* log */);

      617    13979
      618    13980    3            FLAGS$ = ADDR(PS_LOG_FLAGS);

  13980 13 000544   000035 236000 14                 LDQ     29
        13 000545   200014 756100                    STQ     FLAGS$,,AUTO

      619    13981    3            FEP_FLAGS$ = ADDR(PS_FEP_LOG_FLAGS);

  13981 13 000546   000036 236000 14                 LDQ     30
        13 000547   200015 756100                    STQ     FEP_FLAGS$,,AUTO

      620    13982
      621    13983    3         END;

      622    13984
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:118  
      623    13985    2         IF CHANGE_MODE=0

  13985 13 000550   200013 235100                    LDA     CHANGE_MODE,,AUTO
        13 000551   000556 601000 13                 TNZ     s:13990

      624    13986    3         THEN DO;

      625    13987    3            FEP_FLAGS$ -> PS_FEP_BASED_FLAGS = '0'B;

  13987 13 000552   200015 475500                    LDP5    FEP_FLAGS$,,AUTO
        13 000553   000100 100400                    MLR     fill='000'O
        13 000554   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        13 000555   500000 003100                    ADSC9   0,,PR5                   cn=0,n=1600

      626    13988    3         END;

      627    13989
      628    13990    2         OPTN = OPTN + 1;

  13990 13 000556   200012 236100                    LDQ     OPTN,,AUTO
        13 000557   000001 036007                    ADLQ    1,DL
        13 000560   200012 756100                    STQ     OPTN,,AUTO

      629    13991
      630    13992    2         PS_WORKING_FLAGS = '0'B;

  13992 13 000561   000000 450000 xsym               STZ     PS_WORKING_FLAGS

      631    13993
      632    13994    3         DO WHILE (OPTN < OUT$BLK.NSUBLKS);

  13994 13 000562   200004 470500                    LDP0    CMD$,,AUTO
        13 000563   000001 236100                    LDQ     1,,PR0
        13 000564   000022 772000                    QRL     18
        13 000565   200012 116100                    CMPQ    OPTN,,AUTO
        13 000566   001123 602000 13                 TNC     s:14130
        13 000567   001123 600000 13                 TZE     s:14130
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:119  

      633    13995
      634    13996    4            DO CASE (OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.CODE);

  13996 13 000570   200004 470500                    LDP0    CMD$,,AUTO
        13 000571   200012 720100                    LXL0    OPTN,,AUTO
        13 000572   000003 471510                    LDP1    3,X0,PR0
        13 000573   100000 721100                    LXL1    0,,PR1
        13 000574   000022 101003                    CMPX1   18,DU
        13 000575   000577 602011 13                 TNC     s:13996+7,X1
        13 000576   001112 710000 13                 TRA     s:14126
        13 000577   000621 710000 13                 TRA     s:14000
        13 000600   000644 710000 13                 TRA     s:14013
        13 000601   000673 710000 13                 TRA     s:14029
        13 000602   000675 710000 13                 TRA     s:14033
        13 000603   000700 710000 13                 TRA     s:14037
        13 000604   000703 710000 13                 TRA     s:14041
        13 000605   001056 710000 13                 TRA     s:14089
        13 000606   001061 710000 13                 TRA     s:14093
        13 000607   001064 710000 13                 TRA     s:14097
        13 000610   001112 710000 13                 TRA     s:14126
        13 000611   001067 710000 13                 TRA     s:14101
        13 000612   001072 710000 13                 TRA     s:14105
        13 000613   001075 710000 13                 TRA     s:14109
        13 000614   001100 710000 13                 TRA     s:14113
        13 000615   001105 710000 13                 TRA     s:14118
        13 000616   001110 710000 13                 TRA     s:14122
        13 000617   000703 710000 13                 TRA     s:14041
        13 000620   000703 710000 13                 TRA     s:14041

      635    13997
      636    13998    4            CASE (0 /* pmdat */);

      637    13999
      638    14000    4               PS_WORKING_FLAGS.CPU = %YES#;

  14000 13 000621   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:120  
        13 000622   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      639    14001    4               PS_WORKING_FLAGS.RESOURCES = %YES#;

  14001 13 000623   200000 236003                    LDQ     65536,DU
        13 000624   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      640    14002    4               PS_WORKING_FLAGS.SCPU = %YES#;

  14002 13 000625   020000 236003                    LDQ     8192,DU
        13 000626   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      641    14003    4               PS_WORKING_FLAGS.DEVICES = %YES#;

  14003 13 000627   100000 236003                    LDQ     32768,DU
        13 000630   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      642    14004    4               PS_WORKING_FLAGS.PROCS = %YES#;

  14004 13 000631   010000 236003                    LDQ     4096,DU
        13 000632   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      643    14005    4               PS_WORKING_FLAGS.CHANNELS = %YES#;

  14005 13 000633   040000 236003                    LDQ     16384,DU
        13 000634   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      644    14006    4               PS_WORKING_FLAGS.HISTOGRAMS = %YES#;

  14006 13 000635   002000 236003                    LDQ     1024,DU
        13 000636   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      645    14007    4               PS_WORKING_FLAGS.SUMMARY = %YES#;

  14007 13 000637   004000 236003                    LDQ     2048,DU
        13 000640   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:121  
      646    14008    4               PS_WORKING_FLAGS.FAULT = %YES#;

  14008 13 000641   001000 236003                    LDQ     512,DU
        13 000642   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 000643   001112 710000 13                 TRA     s:14126

      647    14009
      648    14010
      649    14011    4            CASE (1 /* all */);

      650    14012
      651    14013    4               PS_WORKING_FLAGS.CPU = %YES#;

  14013 13 000644   400000 236003                    LDQ     -131072,DU
        13 000645   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      652    14014    4               PS_WORKING_FLAGS.RESOURCES = %YES#;

  14014 13 000646   200000 236003                    LDQ     65536,DU
        13 000647   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      653    14015    4               PS_WORKING_FLAGS.SCPU = %YES#;

  14015 13 000650   020000 236003                    LDQ     8192,DU
        13 000651   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      654    14016    4               PS_WORKING_FLAGS.DEVICES = %YES#;

  14016 13 000652   100000 236003                    LDQ     32768,DU
        13 000653   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      655    14017    4               PS_WORKING_FLAGS.PROCS = %YES#;

  14017 13 000654   010000 236003                    LDQ     4096,DU
        13 000655   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      656    14018    4               PS_WORKING_FLAGS.CHANNELS = %YES#;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:122  

  14018 13 000656   040000 236003                    LDQ     16384,DU
        13 000657   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      657    14019    4               PS_WORKING_FLAGS.HISTOGRAMS = %YES#;

  14019 13 000660   002000 236003                    LDQ     1024,DU
        13 000661   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      658    14020    4               PS_WORKING_FLAGS.SUMMARY = %YES#;

  14020 13 000662   004000 236003                    LDQ     2048,DU
        13 000663   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      659    14021    4               PS_WORKING_FLAGS.FAULT = %YES#;

  14021 13 000664   001000 236003                    LDQ     512,DU
        13 000665   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      660    14022    4               PS_WORKING_FLAGS.FEP = %YES#;

  14022 13 000666   000400 236003                    LDQ     256,DU
        13 000667   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      661    14023    4               PS_WORKING_FLAGS.MOUSE = %YES#;

  14023 13 000670   000200 236003                    LDQ     128,DU
        13 000671   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 000672   001112 710000 13                 TRA     s:14126

      662    14024        /*N* FEPS HERE */
      663    14025
      664    14026
      665    14027    4            CASE (2 /* none */);

      666    14028
      667    14029    4               PS_WORKING_FLAGS = %NO#;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:123  

  14029 13 000673   000000 450000 xsym               STZ     PS_WORKING_FLAGS
        13 000674   001112 710000 13                 TRA     s:14126

      668    14030
      669    14031    4            CASE (3 /* cpu */);

      670    14032
      671    14033    4               PS_WORKING_FLAGS.CPU = %YES#;

  14033 13 000675   400000 236003                    LDQ     -131072,DU
        13 000676   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 000677   001112 710000 13                 TRA     s:14126

      672    14034
      673    14035    4            CASE (4 /* resources */);

      674    14036
      675    14037    4               PS_WORKING_FLAGS.RESOURCES = %YES#;

  14037 13 000700   200000 236003                    LDQ     65536,DU
        13 000701   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 000702   001112 710000 13                 TRA     s:14126

      676    14038
      677    14039    4            CASE (5 /* feps */, 16 /* fep summary */, 17 /* fep extended */);

      678    14040
      679    14041    4               CALL FEPBITS(DISP, OUT$BLK.SUBLK$(OPTN)->OUT$BLK.SUBLK$(1),

  14041 13 000703   000037 236000 14                 LDQ     31
        13 000704   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 000705   100004 633500                    EPPR3   4,,PR1
        13 000706   200276 453500                    STP3    @UTS+1,,AUTO
        13 000707   200020 631500                    EPPR1   DISP,,AUTO
        13 000710   200275 451500                    STP1    TEMP_END_UTS+3,,AUTO
        13 000711   002772 701000 13                 TSX1    FEPBITS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:124  
        13 000712   000000 011000                    NOP     0

      680    14042    4                 FEP_DISP_MASKS ) ;
      681    14043    4               CALL FEPBITS(SLCT, OUT$BLK.SUBLK$(OPTN)->OUT$BLK.SUBLK$(2),

  14043 13 000713   200004 470500                    LDP0    CMD$,,AUTO
        13 000714   200012 720100                    LXL0    OPTN,,AUTO
        13 000715   000003 471510                    LDP1    3,X0,PR0
        13 000716   000040 236000 14                 LDQ     32
        13 000717   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 000720   100005 633500                    EPPR3   5,,PR1
        13 000721   200276 453500                    STP3    @UTS+1,,AUTO
        13 000722   200021 631500                    EPPR1   SLCT,,AUTO
        13 000723   200275 451500                    STP1    TEMP_END_UTS+3,,AUTO
        13 000724   002772 701000 13                 TSX1    FEPBITS
        13 000725   000000 011000                    NOP     0

      682    14044    4                 FEP_SLCT_MASKS ) ;
      683    14045
      684    14046    4               IF OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.CODE = 16 THEN

  14046 13 000726   200004 470500                    LDP0    CMD$,,AUTO
        13 000727   200012 720100                    LXL0    OPTN,,AUTO
        13 000730   000003 471510                    LDP1    3,X0,PR0
        13 000731   100000 721100                    LXL1    0,,PR1
        13 000732   000020 101003                    CMPX1   16,DU
        13 000733   000737 601000 13                 TNZ     s:14048

      685    14047    4               DISP = DISP | FEP_DISP_MODE_MASKS.SUMMARY ;

  14047 13 000734   200020 236100                    LDQ     DISP,,AUTO
        13 000735   000007 276000 12                 ORQ     FEP_DISP_MODE_MASKS
        13 000736   200020 756100                    STQ     DISP,,AUTO

      686    14048    4               IF OUT$BLK.SUBLK$(OPTN) -> OUT$BLK.CODE = 17 THEN

  14048 13 000737   000003 471510                    LDP1    3,X0,PR0
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:125  
        13 000740   100000 721100                    LXL1    0,,PR1
        13 000741   000021 101003                    CMPX1   17,DU
        13 000742   000746 601000 13                 TNZ     s:14056

      687    14049    4               DISP = DISP | FEP_DISP_MODE_MASKS.EXTENDED ;

  14049 13 000743   200020 236100                    LDQ     DISP,,AUTO
        13 000744   000010 276000 12                 ORQ     FEP_DISP_MODE_MASKS+1
        13 000745   200020 756100                    STQ     DISP,,AUTO

      688    14050
      689    14051        /*          DO LYR=0 TO ((SIZEW(FEP_LYR_MASKS)/SIZEW(FEP_MASK))-1);
      690    14052                       IF NOT (DISP & ADDR(FEP_LYR_MASKS)->FEP_MASK(LYR))
      691    14053                       THEN DISP = DISP | ADDR(FEP_LYR_MASKS)->FEP_MASK(LYR);
      692    14054                    END;
      693    14055        */
      694    14056    4               IF OUT$BLK.SUBLK$(OPTN) ->

  14056 13 000746   000003 471510                    LDP1    3,X0,PR0
        13 000747   100003 473500                    LDP3    3,,PR1
        13 000750   300001 221100                    LDX1    1,,PR3
        13 000751   000763 601000 13                 TNZ     s:14063

      695    14057    4                 OUT$BLK.SUBLK$(0) ->
      696    14058    4                 OUT$BLK.NSUBLKS = 0
      697    14059    5               THEN DO PS_FEPNO=0 TO %PS_MAXFE#;

  14059 13 000752   000000 450000 xsym               STZ     PS_FEPNO

      698    14060    5                  CALL UPBITS;

  14060 13 000753   003047 701000 13                 TSX1    UPBITS
        13 000754   000000 011000                    NOP     0

      699    14061    5               END;

  14061 13 000755   000000 235000 xsym               LDA     PS_FEPNO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:126  
        13 000756   000001 035007                    ADLA    1,DL
        13 000757   000000 755000 xsym               STA     PS_FEPNO
        13 000760   000144 115007                    CMPA    100,DL
        13 000761   000753 602000 13                 TNC     s:14060
        13 000762   001021 710000 13                 TRA     s:14073

      700    14062
      701    14063    5               ELSE DO IX = 0 TO OUT$BLK.SUBLK$(OPTN) ->

  14063 13 000763   200016 450100                    STZ     IX,,AUTO
        13 000764   001010 710000 13                 TRA     s:14071+3

      702    14064    5                 OUT$BLK.SUBLK$(0) ->
      703    14065    5                 OUT$BLK.NSUBLKS-1;
      704    14066    5                  CALL CHARBIN (PS_FEPNO, OUT$BLK.SUBLK$(OPTN) ->

  14066 13 000765   200004 470500                    LDP0    CMD$,,AUTO
        13 000766   200012 720100                    LXL0    OPTN,,AUTO
        13 000767   000003 471510                    LDP1    3,X0,PR0
        13 000770   100003 473500                    LDP3    3,,PR1
        13 000771   200016 721100                    LXL1    IX,,AUTO
        13 000772   300003 474511                    LDP4    3,X1,PR3
        13 000773   400004 236100                    LDQ     4,,PR4
        13 000774   000033 772000                    QRL     27
        13 000775   000000 622006                    EAX2    0,QL
        13 000776   000100 305540                    DTB
        13 000777   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
        13 001000   200334 000010                    NDSC9   KEEP_SCANNING+2,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 001001   200335 235100                    LDA     KEEP_SCANNING+3,,AUTO
        13 001002   000000 755000 xsym               STA     PS_FEPNO

      705    14067    5                    OUT$BLK.SUBLK$(0) ->
      706    14068    5                    OUT$BLK.SUBLK$(IX) ->
      707    14069    5                    OUT$SYM.TEXT);
      708    14070    5                  CALL UPBITS;

  14070 13 001003   003047 701000 13                 TSX1    UPBITS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:127  
        13 001004   000000 011000                    NOP     0

      709    14071    5               END;

  14071 13 001005   200016 235100                    LDA     IX,,AUTO
        13 001006   000001 035007                    ADLA    1,DL
        13 001007   200016 755100                    STA     IX,,AUTO
        13 001010   200004 470500                    LDP0    CMD$,,AUTO
        13 001011   200012 720100                    LXL0    OPTN,,AUTO
        13 001012   000003 471510                    LDP1    3,X0,PR0
        13 001013   100003 473500                    LDP3    3,,PR1
        13 001014   300001 236100                    LDQ     1,,PR3
        13 001015   000022 772000                    QRL     18
        13 001016   200016 116100                    CMPQ    IX,,AUTO
        13 001017   001021 600000 13                 TZE     s:14073
        13 001020   000765 603000 13                 TRC     s:14066

      710    14072
      711    14073    4               PS_FEPING = %NO#;

  14073 13 001021   000000 450000 xsym               STZ     PS_FEPING

      712    14074    5               DO PS_FEPNO = 0 TO %PS_MAXFE#;

  14074 13 001022   000000 450000 xsym               STZ     PS_FEPNO

      713    14075    5                  IF PS_FEP_DISP_FLAGS.DISP(PS_FEPNO) OR

  14075 13 001023   000000 235000 xsym               LDA     PS_FEPNO
        13 001024   000002 735000                    ALS     2
        13 001025   000000 235005 xsym               LDA     PS_FEP_DISP_FLAGS,AL
        13 001026   001043 601000 13                 TNZ     s:14080
        13 001027   000000 235000 xsym               LDA     PS_FEPNO
        13 001030   000002 735000                    ALS     2
        13 001031   000001 235005 xsym               LDA     PS_FEP_DISP_FLAGS+1,AL
        13 001032   001043 601000 13                 TNZ     s:14080
        13 001033   000000 235000 xsym               LDA     PS_FEPNO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:128  
        13 001034   000002 735000                    ALS     2
        13 001035   000000 235005 xsym               LDA     PS_FEP_LOG_FLAGS,AL
        13 001036   001043 601000 13                 TNZ     s:14080
        13 001037   000000 235000 xsym               LDA     PS_FEPNO
        13 001040   000002 735000                    ALS     2
        13 001041   000001 235005 xsym               LDA     PS_FEP_LOG_FLAGS+1,AL
        13 001042   001046 600000 13                 TZE     s:14083

      714    14076    5                    PS_FEP_DISP_FLAGS.SLCT(PS_FEPNO) OR
      715    14077    5                    PS_FEP_LOG_FLAGS.DISP(PS_FEPNO) OR
      716    14078    5                    PS_FEP_LOG_FLAGS.SLCT(PS_FEPNO)
      717    14079    6                  THEN DO;

      718    14080    6                     PS_FEPING = '1'B;

  14080 13 001043   400000 236003                    LDQ     -131072,DU
        13 001044   000000 756000 xsym               STQ     PS_FEPING

      719    14081    6                     GOTO L_FEPING;

  14081 13 001045   001053 710000 13                 TRA     L_FEPING

      720    14082    6                  END /* IF */;
      721    14083    5               END /* DO PS_FEPNO */;

  14083 13 001046   000000 235000 xsym               LDA     PS_FEPNO
        13 001047   000001 035007                    ADLA    1,DL
        13 001050   000000 755000 xsym               STA     PS_FEPNO
        13 001051   000144 115007                    CMPA    100,DL
        13 001052   001023 602000 13                 TNC     s:14075

      722    14084    4   L_FEPING:
      723    14085    4               PS_WORKING_FLAGS.FEP = %YES#;

  14085 13 001053   000400 236003       L_FEPING     LDQ     256,DU
        13 001054   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001055   001112 710000 13                 TRA     s:14126
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:129  

      724    14086
      725    14087    4            CASE (6 /* devices */);

      726    14088
      727    14089    4               PS_WORKING_FLAGS.DEVICES = %YES#;

  14089 13 001056   100000 236003                    LDQ     32768,DU
        13 001057   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001060   001112 710000 13                 TRA     s:14126

      728    14090
      729    14091    4            CASE (7 /* scpu */);

      730    14092
      731    14093    4               PS_WORKING_FLAGS.SCPU = %YES#;

  14093 13 001061   020000 236003                    LDQ     8192,DU
        13 001062   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001063   001112 710000 13                 TRA     s:14126

      732    14094
      733    14095    4            CASE (8 /* mouse */);

      734    14096
      735    14097    4               PS_WORKING_FLAGS.MOUSE = %YES#;

  14097 13 001064   000200 236003                    LDQ     128,DU
        13 001065   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001066   001112 710000 13                 TRA     s:14126

      736    14098
      737    14099    4            CASE (10 /* procs */);

      738    14100
      739    14101    4               PS_WORKING_FLAGS.PROCS = %YES#;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:130  
  14101 13 001067   010000 236003                    LDQ     4096,DU
        13 001070   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001071   001112 710000 13                 TRA     s:14126

      740    14102
      741    14103    4            CASE (11 /* summary */);

      742    14104
      743    14105    4               PS_WORKING_FLAGS.SUMMARY = %YES#;

  14105 13 001072   004000 236003                    LDQ     2048,DU
        13 001073   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001074   001112 710000 13                 TRA     s:14126

      744    14106
      745    14107    4            CASE (12 /* channels */);

      746    14108
      747    14109    4               PS_WORKING_FLAGS.CHANNELS = %YES#;

  14109 13 001075   040000 236003                    LDQ     16384,DU
        13 001076   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001077   001112 710000 13                 TRA     s:14126

      748    14110
      749    14111    4            CASE (13 /* i/o */);

      750    14112
      751    14113    4               PS_WORKING_FLAGS.DEVICES = %YES#;

  14113 13 001100   100000 236003                    LDQ     32768,DU
        13 001101   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      752    14114    4               PS_WORKING_FLAGS.CHANNELS = %YES#;

  14114 13 001102   040000 236003                    LDQ     16384,DU
        13 001103   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:131  
        13 001104   001112 710000 13                 TRA     s:14126

      753    14115
      754    14116    4            CASE (14 /* histograms */);

      755    14117
      756    14118    4               PS_WORKING_FLAGS.HISTOGRAMS = %YES#;

  14118 13 001105   002000 236003                    LDQ     1024,DU
        13 001106   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS
        13 001107   001112 710000 13                 TRA     s:14126

      757    14119
      758    14120    4            CASE (15 /* fault */);

      759    14121
      760    14122    4               PS_WORKING_FLAGS.FAULT = %YES#;

  14122 13 001110   001000 236003                    LDQ     512,DU
        13 001111   000000 256000 xsym               ORSQ    PS_WORKING_FLAGS

      761    14123
      762    14124    4            END;

      763    14125
      764    14126    3            OPTN = OPTN + 1;

  14126 13 001112   200012 235100                    LDA     OPTN,,AUTO
        13 001113   000001 035007                    ADLA    1,DL
        13 001114   200012 755100                    STA     OPTN,,AUTO

      765    14127
      766    14128    3         END;

  14128 13 001115   200004 470500                    LDP0    CMD$,,AUTO
        13 001116   000001 236100                    LDQ     1,,PR0
        13 001117   000022 772000                    QRL     18
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:132  
        13 001120   200012 116100                    CMPQ    OPTN,,AUTO
        13 001121   001123 600000 13                 TZE     s:14130
        13 001122   000570 603000 13                 TRC     s:13996

      767    14129
      768    14130    3         DO CASE (CHANGE_MODE);

  14130 13 001123   200013 235100                    LDA     CHANGE_MODE,,AUTO
        13 001124   000003 115007                    CMPA    3,DL
        13 001125   001127 602005 13                 TNC     s:14130+4,AL
        13 001126   002741 710000 13                 TRA     s:14619
        13 001127   001132 710000 13                 TRA     s:14134
        13 001130   001137 710000 13                 TRA     s:14138
        13 001131   001150 710000 13                 TRA     s:14143

      769    14131
      770    14132    3         CASE (0 /* new flags */);

      771    14133
      772    14134    3            FLAGS$ -> PS_BASED_FLAGS = PS_WORKING_FLAGS;

  14134 13 001132   000000 236000 xsym               LDQ     PS_WORKING_FLAGS
        13 001133   777600 376003                    ANQ     -128,DU
        13 001134   200014 471500                    LDP1    FLAGS$,,AUTO
        13 001135   100000 756100                    STQ     0,,PR1
        13 001136   002741 710000 13                 TRA     s:14619

      773    14135
      774    14136    3         CASE (1 /* Add flags */);

      775    14137
      776    14138    3            FLAGS$ -> PS_BASED_FLAGS =

  14138 13 001137   000000 236000 xsym               LDQ     PS_WORKING_FLAGS
        13 001140   777600 376003                    ANQ     -128,DU
        13 001141   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 001142   200014 471500                    LDP1    FLAGS$,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:133  
        13 001143   100000 236100                    LDQ     0,,PR1
        13 001144   777600 376003                    ANQ     -128,DU
        13 001145   200334 276100                    ORQ     KEEP_SCANNING+2,,AUTO
        13 001146   100000 756100                    STQ     0,,PR1
        13 001147   002741 710000 13                 TRA     s:14619

      777    14139    3              FLAGS$ -> PS_BASED_FLAGS | PS_WORKING_FLAGS;
      778    14140
      779    14141    3         CASE (2 /* Delete flags */);

      780    14142
      781    14143    3            FLAGS$ -> PS_BASED_FLAGS =

  14143 13 001150   000000 236000 xsym               LDQ     PS_WORKING_FLAGS
        13 001151   777600 376003                    ANQ     -128,DU
        13 001152   777600 676003                    ERQ     -128,DU
        13 001153   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 001154   200014 471500                    LDP1    FLAGS$,,AUTO
        13 001155   100000 236100                    LDQ     0,,PR1
        13 001156   777600 376003                    ANQ     -128,DU
        13 001157   200334 376100                    ANQ     KEEP_SCANNING+2,,AUTO
        13 001160   100000 756100                    STQ     0,,PR1

      782    14144    3              FLAGS$ -> PS_BASED_FLAGS & ~ PS_WORKING_FLAGS;
      783    14145
      784    14146    3         END;

  14146 13 001161   002741 710000 13                 TRA     s:14619

      785    14147
      786    14148
      787    14149
      788    14150        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:134  
      789    14151    2      CASE (1 /* interval */);

      790    14152
      791    14153    2         PS_INTERVAL = 0;

  14153 13 001162   000000 450000 xsym               STZ     PS_INTERVAL

      792    14154
      793    14155    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  14155 13 001163   200005 450100                    STZ     I,,AUTO
        13 001164   001205 710000 13                 TRA     s:14160+3

      794    14156
      795    14157    3            CALL CHARBIN (J, OUT$BLK.SUBLK$(I) -> OUT$SYM.TEXT);

  14157 13 001165   200004 470500                    LDP0    CMD$,,AUTO
        13 001166   200005 720100                    LXL0    I,,AUTO
        13 001167   000003 471510                    LDP1    3,X0,PR0
        13 001170   100004 236100                    LDQ     4,,PR1
        13 001171   000033 772000                    QRL     27
        13 001172   000000 621006                    EAX1    0,QL
        13 001173   000100 305540                    DTB
        13 001174   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
        13 001175   200006 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      796    14158    3            PS_INTERVAL = (PS_INTERVAL * 60) + J;

  14158 13 001176   000000 236000 xsym               LDQ     PS_INTERVAL
        13 001177   000074 402007                    MPY     60,DL
        13 001200   200006 036100                    ADLQ    J,,AUTO
        13 001201   000000 756000 xsym               STQ     PS_INTERVAL

      797    14159
      798    14160    3         END;

  14160 13 001202   200005 235100                    LDA     I,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:135  
        13 001203   000001 035007                    ADLA    1,DL
        13 001204   200005 755100                    STA     I,,AUTO
        13 001205   000001 236100                    LDQ     1,,PR0
        13 001206   000022 772000                    QRL     18
        13 001207   200005 116100                    CMPQ    I,,AUTO
        13 001210   001212 600000 13                 TZE     s:14162
        13 001211   001165 603000 13                 TRC     s:14157

      799    14161
      800    14162    2         IF PS_INTERVAL = 0

  14162 13 001212   000000 235000 xsym               LDA     PS_INTERVAL
        13 001213   002741 601000 13                 TNZ     s:14619

      801    14163    2         THEN PS_INTERVAL = PS_DEFAULT_INTERVAL;

  14163 13 001214   000000 235000 xsym               LDA     PS_DEFAULT_INTERVAL
        13 001215   000000 755000 xsym               STA     PS_INTERVAL
        13 001216   002741 710000 13                 TRA     s:14619

      802    14164
      803    14165        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:136  
      804    14166    2      CASE (2 /* file */);

      805    14167
      806    14168    2         FPT_FID.TEXTFID_ = VECTOR(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  14168 13 001217   000003 471500                    LDP1    3,,PR0
        13 001220   100004 236100                    LDQ     4,,PR1
        13 001221   000033 772000                    QRL     27
        13 001222   000064 737000                    LLS     52
        13 001223   000140 135007                    SBLA    96,DL
        13 001224   200334 451500                    STP1    KEEP_SCANNING+2,,AUTO
        13 001225   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 001226   000041 036000 14                 ADLQ    33
        13 001227   004714 757000 11                 STAQ    FPT_FID+2

      807    14169
      808    14170    2         CALL M$FID (FPT_FID) ALTRET (BAILOUT);

  14170 13 001230   004712 630400 11                 EPPR0   FPT_FID
        13 001231   420001 713400                    CLIMB   alt,+8193
        13 001232   404400 401760                    pmme    nvectors=10
        13 001233   000256 702000 13                 TSX2    BAILOUT

      809    14171
      810    14172    2         IF PS_FID_PARAMS.ASN@ ~= %FILE#

  14172 13 001234   000020 236000 xsym               LDQ     PS_FID_PARAMS+16
        13 001235   777000 376003                    ANQ     -512,DU
        13 001236   001000 116003                    CMPQ    512,DU
        13 001237   001244 600000 13                 TZE     s:14175

      811    14173    2         THEN CALL PSE$ERRMSG (E$PS_NEED_FILE, WARNING#);

  14173 13 001240   000042 630400 14                 EPPR0   34
        13 001241   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 001242   000000 701000 xent               TSX1    PSE$ERRMSG
        13 001243   000000 011000                    NOP     0
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:137  

      812    14174
      813    14175    2         PS_FILE_PARAMS = PS_FID_PARAMS;

  14175 13 001244   000000 100400                    MLR     fill='000'O
        13 001245   000000 000105 xsym               ADSC9   PS_FID_PARAMS            cn=0,n=69
        13 001246   000000 000105 xsym               ADSC9   PS_FILE_PARAMS           cn=0,n=69
        13 001247   002741 710000 13                 TRA     s:14619

      814    14176
      815    14177        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:138  
      816    14178    2      CASE (6 /* punt */, 12 /* snap */);

      817    14179
      818    14180    2         IF OUT$BLK.NSUBLKS = 0

  14180 13 001250   000001 221100                    LDX1    1,,PR0
        13 001251   001261 601000 13                 TNZ     s:14191

      819    14181    3         THEN DO;

      820    14182
      821    14183    3            IF OUT$BLK.CODE = 12 /* snap */

  14183 13 001252   000014 100003                    CMPX0   12,DU
        13 001253   001256 601000 13                 TNZ     s:14185

      822    14184    3            THEN PS_PUNT_COUNT = 0;

  14184 13 001254   000000 450000 xsym               STZ     PS_PUNT_COUNT
        13 001255   001310 710000 13                 TRA     s:14210

      823    14185    3            ELSE PS_PUNT_COUNT = 99999999;

  14185 13 001256   000044 235000 14                 LDA     36
        13 001257   000000 755000 xsym               STA     PS_PUNT_COUNT

      824    14186
      825    14187    3         END;

  14187 13 001260   001310 710000 13                 TRA     s:14210

      826    14188
      827    14189    3         ELSE DO;

      828    14190
      829    14191    4            DO CASE (OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE);

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:139  
  14191 13 001261   000003 471500                    LDP1    3,,PR0
        13 001262   100000 722100                    LXL2    0,,PR1
        13 001263   000003 102003                    CMPX2   3,DU
        13 001264   001266 602012 13                 TNC     s:14191+5,X2
        13 001265   001310 710000 13                 TRA     s:14210
        13 001266   001271 710000 13                 TRA     s:14195
        13 001267   001274 710000 13                 TRA     s:14199
        13 001270   001277 710000 13                 TRA     s:14203

      830    14192
      831    14193    4            CASE (0 /* "punt once" */);

      832    14194
      833    14195    4               PS_PUNT_COUNT = 1;

  14195 13 001271   000001 235007                    LDA     1,DL
        13 001272   000000 755000 xsym               STA     PS_PUNT_COUNT
        13 001273   001310 710000 13                 TRA     s:14210

      834    14196
      835    14197    4            CASE (1 /* "punt forever" */);

      836    14198
      837    14199    4               PS_PUNT_COUNT = 99999999;

  14199 13 001274   000044 235000 14                 LDA     36
        13 001275   000000 755000 xsym               STA     PS_PUNT_COUNT
        13 001276   001310 710000 13                 TRA     s:14210

      838    14200
      839    14201    4            CASE (2 /* "punt N" */);

      840    14202
      841    14203    4               CALL CHARBIN (PS_PUNT_COUNT, OUT$BLK.SUBLK$(0) ->

  14203 13 001277   100003 473500                    LDP3    3,,PR1
        13 001300   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:140  
        13 001301   000033 772000                    QRL     27
        13 001302   000000 623006                    EAX3    0,QL
        13 001303   000100 305540                    DTB
        13 001304   300004 230013                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X3
        13 001305   200334 000010                    NDSC9   KEEP_SCANNING+2,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 001306   200335 235100                    LDA     KEEP_SCANNING+3,,AUTO
        13 001307   000000 755000 xsym               STA     PS_PUNT_COUNT

      842    14204    4                 OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      843    14205
      844    14206    4            END /* do case */;

      845    14207
      846    14208    3         END /* else do */;

      847    14209
      848    14210    2         PS_MODE = DISPLAY_MODE#;

  14210 13 001310   000000 450000 xsym               STZ     PS_MODE

      849    14211
      850    14212    2         CALL PSD$DISP;

  14212 13 001311   000002 631400 xsym               EPPR1   B_VECTNIL+2
        13 001312   000000 701000 xent               TSX1    PSD$DISP
        13 001313   000000 011000                    NOP     0
        13 001314   002741 710000 13                 TRA     s:14619

      851    14213
      852    14214    2      CASE (7 /* end */);

      853    14215
      854    14216    2         CALL M$CLOSE (CLOSE_LO);

  14216 13 001315   004176 630400 11                 EPPR0   CLOSE_LO
        13 001316   050001 713400                    CLIMB   close
        13 001317   406000 401760                    pmme    nvectors=13
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:141  

      855    14217
      856    14218    2         FPT_EXIT.V.STEPCC# = PS_STEPCC ;

  14218 13 001320   000000 236000 xsym               LDQ     PS_STEPCC
        13 001321   000033 736000                    QLS     27
        13 001322   005114 552040 11                 STBQ    FPT_EXIT+4,'40'O

      857    14219    2         CALL M$EXIT ( FPT_EXIT ) ;

  14219 13 001323   005110 630400 11                 EPPR0   FPT_EXIT
        13 001324   000001 713400                    CLIMB   exit
        13 001325   400400 401760                    pmme    nvectors=2
        13 001326   002741 710000 13                 TRA     s:14619

      858    14220
      859    14221    2      CASE (8 /* null command */);

      860    14222
      861    14223        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:142  
      862    14224    2      CASE (9 /* reset */);

      863    14225
      864    14226    2         IF OUT$BLK.NSUBLKS = 0 /* default reset command */

  14226 13 001327   000001 221100                    LDX1    1,,PR0
        13 001330   001360 601000 13                 TNZ     s:14240

      865    14227    3         THEN DO;

      866    14228
      867    14229    3            PS_DISPLAY_FLAGS = PS_DEFAULT_DISPLAY_FLAGS;

  14229 13 001331   000000 236000 xsym               LDQ     PS_DEFAULT_DISPLAY_FLAGS
        13 001332   777600 376003                    ANQ     -128,DU
        13 001333   000000 756000 xsym               STQ     PS_DISPLAY_FLAGS

      868    14230    3            PS_LOG_FLAGS = PS_DEFAULT_LOG_FLAGS;

  14230 13 001334   000000 236000 xsym               LDQ     PS_DEFAULT_LOG_FLAGS
        13 001335   777600 376003                    ANQ     -128,DU
        13 001336   000000 756000 xsym               STQ     PS_LOG_FLAGS

      869    14231    3            PS_FEP_DISP_FLAGS = '0'B;

  14231 13 001337   000000 100400                    MLR     fill='000'O
        13 001340   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        13 001341   000000 003100 xsym               ADSC9   PS_FEP_DISP_FLAGS        cn=0,n=1600

      870    14232    3            PS_FEP_LOG_FLAGS = '0'B;

  14232 13 001342   000000 100400                    MLR     fill='000'O
        13 001343   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        13 001344   000000 003100 xsym               ADSC9   PS_FEP_LOG_FLAGS         cn=0,n=1600

      871    14233    3            PS_INTERVAL = PS_DEFAULT_INTERVAL;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:143  
  14233 13 001345   000000 235000 xsym               LDA     PS_DEFAULT_INTERVAL
        13 001346   000000 755000 xsym               STA     PS_INTERVAL

      872    14234    3            PS_FILE_PARAMS = PS_DEFAULT_FILE_PARAMS;

  14234 13 001347   000000 100400                    MLR     fill='000'O
        13 001350   000000 000105 xsym               ADSC9   PS_DEFAULT_FILE_PARAMS   cn=0,n=69
        13 001351   000000 000105 xsym               ADSC9   PS_FILE_PARAMS           cn=0,n=69

      873    14235    3            PS_START_UTS = 0;

  14235 13 001352   000000 450000 xsym               STZ     PS_START_UTS

      874    14236    3            PS_END_UTS = BITBIN('777777777777'O);

  14236 13 001353   000027 235000 xsym               LDA     B_VECTNIL+23
        13 001354   000000 755000 xsym               STA     PS_END_UTS

      875    14237    3            PS_SELECT_RPN.INFO.USED# = 0;

  14237 13 001355   000000 236003                    LDQ     0,DU
        13 001356   000000 552020 7                  STBQ    PS_SELECT_RPN,'20'O

      876    14238    3         END;

  14238 13 001357   002741 710000 13                 TRA     s:14619

      877    14239
      878    14240    3         ELSE DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  14240 13 001360   200005 450100                    STZ     I,,AUTO
        13 001361   001435 710000 13                 TRA     s:14273+3

      879    14241
      880    14242    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE);

  14242 13 001362   200004 470500                    LDP0    CMD$,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:144  
        13 001363   200005 720100                    LXL0    I,,AUTO
        13 001364   000003 471510                    LDP1    3,X0,PR0
        13 001365   100000 721100                    LXL1    0,,PR1
        13 001366   000006 101003                    CMPX1   6,DU
        13 001367   001371 602011 13                 TNC     s:14242+7,X1
        13 001370   001432 710000 13                 TRA     s:14273
        13 001371   001377 710000 13                 TRA     s:14246
        13 001372   001406 710000 13                 TRA     s:14251
        13 001373   001415 710000 13                 TRA     s:14256
        13 001374   001420 710000 13                 TRA     s:14260
        13 001375   001424 710000 13                 TRA     s:14264
        13 001376   001430 710000 13                 TRA     s:14269

      881    14243
      882    14244    4            CASE (0 /* reset display */);

      883    14245
      884    14246    4               PS_DISPLAY_FLAGS = PS_DEFAULT_DISPLAY_FLAGS;

  14246 13 001377   000000 236000 xsym               LDQ     PS_DEFAULT_DISPLAY_FLAGS
        13 001400   777600 376003                    ANQ     -128,DU
        13 001401   000000 756000 xsym               STQ     PS_DISPLAY_FLAGS

      885    14247    4               PS_FEP_DISP_FLAGS = '0'B;

  14247 13 001402   000000 100400                    MLR     fill='000'O
        13 001403   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        13 001404   000000 003100 xsym               ADSC9   PS_FEP_DISP_FLAGS        cn=0,n=1600
        13 001405   001432 710000 13                 TRA     s:14273

      886    14248
      887    14249    4            CASE (1 /* reset log */);

      888    14250
      889    14251    4               PS_LOG_FLAGS = PS_DEFAULT_LOG_FLAGS;

  14251 13 001406   000000 236000 xsym               LDQ     PS_DEFAULT_LOG_FLAGS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:145  
        13 001407   777600 376003                    ANQ     -128,DU
        13 001410   000000 756000 xsym               STQ     PS_LOG_FLAGS

      890    14252    4               PS_FEP_LOG_FLAGS = '0'B;

  14252 13 001411   000000 100400                    MLR     fill='000'O
        13 001412   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        13 001413   000000 003100 xsym               ADSC9   PS_FEP_LOG_FLAGS         cn=0,n=1600
        13 001414   001432 710000 13                 TRA     s:14273

      891    14253
      892    14254    4            CASE (2 /* reset interval */);

      893    14255
      894    14256    4               PS_INTERVAL = PS_DEFAULT_INTERVAL;

  14256 13 001415   000000 235000 xsym               LDA     PS_DEFAULT_INTERVAL
        13 001416   000000 755000 xsym               STA     PS_INTERVAL
        13 001417   001432 710000 13                 TRA     s:14273

      895    14257
      896    14258    4            CASE (3 /* reset file */);

      897    14259
      898    14260    4               PS_FILE_PARAMS = PS_DEFAULT_FILE_PARAMS;

  14260 13 001420   000000 100400                    MLR     fill='000'O
        13 001421   000000 000105 xsym               ADSC9   PS_DEFAULT_FILE_PARAMS   cn=0,n=69
        13 001422   000000 000105 xsym               ADSC9   PS_FILE_PARAMS           cn=0,n=69
        13 001423   001432 710000 13                 TRA     s:14273

      899    14261
      900    14262    4            CASE (4 /* reset time */);

      901    14263
      902    14264    4               PS_START_UTS = 0;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:146  
  14264 13 001424   000000 450000 xsym               STZ     PS_START_UTS

      903    14265    4               PS_END_UTS = BITBIN('777777777777'O);

  14265 13 001425   000027 235000 xsym               LDA     B_VECTNIL+23
        13 001426   000000 755000 xsym               STA     PS_END_UTS
        13 001427   001432 710000 13                 TRA     s:14273

      904    14266
      905    14267    4            CASE (5 /* reset select */);

      906    14268
      907    14269    4               PS_SELECT_RPN.INFO.USED# = 0;

  14269 13 001430   000000 236003                    LDQ     0,DU
        13 001431   000000 552020 7                  STBQ    PS_SELECT_RPN,'20'O

      908    14270
      909    14271    4            END /* do case */;

      910    14272
      911    14273    3         END /* do I */;

  14273 13 001432   200005 235100                    LDA     I,,AUTO
        13 001433   000001 035007                    ADLA    1,DL
        13 001434   200005 755100                    STA     I,,AUTO
        13 001435   000001 236100                    LDQ     1,,PR0
        13 001436   000022 772000                    QRL     18
        13 001437   200005 116100                    CMPQ    I,,AUTO
        13 001440   001442 600000 13                 TZE     s:14273+8
        13 001441   001362 603000 13                 TRC     s:14242
        13 001442   002741 710000 13                 TRA     s:14619

      912    14274
      913    14275        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:147  
      914    14276    2      CASE (10 /* initiate */);

      915    14277
      916    14278    2         CALL CHECK_FOR_EXPM;

  14278 13 001443   004070 701000 13                 TSX1    CHECK_FOR_EXPM
        13 001444   000000 011000                    NOP     0

      917    14279
      918    14280    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  14280 13 001445   200005 450100                    STZ     I,,AUTO
        13 001446   001511 710000 13                 TRA     s:14299+3

      919    14281
      920    14282    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE - 8);

  14282 13 001447   200004 470500                    LDP0    CMD$,,AUTO
        13 001450   200005 720100                    LXL0    I,,AUTO
        13 001451   000003 471510                    LDP1    3,X0,PR0
        13 001452   100000 236100                    LDQ     0,,PR1
        13 001453   777777 376007                    ANQ     -1,DL
        13 001454   000010 136007                    SBLQ    8,DL
        13 001455   000001 116007                    CMPQ    1,DL
        13 001456   001460 602006 13                 TNC     s:14282+9,QL
        13 001457   001506 710000 13                 TRA     s:14299
        13 001460   001461 710000 13                 TRA     s:14286

      921    14283
      922    14284    4            CASE (0 /* code 8 = MOUSE */);

      923    14285
      924    14286    4               IF OUT$BLK.SUBLK$(I) -> OUT$BLK.NSUBLKS = 0

  14286 13 001461   100001 221100                    LDX1    1,,PR1
        13 001462   001465 601000 13                 TNZ     s:14290

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:148  
      925    14287    4               THEN
      926    14288    4               FPT_SMOUSE.V.SYSID# = 0;

  14288 13 001463   004540 450000 11                 STZ     FPT_SMOUSE+2
        13 001464   001476 710000 13                 TRA     s:14293

      927    14289    4               ELSE
      928    14290    4               CALL CHARBIN (FPT_SMOUSE.V.SYSID#, OUT$BLK.SUBLK$(I) ->

  14290 13 001465   100003 473500                    LDP3    3,,PR1
        13 001466   300004 236100                    LDQ     4,,PR3
        13 001467   000033 772000                    QRL     27
        13 001470   000000 622006                    EAX2    0,QL
        13 001471   000100 305540                    DTB
        13 001472   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
        13 001473   200334 000010                    NDSC9   KEEP_SCANNING+2,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 001474   200335 235100                    LDA     KEEP_SCANNING+3,,AUTO
        13 001475   004540 755000 11                 STA     FPT_SMOUSE+2

      929    14291    4                 OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      930    14292
      931    14293    4               CALL M$SMOUSE(FPT_SMOUSE) ALTRET(BAILOUT);

  14293 13 001476   004536 630400 11                 EPPR0   FPT_SMOUSE
        13 001477   540003 713400                    CLIMB   alt,+49155
        13 001500   400000 401760                    pmme    nvectors=1
        13 001501   000256 702000 13                 TSX2    BAILOUT

      932    14294    4               CALL PSE$GRIPE (E$PS_MOUSE_GO);

  14294 13 001502   000003 630400 14                 EPPR0   3
        13 001503   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 001504   000000 701000 xent               TSX1    PSE$GRIPE
        13 001505   000000 011000                    NOP     0

      933    14295
      934    14296
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:149  
      935    14297    4            END;

      936    14298
      937    14299    3         END /* do I */;

  14299 13 001506   200005 235100                    LDA     I,,AUTO
        13 001507   000001 035007                    ADLA    1,DL
        13 001510   200005 755100                    STA     I,,AUTO
        13 001511   200004 470500                    LDP0    CMD$,,AUTO
        13 001512   000001 236100                    LDQ     1,,PR0
        13 001513   000022 772000                    QRL     18
        13 001514   200005 116100                    CMPQ    I,,AUTO
        13 001515   001517 600000 13                 TZE     s:14299+9
        13 001516   001447 603000 13                 TRC     s:14282
        13 001517   002741 710000 13                 TRA     s:14619

      938    14300
      939    14301        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:150  
      940    14302    2      CASE (11 /* terminate */);

      941    14303
      942    14304    2         CALL CHECK_FOR_EXPM;

  14304 13 001520   004070 701000 13                 TSX1    CHECK_FOR_EXPM
        13 001521   000000 011000                    NOP     0

      943    14305
      944    14306    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  14306 13 001522   200005 450100                    STZ     I,,AUTO
        13 001523   001550 710000 13                 TRA     s:14317+3

      945    14307
      946    14308    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE - 8);

  14308 13 001524   200004 470500                    LDP0    CMD$,,AUTO
        13 001525   200005 720100                    LXL0    I,,AUTO
        13 001526   000003 471510                    LDP1    3,X0,PR0
        13 001527   100000 236100                    LDQ     0,,PR1
        13 001530   777777 376007                    ANQ     -1,DL
        13 001531   000010 136007                    SBLQ    8,DL
        13 001532   000001 116007                    CMPQ    1,DL
        13 001533   001535 602006 13                 TNC     s:14308+9,QL
        13 001534   001545 710000 13                 TRA     s:14317
        13 001535   001536 710000 13                 TRA     s:14312

      947    14309
      948    14310    4            CASE (0 /* code 8 = MOUSE */);

      949    14311
      950    14312    4               CALL M$XMOUSE ALTRET(BAILOUT);

  14312 13 001536   540004 713400                    CLIMB   alt,+49156
        13 001537   000000 401760                    pmme    nvectors=0
        13 001540   000256 702000 13                 TSX2    BAILOUT
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:151  

      951    14313    4               CALL PSE$GRIPE (E$PS_MOUSE_STOP);

  14313 13 001541   000045 630400 14                 EPPR0   37
        13 001542   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 001543   000000 701000 xent               TSX1    PSE$GRIPE
        13 001544   000000 011000                    NOP     0

      952    14314
      953    14315    4            END;

      954    14316
      955    14317    3         END /* do I */;

  14317 13 001545   200005 235100                    LDA     I,,AUTO
        13 001546   000001 035007                    ADLA    1,DL
        13 001547   200005 755100                    STA     I,,AUTO
        13 001550   200004 470500                    LDP0    CMD$,,AUTO
        13 001551   000001 236100                    LDQ     1,,PR0
        13 001552   000022 772000                    QRL     18
        13 001553   200005 116100                    CMPQ    I,,AUTO
        13 001554   001556 600000 13                 TZE     s:14317+9
        13 001555   001524 603000 13                 TRC     s:14308
        13 001556   002741 710000 13                 TRA     s:14619

      956    14318        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:152  
      957    14319    2      CASE (13 /* summarize */);

      958    14320
      959    14321    2         PS_SUMMARY_ITEMS = OUT$BLK.NSUBLKS;

  14321 13 001557   000001 236100                    LDQ     1,,PR0
        13 001560   000022 772000                    QRL     18
        13 001561   000000 756000 xsym               STQ     PS_SUMMARY_ITEMS

      960    14322
      961    14323    2         IF PS_SUMMARY_ITEMS > SIZEW(PS_SUMMARY_LIST)

  14323 13 001562   000025 116007                    CMPQ    21,DL
        13 001563   001566 602000 13                 TNC     s:14326

      962    14324    2         THEN PS_SUMMARY_ITEMS = SIZEW(PS_SUMMARY_LIST);

  14324 13 001564   000024 235007                    LDA     20,DL
        13 001565   000000 755000 xsym               STA     PS_SUMMARY_ITEMS

      963    14325
      964    14326    3         DO I = 0 TO PS_SUMMARY_ITEMS - 1;

  14326 13 001566   200005 450100                    STZ     I,,AUTO
        13 001567   001601 710000 13                 TRA     s:14330+3

      965    14327
      966    14328    3            PS_SUMMARY_LIST(I) = OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE;

  14328 13 001570   200004 470500                    LDP0    CMD$,,AUTO
        13 001571   200005 720100                    LXL0    I,,AUTO
        13 001572   000003 471510                    LDP1    3,X0,PR0
        13 001573   100000 236100                    LDQ     0,,PR1
        13 001574   777777 376007                    ANQ     -1,DL
        13 001575   000000 756010 xsym               STQ     PS_SUMMARY_LIST,X0

      967    14329
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:153  
      968    14330    3         END;

  14330 13 001576   200005 235100                    LDA     I,,AUTO
        13 001577   000001 035007                    ADLA    1,DL
        13 001600   200005 755100                    STA     I,,AUTO
        13 001601   200005 236100                    LDQ     I,,AUTO
        13 001602   000000 116000 xsym               CMPQ    PS_SUMMARY_ITEMS
        13 001603   001570 602000 13                 TNC     s:14328

      969    14331
      970    14332    2         PS_DISPLAY_FLAGS = %NO#;

  14332 13 001604   000000 450000 xsym               STZ     PS_DISPLAY_FLAGS

      971    14333    2         PS_DISPLAY_FLAGS.SUMMARY = %YES#;

  14333 13 001605   004000 236003                    LDQ     2048,DU
        13 001606   000000 256000 xsym               ORSQ    PS_DISPLAY_FLAGS
        13 001607   002741 710000 13                 TRA     s:14619

      972    14334
      973    14335        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:154  
      974    14336    2      CASE (14 /* replay */);

      975    14337
      976    14338    2         PS_MODE = REPLAY_MODE#;

  14338 13 001610   000001 235007                    LDA     1,DL
        13 001611   000000 755000 xsym               STA     PS_MODE

      977    14339    2         PS_PUNT_COUNT = BITBIN('777777777777'O);

  14339 13 001612   000027 236000 xsym               LDQ     B_VECTNIL+23
        13 001613   000000 756000 xsym               STQ     PS_PUNT_COUNT

      978    14340
      979    14341    2         CALL PSD$DISP;

  14341 13 001614   000002 631400 xsym               EPPR1   B_VECTNIL+2
        13 001615   000000 701000 xent               TSX1    PSD$DISP
        13 001616   000000 011000                    NOP     0
        13 001617   002741 710000 13                 TRA     s:14619

      980    14342        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:155  
      981    14343    2      CASE (15 /* histogram */);

      982    14344
      983    14345    2         PS_HISTOGRAM_FLAGS = '0'B;

  14345 13 001620   000000 450000 xsym               STZ     PS_HISTOGRAM_FLAGS

      984    14346
      985    14347    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  14347 13 001621   200005 450100                    STZ     I,,AUTO
        13 001622   001700 710000 13                 TRA     s:14373+3

      986    14348
      987    14349    4            DO CASE (OUT$BLK.SUBLK$(I) -> OUT$BLK.CODE);

  14349 13 001623   200004 470500                    LDP0    CMD$,,AUTO
        13 001624   200005 720100                    LXL0    I,,AUTO
        13 001625   000003 471510                    LDP1    3,X0,PR0
        13 001626   100000 721100                    LXL1    0,,PR1
        13 001627   000005 101003                    CMPX1   5,DU
        13 001630   001632 602011 13                 TNC     s:14349+7,X1
        13 001631   001675 710000 13                 TRA     s:14373
        13 001632   001637 710000 13                 TRA     s:14353
        13 001633   001642 710000 13                 TRA     s:14357
        13 001634   001651 710000 13                 TRA     s:14361
        13 001635   001660 710000 13                 TRA     s:14365
        13 001636   001667 710000 13                 TRA     s:14369

      988    14350
      989    14351    4            CASE (0 /* all histograms */);

      990    14352
      991    14353    4               PS_HISTOGRAM_FLAGS = '777777777777'O;

  14353 13 001637   000027 236000 xsym               LDQ     B_VECTNIL+23
        13 001640   000000 756000 xsym               STQ     PS_HISTOGRAM_FLAGS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:156  
        13 001641   001675 710000 13                 TRA     s:14373

      992    14354
      993    14355    4            CASE (1 /* response histogram */);

      994    14356
      995    14357    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.RESPONSE);

  14357 13 001642   000046 236000 14                 LDQ     38
        13 001643   200276 756100                    STQ     @UTS+1,,AUTO
        13 001644   200005 631500                    EPPR1   I,,AUTO
        13 001645   200275 451500                    STP1    TEMP_END_UTS+3,,AUTO
        13 001646   003453 701000 13                 TSX1    SET_FLAGS
        13 001647   000000 011000                    NOP     0
        13 001650   001675 710000 13                 TRA     s:14373

      996    14358
      997    14359    4            CASE (2 /* user-size histogram */);

      998    14360
      999    14361    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.USER_SIZE);

  14361 13 001651   000047 236000 14                 LDQ     39
        13 001652   200276 756100                    STQ     @UTS+1,,AUTO
        13 001653   200005 631500                    EPPR1   I,,AUTO
        13 001654   200275 451500                    STP1    TEMP_END_UTS+3,,AUTO
        13 001655   003453 701000 13                 TSX1    SET_FLAGS
        13 001656   000000 011000                    NOP     0
        13 001657   001675 710000 13                 TRA     s:14373

     1000    14362
     1001    14363    4            CASE (3 /* PMME service time histogram */);

     1002    14364
     1003    14365    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.PMME_TIMES);

  14365 13 001660   000050 236000 14                 LDQ     40
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:157  
        13 001661   200276 756100                    STQ     @UTS+1,,AUTO
        13 001662   200005 631500                    EPPR1   I,,AUTO
        13 001663   200275 451500                    STP1    TEMP_END_UTS+3,,AUTO
        13 001664   003453 701000 13                 TSX1    SET_FLAGS
        13 001665   000000 011000                    NOP     0
        13 001666   001675 710000 13                 TRA     s:14373

     1004    14366
     1005    14367    4            CASE (4 /* Interaction compute time */);

     1006    14368
     1007    14369    4               CALL SET_FLAGS(I, PS_HISTOGRAM_FLAGS.INTERACTION_TIME);

  14369 13 001667   000051 236000 14                 LDQ     41
        13 001670   200276 756100                    STQ     @UTS+1,,AUTO
        13 001671   200005 631500                    EPPR1   I,,AUTO
        13 001672   200275 451500                    STP1    TEMP_END_UTS+3,,AUTO
        13 001673   003453 701000 13                 TSX1    SET_FLAGS
        13 001674   000000 011000                    NOP     0

     1008    14370
     1009    14371    4            END /* do case */;

     1010    14372
     1011    14373    3         END /* do I */;

  14373 13 001675   200005 235100                    LDA     I,,AUTO
        13 001676   000001 035007                    ADLA    1,DL
        13 001677   200005 755100                    STA     I,,AUTO
        13 001700   200004 470500                    LDP0    CMD$,,AUTO
        13 001701   000001 236100                    LDQ     1,,PR0
        13 001702   000022 772000                    QRL     18
        13 001703   200005 116100                    CMPQ    I,,AUTO
        13 001704   001706 600000 13                 TZE     s:14375
        13 001705   001623 603000 13                 TRC     s:14349

     1012    14374
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:158  
     1013    14375    2         PS_DISPLAY_FLAGS = %NO#;

  14375 13 001706   000000 450000 xsym               STZ     PS_DISPLAY_FLAGS

     1014    14376    2         PS_DISPLAY_FLAGS.HISTOGRAMS = %YES#;

  14376 13 001707   002000 236003                    LDQ     1024,DU
        13 001710   000000 256000 xsym               ORSQ    PS_DISPLAY_FLAGS
        13 001711   002741 710000 13                 TRA     s:14619

     1015    14377        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:159  
     1016    14378    2      CASE (16 /* time */);

     1017    14379
     1018    14380    2         IF OUT$BLK.NSUBLKS = 0

  14380 13 001712   000001 221100                    LDX1    1,,PR0
        13 001713   001720 601000 13                 TNZ     s:14389

     1019    14381    3         THEN DO;

     1020    14382
     1021    14383    3            PS_START_UTS = 0;

  14383 13 001714   000000 450000 xsym               STZ     PS_START_UTS

     1022    14384    3            PS_END_UTS = BITBIN('777777777777'O);

  14384 13 001715   000027 235000 xsym               LDA     B_VECTNIL+23
        13 001716   000000 755000 xsym               STA     PS_END_UTS

     1023    14385    3         END;

  14385 13 001717   002741 710000 13                 TRA     s:14619

     1024    14386
     1025    14387    3         ELSE DO;

     1026    14388
     1027    14389    3            P$ = OUT$BLK.SUBLK$(0);

  14389 13 001720   000003 236100                    LDQ     3,,PR0
        13 001721   200024 756100                    STQ     P$,,AUTO

     1028    14390
     1029    14391    3            TEMP_START_UTS = PS_START_UTS;

  14391 13 001722   000000 235000 xsym               LDA     PS_START_UTS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:160  
        13 001723   200271 755100                    STA     TEMP_START_UTS,,AUTO

     1030    14392    3            TEMP_END_UTS = PS_END_UTS;

  14392 13 001724   000000 235000 xsym               LDA     PS_END_UTS
        13 001725   200272 755100                    STA     TEMP_END_UTS,,AUTO

     1031    14393
     1032    14394    3            CALL M$TIME (GET_TODAYS_DATE);

  14394 13 001726   005002 630400 11                 EPPR0   GET_TODAYS_DATE
        13 001727   020004 713400                    CLIMB   8196
        13 001730   402000 401760                    pmme    nvectors=5

     1033    14395
     1034    14396    4            DO CASE (P$->OUT$BLK.CODE);

  14396 13 001731   200024 470500                    LDP0    P$,,AUTO
        13 001732   000000 720100                    LXL0    0,,PR0
        13 001733   000003 100003                    CMPX0   3,DU
        13 001734   001736 602010 13                 TNC     s:14396+5,X0
        13 001735   002004 710000 13                 TRA     s:14418
        13 001736   001741 710000 13                 TRA     s:14400
        13 001737   001763 710000 13                 TRA     s:14408
        13 001740   001774 710000 13                 TRA     s:14413

     1035    14397
     1036    14398    4            CASE (0 /* both begin and end limits specified */);

     1037    14399
     1038    14400    4               CALL SET_TIME (TEMP_START_UTS, P$->OUT$BLK.SUBLK$(0)->OUT$BLK,

  14400 13 001741   000003 471500                    LDP1    3,,PR0
        13 001742   000052 236000 14                 LDQ     42
        13 001743   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 001744   200276 451500                    STP1    @UTS+1,,AUTO
        13 001745   200271 633500                    EPPR3   TEMP_START_UTS,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:161  
        13 001746   200275 453500                    STP3    TEMP_END_UTS+3,,AUTO
        13 001747   004103 701000 13                 TSX1    SET_TIME
        13 001750   000000 011000                    NOP     0

     1039    14401    4                 DEFAULT_START_TIME);
     1040    14402
     1041    14403    4               CALL SET_TIME (TEMP_END_UTS, P$->OUT$BLK.SUBLK$(1)->OUT$BLK,

  14403 13 001751   200024 470500                    LDP0    P$,,AUTO
        13 001752   000004 471500                    LDP1    4,,PR0
        13 001753   000053 236000 14                 LDQ     43
        13 001754   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 001755   200276 451500                    STP1    @UTS+1,,AUTO
        13 001756   200272 633500                    EPPR3   TEMP_END_UTS,,AUTO
        13 001757   200275 453500                    STP3    TEMP_END_UTS+3,,AUTO
        13 001760   004103 701000 13                 TSX1    SET_TIME
        13 001761   000000 011000                    NOP     0
        13 001762   002004 710000 13                 TRA     s:14418

     1042    14404    4                 DEFAULT_END_TIME);
     1043    14405
     1044    14406    4            CASE (1 /* begin limit only specified */);

     1045    14407
     1046    14408    4               CALL SET_TIME (TEMP_START_UTS, P$->OUT$BLK.SUBLK$(0)->OUT$BLK,

  14408 13 001763   000003 471500                    LDP1    3,,PR0
        13 001764   000052 236000 14                 LDQ     42
        13 001765   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 001766   200276 451500                    STP1    @UTS+1,,AUTO
        13 001767   200271 633500                    EPPR3   TEMP_START_UTS,,AUTO
        13 001770   200275 453500                    STP3    TEMP_END_UTS+3,,AUTO
        13 001771   004103 701000 13                 TSX1    SET_TIME
        13 001772   000000 011000                    NOP     0
        13 001773   002004 710000 13                 TRA     s:14418

     1047    14409    4                 DEFAULT_START_TIME);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:162  
     1048    14410
     1049    14411    4            CASE (2 /* end limit only specified */);

     1050    14412
     1051    14413    4               CALL SET_TIME (TEMP_END_UTS, P$->OUT$BLK.SUBLK$(0)->OUT$BLK,

  14413 13 001774   000003 471500                    LDP1    3,,PR0
        13 001775   000053 236000 14                 LDQ     43
        13 001776   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 001777   200276 451500                    STP1    @UTS+1,,AUTO
        13 002000   200272 633500                    EPPR3   TEMP_END_UTS,,AUTO
        13 002001   200275 453500                    STP3    TEMP_END_UTS+3,,AUTO
        13 002002   004103 701000 13                 TSX1    SET_TIME
        13 002003   000000 011000                    NOP     0

     1052    14414    4                 DEFAULT_END_TIME);
     1053    14415
     1054    14416    4            END;

     1055    14417
     1056    14418    3            PS_START_UTS = TEMP_START_UTS;

  14418 13 002004   200271 235100                    LDA     TEMP_START_UTS,,AUTO
        13 002005   000000 755000 xsym               STA     PS_START_UTS

     1057    14419    3            PS_END_UTS = TEMP_END_UTS;

  14419 13 002006   200272 236100                    LDQ     TEMP_END_UTS,,AUTO
        13 002007   000000 756000 xsym               STQ     PS_END_UTS

     1058    14420
     1059    14421    3         END;

  14421 13 002010   002741 710000 13                 TRA     s:14619

     1060    14422
     1061    14423        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:163  
     1062    14424    2      CASE (17 /* select */);

     1063    14425
     1064    14426    2         PS_SELECT_RPN.INFO = '0'B;

  14426 13 002011   000000 236003                    LDQ     0,DU
        13 002012   000000 552034 7                  STBQ    PS_SELECT_RPN,'34'O

     1065    14427
     1066    14428    3         DO CASE (OUT$BLK.SUBLK$(0)->OUT$BLK.CODE);

  14428 13 002013   000003 471500                    LDP1    3,,PR0
        13 002014   100000 720100                    LXL0    0,,PR1
        13 002015   000002 100003                    CMPX0   2,DU
        13 002016   002020 602010 13                 TNC     s:14428+5,X0
        13 002017   002741 710000 13                 TRA     s:14619
        13 002020   002032 710000 13                 TRA     s:14439
        13 002021   002022 710000 13                 TRA     s:14436

     1067    14429
     1068    14430    3         CASE (0 /* select all */);

     1069    14431
     1070    14432    3   /* nothing to do in this case! */;
     1071    14433
     1072    14434    3         CASE (1 /* select ....... */);

     1073    14435
     1074    14436    3            CALL PSR$RPN (OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK,

  14436 13 002022   100003 473500                    LDP3    3,,PR1
        13 002023   000054 236000 14                 LDQ     44
        13 002024   200335 756100                    STQ     KEEP_SCANNING+3,,AUTO
        13 002025   200334 453500                    STP3    KEEP_SCANNING+2,,AUTO
        13 002026   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 002027   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002030   000000 701000 xent               TSX1    PSR$RPN
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:164  
        13 002031   000000 011000                    NOP     0

     1075    14437    3              PS_SELECT_RPN);
     1076    14438
     1077    14439    3         END;

  14439 13 002032   002741 710000 13                 TRA     s:14619

     1078    14440        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:165  
     1079    14441    2      CASE (18 /* statistics */, 19 /* analyze */);

     1080    14442
     1081    14443    2         IF OUT$BLK.NSUBLKS = 0

  14443 13 002033   000001 221100                    LDX1    1,,PR0
        13 002034   002040 601000 13                 TNZ     s:14447

     1082    14444    2         THEN
     1083    14445    2         PS_STATS_EXPRESSIONS = ITEMS#;

  14445 13 002035   000033 235007                    LDA     27,DL
        13 002036   000000 755000 xsym               STA     PS_STATS_EXPRESSIONS
        13 002037   002043 710000 13                 TRA     s:14449

     1084    14446    2         ELSE
     1085    14447    2         PS_STATS_EXPRESSIONS = OUT$BLK.NSUBLKS;

  14447 13 002040   000001 236100                    LDQ     1,,PR0
        13 002041   000022 772000                    QRL     18
        13 002042   000000 756000 xsym               STQ     PS_STATS_EXPRESSIONS

     1086    14448
     1087    14449    2         CALL PSM$ALLOC (PS_STATS_EXPRESSIONS, 0);

  14449 13 002043   000055 630400 14                 EPPR0   45
        13 002044   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002045   000000 701000 xent               TSX1    PSM$ALLOC
        13 002046   000000 011000                    NOP     0

     1088    14450
     1089    14451    3         DO I = 0 TO PS_STATS_EXPRESSIONS - 1;

  14451 13 002047   200005 450100                    STZ     I,,AUTO
        13 002050   002064 710000 13                 TRA     s:14455+3

     1090    14452
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:166  
     1091    14453    3            CALL SETUP_STATS_ENTRY (OUT$BLK, I,

  14453 13 002051   000060 236000 14                 LDQ     48
        13 002052   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 002053   200005 630500                    EPPR0   I,,AUTO
        13 002054   200276 450500                    STP0    @UTS+1,,AUTO
        13 002055   200004 236100                    LDQ     CMD$,,AUTO
        13 002056   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 002057   003530 701000 13                 TSX1    SETUP_STATS_ENTRY
        13 002060   000000 011000                    NOP     0

     1092    14454    3              MAX_PLOT_VALUES#);
     1093    14455    3         END;

  14455 13 002061   200005 235100                    LDA     I,,AUTO
        13 002062   000001 035007                    ADLA    1,DL
        13 002063   200005 755100                    STA     I,,AUTO
        13 002064   200005 236100                    LDQ     I,,AUTO
        13 002065   000000 116000 xsym               CMPQ    PS_STATS_EXPRESSIONS
        13 002066   002051 602000 13                 TNC     s:14453

     1094    14456
     1095    14457    2         IF OUT$BLK.CODE = 18 /* statistics */

  14457 13 002067   200004 470500                    LDP0    CMD$,,AUTO
        13 002070   000000 720100                    LXL0    0,,PR0
        13 002071   000022 100003                    CMPX0   18,DU
        13 002072   002076 601000 13                 TNZ     s:14461

     1096    14458    2         THEN
     1097    14459    2         PS_MODE = STATISTICS_MODE#;

  14459 13 002073   000003 235007                    LDA     3,DL
        13 002074   000000 755000 xsym               STA     PS_MODE
        13 002075   002100 710000 13                 TRA     s:14463

     1098    14460    2         ELSE
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:167  
     1099    14461    2         PS_MODE = ANALYZE_MODE#;

  14461 13 002076   000004 235007                    LDA     4,DL
        13 002077   000000 755000 xsym               STA     PS_MODE

     1100    14462
     1101    14463    2         PS_PUNT_COUNT = 99999999;

  14463 13 002100   000044 235000 14                 LDA     36
        13 002101   000000 755000 xsym               STA     PS_PUNT_COUNT

     1102    14464
     1103    14465    2         CALL PSD$DISP;

  14465 13 002102   000002 631400 xsym               EPPR1   B_VECTNIL+2
        13 002103   000000 701000 xent               TSX1    PSD$DISP
        13 002104   000000 011000                    NOP     0
        13 002105   002741 710000 13                 TRA     s:14619

     1104    14466        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:168  
     1105    14467    2      CASE (20 /* plot */);

     1106    14468
     1107    14469    2         PS_STATS_EXPRESSIONS = OUT$BLK.NSUBLKS;

  14469 13 002106   000001 236100                    LDQ     1,,PR0
        13 002107   000022 772000                    QRL     18
        13 002110   000000 756000 xsym               STQ     PS_STATS_EXPRESSIONS

     1108    14470    2         PS_GRAPHS = PS_STATS_EXPRESSIONS / 2;

  14470 13 002111   000001 772000                    QRL     1
        13 002112   000000 756000 xsym               STQ     PS_GRAPHS

     1109    14471
     1110    14472    2         CALL PSM$ALLOC (PS_STATS_EXPRESSIONS, PS_GRAPHS);

  14472 13 002113   000061 630400 14                 EPPR0   49
        13 002114   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002115   000000 701000 xent               TSX1    PSM$ALLOC
        13 002116   000000 011000                    NOP     0

     1111    14473
     1112    14474    3         DO I = 0 TO PS_GRAPHS - 1;

  14474 13 002117   200005 450100                    STZ     I,,AUTO
        13 002120   002155 710000 13                 TRA     s:14484+3

     1113    14475
     1114    14476    3            CALL SETUP_STATS_ENTRY (OUT$BLK, I*2,

  14476 13 002121   200005 235100                    LDA     I,,AUTO
        13 002122   000001 735000                    ALS     1
        13 002123   200356 755100                    STA     KEEP_SCANNING+20,,AUTO
        13 002124   000064 236000 14                 LDQ     52
        13 002125   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 002126   200356 630500                    EPPR0   KEEP_SCANNING+20,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:169  
        13 002127   200276 450500                    STP0    @UTS+1,,AUTO
        13 002130   200004 236100                    LDQ     CMD$,,AUTO
        13 002131   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 002132   003530 701000 13                 TSX1    SETUP_STATS_ENTRY
        13 002133   000000 011000                    NOP     0

     1115    14477    3              Y_AXIS_POINTS#);
     1116    14478
     1117    14479    3            CALL SETUP_STATS_ENTRY (OUT$BLK, I*2+1,

  14479 13 002134   200005 235100                    LDA     I,,AUTO
        13 002135   000001 735000                    ALS     1
        13 002136   000001 035007                    ADLA    1,DL
        13 002137   200357 755100                    STA     KEEP_SCANNING+21,,AUTO
        13 002140   000060 236000 14                 LDQ     48
        13 002141   200277 756100                    STQ     @CHAR_AREA+1,,AUTO
        13 002142   200357 630500                    EPPR0   KEEP_SCANNING+21,,AUTO
        13 002143   200276 450500                    STP0    @UTS+1,,AUTO
        13 002144   200004 236100                    LDQ     CMD$,,AUTO
        13 002145   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 002146   003530 701000 13                 TSX1    SETUP_STATS_ENTRY
        13 002147   000000 011000                    NOP     0

     1118    14480    3              X_AXIS_POINTS#);
     1119    14481
     1120    14482    3            PS_GRAPH_PEAK(I) = 0;

  14482 13 002150   200005 720100                    LXL0    I,,AUTO
        13 002151   000000 450010 xsym               STZ     PS_GRAPH_PEAK,X0

     1121    14483
     1122    14484    3         END;

  14484 13 002152   200005 235100                    LDA     I,,AUTO
        13 002153   000001 035007                    ADLA    1,DL
        13 002154   200005 755100                    STA     I,,AUTO
        13 002155   200005 236100                    LDQ     I,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:170  
        13 002156   000000 116000 xsym               CMPQ    PS_GRAPHS
        13 002157   002121 602000 13                 TNC     s:14476

     1123    14485
     1124    14486    2         PS_MODE = PLOT_MODE#;

  14486 13 002160   000006 235007                    LDA     6,DL
        13 002161   000000 755000 xsym               STA     PS_MODE

     1125    14487    2         PS_PUNT_COUNT = 99999999;

  14487 13 002162   000044 235000 14                 LDA     36
        13 002163   000000 755000 xsym               STA     PS_PUNT_COUNT

     1126    14488
     1127    14489    2         CALL PSD$DISP;

  14489 13 002164   000002 631400 xsym               EPPR1   B_VECTNIL+2
        13 002165   000000 701000 xent               TSX1    PSD$DISP
        13 002166   000000 011000                    NOP     0
        13 002167   002741 710000 13                 TRA     s:14619

     1128    14490        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:171  
     1129    14491    2      CASE (21 /* glom */);

     1130    14492
     1131    14493    2         PS_MODE = GLOM_MODE#;

  14493 13 002170   000002 235007                    LDA     2,DL
        13 002171   000000 755000 xsym               STA     PS_MODE

     1132    14494
     1133    14495    2         PS_PUNT_COUNT = 1;

  14495 13 002172   000001 236007                    LDQ     1,DL
        13 002173   000000 756000 xsym               STQ     PS_PUNT_COUNT

     1134    14496
     1135    14497    2         CALL PSD$DISP;

  14497 13 002174   000002 631400 xsym               EPPR1   B_VECTNIL+2
        13 002175   000000 701000 xent               TSX1    PSD$DISP
        13 002176   000000 011000                    NOP     0
        13 002177   002741 710000 13                 TRA     s:14619

     1136    14498        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:172  
     1137    14499    2      CASE (22 /* message */);

     1138    14500
     1139    14501        /*   For message command, find message text in parse
     1140    14502             output blocks and pass it to M$KEYIN.                         */
     1141    14503    2         FPT_KEYIN.MESS_ = VECTOR(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  14503 13 002200   000003 471500                    LDP1    3,,PR0
        13 002201   100004 236100                    LDQ     4,,PR1
        13 002202   000033 772000                    QRL     27
        13 002203   000064 737000                    LLS     52
        13 002204   000140 135007                    SBLA    96,DL
        13 002205   200334 451500                    STP1    KEEP_SCANNING+2,,AUTO
        13 002206   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002207   000041 036000 14                 ADLQ    33
        13 002210   005074 757000 11                 STAQ    FPT_KEYIN+2

     1142    14504
     1143    14505    2         CALL M$KEYIN (FPT_KEYIN);

  14505 13 002211   005072 630400 11                 EPPR0   FPT_KEYIN
        13 002212   120000 713400                    CLIMB   40960
        13 002213   401400 401760                    pmme    nvectors=4
        13 002214   002741 710000 13                 TRA     s:14619

     1144    14506        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:173  
     1145    14507    2      CASE (23 /* bargraph */);

     1146    14508
     1147    14509    2         PS_STATS_EXPRESSIONS = 1;

  14509 13 002215   000001 235007                    LDA     1,DL
        13 002216   000000 755000 xsym               STA     PS_STATS_EXPRESSIONS

     1148    14510
     1149    14511    2         CALL PSM$ALLOC (1, 0);

  14511 13 002217   000065 630400 14                 EPPR0   53
        13 002220   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002221   000000 701000 xent               TSX1    PSM$ALLOC
        13 002222   000000 011000                    NOP     0

     1150    14512
     1151    14513    2         CALL SETUP_STATS_ENTRY (OUT$BLK, 0, X_AXIS_POINTS#);

  14513 13 002223   000070 237000 14                 LDAQ    56
        13 002224   200276 757100                    STAQ    @UTS+1,,AUTO
        13 002225   200004 236100                    LDQ     CMD$,,AUTO
        13 002226   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 002227   003530 701000 13                 TSX1    SETUP_STATS_ENTRY
        13 002230   000000 011000                    NOP     0

     1152    14514
     1153    14515    2         PS_MODE = BARGRAPH_MODE#;

  14515 13 002231   000005 235007                    LDA     5,DL
        13 002232   000000 755000 xsym               STA     PS_MODE

     1154    14516
     1155    14517    2         PS_PUNT_COUNT = BITBIN('777777777777'O);

  14517 13 002233   000027 236000 xsym               LDQ     B_VECTNIL+23
        13 002234   000000 756000 xsym               STQ     PS_PUNT_COUNT
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:174  

     1156    14518
     1157    14519    2         CALL PSD$DISP;

  14519 13 002235   000002 631400 xsym               EPPR1   B_VECTNIL+2
        13 002236   000000 701000 xent               TSX1    PSD$DISP
        13 002237   000000 011000                    NOP     0
        13 002240   002741 710000 13                 TRA     s:14619

     1158    14520        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:175  
     1159    14521    2      CASE (25 /* status */);

     1160    14522
     1161    14523    2         CALL M$UNFID (FPT_UNFID) ALTRET (UNFID_BURPED);

  14523 13 002241   004754 630400 11                 EPPR0   FPT_UNFID
        13 002242   420021 713400                    CLIMB   alt,+8209
        13 002243   404400 401760                    pmme    nvectors=10
        13 002244   002246 702000 13                 TSX2    UNFID_BURPED

     1162    14524
     1163    14525    3         DO NEVER;

  14525 13 002245   002255 710000 13                 TRA     s:14533

     1164    14526
     1165    14527    3   UNFID_BURPED:
     1166    14528
     1167    14529    3            CALL PSE$ERRMSG ( , SERIOUS#);

  14529 13 002246   000002 236000 14    UNFID_BURPED LDQ     2
        13 002247   000001 235000 xsym               LDA     B_VECTNIL+1
        13 002250   200334 757100                    STAQ    KEEP_SCANNING+2,,AUTO
        13 002251   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 002252   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002253   000000 701000 xent               TSX1    PSE$ERRMSG
        13 002254   000000 011000                    NOP     0

     1168    14530
     1169    14531    3         END;

     1170    14532
     1171    14533    2         IF PS_SELECT_RPN.INFO.USED# = 0

  14533 13 002255   000000 236000 7                  LDQ     PS_SELECT_RPN
        13 002256   000777 316003                    CANQ    511,DU
        13 002257   002264 601000 13                 TNZ     s:14537
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:176  

     1172    14534    2         THEN
     1173    14535    2         STATUS_SELECT = 'all';

  14535 13 002260   040100 100400                    MLR     fill='040'O
        13 002261   000427 000003 12                 ADSC9   DEFAULT_END_TIME+3       cn=0,n=3
        13 002262   200133 000170                    ADSC9   STATUS_SELECT,,AUTO      cn=0,n=120
        13 002263   002300 710000 13                 TRA     s:14540

     1174    14536    2         ELSE
     1175    14537    2         CALL PSR$UN_RPN(PS_SELECT_RPN, STATUS_SELECT, I,

  14537 13 002264   000073 236000 14                 LDQ     59
        13 002265   200337 756100                    STQ     KEEP_SCANNING+5,,AUTO
        13 002266   200005 630500                    EPPR0   I,,AUTO
        13 002267   200336 450500                    STP0    KEEP_SCANNING+4,,AUTO
        13 002270   200133 631500                    EPPR1   STATUS_SELECT,,AUTO
        13 002271   200335 451500                    STP1    KEEP_SCANNING+3,,AUTO
        13 002272   000054 236000 14                 LDQ     44
        13 002273   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 002274   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 002275   000022 631400 xsym               EPPR1   B_VECTNIL+18
        13 002276   000000 701000 xent               TSX1    PSR$UN_RPN
        13 002277   000000 011000                    NOP     0

     1176    14538    2           LENGTHC(STATUS_SELECT));
     1177    14539
     1178    14540    2         IF PS_START_UTS = 0

  14540 13 002300   000000 235000 xsym               LDA     PS_START_UTS
        13 002301   002325 601000 13                 TNZ     s:14557

     1179    14541    3         THEN DO;

     1180    14542
     1181    14543    3            IF PS_END_UTS = BITBIN('777777777777'O)

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:177  
  14543 13 002302   000000 236000 xsym               LDQ     PS_END_UTS
        13 002303   000027 116000 xsym               CMPQ    B_VECTNIL+23
        13 002304   002311 601000 13                 TNZ     s:14549

     1182    14544    3            THEN
     1183    14545    3            STATUS_TIME = 'all';

  14545 13 002305   040100 100400                    MLR     fill='040'O
        13 002306   000427 000003 12                 ADSC9   DEFAULT_END_TIME+3       cn=0,n=3
        13 002307   200121 000050                    ADSC9   STATUS_TIME,,AUTO        cn=0,n=40
        13 002310   002351 710000 13                 TRA     s:14566

     1184    14546
     1185    14547    4            ELSE DO;

     1186    14548
     1187    14549    4               STATUS_TIME = '- ';

  14549 13 002311   040100 100400                    MLR     fill='040'O
        13 002312   000430 000002 12                 ADSC9   DEFAULT_END_TIME+4       cn=0,n=2
        13 002313   200121 000050                    ADSC9   STATUS_TIME,,AUTO        cn=0,n=40

     1188    14550    4               CALL CONVERT_UTS (PS_END_UTS, SUBSTR(STATUS_TIME, 2));

  14550 13 002314   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002315   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002316   000074 036000 14                 ADLQ    60
        13 002317   200276 756100                    STQ     @UTS+1,,AUTO
        13 002320   000075 236000 14                 LDQ     61
        13 002321   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 002322   005044 701000 13                 TSX1    CONVERT_UTS
        13 002323   000000 011000                    NOP     0

     1189    14551    4            END;

     1190    14552
     1191    14553    3         END;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:178  

  14553 13 002324   002351 710000 13                 TRA     s:14566

     1192    14554
     1193    14555    3         ELSE DO;

     1194    14556
     1195    14557    3            STATUS_TIME = 'mm/dd/yy,hh:mm -';

  14557 13 002325   040100 100400                    MLR     fill='040'O
        13 002326   000431 000020 12                 ADSC9   DEFAULT_END_TIME+5       cn=0,n=16
        13 002327   200121 000050                    ADSC9   STATUS_TIME,,AUTO        cn=0,n=40

     1196    14558    3            CALL CONVERT_UTS (PS_START_UTS, STATUS_TIME);

  14558 13 002330   200121 630500                    EPPR0   STATUS_TIME,,AUTO
        13 002331   200276 450500                    STP0    @UTS+1,,AUTO
        13 002332   000076 236000 14                 LDQ     62
        13 002333   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 002334   005044 701000 13                 TSX1    CONVERT_UTS
        13 002335   000000 011000                    NOP     0

     1197    14559
     1198    14560    3            IF PS_END_UTS ~= BITBIN('777777777777'O)

  14560 13 002336   000000 236000 xsym               LDQ     PS_END_UTS
        13 002337   000027 116000 xsym               CMPQ    B_VECTNIL+23
        13 002340   002351 600000 13                 TZE     s:14566

     1199    14561    3            THEN
     1200    14562    3            CALL CONVERT_UTS (PS_END_UTS, SUBSTR(STATUS_TIME, 17));

  14562 13 002341   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002342   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002343   000077 036000 14                 ADLQ    63
        13 002344   200276 756100                    STQ     @UTS+1,,AUTO
        13 002345   000075 236000 14                 LDQ     61
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:179  
        13 002346   200275 756100                    STQ     TEMP_END_UTS+3,,AUTO
        13 002347   005044 701000 13                 TSX1    CONVERT_UTS
        13 002350   000000 011000                    NOP     0

     1201    14563
     1202    14564    3         END;

     1203    14565
     1204    14566    2         CALL SETUP_TOKENS (STATUS_MISC, PS_DISPLAY_FLAGS);

  14566 13 002351   000033 236000 14                 LDQ     27
        13 002352   200276 756100                    STQ     @UTS+1,,AUTO
        13 002353   200025 630500                    EPPR0   STATUS_MISC,,AUTO
        13 002354   200275 450500                    STP0    TEMP_END_UTS+3,,AUTO
        13 002355   004374 701000 13                 TSX1    SETUP_TOKENS
        13 002356   000000 011000                    NOP     0

     1205    14567    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_DI_FMT), VECTOR(STATUS_MISC));

  14567 13 002357   000102 235000 14                 LDA     66
        13 002360   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002361   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002362   000025 036003                    ADLQ    21,DU
        13 002363   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002364   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 002365   200342 450500                    STP0    KEEP_SCANNING+8,,AUTO
        13 002366   000104 237000 14                 LDAQ    68
        13 002367   200340 757100                    STAQ    KEEP_SCANNING+6,,AUTO
        13 002370   200340 630500                    EPPR0   KEEP_SCANNING+6,,AUTO
        13 002371   000021 631400 xsym               EPPR1   B_VECTNIL+17
        13 002372   000000 701000 xent               TSX1    X$WRITE
        13 002373   000000 011000                    NOP     0

     1206    14568    2         CALL SETUP_FEP(STATUS_MISC, PS_FEP_DISP_FLAGS(0));

  14568 13 002374   000034 236000 14                 LDQ     28
        13 002375   200276 756100                    STQ     @UTS+1,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:180  
        13 002376   200025 630500                    EPPR0   STATUS_MISC,,AUTO
        13 002377   200275 450500                    STP0    TEMP_END_UTS+3,,AUTO
        13 002400   004624 701000 13                 TSX1    SETUP_FEP
        13 002401   000000 011000                    NOP     0

     1207    14569    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPS_FMT), VECTOR(STATUS_MISC));

  14569 13 002402   000102 235000 14                 LDA     66
        13 002403   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002404   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002405   000025 036003                    ADLQ    21,DU
        13 002406   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002407   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 002410   200342 450500                    STP0    KEEP_SCANNING+8,,AUTO
        13 002411   000110 237000 14                 LDAQ    72
        13 002412   200340 757100                    STAQ    KEEP_SCANNING+6,,AUTO
        13 002413   200340 630500                    EPPR0   KEEP_SCANNING+6,,AUTO
        13 002414   000021 631400 xsym               EPPR1   B_VECTNIL+17
        13 002415   000000 701000 xent               TSX1    X$WRITE
        13 002416   000000 011000                    NOP     0

     1208    14570    3         DO FEP_IX = 1 TO %PS_MAXFE#;

  14570 13 002417   000001 235007                    LDA     1,DL
        13 002420   200017 755100                    STA     FEP_IX,,AUTO

     1209    14571    4            IF PS_FEP_DISP_FLAGS(FEP_IX) ~= PS_FEP_DISP_FLAGS(0) THEN DO;

  14571 13 002421   200017 235100                    LDA     FEP_IX,,AUTO
        13 002422   000004 735000                    ALS     4
        13 002423   000000 106405                    CMPC    fill='000'O
        13 002424   000000 000020 xsym               ADSC9   PS_FEP_DISP_FLAGS,A      cn=0,n=16
        13 002425   000000 000020 xsym               ADSC9   PS_FEP_DISP_FLAGS        cn=0,n=16
        13 002426   002467 600000 13                 TZE     s:14576

     1210    14572    4               CALL SETUP_FEP(STATUS_MISC, PS_FEP_DISP_FLAGS(FEP_IX));

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:181  
  14572 13 002427   200017 236100                    LDQ     FEP_IX,,AUTO
        13 002430   000024 736000                    QLS     20
        13 002431   000034 036000 14                 ADLQ    28
        13 002432   200276 756100                    STQ     @UTS+1,,AUTO
        13 002433   200025 630500                    EPPR0   STATUS_MISC,,AUTO
        13 002434   200275 450500                    STP0    TEMP_END_UTS+3,,AUTO
        13 002435   004624 701000 13                 TSX1    SETUP_FEP
        13 002436   000000 011000                    NOP     0

     1211    14573    4               CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPN_FMT),

  14573 13 002437   777640 235007                    LDA     -96,DL
        13 002440   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002441   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002442   000017 036003                    ADLQ    15,DU
        13 002443   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002444   000102 235000 14                 LDA     66
        13 002445   200340 452500                    STP2    KEEP_SCANNING+6,,AUTO
        13 002446   200340 236100                    LDQ     KEEP_SCANNING+6,,AUTO
        13 002447   000025 036003                    ADLQ    21,DU
        13 002450   200344 757100                    STAQ    KEEP_SCANNING+10,,AUTO
        13 002451   200336 237100                    LDAQ    KEEP_SCANNING+4,,AUTO
        13 002452   200342 757100                    STAQ    KEEP_SCANNING+8,,AUTO
        13 002453   200344 237100                    LDAQ    KEEP_SCANNING+10,,AUTO
        13 002454   200346 757100                    STAQ    KEEP_SCANNING+12,,AUTO
        13 002455   200346 630500                    EPPR0   KEEP_SCANNING+12,,AUTO
        13 002456   200353 450500                    STP0    KEEP_SCANNING+17,,AUTO
        13 002457   200342 631500                    EPPR1   KEEP_SCANNING+8,,AUTO
        13 002460   200352 451500                    STP1    KEEP_SCANNING+16,,AUTO
        13 002461   000114 237000 14                 LDAQ    76
        13 002462   200350 757100                    STAQ    KEEP_SCANNING+14,,AUTO
        13 002463   200350 630500                    EPPR0   KEEP_SCANNING+14,,AUTO
        13 002464   000022 631400 xsym               EPPR1   B_VECTNIL+18
        13 002465   000000 701000 xent               TSX1    X$WRITE
        13 002466   000000 011000                    NOP     0

     1212    14574    4                 VECTOR(FEP_IX), VECTOR(STATUS_MISC));
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:182  
     1213    14575    4            END;

     1214    14576    3         END;

  14576 13 002467   200017 235100                    LDA     FEP_IX,,AUTO
        13 002470   000001 035007                    ADLA    1,DL
        13 002471   200017 755100                    STA     FEP_IX,,AUTO
        13 002472   000144 115007                    CMPA    100,DL
        13 002473   002421 602000 13                 TNC     s:14571

     1215    14577
     1216    14578    2         CALL SETUP_TOKENS (STATUS_MISC, PS_LOG_FLAGS);

  14578 13 002474   000035 236000 14                 LDQ     29
        13 002475   200276 756100                    STQ     @UTS+1,,AUTO
        13 002476   200025 630500                    EPPR0   STATUS_MISC,,AUTO
        13 002477   200275 450500                    STP0    TEMP_END_UTS+3,,AUTO
        13 002500   004374 701000 13                 TSX1    SETUP_TOKENS
        13 002501   000000 011000                    NOP     0

     1217    14579    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_LOG_FMT), VECTOR(STATUS_MISC));

  14579 13 002502   000102 235000 14                 LDA     66
        13 002503   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002504   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002505   000025 036003                    ADLQ    21,DU
        13 002506   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002507   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 002510   200342 450500                    STP0    KEEP_SCANNING+8,,AUTO
        13 002511   000120 237000 14                 LDAQ    80
        13 002512   200340 757100                    STAQ    KEEP_SCANNING+6,,AUTO
        13 002513   200340 630500                    EPPR0   KEEP_SCANNING+6,,AUTO
        13 002514   000021 631400 xsym               EPPR1   B_VECTNIL+17
        13 002515   000000 701000 xent               TSX1    X$WRITE
        13 002516   000000 011000                    NOP     0

     1218    14580    2         CALL SETUP_FEP(STATUS_MISC, PS_FEP_LOG_FLAGS(0));
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:183  

  14580 13 002517   000036 236000 14                 LDQ     30
        13 002520   200276 756100                    STQ     @UTS+1,,AUTO
        13 002521   200025 630500                    EPPR0   STATUS_MISC,,AUTO
        13 002522   200275 450500                    STP0    TEMP_END_UTS+3,,AUTO
        13 002523   004624 701000 13                 TSX1    SETUP_FEP
        13 002524   000000 011000                    NOP     0

     1219    14581    2         CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPS_FMT), VECTOR(STATUS_MISC));

  14581 13 002525   000102 235000 14                 LDA     66
        13 002526   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002527   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002530   000025 036003                    ADLQ    21,DU
        13 002531   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002532   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 002533   200342 450500                    STP0    KEEP_SCANNING+8,,AUTO
        13 002534   000110 237000 14                 LDAQ    72
        13 002535   200340 757100                    STAQ    KEEP_SCANNING+6,,AUTO
        13 002536   200340 630500                    EPPR0   KEEP_SCANNING+6,,AUTO
        13 002537   000021 631400 xsym               EPPR1   B_VECTNIL+17
        13 002540   000000 701000 xent               TSX1    X$WRITE
        13 002541   000000 011000                    NOP     0

     1220    14582    3         DO FEP_IX = 1 TO %PS_MAXFE#;

  14582 13 002542   000001 235007                    LDA     1,DL
        13 002543   200017 755100                    STA     FEP_IX,,AUTO

     1221    14583    4            IF PS_FEP_LOG_FLAGS(FEP_IX) ~= PS_FEP_LOG_FLAGS(0) THEN DO;

  14583 13 002544   200017 235100                    LDA     FEP_IX,,AUTO
        13 002545   000004 735000                    ALS     4
        13 002546   000000 106405                    CMPC    fill='000'O
        13 002547   000000 000020 xsym               ADSC9   PS_FEP_LOG_FLAGS,A       cn=0,n=16
        13 002550   000000 000020 xsym               ADSC9   PS_FEP_LOG_FLAGS         cn=0,n=16
        13 002551   002612 600000 13                 TZE     s:14588
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:184  

     1222    14584    4               CALL SETUP_FEP(STATUS_MISC, PS_FEP_LOG_FLAGS(FEP_IX));

  14584 13 002552   200017 236100                    LDQ     FEP_IX,,AUTO
        13 002553   000024 736000                    QLS     20
        13 002554   000036 036000 14                 ADLQ    30
        13 002555   200276 756100                    STQ     @UTS+1,,AUTO
        13 002556   200025 630500                    EPPR0   STATUS_MISC,,AUTO
        13 002557   200275 450500                    STP0    TEMP_END_UTS+3,,AUTO
        13 002560   004624 701000 13                 TSX1    SETUP_FEP
        13 002561   000000 011000                    NOP     0

     1223    14585    4               CALL X$WRITE(PS_FDS, VECTOR(STATUS_FEPN_FMT),

  14585 13 002562   777640 235007                    LDA     -96,DL
        13 002563   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002564   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002565   000017 036003                    ADLQ    15,DU
        13 002566   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002567   000102 235000 14                 LDA     66
        13 002570   200340 452500                    STP2    KEEP_SCANNING+6,,AUTO
        13 002571   200340 236100                    LDQ     KEEP_SCANNING+6,,AUTO
        13 002572   000025 036003                    ADLQ    21,DU
        13 002573   200344 757100                    STAQ    KEEP_SCANNING+10,,AUTO
        13 002574   200336 237100                    LDAQ    KEEP_SCANNING+4,,AUTO
        13 002575   200342 757100                    STAQ    KEEP_SCANNING+8,,AUTO
        13 002576   200344 237100                    LDAQ    KEEP_SCANNING+10,,AUTO
        13 002577   200346 757100                    STAQ    KEEP_SCANNING+12,,AUTO
        13 002600   200346 630500                    EPPR0   KEEP_SCANNING+12,,AUTO
        13 002601   200353 450500                    STP0    KEEP_SCANNING+17,,AUTO
        13 002602   200342 631500                    EPPR1   KEEP_SCANNING+8,,AUTO
        13 002603   200352 451500                    STP1    KEEP_SCANNING+16,,AUTO
        13 002604   000114 237000 14                 LDAQ    76
        13 002605   200350 757100                    STAQ    KEEP_SCANNING+14,,AUTO
        13 002606   200350 630500                    EPPR0   KEEP_SCANNING+14,,AUTO
        13 002607   000022 631400 xsym               EPPR1   B_VECTNIL+18
        13 002610   000000 701000 xent               TSX1    X$WRITE
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:185  
        13 002611   000000 011000                    NOP     0

     1224    14586    4                 VECTOR(FEP_IX), VECTOR(STATUS_MISC));
     1225    14587    4            END;

     1226    14588    3         END;

  14588 13 002612   200017 235100                    LDA     FEP_IX,,AUTO
        13 002613   000001 035007                    ADLA    1,DL
        13 002614   200017 755100                    STA     FEP_IX,,AUTO
        13 002615   000144 115007                    CMPA    100,DL
        13 002616   002544 602000 13                 TNC     s:14583

     1227    14589
     1228    14590    2         CALL X$WRITE (PS_FDS, VECTOR(STATUS_FORMAT),

  14590 13 002617   000126 235000 14                 LDA     86
        13 002620   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002621   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002622   000121 036003                    ADLQ    81,DU
        13 002623   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002624   000102 235000 14                 LDA     66
        13 002625   200340 452500                    STP2    KEEP_SCANNING+6,,AUTO
        13 002626   200340 236100                    LDQ     KEEP_SCANNING+6,,AUTO
        13 002627   000133 036003                    ADLQ    91,DU
        13 002630   200344 757100                    STAQ    KEEP_SCANNING+10,,AUTO
        13 002631   200336 237100                    LDAQ    KEEP_SCANNING+4,,AUTO
        13 002632   200342 757100                    STAQ    KEEP_SCANNING+8,,AUTO
        13 002633   200344 237100                    LDAQ    KEEP_SCANNING+10,,AUTO
        13 002634   200346 757100                    STAQ    KEEP_SCANNING+12,,AUTO
        13 002635   200346 630500                    EPPR0   KEEP_SCANNING+12,,AUTO
        13 002636   200355 450500                    STP0    KEEP_SCANNING+19,,AUTO
        13 002637   200342 631500                    EPPR1   KEEP_SCANNING+8,,AUTO
        13 002640   200354 451500                    STP1    KEEP_SCANNING+18,,AUTO
        13 002641   000130 237000 14                 LDAQ    88
        13 002642   200352 757100                    STAQ    KEEP_SCANNING+16,,AUTO
        13 002643   000132 237000 14                 LDAQ    90
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:186  
        13 002644   200350 757100                    STAQ    KEEP_SCANNING+14,,AUTO
        13 002645   200350 630500                    EPPR0   KEEP_SCANNING+14,,AUTO
        13 002646   000024 631400 xsym               EPPR1   B_VECTNIL+20
        13 002647   000000 701000 xent               TSX1    X$WRITE
        13 002650   000000 011000                    NOP     0
        13 002651   002741 710000 13                 TRA     s:14619

     1229    14591    2           VECTOR(PS_INTERVAL),
     1230    14592    2           VECTOR(STATUS_FID),
     1231    14593    2           VECTOR(STATUS_TIME),
     1232    14594    2           VECTOR(STATUS_SELECT));
     1233    14595
     1234    14596        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:187  
     1235    14597    2      CASE (26 /* understood command, didn't grok options */);

     1236    14598
     1237    14599    2         CALL XUR$ECHOIF (DCBNUM(M$ME));

  14599 13 002652   000000 236007 xsym               LDQ     M$ME,DL
        13 002653   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 002654   200334 631500                    EPPR1   KEEP_SCANNING+2,,AUTO
        13 002655   200335 451500                    STP1    KEEP_SCANNING+3,,AUTO
        13 002656   200335 630500                    EPPR0   KEEP_SCANNING+3,,AUTO
        13 002657   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 002660   000000 701000 xent               TSX1    XUR$ECHOIF
        13 002661   000000 011000                    NOP     0

     1238    14600
     1239    14601    2         CALL XUR$ERRPTR ( , DCBNUM(M$ME));

  14601 13 002662   000000 236007 xsym               LDQ     M$ME,DL
        13 002663   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 002664   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 002665   200337 450500                    STP0    KEEP_SCANNING+5,,AUTO
        13 002666   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 002667   200336 756100                    STQ     KEEP_SCANNING+4,,AUTO
        13 002670   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 002671   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002672   000000 701000 xent               TSX1    XUR$ERRPTR
        13 002673   000000 011000                    NOP     0

     1240    14602
     1241    14603    2         CALL M$CORRES (COMPARE_M$ME_AND_M$LO) ALTRET (REPORT_PARTIAL_ERROR);

  14603 13 002674   004702 630400 11                 EPPR0   COMPARE_M$ME_AND_M$LO
        13 002675   460000 713400                    CLIMB   alt,+24576
        13 002676   400000 401760                    pmme    nvectors=1
        13 002677   002722 702000 13                 TSX2    REPORT_PARTIAL_ERROR

     1242    14604
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:188  
     1243    14605    2         CALL XUR$ECHOIF (DCBNUM(M$LO));

  14605 13 002700   000000 236007 xsym               LDQ     M$LO,DL
        13 002701   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 002702   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 002703   200335 450500                    STP0    KEEP_SCANNING+3,,AUTO
        13 002704   200335 630500                    EPPR0   KEEP_SCANNING+3,,AUTO
        13 002705   000017 631400 xsym               EPPR1   B_VECTNIL+15
        13 002706   000000 701000 xent               TSX1    XUR$ECHOIF
        13 002707   000000 011000                    NOP     0

     1244    14606
     1245    14607    2         CALL XUR$ERRPTR ( , DCBNUM(M$LO));

  14607 13 002710   000000 236007 xsym               LDQ     M$LO,DL
        13 002711   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 002712   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 002713   200337 450500                    STP0    KEEP_SCANNING+5,,AUTO
        13 002714   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 002715   200336 756100                    STQ     KEEP_SCANNING+4,,AUTO
        13 002716   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 002717   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002720   000000 701000 xent               TSX1    XUR$ERRPTR
        13 002721   000000 011000                    NOP     0

     1246    14608
     1247    14609    2   REPORT_PARTIAL_ERROR:
     1248    14610
     1249    14611    2         CALL PSE$ERRMSG (OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE, WARNING#);

  14611 13 002722   200004 470500       REPORT_PART* LDP0    CMD$,,AUTO
        13 002723   000003 471500                    LDP1    3,,PR0
        13 002724   000032 236000 14                 LDQ     26
        13 002725   200335 756100                    STQ     KEEP_SCANNING+3,,AUTO
        13 002726   200336 451500                    STP1    KEEP_SCANNING+4,,AUTO
        13 002727   200336 236100                    LDQ     KEEP_SCANNING+4,,AUTO
        13 002730   400000 036007                    ADLQ    -131072,DL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:189  
        13 002731   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 002732   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 002733   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 002734   000000 701000 xent               TSX1    PSE$ERRMSG
        13 002735   000000 011000                    NOP     0
        13 002736   002741 710000 13                 TRA     s:14619

     1250    14612
     1251    14613    2      CASE (ELSE);

     1252    14614
     1253    14615    2         CALL M$ERR;

  14615 13 002737   000002 713400                    CLIMB   err
        13 002740   000000 401760                    pmme    nvectors=0

     1254    14616
     1255    14617    2      END;

     1256    14618
     1257    14619    1      RETURN;

  14619 13 002741   000000 702200 xent               TSX2  ! X66_ARET

     1258    14620
     1259    14621        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:190  
     1260    14622    1   PSA$BLURTFEP: ENTRY;

  14622 13 002742   000000 700200 xent  PSA$BLURTFEP TSX0  ! X66_AUTO_0
        13 002743   000362 000000                    ZERO    242,0

     1261    14623
     1262    14624    1      CALL SETUP_FEP(STATUS_MISC, PS_HLPCGBUF.DSPMSK);

  14624 13 002744   000127 236000 14                 LDQ     87
        13 002745   200276 756100                    STQ     @UTS+1,,AUTO
        13 002746   200025 630500                    EPPR0   STATUS_MISC,,AUTO
        13 002747   200275 450500                    STP0    TEMP_END_UTS+3,,AUTO
        13 002750   004624 701000 13                 TSX1    SETUP_FEP
        13 002751   000000 011000                    NOP     0

     1263    14625    1      CALL X$WRITE(PS_FDS, VECTOR(FEP_BLURT_FMT), VECTOR(PS_HLPCGBUF.NODE_NUM),

  14625 13 002752   000102 235000 14                 LDA     66
        13 002753   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 002754   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 002755   000025 036003                    ADLQ    21,DU
        13 002756   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 002757   200336 630500                    EPPR0   KEEP_SCANNING+4,,AUTO
        13 002760   200344 450500                    STP0    KEEP_SCANNING+10,,AUTO
        13 002761   000142 237000 14                 LDAQ    98
        13 002762   200342 757100                    STAQ    KEEP_SCANNING+8,,AUTO
        13 002763   000144 237000 14                 LDAQ    100
        13 002764   200340 757100                    STAQ    KEEP_SCANNING+6,,AUTO
        13 002765   200340 630500                    EPPR0   KEEP_SCANNING+6,,AUTO
        13 002766   000023 631400 xsym               EPPR1   B_VECTNIL+19
        13 002767   000000 701000 xent               TSX1    X$WRITE
        13 002770   000000 011000                    NOP     0

     1264    14626    1        VECTOR(PS_HLPCGBUF.HANDLER), VECTOR(STATUS_MISC));
     1265    14627    1      RETURN;

  14627 13 002771   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:191  

     1266    14628        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:192  
     1267    14629    1   FEPBITS: PROC ( FEPMASK, NODE$, MASKS ) ;

  14629 13 002772   200274 741300       FEPBITS      STX1  ! TEMP_END_UTS+2,,AUTO

     1268    14630
     1269    14631    2   DCL NODE$ PTR ;
     1270    14632        %PS_FEPMASK ( NAME=FEPMASK, STCLASS=PARAM ) ;
     1271    14698        %PS_FEPMASK ( NAME="MASKS(0:0)", STCLASS=PARAM ) ;
     1272    14764
     1273    14765    2   DCL IT UBIN;
     1274    14766
     1275    14767    2      FEPMASK = '0'B ;

  14767 13 002773   200275 470500                    LDP0    @FEPMASK,,AUTO
        13 002774   000000 450100                    STZ     0,,PR0

     1276    14768    2      HANDLER = ' ' ;

  14768 13 002775   000035 235000 xsym               LDA     B_VECTNIL+29
        13 002776   000035 236000 xsym               LDQ     B_VECTNIL+29
        13 002777   200022 757100                    STAQ    HANDLER,,AUTO

     1277    14769
     1278    14770    2      IF NODE$->OUT$BLK.NSUBLKS = 0 THEN

  14770 13 003000   200276 471500                    LDP1    @NODE$,,AUTO
        13 003001   100000 473500                    LDP3    0,,PR1
        13 003002   300001 220100                    LDX0    1,,PR3
        13 003003   003010 601000 13                 TNZ     s:14773

     1279    14771    2      FEPMASK = MASKS(1 /* all */ ) ;

  14771 13 003004   200277 474500                    LDP4    @MASKS,,AUTO
        13 003005   400001 236100                    LDQ     1,,PR4
        13 003006   000000 756100                    STQ     0,,PR0
        13 003007   003045 710000 13                 TRA     s:14782

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:193  
     1280    14772    2      ELSE
     1281    14773    3      DO IT = 0 TO NODE$->OUT$BLK.NSUBLKS-1 ;

  14773 13 003010   200300 450100                    STZ     IT,,AUTO
        13 003011   003036 710000 13                 TRA     s:14781+3

     1282    14774
     1283    14775    3         IF NODE$->OUT$BLK.SUBLK$(IT)->OUT$BLK.CODE = 0 /* handler */

  14775 13 003012   200276 470500                    LDP0    @NODE$,,AUTO
        13 003013   000000 471500                    LDP1    0,,PR0
        13 003014   200300 720100                    LXL0    IT,,AUTO
        13 003015   100003 473510                    LDP3    3,X0,PR1
        13 003016   300000 721100                    LXL1    0,,PR3
        13 003017   003026 601000 13                 TNZ     s:14780

     1284    14776    4         THEN DO ;

     1285    14777    4            HANDLER = NODE$->OUT$BLK.SUBLK$(IT)->OUT$SYM.TEXT ;

  14777 13 003020   300004 236100                    LDQ     4,,PR3
        13 003021   000033 772000                    QRL     27
        13 003022   000000 622006                    EAX2    0,QL
        13 003023   040100 100540                    MLR     fill='040'O
        13 003024   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        13 003025   200022 000010                    ADSC9   HANDLER,,AUTO            cn=0,n=8

     1286    14778    4         END ;

     1287    14779
     1288    14780    3         FEPMASK = FEPMASK | MASKS(NODE$->OUT$BLK.SUBLK$(IT)->OUT$BLK.CODE) ;

  14780 13 003026   200275 474500                    LDP4    @FEPMASK,,AUTO
        13 003027   200277 475500                    LDP5    @MASKS,,AUTO
        13 003030   400000 236100                    LDQ     0,,PR4
        13 003031   500000 276111                    ORQ     0,X1,PR5
        13 003032   400000 756100                    STQ     0,,PR4
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:194  

     1289    14781    3      END;

  14781 13 003033   200300 235100                    LDA     IT,,AUTO
        13 003034   000001 035007                    ADLA    1,DL
        13 003035   200300 755100                    STA     IT,,AUTO
        13 003036   200276 470500                    LDP0    @NODE$,,AUTO
        13 003037   000000 471500                    LDP1    0,,PR0
        13 003040   100001 236100                    LDQ     1,,PR1
        13 003041   000022 772000                    QRL     18
        13 003042   200300 116100                    CMPQ    IT,,AUTO
        13 003043   003045 600000 13                 TZE     s:14782
        13 003044   003012 603000 13                 TRC     s:14775

     1290    14782    2   END FEPBITS;

  14782 13 003045   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 003046   000001 702211                    TSX2  ! 1,X1

     1291    14783        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:195  
     1292    14784    1   UPBITS: PROC;

  14784 13 003047   200274 741300       UPBITS       STX1  ! TEMP_END_UTS+2,,AUTO

     1293    14785
     1294    14786    3      DO CASE (CHANGE_MODE);

  14786 13 003050   200013 235100                    LDA     CHANGE_MODE,,AUTO
        13 003051   000003 115007                    CMPA    3,DL
        13 003052   003054 602005 13                 TNC     s:14786+4,AL
        13 003053   003161 710000 13                 TRA     s:14813
        13 003054   003057 710000 13                 TRA     s:14790
        13 003055   003102 710000 13                 TRA     s:14796
        13 003056   003127 710000 13                 TRA     s:14804

     1295    14787
     1296    14788    3      CASE (0 /* new flags */);

     1297    14789
     1298    14790    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) = DISP;

  14790 13 003057   000000 236000 xsym               LDQ     PS_FEPNO
        13 003060   000002 736000                    QLS     2
        13 003061   000000 620006                    EAX0    0,QL
        13 003062   200020 236100                    LDQ     DISP,,AUTO
        13 003063   200015 470500                    LDP0    FEP_FLAGS$,,AUTO
        13 003064   000000 756110                    STQ     0,X0,PR0

     1299    14791    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) = SLCT;

  14791 13 003065   000000 236000 xsym               LDQ     PS_FEPNO
        13 003066   000002 736000                    QLS     2
        13 003067   000000 620006                    EAX0    0,QL
        13 003070   200021 236100                    LDQ     SLCT,,AUTO
        13 003071   000001 756110                    STQ     1,X0,PR0

     1300    14792    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.HANDLER(PS_FEPNO) = HANDLER ;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:196  

  14792 13 003072   000000 236000 xsym               LDQ     PS_FEPNO
        13 003073   000002 736000                    QLS     2
        13 003074   000000 620006                    EAX0    0,QL
        13 003075   000000 621006                    EAX1    0,QL
        13 003076   200022 237100                    LDAQ    HANDLER,,AUTO
        13 003077   000002 755110                    STA     2,X0,PR0
        13 003100   000003 756111                    STQ     3,X1,PR0
        13 003101   003161 710000 13                 TRA     s:14813

     1301    14793
     1302    14794    3      CASE (1 /* Add flags */);

     1303    14795
     1304    14796    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) =

  14796 13 003102   000000 236000 xsym               LDQ     PS_FEPNO
        13 003103   000002 736000                    QLS     2
        13 003104   200015 470500                    LDP0    FEP_FLAGS$,,AUTO
        13 003105   000000 620006                    EAX0    0,QL
        13 003106   000000 236106                    LDQ     0,QL,PR0
        13 003107   200020 276100                    ORQ     DISP,,AUTO
        13 003110   000000 756110                    STQ     0,X0,PR0

     1305    14797    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) | DISP;
     1306    14798    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) =

  14798 13 003111   000000 236000 xsym               LDQ     PS_FEPNO
        13 003112   000002 736000                    QLS     2
        13 003113   000000 620006                    EAX0    0,QL
        13 003114   000001 236106                    LDQ     1,QL,PR0
        13 003115   200021 276100                    ORQ     SLCT,,AUTO
        13 003116   000001 756110                    STQ     1,X0,PR0

     1307    14799    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) | SLCT;
     1308    14800    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.HANDLER(PS_FEPNO) = HANDLER ;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:197  
  14800 13 003117   000000 236000 xsym               LDQ     PS_FEPNO
        13 003120   000002 736000                    QLS     2
        13 003121   000000 620006                    EAX0    0,QL
        13 003122   000000 621006                    EAX1    0,QL
        13 003123   200022 237100                    LDAQ    HANDLER,,AUTO
        13 003124   000002 755110                    STA     2,X0,PR0
        13 003125   000003 756111                    STQ     3,X1,PR0
        13 003126   003161 710000 13                 TRA     s:14813

     1309    14801
     1310    14802    3      CASE (2 /* Delete flags */);

     1311    14803
     1312    14804    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) =

  14804 13 003127   000000 236000 xsym               LDQ     PS_FEPNO
        13 003130   000002 736000                    QLS     2
        13 003131   000000 620006                    EAX0    0,QL
        13 003132   200020 236100                    LDQ     DISP,,AUTO
        13 003133   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 003134   200015 470500                    LDP0    FEP_FLAGS$,,AUTO
        13 003135   000000 376110                    ANQ     0,X0,PR0
        13 003136   000000 756110                    STQ     0,X0,PR0

     1313    14805    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.DISP(PS_FEPNO) & ~ DISP;
     1314    14806    3         FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) =

  14806 13 003137   000000 236000 xsym               LDQ     PS_FEPNO
        13 003140   000002 736000                    QLS     2
        13 003141   000000 620006                    EAX0    0,QL
        13 003142   200021 236100                    LDQ     SLCT,,AUTO
        13 003143   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 003144   000001 376110                    ANQ     1,X0,PR0
        13 003145   000001 756110                    STQ     1,X0,PR0

     1315    14807    3           FEP_FLAGS$->PS_FEP_BASED_FLAGS.SLCT(PS_FEPNO) & ~ SLCT;
     1316    14808    4         IF SLCT & FEP_SLCT_MODE_MASKS.HANDLER THEN DO ;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:198  

  14808 13 003146   200021 236100                    LDQ     SLCT,,AUTO
        13 003147   000011 376000 12                 ANQ     FEP_SLCT_MODE_MASKS
        13 003150   003161 600000 13                 TZE     s:14813

     1317    14809    4            FEP_FLAGS$->PS_FEP_BASED_FLAGS.HANDLER(PS_FEPNO) = ' ' ;

  14809 13 003151   000000 236000 xsym               LDQ     PS_FEPNO
        13 003152   000002 736000                    QLS     2
        13 003153   000000 620006                    EAX0    0,QL
        13 003154   000000 621006                    EAX1    0,QL
        13 003155   000035 235000 xsym               LDA     B_VECTNIL+29
        13 003156   000035 236000 xsym               LDQ     B_VECTNIL+29
        13 003157   000002 755110                    STA     2,X0,PR0
        13 003160   000003 756111                    STQ     3,X1,PR0

     1318    14810    4         END ;

     1319    14811
     1320    14812    3      END /* CASE */;

     1321    14813    2   END UPBITS;

  14813 13 003161   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 003162   000001 702211                    TSX2  ! 1,X1

     1322    14814        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:199  
     1323    14815    1   GENERATE_SCALE: PROC (LOW, HIGH, SCALE, POINTS, VALUE);

  14815 13 003163   200320 741300       GENERATE_SC* STX1  ! Q$+1,,AUTO

     1324    14816
     1325    14817    2   DCL LOW UBIN;
     1326    14818    2   DCL HIGH UBIN;
     1327    14819    2   DCL SCALE UBIN;
     1328    14820    2   DCL POINTS UBIN;
     1329    14821    2   DCL POINTS_SBIN REDEF POINTS SBIN;
     1330    14822    2   DCL VALUE (0:0) UBIN;
     1331    14823
     1332    14824    2   DCL I UBIN;
     1333    14825    2   DCL DX SBIN;
     1334    14826    2   DCL FACTOR UBIN;
     1335    14827    2   DCL FACTOR_SBIN REDEF FACTOR SBIN;
     1336    14828    2   DCL MFACTOR UBIN;
     1337    14829    2   DCL MFACTOR_SBIN REDEF MFACTOR SBIN;
     1338    14830    2   DCL KEEP_SCANNING LOGICAL;
     1339    14831
     1340    14832    3      DO CASE (SCALE);

  14832 13 003164   200323 470500                    LDP0    @SCALE,,AUTO
        13 003165   000000 235100                    LDA     0,,PR0
        13 003166   000002 115007                    CMPA    2,DL
        13 003167   003171 602005 13                 TNC     s:14832+5,AL
        13 003170   003451 710000 13                 TRA     s:14940
        13 003171   003173 710000 13                 TRA     s:14836
        13 003172   003257 710000 13                 TRA     s:14857

     1341    14833
     1342    14834    3      CASE (0 /* linear */);

     1343    14835
     1344    14836    3         VALUE(0) = LOW;

  14836 13 003173   200321 471500                    LDP1    @LOW,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:200  
        13 003174   200325 473500                    LDP3    @VALUE,,AUTO
        13 003175   100000 235100                    LDA     0,,PR1
        13 003176   300000 755100                    STA     0,,PR3

     1345    14837
     1346    14838    3         IF (HIGH - LOW) / POINTS_SBIN > 20

  14838 13 003177   200322 474500                    LDP4    @HIGH,,AUTO
        13 003200   400000 236100                    LDQ     0,,PR4
        13 003201   100000 136100                    SBLQ    0,,PR1
        13 003202   200324 475500                    LDP5    @POINTS,,AUTO
        13 003203   500000 506100                    DIV     0,,PR5
        13 003204   000024 116007                    CMPQ    20,DL
        13 003205   003211 604400 13                 TMOZ    s:14842

     1347    14839    3         THEN
     1348    14840    3         FACTOR = 10;

  14840 13 003206   000012 235007                    LDA     10,DL
        13 003207   200330 755100                    STA     FACTOR,,AUTO
        13 003210   003213 710000 13                 TRA     s:14844

     1349    14841    3         ELSE
     1350    14842    3         FACTOR = 1;

  14842 13 003211   000001 235007                    LDA     1,DL
        13 003212   200330 755100                    STA     FACTOR,,AUTO

     1351    14843
     1352    14844    4         DO I = 1 TO POINTS-1;

  14844 13 003213   000001 236007                    LDQ     1,DL
        13 003214   200326 756100                    STQ     I,,AUTO
        13 003215   003252 710000 13                 TRA     s:14853+3

     1353    14845
     1354    14846    4            VALUE(I) = ((FACTOR/2 + LOW + (((HIGH-LOW) * I) /
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:201  

  14846 13 003216   200321 470500                    LDP0    @LOW,,AUTO
        13 003217   200322 471500                    LDP1    @HIGH,,AUTO
        13 003220   100000 236100                    LDQ     0,,PR1
        13 003221   000000 136100                    SBLQ    0,,PR0
        13 003222   200326 402100                    MPY     I,,AUTO
        13 003223   200324 473500                    LDP3    @POINTS,,AUTO
        13 003224   300000 235100                    LDA     0,,PR3
        13 003225   000001 135007                    SBLA    1,DL
        13 003226   200334 755100                    STA     KEEP_SCANNING+2,,AUTO
        13 003227   200334 506100                    DIV     KEEP_SCANNING+2,,AUTO
        13 003230   200335 756100                    STQ     KEEP_SCANNING+3,,AUTO
        13 003231   200330 236100                    LDQ     FACTOR,,AUTO
        13 003232   000001 772000                    QRL     1
        13 003233   000000 036100                    ADLQ    0,,PR0
        13 003234   200335 036100                    ADLQ    KEEP_SCANNING+3,,AUTO
        13 003235   200330 506100                    DIV     FACTOR,,AUTO
        13 003236   200330 402100                    MPY     FACTOR,,AUTO
        13 003237   200325 474500                    LDP4    @VALUE,,AUTO
        13 003240   200326 720100                    LXL0    I,,AUTO
        13 003241   400000 756110                    STQ     0,X0,PR4

     1355    14847    4              (POINTS_SBIN-1))) / FACTOR_SBIN ) * FACTOR;
     1356    14848
     1357    14849    4            IF VALUE(I) <= VALUE(I-1)

  14849 13 003242   477777 236110                    LDQ     -1,X0,PR4
        13 003243   400000 116110                    CMPQ    0,X0,PR4
        13 003244   003247 602000 13                 TNC     s:14853

     1358    14850    4            THEN
     1359    14851    4            VALUE(I) = VALUE(I-1) + 1;

  14851 13 003245   000001 036007                    ADLQ    1,DL
        13 003246   400000 756110                    STQ     0,X0,PR4

     1360    14852
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:202  
     1361    14853    4         END;

  14853 13 003247   200326 235100                    LDA     I,,AUTO
        13 003250   000001 035007                    ADLA    1,DL
        13 003251   200326 755100                    STA     I,,AUTO
        13 003252   200324 470500                    LDP0    @POINTS,,AUTO
        13 003253   200326 236100                    LDQ     I,,AUTO
        13 003254   000000 116100                    CMPQ    0,,PR0
        13 003255   003216 602000 13                 TNC     s:14846
        13 003256   003451 710000 13                 TRA     s:14940

     1362    14854        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:203  
     1363    14855    3      CASE (1 /* log */);

     1364    14856
     1365    14857    3         FACTOR = 1100;

  14857 13 003257   002114 236007                    LDQ     1100,DL
        13 003260   200330 756100                    STQ     FACTOR,,AUTO

     1366    14858    3         DX = 100;

  14858 13 003261   000144 235007                    LDA     100,DL
        13 003262   200327 755100                    STA     DX,,AUTO

     1367    14859
     1368    14860    3         IF LOW = 0

  14860 13 003263   200321 471500                    LDP1    @LOW,,AUTO
        13 003264   100000 235100                    LDA     0,,PR1
        13 003265   003270 601000 13                 TNZ     s:14864

     1369    14861    3         THEN
     1370    14862    3         LOW = 1;

  14862 13 003266   000001 235007                    LDA     1,DL
        13 003267   100000 755100                    STA     0,,PR1

     1371    14863
     1372    14864    4         DO WHILE (DX ~= 0);

  14864 13 003270   200327 235100                    LDA     DX,,AUTO
        13 003271   003406 600000 13                 TZE     s:14924

     1373    14865
     1374    14866    4            KEEP_SCANNING = %YES#;

  14866 13 003272   400000 236003                    LDQ     -131072,DU
        13 003273   200332 756100                    STQ     KEEP_SCANNING,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:204  

     1375    14867
     1376    14868    5            DO WHILE (KEEP_SCANNING);

  14868 13 003274   200332 234100                    SZN     KEEP_SCANNING,,AUTO
        13 003275   003404 605000 13                 TPL     s:14922

     1377    14869
     1378    14870    5               MFACTOR = FACTOR;

  14870 13 003276   200330 235100                    LDA     FACTOR,,AUTO
        13 003277   200331 755100                    STA     MFACTOR,,AUTO

     1379    14871    5               VALUE(0) = LOW;

  14871 13 003300   200321 470500                    LDP0    @LOW,,AUTO
        13 003301   200325 471500                    LDP1    @VALUE,,AUTO
        13 003302   000000 235100                    LDA     0,,PR0
        13 003303   100000 755100                    STA     0,,PR1

     1380    14872
     1381    14873    6               DO I = 1 TO POINTS-1;

  14873 13 003304   000001 236007                    LDQ     1,DL
        13 003305   200326 756100                    STQ     I,,AUTO
        13 003306   003334 710000 13                 TRA     s:14883+3

     1382    14874
     1383    14875    6                  VALUE(I) = (LOW * MFACTOR) / 1000;

  14875 13 003307   200321 470500                    LDP0    @LOW,,AUTO
        13 003310   000000 236100                    LDQ     0,,PR0
        13 003311   200331 402100                    MPY     MFACTOR,,AUTO
        13 003312   000001 772000                    QRL     1
        13 003313   000764 506007                    DIV     500,DL
        13 003314   200325 471500                    LDP1    @VALUE,,AUTO
        13 003315   200326 720100                    LXL0    I,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:205  
        13 003316   100000 756110                    STQ     0,X0,PR1

     1384    14876
     1385    14877    6                  IF VALUE(I) <= VALUE(I-1)

  14877 13 003317   177777 236110                    LDQ     -1,X0,PR1
        13 003320   100000 116110                    CMPQ    0,X0,PR1
        13 003321   003324 602000 13                 TNC     s:14881

     1386    14878    6                  THEN
     1387    14879    6                  VALUE(I) = VALUE(I-1) + 1;

  14879 13 003322   000001 036007                    ADLQ    1,DL
        13 003323   100000 756110                    STQ     0,X0,PR1

     1388    14880
     1389    14881    6                  MFACTOR = (MFACTOR * FACTOR) / 1000;

  14881 13 003324   200331 236100                    LDQ     MFACTOR,,AUTO
        13 003325   200330 402100                    MPY     FACTOR,,AUTO
        13 003326   000001 772000                    QRL     1
        13 003327   000764 506007                    DIV     500,DL
        13 003330   200331 756100                    STQ     MFACTOR,,AUTO

     1390    14882
     1391    14883    6               END;

  14883 13 003331   200326 235100                    LDA     I,,AUTO
        13 003332   000001 035007                    ADLA    1,DL
        13 003333   200326 755100                    STA     I,,AUTO
        13 003334   200324 473500                    LDP3    @POINTS,,AUTO
        13 003335   200326 236100                    LDQ     I,,AUTO
        13 003336   300000 116100                    CMPQ    0,,PR3
        13 003337   003307 602000 13                 TNC     s:14875

     1392    14884
     1393    14885    5               IF VALUE(POINTS-1) = HIGH
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:206  

  14885 13 003340   300000 720100                    LXL0    0,,PR3
        13 003341   200322 474500                    LDP4    @HIGH,,AUTO
        13 003342   177777 236110                    LDQ     -1,X0,PR1
        13 003343   400000 116100                    CMPQ    0,,PR4
        13 003344   003350 601000 13                 TNZ     s:14894

     1394    14886    6               THEN DO;

     1395    14887
     1396    14888    6                  DX = 0;

  14888 13 003345   200327 450100                    STZ     DX,,AUTO

     1397    14889    6                  KEEP_SCANNING = %NO#;

  14889 13 003346   200332 450100                    STZ     KEEP_SCANNING,,AUTO

     1398    14890    6               END;

  14890 13 003347   003402 710000 13                 TRA     s:14920

     1399    14891
     1400    14892    6               ELSE DO;

     1401    14893
     1402    14894    6                  IF (VALUE(POINTS-1) > HIGH AND DX > 0)

  14894 13 003350   400000 236100                    LDQ     0,,PR4
        13 003351   177777 116110                    CMPQ    -1,X0,PR1
        13 003352   003355 603000 13                 TRC     s:14894+5
        13 003353   200327 235100                    LDA     DX,,AUTO
        13 003354   003362 605400 13                 TPNZ    s:14898
        13 003355   177777 116110                    CMPQ    -1,X0,PR1
        13 003356   003367 602000 13                 TNC     s:14904
        13 003357   003367 600000 13                 TZE     s:14904
        13 003360   200327 235100                    LDA     DX,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:207  
        13 003361   003367 605000 13                 TPL     s:14904

     1403    14895    6                    OR (VALUE(POINTS-1) < HIGH AND DX < 0)
     1404    14896    7                  THEN DO;

     1405    14897
     1406    14898    7                     KEEP_SCANNING = %NO#;

  14898 13 003362   200332 450100                    STZ     KEEP_SCANNING,,AUTO

     1407    14899    7                     DX = -DX / 10;

  14899 13 003363   200327 336100                    LCQ     DX,,AUTO
        13 003364   000012 506007                    DIV     10,DL
        13 003365   200327 756100                    STQ     DX,,AUTO

     1408    14900    7                  END;

  14900 13 003366   003402 710000 13                 TRA     s:14920

     1409    14901
     1410    14902    7                  ELSE DO;

     1411    14903
     1412    14904    7                     IF (FACTOR <= 1000 AND DX < 0)

  14904 13 003367   200330 235100                    LDA     FACTOR,,AUTO
        13 003370   001751 115007                    CMPA    1001,DL
        13 003371   003377 603000 13                 TRC     s:14913
        13 003372   200327 235100                    LDA     DX,,AUTO
        13 003373   003377 605000 13                 TPL     s:14913

     1413    14905    8                     THEN DO;

     1414    14906
     1415    14907    8                        DX = 0;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:208  
  14907 13 003374   200327 450100                    STZ     DX,,AUTO

     1416    14908    8                        KEEP_SCANNING = %NO#;

  14908 13 003375   200332 450100                    STZ     KEEP_SCANNING,,AUTO

     1417    14909    8                     END;

  14909 13 003376   003402 710000 13                 TRA     s:14920

     1418    14910
     1419    14911    8                     ELSE DO;

     1420    14912
     1421    14913    8                        FACTOR = FACTOR + DX;

  14913 13 003377   200330 236100                    LDQ     FACTOR,,AUTO
        13 003400   200327 036100                    ADLQ    DX,,AUTO
        13 003401   200330 756100                    STQ     FACTOR,,AUTO

     1422    14914    8                     END;

     1423    14915
     1424    14916    7                  END;

     1425    14917
     1426    14918    6               END;

     1427    14919
     1428    14920    5            END /* do while (keep_scanning) */ ;

  14920 13 003402   200332 234100                    SZN     KEEP_SCANNING,,AUTO
        13 003403   003276 604000 13                 TMI     s:14870

     1429    14921
     1430    14922    4         END /* do while (dx ~= 0) */ ;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:209  
  14922 13 003404   200327 235100                    LDA     DX,,AUTO
        13 003405   003272 601000 13                 TNZ     s:14866

     1431    14923
     1432    14924    3         FACTOR = HIGH - LOW;

  14924 13 003406   200321 470500                    LDP0    @LOW,,AUTO
        13 003407   200322 471500                    LDP1    @HIGH,,AUTO
        13 003410   100000 236100                    LDQ     0,,PR1
        13 003411   000000 136100                    SBLQ    0,,PR0
        13 003412   200330 756100                    STQ     FACTOR,,AUTO

     1433    14925
     1434    14926    3         MFACTOR = VALUE(POINTS-1) - LOW;

  14926 13 003413   200324 473500                    LDP3    @POINTS,,AUTO
        13 003414   300000 720100                    LXL0    0,,PR3
        13 003415   200325 474500                    LDP4    @VALUE,,AUTO
        13 003416   477777 236110                    LDQ     -1,X0,PR4
        13 003417   000000 136100                    SBLQ    0,,PR0
        13 003420   200331 756100                    STQ     MFACTOR,,AUTO

     1435    14927
     1436    14928    4         DO I = 1 TO POINTS-1;

  14928 13 003421   000001 235007                    LDA     1,DL
        13 003422   200326 755100                    STA     I,,AUTO
        13 003423   003445 710000 13                 TRA     s:14936+3

     1437    14929
     1438    14930    4            VALUE(I) = LOW + ((VALUE(I) - LOW) * FACTOR) / MFACTOR_SBIN ;

  14930 13 003424   200321 470500                    LDP0    @LOW,,AUTO
        13 003425   200325 471500                    LDP1    @VALUE,,AUTO
        13 003426   200326 720100                    LXL0    I,,AUTO
        13 003427   100000 236110                    LDQ     0,X0,PR1
        13 003430   000000 136100                    SBLQ    0,,PR0
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:210  
        13 003431   200330 402100                    MPY     FACTOR,,AUTO
        13 003432   200331 506100                    DIV     MFACTOR,,AUTO
        13 003433   000000 036100                    ADLQ    0,,PR0
        13 003434   100000 756110                    STQ     0,X0,PR1

     1439    14931
     1440    14932    4            IF VALUE(I) <= VALUE(I-1)

  14932 13 003435   177777 236110                    LDQ     -1,X0,PR1
        13 003436   100000 116110                    CMPQ    0,X0,PR1
        13 003437   003442 602000 13                 TNC     s:14936

     1441    14933    4            THEN
     1442    14934    4            VALUE(I) = VALUE(I-1) + 1;

  14934 13 003440   000001 036007                    ADLQ    1,DL
        13 003441   100000 756110                    STQ     0,X0,PR1

     1443    14935
     1444    14936    4         END;

  14936 13 003442   200326 235100                    LDA     I,,AUTO
        13 003443   000001 035007                    ADLA    1,DL
        13 003444   200326 755100                    STA     I,,AUTO
        13 003445   200324 471500                    LDP1    @POINTS,,AUTO
        13 003446   200326 236100                    LDQ     I,,AUTO
        13 003447   100000 116100                    CMPQ    0,,PR1
        13 003450   003424 602000 13                 TNC     s:14930

     1445    14937
     1446    14938    3      END /* do case (scale) */ ;

     1447    14939
     1448    14940    2      RETURN;

  14940 13 003451   200320 221300                    LDX1  ! Q$+1,,AUTO
        13 003452   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:211  

     1449    14941
     1450    14942    2   END GENERATE_SCALE;
     1451    14943        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:212  
     1452    14944    1   SET_FLAGS: PROC (BLOCK_NUM, FLAGS);

  14944 13 003453   200274 741300       SET_FLAGS    STX1  ! TEMP_END_UTS+2,,AUTO

     1453    14945
     1454    14946    2   DCL BLOCK_NUM UBIN;
     1455    14947
     1456    14948
     1457    14949    2   DCL 1 FLAGS UNAL, /* Yes, I know. */
     1458    14950    2          2 SNAP LOGICAL,
     1459    14951    2          2 ALL LOGICAL;
     1460    14952
     1461    14953    2   DCL CODA UBIN;
     1462    14954
     1463    14955    2      IF OUT$BLK.SUBLK$(BLOCK_NUM) -> OUT$BLK.NSUBLKS = 0

  14955 13 003454   200275 470500                    LDP0    @BLOCK_NUM,,AUTO
        13 003455   000000 720100                    LXL0    0,,PR0
        13 003456   200004 471500                    LDP1    CMD$,,AUTO
        13 003457   100003 473510                    LDP3    3,X0,PR1
        13 003460   300001 222100                    LDX2    1,,PR3
        13 003461   003464 601000 13                 TNZ     s:14959

     1464    14956    2      THEN
     1465    14957    2      CODA = 0;

  14957 13 003462   200277 450100                    STZ     CODA,,AUTO
        13 003463   003470 710000 13                 TRA     s:14961

     1466    14958    2      ELSE
     1467    14959    2      CODA = OUT$BLK.SUBLK$(BLOCK_NUM) -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;

  14959 13 003464   300003 474500                    LDP4    3,,PR3
        13 003465   400000 236100                    LDQ     0,,PR4
        13 003466   777777 376007                    ANQ     -1,DL
        13 003467   200277 756100                    STQ     CODA,,AUTO

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:213  
     1468    14960
     1469    14961    3      DO CASE (CODA);

  14961 13 003470   200277 235100                    LDA     CODA,,AUTO
        13 003471   000003 115007                    CMPA    3,DL
        13 003472   003474 602005 13                 TNC     s:14961+4,AL
        13 003473   003526 710000 13                 TRA     s:14980
        13 003474   003477 710000 13                 TRA     s:14965
        13 003475   003507 710000 13                 TRA     s:14970
        13 003476   003517 710000 13                 TRA     s:14975

     1470    14962
     1471    14963    3      CASE (0 /* both */);

     1472    14964
     1473    14965    3         FLAGS.SNAP = %YES#;

  14965 13 003477   200276 474500                    LDP4    @FLAGS,,AUTO
        13 003500   003100 060400                    CSL     bolr='003'O
        13 003501   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        13 003502   400000 000001                    BDSC    0,,PR4                   by=0,bit=0,n=1

     1474    14966    3         FLAGS.ALL = %YES#;

  14966 13 003503   003100 060400                    CSL     bolr='003'O
        13 003504   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        13 003505   400000 010001                    BDSC    0,,PR4                   by=0,bit=1,n=1
        13 003506   003526 710000 13                 TRA     s:14980

     1475    14967
     1476    14968    3      CASE (1 /* snap */);

     1477    14969
     1478    14970    3         FLAGS.SNAP = %YES#;

  14970 13 003507   200276 474500                    LDP4    @FLAGS,,AUTO
        13 003510   003100 060400                    CSL     bolr='003'O
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:214  
        13 003511   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        13 003512   400000 000001                    BDSC    0,,PR4                   by=0,bit=0,n=1

     1479    14971    3         FLAGS.ALL = %NO#;

  14971 13 003513   003100 060400                    CSL     bolr='003'O
        13 003514   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
        13 003515   400000 010001                    BDSC    0,,PR4                   by=0,bit=1,n=1
        13 003516   003526 710000 13                 TRA     s:14980

     1480    14972
     1481    14973    3      CASE (2 /* all */);

     1482    14974
     1483    14975    3         FLAGS.SNAP = %NO#;

  14975 13 003517   200276 474500                    LDP4    @FLAGS,,AUTO
        13 003520   003100 060400                    CSL     bolr='003'O
        13 003521   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
        13 003522   400000 000001                    BDSC    0,,PR4                   by=0,bit=0,n=1

     1484    14976    3         FLAGS.ALL = %YES#;

  14976 13 003523   003100 060400                    CSL     bolr='003'O
        13 003524   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        13 003525   400000 010001                    BDSC    0,,PR4                   by=0,bit=1,n=1

     1485    14977
     1486    14978    3      END;

     1487    14979
     1488    14980    2      RETURN;

  14980 13 003526   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 003527   000001 702211                    TSX2  ! 1,X1

     1489    14981
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:215  
     1490    14982    2   END SET_FLAGS;
     1491    14983        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:216  
     1492    14984    1   SETUP_STATS_ENTRY: PROC (CMD$BLK, I, POINTS);

  14984 13 003530   200274 741300       SETUP_STATS* STX1  ! TEMP_END_UTS+2,,AUTO

     1493    14985
     1494    14986        %PARSE$OUT (NAME=CMD$BLK, STCLASS=" ");
     1495    15031
     1496    15032        %PARSE$OUT (NAME=ENTRY$BLK, STCLASS="BASED(BLOCK$)");
     1497    15077    2   DCL I UBIN;
     1498    15078    2   DCL POINTS UBIN;
     1499    15079
     1500    15080    2   DCL J UBIN;
     1501    15081    2   DCL LOW UBIN;
     1502    15082    2   DCL HIGH UBIN;
     1503    15083    2   DCL SCALE UBIN;
     1504    15084    2   DCL CPOS1 UBIN;
     1505    15085    2   DCL CPOS2 UBIN;
     1506    15086    2   DCL DOING_ALL LOGICAL;
     1507    15087    2   DCL TITLE CHAR (24);
     1508    15088    2   DCL BLOCK$ PTR;
     1509    15089    2   DCL P$ PTR;
     1510    15090    2   DCL Q$ PTR;
     1511    15091
     1512    15092    2      IF I < CMD$BLK.NSUBLKS

  15092 13 003531   200276 470500                    LDP0    @I,,AUTO
        13 003532   200275 471500                    LDP1    @CMD$BLK,,AUTO
        13 003533   100001 236100                    LDQ     1,,PR1
        13 003534   000022 772000                    QRL     18
        13 003535   000000 116100                    CMPQ    0,,PR0
        13 003536   003571 602000 13                 TNC     s:15108
        13 003537   003571 600000 13                 TZE     s:15108

     1513    15093    3      THEN DO /* it's a valid item */;

     1514    15094
     1515    15095    3         BLOCK$ = CMD$BLK.SUBLK$(I);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:217  

  15095 13 003540   000000 720100                    LXL0    0,,PR0
        13 003541   100003 236110                    LDQ     3,X0,PR1
        13 003542   200315 756100                    STQ     BLOCK$,,AUTO

     1516    15096
     1517    15097    3         DOING_ALL = %NO#;

  15097 13 003543   200306 450100                    STZ     DOING_ALL,,AUTO

     1518    15098
     1519    15099    3         CALL PSR$RPN (ENTRY$BLK.SUBLK$(0)->OUT$BLK,

  15099 13 003544   200315 473500                    LDP3    BLOCK$,,AUTO
        13 003545   300003 474500                    LDP4    3,,PR3
        13 003546   000000 236100                    LDQ     0,,PR0
        13 003547   000014 402007                    MPY     12,DL
        13 003550   000000 475400 xsym               LDP5    PS_STATS$
        13 003551   500013 476506                    LDP6    11,QL,PR5
        13 003552   200335 456500                    STP6    KEEP_SCANNING+3,,AUTO
        13 003553   200334 454500                    STP4    KEEP_SCANNING+2,,AUTO
        13 003554   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 003555   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 003556   000000 701000 xent               TSX1    PSR$RPN
        13 003557   000000 011000                    NOP     0

     1520    15100    3           PS_STATS.RPN$(I)->BASED_RPN);
     1521    15101
     1522    15102    3         J = PS_STATS.RPN$(I)->BASED_RPN.INFO.SYMBOL_ID#;

  15102 13 003560   200276 470500                    LDP0    @I,,AUTO
        13 003561   000000 236100                    LDQ     0,,PR0
        13 003562   000014 402007                    MPY     12,DL
        13 003563   000000 471400 xsym               LDP1    PS_STATS$
        13 003564   100013 473506                    LDP3    11,QL,PR1
        13 003565   300000 236100                    LDQ     0,,PR3
        13 003566   377777 376007                    ANQ     131071,DL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:218  
        13 003567   200300 756100                    STQ     J,,AUTO

     1523    15103
     1524    15104    3      END;

  15104 13 003570   003634 710000 13                 TRA     s:15120

     1525    15105
     1526    15106    3      ELSE DO /* zero-length command list ("STATISTICS ALL") - fake it */;

     1527    15107
     1528    15108    3         DOING_ALL = %YES#;

  15108 13 003571   400000 236003                    LDQ     -131072,DU
        13 003572   200306 756100                    STQ     DOING_ALL,,AUTO

     1529    15109
     1530    15110    3         J = I;

  15110 13 003573   000000 235100                    LDA     0,,PR0
        13 003574   200300 755100                    STA     J,,AUTO

     1531    15111
     1532    15112    3         PS_STATS.RPN$(I)->BASED_RPN.INFO.SYMBOL_FOUND# = %YES#;

  15112 13 003575   000000 236100                    LDQ     0,,PR0
        13 003576   000014 402007                    MPY     12,DL
        13 003577   000000 473400 xsym               LDP3    PS_STATS$
        13 003600   300013 474506                    LDP4    11,QL,PR3
        13 003601   400000 236007                    LDQ     -131072,DL
        13 003602   400000 256100                    ORSQ    0,,PR4

     1533    15113    3         PS_STATS.RPN$(I)->BASED_RPN.INFO.SYMBOL_ID# = J;

  15113 13 003603   000000 236100                    LDQ     0,,PR0
        13 003604   000014 402007                    MPY     12,DL
        13 003605   000000 473400 xsym               LDP3    PS_STATS$
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:219  
        13 003606   300013 474506                    LDP4    11,QL,PR3
        13 003607   200300 236100                    LDQ     J,,AUTO
        13 003610   400000 676100                    ERQ     0,,PR4
        13 003611   377777 376007                    ANQ     131071,DL
        13 003612   400000 656100                    ERSQ    0,,PR4

     1534    15114    3         PS_STATS.RPN$(I)->BASED_RPN.INFO.USED# = 1;

  15114 13 003613   000000 236100                    LDQ     0,,PR0
        13 003614   000014 402007                    MPY     12,DL
        13 003615   000000 473400 xsym               LDP3    PS_STATS$
        13 003616   300013 474506                    LDP4    11,QL,PR3
        13 003617   000001 236003                    LDQ     1,DU
        13 003620   400000 552120                    STBQ    0,'20'O,PR4

     1535    15115    3         PS_STATS.RPN$(I)->BASED_RPN.ITEM.OPCODE#(0) = PUSH_SYMBOL#;

  15115 13 003621   000000 236100                    LDQ     0,,PR0
        13 003622   000014 402007                    MPY     12,DL
        13 003623   000000 473400 xsym               LDP3    PS_STATS$
        13 003624   300013 474506                    LDP4    11,QL,PR3
        13 003625   000000 236003                    LDQ     0,DU
        13 003626   400001 552140                    STBQ    1,'40'O,PR4

     1536    15116    3         PS_STATS.RPN$(I)->BASED_RPN.ITEM.ARG#(0) = J;

  15116 13 003627   000000 236100                    LDQ     0,,PR0
        13 003630   000014 402007                    MPY     12,DL
        13 003631   300013 474506                    LDP4    11,QL,PR3
        13 003632   200300 236100                    LDQ     J,,AUTO
        13 003633   400001 552134                    STBQ    1,'34'O,PR4

     1537    15117
     1538    15118    3      END;

     1539    15119
     1540    15120    2      PS_STATS.SCALE(I) = V_TABLE.SCALE(J);
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:220  

  15120 13 003634   000000 236100                    LDQ     0,,PR0
        13 003635   000014 402007                    MPY     12,DL
        13 003636   000000 620006                    EAX0    0,QL
        13 003637   200300 236100                    LDQ     J,,AUTO
        13 003640   000005 402007                    MPY     5,DL
        13 003641   000000 471400 xsym               LDP1    PS_STATS$
        13 003642   000001 236006 xsym               LDQ     V_TABLE+1,QL
        13 003643   000042 772000                    QRL     34
        13 003644   100006 756110                    STQ     6,X0,PR1

     1541    15121    2      PS_STATS.LOW(I) = V_TABLE.LOW(J);

  15121 13 003645   000000 236100                    LDQ     0,,PR0
        13 003646   000014 402007                    MPY     12,DL
        13 003647   000000 620006                    EAX0    0,QL
        13 003650   200300 236100                    LDQ     J,,AUTO
        13 003651   000005 402007                    MPY     5,DL
        13 003652   000000 471400 xsym               LDP1    PS_STATS$
        13 003653   000001 236006 xsym               LDQ     V_TABLE+1,QL
        13 003654   000021 772000                    QRL     17
        13 003655   377777 376007                    ANQ     131071,DL
        13 003656   100007 756110                    STQ     7,X0,PR1

     1542    15122    2      PS_STATS.HIGH(I) = V_TABLE.HIGH(J);

  15122 13 003657   000000 236100                    LDQ     0,,PR0
        13 003660   000014 402007                    MPY     12,DL
        13 003661   000000 620006                    EAX0    0,QL
        13 003662   200300 236100                    LDQ     J,,AUTO
        13 003663   000005 402007                    MPY     5,DL
        13 003664   000000 471400 xsym               LDP1    PS_STATS$
        13 003665   000001 236006 xsym               LDQ     V_TABLE+1,QL
        13 003666   377777 376007                    ANQ     131071,DL
        13 003667   100010 756110                    STQ     8,X0,PR1

     1543    15123
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:221  
     1544    15124    2      IF NOT DOING_ALL

  15124 13 003670   200306 234100                    SZN     DOING_ALL,,AUTO
        13 003671   004006 604000 13                 TMI     s:15158
        13 003672   200315 471500                    LDP1    BLOCK$,,AUTO
        13 003673   100001 220100                    LDX0    1,,PR1
        13 003674   000002 100003                    CMPX0   2,DU
        13 003675   004006 601000 13                 TNZ     s:15158

     1545    15125    2        AND ENTRY$BLK.NSUBLKS = 2
     1546    15126    3      THEN DO;

     1547    15127
     1548    15128    3         P$ = ENTRY$BLK.SUBLK$(1);

  15128 13 003676   100004 236100                    LDQ     4,,PR1
        13 003677   200316 756100                    STQ     P$,,AUTO

     1549    15129
     1550    15130    4         DO J = 0 TO P$->OUT$BLK.NSUBLKS - 1;

  15130 13 003700   200300 450100                    STZ     J,,AUTO
        13 003701   004000 710000 13                 TRA     s:15154+3

     1551    15131
     1552    15132    4            Q$ = P$->OUT$BLK.SUBLK$(J);

  15132 13 003702   200316 470500                    LDP0    P$,,AUTO
        13 003703   200300 720100                    LXL0    J,,AUTO
        13 003704   000003 236110                    LDQ     3,X0,PR0
        13 003705   200317 756100                    STQ     Q$,,AUTO

     1553    15133
     1554    15134    5            DO CASE (Q$->OUT$BLK.CODE);

  15134 13 003706   200317 471500                    LDP1    Q$,,AUTO
        13 003707   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:222  
        13 003710   777777 376007                    ANQ     -1,DL
        13 003711   000004 136007                    SBLQ    4,DL
        13 003712   000001 116007                    CMPQ    1,DL
        13 003713   003715 602006 13                 TNC     s:15134+7,QL
        13 003714   003765 710000 13                 TRA     s:15150
        13 003715   003716 710000 13                 TRA     s:15138

     1555    15135
     1556    15136    5            CASE (4 /* limits */);

     1557    15137
     1558    15138    5               CALL CHARBIN (PS_STATS.LOW(I), Q$->OUT$BLK.SUBLK$(0)->

  15138 13 003716   200276 473500                    LDP3    @I,,AUTO
        13 003717   300000 236100                    LDQ     0,,PR3
        13 003720   000014 402007                    MPY     12,DL
        13 003721   100003 474500                    LDP4    3,,PR1
        13 003722   000000 621006                    EAX1    0,QL
        13 003723   400004 236100                    LDQ     4,,PR4
        13 003724   000033 772000                    QRL     27
        13 003725   000000 622006                    EAX2    0,QL
        13 003726   000100 305540                    DTB
        13 003727   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
        13 003730   200334 000010                    NDSC9   KEEP_SCANNING+2,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 003731   000000 474400 xsym               LDP4    PS_STATS$
        13 003732   200335 235100                    LDA     KEEP_SCANNING+3,,AUTO
        13 003733   400007 755111                    STA     7,X1,PR4

     1559    15139    5                 OUT$SYM.TEXT);
     1560    15140
     1561    15141    5               CALL CHARBIN (PS_STATS.HIGH(I), Q$->OUT$BLK.SUBLK$(1)->

  15141 13 003734   300000 236100                    LDQ     0,,PR3
        13 003735   000014 402007                    MPY     12,DL
        13 003736   100004 474500                    LDP4    4,,PR1
        13 003737   000000 621006                    EAX1    0,QL
        13 003740   400004 236100                    LDQ     4,,PR4
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:223  
        13 003741   000033 772000                    QRL     27
        13 003742   000000 622006                    EAX2    0,QL
        13 003743   000100 305540                    DTB
        13 003744   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
        13 003745   200334 000010                    NDSC9   KEEP_SCANNING+2,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 003746   000000 474400 xsym               LDP4    PS_STATS$
        13 003747   200335 235100                    LDA     KEEP_SCANNING+3,,AUTO
        13 003750   400010 755111                    STA     8,X1,PR4

     1562    15142    5                 OUT$SYM.TEXT);
     1563    15143
     1564    15144    5               IF PS_STATS.LOW(I) >= PS_STATS.HIGH(I)

  15144 13 003751   300000 236100                    LDQ     0,,PR3
        13 003752   000014 402007                    MPY     12,DL
        13 003753   000000 474400 xsym               LDP4    PS_STATS$
        13 003754   000000 621006                    EAX1    0,QL
        13 003755   400007 236106                    LDQ     7,QL,PR4
        13 003756   400010 116111                    CMPQ    8,X1,PR4
        13 003757   003775 602000 13                 TNC     s:15154

     1565    15145    5               THEN
     1566    15146    5               CALL PSE$ERRMSG (E$PS_BAD_LIMITS, SERIOUS#);

  15146 13 003760   000147 630400 14                 EPPR0   103
        13 003761   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 003762   000000 701000 xent               TSX1    PSE$ERRMSG
        13 003763   000000 011000                    NOP     0
        13 003764   003775 710000 13                 TRA     s:15154

     1567    15147
     1568    15148    5            CASE (ELSE);

     1569    15149
     1570    15150    5               PS_STATS.SCALE(I) = Q$->OUT$BLK.CODE;

  15150 13 003765   200276 473500                    LDP3    @I,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:224  
        13 003766   300000 236100                    LDQ     0,,PR3
        13 003767   000014 402007                    MPY     12,DL
        13 003770   000000 621006                    EAX1    0,QL
        13 003771   100000 236100                    LDQ     0,,PR1
        13 003772   777777 376007                    ANQ     -1,DL
        13 003773   000000 474400 xsym               LDP4    PS_STATS$
        13 003774   400006 756111                    STQ     6,X1,PR4

     1571    15151
     1572    15152    5            END;

     1573    15153
     1574    15154    4         END;

  15154 13 003775   200300 235100                    LDA     J,,AUTO
        13 003776   000001 035007                    ADLA    1,DL
        13 003777   200300 755100                    STA     J,,AUTO
        13 004000   200316 470500                    LDP0    P$,,AUTO
        13 004001   000001 236100                    LDQ     1,,PR0
        13 004002   000022 772000                    QRL     18
        13 004003   200300 116100                    CMPQ    J,,AUTO
        13 004004   004006 600000 13                 TZE     s:15158
        13 004005   003702 603000 13                 TRC     s:15132

     1575    15155
     1576    15156    3      END;

     1577    15157
     1578    15158    2      LOW = PS_STATS.LOW(I);

  15158 13 004006   200276 470500                    LDP0    @I,,AUTO
        13 004007   000000 236100                    LDQ     0,,PR0
        13 004010   000014 402007                    MPY     12,DL
        13 004011   000000 471400 xsym               LDP1    PS_STATS$
        13 004012   100007 235106                    LDA     7,QL,PR1
        13 004013   200301 755100                    STA     LOW,,AUTO

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:225  
     1579    15159    2      HIGH = PS_STATS.HIGH(I);

  15159 13 004014   000000 236100                    LDQ     0,,PR0
        13 004015   000014 402007                    MPY     12,DL
        13 004016   100010 235106                    LDA     8,QL,PR1
        13 004017   200302 755100                    STA     HIGH,,AUTO

     1580    15160    2      SCALE = PS_STATS.SCALE(I);

  15160 13 004020   000000 236100                    LDQ     0,,PR0
        13 004021   000014 402007                    MPY     12,DL
        13 004022   100006 235106                    LDA     6,QL,PR1
        13 004023   200303 755100                    STA     SCALE,,AUTO

     1581    15161
     1582    15162    2      CALL GENERATE_SCALE (LOW, HIGH, SCALE,

  15162 13 004024   000000 236100                    LDQ     0,,PR0
        13 004025   000014 402007                    MPY     12,DL
        13 004026   100012 473506                    LDP3    10,QL,PR1
        13 004027   300002 634500                    EPPR4   2,,PR3
        13 004030   200325 454500                    STP4    @VALUE,,AUTO
        13 004031   200324 453500                    STP3    @POINTS,,AUTO
        13 004032   200303 635500                    EPPR5   SCALE,,AUTO
        13 004033   200323 455500                    STP5    @SCALE,,AUTO
        13 004034   200302 636500                    EPPR6   HIGH,,AUTO
        13 004035   200322 456500                    STP6    @HIGH,,AUTO
        13 004036   200301 637500                    EPPR7   LOW,,AUTO
        13 004037   200321 457500                    STP7    @LOW,,AUTO
        13 004040   003163 701000 13                 TSX1    GENERATE_SCALE
        13 004041   000000 011000                    NOP     0

     1583    15163    2        PS_STATS.BUCKET$(I) -> BASED_BUCKET.SIZE,
     1584    15164    2        PS_STATS.BUCKET$(I) -> BASED_BUCKET.DATA);
     1585    15165
     1586    15166    2      CALL GENERATE_SCALE (LOW, HIGH, SCALE, POINTS-1,

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:226  
  15166 13 004042   200276 470500                    LDP0    @I,,AUTO
        13 004043   000000 236100                    LDQ     0,,PR0
        13 004044   000014 402007                    MPY     12,DL
        13 004045   000000 471400 xsym               LDP1    PS_STATS$
        13 004046   100011 473506                    LDP3    9,QL,PR1
        13 004047   200277 474500                    LDP4    @POINTS,,AUTO
        13 004050   400000 235100                    LDA     0,,PR4
        13 004051   000001 135007                    SBLA    1,DL
        13 004052   200360 755100                    STA     KEEP_SCANNING+22,,AUTO
        13 004053   200325 453500                    STP3    @VALUE,,AUTO
        13 004054   200360 635500                    EPPR5   KEEP_SCANNING+22,,AUTO
        13 004055   200324 455500                    STP5    @POINTS,,AUTO
        13 004056   200303 636500                    EPPR6   SCALE,,AUTO
        13 004057   200323 456500                    STP6    @SCALE,,AUTO
        13 004060   200302 637500                    EPPR7   HIGH,,AUTO
        13 004061   200322 457500                    STP7    @HIGH,,AUTO
        13 004062   200301 630500                    EPPR0   LOW,,AUTO
        13 004063   200321 450500                    STP0    @LOW,,AUTO
        13 004064   003163 701000 13                 TSX1    GENERATE_SCALE
        13 004065   000000 011000                    NOP     0

     1587    15167    2        PS_STATS.PLOT$(I) -> PS_PLOT_VALUES);
     1588    15168
     1589    15169    2      RETURN;

  15169 13 004066   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 004067   000001 702211                    TSX2  ! 1,X1

     1590    15170
     1591    15171    2   END SETUP_STATS_ENTRY;
     1592    15172        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:227  
     1593    15173    1   CHECK_FOR_EXPM: PROC;

  15173 13 004070   200274 741300       CHECK_FOR_E* STX1  ! TEMP_END_UTS+2,,AUTO

     1594    15174
     1595    15175    2      IF (B$JIT.PRIV.ACTIVE & %PR_EXPM#) = '0'B

  15175 13 004071   000000 470400 xsym               LDP0    B$JIT$
        13 004072   000013 236100                    LDQ     11,,PR0
        13 004073   000435 376000 12                 ANQ     DEFAULT_END_TIME+9
        13 004074   004101 601000 13                 TNZ     s:15179

     1596    15176    2      THEN
     1597    15177    2      CALL PSE$ERRMSG (E$PS_NEED_EXPM, WARNING#);

  15177 13 004075   000151 630400 14                 EPPR0   105
        13 004076   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 004077   000000 701000 xent               TSX1    PSE$ERRMSG
        13 004100   000000 011000                    NOP     0

     1598    15178
     1599    15179    2      RETURN;

  15179 13 004101   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 004102   000001 702211                    TSX2  ! 1,X1

     1600    15180
     1601    15181    2   END CHECK_FOR_EXPM;
     1602    15182        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:228  
     1603    15183    1   SET_TIME: PROC (UTS_RESULT, TIME$BLK, DEFAULT_TIME);

  15183 13 004103   200274 741300       SET_TIME     STX1  ! TEMP_END_UTS+2,,AUTO

     1604    15184
     1605    15185        %PARSE$OUT (NAME=TIME$BLK, STCLASS=" ");
     1606    15230    2   DCL UTS_RESULT UBIN;
     1607    15231    2   DCL DEFAULT_TIME CHAR(11);
     1608    15232
     1609    15233    2      TIME_AREA_C = DEFAULT_TIME;

  15233 13 004104   200277 470500                    LDP0    @DEFAULT_TIME,,AUTO
        13 004105   040000 100500                    MLR     fill='040'O
        13 004106   000000 000013                    ADSC9   0,,PR0                   cn=0,n=11
        13 004107   005155 000013 11                 ADSC9   TIME_AREA                cn=0,n=11

     1610    15234    2      DATE_AREA.VECTOR_PORTION.REAL = TODAYS_DATE;

  15234 13 004110   005166 237000 11                 LDAQ    TODAYS_DATE
        13 004111   005160 757000 11                 STAQ    DATE_AREA

     1611    15235
     1612    15236    3      DO CASE (TIME$BLK.CODE);

  15236 13 004112   200276 471500                    LDP1    @TIME$BLK,,AUTO
        13 004113   100000 720100                    LXL0    0,,PR1
        13 004114   000004 100003                    CMPX0   4,DU
        13 004115   004117 602010 13                 TNC     s:15236+5,X0
        13 004116   004160 710000 13                 TRA     s:15258
        13 004117   004123 710000 13                 TRA     s:15240
        13 004120   004135 710000 13                 TRA     s:15245
        13 004121   004147 710000 13                 TRA     s:15250
        13 004122   004154 710000 13                 TRA     s:15254

     1613    15237
     1614    15238    3      CASE (0 /* date,time specified */);

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:229  
     1615    15239
     1616    15240    3         CALL MOVE_DATE (TIME$BLK.SUBLK$(0)->OUT$BLK);

  15240 13 004123   100003 473500                    LDP3    3,,PR1
        13 004124   200301 453500                    STP3    LOW,,AUTO
        13 004125   004202 701000 13                 TSX1    MOVE_DATE
        13 004126   000000 011000                    NOP     0

     1617    15241    3         CALL MOVE_TIME (TIME$BLK.SUBLK$(1)->OUT$BLK);

  15241 13 004127   200276 470500                    LDP0    @TIME$BLK,,AUTO
        13 004130   000004 471500                    LDP1    4,,PR0
        13 004131   200301 451500                    STP1    LOW,,AUTO
        13 004132   004245 701000 13                 TSX1    MOVE_TIME
        13 004133   000000 011000                    NOP     0
        13 004134   004160 710000 13                 TRA     s:15258

     1618    15242
     1619    15243    3      CASE (1 /* time,date specified */);

     1620    15244
     1621    15245    3         CALL MOVE_TIME (TIME$BLK.SUBLK$(0)->OUT$BLK);

  15245 13 004135   100003 473500                    LDP3    3,,PR1
        13 004136   200301 453500                    STP3    LOW,,AUTO
        13 004137   004245 701000 13                 TSX1    MOVE_TIME
        13 004140   000000 011000                    NOP     0

     1622    15246    3         CALL MOVE_DATE (TIME$BLK.SUBLK$(1)->OUT$BLK);

  15246 13 004141   200276 470500                    LDP0    @TIME$BLK,,AUTO
        13 004142   000004 471500                    LDP1    4,,PR0
        13 004143   200301 451500                    STP1    LOW,,AUTO
        13 004144   004202 701000 13                 TSX1    MOVE_DATE
        13 004145   000000 011000                    NOP     0
        13 004146   004160 710000 13                 TRA     s:15258

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:230  
     1623    15247
     1624    15248    3      CASE (2 /* date specified */);

     1625    15249
     1626    15250    3         CALL MOVE_DATE(TIME$BLK.SUBLK$(0)->OUT$BLK);

  15250 13 004147   100003 473500                    LDP3    3,,PR1
        13 004150   200301 453500                    STP3    LOW,,AUTO
        13 004151   004202 701000 13                 TSX1    MOVE_DATE
        13 004152   000000 011000                    NOP     0
        13 004153   004160 710000 13                 TRA     s:15258

     1627    15251
     1628    15252    3      CASE (3 /* time specified */);

     1629    15253
     1630    15254    3         CALL MOVE_TIME (TIME$BLK.SUBLK$(0)->OUT$BLK);

  15254 13 004154   100003 473500                    LDP3    3,,PR1
        13 004155   200301 453500                    STP3    LOW,,AUTO
        13 004156   004245 701000 13                 TSX1    MOVE_TIME
        13 004157   000000 011000                    NOP     0

     1631    15255
     1632    15256    3      END;

     1633    15257
     1634    15258    2      CONVERT_TO_UTS.TSTAMP_ = VECTOR(UTS_RESULT);

  15258 13 004160   777640 235007                    LDA     -96,DL
        13 004161   200275 236100                    LDQ     @UTS_RESULT,,AUTO
        13 004162   005042 757000 11                 STAQ    CONVERT_TO_UTS+8

     1635    15259
     1636    15260    2      CALL M$TIME (CONVERT_TO_UTS) ALTRET (TIME_ERROR);

  15260 13 004163   005032 630400 11                 EPPR0   CONVERT_TO_UTS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:231  
        13 004164   420004 713400                    CLIMB   alt,+8196
        13 004165   402000 401760                    pmme    nvectors=5
        13 004166   004171 702000 13                 TSX2    TIME_ERROR

     1637    15261
     1638    15262    2      RETURN;

  15262 13 004167   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 004170   000001 702211                    TSX2  ! 1,X1

     1639    15263
     1640    15264    2   TIME_ERROR:
     1641    15265    2      CALL PSE$ERRMSG ( , SERIOUS#);

  15265 13 004171   000002 236000 14    TIME_ERROR   LDQ     2
        13 004172   000001 235000 xsym               LDA     B_VECTNIL+1
        13 004173   200334 757100                    STAQ    KEEP_SCANNING+2,,AUTO
        13 004174   200334 630500                    EPPR0   KEEP_SCANNING+2,,AUTO
        13 004175   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 004176   000000 701000 xent               TSX1    PSE$ERRMSG
        13 004177   000000 011000                    NOP     0

     1642    15266
     1643    15267    2   END SET_TIME;

  15267 13 004200   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 004201   000001 702211                    TSX2  ! 1,X1

     1644    15268        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:232  
     1645    15269    1   MOVE_DATE: PROC (TIME$BLK);

  15269 13 004202   200300 741300       MOVE_DATE    STX1  ! J,,AUTO

     1646    15270
     1647    15271        %PARSE$OUT (NAME=TIME$BLK, STCLASS=" ");
     1648    15316    2   DCL I UBIN;
     1649    15317    2   DCL J UBIN;
     1650    15318
     1651    15319    3      DO I = 0 TO TIME$BLK.NSUBLKS - 1;

  15319 13 004203   200302 450100                    STZ     I,,AUTO
        13 004204   004235 710000 13                 TRA     s:15323+3

     1652    15320
     1653    15321    3         CALL CHARBIN (J, TIME$BLK.SUBLK$(I)->OUT$SYM.TEXT);

  15321 13 004205   200301 470500                    LDP0    @TIME$BLK,,AUTO
        13 004206   200302 720100                    LXL0    I,,AUTO
        13 004207   000003 471510                    LDP1    3,X0,PR0
        13 004210   100004 236100                    LDQ     4,,PR1
        13 004211   000033 772000                    QRL     27
        13 004212   000000 621006                    EAX1    0,QL
        13 004213   000100 305540                    DTB
        13 004214   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
        13 004215   200334 000010                    NDSC9   KEEP_SCANNING+2,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 004216   200335 235100                    LDA     KEEP_SCANNING+3,,AUTO
        13 004217   200303 755100                    STA     J,,AUTO

     1654    15322    3         CALL BINCHAR (DATE_AREA.PORTION.DIGITS(I), J);

  15322 13 004220   200302 236100                    LDQ     I,,AUTO
        13 004221   000003 402007                    MPY     3,DL
        13 004222   200303 235100                    LDA     J,,AUTO
        13 004223   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 004224   000044 773000                    LRL     36
        13 004225   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:233  
        13 004226   200334 235100                    LDA     KEEP_SCANNING+2,,AUTO
        13 004227   000005 301500                    BTD
        13 004230   200336 000010                    NDSC9   KEEP_SCANNING+4,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 004231   005160 030002 11                 NDSC9   DATE_AREA,A              cn=0,s=nosgn,sf=0,n=2

     1655    15323    3      END;

  15323 13 004232   200302 235100                    LDA     I,,AUTO
        13 004233   000001 035007                    ADLA    1,DL
        13 004234   200302 755100                    STA     I,,AUTO
        13 004235   200301 470500                    LDP0    @TIME$BLK,,AUTO
        13 004236   000001 236100                    LDQ     1,,PR0
        13 004237   000022 772000                    QRL     18
        13 004240   200302 116100                    CMPQ    I,,AUTO
        13 004241   004243 600000 13                 TZE     s:15325
        13 004242   004205 603000 13                 TRC     s:15321

     1656    15324
     1657    15325    2      RETURN;

  15325 13 004243   200300 221300                    LDX1  ! J,,AUTO
        13 004244   000001 702211                    TSX2  ! 1,X1

     1658    15326
     1659    15327    2   END MOVE_DATE;
     1660    15328
     1661    15329    1   MOVE_TIME: PROC (TIME$BLK);

  15329 13 004245   200300 741300       MOVE_TIME    STX1  ! J,,AUTO

     1662    15330
     1663    15331        %PARSE$OUT (NAME=TIME$BLK, STCLASS=" ");
     1664    15376    2   DCL I UBIN;
     1665    15377    2   DCL J UBIN;
     1666    15378
     1667    15379    3      DO I = 0 TO 1;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:234  
  15379 13 004246   200302 450100                    STZ     I,,AUTO

     1668    15380
     1669    15381    3         CALL CHARBIN (J, TIME$BLK.SUBLK$(I)->OUT$SYM.TEXT);

  15381 13 004247   200301 470500                    LDP0    @TIME$BLK,,AUTO
        13 004250   200302 720100                    LXL0    I,,AUTO
        13 004251   000003 471510                    LDP1    3,X0,PR0
        13 004252   100004 236100                    LDQ     4,,PR1
        13 004253   000033 772000                    QRL     27
        13 004254   000000 621006                    EAX1    0,QL
        13 004255   000100 305540                    DTB
        13 004256   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
        13 004257   200334 000010                    NDSC9   KEEP_SCANNING+2,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 004260   200335 235100                    LDA     KEEP_SCANNING+3,,AUTO
        13 004261   200303 755100                    STA     J,,AUTO

     1670    15382    3         CALL BINCHAR (TIME_AREA.PORTION.DIGITS(I), J);

  15382 13 004262   200302 236100                    LDQ     I,,AUTO
        13 004263   000003 402007                    MPY     3,DL
        13 004264   200303 235100                    LDA     J,,AUTO
        13 004265   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 004266   000044 773000                    LRL     36
        13 004267   200336 757100                    STAQ    KEEP_SCANNING+4,,AUTO
        13 004270   200334 235100                    LDA     KEEP_SCANNING+2,,AUTO
        13 004271   000005 301500                    BTD
        13 004272   200336 000010                    NDSC9   KEEP_SCANNING+4,,AUTO    cn=0,s=lsgnf,sf=0,n=8
        13 004273   005155 030002 11                 NDSC9   TIME_AREA,A              cn=0,s=nosgn,sf=0,n=2

     1671    15383    3      END;

  15383 13 004274   200302 235100                    LDA     I,,AUTO
        13 004275   000001 035007                    ADLA    1,DL
        13 004276   200302 755100                    STA     I,,AUTO
        13 004277   000002 115007                    CMPA    2,DL
        13 004300   004247 602000 13                 TNC     s:15381
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:235  

     1672    15384
     1673    15385    2      RETURN;

  15385 13 004301   200300 221300                    LDX1  ! J,,AUTO
        13 004302   000001 702211                    TSX2  ! 1,X1

     1674    15386
     1675    15387    2   END MOVE_TIME;
     1676    15388        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:236  
     1677    15389    1   INSERT_TOKEN: PROC (STRING, TOKEN, FLAG);

  15389 13 004303   200306 741300       INSERT_TOKEN STX1  ! DOING_ALL,,AUTO

     1678    15390
     1679    15391    2   DCL STRING CHAR (120);
     1680    15392    2   DCL TOKEN CHAR (15);
     1681    15393    2   DCL FLAG BIT(1) UNAL; /* Yes, I know. */
     1682    15394
     1683    15395    2   DCL CPOS UBIN;
     1684    15396    2   DCL TOKEN_LEN UBIN;
     1685    15397
     1686    15398    2      IF ADDR(FLAG) ~= ADDR(NIL)

  15398 13 004304   200311 236100                    LDQ     @FLAG,,AUTO
        13 004305   000001 116000 xsym               CMPQ    B_VECTNIL+1
        13 004306   004315 600000 13                 TZE     s:15403
        13 004307   200311 470500                    LDP0    @FLAG,,AUTO
        13 004310   000000 066500                    CMPB    filb='0'B
        13 004311   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
        13 004312   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        13 004313   004315 601000 13                 TNZ     s:15403

     1687    15399    2        AND NOT FLAG
     1688    15400    2      THEN
     1689    15401    2      RETURN;

  15401 13 004314   000001 702211                    TSX2  ! 1,X1

     1690    15402
     1691    15403    2      CALL INDEX (TOKEN_LEN, '.', TOKEN);

  15403 13 004315   200310 470500                    LDP0    @TOKEN,,AUTO
        13 004316   000000 124500                    SCM     mask='000'O
        13 004317   000000 000017                    ADSC9   0,,PR0                   cn=0,n=15
        13 004320   000153 000001 14                 ADSC9   107                      cn=0,n=1
        13 004321   200313 000100                    ARG     TOKEN_LEN,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:237  

     1692    15404
     1693    15405    2      CALL INDEX1R (CPOS, '.', STRING);

  15405 13 004322   200307 471500                    LDP1    @STRING,,AUTO
        13 004323   000000 125500                    SCMR    mask='000'O
        13 004324   100000 000170                    ADSC9   0,,PR1                   cn=0,n=120
        13 004325   000153 000001 14                 ADSC9   107                      cn=0,n=1
        13 004326   200312 000100                    ARG     CPOS,,AUTO
        13 004327   004332 606400 13                 TTN     s:15407
        13 004330   000167 236007                    LDQ     119,DL
        13 004331   200312 156100                    SSQ     CPOS,,AUTO

     1694    15406
     1695    15407    2      IF CPOS = LENGTHC(STRING)

  15407 13 004332   200312 235100                    LDA     CPOS,,AUTO
        13 004333   000170 115007                    CMPA    120,DL
        13 004334   004336 601000 13                 TNZ     s:15411

     1696    15408    2      THEN
     1697    15409    2      CPOS = 0;

  15409 13 004335   200312 450100                    STZ     CPOS,,AUTO

     1698    15410
     1699    15411    2      IF CPOS >= LENGTHC(STRING) - TOKEN_LEN

  15411 13 004336   000170 236007                    LDQ     120,DL
        13 004337   200313 136100                    SBLQ    TOKEN_LEN,,AUTO
        13 004340   004344 604000 13                 TMI     s:15413
        13 004341   200312 116100                    CMPQ    CPOS,,AUTO
        13 004342   004344 600000 13                 TZE     s:15413
        13 004343   004345 603000 13                 TRC     s:15415

     1700    15412    2      THEN
     1701    15413    2      RETURN;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:238  

  15413 13 004344   000001 702211                    TSX2  ! 1,X1

     1702    15414
     1703    15415    2      CALL INSERT (STRING, CPOS, , SUBSTR(TOKEN, 0, TOKEN_LEN), '.');

  15415 13 004345   200312 720100                    LXL0    CPOS,,AUTO
        13 004346   777607 620010                    EAX0    -121,X0
        13 004347   777777 660003                    ERX0    -1,DU
        13 004350   200313 722100                    LXL2    TOKEN_LEN,,AUTO
        13 004351   200312 235100                    LDA     CPOS,,AUTO
        13 004352   040145 100540                    MLR     fill='040'O
        13 004353   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        13 004354   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
        13 004355   200312 236100                    LDQ     CPOS,,AUTO
        13 004356   200313 036100                    ADLQ    TOKEN_LEN,,AUTO
        13 004357   000170 116007                    CMPQ    120,DL
        13 004360   004372 603000 13                 TRC     s:15417
        13 004361   200334 756100                    STQ     KEEP_SCANNING+2,,AUTO
        13 004362   200312 236100                    LDQ     CPOS,,AUTO
        13 004363   200313 036100                    ADLQ    TOKEN_LEN,,AUTO
        13 004364   200334 721100                    LXL1    KEEP_SCANNING+2,,AUTO
        13 004365   777607 621011                    EAX1    -121,X1
        13 004366   777777 661003                    ERX1    -1,DU
        13 004367   040146 100400                    MLR     fill='040'O
        13 004370   000153 000001 14                 ADSC9   107                      cn=0,n=1
        13 004371   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1

     1704    15416
     1705    15417    2      RETURN;

  15417 13 004372   200306 221300                    LDX1  ! DOING_ALL,,AUTO
        13 004373   000001 702211                    TSX2  ! 1,X1

     1706    15418
     1707    15419    2   END INSERT_TOKEN;
     1708    15420
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:239  
     1709    15421        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:240  
     1710    15422    1   SETUP_TOKENS: PROC (STRING, FLAGS);

  15422 13 004374   200274 741300       SETUP_TOKENS STX1  ! TEMP_END_UTS+2,,AUTO

     1711    15423
     1712    15424    2   DCL STRING CHAR (120);
     1713    15425    2   DCL FLAGS BIT (36) ALIGNED;
     1714    15426
     1715    15427
     1716    15428        %SUB FLAG="ADDR(FLAGS)->PS_BASED_FLAGS";
     1717    15429
     1718    15430    2      STRING = ' ';

  15430 13 004375   200275 470500                    LDP0    @STRING,,AUTO
        13 004376   040100 100400                    MLR     fill='040'O
        13 004377   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        13 004400   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120

     1719    15431
     1720    15432    2      IF FLAG.CPU AND FLAG.RESOURCES AND FLAG.DEVICES

  15432 13 004401   200276 471500                    LDP1    @FLAGS,,AUTO
        13 004402   100000 234100                    SZN     0,,PR1
        13 004403   004447 605000 13                 TPL     s:15448
        13 004404   100000 236100                    LDQ     0,,PR1
        13 004405   200000 316003                    CANQ    65536,DU
        13 004406   004447 600000 13                 TZE     s:15448
        13 004407   100000 316003                    CANQ    32768,DU
        13 004410   004447 600000 13                 TZE     s:15448
        13 004411   040000 316003                    CANQ    16384,DU
        13 004412   004447 600000 13                 TZE     s:15448
        13 004413   020000 316003                    CANQ    8192,DU
        13 004414   004447 600000 13                 TZE     s:15448
        13 004415   010000 316003                    CANQ    4096,DU
        13 004416   004447 600000 13                 TZE     s:15448
        13 004417   004000 316003                    CANQ    2048,DU
        13 004420   004423 601000 13                 TNZ     s:15432+18
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:241  
        13 004421   000000 235000 xsym               LDA     PS_SUMMARY_ITEMS
        13 004422   004447 601000 13                 TNZ     s:15448
        13 004423   002000 316003                    CANQ    1024,DU
        13 004424   004447 600000 13                 TZE     s:15448
        13 004425   100000 430100                    FSZN    0,,PR1
        13 004426   004447 605000 13                 TPL     s:15448

     1721    15433    2        AND FLAG.CHANNELS AND FLAG.SCPU AND FLAG.PROCS
     1722    15434    2        AND (FLAG.SUMMARY OR PS_SUMMARY_ITEMS = 0)
     1723    15435    2        AND FLAG.HISTOGRAMS AND FLAG.FAULT
     1724    15436    3      THEN DO;

     1725    15437
     1726    15438    3         IF FLAG.MOUSE AND FLAG.FEP

  15438 13 004427   000200 316003                    CANQ    128,DU
        13 004430   004437 600000 13                 TZE     s:15442
        13 004431   000400 316003                    CANQ    256,DU
        13 004432   004437 600000 13                 TZE     s:15442

     1727    15439    3         THEN
     1728    15440    3         STRING = 'all';

  15440 13 004433   040100 100400                    MLR     fill='040'O
        13 004434   000427 000003 12                 ADSC9   DEFAULT_END_TIME+3       cn=0,n=3
        13 004435   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120
        13 004436   004556 710000 13                 TRA     s:15460

     1729    15441    3         ELSE
     1730    15442    3         CALL INSERT_TOKEN (STRING, 'PM data, .');

  15442 13 004437   000001 236000 xsym               LDQ     B_VECTNIL+1
        13 004440   000154 235000 14                 LDA     108
        13 004441   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004442   200275 236100                    LDQ     @STRING,,AUTO
        13 004443   200307 756100                    STQ     @STRING,,AUTO
        13 004444   004303 701000 13                 TSX1    INSERT_TOKEN
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:242  
        13 004445   000000 011000                    NOP     0

     1731    15443
     1732    15444    3      END;

  15444 13 004446   004556 710000 13                 TRA     s:15460

     1733    15445
     1734    15446    3      ELSE DO;

     1735    15447
     1736    15448    3         CALL INSERT_TOKEN (STRING, 'CPU, .', FLAG.CPU);

  15448 13 004447   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004450   000155 235000 14                 LDA     109
        13 004451   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004452   200275 236100                    LDQ     @STRING,,AUTO
        13 004453   200307 756100                    STQ     @STRING,,AUTO
        13 004454   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004455   000000 011000                    NOP     0

     1737    15449    3         CALL INSERT_TOKEN (STRING, 'SCPU, .', FLAG.SCPU);

  15449 13 004456   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004457   040000 036007                    ADLQ    16384,DL
        13 004460   000156 235000 14                 LDA     110
        13 004461   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004462   200275 236100                    LDQ     @STRING,,AUTO
        13 004463   200307 756100                    STQ     @STRING,,AUTO
        13 004464   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004465   000000 011000                    NOP     0

     1738    15450    3         CALL INSERT_TOKEN (STRING, 'resources, .', FLAG.RESOURCES);

  15450 13 004466   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004467   010000 036007                    ADLQ    4096,DL
        13 004470   000157 235000 14                 LDA     111
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:243  
        13 004471   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004472   200275 236100                    LDQ     @STRING,,AUTO
        13 004473   200307 756100                    STQ     @STRING,,AUTO
        13 004474   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004475   000000 011000                    NOP     0

     1739    15451    3         CALL INSERT_TOKEN (STRING, 'devices, .', FLAG.DEVICES);

  15451 13 004476   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004477   020000 036007                    ADLQ    8192,DL
        13 004500   000160 235000 14                 LDA     112
        13 004501   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004502   200275 236100                    LDQ     @STRING,,AUTO
        13 004503   200307 756100                    STQ     @STRING,,AUTO
        13 004504   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004505   000000 011000                    NOP     0

     1740    15452    3         CALL INSERT_TOKEN (STRING, 'channels, .', FLAG.CHANNELS);

  15452 13 004506   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004507   030000 036007                    ADLQ    12288,DL
        13 004510   000161 235000 14                 LDA     113
        13 004511   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004512   200275 236100                    LDQ     @STRING,,AUTO
        13 004513   200307 756100                    STQ     @STRING,,AUTO
        13 004514   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004515   000000 011000                    NOP     0

     1741    15453    3         CALL INSERT_TOKEN (STRING, 'processors, .', FLAG.PROCS);

  15453 13 004516   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004517   050000 036007                    ADLQ    20480,DL
        13 004520   000162 235000 14                 LDA     114
        13 004521   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004522   200275 236100                    LDQ     @STRING,,AUTO
        13 004523   200307 756100                    STQ     @STRING,,AUTO
        13 004524   004303 701000 13                 TSX1    INSERT_TOKEN
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:244  
        13 004525   000000 011000                    NOP     0

     1742    15454    3         CALL INSERT_TOKEN (STRING, 'faults, .', FLAG.FAULT);

  15454 13 004526   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004527   100000 036007                    ADLQ    32768,DL
        13 004530   000163 235000 14                 LDA     115
        13 004531   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004532   200275 236100                    LDQ     @STRING,,AUTO
        13 004533   200307 756100                    STQ     @STRING,,AUTO
        13 004534   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004535   000000 011000                    NOP     0

     1743    15455    3         CALL INSERT_TOKEN (STRING, 'summary, .', FLAG.SUMMARY);

  15455 13 004536   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004537   060000 036007                    ADLQ    24576,DL
        13 004540   000164 235000 14                 LDA     116
        13 004541   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004542   200275 236100                    LDQ     @STRING,,AUTO
        13 004543   200307 756100                    STQ     @STRING,,AUTO
        13 004544   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004545   000000 011000                    NOP     0

     1744    15456    3         CALL INSERT_TOKEN (STRING, 'histograms, .', FLAG.HISTOGRAMS);

  15456 13 004546   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004547   070000 036007                    ADLQ    28672,DL
        13 004550   000165 235000 14                 LDA     117
        13 004551   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004552   200275 236100                    LDQ     @STRING,,AUTO
        13 004553   200307 756100                    STQ     @STRING,,AUTO
        13 004554   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004555   000000 011000                    NOP     0

     1745    15457
     1746    15458    3      END;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:245  

     1747    15459
     1748    15460    2      IF STRING ~= 'all'

  15460 13 004556   200275 470500                    LDP0    @STRING,,AUTO
        13 004557   040000 106500                    CMPC    fill='040'O
        13 004560   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120
        13 004561   000427 000003 12                 ADSC9   DEFAULT_END_TIME+3       cn=0,n=3
        13 004562   004622 600000 13                 TZE     s:15477

     1749    15461    3      THEN DO;

     1750    15462
     1751    15463    3         CALL INSERT_TOKEN (STRING, 'MoUsE, .', FLAG.MOUSE);

  15463 13 004563   200276 236100                    LDQ     @FLAGS,,AUTO
        13 004564   210000 036007                    ADLQ    69632,DL
        13 004565   000166 235000 14                 LDA     118
        13 004566   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004567   200275 236100                    LDQ     @STRING,,AUTO
        13 004570   200307 756100                    STQ     @STRING,,AUTO
        13 004571   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004572   000000 011000                    NOP     0

     1752    15464
     1753    15465    3         IF STRING = ' '

  15465 13 004573   200275 470500                    LDP0    @STRING,,AUTO
        13 004574   040000 106500                    CMPC    fill='040'O
        13 004575   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120
        13 004576   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        13 004577   004604 601000 13                 TNZ     s:15471

     1754    15466    3         THEN
     1755    15467    3         STRING = 'Host none';

  15467 13 004600   040100 100400                    MLR     fill='040'O
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:246  
        13 004601   000476 000011 12                 ADSC9   DEFAULT_END_TIME+42      cn=0,n=9
        13 004602   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120
        13 004603   004622 710000 13                 TRA     s:15477

     1756    15468
     1757    15469    4         ELSE DO;

     1758    15470
     1759    15471    4            CALL INDEX1R (I, ',', STRING);

  15471 13 004604   000000 125500                    SCMR    mask='000'O
        13 004605   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120
        13 004606   000167 000001 14                 ADSC9   119                      cn=0,n=1
        13 004607   200005 000100                    ARG     I,,AUTO
        13 004610   004613 606400 13                 TTN     s:15472
        13 004611   000167 236007                    LDQ     119,DL
        13 004612   200005 156100                    SSQ     I,,AUTO

     1760    15472    4            CALL INSERT (STRING, I, , '  ');

  15472 13 004613   200005 720100                    LXL0    I,,AUTO
        13 004614   777607 620010                    EAX0    -121,X0
        13 004615   777777 660003                    ERX0    -1,DU
        13 004616   200005 235100                    LDA     I,,AUTO
        13 004617   040145 100400                    MLR     fill='040'O
        13 004620   000501 000002 12                 ADSC9   DEFAULT_END_TIME+45      cn=0,n=2
        13 004621   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0

     1761    15473    4         END;

     1762    15474
     1763    15475    3      END;

     1764    15476
     1765    15477    2      RETURN;

  15477 13 004622   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:247  
        13 004623   000001 702211                    TSX2  ! 1,X1

     1766    15478
     1767    15479    2   END SETUP_TOKENS;
     1768    15480
     1769    15481        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:248  
     1770    15482    1   SETUP_FEP: PROC (STRING, FLAGS) ;

  15482 13 004624   200274 741300       SETUP_FEP    STX1  ! TEMP_END_UTS+2,,AUTO

     1771    15483
     1772    15484    2   DCL 1 STRING CHAR (120) ;
     1773    15485    2   DCL 1 FLAGS ALIGNED,
     1774    15486        %PS_FEPMASK ( NAME=DISP, LVL=2, LAST="," ) ;
     1775    15552        %PS_FEPMASK ( NAME=SLCT, LVL=2, LAST="," ) ;
     1776    15618    2          2 HANDLER CHAR(8) CALIGNED ;
     1777    15619
     1778    15620    2   DCL 1 MASK ALIGNED,
     1779    15621        %PS_FEPMASK ( NAME=DISP, LVL=2, LAST="," ) ;
     1780    15687        %PS_FEPMASK ( NAME=SLCT, LVL=2, LAST="," ) ;
     1781    15753    2          2 HANDLER CHAR(8) CALIGNED,
     1782    15754    2          2 PERIOD CHAR(2) CALIGNED ;
     1783    15755    2   DCL ENT UBIN;
     1784    15756
     1785    15757    2      STRING = ' ';

  15757 13 004625   200275 470500                    LDP0    @STRING,,AUTO
        13 004626   040100 100400                    MLR     fill='040'O
        13 004627   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        13 004630   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120

     1786    15758    2      MASK = FLAGS;

  15758 13 004631   200276 471500                    LDP1    @FLAGS,,AUTO
        13 004632   000100 100500                    MLR     fill='000'O
        13 004633   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16
        13 004634   200277 000022                    ADSC9   MASK,,AUTO               cn=0,n=18

     1787    15759    2      MASK.PERIOD = ' .' ;

  15759 13 004635   000440 220000 12                 LDX0    DEFAULT_END_TIME+12
        13 004636   200303 740100                    STX0    J,,AUTO

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:249  
     1788    15760
     1789    15761    2      IF ( MASK.DISP & FEP_DISP_MODE_MASKS.SUMMARY ) =

  15761 13 004637   200277 236100                    LDQ     MASK,,AUTO
        13 004640   000007 376000 12                 ANQ     FEP_DISP_MODE_MASKS
        13 004641   000007 116000 12                 CMPQ    FEP_DISP_MODE_MASKS
        13 004642   004656 601000 13                 TNZ     s:15766

     1790    15762    3        FEP_DISP_MODE_MASKS.SUMMARY THEN DO ;

     1791    15763    3         CALL INSERT_TOKEN ( STRING, 'Summary .', '1'B ) ;

  15763 13 004643   000170 237000 14                 LDAQ    120
        13 004644   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004645   200275 236100                    LDQ     @STRING,,AUTO
        13 004646   200307 756100                    STQ     @STRING,,AUTO
        13 004647   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004650   000000 011000                    NOP     0

     1792    15764    3         MASK.DISP = MASK.DISP & ~FEP_DISP_MODE_MASKS.SUMMARY ;

  15764 13 004651   000007 236000 12                 LDQ     FEP_DISP_MODE_MASKS
        13 004652   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 004653   200277 376100                    ANQ     MASK,,AUTO
        13 004654   200277 756100                    STQ     MASK,,AUTO

     1793    15765    3      END ;

  15765 13 004655   004674 710000 13                 TRA     D

     1794    15766    2      ELSE IF ( MASK.DISP & FEP_DISP_MODE_MASKS.EXTENDED ) =

  15766 13 004656   200277 236100                    LDQ     MASK,,AUTO
        13 004657   000010 376000 12                 ANQ     FEP_DISP_MODE_MASKS+1
        13 004660   000010 116000 12                 CMPQ    FEP_DISP_MODE_MASKS+1
        13 004661   004674 601000 13                 TNZ     D

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:250  
     1795    15767    3        FEP_DISP_MODE_MASKS.EXTENDED THEN DO ;

     1796    15768    3         CALL INSERT_TOKEN ( STRING, 'Extended .', '1'B ) ;

  15768 13 004662   000172 237000 14                 LDAQ    122
        13 004663   200310 757100                    STAQ    @TOKEN,,AUTO
        13 004664   200275 236100                    LDQ     @STRING,,AUTO
        13 004665   200307 756100                    STQ     @STRING,,AUTO
        13 004666   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004667   000000 011000                    NOP     0

     1797    15769    3         MASK.DISP = MASK.DISP & ~FEP_DISP_MODE_MASKS.EXTENDED ;

  15769 13 004670   000010 236000 12                 LDQ     FEP_DISP_MODE_MASKS+1
        13 004671   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 004672   200277 376100                    ANQ     MASK,,AUTO
        13 004673   200277 756100                    STQ     MASK,,AUTO

     1798    15770    3      END ;

     1799    15771
     1800    15772    3   D: DO ENT = 1 TO (SIZEW(FEP_DISP_MASKS)/SIZEW(FEP_MASK))-1 ;

  15772 13 004674   000001 235007       D            LDA     1,DL
        13 004675   200304 755100                    STA     ENT,,AUTO
        13 004676   004731 710000 13                 TRA     s:15779+3

     1801    15773    3         IF ( MASK.DISP & FEP_DISP_MASKS$->FEP_MASK(ENT) ) =

  15773 13 004677   000030 470400 12                 LDP0    FEP_DISP_MASKS$
        13 004700   200304 720100                    LXL0    ENT,,AUTO
        13 004701   200277 236100                    LDQ     MASK,,AUTO
        13 004702   000000 376110                    ANQ     0,X0,PR0
        13 004703   000000 116110                    CMPQ    0,X0,PR0
        13 004704   004726 601000 13                 TNZ     s:15779

     1802    15774    4           FEP_DISP_MASKS$->FEP_MASK(ENT) THEN DO ;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:251  

     1803    15775    4            CALL INSERT_TOKEN ( STRING, FEP_DISP_TOKENS(ENT), '1'B ) ;

  15775 13 004705   000171 236000 14                 LDQ     121
        13 004706   200311 756100                    STQ     @FLAG,,AUTO
        13 004707   200304 236100                    LDQ     ENT,,AUTO
        13 004710   000024 736000                    QLS     20
        13 004711   000174 036000 14                 ADLQ    124
        13 004712   200310 756100                    STQ     @TOKEN,,AUTO
        13 004713   200275 236100                    LDQ     @STRING,,AUTO
        13 004714   200307 756100                    STQ     @STRING,,AUTO
        13 004715   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004716   000000 011000                    NOP     0

     1804    15776    4            MASK.DISP = MASK.DISP & ~FEP_DISP_MASKS$->FEP_MASK(ENT) ;

  15776 13 004717   000030 470400 12                 LDP0    FEP_DISP_MASKS$
        13 004720   200304 720100                    LXL0    ENT,,AUTO
        13 004721   000000 236110                    LDQ     0,X0,PR0
        13 004722   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 004723   200277 376100                    ANQ     MASK,,AUTO
        13 004724   200277 756100                    STQ     MASK,,AUTO

     1805    15777    4            IF MASK.DISP = '0'B THEN EXIT D ;

  15777 13 004725   004733 600000 13                 TZE     s:15781

     1806    15778    4         END ;

     1807    15779    3      END ;

  15779 13 004726   200304 235100                    LDA     ENT,,AUTO
        13 004727   000001 035007                    ADLA    1,DL
        13 004730   200304 755100                    STA     ENT,,AUTO
        13 004731   000016 115007                    CMPA    14,DL
        13 004732   004677 602000 13                 TNC     s:15773

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:252  
     1808    15780
     1809    15781    2      CALL INDEX ( I, ' .', STRING ) ;

  15781 13 004733   200275 470500                    LDP0    @STRING,,AUTO
        13 004734   000000 120500                    SCD
        13 004735   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120
        13 004736   000440 000002 12                 ADSC9   DEFAULT_END_TIME+12      cn=0,n=2
        13 004737   200005 000100                    ARG     I,,AUTO
        13 004740   004742 607000 13                 TTF     s:15782
        13 004741   200005 054100                    AOS     I,,AUTO

     1810    15782    2      CALL INSERT ( STRING, I, , ' for .' ) ;

  15782 13 004742   200005 720100                    LXL0    I,,AUTO
        13 004743   777607 620010                    EAX0    -121,X0
        13 004744   777777 660003                    ERX0    -1,DU
        13 004745   200005 235100                    LDA     I,,AUTO
        13 004746   040145 100400                    MLR     fill='040'O
        13 004747   000510 000006 12                 ADSC9   DEFAULT_END_TIME+52      cn=0,n=6
        13 004750   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0

     1811    15783
     1812    15784    3   S: DO ENT = 0 TO (SIZEW(FEP_SLCT_MASKS)/SIZEW(FEP_MASK))-1 ;

  15784 13 004751   200304 450100       S            STZ     ENT,,AUTO
        13 004752   005020 710000 13                 TRA     s:15794+3

     1813    15785    3         IF ( MASK.SLCT & FEP_SLCT_MASKS$->FEP_MASK(ENT) ) =

  15785 13 004753   000136 470400 12                 LDP0    FEP_SLCT_MASKS$
        13 004754   200304 720100                    LXL0    ENT,,AUTO
        13 004755   200300 236100                    LDQ     J,,AUTO
        13 004756   000000 376110                    ANQ     0,X0,PR0
        13 004757   000000 116110                    CMPQ    0,X0,PR0
        13 004760   005015 601000 13                 TNZ     s:15794

     1814    15786    4           FEP_SLCT_MASKS$->FEP_MASK(ENT) THEN DO ;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:253  

     1815    15787    4            IF ENT = 0 THEN

  15787 13 004761   200304 235100                    LDA     ENT,,AUTO
        13 004762   004774 601000 13                 TNZ     s:15790

     1816    15788    4            CALL INSERT_TOKEN ( STRING, MASK.HANDLER, '1'B ) ;

  15788 13 004763   000171 236000 14                 LDQ     121
        13 004764   200311 756100                    STQ     @FLAG,,AUTO
        13 004765   200301 631500                    EPPR1   @TIME$BLK,,AUTO
        13 004766   200310 451500                    STP1    @TOKEN,,AUTO
        13 004767   200275 236100                    LDQ     @STRING,,AUTO
        13 004770   200307 756100                    STQ     @STRING,,AUTO
        13 004771   004303 701000 13                 TSX1    INSERT_TOKEN
        13 004772   000000 011000                    NOP     0
        13 004773   005006 710000 13                 TRA     s:15791

     1817    15789    4            ELSE
     1818    15790    4            CALL INSERT_TOKEN ( STRING, FEP_SLCT_TOKENS(ENT), '1'B ) ;

  15790 13 004774   000171 236000 14                 LDQ     121
        13 004775   200311 756100                    STQ     @FLAG,,AUTO
        13 004776   200304 236100                    LDQ     ENT,,AUTO
        13 004777   000024 736000                    QLS     20
        13 005000   000175 036000 14                 ADLQ    125
        13 005001   200310 756100                    STQ     @TOKEN,,AUTO
        13 005002   200275 236100                    LDQ     @STRING,,AUTO
        13 005003   200307 756100                    STQ     @STRING,,AUTO
        13 005004   004303 701000 13                 TSX1    INSERT_TOKEN
        13 005005   000000 011000                    NOP     0

     1819    15791    4            MASK.SLCT = MASK.SLCT & ~FEP_SLCT_MASKS$->FEP_MASK(ENT) ;

  15791 13 005006   000136 470400 12                 LDP0    FEP_SLCT_MASKS$
        13 005007   200304 720100                    LXL0    ENT,,AUTO
        13 005010   000000 236110                    LDQ     0,X0,PR0
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:254  
        13 005011   000027 676000 xsym               ERQ     B_VECTNIL+23
        13 005012   200300 376100                    ANQ     J,,AUTO
        13 005013   200300 756100                    STQ     J,,AUTO

     1820    15792    4            IF MASK.SLCT = '0'B THEN EXIT S ;

  15792 13 005014   005023 600000 13                 TZE     s:15796

     1821    15793    4         END ;

     1822    15794    3      END ;

  15794 13 005015   200304 235100                    LDA     ENT,,AUTO
        13 005016   000001 035007                    ADLA    1,DL
        13 005017   200304 755100                    STA     ENT,,AUTO
        13 005020   200304 235100                    LDA     ENT,,AUTO
        13 005021   000015 115007                    CMPA    13,DL
        13 005022   004753 602000 13                 TNC     s:15785

     1823    15795
     1824    15796    2      CALL INDEX ( I, ' .', STRING )

  15796 13 005023   200275 470500                    LDP0    @STRING,,AUTO
        13 005024   000000 120500                    SCD
        13 005025   000000 000170                    ADSC9   0,,PR0                   cn=0,n=120
        13 005026   000440 000002 12                 ADSC9   DEFAULT_END_TIME+12      cn=0,n=2
        13 005027   200005 000100                    ARG     I,,AUTO
        13 005030   005033 607000 13                 TTF     s:15798
        13 005031   200005 054100                    AOS     I,,AUTO
        13 005032   005042 710000 13                 TRA     s:15801

     1825    15797    3      WHENRETURN DO ;

     1826    15798    3         CALL INSERT ( STRING, I, , ' ' ) ;

  15798 13 005033   200005 720100                    LXL0    I,,AUTO
        13 005034   777607 620010                    EAX0    -121,X0
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:255  
        13 005035   777777 660003                    ERX0    -1,DU
        13 005036   200005 235100                    LDA     I,,AUTO
        13 005037   040145 100400                    MLR     fill='040'O
        13 005040   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        13 005041   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0

     1827    15799    3      END ;

     1828    15800
     1829    15801    2   END SETUP_FEP;

  15801 13 005042   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 005043   000001 702211                    TSX2  ! 1,X1

     1830    15802        %EJECT;
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:256  
     1831    15803    1   CONVERT_UTS: PROC (UTS, CHAR_AREA);

  15803 13 005044   200274 741300       CONVERT_UTS  STX1  ! TEMP_END_UTS+2,,AUTO

     1832    15804
     1833    15805    2   DCL UTS UBIN;
     1834    15806
     1835    15807    2   DCL 1 CHAR_AREA,
     1836    15808    2          2 DATE@ CHAR (8),
     1837    15809    2          2 COMMA CHAR (1),
     1838    15810    2          2 TIME@ CHAR (5);
     1839    15811
     1840    15812    2   DCL TIME@ CHAR (11);
     1841    15813
     1842    15814
     1843    15815        %FPT_TIME (SOURCE=UTS,
     1844    15816         DEST=LOCAL);
     1845    15835
     1846    15836    2      FPT_TIME.TSTAMP_ = VECTOR(UTS);

  15836 13 005045   777640 235007                    LDA     -96,DL
        13 005046   200275 236100                    LDQ     @UTS,,AUTO
        13 005047   005200 757000 11                 STAQ    FPT_TIME+8

     1847    15837    2      FPT_TIME.DATE_ = VECTOR(CHAR_AREA.DATE@);

  15837 13 005050   000140 235000 14                 LDA     96
        13 005051   200276 236100                    LDQ     @CHAR_AREA,,AUTO
        13 005052   005172 757000 11                 STAQ    FPT_TIME+2

     1848    15838    2      FPT_TIME.TIME_ = VECTOR(TIME@);

  15838 13 005053   000176 235000 14                 LDA     126
        13 005054   200334 452500                    STP2    KEEP_SCANNING+2,,AUTO
        13 005055   200334 236100                    LDQ     KEEP_SCANNING+2,,AUTO
        13 005056   000277 036003                    ADLQ    191,DU
        13 005057   005174 757000 11                 STAQ    FPT_TIME+4
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:257  

     1849    15839
     1850    15840    2      CALL M$TIME (FPT_TIME) ALTRET (TIME_URPED);

  15840 13 005060   005170 630400 11                 EPPR0   FPT_TIME
        13 005061   420004 713400                    CLIMB   alt,+8196
        13 005062   402000 401760                    pmme    nvectors=5
        13 005063   005065 702000 13                 TSX2    TIME_URPED

     1851    15841
     1852    15842    3      DO NEVER;

  15842 13 005064   005074 710000 13                 TRA     s:15851

     1853    15843
     1854    15844    3   TIME_URPED:
     1855    15845
     1856    15846    3         CHAR_AREA.DATE@ = '??/??/??';

  15846 13 005065   200276 470500       TIME_URPED   LDP0    @CHAR_AREA,,AUTO
        13 005066   040100 100400                    MLR     fill='040'O
        13 005067   000512 000010 12                 ADSC9   DEFAULT_END_TIME+54      cn=0,n=8
        13 005070   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1857    15847    3         CHAR_AREA.TIME@ = '??:??:??.??';

  15847 13 005071   040100 100400                    MLR     fill='040'O
        13 005072   000514 000005 12                 ADSC9   DEFAULT_END_TIME+56      cn=0,n=5
        13 005073   000002 200005                    ADSC9   2,,PR0                   cn=1,n=5

     1858    15848
     1859    15849    3      END;

     1860    15850
     1861    15851    2      CHAR_AREA.TIME@ = TIME@;

  15851 13 005074   200276 470500                    LDP0    @CHAR_AREA,,AUTO
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:258  
        13 005075   040100 100500                    MLR     fill='040'O
        13 005076   200277 000005                    ADSC9   TIME@,,AUTO              cn=0,n=5
        13 005077   000002 200005                    ADSC9   2,,PR0                   cn=1,n=5

     1862    15852    2      CHAR_AREA.COMMA = ',';

  15852 13 005100   040100 100400                    MLR     fill='040'O
        13 005101   000167 000001 14                 ADSC9   119                      cn=0,n=1
        13 005102   000002 000001                    ADSC9   2,,PR0                   cn=0,n=1

     1863    15853
     1864    15854    2      RETURN;

  15854 13 005103   200274 221300                    LDX1  ! TEMP_END_UTS+2,,AUTO
        13 005104   000001 702211                    TSX2  ! 1,X1
     1865    15855
     1866    15856    2   END CONVERT_UTS;
     1867    15857
     1868    15858    1   END;
     1869    15859        %EOD;

PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:259  
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   PS_PERR_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PSA$INIT.
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:260  

 **** Variables and constants ****

  ****  Section 006 RtLmCm PS_FDS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 PS_FDS

  ****  Section 007 RtLmCm PS_SELECT_RPN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1152)  r     1 PS_SELECT_RPN

  ****  Section 011  Data  PSA$INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  4234-0-0/d STRC(1080)  r     1 CLOSE_HLPCG             4176-0-0/d STRC(1080)  r     1 CLOSE_LO
  4470-0-0/d STRC(1080)  r     1 CLOSE_LOGFILE           4634-0-0/d STRC(1080)  r     1 CLOSE_M$SI
  4702-0-0/d STRC(144)   r     1 COMPARE_M$ME_AND_M$LO
  5032-0-0/d STRC(432)   r     1 CONVERT_TO_UTS          5160-0-0/c STRC(81)    r     1 DATE_AREA
  4162-0-0/d STRC(432)   r     1 ECHO_COMMAND            5110-0-0/d STRC(216)   r     1 FPT_EXIT
  4712-0-0/d STRC(864)   r     1 FPT_FID                 4706-0-0/d STRC(144)   r     1 FPT_INT
  5072-0-0/d STRC(504)   r     1 FPT_KEYIN               4526-0-0/d STRC(288)   r     1 FPT_SINPUT
  4536-0-0/d STRC(108)   r     1 FPT_SMOUSE              5170-0-0/d STRC(432)   r     1 FPT_TIME
  4754-0-0/d STRC(792)   r     1 FPT_UNFID               5016-0-0/d STRC(432)   r     1 GET_PS_TODAYS_DATE
  5002-0-0/d STRC(432)   r     1 GET_TODAYS_DATE         4304-0-0/d STRC(2088)  r     1 OPEN_LO
  4542-0-0/d STRC(2088)  r     1 OPEN_M$SI               4376-0-0/d STRC(2088)  r     1 OPEN_SI
  4144-0-0/d STRC(504)   r     1 READ_COMMAND            4676-0-0/d STRC(144)   r     1 SET_PM_PRIV
  5046-0-0/d STRC(360)   r     1 SET_PROMPT              5060-0-0/d STRC(360)   r     1 SET_TRAP_CONTROL
  4142-0-0/c STRC(54)    r     1 STATSNAME               5117-0-0/c CHAR(120)   r     1 STATUS_FID
  5116-0-0/b BIT         r     1 STRANGLING              5155-0-0/c STRC(99)    r     1 TIME_AREA
  5155-0-0/c CHAR(11)    r     1 TIME_AREA_C             5166-0-0/c CHAR(8)     r     1 TODAYS_DATE
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:261  
  4672-0-0/c STRC(81)    r     1 VLP_NAME                4742-0-0/d STRC(324)   r     1 VLR_FID
     0-0-0/d STRC(1404)  r     1 XUR_INIT
    50-0-0/d UBIN        r     1 XUR_WORK_AREA(0:1023)
  4272-0-0/d STRC(360)   r     1 ZAP_HEADER

  ****  Section 012 RoData PSA$INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   424-0-0/c CHAR(11)    r     1 DEFAULT_END_TIME         421-0-0/c CHAR(11)    r     1 DEFAULT_START_TIME
   413-0-0/c CHAR(16)    r     1 FEP_BLURT_FMT             12-0-0/w STRC(504)   r     1 FEP_DISP_MASKS
    30-0-0/w PTR         r     1 FEP_DISP_MASKS$            7-0-0/w STRC(72)    r     1 FEP_DISP_MODE_MASKS
    31-0-0/w CHAR(16)    r     1 FEP_DISP_TOKENS(0:13)
   121-0-0/w STRC(468)   r     1 FEP_SLCT_MASKS           136-0-0/w PTR         r     1 FEP_SLCT_MASKS$
    11-0-0/w STRC        r     1 FEP_SLCT_MODE_MASKS
   137-0-0/w CHAR(16)    r     1 FEP_SLCT_TOKENS(0:12)
   417-0-0/c CHAR        r     1 STATS_PROMPT             375-0-0/c CHAR(15)    r     1 STATUS_DI_FMT
   407-0-0/c CHAR(13)    r     1 STATUS_FEPN_FMT          404-0-0/c CHAR(10)    r     1 STATUS_FEPS_FMT
   357-0-0/c STRC(486)   r     1 STATUS_FORMAT            401-0-0/c CHAR(9)     r     1 STATUS_LOG_FMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   275-0-0/w PTR         r     1 @BLOCK_NUM               276-0-0/w PTR         r     1 @CHAR_AREA
   275-0-0/w PTR         r     1 @CMD$BLK                 277-0-0/w PTR         r     1 @DEFAULT_TIME
   275-0-0/w PTR         r     1 @FEPMASK                 311-0-0/w PTR         r     1 @FLAG
   276-0-0/w PTR         r     1 @FLAGS                   276-0-0/w PTR         r     1 @FLAGS
   276-0-0/w PTR         r     1 @FLAGS                   322-0-0/w PTR         r     1 @HIGH
   276-0-0/w PTR         r     1 @I                       321-0-0/w PTR         r     1 @LOW
   277-0-0/w PTR         r     1 @MASKS                   276-0-0/w PTR         r     1 @NODE$
   324-0-0/w PTR         r     1 @POINTS                  277-0-0/w PTR         r     1 @POINTS
   323-0-0/w PTR         r     1 @SCALE                   275-0-0/w PTR         r     1 @SEGMENT$
   276-0-0/w PTR         r     1 @SEGSIZE                 307-0-0/w PTR         r     1 @STRING
   275-0-0/w PTR         r     1 @STRING                  275-0-0/w PTR         r     1 @STRING
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:262  
   276-0-0/w PTR         r     1 @TIME$BLK                301-0-0/w PTR         r     1 @TIME$BLK
   301-0-0/w PTR         r     1 @TIME$BLK                310-0-0/w PTR         r     1 @TOKEN
   275-0-0/w PTR         r     1 @UTS                     275-0-0/w PTR         r     1 @UTS_RESULT
   325-0-0/w PTR         r     1 @VALUE                   315-0-0/w PTR         r     1 BLOCK$
    *0-0-0/w UBIN        r     1 BLOCK_NUM                 13-0-0/w UBIN        r     1 CHANGE_MODE
    *0-0-0/c STRC(126)   r     1 CHAR_AREA                  4-0-0/w PTR         r     1 CMD$
    *0-0-0/w STRC(144)   r     1 CMD$BLK                  277-0-0/w UBIN        r     1 CODA
   312-0-0/w UBIN        r     1 CPOS                      *0-0-0/c CHAR(11)    r     1 DEFAULT_TIME
    20-0-0/w STRC        r     1 DISP                     306-0-0/b BIT         r     1 DOING_ALL
   327-0-0/w SBIN        r     1 DX                       304-0-0/w UBIN        r     1 ENT
     4-0-0/w STRC        r     1 ERR                      330-0-0/w UBIN        r     1 FACTOR
   330-0-0/w SBIN        r     1 FACTOR_SBIN               *0-0-0/w STRC        r     1 FEPMASK
    15-0-0/w PTR         r     1 FEP_FLAGS$                17-0-0/w UBIN        r     1 FEP_IX
    *0-0-0/b BIT         r     1 FLAG                      *0-0-0/b STRC(2)     r     1 FLAGS
    *0-0-0/w BIT         r     1 FLAGS                     *0-0-0/w STRC(144)   r     1 FLAGS
    14-0-0/w PTR         r     1 FLAGS$                    22-0-0/c CHAR(8)     r     1 HANDLER
    *0-0-0/w UBIN        r     1 HIGH                     302-0-0/w UBIN        r     1 HIGH
     5-0-0/w UBIN        r     1 I                        326-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 I                        302-0-0/w UBIN        r     1 I
   302-0-0/w UBIN        r     1 I                        300-0-0/w UBIN        r     1 IT
    16-0-0/w UBIN        r     1 IX                         6-0-0/w SBIN        r     1 J
   300-0-0/w UBIN        r     1 J                        303-0-0/w UBIN        r     1 J
   303-0-0/w UBIN        r     1 J                        332-0-0/b BIT         r     1 KEEP_SCANNING
    *0-0-0/w UBIN        r     1 LOW                      301-0-0/w UBIN        r     1 LOW
   277-0-0/w STRC(162)   r     1 MASK                      *0-0-0/w STRC        r     1 MASKS(0:0)
   331-0-0/w UBIN        r     1 MFACTOR                  331-0-0/w SBIN        r     1 MFACTOR_SBIN
    *0-0-0/w PTR         r     1 NODE$                     12-0-0/w UBIN        r     1 OPTN
    24-0-0/w PTR         r     1 P$                       316-0-0/w PTR         r     1 P$
    *0-0-0/w UBIN        r     1 POINTS                    *0-0-0/w UBIN        r     1 POINTS
    *0-0-0/w SBIN        r     1 POINTS_SBIN              317-0-0/w PTR         r     1 Q$
    *0-0-0/w UBIN        r     1 SCALE                    303-0-0/w UBIN        r     1 SCALE
    *0-0-0/w PTR         r     1 SEGMENT$                  *0-0-0/w UBIN        r     1 SEGSIZE
    21-0-0/w STRC        r     1 SLCT                      25-0-0/c CHAR(120)   r     1 STATUS_MISC
   133-0-0/c CHAR(120)   r     1 STATUS_SELECT            121-0-0/c CHAR(40)    r     1 STATUS_TIME
    *0-0-0/c CHAR(120)   r     1 STRING                    *0-0-0/c CHAR(120)   r     1 STRING
    *0-0-0/c CHAR(120)   r     1 STRING                   272-0-0/w UBIN        r     1 TEMP_END_UTS
   271-0-0/w UBIN        r     1 TEMP_START_UTS            *0-0-0/w STRC(144)   r     1 TIME$BLK
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:263  
    *0-0-0/w STRC(144)   r     1 TIME$BLK                  *0-0-0/w STRC(144)   r     1 TIME$BLK
   277-0-0/c CHAR(11)    r     1 TIME@                     *0-0-0/c CHAR(15)    r     1 TOKEN
   313-0-0/w UBIN        r     1 TOKEN_LEN                 *0-0-0/w UBIN        r     1 UTS
    *0-0-0/w UBIN        r     1 UTS_RESULT                *0-0-0/w UBIN        r     1 VALUE(0:0)

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c STRC(63)    r     1 B_VERSION                  0-0-0/c CHAR(140)   r     1 PS_BUFFER
     0-0-0/w BIT         r     1 PS_CMDS                    0-0-0/c CHAR(255)   r     1 PS_COMMAND
     0-0-0/w STRC(11)    r     1 PS_DEFAULT_DISPLAY_FLAGS
     0-0-0/d STRC(621)   r     1 PS_DEFAULT_FILE_PARAMS
     0-0-0/w UBIN        r     1 PS_DEFAULT_INTERVAL        0-0-0/w STRC(11)    r     1 PS_DEFAULT_LOG_FLAGS
     0-0-0/w STRC(11)    r     1 PS_DISPLAY_FLAGS           0-0-0/w UBIN        r     1 PS_END_UTS
     0-0-0/w STRC        r     1 PS_ERR                     0-0-0/w PTR         r     1 PS_FEP$
     0-0-0/b BIT         r     1 PS_FEPING                  0-0-0/w UBIN        r     1 PS_FEPNO
     0-0-0/w STRC(144)   r     1 PS_FEP_DISP_FLAGS(0:99)
     0-0-0/w STRC(144)   r     1 PS_FEP_LOG_FLAGS(0:99)
     0-0-0/w UBIN        r     1 PS_FEP_SIZE                0-0-0/d STRC(621)   r     1 PS_FID_PARAMS
     0-0-0/d STRC(621)   r     1 PS_FILE_PARAMS             0-0-0/w UBIN        r     1 PS_GRAPHS
     0-0-0/w SBIN        r     1 PS_GRAPH_PEAK(0:9)
     0-0-0/b STRC(8)     r     1 PS_HISTOGRAM_FLAGS         0-0-0/w STRC(14760) r     1 PS_HLPCGBUF
     0-0-0/b BIT         r     1 PS_INPUTTING               0-0-0/w UBIN        r     1 PS_INTERVAL
     0-0-0/w PTR         r     1 PS_LOGFILE$                0-0-0/w SBIN        r     1 PS_LOGFILE_SIZE
     0-0-0/w STRC(11)    r     1 PS_LOG_FLAGS               0-0-0/w UBIN        r     1 PS_MODE
     0-0-0/w PTR         r     1 PS_MOUSE$                  0-0-0/b BIT         r     1 PS_MOUSEING
     0-0-0/w SBIN        r     1 PS_MOUSE_SIZE
     0-0-0/w SBIN        r     1 PS_NEEDED_LOGFILE_SIZE
     0-0-0/w SBIN        r     1 PS_NEEDED_MOUSE_SIZE       0-0-0/w SBIN        r     1 PS_NEEDED_PMDAT_SIZE
     0-0-0/w PTR         r     1 PS_OLD_FEP$                0-0-0/w UBIN        r     1 PS_OLD_FEP_SIZE
     0-0-0/w PTR         r     1 PS_OLD_MOUSE$              0-0-0/w SBIN        r     1 PS_OLD_MOUSE_SIZE
     0-0-0/w PTR         r     1 PS_OLD_PMDAT$              0-0-0/w SBIN        r     1 PS_OLD_PMDAT_SIZE
     0-0-0/w PTR         r     1 PS_PMDAT$                  0-0-0/w SBIN        r     1 PS_PMDAT_SIZE
     0-0-0/w UBIN        r     1 PS_PUNT_COUNT              0-0-0/w UBIN        r     1 PS_START_UTS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:264  
     0-0-0/w PTR         r     1 PS_STATS$                  0-0-0/w UBIN        r     1 PS_STATS_EXPRESSIONS
     0-0-0/w UBIN        r     1 PS_STATS_SIZE              0-0-0/w UBIN        r     1 PS_STEPCC
     0-0-0/w UBIN        r     1 PS_SUMMARY_ITEMS
     0-0-0/w UBIN        r     1 PS_SUMMARY_LIST(0:19)
     0-0-0/c CHAR(10)    r     1 PS_TODAYS_DATE             0-0-0/w STRC(11)    r     1 PS_WORKING_FLAGS
     0-0-0/w STRC(180)   r     1 V_TABLE(0:0)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$EXCFR                    0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d STRC(108)   r     1 BASED_BUCKET
     0-0-0/w STRC(72)    r     1 BASED_RPN                  0-0-0/c ASTR(9)     r     1 B_VERSION_
     0-0-0/w STRC(144)   r     1 ENTRY$BLK                  0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 F$LOG
     0-0-0/w STRC        r     1 FEP_MASK(0:0)
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$HLPCG
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(11)    r     1 PS_BASED_FLAGS
     0-0-0/w STRC(144)   r     1 PS_FEP_BASED_FLAGS(0:99)
     0-0-0/w UBIN        r     1 PS_PLOT_VALUES(0:0)
     0-0-0/w STRC(432)   r     1 PS_STATS(0:0)
     0-0-0/c ASTR(9)     r     1 TEXTC


   Procedure PSA$INIT requires 2629 words for executable code.
   Procedure PSA$INIT requires 242 words of local(AUTO) storage.
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:265  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:266  
          MINI XREF LISTING

ALL_CLEAR
     13887**LABEL   13887--CALLALT
B$ALT.CODE
      9982**DCL      9982--REDEF    9983--REDEF    9983--REDEF
B$ALT.ERR.ERR#
      9984**DCL      9984--REDEF
B$ALT.EVID
      9983**DCL      9983--REDEF    9983--REDEF
B$EXCFR.ASL
      9962**DCL      9962--REDEF
B$EXCFR.ERR
      9976**DCL     13898>>IF
B$EXCFR.ERR.ERR#
      9976**DCL      9976--REDEF
B$EXCFR.EVID
      9975**DCL      9975--REDEF    9976--REDEF
B$EXCFR.IR
      9963**DCL      9963--REDEF
B$EXCFR.PREVSZ
      9962**DCL      9962--REDEF
B$EXCFR.SUBC
      9974**DCL      9974--REDEF    9975--REDEF    9975--REDEF
B$JIT.CPFLAGS1.SLEAZE
      6322**DCL      6322--REDEF
B$JIT.ERR.MID
      6229**DCL      6229--REDEF
B$JIT.JRESPEAK
      6390**DCL      6391--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6499**DCL      6499--REDEF    6500--REDEF
B$JIT.PNR
      6403**DCL      6403--REDEF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:267  
B$JIT.PRIV.ACTIVE
      6229**DCL     15175>>IF
B$JIT.TSLINE
      6497**DCL      6498--REDEF
B$JIT$
     11194**DCL      6223--IMP-PTR 15175>>IF
B$TCB.ALT$
      9958**DCL     13898>>IF      13898>>IF
B$TCB$
     11193**DCL      9958--IMP-PTR 13898>>IF      13898>>IF
BAILOUT
     13887**LABEL   13830--CALLALT 13866--CALLALT 13879--CALLALT 13941--GOTO    14170--CALLALT 14293--CALLALT
     14312--CALLALT
BASED_BUCKET.DATA
     11305**DCL     15162<>CALL
BASED_BUCKET.SIZE
     11303**DCL     15162<>CALL
BASED_RPN
     11290**DCL     15099<>CALL
BASED_RPN.INFO.SYMBOL_FOUND#
     11294**DCL     15112<<ASSIGN
BASED_RPN.INFO.SYMBOL_ID#
     11295**DCL     15102>>ASSIGN  15113<<ASSIGN
BASED_RPN.INFO.USED#
     11293**DCL     15114<<ASSIGN
BASED_RPN.ITEM.ARG#
     11298**DCL     15116<<ASSIGN
BASED_RPN.ITEM.OPCODE#
     11297**DCL     15115<<ASSIGN
BLOCK$ IN PROCEDURE SETUP_STATS_ENTRY
     15088**DCL     15038--IMP-PTR 15095<<ASSIGN  15099>>CALL    15124>>IF      15128>>ASSIGN
BLOCK_NUM IN PROCEDURE SET_FLAGS
     14946**DCL     14944--PROC    14955>>IF      14959>>ASSIGN
B_VERSION
     13731**DCL     13828--CALL
B_VERSION.L
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:268  
     13732**DCL     13736--IMP-SIZ 13828>>CALL
B_VERSION_.C
     13736**DCL     13828--CALL
CHANGE_MODE
     11314**DCL     13957<<ASSIGN  13962<<ASSIGN  13966<<ASSIGN  13985>>IF      14130>>DOCASE  14786>>DOCASE
CHAR_AREA IN PROCEDURE CONVERT_UTS
     15807**DCL     15803--PROC
CHAR_AREA.COMMA IN PROCEDURE CONVERT_UTS
     15809**DCL     15852<<ASSIGN
CHAR_AREA.DATE@ IN PROCEDURE CONVERT_UTS
     15808**DCL     15837--ASSIGN  15846<<ASSIGN
CHAR_AREA.TIME@ IN PROCEDURE CONVERT_UTS
     15810**DCL     15847<<ASSIGN  15851<<ASSIGN
CHECK_FOR_EXPM
     15173**PROC    14278--CALL    14304--CALL
CLOSE_HLPCG
     10333**DCL     13866<>CALL
CLOSE_HLPCG.SN_
     10333**DCL     10333--REDEF
CLOSE_HLPCG.UTL_
     10334**DCL     10334--REDEF
CLOSE_HLPCG.V
     10338**DCL     10333--DCLINIT
CLOSE_HLPCG.V.EXPIRE#
     10348**DCL     10348--REDEF
CLOSE_HLPCG.V.TYPE#
     10346**DCL     10346--REDEF
CLOSE_HLPCG.V.XTNSIZE#
     10343**DCL     10343--REDEF   10345--REDEF
CLOSE_LO
     10288**DCL     14216<>CALL
CLOSE_LO.SN_
     10288**DCL     10288--REDEF
CLOSE_LO.UTL_
     10289**DCL     10289--REDEF
CLOSE_LO.V
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:269  
     10293**DCL     10288--DCLINIT
CLOSE_LO.V.EXPIRE#
     10303**DCL     10303--REDEF
CLOSE_LO.V.TYPE#
     10301**DCL     10301--REDEF
CLOSE_LO.V.XTNSIZE#
     10298**DCL     10298--REDEF   10300--REDEF
CLOSE_LOGFILE
     10625**DCL     13879<>CALL
CLOSE_LOGFILE.SN_
     10625**DCL     10625--REDEF
CLOSE_LOGFILE.UTL_
     10626**DCL     10626--REDEF
CLOSE_LOGFILE.V
     10630**DCL     10625--DCLINIT
CLOSE_LOGFILE.V.EXPIRE#
     10640**DCL     10640--REDEF
CLOSE_LOGFILE.V.TYPE#
     10638**DCL     10638--REDEF
CLOSE_LOGFILE.V.XTNSIZE#
     10635**DCL     10635--REDEF   10637--REDEF
CLOSE_M$SI.SN_
     10837**DCL     10837--REDEF
CLOSE_M$SI.UTL_
     10838**DCL     10838--REDEF
CLOSE_M$SI.V
     10842**DCL     10837--DCLINIT
CLOSE_M$SI.V.EXPIRE#
     10852**DCL     10852--REDEF
CLOSE_M$SI.V.TYPE#
     10850**DCL     10850--REDEF
CLOSE_M$SI.V.XTNSIZE#
     10847**DCL     10847--REDEF   10849--REDEF
CMD$
     11242**DCL     11202--IMP-PTR 11243--REDEF   13912<>CALL    13946>>DOCASE  13952>>DOCASE  13970>>DOCASE
     13994>>DOWHILE 13996>>DOCASE  14041>>CALL    14043>>CALL    14046>>IF      14048>>IF      14056>>IF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:270  
     14063>>DOINDEX 14066>>CALLBLT 14066>>CALLBLT 14155>>DOINDEX 14157>>CALLBLT 14157>>CALLBLT 14168>>ASSIGN
     14168>>ASSIGN  14180>>IF      14183>>IF      14191>>DOCASE  14203>>CALLBLT 14203>>CALLBLT 14226>>IF
     14240>>DOINDEX 14242>>DOCASE  14280>>DOINDEX 14282>>DOCASE  14286>>IF      14290>>CALLBLT 14290>>CALLBLT
     14306>>DOINDEX 14308>>DOCASE  14321>>ASSIGN  14328>>ASSIGN  14347>>DOINDEX 14349>>DOCASE  14380>>IF
     14389>>ASSIGN  14428>>DOCASE  14436>>CALL    14443>>IF      14447>>ASSIGN  14453>>CALL    14457>>IF
     14469>>ASSIGN  14476>>CALL    14479>>CALL    14503>>ASSIGN  14503>>ASSIGN  14513>>CALL    14611>>CALL
     14955>>IF      14959>>ASSIGN
CMD$BLK IN PROCEDURE SETUP_STATS_ENTRY
     14992**DCL     14984--PROC
CMD$BLK.NSUBLKS IN PROCEDURE SETUP_STATS_ENTRY
     15004**DCL     15092>>IF
CMD$BLK.SUBLK$ IN PROCEDURE SETUP_STATS_ENTRY
     15025**DCL     15095>>ASSIGN
CODA IN PROCEDURE SET_FLAGS
     14953**DCL     14957<<ASSIGN  14959<<ASSIGN  14961>>DOCASE
COMPARE_M$ME_AND_M$LO
     10916**DCL     13931<>CALL    14603<>CALL
COMPARE_M$ME_AND_M$LO.V
     10916**DCL     10916--DCLINIT
COMPLAINT
     13762**DCL     13766--REDEF
COMPLAINT.STRING
     13764**DCL     13765--REDEF
CONVERT_TO_UTS
     11075**DCL     15260<>CALL
CONVERT_TO_UTS.TSTAMP_
     11078**DCL     15258<<ASSIGN
CONVERT_TO_UTS.V
     11079**DCL     11075--DCLINIT
CONVERT_UTS
     15803**PROC    14550--CALL    14558--CALL    14562--CALL
CPOS IN PROCEDURE INSERT_TOKEN
     15395**DCL     15405<<CALLBLT 15407>>IF      15409<<ASSIGN  15411>>IF      15415>>CALLBLT
D IN PROCEDURE SETUP_FEP
     15772**LABEL   15777--EXIT
DATE_AREA.PORTION
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:271  
     13776**DCL     13779--REDEF
DATE_AREA.PORTION.DIGITS
     13777**DCL     15322<<CALLBLT
DATE_AREA.VECTOR_PORTION.REAL
     13780**DCL     11075--DCLINIT 11076--DCLINIT 15234<<ASSIGN
DEFAULT_END_TIME
     13789**DCL     14403<>CALL    14413<>CALL
DEFAULT_START_TIME
     13788**DCL     14400<>CALL    14408<>CALL
DEFAULT_TIME IN PROCEDURE SET_TIME
     15231**DCL     15183--PROC    15233>>ASSIGN
DISP
     11371**DCL     14041<>CALL    14047<<ASSIGN  14047>>ASSIGN  14049<<ASSIGN  14049>>ASSIGN  14790>>ASSIGN
     14796>>ASSIGN  14804>>ASSIGN
DOING_ALL IN PROCEDURE SETUP_STATS_ENTRY
     15086**DCL     15097<<ASSIGN  15108<<ASSIGN  15124>>IF
DONT_OUTPUT_TO_M$LO
     13939**LABEL   13931--CALLALT
DX IN PROCEDURE GENERATE_SCALE
     14825**DCL     14858<<ASSIGN  14864>>DOWHILE 14888<<ASSIGN  14894>>IF      14894>>IF      14899<<ASSIGN
     14899>>ASSIGN  14904>>IF      14907<<ASSIGN  14913>>ASSIGN
ECHO_COMMAND.STATION_
     10250**DCL     10250--REDEF
ECHO_COMMAND.V
     10251**DCL     10248--DCLINIT
ECHO_COMMAND.V.DVBYTE.VFC#
     10257**DCL     10257--REDEF
ENT IN PROCEDURE SETUP_FEP
     15755**DCL     15772<<DOINDEX 15773>>IF      15773>>IF      15775>>CALL    15776>>ASSIGN  15784<<DOINDEX
     15785>>IF      15785>>IF      15787>>IF      15790>>CALL    15791>>ASSIGN
ENTRY$BLK.NSUBLKS IN PROCEDURE SETUP_STATS_ENTRY
     15050**DCL     15124>>IF
ENTRY$BLK.SUBLK$ IN PROCEDURE SETUP_STATS_ENTRY
     15071**DCL     15099>>CALL    15128>>ASSIGN
ERR
     11243**DCL     13925<>CALL    13939<>CALL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:272  
ERR.CODE
     11247**DCL     13922>>IF
ERR.MON
     11246**DCL     13922>>IF
F$DCB.ACTPOS
      5951**DCL      5951--REDEF
F$DCB.ARS
      5926**DCL      5926--REDEF
F$DCB.ATTR
      5944**DCL      5945--REDEF
F$DCB.BORROW
      5959**DCL      5959--REDEF    5959--REDEF    5959--REDEF
F$DCB.DCBNAME.L
      5973**DCL      5973--IMP-SIZ
F$DCB.EOMCHAR
      5930**DCL      5930--REDEF
F$DCB.FCD
      5939**DCL     13865>>IF      13877>>IF      13881>>IF
F$DCB.FLDID
      5954**DCL      5954--REDEF
F$DCB.FORM$
      5948**DCL      5948--REDEF
F$DCB.FSECT
      5964**DCL      5964--REDEF
F$DCB.FSN
      5941**DCL      5941--REDEF    5941--REDEF    5942--REDEF
F$DCB.HEADER$
      5947**DCL      5947--REDEF
F$DCB.IXTNSIZE
      5945**DCL      5945--REDEF
F$DCB.LASTSTA$
      5935**DCL      5935--REDEF
F$DCB.LVL
      5960**DCL      5960--REDEF
F$DCB.NAME.C
      5935**DCL      5935--REDEF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:273  
F$DCB.NOEOF
      5956**DCL      5956--REDEF
F$DCB.NRECS
      5946**DCL      5946--REDEF
F$DCB.NRECX
      5965**DCL      5965--REDEF
F$DCB.OHDR
      5957**DCL      5957--REDEF
F$DCB.ORG
      5940**DCL      5940--REDEF
F$DCB.PRECNO
      5963**DCL      5963--REDEF
F$DCB.RCSZ
      5968**DCL      5968--REDEF
F$DCB.RES
      5936**DCL      5936--REDEF
F$DCB.SETX
      5948**DCL      5948--REDEF
F$DCB.TAB$
      5947**DCL      5948--REDEF
F$DCB.TDA
      5962**DCL      5962--REDEF
F$DCB.WSN
      5937**DCL      5937--REDEF
F$LOG
        16**DCL     13877--IF
FACTOR IN PROCEDURE GENERATE_SCALE
     14826**DCL     14827--REDEF   14840<<ASSIGN  14842<<ASSIGN  14846>>ASSIGN  14846>>ASSIGN  14857<<ASSIGN
     14870>>ASSIGN  14881>>ASSIGN  14904>>IF      14913<<ASSIGN  14913>>ASSIGN  14924<<ASSIGN  14930>>ASSIGN
FACTOR_SBIN IN PROCEDURE GENERATE_SCALE
     14827**DCL     14846>>ASSIGN
FEPBITS
     14629**PROC    14041--CALL    14043--CALL
FEPMASK IN PROCEDURE FEPBITS
     14684**DCL     14629--PROC    14767<<ASSIGN  14771<<ASSIGN  14780<<ASSIGN  14780>>ASSIGN
FEP_BLURT_FMT
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:274  
     13753**DCL     14625--CALL
FEP_DISP_MASKS
     11994**DCL     12866--DCLINIT 14041<>CALL    15772--DOINDEX
FEP_DISP_MASKS$
     12866**DCL     15773>>IF      15773>>IF      15776>>ASSIGN
FEP_DISP_MODE_MASKS.EXTENDED
     11989**DCL     14049>>ASSIGN  15766>>IF      15766>>IF      15769>>ASSIGN
FEP_DISP_MODE_MASKS.SUMMARY
     11988**DCL     14047>>ASSIGN  15761>>IF      15761>>IF      15764>>ASSIGN
FEP_DISP_TOKENS
     12868**DCL     15775<>CALL
FEP_FLAGS$
     11316**DCL     13976<<ASSIGN  13981<<ASSIGN  13987>>ASSIGN  14790>>ASSIGN  14791>>ASSIGN  14792>>ASSIGN
     14796>>ASSIGN  14796>>ASSIGN  14798>>ASSIGN  14798>>ASSIGN  14800>>ASSIGN  14804>>ASSIGN  14804>>ASSIGN
     14806>>ASSIGN  14806>>ASSIGN  14809>>ASSIGN
FEP_IX
     11318**DCL     14570<<DOINDEX 14571>>IF      14572>>CALL    14573--CALL    14582<<DOINDEX 14583>>IF
     14584>>CALL    14585--CALL
FEP_MASK
     11453**DCL     15772--DOINDEX 15773>>IF      15773>>IF      15776>>ASSIGN  15784--DOINDEX 15785>>IF
     15785>>IF      15791>>ASSIGN
FEP_SLCT_MASKS
     12884**DCL     13688--DCLINIT 14043<>CALL    15784--DOINDEX
FEP_SLCT_MASKS$
     13688**DCL     15785>>IF      15785>>IF      15791>>ASSIGN
FEP_SLCT_MODE_MASKS.HANDLER
     11992**DCL     14808>>IF
FEP_SLCT_TOKENS
     13690**DCL     15790<>CALL
FLAG IN PROCEDURE INSERT_TOKEN
     15393**DCL     15389--PROC    15398--IF      15398>>IF
FLAGS IN PROCEDURE SETUP_FEP
     15485**DCL     15482--PROC    15758>>ASSIGN
FLAGS IN PROCEDURE SETUP_TOKENS
     15425**DCL     15422--PROC    15432--IF      15432--IF      15432--IF      15432--IF      15432--IF
     15432--IF      15432--IF      15432--IF      15432--IF      15438--IF      15438--IF      15448--CALL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:275  
     15449--CALL    15450--CALL    15451--CALL    15452--CALL    15453--CALL    15454--CALL    15455--CALL
     15456--CALL    15463--CALL
FLAGS IN PROCEDURE SET_FLAGS
     14949**DCL     14944--PROC
FLAGS.ALL IN PROCEDURE SET_FLAGS
     14951**DCL     14966<<ASSIGN  14971<<ASSIGN  14976<<ASSIGN
FLAGS.SNAP IN PROCEDURE SET_FLAGS
     14950**DCL     14965<<ASSIGN  14970<<ASSIGN  14975<<ASSIGN
FLAGS$
     11315**DCL     13975<<ASSIGN  13980<<ASSIGN  14134>>ASSIGN  14138>>ASSIGN  14138>>ASSIGN  14143>>ASSIGN
     14143>>ASSIGN
FPT_EXIT
     11188**DCL     14219<>CALL
FPT_EXIT.V
     11188**DCL     11188--DCLINIT
FPT_EXIT.V.STEPCC#
     11189**DCL     11189--REDEF   14218<<ASSIGN
FPT_FID
     10958**DCL     14170<>CALL
FPT_FID.TEXTFID_
     10958**DCL     14168<<ASSIGN
FPT_FID.V
     10962**DCL     10958--DCLINIT
FPT_INT
     10931**DCL     13830<>CALL
FPT_INT.V
     10931**DCL     10931--DCLINIT
FPT_KEYIN
     11168**DCL     14505<>CALL
FPT_KEYIN.MESS_
     11168**DCL     14503<<ASSIGN
FPT_KEYIN.V
     11171**DCL     11168--DCLINIT
FPT_SINPUT.V
     10673**DCL     10663--DCLINIT
FPT_SMOUSE
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:276  
     10694**DCL     14293<>CALL
FPT_SMOUSE.V
     10694**DCL     10694--DCLINIT
FPT_SMOUSE.V.SYSID#
     10694**DCL     14288<<ASSIGN  14290<<CALLBLT
FPT_TIME IN PROCEDURE CONVERT_UTS
     15827**DCL     15840<>CALL
FPT_TIME.DATE_ IN PROCEDURE CONVERT_UTS
     15827**DCL     15837<<ASSIGN
FPT_TIME.TIME_ IN PROCEDURE CONVERT_UTS
     15829**DCL     15838<<ASSIGN
FPT_TIME.TSTAMP_ IN PROCEDURE CONVERT_UTS
     15830**DCL     15836<<ASSIGN
FPT_TIME.V IN PROCEDURE CONVERT_UTS
     15831**DCL     15827--DCLINIT
FPT_UNFID
     11006**DCL     14523<>CALL
FPT_UNFID.V
     11010**DCL     11006--DCLINIT
FREESEG
     13845**PROC    13868--CALL    13869--CALL    13870--CALL    13871--CALL    13872--CALL    13873--CALL
     13874--CALL    13875--CALL
GENERATE_SCALE
     14815**PROC    15162--CALL    15166--CALL
GET_PS_TODAYS_DATE
     11051**DCL     13822<>CALL
GET_PS_TODAYS_DATE.V
     11055**DCL     11051--DCLINIT
GET_TODAYS_DATE
     11028**DCL     14394<>CALL
GET_TODAYS_DATE.V
     11032**DCL     11028--DCLINIT
HANDLER
     11451**DCL     14768<<ASSIGN  14777<<ASSIGN  14792>>ASSIGN  14800>>ASSIGN
HIGH IN PROCEDURE GENERATE_SCALE
     14818**DCL     14815--PROC    14838>>IF      14846>>ASSIGN  14885>>IF      14894>>IF      14894>>IF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:277  
     14924>>ASSIGN
HIGH IN PROCEDURE SETUP_STATS_ENTRY
     15082**DCL     15159<<ASSIGN  15162<>CALL    15166<>CALL
I
     11308**DCL     14155<<DOINDEX 14157>>CALLBLT 14157>>CALLBLT 14240<<DOINDEX 14242>>DOCASE  14280<<DOINDEX
     14282>>DOCASE  14286>>IF      14290>>CALLBLT 14290>>CALLBLT 14306<<DOINDEX 14308>>DOCASE  14326<<DOINDEX
     14328>>ASSIGN  14328>>ASSIGN  14347<<DOINDEX 14349>>DOCASE  14357<>CALL    14361<>CALL    14365<>CALL
     14369<>CALL    14451<<DOINDEX 14453<>CALL    14474<<DOINDEX 14476>>CALL    14479>>CALL    14482>>ASSIGN
     14537<>CALL    15471<<CALLBLT 15472>>CALLBLT 15781<<CALLBLT 15782>>CALLBLT 15796<<CALLBLT 15798>>CALLBLT
I IN PROCEDURE GENERATE_SCALE
     14824**DCL     14844<<DOINDEX 14846>>ASSIGN  14846>>ASSIGN  14849>>IF      14849>>IF      14851>>ASSIGN
     14851>>ASSIGN  14873<<DOINDEX 14875>>ASSIGN  14877>>IF      14877>>IF      14879>>ASSIGN  14879>>ASSIGN
     14928<<DOINDEX 14930>>ASSIGN  14930>>ASSIGN  14932>>IF      14932>>IF      14934>>ASSIGN  14934>>ASSIGN
I IN PROCEDURE MOVE_DATE
     15316**DCL     15319<<DOINDEX 15321>>CALLBLT 15321>>CALLBLT 15322>>CALLBLT
I IN PROCEDURE MOVE_TIME
     15376**DCL     15379<<DOINDEX 15381>>CALLBLT 15381>>CALLBLT 15382>>CALLBLT
I IN PROCEDURE SETUP_STATS_ENTRY
     15077**DCL     14984--PROC    15092>>IF      15095>>ASSIGN  15099>>CALL    15102>>ASSIGN  15110>>ASSIGN
     15112>>ASSIGN  15113>>ASSIGN  15114>>ASSIGN  15115>>ASSIGN  15116>>ASSIGN  15120>>ASSIGN  15121>>ASSIGN
     15122>>ASSIGN  15138>>CALLBLT 15141>>CALLBLT 15144>>IF      15144>>IF      15150>>ASSIGN  15158>>ASSIGN
     15159>>ASSIGN  15160>>ASSIGN  15162>>CALL    15162>>CALL    15166>>CALL
INSERT_TOKEN
     15389**PROC    15442--CALL    15448--CALL    15449--CALL    15450--CALL    15451--CALL    15452--CALL
     15453--CALL    15454--CALL    15455--CALL    15456--CALL    15463--CALL    15763--CALL    15768--CALL
     15775--CALL    15788--CALL    15790--CALL
INVALID_COMMAND
     13922**LABEL   13912--CALLALT
IT IN PROCEDURE FEPBITS
     14765**DCL     14773<<DOINDEX 14775>>IF      14777>>ASSIGN  14777>>ASSIGN  14780>>ASSIGN
IX
     11317**DCL     14063<<DOINDEX 14066>>CALLBLT 14066>>CALLBLT
J
     11309**DCL     14157<<CALLBLT 14158>>ASSIGN
J IN PROCEDURE MOVE_DATE
     15317**DCL     15321<<CALLBLT 15322>>CALLBLT
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:278  
J IN PROCEDURE MOVE_TIME
     15377**DCL     15381<<CALLBLT 15382>>CALLBLT
J IN PROCEDURE SETUP_STATS_ENTRY
     15080**DCL     15102<<ASSIGN  15110<<ASSIGN  15113>>ASSIGN  15116>>ASSIGN  15120>>ASSIGN  15121>>ASSIGN
     15122>>ASSIGN  15130<<DOINDEX 15132>>ASSIGN
KEEP_SCANNING IN PROCEDURE GENERATE_SCALE
     14830**DCL     14866<<ASSIGN  14868>>DOWHILE 14889<<ASSIGN  14898<<ASSIGN  14908<<ASSIGN
LOW IN PROCEDURE GENERATE_SCALE
     14817**DCL     14815--PROC    14836>>ASSIGN  14838>>IF      14846>>ASSIGN  14846>>ASSIGN  14860>>IF
     14862<<ASSIGN  14871>>ASSIGN  14875>>ASSIGN  14924>>ASSIGN  14926>>ASSIGN  14930>>ASSIGN  14930>>ASSIGN
LOW IN PROCEDURE SETUP_STATS_ENTRY
     15081**DCL     15158<<ASSIGN  15162<>CALL    15166<>CALL
L_FEPING
     14085**LABEL   14081--GOTO
M$CLOSE
      5853**DCL-ENT 13866--CALL    13879--CALL    14216--CALL
M$CLRSTK
      5911**DCL-ENT 13887--CALL
M$CORRES
      5858**DCL-ENT 13931--CALL    14603--CALL
M$DEVICE
      5857**DCL-ENT 13883--CALL
M$ERR
      5865**DCL-ENT 13903--CALL    14615--CALL
M$EXIT
      5865**DCL-ENT 14219--CALL
M$FID
      5916**DCL-ENT 14170--CALL
M$HLPCG
        16**DCL     13865--IF
M$INT
      5908**DCL-ENT 13830--CALL
M$KEYIN
      5858**DCL-ENT 14505--CALL
M$LO
        16**DCL     13881--IF      13916<>CALL    13933<>CALL    13935<>CALL    14605<>CALL    14607<>CALL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:279  
M$ME
        16**DCL     13927<>CALL    13929<>CALL    14599<>CALL    14601<>CALL
M$OPEN
      5853**DCL-ENT 13834--CALL
M$SMOUSE
      5899**DCL-ENT 14293--CALL
M$SPRIV
      5912**DCL-ENT 13824--CALL
M$TIME
      5920**DCL-ENT 13822--CALL    14394--CALL    15260--CALL    15840--CALL
M$TRAP
      5907**DCL-ENT 13832--CALL
M$UNFID
      5916**DCL-ENT 14523--CALL
M$XMOUSE
      5899**DCL-ENT 14312--CALL
MASK IN PROCEDURE SETUP_FEP
     15620**DCL     15758<<ASSIGN
MASK.DISP IN PROCEDURE SETUP_FEP
     15675**DCL     15761>>IF      15764<<ASSIGN  15764>>ASSIGN  15766>>IF      15769<<ASSIGN  15769>>ASSIGN
     15773>>IF      15776<<ASSIGN  15776>>ASSIGN  15777>>IF
MASK.HANDLER IN PROCEDURE SETUP_FEP
     15753**DCL     15788<>CALL
MASK.PERIOD IN PROCEDURE SETUP_FEP
     15754**DCL     15759<<ASSIGN
MASK.SLCT IN PROCEDURE SETUP_FEP
     15741**DCL     15785>>IF      15791<<ASSIGN  15791>>ASSIGN  15792>>IF
MASKS IN PROCEDURE FEPBITS
     14750**DCL     14629--PROC    14771>>ASSIGN  14780>>ASSIGN
MFACTOR IN PROCEDURE GENERATE_SCALE
     14828**DCL     14829--REDEF   14870<<ASSIGN  14875>>ASSIGN  14881<<ASSIGN  14881>>ASSIGN  14926<<ASSIGN
MFACTOR_SBIN IN PROCEDURE GENERATE_SCALE
     14829**DCL     14930>>ASSIGN
MOVE_DATE
     15269**PROC    15240--CALL    15246--CALL    15250--CALL
MOVE_TIME
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:280  
     15329**PROC    15241--CALL    15245--CALL    15254--CALL
NODE$ IN PROCEDURE FEPBITS
     14631**DCL     14629--PROC    14770>>IF      14773>>DOINDEX 14775>>IF      14777>>ASSIGN  14777>>ASSIGN
     14780>>ASSIGN
OPEN_LO.ACSVEH_
     10443**DCL     10444--REDEF
OPEN_LO.ALTKEYS_
     10449**DCL     10450--REDEF   10450--REDEF
OPEN_LO.HDR_
     10448**DCL     10449--REDEF
OPEN_LO.TAB_
     10447**DCL     10448--REDEF
OPEN_LO.UHL_
     10441**DCL     10442--REDEF   10442--REDEF
OPEN_LO.V
     10450**DCL     10441--DCLINIT
OPEN_LO.V.FSN#
     10481**DCL     10481--REDEF   10481--REDEF
OPEN_LO.WSN_
     10447**DCL     10447--REDEF
OPEN_M$SI.ACSVEH_
     10769**DCL     10770--REDEF
OPEN_M$SI.ALTKEYS_
     10775**DCL     10776--REDEF   10776--REDEF
OPEN_M$SI.HDR_
     10774**DCL     10775--REDEF
OPEN_M$SI.TAB_
     10773**DCL     10774--REDEF
OPEN_M$SI.UHL_
     10767**DCL     10768--REDEF   10768--REDEF
OPEN_M$SI.V
     10776**DCL     10767--DCLINIT
OPEN_M$SI.V.FSN#
     10807**DCL     10807--REDEF   10807--REDEF
OPEN_M$SI.WSN_
     10773**DCL     10773--REDEF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:281  
OPEN_SI
     10553**DCL     13834<>CALL
OPEN_SI.ACSVEH_
     10555**DCL     10556--REDEF
OPEN_SI.ALTKEYS_
     10561**DCL     10562--REDEF   10562--REDEF
OPEN_SI.HDR_
     10560**DCL     10561--REDEF
OPEN_SI.TAB_
     10559**DCL     10560--REDEF
OPEN_SI.UHL_
     10553**DCL     10554--REDEF   10554--REDEF
OPEN_SI.V
     10562**DCL     10553--DCLINIT
OPEN_SI.V.FSN#
     10593**DCL     10593--REDEF   10593--REDEF
OPEN_SI.WSN_
     10559**DCL     10559--REDEF
OPTN
     11313**DCL     13950<<ASSIGN  13956<<ASSIGN  13961<<ASSIGN  13970>>DOCASE  13990<<ASSIGN  13990>>ASSIGN
     13994>>DOWHILE 13996>>DOCASE  14041>>CALL    14043>>CALL    14046>>IF      14048>>IF      14056>>IF
     14063>>DOINDEX 14066>>CALLBLT 14066>>CALLBLT 14126<<ASSIGN  14126>>ASSIGN
OUT$BLK
     11202**DCL     14400<>CALL    14403<>CALL    14408<>CALL    14413<>CALL    14436<>CALL    14453<>CALL
     14476<>CALL    14479<>CALL    14513<>CALL    15099<>CALL    15240<>CALL    15241<>CALL    15245<>CALL
     15246<>CALL    15250<>CALL    15254<>CALL
OUT$BLK.CODE
     11210**DCL     13946>>DOCASE  13952>>DOCASE  13970>>DOCASE  13996>>DOCASE  14046>>IF      14048>>IF
     14183>>IF      14191>>DOCASE  14242>>DOCASE  14282>>DOCASE  14308>>DOCASE  14328>>ASSIGN  14349>>DOCASE
     14396>>DOCASE  14428>>DOCASE  14457>>IF      14611<>CALL    14775>>IF      14780>>ASSIGN  14959>>ASSIGN
     15134>>DOCASE  15150>>ASSIGN
OUT$BLK.NSUBLKS
     11214**DCL     13994>>DOWHILE 14056>>IF      14063>>DOINDEX 14155>>DOINDEX 14180>>IF      14226>>IF
     14240>>DOINDEX 14280>>DOINDEX 14286>>IF      14306>>DOINDEX 14321>>ASSIGN  14347>>DOINDEX 14380>>IF
     14443>>IF      14447>>ASSIGN  14469>>ASSIGN  14770>>IF      14773>>DOINDEX 14955>>IF      15130>>DOINDEX
OUT$BLK.SUBLK$
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:282  
     11235**DCL     13952>>DOCASE  13970>>DOCASE  13970>>DOCASE  13996>>DOCASE  14041>>CALL    14041<>CALL
     14043>>CALL    14043<>CALL    14046>>IF      14048>>IF      14056>>IF      14056>>IF      14063>>DOINDEX
     14063>>DOINDEX 14066>>CALLBLT 14066>>CALLBLT 14066>>CALLBLT 14066>>CALLBLT 14066>>CALLBLT 14066>>CALLBLT
     14157>>CALLBLT 14157>>CALLBLT 14168>>ASSIGN  14168>>ASSIGN  14191>>DOCASE  14203>>CALLBLT 14203>>CALLBLT
     14203>>CALLBLT 14203>>CALLBLT 14242>>DOCASE  14282>>DOCASE  14286>>IF      14290>>CALLBLT 14290>>CALLBLT
     14290>>CALLBLT 14290>>CALLBLT 14308>>DOCASE  14328>>ASSIGN  14349>>DOCASE  14389>>ASSIGN  14400>>CALL
     14403>>CALL    14408>>CALL    14413>>CALL    14428>>DOCASE  14436>>CALL    14436>>CALL    14503>>ASSIGN
     14503>>ASSIGN  14611>>CALL    14775>>IF      14777>>ASSIGN  14777>>ASSIGN  14780>>ASSIGN  14955>>IF
     14959>>ASSIGN  14959>>ASSIGN  15132>>ASSIGN  15138>>CALLBLT 15138>>CALLBLT 15141>>CALLBLT 15141>>CALLBLT
OUT$SYM.COUNT
     11280**DCL     11283--IMP-SIZ 14066>>CALLBLT 14157>>CALLBLT 14168>>ASSIGN  14203>>CALLBLT 14290>>CALLBLT
     14503>>ASSIGN  14777>>ASSIGN  15138>>CALLBLT 15141>>CALLBLT 15321>>CALLBLT 15381>>CALLBLT
OUT$SYM.TEXT
     11283**DCL     14066>>CALLBLT 14157>>CALLBLT 14168--ASSIGN  14203>>CALLBLT 14290>>CALLBLT 14503--ASSIGN
     14777>>ASSIGN  15138>>CALLBLT 15141>>CALLBLT 15321>>CALLBLT 15381>>CALLBLT
P$
     13738**DCL     14389<<ASSIGN  14396>>DOCASE  14400>>CALL    14403>>CALL    14408>>CALL    14413>>CALL
P$ IN PROCEDURE SETUP_STATS_ENTRY
     15089**DCL     15128<<ASSIGN  15130>>DOINDEX 15132>>ASSIGN
POINTS IN PROCEDURE GENERATE_SCALE
     14820**DCL     14815--PROC    14821--REDEF   14844>>DOINDEX 14873>>DOINDEX 14885>>IF      14894>>IF
     14894>>IF      14926>>ASSIGN  14928>>DOINDEX
POINTS IN PROCEDURE SETUP_STATS_ENTRY
     15078**DCL     14984--PROC    15166>>CALL
POINTS_SBIN IN PROCEDURE GENERATE_SCALE
     14821**DCL     14838>>IF      14846>>ASSIGN
PSA$BREAK
     13801**DCL-ENT 10022--DCLINIT
PSA$TRAPPED
     13802**DCL-ENT 11145--DCLINIT 11145--DCLINIT 11146--DCLINIT 11146--DCLINIT
PSD$DISP
     13800**DCL-ENT 14212--CALL    14341--CALL    14465--CALL    14489--CALL    14497--CALL    14519--CALL
PSE$ERRMSG
     13796**DCL-ENT 13840--CALL    13901--CALL    13907--CALL    13925--CALL    13939--CALL    14173--CALL
     14529--CALL    14611--CALL    15146--CALL    15177--CALL    15265--CALL
PSE$GRIPE
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:283  
     13799**DCL-ENT 13828--CALL    14294--CALL    14313--CALL
PSM$ALLOC
     13794**DCL-ENT 14449--CALL    14472--CALL    14511--CALL
PSM$FREESEG
     13795**DCL-ENT 13853--CALL
PSR$RPN
     13792**DCL-ENT 14436--CALL    15099--CALL
PSR$UN_RPN
     13793**DCL-ENT 14537--CALL
PS_BASED_FLAGS
      4432**DCL     14134<<ASSIGN  14138<<ASSIGN  14138>>ASSIGN  14143<<ASSIGN  14143>>ASSIGN
PS_BASED_FLAGS.CHANNELS
      4432**DCL     15432>>IF      15452<>CALL
PS_BASED_FLAGS.CPU
      4432**DCL     15432>>IF      15448<>CALL
PS_BASED_FLAGS.DEVICES
      4432**DCL     15432>>IF      15451<>CALL
PS_BASED_FLAGS.FAULT
      4433**DCL     15432>>IF      15454<>CALL
PS_BASED_FLAGS.FEP
      4433**DCL     15438>>IF
PS_BASED_FLAGS.HISTOGRAMS
      4433**DCL     15432>>IF      15456<>CALL
PS_BASED_FLAGS.MOUSE
      4433**DCL     15438>>IF      15463<>CALL
PS_BASED_FLAGS.PROCS
      4432**DCL     15432>>IF      15453<>CALL
PS_BASED_FLAGS.RESOURCES
      4432**DCL     15432>>IF      15450<>CALL
PS_BASED_FLAGS.SCPU
      4432**DCL     15432>>IF      15449<>CALL
PS_BASED_FLAGS.SUMMARY
      4433**DCL     15432>>IF      15455<>CALL
PS_BUFFER
      4839**DCL      4874--DCLINIT  4876--DCLINIT
PS_CMDS
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:284  
     13740**DCL     13912<>CALL
PS_COLLECT.CALCNT
      4994**DCL      4994--REDEF
PS_COLLECT.USRSRV
      4991**DCL      4992--REDEF
PS_COMMAND
      4839**DCL     10208--DCLINIT 10209--DCLINIT
PS_DEFAULT_DISPLAY_FLAGS
      4426**DCL     13815>>ASSIGN  14229>>ASSIGN  14246>>ASSIGN
PS_DEFAULT_FILE_PARAMS
      4988**DCL     13820>>ASSIGN  14234>>ASSIGN  14260>>ASSIGN
PS_DEFAULT_INTERVAL
      4840**DCL     13817>>ASSIGN  14163>>ASSIGN  14233>>ASSIGN  14256>>ASSIGN
PS_DEFAULT_LOG_FLAGS
      4428**DCL     13816>>ASSIGN  14230>>ASSIGN  14251>>ASSIGN
PS_DISPLAY_FLAGS
      4423**DCL     13815<<ASSIGN  13975--ASSIGN  14229<<ASSIGN  14246<<ASSIGN  14332<<ASSIGN  14375<<ASSIGN
     14566<>CALL
PS_DISPLAY_FLAGS.HISTOGRAMS
      4424**DCL     14376<<ASSIGN
PS_DISPLAY_FLAGS.SUMMARY
      4424**DCL     14333<<ASSIGN
PS_END_UTS
      5007**DCL     14236<<ASSIGN  14265<<ASSIGN  14384<<ASSIGN  14392>>ASSIGN  14419<<ASSIGN  14543>>IF
     14550<>CALL    14560>>IF      14562<>CALL
PS_ERR
      4837**DCL     13898>>IF
PS_FDS
      4856**DCL     14567<>CALL    14569<>CALL    14573<>CALL    14579<>CALL    14581<>CALL    14585<>CALL
     14590<>CALL    14625<>CALL
PS_FEP$
      4419**DCL     13868<>CALL
PS_FEPING
      5008**DCL     14073<<ASSIGN  14080<<ASSIGN
PS_FEPNO
      5008**DCL     14059<<DOINDEX 14066<<CALLBLT 14074<<DOINDEX 14075>>IF      14075>>IF      14075>>IF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:285  
     14075>>IF      14790>>ASSIGN  14791>>ASSIGN  14792>>ASSIGN  14796>>ASSIGN  14796>>ASSIGN  14798>>ASSIGN
     14798>>ASSIGN  14800>>ASSIGN  14804>>ASSIGN  14804>>ASSIGN  14806>>ASSIGN  14806>>ASSIGN  14809>>ASSIGN
PS_FEP_BASED_FLAGS
      4700**DCL     13987<<ASSIGN
PS_FEP_BASED_FLAGS.DISP
      4755**DCL     14790<<ASSIGN  14796<<ASSIGN  14796>>ASSIGN  14804<<ASSIGN  14804>>ASSIGN
PS_FEP_BASED_FLAGS.HANDLER
      4833**DCL     14792<<ASSIGN  14800<<ASSIGN  14809<<ASSIGN
PS_FEP_BASED_FLAGS.SLCT
      4821**DCL     14791<<ASSIGN  14798<<ASSIGN  14798>>ASSIGN  14806<<ASSIGN  14806>>ASSIGN
PS_FEP_DISP_FLAGS
      4433**DCL     13976--ASSIGN  14231<<ASSIGN  14247<<ASSIGN  14568<>CALL    14571>>IF      14571>>IF
     14572<>CALL
PS_FEP_DISP_FLAGS.DISP
      4489**DCL     14075>>IF
PS_FEP_DISP_FLAGS.SLCT
      4555**DCL     14075>>IF
PS_FEP_LOG_FLAGS
      4567**DCL     13981--ASSIGN  14232<<ASSIGN  14252<<ASSIGN  14580<>CALL    14583>>IF      14583>>IF
     14584<>CALL
PS_FEP_LOG_FLAGS.DISP
      4622**DCL     14075>>IF
PS_FEP_LOG_FLAGS.SLCT
      4688**DCL     14075>>IF
PS_FEP_SIZE
      4422**DCL     13868<>CALL
PS_FID_PARAMS
      4987**DCL     14175>>ASSIGN
PS_FID_PARAMS.ACCT@
      4988**DCL     10959--DCLINIT
PS_FID_PARAMS.ASN@
      4988**DCL     10961--DCLINIT 14172>>IF
PS_FID_PARAMS.NAME@
      4987**DCL     10959--DCLINIT
PS_FID_PARAMS.PASS@
      4988**DCL     10960--DCLINIT
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:286  
PS_FID_PARAMS.RES@
      4988**DCL     10961--DCLINIT
PS_FID_PARAMS.SN@
      4988**DCL     10960--DCLINIT
PS_FILE_PARAMS
      4986**DCL     13820<<ASSIGN  14175<<ASSIGN  14234<<ASSIGN  14260<<ASSIGN
PS_FILE_PARAMS.ACCT@
      4986**DCL     11007--DCLINIT
PS_FILE_PARAMS.ASN@
      4987**DCL     11009--DCLINIT
PS_FILE_PARAMS.NAME@
      4986**DCL     11007--DCLINIT
PS_FILE_PARAMS.RES@
      4987**DCL     11009--DCLINIT
PS_FILE_PARAMS.SN@
      4986**DCL     11008--DCLINIT
PS_GRAPHS
      5001**DCL     14470<<ASSIGN  14472<>CALL    14474>>DOINDEX
PS_GRAPH_PEAK
      5002**DCL     14482<<ASSIGN
PS_HISTOGRAM_FLAGS
      4833**DCL     14345<<ASSIGN  14353<<ASSIGN
PS_HISTOGRAM_FLAGS.INTERACTION_TIME
      4835**DCL     14369<>CALL
PS_HISTOGRAM_FLAGS.PMME_TIMES
      4834**DCL     14365<>CALL
PS_HISTOGRAM_FLAGS.RESPONSE
      4834**DCL     14357<>CALL
PS_HISTOGRAM_FLAGS.USER_SIZE
      4834**DCL     14361<>CALL
PS_HLPCGBUF.DSPMSK
      5251**DCL      5257--REDEF   14624<>CALL
PS_HLPCGBUF.HANDLER
      5238**DCL     14625--CALL
PS_HLPCGBUF.NODE_NUM
      5175**DCL     14625--CALL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:287  
PS_HLPCGBUF.SLCMSK
      5292**DCL      5299--REDEF
PS_INPUTTING
      4838**DCL     13818<<ASSIGN
PS_INTERVAL
      4839**DCL     13817<<ASSIGN  14153<<ASSIGN  14158<<ASSIGN  14158>>ASSIGN  14162>>IF      14163<<ASSIGN
     14233<<ASSIGN  14256<<ASSIGN  14590--CALL
PS_LOGFILE$
      4418**DCL     13875<>CALL
PS_LOGFILE_SIZE
      4420**DCL     13875<>CALL
PS_LOG_FLAGS
      4425**DCL     13816<<ASSIGN  13980--ASSIGN  14230<<ASSIGN  14251<<ASSIGN  14578<>CALL
PS_MODE
      5006**DCL     14210<<ASSIGN  14338<<ASSIGN  14459<<ASSIGN  14461<<ASSIGN  14486<<ASSIGN  14493<<ASSIGN
     14515<<ASSIGN
PS_MOUSE$
      4418**DCL     13872<>CALL
PS_MOUSEING
      4835**DCL     13819<<ASSIGN
PS_MOUSE_SIZE
      4421**DCL     13808<<ASSIGN  13872<>CALL
PS_NEEDED_LOGFILE_SIZE
      4421**DCL     13813<<ASSIGN
PS_NEEDED_MOUSE_SIZE
      4422**DCL     13814<<ASSIGN
PS_NEEDED_PMDAT_SIZE
      4420**DCL     13812<<ASSIGN
PS_OLD_COLLECT.CALCNT
      4998**DCL      4999--REDEF
PS_OLD_COLLECT.USRSRV
      4996**DCL      4996--REDEF
PS_OLD_FEP$
      4419**DCL     13869<>CALL
PS_OLD_FEP_SIZE
      4422**DCL     13869<>CALL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:288  
PS_OLD_MOUSE$
      4419**DCL     13873<>CALL
PS_OLD_MOUSE_SIZE
      4421**DCL     13811<<ASSIGN  13873<>CALL
PS_OLD_PMDAT$
      4418**DCL     13871<>CALL
PS_OLD_PMDAT_SIZE
      4419**DCL     13810<<ASSIGN  13871<>CALL
PS_PLOT_VALUES
      5001**DCL     15166<>CALL
PS_PMDAT$
      4418**DCL     13870<>CALL
PS_PMDAT_SIZE
      4419**DCL     13807<<ASSIGN  13870<>CALL
PS_PUNT_COUNT
      4841**DCL     14184<<ASSIGN  14185<<ASSIGN  14195<<ASSIGN  14199<<ASSIGN  14203<<CALLBLT 14339<<ASSIGN
     14463<<ASSIGN  14487<<ASSIGN  14495<<ASSIGN  14517<<ASSIGN
PS_SELECT_RPN
      4956**DCL     14436<>CALL    14537<>CALL
PS_SELECT_RPN.INFO
      4958**DCL     14426<<ASSIGN
PS_SELECT_RPN.INFO.USED#
      4959**DCL     14237<<ASSIGN  14269<<ASSIGN  14533>>IF
PS_START_UTS
      5007**DCL     14235<<ASSIGN  14264<<ASSIGN  14383<<ASSIGN  14391>>ASSIGN  14418<<ASSIGN  14540>>IF
     14558<>CALL
PS_STATS.BUCKET$
      5004**DCL     15162>>CALL    15162>>CALL
PS_STATS.HIGH
      5003**DCL     15122<<ASSIGN  15141<<CALLBLT 15144>>IF      15159>>ASSIGN
PS_STATS.LOW
      5003**DCL     15121<<ASSIGN  15138<<CALLBLT 15144>>IF      15158>>ASSIGN
PS_STATS.PLOT$
      5003**DCL     15166>>CALL
PS_STATS.RPN$
      5004**DCL     15099>>CALL    15102>>ASSIGN  15112>>ASSIGN  15113>>ASSIGN  15114>>ASSIGN  15115>>ASSIGN
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:289  
     15116>>ASSIGN
PS_STATS.SCALE
      5003**DCL     15120<<ASSIGN  15150<<ASSIGN  15160>>ASSIGN
PS_STATS$
      5000**DCL      5002--IMP-PTR 13874<>CALL    15099>>CALL    15102>>ASSIGN  15112>>ASSIGN  15113>>ASSIGN
     15114>>ASSIGN  15115>>ASSIGN  15116>>ASSIGN  15120>>ASSIGN  15121>>ASSIGN  15122>>ASSIGN  15138>>CALLBLT
     15141>>CALLBLT 15144>>IF      15144>>IF      15150>>ASSIGN  15158>>ASSIGN  15159>>ASSIGN  15160>>ASSIGN
     15162>>CALL    15162>>CALL    15166>>CALL
PS_STATS_EXPRESSIONS
      5001**DCL     14445<<ASSIGN  14447<<ASSIGN  14449<>CALL    14451>>DOINDEX 14469<<ASSIGN  14470>>ASSIGN
     14472<>CALL    14509<<ASSIGN
PS_STATS_SIZE
      5000**DCL     13809<<ASSIGN  13874<>CALL
PS_STEPCC
      4838**DCL     14218>>ASSIGN
PS_SUMMARY_ITEMS
      5005**DCL     14321<<ASSIGN  14323>>IF      14324<<ASSIGN  14326>>DOINDEX 15432>>IF
PS_SUMMARY_LIST
      5004**DCL     14323--IF      14324--ASSIGN  14328<<ASSIGN
PS_TODAYS_DATE
      4841**DCL     11051--DCLINIT 11052--DCLINIT
PS_WORKING_FLAGS
      4430**DCL     13992<<ASSIGN  14029<<ASSIGN  14134>>ASSIGN  14138>>ASSIGN  14143>>ASSIGN
PS_WORKING_FLAGS.CHANNELS
      4430**DCL     14005<<ASSIGN  14018<<ASSIGN  14109<<ASSIGN  14114<<ASSIGN
PS_WORKING_FLAGS.CPU
      4430**DCL     14000<<ASSIGN  14013<<ASSIGN  14033<<ASSIGN
PS_WORKING_FLAGS.DEVICES
      4430**DCL     14003<<ASSIGN  14016<<ASSIGN  14089<<ASSIGN  14113<<ASSIGN
PS_WORKING_FLAGS.FAULT
      4431**DCL     14008<<ASSIGN  14021<<ASSIGN  14122<<ASSIGN
PS_WORKING_FLAGS.FEP
      4431**DCL     14022<<ASSIGN  14085<<ASSIGN
PS_WORKING_FLAGS.HISTOGRAMS
      4431**DCL     14006<<ASSIGN  14019<<ASSIGN  14118<<ASSIGN
PS_WORKING_FLAGS.MOUSE
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:290  
      4431**DCL     14023<<ASSIGN  14097<<ASSIGN
PS_WORKING_FLAGS.PROCS
      4431**DCL     14004<<ASSIGN  14017<<ASSIGN  14101<<ASSIGN
PS_WORKING_FLAGS.RESOURCES
      4430**DCL     14001<<ASSIGN  14014<<ASSIGN  14037<<ASSIGN
PS_WORKING_FLAGS.SCPU
      4431**DCL     14002<<ASSIGN  14015<<ASSIGN  14093<<ASSIGN
PS_WORKING_FLAGS.SUMMARY
      4431**DCL     14007<<ASSIGN  14020<<ASSIGN  14105<<ASSIGN
Q$ IN PROCEDURE SETUP_STATS_ENTRY
     15090**DCL     15132<<ASSIGN  15134>>DOCASE  15138>>CALLBLT 15138>>CALLBLT 15141>>CALLBLT 15141>>CALLBLT
     15150>>ASSIGN
READ_COMMAND.STATION_
     10209**DCL     10210--REDEF
READ_COMMAND.V
     10210**DCL     10206--DCLINIT
READ_COMMAND.V.DVBYTE.REREAD#
     10221**DCL     10221--REDEF
READ_COMMAND.V.INDX#
     10219**DCL     10219--REDEF
REPORT_PARTIAL_ERROR
     14611**LABEL   14603--CALLALT
S IN PROCEDURE SETUP_FEP
     15784**LABEL   15792--EXIT
SCALE IN PROCEDURE GENERATE_SCALE
     14819**DCL     14815--PROC    14832>>DOCASE
SCALE IN PROCEDURE SETUP_STATS_ENTRY
     15083**DCL     15160<<ASSIGN  15162<>CALL    15166<>CALL
SEGMENT$ IN PROCEDURE FREESEG
     13847**DCL     13845--PROC    13853<>CALL    13859<<ASSIGN
SEGSIZE IN PROCEDURE FREESEG
     13848**DCL     13845--PROC    13850>>IF      13855<<ASSIGN
SETUP_FEP
     15482**PROC    14568--CALL    14572--CALL    14580--CALL    14584--CALL    14624--CALL
SETUP_STATS_ENTRY
     14984**PROC    14453--CALL    14476--CALL    14479--CALL    14513--CALL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:291  
SETUP_TOKENS
     15422**PROC    14566--CALL    14578--CALL
SET_FLAGS
     14944**PROC    14357--CALL    14361--CALL    14365--CALL    14369--CALL
SET_PM_PRIV
     10898**DCL     13824<>CALL
SET_PM_PRIV.V
     10898**DCL     10898--DCLINIT
SET_PROMPT.V
     11110**DCL     11104--DCLINIT
SET_TIME
     15183**PROC    14400--CALL    14403--CALL    14408--CALL    14413--CALL
SET_TRAP_CONTROL
     11144**DCL     13832<>CALL
SET_TRAP_CONTROL.V
     11144**DCL     11144--DCLINIT
SLCT
     11437**DCL     14043<>CALL    14791>>ASSIGN  14798>>ASSIGN  14806>>ASSIGN  14808>>IF
STATSNAME
     10183**DCL     10119--DCLINIT
STATS_PROMPT
     13783**DCL     13912--CALL
STATUS_DI_FMT
     13748**DCL     14567--CALL
STATUS_FEPN_FMT
     13751**DCL     14573--CALL    14585--CALL
STATUS_FEPS_FMT
     13750**DCL     14569--CALL    14581--CALL
STATUS_FID
     13757**DCL     11006--DCLINIT 14590--CALL
STATUS_FORMAT
     13742**DCL     14590--CALL
STATUS_LOG_FMT
     13749**DCL     14579--CALL
STATUS_MISC
     13755**DCL     14566<>CALL    14567--CALL    14568<>CALL    14569--CALL    14572<>CALL    14573--CALL
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:292  
     14578<>CALL    14579--CALL    14580<>CALL    14581--CALL    14584<>CALL    14585--CALL    14624<>CALL
     14625--CALL
STATUS_SELECT
     13760**DCL     14535<<ASSIGN  14537<>CALL    14537--CALL    14590--CALL
STATUS_TIME
     13759**DCL     14545<<ASSIGN  14549<<ASSIGN  14550<>CALL    14557<<ASSIGN  14558<>CALL    14562<>CALL
     14590--CALL
STRANGLING
     13739**DCL     13805<<ASSIGN  13896>>IF      13905<<ASSIGN
STRING IN PROCEDURE INSERT_TOKEN
     15391**DCL     15389--PROC    15405>>CALLBLT 15407--IF      15411--IF      15415<<CALLBLT
STRING IN PROCEDURE SETUP_FEP
     15484**DCL     15482--PROC    15757<<ASSIGN  15763<>CALL    15768<>CALL    15775<>CALL    15781>>CALLBLT
     15782<<CALLBLT 15788<>CALL    15790<>CALL    15796>>CALLBLT 15798<<CALLBLT
STRING IN PROCEDURE SETUP_TOKENS
     15424**DCL     15422--PROC    15430<<ASSIGN  15440<<ASSIGN  15442<>CALL    15448<>CALL    15449<>CALL
     15450<>CALL    15451<>CALL    15452<>CALL    15453<>CALL    15454<>CALL    15455<>CALL    15456<>CALL
     15460>>IF      15463<>CALL    15465>>IF      15467<<ASSIGN  15471>>CALLBLT 15472<<CALLBLT
TEMP_END_UTS
     13787**DCL     14392<<ASSIGN  14403<>CALL    14413<>CALL    14419>>ASSIGN
TEMP_START_UTS
     13786**DCL     14391<<ASSIGN  14400<>CALL    14408<>CALL    14418>>ASSIGN
TEXTC.LEN
      5004**DCL      5004--IMP-SIZ
TIME$BLK IN PROCEDURE MOVE_DATE
     15277**DCL     15269--PROC
TIME$BLK.NSUBLKS IN PROCEDURE MOVE_DATE
     15289**DCL     15319>>DOINDEX
TIME$BLK.SUBLK$ IN PROCEDURE MOVE_DATE
     15310**DCL     15321>>CALLBLT 15321>>CALLBLT
TIME$BLK IN PROCEDURE MOVE_TIME
     15337**DCL     15329--PROC
TIME$BLK.SUBLK$ IN PROCEDURE MOVE_TIME
     15370**DCL     15381>>CALLBLT 15381>>CALLBLT
TIME$BLK IN PROCEDURE SET_TIME
     15191**DCL     15183--PROC
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:293  
TIME$BLK.CODE IN PROCEDURE SET_TIME
     15199**DCL     15236>>DOCASE
TIME$BLK.SUBLK$ IN PROCEDURE SET_TIME
     15224**DCL     15240>>CALL    15241>>CALL    15245>>CALL    15246>>CALL    15250>>CALL    15254>>CALL
TIME@ IN PROCEDURE CONVERT_UTS
     15812**DCL     15838--ASSIGN  15851>>ASSIGN
TIME_AREA
     13768**DCL     11077--DCLINIT 11078--DCLINIT 13773--REDEF
TIME_AREA.PORTION.DIGITS
     13770**DCL     15382<<CALLBLT
TIME_AREA_C
     13773**DCL     15233<<ASSIGN
TIME_ERROR IN PROCEDURE SET_TIME
     15265**LABEL   15260--CALLALT
TIME_URPED IN PROCEDURE CONVERT_UTS
     15846**LABEL   15840--CALLALT
TODAYS_DATE
     13790**DCL     11028--DCLINIT 11029--DCLINIT 15234>>ASSIGN
TOKEN IN PROCEDURE INSERT_TOKEN
     15392**DCL     15389--PROC    15403>>CALLBLT 15415>>CALLBLT
TOKEN_LEN IN PROCEDURE INSERT_TOKEN
     15396**DCL     15403<<CALLBLT 15411>>IF      15415>>CALLBLT
UNABLE_TO_OPEN_M$SI
     13840**LABEL   13834--CALLALT
UNFID_BURPED
     14529**LABEL   14523--CALLALT
UPBITS
     14784**PROC    14060--CALL    14070--CALL
UTS IN PROCEDURE CONVERT_UTS
     15805**DCL     15803--PROC    15836--ASSIGN
UTS_RESULT IN PROCEDURE SET_TIME
     15230**DCL     15183--PROC    15258--ASSIGN
VALUE IN PROCEDURE GENERATE_SCALE
     14822**DCL     14815--PROC    14836<<ASSIGN  14846<<ASSIGN  14849>>IF      14849>>IF      14851<<ASSIGN
     14851>>ASSIGN  14871<<ASSIGN  14875<<ASSIGN  14877>>IF      14877>>IF      14879<<ASSIGN  14879>>ASSIGN
     14885>>IF      14894>>IF      14894>>IF      14926>>ASSIGN  14930<<ASSIGN  14930>>ASSIGN  14932>>IF
PL6.E3A0      #002=PSA$INIT File=PSA$MAIN.:E05TSI                                WED 07/30/97 04:25 Page:294  
     14932>>IF      14934<<ASSIGN  14934>>ASSIGN
VLP_NAME
     10882**DCL     10768--DCLINIT
VLR_FID
     10981**DCL     10962--DCLINIT
V_TABLE.HIGH
      4977**DCL     15122>>ASSIGN
V_TABLE.LOW
      4977**DCL     15121>>ASSIGN
V_TABLE.SCALE
      4977**DCL     15120>>ASSIGN
X$WRITE
      9954**DCL-ENT 14567--CALL    14569--CALL    14573--CALL    14579--CALL    14581--CALL    14585--CALL
     14590--CALL    14625--CALL
XTX$ADAPT
     10007**DCL-ENT 10086--DCLINIT
XUR$BREAK
      9851**DCL-ENT 10931--DCLINIT
XUR$ECHOIF
      9841**DCL-ENT 13916--CALL    13927--CALL    13933--CALL    14599--CALL    14605--CALL
XUR$ERRPTR
      9840**DCL-ENT 13929--CALL    13935--CALL    14601--CALL    14607--CALL
XUR$GETCMD
      9839**DCL-ENT 13912--CALL
XUR$INIT
      9844**DCL-ENT 13826--CALL
XUR_INIT
     10012**DCL     13826<>CALL
XUR_INIT.WORKR_
     10026**DCL     10027--REDEF
XUR_WORK_AREA
     10090**DCL     10026--DCLINIT
ZAP_HEADER
     10366**DCL     13883<>CALL
ZAP_HEADER.V
     10367**DCL     10366--DCLINIT

PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:295  
     1870        1        /*T***********************************************************/
     1871        2        /*T*                                                         */
     1872        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1873        4        /*T*                                                         */
     1874        5        /*T***********************************************************/
     1875        6        PSA$BREAK: PROC ASYNC;
     1876        7        %INCLUDE CP_6;
     1877       88        %INCLUDE CP_6_SUBS;
     1878      628        %INCLUDE PS_DATA_R;
     1879     5924        %INCLUDE PS_PERR_C;
     1880     5955
     1881     5956
     1882     5957        %B$TCB (STCLASS="BASED(B$TCB$)");
     1883     5960
     1884     5961        %B$EXCFR;
     1885     5979
     1886     5980
     1887     5981        %FPT_ALIB (FPTN=DUMP_THE_TCB,
     1888     5982         LIBNAME=DELTA,
     1889     5983         CMD=DUMP_TCB,
     1890     5984         DLIB=YES,
     1891     5985         RETRN=YES);
     1892     6002
     1893     6003
     1894     6004        %FPT_TRMPRG (FPTN=PURGE_BREAKS,
     1895     6005         RSTBRK=YES);
     1896     6034
     1897     6035
     1898     6036        %VLP_NAME (FPTN=DELTA, NAME='DELTA');
     1899     6063
     1900     6064    1   DCL DUMP_TCB CHAR (0) CONSTANT INIT ('DUMP $LS15->0 ''TCB after trap''');
     1901     6065    1   DCL B$TCB$ PTR SYMREF;
     1902     6066    1   DCL TRAP_IN_PROGRESS LOGICAL STATIC INIT (%NO#);
     1903     6067    1   DCL TEMP_ERRCODE BIT(36) ALIGNED;
     1904     6068    1   DCL PSE$GRIPE ENTRY (5); /* Gripe about BREAK */
     1905     6069
     1906     6070    1      CALL M$TRMPRG (PURGE_BREAKS);
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:296  
     1907     6071
     1908     6072    1      UNWIND TO PS_BAILOUT;
     1909     6073
     1910     6074        %EJECT;
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:297  
     1911     6075    1   PSA$TRAPPED: ENTRY ASYNC;
     1912     6076
     1913     6077    2      DO INHIBIT;
     1914     6078
     1915     6079    2         IF TRAP_IN_PROGRESS
     1916     6080    2         THEN
     1917     6081    2         CALL M$MERCS;
     1918     6082
     1919     6083    2         TRAP_IN_PROGRESS = %YES#;
     1920     6084
     1921     6085    2      END;
     1922     6086
     1923     6087    1      CALL PSE$GRIPE (B$TCB.STK$ -> B$EXCFR.ERR, SERIOUS#);
     1924     6088
     1925     6089    1      CALL M$ALIB (DUMP_THE_TCB) ALTRET (ALIB_TROUBLE);
     1926     6090
     1927     6091    1   ALIB_TROUBLE:
     1928     6092
     1929     6093    1      CALL M$CLRSTK;
     1930     6094
     1931     6095    1      TRAP_IN_PROGRESS = %NO#;
     1932     6096
     1933     6097    1      UNWIND TO PS_BAILOUT;
     1934     6098
     1935     6099    1   END PSA$BREAK;

PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:298  
--  Include file information  --

   PS_PERR_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PSA$BREAK.

   Procedure PSA$BREAK requires 36 words for executable code.
   Procedure PSA$BREAK requires 8 words of local(AUTO) storage.

    No errors detected in file PSA$MAIN.:E05TSI    .

PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:299  

 Object Unit name= PSA$BREAK                                  File name= PSA$MAIN.:E05TOU
 UTS= JUL 30 '97 04:29:17.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$DO
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  F$LOG
    5   DCB   even  none     0      0  M$ME
    6   DCB   even  none     0      0  M$HLPCG
    7  RtLbCm even  none    30     36  PS_FDS
    8  RtLbCm even  none    32     40  PS_SELECT_RPN
    9  RtLbCm even  none    17     21  PS_STATS_RPN
   10  RtLbCm even  none    34     42  PS_STATS_BUCKET
   11   Data  even  none    21     25  PSA$BREAK
   12  RoData even  UTS      8     10  PSA$BREAK
   13   Proc  even  none    36     44  PSA$BREAK
   14  RoData even  none     1      1  PSA$BREAK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes     Async       0  PSA$BREAK
    13     10                  yes     Async       0  PSA$TRAPPED
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:300  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 PSE$GRIPE
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AAUNWIND
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LO                                  M$DO
     M$SI                                  F$LOG                                 M$ME
     M$HLPCG                               PS_BAILOUT                            PS_BUFFER
     PS_STATS$                             B$TCB$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:301  


     1870        1        /*T***********************************************************/
     1871        2        /*T*                                                         */
     1872        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1873        4        /*T*                                                         */
     1874        5        /*T***********************************************************/
     1875        6        PSA$BREAK: PROC ASYNC;

      6 13 000000   000000 700200 xent  PSA$BREAK    TSX0  ! X66_AAUTO
        13 000001   000010 000000                    ZERO    8,0

     1876        7        %INCLUDE CP_6;
     1877       88        %INCLUDE CP_6_SUBS;
     1878      628        %INCLUDE PS_DATA_R;
     1879     5924        %INCLUDE PS_PERR_C;
     1880     5955
     1881     5956
     1882     5957        %B$TCB (STCLASS="BASED(B$TCB$)");
     1883     5960
     1884     5961        %B$EXCFR;
     1885     5979
     1886     5980
     1887     5981        %FPT_ALIB (FPTN=DUMP_THE_TCB,
     1888     5982         LIBNAME=DELTA,
     1889     5983         CMD=DUMP_TCB,
     1890     5984         DLIB=YES,
     1891     5985         RETRN=YES);
     1892     6002
     1893     6003
     1894     6004        %FPT_TRMPRG (FPTN=PURGE_BREAKS,
     1895     6005         RSTBRK=YES);
     1896     6034
     1897     6035
     1898     6036        %VLP_NAME (FPTN=DELTA, NAME='DELTA');
     1899     6063
     1900     6064    1   DCL DUMP_TCB CHAR (0) CONSTANT INIT ('DUMP $LS15->0 ''TCB after trap''');
     1901     6065    1   DCL B$TCB$ PTR SYMREF;
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:302  
     1902     6066    1   DCL TRAP_IN_PROGRESS LOGICAL STATIC INIT (%NO#);
     1903     6067    1   DCL TEMP_ERRCODE BIT(36) ALIGNED;
     1904     6068    1   DCL PSE$GRIPE ENTRY (5); /* Gripe about BREAK */
     1905     6069
     1906     6070    1      CALL M$TRMPRG (PURGE_BREAKS);

   6070 13 000002   000012 630400 11                 EPPR0   PURGE_BREAKS
        13 000003   160004 713400                    CLIMB   57348
        13 000004   400400 401760                    pmme    nvectors=2

     1907     6071
     1908     6072    1      UNWIND TO PS_BAILOUT;

   6072 13 000005   000000 237200 xsym               LDAQ  ! PS_BAILOUT
        13 000006   000000 700200 xent               TSX0  ! X66_AAUNWIND
        13 000007   000000 000200                    ZERO    0,128

     1909     6073
     1910     6074        %EJECT;
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:303  
     1911     6075    1   PSA$TRAPPED: ENTRY ASYNC;

   6075 13 000010   000000 700200 xent  PSA$TRAPPED  TSX0  ! X66_AAUTO
        13 000011   000010 000000                    ZERO    8,0

     1912     6076
     1913     6077    2      DO INHIBIT;

     1914     6078
     1915     6079    2         IF TRAP_IN_PROGRESS

   6079 13 000012   000024 234200 11                 SZN   ! TRAP_IN_PROGRESS
        13 000013   000016 605200 13                 TPL   ! s:6083

     1916     6080    2         THEN
     1917     6081    2         CALL M$MERCS;

   6081 13 000014   010014 713600                    CLIMB ! 4108
        13 000015   000000 401760                    pmme    nvectors=0

     1918     6082
     1919     6083    2         TRAP_IN_PROGRESS = %YES#;

   6083 13 000016   400000 236203                    LDQ   ! -131072,DU
        13 000017   000024 756200 11                 STQ   ! TRAP_IN_PROGRESS

     1920     6084
     1921     6085    2      END;

     1922     6086
     1923     6087    1      CALL PSE$GRIPE (B$TCB.STK$ -> B$EXCFR.ERR, SERIOUS#);

   6087 13 000020   000000 470400 xsym               LDP0    B$TCB$
        13 000021   000001 471500                    LDP1    1,,PR0
        13 000022   000000 236000 14                 LDQ     0
        13 000023   200007 756100                    STQ     7,,AUTO
        13 000024   100102 633500                    EPPR3   66,,PR1
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:304  
        13 000025   200006 453500                    STP3    6,,AUTO
        13 000026   200006 630500                    EPPR0   6,,AUTO
        13 000027   000020 631400 xsym               EPPR1   B_VECTNIL+16
        13 000030   000000 701000 xent               TSX1    PSE$GRIPE
        13 000031   000000 011000                    NOP     0

     1924     6088
     1925     6089    1      CALL M$ALIB (DUMP_THE_TCB) ALTRET (ALIB_TROUBLE);

   6089 13 000032   000000 630400 11                 EPPR0   DUMP_THE_TCB
        13 000033   400007 713400                    CLIMB   alt,+7
        13 000034   401400 401760                    pmme    nvectors=4
        13 000035   000036 702000 13                 TSX2    ALIB_TROUBLE

     1926     6090
     1927     6091    1   ALIB_TROUBLE:
     1928     6092
     1929     6093    1      CALL M$CLRSTK;

   6093 13 000036   010013 713400       ALIB_TROUBLE CLIMB   4107
        13 000037   000000 401760                    pmme    nvectors=0

     1930     6094
     1931     6095    1      TRAP_IN_PROGRESS = %NO#;

   6095 13 000040   000024 450000 11                 STZ     TRAP_IN_PROGRESS

     1932     6096
     1933     6097    1      UNWIND TO PS_BAILOUT;

   6097 13 000041   000000 237200 xsym               LDAQ  ! PS_BAILOUT
        13 000042   000000 700200 xent               TSX0  ! X66_AAUNWIND
        13 000043   000000 000200                    ZERO    0,128
     1934     6098
     1935     6099    1   END PSA$BREAK;

PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:305  
--  Include file information  --

   PS_PERR_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   PM_BUCKET_C.:E05TOU  is referenced.
   PS_SUBS_C.:E05TOU  is referenced.
   PS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PSA$BREAK.
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:306  

 **** Variables and constants ****

  ****  Section 011  Data  PSA$BREAK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/c STRC(54)    r     1 DELTA                      0-0-0/d STRC(360)   r     1 DUMP_THE_TCB
    12-0-0/d STRC(288)   r     1 PURGE_BREAKS              24-0-0/b BIT         r     1 TRAP_IN_PROGRESS

  ****  Section 012 RoData PSA$BREAK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(30)    r     1 DUMP_TCB

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d REMB        r     1 PS_BAILOUT
     0-0-0/c CHAR(140)   r     1 PS_BUFFER                  0-0-0/w PTR         r     1 PS_STATS$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$EXCFR                    0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$UC
     0-0-0/c ASTR(9)     r     1 TEXTC


   Procedure PSA$BREAK requires 36 words for executable code.
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:307  
   Procedure PSA$BREAK requires 8 words of local(AUTO) storage.

    No errors detected in file PSA$MAIN.:E05TSI    .
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:308  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:309  
          MINI XREF LISTING

ALIB_TROUBLE
      6093**LABEL    6089--CALLALT
B$EXCFR.ASL
      5962**DCL      5962--REDEF
B$EXCFR.ERR
      5976**DCL      6087<>CALL
B$EXCFR.ERR.ERR#
      5976**DCL      5976--REDEF
B$EXCFR.EVID
      5975**DCL      5975--REDEF    5976--REDEF
B$EXCFR.IR
      5963**DCL      5963--REDEF
B$EXCFR.PREVSZ
      5962**DCL      5962--REDEF
B$EXCFR.SUBC
      5974**DCL      5974--REDEF    5975--REDEF    5975--REDEF
B$TCB.STK$
      5958**DCL      6087>>CALL
B$TCB$
      6065**DCL      5958--IMP-PTR  6087>>CALL
DELTA
      6061**DCL      5996--DCLINIT
DUMP_TCB
      6064**DCL      5996--DCLINIT
DUMP_THE_TCB
      5996**DCL      6089<>CALL
DUMP_THE_TCB.V
      5997**DCL      5997--DCLINIT
M$ALIB
        29**DCL-ENT  6089--CALL
M$CLRSTK
        74**DCL-ENT  6093--CALL
PL6.E3A0      #003=PSA$BREAK File=PSA$MAIN.:E05TSI                               WED 07/30/97 04:29 Page:310  
M$MERCS
        73**DCL-ENT  6081--CALL
M$TRMPRG
        41**DCL-ENT  6070--CALL
PSE$GRIPE
      6068**DCL-ENT  6087--CALL
PS_BAILOUT
      5457**DCL      6072>>UNWIND   6097>>UNWIND
PS_BUFFER
      5459**DCL      5494--DCLINIT  5496--DCLINIT
PS_COLLECT.CALCNT
      5614**DCL      5614--REDEF
PS_COLLECT.USRSRV
      5611**DCL      5612--REDEF
PS_HLPCGBUF.DSPMSK
      5871**DCL      5877--REDEF
PS_HLPCGBUF.SLCMSK
      5912**DCL      5919--REDEF
PS_OLD_COLLECT.CALCNT
      5618**DCL      5619--REDEF
PS_OLD_COLLECT.USRSRV
      5616**DCL      5616--REDEF
PS_STATS$
      5620**DCL      5622--IMP-PTR
PURGE_BREAKS
      6021**DCL      6070<>CALL
PURGE_BREAKS.V
      6028**DCL      6023--DCLINIT
PURGE_BREAKS.V.CTLFLG.RSTBRK#
      6029**DCL      6030--REDEF
TEXTC.LEN
      5624**DCL      5624--IMP-SIZ
TRAP_IN_PROGRESS
      6066**DCL      6079>>IF       6083<<ASSIGN   6095<<ASSIGN
