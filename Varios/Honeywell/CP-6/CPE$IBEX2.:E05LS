VERSION E05

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:1    
        1        1        /*M* COMMENT, DISPLAY, DONT, ECHO, LIST, PASSWORD, PROTECT, TIME cmds */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC   */
        8        8        /*P*   NAME:   CPE$IBEX2
        9        9               PURPOSE:  To perform the required operations in the execution of
       10       10                       selected IBEX commands.
       11       11               DESCRIPTION;
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:2    
       16       16        CPE$IBEX2:
       17       17          PROC(P$PCB) ALTRET;
       18       18                   %INCLUDE CP_6;
       19       99                   %INCLUDE B$JIT;
       20      389                   %INCLUDE B$ROSEG ;
       21      452                   %INCLUDE B_STRINGS_C;
       22      581                   %INCLUDE B_MACROS_C;
       23      692                   %INCLUDE B$TABLES_C;
       24      800                   %INCLUDE CP_MACROS_C;
       25     1552                   %INCLUDE CX_MACROS_M;
       26     1603                   %INCLUDE XU_MACRO_C;
       27     4709                   %INCLUDE XU_FORMAT_C;
       28     4871                   %INCLUDE FM$MACROS;
       29     5246                   %INCLUDE CP_SUBS_C;
       30     6163                 %INCLUDE CP_PERR_C;
       31     6501                   %INCLUDE CP_6_SUBS;
       32     7041                 %INCLUDE B_ERRORS_C;
       33     8168                   %INCLUDE AS_SUPER_C;
       34     8603                  %INCLUDE CP_DATA_R;
       35    11166                   %INCLUDE KL_SUPER_C;
       36    14068                   %INCLUDE B_MICROPS_C;
       37    14240                   %INCLUDE NK_VFC_C;
       38    14314    1   DCL BLK$ PTR;                           /*Parse output block ptr*/
       39    14315    1   DCL ONOVERINTO$ PTR;                    /*Ptr to on/over/into*/
       40    14316    1   DCL FID$ PTR;                           /*Ptr to fid name*/
       41    14317    1   DCL DCB# UBIN WORD;
       42    14318    1   DCL DCB$ PTR;                           /*Ptr to dcb name*/
       43    14319    1   DCL TEMP$ PTR;                          /*Temporary ptr*/
       44    14320    1   DCL TEMP1$ PTR;                                  /*Temp pointer*/
       45    14321    1   DCL TVAL SBIN(36) ALIGNED;                       /*Temp. Location*/
       46    14322    1   DCL TEMP UBIN(36) ALIGNED;                       /*Temp. Location*/
       47    14323    1   DCL 1 TEMPO REDEF TEMP,
       48    14324    1         2 REST UBIN(33) UNAL,
       49    14325    1         2 LSD UBIN(3) UNAL ;
       50    14326    1   DCL IND1 UBIN;
       51    14327    1   DCL CONTAB CHAR(0) CONSTANT INIT('012345678') ;
       52    14328    1   DCL DCBSLOT UBIN;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:3    
       53    14329    1   DCL STREAM_OPEN BIT(1);
       54    14330    1   DCL RES# CHAR(4);
       55    14331    1   DCL LDEVHDR CONSTANT CHAR(0) INIT('   Ldev assignments:');
       56    14332    1   DCL LDEVNHDR CONSTANT CHAR(0) INIT('   Ldev assignments: none');
       57    14333    1   DCL LDEVS_EXIST BIT(1) UNAL;                     /*LDEVs exist flag*/
       58    14334    1   DCL LDEVS_HDR_PRINTED BIT(1) UNAL ;
       59    14335    1   DCL DILDEV_OPT BIT(1) UNAL ;
       60    14336    1   DCL WHEN_CNTL_REC_CHANGED BIT(1) ;
       61    14337    1   DCL STAR_S_IS_OPEN BIT(1) ;
       62    14338    1   DCL BUF_ BIT(72) DALIGNED;                       /*Vector framing buffer*/
       63    14339    1   DCL OLDPASSWORD CHAR(8) ALIGNED;                         /*Old password*/
       64    14340    1   DCL NEWPASSWORD CHAR(8) ALIGNED;                         /*New password*/
       65    14341    1   DCL IN$ PTR;                                     /*Input buffer ptr*/
       66    14342    1   DCL DEST$ PTR;                                   /*Output buffer ptr*/
       67    14343    1   DCL OUTBUFF$ PTR;                                /*Output buffer ptr*/
       68    14344    1   DCL INBUFF CHAR(512);
       69    14345    1   DCL OUTBUFF CHAR(512);
       70    14346    1   DCL 1 DCB_NAME DALIGNED,                         /*Dcb name*/
       71    14347    1          2 COUNT UBIN(9) UNAL,
       72    14348    1          2 TEXT CHAR(31) UNAL;
       73    14349    1   DCL DCB_NAMEA(0:31) REDEF DCB_NAME CHAR(1);
       74    14350    1   DCL UNFID CHAR (64) AUTO;
       75    14351    1   DCL ASN UBIN WORD;
       76    14352    1   DCL RES CHAR(4);
       77    14353    1   DCL I UBIN(36) ALIGNED;                 /*Temp. Loc. For indexes*/
       78    14354    1   DCL J UBIN(36) ALIGNED;                 /*Temp. Loc. For indexes*/
       79    14355    1   DCL TAB_VAL SBIN WORD;                           /*Tab value for printing*/
       80    14356    1   DCL CPOS UBIN WORD AUTO;     /* Only for use for CXP$POSTERR */
       81    14357    1   DCL LEN SBIN(36) ALIGNED;
       82    14358    1   DCL 1 VARY$STRNG BASED,
       83    14359    1          2 TEXT CHAR(LEN);
       84    14360    1   DCL 1 M$DODCB CONSTANT DALIGNED,
       85    14361    1          2 CNT UBIN(9) INIT(4) UNAL,
       86    14362    1          2 TXT CHAR(4) INIT('M$DO');
       87    14363    1   DCL 1 TMDATE,
       88    14364    1          2 * CHAR(3),
       89    14365    1          2 DATE CHAR(10),
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:4    
       90    14366    1          2 * CHAR(2),
       91    14367    1          2 TIME,
       92    14368    1             3 HR CHAR(3),
       93    14369    1             3 MIN CHAR(2),
       94    14370    1             3 SEC CHAR(3),
       95    14371    1             3 MSEC CHAR(3);
       96    14372    1   DCL TMDATEBUFF REDEF TMDATE CHAR(26);
       97    14373    1   DCL SYSID CHAR(6);
       98    14374    1   DCL ACTIVE_PRIVS BIT(36) ;
       99    14375    1   DCL 1 BAD_LDEV_NAME,
      100    14376    1         2 SIZ UBIN BYTE UNAL,
      101    14377    1         2 TEXT CHAR(4) CALIGNED;
      102    14378        /*
      103    14379          **** THIS VALUE REFLECTS THE SIZE OF OPT_TBL-1
      104    14380          **** MUST BE CHANGED WHENEVER OPT_TBL CHANGES IN SIZE
      105    14381        */
      106    14382    1   DCL OPT_TBLSZE SBIN WORD CONSTANT INIT(46);
      107    14383    1   DCL 1 OPT_TBL(0:46) CONSTANT ALIGNED,     /*DCB DISPLAY OPTION TABLE*/
      108    14384    1         2 LEN UBIN BYTE UNAL INIT
      109    14385    1           (7,7,6,2,7,7,6,6,5,7,8,9,6,5,7,8,4,7,11,7,6,3,4,4,5,4,3,5,4,
      110    14386    1            9,10,6,5,10,5,7,3,10,6,7,7,8,7,7,9,7,13),
      111    14387    1         2 HDR CHAR(14) UNAL INIT
      112    14388    1           ('AllDCBs','AllTrms','AnyDCB','AU','DirOnly','EOFNone',
      113    14389    1            'EOFOne','ILatch','ILock','IMsgTyp','IStation',
      114    14390    1            'MyStation','OLatch','OLock','OMsgTyp','OStation',
      115    14391    1            'QISS','Blocked','ANSISpanSeq','Spanned','EBCDIC','Ctg',
      116    14392    1            'Comp','CVol','Xtend','BUpM','Seq','Cnvrt','Load',
      117    14393    1            'DcbConLgl', 'JrnlBypass', 'LStaOR', 'Scrub', 'TermConLgl',
      118    14394    1            'Debug', 'LdByPro', 'WAS', 'Initialize', 'NoFile',
      119    14395    1            'BtmBrdr', 'LftBrdr', 'Optional', 'Rhtbrdr', 'TopBrdr',
      120    14396    1            'IgnoreFsn', 'IoErrOk', 'SeedSpecified'),
      121    14397    1         2 OPTION UBIN BYTE UNAL INIT
      122    14398    1            (ALLDCBSOPT,ALLTRMSOPT,ANYDCBOPT,AUOPT,DIRONLYOPT,
      123    14399    1             EOFNONEOPT,EOFONEOPT,ILATCHOPT,ILOCKOPT,IMSGTYPOPT,
      124    14400    1             ISTATIONOPT,MYSTATIONOPT,OLATCHOPT,OLOCKOPT,OMSGTYPOPT,
      125    14401    1             OSTATIONOPT,QISSOPT,BLOCKEDOPT,ANSISPANSEQOPT,SPANNEDOPT,
      126    14402    1             EBCDICOPT,CTGOPT,COMPOPT,CVOLOPT,XTENDOPT,BUPMOPT,SEQOPT,
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:5    
      127    14403    1             CNVRTOPT,LOADOPT,DCBCONLGLOPT,JRNLBYPASSOPT,LSTAOROPT,
      128    14404    1             SCRUBOPT,TERMCONLGLOPT,DEBUGOPT,LDBYPROOPT,WASOPT,
      129    14405    1             INITIALIZEOPT,NOFILEOPT,BTMBRDROPT,LFTBRDROPT,
      130    14406    1             OPTIONALOPT,RHTBRDROPT,TOPBRDROPT,IGNOREFSNOPT,
      131    14407    1             IOERROKOPT,SEEDOPT);
      132    14408        %F_FDS (  NAME = CF_FDS,
      133    14409                  STCLASS = CONSTANT,
      134    14410                  TRUNC = NO,
      135    14411                  DVFC = %VFC_TRANSITION1,
      136    14412                  WRAPTAB = 6) ;
      137    14525        %F_FDS (  NAME = F_FDS,
      138    14526                  STCLASS = AUTO) ;
      139    14639    1   DCL FMT_VEC(0:23) BIT(72) ;
      140    14640        /***** External routines *****/
      141    14641    1   DCL MSGFLAG BIT(1) UNAL;                         /*Message flag*/
      142    14642    1   DCL CPB$OPENCS ENTRY;
      143    14643    1   DCL CPB$REPORT ENTRY(1) ALTRET;
      144    14644    1   DCL CPC$WRITEMSGE ENTRY(6);
      145    14645    1   DCL CPC$GETSEG ENTRY(2) ALTRET;                  /*Get segment for buffer*/
      146    14646    1   DCL CPC$OPEN_LL ENTRY ;
      147    14647        %FPT_DRIBBLE(FPTN=FPT_DRIBBLE,STCLASS=AUTO);
      148    14658    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
      149    14659    1   DCL CPC$RDHLP ENTRY(2) ALTRET;
      150    14660    1   DCL CPC$RELSEG ENTRY(1);
      151    14661    1   DCL CPC$WRHLP ENTRY(1) ALTRET;
      152    14662    1   DCL CPE$RFEXT ENTRY(1);                 /*Reset file extension*/
      153    14663    1   DCL CPE$GENRUAM ENTRY(5) ALTRET;        /*Gen ru assign merge*/
      154    14664    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*List buff contents*/
      155    14665    1   DCL CXC$READAM ENTRY(3) ;
      156    14666    1   DCL CPE$RZEROS ENTRY(3);                         /*Remove leading zeros*/
      157    14667    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
      158    14668    1   DCL CPF$SWITCH ENTRY(1) ALTRET;                  /*Display sense switches*/
      159    14669    1   DCL CPI$TABS ENTRY(1) ALTRET;                    /*Display tabs*/
      160    14670    1   DCL CPI$DIRECTORY ENTRY(1) ALTRET;               /*Display directory*/
      161    14671    1   DCL CPI$SETUP ENTRY(2) ALTRET;                   /*Display setup*/
      162    14672    1   DCL CPJ$LIMIT ENTRY(1) ALTRET;                   /*Display limits*/
      163    14673    1   DCL CPJ$READ_S ENTRY(3) ALTRET;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:6    
      164    14674    1   DCL CPO$ORES ENTRY(1) ALTRET;                     /* Di resource */
      165    14675    1   DCL CPH$GLOBAL ENTRY(1) ALTRET;                  /*Display globals*/
      166    14676    1   DCL CPG$LET ENTRY(1) ALTRET;                     /*Display com vars */
      167    14677    1   DCL CPG$GET_WHEN_CNTL_REC ENTRY(2) ALTRET;
      168    14678    1   DCL CPG$PUT_WHEN_CNTL_REC ENTRY(1) ALTRET;
      169    14679    1   DCL CPG$SET_WHEN_STATE ENTRY ALTRET;
      170    14680    1   DCL CPB$PLATEN ENTRY(1) ALTRET;                  /*Display platen*/
      171    14681    1   DCL CXB$CHKFORT ENTRY(1);                        /*Cnvrt if fort dcb number*/
      172    14682    1   DCL CPF$TERMINAL ENTRY(1) ALTRET;                       /*Display terminal chrstcs*/
      173    14683    1   DCL CPF$PPRIV  ENTRY ALTRET;                    /*Display proc privileges*/
      174    14684    1   DCL CPF$PRIV ENTRY(1) ALTRET;                    /*Display user privileges*/
      175    14685    1   DCL CPF$PROFILE ENTRY(1) ALTRET;                /*Display profiles*/
      176    14686    1   DCL CPF$DIPROFILES ENTRY(1) ALTRET;            /*Display all profiles*/
      177    14687    1   DCL CPI$PRIORITY ENTRY(1) ALTRET;               /*Display priority*/
      178    14688    1   DCL CPK$FDS_OUTPUT ENTRY(2) ALTRET;             /*Output routine for X$FORMAT*/
      179    14689    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
      180    14690    1   DCL CPC$SCREECH ENTRY(2);
      181    14691    1   DCL ASZ$SCRAMBLE ENTRY(1);
      182    14692    1   DCL CXP$POSTERR ENTRY(5);
      183    14693    1   DCL X$FORMAT ENTRY(1) ;
      184    14694        %SUB IBEX_CODE14 ="14 /*IBEX_CODE14*/";
      185    14695        /***** Auto Structures *****/
      186    14696        %AS_USERS(STR_NAME=AS_USERS,STCLASS=AUTO);
      187    14874        %VLR_DISPLAY (FPTN=LOAD_VAR,STCLASS=AUTO);
      188    14888        %K_WHEN (NAME=K_WHEN,STCLASS=AUTO) ;
      189    14906        %K_WHEN (NAME=CK_WHEN, STCLASS=CONSTANT) ;
      190    14924        /***** Based structures *****/
      191    14925        %TEXTC;
      192    14930        %CP$BUFF (NAME=CP$BUFF,STCLASS=BASED) ;
      193    14933        %B$EXCFR;
      194    14951        %B$TCB (STCLASS="BASED(B$TCB$)");
      195    14954        %SEG$2;
      196    15014        %F$DCB (DCBN=F$DCB);
      197    15071        %AS_USERS (STR_NAME=AS$USERS,STCLASS=BASED);
      198    15249        %VLP_NAME(FPTN=AM$NAME,LEN=31,STCLASS=BASED);
      199    15276        %VLP_ACCT(FPTN=AM$ACCT,STCLASS=BASED);
      200    15289        %VLP_SN(FPTN=AM$SN,STCLASS=BASED,N=50);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:7    
      201    15302        %VLP_WSN(FPTN=AM$WSN,STCLASS=BASED);
      202    15315        %VLP_SETSTA(FPTN=AM$SETSTA,STCLASS=BASED);
      203    15343        %VLP_VIRTUAL(FPTN=AM$VIRTUAL,STCLASS=BASED);
      204    15363        %VLP_WINDOW(FPTN=AM$WINDOW,STCLASS=BASED);
      205    15407        %VLP_FPRG(FPTN=AM$FPRG,STCLASS=BASED);
      206    15428        %VLP_ALTKEYS(FPTN=AM$ALTKEYS,STCLASS=BASED);
      207    15443        %FM$FIT;
      208    15446        %CODE14;
      209    15456        %KL_DREC(NAME=KL$DREC,STCLASS=BASED,LAST=",");
      210    15569        %KL_FEBLK(NAME=KL$FEBLK,RCNT=31,LVL=2) ;
      211    15618        %PLIST;
      212    15619        %B$SR_NON_BLANK (NAME=SRCHTBL);
      213    15623        %PARSE$OUT (NAME=P$B);
      214    15668        %PARSE$SYM (NAME=P$S);
      215    15706        %P$PCB(NAME=P$PCB,STCLASS="");
      216    15907        %ERR_BLK (NAME=ERR$BLK,STCLASS=BASED);
      217    15932        %WHEN_CNTL_REC (NAME=WHEN$CNTL_REC,STCLASS=BASED);
      218    15953        %CPSL_COMMAND_PARAMETERS (NAME=CPSL_PARAM, STCLASS=AUTO) ;
      219    15971        /*         Fpts                                  */
      220    15972        %FPT_TIME (FPTN=FPT_TIME,STCLASS=AUTO);
      221    15991        %FPT_CLOSE(FPTN=FPT_CLOSE,STCLASS=AUTO);
      222    16033        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
      223    16064        %FPT_DISPLAY(FPTN=FPT_DISPLAY,STCLASS=AUTO);
      224    16077        %FPT_DEVICE(FPTN=FPT_DEVICE,STCLASS=AUTO);
      225    16095        %FPT_OPEN(FPTN=AMR$REC$,STCLASS="BASED(SEG3$)",PFMT="PTR");
      226    16204        %FPT_OPEN(FPTN=FPT_OPEN,STCLASS=AUTO);
      227    16313        %FPT_READ(FPTN=FPT_READ,STCLASS=AUTO);
      228    16352        %FPT_TRMISC(FPTN=FPT_TRMISC,STCLASS=AUTO);
      229    16373        %VLP_SN (FPTN=VLP_SN, STCLASS=AUTO, N=1);
      230    16386          /***** Error codes *****/
      231    16387        %ERR_CODE (NAME=E_BADPASS,MID#=CPE$IBEXMID,CODE#=E$BADPASS,STCLASS=CONSTANT);
      232    16407        %ERR_CODE (NAME=E_QUIT,MID#=CPE$IBEXMID,CODE#=E$QUIT,SEV#=SEV1,STCLASS=CONSTANT);
      233    16427        %ERR_CODE (NAME=E_NOASGN,MID#=CPE$IBEXMID,CODE#=E$NOASGN,STCLASS=CONSTANT);
      234    16447        %ERR_CODE (NAME=E_PASSCHNGE,MID#=CPE$IBEXMID,CODE#=E$PASSCHNGE,STCLASS=CONSTANT);
      235    16467        %VLP_ERRCODE (FPTN=E_NOSUCHLDEV,MID=E,ERR#=E$NOSUCHLDEV,FCG=CP,STCLASS=CONSTANT);
      236    16512        /*E*    ERROR: CPE-E$NOSUCHLDEV-C
      237    16513                MESSAGE: LDEV %%U1 %not set.
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:8    
      238    16514        */
      239    16515        %VLP_ERRCODE (FPTN=E_NOLDEVTHATTYPE,MID=E,ERR#=E$NOLDEVTHATTYPE,FCG=CP,STCLASS=
             16515            CONSTANT);
      240    16560        /*E*    ERROR: CPE-E$NOLDEVTHATTYPE-C
      241    16561                MESSAGE: No LDEVs of %%U1 %type set.
      242    16562        */
      243    16563                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:9    
      244    16564        /**********************************************************************/
      245    16565        /*F*   NAME:   CPE$COMMENT
      246    16566               PURPOSE: The COMMENT command is utilized by a user to direct the
      247    16567                       destination of error commentary before calling a processor.
      248    16568                       It is also used to turn on error commentary which was
      249    16569                       previously interrupted and turned off by the DONT COMMENT
      250    16570                       command.
      251    16571               DESCRIPTION: If ON/OVER/INTO comout is specified, an assignment is
      252    16572                       made for commentary to go to the specified file,device, or
      253    16573                       device stream. If only the reinitiating of commentary is
      254    16574                       desired, which occurs when only the COMMENT command is
      255    16575                       specified, the COMMENT flag is turned on. By default,
      256    16576                       commentary is always turned on at job step beginning.
      257    16577        */
      258    16578        /*D*   NAME:   CPE$COMMENT
      259    16579               CALL:   CALL CPE$COMMENT(P$PCB)
      260    16580               INTERFACE: CPE$GENRUAM,CPE$RFEXT,CPC$WRITEMSGE
      261    16581               INPUT:  BLK$ - pointer to parsed output
      262    16582               OUTPUT: *A file - keyed assign merge record for the M$DO dcb
      263    16583                       B$JIT.FEXT - file extension bit reset for commentary
      264    16584                       B$JIT.PRFLAGS.LIST - flag set indicating commentary
      265    16585               DESCRIPTION: If COMMENT only is specified, commentary is reinitiated
      266    16586                       by turning on the comment flag in the JIT. If ON/OVER/INTO
      267    16587                       comout is specified, a check is made to determine whether
      268    16588                       the command is being executed at job step. An assign merge
      269    16589                       record is generated with destination information specified by
      270    16590                       comout. The key associated with the record is m$do.Since
      271    16591                       this is a new assignment, file extension is reset for m$do.
      272    16592                       Flags are set in the JIT to reflect that the COMMENT
      273    16593                       command was executed.
      274    16594        */
      275    16595        /**********************************************************************/
      276    16596    1   CPE$COMMENT:
      277    16597    1     ENTRY(P$PCB)   ALTRET;
      278    16598        /**/
      279    16599    1     BLK$ = P$PCB.OUT$;
      280    16600        /*
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:10   
      281    16601          ****     No option after comment infers function change
      282    16602        */
      283    16603    1     IF (BLK$->P$B.NSUBLKS=0)
      284    16604    1        THEN
      285    16605    2           DO;
      286    16606    2              B$JIT.PRFLAGS.COMMENT=%YES#; /*Turn on commentary*/
      287    16607    2              RETURN;
      288    16608    2           END;
      289    16609        /*
      290    16610          ****     Must be at job step to direct output
      291    16611        */
      292    16612    1     IF NOT B$JIT.CPFLAGS1.JSTEP
      293    16613    1        THEN
      294    16614    1           GOTO COMMENT70;
      295    16615        /*         Create assign merge record for M$DO   */
      296    16616    1     ONOVERINTO$=BLK$->P$B.SUBLK$(0); /*Bld ptr to keyword*/
      297    16617    1     FID$=BLK$->P$B.SUBLK$(1)->P$B.SUBLK$(0); /*Bld ptr to fid*/
      298    16618    1     CALL CPE$GENRUAM(BLK$,ONOVERINTO$,FID$,ADDR(M$DODCB),'1'B) ALTRET(COMMENT80);
      299    16619    1     CALL CPE$RFEXT(ADDR(M$DODCB));  /*Reset file ext. For M$DO*/
      300    16620    1     B$JIT.PRFLAGS.COMMENT=%YES#;  /*Set comment cmnd flag*/
      301    16621    1     RETURN;
      302    16622    1   COMMENT70:;
      303    16623        /*E*       ERROR: CPE-E$QUIT-E
      304    16624                   MESSAGE:  Command legal at job step - execute QUIT or GO command
      305    16625                   DESCRIPTION: This form of the COMMENT command can only be
      306    16626                                executed when at job step.
      307    16627        */
      308    16628    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_QUIT);
      309    16629    1     ALTRETURN;
      310    16630    1   COMMENT80:;
      311    16631    1     ALTRETURN;
      312    16632                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:11   
      313    16633        /***********************************************************************/
      314    16634        /*F*   NAME:   CPE$DISPLAY
      315    16635               PURPOSE: The DISPLAY command is utilized to display system and
      316    16636                       user information.
      317    16637               DESCRIPTION: The DISPLAY command displays general system
      318    16638                       information if options aren't specified. Information
      319    16639                       displayed by the various options consist of the following:
      320    16640                       1. ALL - displays all information displayable by options
      321    16641                       2. dcbname - displays assignment information for a specific dcb
      322    16642                       3. DCBS - displays assignment information for all dcbs
      323    16643                       4. FLAGS - display settings of control flags
      324    16644                       5. USER - display general user information
      325    16645                       6. SWITCH - display sense switches
      326    16646                       7. TERMINAL - display terminal characteristics
      327    16647                       8. PRIV - display user privileges
      328    16648                       9. DIRECTORY - display file management directory
      329    16649                       10. TABS - display tabs
      330    16650                       11. STEPCC - display step condition codes
      331    16651                       12. SETUP - display the FCOMMAND in :USERS
      332    16652                       13. LIMITS - display service limits
      333    16653                       14. GLOBALS - display GLOBAL defs
      334    16654                       15. VARS - display COMMAND VARIABLES
      335    16655                       16. PLATEN - display PLATEN
      336    16656                       17. RESOURCE - display resources reserved for user
      337    16657                       18. TIME or DATE - display time and date
      338    16658                       19. REPORT - display STEP reporting level.
      339    16659                       20. PRIORITY - display default priority
      340    16660                       21. PROFILE - display current and available profiles
      341    16661                       22. PPRIVS - display processor privileges
      342    16662                       23. WSN - display work station name of origin
      343    16663                       24. BUDGET - display budget limit
      344    16664                       24. BANNERTEXT - display BANNERTEXT information.
      345    16665                       25. REGISTERNAME - display REGISTERNAME information.
      346    16666               REFERENCE: Programmers Reference Manual
      347    16667        */
      348    16668        /*D*   NAME:   CPE$DISPLAY
      349    16669               CALL:   CALL CPE$DISPLAY
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:12   
      350    16670               INPUT:  BLK$ - pointer to parsed output
      351    16671               OUTPUT: requested information to output device
      352    16672               DESCRIPTION: General system information is obtained
      353    16673                       using the m$sysload pmme if no options are specified.
      354    16674                       Otherwise specific options are processed which request
      355    16675                       information contained in the JIT and :USERS record.
      356    16676        */
      357    16677        /**********************************************************************/
      358    16678    1   CPE$DISPLAY:
      359    16679    1     ENTRY(P$PCB)   ALTRET;
      360    16680        /**/
      361    16681    1     BLK$ = P$PCB.OUT$;
      362    16682    1     SEG$2.FPT_WRITE$->FPT$WRITE=CFPT_WRITE;
      363    16683    1     SEG$2.FPT_WRITE$->FPT$WRITE.V_=VECTOR(SEG$2.FPT_WRITE$->
      364    16684    1          FPT$WRITE.V);
      365    16685        /*
      366    16686          **** No options after display only infers ...DISPLAY system info.
      367    16687        */
      368    16688    1     IF (BLK$->P$B.NSUBLKS=0)
      369    16689    1        THEN
      370    16690    2           DO;
      371    16691    2              CALL DISPSYS ALTRET(DISP50);
      372    16692    2              RETURN;
      373    16693    2           END;
      374    16694    1     I=0;
      375    16695    1   DISP5:
      376    16696    2     DO WHILE(I<BLK$->P$B.NSUBLKS);
      377    16697    2        TEMP$=BLK$->P$B.SUBLK$(I);
      378    16698    2   DISP10:
      379    16699                                                         /*
      380    16700                                                         */
      381    16701    3        DO CASE(TEMP$->P$B.CODE);
      382    16702    3         CASE(DALLOPT);
      383    16703    3           CALL DISPUSER ALTRET(DISP50);
      384    16704    3           CALL DISPFLGS ALTRET(DISP50);
      385    16705    3           CALL DISPDCBS ALTRET(DISP50);
      386    16706    3           CALL DISPLDEV ALTRET(DISP50);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:13   
      387    16707    3           CALL DISPNOTIFY ALTRET(DISP50);
      388    16708    3           CALL DISPWHEN ALTRET(DISP50);
      389    16709        /*
      390    16710        ***     Fake out the external   routines to think that they were called by a
      391    16711        ***     command directly. P$PCB.OUT$ needs to point to a block which
      392    16712        ***     has zero sub-blocks, which is just what TEMP$ points to.
      393    16713        */
      394    16714    3           P$PCB.OUT$ = TEMP$;
      395    16715    3           CALL CPF$SWITCH(P$PCB)  ALTRET(DISP50);
      396    16716    3           CALL CPF$TERMINAL(P$PCB) ALTRET(DISP50);
      397    16717    3           CALL CPF$PRIV(P$PCB) ALTRET(DISP50);
      398    16718    3           CALL CPF$PPRIV ALTRET(DISP50);
      399    16719    3           CALL CPI$TABS(P$PCB) ALTRET(DISP50);
      400    16720    3           CALL DISPSTEPCC ALTRET(DISP50);    /*Display step cc's*/
      401    16721    3           CALL CPJ$LIMIT(P$PCB) ALTRET(DISP50); /*Display limits*/
      402    16722    3           CALL CPO$ORES(P$PCB) ALTRET(DISP50); /* Di res */
      403    16723    3           CALL CPH$GLOBAL(P$PCB) ALTRET(DISP50); /*Display globals*/
      404    16724    3           CALL CPG$LET(P$PCB) ALTRET(DISP50); /*Display variables*/
      405    16725    3           CALL CPB$PLATEN(P$PCB) ALTRET(DISP50); /*Display platen*/
      406    16726    3           CALL CPB$REPORT(P$PCB) ALTRET(DISP50); /*Display report*/
      407    16727    3           CALL CPI$PRIORITY(P$PCB) ALTRET(DISP50); /*Display PRIO.*/
      408    16728    3           CALL CPF$PROFILE(P$PCB) ALTRET(DISP50);  /*Display profile*/
      409    16729    3           CALL DISPBUDGET ALTRET(DISP50);  /*Display budget*/
      410    16730    3           CALL DISPWSN ALTRET(DISP50);  /*Display woo*/
      411    16731    3         CASE(DDCBSOPT);
      412    16732    3           CALL DISPDCBS ALTRET(DISP50);
      413    16733    3         CASE(DFLAGSOPT);
      414    16734    3           CALL DISPFLGS ALTRET(DISP50);
      415    16735    3         CASE(DUSEROPT);
      416    16736    3           CALL DISPUSER ALTRET(DISP50);
      417    16737    3         CASE(DDCBOPT);
      418    16738    3           DCB$=TEMP$->P$B.SUBLK$(0);
      419    16739    3           CALL CXB$CHKFORT(DCB$);            /*Cnvrt. If fort dcb*/
      420    16740    3           CPSL_PARAM = %NO# ;
      421    16741    3           CALL CXC$READAM(DCB$,M$IBEX1_NUM,CPSL_PARAM) ;
      422    16742    3           IF CPSL_PARAM.ERRCODE ~= %NO#
      423    16743    3             THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:14   
      424    16744    3               IF CPSL_PARAM.FLAGS.REPORTED_TO_USER
      425    16745    3                 THEN
      426    16746    3                   GOTO DISP45 ;
      427    16747    3                 ELSE
      428    16748    4                   DO ;
      429    16749    4                     B$JIT.USRERR = CPSL_PARAM.ERRCODE ;
      430    16750    4                     GOTO DISP45 ;
      431    16751    4                   END ;
      432    16752    3           TAB_VAL=3;                         /*Set tab to 3*/
      433    16753    3           CALL DISPDCB(DCB$,TAB_VAL) ALTRET(DISP47);
      434    16754    3   DISP12:;
      435    16755    3           CALL CPC$RELSEG (SEG3$);
      436    16756    3         CASE(DSWITCHOPT);
      437    16757    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPF$SWITCH routine*/
      438    16758    3           CALL CPF$SWITCH(P$PCB)  ALTRET(DISP50);
      439    16759    3         CASE(DTERMINALOPT);
      440    16760    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPF$TERMINAL routine */
      441    16761    3           CALL CPF$TERMINAL(P$PCB) ALTRET(DISP50);
      442    16762    3         CASE(DPRIVOPT);
      443    16763    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPF$PRIV routine */
      444    16764    3           CALL CPF$PRIV(P$PCB) ALTRET(DISP50);
      445    16765    3         CASE(DPPRIVOPT);
      446    16766    3           CALL CPF$PPRIV  ALTRET(DISP50);
      447    16767    3         CASE(DTABSOPT);
      448    16768    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPI$TABS routine */
      449    16769    3           CALL CPI$TABS(P$PCB) ALTRET(DISP50);
      450    16770    3         CASE(DDIROPT);
      451    16771    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPI$DIR routine*/
      452    16772    3           CALL CPI$DIRECTORY(P$PCB) ALTRET(DISP50);
      453    16773    3         CASE(DSTEPCCOPT);
      454    16774    3           CALL DISPSTEPCC ALTRET(DISP50);
      455    16775    3         CASE(DSETUPOPT);
      456    16776    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPI$SETUP routine*/
      457    16777    3           CALL CPI$SETUP(P$PCB) ALTRET(DISP50);
      458    16778    3         CASE(DLIMITSOPT);
      459    16779    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPJ$LIMIT routine*/
      460    16780    3           CALL CPJ$LIMIT(P$PCB) ALTRET(DISP50);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:15   
      461    16781    3         CASE(DRESOURCEOPT);
      462    16782    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPO$ORES routine*/
      463    16783    3           CALL CPO$ORES(P$PCB) ALTRET(DISP50);
      464    16784    3         CASE(DGLOBALSOPT);
      465    16785    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPH$GLOBAL routine*/
      466    16786    3           CALL CPH$GLOBAL(P$PCB) ALTRET(DISP50);
      467    16787    3         CASE(%DNOTIFYOPT#) ;
      468    16788    3           CALL DISPNOTIFY ALTRET(DISP50) ;
      469    16789    3         CASE(%DLDEVOPT#,%DLDEVSOPT#) ;
      470    16790    3           CALL DISPLDEV ALTRET(DISP50) ;
      471    16791    3         CASE(DPLATENOPT);
      472    16792    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPB$PLATEN routine*/
      473    16793    3           CALL CPB$PLATEN(P$PCB) ALTRET(DISP50);
      474    16794    3         CASE(DTIMEOPT);
      475    16795    3           CALL CPE$TIME(P$PCB) ALTRET(DISP50);
      476    16796    3         CASE(DVARIABLESOPT);
      477    16797    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPG$LET routine */
      478    16798    3           CALL CPG$LET(P$PCB) ALTRET(DISP50);
      479    16799    3         CASE(%DBANNERTEXTOPT#, %DREGISTERNAMEOPT#);
      480    16800    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPG$LET routine */
      481    16801    3           CALL CPG$LET(P$PCB) ALTRET(DISP50);
      482    16802    3         CASE(DREPORTOPT);
      483    16803    3           P$PCB.OUT$=TEMP$;                /*Fake out CPB$REPORT routine */
      484    16804    3           CALL CPB$REPORT(P$PCB) ALTRET(DISP50);
      485    16805    3         CASE(DPRIOOPT);
      486    16806    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPI$PRIORITY routine*/
      487    16807    3           CALL CPI$PRIORITY(P$PCB) ALTRET(DISP50);
      488    16808    3         CASE(DPROFILEOPT);
      489    16809    3           CALL CPF$DIPROFILES(P$PCB) ALTRET(DISP50);
      490    16810    3         CASE(DBUDGETOPT);
      491    16811    3           CALL DISPBUDGET  ALTRET(DISP50);
      492    16812    3         CASE(%DWHENOPT#);
      493    16813    3           CALL DISPWHEN  ALTRET(DISP50);
      494    16814    3         CASE(DWSNOPT);
      495    16815    3           CALL DISPWSN  ALTRET(DISP50);
      496    16816    3         END DISP10;
      497    16817    2        I=I+1;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:16   
      498    16818    2     END DISP5;
      499    16819    1     IF ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST ~= 0
      500    16820    1        THEN   /* Errors to report */
      501    16821    1           ALTRETURN;
      502    16822    1        ELSE   /* Normal return */
      503    16823    1           RETURN;
      504    16824    1   DISP45: ;
      505    16825        /*         **** Check if a/m record for dcb existed */
      506    16826    1     IF (B$JIT.USRERR.CODE=%E$NOKEY)
      507    16827    1        THEN
      508    16828    2           DO;
      509    16829        /*E*             ERROR: CPE-E$NOASGN-E
      510    16830                        MESSAGE: Dcb% %U1% isn't assigned
      511    16831                         DESCRIPTION: The dcb specified by the user is not assigned.
      512    16832        */
      513    16833    2              CPOS = TEMP$ -> P$S.CPOS;
      514    16834    2              CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_NOASGN);
      515    16835    2              B$JIT.USRERR.CODE=0;
      516    16836    2              GOTO DISP12;
      517    16837    2           END;
      518    16838    1   DISP47: ;
      519    16839    1           CALL CPC$RELSEG (SEG3$);
      520    16840    1   DISP50: ;
      521    16841    1     ALTRETURN;
      522    16842                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:17   
      523    16843        /**********************************************************************/
      524    16844        /*F*   NAME:   CPE$DONT
      525    16845               PURPOSE: The DONT command is utilized by a user to perform the
      526    16846                       following functions:
      527    16847                       1. LIST - Refrain from outputting listing output from an
      528    16848                                 from an assembly or compilation.
      529    16849                       2. COMMENT - Refrain from outputting commentary from an
      530    16850                                    assembly or compilation.
      531    16851                       3. ECHO - Refrain from echoing commands being executed
      532    16852                                 from a command file or being executed in batch mode.
      533    16853                       4. ACCEPT - Refrain from outputting SEND,BROADCAST and tape
      534    16854                                   mounting information .
      535    16855                       5. DRIBBLE - Terminate recording of interactive terminal
      536    16856                                    transactions.
      537    16857                       5. EXPOUND - Inhibits printing of the "Type ? for details", and
      538    16858                                    other error-recovery dialog.
      539    16859                       6. POINT - specifies that errors are to be pointed out with a
      540    16860                                  longer, in-line method rather than with the
      541    16861                                  finger character ("^").
      542    16862                       7. POSITION - specifies that the error-reporting logic in GETCMD
      543    16863                                     should not attempt to place the user's cursor at
      544    16864                                     the location of the first reported error.
      545    16865               DESCRIPTION: For LIST and COMMENT, specific flags
      546    16866                       are looked at by various processors, are reset to
      547    16867                       indicate that the specified output isn't desired.
      548    16868                       For ECHO, a flag, which is checked prior to echoing
      549    16869                       command file commands, is reset.
      550    16870        */
      551    16871        /*D*   NAME:   CPE$DONT
      552    16872               CALL:   CALL CPE$DONT(P$PCB)
      553    16873               INTERFACE: CPC$IQUIT
      554    16874               INPUT:  BLK$ - pointer to parsed output
      555    16875               OUTPUT: B$JIT.PRFLAGS.COMMENT - reset
      556    16876                       B$JIT.PRFLAGS.LIST - reset
      557    16877                       B$JIT.PRFLAGS.EXPOUND - reset
      558    16878                       B$JIT.PRFLAGS.POINT - reset
      559    16879                       B$JIT.PRFLAGS.POSITION - reset
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:18   
      560    16880                       B$JIT.CPFLAGS1.CP_ECHO - reset
      561    16881               DESCRIPTION: When the COMMENT or LIST option is encountered,
      562    16882                       the pertinent flag in the JIT is reset to indicate supression
      563    16883                       of output is desired.
      564    16884                       For ECHO, a flag in the JIT is reset to indicate
      565    16885                       supression of command file command echoing.
      566    16886                       For ACCEPT the M$TRMISC pmme is executed to prevent SEND,
      567    16887                       BROADCAST and tape mounting info. from being output.
      568    16888                       For DRIBBLE, the M$DRIBBLE pmme is executed to terminate
      569    16889                       recording of interactive terminal transactions.
      570    16890        */
      571    16891        /***********************************************************************/
      572    16892    1   CPE$DONT:
      573    16893    1     ENTRY(P$PCB)   ALTRET;
      574    16894        /**/
      575    16895    1     BLK$ = P$PCB.OUT$;
      576    16896    1     I=0;
      577    16897    1   DONT5:
      578    16898    2     DO WHILE (I<BLK$->P$B.NSUBLKS);
      579    16899    2        TEMP$=BLK$->P$B.SUBLK$(I);
      580    16900    2   DONT10:
      581    16901    3        DO CASE(TEMP$->P$B.CODE);
      582    16902    3         CASE(DPROTECTOPT);
      583    16903    3           B$JIT.CPFLAGS1.PROTECT = %NO# ;
      584    16904        /**/
      585    16905    3         CASE(DNOTIFYOPT);
      586    16906    3            B$JIT.CPFLAGS1.NOTIFY = %NO# ;
      587    16907        /**/
      588    16908    3         CASE(DLISTOPT);
      589    16909    3           B$JIT.PRFLAGS.LIST=%NO#; /*Reset list flag*/
      590    16910        /**/
      591    16911    3         CASE(DCOMMENTOPT);
      592    16912    3           B$JIT.PRFLAGS.COMMENT=%NO#; /*Reset comment flags*/
      593    16913        /**/
      594    16914    3         CASE(DECHOOPT);
      595    16915    3           B$JIT.CPFLAGS1.ECHO = %NO# ;
      596    16916        /**/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:19   
      597    16917    3         CASE(DEXPOUNDOPT);
      598    16918    3           B$JIT.PRFLAGS.EXPOUND = %NO#;
      599    16919        /**/
      600    16920    3         CASE(DPOINTOPT);
      601    16921    3           B$JIT.PRFLAGS.POINT = %NO#;
      602    16922        /**/
      603    16923    3         CASE(DPOSITIONOPT);
      604    16924    3           B$JIT.PRFLAGS.POSITION = %NO#;
      605    16925        /**/
      606    16926    3         CASE(DWHENOPT);
      607    16927    3           IF B$JIT.CPFLAGS1.WHEN_INPUT
      608    16928    3             THEN
      609    16929    4               DO ;
      610    16930    4                 FPT_CLOSE = CFPT_CLOSE;
      611    16931    4                 FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
      612    16932    4                 FPT_CLOSE.V.DCB#=M$IBEX1_NUM;
      613    16933    4                 FPT_CLOSE.V.DISP#=%SAVE#;
      614    16934    4                 CALL CPG$GET_WHEN_CNTL_REC(WHEN_CNTL_REC_CHANGED, STAR_S_IS_OPEN)
      615    16935    4                                                                  ALTRET(DONT75) ;
      616    16936    4                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV =
      617    16937    4                                       SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.CUR_LEV ;
      618    16938    4                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(SEG$2.WHEN_CNTL_REC$
      619    16939    4                                          ->WHEN$CNTL_REC.CUR_LEV) = %WHEN_DONT# ;
      620    16940    4                 CALL CPG$PUT_WHEN_CNTL_REC(STAR_S_IS_OPEN) WHENALTRETURN
      621    16941    5                       DO ;
      622    16942    5                         CALL M$CLOSE(FPT_CLOSE) ALTRET(DONT75) ;
      623    16943    5                         GOTO DONT75 ;
      624    16944    5                       END ; /* Whenaltreturn Do */
      625    16945    4                 CALL M$CLOSE(FPT_CLOSE) ALTRET(DONT75) ;
      626    16946    4               END ; /* Then Do */
      627    16947    3           B$JIT.PRFLAGS.WHEN = %NO# ;
      628    16948        /**/
      629    16949    3         CASE(DDRIBBLEOPT);
      630    16950    3           FPT_DRIBBLE = CFPT_DRIBBLE;
      631    16951    3           FPT_DRIBBLE.V_ = VECTOR(FPT_DRIBBLE.V);
      632    16952    3           FPT_DRIBBLE.V.DRIBBLE# = %NO#;
      633    16953    3           CALL M$DRIBBLE(FPT_DRIBBLE) ALTRET(DONT75);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:20   
      634    16954        /**/
      635    16955    3         CASE(DACCEPTOPT);
      636    16956    3           FPT_TRMISC = CFPT_TRMISC;
      637    16957    3           FPT_TRMISC.V_ = VECTOR(FPT_TRMISC.V);
      638    16958    3           FPT_TRMISC.V.DCB# = M$UC_NUM;
      639    16959    3           J = 0;
      640    16960    3           IF TEMP$->P$B.NSUBLKS = 0
      641    16961    3             THEN  /* No options specified, assume ALL */
      642    16962    4               DO ;
      643    16963    4                 FPT_TRMISC.V.SEND# = %NO#;
      644    16964    4                 FPT_TRMISC.V.BROADCAST# = %NO#;
      645    16965    4                 FPT_TRMISC.V.ANNOUNCE# = %NO#;
      646    16966    4               END;  /* Then Do */
      647    16967    3   DONT15:
      648    16968    4           DO WHILE (J<TEMP$->P$B.NSUBLKS);
      649    16969    4              TEMP1$ = TEMP$->P$B.SUBLK$(J);
      650    16970    4   DONT20:
      651    16971    5              DO CASE(TEMP1$->P$B.CODE);
      652    16972    5               CASE(AC_ANNOUNCE);
      653    16973    5                 FPT_TRMISC.V.ANNOUNCE# = %NO#;
      654    16974    5               CASE(AC_BROADCAST);
      655    16975    5                 FPT_TRMISC.V.BROADCAST# = %NO#;
      656    16976    5               CASE(AC_SEND);
      657    16977    5                 FPT_TRMISC.V.SEND# = %NO#;
      658    16978    5               CASE(AC_ALL);
      659    16979    5                 FPT_TRMISC.V.SEND# = %NO#;
      660    16980    5                 FPT_TRMISC.V.BROADCAST# = %NO#;
      661    16981    5                 FPT_TRMISC.V.ANNOUNCE# = %NO#;
      662    16982    5               END DONT20;
      663    16983    4              J = J+1;
      664    16984    4           END DONT15;
      665    16985    3           CALL M$TRMISC (FPT_TRMISC) ALTRET(DONT75);
      666    16986    3         END DONT10;
      667    16987    2        I=I+1;
      668    16988    2     END DONT5;
      669    16989    1     RETURN;
      670    16990    1   DONT75: ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:21   
      671    16991    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      672    16992    1     ALTRETURN;
      673    16993                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:22   
      674    16994        /**********************************************************************/
      675    16995        /*F*   NAME:   CPE$ECHO
      676    16996               PURPOSE: The ECHO command is utilized to initiate echoing of
      677    16997                       commands being executed from a command file.
      678    16998               DESCRIPTION: The echo-command flag is turned on so that command
      679    16999                       file commands are echoed upon execution.
      680    17000               REFERENCE: Programmers Reference Manual
      681    17001        */
      682    17002        /*D*   NAME:   CPC$ECHO
      683    17003               CALL:   CALL CPC$ECHO(P$PCB)
      684    17004               INPUT:  BLK$ - pointer to parsed output
      685    17005               OUTPUT: B$JIT.CPFLAGS1.CP_ECHO# - echo command flag set
      686    17006               DESCRIPTION: The echo command flag is set in the JIT and
      687    17007                       subsequently tested to determine if command file
      688    17008                       commands should be echoed.
      689    17009        */
      690    17010        /**********************************************************************/
      691    17011    1   CPE$ECHO:
      692    17012    1     ENTRY(P$PCB)   ALTRET;
      693    17013    1     B$JIT.CPFLAGS1.ECHO = %YES# ;
      694    17014    1     RETURN;
      695    17015                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:23   
      696    17016        /**********************************************************************/
      697    17017        /*F*   NAME:   CPE$EJECT
      698    17018               PURPOSE: The EJECT command causes the output device to do a
      699    17019                       page eject.
      700    17020               DESCRIPTION: The EJECT command will do an M$DEVICE with PAGE=YES.
      701    17021               REFERENCE: Programmers Reference Manual
      702    17022        */
      703    17023        /*D*   NAME:   CPE$EJECT
      704    17024               CALL:   CALL CPE$EJECT(P$PCB)
      705    17025               INPUT:  BLK$ - pointer to parsed output
      706    17026               OUTPUT:
      707    17027               DESCRIPTION: The EJECT command will do an M$DEVICE with PAGE=YES.
      708    17028        */
      709    17029        /**********************************************************************/
      710    17030    1   CPE$EJECT:
      711    17031    1     ENTRY(P$PCB)   ALTRET;
      712    17032    1     FPT_DEVICE = CFPT_DEVICE ;
      713    17033    1     FPT_DEVICE.V_ = VECTOR(FPT_DEVICE.V) ;
      714    17034    1     BLK$ = P$PCB.OUT$;
      715    17035    1     IF BLK$ -> P$B.NSUBLKS = 0
      716    17036    1       THEN
      717    17037    2         DO;     /* EJECT */
      718    17038    2           CALL CPC$OPEN_LL ;
      719    17039    2           DCB# = SEG$2.LLDCB# ;
      720    17040    2           FPT_DEVICE.V.PAGE# = %YES# ;
      721    17041    2           STREAM_OPEN = %NO#;
      722    17042    2         END;  /* Then Do */
      723    17043    1       ELSE
      724    17044    2         DO;     /* EJECT LDEVnn */
      725    17045    2           IF BLK$ -> P$B.SUBLK$(0) -> P$B.NSUBLKS = 1
      726    17046    2             THEN
      727    17047    2               RES# = BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) -> P$S.TEXT;
      728    17048    2             ELSE
      729    17049    2               CALL CONCAT(RES#, BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) -> P$S.TEXT,
      730    17050    2                                 BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(1) -> P$S.TEXT);
      731    17051    2           CALL FIND_OR_CREATE_STREAM(RES#, %NO#, DCB#, STREAM_OPEN) WHENALTRETURN
      732    17052    3                                      DO;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:24   
      733    17053    3                                        BAD_LDEV_NAME.SIZ = 4;
      734    17054    3                                        BAD_LDEV_NAME.TEXT = RES#;
      735    17055    3                                        CALL CPC$WRITEMSGE(E_NOSUCHLDEV,,BAD_LDEV_NAME,
             17055                                                 ,,%YES#);
      736    17056    3                                        GOTO EJECT_RET;
      737    17057    3                                      END;  /* Whenaltreturn Do */
      738    17058
      739    17059    2           IF BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) -> P$S.TEXT = 'UC' AND
      740    17060    2                   BLK$ -> P$B.SUBLK$(0) -> P$B.NSUBLKS = 2  /* UCnn */
      741    17061    2             THEN
      742    17062    2               FPT_DEVICE.V.CLEAR# = %YES# ;
      743    17063    2             ELSE
      744    17064    2               FPT_DEVICE.V.PAGE# = %YES# ;
      745    17065    2         END;  /* Else Do */
      746    17066    1     FPT_DEVICE.V.DCB# = DCB#;
      747    17067    1     CALL M$DEVICE(FPT_DEVICE) ;
      748    17068
      749    17069    1     IF STREAM_OPEN
      750    17070    1       THEN
      751    17071    1         CALL CLOSE_DCB(DCB#);
      752    17072
      753    17073    1   EJECT_RET:
      754    17074    1     RETURN;
      755    17075
      756    17076          %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:25   
      757    17077                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:26   
      758    17078        /**********************************************************************/
      759    17079        /*F*   NAME:   CPE$EXPOUND
      760    17080               PURPOSE: The EXPOUND command is utilized to request the long (naive-user)
      761    17081                       error-reporting dialog (i.e., print useful suggestions).
      762    17082               DESCRIPTION: The expound flag is turned on so that the XUG$COMMON package
      763    17083                       will choose to print useful hints when an error occurs.
      764    17084               REFERENCE: Programmers Reference Manual
      765    17085        */
      766    17086        /*D*   NAME:   CPC$EXPOUND
      767    17087               CALL:   CALL CPC$EXPOUND(P$PCB)
      768    17088               INPUT:  BLK$ - pointer to parsed output
      769    17089               OUTPUT: B$JIT.PRFLAGS.EXPOUND - expound flag set
      770    17090               DESCRIPTION: The expound flag is set in the JIT and
      771    17091                       subsequently tested to determine if hints should be
      772    17092                       provided to the user after a syntax error occurs.
      773    17093        */
      774    17094        /**********************************************************************/
      775    17095    1   CPE$EXPOUND:
      776    17096    1     ENTRY(P$PCB)   ALTRET;
      777    17097    1     B$JIT.PRFLAGS.EXPOUND = %YES#;
      778    17098    1     RETURN;
      779    17099                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:27   
      780    17100        /**********************************************************************/
      781    17101        /*F*   NAME:   CPE$LIST
      782    17102               PURPOSE: The LIST command is utilized by a user to direct the
      783    17103                       destination of listing output before calling a
      784    17104                       processor. It is also used to turn on listing output which
      785    17105                       was previously interrupted and turned off by the DONT LIST
      786    17106                       command.
      787    17107               DESCRIPTION: The list flag is turned on if the reinitiating of
      788    17108                       listing output is desired. If ON/OVER/INTO listout is
      789    17109                       specified, an assignment is made for output to go to the
      790    17110                       specified file, device or device stream. By default,
      791    17111                       listing output is always turned on at job step beginning.
      792    17112               REFERENCE: Programmers Reference Manual
      793    17113        */
      794    17114        /*D*   NAME:   CPE$LIST
      795    17115               CALL:   CALL CPE$LIST(P$PCB)
      796    17116               INTERFACE: CPE$GENRUAM,CPC$WRITEMSGE
      797    17117               INPUT:  BLK$ - pointer to parsed output
      798    17118               OUTPUT: Keyed assign merge record to *A file(key for listout=#4)
      799    17119                       B$JIT.FEXT - file extension bit reset for listout
      800    17120                       B$JIT.PRFLAGS.LS - flag set indicating listout dcb assigned
      801    17121                       B$JIT.PRFLAGS.LIST - flag set indicating LIST command executed
      802    17122               DESCRIPTION: If LIST only is specified, listing output is
      803    17123                       reinitiated by turning on the list flag in the JIT. If
      804    17124                       ON/OVER/INTO listout is specified, a check is made to determine
      805    17125                       whether the command is being executed at job step.
      806    17126                       An assign merge record is generated with destination
      807    17127                       information specified by listout. The key associated with
      808    17128                       the record is #4. File extension is reset for listout as
      809    17129                       this is a new assignment. Flags are set to indicate the
      810    17130                       fourth command-line dcb is assigned and to indicate a LIST
      811    17131                       command was executed.
      812    17132        */
      813    17133        /**********************************************************************/
      814    17134    1   CPE$LIST:
      815    17135    1     ENTRY(P$PCB)   ALTRET;
      816    17136        /**/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:28   
      817    17137    1     BLK$ = P$PCB.OUT$;
      818    17138        /*
      819    17139          **** No options after list indicates function change
      820    17140        */
      821    17141    1     IF (BLK$->P$B.NSUBLKS=0)
      822    17142    1        THEN
      823    17143    2           DO;
      824    17144                                                /* Set list to on                     */
      825    17145    2              B$JIT.PRFLAGS.LIST=%YES#;
      826    17146    2              RETURN;
      827    17147    2           END;
      828    17148        /*
      829    17149          **** Must be at job step to direct output
      830    17150        */
      831    17151    1     IF NOT B$JIT.CPFLAGS1.JSTEP
      832    17152    1        THEN
      833    17153    1           GOTO LIST70;
      834    17154        /*
      835    17155          **** Create assign merge record for LISTOUT(#4)
      836    17156        */
      837    17157    1     ONOVERINTO$=BLK$->P$B.SUBLK$(0); /*Bld ptr to keyword*/
      838    17158    1     FID$=BLK$->P$B.SUBLK$(1)->P$B.SUBLK$(0); /*Bld ptr to fid*/
      839    17159    1     CALL CPE$GENRUAM(BLK$,ONOVERINTO$,FID$,ADDR(LISTDCB),'1'B) ALTRET(LIST80);
      840    17160    1     B$JIT.FEXT(FEXT_LIST)=%NO#; /*Reset file extension*/
      841    17161    1     B$JIT.PRFLAGS.LS=%YES#;  /*Indicate listout assigned*/
      842    17162    1     B$JIT.PRFLAGS.LIST=%YES#; /*Set  list cmnd flag*/
      843    17163    1     RETURN;
      844    17164    1   LIST70: ;
      845    17165    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_QUIT);
      846    17166    1     ALTRETURN;
      847    17167    1   LIST80: ;
      848    17168    1     ALTRETURN;
      849    17169                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:29   
      850    17170        /**********************************************************************/
      851    17171        /*F*   NAME:   CPE$PASSWORD
      852    17172               PURPOSE: The PASSWORD command is utilized by a user to create,
      853    17173                       delete, or modify his logon password. Security is enforced
      854    17174                       by requiring the old passwprd to be specified before the new
      855    17175                       password is entered.
      856    17176               DESCRIPTION: The user's record is read from the :HLP file
      857    17177                       and the old password
      858    17178                       , if specified by the user, is compared with the current
      859    17179                       password. If it matches, the new password is stored in the
      860    17180                       :HLP   record. If a new password is not specified, the old
      861    17181                       password in the :HLP   record is reset.
      862    17182               REFERENCE: Programmers Reference Manual
      863    17183        */
      864    17184        /*D*   NAME:   CPE$PASSWORD
      865    17185               CALL:   CALL CPE$PASSWORD(P$PCB)
      866    17186               INTERFACE: CPC$RDUSERS,CPC$WRUSERS
      867    17187               INPUT:  BLK$ - pointer to parsed output
      868    17188               OUTPUT: modified :HLP   record
      869    17189               DESCRIPTION: The :HLP   record is read in and a determination made
      870    17190                       if the old password is  specified on the PASSWORD command.
      871    17191                       If the old password is  specified, it is compared with the
      872    17192                       :HLP   password. If the passwords are the same, the modification
      873    17193                       or resetting of the password in :HLP is permitted.
      874    17194                       Establishing a new password without specifying the old
      875    17195                       password is permitted if one does not already exist. If a new
      876    17196                       password is not specified, the old password in :HLP is
      877    17197                       reset. Password scrambling is performed for all passwords.
      878    17198        */
      879    17199        /***********************************************************************/
      880    17200    1   CPE$PASSWORD:
      881    17201    1     ENTRY(P$PCB)   ALTRET;
      882    17202        /**/
      883    17203    1     BLK$ = P$PCB.OUT$;
      884    17204        /*
      885    17205          **** Read in users record from :HLP
      886    17206        */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:30   
      887    17207    1     CALL CPC$RDHLP (M$IBEX1_NUM,%UPDATE#) ALTRET(PASSWORD50);
      888    17208        /*
      889    17209          ****  No option after password infers ... Account is not passworded or
      890    17210          ****  User forgot to specify the password.
      891    17211        */
      892    17212    1     OLDPASSWORD=' ';
      893    17213    1     NEWPASSWORD=' ';
      894    17214    1     I=0;
      895    17215    1     IF (BLK$->P$B.NSUBLKS~=0)
      896    17216    1        THEN
      897    17217    2   PASS5:  DO WHILE (I<BLK$->P$B.NSUBLKS);
      898    17218    2              TEMP$=BLK$->P$B.SUBLK$(I);
      899    17219    3   PASS10:    DO CASE(TEMP$->P$B.CODE);
      900    17220    3               CASE(OLDPASSWDOPT);
      901    17221    3                 OLDPASSWORD=TEMP$->P$S.TEXT;
      902    17222    3               CASE(NEWPASSWDOPT);
      903    17223    3                 NEWPASSWORD=TEMP$->P$S.TEXT;
      904    17224    3               END PASS10;
      905    17225    2              I=I+1;
      906    17226    2           END PASS5;
      907    17227        /*
      908    17228          ****  Scramble the passwords ... Assuming its O.K to scramble blanks
      909    17229        */
      910    17230    1     CALL ASZ$SCRAMBLE(OLDPASSWORD);                        /*Scramble old password*/
      911    17231    1     CALL ASZ$SCRAMBLE(NEWPASSWORD);                        /*Scramble new password*/
      912    17232        /*
      913    17233          ****  Check if old password matches password in :HLP
      914    17234        */
      915    17235    1     IF OLDPASSWORD ~= SEG$2.HLP$ -> KL$DREC.PASSWORD
      916    17236
      917    17237    1        THEN /* passwords dont match */
      918    17238    1           GOTO PASSWORD60;
      919    17239        /*
      920    17240          ****  O.K. To modify :HLP .... Reset to blanks if new pass. Wasn't spec'd
      921    17241        */
      922    17242    1     SEG$2.HLP$ -> KL$DREC.PASSWORD = NEWPASSWORD;
      923    17243    1     CALL CPC$WRHLP (M$IBEX1_NUM) ALTRET(PASSWORD50);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:31   
      924    17244        /*
      925    17245          **** Close and save :HLP
      926    17246        */
      927    17247    1     FPT_CLOSE = CFPT_CLOSE;
      928    17248    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
      929    17249    1     FPT_CLOSE.V.DCB#=M$IBEX1_NUM;
      930    17250    1     FPT_CLOSE.V.DISP#=%SAVE#;
      931    17251    1     CALL M$CLOSE(FPT_CLOSE) ALTRET(PASSWORD70);
      932    17252        /*E*       ERROR: CPE-E$PASSCHNGE-C
      933    17253               MESSAGE: Password change successful
      934    17254                   DESCRIPTION: The password in the :HLP   file was modified
      935    17255                                using the PASSWORD command.
      936    17256        */
      937    17257    1     CALL CPC$WRITEMSGE(E_PASSCHNGE,,,,,%YES#);
      938    17258    1     RETURN;
      939    17259    1   PASSWORD50:;
      940    17260    1     ALTRETURN;
      941    17261    1   PASSWORD60:;
      942    17262        /*E*       ERROR: CPE-E$BADPASS-E
      943    17263               MESSAGE: Password supplied doesn't match current password
      944    17264                   DESCRIPTION: The old password specified on the PASSWORD command
      945    17265                                doesn't correspond with the :HLP   password.
      946    17266        */
      947    17267    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_BADPASS);
      948    17268    1     GOTO PASSWORD68;
      949    17269    1   PASSWORD68:;
      950    17270        /* Close dcb */
      951    17271    1     FPT_CLOSE = CFPT_CLOSE;
      952    17272    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
      953    17273    1     FPT_CLOSE.V.DCB#=M$IBEX1_NUM;
      954    17274    1     FPT_CLOSE.V.DISP#=%SAVE#;
      955    17275    1     CALL M$CLOSE(FPT_CLOSE) ALTRET(PASSWORD70);
      956    17276    1     ALTRETURN;
      957    17277    1   PASSWORD70:;
      958    17278    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
      959    17279    1     ALTRETURN;
      960    17280                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:32   
      961    17281        /*F*    NAME:    CPE$POINT
      962    17282                PURPOSE:    This entry point processes the IBEX POINT command.
      963    17283                         When the "POINT" flag is set, the XUG$ERRPTR routine (used
      964    17284                         in many places throughout the system) will indicate the
      965    17285                         location of an error with a single "^".  When POINT is reset,
      966    17286                         a more accurate, but verbose indication is given.
      967    17287        */
      968    17288    1   CPE$POINT:
      969    17289    1     ENTRY(P$PCB)   ALTRET;
      970    17290        /**/
      971    17291    1     B$JIT.PRFLAGS.POINT = %YES#;
      972    17292    1     RETURN;
      973    17293        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:33   
      974    17294        /*F*    NAME:    CPE$POSITION
      975    17295                PURPOSE:    This entry point processes the IBEX POSITION command.
      976    17296                         When the POSITION flag is set, the XUG$ERRPTR routine (used
      977    17297                         in many places throughout the system) will issue an M$SINPUT
      978    17298                         service which has the effect of repositioning the user's
      979    17299                         escape-D cursor to the position of the first error reported.
      980    17300        */
      981    17301    1   CPE$POSITION:
      982    17302    1     ENTRY(P$PCB)   ALTRET;
      983    17303        /**/
      984    17304    1     B$JIT.PRFLAGS.POSITION = %YES#;
      985    17305    1     RETURN;
      986    17306        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:34   
      987    17307        /*F*    NAME:    CPE$PROTECT
      988    17308                PURPOSE:    This entry point processes the IBEX PROTECT command.
      989    17309                         When IBEX is running in PROTECT mode, the user is prompted
      990    17310                         with a QUIT? message whenever processing his command would
      991    17311                         result in a run-down of an interrupted activity, e.g. calling
      992    17312                         a new program at Control-Y time.
      993    17313        */
      994    17314    1   CPE$PROTECT:
      995    17315    1     ENTRY(P$PCB)   ALTRET;
      996    17316        /**/
      997    17317    1     B$JIT.CPFLAGS1.PROTECT = %YES# ;
      998    17318    1     RETURN;
      999    17319        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:35   
     1000    17320        /***********************************************************************/
     1001    17321        /*F*   NAME:   CPE$TIME
     1002    17322               PURPOSE: The TIME command is utilized to determine the time and date.
     1003    17323               DESCRIPTION: The time and date is output to the user.
     1004    17324        */
     1005    17325        /*     NAME:   CPE$TIME
     1006    17326               CALL:   Call CPE$TIME(P$PCB)
     1007    17327               INTERFACE: CPE$LIST
     1008    17328               INPUT:  BLK$ - pointer to parsed output
     1009    17329               OUTPUT: output through M$LL
     1010    17330               DESCRIPTION: The time and date is output to  the appropriate device.
     1011    17331                       The time and date is output through M$UC if in interactive
     1012    17332                       mode, otherwise through M$LL.
     1013    17333        */
     1014    17334        /***********************************************************************/
     1015    17335    1   CPE$TIME:
     1016    17336    1     ENTRY(P$PCB)   ALTRET;
     1017    17337    1     TMDATEBUFF=' ';                       /*Blank out buffer*/
     1018    17338    1     FPT_TIME = CFPT_TIME;
     1019    17339    1     FPT_TIME.V_ = VECTOR(FPT_TIME.V);
     1020    17340    1     FPT_TIME.DATE_=VECTOR(TMDATE.DATE);
     1021    17341    1     FPT_TIME.TIME_=VECTOR(TMDATE.TIME);
     1022    17342    1     CALL M$TIME(FPT_TIME);
     1023    17343    1     TMDATE.TIME.SEC=' ';                  /*Do'nt print SEC.*/
     1024    17344    1     TMDATE.TIME.MSEC=' ';                 /*Don't print msecs*/
     1025    17345        /*
     1026    17346          ****     Init. Fpt through which time is to be written
     1027    17347        */
     1028    17348    1     SEG$2.FPT_WRITE$->FPT$WRITE=CFPT_WRITE;
     1029    17349    1     SEG$2.FPT_WRITE$->FPT$WRITE.V_=VECTOR(SEG$2.FPT_WRITE$->FPT$WRITE.V);
     1030    17350    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(TMDATE);
     1031    17351    1     IF (ADDR(P$PCB) ~= ADDR(NIL))AND
     1032    17352    1          (P$PCB.OUT$ -> P$B.CODE = JOBCMND)
     1033    17353    1        THEN
     1034    17354    2           DO;
     1035    17355    2              IN$ = ADDR(TMDATEBUFF);          /* Print batch job heading line */
     1036    17356    2              OUTBUFF$ = ADDR(OUTBUFF);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:36   
     1037    17357    2              DEST$ = OUTBUFF$;
     1038    17358    2              OUTBUFF = ' ';
     1039    17359    2              TAB_VAL = 1;
     1040    17360        /**/
     1041    17361    2              SEG$2.FPT_WRITE$ -> FPT$WRITE.BUF_ = VECTOR(OUTBUFF);
     1042    17362    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(TMDATEBUFF),TAB_VAL)
     1043    17363    2                   ALTRET(TIME50);
     1044    17364    2              IN$ = ADDR(INBUFF);
     1045    17365    2              INBUFF = '  Sysid = ';
     1046    17366    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('  Sysid = '),TAB_VAL)
     1047    17367    2                   ALTRET(TIME50);
     1048    17368    2              CALL BINCHAR(SYSID,B$JIT.SYSID);
     1049    17369    2              CALL CPE$RZEROS(SYSID,SIZEC(SYSID),LEN);
     1050    17370    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(SYSID),LEN,TAB_VAL)
     1051    17371    2                   ALTRET(TIME50);
     1052    17372    2              IF (B$JIT.RERUN)
     1053    17373    2                 THEN
     1054    17374    3                    DO;
     1055    17375    3                       INBUFF = '  rerun';
     1056    17376    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('  rerun'),TAB_VAL)
     1057    17377    3                            ALTRET(TIME50);
     1058    17378    3                    END;
     1059    17379    2           END;
     1060    17380    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TIME50);
     1061    17381    1     RETURN;
     1062    17382    1   TIME50: ;
     1063    17383    1     ALTRETURN;
     1064    17384        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:37   
     1065    17385        /*
     1066    17386        *****  Local subroutines
     1067    17387        */
     1068    17388        /**********************************************************************/
     1069    17389        /*I*       NAME: DISPSYS
     1070    17390                   PURPOSE: To display current system information
     1071    17391                   CALL: CALL DISPSYS
     1072    17392                   INPUT:
     1073    17393                   OUTPUT: system parameters to listing device
     1074    17394                   DESCRIPTION: The system parameters are obtained using the m$display
     1075    17395                                pmme and output to the listing device.
     1076    17396        */
     1077    17397        /**********************************************************************/
     1078    17398    1   DISPSYS: PROC ALTRET;
     1079    17399    2   DCL 1 NR,
     1080    17400    2          2 HDR CHAR(11),
     1081    17401    2          2 USRS CHAR(3);
     1082    17402    2   DCL 1 ETMF,
     1083    17403    2          2 HDR CHAR(11),
     1084    17404    2          2 NR CHAR(3);
     1085    17405        /*
     1086    17406          ****     Set load parameters
     1087    17407        */
     1088    17408    2     FPT_DISPLAY = CFPT_DISPLAY;
     1089    17409    2     FPT_DISPLAY.RESULTS_ = VECTOR(LOAD_VAR);
     1090    17410    2     CALL M$DISPLAY (FPT_DISPLAY);
     1091    17411        /* ****    Output users                          */
     1092    17412    2     IF LOAD_VAR.USERS > 999
     1093    17413    2        THEN
     1094    17414    2           LOAD_VAR.USERS=999;
     1095    17415    2     CALL BINCHAR(NR.USRS,LOAD_VAR.USERS);
     1096    17416    2     CALL CPE$RZEROS(NR.USRS,SIZEC(NR.USRS));
     1097    17417    2     NR.HDR='   Users = ';
     1098    17418    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(NR);
     1099    17419    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSYS50);
     1100    17420        /* ****    Output etmf                           */
     1101    17421    2     IF LOAD_VAR.ETMF > 999
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:38   
     1102    17422    2        THEN
     1103    17423    2           LOAD_VAR.ETMF = 999;
     1104    17424    2     CALL BINCHAR(ETMF.NR,LOAD_VAR.ETMF);
     1105    17425    2     CALL CPE$RZEROS(ETMF.NR,SIZEC(ETMF.NR));
     1106    17426    2     ETMF.HDR='   ETMF = ';
     1107    17427    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(ETMF);
     1108    17428    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSYS50);
     1109    17429        /* ****    Output response                       */
     1110    17430    2     IF LOAD_VAR.RESP > 999
     1111    17431    2        THEN
     1112    17432    2           LOAD_VAR.RESP = 999;
     1113    17433    2     OUTBUFF$=ADDR(OUTBUFF);
     1114    17434    2     DEST$=OUTBUFF$;
     1115    17435    2     OUTBUFF=' ';
     1116    17436    2     TAB_VAL = 0;
     1117    17437    2     CALL CNVRT_BLD(SIZEC('   90% response < '),'   90% response < ',
     1118    17438    2          LOAD_VAR.RESP) ALTRET(DISPSYS50);
     1119    17439    2     INBUFF=' msecs';
     1120    17440    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(INBUFF),SIZEC(' msecs'))
     1121    17441    2          ALTRET(DISPSYS50);
     1122    17442    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     1123    17443    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
     1124    17444    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSYS50);
     1125    17445        /* ****    Output time                           */
     1126    17446    2     CALL CPE$TIME ALTRET(DISPSYS50);
     1127    17447    2     RETURN;
     1128    17448    2   DISPSYS50: ;
     1129    17449    2     ALTRETURN;
     1130    17450    2   END DISPSYS;
     1131    17451                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:39   
     1132    17452        /**********************************************************************/
     1133    17453        /*I*   NAME:   DISPDCBS
     1134    17454               PURPOSE: Display assign merge information for all dcbs in the *a
     1135    17455                       file.
     1136    17456               CALL:   CALL DISPDCBS
     1137    17457                       DISPDCB
     1138    17458               INPUT:
     1139    17459               OUTPUT: *a information to the listing device
     1140    17460               DEXCRIPTION: Assign merge records for all dcbs are read from the
     1141    17461                       *a file into seg3. A SET command is constructed for each
     1142    17462                       assign merge record and is output to the listing device.
     1143    17463        */
     1144    17464        /***********************************************************************/
     1145    17465    1   DISPDCBS: PROC ALTRET;
     1146    17466    2   DCL FDCB_CHAR(0:0) CHAR(1) CONSTANT INIT(' '); /*1ST possible char for dcb name*/
     1147    17467    2   DCL DCBHDR CONSTANT CHAR(19) INIT('   DCB assignments:');
     1148    17468    2   DCL DCBNHDR CONSTANT CHAR(24) INIT('   DCB assignments: none');
     1149    17469    2   DCL DCBS_EXIST BIT(1) UNAL;                      /*Dcbs exist flag*/
     1150    17470        /**/
     1151    17471        /**/
     1152    17472        /*         **** Get buffer for assign merge records */
     1153    17473    2     CALL CPC$GETSEG(SEG3$) ALTRET(DISPDCBS45);
     1154    17474          %SAVE_ACTIVE_PRIVS;
     1155    17478    2     FPT_CLOSE = CFPT_CLOSE;
     1156    17479    2     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
     1157    17480        /*         **** Open *A file                     */
     1158    17481    2     DCBS_EXIST=%NO#;
     1159    17482    2     FPT_OPEN=CFPT_OPEN;
     1160    17483    2     FPT_OPEN.V_=VECTOR(FPT_OPEN.V);
     1161    17484    2     FPT_OPEN.NAME_=VECTOR(STARA);
     1162    17485    2     FPT_OPEN.V.DCB#=M$IBEX1_NUM;
     1163    17486    2     FPT_OPEN.V.ASN#=%FILE#;
     1164    17487    2     FPT_OPEN.V.FUN#=%IN#;
     1165    17488    2     FPT_OPEN.V.ORG#=%KEYED#;
     1166    17489    2     FPT_OPEN.V.ACS#=%SEQUEN#;
     1167    17490    2     FPT_OPEN.V.INITZ.SCRUB#=%YES#;
     1168    17491    2     CALL M$OPEN(FPT_OPEN) ALTRET(DISPDCBS20);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:40   
     1169    17492          %RESTORE_ACTIVE_PRIVS;
     1170    17495        /*         **** Read in *A record                */
     1171    17496    2     FPT_READ=CFPT_READ;
     1172    17497    2     FPT_READ.V_=VECTOR(FPT_READ.V);
     1173    17498    2     FPT_READ.BUF_.BUF$=SEG3$;
     1174    17499    2     FPT_READ.BUF_.BOUND=4095;
     1175    17500    2     FPT_READ.KEY_=VECTOR(DCB_NAME);
     1176    17501    2     FPT_READ.V.KEYS#=%NO#;
     1177    17502    2     FPT_READ.V.KEYR#=%YES#;
     1178    17503    2     FPT_READ.V.DCB#=M$IBEX1_NUM;
     1179    17504    2   DISPDCBS5: ;
     1180    17505        /*         **** Loop until all dcbs are displayed */
     1181    17506    2     CALL M$READ(FPT_READ) ALTRET(DISPDCBS10);
     1182    17507        /*         **** Check for valid dcb name         */
     1183    17508        /*         **** Dcb names must start with char > .040  */
     1184    17509    2     IF (DCB_NAMEA(1) > FDCB_CHAR(0))
     1185    17510    2        THEN
     1186    17511    3           DO;
     1187    17512    3              IF DCBS_EXIST=%NO#
     1188    17513    3                 THEN
     1189    17514    4                    DO;
     1190    17515    4                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(DCBHDR);
     1191    17516    4                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPDCBS57);
     1192    17517    4                    END;
     1193    17518    3              TAB_VAL=6;
     1194    17519    3              CALL DISPDCB(ADDR(DCB_NAME),TAB_VAL)  ALTRET(DISPDCBS57);
     1195    17520    3              DCBS_EXIST=%YES#;
     1196    17521    3           END;
     1197    17522    2     GOTO DISPDCBS5;
     1198    17523    2   DISPDCBS20:
     1199    17524          %RESTORE_ACTIVE_PRIVS;
     1200    17527    2   DISPDCBS10:;
     1201    17528        /*         **** Preserve error temporarily       */
     1202    17529    2     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
     1203    17530    2     FPT_CLOSE.V.DCB#=M$IBEX1_NUM;
     1204    17531    2     FPT_CLOSE.V.DISP#=%SAVE#;
     1205    17532    2     CALL M$CLOSE(FPT_CLOSE);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:41   
     1206    17533    2     CALL CPC$RELSEG (SEG3$);
     1207    17534    2     IF (B$JIT.USRERR.CODE=%E$EOF) OR (B$JIT.USRERR.CODE=%E$NOFILE)
     1208    17535    2        THEN
     1209    17536        /*         **** Output info. Message if no dcbs encountered */
     1210    17537    3           DO;
     1211    17538    3              IF (DCBS_EXIST=%NO#)
     1212    17539    3                 THEN
     1213    17540    4                    DO;
     1214    17541    4                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(DCBNHDR);
     1215    17542    4                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPDCBS57);
     1216    17543    4                    END;
     1217    17544    3              B$JIT.USRERR.CODE = 0;
     1218    17545    3              RETURN;
     1219    17546    3           END;
     1220    17547    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR);
     1221    17548    2     B$JIT.USRERR.CODE=0;
     1222    17549    2     ALTRETURN;
     1223    17550    2   DISPDCBS45:;
     1224    17551    2     CALL CPC$SCREECH(E$SUASEG,CPE$IBEXMID);
     1225    17552        /*E*    ERROR:   CPE-E$SUASEG-A
     1226    17553                MESSAGE:  IBEX ABORT:  Unable to obtain data segment.  JIT.ERR
     1227    17554                                       follows.
     1228    17555                DESCRIPTION: IBEX was unable to get a data segment used for the
     1229    17556                             purpose of reading  the assign merge record.
     1230    17557        */
     1231    17558    2   DISPDCBS57:;
     1232    17559    2     IF  DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES# THEN
     1233    17560    3        DO;
     1234    17561    3           FPT_CLOSE.V.DISP# = %SAVE#;
     1235    17562    3           FPT_CLOSE.V.DCB# = M$IBEX1_NUM;
     1236    17563    3           CALL M$CLOSE(FPT_CLOSE);
     1237    17564    3        END;
     1238    17565    2     CALL CPC$RELSEG (SEG3$);
     1239    17566    2     ALTRETURN;
     1240    17567    2   END DISPDCBS;
     1241    17568        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:42   
     1242    17569        /**********************************************************************/
     1243    17570        /*I*   NAME:   DISPDCB
     1244    17571               PURPOSE: Display assign merge information for specified dcb
     1245    17572               CALL:   CALL DISPDCB(DCB$,TAB_VAL)
     1246    17573               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     1247    17574               INPUT:  DCB$ - ptr to dcb name
     1248    17575                       TAB_VAL - value for tabbing purposes
     1249    17576                       assign merge record in seg3
     1250    17577               OUTPUT: *A information to listing device
     1251    17578               DESCRIPTION: A SET command for a specified dcb is constructed
     1252    17579                       from its  assign merge record. The command is
     1253    17580                       output to the listing device.
     1254    17581        */
     1255    17582        /**********************************************************************/
     1256    17583    1   DISPDCB: PROC(DCB$,TAB_VAL) ALTRET;
     1257    17584    2   DCL TBUFF CHAR(6);                               /*Temp. Buffer*/
     1258    17585    2   DCL DCB$ PTR;                         /*Ptr to dcb name*/
     1259    17586    2   DCL TAB_VAL SBIN;                                /*Tab value*/
     1260    17587    2   DCL 1 VLP$ATTR BASED,                            /*Vlp length*/
     1261    17588    2          2 SIZE# UBIN WORD;
     1262    17589    2   DCL 1 VLP$ACSVEH BASED,                          /*Access vehicle vlp*/
     1263    17590    2          2 FFLG BIT(18),
     1264    17591    2          2 C UBIN BYTE UNAL,
     1265    17592    2          2 VEHICLE# CHAR(VLP$ACSVEH.C);
     1266    17593    2   DCL 1 VLP$ACCESS BASED,                          /*Access vlp*/
     1267    17594    2          2 FFLG BIT(18),
     1268    17595    2          2 ACCT# CHAR(8);
     1269    17596                   %VLP_TAB(FPTN=AM$TAB,STCLASS=BASED);
     1270    17610                   %VLP_HDR(FPTN=AM$HDR,LEN="AM$HDR.TITL.L#",STCLASS=BASED);
     1271    17626                   %VLP_FORM(FPTN=AM$FORM,STCLASS=BASED);
     1272    17639                  %FPT_UNFID(FPTN=FPT_UNFID,STCLASS=AUTO);
     1273    17657        /**/
     1274    17658        /**/
     1275    17659    2     OUTBUFF=' ';                          /*Blank out buffer*/
     1276    17660    2     IN$=ADDR(INBUFF);
     1277    17661    2     DEST$=ADDR(OUTBUFF);
     1278    17662    2     OUTBUFF$=DEST$;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:43   
     1279    17663        /*         **** Insert 'SET ' in image           */
     1280    17664    2     INBUFF='Set ';
     1281    17665    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,4,TAB_VAL) ALTRET(DISPDCB55);
     1282    17666        /*         **** Insert dcb in image              */
     1283    17667    2     LEN=DCB$->TEXTC.SIZ;
     1284    17668    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(DCB$->TEXTC.TEXT),LEN) ALTRET(DISPDCB55);
     1285    17669        /*         **** Insert blank after dcb           */
     1286    17670    2     INBUFF=' ';
     1287    17671    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1) ALTRET(DISPDCB55);
     1288    17672        /*          **** Insert fid into image
     1289    17673                    **** Init. Unfid if info. Present in *A
     1290    17674        */
     1291    17675    2     FPT_UNFID = CFPT_UNFID;
     1292    17676    2     FPT_UNFID.V_ = VECTOR(FPT_UNFID.V);
     1293    17677    2     FPT_UNFID.TEXTFID_ = VECTOR(INBUFF);
     1294    17678    2     IF AMR$REC$.NAME_ ~= ADDR(NIL)
     1295    17679    2        THEN
     1296    17680    2           FPT_UNFID.NAME_ = VECTOR(AMR$REC$.NAME_->AM$NAME);
     1297    17681    2     IF AMR$REC$.ACCT_ ~= ADDR(NIL)
     1298    17682    2        THEN
     1299    17683    2           FPT_UNFID.ACCT_ = VECTOR(AMR$REC$.ACCT_->AM$ACCT);
     1300    17684    2     IF AMR$REC$.SN_ ~= ADDR(NIL)
     1301    17685    2        THEN
     1302    17686    3           DO;
     1303    17687    3              LEN = AMR$REC$.SN_->AM$SN.NUM#*6+4;
     1304    17688    3              FPT_UNFID.SN_ = VECTOR(AMR$REC$.SN_->VARY$STRNG);
     1305    17689    3           END;
     1306    17690    2     IF AMR$REC$.WSN_ ~= ADDR(NIL)
     1307    17691    2        THEN
     1308    17692    2           FPT_UNFID.WSN_ = VECTOR(AMR$REC$.WSN_->AM$WSN);
     1309    17693    2     FPT_UNFID.ASN_ = VECTOR(AMR$REC$.V.ASN#);
     1310    17694    2     FPT_UNFID.RES_ = VECTOR(AMR$REC$.V.RES#);
     1311    17695    2     FPT_UNFID.LEN_ = VECTOR(LEN);
     1312    17696    2     CALL M$UNFID(FPT_UNFID) ALTRET(DISPDCB60);
     1313    17697    2     DEST$=PINCRC(DEST$,1);
     1314    17698    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN) ALTRET(DISPDCB55);
     1315    17699    2     IN$=ADDR(INBUFF);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:44   
     1316    17700    2      IF AMR$REC$.V.INITZ.SCRUB#
     1317    17701    2        THEN
     1318    17702    2        CALL DISP_OPT_YESNO(SCRUBOPT,,ADDR(AMR$REC$.V.INITZ.SCRUB#)) ALTRET (DISPDCB55)
             17702                 ;
     1319    17703        /*** Fun ***/
     1320    17704    2     IF (AMR$REC$.V.FUN#~=0)
     1321    17705    2        THEN
     1322    17706    3           DO;
     1323    17707    3              INBUFF=',Fun=';
     1324    17708    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,5,TAB_VAL) ALTRET(DISPDCB55);
     1325    17709    4   DISPDCB5:  DO CASE(AMR$REC$.V.FUN#);
     1326    17710    4               CASE(%UPDATE#);
     1327    17711    4                 INBUFF='Update';
     1328    17712    4                 LEN=6;
     1329    17713    4               CASE(%IN#);
     1330    17714    4                 INBUFF='In';
     1331    17715    4                 LEN=2;
     1332    17716    4               CASE(%CREATE#);
     1333    17717    4                 INBUFF='Create';
     1334    17718    4                 LEN=6;
     1335    17719    4               END DISPDCB5;
     1336    17720    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1337    17721    3           END;
     1338    17722        /*** Share ***/
     1339    17723    2     IF (AMR$REC$.V.SHARE#~=0)
     1340    17724    2        THEN
     1341    17725    3           DO;
     1342    17726    3              INBUFF=',Share=';
     1343    17727    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,7,TAB_VAL) ALTRET(DISPDCB55);
     1344    17728    4   DISPDCB10: DO CASE(AMR$REC$.V.SHARE#);
     1345    17729    4               CASE(%ALL#);
     1346    17730    4                 INBUFF='All';
     1347    17731    4                 LEN=3;
     1348    17732    4               CASE(%IN#);
     1349    17733    4                 INBUFF='In';
     1350    17734    4                 LEN=2;
     1351    17735    4               CASE(%NONE#);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:45   
     1352    17736    4                 INBUFF='None';
     1353    17737    4                 LEN=4;
     1354    17738    4               END DISPDCB10;
     1355    17739    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1356    17740    3           END;
     1357    17741        /*** Exist ***/
     1358    17742    2     IF (AMR$REC$.V.EXIST#~=0)
     1359    17743    2        THEN
     1360    17744    3           DO;
     1361    17745    3              INBUFF=',Exist=';
     1362    17746    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,7,TAB_VAL) ALTRET(DISPDCB55);
     1363    17747    4   DISPDCB15: DO CASE(AMR$REC$.V.EXIST#);
     1364    17748    4               CASE(%OLDFILE#);
     1365    17749    4                 INBUFF='OldFile';
     1366    17750    4                 LEN=7;
     1367    17751    4               CASE(%NEWFILE#);
     1368    17752    4                 INBUFF='NewFile';
     1369    17753    4                 LEN=7;
     1370    17754    4               CASE(%ERROR#);
     1371    17755    4                 INBUFF='Error';
     1372    17756    4                 LEN=5;
     1373    17757    4               END DISPDCB15;
     1374    17758    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1375    17759    3           END;
     1376    17760        /*** Org ***/
     1377    17761    2     IF (AMR$REC$.V.ORG#~=0)
     1378    17762    2        THEN
     1379    17763    3           DO;
     1380    17764    3              INBUFF=',Org=';
     1381    17765    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,5,TAB_VAL) ALTRET(DISPDCB55);
     1382    17766    4   DISPDCB20: DO CASE(AMR$REC$.V.ORG#);
     1383    17767    4               CASE(%CONSEC#);
     1384    17768    4                 INBUFF='Consec';
     1385    17769    4                 LEN=6;
     1386    17770    4               CASE(%KEYED#);
     1387    17771    4                 INBUFF='Keyed';
     1388    17772    4                 LEN=5;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:46   
     1389    17773    4               CASE(%RANDOM#);
     1390    17774    4                 INBUFF='Random';
     1391    17775    4                 LEN=6;
     1392    17776    4               CASE(%INDEXED#);
     1393    17777    4                 INBUFF='Indexed';
     1394    17778    4                 LEN=7;
     1395    17779    4               CASE(%RELATIVE#);
     1396    17780    4                 INBUFF='Relative';
     1397    17781    4                 LEN=8;
     1398    17782    4               CASE(%IDS#);
     1399    17783    4                 INBUFF='IDS';
     1400    17784    4                 LEN=3;
     1401    17785    4               CASE(%UR#);
     1402    17786    4                 INBUFF='UR';
     1403    17787    4                 LEN=2;
     1404    17788    4               CASE(%FIXED#);
     1405    17789    4                 INBUFF='Fixed';
     1406    17790    4                 LEN=5;
     1407    17791    4               CASE(%VARIABLE#);
     1408    17792    4                 INBUFF='Variable';
     1409    17793    4                 LEN=8;
     1410    17794    4               CASE(%UNDEF#);
     1411    17795    4                 INBUFF='Undef';
     1412    17796    4                 LEN=5;
     1413    17797    4               CASE(%RESTRICT#);
     1414    17798    4                 INBUFF='Restrict';
     1415    17799    4                 LEN=8;
     1416    17800    4               CASE(%TERMINAL#);
     1417    17801    4                 INBUFF='Terminal';
     1418    17802    4                 LEN=8;
     1419    17803    4               CASE(%FREE#);
     1420    17804    4                 INBUFF='Free';
     1421    17805    4                 LEN=4;
     1422    17806    4               CASE(%CG#);
     1423    17807    4                 INBUFF='CG';
     1424    17808    4                 LEN=2;
     1425    17809    4               CASE(%IREL#);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:47   
     1426    17810    4                 INBUFF='IRel';
     1427    17811    4                 LEN=4;
     1428    17812    4               CASE(%SYMB#);
     1429    17813    4                 INBUFF='Symb';
     1430    17814    4                 LEN=4;
     1431    17815    4               CASE (%DBGCG#);
     1432    17816    4                INBUFF='DbgCG';
     1433    17817    4                LEN=5;
     1434    17818    4               CASE (%DBGDCB#);
     1435    17819    4                INBUFF='DbgDCB';
     1436    17820    4                LEN=6;
     1437    17821    4               CASE (%DBGSYSID#);
     1438    17822    4                INBUFF='DbgSysID';
     1439    17823    4                LEN=8;
     1440    17824    4               CASE (%HANDLER#);
     1441    17825    4                INBUFF='Handler';
     1442    17826    4                LEN=7;
     1443    17827    4               CASE (%FORM#);
     1444    17828    4                INBUFF='Form';
     1445    17829    4                LEN=4;
     1446    17830    4               CASE (%FPRG#);
     1447    17831    4                INBUFF='FPrg';
     1448    17832    4                LEN=4;
     1449    17833    4               CASE (%SE#);
     1450    17834    4                INBUFF='SE';
     1451    17835    4                LEN=2;
     1452    17836    4               CASE (%X364#);
     1453    17837    4                INBUFF='X364';
     1454    17838    4                LEN=4;
     1455    17839    4               CASE(ELSE);
     1456    17840    4                 INBUFF='???';
     1457    17841    4                 LEN=3;
     1458    17842    4               END DISPDCB20;
     1459    17843    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1460    17844    3           END;
     1461    17845        /*** Disp ***/
     1462    17846    2     IF (AMR$REC$.V.DISP#~=0)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:48   
     1463    17847    2        THEN
     1464    17848    3           DO;
     1465    17849    3              INBUFF=',Disp=';
     1466    17850    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',DISP='),TAB_VAL) ALTRET(
             17850                       DISPDCB55);
     1467    17851    4   DISPDCB25: DO CASE(AMR$REC$.V.DISP#);
     1468    17852    4               CASE(%SCRATCH#);
     1469    17853    4                 INBUFF='Scratch';
     1470    17854    4                 LEN=7;
     1471    17855    4               CASE(%NAMED#);
     1472    17856    4                 INBUFF='Named';
     1473    17857    4                 LEN=5;
     1474    17858    4               END DISPDCB25;
     1475    17859    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1476    17860    3           END;
     1477    17861        /*** Acs ***/
     1478    17862    2     IF (AMR$REC$.V.ACS#~=0)
     1479    17863    2        THEN
     1480    17864    3           DO;
     1481    17865    3              INBUFF=',Acs=';
     1482    17866    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Acs='),TAB_VAL) ALTRET(
             17866                       DISPDCB55);
     1483    17867    4   DISPDCB30: DO CASE(AMR$REC$.V.ACS#);
     1484    17868    4               CASE(%SEQUEN#);
     1485    17869    4                 INBUFF='Sequen';
     1486    17870    4                 LEN=6;
     1487    17871    4               CASE(%DIRECT#);
     1488    17872    4                 INBUFF='Direct';
     1489    17873    4                 LEN=6;
     1490    17874    4               CASE(%JRNL#);
     1491    17875    4                 INBUFF='Jrnl';
     1492    17876    4                 LEN=4;
     1493    17877    4               END DISPDCB30;
     1494    17878    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1495    17879    3           END;
     1496    17880        /*** Blkl ***/
     1497    17881    2     IF (AMR$REC$.V.BLKL#~=0)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:49   
     1498    17882    2        THEN
     1499    17883    3           DO;
     1500    17884    3              TVAL=AMR$REC$.V.BLKL#;
     1501    17885    3              CALL CNVRT_BLD(SIZEC(',BlkL='),',BlkL=',TVAL) ALTRET(DISPDCB55);
     1502    17886    3           END;
     1503    17887        /*** Recl ***/
     1504    17888    2     IF (AMR$REC$.V.RECL#~=CFPT_OPEN.V.RECL#)
     1505    17889    2        THEN
     1506    17890    3           DO;
     1507    17891    3              TVAL=AMR$REC$.V.RECL#;
     1508    17892    3              CALL CNVRT_BLD(SIZEC(',RecL='),',RecL=',TVAL) ALTRET(DISPDCB55);
     1509    17893    3           END;
     1510    17894        /*** Density ***/
     1511    17895    2     IF (AMR$REC$.V.DENSITY#~=0)
     1512    17896    2        THEN
     1513    17897    3           DO;
     1514    17898    3              INBUFF=',Den=';
     1515    17899    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Den='),TAB_VAL) ALTRET(
             17899                       DISPDCB55);
     1516    17900    4   DISPDCB35: DO CASE(AMR$REC$.V.DENSITY#);
     1517    17901    4               CASE(%D800#);
     1518    17902    4                 INBUFF='800';
     1519    17903    4                 LEN=3;
     1520    17904    4               CASE(%D1600#);
     1521    17905    4                 INBUFF='1600';
     1522    17906    4                 LEN=4;
     1523    17907    4               CASE(%D6250#);
     1524    17908    4                 INBUFF='6250';
     1525    17909    4                 LEN=4;
     1526    17910    4               CASE(%D38000#);
     1527    17911    4                 INBUFF='38000';
     1528    17912    4                 LEN=5;
     1529    17913    4               END DISPDCB35;
     1530    17914    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1531    17915    3           END;
     1532    17916        /*** Expire ***/
     1533    17917    2     IF (AMR$REC$.V.EXPIRE#~=0)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:50   
     1534    17918    2        THEN
     1535    17919    3           DO;
     1536    17920    3              INBUFF=',Expire=';
     1537    17921    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Expire='),TAB_VAL) ALTRET(
             17921                       DISPDCB55);
     1538    17922    3              IF (AMR$REC$.V.EXPIRE#=-1)
     1539    17923    3                 THEN
     1540    17924    4                    DO;
     1541    17925    4                       INBUFF='Never';
     1542    17926    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,5,TAB_VAL) ALTRET(DISPDCB55
             17926                                );
     1543    17927    4                    END;
     1544    17928
     1545    17929    3                 ELSE
     1546    17930    4                    DO;
     1547    17931    4                       CALL BINCHAR(TBUFF,AMR$REC$.V.EXPIRE#);
     1548    17932    4                       CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);
     1549    17933    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,TAB_VAL) ALTRET
             17933                                (DISPDCB55);
     1550    17934    4                    END;
     1551    17935    3           END;
     1552    17936        /*** Keyx ***/
     1553    17937    2     IF (AMR$REC$.V.KEYX#~=0)
     1554    17938    2        THEN
     1555    17939    3           DO;
     1556    17940    3              TVAL=AMR$REC$.V.KEYX#;
     1557    17941    3              CALL CNVRT_BLD(SIZEC(',KeyX='),',KeyX=',TVAL) ALTRET(DISPDCB55);
     1558    17942    3           END;
     1559    17943        /*** Keyl ***/
     1560    17944    2     IF (AMR$REC$.V.KEYL#~=0)
     1561    17945    2        THEN
     1562    17946    3           DO;
     1563    17947    3              TVAL=AMR$REC$.V.KEYL#;
     1564    17948    3              CALL CNVRT_BLD(SIZEC(',KeyL='),',KeyL=',TVAL) ALTRET(DISPDCB55);
     1565    17949    3           END;
     1566    17950        /*** Spare ***/
     1567    17951    2     IF (AMR$REC$.V.SPARE#~=0)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:51   
     1568    17952    2        THEN
     1569    17953    3           DO;
     1570    17954    3              TVAL=AMR$REC$.V.SPARE#;
     1571    17955    3              CALL CNVRT_BLD(SIZEC(',Spare='),',Spare=',TVAL) ALTRET(DISPDCB55);
     1572    17956    3           END;
     1573    17957        /*** Lslide ***/
     1574    17958    2     IF (AMR$REC$.V.LSLIDE#~=0)
     1575    17959    2        THEN
     1576    17960    3           DO;
     1577    17961    3              TVAL=AMR$REC$.V.LSLIDE#;
     1578    17962    3              CALL CNVRT_BLD(SIZEC(',LSlide='),',LSlide=',TVAL) ALTRET(DISPDCB55);
     1579    17963    3           END;
     1580    17964        /*** LRDL0 ***/
     1581    17965    2     IF (AMR$REC$.V.LRDL0#~=0)
     1582    17966    2        THEN
     1583    17967    3           DO;
     1584    17968    3              TVAL=AMR$REC$.V.LRDL0#;
     1585    17969    3              CALL CNVRT_BLD(SIZEC(',LRdL0='),',LRdL0=',TVAL) ALTRET(DISPDCB55);
     1586    17970    3           END;
     1587    17971        /*** Acsveh ***/
     1588    17972    2     IF (AMR$REC$.ACSVEH_~=ADDR(NIL))
     1589    17973    2        THEN
     1590    17974    3           DO CASE (AMR$REC$.V.ASN#);
     1591    17975    3            CASE (%FILE#);
     1592    17976    3              INBUFF=',AcsVeh=((';
     1593    17977    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',AcsVeh=(('),TAB_VAL) ALTRET(
             17977                       DISPDCB55);
     1594    17978    3              TVAL=AMR$REC$.ACSVEH_->VLP$ATTR.SIZE#*4; /*Calc. #CHARS in vlp*/
     1595    17979    3              TEMP1$=PINCRC(AMR$REC$.ACSVEH_,4); /*Set ptr to 1ST vehicle*/
     1596    17980        /* ****          Insert vehicle names into print image */
     1597    17981    4              DO WHILE((TVAL-3)>0);
     1598    17982    4                 LEN=TEMP1$->VLP$ACSVEH.C;
     1599    17983    4                 INBUFF=TEMP1$->VLP$ACSVEH.VEHICLE#;
     1600    17984    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1601    17985    4                 INBUFF=',';
     1602    17986    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);
     1603    17987    4                 TVAL=TVAL-TEMP1$->VLP$ACSVEH.C-3;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:52   
     1604    17988    4                 TEMP1$=PINCRC(TEMP1$,TEMP1$->VLP$ACSVEH.C+3);
     1605    17989    4              END;
     1606    17990    3              DEST$=PINCRC(DEST$,-1);
     1607    17991    3              INBUFF=')';
     1608    17992    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);
     1609    17993        /* ****    Insert permission bits into image. Permissions are the same
     1610    17994                   for each entry so just display the FIRST.*/
     1611    17995    3              CALL DISP_PMSN(PINCRC(AMR$REC$.ACSVEH_,4)) ALTRET(DISPDCB55);
     1612    17996    3              INBUFF=')';
     1613    17997    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);
     1614    17998    3            CASE (%DEVICE#, %COMGROUP#);
     1615    17999    3              TEMP1$ = AMR$REC$.ACSVEH_;
     1616    18000    3              IF TEMP1$ -> AM$WINDOW.FWINDOW# ~= ' '
     1617    18001    4                THEN DO;
     1618    18002    4                 CALL CONCAT (INBUFF,',FWindow=', TEMP1$ -> AM$WINDOW.FWINDOW#);
     1619    18003    4                 CALL INDEX (LEN, ' ', INBUFF);
     1620    18004    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1621    18005    4                  ALTRET (DISPDCB55);
     1622    18006    4                 END;
     1623    18007    4              DO CASE (TEMP1$ -> AM$WINDOW.POSITION#);
     1624    18008    4               CASE (%POSITION_TOP#);
     1625    18009    4                 INBUFF = ',Position=top';
     1626    18010    4                 LEN = LENGTHC(',Position=top');
     1627    18011    4               CASE (%POSITION_BOTTOM#);
     1628    18012    4                 INBUFF = ',Position=bottom';
     1629    18013    4                 LEN = LENGTHC(',Position=bottom');
     1630    18014    4               CASE (%POSITION_LEFT#);
     1631    18015    4                 INBUFF = ',Position=left';
     1632    18016    4                 LEN = LENGTHC(',Position=left');
     1633    18017    4               CASE (%POSITION_RIGHT#);
     1634    18018    4                 INBUFF = ',Position=right';
     1635    18019    4                 LEN = LENGTHC(',Position=right');
     1636    18020    4               CASE (ELSE);
     1637    18021    4                 LEN = 0;
     1638    18022    4               END;
     1639    18023    3              IF LEN > 0
     1640    18024    3                THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:53   
     1641    18025    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1642    18026    3                  ALTRET (DISPDCB55);
     1643    18027    3              TVAL = TEMP1$ -> AM$WINDOW.LENGTH#;
     1644    18028    3              IF TVAL ~= 0
     1645    18029    3                THEN
     1646    18030    3                 CALL CNVRT_BLD(SIZEC(',WLength='), ',WLength=', TVAL)
     1647    18031    3                  ALTRET (DISPDCB55);
     1648    18032    3              TVAL = TEMP1$ -> AM$WINDOW.MINLENGTH#;
     1649    18033    3              IF TVAL ~= 0
     1650    18034    3                THEN
     1651    18035    3                 CALL CNVRT_BLD(SIZEC(',MinLength='), ',MinLength=', TVAL)
     1652    18036    3                  ALTRET (DISPDCB55);
     1653    18037    3              TVAL = TEMP1$ -> AM$WINDOW.WIDTH#;
     1654    18038    3              IF TVAL ~= 0
     1655    18039    3                THEN
     1656    18040    3                 CALL CNVRT_BLD(SIZEC(',WWidth='), ',WWidth=', TVAL)
     1657    18041    3                  ALTRET (DISPDCB55);
     1658    18042    3              TVAL = TEMP1$ -> AM$WINDOW.MINWIDTH#;
     1659    18043    3              IF TVAL ~= 0
     1660    18044    3                THEN
     1661    18045    3                 CALL CNVRT_BLD(SIZEC(',MinWidth='), ',MinWidth=', TVAL)
     1662    18046    3                  ALTRET (DISPDCB55);
     1663    18047    3              CALL DISP_OPT_YESNO (OPTIONALOPT,ADDR(TEMP1$->AM$WINDOW.REMOVABLE#))
     1664    18048    3               ALTRET (DISPDCB55);
     1665    18049    3              CALL DISP_OPT_YESNO (TOPBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.TOPBRDR#))
     1666    18050    3               ALTRET (DISPDCB55);
     1667    18051    3              CALL DISP_OPT_YESNO (BTMBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.BTMBRDR#))
     1668    18052    3               ALTRET (DISPDCB55);
     1669    18053    3              TVAL = TEMP1$ -> AM$WINDOW.VBRDRSIZ#;
     1670    18054    3              IF TVAL ~= 0
     1671    18055    3                THEN
     1672    18056    3                 CALL CNVRT_BLD(SIZEC(',VBrdrSiz='),',VBrdrSiz=',TVAL)
     1673    18057    3                  ALTRET (DISPDCB55);
     1674    18058    3              IF TEMP1$ -> AM$WINDOW.VBRDRCHR# ~= BINASC(0)
     1675    18059    4                THEN DO;
     1676    18060    4                 CALL CONCAT (INBUFF, ',VBrdrChr=''', TEMP1$->AM$WINDOW.VBRDRCHR#,
     1677    18061    4                  '''');
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:54   
     1678    18062    4                 CALL INDEX (LEN, ' ', INBUFF);
     1679    18063    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1680    18064    4                  ALTRET (DISPDCB55);
     1681    18065    4                 END;
     1682    18066    3              CALL DISP_OPT_YESNO (LFTBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.LFTBRDR#))
     1683    18067    3               ALTRET (DISPDCB55);
     1684    18068    3              CALL DISP_OPT_YESNO (RHTBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.RHTBRDR#))
     1685    18069    3               ALTRET (DISPDCB55);
     1686    18070    3              TVAL = TEMP1$ -> AM$WINDOW.HBRDRSIZ#;
     1687    18071    3              IF TVAL ~= 0
     1688    18072    3                THEN
     1689    18073    3                 CALL CNVRT_BLD(SIZEC(',HBrdrSiz='),',HBrdrSiz=',TVAL)
     1690    18074    3                  ALTRET (DISPDCB55);
     1691    18075    3              IF TEMP1$ -> AM$WINDOW.HBRDRCHR# ~= BINASC(0)
     1692    18076    4                THEN DO;
     1693    18077    4                 CALL CONCAT (INBUFF, ',HBrdrChr=''', TEMP1$->AM$WINDOW.HBRDRCHR#,
     1694    18078    4                  '''');
     1695    18079    4                 CALL INDEX (LEN, ' ', INBUFF);
     1696    18080    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1697    18081    4                  ALTRET (DISPDCB55);
     1698    18082    4                 END;
     1699    18083    3           END;
     1700    18084        /*** Access ***/
     1701    18085    2     IF (AMR$REC$.ACCESS_~=ADDR(NIL))
     1702    18086    2        THEN
     1703    18087    3           DO;
     1704    18088    3              TVAL=AMR$REC$.ACCESS_->VLP$ATTR.SIZE#*4; /*Calc. #CHARS in vlp*/
     1705    18089    3              TEMP1$=PINCRC(AMR$REC$.ACCESS_,4); /*Set ptr to 1ST access*/
     1706    18090        /* ****          Insert access names into image  */
     1707    18091    4              DO WHILE((TVAL-3) > 0);
     1708    18092    4                 INBUFF=',Access=((';
     1709    18093    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Access=(('),TAB_VAL)
             18093                          ALTRET(DISPDCB55);
     1710    18094    4                 INBUFF=TEMP1$->VLP$ACCESS.ACCT#;
     1711    18095    4                 CALL INDEX(LEN,' ',INBUFF);
     1712    18096    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1713    18097    4                 INBUFF=')';
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:55   
     1714    18098    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);
     1715    18099    4                 CALL DISP_PMSN(TEMP1$) ALTRET(DISPDCB55);
     1716    18100    4                 INBUFF=')';
     1717    18101    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);
     1718    18102    4                 TVAL=TVAL-10;                /*Decr. Char. Count*/
     1719    18103    4                 TEMP1$=PINCRC(TEMP1$,10);    /*Incr. To next access*/
     1720    18104    4              END;
     1721    18105    3           END;
     1722    18106    2     CALL DISP_OPT_YESNO(BLOCKEDOPT,ADDR(AMR$REC$.V.BLOCKED#)) ALTRET(DISPDCB55);
     1723    18107    2     CALL DISP_OPT_YESNO(ANSISPANSEQOPT,ADDR(AMR$REC$.V.ANSISPANSEQ#))
     1724    18108    2           ALTRET(DISPDCB55);
     1725    18109    2     CALL DISP_OPT_YESNO(SPANNEDOPT,ADDR(AMR$REC$.V.SPANNED#)) ALTRET(DISPDCB55);
     1726    18110    2     IF (AMR$REC$.V.EBCDIC#~=DEFAULT#)
     1727    18111    2        THEN
     1728    18112    3           DO;
     1729    18113    3              CALL DISP_OPT_YESNO(EBCDICOPT,ADDR(AMR$REC$.V.EBCDIC#))
     1730    18114    3                    ALTRET(DISPDCB55);
     1731    18115    3              CALL DISP_OPT_YESNO(CNVRTOPT,ADDR(AMR$REC$.V.CNVRT#))
     1732    18116    3                  ALTRET(DISPDCB55);
     1733    18117    3           END;
     1734    18118        /*** Nrecs ***/
     1735    18119    2     IF (AMR$REC$.V.NRECS#~=0)
     1736    18120    2        THEN
     1737    18121    3           DO;
     1738    18122    3              TVAL=AMR$REC$.V.NRECS#;
     1739    18123    3              CALL CNVRT_BLD(SIZEC(',NRecs='),',NRecs=',TVAL) ALTRET(DISPDCB55);
     1740    18124    3           END;
     1741    18125        /*** Xtnsize ***/
     1742    18126    2     IF (AMR$REC$.V.XTNSIZE# ~= 0)
     1743    18127    2        THEN
     1744    18128    3           DO;
     1745    18129    3              TVAL=AMR$REC$.V.XTNSIZE#;
     1746    18130    3              CALL CNVRT_BLD(SIZEC(',XtnSize='),',XtnSize=',TVAL)
     1747    18131    3                   ALTRET(DISPDCB55);
     1748    18132    3           END;
     1749    18133        /*** Ixtnsize ***/
     1750    18134    2     IF (AMR$REC$.V.IXTNSIZE# ~= 0)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:56   
     1751    18135    2        THEN
     1752    18136    3           DO;
     1753    18137    3              TVAL=AMR$REC$.V.IXTNSIZE#;
     1754    18138    3              CALL CNVRT_BLD(SIZEC(',IXtnSize='),',IXtnSize=',TVAL)
     1755    18139    3                   ALTRET(DISPDCB55);
     1756    18140    3           END;
     1757    18141        /*** Tab ***/
     1758    18142    2     IF (AMR$REC$.TAB_~=ADDR(NIL))
     1759    18143    2        THEN
     1760    18144    3           DO;
     1761    18145        /* ****          Check if margin set             */
     1762    18146    3              IF AMR$REC$.TAB_->AM$TAB.MARGIN#~=0
     1763    18147    3                 THEN
     1764    18148    4                    DO;
     1765    18149    4                       TVAL=AMR$REC$.TAB_->AM$TAB.MARGIN#;
     1766    18150    4                       CALL CNVRT_BLD(SIZEC(',Margin='),',Margin=',TVAL)
     1767    18151    4                            ALTRET(DISPDCB55);
     1768    18152    4                    END;
     1769    18153        /* ****          Check if any tabs set
     1770    18154                         no tabs assumed if 1ST tab setting is zero*/
     1771    18155    3              IF AMR$REC$.TAB_->AM$TAB.TABS#(0)~=0
     1772    18156    3                 THEN
     1773    18157    4                    DO;
     1774    18158    4                       INBUFF=',Tab=(';
     1775    18159    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Tab=('),TAB_VAL)
     1776    18160    4                            ALTRET(DISPDCB55);
     1777    18161        /* ****                Last tab setting assumed when 0 encntrd*/
     1778    18162    5                       DO TVAL=0 TO 30;
     1779    18163    5                          IF AMR$REC$.TAB_->AM$TAB.TABS#(TVAL)~=0
     1780    18164    5                             THEN
     1781    18165    6                                DO;
     1782    18166    6                                   CALL BINCHAR(TBUFF,AMR$REC$.TAB_->AM$TAB.TABS#(TVAL)
             18166                                            );
     1783    18167    6                                   CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);
     1784    18168    6                                   CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,
             18168                                            TAB_VAL)
     1785    18169    6                                        ALTRET(DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:57   
     1786    18170    6                                   INBUFF=',';
     1787    18171    6                                   CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)
             18171                                            ALTRET(DISPDCB55);
     1788    18172    6                                END;
     1789    18173
     1790    18174    5                             ELSE
     1791    18175    5                                TVAL=31;
     1792    18176    5                       END;
     1793    18177    4                       DEST$=PINCRC(DEST$,-1);   /*Remove unneeded comma*/
     1794    18178    4                       INBUFF=')';
     1795    18179    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55
             18179                                );
     1796    18180    4                    END;
     1797    18181    3           END;
     1798    18182    2     CALL DISP_OPT_YESNO(CTGOPT,ADDR(AMR$REC$.V.CTG#)) ALTRET(DISPDCB55);
     1799    18183        /*** Hdr ***/
     1800    18184    2     IF (AMR$REC$.HDR_~=ADDR(NIL))
     1801    18185    2        THEN
     1802    18186    3           DO;
     1803    18187    3              IF AMR$REC$.HDR_->AM$HDR.CTL.HEADERHEIGHT#>1
     1804    18188    3                 THEN
     1805    18189    4                    DO;
     1806    18190    4                       TVAL=AMR$REC$.HDR_->AM$HDR.CTL.HEADERHEIGHT#;
     1807    18191    4                       CALL CNVRT_BLD(SIZEC(',HdrHeight='),',HdrHeight=',TVAL)
     1808    18192    4                            ALTRET(DISPDCB55);
     1809    18193    4                    END;
     1810    18194    3              IF AMR$REC$.HDR_->AM$HDR.CTL.INDENT#~=0
     1811    18195    3                 THEN
     1812    18196    4                    DO;
     1813    18197    4                       TVAL=AMR$REC$.HDR_->AM$HDR.CTL.INDENT#;
     1814    18198    4                       CALL CNVRT_BLD(SIZEC(',Indent='),',Indent=',TVAL)
     1815    18199    4                            ALTRET(DISPDCB55);
     1816    18200    4                    END;
     1817    18201    3              IF AMR$REC$.HDR_->AM$HDR.CTL.COUNT#~=0
     1818    18202    3                 THEN
     1819    18203    4                    DO;
     1820    18204    4                       TVAL=AMR$REC$.HDR_->AM$HDR.CTL.COUNT#;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:58   
     1821    18205    4                       CALL CNVRT_BLD(SIZEC(',PageCol='),',PageCol=',TVAL)
     1822    18206    4                            ALTRET(DISPDCB55);
     1823    18207    4                    END;
     1824    18208    3              IF AMR$REC$.HDR_->AM$HDR.TITL.L#~=0
     1825    18209    3                 THEN
     1826    18210    4                    DO;
     1827    18211    4                       INBUFF=',Title=''';
     1828    18212    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Title='''),TAB_VAL)
     1829    18213    4                            ALTRET(DISPDCB55);
     1830    18214    4                       LEN=AMR$REC$.HDR_->AM$HDR.TITL.L#;
     1831    18215    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(AMR$REC$.HDR_->
     1832    18216    4                            AM$HDR.TITL.TITLE#),LEN,TAB_VAL) ALTRET(DISPDCB55);
     1833    18217    4                       INBUFF='''';
     1834    18218    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)
     1835    18219    4                            ALTRET(DISPDCB55);
     1836    18220    4                    END;
     1837    18221    3              IF AMR$REC$.HDR_->AM$HDR.CTL.RESETPAGE#=%YES#
     1838    18222    3                 THEN
     1839    18223    4                    DO;
     1840    18224    4                       INBUFF=',ResetPage';
     1841    18225    4                       LEN=SIZEC(',ResetPage');
     1842    18226    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1843    18227    4                            ALTRET(DISPDCB55);
     1844    18228    4                    END;
     1845    18229    3           END;
     1846    18230    2     CALL DISP_OPT_YESNO(COMPOPT,ADDR(AMR$REC$.V.COMP#)) ALTRET(DISPDCB55);
     1847    18231        /*** Type ***/
     1848    18232    2     IF (AMR$REC$.V.TYPE# ~= BINASC(0))
     1849    18233    2        THEN
     1850    18234    3           DO;
     1851    18235    3              CALL CONCAT(INBUFF,',Type=',AMR$REC$.V.TYPE#,' ');
     1852    18236    3              CALL INDEX(LEN,' ',INBUFF);
     1853    18237    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1854    18238    3           END;
     1855    18239        /*** Dvfc ***/
     1856    18240    2     IF (AMR$REC$.V.DVFC# ~= BINASC(0))
     1857    18241    2        THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:59   
     1858    18242    3           DO;
     1859    18243    3              CALL CONCAT(INBUFF,',DVFC=''',AMR$REC$.V.DVFC#,''' ');
     1860    18244    3              CALL INDEX(LEN,' ',INBUFF);
     1861    18245    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1862    18246    3           END;
     1863    18247        /*** Form ***/
     1864    18248    2     IF (AMR$REC$.FORM_ ~= ADDR(NIL))
     1865    18249    2        THEN
     1866    18250    3           DO;
     1867    18251    3              CALL CONCAT(INBUFF,',Form=''',AMR$REC$.FORM_->AM$FORM.FORM#,' ');
     1868    18252    3              CALL INDEX(LEN,' ',INBUFF);
     1869    18253    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1870    18254    3              INBUFF = '''';
     1871    18255    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)
     1872    18256    3                   ALTRET(DISPDCB55);
     1873    18257    3           END;
     1874    18258        /*** Copies ***/
     1875    18259    2     IF (AMR$REC$.V.COPIES# ~= 0)
     1876    18260    2        THEN
     1877    18261    3           DO;
     1878    18262    3              TVAL = AMR$REC$.V.COPIES#;
     1879    18263    3              CALL CNVRT_BLD (SIZEC(',Copies='), ',Copies=',TVAL)
     1880    18264    3                   ALTRET(DISPDCB55);
     1881    18265    3           END;
     1882    18266        /*** Vol ***/
     1883    18267    2     IF (AMR$REC$.V.VOL# ~= 0)
     1884    18268    2        THEN
     1885    18269    3           DO;
     1886    18270    3              TVAL=AMR$REC$.V.VOL#;
     1887    18271    3              CALL CNVRT_BLD(SIZEC(',Vol='),',Vol=',TVAL) ALTRET(DISPDCB55);
     1888    18272    3           END;
     1889    18273    2     IF (AMR$REC$.V.MAXVOL# ~= 0)
     1890    18274    2        THEN
     1891    18275    3           DO;
     1892    18276    3              TVAL=AMR$REC$.V.MAXVOL#;
     1893    18277    3              CALL CNVRT_BLD(SIZEC(',MaxVol='),',MaxVol=',TVAL)
     1894    18278    3                   ALTRET(DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:60   
     1895    18279    3           END;
     1896    18280    2     CALL DISP_OPT_YESNO(CVOLOPT,ADDR(AMR$REC$.V.CVOL#)) ALTRET(DISPDCB55);
     1897    18281        /*** Lines ***/
     1898    18282    2     IF (AMR$REC$.V.LINES# ~= 0)
     1899    18283    2        THEN
     1900    18284    3           DO;
     1901    18285    3              TVAL=AMR$REC$.V.LINES#;
     1902    18286    3              CALL CNVRT_BLD(SIZEC(',Lines='),',Lines=',TVAL)
     1903    18287    3                   ALTRET(DISPDCB55);
     1904    18288    3           END;
     1905    18289    2     CALL DISP_OPT_YESNO(XTENDOPT,ADDR(AMR$REC$.V.XTEND#)) ALTRET(DISPDCB55);
     1906    18290    2     CALL DISP_OPT_YESNO(BUPMOPT,ADDR(AMR$REC$.V.BUPM#)) ALTRET(DISPDCB55);
     1907    18291        /*** Fsn ***/
     1908    18292    2     IF (AMR$REC$.V.FSN#~=0)
     1909    18293    2        THEN
     1910    18294    3           DO;
     1911    18295    3              TVAL=AMR$REC$.V.FSN#;
     1912    18296    3              CALL CNVRT_BLD(SIZEC(',FSN='),',FSN=',TVAL)
     1913    18297    3                   ALTRET(DISPDCB55);
     1914    18298    3           END;
     1915    18299        /*** Seqcol,seqid ***/
     1916    18300        /*         **** Display seqcol & seqid if sequencing set */
     1917    18301    2     IF (AMR$REC$.V.SEQ#~=DEFAULT#)
     1918    18302    2        THEN
     1919    18303    3           DO;
     1920    18304    3              CALL DISP_OPT_YESNO(SEQOPT,ADDR(AMR$REC$.V.SEQ#)) ALTRET(DISPDCB55);
     1921    18305    3              TVAL=AMR$REC$.V.SEQCOL#;
     1922    18306    3              CALL CNVRT_BLD(SIZEC(',SeqCol='),',SeqCol=',TVAL)
     1923    18307    3                   ALTRET(DISPDCB55);
     1924    18308    3              IF (AMR$REC$.V.SEQID#~=' ')
     1925    18309    3                 THEN
     1926    18310    4                    DO;
     1927    18311    4                       CALL CONCAT(INBUFF,',SEQID=''',AMR$REC$.V.SEQID#,' ');
     1928    18312    4                       CALL INDEX(LEN,' ',INBUFF);
     1929    18313    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1930    18314    4                            ALTRET(DISPDCB55);
     1931    18315    4                       INBUFF = '''';
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:61   
     1932    18316    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)
     1933    18317    4                            ALTRET(DISPDCB55);
     1934    18318    4                    END;
     1935    18319    3           END;
     1936    18320        /**/
     1937    18321    3     DO TVAL=0 TO 8;
     1938    18322    3        IF AMR$REC$.V.UOPT#(TVAL)~=DEFAULT#
     1939    18323    3           THEN
     1940    18324    4              DO;
     1941    18325    4                 CALL CNVRT_BLD(SIZEC(',UOPT'),',UOPT',TVAL)
     1942    18326    4                      ALTRET(DISPDCB55);
     1943    18327    4                 IF (AMR$REC$.V.UOPT#(TVAL) = %NO#)
     1944    18328    4                    THEN
     1945    18329    5                       DO;
     1946    18330    5                          INBUFF='=No';
     1947    18331    5                          LEN = SIZEC('=No');
     1948    18332    5                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1949    18333    5                               ALTRET (DISPDCB55);
     1950    18334    5                       END;
     1951    18335
     1952    18336    4                    ELSE
     1953    18337    5                       DO;
     1954    18338    5                          INBUFF='=Yes';
     1955    18339    5                          LEN = SIZEC('=Yes');
     1956    18340    5                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     1957    18341    5                               ALTRET (DISPDCB55);
     1958    18342    5                       END;
     1959    18343    4              END;
     1960    18344    3     END;
     1961    18345        /*** Volaccess ***/
     1962    18346    2     IF (AMR$REC$.V.VOLACCESS#~=0)
     1963    18347    2        THEN
     1964    18348    3           DO;
     1965    18349    3              INBUFF=',VolAccess=';
     1966    18350    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,11,TAB_VAL) ALTRET(DISPDCB55);
     1967    18351    4              DO CASE(AMR$REC$.V.VOLACCESS#);
     1968    18352    4               CASE(%ALL#);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:62   
     1969    18353    4                 INBUFF='All';
     1970    18354    4                 LEN=SIZEC('All');
     1971    18355    4               CASE(%IN#);
     1972    18356    4                 INBUFF='In';
     1973    18357    4                 LEN=SIZEC('In');
     1974    18358    4               CASE(%NONE#);
     1975    18359    4                 INBUFF='None';
     1976    18360    4                 LEN=SIZEC('None');
     1977    18361    4               END ;
     1978    18362    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);
     1979    18363    3           END;
     1980    18364    2     CALL DISP_OPT_YESNO(AUOPT,ADDR(AMR$REC$.V.AU#)) ALTRET(DISPDCB55);
     1981    18365    2     IF NOT AMR$REC$.V.DCBCONLGL#
     1982    18366    2       THEN
     1983    18367    2        CALL DISP_OPT_YESNO(DCBCONLGLOPT,,ADDR(AMR$REC$.V.DCBCONLGL#)) ALTRET (
             18367                 DISPDCB55);
     1984    18368    2     CALL DISP_OPT_YESNO(QISSOPT,ADDR(AMR$REC$.V.QISS#)) ALTRET(DISPDCB55);
     1985    18369    2     CALL DISP_OPT_YESNO(LOADOPT,ADDR(AMR$REC$.V.LOAD#)) ALTRET(DISPDCB55);
     1986    18370    2      CALL DISP_OPT_YESNO(LSTAOROPT, ADDR(AMR$REC$.V.LSTAOR#)) ALTRET (DISPDCB55);
     1987    18371    2      CALL DISP_OPT_YESNO(JRNLBYPASSOPT, ADDR(AMR$REC$.V.JRNLBYPASS#)) ALTRET (
             18371               DISPDCB55);
     1988    18372    2     IF NOT AMR$REC$.V.TERMCONLGL#
     1989    18373    2       THEN
     1990    18374    2        CALL DISP_OPT_YESNO(TERMCONLGLOPT,,ADDR(AMR$REC$.V.TERMCONLGL#)) ALTRET (
             18374                 DISPDCB55);
     1991    18375        /*** Ghstacs ***/
     1992    18376    2     IF (AMR$REC$.V.GHSTACS# ~= 0)
     1993    18377    2        THEN
     1994    18378    3           DO;
     1995    18379    3              TVAL=AMR$REC$.V.GHSTACS#;
     1996    18380    3              CALL CNVRT_BLD(SIZEC(',GhstAcs='),',GhstAcs=',TVAL)
     1997    18381    3                   ALTRET(DISPDCB55);
     1998    18382    3           END;
     1999    18383        /*** Event ***/
     2000    18384    2     IF (AMR$REC$.V.EVENT# ~= 0)
     2001    18385    2        THEN
     2002    18386    3           DO;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:63   
     2003    18387    3              TVAL=AMR$REC$.V.EVENT#;
     2004    18388    3              CALL CNVRT_BLD(SIZEC(',Event='),',Event=',TVAL)
     2005    18389    3                   ALTRET(DISPDCB55);
     2006    18390    3           END;
     2007    18391        /*
     2008    18392          **** DISPLAY ALL COMGROUP INFORMATION IF VLP PRESENT
     2009    18393        */
     2010    18394    2     IF (AMR$REC$.SETSTA_~=ADDR(NIL))
     2011    18395    2        THEN
     2012    18396    3           DO CASE (AMR$REC$.V.ASN#);
     2013    18397    3            CASE (%COMGROUP#);
     2014    18398    3              CALL DISP_OPT_YESNO(ALLDCBSOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA
     2015    18399    3                   .ALLDCBS#)) ALTRET(DISPDCB55);
     2016    18400    3              CALL DISP_OPT_YESNO(ALLTRMSOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA
     2017    18401    3                   .ALLTRMS#)) ALTRET(DISPDCB55);
     2018    18402    3              CALL DISP_OPT_YESNO(ANYDCBOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA
     2019    18403    3                    .ANYDCB#)) ALTRET(DISPDCB55);
     2020    18404    3              CALL DISP_OPT_YESNO(DIRONLYOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA
     2021    18405    3                   .DIRONLY#))  ALTRET(DISPDCB55);
     2022    18406    3              CALL DISP_OPT_YESNO(EOFNONEOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA
     2023    18407    3                   .EOFNONE#))  ALTRET(DISPDCB55);
     2024    18408    3              CALL DISP_OPT_YESNO(EOFONEOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA
     2025    18409    3                   .EOFONE#))  ALTRET(DISPDCB55);
     2026    18410    3              TVAL = AMR$REC$.SETSTA_ -> AM$SETSTA.ISTA.EOFTIME#;
     2027    18411    3              IF TVAL ~= 0
     2028    18412    3                THEN
     2029    18413    3                 CALL CNVRT_BLD (LENGTHC(',EOFTime='),',EOFTime=', TVAL)
     2030    18414    3                   ALTRET (DISPDCB55);
     2031    18415    3              CALL DISP_OPT_YESNO(ILATCHOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA
     2032    18416    3                   .ILATCH#))  ALTRET(DISPDCB55);
     2033    18417    3              CALL DISP_OPT_YESNO(ILOCKOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA
     2034    18418    3                   .ILOCK#))  ALTRET(DISPDCB55);
     2035    18419    3              CALL DISP_OPT_TEXT(IMSGTYPOPT,LENGTHC(AMR$REC$.SETSTA_->
     2036    18420    3                    AM$SETSTA.ISTA.IMSGTYP#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2037    18421    3                          ISTA.IMSGTYP#))  ALTRET(DISPDCB55);
     2038    18422    3              CALL DISP_OPT_TEXT(ISTATIONOPT,LENGTHC(AMR$REC$.SETSTA_->
     2039    18423    3                    AM$SETSTA.ISTA.ISTATION#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:64   
     2040    18424    3                          ISTA.ISTATION#)) ALTRET(DISPDCB55);
     2041    18425    3              CALL DISP_OPT_TEXT(MYSTATIONOPT,LENGTHC(AMR$REC$.SETSTA_->
     2042    18426    3                    AM$SETSTA.MYSTATION#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2043    18427    3                          MYSTATION#))  ALTRET(DISPDCB55);
     2044    18428    3              CALL DISP_OPT_YESNO(OLATCHOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA.
     2045    18429    3                    OLATCH#)) ALTRET(DISPDCB55);
     2046    18430    3              CALL DISP_OPT_YESNO(OLOCKOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA
     2047    18431    3                   .OLOCK#))  ALTRET(DISPDCB55);
     2048    18432    3              CALL DISP_OPT_TEXT(OMSGTYPOPT,LENGTHC(AMR$REC$.SETSTA_->
     2049    18433    3                    AM$SETSTA.OSTA.OMSGTYP#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2050    18434    3                          OSTA.OMSGTYP#))  ALTRET(DISPDCB55);
     2051    18435    3              CALL DISP_OPT_TEXT(OSTATIONOPT,LENGTHC(AMR$REC$.SETSTA_->
     2052    18436    3                    AM$SETSTA.OSTA.OSTATION#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2053    18437    3                          OSTA.OSTATION#)) ALTRET(DISPDCB55);
     2054    18438    3              CALL DISP_OPT_YESNO(WASOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA
     2055    18439    3                   .WAS#))  ALTRET(DISPDCB55);
     2056    18440    3            CASE (%TAPE#);
     2057    18441                    /* Display User Header Label stuff here, if IBEX ever
     2058    18442                       permits one to !SET it.
     2059    18443                    */
     2060    18444    3            CASE (%FILE#);
     2061    18445    3              CALL DISP_OPT_YESNO (INITIALIZEOPT,, ADDR(AMR$REC$.VIRTUAL_ ->
     2062    18446    3               AM$VIRTUAL.INITIALIZE#)) ALTRET (DISPDCB55);
     2063    18447    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.INITVALUE#;
     2064    18448    3              IF TVAL ~= 0
     2065    18449    3                THEN
     2066    18450    3                 CALL CNVRT_BLD (LENGTHC(',InitValue='), ',InitValue=', TVAL)
     2067    18451    3                  ALTRET (DISPDCB55);
     2068    18452    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.MINPHYS#;
     2069    18453    3              IF TVAL ~= 0
     2070    18454    3                THEN
     2071    18455    3                 CALL CNVRT_BLD (LENGTHC(',MinPhys='), ',MinPhys=', TVAL)
     2072    18456    3                  ALTRET (DISPDCB55);
     2073    18457    3              CALL DISP_OPT_YESNO (NOFILEOPT,, ADDR(AMR$REC$.VIRTUAL_ ->
     2074    18458    3               AM$VIRTUAL.NOFILE#)) ALTRET (DISPDCB55);
     2075    18459    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.PHYSICAL#;
     2076    18460    3              IF TVAL ~= 0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:65   
     2077    18461    3                THEN
     2078    18462    3                 CALL CNVRT_BLD (LENGTHC(',Physical='), ',Physical=', TVAL)
     2079    18463    3                  ALTRET (DISPDCB55);
     2080    18464    4              DO CASE (AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.SEGNUM#);
     2081    18465    4                CASE (%VS1#);
     2082    18466    4                 INBUFF = ',SegNum=VS1';
     2083    18467    4                CASE (%VS2#);
     2084    18468    4                 INBUFF = ',SegNum=VS2';
     2085    18469    4                CASE (%VS3#);
     2086    18470    4                 INBUFF = ',SegNum=VS3';
     2087    18471    4                CASE (ELSE);
     2088    18472    4                 INBUFF = ' ';
     2089    18473    4                END;
     2090    18474    3              IF INBUFF ~= ' '
     2091    18475    3                THEN
     2092    18476    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,11,TAB_VAL) ALTRET (DISPDCB55);
     2093    18477    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.SEGSIZE#;
     2094    18478    3              IF TVAL ~= 0
     2095    18479    3                THEN
     2096    18480    3                 CALL CNVRT_BLD (LENGTHC(',SegSize='), ',SegSize=', TVAL)
     2097    18481    3                  ALTRET (DISPDCB55);
     2098    18482    3           END;
     2099    18483        /*
     2100    18484           Display ALTKEYS or FPRG_FID information if present
     2101    18485        */
     2102    18486    2      IF AMR$REC$.ALTKEYS_ ~= ADDR(NIL)
     2103    18487    2        THEN
     2104    18488    3         DO CASE (AMR$REC$.V.ASN#);
     2105    18489    3           CASE (%FILE#);
     2106    18490    3            INBUFF = ',AltKeys=((';
     2107    18491    3            LEN = LENGTHC(',AltKeys=((');
     2108    18492    3            CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (DISPDCB55);
     2109    18493    4            DO I = 0 TO AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.SIZ# - 1;
     2110    18494    4               TVAL = AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.K.KEYX#(I);
     2111    18495    4               CALL CNVRT_BLD(LENGTHC('KeyX='), 'KeyX=', TVAL) ALTRET (DISPDCB55);
     2112    18496    4               TVAL = AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.K.KEYL#(I);
     2113    18497    4               CALL CNVRT_BLD(LENGTHC(',KeyL='), ',KeyL=', TVAL) ALTRET (DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:66   
     2114    18498    4               IF AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.K.UNIQUE#(I)
     2115    18499    5                 THEN DO;
     2116    18500    5                  INBUFF = ',Unique';
     2117    18501    5                  LEN = LENGTHC(',Unique');
     2118    18502    5                  END;
     2119    18503    4                 ELSE
     2120    18504    4                  LEN = 0;
     2121    18505    4               IF I + 1 = AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.SIZ#
     2122    18506    5                 THEN DO;
     2123    18507    5                  CALL INSERT (INBUFF, LEN, , '))');
     2124    18508    5                  LEN = LEN + 2;
     2125    18509    5                  END;
     2126    18510    5                 ELSE DO;
     2127    18511    5                  CALL INSERT (INBUFF, LEN, , '),(');
     2128    18512    5                  LEN = LEN + 3;
     2129    18513    5                  END;
     2130    18514    4               CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (DISPDCB55);
     2131    18515    4               END;
     2132    18516    3           CASE (%DEVICE#, %COMGROUP#);
     2133    18517    3            FPT_UNFID = CFPT_UNFID;
     2134    18518    3            FPT_UNFID.V_ = VECTOR (FPT_UNFID.V);
     2135    18519    3            FPT_UNFID.NAME_ = VECTOR (AMR$REC$.FPRG_ -> AM$FPRG.NAME);
     2136    18520    3            FPT_UNFID.ACCT_ = VECTOR (AMR$REC$.FPRG_ -> AM$FPRG.ACCT#);
     2137    18521    3            FPT_UNFID.PASS_ = VECTOR (AMR$REC$.FPRG_ -> AM$FPRG.PASS#);
     2138    18522    3            IF AMR$REC$.FPRG_ -> AM$FPRG.PSN# = ' '
     2139    18523    3              THEN
     2140    18524    3               FPT_UNFID.SN_ = VECTOR(NIL);
     2141    18525    4              ELSE DO;
     2142    18526    4               VLP_SN.NUM# = 1;
     2143    18527    4               VLP_SN.SN#(0) = AMR$REC$.FPRG_ -> AM$FPRG.PSN#;
     2144    18528    4               FPT_UNFID.SN_ = VECTOR(VLP_SN);
     2145    18529    4               FPT_UNFID.RES_ = VECTOR (RES);
     2146    18530    4               RES = 'DP';
     2147    18531    4               END;
     2148    18532    3            FPT_UNFID.ASN_ = VECTOR (ASN);
     2149    18533    3            ASN = %FILE#;
     2150    18534    3            FPT_UNFID.TEXTFID_ = VECTOR (UNFID);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:67   
     2151    18535    3            CALL M$UNFID (FPT_UNFID) ALTRET (DISPDCB55);
     2152    18536    3            CALL CONCAT (INBUFF, ',FPrg_FID=', UNFID);
     2153    18537    3            CALL INDEX (LEN, ' ', INBUFF);
     2154    18538    3            CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (DISPDCB55);
     2155    18539    3           END;
     2156    18540    2     CALL DISP_OPT_YESNO(IGNOREFSNOPT,ADDR(AMR$REC$.V.IGNOREFSN#)) ALTRET(DISPDCB55);
     2157    18541    2     CALL DISP_OPT_YESNO(IOERROKOPT,ADDR(AMR$REC$.V.IOERROK#)) ALTRET(DISPDCB55);
     2158    18542    2     IF AMR$REC$.V.SEEDSPECIFIED#
     2159    18543    2       THEN
     2160    18544    2         CALL DISP_OPT_YESNO(SEEDOPT,ADDR(AMR$REC$.V.SEEDSPECIFIED#)) ALTRET(DISPDCB55)
             18544                  ;
     2161    18545        /*         **** Print only if data in buffer     */
     2162    18546    2     IF POFFC(DEST$,OUTBUFF$) > TAB_VAL
     2163    18547    2        THEN
     2164    18548    3           DO;
     2165    18549    3              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     2166    18550    3              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
     2167    18551    3              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPDCB55);
     2168    18552    3           END;
     2169    18553    2     RETURN;
     2170    18554    2   DISPDCB55: ;
     2171    18555    2     ALTRETURN;
     2172    18556    2   DISPDCB60: ;
     2173    18557    2     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;
     2174    18558    2     ALTRETURN;
     2175    18559    2   END DISPDCB;
     2176    18560                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:68   
     2177    18561        /**********************************************************************/
     2178    18562        /*I*   NAME:   DISPFLGS
     2179    18563               PURPOSE: Display the settings of various control flags
     2180    18564               CALL:S  CALL DISPFLGS
     2181    18565               INTERFACE: CPC$WRITEMSGE,CPE$LISTOUT,CPB$BLDIMAGE
     2182    18566               INPUT:  B$JIT.PRFLAGS,B$JIT.CPFLAGS1,B$JIT.ACCEPT_FLAGS
     2183    18567               OUTPUT: control flag settings to the listing device
     2184    18568               DESCRIPTION: The various control flag settings in the JIT are
     2185    18569                       determined to be set or reset and reflected on the listing
     2186    18570                       device.
     2187    18571        */
     2188    18572        /**********************************************************************/
     2189    18573    1   DISPFLGS: PROC ALTRET;
     2190    18574    2   DCL DISPHDR1 CONSTANT CHAR(24) INIT('   Output control flags:');
     2191    18575        %EQU NUM_FLAGS=13;
     2192    18576
     2193    18577    2   DCL 1 FLAGS_TBL (0:%(NUM_FLAGS-1)) CONSTANT ALIGNED,
     2194    18578    2         2 LEN UBIN BYTE UNAL INIT
     2195    18579    2             (8,9,7,7,4,7,4,6,5,8,7,4,4),
     2196    18580    2         2 HDR CHAR(12) UNAL INIT
     2197    18581    2             ('announce','broadcast','comment','dribble','echo','expound',
     2198    18582    2               'list','notify','point','position','protect','send','when');
     2199    18583        %EQU ANNOUNCE_FLAG=0;
     2200    18584        %EQU BROADCAST_FLAG=1;
     2201    18585        %EQU COMMENT_FLAG=2;
     2202    18586        %EQU DRIBBLE_FLAG=3;
     2203    18587        %EQU ECHO_FLAG=4;
     2204    18588        %EQU EXPOUND_FLAG=5;
     2205    18589        %EQU LIST_FLAG=6;
     2206    18590        %EQU NOTIFY_FLAG=7;
     2207    18591        %EQU POINT_FLAG=8;
     2208    18592        %EQU POSITION_FLAG=9;
     2209    18593        %EQU PROTECT_FLAG=10;
     2210    18594        %EQU SEND_FLAG=11;
     2211    18595        %EQU WHEN_FLAG=12;
     2212    18596    2   DCL FLAGS_VAL (0:%(NUM_FLAGS-1)) BIT(1) UNAL;
     2213    18597    2   DCL NEED_COMMA BIT(1);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:69   
     2214    18598    2   DCL SET_FLG BIT(1);     /* Tell whether it is Set or Reset mode */
     2215    18599    2   DCL I UBIN;
     2216    18600    2   DCL J UBIN;
     2217    18601    2   DCL TAB2_VAL UBIN;
     2218    18602        /*         **** Output header                    */
     2219    18603    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(DISPHDR1);
     2220    18604    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPFLGS50);
     2221    18605    2     IF B$JIT.CPFLAGS1.WHEN_INPUT
     2222    18606    2       THEN
     2223    18607    2         CALL CPG$SET_WHEN_STATE ALTRET(DISPFLGS50);
     2224    18608        /*         **** Init buffer ptrs ...                             */
     2225    18609    2     OUTBUFF=' ';
     2226    18610    2     IN$=ADDR(INBUFF);
     2227    18611    2     OUTBUFF$=ADDR(OUTBUFF);               /*Ptr to buffer beginning*/
     2228    18612    2     DEST$=OUTBUFF$;                       /*Dynamic ptr*/
     2229    18613    2     TAB_VAL=6;                            /*Set tab value*/
     2230    18614        /*         **** Setup flag information
     2231    18615                   **** Flags which are set causes FLAGS_VAL to be set                */
     2232    18616    2     FLAGS_VAL=%NO#;
     2233    18617    2     FLAGS_VAL(%ANNOUNCE_FLAG)=B$JIT.ACCEPT_FLAGS.ANNOUNCE;
     2234    18618    2     FLAGS_VAL(%BROADCAST_FLAG)=B$JIT.ACCEPT_FLAGS.BROADCAST;
     2235    18619    2     FLAGS_VAL(%COMMENT_FLAG)=B$JIT.PRFLAGS.COMMENT;
     2236    18620    2     FLAGS_VAL(%DRIBBLE_FLAG)=B$JIT.CPFLAGS1.DRIBBLE;
     2237    18621    2     FLAGS_VAL(%ECHO_FLAG)=B$JIT.CPFLAGS1.ECHO;
     2238    18622    2     FLAGS_VAL(%EXPOUND_FLAG)=B$JIT.PRFLAGS.EXPOUND;
     2239    18623    2     FLAGS_VAL(%LIST_FLAG)=B$JIT.PRFLAGS.LIST;
     2240    18624    2     FLAGS_VAL(%NOTIFY_FLAG)=B$JIT.CPFLAGS1.NOTIFY;
     2241    18625    2     FLAGS_VAL(%POINT_FLAG)=B$JIT.PRFLAGS.POINT;
     2242    18626    2     FLAGS_VAL(%POSITION_FLAG)=B$JIT.PRFLAGS.POSITION;
     2243    18627    2     FLAGS_VAL(%PROTECT_FLAG)=B$JIT.CPFLAGS1.PROTECT;
     2244    18628    2     FLAGS_VAL(%SEND_FLAG)=B$JIT.ACCEPT_FLAGS.SEND;
     2245    18629    2     FLAGS_VAL(%WHEN_FLAG)=B$JIT.PRFLAGS.WHEN;
     2246    18630
     2247    18631          /* Move the corresponding text into the buffer                              */
     2248    18632    2     SET_FLG=%YES#;        /* Do Set flags first. */
     2249    18633    2     NEED_COMMA=%NO#;
     2250    18634    3     DO I=0 TO 1;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:70   
     2251    18635    3         DEST$=OUTBUFF$;                   /*Dynamic ptr*/
     2252    18636    3         OUTBUFF=' ';
     2253    18637    3         IF SET_FLG
     2254    18638    3             THEN
     2255    18639    4               DO ;
     2256    18640    4                 INBUFF='Set: ';
     2257    18641    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('Set: '),TAB_VAL)
     2258    18642    4                                   ALTRET(DISPFLGS50);
     2259    18643    4                 TAB2_VAL=TAB_VAL+SIZEC('Set: ');
     2260    18644    4               END;  /* Then Do */
     2261    18645    3             ELSE
     2262    18646    4               DO;
     2263    18647    4                 INBUFF='Reset: ';
     2264    18648    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('Reset: '),TAB_VAL)
     2265    18649    4                                   ALTRET(DISPFLGS50);
     2266    18650    4                 TAB2_VAL=TAB_VAL+SIZEC('Reset: ');
     2267    18651    4               END;  /* Else Do */
     2268    18652    4         DO J=0 TO %NUM_FLAGS-1;
     2269    18653    4             IF FLAGS_VAL(J)=SET_FLG
     2270    18654    4               THEN
     2271    18655    5                 DO;
     2272    18656    5                   IF NEED_COMMA
     2273    18657    5                     THEN
     2274    18658    6                       DO;
     2275    18659    6                         INBUFF=',';
     2276    18660    6                         CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB2_VAL)
     2277    18661    6                                          ALTRET(DISPFLGS50);
     2278    18662    6                       END;  /* Then Do */
     2279    18663    5                   INBUFF=FLAGS_TBL.HDR(J);
     2280    18664    5                   LEN=FLAGS_TBL.LEN(J);
     2281    18665    5                   IF NEED_COMMA
     2282    18666    5                     THEN
     2283    18667    5                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB2_VAL)
     2284    18668    5                                          ALTRET(DISPFLGS50);
     2285    18669    5                     ELSE  /* Don't pass TAB2_VAL, fakeout CPB$BLDIMAGE */
     2286    18670    6                       DO;
     2287    18671    6                         CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:71   
     2288    18672    6                                          ALTRET(DISPFLGS50);
     2289    18673    6                         NEED_COMMA=%YES#;
     2290    18674    6                       END;  /* Else Do */
     2291    18675    5                 END;  /* Then Do */
     2292    18676    4         END; /* Do J */
     2293    18677        /*         **** Print if any flags set           */
     2294    18678    3         LEN=POFFC(DEST$,OUTBUFF$);
     2295    18679    3         IF LEN>TAB2_VAL
     2296    18680    3             THEN
     2297    18681    4               DO;
     2298    18682    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     2299    18683    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=LEN-1;
     2300    18684    4                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPFLGS50);
     2301    18685    4               END;
     2302    18686    3         SET_FLG=%NO#;
     2303    18687    3         NEED_COMMA=%NO#;
     2304    18688    3     END;    /* Do I */
     2305    18689    2     RETURN;
     2306    18690    2   DISPFLGS50:;
     2307    18691    2     ALTRETURN;
     2308    18692    2   END DISPFLGS;
     2309    18693                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:72   
     2310    18694        /**********************************************************************/
     2311    18695        /*I*   NAME:   DISPUSER
     2312    18696               PURPOSE: Display general user information
     2313    18697               CALL:   CALL DISPUSER
     2314    18698               INTERFACE: CPE$LISTOUT,CPE$RZEROS,CPB$BLDIMAGE,CPC$RDUSERS
     2315    18699               INPUT:  b$jit.accn,b$jit.uname,b$jit.sysid,as_users.fcommand
     2316    18700                       b$jit.user,b$jit.prdprm
     2317    18701               OUTPUT: account.name,fcommand,sysid,user#,disk space remaining
     2318    18702                       to the listing device
     2319    18703               DESCRIPTION: The selection of user information is
     2320    18704                       obtained and output to the listing device.
     2321    18705        */
     2322    18706        /**********************************************************************/
     2323    18707    1   DISPUSER: PROC ALTRET;
     2324    18708    2   DCL USRNUM CHAR(3);                   /*User number*/
     2325    18709        /*         **** Insert accn,uname into image and output */
     2326    18710    2     IN$=ADDR(INBUFF);
     2327    18711    2     OUTBUFF=' ';
     2328    18712    2     DEST$=ADDR(OUTBUFF);
     2329    18713    2     OUTBUFF$=DEST$;
     2330    18714    2     TAB_VAL=3;
     2331    18715    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     2332    18716    2     CALL INDEX(LEN,' ',B$JIT.ACCN);      /*Get accn size*/
     2333    18717    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.ACCN),LEN,TAB_VAL) ALTRET(DISPUSER50);
     2334    18718    2     INBUFF=',';
     2335    18719    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',')) ALTRET(DISPUSER50);
     2336    18720    2     CALL INDEX(LEN,' ',B$JIT.UNAME);     /*Get name size*/
     2337    18721    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.UNAME),LEN) ALTRET(DISPUSER50);
     2338    18722        /*         **** Insert sysid into image          */
     2339    18723    2     INBUFF='  Sysid = ';
     2340    18724    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('  Sysid = ')) ALTRET(DISPUSER50);
     2341    18725    2     CALL BINCHAR(SYSID,B$JIT.SYSID);
     2342    18726    2     CALL CPE$RZEROS(SYSID,SIZEC(SYSID),LEN);
     2343    18727    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(SYSID),LEN) ALTRET(DISPUSER50);
     2344    18728        /*         **** Insert user number into image    */
     2345    18729    2     INBUFF='  User number = .';
     2346    18730    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('  User number = .')) ALTRET(DISPUSER50
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:73   
             18730              );
     2347    18731    2     TEMP = B$JIT.USER ;
     2348    18732    2     LEN = 0 ;
     2349    18733    2     TVAL = 3 ;
     2350    18734    2     USRNUM = '   ' ;
     2351    18735    3     DO UNTIL (TEMP=0) ;
     2352    18736    3         TVAL = TVAL - 1 ;
     2353    18737    3         CALL INSERT(USRNUM, TVAL, 1, SUBSTR(CONTAB,TEMPO.LSD,1)) ;
     2354    18738    3         TEMP = TEMPO.REST ;
     2355    18739    3         LEN = LEN + 1 ;
     2356    18740    3     END ;   /* Do Until */
     2357    18741    2     USRNUM = SUBSTR(USRNUM,3-LEN,LEN) ; /* Left justify */
     2358    18742    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(USRNUM),LEN) ALTRET(DISPUSER50);
     2359    18743    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     2360    18744    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
     2361    18745    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPUSER50);
     2362    18746        /*         **** Output file management directory */
     2363    18747    2     DEST$=OUTBUFF$;                       /*Reset buffer ptr*/
     2364    18748    2     INBUFF=' ';
     2365    18749    2     IF B$JIT.FPSN=' '
     2366    18750    2        THEN
     2367    18751    3           DO;
     2368    18752    3              CALL INDEX(LEN,' ',B$JIT.FACCN);
     2369    18753    3              LEN=LEN+SIZEC('Directory  = ');
     2370    18754    3              CALL INSERT(INBUFF,0,LEN,'Directory = ',B$JIT.FACCN);
     2371    18755    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPUSER50);
     2372    18756    3           END;
     2373    18757
     2374    18758    2        ELSE
     2375    18759    3           DO;
     2376    18760    3              CALL INDEX(LEN,' ',B$JIT.FPSN);
     2377    18761    3              LEN=LEN+SIZEC('Directory = DP#');
     2378    18762    3              CALL INSERT(INBUFF,0,LEN,'Directory = DP#',B$JIT.FPSN);
     2379    18763    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN) ALTRET(DISPUSER50);
     2380    18764    3              CALL INDEX(LEN,' ',B$JIT.FACCN);
     2381    18765    3              CALL INSERT(INBUFF,0,LEN+1,'.',B$JIT.FACCN);
     2382    18766    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN+1) ALTRET(DISPUSER50);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:74   
     2383    18767    3           END;
     2384    18768        /*         **** Output disk pack space remaining */
     2385    18769        /*
     2386    18770          ****     Get granule count from running account by reading in the fit
     2387    18771        */
     2388    18772    2   DISPUSER10:;
     2389    18773    2     CALL CPC$GETSEG(SEG3$) ALTRET(DISPUSER60);
     2390    18774    2     FPT_OPEN=CFPT_OPEN;
     2391    18775    2     FPT_OPEN.V_=VECTOR(FPT_OPEN.V);
     2392    18776    2     FPT_OPEN.V.DCB#=M$IBEX1_NUM;
     2393    18777    2     FPT_OPEN.V.ASN#=%FILE#;
     2394    18778    2     FPT_OPEN.V.INITZ.SCRUB# = %YES#;
     2395    18779    2     LEN=1024*4;
     2396    18780    2     FPT_OPEN.FPARAM_=VECTOR(SEG3$->VARY$STRNG);
     2397    18781    2     LEN=1;
     2398    18782    2     SEG3$->VARY$STRNG='0'B;
     2399    18783    2     TVAL=0;
     2400    18784    2     CALL M$OPEN(FPT_OPEN) ALTRET(DISPUSER20);
     2401    18785    2   DISPUSER20:;
     2402    18786    2     LEN=IBEX_CODE14;
     2403    18787    2     TEMP1$=SEG3$;
     2404    18788    2     CALL XSF$LOCCODE(TEMP1$,LEN) ALTRET(DISPUSER30);
     2405    18789        /*
     2406    18790          ****     Use the smallest value
     2407    18791        */
     2408    18792    2     TVAL=TEMP1$->CODE14.MGRANS-TEMP1$->CODE14.CGRANS;
     2409    18793    2     IF B$JIT.PRDPRM < TVAL
     2410    18794    2        THEN
     2411    18795    2           TVAL=B$JIT.PRDPRM;
     2412    18796    2   DISPUSER30:;
     2413    18797    2     CALL CPC$RELSEG (SEG3$);
     2414    18798    2     IF (TVAL < 0)
     2415    18799    2        THEN TVAL = 0;
     2416    18800    2     CALL CNVRT_BLD(25,'  Disk space remaining = ',TVAL) ALTRET(DISPUSER50);
     2417    18801    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
     2418    18802    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPUSER50);
     2419    18803        /*
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:75   
     2420    18804          ****     Don't output msge. 'NO SETUP COMMAND' if no command in :USERS
     2421    18805        */
     2422    18806    2     MSGFLAG=%NO#;
     2423    18807        /*
     2424    18808          ****     Fake out CPI$SETUP routine
     2425    18809        */
     2426    18810    2     P$PCB.OUT$=TEMP$;
     2427    18811    2     CALL CPI$SETUP(P$PCB,MSGFLAG) ALTRET(DISPUSER50);
     2428    18812    2     RETURN;
     2429    18813    2   DISPUSER50:;
     2430    18814    2     ALTRETURN;
     2431    18815    2   DISPUSER60:;
     2432    18816    2     CALL CPC$SCREECH(E$SUASEG,CPE$IBEXMID);
     2433    18817        /*    ERROR:   CPE-E$SUASEG-A
     2434    18818                MESSAGE:  IBEX ABORT:  Unable to obtain data segment.  JIT.ERR
     2435    18819                                       follows.
     2436    18820                DESCRIPTION: IBEX was unable to get a data segment used for the
     2437    18821                             purpose of reading  the assign merge record.
     2438    18822        */
     2439    18823    2   END DISPUSER;
     2440    18824                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:76   
     2441    18825        /********************************************************************/
     2442    18826        /*I*   NAME:   DISPSTEPCC
     2443    18827               PURPOSE: Display step condition codes
     2444    18828               CALL:   CALL DISPSTEPCC
     2445    18829               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     2446    18830               INPUT:  B$JIT.STEPCC
     2447    18831               OUTPUT: condition codes listed
     2448    18832               DESCRIPTION: The step condition codes in the JIT are displayed on
     2449    18833                       the listing device.
     2450    18834        */
     2451    18835        /**********************************************************************/
     2452    18836    1   DISPSTEPCC: PROC ALTRET;
     2453    18837    2   DCL STEPCC CHAR(3);
     2454    18838        /**/
     2455    18839        /**/
     2456    18840    2     OUTBUFF$=ADDR(OUTBUFF);
     2457    18841    2     DEST$=OUTBUFF$;
     2458    18842    2     OUTBUFF='   StepCC: ';
     2459    18843    2     DEST$=PINCRC(DEST$,SIZEC('   StepCC: '));            /*Bump ptr*/
     2460    18844    2     CALL BINCHAR(STEPCC,B$JIT.STEPCC);
     2461    18845    2     CALL CPE$RZEROS(STEPCC,SIZEC(STEPCC),LEN);
     2462    18846    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(STEPCC),LEN)
     2463    18847    2          ALTRET(DISPSTEPCC50);
     2464    18848    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
     2465    18849    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     2466    18850    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSTEPCC50);
     2467    18851    2     RETURN;
     2468    18852    2   DISPSTEPCC50:;
     2469    18853    2     ALTRETURN;
     2470    18854    2   END DISPSTEPCC;
     2471    18855                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:77   
     2472    18856        /**********************************************************************/
     2473    18857        /*I*   NAME:   CNVRT_BLD
     2474    18858               PURPOSE: Stores a keyword and its binary value, after being converted
     2475    18859                       to text, into OUTBUFF.
     2476    18860               INTERFACE: CPE$RZEROS,CPB$BLDIMAGE
     2477    18861               INPUT:  KEYWDSZE - keyword size
     2478    18862                       KEYWD      - keyword text
     2479    18863                       KEYWDVAL   - keyword value
     2480    18864               OUTPUT: Keyword and its value to OUTBUFF i.e. KEYWORD=value
     2481    18865               DESCRIPTION: The binary value is converted to a character string
     2482    18866                       and stored along with its keyword into OUTBUFF.
     2483    18867        */
     2484    18868        /***********************************************************************/
     2485    18869    1   CNVRT_BLD: PROC(KEYWDSZE,KEYWD,KEYWDVAL) ALTRET;
     2486    18870    2   DCL KEYWDSZE UBIN(36) ALIGNED;                   /*Size of keyword*/
     2487    18871    2   DCL KEYWD CHAR(10);                              /*Keyword to be stored*/
     2488    18872    2   DCL KEYWDVAL UBIN(36) ALIGNED;                   /*Value to be stored*/
     2489    18873    2   DCL TBUFF CHAR(6);                               /*Temp. Buffer */
     2490    18874    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(KEYWD),KEYWDSZE,TAB_VAL)
     2491    18875    2          ALTRET(CNVRT_BLD50);
     2492    18876    2     CALL BINCHAR(TBUFF,KEYWDVAL);
     2493    18877    2     CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);
     2494    18878    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,TAB_VAL) ALTRET(CNVRT_BLD50);
     2495    18879    2     RETURN;
     2496    18880    2   CNVRT_BLD50:;
     2497    18881    2     ALTRETURN;
     2498    18882    2   END CNVRT_BLD;
     2499    18883                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:78   
     2500    18884        /**********************************************************************/
     2501    18885        /*I*   NAME:   DISP_PMSN
     2502    18886               PURPOSE: Display ACCESS and ACSVEH permission flags
     2503    18887               CALL:   CALL DISP_PMSN
     2504    18888               INTERFACE: CPB$BLDIMAGE
     2505    18889               INPUT:  PMSN$ - ptr to permission flags
     2506    18890               OUTPUT: Permission flag text into output buffer
     2507    18891               DESCRIPTION: Permission flag text is inserted into OUTBUFF
     2508    18892                       following the vehicle or access name.
     2509    18893        */
     2510    18894        /**********************************************************************/
     2511    18895    1   DISP_PMSN: PROC(PMSN$) ALTRET;
     2512    18896    2   DCL PMSN$ PTR;                                   /*Ptr to permission flags*/
     2513    18897    2   DCL I SBIN WORD;                          /*Temp. Loc. For INDEX.*/
     2514    18898    2   DCL CNTLS(0:17) BIT(1) BASED;                  /*Access/vehicle flag structure*/
     2515    18899    2   DCL CNTLS_A(0:17) BIT(1) AUTO;                 /*Local copy Access/vehicle flag*/
     2516    18900        %EQU RESET_CREATE_FLG#='776777'O;
     2517    18901    2   DCL ACCESS_FLAGS(0:11) CHAR(7) CONSTANT INIT
     2518    18902    2                   (',Read',',DelR',',WNew',',Upd',',DelF',',NoList',
     2519    18903    2                   ',ReAttr',',Exec',',',',AU',',AURd',',Tctl');
     2520    18904    2     CNTLS_A = PMSN$->CNTLS & %RESET_CREATE_FLG# ;
     2521    18905    3     DO I=0 TO 17;
     2522    18906    3        IF CNTLS_A(I) = %YES#
     2523    18907    3           THEN
     2524    18908    4              DO;
     2525    18909    4                 INBUFF=ACCESS_FLAGS(I);
     2526    18910    4                 CALL INDEX(LEN,' ',INBUFF); /*Get string size*/
     2527    18911    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)
     2528    18912    4                      ALTRET(PMSN50);
     2529    18913    4              END;
     2530    18914    3     END;
     2531    18915    2     RETURN;
     2532    18916    2   PMSN50: ;
     2533    18917    2     ALTRETURN;
     2534    18918    2   END DISP_PMSN;
     2535    18919                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:79   
     2536    18920        /**********************************************************************/
     2537    18921        /*I*   NAME:   DISP_OPT_YESNO
     2538    18922               PURPOSE: Display the specified option follewed by yes/no
     2539    18923               CALL:   CALL DISP_OPT_YESNO
     2540    18924               INTERFACE: CPB$BLDIMAGE
     2541    18925               INPUT:  OPTN - sub specifying option to be displayed
     2542    18926                       AMOPTN1$ - ptr to two bit field to be checked
     2543    18927                       AMOPTN2$ - ptr to one bit field to be checked
     2544    18928               OUTPUT: Options followed by yes/no into output buffer
     2545    18929               DESCRIPTION: Using the passed sub, the text is obtained from a table
     2546    18930                       and yes/no appended depending on bit settings. If a two bit
     2547    18931                       field is to be checked, a pointer should be passed via
     2548    18932                       AMOPTN1$, otherwise in AMOPTN2$.
     2549    18933        */
     2550    18934        /**********************************************************************/
     2551    18935    1   DISP_OPT_YESNO: PROC(OPTN,AMOPTN1$,AMOPTN2$) ALTRET;
     2552    18936    2   DCL I SBIN WORD;
     2553    18937    2   DCL OPTN UBIN;
     2554    18938    2   DCL AMOPTN1$ PTR;
     2555    18939    2   DCL AMOPTN2$ PTR;
     2556    18940    2   DCL BIT$1 BIT(1) BASED;
     2557    18941    2   DCL BIT$2 BIT(2) BASED;
     2558    18942        /**/
     2559    18943        /**/
     2560    18944    2     IF (ADDR(AMOPTN1$) ~= ADDR(NIL) AND (AMOPTN1$->BIT$2 ~= DEFAULT#))  OR
     2561    18945    2           ADDR(AMOPTN2$) ~= ADDR(NIL)
     2562    18946    2        THEN
     2563    18947    3           DO;
     2564    18948    3              INBUFF = ',';
     2565    18949    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISP_OPT_YESNO50);
     2566    18950    4              DO I=0 TO OPT_TBLSZE;
     2567    18951    4                 IF OPT_TBL.OPTION(I) = OPTN
     2568    18952    4                    THEN
     2569    18953    5                       DO;
     2570    18954    5                          INBUFF = OPT_TBL.HDR(I);
     2571    18955    5                          LEN = OPT_TBL.LEN(I);
     2572    18956    5                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:80   
     2573    18957    5                                LEN,TAB_VAL) ALTRET(DISP_OPT_YESNO50);
     2574    18958    5                          I = OPT_TBLSZE;
     2575    18959    5                       END;
     2576    18960    4              END;
     2577    18961    3           END;
     2578    18962    2     IF ADDR(AMOPTN1$) ~= ADDR(NIL)
     2579    18963    2        THEN
     2580    18964    3           DO;
     2581    18965    3              IF (AMOPTN1$->BIT$2 = %NO#)
     2582    18966    3                 THEN
     2583    18967    3                      GOTO DISP_OPT_YESNO10;
     2584    18968    3              ELSE;
     2585    18969    3                 RETURN;
     2586    18970    3           END;
     2587    18971        /*
     2588    18972          **** ASSUME 1 BIT OPTION FIELD TO BE CHECKED
     2589    18973        */
     2590    18974    2     ELSE
     2591    18975    2        IF AMOPTN2$->BIT$1 =%YES#
     2592    18976    2           THEN
     2593    18977    2              RETURN;
     2594    18978    2   DISP_OPT_YESNO10:
     2595    18979    2     INBUFF = '=no';
     2596    18980    2     LEN = SIZEC('=no');
     2597    18981    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISP_OPT_YESNO50);
     2598    18982    2     RETURN;
     2599    18983    2   DISP_OPT_YESNO50:
     2600    18984    2     ALTRETURN;
     2601    18985    2   END DISP_OPT_YESNO;
     2602    18986                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:81   
     2603    18987        /**********************************************************************/
     2604    18988        /*I*   NAME:   DISP_OPT_TEXT
     2605    18989        						
     2606    18990               CALL:   CALL DISP_OPT_TEXT
     2607    18991               INTERFACE: CPB$BLDIMAGE
     2608    18992               INPUT:  OPTION - sub specifying option to be displayed
     2609    18993                       OSZE - text field size
     2610    18994                       OTEXT$ -  ptr to text to be displayed
     2611    18995                       OPT_TBL - parallel option name table
     2612    18996               OUTPUT: Text into output buffer
     2613    18997               DESCRIPTION: A check is made for presence of text and inserted
     2614    18998                       into the output buffer preceded by its option.
     2615    18999        */
     2616    19000        /**********************************************************************/
     2617    19001    1   DISP_OPT_TEXT: PROC(OPTION,OSZE,OTEXT$) ALTRET;
     2618    19002    2   DCL OPTION UBIN;
     2619    19003    2   DCL OSZE UBIN;
     2620    19004    2   DCL 1 VARY$STRNG BASED CHAR(OSZE);
     2621    19005    2   DCL OTEXT$ PTR;
     2622    19006    2   DCL I SBIN WORD;
     2623    19007        /**/
     2624    19008        /**/
     2625    19009    2     IF OTEXT$->VARY$STRNG = ' '
     2626    19010    2        THEN
     2627    19011    2           RETURN;
     2628    19012    2     INBUFF = ',';
     2629    19013    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISP_OPT_TEXT50);
     2630    19014    3     DO I=0 TO OPT_TBLSZE;
     2631    19015    3        IF OPT_TBL.OPTION(I) = OPTION
     2632    19016    3           THEN
     2633    19017    4              DO;
     2634    19018    4                 INBUFF = OPT_TBL.HDR(I);
     2635    19019    4                 LEN = OPT_TBL.LEN(I);
     2636    19020    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,
     2637    19021    4                       LEN,TAB_VAL) ALTRET(DISP_OPT_TEXT50);
     2638    19022    4                 I = OPT_TBLSZE;
     2639    19023    4              END;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:82   
     2640    19024    3     END;
     2641    19025    2     INBUFF = '=';
     2642    19026    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISP_OPT_TEXT50);
     2643    19027    2     INBUFF = OTEXT$->VARY$STRNG;
     2644    19028    2     CALL INDEX(LEN,' ',OTEXT$->VARY$STRNG);
     2645    19029    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISP_OPT_TEXT50);
     2646    19030    2     RETURN;
     2647    19031    2   DISP_OPT_TEXT50:
     2648    19032    2     ALTRETURN;
     2649    19033    2   END DISP_OPT_TEXT;
     2650    19034                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:83   
     2651    19035        /********************************************************************/
     2652    19036        /*I*   NAME:   DISPBUDGET
     2653    19037               PURPOSE: Display budget limit
     2654    19038               CALL:   CALL DISPBUDGET
     2655    19039               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     2656    19040               INPUT:  B$JIT.BUDLIM
     2657    19041               OUTPUT: budget limit
     2658    19042               DESCRIPTION: The budget limit specified in the JIT is displayed.
     2659    19043        */
     2660    19044        /**********************************************************************/
     2661    19045    1   DISPBUDGET: PROC ALTRET;
     2662    19046    2   DCL I SBIN WORD;
     2663    19047    2   DCL CHR10 CHAR(10);
     2664    19048    2   DCL CHR11 CHAR(11);
     2665    19049    2   DCL CHR11A(0:10) REDEF CHR11 CHAR(1);
     2666    19050    2   DCL MOPS_7_2_STR(0:5) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS7,%ENF00,%INSB7,%
             19050            MVC2);
     2667    19051        /**/
     2668    19052        /**/
     2669    19053    2     OUTBUFF$ = ADDR(OUTBUFF);
     2670    19054    2     DEST$ = OUTBUFF$;
     2671    19055    2     OUTBUFF = '   Budget: ';
     2672    19056    2     DEST$ = PINCRC(DEST$,SIZEC('   Budget: '));
     2673    19057    2     IF B$JIT.BUDLIM > 0
     2674    19058    2       THEN
     2675    19059    3         DO ;
     2676    19060    3           INBUFF = '$' ;
     2677    19061    3           IN$ = ADDR(INBUFF) ;
     2678    19062    3           CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPBUDGET50) ;
     2679    19063    3           CALL BINXCHAR(CHR10,(B$JIT.BUDLIM-SEG$2.ACCUM_CHG+50)/100);
     2680    19064    3           CALL EDITXCHAR(CHR11,,,MOPS_7_2_STR,CHR10);
     2681    19065    3           I = 0;
     2682    19066    4           DO WHILE (CHR11A(I) = ' ' AND I < SIZEC(CHR11));
     2683    19067    4             I = I+1;
     2684    19068    4           END;
     2685    19069    3           CHR11 = SUBSTR(CHR11,I,SIZEC(CHR11)-I);
     2686    19070    3           CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(CHR11),SIZEC(CHR11))  ALTRET(
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:84   
             19070                    DISPBUDGET50);
     2687    19071    3         END ; /* Then Do */
     2688    19072    2       ELSE
     2689    19073    3         DO ;
     2690    19074    3           INBUFF = 'No budget limit' ;
     2691    19075    3           IN$ = ADDR(INBUFF) ;
     2692    19076    3           LEN = SIZEC('No budget limit') ;
     2693    19077    3           CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPBUDGET50);
     2694    19078    3         END ; /* Else Do */
     2695    19079    2     INBUFF = ', using $' ;
     2696    19080    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,9,TAB_VAL) ALTRET(DISPBUDGET50) ;
     2697    19081    2     CALL BINXCHAR(CHR10,(SEG$2.ACCUM_CHG+50)/100);
     2698    19082    2     CALL EDITXCHAR(CHR11,,,MOPS_7_2_STR,CHR10);
     2699    19083    2     I = 0;
     2700    19084    3     DO WHILE (CHR11A(I) = ' ' AND I < SIZEC(CHR11));
     2701    19085    3     I = I+1;
     2702    19086    3     END;
     2703    19087    2     CHR11 = SUBSTR(CHR11,I,SIZEC(CHR11)-I);
     2704    19088    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(CHR11),SIZEC(CHR11))  ALTRET(DISPBUDGET50);
     2705    19089    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
     2706    19090    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     2707    19091    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$)  ALTRET(DISPBUDGET50);
     2708    19092    2     RETURN;
     2709    19093    2   DISPBUDGET50:;
     2710    19094    2     ALTRETURN;
     2711    19095    2   END DISPBUDGET;
     2712    19096                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:85   
     2713    19097        /********************************************************************/
     2714    19098        /*I*   NAME:   DISPWSN
     2715    19099               PURPOSE: Display work station name of origin
     2716    19100               CALL:   CALL DISPWSN
     2717    19101               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     2718    19102               INPUT:  B$JIT.WOO
     2719    19103               OUTPUT: work station name of origin displayed
     2720    19104               DESCRIPTION: The work station name of origin is displayed.
     2721    19105        */
     2722    19106        /**********************************************************************/
     2723    19107    1   DISPWSN: PROC ALTRET;
     2724    19108        /**/
     2725    19109        /**/
     2726    19110    2     OUTBUFF$ = ADDR(OUTBUFF);
     2727    19111    2     DEST$ = OUTBUFF$;
     2728    19112    2     OUTBUFF = '   WSN: ';
     2729    19113    2     DEST$ = PINCRC(DEST$,SIZEC('   WSN: '));
     2730    19114    2     CALL INDEX(LEN,' ',B$JIT.WOO);
     2731    19115    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.WOO),LEN)  ALTRET(DISPWSN50);
     2732    19116    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);
     2733    19117    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
     2734    19118    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$)  ALTRET(DISPWSN50);
     2735    19119    2     RETURN;
     2736    19120    2   DISPWSN50:
     2737    19121    2     ALTRETURN;
     2738    19122    2   END DISPWSN;
     2739    19123                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:86   
     2740    19124        /**********************************************************************/
     2741    19125        /*I*   NAME:   DISPLDEV
     2742    19126               PURPOSE: Display LDEV information for specific LDEVs.
     2743    19127               CALL:   CALL DISPLDEV
     2744    19128                       DISPLDEV
     2745    19129               INPUT:
     2746    19130               OUTPUT: LDEV information to the listing device
     2747    19131               DESCRIPTION: IBEX determines what type of device to report about.
     2748    19132                       Then searches for a DCB with that device type.  Calls M$LDEV
     2749    19133                       to get the information and outputs to the listing device.
     2750    19134        */
     2751    19135        /***********************************************************************/
     2752    19136    1   DISPLDEV: PROC ALTRET ;
     2753    19137    2   DCL I UBIN WORD ;
     2754    19138    2   DCL J UBIN WORD ;
     2755    19139    2   DCL N UBIN ;
     2756    19140    2   DCL TEMP2$ PTR ;
     2757    19141    2   DCL OPT CHAR(4) ;
     2758    19142    2   DCL OPTLEN UBIN WORD ;
     2759    19143        /**/
     2760    19144    2           LDEVS_HDR_PRINTED = %NO# ;
     2761    19145    2           OUTBUFF$ = ADDR(OUTBUFF) ;
     2762    19146    3           DO CASE(TEMP$->P$B.CODE) ;
     2763    19147
     2764    19148    3             CASE(DALLOPT) ;
     2765    19149    3               DILDEV_OPT = %YES# ;
     2766    19150    3               OPT=' ' ;
     2767    19151    3               OPTLEN = 0 ;
     2768    19152
     2769    19153    3             CASE(%DLDEVOPT#) ;
     2770    19154    3               DILDEV_OPT = %YES# ;
     2771    19155    3               OPT='LP' ;
     2772    19156    3               OPTLEN=2 ;
     2773    19157
     2774    19158    3             CASE(%DLDEVSOPT#) ;
     2775    19159    3               DILDEV_OPT = %NO# ;
     2776    19160    3               OPT=' ' ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:87   
     2777    19161    3               OPTLEN = 0 ;
     2778    19162
     2779    19163    3           END ; /* Do Case */
     2780    19164    2           IN$ = ADDR(INBUFF) ;
     2781    19165    2           DCBSLOT = M$IBEX1_NUM ;
     2782    19166
     2783    19167    2           IF TEMP$->P$B.NSUBLKS = 0
     2784    19168    2             THEN
     2785    19169    3               DO ;
     2786    19170    3                 N = 0 ;
     2787    19171    3                 OUTBUFF = ' ' ;
     2788    19172    3                 LDEVS_EXIST = %NO# ;
     2789    19173    3                 DEST$ = OUTBUFF$ ;
     2790    19174    3                 CALL FIND_ALL_LDEVS(N,OPT,OPTLEN) ALTRET(DISPLDEV_ERR) ;
     2791    19175    3                 GOTO DISPLDEV_RET ;
     2792    19176    3               END ; /* Then Do */
     2793    19177
     2794    19178    3           DO I=0 TO TEMP$->P$B.NSUBLKS-1 ;
     2795    19179    4             DO CASE(TEMP$->P$B.SUBLK$(I)->P$B.CODE) ;
     2796    19180
     2797    19181    4               CASE(%LDEV_ALL#) ;
     2798    19182    4                 OPT=' ' ;
     2799    19183    4                 OPTLEN = 0 ;
     2800    19184
     2801    19185    4               CASE(%LDEV_STRM#) ;
     2802    19186    5                 DO J = 0 TO TEMP$->P$B.SUBLK$(I)->P$B.NSUBLKS-1 ;
     2803    19187    5                   TEMP2$ = TEMP$->P$B.SUBLK$(I)->P$B.SUBLK$(J) ;
     2804    19188    6                   DO CASE(TEMP2$->P$B.CODE) ;
     2805    19189
     2806    19190    6                     CASE(%LDEV_STRM_NAME#) ;
     2807    19191    6                       OPT = TEMP2$->P$S.TEXT ;
     2808    19192    6                       OPTLEN = 2 ;
     2809    19193
     2810    19194    6                     CASE(%LDEV_STRM_NUM#) ;
     2811    19195    6                       SUBSTR(OPT,2,2)=TEMP2$->P$S.TEXT ;
     2812    19196    6                       OPTLEN = 4 ;
     2813    19197    6                   END ; /* Do Case */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:88   
     2814    19198    5                 END ; /* Do J */
     2815    19199    4             END ; /* Do Case */
     2816    19200    3             OUTBUFF = ' ' ;
     2817    19201    3             N = 0 ;
     2818    19202    3             LDEVS_EXIST = %NO# ;
     2819    19203        /**/
     2820    19204    3             CALL FIND_ALL_LDEVS(N,OPT,OPTLEN) ALTRET(DISPLDEV_ERR) ;
     2821    19205    3         END ; /* Do I */
     2822    19206
     2823    19207    2   DISPLDEV_RET:
     2824    19208    2         RETURN ;
     2825    19209
     2826    19210    2   DISPLDEV_ERR:
     2827    19211    2         ALTRETURN ;
     2828    19212
     2829    19213    2   END DISPLDEV;
     2830    19214        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:89   
     2831    19215    1   DILDEV: PROC(N,OPT,OPTLEN)ALTRET;
     2832    19216    2   DCL N SBIN;         /* N is LDEV index #. Set to 0 by caller on first call.*/
     2833    19217    2   DCL OPT CHAR(4);
     2834    19218    2   DCL OPTLEN UBIN;
     2835    19219                                                /* ALTRET if no more to print.*/
     2836    19220        /*****     REFERENCES     *****/
     2837    19221        %CODE16;
     2838    19229    2   DCL B$ROS$ PTR SYMREF;
     2839    19230        /*****     AUTOMATIC (NON-FPT)     *****/
     2840    19231    2   DCL DCB$ PTR;
     2841    19232    2   DCL FORM$ PTR;
     2842    19233    2   DCL COUNTER1 CHAR(12);
     2843    19234    2   DCL COUNTER2 CHAR(12);
     2844    19235    2   DCL IND2 UBIN;
     2845    19236    2   DCL TEMP UBIN ;
     2846    19237    2   DCL UC_FLG BIT(1) ;
     2847    19238    2   DCL STREAM UBIN ;
     2848    19239    2   DCL OPEN BIT(1) ;
     2849    19240    2   DCL LEN SBIN ;
     2850    19241    2   DCL OPT_TBLSZE SBIN WORD CONSTANT INIT(5);
     2851    19242    2   DCL 1 OPT_TBL(0:4) CONSTANT ALIGNED,    /*DCB DISPLAY OPTION TABLE*/
     2852    19243    2         2 LEN UBIN BYTE UNAL INIT
     2853    19244    2           (7,7,7,7,8),
     2854    19245    2         2 HDR CHAR(10) UNAL INIT
     2855    19246    2           ('Topbrdr','Btmbrdr','Lftbrdr','Rhtbrdr','Optional'),
     2856    19247    2         2 OPTION UBIN BYTE UNAL INIT
     2857    19248    2            (TOPBRDROPT,BTMBRDROPT,LFTBRDROPT,RHTBRDROPT,OPTIONALOPT) ;
     2858    19249        /*****     FPT'S     *****/
     2859    19250        %FPT_OPEN(FPTN=OPNMYDCB,STCLASS=);
     2860    19359        %FPT_OPEN(FPTN=CONSTOPN,STCLASS=CONSTANT,ASN=DEVICE,FUN=CREATE);
     2861    19468        %FPT_CLOSE(FPTN=CLSMYDCB,STCLASS=);
     2862    19510        %FPT_CLOSE(FPTN=CONSTCLS,STCLASS=CONSTANT,DISP=SAVE);
     2863    19552        %FPT_TRMCTL(FPTN=FPT_TRMCTL, STCLASS="") ;
     2864    19579        %FPT_TRMCTL(FPTN=CFPT_TRMCTL, STCLASS=CONSTANT) ;
     2865    19606        %VLP_WINDOW(FPTN=VLP_WINDOW,STCLASS="") ;
     2866    19650        %VLP_HDR (FPTN=VLP$HDR, LEN="VLP$HDR.TITL.L#", STCLASS=BASED) ;
     2867    19666        /*****     *****     *****     *****     *****     *****     *****/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:90   
     2868    19667    2   BEGIN:
     2869    19668    2           IF N<0 OR N>15 THEN ALTRETURN;
     2870    19669    3           DO WHILE (B$ROS$->B$ROSEG.LDEVNAME(N)=' ' OR
     2871    19670    3             B$ROS$->B$ROSEG.STREAMID.FLG(N)=0);
     2872    19671    3              N=N+1; IF N>15 THEN ALTRETURN;
     2873    19672    3              END;
     2874    19673    2           IF B$ROS$->B$ROSEG.STREAMID.UC_STR(N)
     2875    19674    2           THEN
     2876    19675    2              UC_FLG = %YES# ;
     2877    19676    2           ELSE
     2878    19677    2              UC_FLG = %NO# ;
     2879    19678    2           IF SUBSTR(B$ROS$->B$ROSEG.LDEVNAME(N),0,OPTLEN)=
     2880    19679    2             SUBSTR(OPT,0,OPTLEN)
     2881    19680    2           THEN
     2882    19681    2              IF UC_FLG
     2883    19682    2              THEN
     2884    19683    3              DO ;
     2885    19684    3                 STREAM = N ;
     2886    19685    4                 CALL DISPLAY_WINDOW_OPTS WHENALTRETURN DO ;
     2887    19686    4                    N = N + 1 ;
     2888    19687    4                    CALL CLOSEMYDCB ;
     2889    19688    4                    GOTO BEGIN ;
     2890    19689    4                    END ;                  /* Whenaltreturn Do                   */
     2891    19690    3                 END ;                     /* Then Do                            */
     2892    19691    2              ELSE
     2893    19692    2                 CALL DISPLAY_NORMAL_LDEV ALTRET(ALTRETUR) ;
     2894    19693    2           CALL CLOSEMYDCB ;
     2895    19694    2           N=N+1;
     2896    19695    2           RETURN;
     2897    19696    2   ALTRETUR:
     2898    19697    2             CALL CLOSEMYDCB ;
     2899    19698    2             ALTRETURN ;
     2900    19699        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:91   
     2901    19700    2   DISPLAY_NORMAL_LDEV: PROC ALTRET ;
     2902    19701
     2903    19702    3   DCL SIZ UBIN WORD ;
     2904    19703
     2905    19704    3           IF DCBADDR(DCBSLOT)->F$DCB.FCD#
     2906    19705    3             THEN
     2907    19706    3               CALL CLOSEMYDCB ;
     2908    19707    3           OPNMYDCB=CONSTOPN;
     2909    19708    3           OPNMYDCB.V.DCB#=DCBSLOT;
     2910    19709    3           OPNMYDCB.V.RES#=B$ROS$->B$ROSEG.LDEVNAME(N);
     2911    19710    3           OPNMYDCB.V_=VECTOR(OPNMYDCB.V);
     2912    19711    3           CALL M$OPEN(OPNMYDCB)ALTRET(DISPLAY_ALTRET);
     2913    19712    3           OPEN = %YES# ;
     2914    19713    3           DCB$=DCBADDR(DCBSLOT)->F$DCB.CFU$;
     2915    19714    3           FORM$=DCB$->F$DCB.FORM$;
     2916    19715    3           IF LDEVS_HDR_PRINTED = %NO#
     2917    19716    3             THEN
     2918    19717    4               DO ;
     2919    19718    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_ = VECTOR(LDEVHDR) ;
     2920    19719    4                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPLAY_ALTRET) ;
     2921    19720    4                 LDEVS_HDR_PRINTED = %YES# ;
     2922    19721    4               END ; /* Then Do */
     2923    19722    3           IF LDEVS_EXIST = %NO#
     2924    19723    3             THEN
     2925    19724    3               LDEVS_EXIST = %YES# ;
     2926    19725    3           IF DILDEV_OPT
     2927    19726    3             THEN
     2928    19727    4               DO ;
     2929    19728    4                 OUTBUFF=' ';
     2930    19729    4                 DEST$ = OUTBUFF$ ;
     2931    19730    4                 TAB_VAL = 22 ;
     2932    19731    4                 SIZ = TAB_VAL ;
     2933    19732    4               END ; /* Then Do */
     2934    19733    3             ELSE
     2935    19734    4               DO ;
     2936    19735    4                 TAB_VAL = 5 ;
     2937    19736    4                 SIZ = 10 ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:92   
     2938    19737    4               END ; /* Else Do */
     2939    19738    3           CALL CONCAT(INBUFF,'     ',B$ROS$->B$ROSEG.LDEVNAME(N),
     2940    19739    3             ' ',SUBSTR(DCB$->F$DCB.RES#,0,2),'@',DCB$->F$DCB.WSN#);
     2941    19740    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, SIZ) ALTRET(DISPLAY_ALTRET) ;
     2942    19741    3           IF NOT DILDEV_OPT
     2943    19742    3             THEN
     2944    19743    3               GOTO DISPLAY_RETURN ;
     2945    19744    3           CALL CONCAT(INBUFF,'Form=',FORM$->CODE16.FORM) ;
     2946    19745    3           CALL SEARCHR(IND1, TEMP, SRCHTBL, FORM$->CODE16.FORM) ;
     2947    19746    3           CALL INSERT(INBUFF, IND1+6, 1, ',') ;
     2948    19747    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 12)
     2949    19748    3             ALTRET(DISPLAY_ALTRET) ;
     2950    19749    3           IND1 = FORM$->CODE16.PAGENO ;
     2951    19750    3           IF IND1 ~= 0 OR FORM$ -> CODE16.LINENO ~= 0
     2952    19751    3             THEN
     2953    19752    4               DO;
     2954    19753    4                 CALL CNVRT_BLD(SIZEC(' Pages='),' Pages=',IND1) ;
     2955    19754    4                 IND1 = FORM$ -> CODE16.LINENO ;
     2956    19755    4                 IF IND1 ~= 0
     2957    19756    4                   THEN
     2958    19757    4                     CALL CNVRT_BLD(SIZEC(', Lines='),', Lines=',IND1) ;
     2959    19758    4               END;
     2960    19759    3             ELSE
     2961    19760    4               DO;
     2962    19761    4                 IND1 = FORM$ -> CODE16.RECNO ;
     2963    19762    4                 CALL CNVRT_BLD(SIZEC(' Records='),' Records=',IND1) ;
     2964    19763    4               END;
     2965    19764    3           IND1 = FORM$->CODE16.COPIES ;
     2966    19765    3           CALL CNVRT_BLD(SIZEC(', Copies='),', Copies=',IND1) ;
     2967    19766    3           IF DCB$->F$DCB.HEADER$ ~= ADDR(NIL)
     2968    19767    3             THEN
     2969    19768    4               DO ;
     2970    19769    4                 IND1 = DCB$->F$DCB.HEADER$->VLP$HDR.CTL.COUNT# ;
     2971    19770    4                 IF IND1 ~= 0
     2972    19771    4                   THEN
     2973    19772    4                       CALL CNVRT_BLD(SIZEC(', Pagecolumn='),', Pagecolumn=',IND1) ;
     2974    19773    4                 IND1 = DCB$->F$DCB.HEADER$->VLP$HDR.TITL.L# ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:93   
     2975    19774    4                 IF IND1 ~= 0
     2976    19775    4                   THEN
     2977    19776    5                     DO ;
     2978    19777    5                       INBUFF = ', ' ;
     2979    19778    5                       CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 2, TAB_VAL)
     2980    19779    5                               ALTRET(DISPLAY_ALTRET) ;
     2981    19780    5                       CALL CONCAT(INBUFF,'Title=''',DCB$->F$DCB.HEADER$->
     2982    19781    5                              VLP$HDR.TITL.TITLE#,'''') ;
     2983    19782    5                       CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+8,TAB_VAL)
     2984    19783    5                             ALTRET(DISPLAY_ALTRET) ;
     2985    19784    5                     END ; /* Then Do */
     2986    19785    4               END ; /* Then Do */
     2987    19786
     2988    19787    3   DISPLAY_RETURN:
     2989    19788    3           RETURN ;
     2990    19789
     2991    19790    3   DISPLAY_ALTRET:
     2992    19791    3           ALTRETURN ;
     2993    19792    3   END     DISPLAY_NORMAL_LDEV ;
     2994    19793        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:94   
     2995    19794    2   DISPLAY_WINDOW_OPTS: PROC  ALTRET ;
     2996    19795    3           FPT_TRMCTL = CFPT_TRMCTL ;
     2997    19796    3           FPT_TRMCTL.V_ = VECTOR(FPT_TRMCTL.V) ;
     2998    19797    3           FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_WINDOW) ;
     2999    19798    3           FPT_TRMCTL.V.VLPTYPE# = %TRMCTL_WINDOW# ;
     3000    19799    3           CALL SETUP_TCTL_DCB ALTRET(WINDOW_OPTS_ALT) ;
     3001    19800    3           CALL M$GTRMCTL(FPT_TRMCTL) ALTRET(WINDOW_OPTS_ALT) ;
     3002    19801    3           IF LDEVS_HDR_PRINTED = %NO#
     3003    19802    3             THEN
     3004    19803    4               DO ;
     3005    19804    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_ = VECTOR(LDEVHDR) ;
     3006    19805    4                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(WINDOW_OPTS_ALT) ;
     3007    19806    4                 LDEVS_HDR_PRINTED = %YES# ;
     3008    19807    4               END ; /* Then Do */
     3009    19808    3           IF LDEVS_EXIST = %NO#
     3010    19809    3             THEN
     3011    19810    3               LDEVS_EXIST = %YES# ;
     3012    19811    3           IF DILDEV_OPT
     3013    19812    3             THEN
     3014    19813    4               DO ;
     3015    19814    4                 OUTBUFF=' ';
     3016    19815    4                 DEST$ = OUTBUFF$ ;
     3017    19816    4                 TAB_VAL = 10 ;
     3018    19817    4               END ; /* Then Do */
     3019    19818    3             ELSE
     3020    19819    3               TAB_VAL = 5 ;
     3021    19820    3           CALL CONCAT(INBUFF,'     ', B$ROS$->B$ROSEG.LDEVNAME(N)) ;
     3022    19821    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 10) ALTRET(WINDOW_OPTS_ALT) ;
     3023    19822    3           IF NOT DILDEV_OPT
     3024    19823    3             THEN
     3025    19824    3               GOTO WINDOW_OPTS_RET ;
     3026    19825    3           INBUFF = 'Position=' ;
     3027    19826    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 9) ALTRET(WINDOW_OPTS_ALT) ;
     3028    19827    3           IND1 = VLP_WINDOW.ORG_PST.LINE ;
     3029    19828    3           CALL BINCHAR(COUNTER1,IND1) ;
     3030    19829    3           CALL CPE$RZEROS(COUNTER1,SIZEC(COUNTER1),LEN) ;
     3031    19830    3           IND2 = VLP_WINDOW.ORG_PST.COLUMN ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:95   
     3032    19831    3           CALL BINCHAR(COUNTER2,IND2) ;
     3033    19832    3           CALL CPE$RZEROS(COUNTER2,SIZEC(COUNTER2),TEMP) ;
     3034    19833    3           INBUFF = ' ' ;
     3035    19834    3           CALL CONCAT(INBUFF, '(', SUBSTR(COUNTER1,0,LEN), ',', SUBSTR(COUNTER2,0,TEMP
             19834                    ),
     3036    19835    3             ')') ;
     3037    19836    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, LEN+TEMP+3)
     3038    19837    3             ALTRET(WINDOW_OPTS_ALT) ;
     3039    19838    3           IND1 = VLP_WINDOW.LENGTH# ;
     3040    19839    3           CALL CNVRT_BLD(SIZEC(', WLength='), ', WLength=', IND1) ;
     3041    19840    3           IND1 = VLP_WINDOW.WIDTH# ;
     3042    19841    3           CALL CNVRT_BLD(SIZEC(', WWidth='), ', WWidth=', IND1) ;
     3043    19842    3           IND1 = VLP_WINDOW.MINWIDTH# ;
     3044    19843    3           CALL CNVRT_BLD(SIZEC(', MinWidth='), ', MinWidth=', IND1) ;
     3045    19844    3           IND1 = VLP_WINDOW.MINLENGTH# ;
     3046    19845    3           CALL CNVRT_BLD(SIZEC(', MinLength='), ', MinLength=', IND1) ;
     3047    19846    3           CALL PUT_FLAG(VLP_WINDOW.TOPBRDR#, 'TopBrdr', LENGTHC('TopBrdr'))
     3048    19847    3             ALTRET(WINDOW_OPTS_ALT) ;
     3049    19848    3           CALL PUT_FLAG(VLP_WINDOW.BTMBRDR#, 'BtmBrdr', LENGTHC('BtmBrdr'))
     3050    19849    3             ALTRET(WINDOW_OPTS_ALT) ;
     3051    19850    3           CALL PUT_FLAG(VLP_WINDOW.LFTBRDR#, 'LftBrdr', LENGTHC('LftBrdr'))
     3052    19851    3             ALTRET(WINDOW_OPTS_ALT) ;
     3053    19852    3           CALL PUT_FLAG(VLP_WINDOW.RHTBRDR#, 'RhtBrdr', LENGTHC('RhtBrdr'))
     3054    19853    3             ALTRET(WINDOW_OPTS_ALT) ;
     3055    19854    3           CALL PUT_FLAG(VLP_WINDOW.REMOVABLE#, 'Optional', LENGTHC('Optional'))
     3056    19855    3             ALTRET(WINDOW_OPTS_ALT) ;
     3057    19856    3           IF VLP_WINDOW.HBRDRSIZ# > 0
     3058    19857    3           THEN
     3059    19858    4           DO ;
     3060    19859    4              IND1 = VLP_WINDOW.HBRDRSIZ# ;
     3061    19860    4              CALL MOVE_COMMA_BLANK ;
     3062    19861    4              CALL CNVRT_BLD(SIZEC('HBrdrSiz='), 'HBrdrSiz=', IND1) ;
     3063    19862    4              END ;                        /*  Then Do                           */
     3064    19863    3           IND1 = ASCBIN(VLP_WINDOW.HBRDRCHR#) ;
     3065    19864    3           IF IND1 >= 32
     3066    19865    3           THEN
     3067    19866    4           DO ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:96   
     3068    19867    4              CALL MOVE_COMMA_BLANK ;
     3069    19868    4              INBUFF = ' ' ;
     3070    19869    4              CALL CONCAT(INBUFF, 'HBrdrChr=''', VLP_WINDOW.HBRDRCHR#,'''') ;
     3071    19870    4              CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 12, TAB_VAL)
     3072    19871    4                ALTRET(WINDOW_OPTS_ALT) ;
     3073    19872    4              END ;                        /* Then Do                            */
     3074    19873    3           IF VLP_WINDOW.VBRDRSIZ# > 0
     3075    19874    3           THEN
     3076    19875    4           DO ;
     3077    19876    4              IND1 = VLP_WINDOW.VBRDRSIZ# ;
     3078    19877    4              CALL MOVE_COMMA_BLANK ;
     3079    19878    4              CALL CNVRT_BLD(SIZEC('VBrdrSiz='), 'VBrdrSiz=', IND1) ;
     3080    19879    4              END ;                        /*  Then Do                           */
     3081    19880    3           IND1 = ASCBIN(VLP_WINDOW.VBRDRCHR#) ;
     3082    19881    3           IF IND1 >= 32
     3083    19882    3           THEN
     3084    19883    4           DO ;
     3085    19884    4              CALL MOVE_COMMA_BLANK ;
     3086    19885    4              INBUFF = ' ' ;
     3087    19886    4              CALL CONCAT(INBUFF, 'VBrdrChr=''', VLP_WINDOW.VBRDRCHR#,'''') ;
     3088    19887    4              CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 12, TAB_VAL)
     3089    19888    4                ALTRET(WINDOW_OPTS_ALT) ;
     3090    19889    4              END ;                        /* Then Do                            */
     3091    19890    3   WINDOW_OPTS_RET:
     3092    19891    3           RETURN ;
     3093    19892
     3094    19893    3   WINDOW_OPTS_ALT:
     3095    19894    3           ALTRETURN ;
     3096    19895    3   END   DISPLAY_WINDOW_OPTS ;
     3097    19896        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:97   
     3098    19897    2   SETUP_TCTL_DCB: PROC ALTRET ;
     3099    19898        /*
     3100    19899          *** Auto
     3101    19900        */
     3102    19901    3   DCL I UBIN WORD ;
     3103    19902    3   DCL K UBIN ;
     3104    19903    3   DCL DCBTAB$ PTR ;
     3105    19904        /**/
     3106    19905    3           OPEN = %NO# ;
     3107    19906    3           DCBTAB$ = B$ROS$->B$ROSEG.DCBPTR$ ;
     3108    19907    3           K = B$ROS$->B$ROSEG.NUMDCBS ;
     3109    19908        /*
     3110    19909              First look for a dcb open to the specified stream,
     3111    19910              failing locating one, open a dcb to that stream.
     3112    19911        */
     3113    19912    4           DO I=0 TO K-1 ;
     3114    19913    4              IF DCBADDR(I)~=ADDR(NIL)
     3115    19914    4              THEN
     3116    19915    4                 IF DCBADDR(I)->F$DCB.FCD# AND DCBADDR(I)->F$DCB.STR#=STREAM
     3117    19916    4                 THEN
     3118    19917    5                 DO ;
     3119    19918    5                    FPT_TRMCTL.V.DCB# = I ;
     3120    19919    5                    RETURN ;
     3121    19920    5                    END ;                  /* Then Do                            */
     3122    19921    4              END ;                        /* Do I                               */
     3123    19922        /*
     3124    19923              No dcb open to this stream, open one.
     3125    19924        */
     3126    19925    3           OPNMYDCB = CONSTOPN;
     3127    19926    3           OPNMYDCB.V_ = VECTOR(OPNMYDCB.V) ;
     3128    19927    3           DCBSLOT = M$IBEX1_NUM ;
     3129    19928    3           IF DCBADDR(DCBSLOT)->F$DCB.FCD#
     3130    19929    3             THEN
     3131    19930    3               CALL CLOSEMYDCB ;
     3132    19931    3           OPNMYDCB.V.DCB# = DCBSLOT ;
     3133    19932    3           OPNMYDCB.V.RES# = B$ROS$->B$ROSEG.LDEVNAME(STREAM) ;
     3134    19933    3           OPNMYDCB.V.ASN# = %DEVICE# ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:98   
     3135    19934    4           CALL M$OPEN(OPNMYDCB) WHENALTRETURN DO; ALTRETURN; END ;
     3136    19935
     3137    19936    3           FPT_TRMCTL.V.DCB# = DCBSLOT ;
     3138    19937    3           OPEN = %YES# ;
     3139    19938    3           RETURN ;
     3140    19939
     3141    19940    3   END   SETUP_TCTL_DCB ;
     3142    19941        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:99   
     3143    19942    2   MOVE_COMMA_BLANK: PROC ;
     3144    19943
     3145    19944    3           INBUFF = ',' ;
     3146    19945    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 1, TAB_VAL)
     3147    19946    4           WHENALTRETURN DO ; END ;
     3148    19947    3           IF DEST$ ~= PINCRC(OUTBUFF$, TAB_VAL)
     3149    19948    3           THEN
     3150    19949    4           DO ;
     3151    19950    4              INBUFF = ' ' ;
     3152    19951    4              CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 1, TAB_VAL)
     3153    19952    5              WHENALTRETURN DO ; END ;
     3154    19953    4              END ;                        /* Then Do                            */
     3155    19954    3           RETURN ;
     3156    19955    3   END   MOVE_COMMA_BLANK ;
     3157    19956        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:100  
     3158    19957    2   CLOSEMYDCB: PROC ;
     3159    19958    3           IF OPEN
     3160    19959    3           THEN
     3161    19960    3           CALL CLOSE_DCB(DCBSLOT);
     3162    19961    3           RETURN ;
     3163    19962    3   END   CLOSEMYDCB ;
     3164    19963        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:101  
     3165    19964    2   PUT_FLAG: PROC (FLAG, TEXT, LENGTH) ALTRET;
     3166    19965
     3167    19966    3   DCL FLAG BIT (2) UNAL;
     3168    19967    3   DCL TEXT CHAR (LENGTH);
     3169    19968    3   DCL LENGTH UBIN WORD;
     3170    19969
     3171    19970    3           IF FLAG = %YES#
     3172    19971    4           THEN DO;
     3173    19972
     3174    19973    4              CALL MOVE_COMMA_BLANK ;
     3175    19974    4              LEN = LENGTH ;
     3176    19975    4              INBUFF = TEXT ;
     3177    19976    4              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL)
     3178    19977    4                ALTRET (OOPS);
     3179    19978
     3180    19979    4              END;
     3181    19980
     3182    19981    3           RETURN;
     3183    19982
     3184    19983    3   OOPS:   ALTRETURN;
     3185    19984
     3186    19985    3   END PUT_FLAG;
     3187    19986    2   END   DILDEV;
     3188    19987        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:102  
     3189    19988    1   FIND_ALL_LDEVS: PROC(N, OPT, OPTLEN) ALTRET ;
     3190    19989
     3191    19990    2   DCL N SBIN ;
     3192    19991    2   DCL OPT CHAR(4) ;
     3193    19992    2   DCL OPTLEN UBIN ;
     3194    19993    2   DCL 1 BAD_LDEV_NAME,
     3195    19994    2         2 CNT UBIN BYTE CALIGNED,
     3196    19995    2         2 TXT CHAR(4) CALIGNED ;
     3197    19996
     3198    19997    3             DO WHILE('1'B);
     3199    19998    3               CALL DILDEV(N,OPT,OPTLEN)ALTRET(ENDIT);
     3200    19999    3               IF OUTBUFF~=' ' AND DILDEV_OPT THEN
     3201    20000    4                 DO ;
     3202    20001    4                   SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$) ;
     3203    20002    4                   SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$ ;
     3204    20003    4                   CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(FIND_ALL_LDEVS_ERR) ;
     3205    20004    4                 END ; /*  Then Do */
     3206    20005    3               IF DILDEV_OPT
     3207    20006    3                 THEN
     3208    20007    3                   OUTBUFF=' ';
     3209    20008    3             END;
     3210    20009    2   ENDIT:
     3211    20010    2             IF OUTBUFF~=' ' AND NOT DILDEV_OPT THEN
     3212    20011    3               DO ;
     3213    20012    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$) ;
     3214    20013    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$ ;
     3215    20014    3                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(FIND_ALL_LDEVS_ERR) ;
     3216    20015    3               END ; /*  Then Do */
     3217    20016    2             IF NOT DILDEV_OPT
     3218    20017    2               THEN
     3219    20018    2                 OUTBUFF=' ';
     3220    20019    2             IF LDEVS_EXIST = %NO#
     3221    20020    2               THEN
     3222    20021    2                 IF OPTLEN = 0
     3223    20022    2                   THEN
     3224    20023    3                     DO ;
     3225    20024    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_ = VECTOR(LDEVNHDR) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:103  
     3226    20025    3                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(FIND_ALL_LDEVS_ERR) ;
     3227    20026    3                     END ; /* Then Do */
     3228    20027    2                   ELSE
     3229    20028    3                     DO ;
     3230    20029    3                       BAD_LDEV_NAME.CNT = OPTLEN ;
     3231    20030    3                       BAD_LDEV_NAME.TXT = OPT ;
     3232    20031    3                       IF OPTLEN = 2
     3233    20032    3                         THEN
     3234    20033    3                           CALL CPC$WRITEMSGE(E_NOLDEVTHATTYPE,,BAD_LDEV_NAME,,,
     3235    20034    3                                 %YES#) ;
     3236    20035    3                         ELSE
     3237    20036    3                           CALL CPC$WRITEMSGE(E_NOSUCHLDEV,,BAD_LDEV_NAME,,,%YES#) ;
     3238    20037    3                     END ; /* Else Do */
     3239    20038    2         RETURN ;
     3240    20039
     3241    20040    2   FIND_ALL_LDEVS_ERR:
     3242    20041    2         ALTRETURN ;
     3243    20042
     3244    20043    2   END   FIND_ALL_LDEVS ;
     3245    20044                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:104  
     3246    20045        /**********************************************************************/
     3247    20046        /*I*   NAME:   DISPNOTIFY
     3248    20047               PURPOSE: Display the settings of various flags for NOTIFY
     3249    20048               CALL:   CALL DISPNOTIFY
     3250    20049               INTERFACE: CPC$WRITEMSGE,CPE$LISTOUT,CPB$BLDIMAGE,CPJ$READ_S, CPC$OPEN_S
     3251    20050               INPUT:
     3252    20051               OUTPUT: flag settings in the *S NOTIFY record.
     3253    20052               DESCRIPTION: The various flag settings in the *S NOTIFY record are
     3254    20053                       reflected on the listing device.
     3255    20054        */
     3256    20055        /**********************************************************************/
     3257    20056    1   DISPNOTIFY: PROC ALTRET ;
     3258    20057
     3259    20058        %CP_CHFLAGS (FPTN=CP_CHFLAGS, STCLASS=AUTO) ;
     3260    20192    2   DCL OUTBUFF2 CHAR(120) ;
     3261    20193    2   DCL OUTBUFF2$ PTR ;
     3262    20194    2   DCL DEST2$ PTR ;
     3263    20195    2   DCL LEN UBIN WORD ;
     3264    20196    2   DCL WAIT_INT CHAR(3) ;
     3265    20197
     3266    20198    2     FPT_CLOSE = CFPT_CLOSE;
     3267    20199    2     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
     3268    20200    2     FPT_CLOSE.V.DISP# = %SAVE# ;
     3269    20201    2     FPT_CLOSE.V.DCB# = M$IBEX1_NUM ;
     3270    20202    2     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(DISPNOTIFY_ALT) ;
     3271    20203    2     CALL CPJ$READ_S (M$IBEX1_NUM,VECTOR(K_NOTIFY),VECTOR(CP_CHFLAGS))
     3272    20204    2             WHENALTRETURN
     3273    20205    3               DO ;
     3274    20206    3                 IF B$TCB.ALT$->B$EXCFR.ERR.ERR# ~= %E$NOKEY
     3275    20207    3                   THEN
     3276    20208    3                     GOTO DISPNOTIFY_ERR ;
     3277    20209    3                 OUTBUFF = '   Notify: none' ;
     3278    20210    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = 14 ;
     3279    20211    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = ADDR(OUTBUFF) ;
     3280    20212    3                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;
     3281    20213    4                 CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;
     3282    20214    4                                         END ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:105  
     3283    20215    3                 GOTO DISPNOTIFY_RET ;
     3284    20216    3               END ;   /* Whenaltreturn Do */
     3285    20217
     3286    20218    3     CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;
     3287    20219    3                             END ;
     3288    20220    2     IN$ = ADDR(INBUFF) ;
     3289    20221    2     OUTBUFF$ = ADDR(OUTBUFF) ;
     3290    20222    2     DEST$ = OUTBUFF$ ;
     3291    20223    2     OUTBUFF = '   Notify:' ;
     3292    20224    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = 9 ;
     3293    20225    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF$ ;
     3294    20226    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;
     3295    20227
     3296    20228    2     INBUFF = '     Use ' ;
     3297    20229    2     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 9) ALTRET(DISPNOTIFY_ALT) ;
     3298    20230    2     VLP_SN = CP_CHFLAGS.USE_SN ;
     3299    20231    2     IF VLP_SN.SN#(0) ~= ' '
     3300    20232    2         THEN
     3301    20233    3             DO ;
     3302    20234    3               CALL CONCAT(INBUFF,'DP#',VLP_SN.SN#(0)) ;
     3303    20235    3               CALL SEARCHR(IND1, TEMP, SRCHTBL, VLP_SN.SN#(0)) ;
     3304    20236    3               CALL INSERT(INBUFF, IND1+4, 1, '/') ;
     3305    20237    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+5)
     3306    20238    3                     ALTRET(DISPNOTIFY_ALT) ;
     3307    20239    3             END ; /* Then Do */
     3308    20240    2     INBUFF = CP_CHFLAGS.USE_NAME.NAME# ;
     3309    20241    2     IND1 = CP_CHFLAGS.USE_NAME.L# ;
     3310    20242    2     CALL INSERT(INBUFF, IND1, 1, '.') ;
     3311    20243    2     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+1) ALTRET(DISPNOTIFY_ALT) ;
     3312    20244    2     IF CP_CHFLAGS.USE_ACCT ~= ' '
     3313    20245    2         THEN
     3314    20246    3             DO ;
     3315    20247    3               INBUFF = CP_CHFLAGS.USE_ACCT ;
     3316    20248    3               CALL SEARCHR(IND1, TEMP, SRCHTBL, CP_CHFLAGS.USE_ACCT) ;
     3317    20249    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+1)
     3318    20250    3                     ALTRET(DISPNOTIFY_ALT) ;
     3319    20251    3             END ; /* Then Do */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:106  
     3320    20252    2     IF CP_CHFLAGS.USE_PASS ~= ' '
     3321    20253    2         THEN
     3322    20254    3             DO ;
     3323    20255    3               CALL CONCAT(INBUFF, '.', CP_CHFLAGS.USE_PASS) ;
     3324    20256    3               CALL SEARCHR(IND1, TEMP, SRCHTBL, CP_CHFLAGS.USE_PASS) ;
     3325    20257    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+2)
     3326    20258    3                     ALTRET(DISPNOTIFY_ALT) ;
     3327    20259    3             END ; /* Then Do */
     3328    20260    2     IF CP_CHFLAGS.FLG.WAIT
     3329    20261    2         THEN
     3330    20262    3             DO ;
     3331    20263    3               INBUFF = ',  Wait ' ;
     3332    20264    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 8)
     3333    20265    3                   ALTRET(DISPNOTIFY_ALT) ;
     3334    20266    3               IF CP_CHFLAGS.WAIT_DONE
     3335    20267    3                 THEN
     3336    20268    4                   DO ;
     3337    20269    4                     INBUFF = 'Done ' ;
     3338    20270    4                     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 5)
     3339    20271    4                           ALTRET(DISPNOTIFY_ALT) ;
     3340    20272    4                   END ; /* Then Do */
     3341    20273    3                 ELSE
     3342    20274    4                   DO ;
     3343    20275    4                     INBUFF = 'Print ' ;
     3344    20276    4                     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 6)
     3345    20277    4                           ALTRET(DISPNOTIFY_ALT) ;
     3346    20278    4                   END ; /* Else Do */
     3347    20279    3               IND1 = CP_CHFLAGS.WAIT_INT ;
     3348    20280    3               CALL BINCHAR(WAIT_INT,IND1) ;
     3349    20281    3               CALL CPE$RZEROS(WAIT_INT, SIZEC(WAIT_INT), IND1) ;
     3350    20282    3               CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(WAIT_INT),IND1)
     3351    20283    3                       ALTRET(DISPNOTIFY_ALT) ;
     3352    20284    3             END ; /* Then Do */
     3353    20285    2     IF OUTBUFF ~= ' '
     3354    20286    2         THEN
     3355    20287    3             DO ;
     3356    20288    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:107  
     3357    20289    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$ ;
     3358    20290    3               CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;
     3359    20291    3             END ; /* Then Do */
     3360    20292
     3361    20293    2     OUTBUFF2 = ' ' ;
     3362    20294    2     OUTBUFF2$ = ADDR(OUTBUFF2) ;
     3363    20295    2     DEST2$ = OUTBUFF2$ ;
     3364    20296
     3365    20297    2     OUTBUFF = '     Flags:' ;
     3366    20298    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = 10 ;
     3367    20299    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF$ ;
     3368    20300    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;
     3369    20301    2     DEST$ = OUTBUFF$ ;
     3370    20302              /* Setup Set and Reset in respective buffers */
     3371    20303    2     TAB_VAL = 7 ;
     3372    20304    2     INBUFF = 'Set:' ;
     3373    20305    2     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 4, TAB_VAL) ALTRET(DISPNOTIFY_ALT) ;
     3374    20306    2     INBUFF = 'Reset:' ;
     3375    20307    2     CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 6, TAB_VAL) ALTRET(DISPNOTIFY_ALT) ;
     3376    20308    2     IF CP_CHFLAGS.SYSTEM
     3377    20309    2         THEN
     3378    20310    3             DO ;
     3379    20311    3               INBUFF = ' System,' ;
     3380    20312    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;
     3381    20313    3             END ;
     3382    20314    2         ELSE
     3383    20315    3             DO ;
     3384    20316    3               INBUFF = ' System,' ;
     3385    20317    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;
     3386    20318    3             END ;
     3387    20319    2     IF CP_CHFLAGS.FLG.TERM
     3388    20320    2         THEN
     3389    20321    3             DO ;
     3390    20322    3               INBUFF = ' Terminal,' ;
     3391    20323    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 10) ALTRET(DISPNOTIFY_ALT) ;
     3392    20324    3             END ;
     3393    20325    2         ELSE
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:108  
     3394    20326    3             DO ;
     3395    20327    3               INBUFF = ' Terminal,' ;
     3396    20328    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 10) ALTRET(DISPNOTIFY_ALT) ;
     3397    20329    3             END ;
     3398    20330    2     IF CP_CHFLAGS.FLG.INPUT
     3399    20331    2         THEN
     3400    20332    3             DO ;
     3401    20333    3               INBUFF = ' Input,' ;
     3402    20334    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 7) ALTRET(DISPNOTIFY_ALT) ;
     3403    20335    3             END ;
     3404    20336    2         ELSE
     3405    20337    3             DO ;
     3406    20338    3               INBUFF = ' Input,' ;
     3407    20339    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 7) ALTRET(DISPNOTIFY_ALT) ;
     3408    20340    3             END ;
     3409    20341    2     IF CP_CHFLAGS.FLG.OUTPUT
     3410    20342    2         THEN
     3411    20343    3             DO ;
     3412    20344    3               INBUFF = ' Output,' ;
     3413    20345    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;
     3414    20346    3             END ;
     3415    20347    2         ELSE
     3416    20348    3             DO ;
     3417    20349    3               INBUFF = ' Output,' ;
     3418    20350    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;
     3419    20351    3             END ;
     3420    20352    2     IF CP_CHFLAGS.FLG.RUNNING
     3421    20353    2         THEN
     3422    20354    3             DO ;
     3423    20355    3               INBUFF = ' Running,' ;
     3424    20356    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 9) ALTRET(DISPNOTIFY_ALT) ;
     3425    20357    3             END ;
     3426    20358    2         ELSE
     3427    20359    3             DO ;
     3428    20360    3               INBUFF = ' Running,' ;
     3429    20361    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 9) ALTRET(DISPNOTIFY_ALT) ;
     3430    20362    3             END ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:109  
     3431    20363                      /* If any flags Set, then output buffer. */
     3432    20364    2     LEN = POFFC(DEST$,OUTBUFF$) ;
     3433    20365    2     IF LEN>(SIZEC('Set:')+TAB_VAL)
     3434    20366    2         THEN
     3435    20367    3             DO ;
     3436    20368    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = LEN-2 ;
     3437    20369    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF$ ;
     3438    20370    3               CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;
     3439    20371    3             END ; /* Then Do */
     3440    20372
     3441    20373                      /* If any flags Reset, then output buffer. */
     3442    20374    2     LEN = POFFC(DEST2$,OUTBUFF2$) ;
     3443    20375    2     IF LEN>(SIZEC('Reset:')+TAB_VAL)
     3444    20376    2         THEN
     3445    20377    3             DO ;
     3446    20378    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = LEN-2 ;
     3447    20379    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF2$ ;
     3448    20380    3               CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;
     3449    20381    3             END ; /* Then Do */
     3450    20382
     3451    20383    2   DISPNOTIFY_RET:
     3452    20384    2     RETURN ;
     3453    20385
     3454    20386    2   DISPNOTIFY_ERR:
     3455    20387    2     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#
     3456    20388    2         THEN
     3457    20389    2             CALL M$CLOSE(FPT_CLOSE) ALTRET(DISPNOTIFY_ALT) ;
     3458    20390
     3459    20391    2   DISPNOTIFY_ALT:
     3460    20392    2     ALTRETURN ;
     3461    20393
     3462    20394    2   END   DISPNOTIFY ;
     3463    20395        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:110  
     3464    20396        /**********************************************************************/
     3465    20397        /*I*   NAME:   DISPWHEN
     3466    20398               PURPOSE: Display the WHEN command record from the *S file.
     3467    20399               CALL:   CALL DISPWHEN
     3468    20400               INTERFACE: CPC$WRITEMSGE,CPE$LISTOUT,CPB$BLDIMAGE,CPJ$READ_S, CPC$OPEN_S
     3469    20401               INPUT:
     3470    20402               OUTPUT: The WHEN command from the *S WHEN record.
     3471    20403               DESCRIPTION: The WHEN command in the *S WHEN record is displayed
     3472    20404                       on the listing device.
     3473    20405        */
     3474    20406        /**********************************************************************/
     3475    20407    1   DISPWHEN: PROC ALTRET ;
     3476    20408
     3477    20409    2     INBUFF = '   When: %Q' ;
     3478    20410    2     F_FDS = CF_FDS ;
     3479    20411    2     F_FDS.OUTPUT# = ENTADDR(CPK$FDS_OUTPUT) ;
     3480    20412    2     F_FDS.VECTR$ = ADDR(FMT_VEC(0)) ;
     3481    20413    2     F_FDS.BUF_ = VECTOR(OUTBUFF) ;
     3482    20414    2     F_FDS.FMT_ = VECTOR(INBUFF) ;
     3483    20415    2     FMT_VEC = '0'B ;
     3484    20416    2     OUTBUFF = ' ' ;
     3485    20417    2     CALL CPC$OPEN_LL ;
     3486    20418    2     IF B$JIT.CPFLAGS1.WHEN_INPUT
     3487    20419    2         THEN
     3488    20420    3             DO ;
     3489    20421    3               FPT_CLOSE = CFPT_CLOSE;
     3490    20422    3               FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);
     3491    20423    3               FPT_CLOSE.V.DISP# = %SAVE# ;
     3492    20424    3               FPT_CLOSE.V.DCB# = M$IBEX1_NUM ;
     3493    20425    3               CALL CPG$GET_WHEN_CNTL_REC(WHEN_CNTL_REC_CHANGED, STAR_S_IS_OPEN)
     3494    20426    3                                                            ALTRET(DISPWHEN_ALT) ;
     3495    20427    3               IF SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(SEG$2.WHEN_CNTL_REC$
     3496    20428    3                                          ->WHEN$CNTL_REC.STATE_LEV) = %WHEN_DONT#
     3497    20429    3                 OR SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(SEG$2.WHEN_CNTL_REC$
     3498    20430    3                                          ->WHEN$CNTL_REC.STATE_LEV) = %WHEN_NONE#
     3499    20431    3                 THEN
     3500    20432    4                   DO ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:111  
     3501    20433    4                     IF STAR_S_IS_OPEN
     3502    20434    4                       THEN
     3503    20435    5                         CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;
     3504    20436    5                                                               END ;
     3505    20437    4                     GOTO WHEN_NONE ;
     3506    20438    4                   END ; /* Then Do */
     3507    20439    3               F_FDS.NVECS# = 0 ;
     3508    20440    3               CALL X$FORMAT(F_FDS) ;
     3509    20441    3               K_WHEN = CK_WHEN ;
     3510    20442    3               K_WHEN.NUM = SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV ;
     3511    20443    3               IF ~STAR_S_IS_OPEN
     3512    20444    3                 THEN
     3513    20445    3                   CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(DISPWHEN_ALT);
     3514    20446    3               CALL CPJ$READ_S (M$IBEX1_NUM,VECTOR(K_WHEN),
     3515    20447    3                           VECTOR(SEG$2.CPBUFF$->CP$BUFF)) ALTRET(DISPWHEN_ALT) ;
     3516    20448    3               TEMP = DCBADDR(M$IBEX1_NUM) -> F$DCB.ARS# ;
     3517    20449    3               TVAL = DCBADDR(SEG$2.LLDCB#) -> F$DCB.WIDTH# ;
     3518    20450    3               IF TVAL ~= 0
     3519    20451    3                 THEN
     3520    20452    3                   F_FDS.BUF_ = VECTOR(SUBSTR(OUTBUFF,0,TVAL-1)) ;
     3521    20453    4               CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;
     3522    20454    4                                                   END ;
     3523    20455    3               FMT_VEC(0) = VECTOR(SEG$2.CPBUFF$->CP$BUFF) ;
     3524    20456    3               F_FDS.NVECS# = 1 ;
     3525    20457    3               INBUFF = '     %>A%Q' ;
     3526    20458    3             END ; /* Then Do */
     3527    20459    2         ELSE
     3528    20460    3             DO ;
     3529    20461    3   WHEN_NONE:
     3530    20462    3               F_FDS.NVECS# = 0 ;
     3531    20463    3               CALL INSERT(INBUFF, 9, , 'none%Q') ;
     3532    20464    3             END ; /* Else Do */
     3533    20465    2     CALL X$FORMAT(F_FDS) ;
     3534    20466    2     RETURN ;
     3535    20467
     3536    20468    2   DISPWHEN_ALT:
     3537    20469    3     CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:112  
     3538    20470    3                                           END ;
     3539    20471    2     ALTRETURN ;
     3540    20472
     3541    20473    2   END   DISPWHEN ;
     3542    20474        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:113  
     3543    20475    1   FIND_OR_CREATE_STREAM: PROC(RES#, CREATE_FLG, DCB#, OPEN_FLG) ALTRET;
     3544    20476        /*
     3545    20477            FIND_OR_CREATE_STREAM will first try to locate a DCB directed to that
     3546    20478              stream.  If it locates a DCB that is open it returns the DCB# to the
     3547    20479              calling routine (OPEN_FLG has been reset, this routine did not open
     3548    20480              the DCB).  If it locates a DCB that is not open, it opens the DCB to
     3549    20481              the stream, sets OPEN_FLG, and returns the DCB# to calling routine.
     3550    20482              If it does not locate a DCB, it will look to see if the CREATE_FLG is
     3551    20483              set.  If it is not, FIND_OR_CREATE_STREAM will ALTRETURN.  Otherwise,
     3552    20484              FIND_AND_CREATE_STREAM will open the DCB with res=RES#, set OPEN_FLG,
     3553    20485              and return the DCB# to the calling routine.
     3554    20486
     3555    20487              If RES# is just a 2 character device name, ie 'UC, then the CREATE_FLG
     3556    20488              is ignored.
     3557    20489        */
     3558    20490        /*
     3559    20491          *** Parameters
     3560    20492        */
     3561    20493    2   DCL RES# CHAR(4);
     3562    20494    2   DCL 1 RES#_R REDEF RES#,
     3563    20495    2         2 DEV CHAR(2),
     3564    20496    2         2 NUM CHAR(2);
     3565    20497    2   DCL CREATE_FLG BIT(1) ALIGNED;
     3566    20498    2   DCL DCB# UBIN WORD;
     3567    20499    2   DCL OPEN_FLG BIT(1) ALIGNED;
     3568    20500
     3569    20501        /*
     3570    20502          *** Auto
     3571    20503        */
     3572    20504    2   DCL I UBIN WORD ;
     3573    20505    2   DCL K UBIN ;
     3574    20506    2   DCL GOT_STREAM BIT(1);
     3575    20507    2   DCL IGNORE_CREATE_FLG BIT(1);
     3576    20508    2   DCL DCBTAB$ PTR ;
     3577    20509    2   DCL DCB$ PTR;
     3578    20510        %FPT_OPEN(FPTN=OPNDCB,STCLASS=);
     3579    20619        /*
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:114  
     3580    20620          *** Constant
     3581    20621        */
     3582    20622        %FPT_OPEN(FPTN=CONSTOPN,STCLASS=CONSTANT,ASN=DEVICE,FUN=CREATE);
     3583    20731        /**/
     3584    20732    2           OPEN_FLG = %NO# ;
     3585    20733    2           GOT_STREAM = %NO#;
     3586    20734    2           DCBTAB$ = B$ROS$->B$ROSEG.DCBPTR$ ;
     3587    20735    2           K = B$ROS$->B$ROSEG.NUMDCBS ;
     3588    20736    2           IF RES#_R.NUM = ' '
     3589    20737    2           THEN
     3590    20738    2             IGNORE_CREATE_FLG = %YES#;
     3591    20739    2           ELSE
     3592    20740    2             IGNORE_CREATE_FLG = %NO#;
     3593    20741        /*
     3594    20742              First look for a dcb open to the specified stream,
     3595    20743              failing locating one, open a dcb to that stream.
     3596    20744        */
     3597    20745    3           DO I=2 TO K-1 ;
     3598    20746    3             IF DCBADDR(I)~=ADDR(NIL)
     3599    20747    3             THEN
     3600    20748    4               DO;
     3601    20749    4                 DCB$ = DCBADDR(I);
     3602    20750    4                 IF B$ROS$->B$ROSEG.LDEVNAME(DCBADDR(I)->F$DCB.STR#) = RES# OR DCBADDR(
             20750                          I)->F$DCB.RES# = RES#
     3603    20751    4                 THEN
     3604    20752    5                   DO;
     3605    20753    5                     GOT_STREAM = %YES#;
     3606    20754    5                     DCB# = I;
     3607    20755    5                   END; /* Then Do */
     3608    20756    4                 IF DCBADDR(I)->F$DCB.FCD# AND GOT_STREAM
     3609    20757    4                 THEN
     3610    20758    4                   RETURN ;
     3611    20759    4               END; /* Then Do */
     3612    20760    3               IF GOT_STREAM
     3613    20761    3                 THEN
     3614    20762    3                   I = K;  /* Get out of this loop */
     3615    20763    3           END ;                        /* Do I                               */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:115  
     3616    20764        /*
     3617    20765              No dcb open to this stream.  If we didn't find a dcb see if there
     3618    20766              is an LDEV defined.
     3619    20767        */
     3620    20768    2           IF NOT GOT_STREAM
     3621    20769    2             THEN
     3622    20770    3               DO I = 0 TO 15;
     3623    20771    3                 IF B$ROS$->B$ROSEG.LDEVNAME(I) = RES#
     3624    20772    3                   THEN
     3625    20773    3                     IGNORE_CREATE_FLG = %YES#;
     3626    20774    3               END; /* Do I */
     3627    20775        /*
     3628    20776              If we do not have a stream, and we can not create one, then ALTRETURN.
     3629    20777        */
     3630    20778    2           IF NOT (GOT_STREAM OR IGNORE_CREATE_FLG OR CREATE_FLG)
     3631    20779    2           THEN /* We don't have one, and we are not allowed to create one. */
     3632    20780    2             ALTRETURN;
     3633    20781    2           OPNDCB = CONSTOPN;
     3634    20782    2           OPNDCB.V_ = VECTOR(OPNDCB.V) ;
     3635    20783    2           IF NOT GOT_STREAM
     3636    20784    2           THEN   /* Need to use M$IBEX */
     3637    20785    2             DCB# = M$IBEX1_NUM ;
     3638    20786    2           IF DCBADDR(DCB#)->F$DCB.FCD#
     3639    20787    2             THEN
     3640    20788    2               CALL CLOSE_DCB(DCB#);
     3641    20789    2           OPNDCB.V.DCB# = DCB#;
     3642    20790    2           OPNDCB.V.RES# = RES#;
     3643    20791    2           OPNDCB.V.ASN# = %DEVICE# ;
     3644    20792    3           CALL M$OPEN(OPNDCB) WHENALTRETURN DO;
     3645    20793    3                                  ALTRETURN;
     3646    20794    3                                 END;
     3647    20795    2           OPEN_FLG = %YES# ;
     3648    20796    2           RETURN ;
     3649    20797
     3650    20798    2   END   FIND_OR_CREATE_STREAM;
     3651    20799        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:116  
     3652    20800    1   CLOSE_DCB: PROC(DCB#) ;
     3653    20801
     3654    20802        /*
     3655    20803          *** Parameters
     3656    20804        */
     3657    20805    2   DCL DCB# UBIN WORD;
     3658    20806        /*
     3659    20807          *** Auto
     3660    20808        */
     3661    20809        %FPT_CLOSE(FPTN=CLSDCB,STCLASS=);
     3662    20851        /*
     3663    20852          *** Constant
     3664    20853        */
     3665    20854        %FPT_CLOSE(FPTN=CONSTCLS,STCLASS=CONSTANT,DISP=SAVE);
     3666    20896
     3667    20897    2           CLSDCB=CONSTCLS;
     3668    20898    2           CLSDCB.V.DCB#=DCB#;
     3669    20899    2           CLSDCB.V_=VECTOR(CLSDCB.V);
     3670    20900    3           CALL M$CLOSE(CLSDCB) WHENALTRETURN DO;
     3671    20901    3                                  END ;
     3672    20902    2           RETURN ;
     3673    20903    2   END   CLOSE_DCB ;
     3674    20904    1   END CPE$IBEX2;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:117  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CX_MACROS_M.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPE$IBEX2.

   Procedure CPE$IBEX2 requires 8068 words for executable code.
   Procedure CPE$IBEX2 requires 1320 words of local(AUTO) storage.

    No errors detected in file CPE$IBEX2.:E05TSI    .

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:118  

 Object Unit name= CPE$IBEX2                                  File name= CPE$IBEX2.:E05TOU
 UTS= JUL 29 '97 11:35:04.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    946   1662  CPE$IBEX2
    2   Proc  even  none  8068  17604  CPE$IBEX2
    3  RoData even  none   293    445  CPE$IBEX2

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  CPE$IBEX2
     2      3          yes     yes      Std        1  CPE$COMMENT
     2    101          yes     yes      Std        1  CPE$DISPLAY
     2    660          yes     yes      Std        1  CPE$DONT
     2   1210          yes     yes      Std        1  CPE$ECHO
     2   1216          yes     yes      Std        1  CPE$EJECT
     2   1410          yes     yes      Std        1  CPE$EXPOUND
     2   1416          yes     yes      Std        1  CPE$LIST
     2   1510          yes     yes      Std        1  CPE$PASSWORD
     2   1734          yes     yes      Std        1  CPE$POINT
     2   1742          yes     yes      Std        1  CPE$POSITION
     2   1750          yes     yes      Std        1  CPE$PROTECT
     2   1756          yes     yes      Std        1  CPE$TIME
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:119  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       1 CPF$SWITCH
 yes     yes           Std       1 CPF$PROFILE
         yes           Std       3 CPE$RZEROS
         yes           Std       1 CPC$RELSEG
 yes     yes           Std       0 CPF$PPRIV
 yes     yes           Std       1 CPB$PLATEN
 yes     yes           Std       5 CPE$GENRUAM
         yes           Std       1 CPE$RFEXT
         yes           Std       5 CXP$POSTERR
 yes     yes           Std       1 CPF$TERMINAL
 yes     yes           Std       1 CPF$PRIV
 yes     yes           Std       1 CPC$WRHLP
 yes     yes           Std       1 CPF$DIPROFILES
 yes     yes           Std       2 CPG$GET_WHEN_CNTL_REC
 yes     yes           Std       1 CPI$DIRECTORY
 yes     yes           Std       5 CPB$BLDIMAGE
 yes     yes           Std       1 CPI$TABS
 yes     yes           Std       1 CPE$LISTOUT
 yes     yes           Std       1 CPJ$LIMIT
 yes     yes           Std       1 CPG$LET
         yes           Std       6 CPC$WRITEMSGE
 yes     yes           Std       1 CPO$ORES
 yes     yes           Std       1 CPI$PRIORITY
 yes     yes           Std       2 CPC$RDHLP
 yes     yes           Std       1 CPH$GLOBAL
         yes           Std       3 CXC$READAM
         yes           Std       0 CPC$OPEN_LL
 yes     yes           Std       2 CPI$SETUP
         yes           Std       1 ASZ$SCRAMBLE
 yes     yes           Std       1 CPB$REPORT
 yes     yes           Std       1 CPG$PUT_WHEN_CNTL_REC
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:120  
         yes           Std       1 CXB$CHKFORT
 yes     yes           Std       2 CPC$GETSEG
         yes           Std       2 CPC$SCREECH
 yes     yes           Std       0 CPG$SET_WHEN_STATE
 yes     yes           Std       2 XSF$LOCCODE
 yes     yes           Std       1 CPC$OPEN_S
 yes     yes           Std       3 CPJ$READ_S
 yes     yes           Std       2 CPK$FDS_OUTPUT
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CFPT_TIME                             CFPT_DISPLAY
     CFPT_OPEN                             CFPT_CLOSE                            CFPT_READ
     CFPT_WRITE                            CFPT_UNFID                            CFPT_TRMISC
     CFPT_DEVICE                           CFPT_DRIBBLE                     r    SEG2$
r    SEG3$                            r    B$JIT$                           r    B$ROS$
r    B$TCB$                                M$UC_NUM                              M$IBEX1_NUM
     STARA                                 K_NOTIFY                              LISTDCB
r    B$SR_NON_BLANK$                       B$ROS$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:121  


        1        1        /*M* COMMENT, DISPLAY, DONT, ECHO, LIST, PASSWORD, PROTECT, TIME cmds */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DFC   */
        8        8        /*P*   NAME:   CPE$IBEX2
        9        9               PURPOSE:  To perform the required operations in the execution of
       10       10                       selected IBEX commands.
       11       11               DESCRIPTION;
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:122  
       16       16        CPE$IBEX2:
       17       17          PROC(P$PCB) ALTRET;

     17  2 000000   000000 700200 xent  CPE$IBEX2    TSX0  ! X66_AUTO_1
         2 000001   002450 000001                    ZERO    1320,1
         2 000002   000005 710000 2                  TRA     s:16599

       18       18                   %INCLUDE CP_6;
       19       99                   %INCLUDE B$JIT;
       20      389                   %INCLUDE B$ROSEG ;
       21      452                   %INCLUDE B_STRINGS_C;
       22      581                   %INCLUDE B_MACROS_C;
       23      692                   %INCLUDE B$TABLES_C;
       24      800                   %INCLUDE CP_MACROS_C;
       25     1552                   %INCLUDE CX_MACROS_M;
       26     1603                   %INCLUDE XU_MACRO_C;
       27     4709                   %INCLUDE XU_FORMAT_C;
       28     4871                   %INCLUDE FM$MACROS;
       29     5246                   %INCLUDE CP_SUBS_C;
       30     6163                 %INCLUDE CP_PERR_C;
       31     6501                   %INCLUDE CP_6_SUBS;
       32     7041                 %INCLUDE B_ERRORS_C;
       33     8168                   %INCLUDE AS_SUPER_C;
       34     8603                  %INCLUDE CP_DATA_R;
       35    11166                   %INCLUDE KL_SUPER_C;
       36    14068                   %INCLUDE B_MICROPS_C;
       37    14240                   %INCLUDE NK_VFC_C;
       38    14314    1   DCL BLK$ PTR;                           /*Parse output block ptr*/
       39    14315    1   DCL ONOVERINTO$ PTR;                    /*Ptr to on/over/into*/
       40    14316    1   DCL FID$ PTR;                           /*Ptr to fid name*/
       41    14317    1   DCL DCB# UBIN WORD;
       42    14318    1   DCL DCB$ PTR;                           /*Ptr to dcb name*/
       43    14319    1   DCL TEMP$ PTR;                          /*Temporary ptr*/
       44    14320    1   DCL TEMP1$ PTR;                                  /*Temp pointer*/
       45    14321    1   DCL TVAL SBIN(36) ALIGNED;                       /*Temp. Location*/
       46    14322    1   DCL TEMP UBIN(36) ALIGNED;                       /*Temp. Location*/
       47    14323    1   DCL 1 TEMPO REDEF TEMP,
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:123  
       48    14324    1         2 REST UBIN(33) UNAL,
       49    14325    1         2 LSD UBIN(3) UNAL ;
       50    14326    1   DCL IND1 UBIN;
       51    14327    1   DCL CONTAB CHAR(0) CONSTANT INIT('012345678') ;
       52    14328    1   DCL DCBSLOT UBIN;
       53    14329    1   DCL STREAM_OPEN BIT(1);
       54    14330    1   DCL RES# CHAR(4);
       55    14331    1   DCL LDEVHDR CONSTANT CHAR(0) INIT('   Ldev assignments:');
       56    14332    1   DCL LDEVNHDR CONSTANT CHAR(0) INIT('   Ldev assignments: none');
       57    14333    1   DCL LDEVS_EXIST BIT(1) UNAL;                     /*LDEVs exist flag*/
       58    14334    1   DCL LDEVS_HDR_PRINTED BIT(1) UNAL ;
       59    14335    1   DCL DILDEV_OPT BIT(1) UNAL ;
       60    14336    1   DCL WHEN_CNTL_REC_CHANGED BIT(1) ;
       61    14337    1   DCL STAR_S_IS_OPEN BIT(1) ;
       62    14338    1   DCL BUF_ BIT(72) DALIGNED;                       /*Vector framing buffer*/
       63    14339    1   DCL OLDPASSWORD CHAR(8) ALIGNED;                         /*Old password*/
       64    14340    1   DCL NEWPASSWORD CHAR(8) ALIGNED;                         /*New password*/
       65    14341    1   DCL IN$ PTR;                                     /*Input buffer ptr*/
       66    14342    1   DCL DEST$ PTR;                                   /*Output buffer ptr*/
       67    14343    1   DCL OUTBUFF$ PTR;                                /*Output buffer ptr*/
       68    14344    1   DCL INBUFF CHAR(512);
       69    14345    1   DCL OUTBUFF CHAR(512);
       70    14346    1   DCL 1 DCB_NAME DALIGNED,                         /*Dcb name*/
       71    14347    1          2 COUNT UBIN(9) UNAL,
       72    14348    1          2 TEXT CHAR(31) UNAL;
       73    14349    1   DCL DCB_NAMEA(0:31) REDEF DCB_NAME CHAR(1);
       74    14350    1   DCL UNFID CHAR (64) AUTO;
       75    14351    1   DCL ASN UBIN WORD;
       76    14352    1   DCL RES CHAR(4);
       77    14353    1   DCL I UBIN(36) ALIGNED;                 /*Temp. Loc. For indexes*/
       78    14354    1   DCL J UBIN(36) ALIGNED;                 /*Temp. Loc. For indexes*/
       79    14355    1   DCL TAB_VAL SBIN WORD;                           /*Tab value for printing*/
       80    14356    1   DCL CPOS UBIN WORD AUTO;     /* Only for use for CXP$POSTERR */
       81    14357    1   DCL LEN SBIN(36) ALIGNED;
       82    14358    1   DCL 1 VARY$STRNG BASED,
       83    14359    1          2 TEXT CHAR(LEN);
       84    14360    1   DCL 1 M$DODCB CONSTANT DALIGNED,
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:124  
       85    14361    1          2 CNT UBIN(9) INIT(4) UNAL,
       86    14362    1          2 TXT CHAR(4) INIT('M$DO');
       87    14363    1   DCL 1 TMDATE,
       88    14364    1          2 * CHAR(3),
       89    14365    1          2 DATE CHAR(10),
       90    14366    1          2 * CHAR(2),
       91    14367    1          2 TIME,
       92    14368    1             3 HR CHAR(3),
       93    14369    1             3 MIN CHAR(2),
       94    14370    1             3 SEC CHAR(3),
       95    14371    1             3 MSEC CHAR(3);
       96    14372    1   DCL TMDATEBUFF REDEF TMDATE CHAR(26);
       97    14373    1   DCL SYSID CHAR(6);
       98    14374    1   DCL ACTIVE_PRIVS BIT(36) ;
       99    14375    1   DCL 1 BAD_LDEV_NAME,
      100    14376    1         2 SIZ UBIN BYTE UNAL,
      101    14377    1         2 TEXT CHAR(4) CALIGNED;
      102    14378        /*
      103    14379          **** THIS VALUE REFLECTS THE SIZE OF OPT_TBL-1
      104    14380          **** MUST BE CHANGED WHENEVER OPT_TBL CHANGES IN SIZE
      105    14381        */
      106    14382    1   DCL OPT_TBLSZE SBIN WORD CONSTANT INIT(46);
      107    14383    1   DCL 1 OPT_TBL(0:46) CONSTANT ALIGNED,     /*DCB DISPLAY OPTION TABLE*/
      108    14384    1         2 LEN UBIN BYTE UNAL INIT
      109    14385    1           (7,7,6,2,7,7,6,6,5,7,8,9,6,5,7,8,4,7,11,7,6,3,4,4,5,4,3,5,4,
      110    14386    1            9,10,6,5,10,5,7,3,10,6,7,7,8,7,7,9,7,13),
      111    14387    1         2 HDR CHAR(14) UNAL INIT
      112    14388    1           ('AllDCBs','AllTrms','AnyDCB','AU','DirOnly','EOFNone',
      113    14389    1            'EOFOne','ILatch','ILock','IMsgTyp','IStation',
      114    14390    1            'MyStation','OLatch','OLock','OMsgTyp','OStation',
      115    14391    1            'QISS','Blocked','ANSISpanSeq','Spanned','EBCDIC','Ctg',
      116    14392    1            'Comp','CVol','Xtend','BUpM','Seq','Cnvrt','Load',
      117    14393    1            'DcbConLgl', 'JrnlBypass', 'LStaOR', 'Scrub', 'TermConLgl',
      118    14394    1            'Debug', 'LdByPro', 'WAS', 'Initialize', 'NoFile',
      119    14395    1            'BtmBrdr', 'LftBrdr', 'Optional', 'Rhtbrdr', 'TopBrdr',
      120    14396    1            'IgnoreFsn', 'IoErrOk', 'SeedSpecified'),
      121    14397    1         2 OPTION UBIN BYTE UNAL INIT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:125  
      122    14398    1            (ALLDCBSOPT,ALLTRMSOPT,ANYDCBOPT,AUOPT,DIRONLYOPT,
      123    14399    1             EOFNONEOPT,EOFONEOPT,ILATCHOPT,ILOCKOPT,IMSGTYPOPT,
      124    14400    1             ISTATIONOPT,MYSTATIONOPT,OLATCHOPT,OLOCKOPT,OMSGTYPOPT,
      125    14401    1             OSTATIONOPT,QISSOPT,BLOCKEDOPT,ANSISPANSEQOPT,SPANNEDOPT,
      126    14402    1             EBCDICOPT,CTGOPT,COMPOPT,CVOLOPT,XTENDOPT,BUPMOPT,SEQOPT,
      127    14403    1             CNVRTOPT,LOADOPT,DCBCONLGLOPT,JRNLBYPASSOPT,LSTAOROPT,
      128    14404    1             SCRUBOPT,TERMCONLGLOPT,DEBUGOPT,LDBYPROOPT,WASOPT,
      129    14405    1             INITIALIZEOPT,NOFILEOPT,BTMBRDROPT,LFTBRDROPT,
      130    14406    1             OPTIONALOPT,RHTBRDROPT,TOPBRDROPT,IGNOREFSNOPT,
      131    14407    1             IOERROKOPT,SEEDOPT);
      132    14408        %F_FDS (  NAME = CF_FDS,
      133    14409                  STCLASS = CONSTANT,
      134    14410                  TRUNC = NO,
      135    14411                  DVFC = %VFC_TRANSITION1,
      136    14412                  WRAPTAB = 6) ;
      137    14525        %F_FDS (  NAME = F_FDS,
      138    14526                  STCLASS = AUTO) ;
      139    14639    1   DCL FMT_VEC(0:23) BIT(72) ;
      140    14640        /***** External routines *****/
      141    14641    1   DCL MSGFLAG BIT(1) UNAL;                         /*Message flag*/
      142    14642    1   DCL CPB$OPENCS ENTRY;
      143    14643    1   DCL CPB$REPORT ENTRY(1) ALTRET;
      144    14644    1   DCL CPC$WRITEMSGE ENTRY(6);
      145    14645    1   DCL CPC$GETSEG ENTRY(2) ALTRET;                  /*Get segment for buffer*/
      146    14646    1   DCL CPC$OPEN_LL ENTRY ;
      147    14647        %FPT_DRIBBLE(FPTN=FPT_DRIBBLE,STCLASS=AUTO);
      148    14658    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
      149    14659    1   DCL CPC$RDHLP ENTRY(2) ALTRET;
      150    14660    1   DCL CPC$RELSEG ENTRY(1);
      151    14661    1   DCL CPC$WRHLP ENTRY(1) ALTRET;
      152    14662    1   DCL CPE$RFEXT ENTRY(1);                 /*Reset file extension*/
      153    14663    1   DCL CPE$GENRUAM ENTRY(5) ALTRET;        /*Gen ru assign merge*/
      154    14664    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;                 /*List buff contents*/
      155    14665    1   DCL CXC$READAM ENTRY(3) ;
      156    14666    1   DCL CPE$RZEROS ENTRY(3);                         /*Remove leading zeros*/
      157    14667    1   DCL CPB$BLDIMAGE ENTRY(5) ALTRET;                /*Build print image*/
      158    14668    1   DCL CPF$SWITCH ENTRY(1) ALTRET;                  /*Display sense switches*/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:126  
      159    14669    1   DCL CPI$TABS ENTRY(1) ALTRET;                    /*Display tabs*/
      160    14670    1   DCL CPI$DIRECTORY ENTRY(1) ALTRET;               /*Display directory*/
      161    14671    1   DCL CPI$SETUP ENTRY(2) ALTRET;                   /*Display setup*/
      162    14672    1   DCL CPJ$LIMIT ENTRY(1) ALTRET;                   /*Display limits*/
      163    14673    1   DCL CPJ$READ_S ENTRY(3) ALTRET;
      164    14674    1   DCL CPO$ORES ENTRY(1) ALTRET;                     /* Di resource */
      165    14675    1   DCL CPH$GLOBAL ENTRY(1) ALTRET;                  /*Display globals*/
      166    14676    1   DCL CPG$LET ENTRY(1) ALTRET;                     /*Display com vars */
      167    14677    1   DCL CPG$GET_WHEN_CNTL_REC ENTRY(2) ALTRET;
      168    14678    1   DCL CPG$PUT_WHEN_CNTL_REC ENTRY(1) ALTRET;
      169    14679    1   DCL CPG$SET_WHEN_STATE ENTRY ALTRET;
      170    14680    1   DCL CPB$PLATEN ENTRY(1) ALTRET;                  /*Display platen*/
      171    14681    1   DCL CXB$CHKFORT ENTRY(1);                        /*Cnvrt if fort dcb number*/
      172    14682    1   DCL CPF$TERMINAL ENTRY(1) ALTRET;                      /*Display terminal chrstcs*/
      173    14683    1   DCL CPF$PPRIV  ENTRY ALTRET;                    /*Display proc privileges*/
      174    14684    1   DCL CPF$PRIV ENTRY(1) ALTRET;                    /*Display user privileges*/
      175    14685    1   DCL CPF$PROFILE ENTRY(1) ALTRET;                /*Display profiles*/
      176    14686    1   DCL CPF$DIPROFILES ENTRY(1) ALTRET;            /*Display all profiles*/
      177    14687    1   DCL CPI$PRIORITY ENTRY(1) ALTRET;               /*Display priority*/
      178    14688    1   DCL CPK$FDS_OUTPUT ENTRY(2) ALTRET;             /*Output routine for X$FORMAT*/
      179    14689    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
      180    14690    1   DCL CPC$SCREECH ENTRY(2);
      181    14691    1   DCL ASZ$SCRAMBLE ENTRY(1);
      182    14692    1   DCL CXP$POSTERR ENTRY(5);
      183    14693    1   DCL X$FORMAT ENTRY(1) ;
      184    14694        %SUB IBEX_CODE14 ="14 /*IBEX_CODE14*/";
      185    14695        /***** Auto Structures *****/
      186    14696        %AS_USERS(STR_NAME=AS_USERS,STCLASS=AUTO);
      187    14874        %VLR_DISPLAY (FPTN=LOAD_VAR,STCLASS=AUTO);
      188    14888        %K_WHEN (NAME=K_WHEN,STCLASS=AUTO) ;
      189    14906        %K_WHEN (NAME=CK_WHEN, STCLASS=CONSTANT) ;
      190    14924        /***** Based structures *****/
      191    14925        %TEXTC;
      192    14930        %CP$BUFF (NAME=CP$BUFF,STCLASS=BASED) ;
      193    14933        %B$EXCFR;
      194    14951        %B$TCB (STCLASS="BASED(B$TCB$)");
      195    14954        %SEG$2;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:127  
      196    15014        %F$DCB (DCBN=F$DCB);
      197    15071        %AS_USERS (STR_NAME=AS$USERS,STCLASS=BASED);
      198    15249        %VLP_NAME(FPTN=AM$NAME,LEN=31,STCLASS=BASED);
      199    15276        %VLP_ACCT(FPTN=AM$ACCT,STCLASS=BASED);
      200    15289        %VLP_SN(FPTN=AM$SN,STCLASS=BASED,N=50);
      201    15302        %VLP_WSN(FPTN=AM$WSN,STCLASS=BASED);
      202    15315        %VLP_SETSTA(FPTN=AM$SETSTA,STCLASS=BASED);
      203    15343        %VLP_VIRTUAL(FPTN=AM$VIRTUAL,STCLASS=BASED);
      204    15363        %VLP_WINDOW(FPTN=AM$WINDOW,STCLASS=BASED);
      205    15407        %VLP_FPRG(FPTN=AM$FPRG,STCLASS=BASED);
      206    15428        %VLP_ALTKEYS(FPTN=AM$ALTKEYS,STCLASS=BASED);
      207    15443        %FM$FIT;
      208    15446        %CODE14;
      209    15456        %KL_DREC(NAME=KL$DREC,STCLASS=BASED,LAST=",");
      210    15569        %KL_FEBLK(NAME=KL$FEBLK,RCNT=31,LVL=2) ;
      211    15618        %PLIST;
      212    15619        %B$SR_NON_BLANK (NAME=SRCHTBL);
      213    15623        %PARSE$OUT (NAME=P$B);
      214    15668        %PARSE$SYM (NAME=P$S);
      215    15706        %P$PCB(NAME=P$PCB,STCLASS="");
      216    15907        %ERR_BLK (NAME=ERR$BLK,STCLASS=BASED);
      217    15932        %WHEN_CNTL_REC (NAME=WHEN$CNTL_REC,STCLASS=BASED);
      218    15953        %CPSL_COMMAND_PARAMETERS (NAME=CPSL_PARAM, STCLASS=AUTO) ;
      219    15971        /*         Fpts                                  */
      220    15972        %FPT_TIME (FPTN=FPT_TIME,STCLASS=AUTO);
      221    15991        %FPT_CLOSE(FPTN=FPT_CLOSE,STCLASS=AUTO);
      222    16033        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED);
      223    16064        %FPT_DISPLAY(FPTN=FPT_DISPLAY,STCLASS=AUTO);
      224    16077        %FPT_DEVICE(FPTN=FPT_DEVICE,STCLASS=AUTO);
      225    16095        %FPT_OPEN(FPTN=AMR$REC$,STCLASS="BASED(SEG3$)",PFMT="PTR");
      226    16204        %FPT_OPEN(FPTN=FPT_OPEN,STCLASS=AUTO);
      227    16313        %FPT_READ(FPTN=FPT_READ,STCLASS=AUTO);
      228    16352        %FPT_TRMISC(FPTN=FPT_TRMISC,STCLASS=AUTO);
      229    16373        %VLP_SN (FPTN=VLP_SN, STCLASS=AUTO, N=1);
      230    16386          /***** Error codes *****/
      231    16387        %ERR_CODE (NAME=E_BADPASS,MID#=CPE$IBEXMID,CODE#=E$BADPASS,STCLASS=CONSTANT);
      232    16407        %ERR_CODE (NAME=E_QUIT,MID#=CPE$IBEXMID,CODE#=E$QUIT,SEV#=SEV1,STCLASS=CONSTANT);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:128  
      233    16427        %ERR_CODE (NAME=E_NOASGN,MID#=CPE$IBEXMID,CODE#=E$NOASGN,STCLASS=CONSTANT);
      234    16447        %ERR_CODE (NAME=E_PASSCHNGE,MID#=CPE$IBEXMID,CODE#=E$PASSCHNGE,STCLASS=CONSTANT);
      235    16467        %VLP_ERRCODE (FPTN=E_NOSUCHLDEV,MID=E,ERR#=E$NOSUCHLDEV,FCG=CP,STCLASS=CONSTANT);
      236    16512        /*E*    ERROR: CPE-E$NOSUCHLDEV-C
      237    16513                MESSAGE: LDEV %%U1 %not set.
      238    16514        */
      239    16515        %VLP_ERRCODE (FPTN=E_NOLDEVTHATTYPE,MID=E,ERR#=E$NOLDEVTHATTYPE,FCG=CP,STCLASS=
             16515            CONSTANT);
      240    16560        /*E*    ERROR: CPE-E$NOLDEVTHATTYPE-C
      241    16561                MESSAGE: No LDEVs of %%U1 %type set.
      242    16562        */
      243    16563                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:129  
      244    16564        /**********************************************************************/
      245    16565        /*F*   NAME:   CPE$COMMENT
      246    16566               PURPOSE: The COMMENT command is utilized by a user to direct the
      247    16567                       destination of error commentary before calling a processor.
      248    16568                       It is also used to turn on error commentary which was
      249    16569                       previously interrupted and turned off by the DONT COMMENT
      250    16570                       command.
      251    16571               DESCRIPTION: If ON/OVER/INTO comout is specified, an assignment is
      252    16572                       made for commentary to go to the specified file,device, or
      253    16573                       device stream. If only the reinitiating of commentary is
      254    16574                       desired, which occurs when only the COMMENT command is
      255    16575                       specified, the COMMENT flag is turned on. By default,
      256    16576                       commentary is always turned on at job step beginning.
      257    16577        */
      258    16578        /*D*   NAME:   CPE$COMMENT
      259    16579               CALL:   CALL CPE$COMMENT(P$PCB)
      260    16580               INTERFACE: CPE$GENRUAM,CPE$RFEXT,CPC$WRITEMSGE
      261    16581               INPUT:  BLK$ - pointer to parsed output
      262    16582               OUTPUT: *A file - keyed assign merge record for the M$DO dcb
      263    16583                       B$JIT.FEXT - file extension bit reset for commentary
      264    16584                       B$JIT.PRFLAGS.LIST - flag set indicating commentary
      265    16585               DESCRIPTION: If COMMENT only is specified, commentary is reinitiated
      266    16586                       by turning on the comment flag in the JIT. If ON/OVER/INTO
      267    16587                       comout is specified, a check is made to determine whether
      268    16588                       the command is being executed at job step. An assign merge
      269    16589                       record is generated with destination information specified by
      270    16590                       comout. The key associated with the record is m$do.Since
      271    16591                       this is a new assignment, file extension is reset for m$do.
      272    16592                       Flags are set in the JIT to reflect that the COMMENT
      273    16593                       command was executed.
      274    16594        */
      275    16595        /**********************************************************************/
      276    16596    1   CPE$COMMENT:
      277    16597    1     ENTRY(P$PCB)   ALTRET;

  16597  2 000003   000000 700200 xent  CPE$COMMENT  TSX0  ! X66_AUTO_1
         2 000004   002450 000001                    ZERO    1320,1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:130  

      278    16598        /**/
      279    16599    1     BLK$ = P$PCB.OUT$;

  16599  2 000005   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000006   000003 236100                    LDQ     3,,PR0
         2 000007   200004 756100                    STQ     BLK$,,AUTO

      280    16600        /*
      281    16601          ****     No option after comment infers function change
      282    16602        */
      283    16603    1     IF (BLK$->P$B.NSUBLKS=0)

  16603  2 000010   200004 471500                    LDP1    BLK$,,AUTO
         2 000011   100001 220100                    LDX0    1,,PR1
         2 000012   000017 601000 2                  TNZ     s:16612

      284    16604    1        THEN
      285    16605    2           DO;

      286    16606    2              B$JIT.PRFLAGS.COMMENT=%YES#; /*Turn on commentary*/

  16606  2 000013   000000 473400 xsym               LDP3    B$JIT$
         2 000014   020000 236003                    LDQ     8192,DU
         2 000015   300030 256100                    ORSQ    24,,PR3

      287    16607    2              RETURN;

  16607  2 000016   000000 702200 xent               TSX2  ! X66_ARET

      288    16608    2           END;
      289    16609        /*
      290    16610          ****     Must be at job step to direct output
      291    16611        */
      292    16612    1     IF NOT B$JIT.CPFLAGS1.JSTEP

  16612  2 000017   000000 473400 xsym               LDP3    B$JIT$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:131  
         2 000020   300143 236100                    LDQ     99,,PR3
         2 000021   200000 316003                    CANQ    65536,DU
         2 000022   000064 600000 2                  TZE     COMMENT70

      293    16613    1        THEN
      294    16614    1           GOTO COMMENT70;
      295    16615        /*         Create assign merge record for M$DO   */
      296    16616    1     ONOVERINTO$=BLK$->P$B.SUBLK$(0); /*Bld ptr to keyword*/

  16616  2 000023   100003 236100                    LDQ     3,,PR1
         2 000024   200005 756100                    STQ     ONOVERINTO$,,AUTO

      297    16617    1     FID$=BLK$->P$B.SUBLK$(1)->P$B.SUBLK$(0); /*Bld ptr to fid*/

  16617  2 000025   100004 474500                    LDP4    4,,PR1
         2 000026   400003 236100                    LDQ     3,,PR4
         2 000027   200006 756100                    STQ     FID$,,AUTO

      298    16618    1     CALL CPE$GENRUAM(BLK$,ONOVERINTO$,FID$,ADDR(M$DODCB),'1'B) ALTRET(COMMENT80);

  16618  2 000030   000000 236000 3                  LDQ     0
         2 000031   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 000032   000001 236000 3                  LDQ     1
         2 000033   202357 756100                    STQ     CLSDCB+35,,AUTO
         2 000034   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 000035   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 000036   200006 635500                    EPPR5   FID$,,AUTO
         2 000037   202355 455500                    STP5    CLSDCB+33,,AUTO
         2 000040   200005 636500                    EPPR6   ONOVERINTO$,,AUTO
         2 000041   202354 456500                    STP6    CLSDCB+32,,AUTO
         2 000042   200004 637500                    EPPR7   BLK$,,AUTO
         2 000043   202353 457500                    STP7    CLSDCB+31,,AUTO
         2 000044   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 000045   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000046   000000 701000 xent               TSX1    CPE$GENRUAM
         2 000047   000100 702000 2                  TSX2    COMMENT80

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:132  
      299    16619    1     CALL CPE$RFEXT(ADDR(M$DODCB));  /*Reset file ext. For M$DO*/

  16619  2 000050   000000 236000 3                  LDQ     0
         2 000051   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 000052   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 000053   202353 450500                    STP0    CLSDCB+31,,AUTO
         2 000054   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 000055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000056   000000 701000 xent               TSX1    CPE$RFEXT
         2 000057   000000 011000                    NOP     0

      300    16620    1     B$JIT.PRFLAGS.COMMENT=%YES#;  /*Set comment cmnd flag*/

  16620  2 000060   000000 470400 xsym               LDP0    B$JIT$
         2 000061   020000 236003                    LDQ     8192,DU
         2 000062   000030 256100                    ORSQ    24,,PR0

      301    16621    1     RETURN;

  16621  2 000063   000000 702200 xent               TSX2  ! X66_ARET

  16620  2 000064                       COMMENT70    null
      302    16622    1   COMMENT70:;
      303    16623        /*E*       ERROR: CPE-E$QUIT-E
      304    16624                   MESSAGE:  Command legal at job step - execute QUIT or GO command
      305    16625                   DESCRIPTION: This form of the COMMENT command can only be
      306    16626                                executed when at job step.
      307    16627        */
      308    16628    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_QUIT);

  16628  2 000064   000000 236000 xsym               LDQ     SEG2$
         2 000065   000003 036003                    ADLQ    3,DU
         2 000066   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 000067   000004 237000 3                  LDAQ    4
         2 000070   202354 757100                    STAQ    CLSDCB+32,,AUTO
         2 000071   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 000072   202353 454500                    STP4    CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:133  
         2 000073   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 000074   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000075   000000 701000 xent               TSX1    CXP$POSTERR
         2 000076   000000 011000                    NOP     0

      309    16629    1     ALTRETURN;

  16629  2 000077   000000 702200 xent               TSX2  ! X66_AALT

  16620  2 000100                       COMMENT80    null
      310    16630    1   COMMENT80:;
      311    16631    1     ALTRETURN;

  16631  2 000100   000000 702200 xent               TSX2  ! X66_AALT

      312    16632                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:134  
      313    16633        /***********************************************************************/
      314    16634        /*F*   NAME:   CPE$DISPLAY
      315    16635               PURPOSE: The DISPLAY command is utilized to display system and
      316    16636                       user information.
      317    16637               DESCRIPTION: The DISPLAY command displays general system
      318    16638                       information if options aren't specified. Information
      319    16639                       displayed by the various options consist of the following:
      320    16640                       1. ALL - displays all information displayable by options
      321    16641                       2. dcbname - displays assignment information for a specific dcb
      322    16642                       3. DCBS - displays assignment information for all dcbs
      323    16643                       4. FLAGS - display settings of control flags
      324    16644                       5. USER - display general user information
      325    16645                       6. SWITCH - display sense switches
      326    16646                       7. TERMINAL - display terminal characteristics
      327    16647                       8. PRIV - display user privileges
      328    16648                       9. DIRECTORY - display file management directory
      329    16649                       10. TABS - display tabs
      330    16650                       11. STEPCC - display step condition codes
      331    16651                       12. SETUP - display the FCOMMAND in :USERS
      332    16652                       13. LIMITS - display service limits
      333    16653                       14. GLOBALS - display GLOBAL defs
      334    16654                       15. VARS - display COMMAND VARIABLES
      335    16655                       16. PLATEN - display PLATEN
      336    16656                       17. RESOURCE - display resources reserved for user
      337    16657                       18. TIME or DATE - display time and date
      338    16658                       19. REPORT - display STEP reporting level.
      339    16659                       20. PRIORITY - display default priority
      340    16660                       21. PROFILE - display current and available profiles
      341    16661                       22. PPRIVS - display processor privileges
      342    16662                       23. WSN - display work station name of origin
      343    16663                       24. BUDGET - display budget limit
      344    16664                       24. BANNERTEXT - display BANNERTEXT information.
      345    16665                       25. REGISTERNAME - display REGISTERNAME information.
      346    16666               REFERENCE: Programmers Reference Manual
      347    16667        */
      348    16668        /*D*   NAME:   CPE$DISPLAY
      349    16669               CALL:   CALL CPE$DISPLAY
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:135  
      350    16670               INPUT:  BLK$ - pointer to parsed output
      351    16671               OUTPUT: requested information to output device
      352    16672               DESCRIPTION: General system information is obtained
      353    16673                       using the m$sysload pmme if no options are specified.
      354    16674                       Otherwise specific options are processed which request
      355    16675                       information contained in the JIT and :USERS record.
      356    16676        */
      357    16677        /**********************************************************************/
      358    16678    1   CPE$DISPLAY:
      359    16679    1     ENTRY(P$PCB)   ALTRET;

  16679  2 000101   000000 700200 xent  CPE$DISPLAY  TSX0  ! X66_AUTO_1
         2 000102   002450 000001                    ZERO    1320,1

      360    16680        /**/
      361    16681    1     BLK$ = P$PCB.OUT$;

  16681  2 000103   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000104   000003 236100                    LDQ     3,,PR0
         2 000105   200004 756100                    STQ     BLK$,,AUTO

      362    16682    1     SEG$2.FPT_WRITE$->FPT$WRITE=CFPT_WRITE;

  16682  2 000106   000000 471400 xsym               LDP1    SEG2$
         2 000107   100165 473500                    LDP3    117,,PR1
         2 000110   000100 100400                    MLR     fill='000'O
         2 000111   000000 000060 xsym               ADSC9   CFPT_WRITE               cn=0,n=48
         2 000112   300000 000060                    ADSC9   0,,PR3                   cn=0,n=48

      363    16683    1     SEG$2.FPT_WRITE$->FPT$WRITE.V_=VECTOR(SEG$2.FPT_WRITE$->

  16683  2 000113   100165 473500                    LDP3    117,,PR1
         2 000114   000003 235000 3                  LDA     3
         2 000115   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 000116   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 000117   000010 036003                    ADLQ    8,DU
         2 000120   300000 757100                    STAQ    0,,PR3
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:136  

      364    16684    1          FPT$WRITE.V);
      365    16685        /*
      366    16686          **** No options after display only infers ...DISPLAY system info.
      367    16687        */
      368    16688    1     IF (BLK$->P$B.NSUBLKS=0)

  16688  2 000121   200004 473500                    LDP3    BLK$,,AUTO
         2 000122   300001 220100                    LDX0    1,,PR3
         2 000123   000127 601000 2                  TNZ     s:16694

      369    16689    1        THEN
      370    16690    2           DO;

      371    16691    2              CALL DISPSYS ALTRET(DISP50);

  16691  2 000124   002230 701000 2                  TSX1    DISPSYS
         2 000125   000657 702000 2                  TSX2    DISP50

      372    16692    2              RETURN;

  16692  2 000126   000000 702200 xent               TSX2  ! X66_ARET

      373    16693    2           END;
      374    16694    1     I=0;

  16694  2 000127   200472 450100                    STZ     I,,AUTO

      375    16695    1   DISP5:
      376    16696    2     DO WHILE(I<BLK$->P$B.NSUBLKS);

  16696  2 000130   300001 236100       DISP5        LDQ     1,,PR3
         2 000131   000022 772000                    QRL     18
         2 000132   200472 116100                    CMPQ    I,,AUTO
         2 000133   000615 602000 2                  TNC     s:16819
         2 000134   000615 600000 2                  TZE     s:16819

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:137  
      377    16697    2        TEMP$=BLK$->P$B.SUBLK$(I);

  16697  2 000135   200004 470500                    LDP0    BLK$,,AUTO
         2 000136   200472 720100                    LXL0    I,,AUTO
         2 000137   000003 236110                    LDQ     3,X0,PR0
         2 000140   200011 756100                    STQ     TEMP$,,AUTO

      378    16698    2   DISP10:
      379    16699                                                         /*
      380    16700                                                         */
      381    16701    3        DO CASE(TEMP$->P$B.CODE);

  16701  2 000141   200011 471500       DISP10       LDP1    TEMP$,,AUTO
         2 000142   100000 721100                    LXL1    0,,PR1
         2 000143   000040 101003                    CMPX1   32,DU
         2 000144   000146 602011 2                  TNC     DISP10+5,X1
         2 000145   000604 710000 2                  TRA     s:16817
         2 000146   000604 710000 2                  TRA     s:16817
         2 000147   000206 710000 2                  TRA     s:16703
         2 000150   000317 710000 2                  TRA     s:16732
         2 000151   000322 710000 2                  TRA     s:16734
         2 000152   000325 710000 2                  TRA     s:16736
         2 000153   000330 710000 2                  TRA     s:16738
         2 000154   000403 710000 2                  TRA     s:16757
         2 000155   000412 710000 2                  TRA     s:16760
         2 000156   000421 710000 2                  TRA     s:16763
         2 000157   000434 710000 2                  TRA     s:16768
         2 000160   000443 710000 2                  TRA     s:16771
         2 000161   000452 710000 2                  TRA     s:16774
         2 000162   000455 710000 2                  TRA     s:16776
         2 000163   000464 710000 2                  TRA     s:16779
         2 000164   000502 710000 2                  TRA     s:16785
         2 000165   000604 710000 2                  TRA     s:16817
         2 000166   000517 710000 2                  TRA     s:16792
         2 000167   000473 710000 2                  TRA     s:16782
         2 000170   000526 710000 2                  TRA     s:16795
         2 000171   000533 710000 2                  TRA     s:16797
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:138  
         2 000172   000551 710000 2                  TRA     s:16803
         2 000173   000560 710000 2                  TRA     s:16806
         2 000174   000567 710000 2                  TRA     s:16809
         2 000175   000430 710000 2                  TRA     s:16766
         2 000176   000574 710000 2                  TRA     s:16811
         2 000177   000602 710000 2                  TRA     s:16815
         2 000200   000542 710000 2                  TRA     s:16800
         2 000201   000542 710000 2                  TRA     s:16800
         2 000202   000514 710000 2                  TRA     s:16790
         2 000203   000514 710000 2                  TRA     s:16790
         2 000204   000511 710000 2                  TRA     s:16788
         2 000205   000577 710000 2                  TRA     s:16813

      382    16702    3         CASE(DALLOPT);

      383    16703    3           CALL DISPUSER ALTRET(DISP50);

  16703  2 000206   011331 701000 2                  TSX1    DISPUSER
         2 000207   000657 702000 2                  TSX2    DISP50

      384    16704    3           CALL DISPFLGS ALTRET(DISP50);

  16704  2 000210   010722 701000 2                  TSX1    DISPFLGS
         2 000211   000657 702000 2                  TSX2    DISP50

      385    16705    3           CALL DISPDCBS ALTRET(DISP50);

  16705  2 000212   002462 701000 2                  TSX1    DISPDCBS
         2 000213   000657 702000 2                  TSX2    DISP50

      386    16706    3           CALL DISPLDEV ALTRET(DISP50);

  16706  2 000214   013370 701000 2                  TSX1    DISPLDEV
         2 000215   000657 702000 2                  TSX2    DISP50

      387    16707    3           CALL DISPNOTIFY ALTRET(DISP50);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:139  
  16707  2 000216   015616 701000 2                  TSX1    DISPNOTIFY
         2 000217   000657 702000 2                  TSX2    DISP50

      388    16708    3           CALL DISPWHEN ALTRET(DISP50);

  16708  2 000220   017050 701000 2                  TSX1    DISPWHEN
         2 000221   000657 702000 2                  TSX2    DISP50

      389    16709        /*
      390    16710        ***     Fake out the external   routines to think that they were called by a
      391    16711        ***     command directly. P$PCB.OUT$ needs to point to a block which
      392    16712        ***     has zero sub-blocks, which is just what TEMP$ points to.
      393    16713        */
      394    16714    3           P$PCB.OUT$ = TEMP$;

  16714  2 000222   200011 236100                    LDQ     TEMP$,,AUTO
         2 000223   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000224   000003 756100                    STQ     3,,PR0

      395    16715    3           CALL CPF$SWITCH(P$PCB)  ALTRET(DISP50);

  16715  2 000225   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000227   000000 701000 xent               TSX1    CPF$SWITCH
         2 000230   000657 702000 2                  TSX2    DISP50

      396    16716    3           CALL CPF$TERMINAL(P$PCB) ALTRET(DISP50);

  16716  2 000231   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000232   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000233   000000 701000 xent               TSX1    CPF$TERMINAL
         2 000234   000657 702000 2                  TSX2    DISP50

      397    16717    3           CALL CPF$PRIV(P$PCB) ALTRET(DISP50);

  16717  2 000235   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000236   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:140  
         2 000237   000000 701000 xent               TSX1    CPF$PRIV
         2 000240   000657 702000 2                  TSX2    DISP50

      398    16718    3           CALL CPF$PPRIV ALTRET(DISP50);

  16718  2 000241   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000242   000000 701000 xent               TSX1    CPF$PPRIV
         2 000243   000657 702000 2                  TSX2    DISP50

      399    16719    3           CALL CPI$TABS(P$PCB) ALTRET(DISP50);

  16719  2 000244   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000245   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000246   000000 701000 xent               TSX1    CPI$TABS
         2 000247   000657 702000 2                  TSX2    DISP50

      400    16720    3           CALL DISPSTEPCC ALTRET(DISP50);    /*Display step cc's*/

  16720  2 000250   012173 701000 2                  TSX1    DISPSTEPCC
         2 000251   000657 702000 2                  TSX2    DISP50

      401    16721    3           CALL CPJ$LIMIT(P$PCB) ALTRET(DISP50); /*Display limits*/

  16721  2 000252   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000253   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000254   000000 701000 xent               TSX1    CPJ$LIMIT
         2 000255   000657 702000 2                  TSX2    DISP50

      402    16722    3           CALL CPO$ORES(P$PCB) ALTRET(DISP50); /* Di res */

  16722  2 000256   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000257   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000260   000000 701000 xent               TSX1    CPO$ORES
         2 000261   000657 702000 2                  TSX2    DISP50

      403    16723    3           CALL CPH$GLOBAL(P$PCB) ALTRET(DISP50); /*Display globals*/

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:141  
  16723  2 000262   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000264   000000 701000 xent               TSX1    CPH$GLOBAL
         2 000265   000657 702000 2                  TSX2    DISP50

      404    16724    3           CALL CPG$LET(P$PCB) ALTRET(DISP50); /*Display variables*/

  16724  2 000266   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000267   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000270   000000 701000 xent               TSX1    CPG$LET
         2 000271   000657 702000 2                  TSX2    DISP50

      405    16725    3           CALL CPB$PLATEN(P$PCB) ALTRET(DISP50); /*Display platen*/

  16725  2 000272   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000273   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000274   000000 701000 xent               TSX1    CPB$PLATEN
         2 000275   000657 702000 2                  TSX2    DISP50

      406    16726    3           CALL CPB$REPORT(P$PCB) ALTRET(DISP50); /*Display report*/

  16726  2 000276   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000277   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000300   000000 701000 xent               TSX1    CPB$REPORT
         2 000301   000657 702000 2                  TSX2    DISP50

      407    16727    3           CALL CPI$PRIORITY(P$PCB) ALTRET(DISP50); /*Display PRIO.*/

  16727  2 000302   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000303   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000304   000000 701000 xent               TSX1    CPI$PRIORITY
         2 000305   000657 702000 2                  TSX2    DISP50

      408    16728    3           CALL CPF$PROFILE(P$PCB) ALTRET(DISP50);  /*Display profile*/

  16728  2 000306   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000307   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:142  
         2 000310   000000 701000 xent               TSX1    CPF$PROFILE
         2 000311   000657 702000 2                  TSX2    DISP50

      409    16729    3           CALL DISPBUDGET ALTRET(DISP50);  /*Display budget*/

  16729  2 000312   013011 701000 2                  TSX1    DISPBUDGET
         2 000313   000657 702000 2                  TSX2    DISP50

      410    16730    3           CALL DISPWSN ALTRET(DISP50);  /*Display woo*/

  16730  2 000314   013300 701000 2                  TSX1    DISPWSN
         2 000315   000657 702000 2                  TSX2    DISP50
         2 000316   000604 710000 2                  TRA     s:16817

      411    16731    3         CASE(DDCBSOPT);

      412    16732    3           CALL DISPDCBS ALTRET(DISP50);

  16732  2 000317   002462 701000 2                  TSX1    DISPDCBS
         2 000320   000657 702000 2                  TSX2    DISP50
         2 000321   000604 710000 2                  TRA     s:16817

      413    16733    3         CASE(DFLAGSOPT);

      414    16734    3           CALL DISPFLGS ALTRET(DISP50);

  16734  2 000322   010722 701000 2                  TSX1    DISPFLGS
         2 000323   000657 702000 2                  TSX2    DISP50
         2 000324   000604 710000 2                  TRA     s:16817

      415    16735    3         CASE(DUSEROPT);

      416    16736    3           CALL DISPUSER ALTRET(DISP50);

  16736  2 000325   011331 701000 2                  TSX1    DISPUSER
         2 000326   000657 702000 2                  TSX2    DISP50
         2 000327   000604 710000 2                  TRA     s:16817
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:143  

      417    16737    3         CASE(DDCBOPT);

      418    16738    3           DCB$=TEMP$->P$B.SUBLK$(0);

  16738  2 000330   100003 236100                    LDQ     3,,PR1
         2 000331   200010 756100                    STQ     DCB$,,AUTO

      419    16739    3           CALL CXB$CHKFORT(DCB$);            /*Cnvrt. If fort dcb*/

  16739  2 000332   200010 633500                    EPPR3   DCB$,,AUTO
         2 000333   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 000334   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 000335   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000336   000000 701000 xent               TSX1    CXB$CHKFORT
         2 000337   000000 011000                    NOP     0

      420    16740    3           CPSL_PARAM = %NO# ;

  16740  2 000340   000100 100400                    MLR     fill='000'O
         2 000341   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000342   201654 000024                    ADSC9   CPSL_PARAM,,AUTO         cn=0,n=20

      421    16741    3           CALL CXC$READAM(DCB$,M$IBEX1_NUM,CPSL_PARAM) ;

  16741  2 000343   201654 630500                    EPPR0   CPSL_PARAM,,AUTO
         2 000344   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 000345   000006 236000 3                  LDQ     6
         2 000346   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 000347   200010 631500                    EPPR1   DCB$,,AUTO
         2 000350   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 000351   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 000352   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000353   000000 701000 xent               TSX1    CXC$READAM
         2 000354   000000 011000                    NOP     0

      422    16742    3           IF CPSL_PARAM.ERRCODE ~= %NO#
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:144  

  16742  2 000355   201656 235100                    LDA     CPSL_PARAM+2,,AUTO
         2 000356   000366 600000 2                  TZE     s:16752

      423    16743    3             THEN
      424    16744    3               IF CPSL_PARAM.FLAGS.REPORTED_TO_USER

  16744  2 000357   201655 236100                    LDQ     CPSL_PARAM+1,,AUTO
         2 000360   100000 316003                    CANQ    32768,DU
         2 000361   000622 601000 2                  TNZ     DISP45

      425    16745    3                 THEN
      426    16746    3                   GOTO DISP45 ;
      427    16747    3                 ELSE
      428    16748    4                   DO ;

      429    16749    4                     B$JIT.USRERR = CPSL_PARAM.ERRCODE ;

  16749  2 000362   201656 236100                    LDQ     CPSL_PARAM+2,,AUTO
         2 000363   000000 470400 xsym               LDP0    B$JIT$
         2 000364   000144 756100                    STQ     100,,PR0

      430    16750    4                     GOTO DISP45 ;

  16750  2 000365   000622 710000 2                  TRA     DISP45

      431    16751    4                   END ;
      432    16752    3           TAB_VAL=3;                         /*Set tab to 3*/

  16752  2 000366   000003 236007                    LDQ     3,DL
         2 000367   200474 756100                    STQ     TAB_VAL,,AUTO

      433    16753    3           CALL DISPDCB(DCB$,TAB_VAL) ALTRET(DISP47);

  16753  2 000370   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 000371   202076 450500                    STP0    @DCB#+1,,AUTO
         2 000372   200010 631500                    EPPR1   DCB$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:145  
         2 000373   202075 451500                    STP1    @CREATE_FLG+1,,AUTO
         2 000374   002760 701000 2                  TSX1    DISPDCB
         2 000375   000653 702000 2                  TSX2    DISP47

  16752  2 000376                       DISP12       null
      434    16754    3   DISP12:;
      435    16755    3           CALL CPC$RELSEG (SEG3$);

  16755  2 000376   000007 630400 3                  EPPR0   7
         2 000377   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000400   000000 701000 xent               TSX1    CPC$RELSEG
         2 000401   000000 011000                    NOP     0
         2 000402   000604 710000 2                  TRA     s:16817

      436    16756    3         CASE(DSWITCHOPT);

      437    16757    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPF$SWITCH routine*/

  16757  2 000403   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000404   300003 756100                    STQ     3,,PR3

      438    16758    3           CALL CPF$SWITCH(P$PCB)  ALTRET(DISP50);

  16758  2 000405   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000406   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000407   000000 701000 xent               TSX1    CPF$SWITCH
         2 000410   000657 702000 2                  TSX2    DISP50
         2 000411   000604 710000 2                  TRA     s:16817

      439    16759    3         CASE(DTERMINALOPT);

      440    16760    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPF$TERMINAL routine */

  16760  2 000412   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000413   300003 756100                    STQ     3,,PR3

      441    16761    3           CALL CPF$TERMINAL(P$PCB) ALTRET(DISP50);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:146  

  16761  2 000414   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000415   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000416   000000 701000 xent               TSX1    CPF$TERMINAL
         2 000417   000657 702000 2                  TSX2    DISP50
         2 000420   000604 710000 2                  TRA     s:16817

      442    16762    3         CASE(DPRIVOPT);

      443    16763    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPF$PRIV routine */

  16763  2 000421   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000422   300003 756100                    STQ     3,,PR3

      444    16764    3           CALL CPF$PRIV(P$PCB) ALTRET(DISP50);

  16764  2 000423   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000424   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000425   000000 701000 xent               TSX1    CPF$PRIV
         2 000426   000657 702000 2                  TSX2    DISP50
         2 000427   000604 710000 2                  TRA     s:16817

      445    16765    3         CASE(DPPRIVOPT);

      446    16766    3           CALL CPF$PPRIV  ALTRET(DISP50);

  16766  2 000430   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000431   000000 701000 xent               TSX1    CPF$PPRIV
         2 000432   000657 702000 2                  TSX2    DISP50
         2 000433   000604 710000 2                  TRA     s:16817

      447    16767    3         CASE(DTABSOPT);

      448    16768    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPI$TABS routine */

  16768  2 000434   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000435   300003 756100                    STQ     3,,PR3
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:147  

      449    16769    3           CALL CPI$TABS(P$PCB) ALTRET(DISP50);

  16769  2 000436   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000437   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000440   000000 701000 xent               TSX1    CPI$TABS
         2 000441   000657 702000 2                  TSX2    DISP50
         2 000442   000604 710000 2                  TRA     s:16817

      450    16770    3         CASE(DDIROPT);

      451    16771    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPI$DIR routine*/

  16771  2 000443   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000444   300003 756100                    STQ     3,,PR3

      452    16772    3           CALL CPI$DIRECTORY(P$PCB) ALTRET(DISP50);

  16772  2 000445   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000446   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000447   000000 701000 xent               TSX1    CPI$DIRECTORY
         2 000450   000657 702000 2                  TSX2    DISP50
         2 000451   000604 710000 2                  TRA     s:16817

      453    16773    3         CASE(DSTEPCCOPT);

      454    16774    3           CALL DISPSTEPCC ALTRET(DISP50);

  16774  2 000452   012173 701000 2                  TSX1    DISPSTEPCC
         2 000453   000657 702000 2                  TSX2    DISP50
         2 000454   000604 710000 2                  TRA     s:16817

      455    16775    3         CASE(DSETUPOPT);

      456    16776    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPI$SETUP routine*/

  16776  2 000455   200003 473500                    LDP3    @P$PCB,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:148  
         2 000456   300003 756100                    STQ     3,,PR3

      457    16777    3           CALL CPI$SETUP(P$PCB) ALTRET(DISP50);

  16777  2 000457   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000460   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000461   000000 701000 xent               TSX1    CPI$SETUP
         2 000462   000657 702000 2                  TSX2    DISP50
         2 000463   000604 710000 2                  TRA     s:16817

      458    16778    3         CASE(DLIMITSOPT);

      459    16779    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPJ$LIMIT routine*/

  16779  2 000464   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000465   300003 756100                    STQ     3,,PR3

      460    16780    3           CALL CPJ$LIMIT(P$PCB) ALTRET(DISP50);

  16780  2 000466   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000467   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000470   000000 701000 xent               TSX1    CPJ$LIMIT
         2 000471   000657 702000 2                  TSX2    DISP50
         2 000472   000604 710000 2                  TRA     s:16817

      461    16781    3         CASE(DRESOURCEOPT);

      462    16782    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPO$ORES routine*/

  16782  2 000473   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000474   300003 756100                    STQ     3,,PR3

      463    16783    3           CALL CPO$ORES(P$PCB) ALTRET(DISP50);

  16783  2 000475   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000476   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000477   000000 701000 xent               TSX1    CPO$ORES
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:149  
         2 000500   000657 702000 2                  TSX2    DISP50
         2 000501   000604 710000 2                  TRA     s:16817

      464    16784    3         CASE(DGLOBALSOPT);

      465    16785    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPH$GLOBAL routine*/

  16785  2 000502   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000503   300003 756100                    STQ     3,,PR3

      466    16786    3           CALL CPH$GLOBAL(P$PCB) ALTRET(DISP50);

  16786  2 000504   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000505   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000506   000000 701000 xent               TSX1    CPH$GLOBAL
         2 000507   000657 702000 2                  TSX2    DISP50
         2 000510   000604 710000 2                  TRA     s:16817

      467    16787    3         CASE(%DNOTIFYOPT#) ;

      468    16788    3           CALL DISPNOTIFY ALTRET(DISP50) ;

  16788  2 000511   015616 701000 2                  TSX1    DISPNOTIFY
         2 000512   000657 702000 2                  TSX2    DISP50
         2 000513   000604 710000 2                  TRA     s:16817

      469    16789    3         CASE(%DLDEVOPT#,%DLDEVSOPT#) ;

      470    16790    3           CALL DISPLDEV ALTRET(DISP50) ;

  16790  2 000514   013370 701000 2                  TSX1    DISPLDEV
         2 000515   000657 702000 2                  TSX2    DISP50
         2 000516   000604 710000 2                  TRA     s:16817

      471    16791    3         CASE(DPLATENOPT);

      472    16792    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPB$PLATEN routine*/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:150  

  16792  2 000517   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000520   300003 756100                    STQ     3,,PR3

      473    16793    3           CALL CPB$PLATEN(P$PCB) ALTRET(DISP50);

  16793  2 000521   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000522   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000523   000000 701000 xent               TSX1    CPB$PLATEN
         2 000524   000657 702000 2                  TSX2    DISP50
         2 000525   000604 710000 2                  TRA     s:16817

      474    16794    3         CASE(DTIMEOPT);

      475    16795    3           CALL CPE$TIME(P$PCB) ALTRET(DISP50);

  16795  2 000526   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000527   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000530   001756 701000 2                  TSX1    s:17336
         2 000531   000657 702000 2                  TSX2    DISP50
         2 000532   000604 710000 2                  TRA     s:16817

      476    16796    3         CASE(DVARIABLESOPT);

      477    16797    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPG$LET routine */

  16797  2 000533   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000534   300003 756100                    STQ     3,,PR3

      478    16798    3           CALL CPG$LET(P$PCB) ALTRET(DISP50);

  16798  2 000535   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000536   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000537   000000 701000 xent               TSX1    CPG$LET
         2 000540   000657 702000 2                  TSX2    DISP50
         2 000541   000604 710000 2                  TRA     s:16817

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:151  
      479    16799    3         CASE(%DBANNERTEXTOPT#, %DREGISTERNAMEOPT#);

      480    16800    3           P$PCB.OUT$=TEMP$;                 /*Fake out CPG$LET routine */

  16800  2 000542   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000543   300003 756100                    STQ     3,,PR3

      481    16801    3           CALL CPG$LET(P$PCB) ALTRET(DISP50);

  16801  2 000544   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000545   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000546   000000 701000 xent               TSX1    CPG$LET
         2 000547   000657 702000 2                  TSX2    DISP50
         2 000550   000604 710000 2                  TRA     s:16817

      482    16802    3         CASE(DREPORTOPT);

      483    16803    3           P$PCB.OUT$=TEMP$;                /*Fake out CPB$REPORT routine */

  16803  2 000551   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000552   300003 756100                    STQ     3,,PR3

      484    16804    3           CALL CPB$REPORT(P$PCB) ALTRET(DISP50);

  16804  2 000553   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000554   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000555   000000 701000 xent               TSX1    CPB$REPORT
         2 000556   000657 702000 2                  TSX2    DISP50
         2 000557   000604 710000 2                  TRA     s:16817

      485    16805    3         CASE(DPRIOOPT);

      486    16806    3           P$PCB.OUT$=TEMP$;                  /*Fake out CPI$PRIORITY routine*/

  16806  2 000560   200003 473500                    LDP3    @P$PCB,,AUTO
         2 000561   300003 756100                    STQ     3,,PR3

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:152  
      487    16807    3           CALL CPI$PRIORITY(P$PCB) ALTRET(DISP50);

  16807  2 000562   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000563   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000564   000000 701000 xent               TSX1    CPI$PRIORITY
         2 000565   000657 702000 2                  TSX2    DISP50
         2 000566   000604 710000 2                  TRA     s:16817

      488    16808    3         CASE(DPROFILEOPT);

      489    16809    3           CALL CPF$DIPROFILES(P$PCB) ALTRET(DISP50);

  16809  2 000567   200003 630500                    EPPR0   @P$PCB,,AUTO
         2 000570   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000571   000000 701000 xent               TSX1    CPF$DIPROFILES
         2 000572   000657 702000 2                  TSX2    DISP50
         2 000573   000604 710000 2                  TRA     s:16817

      490    16810    3         CASE(DBUDGETOPT);

      491    16811    3           CALL DISPBUDGET  ALTRET(DISP50);

  16811  2 000574   013011 701000 2                  TSX1    DISPBUDGET
         2 000575   000657 702000 2                  TSX2    DISP50
         2 000576   000604 710000 2                  TRA     s:16817

      492    16812    3         CASE(%DWHENOPT#);

      493    16813    3           CALL DISPWHEN  ALTRET(DISP50);

  16813  2 000577   017050 701000 2                  TSX1    DISPWHEN
         2 000600   000657 702000 2                  TSX2    DISP50
         2 000601   000604 710000 2                  TRA     s:16817

      494    16814    3         CASE(DWSNOPT);

      495    16815    3           CALL DISPWSN  ALTRET(DISP50);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:153  

  16815  2 000602   013300 701000 2                  TSX1    DISPWSN
         2 000603   000657 702000 2                  TSX2    DISP50

      496    16816    3         END DISP10;

      497    16817    2        I=I+1;

  16817  2 000604   200472 235100                    LDA     I,,AUTO
         2 000605   000001 035007                    ADLA    1,DL
         2 000606   200472 755100                    STA     I,,AUTO

      498    16818    2     END DISP5;

  16818  2 000607   200004 470500                    LDP0    BLK$,,AUTO
         2 000610   000001 236100                    LDQ     1,,PR0
         2 000611   000022 772000                    QRL     18
         2 000612   200472 116100                    CMPQ    I,,AUTO
         2 000613   000615 600000 2                  TZE     s:16819
         2 000614   000135 603000 2                  TRC     s:16697

      499    16819    1     IF ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST ~= 0

  16819  2 000615   000000 470400 xsym               LDP0    SEG2$
         2 000616   000004 235100                    LDA     4,,PR0
         2 000617   000621 600000 2                  TZE     s:16823

      500    16820    1        THEN   /* Errors to report */
      501    16821    1           ALTRETURN;

  16821  2 000620   000000 702200 xent               TSX2  ! X66_AALT

      502    16822    1        ELSE   /* Normal return */
      503    16823    1           RETURN;

  16823  2 000621   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:154  
  16819  2 000622                       DISP45       null
      504    16824    1   DISP45: ;
      505    16825        /*         **** Check if a/m record for dcb existed */
      506    16826    1     IF (B$JIT.USRERR.CODE=%E$NOKEY)

  16826  2 000622   000000 470400 xsym               LDP0    B$JIT$
         2 000623   000144 236100                    LDQ     100,,PR0
         2 000624   377770 376007                    ANQ     131064,DL
         2 000625   001020 116007                    CMPQ    528,DL
         2 000626   000653 601000 2                  TNZ     DISP47

      507    16827    1        THEN
      508    16828    2           DO;

      509    16829        /*E*             ERROR: CPE-E$NOASGN-E
      510    16830                        MESSAGE: Dcb% %U1% isn't assigned
      511    16831                         DESCRIPTION: The dcb specified by the user is not assigned.
      512    16832        */
      513    16833    2              CPOS = TEMP$ -> P$S.CPOS;

  16833  2 000627   200011 471500                    LDP1    TEMP$,,AUTO
         2 000630   100002 235100                    LDA     2,,PR1
         2 000631   200475 755100                    STA     CPOS,,AUTO

      514    16834    2              CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_NOASGN);

  16834  2 000632   000000 236000 xsym               LDQ     SEG2$
         2 000633   000003 036003                    ADLQ    3,DU
         2 000634   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 000635   000010 236000 3                  LDQ     8
         2 000636   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 000637   200475 633500                    EPPR3   CPOS,,AUTO
         2 000640   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 000641   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 000642   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 000643   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 000644   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:155  
         2 000645   000000 701000 xent               TSX1    CXP$POSTERR
         2 000646   000000 011000                    NOP     0

      515    16835    2              B$JIT.USRERR.CODE=0;

  16835  2 000647   000000 470400 xsym               LDP0    B$JIT$
         2 000650   000011 236000 3                  LDQ     9
         2 000651   000144 356100                    ANSQ    100,,PR0

      516    16836    2              GOTO DISP12;

  16836  2 000652   000376 710000 2                  TRA     DISP12

  16826  2 000653                       DISP47       null
      517    16837    2           END;
      518    16838    1   DISP47: ;
      519    16839    1           CALL CPC$RELSEG (SEG3$);

  16839  2 000653   000007 630400 3                  EPPR0   7
         2 000654   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000655   000000 701000 xent               TSX1    CPC$RELSEG
         2 000656   000000 011000                    NOP     0

  16839  2 000657                       DISP50       null
      520    16840    1   DISP50: ;
      521    16841    1     ALTRETURN;

  16841  2 000657   000000 702200 xent               TSX2  ! X66_AALT

      522    16842                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:156  
      523    16843        /**********************************************************************/
      524    16844        /*F*   NAME:   CPE$DONT
      525    16845               PURPOSE: The DONT command is utilized by a user to perform the
      526    16846                       following functions:
      527    16847                       1. LIST - Refrain from outputting listing output from an
      528    16848                                 from an assembly or compilation.
      529    16849                       2. COMMENT - Refrain from outputting commentary from an
      530    16850                                    assembly or compilation.
      531    16851                       3. ECHO - Refrain from echoing commands being executed
      532    16852                                 from a command file or being executed in batch mode.
      533    16853                       4. ACCEPT - Refrain from outputting SEND,BROADCAST and tape
      534    16854                                   mounting information .
      535    16855                       5. DRIBBLE - Terminate recording of interactive terminal
      536    16856                                    transactions.
      537    16857                       5. EXPOUND - Inhibits printing of the "Type ? for details", and
      538    16858                                    other error-recovery dialog.
      539    16859                       6. POINT - specifies that errors are to be pointed out with a
      540    16860                                  longer, in-line method rather than with the
      541    16861                                  finger character ("^").
      542    16862                       7. POSITION - specifies that the error-reporting logic in GETCMD
      543    16863                                     should not attempt to place the user's cursor at
      544    16864                                     the location of the first reported error.
      545    16865               DESCRIPTION: For LIST and COMMENT, specific flags
      546    16866                       are looked at by various processors, are reset to
      547    16867                       indicate that the specified output isn't desired.
      548    16868                       For ECHO, a flag, which is checked prior to echoing
      549    16869                       command file commands, is reset.
      550    16870        */
      551    16871        /*D*   NAME:   CPE$DONT
      552    16872               CALL:   CALL CPE$DONT(P$PCB)
      553    16873               INTERFACE: CPC$IQUIT
      554    16874               INPUT:  BLK$ - pointer to parsed output
      555    16875               OUTPUT: B$JIT.PRFLAGS.COMMENT - reset
      556    16876                       B$JIT.PRFLAGS.LIST - reset
      557    16877                       B$JIT.PRFLAGS.EXPOUND - reset
      558    16878                       B$JIT.PRFLAGS.POINT - reset
      559    16879                       B$JIT.PRFLAGS.POSITION - reset
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:157  
      560    16880                       B$JIT.CPFLAGS1.CP_ECHO - reset
      561    16881               DESCRIPTION: When the COMMENT or LIST option is encountered,
      562    16882                       the pertinent flag in the JIT is reset to indicate supression
      563    16883                       of output is desired.
      564    16884                       For ECHO, a flag in the JIT is reset to indicate
      565    16885                       supression of command file command echoing.
      566    16886                       For ACCEPT the M$TRMISC pmme is executed to prevent SEND,
      567    16887                       BROADCAST and tape mounting info. from being output.
      568    16888                       For DRIBBLE, the M$DRIBBLE pmme is executed to terminate
      569    16889                       recording of interactive terminal transactions.
      570    16890        */
      571    16891        /***********************************************************************/
      572    16892    1   CPE$DONT:
      573    16893    1     ENTRY(P$PCB)   ALTRET;

  16893  2 000660   000000 700200 xent  CPE$DONT     TSX0  ! X66_AUTO_1
         2 000661   002450 000001                    ZERO    1320,1

      574    16894        /**/
      575    16895    1     BLK$ = P$PCB.OUT$;

  16895  2 000662   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000663   000003 236100                    LDQ     3,,PR0
         2 000664   200004 756100                    STQ     BLK$,,AUTO

      576    16896    1     I=0;

  16896  2 000665   200472 450100                    STZ     I,,AUTO

      577    16897    1   DONT5:
      578    16898    2     DO WHILE (I<BLK$->P$B.NSUBLKS);

  16898  2 000666   200004 471500       DONT5        LDP1    BLK$,,AUTO
         2 000667   100001 236100                    LDQ     1,,PR1
         2 000670   000022 772000                    QRL     18
         2 000671   200472 116100                    CMPQ    I,,AUTO
         2 000672   001201 602000 2                  TNC     s:16989
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:158  
         2 000673   001201 600000 2                  TZE     s:16989

      579    16899    2        TEMP$=BLK$->P$B.SUBLK$(I);

  16899  2 000674   200004 470500                    LDP0    BLK$,,AUTO
         2 000675   200472 720100                    LXL0    I,,AUTO
         2 000676   000003 236110                    LDQ     3,X0,PR0
         2 000677   200011 756100                    STQ     TEMP$,,AUTO

      580    16900    2   DONT10:
      581    16901    3        DO CASE(TEMP$->P$B.CODE);

  16901  2 000700   200011 471500       DONT10       LDP1    TEMP$,,AUTO
         2 000701   100000 721100                    LXL1    0,,PR1
         2 000702   000014 101003                    CMPX1   12,DU
         2 000703   000705 602011 2                  TNC     DONT10+5,X1
         2 000704   001170 710000 2                  TRA     s:16987
         2 000705   001170 710000 2                  TRA     s:16987
         2 000706   000721 710000 2                  TRA     s:16903
         2 000707   000731 710000 2                  TRA     s:16909
         2 000710   000735 710000 2                  TRA     s:16912
         2 000711   000741 710000 2                  TRA     s:16915
         2 000712   001067 710000 2                  TRA     s:16956
         2 000713   000725 710000 2                  TRA     s:16906
         2 000714   001051 710000 2                  TRA     s:16950
         2 000715   000745 710000 2                  TRA     s:16918
         2 000716   000751 710000 2                  TRA     s:16921
         2 000717   000755 710000 2                  TRA     s:16924
         2 000720   000761 710000 2                  TRA     s:16927

      582    16902    3         CASE(DPROTECTOPT);

      583    16903    3           B$JIT.CPFLAGS1.PROTECT = %NO# ;

  16903  2 000721   000000 473400 xsym               LDP3    B$JIT$
         2 000722   000012 236000 3                  LDQ     10
         2 000723   300143 356100                    ANSQ    99,,PR3
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:159  
         2 000724   001170 710000 2                  TRA     s:16987

      584    16904        /**/
      585    16905    3         CASE(DNOTIFYOPT);

      586    16906    3            B$JIT.CPFLAGS1.NOTIFY = %NO# ;

  16906  2 000725   000000 473400 xsym               LDP3    B$JIT$
         2 000726   000013 236000 3                  LDQ     11
         2 000727   300143 356100                    ANSQ    99,,PR3
         2 000730   001170 710000 2                  TRA     s:16987

      587    16907        /**/
      588    16908    3         CASE(DLISTOPT);

      589    16909    3           B$JIT.PRFLAGS.LIST=%NO#; /*Reset list flag*/

  16909  2 000731   000000 473400 xsym               LDP3    B$JIT$
         2 000732   000014 236000 3                  LDQ     12
         2 000733   300030 356100                    ANSQ    24,,PR3
         2 000734   001170 710000 2                  TRA     s:16987

      590    16910        /**/
      591    16911    3         CASE(DCOMMENTOPT);

      592    16912    3           B$JIT.PRFLAGS.COMMENT=%NO#; /*Reset comment flags*/

  16912  2 000735   000000 473400 xsym               LDP3    B$JIT$
         2 000736   000015 236000 3                  LDQ     13
         2 000737   300030 356100                    ANSQ    24,,PR3
         2 000740   001170 710000 2                  TRA     s:16987

      593    16913        /**/
      594    16914    3         CASE(DECHOOPT);

      595    16915    3           B$JIT.CPFLAGS1.ECHO = %NO# ;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:160  
  16915  2 000741   000000 473400 xsym               LDP3    B$JIT$
         2 000742   000016 236000 3                  LDQ     14
         2 000743   300143 356100                    ANSQ    99,,PR3
         2 000744   001170 710000 2                  TRA     s:16987

      596    16916        /**/
      597    16917    3         CASE(DEXPOUNDOPT);

      598    16918    3           B$JIT.PRFLAGS.EXPOUND = %NO#;

  16918  2 000745   000000 473400 xsym               LDP3    B$JIT$
         2 000746   000017 236000 3                  LDQ     15
         2 000747   300030 356100                    ANSQ    24,,PR3
         2 000750   001170 710000 2                  TRA     s:16987

      599    16919        /**/
      600    16920    3         CASE(DPOINTOPT);

      601    16921    3           B$JIT.PRFLAGS.POINT = %NO#;

  16921  2 000751   000000 473400 xsym               LDP3    B$JIT$
         2 000752   000020 236000 3                  LDQ     16
         2 000753   300030 356100                    ANSQ    24,,PR3
         2 000754   001170 710000 2                  TRA     s:16987

      602    16922        /**/
      603    16923    3         CASE(DPOSITIONOPT);

      604    16924    3           B$JIT.PRFLAGS.POSITION = %NO#;

  16924  2 000755   000000 473400 xsym               LDP3    B$JIT$
         2 000756   000021 236000 3                  LDQ     17
         2 000757   300030 356100                    ANSQ    24,,PR3
         2 000760   001170 710000 2                  TRA     s:16987

      605    16925        /**/
      606    16926    3         CASE(DWHENOPT);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:161  

      607    16927    3           IF B$JIT.CPFLAGS1.WHEN_INPUT

  16927  2 000761   000000 473400 xsym               LDP3    B$JIT$
         2 000762   300143 236100                    LDQ     99,,PR3
         2 000763   000400 316003                    CANQ    256,DU
         2 000764   001045 600000 2                  TZE     s:16947

      608    16928    3             THEN
      609    16929    4               DO ;

      610    16930    4                 FPT_CLOSE = CFPT_CLOSE;

  16930  2 000765   000100 100400                    MLR     fill='000'O
         2 000766   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 000767   201676 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      611    16931    4                 FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  16931  2 000770   000003 235000 3                  LDA     3
         2 000771   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 000772   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 000773   001730 036003                    ADLQ    984,DU
         2 000774   201676 757100                    STAQ    FPT_CLOSE,,AUTO

      612    16932    4                 FPT_CLOSE.V.DCB#=M$IBEX1_NUM;

  16932  2 000775   000000 721000 xsym               LXL1    M$IBEX1_NUM
         2 000776   201730 741100                    STX1    FPT_CLOSE+26,,AUTO

      613    16933    4                 FPT_CLOSE.V.DISP#=%SAVE#;

  16933  2 000777   000002 236007                    LDQ     2,DL
         2 001000   201730 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      614    16934    4                 CALL CPG$GET_WHEN_CNTL_REC(WHEN_CNTL_REC_CHANGED, STAR_S_IS_OPEN)

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:162  
  16934  2 001001   200025 634500                    EPPR4   STAR_S_IS_OPEN,,AUTO
         2 001002   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 001003   200024 635500                    EPPR5   WHEN_CNTL_REC_CHANGED,,AUTO
         2 001004   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 001005   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 001006   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001007   000000 701000 xent               TSX1    CPG$GET_WHEN_CNTL_REC
         2 001010   001202 702000 2                  TSX2    DONT75

      615    16935    4                                                                  ALTRET(DONT75) ;
      616    16936    4                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV =

  16936  2 001011   000000 470400 xsym               LDP0    SEG2$
         2 001012   000175 471500                    LDP1    125,,PR0
         2 001013   100000 236100                    LDQ     0,,PR1
         2 001014   000011 772000                    QRL     9
         2 001015   100000 552120                    STBQ    0,'20'O,PR1

      617    16937    4                                       SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.CUR_LEV ;
      618    16938    4                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(SEG$2.WHEN_CNTL_REC$

  16938  2 001016   000175 471500                    LDP1    125,,PR0
         2 001017   100000 236100                    LDQ     0,,PR1
         2 001020   000033 772000                    QRL     27
         2 001021   000003 402007                    MPY     3,DL
         2 001022   003106 061400                    CSR     bolr='003'O
         2 001023   000004 000044 xsym               BDSC    B_VECTNIL+4              by=0,bit=0,n=36
         2 001024   100001 000002                    BDSC    1,Q,PR1                  by=0,bit=0,n=2

      619    16939    4                                          ->WHEN$CNTL_REC.CUR_LEV) = %WHEN_DONT# ;
      620    16940    4                 CALL CPG$PUT_WHEN_CNTL_REC(STAR_S_IS_OPEN) WHENALTRETURN

  16940  2 001025   200025 631500                    EPPR1   STAR_S_IS_OPEN,,AUTO
         2 001026   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 001027   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 001030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001031   000000 701000 xent               TSX1    CPG$PUT_WHEN_CNTL_REC
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:163  
         2 001032   001034 702000 2                  TSX2    s:16942
         2 001033   001041 710000 2                  TRA     s:16945

      621    16941    5                       DO ;

      622    16942    5                         CALL M$CLOSE(FPT_CLOSE) ALTRET(DONT75) ;

  16942  2 001034   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001035   450001 713400                    CLIMB   alt,close
         2 001036   406000 401760                    pmme    nvectors=13
         2 001037   001202 702000 2                  TSX2    DONT75

      623    16943    5                         GOTO DONT75 ;

  16943  2 001040   001202 710000 2                  TRA     DONT75

      624    16944    5                       END ; /* Whenaltreturn Do */
      625    16945    4                 CALL M$CLOSE(FPT_CLOSE) ALTRET(DONT75) ;

  16945  2 001041   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001042   450001 713400                    CLIMB   alt,close
         2 001043   406000 401760                    pmme    nvectors=13
         2 001044   001202 702000 2                  TSX2    DONT75

      626    16946    4               END ; /* Then Do */

      627    16947    3           B$JIT.PRFLAGS.WHEN = %NO# ;

  16947  2 001045   000000 470400 xsym               LDP0    B$JIT$
         2 001046   000022 236000 3                  LDQ     18
         2 001047   000030 356100                    ANSQ    24,,PR0
         2 001050   001170 710000 2                  TRA     s:16987

      628    16948        /**/
      629    16949    3         CASE(DDRIBBLEOPT);

      630    16950    3           FPT_DRIBBLE = CFPT_DRIBBLE;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:164  

  16950  2 001051   000100 100400                    MLR     fill='000'O
         2 001052   000000 000020 xsym               ADSC9   CFPT_DRIBBLE             cn=0,n=16
         2 001053   200632 000020                    ADSC9   FPT_DRIBBLE,,AUTO        cn=0,n=16

      631    16951    3           FPT_DRIBBLE.V_ = VECTOR(FPT_DRIBBLE.V);

  16951  2 001054   000023 235000 3                  LDA     19
         2 001055   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 001056   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001057   000634 036003                    ADLQ    412,DU
         2 001060   200632 757100                    STAQ    FPT_DRIBBLE,,AUTO

      632    16952    3           FPT_DRIBBLE.V.DRIBBLE# = %NO#;

  16952  2 001061   200634 450100                    STZ     FPT_DRIBBLE+2,,AUTO

      633    16953    3           CALL M$DRIBBLE(FPT_DRIBBLE) ALTRET(DONT75);

  16953  2 001062   200632 630500                    EPPR0   FPT_DRIBBLE,,AUTO
         2 001063   560022 713400                    CLIMB   alt,+57362
         2 001064   400000 401760                    pmme    nvectors=1
         2 001065   001202 702000 2                  TSX2    DONT75
         2 001066   001170 710000 2                  TRA     s:16987

      634    16954        /**/
      635    16955    3         CASE(DACCEPTOPT);

      636    16956    3           FPT_TRMISC = CFPT_TRMISC;

  16956  2 001067   000100 100400                    MLR     fill='000'O
         2 001070   000000 000030 xsym               ADSC9   CFPT_TRMISC              cn=0,n=24
         2 001071   202060 000030                    ADSC9   FPT_TRMISC,,AUTO         cn=0,n=24

      637    16957    3           FPT_TRMISC.V_ = VECTOR(FPT_TRMISC.V);

  16957  2 001072   000023 235000 3                  LDA     19
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:165  
         2 001073   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 001074   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001075   002064 036003                    ADLQ    1076,DU
         2 001076   202060 757100                    STAQ    FPT_TRMISC,,AUTO

      638    16958    3           FPT_TRMISC.V.DCB# = M$UC_NUM;

  16958  2 001077   000000 721000 xsym               LXL1    M$UC_NUM
         2 001100   202064 741100                    STX1    FPT_TRMISC+4,,AUTO

      639    16959    3           J = 0;

  16959  2 001101   200473 450100                    STZ     J,,AUTO

      640    16960    3           IF TEMP$->P$B.NSUBLKS = 0

  16960  2 001102   100001 222100                    LDX2    1,,PR1
         2 001103   001112 601000 2                  TNZ     DONT15

      641    16961    3             THEN  /* No options specified, assume ALL */
      642    16962    4               DO ;

      643    16963    4                 FPT_TRMISC.V.SEND# = %NO#;

  16963  2 001104   000024 236000 3                  LDQ     20
         2 001105   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO

      644    16964    4                 FPT_TRMISC.V.BROADCAST# = %NO#;

  16964  2 001106   000025 236000 3                  LDQ     21
         2 001107   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO

      645    16965    4                 FPT_TRMISC.V.ANNOUNCE# = %NO#;

  16965  2 001110   000026 236000 3                  LDQ     22
         2 001111   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:166  
      646    16966    4               END;  /* Then Do */

      647    16967    3   DONT15:
      648    16968    4           DO WHILE (J<TEMP$->P$B.NSUBLKS);

  16968  2 001112   100001 236100       DONT15       LDQ     1,,PR1
         2 001113   000022 772000                    QRL     18
         2 001114   200473 116100                    CMPQ    J,,AUTO
         2 001115   001164 602000 2                  TNC     s:16985
         2 001116   001164 600000 2                  TZE     s:16985

      649    16969    4              TEMP1$ = TEMP$->P$B.SUBLK$(J);

  16969  2 001117   200011 470500                    LDP0    TEMP$,,AUTO
         2 001120   200473 720100                    LXL0    J,,AUTO
         2 001121   000003 236110                    LDQ     3,X0,PR0
         2 001122   200012 756100                    STQ     TEMP1$,,AUTO

      650    16970    4   DONT20:
      651    16971    5              DO CASE(TEMP1$->P$B.CODE);

  16971  2 001123   200012 471500       DONT20       LDP1    TEMP1$,,AUTO
         2 001124   100000 721100                    LXL1    0,,PR1
         2 001125   000005 101003                    CMPX1   5,DU
         2 001126   001130 602011 2                  TNC     DONT20+5,X1
         2 001127   001154 710000 2                  TRA     s:16983
         2 001130   001154 710000 2                  TRA     s:16983
         2 001131   001146 710000 2                  TRA     s:16979
         2 001132   001135 710000 2                  TRA     s:16973
         2 001133   001140 710000 2                  TRA     s:16975
         2 001134   001143 710000 2                  TRA     s:16977

      652    16972    5               CASE(AC_ANNOUNCE);

      653    16973    5                 FPT_TRMISC.V.ANNOUNCE# = %NO#;

  16973  2 001135   000026 236000 3                  LDQ     22
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:167  
         2 001136   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO
         2 001137   001154 710000 2                  TRA     s:16983

      654    16974    5               CASE(AC_BROADCAST);

      655    16975    5                 FPT_TRMISC.V.BROADCAST# = %NO#;

  16975  2 001140   000025 236000 3                  LDQ     21
         2 001141   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO
         2 001142   001154 710000 2                  TRA     s:16983

      656    16976    5               CASE(AC_SEND);

      657    16977    5                 FPT_TRMISC.V.SEND# = %NO#;

  16977  2 001143   000024 236000 3                  LDQ     20
         2 001144   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO
         2 001145   001154 710000 2                  TRA     s:16983

      658    16978    5               CASE(AC_ALL);

      659    16979    5                 FPT_TRMISC.V.SEND# = %NO#;

  16979  2 001146   000024 236000 3                  LDQ     20
         2 001147   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO

      660    16980    5                 FPT_TRMISC.V.BROADCAST# = %NO#;

  16980  2 001150   000025 236000 3                  LDQ     21
         2 001151   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO

      661    16981    5                 FPT_TRMISC.V.ANNOUNCE# = %NO#;

  16981  2 001152   000026 236000 3                  LDQ     22
         2 001153   202065 356100                    ANSQ    FPT_TRMISC+5,,AUTO

      662    16982    5               END DONT20;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:168  

      663    16983    4              J = J+1;

  16983  2 001154   200473 235100                    LDA     J,,AUTO
         2 001155   000001 035007                    ADLA    1,DL
         2 001156   200473 755100                    STA     J,,AUTO

      664    16984    4           END DONT15;

  16984  2 001157   000001 236100                    LDQ     1,,PR0
         2 001160   000022 772000                    QRL     18
         2 001161   200473 116100                    CMPQ    J,,AUTO
         2 001162   001164 600000 2                  TZE     s:16985
         2 001163   001117 603000 2                  TRC     s:16969

      665    16985    3           CALL M$TRMISC (FPT_TRMISC) ALTRET(DONT75);

  16985  2 001164   202060 630500                    EPPR0   FPT_TRMISC,,AUTO
         2 001165   560020 713400                    CLIMB   alt,+57360
         2 001166   400400 401760                    pmme    nvectors=2
         2 001167   001202 702000 2                  TSX2    DONT75

      666    16986    3         END DONT10;

      667    16987    2        I=I+1;

  16987  2 001170   200472 235100                    LDA     I,,AUTO
         2 001171   000001 035007                    ADLA    1,DL
         2 001172   200472 755100                    STA     I,,AUTO

      668    16988    2     END DONT5;

  16988  2 001173   200004 470500                    LDP0    BLK$,,AUTO
         2 001174   000001 236100                    LDQ     1,,PR0
         2 001175   000022 772000                    QRL     18
         2 001176   200472 116100                    CMPQ    I,,AUTO
         2 001177   001201 600000 2                  TZE     s:16989
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:169  
         2 001200   000674 603000 2                  TRC     s:16899

      669    16989    1     RETURN;

  16989  2 001201   000000 702200 xent               TSX2  ! X66_ARET

  16985  2 001202                       DONT75       null
      670    16990    1   DONT75: ;
      671    16991    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  16991  2 001202   000000 470400 xsym               LDP0    B$TCB$
         2 001203   000000 471500                    LDP1    0,,PR0
         2 001204   100102 236100                    LDQ     66,,PR1
         2 001205   000000 473400 xsym               LDP3    B$JIT$
         2 001206   300144 756100                    STQ     100,,PR3

      672    16992    1     ALTRETURN;

  16992  2 001207   000000 702200 xent               TSX2  ! X66_AALT

      673    16993                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:170  
      674    16994        /**********************************************************************/
      675    16995        /*F*   NAME:   CPE$ECHO
      676    16996               PURPOSE: The ECHO command is utilized to initiate echoing of
      677    16997                       commands being executed from a command file.
      678    16998               DESCRIPTION: The echo-command flag is turned on so that command
      679    16999                       file commands are echoed upon execution.
      680    17000               REFERENCE: Programmers Reference Manual
      681    17001        */
      682    17002        /*D*   NAME:   CPC$ECHO
      683    17003               CALL:   CALL CPC$ECHO(P$PCB)
      684    17004               INPUT:  BLK$ - pointer to parsed output
      685    17005               OUTPUT: B$JIT.CPFLAGS1.CP_ECHO# - echo command flag set
      686    17006               DESCRIPTION: The echo command flag is set in the JIT and
      687    17007                       subsequently tested to determine if command file
      688    17008                       commands should be echoed.
      689    17009        */
      690    17010        /**********************************************************************/
      691    17011    1   CPE$ECHO:
      692    17012    1     ENTRY(P$PCB)   ALTRET;

  17012  2 001210   000000 700200 xent  CPE$ECHO     TSX0  ! X66_AUTO_1
         2 001211   002450 000001                    ZERO    1320,1

      693    17013    1     B$JIT.CPFLAGS1.ECHO = %YES# ;

  17013  2 001212   000000 470400 xsym               LDP0    B$JIT$
         2 001213   000010 236007                    LDQ     8,DL
         2 001214   000143 256100                    ORSQ    99,,PR0

      694    17014    1     RETURN;

  17014  2 001215   000000 702200 xent               TSX2  ! X66_ARET

      695    17015                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:171  
      696    17016        /**********************************************************************/
      697    17017        /*F*   NAME:   CPE$EJECT
      698    17018               PURPOSE: The EJECT command causes the output device to do a
      699    17019                       page eject.
      700    17020               DESCRIPTION: The EJECT command will do an M$DEVICE with PAGE=YES.
      701    17021               REFERENCE: Programmers Reference Manual
      702    17022        */
      703    17023        /*D*   NAME:   CPE$EJECT
      704    17024               CALL:   CALL CPE$EJECT(P$PCB)
      705    17025               INPUT:  BLK$ - pointer to parsed output
      706    17026               OUTPUT:
      707    17027               DESCRIPTION: The EJECT command will do an M$DEVICE with PAGE=YES.
      708    17028        */
      709    17029        /**********************************************************************/
      710    17030    1   CPE$EJECT:
      711    17031    1     ENTRY(P$PCB)   ALTRET;

  17031  2 001216   000000 700200 xent  CPE$EJECT    TSX0  ! X66_AUTO_1
         2 001217   002450 000001                    ZERO    1320,1

      712    17032    1     FPT_DEVICE = CFPT_DEVICE ;

  17032  2 001220   000100 100400                    MLR     fill='000'O
         2 001221   000000 000050 xsym               ADSC9   CFPT_DEVICE              cn=0,n=40
         2 001222   201736 000050                    ADSC9   FPT_DEVICE,,AUTO         cn=0,n=40

      713    17033    1     FPT_DEVICE.V_ = VECTOR(FPT_DEVICE.V) ;

  17033  2 001223   000003 235000 3                  LDA     3
         2 001224   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 001225   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001226   001744 036003                    ADLQ    996,DU
         2 001227   201736 757100                    STAQ    FPT_DEVICE,,AUTO

      714    17034    1     BLK$ = P$PCB.OUT$;

  17034  2 001230   200003 470500                    LDP0    @P$PCB,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:172  
         2 001231   000003 236100                    LDQ     3,,PR0
         2 001232   200004 756100                    STQ     BLK$,,AUTO

      715    17035    1     IF BLK$ -> P$B.NSUBLKS = 0

  17035  2 001233   200004 471500                    LDP1    BLK$,,AUTO
         2 001234   100001 220100                    LDX0    1,,PR1
         2 001235   001251 601000 2                  TNZ     s:17045

      716    17036    1       THEN
      717    17037    2         DO;     /* EJECT */

      718    17038    2           CALL CPC$OPEN_LL ;

  17038  2 001236   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001237   000000 701000 xent               TSX1    CPC$OPEN_LL
         2 001240   000000 011000                    NOP     0

      719    17039    2           DCB# = SEG$2.LLDCB# ;

  17039  2 001241   000000 470400 xsym               LDP0    SEG2$
         2 001242   000000 236100                    LDQ     0,,PR0
         2 001243   777777 376007                    ANQ     -1,DL
         2 001244   200007 756100                    STQ     DCB#,,AUTO

      720    17040    2           FPT_DEVICE.V.PAGE# = %YES# ;

  17040  2 001245   100000 236007                    LDQ     32768,DL
         2 001246   201744 256100                    ORSQ    FPT_DEVICE+6,,AUTO

      721    17041    2           STREAM_OPEN = %NO#;

  17041  2 001247   200017 450100                    STZ     STREAM_OPEN,,AUTO

      722    17042    2         END;  /* Then Do */

  17042  2 001250   001374 710000 2                  TRA     s:17066
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:173  

      723    17043    1       ELSE
      724    17044    2         DO;     /* EJECT LDEVnn */

      725    17045    2           IF BLK$ -> P$B.SUBLK$(0) -> P$B.NSUBLKS = 1

  17045  2 001251   100003 473500                    LDP3    3,,PR1
         2 001252   300001 221100                    LDX1    1,,PR3
         2 001253   000001 101003                    CMPX1   1,DU
         2 001254   001265 601000 2                  TNZ     s:17049

      726    17046    2             THEN
      727    17047    2               RES# = BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) -> P$S.TEXT;

  17047  2 001255   300003 474500                    LDP4    3,,PR3
         2 001256   400004 236100                    LDQ     4,,PR4
         2 001257   000033 772000                    QRL     27
         2 001260   000000 622006                    EAX2    0,QL
         2 001261   040100 100540                    MLR     fill='040'O
         2 001262   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         2 001263   200020 000004                    ADSC9   RES#,,AUTO               cn=0,n=4
         2 001264   001314 710000 2                  TRA     s:17051

      728    17048    2             ELSE
      729    17049    2               CALL CONCAT(RES#, BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) -> P$S.TEXT,

  17049  2 001265   300003 474500                    LDP4    3,,PR3
         2 001266   400004 236100                    LDQ     4,,PR4
         2 001267   000033 772000                    QRL     27
         2 001270   300004 475500                    LDP5    4,,PR3
         2 001271   000000 622006                    EAX2    0,QL
         2 001272   500004 236100                    LDQ     4,,PR5
         2 001273   000033 772000                    QRL     27
         2 001274   040100 100540                    MLR     fill='040'O
         2 001275   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         2 001276   200020 000004                    ADSC9   RES#,,AUTO               cn=0,n=4
         2 001277   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:174  
         2 001300   000000 636012                    EAQ     0,X2
         2 001301   000022 772000                    QRL     18
         2 001302   000004 116007                    CMPQ    4,DL
         2 001303   001314 603000 2                  TRC     s:17051
         2 001304   202352 742100                    STX2    CLSDCB+30,,AUTO
         2 001305   777773 622012                    EAX2    -5,X2
         2 001306   777777 662003                    ERX2    -1,DU
         2 001307   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001310   000022 772000                    QRL     18
         2 001311   040146 100540                    MLR     fill='040'O
         2 001312   500004 200010                    ADSC9   4,,PR5                   cn=1,n=*X0
         2 001313   200020 000012                    ADSC9   RES#,Q,AUTO              cn=0,n=*X2

      730    17050    2                                 BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(1) -> P$S.TEXT);
      731    17051    2           CALL FIND_OR_CREATE_STREAM(RES#, %NO#, DCB#, STREAM_OPEN) WHENALTRETURN

  17051  2 001314   200017 631500                    EPPR1   STREAM_OPEN,,AUTO
         2 001315   202076 451500                    STP1    @DCB#+1,,AUTO
         2 001316   200007 633500                    EPPR3   DCB#,,AUTO
         2 001317   202075 453500                    STP3    @CREATE_FLG+1,,AUTO
         2 001320   000027 236000 3                  LDQ     23
         2 001321   202074 756100                    STQ     @RES#+1,,AUTO
         2 001322   200020 634500                    EPPR4   RES#,,AUTO
         2 001323   202073 454500                    STP4    VLP_SN+5,,AUTO
         2 001324   017346 701000 2                  TSX1    FIND_OR_CREATE_STREAM
         2 001325   001327 702000 2                  TSX2    s:17053
         2 001326   001352 710000 2                  TRA     s:17059

      732    17052    3                                      DO;

      733    17053    3                                        BAD_LDEV_NAME.SIZ = 4;

  17053  2 001327   004000 236003                    LDQ     2048,DU
         2 001330   200511 552140                    STBQ    BAD_LDEV_NAME,'40'O,AUTO

      734    17054    3                                        BAD_LDEV_NAME.TEXT = RES#;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:175  
  17054  2 001331   040100 100500                    MLR     fill='040'O
         2 001332   200020 000004                    ADSC9   RES#,,AUTO               cn=0,n=4
         2 001333   200511 200004                    ADSC9   BAD_LDEV_NAME,,AUTO      cn=1,n=4

      735    17055    3                                       CALL CPC$WRITEMSGE(E_NOSUCHLDEV,,BAD_LDEV_NAME,
             17055                                                 ,,%YES#);

  17055  2 001334   000001 236000 3                  LDQ     1
         2 001335   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001336   202356 757100                    STAQ    CLSDCB+34,,AUTO
         2 001337   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001340   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 001341   200511 630500                    EPPR0   BAD_LDEV_NAME,,AUTO
         2 001342   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 001343   000030 235000 3                  LDA     24
         2 001344   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 001345   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 001346   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001347   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 001350   000000 011000                    NOP     0

      736    17056    3                                        GOTO EJECT_RET;

  17056  2 001351   001407 710000 2                  TRA     EJECT_RET

      737    17057    3                                      END;  /* Whenaltreturn Do */
      738    17058
      739    17059    2           IF BLK$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) -> P$S.TEXT = 'UC' AND

  17059  2 001352   200004 470500                    LDP0    BLK$,,AUTO
         2 001353   000003 471500                    LDP1    3,,PR0
         2 001354   100003 473500                    LDP3    3,,PR1
         2 001355   300004 236100                    LDQ     4,,PR3
         2 001356   000033 772000                    QRL     27
         2 001357   000000 620006                    EAX0    0,QL
         2 001360   040000 106540                    CMPC    fill='040'O
         2 001361   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:176  
         2 001362   001034 000002 1                  ADSC9   CONSTCLS+30              cn=0,n=2
         2 001363   001372 601000 2                  TNZ     s:17064
         2 001364   100001 221100                    LDX1    1,,PR1
         2 001365   000002 101003                    CMPX1   2,DU
         2 001366   001372 601000 2                  TNZ     s:17064

      740    17060    2                   BLK$ -> P$B.SUBLK$(0) -> P$B.NSUBLKS = 2  /* UCnn */
      741    17061    2             THEN
      742    17062    2               FPT_DEVICE.V.CLEAR# = %YES# ;

  17062  2 001367   040000 236007                    LDQ     16384,DL
         2 001370   201744 256100                    ORSQ    FPT_DEVICE+6,,AUTO
         2 001371   001374 710000 2                  TRA     s:17066

      743    17063    2             ELSE
      744    17064    2               FPT_DEVICE.V.PAGE# = %YES# ;

  17064  2 001372   100000 236007                    LDQ     32768,DL
         2 001373   201744 256100                    ORSQ    FPT_DEVICE+6,,AUTO

      745    17065    2         END;  /* Else Do */

      746    17066    1     FPT_DEVICE.V.DCB# = DCB#;

  17066  2 001374   200007 720100                    LXL0    DCB#,,AUTO
         2 001375   201744 740100                    STX0    FPT_DEVICE+6,,AUTO

      747    17067    1     CALL M$DEVICE(FPT_DEVICE) ;

  17067  2 001376   201736 630500                    EPPR0   FPT_DEVICE,,AUTO
         2 001377   050006 713400                    CLIMB   20486
         2 001400   401000 401760                    pmme    nvectors=3

      748    17068
      749    17069    1     IF STREAM_OPEN

  17069  2 001401   200017 234100                    SZN     STREAM_OPEN,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:177  
         2 001402   001407 605000 2                  TPL     EJECT_RET

      750    17070    1       THEN
      751    17071    1         CALL CLOSE_DCB(DCB#);

  17071  2 001403   200007 630500                    EPPR0   DCB#,,AUTO
         2 001404   202313 450500                    STP0    TBUFF+3,,AUTO
         2 001405   017561 701000 2                  TSX1    CLOSE_DCB
         2 001406   000000 011000                    NOP     0

      752    17072
      753    17073    1   EJECT_RET:
      754    17074    1     RETURN;

  17074  2 001407   000000 702200 xent  EJECT_RET    TSX2  ! X66_ARET

      755    17075
      756    17076          %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:178  
      757    17077                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:179  
      758    17078        /**********************************************************************/
      759    17079        /*F*   NAME:   CPE$EXPOUND
      760    17080               PURPOSE: The EXPOUND command is utilized to request the long (naive-user)
      761    17081                       error-reporting dialog (i.e., print useful suggestions).
      762    17082               DESCRIPTION: The expound flag is turned on so that the XUG$COMMON package
      763    17083                       will choose to print useful hints when an error occurs.
      764    17084               REFERENCE: Programmers Reference Manual
      765    17085        */
      766    17086        /*D*   NAME:   CPC$EXPOUND
      767    17087               CALL:   CALL CPC$EXPOUND(P$PCB)
      768    17088               INPUT:  BLK$ - pointer to parsed output
      769    17089               OUTPUT: B$JIT.PRFLAGS.EXPOUND - expound flag set
      770    17090               DESCRIPTION: The expound flag is set in the JIT and
      771    17091                       subsequently tested to determine if hints should be
      772    17092                       provided to the user after a syntax error occurs.
      773    17093        */
      774    17094        /**********************************************************************/
      775    17095    1   CPE$EXPOUND:
      776    17096    1     ENTRY(P$PCB)   ALTRET;

  17096  2 001410   000000 700200 xent  CPE$EXPOUND  TSX0  ! X66_AUTO_1
         2 001411   002450 000001                    ZERO    1320,1

      777    17097    1     B$JIT.PRFLAGS.EXPOUND = %YES#;

  17097  2 001412   000000 470400 xsym               LDP0    B$JIT$
         2 001413   000100 236003                    LDQ     64,DU
         2 001414   000030 256100                    ORSQ    24,,PR0

      778    17098    1     RETURN;

  17098  2 001415   000000 702200 xent               TSX2  ! X66_ARET

      779    17099                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:180  
      780    17100        /**********************************************************************/
      781    17101        /*F*   NAME:   CPE$LIST
      782    17102               PURPOSE: The LIST command is utilized by a user to direct the
      783    17103                       destination of listing output before calling a
      784    17104                       processor. It is also used to turn on listing output which
      785    17105                       was previously interrupted and turned off by the DONT LIST
      786    17106                       command.
      787    17107               DESCRIPTION: The list flag is turned on if the reinitiating of
      788    17108                       listing output is desired. If ON/OVER/INTO listout is
      789    17109                       specified, an assignment is made for output to go to the
      790    17110                       specified file, device or device stream. By default,
      791    17111                       listing output is always turned on at job step beginning.
      792    17112               REFERENCE: Programmers Reference Manual
      793    17113        */
      794    17114        /*D*   NAME:   CPE$LIST
      795    17115               CALL:   CALL CPE$LIST(P$PCB)
      796    17116               INTERFACE: CPE$GENRUAM,CPC$WRITEMSGE
      797    17117               INPUT:  BLK$ - pointer to parsed output
      798    17118               OUTPUT: Keyed assign merge record to *A file(key for listout=#4)
      799    17119                       B$JIT.FEXT - file extension bit reset for listout
      800    17120                       B$JIT.PRFLAGS.LS - flag set indicating listout dcb assigned
      801    17121                       B$JIT.PRFLAGS.LIST - flag set indicating LIST command executed
      802    17122               DESCRIPTION: If LIST only is specified, listing output is
      803    17123                       reinitiated by turning on the list flag in the JIT. If
      804    17124                       ON/OVER/INTO listout is specified, a check is made to determine
      805    17125                       whether the command is being executed at job step.
      806    17126                       An assign merge record is generated with destination
      807    17127                       information specified by listout. The key associated with
      808    17128                       the record is #4. File extension is reset for listout as
      809    17129                       this is a new assignment. Flags are set to indicate the
      810    17130                       fourth command-line dcb is assigned and to indicate a LIST
      811    17131                       command was executed.
      812    17132        */
      813    17133        /**********************************************************************/
      814    17134    1   CPE$LIST:
      815    17135    1     ENTRY(P$PCB)   ALTRET;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:181  
  17135  2 001416   000000 700200 xent  CPE$LIST     TSX0  ! X66_AUTO_1
         2 001417   002450 000001                    ZERO    1320,1

      816    17136        /**/
      817    17137    1     BLK$ = P$PCB.OUT$;

  17137  2 001420   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001421   000003 236100                    LDQ     3,,PR0
         2 001422   200004 756100                    STQ     BLK$,,AUTO

      818    17138        /*
      819    17139          **** No options after list indicates function change
      820    17140        */
      821    17141    1     IF (BLK$->P$B.NSUBLKS=0)

  17141  2 001423   200004 471500                    LDP1    BLK$,,AUTO
         2 001424   100001 220100                    LDX0    1,,PR1
         2 001425   001432 601000 2                  TNZ     s:17151

      822    17142    1        THEN
      823    17143    2           DO;

      824    17144                                                /* Set list to on                     */
      825    17145    2              B$JIT.PRFLAGS.LIST=%YES#;

  17145  2 001426   000000 473400 xsym               LDP3    B$JIT$
         2 001427   010000 236003                    LDQ     4096,DU
         2 001430   300030 256100                    ORSQ    24,,PR3

      826    17146    2              RETURN;

  17146  2 001431   000000 702200 xent               TSX2  ! X66_ARET

      827    17147    2           END;
      828    17148        /*
      829    17149          **** Must be at job step to direct output
      830    17150        */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:182  
      831    17151    1     IF NOT B$JIT.CPFLAGS1.JSTEP

  17151  2 001432   000000 473400 xsym               LDP3    B$JIT$
         2 001433   300143 236100                    LDQ     99,,PR3
         2 001434   200000 316003                    CANQ    65536,DU
         2 001435   001473 600000 2                  TZE     LIST70

      832    17152    1        THEN
      833    17153    1           GOTO LIST70;
      834    17154        /*
      835    17155          **** Create assign merge record for LISTOUT(#4)
      836    17156        */
      837    17157    1     ONOVERINTO$=BLK$->P$B.SUBLK$(0); /*Bld ptr to keyword*/

  17157  2 001436   100003 236100                    LDQ     3,,PR1
         2 001437   200005 756100                    STQ     ONOVERINTO$,,AUTO

      838    17158    1     FID$=BLK$->P$B.SUBLK$(1)->P$B.SUBLK$(0); /*Bld ptr to fid*/

  17158  2 001440   100004 474500                    LDP4    4,,PR1
         2 001441   400003 236100                    LDQ     3,,PR4
         2 001442   200006 756100                    STQ     FID$,,AUTO

      839    17159    1     CALL CPE$GENRUAM(BLK$,ONOVERINTO$,FID$,ADDR(LISTDCB),'1'B) ALTRET(LIST80);

  17159  2 001443   000031 236000 3                  LDQ     25
         2 001444   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 001445   000001 236000 3                  LDQ     1
         2 001446   202357 756100                    STQ     CLSDCB+35,,AUTO
         2 001447   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 001450   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 001451   200006 635500                    EPPR5   FID$,,AUTO
         2 001452   202355 455500                    STP5    CLSDCB+33,,AUTO
         2 001453   200005 636500                    EPPR6   ONOVERINTO$,,AUTO
         2 001454   202354 456500                    STP6    CLSDCB+32,,AUTO
         2 001455   200004 637500                    EPPR7   BLK$,,AUTO
         2 001456   202353 457500                    STP7    CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:183  
         2 001457   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 001460   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001461   000000 701000 xent               TSX1    CPE$GENRUAM
         2 001462   001507 702000 2                  TSX2    LIST80

      840    17160    1     B$JIT.FEXT(FEXT_LIST)=%NO#; /*Reset file extension*/

  17160  2 001463   000000 470400 xsym               LDP0    B$JIT$
         2 001464   000015 236000 3                  LDQ     13
         2 001465   000220 356100                    ANSQ    144,,PR0

      841    17161    1     B$JIT.PRFLAGS.LS=%YES#;  /*Indicate listout assigned*/

  17161  2 001466   040000 236003                    LDQ     16384,DU
         2 001467   000030 256100                    ORSQ    24,,PR0

      842    17162    1     B$JIT.PRFLAGS.LIST=%YES#; /*Set  list cmnd flag*/

  17162  2 001470   010000 236003                    LDQ     4096,DU
         2 001471   000030 256100                    ORSQ    24,,PR0

      843    17163    1     RETURN;

  17163  2 001472   000000 702200 xent               TSX2  ! X66_ARET

  17162  2 001473                       LIST70       null
      844    17164    1   LIST70: ;
      845    17165    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_QUIT);

  17165  2 001473   000000 236000 xsym               LDQ     SEG2$
         2 001474   000003 036003                    ADLQ    3,DU
         2 001475   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 001476   000004 237000 3                  LDAQ    4
         2 001477   202354 757100                    STAQ    CLSDCB+32,,AUTO
         2 001500   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 001501   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 001502   202353 630500                    EPPR0   CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:184  
         2 001503   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001504   000000 701000 xent               TSX1    CXP$POSTERR
         2 001505   000000 011000                    NOP     0

      846    17166    1     ALTRETURN;

  17166  2 001506   000000 702200 xent               TSX2  ! X66_AALT

  17162  2 001507                       LIST80       null
      847    17167    1   LIST80: ;
      848    17168    1     ALTRETURN;

  17168  2 001507   000000 702200 xent               TSX2  ! X66_AALT

      849    17169                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:185  
      850    17170        /**********************************************************************/
      851    17171        /*F*   NAME:   CPE$PASSWORD
      852    17172               PURPOSE: The PASSWORD command is utilized by a user to create,
      853    17173                       delete, or modify his logon password. Security is enforced
      854    17174                       by requiring the old passwprd to be specified before the new
      855    17175                       password is entered.
      856    17176               DESCRIPTION: The user's record is read from the :HLP file
      857    17177                       and the old password
      858    17178                       , if specified by the user, is compared with the current
      859    17179                       password. If it matches, the new password is stored in the
      860    17180                       :HLP   record. If a new password is not specified, the old
      861    17181                       password in the :HLP   record is reset.
      862    17182               REFERENCE: Programmers Reference Manual
      863    17183        */
      864    17184        /*D*   NAME:   CPE$PASSWORD
      865    17185               CALL:   CALL CPE$PASSWORD(P$PCB)
      866    17186               INTERFACE: CPC$RDUSERS,CPC$WRUSERS
      867    17187               INPUT:  BLK$ - pointer to parsed output
      868    17188               OUTPUT: modified :HLP   record
      869    17189               DESCRIPTION: The :HLP   record is read in and a determination made
      870    17190                       if the old password is  specified on the PASSWORD command.
      871    17191                       If the old password is  specified, it is compared with the
      872    17192                       :HLP   password. If the passwords are the same, the modification
      873    17193                       or resetting of the password in :HLP is permitted.
      874    17194                       Establishing a new password without specifying the old
      875    17195                       password is permitted if one does not already exist. If a new
      876    17196                       password is not specified, the old password in :HLP is
      877    17197                       reset. Password scrambling is performed for all passwords.
      878    17198        */
      879    17199        /***********************************************************************/
      880    17200    1   CPE$PASSWORD:
      881    17201    1     ENTRY(P$PCB)   ALTRET;

  17201  2 001510   000000 700200 xent  CPE$PASSWORD TSX0  ! X66_AUTO_1
         2 001511   002450 000001                    ZERO    1320,1

      882    17202        /**/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:186  
      883    17203    1     BLK$ = P$PCB.OUT$;

  17203  2 001512   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001513   000003 236100                    LDQ     3,,PR0
         2 001514   200004 756100                    STQ     BLK$,,AUTO

      884    17204        /*
      885    17205          **** Read in users record from :HLP
      886    17206        */
      887    17207    1     CALL CPC$RDHLP (M$IBEX1_NUM,%UPDATE#) ALTRET(PASSWORD50);

  17207  2 001515   000032 630400 3                  EPPR0   26
         2 001516   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001517   000000 701000 xent               TSX1    CPC$RDHLP
         2 001520   001670 702000 2                  TSX2    PASSWORD50

      888    17208        /*
      889    17209          ****  No option after password infers ... Account is not passworded or
      890    17210          ****  User forgot to specify the password.
      891    17211        */
      892    17212    1     OLDPASSWORD=' ';

  17212  2 001521   000035 235000 xsym               LDA     B_VECTNIL+29
         2 001522   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001523   200030 757100                    STAQ    OLDPASSWORD,,AUTO

      893    17213    1     NEWPASSWORD=' ';

  17213  2 001524   000035 235000 xsym               LDA     B_VECTNIL+29
         2 001525   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001526   200032 757100                    STAQ    NEWPASSWORD,,AUTO

      894    17214    1     I=0;

  17214  2 001527   200472 450100                    STZ     I,,AUTO

      895    17215    1     IF (BLK$->P$B.NSUBLKS~=0)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:187  

  17215  2 001530   200004 470500                    LDP0    BLK$,,AUTO
         2 001531   000001 220100                    LDX0    1,,PR0
         2 001532   001601 600000 2                  TZE     s:17230

      896    17216    1        THEN
      897    17217    2   PASS5:  DO WHILE (I<BLK$->P$B.NSUBLKS);

  17217  2 001533   000001 236100       PASS5        LDQ     1,,PR0
         2 001534   000022 772000                    QRL     18
         2 001535   200472 116100                    CMPQ    I,,AUTO
         2 001536   001601 602000 2                  TNC     s:17230
         2 001537   001601 600000 2                  TZE     s:17230

      898    17218    2              TEMP$=BLK$->P$B.SUBLK$(I);

  17218  2 001540   200004 470500                    LDP0    BLK$,,AUTO
         2 001541   200472 720100                    LXL0    I,,AUTO
         2 001542   000003 236110                    LDQ     3,X0,PR0
         2 001543   200011 756100                    STQ     TEMP$,,AUTO

      899    17219    3   PASS10:    DO CASE(TEMP$->P$B.CODE);

  17219  2 001544   200011 471500       PASS10       LDP1    TEMP$,,AUTO
         2 001545   100000 721100                    LXL1    0,,PR1
         2 001546   000003 101003                    CMPX1   3,DU
         2 001547   001551 602011 2                  TNC     PASS10+5,X1
         2 001550   001571 710000 2                  TRA     s:17225
         2 001551   001571 710000 2                  TRA     s:17225
         2 001552   001554 710000 2                  TRA     s:17221
         2 001553   001563 710000 2                  TRA     s:17223

      900    17220    3               CASE(OLDPASSWDOPT);

      901    17221    3                 OLDPASSWORD=TEMP$->P$S.TEXT;

  17221  2 001554   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:188  
         2 001555   000033 772000                    QRL     27
         2 001556   000000 622006                    EAX2    0,QL
         2 001557   040100 100540                    MLR     fill='040'O
         2 001560   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 001561   200030 000010                    ADSC9   OLDPASSWORD,,AUTO        cn=0,n=8
         2 001562   001571 710000 2                  TRA     s:17225

      902    17222    3               CASE(NEWPASSWDOPT);

      903    17223    3                 NEWPASSWORD=TEMP$->P$S.TEXT;

  17223  2 001563   100004 236100                    LDQ     4,,PR1
         2 001564   000033 772000                    QRL     27
         2 001565   000000 622006                    EAX2    0,QL
         2 001566   040100 100540                    MLR     fill='040'O
         2 001567   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 001570   200032 000010                    ADSC9   NEWPASSWORD,,AUTO        cn=0,n=8

      904    17224    3               END PASS10;

      905    17225    2              I=I+1;

  17225  2 001571   200472 235100                    LDA     I,,AUTO
         2 001572   000001 035007                    ADLA    1,DL
         2 001573   200472 755100                    STA     I,,AUTO

      906    17226    2           END PASS5;

  17226  2 001574   000001 236100                    LDQ     1,,PR0
         2 001575   000022 772000                    QRL     18
         2 001576   200472 116100                    CMPQ    I,,AUTO
         2 001577   001601 600000 2                  TZE     s:17230
         2 001600   001540 603000 2                  TRC     s:17218

      907    17227        /*
      908    17228          ****  Scramble the passwords ... Assuming its O.K to scramble blanks
      909    17229        */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:189  
      910    17230    1     CALL ASZ$SCRAMBLE(OLDPASSWORD);                        /*Scramble old password*/

  17230  2 001601   200030 631500                    EPPR1   OLDPASSWORD,,AUTO
         2 001602   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 001603   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 001604   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001605   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         2 001606   000000 011000                    NOP     0

      911    17231    1     CALL ASZ$SCRAMBLE(NEWPASSWORD);                        /*Scramble new password*/

  17231  2 001607   200032 630500                    EPPR0   NEWPASSWORD,,AUTO
         2 001610   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 001611   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 001612   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001613   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         2 001614   000000 011000                    NOP     0

      912    17232        /*
      913    17233          ****  Check if old password matches password in :HLP
      914    17234        */
      915    17235    1     IF OLDPASSWORD ~= SEG$2.HLP$ -> KL$DREC.PASSWORD

  17235  2 001615   000000 470400 xsym               LDP0    SEG2$
         2 001616   000153 471500                    LDP1    107,,PR0
         2 001617   040100 106500                    CMPC    fill='040'O
         2 001620   200030 000010                    ADSC9   OLDPASSWORD,,AUTO        cn=0,n=8
         2 001621   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         2 001622   001671 601000 2                  TNZ     PASSWORD60

      916    17236
      917    17237    1        THEN /* passwords dont match */
      918    17238    1           GOTO PASSWORD60;
      919    17239        /*
      920    17240          ****  O.K. To modify :HLP .... Reset to blanks if new pass. Wasn't spec'd
      921    17241        */
      922    17242    1     SEG$2.HLP$ -> KL$DREC.PASSWORD = NEWPASSWORD;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:190  

  17242  2 001623   200032 237100                    LDAQ    NEWPASSWORD,,AUTO
         2 001624   100002 755100                    STA     2,,PR1
         2 001625   100003 756100                    STQ     3,,PR1

      923    17243    1     CALL CPC$WRHLP (M$IBEX1_NUM) ALTRET(PASSWORD50);

  17243  2 001626   000006 630400 3                  EPPR0   6
         2 001627   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001630   000000 701000 xent               TSX1    CPC$WRHLP
         2 001631   001670 702000 2                  TSX2    PASSWORD50

      924    17244        /*
      925    17245          **** Close and save :HLP
      926    17246        */
      927    17247    1     FPT_CLOSE = CFPT_CLOSE;

  17247  2 001632   000100 100400                    MLR     fill='000'O
         2 001633   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 001634   201676 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      928    17248    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  17248  2 001635   000003 235000 3                  LDA     3
         2 001636   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 001637   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001640   001730 036003                    ADLQ    984,DU
         2 001641   201676 757100                    STAQ    FPT_CLOSE,,AUTO

      929    17249    1     FPT_CLOSE.V.DCB#=M$IBEX1_NUM;

  17249  2 001642   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001643   201730 740100                    STX0    FPT_CLOSE+26,,AUTO

      930    17250    1     FPT_CLOSE.V.DISP#=%SAVE#;

  17250  2 001644   000002 236007                    LDQ     2,DL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:191  
         2 001645   201730 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      931    17251    1     CALL M$CLOSE(FPT_CLOSE) ALTRET(PASSWORD70);

  17251  2 001646   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001647   450001 713400                    CLIMB   alt,close
         2 001650   406000 401760                    pmme    nvectors=13
         2 001651   001726 702000 2                  TSX2    PASSWORD70

      932    17252        /*E*       ERROR: CPE-E$PASSCHNGE-C
      933    17253               MESSAGE: Password change successful
      934    17254                   DESCRIPTION: The password in the :HLP   file was modified
      935    17255                                using the PASSWORD command.
      936    17256        */
      937    17257    1     CALL CPC$WRITEMSGE(E_PASSCHNGE,,,,,%YES#);

  17257  2 001652   000001 236000 3                  LDQ     1
         2 001653   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001654   202356 757100                    STAQ    CLSDCB+34,,AUTO
         2 001655   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001656   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001657   202354 757100                    STAQ    CLSDCB+32,,AUTO
         2 001660   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001661   000034 235000 3                  LDA     28
         2 001662   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 001663   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 001664   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001665   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 001666   000000 011000                    NOP     0

      938    17258    1     RETURN;

  17258  2 001667   000000 702200 xent               TSX2  ! X66_ARET

  17250  2 001670                       PASSWORD50   null
      939    17259    1   PASSWORD50:;
      940    17260    1     ALTRETURN;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:192  

  17260  2 001670   000000 702200 xent               TSX2  ! X66_AALT

  17250  2 001671                       PASSWORD60   null
      941    17261    1   PASSWORD60:;
      942    17262        /*E*       ERROR: CPE-E$BADPASS-E
      943    17263               MESSAGE: Password supplied doesn't match current password
      944    17264                   DESCRIPTION: The old password specified on the PASSWORD command
      945    17265                                doesn't correspond with the :HLP   password.
      946    17266        */
      947    17267    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_BADPASS);

  17267  2 001671   000000 236000 xsym               LDQ     SEG2$
         2 001672   000003 036003                    ADLQ    3,DU
         2 001673   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 001674   000036 237000 3                  LDAQ    30
         2 001675   202354 757100                    STAQ    CLSDCB+32,,AUTO
         2 001676   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 001677   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 001700   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 001701   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001702   000000 701000 xent               TSX1    CXP$POSTERR
         2 001703   000000 011000                    NOP     0

      948    17268    1     GOTO PASSWORD68;

  17268  2 001704   001705 710000 2                  TRA     PASSWORD68

  17268  2 001705                       PASSWORD68   null
      949    17269    1   PASSWORD68:;
      950    17270        /* Close dcb */
      951    17271    1     FPT_CLOSE = CFPT_CLOSE;

  17271  2 001705   000100 100400                    MLR     fill='000'O
         2 001706   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 001707   201676 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:193  
      952    17272    1     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  17272  2 001710   000003 235000 3                  LDA     3
         2 001711   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 001712   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001713   001730 036003                    ADLQ    984,DU
         2 001714   201676 757100                    STAQ    FPT_CLOSE,,AUTO

      953    17273    1     FPT_CLOSE.V.DCB#=M$IBEX1_NUM;

  17273  2 001715   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001716   201730 740100                    STX0    FPT_CLOSE+26,,AUTO

      954    17274    1     FPT_CLOSE.V.DISP#=%SAVE#;

  17274  2 001717   000002 236007                    LDQ     2,DL
         2 001720   201730 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      955    17275    1     CALL M$CLOSE(FPT_CLOSE) ALTRET(PASSWORD70);

  17275  2 001721   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001722   450001 713400                    CLIMB   alt,close
         2 001723   406000 401760                    pmme    nvectors=13
         2 001724   001726 702000 2                  TSX2    PASSWORD70

      956    17276    1     ALTRETURN;

  17276  2 001725   000000 702200 xent               TSX2  ! X66_AALT

  17274  2 001726                       PASSWORD70   null
      957    17277    1   PASSWORD70:;
      958    17278    1     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  17278  2 001726   000000 470400 xsym               LDP0    B$TCB$
         2 001727   000000 471500                    LDP1    0,,PR0
         2 001730   100102 236100                    LDQ     66,,PR1
         2 001731   000000 473400 xsym               LDP3    B$JIT$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:194  
         2 001732   300144 756100                    STQ     100,,PR3

      959    17279    1     ALTRETURN;

  17279  2 001733   000000 702200 xent               TSX2  ! X66_AALT

      960    17280                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:195  
      961    17281        /*F*    NAME:    CPE$POINT
      962    17282                PURPOSE:    This entry point processes the IBEX POINT command.
      963    17283                         When the "POINT" flag is set, the XUG$ERRPTR routine (used
      964    17284                         in many places throughout the system) will indicate the
      965    17285                         location of an error with a single "^".  When POINT is reset,
      966    17286                         a more accurate, but verbose indication is given.
      967    17287        */
      968    17288    1   CPE$POINT:
      969    17289    1     ENTRY(P$PCB)   ALTRET;

  17289  2 001734   000000 700200 xent  CPE$POINT    TSX0  ! X66_AUTO_1
         2 001735   002450 000001                    ZERO    1320,1

      970    17290        /**/
      971    17291    1     B$JIT.PRFLAGS.POINT = %YES#;

  17291  2 001736   000000 470400 xsym               LDP0    B$JIT$
         2 001737   000200 236003                    LDQ     128,DU
         2 001740   000030 256100                    ORSQ    24,,PR0

      972    17292    1     RETURN;

  17292  2 001741   000000 702200 xent               TSX2  ! X66_ARET

      973    17293        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:196  
      974    17294        /*F*    NAME:    CPE$POSITION
      975    17295                PURPOSE:    This entry point processes the IBEX POSITION command.
      976    17296                         When the POSITION flag is set, the XUG$ERRPTR routine (used
      977    17297                         in many places throughout the system) will issue an M$SINPUT
      978    17298                         service which has the effect of repositioning the user's
      979    17299                         escape-D cursor to the position of the first error reported.
      980    17300        */
      981    17301    1   CPE$POSITION:
      982    17302    1     ENTRY(P$PCB)   ALTRET;

  17302  2 001742   000000 700200 xent  CPE$POSITION TSX0  ! X66_AUTO_1
         2 001743   002450 000001                    ZERO    1320,1

      983    17303        /**/
      984    17304    1     B$JIT.PRFLAGS.POSITION = %YES#;

  17304  2 001744   000000 470400 xsym               LDP0    B$JIT$
         2 001745   000040 236003                    LDQ     32,DU
         2 001746   000030 256100                    ORSQ    24,,PR0

      985    17305    1     RETURN;

  17305  2 001747   000000 702200 xent               TSX2  ! X66_ARET

      986    17306        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:197  
      987    17307        /*F*    NAME:    CPE$PROTECT
      988    17308                PURPOSE:    This entry point processes the IBEX PROTECT command.
      989    17309                         When IBEX is running in PROTECT mode, the user is prompted
      990    17310                         with a QUIT? message whenever processing his command would
      991    17311                         result in a run-down of an interrupted activity, e.g. calling
      992    17312                         a new program at Control-Y time.
      993    17313        */
      994    17314    1   CPE$PROTECT:
      995    17315    1     ENTRY(P$PCB)   ALTRET;

  17315  2 001750   000000 700200 xent  CPE$PROTECT  TSX0  ! X66_AUTO_1
         2 001751   002450 000001                    ZERO    1320,1

      996    17316        /**/
      997    17317    1     B$JIT.CPFLAGS1.PROTECT = %YES# ;

  17317  2 001752   000000 470400 xsym               LDP0    B$JIT$
         2 001753   000100 236007                    LDQ     64,DL
         2 001754   000143 256100                    ORSQ    99,,PR0

      998    17318    1     RETURN;

  17318  2 001755   000000 702200 xent               TSX2  ! X66_ARET

      999    17319        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:198  
     1000    17320        /***********************************************************************/
     1001    17321        /*F*   NAME:   CPE$TIME
     1002    17322               PURPOSE: The TIME command is utilized to determine the time and date.
     1003    17323               DESCRIPTION: The time and date is output to the user.
     1004    17324        */
     1005    17325        /*     NAME:   CPE$TIME
     1006    17326               CALL:   Call CPE$TIME(P$PCB)
     1007    17327               INTERFACE: CPE$LIST
     1008    17328               INPUT:  BLK$ - pointer to parsed output
     1009    17329               OUTPUT: output through M$LL
     1010    17330               DESCRIPTION: The time and date is output to  the appropriate device.
     1011    17331                       The time and date is output through M$UC if in interactive
     1012    17332                       mode, otherwise through M$LL.
     1013    17333        */
     1014    17334        /***********************************************************************/
     1015    17335    1   CPE$TIME:
     1016    17336    1     ENTRY(P$PCB)   ALTRET;

  17336  2 001756   000000 700200 xent  CPE$TIME     TSX0  ! X66_AUTO_1
         2 001757   002450 000001                    ZERO    1320,1

     1017    17337    1     TMDATEBUFF=' ';                       /*Blank out buffer*/

  17337  2 001760   040100 100400                    MLR     fill='040'O
         2 001761   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001762   200477 000032                    ADSC9   TMDATE,,AUTO             cn=0,n=26

     1018    17338    1     FPT_TIME = CFPT_TIME;

  17338  2 001763   000100 100400                    MLR     fill='000'O
         2 001764   000000 000060 xsym               ADSC9   CFPT_TIME                cn=0,n=48
         2 001765   201662 000060                    ADSC9   FPT_TIME,,AUTO           cn=0,n=48

     1019    17339    1     FPT_TIME.V_ = VECTOR(FPT_TIME.V);

  17339  2 001766   000023 235000 3                  LDA     19
         2 001767   202352 452500                    STP2    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:199  
         2 001770   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001771   001674 036003                    ADLQ    956,DU
         2 001772   201662 757100                    STAQ    FPT_TIME,,AUTO

     1020    17340    1     FPT_TIME.DATE_=VECTOR(TMDATE.DATE);

  17340  2 001773   000040 235000 3                  LDA     32
         2 001774   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 001775   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 001776   000041 036000 3                  ADLQ    33
         2 001777   201664 757100                    STAQ    FPT_TIME+2,,AUTO

     1021    17341    1     FPT_TIME.TIME_=VECTOR(TMDATE.TIME);

  17341  2 002000   000042 235000 3                  LDA     34
         2 002001   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002002   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002003   000043 036000 3                  ADLQ    35
         2 002004   201666 757100                    STAQ    FPT_TIME+4,,AUTO

     1022    17342    1     CALL M$TIME(FPT_TIME);

  17342  2 002005   201662 630500                    EPPR0   FPT_TIME,,AUTO
         2 002006   020004 713400                    CLIMB   8196
         2 002007   402000 401760                    pmme    nvectors=5

     1023    17343    1     TMDATE.TIME.SEC=' ';                  /*Do'nt print SEC.*/

  17343  2 002010   000044 236000 3                  LDQ     36
         2 002011   200504 552170                    STBQ    TMDATE+5,'70'O,AUTO

     1024    17344    1     TMDATE.TIME.MSEC=' ';                 /*Don't print msecs*/

  17344  2 002012   040100 100400                    MLR     fill='040'O
         2 002013   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002014   200504 600003                    ADSC9   TMDATE+5,,AUTO           cn=3,n=3

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:200  
     1025    17345        /*
     1026    17346          ****     Init. Fpt through which time is to be written
     1027    17347        */
     1028    17348    1     SEG$2.FPT_WRITE$->FPT$WRITE=CFPT_WRITE;

  17348  2 002015   000000 470400 xsym               LDP0    SEG2$
         2 002016   000165 471500                    LDP1    117,,PR0
         2 002017   000100 100400                    MLR     fill='000'O
         2 002020   000000 000060 xsym               ADSC9   CFPT_WRITE               cn=0,n=48
         2 002021   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

     1029    17349    1     SEG$2.FPT_WRITE$->FPT$WRITE.V_=VECTOR(SEG$2.FPT_WRITE$->FPT$WRITE.V);

  17349  2 002022   000165 471500                    LDP1    117,,PR0
         2 002023   000003 235000 3                  LDA     3
         2 002024   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 002025   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002026   000010 036003                    ADLQ    8,DU
         2 002027   100000 757100                    STAQ    0,,PR1

     1030    17350    1     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(TMDATE);

  17350  2 002030   000165 471500                    LDP1    117,,PR0
         2 002031   000045 235000 3                  LDA     37
         2 002032   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002033   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002034   000477 036003                    ADLQ    319,DU
         2 002035   100004 757100                    STAQ    4,,PR1

     1031    17351    1     IF (ADDR(P$PCB) ~= ADDR(NIL))AND

  17351  2 002036   200003 236100                    LDQ     @P$PCB,,AUTO
         2 002037   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002040   002217 600000 2                  TZE     s:17380
         2 002041   200003 471500                    LDP1    @P$PCB,,AUTO
         2 002042   100003 473500                    LDP3    3,,PR1
         2 002043   300000 720100                    LXL0    0,,PR3
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:201  
         2 002044   000037 100003                    CMPX0   31,DU
         2 002045   002217 601000 2                  TNZ     s:17380

     1032    17352    1          (P$PCB.OUT$ -> P$B.CODE = JOBCMND)
     1033    17353    1        THEN
     1034    17354    2           DO;

     1035    17355    2              IN$ = ADDR(TMDATEBUFF);          /* Print batch job heading line */

  17355  2 002046   200477 634500                    EPPR4   TMDATE,,AUTO
         2 002047   200034 454500                    STP4    IN$,,AUTO

     1036    17356    2              OUTBUFF$ = ADDR(OUTBUFF);

  17356  2 002050   200237 633500                    EPPR3   OUTBUFF,,AUTO
         2 002051   200036 453500                    STP3    OUTBUFF$,,AUTO

     1037    17357    2              DEST$ = OUTBUFF$;

  17357  2 002052   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 002053   200035 756100                    STQ     DEST$,,AUTO

     1038    17358    2              OUTBUFF = ' ';

  17358  2 002054   040100 100400                    MLR     fill='040'O
         2 002055   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002056   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     1039    17359    2              TAB_VAL = 1;

  17359  2 002057   000001 235007                    LDA     1,DL
         2 002060   200474 755100                    STA     TAB_VAL,,AUTO

     1040    17360        /**/
     1041    17361    2              SEG$2.FPT_WRITE$ -> FPT$WRITE.BUF_ = VECTOR(OUTBUFF);

  17361  2 002061   000165 475500                    LDP5    117,,PR0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:202  
         2 002062   000046 235000 3                  LDA     38
         2 002063   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002064   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002065   000237 036003                    ADLQ    159,DU
         2 002066   500004 757100                    STAQ    4,,PR5

     1042    17362    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(TMDATEBUFF),TAB_VAL)

  17362  2 002067   200474 633500                    EPPR3   TAB_VAL,,AUTO
         2 002070   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 002071   000050 236000 3                  LDQ     40
         2 002072   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 002073   200034 634500                    EPPR4   IN$,,AUTO
         2 002074   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 002075   200035 635500                    EPPR5   DEST$,,AUTO
         2 002076   202353 455500                    STP5    CLSDCB+31,,AUTO
         2 002077   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 002100   202352 456500                    STP6    CLSDCB+30,,AUTO
         2 002101   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002102   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002103   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002104   002227 702000 2                  TSX2    TIME50

     1043    17363    2                   ALTRET(TIME50);
     1044    17364    2              IN$ = ADDR(INBUFF);

  17364  2 002105   200037 630500                    EPPR0   INBUFF,,AUTO
         2 002106   200034 450500                    STP0    IN$,,AUTO

     1045    17365    2              INBUFF = '  Sysid = ';

  17365  2 002107   040100 100400                    MLR     fill='040'O
         2 002110   001035 000012 1                  ADSC9   CONSTCLS+31              cn=0,n=10
         2 002111   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1046    17366    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('  Sysid = '),TAB_VAL)

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:203  
  17366  2 002112   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 002113   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 002114   000051 236000 3                  LDQ     41
         2 002115   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 002116   200034 633500                    EPPR3   IN$,,AUTO
         2 002117   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 002120   200035 634500                    EPPR4   DEST$,,AUTO
         2 002121   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 002122   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002123   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 002124   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002125   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002126   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002127   002227 702000 2                  TSX2    TIME50

     1047    17367    2                   ALTRET(TIME50);
     1048    17368    2              CALL BINCHAR(SYSID,B$JIT.SYSID);

  17368  2 002130   000000 470400 xsym               LDP0    B$JIT$
         2 002131   000000 236100                    LDQ     0,,PR0
         2 002132   777777 376007                    ANQ     -1,DL
         2 002133   000000 235003                    LDA     0,DU
         2 002134   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 002135   000100 301500                    BTD
         2 002136   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 002137   200506 030006                    NDSC9   SYSID,,AUTO              cn=0,s=nosgn,sf=0,n=6

     1049    17369    2              CALL CPE$RZEROS(SYSID,SIZEC(SYSID),LEN);

  17369  2 002140   200476 631500                    EPPR1   LEN,,AUTO
         2 002141   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 002142   000052 236000 3                  LDQ     42
         2 002143   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 002144   200506 633500                    EPPR3   SYSID,,AUTO
         2 002145   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 002146   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002147   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:204  
         2 002150   000000 701000 xent               TSX1    CPE$RZEROS
         2 002151   000000 011000                    NOP     0

     1050    17370    2              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(SYSID),LEN,TAB_VAL)

  17370  2 002152   200506 630500                    EPPR0   SYSID,,AUTO
         2 002153   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 002154   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 002155   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 002156   200476 633500                    EPPR3   LEN,,AUTO
         2 002157   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 002160   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 002161   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 002162   200035 635500                    EPPR5   DEST$,,AUTO
         2 002163   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 002164   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 002165   202353 456500                    STP6    CLSDCB+31,,AUTO
         2 002166   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 002167   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002170   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002171   002227 702000 2                  TSX2    TIME50

     1051    17371    2                   ALTRET(TIME50);
     1052    17372    2              IF (B$JIT.RERUN)

  17372  2 002172   000000 470400 xsym               LDP0    B$JIT$
         2 002173   000302 236100                    LDQ     194,,PR0
         2 002174   000400 316003                    CANQ    256,DU
         2 002175   002217 600000 2                  TZE     s:17380

     1053    17373    2                 THEN
     1054    17374    3                    DO;

     1055    17375    3                       INBUFF = '  rerun';

  17375  2 002176   040100 100400                    MLR     fill='040'O
         2 002177   001040 000007 1                  ADSC9   CONSTCLS+34              cn=0,n=7
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:205  
         2 002200   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1056    17376    3                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('  rerun'),TAB_VAL)

  17376  2 002201   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 002202   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 002203   000053 236000 3                  LDQ     43
         2 002204   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 002205   200034 633500                    EPPR3   IN$,,AUTO
         2 002206   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 002207   200035 634500                    EPPR4   DEST$,,AUTO
         2 002210   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 002211   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 002212   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 002213   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002214   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 002215   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002216   002227 702000 2                  TSX2    TIME50

     1057    17377    3                            ALTRET(TIME50);
     1058    17378    3                    END;

     1059    17379    2           END;

     1060    17380    1     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(TIME50);

  17380  2 002217   000000 236000 xsym               LDQ     SEG2$
         2 002220   000165 036003                    ADLQ    117,DU
         2 002221   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002222   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002223   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002224   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002225   002227 702000 2                  TSX2    TIME50

     1061    17381    1     RETURN;

  17381  2 002226   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:206  

  17380  2 002227                       TIME50       null
     1062    17382    1   TIME50: ;
     1063    17383    1     ALTRETURN;

  17383  2 002227   000000 702200 xent               TSX2  ! X66_AALT

     1064    17384        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:207  
     1065    17385        /*
     1066    17386        *****  Local subroutines
     1067    17387        */
     1068    17388        /**********************************************************************/
     1069    17389        /*I*       NAME: DISPSYS
     1070    17390                   PURPOSE: To display current system information
     1071    17391                   CALL: CALL DISPSYS
     1072    17392                   INPUT:
     1073    17393                   OUTPUT: system parameters to listing device
     1074    17394                   DESCRIPTION: The system parameters are obtained using the m$display
     1075    17395                                pmme and output to the listing device.
     1076    17396        */
     1077    17397        /**********************************************************************/
     1078    17398    1   DISPSYS: PROC ALTRET;

  17398  2 002230   202072 741300       DISPSYS      STX1  ! VLP_SN+4,,AUTO

     1079    17399    2   DCL 1 NR,
     1080    17400    2          2 HDR CHAR(11),
     1081    17401    2          2 USRS CHAR(3);
     1082    17402    2   DCL 1 ETMF,
     1083    17403    2          2 HDR CHAR(11),
     1084    17404    2          2 NR CHAR(3);
     1085    17405        /*
     1086    17406          ****     Set load parameters
     1087    17407        */
     1088    17408    2     FPT_DISPLAY = CFPT_DISPLAY;

  17408  2 002231   000000 237000 xsym               LDAQ    CFPT_DISPLAY
         2 002232   201734 757100                    STAQ    FPT_DISPLAY,,AUTO

     1089    17409    2     FPT_DISPLAY.RESULTS_ = VECTOR(LOAD_VAR);

  17409  2 002233   000054 235000 3                  LDA     44
         2 002234   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002235   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002236   001642 036003                    ADLQ    930,DU
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:208  
         2 002237   201734 757100                    STAQ    FPT_DISPLAY,,AUTO

     1090    17410    2     CALL M$DISPLAY (FPT_DISPLAY);

  17410  2 002240   201734 630500                    EPPR0   FPT_DISPLAY,,AUTO
         2 002241   020007 713400                    CLIMB   8199
         2 002242   400000 401760                    pmme    nvectors=1

     1091    17411        /* ****    Output users                          */
     1092    17412    2     IF LOAD_VAR.USERS > 999

  17412  2 002243   201642 235100                    LDA     LOAD_VAR,,AUTO
         2 002244   001750 115007                    CMPA    1000,DL
         2 002245   002250 602000 2                  TNC     s:17415

     1093    17413    2        THEN
     1094    17414    2           LOAD_VAR.USERS=999;

  17414  2 002246   001747 236007                    LDQ     999,DL
         2 002247   201642 756100                    STQ     LOAD_VAR,,AUTO

     1095    17415    2     CALL BINCHAR(NR.USRS,LOAD_VAR.USERS);

  17415  2 002250   201642 235100                    LDA     LOAD_VAR,,AUTO
         2 002251   000044 773000                    LRL     36
         2 002252   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 002253   000100 301500                    BTD
         2 002254   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 002255   202075 630003                    NDSC9   @CREATE_FLG+1,,AUTO      cn=3,s=nosgn,sf=0,n=3

     1096    17416    2     CALL CPE$RZEROS(NR.USRS,SIZEC(NR.USRS));

  17416  2 002256   000055 236000 3                  LDQ     45
         2 002257   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 002260   202354 452500                    STP2    CLSDCB+32,,AUTO
         2 002261   202354 236100                    LDQ     CLSDCB+32,,AUTO
         2 002262   000056 036000 3                  ADLQ    46
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:209  
         2 002263   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002264   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002265   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002266   000000 701000 xent               TSX1    CPE$RZEROS
         2 002267   000000 011000                    NOP     0

     1097    17417    2     NR.HDR='   Users = ';

  17417  2 002270   040100 100400                    MLR     fill='040'O
         2 002271   001042 000013 1                  ADSC9   CONSTCLS+36              cn=0,n=11
         2 002272   202073 000013                    ADSC9   NR,,AUTO                 cn=0,n=11

     1098    17418    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(NR);

  17418  2 002273   000000 470400 xsym               LDP0    SEG2$
         2 002274   000165 471500                    LDP1    117,,PR0
         2 002275   000057 235000 3                  LDA     47
         2 002276   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002277   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002300   002073 036003                    ADLQ    1083,DU
         2 002301   100004 757100                    STAQ    4,,PR1

     1099    17419    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSYS50);

  17419  2 002302   000000 236000 xsym               LDQ     SEG2$
         2 002303   000165 036003                    ADLQ    117,DU
         2 002304   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002305   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002306   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002307   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002310   002460 702000 2                  TSX2    DISPSYS50

     1100    17420        /* ****    Output etmf                           */
     1101    17421    2     IF LOAD_VAR.ETMF > 999

  17421  2 002311   201643 235100                    LDA     LOAD_VAR+1,,AUTO
         2 002312   001750 115007                    CMPA    1000,DL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:210  
         2 002313   002316 602000 2                  TNC     s:17424

     1102    17422    2        THEN
     1103    17423    2           LOAD_VAR.ETMF = 999;

  17423  2 002314   001747 236007                    LDQ     999,DL
         2 002315   201643 756100                    STQ     LOAD_VAR+1,,AUTO

     1104    17424    2     CALL BINCHAR(ETMF.NR,LOAD_VAR.ETMF);

  17424  2 002316   201643 235100                    LDA     LOAD_VAR+1,,AUTO
         2 002317   000044 773000                    LRL     36
         2 002320   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 002321   000100 301500                    BTD
         2 002322   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 002323   202101 630003                    NDSC9   K+1,,AUTO                cn=3,s=nosgn,sf=0,n=3

     1105    17425    2     CALL CPE$RZEROS(ETMF.NR,SIZEC(ETMF.NR));

  17425  2 002324   000055 236000 3                  LDQ     45
         2 002325   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 002326   202354 452500                    STP2    CLSDCB+32,,AUTO
         2 002327   202354 236100                    LDQ     CLSDCB+32,,AUTO
         2 002330   000060 036000 3                  ADLQ    48
         2 002331   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002332   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002333   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002334   000000 701000 xent               TSX1    CPE$RZEROS
         2 002335   000000 011000                    NOP     0

     1106    17426    2     ETMF.HDR='   ETMF = ';

  17426  2 002336   040100 100400                    MLR     fill='040'O
         2 002337   001045 000012 1                  ADSC9   CONSTCLS+39              cn=0,n=10
         2 002340   202077 000013                    ADSC9   ETMF,,AUTO               cn=0,n=11

     1107    17427    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(ETMF);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:211  

  17427  2 002341   000000 470400 xsym               LDP0    SEG2$
         2 002342   000165 471500                    LDP1    117,,PR0
         2 002343   000057 235000 3                  LDA     47
         2 002344   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002345   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002346   002077 036003                    ADLQ    1087,DU
         2 002347   100004 757100                    STAQ    4,,PR1

     1108    17428    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSYS50);

  17428  2 002350   000000 236000 xsym               LDQ     SEG2$
         2 002351   000165 036003                    ADLQ    117,DU
         2 002352   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002353   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002355   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002356   002460 702000 2                  TSX2    DISPSYS50

     1109    17429        /* ****    Output response                       */
     1110    17430    2     IF LOAD_VAR.RESP > 999

  17430  2 002357   201644 235100                    LDA     LOAD_VAR+2,,AUTO
         2 002360   001750 115007                    CMPA    1000,DL
         2 002361   002364 602000 2                  TNC     s:17433

     1111    17431    2        THEN
     1112    17432    2           LOAD_VAR.RESP = 999;

  17432  2 002362   001747 236007                    LDQ     999,DL
         2 002363   201644 756100                    STQ     LOAD_VAR+2,,AUTO

     1113    17433    2     OUTBUFF$=ADDR(OUTBUFF);

  17433  2 002364   200237 630500                    EPPR0   OUTBUFF,,AUTO
         2 002365   200036 450500                    STP0    OUTBUFF$,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:212  
     1114    17434    2     DEST$=OUTBUFF$;

  17434  2 002366   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 002367   200035 756100                    STQ     DEST$,,AUTO

     1115    17435    2     OUTBUFF=' ';

  17435  2 002370   040100 100400                    MLR     fill='040'O
         2 002371   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002372   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     1116    17436    2     TAB_VAL = 0;

  17436  2 002373   200474 450100                    STZ     TAB_VAL,,AUTO

     1117    17437    2     CALL CNVRT_BLD(SIZEC('   90% response < '),'   90% response < ',

  17437  2 002374   201644 631500                    EPPR1   LOAD_VAR+2,,AUTO
         2 002375   202307 451500                    STP1    @TEXT+1,,AUTO
         2 002376   000062 236000 3                  LDQ     50
         2 002377   202306 756100                    STQ     @FLAG+1,,AUTO
         2 002400   000063 236000 3                  LDQ     51
         2 002401   202305 756100                    STQ     SIZ+2,,AUTO
         2 002402   012300 701000 2                  TSX1    CNVRT_BLD
         2 002403   002460 702000 2                  TSX2    DISPSYS50

     1118    17438    2          LOAD_VAR.RESP) ALTRET(DISPSYS50);
     1119    17439    2     INBUFF=' msecs';

  17439  2 002404   040100 100400                    MLR     fill='040'O
         2 002405   001055 000006 1                  ADSC9   CONSTCLS+47              cn=0,n=6
         2 002406   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1120    17440    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(INBUFF),SIZEC(' msecs'))

  17440  2 002407   200037 630500                    EPPR0   INBUFF,,AUTO
         2 002410   202352 450500                    STP0    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:213  
         2 002411   000052 236000 3                  LDQ     42
         2 002412   202357 756100                    STQ     CLSDCB+35,,AUTO
         2 002413   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 002414   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 002415   200035 633500                    EPPR3   DEST$,,AUTO
         2 002416   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 002417   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 002420   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 002421   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 002422   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002423   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 002424   002460 702000 2                  TSX2    DISPSYS50

     1121    17441    2          ALTRET(DISPSYS50);
     1122    17442    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  17442  2 002425   000000 470400 xsym               LDP0    SEG2$
         2 002426   000165 471500                    LDP1    117,,PR0
         2 002427   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 002430   100005 756100                    STQ     5,,PR1

     1123    17443    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  17443  2 002431   000165 471500                    LDP1    117,,PR0
         2 002432   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 002433   000020 772000                    QRL     16
         2 002434   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002435   200035 236100                    LDQ     DEST$,,AUTO
         2 002436   000020 772000                    QRL     16
         2 002437   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 002440   000020 736000                    QLS     16
         2 002441   100004 676100                    ERQ     4,,PR1
         2 002442   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002443   100004 656100                    ERSQ    4,,PR1

     1124    17444    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSYS50);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:214  
  17444  2 002444   000000 236000 xsym               LDQ     SEG2$
         2 002445   000165 036003                    ADLQ    117,DU
         2 002446   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002447   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002450   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002451   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002452   002460 702000 2                  TSX2    DISPSYS50

     1125    17445        /* ****    Output time                           */
     1126    17446    2     CALL CPE$TIME ALTRET(DISPSYS50);

  17446  2 002453   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002454   001756 701000 2                  TSX1    s:17336
         2 002455   002460 702000 2                  TSX2    DISPSYS50

     1127    17447    2     RETURN;

  17447  2 002456   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 002457   000001 702211                    TSX2  ! 1,X1

  17443  2 002460                       DISPSYS50    null
     1128    17448    2   DISPSYS50: ;
     1129    17449    2     ALTRETURN;

  17449  2 002460   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 002461   000000 702211                    TSX2  ! 0,X1

     1130    17450    2   END DISPSYS;
     1131    17451                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:215  
     1132    17452        /**********************************************************************/
     1133    17453        /*I*   NAME:   DISPDCBS
     1134    17454               PURPOSE: Display assign merge information for all dcbs in the *a
     1135    17455                       file.
     1136    17456               CALL:   CALL DISPDCBS
     1137    17457                       DISPDCB
     1138    17458               INPUT:
     1139    17459               OUTPUT: *a information to the listing device
     1140    17460               DEXCRIPTION: Assign merge records for all dcbs are read from the
     1141    17461                       *a file into seg3. A SET command is constructed for each
     1142    17462                       assign merge record and is output to the listing device.
     1143    17463        */
     1144    17464        /***********************************************************************/
     1145    17465    1   DISPDCBS: PROC ALTRET;

  17465  2 002462   202072 741300       DISPDCBS     STX1  ! VLP_SN+4,,AUTO

     1146    17466    2   DCL FDCB_CHAR(0:0) CHAR(1) CONSTANT INIT(' '); /*1ST possible char for dcb name*/
     1147    17467    2   DCL DCBHDR CONSTANT CHAR(19) INIT('   DCB assignments:');
     1148    17468    2   DCL DCBNHDR CONSTANT CHAR(24) INIT('   DCB assignments: none');
     1149    17469    2   DCL DCBS_EXIST BIT(1) UNAL;                      /*Dcbs exist flag*/
     1150    17470        /**/
     1151    17471        /**/
     1152    17472        /*         **** Get buffer for assign merge records */
     1153    17473    2     CALL CPC$GETSEG(SEG3$) ALTRET(DISPDCBS45);

  17473  2 002463   000007 630400 3                  EPPR0   7
         2 002464   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002465   000000 701000 xent               TSX1    CPC$GETSEG
         2 002466   002731 702000 2                  TSX2    DISPDCBS45

     1154    17474          %SAVE_ACTIVE_PRIVS;

  17475  2 002467   000000 470400 xsym               LDP0    B$JIT$
         2 002470   000013 236100                    LDQ     11,,PR0
         2 002471   200510 756100                    STQ     ACTIVE_PRIVS,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:216  
  17476  2 002472   000013 450100                    STZ     11,,PR0

     1155    17478    2     FPT_CLOSE = CFPT_CLOSE;

  17478  2 002473   000100 100400                    MLR     fill='000'O
         2 002474   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 002475   201676 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

     1156    17479    2     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  17479  2 002476   000003 235000 3                  LDA     3
         2 002477   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002500   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002501   001730 036003                    ADLQ    984,DU
         2 002502   201676 757100                    STAQ    FPT_CLOSE,,AUTO

     1157    17480        /*         **** Open *A file                     */
     1158    17481    2     DCBS_EXIST=%NO#;

  17481  2 002503   202073 450100                    STZ     DCBS_EXIST,,AUTO

     1159    17482    2     FPT_OPEN=CFPT_OPEN;

  17482  2 002504   000100 100400                    MLR     fill='000'O
         2 002505   000000 000350 xsym               ADSC9   CFPT_OPEN                cn=0,n=232
         2 002506   201750 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     1160    17483    2     FPT_OPEN.V_=VECTOR(FPT_OPEN.V);

  17483  2 002507   000064 235000 3                  LDA     52
         2 002510   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002511   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002512   002014 036003                    ADLQ    1036,DU
         2 002513   201750 757100                    STAQ    FPT_OPEN,,AUTO

     1161    17484    2     FPT_OPEN.NAME_=VECTOR(STARA);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:217  
  17484  2 002514   000066 237000 3                  LDAQ    54
         2 002515   201756 757100                    STAQ    FPT_OPEN+6,,AUTO

     1162    17485    2     FPT_OPEN.V.DCB#=M$IBEX1_NUM;

  17485  2 002516   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002517   202014 740100                    STX0    FPT_OPEN+36,,AUTO

     1163    17486    2     FPT_OPEN.V.ASN#=%FILE#;

  17486  2 002520   000001 236007                    LDQ     1,DL
         2 002521   202015 552104                    STBQ    FPT_OPEN+37,'04'O,AUTO

     1164    17487    2     FPT_OPEN.V.FUN#=%IN#;

  17487  2 002522   002000 236007                    LDQ     1024,DL
         2 002523   202015 552110                    STBQ    FPT_OPEN+37,'10'O,AUTO

     1165    17488    2     FPT_OPEN.V.ORG#=%KEYED#;

  17488  2 002524   202016 552110                    STBQ    FPT_OPEN+38,'10'O,AUTO

     1166    17489    2     FPT_OPEN.V.ACS#=%SEQUEN#;

  17489  2 002525   000001 236007                    LDQ     1,DL
         2 002526   202016 552104                    STBQ    FPT_OPEN+38,'04'O,AUTO

     1167    17490    2     FPT_OPEN.V.INITZ.SCRUB#=%YES#;

  17490  2 002527   400000 236007                    LDQ     -131072,DL
         2 002530   202014 256100                    ORSQ    FPT_OPEN+36,,AUTO

     1168    17491    2     CALL M$OPEN(FPT_OPEN) ALTRET(DISPDCBS20);

  17491  2 002531   201750 630500                    EPPR0   FPT_OPEN,,AUTO
         2 002532   450000 713400                    CLIMB   alt,open
         2 002533   410400 401760                    pmme    nvectors=18
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:218  
         2 002534   002633 702000 2                  TSX2    DISPDCBS20

     1169    17492          %RESTORE_ACTIVE_PRIVS;

  17493  2 002535   200510 236100                    LDQ     ACTIVE_PRIVS,,AUTO
         2 002536   000000 470400 xsym               LDP0    B$JIT$
         2 002537   000013 756100                    STQ     11,,PR0

     1170    17495        /*         **** Read in *A record                */
     1171    17496    2     FPT_READ=CFPT_READ;

  17496  2 002540   000100 100400                    MLR     fill='000'O
         2 002541   000000 000070 xsym               ADSC9   CFPT_READ                cn=0,n=56
         2 002542   202042 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

     1172    17497    2     FPT_READ.V_=VECTOR(FPT_READ.V);

  17497  2 002543   000065 235000 3                  LDA     53
         2 002544   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002545   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002546   002052 036003                    ADLQ    1066,DU
         2 002547   202042 757100                    STAQ    FPT_READ,,AUTO

     1173    17498    2     FPT_READ.BUF_.BUF$=SEG3$;

  17498  2 002550   000000 236000 xsym               LDQ     SEG3$
         2 002551   202047 756100                    STQ     FPT_READ+5,,AUTO

     1174    17499    2     FPT_READ.BUF_.BOUND=4095;

  17499  2 002552   202046 236100                    LDQ     FPT_READ+4,,AUTO
         2 002553   177777 376007                    ANQ     65535,DL
         2 002554   000070 276000 3                  ORQ     56
         2 002555   202046 756100                    STQ     FPT_READ+4,,AUTO

     1175    17500    2     FPT_READ.KEY_=VECTOR(DCB_NAME);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:219  
  17500  2 002556   000054 235000 3                  LDA     44
         2 002557   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 002560   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 002561   000440 036003                    ADLQ    288,DU
         2 002562   202044 757100                    STAQ    FPT_READ+2,,AUTO

     1176    17501    2     FPT_READ.V.KEYS#=%NO#;

  17501  2 002563   000071 236000 3                  LDQ     57
         2 002564   202052 356100                    ANSQ    FPT_READ+8,,AUTO

     1177    17502    2     FPT_READ.V.KEYR#=%YES#;

  17502  2 002565   100000 236007                    LDQ     32768,DL
         2 002566   202052 256100                    ORSQ    FPT_READ+8,,AUTO

     1178    17503    2     FPT_READ.V.DCB#=M$IBEX1_NUM;

  17503  2 002567   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002570   202052 740100                    STX0    FPT_READ+8,,AUTO

  17503  2 002571                       DISPDCBS5    null
     1179    17504    2   DISPDCBS5: ;
     1180    17505        /*         **** Loop until all dcbs are displayed */
     1181    17506    2     CALL M$READ(FPT_READ) ALTRET(DISPDCBS10);

  17506  2 002571   202042 630500                    EPPR0   FPT_READ,,AUTO
         2 002572   440000 713400                    CLIMB   alt,read
         2 002573   401400 401760                    pmme    nvectors=4
         2 002574   002636 702000 2                  TSX2    DISPDCBS10

     1182    17507        /*         **** Check for valid dcb name         */
     1183    17508        /*         **** Dcb names must start with char > .040  */
     1184    17509    2     IF (DCB_NAMEA(1) > FDCB_CHAR(0))

  17509  2 002575   040100 106400                    CMPC    fill='040'O
         2 002576   000366 000001 1                  ADSC9   FDCB_CHAR                cn=0,n=1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:220  
         2 002577   200440 200001                    ADSC9   DCB_NAME,,AUTO           cn=1,n=1
         2 002600   002632 603000 2                  TRC     s:17522

     1185    17510    2        THEN
     1186    17511    3           DO;

     1187    17512    3              IF DCBS_EXIST=%NO#

  17512  2 002601   202073 234100                    SZN     DCBS_EXIST,,AUTO
         2 002602   002616 604000 2                  TMI     s:17518

     1188    17513    3                 THEN
     1189    17514    4                    DO;

     1190    17515    4                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(DCBHDR);

  17515  2 002603   000000 470400 xsym               LDP0    SEG2$
         2 002604   000165 471500                    LDP1    117,,PR0
         2 002605   000072 237000 3                  LDAQ    58
         2 002606   100004 757100                    STAQ    4,,PR1

     1191    17516    4                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPDCBS57);

  17516  2 002607   000000 236000 xsym               LDQ     SEG2$
         2 002610   000165 036003                    ADLQ    117,DU
         2 002611   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002612   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002613   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002614   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002615   002735 702000 2                  TSX2    DISPDCBS57

     1192    17517    4                    END;

     1193    17518    3              TAB_VAL=6;

  17518  2 002616   000006 235007                    LDA     6,DL
         2 002617   200474 755100                    STA     TAB_VAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:221  

     1194    17519    3              CALL DISPDCB(ADDR(DCB_NAME),TAB_VAL)  ALTRET(DISPDCBS57);

  17519  2 002620   200440 630500                    EPPR0   DCB_NAME,,AUTO
         2 002621   202371 450500                    STP0    CLSDCB+45,,AUTO
         2 002622   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 002623   202076 451500                    STP1    @DCB#+1,,AUTO
         2 002624   202371 633500                    EPPR3   CLSDCB+45,,AUTO
         2 002625   202075 453500                    STP3    @CREATE_FLG+1,,AUTO
         2 002626   002760 701000 2                  TSX1    DISPDCB
         2 002627   002735 702000 2                  TSX2    DISPDCBS57

     1195    17520    3              DCBS_EXIST=%YES#;

  17520  2 002630   400000 236003                    LDQ     -131072,DU
         2 002631   202073 756100                    STQ     DCBS_EXIST,,AUTO

     1196    17521    3           END;

     1197    17522    2     GOTO DISPDCBS5;

  17522  2 002632   002571 710000 2                  TRA     DISPDCBS5

     1198    17523    2   DISPDCBS20:
     1199    17524          %RESTORE_ACTIVE_PRIVS;

  17525  2 002633   200510 236100       DISPDCBS20   LDQ     ACTIVE_PRIVS,,AUTO
         2 002634   000000 470400 xsym               LDP0    B$JIT$
         2 002635   000013 756100                    STQ     11,,PR0

  17518  2 002636                       DISPDCBS10   null
     1200    17527    2   DISPDCBS10:;
     1201    17528        /*         **** Preserve error temporarily       */
     1202    17529    2     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  17529  2 002636   000000 470400 xsym               LDP0    B$TCB$
         2 002637   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:222  
         2 002640   100102 236100                    LDQ     66,,PR1
         2 002641   000000 473400 xsym               LDP3    B$JIT$
         2 002642   300144 756100                    STQ     100,,PR3

     1203    17530    2     FPT_CLOSE.V.DCB#=M$IBEX1_NUM;

  17530  2 002643   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002644   201730 740100                    STX0    FPT_CLOSE+26,,AUTO

     1204    17531    2     FPT_CLOSE.V.DISP#=%SAVE#;

  17531  2 002645   000002 236007                    LDQ     2,DL
         2 002646   201730 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

     1205    17532    2     CALL M$CLOSE(FPT_CLOSE);

  17532  2 002647   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 002650   050001 713400                    CLIMB   close
         2 002651   406000 401760                    pmme    nvectors=13

     1206    17533    2     CALL CPC$RELSEG (SEG3$);

  17533  2 002652   000007 630400 3                  EPPR0   7
         2 002653   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002654   000000 701000 xent               TSX1    CPC$RELSEG
         2 002655   000000 011000                    NOP     0

     1207    17534    2     IF (B$JIT.USRERR.CODE=%E$EOF) OR (B$JIT.USRERR.CODE=%E$NOFILE)

  17534  2 002656   000000 470400 xsym               LDP0    B$JIT$
         2 002657   000144 236100                    LDQ     100,,PR0
         2 002660   377770 376007                    ANQ     131064,DL
         2 002661   000060 116007                    CMPQ    48,DL
         2 002662   002665 600000 2                  TZE     s:17538
         2 002663   001610 116007                    CMPQ    904,DL
         2 002664   002707 601000 2                  TNZ     s:17547

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:223  
     1208    17535    2        THEN
     1209    17536        /*         **** Output info. Message if no dcbs encountered */
     1210    17537    3           DO;

     1211    17538    3              IF (DCBS_EXIST=%NO#)

  17538  2 002665   202073 234100                    SZN     DCBS_EXIST,,AUTO
         2 002666   002702 604000 2                  TMI     s:17544

     1212    17539    3                 THEN
     1213    17540    4                    DO;

     1214    17541    4                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(DCBNHDR);

  17541  2 002667   000000 471400 xsym               LDP1    SEG2$
         2 002670   100165 473500                    LDP3    117,,PR1
         2 002671   000074 237000 3                  LDAQ    60
         2 002672   300004 757100                    STAQ    4,,PR3

     1215    17542    4                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPDCBS57);

  17542  2 002673   000000 236000 xsym               LDQ     SEG2$
         2 002674   000165 036003                    ADLQ    117,DU
         2 002675   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002676   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 002677   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002700   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002701   002735 702000 2                  TSX2    DISPDCBS57

     1216    17543    4                    END;

     1217    17544    3              B$JIT.USRERR.CODE = 0;

  17544  2 002702   000000 470400 xsym               LDP0    B$JIT$
         2 002703   000011 236000 3                  LDQ     9
         2 002704   000144 356100                    ANSQ    100,,PR0

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:224  
     1218    17545    3              RETURN;

  17545  2 002705   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 002706   000001 702211                    TSX2  ! 1,X1

     1219    17546    3           END;
     1220    17547    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR);

  17547  2 002707   000000 236000 xsym               LDQ     SEG2$
         2 002710   000003 036003                    ADLQ    3,DU
         2 002711   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 002712   000000 236000 xsym               LDQ     B$JIT$
         2 002713   000144 036003                    ADLQ    100,DU
         2 002714   000004 235000 3                  LDA     4
         2 002715   202354 757100                    STAQ    CLSDCB+32,,AUTO
         2 002716   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 002717   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 002720   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 002721   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002722   000000 701000 xent               TSX1    CXP$POSTERR
         2 002723   000000 011000                    NOP     0

     1221    17548    2     B$JIT.USRERR.CODE=0;

  17548  2 002724   000000 470400 xsym               LDP0    B$JIT$
         2 002725   000011 236000 3                  LDQ     9
         2 002726   000144 356100                    ANSQ    100,,PR0

     1222    17549    2     ALTRETURN;

  17549  2 002727   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 002730   000000 702211                    TSX2  ! 0,X1

  17548  2 002731                       DISPDCBS45   null
     1223    17550    2   DISPDCBS45:;
     1224    17551    2     CALL CPC$SCREECH(E$SUASEG,CPE$IBEXMID);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:225  
  17551  2 002731   000100 630400 3                  EPPR0   64
         2 002732   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002733   000000 701000 xent               TSX1    CPC$SCREECH
         2 002734   000000 011000                    NOP     0

  17548  2 002735                       DISPDCBS57   null
     1225    17552        /*E*    ERROR:   CPE-E$SUASEG-A
     1226    17553                MESSAGE:  IBEX ABORT:  Unable to obtain data segment.  JIT.ERR
     1227    17554                                       follows.
     1228    17555                DESCRIPTION: IBEX was unable to get a data segment used for the
     1229    17556                             purpose of reading  the assign merge record.
     1230    17557        */
     1231    17558    2   DISPDCBS57:;
     1232    17559    2     IF  DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#=%YES# THEN

  17559  2 002735   000102 470400 3                  LDP0    66
         2 002736   000000 471500                    LDP1    0,,PR0
         2 002737   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002740   100000 473510                    LDP3    0,X0,PR1
         2 002741   300031 236100                    LDQ     25,,PR3
         2 002742   020000 316007                    CANQ    8192,DL
         2 002743   002752 600000 2                  TZE     s:17565

     1233    17560    3        DO;

     1234    17561    3           FPT_CLOSE.V.DISP# = %SAVE#;

  17561  2 002744   000002 236007                    LDQ     2,DL
         2 002745   201730 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

     1235    17562    3           FPT_CLOSE.V.DCB# = M$IBEX1_NUM;

  17562  2 002746   201730 740100                    STX0    FPT_CLOSE+26,,AUTO

     1236    17563    3           CALL M$CLOSE(FPT_CLOSE);

  17563  2 002747   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:226  
         2 002750   050001 713400                    CLIMB   close
         2 002751   406000 401760                    pmme    nvectors=13

     1237    17564    3        END;

     1238    17565    2     CALL CPC$RELSEG (SEG3$);

  17565  2 002752   000007 630400 3                  EPPR0   7
         2 002753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002754   000000 701000 xent               TSX1    CPC$RELSEG
         2 002755   000000 011000                    NOP     0

     1239    17566    2     ALTRETURN;

  17566  2 002756   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 002757   000000 702211                    TSX2  ! 0,X1

     1240    17567    2   END DISPDCBS;
     1241    17568        %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:227  
     1242    17569        /**********************************************************************/
     1243    17570        /*I*   NAME:   DISPDCB
     1244    17571               PURPOSE: Display assign merge information for specified dcb
     1245    17572               CALL:   CALL DISPDCB(DCB$,TAB_VAL)
     1246    17573               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     1247    17574               INPUT:  DCB$ - ptr to dcb name
     1248    17575                       TAB_VAL - value for tabbing purposes
     1249    17576                       assign merge record in seg3
     1250    17577               OUTPUT: *A information to listing device
     1251    17578               DESCRIPTION: A SET command for a specified dcb is constructed
     1252    17579                       from its  assign merge record. The command is
     1253    17580                       output to the listing device.
     1254    17581        */
     1255    17582        /**********************************************************************/
     1256    17583    1   DISPDCB: PROC(DCB$,TAB_VAL) ALTRET;

  17583  2 002760   202074 741300       DISPDCB      STX1  ! @RES#+1,,AUTO

     1257    17584    2   DCL TBUFF CHAR(6);                               /*Temp. Buffer*/
     1258    17585    2   DCL DCB$ PTR;                         /*Ptr to dcb name*/
     1259    17586    2   DCL TAB_VAL SBIN;                                /*Tab value*/
     1260    17587    2   DCL 1 VLP$ATTR BASED,                            /*Vlp length*/
     1261    17588    2          2 SIZE# UBIN WORD;
     1262    17589    2   DCL 1 VLP$ACSVEH BASED,                          /*Access vehicle vlp*/
     1263    17590    2          2 FFLG BIT(18),
     1264    17591    2          2 C UBIN BYTE UNAL,
     1265    17592    2          2 VEHICLE# CHAR(VLP$ACSVEH.C);
     1266    17593    2   DCL 1 VLP$ACCESS BASED,                          /*Access vlp*/
     1267    17594    2          2 FFLG BIT(18),
     1268    17595    2          2 ACCT# CHAR(8);
     1269    17596                   %VLP_TAB(FPTN=AM$TAB,STCLASS=BASED);
     1270    17610                   %VLP_HDR(FPTN=AM$HDR,LEN="AM$HDR.TITL.L#",STCLASS=BASED);
     1271    17626                   %VLP_FORM(FPTN=AM$FORM,STCLASS=BASED);
     1272    17639                  %FPT_UNFID(FPTN=FPT_UNFID,STCLASS=AUTO);
     1273    17657        /**/
     1274    17658        /**/
     1275    17659    2     OUTBUFF=' ';                          /*Blank out buffer*/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:228  

  17659  2 002761   040100 100400                    MLR     fill='040'O
         2 002762   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002763   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     1276    17660    2     IN$=ADDR(INBUFF);

  17660  2 002764   200037 630500                    EPPR0   INBUFF,,AUTO
         2 002765   200034 450500                    STP0    IN$,,AUTO

     1277    17661    2     DEST$=ADDR(OUTBUFF);

  17661  2 002766   200237 631500                    EPPR1   OUTBUFF,,AUTO
         2 002767   200035 451500                    STP1    DEST$,,AUTO

     1278    17662    2     OUTBUFF$=DEST$;

  17662  2 002770   200035 236100                    LDQ     DEST$,,AUTO
         2 002771   200036 756100                    STQ     OUTBUFF$,,AUTO

     1279    17663        /*         **** Insert 'SET ' in image           */
     1280    17664    2     INBUFF='Set ';

  17664  2 002772   040100 100400                    MLR     fill='040'O
         2 002773   001057 000004 1                  ADSC9   CONSTCLS+49              cn=0,n=4
         2 002774   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1281    17665    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,4,TAB_VAL) ALTRET(DISPDCB55);

  17665  2 002775   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 002776   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 002777   000103 236000 3                  LDQ     67
         2 003000   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 003001   200034 633500                    EPPR3   IN$,,AUTO
         2 003002   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 003003   200035 634500                    EPPR4   DEST$,,AUTO
         2 003004   202353 454500                    STP4    CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:229  
         2 003005   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 003006   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 003007   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003010   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003011   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003012   010711 702000 2                  TSX2    DISPDCB55

     1282    17666        /*         **** Insert dcb in image              */
     1283    17667    2     LEN=DCB$->TEXTC.SIZ;

  17667  2 003013   202075 470500                    LDP0    @DCB$,,AUTO
         2 003014   000000 471500                    LDP1    0,,PR0
         2 003015   000100 101500                    MRL     fill='000'O
         2 003016   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 003017   200476 000004                    ADSC9   LEN,,AUTO                cn=0,n=4

     1284    17668    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(DCB$->TEXTC.TEXT),LEN) ALTRET(DISPDCB55);

  17668  2 003020   000000 471500                    LDP1    0,,PR0
         2 003021   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 003022   202353 236100                    LDQ     CLSDCB+31,,AUTO
         2 003023   200000 036007                    ADLQ    65536,DL
         2 003024   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 003025   200476 633500                    EPPR3   LEN,,AUTO
         2 003026   202357 453500                    STP3    CLSDCB+35,,AUTO
         2 003027   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 003030   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 003031   200035 635500                    EPPR5   DEST$,,AUTO
         2 003032   202355 455500                    STP5    CLSDCB+33,,AUTO
         2 003033   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 003034   202354 456500                    STP6    CLSDCB+32,,AUTO
         2 003035   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 003036   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003037   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003040   010711 702000 2                  TSX2    DISPDCB55

     1285    17669        /*         **** Insert blank after dcb           */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:230  
     1286    17670    2     INBUFF=' ';

  17670  2 003041   040100 100400                    MLR     fill='040'O
         2 003042   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 003043   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1287    17671    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1) ALTRET(DISPDCB55);

  17671  2 003044   000033 236000 3                  LDQ     27
         2 003045   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 003046   200034 630500                    EPPR0   IN$,,AUTO
         2 003047   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 003050   200035 631500                    EPPR1   DEST$,,AUTO
         2 003051   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 003052   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 003053   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 003054   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003055   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003056   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003057   010711 702000 2                  TSX2    DISPDCB55

     1288    17672        /*          **** Insert fid into image
     1289    17673                    **** Init. Unfid if info. Present in *A
     1290    17674        */
     1291    17675    2     FPT_UNFID = CFPT_UNFID;

  17675  2 003060   000100 100400                    MLR     fill='000'O
         2 003061   000000 000130 xsym               ADSC9   CFPT_UNFID               cn=0,n=88
         2 003062   202102 000130                    ADSC9   FPT_UNFID,,AUTO          cn=0,n=88

     1292    17676    2     FPT_UNFID.V_ = VECTOR(FPT_UNFID.V);

  17676  2 003063   000023 235000 3                  LDA     19
         2 003064   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 003065   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 003066   002126 036003                    ADLQ    1110,DU
         2 003067   202102 757100                    STAQ    FPT_UNFID,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:231  

     1293    17677    2     FPT_UNFID.TEXTFID_ = VECTOR(INBUFF);

  17677  2 003070   000046 235000 3                  LDA     38
         2 003071   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 003072   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 003073   000037 036003                    ADLQ    31,DU
         2 003074   202104 757100                    STAQ    DCBTAB$+1,,AUTO

     1294    17678    2     IF AMR$REC$.NAME_ ~= ADDR(NIL)

  17678  2 003075   000000 470400 xsym               LDP0    SEG3$
         2 003076   000003 236100                    LDQ     3,,PR0
         2 003077   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003100   003106 600000 2                  TZE     s:17681

     1295    17679    2        THEN
     1296    17680    2           FPT_UNFID.NAME_ = VECTOR(AMR$REC$.NAME_->AM$NAME);

  17680  2 003101   000003 471500                    LDP1    3,,PR0
         2 003102   000054 235000 3                  LDA     44
         2 003103   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 003104   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 003105   202106 757100                    STAQ    @OPTLEN+1,,AUTO

     1297    17681    2     IF AMR$REC$.ACCT_ ~= ADDR(NIL)

  17681  2 003106   000012 236100                    LDQ     10,,PR0
         2 003107   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003110   003116 600000 2                  TZE     s:17684

     1298    17682    2        THEN
     1299    17683    2           FPT_UNFID.ACCT_ = VECTOR(AMR$REC$.ACCT_->AM$ACCT);

  17683  2 003111   000012 471500                    LDP1    10,,PR0
         2 003112   000023 235000 3                  LDA     19
         2 003113   202352 451500                    STP1    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:232  
         2 003114   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 003115   202110 757100                    STAQ    OPNDCB+2,,AUTO

     1300    17684    2     IF AMR$REC$.SN_ ~= ADDR(NIL)

  17684  2 003116   000001 236100                    LDQ     1,,PR0
         2 003117   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003120   003135 600000 2                  TZE     s:17690

     1301    17685    2        THEN
     1302    17686    3           DO;

     1303    17687    3              LEN = AMR$REC$.SN_->AM$SN.NUM#*6+4;

  17687  2 003121   000001 471500                    LDP1    1,,PR0
         2 003122   100000 236100                    LDQ     0,,PR1
         2 003123   000006 402007                    MPY     6,DL
         2 003124   000004 036007                    ADLQ    4,DL
         2 003125   200476 756100                    STQ     LEN,,AUTO

     1304    17688    3              FPT_UNFID.SN_ = VECTOR(AMR$REC$.SN_->VARY$STRNG);

  17688  2 003126   000001 471500                    LDP1    1,,PR0
         2 003127   200476 235100                    LDA     LEN,,AUTO
         2 003130   000020 735000                    ALS     16
         2 003131   000140 135007                    SBLA    96,DL
         2 003132   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 003133   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 003134   202114 757100                    STAQ    @OPTLEN+1,,AUTO

     1305    17689    3           END;

     1306    17690    2     IF AMR$REC$.WSN_ ~= ADDR(NIL)

  17690  2 003135   000015 236100                    LDQ     13,,PR0
         2 003136   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003137   003145 600000 2                  TZE     s:17693
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:233  

     1307    17691    2        THEN
     1308    17692    2           FPT_UNFID.WSN_ = VECTOR(AMR$REC$.WSN_->AM$WSN);

  17692  2 003140   000015 471500                    LDP1    13,,PR0
         2 003141   000023 235000 3                  LDA     19
         2 003142   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 003143   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 003144   202116 757100                    STAQ    FORM$+1,,AUTO

     1309    17693    2     FPT_UNFID.ASN_ = VECTOR(AMR$REC$.V.ASN#);

  17693  2 003145   177640 235007                    LDA     65440,DL
         2 003146   000000 236000 xsym               LDQ     SEG3$
         2 003147   000104 036000 3                  ADLQ    68
         2 003150   202120 757100                    STAQ    COUNTER1+2,,AUTO

     1310    17694    2     FPT_UNFID.RES_ = VECTOR(AMR$REC$.V.RES#);

  17694  2 003151   777640 235007                    LDA     -96,DL
         2 003152   000000 236000 xsym               LDQ     SEG3$
         2 003153   000026 036003                    ADLQ    22,DU
         2 003154   202122 757100                    STAQ    COUNTER2+1,,AUTO

     1311    17695    2     FPT_UNFID.LEN_ = VECTOR(LEN);

  17695  2 003155   777640 235007                    LDA     -96,DL
         2 003156   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 003157   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 003160   000476 036003                    ADLQ    318,DU
         2 003161   202124 757100                    STAQ    COUNTER2+3,,AUTO

     1312    17696    2     CALL M$UNFID(FPT_UNFID) ALTRET(DISPDCB60);

  17696  2 003162   202102 630500                    EPPR0   FPT_UNFID,,AUTO
         2 003163   420021 713400                    CLIMB   alt,+8209
         2 003164   404400 401760                    pmme    nvectors=10
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:234  
         2 003165   010713 702000 2                  TSX2    DISPDCB60

     1313    17697    2     DEST$=PINCRC(DEST$,1);

  17697  2 003166   200035 236100                    LDQ     DEST$,,AUTO
         2 003167   200000 036007                    ADLQ    65536,DL
         2 003170   200035 756100                    STQ     DEST$,,AUTO

     1314    17698    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN) ALTRET(DISPDCB55);

  17698  2 003171   200476 630500                    EPPR0   LEN,,AUTO
         2 003172   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 003173   200034 631500                    EPPR1   IN$,,AUTO
         2 003174   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 003175   200035 633500                    EPPR3   DEST$,,AUTO
         2 003176   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 003177   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 003200   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 003201   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003202   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003203   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003204   010711 702000 2                  TSX2    DISPDCB55

     1315    17699    2     IN$=ADDR(INBUFF);

  17699  2 003205   200037 630500                    EPPR0   INBUFF,,AUTO
         2 003206   200034 450500                    STP0    IN$,,AUTO

     1316    17700    2      IF AMR$REC$.V.INITZ.SCRUB#

  17700  2 003207   000000 471400 xsym               LDP1    SEG3$
         2 003210   100022 236100                    LDQ     18,,PR1
         2 003211   400000 316007                    CANQ    -131072,DL
         2 003212   003226 600000 2                  TZE     s:17704

     1317    17701    2        THEN
     1318    17702    2       CALL DISP_OPT_YESNO(SCRUBOPT,,ADDR(AMR$REC$.V.INITZ.SCRUB#)) ALTRET (DISPDCB55)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:235  
             17702                 ;

  17702  2 003213   000000 236000 xsym               LDQ     SEG3$
         2 003214   000106 036000 3                  ADLQ    70
         2 003215   202372 756100                    STQ     CLSDCB+46,,AUTO
         2 003216   202372 633500                    EPPR3   CLSDCB+46,,AUTO
         2 003217   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 003220   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 003221   202132 756100                    STQ     LEN+1,,AUTO
         2 003222   000107 236000 3                  LDQ     71
         2 003223   202131 756100                    STQ     OPEN+1,,AUTO
         2 003224   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 003225   010711 702000 2                  TSX2    DISPDCB55

     1319    17703        /*** Fun ***/
     1320    17704    2     IF (AMR$REC$.V.FUN#~=0)

  17704  2 003226   000000 470400 xsym               LDP0    SEG3$
         2 003227   000023 236100                    LDQ     19,,PR0
         2 003230   777000 316007                    CANQ    -512,DL
         2 003231   003325 600000 2                  TZE     s:17723

     1321    17705    2        THEN
     1322    17706    3           DO;

     1323    17707    3              INBUFF=',Fun=';

  17707  2 003232   040100 100400                    MLR     fill='040'O
         2 003233   001060 000005 1                  ADSC9   CONSTCLS+50              cn=0,n=5
         2 003234   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1324    17708    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,5,TAB_VAL) ALTRET(DISPDCB55);

  17708  2 003235   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 003236   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 003237   000110 236000 3                  LDQ     72
         2 003240   202355 756100                    STQ     CLSDCB+33,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:236  
         2 003241   200034 631500                    EPPR1   IN$,,AUTO
         2 003242   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 003243   200035 633500                    EPPR3   DEST$,,AUTO
         2 003244   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 003245   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 003246   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 003247   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003250   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003251   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003252   010711 702000 2                  TSX2    DISPDCB55

     1325    17709    4   DISPDCB5:  DO CASE(AMR$REC$.V.FUN#);

  17709  2 003253   000000 470400 xsym  DISPDCB5     LDP0    SEG3$
         2 003254   000023 236100                    LDQ     19,,PR0
         2 003255   000011 772000                    QRL     9
         2 003256   000777 376007                    ANQ     511,DL
         2 003257   000004 116007                    CMPQ    4,DL
         2 003260   003262 602006 2                  TNC     DISPDCB5+7,QL
         2 003261   003307 710000 2                  TRA     s:17720
         2 003262   003307 710000 2                  TRA     s:17720
         2 003263   003266 710000 2                  TRA     s:17711
         2 003264   003274 710000 2                  TRA     s:17714
         2 003265   003302 710000 2                  TRA     s:17717

     1326    17710    4               CASE(%UPDATE#);

     1327    17711    4                 INBUFF='Update';

  17711  2 003266   040100 100400                    MLR     fill='040'O
         2 003267   001062 000006 1                  ADSC9   CONSTCLS+52              cn=0,n=6
         2 003270   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1328    17712    4                 LEN=6;

  17712  2 003271   000006 235007                    LDA     6,DL
         2 003272   200476 755100                    STA     LEN,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:237  
         2 003273   003307 710000 2                  TRA     s:17720

     1329    17713    4               CASE(%IN#);

     1330    17714    4                 INBUFF='In';

  17714  2 003274   040100 100400                    MLR     fill='040'O
         2 003275   001064 000002 1                  ADSC9   CONSTCLS+54              cn=0,n=2
         2 003276   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1331    17715    4                 LEN=2;

  17715  2 003277   000002 235007                    LDA     2,DL
         2 003300   200476 755100                    STA     LEN,,AUTO
         2 003301   003307 710000 2                  TRA     s:17720

     1332    17716    4               CASE(%CREATE#);

     1333    17717    4                 INBUFF='Create';

  17717  2 003302   040100 100400                    MLR     fill='040'O
         2 003303   001065 000006 1                  ADSC9   CONSTCLS+55              cn=0,n=6
         2 003304   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1334    17718    4                 LEN=6;

  17718  2 003305   000006 235007                    LDA     6,DL
         2 003306   200476 755100                    STA     LEN,,AUTO

     1335    17719    4               END DISPDCB5;

     1336    17720    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17720  2 003307   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 003310   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 003311   200476 631500                    EPPR1   LEN,,AUTO
         2 003312   202355 451500                    STP1    CLSDCB+33,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:238  
         2 003313   200034 633500                    EPPR3   IN$,,AUTO
         2 003314   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 003315   200035 634500                    EPPR4   DEST$,,AUTO
         2 003316   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 003317   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 003320   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 003321   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003322   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003323   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003324   010711 702000 2                  TSX2    DISPDCB55

     1337    17721    3           END;

     1338    17722        /*** Share ***/
     1339    17723    2     IF (AMR$REC$.V.SHARE#~=0)

  17723  2 003325   000000 470400 xsym               LDP0    SEG3$
         2 003326   000022 236100                    LDQ     18,,PR0
         2 003327   000030 316007                    CANQ    24,DL
         2 003330   003424 600000 2                  TZE     s:17742

     1340    17724    2        THEN
     1341    17725    3           DO;

     1342    17726    3              INBUFF=',Share=';

  17726  2 003331   040100 100400                    MLR     fill='040'O
         2 003332   001067 000007 1                  ADSC9   CONSTCLS+57              cn=0,n=7
         2 003333   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1343    17727    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,7,TAB_VAL) ALTRET(DISPDCB55);

  17727  2 003334   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 003335   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 003336   000053 236000 3                  LDQ     43
         2 003337   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 003340   200034 631500                    EPPR1   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:239  
         2 003341   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 003342   200035 633500                    EPPR3   DEST$,,AUTO
         2 003343   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 003344   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 003345   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 003346   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003347   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003350   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003351   010711 702000 2                  TSX2    DISPDCB55

     1344    17728    4   DISPDCB10: DO CASE(AMR$REC$.V.SHARE#);

  17728  2 003352   000000 470400 xsym  DISPDCB10    LDP0    SEG3$
         2 003353   000022 236100                    LDQ     18,,PR0
         2 003354   000003 772000                    QRL     3
         2 003355   000003 376007                    ANQ     3,DL
         2 003356   000004 116007                    CMPQ    4,DL
         2 003357   003361 602006 2                  TNC     DISPDCB10+7,QL
         2 003360   003406 710000 2                  TRA     s:17739
         2 003361   003406 710000 2                  TRA     s:17739
         2 003362   003365 710000 2                  TRA     s:17730
         2 003363   003373 710000 2                  TRA     s:17733
         2 003364   003401 710000 2                  TRA     s:17736

     1345    17729    4               CASE(%ALL#);

     1346    17730    4                 INBUFF='All';

  17730  2 003365   040100 100400                    MLR     fill='040'O
         2 003366   001071 000003 1                  ADSC9   CONSTCLS+59              cn=0,n=3
         2 003367   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1347    17731    4                 LEN=3;

  17731  2 003370   000003 235007                    LDA     3,DL
         2 003371   200476 755100                    STA     LEN,,AUTO
         2 003372   003406 710000 2                  TRA     s:17739
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:240  

     1348    17732    4               CASE(%IN#);

     1349    17733    4                 INBUFF='In';

  17733  2 003373   040100 100400                    MLR     fill='040'O
         2 003374   001064 000002 1                  ADSC9   CONSTCLS+54              cn=0,n=2
         2 003375   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1350    17734    4                 LEN=2;

  17734  2 003376   000002 235007                    LDA     2,DL
         2 003377   200476 755100                    STA     LEN,,AUTO
         2 003400   003406 710000 2                  TRA     s:17739

     1351    17735    4               CASE(%NONE#);

     1352    17736    4                 INBUFF='None';

  17736  2 003401   040100 100400                    MLR     fill='040'O
         2 003402   001072 000004 1                  ADSC9   CONSTCLS+60              cn=0,n=4
         2 003403   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1353    17737    4                 LEN=4;

  17737  2 003404   000004 235007                    LDA     4,DL
         2 003405   200476 755100                    STA     LEN,,AUTO

     1354    17738    4               END DISPDCB10;

     1355    17739    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17739  2 003406   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 003407   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 003410   200476 631500                    EPPR1   LEN,,AUTO
         2 003411   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 003412   200034 633500                    EPPR3   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:241  
         2 003413   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 003414   200035 634500                    EPPR4   DEST$,,AUTO
         2 003415   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 003416   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 003417   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 003420   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003421   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003422   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003423   010711 702000 2                  TSX2    DISPDCB55

     1356    17740    3           END;

     1357    17741        /*** Exist ***/
     1358    17742    2     IF (AMR$REC$.V.EXIST#~=0)

  17742  2 003424   000000 470400 xsym               LDP0    SEG3$
         2 003425   000022 236100                    LDQ     18,,PR0
         2 003426   000600 316007                    CANQ    384,DL
         2 003427   003523 600000 2                  TZE     s:17761

     1359    17743    2        THEN
     1360    17744    3           DO;

     1361    17745    3              INBUFF=',Exist=';

  17745  2 003430   040100 100400                    MLR     fill='040'O
         2 003431   001073 000007 1                  ADSC9   CONSTCLS+61              cn=0,n=7
         2 003432   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1362    17746    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,7,TAB_VAL) ALTRET(DISPDCB55);

  17746  2 003433   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 003434   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 003435   000053 236000 3                  LDQ     43
         2 003436   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 003437   200034 631500                    EPPR1   IN$,,AUTO
         2 003440   202354 451500                    STP1    CLSDCB+32,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:242  
         2 003441   200035 633500                    EPPR3   DEST$,,AUTO
         2 003442   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 003443   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 003444   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 003445   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003446   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003447   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003450   010711 702000 2                  TSX2    DISPDCB55

     1363    17747    4   DISPDCB15: DO CASE(AMR$REC$.V.EXIST#);

  17747  2 003451   000000 470400 xsym  DISPDCB15    LDP0    SEG3$
         2 003452   000022 236100                    LDQ     18,,PR0
         2 003453   000007 772000                    QRL     7
         2 003454   000003 376007                    ANQ     3,DL
         2 003455   000004 116007                    CMPQ    4,DL
         2 003456   003460 602006 2                  TNC     DISPDCB15+7,QL
         2 003457   003505 710000 2                  TRA     s:17758
         2 003460   003505 710000 2                  TRA     s:17758
         2 003461   003500 710000 2                  TRA     s:17755
         2 003462   003464 710000 2                  TRA     s:17749
         2 003463   003472 710000 2                  TRA     s:17752

     1364    17748    4               CASE(%OLDFILE#);

     1365    17749    4                 INBUFF='OldFile';

  17749  2 003464   040100 100400                    MLR     fill='040'O
         2 003465   001075 000007 1                  ADSC9   CONSTCLS+63              cn=0,n=7
         2 003466   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1366    17750    4                 LEN=7;

  17750  2 003467   000007 235007                    LDA     7,DL
         2 003470   200476 755100                    STA     LEN,,AUTO
         2 003471   003505 710000 2                  TRA     s:17758

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:243  
     1367    17751    4               CASE(%NEWFILE#);

     1368    17752    4                 INBUFF='NewFile';

  17752  2 003472   040100 100400                    MLR     fill='040'O
         2 003473   001077 000007 1                  ADSC9   CONSTCLS+65              cn=0,n=7
         2 003474   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1369    17753    4                 LEN=7;

  17753  2 003475   000007 235007                    LDA     7,DL
         2 003476   200476 755100                    STA     LEN,,AUTO
         2 003477   003505 710000 2                  TRA     s:17758

     1370    17754    4               CASE(%ERROR#);

     1371    17755    4                 INBUFF='Error';

  17755  2 003500   040100 100400                    MLR     fill='040'O
         2 003501   001101 000005 1                  ADSC9   CONSTCLS+67              cn=0,n=5
         2 003502   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1372    17756    4                 LEN=5;

  17756  2 003503   000005 235007                    LDA     5,DL
         2 003504   200476 755100                    STA     LEN,,AUTO

     1373    17757    4               END DISPDCB15;

     1374    17758    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17758  2 003505   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 003506   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 003507   200476 631500                    EPPR1   LEN,,AUTO
         2 003510   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 003511   200034 633500                    EPPR3   IN$,,AUTO
         2 003512   202354 453500                    STP3    CLSDCB+32,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:244  
         2 003513   200035 634500                    EPPR4   DEST$,,AUTO
         2 003514   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 003515   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 003516   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 003517   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003520   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003521   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003522   010711 702000 2                  TSX2    DISPDCB55

     1375    17759    3           END;

     1376    17760        /*** Org ***/
     1377    17761    2     IF (AMR$REC$.V.ORG#~=0)

  17761  2 003523   000000 470400 xsym               LDP0    SEG3$
         2 003524   000024 236100                    LDQ     20,,PR0
         2 003525   777000 316007                    CANQ    -512,DL
         2 003526   004054 600000 2                  TZE     s:17846

     1378    17762    2        THEN
     1379    17763    3           DO;

     1380    17764    3              INBUFF=',Org=';

  17764  2 003527   040100 100400                    MLR     fill='040'O
         2 003530   001103 000005 1                  ADSC9   CONSTCLS+69              cn=0,n=5
         2 003531   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1381    17765    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,5,TAB_VAL) ALTRET(DISPDCB55);

  17765  2 003532   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 003533   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 003534   000110 236000 3                  LDQ     72
         2 003535   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 003536   200034 631500                    EPPR1   IN$,,AUTO
         2 003537   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 003540   200035 633500                    EPPR3   DEST$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:245  
         2 003541   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 003542   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 003543   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 003544   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 003545   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003546   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 003547   010711 702000 2                  TSX2    DISPDCB55

     1382    17766    4   DISPDCB20: DO CASE(AMR$REC$.V.ORG#);

  17766  2 003550   000000 470400 xsym  DISPDCB20    LDP0    SEG3$
         2 003551   000024 236100                    LDQ     20,,PR0
         2 003552   000011 772000                    QRL     9
         2 003553   000777 376007                    ANQ     511,DL
         2 003554   000032 116007                    CMPQ    26,DL
         2 003555   003557 602006 2                  TNC     DISPDCB20+7,QL
         2 003556   004031 710000 2                  TRA     s:17840
         2 003557   004031 710000 2                  TRA     s:17840
         2 003560   003611 710000 2                  TRA     s:17768
         2 003561   003617 710000 2                  TRA     s:17771
         2 003562   003625 710000 2                  TRA     s:17774
         2 003563   003655 710000 2                  TRA     s:17786
         2 003564   003641 710000 2                  TRA     s:17780
         2 003565   003633 710000 2                  TRA     s:17777
         2 003566   003647 710000 2                  TRA     s:17783
         2 003567   003713 710000 2                  TRA     s:17801
         2 003570   003743 710000 2                  TRA     s:17813
         2 003571   004007 710000 2                  TRA     s:17831
         2 003572   003727 710000 2                  TRA     s:17807
         2 003573   003773 710000 2                  TRA     s:17825
         2 003574   003735 710000 2                  TRA     s:17810
         2 003575   004031 710000 2                  TRA     s:17840
         2 003576   003663 710000 2                  TRA     s:17789
         2 003577   003671 710000 2                  TRA     s:17792
         2 003600   003677 710000 2                  TRA     s:17795
         2 003601   003705 710000 2                  TRA     s:17798
         2 003602   003721 710000 2                  TRA     s:17804
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:246  
         2 003603   003757 710000 2                  TRA     s:17819
         2 003604   003751 710000 2                  TRA     s:17816
         2 003605   003765 710000 2                  TRA     s:17822
         2 003606   004015 710000 2                  TRA     s:17834
         2 003607   004023 710000 2                  TRA     s:17837
         2 003610   004001 710000 2                  TRA     s:17828

     1383    17767    4               CASE(%CONSEC#);

     1384    17768    4                 INBUFF='Consec';

  17768  2 003611   040100 100400                    MLR     fill='040'O
         2 003612   001105 000006 1                  ADSC9   CONSTCLS+71              cn=0,n=6
         2 003613   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1385    17769    4                 LEN=6;

  17769  2 003614   000006 235007                    LDA     6,DL
         2 003615   200476 755100                    STA     LEN,,AUTO
         2 003616   004036 710000 2                  TRA     s:17843

     1386    17770    4               CASE(%KEYED#);

     1387    17771    4                 INBUFF='Keyed';

  17771  2 003617   040100 100400                    MLR     fill='040'O
         2 003620   001107 000005 1                  ADSC9   CONSTCLS+73              cn=0,n=5
         2 003621   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1388    17772    4                 LEN=5;

  17772  2 003622   000005 235007                    LDA     5,DL
         2 003623   200476 755100                    STA     LEN,,AUTO
         2 003624   004036 710000 2                  TRA     s:17843

     1389    17773    4               CASE(%RANDOM#);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:247  
     1390    17774    4                 INBUFF='Random';

  17774  2 003625   040100 100400                    MLR     fill='040'O
         2 003626   001111 000006 1                  ADSC9   CONSTCLS+75              cn=0,n=6
         2 003627   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1391    17775    4                 LEN=6;

  17775  2 003630   000006 235007                    LDA     6,DL
         2 003631   200476 755100                    STA     LEN,,AUTO
         2 003632   004036 710000 2                  TRA     s:17843

     1392    17776    4               CASE(%INDEXED#);

     1393    17777    4                 INBUFF='Indexed';

  17777  2 003633   040100 100400                    MLR     fill='040'O
         2 003634   001113 000007 1                  ADSC9   CONSTCLS+77              cn=0,n=7
         2 003635   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1394    17778    4                 LEN=7;

  17778  2 003636   000007 235007                    LDA     7,DL
         2 003637   200476 755100                    STA     LEN,,AUTO
         2 003640   004036 710000 2                  TRA     s:17843

     1395    17779    4               CASE(%RELATIVE#);

     1396    17780    4                 INBUFF='Relative';

  17780  2 003641   040100 100400                    MLR     fill='040'O
         2 003642   001115 000010 1                  ADSC9   CONSTCLS+79              cn=0,n=8
         2 003643   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1397    17781    4                 LEN=8;

  17781  2 003644   000010 235007                    LDA     8,DL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:248  
         2 003645   200476 755100                    STA     LEN,,AUTO
         2 003646   004036 710000 2                  TRA     s:17843

     1398    17782    4               CASE(%IDS#);

     1399    17783    4                 INBUFF='IDS';

  17783  2 003647   040100 100400                    MLR     fill='040'O
         2 003650   001117 000003 1                  ADSC9   CONSTCLS+81              cn=0,n=3
         2 003651   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1400    17784    4                 LEN=3;

  17784  2 003652   000003 235007                    LDA     3,DL
         2 003653   200476 755100                    STA     LEN,,AUTO
         2 003654   004036 710000 2                  TRA     s:17843

     1401    17785    4               CASE(%UR#);

     1402    17786    4                 INBUFF='UR';

  17786  2 003655   040100 100400                    MLR     fill='040'O
         2 003656   001120 000002 1                  ADSC9   CONSTCLS+82              cn=0,n=2
         2 003657   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1403    17787    4                 LEN=2;

  17787  2 003660   000002 235007                    LDA     2,DL
         2 003661   200476 755100                    STA     LEN,,AUTO
         2 003662   004036 710000 2                  TRA     s:17843

     1404    17788    4               CASE(%FIXED#);

     1405    17789    4                 INBUFF='Fixed';

  17789  2 003663   040100 100400                    MLR     fill='040'O
         2 003664   001121 000005 1                  ADSC9   CONSTCLS+83              cn=0,n=5
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:249  
         2 003665   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1406    17790    4                 LEN=5;

  17790  2 003666   000005 235007                    LDA     5,DL
         2 003667   200476 755100                    STA     LEN,,AUTO
         2 003670   004036 710000 2                  TRA     s:17843

     1407    17791    4               CASE(%VARIABLE#);

     1408    17792    4                 INBUFF='Variable';

  17792  2 003671   040100 100400                    MLR     fill='040'O
         2 003672   001123 000010 1                  ADSC9   CONSTCLS+85              cn=0,n=8
         2 003673   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1409    17793    4                 LEN=8;

  17793  2 003674   000010 235007                    LDA     8,DL
         2 003675   200476 755100                    STA     LEN,,AUTO
         2 003676   004036 710000 2                  TRA     s:17843

     1410    17794    4               CASE(%UNDEF#);

     1411    17795    4                 INBUFF='Undef';

  17795  2 003677   040100 100400                    MLR     fill='040'O
         2 003700   001125 000005 1                  ADSC9   CONSTCLS+87              cn=0,n=5
         2 003701   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1412    17796    4                 LEN=5;

  17796  2 003702   000005 235007                    LDA     5,DL
         2 003703   200476 755100                    STA     LEN,,AUTO
         2 003704   004036 710000 2                  TRA     s:17843

     1413    17797    4               CASE(%RESTRICT#);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:250  

     1414    17798    4                 INBUFF='Restrict';

  17798  2 003705   040100 100400                    MLR     fill='040'O
         2 003706   001127 000010 1                  ADSC9   CONSTCLS+89              cn=0,n=8
         2 003707   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1415    17799    4                 LEN=8;

  17799  2 003710   000010 235007                    LDA     8,DL
         2 003711   200476 755100                    STA     LEN,,AUTO
         2 003712   004036 710000 2                  TRA     s:17843

     1416    17800    4               CASE(%TERMINAL#);

     1417    17801    4                 INBUFF='Terminal';

  17801  2 003713   040100 100400                    MLR     fill='040'O
         2 003714   001131 000010 1                  ADSC9   CONSTCLS+91              cn=0,n=8
         2 003715   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1418    17802    4                 LEN=8;

  17802  2 003716   000010 235007                    LDA     8,DL
         2 003717   200476 755100                    STA     LEN,,AUTO
         2 003720   004036 710000 2                  TRA     s:17843

     1419    17803    4               CASE(%FREE#);

     1420    17804    4                 INBUFF='Free';

  17804  2 003721   040100 100400                    MLR     fill='040'O
         2 003722   001133 000004 1                  ADSC9   CONSTCLS+93              cn=0,n=4
         2 003723   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1421    17805    4                 LEN=4;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:251  
  17805  2 003724   000004 235007                    LDA     4,DL
         2 003725   200476 755100                    STA     LEN,,AUTO
         2 003726   004036 710000 2                  TRA     s:17843

     1422    17806    4               CASE(%CG#);

     1423    17807    4                 INBUFF='CG';

  17807  2 003727   040100 100400                    MLR     fill='040'O
         2 003730   001134 000002 1                  ADSC9   CONSTCLS+94              cn=0,n=2
         2 003731   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1424    17808    4                 LEN=2;

  17808  2 003732   000002 235007                    LDA     2,DL
         2 003733   200476 755100                    STA     LEN,,AUTO
         2 003734   004036 710000 2                  TRA     s:17843

     1425    17809    4               CASE(%IREL#);

     1426    17810    4                 INBUFF='IRel';

  17810  2 003735   040100 100400                    MLR     fill='040'O
         2 003736   001135 000004 1                  ADSC9   CONSTCLS+95              cn=0,n=4
         2 003737   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1427    17811    4                 LEN=4;

  17811  2 003740   000004 235007                    LDA     4,DL
         2 003741   200476 755100                    STA     LEN,,AUTO
         2 003742   004036 710000 2                  TRA     s:17843

     1428    17812    4               CASE(%SYMB#);

     1429    17813    4                 INBUFF='Symb';

  17813  2 003743   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:252  
         2 003744   001136 000004 1                  ADSC9   CONSTCLS+96              cn=0,n=4
         2 003745   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1430    17814    4                 LEN=4;

  17814  2 003746   000004 235007                    LDA     4,DL
         2 003747   200476 755100                    STA     LEN,,AUTO
         2 003750   004036 710000 2                  TRA     s:17843

     1431    17815    4               CASE (%DBGCG#);

     1432    17816    4                INBUFF='DbgCG';

  17816  2 003751   040100 100400                    MLR     fill='040'O
         2 003752   001137 000005 1                  ADSC9   CONSTCLS+97              cn=0,n=5
         2 003753   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1433    17817    4                LEN=5;

  17817  2 003754   000005 235007                    LDA     5,DL
         2 003755   200476 755100                    STA     LEN,,AUTO
         2 003756   004036 710000 2                  TRA     s:17843

     1434    17818    4               CASE (%DBGDCB#);

     1435    17819    4                INBUFF='DbgDCB';

  17819  2 003757   040100 100400                    MLR     fill='040'O
         2 003760   001141 000006 1                  ADSC9   CONSTCLS+99              cn=0,n=6
         2 003761   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1436    17820    4                LEN=6;

  17820  2 003762   000006 235007                    LDA     6,DL
         2 003763   200476 755100                    STA     LEN,,AUTO
         2 003764   004036 710000 2                  TRA     s:17843

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:253  
     1437    17821    4               CASE (%DBGSYSID#);

     1438    17822    4                INBUFF='DbgSysID';

  17822  2 003765   040100 100400                    MLR     fill='040'O
         2 003766   001143 000010 1                  ADSC9   CONSTCLS+101             cn=0,n=8
         2 003767   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1439    17823    4                LEN=8;

  17823  2 003770   000010 235007                    LDA     8,DL
         2 003771   200476 755100                    STA     LEN,,AUTO
         2 003772   004036 710000 2                  TRA     s:17843

     1440    17824    4               CASE (%HANDLER#);

     1441    17825    4                INBUFF='Handler';

  17825  2 003773   040100 100400                    MLR     fill='040'O
         2 003774   001145 000007 1                  ADSC9   CONSTCLS+103             cn=0,n=7
         2 003775   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1442    17826    4                LEN=7;

  17826  2 003776   000007 235007                    LDA     7,DL
         2 003777   200476 755100                    STA     LEN,,AUTO
         2 004000   004036 710000 2                  TRA     s:17843

     1443    17827    4               CASE (%FORM#);

     1444    17828    4                INBUFF='Form';

  17828  2 004001   040100 100400                    MLR     fill='040'O
         2 004002   001147 000004 1                  ADSC9   CONSTCLS+105             cn=0,n=4
         2 004003   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1445    17829    4                LEN=4;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:254  

  17829  2 004004   000004 235007                    LDA     4,DL
         2 004005   200476 755100                    STA     LEN,,AUTO
         2 004006   004036 710000 2                  TRA     s:17843

     1446    17830    4               CASE (%FPRG#);

     1447    17831    4                INBUFF='FPrg';

  17831  2 004007   040100 100400                    MLR     fill='040'O
         2 004010   001150 000004 1                  ADSC9   CONSTCLS+106             cn=0,n=4
         2 004011   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1448    17832    4                LEN=4;

  17832  2 004012   000004 235007                    LDA     4,DL
         2 004013   200476 755100                    STA     LEN,,AUTO
         2 004014   004036 710000 2                  TRA     s:17843

     1449    17833    4               CASE (%SE#);

     1450    17834    4                INBUFF='SE';

  17834  2 004015   040100 100400                    MLR     fill='040'O
         2 004016   001151 000002 1                  ADSC9   CONSTCLS+107             cn=0,n=2
         2 004017   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1451    17835    4                LEN=2;

  17835  2 004020   000002 235007                    LDA     2,DL
         2 004021   200476 755100                    STA     LEN,,AUTO
         2 004022   004036 710000 2                  TRA     s:17843

     1452    17836    4               CASE (%X364#);

     1453    17837    4                INBUFF='X364';

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:255  
  17837  2 004023   040100 100400                    MLR     fill='040'O
         2 004024   001152 000004 1                  ADSC9   CONSTCLS+108             cn=0,n=4
         2 004025   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1454    17838    4                LEN=4;

  17838  2 004026   000004 235007                    LDA     4,DL
         2 004027   200476 755100                    STA     LEN,,AUTO
         2 004030   004036 710000 2                  TRA     s:17843

     1455    17839    4               CASE(ELSE);

     1456    17840    4                 INBUFF='???';

  17840  2 004031   040100 100400                    MLR     fill='040'O
         2 004032   001153 000003 1                  ADSC9   CONSTCLS+109             cn=0,n=3
         2 004033   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1457    17841    4                 LEN=3;

  17841  2 004034   000003 235007                    LDA     3,DL
         2 004035   200476 755100                    STA     LEN,,AUTO

     1458    17842    4               END DISPDCB20;

     1459    17843    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17843  2 004036   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004037   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004040   200476 631500                    EPPR1   LEN,,AUTO
         2 004041   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 004042   200034 633500                    EPPR3   IN$,,AUTO
         2 004043   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 004044   200035 634500                    EPPR4   DEST$,,AUTO
         2 004045   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 004046   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 004047   202352 455500                    STP5    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:256  
         2 004050   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004051   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004052   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004053   010711 702000 2                  TSX2    DISPDCB55

     1460    17844    3           END;

     1461    17845        /*** Disp ***/
     1462    17846    2     IF (AMR$REC$.V.DISP#~=0)

  17846  2 004054   000000 470400 xsym               LDP0    SEG3$
         2 004055   000027 236100                    LDQ     23,,PR0
         2 004056   000777 316007                    CANQ    511,DL
         2 004057   004143 600000 2                  TZE     s:17862

     1463    17847    2        THEN
     1464    17848    3           DO;

     1465    17849    3              INBUFF=',Disp=';

  17849  2 004060   040100 100400                    MLR     fill='040'O
         2 004061   001154 000006 1                  ADSC9   CONSTCLS+110             cn=0,n=6
         2 004062   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1466    17850    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',DISP='),TAB_VAL) ALTRET(
             17850                       DISPDCB55);

  17850  2 004063   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004064   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004065   000052 236000 3                  LDQ     42
         2 004066   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 004067   200034 631500                    EPPR1   IN$,,AUTO
         2 004070   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 004071   200035 633500                    EPPR3   DEST$,,AUTO
         2 004072   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 004073   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004074   202352 454500                    STP4    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:257  
         2 004075   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004076   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004077   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004100   010711 702000 2                  TSX2    DISPDCB55

     1467    17851    4   DISPDCB25: DO CASE(AMR$REC$.V.DISP#);

  17851  2 004101   000000 470400 xsym  DISPDCB25    LDP0    SEG3$
         2 004102   000027 720100                    LXL0    23,,PR0
         2 004103   000777 360003                    ANX0    511,DU
         2 004104   000003 100003                    CMPX0   3,DU
         2 004105   004107 602010 2                  TNC     DISPDCB25+6,X0
         2 004106   004125 710000 2                  TRA     s:17859
         2 004107   004125 710000 2                  TRA     s:17859
         2 004110   004112 710000 2                  TRA     s:17853
         2 004111   004120 710000 2                  TRA     s:17856

     1468    17852    4               CASE(%SCRATCH#);

     1469    17853    4                 INBUFF='Scratch';

  17853  2 004112   040100 100400                    MLR     fill='040'O
         2 004113   001160 000007 1                  ADSC9   CONSTCLS+114             cn=0,n=7
         2 004114   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1470    17854    4                 LEN=7;

  17854  2 004115   000007 235007                    LDA     7,DL
         2 004116   200476 755100                    STA     LEN,,AUTO
         2 004117   004125 710000 2                  TRA     s:17859

     1471    17855    4               CASE(%NAMED#);

     1472    17856    4                 INBUFF='Named';

  17856  2 004120   040100 100400                    MLR     fill='040'O
         2 004121   001162 000005 1                  ADSC9   CONSTCLS+116             cn=0,n=5
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:258  
         2 004122   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1473    17857    4                 LEN=5;

  17857  2 004123   000005 235007                    LDA     5,DL
         2 004124   200476 755100                    STA     LEN,,AUTO

     1474    17858    4               END DISPDCB25;

     1475    17859    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17859  2 004125   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004126   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004127   200476 631500                    EPPR1   LEN,,AUTO
         2 004130   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 004131   200034 633500                    EPPR3   IN$,,AUTO
         2 004132   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 004133   200035 634500                    EPPR4   DEST$,,AUTO
         2 004134   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 004135   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 004136   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 004137   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004140   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004141   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004142   010711 702000 2                  TSX2    DISPDCB55

     1476    17860    3           END;

     1477    17861        /*** Acs ***/
     1478    17862    2     IF (AMR$REC$.V.ACS#~=0)

  17862  2 004143   000000 470400 xsym               LDP0    SEG3$
         2 004144   000024 236100                    LDQ     20,,PR0
         2 004145   000777 316007                    CANQ    511,DL
         2 004146   004242 600000 2                  TZE     s:17881

     1479    17863    2        THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:259  
     1480    17864    3           DO;

     1481    17865    3              INBUFF=',Acs=';

  17865  2 004147   040100 100400                    MLR     fill='040'O
         2 004150   001164 000005 1                  ADSC9   CONSTCLS+118             cn=0,n=5
         2 004151   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1482    17866    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Acs='),TAB_VAL) ALTRET(
             17866                       DISPDCB55);

  17866  2 004152   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004153   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004154   000110 236000 3                  LDQ     72
         2 004155   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 004156   200034 631500                    EPPR1   IN$,,AUTO
         2 004157   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 004160   200035 633500                    EPPR3   DEST$,,AUTO
         2 004161   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 004162   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004163   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 004164   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004165   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004166   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004167   010711 702000 2                  TSX2    DISPDCB55

     1483    17867    4   DISPDCB30: DO CASE(AMR$REC$.V.ACS#);

  17867  2 004170   000000 470400 xsym  DISPDCB30    LDP0    SEG3$
         2 004171   000024 720100                    LXL0    20,,PR0
         2 004172   000777 360003                    ANX0    511,DU
         2 004173   000005 100003                    CMPX0   5,DU
         2 004174   004176 602010 2                  TNC     DISPDCB30+6,X0
         2 004175   004224 710000 2                  TRA     s:17878
         2 004176   004224 710000 2                  TRA     s:17878
         2 004177   004203 710000 2                  TRA     s:17869
         2 004200   004211 710000 2                  TRA     s:17872
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:260  
         2 004201   004224 710000 2                  TRA     s:17878
         2 004202   004217 710000 2                  TRA     s:17875

     1484    17868    4               CASE(%SEQUEN#);

     1485    17869    4                 INBUFF='Sequen';

  17869  2 004203   040100 100400                    MLR     fill='040'O
         2 004204   001166 000006 1                  ADSC9   CONSTCLS+120             cn=0,n=6
         2 004205   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1486    17870    4                 LEN=6;

  17870  2 004206   000006 235007                    LDA     6,DL
         2 004207   200476 755100                    STA     LEN,,AUTO
         2 004210   004224 710000 2                  TRA     s:17878

     1487    17871    4               CASE(%DIRECT#);

     1488    17872    4                 INBUFF='Direct';

  17872  2 004211   040100 100400                    MLR     fill='040'O
         2 004212   001170 000006 1                  ADSC9   CONSTCLS+122             cn=0,n=6
         2 004213   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1489    17873    4                 LEN=6;

  17873  2 004214   000006 235007                    LDA     6,DL
         2 004215   200476 755100                    STA     LEN,,AUTO
         2 004216   004224 710000 2                  TRA     s:17878

     1490    17874    4               CASE(%JRNL#);

     1491    17875    4                 INBUFF='Jrnl';

  17875  2 004217   040100 100400                    MLR     fill='040'O
         2 004220   001172 000004 1                  ADSC9   CONSTCLS+124             cn=0,n=4
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:261  
         2 004221   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1492    17876    4                 LEN=4;

  17876  2 004222   000004 235007                    LDA     4,DL
         2 004223   200476 755100                    STA     LEN,,AUTO

     1493    17877    4               END DISPDCB30;

     1494    17878    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17878  2 004224   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004225   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004226   200476 631500                    EPPR1   LEN,,AUTO
         2 004227   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 004230   200034 633500                    EPPR3   IN$,,AUTO
         2 004231   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 004232   200035 634500                    EPPR4   DEST$,,AUTO
         2 004233   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 004234   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 004235   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 004236   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004237   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004240   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004241   010711 702000 2                  TSX2    DISPDCB55

     1495    17879    3           END;

     1496    17880        /*** Blkl ***/
     1497    17881    2     IF (AMR$REC$.V.BLKL#~=0)

  17881  2 004242   000000 470400 xsym               LDP0    SEG3$
         2 004243   000030 220100                    LDX0    24,,PR0
         2 004244   004260 600000 2                  TZE     s:17888

     1498    17882    2        THEN
     1499    17883    3           DO;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:262  

     1500    17884    3              TVAL=AMR$REC$.V.BLKL#;

  17884  2 004245   000030 236100                    LDQ     24,,PR0
         2 004246   000022 772000                    QRL     18
         2 004247   200013 756100                    STQ     TVAL,,AUTO

     1501    17885    3              CALL CNVRT_BLD(SIZEC(',BlkL='),',BlkL=',TVAL) ALTRET(DISPDCB55);

  17885  2 004250   200013 631500                    EPPR1   TVAL,,AUTO
         2 004251   202307 451500                    STP1    @TEXT+1,,AUTO
         2 004252   000111 236000 3                  LDQ     73
         2 004253   202306 756100                    STQ     @FLAG+1,,AUTO
         2 004254   000052 236000 3                  LDQ     42
         2 004255   202305 756100                    STQ     SIZ+2,,AUTO
         2 004256   012300 701000 2                  TSX1    CNVRT_BLD
         2 004257   010711 702000 2                  TSX2    DISPDCB55

     1502    17886    3           END;

     1503    17887        /*** Recl ***/
     1504    17888    2     IF (AMR$REC$.V.RECL#~=CFPT_OPEN.V.RECL#)

  17888  2 004260   000000 470400 xsym               LDP0    SEG3$
         2 004261   000030 236100                    LDQ     24,,PR0
         2 004262   000052 676000 xsym               ERQ     CFPT_OPEN+42
         2 004263   777777 376007                    ANQ     -1,DL
         2 004264   004300 600000 2                  TZE     s:17895

     1505    17889    2        THEN
     1506    17890    3           DO;

     1507    17891    3              TVAL=AMR$REC$.V.RECL#;

  17891  2 004265   000030 236100                    LDQ     24,,PR0
         2 004266   777777 376007                    ANQ     -1,DL
         2 004267   200013 756100                    STQ     TVAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:263  

     1508    17892    3              CALL CNVRT_BLD(SIZEC(',RecL='),',RecL=',TVAL) ALTRET(DISPDCB55);

  17892  2 004270   200013 631500                    EPPR1   TVAL,,AUTO
         2 004271   202307 451500                    STP1    @TEXT+1,,AUTO
         2 004272   000112 236000 3                  LDQ     74
         2 004273   202306 756100                    STQ     @FLAG+1,,AUTO
         2 004274   000052 236000 3                  LDQ     42
         2 004275   202305 756100                    STQ     SIZ+2,,AUTO
         2 004276   012300 701000 2                  TSX1    CNVRT_BLD
         2 004277   010711 702000 2                  TSX2    DISPDCB55

     1509    17893    3           END;

     1510    17894        /*** Density ***/
     1511    17895    2     IF (AMR$REC$.V.DENSITY#~=0)

  17895  2 004300   000000 470400 xsym               LDP0    SEG3$
         2 004301   000044 236100                    LDQ     36,,PR0
         2 004302   000777 316007                    CANQ    511,DL
         2 004303   004406 600000 2                  TZE     s:17917

     1512    17896    2        THEN
     1513    17897    3           DO;

     1514    17898    3              INBUFF=',Den=';

  17898  2 004304   040100 100400                    MLR     fill='040'O
         2 004305   001177 000005 1                  ADSC9   CONSTCLS+129             cn=0,n=5
         2 004306   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1515    17899    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Den='),TAB_VAL) ALTRET(
             17899                       DISPDCB55);

  17899  2 004307   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004310   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004311   000110 236000 3                  LDQ     72
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:264  
         2 004312   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 004313   200034 631500                    EPPR1   IN$,,AUTO
         2 004314   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 004315   200035 633500                    EPPR3   DEST$,,AUTO
         2 004316   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 004317   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004320   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 004321   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004322   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004323   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004324   010711 702000 2                  TSX2    DISPDCB55

     1516    17900    4   DISPDCB35: DO CASE(AMR$REC$.V.DENSITY#);

  17900  2 004325   000000 470400 xsym  DISPDCB35    LDP0    SEG3$
         2 004326   000044 720100                    LXL0    36,,PR0
         2 004327   000777 360003                    ANX0    511,DU
         2 004330   000006 100003                    CMPX0   6,DU
         2 004331   004333 602010 2                  TNC     DISPDCB35+6,X0
         2 004332   004370 710000 2                  TRA     s:17914
         2 004333   004370 710000 2                  TRA     s:17914
         2 004334   004370 710000 2                  TRA     s:17914
         2 004335   004341 710000 2                  TRA     s:17902
         2 004336   004347 710000 2                  TRA     s:17905
         2 004337   004355 710000 2                  TRA     s:17908
         2 004340   004363 710000 2                  TRA     s:17911

     1517    17901    4               CASE(%D800#);

     1518    17902    4                 INBUFF='800';

  17902  2 004341   040100 100400                    MLR     fill='040'O
         2 004342   001201 000003 1                  ADSC9   CONSTCLS+131             cn=0,n=3
         2 004343   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1519    17903    4                 LEN=3;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:265  
  17903  2 004344   000003 235007                    LDA     3,DL
         2 004345   200476 755100                    STA     LEN,,AUTO
         2 004346   004370 710000 2                  TRA     s:17914

     1520    17904    4               CASE(%D1600#);

     1521    17905    4                 INBUFF='1600';

  17905  2 004347   040100 100400                    MLR     fill='040'O
         2 004350   001202 000004 1                  ADSC9   CONSTCLS+132             cn=0,n=4
         2 004351   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1522    17906    4                 LEN=4;

  17906  2 004352   000004 235007                    LDA     4,DL
         2 004353   200476 755100                    STA     LEN,,AUTO
         2 004354   004370 710000 2                  TRA     s:17914

     1523    17907    4               CASE(%D6250#);

     1524    17908    4                 INBUFF='6250';

  17908  2 004355   040100 100400                    MLR     fill='040'O
         2 004356   001203 000004 1                  ADSC9   CONSTCLS+133             cn=0,n=4
         2 004357   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1525    17909    4                 LEN=4;

  17909  2 004360   000004 235007                    LDA     4,DL
         2 004361   200476 755100                    STA     LEN,,AUTO
         2 004362   004370 710000 2                  TRA     s:17914

     1526    17910    4               CASE(%D38000#);

     1527    17911    4                 INBUFF='38000';

  17911  2 004363   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:266  
         2 004364   001204 000005 1                  ADSC9   CONSTCLS+134             cn=0,n=5
         2 004365   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1528    17912    4                 LEN=5;

  17912  2 004366   000005 235007                    LDA     5,DL
         2 004367   200476 755100                    STA     LEN,,AUTO

     1529    17913    4               END DISPDCB35;

     1530    17914    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17914  2 004370   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004371   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004372   200476 631500                    EPPR1   LEN,,AUTO
         2 004373   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 004374   200034 633500                    EPPR3   IN$,,AUTO
         2 004375   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 004376   200035 634500                    EPPR4   DEST$,,AUTO
         2 004377   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 004400   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 004401   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 004402   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004403   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004404   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004405   010711 702000 2                  TSX2    DISPDCB55

     1531    17915    3           END;

     1532    17916        /*** Expire ***/
     1533    17917    2     IF (AMR$REC$.V.EXPIRE#~=0)

  17917  2 004406   000000 470400 xsym               LDP0    SEG3$
         2 004407   000035 235100                    LDA     29,,PR0
         2 004410   004515 600000 2                  TZE     s:17937

     1534    17918    2        THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:267  
     1535    17919    3           DO;

     1536    17920    3              INBUFF=',Expire=';

  17920  2 004411   040100 100400                    MLR     fill='040'O
         2 004412   001206 000010 1                  ADSC9   CONSTCLS+136             cn=0,n=8
         2 004413   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1537    17921    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Expire='),TAB_VAL) ALTRET(
             17921                       DISPDCB55);

  17921  2 004414   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004415   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004416   000113 236000 3                  LDQ     75
         2 004417   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 004420   200034 631500                    EPPR1   IN$,,AUTO
         2 004421   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 004422   200035 633500                    EPPR3   DEST$,,AUTO
         2 004423   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 004424   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004425   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 004426   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004427   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004430   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004431   010711 702000 2                  TSX2    DISPDCB55

     1538    17922    3              IF (AMR$REC$.V.EXPIRE#=-1)

  17922  2 004432   000000 470400 xsym               LDP0    SEG3$
         2 004433   000035 235100                    LDA     29,,PR0
         2 004434   000027 115000 xsym               CMPA    B_VECTNIL+23
         2 004435   004460 601000 2                  TNZ     s:17931

     1539    17923    3                 THEN
     1540    17924    4                    DO;

     1541    17925    4                       INBUFF='Never';
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:268  

  17925  2 004436   040100 100400                    MLR     fill='040'O
         2 004437   001210 000005 1                  ADSC9   CONSTCLS+138             cn=0,n=5
         2 004440   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1542    17926    4                      CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,5,TAB_VAL) ALTRET(DISPDCB55
             17926                                );

  17926  2 004441   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004442   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004443   000110 236000 3                  LDQ     72
         2 004444   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 004445   200034 631500                    EPPR1   IN$,,AUTO
         2 004446   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 004447   200035 633500                    EPPR3   DEST$,,AUTO
         2 004450   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 004451   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004452   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 004453   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004454   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004455   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004456   010711 702000 2                  TSX2    DISPDCB55

     1543    17927    4                    END;

  17927  2 004457   004515 710000 2                  TRA     s:17937

     1544    17928
     1545    17929    3                 ELSE
     1546    17930    4                    DO;

     1547    17931    4                       CALL BINCHAR(TBUFF,AMR$REC$.V.EXPIRE#);

  17931  2 004460   000100 301500                    BTD
         2 004461   000035 000004                    NDSC9   29,,PR0                  cn=0,s=lsgnf,sf=0,n=4
         2 004462   202077 030006                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=6

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:269  
     1548    17932    4                       CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);

  17932  2 004463   200476 631500                    EPPR1   LEN,,AUTO
         2 004464   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 004465   000052 236000 3                  LDQ     42
         2 004466   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 004467   202077 633500                    EPPR3   TBUFF,,AUTO
         2 004470   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 004471   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004472   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 004473   000000 701000 xent               TSX1    CPE$RZEROS
         2 004474   000000 011000                    NOP     0

     1549    17933    4                      CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,TAB_VAL) ALTRET
             17933                                (DISPDCB55);

  17933  2 004475   202077 630500                    EPPR0   TBUFF,,AUTO
         2 004476   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 004477   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004500   202357 756100                    STQ     CLSDCB+35,,AUTO
         2 004501   200476 631500                    EPPR1   LEN,,AUTO
         2 004502   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 004503   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 004504   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 004505   200035 634500                    EPPR4   DEST$,,AUTO
         2 004506   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 004507   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 004510   202353 455500                    STP5    CLSDCB+31,,AUTO
         2 004511   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 004512   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004513   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004514   010711 702000 2                  TSX2    DISPDCB55

     1550    17934    4                    END;

     1551    17935    3           END;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:270  
     1552    17936        /*** Keyx ***/
     1553    17937    2     IF (AMR$REC$.V.KEYX#~=0)

  17937  2 004515   000000 470400 xsym               LDP0    SEG3$
         2 004516   000027 220100                    LDX0    23,,PR0
         2 004517   004533 600000 2                  TZE     s:17944

     1554    17938    2        THEN
     1555    17939    3           DO;

     1556    17940    3              TVAL=AMR$REC$.V.KEYX#;

  17940  2 004520   000027 236100                    LDQ     23,,PR0
         2 004521   000022 772000                    QRL     18
         2 004522   200013 756100                    STQ     TVAL,,AUTO

     1557    17941    3              CALL CNVRT_BLD(SIZEC(',KeyX='),',KeyX=',TVAL) ALTRET(DISPDCB55);

  17941  2 004523   200013 631500                    EPPR1   TVAL,,AUTO
         2 004524   202307 451500                    STP1    @TEXT+1,,AUTO
         2 004525   000114 236000 3                  LDQ     76
         2 004526   202306 756100                    STQ     @FLAG+1,,AUTO
         2 004527   000052 236000 3                  LDQ     42
         2 004530   202305 756100                    STQ     SIZ+2,,AUTO
         2 004531   012300 701000 2                  TSX1    CNVRT_BLD
         2 004532   010711 702000 2                  TSX2    DISPDCB55

     1558    17942    3           END;

     1559    17943        /*** Keyl ***/
     1560    17944    2     IF (AMR$REC$.V.KEYL#~=0)

  17944  2 004533   000000 470400 xsym               LDP0    SEG3$
         2 004534   000027 236100                    LDQ     23,,PR0
         2 004535   777000 316007                    CANQ    -512,DL
         2 004536   004553 600000 2                  TZE     s:17951

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:271  
     1561    17945    2        THEN
     1562    17946    3           DO;

     1563    17947    3              TVAL=AMR$REC$.V.KEYL#;

  17947  2 004537   000027 236100                    LDQ     23,,PR0
         2 004540   000011 772000                    QRL     9
         2 004541   000777 376007                    ANQ     511,DL
         2 004542   200013 756100                    STQ     TVAL,,AUTO

     1564    17948    3              CALL CNVRT_BLD(SIZEC(',KeyL='),',KeyL=',TVAL) ALTRET(DISPDCB55);

  17948  2 004543   200013 631500                    EPPR1   TVAL,,AUTO
         2 004544   202307 451500                    STP1    @TEXT+1,,AUTO
         2 004545   000115 236000 3                  LDQ     77
         2 004546   202306 756100                    STQ     @FLAG+1,,AUTO
         2 004547   000052 236000 3                  LDQ     42
         2 004550   202305 756100                    STQ     SIZ+2,,AUTO
         2 004551   012300 701000 2                  TSX1    CNVRT_BLD
         2 004552   010711 702000 2                  TSX2    DISPDCB55

     1565    17949    3           END;

     1566    17950        /*** Spare ***/
     1567    17951    2     IF (AMR$REC$.V.SPARE#~=0)

  17951  2 004553   000000 470400 xsym               LDP0    SEG3$
         2 004554   000032 220100                    LDX0    26,,PR0
         2 004555   004571 600000 2                  TZE     s:17958

     1568    17952    2        THEN
     1569    17953    3           DO;

     1570    17954    3              TVAL=AMR$REC$.V.SPARE#;

  17954  2 004556   000032 236100                    LDQ     26,,PR0
         2 004557   000022 772000                    QRL     18
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:272  
         2 004560   200013 756100                    STQ     TVAL,,AUTO

     1571    17955    3              CALL CNVRT_BLD(SIZEC(',Spare='),',Spare=',TVAL) ALTRET(DISPDCB55);

  17955  2 004561   200013 631500                    EPPR1   TVAL,,AUTO
         2 004562   202307 451500                    STP1    @TEXT+1,,AUTO
         2 004563   000116 236000 3                  LDQ     78
         2 004564   202306 756100                    STQ     @FLAG+1,,AUTO
         2 004565   000053 236000 3                  LDQ     43
         2 004566   202305 756100                    STQ     SIZ+2,,AUTO
         2 004567   012300 701000 2                  TSX1    CNVRT_BLD
         2 004570   010711 702000 2                  TSX2    DISPDCB55

     1572    17956    3           END;

     1573    17957        /*** Lslide ***/
     1574    17958    2     IF (AMR$REC$.V.LSLIDE#~=0)

  17958  2 004571   000000 470400 xsym               LDP0    SEG3$
         2 004572   000031 220100                    LDX0    25,,PR0
         2 004573   004607 600000 2                  TZE     s:17965

     1575    17959    2        THEN
     1576    17960    3           DO;

     1577    17961    3              TVAL=AMR$REC$.V.LSLIDE#;

  17961  2 004574   000031 236100                    LDQ     25,,PR0
         2 004575   000022 772000                    QRL     18
         2 004576   200013 756100                    STQ     TVAL,,AUTO

     1578    17962    3              CALL CNVRT_BLD(SIZEC(',LSlide='),',LSlide=',TVAL) ALTRET(DISPDCB55);

  17962  2 004577   200013 631500                    EPPR1   TVAL,,AUTO
         2 004600   202307 451500                    STP1    @TEXT+1,,AUTO
         2 004601   000117 236000 3                  LDQ     79
         2 004602   202306 756100                    STQ     @FLAG+1,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:273  
         2 004603   000113 236000 3                  LDQ     75
         2 004604   202305 756100                    STQ     SIZ+2,,AUTO
         2 004605   012300 701000 2                  TSX1    CNVRT_BLD
         2 004606   010711 702000 2                  TSX2    DISPDCB55

     1579    17963    3           END;

     1580    17964        /*** LRDL0 ***/
     1581    17965    2     IF (AMR$REC$.V.LRDL0#~=0)

  17965  2 004607   000000 470400 xsym               LDP0    SEG3$
         2 004610   000031 720100                    LXL0    25,,PR0
         2 004611   004625 600000 2                  TZE     s:17972

     1582    17966    2        THEN
     1583    17967    3           DO;

     1584    17968    3              TVAL=AMR$REC$.V.LRDL0#;

  17968  2 004612   000031 236100                    LDQ     25,,PR0
         2 004613   777777 376007                    ANQ     -1,DL
         2 004614   200013 756100                    STQ     TVAL,,AUTO

     1585    17969    3              CALL CNVRT_BLD(SIZEC(',LRdL0='),',LRdL0=',TVAL) ALTRET(DISPDCB55);

  17969  2 004615   200013 631500                    EPPR1   TVAL,,AUTO
         2 004616   202307 451500                    STP1    @TEXT+1,,AUTO
         2 004617   000120 236000 3                  LDQ     80
         2 004620   202306 756100                    STQ     @FLAG+1,,AUTO
         2 004621   000053 236000 3                  LDQ     43
         2 004622   202305 756100                    STQ     SIZ+2,,AUTO
         2 004623   012300 701000 2                  TSX1    CNVRT_BLD
         2 004624   010711 702000 2                  TSX2    DISPDCB55

     1586    17970    3           END;

     1587    17971        /*** Acsveh ***/
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:274  
     1588    17972    2     IF (AMR$REC$.ACSVEH_~=ADDR(NIL))

  17972  2 004625   000000 470400 xsym               LDP0    SEG3$
         2 004626   000006 236100                    LDQ     6,,PR0
         2 004627   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004630   005501 600000 2                  TZE     s:18085

     1589    17973    2        THEN
     1590    17974    3           DO CASE (AMR$REC$.V.ASN#);

  17974  2 004631   000023 720100                    LXL0    19,,PR0
         2 004632   000777 360003                    ANX0    511,DU
         2 004633   000005 100003                    CMPX0   5,DU
         2 004634   004636 602010 2                  TNC     s:17974+5,X0
         2 004635   005501 710000 2                  TRA     s:18085
         2 004636   005501 710000 2                  TRA     s:18085
         2 004637   004643 710000 2                  TRA     s:17976
         2 004640   005501 710000 2                  TRA     s:18085
         2 004641   005050 710000 2                  TRA     s:17999
         2 004642   005050 710000 2                  TRA     s:17999

     1591    17975    3            CASE (%FILE#);

     1592    17976    3              INBUFF=',AcsVeh=((';

  17976  2 004643   040100 100400                    MLR     fill='040'O
         2 004644   001224 000012 1                  ADSC9   CONSTCLS+150             cn=0,n=10
         2 004645   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1593    17977    3             CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',AcsVeh=(('),TAB_VAL) ALTRET(
             17977                       DISPDCB55);

  17977  2 004646   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004647   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004650   000051 236000 3                  LDQ     41
         2 004651   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 004652   200034 631500                    EPPR1   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:275  
         2 004653   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 004654   200035 633500                    EPPR3   DEST$,,AUTO
         2 004655   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 004656   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 004657   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 004660   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004661   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004662   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004663   010711 702000 2                  TSX2    DISPDCB55

     1594    17978    3              TVAL=AMR$REC$.ACSVEH_->VLP$ATTR.SIZE#*4; /*Calc. #CHARS in vlp*/

  17978  2 004664   000000 470400 xsym               LDP0    SEG3$
         2 004665   000006 471500                    LDP1    6,,PR0
         2 004666   100000 235100                    LDA     0,,PR1
         2 004667   000002 735000                    ALS     2
         2 004670   200013 755100                    STA     TVAL,,AUTO

     1595    17979    3              TEMP1$=PINCRC(AMR$REC$.ACSVEH_,4); /*Set ptr to 1ST vehicle*/

  17979  2 004671   000006 236100                    LDQ     6,,PR0
         2 004672   000001 036003                    ADLQ    1,DU
         2 004673   200012 756100                    STQ     TEMP1$,,AUTO

     1596    17980        /* ****          Insert vehicle names into print image */
     1597    17981    4              DO WHILE((TVAL-3)>0);

  17981  2 004674   004767 710000 2                  TRA     s:17989

     1598    17982    4                 LEN=TEMP1$->VLP$ACSVEH.C;

  17982  2 004675   200012 470500                    LDP0    TEMP1$,,AUTO
         2 004676   000100 101500                    MRL     fill='000'O
         2 004677   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         2 004700   200476 000004                    ADSC9   LEN,,AUTO                cn=0,n=4

     1599    17983    4                 INBUFF=TEMP1$->VLP$ACSVEH.VEHICLE#;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:276  

  17983  2 004701   000100 101500                    MRL     fill='000'O
         2 004702   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         2 004703   202352 000002                    ADSC9   CLSDCB+30,,AUTO          cn=0,n=2
         2 004704   202352 220100                    LDX0    CLSDCB+30,,AUTO
         2 004705   040100 100540                    MLR     fill='040'O
         2 004706   000000 600010                    ADSC9   0,,PR0                   cn=3,n=*X0
         2 004707   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1600    17984    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  17984  2 004710   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004711   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004712   200476 631500                    EPPR1   LEN,,AUTO
         2 004713   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 004714   200034 633500                    EPPR3   IN$,,AUTO
         2 004715   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 004716   200035 634500                    EPPR4   DEST$,,AUTO
         2 004717   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 004720   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 004721   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 004722   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004723   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004724   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004725   010711 702000 2                  TSX2    DISPDCB55

     1601    17985    4                 INBUFF=',';

  17985  2 004726   040100 100400                    MLR     fill='040'O
         2 004727   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 004730   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1602    17986    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);

  17986  2 004731   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 004732   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 004733   000033 236000 3                  LDQ     27
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:277  
         2 004734   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 004735   200034 630500                    EPPR0   IN$,,AUTO
         2 004736   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 004737   200035 631500                    EPPR1   DEST$,,AUTO
         2 004740   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 004741   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 004742   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 004743   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 004744   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004745   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 004746   010711 702000 2                  TSX2    DISPDCB55

     1603    17987    4                 TVAL=TVAL-TEMP1$->VLP$ACSVEH.C-3;

  17987  2 004747   200012 470500                    LDP0    TEMP1$,,AUTO
         2 004750   000100 101500                    MRL     fill='000'O
         2 004751   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         2 004752   202352 000004                    ADSC9   CLSDCB+30,,AUTO          cn=0,n=4
         2 004753   200013 236100                    LDQ     TVAL,,AUTO
         2 004754   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 004755   000003 136007                    SBLQ    3,DL
         2 004756   200013 756100                    STQ     TVAL,,AUTO

     1604    17988    4                 TEMP1$=PINCRC(TEMP1$,TEMP1$->VLP$ACSVEH.C+3);

  17988  2 004757   000100 101500                    MRL     fill='000'O
         2 004760   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         2 004761   202352 000004                    ADSC9   CLSDCB+30,,AUTO          cn=0,n=4
         2 004762   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 004763   000020 736000                    QLS     16
         2 004764   600000 036007                    ADLQ    -65536,DL
         2 004765   200012 036100                    ADLQ    TEMP1$,,AUTO
         2 004766   200012 756100                    STQ     TEMP1$,,AUTO

     1605    17989    4              END;

  17989  2 004767   200013 235100                    LDA     TVAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:278  
         2 004770   000003 115007                    CMPA    3,DL
         2 004771   004675 605400 2                  TPNZ    s:17982

     1606    17990    3              DEST$=PINCRC(DEST$,-1);

  17990  2 004772   200035 236100                    LDQ     DEST$,,AUTO
         2 004773   000034 036000 xsym               ADLQ    B_VECTNIL+28
         2 004774   200035 756100                    STQ     DEST$,,AUTO

     1607    17991    3              INBUFF=')';

  17991  2 004775   040100 100400                    MLR     fill='040'O
         2 004776   000122 000001 3                  ADSC9   82                       cn=0,n=1
         2 004777   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1608    17992    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);

  17992  2 005000   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005001   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005002   000033 236000 3                  LDQ     27
         2 005003   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 005004   200034 630500                    EPPR0   IN$,,AUTO
         2 005005   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 005006   200035 631500                    EPPR1   DEST$,,AUTO
         2 005007   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 005010   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 005011   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 005012   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005013   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005014   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005015   010711 702000 2                  TSX2    DISPDCB55

     1609    17993        /* ****    Insert permission bits into image. Permissions are the same
     1610    17994                   for each entry so just display the FIRST.*/
     1611    17995    3              CALL DISP_PMSN(PINCRC(AMR$REC$.ACSVEH_,4)) ALTRET(DISPDCB55);

  17995  2 005016   000000 470400 xsym               LDP0    SEG3$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:279  
         2 005017   000006 236100                    LDQ     6,,PR0
         2 005020   000001 036003                    ADLQ    1,DU
         2 005021   202373 756100                    STQ     CLSDCB+47,,AUTO
         2 005022   202373 631500                    EPPR1   CLSDCB+47,,AUTO
         2 005023   202131 451500                    STP1    OPEN+1,,AUTO
         2 005024   012366 701000 2                  TSX1    DISP_PMSN
         2 005025   010711 702000 2                  TSX2    DISPDCB55

     1612    17996    3              INBUFF=')';

  17996  2 005026   040100 100400                    MLR     fill='040'O
         2 005027   000122 000001 3                  ADSC9   82                       cn=0,n=1
         2 005030   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1613    17997    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);

  17997  2 005031   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005032   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005033   000033 236000 3                  LDQ     27
         2 005034   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 005035   200034 630500                    EPPR0   IN$,,AUTO
         2 005036   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 005037   200035 631500                    EPPR1   DEST$,,AUTO
         2 005040   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 005041   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 005042   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 005043   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005044   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005045   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005046   010711 702000 2                  TSX2    DISPDCB55
         2 005047   005501 710000 2                  TRA     s:18085

     1614    17998    3            CASE (%DEVICE#, %COMGROUP#);

     1615    17999    3              TEMP1$ = AMR$REC$.ACSVEH_;

  17999  2 005050   200012 756100                    STQ     TEMP1$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:280  

     1616    18000    3              IF TEMP1$ -> AM$WINDOW.FWINDOW# ~= ' '

  18000  2 005051   200012 471500                    LDP1    TEMP1$,,AUTO
         2 005052   100000 236100                    LDQ     0,,PR1
         2 005053   000035 116000 xsym               CMPQ    B_VECTNIL+29
         2 005054   005105 600000 2                  TZE     s:18007

     1617    18001    4                THEN DO;

     1618    18002    4                 CALL CONCAT (INBUFF,',FWindow=', TEMP1$ -> AM$WINDOW.FWINDOW#);

  18002  2 005055   040100 100400                    MLR     fill='040'O
         2 005056   001227 000011 1                  ADSC9   CONSTCLS+153             cn=0,n=9
         2 005057   200037 000011                    ADSC9   INBUFF,,AUTO             cn=0,n=9
         2 005060   040100 100500                    MLR     fill='040'O
         2 005061   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 005062   200041 200767                    ADSC9   INBUFF+2,,AUTO           cn=1,n=503

     1619    18003    4                 CALL INDEX (LEN, ' ', INBUFF);

  18003  2 005063   000000 124500                    SCM     mask='000'O
         2 005064   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 005065   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005066   200476 000100                    ARG     LEN,,AUTO

     1620    18004    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18004  2 005067   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005070   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005071   200476 630500                    EPPR0   LEN,,AUTO
         2 005072   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 005073   200034 631500                    EPPR1   IN$,,AUTO
         2 005074   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 005075   200035 633500                    EPPR3   DEST$,,AUTO
         2 005076   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 005077   200036 634500                    EPPR4   OUTBUFF$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:281  
         2 005100   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 005101   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005102   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005103   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005104   010711 702000 2                  TSX2    DISPDCB55

     1621    18005    4                  ALTRET (DISPDCB55);
     1622    18006    4                 END;

     1623    18007    4              DO CASE (TEMP1$ -> AM$WINDOW.POSITION#);

  18007  2 005105   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005106   000002 236100                    LDQ     2,,PR0
         2 005107   000033 772000                    QRL     27
         2 005110   000005 116007                    CMPQ    5,DL
         2 005111   005113 602006 2                  TNC     s:18007+6,QL
         2 005112   005150 710000 2                  TRA     s:18021
         2 005113   005150 710000 2                  TRA     s:18021
         2 005114   005120 710000 2                  TRA     s:18009
         2 005115   005134 710000 2                  TRA     s:18015
         2 005116   005142 710000 2                  TRA     s:18018
         2 005117   005126 710000 2                  TRA     s:18012

     1624    18008    4               CASE (%POSITION_TOP#);

     1625    18009    4                 INBUFF = ',Position=top';

  18009  2 005120   040100 100400                    MLR     fill='040'O
         2 005121   001232 000015 1                  ADSC9   CONSTCLS+156             cn=0,n=13
         2 005122   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1626    18010    4                 LEN = LENGTHC(',Position=top');

  18010  2 005123   000015 235007                    LDA     13,DL
         2 005124   200476 755100                    STA     LEN,,AUTO
         2 005125   005151 710000 2                  TRA     s:18023

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:282  
     1627    18011    4               CASE (%POSITION_BOTTOM#);

     1628    18012    4                 INBUFF = ',Position=bottom';

  18012  2 005126   040100 100400                    MLR     fill='040'O
         2 005127   001236 000020 1                  ADSC9   CONSTCLS+160             cn=0,n=16
         2 005130   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1629    18013    4                 LEN = LENGTHC(',Position=bottom');

  18013  2 005131   000020 235007                    LDA     16,DL
         2 005132   200476 755100                    STA     LEN,,AUTO
         2 005133   005151 710000 2                  TRA     s:18023

     1630    18014    4               CASE (%POSITION_LEFT#);

     1631    18015    4                 INBUFF = ',Position=left';

  18015  2 005134   040100 100400                    MLR     fill='040'O
         2 005135   001242 000016 1                  ADSC9   CONSTCLS+164             cn=0,n=14
         2 005136   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1632    18016    4                 LEN = LENGTHC(',Position=left');

  18016  2 005137   000016 235007                    LDA     14,DL
         2 005140   200476 755100                    STA     LEN,,AUTO
         2 005141   005151 710000 2                  TRA     s:18023

     1633    18017    4               CASE (%POSITION_RIGHT#);

     1634    18018    4                 INBUFF = ',Position=right';

  18018  2 005142   040100 100400                    MLR     fill='040'O
         2 005143   001246 000017 1                  ADSC9   CONSTCLS+168             cn=0,n=15
         2 005144   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1635    18019    4                 LEN = LENGTHC(',Position=right');
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:283  

  18019  2 005145   000017 235007                    LDA     15,DL
         2 005146   200476 755100                    STA     LEN,,AUTO
         2 005147   005151 710000 2                  TRA     s:18023

     1636    18020    4               CASE (ELSE);

     1637    18021    4                 LEN = 0;

  18021  2 005150   200476 450100                    STZ     LEN,,AUTO

     1638    18022    4               END;

     1639    18023    3              IF LEN > 0

  18023  2 005151   200476 235100                    LDA     LEN,,AUTO
         2 005152   005171 604400 2                  TMOZ    s:18027

     1640    18024    3                THEN
     1641    18025    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18025  2 005153   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005154   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005155   200476 631500                    EPPR1   LEN,,AUTO
         2 005156   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 005157   200034 633500                    EPPR3   IN$,,AUTO
         2 005160   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 005161   200035 634500                    EPPR4   DEST$,,AUTO
         2 005162   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 005163   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 005164   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 005165   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005166   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005167   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005170   010711 702000 2                  TSX2    DISPDCB55

     1642    18026    3                  ALTRET (DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:284  
     1643    18027    3              TVAL = TEMP1$ -> AM$WINDOW.LENGTH#;

  18027  2 005171   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005172   000001 236100                    LDQ     1,,PR0
         2 005173   000022 732000                    QRS     18
         2 005174   200013 756100                    STQ     TVAL,,AUTO

     1644    18028    3              IF TVAL ~= 0

  18028  2 005175   005206 600000 2                  TZE     s:18032

     1645    18029    3                THEN
     1646    18030    3                 CALL CNVRT_BLD(SIZEC(',WLength='), ',WLength=', TVAL)

  18030  2 005176   200013 631500                    EPPR1   TVAL,,AUTO
         2 005177   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005200   000123 236000 3                  LDQ     83
         2 005201   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005202   000124 236000 3                  LDQ     84
         2 005203   202305 756100                    STQ     SIZ+2,,AUTO
         2 005204   012300 701000 2                  TSX1    CNVRT_BLD
         2 005205   010711 702000 2                  TSX2    DISPDCB55

     1647    18031    3                  ALTRET (DISPDCB55);
     1648    18032    3              TVAL = TEMP1$ -> AM$WINDOW.MINLENGTH#;

  18032  2 005206   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005207   000004 236100                    LDQ     4,,PR0
         2 005210   000033 772000                    QRL     27
         2 005211   200013 756100                    STQ     TVAL,,AUTO

     1649    18033    3              IF TVAL ~= 0

  18033  2 005212   005223 600000 2                  TZE     s:18037

     1650    18034    3                THEN
     1651    18035    3                 CALL CNVRT_BLD(SIZEC(',MinLength='), ',MinLength=', TVAL)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:285  

  18035  2 005213   200013 631500                    EPPR1   TVAL,,AUTO
         2 005214   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005215   000125 236000 3                  LDQ     85
         2 005216   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005217   000126 236000 3                  LDQ     86
         2 005220   202305 756100                    STQ     SIZ+2,,AUTO
         2 005221   012300 701000 2                  TSX1    CNVRT_BLD
         2 005222   010711 702000 2                  TSX2    DISPDCB55

     1652    18036    3                  ALTRET (DISPDCB55);
     1653    18037    3              TVAL = TEMP1$ -> AM$WINDOW.WIDTH#;

  18037  2 005223   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005224   000001 236100                    LDQ     1,,PR0
         2 005225   000022 736000                    QLS     18
         2 005226   000022 732000                    QRS     18
         2 005227   200013 756100                    STQ     TVAL,,AUTO

     1654    18038    3              IF TVAL ~= 0

  18038  2 005230   005241 600000 2                  TZE     s:18042

     1655    18039    3                THEN
     1656    18040    3                 CALL CNVRT_BLD(SIZEC(',WWidth='), ',WWidth=', TVAL)

  18040  2 005231   200013 631500                    EPPR1   TVAL,,AUTO
         2 005232   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005233   000127 236000 3                  LDQ     87
         2 005234   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005235   000113 236000 3                  LDQ     75
         2 005236   202305 756100                    STQ     SIZ+2,,AUTO
         2 005237   012300 701000 2                  TSX1    CNVRT_BLD
         2 005240   010711 702000 2                  TSX2    DISPDCB55

     1657    18041    3                  ALTRET (DISPDCB55);
     1658    18042    3              TVAL = TEMP1$ -> AM$WINDOW.MINWIDTH#;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:286  

  18042  2 005241   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005242   000004 236100                    LDQ     4,,PR0
         2 005243   000022 772000                    QRL     18
         2 005244   000777 376007                    ANQ     511,DL
         2 005245   200013 756100                    STQ     TVAL,,AUTO

     1659    18043    3              IF TVAL ~= 0

  18043  2 005246   005257 600000 2                  TZE     s:18047

     1660    18044    3                THEN
     1661    18045    3                 CALL CNVRT_BLD(SIZEC(',MinWidth='), ',MinWidth=', TVAL)

  18045  2 005247   200013 631500                    EPPR1   TVAL,,AUTO
         2 005250   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005251   000130 236000 3                  LDQ     88
         2 005252   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005253   000051 236000 3                  LDQ     41
         2 005254   202305 756100                    STQ     SIZ+2,,AUTO
         2 005255   012300 701000 2                  TSX1    CNVRT_BLD
         2 005256   010711 702000 2                  TSX2    DISPDCB55

     1662    18046    3                  ALTRET (DISPDCB55);
     1663    18047    3              CALL DISP_OPT_YESNO (OPTIONALOPT,ADDR(TEMP1$->AM$WINDOW.REMOVABLE#))

  18047  2 005257   200012 236100                    LDQ     TEMP1$,,AUTO
         2 005260   000131 036000 3                  ADLQ    89
         2 005261   202374 756100                    STQ     CLSDCB+48,,AUTO
         2 005262   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005263   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005264   202374 630500                    EPPR0   CLSDCB+48,,AUTO
         2 005265   202132 450500                    STP0    LEN+1,,AUTO
         2 005266   000113 236000 3                  LDQ     75
         2 005267   202131 756100                    STQ     OPEN+1,,AUTO
         2 005270   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005271   010711 702000 2                  TSX2    DISPDCB55
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:287  

     1664    18048    3               ALTRET (DISPDCB55);
     1665    18049    3              CALL DISP_OPT_YESNO (TOPBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.TOPBRDR#))

  18049  2 005272   200012 236100                    LDQ     TEMP1$,,AUTO
         2 005273   000132 036000 3                  ADLQ    90
         2 005274   202375 756100                    STQ     CLSDCB+49,,AUTO
         2 005275   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005276   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005277   202375 630500                    EPPR0   CLSDCB+49,,AUTO
         2 005300   202132 450500                    STP0    LEN+1,,AUTO
         2 005301   000126 236000 3                  LDQ     86
         2 005302   202131 756100                    STQ     OPEN+1,,AUTO
         2 005303   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005304   010711 702000 2                  TSX2    DISPDCB55

     1666    18050    3               ALTRET (DISPDCB55);
     1667    18051    3              CALL DISP_OPT_YESNO (BTMBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.BTMBRDR#))

  18051  2 005305   200012 236100                    LDQ     TEMP1$,,AUTO
         2 005306   000133 036000 3                  ADLQ    91
         2 005307   202376 756100                    STQ     CLSDCB+50,,AUTO
         2 005310   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005311   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005312   202376 630500                    EPPR0   CLSDCB+50,,AUTO
         2 005313   202132 450500                    STP0    LEN+1,,AUTO
         2 005314   000033 236000 3                  LDQ     27
         2 005315   202131 756100                    STQ     OPEN+1,,AUTO
         2 005316   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005317   010711 702000 2                  TSX2    DISPDCB55

     1668    18052    3               ALTRET (DISPDCB55);
     1669    18053    3              TVAL = TEMP1$ -> AM$WINDOW.VBRDRSIZ#;

  18053  2 005320   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005321   000003 236100                    LDQ     3,,PR0
         2 005322   000011 772000                    QRL     9
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:288  
         2 005323   000017 376007                    ANQ     15,DL
         2 005324   200013 756100                    STQ     TVAL,,AUTO

     1670    18054    3              IF TVAL ~= 0

  18054  2 005325   005336 600000 2                  TZE     s:18058

     1671    18055    3                THEN
     1672    18056    3                 CALL CNVRT_BLD(SIZEC(',VBrdrSiz='),',VBrdrSiz=',TVAL)

  18056  2 005326   200013 631500                    EPPR1   TVAL,,AUTO
         2 005327   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005330   000134 236000 3                  LDQ     92
         2 005331   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005332   000051 236000 3                  LDQ     41
         2 005333   202305 756100                    STQ     SIZ+2,,AUTO
         2 005334   012300 701000 2                  TSX1    CNVRT_BLD
         2 005335   010711 702000 2                  TSX2    DISPDCB55

     1673    18057    3                  ALTRET (DISPDCB55);
     1674    18058    3              IF TEMP1$ -> AM$WINDOW.VBRDRCHR# ~= BINASC(0)

  18058  2 005336   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005337   000003 236100                    LDQ     3,,PR0
         2 005340   000777 376007                    ANQ     511,DL
         2 005341   000000 116003                    CMPQ    0,DU
         2 005342   005375 600000 2                  TZE     s:18066

     1675    18059    4                THEN DO;

     1676    18060    4                 CALL CONCAT (INBUFF, ',VBrdrChr=''', TEMP1$->AM$WINDOW.VBRDRCHR#,

  18060  2 005343   040100 100400                    MLR     fill='040'O
         2 005344   001270 000013 1                  ADSC9   CONSTCLS+186             cn=0,n=11
         2 005345   200037 000013                    ADSC9   INBUFF,,AUTO             cn=0,n=11
         2 005346   000003 236100                    LDQ     3,,PR0
         2 005347   200041 552104                    STBQ    INBUFF+2,'04'O,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:289  
         2 005350   040100 100400                    MLR     fill='040'O
         2 005351   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 005352   200042 000764                    ADSC9   INBUFF+3,,AUTO           cn=0,n=500

     1677    18061    4                  '''');
     1678    18062    4                 CALL INDEX (LEN, ' ', INBUFF);

  18062  2 005353   000000 124500                    SCM     mask='000'O
         2 005354   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 005355   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005356   200476 000100                    ARG     LEN,,AUTO

     1679    18063    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18063  2 005357   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005360   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005361   200476 630500                    EPPR0   LEN,,AUTO
         2 005362   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 005363   200034 631500                    EPPR1   IN$,,AUTO
         2 005364   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 005365   200035 633500                    EPPR3   DEST$,,AUTO
         2 005366   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 005367   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 005370   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 005371   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005372   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005373   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005374   010711 702000 2                  TSX2    DISPDCB55

     1680    18064    4                  ALTRET (DISPDCB55);
     1681    18065    4                 END;

     1682    18066    3              CALL DISP_OPT_YESNO (LFTBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.LFTBRDR#))

  18066  2 005375   200012 236100                    LDQ     TEMP1$,,AUTO
         2 005376   000136 036000 3                  ADLQ    94
         2 005377   202377 756100                    STQ     CLSDCB+51,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:290  
         2 005400   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005401   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005402   202377 630500                    EPPR0   CLSDCB+51,,AUTO
         2 005403   202132 450500                    STP0    LEN+1,,AUTO
         2 005404   000110 236000 3                  LDQ     72
         2 005405   202131 756100                    STQ     OPEN+1,,AUTO
         2 005406   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005407   010711 702000 2                  TSX2    DISPDCB55

     1683    18067    3               ALTRET (DISPDCB55);
     1684    18068    3              CALL DISP_OPT_YESNO (RHTBRDROPT,ADDR(TEMP1$ -> AM$WINDOW.RHTBRDR#))

  18068  2 005410   200012 236100                    LDQ     TEMP1$,,AUTO
         2 005411   000137 036000 3                  ADLQ    95
         2 005412   202400 756100                    STQ     CLSDCB+52,,AUTO
         2 005413   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005414   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005415   202400 630500                    EPPR0   CLSDCB+52,,AUTO
         2 005416   202132 450500                    STP0    LEN+1,,AUTO
         2 005417   000051 236000 3                  LDQ     41
         2 005420   202131 756100                    STQ     OPEN+1,,AUTO
         2 005421   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005422   010711 702000 2                  TSX2    DISPDCB55

     1685    18069    3               ALTRET (DISPDCB55);
     1686    18070    3              TVAL = TEMP1$ -> AM$WINDOW.HBRDRSIZ#;

  18070  2 005423   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005424   000003 236100                    LDQ     3,,PR0
         2 005425   000033 772000                    QRL     27
         2 005426   000017 376007                    ANQ     15,DL
         2 005427   200013 756100                    STQ     TVAL,,AUTO

     1687    18071    3              IF TVAL ~= 0

  18071  2 005430   005441 600000 2                  TZE     s:18075

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:291  
     1688    18072    3                THEN
     1689    18073    3                 CALL CNVRT_BLD(SIZEC(',HBrdrSiz='),',HBrdrSiz=',TVAL)

  18073  2 005431   200013 631500                    EPPR1   TVAL,,AUTO
         2 005432   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005433   000140 236000 3                  LDQ     96
         2 005434   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005435   000051 236000 3                  LDQ     41
         2 005436   202305 756100                    STQ     SIZ+2,,AUTO
         2 005437   012300 701000 2                  TSX1    CNVRT_BLD
         2 005440   010711 702000 2                  TSX2    DISPDCB55

     1690    18074    3                  ALTRET (DISPDCB55);
     1691    18075    3              IF TEMP1$ -> AM$WINDOW.HBRDRCHR# ~= BINASC(0)

  18075  2 005441   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005442   000003 236100                    LDQ     3,,PR0
         2 005443   000777 376003                    ANQ     511,DU
         2 005444   000000 116003                    CMPQ    0,DU
         2 005445   005501 600000 2                  TZE     s:18085

     1692    18076    4                THEN DO;

     1693    18077    4                 CALL CONCAT (INBUFF, ',HBrdrChr=''', TEMP1$->AM$WINDOW.HBRDRCHR#,

  18077  2 005446   040100 100400                    MLR     fill='040'O
         2 005447   001276 000013 1                  ADSC9   CONSTCLS+192             cn=0,n=11
         2 005450   200037 000013                    ADSC9   INBUFF,,AUTO             cn=0,n=11
         2 005451   000003 236100                    LDQ     3,,PR0
         2 005452   000022 772000                    QRL     18
         2 005453   200041 552104                    STBQ    INBUFF+2,'04'O,AUTO
         2 005454   040100 100400                    MLR     fill='040'O
         2 005455   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 005456   200042 000764                    ADSC9   INBUFF+3,,AUTO           cn=0,n=500

     1694    18078    4                  '''');
     1695    18079    4                 CALL INDEX (LEN, ' ', INBUFF);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:292  

  18079  2 005457   000000 124500                    SCM     mask='000'O
         2 005460   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 005461   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005462   200476 000100                    ARG     LEN,,AUTO

     1696    18080    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18080  2 005463   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005464   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005465   200476 630500                    EPPR0   LEN,,AUTO
         2 005466   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 005467   200034 631500                    EPPR1   IN$,,AUTO
         2 005470   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 005471   200035 633500                    EPPR3   DEST$,,AUTO
         2 005472   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 005473   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 005474   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 005475   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005476   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005477   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005500   010711 702000 2                  TSX2    DISPDCB55

     1697    18081    4                  ALTRET (DISPDCB55);
     1698    18082    4                 END;

     1699    18083    3           END;

     1700    18084        /*** Access ***/
     1701    18085    2     IF (AMR$REC$.ACCESS_~=ADDR(NIL))

  18085  2 005501   000000 470400 xsym               LDP0    SEG3$
         2 005502   000005 236100                    LDQ     5,,PR0
         2 005503   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005504   005642 600000 2                  TZE     s:18106

     1702    18086    2        THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:293  
     1703    18087    3           DO;

     1704    18088    3              TVAL=AMR$REC$.ACCESS_->VLP$ATTR.SIZE#*4; /*Calc. #CHARS in vlp*/

  18088  2 005505   000005 471500                    LDP1    5,,PR0
         2 005506   100000 235100                    LDA     0,,PR1
         2 005507   000002 735000                    ALS     2
         2 005510   200013 755100                    STA     TVAL,,AUTO

     1705    18089    3              TEMP1$=PINCRC(AMR$REC$.ACCESS_,4); /*Set ptr to 1ST access*/

  18089  2 005511   000005 236100                    LDQ     5,,PR0
         2 005512   000001 036003                    ADLQ    1,DU
         2 005513   200012 756100                    STQ     TEMP1$,,AUTO

     1706    18090        /* ****          Insert access names into image  */
     1707    18091    4              DO WHILE((TVAL-3) > 0);

  18091  2 005514   005637 710000 2                  TRA     s:18104

     1708    18092    4                 INBUFF=',Access=((';

  18092  2 005515   040100 100400                    MLR     fill='040'O
         2 005516   001301 000012 1                  ADSC9   CONSTCLS+195             cn=0,n=10
         2 005517   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1709    18093    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Access=(('),TAB_VAL)
             18093                          ALTRET(DISPDCB55);

  18093  2 005520   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005521   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005522   000051 236000 3                  LDQ     41
         2 005523   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 005524   200034 630500                    EPPR0   IN$,,AUTO
         2 005525   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 005526   200035 631500                    EPPR1   DEST$,,AUTO
         2 005527   202353 451500                    STP1    CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:294  
         2 005530   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 005531   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 005532   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005533   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005534   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005535   010711 702000 2                  TSX2    DISPDCB55

     1710    18094    4                 INBUFF=TEMP1$->VLP$ACCESS.ACCT#;

  18094  2 005536   200012 470500                    LDP0    TEMP1$,,AUTO
         2 005537   040100 100500                    MLR     fill='040'O
         2 005540   000000 400010                    ADSC9   0,,PR0                   cn=2,n=8
         2 005541   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1711    18095    4                 CALL INDEX(LEN,' ',INBUFF);

  18095  2 005542   000000 124500                    SCM     mask='000'O
         2 005543   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 005544   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005545   200476 000100                    ARG     LEN,,AUTO

     1712    18096    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  18096  2 005546   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005547   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005550   200476 631500                    EPPR1   LEN,,AUTO
         2 005551   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 005552   200034 633500                    EPPR3   IN$,,AUTO
         2 005553   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 005554   200035 634500                    EPPR4   DEST$,,AUTO
         2 005555   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 005556   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 005557   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 005560   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005561   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005562   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005563   010711 702000 2                  TSX2    DISPDCB55
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:295  

     1713    18097    4                 INBUFF=')';

  18097  2 005564   040100 100400                    MLR     fill='040'O
         2 005565   000122 000001 3                  ADSC9   82                       cn=0,n=1
         2 005566   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1714    18098    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);

  18098  2 005567   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005570   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005571   000033 236000 3                  LDQ     27
         2 005572   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 005573   200034 630500                    EPPR0   IN$,,AUTO
         2 005574   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 005575   200035 631500                    EPPR1   DEST$,,AUTO
         2 005576   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 005577   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 005600   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 005601   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005602   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005603   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005604   010711 702000 2                  TSX2    DISPDCB55

     1715    18099    4                 CALL DISP_PMSN(TEMP1$) ALTRET(DISPDCB55);

  18099  2 005605   200012 630500                    EPPR0   TEMP1$,,AUTO
         2 005606   202131 450500                    STP0    OPEN+1,,AUTO
         2 005607   012366 701000 2                  TSX1    DISP_PMSN
         2 005610   010711 702000 2                  TSX2    DISPDCB55

     1716    18100    4                 INBUFF=')';

  18100  2 005611   040100 100400                    MLR     fill='040'O
         2 005612   000122 000001 3                  ADSC9   82                       cn=0,n=1
         2 005613   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:296  
     1717    18101    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55);

  18101  2 005614   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 005615   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 005616   000033 236000 3                  LDQ     27
         2 005617   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 005620   200034 630500                    EPPR0   IN$,,AUTO
         2 005621   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 005622   200035 631500                    EPPR1   DEST$,,AUTO
         2 005623   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 005624   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 005625   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 005626   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 005627   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 005630   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 005631   010711 702000 2                  TSX2    DISPDCB55

     1718    18102    4                 TVAL=TVAL-10;                /*Decr. Char. Count*/

  18102  2 005632   000012 336007                    LCQ     10,DL
         2 005633   200013 056100                    ASQ     TVAL,,AUTO

     1719    18103    4                 TEMP1$=PINCRC(TEMP1$,10);    /*Incr. To next access*/

  18103  2 005634   200012 236100                    LDQ     TEMP1$,,AUTO
         2 005635   000141 036000 3                  ADLQ    97
         2 005636   200012 756100                    STQ     TEMP1$,,AUTO

     1720    18104    4              END;

  18104  2 005637   200013 235100                    LDA     TVAL,,AUTO
         2 005640   000003 115007                    CMPA    3,DL
         2 005641   005515 605400 2                  TPNZ    s:18092

     1721    18105    3           END;

     1722    18106    2     CALL DISP_OPT_YESNO(BLOCKEDOPT,ADDR(AMR$REC$.V.BLOCKED#)) ALTRET(DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:297  

  18106  2 005642   000000 236000 xsym               LDQ     SEG3$
         2 005643   000143 036000 3                  ADLQ    99
         2 005644   202401 756100                    STQ     CLSDCB+53,,AUTO
         2 005645   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005646   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005647   202401 630500                    EPPR0   CLSDCB+53,,AUTO
         2 005650   202132 450500                    STP0    LEN+1,,AUTO
         2 005651   000144 236000 3                  LDQ     100
         2 005652   202131 756100                    STQ     OPEN+1,,AUTO
         2 005653   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005654   010711 702000 2                  TSX2    DISPDCB55

     1723    18107    2     CALL DISP_OPT_YESNO(ANSISPANSEQOPT,ADDR(AMR$REC$.V.ANSISPANSEQ#))

  18107  2 005655   000000 236000 xsym               LDQ     SEG3$
         2 005656   000146 036000 3                  ADLQ    102
         2 005657   202402 756100                    STQ     CLSDCB+54,,AUTO
         2 005660   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005661   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005662   202402 630500                    EPPR0   CLSDCB+54,,AUTO
         2 005663   202132 450500                    STP0    LEN+1,,AUTO
         2 005664   000147 236000 3                  LDQ     103
         2 005665   202131 756100                    STQ     OPEN+1,,AUTO
         2 005666   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005667   010711 702000 2                  TSX2    DISPDCB55

     1724    18108    2           ALTRET(DISPDCB55);
     1725    18109    2     CALL DISP_OPT_YESNO(SPANNEDOPT,ADDR(AMR$REC$.V.SPANNED#)) ALTRET(DISPDCB55);

  18109  2 005670   000000 236000 xsym               LDQ     SEG3$
         2 005671   000151 036000 3                  ADLQ    105
         2 005672   202403 756100                    STQ     CLSDCB+55,,AUTO
         2 005673   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005674   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005675   202403 630500                    EPPR0   CLSDCB+55,,AUTO
         2 005676   202132 450500                    STP0    LEN+1,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:298  
         2 005677   000152 236000 3                  LDQ     106
         2 005700   202131 756100                    STQ     OPEN+1,,AUTO
         2 005701   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005702   010711 702000 2                  TSX2    DISPDCB55

     1726    18110    2     IF (AMR$REC$.V.EBCDIC#~=DEFAULT#)

  18110  2 005703   000000 470400 xsym               LDP0    SEG3$
         2 005704   000036 236100                    LDQ     30,,PR0
         2 005705   600000 376003                    ANQ     -65536,DU
         2 005706   200000 116003                    CMPQ    65536,DU
         2 005707   005736 600000 2                  TZE     s:18119

     1727    18111    2        THEN
     1728    18112    3           DO;

     1729    18113    3              CALL DISP_OPT_YESNO(EBCDICOPT,ADDR(AMR$REC$.V.EBCDIC#))

  18113  2 005710   000000 236000 xsym               LDQ     SEG3$
         2 005711   000036 036003                    ADLQ    30,DU
         2 005712   202404 756100                    STQ     CLSDCB+56,,AUTO
         2 005713   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005714   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005715   202404 631500                    EPPR1   CLSDCB+56,,AUTO
         2 005716   202132 451500                    STP1    LEN+1,,AUTO
         2 005717   000154 236000 3                  LDQ     108
         2 005720   202131 756100                    STQ     OPEN+1,,AUTO
         2 005721   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005722   010711 702000 2                  TSX2    DISPDCB55

     1730    18114    3                    ALTRET(DISPDCB55);
     1731    18115    3              CALL DISP_OPT_YESNO(CNVRTOPT,ADDR(AMR$REC$.V.CNVRT#))

  18115  2 005723   000000 236000 xsym               LDQ     SEG3$
         2 005724   000156 036000 3                  ADLQ    110
         2 005725   202405 756100                    STQ     CLSDCB+57,,AUTO
         2 005726   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:299  
         2 005727   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 005730   202405 630500                    EPPR0   CLSDCB+57,,AUTO
         2 005731   202132 450500                    STP0    LEN+1,,AUTO
         2 005732   000157 236000 3                  LDQ     111
         2 005733   202131 756100                    STQ     OPEN+1,,AUTO
         2 005734   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 005735   010711 702000 2                  TSX2    DISPDCB55

     1732    18116    3                  ALTRET(DISPDCB55);
     1733    18117    3           END;

     1734    18118        /*** Nrecs ***/
     1735    18119    2     IF (AMR$REC$.V.NRECS#~=0)

  18119  2 005736   000000 470400 xsym               LDP0    SEG3$
         2 005737   000034 235100                    LDA     28,,PR0
         2 005740   005752 600000 2                  TZE     s:18126

     1736    18120    2        THEN
     1737    18121    3           DO;

     1738    18122    3              TVAL=AMR$REC$.V.NRECS#;

  18122  2 005741   200013 755100                    STA     TVAL,,AUTO

     1739    18123    3              CALL CNVRT_BLD(SIZEC(',NRecs='),',NRecs=',TVAL) ALTRET(DISPDCB55);

  18123  2 005742   200013 631500                    EPPR1   TVAL,,AUTO
         2 005743   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005744   000160 236000 3                  LDQ     112
         2 005745   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005746   000053 236000 3                  LDQ     43
         2 005747   202305 756100                    STQ     SIZ+2,,AUTO
         2 005750   012300 701000 2                  TSX1    CNVRT_BLD
         2 005751   010711 702000 2                  TSX2    DISPDCB55

     1740    18124    3           END;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:300  

     1741    18125        /*** Xtnsize ***/
     1742    18126    2     IF (AMR$REC$.V.XTNSIZE# ~= 0)

  18126  2 005752   000000 470400 xsym               LDP0    SEG3$
         2 005753   000032 720100                    LXL0    26,,PR0
         2 005754   005770 600000 2                  TZE     s:18134

     1743    18127    2        THEN
     1744    18128    3           DO;

     1745    18129    3              TVAL=AMR$REC$.V.XTNSIZE#;

  18129  2 005755   000032 236100                    LDQ     26,,PR0
         2 005756   777777 376007                    ANQ     -1,DL
         2 005757   200013 756100                    STQ     TVAL,,AUTO

     1746    18130    3              CALL CNVRT_BLD(SIZEC(',XtnSize='),',XtnSize=',TVAL)

  18130  2 005760   200013 631500                    EPPR1   TVAL,,AUTO
         2 005761   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005762   000161 236000 3                  LDQ     113
         2 005763   202306 756100                    STQ     @FLAG+1,,AUTO
         2 005764   000124 236000 3                  LDQ     84
         2 005765   202305 756100                    STQ     SIZ+2,,AUTO
         2 005766   012300 701000 2                  TSX1    CNVRT_BLD
         2 005767   010711 702000 2                  TSX2    DISPDCB55

     1747    18131    3                   ALTRET(DISPDCB55);
     1748    18132    3           END;

     1749    18133        /*** Ixtnsize ***/
     1750    18134    2     IF (AMR$REC$.V.IXTNSIZE# ~= 0)

  18134  2 005770   000000 470400 xsym               LDP0    SEG3$
         2 005771   000033 235100                    LDA     27,,PR0
         2 005772   006004 600000 2                  TZE     s:18142
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:301  

     1751    18135    2        THEN
     1752    18136    3           DO;

     1753    18137    3              TVAL=AMR$REC$.V.IXTNSIZE#;

  18137  2 005773   200013 755100                    STA     TVAL,,AUTO

     1754    18138    3              CALL CNVRT_BLD(SIZEC(',IXtnSize='),',IXtnSize=',TVAL)

  18138  2 005774   200013 631500                    EPPR1   TVAL,,AUTO
         2 005775   202307 451500                    STP1    @TEXT+1,,AUTO
         2 005776   000162 236000 3                  LDQ     114
         2 005777   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006000   000051 236000 3                  LDQ     41
         2 006001   202305 756100                    STQ     SIZ+2,,AUTO
         2 006002   012300 701000 2                  TSX1    CNVRT_BLD
         2 006003   010711 702000 2                  TSX2    DISPDCB55

     1755    18139    3                   ALTRET(DISPDCB55);
     1756    18140    3           END;

     1757    18141        /*** Tab ***/
     1758    18142    2     IF (AMR$REC$.TAB_~=ADDR(NIL))

  18142  2 006004   000000 470400 xsym               LDP0    SEG3$
         2 006005   000016 236100                    LDQ     14,,PR0
         2 006006   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006007   006207 600000 2                  TZE     s:18182

     1759    18143    2        THEN
     1760    18144    3           DO;

     1761    18145        /* ****          Check if margin set             */
     1762    18146    3              IF AMR$REC$.TAB_->AM$TAB.MARGIN#~=0

  18146  2 006010   000016 471500                    LDP1    14,,PR0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:302  
         2 006011   100000 236100                    LDQ     0,,PR1
         2 006012   777000 316003                    CANQ    -512,DU
         2 006013   006027 600000 2                  TZE     s:18155

     1763    18147    3                 THEN
     1764    18148    4                    DO;

     1765    18149    4                       TVAL=AMR$REC$.TAB_->AM$TAB.MARGIN#;

  18149  2 006014   100000 236100                    LDQ     0,,PR1
         2 006015   000033 772000                    QRL     27
         2 006016   200013 756100                    STQ     TVAL,,AUTO

     1766    18150    4                       CALL CNVRT_BLD(SIZEC(',Margin='),',Margin=',TVAL)

  18150  2 006017   200013 633500                    EPPR3   TVAL,,AUTO
         2 006020   202307 453500                    STP3    @TEXT+1,,AUTO
         2 006021   000163 236000 3                  LDQ     115
         2 006022   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006023   000113 236000 3                  LDQ     75
         2 006024   202305 756100                    STQ     SIZ+2,,AUTO
         2 006025   012300 701000 2                  TSX1    CNVRT_BLD
         2 006026   010711 702000 2                  TSX2    DISPDCB55

     1767    18151    4                            ALTRET(DISPDCB55);
     1768    18152    4                    END;

     1769    18153        /* ****          Check if any tabs set
     1770    18154                         no tabs assumed if 1ST tab setting is zero*/
     1771    18155    3              IF AMR$REC$.TAB_->AM$TAB.TABS#(0)~=0

  18155  2 006027   000000 470400 xsym               LDP0    SEG3$
         2 006030   000016 471500                    LDP1    14,,PR0
         2 006031   100000 236100                    LDQ     0,,PR1
         2 006032   000777 316003                    CANQ    511,DU
         2 006033   006207 600000 2                  TZE     s:18182

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:303  
     1772    18156    3                 THEN
     1773    18157    4                    DO;

     1774    18158    4                       INBUFF=',Tab=(';

  18158  2 006034   040100 100400                    MLR     fill='040'O
         2 006035   001316 000006 1                  ADSC9   CONSTCLS+208             cn=0,n=6
         2 006036   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1775    18159    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Tab=('),TAB_VAL)

  18159  2 006037   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006040   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006041   000052 236000 3                  LDQ     42
         2 006042   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 006043   200034 631500                    EPPR1   IN$,,AUTO
         2 006044   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 006045   200035 633500                    EPPR3   DEST$,,AUTO
         2 006046   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 006047   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 006050   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 006051   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006052   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006053   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006054   010711 702000 2                  TSX2    DISPDCB55

     1776    18160    4                            ALTRET(DISPDCB55);
     1777    18161        /* ****                Last tab setting assumed when 0 encntrd*/
     1778    18162    5                       DO TVAL=0 TO 30;

  18162  2 006055   200013 450100                    STZ     TVAL,,AUTO

     1779    18163    5                          IF AMR$REC$.TAB_->AM$TAB.TABS#(TVAL)~=0

  18163  2 006056   000000 470400 xsym               LDP0    SEG3$
         2 006057   000016 471500                    LDP1    14,,PR0
         2 006060   200013 235100                    LDA     TVAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:304  
         2 006061   000100 101505                    MRL     fill='000'O
         2 006062   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         2 006063   202352 000004                    ADSC9   CLSDCB+30,,AUTO          cn=0,n=4
         2 006064   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 006065   000000 116003                    CMPQ    0,DU
         2 006066   006155 600000 2                  TZE     s:18175

     1780    18164    5                             THEN
     1781    18165    6                                DO;

     1782    18166    6                                  CALL BINCHAR(TBUFF,AMR$REC$.TAB_->AM$TAB.TABS#(TVAL)
             18166                                            );

  18166  2 006067   000016 471500                    LDP1    14,,PR0
         2 006070   000100 101505                    MRL     fill='000'O
         2 006071   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         2 006072   202352 000004                    ADSC9   CLSDCB+30,,AUTO          cn=0,n=4
         2 006073   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 006074   000000 235003                    LDA     0,DU
         2 006075   202354 757100                    STAQ    CLSDCB+32,,AUTO
         2 006076   000100 301500                    BTD
         2 006077   202354 000010                    NDSC9   CLSDCB+32,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 006100   202077 030006                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=6

     1783    18167    6                                   CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);

  18167  2 006101   200476 631500                    EPPR1   LEN,,AUTO
         2 006102   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 006103   000052 236000 3                  LDQ     42
         2 006104   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 006105   202077 633500                    EPPR3   TBUFF,,AUTO
         2 006106   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 006107   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006110   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 006111   000000 701000 xent               TSX1    CPE$RZEROS
         2 006112   000000 011000                    NOP     0

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:305  
     1784    18168    6                                   CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,
             18168                                            TAB_VAL)

  18168  2 006113   202077 630500                    EPPR0   TBUFF,,AUTO
         2 006114   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 006115   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006116   202357 756100                    STQ     CLSDCB+35,,AUTO
         2 006117   200476 631500                    EPPR1   LEN,,AUTO
         2 006120   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 006121   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 006122   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 006123   200035 634500                    EPPR4   DEST$,,AUTO
         2 006124   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 006125   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 006126   202353 455500                    STP5    CLSDCB+31,,AUTO
         2 006127   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 006130   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006131   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006132   010711 702000 2                  TSX2    DISPDCB55

     1785    18169    6                                        ALTRET(DISPDCB55);
     1786    18170    6                                   INBUFF=',';

  18170  2 006133   040100 100400                    MLR     fill='040'O
         2 006134   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 006135   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1787    18171    6                                   CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)
             18171                                            ALTRET(DISPDCB55);

  18171  2 006136   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006137   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006140   000033 236000 3                  LDQ     27
         2 006141   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 006142   200034 630500                    EPPR0   IN$,,AUTO
         2 006143   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 006144   200035 631500                    EPPR1   DEST$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:306  
         2 006145   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 006146   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 006147   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 006150   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006151   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006152   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006153   010711 702000 2                  TSX2    DISPDCB55

     1788    18172    6                                END;

  18172  2 006154   006157 710000 2                  TRA     s:18176

     1789    18173
     1790    18174    5                             ELSE
     1791    18175    5                                TVAL=31;

  18175  2 006155   000037 235007                    LDA     31,DL
         2 006156   200013 755100                    STA     TVAL,,AUTO

     1792    18176    5                       END;

  18176  2 006157   200013 054100                    AOS     TVAL,,AUTO
         2 006160   200013 235100                    LDA     TVAL,,AUTO
         2 006161   000036 115007                    CMPA    30,DL
         2 006162   006056 604400 2                  TMOZ    s:18163

     1793    18177    4                       DEST$=PINCRC(DEST$,-1);   /*Remove unneeded comma*/

  18177  2 006163   200035 236100                    LDQ     DEST$,,AUTO
         2 006164   000034 036000 xsym               ADLQ    B_VECTNIL+28
         2 006165   200035 756100                    STQ     DEST$,,AUTO

     1794    18178    4                       INBUFF=')';

  18178  2 006166   040100 100400                    MLR     fill='040'O
         2 006167   000122 000001 3                  ADSC9   82                       cn=0,n=1
         2 006170   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:307  

     1795    18179    4                      CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPDCB55
             18179                                );

  18179  2 006171   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006172   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006173   000033 236000 3                  LDQ     27
         2 006174   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 006175   200034 630500                    EPPR0   IN$,,AUTO
         2 006176   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 006177   200035 631500                    EPPR1   DEST$,,AUTO
         2 006200   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 006201   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 006202   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 006203   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006204   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006205   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006206   010711 702000 2                  TSX2    DISPDCB55

     1796    18180    4                    END;

     1797    18181    3           END;

     1798    18182    2     CALL DISP_OPT_YESNO(CTGOPT,ADDR(AMR$REC$.V.CTG#)) ALTRET(DISPDCB55);

  18182  2 006207   000000 236000 xsym               LDQ     SEG3$
         2 006210   000165 036000 3                  ADLQ    117
         2 006211   202406 756100                    STQ     CLSDCB+58,,AUTO
         2 006212   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 006213   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 006214   202406 630500                    EPPR0   CLSDCB+58,,AUTO
         2 006215   202132 450500                    STP0    LEN+1,,AUTO
         2 006216   000166 236000 3                  LDQ     118
         2 006217   202131 756100                    STQ     OPEN+1,,AUTO
         2 006220   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 006221   010711 702000 2                  TSX2    DISPDCB55

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:308  
     1799    18183        /*** Hdr ***/
     1800    18184    2     IF (AMR$REC$.HDR_~=ADDR(NIL))

  18184  2 006222   000000 470400 xsym               LDP0    SEG3$
         2 006223   000017 236100                    LDQ     15,,PR0
         2 006224   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006225   006436 600000 2                  TZE     s:18230

     1801    18185    2        THEN
     1802    18186    3           DO;

     1803    18187    3              IF AMR$REC$.HDR_->AM$HDR.CTL.HEADERHEIGHT#>1

  18187  2 006226   000017 471500                    LDP1    15,,PR0
         2 006227   100000 236100                    LDQ     0,,PR1
         2 006230   000017 376003                    ANQ     15,DU
         2 006231   000002 116003                    CMPQ    2,DU
         2 006232   006247 602000 2                  TNC     s:18194

     1804    18188    3                 THEN
     1805    18189    4                    DO;

     1806    18190    4                       TVAL=AMR$REC$.HDR_->AM$HDR.CTL.HEADERHEIGHT#;

  18190  2 006233   100000 236100                    LDQ     0,,PR1
         2 006234   000022 772000                    QRL     18
         2 006235   000017 376007                    ANQ     15,DL
         2 006236   200013 756100                    STQ     TVAL,,AUTO

     1807    18191    4                       CALL CNVRT_BLD(SIZEC(',HdrHeight='),',HdrHeight=',TVAL)

  18191  2 006237   200013 633500                    EPPR3   TVAL,,AUTO
         2 006240   202307 453500                    STP3    @TEXT+1,,AUTO
         2 006241   000167 236000 3                  LDQ     119
         2 006242   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006243   000126 236000 3                  LDQ     86
         2 006244   202305 756100                    STQ     SIZ+2,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:309  
         2 006245   012300 701000 2                  TSX1    CNVRT_BLD
         2 006246   010711 702000 2                  TSX2    DISPDCB55

     1808    18192    4                            ALTRET(DISPDCB55);
     1809    18193    4                    END;

     1810    18194    3              IF AMR$REC$.HDR_->AM$HDR.CTL.INDENT#~=0

  18194  2 006247   000000 470400 xsym               LDP0    SEG3$
         2 006250   000017 471500                    LDP1    15,,PR0
         2 006251   100000 236100                    LDQ     0,,PR1
         2 006252   777000 316007                    CANQ    -512,DL
         2 006253   006270 600000 2                  TZE     s:18201

     1811    18195    3                 THEN
     1812    18196    4                    DO;

     1813    18197    4                       TVAL=AMR$REC$.HDR_->AM$HDR.CTL.INDENT#;

  18197  2 006254   100000 236100                    LDQ     0,,PR1
         2 006255   000011 772000                    QRL     9
         2 006256   000777 376007                    ANQ     511,DL
         2 006257   200013 756100                    STQ     TVAL,,AUTO

     1814    18198    4                       CALL CNVRT_BLD(SIZEC(',Indent='),',Indent=',TVAL)

  18198  2 006260   200013 633500                    EPPR3   TVAL,,AUTO
         2 006261   202307 453500                    STP3    @TEXT+1,,AUTO
         2 006262   000170 236000 3                  LDQ     120
         2 006263   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006264   000113 236000 3                  LDQ     75
         2 006265   202305 756100                    STQ     SIZ+2,,AUTO
         2 006266   012300 701000 2                  TSX1    CNVRT_BLD
         2 006267   010711 702000 2                  TSX2    DISPDCB55

     1815    18199    4                            ALTRET(DISPDCB55);
     1816    18200    4                    END;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:310  

     1817    18201    3              IF AMR$REC$.HDR_->AM$HDR.CTL.COUNT#~=0

  18201  2 006270   000000 470400 xsym               LDP0    SEG3$
         2 006271   000017 471500                    LDP1    15,,PR0
         2 006272   100000 236100                    LDQ     0,,PR1
         2 006273   000777 316007                    CANQ    511,DL
         2 006274   006310 600000 2                  TZE     s:18208

     1818    18202    3                 THEN
     1819    18203    4                    DO;

     1820    18204    4                       TVAL=AMR$REC$.HDR_->AM$HDR.CTL.COUNT#;

  18204  2 006275   100000 236100                    LDQ     0,,PR1
         2 006276   000777 376007                    ANQ     511,DL
         2 006277   200013 756100                    STQ     TVAL,,AUTO

     1821    18205    4                       CALL CNVRT_BLD(SIZEC(',PageCol='),',PageCol=',TVAL)

  18205  2 006300   200013 633500                    EPPR3   TVAL,,AUTO
         2 006301   202307 453500                    STP3    @TEXT+1,,AUTO
         2 006302   000171 236000 3                  LDQ     121
         2 006303   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006304   000124 236000 3                  LDQ     84
         2 006305   202305 756100                    STQ     SIZ+2,,AUTO
         2 006306   012300 701000 2                  TSX1    CNVRT_BLD
         2 006307   010711 702000 2                  TSX2    DISPDCB55

     1822    18206    4                            ALTRET(DISPDCB55);
     1823    18207    4                    END;

     1824    18208    3              IF AMR$REC$.HDR_->AM$HDR.TITL.L#~=0

  18208  2 006310   000000 470400 xsym               LDP0    SEG3$
         2 006311   000017 471500                    LDP1    15,,PR0
         2 006312   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:311  
         2 006313   777000 316003                    CANQ    -512,DU
         2 006314   006407 600000 2                  TZE     s:18221

     1825    18209    3                 THEN
     1826    18210    4                    DO;

     1827    18211    4                       INBUFF=',Title=''';

  18211  2 006315   040100 100400                    MLR     fill='040'O
         2 006316   001330 000010 1                  ADSC9   CONSTCLS+218             cn=0,n=8
         2 006317   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1828    18212    4                      CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',Title='''),TAB_VAL)

  18212  2 006320   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006321   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006322   000113 236000 3                  LDQ     75
         2 006323   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 006324   200034 631500                    EPPR1   IN$,,AUTO
         2 006325   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 006326   200035 633500                    EPPR3   DEST$,,AUTO
         2 006327   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 006330   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 006331   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 006332   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006333   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006334   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006335   010711 702000 2                  TSX2    DISPDCB55

     1829    18213    4                            ALTRET(DISPDCB55);
     1830    18214    4                       LEN=AMR$REC$.HDR_->AM$HDR.TITL.L#;

  18214  2 006336   000000 470400 xsym               LDP0    SEG3$
         2 006337   000017 471500                    LDP1    15,,PR0
         2 006340   100001 236100                    LDQ     1,,PR1
         2 006341   000033 772000                    QRL     27
         2 006342   200476 756100                    STQ     LEN,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:312  

     1831    18215    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(AMR$REC$.HDR_->

  18215  2 006343   000017 471500                    LDP1    15,,PR0
         2 006344   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 006345   202353 236100                    LDQ     CLSDCB+31,,AUTO
         2 006346   000172 036000 3                  ADLQ    122
         2 006347   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 006350   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006351   202360 756100                    STQ     CLSDCB+36,,AUTO
         2 006352   200476 633500                    EPPR3   LEN,,AUTO
         2 006353   202357 453500                    STP3    CLSDCB+35,,AUTO
         2 006354   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 006355   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 006356   200035 635500                    EPPR5   DEST$,,AUTO
         2 006357   202355 455500                    STP5    CLSDCB+33,,AUTO
         2 006360   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 006361   202354 456500                    STP6    CLSDCB+32,,AUTO
         2 006362   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 006363   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006364   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006365   010711 702000 2                  TSX2    DISPDCB55

     1832    18216    4                            AM$HDR.TITL.TITLE#),LEN,TAB_VAL) ALTRET(DISPDCB55);
     1833    18217    4                       INBUFF='''';

  18217  2 006366   040100 100400                    MLR     fill='040'O
         2 006367   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 006370   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1834    18218    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)

  18218  2 006371   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006372   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006373   000033 236000 3                  LDQ     27
         2 006374   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 006375   200034 630500                    EPPR0   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:313  
         2 006376   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 006377   200035 631500                    EPPR1   DEST$,,AUTO
         2 006400   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 006401   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 006402   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 006403   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006404   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006405   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006406   010711 702000 2                  TSX2    DISPDCB55

     1835    18219    4                            ALTRET(DISPDCB55);
     1836    18220    4                    END;

     1837    18221    3              IF AMR$REC$.HDR_->AM$HDR.CTL.RESETPAGE#=%YES#

  18221  2 006407   000000 470400 xsym               LDP0    SEG3$
         2 006410   000017 471500                    LDP1    15,,PR0
         2 006411   100000 430100                    FSZN    0,,PR1
         2 006412   006436 605000 2                  TPL     s:18230

     1838    18222    3                 THEN
     1839    18223    4                    DO;

     1840    18224    4                       INBUFF=',ResetPage';

  18224  2 006413   040100 100400                    MLR     fill='040'O
         2 006414   001332 000012 1                  ADSC9   CONSTCLS+220             cn=0,n=10
         2 006415   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1841    18225    4                       LEN=SIZEC(',ResetPage');

  18225  2 006416   000012 235007                    LDA     10,DL
         2 006417   200476 755100                    STA     LEN,,AUTO

     1842    18226    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18226  2 006420   202076 236100                    LDQ     @TAB_VAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:314  
         2 006421   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006422   200476 631500                    EPPR1   LEN,,AUTO
         2 006423   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 006424   200034 633500                    EPPR3   IN$,,AUTO
         2 006425   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 006426   200035 634500                    EPPR4   DEST$,,AUTO
         2 006427   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 006430   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 006431   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 006432   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006433   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006434   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006435   010711 702000 2                  TSX2    DISPDCB55

     1843    18227    4                            ALTRET(DISPDCB55);
     1844    18228    4                    END;

     1845    18229    3           END;

     1846    18230    2     CALL DISP_OPT_YESNO(COMPOPT,ADDR(AMR$REC$.V.COMP#)) ALTRET(DISPDCB55);

  18230  2 006436   000000 236000 xsym               LDQ     SEG3$
         2 006437   000174 036000 3                  ADLQ    124
         2 006440   202407 756100                    STQ     CLSDCB+59,,AUTO
         2 006441   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 006442   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 006443   202407 630500                    EPPR0   CLSDCB+59,,AUTO
         2 006444   202132 450500                    STP0    LEN+1,,AUTO
         2 006445   000175 236000 3                  LDQ     125
         2 006446   202131 756100                    STQ     OPEN+1,,AUTO
         2 006447   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 006450   010711 702000 2                  TSX2    DISPDCB55

     1847    18231        /*** Type ***/
     1848    18232    2     IF (AMR$REC$.V.TYPE# ~= BINASC(0))

  18232  2 006451   000000 470400 xsym               LDP0    SEG3$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:315  
         2 006452   000025 220100                    LDX0    21,,PR0
         2 006453   000040 100003                    CMPX0   32,DU
         2 006454   006507 600000 2                  TZE     s:18240

     1849    18233    2        THEN
     1850    18234    3           DO;

     1851    18235    3              CALL CONCAT(INBUFF,',Type=',AMR$REC$.V.TYPE#,' ');

  18235  2 006455   040100 100400                    MLR     fill='040'O
         2 006456   001335 000006 1                  ADSC9   CONSTCLS+223             cn=0,n=6
         2 006457   200037 000006                    ADSC9   INBUFF,,AUTO             cn=0,n=6
         2 006460   000025 220100                    LDX0    21,,PR0
         2 006461   200040 440100                    SXL0    INBUFF+1,,AUTO
         2 006462   040100 100400                    MLR     fill='040'O
         2 006463   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006464   200041 000770                    ADSC9   INBUFF+2,,AUTO           cn=0,n=504

     1852    18236    3              CALL INDEX(LEN,' ',INBUFF);

  18236  2 006465   000000 124500                    SCM     mask='000'O
         2 006466   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 006467   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006470   200476 000100                    ARG     LEN,,AUTO

     1853    18237    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  18237  2 006471   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006472   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006473   200476 630500                    EPPR0   LEN,,AUTO
         2 006474   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 006475   200034 631500                    EPPR1   IN$,,AUTO
         2 006476   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 006477   200035 633500                    EPPR3   DEST$,,AUTO
         2 006500   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 006501   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 006502   202352 454500                    STP4    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:316  
         2 006503   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006504   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006505   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006506   010711 702000 2                  TSX2    DISPDCB55

     1854    18238    3           END;

     1855    18239        /*** Dvfc ***/
     1856    18240    2     IF (AMR$REC$.V.DVFC# ~= BINASC(0))

  18240  2 006507   000000 470400 xsym               LDP0    SEG3$
         2 006510   000040 236100                    LDQ     32,,PR0
         2 006511   777000 376007                    ANQ     -512,DL
         2 006512   000000 116003                    CMPQ    0,DU
         2 006513   006547 600000 2                  TZE     s:18248

     1857    18241    2        THEN
     1858    18242    3           DO;

     1859    18243    3              CALL CONCAT(INBUFF,',DVFC=''',AMR$REC$.V.DVFC#,''' ');

  18243  2 006514   040100 100400                    MLR     fill='040'O
         2 006515   001337 000007 1                  ADSC9   CONSTCLS+225             cn=0,n=7
         2 006516   200037 000007                    ADSC9   INBUFF,,AUTO             cn=0,n=7
         2 006517   000040 236100                    LDQ     32,,PR0
         2 006520   000011 772000                    QRL     9
         2 006521   200040 552104                    STBQ    INBUFF+1,'04'O,AUTO
         2 006522   040100 100400                    MLR     fill='040'O
         2 006523   001341 000002 1                  ADSC9   CONSTCLS+227             cn=0,n=2
         2 006524   200041 000770                    ADSC9   INBUFF+2,,AUTO           cn=0,n=504

     1860    18244    3              CALL INDEX(LEN,' ',INBUFF);

  18244  2 006525   000000 124500                    SCM     mask='000'O
         2 006526   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 006527   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006530   200476 000100                    ARG     LEN,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:317  

     1861    18245    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  18245  2 006531   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006532   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006533   200476 630500                    EPPR0   LEN,,AUTO
         2 006534   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 006535   200034 631500                    EPPR1   IN$,,AUTO
         2 006536   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 006537   200035 633500                    EPPR3   DEST$,,AUTO
         2 006540   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 006541   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 006542   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 006543   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006544   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006545   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006546   010711 702000 2                  TSX2    DISPDCB55

     1862    18246    3           END;

     1863    18247        /*** Form ***/
     1864    18248    2     IF (AMR$REC$.FORM_ ~= ADDR(NIL))

  18248  2 006547   000000 470400 xsym               LDP0    SEG3$
         2 006550   000020 236100                    LDQ     16,,PR0
         2 006551   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006552   006630 600000 2                  TZE     s:18259

     1865    18249    2        THEN
     1866    18250    3           DO;

     1867    18251    3              CALL CONCAT(INBUFF,',Form=''',AMR$REC$.FORM_->AM$FORM.FORM#,' ');

  18251  2 006553   000020 471500                    LDP1    16,,PR0
         2 006554   040100 100400                    MLR     fill='040'O
         2 006555   001342 000007 1                  ADSC9   CONSTCLS+228             cn=0,n=7
         2 006556   200037 000007                    ADSC9   INBUFF,,AUTO             cn=0,n=7
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:318  
         2 006557   040100 100500                    MLR     fill='040'O
         2 006560   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         2 006561   200040 600006                    ADSC9   INBUFF+1,,AUTO           cn=3,n=6
         2 006562   040100 100400                    MLR     fill='040'O
         2 006563   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006564   200042 200763                    ADSC9   INBUFF+3,,AUTO           cn=1,n=499

     1868    18252    3              CALL INDEX(LEN,' ',INBUFF);

  18252  2 006565   000000 124500                    SCM     mask='000'O
         2 006566   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 006567   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006570   200476 000100                    ARG     LEN,,AUTO

     1869    18253    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  18253  2 006571   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006572   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006573   200476 630500                    EPPR0   LEN,,AUTO
         2 006574   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 006575   200034 631500                    EPPR1   IN$,,AUTO
         2 006576   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 006577   200035 633500                    EPPR3   DEST$,,AUTO
         2 006600   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 006601   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 006602   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 006603   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006604   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006605   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006606   010711 702000 2                  TSX2    DISPDCB55

     1870    18254    3              INBUFF = '''';

  18254  2 006607   040100 100400                    MLR     fill='040'O
         2 006610   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 006611   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:319  
     1871    18255    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)

  18255  2 006612   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 006613   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 006614   000033 236000 3                  LDQ     27
         2 006615   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 006616   200034 630500                    EPPR0   IN$,,AUTO
         2 006617   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 006620   200035 631500                    EPPR1   DEST$,,AUTO
         2 006621   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 006622   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 006623   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 006624   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 006625   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006626   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 006627   010711 702000 2                  TSX2    DISPDCB55

     1872    18256    3                   ALTRET(DISPDCB55);
     1873    18257    3           END;

     1874    18258        /*** Copies ***/
     1875    18259    2     IF (AMR$REC$.V.COPIES# ~= 0)

  18259  2 006630   000000 470400 xsym               LDP0    SEG3$
         2 006631   000044 236100                    LDQ     36,,PR0
         2 006632   777000 316007                    CANQ    -512,DL
         2 006633   006650 600000 2                  TZE     s:18267

     1876    18260    2        THEN
     1877    18261    3           DO;

     1878    18262    3              TVAL = AMR$REC$.V.COPIES#;

  18262  2 006634   000044 236100                    LDQ     36,,PR0
         2 006635   000011 772000                    QRL     9
         2 006636   000777 376007                    ANQ     511,DL
         2 006637   200013 756100                    STQ     TVAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:320  

     1879    18263    3              CALL CNVRT_BLD (SIZEC(',Copies='), ',Copies=',TVAL)

  18263  2 006640   200013 631500                    EPPR1   TVAL,,AUTO
         2 006641   202307 451500                    STP1    @TEXT+1,,AUTO
         2 006642   000176 236000 3                  LDQ     126
         2 006643   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006644   000113 236000 3                  LDQ     75
         2 006645   202305 756100                    STQ     SIZ+2,,AUTO
         2 006646   012300 701000 2                  TSX1    CNVRT_BLD
         2 006647   010711 702000 2                  TSX2    DISPDCB55

     1880    18264    3                   ALTRET(DISPDCB55);
     1881    18265    3           END;

     1882    18266        /*** Vol ***/
     1883    18267    2     IF (AMR$REC$.V.VOL# ~= 0)

  18267  2 006650   000000 470400 xsym               LDP0    SEG3$
         2 006651   000037 236100                    LDQ     31,,PR0
         2 006652   777000 316003                    CANQ    -512,DU
         2 006653   006667 600000 2                  TZE     s:18273

     1884    18268    2        THEN
     1885    18269    3           DO;

     1886    18270    3              TVAL=AMR$REC$.V.VOL#;

  18270  2 006654   000037 236100                    LDQ     31,,PR0
         2 006655   000033 772000                    QRL     27
         2 006656   200013 756100                    STQ     TVAL,,AUTO

     1887    18271    3              CALL CNVRT_BLD(SIZEC(',Vol='),',Vol=',TVAL) ALTRET(DISPDCB55);

  18271  2 006657   200013 631500                    EPPR1   TVAL,,AUTO
         2 006660   202307 451500                    STP1    @TEXT+1,,AUTO
         2 006661   000177 236000 3                  LDQ     127
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:321  
         2 006662   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006663   000110 236000 3                  LDQ     72
         2 006664   202305 756100                    STQ     SIZ+2,,AUTO
         2 006665   012300 701000 2                  TSX1    CNVRT_BLD
         2 006666   010711 702000 2                  TSX2    DISPDCB55

     1888    18272    3           END;

     1889    18273    2     IF (AMR$REC$.V.MAXVOL# ~= 0)

  18273  2 006667   000000 470400 xsym               LDP0    SEG3$
         2 006670   000037 236100                    LDQ     31,,PR0
         2 006671   000777 316003                    CANQ    511,DU
         2 006672   006707 600000 2                  TZE     s:18280

     1890    18274    2        THEN
     1891    18275    3           DO;

     1892    18276    3              TVAL=AMR$REC$.V.MAXVOL#;

  18276  2 006673   000037 236100                    LDQ     31,,PR0
         2 006674   000022 772000                    QRL     18
         2 006675   000777 376007                    ANQ     511,DL
         2 006676   200013 756100                    STQ     TVAL,,AUTO

     1893    18277    3              CALL CNVRT_BLD(SIZEC(',MaxVol='),',MaxVol=',TVAL)

  18277  2 006677   200013 631500                    EPPR1   TVAL,,AUTO
         2 006700   202307 451500                    STP1    @TEXT+1,,AUTO
         2 006701   000200 236000 3                  LDQ     128
         2 006702   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006703   000113 236000 3                  LDQ     75
         2 006704   202305 756100                    STQ     SIZ+2,,AUTO
         2 006705   012300 701000 2                  TSX1    CNVRT_BLD
         2 006706   010711 702000 2                  TSX2    DISPDCB55

     1894    18278    3                   ALTRET(DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:322  
     1895    18279    3           END;

     1896    18280    2     CALL DISP_OPT_YESNO(CVOLOPT,ADDR(AMR$REC$.V.CVOL#)) ALTRET(DISPDCB55);

  18280  2 006707   000000 236000 xsym               LDQ     SEG3$
         2 006710   000202 036000 3                  ADLQ    130
         2 006711   202410 756100                    STQ     CLSDCB+60,,AUTO
         2 006712   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 006713   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 006714   202410 630500                    EPPR0   CLSDCB+60,,AUTO
         2 006715   202132 450500                    STP0    LEN+1,,AUTO
         2 006716   000203 236000 3                  LDQ     131
         2 006717   202131 756100                    STQ     OPEN+1,,AUTO
         2 006720   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 006721   010711 702000 2                  TSX2    DISPDCB55

     1897    18281        /*** Lines ***/
     1898    18282    2     IF (AMR$REC$.V.LINES# ~= 0)

  18282  2 006722   000000 470400 xsym               LDP0    SEG3$
         2 006723   000041 720100                    LXL0    33,,PR0
         2 006724   006740 600000 2                  TZE     s:18289

     1899    18283    2        THEN
     1900    18284    3           DO;

     1901    18285    3              TVAL=AMR$REC$.V.LINES#;

  18285  2 006725   000041 236100                    LDQ     33,,PR0
         2 006726   777777 376007                    ANQ     -1,DL
         2 006727   200013 756100                    STQ     TVAL,,AUTO

     1902    18286    3              CALL CNVRT_BLD(SIZEC(',Lines='),',Lines=',TVAL)

  18286  2 006730   200013 631500                    EPPR1   TVAL,,AUTO
         2 006731   202307 451500                    STP1    @TEXT+1,,AUTO
         2 006732   000204 236000 3                  LDQ     132
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:323  
         2 006733   202306 756100                    STQ     @FLAG+1,,AUTO
         2 006734   000053 236000 3                  LDQ     43
         2 006735   202305 756100                    STQ     SIZ+2,,AUTO
         2 006736   012300 701000 2                  TSX1    CNVRT_BLD
         2 006737   010711 702000 2                  TSX2    DISPDCB55

     1903    18287    3                   ALTRET(DISPDCB55);
     1904    18288    3           END;

     1905    18289    2     CALL DISP_OPT_YESNO(XTENDOPT,ADDR(AMR$REC$.V.XTEND#)) ALTRET(DISPDCB55);

  18289  2 006740   000000 236000 xsym               LDQ     SEG3$
         2 006741   000206 036000 3                  ADLQ    134
         2 006742   202411 756100                    STQ     CLSDCB+61,,AUTO
         2 006743   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 006744   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 006745   202411 630500                    EPPR0   CLSDCB+61,,AUTO
         2 006746   202132 450500                    STP0    LEN+1,,AUTO
         2 006747   000207 236000 3                  LDQ     135
         2 006750   202131 756100                    STQ     OPEN+1,,AUTO
         2 006751   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 006752   010711 702000 2                  TSX2    DISPDCB55

     1906    18290    2     CALL DISP_OPT_YESNO(BUPMOPT,ADDR(AMR$REC$.V.BUPM#)) ALTRET(DISPDCB55);

  18290  2 006753   000000 236000 xsym               LDQ     SEG3$
         2 006754   000211 036000 3                  ADLQ    137
         2 006755   202412 756100                    STQ     CLSDCB+62,,AUTO
         2 006756   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 006757   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 006760   202412 630500                    EPPR0   CLSDCB+62,,AUTO
         2 006761   202132 450500                    STP0    LEN+1,,AUTO
         2 006762   000212 236000 3                  LDQ     138
         2 006763   202131 756100                    STQ     OPEN+1,,AUTO
         2 006764   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 006765   010711 702000 2                  TSX2    DISPDCB55

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:324  
     1907    18291        /*** Fsn ***/
     1908    18292    2     IF (AMR$REC$.V.FSN#~=0)

  18292  2 006766   000000 470400 xsym               LDP0    SEG3$
         2 006767   000044 220100                    LDX0    36,,PR0
         2 006770   007004 600000 2                  TZE     s:18301

     1909    18293    2        THEN
     1910    18294    3           DO;

     1911    18295    3              TVAL=AMR$REC$.V.FSN#;

  18295  2 006771   000044 236100                    LDQ     36,,PR0
         2 006772   000022 772000                    QRL     18
         2 006773   200013 756100                    STQ     TVAL,,AUTO

     1912    18296    3              CALL CNVRT_BLD(SIZEC(',FSN='),',FSN=',TVAL)

  18296  2 006774   200013 631500                    EPPR1   TVAL,,AUTO
         2 006775   202307 451500                    STP1    @TEXT+1,,AUTO
         2 006776   000213 236000 3                  LDQ     139
         2 006777   202306 756100                    STQ     @FLAG+1,,AUTO
         2 007000   000110 236000 3                  LDQ     72
         2 007001   202305 756100                    STQ     SIZ+2,,AUTO
         2 007002   012300 701000 2                  TSX1    CNVRT_BLD
         2 007003   010711 702000 2                  TSX2    DISPDCB55

     1913    18297    3                   ALTRET(DISPDCB55);
     1914    18298    3           END;

     1915    18299        /*** Seqcol,seqid ***/
     1916    18300        /*         **** Display seqcol & seqid if sequencing set */
     1917    18301    2     IF (AMR$REC$.V.SEQ#~=DEFAULT#)

  18301  2 007004   000000 470400 xsym               LDP0    SEG3$
         2 007005   000041 236100                    LDQ     33,,PR0
         2 007006   000600 376003                    ANQ     384,DU
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:325  
         2 007007   000200 116003                    CMPQ    128,DU
         2 007010   007117 600000 2                  TZE     s:18321

     1918    18302    2        THEN
     1919    18303    3           DO;

     1920    18304    3              CALL DISP_OPT_YESNO(SEQOPT,ADDR(AMR$REC$.V.SEQ#)) ALTRET(DISPDCB55);

  18304  2 007011   000000 236000 xsym               LDQ     SEG3$
         2 007012   000215 036000 3                  ADLQ    141
         2 007013   202413 756100                    STQ     CLSDCB+63,,AUTO
         2 007014   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007015   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 007016   202413 631500                    EPPR1   CLSDCB+63,,AUTO
         2 007017   202132 451500                    STP1    LEN+1,,AUTO
         2 007020   000216 236000 3                  LDQ     142
         2 007021   202131 756100                    STQ     OPEN+1,,AUTO
         2 007022   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007023   010711 702000 2                  TSX2    DISPDCB55

     1921    18305    3              TVAL=AMR$REC$.V.SEQCOL#;

  18305  2 007024   000000 470400 xsym               LDP0    SEG3$
         2 007025   000041 236100                    LDQ     33,,PR0
         2 007026   000033 772000                    QRL     27
         2 007027   200013 756100                    STQ     TVAL,,AUTO

     1922    18306    3              CALL CNVRT_BLD(SIZEC(',SeqCol='),',SeqCol=',TVAL)

  18306  2 007030   200013 631500                    EPPR1   TVAL,,AUTO
         2 007031   202307 451500                    STP1    @TEXT+1,,AUTO
         2 007032   000217 236000 3                  LDQ     143
         2 007033   202306 756100                    STQ     @FLAG+1,,AUTO
         2 007034   000113 236000 3                  LDQ     75
         2 007035   202305 756100                    STQ     SIZ+2,,AUTO
         2 007036   012300 701000 2                  TSX1    CNVRT_BLD
         2 007037   010711 702000 2                  TSX2    DISPDCB55
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:326  

     1923    18307    3                   ALTRET(DISPDCB55);
     1924    18308    3              IF (AMR$REC$.V.SEQID#~=' ')

  18308  2 007040   000000 470400 xsym               LDP0    SEG3$
         2 007041   000042 236100                    LDQ     34,,PR0
         2 007042   000035 116000 xsym               CMPQ    B_VECTNIL+29
         2 007043   007117 600000 2                  TZE     s:18321

     1925    18309    3                 THEN
     1926    18310    4                    DO;

     1927    18311    4                       CALL CONCAT(INBUFF,',SEQID=''',AMR$REC$.V.SEQID#,' ');

  18311  2 007044   001360 237000 1                  LDAQ    CONSTCLS+242
         2 007045   200037 755100                    STA     INBUFF,,AUTO
         2 007046   200040 756100                    STQ     INBUFF+1,,AUTO
         2 007047   000042 236100                    LDQ     34,,PR0
         2 007050   200041 756100                    STQ     INBUFF+2,,AUTO
         2 007051   040100 100400                    MLR     fill='040'O
         2 007052   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 007053   200042 000764                    ADSC9   INBUFF+3,,AUTO           cn=0,n=500

     1928    18312    4                       CALL INDEX(LEN,' ',INBUFF);

  18312  2 007054   000000 124500                    SCM     mask='000'O
         2 007055   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 007056   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 007057   200476 000100                    ARG     LEN,,AUTO

     1929    18313    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18313  2 007060   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 007061   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 007062   200476 630500                    EPPR0   LEN,,AUTO
         2 007063   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 007064   200034 631500                    EPPR1   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:327  
         2 007065   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 007066   200035 633500                    EPPR3   DEST$,,AUTO
         2 007067   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 007070   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 007071   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 007072   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 007073   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 007074   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 007075   010711 702000 2                  TSX2    DISPDCB55

     1930    18314    4                            ALTRET(DISPDCB55);
     1931    18315    4                       INBUFF = '''';

  18315  2 007076   040100 100400                    MLR     fill='040'O
         2 007077   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 007100   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1932    18316    4                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL)

  18316  2 007101   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 007102   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 007103   000033 236000 3                  LDQ     27
         2 007104   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 007105   200034 630500                    EPPR0   IN$,,AUTO
         2 007106   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 007107   200035 631500                    EPPR1   DEST$,,AUTO
         2 007110   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 007111   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 007112   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 007113   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 007114   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 007115   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 007116   010711 702000 2                  TSX2    DISPDCB55

     1933    18317    4                            ALTRET(DISPDCB55);
     1934    18318    4                    END;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:328  
     1935    18319    3           END;

     1936    18320        /**/
     1937    18321    3     DO TVAL=0 TO 8;

  18321  2 007117   200013 450100                    STZ     TVAL,,AUTO

     1938    18322    3        IF AMR$REC$.V.UOPT#(TVAL)~=DEFAULT#

  18322  2 007120   200013 235100                    LDA     TVAL,,AUTO
         2 007121   000001 735000                    ALS     1
         2 007122   007124 605000 2                  TPL     s:18322+4
         2 007123   000044 035003                    ADLA    36,DU
         2 007124   000000 470400 xsym               LDP0    SEG3$
         2 007125   000000 066505                    CMPB    filb='0'B
         2 007126   000024 000002                    BDSC    20,A,PR0                 by=0,bit=0,n=2
         2 007127   000220 000022 3                  BDSC    144                      by=0,bit=0,n=18
         2 007130   007221 600000 2                  TZE     s:18344

     1939    18323    3           THEN
     1940    18324    4              DO;

     1941    18325    4                 CALL CNVRT_BLD(SIZEC(',UOPT'),',UOPT',TVAL)

  18325  2 007131   200013 631500                    EPPR1   TVAL,,AUTO
         2 007132   202307 451500                    STP1    @TEXT+1,,AUTO
         2 007133   000221 236000 3                  LDQ     145
         2 007134   202306 756100                    STQ     @FLAG+1,,AUTO
         2 007135   000110 236000 3                  LDQ     72
         2 007136   202305 756100                    STQ     SIZ+2,,AUTO
         2 007137   012300 701000 2                  TSX1    CNVRT_BLD
         2 007140   010711 702000 2                  TSX2    DISPDCB55

     1942    18326    4                      ALTRET(DISPDCB55);
     1943    18327    4                 IF (AMR$REC$.V.UOPT#(TVAL) = %NO#)

  18327  2 007141   200013 235100                    LDA     TVAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:329  
         2 007142   000001 735000                    ALS     1
         2 007143   007145 605000 2                  TPL     s:18327+4
         2 007144   000044 035003                    ADLA    36,DU
         2 007145   000000 470400 xsym               LDP0    SEG3$
         2 007146   000000 066505                    CMPB    filb='0'B
         2 007147   000024 000002                    BDSC    20,A,PR0                 by=0,bit=0,n=2
         2 007150   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 007151   007176 601000 2                  TNZ     s:18338

     1944    18328    4                    THEN
     1945    18329    5                       DO;

     1946    18330    5                          INBUFF='=No';

  18330  2 007152   040100 100400                    MLR     fill='040'O
         2 007153   001364 000003 1                  ADSC9   CONSTCLS+246             cn=0,n=3
         2 007154   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1947    18331    5                          LEN = SIZEC('=No');

  18331  2 007155   000003 235007                    LDA     3,DL
         2 007156   200476 755100                    STA     LEN,,AUTO

     1948    18332    5                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18332  2 007157   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 007160   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 007161   200476 631500                    EPPR1   LEN,,AUTO
         2 007162   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 007163   200034 633500                    EPPR3   IN$,,AUTO
         2 007164   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 007165   200035 634500                    EPPR4   DEST$,,AUTO
         2 007166   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 007167   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 007170   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 007171   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 007172   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:330  
         2 007173   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 007174   010711 702000 2                  TSX2    DISPDCB55

     1949    18333    5                               ALTRET (DISPDCB55);
     1950    18334    5                       END;

  18334  2 007175   007221 710000 2                  TRA     s:18344

     1951    18335
     1952    18336    4                    ELSE
     1953    18337    5                       DO;

     1954    18338    5                          INBUFF='=Yes';

  18338  2 007176   040100 100400                    MLR     fill='040'O
         2 007177   001365 000004 1                  ADSC9   CONSTCLS+247             cn=0,n=4
         2 007200   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1955    18339    5                          LEN = SIZEC('=Yes');

  18339  2 007201   000004 235007                    LDA     4,DL
         2 007202   200476 755100                    STA     LEN,,AUTO

     1956    18340    5                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18340  2 007203   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 007204   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 007205   200476 631500                    EPPR1   LEN,,AUTO
         2 007206   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 007207   200034 633500                    EPPR3   IN$,,AUTO
         2 007210   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 007211   200035 634500                    EPPR4   DEST$,,AUTO
         2 007212   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 007213   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 007214   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 007215   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 007216   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:331  
         2 007217   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 007220   010711 702000 2                  TSX2    DISPDCB55

     1957    18341    5                               ALTRET (DISPDCB55);
     1958    18342    5                       END;

     1959    18343    4              END;

     1960    18344    3     END;

  18344  2 007221   200013 054100                    AOS     TVAL,,AUTO
         2 007222   200013 235100                    LDA     TVAL,,AUTO
         2 007223   000010 115007                    CMPA    8,DL
         2 007224   007120 604400 2                  TMOZ    s:18322

     1961    18345        /*** Volaccess ***/
     1962    18346    2     IF (AMR$REC$.V.VOLACCESS#~=0)

  18346  2 007225   000000 470400 xsym               LDP0    SEG3$
         2 007226   000041 236100                    LDQ     33,,PR0
         2 007227   000007 316003                    CANQ    7,DU
         2 007230   007323 600000 2                  TZE     s:18364

     1963    18347    2        THEN
     1964    18348    3           DO;

     1965    18349    3              INBUFF=',VolAccess=';

  18349  2 007231   040100 100400                    MLR     fill='040'O
         2 007232   001366 000013 1                  ADSC9   CONSTCLS+248             cn=0,n=11
         2 007233   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1966    18350    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,11,TAB_VAL) ALTRET(DISPDCB55);

  18350  2 007234   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 007235   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 007236   000126 236000 3                  LDQ     86
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:332  
         2 007237   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 007240   200034 631500                    EPPR1   IN$,,AUTO
         2 007241   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 007242   200035 633500                    EPPR3   DEST$,,AUTO
         2 007243   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 007244   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 007245   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 007246   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 007247   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 007250   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 007251   010711 702000 2                  TSX2    DISPDCB55

     1967    18351    4              DO CASE(AMR$REC$.V.VOLACCESS#);

  18351  2 007252   000000 470400 xsym               LDP0    SEG3$
         2 007253   000041 220100                    LDX0    33,,PR0
         2 007254   000007 360003                    ANX0    7,DU
         2 007255   000004 100003                    CMPX0   4,DU
         2 007256   007260 602010 2                  TNC     s:18351+6,X0
         2 007257   007305 710000 2                  TRA     s:18362
         2 007260   007305 710000 2                  TRA     s:18362
         2 007261   007264 710000 2                  TRA     s:18353
         2 007262   007272 710000 2                  TRA     s:18356
         2 007263   007300 710000 2                  TRA     s:18359

     1968    18352    4               CASE(%ALL#);

     1969    18353    4                 INBUFF='All';

  18353  2 007264   040100 100400                    MLR     fill='040'O
         2 007265   001371 000003 1                  ADSC9   CONSTCLS+251             cn=0,n=3
         2 007266   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1970    18354    4                 LEN=SIZEC('All');

  18354  2 007267   000003 235007                    LDA     3,DL
         2 007270   200476 755100                    STA     LEN,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:333  
         2 007271   007305 710000 2                  TRA     s:18362

     1971    18355    4               CASE(%IN#);

     1972    18356    4                 INBUFF='In';

  18356  2 007272   040100 100400                    MLR     fill='040'O
         2 007273   001372 000002 1                  ADSC9   CONSTCLS+252             cn=0,n=2
         2 007274   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1973    18357    4                 LEN=SIZEC('In');

  18357  2 007275   000002 235007                    LDA     2,DL
         2 007276   200476 755100                    STA     LEN,,AUTO
         2 007277   007305 710000 2                  TRA     s:18362

     1974    18358    4               CASE(%NONE#);

     1975    18359    4                 INBUFF='None';

  18359  2 007300   040100 100400                    MLR     fill='040'O
         2 007301   001373 000004 1                  ADSC9   CONSTCLS+253             cn=0,n=4
         2 007302   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     1976    18360    4                 LEN=SIZEC('None');

  18360  2 007303   000004 235007                    LDA     4,DL
         2 007304   200476 755100                    STA     LEN,,AUTO

     1977    18361    4               END ;

     1978    18362    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPDCB55);

  18362  2 007305   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 007306   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 007307   200476 631500                    EPPR1   LEN,,AUTO
         2 007310   202355 451500                    STP1    CLSDCB+33,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:334  
         2 007311   200034 633500                    EPPR3   IN$,,AUTO
         2 007312   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 007313   200035 634500                    EPPR4   DEST$,,AUTO
         2 007314   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 007315   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 007316   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 007317   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 007320   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 007321   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 007322   010711 702000 2                  TSX2    DISPDCB55

     1979    18363    3           END;

     1980    18364    2     CALL DISP_OPT_YESNO(AUOPT,ADDR(AMR$REC$.V.AU#)) ALTRET(DISPDCB55);

  18364  2 007323   000000 236000 xsym               LDQ     SEG3$
         2 007324   000223 036000 3                  ADLQ    147
         2 007325   202414 756100                    STQ     CLSDCB+64,,AUTO
         2 007326   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007327   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 007330   202414 630500                    EPPR0   CLSDCB+64,,AUTO
         2 007331   202132 450500                    STP0    LEN+1,,AUTO
         2 007332   000224 236000 3                  LDQ     148
         2 007333   202131 756100                    STQ     OPEN+1,,AUTO
         2 007334   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007335   010711 702000 2                  TSX2    DISPDCB55

     1981    18365    2     IF NOT AMR$REC$.V.DCBCONLGL#

  18365  2 007336   000000 470400 xsym               LDP0    SEG3$
         2 007337   000036 236100                    LDQ     30,,PR0
         2 007340   400000 316007                    CANQ    -131072,DL
         2 007341   007355 601000 2                  TNZ     s:18368

     1982    18366    2       THEN
     1983    18367    2        CALL DISP_OPT_YESNO(DCBCONLGLOPT,,ADDR(AMR$REC$.V.DCBCONLGL#)) ALTRET (
             18367                 DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:335  

  18367  2 007342   000000 236000 xsym               LDQ     SEG3$
         2 007343   000226 036000 3                  ADLQ    150
         2 007344   202415 756100                    STQ     CLSDCB+65,,AUTO
         2 007345   202415 631500                    EPPR1   CLSDCB+65,,AUTO
         2 007346   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 007347   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007350   202132 756100                    STQ     LEN+1,,AUTO
         2 007351   000227 236000 3                  LDQ     151
         2 007352   202131 756100                    STQ     OPEN+1,,AUTO
         2 007353   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007354   010711 702000 2                  TSX2    DISPDCB55

     1984    18368    2     CALL DISP_OPT_YESNO(QISSOPT,ADDR(AMR$REC$.V.QISS#)) ALTRET(DISPDCB55);

  18368  2 007355   000000 236000 xsym               LDQ     SEG3$
         2 007356   000231 036000 3                  ADLQ    153
         2 007357   202416 756100                    STQ     CLSDCB+66,,AUTO
         2 007360   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007361   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 007362   202416 630500                    EPPR0   CLSDCB+66,,AUTO
         2 007363   202132 450500                    STP0    LEN+1,,AUTO
         2 007364   000232 236000 3                  LDQ     154
         2 007365   202131 756100                    STQ     OPEN+1,,AUTO
         2 007366   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007367   010711 702000 2                  TSX2    DISPDCB55

     1985    18369    2     CALL DISP_OPT_YESNO(LOADOPT,ADDR(AMR$REC$.V.LOAD#)) ALTRET(DISPDCB55);

  18369  2 007370   000000 236000 xsym               LDQ     SEG3$
         2 007371   000234 036000 3                  ADLQ    156
         2 007372   202417 756100                    STQ     CLSDCB+67,,AUTO
         2 007373   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007374   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 007375   202417 630500                    EPPR0   CLSDCB+67,,AUTO
         2 007376   202132 450500                    STP0    LEN+1,,AUTO
         2 007377   000235 236000 3                  LDQ     157
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:336  
         2 007400   202131 756100                    STQ     OPEN+1,,AUTO
         2 007401   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007402   010711 702000 2                  TSX2    DISPDCB55

     1986    18370    2      CALL DISP_OPT_YESNO(LSTAOROPT, ADDR(AMR$REC$.V.LSTAOR#)) ALTRET (DISPDCB55);

  18370  2 007403   000000 236000 xsym               LDQ     SEG3$
         2 007404   000237 036000 3                  ADLQ    159
         2 007405   202420 756100                    STQ     CLSDCB+68,,AUTO
         2 007406   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007407   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 007410   202420 630500                    EPPR0   CLSDCB+68,,AUTO
         2 007411   202132 450500                    STP0    LEN+1,,AUTO
         2 007412   000240 236000 3                  LDQ     160
         2 007413   202131 756100                    STQ     OPEN+1,,AUTO
         2 007414   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007415   010711 702000 2                  TSX2    DISPDCB55

     1987    18371    2      CALL DISP_OPT_YESNO(JRNLBYPASSOPT, ADDR(AMR$REC$.V.JRNLBYPASS#)) ALTRET (
             18371               DISPDCB55);

  18371  2 007416   000000 236000 xsym               LDQ     SEG3$
         2 007417   000242 036000 3                  ADLQ    162
         2 007420   202421 756100                    STQ     CLSDCB+69,,AUTO
         2 007421   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007422   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 007423   202421 630500                    EPPR0   CLSDCB+69,,AUTO
         2 007424   202132 450500                    STP0    LEN+1,,AUTO
         2 007425   000243 236000 3                  LDQ     163
         2 007426   202131 756100                    STQ     OPEN+1,,AUTO
         2 007427   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007430   010711 702000 2                  TSX2    DISPDCB55

     1988    18372    2     IF NOT AMR$REC$.V.TERMCONLGL#

  18372  2 007431   000000 470400 xsym               LDP0    SEG3$
         2 007432   000036 236100                    LDQ     30,,PR0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:337  
         2 007433   200000 316007                    CANQ    65536,DL
         2 007434   007450 601000 2                  TNZ     s:18376

     1989    18373    2       THEN
     1990    18374    2        CALL DISP_OPT_YESNO(TERMCONLGLOPT,,ADDR(AMR$REC$.V.TERMCONLGL#)) ALTRET (
             18374                 DISPDCB55);

  18374  2 007435   000000 236000 xsym               LDQ     SEG3$
         2 007436   000245 036000 3                  ADLQ    165
         2 007437   202422 756100                    STQ     CLSDCB+70,,AUTO
         2 007440   202422 631500                    EPPR1   CLSDCB+70,,AUTO
         2 007441   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 007442   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007443   202132 756100                    STQ     LEN+1,,AUTO
         2 007444   000246 236000 3                  LDQ     166
         2 007445   202131 756100                    STQ     OPEN+1,,AUTO
         2 007446   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007447   010711 702000 2                  TSX2    DISPDCB55

     1991    18375        /*** Ghstacs ***/
     1992    18376    2     IF (AMR$REC$.V.GHSTACS# ~= 0)

  18376  2 007450   000000 470400 xsym               LDP0    SEG3$
         2 007451   000025 236100                    LDQ     21,,PR0
         2 007452   000017 316007                    CANQ    15,DL
         2 007453   007467 600000 2                  TZE     s:18384

     1993    18377    2        THEN
     1994    18378    3           DO;

     1995    18379    3              TVAL=AMR$REC$.V.GHSTACS#;

  18379  2 007454   000025 236100                    LDQ     21,,PR0
         2 007455   000017 376007                    ANQ     15,DL
         2 007456   200013 756100                    STQ     TVAL,,AUTO

     1996    18380    3              CALL CNVRT_BLD(SIZEC(',GhstAcs='),',GhstAcs=',TVAL)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:338  

  18380  2 007457   200013 631500                    EPPR1   TVAL,,AUTO
         2 007460   202307 451500                    STP1    @TEXT+1,,AUTO
         2 007461   000247 236000 3                  LDQ     167
         2 007462   202306 756100                    STQ     @FLAG+1,,AUTO
         2 007463   000124 236000 3                  LDQ     84
         2 007464   202305 756100                    STQ     SIZ+2,,AUTO
         2 007465   012300 701000 2                  TSX1    CNVRT_BLD
         2 007466   010711 702000 2                  TSX2    DISPDCB55

     1997    18381    3                   ALTRET(DISPDCB55);
     1998    18382    3           END;

     1999    18383        /*** Event ***/
     2000    18384    2     IF (AMR$REC$.V.EVENT# ~= 0)

  18384  2 007467   000000 470400 xsym               LDP0    SEG3$
         2 007470   000043 235100                    LDA     35,,PR0
         2 007471   007503 600000 2                  TZE     s:18394

     2001    18385    2        THEN
     2002    18386    3           DO;

     2003    18387    3              TVAL=AMR$REC$.V.EVENT#;

  18387  2 007472   200013 755100                    STA     TVAL,,AUTO

     2004    18388    3              CALL CNVRT_BLD(SIZEC(',Event='),',Event=',TVAL)

  18388  2 007473   200013 631500                    EPPR1   TVAL,,AUTO
         2 007474   202307 451500                    STP1    @TEXT+1,,AUTO
         2 007475   000250 236000 3                  LDQ     168
         2 007476   202306 756100                    STQ     @FLAG+1,,AUTO
         2 007477   000053 236000 3                  LDQ     43
         2 007500   202305 756100                    STQ     SIZ+2,,AUTO
         2 007501   012300 701000 2                  TSX1    CNVRT_BLD
         2 007502   010711 702000 2                  TSX2    DISPDCB55
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:339  

     2005    18389    3                   ALTRET(DISPDCB55);
     2006    18390    3           END;

     2007    18391        /*
     2008    18392          **** DISPLAY ALL COMGROUP INFORMATION IF VLP PRESENT
     2009    18393        */
     2010    18394    2     IF (AMR$REC$.SETSTA_~=ADDR(NIL))

  18394  2 007503   000000 470400 xsym               LDP0    SEG3$
         2 007504   000002 236100                    LDQ     2,,PR0
         2 007505   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 007506   010252 600000 2                  TZE     s:18486

     2011    18395    2        THEN
     2012    18396    3           DO CASE (AMR$REC$.V.ASN#);

  18396  2 007507   000023 720100                    LXL0    19,,PR0
         2 007510   000777 360003                    ANX0    511,DU
         2 007511   000005 100003                    CMPX0   5,DU
         2 007512   007514 602010 2                  TNC     s:18396+5,X0
         2 007513   010252 710000 2                  TRA     s:18486
         2 007514   010252 710000 2                  TRA     s:18486
         2 007515   010060 710000 2                  TRA     s:18445
         2 007516   010252 710000 2                  TRA     s:18486
         2 007517   010252 710000 2                  TRA     s:18486
         2 007520   007521 710000 2                  TRA     s:18398

     2013    18397    3            CASE (%COMGROUP#);

     2014    18398    3              CALL DISP_OPT_YESNO(ALLDCBSOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA

  18398  2 007521   000002 471500                    LDP1    2,,PR0
         2 007522   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007523   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007524   000252 036000 3                  ADLQ    170
         2 007525   202423 756100                    STQ     CLSDCB+71,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:340  
         2 007526   202423 633500                    EPPR3   CLSDCB+71,,AUTO
         2 007527   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007530   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007531   202132 756100                    STQ     LEN+1,,AUTO
         2 007532   000253 236000 3                  LDQ     171
         2 007533   202131 756100                    STQ     OPEN+1,,AUTO
         2 007534   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007535   010711 702000 2                  TSX2    DISPDCB55

     2015    18399    3                   .ALLDCBS#)) ALTRET(DISPDCB55);
     2016    18400    3              CALL DISP_OPT_YESNO(ALLTRMSOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA

  18400  2 007536   000000 470400 xsym               LDP0    SEG3$
         2 007537   000002 471500                    LDP1    2,,PR0
         2 007540   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007541   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007542   000255 036000 3                  ADLQ    173
         2 007543   202424 756100                    STQ     CLSDCB+72,,AUTO
         2 007544   202424 633500                    EPPR3   CLSDCB+72,,AUTO
         2 007545   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007546   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007547   202132 756100                    STQ     LEN+1,,AUTO
         2 007550   000256 236000 3                  LDQ     174
         2 007551   202131 756100                    STQ     OPEN+1,,AUTO
         2 007552   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007553   010711 702000 2                  TSX2    DISPDCB55

     2017    18401    3                   .ALLTRMS#)) ALTRET(DISPDCB55);
     2018    18402    3              CALL DISP_OPT_YESNO(ANYDCBOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA

  18402  2 007554   000000 470400 xsym               LDP0    SEG3$
         2 007555   000002 471500                    LDP1    2,,PR0
         2 007556   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007557   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007560   000260 036000 3                  ADLQ    176
         2 007561   202425 756100                    STQ     CLSDCB+73,,AUTO
         2 007562   202425 633500                    EPPR3   CLSDCB+73,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:341  
         2 007563   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007564   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007565   202132 756100                    STQ     LEN+1,,AUTO
         2 007566   000261 236000 3                  LDQ     177
         2 007567   202131 756100                    STQ     OPEN+1,,AUTO
         2 007570   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007571   010711 702000 2                  TSX2    DISPDCB55

     2019    18403    3                    .ANYDCB#)) ALTRET(DISPDCB55);
     2020    18404    3              CALL DISP_OPT_YESNO(DIRONLYOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA

  18404  2 007572   000000 470400 xsym               LDP0    SEG3$
         2 007573   000002 471500                    LDP1    2,,PR0
         2 007574   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007575   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007576   000263 036000 3                  ADLQ    179
         2 007577   202426 756100                    STQ     CLSDCB+74,,AUTO
         2 007600   202426 633500                    EPPR3   CLSDCB+74,,AUTO
         2 007601   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007602   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007603   202132 756100                    STQ     LEN+1,,AUTO
         2 007604   000264 236000 3                  LDQ     180
         2 007605   202131 756100                    STQ     OPEN+1,,AUTO
         2 007606   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007607   010711 702000 2                  TSX2    DISPDCB55

     2021    18405    3                   .DIRONLY#))  ALTRET(DISPDCB55);
     2022    18406    3              CALL DISP_OPT_YESNO(EOFNONEOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA

  18406  2 007610   000000 470400 xsym               LDP0    SEG3$
         2 007611   000002 471500                    LDP1    2,,PR0
         2 007612   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007613   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007614   000266 036000 3                  ADLQ    182
         2 007615   202427 756100                    STQ     CLSDCB+75,,AUTO
         2 007616   202427 633500                    EPPR3   CLSDCB+75,,AUTO
         2 007617   202133 453500                    STP3    OPNMYDCB+1,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:342  
         2 007620   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007621   202132 756100                    STQ     LEN+1,,AUTO
         2 007622   000267 236000 3                  LDQ     183
         2 007623   202131 756100                    STQ     OPEN+1,,AUTO
         2 007624   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007625   010711 702000 2                  TSX2    DISPDCB55

     2023    18407    3                   .EOFNONE#))  ALTRET(DISPDCB55);
     2024    18408    3              CALL DISP_OPT_YESNO(EOFONEOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA

  18408  2 007626   000000 470400 xsym               LDP0    SEG3$
         2 007627   000002 471500                    LDP1    2,,PR0
         2 007630   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007631   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007632   000271 036000 3                  ADLQ    185
         2 007633   202430 756100                    STQ     CLSDCB+76,,AUTO
         2 007634   202430 633500                    EPPR3   CLSDCB+76,,AUTO
         2 007635   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007636   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007637   202132 756100                    STQ     LEN+1,,AUTO
         2 007640   000272 236000 3                  LDQ     186
         2 007641   202131 756100                    STQ     OPEN+1,,AUTO
         2 007642   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007643   010711 702000 2                  TSX2    DISPDCB55

     2025    18409    3                   .EOFONE#))  ALTRET(DISPDCB55);
     2026    18410    3              TVAL = AMR$REC$.SETSTA_ -> AM$SETSTA.ISTA.EOFTIME#;

  18410  2 007644   000000 470400 xsym               LDP0    SEG3$
         2 007645   000002 471500                    LDP1    2,,PR0
         2 007646   100006 236100                    LDQ     6,,PR1
         2 007647   777777 376007                    ANQ     -1,DL
         2 007650   200013 756100                    STQ     TVAL,,AUTO

     2027    18411    3              IF TVAL ~= 0

  18411  2 007651   007662 600000 2                  TZE     s:18415
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:343  

     2028    18412    3                THEN
     2029    18413    3                 CALL CNVRT_BLD (LENGTHC(',EOFTime='),',EOFTime=', TVAL)

  18413  2 007652   200013 631500                    EPPR1   TVAL,,AUTO
         2 007653   202307 451500                    STP1    @TEXT+1,,AUTO
         2 007654   000273 236000 3                  LDQ     187
         2 007655   202306 756100                    STQ     @FLAG+1,,AUTO
         2 007656   000124 236000 3                  LDQ     84
         2 007657   202305 756100                    STQ     SIZ+2,,AUTO
         2 007660   012300 701000 2                  TSX1    CNVRT_BLD
         2 007661   010711 702000 2                  TSX2    DISPDCB55

     2030    18414    3                   ALTRET (DISPDCB55);
     2031    18415    3              CALL DISP_OPT_YESNO(ILATCHOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA

  18415  2 007662   000000 470400 xsym               LDP0    SEG3$
         2 007663   000002 471500                    LDP1    2,,PR0
         2 007664   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007665   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007666   000275 036000 3                  ADLQ    189
         2 007667   202431 756100                    STQ     CLSDCB+77,,AUTO
         2 007670   202431 633500                    EPPR3   CLSDCB+77,,AUTO
         2 007671   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007672   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007673   202132 756100                    STQ     LEN+1,,AUTO
         2 007674   000276 236000 3                  LDQ     190
         2 007675   202131 756100                    STQ     OPEN+1,,AUTO
         2 007676   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007677   010711 702000 2                  TSX2    DISPDCB55

     2032    18416    3                   .ILATCH#))  ALTRET(DISPDCB55);
     2033    18417    3              CALL DISP_OPT_YESNO(ILOCKOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.ISTA

  18417  2 007700   000000 470400 xsym               LDP0    SEG3$
         2 007701   000002 471500                    LDP1    2,,PR0
         2 007702   100006 633500                    EPPR3   6,,PR1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:344  
         2 007703   202432 453500                    STP3    CLSDCB+78,,AUTO
         2 007704   202432 631500                    EPPR1   CLSDCB+78,,AUTO
         2 007705   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 007706   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007707   202132 756100                    STQ     LEN+1,,AUTO
         2 007710   000300 236000 3                  LDQ     192
         2 007711   202131 756100                    STQ     OPEN+1,,AUTO
         2 007712   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007713   010711 702000 2                  TSX2    DISPDCB55

     2034    18418    3                   .ILOCK#))  ALTRET(DISPDCB55);
     2035    18419    3              CALL DISP_OPT_TEXT(IMSGTYPOPT,LENGTHC(AMR$REC$.SETSTA_->

  18419  2 007714   000000 470400 xsym               LDP0    SEG3$
         2 007715   000002 471500                    LDP1    2,,PR0
         2 007716   100004 633500                    EPPR3   4,,PR1
         2 007717   202433 453500                    STP3    CLSDCB+79,,AUTO
         2 007720   202433 631500                    EPPR1   CLSDCB+79,,AUTO
         2 007721   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 007722   000113 236000 3                  LDQ     75
         2 007723   202132 756100                    STQ     LEN+1,,AUTO
         2 007724   000302 236000 3                  LDQ     194
         2 007725   202131 756100                    STQ     OPEN+1,,AUTO
         2 007726   012627 701000 2                  TSX1    DISP_OPT_TEXT
         2 007727   010711 702000 2                  TSX2    DISPDCB55

     2036    18420    3                    AM$SETSTA.ISTA.IMSGTYP#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2037    18421    3                          ISTA.IMSGTYP#))  ALTRET(DISPDCB55);
     2038    18422    3              CALL DISP_OPT_TEXT(ISTATIONOPT,LENGTHC(AMR$REC$.SETSTA_->

  18422  2 007730   000000 470400 xsym               LDP0    SEG3$
         2 007731   000002 471500                    LDP1    2,,PR0
         2 007732   100002 633500                    EPPR3   2,,PR1
         2 007733   202434 453500                    STP3    CLSDCB+80,,AUTO
         2 007734   202434 631500                    EPPR1   CLSDCB+80,,AUTO
         2 007735   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 007736   000113 236000 3                  LDQ     75
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:345  
         2 007737   202132 756100                    STQ     LEN+1,,AUTO
         2 007740   000304 236000 3                  LDQ     196
         2 007741   202131 756100                    STQ     OPEN+1,,AUTO
         2 007742   012627 701000 2                  TSX1    DISP_OPT_TEXT
         2 007743   010711 702000 2                  TSX2    DISPDCB55

     2039    18423    3                    AM$SETSTA.ISTA.ISTATION#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2040    18424    3                          ISTA.ISTATION#)) ALTRET(DISPDCB55);
     2041    18425    3              CALL DISP_OPT_TEXT(MYSTATIONOPT,LENGTHC(AMR$REC$.SETSTA_->

  18425  2 007744   000000 470400 xsym               LDP0    SEG3$
         2 007745   000002 471500                    LDP1    2,,PR0
         2 007746   202435 451500                    STP1    CLSDCB+81,,AUTO
         2 007747   202435 633500                    EPPR3   CLSDCB+81,,AUTO
         2 007750   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007751   000113 236000 3                  LDQ     75
         2 007752   202132 756100                    STQ     LEN+1,,AUTO
         2 007753   000306 236000 3                  LDQ     198
         2 007754   202131 756100                    STQ     OPEN+1,,AUTO
         2 007755   012627 701000 2                  TSX1    DISP_OPT_TEXT
         2 007756   010711 702000 2                  TSX2    DISPDCB55

     2042    18426    3                    AM$SETSTA.MYSTATION#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2043    18427    3                          MYSTATION#))  ALTRET(DISPDCB55);
     2044    18428    3              CALL DISP_OPT_YESNO(OLATCHOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA.

  18428  2 007757   000000 470400 xsym               LDP0    SEG3$
         2 007760   000002 471500                    LDP1    2,,PR0
         2 007761   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 007762   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 007763   000310 036000 3                  ADLQ    200
         2 007764   202436 756100                    STQ     CLSDCB+82,,AUTO
         2 007765   202436 633500                    EPPR3   CLSDCB+82,,AUTO
         2 007766   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 007767   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007770   202132 756100                    STQ     LEN+1,,AUTO
         2 007771   000311 236000 3                  LDQ     201
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:346  
         2 007772   202131 756100                    STQ     OPEN+1,,AUTO
         2 007773   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 007774   010711 702000 2                  TSX2    DISPDCB55

     2045    18429    3                    OLATCH#)) ALTRET(DISPDCB55);
     2046    18430    3              CALL DISP_OPT_YESNO(OLOCKOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA

  18430  2 007775   000000 470400 xsym               LDP0    SEG3$
         2 007776   000002 471500                    LDP1    2,,PR0
         2 007777   100013 633500                    EPPR3   11,,PR1
         2 010000   202437 453500                    STP3    CLSDCB+83,,AUTO
         2 010001   202437 631500                    EPPR1   CLSDCB+83,,AUTO
         2 010002   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 010003   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 010004   202132 756100                    STQ     LEN+1,,AUTO
         2 010005   000313 236000 3                  LDQ     203
         2 010006   202131 756100                    STQ     OPEN+1,,AUTO
         2 010007   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 010010   010711 702000 2                  TSX2    DISPDCB55

     2047    18431    3                   .OLOCK#))  ALTRET(DISPDCB55);
     2048    18432    3              CALL DISP_OPT_TEXT(OMSGTYPOPT,LENGTHC(AMR$REC$.SETSTA_->

  18432  2 010011   000000 470400 xsym               LDP0    SEG3$
         2 010012   000002 471500                    LDP1    2,,PR0
         2 010013   100011 633500                    EPPR3   9,,PR1
         2 010014   202440 453500                    STP3    CLSDCB+84,,AUTO
         2 010015   202440 631500                    EPPR1   CLSDCB+84,,AUTO
         2 010016   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 010017   000113 236000 3                  LDQ     75
         2 010020   202132 756100                    STQ     LEN+1,,AUTO
         2 010021   000315 236000 3                  LDQ     205
         2 010022   202131 756100                    STQ     OPEN+1,,AUTO
         2 010023   012627 701000 2                  TSX1    DISP_OPT_TEXT
         2 010024   010711 702000 2                  TSX2    DISPDCB55

     2049    18433    3                    AM$SETSTA.OSTA.OMSGTYP#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:347  
     2050    18434    3                          OSTA.OMSGTYP#))  ALTRET(DISPDCB55);
     2051    18435    3              CALL DISP_OPT_TEXT(OSTATIONOPT,LENGTHC(AMR$REC$.SETSTA_->

  18435  2 010025   000000 470400 xsym               LDP0    SEG3$
         2 010026   000002 471500                    LDP1    2,,PR0
         2 010027   100007 633500                    EPPR3   7,,PR1
         2 010030   202441 453500                    STP3    CLSDCB+85,,AUTO
         2 010031   202441 631500                    EPPR1   CLSDCB+85,,AUTO
         2 010032   202133 451500                    STP1    OPNMYDCB+1,,AUTO
         2 010033   000113 236000 3                  LDQ     75
         2 010034   202132 756100                    STQ     LEN+1,,AUTO
         2 010035   000317 236000 3                  LDQ     207
         2 010036   202131 756100                    STQ     OPEN+1,,AUTO
         2 010037   012627 701000 2                  TSX1    DISP_OPT_TEXT
         2 010040   010711 702000 2                  TSX2    DISPDCB55

     2052    18436    3                    AM$SETSTA.OSTA.OSTATION#),ADDR(AMR$REC$.SETSTA_->AM$SETSTA.
     2053    18437    3                          OSTA.OSTATION#)) ALTRET(DISPDCB55);
     2054    18438    3              CALL DISP_OPT_YESNO(WASOPT,,ADDR(AMR$REC$.SETSTA_->AM$SETSTA.OSTA

  18438  2 010041   000000 470400 xsym               LDP0    SEG3$
         2 010042   000002 471500                    LDP1    2,,PR0
         2 010043   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 010044   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010045   000321 036000 3                  ADLQ    209
         2 010046   202442 756100                    STQ     CLSDCB+86,,AUTO
         2 010047   202442 633500                    EPPR3   CLSDCB+86,,AUTO
         2 010050   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 010051   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 010052   202132 756100                    STQ     LEN+1,,AUTO
         2 010053   000322 236000 3                  LDQ     210
         2 010054   202131 756100                    STQ     OPEN+1,,AUTO
         2 010055   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 010056   010711 702000 2                  TSX2    DISPDCB55
         2 010057   010252 710000 2                  TRA     s:18486

     2055    18439    3                   .WAS#))  ALTRET(DISPDCB55);
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:348  
     2056    18440    3            CASE (%TAPE#);

     2057    18441                    /* Display User Header Label stuff here, if IBEX ever
     2058    18442                       permits one to !SET it.
     2059    18443                    */
     2060    18444    3            CASE (%FILE#);

     2061    18445    3              CALL DISP_OPT_YESNO (INITIALIZEOPT,, ADDR(AMR$REC$.VIRTUAL_ ->

  18445  2 010060   000002 471500                    LDP1    2,,PR0
         2 010061   202443 451500                    STP1    CLSDCB+87,,AUTO
         2 010062   202443 633500                    EPPR3   CLSDCB+87,,AUTO
         2 010063   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 010064   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 010065   202132 756100                    STQ     LEN+1,,AUTO
         2 010066   000324 236000 3                  LDQ     212
         2 010067   202131 756100                    STQ     OPEN+1,,AUTO
         2 010070   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 010071   010711 702000 2                  TSX2    DISPDCB55

     2062    18446    3               AM$VIRTUAL.INITIALIZE#)) ALTRET (DISPDCB55);
     2063    18447    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.INITVALUE#;

  18447  2 010072   000000 470400 xsym               LDP0    SEG3$
         2 010073   000002 471500                    LDP1    2,,PR0
         2 010074   100001 235100                    LDA     1,,PR1
         2 010075   200013 755100                    STA     TVAL,,AUTO

     2064    18448    3              IF TVAL ~= 0

  18448  2 010076   010107 600000 2                  TZE     s:18452

     2065    18449    3                THEN
     2066    18450    3                 CALL CNVRT_BLD (LENGTHC(',InitValue='), ',InitValue=', TVAL)

  18450  2 010077   200013 631500                    EPPR1   TVAL,,AUTO
         2 010100   202307 451500                    STP1    @TEXT+1,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:349  
         2 010101   000325 236000 3                  LDQ     213
         2 010102   202306 756100                    STQ     @FLAG+1,,AUTO
         2 010103   000126 236000 3                  LDQ     86
         2 010104   202305 756100                    STQ     SIZ+2,,AUTO
         2 010105   012300 701000 2                  TSX1    CNVRT_BLD
         2 010106   010711 702000 2                  TSX2    DISPDCB55

     2067    18451    3                  ALTRET (DISPDCB55);
     2068    18452    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.MINPHYS#;

  18452  2 010107   000000 470400 xsym               LDP0    SEG3$
         2 010110   000002 471500                    LDP1    2,,PR0
         2 010111   100003 236100                    LDQ     3,,PR1
         2 010112   777777 376007                    ANQ     -1,DL
         2 010113   200013 756100                    STQ     TVAL,,AUTO

     2069    18453    3              IF TVAL ~= 0

  18453  2 010114   010125 600000 2                  TZE     s:18457

     2070    18454    3                THEN
     2071    18455    3                 CALL CNVRT_BLD (LENGTHC(',MinPhys='), ',MinPhys=', TVAL)

  18455  2 010115   200013 631500                    EPPR1   TVAL,,AUTO
         2 010116   202307 451500                    STP1    @TEXT+1,,AUTO
         2 010117   000326 236000 3                  LDQ     214
         2 010120   202306 756100                    STQ     @FLAG+1,,AUTO
         2 010121   000124 236000 3                  LDQ     84
         2 010122   202305 756100                    STQ     SIZ+2,,AUTO
         2 010123   012300 701000 2                  TSX1    CNVRT_BLD
         2 010124   010711 702000 2                  TSX2    DISPDCB55

     2072    18456    3                  ALTRET (DISPDCB55);
     2073    18457    3              CALL DISP_OPT_YESNO (NOFILEOPT,, ADDR(AMR$REC$.VIRTUAL_ ->

  18457  2 010125   000000 470400 xsym               LDP0    SEG3$
         2 010126   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:350  
         2 010127   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 010130   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010131   010000 036007                    ADLQ    4096,DL
         2 010132   202444 756100                    STQ     CLSDCB+88,,AUTO
         2 010133   202444 633500                    EPPR3   CLSDCB+88,,AUTO
         2 010134   202133 453500                    STP3    OPNMYDCB+1,,AUTO
         2 010135   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 010136   202132 756100                    STQ     LEN+1,,AUTO
         2 010137   000330 236000 3                  LDQ     216
         2 010140   202131 756100                    STQ     OPEN+1,,AUTO
         2 010141   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 010142   010711 702000 2                  TSX2    DISPDCB55

     2074    18458    3               AM$VIRTUAL.NOFILE#)) ALTRET (DISPDCB55);
     2075    18459    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.PHYSICAL#;

  18459  2 010143   000000 470400 xsym               LDP0    SEG3$
         2 010144   000002 471500                    LDP1    2,,PR0
         2 010145   100003 236100                    LDQ     3,,PR1
         2 010146   000022 772000                    QRL     18
         2 010147   200013 756100                    STQ     TVAL,,AUTO

     2076    18460    3              IF TVAL ~= 0

  18460  2 010150   010161 600000 2                  TZE     s:18464

     2077    18461    3                THEN
     2078    18462    3                 CALL CNVRT_BLD (LENGTHC(',Physical='), ',Physical=', TVAL)

  18462  2 010151   200013 631500                    EPPR1   TVAL,,AUTO
         2 010152   202307 451500                    STP1    @TEXT+1,,AUTO
         2 010153   000331 236000 3                  LDQ     217
         2 010154   202306 756100                    STQ     @FLAG+1,,AUTO
         2 010155   000051 236000 3                  LDQ     41
         2 010156   202305 756100                    STQ     SIZ+2,,AUTO
         2 010157   012300 701000 2                  TSX1    CNVRT_BLD
         2 010160   010711 702000 2                  TSX2    DISPDCB55
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:351  

     2079    18463    3                  ALTRET (DISPDCB55);
     2080    18464    4              DO CASE (AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.SEGNUM#);

  18464  2 010161   000000 470400 xsym               LDP0    SEG3$
         2 010162   000002 471500                    LDP1    2,,PR0
         2 010163   100000 720100                    LXL0    0,,PR1
         2 010164   000777 360003                    ANX0    511,DU
         2 010165   000004 100003                    CMPX0   4,DU
         2 010166   010170 602010 2                  TNC     s:18464+7,X0
         2 010167   010210 710000 2                  TRA     s:18472
         2 010170   010210 710000 2                  TRA     s:18472
         2 010171   010174 710000 2                  TRA     s:18466
         2 010172   010200 710000 2                  TRA     s:18468
         2 010173   010204 710000 2                  TRA     s:18470

     2081    18465    4                CASE (%VS1#);

     2082    18466    4                 INBUFF = ',SegNum=VS1';

  18466  2 010174   040100 100400                    MLR     fill='040'O
         2 010175   001415 000013 1                  ADSC9   CONSTCLS+271             cn=0,n=11
         2 010176   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 010177   010213 710000 2                  TRA     s:18474

     2083    18467    4                CASE (%VS2#);

     2084    18468    4                 INBUFF = ',SegNum=VS2';

  18468  2 010200   040100 100400                    MLR     fill='040'O
         2 010201   001420 000013 1                  ADSC9   CONSTCLS+274             cn=0,n=11
         2 010202   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 010203   010213 710000 2                  TRA     s:18474

     2085    18469    4                CASE (%VS3#);

     2086    18470    4                 INBUFF = ',SegNum=VS3';
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:352  

  18470  2 010204   040100 100400                    MLR     fill='040'O
         2 010205   001423 000013 1                  ADSC9   CONSTCLS+277             cn=0,n=11
         2 010206   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 010207   010213 710000 2                  TRA     s:18474

     2087    18471    4                CASE (ELSE);

     2088    18472    4                 INBUFF = ' ';

  18472  2 010210   040100 100400                    MLR     fill='040'O
         2 010211   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 010212   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2089    18473    4                END;

     2090    18474    3              IF INBUFF ~= ' '

  18474  2 010213   040000 106500                    CMPC    fill='040'O
         2 010214   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 010215   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 010216   010235 600000 2                  TZE     s:18477

     2091    18475    3                THEN
     2092    18476    3                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,11,TAB_VAL) ALTRET (DISPDCB55);

  18476  2 010217   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 010220   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 010221   000126 236000 3                  LDQ     86
         2 010222   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 010223   200034 631500                    EPPR1   IN$,,AUTO
         2 010224   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 010225   200035 633500                    EPPR3   DEST$,,AUTO
         2 010226   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 010227   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 010230   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 010231   202352 630500                    EPPR0   CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:353  
         2 010232   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 010233   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 010234   010711 702000 2                  TSX2    DISPDCB55

     2093    18477    3              TVAL = AMR$REC$.VIRTUAL_ -> AM$VIRTUAL.SEGSIZE#;

  18477  2 010235   000000 470400 xsym               LDP0    SEG3$
         2 010236   000002 471500                    LDP1    2,,PR0
         2 010237   100002 235100                    LDA     2,,PR1
         2 010240   200013 755100                    STA     TVAL,,AUTO

     2094    18478    3              IF TVAL ~= 0

  18478  2 010241   010252 600000 2                  TZE     s:18486

     2095    18479    3                THEN
     2096    18480    3                 CALL CNVRT_BLD (LENGTHC(',SegSize='), ',SegSize=', TVAL)

  18480  2 010242   200013 631500                    EPPR1   TVAL,,AUTO
         2 010243   202307 451500                    STP1    @TEXT+1,,AUTO
         2 010244   000332 236000 3                  LDQ     218
         2 010245   202306 756100                    STQ     @FLAG+1,,AUTO
         2 010246   000124 236000 3                  LDQ     84
         2 010247   202305 756100                    STQ     SIZ+2,,AUTO
         2 010250   012300 701000 2                  TSX1    CNVRT_BLD
         2 010251   010711 702000 2                  TSX2    DISPDCB55

     2097    18481    3                  ALTRET (DISPDCB55);
     2098    18482    3           END;

     2099    18483        /*
     2100    18484           Display ALTKEYS or FPRG_FID information if present
     2101    18485        */
     2102    18486    2      IF AMR$REC$.ALTKEYS_ ~= ADDR(NIL)

  18486  2 010252   000000 470400 xsym               LDP0    SEG3$
         2 010253   000021 236100                    LDQ     17,,PR0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:354  
         2 010254   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 010255   010603 600000 2                  TZE     s:18540

     2103    18487    2        THEN
     2104    18488    3         DO CASE (AMR$REC$.V.ASN#);

  18488  2 010256   000023 720100                    LXL0    19,,PR0
         2 010257   000777 360003                    ANX0    511,DU
         2 010260   000005 100003                    CMPX0   5,DU
         2 010261   010263 602010 2                  TNC     s:18488+5,X0
         2 010262   010603 710000 2                  TRA     s:18540
         2 010263   010603 710000 2                  TRA     s:18540
         2 010264   010270 710000 2                  TRA     s:18490
         2 010265   010603 710000 2                  TRA     s:18540
         2 010266   010445 710000 2                  TRA     s:18517
         2 010267   010445 710000 2                  TRA     s:18517

     2105    18489    3           CASE (%FILE#);

     2106    18490    3            INBUFF = ',AltKeys=((';

  18490  2 010270   040100 100400                    MLR     fill='040'O
         2 010271   001431 000013 1                  ADSC9   CONSTCLS+283             cn=0,n=11
         2 010272   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2107    18491    3            LEN = LENGTHC(',AltKeys=((');

  18491  2 010273   000013 235007                    LDA     11,DL
         2 010274   200476 755100                    STA     LEN,,AUTO

     2108    18492    3            CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (DISPDCB55);

  18492  2 010275   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 010276   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 010277   200476 631500                    EPPR1   LEN,,AUTO
         2 010300   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 010301   200034 633500                    EPPR3   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:355  
         2 010302   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 010303   200035 634500                    EPPR4   DEST$,,AUTO
         2 010304   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 010305   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 010306   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 010307   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 010310   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 010311   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 010312   010711 702000 2                  TSX2    DISPDCB55

     2109    18493    4            DO I = 0 TO AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.SIZ# - 1;

  18493  2 010313   200472 450100                    STZ     I,,AUTO
         2 010314   010437 710000 2                  TRA     s:18515+3

     2110    18494    4               TVAL = AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.K.KEYX#(I);

  18494  2 010315   000000 470400 xsym               LDP0    SEG3$
         2 010316   000021 471500                    LDP1    17,,PR0
         2 010317   200472 720100                    LXL0    I,,AUTO
         2 010320   100001 236110                    LDQ     1,X0,PR1
         2 010321   777777 376007                    ANQ     -1,DL
         2 010322   200013 756100                    STQ     TVAL,,AUTO

     2111    18495    4               CALL CNVRT_BLD(LENGTHC('KeyX='), 'KeyX=', TVAL) ALTRET (DISPDCB55);

  18495  2 010323   200013 633500                    EPPR3   TVAL,,AUTO
         2 010324   202307 453500                    STP3    @TEXT+1,,AUTO
         2 010325   000333 236000 3                  LDQ     219
         2 010326   202306 756100                    STQ     @FLAG+1,,AUTO
         2 010327   000110 236000 3                  LDQ     72
         2 010330   202305 756100                    STQ     SIZ+2,,AUTO
         2 010331   012300 701000 2                  TSX1    CNVRT_BLD
         2 010332   010711 702000 2                  TSX2    DISPDCB55

     2112    18496    4               TVAL = AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.K.KEYL#(I);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:356  
  18496  2 010333   000000 470400 xsym               LDP0    SEG3$
         2 010334   000021 471500                    LDP1    17,,PR0
         2 010335   200472 720100                    LXL0    I,,AUTO
         2 010336   100001 236110                    LDQ     1,X0,PR1
         2 010337   000022 772000                    QRL     18
         2 010340   000777 376007                    ANQ     511,DL
         2 010341   200013 756100                    STQ     TVAL,,AUTO

     2113    18497    4               CALL CNVRT_BLD(LENGTHC(',KeyL='), ',KeyL=', TVAL) ALTRET (DISPDCB55);

  18497  2 010342   200013 633500                    EPPR3   TVAL,,AUTO
         2 010343   202307 453500                    STP3    @TEXT+1,,AUTO
         2 010344   000334 236000 3                  LDQ     220
         2 010345   202306 756100                    STQ     @FLAG+1,,AUTO
         2 010346   000052 236000 3                  LDQ     42
         2 010347   202305 756100                    STQ     SIZ+2,,AUTO
         2 010350   012300 701000 2                  TSX1    CNVRT_BLD
         2 010351   010711 702000 2                  TSX2    DISPDCB55

     2114    18498    4               IF AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.K.UNIQUE#(I)

  18498  2 010352   000000 470400 xsym               LDP0    SEG3$
         2 010353   000021 471500                    LDP1    17,,PR0
         2 010354   200472 720100                    LXL0    I,,AUTO
         2 010355   100001 234110                    SZN     1,X0,PR1
         2 010356   010365 605000 2                  TPL     s:18504

     2115    18499    5                 THEN DO;

     2116    18500    5                  INBUFF = ',Unique';

  18500  2 010357   040100 100400                    MLR     fill='040'O
         2 010360   001440 000007 1                  ADSC9   CONSTCLS+290             cn=0,n=7
         2 010361   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2117    18501    5                  LEN = LENGTHC(',Unique');

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:357  
  18501  2 010362   000007 235007                    LDA     7,DL
         2 010363   200476 755100                    STA     LEN,,AUTO

     2118    18502    5                  END;

  18502  2 010364   010366 710000 2                  TRA     s:18505

     2119    18503    4                 ELSE
     2120    18504    4                  LEN = 0;

  18504  2 010365   200476 450100                    STZ     LEN,,AUTO

     2121    18505    4               IF I + 1 = AMR$REC$.ALTKEYS_ -> AM$ALTKEYS.SIZ#

  18505  2 010366   000021 471500                    LDP1    17,,PR0
         2 010367   200472 236100                    LDQ     I,,AUTO
         2 010370   000001 036007                    ADLQ    1,DL
         2 010371   100000 116100                    CMPQ    0,,PR1
         2 010372   010405 601000 2                  TNZ     s:18511

     2122    18506    5                 THEN DO;

     2123    18507    5                  CALL INSERT (INBUFF, LEN, , '))');

  18507  2 010373   200476 721100                    LXL1    LEN,,AUTO
         2 010374   776777 621011                    EAX1    -513,X1
         2 010375   777777 661003                    ERX1    -1,DU
         2 010376   200476 235100                    LDA     LEN,,AUTO
         2 010377   040145 100400                    MLR     fill='040'O
         2 010400   001442 000002 1                  ADSC9   CONSTCLS+292             cn=0,n=2
         2 010401   200037 000011                    ADSC9   INBUFF,A,AUTO            cn=0,n=*X1

     2124    18508    5                  LEN = LEN + 2;

  18508  2 010402   000002 236007                    LDQ     2,DL
         2 010403   200476 056100                    ASQ     LEN,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:358  
     2125    18509    5                  END;

  18509  2 010404   010416 710000 2                  TRA     s:18514

     2126    18510    5                 ELSE DO;

     2127    18511    5                  CALL INSERT (INBUFF, LEN, , '),(');

  18511  2 010405   200476 721100                    LXL1    LEN,,AUTO
         2 010406   776777 621011                    EAX1    -513,X1
         2 010407   777777 661003                    ERX1    -1,DU
         2 010410   200476 235100                    LDA     LEN,,AUTO
         2 010411   040145 100400                    MLR     fill='040'O
         2 010412   001443 000003 1                  ADSC9   CONSTCLS+293             cn=0,n=3
         2 010413   200037 000011                    ADSC9   INBUFF,A,AUTO            cn=0,n=*X1

     2128    18512    5                  LEN = LEN + 3;

  18512  2 010414   000003 236007                    LDQ     3,DL
         2 010415   200476 056100                    ASQ     LEN,,AUTO

     2129    18513    5                  END;

     2130    18514    4               CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (DISPDCB55);

  18514  2 010416   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 010417   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 010420   200476 631500                    EPPR1   LEN,,AUTO
         2 010421   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 010422   200034 633500                    EPPR3   IN$,,AUTO
         2 010423   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 010424   200035 634500                    EPPR4   DEST$,,AUTO
         2 010425   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 010426   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 010427   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 010430   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 010431   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:359  
         2 010432   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 010433   010711 702000 2                  TSX2    DISPDCB55

     2131    18515    4               END;

  18515  2 010434   200472 235100                    LDA     I,,AUTO
         2 010435   000001 035007                    ADLA    1,DL
         2 010436   200472 755100                    STA     I,,AUTO
         2 010437   000000 470400 xsym               LDP0    SEG3$
         2 010440   000021 471500                    LDP1    17,,PR0
         2 010441   200472 236100                    LDQ     I,,AUTO
         2 010442   100000 116100                    CMPQ    0,,PR1
         2 010443   010315 602000 2                  TNC     s:18494
         2 010444   010603 710000 2                  TRA     s:18540

     2132    18516    3           CASE (%DEVICE#, %COMGROUP#);

     2133    18517    3            FPT_UNFID = CFPT_UNFID;

  18517  2 010445   000100 100400                    MLR     fill='000'O
         2 010446   000000 000130 xsym               ADSC9   CFPT_UNFID               cn=0,n=88
         2 010447   202102 000130                    ADSC9   FPT_UNFID,,AUTO          cn=0,n=88

     2134    18518    3            FPT_UNFID.V_ = VECTOR (FPT_UNFID.V);

  18518  2 010450   000023 235000 3                  LDA     19
         2 010451   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 010452   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010453   002126 036003                    ADLQ    1110,DU
         2 010454   202102 757100                    STAQ    FPT_UNFID,,AUTO

     2135    18519    3            FPT_UNFID.NAME_ = VECTOR (AMR$REC$.FPRG_ -> AM$FPRG.NAME);

  18519  2 010455   000021 471500                    LDP1    17,,PR0
         2 010456   000054 235000 3                  LDA     44
         2 010457   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 010460   202352 236100                    LDQ     CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:360  
         2 010461   000002 036003                    ADLQ    2,DU
         2 010462   202106 757100                    STAQ    @OPTLEN+1,,AUTO

     2136    18520    3            FPT_UNFID.ACCT_ = VECTOR (AMR$REC$.FPRG_ -> AM$FPRG.ACCT#);

  18520  2 010463   000021 471500                    LDP1    17,,PR0
         2 010464   000023 235000 3                  LDA     19
         2 010465   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 010466   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010467   000012 036003                    ADLQ    10,DU
         2 010470   202110 757100                    STAQ    OPNDCB+2,,AUTO

     2137    18521    3            FPT_UNFID.PASS_ = VECTOR (AMR$REC$.FPRG_ -> AM$FPRG.PASS#);

  18521  2 010471   000021 471500                    LDP1    17,,PR0
         2 010472   000023 235000 3                  LDA     19
         2 010473   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 010474   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010475   000014 036003                    ADLQ    12,DU
         2 010476   202112 757100                    STAQ    @N+1,,AUTO

     2138    18522    3            IF AMR$REC$.FPRG_ -> AM$FPRG.PSN# = ' '

  18522  2 010477   000021 471500                    LDP1    17,,PR0
         2 010500   040000 106500                    CMPC    fill='040'O
         2 010501   100000 400006                    ADSC9   0,,PR1                   cn=2,n=6
         2 010502   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 010503   010507 601000 2                  TNZ     s:18526

     2139    18523    3              THEN
     2140    18524    3               FPT_UNFID.SN_ = VECTOR(NIL);

  18524  2 010504   000336 237000 3                  LDAQ    222
         2 010505   202114 757100                    STAQ    @OPTLEN+1,,AUTO
         2 010506   010533 710000 2                  TRA     s:18532

     2141    18525    4              ELSE DO;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:361  

     2142    18526    4               VLP_SN.NUM# = 1;

  18526  2 010507   000001 235007                    LDA     1,DL
         2 010510   202066 755100                    STA     VLP_SN,,AUTO

     2143    18527    4               VLP_SN.SN#(0) = AMR$REC$.FPRG_ -> AM$FPRG.PSN#;

  18527  2 010511   000021 471500                    LDP1    17,,PR0
         2 010512   040100 100500                    MLR     fill='040'O
         2 010513   100000 400006                    ADSC9   0,,PR1                   cn=2,n=6
         2 010514   202067 000006                    ADSC9   VLP_SN+1,,AUTO           cn=0,n=6

     2144    18528    4               FPT_UNFID.SN_ = VECTOR(VLP_SN);

  18528  2 010515   000003 235000 3                  LDA     3
         2 010516   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 010517   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010520   002066 036003                    ADLQ    1078,DU
         2 010521   202114 757100                    STAQ    @OPTLEN+1,,AUTO

     2145    18529    4               FPT_UNFID.RES_ = VECTOR (RES);

  18529  2 010522   777640 235007                    LDA     -96,DL
         2 010523   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 010524   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010525   000471 036003                    ADLQ    313,DU
         2 010526   202122 757100                    STAQ    COUNTER2+1,,AUTO

     2146    18530    4               RES = 'DP';

  18530  2 010527   001444 236000 1                  LDQ     CONSTCLS+294
         2 010530   777777 376003                    ANQ     -1,DU
         2 010531   040040 276007                    ORQ     16416,DL
         2 010532   200471 756100                    STQ     RES,,AUTO

     2147    18531    4               END;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:362  

     2148    18532    3            FPT_UNFID.ASN_ = VECTOR (ASN);

  18532  2 010533   777640 235007                    LDA     -96,DL
         2 010534   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 010535   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010536   000470 036003                    ADLQ    312,DU
         2 010537   202120 757100                    STAQ    COUNTER1+2,,AUTO

     2149    18533    3            ASN = %FILE#;

  18533  2 010540   000001 235007                    LDA     1,DL
         2 010541   200470 755100                    STA     ASN,,AUTO

     2150    18534    3            FPT_UNFID.TEXTFID_ = VECTOR (UNFID);

  18534  2 010542   000340 235000 3                  LDA     224
         2 010543   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 010544   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 010545   000450 036003                    ADLQ    296,DU
         2 010546   202104 757100                    STAQ    DCBTAB$+1,,AUTO

     2151    18535    3            CALL M$UNFID (FPT_UNFID) ALTRET (DISPDCB55);

  18535  2 010547   202102 630500                    EPPR0   FPT_UNFID,,AUTO
         2 010550   420021 713400                    CLIMB   alt,+8209
         2 010551   404400 401760                    pmme    nvectors=10
         2 010552   010711 702000 2                  TSX2    DISPDCB55

     2152    18536    3            CALL CONCAT (INBUFF, ',FPrg_FID=', UNFID);

  18536  2 010553   040100 100400                    MLR     fill='040'O
         2 010554   001445 000012 1                  ADSC9   CONSTCLS+295             cn=0,n=10
         2 010555   200037 000012                    ADSC9   INBUFF,,AUTO             cn=0,n=10
         2 010556   040100 100500                    MLR     fill='040'O
         2 010557   200450 000100                    ADSC9   UNFID,,AUTO              cn=0,n=64
         2 010560   200041 400766                    ADSC9   INBUFF+2,,AUTO           cn=2,n=502
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:363  

     2153    18537    3            CALL INDEX (LEN, ' ', INBUFF);

  18537  2 010561   000000 124500                    SCM     mask='000'O
         2 010562   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 010563   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 010564   200476 000100                    ARG     LEN,,AUTO

     2154    18538    3            CALL CPB$BLDIMAGE (OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET (DISPDCB55);

  18538  2 010565   202076 236100                    LDQ     @TAB_VAL,,AUTO
         2 010566   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 010567   200476 630500                    EPPR0   LEN,,AUTO
         2 010570   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 010571   200034 631500                    EPPR1   IN$,,AUTO
         2 010572   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 010573   200035 633500                    EPPR3   DEST$,,AUTO
         2 010574   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 010575   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 010576   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 010577   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 010600   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 010601   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 010602   010711 702000 2                  TSX2    DISPDCB55

     2155    18539    3           END;

     2156    18540    2     CALL DISP_OPT_YESNO(IGNOREFSNOPT,ADDR(AMR$REC$.V.IGNOREFSN#)) ALTRET(DISPDCB55);

  18540  2 010603   000000 236000 xsym               LDQ     SEG3$
         2 010604   000342 036000 3                  ADLQ    226
         2 010605   202445 756100                    STQ     CLSDCB+89,,AUTO
         2 010606   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 010607   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 010610   202445 630500                    EPPR0   CLSDCB+89,,AUTO
         2 010611   202132 450500                    STP0    LEN+1,,AUTO
         2 010612   000343 236000 3                  LDQ     227
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:364  
         2 010613   202131 756100                    STQ     OPEN+1,,AUTO
         2 010614   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 010615   010711 702000 2                  TSX2    DISPDCB55

     2157    18541    2     CALL DISP_OPT_YESNO(IOERROKOPT,ADDR(AMR$REC$.V.IOERROK#)) ALTRET(DISPDCB55);

  18541  2 010616   000000 236000 xsym               LDQ     SEG3$
         2 010617   000345 036000 3                  ADLQ    229
         2 010620   202446 756100                    STQ     CLSDCB+90,,AUTO
         2 010621   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 010622   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 010623   202446 630500                    EPPR0   CLSDCB+90,,AUTO
         2 010624   202132 450500                    STP0    LEN+1,,AUTO
         2 010625   000346 236000 3                  LDQ     230
         2 010626   202131 756100                    STQ     OPEN+1,,AUTO
         2 010627   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 010630   010711 702000 2                  TSX2    DISPDCB55

     2158    18542    2     IF AMR$REC$.V.SEEDSPECIFIED#

  18542  2 010631   000000 470400 xsym               LDP0    SEG3$
         2 010632   000036 236100                    LDQ     30,,PR0
         2 010633   010000 316007                    CANQ    4096,DL
         2 010634   010650 600000 2                  TZE     s:18546

     2159    18543    2       THEN
     2160    18544    2        CALL DISP_OPT_YESNO(SEEDOPT,ADDR(AMR$REC$.V.SEEDSPECIFIED#)) ALTRET(DISPDCB55)
             18544                  ;

  18544  2 010635   000000 236000 xsym               LDQ     SEG3$
         2 010636   000350 036000 3                  ADLQ    232
         2 010637   202447 756100                    STQ     CLSDCB+91,,AUTO
         2 010640   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 010641   202133 756100                    STQ     OPNMYDCB+1,,AUTO
         2 010642   202447 631500                    EPPR1   CLSDCB+91,,AUTO
         2 010643   202132 451500                    STP1    LEN+1,,AUTO
         2 010644   000351 236000 3                  LDQ     233
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:365  
         2 010645   202131 756100                    STQ     OPEN+1,,AUTO
         2 010646   012450 701000 2                  TSX1    DISP_OPT_YESNO
         2 010647   010711 702000 2                  TSX2    DISPDCB55

     2161    18545        /*         **** Print only if data in buffer     */
     2162    18546    2     IF POFFC(DEST$,OUTBUFF$) > TAB_VAL

  18546  2 010650   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 010651   000020 772000                    QRL     16
         2 010652   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 010653   200035 236100                    LDQ     DEST$,,AUTO
         2 010654   000020 772000                    QRL     16
         2 010655   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 010656   202076 470500                    LDP0    @TAB_VAL,,AUTO
         2 010657   000000 116100                    CMPQ    0,,PR0
         2 010660   010707 604400 2                  TMOZ    s:18553

     2163    18547    2        THEN
     2164    18548    3           DO;

     2165    18549    3              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  18549  2 010661   000000 471400 xsym               LDP1    SEG2$
         2 010662   100165 473500                    LDP3    117,,PR1
         2 010663   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 010664   300005 756100                    STQ     5,,PR3

     2166    18550    3              SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  18550  2 010665   100165 473500                    LDP3    117,,PR1
         2 010666   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 010667   000020 772000                    QRL     16
         2 010670   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 010671   200035 236100                    LDQ     DEST$,,AUTO
         2 010672   000020 772000                    QRL     16
         2 010673   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 010674   000020 736000                    QLS     16
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:366  
         2 010675   300004 676100                    ERQ     4,,PR3
         2 010676   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 010677   300004 656100                    ERSQ    4,,PR3

     2167    18551    3              CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPDCB55);

  18551  2 010700   000000 236000 xsym               LDQ     SEG2$
         2 010701   000165 036003                    ADLQ    117,DU
         2 010702   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 010703   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 010704   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010705   000000 701000 xent               TSX1    CPE$LISTOUT
         2 010706   010711 702000 2                  TSX2    DISPDCB55

     2168    18552    3           END;

     2169    18553    2     RETURN;

  18553  2 010707   202074 221300                    LDX1  ! @RES#+1,,AUTO
         2 010710   000001 702211                    TSX2  ! 1,X1

  18551  2 010711                       DISPDCB55    null
     2170    18554    2   DISPDCB55: ;
     2171    18555    2     ALTRETURN;

  18555  2 010711   202074 221300                    LDX1  ! @RES#+1,,AUTO
         2 010712   000000 702211                    TSX2  ! 0,X1

  18551  2 010713                       DISPDCB60    null
     2172    18556    2   DISPDCB60: ;
     2173    18557    2     B$JIT.USRERR = B$TCB.ALT$ -> B$EXCFR.ERR;

  18557  2 010713   000000 470400 xsym               LDP0    B$TCB$
         2 010714   000000 471500                    LDP1    0,,PR0
         2 010715   100102 236100                    LDQ     66,,PR1
         2 010716   000000 473400 xsym               LDP3    B$JIT$
         2 010717   300144 756100                    STQ     100,,PR3
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:367  

     2174    18558    2     ALTRETURN;

  18558  2 010720   202074 221300                    LDX1  ! @RES#+1,,AUTO
         2 010721   000000 702211                    TSX2  ! 0,X1

     2175    18559    2   END DISPDCB;
     2176    18560                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:368  
     2177    18561        /**********************************************************************/
     2178    18562        /*I*   NAME:   DISPFLGS
     2179    18563               PURPOSE: Display the settings of various control flags
     2180    18564               CALL:S  CALL DISPFLGS
     2181    18565               INTERFACE: CPC$WRITEMSGE,CPE$LISTOUT,CPB$BLDIMAGE
     2182    18566               INPUT:  B$JIT.PRFLAGS,B$JIT.CPFLAGS1,B$JIT.ACCEPT_FLAGS
     2183    18567               OUTPUT: control flag settings to the listing device
     2184    18568               DESCRIPTION: The various control flag settings in the JIT are
     2185    18569                       determined to be set or reset and reflected on the listing
     2186    18570                       device.
     2187    18571        */
     2188    18572        /**********************************************************************/
     2189    18573    1   DISPFLGS: PROC ALTRET;

  18573  2 010722   202072 741300       DISPFLGS     STX1  ! VLP_SN+4,,AUTO

     2190    18574    2   DCL DISPHDR1 CONSTANT CHAR(24) INIT('   Output control flags:');
     2191    18575        %EQU NUM_FLAGS=13;
     2192    18576
     2193    18577    2   DCL 1 FLAGS_TBL (0:%(NUM_FLAGS-1)) CONSTANT ALIGNED,
     2194    18578    2         2 LEN UBIN BYTE UNAL INIT
     2195    18579    2             (8,9,7,7,4,7,4,6,5,8,7,4,4),
     2196    18580    2         2 HDR CHAR(12) UNAL INIT
     2197    18581    2             ('announce','broadcast','comment','dribble','echo','expound',
     2198    18582    2               'list','notify','point','position','protect','send','when');
     2199    18583        %EQU ANNOUNCE_FLAG=0;
     2200    18584        %EQU BROADCAST_FLAG=1;
     2201    18585        %EQU COMMENT_FLAG=2;
     2202    18586        %EQU DRIBBLE_FLAG=3;
     2203    18587        %EQU ECHO_FLAG=4;
     2204    18588        %EQU EXPOUND_FLAG=5;
     2205    18589        %EQU LIST_FLAG=6;
     2206    18590        %EQU NOTIFY_FLAG=7;
     2207    18591        %EQU POINT_FLAG=8;
     2208    18592        %EQU POSITION_FLAG=9;
     2209    18593        %EQU PROTECT_FLAG=10;
     2210    18594        %EQU SEND_FLAG=11;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:369  
     2211    18595        %EQU WHEN_FLAG=12;
     2212    18596    2   DCL FLAGS_VAL (0:%(NUM_FLAGS-1)) BIT(1) UNAL;
     2213    18597    2   DCL NEED_COMMA BIT(1);
     2214    18598    2   DCL SET_FLG BIT(1);     /* Tell whether it is Set or Reset mode */
     2215    18599    2   DCL I UBIN;
     2216    18600    2   DCL J UBIN;
     2217    18601    2   DCL TAB2_VAL UBIN;
     2218    18602        /*         **** Output header                    */
     2219    18603    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_=VECTOR(DISPHDR1);

  18603  2 010723   000000 470400 xsym               LDP0    SEG2$
         2 010724   000165 471500                    LDP1    117,,PR0
         2 010725   000352 237000 3                  LDAQ    234
         2 010726   100004 757100                    STAQ    4,,PR1

     2220    18604    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPFLGS50);

  18604  2 010727   000000 236000 xsym               LDQ     SEG2$
         2 010730   000165 036003                    ADLQ    117,DU
         2 010731   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 010732   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 010733   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010734   000000 701000 xent               TSX1    CPE$LISTOUT
         2 010735   011327 702000 2                  TSX2    DISPFLGS50

     2221    18605    2     IF B$JIT.CPFLAGS1.WHEN_INPUT

  18605  2 010736   000000 470400 xsym               LDP0    B$JIT$
         2 010737   000143 236100                    LDQ     99,,PR0
         2 010740   000400 316003                    CANQ    256,DU
         2 010741   010745 600000 2                  TZE     s:18609

     2222    18606    2       THEN
     2223    18607    2         CALL CPG$SET_WHEN_STATE ALTRET(DISPFLGS50);

  18607  2 010742   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010743   000000 701000 xent               TSX1    CPG$SET_WHEN_STATE
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:370  
         2 010744   011327 702000 2                  TSX2    DISPFLGS50

     2224    18608        /*         **** Init buffer ptrs ...                             */
     2225    18609    2     OUTBUFF=' ';

  18609  2 010745   040100 100400                    MLR     fill='040'O
         2 010746   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 010747   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2226    18610    2     IN$=ADDR(INBUFF);

  18610  2 010750   200037 630500                    EPPR0   INBUFF,,AUTO
         2 010751   200034 450500                    STP0    IN$,,AUTO

     2227    18611    2     OUTBUFF$=ADDR(OUTBUFF);               /*Ptr to buffer beginning*/

  18611  2 010752   200237 631500                    EPPR1   OUTBUFF,,AUTO
         2 010753   200036 451500                    STP1    OUTBUFF$,,AUTO

     2228    18612    2     DEST$=OUTBUFF$;                       /*Dynamic ptr*/

  18612  2 010754   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 010755   200035 756100                    STQ     DEST$,,AUTO

     2229    18613    2     TAB_VAL=6;                            /*Set tab value*/

  18613  2 010756   000006 235007                    LDA     6,DL
         2 010757   200474 755100                    STA     TAB_VAL,,AUTO

     2230    18614        /*         **** Setup flag information
     2231    18615                   **** Flags which are set causes FLAGS_VAL to be set                */
     2232    18616    2     FLAGS_VAL=%NO#;

  18616  2 010760   000354 236000 3                  LDQ     236
         2 010761   202073 356100                    ANSQ    FLAGS_VAL,,AUTO

     2233    18617    2     FLAGS_VAL(%ANNOUNCE_FLAG)=B$JIT.ACCEPT_FLAGS.ANNOUNCE;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:371  

  18617  2 010762   000000 473400 xsym               LDP3    B$JIT$
         2 010763   300153 236100                    LDQ     107,,PR3
         2 010764   000024 736000                    QLS     20
         2 010765   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 010766   400000 376003                    ANQ     -131072,DU
         2 010767   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2234    18618    2     FLAGS_VAL(%BROADCAST_FLAG)=B$JIT.ACCEPT_FLAGS.BROADCAST;

  18618  2 010770   300153 236100                    LDQ     107,,PR3
         2 010771   000024 736000                    QLS     20
         2 010772   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 010773   200000 376003                    ANQ     65536,DU
         2 010774   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2235    18619    2     FLAGS_VAL(%COMMENT_FLAG)=B$JIT.PRFLAGS.COMMENT;

  18619  2 010775   300030 236100                    LDQ     24,,PR3
         2 010776   000002 736000                    QLS     2
         2 010777   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011000   100000 376003                    ANQ     32768,DU
         2 011001   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2236    18620    2     FLAGS_VAL(%DRIBBLE_FLAG)=B$JIT.CPFLAGS1.DRIBBLE;

  18620  2 011002   300143 236100                    LDQ     99,,PR3
         2 011003   000021 736000                    QLS     17
         2 011004   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011005   040000 376003                    ANQ     16384,DU
         2 011006   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2237    18621    2     FLAGS_VAL(%ECHO_FLAG)=B$JIT.CPFLAGS1.ECHO;

  18621  2 011007   300143 236100                    LDQ     99,,PR3
         2 011010   000034 736000                    QLS     28
         2 011011   202073 676100                    ERQ     FLAGS_VAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:372  
         2 011012   020000 376003                    ANQ     8192,DU
         2 011013   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2238    18622    2     FLAGS_VAL(%EXPOUND_FLAG)=B$JIT.PRFLAGS.EXPOUND;

  18622  2 011014   300030 236100                    LDQ     24,,PR3
         2 011015   000006 736000                    QLS     6
         2 011016   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011017   010000 376003                    ANQ     4096,DU
         2 011020   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2239    18623    2     FLAGS_VAL(%LIST_FLAG)=B$JIT.PRFLAGS.LIST;

  18623  2 011021   300030 236100                    LDQ     24,,PR3
         2 011022   000001 772000                    QRL     1
         2 011023   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011024   004000 376003                    ANQ     2048,DU
         2 011025   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2240    18624    2     FLAGS_VAL(%NOTIFY_FLAG)=B$JIT.CPFLAGS1.NOTIFY;

  18624  2 011026   300143 236100                    LDQ     99,,PR3
         2 011027   000022 736000                    QLS     18
         2 011030   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011031   002000 376003                    ANQ     1024,DU
         2 011032   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2241    18625    2     FLAGS_VAL(%POINT_FLAG)=B$JIT.PRFLAGS.POINT;

  18625  2 011033   300030 236100                    LDQ     24,,PR3
         2 011034   000002 736000                    QLS     2
         2 011035   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011036   001000 376003                    ANQ     512,DU
         2 011037   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2242    18626    2     FLAGS_VAL(%POSITION_FLAG)=B$JIT.PRFLAGS.POSITION;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:373  
  18626  2 011040   300030 236100                    LDQ     24,,PR3
         2 011041   000003 736000                    QLS     3
         2 011042   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011043   000400 376003                    ANQ     256,DU
         2 011044   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2243    18627    2     FLAGS_VAL(%PROTECT_FLAG)=B$JIT.CPFLAGS1.PROTECT;

  18627  2 011045   300143 236100                    LDQ     99,,PR3
         2 011046   000023 736000                    QLS     19
         2 011047   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011050   000200 376003                    ANQ     128,DU
         2 011051   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2244    18628    2     FLAGS_VAL(%SEND_FLAG)=B$JIT.ACCEPT_FLAGS.SEND;

  18628  2 011052   300153 236100                    LDQ     107,,PR3
         2 011053   000010 736000                    QLS     8
         2 011054   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011055   000100 376003                    ANQ     64,DU
         2 011056   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2245    18629    2     FLAGS_VAL(%WHEN_FLAG)=B$JIT.PRFLAGS.WHEN;

  18629  2 011057   300030 236100                    LDQ     24,,PR3
         2 011060   000002 736000                    QLS     2
         2 011061   202073 676100                    ERQ     FLAGS_VAL,,AUTO
         2 011062   000040 376003                    ANQ     32,DU
         2 011063   202073 656100                    ERSQ    FLAGS_VAL,,AUTO

     2246    18630
     2247    18631          /* Move the corresponding text into the buffer                              */
     2248    18632    2     SET_FLG=%YES#;        /* Do Set flags first. */

  18632  2 011064   400000 236003                    LDQ     -131072,DU
         2 011065   202075 756100                    STQ     SET_FLG,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:374  
     2249    18633    2     NEED_COMMA=%NO#;

  18633  2 011066   202074 450100                    STZ     NEED_COMMA,,AUTO

     2250    18634    3     DO I=0 TO 1;

  18634  2 011067   202076 450100                    STZ     I,,AUTO

     2251    18635    3         DEST$=OUTBUFF$;                   /*Dynamic ptr*/

  18635  2 011070   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 011071   200035 756100                    STQ     DEST$,,AUTO

     2252    18636    3         OUTBUFF=' ';

  18636  2 011072   040100 100400                    MLR     fill='040'O
         2 011073   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011074   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2253    18637    3         IF SET_FLG

  18637  2 011075   202075 234100                    SZN     SET_FLG,,AUTO
         2 011076   011124 605000 2                  TPL     s:18647

     2254    18638    3             THEN
     2255    18639    4               DO ;

     2256    18640    4                 INBUFF='Set: ';

  18640  2 011077   040100 100400                    MLR     fill='040'O
         2 011100   001450 000005 1                  ADSC9   CONSTCLS+298             cn=0,n=5
         2 011101   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2257    18641    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('Set: '),TAB_VAL)

  18641  2 011102   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 011103   202356 450500                    STP0    CLSDCB+34,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:375  
         2 011104   000110 236000 3                  LDQ     72
         2 011105   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 011106   200034 631500                    EPPR1   IN$,,AUTO
         2 011107   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 011110   200035 633500                    EPPR3   DEST$,,AUTO
         2 011111   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 011112   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 011113   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 011114   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011115   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 011116   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011117   011327 702000 2                  TSX2    DISPFLGS50

     2258    18642    4                                   ALTRET(DISPFLGS50);
     2259    18643    4                 TAB2_VAL=TAB_VAL+SIZEC('Set: ');

  18643  2 011120   200474 235100                    LDA     TAB_VAL,,AUTO
         2 011121   000005 035007                    ADLA    5,DL
         2 011122   202100 755100                    STA     TAB2_VAL,,AUTO

     2260    18644    4               END;  /* Then Do */

  18644  2 011123   011150 710000 2                  TRA     s:18652

     2261    18645    3             ELSE
     2262    18646    4               DO;

     2263    18647    4                 INBUFF='Reset: ';

  18647  2 011124   040100 100400                    MLR     fill='040'O
         2 011125   001452 000007 1                  ADSC9   CONSTCLS+300             cn=0,n=7
         2 011126   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2264    18648    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('Reset: '),TAB_VAL)

  18648  2 011127   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 011130   202356 450500                    STP0    CLSDCB+34,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:376  
         2 011131   000053 236000 3                  LDQ     43
         2 011132   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 011133   200034 631500                    EPPR1   IN$,,AUTO
         2 011134   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 011135   200035 633500                    EPPR3   DEST$,,AUTO
         2 011136   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 011137   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 011140   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 011141   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011142   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 011143   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011144   011327 702000 2                  TSX2    DISPFLGS50

     2265    18649    4                                   ALTRET(DISPFLGS50);
     2266    18650    4                 TAB2_VAL=TAB_VAL+SIZEC('Reset: ');

  18650  2 011145   200474 235100                    LDA     TAB_VAL,,AUTO
         2 011146   000007 035007                    ADLA    7,DL
         2 011147   202100 755100                    STA     TAB2_VAL,,AUTO

     2267    18651    4               END;  /* Else Do */

     2268    18652    4         DO J=0 TO %NUM_FLAGS-1;

  18652  2 011150   202077 450100                    STZ     J,,AUTO
         2 011151   011256 710000 2                  TRA     s:18676+3

     2269    18653    4             IF FLAGS_VAL(J)=SET_FLG

  18653  2 011152   202077 235100                    LDA     J,,AUTO
         2 011153   000100 066505                    CMPB    filb='0'B
         2 011154   202073 000001                    BDSC    FLAGS_VAL,A,AUTO         by=0,bit=0,n=1
         2 011155   202075 000001                    BDSC    SET_FLG,,AUTO            by=0,bit=0,n=1
         2 011156   011253 601000 2                  TNZ     s:18676

     2270    18654    4               THEN
     2271    18655    5                 DO;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:377  

     2272    18656    5                   IF NEED_COMMA

  18656  2 011157   202074 234100                    SZN     NEED_COMMA,,AUTO
         2 011160   011202 605000 2                  TPL     s:18663

     2273    18657    5                     THEN
     2274    18658    6                       DO;

     2275    18659    6                         INBUFF=',';

  18659  2 011161   040100 100400                    MLR     fill='040'O
         2 011162   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 011163   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2276    18660    6                         CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB2_VAL)

  18660  2 011164   202100 630500                    EPPR0   TAB2_VAL,,AUTO
         2 011165   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 011166   000033 236000 3                  LDQ     27
         2 011167   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 011170   200034 631500                    EPPR1   IN$,,AUTO
         2 011171   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 011172   200035 633500                    EPPR3   DEST$,,AUTO
         2 011173   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 011174   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 011175   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 011176   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011177   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 011200   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011201   011327 702000 2                  TSX2    DISPFLGS50

     2277    18661    6                                          ALTRET(DISPFLGS50);
     2278    18662    6                       END;  /* Then Do */

     2279    18663    5                   INBUFF=FLAGS_TBL.HDR(J);

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:378  
  18663  2 011202   202077 235100                    LDA     J,,AUTO
         2 011203   000004 735000                    ALS     4
         2 011204   040100 100405                    MLR     fill='040'O
         2 011205   000410 200014 1                  ADSC9   FLAGS_TBL,A              cn=1,n=12
         2 011206   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2280    18664    5                   LEN=FLAGS_TBL.LEN(J);

  18664  2 011207   202077 236100                    LDQ     J,,AUTO
         2 011210   000002 736000                    QLS     2
         2 011211   000410 236006 1                  LDQ     FLAGS_TBL,QL
         2 011212   000033 772000                    QRL     27
         2 011213   200476 756100                    STQ     LEN,,AUTO

     2281    18665    5                   IF NEED_COMMA

  18665  2 011214   202074 234100                    SZN     NEED_COMMA,,AUTO
         2 011215   011235 605000 2                  TPL     s:18671

     2282    18666    5                     THEN
     2283    18667    5                       CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB2_VAL)

  18667  2 011216   202100 630500                    EPPR0   TAB2_VAL,,AUTO
         2 011217   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 011220   200476 631500                    EPPR1   LEN,,AUTO
         2 011221   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 011222   200034 633500                    EPPR3   IN$,,AUTO
         2 011223   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 011224   200035 634500                    EPPR4   DEST$,,AUTO
         2 011225   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 011226   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 011227   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 011230   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011231   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 011232   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011233   011327 702000 2                  TSX2    DISPFLGS50
         2 011234   011253 710000 2                  TRA     s:18676
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:379  

     2284    18668    5                                          ALTRET(DISPFLGS50);
     2285    18669    5                     ELSE  /* Don't pass TAB2_VAL, fakeout CPB$BLDIMAGE */
     2286    18670    6                       DO;

     2287    18671    6                         CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN)

  18671  2 011235   200476 630500                    EPPR0   LEN,,AUTO
         2 011236   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 011237   200034 631500                    EPPR1   IN$,,AUTO
         2 011240   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 011241   200035 633500                    EPPR3   DEST$,,AUTO
         2 011242   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 011243   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 011244   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 011245   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011246   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011247   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011250   011327 702000 2                  TSX2    DISPFLGS50

     2288    18672    6                                          ALTRET(DISPFLGS50);
     2289    18673    6                         NEED_COMMA=%YES#;

  18673  2 011251   400000 236003                    LDQ     -131072,DU
         2 011252   202074 756100                    STQ     NEED_COMMA,,AUTO

     2290    18674    6                       END;  /* Else Do */

     2291    18675    5                 END;  /* Then Do */

     2292    18676    4         END; /* Do J */

  18676  2 011253   202077 235100                    LDA     J,,AUTO
         2 011254   000001 035007                    ADLA    1,DL
         2 011255   202077 755100                    STA     J,,AUTO
         2 011256   202077 235100                    LDA     J,,AUTO
         2 011257   000015 115007                    CMPA    13,DL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:380  
         2 011260   011152 602000 2                  TNC     s:18653

     2293    18677        /*         **** Print if any flags set           */
     2294    18678    3         LEN=POFFC(DEST$,OUTBUFF$);

  18678  2 011261   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 011262   000020 772000                    QRL     16
         2 011263   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 011264   200035 236100                    LDQ     DEST$,,AUTO
         2 011265   000020 772000                    QRL     16
         2 011266   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 011267   200476 756100                    STQ     LEN,,AUTO

     2295    18679    3         IF LEN>TAB2_VAL

  18679  2 011270   011316 604000 2                  TMI     s:18686
         2 011271   202100 116100                    CMPQ    TAB2_VAL,,AUTO
         2 011272   011316 602000 2                  TNC     s:18686
         2 011273   011316 600000 2                  TZE     s:18686

     2296    18680    3             THEN
     2297    18681    4               DO;

     2298    18682    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  18682  2 011274   000000 470400 xsym               LDP0    SEG2$
         2 011275   000165 471500                    LDP1    117,,PR0
         2 011276   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 011277   100005 756100                    STQ     5,,PR1

     2299    18683    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=LEN-1;

  18683  2 011300   000165 471500                    LDP1    117,,PR0
         2 011301   200476 236100                    LDQ     LEN,,AUTO
         2 011302   000001 136007                    SBLQ    1,DL
         2 011303   000020 736000                    QLS     16
         2 011304   100004 676100                    ERQ     4,,PR1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:381  
         2 011305   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 011306   100004 656100                    ERSQ    4,,PR1

     2300    18684    4                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPFLGS50);

  18684  2 011307   000000 236000 xsym               LDQ     SEG2$
         2 011310   000165 036003                    ADLQ    117,DU
         2 011311   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 011312   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011313   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011314   000000 701000 xent               TSX1    CPE$LISTOUT
         2 011315   011327 702000 2                  TSX2    DISPFLGS50

     2301    18685    4               END;

     2302    18686    3         SET_FLG=%NO#;

  18686  2 011316   202075 450100                    STZ     SET_FLG,,AUTO

     2303    18687    3         NEED_COMMA=%NO#;

  18687  2 011317   202074 450100                    STZ     NEED_COMMA,,AUTO

     2304    18688    3     END;    /* Do I */

  18688  2 011320   202076 235100                    LDA     I,,AUTO
         2 011321   000001 035007                    ADLA    1,DL
         2 011322   202076 755100                    STA     I,,AUTO
         2 011323   000002 115007                    CMPA    2,DL
         2 011324   011070 602000 2                  TNC     s:18635

     2305    18689    2     RETURN;

  18689  2 011325   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 011326   000001 702211                    TSX2  ! 1,X1

  18684  2 011327                       DISPFLGS50   null
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:382  
     2306    18690    2   DISPFLGS50:;
     2307    18691    2     ALTRETURN;

  18691  2 011327   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 011330   000000 702211                    TSX2  ! 0,X1

     2308    18692    2   END DISPFLGS;
     2309    18693                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:383  
     2310    18694        /**********************************************************************/
     2311    18695        /*I*   NAME:   DISPUSER
     2312    18696               PURPOSE: Display general user information
     2313    18697               CALL:   CALL DISPUSER
     2314    18698               INTERFACE: CPE$LISTOUT,CPE$RZEROS,CPB$BLDIMAGE,CPC$RDUSERS
     2315    18699               INPUT:  b$jit.accn,b$jit.uname,b$jit.sysid,as_users.fcommand
     2316    18700                       b$jit.user,b$jit.prdprm
     2317    18701               OUTPUT: account.name,fcommand,sysid,user#,disk space remaining
     2318    18702                       to the listing device
     2319    18703               DESCRIPTION: The selection of user information is
     2320    18704                       obtained and output to the listing device.
     2321    18705        */
     2322    18706        /**********************************************************************/
     2323    18707    1   DISPUSER: PROC ALTRET;

  18707  2 011331   202072 741300       DISPUSER     STX1  ! VLP_SN+4,,AUTO

     2324    18708    2   DCL USRNUM CHAR(3);                   /*User number*/
     2325    18709        /*         **** Insert accn,uname into image and output */
     2326    18710    2     IN$=ADDR(INBUFF);

  18710  2 011332   200037 630500                    EPPR0   INBUFF,,AUTO
         2 011333   200034 450500                    STP0    IN$,,AUTO

     2327    18711    2     OUTBUFF=' ';

  18711  2 011334   040100 100400                    MLR     fill='040'O
         2 011335   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011336   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2328    18712    2     DEST$=ADDR(OUTBUFF);

  18712  2 011337   200237 631500                    EPPR1   OUTBUFF,,AUTO
         2 011340   200035 451500                    STP1    DEST$,,AUTO

     2329    18713    2     OUTBUFF$=DEST$;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:384  
  18713  2 011341   200035 236100                    LDQ     DEST$,,AUTO
         2 011342   200036 756100                    STQ     OUTBUFF$,,AUTO

     2330    18714    2     TAB_VAL=3;

  18714  2 011343   000003 235007                    LDA     3,DL
         2 011344   200474 755100                    STA     TAB_VAL,,AUTO

     2331    18715    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  18715  2 011345   000000 473400 xsym               LDP3    SEG2$
         2 011346   300165 474500                    LDP4    117,,PR3
         2 011347   400005 756100                    STQ     5,,PR4

     2332    18716    2     CALL INDEX(LEN,' ',B$JIT.ACCN);      /*Get accn size*/

  18716  2 011350   000000 470400 xsym               LDP0    B$JIT$
         2 011351   000000 124500                    SCM     mask='000'O
         2 011352   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 011353   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011354   200476 000100                    ARG     LEN,,AUTO

     2333    18717    2    CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.ACCN),LEN,TAB_VAL) ALTRET(DISPUSER50);

  18717  2 011355   000000 236000 xsym               LDQ     B$JIT$
         2 011356   000001 036003                    ADLQ    1,DU
         2 011357   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 011360   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 011361   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 011362   200476 634500                    EPPR4   LEN,,AUTO
         2 011363   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 011364   202352 635500                    EPPR5   CLSDCB+30,,AUTO
         2 011365   202355 455500                    STP5    CLSDCB+33,,AUTO
         2 011366   200035 636500                    EPPR6   DEST$,,AUTO
         2 011367   202354 456500                    STP6    CLSDCB+32,,AUTO
         2 011370   200036 637500                    EPPR7   OUTBUFF$,,AUTO
         2 011371   202353 457500                    STP7    CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:385  
         2 011372   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 011373   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 011374   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011375   012163 702000 2                  TSX2    DISPUSER50

     2334    18718    2     INBUFF=',';

  18718  2 011376   040100 100400                    MLR     fill='040'O
         2 011377   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 011400   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2335    18719    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(',')) ALTRET(DISPUSER50);

  18719  2 011401   000103 236000 3                  LDQ     67
         2 011402   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 011403   200034 630500                    EPPR0   IN$,,AUTO
         2 011404   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 011405   200035 631500                    EPPR1   DEST$,,AUTO
         2 011406   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 011407   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 011410   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 011411   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011412   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011413   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011414   012163 702000 2                  TSX2    DISPUSER50

     2336    18720    2     CALL INDEX(LEN,' ',B$JIT.UNAME);     /*Get name size*/

  18720  2 011415   000000 470400 xsym               LDP0    B$JIT$
         2 011416   000000 124500                    SCM     mask='000'O
         2 011417   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 011420   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011421   200476 000100                    ARG     LEN,,AUTO

     2337    18721    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.UNAME),LEN) ALTRET(DISPUSER50);

  18721  2 011422   000000 236000 xsym               LDQ     B$JIT$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:386  
         2 011423   000003 036003                    ADLQ    3,DU
         2 011424   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 011425   200476 631500                    EPPR1   LEN,,AUTO
         2 011426   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 011427   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 011430   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 011431   200035 634500                    EPPR4   DEST$,,AUTO
         2 011432   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 011433   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 011434   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 011435   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 011436   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011437   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011440   012163 702000 2                  TSX2    DISPUSER50

     2338    18722        /*         **** Insert sysid into image          */
     2339    18723    2     INBUFF='  Sysid = ';

  18723  2 011441   040100 100400                    MLR     fill='040'O
         2 011442   001454 000012 1                  ADSC9   CONSTCLS+302             cn=0,n=10
         2 011443   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2340    18724    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC('  Sysid = ')) ALTRET(DISPUSER50);

  18724  2 011444   000051 236000 3                  LDQ     41
         2 011445   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 011446   200034 630500                    EPPR0   IN$,,AUTO
         2 011447   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 011450   200035 631500                    EPPR1   DEST$,,AUTO
         2 011451   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 011452   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 011453   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 011454   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011455   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011456   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011457   012163 702000 2                  TSX2    DISPUSER50

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:387  
     2341    18725    2     CALL BINCHAR(SYSID,B$JIT.SYSID);

  18725  2 011460   000000 470400 xsym               LDP0    B$JIT$
         2 011461   000000 236100                    LDQ     0,,PR0
         2 011462   777777 376007                    ANQ     -1,DL
         2 011463   000000 235003                    LDA     0,DU
         2 011464   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 011465   000100 301500                    BTD
         2 011466   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 011467   200506 030006                    NDSC9   SYSID,,AUTO              cn=0,s=nosgn,sf=0,n=6

     2342    18726    2     CALL CPE$RZEROS(SYSID,SIZEC(SYSID),LEN);

  18726  2 011470   200476 631500                    EPPR1   LEN,,AUTO
         2 011471   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 011472   000052 236000 3                  LDQ     42
         2 011473   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 011474   200506 633500                    EPPR3   SYSID,,AUTO
         2 011475   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 011476   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011477   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 011500   000000 701000 xent               TSX1    CPE$RZEROS
         2 011501   000000 011000                    NOP     0

     2343    18727    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(SYSID),LEN) ALTRET(DISPUSER50);

  18727  2 011502   200506 630500                    EPPR0   SYSID,,AUTO
         2 011503   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 011504   200476 631500                    EPPR1   LEN,,AUTO
         2 011505   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 011506   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 011507   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 011510   200035 634500                    EPPR4   DEST$,,AUTO
         2 011511   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 011512   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 011513   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 011514   202354 630500                    EPPR0   CLSDCB+32,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:388  
         2 011515   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011516   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011517   012163 702000 2                  TSX2    DISPUSER50

     2344    18728        /*         **** Insert user number into image    */
     2345    18729    2     INBUFF='  User number = .';

  18729  2 011520   040100 100400                    MLR     fill='040'O
         2 011521   001457 000021 1                  ADSC9   CONSTCLS+305             cn=0,n=17
         2 011522   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2346    18730    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,SIZEC(' User number = .')) ALTRET(DISPUSER50
             18730              );

  18730  2 011523   000356 236000 3                  LDQ     238
         2 011524   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 011525   200034 630500                    EPPR0   IN$,,AUTO
         2 011526   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 011527   200035 631500                    EPPR1   DEST$,,AUTO
         2 011530   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 011531   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 011532   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 011533   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011534   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011535   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011536   012163 702000 2                  TSX2    DISPUSER50

     2347    18731    2     TEMP = B$JIT.USER ;

  18731  2 011537   000000 470400 xsym               LDP0    B$JIT$
         2 011540   000000 236100                    LDQ     0,,PR0
         2 011541   000022 772000                    QRL     18
         2 011542   000777 376007                    ANQ     511,DL
         2 011543   200014 756100                    STQ     TEMP,,AUTO

     2348    18732    2     LEN = 0 ;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:389  
  18732  2 011544   200476 450100                    STZ     LEN,,AUTO

     2349    18733    2     TVAL = 3 ;

  18733  2 011545   000003 235007                    LDA     3,DL
         2 011546   200013 755100                    STA     TVAL,,AUTO

     2350    18734    2     USRNUM = '   ' ;

  18734  2 011547   001451 236000 1                  LDQ     CONSTCLS+299
         2 011550   000357 376000 3                  ANQ     239
         2 011551   000040 276007                    ORQ     32,DL
         2 011552   202073 756100                    STQ     USRNUM,,AUTO

     2351    18735    3     DO UNTIL (TEMP=0) ;

     2352    18736    3         TVAL = TVAL - 1 ;

  18736  2 011553   000001 336007                    LCQ     1,DL
         2 011554   200013 056100                    ASQ     TVAL,,AUTO

     2353    18737    3         CALL INSERT(USRNUM, TVAL, 1, SUBSTR(CONTAB,TEMPO.LSD,1)) ;

  18737  2 011555   200014 236100                    LDQ     TEMP,,AUTO
         2 011556   000007 376007                    ANQ     7,DL
         2 011557   200013 235100                    LDA     TVAL,,AUTO
         2 011560   040105 100406                    MLR     fill='040'O
         2 011561   000000 000001 1                  ADSC9   CONTAB,Q                 cn=0,n=1
         2 011562   202073 000001                    ADSC9   USRNUM,A,AUTO            cn=0,n=1

     2354    18738    3         TEMP = TEMPO.REST ;

  18738  2 011563   200014 236100                    LDQ     TEMP,,AUTO
         2 011564   000003 772000                    QRL     3
         2 011565   200014 756100                    STQ     TEMP,,AUTO

     2355    18739    3         LEN = LEN + 1 ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:390  

  18739  2 011566   200476 054100                    AOS     LEN,,AUTO

     2356    18740    3     END ;   /* Do Until */

  18740  2 011567   000000 116003                    CMPQ    0,DU
         2 011570   011553 601000 2                  TNZ     s:18736

     2357    18741    2     USRNUM = SUBSTR(USRNUM,3-LEN,LEN) ; /* Left justify */

  18741  2 011571   200476 335100                    LCA     LEN,,AUTO
         2 011572   200476 720100                    LXL0    LEN,,AUTO
         2 011573   040100 100545                    MLR     fill='040'O
         2 011574   202073 600010                    ADSC9   USRNUM,A,AUTO            cn=3,n=*X0
         2 011575   202073 000003                    ADSC9   USRNUM,,AUTO             cn=0,n=3

     2358    18742    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(USRNUM),LEN) ALTRET(DISPUSER50);

  18742  2 011576   202073 630500                    EPPR0   USRNUM,,AUTO
         2 011577   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 011600   200476 631500                    EPPR1   LEN,,AUTO
         2 011601   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 011602   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 011603   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 011604   200035 634500                    EPPR4   DEST$,,AUTO
         2 011605   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 011606   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 011607   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 011610   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 011611   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011612   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011613   012163 702000 2                  TSX2    DISPUSER50

     2359    18743    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  18743  2 011614   000000 470400 xsym               LDP0    SEG2$
         2 011615   000165 471500                    LDP1    117,,PR0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:391  
         2 011616   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 011617   100005 756100                    STQ     5,,PR1

     2360    18744    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  18744  2 011620   000165 471500                    LDP1    117,,PR0
         2 011621   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 011622   000020 772000                    QRL     16
         2 011623   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 011624   200035 236100                    LDQ     DEST$,,AUTO
         2 011625   000020 772000                    QRL     16
         2 011626   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 011627   000020 736000                    QLS     16
         2 011630   100004 676100                    ERQ     4,,PR1
         2 011631   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 011632   100004 656100                    ERSQ    4,,PR1

     2361    18745    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPUSER50);

  18745  2 011633   000000 236000 xsym               LDQ     SEG2$
         2 011634   000165 036003                    ADLQ    117,DU
         2 011635   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 011636   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011637   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011640   000000 701000 xent               TSX1    CPE$LISTOUT
         2 011641   012163 702000 2                  TSX2    DISPUSER50

     2362    18746        /*         **** Output file management directory */
     2363    18747    2     DEST$=OUTBUFF$;                       /*Reset buffer ptr*/

  18747  2 011642   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 011643   200035 756100                    STQ     DEST$,,AUTO

     2364    18748    2     INBUFF=' ';

  18748  2 011644   040100 100400                    MLR     fill='040'O
         2 011645   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:392  
         2 011646   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2365    18749    2     IF B$JIT.FPSN=' '

  18749  2 011647   000000 470400 xsym               LDP0    B$JIT$
         2 011650   040000 106500                    CMPC    fill='040'O
         2 011651   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
         2 011652   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011653   011714 601000 2                  TNZ     s:18760

     2366    18750    2        THEN
     2367    18751    3           DO;

     2368    18752    3              CALL INDEX(LEN,' ',B$JIT.FACCN);

  18752  2 011654   000000 124500                    SCM     mask='000'O
         2 011655   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 011656   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011657   200476 000100                    ARG     LEN,,AUTO

     2369    18753    3              LEN=LEN+SIZEC('Directory  = ');

  18753  2 011660   000015 236007                    LDQ     13,DL
         2 011661   200476 056100                    ASQ     LEN,,AUTO

     2370    18754    3              CALL INSERT(INBUFF,0,LEN,'Directory = ',B$JIT.FACCN);

  18754  2 011662   200476 720100                    LXL0    LEN,,AUTO
         2 011663   040140 100400                    MLR     fill='040'O
         2 011664   001470 000014 1                  ADSC9   CONSTCLS+314             cn=0,n=12
         2 011665   200037 000010                    ADSC9   INBUFF,,AUTO             cn=0,n=*X0
         2 011666   200476 236100                    LDQ     LEN,,AUTO
         2 011667   000014 116007                    CMPQ    12,DL
         2 011670   011675 604400 2                  TMOZ    s:18755
         2 011671   777764 620006                    EAX0    -12,QL
         2 011672   040140 100500                    MLR     fill='040'O
         2 011673   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:393  
         2 011674   200042 000010                    ADSC9   INBUFF+3,,AUTO           cn=0,n=*X0

     2371    18755    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPUSER50);

  18755  2 011675   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 011676   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 011677   200476 633500                    EPPR3   LEN,,AUTO
         2 011700   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 011701   200034 634500                    EPPR4   IN$,,AUTO
         2 011702   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 011703   200035 635500                    EPPR5   DEST$,,AUTO
         2 011704   202353 455500                    STP5    CLSDCB+31,,AUTO
         2 011705   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 011706   202352 456500                    STP6    CLSDCB+30,,AUTO
         2 011707   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011710   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 011711   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011712   012163 702000 2                  TSX2    DISPUSER50

     2372    18756    3           END;

  18756  2 011713   012011 710000 2                  TRA     DISPUSER10

     2373    18757
     2374    18758    2        ELSE
     2375    18759    3           DO;

     2376    18760    3              CALL INDEX(LEN,' ',B$JIT.FPSN);

  18760  2 011714   000000 124500                    SCM     mask='000'O
         2 011715   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
         2 011716   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 011717   200476 000100                    ARG     LEN,,AUTO

     2377    18761    3              LEN=LEN+SIZEC('Directory = DP#');

  18761  2 011720   000017 236007                    LDQ     15,DL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:394  
         2 011721   200476 056100                    ASQ     LEN,,AUTO

     2378    18762    3              CALL INSERT(INBUFF,0,LEN,'Directory = DP#',B$JIT.FPSN);

  18762  2 011722   200476 720100                    LXL0    LEN,,AUTO
         2 011723   040140 100400                    MLR     fill='040'O
         2 011724   001473 000017 1                  ADSC9   CONSTCLS+317             cn=0,n=15
         2 011725   200037 000010                    ADSC9   INBUFF,,AUTO             cn=0,n=*X0
         2 011726   200476 236100                    LDQ     LEN,,AUTO
         2 011727   000017 116007                    CMPQ    15,DL
         2 011730   011735 604400 2                  TMOZ    s:18763
         2 011731   777761 620006                    EAX0    -15,QL
         2 011732   040140 100500                    MLR     fill='040'O
         2 011733   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
         2 011734   200042 600010                    ADSC9   INBUFF+3,,AUTO           cn=3,n=*X0

     2379    18763    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN) ALTRET(DISPUSER50);

  18763  2 011735   200476 631500                    EPPR1   LEN,,AUTO
         2 011736   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 011737   200034 633500                    EPPR3   IN$,,AUTO
         2 011740   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 011741   200035 634500                    EPPR4   DEST$,,AUTO
         2 011742   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 011743   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 011744   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 011745   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 011746   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 011747   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 011750   012163 702000 2                  TSX2    DISPUSER50

     2380    18764    3              CALL INDEX(LEN,' ',B$JIT.FACCN);

  18764  2 011751   000000 470400 xsym               LDP0    B$JIT$
         2 011752   000000 124500                    SCM     mask='000'O
         2 011753   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 011754   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:395  
         2 011755   200476 000100                    ARG     LEN,,AUTO

     2381    18765    3              CALL INSERT(INBUFF,0,LEN+1,'.',B$JIT.FACCN);

  18765  2 011756   200476 720100                    LXL0    LEN,,AUTO
         2 011757   000001 621010                    EAX1    1,X0
         2 011760   040140 100400                    MLR     fill='040'O
         2 011761   000360 000001 3                  ADSC9   240                      cn=0,n=1
         2 011762   200037 000011                    ADSC9   INBUFF,,AUTO             cn=0,n=*X1
         2 011763   200476 236100                    LDQ     LEN,,AUTO
         2 011764   000000 116003                    CMPQ    0,DU
         2 011765   011772 604400 2                  TMOZ    s:18766
         2 011766   000000 620006                    EAX0    0,QL
         2 011767   040140 100500                    MLR     fill='040'O
         2 011770   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 011771   200037 200010                    ADSC9   INBUFF,,AUTO             cn=1,n=*X0

     2382    18766    3              CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN+1) ALTRET(DISPUSER50);

  18766  2 011772   200476 235100                    LDA     LEN,,AUTO
         2 011773   000001 035007                    ADLA    1,DL
         2 011774   202352 755100                    STA     CLSDCB+30,,AUTO
         2 011775   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 011776   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 011777   200034 633500                    EPPR3   IN$,,AUTO
         2 012000   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 012001   200035 634500                    EPPR4   DEST$,,AUTO
         2 012002   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 012003   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 012004   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 012005   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 012006   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 012007   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012010   012163 702000 2                  TSX2    DISPUSER50

     2383    18767    3           END;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:396  
  18766  2 012011                       DISPUSER10   null
     2384    18768        /*         **** Output disk pack space remaining */
     2385    18769        /*
     2386    18770          ****     Get granule count from running account by reading in the fit
     2387    18771        */
     2388    18772    2   DISPUSER10:;
     2389    18773    2     CALL CPC$GETSEG(SEG3$) ALTRET(DISPUSER60);

  18773  2 012011   000007 630400 3                  EPPR0   7
         2 012012   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 012013   000000 701000 xent               TSX1    CPC$GETSEG
         2 012014   012165 702000 2                  TSX2    DISPUSER60

     2390    18774    2     FPT_OPEN=CFPT_OPEN;

  18774  2 012015   000100 100400                    MLR     fill='000'O
         2 012016   000000 000350 xsym               ADSC9   CFPT_OPEN                cn=0,n=232
         2 012017   201750 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     2391    18775    2     FPT_OPEN.V_=VECTOR(FPT_OPEN.V);

  18775  2 012020   000064 235000 3                  LDA     52
         2 012021   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 012022   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 012023   002014 036003                    ADLQ    1036,DU
         2 012024   201750 757100                    STAQ    FPT_OPEN,,AUTO

     2392    18776    2     FPT_OPEN.V.DCB#=M$IBEX1_NUM;

  18776  2 012025   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 012026   202014 740100                    STX0    FPT_OPEN+36,,AUTO

     2393    18777    2     FPT_OPEN.V.ASN#=%FILE#;

  18777  2 012027   000001 236007                    LDQ     1,DL
         2 012030   202015 552104                    STBQ    FPT_OPEN+37,'04'O,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:397  
     2394    18778    2     FPT_OPEN.V.INITZ.SCRUB# = %YES#;

  18778  2 012031   400000 236007                    LDQ     -131072,DL
         2 012032   202014 256100                    ORSQ    FPT_OPEN+36,,AUTO

     2395    18779    2     LEN=1024*4;

  18779  2 012033   010000 235007                    LDA     4096,DL
         2 012034   200476 755100                    STA     LEN,,AUTO

     2396    18780    2     FPT_OPEN.FPARAM_=VECTOR(SEG3$->VARY$STRNG);

  18780  2 012035   000020 735000                    ALS     16
         2 012036   000140 135007                    SBLA    96,DL
         2 012037   000000 236000 xsym               LDQ     SEG3$
         2 012040   202000 757100                    STAQ    FPT_OPEN+24,,AUTO

     2397    18781    2     LEN=1;

  18781  2 012041   000001 235007                    LDA     1,DL
         2 012042   200476 755100                    STA     LEN,,AUTO

     2398    18782    2     SEG3$->VARY$STRNG='0'B;

  18782  2 012043   000000 470400 xsym               LDP0    SEG3$
         2 012044   000000 621005                    EAX1    0,AL
         2 012045   000140 100400                    MLR     fill='000'O
         2 012046   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 012047   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     2399    18783    2     TVAL=0;

  18783  2 012050   200013 450100                    STZ     TVAL,,AUTO

     2400    18784    2     CALL M$OPEN(FPT_OPEN) ALTRET(DISPUSER20);

  18784  2 012051   201750 630500                    EPPR0   FPT_OPEN,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:398  
         2 012052   450000 713400                    CLIMB   alt,open
         2 012053   410400 401760                    pmme    nvectors=18
         2 012054   012055 702000 2                  TSX2    DISPUSER20

  18783  2 012055                       DISPUSER20   null
     2401    18785    2   DISPUSER20:;
     2402    18786    2     LEN=IBEX_CODE14;

  18786  2 012055   000016 235007                    LDA     14,DL
         2 012056   200476 755100                    STA     LEN,,AUTO

     2403    18787    2     TEMP1$=SEG3$;

  18787  2 012057   000000 236000 xsym               LDQ     SEG3$
         2 012060   200012 756100                    STQ     TEMP1$,,AUTO

     2404    18788    2     CALL XSF$LOCCODE(TEMP1$,LEN) ALTRET(DISPUSER30);

  18788  2 012061   200476 630500                    EPPR0   LEN,,AUTO
         2 012062   202353 450500                    STP0    CLSDCB+31,,AUTO
         2 012063   200012 631500                    EPPR1   TEMP1$,,AUTO
         2 012064   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 012065   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012066   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 012067   000000 701000 xent               TSX1    XSF$LOCCODE
         2 012070   012103 702000 2                  TSX2    DISPUSER30

     2405    18789        /*
     2406    18790          ****     Use the smallest value
     2407    18791        */
     2408    18792    2     TVAL=TEMP1$->CODE14.MGRANS-TEMP1$->CODE14.CGRANS;

  18792  2 012071   200012 470500                    LDP0    TEMP1$,,AUTO
         2 012072   000001 236100                    LDQ     1,,PR0
         2 012073   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 012074   000002 136100                    SBLQ    2,,PR0
         2 012075   200013 756100                    STQ     TVAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:399  

     2409    18793    2     IF B$JIT.PRDPRM < TVAL

  18793  2 012076   000000 471400 xsym               LDP1    B$JIT$
         2 012077   100242 116100                    CMPQ    162,,PR1
         2 012100   012103 604400 2                  TMOZ    DISPUSER30

     2410    18794    2        THEN
     2411    18795    2           TVAL=B$JIT.PRDPRM;

  18795  2 012101   100242 235100                    LDA     162,,PR1
         2 012102   200013 755100                    STA     TVAL,,AUTO

  18793  2 012103                       DISPUSER30   null
     2412    18796    2   DISPUSER30:;
     2413    18797    2     CALL CPC$RELSEG (SEG3$);

  18797  2 012103   000007 630400 3                  EPPR0   7
         2 012104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 012105   000000 701000 xent               TSX1    CPC$RELSEG
         2 012106   000000 011000                    NOP     0

     2414    18798    2     IF (TVAL < 0)

  18798  2 012107   200013 235100                    LDA     TVAL,,AUTO
         2 012110   012112 605000 2                  TPL     s:18800

     2415    18799    2        THEN TVAL = 0;

  18799  2 012111   200013 450100                    STZ     TVAL,,AUTO

     2416    18800    2     CALL CNVRT_BLD(25,'  Disk space remaining = ',TVAL) ALTRET(DISPUSER50);

  18800  2 012112   200013 630500                    EPPR0   TVAL,,AUTO
         2 012113   202307 450500                    STP0    @TEXT+1,,AUTO
         2 012114   000361 236000 3                  LDQ     241
         2 012115   202306 756100                    STQ     @FLAG+1,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:400  
         2 012116   000256 236000 3                  LDQ     174
         2 012117   202305 756100                    STQ     SIZ+2,,AUTO
         2 012120   012300 701000 2                  TSX1    CNVRT_BLD
         2 012121   012163 702000 2                  TSX2    DISPUSER50

     2417    18801    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  18801  2 012122   000000 470400 xsym               LDP0    SEG2$
         2 012123   000165 471500                    LDP1    117,,PR0
         2 012124   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 012125   000020 772000                    QRL     16
         2 012126   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 012127   200035 236100                    LDQ     DEST$,,AUTO
         2 012130   000020 772000                    QRL     16
         2 012131   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 012132   000020 736000                    QLS     16
         2 012133   100004 676100                    ERQ     4,,PR1
         2 012134   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 012135   100004 656100                    ERSQ    4,,PR1

     2418    18802    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPUSER50);

  18802  2 012136   000000 236000 xsym               LDQ     SEG2$
         2 012137   000165 036003                    ADLQ    117,DU
         2 012140   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 012141   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012142   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 012143   000000 701000 xent               TSX1    CPE$LISTOUT
         2 012144   012163 702000 2                  TSX2    DISPUSER50

     2419    18803        /*
     2420    18804          ****     Don't output msge. 'NO SETUP COMMAND' if no command in :USERS
     2421    18805        */
     2422    18806    2     MSGFLAG=%NO#;

  18806  2 012145   200631 450100                    STZ     MSGFLAG,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:401  
     2423    18807        /*
     2424    18808          ****     Fake out CPI$SETUP routine
     2425    18809        */
     2426    18810    2     P$PCB.OUT$=TEMP$;

  18810  2 012146   200011 236100                    LDQ     TEMP$,,AUTO
         2 012147   200003 470500                    LDP0    @P$PCB,,AUTO
         2 012150   000003 756100                    STQ     3,,PR0

     2427    18811    2     CALL CPI$SETUP(P$PCB,MSGFLAG) ALTRET(DISPUSER50);

  18811  2 012151   200631 631500                    EPPR1   MSGFLAG,,AUTO
         2 012152   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 012153   200003 236100                    LDQ     @P$PCB,,AUTO
         2 012154   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 012155   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012156   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 012157   000000 701000 xent               TSX1    CPI$SETUP
         2 012160   012163 702000 2                  TSX2    DISPUSER50

     2428    18812    2     RETURN;

  18812  2 012161   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 012162   000001 702211                    TSX2  ! 1,X1

  18810  2 012163                       DISPUSER50   null
     2429    18813    2   DISPUSER50:;
     2430    18814    2     ALTRETURN;

  18814  2 012163   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 012164   000000 702211                    TSX2  ! 0,X1

  18810  2 012165                       DISPUSER60   null
     2431    18815    2   DISPUSER60:;
     2432    18816    2     CALL CPC$SCREECH(E$SUASEG,CPE$IBEXMID);

  18816  2 012165   000100 630400 3                  EPPR0   64
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:402  
         2 012166   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 012167   000000 701000 xent               TSX1    CPC$SCREECH
         2 012170   000000 011000                    NOP     0

     2433    18817        /*    ERROR:   CPE-E$SUASEG-A
     2434    18818                MESSAGE:  IBEX ABORT:  Unable to obtain data segment.  JIT.ERR
     2435    18819                                       follows.
     2436    18820                DESCRIPTION: IBEX was unable to get a data segment used for the
     2437    18821                             purpose of reading  the assign merge record.
     2438    18822        */
     2439    18823    2   END DISPUSER;

  18823  2 012171   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 012172   000001 702211                    TSX2  ! 1,X1

     2440    18824                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:403  
     2441    18825        /********************************************************************/
     2442    18826        /*I*   NAME:   DISPSTEPCC
     2443    18827               PURPOSE: Display step condition codes
     2444    18828               CALL:   CALL DISPSTEPCC
     2445    18829               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     2446    18830               INPUT:  B$JIT.STEPCC
     2447    18831               OUTPUT: condition codes listed
     2448    18832               DESCRIPTION: The step condition codes in the JIT are displayed on
     2449    18833                       the listing device.
     2450    18834        */
     2451    18835        /**********************************************************************/
     2452    18836    1   DISPSTEPCC: PROC ALTRET;

  18836  2 012173   202072 741300       DISPSTEPCC   STX1  ! VLP_SN+4,,AUTO

     2453    18837    2   DCL STEPCC CHAR(3);
     2454    18838        /**/
     2455    18839        /**/
     2456    18840    2     OUTBUFF$=ADDR(OUTBUFF);

  18840  2 012174   200237 630500                    EPPR0   OUTBUFF,,AUTO
         2 012175   200036 450500                    STP0    OUTBUFF$,,AUTO

     2457    18841    2     DEST$=OUTBUFF$;

  18841  2 012176   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 012177   200035 756100                    STQ     DEST$,,AUTO

     2458    18842    2     OUTBUFF='   StepCC: ';

  18842  2 012200   040100 100400                    MLR     fill='040'O
         2 012201   001506 000013 1                  ADSC9   CONSTCLS+328             cn=0,n=11
         2 012202   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2459    18843    2     DEST$=PINCRC(DEST$,SIZEC('   StepCC: '));            /*Bump ptr*/

  18843  2 012203   000362 036000 3                  ADLQ    242
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:404  
         2 012204   200035 756100                    STQ     DEST$,,AUTO

     2460    18844    2     CALL BINCHAR(STEPCC,B$JIT.STEPCC);

  18844  2 012205   000000 471400 xsym               LDP1    B$JIT$
         2 012206   100316 236100                    LDQ     206,,PR1
         2 012207   000022 772000                    QRL     18
         2 012210   000777 376007                    ANQ     511,DL
         2 012211   000000 235003                    LDA     0,DU
         2 012212   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 012213   000100 301500                    BTD
         2 012214   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 012215   202073 030003                    NDSC9   STEPCC,,AUTO             cn=0,s=nosgn,sf=0,n=3

     2461    18845    2     CALL CPE$RZEROS(STEPCC,SIZEC(STEPCC),LEN);

  18845  2 012216   200476 633500                    EPPR3   LEN,,AUTO
         2 012217   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 012220   000055 236000 3                  LDQ     45
         2 012221   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 012222   202073 634500                    EPPR4   STEPCC,,AUTO
         2 012223   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 012224   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012225   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 012226   000000 701000 xent               TSX1    CPE$RZEROS
         2 012227   000000 011000                    NOP     0

     2462    18846    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(STEPCC),LEN)

  18846  2 012230   202073 630500                    EPPR0   STEPCC,,AUTO
         2 012231   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 012232   200476 631500                    EPPR1   LEN,,AUTO
         2 012233   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 012234   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 012235   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 012236   200035 634500                    EPPR4   DEST$,,AUTO
         2 012237   202355 454500                    STP4    CLSDCB+33,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:405  
         2 012240   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 012241   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 012242   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 012243   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 012244   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012245   012276 702000 2                  TSX2    DISPSTEPCC50

     2463    18847    2          ALTRET(DISPSTEPCC50);
     2464    18848    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  18848  2 012246   000000 470400 xsym               LDP0    SEG2$
         2 012247   000165 471500                    LDP1    117,,PR0
         2 012250   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 012251   000020 772000                    QRL     16
         2 012252   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 012253   200035 236100                    LDQ     DEST$,,AUTO
         2 012254   000020 772000                    QRL     16
         2 012255   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 012256   000020 736000                    QLS     16
         2 012257   100004 676100                    ERQ     4,,PR1
         2 012260   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 012261   100004 656100                    ERSQ    4,,PR1

     2465    18849    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  18849  2 012262   000165 471500                    LDP1    117,,PR0
         2 012263   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 012264   100005 756100                    STQ     5,,PR1

     2466    18850    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPSTEPCC50);

  18850  2 012265   000000 236000 xsym               LDQ     SEG2$
         2 012266   000165 036003                    ADLQ    117,DU
         2 012267   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 012270   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 012272   000000 701000 xent               TSX1    CPE$LISTOUT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:406  
         2 012273   012276 702000 2                  TSX2    DISPSTEPCC50

     2467    18851    2     RETURN;

  18851  2 012274   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 012275   000001 702211                    TSX2  ! 1,X1

  18849  2 012276                       DISPSTEPCC50 null
     2468    18852    2   DISPSTEPCC50:;
     2469    18853    2     ALTRETURN;

  18853  2 012276   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 012277   000000 702211                    TSX2  ! 0,X1

     2470    18854    2   END DISPSTEPCC;
     2471    18855                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:407  
     2472    18856        /**********************************************************************/
     2473    18857        /*I*   NAME:   CNVRT_BLD
     2474    18858               PURPOSE: Stores a keyword and its binary value, after being converted
     2475    18859                       to text, into OUTBUFF.
     2476    18860               INTERFACE: CPE$RZEROS,CPB$BLDIMAGE
     2477    18861               INPUT:  KEYWDSZE - keyword size
     2478    18862                       KEYWD      - keyword text
     2479    18863                       KEYWDVAL   - keyword value
     2480    18864               OUTPUT: Keyword and its value to OUTBUFF i.e. KEYWORD=value
     2481    18865               DESCRIPTION: The binary value is converted to a character string
     2482    18866                       and stored along with its keyword into OUTBUFF.
     2483    18867        */
     2484    18868        /***********************************************************************/
     2485    18869    1   CNVRT_BLD: PROC(KEYWDSZE,KEYWD,KEYWDVAL) ALTRET;

  18869  2 012300   202304 741300       CNVRT_BLD    STX1  ! SIZ+1,,AUTO

     2486    18870    2   DCL KEYWDSZE UBIN(36) ALIGNED;                   /*Size of keyword*/
     2487    18871    2   DCL KEYWD CHAR(10);                              /*Keyword to be stored*/
     2488    18872    2   DCL KEYWDVAL UBIN(36) ALIGNED;                   /*Value to be stored*/
     2489    18873    2   DCL TBUFF CHAR(6);                               /*Temp. Buffer */
     2490    18874    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(KEYWD),KEYWDSZE,TAB_VAL)

  18874  2 012301   202306 236100                    LDQ     @KEYWD,,AUTO
         2 012302   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 012303   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 012304   202357 450500                    STP0    CLSDCB+35,,AUTO
         2 012305   202305 236100                    LDQ     @KEYWDSZE,,AUTO
         2 012306   202356 756100                    STQ     CLSDCB+34,,AUTO
         2 012307   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 012310   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 012311   200035 633500                    EPPR3   DEST$,,AUTO
         2 012312   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 012313   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 012314   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 012315   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 012316   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:408  
         2 012317   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012320   012364 702000 2                  TSX2    CNVRT_BLD50

     2491    18875    2          ALTRET(CNVRT_BLD50);
     2492    18876    2     CALL BINCHAR(TBUFF,KEYWDVAL);

  18876  2 012321   202307 470500                    LDP0    @KEYWDVAL,,AUTO
         2 012322   000000 235100                    LDA     0,,PR0
         2 012323   000044 773000                    LRL     36
         2 012324   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 012325   000100 301500                    BTD
         2 012326   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 012327   202310 030006                    NDSC9   TBUFF,,AUTO              cn=0,s=nosgn,sf=0,n=6

     2493    18877    2     CALL CPE$RZEROS(TBUFF,SIZEC(TBUFF),LEN);

  18877  2 012330   200476 631500                    EPPR1   LEN,,AUTO
         2 012331   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 012332   000052 236000 3                  LDQ     42
         2 012333   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 012334   202310 633500                    EPPR3   TBUFF,,AUTO
         2 012335   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 012336   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012337   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 012340   000000 701000 xent               TSX1    CPE$RZEROS
         2 012341   000000 011000                    NOP     0

     2494    18878    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(TBUFF),LEN,TAB_VAL) ALTRET(CNVRT_BLD50);

  18878  2 012342   202310 630500                    EPPR0   TBUFF,,AUTO
         2 012343   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 012344   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 012345   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 012346   200476 633500                    EPPR3   LEN,,AUTO
         2 012347   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 012350   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 012351   202355 454500                    STP4    CLSDCB+33,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:409  
         2 012352   200035 635500                    EPPR5   DEST$,,AUTO
         2 012353   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 012354   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 012355   202353 456500                    STP6    CLSDCB+31,,AUTO
         2 012356   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 012357   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012360   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012361   012364 702000 2                  TSX2    CNVRT_BLD50

     2495    18879    2     RETURN;

  18879  2 012362   202304 221300                    LDX1  ! SIZ+1,,AUTO
         2 012363   000001 702211                    TSX2  ! 1,X1

  18876  2 012364                       CNVRT_BLD50  null
     2496    18880    2   CNVRT_BLD50:;
     2497    18881    2     ALTRETURN;

  18881  2 012364   202304 221300                    LDX1  ! SIZ+1,,AUTO
         2 012365   000000 702211                    TSX2  ! 0,X1

     2498    18882    2   END CNVRT_BLD;
     2499    18883                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:410  
     2500    18884        /**********************************************************************/
     2501    18885        /*I*   NAME:   DISP_PMSN
     2502    18886               PURPOSE: Display ACCESS and ACSVEH permission flags
     2503    18887               CALL:   CALL DISP_PMSN
     2504    18888               INTERFACE: CPB$BLDIMAGE
     2505    18889               INPUT:  PMSN$ - ptr to permission flags
     2506    18890               OUTPUT: Permission flag text into output buffer
     2507    18891               DESCRIPTION: Permission flag text is inserted into OUTBUFF
     2508    18892                       following the vehicle or access name.
     2509    18893        */
     2510    18894        /**********************************************************************/
     2511    18895    1   DISP_PMSN: PROC(PMSN$) ALTRET;

  18895  2 012366   202130 741300       DISP_PMSN    STX1  ! STREAM+1,,AUTO

     2512    18896    2   DCL PMSN$ PTR;                                   /*Ptr to permission flags*/
     2513    18897    2   DCL I SBIN WORD;                          /*Temp. Loc. For INDEX.*/
     2514    18898    2   DCL CNTLS(0:17) BIT(1) BASED;                  /*Access/vehicle flag structure*/
     2515    18899    2   DCL CNTLS_A(0:17) BIT(1) AUTO;                 /*Local copy Access/vehicle flag*/
     2516    18900        %EQU RESET_CREATE_FLG#='776777'O;
     2517    18901    2   DCL ACCESS_FLAGS(0:11) CHAR(7) CONSTANT INIT
     2518    18902    2                   (',Read',',DelR',',WNew',',Upd',',DelF',',NoList',
     2519    18903    2                   ',ReAttr',',Exec',',',',AU',',AURd',',Tctl');
     2520    18904    2     CNTLS_A = PMSN$->CNTLS & %RESET_CREATE_FLG# ;

  18904  2 012367   202131 470500                    LDP0    @PMSN$,,AUTO
         2 012370   000000 471500                    LDP1    0,,PR0
         2 012371   003100 060500                    CSL     bolr='003'O
         2 012372   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         2 012373   202352 000044                    BDSC    CLSDCB+30,,AUTO          by=0,bit=0,n=36
         2 012374   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 012375   776777 376003                    ANQ     -513,DU
         2 012376   000022 772000                    QRL     18
         2 012377   000000 620006                    EAX0    0,QL
         2 012400   202133 740100                    STX0    CNTLS_A,,AUTO

     2521    18905    3     DO I=0 TO 17;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:411  

  18905  2 012401   202132 450100                    STZ     I,,AUTO

     2522    18906    3        IF CNTLS_A(I) = %YES#

  18906  2 012402   202132 235100                    LDA     I,,AUTO
         2 012403   012405 605000 2                  TPL     s:18906+3
         2 012404   000044 035003                    ADLA    36,DU
         2 012405   000000 066505                    CMPB    filb='0'B
         2 012406   202133 000001                    BDSC    CNTLS_A,A,AUTO           by=0,bit=0,n=1
         2 012407   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 012410   012440 600000 2                  TZE     s:18914

     2523    18907    3           THEN
     2524    18908    4              DO;

     2525    18909    4                 INBUFF=ACCESS_FLAGS(I);

  18909  2 012411   202132 236100                    LDQ     I,,AUTO
         2 012412   000007 402007                    MPY     7,DL
         2 012413   040100 100406                    MLR     fill='040'O
         2 012414   000474 000007 1                  ADSC9   ACCESS_FLAGS,Q           cn=0,n=7
         2 012415   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2526    18910    4                 CALL INDEX(LEN,' ',INBUFF); /*Get string size*/

  18910  2 012416   000000 124500                    SCM     mask='000'O
         2 012417   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512
         2 012420   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 012421   200476 000100                    ARG     LEN,,AUTO

     2527    18911    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL)

  18911  2 012422   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 012423   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 012424   200476 631500                    EPPR1   LEN,,AUTO
         2 012425   202355 451500                    STP1    CLSDCB+33,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:412  
         2 012426   200034 633500                    EPPR3   IN$,,AUTO
         2 012427   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 012430   200035 634500                    EPPR4   DEST$,,AUTO
         2 012431   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 012432   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 012433   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 012434   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012435   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012436   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012437   012446 702000 2                  TSX2    PMSN50

     2528    18912    4                      ALTRET(PMSN50);
     2529    18913    4              END;

     2530    18914    3     END;

  18914  2 012440   202132 054100                    AOS     I,,AUTO
         2 012441   202132 235100                    LDA     I,,AUTO
         2 012442   000021 115007                    CMPA    17,DL
         2 012443   012402 604400 2                  TMOZ    s:18906

     2531    18915    2     RETURN;

  18915  2 012444   202130 221300                    LDX1  ! STREAM+1,,AUTO
         2 012445   000001 702211                    TSX2  ! 1,X1

  18913  2 012446                       PMSN50       null
     2532    18916    2   PMSN50: ;
     2533    18917    2     ALTRETURN;

  18917  2 012446   202130 221300                    LDX1  ! STREAM+1,,AUTO
         2 012447   000000 702211                    TSX2  ! 0,X1

     2534    18918    2   END DISP_PMSN;
     2535    18919                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:413  
     2536    18920        /**********************************************************************/
     2537    18921        /*I*   NAME:   DISP_OPT_YESNO
     2538    18922               PURPOSE: Display the specified option follewed by yes/no
     2539    18923               CALL:   CALL DISP_OPT_YESNO
     2540    18924               INTERFACE: CPB$BLDIMAGE
     2541    18925               INPUT:  OPTN - sub specifying option to be displayed
     2542    18926                       AMOPTN1$ - ptr to two bit field to be checked
     2543    18927                       AMOPTN2$ - ptr to one bit field to be checked
     2544    18928               OUTPUT: Options followed by yes/no into output buffer
     2545    18929               DESCRIPTION: Using the passed sub, the text is obtained from a table
     2546    18930                       and yes/no appended depending on bit settings. If a two bit
     2547    18931                       field is to be checked, a pointer should be passed via
     2548    18932                       AMOPTN1$, otherwise in AMOPTN2$.
     2549    18933        */
     2550    18934        /**********************************************************************/
     2551    18935    1   DISP_OPT_YESNO: PROC(OPTN,AMOPTN1$,AMOPTN2$) ALTRET;

  18935  2 012450   202130 741300       DISP_OPT_YE* STX1  ! STREAM+1,,AUTO

     2552    18936    2   DCL I SBIN WORD;
     2553    18937    2   DCL OPTN UBIN;
     2554    18938    2   DCL AMOPTN1$ PTR;
     2555    18939    2   DCL AMOPTN2$ PTR;
     2556    18940    2   DCL BIT$1 BIT(1) BASED;
     2557    18941    2   DCL BIT$2 BIT(2) BASED;
     2558    18942        /**/
     2559    18943        /**/
     2560    18944    2     IF (ADDR(AMOPTN1$) ~= ADDR(NIL) AND (AMOPTN1$->BIT$2 ~= DEFAULT#))  OR

  18944  2 012451   202132 236100                    LDQ     @AMOPTN1$,,AUTO
         2 012452   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 012453   012462 600000 2                  TZE     s:18944+9
         2 012454   202132 470500                    LDP0    @AMOPTN1$,,AUTO
         2 012455   000000 471500                    LDP1    0,,PR0
         2 012456   000000 066500                    CMPB    filb='0'B
         2 012457   100000 000002                    BDSC    0,,PR1                   by=0,bit=0,n=2
         2 012460   000220 000022 3                  BDSC    144                      by=0,bit=0,n=18
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:414  
         2 012461   012465 601000 2                  TNZ     s:18948
         2 012462   202133 236100                    LDQ     @AMOPTN2$,,AUTO
         2 012463   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 012464   012555 600000 2                  TZE     s:18962

     2561    18945    2           ADDR(AMOPTN2$) ~= ADDR(NIL)
     2562    18946    2        THEN
     2563    18947    3           DO;

     2564    18948    3              INBUFF = ',';

  18948  2 012465   040100 100400                    MLR     fill='040'O
         2 012466   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 012467   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2565    18949    3             CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISP_OPT_YESNO50);

  18949  2 012470   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 012471   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 012472   000033 236000 3                  LDQ     27
         2 012473   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 012474   200034 631500                    EPPR1   IN$,,AUTO
         2 012475   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 012476   200035 633500                    EPPR3   DEST$,,AUTO
         2 012477   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 012500   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 012501   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 012502   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012503   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012504   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012505   012625 702000 2                  TSX2    DISP_OPT_YESNO50

     2566    18950    4              DO I=0 TO OPT_TBLSZE;

  18950  2 012506   202134 450100                    STZ     I,,AUTO
         2 012507   012552 710000 2                  TRA     s:18960+1

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:415  
     2567    18951    4                 IF OPT_TBL.OPTION(I) = OPTN

  18951  2 012510   202131 470500                    LDP0    @OPTN,,AUTO
         2 012511   202134 235100                    LDA     I,,AUTO
         2 012512   000002 735000                    ALS     2
         2 012513   000026 236005 1                  LDQ     OPT_TBL+3,AL
         2 012514   000777 376007                    ANQ     511,DL
         2 012515   000000 116100                    CMPQ    0,,PR0
         2 012516   012551 601000 2                  TNZ     s:18960

     2568    18952    4                    THEN
     2569    18953    5                       DO;

     2570    18954    5                          INBUFF = OPT_TBL.HDR(I);

  18954  2 012517   202134 235100                    LDA     I,,AUTO
         2 012520   000004 735000                    ALS     4
         2 012521   040100 100405                    MLR     fill='040'O
         2 012522   000023 200016 1                  ADSC9   OPT_TBL,A                cn=1,n=14
         2 012523   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2571    18955    5                          LEN = OPT_TBL.LEN(I);

  18955  2 012524   202134 236100                    LDQ     I,,AUTO
         2 012525   000002 736000                    QLS     2
         2 012526   000023 236006 1                  LDQ     OPT_TBL,QL
         2 012527   000033 772000                    QRL     27
         2 012530   200476 756100                    STQ     LEN,,AUTO

     2572    18956    5                          CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,

  18956  2 012531   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 012532   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 012533   200476 633500                    EPPR3   LEN,,AUTO
         2 012534   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 012535   200034 634500                    EPPR4   IN$,,AUTO
         2 012536   202354 454500                    STP4    CLSDCB+32,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:416  
         2 012537   200035 635500                    EPPR5   DEST$,,AUTO
         2 012540   202353 455500                    STP5    CLSDCB+31,,AUTO
         2 012541   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 012542   202352 456500                    STP6    CLSDCB+30,,AUTO
         2 012543   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012544   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012545   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012546   012625 702000 2                  TSX2    DISP_OPT_YESNO50

     2573    18957    5                                LEN,TAB_VAL) ALTRET(DISP_OPT_YESNO50);
     2574    18958    5                          I = OPT_TBLSZE;

  18958  2 012547   000022 235000 1                  LDA     OPT_TBLSZE
         2 012550   202134 755100                    STA     I,,AUTO

     2575    18959    5                       END;

     2576    18960    4              END;

  18960  2 012551   202134 054100                    AOS     I,,AUTO
         2 012552   202134 236100                    LDQ     I,,AUTO
         2 012553   000022 116000 1                  CMPQ    OPT_TBLSZE
         2 012554   012510 604400 2                  TMOZ    s:18951

     2577    18961    3           END;

     2578    18962    2     IF ADDR(AMOPTN1$) ~= ADDR(NIL)

  18962  2 012555   202132 236100                    LDQ     @AMOPTN1$,,AUTO
         2 012556   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 012557   012570 600000 2                  TZE     s:18975

     2579    18963    2        THEN
     2580    18964    3           DO;

     2581    18965    3              IF (AMOPTN1$->BIT$2 = %NO#)

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:417  
  18965  2 012560   202132 470500                    LDP0    @AMOPTN1$,,AUTO
         2 012561   000000 471500                    LDP1    0,,PR0
         2 012562   000000 066500                    CMPB    filb='0'B
         2 012563   100000 000002                    BDSC    0,,PR1                   by=0,bit=0,n=2
         2 012564   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 012565   012600 600000 2                  TZE     DISP_OPT_YESNO10

     2582    18966    3                 THEN
     2583    18967    3                      GOTO DISP_OPT_YESNO10;
     2584    18968    3              ELSE;
     2585    18969    3                 RETURN;

  18969  2 012566   202130 221300                    LDX1  ! STREAM+1,,AUTO
         2 012567   000001 702211                    TSX2  ! 1,X1

     2586    18970    3           END;
     2587    18971        /*
     2588    18972          **** ASSUME 1 BIT OPTION FIELD TO BE CHECKED
     2589    18973        */
     2590    18974    2     ELSE
     2591    18975    2        IF AMOPTN2$->BIT$1 =%YES#

  18975  2 012570   202133 470500                    LDP0    @AMOPTN2$,,AUTO
         2 012571   000000 471500                    LDP1    0,,PR0
         2 012572   000000 066500                    CMPB    filb='0'B
         2 012573   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         2 012574   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 012575   012600 600000 2                  TZE     DISP_OPT_YESNO10

     2592    18976    2           THEN
     2593    18977    2              RETURN;

  18977  2 012576   202130 221300                    LDX1  ! STREAM+1,,AUTO
         2 012577   000001 702211                    TSX2  ! 1,X1

     2594    18978    2   DISP_OPT_YESNO10:
     2595    18979    2     INBUFF = '=no';
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:418  

  18979  2 012600   040100 100400       DISP_OPT_YE* MLR     fill='040'O
         2 012601   001511 000003 1                  ADSC9   CONSTCLS+331             cn=0,n=3
         2 012602   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2596    18980    2     LEN = SIZEC('=no');

  18980  2 012603   000003 235007                    LDA     3,DL
         2 012604   200476 755100                    STA     LEN,,AUTO

     2597    18981    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISP_OPT_YESNO50);

  18981  2 012605   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 012606   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 012607   200476 631500                    EPPR1   LEN,,AUTO
         2 012610   202355 451500                    STP1    CLSDCB+33,,AUTO
         2 012611   200034 633500                    EPPR3   IN$,,AUTO
         2 012612   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 012613   200035 634500                    EPPR4   DEST$,,AUTO
         2 012614   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 012615   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 012616   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 012617   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012620   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012621   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012622   012625 702000 2                  TSX2    DISP_OPT_YESNO50

     2598    18982    2     RETURN;

  18982  2 012623   202130 221300                    LDX1  ! STREAM+1,,AUTO
         2 012624   000001 702211                    TSX2  ! 1,X1

     2599    18983    2   DISP_OPT_YESNO50:
     2600    18984    2     ALTRETURN;

  18984  2 012625   202130 221300       DISP_OPT_YE* LDX1  ! STREAM+1,,AUTO
         2 012626   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:419  

     2601    18985    2   END DISP_OPT_YESNO;
     2602    18986                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:420  
     2603    18987        /**********************************************************************/
     2604    18988        /*I*   NAME:   DISP_OPT_TEXT
     2605    18989        						
     2606    18990               CALL:   CALL DISP_OPT_TEXT
     2607    18991               INTERFACE: CPB$BLDIMAGE
     2608    18992               INPUT:  OPTION - sub specifying option to be displayed
     2609    18993                       OSZE - text field size
     2610    18994                       OTEXT$ -  ptr to text to be displayed
     2611    18995                       OPT_TBL - parallel option name table
     2612    18996               OUTPUT: Text into output buffer
     2613    18997               DESCRIPTION: A check is made for presence of text and inserted
     2614    18998                       into the output buffer preceded by its option.
     2615    18999        */
     2616    19000        /**********************************************************************/
     2617    19001    1   DISP_OPT_TEXT: PROC(OPTION,OSZE,OTEXT$) ALTRET;

  19001  2 012627   202130 741300       DISP_OPT_TE* STX1  ! STREAM+1,,AUTO

     2618    19002    2   DCL OPTION UBIN;
     2619    19003    2   DCL OSZE UBIN;
     2620    19004    2   DCL 1 VARY$STRNG BASED CHAR(OSZE);
     2621    19005    2   DCL OTEXT$ PTR;
     2622    19006    2   DCL I SBIN WORD;
     2623    19007        /**/
     2624    19008        /**/
     2625    19009    2     IF OTEXT$->VARY$STRNG = ' '

  19009  2 012630   202133 470500                    LDP0    @OTEXT$,,AUTO
         2 012631   000000 471500                    LDP1    0,,PR0
         2 012632   202132 473500                    LDP3    @OSZE,,AUTO
         2 012633   300000 720100                    LXL0    0,,PR3
         2 012634   040000 106540                    CMPC    fill='040'O
         2 012635   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 012636   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 012637   012641 601000 2                  TNZ     s:19012

     2626    19010    2        THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:421  
     2627    19011    2           RETURN;

  19011  2 012640   000001 702211                    TSX2  ! 1,X1

     2628    19012    2     INBUFF = ',';

  19012  2 012641   040100 100400                    MLR     fill='040'O
         2 012642   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 012643   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2629    19013    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISP_OPT_TEXT50);

  19013  2 012644   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 012645   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 012646   000033 236000 3                  LDQ     27
         2 012647   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 012650   200034 634500                    EPPR4   IN$,,AUTO
         2 012651   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 012652   200035 635500                    EPPR5   DEST$,,AUTO
         2 012653   202353 455500                    STP5    CLSDCB+31,,AUTO
         2 012654   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 012655   202352 456500                    STP6    CLSDCB+30,,AUTO
         2 012656   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012657   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012660   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012661   013007 702000 2                  TSX2    DISP_OPT_TEXT50

     2630    19014    3     DO I=0 TO OPT_TBLSZE;

  19014  2 012662   202134 450100                    STZ     I,,AUTO
         2 012663   012726 710000 2                  TRA     s:19024+1

     2631    19015    3        IF OPT_TBL.OPTION(I) = OPTION

  19015  2 012664   202131 470500                    LDP0    @OPTION,,AUTO
         2 012665   202134 235100                    LDA     I,,AUTO
         2 012666   000002 735000                    ALS     2
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:422  
         2 012667   000026 236005 1                  LDQ     OPT_TBL+3,AL
         2 012670   000777 376007                    ANQ     511,DL
         2 012671   000000 116100                    CMPQ    0,,PR0
         2 012672   012725 601000 2                  TNZ     s:19024

     2632    19016    3           THEN
     2633    19017    4              DO;

     2634    19018    4                 INBUFF = OPT_TBL.HDR(I);

  19018  2 012673   202134 235100                    LDA     I,,AUTO
         2 012674   000004 735000                    ALS     4
         2 012675   040100 100405                    MLR     fill='040'O
         2 012676   000023 200016 1                  ADSC9   OPT_TBL,A                cn=1,n=14
         2 012677   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2635    19019    4                 LEN = OPT_TBL.LEN(I);

  19019  2 012700   202134 236100                    LDQ     I,,AUTO
         2 012701   000002 736000                    QLS     2
         2 012702   000023 236006 1                  LDQ     OPT_TBL,QL
         2 012703   000033 772000                    QRL     27
         2 012704   200476 756100                    STQ     LEN,,AUTO

     2636    19020    4                 CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,

  19020  2 012705   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 012706   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 012707   200476 633500                    EPPR3   LEN,,AUTO
         2 012710   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 012711   200034 634500                    EPPR4   IN$,,AUTO
         2 012712   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 012713   200035 635500                    EPPR5   DEST$,,AUTO
         2 012714   202353 455500                    STP5    CLSDCB+31,,AUTO
         2 012715   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 012716   202352 456500                    STP6    CLSDCB+30,,AUTO
         2 012717   202352 630500                    EPPR0   CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:423  
         2 012720   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012721   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012722   013007 702000 2                  TSX2    DISP_OPT_TEXT50

     2637    19021    4                       LEN,TAB_VAL) ALTRET(DISP_OPT_TEXT50);
     2638    19022    4                 I = OPT_TBLSZE;

  19022  2 012723   000022 235000 1                  LDA     OPT_TBLSZE
         2 012724   202134 755100                    STA     I,,AUTO

     2639    19023    4              END;

     2640    19024    3     END;

  19024  2 012725   202134 054100                    AOS     I,,AUTO
         2 012726   202134 236100                    LDQ     I,,AUTO
         2 012727   000022 116000 1                  CMPQ    OPT_TBLSZE
         2 012730   012664 604400 2                  TMOZ    s:19015

     2641    19025    2     INBUFF = '=';

  19025  2 012731   040100 100400                    MLR     fill='040'O
         2 012732   000363 000001 3                  ADSC9   243                      cn=0,n=1
         2 012733   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2642    19026    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISP_OPT_TEXT50);

  19026  2 012734   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 012735   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 012736   000033 236000 3                  LDQ     27
         2 012737   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 012740   200034 631500                    EPPR1   IN$,,AUTO
         2 012741   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 012742   200035 633500                    EPPR3   DEST$,,AUTO
         2 012743   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 012744   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 012745   202352 454500                    STP4    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:424  
         2 012746   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 012747   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 012750   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 012751   013007 702000 2                  TSX2    DISP_OPT_TEXT50

     2643    19027    2     INBUFF = OTEXT$->VARY$STRNG;

  19027  2 012752   202133 470500                    LDP0    @OTEXT$,,AUTO
         2 012753   000000 471500                    LDP1    0,,PR0
         2 012754   202132 473500                    LDP3    @OSZE,,AUTO
         2 012755   300000 720100                    LXL0    0,,PR3
         2 012756   040100 100540                    MLR     fill='040'O
         2 012757   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 012760   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2644    19028    2     CALL INDEX(LEN,' ',OTEXT$->VARY$STRNG);

  19028  2 012761   000000 471500                    LDP1    0,,PR0
         2 012762   300000 720100                    LXL0    0,,PR3
         2 012763   000000 124540                    SCM     mask='000'O
         2 012764   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 012765   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 012766   200476 000100                    ARG     LEN,,AUTO

     2645    19029    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISP_OPT_TEXT50);

  19029  2 012767   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 012770   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 012771   200476 634500                    EPPR4   LEN,,AUTO
         2 012772   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 012773   200034 635500                    EPPR5   IN$,,AUTO
         2 012774   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 012775   200035 636500                    EPPR6   DEST$,,AUTO
         2 012776   202353 456500                    STP6    CLSDCB+31,,AUTO
         2 012777   200036 637500                    EPPR7   OUTBUFF$,,AUTO
         2 013000   202352 457500                    STP7    CLSDCB+30,,AUTO
         2 013001   202352 630500                    EPPR0   CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:425  
         2 013002   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 013003   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 013004   013007 702000 2                  TSX2    DISP_OPT_TEXT50

     2646    19030    2     RETURN;

  19030  2 013005   202130 221300                    LDX1  ! STREAM+1,,AUTO
         2 013006   000001 702211                    TSX2  ! 1,X1

     2647    19031    2   DISP_OPT_TEXT50:
     2648    19032    2     ALTRETURN;

  19032  2 013007   202130 221300       DISP_OPT_TE* LDX1  ! STREAM+1,,AUTO
         2 013010   000000 702211                    TSX2  ! 0,X1

     2649    19033    2   END DISP_OPT_TEXT;
     2650    19034                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:426  
     2651    19035        /********************************************************************/
     2652    19036        /*I*   NAME:   DISPBUDGET
     2653    19037               PURPOSE: Display budget limit
     2654    19038               CALL:   CALL DISPBUDGET
     2655    19039               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     2656    19040               INPUT:  B$JIT.BUDLIM
     2657    19041               OUTPUT: budget limit
     2658    19042               DESCRIPTION: The budget limit specified in the JIT is displayed.
     2659    19043        */
     2660    19044        /**********************************************************************/
     2661    19045    1   DISPBUDGET: PROC ALTRET;

  19045  2 013011   202072 741300       DISPBUDGET   STX1  ! VLP_SN+4,,AUTO

     2662    19046    2   DCL I SBIN WORD;
     2663    19047    2   DCL CHR10 CHAR(10);
     2664    19048    2   DCL CHR11 CHAR(11);
     2665    19049    2   DCL CHR11A(0:10) REDEF CHR11 CHAR(1);
     2666    19050    2   DCL MOPS_7_2_STR(0:5) BIT(9) CONSTANT INIT(%LTE3,ASCBIT(' '),%MFLS7,%ENF00,%INSB7,%
             19050            MVC2);
     2667    19051        /**/
     2668    19052        /**/
     2669    19053    2     OUTBUFF$ = ADDR(OUTBUFF);

  19053  2 013012   200237 630500                    EPPR0   OUTBUFF,,AUTO
         2 013013   200036 450500                    STP0    OUTBUFF$,,AUTO

     2670    19054    2     DEST$ = OUTBUFF$;

  19054  2 013014   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 013015   200035 756100                    STQ     DEST$,,AUTO

     2671    19055    2     OUTBUFF = '   Budget: ';

  19055  2 013016   040100 100400                    MLR     fill='040'O
         2 013017   001512 000013 1                  ADSC9   CONSTCLS+332             cn=0,n=11
         2 013020   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:427  

     2672    19056    2     DEST$ = PINCRC(DEST$,SIZEC('   Budget: '));

  19056  2 013021   000362 036000 3                  ADLQ    242
         2 013022   200035 756100                    STQ     DEST$,,AUTO

     2673    19057    2     IF B$JIT.BUDLIM > 0

  19057  2 013023   000000 471400 xsym               LDP1    B$JIT$
         2 013024   100147 235100                    LDA     103,,PR1
         2 013025   013125 604400 2                  TMOZ    s:19074

     2674    19058    2       THEN
     2675    19059    3         DO ;

     2676    19060    3           INBUFF = '$' ;

  19060  2 013026   040100 100400                    MLR     fill='040'O
         2 013027   000364 000001 3                  ADSC9   244                      cn=0,n=1
         2 013030   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2677    19061    3           IN$ = ADDR(INBUFF) ;

  19061  2 013031   200037 633500                    EPPR3   INBUFF,,AUTO
         2 013032   200034 453500                    STP3    IN$,,AUTO

     2678    19062    3           CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,1,TAB_VAL) ALTRET(DISPBUDGET50) ;

  19062  2 013033   200474 634500                    EPPR4   TAB_VAL,,AUTO
         2 013034   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 013035   000033 236000 3                  LDQ     27
         2 013036   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 013037   200034 635500                    EPPR5   IN$,,AUTO
         2 013040   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 013041   200035 636500                    EPPR6   DEST$,,AUTO
         2 013042   202353 456500                    STP6    CLSDCB+31,,AUTO
         2 013043   200036 637500                    EPPR7   OUTBUFF$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:428  
         2 013044   202352 457500                    STP7    CLSDCB+30,,AUTO
         2 013045   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 013046   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 013047   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 013050   013276 702000 2                  TSX2    DISPBUDGET50

     2679    19063    3           CALL BINXCHAR(CHR10,(B$JIT.BUDLIM-SEG$2.ACCUM_CHG+50)/100);

  19063  2 013051   000000 470400 xsym               LDP0    SEG2$
         2 013052   000000 471400 xsym               LDP1    B$JIT$
         2 013053   100147 236100                    LDQ     103,,PR1
         2 013054   000176 136100                    SBLQ    126,,PR0
         2 013055   000062 036007                    ADLQ    50,DL
         2 013056   000144 506007                    DIV     100,DL
         2 013057   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 013060   000100 301500                    BTD
         2 013061   202352 000004                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=4
         2 013062   202074 010012                    NDSC9   CHR10,,AUTO              cn=0,s=lsgns,sf=0,n=10

     2680    19064    3           CALL EDITXCHAR(CHR11,,,MOPS_7_2_STR,CHR10);

  19064  2 013063   100000 024500                    MVNE
         2 013064   202074 010012                    NDSC9   CHR10,,AUTO              cn=0,s=lsgns,sf=0,n=10
         2 013065   000521 000006 1                  ADSC9   MOPS_7_2_STR             cn=0,n=6
         2 013066   202077 000013                    ADSC9   CHR11,,AUTO              cn=0,n=11

     2681    19065    3           I = 0;

  19065  2 013067   202073 450100                    STZ     I,,AUTO

     2682    19066    4           DO WHILE (CHR11A(I) = ' ' AND I < SIZEC(CHR11));

  19066  2 013070   013072 710000 2                  TRA     s:19068

     2683    19067    4             I = I+1;

  19067  2 013071   202073 054100                    AOS     I,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:429  

     2684    19068    4           END;

  19068  2 013072   202073 235100                    LDA     I,,AUTO
         2 013073   040000 106505                    CMPC    fill='040'O
         2 013074   202077 000001                    ADSC9   CHR11,A,AUTO             cn=0,n=1
         2 013075   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 013076   013101 601000 2                  TNZ     s:19069
         2 013077   000013 115007                    CMPA    11,DL
         2 013100   013071 604000 2                  TMI     s:19067

     2685    19069    3           CHR11 = SUBSTR(CHR11,I,SIZEC(CHR11)-I);

  19069  2 013101   777764 620005                    EAX0    -12,AL
         2 013102   777777 660003                    ERX0    -1,DU
         2 013103   040100 100545                    MLR     fill='040'O
         2 013104   202077 000010                    ADSC9   CHR11,A,AUTO             cn=0,n=*X0
         2 013105   202077 000013                    ADSC9   CHR11,,AUTO              cn=0,n=11

     2686    19070    3           CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(CHR11),SIZEC(CHR11))  ALTRET(
             19070                    DISPBUDGET50);

  19070  2 013106   202077 630500                    EPPR0   CHR11,,AUTO
         2 013107   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 013110   000126 236000 3                  LDQ     86
         2 013111   202357 756100                    STQ     CLSDCB+35,,AUTO
         2 013112   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 013113   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 013114   200035 633500                    EPPR3   DEST$,,AUTO
         2 013115   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 013116   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 013117   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 013120   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 013121   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 013122   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 013123   013276 702000 2                  TSX2    DISPBUDGET50

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:430  
     2687    19071    3         END ; /* Then Do */

  19071  2 013124   013152 710000 2                  TRA     s:19079

     2688    19072    2       ELSE
     2689    19073    3         DO ;

     2690    19074    3           INBUFF = 'No budget limit' ;

  19074  2 013125   040100 100400                    MLR     fill='040'O
         2 013126   001515 000017 1                  ADSC9   CONSTCLS+335             cn=0,n=15
         2 013127   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2691    19075    3           IN$ = ADDR(INBUFF) ;

  19075  2 013130   200037 633500                    EPPR3   INBUFF,,AUTO
         2 013131   200034 453500                    STP3    IN$,,AUTO

     2692    19076    3           LEN = SIZEC('No budget limit') ;

  19076  2 013132   000017 235007                    LDA     15,DL
         2 013133   200476 755100                    STA     LEN,,AUTO

     2693    19077    3           CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,LEN,TAB_VAL) ALTRET(DISPBUDGET50);

  19077  2 013134   200474 634500                    EPPR4   TAB_VAL,,AUTO
         2 013135   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 013136   200476 635500                    EPPR5   LEN,,AUTO
         2 013137   202355 455500                    STP5    CLSDCB+33,,AUTO
         2 013140   200034 636500                    EPPR6   IN$,,AUTO
         2 013141   202354 456500                    STP6    CLSDCB+32,,AUTO
         2 013142   200035 637500                    EPPR7   DEST$,,AUTO
         2 013143   202353 457500                    STP7    CLSDCB+31,,AUTO
         2 013144   200036 630500                    EPPR0   OUTBUFF$,,AUTO
         2 013145   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 013146   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 013147   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:431  
         2 013150   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 013151   013276 702000 2                  TSX2    DISPBUDGET50

     2694    19078    3         END ; /* Else Do */

     2695    19079    2     INBUFF = ', using $' ;

  19079  2 013152   040100 100400                    MLR     fill='040'O
         2 013153   001521 000011 1                  ADSC9   CONSTCLS+339             cn=0,n=9
         2 013154   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2696    19080    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,IN$,9,TAB_VAL) ALTRET(DISPBUDGET50) ;

  19080  2 013155   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 013156   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 013157   000124 236000 3                  LDQ     84
         2 013160   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 013161   200034 631500                    EPPR1   IN$,,AUTO
         2 013162   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 013163   200035 633500                    EPPR3   DEST$,,AUTO
         2 013164   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 013165   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 013166   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 013167   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 013170   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 013171   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 013172   013276 702000 2                  TSX2    DISPBUDGET50

     2697    19081    2     CALL BINXCHAR(CHR10,(SEG$2.ACCUM_CHG+50)/100);

  19081  2 013173   000000 470400 xsym               LDP0    SEG2$
         2 013174   000176 236100                    LDQ     126,,PR0
         2 013175   000062 036007                    ADLQ    50,DL
         2 013176   000001 772000                    QRL     1
         2 013177   000062 506007                    DIV     50,DL
         2 013200   000000 235003                    LDA     0,DU
         2 013201   202352 757100                    STAQ    CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:432  
         2 013202   000100 301500                    BTD
         2 013203   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 013204   202074 010012                    NDSC9   CHR10,,AUTO              cn=0,s=lsgns,sf=0,n=10

     2698    19082    2     CALL EDITXCHAR(CHR11,,,MOPS_7_2_STR,CHR10);

  19082  2 013205   100000 024500                    MVNE
         2 013206   202074 010012                    NDSC9   CHR10,,AUTO              cn=0,s=lsgns,sf=0,n=10
         2 013207   000521 000006 1                  ADSC9   MOPS_7_2_STR             cn=0,n=6
         2 013210   202077 000013                    ADSC9   CHR11,,AUTO              cn=0,n=11

     2699    19083    2     I = 0;

  19083  2 013211   202073 450100                    STZ     I,,AUTO

     2700    19084    3     DO WHILE (CHR11A(I) = ' ' AND I < SIZEC(CHR11));

  19084  2 013212   013214 710000 2                  TRA     s:19086

     2701    19085    3     I = I+1;

  19085  2 013213   202073 054100                    AOS     I,,AUTO

     2702    19086    3     END;

  19086  2 013214   202073 235100                    LDA     I,,AUTO
         2 013215   040000 106505                    CMPC    fill='040'O
         2 013216   202077 000001                    ADSC9   CHR11,A,AUTO             cn=0,n=1
         2 013217   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 013220   013223 601000 2                  TNZ     s:19087
         2 013221   000013 115007                    CMPA    11,DL
         2 013222   013213 604000 2                  TMI     s:19085

     2703    19087    2     CHR11 = SUBSTR(CHR11,I,SIZEC(CHR11)-I);

  19087  2 013223   777764 620005                    EAX0    -12,AL
         2 013224   777777 660003                    ERX0    -1,DU
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:433  
         2 013225   040100 100545                    MLR     fill='040'O
         2 013226   202077 000010                    ADSC9   CHR11,A,AUTO             cn=0,n=*X0
         2 013227   202077 000013                    ADSC9   CHR11,,AUTO              cn=0,n=11

     2704    19088    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(CHR11),SIZEC(CHR11))  ALTRET(DISPBUDGET50);

  19088  2 013230   202077 630500                    EPPR0   CHR11,,AUTO
         2 013231   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 013232   000126 236000 3                  LDQ     86
         2 013233   202357 756100                    STQ     CLSDCB+35,,AUTO
         2 013234   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 013235   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 013236   200035 633500                    EPPR3   DEST$,,AUTO
         2 013237   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 013240   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 013241   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 013242   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 013243   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 013244   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 013245   013276 702000 2                  TSX2    DISPBUDGET50

     2705    19089    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  19089  2 013246   000000 470400 xsym               LDP0    SEG2$
         2 013247   000165 471500                    LDP1    117,,PR0
         2 013250   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 013251   000020 772000                    QRL     16
         2 013252   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 013253   200035 236100                    LDQ     DEST$,,AUTO
         2 013254   000020 772000                    QRL     16
         2 013255   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 013256   000020 736000                    QLS     16
         2 013257   100004 676100                    ERQ     4,,PR1
         2 013260   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 013261   100004 656100                    ERSQ    4,,PR1

     2706    19090    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:434  

  19090  2 013262   000165 471500                    LDP1    117,,PR0
         2 013263   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 013264   100005 756100                    STQ     5,,PR1

     2707    19091    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$)  ALTRET(DISPBUDGET50);

  19091  2 013265   000000 236000 xsym               LDQ     SEG2$
         2 013266   000165 036003                    ADLQ    117,DU
         2 013267   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 013270   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 013271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 013272   000000 701000 xent               TSX1    CPE$LISTOUT
         2 013273   013276 702000 2                  TSX2    DISPBUDGET50

     2708    19092    2     RETURN;

  19092  2 013274   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 013275   000001 702211                    TSX2  ! 1,X1

  19090  2 013276                       DISPBUDGET50 null
     2709    19093    2   DISPBUDGET50:;
     2710    19094    2     ALTRETURN;

  19094  2 013276   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 013277   000000 702211                    TSX2  ! 0,X1

     2711    19095    2   END DISPBUDGET;
     2712    19096                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:435  
     2713    19097        /********************************************************************/
     2714    19098        /*I*   NAME:   DISPWSN
     2715    19099               PURPOSE: Display work station name of origin
     2716    19100               CALL:   CALL DISPWSN
     2717    19101               INTERFACE: CPB$BLDIMAGE,CPE$LISTOUT
     2718    19102               INPUT:  B$JIT.WOO
     2719    19103               OUTPUT: work station name of origin displayed
     2720    19104               DESCRIPTION: The work station name of origin is displayed.
     2721    19105        */
     2722    19106        /**********************************************************************/
     2723    19107    1   DISPWSN: PROC ALTRET;

  19107  2 013300   202072 741300       DISPWSN      STX1  ! VLP_SN+4,,AUTO

     2724    19108        /**/
     2725    19109        /**/
     2726    19110    2     OUTBUFF$ = ADDR(OUTBUFF);

  19110  2 013301   200237 630500                    EPPR0   OUTBUFF,,AUTO
         2 013302   200036 450500                    STP0    OUTBUFF$,,AUTO

     2727    19111    2     DEST$ = OUTBUFF$;

  19111  2 013303   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 013304   200035 756100                    STQ     DEST$,,AUTO

     2728    19112    2     OUTBUFF = '   WSN: ';

  19112  2 013305   040100 100400                    MLR     fill='040'O
         2 013306   001524 000010 1                  ADSC9   CONSTCLS+342             cn=0,n=8
         2 013307   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2729    19113    2     DEST$ = PINCRC(DEST$,SIZEC('   WSN: '));

  19113  2 013310   000002 036003                    ADLQ    2,DU
         2 013311   200035 756100                    STQ     DEST$,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:436  
     2730    19114    2     CALL INDEX(LEN,' ',B$JIT.WOO);

  19114  2 013312   000000 471400 xsym               LDP1    B$JIT$
         2 013313   000000 124500                    SCM     mask='000'O
         2 013314   100010 000010                    ADSC9   8,,PR1                   cn=0,n=8
         2 013315   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 013316   200476 000100                    ARG     LEN,,AUTO

     2731    19115    2     CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(B$JIT.WOO),LEN)  ALTRET(DISPWSN50);

  19115  2 013317   000000 236000 xsym               LDQ     B$JIT$
         2 013320   000010 036003                    ADLQ    8,DU
         2 013321   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 013322   200476 633500                    EPPR3   LEN,,AUTO
         2 013323   202357 453500                    STP3    CLSDCB+35,,AUTO
         2 013324   202352 634500                    EPPR4   CLSDCB+30,,AUTO
         2 013325   202356 454500                    STP4    CLSDCB+34,,AUTO
         2 013326   200035 635500                    EPPR5   DEST$,,AUTO
         2 013327   202355 455500                    STP5    CLSDCB+33,,AUTO
         2 013330   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 013331   202354 456500                    STP6    CLSDCB+32,,AUTO
         2 013332   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 013333   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 013334   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 013335   013366 702000 2                  TSX2    DISPWSN50

     2732    19116    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$);

  19116  2 013336   000000 470400 xsym               LDP0    SEG2$
         2 013337   000165 471500                    LDP1    117,,PR0
         2 013340   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 013341   000020 772000                    QRL     16
         2 013342   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 013343   200035 236100                    LDQ     DEST$,,AUTO
         2 013344   000020 772000                    QRL     16
         2 013345   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 013346   000020 736000                    QLS     16
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:437  
         2 013347   100004 676100                    ERQ     4,,PR1
         2 013350   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 013351   100004 656100                    ERSQ    4,,PR1

     2733    19117    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$;

  19117  2 013352   000165 471500                    LDP1    117,,PR0
         2 013353   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 013354   100005 756100                    STQ     5,,PR1

     2734    19118    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$)  ALTRET(DISPWSN50);

  19118  2 013355   000000 236000 xsym               LDQ     SEG2$
         2 013356   000165 036003                    ADLQ    117,DU
         2 013357   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 013360   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 013361   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 013362   000000 701000 xent               TSX1    CPE$LISTOUT
         2 013363   013366 702000 2                  TSX2    DISPWSN50

     2735    19119    2     RETURN;

  19119  2 013364   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 013365   000001 702211                    TSX2  ! 1,X1

     2736    19120    2   DISPWSN50:
     2737    19121    2     ALTRETURN;

  19121  2 013366   202072 221300       DISPWSN50    LDX1  ! VLP_SN+4,,AUTO
         2 013367   000000 702211                    TSX2  ! 0,X1

     2738    19122    2   END DISPWSN;
     2739    19123                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:438  
     2740    19124        /**********************************************************************/
     2741    19125        /*I*   NAME:   DISPLDEV
     2742    19126               PURPOSE: Display LDEV information for specific LDEVs.
     2743    19127               CALL:   CALL DISPLDEV
     2744    19128                       DISPLDEV
     2745    19129               INPUT:
     2746    19130               OUTPUT: LDEV information to the listing device
     2747    19131               DESCRIPTION: IBEX determines what type of device to report about.
     2748    19132                       Then searches for a DCB with that device type.  Calls M$LDEV
     2749    19133                       to get the information and outputs to the listing device.
     2750    19134        */
     2751    19135        /***********************************************************************/
     2752    19136    1   DISPLDEV: PROC ALTRET ;

  19136  2 013370   202072 741300       DISPLDEV     STX1  ! VLP_SN+4,,AUTO

     2753    19137    2   DCL I UBIN WORD ;
     2754    19138    2   DCL J UBIN WORD ;
     2755    19139    2   DCL N UBIN ;
     2756    19140    2   DCL TEMP2$ PTR ;
     2757    19141    2   DCL OPT CHAR(4) ;
     2758    19142    2   DCL OPTLEN UBIN WORD ;
     2759    19143        /**/
     2760    19144    2           LDEVS_HDR_PRINTED = %NO# ;

  19144  2 013371   200022 450100                    STZ     LDEVS_HDR_PRINTED,,AUTO

     2761    19145    2           OUTBUFF$ = ADDR(OUTBUFF) ;

  19145  2 013372   200237 630500                    EPPR0   OUTBUFF,,AUTO
         2 013373   200036 450500                    STP0    OUTBUFF$,,AUTO

     2762    19146    3           DO CASE(TEMP$->P$B.CODE) ;

  19146  2 013374   200011 471500                    LDP1    TEMP$,,AUTO
         2 013375   100000 720100                    LXL0    0,,PR1
         2 013376   000036 100003                    CMPX0   30,DU
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:439  
         2 013377   013401 602010 2                  TNC     s:19146+5,X0
         2 013400   013462 710000 2                  TRA     s:19164
         2 013401   013462 710000 2                  TRA     s:19164
         2 013402   013437 710000 2                  TRA     s:19149
         2 013403   013462 710000 2                  TRA     s:19164
         2 013404   013462 710000 2                  TRA     s:19164
         2 013405   013462 710000 2                  TRA     s:19164
         2 013406   013462 710000 2                  TRA     s:19164
         2 013407   013462 710000 2                  TRA     s:19164
         2 013410   013462 710000 2                  TRA     s:19164
         2 013411   013462 710000 2                  TRA     s:19164
         2 013412   013462 710000 2                  TRA     s:19164
         2 013413   013462 710000 2                  TRA     s:19164
         2 013414   013462 710000 2                  TRA     s:19164
         2 013415   013462 710000 2                  TRA     s:19164
         2 013416   013462 710000 2                  TRA     s:19164
         2 013417   013462 710000 2                  TRA     s:19164
         2 013420   013462 710000 2                  TRA     s:19164
         2 013421   013462 710000 2                  TRA     s:19164
         2 013422   013462 710000 2                  TRA     s:19164
         2 013423   013462 710000 2                  TRA     s:19164
         2 013424   013462 710000 2                  TRA     s:19164
         2 013425   013462 710000 2                  TRA     s:19164
         2 013426   013462 710000 2                  TRA     s:19164
         2 013427   013462 710000 2                  TRA     s:19164
         2 013430   013462 710000 2                  TRA     s:19164
         2 013431   013462 710000 2                  TRA     s:19164
         2 013432   013462 710000 2                  TRA     s:19164
         2 013433   013462 710000 2                  TRA     s:19164
         2 013434   013462 710000 2                  TRA     s:19164
         2 013435   013445 710000 2                  TRA     s:19154
         2 013436   013456 710000 2                  TRA     s:19159

     2763    19147
     2764    19148    3             CASE(DALLOPT) ;

     2765    19149    3               DILDEV_OPT = %YES# ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:440  

  19149  2 013437   400000 236003                    LDQ     -131072,DU
         2 013440   200023 756100                    STQ     DILDEV_OPT,,AUTO

     2766    19150    3               OPT=' ' ;

  19150  2 013441   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 013442   202077 756100                    STQ     OPT,,AUTO

     2767    19151    3               OPTLEN = 0 ;

  19151  2 013443   202100 450100                    STZ     OPTLEN,,AUTO
         2 013444   013462 710000 2                  TRA     s:19164

     2768    19152
     2769    19153    3             CASE(%DLDEVOPT#) ;

     2770    19154    3               DILDEV_OPT = %YES# ;

  19154  2 013445   400000 236003                    LDQ     -131072,DU
         2 013446   200023 756100                    STQ     DILDEV_OPT,,AUTO

     2771    19155    3               OPT='LP' ;

  19155  2 013447   001526 236000 1                  LDQ     CONSTCLS+344
         2 013450   777777 376003                    ANQ     -1,DU
         2 013451   040040 276007                    ORQ     16416,DL
         2 013452   202077 756100                    STQ     OPT,,AUTO

     2772    19156    3               OPTLEN=2 ;

  19156  2 013453   000002 235007                    LDA     2,DL
         2 013454   202100 755100                    STA     OPTLEN,,AUTO
         2 013455   013462 710000 2                  TRA     s:19164

     2773    19157
     2774    19158    3             CASE(%DLDEVSOPT#) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:441  

     2775    19159    3               DILDEV_OPT = %NO# ;

  19159  2 013456   200023 450100                    STZ     DILDEV_OPT,,AUTO

     2776    19160    3               OPT=' ' ;

  19160  2 013457   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 013460   202077 756100                    STQ     OPT,,AUTO

     2777    19161    3               OPTLEN = 0 ;

  19161  2 013461   202100 450100                    STZ     OPTLEN,,AUTO

     2778    19162
     2779    19163    3           END ; /* Do Case */

     2780    19164    2           IN$ = ADDR(INBUFF) ;

  19164  2 013462   200037 633500                    EPPR3   INBUFF,,AUTO
         2 013463   200034 453500                    STP3    IN$,,AUTO

     2781    19165    2           DCBSLOT = M$IBEX1_NUM ;

  19165  2 013464   000000 235000 xsym               LDA     M$IBEX1_NUM
         2 013465   200016 755100                    STA     DCBSLOT,,AUTO

     2782    19166
     2783    19167    2           IF TEMP$->P$B.NSUBLKS = 0

  19167  2 013466   100001 220100                    LDX0    1,,PR1
         2 013467   013510 601000 2                  TNZ     s:19178

     2784    19168    2             THEN
     2785    19169    3               DO ;

     2786    19170    3                 N = 0 ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:442  

  19170  2 013470   202075 450100                    STZ     N,,AUTO

     2787    19171    3                 OUTBUFF = ' ' ;

  19171  2 013471   040100 100400                    MLR     fill='040'O
         2 013472   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 013473   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2788    19172    3                 LDEVS_EXIST = %NO# ;

  19172  2 013474   200021 450100                    STZ     LDEVS_EXIST,,AUTO

     2789    19173    3                 DEST$ = OUTBUFF$ ;

  19173  2 013475   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 013476   200035 756100                    STQ     DEST$,,AUTO

     2790    19174    3                 CALL FIND_ALL_LDEVS(N,OPT,OPTLEN) ALTRET(DISPLDEV_ERR) ;

  19174  2 013477   202100 634500                    EPPR4   OPTLEN,,AUTO
         2 013500   202105 454500                    STP4    DCB$+1,,AUTO
         2 013501   202077 635500                    EPPR5   OPT,,AUTO
         2 013502   202104 455500                    STP5    DCBTAB$+1,,AUTO
         2 013503   202075 636500                    EPPR6   N,,AUTO
         2 013504   202103 456500                    STP6    IGNORE_CREATE_FLG+1,,AUTO
         2 013505   015412 701000 2                  TSX1    FIND_ALL_LDEVS
         2 013506   013634 702000 2                  TSX2    DISPLDEV_ERR

     2791    19175    3                 GOTO DISPLDEV_RET ;

  19175  2 013507   013632 710000 2                  TRA     DISPLDEV_RET

     2792    19176    3               END ; /* Then Do */
     2793    19177
     2794    19178    3           DO I=0 TO TEMP$->P$B.NSUBLKS-1 ;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:443  
  19178  2 013510   202073 450100                    STZ     I,,AUTO
         2 013511   013624 710000 2                  TRA     s:19205+3

     2795    19179    4             DO CASE(TEMP$->P$B.SUBLK$(I)->P$B.CODE) ;

  19179  2 013512   200011 470500                    LDP0    TEMP$,,AUTO
         2 013513   202073 720100                    LXL0    I,,AUTO
         2 013514   000003 471510                    LDP1    3,X0,PR0
         2 013515   100000 721100                    LXL1    0,,PR1
         2 013516   000003 101003                    CMPX1   3,DU
         2 013517   013521 602011 2                  TNC     s:19179+7,X1
         2 013520   013604 710000 2                  TRA     s:19200
         2 013521   013604 710000 2                  TRA     s:19200
         2 013522   013524 710000 2                  TRA     s:19182
         2 013523   013530 710000 2                  TRA     s:19186

     2796    19180
     2797    19181    4               CASE(%LDEV_ALL#) ;

     2798    19182    4                 OPT=' ' ;

  19182  2 013524   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 013525   202077 756100                    STQ     OPT,,AUTO

     2799    19183    4                 OPTLEN = 0 ;

  19183  2 013526   202100 450100                    STZ     OPTLEN,,AUTO
         2 013527   013604 710000 2                  TRA     s:19200

     2800    19184
     2801    19185    4               CASE(%LDEV_STRM#) ;

     2802    19186    5                 DO J = 0 TO TEMP$->P$B.SUBLK$(I)->P$B.NSUBLKS-1 ;

  19186  2 013530   202074 450100                    STZ     J,,AUTO
         2 013531   013576 710000 2                  TRA     s:19198+3

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:444  
     2803    19187    5                   TEMP2$ = TEMP$->P$B.SUBLK$(I)->P$B.SUBLK$(J) ;

  19187  2 013532   200011 470500                    LDP0    TEMP$,,AUTO
         2 013533   202073 720100                    LXL0    I,,AUTO
         2 013534   000003 471510                    LDP1    3,X0,PR0
         2 013535   202074 721100                    LXL1    J,,AUTO
         2 013536   100003 236111                    LDQ     3,X1,PR1
         2 013537   202076 756100                    STQ     TEMP2$,,AUTO

     2804    19188    6                   DO CASE(TEMP2$->P$B.CODE) ;

  19188  2 013540   202076 473500                    LDP3    TEMP2$,,AUTO
         2 013541   300000 722100                    LXL2    0,,PR3
         2 013542   000005 102003                    CMPX2   5,DU
         2 013543   013545 602012 2                  TNC     s:19188+5,X2
         2 013544   013573 710000 2                  TRA     s:19198
         2 013545   013573 710000 2                  TRA     s:19198
         2 013546   013573 710000 2                  TRA     s:19198
         2 013547   013573 710000 2                  TRA     s:19198
         2 013550   013552 710000 2                  TRA     s:19191
         2 013551   013563 710000 2                  TRA     s:19195

     2805    19189
     2806    19190    6                     CASE(%LDEV_STRM_NAME#) ;

     2807    19191    6                       OPT = TEMP2$->P$S.TEXT ;

  19191  2 013552   300004 236100                    LDQ     4,,PR3
         2 013553   000033 772000                    QRL     27
         2 013554   000000 623006                    EAX3    0,QL
         2 013555   040100 100540                    MLR     fill='040'O
         2 013556   300004 200013                    ADSC9   4,,PR3                   cn=1,n=*X3
         2 013557   202077 000004                    ADSC9   OPT,,AUTO                cn=0,n=4

     2808    19192    6                       OPTLEN = 2 ;

  19192  2 013560   000002 235007                    LDA     2,DL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:445  
         2 013561   202100 755100                    STA     OPTLEN,,AUTO
         2 013562   013573 710000 2                  TRA     s:19198

     2809    19193
     2810    19194    6                     CASE(%LDEV_STRM_NUM#) ;

     2811    19195    6                       SUBSTR(OPT,2,2)=TEMP2$->P$S.TEXT ;

  19195  2 013563   300004 236100                    LDQ     4,,PR3
         2 013564   000033 772000                    QRL     27
         2 013565   000000 623006                    EAX3    0,QL
         2 013566   040100 100540                    MLR     fill='040'O
         2 013567   300004 200013                    ADSC9   4,,PR3                   cn=1,n=*X3
         2 013570   202077 400002                    ADSC9   OPT,,AUTO                cn=2,n=2

     2812    19196    6                       OPTLEN = 4 ;

  19196  2 013571   000004 235007                    LDA     4,DL
         2 013572   202100 755100                    STA     OPTLEN,,AUTO

     2813    19197    6                   END ; /* Do Case */

     2814    19198    5                 END ; /* Do J */

  19198  2 013573   202074 235100                    LDA     J,,AUTO
         2 013574   000001 035007                    ADLA    1,DL
         2 013575   202074 755100                    STA     J,,AUTO
         2 013576   000003 471510                    LDP1    3,X0,PR0
         2 013577   100001 236100                    LDQ     1,,PR1
         2 013600   000022 772000                    QRL     18
         2 013601   202074 116100                    CMPQ    J,,AUTO
         2 013602   013604 600000 2                  TZE     s:19200
         2 013603   013532 603000 2                  TRC     s:19187

     2815    19199    4             END ; /* Do Case */

     2816    19200    3             OUTBUFF = ' ' ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:446  

  19200  2 013604   040100 100400                    MLR     fill='040'O
         2 013605   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 013606   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2817    19201    3             N = 0 ;

  19201  2 013607   202075 450100                    STZ     N,,AUTO

     2818    19202    3             LDEVS_EXIST = %NO# ;

  19202  2 013610   200021 450100                    STZ     LDEVS_EXIST,,AUTO

     2819    19203        /**/
     2820    19204    3             CALL FIND_ALL_LDEVS(N,OPT,OPTLEN) ALTRET(DISPLDEV_ERR) ;

  19204  2 013611   202100 631500                    EPPR1   OPTLEN,,AUTO
         2 013612   202105 451500                    STP1    DCB$+1,,AUTO
         2 013613   202077 633500                    EPPR3   OPT,,AUTO
         2 013614   202104 453500                    STP3    DCBTAB$+1,,AUTO
         2 013615   202075 634500                    EPPR4   N,,AUTO
         2 013616   202103 454500                    STP4    IGNORE_CREATE_FLG+1,,AUTO
         2 013617   015412 701000 2                  TSX1    FIND_ALL_LDEVS
         2 013620   013634 702000 2                  TSX2    DISPLDEV_ERR

     2821    19205    3         END ; /* Do I */

  19205  2 013621   202073 235100                    LDA     I,,AUTO
         2 013622   000001 035007                    ADLA    1,DL
         2 013623   202073 755100                    STA     I,,AUTO
         2 013624   200011 470500                    LDP0    TEMP$,,AUTO
         2 013625   000001 236100                    LDQ     1,,PR0
         2 013626   000022 772000                    QRL     18
         2 013627   202073 116100                    CMPQ    I,,AUTO
         2 013630   013632 600000 2                  TZE     DISPLDEV_RET
         2 013631   013512 603000 2                  TRC     s:19179

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:447  
     2822    19206
     2823    19207    2   DISPLDEV_RET:
     2824    19208    2         RETURN ;

  19208  2 013632   202072 221300       DISPLDEV_RET LDX1  ! VLP_SN+4,,AUTO
         2 013633   000001 702211                    TSX2  ! 1,X1

     2825    19209
     2826    19210    2   DISPLDEV_ERR:
     2827    19211    2         ALTRETURN ;

  19211  2 013634   202072 221300       DISPLDEV_ERR LDX1  ! VLP_SN+4,,AUTO
         2 013635   000000 702211                    TSX2  ! 0,X1

     2828    19212
     2829    19213    2   END DISPLDEV;
     2830    19214        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:448  
     2831    19215    1   DILDEV: PROC(N,OPT,OPTLEN)ALTRET;

  19215  2 013636   202110 741300       DILDEV       STX1  ! OPNDCB+2,,AUTO

     2832    19216    2   DCL N SBIN;         /* N is LDEV index #. Set to 0 by caller on first call.*/
     2833    19217    2   DCL OPT CHAR(4);
     2834    19218    2   DCL OPTLEN UBIN;
     2835    19219                                                /* ALTRET if no more to print.*/
     2836    19220        /*****     REFERENCES     *****/
     2837    19221        %CODE16;
     2838    19229    2   DCL B$ROS$ PTR SYMREF;
     2839    19230        /*****     AUTOMATIC (NON-FPT)     *****/
     2840    19231    2   DCL DCB$ PTR;
     2841    19232    2   DCL FORM$ PTR;
     2842    19233    2   DCL COUNTER1 CHAR(12);
     2843    19234    2   DCL COUNTER2 CHAR(12);
     2844    19235    2   DCL IND2 UBIN;
     2845    19236    2   DCL TEMP UBIN ;
     2846    19237    2   DCL UC_FLG BIT(1) ;
     2847    19238    2   DCL STREAM UBIN ;
     2848    19239    2   DCL OPEN BIT(1) ;
     2849    19240    2   DCL LEN SBIN ;
     2850    19241    2   DCL OPT_TBLSZE SBIN WORD CONSTANT INIT(5);
     2851    19242    2   DCL 1 OPT_TBL(0:4) CONSTANT ALIGNED,    /*DCB DISPLAY OPTION TABLE*/
     2852    19243    2         2 LEN UBIN BYTE UNAL INIT
     2853    19244    2           (7,7,7,7,8),
     2854    19245    2         2 HDR CHAR(10) UNAL INIT
     2855    19246    2           ('Topbrdr','Btmbrdr','Lftbrdr','Rhtbrdr','Optional'),
     2856    19247    2         2 OPTION UBIN BYTE UNAL INIT
     2857    19248    2            (TOPBRDROPT,BTMBRDROPT,LFTBRDROPT,RHTBRDROPT,OPTIONALOPT) ;
     2858    19249        /*****     FPT'S     *****/
     2859    19250        %FPT_OPEN(FPTN=OPNMYDCB,STCLASS=);
     2860    19359        %FPT_OPEN(FPTN=CONSTOPN,STCLASS=CONSTANT,ASN=DEVICE,FUN=CREATE);
     2861    19468        %FPT_CLOSE(FPTN=CLSMYDCB,STCLASS=);
     2862    19510        %FPT_CLOSE(FPTN=CONSTCLS,STCLASS=CONSTANT,DISP=SAVE);
     2863    19552        %FPT_TRMCTL(FPTN=FPT_TRMCTL, STCLASS="") ;
     2864    19579        %FPT_TRMCTL(FPTN=CFPT_TRMCTL, STCLASS=CONSTANT) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:449  
     2865    19606        %VLP_WINDOW(FPTN=VLP_WINDOW,STCLASS="") ;
     2866    19650        %VLP_HDR (FPTN=VLP$HDR, LEN="VLP$HDR.TITL.L#", STCLASS=BASED) ;
     2867    19666        /*****     *****     *****     *****     *****     *****     *****/
     2868    19667    2   BEGIN:
     2869    19668    2           IF N<0 OR N>15 THEN ALTRETURN;

  19668  2 013637   202111 470500       BEGIN        LDP0    @N,,AUTO
         2 013640   000000 235100                    LDA     0,,PR0
         2 013641   013644 604000 2                  TMI     s:19668
         2 013642   000017 115007                    CMPA    15,DL
         2 013643   013646 604400 2                  TMOZ    s:19669

  19668  2 013644   202110 221300                    LDX1  ! OPNDCB+2,,AUTO
         2 013645   000000 702211                    TSX2  ! 0,X1

     2870    19669    3           DO WHILE (B$ROS$->B$ROSEG.LDEVNAME(N)=' ' OR

  19669  2 013646   013656 710000 2                  TRA     s:19672

     2871    19670    3             B$ROS$->B$ROSEG.STREAMID.FLG(N)=0);
     2872    19671    3              N=N+1; IF N>15 THEN ALTRETURN;

  19671  2 013647   202111 470500                    LDP0    @N,,AUTO
         2 013650   000000 054100                    AOS     0,,PR0

  19671  2 013651   000000 235100                    LDA     0,,PR0
         2 013652   000017 115007                    CMPA    15,DL
         2 013653   013656 604400 2                  TMOZ    s:19672

  19671  2 013654   202110 221300                    LDX1  ! OPNDCB+2,,AUTO
         2 013655   000000 702211                    TSX2  ! 0,X1

     2873    19672    3              END;

  19672  2 013656   000000 471400 xsym               LDP1    B$ROS$
         2 013657   100054 236105                    LDQ     44,AL,PR1
         2 013660   000035 116000 xsym               CMPQ    B_VECTNIL+29
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:450  
         2 013661   013647 600000 2                  TZE     s:19671
         2 013662   000000 235100                    LDA     0,,PR0
         2 013663   100074 236105                    LDQ     60,AL,PR1
         2 013664   600000 316003                    CANQ    -65536,DU
         2 013665   013647 600000 2                  TZE     s:19671

     2874    19673    2           IF B$ROS$->B$ROSEG.STREAMID.UC_STR(N)

  19673  2 013666   000000 235100                    LDA     0,,PR0
         2 013667   100074 236105                    LDQ     60,AL,PR1
         2 013670   000001 316003                    CANQ    1,DU
         2 013671   013675 600000 2                  TZE     s:19677

     2875    19674    2           THEN
     2876    19675    2              UC_FLG = %YES# ;

  19675  2 013672   400000 236003                    LDQ     -131072,DU
         2 013673   202126 756100                    STQ     UC_FLG,,AUTO
         2 013674   013676 710000 2                  TRA     s:19678

     2877    19676    2           ELSE
     2878    19677    2              UC_FLG = %NO# ;

  19677  2 013675   202126 450100                    STZ     UC_FLG,,AUTO

     2879    19678    2           IF SUBSTR(B$ROS$->B$ROSEG.LDEVNAME(N),0,OPTLEN)=

  19678  2 013676   000000 235100                    LDA     0,,PR0
         2 013677   202113 473500                    LDP3    @OPTLEN,,AUTO
         2 013700   300000 720100                    LXL0    0,,PR3
         2 013701   300000 721100                    LXL1    0,,PR3
         2 013702   000002 735000                    ALS     2
         2 013703   202112 474500                    LDP4    @OPT,,AUTO
         2 013704   040140 106545                    CMPC    fill='040'O
         2 013705   100054 000010                    ADSC9   44,A,PR1                 cn=0,n=*X0
         2 013706   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         2 013707   013727 601000 2                  TNZ     s:19693
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:451  

     2880    19679    2             SUBSTR(OPT,0,OPTLEN)
     2881    19680    2           THEN
     2882    19681    2              IF UC_FLG

  19681  2 013710   202126 234100                    SZN     UC_FLG,,AUTO
         2 013711   013725 605000 2                  TPL     s:19692

     2883    19682    2              THEN
     2884    19683    3              DO ;

     2885    19684    3                 STREAM = N ;

  19684  2 013712   000000 235100                    LDA     0,,PR0
         2 013713   202127 755100                    STA     STREAM,,AUTO

     2886    19685    4                 CALL DISPLAY_WINDOW_OPTS WHENALTRETURN DO ;

  19685  2 013714   014364 701000 2                  TSX1    DISPLAY_WINDOW_OPTS
         2 013715   013717 702000 2                  TSX2    s:19686
         2 013716   013724 710000 2                  TRA     s:19690

     2887    19686    4                    N = N + 1 ;

  19686  2 013717   202111 470500                    LDP0    @N,,AUTO
         2 013720   000000 054100                    AOS     0,,PR0

     2888    19687    4                    CALL CLOSEMYDCB ;

  19687  2 013721   015337 701000 2                  TSX1    CLOSEMYDCB
         2 013722   000000 011000                    NOP     0

     2889    19688    4                    GOTO BEGIN ;

  19688  2 013723   013637 710000 2                  TRA     BEGIN

     2890    19689    4                    END ;                  /* Whenaltreturn Do                   */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:452  
     2891    19690    3                 END ;                     /* Then Do                            */

  19690  2 013724   013727 710000 2                  TRA     s:19693

     2892    19691    2              ELSE
     2893    19692    2                 CALL DISPLAY_NORMAL_LDEV ALTRET(ALTRETUR) ;

  19692  2 013725   013741 701000 2                  TSX1    DISPLAY_NORMAL_LDEV
         2 013726   013735 702000 2                  TSX2    ALTRETUR

     2894    19693    2           CALL CLOSEMYDCB ;

  19693  2 013727   015337 701000 2                  TSX1    CLOSEMYDCB
         2 013730   000000 011000                    NOP     0

     2895    19694    2           N=N+1;

  19694  2 013731   202111 470500                    LDP0    @N,,AUTO
         2 013732   000000 054100                    AOS     0,,PR0

     2896    19695    2           RETURN;

  19695  2 013733   202110 221300                    LDX1  ! OPNDCB+2,,AUTO
         2 013734   000001 702211                    TSX2  ! 1,X1

     2897    19696    2   ALTRETUR:
     2898    19697    2             CALL CLOSEMYDCB ;

  19697  2 013735   015337 701000 2     ALTRETUR     TSX1    CLOSEMYDCB
         2 013736   000000 011000                    NOP     0

     2899    19698    2             ALTRETURN ;

  19698  2 013737   202110 221300                    LDX1  ! OPNDCB+2,,AUTO
         2 013740   000000 702211                    TSX2  ! 0,X1

     2900    19699        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:453  
     2901    19700    2   DISPLAY_NORMAL_LDEV: PROC ALTRET ;

  19700  2 013741   202302 741300       DISPLAY_NOR* STX1  ! VLP_WINDOW+8,,AUTO

     2902    19701
     2903    19702    3   DCL SIZ UBIN WORD ;
     2904    19703
     2905    19704    3           IF DCBADDR(DCBSLOT)->F$DCB.FCD#

  19704  2 013742   000102 470400 3                  LDP0    66
         2 013743   000000 471500                    LDP1    0,,PR0
         2 013744   200016 720100                    LXL0    DCBSLOT,,AUTO
         2 013745   100000 473510                    LDP3    0,X0,PR1
         2 013746   300031 236100                    LDQ     25,,PR3
         2 013747   020000 316007                    CANQ    8192,DL
         2 013750   013753 600000 2                  TZE     s:19707

     2906    19705    3             THEN
     2907    19706    3               CALL CLOSEMYDCB ;

  19706  2 013751   015337 701000 2                  TSX1    CLOSEMYDCB
         2 013752   000000 011000                    NOP     0

     2908    19707    3           OPNMYDCB=CONSTOPN;

  19707  2 013753   000100 100400                    MLR     fill='000'O
         2 013754   000544 000350 1                  ADSC9   CONSTOPN                 cn=0,n=232
         2 013755   202132 000350                    ADSC9   OPNMYDCB,,AUTO           cn=0,n=232

     2909    19708    3           OPNMYDCB.V.DCB#=DCBSLOT;

  19708  2 013756   200016 720100                    LXL0    DCBSLOT,,AUTO
         2 013757   202176 740100                    STX0    I+34,,AUTO

     2910    19709    3           OPNMYDCB.V.RES#=B$ROS$->B$ROSEG.LDEVNAME(N);

  19709  2 013760   202111 470500                    LDP0    @N,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:454  
         2 013761   000000 235100                    LDA     0,,PR0
         2 013762   000000 471400 xsym               LDP1    B$ROS$
         2 013763   100054 236105                    LDQ     44,AL,PR1
         2 013764   202202 756100                    STQ     I+38,,AUTO

     2911    19710    3           OPNMYDCB.V_=VECTOR(OPNMYDCB.V);

  19710  2 013765   000064 235000 3                  LDA     52
         2 013766   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 013767   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 013770   002176 036003                    ADLQ    1150,DU
         2 013771   202132 757100                    STAQ    OPNMYDCB,,AUTO

     2912    19711    3           CALL M$OPEN(OPNMYDCB)ALTRET(DISPLAY_ALTRET);

  19711  2 013772   202132 630500                    EPPR0   OPNMYDCB,,AUTO
         2 013773   450000 713400                    CLIMB   alt,open
         2 013774   410400 401760                    pmme    nvectors=18
         2 013775   014362 702000 2                  TSX2    DISPLAY_ALTRET

     2913    19712    3           OPEN = %YES# ;

  19712  2 013776   400000 236003                    LDQ     -131072,DU
         2 013777   202130 756100                    STQ     OPEN,,AUTO

     2914    19713    3           DCB$=DCBADDR(DCBSLOT)->F$DCB.CFU$;

  19713  2 014000   000102 470400 3                  LDP0    66
         2 014001   000000 471500                    LDP1    0,,PR0
         2 014002   200016 720100                    LXL0    DCBSLOT,,AUTO
         2 014003   100000 473510                    LDP3    0,X0,PR1
         2 014004   300066 236100                    LDQ     54,,PR3
         2 014005   202114 756100                    STQ     DCB$,,AUTO

     2915    19714    3           FORM$=DCB$->F$DCB.FORM$;

  19714  2 014006   202114 474500                    LDP4    DCB$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:455  
         2 014007   400050 236100                    LDQ     40,,PR4
         2 014010   202115 756100                    STQ     FORM$,,AUTO

     2916    19715    3           IF LDEVS_HDR_PRINTED = %NO#

  19715  2 014011   200022 234100                    SZN     LDEVS_HDR_PRINTED,,AUTO
         2 014012   014030 604000 2                  TMI     s:19722

     2917    19716    3             THEN
     2918    19717    4               DO ;

     2919    19718    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_ = VECTOR(LDEVHDR) ;

  19718  2 014013   000000 475400 xsym               LDP5    SEG2$
         2 014014   500165 476500                    LDP6    117,,PR5
         2 014015   000366 237000 3                  LDAQ    246
         2 014016   600004 757100                    STAQ    4,,PR6

     2920    19719    4                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPLAY_ALTRET) ;

  19719  2 014017   000000 236000 xsym               LDQ     SEG2$
         2 014020   000165 036003                    ADLQ    117,DU
         2 014021   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 014022   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014023   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 014024   000000 701000 xent               TSX1    CPE$LISTOUT
         2 014025   014362 702000 2                  TSX2    DISPLAY_ALTRET

     2921    19720    4                 LDEVS_HDR_PRINTED = %YES# ;

  19720  2 014026   400000 236003                    LDQ     -131072,DU
         2 014027   200022 756100                    STQ     LDEVS_HDR_PRINTED,,AUTO

     2922    19721    4               END ; /* Then Do */

     2923    19722    3           IF LDEVS_EXIST = %NO#

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:456  
  19722  2 014030   200021 234100                    SZN     LDEVS_EXIST,,AUTO
         2 014031   014034 604000 2                  TMI     s:19725

     2924    19723    3             THEN
     2925    19724    3               LDEVS_EXIST = %YES# ;

  19724  2 014032   400000 236003                    LDQ     -131072,DU
         2 014033   200021 756100                    STQ     LDEVS_EXIST,,AUTO

     2926    19725    3           IF DILDEV_OPT

  19725  2 014034   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 014035   014047 605000 2                  TPL     s:19735

     2927    19726    3             THEN
     2928    19727    4               DO ;

     2929    19728    4                 OUTBUFF=' ';

  19728  2 014036   040100 100400                    MLR     fill='040'O
         2 014037   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 014040   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     2930    19729    4                 DEST$ = OUTBUFF$ ;

  19729  2 014041   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 014042   200035 756100                    STQ     DEST$,,AUTO

     2931    19730    4                 TAB_VAL = 22 ;

  19730  2 014043   000026 235007                    LDA     22,DL
         2 014044   200474 755100                    STA     TAB_VAL,,AUTO

     2932    19731    4                 SIZ = TAB_VAL ;

  19731  2 014045   202303 755100                    STA     SIZ,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:457  
     2933    19732    4               END ; /* Then Do */

  19732  2 014046   014053 710000 2                  TRA     s:19738

     2934    19733    3             ELSE
     2935    19734    4               DO ;

     2936    19735    4                 TAB_VAL = 5 ;

  19735  2 014047   000005 235007                    LDA     5,DL
         2 014050   200474 755100                    STA     TAB_VAL,,AUTO

     2937    19736    4                 SIZ = 10 ;

  19736  2 014051   000012 236007                    LDQ     10,DL
         2 014052   202303 756100                    STQ     SIZ,,AUTO

     2938    19737    4               END ; /* Else Do */

     2939    19738    3           CALL CONCAT(INBUFF,'     ',B$ROS$->B$ROSEG.LDEVNAME(N),

  19738  2 014053   202111 470500                    LDP0    @N,,AUTO
         2 014054   000000 235100                    LDA     0,,PR0
         2 014055   040100 100400                    MLR     fill='040'O
         2 014056   001505 000005 1                  ADSC9   CONSTCLS+327             cn=0,n=5
         2 014057   200037 000005                    ADSC9   INBUFF,,AUTO             cn=0,n=5
         2 014060   000002 735000                    ALS     2
         2 014061   000000 471400 xsym               LDP1    B$ROS$
         2 014062   040100 100505                    MLR     fill='040'O
         2 014063   100054 000004                    ADSC9   44,A,PR1                 cn=0,n=4
         2 014064   200040 200004                    ADSC9   INBUFF+1,,AUTO           cn=1,n=4
         2 014065   000040 236003                    LDQ     32,DU
         2 014066   200041 552120                    STBQ    INBUFF+2,'20'O,AUTO
         2 014067   202114 473500                    LDP3    DCB$,,AUTO
         2 014070   300026 220100                    LDX0    22,,PR3
         2 014071   200041 440100                    SXL0    INBUFF+2,,AUTO
         2 014072   100000 236003                    LDQ     32768,DU
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:458  
         2 014073   200042 756100                    STQ     INBUFF+3,,AUTO
         2 014074   040100 100500                    MLR     fill='040'O
         2 014075   300027 000010                    ADSC9   23,,PR3                  cn=0,n=8
         2 014076   200042 200763                    ADSC9   INBUFF+3,,AUTO           cn=1,n=499

     2940    19739    3             ' ',SUBSTR(DCB$->F$DCB.RES#,0,2),'@',DCB$->F$DCB.WSN#);
     2941    19740    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, SIZ) ALTRET(DISPLAY_ALTRET) ;

  19740  2 014077   202303 630500                    EPPR0   SIZ,,AUTO
         2 014100   202355 450500                    STP0    CLSDCB+33,,AUTO
         2 014101   200034 631500                    EPPR1   IN$,,AUTO
         2 014102   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 014103   200035 633500                    EPPR3   DEST$,,AUTO
         2 014104   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 014105   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 014106   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 014107   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014110   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 014111   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 014112   014362 702000 2                  TSX2    DISPLAY_ALTRET

     2942    19741    3           IF NOT DILDEV_OPT

  19741  2 014113   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 014114   014360 605000 2                  TPL     DISPLAY_RETURN

     2943    19742    3             THEN
     2944    19743    3               GOTO DISPLAY_RETURN ;
     2945    19744    3           CALL CONCAT(INBUFF,'Form=',FORM$->CODE16.FORM) ;

  19744  2 014115   040100 100400                    MLR     fill='040'O
         2 014116   001527 000005 1                  ADSC9   CONSTCLS+345             cn=0,n=5
         2 014117   200037 000005                    ADSC9   INBUFF,,AUTO             cn=0,n=5
         2 014120   202115 470500                    LDP0    FORM$,,AUTO
         2 014121   040100 100500                    MLR     fill='040'O
         2 014122   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         2 014123   200040 200773                    ADSC9   INBUFF+1,,AUTO           cn=1,n=507
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:459  

     2946    19745    3           CALL SEARCHR(IND1, TEMP, SRCHTBL, FORM$->CODE16.FORM) ;

  19745  2 014124   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
         2 014125   202115 471500                    LDP1    FORM$,,AUTO
         2 014126   000000 165500                    TCTR
         2 014127   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         2 014130   000000 000100                    ARG     0,,PR0
         2 014131   200015 000100                    ARG     IND1,,AUTO
         2 014132   200015 235100                    LDA     IND1,,AUTO
         2 014133   000033 771000                    ARL     27
         2 014134   202125 755100                    STA     TEMP,,AUTO
         2 014135   200015 551140                    STBA    IND1,'40'O,AUTO
         2 014136   014141 606400 2                  TTN     s:19746
         2 014137   000005 236007                    LDQ     5,DL
         2 014140   200015 156100                    SSQ     IND1,,AUTO

     2947    19746    3           CALL INSERT(INBUFF, IND1+6, 1, ',') ;

  19746  2 014141   200015 236100                    LDQ     IND1,,AUTO
         2 014142   040106 100400                    MLR     fill='040'O
         2 014143   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 014144   200040 400001                    ADSC9   INBUFF+1,Q,AUTO          cn=2,n=1

     2948    19747    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 12)

  19747  2 014145   000370 236000 3                  LDQ     248
         2 014146   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 014147   200034 633500                    EPPR3   IN$,,AUTO
         2 014150   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 014151   200035 634500                    EPPR4   DEST$,,AUTO
         2 014152   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 014153   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 014154   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 014155   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014156   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 014157   000000 701000 xent               TSX1    CPB$BLDIMAGE
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:460  
         2 014160   014362 702000 2                  TSX2    DISPLAY_ALTRET

     2949    19748    3             ALTRET(DISPLAY_ALTRET) ;
     2950    19749    3           IND1 = FORM$->CODE16.PAGENO ;

  19749  2 014161   202115 470500                    LDP0    FORM$,,AUTO
         2 014162   000005 236100                    LDQ     5,,PR0
         2 014163   000022 772000                    QRL     18
         2 014164   200015 756100                    STQ     IND1,,AUTO

     2951    19750    3           IF IND1 ~= 0 OR FORM$ -> CODE16.LINENO ~= 0

  19750  2 014165   014170 601000 2                  TNZ     s:19753
         2 014166   000005 720100                    LXL0    5,,PR0
         2 014167   014216 600000 2                  TZE     s:19761

     2952    19751    3             THEN
     2953    19752    4               DO;

     2954    19753    4                 CALL CNVRT_BLD(SIZEC(' Pages='),' Pages=',IND1) ;

  19753  2 014170   200015 631500                    EPPR1   IND1,,AUTO
         2 014171   202307 451500                    STP1    @KEYWDVAL,,AUTO
         2 014172   000371 236000 3                  LDQ     249
         2 014173   202306 756100                    STQ     @KEYWD,,AUTO
         2 014174   000053 236000 3                  LDQ     43
         2 014175   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014176   012300 701000 2                  TSX1    CNVRT_BLD
         2 014177   000000 011000                    NOP     0

     2955    19754    4                 IND1 = FORM$ -> CODE16.LINENO ;

  19754  2 014200   202115 470500                    LDP0    FORM$,,AUTO
         2 014201   000005 236100                    LDQ     5,,PR0
         2 014202   777777 376007                    ANQ     -1,DL
         2 014203   200015 756100                    STQ     IND1,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:461  
     2956    19755    4                 IF IND1 ~= 0

  19755  2 014204   014230 600000 2                  TZE     s:19764

     2957    19756    4                   THEN
     2958    19757    4                     CALL CNVRT_BLD(SIZEC(', Lines='),', Lines=',IND1) ;

  19757  2 014205   200015 631500                    EPPR1   IND1,,AUTO
         2 014206   202307 451500                    STP1    @KEYWDVAL,,AUTO
         2 014207   000372 236000 3                  LDQ     250
         2 014210   202306 756100                    STQ     @KEYWD,,AUTO
         2 014211   000113 236000 3                  LDQ     75
         2 014212   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014213   012300 701000 2                  TSX1    CNVRT_BLD
         2 014214   000000 011000                    NOP     0

     2959    19758    4               END;

  19758  2 014215   014230 710000 2                  TRA     s:19764

     2960    19759    3             ELSE
     2961    19760    4               DO;

     2962    19761    4                 IND1 = FORM$ -> CODE16.RECNO ;

  19761  2 014216   000004 235100                    LDA     4,,PR0
         2 014217   200015 755100                    STA     IND1,,AUTO

     2963    19762    4                 CALL CNVRT_BLD(SIZEC(' Records='),' Records=',IND1) ;

  19762  2 014220   200015 631500                    EPPR1   IND1,,AUTO
         2 014221   202307 451500                    STP1    @KEYWDVAL,,AUTO
         2 014222   000373 236000 3                  LDQ     251
         2 014223   202306 756100                    STQ     @KEYWD,,AUTO
         2 014224   000124 236000 3                  LDQ     84
         2 014225   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014226   012300 701000 2                  TSX1    CNVRT_BLD
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:462  
         2 014227   000000 011000                    NOP     0

     2964    19763    4               END;

     2965    19764    3           IND1 = FORM$->CODE16.COPIES ;

  19764  2 014230   202115 470500                    LDP0    FORM$,,AUTO
         2 014231   000007 236100                    LDQ     7,,PR0
         2 014232   000022 772000                    QRL     18
         2 014233   000777 376007                    ANQ     511,DL
         2 014234   200015 756100                    STQ     IND1,,AUTO

     2966    19765    3           CALL CNVRT_BLD(SIZEC(', Copies='),', Copies=',IND1) ;

  19765  2 014235   200015 631500                    EPPR1   IND1,,AUTO
         2 014236   202307 451500                    STP1    @KEYWDVAL,,AUTO
         2 014237   000374 236000 3                  LDQ     252
         2 014240   202306 756100                    STQ     @KEYWD,,AUTO
         2 014241   000124 236000 3                  LDQ     84
         2 014242   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014243   012300 701000 2                  TSX1    CNVRT_BLD
         2 014244   000000 011000                    NOP     0

     2967    19766    3           IF DCB$->F$DCB.HEADER$ ~= ADDR(NIL)

  19766  2 014245   202114 470500                    LDP0    DCB$,,AUTO
         2 014246   000046 236100                    LDQ     38,,PR0
         2 014247   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 014250   014360 600000 2                  TZE     DISPLAY_RETURN

     2968    19767    3             THEN
     2969    19768    4               DO ;

     2970    19769    4                 IND1 = DCB$->F$DCB.HEADER$->VLP$HDR.CTL.COUNT# ;

  19769  2 014251   000046 471500                    LDP1    38,,PR0
         2 014252   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:463  
         2 014253   000777 376007                    ANQ     511,DL
         2 014254   200015 756100                    STQ     IND1,,AUTO

     2971    19770    4                 IF IND1 ~= 0

  19770  2 014255   014266 600000 2                  TZE     s:19773

     2972    19771    4                   THEN
     2973    19772    4                       CALL CNVRT_BLD(SIZEC(', Pagecolumn='),', Pagecolumn=',IND1) ;

  19772  2 014256   200015 633500                    EPPR3   IND1,,AUTO
         2 014257   202307 453500                    STP3    @KEYWDVAL,,AUTO
         2 014260   000376 236000 3                  LDQ     254
         2 014261   202306 756100                    STQ     @KEYWD,,AUTO
         2 014262   000377 236000 3                  LDQ     255
         2 014263   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014264   012300 701000 2                  TSX1    CNVRT_BLD
         2 014265   000000 011000                    NOP     0

     2974    19773    4                 IND1 = DCB$->F$DCB.HEADER$->VLP$HDR.TITL.L# ;

  19773  2 014266   202114 470500                    LDP0    DCB$,,AUTO
         2 014267   000046 471500                    LDP1    38,,PR0
         2 014270   100001 236100                    LDQ     1,,PR1
         2 014271   000033 772000                    QRL     27
         2 014272   200015 756100                    STQ     IND1,,AUTO

     2975    19774    4                 IF IND1 ~= 0

  19774  2 014273   014360 600000 2                  TZE     DISPLAY_RETURN

     2976    19775    4                   THEN
     2977    19776    5                     DO ;

     2978    19777    5                       INBUFF = ', ' ;

  19777  2 014274   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:464  
         2 014275   001521 000002 1                  ADSC9   CONSTCLS+339             cn=0,n=2
         2 014276   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     2979    19778    5                       CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 2, TAB_VAL)

  19778  2 014277   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 014300   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 014301   000400 236000 3                  LDQ     256
         2 014302   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 014303   200034 633500                    EPPR3   IN$,,AUTO
         2 014304   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 014305   200035 634500                    EPPR4   DEST$,,AUTO
         2 014306   202353 454500                    STP4    CLSDCB+31,,AUTO
         2 014307   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 014310   202352 455500                    STP5    CLSDCB+30,,AUTO
         2 014311   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014312   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 014313   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 014314   014362 702000 2                  TSX2    DISPLAY_ALTRET

     2980    19779    5                               ALTRET(DISPLAY_ALTRET) ;
     2981    19780    5                       CALL CONCAT(INBUFF,'Title=''',DCB$->F$DCB.HEADER$->

  19780  2 014315   202114 470500                    LDP0    DCB$,,AUTO
         2 014316   000046 471500                    LDP1    38,,PR0
         2 014317   100001 236100                    LDQ     1,,PR1
         2 014320   000033 772000                    QRL     27
         2 014321   040100 100400                    MLR     fill='040'O
         2 014322   001547 000007 1                  ADSC9   CONSTCLS+361             cn=0,n=7
         2 014323   200037 000007                    ADSC9   INBUFF,,AUTO             cn=0,n=7
         2 014324   000000 620006                    EAX0    0,QL
         2 014325   040100 100540                    MLR     fill='040'O
         2 014326   100001 200010                    ADSC9   1,,PR1                   cn=1,n=*X0
         2 014327   200040 600771                    ADSC9   INBUFF+1,,AUTO           cn=3,n=505
         2 014330   000771 116007                    CMPQ    505,DL
         2 014331   014337 603000 2                  TRC     s:19782
         2 014332   777006 620006                    EAX0    -506,QL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:465  
         2 014333   777777 660003                    ERX0    -1,DU
         2 014334   040146 100400                    MLR     fill='040'O
         2 014335   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 014336   200040 600010                    ADSC9   INBUFF+1,Q,AUTO          cn=3,n=*X0

     2982    19781    5                              VLP$HDR.TITL.TITLE#,'''') ;
     2983    19782    5                       CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+8,TAB_VAL)

  19782  2 014337   200015 235100                    LDA     IND1,,AUTO
         2 014340   000010 035007                    ADLA    8,DL
         2 014341   202352 755100                    STA     CLSDCB+30,,AUTO
         2 014342   200474 631500                    EPPR1   TAB_VAL,,AUTO
         2 014343   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 014344   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 014345   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 014346   200034 634500                    EPPR4   IN$,,AUTO
         2 014347   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 014350   200035 635500                    EPPR5   DEST$,,AUTO
         2 014351   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 014352   200036 636500                    EPPR6   OUTBUFF$,,AUTO
         2 014353   202353 456500                    STP6    CLSDCB+31,,AUTO
         2 014354   202353 630500                    EPPR0   CLSDCB+31,,AUTO
         2 014355   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 014356   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 014357   014362 702000 2                  TSX2    DISPLAY_ALTRET

     2984    19783    5                             ALTRET(DISPLAY_ALTRET) ;
     2985    19784    5                     END ; /* Then Do */

     2986    19785    4               END ; /* Then Do */

     2987    19786
     2988    19787    3   DISPLAY_RETURN:
     2989    19788    3           RETURN ;

  19788  2 014360   202302 221300       DISPLAY_RET* LDX1  ! VLP_WINDOW+8,,AUTO
         2 014361   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:466  

     2990    19789
     2991    19790    3   DISPLAY_ALTRET:
     2992    19791    3           ALTRETURN ;

  19791  2 014362   202302 221300       DISPLAY_ALT* LDX1  ! VLP_WINDOW+8,,AUTO
         2 014363   000000 702211                    TSX2  ! 0,X1

     2993    19792    3   END     DISPLAY_NORMAL_LDEV ;
     2994    19793        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:467  
     2995    19794    2   DISPLAY_WINDOW_OPTS: PROC  ALTRET ;

  19794  2 014364   202302 741300       DISPLAY_WIN* STX1  ! VLP_WINDOW+8,,AUTO

     2996    19795    3           FPT_TRMCTL = CFPT_TRMCTL ;

  19795  2 014365   000100 100400                    MLR     fill='000'O
         2 014366   000674 000040 1                  ADSC9   CFPT_TRMCTL              cn=0,n=32
         2 014367   202262 000040                    ADSC9   FPT_TRMCTL,,AUTO         cn=0,n=32

     2997    19796    3           FPT_TRMCTL.V_ = VECTOR(FPT_TRMCTL.V) ;

  19796  2 014370   000023 235000 3                  LDA     19
         2 014371   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 014372   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 014373   002270 036003                    ADLQ    1208,DU
         2 014374   202262 757100                    STAQ    FPT_TRMCTL,,AUTO

     2998    19797    3           FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_WINDOW) ;

  19797  2 014375   000054 235000 3                  LDA     44
         2 014376   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 014377   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 014400   002272 036003                    ADLQ    1210,DU
         2 014401   202266 757100                    STAQ    WAIT_INT+2,,AUTO

     2999    19798    3           FPT_TRMCTL.V.VLPTYPE# = %TRMCTL_WINDOW# ;

  19798  2 014402   000001 220003                    LDX0    1,DU
         2 014403   202270 440100                    SXL0    WAIT_INT+4,,AUTO

     3000    19799    3           CALL SETUP_TCTL_DCB ALTRET(WINDOW_OPTS_ALT) ;

  19799  2 014404   015153 701000 2                  TSX1    SETUP_TCTL_DCB
         2 014405   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3001    19800    3           CALL M$GTRMCTL(FPT_TRMCTL) ALTRET(WINDOW_OPTS_ALT) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:468  

  19800  2 014406   202262 630500                    EPPR0   FPT_TRMCTL,,AUTO
         2 014407   560001 713400                    CLIMB   alt,+57345
         2 014410   401000 401760                    pmme    nvectors=3
         2 014411   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3002    19801    3           IF LDEVS_HDR_PRINTED = %NO#

  19801  2 014412   200022 234100                    SZN     LDEVS_HDR_PRINTED,,AUTO
         2 014413   014431 604000 2                  TMI     s:19808

     3003    19802    3             THEN
     3004    19803    4               DO ;

     3005    19804    4                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_ = VECTOR(LDEVHDR) ;

  19804  2 014414   000000 470400 xsym               LDP0    SEG2$
         2 014415   000165 471500                    LDP1    117,,PR0
         2 014416   000366 237000 3                  LDAQ    246
         2 014417   100004 757100                    STAQ    4,,PR1

     3006    19805    4                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(WINDOW_OPTS_ALT) ;

  19805  2 014420   000000 236000 xsym               LDQ     SEG2$
         2 014421   000165 036003                    ADLQ    117,DU
         2 014422   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 014423   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014424   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 014425   000000 701000 xent               TSX1    CPE$LISTOUT
         2 014426   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3007    19806    4                 LDEVS_HDR_PRINTED = %YES# ;

  19806  2 014427   400000 236003                    LDQ     -131072,DU
         2 014430   200022 756100                    STQ     LDEVS_HDR_PRINTED,,AUTO

     3008    19807    4               END ; /* Then Do */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:469  

     3009    19808    3           IF LDEVS_EXIST = %NO#

  19808  2 014431   200021 234100                    SZN     LDEVS_EXIST,,AUTO
         2 014432   014435 604000 2                  TMI     s:19811

     3010    19809    3             THEN
     3011    19810    3               LDEVS_EXIST = %YES# ;

  19810  2 014433   400000 236003                    LDQ     -131072,DU
         2 014434   200021 756100                    STQ     LDEVS_EXIST,,AUTO

     3012    19811    3           IF DILDEV_OPT

  19811  2 014435   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 014436   014447 605000 2                  TPL     s:19819

     3013    19812    3             THEN
     3014    19813    4               DO ;

     3015    19814    4                 OUTBUFF=' ';

  19814  2 014437   040100 100400                    MLR     fill='040'O
         2 014440   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 014441   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     3016    19815    4                 DEST$ = OUTBUFF$ ;

  19815  2 014442   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 014443   200035 756100                    STQ     DEST$,,AUTO

     3017    19816    4                 TAB_VAL = 10 ;

  19816  2 014444   000012 235007                    LDA     10,DL
         2 014445   200474 755100                    STA     TAB_VAL,,AUTO

     3018    19817    4               END ; /* Then Do */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:470  

  19817  2 014446   014451 710000 2                  TRA     s:19820

     3019    19818    3             ELSE
     3020    19819    3               TAB_VAL = 5 ;

  19819  2 014447   000005 235007                    LDA     5,DL
         2 014450   200474 755100                    STA     TAB_VAL,,AUTO

     3021    19820    3           CALL CONCAT(INBUFF,'     ', B$ROS$->B$ROSEG.LDEVNAME(N)) ;

  19820  2 014451   202111 470500                    LDP0    @N,,AUTO
         2 014452   000000 235100                    LDA     0,,PR0
         2 014453   040100 100400                    MLR     fill='040'O
         2 014454   001505 000005 1                  ADSC9   CONSTCLS+327             cn=0,n=5
         2 014455   200037 000005                    ADSC9   INBUFF,,AUTO             cn=0,n=5
         2 014456   000002 735000                    ALS     2
         2 014457   000000 471400 xsym               LDP1    B$ROS$
         2 014460   040100 100505                    MLR     fill='040'O
         2 014461   100054 000004                    ADSC9   44,A,PR1                 cn=0,n=4
         2 014462   200040 200773                    ADSC9   INBUFF+1,,AUTO           cn=1,n=507

     3022    19821    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 10) ALTRET(WINDOW_OPTS_ALT) ;

  19821  2 014463   000051 236000 3                  LDQ     41
         2 014464   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 014465   200034 630500                    EPPR0   IN$,,AUTO
         2 014466   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 014467   200035 631500                    EPPR1   DEST$,,AUTO
         2 014470   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 014471   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 014472   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 014473   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014474   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 014475   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 014476   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:471  
     3023    19822    3           IF NOT DILDEV_OPT

  19822  2 014477   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 014500   015147 605000 2                  TPL     WINDOW_OPTS_RET

     3024    19823    3             THEN
     3025    19824    3               GOTO WINDOW_OPTS_RET ;
     3026    19825    3           INBUFF = 'Position=' ;

  19825  2 014501   040100 100400                    MLR     fill='040'O
         2 014502   001551 000011 1                  ADSC9   CONSTCLS+363             cn=0,n=9
         2 014503   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3027    19826    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 9) ALTRET(WINDOW_OPTS_ALT) ;

  19826  2 014504   000124 236000 3                  LDQ     84
         2 014505   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 014506   200034 630500                    EPPR0   IN$,,AUTO
         2 014507   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 014510   200035 631500                    EPPR1   DEST$,,AUTO
         2 014511   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 014512   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 014513   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 014514   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014515   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 014516   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 014517   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3028    19827    3           IND1 = VLP_WINDOW.ORG_PST.LINE ;

  19827  2 014520   202274 236100                    LDQ     VLP_WINDOW+2,,AUTO
         2 014521   000022 772000                    QRL     18
         2 014522   000777 376007                    ANQ     511,DL
         2 014523   200015 756100                    STQ     IND1,,AUTO

     3029    19828    3           CALL BINCHAR(COUNTER1,IND1) ;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:472  
  19828  2 014524   000000 235003                    LDA     0,DU
         2 014525   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 014526   000100 301500                    BTD
         2 014527   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 014530   202116 030014                    NDSC9   COUNTER1,,AUTO           cn=0,s=nosgn,sf=0,n=12

     3030    19829    3           CALL CPE$RZEROS(COUNTER1,SIZEC(COUNTER1),LEN) ;

  19829  2 014531   202131 630500                    EPPR0   LEN,,AUTO
         2 014532   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 014533   000370 236000 3                  LDQ     248
         2 014534   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 014535   202116 631500                    EPPR1   COUNTER1,,AUTO
         2 014536   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 014537   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014540   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 014541   000000 701000 xent               TSX1    CPE$RZEROS
         2 014542   000000 011000                    NOP     0

     3031    19830    3           IND2 = VLP_WINDOW.ORG_PST.COLUMN ;

  19830  2 014543   202274 236100                    LDQ     VLP_WINDOW+2,,AUTO
         2 014544   777777 376007                    ANQ     -1,DL
         2 014545   202124 756100                    STQ     IND2,,AUTO

     3032    19831    3           CALL BINCHAR(COUNTER2,IND2) ;

  19831  2 014546   000000 235003                    LDA     0,DU
         2 014547   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 014550   000100 301500                    BTD
         2 014551   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 014552   202121 030014                    NDSC9   COUNTER2,,AUTO           cn=0,s=nosgn,sf=0,n=12

     3033    19832    3           CALL CPE$RZEROS(COUNTER2,SIZEC(COUNTER2),TEMP) ;

  19832  2 014553   202125 630500                    EPPR0   TEMP,,AUTO
         2 014554   202354 450500                    STP0    CLSDCB+32,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:473  
         2 014555   000370 236000 3                  LDQ     248
         2 014556   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 014557   202121 631500                    EPPR1   COUNTER2,,AUTO
         2 014560   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 014561   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014562   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 014563   000000 701000 xent               TSX1    CPE$RZEROS
         2 014564   000000 011000                    NOP     0

     3034    19833    3           INBUFF = ' ' ;

  19833  2 014565   040100 100400                    MLR     fill='040'O
         2 014566   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 014567   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3035    19834    3          CALL CONCAT(INBUFF, '(', SUBSTR(COUNTER1,0,LEN), ',', SUBSTR(COUNTER2,0,TEMP
             19834                    ),

  19834  2 014570   050000 236003                    LDQ     20480,DU
         2 014571   200037 756100                    STQ     INBUFF,,AUTO
         2 014572   202131 720100                    LXL0    LEN,,AUTO
         2 014573   040100 100540                    MLR     fill='040'O
         2 014574   202116 000010                    ADSC9   COUNTER1,,AUTO           cn=0,n=*X0
         2 014575   200037 200777                    ADSC9   INBUFF,,AUTO             cn=1,n=511
         2 014576   202131 236100                    LDQ     LEN,,AUTO
         2 014577   000777 116007                    CMPQ    511,DL
         2 014600   014634 605000 2                  TPL     s:19836
         2 014601   777000 621006                    EAX1    -512,QL
         2 014602   777777 661003                    ERX1    -1,DU
         2 014603   040146 100400                    MLR     fill='040'O
         2 014604   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 014605   200037 200011                    ADSC9   INBUFF,Q,AUTO            cn=1,n=*X1
         2 014606   202131 236100                    LDQ     LEN,,AUTO
         2 014607   000776 116007                    CMPQ    510,DL
         2 014610   014634 605000 2                  TPL     s:19836
         2 014611   777001 620006                    EAX0    -511,QL
         2 014612   777777 660003                    ERX0    -1,DU
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:474  
         2 014613   202125 721100                    LXL1    TEMP,,AUTO
         2 014614   040146 100540                    MLR     fill='040'O
         2 014615   202121 000011                    ADSC9   COUNTER2,,AUTO           cn=0,n=*X1
         2 014616   200037 400010                    ADSC9   INBUFF,Q,AUTO            cn=2,n=*X0
         2 014617   202131 236100                    LDQ     LEN,,AUTO
         2 014620   202125 036100                    ADLQ    TEMP,,AUTO
         2 014621   000776 116007                    CMPQ    510,DL
         2 014622   014634 605000 2                  TPL     s:19836
         2 014623   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 014624   202131 236100                    LDQ     LEN,,AUTO
         2 014625   202125 036100                    ADLQ    TEMP,,AUTO
         2 014626   202352 720100                    LXL0    CLSDCB+30,,AUTO
         2 014627   777001 620010                    EAX0    -511,X0
         2 014630   777777 660003                    ERX0    -1,DU
         2 014631   040146 100400                    MLR     fill='040'O
         2 014632   000122 000001 3                  ADSC9   82                       cn=0,n=1
         2 014633   200037 400010                    ADSC9   INBUFF,Q,AUTO            cn=2,n=*X0

     3036    19835    3             ')') ;
     3037    19836    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, LEN+TEMP+3)

  19836  2 014634   202131 236100                    LDQ     LEN,,AUTO
         2 014635   202125 036100                    ADLQ    TEMP,,AUTO
         2 014636   000003 036007                    ADLQ    3,DL
         2 014637   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 014640   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 014641   202357 450500                    STP0    CLSDCB+35,,AUTO
         2 014642   200034 631500                    EPPR1   IN$,,AUTO
         2 014643   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 014644   200035 633500                    EPPR3   DEST$,,AUTO
         2 014645   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 014646   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 014647   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 014650   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 014651   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 014652   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 014653   015151 702000 2                  TSX2    WINDOW_OPTS_ALT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:475  

     3038    19837    3             ALTRET(WINDOW_OPTS_ALT) ;
     3039    19838    3           IND1 = VLP_WINDOW.LENGTH# ;

  19838  2 014654   202273 235100                    LDA     VLP_WINDOW+1,,AUTO
         2 014655   000022 731000                    ARS     18
         2 014656   200015 755100                    STA     IND1,,AUTO

     3040    19839    3           CALL CNVRT_BLD(SIZEC(', WLength='), ', WLength=', IND1) ;

  19839  2 014657   200015 630500                    EPPR0   IND1,,AUTO
         2 014660   202307 450500                    STP0    @KEYWDVAL,,AUTO
         2 014661   000401 236000 3                  LDQ     257
         2 014662   202306 756100                    STQ     @KEYWD,,AUTO
         2 014663   000051 236000 3                  LDQ     41
         2 014664   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014665   012300 701000 2                  TSX1    CNVRT_BLD
         2 014666   000000 011000                    NOP     0

     3041    19840    3           IND1 = VLP_WINDOW.WIDTH# ;

  19840  2 014667   202273 236100                    LDQ     VLP_WINDOW+1,,AUTO
         2 014670   000022 736000                    QLS     18
         2 014671   000022 732000                    QRS     18
         2 014672   200015 756100                    STQ     IND1,,AUTO

     3042    19841    3           CALL CNVRT_BLD(SIZEC(', WWidth='), ', WWidth=', IND1) ;

  19841  2 014673   200015 630500                    EPPR0   IND1,,AUTO
         2 014674   202307 450500                    STP0    @KEYWDVAL,,AUTO
         2 014675   000402 236000 3                  LDQ     258
         2 014676   202306 756100                    STQ     @KEYWD,,AUTO
         2 014677   000124 236000 3                  LDQ     84
         2 014700   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014701   012300 701000 2                  TSX1    CNVRT_BLD
         2 014702   000000 011000                    NOP     0

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:476  
     3043    19842    3           IND1 = VLP_WINDOW.MINWIDTH# ;

  19842  2 014703   202276 236100                    LDQ     VLP_WINDOW+4,,AUTO
         2 014704   000022 772000                    QRL     18
         2 014705   000777 376007                    ANQ     511,DL
         2 014706   200015 756100                    STQ     IND1,,AUTO

     3044    19843    3           CALL CNVRT_BLD(SIZEC(', MinWidth='), ', MinWidth=', IND1) ;

  19843  2 014707   200015 630500                    EPPR0   IND1,,AUTO
         2 014710   202307 450500                    STP0    @KEYWDVAL,,AUTO
         2 014711   000403 236000 3                  LDQ     259
         2 014712   202306 756100                    STQ     @KEYWD,,AUTO
         2 014713   000126 236000 3                  LDQ     86
         2 014714   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014715   012300 701000 2                  TSX1    CNVRT_BLD
         2 014716   000000 011000                    NOP     0

     3045    19844    3           IND1 = VLP_WINDOW.MINLENGTH# ;

  19844  2 014717   202276 236100                    LDQ     VLP_WINDOW+4,,AUTO
         2 014720   000033 772000                    QRL     27
         2 014721   200015 756100                    STQ     IND1,,AUTO

     3046    19845    3           CALL CNVRT_BLD(SIZEC(', MinLength='), ', MinLength=', IND1) ;

  19845  2 014722   200015 630500                    EPPR0   IND1,,AUTO
         2 014723   202307 450500                    STP0    @KEYWDVAL,,AUTO
         2 014724   000404 236000 3                  LDQ     260
         2 014725   202306 756100                    STQ     @KEYWD,,AUTO
         2 014726   000370 236000 3                  LDQ     248
         2 014727   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014730   012300 701000 2                  TSX1    CNVRT_BLD
         2 014731   000000 011000                    NOP     0

     3047    19846    3           CALL PUT_FLAG(VLP_WINDOW.TOPBRDR#, 'TopBrdr', LENGTHC('TopBrdr'))

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:477  
  19846  2 014732   000406 237000 3                  LDAQ    262
         2 014733   202306 757100                    STAQ    @KEYWD,,AUTO
         2 014734   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 014735   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 014736   000410 036000 3                  ADLQ    264
         2 014737   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014740   015350 701000 2                  TSX1    PUT_FLAG
         2 014741   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3048    19847    3             ALTRET(WINDOW_OPTS_ALT) ;
     3049    19848    3           CALL PUT_FLAG(VLP_WINDOW.BTMBRDR#, 'BtmBrdr', LENGTHC('BtmBrdr'))

  19848  2 014742   000412 237000 3                  LDAQ    266
         2 014743   202306 757100                    STAQ    @KEYWD,,AUTO
         2 014744   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 014745   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 014746   000411 036000 3                  ADLQ    265
         2 014747   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014750   015350 701000 2                  TSX1    PUT_FLAG
         2 014751   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3050    19849    3             ALTRET(WINDOW_OPTS_ALT) ;
     3051    19850    3           CALL PUT_FLAG(VLP_WINDOW.LFTBRDR#, 'LftBrdr', LENGTHC('LftBrdr'))

  19850  2 014752   000414 237000 3                  LDAQ    268
         2 014753   202306 757100                    STAQ    @KEYWD,,AUTO
         2 014754   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 014755   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 014756   000416 036000 3                  ADLQ    270
         2 014757   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014760   015350 701000 2                  TSX1    PUT_FLAG
         2 014761   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3052    19851    3             ALTRET(WINDOW_OPTS_ALT) ;
     3053    19852    3           CALL PUT_FLAG(VLP_WINDOW.RHTBRDR#, 'RhtBrdr', LENGTHC('RhtBrdr'))

  19852  2 014762   000420 237000 3                  LDAQ    272
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:478  
         2 014763   202306 757100                    STAQ    @KEYWD,,AUTO
         2 014764   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 014765   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 014766   000417 036000 3                  ADLQ    271
         2 014767   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 014770   015350 701000 2                  TSX1    PUT_FLAG
         2 014771   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3054    19853    3             ALTRET(WINDOW_OPTS_ALT) ;
     3055    19854    3           CALL PUT_FLAG(VLP_WINDOW.REMOVABLE#, 'Optional', LENGTHC('Optional'))

  19854  2 014772   000422 237000 3                  LDAQ    274
         2 014773   202306 757100                    STAQ    @KEYWD,,AUTO
         2 014774   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 014775   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 014776   000424 036000 3                  ADLQ    276
         2 014777   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 015000   015350 701000 2                  TSX1    PUT_FLAG
         2 015001   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3056    19855    3             ALTRET(WINDOW_OPTS_ALT) ;
     3057    19856    3           IF VLP_WINDOW.HBRDRSIZ# > 0

  19856  2 015002   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015003   017000 316003                    CANQ    7680,DU
         2 015004   015023 600000 2                  TZE     s:19863

     3058    19857    3           THEN
     3059    19858    4           DO ;

     3060    19859    4              IND1 = VLP_WINDOW.HBRDRSIZ# ;

  19859  2 015005   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015006   000033 772000                    QRL     27
         2 015007   000017 376007                    ANQ     15,DL
         2 015010   200015 756100                    STQ     IND1,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:479  
     3061    19860    4              CALL MOVE_COMMA_BLANK ;

  19860  2 015011   015263 701000 2                  TSX1    MOVE_COMMA_BLANK
         2 015012   000000 011000                    NOP     0

     3062    19861    4              CALL CNVRT_BLD(SIZEC('HBrdrSiz='), 'HBrdrSiz=', IND1) ;

  19861  2 015013   200015 630500                    EPPR0   IND1,,AUTO
         2 015014   202307 450500                    STP0    @KEYWDVAL,,AUTO
         2 015015   000425 236000 3                  LDQ     277
         2 015016   202306 756100                    STQ     @KEYWD,,AUTO
         2 015017   000124 236000 3                  LDQ     84
         2 015020   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 015021   012300 701000 2                  TSX1    CNVRT_BLD
         2 015022   000000 011000                    NOP     0

     3063    19862    4              END ;                        /*  Then Do                           */

     3064    19863    3           IND1 = ASCBIN(VLP_WINDOW.HBRDRCHR#) ;

  19863  2 015023   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015024   000022 772000                    QRL     18
         2 015025   000777 376007                    ANQ     511,DL
         2 015026   200015 756100                    STQ     IND1,,AUTO

     3065    19864    3           IF IND1 >= 32

  19864  2 015027   000040 116007                    CMPQ    32,DL
         2 015030   015065 602000 2                  TNC     s:19873

     3066    19865    3           THEN
     3067    19866    4           DO ;

     3068    19867    4              CALL MOVE_COMMA_BLANK ;

  19867  2 015031   015263 701000 2                  TSX1    MOVE_COMMA_BLANK
         2 015032   000000 011000                    NOP     0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:480  

     3069    19868    4              INBUFF = ' ' ;

  19868  2 015033   040100 100400                    MLR     fill='040'O
         2 015034   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015035   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3070    19869    4              CALL CONCAT(INBUFF, 'HBrdrChr=''', VLP_WINDOW.HBRDRCHR#,'''') ;

  19869  2 015036   040100 100400                    MLR     fill='040'O
         2 015037   001605 000012 1                  ADSC9   CONSTCLS+391             cn=0,n=10
         2 015040   200037 000012                    ADSC9   INBUFF,,AUTO             cn=0,n=10
         2 015041   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015042   000011 772000                    QRL     9
         2 015043   200041 552110                    STBQ    INBUFF+2,'10'O,AUTO
         2 015044   040100 100400                    MLR     fill='040'O
         2 015045   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 015046   200041 600765                    ADSC9   INBUFF+2,,AUTO           cn=3,n=501

     3071    19870    4              CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 12, TAB_VAL)

  19870  2 015047   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 015050   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 015051   000370 236000 3                  LDQ     248
         2 015052   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 015053   200034 631500                    EPPR1   IN$,,AUTO
         2 015054   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 015055   200035 633500                    EPPR3   DEST$,,AUTO
         2 015056   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 015057   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 015060   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 015061   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015062   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 015063   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 015064   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3072    19871    4                ALTRET(WINDOW_OPTS_ALT) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:481  
     3073    19872    4              END ;                        /* Then Do                            */

     3074    19873    3           IF VLP_WINDOW.VBRDRSIZ# > 0

  19873  2 015065   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015066   017000 316007                    CANQ    7680,DL
         2 015067   015106 600000 2                  TZE     s:19880

     3075    19874    3           THEN
     3076    19875    4           DO ;

     3077    19876    4              IND1 = VLP_WINDOW.VBRDRSIZ# ;

  19876  2 015070   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015071   000011 772000                    QRL     9
         2 015072   000017 376007                    ANQ     15,DL
         2 015073   200015 756100                    STQ     IND1,,AUTO

     3078    19877    4              CALL MOVE_COMMA_BLANK ;

  19877  2 015074   015263 701000 2                  TSX1    MOVE_COMMA_BLANK
         2 015075   000000 011000                    NOP     0

     3079    19878    4              CALL CNVRT_BLD(SIZEC('VBrdrSiz='), 'VBrdrSiz=', IND1) ;

  19878  2 015076   200015 630500                    EPPR0   IND1,,AUTO
         2 015077   202307 450500                    STP0    @KEYWDVAL,,AUTO
         2 015100   000426 236000 3                  LDQ     278
         2 015101   202306 756100                    STQ     @KEYWD,,AUTO
         2 015102   000124 236000 3                  LDQ     84
         2 015103   202305 756100                    STQ     @KEYWDSZE,,AUTO
         2 015104   012300 701000 2                  TSX1    CNVRT_BLD
         2 015105   000000 011000                    NOP     0

     3080    19879    4              END ;                        /*  Then Do                           */

     3081    19880    3           IND1 = ASCBIN(VLP_WINDOW.VBRDRCHR#) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:482  

  19880  2 015106   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015107   000777 376007                    ANQ     511,DL
         2 015110   200015 756100                    STQ     IND1,,AUTO

     3082    19881    3           IF IND1 >= 32

  19881  2 015111   000040 116007                    CMPQ    32,DL
         2 015112   015147 602000 2                  TNC     WINDOW_OPTS_RET

     3083    19882    3           THEN
     3084    19883    4           DO ;

     3085    19884    4              CALL MOVE_COMMA_BLANK ;

  19884  2 015113   015263 701000 2                  TSX1    MOVE_COMMA_BLANK
         2 015114   000000 011000                    NOP     0

     3086    19885    4              INBUFF = ' ' ;

  19885  2 015115   040100 100400                    MLR     fill='040'O
         2 015116   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015117   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3087    19886    4              CALL CONCAT(INBUFF, 'VBrdrChr=''', VLP_WINDOW.VBRDRCHR#,'''') ;

  19886  2 015120   040100 100400                    MLR     fill='040'O
         2 015121   001613 000012 1                  ADSC9   CONSTCLS+397             cn=0,n=10
         2 015122   200037 000012                    ADSC9   INBUFF,,AUTO             cn=0,n=10
         2 015123   202275 236100                    LDQ     VLP_WINDOW+3,,AUTO
         2 015124   000011 736000                    QLS     9
         2 015125   200041 552110                    STBQ    INBUFF+2,'10'O,AUTO
         2 015126   040100 100400                    MLR     fill='040'O
         2 015127   000135 000001 3                  ADSC9   93                       cn=0,n=1
         2 015130   200041 600765                    ADSC9   INBUFF+2,,AUTO           cn=3,n=501

     3088    19887    4              CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 12, TAB_VAL)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:483  

  19887  2 015131   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 015132   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 015133   000370 236000 3                  LDQ     248
         2 015134   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 015135   200034 631500                    EPPR1   IN$,,AUTO
         2 015136   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 015137   200035 633500                    EPPR3   DEST$,,AUTO
         2 015140   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 015141   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 015142   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 015143   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015144   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 015145   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 015146   015151 702000 2                  TSX2    WINDOW_OPTS_ALT

     3089    19888    4                ALTRET(WINDOW_OPTS_ALT) ;
     3090    19889    4              END ;                        /* Then Do                            */

     3091    19890    3   WINDOW_OPTS_RET:
     3092    19891    3           RETURN ;

  19891  2 015147   202302 221300       WINDOW_OPTS* LDX1  ! VLP_WINDOW+8,,AUTO
         2 015150   000001 702211                    TSX2  ! 1,X1

     3093    19892
     3094    19893    3   WINDOW_OPTS_ALT:
     3095    19894    3           ALTRETURN ;

  19894  2 015151   202302 221300       WINDOW_OPTS* LDX1  ! VLP_WINDOW+8,,AUTO
         2 015152   000000 702211                    TSX2  ! 0,X1

     3096    19895    3   END   DISPLAY_WINDOW_OPTS ;
     3097    19896        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:484  
     3098    19897    2   SETUP_TCTL_DCB: PROC ALTRET ;

  19897  2 015153   202304 741300       SETUP_TCTL_* STX1  ! SIZ+1,,AUTO

     3099    19898        /*
     3100    19899          *** Auto
     3101    19900        */
     3102    19901    3   DCL I UBIN WORD ;
     3103    19902    3   DCL K UBIN ;
     3104    19903    3   DCL DCBTAB$ PTR ;
     3105    19904        /**/
     3106    19905    3           OPEN = %NO# ;

  19905  2 015154   202130 450100                    STZ     OPEN,,AUTO

     3107    19906    3           DCBTAB$ = B$ROS$->B$ROSEG.DCBPTR$ ;

  19906  2 015155   000000 470400 xsym               LDP0    B$ROS$
         2 015156   000000 236100                    LDQ     0,,PR0
         2 015157   202307 756100                    STQ     DCBTAB$,,AUTO

     3108    19907    3           K = B$ROS$->B$ROSEG.NUMDCBS ;

  19907  2 015160   000002 236100                    LDQ     2,,PR0
         2 015161   000022 772000                    QRL     18
         2 015162   202306 756100                    STQ     K,,AUTO

     3109    19908        /*
     3110    19909              First look for a dcb open to the specified stream,
     3111    19910              failing locating one, open a dcb to that stream.
     3112    19911        */
     3113    19912    4           DO I=0 TO K-1 ;

  19912  2 015163   202305 450100                    STZ     I,,AUTO
         2 015164   015211 710000 2                  TRA     s:19921+3

     3114    19913    4              IF DCBADDR(I)~=ADDR(NIL)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:485  

  19913  2 015165   000102 470400 3                  LDP0    66
         2 015166   000000 471500                    LDP1    0,,PR0
         2 015167   202305 720100                    LXL0    I,,AUTO
         2 015170   100000 236110                    LDQ     0,X0,PR1
         2 015171   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 015172   015206 600000 2                  TZE     s:19921

     3115    19914    4              THEN
     3116    19915    4                 IF DCBADDR(I)->F$DCB.FCD# AND DCBADDR(I)->F$DCB.STR#=STREAM

  19915  2 015173   100000 473510                    LDP3    0,X0,PR1
         2 015174   300031 236100                    LDQ     25,,PR3
         2 015175   020000 316007                    CANQ    8192,DL
         2 015176   015206 600000 2                  TZE     s:19921
         2 015177   300077 236100                    LDQ     63,,PR3
         2 015200   000777 376007                    ANQ     511,DL
         2 015201   202127 116100                    CMPQ    STREAM,,AUTO
         2 015202   015206 601000 2                  TNZ     s:19921

     3117    19916    4                 THEN
     3118    19917    5                 DO ;

     3119    19918    5                    FPT_TRMCTL.V.DCB# = I ;

  19918  2 015203   202270 740100                    STX0    WAIT_INT+4,,AUTO

     3120    19919    5                    RETURN ;

  19919  2 015204   202304 221300                    LDX1  ! SIZ+1,,AUTO
         2 015205   000001 702211                    TSX2  ! 1,X1

     3121    19920    5                    END ;                  /* Then Do                            */
     3122    19921    4              END ;                        /* Do I                               */

  19921  2 015206   202305 235100                    LDA     I,,AUTO
         2 015207   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:486  
         2 015210   202305 755100                    STA     I,,AUTO
         2 015211   202305 236100                    LDQ     I,,AUTO
         2 015212   202306 116100                    CMPQ    K,,AUTO
         2 015213   015165 602000 2                  TNC     s:19913

     3123    19922        /*
     3124    19923              No dcb open to this stream, open one.
     3125    19924        */
     3126    19925    3           OPNMYDCB = CONSTOPN;

  19925  2 015214   000100 100400                    MLR     fill='000'O
         2 015215   000544 000350 1                  ADSC9   CONSTOPN                 cn=0,n=232
         2 015216   202132 000350                    ADSC9   OPNMYDCB,,AUTO           cn=0,n=232

     3127    19926    3           OPNMYDCB.V_ = VECTOR(OPNMYDCB.V) ;

  19926  2 015217   000064 235000 3                  LDA     52
         2 015220   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 015221   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 015222   002176 036003                    ADLQ    1150,DU
         2 015223   202132 757100                    STAQ    OPNMYDCB,,AUTO

     3128    19927    3           DCBSLOT = M$IBEX1_NUM ;

  19927  2 015224   000000 235000 xsym               LDA     M$IBEX1_NUM
         2 015225   200016 755100                    STA     DCBSLOT,,AUTO

     3129    19928    3           IF DCBADDR(DCBSLOT)->F$DCB.FCD#

  19928  2 015226   000102 470400 3                  LDP0    66
         2 015227   000000 471500                    LDP1    0,,PR0
         2 015230   100000 473505                    LDP3    0,AL,PR1
         2 015231   300031 236100                    LDQ     25,,PR3
         2 015232   020000 316007                    CANQ    8192,DL
         2 015233   015236 600000 2                  TZE     s:19931

     3130    19929    3             THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:487  
     3131    19930    3               CALL CLOSEMYDCB ;

  19930  2 015234   015337 701000 2                  TSX1    CLOSEMYDCB
         2 015235   000000 011000                    NOP     0

     3132    19931    3           OPNMYDCB.V.DCB# = DCBSLOT ;

  19931  2 015236   200016 720100                    LXL0    DCBSLOT,,AUTO
         2 015237   202176 740100                    STX0    I+34,,AUTO

     3133    19932    3           OPNMYDCB.V.RES# = B$ROS$->B$ROSEG.LDEVNAME(STREAM) ;

  19932  2 015240   000000 470400 xsym               LDP0    B$ROS$
         2 015241   202127 721100                    LXL1    STREAM,,AUTO
         2 015242   000054 236111                    LDQ     44,X1,PR0
         2 015243   202202 756100                    STQ     I+38,,AUTO

     3134    19933    3           OPNMYDCB.V.ASN# = %DEVICE# ;

  19933  2 015244   000003 236007                    LDQ     3,DL
         2 015245   202177 552104                    STBQ    I+35,'04'O,AUTO

     3135    19934    4           CALL M$OPEN(OPNMYDCB) WHENALTRETURN DO; ALTRETURN; END ;

  19934  2 015246   202132 630500                    EPPR0   OPNMYDCB,,AUTO
         2 015247   450000 713400                    CLIMB   alt,open
         2 015250   410400 401760                    pmme    nvectors=18
         2 015251   015253 702000 2                  TSX2    s:19934+5
         2 015252   015255 710000 2                  TRA     s:19936

  19934  2 015253   202304 221300                    LDX1  ! SIZ+1,,AUTO
         2 015254   000000 702211                    TSX2  ! 0,X1

     3136    19935
     3137    19936    3           FPT_TRMCTL.V.DCB# = DCBSLOT ;

  19936  2 015255   200016 720100                    LXL0    DCBSLOT,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:488  
         2 015256   202270 740100                    STX0    WAIT_INT+4,,AUTO

     3138    19937    3           OPEN = %YES# ;

  19937  2 015257   400000 236003                    LDQ     -131072,DU
         2 015260   202130 756100                    STQ     OPEN,,AUTO

     3139    19938    3           RETURN ;

  19938  2 015261   202304 221300                    LDX1  ! SIZ+1,,AUTO
         2 015262   000001 702211                    TSX2  ! 1,X1

     3140    19939
     3141    19940    3   END   SETUP_TCTL_DCB ;
     3142    19941        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:489  
     3143    19942    2   MOVE_COMMA_BLANK: PROC ;

  19942  2 015263   202310 741300       MOVE_COMMA_* STX1  ! TBUFF,,AUTO

     3144    19943
     3145    19944    3           INBUFF = ',' ;

  19944  2 015264   040100 100400                    MLR     fill='040'O
         2 015265   000121 000001 3                  ADSC9   81                       cn=0,n=1
         2 015266   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3146    19945    3           CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 1, TAB_VAL)

  19945  2 015267   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 015270   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 015271   000033 236000 3                  LDQ     27
         2 015272   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 015273   200034 631500                    EPPR1   IN$,,AUTO
         2 015274   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 015275   200035 633500                    EPPR3   DEST$,,AUTO
         2 015276   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 015277   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 015300   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 015301   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015302   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 015303   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 015304   015306 702000 2                  TSX2    s:19947
         2 015305   015306 710000 2                  TRA     s:19947

     3147    19946    4           WHENALTRETURN DO ; END ;

     3148    19947    3           IF DEST$ ~= PINCRC(OUTBUFF$, TAB_VAL)

  19947  2 015306   200474 236100                    LDQ     TAB_VAL,,AUTO
         2 015307   000020 736000                    QLS     16
         2 015310   200036 036100                    ADLQ    OUTBUFF$,,AUTO
         2 015311   200035 116100                    CMPQ    DEST$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:490  
         2 015312   015335 600000 2                  TZE     s:19954

     3149    19948    3           THEN
     3150    19949    4           DO ;

     3151    19950    4              INBUFF = ' ' ;

  19950  2 015313   040100 100400                    MLR     fill='040'O
         2 015314   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015315   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3152    19951    4              CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 1, TAB_VAL)

  19951  2 015316   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 015317   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 015320   000033 236000 3                  LDQ     27
         2 015321   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 015322   200034 631500                    EPPR1   IN$,,AUTO
         2 015323   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 015324   200035 633500                    EPPR3   DEST$,,AUTO
         2 015325   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 015326   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 015327   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 015330   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015331   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 015332   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 015333   015335 702000 2                  TSX2    s:19954
         2 015334   015335 710000 2                  TRA     s:19954

     3153    19952    5              WHENALTRETURN DO ; END ;

     3154    19953    4              END ;                        /* Then Do                            */

     3155    19954    3           RETURN ;

  19954  2 015335   202310 221300                    LDX1  ! TBUFF,,AUTO
         2 015336   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:491  

     3156    19955    3   END   MOVE_COMMA_BLANK ;
     3157    19956        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:492  
     3158    19957    2   CLOSEMYDCB: PROC ;

  19957  2 015337   202310 741300       CLOSEMYDCB   STX1  ! TBUFF,,AUTO

     3159    19958    3           IF OPEN

  19958  2 015340   202130 234100                    SZN     OPEN,,AUTO
         2 015341   015346 605000 2                  TPL     s:19961

     3160    19959    3           THEN
     3161    19960    3           CALL CLOSE_DCB(DCBSLOT);

  19960  2 015342   200016 630500                    EPPR0   DCBSLOT,,AUTO
         2 015343   202313 450500                    STP0    TBUFF+3,,AUTO
         2 015344   017561 701000 2                  TSX1    CLOSE_DCB
         2 015345   000000 011000                    NOP     0

     3162    19961    3           RETURN ;

  19961  2 015346   202310 221300                    LDX1  ! TBUFF,,AUTO
         2 015347   000001 702211                    TSX2  ! 1,X1

     3163    19962    3   END   CLOSEMYDCB ;
     3164    19963        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:493  
     3165    19964    2   PUT_FLAG: PROC (FLAG, TEXT, LENGTH) ALTRET;

  19964  2 015350   202304 741300       PUT_FLAG     STX1  ! SIZ+1,,AUTO

     3166    19965
     3167    19966    3   DCL FLAG BIT (2) UNAL;
     3168    19967    3   DCL TEXT CHAR (LENGTH);
     3169    19968    3   DCL LENGTH UBIN WORD;
     3170    19969
     3171    19970    3           IF FLAG = %YES#

  19970  2 015351   202305 470500                    LDP0    @FLAG,,AUTO
         2 015352   000000 066500                    CMPB    filb='0'B
         2 015353   000000 000002                    BDSC    0,,PR0                   by=0,bit=0,n=2
         2 015354   000030 000022 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=18
         2 015355   015406 601000 2                  TNZ     s:19981

     3172    19971    4           THEN DO;

     3173    19972
     3174    19973    4              CALL MOVE_COMMA_BLANK ;

  19973  2 015356   015263 701000 2                  TSX1    MOVE_COMMA_BLANK
         2 015357   000000 011000                    NOP     0

     3175    19974    4              LEN = LENGTH ;

  19974  2 015360   202307 470500                    LDP0    @LENGTH,,AUTO
         2 015361   000000 235100                    LDA     0,,PR0
         2 015362   202131 755100                    STA     LEN,,AUTO

     3176    19975    4              INBUFF = TEXT ;

  19975  2 015363   000000 720100                    LXL0    0,,PR0
         2 015364   202306 471500                    LDP1    @TEXT,,AUTO
         2 015365   040100 100540                    MLR     fill='040'O
         2 015366   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:494  
         2 015367   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3177    19976    4              CALL CPB$BLDIMAGE (OUTBUFF$, DEST$, IN$, LEN, TAB_VAL)

  19976  2 015370   200474 633500                    EPPR3   TAB_VAL,,AUTO
         2 015371   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 015372   202131 634500                    EPPR4   LEN,,AUTO
         2 015373   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 015374   200034 635500                    EPPR5   IN$,,AUTO
         2 015375   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 015376   200035 636500                    EPPR6   DEST$,,AUTO
         2 015377   202353 456500                    STP6    CLSDCB+31,,AUTO
         2 015400   200036 637500                    EPPR7   OUTBUFF$,,AUTO
         2 015401   202352 457500                    STP7    CLSDCB+30,,AUTO
         2 015402   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015403   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 015404   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 015405   015410 702000 2                  TSX2    OOPS

     3178    19977    4                ALTRET (OOPS);
     3179    19978
     3180    19979    4              END;

     3181    19980
     3182    19981    3           RETURN;

  19981  2 015406   202304 221300                    LDX1  ! SIZ+1,,AUTO
         2 015407   000001 702211                    TSX2  ! 1,X1

     3183    19982
     3184    19983    3   OOPS:   ALTRETURN;

  19983  2 015410   202304 221300       OOPS         LDX1  ! SIZ+1,,AUTO
         2 015411   000000 702211                    TSX2  ! 0,X1

     3185    19984
     3186    19985    3   END PUT_FLAG;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:495  
     3187    19986    2   END   DILDEV;
     3188    19987        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:496  
     3189    19988    1   FIND_ALL_LDEVS: PROC(N, OPT, OPTLEN) ALTRET ;

  19988  2 015412   202102 741300       FIND_ALL_LD* STX1  ! FPT_UNFID,,AUTO

     3190    19989
     3191    19990    2   DCL N SBIN ;
     3192    19991    2   DCL OPT CHAR(4) ;
     3193    19992    2   DCL OPTLEN UBIN ;
     3194    19993    2   DCL 1 BAD_LDEV_NAME,
     3195    19994    2         2 CNT UBIN BYTE CALIGNED,
     3196    19995    2         2 TXT CHAR(4) CALIGNED ;
     3197    19996
     3198    19997    3             DO WHILE('1'B);

     3199    19998    3               CALL DILDEV(N,OPT,OPTLEN)ALTRET(ENDIT);

  19998  2 015413   202104 237100                    LDAQ    @OPT,,AUTO
         2 015414   202112 757100                    STAQ    @OPT,,AUTO
         2 015415   202103 236100                    LDQ     @N,,AUTO
         2 015416   202111 756100                    STQ     @N,,AUTO
         2 015417   013636 701000 2                  TSX1    DILDEV
         2 015420   015463 702000 2                  TSX2    ENDIT

     3200    19999    3               IF OUTBUFF~=' ' AND DILDEV_OPT THEN

  19999  2 015421   040000 106500                    CMPC    fill='040'O
         2 015422   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512
         2 015423   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015424   015455 600000 2                  TZE     s:20005
         2 015425   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 015426   015455 605000 2                  TPL     s:20005

     3201    20000    4                 DO ;

     3202    20001    4                   SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$) ;

  20001  2 015427   000000 470400 xsym               LDP0    SEG2$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:497  
         2 015430   000165 471500                    LDP1    117,,PR0
         2 015431   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 015432   000020 772000                    QRL     16
         2 015433   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 015434   200035 236100                    LDQ     DEST$,,AUTO
         2 015435   000020 772000                    QRL     16
         2 015436   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 015437   000020 736000                    QLS     16
         2 015440   100004 676100                    ERQ     4,,PR1
         2 015441   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 015442   100004 656100                    ERSQ    4,,PR1

     3203    20002    4                   SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$ ;

  20002  2 015443   000165 471500                    LDP1    117,,PR0
         2 015444   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 015445   100005 756100                    STQ     5,,PR1

     3204    20003    4                   CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(FIND_ALL_LDEVS_ERR) ;

  20003  2 015446   000000 236000 xsym               LDQ     SEG2$
         2 015447   000165 036003                    ADLQ    117,DU
         2 015450   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 015451   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 015453   000000 701000 xent               TSX1    CPE$LISTOUT
         2 015454   015614 702000 2                  TSX2    FIND_ALL_LDEVS_ERR

     3205    20004    4                 END ; /*  Then Do */

     3206    20005    3               IF DILDEV_OPT

  20005  2 015455   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 015456   015413 605000 2                  TPL     s:19998

     3207    20006    3                 THEN
     3208    20007    3                   OUTBUFF=' ';
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:498  

  20007  2 015457   040100 100400                    MLR     fill='040'O
         2 015460   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015461   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     3209    20008    3             END;

  20008  2 015462   015413 710000 2                  TRA     s:19998

     3210    20009    2   ENDIT:
     3211    20010    2             IF OUTBUFF~=' ' AND NOT DILDEV_OPT THEN

  20010  2 015463   040000 106500       ENDIT        CMPC    fill='040'O
         2 015464   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512
         2 015465   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015466   015517 600000 2                  TZE     s:20016
         2 015467   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 015470   015517 604000 2                  TMI     s:20016

     3212    20011    3               DO ;

     3213    20012    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$) ;

  20012  2 015471   000000 470400 xsym               LDP0    SEG2$
         2 015472   000165 471500                    LDP1    117,,PR0
         2 015473   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 015474   000020 772000                    QRL     16
         2 015475   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 015476   200035 236100                    LDQ     DEST$,,AUTO
         2 015477   000020 772000                    QRL     16
         2 015500   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 015501   000020 736000                    QLS     16
         2 015502   100004 676100                    ERQ     4,,PR1
         2 015503   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 015504   100004 656100                    ERSQ    4,,PR1

     3214    20013    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$ ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:499  

  20013  2 015505   000165 471500                    LDP1    117,,PR0
         2 015506   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 015507   100005 756100                    STQ     5,,PR1

     3215    20014    3                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(FIND_ALL_LDEVS_ERR) ;

  20014  2 015510   000000 236000 xsym               LDQ     SEG2$
         2 015511   000165 036003                    ADLQ    117,DU
         2 015512   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 015513   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015514   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 015515   000000 701000 xent               TSX1    CPE$LISTOUT
         2 015516   015614 702000 2                  TSX2    FIND_ALL_LDEVS_ERR

     3216    20015    3               END ; /*  Then Do */

     3217    20016    2             IF NOT DILDEV_OPT

  20016  2 015517   200023 234100                    SZN     DILDEV_OPT,,AUTO
         2 015520   015524 604000 2                  TMI     s:20019

     3218    20017    2               THEN
     3219    20018    2                 OUTBUFF=' ';

  20018  2 015521   040100 100400                    MLR     fill='040'O
         2 015522   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015523   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     3220    20019    2             IF LDEVS_EXIST = %NO#

  20019  2 015524   200021 234100                    SZN     LDEVS_EXIST,,AUTO
         2 015525   015612 604000 2                  TMI     s:20038

     3221    20020    2               THEN
     3222    20021    2                 IF OPTLEN = 0

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:500  
  20021  2 015526   202105 470500                    LDP0    @OPTLEN,,AUTO
         2 015527   000000 235100                    LDA     0,,PR0
         2 015530   015545 601000 2                  TNZ     s:20029

     3223    20022    2                   THEN
     3224    20023    3                     DO ;

     3225    20024    3                       SEG$2.FPT_WRITE$->FPT$WRITE.BUF_ = VECTOR(LDEVNHDR) ;

  20024  2 015531   000000 471400 xsym               LDP1    SEG2$
         2 015532   100165 473500                    LDP3    117,,PR1
         2 015533   000430 237000 3                  LDAQ    280
         2 015534   300004 757100                    STAQ    4,,PR3

     3226    20025    3                       CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(FIND_ALL_LDEVS_ERR) ;

  20025  2 015535   000000 236000 xsym               LDQ     SEG2$
         2 015536   000165 036003                    ADLQ    117,DU
         2 015537   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 015540   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015541   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 015542   000000 701000 xent               TSX1    CPE$LISTOUT
         2 015543   015614 702000 2                  TSX2    FIND_ALL_LDEVS_ERR

     3227    20026    3                     END ; /* Then Do */

  20026  2 015544   015612 710000 2                  TRA     s:20038

     3228    20027    2                   ELSE
     3229    20028    3                     DO ;

     3230    20029    3                       BAD_LDEV_NAME.CNT = OPTLEN ;

  20029  2 015545   000000 236100                    LDQ     0,,PR0
         2 015546   000033 736000                    QLS     27
         2 015547   202106 552140                    STBQ    BAD_LDEV_NAME,'40'O,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:501  
     3231    20030    3                       BAD_LDEV_NAME.TXT = OPT ;

  20030  2 015550   202104 471500                    LDP1    @OPT,,AUTO
         2 015551   040100 100500                    MLR     fill='040'O
         2 015552   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 015553   202106 200004                    ADSC9   BAD_LDEV_NAME,,AUTO      cn=1,n=4

     3232    20031    3                       IF OPTLEN = 2

  20031  2 015554   000000 235100                    LDA     0,,PR0
         2 015555   000002 115007                    CMPA    2,DL
         2 015556   015575 601000 2                  TNZ     s:20036

     3233    20032    3                         THEN
     3234    20033    3                           CALL CPC$WRITEMSGE(E_NOLDEVTHATTYPE,,BAD_LDEV_NAME,,,

  20033  2 015557   000001 236000 3                  LDQ     1
         2 015560   000001 235000 xsym               LDA     B_VECTNIL+1
         2 015561   202356 757100                    STAQ    CLSDCB+34,,AUTO
         2 015562   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 015563   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 015564   202106 633500                    EPPR3   BAD_LDEV_NAME,,AUTO
         2 015565   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 015566   000432 235000 3                  LDA     282
         2 015567   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 015570   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015571   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 015572   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 015573   000000 011000                    NOP     0
         2 015574   015612 710000 2                  TRA     s:20038

     3235    20034    3                                 %YES#) ;
     3236    20035    3                         ELSE
     3237    20036    3                           CALL CPC$WRITEMSGE(E_NOSUCHLDEV,,BAD_LDEV_NAME,,,%YES#) ;

  20036  2 015575   000001 236000 3                  LDQ     1
         2 015576   000001 235000 xsym               LDA     B_VECTNIL+1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:502  
         2 015577   202356 757100                    STAQ    CLSDCB+34,,AUTO
         2 015600   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 015601   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 015602   202106 633500                    EPPR3   BAD_LDEV_NAME,,AUTO
         2 015603   202354 453500                    STP3    CLSDCB+32,,AUTO
         2 015604   000030 235000 3                  LDA     24
         2 015605   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 015606   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015607   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 015610   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 015611   000000 011000                    NOP     0

     3238    20037    3                     END ; /* Else Do */

     3239    20038    2         RETURN ;

  20038  2 015612   202102 221300                    LDX1  ! FPT_UNFID,,AUTO
         2 015613   000001 702211                    TSX2  ! 1,X1

     3240    20039
     3241    20040    2   FIND_ALL_LDEVS_ERR:
     3242    20041    2         ALTRETURN ;

  20041  2 015614   202102 221300       FIND_ALL_LD* LDX1  ! FPT_UNFID,,AUTO
         2 015615   000000 702211                    TSX2  ! 0,X1

     3243    20042
     3244    20043    2   END   FIND_ALL_LDEVS ;
     3245    20044                   %EJECT;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:503  
     3246    20045        /**********************************************************************/
     3247    20046        /*I*   NAME:   DISPNOTIFY
     3248    20047               PURPOSE: Display the settings of various flags for NOTIFY
     3249    20048               CALL:   CALL DISPNOTIFY
     3250    20049               INTERFACE: CPC$WRITEMSGE,CPE$LISTOUT,CPB$BLDIMAGE,CPJ$READ_S, CPC$OPEN_S
     3251    20050               INPUT:
     3252    20051               OUTPUT: flag settings in the *S NOTIFY record.
     3253    20052               DESCRIPTION: The various flag settings in the *S NOTIFY record are
     3254    20053                       reflected on the listing device.
     3255    20054        */
     3256    20055        /**********************************************************************/
     3257    20056    1   DISPNOTIFY: PROC ALTRET ;

  20056  2 015616   202072 741300       DISPNOTIFY   STX1  ! VLP_SN+4,,AUTO

     3258    20057
     3259    20058        %CP_CHFLAGS (FPTN=CP_CHFLAGS, STCLASS=AUTO) ;
     3260    20192    2   DCL OUTBUFF2 CHAR(120) ;
     3261    20193    2   DCL OUTBUFF2$ PTR ;
     3262    20194    2   DCL DEST2$ PTR ;
     3263    20195    2   DCL LEN UBIN WORD ;
     3264    20196    2   DCL WAIT_INT CHAR(3) ;
     3265    20197
     3266    20198    2     FPT_CLOSE = CFPT_CLOSE;

  20198  2 015617   000100 100400                    MLR     fill='000'O
         2 015620   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 015621   201676 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

     3267    20199    2     FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  20199  2 015622   000003 235000 3                  LDA     3
         2 015623   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 015624   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 015625   001730 036003                    ADLQ    984,DU
         2 015626   201676 757100                    STAQ    FPT_CLOSE,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:504  
     3268    20200    2     FPT_CLOSE.V.DISP# = %SAVE# ;

  20200  2 015627   000002 236007                    LDQ     2,DL
         2 015630   201730 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

     3269    20201    2     FPT_CLOSE.V.DCB# = M$IBEX1_NUM ;

  20201  2 015631   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 015632   201730 740100                    STX0    FPT_CLOSE+26,,AUTO

     3270    20202    2     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(DISPNOTIFY_ALT) ;

  20202  2 015633   000006 630400 3                  EPPR0   6
         2 015634   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 015635   000000 701000 xent               TSX1    CPC$OPEN_S
         2 015636   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3271    20203    2     CALL CPJ$READ_S (M$IBEX1_NUM,VECTOR(K_NOTIFY),VECTOR(CP_CHFLAGS))

  20203  2 015637   000436 235000 3                  LDA     286
         2 015640   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 015641   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 015642   002073 036003                    ADLQ    1083,DU
         2 015643   202354 757100                    STAQ    CLSDCB+32,,AUTO
         2 015644   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 015645   202360 450500                    STP0    CLSDCB+36,,AUTO
         2 015646   000440 237000 3                  LDAQ    288
         2 015647   202356 757100                    STAQ    CLSDCB+34,,AUTO
         2 015650   202356 630500                    EPPR0   CLSDCB+34,,AUTO
         2 015651   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 015652   000000 701000 xent               TSX1    CPJ$READ_S
         2 015653   015655 702000 2                  TSX2    s:20206
         2 015654   015714 710000 2                  TRA     s:20218

     3272    20204    2             WHENALTRETURN
     3273    20205    3               DO ;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:505  
     3274    20206    3                 IF B$TCB.ALT$->B$EXCFR.ERR.ERR# ~= %E$NOKEY

  20206  2 015655   000000 470400 xsym               LDP0    B$TCB$
         2 015656   000000 471500                    LDP1    0,,PR0
         2 015657   100102 236100                    LDQ     66,,PR1
         2 015660   377770 376007                    ANQ     131064,DL
         2 015661   001020 116007                    CMPQ    528,DL
         2 015662   017033 601000 2                  TNZ     DISPNOTIFY_ERR

     3275    20207    3                   THEN
     3276    20208    3                     GOTO DISPNOTIFY_ERR ;
     3277    20209    3                 OUTBUFF = '   Notify: none' ;

  20209  2 015663   040100 100400                    MLR     fill='040'O
         2 015664   001616 000017 1                  ADSC9   CONSTCLS+400             cn=0,n=15
         2 015665   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     3278    20210    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = 14 ;

  20210  2 015666   000000 471400 xsym               LDP1    SEG2$
         2 015667   100165 473500                    LDP3    117,,PR1
         2 015670   300004 236100                    LDQ     4,,PR3
         2 015671   177777 376007                    ANQ     65535,DL
         2 015672   000437 276000 3                  ORQ     287
         2 015673   300004 756100                    STQ     4,,PR3

     3279    20211    3                 SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = ADDR(OUTBUFF) ;

  20211  2 015674   100165 473500                    LDP3    117,,PR1
         2 015675   200237 634500                    EPPR4   OUTBUFF,,AUTO
         2 015676   300005 454500                    STP4    5,,PR3

     3280    20212    3                 CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;

  20212  2 015677   000000 236000 xsym               LDQ     SEG2$
         2 015700   000165 036003                    ADLQ    117,DU
         2 015701   202352 756100                    STQ     CLSDCB+30,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:506  
         2 015702   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015703   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 015704   000000 701000 xent               TSX1    CPE$LISTOUT
         2 015705   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3281    20213    4                 CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;

  20213  2 015706   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 015707   450001 713400                    CLIMB   alt,close
         2 015710   406000 401760                    pmme    nvectors=13
         2 015711   015713 702000 2                  TSX2    s:20215
         2 015712   015713 710000 2                  TRA     s:20215

     3282    20214    4                                         END ;

     3283    20215    3                 GOTO DISPNOTIFY_RET ;

  20215  2 015713   017031 710000 2                  TRA     DISPNOTIFY_RET

     3284    20216    3               END ;   /* Whenaltreturn Do */
     3285    20217
     3286    20218    3     CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;

  20218  2 015714   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 015715   450001 713400                    CLIMB   alt,close
         2 015716   406000 401760                    pmme    nvectors=13
         2 015717   015721 702000 2                  TSX2    s:20220
         2 015720   015721 710000 2                  TRA     s:20220

     3287    20219    3                             END ;

     3288    20220    2     IN$ = ADDR(INBUFF) ;

  20220  2 015721   200037 630500                    EPPR0   INBUFF,,AUTO
         2 015722   200034 450500                    STP0    IN$,,AUTO

     3289    20221    2     OUTBUFF$ = ADDR(OUTBUFF) ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:507  

  20221  2 015723   200237 631500                    EPPR1   OUTBUFF,,AUTO
         2 015724   200036 451500                    STP1    OUTBUFF$,,AUTO

     3290    20222    2     DEST$ = OUTBUFF$ ;

  20222  2 015725   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 015726   200035 756100                    STQ     DEST$,,AUTO

     3291    20223    2     OUTBUFF = '   Notify:' ;

  20223  2 015727   040100 100400                    MLR     fill='040'O
         2 015730   001616 000012 1                  ADSC9   CONSTCLS+400             cn=0,n=10
         2 015731   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     3292    20224    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = 9 ;

  20224  2 015732   000000 473400 xsym               LDP3    SEG2$
         2 015733   300165 474500                    LDP4    117,,PR3
         2 015734   400004 236100                    LDQ     4,,PR4
         2 015735   177777 376007                    ANQ     65535,DL
         2 015736   000442 276000 3                  ORQ     290
         2 015737   400004 756100                    STQ     4,,PR4

     3293    20225    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF$ ;

  20225  2 015740   300165 470500                    LDP0    117,,PR3
         2 015741   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 015742   000005 756100                    STQ     5,,PR0

     3294    20226    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;

  20226  2 015743   000000 236000 xsym               LDQ     SEG2$
         2 015744   000165 036003                    ADLQ    117,DU
         2 015745   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 015746   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015747   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:508  
         2 015750   000000 701000 xent               TSX1    CPE$LISTOUT
         2 015751   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3295    20227
     3296    20228    2     INBUFF = '     Use ' ;

  20228  2 015752   040100 100400                    MLR     fill='040'O
         2 015753   001622 000011 1                  ADSC9   CONSTCLS+404             cn=0,n=9
         2 015754   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3297    20229    2     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 9) ALTRET(DISPNOTIFY_ALT) ;

  20229  2 015755   000124 236000 3                  LDQ     84
         2 015756   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 015757   200034 630500                    EPPR0   IN$,,AUTO
         2 015760   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 015761   200035 631500                    EPPR1   DEST$,,AUTO
         2 015762   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 015763   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 015764   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 015765   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 015766   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 015767   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 015770   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3298    20230    2     VLP_SN = CP_CHFLAGS.USE_SN ;

  20230  2 015771   000100 100500                    MLR     fill='000'O
         2 015772   202113 000012                    ADSC9   @OPTLEN,,AUTO            cn=0,n=10
         2 015773   202066 000012                    ADSC9   VLP_SN,,AUTO             cn=0,n=10

     3299    20231    2     IF VLP_SN.SN#(0) ~= ' '

  20231  2 015774   040000 106500                    CMPC    fill='040'O
         2 015775   202067 000006                    ADSC9   VLP_SN+1,,AUTO           cn=0,n=6
         2 015776   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 015777   016046 600000 2                  TZE     s:20240
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:509  

     3300    20232    2         THEN
     3301    20233    3             DO ;

     3302    20234    3               CALL CONCAT(INBUFF,'DP#',VLP_SN.SN#(0)) ;

  20234  2 016000   001476 236000 1                  LDQ     CONSTCLS+320
         2 016001   000357 376000 3                  ANQ     239
         2 016002   000040 276007                    ORQ     32,DL
         2 016003   200037 756100                    STQ     INBUFF,,AUTO
         2 016004   040100 100500                    MLR     fill='040'O
         2 016005   202067 000006                    ADSC9   VLP_SN+1,,AUTO           cn=0,n=6
         2 016006   200037 600775                    ADSC9   INBUFF,,AUTO             cn=3,n=509

     3303    20235    3               CALL SEARCHR(IND1, TEMP, SRCHTBL, VLP_SN.SN#(0)) ;

  20235  2 016007   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
         2 016010   000000 165500                    TCTR
         2 016011   202067 000006                    ADSC9   VLP_SN+1,,AUTO           cn=0,n=6
         2 016012   000000 000100                    ARG     0,,PR0
         2 016013   200015 000100                    ARG     IND1,,AUTO
         2 016014   200015 235100                    LDA     IND1,,AUTO
         2 016015   000033 771000                    ARL     27
         2 016016   200014 755100                    STA     TEMP,,AUTO
         2 016017   200015 551140                    STBA    IND1,'40'O,AUTO
         2 016020   016023 606400 2                  TTN     s:20236
         2 016021   000005 236007                    LDQ     5,DL
         2 016022   200015 156100                    SSQ     IND1,,AUTO

     3304    20236    3               CALL INSERT(INBUFF, IND1+4, 1, '/') ;

  20236  2 016023   200015 236100                    LDQ     IND1,,AUTO
         2 016024   040106 100400                    MLR     fill='040'O
         2 016025   000443 000001 3                  ADSC9   291                      cn=0,n=1
         2 016026   200040 000001                    ADSC9   INBUFF+1,Q,AUTO          cn=0,n=1

     3305    20237    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+5)
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:510  

  20237  2 016027   200015 236100                    LDQ     IND1,,AUTO
         2 016030   000005 036007                    ADLQ    5,DL
         2 016031   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016032   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 016033   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 016034   200034 633500                    EPPR3   IN$,,AUTO
         2 016035   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 016036   200035 634500                    EPPR4   DEST$,,AUTO
         2 016037   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 016040   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 016041   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 016042   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 016043   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016044   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016045   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3306    20238    3                     ALTRET(DISPNOTIFY_ALT) ;
     3307    20239    3             END ; /* Then Do */

     3308    20240    2     INBUFF = CP_CHFLAGS.USE_NAME.NAME# ;

  20240  2 016046   040100 100500                    MLR     fill='040'O
         2 016047   202075 200037                    ADSC9   N,,AUTO                  cn=1,n=31
         2 016050   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3309    20241    2     IND1 = CP_CHFLAGS.USE_NAME.L# ;

  20241  2 016051   202075 236100                    LDQ     N,,AUTO
         2 016052   000033 772000                    QRL     27
         2 016053   200015 756100                    STQ     IND1,,AUTO

     3310    20242    2     CALL INSERT(INBUFF, IND1, 1, '.') ;

  20242  2 016054   040106 100400                    MLR     fill='040'O
         2 016055   000360 000001 3                  ADSC9   240                      cn=0,n=1
         2 016056   200037 000001                    ADSC9   INBUFF,Q,AUTO            cn=0,n=1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:511  

     3311    20243    2     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+1) ALTRET(DISPNOTIFY_ALT) ;

  20243  2 016057   200015 235100                    LDA     IND1,,AUTO
         2 016060   000001 035007                    ADLA    1,DL
         2 016061   202352 755100                    STA     CLSDCB+30,,AUTO
         2 016062   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016063   202357 450500                    STP0    CLSDCB+35,,AUTO
         2 016064   200034 631500                    EPPR1   IN$,,AUTO
         2 016065   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 016066   200035 633500                    EPPR3   DEST$,,AUTO
         2 016067   202355 453500                    STP3    CLSDCB+33,,AUTO
         2 016070   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 016071   202354 454500                    STP4    CLSDCB+32,,AUTO
         2 016072   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 016073   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016074   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016075   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3312    20244    2     IF CP_CHFLAGS.USE_ACCT ~= ' '

  20244  2 016076   040000 106500                    CMPC    fill='040'O
         2 016077   202073 000010                    ADSC9   CP_CHFLAGS,,AUTO         cn=0,n=8
         2 016100   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 016101   016140 600000 2                  TZE     s:20252

     3313    20245    2         THEN
     3314    20246    3             DO ;

     3315    20247    3               INBUFF = CP_CHFLAGS.USE_ACCT ;

  20247  2 016102   040100 100500                    MLR     fill='040'O
         2 016103   202073 000010                    ADSC9   CP_CHFLAGS,,AUTO         cn=0,n=8
         2 016104   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3316    20248    3               CALL SEARCHR(IND1, TEMP, SRCHTBL, CP_CHFLAGS.USE_ACCT) ;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:512  
  20248  2 016105   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
         2 016106   000000 165500                    TCTR
         2 016107   202073 000010                    ADSC9   CP_CHFLAGS,,AUTO         cn=0,n=8
         2 016110   000000 000100                    ARG     0,,PR0
         2 016111   200015 000100                    ARG     IND1,,AUTO
         2 016112   200015 235100                    LDA     IND1,,AUTO
         2 016113   000033 771000                    ARL     27
         2 016114   200014 755100                    STA     TEMP,,AUTO
         2 016115   200015 551140                    STBA    IND1,'40'O,AUTO
         2 016116   016121 606400 2                  TTN     s:20249
         2 016117   000007 236007                    LDQ     7,DL
         2 016120   200015 156100                    SSQ     IND1,,AUTO

     3317    20249    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+1)

  20249  2 016121   200015 236100                    LDQ     IND1,,AUTO
         2 016122   000001 036007                    ADLQ    1,DL
         2 016123   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016124   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 016125   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 016126   200034 633500                    EPPR3   IN$,,AUTO
         2 016127   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 016130   200035 634500                    EPPR4   DEST$,,AUTO
         2 016131   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 016132   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 016133   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 016134   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 016135   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016136   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016137   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3318    20250    3                     ALTRET(DISPNOTIFY_ALT) ;
     3319    20251    3             END ; /* Then Do */

     3320    20252    2     IF CP_CHFLAGS.USE_PASS ~= ' '

  20252  2 016140   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:513  
         2 016141   202105 000010                    ADSC9   @OPTLEN,,AUTO            cn=0,n=8
         2 016142   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 016143   016204 600000 2                  TZE     s:20260

     3321    20253    2         THEN
     3322    20254    3             DO ;

     3323    20255    3               CALL CONCAT(INBUFF, '.', CP_CHFLAGS.USE_PASS) ;

  20255  2 016144   056000 236003                    LDQ     23552,DU
         2 016145   200037 756100                    STQ     INBUFF,,AUTO
         2 016146   040100 100500                    MLR     fill='040'O
         2 016147   202105 000010                    ADSC9   @OPTLEN,,AUTO            cn=0,n=8
         2 016150   200037 200777                    ADSC9   INBUFF,,AUTO             cn=1,n=511

     3324    20256    3               CALL SEARCHR(IND1, TEMP, SRCHTBL, CP_CHFLAGS.USE_PASS) ;

  20256  2 016151   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
         2 016152   000000 165500                    TCTR
         2 016153   202105 000010                    ADSC9   @OPTLEN,,AUTO            cn=0,n=8
         2 016154   000000 000100                    ARG     0,,PR0
         2 016155   200015 000100                    ARG     IND1,,AUTO
         2 016156   200015 235100                    LDA     IND1,,AUTO
         2 016157   000033 771000                    ARL     27
         2 016160   200014 755100                    STA     TEMP,,AUTO
         2 016161   200015 551140                    STBA    IND1,'40'O,AUTO
         2 016162   016165 606400 2                  TTN     s:20257
         2 016163   000007 236007                    LDQ     7,DL
         2 016164   200015 156100                    SSQ     IND1,,AUTO

     3325    20257    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, IND1+2)

  20257  2 016165   200015 236100                    LDQ     IND1,,AUTO
         2 016166   000002 036007                    ADLQ    2,DL
         2 016167   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016170   202352 631500                    EPPR1   CLSDCB+30,,AUTO
         2 016171   202357 451500                    STP1    CLSDCB+35,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:514  
         2 016172   200034 633500                    EPPR3   IN$,,AUTO
         2 016173   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 016174   200035 634500                    EPPR4   DEST$,,AUTO
         2 016175   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 016176   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 016177   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 016200   202354 630500                    EPPR0   CLSDCB+32,,AUTO
         2 016201   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016202   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016203   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3326    20258    3                     ALTRET(DISPNOTIFY_ALT) ;
     3327    20259    3             END ; /* Then Do */

     3328    20260    2     IF CP_CHFLAGS.FLG.WAIT

  20260  2 016204   202124 236100                    LDQ     IND2,,AUTO
         2 016205   000020 316007                    CANQ    16,DL
         2 016206   016331 600000 2                  TZE     s:20285

     3329    20261    2         THEN
     3330    20262    3             DO ;

     3331    20263    3               INBUFF = ',  Wait ' ;

  20263  2 016207   040100 100400                    MLR     fill='040'O
         2 016210   001625 000010 1                  ADSC9   CONSTCLS+407             cn=0,n=8
         2 016211   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3332    20264    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 8)

  20264  2 016212   000113 236000 3                  LDQ     75
         2 016213   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016214   200034 630500                    EPPR0   IN$,,AUTO
         2 016215   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016216   200035 631500                    EPPR1   DEST$,,AUTO
         2 016217   202353 451500                    STP1    CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:515  
         2 016220   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016221   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016222   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016223   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016224   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016225   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3333    20265    3                   ALTRET(DISPNOTIFY_ALT) ;
     3334    20266    3               IF CP_CHFLAGS.WAIT_DONE

  20266  2 016226   202123 236100                    LDQ     COUNTER2+2,,AUTO
         2 016227   200000 316007                    CANQ    65536,DL
         2 016230   016251 600000 2                  TZE     s:20275

     3335    20267    3                 THEN
     3336    20268    4                   DO ;

     3337    20269    4                     INBUFF = 'Done ' ;

  20269  2 016231   040100 100400                    MLR     fill='040'O
         2 016232   001627 000005 1                  ADSC9   CONSTCLS+409             cn=0,n=5
         2 016233   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3338    20270    4                     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 5)

  20270  2 016234   000110 236000 3                  LDQ     72
         2 016235   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016236   200034 630500                    EPPR0   IN$,,AUTO
         2 016237   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016240   200035 631500                    EPPR1   DEST$,,AUTO
         2 016241   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016242   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016243   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016244   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016245   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016246   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016247   017046 702000 2                  TSX2    DISPNOTIFY_ALT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:516  

     3339    20271    4                           ALTRET(DISPNOTIFY_ALT) ;
     3340    20272    4                   END ; /* Then Do */

  20272  2 016250   016270 710000 2                  TRA     s:20279

     3341    20273    3                 ELSE
     3342    20274    4                   DO ;

     3343    20275    4                     INBUFF = 'Print ' ;

  20275  2 016251   040100 100400                    MLR     fill='040'O
         2 016252   001631 000006 1                  ADSC9   CONSTCLS+411             cn=0,n=6
         2 016253   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3344    20276    4                     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 6)

  20276  2 016254   000052 236000 3                  LDQ     42
         2 016255   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016256   200034 630500                    EPPR0   IN$,,AUTO
         2 016257   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016260   200035 631500                    EPPR1   DEST$,,AUTO
         2 016261   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016262   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016263   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016264   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016265   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016266   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016267   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3345    20277    4                           ALTRET(DISPNOTIFY_ALT) ;
     3346    20278    4                   END ; /* Else Do */

     3347    20279    3               IND1 = CP_CHFLAGS.WAIT_INT ;

  20279  2 016270   202125 235100                    LDA     TEMP,,AUTO
         2 016271   202126 236100                    LDQ     UC_FLG,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:517  
         2 016272   000022 773000                    LRL     18
         2 016273   200015 756100                    STQ     IND1,,AUTO

     3348    20280    3               CALL BINCHAR(WAIT_INT,IND1) ;

  20280  2 016274   000000 235003                    LDA     0,DU
         2 016275   202352 757100                    STAQ    CLSDCB+30,,AUTO
         2 016276   000100 301500                    BTD
         2 016277   202352 000010                    NDSC9   CLSDCB+30,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 016300   202264 030003                    NDSC9   WAIT_INT,,AUTO           cn=0,s=nosgn,sf=0,n=3

     3349    20281    3               CALL CPE$RZEROS(WAIT_INT, SIZEC(WAIT_INT), IND1) ;

  20281  2 016301   200015 630500                    EPPR0   IND1,,AUTO
         2 016302   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016303   000055 236000 3                  LDQ     45
         2 016304   202353 756100                    STQ     CLSDCB+31,,AUTO
         2 016305   202264 631500                    EPPR1   WAIT_INT,,AUTO
         2 016306   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 016307   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016310   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 016311   000000 701000 xent               TSX1    CPE$RZEROS
         2 016312   000000 011000                    NOP     0

     3350    20282    3               CALL CPB$BLDIMAGE(OUTBUFF$,DEST$,ADDR(WAIT_INT),IND1)

  20282  2 016313   202264 630500                    EPPR0   WAIT_INT,,AUTO
         2 016314   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 016315   200015 631500                    EPPR1   IND1,,AUTO
         2 016316   202357 451500                    STP1    CLSDCB+35,,AUTO
         2 016317   202352 633500                    EPPR3   CLSDCB+30,,AUTO
         2 016320   202356 453500                    STP3    CLSDCB+34,,AUTO
         2 016321   200035 634500                    EPPR4   DEST$,,AUTO
         2 016322   202355 454500                    STP4    CLSDCB+33,,AUTO
         2 016323   200036 635500                    EPPR5   OUTBUFF$,,AUTO
         2 016324   202354 455500                    STP5    CLSDCB+32,,AUTO
         2 016325   202354 630500                    EPPR0   CLSDCB+32,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:518  
         2 016326   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016327   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016330   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3351    20283    3                       ALTRET(DISPNOTIFY_ALT) ;
     3352    20284    3             END ; /* Then Do */

     3353    20285    2     IF OUTBUFF ~= ' '

  20285  2 016331   040000 106500                    CMPC    fill='040'O
         2 016332   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512
         2 016333   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 016334   016363 600000 2                  TZE     s:20293

     3354    20286    2         THEN
     3355    20287    3             DO ;

     3356    20288    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND=POFFC(DEST$,OUTBUFF$) ;

  20288  2 016335   000000 470400 xsym               LDP0    SEG2$
         2 016336   000165 471500                    LDP1    117,,PR0
         2 016337   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 016340   000020 772000                    QRL     16
         2 016341   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016342   200035 236100                    LDQ     DEST$,,AUTO
         2 016343   000020 772000                    QRL     16
         2 016344   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 016345   000020 736000                    QLS     16
         2 016346   100004 676100                    ERQ     4,,PR1
         2 016347   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 016350   100004 656100                    ERSQ    4,,PR1

     3357    20289    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$=OUTBUFF$ ;

  20289  2 016351   000165 471500                    LDP1    117,,PR0
         2 016352   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 016353   100005 756100                    STQ     5,,PR1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:519  

     3358    20290    3               CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;

  20290  2 016354   000000 236000 xsym               LDQ     SEG2$
         2 016355   000165 036003                    ADLQ    117,DU
         2 016356   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016357   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016360   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 016361   000000 701000 xent               TSX1    CPE$LISTOUT
         2 016362   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3359    20291    3             END ; /* Then Do */

     3360    20292
     3361    20293    2     OUTBUFF2 = ' ' ;

  20293  2 016363   040100 100400                    MLR     fill='040'O
         2 016364   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 016365   202223 000170                    ADSC9   OUTBUFF2,,AUTO           cn=0,n=120

     3362    20294    2     OUTBUFF2$ = ADDR(OUTBUFF2) ;

  20294  2 016366   202223 630500                    EPPR0   OUTBUFF2,,AUTO
         2 016367   202261 450500                    STP0    OUTBUFF2$,,AUTO

     3363    20295    2     DEST2$ = OUTBUFF2$ ;

  20295  2 016370   202261 236100                    LDQ     OUTBUFF2$,,AUTO
         2 016371   202262 756100                    STQ     DEST2$,,AUTO

     3364    20296
     3365    20297    2     OUTBUFF = '     Flags:' ;

  20297  2 016372   040100 100400                    MLR     fill='040'O
         2 016373   001633 000013 1                  ADSC9   CONSTCLS+413             cn=0,n=11
         2 016374   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:520  
     3366    20298    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = 10 ;

  20298  2 016375   000000 471400 xsym               LDP1    SEG2$
         2 016376   100165 473500                    LDP3    117,,PR1
         2 016377   300004 236100                    LDQ     4,,PR3
         2 016400   177777 376007                    ANQ     65535,DL
         2 016401   000141 276000 3                  ORQ     97
         2 016402   300004 756100                    STQ     4,,PR3

     3367    20299    2     SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF$ ;

  20299  2 016403   100165 470500                    LDP0    117,,PR1
         2 016404   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 016405   000005 756100                    STQ     5,,PR0

     3368    20300    2     CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;

  20300  2 016406   000000 236000 xsym               LDQ     SEG2$
         2 016407   000165 036003                    ADLQ    117,DU
         2 016410   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016411   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016412   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 016413   000000 701000 xent               TSX1    CPE$LISTOUT
         2 016414   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3369    20301    2     DEST$ = OUTBUFF$ ;

  20301  2 016415   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 016416   200035 756100                    STQ     DEST$,,AUTO

     3370    20302              /* Setup Set and Reset in respective buffers */
     3371    20303    2     TAB_VAL = 7 ;

  20303  2 016417   000007 235007                    LDA     7,DL
         2 016420   200474 755100                    STA     TAB_VAL,,AUTO

     3372    20304    2     INBUFF = 'Set:' ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:521  

  20304  2 016421   040100 100400                    MLR     fill='040'O
         2 016422   001450 000004 1                  ADSC9   CONSTCLS+298             cn=0,n=4
         2 016423   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3373    20305    2     CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 4, TAB_VAL) ALTRET(DISPNOTIFY_ALT) ;

  20305  2 016424   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 016425   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 016426   000103 236000 3                  LDQ     67
         2 016427   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016430   200034 631500                    EPPR1   IN$,,AUTO
         2 016431   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 016432   200035 633500                    EPPR3   DEST$,,AUTO
         2 016433   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 016434   200036 634500                    EPPR4   OUTBUFF$,,AUTO
         2 016435   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 016436   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016437   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 016440   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016441   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3374    20306    2     INBUFF = 'Reset:' ;

  20306  2 016442   040100 100400                    MLR     fill='040'O
         2 016443   001452 000006 1                  ADSC9   CONSTCLS+300             cn=0,n=6
         2 016444   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3375    20307    2     CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 6, TAB_VAL) ALTRET(DISPNOTIFY_ALT) ;

  20307  2 016445   200474 630500                    EPPR0   TAB_VAL,,AUTO
         2 016446   202356 450500                    STP0    CLSDCB+34,,AUTO
         2 016447   000052 236000 3                  LDQ     42
         2 016450   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016451   200034 631500                    EPPR1   IN$,,AUTO
         2 016452   202354 451500                    STP1    CLSDCB+32,,AUTO
         2 016453   202262 633500                    EPPR3   DEST2$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:522  
         2 016454   202353 453500                    STP3    CLSDCB+31,,AUTO
         2 016455   202261 634500                    EPPR4   OUTBUFF2$,,AUTO
         2 016456   202352 454500                    STP4    CLSDCB+30,,AUTO
         2 016457   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016460   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 016461   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016462   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3376    20308    2     IF CP_CHFLAGS.SYSTEM

  20308  2 016463   202123 236100                    LDQ     COUNTER2+2,,AUTO
         2 016464   400000 316007                    CANQ    -131072,DL
         2 016465   016506 600000 2                  TZE     s:20316

     3377    20309    2         THEN
     3378    20310    3             DO ;

     3379    20311    3               INBUFF = ' System,' ;

  20311  2 016466   040100 100400                    MLR     fill='040'O
         2 016467   001636 000010 1                  ADSC9   CONSTCLS+416             cn=0,n=8
         2 016470   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3380    20312    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;

  20312  2 016471   000113 236000 3                  LDQ     75
         2 016472   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016473   200034 630500                    EPPR0   IN$,,AUTO
         2 016474   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016475   200035 631500                    EPPR1   DEST$,,AUTO
         2 016476   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016477   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016500   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016501   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016502   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016503   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016504   017046 702000 2                  TSX2    DISPNOTIFY_ALT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:523  

     3381    20313    3             END ;

  20313  2 016505   016525 710000 2                  TRA     s:20319

     3382    20314    2         ELSE
     3383    20315    3             DO ;

     3384    20316    3               INBUFF = ' System,' ;

  20316  2 016506   040100 100400                    MLR     fill='040'O
         2 016507   001636 000010 1                  ADSC9   CONSTCLS+416             cn=0,n=8
         2 016510   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3385    20317    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;

  20317  2 016511   000113 236000 3                  LDQ     75
         2 016512   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016513   200034 630500                    EPPR0   IN$,,AUTO
         2 016514   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016515   202262 631500                    EPPR1   DEST2$,,AUTO
         2 016516   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016517   202261 633500                    EPPR3   OUTBUFF2$,,AUTO
         2 016520   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016521   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016522   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016523   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016524   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3386    20318    3             END ;

     3387    20319    2     IF CP_CHFLAGS.FLG.TERM

  20319  2 016525   202124 236100                    LDQ     IND2,,AUTO
         2 016526   040000 316007                    CANQ    16384,DL
         2 016527   016550 600000 2                  TZE     s:20327

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:524  
     3388    20320    2         THEN
     3389    20321    3             DO ;

     3390    20322    3               INBUFF = ' Terminal,' ;

  20322  2 016530   040100 100400                    MLR     fill='040'O
         2 016531   001640 000012 1                  ADSC9   CONSTCLS+418             cn=0,n=10
         2 016532   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3391    20323    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 10) ALTRET(DISPNOTIFY_ALT) ;

  20323  2 016533   000051 236000 3                  LDQ     41
         2 016534   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016535   200034 630500                    EPPR0   IN$,,AUTO
         2 016536   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016537   200035 631500                    EPPR1   DEST$,,AUTO
         2 016540   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016541   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016542   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016543   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016544   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016545   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016546   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3392    20324    3             END ;

  20324  2 016547   016567 710000 2                  TRA     s:20330

     3393    20325    2         ELSE
     3394    20326    3             DO ;

     3395    20327    3               INBUFF = ' Terminal,' ;

  20327  2 016550   040100 100400                    MLR     fill='040'O
         2 016551   001640 000012 1                  ADSC9   CONSTCLS+418             cn=0,n=10
         2 016552   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:525  
     3396    20328    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 10) ALTRET(DISPNOTIFY_ALT) ;

  20328  2 016553   000051 236000 3                  LDQ     41
         2 016554   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016555   200034 630500                    EPPR0   IN$,,AUTO
         2 016556   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016557   202262 631500                    EPPR1   DEST2$,,AUTO
         2 016560   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016561   202261 633500                    EPPR3   OUTBUFF2$,,AUTO
         2 016562   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016563   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016564   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016565   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016566   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3397    20329    3             END ;

     3398    20330    2     IF CP_CHFLAGS.FLG.INPUT

  20330  2 016567   202124 236100                    LDQ     IND2,,AUTO
         2 016570   020000 316007                    CANQ    8192,DL
         2 016571   016612 600000 2                  TZE     s:20338

     3399    20331    2         THEN
     3400    20332    3             DO ;

     3401    20333    3               INBUFF = ' Input,' ;

  20333  2 016572   040100 100400                    MLR     fill='040'O
         2 016573   001643 000007 1                  ADSC9   CONSTCLS+421             cn=0,n=7
         2 016574   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3402    20334    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 7) ALTRET(DISPNOTIFY_ALT) ;

  20334  2 016575   000053 236000 3                  LDQ     43
         2 016576   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016577   200034 630500                    EPPR0   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:526  
         2 016600   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016601   200035 631500                    EPPR1   DEST$,,AUTO
         2 016602   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016603   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016604   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016605   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016606   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016607   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016610   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3403    20335    3             END ;

  20335  2 016611   016631 710000 2                  TRA     s:20341

     3404    20336    2         ELSE
     3405    20337    3             DO ;

     3406    20338    3               INBUFF = ' Input,' ;

  20338  2 016612   040100 100400                    MLR     fill='040'O
         2 016613   001643 000007 1                  ADSC9   CONSTCLS+421             cn=0,n=7
         2 016614   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3407    20339    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 7) ALTRET(DISPNOTIFY_ALT) ;

  20339  2 016615   000053 236000 3                  LDQ     43
         2 016616   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016617   200034 630500                    EPPR0   IN$,,AUTO
         2 016620   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016621   202262 631500                    EPPR1   DEST2$,,AUTO
         2 016622   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016623   202261 633500                    EPPR3   OUTBUFF2$,,AUTO
         2 016624   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016625   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016626   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016627   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016630   017046 702000 2                  TSX2    DISPNOTIFY_ALT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:527  

     3408    20340    3             END ;

     3409    20341    2     IF CP_CHFLAGS.FLG.OUTPUT

  20341  2 016631   202124 236100                    LDQ     IND2,,AUTO
         2 016632   010000 316007                    CANQ    4096,DL
         2 016633   016654 600000 2                  TZE     s:20349

     3410    20342    2         THEN
     3411    20343    3             DO ;

     3412    20344    3               INBUFF = ' Output,' ;

  20344  2 016634   040100 100400                    MLR     fill='040'O
         2 016635   001645 000010 1                  ADSC9   CONSTCLS+423             cn=0,n=8
         2 016636   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3413    20345    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;

  20345  2 016637   000113 236000 3                  LDQ     75
         2 016640   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016641   200034 630500                    EPPR0   IN$,,AUTO
         2 016642   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016643   200035 631500                    EPPR1   DEST$,,AUTO
         2 016644   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016645   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016646   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016647   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016650   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016651   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016652   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3414    20346    3             END ;

  20346  2 016653   016673 710000 2                  TRA     s:20352

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:528  
     3415    20347    2         ELSE
     3416    20348    3             DO ;

     3417    20349    3               INBUFF = ' Output,' ;

  20349  2 016654   040100 100400                    MLR     fill='040'O
         2 016655   001645 000010 1                  ADSC9   CONSTCLS+423             cn=0,n=8
         2 016656   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3418    20350    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 8) ALTRET(DISPNOTIFY_ALT) ;

  20350  2 016657   000113 236000 3                  LDQ     75
         2 016660   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016661   200034 630500                    EPPR0   IN$,,AUTO
         2 016662   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016663   202262 631500                    EPPR1   DEST2$,,AUTO
         2 016664   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016665   202261 633500                    EPPR3   OUTBUFF2$,,AUTO
         2 016666   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016667   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016670   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016671   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016672   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3419    20351    3             END ;

     3420    20352    2     IF CP_CHFLAGS.FLG.RUNNING

  20352  2 016673   202124 236100                    LDQ     IND2,,AUTO
         2 016674   004000 316007                    CANQ    2048,DL
         2 016675   016716 600000 2                  TZE     s:20360

     3421    20353    2         THEN
     3422    20354    3             DO ;

     3423    20355    3               INBUFF = ' Running,' ;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:529  
  20355  2 016676   040100 100400                    MLR     fill='040'O
         2 016677   001647 000011 1                  ADSC9   CONSTCLS+425             cn=0,n=9
         2 016700   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3424    20356    3               CALL CPB$BLDIMAGE(OUTBUFF$, DEST$, IN$, 9) ALTRET(DISPNOTIFY_ALT) ;

  20356  2 016701   000124 236000 3                  LDQ     84
         2 016702   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016703   200034 630500                    EPPR0   IN$,,AUTO
         2 016704   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016705   200035 631500                    EPPR1   DEST$,,AUTO
         2 016706   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016707   200036 633500                    EPPR3   OUTBUFF$,,AUTO
         2 016710   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016711   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016712   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016713   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016714   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3425    20357    3             END ;

  20357  2 016715   016735 710000 2                  TRA     s:20364

     3426    20358    2         ELSE
     3427    20359    3             DO ;

     3428    20360    3               INBUFF = ' Running,' ;

  20360  2 016716   040100 100400                    MLR     fill='040'O
         2 016717   001647 000011 1                  ADSC9   CONSTCLS+425             cn=0,n=9
         2 016720   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3429    20361    3               CALL CPB$BLDIMAGE(OUTBUFF2$, DEST2$, IN$, 9) ALTRET(DISPNOTIFY_ALT) ;

  20361  2 016721   000124 236000 3                  LDQ     84
         2 016722   202355 756100                    STQ     CLSDCB+33,,AUTO
         2 016723   200034 630500                    EPPR0   IN$,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:530  
         2 016724   202354 450500                    STP0    CLSDCB+32,,AUTO
         2 016725   202262 631500                    EPPR1   DEST2$,,AUTO
         2 016726   202353 451500                    STP1    CLSDCB+31,,AUTO
         2 016727   202261 633500                    EPPR3   OUTBUFF2$,,AUTO
         2 016730   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 016731   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016732   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 016733   000000 701000 xent               TSX1    CPB$BLDIMAGE
         2 016734   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3430    20362    3             END ;

     3431    20363                      /* If any flags Set, then output buffer. */
     3432    20364    2     LEN = POFFC(DEST$,OUTBUFF$) ;

  20364  2 016735   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 016736   000020 772000                    QRL     16
         2 016737   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016740   200035 236100                    LDQ     DEST$,,AUTO
         2 016741   000020 772000                    QRL     16
         2 016742   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 016743   202263 756100                    STQ     LEN,,AUTO

     3433    20365    2     IF LEN>(SIZEC('Set:')+TAB_VAL)

  20365  2 016744   200474 236100                    LDQ     TAB_VAL,,AUTO
         2 016745   000004 036007                    ADLQ    4,DL
         2 016746   016751 604000 2                  TMI     s:20368
         2 016747   202263 116100                    CMPQ    LEN,,AUTO
         2 016750   016773 603000 2                  TRC     s:20374

     3434    20366    2         THEN
     3435    20367    3             DO ;

     3436    20368    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = LEN-2 ;

  20368  2 016751   000000 470400 xsym               LDP0    SEG2$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:531  
         2 016752   000165 471500                    LDP1    117,,PR0
         2 016753   202263 236100                    LDQ     LEN,,AUTO
         2 016754   000002 136007                    SBLQ    2,DL
         2 016755   000020 736000                    QLS     16
         2 016756   100004 676100                    ERQ     4,,PR1
         2 016757   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 016760   100004 656100                    ERSQ    4,,PR1

     3437    20369    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF$ ;

  20369  2 016761   000165 471500                    LDP1    117,,PR0
         2 016762   200036 236100                    LDQ     OUTBUFF$,,AUTO
         2 016763   100005 756100                    STQ     5,,PR1

     3438    20370    3               CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;

  20370  2 016764   000000 236000 xsym               LDQ     SEG2$
         2 016765   000165 036003                    ADLQ    117,DU
         2 016766   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016767   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 016770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 016771   000000 701000 xent               TSX1    CPE$LISTOUT
         2 016772   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3439    20371    3             END ; /* Then Do */

     3440    20372
     3441    20373                      /* If any flags Reset, then output buffer. */
     3442    20374    2     LEN = POFFC(DEST2$,OUTBUFF2$) ;

  20374  2 016773   202261 236100                    LDQ     OUTBUFF2$,,AUTO
         2 016774   000020 772000                    QRL     16
         2 016775   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 016776   202262 236100                    LDQ     DEST2$,,AUTO
         2 016777   000020 772000                    QRL     16
         2 017000   202352 136100                    SBLQ    CLSDCB+30,,AUTO
         2 017001   202263 756100                    STQ     LEN,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:532  

     3443    20375    2     IF LEN>(SIZEC('Reset:')+TAB_VAL)

  20375  2 017002   200474 236100                    LDQ     TAB_VAL,,AUTO
         2 017003   000006 036007                    ADLQ    6,DL
         2 017004   017007 604000 2                  TMI     s:20378
         2 017005   202263 116100                    CMPQ    LEN,,AUTO
         2 017006   017031 603000 2                  TRC     DISPNOTIFY_RET

     3444    20376    2         THEN
     3445    20377    3             DO ;

     3446    20378    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BOUND = LEN-2 ;

  20378  2 017007   000000 470400 xsym               LDP0    SEG2$
         2 017010   000165 471500                    LDP1    117,,PR0
         2 017011   202263 236100                    LDQ     LEN,,AUTO
         2 017012   000002 136007                    SBLQ    2,DL
         2 017013   000020 736000                    QLS     16
         2 017014   100004 676100                    ERQ     4,,PR1
         2 017015   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 017016   100004 656100                    ERSQ    4,,PR1

     3447    20379    3               SEG$2.FPT_WRITE$->FPT$WRITE.BUF_.BUF$ = OUTBUFF2$ ;

  20379  2 017017   000165 471500                    LDP1    117,,PR0
         2 017020   202261 236100                    LDQ     OUTBUFF2$,,AUTO
         2 017021   100005 756100                    STQ     5,,PR1

     3448    20380    3               CALL CPE$LISTOUT(SEG$2.FPT_WRITE$) ALTRET(DISPNOTIFY_ALT) ;

  20380  2 017022   000000 236000 xsym               LDQ     SEG2$
         2 017023   000165 036003                    ADLQ    117,DU
         2 017024   202352 756100                    STQ     CLSDCB+30,,AUTO
         2 017025   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 017026   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 017027   000000 701000 xent               TSX1    CPE$LISTOUT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:533  
         2 017030   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3449    20381    3             END ; /* Then Do */

     3450    20382
     3451    20383    2   DISPNOTIFY_RET:
     3452    20384    2     RETURN ;

  20384  2 017031   202072 221300       DISPNOTIFY_* LDX1  ! VLP_SN+4,,AUTO
         2 017032   000001 702211                    TSX2  ! 1,X1

     3453    20385
     3454    20386    2   DISPNOTIFY_ERR:
     3455    20387    2     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#

  20387  2 017033   000102 473400 3     DISPNOTIFY_* LDP3    66
         2 017034   300000 474500                    LDP4    0,,PR3
         2 017035   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 017036   400000 475510                    LDP5    0,X0,PR4
         2 017037   500031 236100                    LDQ     25,,PR5
         2 017040   020000 316007                    CANQ    8192,DL
         2 017041   017046 600000 2                  TZE     DISPNOTIFY_ALT

     3456    20388    2         THEN
     3457    20389    2             CALL M$CLOSE(FPT_CLOSE) ALTRET(DISPNOTIFY_ALT) ;

  20389  2 017042   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 017043   450001 713400                    CLIMB   alt,close
         2 017044   406000 401760                    pmme    nvectors=13
         2 017045   017046 702000 2                  TSX2    DISPNOTIFY_ALT

     3458    20390
     3459    20391    2   DISPNOTIFY_ALT:
     3460    20392    2     ALTRETURN ;

  20392  2 017046   202072 221300       DISPNOTIFY_* LDX1  ! VLP_SN+4,,AUTO
         2 017047   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:534  

     3461    20393
     3462    20394    2   END   DISPNOTIFY ;
     3463    20395        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:535  
     3464    20396        /**********************************************************************/
     3465    20397        /*I*   NAME:   DISPWHEN
     3466    20398               PURPOSE: Display the WHEN command record from the *S file.
     3467    20399               CALL:   CALL DISPWHEN
     3468    20400               INTERFACE: CPC$WRITEMSGE,CPE$LISTOUT,CPB$BLDIMAGE,CPJ$READ_S, CPC$OPEN_S
     3469    20401               INPUT:
     3470    20402               OUTPUT: The WHEN command from the *S WHEN record.
     3471    20403               DESCRIPTION: The WHEN command in the *S WHEN record is displayed
     3472    20404                       on the listing device.
     3473    20405        */
     3474    20406        /**********************************************************************/
     3475    20407    1   DISPWHEN: PROC ALTRET ;

  20407  2 017050   202072 741300       DISPWHEN     STX1  ! VLP_SN+4,,AUTO

     3476    20408
     3477    20409    2     INBUFF = '   When: %Q' ;

  20409  2 017051   040100 100400                    MLR     fill='040'O
         2 017052   001652 000013 1                  ADSC9   CONSTCLS+428             cn=0,n=11
         2 017053   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3478    20410    2     F_FDS = CF_FDS ;

  20410  2 017054   000100 100400                    MLR     fill='000'O
         2 017055   000317 000170 1                  ADSC9   CF_FDS                   cn=0,n=120
         2 017056   200513 000170                    ADSC9   F_FDS,,AUTO              cn=0,n=120

     3479    20411    2     F_FDS.OUTPUT# = ENTADDR(CPK$FDS_OUTPUT) ;

  20411  2 017057   000000 636000 xent               EAQ     CPK$FDS_OUTPUT
         2 017060   200527 756100                    STQ     F_FDS+12,,AUTO

     3480    20412    2     F_FDS.VECTR$ = ADDR(FMT_VEC(0)) ;

  20412  2 017061   200551 630500                    EPPR0   FMT_VEC,,AUTO
         2 017062   200525 450500                    STP0    F_FDS+10,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:536  

     3481    20413    2     F_FDS.BUF_ = VECTOR(OUTBUFF) ;

  20413  2 017063   000046 235000 3                  LDA     38
         2 017064   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 017065   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017066   000237 036003                    ADLQ    159,DU
         2 017067   200520 757100                    STAQ    F_FDS+5,,AUTO

     3482    20414    2     F_FDS.FMT_ = VECTOR(INBUFF) ;

  20414  2 017070   000046 235000 3                  LDA     38
         2 017071   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 017072   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017073   000037 036003                    ADLQ    31,DU
         2 017074   200513 755100                    STA     F_FDS,,AUTO
         2 017075   200514 756100                    STQ     F_FDS+1,,AUTO

     3483    20415    2     FMT_VEC = '0'B ;

  20415  2 017076   000100 100400                    MLR     fill='000'O
         2 017077   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 017100   200551 000300                    ADSC9   FMT_VEC,,AUTO            cn=0,n=192

     3484    20416    2     OUTBUFF = ' ' ;

  20416  2 017101   040100 100400                    MLR     fill='040'O
         2 017102   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 017103   200237 001000                    ADSC9   OUTBUFF,,AUTO            cn=0,n=512

     3485    20417    2     CALL CPC$OPEN_LL ;

  20417  2 017104   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 017105   000000 701000 xent               TSX1    CPC$OPEN_LL
         2 017106   000000 011000                    NOP     0

     3486    20418    2     IF B$JIT.CPFLAGS1.WHEN_INPUT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:537  

  20418  2 017107   000000 470400 xsym               LDP0    B$JIT$
         2 017110   000143 236100                    LDQ     99,,PR0
         2 017111   000400 316003                    CANQ    256,DU
         2 017112   017323 600000 2                  TZE     WHEN_NONE

     3487    20419    2         THEN
     3488    20420    3             DO ;

     3489    20421    3               FPT_CLOSE = CFPT_CLOSE;

  20421  2 017113   000100 100400                    MLR     fill='000'O
         2 017114   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 017115   201676 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

     3490    20422    3               FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V);

  20422  2 017116   000003 235000 3                  LDA     3
         2 017117   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 017120   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017121   001730 036003                    ADLQ    984,DU
         2 017122   201676 757100                    STAQ    FPT_CLOSE,,AUTO

     3491    20423    3               FPT_CLOSE.V.DISP# = %SAVE# ;

  20423  2 017123   000002 236007                    LDQ     2,DL
         2 017124   201730 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

     3492    20424    3               FPT_CLOSE.V.DCB# = M$IBEX1_NUM ;

  20424  2 017125   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 017126   201730 740100                    STX0    FPT_CLOSE+26,,AUTO

     3493    20425    3               CALL CPG$GET_WHEN_CNTL_REC(WHEN_CNTL_REC_CHANGED, STAR_S_IS_OPEN)

  20425  2 017127   200025 631500                    EPPR1   STAR_S_IS_OPEN,,AUTO
         2 017130   202353 451500                    STP1    CLSDCB+31,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:538  
         2 017131   200024 633500                    EPPR3   WHEN_CNTL_REC_CHANGED,,AUTO
         2 017132   202352 453500                    STP3    CLSDCB+30,,AUTO
         2 017133   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 017134   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 017135   000000 701000 xent               TSX1    CPG$GET_WHEN_CNTL_REC
         2 017136   017337 702000 2                  TSX2    DISPWHEN_ALT

     3494    20426    3                                                            ALTRET(DISPWHEN_ALT) ;
     3495    20427    3               IF SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(SEG$2.WHEN_CNTL_REC$

  20427  2 017137   000000 470400 xsym               LDP0    SEG2$
         2 017140   000175 471500                    LDP1    125,,PR0
         2 017141   100000 236100                    LDQ     0,,PR1
         2 017142   000022 772000                    QRL     18
         2 017143   000777 376007                    ANQ     511,DL
         2 017144   000003 402007                    MPY     3,DL
         2 017145   003100 061506                    CSR     bolr='003'O
         2 017146   100001 000002                    BDSC    1,Q,PR1                  by=0,bit=0,n=2
         2 017147   202352 000044                    BDSC    CLSDCB+30,,AUTO          by=0,bit=0,n=36
         2 017150   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017151   000002 116007                    CMPQ    2,DL
         2 017152   017166 600000 2                  TZE     s:20433
         2 017153   000175 471500                    LDP1    125,,PR0
         2 017154   100000 236100                    LDQ     0,,PR1
         2 017155   000022 772000                    QRL     18
         2 017156   000777 376007                    ANQ     511,DL
         2 017157   000003 402007                    MPY     3,DL
         2 017160   003100 061506                    CSR     bolr='003'O
         2 017161   100001 000002                    BDSC    1,Q,PR1                  by=0,bit=0,n=2
         2 017162   202353 000044                    BDSC    CLSDCB+31,,AUTO          by=0,bit=0,n=36
         2 017163   202353 236100                    LDQ     CLSDCB+31,,AUTO
         2 017164   000000 116003                    CMPQ    0,DU
         2 017165   017176 601000 2                  TNZ     s:20439

     3496    20428    3                                          ->WHEN$CNTL_REC.STATE_LEV) = %WHEN_DONT#
     3497    20429    3                 OR SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(SEG$2.WHEN_CNTL_REC$
     3498    20430    3                                          ->WHEN$CNTL_REC.STATE_LEV) = %WHEN_NONE#
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:539  
     3499    20431    3                 THEN
     3500    20432    4                   DO ;

     3501    20433    4                     IF STAR_S_IS_OPEN

  20433  2 017166   200025 234100                    SZN     STAR_S_IS_OPEN,,AUTO
         2 017167   017175 605000 2                  TPL     s:20437

     3502    20434    4                       THEN
     3503    20435    5                         CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;

  20435  2 017170   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 017171   450001 713400                    CLIMB   alt,close
         2 017172   406000 401760                    pmme    nvectors=13
         2 017173   017175 702000 2                  TSX2    s:20437
         2 017174   017175 710000 2                  TRA     s:20437

     3504    20436    5                                                               END ;

     3505    20437    4                     GOTO WHEN_NONE ;

  20437  2 017175   017323 710000 2                  TRA     WHEN_NONE

     3506    20438    4                   END ; /* Then Do */
     3507    20439    3               F_FDS.NVECS# = 0 ;

  20439  2 017176   200524 450100                    STZ     F_FDS+9,,AUTO

     3508    20440    3               CALL X$FORMAT(F_FDS) ;

  20440  2 017177   200513 631500                    EPPR1   F_FDS,,AUTO
         2 017200   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 017201   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 017202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 017203   000000 701000 xent               TSX1    X$FORMAT
         2 017204   000000 011000                    NOP     0

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:540  
     3509    20441    3               K_WHEN = CK_WHEN ;

  20441  2 017205   000100 100400                    MLR     fill='000'O
         2 017206   000356 000006 1                  ADSC9   CK_WHEN                  cn=0,n=6
         2 017207   201652 000006                    ADSC9   K_WHEN,,AUTO             cn=0,n=6

     3510    20442    3               K_WHEN.NUM = SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV ;

  20442  2 017210   000000 470400 xsym               LDP0    SEG2$
         2 017211   000175 471500                    LDP1    125,,PR0
         2 017212   100000 236100                    LDQ     0,,PR1
         2 017213   201653 552120                    STBQ    K_WHEN+1,'20'O,AUTO

     3511    20443    3               IF ~STAR_S_IS_OPEN

  20443  2 017214   200025 236100                    LDQ     STAR_S_IS_OPEN,,AUTO
         2 017215   400000 376003                    ANQ     -131072,DU
         2 017216   400000 676003                    ERQ     -131072,DU
         2 017217   017224 600000 2                  TZE     s:20446

     3512    20444    3                 THEN
     3513    20445    3                   CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(DISPWHEN_ALT);

  20445  2 017220   000006 630400 3                  EPPR0   6
         2 017221   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 017222   000000 701000 xent               TSX1    CPC$OPEN_S
         2 017223   017337 702000 2                  TSX2    DISPWHEN_ALT

     3514    20446    3               CALL CPJ$READ_S (M$IBEX1_NUM,VECTOR(K_WHEN),

  20446  2 017224   000023 235000 3                  LDA     19
         2 017225   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 017226   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017227   001652 036003                    ADLQ    938,DU
         2 017230   000000 470400 xsym               LDP0    SEG2$
         2 017231   000171 471500                    LDP1    121,,PR0
         2 017232   202354 757100                    STAQ    CLSDCB+32,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:541  
         2 017233   000444 235000 3                  LDA     292
         2 017234   202356 451500                    STP1    CLSDCB+34,,AUTO
         2 017235   202356 236100                    LDQ     CLSDCB+34,,AUTO
         2 017236   202362 757100                    STAQ    CLSDCB+38,,AUTO
         2 017237   202354 237100                    LDAQ    CLSDCB+32,,AUTO
         2 017240   202360 757100                    STAQ    CLSDCB+36,,AUTO
         2 017241   202362 237100                    LDAQ    CLSDCB+38,,AUTO
         2 017242   202364 757100                    STAQ    CLSDCB+40,,AUTO
         2 017243   202364 633500                    EPPR3   CLSDCB+40,,AUTO
         2 017244   202370 453500                    STP3    CLSDCB+44,,AUTO
         2 017245   202360 634500                    EPPR4   CLSDCB+36,,AUTO
         2 017246   202367 454500                    STP4    CLSDCB+43,,AUTO
         2 017247   000006 236000 3                  LDQ     6
         2 017250   202366 756100                    STQ     CLSDCB+42,,AUTO
         2 017251   202366 630500                    EPPR0   CLSDCB+42,,AUTO
         2 017252   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 017253   000000 701000 xent               TSX1    CPJ$READ_S
         2 017254   017337 702000 2                  TSX2    DISPWHEN_ALT

     3515    20447    3                           VECTOR(SEG$2.CPBUFF$->CP$BUFF)) ALTRET(DISPWHEN_ALT) ;
     3516    20448    3               TEMP = DCBADDR(M$IBEX1_NUM) -> F$DCB.ARS# ;

  20448  2 017255   000102 470400 3                  LDP0    66
         2 017256   000000 471500                    LDP1    0,,PR0
         2 017257   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 017260   100000 473510                    LDP3    0,X0,PR1
         2 017261   300000 235100                    LDA     0,,PR3
         2 017262   200014 755100                    STA     TEMP,,AUTO

     3517    20449    3               TVAL = DCBADDR(SEG$2.LLDCB#) -> F$DCB.WIDTH# ;

  20449  2 017263   000000 474400 xsym               LDP4    SEG2$
         2 017264   400000 721100                    LXL1    0,,PR4
         2 017265   100000 475511                    LDP5    0,X1,PR1
         2 017266   500004 236100                    LDQ     4,,PR5
         2 017267   000777 376007                    ANQ     511,DL
         2 017270   200013 756100                    STQ     TVAL,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:542  

     3518    20450    3               IF TVAL ~= 0

  20450  2 017271   017301 600000 2                  TZE     s:20453

     3519    20451    3                 THEN
     3520    20452    3                   F_FDS.BUF_ = VECTOR(SUBSTR(OUTBUFF,0,TVAL-1)) ;

  20452  2 017272   200013 235100                    LDA     TVAL,,AUTO
         2 017273   000020 735000                    ALS     16
         2 017274   200140 135007                    SBLA    65632,DL
         2 017275   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 017276   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017277   000237 036003                    ADLQ    159,DU
         2 017300   200520 757100                    STAQ    F_FDS+5,,AUTO

     3521    20453    4               CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;

  20453  2 017301   201676 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 017302   450001 713400                    CLIMB   alt,close
         2 017303   406000 401760                    pmme    nvectors=13
         2 017304   017306 702000 2                  TSX2    s:20455
         2 017305   017306 710000 2                  TRA     s:20455

     3522    20454    4                                                   END ;

     3523    20455    3               FMT_VEC(0) = VECTOR(SEG$2.CPBUFF$->CP$BUFF) ;

  20455  2 017306   000000 470400 xsym               LDP0    SEG2$
         2 017307   000171 471500                    LDP1    121,,PR0
         2 017310   000444 235000 3                  LDA     292
         2 017311   202352 451500                    STP1    CLSDCB+30,,AUTO
         2 017312   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017313   200551 755100                    STA     FMT_VEC,,AUTO
         2 017314   200552 756100                    STQ     FMT_VEC+1,,AUTO

     3524    20456    3               F_FDS.NVECS# = 1 ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:543  

  20456  2 017315   000001 235007                    LDA     1,DL
         2 017316   200524 755100                    STA     F_FDS+9,,AUTO

     3525    20457    3               INBUFF = '     %>A%Q' ;

  20457  2 017317   040100 100400                    MLR     fill='040'O
         2 017320   001655 000012 1                  ADSC9   CONSTCLS+431             cn=0,n=10
         2 017321   200037 001000                    ADSC9   INBUFF,,AUTO             cn=0,n=512

     3526    20458    3             END ; /* Then Do */

  20458  2 017322   017327 710000 2                  TRA     s:20465

     3527    20459    2         ELSE
     3528    20460    3             DO ;

     3529    20461    3   WHEN_NONE:
     3530    20462    3               F_FDS.NVECS# = 0 ;

  20462  2 017323   200524 450100       WHEN_NONE    STZ     F_FDS+9,,AUTO

     3531    20463    3               CALL INSERT(INBUFF, 9, , 'none%Q') ;

  20463  2 017324   040100 100400                    MLR     fill='040'O
         2 017325   001660 000006 1                  ADSC9   CONSTCLS+434             cn=0,n=6
         2 017326   200041 200767                    ADSC9   INBUFF+2,,AUTO           cn=1,n=503

     3532    20464    3             END ; /* Else Do */

     3533    20465    2     CALL X$FORMAT(F_FDS) ;

  20465  2 017327   200513 630500                    EPPR0   F_FDS,,AUTO
         2 017330   202352 450500                    STP0    CLSDCB+30,,AUTO
         2 017331   202352 630500                    EPPR0   CLSDCB+30,,AUTO
         2 017332   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 017333   000000 701000 xent               TSX1    X$FORMAT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:544  
         2 017334   000000 011000                    NOP     0

     3534    20466    2     RETURN ;

  20466  2 017335   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 017336   000001 702211                    TSX2  ! 1,X1

     3535    20467
     3536    20468    2   DISPWHEN_ALT:
     3537    20469    3     CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO ;

  20469  2 017337   201676 630500       DISPWHEN_ALT EPPR0   FPT_CLOSE,,AUTO
         2 017340   450001 713400                    CLIMB   alt,close
         2 017341   406000 401760                    pmme    nvectors=13
         2 017342   017344 702000 2                  TSX2    s:20471
         2 017343   017344 710000 2                  TRA     s:20471

     3538    20470    3                                           END ;

     3539    20471    2     ALTRETURN ;

  20471  2 017344   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 017345   000000 702211                    TSX2  ! 0,X1

     3540    20472
     3541    20473    2   END   DISPWHEN ;
     3542    20474        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:545  
     3543    20475    1   FIND_OR_CREATE_STREAM: PROC(RES#, CREATE_FLG, DCB#, OPEN_FLG) ALTRET;

  20475  2 017346   202072 741300       FIND_OR_CRE* STX1  ! VLP_SN+4,,AUTO

     3544    20476        /*
     3545    20477            FIND_OR_CREATE_STREAM will first try to locate a DCB directed to that
     3546    20478              stream.  If it locates a DCB that is open it returns the DCB# to the
     3547    20479              calling routine (OPEN_FLG has been reset, this routine did not open
     3548    20480              the DCB).  If it locates a DCB that is not open, it opens the DCB to
     3549    20481              the stream, sets OPEN_FLG, and returns the DCB# to calling routine.
     3550    20482              If it does not locate a DCB, it will look to see if the CREATE_FLG is
     3551    20483              set.  If it is not, FIND_OR_CREATE_STREAM will ALTRETURN.  Otherwise,
     3552    20484              FIND_AND_CREATE_STREAM will open the DCB with res=RES#, set OPEN_FLG,
     3553    20485              and return the DCB# to the calling routine.
     3554    20486
     3555    20487              If RES# is just a 2 character device name, ie 'UC, then the CREATE_FLG
     3556    20488              is ignored.
     3557    20489        */
     3558    20490        /*
     3559    20491          *** Parameters
     3560    20492        */
     3561    20493    2   DCL RES# CHAR(4);
     3562    20494    2   DCL 1 RES#_R REDEF RES#,
     3563    20495    2         2 DEV CHAR(2),
     3564    20496    2         2 NUM CHAR(2);
     3565    20497    2   DCL CREATE_FLG BIT(1) ALIGNED;
     3566    20498    2   DCL DCB# UBIN WORD;
     3567    20499    2   DCL OPEN_FLG BIT(1) ALIGNED;
     3568    20500
     3569    20501        /*
     3570    20502          *** Auto
     3571    20503        */
     3572    20504    2   DCL I UBIN WORD ;
     3573    20505    2   DCL K UBIN ;
     3574    20506    2   DCL GOT_STREAM BIT(1);
     3575    20507    2   DCL IGNORE_CREATE_FLG BIT(1);
     3576    20508    2   DCL DCBTAB$ PTR ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:546  
     3577    20509    2   DCL DCB$ PTR;
     3578    20510        %FPT_OPEN(FPTN=OPNDCB,STCLASS=);
     3579    20619        /*
     3580    20620          *** Constant
     3581    20621        */
     3582    20622        %FPT_OPEN(FPTN=CONSTOPN,STCLASS=CONSTANT,ASN=DEVICE,FUN=CREATE);
     3583    20731        /**/
     3584    20732    2           OPEN_FLG = %NO# ;

  20732  2 017347   202076 470500                    LDP0    @OPEN_FLG,,AUTO
         2 017350   000000 450100                    STZ     0,,PR0

     3585    20733    2           GOT_STREAM = %NO#;

  20733  2 017351   202101 450100                    STZ     GOT_STREAM,,AUTO

     3586    20734    2           DCBTAB$ = B$ROS$->B$ROSEG.DCBPTR$ ;

  20734  2 017352   000000 471400 xsym               LDP1    B$ROS$
         2 017353   100000 236100                    LDQ     0,,PR1
         2 017354   202103 756100                    STQ     DCBTAB$,,AUTO

     3587    20735    2           K = B$ROS$->B$ROSEG.NUMDCBS ;

  20735  2 017355   100002 236100                    LDQ     2,,PR1
         2 017356   000022 772000                    QRL     18
         2 017357   202100 756100                    STQ     K,,AUTO

     3588    20736    2           IF RES#_R.NUM = ' '

  20736  2 017360   202073 473500                    LDP3    @RES#,,AUTO
         2 017361   040000 106500                    CMPC    fill='040'O
         2 017362   300000 400002                    ADSC9   0,,PR3                   cn=2,n=2
         2 017363   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 017364   017370 601000 2                  TNZ     s:20740

     3589    20737    2           THEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:547  
     3590    20738    2             IGNORE_CREATE_FLG = %YES#;

  20738  2 017365   400000 236003                    LDQ     -131072,DU
         2 017366   202102 756100                    STQ     IGNORE_CREATE_FLG,,AUTO
         2 017367   017371 710000 2                  TRA     s:20745

     3591    20739    2           ELSE
     3592    20740    2             IGNORE_CREATE_FLG = %NO#;

  20740  2 017370   202102 450100                    STZ     IGNORE_CREATE_FLG,,AUTO

     3593    20741        /*
     3594    20742              First look for a dcb open to the specified stream,
     3595    20743              failing locating one, open a dcb to that stream.
     3596    20744        */
     3597    20745    3           DO I=2 TO K-1 ;

  20745  2 017371   000002 235007                    LDA     2,DL
         2 017372   202077 755100                    STA     I,,AUTO
         2 017373   017445 710000 2                  TRA     s:20763+3

     3598    20746    3             IF DCBADDR(I)~=ADDR(NIL)

  20746  2 017374   000102 470400 3                  LDP0    66
         2 017375   000000 471500                    LDP1    0,,PR0
         2 017376   202077 720100                    LXL0    I,,AUTO
         2 017377   100000 236110                    LDQ     0,X0,PR1
         2 017400   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 017401   017436 600000 2                  TZE     s:20760

     3599    20747    3             THEN
     3600    20748    4               DO;

     3601    20749    4                 DCB$ = DCBADDR(I);

  20749  2 017402   202104 756100                    STQ     DCB$,,AUTO

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:548  
     3602    20750    4                IF B$ROS$->B$ROSEG.LDEVNAME(DCBADDR(I)->F$DCB.STR#) = RES# OR DCBADDR(
             20750                          I)->F$DCB.RES# = RES#

  20750  2 017403   100000 473510                    LDP3    0,X0,PR1
         2 017404   300077 721100                    LXL1    63,,PR3
         2 017405   000777 361003                    ANX1    511,DU
         2 017406   000000 635011                    EAA     0,X1
         2 017407   000020 771000                    ARL     16
         2 017410   000000 474400 xsym               LDP4    B$ROS$
         2 017411   202073 475500                    LDP5    @RES#,,AUTO
         2 017412   040100 106505                    CMPC    fill='040'O
         2 017413   400054 000004                    ADSC9   44,A,PR4                 cn=0,n=4
         2 017414   500000 000004                    ADSC9   0,,PR5                   cn=0,n=4
         2 017415   017422 600000 2                  TZE     s:20753
         2 017416   040100 106500                    CMPC    fill='040'O
         2 017417   300026 000004                    ADSC9   22,,PR3                  cn=0,n=4
         2 017420   500000 000004                    ADSC9   0,,PR5                   cn=0,n=4
         2 017421   017427 601000 2                  TNZ     s:20756

     3603    20751    4                 THEN
     3604    20752    5                   DO;

     3605    20753    5                     GOT_STREAM = %YES#;

  20753  2 017422   400000 236003                    LDQ     -131072,DU
         2 017423   202101 756100                    STQ     GOT_STREAM,,AUTO

     3606    20754    5                     DCB# = I;

  20754  2 017424   202075 476500                    LDP6    @DCB#,,AUTO
         2 017425   202077 235100                    LDA     I,,AUTO
         2 017426   600000 755100                    STA     0,,PR6

     3607    20755    5                   END; /* Then Do */

     3608    20756    4                 IF DCBADDR(I)->F$DCB.FCD# AND GOT_STREAM

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:549  
  20756  2 017427   300031 236100                    LDQ     25,,PR3
         2 017430   020000 316007                    CANQ    8192,DL
         2 017431   017436 600000 2                  TZE     s:20760
         2 017432   202101 234100                    SZN     GOT_STREAM,,AUTO
         2 017433   017436 605000 2                  TPL     s:20760

     3609    20757    4                 THEN
     3610    20758    4                   RETURN ;

  20758  2 017434   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 017435   000001 702211                    TSX2  ! 1,X1

     3611    20759    4               END; /* Then Do */
     3612    20760    3               IF GOT_STREAM

  20760  2 017436   202101 234100                    SZN     GOT_STREAM,,AUTO
         2 017437   017442 605000 2                  TPL     s:20763

     3613    20761    3                 THEN
     3614    20762    3                   I = K;  /* Get out of this loop */

  20762  2 017440   202100 235100                    LDA     K,,AUTO
         2 017441   202077 755100                    STA     I,,AUTO

     3615    20763    3           END ;                        /* Do I                               */

  20763  2 017442   202077 235100                    LDA     I,,AUTO
         2 017443   000001 035007                    ADLA    1,DL
         2 017444   202077 755100                    STA     I,,AUTO
         2 017445   202077 236100                    LDQ     I,,AUTO
         2 017446   202100 116100                    CMPQ    K,,AUTO
         2 017447   017374 602000 2                  TNC     s:20746

     3616    20764        /*
     3617    20765              No dcb open to this stream.  If we didn't find a dcb see if there
     3618    20766              is an LDEV defined.
     3619    20767        */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:550  
     3620    20768    2           IF NOT GOT_STREAM

  20768  2 017450   202101 234100                    SZN     GOT_STREAM,,AUTO
         2 017451   017472 604000 2                  TMI     s:20778

     3621    20769    2             THEN
     3622    20770    3               DO I = 0 TO 15;

  20770  2 017452   202077 450100                    STZ     I,,AUTO

     3623    20771    3                 IF B$ROS$->B$ROSEG.LDEVNAME(I) = RES#

  20771  2 017453   202077 235100                    LDA     I,,AUTO
         2 017454   000002 735000                    ALS     2
         2 017455   000000 470400 xsym               LDP0    B$ROS$
         2 017456   202073 471500                    LDP1    @RES#,,AUTO
         2 017457   040100 106505                    CMPC    fill='040'O
         2 017460   000054 000004                    ADSC9   44,A,PR0                 cn=0,n=4
         2 017461   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 017462   017465 601000 2                  TNZ     s:20774

     3624    20772    3                   THEN
     3625    20773    3                     IGNORE_CREATE_FLG = %YES#;

  20773  2 017463   400000 236003                    LDQ     -131072,DU
         2 017464   202102 756100                    STQ     IGNORE_CREATE_FLG,,AUTO

     3626    20774    3               END; /* Do I */

  20774  2 017465   202077 236100                    LDQ     I,,AUTO
         2 017466   000001 036007                    ADLQ    1,DL
         2 017467   202077 756100                    STQ     I,,AUTO
         2 017470   000020 116007                    CMPQ    16,DL
         2 017471   017453 602000 2                  TNC     s:20771

     3627    20775        /*
     3628    20776              If we do not have a stream, and we can not create one, then ALTRETURN.
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:551  
     3629    20777        */
     3630    20778    2           IF NOT (GOT_STREAM OR IGNORE_CREATE_FLG OR CREATE_FLG)

  20778  2 017472   202101 234100                    SZN     GOT_STREAM,,AUTO
         2 017473   017503 604000 2                  TMI     s:20781
         2 017474   202102 234100                    SZN     IGNORE_CREATE_FLG,,AUTO
         2 017475   017503 604000 2                  TMI     s:20781
         2 017476   202074 470500                    LDP0    @CREATE_FLG,,AUTO
         2 017477   000000 234100                    SZN     0,,PR0
         2 017500   017503 604000 2                  TMI     s:20781

     3631    20779    2           THEN /* We don't have one, and we are not allowed to create one. */
     3632    20780    2             ALTRETURN;

  20780  2 017501   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 017502   000000 702211                    TSX2  ! 0,X1

     3633    20781    2           OPNDCB = CONSTOPN;

  20781  2 017503   000100 100400                    MLR     fill='000'O
         2 017504   000704 000350 1                  ADSC9   CONSTOPN                 cn=0,n=232
         2 017505   202106 000350                    ADSC9   OPNDCB,,AUTO             cn=0,n=232

     3634    20782    2           OPNDCB.V_ = VECTOR(OPNDCB.V) ;

  20782  2 017506   000064 235000 3                  LDA     52
         2 017507   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 017510   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017511   002152 036003                    ADLQ    1130,DU
         2 017512   202106 757100                    STAQ    OPNDCB,,AUTO

     3635    20783    2           IF NOT GOT_STREAM

  20783  2 017513   202101 234100                    SZN     GOT_STREAM,,AUTO
         2 017514   017520 604000 2                  TMI     s:20786

     3636    20784    2           THEN   /* Need to use M$IBEX */
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:552  
     3637    20785    2             DCB# = M$IBEX1_NUM ;

  20785  2 017515   202075 470500                    LDP0    @DCB#,,AUTO
         2 017516   000000 235000 xsym               LDA     M$IBEX1_NUM
         2 017517   000000 755100                    STA     0,,PR0

     3638    20786    2           IF DCBADDR(DCB#)->F$DCB.FCD#

  20786  2 017520   000102 470400 3                  LDP0    66
         2 017521   000000 471500                    LDP1    0,,PR0
         2 017522   202075 473500                    LDP3    @DCB#,,AUTO
         2 017523   300000 720100                    LXL0    0,,PR3
         2 017524   100000 474510                    LDP4    0,X0,PR1
         2 017525   400031 236100                    LDQ     25,,PR4
         2 017526   020000 316007                    CANQ    8192,DL
         2 017527   017534 600000 2                  TZE     s:20789

     3639    20787    2             THEN
     3640    20788    2               CALL CLOSE_DCB(DCB#);

  20788  2 017530   202075 236100                    LDQ     @DCB#,,AUTO
         2 017531   202313 756100                    STQ     TBUFF+3,,AUTO
         2 017532   017561 701000 2                  TSX1    CLOSE_DCB
         2 017533   000000 011000                    NOP     0

     3641    20789    2           OPNDCB.V.DCB# = DCB#;

  20789  2 017534   202075 470500                    LDP0    @DCB#,,AUTO
         2 017535   000000 720100                    LXL0    0,,PR0
         2 017536   202152 740100                    STX0    I+14,,AUTO

     3642    20790    2           OPNDCB.V.RES# = RES#;

  20790  2 017537   202073 471500                    LDP1    @RES#,,AUTO
         2 017540   040100 100500                    MLR     fill='040'O
         2 017541   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 017542   202156 000004                    ADSC9   I+18,,AUTO               cn=0,n=4
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:553  

     3643    20791    2           OPNDCB.V.ASN# = %DEVICE# ;

  20791  2 017543   000003 236007                    LDQ     3,DL
         2 017544   202153 552104                    STBQ    I+15,'04'O,AUTO

     3644    20792    3           CALL M$OPEN(OPNDCB) WHENALTRETURN DO;

  20792  2 017545   202106 630500                    EPPR0   OPNDCB,,AUTO
         2 017546   450000 713400                    CLIMB   alt,open
         2 017547   410400 401760                    pmme    nvectors=18
         2 017550   017552 702000 2                  TSX2    s:20793
         2 017551   017554 710000 2                  TRA     s:20795

     3645    20793    3                                  ALTRETURN;

  20793  2 017552   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 017553   000000 702211                    TSX2  ! 0,X1

     3646    20794    3                                 END;
     3647    20795    2           OPEN_FLG = %YES# ;

  20795  2 017554   400000 236003                    LDQ     -131072,DU
         2 017555   202076 470500                    LDP0    @OPEN_FLG,,AUTO
         2 017556   000000 756100                    STQ     0,,PR0

     3648    20796    2           RETURN ;

  20796  2 017557   202072 221300                    LDX1  ! VLP_SN+4,,AUTO
         2 017560   000001 702211                    TSX2  ! 1,X1

     3649    20797
     3650    20798    2   END   FIND_OR_CREATE_STREAM;
     3651    20799        %EJECT ;
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:554  
     3652    20800    1   CLOSE_DCB: PROC(DCB#) ;

  20800  2 017561   202312 741300       CLOSE_DCB    STX1  ! TBUFF+2,,AUTO

     3653    20801
     3654    20802        /*
     3655    20803          *** Parameters
     3656    20804        */
     3657    20805    2   DCL DCB# UBIN WORD;
     3658    20806        /*
     3659    20807          *** Auto
     3660    20808        */
     3661    20809        %FPT_CLOSE(FPTN=CLSDCB,STCLASS=);
     3662    20851        /*
     3663    20852          *** Constant
     3664    20853        */
     3665    20854        %FPT_CLOSE(FPTN=CONSTCLS,STCLASS=CONSTANT,DISP=SAVE);
     3666    20896
     3667    20897    2           CLSDCB=CONSTCLS;

  20897  2 017562   000100 100400                    MLR     fill='000'O
         2 017563   000776 000170 1                  ADSC9   CONSTCLS                 cn=0,n=120
         2 017564   202314 000170                    ADSC9   CLSDCB,,AUTO             cn=0,n=120

     3668    20898    2           CLSDCB.V.DCB#=DCB#;

  20898  2 017565   202313 470500                    LDP0    @DCB#,,AUTO
         2 017566   000000 720100                    LXL0    0,,PR0
         2 017567   202346 740100                    STX0    CLSDCB+26,,AUTO

     3669    20899    2           CLSDCB.V_=VECTOR(CLSDCB.V);

  20899  2 017570   000003 235000 3                  LDA     3
         2 017571   202352 452500                    STP2    CLSDCB+30,,AUTO
         2 017572   202352 236100                    LDQ     CLSDCB+30,,AUTO
         2 017573   002346 036003                    ADLQ    1254,DU
         2 017574   202314 757100                    STAQ    CLSDCB,,AUTO
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:555  

     3670    20900    3           CALL M$CLOSE(CLSDCB) WHENALTRETURN DO;

  20900  2 017575   202314 630500                    EPPR0   CLSDCB,,AUTO
         2 017576   450001 713400                    CLIMB   alt,close
         2 017577   406000 401760                    pmme    nvectors=13
         2 017600   017602 702000 2                  TSX2    s:20902
         2 017601   017602 710000 2                  TRA     s:20902

     3671    20901    3                                  END ;

     3672    20902    2           RETURN ;

  20902  2 017602   202312 221300                    LDX1  ! TBUFF+2,,AUTO
         2 017603   000001 702211                    TSX2  ! 1,X1
     3673    20903    2   END   CLOSE_DCB ;
     3674    20904    1   END CPE$IBEX2;

PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:556  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CX_MACROS_M.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPE$IBEX2.
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:557  

 **** Variables and constants ****

  ****  Section 001 RoData CPE$IBEX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   474-0-0/c CHAR(7)     r     1 ACCESS_FLAGS(0:11)
   674-0-0/d STRC(288)   r     1 CFPT_TRMCTL              317-0-0/w STRC(1080)  r     1 CF_FDS
   356-0-0/d STRC(54)    r     1 CK_WHEN                  636-0-0/d STRC(1080)  r     1 CONSTCLS
   776-0-0/d STRC(1080)  r     1 CONSTCLS                 544-0-0/d STRC(2088)  r     1 CONSTOPN
   704-0-0/d STRC(2088)  r     1 CONSTOPN                   0-0-0/c CHAR(9)     r     1 CONTAB
   367-0-0/c CHAR(19)    r     1 DCBHDR                   374-0-0/c CHAR(24)    r     1 DCBNHDR
   402-0-0/c CHAR(24)    r     1 DISPHDR1                 360-0-0/w STRC        r     1 E_BADPASS
   362-0-0/w STRC        r     1 E_NOASGN                 365-0-0/w STRC        r     1 E_NOLDEVTHATTYPE
   364-0-0/w STRC        r     1 E_NOSUCHLDEV             363-0-0/w STRC        r     1 E_PASSCHNGE
   361-0-0/w STRC        r     1 E_QUIT
   366-0-0/c CHAR        r     1 FDCB_CHAR(0:0)
   410-0-0/w STRC(117)   r     1 FLAGS_TBL(0:12)
     3-0-0/c CHAR(20)    r     1 LDEVHDR                   10-0-0/c CHAR(25)    r     1 LDEVNHDR
    20-0-0/d STRC(45)    r     1 M$DODCB
   521-0-0/b BIT (9)     r     1 MOPS_7_2_STR(0:5)
    23-0-0/w STRC(144)   r     1 OPT_TBL(0:46)             22-0-0/w SBIN        r     1 OPT_TBLSZE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  2132-0-0/w PTR         r     1 @AMOPTN1$               2133-0-0/w PTR         r     1 @AMOPTN2$
  2074-0-0/w PTR         r     1 @CREATE_FLG             2075-0-0/w PTR         r     1 @DCB#
  2313-0-0/w PTR         r     1 @DCB#                   2075-0-0/w PTR         r     1 @DCB$
  2305-0-0/w PTR         r     1 @FLAG                   2306-0-0/w PTR         r     1 @KEYWD
  2305-0-0/w PTR         r     1 @KEYWDSZE               2307-0-0/w PTR         r     1 @KEYWDVAL
  2307-0-0/w PTR         r     1 @LENGTH                 2111-0-0/w PTR         r     1 @N
  2103-0-0/w PTR         r     1 @N                      2076-0-0/w PTR         r     1 @OPEN_FLG
  2112-0-0/w PTR         r     1 @OPT                    2104-0-0/w PTR         r     1 @OPT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:558  
  2131-0-0/w PTR         r     1 @OPTION                 2113-0-0/w PTR         r     1 @OPTLEN
  2105-0-0/w PTR         r     1 @OPTLEN                 2131-0-0/w PTR         r     1 @OPTN
  2132-0-0/w PTR         r     1 @OSZE                   2133-0-0/w PTR         r     1 @OTEXT$
     3-0-0/w PTR         r     1 @P$PCB                  2131-0-0/w PTR         r     1 @PMSN$
  2073-0-0/w PTR         r     1 @RES#                   2076-0-0/w PTR         r     1 @TAB_VAL
  2306-0-0/w PTR         r     1 @TEXT                    510-0-0/b BIT         r     1 ACTIVE_PRIVS
    *0-0-0/w PTR         r     1 AMOPTN1$                  *0-0-0/w PTR         r     1 AMOPTN2$
   470-0-0/w UBIN        r     1 ASN                      511-0-0/c STRC(45)    r     1 BAD_LDEV_NAME
  2106-0-0/c STRC(45)    r     1 BAD_LDEV_NAME              4-0-0/w PTR         r     1 BLK$
  2074-0-0/c CHAR(10)    r     1 CHR10                   2077-0-0/c CHAR(11)    r     1 CHR11
  2077-0-0/c CHAR        r     1 CHR11A(0:10)            2314-0-0/d STRC(1080)  r     1 CLSDCB
  2133-0-0/b BIT         r     1 CNTLS_A(0:17)           2116-0-0/c CHAR(12)    r     1 COUNTER1
  2121-0-0/c CHAR(12)    r     1 COUNTER2                 475-0-0/w UBIN        r     1 CPOS
  1654-0-0/w STRC(180)   r     1 CPSL_PARAM              2073-0-0/w STRC(3168)  r     1 CP_CHFLAGS
    *0-0-0/w BIT         r     1 CREATE_FLG                 7-0-0/w UBIN        r     1 DCB#
    *0-0-0/w UBIN        r     1 DCB#                      *0-0-0/w UBIN        r     1 DCB#
    10-0-0/w PTR         r     1 DCB$                      *0-0-0/w PTR         r     1 DCB$
  2114-0-0/w PTR         r     1 DCB$                    2104-0-0/w PTR         r     1 DCB$
    16-0-0/w UBIN        r     1 DCBSLOT                 2073-0-0/b BIT         r     1 DCBS_EXIST
  2307-0-0/w PTR         r     1 DCBTAB$                 2103-0-0/w PTR         r     1 DCBTAB$
   440-0-0/d STRC(288)   r     1 DCB_NAME
   440-0-0/d CHAR        r     1 DCB_NAMEA(0:31)
    35-0-0/w PTR         r     1 DEST$                   2262-0-0/w PTR         r     1 DEST2$
    23-0-0/b BIT         r     1 DILDEV_OPT              2077-0-0/c STRC(126)   r     1 ETMF
     6-0-0/w PTR         r     1 FID$                      *0-0-0/b BIT (2)     r     1 FLAG
  2073-0-0/b BIT         r     1 FLAGS_VAL(0:12)
   551-0-0/b BIT (72)    r     1 FMT_VEC(0:23)           2115-0-0/w PTR         r     1 FORM$
  1676-0-0/d STRC(1080)  r     1 FPT_CLOSE               1736-0-0/d STRC(360)   r     1 FPT_DEVICE
  1734-0-0/d STRC(72)    r     1 FPT_DISPLAY              632-0-0/d STRC(144)   r     1 FPT_DRIBBLE
  1750-0-0/d STRC(2088)  r     1 FPT_OPEN                2042-0-0/d STRC(504)   r     1 FPT_READ
  1662-0-0/d STRC(432)   r     1 FPT_TIME                2262-0-0/d STRC(288)   r     1 FPT_TRMCTL
  2060-0-0/d STRC(216)   r     1 FPT_TRMISC              2102-0-0/d STRC(792)   r     1 FPT_UNFID
   513-0-0/w STRC(1080)  r     1 F_FDS                   2101-0-0/b BIT         r     1 GOT_STREAM
   472-0-0/w UBIN        r     1 I                       2076-0-0/w UBIN        r     1 I
  2132-0-0/w SBIN        r     1 I                       2134-0-0/w SBIN        r     1 I
  2134-0-0/w SBIN        r     1 I                       2073-0-0/w SBIN        r     1 I
  2073-0-0/w UBIN        r     1 I                       2305-0-0/w UBIN        r     1 I
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:559  
  2077-0-0/w UBIN        r     1 I                       2102-0-0/b BIT         r     1 IGNORE_CREATE_FLG
    34-0-0/w PTR         r     1 IN$                       37-0-0/c CHAR(512)   r     1 INBUFF
    15-0-0/w UBIN        r     1 IND1                    2124-0-0/w UBIN        r     1 IND2
   473-0-0/w UBIN        r     1 J                       2077-0-0/w UBIN        r     1 J
  2074-0-0/w UBIN        r     1 J                       2306-0-0/w UBIN        r     1 K
  2100-0-0/w UBIN        r     1 K                         *0-0-0/c CHAR(10)    r     1 KEYWD
    *0-0-0/w UBIN        r     1 KEYWDSZE                  *0-0-0/w UBIN        r     1 KEYWDVAL
  1652-0-0/d STRC(54)    r     1 K_WHEN                    21-0-0/b BIT         r     1 LDEVS_EXIST
    22-0-0/b BIT         r     1 LDEVS_HDR_PRINTED        476-0-0/w SBIN        r     1 LEN
  2131-0-0/w SBIN        r     1 LEN                     2263-0-0/w UBIN        r     1 LEN
    *0-0-0/w UBIN        r     1 LENGTH                  1642-0-0/d STRC(252)   r     1 LOAD_VAR
   631-0-0/b BIT         r     1 MSGFLAG                 2075-0-0/w UBIN        r     1 N
    *0-0-0/w SBIN        r     1 N                         *0-0-0/w SBIN        r     1 N
  2074-0-0/b BIT         r     1 NEED_COMMA                32-0-0/w CHAR(8)     r     1 NEWPASSWORD
  2073-0-0/c STRC(126)   r     1 NR                        30-0-0/w CHAR(8)     r     1 OLDPASSWORD
     5-0-0/w PTR         r     1 ONOVERINTO$             2130-0-0/b BIT         r     1 OPEN
    *0-0-0/w BIT         r     1 OPEN_FLG                2106-0-0/d STRC(2088)  r     1 OPNDCB
  2132-0-0/d STRC(2088)  r     1 OPNMYDCB                2077-0-0/c CHAR(4)     r     1 OPT
    *0-0-0/c CHAR(4)     r     1 OPT                       *0-0-0/c CHAR(4)     r     1 OPT
    *0-0-0/w UBIN        r     1 OPTION                  2100-0-0/w UBIN        r     1 OPTLEN
    *0-0-0/w UBIN        r     1 OPTLEN                    *0-0-0/w UBIN        r     1 OPTLEN
    *0-0-0/w UBIN        r     1 OPTN                      *0-0-0/w UBIN        r     1 OSZE
    *0-0-0/w PTR         r     1 OTEXT$                   237-0-0/c CHAR(512)   r     1 OUTBUFF
    36-0-0/w PTR         r     1 OUTBUFF$                2223-0-0/c CHAR(120)   r     1 OUTBUFF2
  2261-0-0/w PTR         r     1 OUTBUFF2$                 *0-0-0/w STRC(504)   r     1 P$PCB
    *0-0-0/w PTR         r     1 PMSN$                    471-0-0/c CHAR(4)     r     1 RES
    20-0-0/c CHAR(4)     r     1 RES#                      *0-0-0/c CHAR(4)     r     1 RES#
    *0-0-0/c STRC        r     1 RES#_R                  2075-0-0/b BIT         r     1 SET_FLG
  2303-0-0/w UBIN        r     1 SIZ                       25-0-0/b BIT         r     1 STAR_S_IS_OPEN
  2073-0-0/c CHAR(3)     r     1 STEPCC                  2127-0-0/w UBIN        r     1 STREAM
    17-0-0/b BIT         r     1 STREAM_OPEN              506-0-0/c CHAR(6)     r     1 SYSID
  2100-0-0/w UBIN        r     1 TAB2_VAL                 474-0-0/w SBIN        r     1 TAB_VAL
    *0-0-0/w SBIN        r     1 TAB_VAL                 2077-0-0/c CHAR(6)     r     1 TBUFF
  2310-0-0/c CHAR(6)     r     1 TBUFF                     14-0-0/w UBIN        r     1 TEMP
  2125-0-0/w UBIN        r     1 TEMP                      11-0-0/w PTR         r     1 TEMP$
    12-0-0/w PTR         r     1 TEMP1$                  2076-0-0/w PTR         r     1 TEMP2$
    14-0-0/w STRC        r     1 TEMPO                     *0-0-0/c ACHR        r     1 TEXT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:560  
   477-0-0/c STRC(234)   r     1 TMDATE                   477-0-0/c CHAR(26)    r     1 TMDATEBUFF
    13-0-0/w SBIN        r     1 TVAL                    2126-0-0/b BIT         r     1 UC_FLG
   450-0-0/c CHAR(64)    r     1 UNFID                   2073-0-0/c CHAR(3)     r     1 USRNUM
  2066-0-0/d STRC(90)    r     1 VLP_SN                  2272-0-0/d STRC(288)   r     1 VLP_WINDOW
  2264-0-0/c CHAR(3)     r     1 WAIT_INT
    24-0-0/b BIT         r     1 WHEN_CNTL_REC_CHANGED

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$ROS$
     0-0-0/w PTR         r     1 B$ROS$                     0-0-0/w PTR         r     1 B$SR_NON_BLANK$
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d STRC(1080)  r     1 CFPT_CLOSE
     0-0-0/d STRC(360)   r     1 CFPT_DEVICE                0-0-0/d STRC(72)    r     1 CFPT_DISPLAY
     0-0-0/d STRC(144)   r     1 CFPT_DRIBBLE               0-0-0/d STRC(2088)  r     1 CFPT_OPEN
     0-0-0/d STRC(504)   r     1 CFPT_READ                  0-0-0/d STRC(432)   r     1 CFPT_TIME
     0-0-0/d STRC(216)   r     1 CFPT_TRMISC                0-0-0/d STRC(792)   r     1 CFPT_UNFID
     0-0-0/d STRC(432)   r     1 CFPT_WRITE                 0-0-0/c STRC(63)    r     1 K_NOTIFY
     0-0-0/d STRC(27)    r     1 LISTDCB                    0-0-0/w UBIN        r     1 M$IBEX1_NUM
     0-0-0/w UBIN        r     1 M$UC_NUM                   0-0-0/w PTR         r     1 SEG2$
     0-0-0/w PTR         r     1 SEG3$                      0-0-0/c STRC(27)    r     1 STARA

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(72)    r     1 AM$ACCT                    0-0-0/d STRC(72)    r     1 AM$ALTKEYS
     0-0-0/c STRC(54)    r     1 AM$FORM                    0-0-0/d STRC(612)   r     1 AM$FPRG
     0-0-0/w ASTR(45)    r     1 AM$HDR                     0-0-0/c STRC(288)   r     1 AM$NAME
     0-0-0/w STRC(432)   r     1 AM$SETSTA                  0-0-0/d STRC(2736)  r     1 AM$SN
     0-0-0/w STRC(288)   r     1 AM$TAB                     0-0-0/w STRC(432)   r     1 AM$VIRTUAL
     0-0-0/d STRC(288)   r     1 AM$WINDOW                  0-0-0/c STRC(72)    r     1 AM$WSN
     0-0-0/d STRC(1440)  r     1 AMR$REC$                   0-0-0/w STRC(2448)  r     1 B$EXCFR
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(3024)  r     1 B$ROSEG
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:561  
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/b BIT         r     1 BIT$1
     0-0-0/b BIT (2)     r     1 BIT$2                      0-0-0/b BIT         r     1 CNTLS(0:17)
     0-0-0/w STRC(288)   r     1 CODE14                     0-0-0/w STRC(1404)  r     1 CODE16
     0-0-0/w CHAR(256)   r     1 CP$BUFF                    0-0-0/w STRC(828)   r     1 ERR$BLK
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(432)   r     1 FPT$WRITE
     0-0-0/w STRC(6084)  r     1 KL$DREC                    0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S
     0-0-0/w STRC(6264)  r     1 SEG$2                      0-0-0/d STRC(4608)  r     1 SRCHTBL
     0-0-0/c ASTR(9)     r     1 TEXTC                      0-0-0/c ASTR(0)     r     1 VARY$STRNG
     0-0-0/c ACHR        r     1 VARY$STRNG                 0-0-0/c STRC(90)    r     1 VLP$ACCESS
     0-0-0/c ASTR(27)    r     1 VLP$ACSVEH                 0-0-0/w STRC        r     1 VLP$ATTR
     0-0-0/w ASTR(45)    r     1 VLP$HDR                    0-0-0/d STRC(333)   r     1 WHEN$CNTL_REC


   Procedure CPE$IBEX2 requires 8068 words for executable code.
   Procedure CPE$IBEX2 requires 1320 words of local(AUTO) storage.

    No errors detected in file CPE$IBEX2.:E05TSI    .
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:562  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:563  
          MINI XREF LISTING

ACCESS_FLAGS IN PROCEDURE DISP_PMSN
     18901**DCL     18909>>ASSIGN
ACTIVE_PRIVS
     14374**DCL     17475<<ASSIGN  17493>>ASSIGN  17525>>ASSIGN
ALTRETUR IN PROCEDURE DILDEV
     19697**LABEL   19692--CALLALT
AM$ACCT
     15287**DCL     17683--ASSIGN
AM$ALTKEYS.K.KEYL#
     15440**DCL     18496>>ASSIGN
AM$ALTKEYS.K.KEYX#
     15440**DCL     18494>>ASSIGN
AM$ALTKEYS.K.UNIQUE#
     15439**DCL     18498>>IF
AM$ALTKEYS.SIZ#
     15439**DCL     18493>>DOINDEX 18505>>IF
AM$FORM.FORM# IN PROCEDURE DISPDCB
     17637**DCL     18251>>CALLBLT
AM$FPRG.ACCT#
     15424**DCL     18520--ASSIGN
AM$FPRG.NAME
     15423**DCL     18519--ASSIGN
AM$FPRG.PASS#
     15425**DCL     18521--ASSIGN
AM$FPRG.PSN#
     15423**DCL     18522>>IF      18527>>ASSIGN
AM$HDR.CTL.COUNT# IN PROCEDURE DISPDCB
     17623**DCL     18201>>IF      18204>>ASSIGN
AM$HDR.CTL.HEADERHEIGHT# IN PROCEDURE DISPDCB
     17622**DCL     18187>>IF      18190>>ASSIGN
AM$HDR.CTL.INDENT# IN PROCEDURE DISPDCB
     17622**DCL     18194>>IF      18197>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:564  
AM$HDR.CTL.RESETPAGE# IN PROCEDURE DISPDCB
     17621**DCL     18221>>IF
AM$HDR.TITL.L# IN PROCEDURE DISPDCB
     17623**DCL     17624--IMP-SIZ 18208>>IF      18214>>ASSIGN
AM$HDR.TITL.TITLE# IN PROCEDURE DISPDCB
     17624**DCL     18215--CALL
AM$NAME
     15274**DCL     17680--ASSIGN
AM$SETSTA.ISTA.DIRONLY#
     15334**DCL     18404--CALL
AM$SETSTA.ISTA.EOFNONE#
     15333**DCL     18406--CALL
AM$SETSTA.ISTA.EOFONE#
     15333**DCL     18408--CALL
AM$SETSTA.ISTA.EOFTIME#
     15335**DCL     18410>>ASSIGN
AM$SETSTA.ISTA.ILATCH#
     15332**DCL     18415--CALL
AM$SETSTA.ISTA.ILOCK#
     15332**DCL     18417--CALL
AM$SETSTA.ISTA.IMSGTYP#
     15332**DCL     18419--CALL    18419--CALL
AM$SETSTA.ISTA.ISTATION#
     15331**DCL     18422--CALL    18422--CALL
AM$SETSTA.MYSTATION#
     15331**DCL     18425--CALL    18425--CALL
AM$SETSTA.OSTA.ALLDCBS#
     15338**DCL     18398--CALL
AM$SETSTA.OSTA.ALLTRMS#
     15338**DCL     18400--CALL
AM$SETSTA.OSTA.ANYDCB#
     15339**DCL     18402--CALL
AM$SETSTA.OSTA.OLATCH#
     15337**DCL     18428--CALL
AM$SETSTA.OSTA.OLOCK#
     15337**DCL     18430--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:565  
AM$SETSTA.OSTA.OMSGTYP#
     15336**DCL     18432--CALL    18432--CALL
AM$SETSTA.OSTA.OSTATION#
     15336**DCL     18435--CALL    18435--CALL
AM$SETSTA.OSTA.WAS#
     15340**DCL     18438--CALL
AM$SN.NUM#
     15300**DCL     17687>>ASSIGN
AM$TAB.MARGIN# IN PROCEDURE DISPDCB
     17607**DCL     18146>>IF      18149>>ASSIGN
AM$TAB.TABS# IN PROCEDURE DISPDCB
     17607**DCL     18155>>IF      18163>>IF      18166>>CALLBLT
AM$VIRTUAL.INITIALIZE#
     15354**DCL     18445--CALL
AM$VIRTUAL.INITVALUE#
     15356**DCL     18447>>ASSIGN
AM$VIRTUAL.MINPHYS#
     15357**DCL     18452>>ASSIGN
AM$VIRTUAL.NOFILE#
     15354**DCL     18457--CALL
AM$VIRTUAL.PHYSICAL#
     15357**DCL     18459>>ASSIGN
AM$VIRTUAL.SEGNUM#
     15355**DCL     18464>>DOCASE
AM$VIRTUAL.SEGSIZE#
     15356**DCL     18477>>ASSIGN
AM$WINDOW.BTMBRDR#
     15397**DCL     18051--CALL
AM$WINDOW.FWINDOW#
     15381**DCL     15381--REDEF   15382--REDEF   18000>>IF      18002>>CALLBLT
AM$WINDOW.HBRDRCHR#
     15398**DCL     18075>>IF      18077>>CALLBLT
AM$WINDOW.HBRDRSIZ#
     15398**DCL     18070>>ASSIGN
AM$WINDOW.LENGTH#
     15395**DCL     18027>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:566  
AM$WINDOW.LFTBRDR#
     15399**DCL     18066--CALL
AM$WINDOW.MINLENGTH#
     15400**DCL     18032>>ASSIGN
AM$WINDOW.MINWIDTH#
     15401**DCL     18042>>ASSIGN
AM$WINDOW.POSITION#
     15395**DCL     18007>>DOCASE
AM$WINDOW.REMOVABLE#
     15402**DCL     18047--CALL
AM$WINDOW.RHTBRDR#
     15399**DCL     18068--CALL
AM$WINDOW.TOPBRDR#
     15397**DCL     18049--CALL
AM$WINDOW.VBRDRCHR#
     15400**DCL     18058>>IF      18060>>CALLBLT
AM$WINDOW.VBRDRSIZ#
     15399**DCL     18053>>ASSIGN
AM$WINDOW.WIDTH#
     15395**DCL     18037>>ASSIGN
AM$WSN
     15313**DCL     17692--ASSIGN
AMOPTN1$ IN PROCEDURE DISP_OPT_YESNO
     18938**DCL     18935--PROC    18944--IF      18944>>IF      18962--IF      18965>>IF
AMOPTN2$ IN PROCEDURE DISP_OPT_YESNO
     18939**DCL     18935--PROC    18944--IF      18975>>IF
AMR$REC$.ACCESS_
     16162**DCL     18085>>IF      18088>>ASSIGN  18089>>ASSIGN
AMR$REC$.ACCT_
     16164**DCL     17681>>IF      17683>>ASSIGN
AMR$REC$.ACSVEH_
     16162**DCL     16163--REDEF   17972>>IF      17978>>ASSIGN  17979>>ASSIGN  17995>>CALL    17999>>ASSIGN
AMR$REC$.ALTKEYS_
     16168**DCL     16169--REDEF   16169--REDEF   18486>>IF      18493>>DOINDEX 18494>>ASSIGN  18496>>ASSIGN
     18498>>IF      18505>>IF
AMR$REC$.FORM_
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:567  
     16168**DCL     18248>>IF      18251>>CALLBLT
AMR$REC$.FPRG_
     16169**DCL     18519>>ASSIGN  18520>>ASSIGN  18521>>ASSIGN  18522>>IF      18527>>ASSIGN
AMR$REC$.HDR_
     16167**DCL     16168--REDEF   18184>>IF      18187>>IF      18190>>ASSIGN  18194>>IF      18197>>ASSIGN
     18201>>IF      18204>>ASSIGN  18208>>IF      18214>>ASSIGN  18215>>CALL    18221>>IF
AMR$REC$.NAME_
     16161**DCL     17678>>IF      17680>>ASSIGN
AMR$REC$.SETSTA_
     16161**DCL     18394>>IF      18398>>CALL    18400>>CALL    18402>>CALL    18404>>CALL    18406>>CALL
     18408>>CALL    18410>>ASSIGN  18415>>CALL    18417>>CALL    18419>>CALL    18419>>CALL    18422>>CALL
     18422>>CALL    18425>>CALL    18425>>CALL    18428>>CALL    18430>>CALL    18432>>CALL    18432>>CALL
     18435>>CALL    18435>>CALL    18438>>CALL
AMR$REC$.SN_
     16160**DCL     17684>>IF      17687>>ASSIGN  17688>>ASSIGN
AMR$REC$.TAB_
     16166**DCL     16167--REDEF   18142>>IF      18146>>IF      18149>>ASSIGN  18155>>IF      18163>>IF
     18166>>CALLBLT
AMR$REC$.UHL_
     16160**DCL     16161--REDEF   16161--REDEF
AMR$REC$.V.ACS#
     16180**DCL     17862>>IF      17867>>DOCASE
AMR$REC$.V.ANSISPANSEQ#
     16193**DCL     18107--CALL
AMR$REC$.V.ASN#
     16179**DCL     17693--ASSIGN  17974>>DOCASE  18396>>DOCASE  18488>>DOCASE
AMR$REC$.V.AU#
     16198**DCL     18364--CALL
AMR$REC$.V.BLKL#
     16186**DCL     17881>>IF      17884>>ASSIGN
AMR$REC$.V.BLOCKED#
     16181**DCL     18106--CALL
AMR$REC$.V.BUPM#
     16182**DCL     18290--CALL
AMR$REC$.V.CNVRT#
     16189**DCL     18115--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:568  
AMR$REC$.V.COMP#
     16181**DCL     18230--CALL
AMR$REC$.V.COPIES#
     16201**DCL     18259>>IF      18262>>ASSIGN
AMR$REC$.V.CTG#
     16173**DCL     18182--CALL
AMR$REC$.V.CVOL#
     16174**DCL     18280--CALL
AMR$REC$.V.DCBCONLGL#
     16191**DCL     18365>>IF      18367--CALL
AMR$REC$.V.DENSITY#
     16201**DCL     17895>>IF      17900>>DOCASE
AMR$REC$.V.DISP#
     16185**DCL     17846>>IF      17851>>DOCASE
AMR$REC$.V.DVFC#
     16196**DCL     18240>>IF      18243>>CALLBLT
AMR$REC$.V.EBCDIC#
     16189**DCL     18110>>IF      18113--CALL
AMR$REC$.V.EVENT#
     16199**DCL     18384>>IF      18387>>ASSIGN
AMR$REC$.V.EXIST#
     16173**DCL     17742>>IF      17747>>DOCASE
AMR$REC$.V.EXPIRE#
     16189**DCL     17917>>IF      17922>>IF      17931>>CALLBLT
AMR$REC$.V.FSN#
     16200**DCL     16200--REDEF   16200--REDEF   18292>>IF      18295>>ASSIGN
AMR$REC$.V.FUN#
     16179**DCL     17704>>IF      17709>>DOCASE
AMR$REC$.V.GHSTACS#
     16184**DCL     18376>>IF      18379>>ASSIGN
AMR$REC$.V.IGNOREFSN#
     16193**DCL     18540--CALL
AMR$REC$.V.INITZ.SCRUB#
     16170**DCL     17700>>IF      17702--CALL
AMR$REC$.V.IOERROK#
     16191**DCL     18541--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:569  
AMR$REC$.V.IXTNSIZE#
     16188**DCL     18134>>IF      18137>>ASSIGN
AMR$REC$.V.JRNLBYPASS#
     16183**DCL     18371--CALL
AMR$REC$.V.KEYL#
     16185**DCL     17944>>IF      17947>>ASSIGN
AMR$REC$.V.KEYX#
     16184**DCL     17937>>IF      17940>>ASSIGN
AMR$REC$.V.LINES#
     16199**DCL     18282>>IF      18285>>ASSIGN
AMR$REC$.V.LOAD#
     16183**DCL     18369--CALL
AMR$REC$.V.LRDL0#
     16187**DCL     17965>>IF      17968>>ASSIGN
AMR$REC$.V.LSLIDE#
     16186**DCL     17958>>IF      17961>>ASSIGN
AMR$REC$.V.LSTAOR#
     16183**DCL     18370--CALL
AMR$REC$.V.MAXVOL#
     16195**DCL     18273>>IF      18276>>ASSIGN
AMR$REC$.V.NRECS#
     16188**DCL     18119>>IF      18122>>ASSIGN
AMR$REC$.V.ORG#
     16180**DCL     17761>>IF      17766>>DOCASE
AMR$REC$.V.QISS#
     16198**DCL     18368--CALL
AMR$REC$.V.RECL#
     16186**DCL     17888>>IF      17891>>ASSIGN
AMR$REC$.V.RES#
     16184**DCL     17694--ASSIGN
AMR$REC$.V.SEEDSPECIFIED#
     16193**DCL     18542>>IF      18544--CALL
AMR$REC$.V.SEQ#
     16197**DCL     18301>>IF      18304--CALL
AMR$REC$.V.SEQCOL#
     16197**DCL     18305>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:570  
AMR$REC$.V.SEQID#
     16199**DCL     18308>>IF      18311>>CALLBLT
AMR$REC$.V.SHARE#
     16174**DCL     17723>>IF      17728>>DOCASE
AMR$REC$.V.SPANNED#
     16182**DCL     18109--CALL
AMR$REC$.V.SPARE#
     16187**DCL     17951>>IF      17954>>ASSIGN
AMR$REC$.V.TERMCONLGL#
     16192**DCL     18372>>IF      18374--CALL
AMR$REC$.V.TYPE#
     16181**DCL     18232>>IF      18235>>CALLBLT
AMR$REC$.V.UOPT#
     16179**DCL     18322>>IF      18327>>IF
AMR$REC$.V.VOL#
     16194**DCL     18267>>IF      18270>>ASSIGN
AMR$REC$.V.VOLACCESS#
     16198**DCL     18346>>IF      18351>>DOCASE
AMR$REC$.V.XTEND#
     16190**DCL     18289--CALL
AMR$REC$.V.XTNSIZE#
     16188**DCL     18126>>IF      18129>>ASSIGN
AMR$REC$.VIRTUAL_
     16161**DCL     18445>>CALL    18447>>ASSIGN  18452>>ASSIGN  18457>>CALL    18459>>ASSIGN  18464>>DOCASE
     18477>>ASSIGN
AMR$REC$.WSN_
     16166**DCL     16166--REDEF   17690>>IF      17692>>ASSIGN
AS$USERS.BANNER_PERM
     15199**DCL     15200--REDEF
AS$USERS.BUDGET.MACCT
     15104**DCL     15108--REDEF
AS$USERS.BUDGET.MAX_PROJECTS
     15117**DCL     15120--REDEF
AS$USERS.BUDGET.PACCUM
     15100**DCL     15102--REDEF
AS$USERS.BUDGET.PMAXC
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:571  
     15095**DCL     15097--REDEF
AS$USERS.SETUP_CHRA.TXT
     15215**DCL     15216--REDEF   15217--REDEF
ASN
     14351**DCL     18532--ASSIGN  18533<<ASSIGN
ASZ$SCRAMBLE
     14691**DCL-ENT 17230--CALL    17231--CALL
AS_USERS.BANNER_PERM
     14824**DCL     14825--REDEF
AS_USERS.BUDGET.MACCT
     14729**DCL     14733--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     14742**DCL     14745--REDEF
AS_USERS.BUDGET.PACCUM
     14725**DCL     14727--REDEF
AS_USERS.BUDGET.PMAXC
     14720**DCL     14722--REDEF
AS_USERS.SETUP_CHRA.TXT
     14840**DCL     14841--REDEF   14842--REDEF
B$EXCFR.ASL
     14934**DCL     14934--REDEF
B$EXCFR.ERR
     14948**DCL     16991>>ASSIGN  17278>>ASSIGN  17529>>ASSIGN  18557>>ASSIGN
B$EXCFR.ERR.ERR#
     14948**DCL     14948--REDEF   20206>>IF
B$EXCFR.EVID
     14947**DCL     14947--REDEF   14948--REDEF
B$EXCFR.IR
     14935**DCL     14935--REDEF
B$EXCFR.PREVSZ
     14934**DCL     14934--REDEF
B$EXCFR.SUBC
     14946**DCL     14946--REDEF   14947--REDEF   14947--REDEF
B$JIT.ACCEPT_FLAGS.ANNOUNCE
       261**DCL     18617>>ASSIGN
B$JIT.ACCEPT_FLAGS.BROADCAST
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:572  
       261**DCL     18618>>ASSIGN
B$JIT.ACCEPT_FLAGS.SEND
       261**DCL     18628>>ASSIGN
B$JIT.ACCN
       113**DCL     18716>>CALLBLT 18717--CALL
B$JIT.BUDLIM
       250**DCL     19057>>IF      19063>>CALLBLT
B$JIT.CPFLAGS1.DRIBBLE
       205**DCL     18620>>ASSIGN
B$JIT.CPFLAGS1.ECHO
       206**DCL     16915<<ASSIGN  17013<<ASSIGN  18621>>ASSIGN
B$JIT.CPFLAGS1.JSTEP
       202**DCL     16612>>IF      17151>>IF
B$JIT.CPFLAGS1.NOTIFY
       205**DCL     16906<<ASSIGN  18624>>ASSIGN
B$JIT.CPFLAGS1.PROTECT
       206**DCL     16903<<ASSIGN  17317<<ASSIGN  18627>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       207**DCL       207--REDEF
B$JIT.CPFLAGS1.WHEN_INPUT
       203**DCL     16927>>IF      18605>>IF      20418>>IF
B$JIT.ERR.MID
       114**DCL       114--REDEF
B$JIT.FACCN
       113**DCL     18752>>CALLBLT 18754>>CALLBLT 18764>>CALLBLT 18765>>CALLBLT
B$JIT.FEXT
       281**DCL     17160<<ASSIGN
B$JIT.FPSN
       194**DCL     18749>>IF      18760>>CALLBLT 18762>>CALLBLT
B$JIT.JRESPEAK
       275**DCL       276--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       384**DCL       384--REDEF     385--REDEF
B$JIT.PNR
       288**DCL       288--REDEF
B$JIT.PRDPRM
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:573  
       282**DCL     18793>>IF      18795>>ASSIGN
B$JIT.PRFLAGS.COMMENT
       197**DCL     16606<<ASSIGN  16620<<ASSIGN  16912<<ASSIGN  18619>>ASSIGN
B$JIT.PRFLAGS.EXPOUND
       198**DCL     16918<<ASSIGN  17097<<ASSIGN  18622>>ASSIGN
B$JIT.PRFLAGS.LIST
       197**DCL     16909<<ASSIGN  17145<<ASSIGN  17162<<ASSIGN  18623>>ASSIGN
B$JIT.PRFLAGS.LS
       197**DCL     17161<<ASSIGN
B$JIT.PRFLAGS.POINT
       198**DCL     16921<<ASSIGN  17291<<ASSIGN  18625>>ASSIGN
B$JIT.PRFLAGS.POSITION
       198**DCL     16924<<ASSIGN  17304<<ASSIGN  18626>>ASSIGN
B$JIT.PRFLAGS.WHEN
       198**DCL     16947<<ASSIGN  18629>>ASSIGN
B$JIT.PRIV.ACTIVE
       114**DCL     17475>>ASSIGN  17476<<ASSIGN  17493<<ASSIGN  17525<<ASSIGN
B$JIT.RERUN
       288**DCL     17372>>IF
B$JIT.STEPCC
       340**DCL     18844>>CALLBLT
B$JIT.SYSID
       113**DCL     17368>>CALLBLT 18725>>CALLBLT
B$JIT.TSLINE
       382**DCL       383--REDEF
B$JIT.UNAME
       113**DCL     18720>>CALLBLT 18721--CALL
B$JIT.USER
       113**DCL     18731>>ASSIGN
B$JIT.USRERR
       249**DCL     16749<<ASSIGN  16991<<ASSIGN  17278<<ASSIGN  17529<<ASSIGN  17547<>CALL    18557<<ASSIGN
B$JIT.USRERR.CODE
       249**DCL     16826>>IF      16835<<ASSIGN  17534>>IF      17534>>IF      17544<<ASSIGN  17548<<ASSIGN
B$JIT.WOO
       113**DCL     19114>>CALLBLT 19115--CALL
B$JIT$
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:574  
     11099**DCL       108--IMP-PTR 16606>>ASSIGN  16612>>IF      16620>>ASSIGN  16749>>ASSIGN  16826>>IF
     16835>>ASSIGN  16903>>ASSIGN  16906>>ASSIGN  16909>>ASSIGN  16912>>ASSIGN  16915>>ASSIGN  16918>>ASSIGN
     16921>>ASSIGN  16924>>ASSIGN  16927>>IF      16947>>ASSIGN  16991>>ASSIGN  17013>>ASSIGN  17097>>ASSIGN
     17145>>ASSIGN  17151>>IF      17160>>ASSIGN  17161>>ASSIGN  17162>>ASSIGN  17278>>ASSIGN  17291>>ASSIGN
     17304>>ASSIGN  17317>>ASSIGN  17368>>CALLBLT 17372>>IF      17475>>ASSIGN  17476>>ASSIGN  17493>>ASSIGN
     17525>>ASSIGN  17529>>ASSIGN  17534>>IF      17534>>IF      17544>>ASSIGN  17547>>CALL    17548>>ASSIGN
     18557>>ASSIGN  18605>>IF      18617>>ASSIGN  18618>>ASSIGN  18619>>ASSIGN  18620>>ASSIGN  18621>>ASSIGN
     18622>>ASSIGN  18623>>ASSIGN  18624>>ASSIGN  18625>>ASSIGN  18626>>ASSIGN  18627>>ASSIGN  18628>>ASSIGN
     18629>>ASSIGN  18716>>CALLBLT 18717>>CALL    18720>>CALLBLT 18721>>CALL    18725>>CALLBLT 18731>>ASSIGN
     18749>>IF      18752>>CALLBLT 18754>>CALLBLT 18760>>CALLBLT 18762>>CALLBLT 18764>>CALLBLT 18765>>CALLBLT
     18793>>IF      18795>>ASSIGN  18844>>CALLBLT 19057>>IF      19063>>CALLBLT 19114>>CALLBLT 19115>>CALL
     20418>>IF
B$ROS$
     11100**DCL     20734>>ASSIGN  20735>>ASSIGN  20750>>IF      20771>>IF
B$ROS$ IN PROCEDURE DILDEV
     19229**DCL     19669>>DOWHILE 19669>>DOWHILE 19673>>IF      19678>>IF      19709>>ASSIGN  19738>>CALLBLT
     19820>>CALLBLT 19906>>ASSIGN  19907>>ASSIGN  19932>>ASSIGN
B$ROSEG.DCBPTR$
       400**DCL     19906>>ASSIGN  20734>>ASSIGN
B$ROSEG.LDEVNAME
       410**DCL     19669>>DOWHILE 19678>>IF      19709>>ASSIGN  19738>>CALLBLT 19820>>CALLBLT 19932>>ASSIGN
     20750>>IF      20771>>IF
B$ROSEG.NUMDCBS
       402**DCL     19907>>ASSIGN  20735>>ASSIGN
B$ROSEG.STREAMID.FLG
       412**DCL     19669>>DOWHILE
B$ROSEG.STREAMID.UC_STR
       418**DCL     19673>>IF
B$SR_NON_BLANK$
     15620**DCL     15621--IMP-PTR 19745>>CALLBLT 20235>>CALLBLT 20248>>CALLBLT 20256>>CALLBLT
B$TCB.ALT$
     14952**DCL     16991>>ASSIGN  17278>>ASSIGN  17529>>ASSIGN  18557>>ASSIGN  20206>>IF
B$TCB$
     11101**DCL     14952--IMP-PTR 16991>>ASSIGN  17278>>ASSIGN  17529>>ASSIGN  18557>>ASSIGN  20206>>IF
BAD_LDEV_NAME
     14375**DCL     17055<>CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:575  
BAD_LDEV_NAME.SIZ
     14376**DCL     17053<<ASSIGN
BAD_LDEV_NAME.TEXT
     14377**DCL     17054<<ASSIGN
BAD_LDEV_NAME IN PROCEDURE FIND_ALL_LDEVS
     19993**DCL     20033<>CALL    20036<>CALL
BAD_LDEV_NAME.CNT IN PROCEDURE FIND_ALL_LDEVS
     19994**DCL     20029<<ASSIGN
BAD_LDEV_NAME.TXT IN PROCEDURE FIND_ALL_LDEVS
     19995**DCL     20030<<ASSIGN
BEGIN IN PROCEDURE DILDEV
     19668**LABEL   19688--GOTO
BIT$1 IN PROCEDURE DISP_OPT_YESNO
     18940**DCL     18975>>IF
BIT$2 IN PROCEDURE DISP_OPT_YESNO
     18941**DCL     18944>>IF      18965>>IF
BLK$
     14314**DCL     15629--IMP-PTR 15675--IMP-PTR 16599<<ASSIGN  16603>>IF      16616>>ASSIGN  16617>>ASSIGN
     16618<>CALL    16681<<ASSIGN  16688>>IF      16696>>DOWHILE 16697>>ASSIGN  16895<<ASSIGN  16898>>DOWHILE
     16899>>ASSIGN  17034<<ASSIGN  17035>>IF      17045>>IF      17047>>ASSIGN  17047>>ASSIGN  17049>>CALLBLT
     17049>>CALLBLT 17049>>CALLBLT 17049>>CALLBLT 17059>>IF      17059>>IF      17059>>IF      17137<<ASSIGN
     17141>>IF      17157>>ASSIGN  17158>>ASSIGN  17159<>CALL    17203<<ASSIGN  17215>>IF      17217>>DOWHILE
     17218>>ASSIGN
CAMR_REC.ACSVEH_
     10138**DCL     10139--REDEF
CAMR_REC.ALTKEYS_
     10144**DCL     10145--REDEF   10145--REDEF
CAMR_REC.HDR_
     10143**DCL     10144--REDEF
CAMR_REC.TAB_
     10142**DCL     10143--REDEF
CAMR_REC.UHL_
     10136**DCL     10137--REDEF   10137--REDEF
CAMR_REC.V.FSN#
     10176**DCL     10176--REDEF   10176--REDEF
CAMR_REC.WSN_
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:576  
     10142**DCL     10142--REDEF
CFPT_CLOSE
      8980**DCL     16930>>ASSIGN  17247>>ASSIGN  17271>>ASSIGN  17478>>ASSIGN  20198>>ASSIGN  20421>>ASSIGN
CFPT_CLOSE.SN_
      8980**DCL      8980--REDEF
CFPT_CLOSE.UTL_
      8981**DCL      8981--REDEF
CFPT_CLOSE.V.EXPIRE#
      8995**DCL      8995--REDEF
CFPT_CLOSE.V.TYPE#
      8993**DCL      8993--REDEF
CFPT_CLOSE.V.XTNSIZE#
      8990**DCL      8990--REDEF    8992--REDEF
CFPT_DEVICE
      9641**DCL     17032>>ASSIGN
CFPT_DISPLAY
      8846**DCL     17408>>ASSIGN
CFPT_DRIBBLE
     10323**DCL     16950>>ASSIGN
CFPT_OPEN
      8913**DCL     17482>>ASSIGN  18774>>ASSIGN
CFPT_OPEN.ACSVEH_
      8915**DCL      8916--REDEF
CFPT_OPEN.ALTKEYS_
      8921**DCL      8922--REDEF    8922--REDEF
CFPT_OPEN.HDR_
      8920**DCL      8921--REDEF
CFPT_OPEN.TAB_
      8919**DCL      8920--REDEF
CFPT_OPEN.UHL_
      8913**DCL      8914--REDEF    8914--REDEF
CFPT_OPEN.V.FSN#
      8953**DCL      8953--REDEF    8953--REDEF
CFPT_OPEN.V.RECL#
      8939**DCL     17888>>IF
CFPT_OPEN.WSN_
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:577  
      8919**DCL      8919--REDEF
CFPT_READ
      9016**DCL     17496>>ASSIGN
CFPT_READ.STATION_
      9019**DCL      9020--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      9031**DCL      9031--REDEF
CFPT_READ.V.INDX#
      9029**DCL      9029--REDEF
CFPT_READUC.STATION_
      9389**DCL      9390--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      9401**DCL      9401--REDEF
CFPT_READUC.V.INDX#
      9399**DCL      9399--REDEF
CFPT_TIME
      8827**DCL     17338>>ASSIGN
CFPT_TRMCTL IN PROCEDURE DILDEV
     19595**DCL     19795>>ASSIGN
CFPT_TRMCTL.V IN PROCEDURE DILDEV
     19603**DCL     19597--DCLINIT
CFPT_TRMISC
      9331**DCL     16956>>ASSIGN
CFPT_TRTN.V.IR#
      9625**DCL      9626--REDEF
CFPT_UNFID
      9310**DCL     17675>>ASSIGN  18517>>ASSIGN
CFPT_WRITE
      9055**DCL     16682>>ASSIGN  17348>>ASSIGN
CFPT_WRITE.STATION_
      9057**DCL      9057--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      9064**DCL      9064--REDEF
CFPT_WRITEUC.STATION_
      9357**DCL      9357--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:578  
      9364**DCL      9364--REDEF
CFPT_XXX.V.STEPCC#
     10337**DCL     10337--REDEF
CF_FDS
     14426**DCL     20410>>ASSIGN
CGETCMD.OUT$
     10358**DCL     10364--REDEF
CHR10 IN PROCEDURE DISPBUDGET
     19047**DCL     19063<<CALLBLT 19064>>CALLBLT 19081<<CALLBLT 19082>>CALLBLT
CHR11 IN PROCEDURE DISPBUDGET
     19048**DCL     19049--REDEF   19064<<CALLBLT 19066--DOWHILE 19069<<ASSIGN  19069>>ASSIGN  19069--ASSIGN
     19070--CALL    19070--CALL    19082<<CALLBLT 19084--DOWHILE 19087<<ASSIGN  19087>>ASSIGN  19087--ASSIGN
     19088--CALL    19088--CALL
CHR11A IN PROCEDURE DISPBUDGET
     19049**DCL     19066>>DOWHILE 19084>>DOWHILE
CK_WHEN
     14919**DCL     20441>>ASSIGN
CLOSEMYDCB IN PROCEDURE DILDEV
     19957**PROC    19687--CALL    19693--CALL    19697--CALL    19706--CALL    19930--CALL
CLOSE_DCB
     20800**PROC    17071--CALL    19960--CALL    20788--CALL
CLSDCB IN PROCEDURE CLOSE_DCB
     20832**DCL     20897<<ASSIGN  20900<>CALL
CLSDCB.SN_ IN PROCEDURE CLOSE_DCB
     20832**DCL     20832--REDEF
CLSDCB.UTL_ IN PROCEDURE CLOSE_DCB
     20833**DCL     20833--REDEF
CLSDCB.V IN PROCEDURE CLOSE_DCB
     20837**DCL     20899--ASSIGN
CLSDCB.V.DCB# IN PROCEDURE CLOSE_DCB
     20838**DCL     20898<<ASSIGN
CLSDCB.V.EXPIRE# IN PROCEDURE CLOSE_DCB
     20847**DCL     20847--REDEF
CLSDCB.V.TYPE# IN PROCEDURE CLOSE_DCB
     20845**DCL     20845--REDEF
CLSDCB.V.XTNSIZE# IN PROCEDURE CLOSE_DCB
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:579  
     20842**DCL     20842--REDEF   20844--REDEF
CLSDCB.V_ IN PROCEDURE CLOSE_DCB
     20832**DCL     20899<<ASSIGN
CLSMYDCB.SN_ IN PROCEDURE DILDEV
     19491**DCL     19491--REDEF
CLSMYDCB.UTL_ IN PROCEDURE DILDEV
     19492**DCL     19492--REDEF
CLSMYDCB.V.EXPIRE# IN PROCEDURE DILDEV
     19506**DCL     19506--REDEF
CLSMYDCB.V.TYPE# IN PROCEDURE DILDEV
     19504**DCL     19504--REDEF
CLSMYDCB.V.XTNSIZE# IN PROCEDURE DILDEV
     19501**DCL     19501--REDEF   19503--REDEF
CNTLS IN PROCEDURE DISP_PMSN
     18898**DCL     18904>>ASSIGN
CNTLS_A IN PROCEDURE DISP_PMSN
     18899**DCL     18904<<ASSIGN  18906>>IF
CNVRT_BLD
     18869**PROC    17437--CALL    17885--CALL    17892--CALL    17941--CALL    17948--CALL    17955--CALL
     17962--CALL    17969--CALL    18030--CALL    18035--CALL    18040--CALL    18045--CALL    18056--CALL
     18073--CALL    18123--CALL    18130--CALL    18138--CALL    18150--CALL    18191--CALL    18198--CALL
     18205--CALL    18263--CALL    18271--CALL    18277--CALL    18286--CALL    18296--CALL    18306--CALL
     18325--CALL    18380--CALL    18388--CALL    18413--CALL    18450--CALL    18455--CALL    18462--CALL
     18480--CALL    18495--CALL    18497--CALL    18800--CALL    19753--CALL    19757--CALL    19762--CALL
     19765--CALL    19772--CALL    19839--CALL    19841--CALL    19843--CALL    19845--CALL    19861--CALL
     19878--CALL
CNVRT_BLD50 IN PROCEDURE CNVRT_BLD
     18876**LABEL   18874--CALLALT 18878--CALLALT
CODE14.CGRANS
     15454**DCL     18792>>ASSIGN
CODE14.MGRANS
     15454**DCL     18792>>ASSIGN
CODE16.COPIES IN PROCEDURE DILDEV
     19224**DCL     19764>>ASSIGN
CODE16.FORM IN PROCEDURE DILDEV
     19222**DCL     19744>>CALLBLT 19745>>CALLBLT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:580  
CODE16.LINENO IN PROCEDURE DILDEV
     19223**DCL     19750>>IF      19754>>ASSIGN
CODE16.PAGENO IN PROCEDURE DILDEV
     19222**DCL     19749>>ASSIGN
CODE16.RECNO IN PROCEDURE DILDEV
     19222**DCL     19761>>ASSIGN
COMMENT70
     16620**LABEL   16614--GOTO
COMMENT80
     16620**LABEL   16618--CALLALT
CONSTCLS IN PROCEDURE CLOSE_DCB
     20877**DCL     20897>>ASSIGN
CONSTCLS.SN_ IN PROCEDURE CLOSE_DCB
     20877**DCL     20877--REDEF
CONSTCLS.UTL_ IN PROCEDURE CLOSE_DCB
     20878**DCL     20878--REDEF
CONSTCLS.V IN PROCEDURE CLOSE_DCB
     20882**DCL     20877--DCLINIT
CONSTCLS.V.EXPIRE# IN PROCEDURE CLOSE_DCB
     20892**DCL     20892--REDEF
CONSTCLS.V.TYPE# IN PROCEDURE CLOSE_DCB
     20890**DCL     20890--REDEF
CONSTCLS.V.XTNSIZE# IN PROCEDURE CLOSE_DCB
     20887**DCL     20887--REDEF   20889--REDEF
CONSTCLS.SN_ IN PROCEDURE DILDEV
     19533**DCL     19533--REDEF
CONSTCLS.UTL_ IN PROCEDURE DILDEV
     19534**DCL     19534--REDEF
CONSTCLS.V IN PROCEDURE DILDEV
     19538**DCL     19533--DCLINIT
CONSTCLS.V.EXPIRE# IN PROCEDURE DILDEV
     19548**DCL     19548--REDEF
CONSTCLS.V.TYPE# IN PROCEDURE DILDEV
     19546**DCL     19546--REDEF
CONSTCLS.V.XTNSIZE# IN PROCEDURE DILDEV
     19543**DCL     19543--REDEF   19545--REDEF
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:581  
CONSTOPN IN PROCEDURE DILDEV
     19424**DCL     19707>>ASSIGN  19925>>ASSIGN
CONSTOPN.ACSVEH_ IN PROCEDURE DILDEV
     19426**DCL     19427--REDEF
CONSTOPN.ALTKEYS_ IN PROCEDURE DILDEV
     19432**DCL     19433--REDEF   19433--REDEF
CONSTOPN.HDR_ IN PROCEDURE DILDEV
     19431**DCL     19432--REDEF
CONSTOPN.TAB_ IN PROCEDURE DILDEV
     19430**DCL     19431--REDEF
CONSTOPN.UHL_ IN PROCEDURE DILDEV
     19424**DCL     19425--REDEF   19425--REDEF
CONSTOPN.V IN PROCEDURE DILDEV
     19433**DCL     19424--DCLINIT
CONSTOPN.V.FSN# IN PROCEDURE DILDEV
     19464**DCL     19464--REDEF   19464--REDEF
CONSTOPN.WSN_ IN PROCEDURE DILDEV
     19430**DCL     19430--REDEF
CONSTOPN IN PROCEDURE FIND_OR_CREATE_STREAM
     20687**DCL     20781>>ASSIGN
CONSTOPN.ACSVEH_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20689**DCL     20690--REDEF
CONSTOPN.ALTKEYS_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20695**DCL     20696--REDEF   20696--REDEF
CONSTOPN.HDR_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20694**DCL     20695--REDEF
CONSTOPN.TAB_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20693**DCL     20694--REDEF
CONSTOPN.UHL_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20687**DCL     20688--REDEF   20688--REDEF
CONSTOPN.V IN PROCEDURE FIND_OR_CREATE_STREAM
     20696**DCL     20687--DCLINIT
CONSTOPN.V.FSN# IN PROCEDURE FIND_OR_CREATE_STREAM
     20727**DCL     20727--REDEF   20727--REDEF
CONSTOPN.WSN_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20693**DCL     20693--REDEF
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:582  
CONTAB
     14327**DCL     18737>>CALLBLT
COUNTER1 IN PROCEDURE DILDEV
     19233**DCL     19828<<CALLBLT 19829<>CALL    19829--CALL    19834>>CALLBLT
COUNTER2 IN PROCEDURE DILDEV
     19234**DCL     19831<<CALLBLT 19832<>CALL    19832--CALL    19834>>CALLBLT
CP$BUFF
     14931**DCL     20446--CALL    20455--ASSIGN
CPB$BLDIMAGE
     14667**DCL-ENT 17362--CALL    17366--CALL    17370--CALL    17376--CALL    17440--CALL    17665--CALL
     17668--CALL    17671--CALL    17698--CALL    17708--CALL    17720--CALL    17727--CALL    17739--CALL
     17746--CALL    17758--CALL    17765--CALL    17843--CALL    17850--CALL    17859--CALL    17866--CALL
     17878--CALL    17899--CALL    17914--CALL    17921--CALL    17926--CALL    17933--CALL    17977--CALL
     17984--CALL    17986--CALL    17992--CALL    17997--CALL    18004--CALL    18025--CALL    18063--CALL
     18080--CALL    18093--CALL    18096--CALL    18098--CALL    18101--CALL    18159--CALL    18168--CALL
     18171--CALL    18179--CALL    18212--CALL    18215--CALL    18218--CALL    18226--CALL    18237--CALL
     18245--CALL    18253--CALL    18255--CALL    18313--CALL    18316--CALL    18332--CALL    18340--CALL
     18350--CALL    18362--CALL    18476--CALL    18492--CALL    18514--CALL    18538--CALL    18641--CALL
     18648--CALL    18660--CALL    18667--CALL    18671--CALL    18717--CALL    18719--CALL    18721--CALL
     18724--CALL    18727--CALL    18730--CALL    18742--CALL    18755--CALL    18763--CALL    18766--CALL
     18846--CALL    18874--CALL    18878--CALL    18911--CALL    18949--CALL    18956--CALL    18981--CALL
     19013--CALL    19020--CALL    19026--CALL    19029--CALL    19062--CALL    19070--CALL    19077--CALL
     19080--CALL    19088--CALL    19115--CALL    19740--CALL    19747--CALL    19778--CALL    19782--CALL
     19821--CALL    19826--CALL    19836--CALL    19870--CALL    19887--CALL    19945--CALL    19951--CALL
     19976--CALL    20229--CALL    20237--CALL    20243--CALL    20249--CALL    20257--CALL    20264--CALL
     20270--CALL    20276--CALL    20282--CALL    20305--CALL    20307--CALL    20312--CALL    20317--CALL
     20323--CALL    20328--CALL    20334--CALL    20339--CALL    20345--CALL    20350--CALL    20356--CALL
     20361--CALL
CPB$PLATEN
     14680**DCL-ENT 16725--CALL    16793--CALL
CPB$REPORT
     14643**DCL-ENT 16726--CALL    16804--CALL
CPC$GETSEG
     14645**DCL-ENT 17473--CALL    18773--CALL
CPC$OPEN_LL
     14646**DCL-ENT 17038--CALL    20417--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:583  
CPC$OPEN_S
     14658**DCL-ENT 20202--CALL    20445--CALL
CPC$RDHLP
     14659**DCL-ENT 17207--CALL
CPC$RELSEG
     14660**DCL-ENT 16755--CALL    16839--CALL    17533--CALL    17565--CALL    18797--CALL
CPC$SCREECH
     14690**DCL-ENT 17551--CALL    18816--CALL
CPC$WRHLP
     14661**DCL-ENT 17243--CALL
CPC$WRITEMSGE
     14644**DCL-ENT 17055--CALL    17257--CALL    20033--CALL    20036--CALL
CPE$GENRUAM
     14663**DCL-ENT 16618--CALL    17159--CALL
CPE$LISTOUT
     14664**DCL-ENT 17380--CALL    17419--CALL    17428--CALL    17444--CALL    17516--CALL    17542--CALL
     18551--CALL    18604--CALL    18684--CALL    18745--CALL    18802--CALL    18850--CALL    19091--CALL
     19118--CALL    19719--CALL    19805--CALL    20003--CALL    20014--CALL    20025--CALL    20212--CALL
     20226--CALL    20290--CALL    20300--CALL    20370--CALL    20380--CALL
CPE$RFEXT
     14662**DCL-ENT 16619--CALL
CPE$RZEROS
     14666**DCL-ENT 17369--CALL    17416--CALL    17425--CALL    17932--CALL    18167--CALL    18726--CALL
     18845--CALL    18877--CALL    19829--CALL    19832--CALL    20281--CALL
CPE$TIME
     17336**ENTRY   16795--CALL    17446--CALL
CPF$DIPROFILES
     14686**DCL-ENT 16809--CALL
CPF$PPRIV
     14683**DCL-ENT 16718--CALL    16766--CALL
CPF$PRIV
     14684**DCL-ENT 16717--CALL    16764--CALL
CPF$PROFILE
     14685**DCL-ENT 16728--CALL
CPF$SWITCH
     14668**DCL-ENT 16715--CALL    16758--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:584  
CPF$TERMINAL
     14682**DCL-ENT 16716--CALL    16761--CALL
CPG$GET_WHEN_CNTL_REC
     14677**DCL-ENT 16934--CALL    20425--CALL
CPG$LET
     14676**DCL-ENT 16724--CALL    16798--CALL    16801--CALL
CPG$PUT_WHEN_CNTL_REC
     14678**DCL-ENT 16940--CALL
CPG$SET_WHEN_STATE
     14679**DCL-ENT 18607--CALL
CPH$GLOBAL
     14675**DCL-ENT 16723--CALL    16786--CALL
CPI$DIRECTORY
     14670**DCL-ENT 16772--CALL
CPI$PRIORITY
     14687**DCL-ENT 16727--CALL    16807--CALL
CPI$SETUP
     14671**DCL-ENT 16777--CALL    18811--CALL
CPI$TABS
     14669**DCL-ENT 16719--CALL    16769--CALL
CPJ$LIMIT
     14672**DCL-ENT 16721--CALL    16780--CALL
CPJ$READ_S
     14673**DCL-ENT 20203--CALL    20446--CALL
CPK$FDS_OUTPUT
     14688**DCL-ENT 20411--ASSIGN
CPO$ORES
     14674**DCL-ENT 16722--CALL    16783--CALL
CPOS
     14356**DCL     16833<<ASSIGN  16834<>CALL
CPSL_PARAM
     15954**DCL     16740<<ASSIGN  16741<>CALL
CPSL_PARAM.ERRCODE
     15962**DCL     16742>>IF      16749>>ASSIGN
CPSL_PARAM.FLAGS.REPORTED_TO_USER
     15959**DCL     16744>>IF
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:585  
CP_CHFLAGS IN PROCEDURE DISPNOTIFY
     20071**DCL     20203--CALL
CP_CHFLAGS.FLG.INPUT IN PROCEDURE DISPNOTIFY
     20094**DCL     20330>>IF
CP_CHFLAGS.FLG.OUTPUT IN PROCEDURE DISPNOTIFY
     20095**DCL     20341>>IF
CP_CHFLAGS.FLG.RUNNING IN PROCEDURE DISPNOTIFY
     20096**DCL     20352>>IF
CP_CHFLAGS.FLG.TERM IN PROCEDURE DISPNOTIFY
     20093**DCL     20319>>IF
CP_CHFLAGS.FLG.WAIT IN PROCEDURE DISPNOTIFY
     20103**DCL     20260>>IF
CP_CHFLAGS.SYSTEM IN PROCEDURE DISPNOTIFY
     20086**DCL     20308>>IF
CP_CHFLAGS.USE_ACCT IN PROCEDURE DISPNOTIFY
     20072**DCL     20244>>IF      20247>>ASSIGN  20248>>CALLBLT
CP_CHFLAGS.USE_NAME.L# IN PROCEDURE DISPNOTIFY
     20074**DCL     20241>>ASSIGN
CP_CHFLAGS.USE_NAME.NAME# IN PROCEDURE DISPNOTIFY
     20075**DCL     20240>>ASSIGN
CP_CHFLAGS.USE_PASS IN PROCEDURE DISPNOTIFY
     20076**DCL     20252>>IF      20255>>CALLBLT 20256>>CALLBLT
CP_CHFLAGS.USE_SN IN PROCEDURE DISPNOTIFY
     20079**DCL     20230>>ASSIGN
CP_CHFLAGS.WAIT_DONE IN PROCEDURE DISPNOTIFY
     20087**DCL     20266>>IF
CP_CHFLAGS.WAIT_INT IN PROCEDURE DISPNOTIFY
     20106**DCL     20279>>ASSIGN
CREATE_FLG IN PROCEDURE FIND_OR_CREATE_STREAM
     20497**DCL     20475--PROC    20778>>IF
CVLP_TRMCTL.BREAKCOUNT
      9949**DCL      9950--REDEF
CVLP_WINDOW.FWINDOW#
     10045**DCL     10045--REDEF   10046--REDEF
CXB$CHKFORT
     14681**DCL-ENT 16739--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:586  
CXC$READAM
     14665**DCL-ENT 16741--CALL
CXP$POSTERR
     14692**DCL-ENT 16628--CALL    16834--CALL    17165--CALL    17267--CALL    17547--CALL
DCB#
     14317**DCL     17039<<ASSIGN  17051<>CALL    17066>>ASSIGN  17071<>CALL
DCB# IN PROCEDURE CLOSE_DCB
     20805**DCL     20800--PROC    20898>>ASSIGN
DCB# IN PROCEDURE FIND_OR_CREATE_STREAM
     20498**DCL     20475--PROC    20754<<ASSIGN  20785<<ASSIGN  20786--IF      20788<>CALL    20789>>ASSIGN
DCB$
     14318**DCL     16738<<ASSIGN  16739<>CALL    16741<>CALL    16753<>CALL
DCB$ IN PROCEDURE DILDEV
     19231**DCL     19713<<ASSIGN  19714>>ASSIGN  19738>>CALLBLT 19738>>CALLBLT 19766>>IF      19769>>ASSIGN
     19773>>ASSIGN  19780>>CALLBLT 19780>>CALLBLT
DCB$ IN PROCEDURE DISPDCB
     17585**DCL     17583--PROC    17667>>ASSIGN  17668>>CALL
DCB$ IN PROCEDURE FIND_OR_CREATE_STREAM
     20509**DCL     20749<<ASSIGN
DCBHDR IN PROCEDURE DISPDCBS
     17467**DCL     17515--ASSIGN
DCBNHDR IN PROCEDURE DISPDCBS
     17468**DCL     17541--ASSIGN
DCBSLOT
     14328**DCL     19165<<ASSIGN  19704--IF      19708>>ASSIGN  19713--ASSIGN  19927<<ASSIGN  19928--IF
     19931>>ASSIGN  19936>>ASSIGN  19960<>CALL
DCBS_EXIST IN PROCEDURE DISPDCBS
     17469**DCL     17481<<ASSIGN  17512>>IF      17520<<ASSIGN  17538>>IF
DCBTAB$ IN PROCEDURE FIND_OR_CREATE_STREAM
     20508**DCL     20734<<ASSIGN
DCBTAB$ IN PROCEDURE SETUP_TCTL_DCB
     19903**DCL     19906<<ASSIGN
DCB_NAME
     14346**DCL     14349--REDEF   17500--ASSIGN  17519--CALL
DCB_NAMEA
     14349**DCL     17509>>IF
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:587  
DEST$
     14342**DCL     17357<<ASSIGN  17362<>CALL    17366<>CALL    17370<>CALL    17376<>CALL    17434<<ASSIGN
     17440<>CALL    17443>>ASSIGN  17661<<ASSIGN  17662>>ASSIGN  17665<>CALL    17668<>CALL    17671<>CALL
     17697<<ASSIGN  17697>>ASSIGN  17698<>CALL    17708<>CALL    17720<>CALL    17727<>CALL    17739<>CALL
     17746<>CALL    17758<>CALL    17765<>CALL    17843<>CALL    17850<>CALL    17859<>CALL    17866<>CALL
     17878<>CALL    17899<>CALL    17914<>CALL    17921<>CALL    17926<>CALL    17933<>CALL    17977<>CALL
     17984<>CALL    17986<>CALL    17990<<ASSIGN  17990>>ASSIGN  17992<>CALL    17997<>CALL    18004<>CALL
     18025<>CALL    18063<>CALL    18080<>CALL    18093<>CALL    18096<>CALL    18098<>CALL    18101<>CALL
     18159<>CALL    18168<>CALL    18171<>CALL    18177<<ASSIGN  18177>>ASSIGN  18179<>CALL    18212<>CALL
     18215<>CALL    18218<>CALL    18226<>CALL    18237<>CALL    18245<>CALL    18253<>CALL    18255<>CALL
     18313<>CALL    18316<>CALL    18332<>CALL    18340<>CALL    18350<>CALL    18362<>CALL    18476<>CALL
     18492<>CALL    18514<>CALL    18538<>CALL    18546>>IF      18550>>ASSIGN  18612<<ASSIGN  18635<<ASSIGN
     18641<>CALL    18648<>CALL    18660<>CALL    18667<>CALL    18671<>CALL    18678>>ASSIGN  18712<<ASSIGN
     18713>>ASSIGN  18717<>CALL    18719<>CALL    18721<>CALL    18724<>CALL    18727<>CALL    18730<>CALL
     18742<>CALL    18744>>ASSIGN  18747<<ASSIGN  18755<>CALL    18763<>CALL    18766<>CALL    18801>>ASSIGN
     18841<<ASSIGN  18843<<ASSIGN  18843>>ASSIGN  18846<>CALL    18848>>ASSIGN  18874<>CALL    18878<>CALL
     18911<>CALL    18949<>CALL    18956<>CALL    18981<>CALL    19013<>CALL    19020<>CALL    19026<>CALL
     19029<>CALL    19054<<ASSIGN  19056<<ASSIGN  19056>>ASSIGN  19062<>CALL    19070<>CALL    19077<>CALL
     19080<>CALL    19088<>CALL    19089>>ASSIGN  19111<<ASSIGN  19113<<ASSIGN  19113>>ASSIGN  19115<>CALL
     19116>>ASSIGN  19173<<ASSIGN  19729<<ASSIGN  19740<>CALL    19747<>CALL    19778<>CALL    19782<>CALL
     19815<<ASSIGN  19821<>CALL    19826<>CALL    19836<>CALL    19870<>CALL    19887<>CALL    19945<>CALL
     19947>>IF      19951<>CALL    19976<>CALL    20001>>ASSIGN  20012>>ASSIGN  20222<<ASSIGN  20229<>CALL
     20237<>CALL    20243<>CALL    20249<>CALL    20257<>CALL    20264<>CALL    20270<>CALL    20276<>CALL
     20282<>CALL    20288>>ASSIGN  20301<<ASSIGN  20305<>CALL    20312<>CALL    20323<>CALL    20334<>CALL
     20345<>CALL    20356<>CALL    20364>>ASSIGN
DEST2$ IN PROCEDURE DISPNOTIFY
     20194**DCL     20295<<ASSIGN  20307<>CALL    20317<>CALL    20328<>CALL    20339<>CALL    20350<>CALL
     20361<>CALL    20374>>ASSIGN
DILDEV
     19215**PROC    19998--CALL
DILDEV_OPT
     14335**DCL     19149<<ASSIGN  19154<<ASSIGN  19159<<ASSIGN  19725>>IF      19741>>IF      19811>>IF
     19822>>IF      19999>>IF      20005>>IF      20010>>IF      20016>>IF
DISP12
     16752**LABEL   16836--GOTO
DISP45
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:588  
     16819**LABEL   16746--GOTO    16750--GOTO
DISP47
     16826**LABEL   16753--CALLALT
DISP50
     16839**LABEL   16691--CALLALT 16703--CALLALT 16704--CALLALT 16705--CALLALT 16706--CALLALT 16707--CALLALT
     16708--CALLALT 16715--CALLALT 16716--CALLALT 16717--CALLALT 16718--CALLALT 16719--CALLALT 16720--CALLALT
     16721--CALLALT 16722--CALLALT 16723--CALLALT 16724--CALLALT 16725--CALLALT 16726--CALLALT 16727--CALLALT
     16728--CALLALT 16729--CALLALT 16730--CALLALT 16732--CALLALT 16734--CALLALT 16736--CALLALT 16758--CALLALT
     16761--CALLALT 16764--CALLALT 16766--CALLALT 16769--CALLALT 16772--CALLALT 16774--CALLALT 16777--CALLALT
     16780--CALLALT 16783--CALLALT 16786--CALLALT 16788--CALLALT 16790--CALLALT 16793--CALLALT 16795--CALLALT
     16798--CALLALT 16801--CALLALT 16804--CALLALT 16807--CALLALT 16809--CALLALT 16811--CALLALT 16813--CALLALT
     16815--CALLALT
DISPBUDGET
     19045**PROC    16729--CALL    16811--CALL
DISPBUDGET50 IN PROCEDURE DISPBUDGET
     19090**LABEL   19062--CALLALT 19070--CALLALT 19077--CALLALT 19080--CALLALT 19088--CALLALT 19091--CALLALT
DISPDCB
     17583**PROC    16753--CALL    17519--CALL
DISPDCB55 IN PROCEDURE DISPDCB
     18551**LABEL   17665--CALLALT 17668--CALLALT 17671--CALLALT 17698--CALLALT 17702--CALLALT 17708--CALLALT
     17720--CALLALT 17727--CALLALT 17739--CALLALT 17746--CALLALT 17758--CALLALT 17765--CALLALT 17843--CALLALT
     17850--CALLALT 17859--CALLALT 17866--CALLALT 17878--CALLALT 17885--CALLALT 17892--CALLALT 17899--CALLALT
     17914--CALLALT 17921--CALLALT 17926--CALLALT 17933--CALLALT 17941--CALLALT 17948--CALLALT 17955--CALLALT
     17962--CALLALT 17969--CALLALT 17977--CALLALT 17984--CALLALT 17986--CALLALT 17992--CALLALT 17995--CALLALT
     17997--CALLALT 18004--CALLALT 18025--CALLALT 18030--CALLALT 18035--CALLALT 18040--CALLALT 18045--CALLALT
     18047--CALLALT 18049--CALLALT 18051--CALLALT 18056--CALLALT 18063--CALLALT 18066--CALLALT 18068--CALLALT
     18073--CALLALT 18080--CALLALT 18093--CALLALT 18096--CALLALT 18098--CALLALT 18099--CALLALT 18101--CALLALT
     18106--CALLALT 18107--CALLALT 18109--CALLALT 18113--CALLALT 18115--CALLALT 18123--CALLALT 18130--CALLALT
     18138--CALLALT 18150--CALLALT 18159--CALLALT 18168--CALLALT 18171--CALLALT 18179--CALLALT 18182--CALLALT
     18191--CALLALT 18198--CALLALT 18205--CALLALT 18212--CALLALT 18215--CALLALT 18218--CALLALT 18226--CALLALT
     18230--CALLALT 18237--CALLALT 18245--CALLALT 18253--CALLALT 18255--CALLALT 18263--CALLALT 18271--CALLALT
     18277--CALLALT 18280--CALLALT 18286--CALLALT 18289--CALLALT 18290--CALLALT 18296--CALLALT 18304--CALLALT
     18306--CALLALT 18313--CALLALT 18316--CALLALT 18325--CALLALT 18332--CALLALT 18340--CALLALT 18350--CALLALT
     18362--CALLALT 18364--CALLALT 18367--CALLALT 18368--CALLALT 18369--CALLALT 18370--CALLALT 18371--CALLALT
     18374--CALLALT 18380--CALLALT 18388--CALLALT 18398--CALLALT 18400--CALLALT 18402--CALLALT 18404--CALLALT
     18406--CALLALT 18408--CALLALT 18413--CALLALT 18415--CALLALT 18417--CALLALT 18419--CALLALT 18422--CALLALT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:589  
     18425--CALLALT 18428--CALLALT 18430--CALLALT 18432--CALLALT 18435--CALLALT 18438--CALLALT 18445--CALLALT
     18450--CALLALT 18455--CALLALT 18457--CALLALT 18462--CALLALT 18476--CALLALT 18480--CALLALT 18492--CALLALT
     18495--CALLALT 18497--CALLALT 18514--CALLALT 18535--CALLALT 18538--CALLALT 18540--CALLALT 18541--CALLALT
     18544--CALLALT 18551--CALLALT
DISPDCB60 IN PROCEDURE DISPDCB
     18551**LABEL   17696--CALLALT
DISPDCBS
     17465**PROC    16705--CALL    16732--CALL
DISPDCBS10 IN PROCEDURE DISPDCBS
     17518**LABEL   17506--CALLALT
DISPDCBS20 IN PROCEDURE DISPDCBS
     17525**LABEL   17491--CALLALT
DISPDCBS45 IN PROCEDURE DISPDCBS
     17548**LABEL   17473--CALLALT
DISPDCBS5 IN PROCEDURE DISPDCBS
     17503**LABEL   17522--GOTO
DISPDCBS57 IN PROCEDURE DISPDCBS
     17548**LABEL   17516--CALLALT 17519--CALLALT 17542--CALLALT
DISPFLGS
     18573**PROC    16704--CALL    16734--CALL
DISPFLGS50 IN PROCEDURE DISPFLGS
     18684**LABEL   18604--CALLALT 18607--CALLALT 18641--CALLALT 18648--CALLALT 18660--CALLALT 18667--CALLALT
     18671--CALLALT 18684--CALLALT
DISPHDR1 IN PROCEDURE DISPFLGS
     18574**DCL     18603--ASSIGN
DISPLAY_ALTRET IN PROCEDURE DISPLAY_NORMAL_LDEV
     19791**LABEL   19711--CALLALT 19719--CALLALT 19740--CALLALT 19747--CALLALT 19778--CALLALT 19782--CALLALT
DISPLAY_NORMAL_LDEV IN PROCEDURE DILDEV
     19700**PROC    19692--CALL
DISPLAY_RETURN IN PROCEDURE DISPLAY_NORMAL_LDEV
     19788**LABEL   19743--GOTO
DISPLAY_WINDOW_OPTS IN PROCEDURE DILDEV
     19794**PROC    19685--CALL
DISPLDEV
     19136**PROC    16706--CALL    16790--CALL
DISPLDEV_ERR IN PROCEDURE DISPLDEV
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:590  
     19211**LABEL   19174--CALLALT 19204--CALLALT
DISPLDEV_RET IN PROCEDURE DISPLDEV
     19208**LABEL   19175--GOTO
DISPNOTIFY
     20056**PROC    16707--CALL    16788--CALL
DISPNOTIFY_ALT IN PROCEDURE DISPNOTIFY
     20392**LABEL   20202--CALLALT 20212--CALLALT 20226--CALLALT 20229--CALLALT 20237--CALLALT 20243--CALLALT
     20249--CALLALT 20257--CALLALT 20264--CALLALT 20270--CALLALT 20276--CALLALT 20282--CALLALT 20290--CALLALT
     20300--CALLALT 20305--CALLALT 20307--CALLALT 20312--CALLALT 20317--CALLALT 20323--CALLALT 20328--CALLALT
     20334--CALLALT 20339--CALLALT 20345--CALLALT 20350--CALLALT 20356--CALLALT 20361--CALLALT 20370--CALLALT
     20380--CALLALT 20389--CALLALT
DISPNOTIFY_ERR IN PROCEDURE DISPNOTIFY
     20387**LABEL   20208--GOTO
DISPNOTIFY_RET IN PROCEDURE DISPNOTIFY
     20384**LABEL   20215--GOTO
DISPSTEPCC
     18836**PROC    16720--CALL    16774--CALL
DISPSTEPCC50 IN PROCEDURE DISPSTEPCC
     18849**LABEL   18846--CALLALT 18850--CALLALT
DISPSYS
     17398**PROC    16691--CALL
DISPSYS50 IN PROCEDURE DISPSYS
     17443**LABEL   17419--CALLALT 17428--CALLALT 17437--CALLALT 17440--CALLALT 17444--CALLALT 17446--CALLALT
DISPUSER
     18707**PROC    16703--CALL    16736--CALL
DISPUSER20 IN PROCEDURE DISPUSER
     18783**LABEL   18784--CALLALT
DISPUSER30 IN PROCEDURE DISPUSER
     18793**LABEL   18788--CALLALT
DISPUSER50 IN PROCEDURE DISPUSER
     18810**LABEL   18717--CALLALT 18719--CALLALT 18721--CALLALT 18724--CALLALT 18727--CALLALT 18730--CALLALT
     18742--CALLALT 18745--CALLALT 18755--CALLALT 18763--CALLALT 18766--CALLALT 18800--CALLALT 18802--CALLALT
     18811--CALLALT
DISPUSER60 IN PROCEDURE DISPUSER
     18810**LABEL   18773--CALLALT
DISPWHEN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:591  
     20407**PROC    16708--CALL    16813--CALL
DISPWHEN_ALT IN PROCEDURE DISPWHEN
     20469**LABEL   20425--CALLALT 20445--CALLALT 20446--CALLALT
DISPWSN
     19107**PROC    16730--CALL    16815--CALL
DISPWSN50 IN PROCEDURE DISPWSN
     19121**LABEL   19115--CALLALT 19118--CALLALT
DISP_OPT_TEXT
     19001**PROC    18419--CALL    18422--CALL    18425--CALL    18432--CALL    18435--CALL
DISP_OPT_TEXT50 IN PROCEDURE DISP_OPT_TEXT
     19032**LABEL   19013--CALLALT 19020--CALLALT 19026--CALLALT 19029--CALLALT
DISP_OPT_YESNO
     18935**PROC    17702--CALL    18047--CALL    18049--CALL    18051--CALL    18066--CALL    18068--CALL
     18106--CALL    18107--CALL    18109--CALL    18113--CALL    18115--CALL    18182--CALL    18230--CALL
     18280--CALL    18289--CALL    18290--CALL    18304--CALL    18364--CALL    18367--CALL    18368--CALL
     18369--CALL    18370--CALL    18371--CALL    18374--CALL    18398--CALL    18400--CALL    18402--CALL
     18404--CALL    18406--CALL    18408--CALL    18415--CALL    18417--CALL    18428--CALL    18430--CALL
     18438--CALL    18445--CALL    18457--CALL    18540--CALL    18541--CALL    18544--CALL
DISP_OPT_YESNO10 IN PROCEDURE DISP_OPT_YESNO
     18979**LABEL   18967--GOTO
DISP_OPT_YESNO50 IN PROCEDURE DISP_OPT_YESNO
     18984**LABEL   18949--CALLALT 18956--CALLALT 18981--CALLALT
DISP_PMSN
     18895**PROC    17995--CALL    18099--CALL
DONT75
     16985**LABEL   16934--CALLALT 16942--CALLALT 16943--GOTO    16945--CALLALT 16953--CALLALT 16985--CALLALT
EJECT_RET
     17074**LABEL   17056--GOTO
ENDIT IN PROCEDURE FIND_ALL_LDEVS
     20010**LABEL   19998--CALLALT
ERR$BLK.FIRST
     15923**DCL     16819>>IF
ETMF IN PROCEDURE DISPSYS
     17402**DCL     17427--ASSIGN
ETMF.HDR IN PROCEDURE DISPSYS
     17403**DCL     17426<<ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:592  
ETMF.NR IN PROCEDURE DISPSYS
     17404**DCL     17424<<CALLBLT 17425<>CALL    17425--CALL
E_BADPASS
     16400**DCL     17267<>CALL
E_NOASGN
     16440**DCL     16834<>CALL
E_NOLDEVTHATTYPE
     16527**DCL     20033<>CALL
E_NOSUCHLDEV
     16479**DCL     17055<>CALL    20036<>CALL
E_PASSCHNGE
     16460**DCL     17257<>CALL
E_QUIT
     16420**DCL     16628<>CALL    17165<>CALL
F$DCB.ACTPOS
     15047**DCL     15047--REDEF
F$DCB.ARS#
     15021**DCL     15021--REDEF   20448>>ASSIGN
F$DCB.ATTR
     15040**DCL     15041--REDEF
F$DCB.BORROW
     15055**DCL     15055--REDEF   15055--REDEF   15055--REDEF
F$DCB.CFU$
     15056**DCL     19713>>ASSIGN
F$DCB.DCBNAME.L
     15069**DCL     15069--IMP-SIZ
F$DCB.EOMCHAR#
     15025**DCL     15025--REDEF
F$DCB.FCD#
     15034**DCL     17559>>IF      19704>>IF      19915>>IF      19928>>IF      20387>>IF      20756>>IF
     20786>>IF
F$DCB.FLDID
     15050**DCL     15050--REDEF
F$DCB.FORM$
     15044**DCL     15044--REDEF   19714>>ASSIGN
F$DCB.FSECT
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:593  
     15060**DCL     15060--REDEF
F$DCB.FSN#
     15037**DCL     15037--REDEF   15037--REDEF   15038--REDEF
F$DCB.HEADER$
     15043**DCL     15043--REDEF   19766>>IF      19769>>ASSIGN  19773>>ASSIGN  19780>>CALLBLT 19780>>CALLBLT
F$DCB.IXTNSIZE#
     15041**DCL     15041--REDEF
F$DCB.LASTSTA$
     15030**DCL     15030--REDEF
F$DCB.LVL
     15056**DCL     15056--REDEF
F$DCB.NAME#.C
     15031**DCL     15031--REDEF
F$DCB.NOEOF
     15053**DCL     15053--REDEF
F$DCB.NRECS#
     15042**DCL     15042--REDEF
F$DCB.NRECX
     15061**DCL     15061--REDEF
F$DCB.OHDR
     15053**DCL     15053--REDEF
F$DCB.ORG#
     15036**DCL     15036--REDEF
F$DCB.PRECNO
     15059**DCL     15059--REDEF
F$DCB.RCSZ
     15065**DCL     15065--REDEF
F$DCB.RES#
     15032**DCL     15032--REDEF   19738>>CALLBLT 20750>>IF
F$DCB.SETX
     15044**DCL     15044--REDEF
F$DCB.STR#
     15061**DCL     19915>>IF      20750>>IF
F$DCB.TAB$
     15044**DCL     15044--REDEF
F$DCB.TDA
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:594  
     15058**DCL     15059--REDEF
F$DCB.WIDTH#
     15028**DCL     20449>>ASSIGN
F$DCB.WSN#
     15032**DCL     15032--REDEF   19738>>CALLBLT
FDCB_CHAR IN PROCEDURE DISPDCBS
     17466**DCL     17509>>IF
FID$
     14316**DCL     16617<<ASSIGN  16618<>CALL    17158<<ASSIGN  17159<>CALL
FIND_ALL_LDEVS
     19988**PROC    19174--CALL    19204--CALL
FIND_ALL_LDEVS_ERR IN PROCEDURE FIND_ALL_LDEVS
     20041**LABEL   20003--CALLALT 20014--CALLALT 20025--CALLALT
FIND_OR_CREATE_STREAM
     20475**PROC    17051--CALL
FLAG IN PROCEDURE PUT_FLAG
     19966**DCL     19964--PROC    19970>>IF
FLAGS_TBL.HDR IN PROCEDURE DISPFLGS
     18580**DCL     18663>>ASSIGN
FLAGS_TBL.LEN IN PROCEDURE DISPFLGS
     18578**DCL     18664>>ASSIGN
FLAGS_VAL IN PROCEDURE DISPFLGS
     18596**DCL     18616<<ASSIGN  18617<<ASSIGN  18618<<ASSIGN  18619<<ASSIGN  18620<<ASSIGN  18621<<ASSIGN
     18622<<ASSIGN  18623<<ASSIGN  18624<<ASSIGN  18625<<ASSIGN  18626<<ASSIGN  18627<<ASSIGN  18628<<ASSIGN
     18629<<ASSIGN  18653>>IF
FMT_VEC
     14639**DCL     20412--ASSIGN  20415<<ASSIGN  20455<<ASSIGN
FORM$ IN PROCEDURE DILDEV
     19232**DCL     19714<<ASSIGN  19744>>CALLBLT 19745>>CALLBLT 19749>>ASSIGN  19750>>IF      19754>>ASSIGN
     19761>>ASSIGN  19764>>ASSIGN
FPT$WRITE
     16050**DCL     16682<<ASSIGN  17348<<ASSIGN
FPT$WRITE.BUF_
     16050**DCL     17350<<ASSIGN  17361<<ASSIGN  17418<<ASSIGN  17427<<ASSIGN  17515<<ASSIGN  17541<<ASSIGN
     18603<<ASSIGN  19718<<ASSIGN  19804<<ASSIGN  20024<<ASSIGN
FPT$WRITE.BUF_.BOUND
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:595  
     16050**DCL     17443<<ASSIGN  18550<<ASSIGN  18683<<ASSIGN  18744<<ASSIGN  18801<<ASSIGN  18848<<ASSIGN
     19089<<ASSIGN  19116<<ASSIGN  20001<<ASSIGN  20012<<ASSIGN  20210<<ASSIGN  20224<<ASSIGN  20288<<ASSIGN
     20298<<ASSIGN  20368<<ASSIGN  20378<<ASSIGN
FPT$WRITE.BUF_.BUF$
     16052**DCL     17442<<ASSIGN  18549<<ASSIGN  18682<<ASSIGN  18715<<ASSIGN  18743<<ASSIGN  18849<<ASSIGN
     19090<<ASSIGN  19117<<ASSIGN  20002<<ASSIGN  20013<<ASSIGN  20211<<ASSIGN  20225<<ASSIGN  20289<<ASSIGN
     20299<<ASSIGN  20369<<ASSIGN  20379<<ASSIGN
FPT$WRITE.STATION_
     16052**DCL     16052--REDEF
FPT$WRITE.V
     16053**DCL     16683--ASSIGN  17349--ASSIGN
FPT$WRITE.V.DVBYTE.VFC#
     16059**DCL     16059--REDEF
FPT$WRITE.V_
     16050**DCL     16683<<ASSIGN  17349<<ASSIGN
FPT_CLOSE
     16014**DCL     16930<<ASSIGN  16942<>CALL    16945<>CALL    17247<<ASSIGN  17251<>CALL    17271<<ASSIGN
     17275<>CALL    17478<<ASSIGN  17532<>CALL    17563<>CALL    20198<<ASSIGN  20213<>CALL    20218<>CALL
     20389<>CALL    20421<<ASSIGN  20435<>CALL    20453<>CALL    20469<>CALL
FPT_CLOSE.SN_
     16014**DCL     16014--REDEF
FPT_CLOSE.UTL_
     16015**DCL     16015--REDEF
FPT_CLOSE.V
     16019**DCL     16931--ASSIGN  17248--ASSIGN  17272--ASSIGN  17479--ASSIGN  20199--ASSIGN  20422--ASSIGN
FPT_CLOSE.V.DCB#
     16020**DCL     16932<<ASSIGN  17249<<ASSIGN  17273<<ASSIGN  17530<<ASSIGN  17562<<ASSIGN  20201<<ASSIGN
     20424<<ASSIGN
FPT_CLOSE.V.DISP#
     16023**DCL     16933<<ASSIGN  17250<<ASSIGN  17274<<ASSIGN  17531<<ASSIGN  17561<<ASSIGN  20200<<ASSIGN
     20423<<ASSIGN
FPT_CLOSE.V.EXPIRE#
     16029**DCL     16029--REDEF
FPT_CLOSE.V.TYPE#
     16027**DCL     16027--REDEF
FPT_CLOSE.V.XTNSIZE#
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:596  
     16024**DCL     16024--REDEF   16026--REDEF
FPT_CLOSE.V_
     16014**DCL     16931<<ASSIGN  17248<<ASSIGN  17272<<ASSIGN  17479<<ASSIGN  20199<<ASSIGN  20422<<ASSIGN
FPT_DEVICE
     16088**DCL     17032<<ASSIGN  17067<>CALL
FPT_DEVICE.V
     16089**DCL     17033--ASSIGN
FPT_DEVICE.V.CLEAR#
     16090**DCL     17062<<ASSIGN
FPT_DEVICE.V.DCB#
     16089**DCL     17066<<ASSIGN
FPT_DEVICE.V.PAGE#
     16090**DCL     17040<<ASSIGN  17064<<ASSIGN
FPT_DEVICE.V_
     16088**DCL     17033<<ASSIGN
FPT_DISPLAY
     16075**DCL     17408<<ASSIGN  17410<>CALL
FPT_DISPLAY.RESULTS_
     16075**DCL     17409<<ASSIGN
FPT_DRIBBLE
     14656**DCL     16950<<ASSIGN  16953<>CALL
FPT_DRIBBLE.V
     14656**DCL     16951--ASSIGN
FPT_DRIBBLE.V.DRIBBLE#
     14656**DCL     16952<<ASSIGN
FPT_DRIBBLE.V_
     14656**DCL     16951<<ASSIGN
FPT_OPEN
     16269**DCL     17482<<ASSIGN  17491<>CALL    18774<<ASSIGN  18784<>CALL
FPT_OPEN.ACSVEH_
     16271**DCL     16272--REDEF
FPT_OPEN.ALTKEYS_
     16277**DCL     16278--REDEF   16278--REDEF
FPT_OPEN.FPARAM_
     16274**DCL     18780<<ASSIGN
FPT_OPEN.HDR_
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:597  
     16276**DCL     16277--REDEF
FPT_OPEN.NAME_
     16270**DCL     17484<<ASSIGN
FPT_OPEN.TAB_
     16275**DCL     16276--REDEF
FPT_OPEN.UHL_
     16269**DCL     16270--REDEF   16270--REDEF
FPT_OPEN.V
     16278**DCL     17483--ASSIGN  18775--ASSIGN
FPT_OPEN.V.ACS#
     16289**DCL     17489<<ASSIGN
FPT_OPEN.V.ASN#
     16288**DCL     17486<<ASSIGN  18777<<ASSIGN
FPT_OPEN.V.DCB#
     16278**DCL     17485<<ASSIGN  18776<<ASSIGN
FPT_OPEN.V.FSN#
     16309**DCL     16309--REDEF   16309--REDEF
FPT_OPEN.V.FUN#
     16288**DCL     17487<<ASSIGN
FPT_OPEN.V.INITZ.SCRUB#
     16279**DCL     17490<<ASSIGN  18778<<ASSIGN
FPT_OPEN.V.ORG#
     16289**DCL     17488<<ASSIGN
FPT_OPEN.V_
     16269**DCL     17483<<ASSIGN  18775<<ASSIGN
FPT_OPEN.WSN_
     16275**DCL     16275--REDEF
FPT_READ
     16330**DCL     17496<<ASSIGN  17506<>CALL
FPT_READ.BUF_.BOUND
     16332**DCL     17499<<ASSIGN
FPT_READ.BUF_.BUF$
     16333**DCL     17498<<ASSIGN
FPT_READ.KEY_
     16330**DCL     17500<<ASSIGN
FPT_READ.STATION_
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:598  
     16333**DCL     16334--REDEF
FPT_READ.V
     16334**DCL     17497--ASSIGN
FPT_READ.V.DCB#
     16334**DCL     17503<<ASSIGN
FPT_READ.V.DVBYTE.REREAD#
     16345**DCL     16345--REDEF
FPT_READ.V.INDX#
     16343**DCL     16343--REDEF
FPT_READ.V.KEYR#
     16335**DCL     17502<<ASSIGN
FPT_READ.V.KEYS#
     16335**DCL     17501<<ASSIGN
FPT_READ.V_
     16330**DCL     17497<<ASSIGN
FPT_TIME
     15983**DCL     17338<<ASSIGN  17342<>CALL
FPT_TIME.DATE_
     15983**DCL     17340<<ASSIGN
FPT_TIME.TIME_
     15985**DCL     17341<<ASSIGN
FPT_TIME.V
     15987**DCL     17339--ASSIGN
FPT_TIME.V_
     15983**DCL     17339<<ASSIGN
FPT_TRMCTL IN PROCEDURE DILDEV
     19568**DCL     19795<<ASSIGN  19800<>CALL
FPT_TRMCTL.TRMCTL_ IN PROCEDURE DILDEV
     19574**DCL     19797<<ASSIGN
FPT_TRMCTL.V IN PROCEDURE DILDEV
     19576**DCL     19796--ASSIGN
FPT_TRMCTL.V.DCB# IN PROCEDURE DILDEV
     19576**DCL     19918<<ASSIGN  19936<<ASSIGN
FPT_TRMCTL.V.VLPTYPE# IN PROCEDURE DILDEV
     19576**DCL     19798<<ASSIGN
FPT_TRMCTL.V_ IN PROCEDURE DILDEV
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:599  
     19570**DCL     19796<<ASSIGN
FPT_TRMISC
     16366**DCL     16956<<ASSIGN  16985<>CALL
FPT_TRMISC.V
     16370**DCL     16957--ASSIGN
FPT_TRMISC.V.ANNOUNCE#
     16371**DCL     16965<<ASSIGN  16973<<ASSIGN  16981<<ASSIGN
FPT_TRMISC.V.BROADCAST#
     16370**DCL     16964<<ASSIGN  16975<<ASSIGN  16980<<ASSIGN
FPT_TRMISC.V.DCB#
     16370**DCL     16958<<ASSIGN
FPT_TRMISC.V.SEND#
     16370**DCL     16963<<ASSIGN  16977<<ASSIGN  16979<<ASSIGN
FPT_TRMISC.V_
     16368**DCL     16957<<ASSIGN
FPT_UNFID IN PROCEDURE DISPDCB
     17650**DCL     17675<<ASSIGN  17696<>CALL    18517<<ASSIGN  18535<>CALL
FPT_UNFID.ACCT_ IN PROCEDURE DISPDCB
     17651**DCL     17683<<ASSIGN  18520<<ASSIGN
FPT_UNFID.ASN_ IN PROCEDURE DISPDCB
     17653**DCL     17693<<ASSIGN  18532<<ASSIGN
FPT_UNFID.LEN_ IN PROCEDURE DISPDCB
     17653**DCL     17695<<ASSIGN
FPT_UNFID.NAME_ IN PROCEDURE DISPDCB
     17651**DCL     17680<<ASSIGN  18519<<ASSIGN
FPT_UNFID.PASS_ IN PROCEDURE DISPDCB
     17651**DCL     18521<<ASSIGN
FPT_UNFID.RES_ IN PROCEDURE DISPDCB
     17653**DCL     17694<<ASSIGN  18529<<ASSIGN
FPT_UNFID.SN_ IN PROCEDURE DISPDCB
     17652**DCL     17688<<ASSIGN  18524<<ASSIGN  18528<<ASSIGN
FPT_UNFID.TEXTFID_ IN PROCEDURE DISPDCB
     17650**DCL     17677<<ASSIGN  18534<<ASSIGN
FPT_UNFID.V IN PROCEDURE DISPDCB
     17654**DCL     17676--ASSIGN  18518--ASSIGN
FPT_UNFID.V_ IN PROCEDURE DISPDCB
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:600  
     17650**DCL     17676<<ASSIGN  18518<<ASSIGN
FPT_UNFID.WSN_ IN PROCEDURE DISPDCB
     17652**DCL     17692<<ASSIGN
F_FDS
     14540**DCL     20410<<ASSIGN  20440<>CALL    20465<>CALL
F_FDS.BUF_
     14557**DCL     20413<<ASSIGN  20452<<ASSIGN
F_FDS.FMT_
     14544**DCL     20414<<ASSIGN
F_FDS.NVECS#
     14568**DCL     20439<<ASSIGN  20456<<ASSIGN  20462<<ASSIGN
F_FDS.OUTPUT#
     14594**DCL     20411<<ASSIGN
F_FDS.VECTR$
     14570**DCL     20412<<ASSIGN
GOT_STREAM IN PROCEDURE FIND_OR_CREATE_STREAM
     20506**DCL     20733<<ASSIGN  20753<<ASSIGN  20756>>IF      20760>>IF      20768>>IF      20778>>IF
     20783>>IF
I
     14353**DCL     16694<<ASSIGN  16696>>DOWHILE 16697>>ASSIGN  16817<<ASSIGN  16817>>ASSIGN  16896<<ASSIGN
     16898>>DOWHILE 16899>>ASSIGN  16987<<ASSIGN  16987>>ASSIGN  17214<<ASSIGN  17217>>DOWHILE 17218>>ASSIGN
     17225<<ASSIGN  17225>>ASSIGN  18493<<DOINDEX 18494>>ASSIGN  18496>>ASSIGN  18498>>IF      18505>>IF
I IN PROCEDURE DISPBUDGET
     19046**DCL     19065<<ASSIGN  19066>>DOWHILE 19066>>DOWHILE 19067<<ASSIGN  19067>>ASSIGN  19069>>ASSIGN
     19069>>ASSIGN  19083<<ASSIGN  19084>>DOWHILE 19084>>DOWHILE 19085<<ASSIGN  19085>>ASSIGN  19087>>ASSIGN
     19087>>ASSIGN
I IN PROCEDURE DISPFLGS
     18599**DCL     18634<<DOINDEX
I IN PROCEDURE DISPLDEV
     19137**DCL     19178<<DOINDEX 19179>>DOCASE  19186>>DOINDEX 19187>>ASSIGN
I IN PROCEDURE DISP_OPT_TEXT
     19006**DCL     19014<<DOINDEX 19015>>IF      19018>>ASSIGN  19019>>ASSIGN  19022<<ASSIGN
I IN PROCEDURE DISP_OPT_YESNO
     18936**DCL     18950<<DOINDEX 18951>>IF      18954>>ASSIGN  18955>>ASSIGN  18958<<ASSIGN
I IN PROCEDURE DISP_PMSN
     18897**DCL     18905<<DOINDEX 18906>>IF      18909>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:601  
I IN PROCEDURE FIND_OR_CREATE_STREAM
     20504**DCL     20745<<DOINDEX 20746--IF      20749--ASSIGN  20750--IF      20750--IF      20754>>ASSIGN
     20756--IF      20762<<ASSIGN  20770<<DOINDEX 20771>>IF
I IN PROCEDURE SETUP_TCTL_DCB
     19901**DCL     19912<<DOINDEX 19913--IF      19915--IF      19915--IF      19918>>ASSIGN
IGNORE_CREATE_FLG IN PROCEDURE FIND_OR_CREATE_STREAM
     20507**DCL     20738<<ASSIGN  20740<<ASSIGN  20773<<ASSIGN  20778>>IF
IN$
     14341**DCL     17355<<ASSIGN  17362<>CALL    17364<<ASSIGN  17366<>CALL    17376<>CALL    17660<<ASSIGN
     17665<>CALL    17671<>CALL    17698<>CALL    17699<<ASSIGN  17708<>CALL    17720<>CALL    17727<>CALL
     17739<>CALL    17746<>CALL    17758<>CALL    17765<>CALL    17843<>CALL    17850<>CALL    17859<>CALL
     17866<>CALL    17878<>CALL    17899<>CALL    17914<>CALL    17921<>CALL    17926<>CALL    17977<>CALL
     17984<>CALL    17986<>CALL    17992<>CALL    17997<>CALL    18004<>CALL    18025<>CALL    18063<>CALL
     18080<>CALL    18093<>CALL    18096<>CALL    18098<>CALL    18101<>CALL    18159<>CALL    18171<>CALL
     18179<>CALL    18212<>CALL    18218<>CALL    18226<>CALL    18237<>CALL    18245<>CALL    18253<>CALL
     18255<>CALL    18313<>CALL    18316<>CALL    18332<>CALL    18340<>CALL    18350<>CALL    18362<>CALL
     18476<>CALL    18492<>CALL    18514<>CALL    18538<>CALL    18610<<ASSIGN  18641<>CALL    18648<>CALL
     18660<>CALL    18667<>CALL    18671<>CALL    18710<<ASSIGN  18719<>CALL    18724<>CALL    18730<>CALL
     18755<>CALL    18763<>CALL    18766<>CALL    18911<>CALL    18949<>CALL    18956<>CALL    18981<>CALL
     19013<>CALL    19020<>CALL    19026<>CALL    19029<>CALL    19061<<ASSIGN  19062<>CALL    19075<<ASSIGN
     19077<>CALL    19080<>CALL    19164<<ASSIGN  19740<>CALL    19747<>CALL    19778<>CALL    19782<>CALL
     19821<>CALL    19826<>CALL    19836<>CALL    19870<>CALL    19887<>CALL    19945<>CALL    19951<>CALL
     19976<>CALL    20220<<ASSIGN  20229<>CALL    20237<>CALL    20243<>CALL    20249<>CALL    20257<>CALL
     20264<>CALL    20270<>CALL    20276<>CALL    20305<>CALL    20307<>CALL    20312<>CALL    20317<>CALL
     20323<>CALL    20328<>CALL    20334<>CALL    20339<>CALL    20345<>CALL    20350<>CALL    20356<>CALL
     20361<>CALL
INBUFF
     14344**DCL     17364--ASSIGN  17365<<ASSIGN  17375<<ASSIGN  17439<<ASSIGN  17440--CALL    17660--ASSIGN
     17664<<ASSIGN  17670<<ASSIGN  17677--ASSIGN  17699--ASSIGN  17707<<ASSIGN  17711<<ASSIGN  17714<<ASSIGN
     17717<<ASSIGN  17726<<ASSIGN  17730<<ASSIGN  17733<<ASSIGN  17736<<ASSIGN  17745<<ASSIGN  17749<<ASSIGN
     17752<<ASSIGN  17755<<ASSIGN  17764<<ASSIGN  17768<<ASSIGN  17771<<ASSIGN  17774<<ASSIGN  17777<<ASSIGN
     17780<<ASSIGN  17783<<ASSIGN  17786<<ASSIGN  17789<<ASSIGN  17792<<ASSIGN  17795<<ASSIGN  17798<<ASSIGN
     17801<<ASSIGN  17804<<ASSIGN  17807<<ASSIGN  17810<<ASSIGN  17813<<ASSIGN  17816<<ASSIGN  17819<<ASSIGN
     17822<<ASSIGN  17825<<ASSIGN  17828<<ASSIGN  17831<<ASSIGN  17834<<ASSIGN  17837<<ASSIGN  17840<<ASSIGN
     17849<<ASSIGN  17853<<ASSIGN  17856<<ASSIGN  17865<<ASSIGN  17869<<ASSIGN  17872<<ASSIGN  17875<<ASSIGN
     17898<<ASSIGN  17902<<ASSIGN  17905<<ASSIGN  17908<<ASSIGN  17911<<ASSIGN  17920<<ASSIGN  17925<<ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:602  
     17976<<ASSIGN  17983<<ASSIGN  17985<<ASSIGN  17991<<ASSIGN  17996<<ASSIGN  18002<<CALLBLT 18003>>CALLBLT
     18009<<ASSIGN  18012<<ASSIGN  18015<<ASSIGN  18018<<ASSIGN  18060<<CALLBLT 18062>>CALLBLT 18077<<CALLBLT
     18079>>CALLBLT 18092<<ASSIGN  18094<<ASSIGN  18095>>CALLBLT 18097<<ASSIGN  18100<<ASSIGN  18158<<ASSIGN
     18170<<ASSIGN  18178<<ASSIGN  18211<<ASSIGN  18217<<ASSIGN  18224<<ASSIGN  18235<<CALLBLT 18236>>CALLBLT
     18243<<CALLBLT 18244>>CALLBLT 18251<<CALLBLT 18252>>CALLBLT 18254<<ASSIGN  18311<<CALLBLT 18312>>CALLBLT
     18315<<ASSIGN  18330<<ASSIGN  18338<<ASSIGN  18349<<ASSIGN  18353<<ASSIGN  18356<<ASSIGN  18359<<ASSIGN
     18466<<ASSIGN  18468<<ASSIGN  18470<<ASSIGN  18472<<ASSIGN  18474>>IF      18490<<ASSIGN  18500<<ASSIGN
     18507<<CALLBLT 18511<<CALLBLT 18536<<CALLBLT 18537>>CALLBLT 18610--ASSIGN  18640<<ASSIGN  18647<<ASSIGN
     18659<<ASSIGN  18663<<ASSIGN  18710--ASSIGN  18718<<ASSIGN  18723<<ASSIGN  18729<<ASSIGN  18748<<ASSIGN
     18754<<CALLBLT 18762<<CALLBLT 18765<<CALLBLT 18909<<ASSIGN  18910>>CALLBLT 18948<<ASSIGN  18954<<ASSIGN
     18979<<ASSIGN  19012<<ASSIGN  19018<<ASSIGN  19025<<ASSIGN  19027<<ASSIGN  19060<<ASSIGN  19061--ASSIGN
     19074<<ASSIGN  19075--ASSIGN  19079<<ASSIGN  19164--ASSIGN  19738<<CALLBLT 19744<<CALLBLT 19746<<CALLBLT
     19777<<ASSIGN  19780<<CALLBLT 19820<<CALLBLT 19825<<ASSIGN  19833<<ASSIGN  19834<<CALLBLT 19868<<ASSIGN
     19869<<CALLBLT 19885<<ASSIGN  19886<<CALLBLT 19944<<ASSIGN  19950<<ASSIGN  19975<<ASSIGN  20220--ASSIGN
     20228<<ASSIGN  20234<<CALLBLT 20236<<CALLBLT 20240<<ASSIGN  20242<<CALLBLT 20247<<ASSIGN  20255<<CALLBLT
     20263<<ASSIGN  20269<<ASSIGN  20275<<ASSIGN  20304<<ASSIGN  20306<<ASSIGN  20311<<ASSIGN  20316<<ASSIGN
     20322<<ASSIGN  20327<<ASSIGN  20333<<ASSIGN  20338<<ASSIGN  20344<<ASSIGN  20349<<ASSIGN  20355<<ASSIGN
     20360<<ASSIGN  20409<<ASSIGN  20414--ASSIGN  20457<<ASSIGN  20463<<CALLBLT
IND1
     14326**DCL     19745<<CALLBLT 19746>>CALLBLT 19749<<ASSIGN  19750>>IF      19753<>CALL    19754<<ASSIGN
     19755>>IF      19757<>CALL    19761<<ASSIGN  19762<>CALL    19764<<ASSIGN  19765<>CALL    19769<<ASSIGN
     19770>>IF      19772<>CALL    19773<<ASSIGN  19774>>IF      19782>>CALL    19827<<ASSIGN  19828>>CALLBLT
     19838<<ASSIGN  19839<>CALL    19840<<ASSIGN  19841<>CALL    19842<<ASSIGN  19843<>CALL    19844<<ASSIGN
     19845<>CALL    19859<<ASSIGN  19861<>CALL    19863<<ASSIGN  19864>>IF      19876<<ASSIGN  19878<>CALL
     19880<<ASSIGN  19881>>IF      20235<<CALLBLT 20236>>CALLBLT 20237>>CALL    20241<<ASSIGN  20242>>CALLBLT
     20243>>CALL    20248<<CALLBLT 20249>>CALL    20256<<CALLBLT 20257>>CALL    20279<<ASSIGN  20280>>CALLBLT
     20281<>CALL    20282<>CALL
IND2 IN PROCEDURE DILDEV
     19235**DCL     19830<<ASSIGN  19831>>CALLBLT
J
     14354**DCL     16959<<ASSIGN  16968>>DOWHILE 16969>>ASSIGN  16983<<ASSIGN  16983>>ASSIGN
J IN PROCEDURE DISPFLGS
     18600**DCL     18652<<DOINDEX 18653>>IF      18663>>ASSIGN  18664>>ASSIGN
J IN PROCEDURE DISPLDEV
     19138**DCL     19186<<DOINDEX 19187>>ASSIGN
K IN PROCEDURE FIND_OR_CREATE_STREAM
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:603  
     20505**DCL     20735<<ASSIGN  20745>>DOINDEX 20762>>ASSIGN
K IN PROCEDURE SETUP_TCTL_DCB
     19902**DCL     19907<<ASSIGN  19912>>DOINDEX
KEYWD IN PROCEDURE CNVRT_BLD
     18871**DCL     18869--PROC    18874--CALL
KEYWDSZE IN PROCEDURE CNVRT_BLD
     18870**DCL     18869--PROC    18874<>CALL
KEYWDVAL IN PROCEDURE CNVRT_BLD
     18872**DCL     18869--PROC    18876>>CALLBLT
KL$DREC.PASSWORD
     15527**DCL     15531--REDEF   17235>>IF      17242<<ASSIGN
KL$DREC.RENAME
     15550**DCL     15551--REDEF
K_NOTIFY
     11133**DCL     20203--CALL
K_WHEN
     14901**DCL     20441<<ASSIGN  20446--CALL
K_WHEN.NUM
     14904**DCL     20442<<ASSIGN
LDEVHDR
     14331**DCL     19718--ASSIGN  19804--ASSIGN
LDEVNHDR
     14332**DCL     20024--ASSIGN
LDEVS_EXIST
     14333**DCL     19172<<ASSIGN  19202<<ASSIGN  19722>>IF      19724<<ASSIGN  19808>>IF      19810<<ASSIGN
     20019>>IF
LDEVS_HDR_PRINTED
     14334**DCL     19144<<ASSIGN  19715>>IF      19720<<ASSIGN  19801>>IF      19806<<ASSIGN
LEN
     14357**DCL     14359--IMP-SIZ 17369<>CALL    17370<>CALL    17667<<ASSIGN  17668<>CALL    17687<<ASSIGN
     17688>>ASSIGN  17695--ASSIGN  17698<>CALL    17712<<ASSIGN  17715<<ASSIGN  17718<<ASSIGN  17720<>CALL
     17731<<ASSIGN  17734<<ASSIGN  17737<<ASSIGN  17739<>CALL    17750<<ASSIGN  17753<<ASSIGN  17756<<ASSIGN
     17758<>CALL    17769<<ASSIGN  17772<<ASSIGN  17775<<ASSIGN  17778<<ASSIGN  17781<<ASSIGN  17784<<ASSIGN
     17787<<ASSIGN  17790<<ASSIGN  17793<<ASSIGN  17796<<ASSIGN  17799<<ASSIGN  17802<<ASSIGN  17805<<ASSIGN
     17808<<ASSIGN  17811<<ASSIGN  17814<<ASSIGN  17817<<ASSIGN  17820<<ASSIGN  17823<<ASSIGN  17826<<ASSIGN
     17829<<ASSIGN  17832<<ASSIGN  17835<<ASSIGN  17838<<ASSIGN  17841<<ASSIGN  17843<>CALL    17854<<ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:604  
     17857<<ASSIGN  17859<>CALL    17870<<ASSIGN  17873<<ASSIGN  17876<<ASSIGN  17878<>CALL    17903<<ASSIGN
     17906<<ASSIGN  17909<<ASSIGN  17912<<ASSIGN  17914<>CALL    17932<>CALL    17933<>CALL    17982<<ASSIGN
     17984<>CALL    18003<<CALLBLT 18004<>CALL    18010<<ASSIGN  18013<<ASSIGN  18016<<ASSIGN  18019<<ASSIGN
     18021<<ASSIGN  18023>>IF      18025<>CALL    18062<<CALLBLT 18063<>CALL    18079<<CALLBLT 18080<>CALL
     18095<<CALLBLT 18096<>CALL    18167<>CALL    18168<>CALL    18214<<ASSIGN  18215<>CALL    18225<<ASSIGN
     18226<>CALL    18236<<CALLBLT 18237<>CALL    18244<<CALLBLT 18245<>CALL    18252<<CALLBLT 18253<>CALL
     18312<<CALLBLT 18313<>CALL    18331<<ASSIGN  18332<>CALL    18339<<ASSIGN  18340<>CALL    18354<<ASSIGN
     18357<<ASSIGN  18360<<ASSIGN  18362<>CALL    18491<<ASSIGN  18492<>CALL    18501<<ASSIGN  18504<<ASSIGN
     18507>>CALLBLT 18508<<ASSIGN  18508>>ASSIGN  18511>>CALLBLT 18512<<ASSIGN  18512>>ASSIGN  18514<>CALL
     18537<<CALLBLT 18538<>CALL    18664<<ASSIGN  18667<>CALL    18671<>CALL    18678<<ASSIGN  18679>>IF
     18683>>ASSIGN  18716<<CALLBLT 18717<>CALL    18720<<CALLBLT 18721<>CALL    18726<>CALL    18727<>CALL
     18732<<ASSIGN  18739<<ASSIGN  18739>>ASSIGN  18741>>ASSIGN  18741>>ASSIGN  18742<>CALL    18752<<CALLBLT
     18753<<ASSIGN  18753>>ASSIGN  18754>>CALLBLT 18755<>CALL    18760<<CALLBLT 18761<<ASSIGN  18761>>ASSIGN
     18762>>CALLBLT 18763<>CALL    18764<<CALLBLT 18765>>CALLBLT 18766>>CALL    18779<<ASSIGN  18780>>ASSIGN
     18781<<ASSIGN  18782>>ASSIGN  18786<<ASSIGN  18788<>CALL    18845<>CALL    18846<>CALL    18877<>CALL
     18878<>CALL    18910<<CALLBLT 18911<>CALL    18955<<ASSIGN  18956<>CALL    18980<<ASSIGN  18981<>CALL
     19019<<ASSIGN  19020<>CALL    19028<<CALLBLT 19029<>CALL    19076<<ASSIGN  19077<>CALL    19114<<CALLBLT
     19115<>CALL
LEN IN PROCEDURE DILDEV
     19240**DCL     19829<>CALL    19834>>CALLBLT 19836>>CALL    19974<<ASSIGN  19976<>CALL
LEN IN PROCEDURE DISPNOTIFY
     20195**DCL     20364<<ASSIGN  20365>>IF      20368>>ASSIGN  20374<<ASSIGN  20375>>IF      20378>>ASSIGN
LENGTH IN PROCEDURE PUT_FLAG
     19968**DCL     19964--PROC    19967--IMP-SIZ 19974>>ASSIGN  19975>>ASSIGN
LIST70
     17162**LABEL   17153--GOTO
LIST80
     17162**LABEL   17159--CALLALT
LISTDCB
     11154**DCL     17159--CALL
LOAD_VAR
     14885**DCL     17409--ASSIGN
LOAD_VAR.ETMF
     14885**DCL     17421>>IF      17423<<ASSIGN  17424>>CALLBLT
LOAD_VAR.RESP
     14885**DCL     17430>>IF      17432<<ASSIGN  17437<>CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:605  
LOAD_VAR.USERS
     14885**DCL     17412>>IF      17414<<ASSIGN  17415>>CALLBLT
M$CLOSE
        27**DCL-ENT 16942--CALL    16945--CALL    17251--CALL    17275--CALL    17532--CALL    17563--CALL
     20213--CALL    20218--CALL    20389--CALL    20435--CALL    20453--CALL    20469--CALL    20900--CALL
M$DEVICE
        31**DCL-ENT 17067--CALL
M$DISPLAY
        94**DCL-ENT 17410--CALL
M$DODCB
     14360**DCL     16618--CALL    16619--CALL
M$DRIBBLE
        57**DCL-ENT 16953--CALL
M$GTRMCTL
        51**DCL-ENT 19800--CALL
M$IBEX1_NUM
     11105**DCL     16741<>CALL    16932>>ASSIGN  17207<>CALL    17243<>CALL    17249>>ASSIGN  17273>>ASSIGN
     17485>>ASSIGN  17503>>ASSIGN  17530>>ASSIGN  17559--IF      17562>>ASSIGN  18776>>ASSIGN  19165>>ASSIGN
     19927>>ASSIGN  20201>>ASSIGN  20202<>CALL    20203<>CALL    20387--IF      20424>>ASSIGN  20445<>CALL
     20446<>CALL    20448--ASSIGN  20785>>ASSIGN
M$OPEN
        27**DCL-ENT 17491--CALL    18784--CALL    19711--CALL    19934--CALL    20792--CALL
M$READ
        28**DCL-ENT 17506--CALL
M$TIME
        94**DCL-ENT 17342--CALL
M$TRMISC
        56**DCL-ENT 16985--CALL
M$UC_NUM
     11102**DCL     16958>>ASSIGN
M$UNFID
        90**DCL-ENT 17696--CALL    18535--CALL
MOPS_7_2_STR IN PROCEDURE DISPBUDGET
     19050**DCL     19064>>CALLBLT 19082>>CALLBLT
MOVE_COMMA_BLANK IN PROCEDURE DILDEV
     19942**PROC    19860--CALL    19867--CALL    19877--CALL    19884--CALL    19973--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:606  
MSGFLAG
     14641**DCL     18806<<ASSIGN  18811<>CALL
N IN PROCEDURE DILDEV
     19216**DCL     19215--PROC    19668>>IF      19668>>IF      19669>>DOWHILE 19669>>DOWHILE 19671<<ASSIGN
     19671>>ASSIGN  19671>>IF      19673>>IF      19678>>IF      19684>>ASSIGN  19686<<ASSIGN  19686>>ASSIGN
     19694<<ASSIGN  19694>>ASSIGN  19709>>ASSIGN  19738>>CALLBLT 19820>>CALLBLT
N IN PROCEDURE DISPLDEV
     19139**DCL     19170<<ASSIGN  19174<>CALL    19201<<ASSIGN  19204<>CALL
N IN PROCEDURE FIND_ALL_LDEVS
     19990**DCL     19988--PROC    19998<>CALL
NEED_COMMA IN PROCEDURE DISPFLGS
     18597**DCL     18633<<ASSIGN  18656>>IF      18665>>IF      18673<<ASSIGN  18687<<ASSIGN
NEWPASSWORD
     14340**DCL     17213<<ASSIGN  17223<<ASSIGN  17231<>CALL    17242>>ASSIGN
NR IN PROCEDURE DISPSYS
     17399**DCL     17418--ASSIGN
NR.HDR IN PROCEDURE DISPSYS
     17400**DCL     17417<<ASSIGN
NR.USRS IN PROCEDURE DISPSYS
     17401**DCL     17415<<CALLBLT 17416<>CALL    17416--CALL
OLDPASSWORD
     14339**DCL     17212<<ASSIGN  17221<<ASSIGN  17230<>CALL    17235>>IF
ONOVERINTO$
     14315**DCL     16616<<ASSIGN  16618<>CALL    17157<<ASSIGN  17159<>CALL
OOPS IN PROCEDURE PUT_FLAG
     19983**LABEL   19976--CALLALT
OPEN IN PROCEDURE DILDEV
     19239**DCL     19712<<ASSIGN  19905<<ASSIGN  19937<<ASSIGN  19958>>IF
OPEN_FLG IN PROCEDURE FIND_OR_CREATE_STREAM
     20499**DCL     20475--PROC    20732<<ASSIGN  20795<<ASSIGN
OPNDCB IN PROCEDURE FIND_OR_CREATE_STREAM
     20575**DCL     20781<<ASSIGN  20792<>CALL
OPNDCB.ACSVEH_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20577**DCL     20578--REDEF
OPNDCB.ALTKEYS_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20583**DCL     20584--REDEF   20584--REDEF
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:607  
OPNDCB.HDR_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20582**DCL     20583--REDEF
OPNDCB.TAB_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20581**DCL     20582--REDEF
OPNDCB.UHL_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20575**DCL     20576--REDEF   20576--REDEF
OPNDCB.V IN PROCEDURE FIND_OR_CREATE_STREAM
     20584**DCL     20782--ASSIGN
OPNDCB.V.ASN# IN PROCEDURE FIND_OR_CREATE_STREAM
     20594**DCL     20791<<ASSIGN
OPNDCB.V.DCB# IN PROCEDURE FIND_OR_CREATE_STREAM
     20584**DCL     20789<<ASSIGN
OPNDCB.V.FSN# IN PROCEDURE FIND_OR_CREATE_STREAM
     20615**DCL     20615--REDEF   20615--REDEF
OPNDCB.V.RES# IN PROCEDURE FIND_OR_CREATE_STREAM
     20599**DCL     20790<<ASSIGN
OPNDCB.V_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20575**DCL     20782<<ASSIGN
OPNDCB.WSN_ IN PROCEDURE FIND_OR_CREATE_STREAM
     20581**DCL     20581--REDEF
OPNMYDCB IN PROCEDURE DILDEV
     19315**DCL     19707<<ASSIGN  19711<>CALL    19925<<ASSIGN  19934<>CALL
OPNMYDCB.ACSVEH_ IN PROCEDURE DILDEV
     19317**DCL     19318--REDEF
OPNMYDCB.ALTKEYS_ IN PROCEDURE DILDEV
     19323**DCL     19324--REDEF   19324--REDEF
OPNMYDCB.HDR_ IN PROCEDURE DILDEV
     19322**DCL     19323--REDEF
OPNMYDCB.TAB_ IN PROCEDURE DILDEV
     19321**DCL     19322--REDEF
OPNMYDCB.UHL_ IN PROCEDURE DILDEV
     19315**DCL     19316--REDEF   19316--REDEF
OPNMYDCB.V IN PROCEDURE DILDEV
     19324**DCL     19710--ASSIGN  19926--ASSIGN
OPNMYDCB.V.ASN# IN PROCEDURE DILDEV
     19334**DCL     19933<<ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:608  
OPNMYDCB.V.DCB# IN PROCEDURE DILDEV
     19324**DCL     19708<<ASSIGN  19931<<ASSIGN
OPNMYDCB.V.FSN# IN PROCEDURE DILDEV
     19355**DCL     19355--REDEF   19355--REDEF
OPNMYDCB.V.RES# IN PROCEDURE DILDEV
     19339**DCL     19709<<ASSIGN  19932<<ASSIGN
OPNMYDCB.V_ IN PROCEDURE DILDEV
     19315**DCL     19710<<ASSIGN  19926<<ASSIGN
OPNMYDCB.WSN_ IN PROCEDURE DILDEV
     19321**DCL     19321--REDEF
OPT IN PROCEDURE DILDEV
     19217**DCL     19215--PROC    19678>>IF
OPT IN PROCEDURE DISPLDEV
     19141**DCL     19150<<ASSIGN  19155<<ASSIGN  19160<<ASSIGN  19174<>CALL    19182<<ASSIGN  19191<<ASSIGN
     19195<<ASSIGN  19204<>CALL
OPT IN PROCEDURE FIND_ALL_LDEVS
     19991**DCL     19988--PROC    19998<>CALL    20030>>ASSIGN
OPTION IN PROCEDURE DISP_OPT_TEXT
     19002**DCL     19001--PROC    19015>>IF
OPTLEN IN PROCEDURE DILDEV
     19218**DCL     19215--PROC    19678>>IF      19678>>IF
OPTLEN IN PROCEDURE DISPLDEV
     19142**DCL     19151<<ASSIGN  19156<<ASSIGN  19161<<ASSIGN  19174<>CALL    19183<<ASSIGN  19192<<ASSIGN
     19196<<ASSIGN  19204<>CALL
OPTLEN IN PROCEDURE FIND_ALL_LDEVS
     19992**DCL     19988--PROC    19998<>CALL    20021>>IF      20029>>ASSIGN  20031>>IF
OPTN IN PROCEDURE DISP_OPT_YESNO
     18937**DCL     18935--PROC    18951>>IF
OPT_TBL.HDR
     14387**DCL     18954>>ASSIGN  19018>>ASSIGN
OPT_TBL.LEN
     14384**DCL     18955>>ASSIGN  19019>>ASSIGN
OPT_TBL.OPTION
     14397**DCL     18951>>IF      19015>>IF
OPT_TBLSZE
     14382**DCL     18950>>DOINDEX 18958>>ASSIGN  19014>>DOINDEX 19022>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:609  
OSZE IN PROCEDURE DISP_OPT_TEXT
     19003**DCL     19001--PROC    19004--IMP-SIZ 19009>>IF      19027>>ASSIGN  19028>>CALLBLT
OTEXT$ IN PROCEDURE DISP_OPT_TEXT
     19005**DCL     19001--PROC    19009>>IF      19027>>ASSIGN  19028>>CALLBLT
OUTBUFF
     14345**DCL     17356--ASSIGN  17358<<ASSIGN  17361--ASSIGN  17433--ASSIGN  17435<<ASSIGN  17659<<ASSIGN
     17661--ASSIGN  18609<<ASSIGN  18611--ASSIGN  18636<<ASSIGN  18711<<ASSIGN  18712--ASSIGN  18840--ASSIGN
     18842<<ASSIGN  19053--ASSIGN  19055<<ASSIGN  19110--ASSIGN  19112<<ASSIGN  19145--ASSIGN  19171<<ASSIGN
     19200<<ASSIGN  19728<<ASSIGN  19814<<ASSIGN  19999>>IF      20007<<ASSIGN  20010>>IF      20018<<ASSIGN
     20209<<ASSIGN  20211--ASSIGN  20221--ASSIGN  20223<<ASSIGN  20285>>IF      20297<<ASSIGN  20413--ASSIGN
     20416<<ASSIGN  20452--ASSIGN
OUTBUFF$
     14343**DCL     17356<<ASSIGN  17357>>ASSIGN  17362<>CALL    17366<>CALL    17370<>CALL    17376<>CALL
     17433<<ASSIGN  17434>>ASSIGN  17440<>CALL    17442>>ASSIGN  17443>>ASSIGN  17662<<ASSIGN  17665<>CALL
     17668<>CALL    17671<>CALL    17698<>CALL    17708<>CALL    17720<>CALL    17727<>CALL    17739<>CALL
     17746<>CALL    17758<>CALL    17765<>CALL    17843<>CALL    17850<>CALL    17859<>CALL    17866<>CALL
     17878<>CALL    17899<>CALL    17914<>CALL    17921<>CALL    17926<>CALL    17933<>CALL    17977<>CALL
     17984<>CALL    17986<>CALL    17992<>CALL    17997<>CALL    18004<>CALL    18025<>CALL    18063<>CALL
     18080<>CALL    18093<>CALL    18096<>CALL    18098<>CALL    18101<>CALL    18159<>CALL    18168<>CALL
     18171<>CALL    18179<>CALL    18212<>CALL    18215<>CALL    18218<>CALL    18226<>CALL    18237<>CALL
     18245<>CALL    18253<>CALL    18255<>CALL    18313<>CALL    18316<>CALL    18332<>CALL    18340<>CALL
     18350<>CALL    18362<>CALL    18476<>CALL    18492<>CALL    18514<>CALL    18538<>CALL    18546>>IF
     18549>>ASSIGN  18550>>ASSIGN  18611<<ASSIGN  18612>>ASSIGN  18635>>ASSIGN  18641<>CALL    18648<>CALL
     18660<>CALL    18667<>CALL    18671<>CALL    18678>>ASSIGN  18682>>ASSIGN  18713<<ASSIGN  18715>>ASSIGN
     18717<>CALL    18719<>CALL    18721<>CALL    18724<>CALL    18727<>CALL    18730<>CALL    18742<>CALL
     18743>>ASSIGN  18744>>ASSIGN  18747>>ASSIGN  18755<>CALL    18763<>CALL    18766<>CALL    18801>>ASSIGN
     18840<<ASSIGN  18841>>ASSIGN  18846<>CALL    18848>>ASSIGN  18849>>ASSIGN  18874<>CALL    18878<>CALL
     18911<>CALL    18949<>CALL    18956<>CALL    18981<>CALL    19013<>CALL    19020<>CALL    19026<>CALL
     19029<>CALL    19053<<ASSIGN  19054>>ASSIGN  19062<>CALL    19070<>CALL    19077<>CALL    19080<>CALL
     19088<>CALL    19089>>ASSIGN  19090>>ASSIGN  19110<<ASSIGN  19111>>ASSIGN  19115<>CALL    19116>>ASSIGN
     19117>>ASSIGN  19145<<ASSIGN  19173>>ASSIGN  19729>>ASSIGN  19740<>CALL    19747<>CALL    19778<>CALL
     19782<>CALL    19815>>ASSIGN  19821<>CALL    19826<>CALL    19836<>CALL    19870<>CALL    19887<>CALL
     19945<>CALL    19947>>IF      19951<>CALL    19976<>CALL    20001>>ASSIGN  20002>>ASSIGN  20012>>ASSIGN
     20013>>ASSIGN  20221<<ASSIGN  20222>>ASSIGN  20225>>ASSIGN  20229<>CALL    20237<>CALL    20243<>CALL
     20249<>CALL    20257<>CALL    20264<>CALL    20270<>CALL    20276<>CALL    20282<>CALL    20288>>ASSIGN
     20289>>ASSIGN  20299>>ASSIGN  20301>>ASSIGN  20305<>CALL    20312<>CALL    20323<>CALL    20334<>CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:610  
     20345<>CALL    20356<>CALL    20364>>ASSIGN  20369>>ASSIGN
OUTBUFF2 IN PROCEDURE DISPNOTIFY
     20192**DCL     20293<<ASSIGN  20294--ASSIGN
OUTBUFF2$ IN PROCEDURE DISPNOTIFY
     20193**DCL     20294<<ASSIGN  20295>>ASSIGN  20307<>CALL    20317<>CALL    20328<>CALL    20339<>CALL
     20350<>CALL    20361<>CALL    20374>>ASSIGN  20379>>ASSIGN
P$B.CODE
     15637**DCL     16701>>DOCASE  16901>>DOCASE  16971>>DOCASE  17219>>DOCASE  17351>>IF      19146>>DOCASE
     19179>>DOCASE  19188>>DOCASE
P$B.NSUBLKS
     15641**DCL     16603>>IF      16688>>IF      16696>>DOWHILE 16898>>DOWHILE 16960>>IF      16968>>DOWHILE
     17035>>IF      17045>>IF      17059>>IF      17141>>IF      17215>>IF      17217>>DOWHILE 19167>>IF
     19178>>DOINDEX 19186>>DOINDEX
P$B.SUBLK$
     15662**DCL     16616>>ASSIGN  16617>>ASSIGN  16617>>ASSIGN  16697>>ASSIGN  16738>>ASSIGN  16899>>ASSIGN
     16969>>ASSIGN  17045>>IF      17047>>ASSIGN  17047>>ASSIGN  17047>>ASSIGN  17047>>ASSIGN  17049>>CALLBLT
     17049>>CALLBLT 17049>>CALLBLT 17049>>CALLBLT 17049>>CALLBLT 17049>>CALLBLT 17049>>CALLBLT 17049>>CALLBLT
     17059>>IF      17059>>IF      17059>>IF      17059>>IF      17059>>IF      17157>>ASSIGN  17158>>ASSIGN
     17158>>ASSIGN  17218>>ASSIGN  19179>>DOCASE  19186>>DOINDEX 19187>>ASSIGN  19187>>ASSIGN
P$PCB
     15725**DCL        16--PROC    16596--ENTRY   16678--ENTRY   16715<>CALL    16716<>CALL    16717<>CALL
     16719<>CALL    16721<>CALL    16722<>CALL    16723<>CALL    16724<>CALL    16725<>CALL    16726<>CALL
     16727<>CALL    16728<>CALL    16758<>CALL    16761<>CALL    16764<>CALL    16769<>CALL    16772<>CALL
     16777<>CALL    16780<>CALL    16783<>CALL    16786<>CALL    16793<>CALL    16795<>CALL    16798<>CALL
     16801<>CALL    16804<>CALL    16807<>CALL    16809<>CALL    16892--ENTRY   17011--ENTRY   17030--ENTRY
     17095--ENTRY   17134--ENTRY   17200--ENTRY   17288--ENTRY   17301--ENTRY   17314--ENTRY   17335--ENTRY
     17351--IF      18811<>CALL
P$PCB.OUT$
     15738**DCL     16599>>ASSIGN  16681>>ASSIGN  16714<<ASSIGN  16757<<ASSIGN  16760<<ASSIGN  16763<<ASSIGN
     16768<<ASSIGN  16771<<ASSIGN  16776<<ASSIGN  16779<<ASSIGN  16782<<ASSIGN  16785<<ASSIGN  16792<<ASSIGN
     16797<<ASSIGN  16800<<ASSIGN  16803<<ASSIGN  16806<<ASSIGN  16895>>ASSIGN  17034>>ASSIGN  17137>>ASSIGN
     17203>>ASSIGN  17351>>IF      18810<<ASSIGN
P$S.COUNT
     15698**DCL     15701--IMP-SIZ 17047>>ASSIGN  17049>>CALLBLT 17049>>CALLBLT 17059>>IF      17221>>ASSIGN
     17223>>ASSIGN  19191>>ASSIGN  19195>>ASSIGN
P$S.CPOS
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:611  
     15690**DCL     16833>>ASSIGN
P$S.TEXT
     15701**DCL     17047>>ASSIGN  17049>>CALLBLT 17049>>CALLBLT 17059>>IF      17221>>ASSIGN  17223>>ASSIGN
     19191>>ASSIGN  19195>>ASSIGN
PASSWORD50
     17250**LABEL   17207--CALLALT 17243--CALLALT
PASSWORD60
     17250**LABEL   17238--GOTO
PASSWORD68
     17268**LABEL   17268--GOTO
PASSWORD70
     17274**LABEL   17251--CALLALT 17275--CALLALT
PMSN$ IN PROCEDURE DISP_PMSN
     18896**DCL     18895--PROC    18904>>ASSIGN
PMSN50 IN PROCEDURE DISP_PMSN
     18913**LABEL   18911--CALLALT
PUT_FLAG IN PROCEDURE DILDEV
     19964**PROC    19846--CALL    19848--CALL    19850--CALL    19852--CALL    19854--CALL
RES
     14352**DCL     18529--ASSIGN  18530<<ASSIGN
RES#
     14330**DCL     17047<<ASSIGN  17049<<CALLBLT 17051<>CALL    17054>>ASSIGN
RES# IN PROCEDURE FIND_OR_CREATE_STREAM
     20493**DCL     20475--PROC    20494--REDEF   20750>>IF      20750>>IF      20771>>IF      20790>>ASSIGN
RES#_R.NUM IN PROCEDURE FIND_OR_CREATE_STREAM
     20496**DCL     20736>>IF
SEG$2.ACCUM_CHG
     15004**DCL     19063>>CALLBLT 19081>>CALLBLT
SEG$2.CPBUFF$
     14999**DCL     20446>>CALL    20455>>ASSIGN
SEG$2.ERRBUF
     14980**DCL     16628--CALL    16819--IF      16834--CALL    17165--CALL    17267--CALL    17547--CALL
SEG$2.FPT_WRITE$
     14995**DCL     16682>>ASSIGN  16683>>ASSIGN  16683>>ASSIGN  17348>>ASSIGN  17349>>ASSIGN  17349>>ASSIGN
     17350>>ASSIGN  17361>>ASSIGN  17380<>CALL    17418>>ASSIGN  17419<>CALL    17427>>ASSIGN  17428<>CALL
     17442>>ASSIGN  17443>>ASSIGN  17444<>CALL    17515>>ASSIGN  17516<>CALL    17541>>ASSIGN  17542<>CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:612  
     18549>>ASSIGN  18550>>ASSIGN  18551<>CALL    18603>>ASSIGN  18604<>CALL    18682>>ASSIGN  18683>>ASSIGN
     18684<>CALL    18715>>ASSIGN  18743>>ASSIGN  18744>>ASSIGN  18745<>CALL    18801>>ASSIGN  18802<>CALL
     18848>>ASSIGN  18849>>ASSIGN  18850<>CALL    19089>>ASSIGN  19090>>ASSIGN  19091<>CALL    19116>>ASSIGN
     19117>>ASSIGN  19118<>CALL    19718>>ASSIGN  19719<>CALL    19804>>ASSIGN  19805<>CALL    20001>>ASSIGN
     20002>>ASSIGN  20003<>CALL    20012>>ASSIGN  20013>>ASSIGN  20014<>CALL    20024>>ASSIGN  20025<>CALL
     20210>>ASSIGN  20211>>ASSIGN  20212<>CALL    20224>>ASSIGN  20225>>ASSIGN  20226<>CALL    20288>>ASSIGN
     20289>>ASSIGN  20290<>CALL    20298>>ASSIGN  20299>>ASSIGN  20300<>CALL    20368>>ASSIGN  20369>>ASSIGN
     20370<>CALL    20378>>ASSIGN  20379>>ASSIGN  20380<>CALL
SEG$2.HLP$
     14985**DCL     17235>>IF      17242>>ASSIGN
SEG$2.LLDCB#
     14975**DCL     17039>>ASSIGN  20449--ASSIGN
SEG$2.WHEN_CNTL_REC$
     15003**DCL     16936>>ASSIGN  16936>>ASSIGN  16938>>ASSIGN  16938>>ASSIGN  20427>>IF      20427>>IF
     20427>>IF      20427>>IF      20442>>ASSIGN
SEG2$
     11092**DCL     14955--IMP-PTR 16628>>CALL    16682>>ASSIGN  16683>>ASSIGN  16683>>ASSIGN  16819>>IF
     16834>>CALL    16936>>ASSIGN  16936>>ASSIGN  16938>>ASSIGN  16938>>ASSIGN  17039>>ASSIGN  17165>>CALL
     17235>>IF      17242>>ASSIGN  17267>>CALL    17348>>ASSIGN  17349>>ASSIGN  17349>>ASSIGN  17350>>ASSIGN
     17361>>ASSIGN  17380>>CALL    17418>>ASSIGN  17419>>CALL    17427>>ASSIGN  17428>>CALL    17442>>ASSIGN
     17443>>ASSIGN  17444>>CALL    17515>>ASSIGN  17516>>CALL    17541>>ASSIGN  17542>>CALL    17547>>CALL
     18549>>ASSIGN  18550>>ASSIGN  18551>>CALL    18603>>ASSIGN  18604>>CALL    18682>>ASSIGN  18683>>ASSIGN
     18684>>CALL    18715>>ASSIGN  18743>>ASSIGN  18744>>ASSIGN  18745>>CALL    18801>>ASSIGN  18802>>CALL
     18848>>ASSIGN  18849>>ASSIGN  18850>>CALL    19063>>CALLBLT 19081>>CALLBLT 19089>>ASSIGN  19090>>ASSIGN
     19091>>CALL    19116>>ASSIGN  19117>>ASSIGN  19118>>CALL    19718>>ASSIGN  19719>>CALL    19804>>ASSIGN
     19805>>CALL    20001>>ASSIGN  20002>>ASSIGN  20003>>CALL    20012>>ASSIGN  20013>>ASSIGN  20014>>CALL
     20024>>ASSIGN  20025>>CALL    20210>>ASSIGN  20211>>ASSIGN  20212>>CALL    20224>>ASSIGN  20225>>ASSIGN
     20226>>CALL    20288>>ASSIGN  20289>>ASSIGN  20290>>CALL    20298>>ASSIGN  20299>>ASSIGN  20300>>CALL
     20368>>ASSIGN  20369>>ASSIGN  20370>>CALL    20378>>ASSIGN  20379>>ASSIGN  20380>>CALL    20427>>IF
     20427>>IF      20427>>IF      20427>>IF      20442>>ASSIGN  20446>>CALL    20449>>ASSIGN  20455>>ASSIGN
SEG3$
     11093**DCL     16160--IMP-PTR 16755<>CALL    16839<>CALL    17473<>CALL    17498>>ASSIGN  17533<>CALL
     17565<>CALL    17678>>IF      17680>>ASSIGN  17681>>IF      17683>>ASSIGN  17684>>IF      17687>>ASSIGN
     17688>>ASSIGN  17690>>IF      17692>>ASSIGN  17693>>ASSIGN  17694>>ASSIGN  17700>>IF      17702>>CALL
     17704>>IF      17709>>DOCASE  17723>>IF      17728>>DOCASE  17742>>IF      17747>>DOCASE  17761>>IF
     17766>>DOCASE  17846>>IF      17851>>DOCASE  17862>>IF      17867>>DOCASE  17881>>IF      17884>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:613  
     17888>>IF      17891>>ASSIGN  17895>>IF      17900>>DOCASE  17917>>IF      17922>>IF      17931>>CALLBLT
     17937>>IF      17940>>ASSIGN  17944>>IF      17947>>ASSIGN  17951>>IF      17954>>ASSIGN  17958>>IF
     17961>>ASSIGN  17965>>IF      17968>>ASSIGN  17972>>IF      17974>>DOCASE  17978>>ASSIGN  17979>>ASSIGN
     17995>>CALL    17999>>ASSIGN  18085>>IF      18088>>ASSIGN  18089>>ASSIGN  18106>>CALL    18107>>CALL
     18109>>CALL    18110>>IF      18113>>CALL    18115>>CALL    18119>>IF      18122>>ASSIGN  18126>>IF
     18129>>ASSIGN  18134>>IF      18137>>ASSIGN  18142>>IF      18146>>IF      18149>>ASSIGN  18155>>IF
     18163>>IF      18166>>CALLBLT 18182>>CALL    18184>>IF      18187>>IF      18190>>ASSIGN  18194>>IF
     18197>>ASSIGN  18201>>IF      18204>>ASSIGN  18208>>IF      18214>>ASSIGN  18215>>CALL    18221>>IF
     18230>>CALL    18232>>IF      18235>>CALLBLT 18240>>IF      18243>>CALLBLT 18248>>IF      18251>>CALLBLT
     18259>>IF      18262>>ASSIGN  18267>>IF      18270>>ASSIGN  18273>>IF      18276>>ASSIGN  18280>>CALL
     18282>>IF      18285>>ASSIGN  18289>>CALL    18290>>CALL    18292>>IF      18295>>ASSIGN  18301>>IF
     18304>>CALL    18305>>ASSIGN  18308>>IF      18311>>CALLBLT 18322>>IF      18327>>IF      18346>>IF
     18351>>DOCASE  18364>>CALL    18365>>IF      18367>>CALL    18368>>CALL    18369>>CALL    18370>>CALL
     18371>>CALL    18372>>IF      18374>>CALL    18376>>IF      18379>>ASSIGN  18384>>IF      18387>>ASSIGN
     18394>>IF      18396>>DOCASE  18398>>CALL    18400>>CALL    18402>>CALL    18404>>CALL    18406>>CALL
     18408>>CALL    18410>>ASSIGN  18415>>CALL    18417>>CALL    18419>>CALL    18419>>CALL    18422>>CALL
     18422>>CALL    18425>>CALL    18425>>CALL    18428>>CALL    18430>>CALL    18432>>CALL    18432>>CALL
     18435>>CALL    18435>>CALL    18438>>CALL    18445>>CALL    18447>>ASSIGN  18452>>ASSIGN  18457>>CALL
     18459>>ASSIGN  18464>>DOCASE  18477>>ASSIGN  18486>>IF      18488>>DOCASE  18493>>DOINDEX 18494>>ASSIGN
     18496>>ASSIGN  18498>>IF      18505>>IF      18519>>ASSIGN  18520>>ASSIGN  18521>>ASSIGN  18522>>IF
     18527>>ASSIGN  18540>>CALL    18541>>CALL    18542>>IF      18544>>CALL    18773<>CALL    18780>>ASSIGN
     18782>>ASSIGN  18787>>ASSIGN  18797<>CALL
SETUP_TCTL_DCB IN PROCEDURE DILDEV
     19897**PROC    19799--CALL
SET_FLG IN PROCEDURE DISPFLGS
     18598**DCL     18632<<ASSIGN  18637>>IF      18653>>IF      18686<<ASSIGN
SIZ IN PROCEDURE DISPLAY_NORMAL_LDEV
     19702**DCL     19731<<ASSIGN  19736<<ASSIGN  19740<>CALL
SRCHTBL
     15621**DCL     19745>>CALLBLT 20235>>CALLBLT 20248>>CALLBLT 20256>>CALLBLT
STARA
     11121**DCL     17484--ASSIGN
STAR_S_IS_OPEN
     14337**DCL     16934<>CALL    16940<>CALL    20425<>CALL    20433>>IF      20443>>IF
STEPCC IN PROCEDURE DISPSTEPCC
     18837**DCL     18844<<CALLBLT 18845<>CALL    18845--CALL    18846--CALL
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:614  
STREAM IN PROCEDURE DILDEV
     19238**DCL     19684<<ASSIGN  19915>>IF      19932>>ASSIGN
STREAM_OPEN
     14329**DCL     17041<<ASSIGN  17051<>CALL    17069>>IF
SYSID
     14373**DCL     17368<<CALLBLT 17369<>CALL    17369--CALL    17370--CALL    18725<<CALLBLT 18726<>CALL
     18726--CALL    18727--CALL
TAB2_VAL IN PROCEDURE DISPFLGS
     18601**DCL     18643<<ASSIGN  18650<<ASSIGN  18660<>CALL    18667<>CALL    18679>>IF
TAB_VAL
     14355**DCL     16752<<ASSIGN  16753<>CALL    17359<<ASSIGN  17362<>CALL    17366<>CALL    17370<>CALL
     17376<>CALL    17436<<ASSIGN  17518<<ASSIGN  17519<>CALL    18613<<ASSIGN  18641<>CALL    18643>>ASSIGN
     18648<>CALL    18650>>ASSIGN  18714<<ASSIGN  18717<>CALL    18755<>CALL    18874<>CALL    18878<>CALL
     18911<>CALL    18949<>CALL    18956<>CALL    18981<>CALL    19013<>CALL    19020<>CALL    19026<>CALL
     19029<>CALL    19062<>CALL    19077<>CALL    19080<>CALL    19730<<ASSIGN  19731>>ASSIGN  19735<<ASSIGN
     19778<>CALL    19782<>CALL    19816<<ASSIGN  19819<<ASSIGN  19870<>CALL    19887<>CALL    19945<>CALL
     19947>>IF      19951<>CALL    19976<>CALL    20303<<ASSIGN  20305<>CALL    20307<>CALL    20365>>IF
     20375>>IF
TAB_VAL IN PROCEDURE DISPDCB
     17586**DCL     17583--PROC    17665<>CALL    17708<>CALL    17720<>CALL    17727<>CALL    17739<>CALL
     17746<>CALL    17758<>CALL    17765<>CALL    17843<>CALL    17850<>CALL    17859<>CALL    17866<>CALL
     17878<>CALL    17899<>CALL    17914<>CALL    17921<>CALL    17926<>CALL    17933<>CALL    17977<>CALL
     17984<>CALL    17986<>CALL    17992<>CALL    17997<>CALL    18004<>CALL    18025<>CALL    18063<>CALL
     18080<>CALL    18093<>CALL    18096<>CALL    18098<>CALL    18101<>CALL    18159<>CALL    18168<>CALL
     18171<>CALL    18179<>CALL    18212<>CALL    18215<>CALL    18218<>CALL    18226<>CALL    18237<>CALL
     18245<>CALL    18253<>CALL    18255<>CALL    18313<>CALL    18316<>CALL    18332<>CALL    18340<>CALL
     18350<>CALL    18362<>CALL    18476<>CALL    18492<>CALL    18514<>CALL    18538<>CALL    18546>>IF
TBUFF IN PROCEDURE CNVRT_BLD
     18873**DCL     18876<<CALLBLT 18877<>CALL    18877--CALL    18878--CALL
TBUFF IN PROCEDURE DISPDCB
     17584**DCL     17931<<CALLBLT 17932<>CALL    17932--CALL    17933--CALL    18166<<CALLBLT 18167<>CALL
     18167--CALL    18168--CALL
TEMP
     14322**DCL     14323--REDEF   18731<<ASSIGN  18735>>DOUNTIL 18738<<ASSIGN  20235<<CALLBLT 20248<<CALLBLT
     20256<<CALLBLT 20448<<ASSIGN
TEMP IN PROCEDURE DILDEV
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:615  
     19236**DCL     19745<<CALLBLT 19832<>CALL    19834>>CALLBLT 19836>>CALL
TEMP$
     14319**DCL     16697<<ASSIGN  16701>>DOCASE  16714>>ASSIGN  16738>>ASSIGN  16757>>ASSIGN  16760>>ASSIGN
     16763>>ASSIGN  16768>>ASSIGN  16771>>ASSIGN  16776>>ASSIGN  16779>>ASSIGN  16782>>ASSIGN  16785>>ASSIGN
     16792>>ASSIGN  16797>>ASSIGN  16800>>ASSIGN  16803>>ASSIGN  16806>>ASSIGN  16833>>ASSIGN  16899<<ASSIGN
     16901>>DOCASE  16960>>IF      16968>>DOWHILE 16969>>ASSIGN  17218<<ASSIGN  17219>>DOCASE  17221>>ASSIGN
     17221>>ASSIGN  17223>>ASSIGN  17223>>ASSIGN  18810>>ASSIGN  19146>>DOCASE  19167>>IF      19178>>DOINDEX
     19179>>DOCASE  19186>>DOINDEX 19187>>ASSIGN
TEMP1$
     14320**DCL     16969<<ASSIGN  16971>>DOCASE  17979<<ASSIGN  17982>>ASSIGN  17983>>ASSIGN  17983>>ASSIGN
     17987>>ASSIGN  17988<<ASSIGN  17988>>ASSIGN  17988>>ASSIGN  17999<<ASSIGN  18000>>IF      18002>>CALLBLT
     18007>>DOCASE  18027>>ASSIGN  18032>>ASSIGN  18037>>ASSIGN  18042>>ASSIGN  18047>>CALL    18049>>CALL
     18051>>CALL    18053>>ASSIGN  18058>>IF      18060>>CALLBLT 18066>>CALL    18068>>CALL    18070>>ASSIGN
     18075>>IF      18077>>CALLBLT 18089<<ASSIGN  18094>>ASSIGN  18099<>CALL    18103<<ASSIGN  18103>>ASSIGN
     18787<<ASSIGN  18788<>CALL    18792>>ASSIGN  18792>>ASSIGN
TEMP2$ IN PROCEDURE DISPLDEV
     19140**DCL     19187<<ASSIGN  19188>>DOCASE  19191>>ASSIGN  19191>>ASSIGN  19195>>ASSIGN  19195>>ASSIGN
TEMPO.LSD
     14325**DCL     18737>>CALLBLT
TEMPO.REST
     14324**DCL     18738>>ASSIGN
TEXT IN PROCEDURE PUT_FLAG
     19967**DCL     19964--PROC    19975>>ASSIGN
TEXTC.SIZ
     14927**DCL     14928--IMP-SIZ 17667>>ASSIGN
TEXTC.TEXT
     14928**DCL     17668--CALL
TIME50
     17380**LABEL   17362--CALLALT 17366--CALLALT 17370--CALLALT 17376--CALLALT 17380--CALLALT
TMDATE
     14363**DCL     14372--REDEF   17350--ASSIGN
TMDATE.DATE
     14365**DCL     17340--ASSIGN
TMDATE.TIME
     14367**DCL     17341--ASSIGN
TMDATE.TIME.MSEC
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:616  
     14371**DCL     17344<<ASSIGN
TMDATE.TIME.SEC
     14370**DCL     17343<<ASSIGN
TMDATEBUFF
     14372**DCL     17337<<ASSIGN  17355--ASSIGN  17362--CALL
TVAL
     14321**DCL     17884<<ASSIGN  17885<>CALL    17891<<ASSIGN  17892<>CALL    17940<<ASSIGN  17941<>CALL
     17947<<ASSIGN  17948<>CALL    17954<<ASSIGN  17955<>CALL    17961<<ASSIGN  17962<>CALL    17968<<ASSIGN
     17969<>CALL    17978<<ASSIGN  17981>>DOWHILE 17987<<ASSIGN  17987>>ASSIGN  18027<<ASSIGN  18028>>IF
     18030<>CALL    18032<<ASSIGN  18033>>IF      18035<>CALL    18037<<ASSIGN  18038>>IF      18040<>CALL
     18042<<ASSIGN  18043>>IF      18045<>CALL    18053<<ASSIGN  18054>>IF      18056<>CALL    18070<<ASSIGN
     18071>>IF      18073<>CALL    18088<<ASSIGN  18091>>DOWHILE 18102<<ASSIGN  18102>>ASSIGN  18122<<ASSIGN
     18123<>CALL    18129<<ASSIGN  18130<>CALL    18137<<ASSIGN  18138<>CALL    18149<<ASSIGN  18150<>CALL
     18162<<DOINDEX 18163>>IF      18166>>CALLBLT 18175<<ASSIGN  18190<<ASSIGN  18191<>CALL    18197<<ASSIGN
     18198<>CALL    18204<<ASSIGN  18205<>CALL    18262<<ASSIGN  18263<>CALL    18270<<ASSIGN  18271<>CALL
     18276<<ASSIGN  18277<>CALL    18285<<ASSIGN  18286<>CALL    18295<<ASSIGN  18296<>CALL    18305<<ASSIGN
     18306<>CALL    18321<<DOINDEX 18322>>IF      18325<>CALL    18327>>IF      18379<<ASSIGN  18380<>CALL
     18387<<ASSIGN  18388<>CALL    18410<<ASSIGN  18411>>IF      18413<>CALL    18447<<ASSIGN  18448>>IF
     18450<>CALL    18452<<ASSIGN  18453>>IF      18455<>CALL    18459<<ASSIGN  18460>>IF      18462<>CALL
     18477<<ASSIGN  18478>>IF      18480<>CALL    18494<<ASSIGN  18495<>CALL    18496<<ASSIGN  18497<>CALL
     18733<<ASSIGN  18736<<ASSIGN  18736>>ASSIGN  18737>>CALLBLT 18783<<ASSIGN  18792<<ASSIGN  18793>>IF
     18795<<ASSIGN  18798>>IF      18799<<ASSIGN  18800<>CALL    20449<<ASSIGN  20450>>IF      20452>>ASSIGN
UC_FLG IN PROCEDURE DILDEV
     19237**DCL     19675<<ASSIGN  19677<<ASSIGN  19681>>IF
UNFID
     14350**DCL     18534--ASSIGN  18536>>CALLBLT
USRNUM IN PROCEDURE DISPUSER
     18708**DCL     18734<<ASSIGN  18737<<CALLBLT 18741<<ASSIGN  18741>>ASSIGN  18742--CALL
VARY$STRNG
     14358**DCL     17688--ASSIGN  18780--ASSIGN  18782<<ASSIGN
VARY$STRNG IN PROCEDURE DISP_OPT_TEXT
     19004**DCL     19009>>IF      19027>>ASSIGN  19028>>CALLBLT
VLP$ACCESS.ACCT# IN PROCEDURE DISPDCB
     17595**DCL     18094>>ASSIGN
VLP$ACSVEH.C IN PROCEDURE DISPDCB
     17591**DCL     17592--IMP-SIZ 17982>>ASSIGN  17983>>ASSIGN  17987>>ASSIGN  17988>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:617  
VLP$ACSVEH.VEHICLE# IN PROCEDURE DISPDCB
     17592**DCL     17983>>ASSIGN
VLP$ATTR.SIZE# IN PROCEDURE DISPDCB
     17588**DCL     17978>>ASSIGN  18088>>ASSIGN
VLP$HDR.CTL.COUNT# IN PROCEDURE DILDEV
     19663**DCL     19769>>ASSIGN
VLP$HDR.TITL.L# IN PROCEDURE DILDEV
     19663**DCL     19664--IMP-SIZ 19773>>ASSIGN  19780>>CALLBLT
VLP$HDR.TITL.TITLE# IN PROCEDURE DILDEV
     19664**DCL     19780>>CALLBLT
VLP_SN
     16384**DCL     18528--ASSIGN  20230<<ASSIGN
VLP_SN.NUM#
     16384**DCL     18526<<ASSIGN
VLP_SN.SN#
     16384**DCL     18527<<ASSIGN  20231>>IF      20234>>CALLBLT 20235>>CALLBLT
VLP_WINDOW IN PROCEDURE DILDEV
     19624**DCL     19797--ASSIGN
VLP_WINDOW.BTMBRDR# IN PROCEDURE DILDEV
     19640**DCL     19848<>CALL
VLP_WINDOW.FWINDOW# IN PROCEDURE DILDEV
     19624**DCL     19624--REDEF   19625--REDEF
VLP_WINDOW.HBRDRCHR# IN PROCEDURE DILDEV
     19641**DCL     19863>>ASSIGN  19869>>CALLBLT
VLP_WINDOW.HBRDRSIZ# IN PROCEDURE DILDEV
     19641**DCL     19856>>IF      19859>>ASSIGN
VLP_WINDOW.LENGTH# IN PROCEDURE DILDEV
     19638**DCL     19838>>ASSIGN
VLP_WINDOW.LFTBRDR# IN PROCEDURE DILDEV
     19642**DCL     19850<>CALL
VLP_WINDOW.MINLENGTH# IN PROCEDURE DILDEV
     19643**DCL     19844>>ASSIGN
VLP_WINDOW.MINWIDTH# IN PROCEDURE DILDEV
     19644**DCL     19842>>ASSIGN
VLP_WINDOW.ORG_PST.COLUMN IN PROCEDURE DILDEV
     19639**DCL     19830>>ASSIGN
PL6.E3A0      #001=CPE$IBEX2 File=CPE$IBEX2.:E05TSI                              TUE 07/29/97 11:35 Page:618  
VLP_WINDOW.ORG_PST.LINE IN PROCEDURE DILDEV
     19639**DCL     19827>>ASSIGN
VLP_WINDOW.REMOVABLE# IN PROCEDURE DILDEV
     19645**DCL     19854<>CALL
VLP_WINDOW.RHTBRDR# IN PROCEDURE DILDEV
     19642**DCL     19852<>CALL
VLP_WINDOW.TOPBRDR# IN PROCEDURE DILDEV
     19640**DCL     19846<>CALL
VLP_WINDOW.VBRDRCHR# IN PROCEDURE DILDEV
     19643**DCL     19880>>ASSIGN  19886>>CALLBLT
VLP_WINDOW.VBRDRSIZ# IN PROCEDURE DILDEV
     19642**DCL     19873>>IF      19876>>ASSIGN
VLP_WINDOW.WIDTH# IN PROCEDURE DILDEV
     19638**DCL     19840>>ASSIGN
WAIT_INT IN PROCEDURE DISPNOTIFY
     20196**DCL     20280<<CALLBLT 20281<>CALL    20281--CALL    20282--CALL
WHEN$CNTL_REC.CUR_LEV
     15946**DCL     16936>>ASSIGN  16938>>ASSIGN
WHEN$CNTL_REC.STATE_LEV
     15947**DCL     16936<<ASSIGN  20427>>IF      20427>>IF      20442>>ASSIGN
WHEN$CNTL_REC.WHEN.OPT
     15950**DCL     16938<<ASSIGN  20427>>IF      20427>>IF
WHEN_CNTL_REC_CHANGED
     14336**DCL     16934<>CALL    20425<>CALL
WHEN_NONE IN PROCEDURE DISPWHEN
     20462**LABEL   20437--GOTO
WINDOW_OPTS_ALT IN PROCEDURE DISPLAY_WINDOW_OPTS
     19894**LABEL   19799--CALLALT 19800--CALLALT 19805--CALLALT 19821--CALLALT 19826--CALLALT 19836--CALLALT
     19846--CALLALT 19848--CALLALT 19850--CALLALT 19852--CALLALT 19854--CALLALT 19870--CALLALT 19887--CALLALT
WINDOW_OPTS_RET IN PROCEDURE DISPLAY_WINDOW_OPTS
     19891**LABEL   19824--GOTO
X$FORMAT
     14693**DCL-ENT 20440--CALL    20465--CALL
XSF$LOCCODE
     14689**DCL-ENT 18788--CALL
