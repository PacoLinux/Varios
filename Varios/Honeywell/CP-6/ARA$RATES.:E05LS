VERSION E05

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:1    
        1        1        /*M* ARA$RATES  Service processor to maintain B$RATE rate tables file.        */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8        /* Next available error code = 45   */
        9        9        /*P* NAME: RATES
       10       10             PURPOSE: To maintain B$RATE rate tables file.
       11       11             DESCRIPTION: The RATES processor is used to maintain the B$RATE rate
       12       12                tables file. The file contains all rate tables used in system
       13       13                accounting procedures. The user is allowed to interactively
       14       14                BUILD, MODIFY, LIST, and DELETE  the tables contained in B$RATE.
       15       15            REFERENCE: Specification file section 17.3 document 158.                  */
       16       16        /*D* NAME: RATES
       17       17             CALL: RATES is initiated from IBEX by: !RATES
       18       18             ENVIRONMENT: User program.
       19       19             INPUT: RATES inputs user commands and B$RATE table records.
       20       20             OUTPUT: RATES outputs responses to user input and B$RATE table records.
       21       21                There are six table types:
       22       22                    1) RATE tables - used to store general rate information.
       23       23                    2) FORM tables - used to store rates for mounting and unit cost of
       24       24                       individual form types.
       25       25                    3) SCHEDULE tables - used to store a pointer to an associated RATE
       26       26                       table.
       27       27                    4) PROCESSOR tables - used to store a pointer to an associated
       28       28                       RATE table.
       29       29                    5) LCP6 tables - used to store rates for LCP-6 usage.
       30       30                    6) COMM tables - used to store rates for communications usage.
       31       31                The allowable commands are:
       32       32                    1) BUILD - builds a given table optionally from a specified model.
       33       33                    2) MODIFY - modifies a specified table.
       34       34                    3) DELETE - deletes a given table or set of tables.
       35       35                    4) LIST - lists contents of a given table of set of tables.
       36       36                    5) HELP - displays various help messages designed to aid the user
       37       37                        in use of RATES.
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:2    
       38       38                    6) ? - elaborates on last error message displayed.
       39       39                BUILD and MODIFY contain second level commands which allow setting or
       40       40                changing of individual fields in the current table.                   */
       41       41        ARA$RATES: PROC MAIN;                   /* RATES PROCESSOR DRIVER PROC        */
       42       42        %INCLUDE CP_6;
       43     5601        %INCLUDE XU_MACRO_C;
       44     8707        %INCLUDE XUR_ENTRY;
       45     8739        %INCLUDE F$DCB;
       46     8788        %INCLUDE XU_PERR_C;
       47     8979        %INCLUDE XU_SUBS_C;
       48     9071        %INCLUDE B_ERRORS_C;
       49    10198        %INCLUDE CP_6_SUBS;
       50    10738        %INCLUDE AR_SUBS_C;
       51    10828        %INCLUDE AR_TBLS_C;
       52    11233        %INCLUDE B$JIT;
       53    11836        %INCLUDE B_MACROS_C;
       54    11947        %B$FORM_TBL(FPTN=FORM$TBL,STCLASS=BASED);
       55    11968        %B$PROC_TBL(FPTN=PROC$TBL,STCLASS=BASED);
       56    11995        %B$SCHED_TBL(FPTN=SCHED$TBL,STCLASS=BASED);
       57    12022        %B$RATE_TBL(FPTN=RATE$TBL,STCLASS=BASED);
       58    12137        %B$LCP6_TBL(FPTN=LCP6$TBL,STCLASS=BASED);
       59    12298        %B$COMM_TBL(FPTN=COMM$TBL,STCLASS=BASED);
       60    12314        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:3    
       61    12315    1   DCL 1 PCB,
       62    12316    1         2 OUT$ PTR;
       63    12317        %XUR_INIT (GOODCMD=YES);
       64    12416        %PARSE$OUT(NAME=RPT$BLK,NSUBLKS=NUM_SUB_BLKS,SUBLK$=SUB_BLK$,
       65    12417                   STCLASS="BASED(PCB.OUT$)");
       66    12462        %PARSE$SYM(NAME=P$S,STCLASS=BASED);
       67    12500        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:4    
       68    12501    1   DCL FIELD1_ VECTOR STATIC DALIGNED INIT(VECTOR(NIL));
       69    12502    1   DCL 1 ERR_CODE STATIC,
       70    12503    1         2 FCG_MID UBIN(18) INIT(5249) UNAL,
       71    12504    1         2 CODE UBIN(15) INIT(0) UNAL,
       72    12505    1         2 SEV UBIN(3) INIT(0) UNAL;
       73    12506        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:5    
       74    12507
       75    12508        %FPT_WRITE(FPTN = FPT_WRITE_LO,
       76    12509                   BUF  = LO_OUT_BUF,
       77    12510                   DCB  = M$LO);
       78    12541    1   DCL LO_OUT_BUF CHAR(132) STATIC SYMDEF;
       79    12542        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:6    
       80    12543        %FPT_OPEN(FPTN     = B$RATE_OPEN_FPT,
       81    12544                  NAME     = B$RATE_VLP,
       82    12545                  ACCT     = ACCT_RATES,
       83    12546                  DCB      = B$RATE_DCB,
       84    12547                  ACSVEH   = B$RATE_ACSVEH,
       85    12548                  ORG      = KEYED,
       86    12549                  ACS      = DIRECT,
       87    12550                  FUN      = CREATE,
       88    12551                  SHARE   = IN,
       89    12552                  CTG      = YES,
       90    12553                  EXIST    = OLDFILE,
       91    12554                  SCRUB    = YES,
       92    12555                  REASSIGN = NO,
       93    12556                  ASN      = FILE,
       94    12557                  DISP     = NAMED);
       95    12666        %VLP_NAME(FPTN = RATES_NAME,
       96    12667                  LEN = 31,
       97    12668                  NAME = 'RATES',
       98    12669                  STCLASS = CONSTANT);
       99    12696
      100    12697        %VLP_NAME(FPTN  = B$RATE_VLP,
      101    12698                  NAME  = ':RATES');
      102    12725
      103    12726        %VLP_ACCT(FPTN = ACCT_RATES,
      104    12727                  ACCT = ':SYS');
      105    12740        %VLP_ATTR(FPTN = B$RATE_ACSVEH,STCLASS = CONSTANT);
      106    12754        %VLP_ACSVEH(VEHICLE='IBEX',READ = YES,LAST=",");
      107    12771        %VLP_ACSVEH(VEHICLE='TPCP',READ = YES,LAST=";");
      108    12788        %FPT_PRECORD(FPTN = FPT_PRECORD,
      109    12789                     KEY  = IN_KEY,
      110    12790                     DCB  = B$RATE_DCB,
      111    12791                     KEYS = YES);
      112    12812        %FPT_READ(FPTN = B$RATE_READ_FPT,
      113    12813                  BUF  = REC_BUF,
      114    12814                  DCB  = B$RATE_DCB,
      115    12815                  WAIT = YES,
      116    12816                  KEYS = YES,
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:7    
      117    12817                  KEYR = YES);
      118    12856
      119    12857        %FPT_WRITE(FPTN = B$RATE_WRITE_FPT,
      120    12858                   BUF  = REC_BUF,
      121    12859                   KEY  = OUT_KEY,
      122    12860                   DCB  = B$RATE_DCB);
      123    12891
      124    12892        %FPT_DELREC(FPTN = B$RATE_DELREC_FPT,
      125    12893                    DCB  = B$RATE_DCB,
      126    12894                    KEY  = FIRST_DEL_KEY);
      127    12913        %FPT_PROMPT(FPTN = FPT_PROMPT,DCB=M$UC);
      128    12941        %FPT_EXIT (FPTN=ERROR, STEPCC=4);
      129    12956    1   DCL 1 FIRST_DEL_KEY STATIC,
      130    12957    1         2 LEN UBIN BYTE UNAL,
      131    12958    1         2 KEY CHAR(35);
      132    12959    1   DCL 1 LAST_DEL_KEY STATIC,
      133    12960    1         2 LEN UBIN BYTE UNAL,
      134    12961    1         2 KEY CHAR(35);
      135    12962
      136    12963    1   DCL REC_BUF CHAR(450) STATIC SYMDEF;
      137    12964    1   DCL REC_BUFB(0:449) REDEF REC_BUF CHAR(1);
      138    12965    1   DCL REC_BUF$ PTR CONSTANT INIT(ADDR(REC_BUF));
      139    12966    1   DCL PACKED$NUM$ARY(0:0) ALIGNED BIT (72) BASED;
      140    12967    1   DCL B$RATE_DCB DCB;
      141    12968    1   DCL M$SI DCB;
      142    12969    1   DCL M$SI$ PTR;
      143    12970    1   DCL M$LO DCB;
      144    12971        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:8    
      145    12972    1   DCL 1 DEFAULT_KEY_QUAL_TEXTC STATIC,
      146    12973    1         2 LEN UBIN BYTE INIT(1) UNAL,     /* USED FOR FORMING DEFAULT KEYS      */
      147    12974    1         2 STRING CHAR(1) INIT('0');
      148    12975    1   DCL 1 IN_KEY STATIC,                    /* KEY OF INPUT RECORD                */
      149    12976    1         2 LEN UBIN BYTE UNAL,
      150    12977    1         2 STRING CHAR(35);
      151    12978    1   DCL 1 OUT_KEY STATIC,                   /* KEY OF OUTPUT RECORD               */
      152    12979    1         2 LEN UBIN BYTE UNAL,
      153    12980    1         2 STRING CHAR(35);
      154    12981    1   DCL 1 TEXT$C BASED,
      155    12982    1         2 LEN UBIN BYTE UNAL,
      156    12983    1         2 STRING CHAR(TEXT$C.LEN);
      157    12984
      158    12985    1   DCL ZERO_STRING CHAR(13) CONSTANT INIT('0000000000000');
      159    12986    1   DCL BLANK_STRING CHAR(10) CONSTANT INIT('          ');
      160    12987    1   DCL 1 RATES_PROMPT CONSTANT,
      161    12988    1         2 LEN UBIN BYTE UNAL INIT(1),
      162    12989    1         2 STRING CHAR(1) INIT('-');
      163    12990    1   DCL 1 BLD_MOD_PROMPT CONSTANT,
      164    12991    1         2 LEN UBIN BYTE UNAL INIT(2),
      165    12992    1         2 STRING CHAR(2) INIT('--');
      166    12993    1   DCL ERROR_EXIT REMEMBER;
      167    12994        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:9    
      168    12995        /* EXTERNAL REFERENCES                                                        */
      169    12996    1   DCL B$TCB$ PTR SYMREF;
      170    12997    1   DCL B$JIT$ PTR SYMREF;
      171    12998        %B$TCB;
      172    13001        %B$ALT;
      173    13009    1   DCL TEST_MODE SBIN WORD STATIC SYMDEF;
      174    13010    1   DCL TOP_CMD_ROOT BIT(1) SYMREF;
      175    13011    1   DCL RATE_CMD_ROOT BIT(1) SYMREF;
      176    13012    1   DCL LCP6_CMD_ROOT BIT(1) SYMREF;
      177    13013    1   DCL COMM_CMD_ROOT BIT(1) SYMREF;
      178    13014    1   DCL FORM_CMD_ROOT BIT(1) SYMREF;
      179    13015    1   DCL SCHED_CMD_ROOT BIT(1) SYMREF;
      180    13016        %B$RATE_TBL(FPTN = INIT_RATE_TBL,STCLASS = SYMREF);
      181    13131        %B$FORM_TBL(FPTN = INIT_FORM_TBL,STCLASS = SYMREF);
      182    13152        %B$LCP6_TBL(FPTN = INIT_LCP6_TBL,STCLASS = SYMREF);
      183    13313        %B$COMM_TBL(FPTN = INIT_COMM_TBL,STCLASS = SYMREF);
      184    13329        %B$SCHED_TBL(FPTN = INIT_SCHED_TBL,STCLASS = SYMREF);
      185    13356        %B$PROC_TBL(FPTN = INIT_PROC_TBL,STCLASS = SYMREF);
      186    13383    1   DCL CONVPK ENTRY(3);
      187    13384        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:10   
      188    13385        /* DRIVER BEGINS HERE                                                         */
      189    13386    1      REMEMBER ERR_EXIT IN ERROR_EXIT;
      190    13387    1      CALL INITIALIZE;
      191    13388    2      DO WHILE (1=1);                      /* DO FOREVER                         */
      192    13389    2           CALL XUR$GETCMD (TOP_CMD_ROOT,PCB.OUT$,RATES_PROMPT) ALTRET(GO_CLEANUP);
      193    13390                                                /* ALTRET                             */
      194    13391    3           DO CASE (RPT$BLK.CODE);
      195    13392    3            CASE (BLD_CODE);
      196    13393    3              CALL BUILD;
      197    13394    3            CASE (MOD_CODE);
      198    13395    3              CALL MODIFY;
      199    13396    3            CASE (LIST_CODE);
      200    13397    3              CALL LIST_;
      201    13398    3            CASE (DEL_CODE);
      202    13399    3              CALL DELETE;
      203    13400    3            CASE (END_CODE);
      204    13401    3   GO_CLEANUP:;
      205    13402    3              CALL CLEAN_UP;               /* CATCHES OTHER ERRORS               */
      206    13403    3              RETURN;
      207    13404    3              END;                         /*END CASE*/
      208    13405    2           END;
      209    13406    1   ERR_EXIT: CALL M$EXIT (ERROR);
      210    13407        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:11   
      211    13408    1   BUILD: PROC;                            /* PROCEDURE TO BUILD NEW TABLE       */
      212    13409    2   DCL RET_VAL SBIN WORD;
      213    13410    2   DCL KEY_QUAL_TEXTC$ PTR;
      214    13411    2   DCL CUR_NODE$ PTR;
      215    13412    2   DCL KEY_TYPE_CODE SBIN WORD;
      216    13413    2   DCL FROM_QUAL_TYPE_CODE SBIN WORD;
      217    13414    2   DCL PERCENT BIT(1) ALIGNED;
      218    13415    2   DCL FROM_KEY_QUAL_TEXTC$ PTR;
      219    13416    2      KEY_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;
      220    13417    2      CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);
      221    13418                                                /* CUR_NODE$ NOW POINTS TO KEY        */
      222    13419                                                /* QUALIFYING NODE                    */
      223    13420    2      IF CUR_NODE$->RPT$BLK.CODE = DEFAULT
      224    13421    2      THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);
      225    13422    2      ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);
      226    13423
      227    13424    2      CALL FORM_KEY(RET_VAL,
      228    13425    2        KEY_TYPE_CODE,
      229    13426    2        OUT_KEY,
      230    13427    2        KEY_QUAL_TEXTC$);
      231    13428    2      IF RET_VAL = NORM_RET
      232    13429    3      THEN DO;
      233    13430    3           CALL READ_B$RATE(RET_VAL,%YES#,OUT_KEY);
      234    13431    3           IF RET_VAL = NORM_RET
      235    13432    4           THEN DO;
      236    13433    4                CALL ERR_PROC(2);
      237    13434    4                RETURN;
      238    13435    4                END;
      239    13436        /*E* ERROR:   ARA-00002
      240    13437             MESSAGE: Table already exists.
      241    13438        */
      242    13439
      243    13440    3           ELSE IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY
      244    13441    4                THEN DO;
      245    13442    4                     CALL ERR_PROC(MONERR);
      246    13443    4                     UNWIND TO ERROR_EXIT;
      247    13444    4                     END;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:12   
      248    13445    3           END;
      249    13446    2      ELSE RETURN;
      250    13447
      251    13448
      252    13449    2      IF RPT$BLK.SUB_BLK$(0)->RPT$BLK.NUM_SUB_BLKS=2
      253    13450    2      THEN PERCENT = %YES#;
      254    13451    2      ELSE PERCENT = %NO#;
      255    13452
      256    13453        /*   See if 'FROM' table was specified.
      257    13454        */
      258    13455    2      IF RPT$BLK.NUM_SUB_BLKS = 2
      259    13456    3      THEN DO;
      260    13457    3           FROM_QUAL_TYPE_CODE = RPT$BLK.SUB_BLK$(1)->RPT$BLK.CODE;
      261    13458    3           IF FROM_QUAL_TYPE_CODE = SCRATCH
      262    13459    3           THEN CALL ZERO_TBL(KEY_TYPE_CODE);
      263    13460
      264    13461    4           ELSE DO;
      265    13462    4                IF FROM_QUAL_TYPE_CODE = DEFAULT
      266    13463    4                THEN FROM_KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);
      267    13464    4                ELSE FROM_KEY_QUAL_TEXTC$ =
      268    13465    4                       RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);
      269    13466    4                CALL FORM_KEY(RET_VAL,
      270    13467    4                  KEY_TYPE_CODE,
      271    13468    4                  IN_KEY,
      272    13469    4                  FROM_KEY_QUAL_TEXTC$);
      273    13470    4                IF RET_VAL = NORM_RET
      274    13471    5                THEN DO;                   /* IF KEY IS FORMED SUCCESSFULLY      */
      275    13472    5                     CALL READ_B$RATE(RET_VAL,%YES#,IN_KEY);
      276    13473    5                     IF RET_VAL = ALT_RET
      277    13474    5                     THEN
      278    13475    5                          IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      279    13476    6                          THEN DO;
      280    13477    6                               CALL ERR_PROC(5);
      281    13478    6                               RETURN;
      282    13479    6                               END;
      283    13480        /*E* ERROR:   ARA-00005
      284    13481             MESSAGE: "From" table does not exist.
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:13   
      285    13482        */
      286    13483    6                          ELSE DO;
      287    13484    6                               CALL ERR_PROC(MONERR);
      288    13485                                                /* ERROR ON READ OTHER THAN           */
      289    13486                                                /* 'RECORD NOT FOUND'                 */
      290    13487    6                               UNWIND TO ERROR_EXIT;
      291    13488    6                               END;
      292    13489    5                     IF KEY_TYPE_CODE=RATE_CODE AND PERCENT~=REC_BUF$->RATE$TBL.
             13489                              PERCENT#
      293    13490    5                     THEN
      294    13491    5                          IF PERCENT
      295    13492    5                          THEN
      296    13493    5                               CALL ERR_PROC(42);
      297    13494        /*E* ERROR:   ARA-00042
      298    13495             MESSAGE: *** Building PERCENT Rate table from non-PERCENT table ***
      299    13496        */
      300    13497    5                          ELSE
      301    13498    5                               CALL ERR_PROC(43);
      302    13499        /*E* ERROR:   ARA-00043
      303    13500             MESSAGE: *** Building non-PERCENT Rate table from PERCENT table ***
      304    13501        */
      305    13502    5                     END;
      306    13503    4                ELSE RETURN;
      307    13504    4                END;
      308    13505    3           END;
      309    13506
      310    13507        /*   'FROM' not given, use the default base table.
      311    13508        */
      312    13509    2      ELSE CALL GET_INIT_TBL(KEY_TYPE_CODE);
      313    13510
      314    13511        /*    Set 'PERCENT' if appropriate.
      315    13512        */
      316    13513    2      IF (KEY_TYPE_CODE=RATE_CODE) OR (KEY_TYPE_CODE=LCP6_CODE)
      317    13514    2      THEN REC_BUF$->RATE$TBL.PERCENT# = PERCENT;
      318    13515
      319    13516    2      CALL UPDATE_TBL(KEY_TYPE_CODE);
      320    13517    2      RETURN;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:14   
      321    13518    2   END BUILD;
      322    13519        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:15   
      323    13520        /*   CHECK_DEFAULTS reads the default record for each of the six
      324    13521             record types.  If the default record does not exist, it is
      325    13522             built.
      326    13523        */
      327    13524    1   CHECK_DEFAULTS: PROC;
      328    13525    2   DCL REC_TYPE SBIN WORD;
      329    13526    2   DCL RET_VAL SBIN WORD;
      330    13527    2   DCL DEFAULT_KEY_QUAL_TEXTC$ PTR;
      331    13528    2      DEFAULT_KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);
      332    13529
      333    13530    3      DO REC_TYPE = SCHED_CODE TO COMM_CODE;
      334    13531    3           CALL FORM_KEY(RET_VAL,
      335    13532    3             REC_TYPE,
      336    13533    3             OUT_KEY,
      337    13534    3             DEFAULT_KEY_QUAL_TEXTC$);
      338    13535    3           CALL READ_B$RATE(RET_VAL,%YES#,OUT_KEY);
      339    13536    3           IF RET_VAL = ALT_RET
      340    13537    3           THEN IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      341    13538    4                THEN DO;
      342    13539    4                     CALL GET_INIT_TBL(REC_TYPE);
      343    13540    4                     CALL M$WRITE(B$RATE_WRITE_FPT)
      344    13541    5                     WHENALTRETURN DO;
      345    13542    5                          CALL ERR_PROC(MONERR);
      346    13543    5                          UNWIND TO ERROR_EXIT;
      347    13544    5                          END;
      348    13545    4                     END;
      349    13546    4                ELSE DO;
      350    13547    4                     CALL ERR_PROC(MONERR); /* READ ERROR IN CHECK_DEFAULTS      */
      351    13548    4                     UNWIND TO ERROR_EXIT;
      352    13549    4                     END;
      353    13550    3           END;
      354    13551    2      RETURN;
      355    13552    2   END CHECK_DEFAULTS;
      356    13553        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:16   
      357    13554    1   CLEAN_UP: PROC;
      358    13555    2   DCL KEY$ PTR;
      359    13556    2   DCL INDX SBIN WORD;
      360    13557    2   DCL 1 FOUR$KEY BASED,
      361    13558    2         2 * UBIN BYTE UNAL,
      362    13559    2         2 NAME CHAR(4),
      363    13560    2         2 QUAL CHAR(6);
      364    13561    2   DCL 1 RATE_TBL(0:999),
      365    13562    2         2 KEY_QUAL CHAR(6),
      366    13563    2         2 FLAGS,
      367    13564    2           3 EXISTS BIT(1),
      368    13565    2           3 PERCENT BIT(1),
      369    13566    2           3 POINTED_TO BIT(1);
      370    13567    2      RATE_TBL = '0'B;                     /* INITIALIZE TABLE                   */
      371    13568    2      INDX = -1;                           /* INDEX OF HIGHEST ENTRY IN          */
      372    13569                                                /* RATE_TBL                           */
      373    13570    2      KEY$ = ADDR(IN_KEY);
      374    13571    2      CALL CHECK_DEFAULTS;                 /* CHECK FOR ANY MISSING DEFAULT      */
      375    13572                                                /* TABLES AND REPLACE THEM FROM       */
      376    13573                                                /* THE INIT TABLES IF NECESSARY       */
      377    13574    2      CALL PROCESS_SET(FILL_TBL_CODE);
      378    13575                                                /* FILL RATE_TABLE_TBL WITH           */
      379    13576                                                /* EXISTENCE INFORMATION              */
      380    13577    2      CALL PROCESS_SET(CHECK_PROC_CODE);
      381    13578                                                /* CHECK PROCESSOR TABLES FOR         */
      382    13579                                                /* RATE TABLE NUMBERS OF MISSING      */
      383    13580                                                /* RATE TABLES                        */
      384    13581    2      CALL PROCESS_SET(CHECK_SCHED_CODE);
      385    13582                                                /* CHECK SCHEDULE TABLES FOR          */
      386    13583                                                /* RATE TABLE NUMBERS OF MISSING      */
      387    13584                                                /* RATE TABLES OR PERCENT-TYPE        */
      388    13585                                                /* RATE TABLES                        */
      389    13586    2      CALL CHECK_DANGLING_RATES;           /* CHECK RATE_TABLE_TBL FOR           */
      390    13587                                                /* ANY DANGLING RATE TABLES           */
      391    13588        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:17   
      392    13589    2   PROCESS_SET: PROC(PROC_NAME_CODE);
      393    13590    3   DCL RET_VAL SBIN WORD;
      394    13591    3   DCL PROC_NAME_CODE SBIN WORD;
      395    13592    3   DCL EXIT_LOOP SBIN WORD;
      396    13593    3      IN_KEY.LEN = 4;
      397    13594    4      DO CASE(PROC_NAME_CODE);             /* SET UP THE KEY FOR POSITIONING*/
      398    13595    4       CASE(FILL_TBL_CODE);
      399    13596    4         IN_KEY.STRING = 'RATE';
      400    13597    4       CASE(CHECK_PROC_CODE);
      401    13598    4         IN_KEY.STRING = 'PROC';
      402    13599    4       CASE(CHECK_SCHED_CODE);
      403    13600    4         IN_KEY.STRING = 'SCHE';
      404    13601    4         END;                              /* END CASE                           */
      405    13602    3      CALL M$PRECORD_CALL;                 /* POSITION TO FIRST RECORD OF        */
      406    13603                                                /* GIVEN RECORD TYPE                  */
      407    13604
      408    13605    3      EXIT_LOOP = FALSE;
      409    13606    4      DO WHILE (EXIT_LOOP  = FALSE);
      410    13607    4           CALL READ_B$RATE(RET_VAL,%NO#,IN_KEY);
      411    13608    4           IF RET_VAL = NORM_RET           /* READ THE NEXT RECORD AND           */
      412    13609    4           THEN                            /* PROCESS IT IF SUCCESSFULLY         */
      413    13610    5           DO CASE(PROC_NAME_CODE);        /* READ                               */
      414    13611    5            CASE(FILL_TBL_CODE);
      415    13612    5              CALL FILL_TBL(EXIT_LOOP);
      416    13613    5            CASE(CHECK_PROC_CODE);
      417    13614    5              CALL CHECK_PROC(EXIT_LOOP);
      418    13615    5            CASE(CHECK_SCHED_CODE);
      419    13616    5              CALL CHECK_SCHED(EXIT_LOOP);
      420    13617    5              END;                         /* END CASE                           */
      421    13618
      422    13619    5           ELSE DO;
      423    13620    5                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF
      424    13621    6                THEN DO;                   /* IF THE READ ERROR WAS NOT EOF      */
      425    13622    6                     CALL ERR_PROC(MONERR); /* NON-EOF CONSECUTIVE READ ERROR*/
      426    13623    6                     UNWIND TO ERROR_EXIT; /* AND ABORT PROGRAM                  */
      427    13624    6                     END;
      428    13625    5                EXIT_LOOP = TRUE;          /* AND EXIT THE LOOP                  */
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:18   
      429    13626    5                END;
      430    13627    4           END;                            /* END WHILE                          */
      431    13628    3      RETURN;
      432    13629        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:19   
      433    13630    3   FILL_TBL: PROC(EXIT_LOOP);
      434    13631    4   DCL EXIT_LOOP SBIN WORD;
      435    13632    4      IF KEY$->FOUR$KEY.NAME = 'RATE'      /* IF STILL PROCESSING RATE TBLS      */
      436    13633    5      THEN DO;                             /* UPDATE THE TABLE                   */
      437    13634    5           INDX = INDX+1;
      438    13635    5           RATE_TBL.KEY_QUAL(INDX) = KEY$->FOUR$KEY.QUAL;
      439    13636    5           IF REC_BUF$->RATE$TBL.PERCENT#
      440    13637    5           THEN                            /* EXISTS AND IS PERCENT TYPE         */
      441    13638    5                RATE_TBL.FLAGS(INDX) = '110'B;
      442    13639    5           ELSE                            /* EXISTS AND NOT PERCENT TPYE        */
      443    13640    5                RATE_TBL.FLAGS(INDX) = '100'B;
      444    13641    5           END;
      445    13642
      446    13643    4      ELSE EXIT_LOOP = TRUE;               /* OTHERWISE EXIT THE LOOP ABOVE      */
      447    13644    4   END FILL_TBL;
      448    13645        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:20   
      449    13646    3   CHECK_PROC: PROC(EXIT_LOOP);
      450    13647    4   DCL EXIT_LOOP SBIN WORD;
      451    13648    4   DCL I SBIN WORD;
      452    13649    4      IF KEY$->FOUR$KEY.NAME = 'PROC'      /* IF STILL PROCESSING PROCESSOR      */
      453    13650    4      THEN                                 /* TABLES                             */
      454    13651    5      DO;                                  /* CHECK RTABLE FIELD FOR MISSING     */
      455    13652                                                /* TARGET RATE TABLE AND UPDATE       */
      456    13653                                                /* POINTED_TO FIELD                   */
      457    13654    5           CALL GET_INDEX(REC_BUF$->PROC$TBL.RTABLE#,I);
      458    13655    5           IF RATE_TBL.FLAGS.EXISTS(I)
      459    13656    5           THEN
      460    13657    5                RATE_TBL.FLAGS.POINTED_TO(I) = '1'B;
      461    13658    5           ELSE
      462    13659    5                CALL OUT_CLEAN_UP_MSG(29);
      463    13660    5           END;
      464    13661    4      ELSE
      465    13662    4           EXIT_LOOP = TRUE;               /* OTHERWISE EXIT LOOP ABOVE          */
      466    13663    4   END CHECK_PROC;
      467    13664        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:21   
      468    13665    3   CHECK_SCHED: PROC(EXIT_LOOP);
      469    13666    4   DCL EXIT_LOOP SBIN WORD;
      470    13667    4   DCL I SBIN WORD;
      471    13668    4      IF KEY$->FOUR$KEY.NAME = 'SCHE'      /* IF STILL PROCESSING SCHEDULE       */
      472    13669    4      THEN                                 /* TABLES                             */
      473    13670    5      DO;                                  /* CHECK RTABLE FIELD FOR MISSING     */
      474    13671                                                /* OR PERCENT-TYPE TARGETS            */
      475    13672                                                /* AND UPDATE POINTED_TO FIELD        */
      476    13673    5           CALL GET_INDEX(REC_BUF$->SCHED$TBL.RTABLE#,I);
      477    13674    5           IF RATE_TBL.FLAGS.EXISTS(I)
      478    13675    6           THEN DO;
      479    13676    6                RATE_TBL.FLAGS.POINTED_TO(I) = '1'B;
      480    13677    6                IF RATE_TBL.FLAGS.PERCENT(I) /* POINTS TO PERCENT-TYPE           */
      481    13678    6                THEN
      482    13679    6                     CALL OUT_CLEAN_UP_MSG(30);
      483    13680    6                END;
      484    13681    5           ELSE                            /* POINTS TO MISSING TABLE            */
      485    13682    5                CALL OUT_CLEAN_UP_MSG(29);
      486    13683    5           END;
      487    13684    4      ELSE
      488    13685    4           EXIT_LOOP = TRUE;               /* OTHERWISE EXIT LOOP ABOVE          */
      489    13686    4   END CHECK_SCHED;
      490    13687        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:22   
      491    13688        /* THIS PROCEDURE RETURNS IN I THE INDEX INTO RATE_TBL OF THE ENTRY MATCHING  */
      492    13689        /* RTABLE. IF ONE DOES NOT EXIST, I IS INDEX TO FIRST UNUSED TABLE ENTRY      */
      493    13690        /* WHICH APPEARS EMPTY.                                                       */
      494    13691    3   GET_INDEX: PROC(RTABLE,I);
      495    13692    4   DCL RTABLE CHAR(6);
      496    13693    4   DCL I SBIN WORD;
      497    13694    4      I = 0;
      498    13695    5      DO WHILE((I<=INDX) AND (RATE_TBL.KEY_QUAL(I)~=RTABLE));
      499    13696    5           I = I+1;
      500    13697    5           END;
      501    13698    4   END GET_INDEX;
      502    13699    3   END PROCESS_SET;
      503    13700        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:23   
      504    13701    2   CHECK_DANGLING_RATES: PROC;
      505    13702    3   DCL I SBIN WORD;
      506    13703    3      IN_KEY.LEN = 10;
      507    13704    3      IN_KEY.STRING = 'RATE';
      508    13705    4      DO I=0 TO INDX;                      /* PASS ENTIRE RATE_TBL               */
      509    13706    4           IF RATE_TBL.FLAGS.EXISTS(I) AND NOT
      510    13707    4             RATE_TBL.FLAGS.POINTED_TO(I)
      511    13708    5           THEN DO;                        /* DANGLING RATE TABLE                */
      512    13709    5                KEY$->FOUR$KEY.QUAL = RATE_TBL.KEY_QUAL(I);
      513    13710    5                CALL OUT_CLEAN_UP_MSG(31);
      514    13711    5                END;
      515    13712    4           END;
      516    13713    3      RETURN;
      517    13714    3   END CHECK_DANGLING_RATES;
      518    13715        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:24   
      519    13716    2   OUT_CLEAN_UP_MSG: PROC(MSG_INDX);
      520    13717    3   DCL MSG_INDX SBIN WORD;
      521    13718    3   DCL 1 KEY_BUF,
      522    13719    3         2 LEN UBIN BYTE UNAL,
      523    13720    3         2 STRING CHAR(35);
      524    13721    3      CALL CONCAT(KEY_BUF.STRING,
      525    13722    3        SUBSTR(IN_KEY.STRING,0,4),
      526    13723    3        ' ',
      527    13724    3        SUBSTR(IN_KEY.STRING,4));
      528    13725    3      KEY_BUF.LEN = IN_KEY.LEN+1;
      529    13726    3      FIELD1_ = VECTOR(KEY_BUF);
      530    13727    3      CALL ERR_PROC(MSG_INDX);
      531    13728        /*E* ERROR:   ARA-00029
      532    13729             MESSAGE: %U1 points to a non-existent RATE table.
      533    13730        */
      534    13731        /*E* ERROR:   ARA-00030
      535    13732             MESSAGE: Schedule %U1 points to a percent-type RATE table.
      536    13733        */
      537    13734        /*E* ERROR:   ARA-00031
      538    13735             MESSAGE: %U1 is a dangling RATE table.
      539    13736        */
      540    13737    3      RETURN;
      541    13738    3   END OUT_CLEAN_UP_MSG;
      542    13739    2   END CLEAN_UP;
      543    13740        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:25   
      544    13741        /* THIS PROCEDURE ACCEPTS A DECIMAL NUMBER REPRESENTED BY THE OBJECT OF       */
      545    13742        /* VALUE$. THIS NUMBER MAY NOT BE GREATER THAN 13 DECIMAL DIGITS LONG AND     */
      546    13743        /* REPRESENTS A NUMBER OF THE FORM AAAA.BBBB. THIS NUMBER IS CONVERTED TO     */
      547    13744        /* SIGNED PACKED DECIMAL FLOATING POINT FORMAT AND RETURNED IN PACKED_NUM.    */
      548    13745        /* RET_VAL IS RETURNED NORM_RET IF                                            */
      549    13746        /* THE CALL TO THIS PROCEDURE WAS SUCCESSFUL AND ALT_RET IF UNSUCCESSFUL.     */
      550    13747        /* IF RET_VAL IS ALT_RET, THE CONTENTS OF PACKED_NUM ARE UNCHANGED.           */
      551    13748    1   CONVERT_TO_PACKED: PROC(RET_VAL,VALUE$,PACKED_NUM);
      552    13749    2   DCL RET_VAL SBIN WORD;
      553    13750    2   DCL VALUE$ PTR;
      554    13751    2   DCL PACKED_NUM  BIT(72) DALIGNED;
      555    13752    2   DCL NUM$ PTR;
      556    13753    2   DCL NUM1$ PTR;
      557    13754    2   DCL SIZE SBIN WORD;
      558    13755    2   DCL 1 DEC_STRING,
      559    13756    2         2 SIGN BIT(9) UNAL,
      560    13757    2         2 STRING CHAR(13),
      561    13758    2         2 * BIT(1),
      562    13759    2         2 EXP UBIN(8) UNAL;
      563    13760
      564    13761
      565    13762    2      DEC_STRING.SIGN = '014'O;            /* POSITIVE SIGN                      */
      566    13763    2      NUM$ = VALUE$->RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);
      567    13764                                                /* POINTS TO TEXTC OF FIRST           */
      568    13765                                                /* DECIMAL STRING                     */
      569    13766    2      IF VALUE$->RPT$BLK.NUM_SUB_BLKS = 1
      570    13767    2      THEN IF NUM$->TEXT$C.LEN > 13
      571    13768    3           THEN DO;
      572    13769    3                CALL ERR_PROC(16);
      573    13770        /*E* ERROR:   ARA-00016
      574    13771             MESSAGE: Rate value exceeds 13 digits.
      575    13772        */
      576    13773    3                RET_VAL = ALT_RET;
      577    13774    3                END;
      578    13775    3           ELSE DO;
      579    13776    3                CALL CONCAT(DEC_STRING.STRING,
      580    13777    3                  SUBSTR(ZERO_STRING,0,13 - NUM$->TEXT$C.LEN),
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:26   
      581    13778    3                  NUM$->TEXT$C.STRING);
      582    13779    3                IF VALUE$->RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE
      583    13780    3                  = HIGH_DECIMAL_LIT
      584    13781    3                THEN DEC_STRING.EXP = 0;
      585    13782    3                ELSE DEC_STRING.EXP = -NUM$->TEXT$C.LEN;
      586    13783    3                CALL CONVPK(DEC_STRING,
      587    13784    3                  15,
      588    13785    3                  PACKED_NUM);
      589    13786    3                RET_VAL = NORM_RET;
      590    13787    3                END;
      591    13788    3      ELSE DO;
      592    13789    3           NUM1$ = VALUE$->RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);
      593    13790                                                /* POINTS TO SECOND DECIMAL TEXTC*/
      594    13791    3           SIZE = NUM$->TEXT$C.LEN + NUM1$->TEXT$C.LEN;
      595    13792    3           IF SIZE > 13
      596    13793    4           THEN DO;
      597    13794    4                CALL ERR_PROC(16);
      598    13795    4                RET_VAL = ALT_RET;
      599    13796    4                END;
      600    13797    4           ELSE DO;
      601    13798    4                CALL CONCAT(DEC_STRING.STRING,
      602    13799    4                  SUBSTR(ZERO_STRING,0,13 - SIZE),
      603    13800    4                  NUM$->TEXT$C.STRING,
      604    13801    4                  NUM1$->TEXT$C.STRING);
      605    13802    4                DEC_STRING.EXP = -NUM1$->TEXT$C.LEN;
      606    13803    4                CALL CONVPK(DEC_STRING,
      607    13804    4                  15,
      608    13805    4                  PACKED_NUM);
      609    13806    4                RET_VAL = NORM_RET;
      610    13807    4                END;
      611    13808    3           END;
      612    13809    2      RETURN;
      613    13810    2   END CONVERT_TO_PACKED;
      614    13811        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:27   
      615    13812    1   DELETE: PROC;                           /* PROCEDURE TO PROCESS DELETE        */
      616    13813                                                /* COMMAND                            */
      617    13814    2   DCL RET_VAL SBIN WORD;
      618    13815    2   DCL CUR_NODE$ PTR;
      619    13816    2   DCL KEY_QUAL_TEXTC$ PTR;
      620    13817    2   DCL 1 PHONY_KEY_QUAL_TEXTC STATIC,
      621    13818    2         2 LEN UBIN BYTE UNAL INIT(3),
      622    13819    2         2 STRING SBIN(27) UNAL;
      623    13820
      624    13821    2   DCL PHONY_KEY_QUAL_TEXTC$ PTR;
      625    13822    2   DCL REC_TYPE_CODE SBIN WORD;
      626    13823    2   DCL DCB$ PTR;
      627    13824    2   DCL NUM_RECS SBIN WORD;
      628    13825    2   DCL 1 NUM_RECS_STRING STATIC,
      629    13826    2         2 L UBIN BYTE UNAL INIT(5),
      630    13827    2         2 C CHAR(5) UNAL;
      631    13828    2      PHONY_KEY_QUAL_TEXTC$ = ADDR(PHONY_KEY_QUAL_TEXTC);
      632    13829    2      REC_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;
      633    13830    2      IF REC_TYPE_CODE = ALL
      634    13831    3      THEN DO;                             /* DELETE ALL RECORDS OF FILE         */
      635    13832    3           FIRST_DEL_KEY = '001000'O;      /* LOWEST POSSIBLE KEY                */
      636    13833    3           LAST_DEL_KEY = '001777'O;       /* HIGHEST POSSIBLE KEY (OR           */
      637    13834                                                /* CLOSE ENOUGH)                      */
      638    13835    3           B$RATE_DELREC_FPT.LKEY_ = VECTOR(LAST_DEL_KEY);
      639    13836                                                /* DELETE BETWEEN LIMITS              */
      640    13837    3           CALL M$DELREC(B$RATE_DELREC_FPT) ALTRET(DEL_ALT);
      641    13838    3           END;
      642    13839
      643    13840    3      ELSE DO;
      644    13841    3           CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);
      645    13842                                                /* POINTS TO KEY QUALIFYING NODE      */
      646    13843    3           IF CUR_NODE$->RPT$BLK.CODE = ALL
      647    13844    4           THEN DO;                        /* DELETE ALL RECORDS OF A            */
      648    13845                                                /* GIVEN TYPE                         */
      649    13846    4                PHONY_KEY_QUAL_TEXTC.STRING = 0;
      650    13847    4                CALL FORM_KEY(RET_VAL,     /* FORM LOWEST KEY OF THIS TYPE       */
      651    13848    4                  REC_TYPE_CODE,
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:28   
      652    13849    4                  FIRST_DEL_KEY,
      653    13850    4                  PHONY_KEY_QUAL_TEXTC$);
      654    13851    4                PHONY_KEY_QUAL_TEXTC.STRING = -1;
      655    13852    4                CALL FORM_KEY(RET_VAL,     /* FORM HIGHEST KEY OF THIS TYPE      */
      656    13853    4                  REC_TYPE_CODE,
      657    13854    4                  LAST_DEL_KEY,
      658    13855    4                  PHONY_KEY_QUAL_TEXTC$);
      659    13856    4                B$RATE_DELREC_FPT.LKEY_ = VECTOR(LAST_DEL_KEY);
      660    13857                                                /* DELETE BETWEEN LIMITS              */
      661    13858    4                CALL M$DELREC(B$RATE_DELREC_FPT) ALTRET(DEL_ALT);
      662    13859    4                END;
      663    13860
      664    13861    4           ELSE DO;                        /* DELETE A SINGLE RECORD             */
      665    13862    4                IF CUR_NODE$->RPT$BLK.CODE = DEFAULT
      666    13863    4                THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);
      667    13864    4                ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);
      668    13865
      669    13866    4                CALL FORM_KEY(RET_VAL,
      670    13867    4                  REC_TYPE_CODE,
      671    13868    4                  FIRST_DEL_KEY,
      672    13869    4                  KEY_QUAL_TEXTC$);
      673    13870    4                IF RET_VAL = NORM_RET
      674    13871    5                THEN DO;
      675    13872    5                     B$RATE_DELREC_FPT.LKEY_ = VECTOR(NIL);
      676    13873                                                /* SINGLE RECORD DELETE               */
      677    13874    5                     CALL M$DELREC(B$RATE_DELREC_FPT) ALTRET (DEL_ALT);
      678    13875    5                     RETURN;
      679    13876    5                     END;
      680    13877
      681    13878    4                ELSE RETURN;
      682    13879    4                END;
      683    13880    3           END;
      684    13881    2      DCB$ = DCBADDR(DCBNUM(B$RATE_DCB));
      685    13882    2      NUM_RECS = DCB$->F$DCB.ARS;          /* NUMBER OF RECORDS DELETED          */
      686    13883    2      CALL BINCHAR(NUM_RECS_STRING.C,NUM_RECS);
      687    13884    2      FIELD1_ = VECTOR(NUM_RECS_STRING);
      688    13885    2      CALL ERR_PROC(33);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:29   
      689    13886        /*E* ERROR:   ARA-00033
      690    13887             MESSAGE: %U1 tables deleted.
      691    13888        */
      692    13889    2      RETURN;
      693    13890    2   DEL_ALT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      694    13891    2      THEN
      695    13892    2           CALL ERR_PROC(MONERR);
      696    13893                                                /* CAN'T DELETE-REC NOT FOUND         */
      697    13894    2      ELSE
      698    13895    3      DO;
      699    13896    3           CALL ERR_PROC(MONERR);
      700    13897                                                /* DELETE ERR OTHER THAN NOT FOUND*/
      701    13898    3           UNWIND TO ERROR_EXIT;
      702    13899    3           END;
      703    13900    2   END DELETE;
      704    13901        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:30   
      705    13902        /* THIS PROCEDURE DRIVES M$ERRMSG AFTER SETTING UP THE PARAMETERS FOR ITS     */
      706    13903        /* CALL. IT ACCEPTS CODE, ELAB AND INCLCODE.  IF CODE = MONERR, THE STANDARD  */
      707    13904        /* SYS ERROR IS USED, OTHERWISE AN ERROR OF KEY ARA##### IS USED WHERE #####  */
      708    13905        /* = CODE.  IF INCLCODE IS SPECIFIED, ITS VALUE IS USED FOR INCLCODE,         */
      709    13906        /* OTHERWISE YES# IS USED.                                                    */
      710    13907        /* IF ELAB = TRUE, THIS MESSAGE IS CAPABLE OF BEING ELABORATED AND BECOMES    */
      711    13908        /* THE CURRENT ERROR, OTHERWISE IT IS OUTPUT AS A ONE TIME SHOT.              */
      712    13909    1   ERR_PROC: PROC(CODE,ELAB,INCLCODE);
      713    13910    2   DCL CODE SBIN WORD;
      714    13911    2   DCL ELAB SBIN WORD;
      715    13912    2   DCL INCLCODE BIT(1) ALIGNED ;
      716    13913    2   DCL 1 TEMP_ERR,
      717    13914    2         2 FCG_MID UBIN(18) UNAL,
      718    13915    2         2 CODE UBIN(15) UNAL,
      719    13916    2         2 SEV UBIN(3) UNAL;
      720    13917    2      IF CODE = MONERR
      721    13918    2      THEN TEMP_ERR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      722    13919
      723    13920    3      ELSE DO;
      724    13921    3           TEMP_ERR.FCG_MID = 5249;        /* ARA IN SIXBIT                      */
      725    13922    3           TEMP_ERR.CODE = CODE;
      726    13923    3           END;
      727    13924    2      TEMP_ERR.SEV = 0;
      728    13925    2      CALL XUR$ERRMSG(TEMP_ERR,B$TCB$->B$TCB.ALT$->B$ALT.DCB#,,FIELD1_);
      729    13926    2      RETURN;
      730    13927    2   END ERR_PROC;
      731    13928        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:31   
      732    13929    1   FORM_KEY: PROC(RET_VAL,REC_TYPE,KEY_TEXTC,KEY_QUAL_TEXTC$);
      733    13930                                                /* THIS PROC IS USED TO FORM A        */
      734    13931                                                /* KEY. THE KEY IS PUT INTO           */
      735    13932                                                /* KEY_TEXTC . THE KEY IS             */
      736    13933                                                /* FORMED FROM OBJECT OF              */
      737    13934                                                /* KEY_QUAL_TEXTC$  AND REC_TYPE      */
      738    13935                                                /* THE PROCEDURE RETURNS NORM_RET     */
      739    13936                                                /* IF SUCCESSFUL AND RETURNS          */
      740    13937                                                /* ALT_RET IF UNSUCCESSFUL            */
      741    13938                                                /* IN RET_VAL                         */
      742    13939
      743    13940    2   DCL RET_VAL SBIN WORD;
      744    13941    2   DCL 1 KEY_TEXTC UNAL,
      745    13942    2         2 LEN UBIN BYTE UNAL,
      746    13943    2         2 TYPE CHAR(4),
      747    13944    2         2 QUAL CHAR(31);
      748    13945    2   DCL KEY_QUAL_TEXTC$ PTR;
      749    13946    2   DCL REC_TYPE SBIN WORD;
      750    13947    3      DO CASE(REC_TYPE);
      751    13948    3       CASE(ELSE);
      752    13949    3         IF KEY_QUAL_TEXTC$->TEXT$C.LEN > 6
      753    13950    3         THEN
      754    13951    4         DO;
      755    13952    4              CALL ERR_PROC(9);
      756    13953        /*E* ERROR:   ARA-00009
      757    13954             MESSAGE: Table name exceeds 6 characters.
      758    13955        */
      759    13956    4              RET_VAL = ALT_RET;
      760    13957    4              RETURN;
      761    13958    4              END;
      762    13959    3       CASE(FORM_CODE);
      763    13960    3         IF KEY_QUAL_TEXTC$->TEXT$C.LEN > 12
      764    13961    3         THEN
      765    13962    4         DO;
      766    13963    4              CALL ERR_PROC(11);
      767    13964        /*E* ERROR:       ARA-000011
      768    13965             MESSAGE: FORM table name exceeds 12 characters.
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:32   
      769    13966        */
      770    13967    4              RET_VAL = ALT_RET;
      771    13968    4              RETURN;
      772    13969    4              END;
      773    13970    3       CASE(PROC_CODE);
      774    13971    3         IF KEY_QUAL_TEXTC$->TEXT$C.LEN > 31
      775    13972    3         THEN
      776    13973    4         DO;
      777    13974    4              CALL ERR_PROC(8);
      778    13975        /*E* ERROR:       ARA-00008
      779    13976             MESSAGE: PROC table name exceeds 31 characters.
      780    13977        */
      781    13978    4              RET_VAL = ALT_RET;
      782    13979    4              RETURN;
      783    13980    4              END;
      784    13981    3         END;
      785    13982    3      DO CASE(REC_TYPE);
      786    13983    3       CASE(SCHED_CODE);
      787    13984    3         KEY_TEXTC.LEN = 10;
      788    13985    3         KEY_TEXTC.TYPE = 'SCHE';
      789    13986    3       CASE(RATE_CODE, LCP6_CODE);
      790    13987    3         KEY_TEXTC.LEN = 10;
      791    13988    3         KEY_TEXTC.TYPE = 'RATE';
      792    13989    3       CASE(PROC_CODE);
      793    13990    3         KEY_TEXTC.LEN = KEY_QUAL_TEXTC$->TEXT$C.LEN+4;
      794    13991    3         KEY_TEXTC.TYPE = 'PROC';
      795    13992    3       CASE(FORM_CODE);
      796    13993    3         KEY_TEXTC.LEN = 16;
      797    13994    3         KEY_TEXTC.TYPE = 'FORM';
      798    13995    3       CASE(COMM_CODE);
      799    13996    3         KEY_TEXTC.LEN = 10;
      800    13997    3         KEY_TEXTC.TYPE = 'COMM';
      801    13998    3         END;                              /* END CASE                           */
      802    13999    2      KEY_TEXTC.QUAL = KEY_QUAL_TEXTC$->TEXT$C.STRING;
      803    14000    2      RET_VAL = NORM_RET;
      804    14001    2   END FORM_KEY;
      805    14002        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:33   
      806    14003    1   GET_INIT_TBL: PROC(REC_TYPE);
      807    14004    2   DCL REC_TYPE SBIN WORD;
      808    14005    3      DO CASE(REC_TYPE);
      809    14006    3       CASE(SCHED_CODE);
      810    14007    3         REC_BUFB = INIT_SCHED_TBL;
      811    14008    3         B$RATE_WRITE_FPT.BUF_.BOUND        =
      812    14009    3           SIZEV(INIT_SCHED_TBL);
      813    14010    3       CASE(RATE_CODE);
      814    14011    3         REC_BUFB = INIT_RATE_TBL;
      815    14012    3         B$RATE_WRITE_FPT.BUF_.BOUND        =
      816    14013    3           SIZEV(INIT_RATE_TBL);
      817    14014    3       CASE(PROC_CODE);
      818    14015    3         REC_BUFB = INIT_PROC_TBL;
      819    14016    3         B$RATE_WRITE_FPT.BUF_.BOUND        =
      820    14017    3           SIZEV(INIT_PROC_TBL);
      821    14018    3       CASE(FORM_CODE);
      822    14019    3         REC_BUFB = INIT_FORM_TBL;
      823    14020    3         B$RATE_WRITE_FPT.BUF_.BOUND        =
      824    14021    3           SIZEV(INIT_FORM_TBL);
      825    14022    3       CASE(LCP6_CODE);
      826    14023    3         REC_BUFB = INIT_LCP6_TBL;
      827    14024    3         B$RATE_WRITE_FPT.BUF_.BOUND        =
      828    14025    3           SIZEV(INIT_LCP6_TBL);
      829    14026    3       CASE(COMM_CODE);
      830    14027    3         REC_BUFB = INIT_COMM_TBL;
      831    14028    3         B$RATE_WRITE_FPT.BUF_.BOUND        =
      832    14029    3           SIZEV(INIT_COMM_TBL);
      833    14030    3         END;                              /* END CASE                           */
      834    14031    2      RETURN;
      835    14032    2   END GET_INIT_TBL;
      836    14033        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:34   
      837    14034    1   INITIALIZE: PROC;
      838    14035    2   DCL 1 TEST_PATTERN CONSTANT,
      839    14036    2         2 * CHAR(3) INIT ('TST'),
      840    14037    2         2 * BIT(9) INIT ('000'O);
      841    14038        %FPT_PRIV(FPTN = FPT_PPRIV ,
      842    14039                  PRIV = %PPR_RATES# ,
      843    14040                  PPRIV = YES ,
      844    14041                  STCLASS = STATIC ) ;
      845    14056        %FPT_PRIV(FPTN = FPT_PRIV ,
      846    14057                  PRIV = %PR_FMSEC# ,
      847    14058                  STCLASS = STATIC ) ;
      848    14073    2   DCL 1 B_VERSION SYMREF,
      849    14074    2         2 LEN UBIN(9) UNAL,
      850    14075    2         2 TEXT CHAR(B_VERSION.LEN);
      851    14076    2      CALL XUR$INIT (XUR_INIT);
      852    14077    2      CALL M$RPRIV (FPT_PRIV);             /* Turn off FMSEC                     */
      853    14078    2      IF (B$JIT.SWITCH & '777777777000'O) = TEST_PATTERN
      854    14079    2      THEN                                 /* RATES test-mode active             */
      855    14080    3      DO;
      856    14081    3           TEST_MODE = 1;
      857    14082    3           LO_OUT_BUF = '** RATES TEST MODE HERE **';
      858    14083    3           ACCT_RATES.ACCT# = ' ';         /* Put :RATES in user's account       */
      859    14084    3           END;
      860    14085    2      ELSE                                 /* Normal RATES operation             */
      861    14086    3      DO;
      862    14087    3           TEST_MODE = 0;
      863    14088    3           IF B$JIT.PRIV.PRC               /* Check for RATES priv if in :SYS    */
      864    14089    3           THEN CALL M$SPRIV( FPT_PPRIV ) ALTRET( SPPRIV_ERR );
      865    14090    4           DO WHILE( '0'B ) ;
      866    14091    4   SPPRIV_ERR:  ;                          /* Doesn't have that processor PRIV   */
      867    14092    4                CALL ERR_PROC(44);         /* Yell at him                        */
      868    14093        /*E*  ERROR:    ARA-00044
      869    14094              MESSAGE: You do not have the privilege needed to run RATES.
      870    14095
      871    14096        */
      872    14097    4                IF '1'B THEN UNWIND TO ERROR_EXIT; /* Odd compiler               */
      873    14098    4                END;                       /* DO WHILE('0'B)                     */
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:35   
      874    14099    3           CALL CONCAT (LO_OUT_BUF,'** RATES ',B_VERSION.TEXT,' HERE **');
      875    14100    3           END;
      876    14101    2      CALL M$WRITE(FPT_WRITE_LO);          /* Greet the user                     */
      877    14102    2      IF TEST_MODE=0 THEN
      878    14103    2           CALL M$SPRIV (FPT_PRIV);        /* Turn on FMSEC to open :RATES       */
      879    14104    2      CALL M$OPEN(B$RATE_OPEN_FPT)
      880    14105    3      WHENALTRETURN DO;
      881    14106    3           CALL M$RPRIV (FPT_PRIV);
      882    14107    3           CALL ERR_PROC(MONERR);
      883    14108    3           UNWIND TO ERROR_EXIT;
      884    14109    3           END;
      885    14110    2      CALL M$RPRIV (FPT_PRIV);             /* ...and turn off FMSEC forevermore  */
      886    14111    2      CALL CHECK_DEFAULTS;
      887    14112    2      M$SI$ = DCBADDR(DCBNUM(M$SI));
      888    14113    2      RETURN;
      889    14114    2   END INITIALIZE;
      890    14115        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:36   
      891    14116    1   LIST_: PROC;                            /* PROCEDURE TO PROCESS LIST CMD      */
      892    14117    2   DCL RET_VAL SBIN WORD;
      893    14118    2   DCL CUR_NODE$ PTR;
      894    14119    2   DCL KEY_QUAL_TEXTC$ PTR;
      895    14120    2   DCL REC_TYPE_CODE SBIN WORD;
      896    14121    2   DCL IN_KEY$ PTR;
      897    14122    2      LO_OUT_BUF = ' ';
      898    14123    2      IN_KEY$ = ADDR(IN_KEY);
      899    14124    2      REC_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;
      900    14125    2      IF REC_TYPE_CODE = ALL
      901    14126    2      THEN
      902    14127    3      DO;
      903    14128    3           CALL LIST_ALL(SCHED_CODE);
      904    14129    3           CALL LIST_ALL(PROC_CODE);
      905    14130    3           CALL LIST_ALL(FORM_CODE);
      906    14131    3           CALL LIST_ALL(RATE_CODE);
      907    14132    3           CALL LIST_ALL(LCP6_CODE);
      908    14133    3           CALL LIST_ALL(COMM_CODE);
      909    14134    3           END;
      910    14135
      911    14136    3      ELSE DO;
      912    14137    3           CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);
      913    14138                                                /* POINTS TO KEY QUALIFYING NODE      */
      914    14139    3           IF CUR_NODE$->RPT$BLK.CODE = ALL
      915    14140    3           THEN CALL LIST_ALL(REC_TYPE_CODE);
      916    14141
      917    14142    4           ELSE DO;
      918    14143    4                IF CUR_NODE$->RPT$BLK.CODE = DEFAULT
      919    14144    4                THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);
      920    14145    4                ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);
      921    14146
      922    14147    4                CALL FORM_KEY(RET_VAL,
      923    14148    4                  REC_TYPE_CODE,
      924    14149    4                  IN_KEY,
      925    14150    4                  KEY_QUAL_TEXTC$);
      926    14151    4                IF RET_VAL = NORM_RET
      927    14152    5                THEN DO;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:37   
      928    14153    5                     CALL READ_B$RATE(RET_VAL,%YES#,IN_KEY);
      929    14154    5                     IF RET_VAL = NORM_RET
      930    14155    6                     THEN DO;
      931    14156    6                          CALL OUT_HDR(REC_TYPE_CODE);
      932    14157    6                          CALL LIST_ONE(REC_TYPE_CODE);
      933    14158    6                          END;
      934    14159    5                     ELSE IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
      935    14160    5                          THEN CALL ERR_PROC(MONERR);
      936    14161                                                /* CAN'T LIST, RECORD NOT FOUND       */
      937    14162    6                          ELSE DO;
      938    14163    6                               CALL ERR_PROC(MONERR);
      939    14164                                                /* READ ERROR OTHER THAN              */
      940    14165                                                /* 'RECORD NOT FOUND'                 */
      941    14166    6                               UNWIND TO ERROR_EXIT;
      942    14167    6                               END;
      943    14168    5                     END;
      944    14169    4                END;
      945    14170    3           END;
      946    14171    2      RETURN;
      947    14172        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:38   
      948    14173    2   LIST_ALL: PROC(TABLE_TYPE);
      949    14174    3   DCL TABLE_TYPE SBIN WORD;
      950    14175    3   DCL RET_VAL SBIN WORD;
      951    14176    3   DCL TBL_PFX CHAR(4);
      952    14177    3   DCL FIRST_TIME SBIN WORD;
      953    14178    3      FIRST_TIME = TRUE;
      954    14179    3      IN_KEY.LEN = 4;
      955    14180    4      DO CASE(TABLE_TYPE);
      956    14181    4       CASE(FORM_CODE);
      957    14182    4         TBL_PFX = 'FORM';
      958    14183    4       CASE(PROC_CODE);
      959    14184    4         TBL_PFX = 'PROC';
      960    14185    4       CASE(RATE_CODE);
      961    14186    4         TBL_PFX = 'RATE';
      962    14187    4       CASE(SCHED_CODE);
      963    14188    4         TBL_PFX = 'SCHE';
      964    14189    4       CASE(LCP6_CODE);
      965    14190    4         TBL_PFX = 'RATE';
      966    14191    4       CASE(COMM_CODE);
      967    14192    4         TBL_PFX = 'COMM';
      968    14193    4         END;                              /* END CASE                           */
      969    14194    3      IN_KEY.STRING = TBL_PFX;
      970    14195    3      CALL M$PRECORD_CALL;
      971    14196    4      DO WHILE(1=1);                       /* DO FOREVER                         */
      972    14197    4           IN_KEY.STRING = TBL_PFX;
      973    14198    4           CALL READ_B$RATE(RET_VAL,%NO#,IN_KEY);
      974    14199    4           IF RET_VAL = ALT_RET
      975    14200    4           THEN
      976    14201    4                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF
      977    14202    4                THEN RETURN;
      978    14203    5                ELSE DO;
      979    14204    5                     CALL ERR_PROC(MONERR); /* NON-EOF ERROR ON SEQUENTIAL       */
      980    14205    5                     UNWIND TO ERROR_EXIT; /* READ                               */
      981    14206    5                     END;
      982    14207    4           ELSE
      983    14208    4                IF SUBSTR(IN_KEY.STRING,0,4) = TBL_PFX
      984    14209    5                THEN DO;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:39   
      985    14210    5                     IF TBL_PFX='RATE'
      986    14211    5                     THEN IF REC_BUF$->RATE$TBL.LCP6#
      987    14212    5                          THEN IF TABLE_TYPE~=LCP6_CODE THEN EXIT; ELSE;
      988    14213    5                          ELSE IF TABLE_TYPE~=RATE_CODE THEN EXIT;
      989    14214    5                     IF FIRST_TIME = TRUE
      990    14215    6                     THEN DO;
      991    14216    6                          CALL OUT_HDR(TABLE_TYPE);
      992    14217    6                          FIRST_TIME = FALSE;
      993    14218    6                          END;
      994    14219    5                     CALL LIST_ONE(TABLE_TYPE);
      995    14220    5                     END;
      996    14221    4                ELSE RETURN;
      997    14222    4           END;                            /* END FOREVER                        */
      998    14223    3   END LIST_ALL;
      999    14224        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:40   
     1000    14225    2   LIST_ONE: PROC(TABLE_TYPE);
     1001    14226    3   DCL TABLE_TYPE SBIN WORD;
     1002    14227    4      DO CASE(TABLE_TYPE);
     1003    14228    4       CASE(FORM_CODE);
     1004    14229    4         CALL LIST_FORM;
     1005    14230    4       CASE(PROC_CODE,SCHED_CODE);
     1006    14231    4         CALL LIST_PROC_SCHED;
     1007    14232    4       CASE(RATE_CODE);
     1008    14233    4         CALL LIST_RATE;
     1009    14234    4       CASE(LCP6_CODE);
     1010    14235    4         CALL LIST_LCP6;
     1011    14236    4       CASE(COMM_CODE);
     1012    14237    4         CALL LIST_COMM;
     1013    14238    4         END;                              /*END CASE                            */
     1014    14239    3      RETURN;
     1015    14240    3   END LIST_ONE;
     1016    14241        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:41   
     1017    14242    2   OUT_HDR: PROC(TABLE_TYPE);
     1018    14243    3   DCL TABLE_TYPE SBIN WORD;
     1019    14244    3   DCL I SBIN;
     1020    14245    3   DCL 1 HDR_TXT CONSTANT,
     1021    14246    3         2 FRM(0:1) CHAR(60) INIT(
     1022    14247    3   'TABLE              FORM RATE           MOUNT RATE',
     1023    14248    3   '==========         ==================  =================='),
     1024    14249    3         2 ELS(0:1) CHAR(52) INIT(
     1025    14250    3   'TABLE                               RTABLE     INFO',
     1026    14251    3   '=======                             ========== ====');
     1027    14252    4      DO I=0 TO 1;
     1028    14253    4           IF TABLE_TYPE=FORM_CODE THEN SUBSTR(LO_OUT_BUF,4) = HDR_TXT.FRM(I);
     1029    14254    5           ELSE DO;
     1030    14255    5                SUBSTR(LO_OUT_BUF,4) = HDR_TXT.ELS(I);
     1031    14256    5                IF TABLE_TYPE=PROC_CODE OR TABLE_TYPE=SCHED_CODE THEN EXIT;
     1032    14257    5                SUBSTR(LO_OUT_BUF,14) = ' ';
     1033    14258    5                END;
     1034    14259    4           CALL M$WRITE(FPT_WRITE_LO);
     1035    14260    4           END;
     1036    14261    3      RETURN;
     1037    14262    3   END OUT_HDR;
     1038    14263        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:42   
     1039    14264    2   LIST_FORM: PROC;
     1040    14265    3   DCL FORM_RATE_VAL CHAR(19);
     1041    14266    3   DCL FMOUNT_RATE_VAL CHAR(19);
     1042    14267    3   DCL TEMP BIT(72) DALIGNED;
     1043    14268    3      TEMP = REC_BUF$->FORM$TBL.FORM#;
     1044    14269    3      CALL PACKED_TO_CHAR(TEMP,FORM_RATE_VAL);
     1045    14270    3      TEMP = REC_BUF$->FORM$TBL.FMOUNT#;
     1046    14271    3      CALL PACKED_TO_CHAR(TEMP,FMOUNT_RATE_VAL);
     1047    14272    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),
     1048    14273    3        SUBSTR(IN_KEY.STRING,0,4),
     1049    14274    3        ' ',
     1050    14275    3        SUBSTR(IN_KEY.STRING,4,12));
     1051    14276    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,21),
     1052    14277    3        ' ',
     1053    14278    3        FORM_RATE_VAL,
     1054    14279    3        ' ',
     1055    14280    3        FMOUNT_RATE_VAL);
     1056    14281    3      CALL M$WRITE(FPT_WRITE_LO);
     1057    14282    3      RETURN;
     1058    14283    3   END LIST_FORM;
     1059    14284        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:43   
     1060    14285    2   LIST_PROC_SCHED: PROC;
     1061    14286    3   DCL I SBIN WORD;
     1062    14287    3   DCL INSPEC_VAL(0:2) CHAR(17);
     1063    14288    3   DCL RTABLE_FIELD CHAR(37) STATIC INIT('RATE        ');
     1064    14289    3   DCL 1 RTABLE_FLD REDEF RTABLE_FIELD,
     1065    14290    3         2 * CHAR(4),
     1066    14291    3         2 R# CHAR(31),
     1067    14292    3         2 * CHAR(2);
     1068    14293    4      DO I = 0 TO 2;
     1069    14294    4           INSPEC_VAL(I) = REC_BUF$->PROC$TBL.INSPEC#(I);
     1070    14295    4           END;
     1071    14296    3      RTABLE_FLD.R# = REC_BUF$->PROC$TBL.RTABLE#;
     1072    14297    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),
     1073    14298    3        SUBSTR(IN_KEY.STRING,0,4),
     1074    14299    3        ' ',
     1075    14300    3        SUBSTR(IN_KEY.STRING,4));
     1076    14301    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,40),
     1077    14302    3        SUBSTR(RTABLE_FIELD,0,11),
     1078    14303    3        INSPEC_VAL(0),
     1079    14304    3        INSPEC_VAL(1),
     1080    14305    3        INSPEC_VAL(2));
     1081    14306    3      CALL M$WRITE(FPT_WRITE_LO);
     1082    14307    3      RETURN;
     1083    14308    3   END LIST_PROC_SCHED;
     1084    14309        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:44   
     1085    14310    2   LIST_RATE: PROC;
     1086    14311    3   DCL I SBIN WORD;
     1087    14312    3   DCL YES_NO CHAR(3);
     1088    14313    3   DCL INDX CHAR(1);
     1089    14314    3   DCL 1 CTL_INFO DALIGNED,
     1090    14315    3         2 NDX UBIN(9) CALIGNED,
     1091    14316    3         2 NAME CHAR(7);
     1092    14317    3   DCL 1 CTL$INFO(0:0) BASED DALIGNED,
     1093    14318    3         2 NDX UBIN(9) CALIGNED,
     1094    14319    3         2 NAME CHAR(7);
     1095    14320        %MACRO CTL_INFO (NAME=' ',NDX=CMULT_CODE, LAST(YES=";",NO=",")=",");
     1096    14321              2 * UBIN(9) CALIGNED INIT(%(NDX-CMULT_CODE)),
     1097    14322              2 * CHAR(7) INIT(NAME) LAST
     1098    14323        %MEND;
     1099    14324
     1100    14325    3   DCL 1 RATE_INFO CONSTANT DALIGNED,
     1101    14326        %CTL_INFO (NAME='PEXEC', NDX=PEXEC_CODE);
     1102    14330        %CTL_INFO (NAME='FCPU', NDX=FCPU_CODE);
     1103    14334        %CTL_INFO (NAME='UEXEC', NDX=UEXEC_CODE);
     1104    14338        %CTL_INFO (NAME='TCPU', NDX=TCPU_CODE);
     1105    14342        %CTL_INFO (NAME='PSTIME', NDX=PSTIME_CODE);
     1106    14346        %CTL_INFO (NAME='OCPU', NDX=OCPU_CODE);
     1107    14350        %CTL_INFO (NAME='USTIME', NDX=USTIME_CODE);
     1108    14354        %CTL_INFO (NAME='FCLOCK', NDX=FCLOCK_CODE);
     1109    14358        %CTL_INFO (NAME='PMEM', NDX=PMEM_CODE);
     1110    14362        %CTL_INFO (NAME='TCLOCK', NDX=TCLOCK_CODE);
     1111    14366        %CTL_INFO (NAME='UMEM', NDX=UMEM_CODE);
     1112    14370        %CTL_INFO (NAME='OCLOCK', NDX=OCLOCK_CODE);
     1113    14374        %CTL_INFO (NAME='CONNECT', NDX=CONNECT_CODE);
     1114    14378        %CTL_INFO (NAME='FACCESS', NDX=FACCESS_CODE);
     1115    14382        %CTL_INFO (NAME='TINTER', NDX=TINTER_CODE);
     1116    14386        %CTL_INFO (NAME='TACCESS', NDX=TACCESS_CODE);
     1117    14390        %CTL_INFO (NAME='PMMES', NDX=PMME_CODE);
     1118    14394        %CTL_INFO (NAME='OACCESS', NDX=OACCESS_CODE);
     1119    14398        %CTL_INFO (NAME='FMOUNT', NDX=FMOUNT_CODE);
     1120    14402        %CTL_INFO (NAME='JSTEPS', NDX=JSTEPS_CODE);
     1121    14406        %CTL_INFO (NAME='TMOUNT', NDX=TMOUNT_CODE);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:45   
     1122    14410        %CTL_INFO (NAME='TPACK', NDX=TPACK_CODE);
     1123    14414        %CTL_INFO (NAME='OMOUNT', NDX=OMOUNT_CODE);
     1124    14418        %CTL_INFO (LAST=YES);
     1125    14422
     1126    14423    3   DCL 1 LCP6_INFO CONSTANT DALIGNED,
     1127    14424        %CTL_INFO (NAME='PEXEC', NDX=PEXEC_CODE);
     1128    14428        %CTL_INFO (NAME='MCLS', NDX=MCLS_CODE);
     1129    14432        %CTL_INFO (NAME='UEXEC', NDX=UEXEC_CODE);
     1130    14436        %CTL_INFO (NAME='INTS', NDX=FEPINT_CODE);
     1131    14440        %CTL_INFO (NAME='PSTIME', NDX=PSTIME_CODE);
     1132    14444        %CTL_INFO (NAME='JSTEPS', NDX=JSTEPS_CODE);
     1133    14448        %CTL_INFO (NAME='USTIME', NDX=USTIME_CODE);
     1134    14452        %CTL_INFO (NAME='CONNECT', NDX=CONNECT_CODE);
     1135    14456        %CTL_INFO (NAME='PMEM', NDX=PMEM_CODE);
     1136    14460        %CTL_INFO (NAME='UMEM', NDX=UMEM_CODE);
     1137    14464        %CTL_INFO (NAME='TINTER', NDX=TINTER_CODE);
     1138    14468        %CTL_INFO (NAME='HACCESS', NDX=HACCESS_CODE);
     1139    14472        %CTL_INFO (LAST=YES);
     1140    14476
     1141    14477    3      CALL LIST_JSUNIT;
     1142    14478
     1143    14479    3      I = 0;
     1144    14480    4      DO WHILE '1'B;
     1145    14481    4           CTL_INFO = ADDR(RATE_INFO)->CTL$INFO(I);
     1146    14482    4           IF CTL_INFO.NDX=0 THEN EXIT;
     1147    14483    4           CALL INSERT (LO_OUT_BUF,5,,CTL_INFO.NAME,' =');
     1148    14484    4           CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.NDX),
     1149    14485    4             SUBSTR(LO_OUT_BUF,16,19));
     1150    14486    4           I = I + 1;
     1151    14487    4           CTL_INFO = ADDR(RATE_INFO)->CTL$INFO(I);
     1152    14488    5           IF CTL_INFO.NDX>0 THEN DO;
     1153    14489    5                CALL INSERT (LO_OUT_BUF,35,,CTL_INFO.NAME,' =');
     1154    14490    5                CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.
             14490                         NDX),
     1155    14491    5                  SUBSTR(LO_OUT_BUF,46,19));
     1156    14492    5                I = I + 1;
     1157    14493    5                END;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:46   
     1158    14494    4           CALL M$WRITE(FPT_WRITE_LO);
     1159    14495    4           END;
     1160    14496    3      RETURN;
     1161    14497
     1162    14498        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:47   
     1163    14499        /*   LIST_LCP6 prints out the contents of a B$LCP6_RATE table.
     1164    14500        */
     1165    14501    3   LIST_LCP6: ENTRY;
     1166    14502
     1167    14503    3      CALL LIST_JSUNIT;
     1168    14504
     1169    14505    3      I = 0;
     1170    14506    4      DO WHILE '1'B;
     1171    14507    4           CTL_INFO = ADDR(LCP6_INFO)->CTL$INFO(I);
     1172    14508    4           IF CTL_INFO.NDX=0 THEN EXIT;
     1173    14509    4           CALL INSERT (LO_OUT_BUF,5,,CTL_INFO.NAME,' =');
     1174    14510    4           CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.NDX),
     1175    14511    4             SUBSTR(LO_OUT_BUF,16,19));
     1176    14512    4           I = I + 1;
     1177    14513    4           CTL_INFO = ADDR(LCP6_INFO)->CTL$INFO(I);
     1178    14514    5           IF CTL_INFO.NDX>0 THEN DO;
     1179    14515    5                CALL INSERT (LO_OUT_BUF,35,,CTL_INFO.NAME,' =');
     1180    14516    5                CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.
             14516                         NDX),
     1181    14517    5                  SUBSTR(LO_OUT_BUF,46,19));
     1182    14518    5                I = I + 1;
     1183    14519    5                END;
     1184    14520    4           CALL M$WRITE(FPT_WRITE_LO);
     1185    14521    4           END;
     1186    14522
     1187    14523    3      RETURN;
     1188    14524        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:48   
     1189    14525
     1190    14526        /*   LIST_JSUNIT prints the JUNIT and SUNIT information for the
     1191    14527           LIST_RATE and LIST_LCP6 routines.
     1192    14528        */
     1193    14529
     1194    14530    3   LIST_JSUNIT: PROC;
     1195    14531    4      IF REC_BUF$->RATE$TBL.PERCENT#
     1196    14532    4      THEN YES_NO = 'YES';
     1197    14533    4      ELSE YES_NO = 'NO';
     1198    14534
     1199    14535    4      CALL INDEX(I,' ',IN_KEY.STRING);
     1200    14536    4      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),
     1201    14537    4        SUBSTR(IN_KEY.STRING,0,4),
     1202    14538    4        ' ',
     1203    14539    4        SUBSTR(IN_KEY.STRING,4,I-4));
     1204    14540    4      CALL CONCAT(SUBSTR(LO_OUT_BUF,I+5),
     1205    14541    4        '         ',
     1206    14542    4        'PERCENT = ',
     1207    14543    4        YES_NO,
     1208    14544    4        ' CMULT = ');
     1209    14545    4      CALL PACKED_TO_CHAR(REC_BUF$->RATE$TBL.CMULT#,SUBSTR(LO_OUT_BUF,I+36,19));
     1210    14546    4      CALL M$WRITE(FPT_WRITE_LO);
     1211    14547
     1212    14548    4      LO_OUT_BUF = ' ';
     1213    14549    5      DO I = 0 TO 3;
     1214    14550    5           CALL CONCAT(SUBSTR(LO_OUT_BUF,7),
     1215    14551    5             REC_BUF$->RATE$TBL.JUNIT.NAME#(I),
     1216    14552    5             '  JUNIT',
     1217    14553    5             BINASC(I+49),
     1218    14554    5             ' =');
     1219    14555    5           CALL PACKED_TO_CHAR(REC_BUF$->RATE$TBL.JUNIT.RATE#(I),
     1220    14556    5             SUBSTR(LO_OUT_BUF,33,19));
     1221    14557    5           CALL M$WRITE(FPT_WRITE_LO);
     1222    14558    5           END;
     1223    14559
     1224    14560    5      DO I = 0 TO 3;
     1225    14561    5           CALL CONCAT(SUBSTR(LO_OUT_BUF,7),
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:49   
     1226    14562    5             REC_BUF$->RATE$TBL.SUNIT.NAME#(I),
     1227    14563    5             '  SUNIT',
     1228    14564    5             BINASC(I+49),
     1229    14565    5             ' =');
     1230    14566    5           CALL PACKED_TO_CHAR(REC_BUF$->RATE$TBL.SUNIT.RATE#(I),
     1231    14567    5             SUBSTR(LO_OUT_BUF,33,19));
     1232    14568    5           CALL M$WRITE(FPT_WRITE_LO);
     1233    14569    5           END;
     1234    14570
     1235    14571    4      RETURN;
     1236    14572    4   END LIST_JSUNIT;
     1237    14573    3   END LIST_RATE;
     1238    14574        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:50   
     1239    14575
     1240    14576        /*   LIST_COMM prints the information from a B$COMM_TBL record.
     1241    14577        */
     1242    14578
     1243    14579    2   LIST_COMM: PROC;
     1244    14580
     1245    14581    3      LO_OUT_BUF = ' ';
     1246    14582    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),
     1247    14583    3        SUBSTR(IN_KEY.STRING,0,4),
     1248    14584    3        ' ',
     1249    14585    3        SUBSTR(IN_KEY.STRING,4));
     1250    14586
     1251    14587    3      CALL M$WRITE(FPT_WRITE_LO);
     1252    14588    3      RETURN;
     1253    14589
     1254    14590    3   END LIST_COMM;
     1255    14591    2   END LIST_;
     1256    14592        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:51   
     1257    14593    1   MODIFY: PROC;                           /* PROCEDURE TO PROCESS MODIFY        */
     1258    14594                                                /* COMMAND                            */
     1259    14595    2   DCL RET_VAL SBIN WORD;
     1260    14596    2   DCL CUR_NODE$ PTR;
     1261    14597    2   DCL KEY_QUAL_TEXTC$ PTR;
     1262    14598    2   DCL REC_TYPE_CODE SBIN WORD;
     1263    14599    2      REC_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;
     1264    14600
     1265    14601    2      CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);
     1266    14602                                                /* POINTS TO KEY QUALIFYING NODE      */
     1267    14603    2      IF CUR_NODE$->RPT$BLK.CODE = DEFAULT
     1268    14604    2      THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);
     1269    14605    2      ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);
     1270    14606    2      CALL FORM_KEY(RET_VAL,
     1271    14607    2        REC_TYPE_CODE,
     1272    14608    2        OUT_KEY,
     1273    14609    2        KEY_QUAL_TEXTC$);
     1274    14610    2      IF RET_VAL = NORM_RET
     1275    14611    3      THEN DO;
     1276    14612    3           CALL READ_B$RATE(RET_VAL,%YES#,OUT_KEY);
     1277    14613    3           IF RET_VAL = NORM_RET
     1278    14614    3           THEN
     1279    14615    3                CALL UPDATE_TBL (REC_TYPE_CODE);
     1280    14616    3           ELSE
     1281    14617    3                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY
     1282    14618    3                THEN CALL ERR_PROC(MONERR);
     1283    14619    4                ELSE DO;
     1284    14620    4                     CALL ERR_PROC(MONERR);
     1285    14621    4                     UNWIND TO ERROR_EXIT;
     1286    14622    4                     END;
     1287    14623    3           END;
     1288    14624    2      RETURN;
     1289    14625    2   END MODIFY;
     1290    14626        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:52   
     1291    14627    1   M$PRECORD_CALL: PROC;
     1292    14628    2      CALL M$PRECORD(FPT_PRECORD) ALTRET(PREC_ALT);
     1293    14629    3      DO WHILE('0'B);
     1294    14630    3   PREC_ALT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY
     1295    14631    3           THEN                            /* PRECORD error                      */
     1296    14632    4           DO;
     1297    14633    4                CALL ERR_PROC(MONERR);
     1298    14634    4                UNWIND TO ERROR_EXIT;
     1299    14635    4                END;
     1300    14636    3           ELSE ;                          /* It was just 'KEY NOT FOUND', OK    */
     1301    14637    3   DUMMY1: END;
     1302    14638    2      RETURN;
     1303    14639    2   END M$PRECORD_CALL;
     1304    14640        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:53   
     1305    14641        /* THIS PROCEDURE CONVERTS A SIGNED, FLOATING POINT PACKED DECIMAL NUMBER     */
     1306    14642        /* (PACKED) TO A 19 CHARACTER STRING REPRESENTING THAT NUMBER(CHAR_BUF)       */
     1307    14643    1   PACKED_TO_CHAR: PROC(PACKED,CHAR_BUF);
     1308    14644    2   DCL 1 PACKED DALIGNED,
     1309    14645    2         2 * BIT(1),
     1310    14646    2         2 SIGN UBIN(4) UNAL,
     1311    14647    2         2 DIGITS BIT(58),
     1312    14648    2         2 * BIT(1),
     1313    14649    2         2 EXP UBIN(8) UNAL;
     1314    14650    2   DCL CHAR_BUF CHAR(19);
     1315    14651    2   DCL PRINT_LEN SBIN WORD;
     1316    14652    2   DCL TRAILING_ZEROES SBIN WORD;
     1317    14653    2   DCL FLIPPER SBIN WORD;
     1318    14654    2   DCL EXPONENT SBIN WORD;
     1319    14655    2   DCL I SBIN WORD;
     1320    14656    2   DCL DIGIT$ PTR;
     1321    14657    2   DCL 1 MANTISSA,
     1322    14658    2         2 LEN UBIN (9) UNAL,
     1323    14659    2         2 STRING CHAR(13),
     1324    14660    2         2 STRING_ARY(0:12) REDEF STRING,
     1325    14661    2           3 * UBIN(5) UNAL,
     1326    14662    2           3 NUM UBIN(4) UNAL;
     1327    14663    2   DCL ONE$NIBBLE UBIN(4) BASED UNAL;
     1328    14664    2      CHAR_BUF = ' ';                      /* BLANK OUT THE RECEIVING FIELD      */
     1329    14665    2      MANTISSA.STRING = ZERO_STRING;       /* PREPARE FOR RECEIVING LOW          */
     1330    14666                                                /* NIBBLE OF NUMBER TO FORM CHARS*/
     1331    14667    2      MANTISSA.LEN = 0;
     1332    14668    2      TRAILING_ZEROES = 0;
     1333    14669    2      FLIPPER = 0;
     1334    14670    2      DIGIT$ = ADDR(PACKED.DIGITS);
     1335    14671    3      DO I = 1 TO 13;
     1336    14672    3           IF DIGIT$->ONE$NIBBLE = 0
     1337    14673    3           THEN
     1338    14674    3                IF MANTISSA.LEN > 0
     1339    14675    3                THEN
     1340    14676    4                DO;
     1341    14677    4                     TRAILING_ZEROES = TRAILING_ZEROES + 1;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:54   
     1342    14678    4                     MANTISSA.STRING_ARY.NUM(MANTISSA.LEN) =
     1343    14679    4                       DIGIT$->ONE$NIBBLE;
     1344    14680    4                     MANTISSA.LEN = MANTISSA.LEN + 1;
     1345    14681    4                     END;
     1346    14682    3                ELSE ;
     1347    14683    3           ELSE
     1348    14684    4           DO;
     1349    14685    4                TRAILING_ZEROES = 0;
     1350    14686    4                MANTISSA.STRING_ARY.NUM(MANTISSA.LEN) =
     1351    14687    4                  DIGIT$->ONE$NIBBLE;
     1352    14688    4                MANTISSA.LEN = MANTISSA.LEN + 1;
     1353    14689    4                END;
     1354    14690    3           FLIPPER = 1 - FLIPPER;
     1355    14691    3           DIGIT$ = PINCRB(DIGIT$,4 + FLIPPER);
     1356    14692    3           END;
     1357    14693    2      MANTISSA.LEN = MANTISSA.LEN - TRAILING_ZEROES;
     1358    14694    2      IF MANTISSA.LEN = 0
     1359    14695    2      THEN                                 /* IF NUMBER IS 0, THEN SET           */
     1360    14696    2           EXPONENT = 0;                   /* MAKE EXPONENT = 0                  */
     1361    14697    2      ELSE
     1362    14698    2           IF PACKED.EXP > 128             /* IF NEGATIVE EXPONENT               */
     1363    14699    2           THEN
     1364    14700    2                EXPONENT = PACKED.EXP - 256 + TRAILING_ZEROES;
     1365    14701                                                /* THIS METHOD WILL FAIL FOR -0       */
     1366    14702    2           ELSE
     1367    14703    2                EXPONENT = PACKED.EXP + TRAILING_ZEROES;
     1368    14704    2      IF EXPONENT > 0
     1369    14705    2      THEN
     1370    14706    2           PRINT_LEN = EXPONENT + MANTISSA.LEN;
     1371    14707    2      ELSE
     1372    14708    2           IF -EXPONENT > MANTISSA.LEN
     1373    14709    2           THEN
     1374    14710    2                PRINT_LEN = MANTISSA.LEN - EXPONENT;
     1375    14711    2           ELSE
     1376    14712    2                PRINT_LEN = MANTISSA.LEN;
     1377    14713    2      IF PRINT_LEN > 5
     1378    14714    2      THEN
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:55   
     1379    14715    2           CALL EXP_NOT_FORM;              /* FORM NUMBER IN EXPONENTIAL         */
     1380    14716                                                /* NOTATION FORM                      */
     1381    14717    2      ELSE
     1382    14718    2           CALL DEC_PT_FORM;               /* OTHERWISE FORM AS XX.XX            */
     1383    14719    2      RETURN;
     1384    14720        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:56   
     1385    14721    2   EXP_NOT_FORM: PROC;
     1386    14722    3   DCL SIGN_CHAR CHAR(1);
     1387    14723    3   DCL SIGN_EXP CHAR(3);
     1388    14724    3      IF PACKED.SIGN = 13                  /* NEGATIVE SIGN                      */
     1389    14725    3      THEN
     1390    14726    3           SIGN_CHAR = '-';
     1391    14727    3      ELSE
     1392    14728    3           SIGN_CHAR = ' ';
     1393    14729    3      EXPONENT = EXPONENT + MANTISSA.LEN - 1;
     1394    14730                                                /* NORMALIZE                          */
     1395    14731    3      CALL BINXCHAR(SIGN_EXP,EXPONENT);
     1396    14732    3      CALL CONCAT(CHAR_BUF,
     1397    14733    3        SIGN_CHAR,
     1398    14734    3        SUBSTR(MANTISSA.STRING,0,1),
     1399    14735    3        '.',
     1400    14736    3        SUBSTR(MANTISSA.STRING,1,MANTISSA.LEN - 1),
     1401    14737    3        'E',
     1402    14738    3        SIGN_EXP);
     1403    14739    3      RETURN;
     1404    14740    3   END EXP_NOT_FORM;
     1405    14741        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:57   
     1406    14742    2   DEC_PT_FORM: PROC;
     1407    14743    3   DCL MAN_LEN SBIN WORD;
     1408    14744    3   DCL BEFORE_LEN SBIN WORD;
     1409    14745    3   DCL TRAIL_0_LEN SBIN WORD;
     1410    14746    3   DCL PT_LEN SBIN WORD;
     1411    14747    3   DCL LEAD_0_LEN SBIN WORD;
     1412    14748    3   DCL AFTER_LEN SBIN WORD;
     1413    14749    3   DCL TEMP SBIN WORD;
     1414    14750    3   DCL SIGN_CHAR CHAR(1);
     1415    14751    3   DCL DEC_PT CHAR(1) CONSTANT INIT('.');
     1416    14752    3      MAN_LEN = MANTISSA.LEN;              /* CHANGE TYPE FROM UBIN BYTE TO      */
     1417    14753                                                /* SBIN WORD                          */
     1418    14754    3      IF MAN_LEN = 0
     1419    14755    3      THEN
     1420    14756    3           CHAR_BUF = ' 0';
     1421    14757    3      ELSE
     1422    14758    4      DO;
     1423    14759    4           IF PACKED.SIGN = 13
     1424    14760    4           THEN                            /* NEGATIVE SIGN                      */
     1425    14761    4                SIGN_CHAR = '-';
     1426    14762    4           ELSE
     1427    14763    4                SIGN_CHAR = ' ';
     1428    14764    4           BEFORE_LEN = MINIMUM (MAXIMUM (0, MAN_LEN + EXPONENT), MAN_LEN);
     1429    14765    4           TRAIL_0_LEN = MAXIMUM (0,EXPONENT);
     1430    14766    4           IF EXPONENT < 0
     1431    14767    4           THEN
     1432    14768    4                PT_LEN = 1;
     1433    14769    4           ELSE
     1434    14770    4                PT_LEN = 0;
     1435    14771    4           LEAD_0_LEN = MAXIMUM (0,-EXPONENT-MAN_LEN);
     1436    14772    4           AFTER_LEN = MINIMUM (MAXIMUM (0,-EXPONENT), MAN_LEN);
     1437    14773    4           CALL CONCAT(CHAR_BUF,
     1438    14774    4             SIGN_CHAR,
     1439    14775    4             SUBSTR(MANTISSA.STRING,0,BEFORE_LEN),
     1440    14776    4             SUBSTR(ZERO_STRING,0,TRAIL_0_LEN),
     1441    14777    4             SUBSTR(DEC_PT,0,PT_LEN),
     1442    14778    4             SUBSTR(ZERO_STRING,0,LEAD_0_LEN),
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:58   
     1443    14779    4             SUBSTR(MANTISSA.STRING,BEFORE_LEN,AFTER_LEN));
     1444    14780    4           END;
     1445    14781    3      RETURN;
     1446    14782    3   END DEC_PT_FORM;
     1447    14783    2   END PACKED_TO_CHAR;
     1448    14784        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:59   
     1449    14785    1   READ_B$RATE:PROC(RET_VAL,KEYED_OR_NOT,KEY_TEXTC);
     1450    14786                                                /* PROCEDURE TO READ A RECORD         */
     1451    14787                                                /* FROM B$RATE AND RETURN.            */
     1452    14788                                                /* IT RETURNS NORM_RET IF THE         */
     1453    14789                                                /* CALL                               */
     1454    14790                                                /* TO M$READ WAS ERROR_FREE AND       */
     1455    14791                                                /* ALT_RET IF THE ALTRETURN PATH      */
     1456    14792                                                /* WAS TAKEN(IN RET_VAL).             */
     1457    14793                                                /* IF KEYED_OR_NOT = KEYED, THE       */
     1458    14794                                                /* RECORD IS READ KEYED USING         */
     1459    14795                                                /* KEY_TEXTC---NO KEY RETURNED        */
     1460    14796                                                /* OTHERWISE IT READS                 */
     1461    14797                                                /* SEQUENTIALLY---KEY IS RETURNED*/
     1462    14798    2   DCL RET_VAL SBIN WORD;
     1463    14799    2   DCL KEYED_OR_NOT BIT(1) ALIGNED;
     1464    14800    2   DCL KEY_TEXTC CHAR(36);
     1465    14801    2      B$RATE_READ_FPT.V.KEYS# = KEYED_OR_NOT;
     1466    14802    2      B$RATE_READ_FPT.V.KEYR# = ~KEYED_OR_NOT;
     1467    14803    2      B$RATE_READ_FPT.KEY_ = VECTOR(KEY_TEXTC);
     1468    14804    2      CALL M$READ(B$RATE_READ_FPT)  ALTRET(BAD_READ);
     1469    14805    2      RET_VAL = NORM_RET;
     1470    14806    2      RETURN;
     1471    14807    2   BAD_READ: RET_VAL = ALT_RET;
     1472    14808    2      RETURN;
     1473    14809    2   END READ_B$RATE;
     1474    14810        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:60   
     1475    14811    1   UPDATE_FORM_TBL: PROC;
     1476    14812    2   DCL RET_VAL SBIN WORD;
     1477    14813    2   DCL PACKED_NUM BIT(72) DALIGNED;
     1478    14814    2   DCL VALUE$ PTR;
     1479    14815
     1480    14816    3      DO CASE(RPT$BLK.CODE);
     1481    14817    3       CASE(FORM_CODE,FRM_MNT_CODE);
     1482    14818    3         VALUE$ = RPT$BLK.SUB_BLK$(0);
     1483    14819    3         CALL CONVERT_TO_PACKED(RET_VAL,
     1484    14820    3           VALUE$,
     1485    14821    3           PACKED_NUM);
     1486    14822    3         IF RET_VAL = NORM_RET
     1487    14823    3         THEN
     1488    14824    4         DO;
     1489    14825    4              IF RPT$BLK.CODE = FORM_CODE
     1490    14826    4              THEN
     1491    14827    4                   REC_BUF$->FORM$TBL.FORM# = PACKED_NUM;
     1492    14828    4              ELSE
     1493    14829    4                   REC_BUF$->FORM$TBL.FMOUNT# = PACKED_NUM;
     1494    14830    4              ERR_CODE.CODE = 0;
     1495    14831    4              END;
     1496    14832    3         END;                              /* END CASE                           */
     1497    14833    2   END UPDATE_FORM_TBL;
     1498    14834        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:61   
     1499    14835        /* THIS PROCEDURE UPDATES (OR INITIALIZES) THE RATE RATE TABLE                */
     1500    14836    1   UPDATE_RATE_TBL: PROC;
     1501    14837    2   DCL INDX  SBIN WORD;
     1502    14838    2   DCL RET_VAL SBIN WORD;
     1503    14839    2   DCL TYPE SBIN WORD;
     1504    14840    2   DCL PACKED_NUM BIT(72) DALIGNED;
     1505    14841    2   DCL VALUE$ PTR;
     1506    14842    2   DCL VALUE_BASE$ PTR;
     1507    14843
     1508    14844    2      VALUE_BASE$ = ADDR(REC_BUF$->RATE$TBL.CMULT#);
     1509    14845
     1510    14846    3      DO CASE(RPT$BLK.CODE);
     1511    14847    3       CASE(JSUNIT);                       /* JOB OR STEP UNIT                   */
     1512    14848    3         CALL PROCESS_JSUNIT;
     1513    14849    3       CASE(VALUE_SET);                    /* VALUE TYPE                         */
     1514    14850    3         VALUE$ = RPT$BLK.SUB_BLK$(1);
     1515    14851                                                /* POINTS TO VALUE SUB-TREE           */
     1516    14852    3         TYPE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;
     1517    14853    3         INDX  = TYPE - CMULT_CODE;
     1518    14854                                                /* TYPE OF VALUE NODE THIS IS         */
     1519    14855    3         CALL CONVERT_TO_PACKED(RET_VAL,VALUE$,PACKED_NUM);
     1520    14856    3         IF RET_VAL = NORM_RET
     1521    14857    4         THEN DO;
     1522    14858    4              VALUE_BASE$->PACKED$NUM$ARY(INDX)  = PACKED_NUM;
     1523    14859                                                /* STUFF THE VALUE AWAY               */
     1524    14860    4              ERR_CODE.CODE = 0;
     1525    14861    4              END;
     1526    14862    3         END;                              /* END CASE                           */
     1527    14863        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:62   
     1528    14864        /*   PROCESS_JSUNIT is used to process a JUNIT or SUNIT option for
     1529    14865           B$RATE_TBL or B$LCP6_TBL modification.
     1530    14866        */
     1531    14867    2   PROCESS_JSUNIT: PROC;
     1532    14868    3   DCL NUM$ PTR;
     1533    14869    3   DCL NAME$ PTR;
     1534    14870    3   DCL T_NAME CHAR(16);
     1535    14871    3      NUM$ = RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);
     1536    14872                                                /* POINTS TO INDEX TEXTC              */
     1537    14873    3      IF NUM$->TEXT$C.LEN > 1 OR NUM$->TEXT$C.STRING < '1'
     1538    14874    3        OR NUM$->TEXT$C.STRING > '4'
     1539    14875    4      THEN DO;
     1540    14876    4           CALL ERR_PROC(10);
     1541    14877    4           RETURN;
     1542    14878    4           END;
     1543    14879        /*E* ERROR:   ARA-00010
     1544    14880             MESSAGE: JUNIT or SUNIT number must be 1,2,3, OR 4.
     1545    14881        */
     1546    14882
     1547    14883    3      CALL CHARBIN(INDX,NUM$->TEXT$C.STRING);
     1548    14884    3      INDX  = INDX  - 1;
     1549    14885    3      IF RPT$BLK.SUB_BLK$(2)->RPT$BLK.NUM_SUB_BLKS > 0
     1550    14886    4      THEN DO;                             /* Value specified                    */
     1551    14887    4           VALUE$ = RPT$BLK.SUB_BLK$(2)->RPT$BLK.SUB_BLK$(0);
     1552    14888                                                /* POINTS TO VALUE SUB-TREE           */
     1553    14889    4           CALL CONVERT_TO_PACKED(RET_VAL,VALUE$,PACKED_NUM);
     1554    14890    4           IF RET_VAL = ALT_RET
     1555    14891    4           THEN RETURN;
     1556    14892    4           END;
     1557    14893    3      ELSE PACKED_NUM='77'O;               /* AN IMPOSSIBLE VALUE AS A FLAG      */
     1558    14894                                                /* NOT TO STORE PACKED_NUM            */
     1559    14895    3      IF RPT$BLK.NUM_SUB_BLKS = 4
     1560    14896    3      THEN                                 /* JOB OR STEP UNIT NAME INPUT        */
     1561    14897    3           IF RPT$BLK.SUB_BLK$(3)->RPT$BLK.NUM_SUB_BLKS > 0
     1562    14898    4           THEN DO;                        /* AND NOT BLANK                      */
     1563    14899    4                NAME$ = RPT$BLK.SUB_BLK$(3)->RPT$BLK.SUB_BLK$(0)->
     1564    14900    4                  RPT$BLK.SUB_BLK$(0);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:63   
     1565    14901                                                /* POINTS TO NAME TEXTC               */
     1566    14902    4                IF NAME$->TEXT$C.LEN > 16
     1567    14903    5                THEN DO;
     1568    14904    5                     CALL ERR_PROC(18);
     1569    14905    5                     RETURN;
     1570    14906    5                     END;
     1571    14907        /*E* ERROR:   ARA-00018
     1572    14908             MESSAGE: JUNIT or SUNIT name exceeds 16 characters.
     1573    14909        */
     1574    14910    4                ELSE T_NAME = NAME$->TEXT$C.STRING;
     1575    14911    4                END;
     1576    14912    3           ELSE T_NAME = ' ';              /* MUST BLANK OUT                     */
     1577    14913    3      ELSE T_NAME = '* *';
     1578    14914                                 /* an impossible value as a flag not to store T_NAME */
     1579    14915    3      IF RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE = JUNIT_CODE
     1580    14916    4      THEN DO;                             /* JOB UNIT ENTRY                     */
     1581    14917    4           IF PACKED_NUM ~= '77'O
     1582    14918    4           THEN REC_BUF$->RATE$TBL.JUNIT.RATE#(INDX) = PACKED_NUM;
     1583    14919                                                /* Write the converted number         */
     1584    14920
     1585    14921    4           IF T_NAME ~= '* *'
     1586    14922    4           THEN REC_BUF$->RATE$TBL.JUNIT.NAME#(INDX) = T_NAME;
     1587    14923                                                /* Write the input name               */
     1588    14924    4           END;
     1589    14925    4      ELSE DO;
     1590    14926    4           IF PACKED_NUM ~= '77'O
     1591    14927    4           THEN REC_BUF$->RATE$TBL.SUNIT.RATE#(INDX) = PACKED_NUM;
     1592    14928    4           IF T_NAME ~= '* *'
     1593    14929    4           THEN REC_BUF$->RATE$TBL.SUNIT.NAME#(INDX) = T_NAME;
     1594    14930    4           END;
     1595    14931    3      ERR_CODE.CODE = 0;
     1596    14932    3   END PROCESS_JSUNIT;
     1597    14933    2   END UPDATE_RATE_TBL;
     1598    14934        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:64   
     1599    14935        /* THIS PROCEDURE UPDATES (OR INITIALIZES) THE COMM RATE TABLE                */
     1600    14936    1   UPDATE_COMM_TBL: PROC;
     1601    14937
     1602    14938    2   END UPDATE_COMM_TBL;
     1603    14939        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:65   
     1604    14940        /* THIS PROCEDURE IS THE DRIVER FOR MODIFICATION (OR INITIALIZATION) OF       */
     1605    14941        /* THE PROCESSOR AND SCHEDULE RATE TABLES.                                    */
     1606    14942    1   UPDATE_SCHED_TBL: PROC;
     1607    14943    2   DCL PACKED_NUM PTR;
     1608    14944    2   DCL NUM$ PTR;
     1609    14945    2   DCL STRING$ PTR;
     1610    14946    2   DCL INDX  SBIN WORD;
     1611    14947    3      DO CASE(RPT$BLK.CODE);
     1612    14948    3       CASE(RTABLE_CODE);                  /* RTABLE=...                         */
     1613    14949    3         IF RPT$BLK.NUM_SUB_BLKS=0
     1614    14950    4         THEN DO;                          /* BLANK RTABLE INPUT                 */
     1615    14951    4              REC_BUF$->SCHED$TBL.RTABLE# = ' ';
     1616    14952    4              ERR_CODE.CODE = 0;
     1617    14953    4              RETURN;
     1618    14954    4              END;
     1619    14955    3         NUM$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);
     1620    14956                                                /* POINTS TO TEXTC OF RTABLE VAL      */
     1621    14957    3         IF NUM$->TEXT$C.LEN > 6
     1622    14958    3         THEN CALL ERR_PROC(9);
     1623    14959
     1624    14960    4         ELSE DO;
     1625    14961    4              REC_BUF$->SCHED$TBL.RTABLE# = NUM$->TEXT$C.STRING;
     1626    14962    4              ERR_CODE.CODE = 0;
     1627    14963    4              END;
     1628    14964    3       CASE(INSPEC_CODE);                  /* INSPECN=...                        */
     1629    14965    3         NUM$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);
     1630    14966                                                /* POINTS TO TEXTC OF INDEX           */
     1631    14967    3         IF NUM$->TEXT$C.LEN > 1
     1632    14968    3           OR NUM$->TEXT$C.STRING < '1'
     1633    14969    3           OR NUM$->TEXT$C.STRING > '3'
     1634    14970    3         THEN CALL ERR_PROC(17);
     1635    14971        /*E* ERROR:   ARA-00017
     1636    14972             MESSAGE: INFOn must be INFO1, INFO2, OR INFO3.
     1637    14973        */
     1638    14974    4         ELSE DO;
     1639    14975    4              CALL CHARBIN(INDX,NUM$->TEXT$C.STRING);
     1640    14976    4              INDX  = INDX  - 1;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:66   
     1641    14977    4              IF RPT$BLK.NUM_SUB_BLKS = 1
     1642    14978    5              THEN DO;                     /* MUST BLANK OUT FIELD               */
     1643    14979    5                   REC_BUF$->SCHED$TBL.INSPEC#(INDX) = '  ';
     1644    14980    5                   ERR_CODE.CODE = 0;
     1645    14981    5                   END;
     1646    14982    5              ELSE DO;
     1647    14983    5                   STRING$ = RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);
     1648    14984                                                /* POINTS TO TEXTC OF STRING          */
     1649    14985    5                   IF STRING$->TEXT$C.LEN > 16
     1650    14986    5                   THEN CALL ERR_PROC(19);
     1651    14987        /*E* ERROR:   ARA-00019
     1652    14988             MESSAGE: INFO value exceeds 16 characters.
     1653    14989        */
     1654    14990
     1655    14991    6                   ELSE DO;
     1656    14992    6                        REC_BUF$->SCHED$TBL.INSPEC#(INDX) =
     1657    14993    6                          STRING$->TEXT$C.STRING;
     1658    14994                                                /* PUT INSPEC VALUE INTO ITS          */
     1659    14995                                                /* CORRECT SLOT IN THE SCHEDULE       */
     1660    14996                                                /* RATE TABLE LEFT JUSTIFIED AND      */
     1661    14997                                                /* BLANK FILLED                       */
     1662    14998    6                        ERR_CODE.CODE = 0;
     1663    14999    6                        END;
     1664    15000    5                   END;
     1665    15001    4              END;
     1666    15002    3         END;                              /* END CASE                           */
     1667    15003    2   END UPDATE_SCHED_TBL;
     1668    15004        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:67   
     1669    15005    1   UPDATE_TBL: PROC (TABLE_TYPE);          /* PROCEDURE TO CALL CORRECT          */
     1670    15006                                                /* TABLE UPDATE ROUTINE               */
     1671    15007    2   DCL TABLE_TYPE UBIN;
     1672    15008    2   DCL NOD$(0:6) CONSTANT PTR INIT( ADDR(SCHED_CMD_ROOT)*2, ADDR(RATE_CMD_ROOT),
     1673    15009    2      ADDR(SCHED_CMD_ROOT), ADDR(FORM_CMD_ROOT), ADDR(LCP6_CMD_ROOT),
     1674    15010    2      ADDR(COMM_CMD_ROOT));
     1675    15011    2   DCL VBND(0:6) CONSTANT UBIN INIT( SIZEV(SCHED$TBL)*2, SIZEV(RATE$TBL),
     1676    15012    2      SIZEV(PROC$TBL), SIZEV(FORM$TBL), SIZEV(LCP6$TBL),
     1677    15013    2      SIZEV(COMM$TBL));
     1678    15014    2   DCL NOD BIT(1) BASED ALIGNED;
     1679    15015    3      DO WHILE '1'B;
     1680    15016    3           CALL XUR$GETCMD(NOD$(TABLE_TYPE)->NOD,PCB.OUT$,BLD_MOD_PROMPT)
     1681    15017    3             ALTRET (END_UPDATE);
     1682    15018    4           IF RPT$BLK.CODE=END_CODE THEN DO;
     1683    15019    4   END_UPDATE:  ;
     1684    15020    4                B$RATE_WRITE_FPT.BUF_.BOUND = VBND(TABLE_TYPE);
     1685    15021    4                CALL M$WRITE(B$RATE_WRITE_FPT)
     1686    15022    5                WHENALTRETURN DO;
     1687    15023    5                     CALL ERR_PROC(MONERR);
     1688    15024    5                     UNWIND TO ERROR_EXIT;
     1689    15025    5                     END;
     1690    15026    4                ERR_CODE.CODE = 0;
     1691    15027    4                RETURN;
     1692    15028
     1693    15029    4                END;
     1694    15030    4           ELSE DO CASE (TABLE_TYPE);
     1695    15031    4            CASE(SCHED_CODE,PROC_CODE);
     1696    15032    4              CALL UPDATE_SCHED_TBL;
     1697    15033    4            CASE(RATE_CODE, LCP6_CODE);
     1698    15034    4              CALL UPDATE_RATE_TBL;
     1699    15035    4            CASE(FORM_CODE);
     1700    15036    4              CALL UPDATE_FORM_TBL;
     1701    15037    4            CASE(COMM_CODE);
     1702    15038    4              CALL UPDATE_COMM_TBL;
     1703    15039    4              END;                         /*END CASE*/
     1704    15040    3           END;
     1705    15041    2   END UPDATE_TBL;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:68   
     1706    15042        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:69   
     1707    15043    1   ZERO_TBL: PROC(TBL_TYPE);
     1708    15044    2   DCL TBL_TYPE  SBIN WORD;
     1709    15045    2   DCL I SBIN WORD;
     1710    15046    2   DCL J SBIN WORD;
     1711    15047    2   DCL REC_BUF$ PTR;
     1712    15048    2      REC_BUF$ = ADDR(REC_BUF);
     1713    15049    2      REC_BUF = ' ';
     1714    15050    3      DO CASE(TBL_TYPE);
     1715    15051    3       CASE(FORM_CODE);
     1716    15052    4         DO I = 0 TO 3;
     1717    15053    4              REC_BUF$->PACKED$NUM$ARY(I) = '3'O;
     1718    15054    4              END;
     1719    15055
     1720    15056    3       CASE(RATE_CODE,LCP6_CODE);
     1721    15057    3         REC_BUF$->RATE$TBL.PERCENT# = %NO#;
     1722    15058    4         DO I = 0 TO 3;
     1723    15059    4              REC_BUF$->RATE$TBL.JUNIT.RATE#(I) = '3'O;
     1724    15060    4              REC_BUF$->RATE$TBL.SUNIT.RATE#(I) = '3'O;
     1725    15061    4              END;
     1726    15062    3         IF TBL_TYPE = RATE_CODE
     1727    15063    4         THEN DO;
     1728    15064    4              REC_BUF$->RATE$TBL.LCP6# = '0'B;
     1729    15065    4              END;
     1730    15066
     1731    15067    4         ELSE DO;
     1732    15068    4              REC_BUF$->RATE$TBL.LCP6# = '1'B;
     1733    15069    4              END;
     1734    15070
     1735    15071    4         DO I=0 TO 24;
     1736    15072    4              ADDR(REC_BUF$->RATE$TBL.CMULT#)->PACKED$NUM$ARY(I) = '3'O;
     1737    15073    4              END;
     1738    15074
     1739    15075    3       CASE(SCHED_CODE,PROC_CODE);
     1740    15076    3         REC_BUF$->PROC$TBL.RTABLE# = '0';
     1741    15077
     1742    15078    3       CASE(COMM_CODE);
     1743    15079
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:70   
     1744    15080    3         END;                              /* END CASE                           */
     1745    15081    2      RETURN;
     1746    15082    2   END ZERO_TBL;
     1747    15083    1   END ARA$RATES;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:71   
--  Include file information  --

   B_MACROS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AR_TBLS_C.:E05TOU  is referenced.
   AR_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ARA$RATES.

   Procedure ARA$RATES requires 2872 words for executable code.
   Procedure ARA$RATES requires 1794 words of local(AUTO) storage.

    No errors detected in file ARA$RATES.:E05TSI    .

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:72   

 Object Unit name= ARA$RATES                                  File name= ARA$RATES.:E05TOU
 UTS= JUL 29 '97 08:28:24.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   386    602  ARA$RATES
    2  RoData even  UTS    202    312  ARA$RATES
    3   DCB   even  none     0      0  B$RATE_DCB
    4   DCB   even  none     0      0  M$SI
    5   DCB   even  none     0      0  M$LO
    6   Proc  even  none  2872   5470  ARA$RATES
    7  RoData even  none    87    127  ARA$RATES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Main       0  ARA$RATES

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     70  LO_OUT_BUF                         1    350  REC_BUF
    1    554  TEST_MODE
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:73   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XTX$ADAPT
 yes     yes           Std       6 XUR$GETCMD
         yes           Std       3 CONVPK
 yes     yes           Std       7 XUR$ERRMSG
 yes     yes           Std       3 XUR$INIT
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET
                       nStd      0 X66_MAUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$RATE_DCB                            M$SI
     M$LO                                  B$TCB$                                B$JIT$
     TOP_CMD_ROOT                          RATE_CMD_ROOT                         LCP6_CMD_ROOT
     COMM_CMD_ROOT                         FORM_CMD_ROOT                         SCHED_CMD_ROOT
     INIT_RATE_TBL                         INIT_FORM_TBL                         INIT_LCP6_TBL
     INIT_COMM_TBL                         INIT_SCHED_TBL                        INIT_PROC_TBL
     B_VERSION                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:74   


        1        1        /*M* ARA$RATES  Service processor to maintain B$RATE rate tables file.        */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8        /* Next available error code = 45   */
        9        9        /*P* NAME: RATES
       10       10             PURPOSE: To maintain B$RATE rate tables file.
       11       11             DESCRIPTION: The RATES processor is used to maintain the B$RATE rate
       12       12                tables file. The file contains all rate tables used in system
       13       13                accounting procedures. The user is allowed to interactively
       14       14                BUILD, MODIFY, LIST, and DELETE  the tables contained in B$RATE.
       15       15            REFERENCE: Specification file section 17.3 document 158.                  */
       16       16        /*D* NAME: RATES
       17       17             CALL: RATES is initiated from IBEX by: !RATES
       18       18             ENVIRONMENT: User program.
       19       19             INPUT: RATES inputs user commands and B$RATE table records.
       20       20             OUTPUT: RATES outputs responses to user input and B$RATE table records.
       21       21                There are six table types:
       22       22                    1) RATE tables - used to store general rate information.
       23       23                    2) FORM tables - used to store rates for mounting and unit cost of
       24       24                       individual form types.
       25       25                    3) SCHEDULE tables - used to store a pointer to an associated RATE
       26       26                       table.
       27       27                    4) PROCESSOR tables - used to store a pointer to an associated
       28       28                       RATE table.
       29       29                    5) LCP6 tables - used to store rates for LCP-6 usage.
       30       30                    6) COMM tables - used to store rates for communications usage.
       31       31                The allowable commands are:
       32       32                    1) BUILD - builds a given table optionally from a specified model.
       33       33                    2) MODIFY - modifies a specified table.
       34       34                    3) DELETE - deletes a given table or set of tables.
       35       35                    4) LIST - lists contents of a given table of set of tables.
       36       36                    5) HELP - displays various help messages designed to aid the user
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:75   
       37       37                        in use of RATES.
       38       38                    6) ? - elaborates on last error message displayed.
       39       39                BUILD and MODIFY contain second level commands which allow setting or
       40       40                changing of individual fields in the current table.                   */
       41       41        ARA$RATES: PROC MAIN;                   /* RATES PROCESSOR DRIVER PROC        */

     41  6 000000   000000 700200 xent  ARA$RATES    TSX0  ! X66_MAUTO
         6 000001   003402 000000                    ZERO    1794,0

       42       42        %INCLUDE CP_6;
       43     5601        %INCLUDE XU_MACRO_C;
       44     8707        %INCLUDE XUR_ENTRY;
       45     8739        %INCLUDE F$DCB;
       46     8788        %INCLUDE XU_PERR_C;
       47     8979        %INCLUDE XU_SUBS_C;
       48     9071        %INCLUDE B_ERRORS_C;
       49    10198        %INCLUDE CP_6_SUBS;
       50    10738        %INCLUDE AR_SUBS_C;
       51    10828        %INCLUDE AR_TBLS_C;
       52    11233        %INCLUDE B$JIT;
       53    11836        %INCLUDE B_MACROS_C;
       54    11947        %B$FORM_TBL(FPTN=FORM$TBL,STCLASS=BASED);
       55    11968        %B$PROC_TBL(FPTN=PROC$TBL,STCLASS=BASED);
       56    11995        %B$SCHED_TBL(FPTN=SCHED$TBL,STCLASS=BASED);
       57    12022        %B$RATE_TBL(FPTN=RATE$TBL,STCLASS=BASED);
       58    12137        %B$LCP6_TBL(FPTN=LCP6$TBL,STCLASS=BASED);
       59    12298        %B$COMM_TBL(FPTN=COMM$TBL,STCLASS=BASED);
       60    12314        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:76   
       61    12315    1   DCL 1 PCB,
       62    12316    1         2 OUT$ PTR;
       63    12317        %XUR_INIT (GOODCMD=YES);
       64    12416        %PARSE$OUT(NAME=RPT$BLK,NSUBLKS=NUM_SUB_BLKS,SUBLK$=SUB_BLK$,
       65    12417                   STCLASS="BASED(PCB.OUT$)");
       66    12462        %PARSE$SYM(NAME=P$S,STCLASS=BASED);
       67    12500        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:77   
       68    12501    1   DCL FIELD1_ VECTOR STATIC DALIGNED INIT(VECTOR(NIL));
       69    12502    1   DCL 1 ERR_CODE STATIC,
       70    12503    1         2 FCG_MID UBIN(18) INIT(5249) UNAL,
       71    12504    1         2 CODE UBIN(15) INIT(0) UNAL,
       72    12505    1         2 SEV UBIN(3) INIT(0) UNAL;
       73    12506        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:78   
       74    12507
       75    12508        %FPT_WRITE(FPTN = FPT_WRITE_LO,
       76    12509                   BUF  = LO_OUT_BUF,
       77    12510                   DCB  = M$LO);
       78    12541    1   DCL LO_OUT_BUF CHAR(132) STATIC SYMDEF;
       79    12542        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:79   
       80    12543        %FPT_OPEN(FPTN     = B$RATE_OPEN_FPT,
       81    12544                  NAME     = B$RATE_VLP,
       82    12545                  ACCT     = ACCT_RATES,
       83    12546                  DCB      = B$RATE_DCB,
       84    12547                  ACSVEH   = B$RATE_ACSVEH,
       85    12548                  ORG      = KEYED,
       86    12549                  ACS      = DIRECT,
       87    12550                  FUN      = CREATE,
       88    12551                  SHARE   = IN,
       89    12552                  CTG      = YES,
       90    12553                  EXIST    = OLDFILE,
       91    12554                  SCRUB    = YES,
       92    12555                  REASSIGN = NO,
       93    12556                  ASN      = FILE,
       94    12557                  DISP     = NAMED);
       95    12666        %VLP_NAME(FPTN = RATES_NAME,
       96    12667                  LEN = 31,
       97    12668                  NAME = 'RATES',
       98    12669                  STCLASS = CONSTANT);
       99    12696
      100    12697        %VLP_NAME(FPTN  = B$RATE_VLP,
      101    12698                  NAME  = ':RATES');
      102    12725
      103    12726        %VLP_ACCT(FPTN = ACCT_RATES,
      104    12727                  ACCT = ':SYS');
      105    12740        %VLP_ATTR(FPTN = B$RATE_ACSVEH,STCLASS = CONSTANT);
      106    12754        %VLP_ACSVEH(VEHICLE='IBEX',READ = YES,LAST=",");
      107    12771        %VLP_ACSVEH(VEHICLE='TPCP',READ = YES,LAST=";");
      108    12788        %FPT_PRECORD(FPTN = FPT_PRECORD,
      109    12789                     KEY  = IN_KEY,
      110    12790                     DCB  = B$RATE_DCB,
      111    12791                     KEYS = YES);
      112    12812        %FPT_READ(FPTN = B$RATE_READ_FPT,
      113    12813                  BUF  = REC_BUF,
      114    12814                  DCB  = B$RATE_DCB,
      115    12815                  WAIT = YES,
      116    12816                  KEYS = YES,
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:80   
      117    12817                  KEYR = YES);
      118    12856
      119    12857        %FPT_WRITE(FPTN = B$RATE_WRITE_FPT,
      120    12858                   BUF  = REC_BUF,
      121    12859                   KEY  = OUT_KEY,
      122    12860                   DCB  = B$RATE_DCB);
      123    12891
      124    12892        %FPT_DELREC(FPTN = B$RATE_DELREC_FPT,
      125    12893                    DCB  = B$RATE_DCB,
      126    12894                    KEY  = FIRST_DEL_KEY);
      127    12913        %FPT_PROMPT(FPTN = FPT_PROMPT,DCB=M$UC);
      128    12941        %FPT_EXIT (FPTN=ERROR, STEPCC=4);
      129    12956    1   DCL 1 FIRST_DEL_KEY STATIC,
      130    12957    1         2 LEN UBIN BYTE UNAL,
      131    12958    1         2 KEY CHAR(35);
      132    12959    1   DCL 1 LAST_DEL_KEY STATIC,
      133    12960    1         2 LEN UBIN BYTE UNAL,
      134    12961    1         2 KEY CHAR(35);
      135    12962
      136    12963    1   DCL REC_BUF CHAR(450) STATIC SYMDEF;
      137    12964    1   DCL REC_BUFB(0:449) REDEF REC_BUF CHAR(1);
      138    12965    1   DCL REC_BUF$ PTR CONSTANT INIT(ADDR(REC_BUF));
      139    12966    1   DCL PACKED$NUM$ARY(0:0) ALIGNED BIT (72) BASED;
      140    12967    1   DCL B$RATE_DCB DCB;
      141    12968    1   DCL M$SI DCB;
      142    12969    1   DCL M$SI$ PTR;
      143    12970    1   DCL M$LO DCB;
      144    12971        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:81   
      145    12972    1   DCL 1 DEFAULT_KEY_QUAL_TEXTC STATIC,
      146    12973    1         2 LEN UBIN BYTE INIT(1) UNAL,     /* USED FOR FORMING DEFAULT KEYS      */
      147    12974    1         2 STRING CHAR(1) INIT('0');
      148    12975    1   DCL 1 IN_KEY STATIC,                    /* KEY OF INPUT RECORD                */
      149    12976    1         2 LEN UBIN BYTE UNAL,
      150    12977    1         2 STRING CHAR(35);
      151    12978    1   DCL 1 OUT_KEY STATIC,                   /* KEY OF OUTPUT RECORD               */
      152    12979    1         2 LEN UBIN BYTE UNAL,
      153    12980    1         2 STRING CHAR(35);
      154    12981    1   DCL 1 TEXT$C BASED,
      155    12982    1         2 LEN UBIN BYTE UNAL,
      156    12983    1         2 STRING CHAR(TEXT$C.LEN);
      157    12984
      158    12985    1   DCL ZERO_STRING CHAR(13) CONSTANT INIT('0000000000000');
      159    12986    1   DCL BLANK_STRING CHAR(10) CONSTANT INIT('          ');
      160    12987    1   DCL 1 RATES_PROMPT CONSTANT,
      161    12988    1         2 LEN UBIN BYTE UNAL INIT(1),
      162    12989    1         2 STRING CHAR(1) INIT('-');
      163    12990    1   DCL 1 BLD_MOD_PROMPT CONSTANT,
      164    12991    1         2 LEN UBIN BYTE UNAL INIT(2),
      165    12992    1         2 STRING CHAR(2) INIT('--');
      166    12993    1   DCL ERROR_EXIT REMEMBER;
      167    12994        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:82   
      168    12995        /* EXTERNAL REFERENCES                                                        */
      169    12996    1   DCL B$TCB$ PTR SYMREF;
      170    12997    1   DCL B$JIT$ PTR SYMREF;
      171    12998        %B$TCB;
      172    13001        %B$ALT;
      173    13009    1   DCL TEST_MODE SBIN WORD STATIC SYMDEF;
      174    13010    1   DCL TOP_CMD_ROOT BIT(1) SYMREF;
      175    13011    1   DCL RATE_CMD_ROOT BIT(1) SYMREF;
      176    13012    1   DCL LCP6_CMD_ROOT BIT(1) SYMREF;
      177    13013    1   DCL COMM_CMD_ROOT BIT(1) SYMREF;
      178    13014    1   DCL FORM_CMD_ROOT BIT(1) SYMREF;
      179    13015    1   DCL SCHED_CMD_ROOT BIT(1) SYMREF;
      180    13016        %B$RATE_TBL(FPTN = INIT_RATE_TBL,STCLASS = SYMREF);
      181    13131        %B$FORM_TBL(FPTN = INIT_FORM_TBL,STCLASS = SYMREF);
      182    13152        %B$LCP6_TBL(FPTN = INIT_LCP6_TBL,STCLASS = SYMREF);
      183    13313        %B$COMM_TBL(FPTN = INIT_COMM_TBL,STCLASS = SYMREF);
      184    13329        %B$SCHED_TBL(FPTN = INIT_SCHED_TBL,STCLASS = SYMREF);
      185    13356        %B$PROC_TBL(FPTN = INIT_PROC_TBL,STCLASS = SYMREF);
      186    13383    1   DCL CONVPK ENTRY(3);
      187    13384        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:83   
      188    13385        /* DRIVER BEGINS HERE                                                         */
      189    13386    1      REMEMBER ERR_EXIT IN ERROR_EXIT;

  13386  6 000002   000056 635000 6                  EAA     ERR_EXIT
         6 000003   200006 452500                    STP2    ERROR_EXIT,,AUTO
         6 000004   200007 755100                    STA     ERROR_EXIT+1,,AUTO

      190    13387    1      CALL INITIALIZE;

  13387  6 000005   002226 701000 6                  TSX1    INITIALIZE
         6 000006   000000 011000                    NOP     0

      191    13388    2      DO WHILE (1=1);                      /* DO FOREVER                         */

      192    13389    2           CALL XUR$GETCMD (TOP_CMD_ROOT,PCB.OUT$,RATES_PROMPT) ALTRET(GO_CLEANUP);

  13389  6 000007   000000 236000 7                  LDQ     0
         6 000010   203376 756100                    STQ     TEMP_ERR+4,,AUTO
         6 000011   200003 630500                    EPPR0   PCB,,AUTO
         6 000012   203375 450500                    STP0    TEMP_ERR+3,,AUTO
         6 000013   000001 236000 7                  LDQ     1
         6 000014   203374 756100                    STQ     TEMP_ERR+2,,AUTO
         6 000015   203374 630500                    EPPR0   TEMP_ERR+2,,AUTO
         6 000016   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000017   000000 701000 xent               TSX1    XUR$GETCMD
         6 000020   000052 702000 6                  TSX2    GO_CLEANUP

      193    13390                                                /* ALTRET                             */
      194    13391    3           DO CASE (RPT$BLK.CODE);

  13391  6 000021   200003 470500                    LDP0    PCB,,AUTO
         6 000022   000000 720100                    LXL0    0,,PR0
         6 000023   000010 100003                    CMPX0   8,DU
         6 000024   000026 602010 6                  TNC     s:13391+5,X0
         6 000025   000055 710000 6                  TRA     s:13405
         6 000026   000055 710000 6                  TRA     s:13405
         6 000027   000055 710000 6                  TRA     s:13405
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:84   
         6 000030   000055 710000 6                  TRA     s:13405
         6 000031   000052 710000 6                  TRA     GO_CLEANUP
         6 000032   000047 710000 6                  TRA     s:13399
         6 000033   000044 710000 6                  TRA     s:13397
         6 000034   000036 710000 6                  TRA     s:13393
         6 000035   000041 710000 6                  TRA     s:13395

      195    13392    3            CASE (BLD_CODE);

      196    13393    3              CALL BUILD;

  13393  6 000036   000062 701000 6                  TSX1    BUILD
         6 000037   000000 011000                    NOP     0
         6 000040   000055 710000 6                  TRA     s:13405

      197    13394    3            CASE (MOD_CODE);

      198    13395    3              CALL MODIFY;

  13395  6 000041   003611 701000 6                  TSX1    MODIFY
         6 000042   000000 011000                    NOP     0
         6 000043   000055 710000 6                  TRA     s:13405

      199    13396    3            CASE (LIST_CODE);

      200    13397    3              CALL LIST_;

  13397  6 000044   002364 701000 6                  TSX1    LIST_
         6 000045   000000 011000                    NOP     0
         6 000046   000055 710000 6                  TRA     s:13405

      201    13398    3            CASE (DEL_CODE);

      202    13399    3              CALL DELETE;

  13399  6 000047   001442 701000 6                  TSX1    DELETE
         6 000050   000000 011000                    NOP     0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:85   
         6 000051   000055 710000 6                  TRA     s:13405

      203    13400    3            CASE (END_CODE);

  13393  6 000052                       GO_CLEANUP   null
      204    13401    3   GO_CLEANUP:;
      205    13402    3              CALL CLEAN_UP;               /* CATCHES OTHER ERRORS               */

  13402  6 000052   000462 701000 6                  TSX1    CLEAN_UP
         6 000053   000000 011000                    NOP     0

      206    13403    3              RETURN;

  13403  6 000054   000000 702200 xent               TSX2  ! X66_MARET

      207    13404    3              END;                         /*END CASE*/

      208    13405    2           END;

  13405  6 000055   000007 710000 6                  TRA     s:13389

      209    13406    1   ERR_EXIT: CALL M$EXIT (ERROR);

  13406  6 000056   000320 630400 1     ERR_EXIT     EPPR0   ERROR
         6 000057   000001 713400                    CLIMB   exit
         6 000060   400400 401760                    pmme    nvectors=2
         6 000061   005467 710000 6                  TRA     s:15083

      210    13407        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:86   
      211    13408    1   BUILD: PROC;                            /* PROCEDURE TO BUILD NEW TABLE       */

  13408  6 000062   200010 741300       BUILD        STX1  ! ERROR_EXIT+2,,AUTO

      212    13409    2   DCL RET_VAL SBIN WORD;
      213    13410    2   DCL KEY_QUAL_TEXTC$ PTR;
      214    13411    2   DCL CUR_NODE$ PTR;
      215    13412    2   DCL KEY_TYPE_CODE SBIN WORD;
      216    13413    2   DCL FROM_QUAL_TYPE_CODE SBIN WORD;
      217    13414    2   DCL PERCENT BIT(1) ALIGNED;
      218    13415    2   DCL FROM_KEY_QUAL_TEXTC$ PTR;
      219    13416    2      KEY_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;

  13416  6 000063   200003 470500                    LDP0    PCB,,AUTO
         6 000064   000003 471500                    LDP1    3,,PR0
         6 000065   100000 236100                    LDQ     0,,PR1
         6 000066   777777 376007                    ANQ     -1,DL
         6 000067   200014 756100                    STQ     KEY_TYPE_CODE,,AUTO

      220    13417    2      CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);

  13417  6 000070   000003 471500                    LDP1    3,,PR0
         6 000071   100003 236100                    LDQ     3,,PR1
         6 000072   200013 756100                    STQ     CUR_NODE$,,AUTO

      221    13418                                                /* CUR_NODE$ NOW POINTS TO KEY        */
      222    13419                                                /* QUALIFYING NODE                    */
      223    13420    2      IF CUR_NODE$->RPT$BLK.CODE = DEFAULT

  13420  6 000073   200013 473500                    LDP3    CUR_NODE$,,AUTO
         6 000074   300000 720100                    LXL0    0,,PR3
         6 000075   000016 100003                    CMPX0   14,DU
         6 000076   000102 601000 6                  TNZ     s:13422

      224    13421    2      THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);

  13421  6 000077   000002 236000 7                  LDQ     2
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:87   
         6 000100   200012 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO
         6 000101   000104 710000 6                  TRA     s:13424

      225    13422    2      ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);

  13422  6 000102   300003 236100                    LDQ     3,,PR3
         6 000103   200012 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO

      226    13423
      227    13424    2      CALL FORM_KEY(RET_VAL,

  13424  6 000104   200012 631500                    EPPR1   KEY_QUAL_TEXTC$,,AUTO
         6 000105   203352 451500                    STP1    @KEY_TEXTC+1,,AUTO
         6 000106   000003 236000 7                  LDQ     3
         6 000107   203351 756100                    STQ     @KEYED_OR_NOT+1,,AUTO
         6 000110   200014 634500                    EPPR4   KEY_TYPE_CODE,,AUTO
         6 000111   203350 454500                    STP4    @RET_VAL+1,,AUTO
         6 000112   200011 635500                    EPPR5   RET_VAL,,AUTO
         6 000113   203347 455500                    STP5    EXIT_LOOP+2,,AUTO
         6 000114   001716 701000 6                  TSX1    FORM_KEY
         6 000115   000000 011000                    NOP     0

      228    13425    2        KEY_TYPE_CODE,
      229    13426    2        OUT_KEY,
      230    13427    2        KEY_QUAL_TEXTC$);
      231    13428    2      IF RET_VAL = NORM_RET

  13428  6 000116   200011 235100                    LDA     RET_VAL,,AUTO
         6 000117   000001 115007                    CMPA    1,DL
         6 000120   000163 601000 6                  TNZ     s:13446

      232    13429    3      THEN DO;

      233    13430    3           CALL READ_B$RATE(RET_VAL,%YES#,OUT_KEY);

  13430  6 000121   000004 237000 7                  LDAQ    4
         6 000122   203350 757100                    STAQ    @RET_VAL+1,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:88   
         6 000123   200011 630500                    EPPR0   RET_VAL,,AUTO
         6 000124   203347 450500                    STP0    EXIT_LOOP+2,,AUTO
         6 000125   004404 701000 6                  TSX1    READ_B$RATE
         6 000126   000000 011000                    NOP     0

      234    13431    3           IF RET_VAL = NORM_RET

  13431  6 000127   200011 235100                    LDA     RET_VAL,,AUTO
         6 000130   000001 115007                    CMPA    1,DL
         6 000131   000143 601000 6                  TNZ     s:13440

      235    13432    4           THEN DO;

      236    13433    4                CALL ERR_PROC(2);

  13433  6 000132   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000133   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000134   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000135   000006 236000 7                  LDQ     6
         6 000136   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000137   001655 701000 6                  TSX1    ERR_PROC
         6 000140   000000 011000                    NOP     0

      237    13434    4                RETURN;

  13434  6 000141   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 000142   000001 702211                    TSX2  ! 1,X1

      238    13435    4                END;
      239    13436        /*E* ERROR:   ARA-00002
      240    13437             MESSAGE: Table already exists.
      241    13438        */
      242    13439
      243    13440    3           ELSE IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY

  13440  6 000143   000000 470400 xsym               LDP0    B$TCB$
         6 000144   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:89   
         6 000145   100102 236100                    LDQ     66,,PR1
         6 000146   377770 376007                    ANQ     131064,DL
         6 000147   001020 116007                    CMPQ    528,DL
         6 000150   000165 600000 6                  TZE     s:13449

      244    13441    4                THEN DO;

      245    13442    4                     CALL ERR_PROC(MONERR);

  13442  6 000151   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000152   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000153   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000154   000007 236000 7                  LDQ     7
         6 000155   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000156   001655 701000 6                  TSX1    ERR_PROC
         6 000157   000000 011000                    NOP     0

      246    13443    4                     UNWIND TO ERROR_EXIT;

  13443  6 000160   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 000161   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 000162   000000 000200                    ZERO    0,128

      247    13444    4                     END;
      248    13445    3           END;
      249    13446    2      ELSE RETURN;

  13446  6 000163   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 000164   000001 702211                    TSX2  ! 1,X1

      250    13447
      251    13448
      252    13449    2      IF RPT$BLK.SUB_BLK$(0)->RPT$BLK.NUM_SUB_BLKS=2

  13449  6 000165   200003 473500                    LDP3    PCB,,AUTO
         6 000166   300003 474500                    LDP4    3,,PR3
         6 000167   400001 220100                    LDX0    1,,PR4
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:90   
         6 000170   000002 100003                    CMPX0   2,DU
         6 000171   000175 601000 6                  TNZ     s:13451

      253    13450    2      THEN PERCENT = %YES#;

  13450  6 000172   400000 236003                    LDQ     -131072,DU
         6 000173   200016 756100                    STQ     PERCENT,,AUTO
         6 000174   000176 710000 6                  TRA     s:13455

      254    13451    2      ELSE PERCENT = %NO#;

  13451  6 000175   200016 450100                    STZ     PERCENT,,AUTO

      255    13452
      256    13453        /*   See if 'FROM' table was specified.
      257    13454        */
      258    13455    2      IF RPT$BLK.NUM_SUB_BLKS = 2

  13455  6 000176   300001 221100                    LDX1    1,,PR3
         6 000177   000002 101003                    CMPX1   2,DU
         6 000200   000335 601000 6                  TNZ     s:13509

      259    13456    3      THEN DO;

      260    13457    3           FROM_QUAL_TYPE_CODE = RPT$BLK.SUB_BLK$(1)->RPT$BLK.CODE;

  13457  6 000201   300004 475500                    LDP5    4,,PR3
         6 000202   500000 236100                    LDQ     0,,PR5
         6 000203   777777 376007                    ANQ     -1,DL
         6 000204   200015 756100                    STQ     FROM_QUAL_TYPE_CODE,,AUTO

      261    13458    3           IF FROM_QUAL_TYPE_CODE = SCRATCH

  13458  6 000205   000017 116007                    CMPQ    15,DL
         6 000206   000214 601000 6                  TNZ     s:13462

      262    13459    3           THEN CALL ZERO_TBL(KEY_TYPE_CODE);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:91   

  13459  6 000207   200014 636500                    EPPR6   KEY_TYPE_CODE,,AUTO
         6 000210   200021 456500                    STP6    RET_VAL+1,,AUTO
         6 000211   005343 701000 6                  TSX1    ZERO_TBL
         6 000212   000000 011000                    NOP     0
         6 000213   000341 710000 6                  TRA     s:13513

      263    13460
      264    13461    4           ELSE DO;

      265    13462    4                IF FROM_QUAL_TYPE_CODE = DEFAULT

  13462  6 000214   000016 116007                    CMPQ    14,DL
         6 000215   000221 601000 6                  TNZ     s:13464

      266    13463    4                THEN FROM_KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);

  13463  6 000216   000002 236000 7                  LDQ     2
         6 000217   200017 756100                    STQ     FROM_KEY_QUAL_TEXTC$,,AUTO
         6 000220   000223 710000 6                  TRA     s:13466

      267    13464    4                ELSE FROM_KEY_QUAL_TEXTC$ =

  13464  6 000221   500003 236100                    LDQ     3,,PR5
         6 000222   200017 756100                    STQ     FROM_KEY_QUAL_TEXTC$,,AUTO

      268    13465    4                       RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);
      269    13466    4                CALL FORM_KEY(RET_VAL,

  13466  6 000223   200017 631500                    EPPR1   FROM_KEY_QUAL_TEXTC$,,AUTO
         6 000224   203352 451500                    STP1    @KEY_TEXTC+1,,AUTO
         6 000225   000010 236000 7                  LDQ     8
         6 000226   203351 756100                    STQ     @KEYED_OR_NOT+1,,AUTO
         6 000227   200014 634500                    EPPR4   KEY_TYPE_CODE,,AUTO
         6 000230   203350 454500                    STP4    @RET_VAL+1,,AUTO
         6 000231   200011 635500                    EPPR5   RET_VAL,,AUTO
         6 000232   203347 455500                    STP5    EXIT_LOOP+2,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:92   
         6 000233   001716 701000 6                  TSX1    FORM_KEY
         6 000234   000000 011000                    NOP     0

      270    13467    4                  KEY_TYPE_CODE,
      271    13468    4                  IN_KEY,
      272    13469    4                  FROM_KEY_QUAL_TEXTC$);
      273    13470    4                IF RET_VAL = NORM_RET

  13470  6 000235   200011 235100                    LDA     RET_VAL,,AUTO
         6 000236   000001 115007                    CMPA    1,DL
         6 000237   000333 601000 6                  TNZ     s:13503

      274    13471    5                THEN DO;                   /* IF KEY IS FORMED SUCCESSFULLY      */

      275    13472    5                     CALL READ_B$RATE(RET_VAL,%YES#,IN_KEY);

  13472  6 000240   000012 237000 7                  LDAQ    10
         6 000241   203350 757100                    STAQ    @RET_VAL+1,,AUTO
         6 000242   200011 630500                    EPPR0   RET_VAL,,AUTO
         6 000243   203347 450500                    STP0    EXIT_LOOP+2,,AUTO
         6 000244   004404 701000 6                  TSX1    READ_B$RATE
         6 000245   000000 011000                    NOP     0

      276    13473    5                     IF RET_VAL = ALT_RET

  13473  6 000246   200011 235100                    LDA     RET_VAL,,AUTO
         6 000247   000301 601000 6                  TNZ     s:13489

      277    13474    5                     THEN
      278    13475    5                          IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

  13475  6 000250   000000 470400 xsym               LDP0    B$TCB$
         6 000251   000000 471500                    LDP1    0,,PR0
         6 000252   100102 236100                    LDQ     66,,PR1
         6 000253   377770 376007                    ANQ     131064,DL
         6 000254   001020 116007                    CMPQ    528,DL
         6 000255   000267 601000 6                  TNZ     s:13484
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:93   

      279    13476    6                          THEN DO;

      280    13477    6                               CALL ERR_PROC(5);

  13477  6 000256   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000257   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000260   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000261   000014 236000 7                  LDQ     12
         6 000262   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000263   001655 701000 6                  TSX1    ERR_PROC
         6 000264   000000 011000                    NOP     0

      281    13478    6                               RETURN;

  13478  6 000265   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 000266   000001 702211                    TSX2  ! 1,X1

      282    13479    6                               END;
      283    13480        /*E* ERROR:   ARA-00005
      284    13481             MESSAGE: "From" table does not exist.
      285    13482        */
      286    13483    6                          ELSE DO;

      287    13484    6                               CALL ERR_PROC(MONERR);

  13484  6 000267   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000270   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000271   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000272   000007 236000 7                  LDQ     7
         6 000273   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000274   001655 701000 6                  TSX1    ERR_PROC
         6 000275   000000 011000                    NOP     0

      288    13485                                                /* ERROR ON READ OTHER THAN           */
      289    13486                                                /* 'RECORD NOT FOUND'                 */
      290    13487    6                               UNWIND TO ERROR_EXIT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:94   

  13487  6 000276   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 000277   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 000300   000000 000200                    ZERO    0,128

      291    13488    6                               END;
      292    13489    5                     IF KEY_TYPE_CODE=RATE_CODE AND PERCENT~=REC_BUF$->RATE$TBL.
             13489                              PERCENT#

  13489  6 000301   200014 236100                    LDQ     KEY_TYPE_CODE,,AUTO
         6 000302   000002 116007                    CMPQ    2,DL
         6 000303   000341 601000 6                  TNZ     s:13513
         6 000304   000015 470400 2                  LDP0    REC_BUF$
         6 000305   200016 236100                    LDQ     PERCENT,,AUTO
         6 000306   000000 676100                    ERQ     0,,PR0
         6 000307   400000 376003                    ANQ     -131072,DU
         6 000310   000341 600000 6                  TZE     s:13513

      293    13490    5                     THEN
      294    13491    5                          IF PERCENT

  13491  6 000311   200016 234100                    SZN     PERCENT,,AUTO
         6 000312   000323 605000 6                  TPL     s:13498

      295    13492    5                          THEN
      296    13493    5                               CALL ERR_PROC(42);

  13493  6 000313   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000314   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000315   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000316   000016 236000 7                  LDQ     14
         6 000317   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000320   001655 701000 6                  TSX1    ERR_PROC
         6 000321   000000 011000                    NOP     0
         6 000322   000341 710000 6                  TRA     s:13513

      297    13494        /*E* ERROR:   ARA-00042
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:95   
      298    13495             MESSAGE: *** Building PERCENT Rate table from non-PERCENT table ***
      299    13496        */
      300    13497    5                          ELSE
      301    13498    5                               CALL ERR_PROC(43);

  13498  6 000323   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000324   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000325   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000326   000020 236000 7                  LDQ     16
         6 000327   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000330   001655 701000 6                  TSX1    ERR_PROC
         6 000331   000000 011000                    NOP     0

      302    13499        /*E* ERROR:   ARA-00043
      303    13500             MESSAGE: *** Building non-PERCENT Rate table from PERCENT table ***
      304    13501        */
      305    13502    5                     END;

  13502  6 000332   000341 710000 6                  TRA     s:13513

      306    13503    4                ELSE RETURN;

  13503  6 000333   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 000334   000001 702211                    TSX2  ! 1,X1

      307    13504    4                END;
      308    13505    3           END;
      309    13506
      310    13507        /*   'FROM' not given, use the default base table.
      311    13508        */
      312    13509    2      ELSE CALL GET_INIT_TBL(KEY_TYPE_CODE);

  13509  6 000335   200014 635500                    EPPR5   KEY_TYPE_CODE,,AUTO
         6 000336   203347 455500                    STP5    EXIT_LOOP+2,,AUTO
         6 000337   002131 701000 6                  TSX1    GET_INIT_TBL
         6 000340   000000 011000                    NOP     0

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:96   
      313    13510
      314    13511        /*    Set 'PERCENT' if appropriate.
      315    13512        */
      316    13513    2      IF (KEY_TYPE_CODE=RATE_CODE) OR (KEY_TYPE_CODE=LCP6_CODE)

  13513  6 000341   200014 235100                    LDA     KEY_TYPE_CODE,,AUTO
         6 000342   000002 115007                    CMPA    2,DL
         6 000343   000346 600000 6                  TZE     s:13514
         6 000344   000005 115007                    CMPA    5,DL
         6 000345   000353 601000 6                  TNZ     s:13516

      317    13514    2      THEN REC_BUF$->RATE$TBL.PERCENT# = PERCENT;

  13514  6 000346   000015 470400 2                  LDP0    REC_BUF$
         6 000347   200016 236100                    LDQ     PERCENT,,AUTO
         6 000350   000000 676100                    ERQ     0,,PR0
         6 000351   400000 376003                    ANQ     -131072,DU
         6 000352   000000 656100                    ERSQ    0,,PR0

      318    13515
      319    13516    2      CALL UPDATE_TBL(KEY_TYPE_CODE);

  13516  6 000353   200014 630500                    EPPR0   KEY_TYPE_CODE,,AUTO
         6 000354   200021 450500                    STP0    RET_VAL+1,,AUTO
         6 000355   005240 701000 6                  TSX1    UPDATE_TBL
         6 000356   000000 011000                    NOP     0

      320    13517    2      RETURN;

  13517  6 000357   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 000360   000001 702211                    TSX2  ! 1,X1

      321    13518    2   END BUILD;
      322    13519        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:97   
      323    13520        /*   CHECK_DEFAULTS reads the default record for each of the six
      324    13521             record types.  If the default record does not exist, it is
      325    13522             built.
      326    13523        */
      327    13524    1   CHECK_DEFAULTS: PROC;

  13524  6 000361   203342 741300       CHECK_DEFAU* STX1  ! SIGN_CHAR+1704,,AUTO

      328    13525    2   DCL REC_TYPE SBIN WORD;
      329    13526    2   DCL RET_VAL SBIN WORD;
      330    13527    2   DCL DEFAULT_KEY_QUAL_TEXTC$ PTR;
      331    13528    2      DEFAULT_KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);

  13528  6 000362   000002 236000 7                  LDQ     2
         6 000363   203345 756100                    STQ     DEFAULT_KEY_QUAL_TEXTC$,,AUTO

      332    13529
      333    13530    3      DO REC_TYPE = SCHED_CODE TO COMM_CODE;

  13530  6 000364   000001 235007                    LDA     1,DL
         6 000365   203343 755100                    STA     REC_TYPE,,AUTO

      334    13531    3           CALL FORM_KEY(RET_VAL,

  13531  6 000366   203345 630500                    EPPR0   DEFAULT_KEY_QUAL_TEXTC$,,AUTO
         6 000367   203352 450500                    STP0    @KEY_TEXTC+1,,AUTO
         6 000370   000003 236000 7                  LDQ     3
         6 000371   203351 756100                    STQ     @KEYED_OR_NOT+1,,AUTO
         6 000372   203343 631500                    EPPR1   REC_TYPE,,AUTO
         6 000373   203350 451500                    STP1    @RET_VAL+1,,AUTO
         6 000374   203344 633500                    EPPR3   RET_VAL,,AUTO
         6 000375   203347 453500                    STP3    EXIT_LOOP+2,,AUTO
         6 000376   001716 701000 6                  TSX1    FORM_KEY
         6 000377   000000 011000                    NOP     0

      335    13532    3             REC_TYPE,
      336    13533    3             OUT_KEY,
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:98   
      337    13534    3             DEFAULT_KEY_QUAL_TEXTC$);
      338    13535    3           CALL READ_B$RATE(RET_VAL,%YES#,OUT_KEY);

  13535  6 000400   000004 237000 7                  LDAQ    4
         6 000401   203350 757100                    STAQ    @RET_VAL+1,,AUTO
         6 000402   203344 630500                    EPPR0   RET_VAL,,AUTO
         6 000403   203347 450500                    STP0    EXIT_LOOP+2,,AUTO
         6 000404   004404 701000 6                  TSX1    READ_B$RATE
         6 000405   000000 011000                    NOP     0

      339    13536    3           IF RET_VAL = ALT_RET

  13536  6 000406   203344 235100                    LDA     RET_VAL,,AUTO
         6 000407   000454 601000 6                  TNZ     s:13550

      340    13537    3           THEN IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

  13537  6 000410   000000 470400 xsym               LDP0    B$TCB$
         6 000411   000000 471500                    LDP1    0,,PR0
         6 000412   100102 236100                    LDQ     66,,PR1
         6 000413   377770 376007                    ANQ     131064,DL
         6 000414   001020 116007                    CMPQ    528,DL
         6 000415   000442 601000 6                  TNZ     s:13547

      341    13538    4                THEN DO;

      342    13539    4                     CALL GET_INIT_TBL(REC_TYPE);

  13539  6 000416   203343 633500                    EPPR3   REC_TYPE,,AUTO
         6 000417   203347 453500                    STP3    EXIT_LOOP+2,,AUTO
         6 000420   002131 701000 6                  TSX1    GET_INIT_TBL
         6 000421   000000 011000                    NOP     0

      343    13540    4                     CALL M$WRITE(B$RATE_WRITE_FPT)

  13540  6 000422   000260 630400 1                  EPPR0   B$RATE_WRITE_FPT
         6 000423   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:99   
         6 000424   401400 401760                    pmme    nvectors=4
         6 000425   000427 702000 6                  TSX2    s:13542
         6 000426   000441 710000 6                  TRA     s:13545

      344    13541    5                     WHENALTRETURN DO;

      345    13542    5                          CALL ERR_PROC(MONERR);

  13542  6 000427   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000430   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000431   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000432   000007 236000 7                  LDQ     7
         6 000433   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000434   001655 701000 6                  TSX1    ERR_PROC
         6 000435   000000 011000                    NOP     0

      346    13543    5                          UNWIND TO ERROR_EXIT;

  13543  6 000436   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 000437   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 000440   000000 000200                    ZERO    0,128

      347    13544    5                          END;
      348    13545    4                     END;

  13545  6 000441   000454 710000 6                  TRA     s:13550

      349    13546    4                ELSE DO;

      350    13547    4                     CALL ERR_PROC(MONERR); /* READ ERROR IN CHECK_DEFAULTS      */

  13547  6 000442   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000443   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000444   203370 757100                    STAQ    @CODE+1,,AUTO
         6 000445   000007 236000 7                  LDQ     7
         6 000446   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000447   001655 701000 6                  TSX1    ERR_PROC
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:100  
         6 000450   000000 011000                    NOP     0

      351    13548    4                     UNWIND TO ERROR_EXIT;

  13548  6 000451   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 000452   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 000453   000000 000200                    ZERO    0,128

      352    13549    4                     END;
      353    13550    3           END;

  13550  6 000454   203343 054100                    AOS     REC_TYPE,,AUTO
         6 000455   203343 235100                    LDA     REC_TYPE,,AUTO
         6 000456   000006 115007                    CMPA    6,DL
         6 000457   000366 604400 6                  TMOZ    s:13531

      354    13551    2      RETURN;

  13551  6 000460   203342 221300                    LDX1  ! SIGN_CHAR+1704,,AUTO
         6 000461   000001 702211                    TSX2  ! 1,X1

      355    13552    2   END CHECK_DEFAULTS;
      356    13553        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:101  
      357    13554    1   CLEAN_UP: PROC;

  13554  6 000462   200010 741300       CLEAN_UP     STX1  ! ERROR_EXIT+2,,AUTO

      358    13555    2   DCL KEY$ PTR;
      359    13556    2   DCL INDX SBIN WORD;
      360    13557    2   DCL 1 FOUR$KEY BASED,
      361    13558    2         2 * UBIN BYTE UNAL,
      362    13559    2         2 NAME CHAR(4),
      363    13560    2         2 QUAL CHAR(6);
      364    13561    2   DCL 1 RATE_TBL(0:999),
      365    13562    2         2 KEY_QUAL CHAR(6),
      366    13563    2         2 FLAGS,
      367    13564    2           3 EXISTS BIT(1),
      368    13565    2           3 PERCENT BIT(1),
      369    13566    2           3 POINTED_TO BIT(1);
      370    13567    2      RATE_TBL = '0'B;                     /* INITIALIZE TABLE                   */

  13567  6 000463   024403 220003                    LDX0    10499,DU
         6 000464   000140 100400                    MLR     fill='000'O
         6 000465   000002 020001 xsym               ADSC6   B_VECTNIL+2              cn=0,n=1
         6 000466   200013 020010                    ADSC6   RATE_TBL,,AUTO           cn=0,n=*X0

      371    13568    2      INDX = -1;                           /* INDEX OF HIGHEST ENTRY IN          */

  13568  6 000467   000001 335007                    LCA     1,DL
         6 000470   200012 755100                    STA     INDX,,AUTO

      372    13569                                                /* RATE_TBL                           */
      373    13570    2      KEY$ = ADDR(IN_KEY);

  13570  6 000471   000010 236000 7                  LDQ     8
         6 000472   200011 756100                    STQ     KEY$,,AUTO

      374    13571    2      CALL CHECK_DEFAULTS;                 /* CHECK FOR ANY MISSING DEFAULT      */

  13571  6 000473   000361 701000 6                  TSX1    CHECK_DEFAULTS
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:102  
         6 000474   000000 011000                    NOP     0

      375    13572                                                /* TABLES AND REPLACE THEM FROM       */
      376    13573                                                /* THE INIT TABLES IF NECESSARY       */
      377    13574    2      CALL PROCESS_SET(FILL_TBL_CODE);

  13574  6 000475   000021 236000 7                  LDQ     17
         6 000476   203343 756100                    STQ     REC_TYPE,,AUTO
         6 000477   000514 701000 6                  TSX1    PROCESS_SET
         6 000500   000000 011000                    NOP     0

      378    13575                                                /* FILL RATE_TABLE_TBL WITH           */
      379    13576                                                /* EXISTENCE INFORMATION              */
      380    13577    2      CALL PROCESS_SET(CHECK_PROC_CODE);

  13577  6 000501   000022 236000 7                  LDQ     18
         6 000502   203343 756100                    STQ     REC_TYPE,,AUTO
         6 000503   000514 701000 6                  TSX1    PROCESS_SET
         6 000504   000000 011000                    NOP     0

      381    13578                                                /* CHECK PROCESSOR TABLES FOR         */
      382    13579                                                /* RATE TABLE NUMBERS OF MISSING      */
      383    13580                                                /* RATE TABLES                        */
      384    13581    2      CALL PROCESS_SET(CHECK_SCHED_CODE);

  13581  6 000505   000006 236000 7                  LDQ     6
         6 000506   203343 756100                    STQ     REC_TYPE,,AUTO
         6 000507   000514 701000 6                  TSX1    PROCESS_SET
         6 000510   000000 011000                    NOP     0

      385    13582                                                /* CHECK SCHEDULE TABLES FOR          */
      386    13583                                                /* RATE TABLE NUMBERS OF MISSING      */
      387    13584                                                /* RATE TABLES OR PERCENT-TYPE        */
      388    13585                                                /* RATE TABLES                        */
      389    13586    2      CALL CHECK_DANGLING_RATES;           /* CHECK RATE_TABLE_TBL FOR           */

  13586  6 000511   001063 701000 6                  TSX1    CHECK_DANGLING_RATES
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:103  
         6 000512   000000 011000                    NOP     0
         6 000513   001171 710000 6                  TRA     s:13739

      390    13587                                                /* ANY DANGLING RATE TABLES           */
      391    13588        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:104  
      392    13589    2   PROCESS_SET: PROC(PROC_NAME_CODE);

  13589  6 000514   203342 741300       PROCESS_SET  STX1  ! SIGN_CHAR+1704,,AUTO

      393    13590    3   DCL RET_VAL SBIN WORD;
      394    13591    3   DCL PROC_NAME_CODE SBIN WORD;
      395    13592    3   DCL EXIT_LOOP SBIN WORD;
      396    13593    3      IN_KEY.LEN = 4;

  13593  6 000515   004000 236003                    LDQ     2048,DU
         6 000516   000532 552040 1                  STBQ    IN_KEY,'40'O

      397    13594    4      DO CASE(PROC_NAME_CODE);             /* SET UP THE KEY FOR POSITIONING*/

  13594  6 000517   203343 470500                    LDP0    @PROC_NAME_CODE,,AUTO
         6 000520   000000 235100                    LDA     0,,PR0
         6 000521   000004 115007                    CMPA    4,DL
         6 000522   000524 602005 6                  TNC     s:13594+5,AL
         6 000523   000543 710000 6                  TRA     s:13602
         6 000524   000543 710000 6                  TRA     s:13602
         6 000525   000534 710000 6                  TRA     s:13598
         6 000526   000540 710000 6                  TRA     s:13600
         6 000527   000530 710000 6                  TRA     s:13596

      398    13595    4       CASE(FILL_TBL_CODE);

      399    13596    4         IN_KEY.STRING = 'RATE';

  13596  6 000530   040000 100400                    MLR     fill='040'O
         6 000531   000251 000004 2                  ADSC9   VBND+7                   cn=0,n=4
         6 000532   000532 200043 1                  ADSC9   IN_KEY                   cn=1,n=35
         6 000533   000543 710000 6                  TRA     s:13602

      400    13597    4       CASE(CHECK_PROC_CODE);

      401    13598    4         IN_KEY.STRING = 'PROC';

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:105  
  13598  6 000534   040000 100400                    MLR     fill='040'O
         6 000535   000252 000004 2                  ADSC9   VBND+8                   cn=0,n=4
         6 000536   000532 200043 1                  ADSC9   IN_KEY                   cn=1,n=35
         6 000537   000543 710000 6                  TRA     s:13602

      402    13599    4       CASE(CHECK_SCHED_CODE);

      403    13600    4         IN_KEY.STRING = 'SCHE';

  13600  6 000540   040000 100400                    MLR     fill='040'O
         6 000541   000253 000004 2                  ADSC9   VBND+9                   cn=0,n=4
         6 000542   000532 200043 1                  ADSC9   IN_KEY                   cn=1,n=35

      404    13601    4         END;                              /* END CASE                           */

      405    13602    3      CALL M$PRECORD_CALL;                 /* POSITION TO FIRST RECORD OF        */

  13602  6 000543   003720 701000 6                  TSX1    M$PRECORD_CALL
         6 000544   000000 011000                    NOP     0

      406    13603                                                /* GIVEN RECORD TYPE                  */
      407    13604
      408    13605    3      EXIT_LOOP = FALSE;

  13605  6 000545   203345 450100                    STZ     EXIT_LOOP,,AUTO

      409    13606    4      DO WHILE (EXIT_LOOP  = FALSE);

  13606  6 000546   203345 235100                    LDA     EXIT_LOOP,,AUTO
         6 000547   000635 601000 6                  TNZ     s:13628

      410    13607    4           CALL READ_B$RATE(RET_VAL,%NO#,IN_KEY);

  13607  6 000550   000024 237000 7                  LDAQ    20
         6 000551   203350 757100                    STAQ    @RET_VAL+1,,AUTO
         6 000552   203344 630500                    EPPR0   RET_VAL,,AUTO
         6 000553   203347 450500                    STP0    EXIT_LOOP+2,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:106  
         6 000554   004404 701000 6                  TSX1    READ_B$RATE
         6 000555   000000 011000                    NOP     0

      411    13608    4           IF RET_VAL = NORM_RET           /* READ THE NEXT RECORD AND           */

  13608  6 000556   203344 235100                    LDA     RET_VAL,,AUTO
         6 000557   000001 115007                    CMPA    1,DL
         6 000560   000611 601000 6                  TNZ     s:13620

      412    13609    4           THEN                            /* PROCESS IT IF SUCCESSFULLY         */
      413    13610    5           DO CASE(PROC_NAME_CODE);        /* READ                               */

  13610  6 000561   203343 470500                    LDP0    @PROC_NAME_CODE,,AUTO
         6 000562   000000 235100                    LDA     0,,PR0
         6 000563   000004 115007                    CMPA    4,DL
         6 000564   000566 602005 6                  TNC     s:13610+5,AL
         6 000565   000633 710000 6                  TRA     s:13627
         6 000566   000610 710000 6                  TRA     s:13617
         6 000567   000577 710000 6                  TRA     s:13614
         6 000570   000604 710000 6                  TRA     s:13616
         6 000571   000572 710000 6                  TRA     s:13612

      414    13611    5            CASE(FILL_TBL_CODE);

      415    13612    5              CALL FILL_TBL(EXIT_LOOP);

  13612  6 000572   203345 631500                    EPPR1   EXIT_LOOP,,AUTO
         6 000573   203347 451500                    STP1    EXIT_LOOP+2,,AUTO
         6 000574   000637 701000 6                  TSX1    FILL_TBL
         6 000575   000000 011000                    NOP     0
         6 000576   000633 710000 6                  TRA     s:13627

      416    13613    5            CASE(CHECK_PROC_CODE);

      417    13614    5              CALL CHECK_PROC(EXIT_LOOP);

  13614  6 000577   203345 631500                    EPPR1   EXIT_LOOP,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:107  
         6 000600   203347 451500                    STP1    EXIT_LOOP+2,,AUTO
         6 000601   000705 701000 6                  TSX1    CHECK_PROC
         6 000602   000000 011000                    NOP     0
         6 000603   000633 710000 6                  TRA     s:13627

      418    13615    5            CASE(CHECK_SCHED_CODE);

      419    13616    5              CALL CHECK_SCHED(EXIT_LOOP);

  13616  6 000604   203345 631500                    EPPR1   EXIT_LOOP,,AUTO
         6 000605   203347 451500                    STP1    EXIT_LOOP+2,,AUTO
         6 000606   000755 701000 6                  TSX1    CHECK_SCHED
         6 000607   000000 011000                    NOP     0

      420    13617    5              END;                         /* END CASE                           */

  13617  6 000610   000633 710000 6                  TRA     s:13627

      421    13618
      422    13619    5           ELSE DO;

      423    13620    5                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF

  13620  6 000611   000000 470400 xsym               LDP0    B$TCB$
         6 000612   000000 471500                    LDP1    0,,PR0
         6 000613   100102 236100                    LDQ     66,,PR1
         6 000614   377770 376007                    ANQ     131064,DL
         6 000615   000060 116007                    CMPQ    48,DL
         6 000616   000631 600000 6                  TZE     s:13625

      424    13621    6                THEN DO;                   /* IF THE READ ERROR WAS NOT EOF      */

      425    13622    6                     CALL ERR_PROC(MONERR); /* NON-EOF CONSECUTIVE READ ERROR*/

  13622  6 000617   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000620   000001 235000 xsym               LDA     B_VECTNIL+1
         6 000621   203370 757100                    STAQ    @CODE+1,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:108  
         6 000622   000007 236000 7                  LDQ     7
         6 000623   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 000624   001655 701000 6                  TSX1    ERR_PROC
         6 000625   000000 011000                    NOP     0

      426    13623    6                     UNWIND TO ERROR_EXIT; /* AND ABORT PROGRAM                  */

  13623  6 000626   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 000627   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 000630   000000 000200                    ZERO    0,128

      427    13624    6                     END;
      428    13625    5                EXIT_LOOP = TRUE;          /* AND EXIT THE LOOP                  */

  13625  6 000631   000001 235007                    LDA     1,DL
         6 000632   203345 755100                    STA     EXIT_LOOP,,AUTO

      429    13626    5                END;

      430    13627    4           END;                            /* END WHILE                          */

  13627  6 000633   203345 235100                    LDA     EXIT_LOOP,,AUTO
         6 000634   000550 600000 6                  TZE     s:13607

      431    13628    3      RETURN;

  13628  6 000635   203342 221300                    LDX1  ! SIGN_CHAR+1704,,AUTO
         6 000636   000001 702211                    TSX2  ! 1,X1

      432    13629        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:109  
      433    13630    3   FILL_TBL: PROC(EXIT_LOOP);

  13630  6 000637   203346 741300       FILL_TBL     STX1  ! EXIT_LOOP+1,,AUTO

      434    13631    4   DCL EXIT_LOOP SBIN WORD;
      435    13632    4      IF KEY$->FOUR$KEY.NAME = 'RATE'      /* IF STILL PROCESSING RATE TBLS      */

  13632  6 000640   200011 470500                    LDP0    KEY$,,AUTO
         6 000641   040000 106500                    CMPC    fill='040'O
         6 000642   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         6 000643   000251 000004 2                  ADSC9   VBND+7                   cn=0,n=4
         6 000644   000700 601000 6                  TNZ     s:13643

      436    13633    5      THEN DO;                             /* UPDATE THE TABLE                   */

      437    13634    5           INDX = INDX+1;

  13634  6 000645   200012 054100                    AOS     INDX,,AUTO

      438    13635    5           RATE_TBL.KEY_QUAL(INDX) = KEY$->FOUR$KEY.QUAL;

  13635  6 000646   200012 236100                    LDQ     INDX,,AUTO
         6 000647   000007 402007                    MPY     7,DL
         6 000650   040106 100500                    MLR     fill='040'O
         6 000651   000001 200006                    ADSC9   1,,PR0                   cn=1,n=6
         6 000652   200013 000006                    ADSC9   RATE_TBL,Q,AUTO          cn=0,n=6

      439    13636    5           IF REC_BUF$->RATE$TBL.PERCENT#

  13636  6 000653   000015 471400 2                  LDP1    REC_BUF$
         6 000654   100000 234100                    SZN     0,,PR1
         6 000655   000667 605000 6                  TPL     s:13640

      440    13637    5           THEN                            /* EXISTS AND IS PERCENT TYPE         */
      441    13638    5                RATE_TBL.FLAGS(INDX) = '110'B;

  13638  6 000656   200012 236100                    LDQ     INDX,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:110  
         6 000657   000077 402007                    MPY     63,DL
         6 000660   000000 116003                    CMPQ    0,DU
         6 000661   000663 605000 6                  TPL     s:13638+5
         6 000662   000044 036003                    ADLQ    36,DU
         6 000663   003106 060400                    CSL     bolr='003'O
         6 000664   000026 000003 7                  BDSC    22                       by=0,bit=0,n=3
         6 000665   200014 400003                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=0,n=3
         6 000666   000703 710000 6                  TRA     s:13644

      442    13639    5           ELSE                            /* EXISTS AND NOT PERCENT TPYE        */
      443    13640    5                RATE_TBL.FLAGS(INDX) = '100'B;

  13640  6 000667   200012 236100                    LDQ     INDX,,AUTO
         6 000670   000077 402007                    MPY     63,DL
         6 000671   000000 116003                    CMPQ    0,DU
         6 000672   000674 605000 6                  TPL     s:13640+5
         6 000673   000044 036003                    ADLQ    36,DU
         6 000674   003106 060400                    CSL     bolr='003'O
         6 000675   000030 000003 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=3
         6 000676   200014 400003                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=0,n=3

      444    13641    5           END;

  13641  6 000677   000703 710000 6                  TRA     s:13644

      445    13642
      446    13643    4      ELSE EXIT_LOOP = TRUE;               /* OTHERWISE EXIT THE LOOP ABOVE      */

  13643  6 000700   000001 235007                    LDA     1,DL
         6 000701   203347 471500                    LDP1    @EXIT_LOOP,,AUTO
         6 000702   100000 755100                    STA     0,,PR1

      447    13644    4   END FILL_TBL;

  13644  6 000703   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 000704   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:111  
      448    13645        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:112  
      449    13646    3   CHECK_PROC: PROC(EXIT_LOOP);

  13646  6 000705   203346 741300       CHECK_PROC   STX1  ! EXIT_LOOP+1,,AUTO

      450    13647    4   DCL EXIT_LOOP SBIN WORD;
      451    13648    4   DCL I SBIN WORD;
      452    13649    4      IF KEY$->FOUR$KEY.NAME = 'PROC'      /* IF STILL PROCESSING PROCESSOR      */

  13649  6 000706   200011 470500                    LDP0    KEY$,,AUTO
         6 000707   040000 106500                    CMPC    fill='040'O
         6 000710   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         6 000711   000252 000004 2                  ADSC9   VBND+8                   cn=0,n=4
         6 000712   000750 601000 6                  TNZ     s:13662

      453    13650    4      THEN                                 /* TABLES                             */
      454    13651    5      DO;                                  /* CHECK RTABLE FIELD FOR MISSING     */

      455    13652                                                /* TARGET RATE TABLE AND UPDATE       */
      456    13653                                                /* POINTED_TO FIELD                   */
      457    13654    5           CALL GET_INDEX(REC_BUF$->PROC$TBL.RTABLE#,I);

  13654  6 000713   203350 631500                    EPPR1   I,,AUTO
         6 000714   203354 451500                    STP1    @MSG_INDX+1,,AUTO
         6 000715   000015 236000 2                  LDQ     REC_BUF$
         6 000716   203353 756100                    STQ     @KEY_QUAL_TEXTC$+1,,AUTO
         6 000717   001042 701000 6                  TSX1    GET_INDEX
         6 000720   000000 011000                    NOP     0

      458    13655    5           IF RATE_TBL.FLAGS.EXISTS(I)

  13655  6 000721   203350 236100                    LDQ     I,,AUTO
         6 000722   000077 402007                    MPY     63,DL
         6 000723   000000 116003                    CMPQ    0,DU
         6 000724   000726 605000 6                  TPL     s:13655+5
         6 000725   000044 036003                    ADLQ    36,DU
         6 000726   000000 066506                    CMPB    filb='0'B
         6 000727   200014 400001                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=0,n=1
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:113  
         6 000730   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 000731   000743 600000 6                  TZE     s:13659

      459    13656    5           THEN
      460    13657    5                RATE_TBL.FLAGS.POINTED_TO(I) = '1'B;

  13657  6 000732   203350 236100                    LDQ     I,,AUTO
         6 000733   000077 402007                    MPY     63,DL
         6 000734   000000 116003                    CMPQ    0,DU
         6 000735   000737 605000 6                  TPL     s:13657+5
         6 000736   000044 036003                    ADLQ    36,DU
         6 000737   003106 060400                    CSL     bolr='003'O
         6 000740   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         6 000741   200014 420001                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=2,n=1
         6 000742   000753 710000 6                  TRA     s:13663

      461    13658    5           ELSE
      462    13659    5                CALL OUT_CLEAN_UP_MSG(29);

  13659  6 000743   000030 236000 7                  LDQ     24
         6 000744   203353 756100                    STQ     @KEY_QUAL_TEXTC$+1,,AUTO
         6 000745   001135 701000 6                  TSX1    OUT_CLEAN_UP_MSG
         6 000746   000000 011000                    NOP     0

      463    13660    5           END;

  13660  6 000747   000753 710000 6                  TRA     s:13663

      464    13661    4      ELSE
      465    13662    4           EXIT_LOOP = TRUE;               /* OTHERWISE EXIT LOOP ABOVE          */

  13662  6 000750   000001 235007                    LDA     1,DL
         6 000751   203347 471500                    LDP1    @EXIT_LOOP,,AUTO
         6 000752   100000 755100                    STA     0,,PR1

      466    13663    4   END CHECK_PROC;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:114  
  13663  6 000753   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 000754   000001 702211                    TSX2  ! 1,X1

      467    13664        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:115  
      468    13665    3   CHECK_SCHED: PROC(EXIT_LOOP);

  13665  6 000755   203346 741300       CHECK_SCHED  STX1  ! EXIT_LOOP+1,,AUTO

      469    13666    4   DCL EXIT_LOOP SBIN WORD;
      470    13667    4   DCL I SBIN WORD;
      471    13668    4      IF KEY$->FOUR$KEY.NAME = 'SCHE'      /* IF STILL PROCESSING SCHEDULE       */

  13668  6 000756   200011 470500                    LDP0    KEY$,,AUTO
         6 000757   040000 106500                    CMPC    fill='040'O
         6 000760   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         6 000761   000253 000004 2                  ADSC9   VBND+9                   cn=0,n=4
         6 000762   001035 601000 6                  TNZ     s:13685

      472    13669    4      THEN                                 /* TABLES                             */
      473    13670    5      DO;                                  /* CHECK RTABLE FIELD FOR MISSING     */

      474    13671                                                /* OR PERCENT-TYPE TARGETS            */
      475    13672                                                /* AND UPDATE POINTED_TO FIELD        */
      476    13673    5           CALL GET_INDEX(REC_BUF$->SCHED$TBL.RTABLE#,I);

  13673  6 000763   203350 631500                    EPPR1   I,,AUTO
         6 000764   203354 451500                    STP1    @MSG_INDX+1,,AUTO
         6 000765   000015 236000 2                  LDQ     REC_BUF$
         6 000766   203353 756100                    STQ     @KEY_QUAL_TEXTC$+1,,AUTO
         6 000767   001042 701000 6                  TSX1    GET_INDEX
         6 000770   000000 011000                    NOP     0

      477    13674    5           IF RATE_TBL.FLAGS.EXISTS(I)

  13674  6 000771   203350 236100                    LDQ     I,,AUTO
         6 000772   000077 402007                    MPY     63,DL
         6 000773   000000 116003                    CMPQ    0,DU
         6 000774   000776 605000 6                  TPL     s:13674+5
         6 000775   000044 036003                    ADLQ    36,DU
         6 000776   000000 066506                    CMPB    filb='0'B
         6 000777   200014 400001                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=0,n=1
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:116  
         6 001000   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 001001   001030 600000 6                  TZE     s:13682

      478    13675    6           THEN DO;

      479    13676    6                RATE_TBL.FLAGS.POINTED_TO(I) = '1'B;

  13676  6 001002   203350 236100                    LDQ     I,,AUTO
         6 001003   000077 402007                    MPY     63,DL
         6 001004   000000 116003                    CMPQ    0,DU
         6 001005   001007 605000 6                  TPL     s:13676+5
         6 001006   000044 036003                    ADLQ    36,DU
         6 001007   003106 060400                    CSL     bolr='003'O
         6 001010   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         6 001011   200014 420001                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=2,n=1

      480    13677    6                IF RATE_TBL.FLAGS.PERCENT(I) /* POINTS TO PERCENT-TYPE           */

  13677  6 001012   203350 236100                    LDQ     I,,AUTO
         6 001013   000077 402007                    MPY     63,DL
         6 001014   000000 116003                    CMPQ    0,DU
         6 001015   001017 605000 6                  TPL     s:13677+5
         6 001016   000044 036003                    ADLQ    36,DU
         6 001017   000000 066506                    CMPB    filb='0'B
         6 001020   200014 410001                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=1,n=1
         6 001021   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 001022   001040 600000 6                  TZE     s:13686

      481    13678    6                THEN
      482    13679    6                     CALL OUT_CLEAN_UP_MSG(30);

  13679  6 001023   000032 236000 7                  LDQ     26
         6 001024   203353 756100                    STQ     @KEY_QUAL_TEXTC$+1,,AUTO
         6 001025   001135 701000 6                  TSX1    OUT_CLEAN_UP_MSG
         6 001026   000000 011000                    NOP     0

      483    13680    6                END;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:117  

  13680  6 001027   001040 710000 6                  TRA     s:13686

      484    13681    5           ELSE                            /* POINTS TO MISSING TABLE            */
      485    13682    5                CALL OUT_CLEAN_UP_MSG(29);

  13682  6 001030   000030 236000 7                  LDQ     24
         6 001031   203353 756100                    STQ     @KEY_QUAL_TEXTC$+1,,AUTO
         6 001032   001135 701000 6                  TSX1    OUT_CLEAN_UP_MSG
         6 001033   000000 011000                    NOP     0

      486    13683    5           END;

  13683  6 001034   001040 710000 6                  TRA     s:13686

      487    13684    4      ELSE
      488    13685    4           EXIT_LOOP = TRUE;               /* OTHERWISE EXIT LOOP ABOVE          */

  13685  6 001035   000001 235007                    LDA     1,DL
         6 001036   203347 471500                    LDP1    @EXIT_LOOP,,AUTO
         6 001037   100000 755100                    STA     0,,PR1

      489    13686    4   END CHECK_SCHED;

  13686  6 001040   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 001041   000001 702211                    TSX2  ! 1,X1

      490    13687        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:118  
      491    13688        /* THIS PROCEDURE RETURNS IN I THE INDEX INTO RATE_TBL OF THE ENTRY MATCHING  */
      492    13689        /* RTABLE. IF ONE DOES NOT EXIST, I IS INDEX TO FIRST UNUSED TABLE ENTRY      */
      493    13690        /* WHICH APPEARS EMPTY.                                                       */
      494    13691    3   GET_INDEX: PROC(RTABLE,I);

  13691  6 001042   203352 741300       GET_INDEX    STX1  ! @KEY_TEXTC+1,,AUTO

      495    13692    4   DCL RTABLE CHAR(6);
      496    13693    4   DCL I SBIN WORD;
      497    13694    4      I = 0;

  13694  6 001043   203354 470500                    LDP0    @I,,AUTO
         6 001044   000000 450100                    STZ     0,,PR0

      498    13695    5      DO WHILE((I<=INDX) AND (RATE_TBL.KEY_QUAL(I)~=RTABLE));

  13695  6 001045   001050 710000 6                  TRA     s:13697

      499    13696    5           I = I+1;

  13696  6 001046   203354 470500                    LDP0    @I,,AUTO
         6 001047   000000 054100                    AOS     0,,PR0

      500    13697    5           END;

  13697  6 001050   000000 236100                    LDQ     0,,PR0
         6 001051   200012 116100                    CMPQ    INDX,,AUTO
         6 001052   001061 605400 6                  TPNZ    s:13698
         6 001053   000007 402007                    MPY     7,DL
         6 001054   203353 471500                    LDP1    @RTABLE,,AUTO
         6 001055   040100 106506                    CMPC    fill='040'O
         6 001056   200013 000006                    ADSC9   RATE_TBL,Q,AUTO          cn=0,n=6
         6 001057   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         6 001060   001046 601000 6                  TNZ     s:13696

      501    13698    4   END GET_INDEX;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:119  
  13698  6 001061   203352 221300                    LDX1  ! @KEY_TEXTC+1,,AUTO
         6 001062   000001 702211                    TSX2  ! 1,X1

      502    13699    3   END PROCESS_SET;
      503    13700        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:120  
      504    13701    2   CHECK_DANGLING_RATES: PROC;

  13701  6 001063   203342 741300       CHECK_DANGL* STX1  ! SIGN_CHAR+1704,,AUTO

      505    13702    3   DCL I SBIN WORD;
      506    13703    3      IN_KEY.LEN = 10;

  13703  6 001064   012000 236003                    LDQ     5120,DU
         6 001065   000532 552040 1                  STBQ    IN_KEY,'40'O

      507    13704    3      IN_KEY.STRING = 'RATE';

  13704  6 001066   040000 100400                    MLR     fill='040'O
         6 001067   000251 000004 2                  ADSC9   VBND+7                   cn=0,n=4
         6 001070   000532 200043 1                  ADSC9   IN_KEY                   cn=1,n=35

      508    13705    4      DO I=0 TO INDX;                      /* PASS ENTIRE RATE_TBL               */

  13705  6 001071   203343 450100                    STZ     I,,AUTO
         6 001072   001130 710000 6                  TRA     s:13712+1

      509    13706    4           IF RATE_TBL.FLAGS.EXISTS(I) AND NOT

  13706  6 001073   203343 236100                    LDQ     I,,AUTO
         6 001074   000077 402007                    MPY     63,DL
         6 001075   000000 116003                    CMPQ    0,DU
         6 001076   001100 605000 6                  TPL     s:13706+5
         6 001077   000044 036003                    ADLQ    36,DU
         6 001100   000000 066506                    CMPB    filb='0'B
         6 001101   200014 400001                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=0,n=1
         6 001102   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 001103   001127 600000 6                  TZE     s:13712
         6 001104   203343 236100                    LDQ     I,,AUTO
         6 001105   000077 402007                    MPY     63,DL
         6 001106   000000 116003                    CMPQ    0,DU
         6 001107   001111 605000 6                  TPL     s:13706+14
         6 001110   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:121  
         6 001111   000000 066506                    CMPB    filb='0'B
         6 001112   200014 420001                    BDSC    KEY_TYPE_CODE,Q,AUTO     by=2,bit=2,n=1
         6 001113   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 001114   001127 601000 6                  TNZ     s:13712

      510    13707    4             RATE_TBL.FLAGS.POINTED_TO(I)
      511    13708    5           THEN DO;                        /* DANGLING RATE TABLE                */

      512    13709    5                KEY$->FOUR$KEY.QUAL = RATE_TBL.KEY_QUAL(I);

  13709  6 001115   203343 236100                    LDQ     I,,AUTO
         6 001116   000007 402007                    MPY     7,DL
         6 001117   200011 470500                    LDP0    KEY$,,AUTO
         6 001120   040100 100506                    MLR     fill='040'O
         6 001121   200013 000006                    ADSC9   RATE_TBL,Q,AUTO          cn=0,n=6
         6 001122   000001 200006                    ADSC9   1,,PR0                   cn=1,n=6

      513    13710    5                CALL OUT_CLEAN_UP_MSG(31);

  13710  6 001123   000034 236000 7                  LDQ     28
         6 001124   203353 756100                    STQ     @RTABLE,,AUTO
         6 001125   001135 701000 6                  TSX1    OUT_CLEAN_UP_MSG
         6 001126   000000 011000                    NOP     0

      514    13711    5                END;

      515    13712    4           END;

  13712  6 001127   203343 054100                    AOS     I,,AUTO
         6 001130   203343 236100                    LDQ     I,,AUTO
         6 001131   200012 116100                    CMPQ    INDX,,AUTO
         6 001132   001073 604400 6                  TMOZ    s:13706

      516    13713    3      RETURN;

  13713  6 001133   203342 221300                    LDX1  ! SIGN_CHAR+1704,,AUTO
         6 001134   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:122  

      517    13714    3   END CHECK_DANGLING_RATES;
      518    13715        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:123  
      519    13716    2   OUT_CLEAN_UP_MSG: PROC(MSG_INDX);

  13716  6 001135   203352 741300       OUT_CLEAN_U* STX1  ! @KEY_TEXTC+1,,AUTO

      520    13717    3   DCL MSG_INDX SBIN WORD;
      521    13718    3   DCL 1 KEY_BUF,
      522    13719    3         2 LEN UBIN BYTE UNAL,
      523    13720    3         2 STRING CHAR(35);
      524    13721    3      CALL CONCAT(KEY_BUF.STRING,

  13721  6 001136   040100 100400                    MLR     fill='040'O
         6 001137   000532 200004 1                  ADSC9   IN_KEY                   cn=1,n=4
         6 001140   203354 200004                    ADSC9   KEY_BUF,,AUTO            cn=1,n=4
         6 001141   000040 236003                    LDQ     32,DU
         6 001142   203355 552120                    STBQ    KEY_BUF+1,'20'O,AUTO
         6 001143   040100 100400                    MLR     fill='040'O
         6 001144   000533 200036 1                  ADSC9   IN_KEY+1                 cn=1,n=30
         6 001145   203355 400036                    ADSC9   KEY_BUF+1,,AUTO          cn=2,n=30

      525    13722    3        SUBSTR(IN_KEY.STRING,0,4),
      526    13723    3        ' ',
      527    13724    3        SUBSTR(IN_KEY.STRING,4));
      528    13725    3      KEY_BUF.LEN = IN_KEY.LEN+1;

  13725  6 001146   000532 236000 1                  LDQ     IN_KEY
         6 001147   000033 772000                    QRL     27
         6 001150   000001 036007                    ADLQ    1,DL
         6 001151   000033 736000                    QLS     27
         6 001152   203354 552140                    STBQ    KEY_BUF,'40'O,AUTO

      529    13726    3      FIELD1_ = VECTOR(KEY_BUF);

  13726  6 001153   000035 235000 7                  LDA     29
         6 001154   203374 452500                    STP2    TEMP_ERR+2,,AUTO
         6 001155   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 001156   003354 036003                    ADLQ    1772,DU
         6 001157   000050 757000 1                  STAQ    FIELD1_
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:124  

      530    13727    3      CALL ERR_PROC(MSG_INDX);

  13727  6 001160   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001161   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001162   203370 757100                    STAQ    @CODE+1,,AUTO
         6 001163   203353 236100                    LDQ     @MSG_INDX,,AUTO
         6 001164   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 001165   001655 701000 6                  TSX1    ERR_PROC
         6 001166   000000 011000                    NOP     0

      531    13728        /*E* ERROR:   ARA-00029
      532    13729             MESSAGE: %U1 points to a non-existent RATE table.
      533    13730        */
      534    13731        /*E* ERROR:   ARA-00030
      535    13732             MESSAGE: Schedule %U1 points to a percent-type RATE table.
      536    13733        */
      537    13734        /*E* ERROR:   ARA-00031
      538    13735             MESSAGE: %U1 is a dangling RATE table.
      539    13736        */
      540    13737    3      RETURN;

  13737  6 001167   203352 221300                    LDX1  ! @KEY_TEXTC+1,,AUTO
         6 001170   000001 702211                    TSX2  ! 1,X1

      541    13738    3   END OUT_CLEAN_UP_MSG;
      542    13739    2   END CLEAN_UP;

  13739  6 001171   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 001172   000001 702211                    TSX2  ! 1,X1

      543    13740        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:125  
      544    13741        /* THIS PROCEDURE ACCEPTS A DECIMAL NUMBER REPRESENTED BY THE OBJECT OF       */
      545    13742        /* VALUE$. THIS NUMBER MAY NOT BE GREATER THAN 13 DECIMAL DIGITS LONG AND     */
      546    13743        /* REPRESENTS A NUMBER OF THE FORM AAAA.BBBB. THIS NUMBER IS CONVERTED TO     */
      547    13744        /* SIGNED PACKED DECIMAL FLOATING POINT FORMAT AND RETURNED IN PACKED_NUM.    */
      548    13745        /* RET_VAL IS RETURNED NORM_RET IF                                            */
      549    13746        /* THE CALL TO THIS PROCEDURE WAS SUCCESSFUL AND ALT_RET IF UNSUCCESSFUL.     */
      550    13747        /* IF RET_VAL IS ALT_RET, THE CONTENTS OF PACKED_NUM ARE UNCHANGED.           */
      551    13748    1   CONVERT_TO_PACKED: PROC(RET_VAL,VALUE$,PACKED_NUM);

  13748  6 001173   200042 741300       CONVERT_TO_* STX1  ! T_NAME+5,,AUTO

      552    13749    2   DCL RET_VAL SBIN WORD;
      553    13750    2   DCL VALUE$ PTR;
      554    13751    2   DCL PACKED_NUM  BIT(72) DALIGNED;
      555    13752    2   DCL NUM$ PTR;
      556    13753    2   DCL NUM1$ PTR;
      557    13754    2   DCL SIZE SBIN WORD;
      558    13755    2   DCL 1 DEC_STRING,
      559    13756    2         2 SIGN BIT(9) UNAL,
      560    13757    2         2 STRING CHAR(13),
      561    13758    2         2 * BIT(1),
      562    13759    2         2 EXP UBIN(8) UNAL;
      563    13760
      564    13761
      565    13762    2      DEC_STRING.SIGN = '014'O;            /* POSITIVE SIGN                      */

  13762  6 001174   014000 236003                    LDQ     6144,DU
         6 001175   200051 552140                    STBQ    DEC_STRING,'40'O,AUTO

      566    13763    2      NUM$ = VALUE$->RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);

  13763  6 001176   200044 470500                    LDP0    @VALUE$,,AUTO
         6 001177   000000 471500                    LDP1    0,,PR0
         6 001200   100003 473500                    LDP3    3,,PR1
         6 001201   300003 236100                    LDQ     3,,PR3
         6 001202   200046 756100                    STQ     NUM$,,AUTO

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:126  
      567    13764                                                /* POINTS TO TEXTC OF FIRST           */
      568    13765                                                /* DECIMAL STRING                     */
      569    13766    2      IF VALUE$->RPT$BLK.NUM_SUB_BLKS = 1

  13766  6 001203   100001 220100                    LDX0    1,,PR1
         6 001204   000001 100003                    CMPX0   1,DU
         6 001205   001316 601000 6                  TNZ     s:13789

      570    13767    2      THEN IF NUM$->TEXT$C.LEN > 13

  13767  6 001206   200046 474500                    LDP4    NUM$,,AUTO
         6 001207   000100 101500                    MRL     fill='000'O
         6 001210   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 001211   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 001212   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 001213   000016 116007                    CMPQ    14,DL
         6 001214   001227 604000 6                  TMI     s:13776

      571    13768    3           THEN DO;

      572    13769    3                CALL ERR_PROC(16);

  13769  6 001215   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001216   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001217   203370 757100                    STAQ    @CODE+1,,AUTO
         6 001220   000037 236000 7                  LDQ     31
         6 001221   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 001222   001655 701000 6                  TSX1    ERR_PROC
         6 001223   000000 011000                    NOP     0

      573    13770        /*E* ERROR:   ARA-00016
      574    13771             MESSAGE: Rate value exceeds 13 digits.
      575    13772        */
      576    13773    3                RET_VAL = ALT_RET;

  13773  6 001224   200043 470500                    LDP0    @RET_VAL,,AUTO
         6 001225   000000 450100                    STZ     0,,PR0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:127  

      577    13774    3                END;

  13774  6 001226   001440 710000 6                  TRA     s:13809

      578    13775    3           ELSE DO;

      579    13776    3                CALL CONCAT(DEC_STRING.STRING,

  13776  6 001227   000100 101500                    MRL     fill='000'O
         6 001230   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 001231   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
         6 001232   000015 220003                    LDX0    13,DU
         6 001233   203374 120100                    SBLX0   TEMP_ERR+2,,AUTO
         6 001234   000100 101500                    MRL     fill='000'O
         6 001235   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 001236   203375 000002                    ADSC9   TEMP_ERR+3,,AUTO         cn=0,n=2
         6 001237   203375 222100                    LDX2    TEMP_ERR+3,,AUTO
         6 001240   040100 100440                    MLR     fill='040'O
         6 001241   000016 000010 2                  ADSC9   ZERO_STRING              cn=0,n=*X0
         6 001242   200051 200015                    ADSC9   DEC_STRING,,AUTO         cn=1,n=13
         6 001243   000000 636010                    EAQ     0,X0
         6 001244   000022 772000                    QRL     18
         6 001245   000015 116007                    CMPQ    13,DL
         6 001246   001257 603000 6                  TRC     s:13779
         6 001247   203376 740100                    STX0    TEMP_ERR+4,,AUTO
         6 001250   777762 620010                    EAX0    -14,X0
         6 001251   777777 660003                    ERX0    -1,DU
         6 001252   203376 235100                    LDA     TEMP_ERR+4,,AUTO
         6 001253   000022 771000                    ARL     18
         6 001254   040145 100540                    MLR     fill='040'O
         6 001255   400000 200012                    ADSC9   0,,PR4                   cn=1,n=*X2
         6 001256   200051 200010                    ADSC9   DEC_STRING,A,AUTO        cn=1,n=*X0

      580    13777    3                  SUBSTR(ZERO_STRING,0,13 - NUM$->TEXT$C.LEN),
      581    13778    3                  NUM$->TEXT$C.STRING);
      582    13779    3                IF VALUE$->RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:128  

  13779  6 001257   000000 471500                    LDP1    0,,PR0
         6 001260   100003 473500                    LDP3    3,,PR1
         6 001261   300000 720100                    LXL0    0,,PR3
         6 001262   000024 100003                    CMPX0   20,DU
         6 001263   001267 601000 6                  TNZ     s:13782

      583    13780    3                  = HIGH_DECIMAL_LIT
      584    13781    3                THEN DEC_STRING.EXP = 0;

  13781  6 001264   000040 236000 7                  LDQ     32
         6 001265   200054 356100                    ANSQ    I+1,,AUTO
         6 001266   001300 710000 6                  TRA     s:13783

      585    13782    3                ELSE DEC_STRING.EXP = -NUM$->TEXT$C.LEN;

  13782  6 001267   000100 101500                    MRL     fill='000'O
         6 001270   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 001271   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 001272   000000 236003                    LDQ     0,DU
         6 001273   203374 136100                    SBLQ    TEMP_ERR+2,,AUTO
         6 001274   000011 736000                    QLS     9
         6 001275   200054 676100                    ERQ     I+1,,AUTO
         6 001276   377000 376007                    ANQ     130560,DL
         6 001277   200054 656100                    ERSQ    I+1,,AUTO

      586    13783    3                CALL CONVPK(DEC_STRING,

  13783  6 001300   200045 236100                    LDQ     @PACKED_NUM,,AUTO
         6 001301   203376 756100                    STQ     TEMP_ERR+4,,AUTO
         6 001302   000042 236000 7                  LDQ     34
         6 001303   203375 756100                    STQ     TEMP_ERR+3,,AUTO
         6 001304   200051 631500                    EPPR1   DEC_STRING,,AUTO
         6 001305   203374 451500                    STP1    TEMP_ERR+2,,AUTO
         6 001306   203374 630500                    EPPR0   TEMP_ERR+2,,AUTO
         6 001307   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001310   000000 701000 xent               TSX1    CONVPK
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:129  
         6 001311   000000 011000                    NOP     0

      587    13784    3                  15,
      588    13785    3                  PACKED_NUM);
      589    13786    3                RET_VAL = NORM_RET;

  13786  6 001312   000001 235007                    LDA     1,DL
         6 001313   200043 470500                    LDP0    @RET_VAL,,AUTO
         6 001314   000000 755100                    STA     0,,PR0

      590    13787    3                END;

  13787  6 001315   001440 710000 6                  TRA     s:13809

      591    13788    3      ELSE DO;

      592    13789    3           NUM1$ = VALUE$->RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);

  13789  6 001316   100004 474500                    LDP4    4,,PR1
         6 001317   400003 236100                    LDQ     3,,PR4
         6 001320   200047 756100                    STQ     NUM1$,,AUTO

      593    13790                                                /* POINTS TO SECOND DECIMAL TEXTC*/
      594    13791    3           SIZE = NUM$->TEXT$C.LEN + NUM1$->TEXT$C.LEN;

  13791  6 001321   200047 475500                    LDP5    NUM1$,,AUTO
         6 001322   000100 101500                    MRL     fill='000'O
         6 001323   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         6 001324   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 001325   200046 471500                    LDP1    NUM$,,AUTO
         6 001326   000100 101500                    MRL     fill='000'O
         6 001327   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         6 001330   203375 000004                    ADSC9   TEMP_ERR+3,,AUTO         cn=0,n=4
         6 001331   203375 236100                    LDQ     TEMP_ERR+3,,AUTO
         6 001332   203374 036100                    ADLQ    TEMP_ERR+2,,AUTO
         6 001333   200050 756100                    STQ     SIZE,,AUTO

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:130  
      595    13792    3           IF SIZE > 13

  13792  6 001334   000015 116007                    CMPQ    13,DL
         6 001335   001350 604400 6                  TMOZ    s:13798

      596    13793    4           THEN DO;

      597    13794    4                CALL ERR_PROC(16);

  13794  6 001336   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001337   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001340   203370 757100                    STAQ    @CODE+1,,AUTO
         6 001341   000037 236000 7                  LDQ     31
         6 001342   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 001343   001655 701000 6                  TSX1    ERR_PROC
         6 001344   000000 011000                    NOP     0

      598    13795    4                RET_VAL = ALT_RET;

  13795  6 001345   200043 470500                    LDP0    @RET_VAL,,AUTO
         6 001346   000000 450100                    STZ     0,,PR0

      599    13796    4                END;

  13796  6 001347   001440 710000 6                  TRA     s:13809

      600    13797    4           ELSE DO;

      601    13798    4                CALL CONCAT(DEC_STRING.STRING,

  13798  6 001350   000100 101500                    MRL     fill='000'O
         6 001351   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         6 001352   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
         6 001353   203374 220100                    LDX0    TEMP_ERR+2,,AUTO
         6 001354   000100 101500                    MRL     fill='000'O
         6 001355   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         6 001356   203375 000002                    ADSC9   TEMP_ERR+3,,AUTO         cn=0,n=2
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:131  
         6 001357   203375 222100                    LDX2    TEMP_ERR+3,,AUTO
         6 001360   777762 623006                    EAX3    -14,QL
         6 001361   777777 663003                    ERX3    -1,DU
         6 001362   040100 100440                    MLR     fill='040'O
         6 001363   000016 000013 2                  ADSC9   ZERO_STRING              cn=0,n=*X3
         6 001364   200051 200015                    ADSC9   DEC_STRING,,AUTO         cn=1,n=13
         6 001365   000000 116003                    CMPQ    0,DU
         6 001366   001412 604400 6                  TMOZ    s:13802
         6 001367   200050 335100                    LCA     SIZE,,AUTO
         6 001370   000000 624006                    EAX4    0,QL
         6 001371   040145 100540                    MLR     fill='040'O
         6 001372   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         6 001373   200054 400014                    ADSC9   I+1,A,AUTO               cn=2,n=*X4
         6 001374   000000 636010                    EAQ     0,X0
         6 001375   000022 772000                    QRL     18
         6 001376   203376 756100                    STQ     TEMP_ERR+4,,AUTO
         6 001377   200050 236100                    LDQ     SIZE,,AUTO
         6 001400   203376 136100                    SBLQ    TEMP_ERR+4,,AUTO
         6 001401   001412 604400 6                  TMOZ    s:13802
         6 001402   203377 756100                    STQ     TEMP_ERR+5,,AUTO
         6 001403   000000 636010                    EAQ     0,X0
         6 001404   000022 772000                    QRL     18
         6 001405   200050 136100                    SBLQ    SIZE,,AUTO
         6 001406   203377 721100                    LXL1    TEMP_ERR+5,,AUTO
         6 001407   040146 100540                    MLR     fill='040'O
         6 001410   500000 200012                    ADSC9   0,,PR5                   cn=1,n=*X2
         6 001411   200054 400011                    ADSC9   I+1,Q,AUTO               cn=2,n=*X1

      602    13799    4                  SUBSTR(ZERO_STRING,0,13 - SIZE),
      603    13800    4                  NUM$->TEXT$C.STRING,
      604    13801    4                  NUM1$->TEXT$C.STRING);
      605    13802    4                DEC_STRING.EXP = -NUM1$->TEXT$C.LEN;

  13802  6 001412   000100 101500                    MRL     fill='000'O
         6 001413   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         6 001414   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 001415   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:132  
         6 001416   203374 136100                    SBLQ    TEMP_ERR+2,,AUTO
         6 001417   000011 736000                    QLS     9
         6 001420   200054 676100                    ERQ     I+1,,AUTO
         6 001421   377000 376007                    ANQ     130560,DL
         6 001422   200054 656100                    ERSQ    I+1,,AUTO

      606    13803    4                CALL CONVPK(DEC_STRING,

  13803  6 001423   200045 236100                    LDQ     @PACKED_NUM,,AUTO
         6 001424   203376 756100                    STQ     TEMP_ERR+4,,AUTO
         6 001425   000042 236000 7                  LDQ     34
         6 001426   203375 756100                    STQ     TEMP_ERR+3,,AUTO
         6 001427   200051 633500                    EPPR3   DEC_STRING,,AUTO
         6 001430   203374 453500                    STP3    TEMP_ERR+2,,AUTO
         6 001431   203374 630500                    EPPR0   TEMP_ERR+2,,AUTO
         6 001432   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 001433   000000 701000 xent               TSX1    CONVPK
         6 001434   000000 011000                    NOP     0

      607    13804    4                  15,
      608    13805    4                  PACKED_NUM);
      609    13806    4                RET_VAL = NORM_RET;

  13806  6 001435   000001 235007                    LDA     1,DL
         6 001436   200043 470500                    LDP0    @RET_VAL,,AUTO
         6 001437   000000 755100                    STA     0,,PR0

      610    13807    4                END;

      611    13808    3           END;

      612    13809    2      RETURN;

  13809  6 001440   200042 221300                    LDX1  ! T_NAME+5,,AUTO
         6 001441   000001 702211                    TSX2  ! 1,X1

      613    13810    2   END CONVERT_TO_PACKED;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:133  
      614    13811        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:134  
      615    13812    1   DELETE: PROC;                           /* PROCEDURE TO PROCESS DELETE        */

  13812  6 001442   200010 741300       DELETE       STX1  ! ERROR_EXIT+2,,AUTO

      616    13813                                                /* COMMAND                            */
      617    13814    2   DCL RET_VAL SBIN WORD;
      618    13815    2   DCL CUR_NODE$ PTR;
      619    13816    2   DCL KEY_QUAL_TEXTC$ PTR;
      620    13817    2   DCL 1 PHONY_KEY_QUAL_TEXTC STATIC,
      621    13818    2         2 LEN UBIN BYTE UNAL INIT(3),
      622    13819    2         2 STRING SBIN(27) UNAL;
      623    13820
      624    13821    2   DCL PHONY_KEY_QUAL_TEXTC$ PTR;
      625    13822    2   DCL REC_TYPE_CODE SBIN WORD;
      626    13823    2   DCL DCB$ PTR;
      627    13824    2   DCL NUM_RECS SBIN WORD;
      628    13825    2   DCL 1 NUM_RECS_STRING STATIC,
      629    13826    2         2 L UBIN BYTE UNAL INIT(5),
      630    13827    2         2 C CHAR(5) UNAL;
      631    13828    2      PHONY_KEY_QUAL_TEXTC$ = ADDR(PHONY_KEY_QUAL_TEXTC);

  13828  6 001443   000043 236000 7                  LDQ     35
         6 001444   200014 756100                    STQ     PHONY_KEY_QUAL_TEXTC$,,AUTO

      632    13829    2      REC_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;

  13829  6 001445   200003 470500                    LDP0    PCB,,AUTO
         6 001446   000003 471500                    LDP1    3,,PR0
         6 001447   100000 236100                    LDQ     0,,PR1
         6 001450   777777 376007                    ANQ     -1,DL
         6 001451   200015 756100                    STQ     REC_TYPE_CODE,,AUTO

      633    13830    2      IF REC_TYPE_CODE = ALL

  13830  6 001452   000015 116007                    CMPQ    13,DL
         6 001453   001471 601000 6                  TNZ     s:13841

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:135  
      634    13831    3      THEN DO;                             /* DELETE ALL RECORDS OF FILE         */

      635    13832    3           FIRST_DEL_KEY = '001000'O;      /* LOWEST POSSIBLE KEY                */

  13832  6 001454   000000 100400                    MLR     fill='000'O
         6 001455   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         6 001456   000326 000044 1                  ADSC9   FIRST_DEL_KEY            cn=0,n=36

      636    13833    3           LAST_DEL_KEY = '001777'O;       /* HIGHEST POSSIBLE KEY (OR           */

  13833  6 001457   000000 100400                    MLR     fill='000'O
         6 001460   000044 000002 7                  ADSC9   36                       cn=0,n=2
         6 001461   000337 000044 1                  ADSC9   LAST_DEL_KEY             cn=0,n=36

      637    13834                                                /* CLOSE ENOUGH)                      */
      638    13835    3           B$RATE_DELREC_FPT.LKEY_ = VECTOR(LAST_DEL_KEY);

  13835  6 001462   000046 237000 7                  LDAQ    38
         6 001463   000300 757000 1                  STAQ    B$RATE_DELREC_FPT+4

      639    13836                                                /* DELETE BETWEEN LIMITS              */
      640    13837    3           CALL M$DELREC(B$RATE_DELREC_FPT) ALTRET(DEL_ALT);

  13837  6 001464   000274 630400 1                  EPPR0   B$RATE_DELREC_FPT
         6 001465   440002 713400                    CLIMB   alt,+16386
         6 001466   401400 401760                    pmme    nvectors=4
         6 001467   001623 702000 6                  TSX2    DEL_ALT

      641    13838    3           END;

  13838  6 001470   001575 710000 6                  TRA     s:13881

      642    13839
      643    13840    3      ELSE DO;

      644    13841    3           CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:136  
  13841  6 001471   000003 471500                    LDP1    3,,PR0
         6 001472   100003 236100                    LDQ     3,,PR1
         6 001473   200012 756100                    STQ     CUR_NODE$,,AUTO

      645    13842                                                /* POINTS TO KEY QUALIFYING NODE      */
      646    13843    3           IF CUR_NODE$->RPT$BLK.CODE = ALL

  13843  6 001474   200012 473500                    LDP3    CUR_NODE$,,AUTO
         6 001475   300000 720100                    LXL0    0,,PR3
         6 001476   000015 100003                    CMPX0   13,DU
         6 001477   001537 601000 6                  TNZ     s:13862

      647    13844    4           THEN DO;                        /* DELETE ALL RECORDS OF A            */

      648    13845                                                /* GIVEN TYPE                         */
      649    13846    4                PHONY_KEY_QUAL_TEXTC.STRING = 0;

  13846  6 001500   000000 236003                    LDQ     0,DU
         6 001501   000555 552034 1                  STBQ    PHONY_KEY_QUAL_TEXTC,'34'O

      650    13847    4                CALL FORM_KEY(RET_VAL,     /* FORM LOWEST KEY OF THIS TYPE       */

  13847  6 001502   200014 631500                    EPPR1   PHONY_KEY_QUAL_TEXTC$,,AUTO
         6 001503   203352 451500                    STP1    @KEY_TEXTC+1,,AUTO
         6 001504   000045 236000 7                  LDQ     37
         6 001505   203351 756100                    STQ     @KEYED_OR_NOT+1,,AUTO
         6 001506   200015 634500                    EPPR4   REC_TYPE_CODE,,AUTO
         6 001507   203350 454500                    STP4    I,,AUTO
         6 001510   200011 635500                    EPPR5   RET_VAL,,AUTO
         6 001511   203347 455500                    STP5    @EXIT_LOOP,,AUTO
         6 001512   001716 701000 6                  TSX1    FORM_KEY
         6 001513   000000 011000                    NOP     0

      651    13848    4                  REC_TYPE_CODE,
      652    13849    4                  FIRST_DEL_KEY,
      653    13850    4                  PHONY_KEY_QUAL_TEXTC$);
      654    13851    4                PHONY_KEY_QUAL_TEXTC.STRING = -1;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:137  

  13851  6 001514   000032 236000 xsym               LDQ     B_VECTNIL+26
         6 001515   000555 552034 1                  STBQ    PHONY_KEY_QUAL_TEXTC,'34'O

      655    13852    4                CALL FORM_KEY(RET_VAL,     /* FORM HIGHEST KEY OF THIS TYPE      */

  13852  6 001516   200014 630500                    EPPR0   PHONY_KEY_QUAL_TEXTC$,,AUTO
         6 001517   203352 450500                    STP0    @KEY_TEXTC+1,,AUTO
         6 001520   000047 236000 7                  LDQ     39
         6 001521   203351 756100                    STQ     @KEYED_OR_NOT+1,,AUTO
         6 001522   200015 631500                    EPPR1   REC_TYPE_CODE,,AUTO
         6 001523   203350 451500                    STP1    I,,AUTO
         6 001524   200011 633500                    EPPR3   RET_VAL,,AUTO
         6 001525   203347 453500                    STP3    @EXIT_LOOP,,AUTO
         6 001526   001716 701000 6                  TSX1    FORM_KEY
         6 001527   000000 011000                    NOP     0

      656    13853    4                  REC_TYPE_CODE,
      657    13854    4                  LAST_DEL_KEY,
      658    13855    4                  PHONY_KEY_QUAL_TEXTC$);
      659    13856    4                B$RATE_DELREC_FPT.LKEY_ = VECTOR(LAST_DEL_KEY);

  13856  6 001530   000046 237000 7                  LDAQ    38
         6 001531   000300 757000 1                  STAQ    B$RATE_DELREC_FPT+4

      660    13857                                                /* DELETE BETWEEN LIMITS              */
      661    13858    4                CALL M$DELREC(B$RATE_DELREC_FPT) ALTRET(DEL_ALT);

  13858  6 001532   000274 630400 1                  EPPR0   B$RATE_DELREC_FPT
         6 001533   440002 713400                    CLIMB   alt,+16386
         6 001534   401400 401760                    pmme    nvectors=4
         6 001535   001623 702000 6                  TSX2    DEL_ALT

      662    13859    4                END;

  13859  6 001536   001575 710000 6                  TRA     s:13881

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:138  
      663    13860
      664    13861    4           ELSE DO;                        /* DELETE A SINGLE RECORD             */

      665    13862    4                IF CUR_NODE$->RPT$BLK.CODE = DEFAULT

  13862  6 001537   000016 100003                    CMPX0   14,DU
         6 001540   001544 601000 6                  TNZ     s:13864

      666    13863    4                THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);

  13863  6 001541   000002 236000 7                  LDQ     2
         6 001542   200013 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO
         6 001543   001546 710000 6                  TRA     s:13866

      667    13864    4                ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);

  13864  6 001544   300003 236100                    LDQ     3,,PR3
         6 001545   200013 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO

      668    13865
      669    13866    4                CALL FORM_KEY(RET_VAL,

  13866  6 001546   200013 631500                    EPPR1   KEY_QUAL_TEXTC$,,AUTO
         6 001547   203352 451500                    STP1    @KEY_TEXTC+1,,AUTO
         6 001550   000045 236000 7                  LDQ     37
         6 001551   203351 756100                    STQ     @KEYED_OR_NOT+1,,AUTO
         6 001552   200015 634500                    EPPR4   REC_TYPE_CODE,,AUTO
         6 001553   203350 454500                    STP4    I,,AUTO
         6 001554   200011 635500                    EPPR5   RET_VAL,,AUTO
         6 001555   203347 455500                    STP5    @EXIT_LOOP,,AUTO
         6 001556   001716 701000 6                  TSX1    FORM_KEY
         6 001557   000000 011000                    NOP     0

      670    13867    4                  REC_TYPE_CODE,
      671    13868    4                  FIRST_DEL_KEY,
      672    13869    4                  KEY_QUAL_TEXTC$);
      673    13870    4                IF RET_VAL = NORM_RET
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:139  

  13870  6 001560   200011 235100                    LDA     RET_VAL,,AUTO
         6 001561   000001 115007                    CMPA    1,DL
         6 001562   001573 601000 6                  TNZ     s:13878

      674    13871    5                THEN DO;

      675    13872    5                     B$RATE_DELREC_FPT.LKEY_ = VECTOR(NIL);

  13872  6 001563   000050 237000 7                  LDAQ    40
         6 001564   000300 757000 1                  STAQ    B$RATE_DELREC_FPT+4

      676    13873                                                /* SINGLE RECORD DELETE               */
      677    13874    5                     CALL M$DELREC(B$RATE_DELREC_FPT) ALTRET (DEL_ALT);

  13874  6 001565   000274 630400 1                  EPPR0   B$RATE_DELREC_FPT
         6 001566   440002 713400                    CLIMB   alt,+16386
         6 001567   401400 401760                    pmme    nvectors=4
         6 001570   001623 702000 6                  TSX2    DEL_ALT

      678    13875    5                     RETURN;

  13875  6 001571   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 001572   000001 702211                    TSX2  ! 1,X1

      679    13876    5                     END;
      680    13877
      681    13878    4                ELSE RETURN;

  13878  6 001573   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 001574   000001 702211                    TSX2  ! 1,X1

      682    13879    4                END;
      683    13880    3           END;
      684    13881    2      DCB$ = DCBADDR(DCBNUM(B$RATE_DCB));

  13881  6 001575   000000 236007 xsym               LDQ     B$RATE_DCB,DL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:140  
         6 001576   000052 470400 7                  LDP0    42
         6 001577   000000 471500                    LDP1    0,,PR0
         6 001600   100000 236106                    LDQ     0,QL,PR1
         6 001601   200016 756100                    STQ     DCB$,,AUTO

      685    13882    2      NUM_RECS = DCB$->F$DCB.ARS;          /* NUMBER OF RECORDS DELETED          */

  13882  6 001602   200016 473500                    LDP3    DCB$,,AUTO
         6 001603   300000 235100                    LDA     0,,PR3
         6 001604   200017 755100                    STA     NUM_RECS,,AUTO

      686    13883    2      CALL BINCHAR(NUM_RECS_STRING.C,NUM_RECS);

  13883  6 001605   000000 301500                    BTD
         6 001606   200017 000004                    NDSC9   NUM_RECS,,AUTO           cn=0,s=lsgnf,sf=0,n=4
         6 001607   000556 230005 1                  NDSC9   NUM_RECS_STRING          cn=1,s=nosgn,sf=0,n=5

      687    13884    2      FIELD1_ = VECTOR(NUM_RECS_STRING);

  13884  6 001610   000054 237000 7                  LDAQ    44
         6 001611   000050 757000 1                  STAQ    FIELD1_

      688    13885    2      CALL ERR_PROC(33);

  13885  6 001612   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001613   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001614   203370 757100                    STAQ    @CODE+1,,AUTO
         6 001615   000057 236000 7                  LDQ     47
         6 001616   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 001617   001655 701000 6                  TSX1    ERR_PROC
         6 001620   000000 011000                    NOP     0

      689    13886        /*E* ERROR:   ARA-00033
      690    13887             MESSAGE: %U1 tables deleted.
      691    13888        */
      692    13889    2      RETURN;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:141  
  13889  6 001621   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 001622   000001 702211                    TSX2  ! 1,X1

      693    13890    2   DEL_ALT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

  13890  6 001623   000000 470400 xsym  DEL_ALT      LDP0    B$TCB$
         6 001624   000000 471500                    LDP1    0,,PR0
         6 001625   100102 236100                    LDQ     66,,PR1
         6 001626   377770 376007                    ANQ     131064,DL
         6 001627   001020 116007                    CMPQ    528,DL
         6 001630   001641 601000 6                  TNZ     s:13896

      694    13891    2      THEN
      695    13892    2           CALL ERR_PROC(MONERR);

  13892  6 001631   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001632   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001633   203370 757100                    STAQ    @CODE+1,,AUTO
         6 001634   000007 236000 7                  LDQ     7
         6 001635   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 001636   001655 701000 6                  TSX1    ERR_PROC
         6 001637   000000 011000                    NOP     0
         6 001640   001653 710000 6                  TRA     s:13900

      696    13893                                                /* CAN'T DELETE-REC NOT FOUND         */
      697    13894    2      ELSE
      698    13895    3      DO;

      699    13896    3           CALL ERR_PROC(MONERR);

  13896  6 001641   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001642   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001643   203370 757100                    STAQ    @CODE+1,,AUTO
         6 001644   000007 236000 7                  LDQ     7
         6 001645   203367 756100                    STQ     KEY_BUF+11,,AUTO
         6 001646   001655 701000 6                  TSX1    ERR_PROC
         6 001647   000000 011000                    NOP     0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:142  

      700    13897                                                /* DELETE ERR OTHER THAN NOT FOUND*/
      701    13898    3           UNWIND TO ERROR_EXIT;

  13898  6 001650   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 001651   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 001652   000000 000200                    ZERO    0,128

      702    13899    3           END;
      703    13900    2   END DELETE;

  13900  6 001653   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 001654   000001 702211                    TSX2  ! 1,X1

      704    13901        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:143  
      705    13902        /* THIS PROCEDURE DRIVES M$ERRMSG AFTER SETTING UP THE PARAMETERS FOR ITS     */
      706    13903        /* CALL. IT ACCEPTS CODE, ELAB AND INCLCODE.  IF CODE = MONERR, THE STANDARD  */
      707    13904        /* SYS ERROR IS USED, OTHERWISE AN ERROR OF KEY ARA##### IS USED WHERE #####  */
      708    13905        /* = CODE.  IF INCLCODE IS SPECIFIED, ITS VALUE IS USED FOR INCLCODE,         */
      709    13906        /* OTHERWISE YES# IS USED.                                                    */
      710    13907        /* IF ELAB = TRUE, THIS MESSAGE IS CAPABLE OF BEING ELABORATED AND BECOMES    */
      711    13908        /* THE CURRENT ERROR, OTHERWISE IT IS OUTPUT AS A ONE TIME SHOT.              */
      712    13909    1   ERR_PROC: PROC(CODE,ELAB,INCLCODE);

  13909  6 001655   203366 741300       ERR_PROC     STX1  ! KEY_BUF+10,,AUTO

      713    13910    2   DCL CODE SBIN WORD;
      714    13911    2   DCL ELAB SBIN WORD;
      715    13912    2   DCL INCLCODE BIT(1) ALIGNED ;
      716    13913    2   DCL 1 TEMP_ERR,
      717    13914    2         2 FCG_MID UBIN(18) UNAL,
      718    13915    2         2 CODE UBIN(15) UNAL,
      719    13916    2         2 SEV UBIN(3) UNAL;
      720    13917    2      IF CODE = MONERR

  13917  6 001656   203367 470500                    LDP0    @CODE,,AUTO
         6 001657   000000 235100                    LDA     0,,PR0
         6 001660   001666 601000 6                  TNZ     s:13921

      721    13918    2      THEN TEMP_ERR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  13918  6 001661   000000 471400 xsym               LDP1    B$TCB$
         6 001662   100000 473500                    LDP3    0,,PR1
         6 001663   300102 236100                    LDQ     66,,PR3
         6 001664   203372 756100                    STQ     TEMP_ERR,,AUTO
         6 001665   001675 710000 6                  TRA     s:13924

      722    13919
      723    13920    3      ELSE DO;

      724    13921    3           TEMP_ERR.FCG_MID = 5249;        /* ARA IN SIXBIT                      */

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:144  
  13921  6 001666   012201 220003                    LDX0    5249,DU
         6 001667   203372 740100                    STX0    TEMP_ERR,,AUTO

      725    13922    3           TEMP_ERR.CODE = CODE;

  13922  6 001670   000000 236100                    LDQ     0,,PR0
         6 001671   000003 736000                    QLS     3
         6 001672   203372 676100                    ERQ     TEMP_ERR,,AUTO
         6 001673   777770 376007                    ANQ     -8,DL
         6 001674   203372 656100                    ERSQ    TEMP_ERR,,AUTO

      726    13923    3           END;

      727    13924    2      TEMP_ERR.SEV = 0;

  13924  6 001675   000060 236000 7                  LDQ     48
         6 001676   203372 356100                    ANSQ    TEMP_ERR,,AUTO

      728    13925    2      CALL XUR$ERRMSG(TEMP_ERR,B$TCB$->B$TCB.ALT$->B$ALT.DCB#,,FIELD1_);

  13925  6 001677   000000 471400 xsym               LDP1    B$TCB$
         6 001700   100000 473500                    LDP3    0,,PR1
         6 001701   000061 236000 7                  LDQ     49
         6 001702   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001703   203376 757100                    STAQ    TEMP_ERR+4,,AUTO
         6 001704   300101 634500                    EPPR4   65,,PR3
         6 001705   203375 454500                    STP4    TEMP_ERR+3,,AUTO
         6 001706   203372 633500                    EPPR3   TEMP_ERR,,AUTO
         6 001707   203374 453500                    STP3    TEMP_ERR+2,,AUTO
         6 001710   203374 630500                    EPPR0   TEMP_ERR+2,,AUTO
         6 001711   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001712   000000 701000 xent               TSX1    XUR$ERRMSG
         6 001713   000000 011000                    NOP     0

      729    13926    2      RETURN;

  13926  6 001714   203366 221300                    LDX1  ! KEY_BUF+10,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:145  
         6 001715   000001 702211                    TSX2  ! 1,X1

      730    13927    2   END ERR_PROC;
      731    13928        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:146  
      732    13929    1   FORM_KEY: PROC(RET_VAL,REC_TYPE,KEY_TEXTC,KEY_QUAL_TEXTC$);

  13929  6 001716   203346 741300       FORM_KEY     STX1  ! EXIT_LOOP+1,,AUTO

      733    13930                                                /* THIS PROC IS USED TO FORM A        */
      734    13931                                                /* KEY. THE KEY IS PUT INTO           */
      735    13932                                                /* KEY_TEXTC . THE KEY IS             */
      736    13933                                                /* FORMED FROM OBJECT OF              */
      737    13934                                                /* KEY_QUAL_TEXTC$  AND REC_TYPE      */
      738    13935                                                /* THE PROCEDURE RETURNS NORM_RET     */
      739    13936                                                /* IF SUCCESSFUL AND RETURNS          */
      740    13937                                                /* ALT_RET IF UNSUCCESSFUL            */
      741    13938                                                /* IN RET_VAL                         */
      742    13939
      743    13940    2   DCL RET_VAL SBIN WORD;
      744    13941    2   DCL 1 KEY_TEXTC UNAL,
      745    13942    2         2 LEN UBIN BYTE UNAL,
      746    13943    2         2 TYPE CHAR(4),
      747    13944    2         2 QUAL CHAR(31);
      748    13945    2   DCL KEY_QUAL_TEXTC$ PTR;
      749    13946    2   DCL REC_TYPE SBIN WORD;
      750    13947    3      DO CASE(REC_TYPE);

  13947  6 001717   203350 470500                    LDP0    @REC_TYPE,,AUTO
         6 001720   000000 235100                    LDA     0,,PR0
         6 001721   000005 115007                    CMPA    5,DL
         6 001722   001724 602005 6                  TNC     s:13947+5,AL
         6 001723   001731 710000 6                  TRA     s:13949
         6 001724   001731 710000 6                  TRA     s:13949
         6 001725   001731 710000 6                  TRA     s:13949
         6 001726   001731 710000 6                  TRA     s:13949
         6 001727   001777 710000 6                  TRA     s:13971
         6 001730   001754 710000 6                  TRA     s:13960

      751    13948    3       CASE(ELSE);

      752    13949    3         IF KEY_QUAL_TEXTC$->TEXT$C.LEN > 6
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:147  

  13949  6 001731   203352 471500                    LDP1    @KEY_QUAL_TEXTC$,,AUTO
         6 001732   100000 473500                    LDP3    0,,PR1
         6 001733   000100 101500                    MRL     fill='000'O
         6 001734   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 001735   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 001736   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 001737   000007 116007                    CMPQ    7,DL
         6 001740   002022 604000 6                  TMI     s:13982

      753    13950    3         THEN
      754    13951    4         DO;

      755    13952    4              CALL ERR_PROC(9);

  13952  6 001741   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001742   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001743   203370 757100                    STAQ    @ELAB,,AUTO
         6 001744   000062 236000 7                  LDQ     50
         6 001745   203367 756100                    STQ     @CODE,,AUTO
         6 001746   001655 701000 6                  TSX1    ERR_PROC
         6 001747   000000 011000                    NOP     0

      756    13953        /*E* ERROR:   ARA-00009
      757    13954             MESSAGE: Table name exceeds 6 characters.
      758    13955        */
      759    13956    4              RET_VAL = ALT_RET;

  13956  6 001750   203347 470500                    LDP0    @RET_VAL,,AUTO
         6 001751   000000 450100                    STZ     0,,PR0

      760    13957    4              RETURN;

  13957  6 001752   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 001753   000001 702211                    TSX2  ! 1,X1

      761    13958    4              END;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:148  
      762    13959    3       CASE(FORM_CODE);

      763    13960    3         IF KEY_QUAL_TEXTC$->TEXT$C.LEN > 12

  13960  6 001754   203352 471500                    LDP1    @KEY_QUAL_TEXTC$,,AUTO
         6 001755   100000 473500                    LDP3    0,,PR1
         6 001756   000100 101500                    MRL     fill='000'O
         6 001757   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 001760   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 001761   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 001762   000015 116007                    CMPQ    13,DL
         6 001763   002022 604000 6                  TMI     s:13982

      764    13961    3         THEN
      765    13962    4         DO;

      766    13963    4              CALL ERR_PROC(11);

  13963  6 001764   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001765   000001 235000 xsym               LDA     B_VECTNIL+1
         6 001766   203370 757100                    STAQ    @ELAB,,AUTO
         6 001767   000063 236000 7                  LDQ     51
         6 001770   203367 756100                    STQ     @CODE,,AUTO
         6 001771   001655 701000 6                  TSX1    ERR_PROC
         6 001772   000000 011000                    NOP     0

      767    13964        /*E* ERROR:       ARA-000011
      768    13965             MESSAGE: FORM table name exceeds 12 characters.
      769    13966        */
      770    13967    4              RET_VAL = ALT_RET;

  13967  6 001773   203347 470500                    LDP0    @RET_VAL,,AUTO
         6 001774   000000 450100                    STZ     0,,PR0

      771    13968    4              RETURN;

  13968  6 001775   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:149  
         6 001776   000001 702211                    TSX2  ! 1,X1

      772    13969    4              END;
      773    13970    3       CASE(PROC_CODE);

      774    13971    3         IF KEY_QUAL_TEXTC$->TEXT$C.LEN > 31

  13971  6 001777   203352 471500                    LDP1    @KEY_QUAL_TEXTC$,,AUTO
         6 002000   100000 473500                    LDP3    0,,PR1
         6 002001   000100 101500                    MRL     fill='000'O
         6 002002   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 002003   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 002004   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 002005   000040 116007                    CMPQ    32,DL
         6 002006   002022 604000 6                  TMI     s:13982

      775    13972    3         THEN
      776    13973    4         DO;

      777    13974    4              CALL ERR_PROC(8);

  13974  6 002007   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002010   000001 235000 xsym               LDA     B_VECTNIL+1
         6 002011   203370 757100                    STAQ    @ELAB,,AUTO
         6 002012   000064 236000 7                  LDQ     52
         6 002013   203367 756100                    STQ     @CODE,,AUTO
         6 002014   001655 701000 6                  TSX1    ERR_PROC
         6 002015   000000 011000                    NOP     0

      778    13975        /*E* ERROR:       ARA-00008
      779    13976             MESSAGE: PROC table name exceeds 31 characters.
      780    13977        */
      781    13978    4              RET_VAL = ALT_RET;

  13978  6 002016   203347 470500                    LDP0    @RET_VAL,,AUTO
         6 002017   000000 450100                    STZ     0,,PR0

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:150  
      782    13979    4              RETURN;

  13979  6 002020   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 002021   000001 702211                    TSX2  ! 1,X1

      783    13980    4              END;
      784    13981    3         END;

      785    13982    3      DO CASE(REC_TYPE);

  13982  6 002022   000000 235100                    LDA     0,,PR0
         6 002023   000007 115007                    CMPA    7,DL
         6 002024   002026 602005 6                  TNC     s:13982+4,AL
         6 002025   002113 710000 6                  TRA     s:13999
         6 002026   002113 710000 6                  TRA     s:13999
         6 002027   002035 710000 6                  TRA     s:13984
         6 002030   002045 710000 6                  TRA     s:13987
         6 002031   002055 710000 6                  TRA     s:13990
         6 002032   002074 710000 6                  TRA     s:13993
         6 002033   002045 710000 6                  TRA     s:13987
         6 002034   002104 710000 6                  TRA     s:13996

      786    13983    3       CASE(SCHED_CODE);

      787    13984    3         KEY_TEXTC.LEN = 10;

  13984  6 002035   203351 473500                    LDP3    @KEY_TEXTC,,AUTO
         6 002036   000100 101400                    MRL     fill='000'O
         6 002037   000014 000004 xsym               ADSC9   B_VECTNIL+12             cn=0,n=4
         6 002040   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      788    13985    3         KEY_TEXTC.TYPE = 'SCHE';

  13985  6 002041   040100 100400                    MLR     fill='040'O
         6 002042   000253 000004 2                  ADSC9   VBND+9                   cn=0,n=4
         6 002043   300000 200004                    ADSC9   0,,PR3                   cn=1,n=4
         6 002044   002113 710000 6                  TRA     s:13999
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:151  

      789    13986    3       CASE(RATE_CODE, LCP6_CODE);

      790    13987    3         KEY_TEXTC.LEN = 10;

  13987  6 002045   203351 473500                    LDP3    @KEY_TEXTC,,AUTO
         6 002046   000100 101400                    MRL     fill='000'O
         6 002047   000014 000004 xsym               ADSC9   B_VECTNIL+12             cn=0,n=4
         6 002050   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      791    13988    3         KEY_TEXTC.TYPE = 'RATE';

  13988  6 002051   040100 100400                    MLR     fill='040'O
         6 002052   000251 000004 2                  ADSC9   VBND+7                   cn=0,n=4
         6 002053   300000 200004                    ADSC9   0,,PR3                   cn=1,n=4
         6 002054   002113 710000 6                  TRA     s:13999

      792    13989    3       CASE(PROC_CODE);

      793    13990    3         KEY_TEXTC.LEN = KEY_QUAL_TEXTC$->TEXT$C.LEN+4;

  13990  6 002055   100000 473500                    LDP3    0,,PR1
         6 002056   000100 101500                    MRL     fill='000'O
         6 002057   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 002060   203375 000004                    ADSC9   TEMP_ERR+3,,AUTO         cn=0,n=4
         6 002061   203375 236100                    LDQ     TEMP_ERR+3,,AUTO
         6 002062   000004 036007                    ADLQ    4,DL
         6 002063   203374 756100                    STQ     TEMP_ERR+2,,AUTO
         6 002064   203351 473500                    LDP3    @KEY_TEXTC,,AUTO
         6 002065   000100 101500                    MRL     fill='000'O
         6 002066   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 002067   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      794    13991    3         KEY_TEXTC.TYPE = 'PROC';

  13991  6 002070   040100 100400                    MLR     fill='040'O
         6 002071   000252 000004 2                  ADSC9   VBND+8                   cn=0,n=4
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:152  
         6 002072   300000 200004                    ADSC9   0,,PR3                   cn=1,n=4
         6 002073   002113 710000 6                  TRA     s:13999

      795    13992    3       CASE(FORM_CODE);

      796    13993    3         KEY_TEXTC.LEN = 16;

  13993  6 002074   203351 473500                    LDP3    @KEY_TEXTC,,AUTO
         6 002075   000100 101400                    MRL     fill='000'O
         6 002076   000036 000004 7                  ADSC9   30                       cn=0,n=4
         6 002077   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      797    13994    3         KEY_TEXTC.TYPE = 'FORM';

  13994  6 002100   040100 100400                    MLR     fill='040'O
         6 002101   000254 000004 2                  ADSC9   VBND+10                  cn=0,n=4
         6 002102   300000 200004                    ADSC9   0,,PR3                   cn=1,n=4
         6 002103   002113 710000 6                  TRA     s:13999

      798    13995    3       CASE(COMM_CODE);

      799    13996    3         KEY_TEXTC.LEN = 10;

  13996  6 002104   203351 473500                    LDP3    @KEY_TEXTC,,AUTO
         6 002105   000100 101400                    MRL     fill='000'O
         6 002106   000014 000004 xsym               ADSC9   B_VECTNIL+12             cn=0,n=4
         6 002107   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      800    13997    3         KEY_TEXTC.TYPE = 'COMM';

  13997  6 002110   040100 100400                    MLR     fill='040'O
         6 002111   000255 000004 2                  ADSC9   VBND+11                  cn=0,n=4
         6 002112   300000 200004                    ADSC9   0,,PR3                   cn=1,n=4

      801    13998    3         END;                              /* END CASE                           */

      802    13999    2      KEY_TEXTC.QUAL = KEY_QUAL_TEXTC$->TEXT$C.STRING;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:153  

  13999  6 002113   100000 473500                    LDP3    0,,PR1
         6 002114   000100 101500                    MRL     fill='000'O
         6 002115   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 002116   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
         6 002117   203374 220100                    LDX0    TEMP_ERR+2,,AUTO
         6 002120   203351 474500                    LDP4    @KEY_TEXTC,,AUTO
         6 002121   040100 100540                    MLR     fill='040'O
         6 002122   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         6 002123   400001 200037                    ADSC9   1,,PR4                   cn=1,n=31

      803    14000    2      RET_VAL = NORM_RET;

  14000  6 002124   000001 235007                    LDA     1,DL
         6 002125   203347 473500                    LDP3    @RET_VAL,,AUTO
         6 002126   300000 755100                    STA     0,,PR3

      804    14001    2   END FORM_KEY;

  14001  6 002127   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 002130   000001 702211                    TSX2  ! 1,X1

      805    14002        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:154  
      806    14003    1   GET_INIT_TBL: PROC(REC_TYPE);

  14003  6 002131   203346 741300       GET_INIT_TBL STX1  ! EXIT_LOOP+1,,AUTO

      807    14004    2   DCL REC_TYPE SBIN WORD;
      808    14005    3      DO CASE(REC_TYPE);

  14005  6 002132   203347 470500                    LDP0    @REC_TYPE,,AUTO
         6 002133   000000 235100                    LDA     0,,PR0
         6 002134   000007 115007                    CMPA    7,DL
         6 002135   002137 602005 6                  TNC     s:14005+5,AL
         6 002136   002225 710000 6                  TRA     s:14031
         6 002137   002225 710000 6                  TRA     s:14031
         6 002140   002146 710000 6                  TRA     s:14007
         6 002141   002156 710000 6                  TRA     s:14011
         6 002142   002166 710000 6                  TRA     s:14015
         6 002143   002176 710000 6                  TRA     s:14019
         6 002144   002206 710000 6                  TRA     s:14023
         6 002145   002216 710000 6                  TRA     s:14027

      809    14006    3       CASE(SCHED_CODE);

      810    14007    3         REC_BUFB = INIT_SCHED_TBL;

  14007  6 002146   000000 100400                    MLR     fill='000'O
         6 002147   000000 000070 xsym               ADSC9   INIT_SCHED_TBL           cn=0,n=56
         6 002150   000350 000702 1                  ADSC9   REC_BUF                  cn=0,n=450

      811    14008    3         B$RATE_WRITE_FPT.BUF_.BOUND        =

  14008  6 002151   000264 236000 1                  LDQ     B$RATE_WRITE_FPT+4
         6 002152   177777 376007                    ANQ     65535,DL
         6 002153   000065 276000 7                  ORQ     53
         6 002154   000264 756000 1                  STQ     B$RATE_WRITE_FPT+4
         6 002155   002225 710000 6                  TRA     s:14031

      812    14009    3           SIZEV(INIT_SCHED_TBL);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:155  
      813    14010    3       CASE(RATE_CODE);

      814    14011    3         REC_BUFB = INIT_RATE_TBL;

  14011  6 002156   000000 100400                    MLR     fill='000'O
         6 002157   000000 000614 xsym               ADSC9   INIT_RATE_TBL            cn=0,n=396
         6 002160   000350 000702 1                  ADSC9   REC_BUF                  cn=0,n=450

      815    14012    3         B$RATE_WRITE_FPT.BUF_.BOUND        =

  14012  6 002161   000264 236000 1                  LDQ     B$RATE_WRITE_FPT+4
         6 002162   177777 376007                    ANQ     65535,DL
         6 002163   000066 276000 7                  ORQ     54
         6 002164   000264 756000 1                  STQ     B$RATE_WRITE_FPT+4
         6 002165   002225 710000 6                  TRA     s:14031

      816    14013    3           SIZEV(INIT_RATE_TBL);
      817    14014    3       CASE(PROC_CODE);

      818    14015    3         REC_BUFB = INIT_PROC_TBL;

  14015  6 002166   000000 100400                    MLR     fill='000'O
         6 002167   000000 000070 xsym               ADSC9   INIT_PROC_TBL            cn=0,n=56
         6 002170   000350 000702 1                  ADSC9   REC_BUF                  cn=0,n=450

      819    14016    3         B$RATE_WRITE_FPT.BUF_.BOUND        =

  14016  6 002171   000264 236000 1                  LDQ     B$RATE_WRITE_FPT+4
         6 002172   177777 376007                    ANQ     65535,DL
         6 002173   000065 276000 7                  ORQ     53
         6 002174   000264 756000 1                  STQ     B$RATE_WRITE_FPT+4
         6 002175   002225 710000 6                  TRA     s:14031

      820    14017    3           SIZEV(INIT_PROC_TBL);
      821    14018    3       CASE(FORM_CODE);

      822    14019    3         REC_BUFB = INIT_FORM_TBL;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:156  

  14019  6 002176   000000 100400                    MLR     fill='000'O
         6 002177   000000 000040 xsym               ADSC9   INIT_FORM_TBL            cn=0,n=32
         6 002200   000350 000702 1                  ADSC9   REC_BUF                  cn=0,n=450

      823    14020    3         B$RATE_WRITE_FPT.BUF_.BOUND        =

  14020  6 002201   000264 236000 1                  LDQ     B$RATE_WRITE_FPT+4
         6 002202   177777 376007                    ANQ     65535,DL
         6 002203   000067 276000 7                  ORQ     55
         6 002204   000264 756000 1                  STQ     B$RATE_WRITE_FPT+4
         6 002205   002225 710000 6                  TRA     s:14031

      824    14021    3           SIZEV(INIT_FORM_TBL);
      825    14022    3       CASE(LCP6_CODE);

      826    14023    3         REC_BUFB = INIT_LCP6_TBL;

  14023  6 002206   000000 100400                    MLR     fill='000'O
         6 002207   000000 000614 xsym               ADSC9   INIT_LCP6_TBL            cn=0,n=396
         6 002210   000350 000702 1                  ADSC9   REC_BUF                  cn=0,n=450

      827    14024    3         B$RATE_WRITE_FPT.BUF_.BOUND        =

  14024  6 002211   000264 236000 1                  LDQ     B$RATE_WRITE_FPT+4
         6 002212   177777 376007                    ANQ     65535,DL
         6 002213   000066 276000 7                  ORQ     54
         6 002214   000264 756000 1                  STQ     B$RATE_WRITE_FPT+4
         6 002215   002225 710000 6                  TRA     s:14031

      828    14025    3           SIZEV(INIT_LCP6_TBL);
      829    14026    3       CASE(COMM_CODE);

      830    14027    3         REC_BUFB = INIT_COMM_TBL;

  14027  6 002216   000000 100400                    MLR     fill='000'O
         6 002217   000000 000004 xsym               ADSC9   INIT_COMM_TBL            cn=0,n=4
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:157  
         6 002220   000350 000702 1                  ADSC9   REC_BUF                  cn=0,n=450

      831    14028    3         B$RATE_WRITE_FPT.BUF_.BOUND        =

  14028  6 002221   000264 236000 1                  LDQ     B$RATE_WRITE_FPT+4
         6 002222   177777 376007                    ANQ     65535,DL
         6 002223   000070 276000 7                  ORQ     56
         6 002224   000264 756000 1                  STQ     B$RATE_WRITE_FPT+4

      832    14029    3           SIZEV(INIT_COMM_TBL);
      833    14030    3         END;                              /* END CASE                           */

      834    14031    2      RETURN;

  14031  6 002225   000001 702211                    TSX2  ! 1,X1

      835    14032    2   END GET_INIT_TBL;
      836    14033        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:158  
      837    14034    1   INITIALIZE: PROC;

  14034  6 002226   200010 741300       INITIALIZE   STX1  ! ERROR_EXIT+2,,AUTO

      838    14035    2   DCL 1 TEST_PATTERN CONSTANT,
      839    14036    2         2 * CHAR(3) INIT ('TST'),
      840    14037    2         2 * BIT(9) INIT ('000'O);
      841    14038        %FPT_PRIV(FPTN = FPT_PPRIV ,
      842    14039                  PRIV = %PPR_RATES# ,
      843    14040                  PPRIV = YES ,
      844    14041                  STCLASS = STATIC ) ;
      845    14056        %FPT_PRIV(FPTN = FPT_PRIV ,
      846    14057                  PRIV = %PR_FMSEC# ,
      847    14058                  STCLASS = STATIC ) ;
      848    14073    2   DCL 1 B_VERSION SYMREF,
      849    14074    2         2 LEN UBIN(9) UNAL,
      850    14075    2         2 TEXT CHAR(B_VERSION.LEN);
      851    14076    2      CALL XUR$INIT (XUR_INIT);

  14076  6 002227   000071 630400 7                  EPPR0   57
         6 002230   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 002231   000000 701000 xent               TSX1    XUR$INIT
         6 002232   000000 011000                    NOP     0

      852    14077    2      CALL M$RPRIV (FPT_PRIV);             /* Turn off FMSEC                     */

  14077  6 002233   000564 630400 1                  EPPR0   FPT_PRIV
         6 002234   020013 713400                    CLIMB   8203
         6 002235   400000 401760                    pmme    nvectors=1

      853    14078    2      IF (B$JIT.SWITCH & '777777777000'O) = TEST_PATTERN

  14078  6 002236   000000 470400 xsym               LDP0    B$JIT$
         6 002237   000031 236100                    LDQ     25,,PR0
         6 002240   000256 376000 2                  ANQ     VBND+12
         6 002241   000027 116000 2                  CMPQ    TEST_PATTERN
         6 002242   002254 601000 6                  TNZ     s:14087
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:159  

      854    14079    2      THEN                                 /* RATES test-mode active             */
      855    14080    3      DO;

      856    14081    3           TEST_MODE = 1;

  14081  6 002243   000001 235007                    LDA     1,DL
         6 002244   000554 755000 1                  STA     TEST_MODE

      857    14082    3           LO_OUT_BUF = '** RATES TEST MODE HERE **';

  14082  6 002245   040000 100400                    MLR     fill='040'O
         6 002246   000257 000032 2                  ADSC9   VBND+13                  cn=0,n=26
         6 002247   000070 000204 1                  ADSC9   LO_OUT_BUF               cn=0,n=132

      858    14083    3           ACCT_RATES.ACCT# = ' ';         /* Put :RATES in user's account       */

  14083  6 002250   000035 235000 xsym               LDA     B_VECTNIL+29
         6 002251   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 002252   000226 757000 1                  STAQ    ACCT_RATES

      859    14084    3           END;

  14084  6 002253   002316 710000 6                  TRA     s:14101

      860    14085    2      ELSE                                 /* Normal RATES operation             */
      861    14086    3      DO;

      862    14087    3           TEST_MODE = 0;

  14087  6 002254   000554 450000 1                  STZ     TEST_MODE

      863    14088    3           IF B$JIT.PRIV.PRC               /* Check for RATES priv if in :SYS    */

  14088  6 002255   000016 235100                    LDA     14,,PR0
         6 002256   002263 600000 6                  TZE     s:14090

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:160  
      864    14089    3           THEN CALL M$SPRIV( FPT_PPRIV ) ALTRET( SPPRIV_ERR );

  14089  6 002257   000560 630400 1                  EPPR0   FPT_PPRIV
         6 002260   420012 713400                    CLIMB   alt,+8202
         6 002261   400000 401760                    pmme    nvectors=1
         6 002262   002264 702000 6                  TSX2    SPPRIV_ERR

      865    14090    4           DO WHILE( '0'B ) ;

  14090  6 002263   002276 710000 6                  TRA     s:14099

  14089  6 002264                       SPPRIV_ERR   null
      866    14091    4   SPPRIV_ERR:  ;                          /* Doesn't have that processor PRIV   */
      867    14092    4                CALL ERR_PROC(44);         /* Yell at him                        */

  14092  6 002264   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002265   000001 235000 xsym               LDA     B_VECTNIL+1
         6 002266   203370 757100                    STAQ    @ELAB,,AUTO
         6 002267   000073 236000 7                  LDQ     59
         6 002270   203367 756100                    STQ     @CODE,,AUTO
         6 002271   001655 701000 6                  TSX1    ERR_PROC
         6 002272   000000 011000                    NOP     0

      868    14093        /*E*  ERROR:    ARA-00044
      869    14094              MESSAGE: You do not have the privilege needed to run RATES.
      870    14095
      871    14096        */
      872    14097    4                IF '1'B THEN UNWIND TO ERROR_EXIT; /* Odd compiler               */

  14097  6 002273   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 002274   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 002275   000000 000200                    ZERO    0,128

      873    14098    4                END;                       /* DO WHILE('0'B)                     */

      874    14099    3           CALL CONCAT (LO_OUT_BUF,'** RATES ',B_VERSION.TEXT,' HERE **');

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:161  
  14099  6 002276   000000 236000 xsym               LDQ     B_VERSION
         6 002277   000033 772000                    QRL     27
         6 002300   040000 100400                    MLR     fill='040'O
         6 002301   000257 000011 2                  ADSC9   VBND+13                  cn=0,n=9
         6 002302   000070 000011 1                  ADSC9   LO_OUT_BUF               cn=0,n=9
         6 002303   000000 620006                    EAX0    0,QL
         6 002304   040000 100440                    MLR     fill='040'O
         6 002305   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         6 002306   000072 200173 1                  ADSC9   LO_OUT_BUF+2             cn=1,n=123
         6 002307   000173 116007                    CMPQ    123,DL
         6 002310   002316 603000 6                  TRC     s:14101
         6 002311   777604 621006                    EAX1    -124,QL
         6 002312   777777 661003                    ERX1    -1,DU
         6 002313   040046 100400                    MLR     fill='040'O
         6 002314   000266 000010 2                  ADSC9   VBND+20                  cn=0,n=8
         6 002315   000072 200011 1                  ADSC9   LO_OUT_BUF+2,Q           cn=1,n=*X1

      875    14100    3           END;

      876    14101    2      CALL M$WRITE(FPT_WRITE_LO);          /* Greet the user                     */

  14101  6 002316   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 002317   040001 713400                    CLIMB   write
         6 002320   401400 401760                    pmme    nvectors=4

      877    14102    2      IF TEST_MODE=0 THEN

  14102  6 002321   000554 235000 1                  LDA     TEST_MODE
         6 002322   002326 601000 6                  TNZ     s:14104

      878    14103    2           CALL M$SPRIV (FPT_PRIV);        /* Turn on FMSEC to open :RATES       */

  14103  6 002323   000564 630400 1                  EPPR0   FPT_PRIV
         6 002324   020012 713400                    CLIMB   8202
         6 002325   400000 401760                    pmme    nvectors=1

      879    14104    2      CALL M$OPEN(B$RATE_OPEN_FPT)
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:162  

  14104  6 002326   000132 630400 1                  EPPR0   B$RATE_OPEN_FPT
         6 002327   450000 713400                    CLIMB   alt,open
         6 002330   410400 401760                    pmme    nvectors=18
         6 002331   002333 702000 6                  TSX2    s:14106
         6 002332   002350 710000 6                  TRA     s:14110

      880    14105    3      WHENALTRETURN DO;

      881    14106    3           CALL M$RPRIV (FPT_PRIV);

  14106  6 002333   000564 630400 1                  EPPR0   FPT_PRIV
         6 002334   020013 713400                    CLIMB   8203
         6 002335   400000 401760                    pmme    nvectors=1

      882    14107    3           CALL ERR_PROC(MONERR);

  14107  6 002336   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002337   000001 235000 xsym               LDA     B_VECTNIL+1
         6 002340   203370 757100                    STAQ    @ELAB,,AUTO
         6 002341   000007 236000 7                  LDQ     7
         6 002342   203367 756100                    STQ     @CODE,,AUTO
         6 002343   001655 701000 6                  TSX1    ERR_PROC
         6 002344   000000 011000                    NOP     0

      883    14108    3           UNWIND TO ERROR_EXIT;

  14108  6 002345   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 002346   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 002347   000000 000200                    ZERO    0,128

      884    14109    3           END;
      885    14110    2      CALL M$RPRIV (FPT_PRIV);             /* ...and turn off FMSEC forevermore  */

  14110  6 002350   000564 630400 1                  EPPR0   FPT_PRIV
         6 002351   020013 713400                    CLIMB   8203
         6 002352   400000 401760                    pmme    nvectors=1
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:163  

      886    14111    2      CALL CHECK_DEFAULTS;

  14111  6 002353   000361 701000 6                  TSX1    CHECK_DEFAULTS
         6 002354   000000 011000                    NOP     0

      887    14112    2      M$SI$ = DCBADDR(DCBNUM(M$SI));

  14112  6 002355   000000 236007 xsym               LDQ     M$SI,DL
         6 002356   000052 470400 7                  LDP0    42
         6 002357   000000 471500                    LDP1    0,,PR0
         6 002360   100000 236106                    LDQ     0,QL,PR1
         6 002361   200004 756100                    STQ     M$SI$,,AUTO

      888    14113    2      RETURN;

  14113  6 002362   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 002363   000001 702211                    TSX2  ! 1,X1

      889    14114    2   END INITIALIZE;
      890    14115        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:164  
      891    14116    1   LIST_: PROC;                            /* PROCEDURE TO PROCESS LIST CMD      */

  14116  6 002364   200010 741300       LIST_        STX1  ! ERROR_EXIT+2,,AUTO

      892    14117    2   DCL RET_VAL SBIN WORD;
      893    14118    2   DCL CUR_NODE$ PTR;
      894    14119    2   DCL KEY_QUAL_TEXTC$ PTR;
      895    14120    2   DCL REC_TYPE_CODE SBIN WORD;
      896    14121    2   DCL IN_KEY$ PTR;
      897    14122    2      LO_OUT_BUF = ' ';

  14122  6 002365   040000 100400                    MLR     fill='040'O
         6 002366   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002367   000070 000204 1                  ADSC9   LO_OUT_BUF               cn=0,n=132

      898    14123    2      IN_KEY$ = ADDR(IN_KEY);

  14123  6 002370   000010 236000 7                  LDQ     8
         6 002371   200015 756100                    STQ     IN_KEY$,,AUTO

      899    14124    2      REC_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;

  14124  6 002372   200003 470500                    LDP0    PCB,,AUTO
         6 002373   000003 471500                    LDP1    3,,PR0
         6 002374   100000 236100                    LDQ     0,,PR1
         6 002375   777777 376007                    ANQ     -1,DL
         6 002376   200014 756100                    STQ     REC_TYPE_CODE,,AUTO

      900    14125    2      IF REC_TYPE_CODE = ALL

  14125  6 002377   000015 116007                    CMPQ    13,DL
         6 002400   002432 601000 6                  TNZ     s:14137

      901    14126    2      THEN
      902    14127    3      DO;

      903    14128    3           CALL LIST_ALL(SCHED_CODE);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:165  

  14128  6 002401   000022 236000 7                  LDQ     18
         6 002402   200017 756100                    STQ     NUM_RECS,,AUTO
         6 002403   002546 701000 6                  TSX1    LIST_ALL
         6 002404   000000 011000                    NOP     0

      904    14129    3           CALL LIST_ALL(PROC_CODE);

  14129  6 002405   000021 236000 7                  LDQ     17
         6 002406   200017 756100                    STQ     NUM_RECS,,AUTO
         6 002407   002546 701000 6                  TSX1    LIST_ALL
         6 002410   000000 011000                    NOP     0

      905    14130    3           CALL LIST_ALL(FORM_CODE);

  14130  6 002411   000074 236000 7                  LDQ     60
         6 002412   200017 756100                    STQ     NUM_RECS,,AUTO
         6 002413   002546 701000 6                  TSX1    LIST_ALL
         6 002414   000000 011000                    NOP     0

      906    14131    3           CALL LIST_ALL(RATE_CODE);

  14131  6 002415   000006 236000 7                  LDQ     6
         6 002416   200017 756100                    STQ     NUM_RECS,,AUTO
         6 002417   002546 701000 6                  TSX1    LIST_ALL
         6 002420   000000 011000                    NOP     0

      907    14132    3           CALL LIST_ALL(LCP6_CODE);

  14132  6 002421   000014 236000 7                  LDQ     12
         6 002422   200017 756100                    STQ     NUM_RECS,,AUTO
         6 002423   002546 701000 6                  TSX1    LIST_ALL
         6 002424   000000 011000                    NOP     0

      908    14133    3           CALL LIST_ALL(COMM_CODE);

  14133  6 002425   000075 236000 7                  LDQ     61
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:166  
         6 002426   200017 756100                    STQ     NUM_RECS,,AUTO
         6 002427   002546 701000 6                  TSX1    LIST_ALL
         6 002430   000000 011000                    NOP     0

      909    14134    3           END;

  14134  6 002431   002544 710000 6                  TRA     s:14171

      910    14135
      911    14136    3      ELSE DO;

      912    14137    3           CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);

  14137  6 002432   000003 471500                    LDP1    3,,PR0
         6 002433   100003 236100                    LDQ     3,,PR1
         6 002434   200012 756100                    STQ     CUR_NODE$,,AUTO

      913    14138                                                /* POINTS TO KEY QUALIFYING NODE      */
      914    14139    3           IF CUR_NODE$->RPT$BLK.CODE = ALL

  14139  6 002435   200012 473500                    LDP3    CUR_NODE$,,AUTO
         6 002436   300000 720100                    LXL0    0,,PR3
         6 002437   000015 100003                    CMPX0   13,DU
         6 002440   002446 601000 6                  TNZ     s:14143

      915    14140    3           THEN CALL LIST_ALL(REC_TYPE_CODE);

  14140  6 002441   200014 634500                    EPPR4   REC_TYPE_CODE,,AUTO
         6 002442   200017 454500                    STP4    NUM_RECS,,AUTO
         6 002443   002546 701000 6                  TSX1    LIST_ALL
         6 002444   000000 011000                    NOP     0
         6 002445   002544 710000 6                  TRA     s:14171

      916    14141
      917    14142    4           ELSE DO;

      918    14143    4                IF CUR_NODE$->RPT$BLK.CODE = DEFAULT
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:167  

  14143  6 002446   000016 100003                    CMPX0   14,DU
         6 002447   002453 601000 6                  TNZ     s:14145

      919    14144    4                THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);

  14144  6 002450   000002 236000 7                  LDQ     2
         6 002451   200013 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO
         6 002452   002455 710000 6                  TRA     s:14147

      920    14145    4                ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);

  14145  6 002453   300003 236100                    LDQ     3,,PR3
         6 002454   200013 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO

      921    14146
      922    14147    4                CALL FORM_KEY(RET_VAL,

  14147  6 002455   200013 631500                    EPPR1   KEY_QUAL_TEXTC$,,AUTO
         6 002456   203352 451500                    STP1    @KEY_QUAL_TEXTC$,,AUTO
         6 002457   000010 236000 7                  LDQ     8
         6 002460   203351 756100                    STQ     @KEY_TEXTC,,AUTO
         6 002461   200014 634500                    EPPR4   REC_TYPE_CODE,,AUTO
         6 002462   203350 454500                    STP4    @REC_TYPE,,AUTO
         6 002463   200011 635500                    EPPR5   RET_VAL,,AUTO
         6 002464   203347 455500                    STP5    @REC_TYPE,,AUTO
         6 002465   001716 701000 6                  TSX1    FORM_KEY
         6 002466   000000 011000                    NOP     0

      923    14148    4                  REC_TYPE_CODE,
      924    14149    4                  IN_KEY,
      925    14150    4                  KEY_QUAL_TEXTC$);
      926    14151    4                IF RET_VAL = NORM_RET

  14151  6 002467   200011 235100                    LDA     RET_VAL,,AUTO
         6 002470   000001 115007                    CMPA    1,DL
         6 002471   002544 601000 6                  TNZ     s:14171
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:168  

      927    14152    5                THEN DO;

      928    14153    5                     CALL READ_B$RATE(RET_VAL,%YES#,IN_KEY);

  14153  6 002472   000012 237000 7                  LDAQ    10
         6 002473   203350 757100                    STAQ    @REC_TYPE,,AUTO
         6 002474   200011 630500                    EPPR0   RET_VAL,,AUTO
         6 002475   203347 450500                    STP0    @REC_TYPE,,AUTO
         6 002476   004404 701000 6                  TSX1    READ_B$RATE
         6 002477   000000 011000                    NOP     0

      929    14154    5                     IF RET_VAL = NORM_RET

  14154  6 002500   200011 235100                    LDA     RET_VAL,,AUTO
         6 002501   000001 115007                    CMPA    1,DL
         6 002502   002514 601000 6                  TNZ     s:14159

      930    14155    6                     THEN DO;

      931    14156    6                          CALL OUT_HDR(REC_TYPE_CODE);

  14156  6 002503   200014 630500                    EPPR0   REC_TYPE_CODE,,AUTO
         6 002504   200025 450500                    STP0    REC_BUF$+1,,AUTO
         6 002505   002753 701000 6                  TSX1    OUT_HDR
         6 002506   000000 011000                    NOP     0

      932    14157    6                          CALL LIST_ONE(REC_TYPE_CODE);

  14157  6 002507   200014 630500                    EPPR0   REC_TYPE_CODE,,AUTO
         6 002510   200025 450500                    STP0    REC_BUF$+1,,AUTO
         6 002511   002716 701000 6                  TSX1    LIST_ONE
         6 002512   000000 011000                    NOP     0

      933    14158    6                          END;

  14158  6 002513   002544 710000 6                  TRA     s:14171
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:169  

      934    14159    5                     ELSE IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

  14159  6 002514   000000 470400 xsym               LDP0    B$TCB$
         6 002515   000000 471500                    LDP1    0,,PR0
         6 002516   100102 236100                    LDQ     66,,PR1
         6 002517   377770 376007                    ANQ     131064,DL
         6 002520   001020 116007                    CMPQ    528,DL
         6 002521   002532 601000 6                  TNZ     s:14163

      935    14160    5                          THEN CALL ERR_PROC(MONERR);

  14160  6 002522   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002523   000001 235000 xsym               LDA     B_VECTNIL+1
         6 002524   203370 757100                    STAQ    @ELAB,,AUTO
         6 002525   000007 236000 7                  LDQ     7
         6 002526   203367 756100                    STQ     @CODE,,AUTO
         6 002527   001655 701000 6                  TSX1    ERR_PROC
         6 002530   000000 011000                    NOP     0
         6 002531   002544 710000 6                  TRA     s:14171

      936    14161                                                /* CAN'T LIST, RECORD NOT FOUND       */
      937    14162    6                          ELSE DO;

      938    14163    6                               CALL ERR_PROC(MONERR);

  14163  6 002532   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002533   000001 235000 xsym               LDA     B_VECTNIL+1
         6 002534   203370 757100                    STAQ    @ELAB,,AUTO
         6 002535   000007 236000 7                  LDQ     7
         6 002536   203367 756100                    STQ     @CODE,,AUTO
         6 002537   001655 701000 6                  TSX1    ERR_PROC
         6 002540   000000 011000                    NOP     0

      939    14164                                                /* READ ERROR OTHER THAN              */
      940    14165                                                /* 'RECORD NOT FOUND'                 */
      941    14166    6                               UNWIND TO ERROR_EXIT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:170  

  14166  6 002541   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 002542   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 002543   000000 000200                    ZERO    0,128

      942    14167    6                               END;
      943    14168    5                     END;
      944    14169    4                END;
      945    14170    3           END;
      946    14171    2      RETURN;

  14171  6 002544   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 002545   000001 702211                    TSX2  ! 1,X1

      947    14172        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:171  
      948    14173    2   LIST_ALL: PROC(TABLE_TYPE);

  14173  6 002546   200016 741300       LIST_ALL     STX1  ! DCB$,,AUTO

      949    14174    3   DCL TABLE_TYPE SBIN WORD;
      950    14175    3   DCL RET_VAL SBIN WORD;
      951    14176    3   DCL TBL_PFX CHAR(4);
      952    14177    3   DCL FIRST_TIME SBIN WORD;
      953    14178    3      FIRST_TIME = TRUE;

  14178  6 002547   000001 235007                    LDA     1,DL
         6 002550   200022 755100                    STA     FIRST_TIME,,AUTO

      954    14179    3      IN_KEY.LEN = 4;

  14179  6 002551   004000 236003                    LDQ     2048,DU
         6 002552   000532 552040 1                  STBQ    IN_KEY,'40'O

      955    14180    4      DO CASE(TABLE_TYPE);

  14180  6 002553   200017 470500                    LDP0    @TABLE_TYPE,,AUTO
         6 002554   000000 235100                    LDA     0,,PR0
         6 002555   000007 115007                    CMPA    7,DL
         6 002556   002560 602005 6                  TNC     s:14180+5,AL
         6 002557   002610 710000 6                  TRA     s:14194
         6 002560   002610 710000 6                  TRA     s:14194
         6 002561   002600 710000 6                  TRA     s:14188
         6 002562   002575 710000 6                  TRA     s:14186
         6 002563   002572 710000 6                  TRA     s:14184
         6 002564   002567 710000 6                  TRA     s:14182
         6 002565   002603 710000 6                  TRA     s:14190
         6 002566   002606 710000 6                  TRA     s:14192

      956    14181    4       CASE(FORM_CODE);

      957    14182    4         TBL_PFX = 'FORM';

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:172  
  14182  6 002567   000254 236000 2                  LDQ     VBND+10
         6 002570   200021 756100                    STQ     TBL_PFX,,AUTO
         6 002571   002610 710000 6                  TRA     s:14194

      958    14183    4       CASE(PROC_CODE);

      959    14184    4         TBL_PFX = 'PROC';

  14184  6 002572   000252 236000 2                  LDQ     VBND+8
         6 002573   200021 756100                    STQ     TBL_PFX,,AUTO
         6 002574   002610 710000 6                  TRA     s:14194

      960    14185    4       CASE(RATE_CODE);

      961    14186    4         TBL_PFX = 'RATE';

  14186  6 002575   000251 236000 2                  LDQ     VBND+7
         6 002576   200021 756100                    STQ     TBL_PFX,,AUTO
         6 002577   002610 710000 6                  TRA     s:14194

      962    14187    4       CASE(SCHED_CODE);

      963    14188    4         TBL_PFX = 'SCHE';

  14188  6 002600   000253 236000 2                  LDQ     VBND+9
         6 002601   200021 756100                    STQ     TBL_PFX,,AUTO
         6 002602   002610 710000 6                  TRA     s:14194

      964    14189    4       CASE(LCP6_CODE);

      965    14190    4         TBL_PFX = 'RATE';

  14190  6 002603   000251 236000 2                  LDQ     VBND+7
         6 002604   200021 756100                    STQ     TBL_PFX,,AUTO
         6 002605   002610 710000 6                  TRA     s:14194

      966    14191    4       CASE(COMM_CODE);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:173  

      967    14192    4         TBL_PFX = 'COMM';

  14192  6 002606   000255 236000 2                  LDQ     VBND+11
         6 002607   200021 756100                    STQ     TBL_PFX,,AUTO

      968    14193    4         END;                              /* END CASE                           */

      969    14194    3      IN_KEY.STRING = TBL_PFX;

  14194  6 002610   040000 100500                    MLR     fill='040'O
         6 002611   200021 000004                    ADSC9   TBL_PFX,,AUTO            cn=0,n=4
         6 002612   000532 200043 1                  ADSC9   IN_KEY                   cn=1,n=35

      970    14195    3      CALL M$PRECORD_CALL;

  14195  6 002613   003720 701000 6                  TSX1    M$PRECORD_CALL
         6 002614   000000 011000                    NOP     0

      971    14196    4      DO WHILE(1=1);                       /* DO FOREVER                         */

      972    14197    4           IN_KEY.STRING = TBL_PFX;

  14197  6 002615   040000 100500                    MLR     fill='040'O
         6 002616   200021 000004                    ADSC9   TBL_PFX,,AUTO            cn=0,n=4
         6 002617   000532 200043 1                  ADSC9   IN_KEY                   cn=1,n=35

      973    14198    4           CALL READ_B$RATE(RET_VAL,%NO#,IN_KEY);

  14198  6 002620   000024 237000 7                  LDAQ    20
         6 002621   203350 757100                    STAQ    @REC_TYPE,,AUTO
         6 002622   200020 630500                    EPPR0   RET_VAL,,AUTO
         6 002623   203347 450500                    STP0    @REC_TYPE,,AUTO
         6 002624   004404 701000 6                  TSX1    READ_B$RATE
         6 002625   000000 011000                    NOP     0

      974    14199    4           IF RET_VAL = ALT_RET
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:174  

  14199  6 002626   200020 235100                    LDA     RET_VAL,,AUTO
         6 002627   002652 601000 6                  TNZ     s:14208

      975    14200    4           THEN
      976    14201    4                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF

  14201  6 002630   000000 470400 xsym               LDP0    B$TCB$
         6 002631   000000 471500                    LDP1    0,,PR0
         6 002632   100102 236100                    LDQ     66,,PR1
         6 002633   377770 376007                    ANQ     131064,DL
         6 002634   000060 116007                    CMPQ    48,DL
         6 002635   002640 601000 6                  TNZ     s:14204

      977    14202    4                THEN RETURN;

  14202  6 002636   200016 221300                    LDX1  ! DCB$,,AUTO
         6 002637   000001 702211                    TSX2  ! 1,X1

      978    14203    5                ELSE DO;

      979    14204    5                     CALL ERR_PROC(MONERR); /* NON-EOF ERROR ON SEQUENTIAL       */

  14204  6 002640   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002641   000001 235000 xsym               LDA     B_VECTNIL+1
         6 002642   203370 757100                    STAQ    @ELAB,,AUTO
         6 002643   000007 236000 7                  LDQ     7
         6 002644   203367 756100                    STQ     @CODE,,AUTO
         6 002645   001655 701000 6                  TSX1    ERR_PROC
         6 002646   000000 011000                    NOP     0

      980    14205    5                     UNWIND TO ERROR_EXIT; /* READ                               */

  14205  6 002647   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 002650   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 002651   000000 000200                    ZERO    0,128

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:175  
      981    14206    5                     END;
      982    14207    4           ELSE
      983    14208    4                IF SUBSTR(IN_KEY.STRING,0,4) = TBL_PFX

  14208  6 002652   040100 106400                    CMPC    fill='040'O
         6 002653   000532 200004 1                  ADSC9   IN_KEY                   cn=1,n=4
         6 002654   200021 000004                    ADSC9   TBL_PFX,,AUTO            cn=0,n=4
         6 002655   002713 601000 6                  TNZ     s:14221

      984    14209    5                THEN DO;

      985    14210    5                     IF TBL_PFX='RATE'

  14210  6 002656   200021 236100                    LDQ     TBL_PFX,,AUTO
         6 002657   000251 116000 2                  CMPQ    VBND+7
         6 002660   002676 601000 6                  TNZ     s:14214

      986    14211    5                     THEN IF REC_BUF$->RATE$TBL.LCP6#

  14211  6 002661   000015 470400 2                  LDP0    REC_BUF$
         6 002662   000000 236100                    LDQ     0,,PR0
         6 002663   200000 316003                    CANQ    65536,DU
         6 002664   002672 600000 6                  TZE     s:14213

      987    14212    5                          THEN IF TABLE_TYPE~=LCP6_CODE THEN EXIT; ELSE;

  14212  6 002665   200017 471500                    LDP1    @TABLE_TYPE,,AUTO
         6 002666   100000 235100                    LDA     0,,PR1
         6 002667   000005 115007                    CMPA    5,DL
         6 002670   002712 601000 6                  TNZ     s:14220
         6 002671   002676 710000 6                  TRA     s:14214

      988    14213    5                          ELSE IF TABLE_TYPE~=RATE_CODE THEN EXIT;

  14213  6 002672   200017 471500                    LDP1    @TABLE_TYPE,,AUTO
         6 002673   100000 235100                    LDA     0,,PR1
         6 002674   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:176  
         6 002675   002712 601000 6                  TNZ     s:14220

      989    14214    5                     IF FIRST_TIME = TRUE

  14214  6 002676   200022 235100                    LDA     FIRST_TIME,,AUTO
         6 002677   000001 115007                    CMPA    1,DL
         6 002700   002706 601000 6                  TNZ     s:14219

      990    14215    6                     THEN DO;

      991    14216    6                          CALL OUT_HDR(TABLE_TYPE);

  14216  6 002701   200017 236100                    LDQ     @TABLE_TYPE,,AUTO
         6 002702   200025 756100                    STQ     REC_BUF$+1,,AUTO
         6 002703   002753 701000 6                  TSX1    OUT_HDR
         6 002704   000000 011000                    NOP     0

      992    14217    6                          FIRST_TIME = FALSE;

  14217  6 002705   200022 450100                    STZ     FIRST_TIME,,AUTO

      993    14218    6                          END;

      994    14219    5                     CALL LIST_ONE(TABLE_TYPE);

  14219  6 002706   200017 236100                    LDQ     @TABLE_TYPE,,AUTO
         6 002707   200025 756100                    STQ     REC_BUF$+1,,AUTO
         6 002710   002716 701000 6                  TSX1    LIST_ONE
         6 002711   000000 011000                    NOP     0

      995    14220    5                     END;

  14220  6 002712   002715 710000 6                  TRA     s:14222

      996    14221    4                ELSE RETURN;

  14221  6 002713   200016 221300                    LDX1  ! DCB$,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:177  
         6 002714   000001 702211                    TSX2  ! 1,X1

      997    14222    4           END;                            /* END FOREVER                        */

  14222  6 002715   002615 710000 6                  TRA     s:14197

      998    14223    3   END LIST_ALL;
      999    14224        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:178  
     1000    14225    2   LIST_ONE: PROC(TABLE_TYPE);

  14225  6 002716   200024 741300       LIST_ONE     STX1  ! INDX+1,,AUTO

     1001    14226    3   DCL TABLE_TYPE SBIN WORD;
     1002    14227    4      DO CASE(TABLE_TYPE);

  14227  6 002717   200025 470500                    LDP0    @TABLE_TYPE,,AUTO
         6 002720   000000 235100                    LDA     0,,PR0
         6 002721   000007 115007                    CMPA    7,DL
         6 002722   002724 602005 6                  TNC     s:14227+5,AL
         6 002723   002751 710000 6                  TRA     s:14239
         6 002724   002751 710000 6                  TRA     s:14239
         6 002725   002736 710000 6                  TRA     s:14231
         6 002726   002741 710000 6                  TRA     s:14233
         6 002727   002736 710000 6                  TRA     s:14231
         6 002730   002733 710000 6                  TRA     s:14229
         6 002731   002744 710000 6                  TRA     s:14235
         6 002732   002747 710000 6                  TRA     s:14237

     1003    14228    4       CASE(FORM_CODE);

     1004    14229    4         CALL LIST_FORM;

  14229  6 002733   003015 701000 6                  TSX1    LIST_FORM
         6 002734   000000 011000                    NOP     0
         6 002735   002751 710000 6                  TRA     s:14239

     1005    14230    4       CASE(PROC_CODE,SCHED_CODE);

     1006    14231    4         CALL LIST_PROC_SCHED;

  14231  6 002736   003070 701000 6                  TSX1    LIST_PROC_SCHED
         6 002737   000000 011000                    NOP     0
         6 002740   002751 710000 6                  TRA     s:14239

     1007    14232    4       CASE(RATE_CODE);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:179  

     1008    14233    4         CALL LIST_RATE;

  14233  6 002741   003146 701000 6                  TSX1    LIST_RATE
         6 002742   000000 011000                    NOP     0
         6 002743   002751 710000 6                  TRA     s:14239

     1009    14234    4       CASE(LCP6_CODE);

     1010    14235    4         CALL LIST_LCP6;

  14235  6 002744   003244 701000 6                  TSX1    LIST_LCP6
         6 002745   000000 011000                    NOP     0
         6 002746   002751 710000 6                  TRA     s:14239

     1011    14236    4       CASE(COMM_CODE);

     1012    14237    4         CALL LIST_COMM;

  14237  6 002747   003566 701000 6                  TSX1    LIST_COMM
         6 002750   000000 011000                    NOP     0

     1013    14238    4         END;                              /*END CASE                            */

     1014    14239    3      RETURN;

  14239  6 002751   200024 221300                    LDX1  ! INDX+1,,AUTO
         6 002752   000001 702211                    TSX2  ! 1,X1

     1015    14240    3   END LIST_ONE;
     1016    14241        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:180  
     1017    14242    2   OUT_HDR: PROC(TABLE_TYPE);

  14242  6 002753   200024 741300       OUT_HDR      STX1  ! INDX+1,,AUTO

     1018    14243    3   DCL TABLE_TYPE SBIN WORD;
     1019    14244    3   DCL I SBIN;
     1020    14245    3   DCL 1 HDR_TXT CONSTANT,
     1021    14246    3         2 FRM(0:1) CHAR(60) INIT(
     1022    14247    3   'TABLE              FORM RATE           MOUNT RATE',
     1023    14248    3   '==========         ==================  =================='),
     1024    14249    3         2 ELS(0:1) CHAR(52) INIT(
     1025    14250    3   'TABLE                               RTABLE     INFO',
     1026    14251    3   '=======                             ========== ====');
     1027    14252    4      DO I=0 TO 1;

  14252  6 002754   200026 450100                    STZ     I,,AUTO

     1028    14253    4           IF TABLE_TYPE=FORM_CODE THEN SUBSTR(LO_OUT_BUF,4) = HDR_TXT.FRM(I);

  14253  6 002755   200025 470500                    LDP0    @TABLE_TYPE,,AUTO
         6 002756   000000 235100                    LDA     0,,PR0
         6 002757   000004 115007                    CMPA    4,DL
         6 002760   002767 601000 6                  TNZ     s:14255

  14253  6 002761   200026 236100                    LDQ     I,,AUTO
         6 002762   000074 402007                    MPY     60,DL
         6 002763   040000 100406                    MLR     fill='040'O
         6 002764   000030 000074 2                  ADSC9   HDR_TXT,Q                cn=0,n=60
         6 002765   000071 000200 1                  ADSC9   LO_OUT_BUF+1             cn=0,n=128
         6 002766   003004 710000 6                  TRA     s:14259

     1029    14254    5           ELSE DO;

     1030    14255    5                SUBSTR(LO_OUT_BUF,4) = HDR_TXT.ELS(I);

  14255  6 002767   200026 236100                    LDQ     I,,AUTO
         6 002770   000064 402007                    MPY     52,DL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:181  
         6 002771   040000 100406                    MLR     fill='040'O
         6 002772   000066 000064 2                  ADSC9   HDR_TXT+30,Q             cn=0,n=52
         6 002773   000071 000200 1                  ADSC9   LO_OUT_BUF+1             cn=0,n=128

     1031    14256    5                IF TABLE_TYPE=PROC_CODE OR TABLE_TYPE=SCHED_CODE THEN EXIT;

  14256  6 002774   000000 235100                    LDA     0,,PR0
         6 002775   000003 115007                    CMPA    3,DL
         6 002776   003004 600000 6                  TZE     s:14259
         6 002777   000001 115007                    CMPA    1,DL
         6 003000   003004 600000 6                  TZE     s:14259

     1032    14257    5                SUBSTR(LO_OUT_BUF,14) = ' ';

  14257  6 003001   040000 100400                    MLR     fill='040'O
         6 003002   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003003   000073 400166 1                  ADSC9   LO_OUT_BUF+3             cn=2,n=118

     1033    14258    5                END;

     1034    14259    4           CALL M$WRITE(FPT_WRITE_LO);

  14259  6 003004   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003005   040001 713400                    CLIMB   write
         6 003006   401400 401760                    pmme    nvectors=4

     1035    14260    4           END;

  14260  6 003007   200026 054100                    AOS     I,,AUTO
         6 003010   200026 235100                    LDA     I,,AUTO
         6 003011   000001 115007                    CMPA    1,DL
         6 003012   002755 604400 6                  TMOZ    s:14253

     1036    14261    3      RETURN;

  14261  6 003013   200024 221300                    LDX1  ! INDX+1,,AUTO
         6 003014   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:182  

     1037    14262    3   END OUT_HDR;
     1038    14263        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:183  
     1039    14264    2   LIST_FORM: PROC;

  14264  6 003015   200026 741300       LIST_FORM    STX1  ! I,,AUTO

     1040    14265    3   DCL FORM_RATE_VAL CHAR(19);
     1041    14266    3   DCL FMOUNT_RATE_VAL CHAR(19);
     1042    14267    3   DCL TEMP BIT(72) DALIGNED;
     1043    14268    3      TEMP = REC_BUF$->FORM$TBL.FORM#;

  14268  6 003016   000015 470400 2                  LDP0    REC_BUF$
         6 003017   000000 237100                    LDAQ    0,,PR0
         6 003020   200042 757100                    STAQ    TEMP,,AUTO

     1044    14269    3      CALL PACKED_TO_CHAR(TEMP,FORM_RATE_VAL);

  14269  6 003021   200027 631500                    EPPR1   FORM_RATE_VAL,,AUTO
         6 003022   200046 451500                    STP1    NUM$,,AUTO
         6 003023   200042 633500                    EPPR3   TEMP,,AUTO
         6 003024   200045 453500                    STP3    @PACKED_NUM,,AUTO
         6 003025   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003026   000000 011000                    NOP     0

     1045    14270    3      TEMP = REC_BUF$->FORM$TBL.FMOUNT#;

  14270  6 003027   000015 470400 2                  LDP0    REC_BUF$
         6 003030   000002 237100                    LDAQ    2,,PR0
         6 003031   200042 757100                    STAQ    TEMP,,AUTO

     1046    14271    3      CALL PACKED_TO_CHAR(TEMP,FMOUNT_RATE_VAL);

  14271  6 003032   200034 631500                    EPPR1   FMOUNT_RATE_VAL,,AUTO
         6 003033   200046 451500                    STP1    NUM$,,AUTO
         6 003034   200042 633500                    EPPR3   TEMP,,AUTO
         6 003035   200045 453500                    STP3    @PACKED_NUM,,AUTO
         6 003036   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003037   000000 011000                    NOP     0

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:184  
     1047    14272    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),

  14272  6 003040   000532 235000 1                  LDA     IN_KEY
         6 003041   000533 236000 1                  LDQ     IN_KEY+1
         6 003042   000033 773000                    LRL     27
         6 003043   000027 376000 xsym               ANQ     B_VECTNIL+23
         6 003044   000071 756000 1                  STQ     LO_OUT_BUF+1
         6 003045   040000 236003                    LDQ     16384,DU
         6 003046   000072 552040 1                  STBQ    LO_OUT_BUF+2,'40'O
         6 003047   040000 100400                    MLR     fill='040'O
         6 003050   000533 200014 1                  ADSC9   IN_KEY+1                 cn=1,n=12
         6 003051   000072 200173 1                  ADSC9   LO_OUT_BUF+2             cn=1,n=123

     1048    14273    3        SUBSTR(IN_KEY.STRING,0,4),
     1049    14274    3        ' ',
     1050    14275    3        SUBSTR(IN_KEY.STRING,4,12));
     1051    14276    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,21),

  14276  6 003052   000040 236003                    LDQ     32,DU
         6 003053   000075 552020 1                  STBQ    LO_OUT_BUF+5,'20'O
         6 003054   040000 100500                    MLR     fill='040'O
         6 003055   200027 000023                    ADSC9   FORM_RATE_VAL,,AUTO      cn=0,n=19
         6 003056   000075 400023 1                  ADSC9   LO_OUT_BUF+5             cn=2,n=19
         6 003057   000102 552020 1                  STBQ    LO_OUT_BUF+10,'20'O
         6 003060   040000 100500                    MLR     fill='040'O
         6 003061   200034 000023                    ADSC9   FMOUNT_RATE_VAL,,AUTO    cn=0,n=19
         6 003062   000102 400132 1                  ADSC9   LO_OUT_BUF+10            cn=2,n=90

     1052    14277    3        ' ',
     1053    14278    3        FORM_RATE_VAL,
     1054    14279    3        ' ',
     1055    14280    3        FMOUNT_RATE_VAL);
     1056    14281    3      CALL M$WRITE(FPT_WRITE_LO);

  14281  6 003063   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003064   040001 713400                    CLIMB   write
         6 003065   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:185  

     1057    14282    3      RETURN;

  14282  6 003066   200026 221300                    LDX1  ! I,,AUTO
         6 003067   000001 702211                    TSX2  ! 1,X1

     1058    14283    3   END LIST_FORM;
     1059    14284        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:186  
     1060    14285    2   LIST_PROC_SCHED: PROC;

  14285  6 003070   200026 741300       LIST_PROC_S* STX1  ! I,,AUTO

     1061    14286    3   DCL I SBIN WORD;
     1062    14287    3   DCL INSPEC_VAL(0:2) CHAR(17);
     1063    14288    3   DCL RTABLE_FIELD CHAR(37) STATIC INIT('RATE        ');
     1064    14289    3   DCL 1 RTABLE_FLD REDEF RTABLE_FIELD,
     1065    14290    3         2 * CHAR(4),
     1066    14291    3         2 R# CHAR(31),
     1067    14292    3         2 * CHAR(2);
     1068    14293    4      DO I = 0 TO 2;

  14293  6 003071   200027 450100                    STZ     I,,AUTO

     1069    14294    4           INSPEC_VAL(I) = REC_BUF$->PROC$TBL.INSPEC#(I);

  14294  6 003072   200027 235100                    LDA     I,,AUTO
         6 003073   000004 735000                    ALS     4
         6 003074   200027 236100                    LDQ     I,,AUTO
         6 003075   203374 755100                    STA     TEMP_ERR+2,,AUTO
         6 003076   000021 402007                    MPY     17,DL
         6 003077   000015 470400 2                  LDP0    REC_BUF$
         6 003100   203374 235100                    LDA     TEMP_ERR+2,,AUTO
         6 003101   040106 100505                    MLR     fill='040'O
         6 003102   000002 000020                    ADSC9   2,A,PR0                  cn=0,n=16
         6 003103   200030 000021                    ADSC9   INSPEC_VAL,Q,AUTO        cn=0,n=17

     1070    14295    4           END;

  14295  6 003104   200027 054100                    AOS     I,,AUTO
         6 003105   200027 235100                    LDA     I,,AUTO
         6 003106   000002 115007                    CMPA    2,DL
         6 003107   003072 604400 6                  TMOZ    s:14294

     1071    14296    3      RTABLE_FLD.R# = REC_BUF$->PROC$TBL.RTABLE#;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:187  
  14296  6 003110   040000 100500                    MLR     fill='040'O
         6 003111   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         6 003112   000571 000037 1                  ADSC9   RTABLE_FIELD+1           cn=0,n=31

     1072    14297    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),

  14297  6 003113   000532 235000 1                  LDA     IN_KEY
         6 003114   000533 236000 1                  LDQ     IN_KEY+1
         6 003115   000033 773000                    LRL     27
         6 003116   000027 376000 xsym               ANQ     B_VECTNIL+23
         6 003117   000071 756000 1                  STQ     LO_OUT_BUF+1
         6 003120   040000 236003                    LDQ     16384,DU
         6 003121   000072 552040 1                  STBQ    LO_OUT_BUF+2,'40'O
         6 003122   040000 100400                    MLR     fill='040'O
         6 003123   000533 200037 1                  ADSC9   IN_KEY+1                 cn=1,n=31
         6 003124   000072 200173 1                  ADSC9   LO_OUT_BUF+2             cn=1,n=123

     1073    14298    3        SUBSTR(IN_KEY.STRING,0,4),
     1074    14299    3        ' ',
     1075    14300    3        SUBSTR(IN_KEY.STRING,4));
     1076    14301    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,40),

  14301  6 003125   040000 100400                    MLR     fill='040'O
         6 003126   000570 000013 1                  ADSC9   RTABLE_FIELD             cn=0,n=11
         6 003127   000102 000013 1                  ADSC9   LO_OUT_BUF+10            cn=0,n=11
         6 003130   040000 100500                    MLR     fill='040'O
         6 003131   200030 000021                    ADSC9   INSPEC_VAL,,AUTO         cn=0,n=17
         6 003132   000104 600021 1                  ADSC9   LO_OUT_BUF+12            cn=3,n=17
         6 003133   040000 100500                    MLR     fill='040'O
         6 003134   200034 200021                    ADSC9   FMOUNT_RATE_VAL,,AUTO    cn=1,n=17
         6 003135   000111 000021 1                  ADSC9   LO_OUT_BUF+17            cn=0,n=17
         6 003136   040000 100500                    MLR     fill='040'O
         6 003137   200040 400021                    ADSC9   T_NAME+3,,AUTO           cn=2,n=17
         6 003140   000115 200057 1                  ADSC9   LO_OUT_BUF+21            cn=1,n=47

     1077    14302    3        SUBSTR(RTABLE_FIELD,0,11),
     1078    14303    3        INSPEC_VAL(0),
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:188  
     1079    14304    3        INSPEC_VAL(1),
     1080    14305    3        INSPEC_VAL(2));
     1081    14306    3      CALL M$WRITE(FPT_WRITE_LO);

  14306  6 003141   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003142   040001 713400                    CLIMB   write
         6 003143   401400 401760                    pmme    nvectors=4

     1082    14307    3      RETURN;

  14307  6 003144   200026 221300                    LDX1  ! I,,AUTO
         6 003145   000001 702211                    TSX2  ! 1,X1

     1083    14308    3   END LIST_PROC_SCHED;
     1084    14309        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:189  
     1085    14310    2   LIST_RATE: PROC;

  14310  6 003146   200026 741300       LIST_RATE    STX1  ! I,,AUTO

     1086    14311    3   DCL I SBIN WORD;
     1087    14312    3   DCL YES_NO CHAR(3);
     1088    14313    3   DCL INDX CHAR(1);
     1089    14314    3   DCL 1 CTL_INFO DALIGNED,
     1090    14315    3         2 NDX UBIN(9) CALIGNED,
     1091    14316    3         2 NAME CHAR(7);
     1092    14317    3   DCL 1 CTL$INFO(0:0) BASED DALIGNED,
     1093    14318    3         2 NDX UBIN(9) CALIGNED,
     1094    14319    3         2 NAME CHAR(7);
     1095    14320        %MACRO CTL_INFO (NAME=' ',NDX=CMULT_CODE, LAST(YES=";",NO=",")=",");
     1096    14321              2 * UBIN(9) CALIGNED INIT(%(NDX-CMULT_CODE)),
     1097    14322              2 * CHAR(7) INIT(NAME) LAST
     1098    14323        %MEND;
     1099    14324
     1100    14325    3   DCL 1 RATE_INFO CONSTANT DALIGNED,
     1101    14326        %CTL_INFO (NAME='PEXEC', NDX=PEXEC_CODE);
     1102    14330        %CTL_INFO (NAME='FCPU', NDX=FCPU_CODE);
     1103    14334        %CTL_INFO (NAME='UEXEC', NDX=UEXEC_CODE);
     1104    14338        %CTL_INFO (NAME='TCPU', NDX=TCPU_CODE);
     1105    14342        %CTL_INFO (NAME='PSTIME', NDX=PSTIME_CODE);
     1106    14346        %CTL_INFO (NAME='OCPU', NDX=OCPU_CODE);
     1107    14350        %CTL_INFO (NAME='USTIME', NDX=USTIME_CODE);
     1108    14354        %CTL_INFO (NAME='FCLOCK', NDX=FCLOCK_CODE);
     1109    14358        %CTL_INFO (NAME='PMEM', NDX=PMEM_CODE);
     1110    14362        %CTL_INFO (NAME='TCLOCK', NDX=TCLOCK_CODE);
     1111    14366        %CTL_INFO (NAME='UMEM', NDX=UMEM_CODE);
     1112    14370        %CTL_INFO (NAME='OCLOCK', NDX=OCLOCK_CODE);
     1113    14374        %CTL_INFO (NAME='CONNECT', NDX=CONNECT_CODE);
     1114    14378        %CTL_INFO (NAME='FACCESS', NDX=FACCESS_CODE);
     1115    14382        %CTL_INFO (NAME='TINTER', NDX=TINTER_CODE);
     1116    14386        %CTL_INFO (NAME='TACCESS', NDX=TACCESS_CODE);
     1117    14390        %CTL_INFO (NAME='PMMES', NDX=PMME_CODE);
     1118    14394        %CTL_INFO (NAME='OACCESS', NDX=OACCESS_CODE);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:190  
     1119    14398        %CTL_INFO (NAME='FMOUNT', NDX=FMOUNT_CODE);
     1120    14402        %CTL_INFO (NAME='JSTEPS', NDX=JSTEPS_CODE);
     1121    14406        %CTL_INFO (NAME='TMOUNT', NDX=TMOUNT_CODE);
     1122    14410        %CTL_INFO (NAME='TPACK', NDX=TPACK_CODE);
     1123    14414        %CTL_INFO (NAME='OMOUNT', NDX=OMOUNT_CODE);
     1124    14418        %CTL_INFO (LAST=YES);
     1125    14422
     1126    14423    3   DCL 1 LCP6_INFO CONSTANT DALIGNED,
     1127    14424        %CTL_INFO (NAME='PEXEC', NDX=PEXEC_CODE);
     1128    14428        %CTL_INFO (NAME='MCLS', NDX=MCLS_CODE);
     1129    14432        %CTL_INFO (NAME='UEXEC', NDX=UEXEC_CODE);
     1130    14436        %CTL_INFO (NAME='INTS', NDX=FEPINT_CODE);
     1131    14440        %CTL_INFO (NAME='PSTIME', NDX=PSTIME_CODE);
     1132    14444        %CTL_INFO (NAME='JSTEPS', NDX=JSTEPS_CODE);
     1133    14448        %CTL_INFO (NAME='USTIME', NDX=USTIME_CODE);
     1134    14452        %CTL_INFO (NAME='CONNECT', NDX=CONNECT_CODE);
     1135    14456        %CTL_INFO (NAME='PMEM', NDX=PMEM_CODE);
     1136    14460        %CTL_INFO (NAME='UMEM', NDX=UMEM_CODE);
     1137    14464        %CTL_INFO (NAME='TINTER', NDX=TINTER_CODE);
     1138    14468        %CTL_INFO (NAME='HACCESS', NDX=HACCESS_CODE);
     1139    14472        %CTL_INFO (LAST=YES);
     1140    14476
     1141    14477    3      CALL LIST_JSUNIT;

  14477  6 003147   003342 701000 6                  TSX1    LIST_JSUNIT
         6 003150   000000 011000                    NOP     0

     1142    14478
     1143    14479    3      I = 0;

  14479  6 003151   200027 450100                    STZ     I,,AUTO

     1144    14480    4      DO WHILE '1'B;

     1145    14481    4           CTL_INFO = ADDR(RATE_INFO)->CTL$INFO(I);

  14481  6 003152   200027 235100                    LDA     I,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:191  
         6 003153   000001 735000                    ALS     1
         6 003154   000120 237005 2                  LDAQ    RATE_INFO,AL
         6 003155   200032 757100                    STAQ    CTL_INFO,,AUTO

     1146    14482    4           IF CTL_INFO.NDX=0 THEN EXIT;

  14482  6 003156   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003157   777000 316003                    CANQ    -512,DU
         6 003160   003242 600000 6                  TZE     s:14496

     1147    14483    4           CALL INSERT (LO_OUT_BUF,5,,CTL_INFO.NAME,' =');

  14483  6 003161   040000 100500                    MLR     fill='040'O
         6 003162   200032 200007                    ADSC9   CTL_INFO,,AUTO           cn=1,n=7
         6 003163   000071 200007 1                  ADSC9   LO_OUT_BUF+1             cn=1,n=7
         6 003164   040000 100400                    MLR     fill='040'O
         6 003165   000270 000002 2                  ADSC9   VBND+22                  cn=0,n=2
         6 003166   000073 000170 1                  ADSC9   LO_OUT_BUF+3             cn=0,n=120

     1148    14484    4          CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.NDX),

  14484  6 003167   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003170   000033 772000                    QRL     27
         6 003171   000000 620006                    EAX0    0,QL
         6 003172   000076 236000 7                  LDQ     62
         6 003173   200046 756100                    STQ     NUM$,,AUTO
         6 003174   000000 636010                    EAQ     0,X0
         6 003175   000001 736000                    QLS     1
         6 003176   000061 036003                    ADLQ    49,DU
         6 003177   000015 036000 2                  ADLQ    REC_BUF$
         6 003200   200045 756100                    STQ     @PACKED_NUM,,AUTO
         6 003201   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003202   000000 011000                    NOP     0

     1149    14485    4             SUBSTR(LO_OUT_BUF,16,19));
     1150    14486    4           I = I + 1;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:192  
  14486  6 003203   200027 054100                    AOS     I,,AUTO

     1151    14487    4           CTL_INFO = ADDR(RATE_INFO)->CTL$INFO(I);

  14487  6 003204   200027 235100                    LDA     I,,AUTO
         6 003205   000001 735000                    ALS     1
         6 003206   000120 237005 2                  LDAQ    RATE_INFO,AL
         6 003207   200032 757100                    STAQ    CTL_INFO,,AUTO

     1152    14488    5           IF CTL_INFO.NDX>0 THEN DO;

  14488  6 003210   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003211   777000 316003                    CANQ    -512,DU
         6 003212   003236 600000 6                  TZE     s:14494

     1153    14489    5                CALL INSERT (LO_OUT_BUF,35,,CTL_INFO.NAME,' =');

  14489  6 003213   040000 100500                    MLR     fill='040'O
         6 003214   200032 200007                    ADSC9   CTL_INFO,,AUTO           cn=1,n=7
         6 003215   000100 600007 1                  ADSC9   LO_OUT_BUF+8             cn=3,n=7
         6 003216   040000 100400                    MLR     fill='040'O
         6 003217   000270 000002 2                  ADSC9   VBND+22                  cn=0,n=2
         6 003220   000102 400132 1                  ADSC9   LO_OUT_BUF+10            cn=2,n=90

     1154    14490    5               CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.
             14490                         NDX),

  14490  6 003221   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003222   000033 772000                    QRL     27
         6 003223   000000 620006                    EAX0    0,QL
         6 003224   000077 236000 7                  LDQ     63
         6 003225   200046 756100                    STQ     NUM$,,AUTO
         6 003226   000000 636010                    EAQ     0,X0
         6 003227   000001 736000                    QLS     1
         6 003230   000061 036003                    ADLQ    49,DU
         6 003231   000015 036000 2                  ADLQ    REC_BUF$
         6 003232   200045 756100                    STQ     @PACKED_NUM,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:193  
         6 003233   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003234   000000 011000                    NOP     0

     1155    14491    5                  SUBSTR(LO_OUT_BUF,46,19));
     1156    14492    5                I = I + 1;

  14492  6 003235   200027 054100                    AOS     I,,AUTO

     1157    14493    5                END;

     1158    14494    4           CALL M$WRITE(FPT_WRITE_LO);

  14494  6 003236   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003237   040001 713400                    CLIMB   write
         6 003240   401400 401760                    pmme    nvectors=4

     1159    14495    4           END;

  14495  6 003241   003152 710000 6                  TRA     s:14481

     1160    14496    3      RETURN;

  14496  6 003242   200026 221300                    LDX1  ! I,,AUTO
         6 003243   000001 702211                    TSX2  ! 1,X1

     1161    14497
     1162    14498        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:194  
     1163    14499        /*   LIST_LCP6 prints out the contents of a B$LCP6_RATE table.
     1164    14500        */
     1165    14501    3   LIST_LCP6: ENTRY;

  14501  6 003244   200026 741300       LIST_LCP6    STX1  ! I,,AUTO

     1166    14502
     1167    14503    3      CALL LIST_JSUNIT;

  14503  6 003245   003342 701000 6                  TSX1    LIST_JSUNIT
         6 003246   000000 011000                    NOP     0

     1168    14504
     1169    14505    3      I = 0;

  14505  6 003247   200027 450100                    STZ     I,,AUTO

     1170    14506    4      DO WHILE '1'B;

     1171    14507    4           CTL_INFO = ADDR(LCP6_INFO)->CTL$INFO(I);

  14507  6 003250   200027 235100                    LDA     I,,AUTO
         6 003251   000001 735000                    ALS     1
         6 003252   000200 237005 2                  LDAQ    LCP6_INFO,AL
         6 003253   200032 757100                    STAQ    CTL_INFO,,AUTO

     1172    14508    4           IF CTL_INFO.NDX=0 THEN EXIT;

  14508  6 003254   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003255   777000 316003                    CANQ    -512,DU
         6 003256   003340 600000 6                  TZE     s:14523

     1173    14509    4           CALL INSERT (LO_OUT_BUF,5,,CTL_INFO.NAME,' =');

  14509  6 003257   040000 100500                    MLR     fill='040'O
         6 003260   200032 200007                    ADSC9   CTL_INFO,,AUTO           cn=1,n=7
         6 003261   000071 200007 1                  ADSC9   LO_OUT_BUF+1             cn=1,n=7
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:195  
         6 003262   040000 100400                    MLR     fill='040'O
         6 003263   000270 000002 2                  ADSC9   VBND+22                  cn=0,n=2
         6 003264   000073 000170 1                  ADSC9   LO_OUT_BUF+3             cn=0,n=120

     1174    14510    4          CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.NDX),

  14510  6 003265   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003266   000033 772000                    QRL     27
         6 003267   000000 620006                    EAX0    0,QL
         6 003270   000076 236000 7                  LDQ     62
         6 003271   200046 756100                    STQ     NUM$,,AUTO
         6 003272   000000 636010                    EAQ     0,X0
         6 003273   000001 736000                    QLS     1
         6 003274   000061 036003                    ADLQ    49,DU
         6 003275   000015 036000 2                  ADLQ    REC_BUF$
         6 003276   200045 756100                    STQ     @PACKED_NUM,,AUTO
         6 003277   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003300   000000 011000                    NOP     0

     1175    14511    4             SUBSTR(LO_OUT_BUF,16,19));
     1176    14512    4           I = I + 1;

  14512  6 003301   200027 054100                    AOS     I,,AUTO

     1177    14513    4           CTL_INFO = ADDR(LCP6_INFO)->CTL$INFO(I);

  14513  6 003302   200027 235100                    LDA     I,,AUTO
         6 003303   000001 735000                    ALS     1
         6 003304   000200 237005 2                  LDAQ    LCP6_INFO,AL
         6 003305   200032 757100                    STAQ    CTL_INFO,,AUTO

     1178    14514    5           IF CTL_INFO.NDX>0 THEN DO;

  14514  6 003306   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003307   777000 316003                    CANQ    -512,DU
         6 003310   003334 600000 6                  TZE     s:14520

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:196  
     1179    14515    5                CALL INSERT (LO_OUT_BUF,35,,CTL_INFO.NAME,' =');

  14515  6 003311   040000 100500                    MLR     fill='040'O
         6 003312   200032 200007                    ADSC9   CTL_INFO,,AUTO           cn=1,n=7
         6 003313   000100 600007 1                  ADSC9   LO_OUT_BUF+8             cn=3,n=7
         6 003314   040000 100400                    MLR     fill='040'O
         6 003315   000270 000002 2                  ADSC9   VBND+22                  cn=0,n=2
         6 003316   000102 400132 1                  ADSC9   LO_OUT_BUF+10            cn=2,n=90

     1180    14516    5               CALL PACKED_TO_CHAR(ADDR(REC_BUF$->RATE$TBL.CMULT#)->CTL$INFO(CTL_INFO.
             14516                         NDX),

  14516  6 003317   200032 236100                    LDQ     CTL_INFO,,AUTO
         6 003320   000033 772000                    QRL     27
         6 003321   000000 620006                    EAX0    0,QL
         6 003322   000077 236000 7                  LDQ     63
         6 003323   200046 756100                    STQ     NUM$,,AUTO
         6 003324   000000 636010                    EAQ     0,X0
         6 003325   000001 736000                    QLS     1
         6 003326   000061 036003                    ADLQ    49,DU
         6 003327   000015 036000 2                  ADLQ    REC_BUF$
         6 003330   200045 756100                    STQ     @PACKED_NUM,,AUTO
         6 003331   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003332   000000 011000                    NOP     0

     1181    14517    5                  SUBSTR(LO_OUT_BUF,46,19));
     1182    14518    5                I = I + 1;

  14518  6 003333   200027 054100                    AOS     I,,AUTO

     1183    14519    5                END;

     1184    14520    4           CALL M$WRITE(FPT_WRITE_LO);

  14520  6 003334   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003335   040001 713400                    CLIMB   write
         6 003336   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:197  

     1185    14521    4           END;

  14521  6 003337   003250 710000 6                  TRA     s:14507

     1186    14522
     1187    14523    3      RETURN;

  14523  6 003340   200026 221300                    LDX1  ! I,,AUTO
         6 003341   000001 702211                    TSX2  ! 1,X1

     1188    14524        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:198  
     1189    14525
     1190    14526        /*   LIST_JSUNIT prints the JUNIT and SUNIT information for the
     1191    14527           LIST_RATE and LIST_LCP6 routines.
     1192    14528        */
     1193    14529
     1194    14530    3   LIST_JSUNIT: PROC;

  14530  6 003342   200034 741300       LIST_JSUNIT  STX1  ! FMOUNT_RATE_VAL,,AUTO

     1195    14531    4      IF REC_BUF$->RATE$TBL.PERCENT#

  14531  6 003343   000015 470400 2                  LDP0    REC_BUF$
         6 003344   000000 234100                    SZN     0,,PR0
         6 003345   003353 605000 6                  TPL     s:14533

     1196    14532    4      THEN YES_NO = 'YES';

  14532  6 003346   000271 236000 2                  LDQ     VBND+23
         6 003347   000100 376000 7                  ANQ     64
         6 003350   000040 276007                    ORQ     32,DL
         6 003351   200030 756100                    STQ     YES_NO,,AUTO
         6 003352   003357 710000 6                  TRA     s:14535

     1197    14533    4      ELSE YES_NO = 'NO';

  14533  6 003353   000272 236000 2                  LDQ     VBND+24
         6 003354   777777 376003                    ANQ     -1,DU
         6 003355   040040 276007                    ORQ     16416,DL
         6 003356   200030 756100                    STQ     YES_NO,,AUTO

     1198    14534
     1199    14535    4      CALL INDEX(I,' ',IN_KEY.STRING);

  14535  6 003357   000000 124400                    SCM     mask='000'O
         6 003360   000532 200043 1                  ADSC9   IN_KEY                   cn=1,n=35
         6 003361   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003362   200027 000100                    ARG     I,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:199  

     1200    14536    4      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),

  14536  6 003363   000532 235000 1                  LDA     IN_KEY
         6 003364   000533 236000 1                  LDQ     IN_KEY+1
         6 003365   000033 773000                    LRL     27
         6 003366   000027 376000 xsym               ANQ     B_VECTNIL+23
         6 003367   000071 756000 1                  STQ     LO_OUT_BUF+1
         6 003370   040000 236003                    LDQ     16384,DU
         6 003371   000072 552040 1                  STBQ    LO_OUT_BUF+2,'40'O
         6 003372   200027 720100                    LXL0    I,,AUTO
         6 003373   777774 622010                    EAX2    -4,X0
         6 003374   040000 100440                    MLR     fill='040'O
         6 003375   000533 200012 1                  ADSC9   IN_KEY+1                 cn=1,n=*X2
         6 003376   000072 200173 1                  ADSC9   LO_OUT_BUF+2             cn=1,n=123

     1201    14537    4        SUBSTR(IN_KEY.STRING,0,4),
     1202    14538    4        ' ',
     1203    14539    4        SUBSTR(IN_KEY.STRING,4,I-4));
     1204    14540    4      CALL CONCAT(SUBSTR(LO_OUT_BUF,I+5),

  14540  6 003377   200027 720100                    LXL0    I,,AUTO
         6 003400   777600 620010                    EAX0    -128,X0
         6 003401   777777 660003                    ERX0    -1,DU
         6 003402   200027 235100                    LDA     I,,AUTO
         6 003403   040045 100400                    MLR     fill='040'O
         6 003404   000273 000011 2                  ADSC9   VBND+25                  cn=0,n=9
         6 003405   000071 200010 1                  ADSC9   LO_OUT_BUF+1,A           cn=1,n=*X0
         6 003406   200027 236100                    LDQ     I,,AUTO
         6 003407   000166 116007                    CMPQ    118,DL
         6 003410   003434 605000 6                  TPL     s:14545
         6 003411   777611 621006                    EAX1    -119,QL
         6 003412   777777 661003                    ERX1    -1,DU
         6 003413   040046 100400                    MLR     fill='040'O
         6 003414   000276 000012 2                  ADSC9   VBND+28                  cn=0,n=10
         6 003415   000073 400011 1                  ADSC9   LO_OUT_BUF+3,Q           cn=2,n=*X1
         6 003416   000154 116007                    CMPQ    108,DL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:200  
         6 003417   003434 605000 6                  TPL     s:14545
         6 003420   777623 622006                    EAX2    -109,QL
         6 003421   777777 662003                    ERX2    -1,DU
         6 003422   040046 100500                    MLR     fill='040'O
         6 003423   200030 000003                    ADSC9   YES_NO,,AUTO             cn=0,n=3
         6 003424   000076 000012 1                  ADSC9   LO_OUT_BUF+6,Q           cn=0,n=*X2
         6 003425   000151 116007                    CMPQ    105,DL
         6 003426   003434 605000 6                  TPL     s:14545
         6 003427   777626 623006                    EAX3    -106,QL
         6 003430   777777 663003                    ERX3    -1,DU
         6 003431   040046 100400                    MLR     fill='040'O
         6 003432   000301 000011 2                  ADSC9   VBND+31                  cn=0,n=9
         6 003433   000076 600013 1                  ADSC9   LO_OUT_BUF+6,Q           cn=3,n=*X3

     1205    14541    4        '         ',
     1206    14542    4        'PERCENT = ',
     1207    14543    4        YES_NO,
     1208    14544    4        ' CMULT = ');
     1209    14545    4      CALL PACKED_TO_CHAR(REC_BUF$->RATE$TBL.CMULT#,SUBSTR(LO_OUT_BUF,I+36,19));

  14545  6 003434   000020 736000                    QLS     16
         6 003435   000101 036000 7                  ADLQ    65
         6 003436   200046 756100                    STQ     NUM$,,AUTO
         6 003437   000015 236000 2                  LDQ     REC_BUF$
         6 003440   000061 036003                    ADLQ    49,DU
         6 003441   200045 756100                    STQ     @PACKED_NUM,,AUTO
         6 003442   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003443   000000 011000                    NOP     0

     1210    14546    4      CALL M$WRITE(FPT_WRITE_LO);

  14546  6 003444   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003445   040001 713400                    CLIMB   write
         6 003446   401400 401760                    pmme    nvectors=4

     1211    14547
     1212    14548    4      LO_OUT_BUF = ' ';
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:201  

  14548  6 003447   040000 100400                    MLR     fill='040'O
         6 003450   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003451   000070 000204 1                  ADSC9   LO_OUT_BUF               cn=0,n=132

     1213    14549    5      DO I = 0 TO 3;

  14549  6 003452   200027 450100                    STZ     I,,AUTO

     1214    14550    5           CALL CONCAT(SUBSTR(LO_OUT_BUF,7),

  14550  6 003453   200027 236100                    LDQ     I,,AUTO
         6 003454   000061 036007                    ADLQ    49,DL
         6 003455   000033 736000                    QLS     27
         6 003456   000102 276000 7                  ORQ     66
         6 003457   203374 756100                    STQ     TEMP_ERR+2,,AUTO
         6 003460   200027 236100                    LDQ     I,,AUTO
         6 003461   000030 402007                    MPY     24,DL
         6 003462   000015 470400 2                  LDP0    REC_BUF$
         6 003463   040000 100506                    MLR     fill='040'O
         6 003464   000001 000020                    ADSC9   1,Q,PR0                  cn=0,n=16
         6 003465   000071 600020 1                  ADSC9   LO_OUT_BUF+1             cn=3,n=16
         6 003466   040000 100400                    MLR     fill='040'O
         6 003467   000304 000007 2                  ADSC9   VBND+34                  cn=0,n=7
         6 003470   000075 600007 1                  ADSC9   LO_OUT_BUF+5             cn=3,n=7
         6 003471   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 003472   000022 772000                    QRL     18
         6 003473   000077 552010 1                  STBQ    LO_OUT_BUF+7,'10'O
         6 003474   040000 100400                    MLR     fill='040'O
         6 003475   000270 000002 2                  ADSC9   VBND+22                  cn=0,n=2
         6 003476   000077 600145 1                  ADSC9   LO_OUT_BUF+7             cn=3,n=101

     1215    14551    5             REC_BUF$->RATE$TBL.JUNIT.NAME#(I),
     1216    14552    5             '  JUNIT',
     1217    14553    5             BINASC(I+49),
     1218    14554    5             ' =');
     1219    14555    5           CALL PACKED_TO_CHAR(REC_BUF$->RATE$TBL.JUNIT.RATE#(I),
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:202  

  14555  6 003477   000103 236000 7                  LDQ     67
         6 003500   200046 756100                    STQ     NUM$,,AUTO
         6 003501   200027 236100                    LDQ     I,,AUTO
         6 003502   000006 402003                    MPY     6,DU
         6 003503   000005 036003                    ADLQ    5,DU
         6 003504   000015 036000 2                  ADLQ    REC_BUF$
         6 003505   200045 756100                    STQ     @PACKED_NUM,,AUTO
         6 003506   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003507   000000 011000                    NOP     0

     1220    14556    5             SUBSTR(LO_OUT_BUF,33,19));
     1221    14557    5           CALL M$WRITE(FPT_WRITE_LO);

  14557  6 003510   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003511   040001 713400                    CLIMB   write
         6 003512   401400 401760                    pmme    nvectors=4

     1222    14558    5           END;

  14558  6 003513   200027 054100                    AOS     I,,AUTO
         6 003514   200027 235100                    LDA     I,,AUTO
         6 003515   000003 115007                    CMPA    3,DL
         6 003516   003453 604400 6                  TMOZ    s:14550

     1223    14559
     1224    14560    5      DO I = 0 TO 3;

  14560  6 003517   200027 450100                    STZ     I,,AUTO

     1225    14561    5           CALL CONCAT(SUBSTR(LO_OUT_BUF,7),

  14561  6 003520   200027 236100                    LDQ     I,,AUTO
         6 003521   000061 036007                    ADLQ    49,DL
         6 003522   000033 736000                    QLS     27
         6 003523   000102 276000 7                  ORQ     66
         6 003524   203374 756100                    STQ     TEMP_ERR+2,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:203  
         6 003525   200027 236100                    LDQ     I,,AUTO
         6 003526   000030 402007                    MPY     24,DL
         6 003527   000015 470400 2                  LDP0    REC_BUF$
         6 003530   040000 100506                    MLR     fill='040'O
         6 003531   000031 000020                    ADSC9   25,Q,PR0                 cn=0,n=16
         6 003532   000071 600020 1                  ADSC9   LO_OUT_BUF+1             cn=3,n=16
         6 003533   040000 100400                    MLR     fill='040'O
         6 003534   000306 000007 2                  ADSC9   VBND+36                  cn=0,n=7
         6 003535   000075 600007 1                  ADSC9   LO_OUT_BUF+5             cn=3,n=7
         6 003536   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 003537   000022 772000                    QRL     18
         6 003540   000077 552010 1                  STBQ    LO_OUT_BUF+7,'10'O
         6 003541   040000 100400                    MLR     fill='040'O
         6 003542   000270 000002 2                  ADSC9   VBND+22                  cn=0,n=2
         6 003543   000077 600145 1                  ADSC9   LO_OUT_BUF+7             cn=3,n=101

     1226    14562    5             REC_BUF$->RATE$TBL.SUNIT.NAME#(I),
     1227    14563    5             '  SUNIT',
     1228    14564    5             BINASC(I+49),
     1229    14565    5             ' =');
     1230    14566    5           CALL PACKED_TO_CHAR(REC_BUF$->RATE$TBL.SUNIT.RATE#(I),

  14566  6 003544   000103 236000 7                  LDQ     67
         6 003545   200046 756100                    STQ     NUM$,,AUTO
         6 003546   200027 236100                    LDQ     I,,AUTO
         6 003547   000006 402003                    MPY     6,DU
         6 003550   000035 036003                    ADLQ    29,DU
         6 003551   000015 036000 2                  ADLQ    REC_BUF$
         6 003552   200045 756100                    STQ     @PACKED_NUM,,AUTO
         6 003553   003750 701000 6                  TSX1    PACKED_TO_CHAR
         6 003554   000000 011000                    NOP     0

     1231    14567    5             SUBSTR(LO_OUT_BUF,33,19));
     1232    14568    5           CALL M$WRITE(FPT_WRITE_LO);

  14568  6 003555   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003556   040001 713400                    CLIMB   write
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:204  
         6 003557   401400 401760                    pmme    nvectors=4

     1233    14569    5           END;

  14569  6 003560   200027 054100                    AOS     I,,AUTO
         6 003561   200027 235100                    LDA     I,,AUTO
         6 003562   000003 115007                    CMPA    3,DL
         6 003563   003520 604400 6                  TMOZ    s:14561

     1234    14570
     1235    14571    4      RETURN;

  14571  6 003564   200034 221300                    LDX1  ! FMOUNT_RATE_VAL,,AUTO
         6 003565   000001 702211                    TSX2  ! 1,X1

     1236    14572    4   END LIST_JSUNIT;
     1237    14573    3   END LIST_RATE;
     1238    14574        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:205  
     1239    14575
     1240    14576        /*   LIST_COMM prints the information from a B$COMM_TBL record.
     1241    14577        */
     1242    14578
     1243    14579    2   LIST_COMM: PROC;

  14579  6 003566   200026 741300       LIST_COMM    STX1  ! I,,AUTO

     1244    14580
     1245    14581    3      LO_OUT_BUF = ' ';

  14581  6 003567   040000 100400                    MLR     fill='040'O
         6 003570   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003571   000070 000204 1                  ADSC9   LO_OUT_BUF               cn=0,n=132

     1246    14582    3      CALL CONCAT(SUBSTR(LO_OUT_BUF,4),

  14582  6 003572   000532 235000 1                  LDA     IN_KEY
         6 003573   000533 236000 1                  LDQ     IN_KEY+1
         6 003574   000033 773000                    LRL     27
         6 003575   000027 376000 xsym               ANQ     B_VECTNIL+23
         6 003576   000071 756000 1                  STQ     LO_OUT_BUF+1
         6 003577   040000 236003                    LDQ     16384,DU
         6 003600   000072 552040 1                  STBQ    LO_OUT_BUF+2,'40'O
         6 003601   040000 100400                    MLR     fill='040'O
         6 003602   000533 200037 1                  ADSC9   IN_KEY+1                 cn=1,n=31
         6 003603   000072 200173 1                  ADSC9   LO_OUT_BUF+2             cn=1,n=123

     1247    14583    3        SUBSTR(IN_KEY.STRING,0,4),
     1248    14584    3        ' ',
     1249    14585    3        SUBSTR(IN_KEY.STRING,4));
     1250    14586
     1251    14587    3      CALL M$WRITE(FPT_WRITE_LO);

  14587  6 003604   000054 630400 1                  EPPR0   FPT_WRITE_LO
         6 003605   040001 713400                    CLIMB   write
         6 003606   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:206  

     1252    14588    3      RETURN;

  14588  6 003607   200026 221300                    LDX1  ! I,,AUTO
         6 003610   000001 702211                    TSX2  ! 1,X1

     1253    14589
     1254    14590    3   END LIST_COMM;
     1255    14591    2   END LIST_;
     1256    14592        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:207  
     1257    14593    1   MODIFY: PROC;                           /* PROCEDURE TO PROCESS MODIFY        */

  14593  6 003611   200010 741300       MODIFY       STX1  ! ERROR_EXIT+2,,AUTO

     1258    14594                                                /* COMMAND                            */
     1259    14595    2   DCL RET_VAL SBIN WORD;
     1260    14596    2   DCL CUR_NODE$ PTR;
     1261    14597    2   DCL KEY_QUAL_TEXTC$ PTR;
     1262    14598    2   DCL REC_TYPE_CODE SBIN WORD;
     1263    14599    2      REC_TYPE_CODE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;

  14599  6 003612   200003 470500                    LDP0    PCB,,AUTO
         6 003613   000003 471500                    LDP1    3,,PR0
         6 003614   100000 236100                    LDQ     0,,PR1
         6 003615   777777 376007                    ANQ     -1,DL
         6 003616   200014 756100                    STQ     REC_TYPE_CODE,,AUTO

     1264    14600
     1265    14601    2      CUR_NODE$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);

  14601  6 003617   000003 471500                    LDP1    3,,PR0
         6 003620   100003 236100                    LDQ     3,,PR1
         6 003621   200012 756100                    STQ     CUR_NODE$,,AUTO

     1266    14602                                                /* POINTS TO KEY QUALIFYING NODE      */
     1267    14603    2      IF CUR_NODE$->RPT$BLK.CODE = DEFAULT

  14603  6 003622   200012 473500                    LDP3    CUR_NODE$,,AUTO
         6 003623   300000 720100                    LXL0    0,,PR3
         6 003624   000016 100003                    CMPX0   14,DU
         6 003625   003631 601000 6                  TNZ     s:14605

     1268    14604    2      THEN KEY_QUAL_TEXTC$ = ADDR(DEFAULT_KEY_QUAL_TEXTC);

  14604  6 003626   000002 236000 7                  LDQ     2
         6 003627   200013 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO
         6 003630   003633 710000 6                  TRA     s:14606
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:208  

     1269    14605    2      ELSE KEY_QUAL_TEXTC$ = CUR_NODE$->RPT$BLK.SUB_BLK$(0);

  14605  6 003631   300003 236100                    LDQ     3,,PR3
         6 003632   200013 756100                    STQ     KEY_QUAL_TEXTC$,,AUTO

     1270    14606    2      CALL FORM_KEY(RET_VAL,

  14606  6 003633   200013 631500                    EPPR1   KEY_QUAL_TEXTC$,,AUTO
         6 003634   203352 451500                    STP1    @KEY_QUAL_TEXTC$,,AUTO
         6 003635   000003 236000 7                  LDQ     3
         6 003636   203351 756100                    STQ     @KEY_TEXTC,,AUTO
         6 003637   200014 634500                    EPPR4   REC_TYPE_CODE,,AUTO
         6 003640   203350 454500                    STP4    @REC_TYPE,,AUTO
         6 003641   200011 635500                    EPPR5   RET_VAL,,AUTO
         6 003642   203347 455500                    STP5    @REC_TYPE,,AUTO
         6 003643   001716 701000 6                  TSX1    FORM_KEY
         6 003644   000000 011000                    NOP     0

     1271    14607    2        REC_TYPE_CODE,
     1272    14608    2        OUT_KEY,
     1273    14609    2        KEY_QUAL_TEXTC$);
     1274    14610    2      IF RET_VAL = NORM_RET

  14610  6 003645   200011 235100                    LDA     RET_VAL,,AUTO
         6 003646   000001 115007                    CMPA    1,DL
         6 003647   003716 601000 6                  TNZ     s:14624

     1275    14611    3      THEN DO;

     1276    14612    3           CALL READ_B$RATE(RET_VAL,%YES#,OUT_KEY);

  14612  6 003650   000004 237000 7                  LDAQ    4
         6 003651   203350 757100                    STAQ    @REC_TYPE,,AUTO
         6 003652   200011 630500                    EPPR0   RET_VAL,,AUTO
         6 003653   203347 450500                    STP0    @REC_TYPE,,AUTO
         6 003654   004404 701000 6                  TSX1    READ_B$RATE
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:209  
         6 003655   000000 011000                    NOP     0

     1277    14613    3           IF RET_VAL = NORM_RET

  14613  6 003656   200011 235100                    LDA     RET_VAL,,AUTO
         6 003657   000001 115007                    CMPA    1,DL
         6 003660   003666 601000 6                  TNZ     s:14617

     1278    14614    3           THEN
     1279    14615    3                CALL UPDATE_TBL (REC_TYPE_CODE);

  14615  6 003661   200014 630500                    EPPR0   REC_TYPE_CODE,,AUTO
         6 003662   200021 450500                    STP0    TBL_PFX,,AUTO
         6 003663   005240 701000 6                  TSX1    UPDATE_TBL
         6 003664   000000 011000                    NOP     0
         6 003665   003716 710000 6                  TRA     s:14624

     1280    14616    3           ELSE
     1281    14617    3                IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY

  14617  6 003666   000000 470400 xsym               LDP0    B$TCB$
         6 003667   000000 471500                    LDP1    0,,PR0
         6 003670   100102 236100                    LDQ     66,,PR1
         6 003671   377770 376007                    ANQ     131064,DL
         6 003672   001020 116007                    CMPQ    528,DL
         6 003673   003704 601000 6                  TNZ     s:14620

     1282    14618    3                THEN CALL ERR_PROC(MONERR);

  14618  6 003674   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 003675   000001 235000 xsym               LDA     B_VECTNIL+1
         6 003676   203370 757100                    STAQ    @ELAB,,AUTO
         6 003677   000007 236000 7                  LDQ     7
         6 003700   203367 756100                    STQ     @CODE,,AUTO
         6 003701   001655 701000 6                  TSX1    ERR_PROC
         6 003702   000000 011000                    NOP     0
         6 003703   003716 710000 6                  TRA     s:14624
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:210  

     1283    14619    4                ELSE DO;

     1284    14620    4                     CALL ERR_PROC(MONERR);

  14620  6 003704   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 003705   000001 235000 xsym               LDA     B_VECTNIL+1
         6 003706   203370 757100                    STAQ    @ELAB,,AUTO
         6 003707   000007 236000 7                  LDQ     7
         6 003710   203367 756100                    STQ     @CODE,,AUTO
         6 003711   001655 701000 6                  TSX1    ERR_PROC
         6 003712   000000 011000                    NOP     0

     1285    14621    4                     UNWIND TO ERROR_EXIT;

  14621  6 003713   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 003714   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 003715   000000 000200                    ZERO    0,128

     1286    14622    4                     END;
     1287    14623    3           END;
     1288    14624    2      RETURN;

  14624  6 003716   200010 221300                    LDX1  ! ERROR_EXIT+2,,AUTO
         6 003717   000001 702211                    TSX2  ! 1,X1

     1289    14625    2   END MODIFY;
     1290    14626        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:211  
     1291    14627    1   M$PRECORD_CALL: PROC;

  14627  6 003720   203346 741300       M$PRECORD_C* STX1  ! EXIT_LOOP+1,,AUTO

     1292    14628    2      CALL M$PRECORD(FPT_PRECORD) ALTRET(PREC_ALT);

  14628  6 003721   000230 630400 1                  EPPR0   FPT_PRECORD
         6 003722   440003 713400                    CLIMB   alt,+16387
         6 003723   401000 401760                    pmme    nvectors=3
         6 003724   003726 702000 6                  TSX2    PREC_ALT

     1293    14629    3      DO WHILE('0'B);

  14629  6 003725   003746 710000 6                  TRA     DUMMY1

     1294    14630    3   PREC_ALT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY

  14630  6 003726   000000 470400 xsym  PREC_ALT     LDP0    B$TCB$
         6 003727   000000 471500                    LDP1    0,,PR0
         6 003730   100102 236100                    LDQ     66,,PR1
         6 003731   377770 376007                    ANQ     131064,DL
         6 003732   001020 116007                    CMPQ    528,DL
         6 003733   003746 600000 6                  TZE     DUMMY1

     1295    14631    3           THEN                            /* PRECORD error                      */
     1296    14632    4           DO;

     1297    14633    4                CALL ERR_PROC(MONERR);

  14633  6 003734   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 003735   000001 235000 xsym               LDA     B_VECTNIL+1
         6 003736   203370 757100                    STAQ    @ELAB,,AUTO
         6 003737   000007 236000 7                  LDQ     7
         6 003740   203367 756100                    STQ     @CODE,,AUTO
         6 003741   001655 701000 6                  TSX1    ERR_PROC
         6 003742   000000 011000                    NOP     0

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:212  
     1298    14634    4                UNWIND TO ERROR_EXIT;

  14634  6 003743   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 003744   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 003745   000000 000200                    ZERO    0,128

     1299    14635    4                END;
     1300    14636    3           ELSE ;                          /* It was just 'KEY NOT FOUND', OK    */
     1301    14637    3   DUMMY1: END;

  14637  6 003746                       DUMMY1       null
     1302    14638    2      RETURN;

  14638  6 003746   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 003747   000001 702211                    TSX2  ! 1,X1

     1303    14639    2   END M$PRECORD_CALL;
     1304    14640        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:213  
     1305    14641        /* THIS PROCEDURE CONVERTS A SIGNED, FLOATING POINT PACKED DECIMAL NUMBER     */
     1306    14642        /* (PACKED) TO A 19 CHARACTER STRING REPRESENTING THAT NUMBER(CHAR_BUF)       */
     1307    14643    1   PACKED_TO_CHAR: PROC(PACKED,CHAR_BUF);

  14643  6 003750   200044 741300       PACKED_TO_C* STX1  ! @VALUE$,,AUTO

     1308    14644    2   DCL 1 PACKED DALIGNED,
     1309    14645    2         2 * BIT(1),
     1310    14646    2         2 SIGN UBIN(4) UNAL,
     1311    14647    2         2 DIGITS BIT(58),
     1312    14648    2         2 * BIT(1),
     1313    14649    2         2 EXP UBIN(8) UNAL;
     1314    14650    2   DCL CHAR_BUF CHAR(19);
     1315    14651    2   DCL PRINT_LEN SBIN WORD;
     1316    14652    2   DCL TRAILING_ZEROES SBIN WORD;
     1317    14653    2   DCL FLIPPER SBIN WORD;
     1318    14654    2   DCL EXPONENT SBIN WORD;
     1319    14655    2   DCL I SBIN WORD;
     1320    14656    2   DCL DIGIT$ PTR;
     1321    14657    2   DCL 1 MANTISSA,
     1322    14658    2         2 LEN UBIN (9) UNAL,
     1323    14659    2         2 STRING CHAR(13),
     1324    14660    2         2 STRING_ARY(0:12) REDEF STRING,
     1325    14661    2           3 * UBIN(5) UNAL,
     1326    14662    2           3 NUM UBIN(4) UNAL;
     1327    14663    2   DCL ONE$NIBBLE UBIN(4) BASED UNAL;
     1328    14664    2      CHAR_BUF = ' ';                      /* BLANK OUT THE RECEIVING FIELD      */

  14664  6 003751   200046 470500                    LDP0    @CHAR_BUF,,AUTO
         6 003752   040100 100400                    MLR     fill='040'O
         6 003753   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003754   000000 000023                    ADSC9   0,,PR0                   cn=0,n=19

     1329    14665    2      MANTISSA.STRING = ZERO_STRING;       /* PREPARE FOR RECEIVING LOW          */

  14665  6 003755   040100 100400                    MLR     fill='040'O
         6 003756   000016 000015 2                  ADSC9   ZERO_STRING              cn=0,n=13
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:214  
         6 003757   200055 200015                    ADSC9   MANTISSA,,AUTO           cn=1,n=13

     1330    14666                                                /* NIBBLE OF NUMBER TO FORM CHARS*/
     1331    14667    2      MANTISSA.LEN = 0;

  14667  6 003760   000000 236003                    LDQ     0,DU
         6 003761   200055 552140                    STBQ    MANTISSA,'40'O,AUTO

     1332    14668    2      TRAILING_ZEROES = 0;

  14668  6 003762   200050 450100                    STZ     TRAILING_ZEROES,,AUTO

     1333    14669    2      FLIPPER = 0;

  14669  6 003763   200051 450100                    STZ     FLIPPER,,AUTO

     1334    14670    2      DIGIT$ = ADDR(PACKED.DIGITS);

  14670  6 003764   200045 236100                    LDQ     @PACKED,,AUTO
         6 003765   050000 036007                    ADLQ    20480,DL
         6 003766   200054 756100                    STQ     DIGIT$,,AUTO

     1335    14671    3      DO I = 1 TO 13;

  14671  6 003767   000001 235007                    LDA     1,DL
         6 003770   200053 755100                    STA     I,,AUTO

     1336    14672    3           IF DIGIT$->ONE$NIBBLE = 0

  14672  6 003771   200054 470500                    LDP0    DIGIT$,,AUTO
         6 003772   003100 061500                    CSR     bolr='003'O
         6 003773   000000 000004                    BDSC    0,,PR0                   by=0,bit=0,n=4
         6 003774   203374 000044                    BDSC    TEMP_ERR+2,,AUTO         by=0,bit=0,n=36
         6 003775   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 003776   000000 116003                    CMPQ    0,DU
         6 003777   004016 601000 6                  TNZ     s:14685

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:215  
     1337    14673    3           THEN
     1338    14674    3                IF MANTISSA.LEN > 0

  14674  6 004000   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004001   777000 316003                    CANQ    -512,DU
         6 004002   004030 600000 6                  TZE     s:14690

     1339    14675    3                THEN
     1340    14676    4                DO;

     1341    14677    4                     TRAILING_ZEROES = TRAILING_ZEROES + 1;

  14677  6 004003   200050 054100                    AOS     TRAILING_ZEROES,,AUTO

     1342    14678    4                     MANTISSA.STRING_ARY.NUM(MANTISSA.LEN) =

  14678  6 004004   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004005   000033 772000                    QRL     27
         6 004006   000011 402007                    MPY     9,DL
         6 004007   003106 060500                    CSL     bolr='003'O
         6 004010   000000 000004                    BDSC    0,,PR0                   by=0,bit=0,n=4
         6 004011   200055 250004                    BDSC    MANTISSA,Q,AUTO          by=1,bit=5,n=4

     1343    14679    4                       DIGIT$->ONE$NIBBLE;
     1344    14680    4                     MANTISSA.LEN = MANTISSA.LEN + 1;

  14680  6 004012   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004013   001000 036003                    ADLQ    512,DU
         6 004014   200055 552140                    STBQ    MANTISSA,'40'O,AUTO

     1345    14681    4                     END;

  14681  6 004015   004030 710000 6                  TRA     s:14690

     1346    14682    3                ELSE ;
     1347    14683    3           ELSE
     1348    14684    4           DO;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:216  

     1349    14685    4                TRAILING_ZEROES = 0;

  14685  6 004016   200050 450100                    STZ     TRAILING_ZEROES,,AUTO

     1350    14686    4                MANTISSA.STRING_ARY.NUM(MANTISSA.LEN) =

  14686  6 004017   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004020   000033 772000                    QRL     27
         6 004021   000011 402007                    MPY     9,DL
         6 004022   003106 060500                    CSL     bolr='003'O
         6 004023   000000 000004                    BDSC    0,,PR0                   by=0,bit=0,n=4
         6 004024   200055 250004                    BDSC    MANTISSA,Q,AUTO          by=1,bit=5,n=4

     1351    14687    4                  DIGIT$->ONE$NIBBLE;
     1352    14688    4                MANTISSA.LEN = MANTISSA.LEN + 1;

  14688  6 004025   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004026   001000 036003                    ADLQ    512,DU
         6 004027   200055 552140                    STBQ    MANTISSA,'40'O,AUTO

     1353    14689    4                END;

     1354    14690    3           FLIPPER = 1 - FLIPPER;

  14690  6 004030   000001 235007                    LDA     1,DL
         6 004031   200051 135100                    SBLA    FLIPPER,,AUTO
         6 004032   200051 755100                    STA     FLIPPER,,AUTO

     1355    14691    3           DIGIT$ = PINCRB(DIGIT$,4 + FLIPPER);

  14691  6 004033   000004 035007                    ADLA    4,DL
         6 004034   004036 605000 6                  TPL     s:14691+3
         6 004035   000044 035003                    ADLA    36,DU
         6 004036   000000 503505                    ABD     0,AL,PR0
         6 004037   200054 450500                    STP0    DIGIT$,,AUTO

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:217  
     1356    14692    3           END;

  14692  6 004040   200053 054100                    AOS     I,,AUTO
         6 004041   200053 235100                    LDA     I,,AUTO
         6 004042   000015 115007                    CMPA    13,DL
         6 004043   003771 604400 6                  TMOZ    s:14672

     1357    14693    2      MANTISSA.LEN = MANTISSA.LEN - TRAILING_ZEROES;

  14693  6 004044   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004045   000033 772000                    QRL     27
         6 004046   200050 136100                    SBLQ    TRAILING_ZEROES,,AUTO
         6 004047   000033 736000                    QLS     27
         6 004050   200055 552140                    STBQ    MANTISSA,'40'O,AUTO

     1358    14694    2      IF MANTISSA.LEN = 0

  14694  6 004051   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004052   777000 316003                    CANQ    -512,DU
         6 004053   004056 601000 6                  TNZ     s:14698

     1359    14695    2      THEN                                 /* IF NUMBER IS 0, THEN SET           */
     1360    14696    2           EXPONENT = 0;                   /* MAKE EXPONENT = 0                  */

  14696  6 004054   200052 450100                    STZ     EXPONENT,,AUTO
         6 004055   004071 710000 6                  TRA     s:14704

     1361    14697    2      ELSE
     1362    14698    2           IF PACKED.EXP > 128             /* IF NEGATIVE EXPONENT               */

  14698  6 004056   200045 471500                    LDP1    @PACKED,,AUTO
         6 004057   100001 236100                    LDQ     1,,PR1
         6 004060   000377 376007                    ANQ     255,DL
         6 004061   000201 116007                    CMPQ    129,DL
         6 004062   004067 602000 6                  TNC     s:14703

     1363    14699    2           THEN
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:218  
     1364    14700    2                EXPONENT = PACKED.EXP - 256 + TRAILING_ZEROES;

  14700  6 004063   200050 036100                    ADLQ    TRAILING_ZEROES,,AUTO
         6 004064   000400 136007                    SBLQ    256,DL
         6 004065   200052 756100                    STQ     EXPONENT,,AUTO
         6 004066   004071 710000 6                  TRA     s:14704

     1365    14701                                                /* THIS METHOD WILL FAIL FOR -0       */
     1366    14702    2           ELSE
     1367    14703    2                EXPONENT = PACKED.EXP + TRAILING_ZEROES;

  14703  6 004067   200050 036100                    ADLQ    TRAILING_ZEROES,,AUTO
         6 004070   200052 756100                    STQ     EXPONENT,,AUTO

     1368    14704    2      IF EXPONENT > 0

  14704  6 004071   200052 236100                    LDQ     EXPONENT,,AUTO
         6 004072   004100 604400 6                  TMOZ    s:14708

     1369    14705    2      THEN
     1370    14706    2           PRINT_LEN = EXPONENT + MANTISSA.LEN;

  14706  6 004073   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004074   000033 772000                    QRL     27
         6 004075   200052 036100                    ADLQ    EXPONENT,,AUTO
         6 004076   200047 756100                    STQ     PRINT_LEN,,AUTO
         6 004077   004112 710000 6                  TRA     s:14713

     1371    14707    2      ELSE
     1372    14708    2           IF -EXPONENT > MANTISSA.LEN

  14708  6 004100   200052 335100                    LCA     EXPONENT,,AUTO
         6 004101   203374 755100                    STA     TEMP_ERR+2,,AUTO
         6 004102   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004103   000033 772000                    QRL     27
         6 004104   203374 116100                    CMPQ    TEMP_ERR+2,,AUTO
         6 004105   004111 605000 6                  TPL     s:14712
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:219  

     1373    14709    2           THEN
     1374    14710    2                PRINT_LEN = MANTISSA.LEN - EXPONENT;

  14710  6 004106   200052 136100                    SBLQ    EXPONENT,,AUTO
         6 004107   200047 756100                    STQ     PRINT_LEN,,AUTO
         6 004110   004112 710000 6                  TRA     s:14713

     1375    14711    2           ELSE
     1376    14712    2                PRINT_LEN = MANTISSA.LEN;

  14712  6 004111   200047 756100                    STQ     PRINT_LEN,,AUTO

     1377    14713    2      IF PRINT_LEN > 5

  14713  6 004112   000005 116007                    CMPQ    5,DL
         6 004113   004117 604400 6                  TMOZ    s:14718

     1378    14714    2      THEN
     1379    14715    2           CALL EXP_NOT_FORM;              /* FORM NUMBER IN EXPONENTIAL         */

  14715  6 004114   004123 701000 6                  TSX1    EXP_NOT_FORM
         6 004115   000000 011000                    NOP     0
         6 004116   004121 710000 6                  TRA     s:14719

     1380    14716                                                /* NOTATION FORM                      */
     1381    14717    2      ELSE
     1382    14718    2           CALL DEC_PT_FORM;               /* OTHERWISE FORM AS XX.XX            */

  14718  6 004117   004215 701000 6                  TSX1    DEC_PT_FORM
         6 004120   000000 011000                    NOP     0

     1383    14719    2      RETURN;

  14719  6 004121   200044 221300                    LDX1  ! @VALUE$,,AUTO
         6 004122   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:220  
     1384    14720        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:221  
     1385    14721    2   EXP_NOT_FORM: PROC;

  14721  6 004123   200062 741300       EXP_NOT_FORM STX1  ! MANTISSA+5,,AUTO

     1386    14722    3   DCL SIGN_CHAR CHAR(1);
     1387    14723    3   DCL SIGN_EXP CHAR(3);
     1388    14724    3      IF PACKED.SIGN = 13                  /* NEGATIVE SIGN                      */

  14724  6 004124   200045 470500                    LDP0    @PACKED,,AUTO
         6 004125   000000 236100                    LDQ     0,,PR0
         6 004126   360000 376003                    ANQ     122880,DU
         6 004127   320000 116003                    CMPQ    106496,DU
         6 004130   004134 601000 6                  TNZ     s:14728

     1389    14725    3      THEN
     1390    14726    3           SIGN_CHAR = '-';

  14726  6 004131   055000 236003                    LDQ     23040,DU
         6 004132   200063 756100                    STQ     SIGN_CHAR,,AUTO
         6 004133   004136 710000 6                  TRA     s:14729

     1391    14727    3      ELSE
     1392    14728    3           SIGN_CHAR = ' ';

  14728  6 004134   040000 236003                    LDQ     16384,DU
         6 004135   200063 756100                    STQ     SIGN_CHAR,,AUTO

     1393    14729    3      EXPONENT = EXPONENT + MANTISSA.LEN - 1;

  14729  6 004136   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004137   000033 772000                    QRL     27
         6 004140   200052 036100                    ADLQ    EXPONENT,,AUTO
         6 004141   000001 136007                    SBLQ    1,DL
         6 004142   200052 756100                    STQ     EXPONENT,,AUTO

     1394    14730                                                /* NORMALIZE                          */
     1395    14731    3      CALL BINXCHAR(SIGN_EXP,EXPONENT);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:222  

  14731  6 004143   000100 301500                    BTD
         6 004144   200052 000004                    NDSC9   EXPONENT,,AUTO           cn=0,s=lsgnf,sf=0,n=4
         6 004145   200064 010003                    NDSC9   SIGN_EXP,,AUTO           cn=0,s=lsgns,sf=0,n=3

     1396    14732    3      CALL CONCAT(CHAR_BUF,

  14732  6 004146   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004147   000033 772000                    QRL     27
         6 004150   777777 620006                    EAX0    -1,QL
         6 004151   200046 471500                    LDP1    @CHAR_BUF,,AUTO
         6 004152   040100 100500                    MLR     fill='040'O
         6 004153   200063 000001                    ADSC9   SIGN_CHAR,,AUTO          cn=0,n=1
         6 004154   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         6 004155   040100 100500                    MLR     fill='040'O
         6 004156   200055 200001                    ADSC9   MANTISSA,,AUTO           cn=1,n=1
         6 004157   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1
         6 004160   040100 100400                    MLR     fill='040'O
         6 004161   000104 000001 7                  ADSC9   68                       cn=0,n=1
         6 004162   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1
         6 004163   040100 100540                    MLR     fill='040'O
         6 004164   200055 400010                    ADSC9   MANTISSA,,AUTO           cn=2,n=*X0
         6 004165   100000 600020                    ADSC9   0,,PR1                   cn=3,n=16
         6 004166   000000 636010                    EAQ     0,X0
         6 004167   000022 772000                    QRL     18
         6 004170   000020 116007                    CMPQ    16,DL
         6 004171   004213 603000 6                  TRC     s:14739
         6 004172   203374 740100                    STX0    TEMP_ERR+2,,AUTO
         6 004173   777757 620010                    EAX0    -17,X0
         6 004174   777777 660003                    ERX0    -1,DU
         6 004175   203374 235100                    LDA     TEMP_ERR+2,,AUTO
         6 004176   000022 771000                    ARL     18
         6 004177   040145 100400                    MLR     fill='040'O
         6 004200   000105 000001 7                  ADSC9   69                       cn=0,n=1
         6 004201   100000 600010                    ADSC9   0,A,PR1                  cn=3,n=*X0
         6 004202   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 004203   000022 772000                    QRL     18
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:223  
         6 004204   000017 116007                    CMPQ    15,DL
         6 004205   004213 603000 6                  TRC     s:14739
         6 004206   777760 620006                    EAX0    -16,QL
         6 004207   777777 660003                    ERX0    -1,DU
         6 004210   040146 100500                    MLR     fill='040'O
         6 004211   200064 000003                    ADSC9   SIGN_EXP,,AUTO           cn=0,n=3
         6 004212   100001 000010                    ADSC9   1,Q,PR1                  cn=0,n=*X0

     1397    14733    3        SIGN_CHAR,
     1398    14734    3        SUBSTR(MANTISSA.STRING,0,1),
     1399    14735    3        '.',
     1400    14736    3        SUBSTR(MANTISSA.STRING,1,MANTISSA.LEN - 1),
     1401    14737    3        'E',
     1402    14738    3        SIGN_EXP);
     1403    14739    3      RETURN;

  14739  6 004213   200062 221300                    LDX1  ! MANTISSA+5,,AUTO
         6 004214   000001 702211                    TSX2  ! 1,X1

     1404    14740    3   END EXP_NOT_FORM;
     1405    14741        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:224  
     1406    14742    2   DEC_PT_FORM: PROC;

  14742  6 004215   200062 741300       DEC_PT_FORM  STX1  ! MANTISSA+5,,AUTO

     1407    14743    3   DCL MAN_LEN SBIN WORD;
     1408    14744    3   DCL BEFORE_LEN SBIN WORD;
     1409    14745    3   DCL TRAIL_0_LEN SBIN WORD;
     1410    14746    3   DCL PT_LEN SBIN WORD;
     1411    14747    3   DCL LEAD_0_LEN SBIN WORD;
     1412    14748    3   DCL AFTER_LEN SBIN WORD;
     1413    14749    3   DCL TEMP SBIN WORD;
     1414    14750    3   DCL SIGN_CHAR CHAR(1);
     1415    14751    3   DCL DEC_PT CHAR(1) CONSTANT INIT('.');
     1416    14752    3      MAN_LEN = MANTISSA.LEN;              /* CHANGE TYPE FROM UBIN BYTE TO      */

  14752  6 004216   200055 236100                    LDQ     MANTISSA,,AUTO
         6 004217   000033 772000                    QRL     27
         6 004220   200063 756100                    STQ     MAN_LEN,,AUTO

     1417    14753                                                /* SBIN WORD                          */
     1418    14754    3      IF MAN_LEN = 0

  14754  6 004221   004227 601000 6                  TNZ     s:14759

     1419    14755    3      THEN
     1420    14756    3           CHAR_BUF = ' 0';

  14756  6 004222   200046 470500                    LDP0    @CHAR_BUF,,AUTO
         6 004223   040100 100400                    MLR     fill='040'O
         6 004224   000310 000002 2                  ADSC9   VBND+38                  cn=0,n=2
         6 004225   000000 000023                    ADSC9   0,,PR0                   cn=0,n=19
         6 004226   004402 710000 6                  TRA     s:14781

     1421    14757    3      ELSE
     1422    14758    4      DO;

     1423    14759    4           IF PACKED.SIGN = 13
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:225  

  14759  6 004227   200045 470500                    LDP0    @PACKED,,AUTO
         6 004230   000000 236100                    LDQ     0,,PR0
         6 004231   360000 376003                    ANQ     122880,DU
         6 004232   320000 116003                    CMPQ    106496,DU
         6 004233   004237 601000 6                  TNZ     s:14763

     1424    14760    4           THEN                            /* NEGATIVE SIGN                      */
     1425    14761    4                SIGN_CHAR = '-';

  14761  6 004234   055000 236003                    LDQ     23040,DU
         6 004235   200072 756100                    STQ     SIGN_CHAR,,AUTO
         6 004236   004241 710000 6                  TRA     s:14764

     1426    14762    4           ELSE
     1427    14763    4                SIGN_CHAR = ' ';

  14763  6 004237   040000 236003                    LDQ     16384,DU
         6 004240   200072 756100                    STQ     SIGN_CHAR,,AUTO

     1428    14764    4           BEFORE_LEN = MINIMUM (MAXIMUM (0, MAN_LEN + EXPONENT), MAN_LEN);

  14764  6 004241   200063 236100                    LDQ     MAN_LEN,,AUTO
         6 004242   200052 036100                    ADLQ    EXPONENT,,AUTO
         6 004243   000000 116003                    CMPQ    0,DU
         6 004244   004246 605000 6                  TPL     s:14764+5
         6 004245   000000 236003                    LDQ     0,DU
         6 004246   200063 116100                    CMPQ    MAN_LEN,,AUTO
         6 004247   004251 604400 6                  TMOZ    s:14764+8
         6 004250   200063 236100                    LDQ     MAN_LEN,,AUTO
         6 004251   200064 756100                    STQ     BEFORE_LEN,,AUTO

     1429    14765    4           TRAIL_0_LEN = MAXIMUM (0,EXPONENT);

  14765  6 004252   200052 236100                    LDQ     EXPONENT,,AUTO
         6 004253   000000 116003                    CMPQ    0,DU
         6 004254   004256 605000 6                  TPL     s:14765+4
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:226  
         6 004255   000000 236003                    LDQ     0,DU
         6 004256   200065 756100                    STQ     TRAIL_0_LEN,,AUTO

     1430    14766    4           IF EXPONENT < 0

  14766  6 004257   200052 235100                    LDA     EXPONENT,,AUTO
         6 004260   004264 605000 6                  TPL     s:14770

     1431    14767    4           THEN
     1432    14768    4                PT_LEN = 1;

  14768  6 004261   000001 235007                    LDA     1,DL
         6 004262   200066 755100                    STA     PT_LEN,,AUTO
         6 004263   004265 710000 6                  TRA     s:14771

     1433    14769    4           ELSE
     1434    14770    4                PT_LEN = 0;

  14770  6 004264   200066 450100                    STZ     PT_LEN,,AUTO

     1435    14771    4           LEAD_0_LEN = MAXIMUM (0,-EXPONENT-MAN_LEN);

  14771  6 004265   200052 236100                    LDQ     EXPONENT,,AUTO
         6 004266   200063 036100                    ADLQ    MAN_LEN,,AUTO
         6 004267   000027 676000 xsym               ERQ     B_VECTNIL+23
         6 004270   000001 036007                    ADLQ    1,DL
         6 004271   000000 116003                    CMPQ    0,DU
         6 004272   004274 605000 6                  TPL     s:14771+7
         6 004273   000000 236003                    LDQ     0,DU
         6 004274   200067 756100                    STQ     LEAD_0_LEN,,AUTO

     1436    14772    4           AFTER_LEN = MINIMUM (MAXIMUM (0,-EXPONENT), MAN_LEN);

  14772  6 004275   200052 336100                    LCQ     EXPONENT,,AUTO
         6 004276   000000 116003                    CMPQ    0,DU
         6 004277   004301 605000 6                  TPL     s:14772+4
         6 004300   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:227  
         6 004301   200063 116100                    CMPQ    MAN_LEN,,AUTO
         6 004302   004304 604400 6                  TMOZ    s:14772+7
         6 004303   200063 236100                    LDQ     MAN_LEN,,AUTO
         6 004304   200070 756100                    STQ     AFTER_LEN,,AUTO

     1437    14773    4           CALL CONCAT(CHAR_BUF,

  14773  6 004305   200046 471500                    LDP1    @CHAR_BUF,,AUTO
         6 004306   040100 100500                    MLR     fill='040'O
         6 004307   200072 000001                    ADSC9   SIGN_CHAR,,AUTO          cn=0,n=1
         6 004310   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         6 004311   200064 720100                    LXL0    BEFORE_LEN,,AUTO
         6 004312   040100 100540                    MLR     fill='040'O
         6 004313   200055 200010                    ADSC9   MANTISSA,,AUTO           cn=1,n=*X0
         6 004314   100000 200022                    ADSC9   0,,PR1                   cn=1,n=18
         6 004315   200064 236100                    LDQ     BEFORE_LEN,,AUTO
         6 004316   000022 116007                    CMPQ    18,DL
         6 004317   004402 605000 6                  TPL     s:14781
         6 004320   777755 621006                    EAX1    -19,QL
         6 004321   777777 661003                    ERX1    -1,DU
         6 004322   200065 722100                    LXL2    TRAIL_0_LEN,,AUTO
         6 004323   040146 100440                    MLR     fill='040'O
         6 004324   000016 000012 2                  ADSC9   ZERO_STRING              cn=0,n=*X2
         6 004325   100000 200011                    ADSC9   0,Q,PR1                  cn=1,n=*X1
         6 004326   200065 036100                    ADLQ    TRAIL_0_LEN,,AUTO
         6 004327   000022 116007                    CMPQ    18,DL
         6 004330   004402 605000 6                  TPL     s:14781
         6 004331   203374 756100                    STQ     TEMP_ERR+2,,AUTO
         6 004332   200064 236100                    LDQ     BEFORE_LEN,,AUTO
         6 004333   200065 036100                    ADLQ    TRAIL_0_LEN,,AUTO
         6 004334   203374 723100                    LXL3    TEMP_ERR+2,,AUTO
         6 004335   777755 623013                    EAX3    -19,X3
         6 004336   777777 663003                    ERX3    -1,DU
         6 004337   200066 724100                    LXL4    PT_LEN,,AUTO
         6 004340   040146 100440                    MLR     fill='040'O
         6 004341   000232 000014 2                  ADSC9   DEC_PT                   cn=0,n=*X4
         6 004342   100000 200013                    ADSC9   0,Q,PR1                  cn=1,n=*X3
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:228  
         6 004343   203375 756100                    STQ     TEMP_ERR+3,,AUTO
         6 004344   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 004345   200066 036100                    ADLQ    PT_LEN,,AUTO
         6 004346   000022 116007                    CMPQ    18,DL
         6 004347   004402 605000 6                  TPL     s:14781
         6 004350   203376 756100                    STQ     TEMP_ERR+4,,AUTO
         6 004351   203375 236100                    LDQ     TEMP_ERR+3,,AUTO
         6 004352   200066 036100                    ADLQ    PT_LEN,,AUTO
         6 004353   203376 725100                    LXL5    TEMP_ERR+4,,AUTO
         6 004354   777755 625015                    EAX5    -19,X5
         6 004355   777777 665003                    ERX5    -1,DU
         6 004356   200067 726100                    LXL6    LEAD_0_LEN,,AUTO
         6 004357   040146 100440                    MLR     fill='040'O
         6 004360   000016 000016 2                  ADSC9   ZERO_STRING              cn=0,n=*X6
         6 004361   100000 200015                    ADSC9   0,Q,PR1                  cn=1,n=*X5
         6 004362   203377 756100                    STQ     TEMP_ERR+5,,AUTO
         6 004363   203376 236100                    LDQ     TEMP_ERR+4,,AUTO
         6 004364   200067 036100                    ADLQ    LEAD_0_LEN,,AUTO
         6 004365   000022 116007                    CMPQ    18,DL
         6 004366   004402 605000 6                  TPL     s:14781
         6 004367   203400 756100                    STQ     TEMP_ERR+6,,AUTO
         6 004370   203377 236100                    LDQ     TEMP_ERR+5,,AUTO
         6 004371   200067 036100                    ADLQ    LEAD_0_LEN,,AUTO
         6 004372   203400 727100                    LXL7    TEMP_ERR+6,,AUTO
         6 004373   777755 627017                    EAX7    -19,X7
         6 004374   777777 667003                    ERX7    -1,DU
         6 004375   200070 720100                    LXL0    AFTER_LEN,,AUTO
         6 004376   200064 235100                    LDA     BEFORE_LEN,,AUTO
         6 004377   040146 100545                    MLR     fill='040'O
         6 004400   200055 200010                    ADSC9   MANTISSA,A,AUTO          cn=1,n=*X0
         6 004401   100000 200017                    ADSC9   0,Q,PR1                  cn=1,n=*X7

     1438    14774    4             SIGN_CHAR,
     1439    14775    4             SUBSTR(MANTISSA.STRING,0,BEFORE_LEN),
     1440    14776    4             SUBSTR(ZERO_STRING,0,TRAIL_0_LEN),
     1441    14777    4             SUBSTR(DEC_PT,0,PT_LEN),
     1442    14778    4             SUBSTR(ZERO_STRING,0,LEAD_0_LEN),
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:229  
     1443    14779    4             SUBSTR(MANTISSA.STRING,BEFORE_LEN,AFTER_LEN));
     1444    14780    4           END;

     1445    14781    3      RETURN;

  14781  6 004402   200062 221300                    LDX1  ! MANTISSA+5,,AUTO
         6 004403   000001 702211                    TSX2  ! 1,X1

     1446    14782    3   END DEC_PT_FORM;
     1447    14783    2   END PACKED_TO_CHAR;
     1448    14784        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:230  
     1449    14785    1   READ_B$RATE:PROC(RET_VAL,KEYED_OR_NOT,KEY_TEXTC);

  14785  6 004404   203346 741300       READ_B$RATE  STX1  ! EXIT_LOOP+1,,AUTO

     1450    14786                                                /* PROCEDURE TO READ A RECORD         */
     1451    14787                                                /* FROM B$RATE AND RETURN.            */
     1452    14788                                                /* IT RETURNS NORM_RET IF THE         */
     1453    14789                                                /* CALL                               */
     1454    14790                                                /* TO M$READ WAS ERROR_FREE AND       */
     1455    14791                                                /* ALT_RET IF THE ALTRETURN PATH      */
     1456    14792                                                /* WAS TAKEN(IN RET_VAL).             */
     1457    14793                                                /* IF KEYED_OR_NOT = KEYED, THE       */
     1458    14794                                                /* RECORD IS READ KEYED USING         */
     1459    14795                                                /* KEY_TEXTC---NO KEY RETURNED        */
     1460    14796                                                /* OTHERWISE IT READS                 */
     1461    14797                                                /* SEQUENTIALLY---KEY IS RETURNED*/
     1462    14798    2   DCL RET_VAL SBIN WORD;
     1463    14799    2   DCL KEYED_OR_NOT BIT(1) ALIGNED;
     1464    14800    2   DCL KEY_TEXTC CHAR(36);
     1465    14801    2      B$RATE_READ_FPT.V.KEYS# = KEYED_OR_NOT;

  14801  6 004405   203350 470500                    LDP0    @KEYED_OR_NOT,,AUTO
         6 004406   000000 236100                    LDQ     0,,PR0
         6 004407   000023 772000                    QRL     19
         6 004410   000252 676000 1                  ERQ     B$RATE_READ_FPT+8
         6 004411   200000 376007                    ANQ     65536,DL
         6 004412   000252 656000 1                  ERSQ    B$RATE_READ_FPT+8

     1466    14802    2      B$RATE_READ_FPT.V.KEYR# = ~KEYED_OR_NOT;

  14802  6 004413   000000 236100                    LDQ     0,,PR0
         6 004414   400000 376003                    ANQ     -131072,DU
         6 004415   400000 676003                    ERQ     -131072,DU
         6 004416   000024 772000                    QRL     20
         6 004417   000252 676000 1                  ERQ     B$RATE_READ_FPT+8
         6 004420   100000 376007                    ANQ     32768,DL
         6 004421   000252 656000 1                  ERSQ    B$RATE_READ_FPT+8
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:231  

     1467    14803    2      B$RATE_READ_FPT.KEY_ = VECTOR(KEY_TEXTC);

  14803  6 004422   000035 235000 7                  LDA     29
         6 004423   203351 236100                    LDQ     @KEY_TEXTC,,AUTO
         6 004424   000244 757000 1                  STAQ    B$RATE_READ_FPT+2

     1468    14804    2      CALL M$READ(B$RATE_READ_FPT)  ALTRET(BAD_READ);

  14804  6 004425   000242 630400 1                  EPPR0   B$RATE_READ_FPT
         6 004426   440000 713400                    CLIMB   alt,read
         6 004427   401400 401760                    pmme    nvectors=4
         6 004430   004436 702000 6                  TSX2    BAD_READ

     1469    14805    2      RET_VAL = NORM_RET;

  14805  6 004431   000001 235007                    LDA     1,DL
         6 004432   203347 470500                    LDP0    @RET_VAL,,AUTO
         6 004433   000000 755100                    STA     0,,PR0

     1470    14806    2      RETURN;

  14806  6 004434   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 004435   000001 702211                    TSX2  ! 1,X1

     1471    14807    2   BAD_READ: RET_VAL = ALT_RET;

  14807  6 004436   203347 470500       BAD_READ     LDP0    @RET_VAL,,AUTO
         6 004437   000000 450100                    STZ     0,,PR0

     1472    14808    2      RETURN;

  14808  6 004440   203346 221300                    LDX1  ! EXIT_LOOP+1,,AUTO
         6 004441   000001 702211                    TSX2  ! 1,X1

     1473    14809    2   END READ_B$RATE;
     1474    14810        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:232  
     1475    14811    1   UPDATE_FORM_TBL: PROC;

  14811  6 004442   200022 741300       UPDATE_FORM* STX1  ! FIRST_TIME,,AUTO

     1476    14812    2   DCL RET_VAL SBIN WORD;
     1477    14813    2   DCL PACKED_NUM BIT(72) DALIGNED;
     1478    14814    2   DCL VALUE$ PTR;
     1479    14815
     1480    14816    3      DO CASE(RPT$BLK.CODE);

  14816  6 004443   200003 470500                    LDP0    PCB,,AUTO
         6 004444   000000 236100                    LDQ     0,,PR0
         6 004445   777777 376007                    ANQ     -1,DL
         6 004446   000004 136007                    SBLQ    4,DL
         6 004447   000002 116007                    CMPQ    2,DL
         6 004450   004452 602006 6                  TNC     s:14816+7,QL
         6 004451   004506 710000 6                  TRA     s:14833
         6 004452   004454 710000 6                  TRA     s:14818
         6 004453   004454 710000 6                  TRA     s:14818

     1481    14817    3       CASE(FORM_CODE,FRM_MNT_CODE);

     1482    14818    3         VALUE$ = RPT$BLK.SUB_BLK$(0);

  14818  6 004454   000003 236100                    LDQ     3,,PR0
         6 004455   200026 756100                    STQ     VALUE$,,AUTO

     1483    14819    3         CALL CONVERT_TO_PACKED(RET_VAL,

  14819  6 004456   200024 631500                    EPPR1   PACKED_NUM,,AUTO
         6 004457   200045 451500                    STP1    @PACKED,,AUTO
         6 004460   200026 633500                    EPPR3   VALUE$,,AUTO
         6 004461   200044 453500                    STP3    @VALUE$,,AUTO
         6 004462   200023 634500                    EPPR4   RET_VAL,,AUTO
         6 004463   200043 454500                    STP4    @RET_VAL,,AUTO
         6 004464   001173 701000 6                  TSX1    CONVERT_TO_PACKED
         6 004465   000000 011000                    NOP     0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:233  

     1484    14820    3           VALUE$,
     1485    14821    3           PACKED_NUM);
     1486    14822    3         IF RET_VAL = NORM_RET

  14822  6 004466   200023 235100                    LDA     RET_VAL,,AUTO
         6 004467   000001 115007                    CMPA    1,DL
         6 004470   004506 601000 6                  TNZ     s:14833

     1487    14823    3         THEN
     1488    14824    4         DO;

     1489    14825    4              IF RPT$BLK.CODE = FORM_CODE

  14825  6 004471   200003 470500                    LDP0    PCB,,AUTO
         6 004472   000000 720100                    LXL0    0,,PR0
         6 004473   000004 100003                    CMPX0   4,DU
         6 004474   004501 601000 6                  TNZ     s:14829

     1490    14826    4              THEN
     1491    14827    4                   REC_BUF$->FORM$TBL.FORM# = PACKED_NUM;

  14827  6 004475   200024 237100                    LDAQ    PACKED_NUM,,AUTO
         6 004476   000015 471400 2                  LDP1    REC_BUF$
         6 004477   100000 757100                    STAQ    0,,PR1
         6 004500   004504 710000 6                  TRA     s:14830

     1492    14828    4              ELSE
     1493    14829    4                   REC_BUF$->FORM$TBL.FMOUNT# = PACKED_NUM;

  14829  6 004501   200024 237100                    LDAQ    PACKED_NUM,,AUTO
         6 004502   000015 471400 2                  LDP1    REC_BUF$
         6 004503   100002 757100                    STAQ    2,,PR1

     1494    14830    4              ERR_CODE.CODE = 0;

  14830  6 004504   000106 236000 7                  LDQ     70
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:234  
         6 004505   000052 356000 1                  ANSQ    ERR_CODE

     1495    14831    4              END;

     1496    14832    3         END;                              /* END CASE                           */

     1497    14833    2   END UPDATE_FORM_TBL;

  14833  6 004506   200022 221300                    LDX1  ! FIRST_TIME,,AUTO
         6 004507   000001 702211                    TSX2  ! 1,X1

     1498    14834        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:235  
     1499    14835        /* THIS PROCEDURE UPDATES (OR INITIALIZES) THE RATE RATE TABLE                */
     1500    14836    1   UPDATE_RATE_TBL: PROC;

  14836  6 004510   200022 741300       UPDATE_RATE* STX1  ! FIRST_TIME,,AUTO

     1501    14837    2   DCL INDX  SBIN WORD;
     1502    14838    2   DCL RET_VAL SBIN WORD;
     1503    14839    2   DCL TYPE SBIN WORD;
     1504    14840    2   DCL PACKED_NUM BIT(72) DALIGNED;
     1505    14841    2   DCL VALUE$ PTR;
     1506    14842    2   DCL VALUE_BASE$ PTR;
     1507    14843
     1508    14844    2      VALUE_BASE$ = ADDR(REC_BUF$->RATE$TBL.CMULT#);

  14844  6 004511   000015 236000 2                  LDQ     REC_BUF$
         6 004512   000061 036003                    ADLQ    49,DU
         6 004513   200031 756100                    STQ     VALUE_BASE$,,AUTO

     1509    14845
     1510    14846    3      DO CASE(RPT$BLK.CODE);

  14846  6 004514   200003 470500                    LDP0    PCB,,AUTO
         6 004515   000000 236100                    LDQ     0,,PR0
         6 004516   777777 376007                    ANQ     -1,DL
         6 004517   000004 136007                    SBLQ    4,DL
         6 004520   000002 116007                    CMPQ    2,DL
         6 004521   004523 602006 6                  TNC     s:14846+7,QL
         6 004522   004565 710000 6                  TRA     s:14862
         6 004523   004525 710000 6                  TRA     s:14848
         6 004524   004530 710000 6                  TRA     s:14850

     1511    14847    3       CASE(JSUNIT);                       /* JOB OR STEP UNIT                   */

     1512    14848    3         CALL PROCESS_JSUNIT;

  14848  6 004525   004566 701000 6                  TSX1    PROCESS_JSUNIT
         6 004526   000000 011000                    NOP     0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:236  
         6 004527   004565 710000 6                  TRA     s:14862

     1513    14849    3       CASE(VALUE_SET);                    /* VALUE TYPE                         */

     1514    14850    3         VALUE$ = RPT$BLK.SUB_BLK$(1);

  14850  6 004530   000004 236100                    LDQ     4,,PR0
         6 004531   200030 756100                    STQ     VALUE$,,AUTO

     1515    14851                                                /* POINTS TO VALUE SUB-TREE           */
     1516    14852    3         TYPE = RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE;

  14852  6 004532   000003 471500                    LDP1    3,,PR0
         6 004533   100000 236100                    LDQ     0,,PR1
         6 004534   777777 376007                    ANQ     -1,DL
         6 004535   200025 756100                    STQ     TYPE,,AUTO

     1517    14853    3         INDX  = TYPE - CMULT_CODE;

  14853  6 004536   000005 136007                    SBLQ    5,DL
         6 004537   200023 756100                    STQ     INDX,,AUTO

     1518    14854                                                /* TYPE OF VALUE NODE THIS IS         */
     1519    14855    3         CALL CONVERT_TO_PACKED(RET_VAL,VALUE$,PACKED_NUM);

  14855  6 004540   200026 633500                    EPPR3   PACKED_NUM,,AUTO
         6 004541   200045 453500                    STP3    @PACKED,,AUTO
         6 004542   200030 631500                    EPPR1   VALUE$,,AUTO
         6 004543   200044 451500                    STP1    @VALUE$,,AUTO
         6 004544   200024 634500                    EPPR4   RET_VAL,,AUTO
         6 004545   200043 454500                    STP4    @RET_VAL,,AUTO
         6 004546   001173 701000 6                  TSX1    CONVERT_TO_PACKED
         6 004547   000000 011000                    NOP     0

     1520    14856    3         IF RET_VAL = NORM_RET

  14856  6 004550   200024 235100                    LDA     RET_VAL,,AUTO
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:237  
         6 004551   000001 115007                    CMPA    1,DL
         6 004552   004565 601000 6                  TNZ     s:14862

     1521    14857    4         THEN DO;

     1522    14858    4              VALUE_BASE$->PACKED$NUM$ARY(INDX)  = PACKED_NUM;

  14858  6 004553   200023 236100                    LDQ     INDX,,AUTO
         6 004554   000001 736000                    QLS     1
         6 004555   200031 470500                    LDP0    VALUE_BASE$,,AUTO
         6 004556   000000 620006                    EAX0    0,QL
         6 004557   000000 621006                    EAX1    0,QL
         6 004560   200026 237100                    LDAQ    PACKED_NUM,,AUTO
         6 004561   000000 755110                    STA     0,X0,PR0
         6 004562   000001 756111                    STQ     1,X1,PR0

     1523    14859                                                /* STUFF THE VALUE AWAY               */
     1524    14860    4              ERR_CODE.CODE = 0;

  14860  6 004563   000106 236000 7                  LDQ     70
         6 004564   000052 356000 1                  ANSQ    ERR_CODE

     1525    14861    4              END;

     1526    14862    3         END;                              /* END CASE                           */

  14862  6 004565   005024 710000 6                  TRA     s:14933

     1527    14863        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:238  
     1528    14864        /*   PROCESS_JSUNIT is used to process a JUNIT or SUNIT option for
     1529    14865           B$RATE_TBL or B$LCP6_TBL modification.
     1530    14866        */
     1531    14867    2   PROCESS_JSUNIT: PROC;

  14867  6 004566   200032 741300       PROCESS_JSU* STX1  ! CTL_INFO,,AUTO

     1532    14868    3   DCL NUM$ PTR;
     1533    14869    3   DCL NAME$ PTR;
     1534    14870    3   DCL T_NAME CHAR(16);
     1535    14871    3      NUM$ = RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);

  14871  6 004567   200003 470500                    LDP0    PCB,,AUTO
         6 004570   000004 471500                    LDP1    4,,PR0
         6 004571   100003 236100                    LDQ     3,,PR1
         6 004572   200033 756100                    STQ     NUM$,,AUTO

     1536    14872                                                /* POINTS TO INDEX TEXTC              */
     1537    14873    3      IF NUM$->TEXT$C.LEN > 1 OR NUM$->TEXT$C.STRING < '1'

  14873  6 004573   200033 473500                    LDP3    NUM$,,AUTO
         6 004574   000100 101500                    MRL     fill='000'O
         6 004575   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 004576   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 004577   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 004600   000002 116007                    CMPQ    2,DL
         6 004601   004622 605000 6                  TPL     s:14876
         6 004602   000100 101500                    MRL     fill='000'O
         6 004603   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 004604   203375 000002                    ADSC9   TEMP_ERR+3,,AUTO         cn=0,n=2
         6 004605   203375 220100                    LDX0    TEMP_ERR+3,,AUTO
         6 004606   040000 106540                    CMPC    fill='040'O
         6 004607   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         6 004610   000107 000001 7                  ADSC9   71                       cn=0,n=1
         6 004611   004622 602000 6                  TNC     s:14876
         6 004612   000100 101500                    MRL     fill='000'O
         6 004613   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:239  
         6 004614   203376 000002                    ADSC9   TEMP_ERR+4,,AUTO         cn=0,n=2
         6 004615   203376 222100                    LDX2    TEMP_ERR+4,,AUTO
         6 004616   040140 106400                    CMPC    fill='040'O
         6 004617   000110 000001 7                  ADSC9   72                       cn=0,n=1
         6 004620   300000 200012                    ADSC9   0,,PR3                   cn=1,n=*X2
         6 004621   004633 603000 6                  TRC     s:14883

     1538    14874    3        OR NUM$->TEXT$C.STRING > '4'
     1539    14875    4      THEN DO;

     1540    14876    4           CALL ERR_PROC(10);

  14876  6 004622   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 004623   000001 235000 xsym               LDA     B_VECTNIL+1
         6 004624   203370 757100                    STAQ    @ELAB,,AUTO
         6 004625   000111 236000 7                  LDQ     73
         6 004626   203367 756100                    STQ     @CODE,,AUTO
         6 004627   001655 701000 6                  TSX1    ERR_PROC
         6 004630   000000 011000                    NOP     0

     1541    14877    4           RETURN;

  14877  6 004631   200032 221300                    LDX1  ! CTL_INFO,,AUTO
         6 004632   000001 702211                    TSX2  ! 1,X1

     1542    14878    4           END;
     1543    14879        /*E* ERROR:   ARA-00010
     1544    14880             MESSAGE: JUNIT or SUNIT number must be 1,2,3, OR 4.
     1545    14881        */
     1546    14882
     1547    14883    3      CALL CHARBIN(INDX,NUM$->TEXT$C.STRING);

  14883  6 004633   000100 101500                    MRL     fill='000'O
         6 004634   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 004635   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
         6 004636   203374 223100                    LDX3    TEMP_ERR+2,,AUTO
         6 004637   000100 305540                    DTB
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:240  
         6 004640   300000 230013                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X3
         6 004641   200023 000004                    NDSC9   INDX,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     1548    14884    3      INDX  = INDX  - 1;

  14884  6 004642   000001 336007                    LCQ     1,DL
         6 004643   200023 056100                    ASQ     INDX,,AUTO

     1549    14885    3      IF RPT$BLK.SUB_BLK$(2)->RPT$BLK.NUM_SUB_BLKS > 0

  14885  6 004644   000005 471500                    LDP1    5,,PR0
         6 004645   100001 223100                    LDX3    1,,PR1
         6 004646   004665 600000 6                  TZE     s:14893

     1550    14886    4      THEN DO;                             /* Value specified                    */

     1551    14887    4           VALUE$ = RPT$BLK.SUB_BLK$(2)->RPT$BLK.SUB_BLK$(0);

  14887  6 004647   100003 236100                    LDQ     3,,PR1
         6 004650   200030 756100                    STQ     VALUE$,,AUTO

     1552    14888                                                /* POINTS TO VALUE SUB-TREE           */
     1553    14889    4           CALL CONVERT_TO_PACKED(RET_VAL,VALUE$,PACKED_NUM);

  14889  6 004651   200026 631500                    EPPR1   PACKED_NUM,,AUTO
         6 004652   200045 451500                    STP1    @PACKED,,AUTO
         6 004653   200030 634500                    EPPR4   VALUE$,,AUTO
         6 004654   200044 454500                    STP4    @VALUE$,,AUTO
         6 004655   200024 635500                    EPPR5   RET_VAL,,AUTO
         6 004656   200043 455500                    STP5    @RET_VAL,,AUTO
         6 004657   001173 701000 6                  TSX1    CONVERT_TO_PACKED
         6 004660   000000 011000                    NOP     0

     1554    14890    4           IF RET_VAL = ALT_RET

  14890  6 004661   200024 235100                    LDA     RET_VAL,,AUTO
         6 004662   004670 601000 6                  TNZ     s:14895
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:241  

     1555    14891    4           THEN RETURN;

  14891  6 004663   200032 221300                    LDX1  ! CTL_INFO,,AUTO
         6 004664   000001 702211                    TSX2  ! 1,X1

     1556    14892    4           END;
     1557    14893    3      ELSE PACKED_NUM='77'O;               /* AN IMPOSSIBLE VALUE AS A FLAG      */

  14893  6 004665   770000 235003                    LDA     -4096,DU
         6 004666   000000 236003                    LDQ     0,DU
         6 004667   200026 757100                    STAQ    PACKED_NUM,,AUTO

     1558    14894                                                /* NOT TO STORE PACKED_NUM            */
     1559    14895    3      IF RPT$BLK.NUM_SUB_BLKS = 4

  14895  6 004670   200003 470500                    LDP0    PCB,,AUTO
         6 004671   000001 220100                    LDX0    1,,PR0
         6 004672   000004 100003                    CMPX0   4,DU
         6 004673   004736 601000 6                  TNZ     s:14913

     1560    14896    3      THEN                                 /* JOB OR STEP UNIT NAME INPUT        */
     1561    14897    3           IF RPT$BLK.SUB_BLK$(3)->RPT$BLK.NUM_SUB_BLKS > 0

  14897  6 004674   000006 471500                    LDP1    6,,PR0
         6 004675   100001 221100                    LDX1    1,,PR1
         6 004676   004732 600000 6                  TZE     s:14912

     1562    14898    4           THEN DO;                        /* AND NOT BLANK                      */

     1563    14899    4                NAME$ = RPT$BLK.SUB_BLK$(3)->RPT$BLK.SUB_BLK$(0)->

  14899  6 004677   100003 473500                    LDP3    3,,PR1
         6 004700   300003 236100                    LDQ     3,,PR3
         6 004701   200034 756100                    STQ     NAME$,,AUTO

     1564    14900    4                  RPT$BLK.SUB_BLK$(0);
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:242  
     1565    14901                                                /* POINTS TO NAME TEXTC               */
     1566    14902    4                IF NAME$->TEXT$C.LEN > 16

  14902  6 004702   200034 474500                    LDP4    NAME$,,AUTO
         6 004703   000100 101500                    MRL     fill='000'O
         6 004704   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 004705   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 004706   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 004707   000021 116007                    CMPQ    17,DL
         6 004710   004722 604000 6                  TMI     s:14910

     1567    14903    5                THEN DO;

     1568    14904    5                     CALL ERR_PROC(18);

  14904  6 004711   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 004712   000001 235000 xsym               LDA     B_VECTNIL+1
         6 004713   203370 757100                    STAQ    @ELAB,,AUTO
         6 004714   000113 236000 7                  LDQ     75
         6 004715   203367 756100                    STQ     @CODE,,AUTO
         6 004716   001655 701000 6                  TSX1    ERR_PROC
         6 004717   000000 011000                    NOP     0

     1569    14905    5                     RETURN;

  14905  6 004720   200032 221300                    LDX1  ! CTL_INFO,,AUTO
         6 004721   000001 702211                    TSX2  ! 1,X1

     1570    14906    5                     END;
     1571    14907        /*E* ERROR:   ARA-00018
     1572    14908             MESSAGE: JUNIT or SUNIT name exceeds 16 characters.
     1573    14909        */
     1574    14910    4                ELSE T_NAME = NAME$->TEXT$C.STRING;

  14910  6 004722   000100 101500                    MRL     fill='000'O
         6 004723   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 004724   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:243  
         6 004725   203374 220100                    LDX0    TEMP_ERR+2,,AUTO
         6 004726   040100 100540                    MLR     fill='040'O
         6 004727   400000 200010                    ADSC9   0,,PR4                   cn=1,n=*X0
         6 004730   200035 000020                    ADSC9   T_NAME,,AUTO             cn=0,n=16

     1575    14911    4                END;

  14911  6 004731   004741 710000 6                  TRA     s:14915

     1576    14912    3           ELSE T_NAME = ' ';              /* MUST BLANK OUT                     */

  14912  6 004732   040100 100400                    MLR     fill='040'O
         6 004733   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004734   200035 000020                    ADSC9   T_NAME,,AUTO             cn=0,n=16
         6 004735   004741 710000 6                  TRA     s:14915

     1577    14913    3      ELSE T_NAME = '* *';

  14913  6 004736   040100 100400                    MLR     fill='040'O
         6 004737   000311 000003 2                  ADSC9   VBND+39                  cn=0,n=3
         6 004740   200035 000020                    ADSC9   T_NAME,,AUTO             cn=0,n=16

     1578    14914                                 /* an impossible value as a flag not to store T_NAME */
     1579    14915    3      IF RPT$BLK.SUB_BLK$(0)->RPT$BLK.CODE = JUNIT_CODE

  14915  6 004741   000003 471500                    LDP1    3,,PR0
         6 004742   100000 720100                    LXL0    0,,PR1
         6 004743   000003 100003                    CMPX0   3,DU
         6 004744   004773 601000 6                  TNZ     s:14926

     1580    14916    4      THEN DO;                             /* JOB UNIT ENTRY                     */

     1581    14917    4           IF PACKED_NUM ~= '77'O

  14917  6 004745   200026 237100                    LDAQ    PACKED_NUM,,AUTO
         6 004746   000114 117000 7                  CMPAQ   76
         6 004747   004760 600000 6                  TZE     s:14921
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:244  

     1582    14918    4           THEN REC_BUF$->RATE$TBL.JUNIT.RATE#(INDX) = PACKED_NUM;

  14918  6 004750   200023 236100                    LDQ     INDX,,AUTO
         6 004751   000006 402007                    MPY     6,DL
         6 004752   000015 473400 2                  LDP3    REC_BUF$
         6 004753   000000 621006                    EAX1    0,QL
         6 004754   000000 622006                    EAX2    0,QL
         6 004755   200026 237100                    LDAQ    PACKED_NUM,,AUTO
         6 004756   300005 755111                    STA     5,X1,PR3
         6 004757   300006 756112                    STQ     6,X2,PR3

     1583    14919                                                /* Write the converted number         */
     1584    14920
     1585    14921    4           IF T_NAME ~= '* *'

  14921  6 004760   040000 106500                    CMPC    fill='040'O
         6 004761   200035 000020                    ADSC9   T_NAME,,AUTO             cn=0,n=16
         6 004762   000311 000003 2                  ADSC9   VBND+39                  cn=0,n=3
         6 004763   005020 600000 6                  TZE     s:14931

     1586    14922    4           THEN REC_BUF$->RATE$TBL.JUNIT.NAME#(INDX) = T_NAME;

  14922  6 004764   200023 236100                    LDQ     INDX,,AUTO
         6 004765   000030 402007                    MPY     24,DL
         6 004766   000015 470400 2                  LDP0    REC_BUF$
         6 004767   040106 100500                    MLR     fill='040'O
         6 004770   200035 000020                    ADSC9   T_NAME,,AUTO             cn=0,n=16
         6 004771   000001 000020                    ADSC9   1,Q,PR0                  cn=0,n=16

     1587    14923                                                /* Write the input name               */
     1588    14924    4           END;

  14924  6 004772   005020 710000 6                  TRA     s:14931

     1589    14925    4      ELSE DO;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:245  
     1590    14926    4           IF PACKED_NUM ~= '77'O

  14926  6 004773   200026 237100                    LDAQ    PACKED_NUM,,AUTO
         6 004774   000114 117000 7                  CMPAQ   76
         6 004775   005006 600000 6                  TZE     s:14928

     1591    14927    4           THEN REC_BUF$->RATE$TBL.SUNIT.RATE#(INDX) = PACKED_NUM;

  14927  6 004776   200023 236100                    LDQ     INDX,,AUTO
         6 004777   000006 402007                    MPY     6,DL
         6 005000   000015 473400 2                  LDP3    REC_BUF$
         6 005001   000000 621006                    EAX1    0,QL
         6 005002   000000 622006                    EAX2    0,QL
         6 005003   200026 237100                    LDAQ    PACKED_NUM,,AUTO
         6 005004   300035 755111                    STA     29,X1,PR3
         6 005005   300036 756112                    STQ     30,X2,PR3

     1592    14928    4           IF T_NAME ~= '* *'

  14928  6 005006   040000 106500                    CMPC    fill='040'O
         6 005007   200035 000020                    ADSC9   T_NAME,,AUTO             cn=0,n=16
         6 005010   000311 000003 2                  ADSC9   VBND+39                  cn=0,n=3
         6 005011   005020 600000 6                  TZE     s:14931

     1593    14929    4           THEN REC_BUF$->RATE$TBL.SUNIT.NAME#(INDX) = T_NAME;

  14929  6 005012   200023 236100                    LDQ     INDX,,AUTO
         6 005013   000030 402007                    MPY     24,DL
         6 005014   000015 470400 2                  LDP0    REC_BUF$
         6 005015   040106 100500                    MLR     fill='040'O
         6 005016   200035 000020                    ADSC9   T_NAME,,AUTO             cn=0,n=16
         6 005017   000031 000020                    ADSC9   25,Q,PR0                 cn=0,n=16

     1594    14930    4           END;

     1595    14931    3      ERR_CODE.CODE = 0;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:246  
  14931  6 005020   000106 236000 7                  LDQ     70
         6 005021   000052 356000 1                  ANSQ    ERR_CODE

     1596    14932    3   END PROCESS_JSUNIT;

  14932  6 005022   200032 221300                    LDX1  ! CTL_INFO,,AUTO
         6 005023   000001 702211                    TSX2  ! 1,X1

     1597    14933    2   END UPDATE_RATE_TBL;

  14933  6 005024   200022 221300                    LDX1  ! FIRST_TIME,,AUTO
         6 005025   000001 702211                    TSX2  ! 1,X1

     1598    14934        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:247  
     1599    14935        /* THIS PROCEDURE UPDATES (OR INITIALIZES) THE COMM RATE TABLE                */
     1600    14936    1   UPDATE_COMM_TBL: PROC;

  14936  6 005026   200022 741300       UPDATE_COMM* STX1  ! FIRST_TIME,,AUTO

     1601    14937
     1602    14938    2   END UPDATE_COMM_TBL;

  14938  6 005027   000001 702211                    TSX2  ! 1,X1

     1603    14939        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:248  
     1604    14940        /* THIS PROCEDURE IS THE DRIVER FOR MODIFICATION (OR INITIALIZATION) OF       */
     1605    14941        /* THE PROCESSOR AND SCHEDULE RATE TABLES.                                    */
     1606    14942    1   UPDATE_SCHED_TBL: PROC;

  14942  6 005030   200022 741300       UPDATE_SCHE* STX1  ! FIRST_TIME,,AUTO

     1607    14943    2   DCL PACKED_NUM PTR;
     1608    14944    2   DCL NUM$ PTR;
     1609    14945    2   DCL STRING$ PTR;
     1610    14946    2   DCL INDX  SBIN WORD;
     1611    14947    3      DO CASE(RPT$BLK.CODE);

  14947  6 005031   200003 470500                    LDP0    PCB,,AUTO
         6 005032   000000 236100                    LDQ     0,,PR0
         6 005033   777777 376007                    ANQ     -1,DL
         6 005034   000004 136007                    SBLQ    4,DL
         6 005035   000002 116007                    CMPQ    2,DL
         6 005036   005040 602006 6                  TNC     s:14947+7,QL
         6 005037   005236 710000 6                  TRA     s:15003
         6 005040   005042 710000 6                  TRA     s:14949
         6 005041   005111 710000 6                  TRA     s:14965

     1612    14948    3       CASE(RTABLE_CODE);                  /* RTABLE=...                         */

     1613    14949    3         IF RPT$BLK.NUM_SUB_BLKS=0

  14949  6 005042   000001 220100                    LDX0    1,,PR0
         6 005043   005054 601000 6                  TNZ     s:14955

     1614    14950    4         THEN DO;                          /* BLANK RTABLE INPUT                 */

     1615    14951    4              REC_BUF$->SCHED$TBL.RTABLE# = ' ';

  14951  6 005044   000015 471400 2                  LDP1    REC_BUF$
         6 005045   040100 100400                    MLR     fill='040'O
         6 005046   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005047   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:249  

     1616    14952    4              ERR_CODE.CODE = 0;

  14952  6 005050   000106 236000 7                  LDQ     70
         6 005051   000052 356000 1                  ANSQ    ERR_CODE

     1617    14953    4              RETURN;

  14953  6 005052   200022 221300                    LDX1  ! FIRST_TIME,,AUTO
         6 005053   000001 702211                    TSX2  ! 1,X1

     1618    14954    4              END;
     1619    14955    3         NUM$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);

  14955  6 005054   000003 471500                    LDP1    3,,PR0
         6 005055   100003 236100                    LDQ     3,,PR1
         6 005056   200024 756100                    STQ     NUM$,,AUTO

     1620    14956                                                /* POINTS TO TEXTC OF RTABLE VAL      */
     1621    14957    3         IF NUM$->TEXT$C.LEN > 6

  14957  6 005057   200024 473500                    LDP3    NUM$,,AUTO
         6 005060   000100 101500                    MRL     fill='000'O
         6 005061   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 005062   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 005063   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 005064   000007 116007                    CMPQ    7,DL
         6 005065   005076 604000 6                  TMI     s:14961

     1622    14958    3         THEN CALL ERR_PROC(9);

  14958  6 005066   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 005067   000001 235000 xsym               LDA     B_VECTNIL+1
         6 005070   203370 757100                    STAQ    @ELAB,,AUTO
         6 005071   000062 236000 7                  LDQ     50
         6 005072   203367 756100                    STQ     @CODE,,AUTO
         6 005073   001655 701000 6                  TSX1    ERR_PROC
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:250  
         6 005074   000000 011000                    NOP     0
         6 005075   005236 710000 6                  TRA     s:15003

     1623    14959
     1624    14960    4         ELSE DO;

     1625    14961    4              REC_BUF$->SCHED$TBL.RTABLE# = NUM$->TEXT$C.STRING;

  14961  6 005076   000100 101500                    MRL     fill='000'O
         6 005077   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 005100   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
         6 005101   203374 220100                    LDX0    TEMP_ERR+2,,AUTO
         6 005102   000015 471400 2                  LDP1    REC_BUF$
         6 005103   040100 100540                    MLR     fill='040'O
         6 005104   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         6 005105   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

     1626    14962    4              ERR_CODE.CODE = 0;

  14962  6 005106   000106 236000 7                  LDQ     70
         6 005107   000052 356000 1                  ANSQ    ERR_CODE

     1627    14963    4              END;

  14963  6 005110   005236 710000 6                  TRA     s:15003

     1628    14964    3       CASE(INSPEC_CODE);                  /* INSPECN=...                        */

     1629    14965    3         NUM$ = RPT$BLK.SUB_BLK$(0)->RPT$BLK.SUB_BLK$(0);

  14965  6 005111   000003 471500                    LDP1    3,,PR0
         6 005112   100003 236100                    LDQ     3,,PR1
         6 005113   200024 756100                    STQ     NUM$,,AUTO

     1630    14966                                                /* POINTS TO TEXTC OF INDEX           */
     1631    14967    3         IF NUM$->TEXT$C.LEN > 1

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:251  
  14967  6 005114   200024 473500                    LDP3    NUM$,,AUTO
         6 005115   000100 101500                    MRL     fill='000'O
         6 005116   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 005117   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 005120   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 005121   000002 116007                    CMPQ    2,DL
         6 005122   005143 605000 6                  TPL     s:14970
         6 005123   000100 101500                    MRL     fill='000'O
         6 005124   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 005125   203375 000002                    ADSC9   TEMP_ERR+3,,AUTO         cn=0,n=2
         6 005126   203375 220100                    LDX0    TEMP_ERR+3,,AUTO
         6 005127   040000 106540                    CMPC    fill='040'O
         6 005130   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         6 005131   000107 000001 7                  ADSC9   71                       cn=0,n=1
         6 005132   005143 602000 6                  TNC     s:14970
         6 005133   000100 101500                    MRL     fill='000'O
         6 005134   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 005135   203376 000002                    ADSC9   TEMP_ERR+4,,AUTO         cn=0,n=2
         6 005136   203376 222100                    LDX2    TEMP_ERR+4,,AUTO
         6 005137   040140 106400                    CMPC    fill='040'O
         6 005140   000116 000001 7                  ADSC9   78                       cn=0,n=1
         6 005141   300000 200012                    ADSC9   0,,PR3                   cn=1,n=*X2
         6 005142   005153 603000 6                  TRC     s:14975

     1632    14968    3           OR NUM$->TEXT$C.STRING < '1'
     1633    14969    3           OR NUM$->TEXT$C.STRING > '3'
     1634    14970    3         THEN CALL ERR_PROC(17);

  14970  6 005143   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 005144   000001 235000 xsym               LDA     B_VECTNIL+1
         6 005145   203370 757100                    STAQ    @ELAB,,AUTO
         6 005146   000120 236000 7                  LDQ     80
         6 005147   203367 756100                    STQ     @CODE,,AUTO
         6 005150   001655 701000 6                  TSX1    ERR_PROC
         6 005151   000000 011000                    NOP     0
         6 005152   005236 710000 6                  TRA     s:15003

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:252  
     1635    14971        /*E* ERROR:   ARA-00017
     1636    14972             MESSAGE: INFOn must be INFO1, INFO2, OR INFO3.
     1637    14973        */
     1638    14974    4         ELSE DO;

     1639    14975    4              CALL CHARBIN(INDX,NUM$->TEXT$C.STRING);

  14975  6 005153   000100 101500                    MRL     fill='000'O
         6 005154   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 005155   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
         6 005156   203374 223100                    LDX3    TEMP_ERR+2,,AUTO
         6 005157   000100 305540                    DTB
         6 005160   300000 230013                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X3
         6 005161   200026 000004                    NDSC9   INDX,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     1640    14976    4              INDX  = INDX  - 1;

  14976  6 005162   000001 336007                    LCQ     1,DL
         6 005163   200026 056100                    ASQ     INDX,,AUTO

     1641    14977    4              IF RPT$BLK.NUM_SUB_BLKS = 1

  14977  6 005164   000001 223100                    LDX3    1,,PR0
         6 005165   000001 103003                    CMPX3   1,DU
         6 005166   005200 601000 6                  TNZ     s:14983

     1642    14978    5              THEN DO;                     /* MUST BLANK OUT FIELD               */

     1643    14979    5                   REC_BUF$->SCHED$TBL.INSPEC#(INDX) = '  ';

  14979  6 005167   200026 235100                    LDA     INDX,,AUTO
         6 005170   000004 735000                    ALS     4
         6 005171   000015 471400 2                  LDP1    REC_BUF$
         6 005172   040105 100400                    MLR     fill='040'O
         6 005173   000273 000002 2                  ADSC9   VBND+25                  cn=0,n=2
         6 005174   100002 000020                    ADSC9   2,A,PR1                  cn=0,n=16

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:253  
     1644    14980    5                   ERR_CODE.CODE = 0;

  14980  6 005175   000106 236000 7                  LDQ     70
         6 005176   000052 356000 1                  ANSQ    ERR_CODE

     1645    14981    5                   END;

  14981  6 005177   005236 710000 6                  TRA     s:15003

     1646    14982    5              ELSE DO;

     1647    14983    5                   STRING$ = RPT$BLK.SUB_BLK$(1)->RPT$BLK.SUB_BLK$(0);

  14983  6 005200   000004 471500                    LDP1    4,,PR0
         6 005201   100003 236100                    LDQ     3,,PR1
         6 005202   200025 756100                    STQ     STRING$,,AUTO

     1648    14984                                                /* POINTS TO TEXTC OF STRING          */
     1649    14985    5                   IF STRING$->TEXT$C.LEN > 16

  14985  6 005203   200025 474500                    LDP4    STRING$,,AUTO
         6 005204   000100 101500                    MRL     fill='000'O
         6 005205   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 005206   203374 000004                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=4
         6 005207   203374 236100                    LDQ     TEMP_ERR+2,,AUTO
         6 005210   000021 116007                    CMPQ    17,DL
         6 005211   005222 604000 6                  TMI     s:14992

     1650    14986    5                   THEN CALL ERR_PROC(19);

  14986  6 005212   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 005213   000001 235000 xsym               LDA     B_VECTNIL+1
         6 005214   203370 757100                    STAQ    @ELAB,,AUTO
         6 005215   000122 236000 7                  LDQ     82
         6 005216   203367 756100                    STQ     @CODE,,AUTO
         6 005217   001655 701000 6                  TSX1    ERR_PROC
         6 005220   000000 011000                    NOP     0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:254  
         6 005221   005236 710000 6                  TRA     s:15003

     1651    14987        /*E* ERROR:   ARA-00019
     1652    14988             MESSAGE: INFO value exceeds 16 characters.
     1653    14989        */
     1654    14990
     1655    14991    6                   ELSE DO;

     1656    14992    6                        REC_BUF$->SCHED$TBL.INSPEC#(INDX) =

  14992  6 005222   000100 101500                    MRL     fill='000'O
         6 005223   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 005224   203374 000002                    ADSC9   TEMP_ERR+2,,AUTO         cn=0,n=2
         6 005225   203374 223100                    LDX3    TEMP_ERR+2,,AUTO
         6 005226   200026 235100                    LDA     INDX,,AUTO
         6 005227   000004 735000                    ALS     4
         6 005230   000015 471400 2                  LDP1    REC_BUF$
         6 005231   040105 100540                    MLR     fill='040'O
         6 005232   400000 200013                    ADSC9   0,,PR4                   cn=1,n=*X3
         6 005233   100002 000020                    ADSC9   2,A,PR1                  cn=0,n=16

     1657    14993    6                          STRING$->TEXT$C.STRING;
     1658    14994                                                /* PUT INSPEC VALUE INTO ITS          */
     1659    14995                                                /* CORRECT SLOT IN THE SCHEDULE       */
     1660    14996                                                /* RATE TABLE LEFT JUSTIFIED AND      */
     1661    14997                                                /* BLANK FILLED                       */
     1662    14998    6                        ERR_CODE.CODE = 0;

  14998  6 005234   000106 236000 7                  LDQ     70
         6 005235   000052 356000 1                  ANSQ    ERR_CODE

     1663    14999    6                        END;

     1664    15000    5                   END;

     1665    15001    4              END;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:255  
     1666    15002    3         END;                              /* END CASE                           */

     1667    15003    2   END UPDATE_SCHED_TBL;

  15003  6 005236   200022 221300                    LDX1  ! FIRST_TIME,,AUTO
         6 005237   000001 702211                    TSX2  ! 1,X1

     1668    15004        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:256  
     1669    15005    1   UPDATE_TBL: PROC (TABLE_TYPE);          /* PROCEDURE TO CALL CORRECT          */

  15005  6 005240   200020 741300       UPDATE_TBL   STX1  ! RET_VAL,,AUTO

     1670    15006                                                /* TABLE UPDATE ROUTINE               */
     1671    15007    2   DCL TABLE_TYPE UBIN;
     1672    15008    2   DCL NOD$(0:6) CONSTANT PTR INIT( ADDR(SCHED_CMD_ROOT)*2, ADDR(RATE_CMD_ROOT),
     1673    15009    2      ADDR(SCHED_CMD_ROOT), ADDR(FORM_CMD_ROOT), ADDR(LCP6_CMD_ROOT),
     1674    15010    2      ADDR(COMM_CMD_ROOT));
     1675    15011    2   DCL VBND(0:6) CONSTANT UBIN INIT( SIZEV(SCHED$TBL)*2, SIZEV(RATE$TBL),
     1676    15012    2      SIZEV(PROC$TBL), SIZEV(FORM$TBL), SIZEV(LCP6$TBL),
     1677    15013    2      SIZEV(COMM$TBL));
     1678    15014    2   DCL NOD BIT(1) BASED ALIGNED;
     1679    15015    3      DO WHILE '1'B;

     1680    15016    3           CALL XUR$GETCMD(NOD$(TABLE_TYPE)->NOD,PCB.OUT$,BLD_MOD_PROMPT)

  15016  6 005241   200021 470500                    LDP0    @TABLE_TYPE,,AUTO
         6 005242   000000 720100                    LXL0    0,,PR0
         6 005243   000233 471410 2                  LDP1    NOD$,X0
         6 005244   000123 236000 7                  LDQ     83
         6 005245   203376 756100                    STQ     TEMP_ERR+4,,AUTO
         6 005246   200003 633500                    EPPR3   PCB,,AUTO
         6 005247   203375 453500                    STP3    TEMP_ERR+3,,AUTO
         6 005250   203374 451500                    STP1    TEMP_ERR+2,,AUTO
         6 005251   203374 630500                    EPPR0   TEMP_ERR+2,,AUTO
         6 005252   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 005253   000000 701000 xent               TSX1    XUR$GETCMD
         6 005254   005261 702000 6                  TSX2    END_UPDATE

     1681    15017    3             ALTRET (END_UPDATE);
     1682    15018    4           IF RPT$BLK.CODE=END_CODE THEN DO;

  15018  6 005255   200003 470500                    LDP0    PCB,,AUTO
         6 005256   000000 720100                    LXL0    0,,PR0
         6 005257   000003 100003                    CMPX0   3,DU
         6 005260   005313 601000 6                  TNZ     s:15030
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:257  

  15013  6 005261                       END_UPDATE   null
     1683    15019    4   END_UPDATE:  ;
     1684    15020    4                B$RATE_WRITE_FPT.BUF_.BOUND = VBND(TABLE_TYPE);

  15020  6 005261   200021 470500                    LDP0    @TABLE_TYPE,,AUTO
         6 005262   000000 720100                    LXL0    0,,PR0
         6 005263   000242 236010 2                  LDQ     VBND,X0
         6 005264   000020 736000                    QLS     16
         6 005265   000264 676000 1                  ERQ     B$RATE_WRITE_FPT+4
         6 005266   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 005267   000264 656000 1                  ERSQ    B$RATE_WRITE_FPT+4

     1685    15021    4                CALL M$WRITE(B$RATE_WRITE_FPT)

  15021  6 005270   000260 630400 1                  EPPR0   B$RATE_WRITE_FPT
         6 005271   440001 713400                    CLIMB   alt,write
         6 005272   401400 401760                    pmme    nvectors=4
         6 005273   005275 702000 6                  TSX2    s:15023
         6 005274   005307 710000 6                  TRA     s:15026

     1686    15022    5                WHENALTRETURN DO;

     1687    15023    5                     CALL ERR_PROC(MONERR);

  15023  6 005275   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 005276   000001 235000 xsym               LDA     B_VECTNIL+1
         6 005277   203370 757100                    STAQ    @ELAB,,AUTO
         6 005300   000007 236000 7                  LDQ     7
         6 005301   203367 756100                    STQ     @CODE,,AUTO
         6 005302   001655 701000 6                  TSX1    ERR_PROC
         6 005303   000000 011000                    NOP     0

     1688    15024    5                     UNWIND TO ERROR_EXIT;

  15024  6 005304   200006 237300                    LDAQ  ! ERROR_EXIT,,AUTO
         6 005305   000000 700200 xent               TSX0  ! X66_MAUNWIND
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:258  
         6 005306   000000 000200                    ZERO    0,128

     1689    15025    5                     END;
     1690    15026    4                ERR_CODE.CODE = 0;

  15026  6 005307   000106 236000 7                  LDQ     70
         6 005310   000052 356000 1                  ANSQ    ERR_CODE

     1691    15027    4                RETURN;

  15027  6 005311   200020 221300                    LDX1  ! RET_VAL,,AUTO
         6 005312   000001 702211                    TSX2  ! 1,X1

     1692    15028
     1693    15029    4                END;
     1694    15030    4           ELSE DO CASE (TABLE_TYPE);

  15030  6 005313   200021 471500                    LDP1    @TABLE_TYPE,,AUTO
         6 005314   100000 235100                    LDA     0,,PR1
         6 005315   000007 115007                    CMPA    7,DL
         6 005316   005320 602005 6                  TNC     s:15030+5,AL
         6 005317   005241 710000 6                  TRA     s:15016
         6 005320   005342 710000 6                  TRA     s:15040
         6 005321   005327 710000 6                  TRA     s:15032
         6 005322   005332 710000 6                  TRA     s:15034
         6 005323   005327 710000 6                  TRA     s:15032
         6 005324   005335 710000 6                  TRA     s:15036
         6 005325   005332 710000 6                  TRA     s:15034
         6 005326   005340 710000 6                  TRA     s:15038

     1695    15031    4            CASE(SCHED_CODE,PROC_CODE);

     1696    15032    4              CALL UPDATE_SCHED_TBL;

  15032  6 005327   005030 701000 6                  TSX1    UPDATE_SCHED_TBL
         6 005330   000000 011000                    NOP     0
         6 005331   005241 710000 6                  TRA     s:15016
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:259  

     1697    15033    4            CASE(RATE_CODE, LCP6_CODE);

     1698    15034    4              CALL UPDATE_RATE_TBL;

  15034  6 005332   004510 701000 6                  TSX1    UPDATE_RATE_TBL
         6 005333   000000 011000                    NOP     0
         6 005334   005241 710000 6                  TRA     s:15016

     1699    15035    4            CASE(FORM_CODE);

     1700    15036    4              CALL UPDATE_FORM_TBL;

  15036  6 005335   004442 701000 6                  TSX1    UPDATE_FORM_TBL
         6 005336   000000 011000                    NOP     0
         6 005337   005241 710000 6                  TRA     s:15016

     1701    15037    4            CASE(COMM_CODE);

     1702    15038    4              CALL UPDATE_COMM_TBL;

  15038  6 005340   005026 701000 6                  TSX1    UPDATE_COMM_TBL
         6 005341   000000 011000                    NOP     0

     1703    15039    4              END;                         /*END CASE*/

     1704    15040    3           END;

  15040  6 005342   005241 710000 6                  TRA     s:15016

     1705    15041    2   END UPDATE_TBL;
     1706    15042        %EJECT;
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:260  
     1707    15043    1   ZERO_TBL: PROC(TBL_TYPE);

  15043  6 005343   200020 741300       ZERO_TBL     STX1  ! RET_VAL,,AUTO

     1708    15044    2   DCL TBL_TYPE  SBIN WORD;
     1709    15045    2   DCL I SBIN WORD;
     1710    15046    2   DCL J SBIN WORD;
     1711    15047    2   DCL REC_BUF$ PTR;
     1712    15048    2      REC_BUF$ = ADDR(REC_BUF);

  15048  6 005344   000124 236000 7                  LDQ     84
         6 005345   200024 756100                    STQ     REC_BUF$,,AUTO

     1713    15049    2      REC_BUF = ' ';

  15049  6 005346   040000 100400                    MLR     fill='040'O
         6 005347   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005350   000350 000702 1                  ADSC9   REC_BUF                  cn=0,n=450

     1714    15050    3      DO CASE(TBL_TYPE);

  15050  6 005351   200021 470500                    LDP0    @TBL_TYPE,,AUTO
         6 005352   000000 235100                    LDA     0,,PR0
         6 005353   000006 115007                    CMPA    6,DL
         6 005354   005356 602005 6                  TNC     s:15050+5,AL
         6 005355   005465 710000 6                  TRA     s:15081
         6 005356   005465 710000 6                  TRA     s:15081
         6 005357   005460 710000 6                  TRA     s:15076
         6 005360   005403 710000 6                  TRA     s:15057
         6 005361   005460 710000 6                  TRA     s:15076
         6 005362   005364 710000 6                  TRA     s:15052
         6 005363   005403 710000 6                  TRA     s:15057

     1715    15051    3       CASE(FORM_CODE);

     1716    15052    4         DO I = 0 TO 3;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:261  
  15052  6 005364   200022 450100                    STZ     I,,AUTO

     1717    15053    4              REC_BUF$->PACKED$NUM$ARY(I) = '3'O;

  15053  6 005365   200022 235100                    LDA     I,,AUTO
         6 005366   000001 735000                    ALS     1
         6 005367   200024 470500                    LDP0    REC_BUF$,,AUTO
         6 005370   000000 620005                    EAX0    0,AL
         6 005371   000000 621005                    EAX1    0,AL
         6 005372   300000 235003                    LDA     98304,DU
         6 005373   000000 236003                    LDQ     0,DU
         6 005374   000000 755110                    STA     0,X0,PR0
         6 005375   000001 756111                    STQ     1,X1,PR0

     1718    15054    4              END;

  15054  6 005376   200022 054100                    AOS     I,,AUTO
         6 005377   200022 235100                    LDA     I,,AUTO
         6 005400   000003 115007                    CMPA    3,DL
         6 005401   005365 604400 6                  TMOZ    s:15053
         6 005402   005465 710000 6                  TRA     s:15081

     1719    15055
     1720    15056    3       CASE(RATE_CODE,LCP6_CODE);

     1721    15057    3         REC_BUF$->RATE$TBL.PERCENT# = %NO#;

  15057  6 005403   200024 471500                    LDP1    REC_BUF$,,AUTO
         6 005404   000031 236000 xsym               LDQ     B_VECTNIL+25
         6 005405   100000 356100                    ANSQ    0,,PR1

     1722    15058    4         DO I = 0 TO 3;

  15058  6 005406   200022 450100                    STZ     I,,AUTO

     1723    15059    4              REC_BUF$->RATE$TBL.JUNIT.RATE#(I) = '3'O;

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:262  
  15059  6 005407   200022 236100                    LDQ     I,,AUTO
         6 005410   000006 402007                    MPY     6,DL
         6 005411   200024 470500                    LDP0    REC_BUF$,,AUTO
         6 005412   000000 620006                    EAX0    0,QL
         6 005413   000000 621006                    EAX1    0,QL
         6 005414   300000 235003                    LDA     98304,DU
         6 005415   000000 236003                    LDQ     0,DU
         6 005416   000005 755110                    STA     5,X0,PR0
         6 005417   000006 756111                    STQ     6,X1,PR0

     1724    15060    4              REC_BUF$->RATE$TBL.SUNIT.RATE#(I) = '3'O;

  15060  6 005420   300000 235003                    LDA     98304,DU
         6 005421   000000 236003                    LDQ     0,DU
         6 005422   000035 755110                    STA     29,X0,PR0
         6 005423   000036 756110                    STQ     30,X0,PR0

     1725    15061    4              END;

  15061  6 005424   200022 054100                    AOS     I,,AUTO
         6 005425   200022 235100                    LDA     I,,AUTO
         6 005426   000003 115007                    CMPA    3,DL
         6 005427   005407 604400 6                  TMOZ    s:15059

     1726    15062    3         IF TBL_TYPE = RATE_CODE

  15062  6 005430   200021 471500                    LDP1    @TBL_TYPE,,AUTO
         6 005431   100000 235100                    LDA     0,,PR1
         6 005432   000002 115007                    CMPA    2,DL
         6 005433   005437 601000 6                  TNZ     s:15068

     1727    15063    4         THEN DO;

     1728    15064    4              REC_BUF$->RATE$TBL.LCP6# = '0'B;

  15064  6 005434   000125 236000 7                  LDQ     85
         6 005435   000000 356100                    ANSQ    0,,PR0
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:263  

     1729    15065    4              END;

  15065  6 005436   005441 710000 6                  TRA     s:15071

     1730    15066
     1731    15067    4         ELSE DO;

     1732    15068    4              REC_BUF$->RATE$TBL.LCP6# = '1'B;

  15068  6 005437   200000 236003                    LDQ     65536,DU
         6 005440   000000 256100                    ORSQ    0,,PR0

     1733    15069    4              END;

     1734    15070
     1735    15071    4         DO I=0 TO 24;

  15071  6 005441   200022 450100                    STZ     I,,AUTO

     1736    15072    4              ADDR(REC_BUF$->RATE$TBL.CMULT#)->PACKED$NUM$ARY(I) = '3'O;

  15072  6 005442   200022 235100                    LDA     I,,AUTO
         6 005443   000001 735000                    ALS     1
         6 005444   200024 470500                    LDP0    REC_BUF$,,AUTO
         6 005445   000000 620005                    EAX0    0,AL
         6 005446   000000 621005                    EAX1    0,AL
         6 005447   300000 235003                    LDA     98304,DU
         6 005450   000000 236003                    LDQ     0,DU
         6 005451   000061 755110                    STA     49,X0,PR0
         6 005452   000062 756111                    STQ     50,X1,PR0

     1737    15073    4              END;

  15073  6 005453   200022 054100                    AOS     I,,AUTO
         6 005454   200022 235100                    LDA     I,,AUTO
         6 005455   000030 115007                    CMPA    24,DL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:264  
         6 005456   005442 604400 6                  TMOZ    s:15072
         6 005457   005465 710000 6                  TRA     s:15081

     1738    15074
     1739    15075    3       CASE(SCHED_CODE,PROC_CODE);

     1740    15076    3         REC_BUF$->PROC$TBL.RTABLE# = '0';

  15076  6 005460   200024 471500                    LDP1    REC_BUF$,,AUTO
         6 005461   040100 100400                    MLR     fill='040'O
         6 005462   000126 000001 7                  ADSC9   86                       cn=0,n=1
         6 005463   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         6 005464   005465 710000 6                  TRA     s:15081

     1741    15077
     1742    15078    3       CASE(COMM_CODE);

     1743    15079
     1744    15080    3         END;                              /* END CASE                           */

     1745    15081    2      RETURN;

  15081  6 005465   200020 221300                    LDX1  ! RET_VAL,,AUTO
         6 005466   000001 702211                    TSX2  ! 1,X1

     1746    15082    2   END ZERO_TBL;
     1747    15083    1   END ARA$RATES;

  15083  6 005467   000000 702200 xent               TSX2  ! X66_MARET

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:265  
--  Include file information  --

   B_MACROS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AR_TBLS_C.:E05TOU  is referenced.
   AR_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ARA$RATES.
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:266  

 **** Variables and constants ****

  ****  Section 001  Data  ARA$RATES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   226-0-0/c STRC(72)    r     1 ACCT_RATES               274-0-0/d STRC(360)   r     1 B$RATE_DELREC_FPT
   132-0-0/d STRC(2088)  r     1 B$RATE_OPEN_FPT          242-0-0/d STRC(504)   r     1 B$RATE_READ_FPT
   224-0-0/c STRC(63)    r     1 B$RATE_VLP               260-0-0/d STRC(432)   r     1 B$RATE_WRITE_FPT
   531-0-0/c STRC(18)    r     1 DEFAULT_KEY_QUAL_TEXTC
   320-0-0/d STRC(216)   r     1 ERROR                     52-0-0/b STRC        r     1 ERR_CODE
    50-0-0/d VECT        r     1 FIELD1_                  326-0-0/c STRC(324)   r     1 FIRST_DEL_KEY
   560-0-0/d STRC(144)   r     1 FPT_PPRIV                230-0-0/d STRC(360)   r     1 FPT_PRECORD
   564-0-0/d STRC(144)   r     1 FPT_PRIV                 306-0-0/d STRC(360)   r     1 FPT_PROMPT
    54-0-0/d STRC(432)   r     1 FPT_WRITE_LO             532-0-0/c STRC(324)   r     1 IN_KEY
   337-0-0/c STRC(324)   r     1 LAST_DEL_KEY              70-0-0/c CHAR(132)   r     1 LO_OUT_BUF
   556-0-0/c STRC(54)    r     1 NUM_RECS_STRING          543-0-0/c STRC(324)   r     1 OUT_KEY
   555-0-0/b STRC        r     1 PHONY_KEY_QUAL_TEXTC     350-0-0/c CHAR(450)   r     1 REC_BUF
   350-0-0/c CHAR        r     1 REC_BUFB(0:449)          570-0-0/c CHAR(37)    r     1 RTABLE_FIELD
   570-0-0/c STRC(333)   r     1 RTABLE_FLD               554-0-0/w SBIN        r     1 TEST_MODE
     0-0-0/d STRC(1404)  r     1 XUR_INIT

  ****  Section 002 RoData ARA$RATES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w STRC(162)   r     1 B$RATE_ACSVEH             26-0-0/c STRC(27)    r     1 BLD_MOD_PROMPT
   232-0-0/c CHAR        r     1 DEC_PT                    30-0-0/c STRC(2016)  r     1 HDR_TXT
   200-0-0/d STRC(936)   r     1 LCP6_INFO                233-0-0/w PTR         r     1 NOD$(0:6)
    25-0-0/c STRC(18)    r     1 RATES_PROMPT             120-0-0/d STRC(1728)  r     1 RATE_INFO
    15-0-0/w PTR         r     1 REC_BUF$                  27-0-0/c STRC        r     1 TEST_PATTERN
   242-0-0/w UBIN        r     1 VBND(0:6)                 16-0-0/c CHAR(13)    r     1 ZERO_STRING

  ****  Auto variables  ****

PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:267  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    46-0-0/w PTR         r     1 @CHAR_BUF               3367-0-0/w PTR         r     1 @CODE
  3370-0-0/w PTR         r     1 @ELAB                   3347-0-0/w PTR         r     1 @EXIT_LOOP
  3347-0-0/w PTR         r     1 @EXIT_LOOP              3347-0-0/w PTR         r     1 @EXIT_LOOP
  3354-0-0/w PTR         r     1 @I                      3371-0-0/w PTR         r     1 @INCLCODE
  3350-0-0/w PTR         r     1 @KEYED_OR_NOT           3352-0-0/w PTR         r     1 @KEY_QUAL_TEXTC$
  3351-0-0/w PTR         r     1 @KEY_TEXTC              3351-0-0/w PTR         r     1 @KEY_TEXTC
  3353-0-0/w PTR         r     1 @MSG_INDX                 45-0-0/w PTR         r     1 @PACKED
    45-0-0/w PTR         r     1 @PACKED_NUM             3343-0-0/w PTR         r     1 @PROC_NAME_CODE
  3350-0-0/w PTR         r     1 @REC_TYPE               3347-0-0/w PTR         r     1 @REC_TYPE
    43-0-0/w PTR         r     1 @RET_VAL                3347-0-0/w PTR         r     1 @RET_VAL
  3347-0-0/w PTR         r     1 @RET_VAL                3353-0-0/w PTR         r     1 @RTABLE
    17-0-0/w PTR         r     1 @TABLE_TYPE               25-0-0/w PTR         r     1 @TABLE_TYPE
    25-0-0/w PTR         r     1 @TABLE_TYPE               21-0-0/w PTR         r     1 @TABLE_TYPE
    21-0-0/w PTR         r     1 @TBL_TYPE                 44-0-0/w PTR         r     1 @VALUE$
    70-0-0/w SBIN        r     1 AFTER_LEN                 64-0-0/w SBIN        r     1 BEFORE_LEN
    *0-0-0/c CHAR(19)    r     1 CHAR_BUF                  *0-0-0/w SBIN        r     1 CODE
    32-0-0/d STRC(72)    r     1 CTL_INFO                  13-0-0/w PTR         r     1 CUR_NODE$
    12-0-0/w PTR         r     1 CUR_NODE$                 12-0-0/w PTR         r     1 CUR_NODE$
    12-0-0/w PTR         r     1 CUR_NODE$                 16-0-0/w PTR         r     1 DCB$
    51-0-0/c STRC(135)   r     1 DEC_STRING
  3345-0-0/w PTR         r     1 DEFAULT_KEY_QUAL_TEXTC$
    54-0-0/w PTR         r     1 DIGIT$                    *0-0-0/w SBIN        r     1 ELAB
     6-0-0/d REMB        r     1 ERROR_EXIT              3345-0-0/w SBIN        r     1 EXIT_LOOP
    *0-0-0/w SBIN        r     1 EXIT_LOOP                 *0-0-0/w SBIN        r     1 EXIT_LOOP
    *0-0-0/w SBIN        r     1 EXIT_LOOP                 52-0-0/w SBIN        r     1 EXPONENT
    22-0-0/w SBIN        r     1 FIRST_TIME                51-0-0/w SBIN        r     1 FLIPPER
    34-0-0/c CHAR(19)    r     1 FMOUNT_RATE_VAL           27-0-0/c CHAR(19)    r     1 FORM_RATE_VAL
    17-0-0/w PTR         r     1 FROM_KEY_QUAL_TEXTC$      15-0-0/w SBIN        r     1 FROM_QUAL_TYPE_CODE
  3350-0-0/w SBIN        r     1 I                       3350-0-0/w SBIN        r     1 I
    *0-0-0/w SBIN        r     1 I                       3343-0-0/w SBIN        r     1 I
    26-0-0/w SBIN        r     1 I                         27-0-0/w SBIN        r     1 I
    27-0-0/w SBIN        r     1 I                         53-0-0/w SBIN        r     1 I
    22-0-0/w SBIN        r     1 I                         *0-0-0/w BIT         r     1 INCLCODE
    12-0-0/w SBIN        r     1 INDX                      23-0-0/w SBIN        r     1 INDX
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:268  
    26-0-0/w SBIN        r     1 INDX
    30-0-0/c CHAR(17)    r     1 INSPEC_VAL(0:2)
    15-0-0/w PTR         r     1 IN_KEY$                   11-0-0/w PTR         r     1 KEY$
    *0-0-0/w BIT         r     1 KEYED_OR_NOT            3354-0-0/c STRC(324)   r     1 KEY_BUF
    12-0-0/w PTR         r     1 KEY_QUAL_TEXTC$           13-0-0/w PTR         r     1 KEY_QUAL_TEXTC$
    *0-0-0/w PTR         r     1 KEY_QUAL_TEXTC$           13-0-0/w PTR         r     1 KEY_QUAL_TEXTC$
    13-0-0/w PTR         r     1 KEY_QUAL_TEXTC$           *0-0-0/c STRC(324)   r     1 KEY_TEXTC
    *0-0-0/c CHAR        r     1 KEY_TEXTC                 14-0-0/w SBIN        r     1 KEY_TYPE_CODE
    67-0-0/w SBIN        r     1 LEAD_0_LEN                 4-0-0/w PTR         r     1 M$SI$
    55-0-0/c STRC(126)   r     1 MANTISSA                  63-0-0/w SBIN        r     1 MAN_LEN
    *0-0-0/w SBIN        r     1 MSG_INDX                  34-0-0/w PTR         r     1 NAME$
    46-0-0/w PTR         r     1 NUM$                      33-0-0/w PTR         r     1 NUM$
    24-0-0/w PTR         r     1 NUM$                      47-0-0/w PTR         r     1 NUM1$
    17-0-0/w SBIN        r     1 NUM_RECS                  *0-0-0/d STRC(72)    r     1 PACKED
    *0-0-0/d BIT (72)    r     1 PACKED_NUM                24-0-0/d BIT (72)    r     1 PACKED_NUM
    26-0-0/d BIT (72)    r     1 PACKED_NUM                 3-0-0/w STRC        r     1 PCB
    16-0-0/w BIT         r     1 PERCENT
    14-0-0/w PTR         r     1 PHONY_KEY_QUAL_TEXTC$
    47-0-0/w SBIN        r     1 PRINT_LEN                 *0-0-0/w SBIN        r     1 PROC_NAME_CODE
    66-0-0/w SBIN        r     1 PT_LEN                    13-0-0/c STRC(57)    r     1 RATE_TBL(0:999)
    24-0-0/w PTR         r     1 REC_BUF$                3343-0-0/w SBIN        r     1 REC_TYPE
    *0-0-0/w SBIN        r     1 REC_TYPE                  *0-0-0/w SBIN        r     1 REC_TYPE
    15-0-0/w SBIN        r     1 REC_TYPE_CODE             14-0-0/w SBIN        r     1 REC_TYPE_CODE
    14-0-0/w SBIN        r     1 REC_TYPE_CODE             11-0-0/w SBIN        r     1 RET_VAL
  3344-0-0/w SBIN        r     1 RET_VAL                 3344-0-0/w SBIN        r     1 RET_VAL
    *0-0-0/w SBIN        r     1 RET_VAL                   11-0-0/w SBIN        r     1 RET_VAL
    *0-0-0/w SBIN        r     1 RET_VAL                   11-0-0/w SBIN        r     1 RET_VAL
    20-0-0/w SBIN        r     1 RET_VAL                   11-0-0/w SBIN        r     1 RET_VAL
    *0-0-0/w SBIN        r     1 RET_VAL                   23-0-0/w SBIN        r     1 RET_VAL
    24-0-0/w SBIN        r     1 RET_VAL                   *0-0-0/c CHAR(6)     r     1 RTABLE
    63-0-0/c CHAR        r     1 SIGN_CHAR                 72-0-0/c CHAR        r     1 SIGN_CHAR
    64-0-0/c CHAR(3)     r     1 SIGN_EXP                  50-0-0/w SBIN        r     1 SIZE
    25-0-0/w PTR         r     1 STRING$                   *0-0-0/w SBIN        r     1 TABLE_TYPE
    *0-0-0/w SBIN        r     1 TABLE_TYPE                *0-0-0/w SBIN        r     1 TABLE_TYPE
    *0-0-0/w UBIN        r     1 TABLE_TYPE                21-0-0/c CHAR(4)     r     1 TBL_PFX
    *0-0-0/w SBIN        r     1 TBL_TYPE                  42-0-0/d BIT (72)    r     1 TEMP
  3372-0-0/b STRC        r     1 TEMP_ERR                  50-0-0/w SBIN        r     1 TRAILING_ZEROES
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:269  
    65-0-0/w SBIN        r     1 TRAIL_0_LEN               25-0-0/w SBIN        r     1 TYPE
    35-0-0/c CHAR(16)    r     1 T_NAME                    *0-0-0/w PTR         r     1 VALUE$
    26-0-0/w PTR         r     1 VALUE$                    30-0-0/w PTR         r     1 VALUE$
    31-0-0/w PTR         r     1 VALUE_BASE$               30-0-0/c CHAR(3)     r     1 YES_NO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 B_VERSION                  0-0-0/b BIT         r     1 COMM_CMD_ROOT
     0-0-0/b BIT         r     1 FORM_CMD_ROOT              0-0-0/d STRC        r     1 INIT_COMM_TBL
     0-0-0/d STRC(288)   r     1 INIT_FORM_TBL              0-0-0/d STRC(3564)  r     1 INIT_LCP6_TBL
     0-0-0/d STRC(504)   r     1 INIT_PROC_TBL              0-0-0/d STRC(3564)  r     1 INIT_RATE_TBL
     0-0-0/d STRC(504)   r     1 INIT_SCHED_TBL             0-0-0/b BIT         r     1 LCP6_CMD_ROOT
     0-0-0/b BIT         r     1 RATE_CMD_ROOT              0-0-0/b BIT         r     1 SCHED_CMD_ROOT
     0-0-0/b BIT         r     1 TOP_CMD_ROOT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0N  NULL        r     1 B$RATE_DCB                 0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC        r     1 COMM$TBL
     0-0-0/d STRC(72)    r     1 CTL$INFO(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(288)   r     1 FORM$TBL
     0-0-0/c STRC(99)    r     1 FOUR$KEY                   0-0-0/d STRC(3564)  r     1 LCP6$TBL
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w BIT         r     1 NOD
     0-0-0/b UBIN(4)     r     1 ONE$NIBBLE                 0-0-0/w ASTR(153)   r     1 P$S
     0-0-0/w BIT (72)    r     1 PACKED$NUM$ARY(0:0)
     0-0-0/d STRC(504)   r     1 PROC$TBL                   0-0-0/d STRC(3564)  r     1 RATE$TBL
     0-0-0/w STRC(144)   r     1 RPT$BLK                    0-0-0/d STRC(504)   r     1 SCHED$TBL
     0-0-0/c ASTR(9)     r     1 TEXT$C
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:270  


   Procedure ARA$RATES requires 2872 words for executable code.
   Procedure ARA$RATES requires 1794 words of local(AUTO) storage.

    No errors detected in file ARA$RATES.:E05TSI    .
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:271  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:272  
          MINI XREF LISTING

ACCT_RATES
     12738**DCL     12627--DCLINIT
ACCT_RATES.ACCT#
     12738**DCL     14083<<ASSIGN
AFTER_LEN IN PROCEDURE DEC_PT_FORM
     14748**DCL     14772<<ASSIGN  14773>>CALLBLT
B$ALT.CODE
     13003**DCL     13003--REDEF   13004--REDEF   13004--REDEF
B$ALT.DCB#
     13004**DCL     13925<>CALL
B$ALT.ERR
     13004**DCL     13918>>ASSIGN
B$ALT.ERR.CODE
     13005**DCL     13440>>IF      13475>>IF      13537>>IF      13620>>IF      13890>>IF      14159>>IF
     14201>>IF      14617>>IF      14630>>IF
B$ALT.ERR.ERR#
     13005**DCL     13005--REDEF
B$ALT.EVID
     13004**DCL     13004--REDEF   13004--REDEF
B$JIT.CPFLAGS1.SLEAZE
     11654**DCL     11654--REDEF
B$JIT.ERR.MID
     11561**DCL     11561--REDEF
B$JIT.JRESPEAK
     11722**DCL     11723--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
     11831**DCL     11831--REDEF   11832--REDEF
B$JIT.PNR
     11735**DCL     11735--REDEF
B$JIT.PRIV.PRC
     11608**DCL     14088>>IF
B$JIT.SWITCH
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:273  
     11648**DCL     14078>>IF
B$JIT.TSLINE
     11829**DCL     11830--REDEF
B$JIT$
     12997**DCL     11555--IMP-PTR 14078>>IF      14088>>IF
B$RATE_ACSVEH
     12751**DCL     12625--DCLINIT
B$RATE_ACSVEH.Q
     12752**DCL     12751--DCLINIT
B$RATE_DCB
     12967**DCL     13881--ASSIGN
B$RATE_DELREC_FPT
     12905**DCL     13837<>CALL    13858<>CALL    13874<>CALL
B$RATE_DELREC_FPT.LKEY_
     12907**DCL     13835<<ASSIGN  13856<<ASSIGN  13872<<ASSIGN
B$RATE_DELREC_FPT.V
     12908**DCL     12905--DCLINIT
B$RATE_OPEN_FPT
     12622**DCL     14104<>CALL
B$RATE_OPEN_FPT.ACSVEH_
     12624**DCL     12625--REDEF
B$RATE_OPEN_FPT.ALTKEYS_
     12630**DCL     12631--REDEF   12631--REDEF
B$RATE_OPEN_FPT.HDR_
     12629**DCL     12630--REDEF
B$RATE_OPEN_FPT.TAB_
     12628**DCL     12629--REDEF
B$RATE_OPEN_FPT.UHL_
     12622**DCL     12623--REDEF   12623--REDEF
B$RATE_OPEN_FPT.V
     12631**DCL     12622--DCLINIT
B$RATE_OPEN_FPT.V.FSN#
     12662**DCL     12662--REDEF   12662--REDEF
B$RATE_OPEN_FPT.WSN_
     12628**DCL     12628--REDEF
B$RATE_READ_FPT
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:274  
     12834**DCL     14804<>CALL
B$RATE_READ_FPT.KEY_
     12834**DCL     14803<<ASSIGN
B$RATE_READ_FPT.STATION_
     12837**DCL     12838--REDEF
B$RATE_READ_FPT.V
     12838**DCL     12834--DCLINIT
B$RATE_READ_FPT.V.DVBYTE.REREAD#
     12849**DCL     12849--REDEF
B$RATE_READ_FPT.V.INDX#
     12847**DCL     12847--REDEF
B$RATE_READ_FPT.V.KEYR#
     12839**DCL     14802<<ASSIGN
B$RATE_READ_FPT.V.KEYS#
     12839**DCL     14801<<ASSIGN
B$RATE_VLP
     12723**DCL     12623--DCLINIT
B$RATE_WRITE_FPT
     12877**DCL     13540<>CALL    15021<>CALL
B$RATE_WRITE_FPT.BUF_.BOUND
     12877**DCL     14008<<ASSIGN  14012<<ASSIGN  14016<<ASSIGN  14020<<ASSIGN  14024<<ASSIGN  14028<<ASSIGN
     15020<<ASSIGN
B$RATE_WRITE_FPT.STATION_
     12879**DCL     12879--REDEF
B$RATE_WRITE_FPT.V
     12880**DCL     12877--DCLINIT
B$RATE_WRITE_FPT.V.DVBYTE.VFC#
     12886**DCL     12886--REDEF
B$TCB.ALT$
     12999**DCL     13440>>IF      13475>>IF      13537>>IF      13620>>IF      13890>>IF      13918>>ASSIGN
     13925>>CALL    14159>>IF      14201>>IF      14617>>IF      14630>>IF
B$TCB$
     12996**DCL     13440>>IF      13475>>IF      13537>>IF      13620>>IF      13890>>IF      13918>>ASSIGN
     13925>>CALL    14159>>IF      14201>>IF      14617>>IF      14630>>IF
BAD_READ IN PROCEDURE READ_B$RATE
     14807**LABEL   14804--CALLALT
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:275  
BEFORE_LEN IN PROCEDURE DEC_PT_FORM
     14744**DCL     14764<<ASSIGN  14773>>CALLBLT 14773>>CALLBLT
BLD_MOD_PROMPT
     12990**DCL     15016<>CALL
BUILD
     13408**PROC    13393--CALL
B_VERSION.LEN IN PROCEDURE INITIALIZE
     14074**DCL     14075--IMP-SIZ 14099>>CALLBLT
B_VERSION.TEXT IN PROCEDURE INITIALIZE
     14075**DCL     14099>>CALLBLT
CHAR_BUF IN PROCEDURE PACKED_TO_CHAR
     14650**DCL     14643--PROC    14664<<ASSIGN  14732<<CALLBLT 14756<<ASSIGN  14773<<CALLBLT
CHECK_DANGLING_RATES IN PROCEDURE CLEAN_UP
     13701**PROC    13586--CALL
CHECK_DEFAULTS
     13524**PROC    13571--CALL    14111--CALL
CHECK_PROC IN PROCEDURE PROCESS_SET
     13646**PROC    13614--CALL
CHECK_SCHED IN PROCEDURE PROCESS_SET
     13665**PROC    13616--CALL
CLEAN_UP
     13554**PROC    13402--CALL
CODE IN PROCEDURE ERR_PROC
     13910**DCL     13909--PROC    13917>>IF      13922>>ASSIGN
COMM$TBL
     12311**DCL     15013--DCLINIT
COMM_CMD_ROOT
     13013**DCL     15010--DCLINIT
CONVERT_TO_PACKED
     13748**PROC    14819--CALL    14855--CALL    14889--CALL
CONVPK
     13383**DCL-ENT 13783--CALL    13803--CALL
CTL$INFO IN PROCEDURE LIST_RATE
     14317**DCL     14481>>ASSIGN  14484<>CALL    14487>>ASSIGN  14490<>CALL    14507>>ASSIGN  14510<>CALL
     14513>>ASSIGN  14516<>CALL
CTL_INFO IN PROCEDURE LIST_RATE
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:276  
     14314**DCL     14481<<ASSIGN  14487<<ASSIGN  14507<<ASSIGN  14513<<ASSIGN
CTL_INFO.NAME IN PROCEDURE LIST_RATE
     14316**DCL     14483>>CALLBLT 14489>>CALLBLT 14509>>CALLBLT 14515>>CALLBLT
CTL_INFO.NDX IN PROCEDURE LIST_RATE
     14315**DCL     14482>>IF      14484>>CALL    14488>>IF      14490>>CALL    14508>>IF      14510>>CALL
     14514>>IF      14516>>CALL
CUR_NODE$ IN PROCEDURE BUILD
     13411**DCL     13417<<ASSIGN  13420>>IF      13422>>ASSIGN
CUR_NODE$ IN PROCEDURE DELETE
     13815**DCL     13841<<ASSIGN  13843>>IF      13862>>IF      13864>>ASSIGN
CUR_NODE$ IN PROCEDURE LIST_
     14118**DCL     14137<<ASSIGN  14139>>IF      14143>>IF      14145>>ASSIGN
CUR_NODE$ IN PROCEDURE MODIFY
     14596**DCL     14601<<ASSIGN  14603>>IF      14605>>ASSIGN
DCB$ IN PROCEDURE DELETE
     13823**DCL     13881<<ASSIGN  13882>>ASSIGN
DEC_PT IN PROCEDURE DEC_PT_FORM
     14751**DCL     14773>>CALLBLT
DEC_PT_FORM IN PROCEDURE PACKED_TO_CHAR
     14742**PROC    14718--CALL
DEC_STRING IN PROCEDURE CONVERT_TO_PACKED
     13755**DCL     13783<>CALL    13803<>CALL
DEC_STRING.EXP IN PROCEDURE CONVERT_TO_PACKED
     13759**DCL     13781<<ASSIGN  13782<<ASSIGN  13802<<ASSIGN
DEC_STRING.SIGN IN PROCEDURE CONVERT_TO_PACKED
     13756**DCL     13762<<ASSIGN
DEC_STRING.STRING IN PROCEDURE CONVERT_TO_PACKED
     13757**DCL     13776<<CALLBLT 13798<<CALLBLT
DEFAULT_KEY_QUAL_TEXTC
     12972**DCL     13421--ASSIGN  13463--ASSIGN  13528--ASSIGN  13863--ASSIGN  14144--ASSIGN  14604--ASSIGN
DEFAULT_KEY_QUAL_TEXTC$ IN PROCEDURE CHECK_DEFAULTS
     13527**DCL     13528<<ASSIGN  13531<>CALL
DELETE
     13812**PROC    13399--CALL
DEL_ALT IN PROCEDURE DELETE
     13890**LABEL   13837--CALLALT 13858--CALLALT 13874--CALLALT
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:277  
DIGIT$ IN PROCEDURE PACKED_TO_CHAR
     14656**DCL     14670<<ASSIGN  14672>>IF      14678>>ASSIGN  14686>>ASSIGN  14691<<ASSIGN  14691>>ASSIGN
ELAB IN PROCEDURE ERR_PROC
     13911**DCL     13909--PROC
END_UPDATE IN PROCEDURE UPDATE_TBL
     15013**LABEL   15016--CALLALT
ERROR
     12952**DCL     13406<>CALL
ERROR.V
     12952**DCL     12952--DCLINIT
ERROR.V.STEPCC#
     12953**DCL     12953--REDEF
ERROR_EXIT
     12993**DCL     13386<<REMEMBR 13443>>UNWIND  13487>>UNWIND  13543>>UNWIND  13548>>UNWIND  13623>>UNWIND
     13898>>UNWIND  14097>>UNWIND  14108>>UNWIND  14166>>UNWIND  14205>>UNWIND  14621>>UNWIND  14634>>UNWIND
     15024>>UNWIND
ERR_CODE.CODE
     12504**DCL     14830<<ASSIGN  14860<<ASSIGN  14931<<ASSIGN  14952<<ASSIGN  14962<<ASSIGN  14980<<ASSIGN
     14998<<ASSIGN  15026<<ASSIGN
ERR_EXIT
     13406**LABEL   13386--REMEMBR
ERR_PROC
     13909**PROC    13433--CALL    13442--CALL    13477--CALL    13484--CALL    13493--CALL    13498--CALL
     13542--CALL    13547--CALL    13622--CALL    13727--CALL    13769--CALL    13794--CALL    13885--CALL
     13892--CALL    13896--CALL    13952--CALL    13963--CALL    13974--CALL    14092--CALL    14107--CALL
     14160--CALL    14163--CALL    14204--CALL    14618--CALL    14620--CALL    14633--CALL    14876--CALL
     14904--CALL    14958--CALL    14970--CALL    14986--CALL    15023--CALL
EXIT_LOOP IN PROCEDURE CHECK_PROC
     13647**DCL     13646--PROC    13662<<ASSIGN
EXIT_LOOP IN PROCEDURE CHECK_SCHED
     13666**DCL     13665--PROC    13685<<ASSIGN
EXIT_LOOP IN PROCEDURE FILL_TBL
     13631**DCL     13630--PROC    13643<<ASSIGN
EXIT_LOOP IN PROCEDURE PROCESS_SET
     13592**DCL     13605<<ASSIGN  13606>>DOWHILE 13612<>CALL    13614<>CALL    13616<>CALL    13625<<ASSIGN
EXPONENT IN PROCEDURE PACKED_TO_CHAR
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:278  
     14654**DCL     14696<<ASSIGN  14700<<ASSIGN  14703<<ASSIGN  14704>>IF      14706>>ASSIGN  14708>>IF
     14710>>ASSIGN  14729<<ASSIGN  14729>>ASSIGN  14731>>CALLBLT 14764>>ASSIGN  14765>>ASSIGN  14766>>IF
     14771>>ASSIGN  14772>>ASSIGN
EXP_NOT_FORM IN PROCEDURE PACKED_TO_CHAR
     14721**PROC    14715--CALL
F$DCB.ACTPOS
      8765**DCL      8765--REDEF
F$DCB.ARS
      8740**DCL      8740--REDEF   13882>>ASSIGN
F$DCB.ATTR
      8758**DCL      8759--REDEF
F$DCB.BORROW
      8773**DCL      8773--REDEF    8773--REDEF    8773--REDEF
F$DCB.DCBNAME.L
      8787**DCL      8787--IMP-SIZ
F$DCB.EOMCHAR
      8744**DCL      8744--REDEF
F$DCB.FLDID
      8768**DCL      8768--REDEF
F$DCB.FORM$
      8762**DCL      8762--REDEF
F$DCB.FSECT
      8778**DCL      8778--REDEF
F$DCB.FSN
      8755**DCL      8755--REDEF    8755--REDEF    8756--REDEF
F$DCB.HEADER$
      8761**DCL      8761--REDEF
F$DCB.IXTNSIZE
      8759**DCL      8759--REDEF
F$DCB.LASTSTA$
      8749**DCL      8749--REDEF
F$DCB.LVL
      8774**DCL      8774--REDEF
F$DCB.NAME.C
      8749**DCL      8749--REDEF
F$DCB.NOEOF
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:279  
      8770**DCL      8770--REDEF
F$DCB.NRECS
      8760**DCL      8760--REDEF
F$DCB.NRECX
      8779**DCL      8779--REDEF
F$DCB.OHDR
      8771**DCL      8771--REDEF
F$DCB.ORG
      8754**DCL      8754--REDEF
F$DCB.PRECNO
      8777**DCL      8777--REDEF
F$DCB.RCSZ
      8782**DCL      8782--REDEF
F$DCB.RES
      8750**DCL      8750--REDEF
F$DCB.SETX
      8762**DCL      8762--REDEF
F$DCB.TAB$
      8761**DCL      8762--REDEF
F$DCB.TDA
      8776**DCL      8776--REDEF
F$DCB.WSN
      8751**DCL      8751--REDEF
FIELD1_
     12501**DCL     13726<<ASSIGN  13884<<ASSIGN  13925<>CALL
FILL_TBL IN PROCEDURE PROCESS_SET
     13630**PROC    13612--CALL
FIRST_DEL_KEY
     12956**DCL     12905--DCLINIT 12906--DCLINIT 13832<<ASSIGN  13847<>CALL    13866<>CALL
FIRST_TIME IN PROCEDURE LIST_ALL
     14177**DCL     14178<<ASSIGN  14214>>IF      14217<<ASSIGN
FLIPPER IN PROCEDURE PACKED_TO_CHAR
     14653**DCL     14669<<ASSIGN  14690<<ASSIGN  14690>>ASSIGN  14691>>ASSIGN
FMOUNT_RATE_VAL IN PROCEDURE LIST_FORM
     14266**DCL     14271<>CALL    14276>>CALLBLT
FORM$TBL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:280  
     11960**DCL     15012--DCLINIT
FORM$TBL.FMOUNT#
     11963**DCL     14270>>ASSIGN  14829<<ASSIGN
FORM$TBL.FORM#
     11961**DCL     14268>>ASSIGN  14827<<ASSIGN
FORM_CMD_ROOT
     13014**DCL     15009--DCLINIT
FORM_KEY
     13929**PROC    13424--CALL    13466--CALL    13531--CALL    13847--CALL    13852--CALL    13866--CALL
     14147--CALL    14606--CALL
FORM_RATE_VAL IN PROCEDURE LIST_FORM
     14265**DCL     14269<>CALL    14276>>CALLBLT
FOUR$KEY.NAME IN PROCEDURE CLEAN_UP
     13559**DCL     13632>>IF      13649>>IF      13668>>IF
FOUR$KEY.QUAL IN PROCEDURE CLEAN_UP
     13560**DCL     13635>>ASSIGN  13709<<ASSIGN
FPT_PPRIV IN PROCEDURE INITIALIZE
     14052**DCL     14089<>CALL
FPT_PPRIV.V IN PROCEDURE INITIALIZE
     14052**DCL     14052--DCLINIT
FPT_PRECORD
     12802**DCL     14628<>CALL
FPT_PRECORD.V
     12804**DCL     12802--DCLINIT
FPT_PRIV IN PROCEDURE INITIALIZE
     14069**DCL     14077<>CALL    14103<>CALL    14106<>CALL    14110<>CALL
FPT_PRIV.V IN PROCEDURE INITIALIZE
     14069**DCL     14069--DCLINIT
FPT_PROMPT.V
     12937**DCL     12931--DCLINIT
FPT_WRITE_LO
     12527**DCL     14101<>CALL    14259<>CALL    14281<>CALL    14306<>CALL    14494<>CALL    14520<>CALL
     14546<>CALL    14557<>CALL    14568<>CALL    14587<>CALL
FPT_WRITE_LO.STATION_
     12529**DCL     12529--REDEF
FPT_WRITE_LO.V
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:281  
     12530**DCL     12527--DCLINIT
FPT_WRITE_LO.V.DVBYTE.VFC#
     12536**DCL     12536--REDEF
FROM_KEY_QUAL_TEXTC$ IN PROCEDURE BUILD
     13415**DCL     13463<<ASSIGN  13464<<ASSIGN  13466<>CALL
FROM_QUAL_TYPE_CODE IN PROCEDURE BUILD
     13413**DCL     13457<<ASSIGN  13458>>IF      13462>>IF
GET_INDEX IN PROCEDURE PROCESS_SET
     13691**PROC    13654--CALL    13673--CALL
GET_INIT_TBL
     14003**PROC    13509--CALL    13539--CALL
GO_CLEANUP
     13393**LABEL   13389--CALLALT
HDR_TXT.ELS IN PROCEDURE OUT_HDR
     14249**DCL     14255>>ASSIGN
HDR_TXT.FRM IN PROCEDURE OUT_HDR
     14246**DCL     14253>>ASSIGN
I IN PROCEDURE CHECK_DANGLING_RATES
     13702**DCL     13705<<DOINDEX 13706>>IF      13706>>IF      13709>>ASSIGN
I IN PROCEDURE CHECK_PROC
     13648**DCL     13654<>CALL    13655>>IF      13657>>ASSIGN
I IN PROCEDURE CHECK_SCHED
     13667**DCL     13673<>CALL    13674>>IF      13676>>ASSIGN  13677>>IF
I IN PROCEDURE GET_INDEX
     13693**DCL     13691--PROC    13694<<ASSIGN  13695>>DOWHILE 13695>>DOWHILE 13696<<ASSIGN  13696>>ASSIGN
I IN PROCEDURE LIST_PROC_SCHED
     14286**DCL     14293<<DOINDEX 14294>>ASSIGN  14294>>ASSIGN
I IN PROCEDURE LIST_RATE
     14311**DCL     14479<<ASSIGN  14481>>ASSIGN  14486<<ASSIGN  14486>>ASSIGN  14487>>ASSIGN  14492<<ASSIGN
     14492>>ASSIGN  14505<<ASSIGN  14507>>ASSIGN  14512<<ASSIGN  14512>>ASSIGN  14513>>ASSIGN  14518<<ASSIGN
     14518>>ASSIGN  14535<<CALLBLT 14536>>CALLBLT 14540>>CALLBLT 14545>>CALL    14549<<DOINDEX 14550>>CALLBLT
     14550>>CALLBLT 14555>>CALL    14560<<DOINDEX 14561>>CALLBLT 14561>>CALLBLT 14566>>CALL
I IN PROCEDURE OUT_HDR
     14244**DCL     14252<<DOINDEX 14253>>ASSIGN  14255>>ASSIGN
I IN PROCEDURE PACKED_TO_CHAR
     14655**DCL     14671<<DOINDEX
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:282  
I IN PROCEDURE ZERO_TBL
     15045**DCL     15052<<DOINDEX 15053>>ASSIGN  15058<<DOINDEX 15059>>ASSIGN  15060>>ASSIGN  15071<<DOINDEX
     15072>>ASSIGN
INCLCODE IN PROCEDURE ERR_PROC
     13912**DCL     13909--PROC
INDX IN PROCEDURE CLEAN_UP
     13556**DCL     13568<<ASSIGN  13634<<ASSIGN  13634>>ASSIGN  13635>>ASSIGN  13638>>ASSIGN  13640>>ASSIGN
     13695>>DOWHILE 13705>>DOINDEX
INDX IN PROCEDURE UPDATE_RATE_TBL
     14837**DCL     14853<<ASSIGN  14858>>ASSIGN  14883<<CALLBLT 14884<<ASSIGN  14884>>ASSIGN  14918>>ASSIGN
     14922>>ASSIGN  14927>>ASSIGN  14929>>ASSIGN
INDX IN PROCEDURE UPDATE_SCHED_TBL
     14946**DCL     14975<<CALLBLT 14976<<ASSIGN  14976>>ASSIGN  14979>>ASSIGN  14992>>ASSIGN
INITIALIZE
     14034**PROC    13387--CALL
INIT_COMM_TBL
     13326**DCL     14027>>ASSIGN  14028--ASSIGN
INIT_FORM_TBL
     13144**DCL     14019>>ASSIGN  14020--ASSIGN
INIT_LCP6_TBL
     13210**DCL     14023>>ASSIGN  14024--ASSIGN
INIT_PROC_TBL
     13369**DCL     14015>>ASSIGN  14016--ASSIGN
INIT_RATE_TBL
     13029**DCL     14011>>ASSIGN  14012--ASSIGN
INIT_SCHED_TBL
     13342**DCL     14007>>ASSIGN  14008--ASSIGN
INSPEC_VAL IN PROCEDURE LIST_PROC_SCHED
     14287**DCL     14294<<ASSIGN  14301>>CALLBLT 14301>>CALLBLT 14301>>CALLBLT
IN_KEY
     12975**DCL     12802--DCLINIT 12803--DCLINIT 13466<>CALL    13472<>CALL    13570--ASSIGN  13607<>CALL
     14123--ASSIGN  14147<>CALL    14153<>CALL    14198<>CALL
IN_KEY.LEN
     12976**DCL     13593<<ASSIGN  13703<<ASSIGN  13725>>ASSIGN  14179<<ASSIGN
IN_KEY.STRING
     12977**DCL     13596<<ASSIGN  13598<<ASSIGN  13600<<ASSIGN  13704<<ASSIGN  13721>>CALLBLT 13721>>CALLBLT
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:283  
     14194<<ASSIGN  14197<<ASSIGN  14208>>IF      14272>>CALLBLT 14272>>CALLBLT 14297>>CALLBLT 14297>>CALLBLT
     14535>>CALLBLT 14536>>CALLBLT 14536>>CALLBLT 14582>>CALLBLT 14582>>CALLBLT
IN_KEY$ IN PROCEDURE LIST_
     14121**DCL     14123<<ASSIGN
KEY$ IN PROCEDURE CLEAN_UP
     13555**DCL     13570<<ASSIGN  13632>>IF      13635>>ASSIGN  13649>>IF      13668>>IF      13709>>ASSIGN
KEYED_OR_NOT IN PROCEDURE READ_B$RATE
     14799**DCL     14785--PROC    14801>>ASSIGN  14802>>ASSIGN
KEY_BUF IN PROCEDURE OUT_CLEAN_UP_MSG
     13718**DCL     13726--ASSIGN
KEY_BUF.LEN IN PROCEDURE OUT_CLEAN_UP_MSG
     13719**DCL     13725<<ASSIGN
KEY_BUF.STRING IN PROCEDURE OUT_CLEAN_UP_MSG
     13720**DCL     13721<<CALLBLT
KEY_QUAL_TEXTC$ IN PROCEDURE BUILD
     13410**DCL     13421<<ASSIGN  13422<<ASSIGN  13424<>CALL
KEY_QUAL_TEXTC$ IN PROCEDURE DELETE
     13816**DCL     13863<<ASSIGN  13864<<ASSIGN  13866<>CALL
KEY_QUAL_TEXTC$ IN PROCEDURE FORM_KEY
     13945**DCL     13929--PROC    13949>>IF      13960>>IF      13971>>IF      13990>>ASSIGN  13999>>ASSIGN
     13999>>ASSIGN
KEY_QUAL_TEXTC$ IN PROCEDURE LIST_
     14119**DCL     14144<<ASSIGN  14145<<ASSIGN  14147<>CALL
KEY_QUAL_TEXTC$ IN PROCEDURE MODIFY
     14597**DCL     14604<<ASSIGN  14605<<ASSIGN  14606<>CALL
KEY_TEXTC IN PROCEDURE FORM_KEY
     13941**DCL     13929--PROC
KEY_TEXTC.LEN IN PROCEDURE FORM_KEY
     13942**DCL     13984<<ASSIGN  13987<<ASSIGN  13990<<ASSIGN  13993<<ASSIGN  13996<<ASSIGN
KEY_TEXTC.QUAL IN PROCEDURE FORM_KEY
     13944**DCL     13999<<ASSIGN
KEY_TEXTC.TYPE IN PROCEDURE FORM_KEY
     13943**DCL     13985<<ASSIGN  13988<<ASSIGN  13991<<ASSIGN  13994<<ASSIGN  13997<<ASSIGN
KEY_TEXTC IN PROCEDURE READ_B$RATE
     14800**DCL     14785--PROC    14803--ASSIGN
KEY_TYPE_CODE IN PROCEDURE BUILD
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:284  
     13412**DCL     13416<<ASSIGN  13424<>CALL    13459<>CALL    13466<>CALL    13489>>IF      13509<>CALL
     13513>>IF      13513>>IF      13516<>CALL
LAST_DEL_KEY
     12959**DCL     13833<<ASSIGN  13835--ASSIGN  13852<>CALL    13856--ASSIGN
LCP6$TBL
     12195**DCL     15012--DCLINIT
LCP6_CMD_ROOT
     13012**DCL     15009--DCLINIT
LCP6_INFO IN PROCEDURE LIST_RATE
     14423**DCL     14507--ASSIGN  14513--ASSIGN
LEAD_0_LEN IN PROCEDURE DEC_PT_FORM
     14747**DCL     14771<<ASSIGN  14773>>CALLBLT
LIST_
     14116**PROC    13397--CALL
LIST_ALL IN PROCEDURE LIST_
     14173**PROC    14128--CALL    14129--CALL    14130--CALL    14131--CALL    14132--CALL    14133--CALL
     14140--CALL
LIST_COMM IN PROCEDURE LIST_
     14579**PROC    14237--CALL
LIST_FORM IN PROCEDURE LIST_
     14264**PROC    14229--CALL
LIST_JSUNIT IN PROCEDURE LIST_RATE
     14530**PROC    14477--CALL    14503--CALL
LIST_LCP6 IN PROCEDURE LIST_RATE
     14501**ENTRY   14235--CALL
LIST_ONE IN PROCEDURE LIST_
     14225**PROC    14157--CALL    14219--CALL
LIST_PROC_SCHED IN PROCEDURE LIST_
     14285**PROC    14231--CALL
LIST_RATE IN PROCEDURE LIST_
     14310**PROC    14233--CALL
LO_OUT_BUF
     12541**DCL     12528--DCLINIT 12529--DCLINIT 14082<<ASSIGN  14099<<CALLBLT 14122<<ASSIGN  14253<<ASSIGN
     14255<<ASSIGN  14257<<ASSIGN  14272<<CALLBLT 14276<<CALLBLT 14297<<CALLBLT 14301<<CALLBLT 14483<<CALLBLT
     14484<>CALL    14489<<CALLBLT 14490<>CALL    14509<<CALLBLT 14510<>CALL    14515<<CALLBLT 14516<>CALL
     14536<<CALLBLT 14540<<CALLBLT 14545<>CALL    14548<<ASSIGN  14550<<CALLBLT 14555<>CALL    14561<<CALLBLT
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:285  
     14566<>CALL    14581<<ASSIGN  14582<<CALLBLT
M$DELREC
      5531**DCL-ENT 13837--CALL    13858--CALL    13874--CALL
M$EXIT
      5541**DCL-ENT 13406--CALL
M$OPEN
      5529**DCL-ENT 14104--CALL
M$PRECORD
      5533**DCL-ENT 14628--CALL
M$PRECORD_CALL
     14627**PROC    13602--CALL    14195--CALL
M$READ
      5530**DCL-ENT 14804--CALL
M$RPRIV
      5588**DCL-ENT 14077--CALL    14106--CALL    14110--CALL
M$SI
     12968**DCL     14112--ASSIGN
M$SI$
     12969**DCL     14112<<ASSIGN
M$SPRIV
      5588**DCL-ENT 14089--CALL    14103--CALL
M$WRITE
      5530**DCL-ENT 13540--CALL    14101--CALL    14259--CALL    14281--CALL    14306--CALL    14494--CALL
     14520--CALL    14546--CALL    14557--CALL    14568--CALL    14587--CALL    15021--CALL
MANTISSA.LEN IN PROCEDURE PACKED_TO_CHAR
     14658**DCL     14667<<ASSIGN  14674>>IF      14678>>ASSIGN  14680<<ASSIGN  14680>>ASSIGN  14686>>ASSIGN
     14688<<ASSIGN  14688>>ASSIGN  14693<<ASSIGN  14693>>ASSIGN  14694>>IF      14706>>ASSIGN  14708>>IF
     14710>>ASSIGN  14712>>ASSIGN  14729>>ASSIGN  14732>>CALLBLT 14752>>ASSIGN
MANTISSA.STRING IN PROCEDURE PACKED_TO_CHAR
     14659**DCL     14660--REDEF   14665<<ASSIGN  14732>>CALLBLT 14732>>CALLBLT 14773>>CALLBLT 14773>>CALLBLT
MANTISSA.STRING_ARY.NUM IN PROCEDURE PACKED_TO_CHAR
     14662**DCL     14678<<ASSIGN  14686<<ASSIGN
MAN_LEN IN PROCEDURE DEC_PT_FORM
     14743**DCL     14752<<ASSIGN  14754>>IF      14764>>ASSIGN  14764>>ASSIGN  14771>>ASSIGN  14772>>ASSIGN
MODIFY
     14593**PROC    13395--CALL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:286  
MSG_INDX IN PROCEDURE OUT_CLEAN_UP_MSG
     13717**DCL     13716--PROC    13727<>CALL
NAME$ IN PROCEDURE PROCESS_JSUNIT
     14869**DCL     14899<<ASSIGN  14902>>IF      14910>>ASSIGN  14910>>ASSIGN
NOD IN PROCEDURE UPDATE_TBL
     15014**DCL     15016<>CALL
NOD$ IN PROCEDURE UPDATE_TBL
     15008**DCL     15016>>CALL
NUM$ IN PROCEDURE CONVERT_TO_PACKED
     13752**DCL     13763<<ASSIGN  13767>>IF      13776>>CALLBLT 13776>>CALLBLT 13776>>CALLBLT 13782>>ASSIGN
     13791>>ASSIGN  13798>>CALLBLT 13798>>CALLBLT
NUM$ IN PROCEDURE PROCESS_JSUNIT
     14868**DCL     14871<<ASSIGN  14873>>IF      14873>>IF      14873>>IF      14873>>IF      14873>>IF
     14883>>CALLBLT 14883>>CALLBLT
NUM$ IN PROCEDURE UPDATE_SCHED_TBL
     14944**DCL     14955<<ASSIGN  14957>>IF      14961>>ASSIGN  14961>>ASSIGN  14965<<ASSIGN  14967>>IF
     14967>>IF      14967>>IF      14967>>IF      14967>>IF      14975>>CALLBLT 14975>>CALLBLT
NUM1$ IN PROCEDURE CONVERT_TO_PACKED
     13753**DCL     13789<<ASSIGN  13791>>ASSIGN  13798>>CALLBLT 13798>>CALLBLT 13802>>ASSIGN
NUM_RECS IN PROCEDURE DELETE
     13824**DCL     13882<<ASSIGN  13883>>CALLBLT
NUM_RECS_STRING IN PROCEDURE DELETE
     13825**DCL     13884--ASSIGN
NUM_RECS_STRING.C IN PROCEDURE DELETE
     13827**DCL     13883<<CALLBLT
ONE$NIBBLE IN PROCEDURE PACKED_TO_CHAR
     14663**DCL     14672>>IF      14678>>ASSIGN  14686>>ASSIGN
OUT_CLEAN_UP_MSG IN PROCEDURE CLEAN_UP
     13716**PROC    13659--CALL    13679--CALL    13682--CALL    13710--CALL
OUT_HDR IN PROCEDURE LIST_
     14242**PROC    14156--CALL    14216--CALL
OUT_KEY
     12978**DCL     12877--DCLINIT 13424<>CALL    13430<>CALL    13531<>CALL    13535<>CALL    14606<>CALL
     14612<>CALL
P$S.COUNT
     12492**DCL     12495--IMP-SIZ
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:287  
PACKED IN PROCEDURE PACKED_TO_CHAR
     14644**DCL     14643--PROC
PACKED.DIGITS IN PROCEDURE PACKED_TO_CHAR
     14647**DCL     14670--ASSIGN
PACKED.EXP IN PROCEDURE PACKED_TO_CHAR
     14649**DCL     14698>>IF      14700>>ASSIGN  14703>>ASSIGN
PACKED.SIGN IN PROCEDURE PACKED_TO_CHAR
     14646**DCL     14724>>IF      14759>>IF
PACKED$NUM$ARY
     12966**DCL     14858<<ASSIGN  15053<<ASSIGN  15072<<ASSIGN
PACKED_NUM IN PROCEDURE CONVERT_TO_PACKED
     13751**DCL     13748--PROC    13783<>CALL    13803<>CALL
PACKED_NUM IN PROCEDURE UPDATE_FORM_TBL
     14813**DCL     14819<>CALL    14827>>ASSIGN  14829>>ASSIGN
PACKED_NUM IN PROCEDURE UPDATE_RATE_TBL
     14840**DCL     14855<>CALL    14858>>ASSIGN  14889<>CALL    14893<<ASSIGN  14917>>IF      14918>>ASSIGN
     14926>>IF      14927>>ASSIGN
PACKED_TO_CHAR
     14643**PROC    14269--CALL    14271--CALL    14484--CALL    14490--CALL    14510--CALL    14516--CALL
     14545--CALL    14555--CALL    14566--CALL
PCB.OUT$
     12316**DCL     12423--IMP-PTR 13389<>CALL    13391>>DOCASE  13416>>ASSIGN  13417>>ASSIGN  13449>>IF
     13455>>IF      13457>>ASSIGN  13464>>ASSIGN  13829>>ASSIGN  13841>>ASSIGN  14124>>ASSIGN  14137>>ASSIGN
     14599>>ASSIGN  14601>>ASSIGN  14816>>DOCASE  14818>>ASSIGN  14825>>IF      14846>>DOCASE  14850>>ASSIGN
     14852>>ASSIGN  14871>>ASSIGN  14885>>IF      14887>>ASSIGN  14895>>IF      14897>>IF      14899>>ASSIGN
     14915>>IF      14947>>DOCASE  14949>>IF      14955>>ASSIGN  14965>>ASSIGN  14977>>IF      14983>>ASSIGN
     15016<>CALL    15018>>IF
PERCENT IN PROCEDURE BUILD
     13414**DCL     13450<<ASSIGN  13451<<ASSIGN  13489>>IF      13491>>IF      13514>>ASSIGN
PHONY_KEY_QUAL_TEXTC IN PROCEDURE DELETE
     13817**DCL     13828--ASSIGN
PHONY_KEY_QUAL_TEXTC.STRING IN PROCEDURE DELETE
     13819**DCL     13846<<ASSIGN  13851<<ASSIGN
PHONY_KEY_QUAL_TEXTC$ IN PROCEDURE DELETE
     13821**DCL     13828<<ASSIGN  13847<>CALL    13852<>CALL
PREC_ALT IN PROCEDURE M$PRECORD_CALL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:288  
     14630**LABEL   14628--CALLALT
PRINT_LEN IN PROCEDURE PACKED_TO_CHAR
     14651**DCL     14706<<ASSIGN  14710<<ASSIGN  14712<<ASSIGN  14713>>IF
PROC$TBL
     11981**DCL     15012--DCLINIT
PROC$TBL.INSPEC#
     11987**DCL     14294>>ASSIGN
PROC$TBL.RTABLE#
     11982**DCL     13654<>CALL    14296>>ASSIGN  15076<<ASSIGN
PROCESS_JSUNIT IN PROCEDURE UPDATE_RATE_TBL
     14867**PROC    14848--CALL
PROCESS_SET IN PROCEDURE CLEAN_UP
     13589**PROC    13574--CALL    13577--CALL    13581--CALL
PROC_NAME_CODE IN PROCEDURE PROCESS_SET
     13591**DCL     13589--PROC    13594>>DOCASE  13610>>DOCASE
PT_LEN IN PROCEDURE DEC_PT_FORM
     14746**DCL     14768<<ASSIGN  14770<<ASSIGN  14773>>CALLBLT
RATE$TBL
     12035**DCL     15011--DCLINIT
RATE$TBL.CMULT#
     12077**DCL     14484--CALL    14490--CALL    14510--CALL    14516--CALL    14545<>CALL    14844--ASSIGN
     15072--ASSIGN
RATE$TBL.JUNIT.NAME#
     12047**DCL     14550>>CALLBLT 14922<<ASSIGN
RATE$TBL.JUNIT.RATE#
     12054**DCL     14555<>CALL    14918<<ASSIGN  15059<<ASSIGN
RATE$TBL.LCP6#
     12040**DCL     14211>>IF      15064<<ASSIGN  15068<<ASSIGN
RATE$TBL.PERCENT#
     12036**DCL     13489>>IF      13514<<ASSIGN  13636>>IF      14531>>IF      15057<<ASSIGN
RATE$TBL.SUNIT.NAME#
     12064**DCL     14561>>CALLBLT 14929<<ASSIGN
RATE$TBL.SUNIT.RATE#
     12071**DCL     14566<>CALL    14927<<ASSIGN  15060<<ASSIGN
RATES_PROMPT
     12987**DCL     13389<>CALL
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:289  
RATE_CMD_ROOT
     13011**DCL     15008--DCLINIT
RATE_INFO IN PROCEDURE LIST_RATE
     14325**DCL     14481--ASSIGN  14487--ASSIGN
RATE_TBL IN PROCEDURE CLEAN_UP
     13561**DCL     13567<<ASSIGN
RATE_TBL.FLAGS IN PROCEDURE CLEAN_UP
     13563**DCL     13638<<ASSIGN  13640<<ASSIGN
RATE_TBL.FLAGS.EXISTS IN PROCEDURE CLEAN_UP
     13564**DCL     13655>>IF      13674>>IF      13706>>IF
RATE_TBL.FLAGS.PERCENT IN PROCEDURE CLEAN_UP
     13565**DCL     13677>>IF
RATE_TBL.FLAGS.POINTED_TO IN PROCEDURE CLEAN_UP
     13566**DCL     13657<<ASSIGN  13676<<ASSIGN  13706>>IF
RATE_TBL.KEY_QUAL IN PROCEDURE CLEAN_UP
     13562**DCL     13635<<ASSIGN  13695>>DOWHILE 13709>>ASSIGN
READ_B$RATE
     14785**PROC    13430--CALL    13472--CALL    13535--CALL    13607--CALL    14153--CALL    14198--CALL
     14612--CALL
REC_BUF
     12963**DCL     12836--DCLINIT 12837--DCLINIT 12878--DCLINIT 12879--DCLINIT 12964--REDEF   12965--DCLINIT
     15048--ASSIGN  15049<<ASSIGN
REC_BUF$
     12965**DCL     13489>>IF      13514>>ASSIGN  13636>>IF      13654>>CALL    13673>>CALL    14211>>IF
     14268>>ASSIGN  14270>>ASSIGN  14294>>ASSIGN  14296>>ASSIGN  14484>>CALL    14490>>CALL    14510>>CALL
     14516>>CALL    14531>>IF      14545>>CALL    14550>>CALLBLT 14555>>CALL    14561>>CALLBLT 14566>>CALL
     14827>>ASSIGN  14829>>ASSIGN  14844>>ASSIGN  14918>>ASSIGN  14922>>ASSIGN  14927>>ASSIGN  14929>>ASSIGN
     14951>>ASSIGN  14961>>ASSIGN  14979>>ASSIGN  14992>>ASSIGN
REC_BUF$ IN PROCEDURE ZERO_TBL
     15047**DCL     15048<<ASSIGN  15053>>ASSIGN  15057>>ASSIGN  15059>>ASSIGN  15060>>ASSIGN  15064>>ASSIGN
     15068>>ASSIGN  15072>>ASSIGN  15076>>ASSIGN
REC_BUFB
     12964**DCL     14007<<ASSIGN  14011<<ASSIGN  14015<<ASSIGN  14019<<ASSIGN  14023<<ASSIGN  14027<<ASSIGN
REC_TYPE IN PROCEDURE CHECK_DEFAULTS
     13525**DCL     13530<<DOINDEX 13531<>CALL    13539<>CALL
REC_TYPE IN PROCEDURE FORM_KEY
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:290  
     13946**DCL     13929--PROC    13947>>DOCASE  13982>>DOCASE
REC_TYPE IN PROCEDURE GET_INIT_TBL
     14004**DCL     14003--PROC    14005>>DOCASE
REC_TYPE_CODE IN PROCEDURE DELETE
     13822**DCL     13829<<ASSIGN  13830>>IF      13847<>CALL    13852<>CALL    13866<>CALL
REC_TYPE_CODE IN PROCEDURE LIST_
     14120**DCL     14124<<ASSIGN  14125>>IF      14140<>CALL    14147<>CALL    14156<>CALL    14157<>CALL
REC_TYPE_CODE IN PROCEDURE MODIFY
     14598**DCL     14599<<ASSIGN  14606<>CALL    14615<>CALL
RET_VAL IN PROCEDURE BUILD
     13409**DCL     13424<>CALL    13428>>IF      13430<>CALL    13431>>IF      13466<>CALL    13470>>IF
     13472<>CALL    13473>>IF
RET_VAL IN PROCEDURE CHECK_DEFAULTS
     13526**DCL     13531<>CALL    13535<>CALL    13536>>IF
RET_VAL IN PROCEDURE CONVERT_TO_PACKED
     13749**DCL     13748--PROC    13773<<ASSIGN  13786<<ASSIGN  13795<<ASSIGN  13806<<ASSIGN
RET_VAL IN PROCEDURE DELETE
     13814**DCL     13847<>CALL    13852<>CALL    13866<>CALL    13870>>IF
RET_VAL IN PROCEDURE FORM_KEY
     13940**DCL     13929--PROC    13956<<ASSIGN  13967<<ASSIGN  13978<<ASSIGN  14000<<ASSIGN
RET_VAL IN PROCEDURE LIST_
     14117**DCL     14147<>CALL    14151>>IF      14153<>CALL    14154>>IF
RET_VAL IN PROCEDURE LIST_ALL
     14175**DCL     14198<>CALL    14199>>IF
RET_VAL IN PROCEDURE MODIFY
     14595**DCL     14606<>CALL    14610>>IF      14612<>CALL    14613>>IF
RET_VAL IN PROCEDURE PROCESS_SET
     13590**DCL     13607<>CALL    13608>>IF
RET_VAL IN PROCEDURE READ_B$RATE
     14798**DCL     14785--PROC    14805<<ASSIGN  14807<<ASSIGN
RET_VAL IN PROCEDURE UPDATE_FORM_TBL
     14812**DCL     14819<>CALL    14822>>IF
RET_VAL IN PROCEDURE UPDATE_RATE_TBL
     14838**DCL     14855<>CALL    14856>>IF      14889<>CALL    14890>>IF
RPT$BLK.CODE
     12431**DCL     13391>>DOCASE  13416>>ASSIGN  13420>>IF      13457>>ASSIGN  13779>>IF      13829>>ASSIGN
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:291  
     13843>>IF      13862>>IF      14124>>ASSIGN  14139>>IF      14143>>IF      14599>>ASSIGN  14603>>IF
     14816>>DOCASE  14825>>IF      14846>>DOCASE  14852>>ASSIGN  14915>>IF      14947>>DOCASE  15018>>IF
RPT$BLK.NUM_SUB_BLKS
     12435**DCL     13449>>IF      13455>>IF      13766>>IF      14885>>IF      14895>>IF      14897>>IF
     14949>>IF      14977>>IF
RPT$BLK.SUB_BLK$
     12456**DCL     13416>>ASSIGN  13417>>ASSIGN  13417>>ASSIGN  13422>>ASSIGN  13449>>IF      13457>>ASSIGN
     13464>>ASSIGN  13464>>ASSIGN  13763>>ASSIGN  13763>>ASSIGN  13779>>IF      13789>>ASSIGN  13789>>ASSIGN
     13829>>ASSIGN  13841>>ASSIGN  13841>>ASSIGN  13864>>ASSIGN  14124>>ASSIGN  14137>>ASSIGN  14137>>ASSIGN
     14145>>ASSIGN  14599>>ASSIGN  14601>>ASSIGN  14601>>ASSIGN  14605>>ASSIGN  14818>>ASSIGN  14850>>ASSIGN
     14852>>ASSIGN  14871>>ASSIGN  14871>>ASSIGN  14885>>IF      14887>>ASSIGN  14887>>ASSIGN  14897>>IF
     14899>>ASSIGN  14899>>ASSIGN  14899>>ASSIGN  14915>>IF      14955>>ASSIGN  14955>>ASSIGN  14965>>ASSIGN
     14965>>ASSIGN  14983>>ASSIGN  14983>>ASSIGN
RTABLE IN PROCEDURE GET_INDEX
     13692**DCL     13691--PROC    13695>>DOWHILE
RTABLE_FIELD IN PROCEDURE LIST_PROC_SCHED
     14288**DCL     14289--REDEF   14301>>CALLBLT
RTABLE_FLD.R# IN PROCEDURE LIST_PROC_SCHED
     14291**DCL     14296<<ASSIGN
SCHED$TBL
     12008**DCL     15011--DCLINIT
SCHED$TBL.INSPEC#
     12014**DCL     14979<<ASSIGN  14992<<ASSIGN
SCHED$TBL.RTABLE#
     12009**DCL     13673<>CALL    14951<<ASSIGN  14961<<ASSIGN
SCHED_CMD_ROOT
     13015**DCL     15008--DCLINIT 15009--DCLINIT
SIGN_CHAR IN PROCEDURE DEC_PT_FORM
     14750**DCL     14761<<ASSIGN  14763<<ASSIGN  14773>>CALLBLT
SIGN_CHAR IN PROCEDURE EXP_NOT_FORM
     14722**DCL     14726<<ASSIGN  14728<<ASSIGN  14732>>CALLBLT
SIGN_EXP IN PROCEDURE EXP_NOT_FORM
     14723**DCL     14731<<CALLBLT 14732>>CALLBLT
SIZE IN PROCEDURE CONVERT_TO_PACKED
     13754**DCL     13791<<ASSIGN  13792>>IF      13798>>CALLBLT
SPPRIV_ERR IN PROCEDURE INITIALIZE
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:292  
     14089**LABEL   14089--CALLALT
STRING$ IN PROCEDURE UPDATE_SCHED_TBL
     14945**DCL     14983<<ASSIGN  14985>>IF      14992>>ASSIGN  14992>>ASSIGN
TABLE_TYPE IN PROCEDURE LIST_ALL
     14174**DCL     14173--PROC    14180>>DOCASE  14212>>IF      14213>>IF      14216<>CALL    14219<>CALL
TABLE_TYPE IN PROCEDURE LIST_ONE
     14226**DCL     14225--PROC    14227>>DOCASE
TABLE_TYPE IN PROCEDURE OUT_HDR
     14243**DCL     14242--PROC    14253>>IF      14256>>IF      14256>>IF
TABLE_TYPE IN PROCEDURE UPDATE_TBL
     15007**DCL     15005--PROC    15016>>CALL    15020>>ASSIGN  15030>>DOCASE
TBL_PFX IN PROCEDURE LIST_ALL
     14176**DCL     14182<<ASSIGN  14184<<ASSIGN  14186<<ASSIGN  14188<<ASSIGN  14190<<ASSIGN  14192<<ASSIGN
     14194>>ASSIGN  14197>>ASSIGN  14208>>IF      14210>>IF
TBL_TYPE IN PROCEDURE ZERO_TBL
     15044**DCL     15043--PROC    15050>>DOCASE  15062>>IF
TEMP IN PROCEDURE LIST_FORM
     14267**DCL     14268<<ASSIGN  14269<>CALL    14270<<ASSIGN  14271<>CALL
TEMP_ERR IN PROCEDURE ERR_PROC
     13913**DCL     13918<<ASSIGN  13925<>CALL
TEMP_ERR.CODE IN PROCEDURE ERR_PROC
     13915**DCL     13922<<ASSIGN
TEMP_ERR.FCG_MID IN PROCEDURE ERR_PROC
     13914**DCL     13921<<ASSIGN
TEMP_ERR.SEV IN PROCEDURE ERR_PROC
     13916**DCL     13924<<ASSIGN
TEST_MODE
     13009**DCL     14081<<ASSIGN  14087<<ASSIGN  14102>>IF
TEST_PATTERN IN PROCEDURE INITIALIZE
     14035**DCL     14078>>IF
TEXT$C.LEN
     12982**DCL     12983--IMP-SIZ 13767>>IF      13776>>CALLBLT 13776>>CALLBLT 13782>>ASSIGN  13791>>ASSIGN
     13791>>ASSIGN  13798>>CALLBLT 13798>>CALLBLT 13802>>ASSIGN  13949>>IF      13960>>IF      13971>>IF
     13990>>ASSIGN  13999>>ASSIGN  14873>>IF      14873>>IF      14873>>IF      14883>>CALLBLT 14902>>IF
     14910>>ASSIGN  14957>>IF      14961>>ASSIGN  14967>>IF      14967>>IF      14967>>IF      14975>>CALLBLT
     14985>>IF      14992>>ASSIGN
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:293  
TEXT$C.STRING
     12983**DCL     13776>>CALLBLT 13798>>CALLBLT 13798>>CALLBLT 13999>>ASSIGN  14873>>IF      14873>>IF
     14883>>CALLBLT 14910>>ASSIGN  14961>>ASSIGN  14967>>IF      14967>>IF      14975>>CALLBLT 14992>>ASSIGN
TOP_CMD_ROOT
     13010**DCL     13389<>CALL
TRAILING_ZEROES IN PROCEDURE PACKED_TO_CHAR
     14652**DCL     14668<<ASSIGN  14677<<ASSIGN  14677>>ASSIGN  14685<<ASSIGN  14693>>ASSIGN  14700>>ASSIGN
     14703>>ASSIGN
TRAIL_0_LEN IN PROCEDURE DEC_PT_FORM
     14745**DCL     14765<<ASSIGN  14773>>CALLBLT
TYPE IN PROCEDURE UPDATE_RATE_TBL
     14839**DCL     14852<<ASSIGN  14853>>ASSIGN
T_NAME IN PROCEDURE PROCESS_JSUNIT
     14870**DCL     14910<<ASSIGN  14912<<ASSIGN  14913<<ASSIGN  14921>>IF      14922>>ASSIGN  14928>>IF
     14929>>ASSIGN
UPDATE_COMM_TBL
     14936**PROC    15038--CALL
UPDATE_FORM_TBL
     14811**PROC    15036--CALL
UPDATE_RATE_TBL
     14836**PROC    15034--CALL
UPDATE_SCHED_TBL
     14942**PROC    15032--CALL
UPDATE_TBL
     15005**PROC    13516--CALL    14615--CALL
VALUE$ IN PROCEDURE CONVERT_TO_PACKED
     13750**DCL     13748--PROC    13763>>ASSIGN  13766>>IF      13779>>IF      13789>>ASSIGN
VALUE$ IN PROCEDURE UPDATE_FORM_TBL
     14814**DCL     14818<<ASSIGN  14819<>CALL
VALUE$ IN PROCEDURE UPDATE_RATE_TBL
     14841**DCL     14850<<ASSIGN  14855<>CALL    14887<<ASSIGN  14889<>CALL
VALUE_BASE$ IN PROCEDURE UPDATE_RATE_TBL
     14842**DCL     14844<<ASSIGN  14858>>ASSIGN
VBND IN PROCEDURE UPDATE_TBL
     15011**DCL     15020>>ASSIGN
XTX$ADAPT
PL6.E3A0      #001=ARA$RATES File=ARA$RATES.:E05TSI                              TUE 07/29/97 08:28 Page:294  
     12334**DCL-ENT 12413--DCLINIT
XUR$ERRMSG
      8722**DCL-ENT 13925--CALL
XUR$GETCMD
      8714**DCL-ENT 13389--CALL    15016--CALL
XUR$INIT
      8719**DCL-ENT 14076--CALL
XUR_INIT
     12339**DCL     14076<>CALL
XUR_INIT.WORKR_
     12353**DCL     12354--REDEF
YES_NO IN PROCEDURE LIST_RATE
     14312**DCL     14532<<ASSIGN  14533<<ASSIGN  14540>>CALLBLT
ZERO_STRING
     12985**DCL     13776>>CALLBLT 13798>>CALLBLT 14665>>ASSIGN  14773>>CALLBLT 14773>>CALLBLT
ZERO_TBL
     15043**PROC    13459--CALL
