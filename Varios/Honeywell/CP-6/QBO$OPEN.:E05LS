VERSION E05

PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:1    
        1        1        /*M* QBO$OPEN:  Open DCBs for FORM and/or TRANSACTION files.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBO$OPEN
       10       10              PURPOSE:      Open DCBs for FORM and/or TRANSACTION files.
       11       11              DESCRIPTION:  Execute an OPEN op-code, whose argument
       12       12                            may be a file or a list of files (of any type),
       13       13                            and an indicator as to which I-O type to
       14       14                            open for.
       15       15        */
       16       16
       17       17        QBO$OPEN: PROC;
       18       18
       19       19        /*D*  NAME:         QBO$OPEN
       20       20              CALL:         CALL QBO$OPEN;
       21       21              PARAMETERS:   None.
       22       22              INTERFACE:    Called by QAT$TALLYHO when an OPEN op-code
       23       23                            is encountered.
       24       24                            Calls M$OPEN.
       25       25              ENVIRONMENT:  Nothing unusual.
       26       26              INPUT:        QI_1,
       27       27                            FPL rununit static data following the op-code.
       28       28              OUTPUT:       Sets all kinds of flags.
       29       29              SCRATCH:      Various otter data.
       30       30              DESCRIPTION:  The arguments may be files of either type FORM or
       31       31                            TRANSACTION, or a combination, but only one I-O type
       32       32                            is allowed per open.  Now, the compiler allows:
       33       33                            "OPEN INPUT ICK, OUTPUT ISH." but it gets tricky
       34       34                            and just generates two OPEN op-codes.  Yuk, yuk.
       35       35                            So just link the FD into the appropriate open chain
       36       36                            and call M$OPEN with the right stuff.
       37       37        */
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:2    
       38       38
       39       39          %INCLUDE B_ERRORS_C;
       40     1166          %INCLUDE LCP_6;
       41     1357          %FPT_OPEN ( FPTN = FPT@OPEN,
       42     1358                      STCLASS = AUTO );
       43     1386
       44     1387          %INCLUDE QG_MACRO_M;
       45     1524          %QGB_ENTRIES;
       46     1537          %INCLUDE QI_EQUATES_E;
       47     1896          %INCLUDE QI_PERR_C;
       48     2064          %INCLUDE QI_MACROS_M;
       49     7122          %QI$ALL;
       50    18235          %QI_FPTS;
       51    20280
       52    20281    1     DCL ERROR_STATUS$ PTR;
       53    20282    1     DCL FILE_COUNT UBIN;
       54    20283    1     DCL FILE_INDEX UBIN;
       55    20284    1     DCL FILE_LINK$ PTR;
       56    20285    1     DCL FILE_STATUS$ PTR;
       57    20286    1     DCL INSTR$ PTR;
       58    20287    1     DCL TYPE_INDEX UBIN;
       59    20288
       60    20289    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       61    20290    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
       62    20291    1     DCL QCU$USE_IO ENTRY (1);
       63    20292
       64    20293          %SET LISTMAC = '1'B;
       65    20294
       66    20295          %INCLUDE QCU_USE_M;
       67    20349          %QCU@USE;
             20350            %BEGIN_MACRO;
             20351            %SET LISTDIR = '0'B;
             20364    1     DCL 1 QCU@USE AUTO ALIGNED,
             20365    1           2 CURR_FRAME$ PTR,
             20366                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             20367    1           2 CURR_NODE$ PTR,
             20368                          /* Pointer to current node or ADDR (NIL).  */
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:3    
             20369    1           2 USE_DEFAULT_IO UBIN,
             20370                          /* For USE procedures which default applies
             20371                             (see corresponding EQUs).  */
             20372    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             20373                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             20374                             save the fields within the bounds of
             20375                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             20376                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             20377                             before calling the USE procedure.  */
             20378    1           2 FRAME_START_INDEX UBIN,
             20379                          /* Foist frame of the CURRENT.FORM$
             20380                             involved with the I-O error.  */
             20381    1           2 FRAME_STOP_INDEX UBIN,
             20382                          /* Larst frame of the CURRENT.FORM$
             20383                             involved with the I-O error.  */
             20384    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20385                          /* If IS_FIELD_INDEXES_VALID, use them;
             20386                             else use all the fields in the frame.  */
             20387    1           2 FIELD_START_INDEX UBIN,
             20388                          /* Starting index into QI$GZ_FIELD
             20389                             which may have values "pushed".  */
             20390    1           2 FIELD_STOP_INDEX UBIN,
             20391                          /* Stopping index into QI$GZ_FIELD
             20392                             which may have values "pushed".  */
             20393    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20394                          /* If IS_CURSOR_POSITION_VALID, use it;
             20395                             else allow cursor to default to upper-left-most field.  */
             20396    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20397                          /* POSition of the field on which to place the cursor.  */
             20398    1           2 STATUS UBIN;
             20399                          /* Returned action code; see corresponding EQUs.  */
             20406            %ENDIF;
       68    20409
       69    20410          %SET LISTMAC = '0'B;
       70    20411        %EJECT;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:4    
       71    20412    1       INSTR$ = QI_1.INSTR$;
       72    20413    1       FILE_COUNT = INSTR$ -> QI$OP_OPEN.FILE_COUNT;
       73    20414    1       QI_1.INSTR$ = PINCRW ( INSTR$, FILE_COUNT + 2 );
       74    20415
       75    20416    2       DO FILE_INDEX = 0 TO FILE_COUNT - 1;
       76    20417
       77    20418              %PROC_ADDRESS ( THING@P = "INSTR$ -> QI$OP_OPEN.FILE_A@P ( FILE_INDEX )",
       78    20419              CHECK_FOR_INDIRECTION = NO,
       79    20420              RESULT$ = "QI_1.CURRENT.FILE$" );
       80    20457
       81    20458              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.STATUS_AREA@D",
       82    20459              CHECK_FOR_INDIRECTION = NO,
       83    20460              RESULT$ = "QI_1.CURRENT.FILE_STATUS$" );
       84    20497
       85    20498    2   RETRY_STATUS_FLAGS:
       86    20499    2         IF QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT
       87    20500    2           OR QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.
             20500                    IS_OUTPUT
       88    20501    2         THEN
       89    20502    3           DO;
       90    20503    3             QI_1.ERROR_STATUS = %E$FILE_ALREADY_OPEN;
       91    20504    3             GOTO CHECK_FOR_USE_PROCEDURE;
       92    20505    3           END;
       93    20506
       94    20507        /*    IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE = %QI#TYPE_FORM
       95    20508                AND QI_1.OPENED_COUNT.FORM > 0
       96    20509              THEN
       97    20510                DO;
       98    20511                  QI_1.ERROR_STATUS = %E$MULTIPLE_OPEN;
       99    20512                  GOTO CHECK_FOR_USE_PROCEDURE;
      100    20513                END;                                                     */
      101    20514
      102    20515    2         FPT@OPEN = QI_FPT_OPEN;
      103    20516    2         VBASE ( FPT@OPEN.V_ ) = ADDR ( FPT@OPEN.V );
      104    20517    2         FPT@OPEN.V.DCB# = QI_1.CURRENT.FILE$ -> QI$FILE.DCB#;
      105    20518
      106    20519    3         DO CASE ( QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE );
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:5    
      107    20520
      108    20521    3           CASE ( %QI#TYPE_FORM );
      109    20522    3             FPT@OPEN.V.ORG = %G_ORG_FORM#;
      110    20523    3             FPT@OPEN.V.RES = 'UC02';
      111    20524    3             FPT@OPEN.V.KEYTYPE = %G_KEYTYPE_COORD#;
      112    20525
      113    20526    3           CASE ( %QI#TYPE_TRANSACTION );
      114    20527    3             FPT@OPEN.V.ORG = %G_ORG_CONSEC#;
      115    20528    3             FPT@OPEN.V.RES = 'HO';
      116    20529    3             FPT@OPEN.V.KEYTYPE = %G_KEYTYPE_MSGID#;
      117    20530
      118    20531    3           CASE ( ELSE );
      119    20532    3             CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      120    20533
      121    20534    3         END;
      122    20535
      123    20536    2         CALL QGB$OPEN ( FPT@OPEN, QGB_PARAM )
      124    20537    2         WHENALTRETURN
      125    20538    3           DO;
      126    20539    3             CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      127    20540    3           END;
      128    20541
      129    20542    2         TYPE_INDEX = QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE
      130    20543    2           - %QI#TYPE_FORM;
      131    20544
      132    20545    2         IF QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = ADDR(NIL)
      133    20546    2         THEN
      134    20547    2           QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = QI_1.CURRENT.FILE$;
      135    20548    2         ELSE
      136    20549    3           DO;
      137    20550
      138    20551    3             FILE_LINK$ = QI_1.FILE_HEAD_A$ ( TYPE_INDEX );
      139    20552
      140    20553    3   FIND_LAST_LINK:
      141    20554    4             DO WHILE ( FILE_LINK$ ~= ADDR(NIL) );
      142    20555
      143    20556                    %DATA_ADDRESS ( THING@D = "FILE_LINK$ -> QI$FILE.STATUS_AREA@D",
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:6    
      144    20557                    CHECK_FOR_INDIRECTION = NO,
      145    20558                    RESULT$ = FILE_STATUS$ );
      146    20595    4               FILE_LINK$ = FILE_STATUS$ -> QI$FILE_STATUS.FLINK$;
      147    20596
      148    20597    4             END FIND_LAST_LINK;
      149    20598
      150    20599    3             FILE_STATUS$ -> QI$FILE_STATUS.FLINK$ = QI_1.CURRENT.FILE$;
      151    20600
      152    20601    3           END;
      153    20602
      154    20603    2         QI_1.OPENED_COUNT_A ( TYPE_INDEX ) =
      155    20604    2           QI_1.OPENED_COUNT_A ( TYPE_INDEX ) + 1;
      156    20605
      157    20606    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.FLINK$ = ADDR(NIL);
      158    20607    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.BACK_LINK@P =
      159    20608    2           POFFW ( QI_1.CURRENT.FILE$, QI_1.BASE.PROC$ );
      160    20609    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.CURRENT.USAGE.OPENED = %YES;
      161    20610    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_VALUE =
      162    20611    2           INSTR$ -> QI$OP_OPEN.IO_VALUE;
      163    20612
      164    20613              /*  Stuff for QI$FORM_FILEs only.  */
      165    20614    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE = %QI#TYPE_FORM
      166    20615    2         THEN
      167    20616    2   SPECIAL_FORM_FILE_PROCESSING:
      168    20617    3           DO;
      169    20618                  /*  Ho-kay:
      170    20619                      if the MESSAGE LINE IS... clause of the whatever
      171    20620                      declaration is ever honored, I guess here's where
      172    20621                      to open a separate DCB for that MESSAGE LINE (the
      173    20622                      compiler should gen the DCB).  If no MESSAGE LINE
      174    20623                      clause, or if the clause points to the default
      175    20624                      MESSAGE LINE (@ the bottom of the screen), then
      176    20625                      just hook up this screen FD to the default one.  */
      177    20626    3             IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_MESSAGE_LINE_VALID
      178    20627    3               AND QI_1.CURRENT.FORM$ -> QI$FORM_FILE.MESSAGE_LINE ~=
      179    20628    3               QI_1.MESSAGE_LINE_GZ.START$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.LINE
      180    20629    3             THEN
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:7    
      181    20630    4               DO;
      182    20631    4               END;
      183    20632
      184    20633    3             QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID = 0;
      185    20634    3           END SPECIAL_FORM_FILE_PROCESSING;
      186    20635
      187    20636    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      188    20637    2         THEN
      189    20638    3           DO;
      190    20639                  %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.ERROR_STATUS@D",
      191    20640                  CHECK_FOR_INDIRECTION = NO,
      192    20641                  RESULT$ = ERROR_STATUS$ );
      193    20678    3             ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_OPEN_TEXT;
      194    20679    3           END;
      195    20680
      196    20681    2   NEXT_FILE_PLEASE:
      197    20682
      198    20683    2       END;
      199    20684
      200    20685    1       RETURN;
      201    20686
      202    20687        %EJECT;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:8    
      203    20688    1   CHECK_FOR_USE_PROCEDURE:
      204    20689    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;
      205    20690    1       QCU@USE.CURR_FRAME$ = ADDR (NIL);
      206    20691    1       QCU@USE.CURR_NODE$ = ADDR (NIL);
      207    20692    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;
      208    20693
      209    20694    1       CALL QCU$USE_IO ( QCU@USE );
      210    20695
      211    20696    1   INUSE_RETURN:
      212    20697    2       DO CASE ( QCU@USE.STATUS );
      213    20698
      214    20699    2         CASE ( %QI#USE_INVALID_RETURN );
      215    20700    2           RETURN;
      216    20701
      217    20702    2         CASE ( %QI#USE_INVALID_RETRY );
      218    20703    2           GOTO RETRY_STATUS_FLAGS;
      219    20704
      220    20705    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );
      221    20706    2           GOTO NEXT_FILE_PLEASE;
      222    20707
      223    20708    2         CASE ( ELSE );
      224    20709    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      225    20710
      226    20711    2       END;
      227    20712
      228    20713    1   END QBO$OPEN;

PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:9    
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBO$OPEN.

   Procedure QBO$OPEN requires 400 words for executable code.
   Procedure QBO$OPEN requires 80 words of local(AUTO) storage.

    No errors detected in file QBO$OPEN.:E05TSI    .

PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:10   

 Object Unit name= QBO$OPEN                                   File name= QBO$OPEN.:E05TOU
 UTS= JUL 30 '97 04:52:43.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS      4      4  QBO$OPEN
    1   Proc  even  none   400    190  QBO$OPEN
    2  RoData even  none     9      9  QBO$OPEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  QBO$OPEN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 QCE$ERROR_INTERNAL
 yes     yes           Std       2 QGB$OPEN
         yes           Std       4 QCE$ERROR_M$INTERNAL
         yes           Std       1 QCU$USE_IO
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QI_1                                  QGB_PARAM                             QI_4_CHAR_ALPHANUMERIC
     QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY                      QI_32_BIT_BINARY
     QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING                     QI_FPT_OPEN
r    G$ROS$
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:12   


        1        1        /*M* QBO$OPEN:  Open DCBs for FORM and/or TRANSACTION files.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBO$OPEN
       10       10              PURPOSE:      Open DCBs for FORM and/or TRANSACTION files.
       11       11              DESCRIPTION:  Execute an OPEN op-code, whose argument
       12       12                            may be a file or a list of files (of any type),
       13       13                            and an indicator as to which I-O type to
       14       14                            open for.
       15       15        */
       16       16
       17       17        QBO$OPEN: PROC;

     17   1 000000  D380 0000 0000  xent QBO$OPEN        LNJ,B5   X6A_AUTO_0
          1 000003       0050 0000                       DC       80,0

       18       18
       19       19        /*D*  NAME:         QBO$OPEN
       20       20              CALL:         CALL QBO$OPEN;
       21       21              PARAMETERS:   None.
       22       22              INTERFACE:    Called by QAT$TALLYHO when an OPEN op-code
       23       23                            is encountered.
       24       24                            Calls M$OPEN.
       25       25              ENVIRONMENT:  Nothing unusual.
       26       26              INPUT:        QI_1,
       27       27                            FPL rununit static data following the op-code.
       28       28              OUTPUT:       Sets all kinds of flags.
       29       29              SCRATCH:      Various otter data.
       30       30              DESCRIPTION:  The arguments may be files of either type FORM or
       31       31                            TRANSACTION, or a combination, but only one I-O type
       32       32                            is allowed per open.  Now, the compiler allows:
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:13   
       33       33                            "OPEN INPUT ICK, OUTPUT ISH." but it gets tricky
       34       34                            and just generates two OPEN op-codes.  Yuk, yuk.
       35       35                            So just link the FD into the appropriate open chain
       36       36                            and call M$OPEN with the right stuff.
       37       37        */
       38       38
       39       39          %INCLUDE B_ERRORS_C;
       40     1166          %INCLUDE LCP_6;
       41     1357          %FPT_OPEN ( FPTN = FPT@OPEN,
       42     1358                      STCLASS = AUTO );
       43     1386
       44     1387          %INCLUDE QG_MACRO_M;
       45     1524          %QGB_ENTRIES;
       46     1537          %INCLUDE QI_EQUATES_E;
       47     1896          %INCLUDE QI_PERR_C;
       48     2064          %INCLUDE QI_MACROS_M;
       49     7122          %QI$ALL;
       50    18235          %QI_FPTS;
       51    20280
       52    20281    1     DCL ERROR_STATUS$ PTR;
       53    20282    1     DCL FILE_COUNT UBIN;
       54    20283    1     DCL FILE_INDEX UBIN;
       55    20284    1     DCL FILE_LINK$ PTR;
       56    20285    1     DCL FILE_STATUS$ PTR;
       57    20286    1     DCL INSTR$ PTR;
       58    20287    1     DCL TYPE_INDEX UBIN;
       59    20288
       60    20289    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       61    20290    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
       62    20291    1     DCL QCU$USE_IO ENTRY (1);
       63    20292
       64    20293          %SET LISTMAC = '1'B;
       65    20294
       66    20295          %INCLUDE QCU_USE_M;
       67    20349          %QCU@USE;
             20350            %BEGIN_MACRO;
             20351            %SET LISTDIR = '0'B;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:14   
             20364    1     DCL 1 QCU@USE AUTO ALIGNED,
             20365    1           2 CURR_FRAME$ PTR,
             20366                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             20367    1           2 CURR_NODE$ PTR,
             20368                          /* Pointer to current node or ADDR (NIL).  */
             20369    1           2 USE_DEFAULT_IO UBIN,
             20370                          /* For USE procedures which default applies
             20371                             (see corresponding EQUs).  */
             20372    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             20373                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             20374                             save the fields within the bounds of
             20375                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             20376                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             20377                             before calling the USE procedure.  */
             20378    1           2 FRAME_START_INDEX UBIN,
             20379                          /* Foist frame of the CURRENT.FORM$
             20380                             involved with the I-O error.  */
             20381    1           2 FRAME_STOP_INDEX UBIN,
             20382                          /* Larst frame of the CURRENT.FORM$
             20383                             involved with the I-O error.  */
             20384    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             20385                          /* If IS_FIELD_INDEXES_VALID, use them;
             20386                             else use all the fields in the frame.  */
             20387    1           2 FIELD_START_INDEX UBIN,
             20388                          /* Starting index into QI$GZ_FIELD
             20389                             which may have values "pushed".  */
             20390    1           2 FIELD_STOP_INDEX UBIN,
             20391                          /* Stopping index into QI$GZ_FIELD
             20392                             which may have values "pushed".  */
             20393    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             20394                          /* If IS_CURSOR_POSITION_VALID, use it;
             20395                             else allow cursor to default to upper-left-most field.  */
             20396    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             20397                          /* POSition of the field on which to place the cursor.  */
             20398    1           2 STATUS UBIN;
             20399                          /* Returned action code; see corresponding EQUs.  */
             20406            %ENDIF;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:15   
       68    20409
       69    20410          %SET LISTMAC = '0'B;
       70    20411        %EJECT;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:16   
       71    20412    1       INSTR$ = QI_1.INSTR$;

  20412   1 000005  EC80 0000 0006  xsym                 LDB,B6   QI_1+6
          1 000008  EFC7 003B                            STB,B6   INSTR$,AUTO

       72    20413    1       FILE_COUNT = INSTR$ -> QI$OP_OPEN.FILE_COUNT;

  20413   1 00000A  E846 0001                            LDR,R6   1,B6
          1 00000C  E570 1FFF                            AND,R6   8191,IMO
          1 00000E  EF47 0035                            STR,R6   FILE_COUNT,AUTO

       73    20414    1       QI_1.INSTR$ = PINCRW ( INSTR$, FILE_COUNT + 2 );

  20414   1 000010  F856                                 LDR,R7   R6
          1 000011  6C00                                 LDV,R6   0
          1 000012  8447 003B                            AID      INSTR$,AUTO
          1 000014  8470 0000 0002                       AID      2,IMO
          1 000017  8D00 0000 0006  xsym                 SDI      QI_1+6

       74    20415
       75    20416    2       DO FILE_INDEX = 0 TO FILE_COUNT - 1;

  20416   1 00001A  8747 0036                            CL       FILE_INDEX,AUTO
          1 00001C  0F81 0130                            B        s:20679+3,PREL

       76    20417
       77    20418              %PROC_ADDRESS ( THING@P = "INSTR$ -> QI$OP_OPEN.FILE_A@P ( FILE_INDEX )",
       78    20419              CHECK_FOR_INDIRECTION = NO,
       79    20420              RESULT$ = "QI_1.CURRENT.FILE$" );

  20438   1 00001E  ECC7 003B                            LDB,B6   INSTR$,AUTO
          1 000020  B847 0036                            LDR,R3   FILE_INDEX,AUTO
          1 000022  3E02                                 ADV,R3   2
          1 000023  A836                                 LDR,R2   ,B6,R3
          1 000024  F852                                 LDR,R7   R2
          1 000025  6C00                                 LDV,R6   0
          1 000026  8400 0000 0002  xsym                 AID      QI_1+2
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:17   
          1 000029  8D00 0000 0076  xsym                 SDI      QI_1+118

       80    20457
       81    20458              %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.STATUS_AREA@D",
       82    20459              CHECK_FOR_INDIRECTION = NO,
       83    20460              RESULT$ = "QI_1.CURRENT.FILE_STATUS$" );

  20478   1 00002C  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 00002F  9845 0006                            LDR,R1   6,B5
          1 000031  F851                                 LDR,R7   R1
          1 000032  6C00                                 LDV,R6   0
          1 000033  8400 0000 0000  xsym                 AID      QI_1
          1 000036  8D00 0000 0078  xsym                 SDI      QI_1+120

       84    20497
       85    20498    2   RETRY_STATUS_FLAGS:
       86    20499    2         IF QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT

  20499   1 000039  EC80 0000 0078  xsym RETRY_STATUS_FL*LDB,B6   QI_1+120
          1 00003C  82C6 0008                            LB,'0200'X        8,B6
          1 00003E       0200
          1 00003F  0501 0006                            BBT      s:20503,PREL
          1 000041  82C6 0008                            LB,'0400'X        8,B6
          1 000043       0400
          1 000044  0581 0007                            BBF      s:20515,PREL

       87    20500    2           OR QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.
             20500                    IS_OUTPUT
       88    20501    2         THEN
       89    20502    3           DO;

       90    20503    3             QI_1.ERROR_STATUS = %E$FILE_ALREADY_OPEN;

  20503   1 000046  6C02                                 LDV,R6   2
          1 000047  EF00 0000 008C  xsym                 STR,R6   QI_1+140

       91    20504    3             GOTO CHECK_FOR_USE_PROCEDURE;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:18   

  20504   1 00004A  0F81 010B                            B        s:20689,PREL

       92    20505    3           END;
       93    20506
       94    20507        /*    IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE = %QI#TYPE_FORM
       95    20508                AND QI_1.OPENED_COUNT.FORM > 0
       96    20509              THEN
       97    20510                DO;
       98    20511                  QI_1.ERROR_STATUS = %E$MULTIPLE_OPEN;
       99    20512                  GOTO CHECK_FOR_USE_PROCEDURE;
      100    20513                END;                                                     */
      101    20514
      102    20515    2         FPT@OPEN = QI_FPT_OPEN;

  20515   1 00004C  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_OPEN
          1 00004F  2C00                                 LDV,R2   0
          1 000050  6C5E                                 LDV,R6   94
          1 000051  BB87                                 LAB,B3   ,AUTO
          1 000052  3C08                                 LDV,R3   8
          1 000053  0008                                 MMM

      103    20516    2         VBASE ( FPT@OPEN.V_ ) = ADDR ( FPT@OPEN.V );

  20516   1 000054  EBC7 002B                            LAB,B6   FPT@OPEN+39,AUTO
          1 000056  EFC7 0005                            STB,B6   FPT@OPEN+1,AUTO

      104    20517    2         FPT@OPEN.V.DCB# = QI_1.CURRENT.FILE$ -> QI$FILE.DCB#;

  20517   1 000058  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 00005B  E845 0008                            LDR,R6   8,B5
          1 00005D  E7C7 002B                            STH,R6   FPT@OPEN+39,AUTO

      105    20518
      106    20519    3         DO CASE ( QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE );

  20519   1 00005F  B805                                 LDR,R3   ,B5
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:19   
          1 000060  B570 000F                            AND,R3   15,IMO
          1 000062  3EF5                                 ADV,R3   -11
          1 000063  3D02                                 CMV,R3   2
          1 000064  0281 002C                            BGE      s:20532,PREL
          1 000066  A830 0000 006C  01                   LDR,R2   s:20519+13,R3
          1 000069  83A0 0000 006E  01                   JMP      s:20522,R2
          1 00006C       0000                            DC       s:20522,PREL
          1 00006D       0011                            DC       s:20527,PREL

      107    20520
      108    20521    3           CASE ( %QI#TYPE_FORM );

      109    20522    3             FPT@OPEN.V.ORG = %G_ORG_FORM#;

  20522   1 00006E  6C02                                 LDV,R6   2
          1 00006F  E7C7 002D                            STH,R6   FPT@OPEN+41,AUTO

      110    20523    3             FPT@OPEN.V.RES = 'UC02';

  20523   1 000071  AB80 0000 0000  00                   LAB,B2   0
          1 000074  2C00                                 LDV,R2   0
          1 000075  6C04                                 LDV,R6   4
          1 000076  BB87                                 LAB,B3   ,AUTO
          1 000077  3C5C                                 LDV,R3   92
          1 000078  0008                                 MMM

      111    20524    3             FPT@OPEN.V.KEYTYPE = %G_KEYTYPE_COORD#;

  20524   1 000079  6C02                                 LDV,R6   2
          1 00007A  EAC7 002C                            SRM,R6,'00FF'X    FPT@OPEN+40,AUTO
          1 00007C       00FF
          1 00007D  0F81 001C                            B        s:20536,PREL

      112    20525
      113    20526    3           CASE ( %QI#TYPE_TRANSACTION );

      114    20527    3             FPT@OPEN.V.ORG = %G_ORG_CONSEC#;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:20   

  20527   1 00007F  6C01                                 LDV,R6   1
          1 000080  E7C7 002D                            STH,R6   FPT@OPEN+41,AUTO

      115    20528    3             FPT@OPEN.V.RES = 'HO';

  20528   1 000082  CB80 0000 0000  00                   LAB,B4   0
          1 000085  0021                                 ALR      ;
          1 000086       4204 0002                                ALPHANUM(2,B4,,2),;
          1 000088       4407 002E                                ALPHANUM(FPT@OPEN+42,AUTO,,4,FILL)

      116    20529    3             FPT@OPEN.V.KEYTYPE = %G_KEYTYPE_MSGID#;

  20529   1 00008A  5C03                                 LDV,R5   3
          1 00008B  437F                                 CSYNC    s:20529,SPREL
          1 00008C  DAC7 002C                            SRM,R5,'00FF'X    FPT@OPEN+40,AUTO
          1 00008E       00FF
          1 00008F  0F81 000A                            B        s:20536,PREL

      117    20530
      118    20531    3           CASE ( ELSE );

      119    20532    3             CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  20532   1 000091  BB80 0000 0001  02                   LAB,B3   +1
          1 000094  CBF0 0100                            LAB,B4   256,IMO
          1 000096  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 000099       0001                            DC       s:20536,PREL

      120    20533
      121    20534    3         END;

      122    20535
      123    20536    2         CALL QGB$OPEN ( FPT@OPEN, QGB_PARAM )

  20536   1 00009A  EB80 0000 0000  xsym                 LAB,B6   QGB_PARAM
          1 00009D  EFC7 004E                            STB,B6   QCU@USE+16,AUTO
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:21   
          1 00009F  DBC7 0004                            LAB,B5   FPT@OPEN,AUTO
          1 0000A1  DFC7 004C                            STB,B5   QCU@USE+14,AUTO
          1 0000A3  BBC7 004C                            LAB,B3   QCU@USE+14,AUTO
          1 0000A5  CBF0 0200                            LAB,B4   512,IMO
          1 0000A7  E380 0000 0000  xent                 LNJ,B6   QGB$OPEN
          1 0000AA       0003                            DC       s:20539,PREL
          1 0000AB  0F81 000A                            B        s:20542,PREL

      124    20537    2         WHENALTRETURN
      125    20538    3           DO;

      126    20539    3             CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  20539   1 0000AD  BB80 0000 0004  02                   LAB,B3   +4
          1 0000B0  CBF0 0100                            LAB,B4   256,IMO
          1 0000B2  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          1 0000B5       0001                            DC       s:20542,PREL

      127    20540    3           END;

      128    20541
      129    20542    2         TYPE_INDEX = QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE

  20542   1 0000B6  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 0000B9  E806                                 LDR,R6   ,B6
          1 0000BA  E570 000F                            AND,R6   15,IMO
          1 0000BC  6EF5                                 ADV,R6   -11
          1 0000BD  EF47 003D                            STR,R6   TYPE_INDEX,AUTO

      130    20543    2           - %QI#TYPE_FORM;
      131    20544
      132    20545    2         IF QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = ADDR(NIL)

  20545   1 0000BF  B856                                 LDR,R3   R6
          1 0000C0  8DB0 0000 0070  xsym                 CMN      QI_1+112,R3
          1 0000C3  0981 0006                            BNE      s:20551,PREL

PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:22   
      133    20546    2         THEN
      134    20547    2           QI_1.FILE_HEAD_A$ ( TYPE_INDEX ) = QI_1.CURRENT.FILE$;

  20547   1 0000C5  EFB0 0000 0070  xsym                 STB,B6   QI_1+112,R3
          1 0000C8  0F81 0023                            B        s:20603,PREL

      135    20548    2         ELSE
      136    20549    3           DO;

      137    20550
      138    20551    3             FILE_LINK$ = QI_1.FILE_HEAD_A$ ( TYPE_INDEX );

  20551   1 0000CA  DCB0 0000 0070  xsym                 LDB,B5   QI_1+112,R3
          1 0000CD  DFC7 0037                            STB,B5   FILE_LINK$,AUTO

      139    20552
      140    20553    3   FIND_LAST_LINK:
      141    20554    4             DO WHILE ( FILE_LINK$ ~= ADDR(NIL) );

  20554   1 0000CF  0F81 0012            FIND_LAST_LINK  B        s:20597,PREL

      142    20555
      143    20556                    %DATA_ADDRESS ( THING@D = "FILE_LINK$ -> QI$FILE.STATUS_AREA@D",
      144    20557                    CHECK_FOR_INDIRECTION = NO,
      145    20558                    RESULT$ = FILE_STATUS$ );

  20576   1 0000D1  ECC7 0037                            LDB,B6   FILE_LINK$,AUTO
          1 0000D3  B846 0006                            LDR,R3   6,B6
          1 0000D5  F853                                 LDR,R7   R3
          1 0000D6  6C00                                 LDV,R6   0
          1 0000D7  8400 0000 0000  xsym                 AID      QI_1
          1 0000DA  8D47 0039                            SDI      FILE_STATUS$,AUTO

      146    20595    4               FILE_LINK$ = FILE_STATUS$ -> QI$FILE_STATUS.FLINK$;

  20595   1 0000DC  DCC7 0039                            LDB,B5   FILE_STATUS$,AUTO
          1 0000DE  CCC5 0002                            LDB,B4   2,B5
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:23   
          1 0000E0  CFC7 0037                            STB,B4   FILE_LINK$,AUTO

      147    20596
      148    20597    4             END FIND_LAST_LINK;

  20597   1 0000E2  8DC7 0037                            CMN      FILE_LINK$,AUTO
          1 0000E4  09ED                                 BNE      s:20576,SPREL

      149    20598
      150    20599    3             FILE_STATUS$ -> QI$FILE_STATUS.FLINK$ = QI_1.CURRENT.FILE$;

  20599   1 0000E5  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 0000E8  DCC7 0039                            LDB,B5   FILE_STATUS$,AUTO
          1 0000EA  EFC5 0002                            STB,B6   2,B5

      151    20600
      152    20601    3           END;

      153    20602
      154    20603    2         QI_1.OPENED_COUNT_A ( TYPE_INDEX ) =

  20603   1 0000EC  B847 003D                            LDR,R3   TYPE_INDEX,AUTO
          1 0000EE  8AB0 0000 0074  xsym                 INC      QI_1+116,R3

      155    20604    2           QI_1.OPENED_COUNT_A ( TYPE_INDEX ) + 1;
      156    20605
      157    20606    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.FLINK$ = ADDR(NIL);

  20606   1 0000F1  EB80 0000 0000                       LAB,B6   0
          1 0000F4  DC80 0000 0078  xsym                 LDB,B5   QI_1+120
          1 0000F7  EFC5 0002                            STB,B6   2,B5

      158    20607    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.BACK_LINK@P =

  20607   1 0000F9  8C80 0000 0076  xsym                 LDI      QI_1+118
          1 0000FC  8480 0000 0002  xsym                 SID      QI_1+2
          1 0000FF  EC80 0000 0078  xsym                 LDB,B6   QI_1+120
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:24   
          1 000102  E857                                 LDR,R6   R7
          1 000103  EF46 0001                            STR,R6   1,B6

      159    20608    2           POFFW ( QI_1.CURRENT.FILE$, QI_1.BASE.PROC$ );
      160    20609    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.CURRENT.USAGE.OPENED = %YES;

  20609   1 000105  EC80 0000 0078  xsym                 LDB,B6   QI_1+120
          1 000108  8906                                 LBT,'0400'X       ,B6
          1 000109       0400

      161    20610    2         QI_1.CURRENT.FILE_STATUS$ -> QI$FILE_STATUS.INDICATORS.OPEN_VALUE =

  20610   1 00010A  ECC7 003B                            LDB,B6   INSTR$,AUTO
          1 00010C  DC80 0000 0078  xsym                 LDB,B5   QI_1+120
          1 00010F  E846 0001                            LDR,R6   1,B6
          1 000111  6044                                 SOR,R6   4
          1 000112  EAC5 0008                            SRM,R6,'0600'X    8,B5
          1 000114       0600

      162    20611    2           INSTR$ -> QI$OP_OPEN.IO_VALUE;
      163    20612
      164    20613              /*  Stuff for QI$FORM_FILEs only.  */
      165    20614    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.TYPE = %QI#TYPE_FORM

  20614   1 000115  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 000118  E805                                 LDR,R6   ,B5
          1 000119  E570 000F                            AND,R6   15,IMO
          1 00011B  6D0B                                 CMV,R6   11
          1 00011C  0981 0013                            BNE      s:20636,PREL

      166    20615    2         THEN
      167    20616    2   SPECIAL_FORM_FILE_PROCESSING:
      168    20617    3           DO;

  20617   1                              SPECIAL_FORM_FI*null
      169    20618                  /*  Ho-kay:
      170    20619                      if the MESSAGE LINE IS... clause of the whatever
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:25   
      171    20620                      declaration is ever honored, I guess here's where
      172    20621                      to open a separate DCB for that MESSAGE LINE (the
      173    20622                      compiler should gen the DCB).  If no MESSAGE LINE
      174    20623                      clause, or if the clause points to the default
      175    20624                      MESSAGE LINE (@ the bottom of the screen), then
      176    20625                      just hook up this screen FD to the default one.  */
      177    20626    3             IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_MESSAGE_LINE_VALID

  20626   1 00011E  8285                 SPECIAL_FORM_FI*LB,'2000'X        ,B5
  20626   1 00011F       2000
          1 000120  0581 000A                            BBF      s:20633,PREL
          1 000122  CC80 0000 0066  xsym                 LDB,B4   QI_1+102
          1 000125  D2C4 0003                            LLH,R5   3,B4
          1 000127  D945 0004                            CMR,R5   4,B5
          1 000129  0901 0001                            BE       s:20633,PREL

      178    20627    3               AND QI_1.CURRENT.FORM$ -> QI$FORM_FILE.MESSAGE_LINE ~=
      179    20628    3               QI_1.MESSAGE_LINE_GZ.START$ -> QI$GZ_FIELD.DESCRIPTION.POSITION.LINE
      180    20629    3             THEN
      181    20630    4               DO;

      182    20631    4               END;

      183    20632
      184    20633    3             QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID = 0;

  20633   1 00012B  CC80 0000 0078  xsym                 LDB,B4   QI_1+120
          1 00012E  8744 0004                            CL       4,B4

      185    20634    3           END SPECIAL_FORM_FILE_PROCESSING;

      186    20635
      187    20636    2         IF QI_1.CURRENT.FILE$ -> QI$FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID

  20636   1 000130  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 000133  8285                                 LB,'4000'X        ,B5
          1 000134       4000
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:26   
          1 000135  0581 0014                            BBF      s:20679,PREL

      188    20637    2         THEN
      189    20638    3           DO;

      190    20639                  %DATA_ADDRESS ( THING@D = "QI_1.CURRENT.FILE$ -> QI$FILE.ERROR_STATUS@D",
      191    20640                  CHECK_FOR_INDIRECTION = NO,
      192    20641                  RESULT$ = ERROR_STATUS$ );

  20659   1 000137  A845 0003                            LDR,R2   3,B5
          1 000139  F852                                 LDR,R7   R2
          1 00013A  6C00                                 LDV,R6   0
          1 00013B  8400 0000 0000  xsym                 AID      QI_1
          1 00013E  8D47 0033                            SDI      ERROR_STATUS$,AUTO

      193    20678    3             ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_OPEN_TEXT;

  20678   1 000140  CB80 0000 0000  00                   LAB,B4   0
          1 000143  BCC7 0033                            LDB,B3   ERROR_STATUS$,AUTO
          1 000145  0021                                 ALR      ;
          1 000146       4204 0003                                ALPHANUM(3,B4,,2),;
          1 000148       4803 0000                                ALPHANUM(0,B3,,8,FILL)

      194    20679    3           END;

      195    20680
      196    20681    2   NEXT_FILE_PLEASE:
      197    20682
      198    20683    2       END;

  20683   1 00014A  437F                 NEXT_FILE_PLEASECSYNC    s:20678+9,SPREL
          1 00014B  8AC7 0036                            INC      FILE_INDEX,AUTO
          1 00014D  E847 0036                            LDR,R6   FILE_INDEX,AUTO
          1 00014F  E947 0035                            CMR,R6   FILE_COUNT,AUTO
          1 000151  0201 FECC                            BL       s:20438,PREL

      199    20684
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:27   
      200    20685    1       RETURN;

  20685   1 000153  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      201    20686
      202    20687        %EJECT;
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:28   
      203    20688    1   CHECK_FOR_USE_PROCEDURE:
      204    20689    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;

  20689   1 000156  8747 0043            CHECK_FOR_USE_P*CL       QCU@USE+5,AUTO

      205    20690    1       QCU@USE.CURR_FRAME$ = ADDR (NIL);

  20690   1 000158  DB80 0000 0000                       LAB,B5   0
          1 00015B  DFC7 003E                            STB,B5   QCU@USE,AUTO

      206    20691    1       QCU@USE.CURR_NODE$ = ADDR (NIL);

  20691   1 00015D  CB80 0000 0000                       LAB,B4   0
          1 000160  CFC7 0040                            STB,B4   QCU@USE+2,AUTO

      207    20692    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;

  20692   1 000162  8747 0042                            CL       QCU@USE+4,AUTO

      208    20693
      209    20694    1       CALL QCU$USE_IO ( QCU@USE );

  20694   1 000164  BBC7 003E                            LAB,B3   QCU@USE,AUTO
          1 000166  BFC7 004C                            STB,B3   QCU@USE+14,AUTO
          1 000168  BBC7 004C                            LAB,B3   QCU@USE+14,AUTO
          1 00016A  CBF0 0100                            LAB,B4   256,IMO
          1 00016C  E380 0000 0000  xent                 LNJ,B6   QCU$USE_IO
          1 00016F       0001                            DC       s:20697,PREL

      210    20695
      211    20696    1   INUSE_RETURN:
      212    20697    2       DO CASE ( QCU@USE.STATUS );

  20697   1 000170  B847 004B            INUSE_RETURN    LDR,R3   QCU@USE+13,AUTO
          1 000172  3D03                                 CMV,R3   3
          1 000173  0281 0010                            BGE      s:20709,PREL
          1 000175  A830 0000 017B  01                   LDR,R2   INUSE_RETURN+11,R3
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:29   
          1 000178  83A0 0000 017E  01                   JMP      s:20700,R2
          1 00017B       0000                            DC       s:20700,PREL
          1 00017C       0003                            DC       s:20703,PREL
          1 00017D       0005                            DC       s:20706,PREL

      213    20698
      214    20699    2         CASE ( %QI#USE_INVALID_RETURN );

      215    20700    2           RETURN;

  20700   1 00017E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      216    20701
      217    20702    2         CASE ( %QI#USE_INVALID_RETRY );

      218    20703    2           GOTO RETRY_STATUS_FLAGS;

  20703   1 000181  0F81 FEB7                            B        s:20487,PREL

      219    20704
      220    20705    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );

      221    20706    2           GOTO NEXT_FILE_PLEASE;

  20706   1 000183  0FC7                                 B        s:20679,SPREL

      222    20707
      223    20708    2         CASE ( ELSE );

      224    20709    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  20709   1 000184  BB80 0000 0007  02                   LAB,B3   +7
          1 000187  CBF0 0100                            LAB,B4   256,IMO
          1 000189  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 00018C       0001                            DC       s:20713,PREL

      225    20710
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:30   
      226    20711    2       END;

      227    20712
      228    20713    1   END QBO$OPEN;

  20713   1 00018D  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:31   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBO$OPEN.
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:32   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    33-0-0/w PTR         r     1 ERROR_STATUS$             35-0-0/w UBIN(16)    r     1 FILE_COUNT
    36-0-0/w UBIN(16)    r     1 FILE_INDEX                37-0-0/w PTR         r     1 FILE_LINK$
    39-0-0/w PTR         r     1 FILE_STATUS$               4-0-0/w STRC(752)   r     1 FPT@OPEN
    3B-0-0/w PTR         r     1 INSTR$                    3E-0-0/w STRC(224)   r     1 QCU@USE
    3D-0-0/w UBIN(16)    r     1 TYPE_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 QGB_PARAM                  0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w STRC(752)   r     1 QI_FPT_OPEN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(64)    r     1 QI$ERROR_STATUS            0-0-0/w STRC(176)   r     1 QI$FILE
     0-0-0/w STRC(144)   r     1 QI$FILE_STATUS             0-0-0/w STRC(192)   r     1 QI$FORM_FILE
     0-0-0/w STRC(144)   r     1 QI$FORM_STATUS             0-0-0/w STRC(184)   r     1 QI$GZ_FIELD
     0-0-0/w STRC(48)    r     1 QI$OP_OPEN
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER


   Procedure QBO$OPEN requires 400 words for executable code.
   Procedure QBO$OPEN requires 80 words of local(AUTO) storage.
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:33   

    No errors detected in file QBO$OPEN.:E05TSI    .
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:34   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:35   
          MINI XREF LISTING

CHECK_FOR_USE_PROCEDURE
     20689**LABEL   20504--GOTO
ERROR_STATUS$
     20281**DCL     20659<<ASSIGN  20678>>ASSIGN
FILE_COUNT
     20282**DCL     20413<<ASSIGN  20414>>ASSIGN  20416>>DOINDEX
FILE_INDEX
     20283**DCL     20416<<DOINDEX 20438>>ASSIGN
FILE_LINK$
     20284**DCL     20551<<ASSIGN  20554>>DOWHILE 20576>>ASSIGN  20595<<ASSIGN
FILE_STATUS$
     20285**DCL     20576<<ASSIGN  20595>>ASSIGN  20599>>ASSIGN
FPT@OPEN
      1371**DCL     20515<<ASSIGN  20536<>CALL
FPT@OPEN.V
      1379**DCL     20516--ASSIGN
FPT@OPEN.V.DCB#
      1379**DCL     20517<<ASSIGN
FPT@OPEN.V.KEYTYPE
      1381**DCL     20524<<ASSIGN  20529<<ASSIGN
FPT@OPEN.V.ORG
      1381**DCL     20522<<ASSIGN  20527<<ASSIGN
FPT@OPEN.V.RES
      1382**DCL     20523<<ASSIGN  20528<<ASSIGN
FPT@OPEN.V_
      1373**DCL     20516<<ASSIGN
INSTR$
     20286**DCL     20412<<ASSIGN  20413>>ASSIGN  20414>>ASSIGN  20438>>ASSIGN  20610>>ASSIGN
NEXT_FILE_PLEASE
     20683**LABEL   20706--GOTO
QCE$ERROR_INTERNAL
     20289**DCL-ENT 20532--CALL    20709--CALL
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:36   
QCE$ERROR_M$INTERNAL
     20290**DCL-ENT 20539--CALL
QCU$USE_IO
     20291**DCL-ENT 20694--CALL
QCU@USE
     20364**DCL     20694<>CALL
QCU@USE.CURR_FRAME$
     20365**DCL     20690<<ASSIGN
QCU@USE.CURR_NODE$
     20367**DCL     20691<<ASSIGN
QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS
     20372**DCL     20689<<ASSIGN
QCU@USE.STATUS
     20398**DCL     20697>>DOCASE
QCU@USE.USE_DEFAULT_IO
     20369**DCL     20692<<ASSIGN
QGB$OPEN
      1525**DCL-ENT 20536--CALL
QGB_PARAM
     12651**DCL     20536<>CALL
QGB_PARAM.DVE.DVBYTE.VFC
     12719**DCL     12720--REDEF
QGB_PARAM.DVE.EOMCHAR
     12731**DCL     12732--REDEF
QGB_PARAM.MSG$
     12713**DCL     12714--REDEF
QGB_PARAM.UHDR$
     12738**DCL     12739--REDEF
QI$ACTIVATION_STATUS
     10477**DCL     10483--REDEF
QI$CIP
      9318**DCL      9388--REDEF
QI$CIP.CA
      9323**DCL      9327--REDEF    9330--REDEF    9333--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      9562**DCL      9587--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:37   
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      9564**DCL      9569--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      9570**DCL      9573--REDEF    9576--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      9598**DCL      9614--REDEF    9622--REDEF    9630--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      9599**DCL      9609--REDEF    9612--REDEF
QI$COBOL_DAD.WORD0
      9526**DCL      9527--REDEF    9541--REDEF
QI$COBOL_DAD_P_BITS.P
      9666**DCL      9672--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      9152**DCL      9153--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      9148**DCL      9151--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      9185**DCL      9186--REDEF    9187--REDEF
QI$DAD.PSEUDO_CIP
      9465**DCL      9490--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      9467**DCL      9472--REDEF
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      9473**DCL      9476--REDEF    9479--REDEF
QI$DAD.WORD0
      9434**DCL      9435--REDEF
QI$ERROR_MESSAGE_LINE
     12826**DCL     12828--REDEF
QI$ERROR_STATUS
     12823**DCL     12825--REDEF
QI$ERROR_STATUS.TEXT
     12824**DCL     20678<<ASSIGN
QI$FIELD_DAD.ELEMENTARY_ITEM.P
      9880**DCL      9887--REDEF
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      9900**DCL      9907--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:38   
QI$FIELD_DAD.PSEUDO_CIP
      9807**DCL      9832--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      9809**DCL      9814--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      9815**DCL      9818--REDEF    9821--REDEF
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      9920**DCL      9927--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      9863**DCL      9879--REDEF    9897--REDEF    9915--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      9864**DCL      9874--REDEF    9877--REDEF
QI$FIELD_DAD.WORD0
      9759**DCL      9760--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      9763**DCL      9768--REDEF
QI$FIELD_DAD_P.P
      9961**DCL      9968--REDEF
QI$FIELD_STATUS.INDICATORS
     10627**DCL     10659--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
     10631**DCL     10636--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
     10643**DCL     10650--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
     10637**DCL     10642--REDEF
QI$FILE.DCB#
     10107**DCL     20517>>ASSIGN
QI$FILE.ERROR_STATUS@D
     10096**DCL     20659>>ASSIGN
QI$FILE.STATUS_AREA@D
     10101**DCL     20478>>ASSIGN  20576>>ASSIGN
QI$FILE.WORD0
     10083**DCL     10084--REDEF
QI$FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
     10088**DCL     20636>>IF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:39   
QI$FILE.WORD0_FLAGS.TYPE
     10092**DCL     20519>>DOCASE  20542>>ASSIGN  20614>>IF
QI$FILE_STATUS.BACK_LINK@P
     10891**DCL     20607<<ASSIGN
QI$FILE_STATUS.CURRENT.USAGE.OPENED
     10884**DCL     20609<<ASSIGN
QI$FILE_STATUS.FLINK$
     10894**DCL     20595>>ASSIGN  20599<<ASSIGN  20606<<ASSIGN
QI$FILE_STATUS.INDICATORS
     10920**DCL     10952--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
     10924**DCL     10929--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
     10936**DCL     10943--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT
     10940**DCL     20499>>IF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS.IS_OUTPUT
     10937**DCL     20499>>IF
QI$FILE_STATUS.INDICATORS.OPEN_VALUE
     10943**DCL     20610<<ASSIGN
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
     10930**DCL     10935--REDEF
QI$FORM_FILE.MESSAGE_LINE
     10170**DCL     20626>>IF
QI$FORM_FILE.USE_PROCEDURE
     10183**DCL     10190--REDEF
QI$FORM_FILE.WORD0
     10137**DCL     10138--REDEF
QI$FORM_FILE.WORD0_FLAGS.IS_MESSAGE_LINE_VALID
     10145**DCL     20626>>IF
QI$FORM_STATUS.GZ.NEXT_AVAILABLE_FLDID
     11015**DCL     20633<<ASSIGN
QI$FORM_STATUS.INDICATORS
     11041**DCL     11073--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
     11045**DCL     11050--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:40   
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
     11057**DCL     11064--REDEF
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
     11051**DCL     11056--REDEF
QI$FRAME.WORD0
     10298**DCL     10299--REDEF
QI$FRAME_STATUS.INDICATORS
     11270**DCL     11302--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
     11274**DCL     11279--REDEF
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
     11286**DCL     11293--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
     11280**DCL     11285--REDEF
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     18152**DCL     18157--REDEF
QI$GZ_FIELD.DESCRIPTION.POSITION.LINE
     18169**DCL     20626>>IF
QI$IDENTIFIER
     12829**DCL     12831--REDEF
QI$INDICATORS
     10541**DCL     10571--REDEF
QI$INDICATORS.ENABLED_FLAGS
     10547**DCL     10552--REDEF
QI$INDICATORS.OPEN_FLAGS
     10559**DCL     10566--REDEF
QI$INDICATORS.STATE_FLAGS
     10553**DCL     10558--REDEF
QI$MAJOR_NODE.WORD0
      9997**DCL      9998--REDEF
QI$MAJOR_STATUS.INDICATORS
     10720**DCL     10752--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
     10724**DCL     10729--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
     10736**DCL     10743--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:41   
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
     10730**DCL     10735--REDEF
QI$MESSAGE_TYPE
     12820**DCL     12822--REDEF
QI$MINOR_NODE.WORD0
     10040**DCL     10041--REDEF
QI$MINOR_STATUS.INDICATORS
     10813**DCL     10845--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
     10817**DCL     10822--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
     10829**DCL     10836--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
     10823**DCL     10828--REDEF
QI$OP_ACCEPT.DATANAME@P
      7228**DCL      7229--REDEF
QI$OP_CALL.EPTR$
      7400**DCL      7401--REDEF
QI$OP_CLEAR.IO_FLAGS
      7433**DCL      7436--REDEF
QI$OP_DISPLAY.FIELD_A@P
      7700**DCL      7701--REDEF
QI$OP_ENABLE.IO_FLAGS
      7787**DCL      7790--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      7880**DCL      7885--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      8114**DCL      8115--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      8116**DCL      8117--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      8112**DCL      8113--REDEF
QI$OP_OPEN.FILE_A@P
      8679**DCL     20438>>ASSIGN
QI$OP_OPEN.FILE_COUNT
      8678**DCL     20413>>ASSIGN
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:42   
QI$OP_OPEN.IO_FLAGS
      8674**DCL      8677--REDEF
QI$OP_OPEN.IO_VALUE
      8677**DCL     20610>>ASSIGN
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      8712**DCL      8713--REDEF
QI$PSEUDO_CIP
      9213**DCL      9237--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      9217**DCL      9222--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      9223**DCL      9226--REDEF    9229--REDEF
QI$TERMINAL_ATTRIBUTES
     10434**DCL     10447--REDEF
QI$TRAN_FILE.WORD0
     10219**DCL     10220--REDEF
QI$TRAN_STATUS.INDICATORS
     11154**DCL     11186--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
     11158**DCL     11163--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     11170**DCL     11177--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     11164**DCL     11169--REDEF
QI$VARIABLE_IDENTIFIER.LENGTH
     12833**DCL     12834--IMP-SIZ
QI_1.BASE
     11362**DCL     11369--REDEF
QI_1.BASE.DATA$
     11363**DCL     20478>>ASSIGN  20576>>ASSIGN  20659>>ASSIGN
QI_1.BASE.PROC$
     11365**DCL     20438>>ASSIGN  20607>>ASSIGN
QI_1.CURRENT.FILE$
     12253**DCL     12255--REDEF   12257--REDEF   20438<<ASSIGN  20478>>ASSIGN  20517>>ASSIGN  20519>>DOCASE
     20542>>ASSIGN  20547>>ASSIGN  20599>>ASSIGN  20607>>ASSIGN  20614>>IF      20636>>IF      20659>>ASSIGN
QI_1.CURRENT.FILE_STATUS$
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:43   
     12259**DCL     12261--REDEF   12263--REDEF   20478<<ASSIGN  20499>>IF      20499>>IF      20606>>ASSIGN
     20607>>ASSIGN  20609>>ASSIGN  20610>>ASSIGN
QI_1.CURRENT.FORM$
     12255**DCL     20626>>IF      20626>>IF
QI_1.CURRENT.FORM_STATUS$
     12261**DCL     20633>>ASSIGN
QI_1.DAD
     12057**DCL     12062--REDEF
QI_1.ERROR_STATUS
     12287**DCL     20503<<ASSIGN
QI_1.FILE_HEAD
     12240**DCL     12247--REDEF
QI_1.FILE_HEAD_A$
     12247**DCL     20545>>IF      20547<<ASSIGN  20551>>ASSIGN
QI_1.INSTR$
     11370**DCL     20412>>ASSIGN  20414<<ASSIGN
QI_1.IS_ALL_LIT
     12063**DCL     12068--REDEF
QI_1.IS_FORM_VARIABLE
     12069**DCL     12074--REDEF
QI_1.IS_TEMP
     12075**DCL     12080--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     12173**DCL     12198--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     12175**DCL     12180--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     12181**DCL     12184--REDEF   12187--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     12142**DCL     12143--REDEF
QI_1.MESSAGE_LINE_GZ.START$
     12222**DCL     20626>>IF
QI_1.OFFSET
     12081**DCL     12086--REDEF
QI_1.OP.CIP
     11442**DCL     11893--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:44   
QI_1.OP.CIP.AUX
     11808**DCL     11879--REDEF
QI_1.OP.CIP.AUX.CD
     11853**DCL     11856--REDEF   11860--REDEF   11863--REDEF
QI_1.OP.CIP.S
     11512**DCL     11583--REDEF
QI_1.OP.CIP.S.CD
     11557**DCL     11560--REDEF   11564--REDEF   11567--REDEF
QI_1.OP.CIP.T
     11660**DCL     11731--REDEF
QI_1.OP.CIP.T.CD
     11705**DCL     11708--REDEF   11712--REDEF   11715--REDEF
QI_1.OP.DATA
     11900**DCL     11904--REDEF
QI_1.OP.FILL_CHAR
     12024**DCL     12027--REDEF
QI_1.OP.INX
     11957**DCL     11961--REDEF   11962--REDEF   11966--REDEF
QI_1.OP.LEN
     11940**DCL     11944--REDEF   11945--REDEF   11949--REDEF   11950--REDEF   11954--REDEF
QI_1.OP.LEN.AUX
     11943**DCL     12844--IMP-SIZ
QI_1.OP.LEN.S
     11941**DCL     12840--IMP-SIZ
QI_1.OP.LEN.T
     11942**DCL     12842--IMP-SIZ
QI_1.OP.PICTURE_STRING
     12010**DCL     12013--REDEF   12014--REDEF   12017--REDEF   12018--REDEF   12021--REDEF
QI_1.OP.ROUND
     12043**DCL     12044--REDEF   12045--REDEF
QI_1.OP.SRCH_VRFY_ELEMS
     11979**DCL     11982--REDEF
QI_1.OPENED_COUNT
     12248**DCL     12251--REDEF
QI_1.OPENED_COUNT_A
     12251**DCL     20603<<ASSIGN  20603>>ASSIGN
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:45   
QI_1.OTTER_SPACE
     12087**DCL     12092--REDEF
QI_1.PICTURE_STRING
     12093**DCL     12098--REDEF
QI_1.SPECIAL_NAMES
     12276**DCL     12285--REDEF
QI_1.TYPE
     12099**DCL     12104--REDEF
QI_16_BIT_BINARY
     17289**DCL     17359--REDEF
QI_16_BIT_BINARY.CB
     17308**DCL     17311--REDEF   17315--REDEF   17318--REDEF
QI_31_DIGIT_SLS_DISPLAY
     17122**DCL     17192--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     17169**DCL     17172--REDEF   17176--REDEF   17179--REDEF
QI_31_DIGIT_ST_PACKED
     17624**DCL     17694--REDEF
QI_31_DIGIT_ST_PACKED.CP
     17657**DCL     17660--REDEF   17664--REDEF   17667--REDEF
QI_32_BIT_BINARY
     17456**DCL     17526--REDEF
QI_32_BIT_BINARY.CB
     17475**DCL     17478--REDEF   17482--REDEF   17485--REDEF
QI_4_CHAR_ALPHANUMERIC
     16954**DCL     17024--REDEF
QI_4_CHAR_ALPHANUMERIC.CA
     16959**DCL     16963--REDEF   16966--REDEF   16969--REDEF
QI_ACCUMULATOR_DAD.CIP
     17967**DCL     18038--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     17998**DCL     18001--REDEF   18005--REDEF   18008--REDEF
QI_ALR.CIP
     12919**DCL     13370--REDEF
QI_ALR.CIP.AUX
     13285**DCL     13356--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:46   
QI_ALR.CIP.AUX.CA
     13288**DCL     13292--REDEF   13295--REDEF   13298--REDEF
QI_ALR.CIP.S
     12989**DCL     13060--REDEF
QI_ALR.CIP.S.CA
     12992**DCL     12996--REDEF   12999--REDEF   13002--REDEF
QI_ALR.CIP.T
     13137**DCL     13208--REDEF
QI_ALR.CIP.T.CA
     13140**DCL     13144--REDEF   13147--REDEF   13150--REDEF
QI_ALR.DATA
     13377**DCL     13381--REDEF
QI_ALR.FILL_CHAR
     13501**DCL     13504--REDEF
QI_ALR.INX
     13434**DCL     13438--REDEF   13439--REDEF   13443--REDEF
QI_ALR.LEN
     13417**DCL     13421--REDEF   13422--REDEF   13426--REDEF   13427--REDEF   13431--REDEF
QI_ALR.PICTURE_STRING
     13487**DCL     13490--REDEF   13491--REDEF   13494--REDEF   13495--REDEF   13498--REDEF
QI_ALR.ROUND
     13520**DCL     13521--REDEF   13522--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     13456**DCL     13459--REDEF
QI_FPT_DBCONTROL.V_
     18339**DCL     18339--REDEF
QI_FPT_INT.V_
     19177**DCL     19177--REDEF
QI_FPT_OPEN
     19342**DCL     20515>>ASSIGN
QI_MAT.CIP
     16258**DCL     16709--REDEF
QI_MAT.CIP.AUX
     16624**DCL     16695--REDEF
QI_MAT.CIP.AUX.CA
     16627**DCL     16631--REDEF   16634--REDEF   16637--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:47   
QI_MAT.CIP.S
     16328**DCL     16399--REDEF
QI_MAT.CIP.S.CA
     16331**DCL     16335--REDEF   16338--REDEF   16341--REDEF
QI_MAT.CIP.T
     16476**DCL     16547--REDEF
QI_MAT.CIP.T.CA
     16479**DCL     16483--REDEF   16486--REDEF   16489--REDEF
QI_MAT.DATA
     16716**DCL     16720--REDEF
QI_MAT.DEC
     16784**DCL     16788--REDEF   16789--REDEF   16793--REDEF
QI_MAT.FILL_CHAR
     16840**DCL     16843--REDEF
QI_MAT.LEN
     16756**DCL     16760--REDEF   16761--REDEF   16765--REDEF   16766--REDEF   16770--REDEF
QI_MAT.PICTURE_STRING
     16826**DCL     16829--REDEF   16830--REDEF   16833--REDEF   16834--REDEF   16837--REDEF
QI_MAT.ROUND
     16859**DCL     16860--REDEF   16861--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     16795**DCL     16798--REDEF
QI_PICTURE_STRING
     17792**DCL     17862--REDEF
QI_PICTURE_STRING.CA
     17797**DCL     17801--REDEF   17804--REDEF   17807--REDEF
QI_SRCH_VRFY.CIP
     15589**DCL     16040--REDEF
QI_SRCH_VRFY.CIP.AUX
     15955**DCL     16026--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     15958**DCL     15962--REDEF   15965--REDEF   15968--REDEF
QI_SRCH_VRFY.CIP.S
     15659**DCL     15730--REDEF
QI_SRCH_VRFY.CIP.S.CA
     15662**DCL     15666--REDEF   15669--REDEF   15672--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:48   
QI_SRCH_VRFY.CIP.T
     15807**DCL     15878--REDEF
QI_SRCH_VRFY.CIP.T.CA
     15810**DCL     15814--REDEF   15817--REDEF   15820--REDEF
QI_SRCH_VRFY.DATA
     16047**DCL     16051--REDEF
QI_SRCH_VRFY.DEC
     16115**DCL     16119--REDEF   16120--REDEF   16124--REDEF
QI_SRCH_VRFY.FILL_CHAR
     16171**DCL     16174--REDEF
QI_SRCH_VRFY.ROUND
     16190**DCL     16191--REDEF   16192--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     16131**DCL     16134--REDEF   16135--REDEF   16138--REDEF   16139--REDEF   16142--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     16055**DCL     16059--REDEF   16060--REDEF   16064--REDEF   16065--REDEF   16069--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     16126**DCL     16129--REDEF
QI_TYPE_BINARY_TARGET.CIP
     14916**DCL     15367--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     15282**DCL     15353--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     15285**DCL     15289--REDEF   15292--REDEF   15295--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     14986**DCL     15057--REDEF
QI_TYPE_BINARY_TARGET.CIP.S.CA
     14989**DCL     14993--REDEF   14996--REDEF   14999--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     15134**DCL     15205--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     15151**DCL     15154--REDEF   15158--REDEF   15161--REDEF
QI_TYPE_BINARY_TARGET.DATA
     15374**DCL     15378--REDEF
QI_TYPE_BINARY_TARGET.DEC
     15442**DCL     15446--REDEF   15447--REDEF   15451--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:49   
QI_TYPE_BINARY_TARGET.LEN
     15414**DCL     15418--REDEF   15419--REDEF   15423--REDEF   15424--REDEF   15428--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     15484**DCL     15487--REDEF   15488--REDEF   15491--REDEF   15492--REDEF   15495--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     15517**DCL     15518--REDEF   15519--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     15503**DCL     15504--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     15453**DCL     15456--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     13584**DCL     14035--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     13950**DCL     14021--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     13953**DCL     13957--REDEF   13960--REDEF   13963--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     13654**DCL     13725--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     13699**DCL     13702--REDEF   13706--REDEF   13709--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     13802**DCL     13873--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     13805**DCL     13809--REDEF   13812--REDEF   13815--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     14042**DCL     14046--REDEF
QI_TYPE_DISPLAY_SOURCE.DEC
     14110**DCL     14114--REDEF   14115--REDEF   14119--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     14082**DCL     14086--REDEF   14087--REDEF   14091--REDEF   14092--REDEF   14096--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     14152**DCL     14155--REDEF   14156--REDEF   14159--REDEF   14160--REDEF   14163--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     14185**DCL     14186--REDEF   14187--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     14171**DCL     14172--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:50   
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     14121**DCL     14124--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     14250**DCL     14701--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     14616**DCL     14687--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     14619**DCL     14623--REDEF   14626--REDEF   14629--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     14320**DCL     14391--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     14323**DCL     14327--REDEF   14330--REDEF   14333--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     14468**DCL     14539--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     14513**DCL     14516--REDEF   14520--REDEF   14523--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     14708**DCL     14712--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     14776**DCL     14780--REDEF   14781--REDEF   14785--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     14748**DCL     14752--REDEF   14753--REDEF   14757--REDEF   14758--REDEF   14762--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     14818**DCL     14821--REDEF   14822--REDEF   14825--REDEF   14826--REDEF   14829--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     14851**DCL     14852--REDEF   14853--REDEF
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     14837**DCL     14838--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     14787**DCL     14790--REDEF
QI_VLP_SEGMENT.BASE
     18876**DCL     18876--REDEF
QI_VLP_SEGMENT_BUFFER.BASE
     18974**DCL     18974--REDEF
QI_VLP_SEGMENT_LOAD.BASE
     19072**DCL     19072--REDEF
PL6.E3A0      #001=QBO$OPEN File=QBO$OPEN.:E05TSI                                WED 07/30/97 04:52 Page:51   
QI_VLP_TRMCTL.BREAKCOUNT
     20066**DCL     20067--REDEF
QI_VLP_XBREAK.IC
     20256**DCL     20256--REDEF
QI_VLP_XBREAK.OLDIC
     20256**DCL     20257--REDEF   20257--REDEF
RETRY_STATUS_FLAGS
     20499**LABEL   20703--GOTO
TYPE_INDEX
     20287**DCL     20542<<ASSIGN  20545>>IF      20547>>ASSIGN  20551>>ASSIGN  20603>>ASSIGN  20603>>ASSIGN
