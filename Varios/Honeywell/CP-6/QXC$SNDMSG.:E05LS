VERSION E05

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:1    
        1        1        /*M* QXC$SNDMSG - TPCP transmit a message routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QXC$SNDMSG:
        9        9                PROC(P_MSGBLK);
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE CP_6_SUBS;
       16      690        %INCLUDE B_ERRORS_C;
       17     1817        %INCLUDE B$JIT;
       18     2107        %INCLUDE QQ_MACROS_C;
       19     2532        %INCLUDE QQ_SUBS_C;
       20     2724        %INCLUDE OC_SUBS_C;
       21     3455        %INCLUDE Q_SCODE_C;
       22     3466        %INCLUDE Q_ERRCODE_C;
       23     3489        %INCLUDE QX_MACROS_C;
       24     3624        %INCLUDE QX_DATA_R;
       25     3634        %PAGE(ARG="Parameters");

              3651    1   /***************************************************************************
              3652    1    *                                                                         *
              3653    1    *                                 Parameters                              *
              3654    1    *                                                                         *
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:2    
              3655    1    ***************************************************************************/

       26     3659        %MSGBLK(FPTN=P_MSGBLK);
       27     3749        %PAGE(ARG="Externally defined routines");

              3766    1   /***************************************************************************
              3767    1    *                                                                         *
              3768    1    *                        Externally defined routines                      *
              3769    1    *                                                                         *
              3770    1    ***************************************************************************/

       28     3774    1   DCL QXC$SCREECH ENTRY(3);
       29     3775        %PAGE(ARG="Symrefs");

              3792    1   /***************************************************************************
              3793    1    *                                                                         *
              3794    1    *                                  Symrefs                                *
              3795    1    *                                                                         *
              3796    1    ***************************************************************************/

       30     3800    1   DCL B$TCB$ PTR SYMREF;
       31     3801    1   DCL B$JIT$ PTR SYMREF;
       32     3802        %PAGE(ARG="DCBs");

              3819    1   /***************************************************************************
              3820    1    *                                                                         *
              3821    1    *                                    DCBs                                 *
              3822    1    *                                                                         *
              3823    1    ***************************************************************************/

       33     3827    1   DCL M$DO DCB;
       34     3828        %PAGE(ARG="Based");

              3845    1   /***************************************************************************
              3846    1    *                                                                         *
              3847    1    *                                   Based                                 *
              3848    1    *                                                                         *
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:3    
              3849    1    ***************************************************************************/

       35     3853        %B$EXCFR;
       36     3871        %B$TCB;
       37     3874        %B$ALT;
       38     3882
       39     3883    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       40     3884
       41     3885        %GLOBAL_PTRS(FPTN=GLOBAL$PTRS, STCLASS="BASED(QX_GLOBAL.GLOBAL$PTRS$)");
       42     3978        %PAGE(ARG="Auto");

              3995    1   /***************************************************************************
              3996    1    *                                                                         *
              3997    1    *                                    Auto                                 *
              3998    1    *                                                                         *
              3999    1    ***************************************************************************/

       43     4003        %GLOBAL_PTRS;
       44     4096    1   DCL P$ PTR;
       45     4097
       46     4098    1   DCL I UBIN WORD;
       47     4099    1   DCL NUM_LINES UBIN WORD;
       48     4100    1   DCL CHAR_STRING_SIZE UBIN WORD;
       49     4101    1   DCL OUTPUT_LINE CHAR(80);
       50     4102    1   DCL FULLMSG CHAR(728/* MINI_MSGBLK_SIZE + ERRBUF_SIZE + KEYIN_TEMPLATE_SIZE */);
       51     4103        %PAGE(ARG="VLPs", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:4    
              4120    1   /***************************************************************************
              4121    1    *                                                                         *
              4122    1    *                                    VLPs                                 *
              4123    1    *                                                                         *
              4124    1    ***************************************************************************/

       52     4128        %VLP_SETSTA(FPTN=VLP_SETSTA_UNLOCKED, STCLASS=CONSTANT, WAS=YES);
       53     4156        %VLP_STATION(STCLASS=CONSTANT);
       54     4183        %PAGE(ARG="G L O B A L   D A T A", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:5    
              4200    1   /***************************************************************************
              4201    1    *                                                                         *
              4202    1    *                           G L O B A L   D A T A                         *
              4203    1    *                                                                         *
              4204    1    ***************************************************************************/

       55     4208        %PAGE(ARG="FPTs");

              4225    1   /***************************************************************************
              4226    1    *                                                                         *
              4227    1    *                                    FPTs                                 *
              4228    1    *                                                                         *
              4229    1    ***************************************************************************/

       56     4233        %FPT_WRITE(FPTN=FPT$WRITE_CG,
       57     4234        STCLASS="BASED(GLOBAL_PTRS.FPT$WRITE_CG$)");
       58     4265
       59     4266        %FPT_OPEN(FPTN=FPT$OPEN_CG,
       60     4267        STCLASS="BASED(GLOBAL_PTRS.FPT$OPEN_CG$)");
       61     4376
       62     4377        %FPT_OCMSG(FPTN=FPT$OCMSG,
       63     4378        STCLASS="BASED(GLOBAL_PTRS.FPT$OCMSG$)");
       64     4394        %PAGE(ARG="VLPs");

              4411    1   /***************************************************************************
              4412    1    *                                                                         *
              4413    1    *                                    VLPs                                 *
              4414    1    *                                                                         *
              4415    1    ***************************************************************************/

       65     4419        %VLP_STATION(FPTN=VLP$STATION,
       66     4420        STCLASS="BASED(GLOBAL_PTRS.VLP$STATION$)");
       67     4447
       68     4448        %VLP_SETSTA(FPTN=VLP$SETSTA,
       69     4449        STCLASS="BASED(GLOBAL_PTRS.VLP$SETSTA$)");
       70     4477        %PAGE(ARG="QX$GLOBAL");

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:6    
              4494    1   /***************************************************************************
              4495    1    *                                                                         *
              4496    1    *                                 QX$GLOBAL                               *
              4497    1    *                                                                         *
              4498    1    ***************************************************************************/

       71     4502        %QX$GLOBAL;
       72     4525        %PAGE(ARG="QXC$SNDMSG", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:7    
              4542    1   /***************************************************************************
              4543    1    *                                                                         *
              4544    1    *                                 QXC$SNDMSG                              *
              4545    1    *                                                                         *
              4546    1    ***************************************************************************/

       73     4550    1           GLOBAL_PTRS = GLOBAL$PTRS;
       74     4551
       75     4552    1           CALL TO_TPA;
       76     4553
       77     4554    1           IF P_MSGBLK.FLAGS.DEST.STATION THEN
       78     4555    2             DO;
       79     4556    2               CALL TO_STATION;
       80     4557    2             END;
       81     4558
       82     4559    1   RET:
       83     4560    1           RETURN;
       84     4561                %PAGE(ARG="TO_TPA", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:8    
              4578    1   /***************************************************************************
              4579    1    *                                                                         *
              4580    1    *                                   TO_TPA                                *
              4581    1    *                                                                         *
              4582    1    ***************************************************************************/

       85     4586    1   TO_TPA:
       86     4587    1           PROC;
       87     4588
       88     4589    2           IF QX$GLOBAL.SETSTA_LOCKED THEN
       89     4590    3             DO;
       90     4591    3               VLP$SETSTA = VLP_SETSTA_UNLOCKED;
       91     4592    3               CALL M$OPEN(FPT$OPEN_CG) ALTRET(MON_ERR);
       92     4593    3               QX$GLOBAL.SETSTA_LOCKED = '0'B;
       93     4594    3             END;
       94     4595
       95     4596    2           CHAR_STRING_SIZE = 14 /* MINI_MSGBLK_SIZE */;
       96     4597    2           ADDR(FULLMSG) -> CHAR$STRING = ADDR(P_MSGBLK) -> CHAR$STRING;
       97     4598    2           CHAR_STRING_SIZE = P_MSGBLK.ARS + 74 /* KEYIN_TEMPLATE_SIZE */;
       98     4599    2           PINCRC(ADDR(FULLMSG), 14 /* MINI_MSGBLK_SIZE */) -> CHAR$STRING =
       99     4600    2               P_MSGBLK.TEXT$ -> CHAR$STRING;
      100     4601    2           FPT$WRITE_CG.BUF_.BUF$ = ADDR(FULLMSG);
      101     4602    2           FPT$WRITE_CG.BUF_.BOUND = 14 /* MINI_MSGBLK_SIZE */+ 74
              4602                    /* KEYIN_TEMPLATE_SIZE */ +
      102     4603    2               P_MSGBLK.ARS - 1;
      103     4604    2           VLP$STATION = VLP_STATION;
      104     4605    2           VLP$STATION.STATION# = 'TPA';
      105     4606    2           VLP$STATION.MSGTYP# = 'TOTPA';
      106     4607    2           CALL M$WRITE(FPT$WRITE_CG) ALTRET(WRITE_ERR);
      107     4608
      108     4609    3           DO WHILE('0'B);
      109     4610
      110     4611    3   WRITE_ERR:
      111     4612    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 13 /* E$DACTR */ THEN
      112     4613    4               DO;
      113     4614    4                 GOTO MON_ERR;
      114     4615    4               END;
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:9    
      115     4616
      116     4617    3             FPT$OCMSG.V.MSG# = TP_DIS_MSG#;
      117     4618    3             CALL M$OCMSG(FPT$OCMSG) ALTRET(MON_ERR);
      118     4619    3           END /* NEVER */;
      119     4620
      120     4621    2           RETURN;
      121     4622
      122     4623    2   MON_ERR:
      123     4624    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      124     4625    2           CALL QXC$SCREECH(750, '03'O, 5);
      125     4626    2   END TO_TPA;
      126     4627        %EJECT;
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:10   
      127     4628    1   TO_STATION:
      128     4629    1           PROC;
      129     4630    2           RETURN;
      130     4631    2   END TO_STATION;
      131     4632    1   END QXC$SNDMSG;

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:11   
--  Include file information  --

   QX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QX_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   Q_SCODE_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QXC$SNDMSG.

   Procedure QXC$SNDMSG requires 101 words for executable code.
   Procedure QXC$SNDMSG requires 258 words of local(AUTO) storage.

    No errors detected in file QXC$SNDMSG.:E05TSI    .

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:12   

 Object Unit name= QXC$SNDMSG                                 File name= QXC$SNDMSG.:E05TOU
 UTS= JUL 30 '97 05:55:45.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DO
    2  RoData even  UTS     23     27  QXC$SNDMSG
    3   Proc  even  none   101    145  QXC$SNDMSG
    4  RoData even  none     5      5  QXC$SNDMSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  QXC$SNDMSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 QXC$SCREECH
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    QX_GLOBAL                             B$TCB$
     B$JIT$                                M$DO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:14   


        1        1        /*M* QXC$SNDMSG - TPCP transmit a message routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QXC$SNDMSG:
        9        9                PROC(P_MSGBLK);

      9  3 000000   000000 700200 xent  QXC$SNDMSG   TSX0  ! X66_AUTO_1
         3 000001   000402 000001                    ZERO    258,1

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE CP_6_SUBS;
       16      690        %INCLUDE B_ERRORS_C;
       17     1817        %INCLUDE B$JIT;
       18     2107        %INCLUDE QQ_MACROS_C;
       19     2532        %INCLUDE QQ_SUBS_C;
       20     2724        %INCLUDE OC_SUBS_C;
       21     3455        %INCLUDE Q_SCODE_C;
       22     3466        %INCLUDE Q_ERRCODE_C;
       23     3489        %INCLUDE QX_MACROS_C;
       24     3624        %INCLUDE QX_DATA_R;
       25     3634        %PAGE(ARG="Parameters");
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:15   

              3651    1   /***************************************************************************
              3652    1    *                                                                         *
              3653    1    *                                 Parameters                              *
              3654    1    *                                                                         *
              3655    1    ***************************************************************************/

       26     3659        %MSGBLK(FPTN=P_MSGBLK);
       27     3749        %PAGE(ARG="Externally defined routines");

              3766    1   /***************************************************************************
              3767    1    *                                                                         *
              3768    1    *                        Externally defined routines                      *
              3769    1    *                                                                         *
              3770    1    ***************************************************************************/

       28     3774    1   DCL QXC$SCREECH ENTRY(3);
       29     3775        %PAGE(ARG="Symrefs");

              3792    1   /***************************************************************************
              3793    1    *                                                                         *
              3794    1    *                                  Symrefs                                *
              3795    1    *                                                                         *
              3796    1    ***************************************************************************/

       30     3800    1   DCL B$TCB$ PTR SYMREF;
       31     3801    1   DCL B$JIT$ PTR SYMREF;
       32     3802        %PAGE(ARG="DCBs");

              3819    1   /***************************************************************************
              3820    1    *                                                                         *
              3821    1    *                                    DCBs                                 *
              3822    1    *                                                                         *
              3823    1    ***************************************************************************/

       33     3827    1   DCL M$DO DCB;
       34     3828        %PAGE(ARG="Based");
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:16   

              3845    1   /***************************************************************************
              3846    1    *                                                                         *
              3847    1    *                                   Based                                 *
              3848    1    *                                                                         *
              3849    1    ***************************************************************************/

       35     3853        %B$EXCFR;
       36     3871        %B$TCB;
       37     3874        %B$ALT;
       38     3882
       39     3883    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       40     3884
       41     3885        %GLOBAL_PTRS(FPTN=GLOBAL$PTRS, STCLASS="BASED(QX_GLOBAL.GLOBAL$PTRS$)");
       42     3978        %PAGE(ARG="Auto");

              3995    1   /***************************************************************************
              3996    1    *                                                                         *
              3997    1    *                                    Auto                                 *
              3998    1    *                                                                         *
              3999    1    ***************************************************************************/

       43     4003        %GLOBAL_PTRS;
       44     4096    1   DCL P$ PTR;
       45     4097
       46     4098    1   DCL I UBIN WORD;
       47     4099    1   DCL NUM_LINES UBIN WORD;
       48     4100    1   DCL CHAR_STRING_SIZE UBIN WORD;
       49     4101    1   DCL OUTPUT_LINE CHAR(80);
       50     4102    1   DCL FULLMSG CHAR(728/* MINI_MSGBLK_SIZE + ERRBUF_SIZE + KEYIN_TEMPLATE_SIZE */);
       51     4103        %PAGE(ARG="VLPs", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:17   
              4120    1   /***************************************************************************
              4121    1    *                                                                         *
              4122    1    *                                    VLPs                                 *
              4123    1    *                                                                         *
              4124    1    ***************************************************************************/

       52     4128        %VLP_SETSTA(FPTN=VLP_SETSTA_UNLOCKED, STCLASS=CONSTANT, WAS=YES);
       53     4156        %VLP_STATION(STCLASS=CONSTANT);
       54     4183        %PAGE(ARG="G L O B A L   D A T A", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:18   
              4200    1   /***************************************************************************
              4201    1    *                                                                         *
              4202    1    *                           G L O B A L   D A T A                         *
              4203    1    *                                                                         *
              4204    1    ***************************************************************************/

       55     4208        %PAGE(ARG="FPTs");

              4225    1   /***************************************************************************
              4226    1    *                                                                         *
              4227    1    *                                    FPTs                                 *
              4228    1    *                                                                         *
              4229    1    ***************************************************************************/

       56     4233        %FPT_WRITE(FPTN=FPT$WRITE_CG,
       57     4234        STCLASS="BASED(GLOBAL_PTRS.FPT$WRITE_CG$)");
       58     4265
       59     4266        %FPT_OPEN(FPTN=FPT$OPEN_CG,
       60     4267        STCLASS="BASED(GLOBAL_PTRS.FPT$OPEN_CG$)");
       61     4376
       62     4377        %FPT_OCMSG(FPTN=FPT$OCMSG,
       63     4378        STCLASS="BASED(GLOBAL_PTRS.FPT$OCMSG$)");
       64     4394        %PAGE(ARG="VLPs");

              4411    1   /***************************************************************************
              4412    1    *                                                                         *
              4413    1    *                                    VLPs                                 *
              4414    1    *                                                                         *
              4415    1    ***************************************************************************/

       65     4419        %VLP_STATION(FPTN=VLP$STATION,
       66     4420        STCLASS="BASED(GLOBAL_PTRS.VLP$STATION$)");
       67     4447
       68     4448        %VLP_SETSTA(FPTN=VLP$SETSTA,
       69     4449        STCLASS="BASED(GLOBAL_PTRS.VLP$SETSTA$)");
       70     4477        %PAGE(ARG="QX$GLOBAL");

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:19   
              4494    1   /***************************************************************************
              4495    1    *                                                                         *
              4496    1    *                                 QX$GLOBAL                               *
              4497    1    *                                                                         *
              4498    1    ***************************************************************************/

       71     4502        %QX$GLOBAL;
       72     4525        %PAGE(ARG="QXC$SNDMSG", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:20   
              4542    1   /***************************************************************************
              4543    1    *                                                                         *
              4544    1    *                                 QXC$SNDMSG                              *
              4545    1    *                                                                         *
              4546    1    ***************************************************************************/

       73     4550    1           GLOBAL_PTRS = GLOBAL$PTRS;

   4550  3 000002   000000 470400 xsym               LDP0    QX_GLOBAL
         3 000003   000100 100500                    MLR     fill='000'O
         3 000004   000000 000264                    ADSC9   0,,PR0                   cn=0,n=180
         3 000005   200004 000264                    ADSC9   GLOBAL_PTRS,,AUTO        cn=0,n=180

       74     4551
       75     4552    1           CALL TO_TPA;

   4552  3 000006   000017 701000 3                  TSX1    TO_TPA
         3 000007   000000 011000                    NOP     0

       76     4553
       77     4554    1           IF P_MSGBLK.FLAGS.DEST.STATION THEN

   4554  3 000010   200003 470500                    LDP0    @P_MSGBLK,,AUTO
         3 000011   000002 236100                    LDQ     2,,PR0
         3 000012   000100 316003                    CANQ    64,DU
         3 000013   000016 600000 3                  TZE     RET

       78     4555    2             DO;

       79     4556    2               CALL TO_STATION;

   4556  3 000014   000143 701000 3                  TSX1    TO_STATION
         3 000015   000000 011000                    NOP     0

       80     4557    2             END;

       81     4558
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:21   
       82     4559    1   RET:
       83     4560    1           RETURN;

   4560  3 000016   000000 702200 xent  RET          TSX2  ! X66_ARET

       84     4561                %PAGE(ARG="TO_TPA", PAGE=YES);

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:22   
              4578    1   /***************************************************************************
              4579    1    *                                                                         *
              4580    1    *                                   TO_TPA                                *
              4581    1    *                                                                         *
              4582    1    ***************************************************************************/

       85     4586    1   TO_TPA:

   4586  3 000017   200400 741300       TO_TPA       STX1  ! FULLMSG+182,,AUTO

       86     4587    1           PROC;
       87     4588
       88     4589    2           IF QX$GLOBAL.SETSTA_LOCKED THEN

   4589  3 000020   200060 470500                    LDP0    GLOBAL_PTRS+44,,AUTO
         3 000021   000001 234100                    SZN     1,,PR0
         3 000022   000035 605000 3                  TPL     s:4596

       89     4590    3             DO;

       90     4591    3               VLP$SETSTA = VLP_SETSTA_UNLOCKED;

   4591  3 000023   200026 471500                    LDP1    GLOBAL_PTRS+18,,AUTO
         3 000024   000100 100400                    MLR     fill='000'O
         3 000025   000000 000060 2                  ADSC9   VLP_SETSTA_UNLOCKED      cn=0,n=48
         3 000026   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

       91     4592    3               CALL M$OPEN(FPT$OPEN_CG) ALTRET(MON_ERR);

   4592  3 000027   200052 470500                    LDP0    GLOBAL_PTRS+38,,AUTO
         3 000030   450000 713400                    CLIMB   alt,open
         3 000031   410400 401760                    pmme    nvectors=18
         3 000032   000130 702000 3                  TSX2    MON_ERR

       92     4593    3               QX$GLOBAL.SETSTA_LOCKED = '0'B;

   4593  3 000033   200060 470500                    LDP0    GLOBAL_PTRS+44,,AUTO
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:23   
         3 000034   000001 450100                    STZ     1,,PR0

       93     4594    3             END;

       94     4595
       95     4596    2           CHAR_STRING_SIZE = 14 /* MINI_MSGBLK_SIZE */;

   4596  3 000035   000016 235007                    LDA     14,DL
         3 000036   200065 755100                    STA     CHAR_STRING_SIZE,,AUTO

       96     4597    2           ADDR(FULLMSG) -> CHAR$STRING = ADDR(P_MSGBLK) -> CHAR$STRING;

   4597  3 000037   200003 471500                    LDP1    @P_MSGBLK,,AUTO
         3 000040   000000 620005                    EAX0    0,AL
         3 000041   200065 721100                    LXL1    CHAR_STRING_SIZE,,AUTO
         3 000042   040140 100540                    MLR     fill='040'O
         3 000043   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         3 000044   200112 000011                    ADSC9   FULLMSG,,AUTO            cn=0,n=*X1

       97     4598    2           CHAR_STRING_SIZE = P_MSGBLK.ARS + 74 /* KEYIN_TEMPLATE_SIZE */;

   4598  3 000045   100003 236100                    LDQ     3,,PR1
         3 000046   000022 772000                    QRL     18
         3 000047   000112 036007                    ADLQ    74,DL
         3 000050   200065 756100                    STQ     CHAR_STRING_SIZE,,AUTO

       98     4599    2           PINCRC(ADDR(FULLMSG), 14 /* MINI_MSGBLK_SIZE */) -> CHAR$STRING =

   4599  3 000051   100005 473500                    LDP3    5,,PR1
         3 000052   000000 620006                    EAX0    0,QL
         3 000053   200065 721100                    LXL1    CHAR_STRING_SIZE,,AUTO
         3 000054   040140 100540                    MLR     fill='040'O
         3 000055   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         3 000056   200115 400011                    ADSC9   FULLMSG+3,,AUTO          cn=2,n=*X1

       99     4600    2               P_MSGBLK.TEXT$ -> CHAR$STRING;
      100     4601    2           FPT$WRITE_CG.BUF_.BUF$ = ADDR(FULLMSG);
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:24   

   4601  3 000057   200112 633500                    EPPR3   FULLMSG,,AUTO
         3 000060   200050 474500                    LDP4    GLOBAL_PTRS+36,,AUTO
         3 000061   400005 453500                    STP3    5,,PR4

      101     4602    2           FPT$WRITE_CG.BUF_.BOUND = 14 /* MINI_MSGBLK_SIZE */+ 74
              4602                    /* KEYIN_TEMPLATE_SIZE */ +

   4602  3 000062   100003 236100                    LDQ     3,,PR1
         3 000063   000022 772000                    QRL     18
         3 000064   000127 036007                    ADLQ    87,DL
         3 000065   000020 736000                    QLS     16
         3 000066   400004 676100                    ERQ     4,,PR4
         3 000067   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000070   400004 656100                    ERSQ    4,,PR4

      102     4603    2               P_MSGBLK.ARS - 1;
      103     4604    2           VLP$STATION = VLP_STATION;

   4604  3 000071   200025 475500                    LDP5    GLOBAL_PTRS+17,,AUTO
         3 000072   000100 100400                    MLR     fill='000'O
         3 000073   000014 000040 2                  ADSC9   VLP_STATION              cn=0,n=32
         3 000074   500000 000040                    ADSC9   0,,PR5                   cn=0,n=32

      104     4605    2           VLP$STATION.STATION# = 'TPA';

   4605  3 000075   040100 100400                    MLR     fill='040'O
         3 000076   000024 000003 2                  ADSC9   VLP_STATION+8            cn=0,n=3
         3 000077   500000 000010                    ADSC9   0,,PR5                   cn=0,n=8

      105     4606    2           VLP$STATION.MSGTYP# = 'TOTPA';

   4606  3 000100   040100 100400                    MLR     fill='040'O
         3 000101   000025 000005 2                  ADSC9   VLP_STATION+9            cn=0,n=5
         3 000102   500002 000010                    ADSC9   2,,PR5                   cn=0,n=8

      106     4607    2           CALL M$WRITE(FPT$WRITE_CG) ALTRET(WRITE_ERR);
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:25   

   4607  3 000103   400000 630500                    EPPR0   0,,PR4
         3 000104   440001 713400                    CLIMB   alt,write
         3 000105   401400 401760                    pmme    nvectors=4
         3 000106   000110 702000 3                  TSX2    WRITE_ERR

      107     4608
      108     4609    3           DO WHILE('0'B);

   4609  3 000107   000126 710000 3                  TRA     s:4621

      109     4610
      110     4611    3   WRITE_ERR:
      111     4612    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 13 /* E$DACTR */ THEN

   4612  3 000110   000000 470400 xsym  WRITE_ERR    LDP0    B$TCB$
         3 000111   000000 471500                    LDP1    0,,PR0
         3 000112   100102 236100                    LDQ     66,,PR1
         3 000113   377770 376007                    ANQ     131064,DL
         3 000114   000150 116007                    CMPQ    104,DL
         3 000115   000117 600000 3                  TZE     s:4617

      112     4613    4               DO;

      113     4614    4                 GOTO MON_ERR;

   4614  3 000116   000130 710000 3                  TRA     MON_ERR

      114     4615    4               END;
      115     4616
      116     4617    3             FPT$OCMSG.V.MSG# = TP_DIS_MSG#;

   4617  3 000117   000335 235007                    LDA     221,DL
         3 000120   200053 473500                    LDP3    GLOBAL_PTRS+39,,AUTO
         3 000121   300006 755100                    STA     6,,PR3

      117     4618    3             CALL M$OCMSG(FPT$OCMSG) ALTRET(MON_ERR);
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:26   

   4618  3 000122   300000 630500                    EPPR0   0,,PR3
         3 000123   520001 713400                    CLIMB   alt,+40961
         3 000124   401000 401760                    pmme    nvectors=3
         3 000125   000130 702000 3                  TSX2    MON_ERR

      118     4619    3           END /* NEVER */;

      119     4620
      120     4621    2           RETURN;

   4621  3 000126   200400 221300                    LDX1  ! FULLMSG+182,,AUTO
         3 000127   000001 702211                    TSX2  ! 1,X1

      121     4622
      122     4623    2   MON_ERR:
      123     4624    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4624  3 000130   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         3 000131   000000 471500                    LDP1    0,,PR0
         3 000132   100102 236100                    LDQ     66,,PR1
         3 000133   000000 473400 xsym               LDP3    B$JIT$
         3 000134   300144 756100                    STQ     100,,PR3

      124     4625    2           CALL QXC$SCREECH(750, '03'O, 5);

   4625  3 000135   000002 630400 4                  EPPR0   2
         3 000136   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000137   000000 701000 xent               TSX1    QXC$SCREECH
         3 000140   000000 011000                    NOP     0

      125     4626    2   END TO_TPA;

   4626  3 000141   200400 221300                    LDX1  ! FULLMSG+182,,AUTO
         3 000142   000001 702211                    TSX2  ! 1,X1

      126     4627        %EJECT;
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:27   
      127     4628    1   TO_STATION:

   4628  3 000143   200400 741300       TO_STATION   STX1  ! FULLMSG+182,,AUTO

      128     4629    1           PROC;
      129     4630    2           RETURN;

   4630  3 000144   000001 702211                    TSX2  ! 1,X1
      130     4631    2   END TO_STATION;
      131     4632    1   END QXC$SNDMSG;

PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:28   
--  Include file information  --

   QX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QX_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   Q_SCODE_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QXC$SNDMSG.
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:29   

 **** Variables and constants ****

  ****  Section 002 RoData QXC$SNDMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 VLP_SETSTA_UNLOCKED       14-0-0/w STRC(288)   r     1 VLP_STATION

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_MSGBLK                 65-0-0/w UBIN        r     1 CHAR_STRING_SIZE
   112-0-0/c CHAR(728)   r     1 FULLMSG                    4-0-0/d STRC(1620)  r     1 GLOBAL_PTRS
    *0-0-0/w STRC(738)   r     1 P_MSGBLK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w STRC(72)    r     1 QX_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0/d STRC(360)   r     1 FPT$OCMSG                  0-0-0/d STRC(2088)  r     1 FPT$OPEN_CG
     0-0-0/d STRC(432)   r     1 FPT$WRITE_CG               0-0-0/d STRC(1620)  r     1 GLOBAL$PTRS
     0-0-0/w STRC(2016)  r     1 QX$GLOBAL                  0-0-0/w STRC(432)   r     1 VLP$SETSTA
     0-0-0/w STRC(288)   r     1 VLP$STATION
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:30   


   Procedure QXC$SNDMSG requires 101 words for executable code.
   Procedure QXC$SNDMSG requires 258 words of local(AUTO) storage.

    No errors detected in file QXC$SNDMSG.:E05TSI    .
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:31   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:32   
          MINI XREF LISTING

B$ALT.CODE
      3876**DCL      3876--REDEF    3877--REDEF    3877--REDEF
B$ALT.ERR
      3877**DCL      4624>>ASSIGN
B$ALT.ERR.CODE
      3878**DCL      4612>>IF
B$ALT.ERR.ERR#
      3878**DCL      3878--REDEF
B$ALT.EVID
      3877**DCL      3877--REDEF    3877--REDEF
B$EXCFR.ASL
      3854**DCL      3854--REDEF
B$EXCFR.ERR.ERR#
      3868**DCL      3868--REDEF
B$EXCFR.EVID
      3867**DCL      3867--REDEF    3868--REDEF
B$EXCFR.IR
      3855**DCL      3855--REDEF
B$EXCFR.PREVSZ
      3854**DCL      3854--REDEF
B$EXCFR.SUBC
      3866**DCL      3866--REDEF    3867--REDEF    3867--REDEF
B$JIT.CPFLAGS1.SLEAZE
      1925**DCL      1925--REDEF
B$JIT.ERR.MID
      1832**DCL      1832--REDEF
B$JIT.JRESPEAK
      1993**DCL      1994--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      2102**DCL      2102--REDEF    2103--REDEF
B$JIT.PNR
      2006**DCL      2006--REDEF
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:33   
B$JIT.TSLINE
      2100**DCL      2101--REDEF
B$JIT.USRERR
      1967**DCL      4624<<ASSIGN
B$JIT$
      3801**DCL      1826--IMP-PTR  4624>>ASSIGN
B$TCB.ALT$
      3872**DCL      4612>>IF       4624>>ASSIGN
B$TCB$
      3800**DCL      4612>>IF       4624>>ASSIGN
CHAR$STRING
      3883**DCL      4597<<ASSIGN   4597>>ASSIGN   4599<<ASSIGN   4599>>ASSIGN
CHAR_STRING_SIZE
      4100**DCL      3883--IMP-SIZ  4596<<ASSIGN   4597>>ASSIGN   4597>>ASSIGN   4598<<ASSIGN   4599>>ASSIGN
      4599>>ASSIGN
FPT$OCMSG
      4389**DCL      4618<>CALL
FPT$OCMSG.V.MSG#
      4390**DCL      4617<<ASSIGN
FPT$OPEN_CG
      4332**DCL      4592<>CALL
FPT$OPEN_CG.ACSVEH_
      4334**DCL      4335--REDEF
FPT$OPEN_CG.ALTKEYS_
      4340**DCL      4341--REDEF    4341--REDEF
FPT$OPEN_CG.HDR_
      4339**DCL      4340--REDEF
FPT$OPEN_CG.TAB_
      4338**DCL      4339--REDEF
FPT$OPEN_CG.UHL_
      4332**DCL      4333--REDEF    4333--REDEF
FPT$OPEN_CG.V.FSN#
      4372**DCL      4372--REDEF    4372--REDEF
FPT$OPEN_CG.WSN_
      4338**DCL      4338--REDEF
FPT$WRITE_CG
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:34   
      4251**DCL      4607<>CALL
FPT$WRITE_CG.BUF_.BOUND
      4251**DCL      4602<<ASSIGN
FPT$WRITE_CG.BUF_.BUF$
      4253**DCL      4601<<ASSIGN
FPT$WRITE_CG.STATION_
      4253**DCL      4253--REDEF
FPT$WRITE_CG.V.DVBYTE.VFC#
      4260**DCL      4260--REDEF
FULLMSG
      4102**DCL      4597--ASSIGN   4599--ASSIGN   4601--ASSIGN
GLOBAL$PTRS
      3886**DCL      4550>>ASSIGN
GLOBAL_PTRS
      4004**DCL      4550<<ASSIGN
GLOBAL_PTRS.FPT$OCMSG$
      4083**DCL      4389--IMP-PTR  4617>>ASSIGN   4618>>CALL
GLOBAL_PTRS.FPT$OPEN_CG$
      4081**DCL      4332--IMP-PTR  4592>>CALL
GLOBAL_PTRS.FPT$WRITE_CG$
      4077**DCL      4251--IMP-PTR  4601>>ASSIGN   4602>>ASSIGN   4607>>CALL
GLOBAL_PTRS.QX$GLOBAL$
      4093**DCL      4503--IMP-PTR  4589>>IF       4593>>ASSIGN
GLOBAL_PTRS.VLP$SETSTA$
      4041**DCL      4461--IMP-PTR  4591>>ASSIGN
GLOBAL_PTRS.VLP$STATION$
      4039**DCL      4432--IMP-PTR  4604>>ASSIGN   4605>>ASSIGN   4606>>ASSIGN
M$OCMSG
       142**DCL-ENT  4618--CALL
M$OPEN
        78**DCL-ENT  4592--CALL
M$WRITE
        79**DCL-ENT  4607--CALL
MON_ERR IN PROCEDURE TO_TPA
      4624**LABEL    4592--CALLALT  4614--GOTO     4618--CALLALT
P_MSGBLK
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:35   
      3660**DCL         8--PROC     4597--ASSIGN
P_MSGBLK.ARS
      3727**DCL      4598>>ASSIGN   4602>>ASSIGN
P_MSGBLK.FLAGS.DEST.STATION
      3702**DCL      4554>>IF
P_MSGBLK.TEXT$
      3734**DCL      4599>>ASSIGN
QX$GLOBAL.SETSTA_LOCKED
      4506**DCL      4589>>IF       4593<<ASSIGN
QXC$SCREECH
      3774**DCL-ENT  4625--CALL
QX_GLOBAL.DS2$_BITS
      3632**DCL      3632--REDEF
QX_GLOBAL.DS4$_BITS
      3632**DCL      3633--REDEF
QX_GLOBAL.GLOBAL$PTRS$
      3632**DCL      3886--IMP-PTR  4550>>ASSIGN
TO_STATION
      4629**PROC     4556--CALL
TO_TPA
      4587**PROC     4552--CALL
VLP$SETSTA
      4461**DCL      4591<<ASSIGN
VLP$STATION
      4432**DCL      4604<<ASSIGN
VLP$STATION.MSGIDXT
      4442**DCL      4445--REDEF
VLP$STATION.MSGTYP#
      4436**DCL      4606<<ASSIGN
VLP$STATION.STATION#
      4436**DCL      4605<<ASSIGN
VLP_SETSTA_UNLOCKED
      4140**DCL      4591>>ASSIGN
VLP_STATION
      4168**DCL      4604>>ASSIGN
VLP_STATION.MSGIDXT
PL6.E3A0      #001=QXC$SNDMSG File=QXC$SNDMSG.:E05TSI                            WED 07/30/97 05:55 Page:36   
      4178**DCL      4181--REDEF
WRITE_ERR IN PROCEDURE TO_TPA
      4612**LABEL    4607--CALLALT
