
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZIU$Q2RP: PROC ALTRET;
        7        7
        8        8    1   DCL RBUF CHAR(256) SYMREF ALIGNED;
        9        9    1   DCL 1 CURR_SCHNM CHAR(30) ALIGNED SYMREF;
       10       10    1   DCL 1 SET_HDR ALIGNED SYMREF,
       11       11    1         2 CAR_CON BIT(9) UNAL,
       12       12    1         2 * CHAR(5) UNAL,
       13       13    1         2 NAME CHAR(30) UNAL,
       14       14    1         2 * CHAR(1) UNAL,
       15       15    1         2 ORDER CHAR(6) UNAL,
       16       16    1         2 PRIOR CHAR(10) UNAL,
       17       17    1         2 * CHAR(2) UNAL,
       18       18    1         2 OWNER CHAR(10) UNAL,
       19       19    1         2 * CHAR(2) UNAL,
       20       20    1         2 NEXT CHAR(10) UNAL,
       21       21    1         2 * CHAR(1) UNAL,
       22       22    1         2 GLO_LOC CHAR(6) UNAL,
       23       23    1         2 SET_TYPE CHAR(5) UNAL;
       24       24
       25       25    1   DCL 1 REC_HDR ALIGNED SYMREF, /* CKL */
       26       26    1         2 CAR_CON BIT(9) UNAL,
       27       27    1         2 REC_NM CHAR(25) UNAL;
       28       28    1   DCL SET$ PTR SYMREF;
       29       29    1   DCL SXCNT SBIN STATIC;
       30       30    1   DCL CHK_SUM BIT(1) SYMREF;
       31       31    1   DCL 1 PRINT_HDR BIT(1) UNAL SYMREF;
       32       32
       33       33    1   DCL SC_SIZ SBIN STATIC;
       34       34    1   DCL SET_NAMES(0:19) CHAR(30) UNAL;
       35       35
       36       36    1   DCL REP_SUB_CMD UBIN SYMREF;
       37       37    1   DCL DBK_NODE UBIN SYMREF;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:2    
       38       38    1   DCL DBK_DASH_NODE UBIN SYMREF;
       39       39    1   DCL DBK_LIST_NODE UBIN SYMREF;
       40       40    1   DCL DISP_OPT_NODE UBIN SYMREF;
       41       41    1   DCL SET_LIST_NODE UBIN SYMREF;
       42       42    1   DCL SET_NODE UBIN SYMREF;
       43       43    1   DCL WALK_OPT_NODE UBIN SYMREF;
       44       44    1   DCL N_OR_P_NODE UBIN SYMREF;
       45       45    1   DCL NOP_NODE UBIN SYMREF;
       46       46    1   DCL LAST_DBK SBIN WORD SYMREF;
       47       47
       48       48    1   DCL ENT_ADDR EPTR STATIC;
       49       49    1   DCL WK(0:1023) SBIN STATIC ALIGNED;
       50       50    1   DCL III SBIN STATIC;
       51       51    1   DCL JJJ SBIN STATIC SYMDEF;
       52       52    1   DCL KKK SBIN STATIC SYMDEF;
       53       53    1   DCL V1 UBIN STATIC;
       54       54    1   DCL V2 UBIN STATIC;
       55       55    1   DCL V3 UBIN STATIC;
       56       56    1   DCL V4 UBIN STATIC;
       57       57    1   DCL V5 UBIN STATIC;
       58       58    1   DCL V6 UBIN STATIC;
       59       59    1   DCL N_K UBIN STATIC;
       60       60    1   DCL P_K UBIN STATIC;
       61       61    1   DCL O_K UBIN STATIC;
       62       62    1   DCL CURR_REC SBIN SYMREF; /* THE INDX IN MSTR_REF OF CURRENT REC */
       63       63    1   DCL REC_INDX SBIN STATIC;
       64       64    1   DCL DBK_V CHAR(V1) BASED;
       65       65    1   DCL REC_V CHAR(V2) BASED;
       66       66    1   DCL DBP_V CHAR(V3) BASED;
       67       67    1   DCL DBO_V CHAR(V4) BASED;
       68       68    1   DCL DBN_V CHAR(V5) BASED;
       69       69    1   DCL REC_TYPE SBIN(18) STATIC ALIGNED;
       70       70    1   DCL RC_IN_PA SBIN(18) BASED(SET$) CALIGNED; /* FOR RC TYPE IN PA PTR */
       71       71    1   DCL CHAR1 CHAR(1) BASED;
       72       72    1   DCL C_POS UBIN STATIC;
       73       73    1   DCL DBK_REC_SIZE UBIN STATIC;
       74       74    1   DCL DBK_REC$ PTR STATIC INIT(ADDR(RBUF));
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:3    
       75       75    1   DCL SET_PA$ PTR STATIC;
       76       76    1   DCL DBK_REC CHAR(DBK_REC_SIZE) BASED(DBK_REC$);
       77       77    1   DCL PROMPT_CHAR CHAR(1) STATIC INIT(' ');
       78       78    1   DCL JRNL_CNT UBIN STATIC;
       79       79    1   DCL JRNL_DCB# UBIN STATIC;
       80       80    1   DCL WALK_CNT UBIN STATIC;
       81       81    1   DCL TRACE_CNT UBIN STATIC;
       82       82    1   DCL CHAR4 CHAR(4) STATIC;
       83       83    1   DCL PTR_V CHAR(PTR_SIZE) BASED;
       84       84    1   DCL PA_POINTER CHAR(10) STATIC;
       85       85    1   DCL 1 PA_REC BASED(REC$) CALIGNED,
       86       86    1         2 * UBIN(6) UNAL,
       87       87    1         2 TYPE UBIN(12) UNAL,
       88       88    1         2 SIZE UBIN(18) UNAL,
       89       89    1         2 FLAGS(0:5) UBIN(1) UNAL,
       90       90    1         2 ENTRIES UBIN(12) UNAL,
       91       91    1         2 AVAIL UBIN(18) UNAL;
       92       92    1   DCL 1 PA_ENTRY BASED(ENTRY$) UNAL,
       93       93    1         2 C UBIN(1) UNAL,
       94       94    1         2 * UBIN(5) UNAL,
       95       95    1         2 TYPE UBIN(12) UNAL,
       96       96    1         2 PTRS CHAR(PTR_SIZE) UNAL;
       97       97    1   DCL 1 PA_GROUP BASED(GROUP$) UNAL,
       98       98    1         2 NO_GROUPS UBIN HALF UNAL,
       99       99    1         2 TYPE UBIN(18) UNAL,
      100      100    1         2 PTRS CHAR(PTR_SIZE) UNAL;
      101      101    1   DCL ENTRY$ PTR SYMREF;
      102      102    1   DCL GROUP$ PTR SYMREF;
      103      103    1   DCL PTR_SIZE UBIN SYMREF;
      104      104    1   DCL KEY_SIZE UBIN SYMREF;
      105      105    1   DCL KEY_PTR_SIZE UBIN SYMREF;
      106      106
      107      107        %EQU MEMBER=0;
      108      108        %EQU OWNER=1;
      109      109        %EQU PA_RC=4;
      110      110        %EQU PA_MEM=8;
      111      111        %EQU PA_ENT=16;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:4    
      112      112        %EQU O_RC=%OWNER+%PA_RC;
      113      113        %EQU RC_RC=%PA_RC+%PA_RC;
      114      114        %EQU E_RC=%PA_ENT+%PA_RC;
      115      115        %EQU E_M=%PA_ENT+%PA_MEM;
      116      116        %EQU O_M=%OWNER+%PA_MEM;
      117      117
      118      118        %EQU N=14;
      119      119        %EQU P=15;
      120      120        %EQU O=16;
      121      121    1   DCL PA_LINK(0:11) UBIN(9) UNAL CONSTANT INIT(
      122      122    1    %O_RC,0,%RC_RC,%N,%RC_RC,%P,%E_RC,%N,%E_M,%N,%O_M,%O);
      123      123
      124      124    1   DCL BUF CHAR(80) STATIC;
      125      125    1   DCL 1 BUF2 REDEF BUF,
      126      126    1         2 FIR CHAR(40) UNAL,
      127      127    1         2 SEC CHAR(40) UNAL;
      128      128
      129      129    1   DCL DBK_CUR CHAR(10) STATIC UNAL;
      130      130    1   DCL DBK_NEW CHAR(10) STATIC UNAL;
      131      131    1   DCL NOP_TEXT(0:3) CHAR(5) UNAL CONSTANT INIT(' NEXT','PRIOR','OWNER',' PA  ');
      132      132
      133      133    1   DCL AREA_INDX SBIN STATIC INIT(-1);
      134      134
      135      135    1   DCL 1 SC_MSG1 CONSTANT,
      136      136    1         2 * CHAR(6) UNAL INIT('A'),
      137      137    1         2 * CHAR(24) UNAL INIT('SET-NAME'),
      138      138    1         2 * CHAR(24) UNAL INIT('OWNER-RECORD'),
      139      139    1         2 * CHAR(26) UNAL INIT('MEMBER-RECORD');
      140      140    1   DCL 1 SC_MSG2 CONSTANT,
      141      141    1         2 * CHAR(6) UNAL INIT('@'),
      142      142    1         2 * CHAR(24) UNAL INIT('--------'),
      143      143    1         2 * CHAR(24) UNAL INIT('------------'),
      144      144    1         2 * CHAR(26) UNAL INIT('-------------');
      145      145    1   DCL 1 SC_MSG3 STATIC,
      146      146    1         2 VFC CHAR(6) UNAL INIT('B'),
      147      147    1         2 SETNAME CHAR(24) UNAL INIT(' '),
      148      148    1         2 OWNER CHAR(24) UNAL INIT(' '),
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:5    
      149      149    1         2 MEMBER CHAR(26) UNAL INIT(' ');
      150      150    1   DCL JRNL_KEY$ PTR CONSTANT INIT(ADDR(KEYVSF));
      151      151    1   DCL 1 JRNL_KEY ALIGNED BASED(JRNL_KEY$),
      152      152    1         2 L UBIN BYTE CALIGNED,
      153      153    1         2 MBZ UBIN BYTE CALIGNED,
      154      154    1         2 AREA_INDX UBIN HALF HALIGNED,
      155      155    1         2 PAGE_NO UBIN;
      156      156
      157      157    1   DCL PRINT_OPT UBIN BYTE STATIC SYMDEF ALIGNED;
      158      158    1   DCL WALK_OPT UBIN BYTE STATIC SYMDEF UNAL INIT(0);
      159      159    1   DCL R_CNT SBIN BYTE STATIC SYMDEF UNAL;
      160      160    1   DCL S_CNT SBIN BYTE STATIC SYMDEF UNAL;
      161      161    1   DCL K_CNT SBIN STATIC SYMDEF;
      162      162    1   DCL CRPT_NODE SBIN SYMREF;
      163      163    1   DCL OUTPUT_UC UBIN BYTE STATIC UNAL;
      164      164    1   DCL DASH_ON UBIN BYTE STATIC SYMDEF UNAL;
      165      165    1   DCL KCNT_SAVE SBIN BYTE STATIC UNAL;
      166      166    1   DCL ADD_FLAG SBIN BYTE STATIC UNAL;
      167      167    1   DCL FUNC_CODE UBIN BYTE STATIC UNAL;
      168      168    1   DCL RC_TYP1 UBIN STATIC;
      169      169    1   DCL RC_TYP2 UBIN STATIC;
      170      170    1   DCL N_OR_P UBIN STATIC SYMDEF;
      171      171    1   DCL 1 PA_DBK(0:19) STATIC SYMDEF,
      172      172    1         2 FIR SBIN,
      173      173    1         2 SEC SBIN;
      174      174    1   DCL NEXT_ENTRY SBIN BYTE STATIC UNAL;
      175      175    1   DCL AREA_ENCRPT(0:31) UBIN AUTO;
      176      176    1   DCL OWNER_KEY SBIN STATIC;
      177      177    1   DCL PRIOR_KEY UBIN STATIC;
      178      178    1   DCL OWNER_CNT UBIN STATIC;
      179      179    1   DCL BAD_FLAG UBIN STATIC;
      180      180    1   DCL CURRENT_KEY UBIN STATIC;
      181      181    1   DCL DCB_UC UBIN HALF CONSTANT INIT(DCBNUM(M$UC)) ALIGNED;
      182      182    1   DCL DCB_SI UBIN HALF CONSTANT INIT(DCBNUM(M$SI)) ALIGNED;
      183      183    1   DCL DCB_LO UBIN HALF CONSTANT INIT(DCBNUM(M$LO)) ALIGNED;
      184      184
      185      185    1   DCL FIND_MSTR_ENTRY ENTRY(2);
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:6    
      186      186    1   DCL HASHENTRY ENTRY(2);
      187      187    1   DCL BUILD_MSTR_TBL ENTRY ALTRET;
      188      188    1   DCL BUILD_SETXREF ENTRY ALTRET;
      189      189    1   DCL BUILD_RECXREF ENTRY ALTRET;
      190      190
      191      191        %INCLUDE ZI_DBU_XREF; /* RC-SC XREF TABLES */
      192      358        %XREF_TBLS;
      193      433        %INCLUDE ZI_GLOBAL_DBUTIL;
      194      611        %MISC_DCLS;
      195      664        %SYS_FUNC;
      196      756
      197      757        %INCLUDE CP_6_SUBS;
      198     1297        %INCLUDE CP_6;
      199     1378        %INCLUDE B_ERRORS_C;
      200     2505        %B$EXCFR;
      201     2523        %B$TCB;
      202     2526        %F$DCB;
      203     2583
      204     2584        %VLP_VECTOR(FPTN=GDS_RESULT); /* USED FOR M$GDS */
      205     2599        %FPT_PFIL(BOF=YES);
      206     2614        %FPT_PROMPT(VFC=NO,DCB=M$UC,PROMPT=PROMPT_CHAR);
      207     2642        %FPT_WRITE(FPTN=FPT_JRNL,NEWKEY=YES,ONEWKEY=NO,VFC=NO,WAIT=YES,KEY=KEYVSF);
      208     2673        %FPT_TRMPRG(STCLASS=SYMREF);
      209     2702        %FPT_OPEN(FPTN=OPEN_JRNL,ACS=DIRECT,ASN=FILE,ORG=KEYED,
      210     2703         CTG=NO,EXIST=NEWFILE,DISP=SCRATCH,FUN=CREATE);
      211     2812
      212     2813        %INCLUDE XU_MACRO_C;
      213     5919        %INCLUDE XU_PERR_C;
      214     6110
      215     6111        %P_PCB(NAME=PCB,T=RBUF,W=WK,WSZ=1024);
      216     6310        %PARSE$OUT(NAME=OUT$BLK,STCLASS="BASED(PCB.OUT$)");
      217     6355
      218     6356        %INCLUDE ZI$DIR;
      219     6513        %DIR;
      220     6657
      221     6658        %INCLUDE ZI_PRSE_SUBS; /* %SUB OF ZIU$PARSE2 */
      222     6814
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:7    
      223     6815        %INCLUDE ZI_UWA_C;
      224     7505        %ZI$UWAB;
      225     7845
      226     7846        %INCLUDE ZI_RVA_C;
      227     8527        %CAN_RVA_REF;
      228     8846
      229     8847        %INCLUDE ZI$PG_STRUCTS;
      230     8950        %DATA_PG;
      231     8969
      232     8970    1   DCL M$SI DCB;
      233     8971    1   DCL CHKSUM ENTRY;
      234     8972    1   DCL CHK_NODE ENTRY(1) ALTRET;
      235     8973    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
      236     8974    1   DCL ZERO_SUP ENTRY(3);
      237     8975    1   DCL X$PARSE ENTRY(1) ALTRET;
      238     8976    1   DCL GET_DCB ENTRY(1) ALTRET;
      239     8977    1   DCL ZIU$Q2PR1 ENTRY ALTRET; /* TO Q2PR AT OPEN,READ,DOIT LEVEL */
      240     8978    1   DCL ZIU$Q2PR2 ENTRY ALTRET; /* TO Q2PR AT READ,DOIT LEVEL */
      241     8979    1   DCL ZIU$Q2PR3 ENTRY ALTRET; /* TO Q2PR AT DOIT LEVEL */
      242     8980    1   DCL GET_NXT_AC ENTRY(1) ALTRET;
      243     8981    1   DCL DB_FUNC_FDR ENTRY(2) ALTRET;
      244     8982    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
      245     8983    1   DCL SYS_FUNC_READ ENTRY ALTRET;
      246     8984    1   DCL SYS_FUNC_RELEASE ENTRY ALTRET;
      247     8985    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      248     8986    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
      249     8987    1   DCL SYS_FUNC_CORRES ENTRY(2) ALTRET;
      250     8988
      251     8989    1   WRITE_A_LINE: PROC(MSG);
      252     8990
      253     8991    2   DCL MSG CHAR(78) UNAL;
      254     8992
      255     8993    2       DCBSF = DCB_LO; /* DEFAULT TO M$LO */
      256     8994
      257     8995    2   WRITE_TO_UC: ENTRY(MSG); /* HOWEVER, CANBE PASSED */
      258     8996    2       VFCSF=%YES#;
      259     8997    2       IF ADDR(MSG)=ADDR(NIL) THEN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:8    
      260     8998    3       DO;
      261     8999    3           BUFSF=VECTOR(BUF); /* USE DEFAULT BUFFER */
      262     9000    3           BUFLNSF=78; /* AND DEFAULT SIZE */
      263     9001    3           END;
      264     9002    2       ELSE
      265     9003    3       DO;
      266     9004    3           BUFSF=VECTOR(MSG);
      267     9005    3           CALL INDEX1(BUFLNSF,'%',MSG);
      268     9006    3           END;
      269     9007    2       CALL SYS_FUNC_WRIT;
      270     9008    2   END WRITE_A_LINE;
      271     9009
      272     9010    1   MOVE_SET_NAME: PROC;
      273     9011
      274     9012    3       DO S_CNT=0 TO SC_SIZ;
      275     9013    3           ITEM_LIST.NAME(S_CNT)=SET_NAMES(S_CNT);
      276     9014    3           END;
      277     9015    2       S_CNT=SC_SIZ;
      278     9016    2   END MOVE_SET_NAME;
      279     9017
      280     9018    1   VERIFY_SETS: PROC ALTRET;
      281     9019
      282     9020    2       BAD_FLAG=0;
      283     9021    3       DO X=0 TO S_CNT;
      284     9022    3           CALL FIND_MSTR_ENTRY(ITEM_LIST.NAME(X),MSTR_INDX);
      285     9023    3           CALL INDEX1(V2,' ',ITEM_LIST.NAME(X));
      286     9024    3           IF MSTR_INDX = -1 THEN
      287     9025    4           DO;
      288     9026    4               CALL CONCAT(BUF,'B    Set ',ADDR(ITEM_LIST.NAME(X))->REC_V,
      289     9027    4                  ' not defined in schema ',CURR_SCHNM);
      290     9028    4               CALL WRITE_A_LINE;
      291     9029    4               BAD_FLAG=BAD_FLAG+1;
      292     9030    4               END;
      293     9031    3           ELSE
      294     9032    3               IF MSTR_REF.TYPE(MSTR_INDX)<=4000 THEN
      295     9033    4               DO;
      296     9034    4                   CALL CONCAT(BUF,'a    ',ADDR(ITEM_LIST.NAME(X))->REC_V,
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:9    
      297     9035    4                      ' is a record but not a set in schema ',CURR_SCHNM);
      298     9036    4                   CALL WRITE_A_LINE;
      299     9037    4                   BAD_FLAG=BAD_FLAG+1;
      300     9038    4                   END;
      301     9039    3           END;
      302     9040    2       IF BAD_FLAG>0 THEN ALTRETURN;
      303     9041    2   END VERIFY_SETS;
      304     9042
      305     9043    1   AREA_SELECTION: PROC ALTRET;
      306     9044
      307     9045    2       IF KEY_RNG.FIR(0)=0 THEN ALTRETURN;
      308     9046    3       DO X=0 TO NO_AREAS-1;
      309     9047    3           IF KEY_RNG.FIR(0)<=AREA_KEY_XREF.MAX_KEY(X) THEN
      310     9048    4           DO;
      311     9049    4               ENT_ADDR=ENTADDR(ZIU$Q2PR3); /* JUST DO IT */
      312     9050    4               ZI$DIR.ENCP_SEED_RD=AREA_ENCRPT(X);
      313     9051    4               IF AREA_INDX=X THEN RETURN;
      314     9052    4               ZI$DIR.PGRG_RESET='1'B; /* FOR PAGE_RANGE TO WORD */
      315     9053    4               ZI$DIR.AREA_NM.NAME.TEXT=AREA_KEY_XREF.NAME(X);
      316     9054    4               IF AREA_KEY_XREF.DCB#(X)>0 THEN
      317     9055    4                   ENT_ADDR=ENTADDR(ZIU$Q2PR2); /* RE-READ ATTL BLK */
      318     9056    4               ELSE
      319     9057    4                   ENT_ADDR=ENTADDR(ZIU$Q2PR1); /* OPEN AREA */
      320     9058    4               FUNSF=%UPDATE#; /* OPEN THE AREA WITH UPDATE MODE */
      321     9059    4               SHARESF=%IN#; /* AND SHARE WITHIN INPUT USERS */
      322     9060    4               CALL GET_DCB(ZI$DIR.AREA_NM);
      323     9061    4               AREA_KEY_XREF.DCB#(X)=ZI$DIR.AREA_NM.DCB#;
      324     9062    4               LAST_DBK=UWA.SF_REC.DBKOA; /* INIT OAAC TO OA REC */
      325     9063    4               CALL GET_NXT_AC(III);
      326     9064    4               AREA_INDX=X; /* REMEMBER CURRENT AREA'S INDEX */
      327     9065    4               RETURN;
      328     9066    4               END;
      329     9067    3           END;
      330     9068    2       ALTRETURN;
      331     9069    2   END AREA_SELECTION;
      332     9070
      333     9071
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:10   
      334     9072    1   GET_CMD: PROC(PARSE_TREE,PROMPT_MSG) ALTRET;
      335     9073
      336     9074    2   DCL PARSE_TREE UBIN;
      337     9075    2   DCL PROMPT_MSG CHAR(60) UNAL;
      338     9076
      339     9077    2       III=III+1;
      340     9078    2       CALL INDEX1(V3,':',PROMPT_MSG);
      341     9079    2   RE_READ:
      342     9080    2   /**/ BUFLNSF=V3+1;
      343     9081    2   /**/ BUFSF=VECTOR(PROMPT_MSG);
      344     9082    2   REREAD_SUBCOM:
      345     9083    2   /**/ DCBSF=DCB_LO;
      346     9084    2       PCB.ROOT$=ADDR(PARSE_TREE);
      347     9085    2       CALL SYS_FUNC_WRIT;
      348     9086    2       IF OUTPUT_UC=0 THEN /* OUTPUT IS NOT UC */
      349     9087    3       DO;
      350     9088    3           DCBSF = DCB_UC;
      351     9089    3           CALL SYS_FUNC_WRIT;
      352     9090    3           END;
      353     9091    2       CALL M$PROMPT(FPT_PROMPT);
      354     9092    2       RBUF = ' '; /* INIT INPUT BUF */
      355     9093    2       DCBSF = DCBNUM(M$SI);
      356     9094    2       BUFSF = VECTOR(RBUF);
      357     9095    2       BUFLNSF = 132;
      358     9096    2       CALL SYS_FUNC_READ ALTRET(ALTRTN); /* ON READ ERROR */
      359     9097    2       CNT = DCBADDR(DCBSF)->F$DCB.ARS#;
      360     9098    2       IF PRINT_HDR THEN /* IF INPUT IS FROM FILE */
      361     9099    3       DO;
      362     9100    3           CALL CONCAT(BUF,'@ ',RBUF);
      363     9101    3           CALL WRITE_A_LINE;
      364     9102    3           CALL WRITE_A_LINE('A%');
      365     9103    3           END;
      366     9104    2       IF RBUF=' ' THEN GOTO RE_READ;
      367     9105    2       IF III>1 AND RBUF='Q' OR RBUF='QUIT' THEN ALTRETURN;
      368     9106    2       PCB.NCHARS=CNT;
      369     9107    2       CALL X$PARSE(PCB) ALTRET(PARSE_ERR);
      370     9108    2       CALL CHK_NODE(PCB.OUT$);
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:11   
      371     9109    2       RETURN;
      372     9110    2   PARSE_ERR:
      373     9111    2       KKK=PCB.HI_CHAR;
      374     9112    2       CALL CONV_DBK(KKK,DBK_CUR,V1);
      375     9113    2       V2=V3-4-V1;
      376     9114    2       ADDR(BUF2.SEC)->REC_V='@';
      377     9115    2       CALL CONCAT(BUF,ADDR(BUF2.SEC)->REC_V,'EH@ ',
      378     9116    2          ADDR(DBK_CUR)->DBK_V,'?');
      379     9117    2       BUFSF=VECTOR(BUF);
      380     9118    2       BUFLNSF=80;
      381     9119    2       GOTO REREAD_SUBCOM;
      382     9120    2   ALTRTN:
      383     9121    2       CALL WRITE_A_LINE('a  Error reading command - QUIT simulated.%');
      384     9122    2       ALTRETURN;
      385     9123    2   END GET_CMD;
      386     9124
      387     9125    1   TRACE_OUT: PROC(FLAG);
      388     9126
      389     9127    2   DCL FLAG UBIN;
      390     9128
      391     9129    2       IF TRACE_CNT+1 = WALK_CNT THEN
      392     9130    2           CHAR4=' -> ';
      393     9131    2       ELSE
      394     9132    2           CHAR4=' => ';
      395     9133    2       TRACE_CNT=WALK_CNT;
      396     9134    2       V5 = DBK_REC_SIZE+4;
      397     9135    2       IF FLAG=2 THEN V5=V5+10;
      398     9136    2       IF C_POS+V5 > 78 THEN
      399     9137    3       DO;
      400     9138    3           C_POS=V5+3;
      401     9139    3           CALL CONCAT(BUF,'a   ',CHAR4,DBK_REC);
      402     9140    3           END;
      403     9141    2       ELSE
      404     9142    3       DO;
      405     9143    3           C_POS=C_POS+V5;
      406     9144    3           CALL CONCAT(BUF,'@',CHAR4,DBK_REC);
      407     9145    3           END;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:12   
      408     9146    2       CALL WRITE_A_LINE;
      409     9147    2       IF FLAG = 2 THEN
      410     9148    3       DO;
      411     9149    3           ADD_FLAG = 1; /* WILL STOP HERE, IF IT HITS AGAIN */
      412     9150    3           IF N_OR_P = #NEXT2 THEN
      413     9151    3               CALL WRITE_A_LINE('@ Bad Prior%');
      414     9152    3           ELSE
      415     9153    3               CALL WRITE_A_LINE('@ Bad Next%');
      416     9154    3           END;
      417     9155    2       III=99999; /* GET OUT OF TRACE LOOP */
      418     9156    2   END TRACE_OUT;
      419     9157
      420     9158    1   CONV_DBK: PROC(DBK_BIN,DBK_TXT,INDX);
      421     9159
      422     9160    2   DCL DBK_BIN UBIN;
      423     9161    2   DCL DBK_TXT CHAR(10) UNAL;
      424     9162    2   DCL INDX UBIN;
      425     9163
      426     9164    2       CALL BINCHAR(DBK_TXT,DBK_BIN);
      427     9165    2       CALL ZERO_SUP(DBK_TXT,10,'1'B);
      428     9166    2       CALL INDEX1(INDX,' ',DBK_TXT);
      429     9167    2   END CONV_DBK;
      430     9168
      431     9169    1   JRNL_READ: PROC ALTRET;
      432     9170
      433     9171    2       DCBSF = JRNL_DCB#;
      434     9172    2       BUFSF = VECTOR(I_O_BUF);
      435     9173    2       BUFLNSF = 4096;
      436     9174    2       KEYSF = %NO#;
      437     9175    2       VFCSF = %NO#;
      438     9176    2       KEYRSF = '1'B;
      439     9177    2       CALL SYS_FUNC_READ ALTRET(FAIL_READ_JRNL);
      440     9178    2       AREA_INDX = JRNL_KEY.AREA_INDX;
      441     9179    2       ZI$DIR.AREA_NM.DCB# = AREA_KEY_XREF.DCB#(AREA_INDX);
      442     9180    2       ZI$DIR.ENCP_SEED_RD = AREA_ENCRPT(AREA_INDX);
      443     9181    2       RETURN;
      444     9182    2   FAIL_READ_JRNL:
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:13   
      445     9183    2       CALL WRITE_A_LINE('@  Fail to read journal, cant UNDO for you%');
      446     9184    2       ALTRETURN;
      447     9185    2   END JRNL_READ;
      448     9186
      449     9187    1   JRNL_WRITE: PROC;
      450     9188
      451     9189    2       FPT_JRNL.V.DCB# = JRNL_DCB#;
      452     9190    2       FPT_JRNL.BUF_=VECTOR(I_O_BUF);
      453     9191    2       FPT_JRNL.BUF_.BOUND=4095;
      454     9192    2       JRNL_KEY.L = 7;
      455     9193    2       JRNL_KEY.MBZ = 0;
      456     9194    2       JRNL_KEY.AREA_INDX = AREA_INDX;
      457     9195    2       JRNL_KEY.PAGE_NO = DATA_PG.CON_INTRVAL;
      458     9196    2       CALL M$WRITE(FPT_JRNL) ALTRET(REC_EXIST);
      459     9197    2       JRNL_CNT=JRNL_CNT+1;
      460     9198    2       RETURN;
      461     9199    2   REC_EXIST:
      462     9200    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR#~=%E$OLDREC THEN
      463     9201    3       DO;
      464     9202    3           MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$EXCFR.ERR;
      465     9203    3           INCL_ERR=%YES#;
      466     9204    3           CALL SYS_FUNC_ERRMSG;
      467     9205    3           CALL WRITE_A_LINE('A  Error in writing journal file... %');
      468     9206    3           CALL WRITE_A_LINE('A  Suggest you do a COMMIT command now.%');
      469     9207    3           END;
      470     9208    2   END JRNL_WRITE;
      471     9209
      472     9210    1   WRITE_A_PAGE: PROC ALTRET;
      473     9211
      474     9212    2       DCBSF=ZI$DIR.AREA_NM.DCB#;
      475     9213    2       BUFSF=VECTOR(I_O_BUF);
      476     9214    2       BUFLNSF=4096;
      477     9215    2       FULLSF=%YES#;
      478     9216    2       KEYSF=%YES#;
      479     9217    2       ENCRP_SEEDSF=ZI$DIR.ENCP_SEED;
      480     9218    2       KEYVSF.LEN=4;
      481     9219    2       KEYVSF.IDSKEY=DATA_PG.CON_INTRVAL;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:14   
      482     9220    2       VFCSF=%NO#;
      483     9221    2       NOTIMESF=%YES#;
      484     9222    2       IF CHK_SUM=%YES# THEN
      485     9223    3       DO;
      486     9224    3           CALL CHKSUM;
      487     9225    3           DATA_PG.CHKSUM_WD=ICHKSUM;
      488     9226    3           END;
      489     9227    2       CALL SYS_FUNC_WRIT ALTRET(FAIL_UPDATE);
      490     9228    2       RETURN;
      491     9229    2   FAIL_UPDATE:
      492     9230    2       CALL WRITE_A_LINE('@  Fail to update database, COMMAND aborted%');
      493     9231    2       ALTRETURN;
      494     9232    2   END WRITE_A_PAGE;
      495     9233        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:15   
      496     9234
      497     9235    1   CHK_SET: PROC ALTRET;
      498     9236
      499     9237    3       DO III=0 TO SC_SIZ;
      500     9238    3           IF ITEM_LIST.NAME(0)=SET_NAMES(III) THEN RETURN;
      501     9239    3           END;
      502     9240    2       CALL WRITE_A_LINE('@    Sorry! you are not repairing this set%');
      503     9241    2       ALTRETURN;
      504     9242    2   END CHK_SET;
      505     9243        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:16   
      506     9244        /***********************************************************
      507     9245
      508     9246                 GET_POINTERS: TO FIND ALL THE N/P/O/PA POINTERS
      509     9247                 FOR THE CURRENT RECORD JUST FOUND, AND TO DETERMINE
      510     9248                 THE ROLL OF THE RECORD FOR THE SET_NAME STORED IN
      511     9249                 ITEM_LIST.NAME(III) I,E, A OWNER/MEMBER/PAREC ETC.
      512     9250
      513     9251        ***********************************************************/
      514     9252
      515     9253    1   GET_POINTERS: PROC(KKK,SSS,RC_TYP) ALTRET;
      516     9254
      517     9255    2   DCL KKK SBIN; /* INPUT: THE DBK SPECIFICATION FOR THE CURR_REC */
      518     9256    2   DCL SSS SBIN; /* INPUT: SET_NAME IN ITEM_LIST.NAME(SSS) */
      519     9257    2   DCL RC_TYP UBIN; /* OUTPUT: TYPE OF RECORD IN THAT SET */
      520     9258
      521     9259    2       RC_TYP = %MEMBER; /* ASSUME THIS REC IS A MEMBER OF THE SET */
      522     9260    2       REC_INDX=MSTR_REF.NEXT(CURR_REC);
      523     9261    3       DO WHILE (REC_INDX>=0);
      524     9262    3           MSTR_INDX=SET_XREF.MSTRINDX(REC_INDX); /* LOOP THRU SET_XREF */
      525     9263    3           IF ITEM_LIST.NAME(SSS)=MSTR_REF.NAME(MSTR_INDX) THEN
      526     9264    4           DO;
      527     9265    4               IF MSTR_REF.SET.PATYPE(MSTR_INDX)='1'B THEN
      528     9266    4                   RC_TYP=%PA_MEM; /* NOW ASSUME MEMBER OF PA SET */
      529     9267    4               IF MSTR_REF.PAOFF(CURR_REC)>0 THEN
      530     9268    4                   RC_TYP=%PA_RC; /* NOW WE KNOW IT IS *PA_REC */
      531     9269    4               IF PA_DBK.FIR(KKK)>0 THEN /* PA ENTRY NUMBER SPECIFIED */
      532     9270    5               DO;
      533     9271    5                   IF RC_TYP~=%PA_RC THEN /* BUT THIS ISNT A PA REC */
      534     9272    5                       GOTO NOT_PA_REC;
      535     9273    5                   RC_TYP = %PA_ENT; /* RC TYPE IS PA REC WITH ENTRY */
      536     9274    5                   PTR_SIZE=(MSTR_REF.PAOFF(CURR_REC)-2*4)/3;
      537     9275    5                   CALL CONV_DBK(PA_DBK.FIR(KKK),BUF,V3);
      538     9276    5                   DBK_REC_SIZE=V1+V2+V3+3;
      539     9277    5                   CALL CONCAT(DBK_REC,ADDR(DBK_CUR)->DBK_V,'.',
      540     9278    5                      ADDR(BUF)->DBP_V,'(',
      541     9279    5                      ADDR(REC_HDR.REC_NM)->REC_V,')');
      542     9280    5                   IF PA_REC.ENTRIES < PA_DBK.FIR(KKK) THEN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:17   
      543     9281    5                       GOTO BAD_ENTRY_NO; /* ENTRY TOO BIG */
      544     9282    5                   ENTRY$=PINCRC(REC$,MSTR_REF.PAOFF(CURR_REC)+
      545     9283    5                      (PA_DBK.FIR(KKK)-1)*MSTR_REF.PAENT(CURR_REC));
      546     9284    5                   X=0;
      547     9285    5                   PINCRC(ADDR(X),4-PTR_SIZE)->PTR_V=PA_ENTRY.PTRS;
      548     9286    5                   SET_PA$=ADDR(PA_ENTRY.PTRS);
      549     9287    5                   IF PA_ENTRY.C=1 THEN
      550     9288    6                   DO;
      551     9289    6                       GROUP$=PINCRC(REC$,X);
      552     9290    6                       IF PA_DBK.SEC(KKK)=0 THEN
      553     9291    6                           GOTO NO_GROUP_INDX;
      554     9292    6                       CALL CONV_DBK(PA_DBK.SEC(KKK),BUF2.SEC,V4);
      555     9293    6                       DBK_REC_SIZE=1+V1+V3;
      556     9294    6                       CALL CONCAT(RBUF,DBK_REC,'.',ADDR(BUF2.SEC)->DBO_V,
      557     9295    6                          '(',ADDR(REC_HDR.REC_NM)->REC_V,')');
      558     9296    6                       DBK_REC_SIZE=V1+V2+V3+V4+4;
      559     9297    6                       IF PA_GROUP.NO_GROUPS < PA_DBK.SEC(KKK) THEN
      560     9298    6                           GOTO BAD_GROUP_NO;
      561     9299    6                       SET_PA$=PINCRC(GROUP$,(PA_DBK.SEC(KKK)-1)*(2+PTR_SIZE)+4);
      562     9300    6                       END;
      563     9301    5                   ELSE
      564     9302    5                       IF PA_DBK.SEC(KKK)>0 THEN /* IF ENTRY HAS NO GROUP */
      565     9303    5                           GOTO EXTRA_GROUP; /* BUT SPECIFIED (MISTYPED) */
      566     9304    5                   END;
      567     9305    4               IF CURR_REC=REC_XREF.MSTRINDX(MSTR_REF.NEXT(MSTR_INDX)) THEN
      568     9306    4                   RC_TYP=%OWNER; /* THIS REC IS THE OWNER OF THIS SET */
      569     9307    4               CALL GET_PTR(SET_XREF.EIS.PRIOR(REC_INDX),P_K,SET_HDR.PRIOR,V3);
      570     9308    4               CALL GET_PTR(SET_XREF.EIS.OWNR(REC_INDX),O_K,SET_HDR.OWNER,V4);
      571     9309    4               CALL GET_PTR(SET_XREF.EIS.NEXT(REC_INDX),N_K,SET_HDR.NEXT,V5);
      572     9310    4               IF RC_TYP=%PA_ENT THEN
      573     9311    5               DO;
      574     9312    5                   SET$=SET_PA$; /* RESTORE PTR TO THE PA_POINTER ADDR */
      575     9313    5                   CALL GET_PTR(-1,X,PA_POINTER,V6);
      576     9314    5                   END;
      577     9315    4               ELSE
      578     9316    4                   REC_TYPE=MSTR_REF.TYPE(CURR_REC); /* REM THE RC */
      579     9317    4               RETURN;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:18   
      580     9318    4               END;
      581     9319    3           REC_INDX=SET_XREF.NEXT(REC_INDX);
      582     9320    3           END;
      583     9321    2       IF FUNC_CODE=#DISP2 THEN ALTRETURN;
      584     9322    2       CALL CONCAT(BUF,'a    ',DBK_REC,
      585     9323    2          ' is not a tenant in set ',ITEM_LIST.NAME(SSS));
      586     9324    2       GOTO ALT_RETURN;
      587     9325    2   NOT_PA_REC:
      588     9326    2       CALL CONCAT(BUF,'a    ',DBK_REC,' is not a PA record');
      589     9327    2       GOTO ALT_RETURN;
      590     9328    2   NO_GROUP_INDX:
      591     9329    2       CALL CONCAT(BUF,'a    Require PA group index to identify ',DBK_REC);
      592     9330    2       GOTO ALT_RETURN;
      593     9331    2   BAD_GROUP_NO:
      594     9332    2       CALL CONCAT(BUF,'a    PA group index too big in ',DBK_REC);
      595     9333    2       GOTO ALT_RETURN;
      596     9334    2   EXTRA_GROUP:
      597     9335    2       CALL CONCAT(BUF,'a    No need of PA group index in ',DBK_REC);
      598     9336    2       GOTO ALT_RETURN;
      599     9337    2   BAD_ENTRY_NO:
      600     9338    2       CALL CONCAT(BUF,'a    PA entry index too big in ',DBK_REC);
      601     9339    2   ALT_RETURN:
      602     9340    2       CALL WRITE_A_LINE;
      603     9341    2       ALTRETURN;
      604     9342    2   END GET_POINTERS;
      605     9343        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:19   
      606     9344    1   GET_PTR: PROC(EIS,DBK,TXT,INDX);
      607     9345
      608     9346    2   DCL 1 EIS ALIGNED,
      609     9347    2         2 * UBIN(3) UNAL,
      610     9348    2         2 WD_OFST UBIN(15) UNAL,
      611     9349    2         2 BY_OFST UBIN(3) UNAL,
      612     9350    2         2 * UBIN(3) UNAL,
      613     9351    2         2 PTR_SZ SBIN(12) UNAL;
      614     9352    2   DCL DBK UBIN ALIGNED;
      615     9353    2   DCL TXT CHAR(10) CALIGNED;
      616     9354    2   DCL INDX SBIN ALIGNED;
      617     9355
      618     9356    2       TXT = ' ';
      619     9357    2       INDX=0;
      620     9358    2       DBK=0;
      621     9359    2       IF EIS.PTR_SZ=0 THEN RETURN;
      622     9360    2       IF EIS.PTR_SZ>0 THEN
      623     9361    3       DO;
      624     9362    3           SET$=PINCRW(REC$,EIS.WD_OFST);
      625     9363    3           SET$=PINCRC(SET$,EIS.BY_OFST/2);
      626     9364    3           PTR_SIZE=EIS.PTR_SZ;
      627     9365    3           END;
      628     9366    2       PINCRC(ADDR(DBK),4-PTR_SIZE)->PTR_V=SET$->PTR_V; /* GET PTR */
      629     9367    2       IF AREA_INDX>0 AND MSTR_REF.GLOBAL(MSTR_INDX)~=1 AND DBK>0 THEN
      630     9368    2           DBK=DBK+AREA_KEY_XREF.MAX_KEY(AREA_INDX-1); /* TO GLOBAL */
      631     9369    2       CALL CONV_DBK(DBK,TXT,INDX);
      632     9370    2   END GET_PTR;
      633     9371        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:20   
      634     9372    1   FINDBKEY: PROC ALTRET;
      635     9373
      636     9374    2       KEY_RNG.SEC(0)=KEY_RNG.FIR(0);
      637     9375    2       CALL CONV_DBK(KEY_RNG.FIR(0),DBK_CUR,V1);
      638     9376    2       CALL AREA_SELECTION ALTRET(BAD_KEY);
      639     9377    2       REC_HDR.REC_NM=' ';
      640     9378    2       CALL ENT_ADDR ALTRET(ALT_RET); /* ENTER Q2PR */
      641     9379    2       IF REC_HDR.REC_NM= ' ' THEN GOTO NOT_THERE;
      642     9380    2       CALL INDEX1(V2,' ',REC_HDR.REC_NM);
      643     9381    2       DBK_REC_SIZE=V1+V2+2;
      644     9382    2       CALL CONCAT(DBK_REC,ADDR(DBK_CUR)->DBK_V,'(',
      645     9383    2          ADDR(REC_HDR.REC_NM)->REC_V,')');
      646     9384    2       RETURN;
      647     9385    2   BAD_KEY:
      648     9386    2       CALL CONCAT(BUF,'a    DBKEY ',ADDR(DBK_CUR)->DBK_V,
      649     9387    2          ' is illegal in schema ',CURR_SCHNM);
      650     9388    2       GOTO ALT_RETURN;
      651     9389    2   NOT_THERE:
      652     9390    2       CALL CONCAT(BUF,'a    No record found at DBKEY ',DBK_CUR);
      653     9391    2   ALT_RETURN:
      654     9392    2       CALL WRITE_A_LINE;
      655     9393    2   ALT_RET:
      656     9394    2       ALTRETURN;
      657     9395    2   END FINDBKEY;
      658     9396        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:21   
      659     9397    1   PATCH_IT: PROC(PTR_TYPE,NEW_PTR) ALTRET;
      660     9398
      661     9399    2   DCL PTR_TYPE UBIN;
      662     9400    2   DCL NEW_PTR SBIN;
      663     9401
      664     9402    2       IF PTR_TYPE=#PRIOR2 THEN
      665     9403    2           CALL GET_PTR(SET_XREF.EIS.PRIOR(REC_INDX),X,PA_POINTER,V3);
      666     9404    2       ELSE
      667     9405    2           IF PTR_TYPE=#OWNER2 THEN
      668     9406    2               CALL GET_PTR(SET_XREF.EIS.OWNR(REC_INDX),X,PA_POINTER,V4);
      669     9407    2           ELSE
      670     9408    2               IF PTR_TYPE=#NEXT2 THEN
      671     9409    2                   CALL GET_PTR(SET_XREF.EIS.NEXT(REC_INDX),X,PA_POINTER,V5);
      672     9410    2       III=NEW_PTR; /*  III IS SET TO NEW PTR, CONV TO LOCAL IF NEEDED */
      673     9411    2       IF AREA_INDX>0 AND MSTR_REF.GLOBAL(MSTR_INDX)~=1 AND III>0 THEN
      674     9412    2           III=III-AREA_KEY_XREF.MAX_KEY(AREA_INDX-1); /* TO LOCAL */
      675     9413    2       CALL CONV_DBK(NEW_PTR,DBK_NEW,V1);
      676     9414    2       IF X=NEW_PTR THEN
      677     9415    2           CALL CONCAT(SC_MSG3.MEMBER,ADDR(DBK_NEW)->DBK_V,'  Not changed');
      678     9416    2       ELSE
      679     9417    3       DO;
      680     9418    3           WALK_CNT=WALK_CNT+1; /* KEEP A COUNT REC UPDATED */
      681     9419    3           CALL JRNL_WRITE;
      682     9420    3           CALL CONCAT(SC_MSG3.MEMBER,ADDR(DBK_NEW)->DBK_V,'  Was ',PA_POINTER);
      683     9421    3           SET$->PTR_V=PINCRC(ADDR(III),4-PTR_SIZE)->PTR_V;
      684     9422    3           IF FUNC_CODE=#LINK2 AND PTR_TYPE=3+#NEXT2 THEN /* FOR PA */
      685     9423    4           DO;
      686     9424    4               SET$=PINCRC(SET$,-2); /* POINT TO REC TYPE IN ENTRY */
      687     9425    4               RC_IN_PA=REC_TYPE; /* UPDATE RC IN CASE IT CHANGE */
      688     9426    4               END;
      689     9427    3           CALL WRITE_A_PAGE ALTRET(FAIL_PATCH);
      690     9428    3           END;
      691     9429    2       CALL CONCAT(BUF,'A  ',DBK_REC,'  New ',NOP_TEXT(PTR_TYPE-#NEXT2),
      692     9430    2          ' pointer ',SC_MSG3.MEMBER);
      693     9431    2       IF X=NEW_PTR AND DASH_ON=1 THEN
      694     9432    2           OWNER_CNT=OWNER_CNT+1; /* DONT PRINT, BUT KEEP COUNT */
      695     9433    2       ELSE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:22   
      696     9434    2           CALL WRITE_A_LINE;
      697     9435    2       RETURN;
      698     9436    2   FAIL_PATCH: ALTRETURN; /* ABORT LINK COMMAND */
      699     9437    2   END PATCH_IT;
      700     9438        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:23   
      701     9439    1       IF XREF_BUILT='0'B THEN
      702     9440    2       DO;
      703     9441    2           CALL BUILD_MSTR_TBL ALTRET(EXIT_RTN);
      704     9442    2           CALL BUILD_SETXREF ALTRET(EXIT_RTN);
      705     9443    2           CALL BUILD_RECXREF ALTRET(EXIT_RTN);
      706     9444    2           END;
      707     9445    1       CALL SYS_FUNC_CORRES(DCB_UC,DCB_SI) ALTRET(CHK_LO);
      708     9446    1       GOTO OKAY;
      709     9447    1   CHK_LO:
      710     9448    1       OUTPUT_UC = 1; /* SUPPOSE M$LO = M$UC */
      711     9449    1       CALL SYS_FUNC_CORRES(DCB_UC,DCB_LO) ALTRET(OKAY);
      712     9450    1       OUTPUT_UC = 0; /* M$LO IS NOT SET TO UC */
      713     9451    1       DCBSF = DCB_UC;
      714     9452    1       CALL WRITE_TO_UC('b  Warning: your M$LO is not set to you%');
      715     9453    1   OKAY:
      716     9454
      717     9455    1       S_CNT=ITMCNT;
      718     9456    1       CALL VERIFY_SETS ALTRET(EXIT_RTN);
      719     9457    1       LAST_DBK=UWA.SF_REC.DBKOA;
      720     9458    2       DO V6=0 TO NO_AREAS-1;
      721     9459    2           AREA_KEY_XREF.DCB#(V6)=0;
      722     9460    2           ZI$DIR.AREA_NM.NAME.TEXT=MSTR_REF.NAME(NO_RECS+NO_SETS+V6);
      723     9461    2           CALL GET_NXT_AC(KKK); /* GET THE AC IN SCHEMA */
      724     9462    2           KEY_RNG.FIR(0)=0;
      725     9463    2           IF UWA.AC_REC.SWS.ENCRYP THEN
      726     9464    3           DO;
      727     9465    3               CALL INDEX1(V2,' ',ZI$DIR.AREA_NM.NAME.TEXT);
      728     9466    3               CALL CONCAT(BUF,'@ ENTER ENCRYPT_SEED FOR AREA ',
      729     9467    3                  ADDR(ZI$DIR.AREA_NM.NAME.TEXT)->REC_V,'(Q to quit,0 if none):');
      730     9468    3               K_CNT=-1;
      731     9469    3               III=2; /* TYPE "Q" WILL TERMINATE REPAIR */
      732     9470    3               CALL GET_CMD(CRPT_NODE,BUF) ALTRET(EXIT_RTN);
      733     9471    3               END;
      734     9472    2           AREA_ENCRPT(V6)=KEY_RNG.FIR(0); /* SAVE THE ENCRPT SEED */
      735     9473    2           END;
      736     9474    1       CALL WRITE_A_LINE('A%');
      737     9475
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:24   
      738     9476    1       SC_SIZ=ITMCNT;
      739     9477    1       ITMCNT=-1; /* RESET FOR Q2PR */
      740     9478    1   /**/ BUFLNSF=80;
      741     9479    1   /**/ BUFSF=VECTOR(SC_MSG1);
      742     9480    1       CALL SYS_FUNC_WRIT;
      743     9481    1   /**/ BUFSF=VECTOR(SC_MSG2);
      744     9482    1       CALL SYS_FUNC_WRIT;
      745     9483    1   /**/ BUFSF=VECTOR(SC_MSG3);
      746     9484    2       DO III=0 TO SC_SIZ;
      747     9485    2           KKK=0;
      748     9486    2           SC_MSG3.VFC='b';
      749     9487    2           SC_MSG3.SETNAME=ITEM_LIST.NAME(III);
      750     9488    2           SET_NAMES(III)=ITEM_LIST.NAME(III);
      751     9489    2           CALL FIND_MSTR_ENTRY(ITEM_LIST.NAME(III),MSTR_INDX);
      752     9490    2           JJJ=MSTR_REF.NEXT(MSTR_INDX);
      753     9491    2           SC_MSG3.OWNER=MSTR_REF.NAME(REC_XREF.MSTRINDX(JJJ));
      754     9492    3           DO WHILE (REC_XREF.NEXT(JJJ)>=0);
      755     9493    3               JJJ=REC_XREF.NEXT(JJJ);
      756     9494    3               SC_MSG3.MEMBER=MSTR_REF.NAME(REC_XREF.MSTRINDX(JJJ));
      757     9495    3               IF MSTR_REF.PAENT(REC_XREF.MSTRINDX(JJJ))>0 THEN
      758     9496    4               DO;
      759     9497    4                   KKK=KKK+1;
      760     9498    4                   IF KKK=1 THEN
      761     9499    4                       CALL SYS_FUNC_WRIT;
      762     9500    4                   END;
      763     9501    3               ELSE
      764     9502    3                   CALL SYS_FUNC_WRIT;
      765     9503    3               SC_MSG3.VFC='a';
      766     9504    3               SC_MSG3.SETNAME=' ';
      767     9505    3               SC_MSG3.OWNER=' ';
      768     9506    3               END;
      769     9507    2           END;
      770     9508
      771     9509    1       AREA_INDX=-1; /* SET CURRENT AREA TO NULL */
      772     9510    1       ZI$DIR.AREA_NM.NAME.TEXT='REPAIR_DCB';
      773     9511    1       CALL GET_DCB(ZI$DIR.AREA_NM);
      774     9512    1       JRNL_DCB#=ZI$DIR.AREA_NM.DCB#;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:25   
      775     9513    1       FPT_TRMPRG.V.CTLFLG.PURGEOUTPUT#=%NO#; /* DONT PURGE OUTPUT */
      776     9514    1   RE_START:
      777     9515    1       JRNL_CNT=0; /* NUMBER OF JOURNAL RECORDS */
      778     9516    1       OPEN_JRNL.V.DCB#=JRNL_DCB#;
      779     9517    1       CALL M$OPEN(OPEN_JRNL);
      780     9518
      781     9519    1   NEXT_CMD:
      782     9520    1       BREAK_FLAG=0; /* RESET ALL FLAGS BEFORE EACH CMD */
      783     9521    1       S_CNT=-1; /* STORE SET_NAME LIST */
      784     9522    1       R_CNT=-1; /* STORE RECORD_NAME LIST */
      785     9523    1       K_CNT=-1;
      786     9524    1       KCNT=0;
      787     9525    1       SXCNT=0;
      788     9526    1       III=0;
      789     9527    1       ZI$DIR.PITEM='0'B; /* DEFAULT = DONT PRINT ITEMS */
      790     9528    1       PRINT_OPT=0;
      791     9529    1       WALK_OPT=1;
      792     9530    1       DASH_ON=0;
      793     9531    1       WALK_CNT=0;
      794     9532    1       OWNER_CNT=0;
      795     9533    1       N_OR_P=0;
      796     9534
      797     9535    1       CALL GET_CMD(REP_SUB_CMD,'bCOMMAND:') ALTRET(E_O_F);
      798     9536    1       CALL WRITE_A_LINE('A%');
      799     9537
      800     9538    1       FUNC_CODE=OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      801     9539    2       DO CASE(FUNC_CODE);
      802     9540
      803     9541    2       CASE(#END2); /* RETURN TO MAIN */
      804     9542    2   E_O_F:
      805     9543    3           DO III=0 TO NO_AREAS-1;
      806     9544    3               IF AREA_KEY_XREF.DCB#(III)>0 THEN
      807     9545    4               DO;
      808     9546    4                   DCBSF=AREA_KEY_XREF.DCB#(III);
      809     9547    4                   CALL SYS_FUNC_CLOS;
      810     9548    4                   CALL SYS_FUNC_RELDCB;
      811     9549    4                   END;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:26   
      812     9550    3               END; /* ALL OPENED DCB NOW CLOSED */
      813     9551    2           DCBSF=JRNL_DCB#;
      814     9552    2           CALL SYS_FUNC_CLOS;
      815     9553    2           CALL SYS_FUNC_RELDCB;
      816     9554    2           GOTO EXIT_RTN;
      817     9555    2       CASE(#UNDO2); /* ROLL BACK */
      818     9556    2           FPT_PFIL.V.DCB#=JRNL_DCB#;
      819     9557    2           CALL M$PFIL(FPT_PFIL);
      820     9558    3           DO III=1 TO JRNL_CNT;
      821     9559    3               CALL JRNL_READ ALTRET(QUIT_UNDO);
      822     9560    3               CALL WRITE_A_PAGE ALTRET(QUIT_UNDO);
      823     9561    3               END;
      824     9562    2           CALL CONV_DBK(JRNL_CNT,DBK_CUR,V1);
      825     9563    2           CALL CONCAT(BUF,'@    Number of updated pages recovered: ',
      826     9564    2              DBK_CUR);
      827     9565    2           CALL WRITE_A_LINE;
      828     9566    2   QUIT_UNDO: DCBSF=JRNL_DCB#;
      829     9567    2           CALL SYS_FUNC_RELEASE;
      830     9568    2           GOTO RE_START;
      831     9569    2       CASE(#HELP2);
      832     9570    2           CALL WRITE_A_LINE('A  The available commands are %');
      833     9571    2           CALL WRITE_A_LINE('A      DISP,WALK,LINK,UNDO,COMMIT,END and QUIT.%');
      834     9572    2           CALL WRITE_A_LINE(
              9572                    '@  To get more info, enter "HELP REPAIR" in directive entry.%');
      835     9573        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:27   
      836     9574    2       CASE(#LINK2,#LYNX2);
      837     9575    2           IF K_CNT=-1 THEN
      838     9576    2               CALL GET_CMD(DBK_DASH_NODE,'@  DBKEY TO PATCH:') ALTRET(NEXT_CMD);
      839     9577    2           IF N_OR_P=0 THEN
      840     9578    2               CALL GET_CMD(NOP_NODE,'@  PRIOR/OWNER/NEXT:') ALTRET(NEXT_CMD);
      841     9579    2           IF S_CNT=-1 AND SC_SIZ>0 THEN
      842     9580    2               CALL GET_CMD(SET_NODE,'@  SET-NAME:') ALTRET(NEXT_CMD);
      843     9581    2           ELSE
      844     9582    2               IF S_CNT=-1 THEN
      845     9583    2                   CALL MOVE_SET_NAME; /* USE DEFAULT SET NAME */
      846     9584    2           CALL VERIFY_SETS ALTRET(NEXT_CMD);
      847     9585    2           IF K_CNT=0 OR (K_CNT=1 AND DASH_ON=1) THEN
      848     9586    2               CALL GET_CMD(DBK_NODE,'@  NEW POINTER:') ALTRET(NEXT_CMD);
      849     9587    2           IF III>1 THEN
      850     9588    2               CALL WRITE_A_LINE('A%');
      851     9589    2           CALL CHK_SET ALTRET(NEXT_CMD);
      852     9590    2           IF PA_DBK.FIR(0)>0 AND PA_DBK.FIR(K_CNT)>0 THEN GOTO TWO_PA;
      853     9591    2           IF K_CNT=2 AND N_OR_P~=#OWNER2 THEN GOTO NOT_AUTO_OWNER;
      854     9592    2           CALL FINDBKEY ALTRET(NEXT_CMD);
      855     9593    2           CALL GET_POINTERS(0,0,RC_TYP1) ALTRET(NEXT_CMD);
      856     9594    2           IF N_OR_P=#OWNER2 AND SET_HDR.OWNER=' ' THEN GOTO NO_OWNER_PTR;
      857     9595    2           IF FUNC_CODE=#LYNX2 THEN /* SPECIAL LINK COMMAND */
      858     9596    3           DO; /* FOR DEVELOPMEMT USE */
      859     9597    3               IF RC_TYP1=%PA_ENT THEN
      860     9598    3                   N_OR_P=3+#NEXT2; /* LINK PA POINTER */
      861     9599    3               CALL PATCH_IT(N_OR_P,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);
      862     9600    3               GOTO NEXT_CMD; /* BYPASS ALL ERROR CHECKING */
      863     9601    3               END;
      864     9602    2           IF RC_TYP1=%MEMBER AND KEY_RNG.FIR(0)=KEY_RNG.FIR(K_CNT) THEN
      865     9603    2               GOTO MEM_TO_ITSELF;
      866     9604    2           KKK=KEY_RNG.FIR(0);
      867     9605    2           KEY_RNG.FIR(0)=KEY_RNG.FIR(K_CNT);
      868     9606    2           CALL FINDBKEY ALTRET(NEXT_CMD);
      869     9607    2           CALL GET_POINTERS(K_CNT,0,RC_TYP2) ALTRET(NEXT_CMD);
      870     9608    2           IF RC_TYP1=%OWNER AND RC_TYP2=%OWNER AND
      871     9609    2              KKK~=KEY_RNG.FIR(K_CNT) THEN GOTO TWO_OWNERS;
      872     9610    2           IF N_OR_P=#OWNER2 AND (RC_TYP2=%MEMBER OR RC_TYP2=%PA_MEM) THEN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:28   
      873     9611    2               GOTO BAD_OWNER;
      874     9612    2           IF MSTR_REF.SET.PATYPE(MSTR_INDX)='1'B THEN
      875     9613    3           DO;
      876     9614    4               DO III=0 TO 11;
      877     9615    4                   IF PA_LINK(III)=RC_TYP1+RC_TYP2 AND
      878     9616    4                      (N_OR_P=PA_LINK(III+1) OR PA_LINK(III+1)=0) THEN
      879     9617    4                       III=999;
      880     9618    4                   III=III+1;
      881     9619    4                   END;
      882     9620    3               IF III<999 THEN GOTO ILLEGAL_PA_LINK;
      883     9621    3               IF RC_TYP2=%PA_ENT THEN
      884     9622    3                   CALL PATCH_IT(#NEXT2+3,KKK) ALTRET(NEXT_CMD);
      885     9623    3               ELSE
      886     9624    3                   IF RC_TYP2=%PA_MEM AND RC_TYP1=%PA_ENT THEN
      887     9625    3                       CALL PATCH_IT(#NEXT2,KKK) ALTRET(NEXT_CMD);
      888     9626    3                   ELSE
      889     9627    3                       IF RC_TYP1=%PA_ENT THEN
      890     9628    3                           CALL PATCH_IT(#OWNER2,KKK) ALTRET(NEXT_CMD);
      891     9629    3               END;
      892     9630    2           IF PA_DBK.FIR(0)=0 AND PA_DBK.FIR(K_CNT)=0 THEN
      893     9631    3           DO;
      894     9632    3               IF N_OR_P=#NEXT2 THEN
      895     9633    3                   CALL PATCH_IT(#PRIOR2,KKK) ALTRET(NEXT_CMD);
      896     9634    3               ELSE
      897     9635    3                   IF N_OR_P=#PRIOR2 THEN
      898     9636    3                       CALL PATCH_IT(#NEXT2,KKK) ALTRET(NEXT_CMD);
      899     9637    3               END;
      900     9638    2           KEY_RNG.FIR(0)=KKK;
      901     9639    2   AUTO_OWNER: /* AUTO OWNER POINTER PATCH */
      902     9640    2           CALL FINDBKEY ALTRET(BAD_LINK);
      903     9641    2           CALL GET_POINTERS(0,0,RC_TYP1) ALTRET(BAD_LINK);
      904     9642    2           IF RC_TYP1 = %OWNER AND DASH_ON = 1 THEN
      905     9643    2               GOTO NEXT_MEMBER;
      906     9644    2           IF PA_DBK.FIR(0)=0 AND PA_DBK.SEC(0)=0 THEN
      907     9645    2               CALL PATCH_IT(N_OR_P,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);
      908     9646    2           ELSE
      909     9647    3           DO;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:29   
      910     9648    3               IF RC_TYP1=%PA_ENT THEN
      911     9649    3                   CALL PATCH_IT(3+#NEXT2,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);
      912     9650    3               ELSE
      913     9651    3                   IF RC_TYP1=%PA_MEM THEN
      914     9652    3                       CALL PATCH_IT(#NEXT2,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);
      915     9653    3                   ELSE
      916     9654    3                       CALL PATCH_IT(#OWNER2,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);
      917     9655    3               END;
      918     9656    2   NEXT_MEMBER:
      919     9657    2           KEY_RNG.FIR(0)=N_K;
      920     9658    2           IF DASH_ON=1 AND N_K~=KKK AND KEY_RNG.FIR(0)~=KEY_RNG.FIR(1) AND BREAK_FLAG=
              9658                    0 THEN
      921     9659    2               GOTO AUTO_OWNER; /* REPAIR OWNER POINTERS */
      922     9660    2   BAD_LINK:
      923     9661    2           IF DASH_ON=1 THEN
      924     9662    3           DO;
      925     9663    3               CALL CONV_DBK(WALK_CNT,DBK_CUR,V1);
      926     9664    3               CALL CONV_DBK(OWNER_CNT,PA_POINTER,V2);
      927     9665    3               CALL CONCAT(BUF,'a    ',ADDR(DBK_CUR)->DBK_V,
      928     9666    3                  ' OWNER pointers patched and ',
      929     9667    3                  ADDR(PA_POINTER)->REC_V,' unchanged');
      930     9668    3               CALL WRITE_A_LINE;
      931     9669    3               END;
      932     9670    2           GOTO NEXT_CMD;
      933     9671    2   TWO_PA:
      934     9672    2           CALL WRITE_A_LINE('@   No linkage between PA entries%');
      935     9673    2           GOTO NEXT_CMD;
      936     9674    2   NO_OWNER_PTR:
      937     9675    2           CALL CONCAT(BUF,'@   ',DBK_REC,' has no OWNER pointer in set ',
      938     9676    2              ITEM_LIST.NAME(0));
      939     9677    2           GOTO ALT_LINK;
      940     9678    2   NOT_AUTO_OWNER:
      941     9679    2           CALL WRITE_A_LINE('@   Auto repair for OWNER pointers only%');
      942     9680    2           GOTO NEXT_CMD;
      943     9681    2   TWO_OWNERS:
      944     9682    2           CALL WRITE_A_LINE('@   Cannot link two owners for you%');
      945     9683    2           GOTO NEXT_CMD;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:30   
      946     9684    2   MEM_TO_ITSELF:
      947     9685    2           CALL CONCAT(BUF,'@   Member record ',DBK_REC,' cannot be linked to itself');
      948     9686    2           GOTO ALT_LINK;
      949     9687    2   BAD_OWNER:
      950     9688    2           CALL CONCAT(BUF,'@   ',DBK_REC,' is not an owner in set ',
      951     9689    2              ITEM_LIST.NAME(0));
      952     9690    2           GOTO ALT_LINK;
      953     9691    2   ILLEGAL_PA_LINK:
      954     9692    2           CALL WRITE_A_LINE('A   This type of link is not legal in a PA set%');
      955     9693    2           CALL WRITE_A_LINE('@   Please check and retry%');
      956     9694    2           GOTO NEXT_CMD;
      957     9695    2   ALT_LINK:
      958     9696    2           CALL WRITE_A_LINE;
      959     9697    2       CASE(#DELETE2); /* REMOVE A RECORD */
      960     9698        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:31   
      961     9699    2       CASE(#CHKPNT2); /* CHECK POINT */
      962     9700    2           CALL CONV_DBK(JRNL_CNT,DBK_CUR,V1);
      963     9701    2           CALL CONCAT(BUF,'@    Number of updated pages committed: ',
      964     9702    2              DBK_CUR);
      965     9703    2           JRNL_CNT=0;
      966     9704    2           DCBSF=JRNL_DCB#;
      967     9705    2           CALL SYS_FUNC_CLOS;
      968     9706    2           CALL WRITE_A_LINE;
      969     9707    2           GOTO RE_START;
      970     9708        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:32   
      971     9709    2       CASE(#WALK2); /* WALK A SET */
      972     9710    2           IF K_CNT=-1 THEN
      973     9711    2               CALL GET_CMD(DBK_NODE,'@  DBKEY TO START:') ALTRET(NEXT_CMD);
      974     9712    2           IF N_OR_P=0 THEN
      975     9713    2               CALL GET_CMD(N_OR_P_NODE,'@  NEXT/PRIOR:') ALTRET(NEXT_CMD);
      976     9714    2           IF S_CNT=-1 AND SC_SIZ>0 THEN
      977     9715    2               CALL GET_CMD(SET_NODE,'@  SET TO WALK: ') ALTRET(NEXT_CMD);
      978     9716    2           ELSE
      979     9717    2               IF S_CNT=-1 THEN
      980     9718    2                   CALL MOVE_SET_NAME;
      981     9719    2           CALL VERIFY_SETS ALTRET(NEXT_CMD);
      982     9720    2           IF K_CNT=0 AND III>=3 THEN
      983     9721    2               CALL GET_CMD(DBK_LIST_NODE,'@  DBKEYs TO STOP:') ALTRET(NEXT_CMD);
      984     9722    2           K_CNT=K_CNT+1; /* FORCE TO STOP AT STARTING DBK */
      985     9723    2           KEY_RNG.FIR(K_CNT)=KEY_RNG.FIR(0);
      986     9724    2           PA_DBK.FIR(0)=0; /* IGNORE PA ENTRY NUMBER */
      987     9725    2           IF WALK_OPT=1 AND R_CNT=-1 AND III<3 THEN
      988     9726    2               WALK_OPT=#ALL2; /* DEFAULT WALK OPTION ALL */
      989     9727    2           IF WALK_OPT=1 AND R_CNT=-1 THEN
      990     9728    2               CALL GET_CMD(WALK_OPT_NODE,
      991     9729    2                  '@  TRACE(ALL/OWNER/MEMBER/RECORD-LIST):') ALTRET(NEXT_CMD);
      992     9730    2           IF III>1 THEN CALL WRITE_A_LINE('A%');
      993     9731    2           KCNT_SAVE = K_CNT; /* TO TELL STOP BY DEFAULT OR NOT */
      994     9732    2           TRACE_CNT=0;
      995     9733    2           OWNER_KEY=-1;
      996     9734    2           C_POS=255;
      997     9735    2           BAD_FLAG=0;
      998     9736    2           ADD_FLAG=0;
      999     9737    2           PRIOR_KEY=KEY_RNG.FIR(0);
     1000     9738    2   KEEP_WALKING:
     1001     9739    2           CALL FINDBKEY ALTRET(ABN_WALK);
     1002     9740    2           CALL GET_POINTERS(0,0,RC_TYP1) ALTRET(ABN_WALK);
     1003     9741    2           CURRENT_KEY=KEY_RNG.FIR(0);
     1004     9742    2           IF N_OR_P=#NEXT2 THEN
     1005     9743    2               KEY_RNG.FIR(0)=N_K; /* FOLLOW NEXT POINTER */
     1006     9744    2           ELSE
     1007     9745    2               KEY_RNG.FIR(0)=P_K; /* ELSE PRIOR POINTER */
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:33   
     1008     9746    2           IF WALK_CNT=0 THEN
     1009     9747    3           DO;
     1010     9748    3               CALL CONCAT(BUF,'A  Starts at ',DBK_REC);
     1011     9749    3               CALL WRITE_A_LINE;
     1012     9750    3               IF RC_TYP1 = %PA_MEM THEN
     1013     9751    4               DO;
     1014     9752    4                   CALL WRITE_A_LINE('@  Stops at any PA member%');
     1015     9753    4                   GOTO NEXT_CMD;
     1016     9754    4                   END;
     1017     9755    3               IF RC_TYP1 = %OWNER THEN
     1018     9756    3                   OWNER_KEY = CURRENT_KEY;
     1019     9757    3               ELSE
     1020     9758    3                   OWNER_KEY = O_K;
     1021     9759    3               GOTO ADD_CNT;
     1022     9760    3               END;
     1023     9761    2           IF RC_TYP1=%OWNER THEN
     1024     9762    2               O_K = CURRENT_KEY; /* USE DBK AS OWNER'S OWNER PTR */
     1025     9763    2           IF O_K ~= OWNER_KEY THEN /* BAD OWNER PTR FOUND */
     1026     9764    2               BAD_FLAG=1;
     1027     9765    2           IF (N_OR_P=#NEXT2 AND PRIOR_KEY~=P_K) OR
     1028     9766    2              (N_OR_P=#PRIOR2 AND PRIOR_KEY~=N_K) THEN
     1029     9767    2               CALL TRACE_OUT(2); /* BAD BACKWARD PTR */
     1030     9768    2           ELSE
     1031     9769    2               IF WALK_OPT=#ALL2 OR
     1032     9770    2                  (WALK_OPT=#OWNER2 AND RC_TYP1=%OWNER) OR
     1033     9771    2                  (WALK_OPT=#MEMBER2 AND RC_TYP1~=%OWNER) THEN
     1034     9772    2                   CALL TRACE_OUT(0);
     1035     9773    2               ELSE
     1036     9774    3               DO III=0 TO R_CNT;
     1037     9775    3                   IF RECORD_LIST.NAME(III)=REC_HDR.REC_NM THEN
     1038     9776    3                       CALL TRACE_OUT(0);
     1039     9777    3                   END;
     1040     9778    3           DO III=1 TO K_CNT;
     1041     9779    3               IF CURRENT_KEY=KEY_RNG.FIR(III) THEN
     1042     9780    3                   GOTO STOP_WALKING;
     1043     9781    3               END;
     1044     9782    2   ADD_CNT:
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:34   
     1045     9783    2           IF RC_TYP1 = %OWNER THEN
     1046     9784    2               OWNER_CNT = OWNER_CNT + 1;
     1047     9785    2           WALK_CNT=WALK_CNT+1;
     1048     9786    2           PRIOR_KEY=CURRENT_KEY;
     1049     9787    2           IF ADD_FLAG = 1 THEN /* ADD A DEFAULT STOP DBK */
     1050     9788    3           DO;
     1051     9789    3               IF K_CNT < 19 THEN K_CNT = K_CNT + 1;
     1052     9790    3               KEY_RNG.FIR(K_CNT) = CURRENT_KEY; /* ADD TO LIST */
     1053     9791    3               ADD_FLAG = 0; /* RESET THE ADD FLAG */
     1054     9792    3               END;
     1055     9793    2           IF BREAK_FLAG>0 THEN GOTO STOP_BY_BREAK;
     1056     9794    2           GOTO KEEP_WALKING;
     1057     9795    2   ABN_WALK:
     1058     9796    2           CALL CONV_DBK(PRIOR_KEY,DBK_CUR,V1);
     1059     9797    2           CALL CONCAT(BUF,'b  Unable to proceed from DBKEY ',DBK_CUR);
     1060     9798    2           GOTO WALK_SUMMARY;
     1061     9799    2   STOP_WALKING:
     1062     9800    2           IF III >= KCNT_SAVE THEN
     1063     9801    3           DO;
     1064     9802    3               CALL CONCAT(RBUF,DBK_REC,' before looping');
     1065     9803    3               DBK_REC_SIZE = DBK_REC_SIZE + 20;
     1066     9804    3               END;
     1067     9805    2   STOP_BY_BREAK:
     1068     9806    2           CALL CONCAT(BUF,'b  Stops at ',DBK_REC);
     1069     9807    2           IF CURRENT_KEY~=KEY_RNG.FIR(K_CNT) THEN
     1070     9808    2               WALK_CNT=WALK_CNT+1;
     1071     9809    2   WALK_SUMMARY:
     1072     9810    2           CALL WRITE_A_LINE;
     1073     9811    2           CALL CONV_DBK(WALK_CNT,DBK_CUR,V1);
     1074     9812    2           CALL CONCAT(BUF,'a  ',ADDR(DBK_CUR)->DBK_V,' records walked');
     1075     9813    2           CALL WRITE_A_LINE;
     1076     9814    2           IF OWNER_CNT > 1 THEN
     1077     9815    2               CALL WRITE_A_LINE('@ with more than one owners found%');
     1078     9816    2           ELSE
     1079     9817    2               IF BAD_FLAG=1 AND ITEM_LIST.NAME(0)~='*CALC' THEN
     1080     9818    2                   CALL WRITE_A_LINE('@ with bad owner pointers detected%');
     1081     9819        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:35   
     1082     9820    2       CASE(#DISP2); /* PRINT DBK */
     1083     9821    2           IF K_CNT>=0 AND PRINT_OPT=0 AND S_CNT=-1 THEN
     1084     9822    2               CALL MOVE_SET_NAME;
     1085     9823    2           IF K_CNT = -1 THEN
     1086     9824    2               CALL GET_CMD(DBK_LIST_NODE,'@  DBKEY TO PRINT:') ALTRET(NEXT_CMD);
     1087     9825    2           IF PRINT_OPT=0 AND S_CNT=-1 THEN /* PRINT OPTION MISSING */
     1088     9826    2               CALL GET_CMD(DISP_OPT_NODE,'@  SETS/ALL/SET_LIST:') ALTRET(NEXT_CMD);
     1089     9827    2           CALL VERIFY_SETS ALTRET(NEXT_CMD);
     1090     9828    2           IF PRINT_OPT=#SETS2 THEN
     1091     9829    2               CALL MOVE_SET_NAME;
     1092     9830    2           IF III>1 THEN CALL WRITE_A_LINE('A%');
     1093     9831    2           IF PRINT_OPT=#ALL2 THEN
     1094     9832    3           DO;
     1095     9833    3               ZI$DIR.PITEM='1'B; /* PRINT ITEM BITS ON */
     1096     9834    3               ZI$DIR.PCALC='1'B; /* PRINT CALC HEADER BIT ON */
     1097     9835    3               SXCNT=-1;
     1098     9836    4               DO III=0 TO K_CNT;
     1099     9837    4                   KEY_RNG.FIR(0)=KEY_RNG.FIR(III);
     1100     9838    4                   CALL FINDBKEY;
     1101     9839    4                   IF BREAK_FLAG>0 THEN GOTO NEXT_CMD;
     1102     9840    4                   END;
     1103     9841    3               ZI$DIR.PCALC = '0'B; /* TURN IT OFF */
     1104     9842    3               GOTO NEXT_CMD;
     1105     9843    3               END;
     1106     9844    3           DO JJJ=0 TO K_CNT;
     1107     9845    3               KEY_RNG.FIR(0)=KEY_RNG.FIR(JJJ);
     1108     9846    3               CALL FINDBKEY ALTRET(NEXT_DBKEY);
     1109     9847    3               IF JJJ>0 THEN CALL WRITE_A_LINE('B%');
     1110     9848    4               DO III=0 TO S_CNT;
     1111     9849    4                   CALL GET_POINTERS(JJJ,III,RC_TYP1) ALTRET(NEXT_SET);
     1112     9850    4                   CALL CONCAT(BUF,'@  ',DBK_REC,'  ',ITEM_LIST.NAME(III));
     1113     9851    4                   IF DBK_REC=' ' THEN
     1114     9852    4                       ADDR(BUF)->CHAR1='a'; /* PRINT NEXT SET */
     1115     9853    4                   CALL WRITE_A_LINE;
     1116     9854    4                   IF RC_TYP1=%PA_ENT THEN /* WITH AN EXTRA PA PTR */
     1117     9855    4                       CALL CONCAT(SC_MSG3.MEMBER,', ',
     1118     9856    4                          ADDR(SET_HDR.NEXT)->DBN_V,', ',PA_POINTER);
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:36   
     1119     9857    4                   ELSE
     1120     9858    4                       CALL CONCAT(SC_MSG3.MEMBER,', ',SET_HDR.NEXT);
     1121     9859    4                   CALL CONCAT(BUF,'@  ',ADDR(SET_HDR.PRIOR)->DBP_V,
     1122     9860    4                      ', ',ADDR(SET_HDR.OWNER)->DBO_V,SC_MSG3.MEMBER);
     1123     9861    4                   CALL WRITE_A_LINE;
     1124     9862    4                   DBK_REC=' ';
     1125     9863    4                   REC_INDX=-1; /* INDICATES DBK IS CORRECT */
     1126     9864    4   NEXT_SET:       IF REC_INDX>=0 THEN GOTO NEXT_DBKEY; /* BAD DBK */
     1127     9865    4                   END;
     1128     9866    3               CALL CONCAT(BUF,'@  ',DBK_REC);
     1129     9867    3               IF DBK_REC~=' ' THEN
     1130     9868    3                   CALL WRITE_A_LINE;
     1131     9869    3   NEXT_DBKEY:
     1132     9870    3               IF BREAK_FLAG>0 THEN GOTO NEXT_CMD;
     1133     9871    3               END;
     1134     9872    2           END;
     1135     9873    1       GOTO NEXT_CMD;
     1136     9874
     1137     9875    1   EXIT_RTN:
     1138     9876    1       FPT_TRMPRG.V.CTLFLG.PURGEOUTPUT#=%YES#;
     1139     9877    1   END ZIU$Q2RP;
     1140     9878        %EOD;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:37   
--  Include file information  --

   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI_RVA_C.:ZIC0TOU  is referenced.
   ZI_UWA_C.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   XU_PERR_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$Q2RP.

   Procedure ZIU$Q2RP requires 2921 words for executable code.
   Procedure ZIU$Q2RP requires 204 words of local(AUTO) storage.

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:38   

 Object Unit name= ZIU$Q2RP                                   File name= ZIU$Q2RP.:ZIC0TOU
 UTS= SEP 05 '97 13:24:43.80 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none  1260   2354  ZIU$Q2RP
    1  RoData even  UTS    506    772  ZIU$Q2RP
    2   DCB   even  none     0      0  M$LO
    3   DCB   even  none     0      0  M$UC
    4   DCB   even  none     0      0  M$SI
    5   Proc  even  none  2921   5551  ZIU$Q2RP
    6  RoData even  none   153    231  ZIU$Q2RP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        0  ZIU$Q2RP

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0   2004  JJJ                                0   2005  KKK
    0   2115  PRINT_OPT                          0   2116  WALK_OPT
    0   2117  R_CNT                              0   2120  S_CNT
    0   2121  K_CNT                              0   2123  DASH_ON
    0   2131  N_OR_P                             0   2132  PA_DBK
    0   2336  PCB
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:39   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 BUILD_MSTR_TBL
         yes           Std       2 FIND_MSTR_ENTRY
 yes     yes           Std       0 SYS_FUNC_RELDCB
 yes     yes           Std       0 BUILD_SETXREF
 yes     yes           Std       2 SYS_FUNC_CORRES
 yes     yes           Std       0 SYS_FUNC_CLOS
 yes     yes           Std       0 BUILD_RECXREF
 yes     yes           Std       1 GET_NXT_AC
 yes     yes           Std       1 GET_DCB
 yes     yes           Std       0 SYS_FUNC_WRIT
 yes     yes           Std       0 SYS_FUNC_RELEASE
 yes     yes           Std       0 ZIU$Q2PR3
 yes     yes           Std       0 ZIU$Q2PR2
 yes     yes           Std       0 ZIU$Q2PR1
 yes     yes           Std       0 SYS_FUNC_READ
 yes     yes           Std       1 CHK_NODE
 yes     yes           Std       1 X$PARSE
         yes           Std       3 ZERO_SUP
 yes     yes           Std       0 SYS_FUNC_ERRMSG
         yes           Std       0 CHKSUM
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:40   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RBUF                                  CURR_SCHNM                            SET_HDR
     REC_HDR                               SET$                                  CHK_SUM
     PRINT_HDR                             REP_SUB_CMD                           DBK_NODE
     DBK_DASH_NODE                         DBK_LIST_NODE                         DISP_OPT_NODE
     SET_LIST_NODE                         SET_NODE                              WALK_OPT_NODE
     N_OR_P_NODE                           NOP_NODE                              LAST_DBK
     CURR_REC                              ENTRY$                                GROUP$
     PTR_SIZE                              KEY_SIZE                              KEY_PTR_SIZE
     CRPT_NODE                             TYPE                                  MSTR$
     NXT_MSLOT                             MAX_MSLOT                             MSTR_INDX
     HASHTBL                               HASHINDX                              LOC_MODE
     AREA_KEY$                             NO_AREAS                              GLBL_PTR_SZ
     SET_XREF$                             NXT_SSLOT                             MAX_SSLOT
     REC_XREF$                             NXT_RSLOT                             MAX_RSLOT
     NO_RECS                               NO_SETS                               XREF_BUILT
     TYPESET                               TYPEREC                               REC$
     RB                                    RE                                    IE
     IB                                    CNT                                   ICNT
     RCNT                                  SCNT                                  FIRST_SET
     RETCNT                                DMPCNT                                KCNT
     ACNT_IDX                              I                                     J
     K                                     X                                     STEPCC
     I_O_BUF$                              OUT_INDX                              I_O_SIZE
     REC_DATA_LN                           M$LO                                  B$TCB$
     B$ROS$                                B$JIT$                                KEYFID
     I_O_KEY                               RESTART                               BREAK_FLAG
     ICHKSUM                               ITMCNT                                GAP1
     BLKLSF                                KEYLSF                                KEYXSF
     DCBSF                                 ORGSF                                 KEYSF
     KEYVSF                                ACSSF                                 NOTIMESF
     FUNSF                                 ASNSF                                 TESTSF
     XTENSIZESF                            DISPSF                                WAITSF
     VFCSF                                 FULLSF                                BKUPSF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:41   
     BUFLNSF                               BUFSF                                 SOURCESF
     DESTSF                                DATESF                                TIMESF
     UTSSF                                 DAYSF                                 TSTAMPSF
     ENCRP_SEEDSF                          ERRCODESF                             MSGCODE
     INCL_ERR                              ERR_INSERT                            FIDSF_RD
     ACNT                                  EXISTSF                               SHARESF
     DCBNMSF                               KEYRSF                                NO_KEYSF
     REASGNSF                              CARRY_ATTRIBUTESF                     SUBMESSF
     SPKY_OPNSF                            POSSF                                 ERRFLGSF
     MERGESF                               FSA_FLAG                              RELGSF
     UNUSED                                HELPCODE                              COUNTSF
     INDEXSF                               GAP                                   PSNSF
     ACNTSF                                KEY_SHADWSF                           M$UC
     FPT_TRMPRG                            ZI$DIR                                SCHEMA_ACTIVE
     RECORD_LIST                           SET_LIST                              RETAIN_LIST
     DUMP_FID                              ALTKY                                 INIT_RG
     KEY_RNG                               ITEM_LIST                             UWA
     CAN_RVA                               DATA$                                 M$SI

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:42   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZIU$Q2RP: PROC ALTRET;

      6  5 000000   000000 700200 xent  ZIU$Q2RP     TSX0  ! X66_AUTO_0
         5 000001   000314 000000                    ZERO    204,0
         5 000002   002704 710000 5                  TRA     s:9439

        7        7
        8        8    1   DCL RBUF CHAR(256) SYMREF ALIGNED;
        9        9    1   DCL 1 CURR_SCHNM CHAR(30) ALIGNED SYMREF;
       10       10    1   DCL 1 SET_HDR ALIGNED SYMREF,
       11       11    1         2 CAR_CON BIT(9) UNAL,
       12       12    1         2 * CHAR(5) UNAL,
       13       13    1         2 NAME CHAR(30) UNAL,
       14       14    1         2 * CHAR(1) UNAL,
       15       15    1         2 ORDER CHAR(6) UNAL,
       16       16    1         2 PRIOR CHAR(10) UNAL,
       17       17    1         2 * CHAR(2) UNAL,
       18       18    1         2 OWNER CHAR(10) UNAL,
       19       19    1         2 * CHAR(2) UNAL,
       20       20    1         2 NEXT CHAR(10) UNAL,
       21       21    1         2 * CHAR(1) UNAL,
       22       22    1         2 GLO_LOC CHAR(6) UNAL,
       23       23    1         2 SET_TYPE CHAR(5) UNAL;
       24       24
       25       25    1   DCL 1 REC_HDR ALIGNED SYMREF, /* CKL */
       26       26    1         2 CAR_CON BIT(9) UNAL,
       27       27    1         2 REC_NM CHAR(25) UNAL;
       28       28    1   DCL SET$ PTR SYMREF;
       29       29    1   DCL SXCNT SBIN STATIC;
       30       30    1   DCL CHK_SUM BIT(1) SYMREF;
       31       31    1   DCL 1 PRINT_HDR BIT(1) UNAL SYMREF;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:43   
       32       32
       33       33    1   DCL SC_SIZ SBIN STATIC;
       34       34    1   DCL SET_NAMES(0:19) CHAR(30) UNAL;
       35       35
       36       36    1   DCL REP_SUB_CMD UBIN SYMREF;
       37       37    1   DCL DBK_NODE UBIN SYMREF;
       38       38    1   DCL DBK_DASH_NODE UBIN SYMREF;
       39       39    1   DCL DBK_LIST_NODE UBIN SYMREF;
       40       40    1   DCL DISP_OPT_NODE UBIN SYMREF;
       41       41    1   DCL SET_LIST_NODE UBIN SYMREF;
       42       42    1   DCL SET_NODE UBIN SYMREF;
       43       43    1   DCL WALK_OPT_NODE UBIN SYMREF;
       44       44    1   DCL N_OR_P_NODE UBIN SYMREF;
       45       45    1   DCL NOP_NODE UBIN SYMREF;
       46       46    1   DCL LAST_DBK SBIN WORD SYMREF;
       47       47
       48       48    1   DCL ENT_ADDR EPTR STATIC;
       49       49    1   DCL WK(0:1023) SBIN STATIC ALIGNED;
       50       50    1   DCL III SBIN STATIC;
       51       51    1   DCL JJJ SBIN STATIC SYMDEF;
       52       52    1   DCL KKK SBIN STATIC SYMDEF;
       53       53    1   DCL V1 UBIN STATIC;
       54       54    1   DCL V2 UBIN STATIC;
       55       55    1   DCL V3 UBIN STATIC;
       56       56    1   DCL V4 UBIN STATIC;
       57       57    1   DCL V5 UBIN STATIC;
       58       58    1   DCL V6 UBIN STATIC;
       59       59    1   DCL N_K UBIN STATIC;
       60       60    1   DCL P_K UBIN STATIC;
       61       61    1   DCL O_K UBIN STATIC;
       62       62    1   DCL CURR_REC SBIN SYMREF; /* THE INDX IN MSTR_REF OF CURRENT REC */
       63       63    1   DCL REC_INDX SBIN STATIC;
       64       64    1   DCL DBK_V CHAR(V1) BASED;
       65       65    1   DCL REC_V CHAR(V2) BASED;
       66       66    1   DCL DBP_V CHAR(V3) BASED;
       67       67    1   DCL DBO_V CHAR(V4) BASED;
       68       68    1   DCL DBN_V CHAR(V5) BASED;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:44   
       69       69    1   DCL REC_TYPE SBIN(18) STATIC ALIGNED;
       70       70    1   DCL RC_IN_PA SBIN(18) BASED(SET$) CALIGNED; /* FOR RC TYPE IN PA PTR */
       71       71    1   DCL CHAR1 CHAR(1) BASED;
       72       72    1   DCL C_POS UBIN STATIC;
       73       73    1   DCL DBK_REC_SIZE UBIN STATIC;
       74       74    1   DCL DBK_REC$ PTR STATIC INIT(ADDR(RBUF));
       75       75    1   DCL SET_PA$ PTR STATIC;
       76       76    1   DCL DBK_REC CHAR(DBK_REC_SIZE) BASED(DBK_REC$);
       77       77    1   DCL PROMPT_CHAR CHAR(1) STATIC INIT(' ');
       78       78    1   DCL JRNL_CNT UBIN STATIC;
       79       79    1   DCL JRNL_DCB# UBIN STATIC;
       80       80    1   DCL WALK_CNT UBIN STATIC;
       81       81    1   DCL TRACE_CNT UBIN STATIC;
       82       82    1   DCL CHAR4 CHAR(4) STATIC;
       83       83    1   DCL PTR_V CHAR(PTR_SIZE) BASED;
       84       84    1   DCL PA_POINTER CHAR(10) STATIC;
       85       85    1   DCL 1 PA_REC BASED(REC$) CALIGNED,
       86       86    1         2 * UBIN(6) UNAL,
       87       87    1         2 TYPE UBIN(12) UNAL,
       88       88    1         2 SIZE UBIN(18) UNAL,
       89       89    1         2 FLAGS(0:5) UBIN(1) UNAL,
       90       90    1         2 ENTRIES UBIN(12) UNAL,
       91       91    1         2 AVAIL UBIN(18) UNAL;
       92       92    1   DCL 1 PA_ENTRY BASED(ENTRY$) UNAL,
       93       93    1         2 C UBIN(1) UNAL,
       94       94    1         2 * UBIN(5) UNAL,
       95       95    1         2 TYPE UBIN(12) UNAL,
       96       96    1         2 PTRS CHAR(PTR_SIZE) UNAL;
       97       97    1   DCL 1 PA_GROUP BASED(GROUP$) UNAL,
       98       98    1         2 NO_GROUPS UBIN HALF UNAL,
       99       99    1         2 TYPE UBIN(18) UNAL,
      100      100    1         2 PTRS CHAR(PTR_SIZE) UNAL;
      101      101    1   DCL ENTRY$ PTR SYMREF;
      102      102    1   DCL GROUP$ PTR SYMREF;
      103      103    1   DCL PTR_SIZE UBIN SYMREF;
      104      104    1   DCL KEY_SIZE UBIN SYMREF;
      105      105    1   DCL KEY_PTR_SIZE UBIN SYMREF;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:45   
      106      106
      107      107        %EQU MEMBER=0;
      108      108        %EQU OWNER=1;
      109      109        %EQU PA_RC=4;
      110      110        %EQU PA_MEM=8;
      111      111        %EQU PA_ENT=16;
      112      112        %EQU O_RC=%OWNER+%PA_RC;
      113      113        %EQU RC_RC=%PA_RC+%PA_RC;
      114      114        %EQU E_RC=%PA_ENT+%PA_RC;
      115      115        %EQU E_M=%PA_ENT+%PA_MEM;
      116      116        %EQU O_M=%OWNER+%PA_MEM;
      117      117
      118      118        %EQU N=14;
      119      119        %EQU P=15;
      120      120        %EQU O=16;
      121      121    1   DCL PA_LINK(0:11) UBIN(9) UNAL CONSTANT INIT(
      122      122    1    %O_RC,0,%RC_RC,%N,%RC_RC,%P,%E_RC,%N,%E_M,%N,%O_M,%O);
      123      123
      124      124    1   DCL BUF CHAR(80) STATIC;
      125      125    1   DCL 1 BUF2 REDEF BUF,
      126      126    1         2 FIR CHAR(40) UNAL,
      127      127    1         2 SEC CHAR(40) UNAL;
      128      128
      129      129    1   DCL DBK_CUR CHAR(10) STATIC UNAL;
      130      130    1   DCL DBK_NEW CHAR(10) STATIC UNAL;
      131      131    1   DCL NOP_TEXT(0:3) CHAR(5) UNAL CONSTANT INIT(' NEXT','PRIOR','OWNER',' PA  ');
      132      132
      133      133    1   DCL AREA_INDX SBIN STATIC INIT(-1);
      134      134
      135      135    1   DCL 1 SC_MSG1 CONSTANT,
      136      136    1         2 * CHAR(6) UNAL INIT('A'),
      137      137    1         2 * CHAR(24) UNAL INIT('SET-NAME'),
      138      138    1         2 * CHAR(24) UNAL INIT('OWNER-RECORD'),
      139      139    1         2 * CHAR(26) UNAL INIT('MEMBER-RECORD');
      140      140    1   DCL 1 SC_MSG2 CONSTANT,
      141      141    1         2 * CHAR(6) UNAL INIT('@'),
      142      142    1         2 * CHAR(24) UNAL INIT('--------'),
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:46   
      143      143    1         2 * CHAR(24) UNAL INIT('------------'),
      144      144    1         2 * CHAR(26) UNAL INIT('-------------');
      145      145    1   DCL 1 SC_MSG3 STATIC,
      146      146    1         2 VFC CHAR(6) UNAL INIT('B'),
      147      147    1         2 SETNAME CHAR(24) UNAL INIT(' '),
      148      148    1         2 OWNER CHAR(24) UNAL INIT(' '),
      149      149    1         2 MEMBER CHAR(26) UNAL INIT(' ');
      150      150    1   DCL JRNL_KEY$ PTR CONSTANT INIT(ADDR(KEYVSF));
      151      151    1   DCL 1 JRNL_KEY ALIGNED BASED(JRNL_KEY$),
      152      152    1         2 L UBIN BYTE CALIGNED,
      153      153    1         2 MBZ UBIN BYTE CALIGNED,
      154      154    1         2 AREA_INDX UBIN HALF HALIGNED,
      155      155    1         2 PAGE_NO UBIN;
      156      156
      157      157    1   DCL PRINT_OPT UBIN BYTE STATIC SYMDEF ALIGNED;
      158      158    1   DCL WALK_OPT UBIN BYTE STATIC SYMDEF UNAL INIT(0);
      159      159    1   DCL R_CNT SBIN BYTE STATIC SYMDEF UNAL;
      160      160    1   DCL S_CNT SBIN BYTE STATIC SYMDEF UNAL;
      161      161    1   DCL K_CNT SBIN STATIC SYMDEF;
      162      162    1   DCL CRPT_NODE SBIN SYMREF;
      163      163    1   DCL OUTPUT_UC UBIN BYTE STATIC UNAL;
      164      164    1   DCL DASH_ON UBIN BYTE STATIC SYMDEF UNAL;
      165      165    1   DCL KCNT_SAVE SBIN BYTE STATIC UNAL;
      166      166    1   DCL ADD_FLAG SBIN BYTE STATIC UNAL;
      167      167    1   DCL FUNC_CODE UBIN BYTE STATIC UNAL;
      168      168    1   DCL RC_TYP1 UBIN STATIC;
      169      169    1   DCL RC_TYP2 UBIN STATIC;
      170      170    1   DCL N_OR_P UBIN STATIC SYMDEF;
      171      171    1   DCL 1 PA_DBK(0:19) STATIC SYMDEF,
      172      172    1         2 FIR SBIN,
      173      173    1         2 SEC SBIN;
      174      174    1   DCL NEXT_ENTRY SBIN BYTE STATIC UNAL;
      175      175    1   DCL AREA_ENCRPT(0:31) UBIN AUTO;
      176      176    1   DCL OWNER_KEY SBIN STATIC;
      177      177    1   DCL PRIOR_KEY UBIN STATIC;
      178      178    1   DCL OWNER_CNT UBIN STATIC;
      179      179    1   DCL BAD_FLAG UBIN STATIC;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:47   
      180      180    1   DCL CURRENT_KEY UBIN STATIC;
      181      181    1   DCL DCB_UC UBIN HALF CONSTANT INIT(DCBNUM(M$UC)) ALIGNED;
      182      182    1   DCL DCB_SI UBIN HALF CONSTANT INIT(DCBNUM(M$SI)) ALIGNED;
      183      183    1   DCL DCB_LO UBIN HALF CONSTANT INIT(DCBNUM(M$LO)) ALIGNED;
      184      184
      185      185    1   DCL FIND_MSTR_ENTRY ENTRY(2);
      186      186    1   DCL HASHENTRY ENTRY(2);
      187      187    1   DCL BUILD_MSTR_TBL ENTRY ALTRET;
      188      188    1   DCL BUILD_SETXREF ENTRY ALTRET;
      189      189    1   DCL BUILD_RECXREF ENTRY ALTRET;
      190      190
      191      191        %INCLUDE ZI_DBU_XREF; /* RC-SC XREF TABLES */
      192      358        %XREF_TBLS;
      193      433        %INCLUDE ZI_GLOBAL_DBUTIL;
      194      611        %MISC_DCLS;
      195      664        %SYS_FUNC;
      196      756
      197      757        %INCLUDE CP_6_SUBS;
      198     1297        %INCLUDE CP_6;
      199     1378        %INCLUDE B_ERRORS_C;
      200     2505        %B$EXCFR;
      201     2523        %B$TCB;
      202     2526        %F$DCB;
      203     2583
      204     2584        %VLP_VECTOR(FPTN=GDS_RESULT); /* USED FOR M$GDS */
      205     2599        %FPT_PFIL(BOF=YES);
      206     2614        %FPT_PROMPT(VFC=NO,DCB=M$UC,PROMPT=PROMPT_CHAR);
      207     2642        %FPT_WRITE(FPTN=FPT_JRNL,NEWKEY=YES,ONEWKEY=NO,VFC=NO,WAIT=YES,KEY=KEYVSF);
      208     2673        %FPT_TRMPRG(STCLASS=SYMREF);
      209     2702        %FPT_OPEN(FPTN=OPEN_JRNL,ACS=DIRECT,ASN=FILE,ORG=KEYED,
      210     2703         CTG=NO,EXIST=NEWFILE,DISP=SCRATCH,FUN=CREATE);
      211     2812
      212     2813        %INCLUDE XU_MACRO_C;
      213     5919        %INCLUDE XU_PERR_C;
      214     6110
      215     6111        %P_PCB(NAME=PCB,T=RBUF,W=WK,WSZ=1024);
      216     6310        %PARSE$OUT(NAME=OUT$BLK,STCLASS="BASED(PCB.OUT$)");
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:48   
      217     6355
      218     6356        %INCLUDE ZI$DIR;
      219     6513        %DIR;
      220     6657
      221     6658        %INCLUDE ZI_PRSE_SUBS; /* %SUB OF ZIU$PARSE2 */
      222     6814
      223     6815        %INCLUDE ZI_UWA_C;
      224     7505        %ZI$UWAB;
      225     7845
      226     7846        %INCLUDE ZI_RVA_C;
      227     8527        %CAN_RVA_REF;
      228     8846
      229     8847        %INCLUDE ZI$PG_STRUCTS;
      230     8950        %DATA_PG;
      231     8969
      232     8970    1   DCL M$SI DCB;
      233     8971    1   DCL CHKSUM ENTRY;
      234     8972    1   DCL CHK_NODE ENTRY(1) ALTRET;
      235     8973    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
      236     8974    1   DCL ZERO_SUP ENTRY(3);
      237     8975    1   DCL X$PARSE ENTRY(1) ALTRET;
      238     8976    1   DCL GET_DCB ENTRY(1) ALTRET;
      239     8977    1   DCL ZIU$Q2PR1 ENTRY ALTRET; /* TO Q2PR AT OPEN,READ,DOIT LEVEL */
      240     8978    1   DCL ZIU$Q2PR2 ENTRY ALTRET; /* TO Q2PR AT READ,DOIT LEVEL */
      241     8979    1   DCL ZIU$Q2PR3 ENTRY ALTRET; /* TO Q2PR AT DOIT LEVEL */
      242     8980    1   DCL GET_NXT_AC ENTRY(1) ALTRET;
      243     8981    1   DCL DB_FUNC_FDR ENTRY(2) ALTRET;
      244     8982    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
      245     8983    1   DCL SYS_FUNC_READ ENTRY ALTRET;
      246     8984    1   DCL SYS_FUNC_RELEASE ENTRY ALTRET;
      247     8985    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      248     8986    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
      249     8987    1   DCL SYS_FUNC_CORRES ENTRY(2) ALTRET;
      250     8988
      251     8989    1   WRITE_A_LINE: PROC(MSG);

   8989  5 000003   200300 741300       WRITE_A_LINE STX1  ! @EIS+1,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:49   

      252     8990
      253     8991    2   DCL MSG CHAR(78) UNAL;
      254     8992
      255     8993    2       DCBSF = DCB_LO; /* DEFAULT TO M$LO */

   8993  5 000004   000063 220000 1                  LDX0    DCB_LO
         5 000005   000000 740000 xsym               STX0    DCBSF
         5 000006   000010 710000 5                  TRA     s:8996

      256     8994
      257     8995    2   WRITE_TO_UC: ENTRY(MSG); /* HOWEVER, CANBE PASSED */

   8995  5 000007   200300 741300       WRITE_TO_UC  STX1  ! @EIS+1,,AUTO

      258     8996    2       VFCSF=%YES#;

   8996  5 000010   400000 236003                    LDQ     -131072,DU
         5 000011   000000 756000 xsym               STQ     VFCSF

      259     8997    2       IF ADDR(MSG)=ADDR(NIL) THEN

   8997  5 000012   200301 236100                    LDQ     @MSG,,AUTO
         5 000013   000000 116000 6                  CMPQ    0
         5 000014   000023 601000 5                  TNZ     s:9004

      260     8998    3       DO;

      261     8999    3           BUFSF=VECTOR(BUF); /* USE DEFAULT BUFFER */

   8999  5 000015   000002 237000 6                  LDAQ    2
         5 000016   000000 755000 xsym               STA     BUFSF
         5 000017   000001 756000 xsym               STQ     BUFSF+1

      262     9000    3           BUFLNSF=78; /* AND DEFAULT SIZE */

   9000  5 000020   000116 235007                    LDA     78,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:50   
         5 000021   000000 755000 xsym               STA     BUFLNSF

      263     9001    3           END;

   9001  5 000022   000033 710000 5                  TRA     s:9007

      264     9002    2       ELSE
      265     9003    3       DO;

      266     9004    3           BUFSF=VECTOR(MSG);

   9004  5 000023   000004 235000 6                  LDA     4
         5 000024   000000 755000 xsym               STA     BUFSF
         5 000025   000001 756000 xsym               STQ     BUFSF+1

      267     9005    3           CALL INDEX1(BUFLNSF,'%',MSG);

   9005  5 000026   200301 470500                    LDP0    @MSG,,AUTO
         5 000027   000000 124500                    SCM     mask='000'O
         5 000030   000000 000116                    ADSC9   0,,PR0                   cn=0,n=78
         5 000031   000005 000001 6                  ADSC9   5                        cn=0,n=1
         5 000032   000000 000000 xsym               ARG     BUFLNSF

      268     9006    3           END;

      269     9007    2       CALL SYS_FUNC_WRIT;

   9007  5 000033   000006 631400 6                  EPPR1   6
         5 000034   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000035   000000 011000                    NOP     0

      270     9008    2   END WRITE_A_LINE;

   9008  5 000036   200300 221300                    LDX1  ! @EIS+1,,AUTO
         5 000037   000001 702211                    TSX2  ! 1,X1

      271     9009
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:51   
      272     9010    1   MOVE_SET_NAME: PROC;

   9010  5 000040   200272 741300       MOVE_SET_NA* STX1  ! AREA_ENCRPT+33,,AUTO

      273     9011
      274     9012    3       DO S_CNT=0 TO SC_SIZ;

   9012  5 000041   002120 450000 0                  STZ     S_CNT
         5 000042   000061 710000 5                  TRA     s:9014+2

      275     9013    3           ITEM_LIST.NAME(S_CNT)=SET_NAMES(S_CNT);

   9013  5 000043   002120 236000 0                  LDQ     S_CNT
         5 000044   000030 732000                    QRS     24
         5 000045   000007 376000 6                  ANQ     7
         5 000046   000000 620006                    EAX0    0,QL
         5 000047   002120 236000 0                  LDQ     S_CNT
         5 000050   000033 732000                    QRS     27
         5 000051   000036 402007                    MPY     30,DL
         5 000052   000000 635010                    EAA     0,X0
         5 000053   000020 771000                    ARL     16
         5 000054   040005 100506                    MLR     fill='040'O
         5 000055   200003 000036                    ADSC9   SET_NAMES,Q,AUTO         cn=0,n=30
         5 000056   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30

      276     9014    3           END;

   9014  5 000057   001000 236003                    LDQ     512,DU
         5 000060   002120 056000 0                  ASQ     S_CNT
         5 000061   002120 236000 0                  LDQ     S_CNT
         5 000062   000033 732000                    QRS     27
         5 000063   000001 116000 0                  CMPQ    SC_SIZ
         5 000064   000043 604400 5                  TMOZ    s:9013

      277     9015    2       S_CNT=SC_SIZ;

   9015  5 000065   000001 235000 0                  LDA     SC_SIZ
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:52   
         5 000066   000033 735000                    ALS     27
         5 000067   002120 755000 0                  STA     S_CNT

      278     9016    2   END MOVE_SET_NAME;

   9016  5 000070   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 000071   000001 702211                    TSX2  ! 1,X1

      279     9017
      280     9018    1   VERIFY_SETS: PROC ALTRET;

   9018  5 000072   200272 741300       VERIFY_SETS  STX1  ! AREA_ENCRPT+33,,AUTO

      281     9019
      282     9020    2       BAD_FLAG=0;

   9020  5 000073   002206 450000 0                  STZ     BAD_FLAG

      283     9021    3       DO X=0 TO S_CNT;

   9021  5 000074   000000 450000 xsym               STZ     X
         5 000075   000226 710000 5                  TRA     s:9039+1

      284     9022    3           CALL FIND_MSTR_ENTRY(ITEM_LIST.NAME(X),MSTR_INDX);

   9022  5 000076   000011 236000 6                  LDQ     9
         5 000077   200311 756100                    STQ     @INDX+2,,AUTO
         5 000100   000000 236000 xsym               LDQ     X
         5 000101   000025 736000                    QLS     21
         5 000102   000012 036000 6                  ADLQ    10
         5 000103   200310 756100                    STQ     @INDX+1,,AUTO
         5 000104   200310 630500                    EPPR0   @INDX+1,,AUTO
         5 000105   000010 631400 6                  EPPR1   8
         5 000106   000000 701000 xent               TSX1    FIND_MSTR_ENTRY
         5 000107   000000 011000                    NOP     0

      285     9023    3           CALL INDEX1(V2,' ',ITEM_LIST.NAME(X));
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:53   

   9023  5 000110   000000 235000 xsym               LDA     X
         5 000111   000005 735000                    ALS     5
         5 000112   000000 124405                    SCM     mask='000'O
         5 000113   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30
         5 000114   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 000115   002007 000000 0                  ARG     V2

      286     9024    3           IF MSTR_INDX = -1 THEN

   9024  5 000116   000000 236000 xsym               LDQ     MSTR_INDX
         5 000117   000014 116000 6                  CMPQ    12
         5 000120   000160 601000 5                  TNZ     s:9032

      287     9025    4           DO;

      288     9026    4               CALL CONCAT(BUF,'B    Set ',ADDR(ITEM_LIST.NAME(X))->REC_V,

   9026  5 000121   040000 100400                    MLR     fill='040'O
         5 000122   000064 000011 1                  ADSC9   DCB_LO+1                 cn=0,n=9
         5 000123   002036 000011 0                  ADSC9   BUF                      cn=0,n=9
         5 000124   002007 720000 0                  LXL0    V2
         5 000125   040000 100445                    MLR     fill='040'O
         5 000126   000000 000010 xsym               ADSC9   ITEM_LIST,A              cn=0,n=*X0
         5 000127   002040 200107 0                  ADSC9   BUF+2                    cn=1,n=71
         5 000130   002007 236000 0                  LDQ     V2
         5 000131   000107 116007                    CMPQ    71,DL
         5 000132   000150 603000 5                  TRC     s:9028
         5 000133   777670 621006                    EAX1    -72,QL
         5 000134   777777 661003                    ERX1    -1,DU
         5 000135   040046 100400                    MLR     fill='040'O
         5 000136   000067 000027 1                  ADSC9   DCB_LO+4                 cn=0,n=23
         5 000137   002040 200011 0                  ADSC9   BUF+2,Q                  cn=1,n=*X1
         5 000140   002007 236000 0                  LDQ     V2
         5 000141   000060 116007                    CMPQ    48,DL
         5 000142   000150 603000 5                  TRC     s:9028
         5 000143   777717 620006                    EAX0    -49,QL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:54   
         5 000144   777777 660003                    ERX0    -1,DU
         5 000145   040046 100400                    MLR     fill='040'O
         5 000146   000000 000036 xsym               ADSC9   CURR_SCHNM               cn=0,n=30
         5 000147   002046 000010 0                  ADSC9   BUF+8,Q                  cn=0,n=*X0

      289     9027    4                  ' not defined in schema ',CURR_SCHNM);
      290     9028    4               CALL WRITE_A_LINE;

   9028  5 000150   000000 236000 6                  LDQ     0
         5 000151   200301 756100                    STQ     @MSG,,AUTO
         5 000152   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000153   000000 011000                    NOP     0

      291     9029    4               BAD_FLAG=BAD_FLAG+1;

   9029  5 000154   002206 235000 0                  LDA     BAD_FLAG
         5 000155   000001 035007                    ADLA    1,DL
         5 000156   002206 755000 0                  STA     BAD_FLAG

      292     9030    4               END;

   9030  5 000157   000225 710000 5                  TRA     s:9039

      293     9031    3           ELSE
      294     9032    3               IF MSTR_REF.TYPE(MSTR_INDX)<=4000 THEN

   9032  5 000160   000012 402007                    MPY     10,DL
         5 000161   000000 470400 xsym               LDP0    MSTR$
         5 000162   000000 220106                    LDX0    0,QL,PR0
         5 000163   007640 100003                    CMPX0   4000,DU
         5 000164   000225 605400 5                  TPNZ    s:9039

      295     9033    4               DO;

      296     9034    4                   CALL CONCAT(BUF,'a    ',ADDR(ITEM_LIST.NAME(X))->REC_V,

   9034  5 000165   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:55   
         5 000166   000075 000005 1                  ADSC9   DCB_LO+10                cn=0,n=5
         5 000167   002036 000005 0                  ADSC9   BUF                      cn=0,n=5
         5 000170   000000 235000 xsym               LDA     X
         5 000171   000005 735000                    ALS     5
         5 000172   002007 720000 0                  LXL0    V2
         5 000173   040000 100445                    MLR     fill='040'O
         5 000174   000000 000010 xsym               ADSC9   ITEM_LIST,A              cn=0,n=*X0
         5 000175   002037 200113 0                  ADSC9   BUF+1                    cn=1,n=75
         5 000176   002007 236000 0                  LDQ     V2
         5 000177   000113 116007                    CMPQ    75,DL
         5 000200   000216 603000 5                  TRC     s:9036
         5 000201   777664 621006                    EAX1    -76,QL
         5 000202   777777 661003                    ERX1    -1,DU
         5 000203   040046 100400                    MLR     fill='040'O
         5 000204   000077 000045 1                  ADSC9   DCB_LO+12                cn=0,n=37
         5 000205   002037 200011 0                  ADSC9   BUF+1,Q                  cn=1,n=*X1
         5 000206   002007 236000 0                  LDQ     V2
         5 000207   000046 116007                    CMPQ    38,DL
         5 000210   000216 603000 5                  TRC     s:9036
         5 000211   777731 620006                    EAX0    -39,QL
         5 000212   777777 660003                    ERX0    -1,DU
         5 000213   040046 100400                    MLR     fill='040'O
         5 000214   000000 000036 xsym               ADSC9   CURR_SCHNM               cn=0,n=30
         5 000215   002050 400010 0                  ADSC9   BUF+10,Q                 cn=2,n=*X0

      297     9035    4                      ' is a record but not a set in schema ',CURR_SCHNM);
      298     9036    4                   CALL WRITE_A_LINE;

   9036  5 000216   000000 236000 6                  LDQ     0
         5 000217   200301 756100                    STQ     @MSG,,AUTO
         5 000220   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000221   000000 011000                    NOP     0

      299     9037    4                   BAD_FLAG=BAD_FLAG+1;

   9037  5 000222   002206 235000 0                  LDA     BAD_FLAG
         5 000223   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:56   
         5 000224   002206 755000 0                  STA     BAD_FLAG

      300     9038    4                   END;

      301     9039    3           END;

   9039  5 000225   000000 054000 xsym               AOS     X
         5 000226   002120 236000 0                  LDQ     S_CNT
         5 000227   000033 732000                    QRS     27
         5 000230   000000 116000 xsym               CMPQ    X
         5 000231   000076 605000 5                  TPL     s:9022

      302     9040    2       IF BAD_FLAG>0 THEN ALTRETURN;

   9040  5 000232   002206 235000 0                  LDA     BAD_FLAG
         5 000233   000236 600000 5                  TZE     s:9041

   9040  5 000234   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 000235   000000 702211                    TSX2  ! 0,X1

      303     9041    2   END VERIFY_SETS;

   9041  5 000236   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 000237   000001 702211                    TSX2  ! 1,X1

      304     9042
      305     9043    1   AREA_SELECTION: PROC ALTRET;

   9043  5 000240   200274 741300       AREA_SELECT* STX1  ! @PTR_TYPE+1,,AUTO

      306     9044
      307     9045    2       IF KEY_RNG.FIR(0)=0 THEN ALTRETURN;

   9045  5 000241   000000 235000 xsym               LDA     KEY_RNG
         5 000242   000244 601000 5                  TNZ     s:9046

   9045  5 000243   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:57   

      308     9046    3       DO X=0 TO NO_AREAS-1;

   9046  5 000244   000000 450000 xsym               STZ     X
         5 000245   000340 710000 5                  TRA     s:9067+1

      309     9047    3           IF KEY_RNG.FIR(0)<=AREA_KEY_XREF.MAX_KEY(X) THEN

   9047  5 000246   000000 236000 xsym               LDQ     X
         5 000247   000012 402007                    MPY     10,DL
         5 000250   000000 470400 xsym               LDP0    AREA_KEY$
         5 000251   000000 235106                    LDA     0,QL,PR0
         5 000252   000001 236106                    LDQ     1,QL,PR0
         5 000253   000022 773000                    LRL     18
         5 000254   000000 116000 xsym               CMPQ    KEY_RNG
         5 000255   000337 602000 5                  TNC     s:9067

      310     9048    4           DO;

      311     9049    4               ENT_ADDR=ENTADDR(ZIU$Q2PR3); /* JUST DO IT */

   9049  5 000256   000000 636000 xent               EAQ     ZIU$Q2PR3
         5 000257   000002 756000 0                  STQ     ENT_ADDR

      312     9050    4               ZI$DIR.ENCP_SEED_RD=AREA_ENCRPT(X);

   9050  5 000260   000000 720000 xsym               LXL0    X
         5 000261   200231 235110                    LDA     AREA_ENCRPT,X0,AUTO
         5 000262   000027 755000 xsym               STA     ZI$DIR+23

      313     9051    4               IF AREA_INDX=X THEN RETURN;

   9051  5 000263   002070 236000 0                  LDQ     AREA_INDX
         5 000264   000000 116000 xsym               CMPQ    X
         5 000265   000270 601000 5                  TNZ     s:9052

   9051  5 000266   200274 221300                    LDX1  ! @PTR_TYPE+1,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:58   
         5 000267   000001 702211                    TSX2  ! 1,X1

      314     9052    4               ZI$DIR.PGRG_RESET='1'B; /* FOR PAGE_RANGE TO WORD */

   9052  5 000270   010000 236003                    LDQ     4096,DU
         5 000271   000125 256000 xsym               ORSQ    ZI$DIR+85

      315     9053    4               ZI$DIR.AREA_NM.NAME.TEXT=AREA_KEY_XREF.NAME(X);

   9053  5 000272   000000 236000 xsym               LDQ     X
         5 000273   000050 402007                    MPY     40,DL
         5 000274   040000 100506                    MLR     fill='040'O
         5 000275   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         5 000276   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30

      316     9054    4               IF AREA_KEY_XREF.DCB#(X)>0 THEN

   9054  5 000277   000000 236000 xsym               LDQ     X
         5 000300   000012 402007                    MPY     10,DL
         5 000301   000000 221106                    LDX1    0,QL,PR0
         5 000302   000306 600000 5                  TZE     s:9057

      317     9055    4                   ENT_ADDR=ENTADDR(ZIU$Q2PR2); /* RE-READ ATTL BLK */

   9055  5 000303   000000 636000 xent               EAQ     ZIU$Q2PR2
         5 000304   000002 756000 0                  STQ     ENT_ADDR
         5 000305   000310 710000 5                  TRA     s:9058

      318     9056    4               ELSE
      319     9057    4                   ENT_ADDR=ENTADDR(ZIU$Q2PR1); /* OPEN AREA */

   9057  5 000306   000000 636000 xent               EAQ     ZIU$Q2PR1
         5 000307   000002 756000 0                  STQ     ENT_ADDR

      320     9058    4               FUNSF=%UPDATE#; /* OPEN THE AREA WITH UPDATE MODE */

   9058  5 000310   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:59   
         5 000311   000000 755000 xsym               STA     FUNSF

      321     9059    4               SHARESF=%IN#; /* AND SHARE WITHIN INPUT USERS */

   9059  5 000312   400000 236003                    LDQ     -131072,DU
         5 000313   000000 756000 xsym               STQ     SHARESF

      322     9060    4               CALL GET_DCB(ZI$DIR.AREA_NM);

   9060  5 000314   000016 630400 6                  EPPR0   14
         5 000315   000015 631400 6                  EPPR1   13
         5 000316   000000 701000 xent               TSX1    GET_DCB
         5 000317   000000 011000                    NOP     0

      323     9061    4               AREA_KEY_XREF.DCB#(X)=ZI$DIR.AREA_NM.DCB#;

   9061  5 000320   000000 236000 xsym               LDQ     X
         5 000321   000012 402007                    MPY     10,DL
         5 000322   000244 220000 xsym               LDX0    ZI$DIR+164
         5 000323   000000 470400 xsym               LDP0    AREA_KEY$
         5 000324   000000 740106                    STX0    0,QL,PR0

      324     9062    4               LAST_DBK=UWA.SF_REC.DBKOA; /* INIT OAAC TO OA REC */

   9062  5 000325   000063 235000 xsym               LDA     UWA+51
         5 000326   000000 755000 xsym               STA     LAST_DBK

      325     9063    4               CALL GET_NXT_AC(III);

   9063  5 000327   000017 630400 6                  EPPR0   15
         5 000330   000015 631400 6                  EPPR1   13
         5 000331   000000 701000 xent               TSX1    GET_NXT_AC
         5 000332   000000 011000                    NOP     0

      326     9064    4               AREA_INDX=X; /* REMEMBER CURRENT AREA'S INDEX */

   9064  5 000333   000000 235000 xsym               LDA     X
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:60   
         5 000334   002070 755000 0                  STA     AREA_INDX

      327     9065    4               RETURN;

   9065  5 000335   200274 221300                    LDX1  ! @PTR_TYPE+1,,AUTO
         5 000336   000001 702211                    TSX2  ! 1,X1

      328     9066    4               END;
      329     9067    3           END;

   9067  5 000337   000000 054000 xsym               AOS     X
         5 000340   000000 236000 xsym               LDQ     X
         5 000341   000000 116000 xsym               CMPQ    NO_AREAS
         5 000342   000246 604000 5                  TMI     s:9047

      330     9068    2       ALTRETURN;

   9068  5 000343   200274 221300                    LDX1  ! @PTR_TYPE+1,,AUTO
         5 000344   000000 702211                    TSX2  ! 0,X1

      331     9069    2   END AREA_SELECTION;
      332     9070
      333     9071
      334     9072    1   GET_CMD: PROC(PARSE_TREE,PROMPT_MSG) ALTRET;

   9072  5 000345   200272 741300       GET_CMD      STX1  ! AREA_ENCRPT+33,,AUTO

      335     9073
      336     9074    2   DCL PARSE_TREE UBIN;
      337     9075    2   DCL PROMPT_MSG CHAR(60) UNAL;
      338     9076
      339     9077    2       III=III+1;

   9077  5 000346   002003 054000 0                  AOS     III

      340     9078    2       CALL INDEX1(V3,':',PROMPT_MSG);

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:61   
   9078  5 000347   200274 470500                    LDP0    @PROMPT_MSG,,AUTO
         5 000350   000000 124500                    SCM     mask='000'O
         5 000351   000000 000074                    ADSC9   0,,PR0                   cn=0,n=60
         5 000352   000020 000001 6                  ADSC9   16                       cn=0,n=1
         5 000353   002010 000000 0                  ARG     V3

      341     9079    2   RE_READ:
      342     9080    2   /**/ BUFLNSF=V3+1;

   9080  5 000354   002010 235000 0     RE_READ      LDA     V3
         5 000355   000001 035007                    ADLA    1,DL
         5 000356   000000 755000 xsym               STA     BUFLNSF

      343     9081    2   /**/ BUFSF=VECTOR(PROMPT_MSG);

   9081  5 000357   000021 235000 6                  LDA     17
         5 000360   200274 236100                    LDQ     @PROMPT_MSG,,AUTO
         5 000361   000000 755000 xsym               STA     BUFSF
         5 000362   000001 756000 xsym               STQ     BUFSF+1

      344     9082    2   REREAD_SUBCOM:
      345     9083    2   /**/ DCBSF=DCB_LO;

   9083  5 000363   000063 220000 1     REREAD_SUBC* LDX0    DCB_LO
         5 000364   000000 740000 xsym               STX0    DCBSF

      346     9084    2       PCB.ROOT$=ADDR(PARSE_TREE);

   9084  5 000365   200273 236100                    LDQ     @PARSE_TREE,,AUTO
         5 000366   002337 756000 0                  STQ     PCB+1

      347     9085    2       CALL SYS_FUNC_WRIT;

   9085  5 000367   000006 631400 6                  EPPR1   6
         5 000370   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000371   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:62   
      348     9086    2       IF OUTPUT_UC=0 THEN /* OUTPUT IS NOT UC */

   9086  5 000372   002122 236000 0                  LDQ     OUTPUT_UC
         5 000373   777000 316003                    CANQ    -512,DU
         5 000374   000402 601000 5                  TNZ     s:9091

      349     9087    3       DO;

      350     9088    3           DCBSF = DCB_UC;

   9088  5 000375   000061 220000 1                  LDX0    DCB_UC
         5 000376   000000 740000 xsym               STX0    DCBSF

      351     9089    3           CALL SYS_FUNC_WRIT;

   9089  5 000377   000006 631400 6                  EPPR1   6
         5 000400   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 000401   000000 011000                    NOP     0

      352     9090    3           END;

      353     9091    2       CALL M$PROMPT(FPT_PROMPT);

   9091  5 000402   002216 630400 0                  EPPR0   FPT_PROMPT
         5 000403   160002 713400                    CLIMB   57346
         5 000404   401000 401760                    pmme    nvectors=3

      354     9092    2       RBUF = ' '; /* INIT INPUT BUF */

   9092  5 000405   040000 100400                    MLR     fill='040'O
         5 000406   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 000407   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256

      355     9093    2       DCBSF = DCBNUM(M$SI);

   9093  5 000410   000000 236007 xsym               LDQ     M$SI,DL
         5 000411   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:63   
         5 000412   000000 740000 xsym               STX0    DCBSF

      356     9094    2       BUFSF = VECTOR(RBUF);

   9094  5 000413   000022 237000 6                  LDAQ    18
         5 000414   000000 755000 xsym               STA     BUFSF
         5 000415   000001 756000 xsym               STQ     BUFSF+1

      357     9095    2       BUFLNSF = 132;

   9095  5 000416   000204 235007                    LDA     132,DL
         5 000417   000000 755000 xsym               STA     BUFLNSF

      358     9096    2       CALL SYS_FUNC_READ ALTRET(ALTRTN); /* ON READ ERROR */

   9096  5 000420   000006 631400 6                  EPPR1   6
         5 000421   000000 701000 xent               TSX1    SYS_FUNC_READ
         5 000422   000575 702000 5                  TSX2    ALTRTN

      359     9097    2       CNT = DCBADDR(DCBSF)->F$DCB.ARS#;

   9097  5 000423   000024 470400 6                  LDP0    20
         5 000424   000000 471500                    LDP1    0,,PR0
         5 000425   000000 220000 xsym               LDX0    DCBSF
         5 000426   100000 473510                    LDP3    0,X0,PR1
         5 000427   300000 235100                    LDA     0,,PR3
         5 000430   000000 755000 xsym               STA     CNT

      360     9098    2       IF PRINT_HDR THEN /* IF INPUT IS FROM FILE */

   9098  5 000431   000000 234000 xsym               SZN     PRINT_HDR
         5 000432   000450 605000 5                  TPL     s:9104

      361     9099    3       DO;

      362     9100    3           CALL CONCAT(BUF,'@ ',RBUF);

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:64   
   9100  5 000433   000111 221000 1                  LDX1    DCB_LO+22
         5 000434   002036 741000 0                  STX1    BUF
         5 000435   040000 100400                    MLR     fill='040'O
         5 000436   000000 000116 xsym               ADSC9   RBUF                     cn=0,n=78
         5 000437   002036 400116 0                  ADSC9   BUF                      cn=2,n=78

      363     9101    3           CALL WRITE_A_LINE;

   9101  5 000440   000000 236000 6                  LDQ     0
         5 000441   200301 756100                    STQ     @MSG,,AUTO
         5 000442   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000443   000000 011000                    NOP     0

      364     9102    3           CALL WRITE_A_LINE('A%');

   9102  5 000444   000025 236000 6                  LDQ     21
         5 000445   200301 756100                    STQ     @MSG,,AUTO
         5 000446   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000447   000000 011000                    NOP     0

      365     9103    3           END;

      366     9104    2       IF RBUF=' ' THEN GOTO RE_READ;

   9104  5 000450   040000 106400                    CMPC    fill='040'O
         5 000451   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256
         5 000452   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 000453   000354 600000 5                  TZE     RE_READ

      367     9105    2       IF III>1 AND RBUF='Q' OR RBUF='QUIT' THEN ALTRETURN;

   9105  5 000454   002003 235000 0                  LDA     III
         5 000455   000001 115007                    CMPA    1,DL
         5 000456   000463 604400 5                  TMOZ    s:9105+7
         5 000457   040000 106400                    CMPC    fill='040'O
         5 000460   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256
         5 000461   000026 000001 6                  ADSC9   22                       cn=0,n=1
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:65   
         5 000462   000467 600000 5                  TZE     s:9105+11
         5 000463   040000 106400                    CMPC    fill='040'O
         5 000464   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256
         5 000465   000113 000004 1                  ADSC9   DCB_LO+24                cn=0,n=4
         5 000466   000471 601000 5                  TNZ     s:9106

   9105  5 000467   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 000470   000000 702211                    TSX2  ! 0,X1

      368     9106    2       PCB.NCHARS=CNT;

   9106  5 000471   000000 236000 xsym               LDQ     CNT
         5 000472   002347 756000 0                  STQ     PCB+9

      369     9107    2       CALL X$PARSE(PCB) ALTRET(PARSE_ERR);

   9107  5 000473   000027 630400 6                  EPPR0   23
         5 000474   000015 631400 6                  EPPR1   13
         5 000475   000000 701000 xent               TSX1    X$PARSE
         5 000476   000505 702000 5                  TSX2    PARSE_ERR

      370     9108    2       CALL CHK_NODE(PCB.OUT$);

   9108  5 000477   000030 630400 6                  EPPR0   24
         5 000500   000015 631400 6                  EPPR1   13
         5 000501   000000 701000 xent               TSX1    CHK_NODE
         5 000502   000000 011000                    NOP     0

      371     9109    2       RETURN;

   9109  5 000503   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 000504   000001 702211                    TSX2  ! 1,X1

      372     9110    2   PARSE_ERR:
      373     9111    2       KKK=PCB.HI_CHAR;

   9111  5 000505   002350 235000 0     PARSE_ERR    LDA     PCB+10
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:66   
         5 000506   002005 755000 0                  STA     KKK

      374     9112    2       CALL CONV_DBK(KKK,DBK_CUR,V1);

   9112  5 000507   000032 237000 6                  LDAQ    26
         5 000510   200306 757100                    STAQ    @DBK_BIN+1,,AUTO
         5 000511   000034 236000 6                  LDQ     28
         5 000512   200305 756100                    STQ     @INDX+3,,AUTO
         5 000513   000721 701000 5                  TSX1    CONV_DBK
         5 000514   000000 011000                    NOP     0

      375     9113    2       V2=V3-4-V1;

   9113  5 000515   002010 236000 0                  LDQ     V3
         5 000516   002006 136000 0                  SBLQ    V1
         5 000517   000004 136007                    SBLQ    4,DL
         5 000520   002007 756000 0                  STQ     V2

      376     9114    2       ADDR(BUF2.SEC)->REC_V='@';

   9114  5 000521   000000 620006                    EAX0    0,QL
         5 000522   040040 100400                    MLR     fill='040'O
         5 000523   000035 000001 6                  ADSC9   29                       cn=0,n=1
         5 000524   002050 000010 0                  ADSC9   BUF+10                   cn=0,n=*X0

      377     9115    2       CALL CONCAT(BUF,ADDR(BUF2.SEC)->REC_V,'EH@ ',

   9115  5 000525   002007 720000 0                  LXL0    V2
         5 000526   040000 100440                    MLR     fill='040'O
         5 000527   002050 000010 0                  ADSC9   BUF+10                   cn=0,n=*X0
         5 000530   002036 000120 0                  ADSC9   BUF                      cn=0,n=80
         5 000531   002007 236000 0                  LDQ     V2
         5 000532   000120 116007                    CMPQ    80,DL
         5 000533   000567 603000 5                  TRC     s:9117
         5 000534   777657 621006                    EAX1    -81,QL
         5 000535   777777 661003                    ERX1    -1,DU
         5 000536   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:67   
         5 000537   000114 000004 1                  ADSC9   DCB_LO+25                cn=0,n=4
         5 000540   002036 000011 0                  ADSC9   BUF,Q                    cn=0,n=*X1
         5 000541   002007 236000 0                  LDQ     V2
         5 000542   000114 116007                    CMPQ    76,DL
         5 000543   000567 603000 5                  TRC     s:9117
         5 000544   777663 620006                    EAX0    -77,QL
         5 000545   777777 660003                    ERX0    -1,DU
         5 000546   002006 721000 0                  LXL1    V1
         5 000547   040046 100440                    MLR     fill='040'O
         5 000550   002062 000011 0                  ADSC9   DBK_CUR                  cn=0,n=*X1
         5 000551   002037 000010 0                  ADSC9   BUF+1,Q                  cn=0,n=*X0
         5 000552   002007 236000 0                  LDQ     V2
         5 000553   002006 036000 0                  ADLQ    V1
         5 000554   000114 116007                    CMPQ    76,DL
         5 000555   000567 603000 5                  TRC     s:9117
         5 000556   200310 756100                    STQ     @INDX+1,,AUTO
         5 000557   002007 236000 0                  LDQ     V2
         5 000560   002006 036000 0                  ADLQ    V1
         5 000561   200310 720100                    LXL0    @INDX+1,,AUTO
         5 000562   777663 620010                    EAX0    -77,X0
         5 000563   777777 660003                    ERX0    -1,DU
         5 000564   040046 100400                    MLR     fill='040'O
         5 000565   000036 000001 6                  ADSC9   30                       cn=0,n=1
         5 000566   002037 000010 0                  ADSC9   BUF+1,Q                  cn=0,n=*X0

      378     9116    2          ADDR(DBK_CUR)->DBK_V,'?');
      379     9117    2       BUFSF=VECTOR(BUF);

   9117  5 000567   000002 237000 6                  LDAQ    2
         5 000570   000000 755000 xsym               STA     BUFSF
         5 000571   000001 756000 xsym               STQ     BUFSF+1

      380     9118    2       BUFLNSF=80;

   9118  5 000572   000120 235007                    LDA     80,DL
         5 000573   000000 755000 xsym               STA     BUFLNSF

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:68   
      381     9119    2       GOTO REREAD_SUBCOM;

   9119  5 000574   000363 710000 5                  TRA     REREAD_SUBCOM

      382     9120    2   ALTRTN:
      383     9121    2       CALL WRITE_A_LINE('a  Error reading command - QUIT simulated.%');

   9121  5 000575   000037 236000 6     ALTRTN       LDQ     31
         5 000576   200301 756100                    STQ     @MSG,,AUTO
         5 000577   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000600   000000 011000                    NOP     0

      384     9122    2       ALTRETURN;

   9122  5 000601   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 000602   000000 702211                    TSX2  ! 0,X1

      385     9123    2   END GET_CMD;
      386     9124
      387     9125    1   TRACE_OUT: PROC(FLAG);

   9125  5 000603   200272 741300       TRACE_OUT    STX1  ! AREA_ENCRPT+33,,AUTO

      388     9126
      389     9127    2   DCL FLAG UBIN;
      390     9128
      391     9129    2       IF TRACE_CNT+1 = WALK_CNT THEN

   9129  5 000604   002031 236000 0                  LDQ     TRACE_CNT
         5 000605   000001 036007                    ADLQ    1,DL
         5 000606   002030 116000 0                  CMPQ    WALK_CNT
         5 000607   000613 601000 5                  TNZ     s:9132

      392     9130    2           CHAR4=' -> ';

   9130  5 000610   000130 236000 1                  LDQ     DCB_LO+37
         5 000611   002032 756000 0                  STQ     CHAR4
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:69   
         5 000612   000615 710000 5                  TRA     s:9133

      393     9131    2       ELSE
      394     9132    2           CHAR4=' => ';

   9132  5 000613   000131 236000 1                  LDQ     DCB_LO+38
         5 000614   002032 756000 0                  STQ     CHAR4

      395     9133    2       TRACE_CNT=WALK_CNT;

   9133  5 000615   002030 235000 0                  LDA     WALK_CNT
         5 000616   002031 755000 0                  STA     TRACE_CNT

      396     9134    2       V5 = DBK_REC_SIZE+4;

   9134  5 000617   002022 235000 0                  LDA     DBK_REC_SIZE
         5 000620   000004 035007                    ADLA    4,DL
         5 000621   002012 755000 0                  STA     V5

      397     9135    2       IF FLAG=2 THEN V5=V5+10;

   9135  5 000622   200273 470500                    LDP0    @FLAG,,AUTO
         5 000623   000000 235100                    LDA     0,,PR0
         5 000624   000002 115007                    CMPA    2,DL
         5 000625   000631 601000 5                  TNZ     s:9136

   9135  5 000626   002012 235000 0                  LDA     V5
         5 000627   000012 035007                    ADLA    10,DL
         5 000630   002012 755000 0                  STA     V5

      398     9136    2       IF C_POS+V5 > 78 THEN

   9136  5 000631   002021 236000 0                  LDQ     C_POS
         5 000632   002012 036000 0                  ADLQ    V5
         5 000633   000117 116007                    CMPQ    79,DL
         5 000634   000652 602000 5                  TNC     s:9143

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:70   
      399     9137    3       DO;

      400     9138    3           C_POS=V5+3;

   9138  5 000635   002012 235000 0                  LDA     V5
         5 000636   000003 035007                    ADLA    3,DL
         5 000637   002021 755000 0                  STA     C_POS

      401     9139    3           CALL CONCAT(BUF,'a   ',CHAR4,DBK_REC);

   9139  5 000640   000075 236000 1                  LDQ     DCB_LO+10
         5 000641   002036 756000 0                  STQ     BUF
         5 000642   002032 236000 0                  LDQ     CHAR4
         5 000643   002037 756000 0                  STQ     BUF+1
         5 000644   002023 471400 0                  LDP1    DBK_REC$
         5 000645   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 000646   040000 100540                    MLR     fill='040'O
         5 000647   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 000650   002040 000110 0                  ADSC9   BUF+2                    cn=0,n=72

      402     9140    3           END;

   9140  5 000651   000667 710000 5                  TRA     s:9146

      403     9141    2       ELSE
      404     9142    3       DO;

      405     9143    3           C_POS=C_POS+V5;

   9143  5 000652   002021 236000 0                  LDQ     C_POS
         5 000653   002012 036000 0                  ADLQ    V5
         5 000654   002021 756000 0                  STQ     C_POS

      406     9144    3           CALL CONCAT(BUF,'@',CHAR4,DBK_REC);

   9144  5 000655   100000 236003                    LDQ     32768,DU
         5 000656   002036 552040 0                  STBQ    BUF,'40'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:71   
         5 000657   040000 100400                    MLR     fill='040'O
         5 000660   002032 000004 0                  ADSC9   CHAR4                    cn=0,n=4
         5 000661   002036 200004 0                  ADSC9   BUF                      cn=1,n=4
         5 000662   002023 471400 0                  LDP1    DBK_REC$
         5 000663   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 000664   040000 100540                    MLR     fill='040'O
         5 000665   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 000666   002037 200113 0                  ADSC9   BUF+1                    cn=1,n=75

      407     9145    3           END;

      408     9146    2       CALL WRITE_A_LINE;

   9146  5 000667   000000 236000 6                  LDQ     0
         5 000670   200301 756100                    STQ     @MSG,,AUTO
         5 000671   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000672   000000 011000                    NOP     0

      409     9147    2       IF FLAG = 2 THEN

   9147  5 000673   200273 470500                    LDP0    @FLAG,,AUTO
         5 000674   000000 235100                    LDA     0,,PR0
         5 000675   000002 115007                    CMPA    2,DL
         5 000676   000715 601000 5                  TNZ     s:9155

      410     9148    3       DO;

      411     9149    3           ADD_FLAG = 1; /* WILL STOP HERE, IF IT HITS AGAIN */

   9149  5 000677   001000 236003                    LDQ     512,DU
         5 000700   002125 756000 0                  STQ     ADD_FLAG

      412     9150    3           IF N_OR_P = #NEXT2 THEN

   9150  5 000701   002131 235000 0                  LDA     N_OR_P
         5 000702   000016 115007                    CMPA    14,DL
         5 000703   000711 601000 5                  TNZ     s:9153
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:72   

      413     9151    3               CALL WRITE_A_LINE('@ Bad Prior%');

   9151  5 000704   000040 236000 6                  LDQ     32
         5 000705   200301 756100                    STQ     @MSG,,AUTO
         5 000706   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000707   000000 011000                    NOP     0
         5 000710   000715 710000 5                  TRA     s:9155

      414     9152    3           ELSE
      415     9153    3               CALL WRITE_A_LINE('@ Bad Next%');

   9153  5 000711   000041 236000 6                  LDQ     33
         5 000712   200301 756100                    STQ     @MSG,,AUTO
         5 000713   000003 701000 5                  TSX1    WRITE_A_LINE
         5 000714   000000 011000                    NOP     0

      416     9154    3           END;

      417     9155    2       III=99999; /* GET OUT OF TRACE LOOP */

   9155  5 000715   303237 235007                    LDA     99999,DL
         5 000716   002003 755000 0                  STA     III

      418     9156    2   END TRACE_OUT;

   9156  5 000717   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 000720   000001 702211                    TSX2  ! 1,X1

      419     9157
      420     9158    1   CONV_DBK: PROC(DBK_BIN,DBK_TXT,INDX);

   9158  5 000721   200304 741300       CONV_DBK     STX1  ! @INDX+2,,AUTO

      421     9159
      422     9160    2   DCL DBK_BIN UBIN;
      423     9161    2   DCL DBK_TXT CHAR(10) UNAL;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:73   
      424     9162    2   DCL INDX UBIN;
      425     9163
      426     9164    2       CALL BINCHAR(DBK_TXT,DBK_BIN);

   9164  5 000722   200305 470500                    LDP0    @DBK_BIN,,AUTO
         5 000723   000000 235100                    LDA     0,,PR0
         5 000724   000044 773000                    LRL     36
         5 000725   200310 757100                    STAQ    @INDX+1,,AUTO
         5 000726   200306 471500                    LDP1    @DBK_TXT,,AUTO
         5 000727   000100 301500                    BTD
         5 000730   200310 000010                    NDSC9   @INDX+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         5 000731   100000 030012                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=10

      427     9165    2       CALL ZERO_SUP(DBK_TXT,10,'1'B);

   9165  5 000732   000045 236000 6                  LDQ     37
         5 000733   200312 756100                    STQ     @INDX+3,,AUTO
         5 000734   000046 236000 6                  LDQ     38
         5 000735   200306 235100                    LDA     @DBK_TXT,,AUTO
         5 000736   200310 757100                    STAQ    @INDX+1,,AUTO
         5 000737   200310 630500                    EPPR0   @INDX+1,,AUTO
         5 000740   000042 631400 6                  EPPR1   34
         5 000741   000000 701000 xent               TSX1    ZERO_SUP
         5 000742   000000 011000                    NOP     0

      428     9166    2       CALL INDEX1(INDX,' ',DBK_TXT);

   9166  5 000743   200307 470500                    LDP0    @INDX,,AUTO
         5 000744   200306 471500                    LDP1    @DBK_TXT,,AUTO
         5 000745   000000 124500                    SCM     mask='000'O
         5 000746   100000 000012                    ADSC9   0,,PR1                   cn=0,n=10
         5 000747   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 000750   000000 000100                    ARG     0,,PR0

      429     9167    2   END CONV_DBK;

   9167  5 000751   200304 221300                    LDX1  ! @INDX+2,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:74   
         5 000752   000001 702211                    TSX2  ! 1,X1

      430     9168
      431     9169    1   JRNL_READ: PROC ALTRET;

   9169  5 000753   200272 741300       JRNL_READ    STX1  ! AREA_ENCRPT+33,,AUTO

      432     9170
      433     9171    2       DCBSF = JRNL_DCB#;

   9171  5 000754   002027 720000 0                  LXL0    JRNL_DCB#
         5 000755   000000 740000 xsym               STX0    DCBSF

      434     9172    2       BUFSF = VECTOR(I_O_BUF);

   9172  5 000756   000047 235000 6                  LDA     39
         5 000757   000000 236000 xsym               LDQ     I_O_BUF$
         5 000760   000000 755000 xsym               STA     BUFSF
         5 000761   000001 756000 xsym               STQ     BUFSF+1

      435     9173    2       BUFLNSF = 4096;

   9173  5 000762   010000 235007                    LDA     4096,DL
         5 000763   000000 755000 xsym               STA     BUFLNSF

      436     9174    2       KEYSF = %NO#;

   9174  5 000764   000000 450000 xsym               STZ     KEYSF

      437     9175    2       VFCSF = %NO#;

   9175  5 000765   000000 450000 xsym               STZ     VFCSF

      438     9176    2       KEYRSF = '1'B;

   9176  5 000766   400000 236003                    LDQ     -131072,DU
         5 000767   000000 756000 xsym               STQ     KEYRSF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:75   

      439     9177    2       CALL SYS_FUNC_READ ALTRET(FAIL_READ_JRNL);

   9177  5 000770   000006 631400 6                  EPPR1   6
         5 000771   000000 701000 xent               TSX1    SYS_FUNC_READ
         5 000772   001010 702000 5                  TSX2    FAIL_READ_JRNL

      440     9178    2       AREA_INDX = JRNL_KEY.AREA_INDX;

   9178  5 000773   000060 470400 1                  LDP0    JRNL_KEY$
         5 000774   000000 236100                    LDQ     0,,PR0
         5 000775   777777 376007                    ANQ     -1,DL
         5 000776   002070 756000 0                  STQ     AREA_INDX

      441     9179    2       ZI$DIR.AREA_NM.DCB# = AREA_KEY_XREF.DCB#(AREA_INDX);

   9179  5 000777   000012 402007                    MPY     10,DL
         5 001000   000000 471400 xsym               LDP1    AREA_KEY$
         5 001001   100000 220106                    LDX0    0,QL,PR1
         5 001002   000244 740000 xsym               STX0    ZI$DIR+164

      442     9180    2       ZI$DIR.ENCP_SEED_RD = AREA_ENCRPT(AREA_INDX);

   9180  5 001003   002070 721000 0                  LXL1    AREA_INDX
         5 001004   200231 235111                    LDA     AREA_ENCRPT,X1,AUTO
         5 001005   000027 755000 xsym               STA     ZI$DIR+23

      443     9181    2       RETURN;

   9181  5 001006   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 001007   000001 702211                    TSX2  ! 1,X1

      444     9182    2   FAIL_READ_JRNL:
      445     9183    2       CALL WRITE_A_LINE('@  Fail to read journal, cant UNDO for you%');

   9183  5 001010   000050 236000 6     FAIL_READ_J* LDQ     40
         5 001011   200301 756100                    STQ     @MSG,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:76   
         5 001012   000003 701000 5                  TSX1    WRITE_A_LINE
         5 001013   000000 011000                    NOP     0

      446     9184    2       ALTRETURN;

   9184  5 001014   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 001015   000000 702211                    TSX2  ! 0,X1

      447     9185    2   END JRNL_READ;
      448     9186
      449     9187    1   JRNL_WRITE: PROC;

   9187  5 001016   200276 741300       JRNL_WRITE   STX1  ! @RC_TYP+1,,AUTO

      450     9188
      451     9189    2       FPT_JRNL.V.DCB# = JRNL_DCB#;

   9189  5 001017   002027 720000 0                  LXL0    JRNL_DCB#
         5 001020   002240 740000 0                  STX0    FPT_JRNL+8

      452     9190    2       FPT_JRNL.BUF_=VECTOR(I_O_BUF);

   9190  5 001021   000047 235000 6                  LDA     39
         5 001022   000000 236000 xsym               LDQ     I_O_BUF$
         5 001023   002234 757000 0                  STAQ    FPT_JRNL+4

      453     9191    2       FPT_JRNL.BUF_.BOUND=4095;

   9191  5 001024   002234 236000 0                  LDQ     FPT_JRNL+4
         5 001025   177777 376007                    ANQ     65535,DL
         5 001026   000051 276000 6                  ORQ     41
         5 001027   002234 756000 0                  STQ     FPT_JRNL+4

      454     9192    2       JRNL_KEY.L = 7;

   9192  5 001030   000060 470400 1                  LDP0    JRNL_KEY$
         5 001031   007000 236003                    LDQ     3584,DU
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:77   
         5 001032   000000 552140                    STBQ    0,'40'O,PR0

      455     9193    2       JRNL_KEY.MBZ = 0;

   9193  5 001033   000000 236003                    LDQ     0,DU
         5 001034   000000 552120                    STBQ    0,'20'O,PR0

      456     9194    2       JRNL_KEY.AREA_INDX = AREA_INDX;

   9194  5 001035   002070 721000 0                  LXL1    AREA_INDX
         5 001036   000000 441100                    SXL1    0,,PR0

      457     9195    2       JRNL_KEY.PAGE_NO = DATA_PG.CON_INTRVAL;

   9195  5 001037   000000 471400 xsym               LDP1    DATA$
         5 001040   100004 235100                    LDA     4,,PR1
         5 001041   000001 755100                    STA     1,,PR0

      458     9196    2       CALL M$WRITE(FPT_JRNL) ALTRET(REC_EXIST);

   9196  5 001042   002230 630400 0                  EPPR0   FPT_JRNL
         5 001043   440001 713400                    CLIMB   alt,write
         5 001044   401400 401760                    pmme    nvectors=4
         5 001045   001053 702000 5                  TSX2    REC_EXIST

      459     9197    2       JRNL_CNT=JRNL_CNT+1;

   9197  5 001046   002026 235000 0                  LDA     JRNL_CNT
         5 001047   000001 035007                    ADLA    1,DL
         5 001050   002026 755000 0                  STA     JRNL_CNT

      460     9198    2       RETURN;

   9198  5 001051   200276 221300                    LDX1  ! @RC_TYP+1,,AUTO
         5 001052   000001 702211                    TSX2  ! 1,X1

      461     9199    2   REC_EXIST:
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:78   
      462     9200    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR#~=%E$OLDREC THEN

   9200  5 001053   000000 470400 xsym  REC_EXIST    LDP0    B$TCB$
         5 001054   000000 471500                    LDP1    0,,PR0
         5 001055   100102 236100                    LDQ     66,,PR1
         5 001056   377770 376007                    ANQ     131064,DL
         5 001057   000750 116007                    CMPQ    488,DL
         5 001060   001100 600000 5                  TZE     s:9208

      463     9201    3       DO;

      464     9202    3           MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$EXCFR.ERR;

   9202  5 001061   100102 236100                    LDQ     66,,PR1
         5 001062   000000 756000 xsym               STQ     MSGCODE

      465     9203    3           INCL_ERR=%YES#;

   9203  5 001063   400000 236003                    LDQ     -131072,DU
         5 001064   000000 756000 xsym               STQ     INCL_ERR

      466     9204    3           CALL SYS_FUNC_ERRMSG;

   9204  5 001065   000006 631400 6                  EPPR1   6
         5 001066   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         5 001067   000000 011000                    NOP     0

      467     9205    3           CALL WRITE_A_LINE('A  Error in writing journal file... %');

   9205  5 001070   000052 236000 6                  LDQ     42
         5 001071   200301 756100                    STQ     @MSG,,AUTO
         5 001072   000003 701000 5                  TSX1    WRITE_A_LINE
         5 001073   000000 011000                    NOP     0

      468     9206    3           CALL WRITE_A_LINE('A  Suggest you do a COMMIT command now.%');

   9206  5 001074   000053 236000 6                  LDQ     43
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:79   
         5 001075   200301 756100                    STQ     @MSG,,AUTO
         5 001076   000003 701000 5                  TSX1    WRITE_A_LINE
         5 001077   000000 011000                    NOP     0

      469     9207    3           END;

      470     9208    2   END JRNL_WRITE;

   9208  5 001100   200276 221300                    LDX1  ! @RC_TYP+1,,AUTO
         5 001101   000001 702211                    TSX2  ! 1,X1

      471     9209
      472     9210    1   WRITE_A_PAGE: PROC ALTRET;

   9210  5 001102   200276 741300       WRITE_A_PAGE STX1  ! @RC_TYP+1,,AUTO

      473     9211
      474     9212    2       DCBSF=ZI$DIR.AREA_NM.DCB#;

   9212  5 001103   000244 220000 xsym               LDX0    ZI$DIR+164
         5 001104   000000 740000 xsym               STX0    DCBSF

      475     9213    2       BUFSF=VECTOR(I_O_BUF);

   9213  5 001105   000047 235000 6                  LDA     39
         5 001106   000000 236000 xsym               LDQ     I_O_BUF$
         5 001107   000000 755000 xsym               STA     BUFSF
         5 001110   000001 756000 xsym               STQ     BUFSF+1

      476     9214    2       BUFLNSF=4096;

   9214  5 001111   010000 235007                    LDA     4096,DL
         5 001112   000000 755000 xsym               STA     BUFLNSF

      477     9215    2       FULLSF=%YES#;

   9215  5 001113   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:80   
         5 001114   000000 756000 xsym               STQ     FULLSF

      478     9216    2       KEYSF=%YES#;

   9216  5 001115   000000 756000 xsym               STQ     KEYSF

      479     9217    2       ENCRP_SEEDSF=ZI$DIR.ENCP_SEED;

   9217  5 001116   000027 236000 xsym               LDQ     ZI$DIR+23
         5 001117   000000 756000 xsym               STQ     ENCRP_SEEDSF

      480     9218    2       KEYVSF.LEN=4;

   9218  5 001120   004000 236003                    LDQ     2048,DU
         5 001121   000000 552040 xsym               STBQ    KEYVSF,'40'O

      481     9219    2       KEYVSF.IDSKEY=DATA_PG.CON_INTRVAL;

   9219  5 001122   000000 470400 xsym               LDP0    DATA$
         5 001123   000000 100500                    MLR     fill='000'O
         5 001124   000004 000004                    ADSC9   4,,PR0                   cn=0,n=4
         5 001125   000000 200004 xsym               ADSC9   KEYVSF                   cn=1,n=4

      482     9220    2       VFCSF=%NO#;

   9220  5 001126   000000 450000 xsym               STZ     VFCSF

      483     9221    2       NOTIMESF=%YES#;

   9221  5 001127   400000 236003                    LDQ     -131072,DU
         5 001130   000000 756000 xsym               STQ     NOTIMESF

      484     9222    2       IF CHK_SUM=%YES# THEN

   9222  5 001131   000000 234000 xsym               SZN     CHK_SUM
         5 001132   001141 605000 5                  TPL     s:9227

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:81   
      485     9223    3       DO;

      486     9224    3           CALL CHKSUM;

   9224  5 001133   000006 631400 6                  EPPR1   6
         5 001134   000000 701000 xent               TSX1    CHKSUM
         5 001135   000000 011000                    NOP     0

      487     9225    3           DATA_PG.CHKSUM_WD=ICHKSUM;

   9225  5 001136   000000 470400 xsym               LDP0    DATA$
         5 001137   000000 235000 xsym               LDA     ICHKSUM
         5 001140   000002 755100                    STA     2,,PR0

      488     9226    3           END;

      489     9227    2       CALL SYS_FUNC_WRIT ALTRET(FAIL_UPDATE);

   9227  5 001141   000006 631400 6                  EPPR1   6
         5 001142   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 001143   001146 702000 5                  TSX2    FAIL_UPDATE

      490     9228    2       RETURN;

   9228  5 001144   200276 221300                    LDX1  ! @RC_TYP+1,,AUTO
         5 001145   000001 702211                    TSX2  ! 1,X1

      491     9229    2   FAIL_UPDATE:
      492     9230    2       CALL WRITE_A_LINE('@  Fail to update database, COMMAND aborted%');

   9230  5 001146   000054 236000 6     FAIL_UPDATE  LDQ     44
         5 001147   200301 756100                    STQ     @MSG,,AUTO
         5 001150   000003 701000 5                  TSX1    WRITE_A_LINE
         5 001151   000000 011000                    NOP     0

      493     9231    2       ALTRETURN;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:82   
   9231  5 001152   200276 221300                    LDX1  ! @RC_TYP+1,,AUTO
         5 001153   000000 702211                    TSX2  ! 0,X1

      494     9232    2   END WRITE_A_PAGE;
      495     9233        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:83   
      496     9234
      497     9235    1   CHK_SET: PROC ALTRET;

   9235  5 001154   200272 741300       CHK_SET      STX1  ! AREA_ENCRPT+33,,AUTO

      498     9236
      499     9237    3       DO III=0 TO SC_SIZ;

   9237  5 001155   002003 450000 0                  STZ     III
         5 001156   001170 710000 5                  TRA     s:9239+1

      500     9238    3           IF ITEM_LIST.NAME(0)=SET_NAMES(III) THEN RETURN;

   9238  5 001157   002003 236000 0                  LDQ     III
         5 001160   000036 402007                    MPY     30,DL
         5 001161   040106 106400                    CMPC    fill='040'O
         5 001162   000000 000036 xsym               ADSC9   ITEM_LIST                cn=0,n=30
         5 001163   200003 000036                    ADSC9   SET_NAMES,Q,AUTO         cn=0,n=30
         5 001164   001167 601000 5                  TNZ     s:9239

   9238  5 001165   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 001166   000001 702211                    TSX2  ! 1,X1

      501     9239    3           END;

   9239  5 001167   002003 054000 0                  AOS     III
         5 001170   002003 236000 0                  LDQ     III
         5 001171   000001 116000 0                  CMPQ    SC_SIZ
         5 001172   001157 604400 5                  TMOZ    s:9238

      502     9240    2       CALL WRITE_A_LINE('@    Sorry! you are not repairing this set%');

   9240  5 001173   000055 236000 6                  LDQ     45
         5 001174   200301 756100                    STQ     @MSG,,AUTO
         5 001175   000003 701000 5                  TSX1    WRITE_A_LINE
         5 001176   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:84   
      503     9241    2       ALTRETURN;

   9241  5 001177   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 001200   000000 702211                    TSX2  ! 0,X1

      504     9242    2   END CHK_SET;
      505     9243        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:85   
      506     9244        /***********************************************************
      507     9245
      508     9246                 GET_POINTERS: TO FIND ALL THE N/P/O/PA POINTERS
      509     9247                 FOR THE CURRENT RECORD JUST FOUND, AND TO DETERMINE
      510     9248                 THE ROLL OF THE RECORD FOR THE SET_NAME STORED IN
      511     9249                 ITEM_LIST.NAME(III) I,E, A OWNER/MEMBER/PAREC ETC.
      512     9250
      513     9251        ***********************************************************/
      514     9252
      515     9253    1   GET_POINTERS: PROC(KKK,SSS,RC_TYP) ALTRET;

   9253  5 001201   200272 741300       GET_POINTERS STX1  ! AREA_ENCRPT+33,,AUTO

      516     9254
      517     9255    2   DCL KKK SBIN; /* INPUT: THE DBK SPECIFICATION FOR THE CURR_REC */
      518     9256    2   DCL SSS SBIN; /* INPUT: SET_NAME IN ITEM_LIST.NAME(SSS) */
      519     9257    2   DCL RC_TYP UBIN; /* OUTPUT: TYPE OF RECORD IN THAT SET */
      520     9258
      521     9259    2       RC_TYP = %MEMBER; /* ASSUME THIS REC IS A MEMBER OF THE SET */

   9259  5 001202   200275 470500                    LDP0    @RC_TYP,,AUTO
         5 001203   000000 450100                    STZ     0,,PR0

      522     9260    2       REC_INDX=MSTR_REF.NEXT(CURR_REC);

   9260  5 001204   000000 236000 xsym               LDQ     CURR_REC
         5 001205   000012 402007                    MPY     10,DL
         5 001206   000000 471400 xsym               LDP1    MSTR$
         5 001207   100000 236106                    LDQ     0,QL,PR1
         5 001210   000022 736000                    QLS     18
         5 001211   000022 732000                    QRS     18
         5 001212   002017 756000 0                  STQ     REC_INDX

      523     9261    3       DO WHILE (REC_INDX>=0);

   9261  5 001213   001767 604000 5                  TMI     s:9321

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:86   
      524     9262    3           MSTR_INDX=SET_XREF.MSTRINDX(REC_INDX); /* LOOP THRU SET_XREF */

   9262  5 001214   002017 235000 0                  LDA     REC_INDX
         5 001215   000002 735000                    ALS     2
         5 001216   000000 470400 xsym               LDP0    SET_XREF$
         5 001217   000000 236105                    LDQ     0,AL,PR0
         5 001220   000022 732000                    QRS     18
         5 001221   000000 756000 xsym               STQ     MSTR_INDX

      525     9263    3           IF ITEM_LIST.NAME(SSS)=MSTR_REF.NAME(MSTR_INDX) THEN

   9263  5 001222   200274 471500                    LDP1    @SSS,,AUTO
         5 001223   100000 235100                    LDA     0,,PR1
         5 001224   000003 735000                    ALS     3
         5 001225   000002 735000                    ALS     2
         5 001226   200310 755100                    STA     @INDX+1,,AUTO
         5 001227   000050 402007                    MPY     40,DL
         5 001230   200310 235100                    LDA     @INDX+1,,AUTO
         5 001231   000000 473400 xsym               LDP3    MSTR$
         5 001232   040106 106405                    CMPC    fill='040'O
         5 001233   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30
         5 001234   300001 400036                    ADSC9   1,Q,PR3                  cn=2,n=30
         5 001235   001760 601000 5                  TNZ     s:9319

      526     9264    4           DO;

      527     9265    4               IF MSTR_REF.SET.PATYPE(MSTR_INDX)='1'B THEN

   9265  5 001236   000000 236000 xsym               LDQ     MSTR_INDX
         5 001237   000012 402007                    MPY     10,DL
         5 001240   300011 236106                    LDQ     9,QL,PR3
         5 001241   000002 316003                    CANQ    2,DU
         5 001242   001246 600000 5                  TZE     s:9267

      528     9266    4                   RC_TYP=%PA_MEM; /* NOW ASSUME MEMBER OF PA SET */

   9266  5 001243   000010 235007                    LDA     8,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:87   
         5 001244   200275 474500                    LDP4    @RC_TYP,,AUTO
         5 001245   400000 755100                    STA     0,,PR4

      529     9267    4               IF MSTR_REF.PAOFF(CURR_REC)>0 THEN

   9267  5 001246   000000 236000 xsym               LDQ     CURR_REC
         5 001247   000012 402007                    MPY     10,DL
         5 001250   000000 470400 xsym               LDP0    MSTR$
         5 001251   000011 236106                    LDQ     9,QL,PR0
         5 001252   777000 316003                    CANQ    -512,DU
         5 001253   001257 600000 5                  TZE     s:9269

      530     9268    4                   RC_TYP=%PA_RC; /* NOW WE KNOW IT IS *PA_REC */

   9268  5 001254   000004 235007                    LDA     4,DL
         5 001255   200275 473500                    LDP3    @RC_TYP,,AUTO
         5 001256   300000 755100                    STA     0,,PR3

      531     9269    4               IF PA_DBK.FIR(KKK)>0 THEN /* PA ENTRY NUMBER SPECIFIED */

   9269  5 001257   200273 470500                    LDP0    @KKK,,AUTO
         5 001260   000000 235100                    LDA     0,,PR0
         5 001261   000001 735000                    ALS     1
         5 001262   002132 235005 0                  LDA     PA_DBK,AL
         5 001263   001652 604400 5                  TMOZ    s:9305

      532     9270    5               DO;

      533     9271    5                   IF RC_TYP~=%PA_RC THEN /* BUT THIS ISNT A PA REC */

   9271  5 001264   200275 473500                    LDP3    @RC_TYP,,AUTO
         5 001265   300000 235100                    LDA     0,,PR3
         5 001266   000004 115007                    CMPA    4,DL
         5 001267   002031 601000 5                  TNZ     NOT_PA_REC

      534     9272    5                       GOTO NOT_PA_REC;
      535     9273    5                   RC_TYP = %PA_ENT; /* RC TYPE IS PA REC WITH ENTRY */
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:88   

   9273  5 001270   000020 236007                    LDQ     16,DL
         5 001271   300000 756100                    STQ     0,,PR3

      536     9274    5                   PTR_SIZE=(MSTR_REF.PAOFF(CURR_REC)-2*4)/3;

   9274  5 001272   000000 236000 xsym               LDQ     CURR_REC
         5 001273   000012 402007                    MPY     10,DL
         5 001274   000000 474400 xsym               LDP4    MSTR$
         5 001275   400011 236106                    LDQ     9,QL,PR4
         5 001276   000033 772000                    QRL     27
         5 001277   000010 136007                    SBLQ    8,DL
         5 001300   000003 506007                    DIV     3,DL
         5 001301   000000 756000 xsym               STQ     PTR_SIZE

      537     9275    5                   CALL CONV_DBK(PA_DBK.FIR(KKK),BUF,V3);

   9275  5 001302   000000 235100                    LDA     0,,PR0
         5 001303   200310 755100                    STA     @INDX+1,,AUTO
         5 001304   000056 237000 6                  LDAQ    46
         5 001305   200306 757100                    STAQ    @DBK_TXT,,AUTO
         5 001306   200310 236100                    LDQ     @INDX+1,,AUTO
         5 001307   000023 736000                    QLS     19
         5 001310   000060 036000 6                  ADLQ    48
         5 001311   200305 756100                    STQ     @DBK_BIN,,AUTO
         5 001312   000721 701000 5                  TSX1    CONV_DBK
         5 001313   000000 011000                    NOP     0

      538     9276    5                   DBK_REC_SIZE=V1+V2+V3+3;

   9276  5 001314   002006 236000 0                  LDQ     V1
         5 001315   002007 036000 0                  ADLQ    V2
         5 001316   002010 036000 0                  ADLQ    V3
         5 001317   000003 036007                    ADLQ    3,DL
         5 001320   002022 756000 0                  STQ     DBK_REC_SIZE

      539     9277    5                   CALL CONCAT(DBK_REC,ADDR(DBK_CUR)->DBK_V,'.',
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:89   

   9277  5 001321   002006 720000 0                  LXL0    V1
         5 001322   002023 470400 0                  LDP0    DBK_REC$
         5 001323   000000 621006                    EAX1    0,QL
         5 001324   040140 100440                    MLR     fill='040'O
         5 001325   002062 000010 0                  ADSC9   DBK_CUR                  cn=0,n=*X0
         5 001326   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         5 001327   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 001330   002006 136000 0                  SBLQ    V1
         5 001331   001407 604400 5                  TMOZ    s:9280
         5 001332   000000 620006                    EAX0    0,QL
         5 001333   002006 235000 0                  LDA     V1
         5 001334   040145 100400                    MLR     fill='040'O
         5 001335   000061 000001 6                  ADSC9   49                       cn=0,n=1
         5 001336   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         5 001337   000001 116007                    CMPQ    1,DL
         5 001340   001407 604400 5                  TMOZ    s:9280
         5 001341   777777 620006                    EAX0    -1,QL
         5 001342   002010 721000 0                  LXL1    V3
         5 001343   002006 235000 0                  LDA     V1
         5 001344   040145 100440                    MLR     fill='040'O
         5 001345   002036 000011 0                  ADSC9   BUF                      cn=0,n=*X1
         5 001346   000000 200010                    ADSC9   0,A,PR0                  cn=1,n=*X0
         5 001347   002010 136000 0                  SBLQ    V3
         5 001350   000001 116007                    CMPQ    1,DL
         5 001351   001407 604400 5                  TMOZ    s:9280
         5 001352   200310 756100                    STQ     @INDX+1,,AUTO
         5 001353   002006 236000 0                  LDQ     V1
         5 001354   002010 036000 0                  ADLQ    V3
         5 001355   200310 720100                    LXL0    @INDX+1,,AUTO
         5 001356   777777 621010                    EAX1    -1,X0
         5 001357   040146 100400                    MLR     fill='040'O
         5 001360   000062 000001 6                  ADSC9   50                       cn=0,n=1
         5 001361   000000 200011                    ADSC9   0,Q,PR0                  cn=1,n=*X1
         5 001362   200311 756100                    STQ     @INDX+2,,AUTO
         5 001363   200310 236100                    LDQ     @INDX+1,,AUTO
         5 001364   000002 116007                    CMPQ    2,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:90   
         5 001365   001407 604400 5                  TMOZ    s:9280
         5 001366   777776 622006                    EAX2    -2,QL
         5 001367   002007 723000 0                  LXL3    V2
         5 001370   200311 235100                    LDA     @INDX+2,,AUTO
         5 001371   040145 100440                    MLR     fill='040'O
         5 001372   000000 200013 xsym               ADSC9   REC_HDR                  cn=1,n=*X3
         5 001373   000000 400012                    ADSC9   0,A,PR0                  cn=2,n=*X2
         5 001374   002007 136000 0                  SBLQ    V2
         5 001375   000002 116007                    CMPQ    2,DL
         5 001376   001407 604400 5                  TMOZ    s:9280
         5 001377   200312 756100                    STQ     @INDX+3,,AUTO
         5 001400   200311 236100                    LDQ     @INDX+2,,AUTO
         5 001401   002007 036000 0                  ADLQ    V2
         5 001402   200312 723100                    LXL3    @INDX+3,,AUTO
         5 001403   777776 624013                    EAX4    -2,X3
         5 001404   040146 100400                    MLR     fill='040'O
         5 001405   000063 000001 6                  ADSC9   51                       cn=0,n=1
         5 001406   000000 400014                    ADSC9   0,Q,PR0                  cn=2,n=*X4

      540     9278    5                      ADDR(BUF)->DBP_V,'(',
      541     9279    5                      ADDR(REC_HDR.REC_NM)->REC_V,')');
      542     9280    5                   IF PA_REC.ENTRIES < PA_DBK.FIR(KKK) THEN

   9280  5 001407   200273 471500                    LDP1    @KKK,,AUTO
         5 001410   100000 235100                    LDA     0,,PR1
         5 001411   000001 735000                    ALS     1
         5 001412   000000 620005                    EAX0    0,AL
         5 001413   000000 473400 xsym               LDP3    REC$
         5 001414   003100 061500                    CSR     bolr='003'O
         5 001415   300001 060014                    BDSC    1,,PR3                   by=0,bit=6,n=12
         5 001416   200310 000044                    BDSC    @INDX+1,,AUTO            by=0,bit=0,n=36
         5 001417   200310 236100                    LDQ     @INDX+1,,AUTO
         5 001420   002132 116010 0                  CMPQ    PA_DBK,X0
         5 001421   002102 604000 5                  TMI     BAD_ENTRY_NO

      543     9281    5                       GOTO BAD_ENTRY_NO; /* ENTRY TOO BIG */
      544     9282    5                   ENTRY$=PINCRC(REC$,MSTR_REF.PAOFF(CURR_REC)+
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:91   

   9282  5 001422   100000 235100                    LDA     0,,PR1
         5 001423   000000 236000 xsym               LDQ     CURR_REC
         5 001424   200310 755100                    STA     @INDX+1,,AUTO
         5 001425   000012 402007                    MPY     10,DL
         5 001426   000000 474400 xsym               LDP4    MSTR$
         5 001427   400011 236106                    LDQ     9,QL,PR4
         5 001430   000064 376000 6                  ANQ     52
         5 001431   200311 756100                    STQ     @INDX+2,,AUTO
         5 001432   200310 235100                    LDA     @INDX+1,,AUTO
         5 001433   000001 735000                    ALS     1
         5 001434   002132 236005 0                  LDQ     PA_DBK,AL
         5 001435   000001 136007                    SBLQ    1,DL
         5 001436   200311 402100                    MPY     @INDX+2,,AUTO
         5 001437   200312 756100                    STQ     @INDX+3,,AUTO
         5 001440   000000 236000 xsym               LDQ     CURR_REC
         5 001441   000012 402007                    MPY     10,DL
         5 001442   400011 236106                    LDQ     9,QL,PR4
         5 001443   000033 772000                    QRL     27
         5 001444   200313 756100                    STQ     @INDX+4,,AUTO
         5 001445   200312 236100                    LDQ     @INDX+3,,AUTO
         5 001446   200313 036100                    ADLQ    @INDX+4,,AUTO
         5 001447   000020 736000                    QLS     16
         5 001450   000000 036000 xsym               ADLQ    REC$
         5 001451   000000 756000 xsym               STQ     ENTRY$

      545     9283    5                      (PA_DBK.FIR(KKK)-1)*MSTR_REF.PAENT(CURR_REC));
      546     9284    5                   X=0;

   9284  5 001452   000000 450000 xsym               STZ     X

      547     9285    5                   PINCRC(ADDR(X),4-PTR_SIZE)->PTR_V=PA_ENTRY.PTRS;

   9285  5 001453   000000 235003                    LDA     0,DU
         5 001454   000000 135000 xsym               SBLA    PTR_SIZE
         5 001455   000000 475400 xsym               LDP5    ENTRY$
         5 001456   000000 720000 xsym               LXL0    PTR_SIZE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:92   
         5 001457   040045 100540                    MLR     fill='040'O
         5 001460   500000 400010                    ADSC9   0,,PR5                   cn=2,n=*X0
         5 001461   000001 000010 xsym               ADSC9   X+1,A                    cn=0,n=*X0

      548     9286    5                   SET_PA$=ADDR(PA_ENTRY.PTRS);

   9286  5 001462   400000 036007                    ADLQ    -131072,DL
         5 001463   002024 756000 0                  STQ     SET_PA$

      549     9287    5                   IF PA_ENTRY.C=1 THEN

   9287  5 001464   003100 061500                    CSR     bolr='003'O
         5 001465   500000 000001                    BDSC    0,,PR5                   by=0,bit=0,n=1
         5 001466   200310 000044                    BDSC    @INDX+1,,AUTO            by=0,bit=0,n=36
         5 001467   200310 236100                    LDQ     @INDX+1,,AUTO
         5 001470   000001 116007                    CMPQ    1,DL
         5 001471   001646 601000 5                  TNZ     s:9302

      550     9288    6                   DO;

      551     9289    6                       GROUP$=PINCRC(REC$,X);

   9289  5 001472   000000 236000 xsym               LDQ     X
         5 001473   000020 736000                    QLS     16
         5 001474   000000 036000 xsym               ADLQ    REC$
         5 001475   000000 756000 xsym               STQ     GROUP$

      552     9290    6                       IF PA_DBK.SEC(KKK)=0 THEN

   9290  5 001476   100000 235100                    LDA     0,,PR1
         5 001477   000001 735000                    ALS     1
         5 001500   002133 235005 0                  LDA     PA_DBK+1,AL
         5 001501   002052 600000 5                  TZE     NO_GROUP_INDX

      553     9291    6                           GOTO NO_GROUP_INDX;
      554     9292    6                       CALL CONV_DBK(PA_DBK.SEC(KKK),BUF2.SEC,V4);

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:93   
   9292  5 001502   100000 235100                    LDA     0,,PR1
         5 001503   200310 755100                    STA     @INDX+1,,AUTO
         5 001504   000066 237000 6                  LDAQ    54
         5 001505   200306 757100                    STAQ    @DBK_TXT,,AUTO
         5 001506   200310 236100                    LDQ     @INDX+1,,AUTO
         5 001507   000023 736000                    QLS     19
         5 001510   000065 036000 6                  ADLQ    53
         5 001511   200305 756100                    STQ     @DBK_BIN,,AUTO
         5 001512   000721 701000 5                  TSX1    CONV_DBK
         5 001513   000000 011000                    NOP     0

      555     9293    6                       DBK_REC_SIZE=1+V1+V3;

   9293  5 001514   002006 236000 0                  LDQ     V1
         5 001515   002010 036000 0                  ADLQ    V3
         5 001516   000001 036007                    ADLQ    1,DL
         5 001517   002022 756000 0                  STQ     DBK_REC_SIZE

      556     9294    6                       CALL CONCAT(RBUF,DBK_REC,'.',ADDR(BUF2.SEC)->DBO_V,

   9294  5 001520   002023 470400 0                  LDP0    DBK_REC$
         5 001521   000000 620006                    EAX0    0,QL
         5 001522   040000 100540                    MLR     fill='040'O
         5 001523   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 001524   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256
         5 001525   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 001526   000400 116007                    CMPQ    256,DL
         5 001527   001610 603000 5                  TRC     s:9296
         5 001530   777377 620006                    EAX0    -257,QL
         5 001531   777777 660003                    ERX0    -1,DU
         5 001532   040046 100400                    MLR     fill='040'O
         5 001533   000061 000001 6                  ADSC9   49                       cn=0,n=1
         5 001534   000000 000010 xsym               ADSC9   RBUF,Q                   cn=0,n=*X0
         5 001535   000377 116007                    CMPQ    255,DL
         5 001536   001610 603000 5                  TRC     s:9296
         5 001537   777400 621006                    EAX1    -256,QL
         5 001540   777777 661003                    ERX1    -1,DU
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:94   
         5 001541   002011 722000 0                  LXL2    V4
         5 001542   040046 100440                    MLR     fill='040'O
         5 001543   002050 000012 0                  ADSC9   BUF+10                   cn=0,n=*X2
         5 001544   000000 200011 xsym               ADSC9   RBUF,Q                   cn=1,n=*X1
         5 001545   002011 036000 0                  ADLQ    V4
         5 001546   000377 116007                    CMPQ    255,DL
         5 001547   001610 603000 5                  TRC     s:9296
         5 001550   200310 756100                    STQ     @INDX+1,,AUTO
         5 001551   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 001552   002011 036000 0                  ADLQ    V4
         5 001553   200310 723100                    LXL3    @INDX+1,,AUTO
         5 001554   777400 623013                    EAX3    -256,X3
         5 001555   777777 663003                    ERX3    -1,DU
         5 001556   040046 100400                    MLR     fill='040'O
         5 001557   000062 000001 6                  ADSC9   50                       cn=0,n=1
         5 001560   000000 200013 xsym               ADSC9   RBUF,Q                   cn=1,n=*X3
         5 001561   200311 756100                    STQ     @INDX+2,,AUTO
         5 001562   200310 236100                    LDQ     @INDX+1,,AUTO
         5 001563   000376 116007                    CMPQ    254,DL
         5 001564   001610 603000 5                  TRC     s:9296
         5 001565   777401 624006                    EAX4    -255,QL
         5 001566   777777 664003                    ERX4    -1,DU
         5 001567   002007 725000 0                  LXL5    V2
         5 001570   200311 235100                    LDA     @INDX+2,,AUTO
         5 001571   040045 100440                    MLR     fill='040'O
         5 001572   000000 200015 xsym               ADSC9   REC_HDR                  cn=1,n=*X5
         5 001573   000000 400014 xsym               ADSC9   RBUF,A                   cn=2,n=*X4
         5 001574   002007 036000 0                  ADLQ    V2
         5 001575   000376 116007                    CMPQ    254,DL
         5 001576   001610 603000 5                  TRC     s:9296
         5 001577   200312 756100                    STQ     @INDX+3,,AUTO
         5 001600   200311 236100                    LDQ     @INDX+2,,AUTO
         5 001601   002007 036000 0                  ADLQ    V2
         5 001602   200312 726100                    LXL6    @INDX+3,,AUTO
         5 001603   777401 626016                    EAX6    -255,X6
         5 001604   777777 666003                    ERX6    -1,DU
         5 001605   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:95   
         5 001606   000063 000001 6                  ADSC9   51                       cn=0,n=1
         5 001607   000000 400016 xsym               ADSC9   RBUF,Q                   cn=2,n=*X6

      557     9295    6                          '(',ADDR(REC_HDR.REC_NM)->REC_V,')');
      558     9296    6                       DBK_REC_SIZE=V1+V2+V3+V4+4;

   9296  5 001610   002006 236000 0                  LDQ     V1
         5 001611   002007 036000 0                  ADLQ    V2
         5 001612   002010 036000 0                  ADLQ    V3
         5 001613   002011 036000 0                  ADLQ    V4
         5 001614   000004 036007                    ADLQ    4,DL
         5 001615   002022 756000 0                  STQ     DBK_REC_SIZE

      559     9297    6                       IF PA_GROUP.NO_GROUPS < PA_DBK.SEC(KKK) THEN

   9297  5 001616   200273 471500                    LDP1    @KKK,,AUTO
         5 001617   100000 235100                    LDA     0,,PR1
         5 001620   000001 735000                    ALS     1
         5 001621   000000 620005                    EAX0    0,AL
         5 001622   000000 473400 xsym               LDP3    GROUP$
         5 001623   000100 101500                    MRL     fill='000'O
         5 001624   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         5 001625   200310 000004                    ADSC9   @INDX+1,,AUTO            cn=0,n=4
         5 001626   200310 236100                    LDQ     @INDX+1,,AUTO
         5 001627   002133 116010 0                  CMPQ    PA_DBK+1,X0
         5 001630   002062 604000 5                  TMI     BAD_GROUP_NO

      560     9298    6                           GOTO BAD_GROUP_NO;
      561     9299    6                       SET_PA$=PINCRC(GROUP$,(PA_DBK.SEC(KKK)-1)*(2+PTR_SIZE)+4);

   9299  5 001631   100000 235100                    LDA     0,,PR1
         5 001632   000000 236000 xsym               LDQ     PTR_SIZE
         5 001633   000002 036007                    ADLQ    2,DL
         5 001634   200310 756100                    STQ     @INDX+1,,AUTO
         5 001635   000001 735000                    ALS     1
         5 001636   002133 236005 0                  LDQ     PA_DBK+1,AL
         5 001637   000001 136007                    SBLQ    1,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:96   
         5 001640   200310 402100                    MPY     @INDX+1,,AUTO
         5 001641   000020 736000                    QLS     16
         5 001642   000001 036003                    ADLQ    1,DU
         5 001643   000000 036000 xsym               ADLQ    GROUP$
         5 001644   002024 756000 0                  STQ     SET_PA$

      562     9300    6                       END;

   9300  5 001645   001652 710000 5                  TRA     s:9305

      563     9301    5                   ELSE
      564     9302    5                       IF PA_DBK.SEC(KKK)>0 THEN /* IF ENTRY HAS NO GROUP */

   9302  5 001646   100000 235100                    LDA     0,,PR1
         5 001647   000001 735000                    ALS     1
         5 001650   002133 235005 0                  LDA     PA_DBK+1,AL
         5 001651   002072 605400 5                  TPNZ    EXTRA_GROUP

      565     9303    5                           GOTO EXTRA_GROUP; /* BUT SPECIFIED (MISTYPED) */
      566     9304    5                   END;

      567     9305    4               IF CURR_REC=REC_XREF.MSTRINDX(MSTR_REF.NEXT(MSTR_INDX)) THEN

   9305  5 001652   000000 236000 xsym               LDQ     MSTR_INDX
         5 001653   000012 402007                    MPY     10,DL
         5 001654   000000 470400 xsym               LDP0    MSTR$
         5 001655   000000 236106                    LDQ     0,QL,PR0
         5 001656   000022 736000                    QLS     18
         5 001657   000022 732000                    QRS     18
         5 001660   000000 471400 xsym               LDP1    REC_XREF$
         5 001661   100000 236106                    LDQ     0,QL,PR1
         5 001662   000001 772000                    QRL     1
         5 001663   377777 376007                    ANQ     131071,DL
         5 001664   000000 116000 xsym               CMPQ    CURR_REC
         5 001665   001671 601000 5                  TNZ     s:9307

      568     9306    4                   RC_TYP=%OWNER; /* THIS REC IS THE OWNER OF THIS SET */
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:97   

   9306  5 001666   000001 235007                    LDA     1,DL
         5 001667   200275 473500                    LDP3    @RC_TYP,,AUTO
         5 001670   300000 755100                    STA     0,,PR3

      569     9307    4               CALL GET_PTR(SET_XREF.EIS.PRIOR(REC_INDX),P_K,SET_HDR.PRIOR,V3);

   9307  5 001671   000057 236000 6                  LDQ     47
         5 001672   200302 756100                    STQ     @TXT+1,,AUTO
         5 001673   000070 237000 6                  LDAQ    56
         5 001674   200300 757100                    STAQ    @EIS+1,,AUTO
         5 001675   002017 236000 0                  LDQ     REC_INDX
         5 001676   000024 736000                    QLS     20
         5 001677   000001 036003                    ADLQ    1,DU
         5 001700   000000 036000 xsym               ADLQ    SET_XREF$
         5 001701   200277 756100                    STQ     @RC_TYP+2,,AUTO
         5 001702   002117 701000 5                  TSX1    GET_PTR
         5 001703   000000 011000                    NOP     0

      570     9308    4               CALL GET_PTR(SET_XREF.EIS.OWNR(REC_INDX),O_K,SET_HDR.OWNER,V4);

   9308  5 001704   000067 236000 6                  LDQ     55
         5 001705   200302 756100                    STQ     @TXT+1,,AUTO
         5 001706   000072 237000 6                  LDAQ    58
         5 001707   200300 757100                    STAQ    @EIS+1,,AUTO
         5 001710   002017 236000 0                  LDQ     REC_INDX
         5 001711   000024 736000                    QLS     20
         5 001712   000002 036003                    ADLQ    2,DU
         5 001713   000000 036000 xsym               ADLQ    SET_XREF$
         5 001714   200277 756100                    STQ     @RC_TYP+2,,AUTO
         5 001715   002117 701000 5                  TSX1    GET_PTR
         5 001716   000000 011000                    NOP     0

      571     9309    4               CALL GET_PTR(SET_XREF.EIS.NEXT(REC_INDX),N_K,SET_HDR.NEXT,V5);

   9309  5 001717   000074 236000 6                  LDQ     60
         5 001720   200302 756100                    STQ     @TXT+1,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:98   
         5 001721   000076 237000 6                  LDAQ    62
         5 001722   200300 757100                    STAQ    @EIS+1,,AUTO
         5 001723   002017 236000 0                  LDQ     REC_INDX
         5 001724   000024 736000                    QLS     20
         5 001725   000003 036003                    ADLQ    3,DU
         5 001726   000000 036000 xsym               ADLQ    SET_XREF$
         5 001727   200277 756100                    STQ     @RC_TYP+2,,AUTO
         5 001730   002117 701000 5                  TSX1    GET_PTR
         5 001731   000000 011000                    NOP     0

      572     9310    4               IF RC_TYP=%PA_ENT THEN

   9310  5 001732   200275 470500                    LDP0    @RC_TYP,,AUTO
         5 001733   000000 235100                    LDA     0,,PR0
         5 001734   000020 115007                    CMPA    16,DL
         5 001735   001751 601000 5                  TNZ     s:9316

      573     9311    5               DO;

      574     9312    5                   SET$=SET_PA$; /* RESTORE PTR TO THE PA_POINTER ADDR */

   9312  5 001736   002024 236000 0                  LDQ     SET_PA$
         5 001737   000000 756000 xsym               STQ     SET$

      575     9313    5                   CALL GET_PTR(-1,X,PA_POINTER,V6);

   9313  5 001740   000100 236000 6                  LDQ     64
         5 001741   200302 756100                    STQ     @TXT+1,,AUTO
         5 001742   000102 237000 6                  LDAQ    66
         5 001743   200300 757100                    STAQ    @EIS+1,,AUTO
         5 001744   000104 236000 6                  LDQ     68
         5 001745   200277 756100                    STQ     @RC_TYP+2,,AUTO
         5 001746   002117 701000 5                  TSX1    GET_PTR
         5 001747   000000 011000                    NOP     0

      576     9314    5                   END;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:99   
   9314  5 001750   001756 710000 5                  TRA     s:9317

      577     9315    4               ELSE
      578     9316    4                   REC_TYPE=MSTR_REF.TYPE(CURR_REC); /* REM THE RC */

   9316  5 001751   000000 236000 xsym               LDQ     CURR_REC
         5 001752   000012 402007                    MPY     10,DL
         5 001753   000000 471400 xsym               LDP1    MSTR$
         5 001754   100000 220106                    LDX0    0,QL,PR1
         5 001755   002020 740000 0                  STX0    REC_TYPE

      579     9317    4               RETURN;

   9317  5 001756   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 001757   000001 702211                    TSX2  ! 1,X1

      580     9318    4               END;
      581     9319    3           REC_INDX=SET_XREF.NEXT(REC_INDX);

   9319  5 001760   002017 235000 0                  LDA     REC_INDX
         5 001761   000002 735000                    ALS     2
         5 001762   000000 236105                    LDQ     0,AL,PR0
         5 001763   000022 736000                    QLS     18
         5 001764   000022 732000                    QRS     18
         5 001765   002017 756000 0                  STQ     REC_INDX

      582     9320    3           END;

   9320  5 001766   001214 605000 5                  TPL     s:9262

      583     9321    2       IF FUNC_CODE=#DISP2 THEN ALTRETURN;

   9321  5 001767   002126 236000 0                  LDQ     FUNC_CODE
         5 001770   777000 376003                    ANQ     -512,DU
         5 001771   004000 116003                    CMPQ    2048,DU
         5 001772   001775 601000 5                  TNZ     s:9322

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:100  
   9321  5 001773   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 001774   000000 702211                    TSX2  ! 0,X1

      584     9322    2       CALL CONCAT(BUF,'a    ',DBK_REC,

   9322  5 001775   200274 470500                    LDP0    @SSS,,AUTO
         5 001776   000000 235100                    LDA     0,,PR0
         5 001777   000003 735000                    ALS     3
         5 002000   040000 100400                    MLR     fill='040'O
         5 002001   000075 000005 1                  ADSC9   DCB_LO+10                cn=0,n=5
         5 002002   002036 000005 0                  ADSC9   BUF                      cn=0,n=5
         5 002003   002023 471400 0                  LDP1    DBK_REC$
         5 002004   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 002005   040000 100540                    MLR     fill='040'O
         5 002006   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 002007   002037 200113 0                  ADSC9   BUF+1                    cn=1,n=75
         5 002010   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 002011   000113 116007                    CMPQ    75,DL
         5 002012   002030 603000 5                  TRC     s:9324
         5 002013   777664 621006                    EAX1    -76,QL
         5 002014   777777 661003                    ERX1    -1,DU
         5 002015   040046 100400                    MLR     fill='040'O
         5 002016   000225 000030 1                  ADSC9   DCB_LO+98                cn=0,n=24
         5 002017   002037 200011 0                  ADSC9   BUF+1,Q                  cn=1,n=*X1
         5 002020   000063 116007                    CMPQ    51,DL
         5 002021   002030 603000 5                  TRC     s:9324
         5 002022   000002 735000                    ALS     2
         5 002023   777714 622006                    EAX2    -52,QL
         5 002024   777777 662003                    ERX2    -1,DU
         5 002025   040046 100405                    MLR     fill='040'O
         5 002026   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30
         5 002027   002045 200012 0                  ADSC9   BUF+7,Q                  cn=1,n=*X2

      585     9323    2          ' is not a tenant in set ',ITEM_LIST.NAME(SSS));
      586     9324    2       GOTO ALT_RETURN;

   9324  5 002030   002111 710000 5                  TRA     ALT_RETURN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:101  

      587     9325    2   NOT_PA_REC:
      588     9326    2       CALL CONCAT(BUF,'a    ',DBK_REC,' is not a PA record');

   9326  5 002031   040000 100400       NOT_PA_REC   MLR     fill='040'O
         5 002032   000075 000005 1                  ADSC9   DCB_LO+10                cn=0,n=5
         5 002033   002036 000005 0                  ADSC9   BUF                      cn=0,n=5
         5 002034   002023 474400 0                  LDP4    DBK_REC$
         5 002035   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 002036   040000 100540                    MLR     fill='040'O
         5 002037   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
         5 002040   002037 200113 0                  ADSC9   BUF+1                    cn=1,n=75
         5 002041   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 002042   000113 116007                    CMPQ    75,DL
         5 002043   002051 603000 5                  TRC     s:9327
         5 002044   777664 621006                    EAX1    -76,QL
         5 002045   777777 661003                    ERX1    -1,DU
         5 002046   040046 100400                    MLR     fill='040'O
         5 002047   000233 000023 1                  ADSC9   DCB_LO+104               cn=0,n=19
         5 002050   002037 200011 0                  ADSC9   BUF+1,Q                  cn=1,n=*X1

      589     9327    2       GOTO ALT_RETURN;

   9327  5 002051   002111 710000 5                  TRA     ALT_RETURN

      590     9328    2   NO_GROUP_INDX:
      591     9329    2       CALL CONCAT(BUF,'a    Require PA group index to identify ',DBK_REC);

   9329  5 002052   040000 100400       NO_GROUP_IN* MLR     fill='040'O
         5 002053   000240 000050 1                  ADSC9   DCB_LO+109               cn=0,n=40
         5 002054   002036 000050 0                  ADSC9   BUF                      cn=0,n=40
         5 002055   002022 721000 0                  LXL1    DBK_REC_SIZE
         5 002056   040000 100540                    MLR     fill='040'O
         5 002057   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         5 002060   002050 000050 0                  ADSC9   BUF+10                   cn=0,n=40

      592     9330    2       GOTO ALT_RETURN;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:102  

   9330  5 002061   002111 710000 5                  TRA     ALT_RETURN

      593     9331    2   BAD_GROUP_NO:
      594     9332    2       CALL CONCAT(BUF,'a    PA group index too big in ',DBK_REC);

   9332  5 002062   040000 100400       BAD_GROUP_NO MLR     fill='040'O
         5 002063   000252 000037 1                  ADSC9   DCB_LO+119               cn=0,n=31
         5 002064   002036 000037 0                  ADSC9   BUF                      cn=0,n=31
         5 002065   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 002066   040000 100540                    MLR     fill='040'O
         5 002067   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 002070   002045 600061 0                  ADSC9   BUF+7                    cn=3,n=49

      595     9333    2       GOTO ALT_RETURN;

   9333  5 002071   002111 710000 5                  TRA     ALT_RETURN

      596     9334    2   EXTRA_GROUP:
      597     9335    2       CALL CONCAT(BUF,'a    No need of PA group index in ',DBK_REC);

   9335  5 002072   040000 100400       EXTRA_GROUP  MLR     fill='040'O
         5 002073   000262 000042 1                  ADSC9   DCB_LO+127               cn=0,n=34
         5 002074   002036 000042 0                  ADSC9   BUF                      cn=0,n=34
         5 002075   002022 721000 0                  LXL1    DBK_REC_SIZE
         5 002076   040000 100540                    MLR     fill='040'O
         5 002077   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         5 002100   002046 400056 0                  ADSC9   BUF+8                    cn=2,n=46

      598     9336    2       GOTO ALT_RETURN;

   9336  5 002101   002111 710000 5                  TRA     ALT_RETURN

      599     9337    2   BAD_ENTRY_NO:
      600     9338    2       CALL CONCAT(BUF,'a    PA entry index too big in ',DBK_REC);

   9338  5 002102   040000 100400       BAD_ENTRY_NO MLR     fill='040'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:103  
         5 002103   000273 000037 1                  ADSC9   DCB_LO+136               cn=0,n=31
         5 002104   002036 000037 0                  ADSC9   BUF                      cn=0,n=31
         5 002105   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 002106   040000 100540                    MLR     fill='040'O
         5 002107   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 002110   002045 600061 0                  ADSC9   BUF+7                    cn=3,n=49

      601     9339    2   ALT_RETURN:
      602     9340    2       CALL WRITE_A_LINE;

   9340  5 002111   000000 236000 6     ALT_RETURN   LDQ     0
         5 002112   200301 756100                    STQ     @MSG,,AUTO
         5 002113   000003 701000 5                  TSX1    WRITE_A_LINE
         5 002114   000000 011000                    NOP     0

      603     9341    2       ALTRETURN;

   9341  5 002115   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 002116   000000 702211                    TSX2  ! 0,X1

      604     9342    2   END GET_POINTERS;
      605     9343        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:104  
      606     9344    1   GET_PTR: PROC(EIS,DBK,TXT,INDX);

   9344  5 002117   200276 741300       GET_PTR      STX1  ! @RC_TYP+1,,AUTO

      607     9345
      608     9346    2   DCL 1 EIS ALIGNED,
      609     9347    2         2 * UBIN(3) UNAL,
      610     9348    2         2 WD_OFST UBIN(15) UNAL,
      611     9349    2         2 BY_OFST UBIN(3) UNAL,
      612     9350    2         2 * UBIN(3) UNAL,
      613     9351    2         2 PTR_SZ SBIN(12) UNAL;
      614     9352    2   DCL DBK UBIN ALIGNED;
      615     9353    2   DCL TXT CHAR(10) CALIGNED;
      616     9354    2   DCL INDX SBIN ALIGNED;
      617     9355
      618     9356    2       TXT = ' ';

   9356  5 002120   200301 470500                    LDP0    @TXT,,AUTO
         5 002121   040100 100400                    MLR     fill='040'O
         5 002122   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 002123   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10

      619     9357    2       INDX=0;

   9357  5 002124   200302 471500                    LDP1    @INDX,,AUTO
         5 002125   100000 450100                    STZ     0,,PR1

      620     9358    2       DBK=0;

   9358  5 002126   200300 473500                    LDP3    @DBK,,AUTO
         5 002127   300000 450100                    STZ     0,,PR3

      621     9359    2       IF EIS.PTR_SZ=0 THEN RETURN;

   9359  5 002130   200277 474500                    LDP4    @EIS,,AUTO
         5 002131   400000 236100                    LDQ     0,,PR4
         5 002132   007777 316007                    CANQ    4095,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:105  
         5 002133   002136 601000 5                  TNZ     s:9360

   9359  5 002134   200276 221300                    LDX1  ! @RC_TYP+1,,AUTO
         5 002135   000001 702211                    TSX2  ! 1,X1

      622     9360    2       IF EIS.PTR_SZ>0 THEN

   9360  5 002136   400000 236100                    LDQ     0,,PR4
         5 002137   000030 736000                    QLS     24
         5 002140   000030 732000                    QRS     24
         5 002141   000000 116003                    CMPQ    0,DU
         5 002142   002163 604400 5                  TMOZ    s:9366

      623     9361    3       DO;

      624     9362    3           SET$=PINCRW(REC$,EIS.WD_OFST);

   9362  5 002143   400000 220100                    LDX0    0,,PR4
         5 002144   077777 360003                    ANX0    32767,DU
         5 002145   000000 636010                    EAQ     0,X0
         5 002146   000000 036000 xsym               ADLQ    REC$
         5 002147   000000 756000 xsym               STQ     SET$

      625     9363    3           SET$=PINCRC(SET$,EIS.BY_OFST/2);

   9363  5 002150   400000 236100                    LDQ     0,,PR4
         5 002151   000017 772000                    QRL     15
         5 002152   000007 376007                    ANQ     7,DL
         5 002153   000001 772000                    QRL     1
         5 002154   000020 736000                    QLS     16
         5 002155   000000 036000 xsym               ADLQ    SET$
         5 002156   000000 756000 xsym               STQ     SET$

      626     9364    3           PTR_SIZE=EIS.PTR_SZ;

   9364  5 002157   400000 236100                    LDQ     0,,PR4
         5 002160   000030 736000                    QLS     24
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:106  
         5 002161   000030 732000                    QRS     24
         5 002162   000000 756000 xsym               STQ     PTR_SIZE

      627     9365    3           END;

      628     9366    2       PINCRC(ADDR(DBK),4-PTR_SIZE)->PTR_V=SET$->PTR_V; /* GET PTR */

   9366  5 002163   000000 235003                    LDA     0,DU
         5 002164   000000 135000 xsym               SBLA    PTR_SIZE
         5 002165   000000 475400 xsym               LDP5    SET$
         5 002166   000000 720000 xsym               LXL0    PTR_SIZE
         5 002167   040145 100540                    MLR     fill='040'O
         5 002170   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         5 002171   300001 000010                    ADSC9   1,A,PR3                  cn=0,n=*X0

      629     9367    2       IF AREA_INDX>0 AND MSTR_REF.GLOBAL(MSTR_INDX)~=1 AND DBK>0 THEN

   9367  5 002172   002070 235000 0                  LDA     AREA_INDX
         5 002173   002215 604400 5                  TMOZ    s:9369
         5 002174   000000 236000 xsym               LDQ     MSTR_INDX
         5 002175   000012 402007                    MPY     10,DL
         5 002176   000000 475400 xsym               LDP5    MSTR$
         5 002177   500011 236106                    LDQ     9,QL,PR5
         5 002200   777000 376003                    ANQ     -512,DU
         5 002201   001000 116003                    CMPQ    512,DU
         5 002202   002215 600000 5                  TZE     s:9369
         5 002203   300000 235100                    LDA     0,,PR3
         5 002204   002215 600000 5                  TZE     s:9369

      630     9368    2           DBK=DBK+AREA_KEY_XREF.MAX_KEY(AREA_INDX-1); /* TO GLOBAL */

   9368  5 002205   002070 236000 0                  LDQ     AREA_INDX
         5 002206   000012 402007                    MPY     10,DL
         5 002207   000000 476400 xsym               LDP6    AREA_KEY$
         5 002210   677766 235106                    LDA     -10,QL,PR6
         5 002211   677767 236106                    LDQ     -9,QL,PR6
         5 002212   000022 773000                    LRL     18
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:107  
         5 002213   300000 036100                    ADLQ    0,,PR3
         5 002214   300000 756100                    STQ     0,,PR3

      631     9369    2       CALL CONV_DBK(DBK,TXT,INDX);

   9369  5 002215   200302 236100                    LDQ     @INDX,,AUTO
         5 002216   200301 235100                    LDA     @TXT,,AUTO
         5 002217   200306 757100                    STAQ    @DBK_TXT,,AUTO
         5 002220   200300 236100                    LDQ     @DBK,,AUTO
         5 002221   200305 756100                    STQ     @DBK_BIN,,AUTO
         5 002222   000721 701000 5                  TSX1    CONV_DBK
         5 002223   000000 011000                    NOP     0

      632     9370    2   END GET_PTR;

   9370  5 002224   200276 221300                    LDX1  ! @RC_TYP+1,,AUTO
         5 002225   000001 702211                    TSX2  ! 1,X1

      633     9371        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:108  
      634     9372    1   FINDBKEY: PROC ALTRET;

   9372  5 002226   200272 741300       FINDBKEY     STX1  ! AREA_ENCRPT+33,,AUTO

      635     9373
      636     9374    2       KEY_RNG.SEC(0)=KEY_RNG.FIR(0);

   9374  5 002227   000000 235000 xsym               LDA     KEY_RNG
         5 002230   000001 755000 xsym               STA     KEY_RNG+1

      637     9375    2       CALL CONV_DBK(KEY_RNG.FIR(0),DBK_CUR,V1);

   9375  5 002231   000032 237000 6                  LDAQ    26
         5 002232   200306 757100                    STAQ    @DBK_TXT,,AUTO
         5 002233   000105 236000 6                  LDQ     69
         5 002234   200305 756100                    STQ     @DBK_BIN,,AUTO
         5 002235   000721 701000 5                  TSX1    CONV_DBK
         5 002236   000000 011000                    NOP     0

      638     9376    2       CALL AREA_SELECTION ALTRET(BAD_KEY);

   9376  5 002237   000240 701000 5                  TSX1    AREA_SELECTION
         5 002240   002327 702000 5                  TSX2    BAD_KEY

      639     9377    2       REC_HDR.REC_NM=' ';

   9377  5 002241   040000 100400                    MLR     fill='040'O
         5 002242   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 002243   000000 200031 xsym               ADSC9   REC_HDR                  cn=1,n=25

      640     9378    2       CALL ENT_ADDR ALTRET(ALT_RET); /* ENTER Q2PR */

   9378  5 002244   000002 220000 0                  LDX0    ENT_ADDR
         5 002245   000006 631400 6                  EPPR1   6
         5 002246   000000 701010                    TSX1    0,X0
         5 002247   002371 702000 5                  TSX2    ALT_RET

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:109  
      641     9379    2       IF REC_HDR.REC_NM= ' ' THEN GOTO NOT_THERE;

   9379  5 002250   040000 106400                    CMPC    fill='040'O
         5 002251   000000 200031 xsym               ADSC9   REC_HDR                  cn=1,n=25
         5 002252   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 002253   002357 600000 5                  TZE     NOT_THERE

      642     9380    2       CALL INDEX1(V2,' ',REC_HDR.REC_NM);

   9380  5 002254   000000 124400                    SCM     mask='000'O
         5 002255   000000 200031 xsym               ADSC9   REC_HDR                  cn=1,n=25
         5 002256   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 002257   002007 000000 0                  ARG     V2

      643     9381    2       DBK_REC_SIZE=V1+V2+2;

   9381  5 002260   002006 236000 0                  LDQ     V1
         5 002261   002007 036000 0                  ADLQ    V2
         5 002262   000002 036007                    ADLQ    2,DL
         5 002263   002022 756000 0                  STQ     DBK_REC_SIZE

      644     9382    2       CALL CONCAT(DBK_REC,ADDR(DBK_CUR)->DBK_V,'(',

   9382  5 002264   002006 720000 0                  LXL0    V1
         5 002265   002023 470400 0                  LDP0    DBK_REC$
         5 002266   000000 621006                    EAX1    0,QL
         5 002267   040140 100440                    MLR     fill='040'O
         5 002270   002062 000010 0                  ADSC9   DBK_CUR                  cn=0,n=*X0
         5 002271   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         5 002272   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 002273   002006 136000 0                  SBLQ    V1
         5 002274   002325 604400 5                  TMOZ    s:9384
         5 002275   000000 620006                    EAX0    0,QL
         5 002276   002006 235000 0                  LDA     V1
         5 002277   040145 100400                    MLR     fill='040'O
         5 002300   000062 000001 6                  ADSC9   50                       cn=0,n=1
         5 002301   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:110  
         5 002302   000001 116007                    CMPQ    1,DL
         5 002303   002325 604400 5                  TMOZ    s:9384
         5 002304   777777 620006                    EAX0    -1,QL
         5 002305   002007 721000 0                  LXL1    V2
         5 002306   002006 235000 0                  LDA     V1
         5 002307   040145 100440                    MLR     fill='040'O
         5 002310   000000 200011 xsym               ADSC9   REC_HDR                  cn=1,n=*X1
         5 002311   000000 200010                    ADSC9   0,A,PR0                  cn=1,n=*X0
         5 002312   002007 136000 0                  SBLQ    V2
         5 002313   000001 116007                    CMPQ    1,DL
         5 002314   002325 604400 5                  TMOZ    s:9384
         5 002315   200310 756100                    STQ     @INDX+1,,AUTO
         5 002316   002006 236000 0                  LDQ     V1
         5 002317   002007 036000 0                  ADLQ    V2
         5 002320   200310 720100                    LXL0    @INDX+1,,AUTO
         5 002321   777777 621010                    EAX1    -1,X0
         5 002322   040146 100400                    MLR     fill='040'O
         5 002323   000063 000001 6                  ADSC9   51                       cn=0,n=1
         5 002324   000000 200011                    ADSC9   0,Q,PR0                  cn=1,n=*X1

      645     9383    2          ADDR(REC_HDR.REC_NM)->REC_V,')');
      646     9384    2       RETURN;

   9384  5 002325   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 002326   000001 702211                    TSX2  ! 1,X1

      647     9385    2   BAD_KEY:
      648     9386    2       CALL CONCAT(BUF,'a    DBKEY ',ADDR(DBK_CUR)->DBK_V,

   9386  5 002327   040000 100400       BAD_KEY      MLR     fill='040'O
         5 002330   000303 000013 1                  ADSC9   DCB_LO+144               cn=0,n=11
         5 002331   002036 000013 0                  ADSC9   BUF                      cn=0,n=11
         5 002332   002006 720000 0                  LXL0    V1
         5 002333   040000 100440                    MLR     fill='040'O
         5 002334   002062 000010 0                  ADSC9   DBK_CUR                  cn=0,n=*X0
         5 002335   002040 600105 0                  ADSC9   BUF+2                    cn=3,n=69
         5 002336   002006 236000 0                  LDQ     V1
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:111  
         5 002337   000105 116007                    CMPQ    69,DL
         5 002340   002356 603000 5                  TRC     s:9388
         5 002341   777672 621006                    EAX1    -70,QL
         5 002342   777777 661003                    ERX1    -1,DU
         5 002343   040046 100400                    MLR     fill='040'O
         5 002344   000306 000026 1                  ADSC9   DCB_LO+147               cn=0,n=22
         5 002345   002040 600011 0                  ADSC9   BUF+2,Q                  cn=3,n=*X1
         5 002346   002006 236000 0                  LDQ     V1
         5 002347   000057 116007                    CMPQ    47,DL
         5 002350   002356 603000 5                  TRC     s:9388
         5 002351   777720 620006                    EAX0    -48,QL
         5 002352   777777 660003                    ERX0    -1,DU
         5 002353   040046 100400                    MLR     fill='040'O
         5 002354   000000 000036 xsym               ADSC9   CURR_SCHNM               cn=0,n=30
         5 002355   002046 200010 0                  ADSC9   BUF+8,Q                  cn=1,n=*X0

      649     9387    2          ' is illegal in schema ',CURR_SCHNM);
      650     9388    2       GOTO ALT_RETURN;

   9388  5 002356   002365 710000 5                  TRA     ALT_RETURN

      651     9389    2   NOT_THERE:
      652     9390    2       CALL CONCAT(BUF,'a    No record found at DBKEY ',DBK_CUR);

   9390  5 002357   040000 100400       NOT_THERE    MLR     fill='040'O
         5 002360   000314 000036 1                  ADSC9   DCB_LO+153               cn=0,n=30
         5 002361   002036 000036 0                  ADSC9   BUF                      cn=0,n=30
         5 002362   040000 100400                    MLR     fill='040'O
         5 002363   002062 000012 0                  ADSC9   DBK_CUR                  cn=0,n=10
         5 002364   002045 400062 0                  ADSC9   BUF+7                    cn=2,n=50

      653     9391    2   ALT_RETURN:
      654     9392    2       CALL WRITE_A_LINE;

   9392  5 002365   000000 236000 6     ALT_RETURN   LDQ     0
         5 002366   200301 756100                    STQ     @TXT,,AUTO
         5 002367   000003 701000 5                  TSX1    WRITE_A_LINE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:112  
         5 002370   000000 011000                    NOP     0

      655     9393    2   ALT_RET:
      656     9394    2       ALTRETURN;

   9394  5 002371   200272 221300       ALT_RET      LDX1  ! AREA_ENCRPT+33,,AUTO
         5 002372   000000 702211                    TSX2  ! 0,X1

      657     9395    2   END FINDBKEY;
      658     9396        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:113  
      659     9397    1   PATCH_IT: PROC(PTR_TYPE,NEW_PTR) ALTRET;

   9397  5 002373   200272 741300       PATCH_IT     STX1  ! AREA_ENCRPT+33,,AUTO

      660     9398
      661     9399    2   DCL PTR_TYPE UBIN;
      662     9400    2   DCL NEW_PTR SBIN;
      663     9401
      664     9402    2       IF PTR_TYPE=#PRIOR2 THEN

   9402  5 002374   200273 470500                    LDP0    @PTR_TYPE,,AUTO
         5 002375   000000 235100                    LDA     0,,PR0
         5 002376   000017 115007                    CMPA    15,DL
         5 002377   002414 601000 5                  TNZ     s:9405

      665     9403    2           CALL GET_PTR(SET_XREF.EIS.PRIOR(REC_INDX),X,PA_POINTER,V3);

   9403  5 002400   000057 236000 6                  LDQ     47
         5 002401   200302 756100                    STQ     @INDX,,AUTO
         5 002402   000102 237000 6                  LDAQ    66
         5 002403   200300 757100                    STAQ    @DBK,,AUTO
         5 002404   002017 236000 0                  LDQ     REC_INDX
         5 002405   000024 736000                    QLS     20
         5 002406   000001 036003                    ADLQ    1,DU
         5 002407   000000 036000 xsym               ADLQ    SET_XREF$
         5 002410   200277 756100                    STQ     @EIS,,AUTO
         5 002411   002117 701000 5                  TSX1    GET_PTR
         5 002412   000000 011000                    NOP     0
         5 002413   002447 710000 5                  TRA     s:9410

      666     9404    2       ELSE
      667     9405    2           IF PTR_TYPE=#OWNER2 THEN

   9405  5 002414   000020 115007                    CMPA    16,DL
         5 002415   002432 601000 5                  TNZ     s:9408

      668     9406    2               CALL GET_PTR(SET_XREF.EIS.OWNR(REC_INDX),X,PA_POINTER,V4);
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:114  

   9406  5 002416   000067 236000 6                  LDQ     55
         5 002417   200302 756100                    STQ     @INDX,,AUTO
         5 002420   000102 237000 6                  LDAQ    66
         5 002421   200300 757100                    STAQ    @DBK,,AUTO
         5 002422   002017 236000 0                  LDQ     REC_INDX
         5 002423   000024 736000                    QLS     20
         5 002424   000002 036003                    ADLQ    2,DU
         5 002425   000000 036000 xsym               ADLQ    SET_XREF$
         5 002426   200277 756100                    STQ     @EIS,,AUTO
         5 002427   002117 701000 5                  TSX1    GET_PTR
         5 002430   000000 011000                    NOP     0
         5 002431   002447 710000 5                  TRA     s:9410

      669     9407    2           ELSE
      670     9408    2               IF PTR_TYPE=#NEXT2 THEN

   9408  5 002432   000016 115007                    CMPA    14,DL
         5 002433   002447 601000 5                  TNZ     s:9410

      671     9409    2                   CALL GET_PTR(SET_XREF.EIS.NEXT(REC_INDX),X,PA_POINTER,V5);

   9409  5 002434   000074 236000 6                  LDQ     60
         5 002435   200302 756100                    STQ     @INDX,,AUTO
         5 002436   000102 237000 6                  LDAQ    66
         5 002437   200300 757100                    STAQ    @DBK,,AUTO
         5 002440   002017 236000 0                  LDQ     REC_INDX
         5 002441   000024 736000                    QLS     20
         5 002442   000003 036003                    ADLQ    3,DU
         5 002443   000000 036000 xsym               ADLQ    SET_XREF$
         5 002444   200277 756100                    STQ     @EIS,,AUTO
         5 002445   002117 701000 5                  TSX1    GET_PTR
         5 002446   000000 011000                    NOP     0

      672     9410    2       III=NEW_PTR; /*  III IS SET TO NEW PTR, CONV TO LOCAL IF NEEDED */

   9410  5 002447   200274 470500                    LDP0    @NEW_PTR,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:115  
         5 002450   000000 235100                    LDA     0,,PR0
         5 002451   002003 755000 0                  STA     III

      673     9411    2       IF AREA_INDX>0 AND MSTR_REF.GLOBAL(MSTR_INDX)~=1 AND III>0 THEN

   9411  5 002452   002070 236000 0                  LDQ     AREA_INDX
         5 002453   002477 604400 5                  TMOZ    s:9413
         5 002454   000000 236000 xsym               LDQ     MSTR_INDX
         5 002455   000012 402007                    MPY     10,DL
         5 002456   000000 471400 xsym               LDP1    MSTR$
         5 002457   100011 236106                    LDQ     9,QL,PR1
         5 002460   777000 376003                    ANQ     -512,DU
         5 002461   001000 116003                    CMPQ    512,DU
         5 002462   002477 600000 5                  TZE     s:9413
         5 002463   002003 235000 0                  LDA     III
         5 002464   002477 604400 5                  TMOZ    s:9413

      674     9412    2           III=III-AREA_KEY_XREF.MAX_KEY(AREA_INDX-1); /* TO LOCAL */

   9412  5 002465   002070 236000 0                  LDQ     AREA_INDX
         5 002466   000012 402007                    MPY     10,DL
         5 002467   000000 473400 xsym               LDP3    AREA_KEY$
         5 002470   377766 235106                    LDA     -10,QL,PR3
         5 002471   377767 236106                    LDQ     -9,QL,PR3
         5 002472   000022 773000                    LRL     18
         5 002473   200310 756100                    STQ     @INDX+1,,AUTO
         5 002474   002003 236000 0                  LDQ     III
         5 002475   200310 136100                    SBLQ    @INDX+1,,AUTO
         5 002476   002003 756000 0                  STQ     III

      675     9413    2       CALL CONV_DBK(NEW_PTR,DBK_NEW,V1);

   9413  5 002477   000106 237000 6                  LDAQ    70
         5 002500   200306 757100                    STAQ    @DBK_TXT,,AUTO
         5 002501   200274 236100                    LDQ     @NEW_PTR,,AUTO
         5 002502   200305 756100                    STQ     @DBK_BIN,,AUTO
         5 002503   000721 701000 5                  TSX1    CONV_DBK
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:116  
         5 002504   000000 011000                    NOP     0

      676     9414    2       IF X=NEW_PTR THEN

   9414  5 002505   200274 470500                    LDP0    @NEW_PTR,,AUTO
         5 002506   000000 236000 xsym               LDQ     X
         5 002507   000000 116100                    CMPQ    0,,PR0
         5 002510   002526 601000 5                  TNZ     s:9418

      677     9415    2           CALL CONCAT(SC_MSG3.MEMBER,ADDR(DBK_NEW)->DBK_V,'  Not changed');

   9415  5 002511   002006 720000 0                  LXL0    V1
         5 002512   040000 100440                    MLR     fill='040'O
         5 002513   002065 000010 0                  ADSC9   DBK_NEW                  cn=0,n=*X0
         5 002514   002106 400032 0                  ADSC9   SC_MSG3+13               cn=2,n=26
         5 002515   002006 236000 0                  LDQ     V1
         5 002516   000032 116007                    CMPQ    26,DL
         5 002517   002525 603000 5                  TRC     s:9415+12
         5 002520   777745 621006                    EAX1    -27,QL
         5 002521   777777 661003                    ERX1    -1,DU
         5 002522   040046 100400                    MLR     fill='040'O
         5 002523   000324 000015 1                  ADSC9   DCB_LO+161               cn=0,n=13
         5 002524   002106 400011 0                  ADSC9   SC_MSG3+13,Q             cn=2,n=*X1
         5 002525   002607 710000 5                  TRA     s:9429

      678     9416    2       ELSE
      679     9417    3       DO;

      680     9418    3           WALK_CNT=WALK_CNT+1; /* KEEP A COUNT REC UPDATED */

   9418  5 002526   002030 235000 0                  LDA     WALK_CNT
         5 002527   000001 035007                    ADLA    1,DL
         5 002530   002030 755000 0                  STA     WALK_CNT

      681     9419    3           CALL JRNL_WRITE;

   9419  5 002531   001016 701000 5                  TSX1    JRNL_WRITE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:117  
         5 002532   000000 011000                    NOP     0

      682     9420    3           CALL CONCAT(SC_MSG3.MEMBER,ADDR(DBK_NEW)->DBK_V,'  Was ',PA_POINTER);

   9420  5 002533   002006 720000 0                  LXL0    V1
         5 002534   040000 100440                    MLR     fill='040'O
         5 002535   002065 000010 0                  ADSC9   DBK_NEW                  cn=0,n=*X0
         5 002536   002106 400032 0                  ADSC9   SC_MSG3+13               cn=2,n=26
         5 002537   002006 236000 0                  LDQ     V1
         5 002540   000032 116007                    CMPQ    26,DL
         5 002541   002557 603000 5                  TRC     s:9421
         5 002542   777745 621006                    EAX1    -27,QL
         5 002543   777777 661003                    ERX1    -1,DU
         5 002544   040046 100400                    MLR     fill='040'O
         5 002545   000330 000006 1                  ADSC9   DCB_LO+165               cn=0,n=6
         5 002546   002106 400011 0                  ADSC9   SC_MSG3+13,Q             cn=2,n=*X1
         5 002547   002006 236000 0                  LDQ     V1
         5 002550   000024 116007                    CMPQ    20,DL
         5 002551   002557 603000 5                  TRC     s:9421
         5 002552   777753 620006                    EAX0    -21,QL
         5 002553   777777 660003                    ERX0    -1,DU
         5 002554   040046 100400                    MLR     fill='040'O
         5 002555   002033 000012 0                  ADSC9   PA_POINTER               cn=0,n=10
         5 002556   002110 000010 0                  ADSC9   SC_MSG3+15,Q             cn=0,n=*X0

      683     9421    3           SET$->PTR_V=PINCRC(ADDR(III),4-PTR_SIZE)->PTR_V;

   9421  5 002557   000000 235003                    LDA     0,DU
         5 002560   000000 135000 xsym               SBLA    PTR_SIZE
         5 002561   000000 720000 xsym               LXL0    PTR_SIZE
         5 002562   000000 470400 xsym               LDP0    SET$
         5 002563   040140 100445                    MLR     fill='040'O
         5 002564   002004 000010 0                  ADSC9   JJJ,A                    cn=0,n=*X0
         5 002565   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      684     9422    3           IF FUNC_CODE=#LINK2 AND PTR_TYPE=3+#NEXT2 THEN /* FOR PA */

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:118  
   9422  5 002566   002126 236000 0                  LDQ     FUNC_CODE
         5 002567   777000 376003                    ANQ     -512,DU
         5 002570   006000 116003                    CMPQ    3072,DU
         5 002571   002605 601000 5                  TNZ     s:9427
         5 002572   200273 470500                    LDP0    @PTR_TYPE,,AUTO
         5 002573   000000 235100                    LDA     0,,PR0
         5 002574   000021 115007                    CMPA    17,DL
         5 002575   002605 601000 5                  TNZ     s:9427

      685     9423    4           DO;

      686     9424    4               SET$=PINCRC(SET$,-2); /* POINT TO REC TYPE IN ENTRY */

   9424  5 002576   000000 236000 xsym               LDQ     SET$
         5 002577   000110 036000 6                  ADLQ    72
         5 002600   000000 756000 xsym               STQ     SET$

      687     9425    4               RC_IN_PA=REC_TYPE; /* UPDATE RC IN CASE IT CHANGE */

   9425  5 002601   000000 471400 xsym               LDP1    SET$
         5 002602   000100 100400                    MLR     fill='000'O
         5 002603   002020 000002 0                  ADSC9   REC_TYPE                 cn=0,n=2
         5 002604   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      688     9426    4               END;

      689     9427    3           CALL WRITE_A_PAGE ALTRET(FAIL_PATCH);

   9427  5 002605   001102 701000 5                  TSX1    WRITE_A_PAGE
         5 002606   002702 702000 5                  TSX2    FAIL_PATCH

      690     9428    3           END;

      691     9429    2       CALL CONCAT(BUF,'A  ',DBK_REC,'  New ',NOP_TEXT(PTR_TYPE-#NEXT2),

   9429  5 002607   200273 470500                    LDP0    @PTR_TYPE,,AUTO
         5 002610   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:119  
         5 002611   000005 402007                    MPY     5,DL
         5 002612   200310 756100                    STQ     @INDX+1,,AUTO
         5 002613   000153 236000 1                  LDQ     DCB_LO+56
         5 002614   002036 552070 0                  STBQ    BUF,'70'O
         5 002615   002023 471400 0                  LDP1    DBK_REC$
         5 002616   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 002617   040000 100540                    MLR     fill='040'O
         5 002620   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 002621   002036 600115 0                  ADSC9   BUF                      cn=3,n=77
         5 002622   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 002623   000115 116007                    CMPQ    77,DL
         5 002624   002660 603000 5                  TRC     s:9431
         5 002625   777662 621006                    EAX1    -78,QL
         5 002626   777777 661003                    ERX1    -1,DU
         5 002627   040046 100400                    MLR     fill='040'O
         5 002630   000332 000006 1                  ADSC9   DCB_LO+167               cn=0,n=6
         5 002631   002036 600011 0                  ADSC9   BUF,Q                    cn=3,n=*X1
         5 002632   000107 116007                    CMPQ    71,DL
         5 002633   002660 603000 5                  TRC     s:9431
         5 002634   777670 622006                    EAX2    -72,QL
         5 002635   777777 662003                    ERX2    -1,DU
         5 002636   200310 235100                    LDA     @INDX+1,,AUTO
         5 002637   040046 100405                    MLR     fill='040'O
         5 002640   777761 400005 1                  ADSC9   DCB_LO-66,A              cn=2,n=5
         5 002641   002040 200012 0                  ADSC9   BUF+2,Q                  cn=1,n=*X2
         5 002642   000102 116007                    CMPQ    66,DL
         5 002643   002660 603000 5                  TRC     s:9431
         5 002644   777675 623006                    EAX3    -67,QL
         5 002645   777777 663003                    ERX3    -1,DU
         5 002646   040046 100400                    MLR     fill='040'O
         5 002647   000334 000011 1                  ADSC9   DCB_LO+169               cn=0,n=9
         5 002650   002041 400013 0                  ADSC9   BUF+3,Q                  cn=2,n=*X3
         5 002651   000071 116007                    CMPQ    57,DL
         5 002652   002660 603000 5                  TRC     s:9431
         5 002653   777706 624006                    EAX4    -58,QL
         5 002654   777777 664003                    ERX4    -1,DU
         5 002655   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:120  
         5 002656   002106 400032 0                  ADSC9   SC_MSG3+13               cn=2,n=26
         5 002657   002043 600014 0                  ADSC9   BUF+5,Q                  cn=3,n=*X4

      692     9430    2          ' pointer ',SC_MSG3.MEMBER);
      693     9431    2       IF X=NEW_PTR AND DASH_ON=1 THEN

   9431  5 002660   200274 473500                    LDP3    @NEW_PTR,,AUTO
         5 002661   000000 236000 xsym               LDQ     X
         5 002662   300000 116100                    CMPQ    0,,PR3
         5 002663   002674 601000 5                  TNZ     s:9434
         5 002664   002123 236000 0                  LDQ     DASH_ON
         5 002665   777000 376003                    ANQ     -512,DU
         5 002666   001000 116003                    CMPQ    512,DU
         5 002667   002674 601000 5                  TNZ     s:9434

      694     9432    2           OWNER_CNT=OWNER_CNT+1; /* DONT PRINT, BUT KEEP COUNT */

   9432  5 002670   002205 235000 0                  LDA     OWNER_CNT
         5 002671   000001 035007                    ADLA    1,DL
         5 002672   002205 755000 0                  STA     OWNER_CNT
         5 002673   002700 710000 5                  TRA     s:9435

      695     9433    2       ELSE
      696     9434    2           CALL WRITE_A_LINE;

   9434  5 002674   000000 236000 6                  LDQ     0
         5 002675   200301 756100                    STQ     @TXT,,AUTO
         5 002676   000003 701000 5                  TSX1    WRITE_A_LINE
         5 002677   000000 011000                    NOP     0

      697     9435    2       RETURN;

   9435  5 002700   200272 221300                    LDX1  ! AREA_ENCRPT+33,,AUTO
         5 002701   000001 702211                    TSX2  ! 1,X1

      698     9436    2   FAIL_PATCH: ALTRETURN; /* ABORT LINK COMMAND */

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:121  
   9436  5 002702   200272 221300       FAIL_PATCH   LDX1  ! AREA_ENCRPT+33,,AUTO
         5 002703   000000 702211                    TSX2  ! 0,X1

      699     9437    2   END PATCH_IT;
      700     9438        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:122  
      701     9439    1       IF XREF_BUILT='0'B THEN

   9439  5 002704   000000 234000 xsym               SZN     XREF_BUILT
         5 002705   002717 604000 5                  TMI     s:9445

      702     9440    2       DO;

      703     9441    2           CALL BUILD_MSTR_TBL ALTRET(EXIT_RTN);

   9441  5 002706   000006 631400 6                  EPPR1   6
         5 002707   000000 701000 xent               TSX1    BUILD_MSTR_TBL
         5 002710   005546 702000 5                  TSX2    EXIT_RTN

      704     9442    2           CALL BUILD_SETXREF ALTRET(EXIT_RTN);

   9442  5 002711   000006 631400 6                  EPPR1   6
         5 002712   000000 701000 xent               TSX1    BUILD_SETXREF
         5 002713   005546 702000 5                  TSX2    EXIT_RTN

      705     9443    2           CALL BUILD_RECXREF ALTRET(EXIT_RTN);

   9443  5 002714   000006 631400 6                  EPPR1   6
         5 002715   000000 701000 xent               TSX1    BUILD_RECXREF
         5 002716   005546 702000 5                  TSX2    EXIT_RTN

      706     9444    2           END;

      707     9445    1       CALL SYS_FUNC_CORRES(DCB_UC,DCB_SI) ALTRET(CHK_LO);

   9445  5 002717   000111 630400 6                  EPPR0   73
         5 002720   000010 631400 6                  EPPR1   8
         5 002721   000000 701000 xent               TSX1    SYS_FUNC_CORRES
         5 002722   002724 702000 5                  TSX2    CHK_LO

      708     9446    1       GOTO OKAY;

   9446  5 002723   002741 710000 5                  TRA     OKAY
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:123  

      709     9447    1   CHK_LO:
      710     9448    1       OUTPUT_UC = 1; /* SUPPOSE M$LO = M$UC */

   9448  5 002724   001000 236003       CHK_LO       LDQ     512,DU
         5 002725   002122 756000 0                  STQ     OUTPUT_UC

      711     9449    1       CALL SYS_FUNC_CORRES(DCB_UC,DCB_LO) ALTRET(OKAY);

   9449  5 002726   000113 630400 6                  EPPR0   75
         5 002727   000010 631400 6                  EPPR1   8
         5 002730   000000 701000 xent               TSX1    SYS_FUNC_CORRES
         5 002731   002741 702000 5                  TSX2    OKAY

      712     9450    1       OUTPUT_UC = 0; /* M$LO IS NOT SET TO UC */

   9450  5 002732   002122 450000 0                  STZ     OUTPUT_UC

      713     9451    1       DCBSF = DCB_UC;

   9451  5 002733   000061 220000 1                  LDX0    DCB_UC
         5 002734   000000 740000 xsym               STX0    DCBSF

      714     9452    1       CALL WRITE_TO_UC('b  Warning: your M$LO is not set to you%');

   9452  5 002735   000115 236000 6                  LDQ     77
         5 002736   200301 756100                    STQ     @DBK+1,,AUTO
         5 002737   000007 701000 5                  TSX1    WRITE_TO_UC
         5 002740   000000 011000                    NOP     0

      715     9453    1   OKAY:
      716     9454
      717     9455    1       S_CNT=ITMCNT;

   9455  5 002741   000000 235000 xsym  OKAY         LDA     ITMCNT
         5 002742   000033 735000                    ALS     27
         5 002743   002120 755000 0                  STA     S_CNT
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:124  

      718     9456    1       CALL VERIFY_SETS ALTRET(EXIT_RTN);

   9456  5 002744   000072 701000 5                  TSX1    VERIFY_SETS
         5 002745   005546 702000 5                  TSX2    EXIT_RTN

      719     9457    1       LAST_DBK=UWA.SF_REC.DBKOA;

   9457  5 002746   000063 235000 xsym               LDA     UWA+51
         5 002747   000000 755000 xsym               STA     LAST_DBK

      720     9458    2       DO V6=0 TO NO_AREAS-1;

   9458  5 002750   002013 450000 0                  STZ     V6
         5 002751   003042 710000 5                  TRA     s:9473+3

      721     9459    2           AREA_KEY_XREF.DCB#(V6)=0;

   9459  5 002752   002013 236000 0                  LDQ     V6
         5 002753   000012 402007                    MPY     10,DL
         5 002754   000000 220003                    LDX0    0,DU
         5 002755   000000 470400 xsym               LDP0    AREA_KEY$
         5 002756   000000 740106                    STX0    0,QL,PR0

      722     9460    2           ZI$DIR.AREA_NM.NAME.TEXT=MSTR_REF.NAME(NO_RECS+NO_SETS+V6);

   9460  5 002757   000000 236000 xsym               LDQ     NO_RECS
         5 002760   000000 036000 xsym               ADLQ    NO_SETS
         5 002761   002013 036000 0                  ADLQ    V6
         5 002762   000050 402007                    MPY     40,DL
         5 002763   000000 470400 xsym               LDP0    MSTR$
         5 002764   040000 100506                    MLR     fill='040'O
         5 002765   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         5 002766   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30

      723     9461    2           CALL GET_NXT_AC(KKK); /* GET THE AC IN SCHEMA */

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:125  
   9461  5 002767   000034 630400 6                  EPPR0   28
         5 002770   000015 631400 6                  EPPR1   13
         5 002771   000000 701000 xent               TSX1    GET_NXT_AC
         5 002772   000000 011000                    NOP     0

      724     9462    2           KEY_RNG.FIR(0)=0;

   9462  5 002773   000000 450000 xsym               STZ     KEY_RNG

      725     9463    2           IF UWA.AC_REC.SWS.ENCRYP THEN

   9463  5 002774   000233 236000 xsym               LDQ     UWA+155
         5 002775   200000 316003                    CANQ    65536,DU
         5 002776   003034 600000 5                  TZE     s:9472

      726     9464    3           DO;

      727     9465    3               CALL INDEX1(V2,' ',ZI$DIR.AREA_NM.NAME.TEXT);

   9465  5 002777   000000 124400                    SCM     mask='000'O
         5 003000   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30
         5 003001   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 003002   002007 000000 0                  ARG     V2

      728     9466    3               CALL CONCAT(BUF,'@ ENTER ENCRYPT_SEED FOR AREA ',

   9466  5 003003   040000 100400                    MLR     fill='040'O
         5 003004   000351 000036 1                  ADSC9   DCB_LO+182               cn=0,n=30
         5 003005   002036 000036 0                  ADSC9   BUF                      cn=0,n=30
         5 003006   002007 720000 0                  LXL0    V2
         5 003007   040000 100440                    MLR     fill='040'O
         5 003010   000234 200010 xsym               ADSC9   ZI$DIR+156               cn=1,n=*X0
         5 003011   002045 400062 0                  ADSC9   BUF+7                    cn=2,n=50
         5 003012   002007 236000 0                  LDQ     V2
         5 003013   000062 116007                    CMPQ    50,DL
         5 003014   003022 603000 5                  TRC     s:9468
         5 003015   777715 621006                    EAX1    -51,QL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:126  
         5 003016   777777 661003                    ERX1    -1,DU
         5 003017   040046 100400                    MLR     fill='040'O
         5 003020   000361 000026 1                  ADSC9   DCB_LO+190               cn=0,n=22
         5 003021   002045 400011 0                  ADSC9   BUF+7,Q                  cn=2,n=*X1

      729     9467    3                  ADDR(ZI$DIR.AREA_NM.NAME.TEXT)->REC_V,'(Q to quit,0 if none):');
      730     9468    3               K_CNT=-1;

   9468  5 003022   000001 335007                    LCA     1,DL
         5 003023   002121 755000 0                  STA     K_CNT

      731     9469    3               III=2; /* TYPE "Q" WILL TERMINATE REPAIR */

   9469  5 003024   000002 236007                    LDQ     2,DL
         5 003025   002003 756000 0                  STQ     III

      732     9470    3               CALL GET_CMD(CRPT_NODE,BUF) ALTRET(EXIT_RTN);

   9470  5 003026   000003 236000 6                  LDQ     3
         5 003027   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003030   000116 236000 6                  LDQ     78
         5 003031   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003032   000345 701000 5                  TSX1    GET_CMD
         5 003033   005546 702000 5                  TSX2    EXIT_RTN

      733     9471    3               END;

      734     9472    2           AREA_ENCRPT(V6)=KEY_RNG.FIR(0); /* SAVE THE ENCRPT SEED */

   9472  5 003034   002013 720000 0                  LXL0    V6
         5 003035   000000 235000 xsym               LDA     KEY_RNG
         5 003036   200231 755110                    STA     AREA_ENCRPT,X0,AUTO

      735     9473    2           END;

   9473  5 003037   002013 236000 0                  LDQ     V6
         5 003040   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:127  
         5 003041   002013 756000 0                  STQ     V6
         5 003042   002013 236000 0                  LDQ     V6
         5 003043   003046 604000 5                  TMI     s:9474
         5 003044   000000 116000 xsym               CMPQ    NO_AREAS
         5 003045   002752 604000 5                  TMI     s:9459

      736     9474    1       CALL WRITE_A_LINE('A%');

   9474  5 003046   000025 236000 6                  LDQ     21
         5 003047   200301 756100                    STQ     @DBK+1,,AUTO
         5 003050   000003 701000 5                  TSX1    WRITE_A_LINE
         5 003051   000000 011000                    NOP     0

      737     9475
      738     9476    1       SC_SIZ=ITMCNT;

   9476  5 003052   000000 235000 xsym               LDA     ITMCNT
         5 003053   000001 755000 0                  STA     SC_SIZ

      739     9477    1       ITMCNT=-1; /* RESET FOR Q2PR */

   9477  5 003054   000001 336007                    LCQ     1,DL
         5 003055   000000 756000 xsym               STQ     ITMCNT

      740     9478    1   /**/ BUFLNSF=80;

   9478  5 003056   000120 235007                    LDA     80,DL
         5 003057   000000 755000 xsym               STA     BUFLNSF

      741     9479    1   /**/ BUFSF=VECTOR(SC_MSG1);

   9479  5 003060   000120 237000 6                  LDAQ    80
         5 003061   000000 755000 xsym               STA     BUFSF
         5 003062   000001 756000 xsym               STQ     BUFSF+1

      742     9480    1       CALL SYS_FUNC_WRIT;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:128  
   9480  5 003063   000006 631400 6                  EPPR1   6
         5 003064   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 003065   000000 011000                    NOP     0

      743     9481    1   /**/ BUFSF=VECTOR(SC_MSG2);

   9481  5 003066   000122 237000 6                  LDAQ    82
         5 003067   000000 755000 xsym               STA     BUFSF
         5 003070   000001 756000 xsym               STQ     BUFSF+1

      744     9482    1       CALL SYS_FUNC_WRIT;

   9482  5 003071   000006 631400 6                  EPPR1   6
         5 003072   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 003073   000000 011000                    NOP     0

      745     9483    1   /**/ BUFSF=VECTOR(SC_MSG3);

   9483  5 003074   000124 237000 6                  LDAQ    84
         5 003075   000000 755000 xsym               STA     BUFSF
         5 003076   000001 756000 xsym               STQ     BUFSF+1

      746     9484    2       DO III=0 TO SC_SIZ;

   9484  5 003077   002003 450000 0                  STZ     III
         5 003100   003235 710000 5                  TRA     s:9507+1

      747     9485    2           KKK=0;

   9485  5 003101   002005 450000 0                  STZ     KKK

      748     9486    2           SC_MSG3.VFC='b';

   9486  5 003102   040000 100400                    MLR     fill='040'O
         5 003103   000126 000001 6                  ADSC9   86                       cn=0,n=1
         5 003104   002071 000006 0                  ADSC9   SC_MSG3                  cn=0,n=6

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:129  
      749     9487    2           SC_MSG3.SETNAME=ITEM_LIST.NAME(III);

   9487  5 003105   002003 235000 0                  LDA     III
         5 003106   000005 735000                    ALS     5
         5 003107   040000 100405                    MLR     fill='040'O
         5 003110   000000 000030 xsym               ADSC9   ITEM_LIST,A              cn=0,n=24
         5 003111   002072 400030 0                  ADSC9   SC_MSG3+1                cn=2,n=24

      750     9488    2           SET_NAMES(III)=ITEM_LIST.NAME(III);

   9488  5 003112   002003 236000 0                  LDQ     III
         5 003113   200310 755100                    STA     @INDX+1,,AUTO
         5 003114   000036 402007                    MPY     30,DL
         5 003115   200310 235100                    LDA     @INDX+1,,AUTO
         5 003116   040106 100405                    MLR     fill='040'O
         5 003117   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30
         5 003120   200003 000036                    ADSC9   SET_NAMES,Q,AUTO         cn=0,n=30

      751     9489    2           CALL FIND_MSTR_ENTRY(ITEM_LIST.NAME(III),MSTR_INDX);

   9489  5 003121   000011 236000 6                  LDQ     9
         5 003122   200311 756100                    STQ     @INDX+2,,AUTO
         5 003123   002003 236000 0                  LDQ     III
         5 003124   000025 736000                    QLS     21
         5 003125   000012 036000 6                  ADLQ    10
         5 003126   200310 756100                    STQ     @INDX+1,,AUTO
         5 003127   200310 630500                    EPPR0   @INDX+1,,AUTO
         5 003130   000010 631400 6                  EPPR1   8
         5 003131   000000 701000 xent               TSX1    FIND_MSTR_ENTRY
         5 003132   000000 011000                    NOP     0

      752     9490    2           JJJ=MSTR_REF.NEXT(MSTR_INDX);

   9490  5 003133   000000 236000 xsym               LDQ     MSTR_INDX
         5 003134   000012 402007                    MPY     10,DL
         5 003135   000000 470400 xsym               LDP0    MSTR$
         5 003136   000000 236106                    LDQ     0,QL,PR0
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:130  
         5 003137   000022 736000                    QLS     18
         5 003140   000022 732000                    QRS     18
         5 003141   002004 756000 0                  STQ     JJJ

      753     9491    2           SC_MSG3.OWNER=MSTR_REF.NAME(REC_XREF.MSTRINDX(JJJ));

   9491  5 003142   000000 471400 xsym               LDP1    REC_XREF$
         5 003143   100000 236106                    LDQ     0,QL,PR1
         5 003144   000001 772000                    QRL     1
         5 003145   377777 376007                    ANQ     131071,DL
         5 003146   000012 402007                    MPY     10,DL
         5 003147   000002 736000                    QLS     2
         5 003150   040000 100506                    MLR     fill='040'O
         5 003151   000001 400030                    ADSC9   1,Q,PR0                  cn=2,n=24
         5 003152   002100 400030 0                  ADSC9   SC_MSG3+7                cn=2,n=24

      754     9492    3           DO WHILE (REC_XREF.NEXT(JJJ)>=0);

   9492  5 003153   002004 720000 0                  LXL0    JJJ
         5 003154   100000 221110                    LDX1    0,X0,PR1
         5 003155   003234 604000 5                  TMI     s:9507

      755     9493    3               JJJ=REC_XREF.NEXT(JJJ);

   9493  5 003156   000000 470400 xsym               LDP0    REC_XREF$
         5 003157   002004 720000 0                  LXL0    JJJ
         5 003160   000000 236110                    LDQ     0,X0,PR0
         5 003161   000022 732000                    QRS     18
         5 003162   002004 756000 0                  STQ     JJJ

      756     9494    3               SC_MSG3.MEMBER=MSTR_REF.NAME(REC_XREF.MSTRINDX(JJJ));

   9494  5 003163   000000 236106                    LDQ     0,QL,PR0
         5 003164   000001 772000                    QRL     1
         5 003165   377777 376007                    ANQ     131071,DL
         5 003166   000012 402007                    MPY     10,DL
         5 003167   000002 736000                    QLS     2
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:131  
         5 003170   000000 471400 xsym               LDP1    MSTR$
         5 003171   040000 100506                    MLR     fill='040'O
         5 003172   100001 400032                    ADSC9   1,Q,PR1                  cn=2,n=26
         5 003173   002106 400032 0                  ADSC9   SC_MSG3+13               cn=2,n=26

      757     9495    3               IF MSTR_REF.PAENT(REC_XREF.MSTRINDX(JJJ))>0 THEN

   9495  5 003174   002004 720000 0                  LXL0    JJJ
         5 003175   000000 236110                    LDQ     0,X0,PR0
         5 003176   000001 772000                    QRL     1
         5 003177   377777 376007                    ANQ     131071,DL
         5 003200   000012 402007                    MPY     10,DL
         5 003201   100011 236106                    LDQ     9,QL,PR1
         5 003202   000064 316000 6                  CANQ    52
         5 003203   003214 600000 5                  TZE     s:9502

      758     9496    4               DO;

      759     9497    4                   KKK=KKK+1;

   9497  5 003204   002005 054000 0                  AOS     KKK

      760     9498    4                   IF KKK=1 THEN

   9498  5 003205   002005 235000 0                  LDA     KKK
         5 003206   000001 115007                    CMPA    1,DL
         5 003207   003217 601000 5                  TNZ     s:9503

      761     9499    4                       CALL SYS_FUNC_WRIT;

   9499  5 003210   000006 631400 6                  EPPR1   6
         5 003211   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 003212   000000 011000                    NOP     0

      762     9500    4                   END;

   9500  5 003213   003217 710000 5                  TRA     s:9503
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:132  

      763     9501    3               ELSE
      764     9502    3                   CALL SYS_FUNC_WRIT;

   9502  5 003214   000006 631400 6                  EPPR1   6
         5 003215   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         5 003216   000000 011000                    NOP     0

      765     9503    3               SC_MSG3.VFC='a';

   9503  5 003217   040000 100400                    MLR     fill='040'O
         5 003220   000127 000001 6                  ADSC9   87                       cn=0,n=1
         5 003221   002071 000006 0                  ADSC9   SC_MSG3                  cn=0,n=6

      766     9504    3               SC_MSG3.SETNAME=' ';

   9504  5 003222   040000 100400                    MLR     fill='040'O
         5 003223   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 003224   002072 400030 0                  ADSC9   SC_MSG3+1                cn=2,n=24

      767     9505    3               SC_MSG3.OWNER=' ';

   9505  5 003225   040000 100400                    MLR     fill='040'O
         5 003226   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 003227   002100 400030 0                  ADSC9   SC_MSG3+7                cn=2,n=24

      768     9506    3               END;

   9506  5 003230   000000 470400 xsym               LDP0    REC_XREF$
         5 003231   002004 720000 0                  LXL0    JJJ
         5 003232   000000 221110                    LDX1    0,X0,PR0
         5 003233   003156 605000 5                  TPL     s:9493

      769     9507    2           END;

   9507  5 003234   002003 054000 0                  AOS     III
         5 003235   002003 236000 0                  LDQ     III
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:133  
         5 003236   000001 116000 0                  CMPQ    SC_SIZ
         5 003237   003101 604400 5                  TMOZ    s:9485

      770     9508
      771     9509    1       AREA_INDX=-1; /* SET CURRENT AREA TO NULL */

   9509  5 003240   000001 335007                    LCA     1,DL
         5 003241   002070 755000 0                  STA     AREA_INDX

      772     9510    1       ZI$DIR.AREA_NM.NAME.TEXT='REPAIR_DCB';

   9510  5 003242   040000 100400                    MLR     fill='040'O
         5 003243   000367 000012 1                  ADSC9   DCB_LO+196               cn=0,n=10
         5 003244   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30

      773     9511    1       CALL GET_DCB(ZI$DIR.AREA_NM);

   9511  5 003245   000016 630400 6                  EPPR0   14
         5 003246   000015 631400 6                  EPPR1   13
         5 003247   000000 701000 xent               TSX1    GET_DCB
         5 003250   000000 011000                    NOP     0

      774     9512    1       JRNL_DCB#=ZI$DIR.AREA_NM.DCB#;

   9512  5 003251   000244 235000 xsym               LDA     ZI$DIR+164
         5 003252   000022 771000                    ARL     18
         5 003253   002027 755000 0                  STA     JRNL_DCB#

      775     9513    1       FPT_TRMPRG.V.CTLFLG.PURGEOUTPUT#=%NO#; /* DONT PURGE OUTPUT */

   9513  5 003254   000130 236000 6                  LDQ     88
         5 003255   000006 356000 xsym               ANSQ    FPT_TRMPRG+6

      776     9514    1   RE_START:
      777     9515    1       JRNL_CNT=0; /* NUMBER OF JOURNAL RECORDS */

   9515  5 003256   002026 450000 0     RE_START     STZ     JRNL_CNT
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:134  

      778     9516    1       OPEN_JRNL.V.DCB#=JRNL_DCB#;

   9516  5 003257   002027 720000 0                  LXL0    JRNL_DCB#
         5 003260   002310 740000 0                  STX0    OPEN_JRNL+36

      779     9517    1       CALL M$OPEN(OPEN_JRNL);

   9517  5 003261   002244 630400 0                  EPPR0   OPEN_JRNL
         5 003262   050000 713400                    CLIMB   open
         5 003263   410400 401760                    pmme    nvectors=18

      780     9518
      781     9519    1   NEXT_CMD:
      782     9520    1       BREAK_FLAG=0; /* RESET ALL FLAGS BEFORE EACH CMD */

   9520  5 003264   000000 450000 xsym  NEXT_CMD     STZ     BREAK_FLAG

      783     9521    1       S_CNT=-1; /* STORE SET_NAME LIST */

   9521  5 003265   777000 236003                    LDQ     -512,DU
         5 003266   002120 756000 0                  STQ     S_CNT

      784     9522    1       R_CNT=-1; /* STORE RECORD_NAME LIST */

   9522  5 003267   002117 756000 0                  STQ     R_CNT

      785     9523    1       K_CNT=-1;

   9523  5 003270   000001 335007                    LCA     1,DL
         5 003271   002121 755000 0                  STA     K_CNT

      786     9524    1       KCNT=0;

   9524  5 003272   000000 450000 xsym               STZ     KCNT

      787     9525    1       SXCNT=0;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:135  

   9525  5 003273   000000 450000 0                  STZ     SXCNT

      788     9526    1       III=0;

   9526  5 003274   002003 450000 0                  STZ     III

      789     9527    1       ZI$DIR.PITEM='0'B; /* DEFAULT = DONT PRINT ITEMS */

   9527  5 003275   000131 236000 6                  LDQ     89
         5 003276   000125 356000 xsym               ANSQ    ZI$DIR+85

      790     9528    1       PRINT_OPT=0;

   9528  5 003277   002115 450000 0                  STZ     PRINT_OPT

      791     9529    1       WALK_OPT=1;

   9529  5 003300   001000 236003                    LDQ     512,DU
         5 003301   002116 756000 0                  STQ     WALK_OPT

      792     9530    1       DASH_ON=0;

   9530  5 003302   002123 450000 0                  STZ     DASH_ON

      793     9531    1       WALK_CNT=0;

   9531  5 003303   002030 450000 0                  STZ     WALK_CNT

      794     9532    1       OWNER_CNT=0;

   9532  5 003304   002205 450000 0                  STZ     OWNER_CNT

      795     9533    1       N_OR_P=0;

   9533  5 003305   002131 450000 0                  STZ     N_OR_P

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:136  
      796     9534
      797     9535    1       CALL GET_CMD(REP_SUB_CMD,'bCOMMAND:') ALTRET(E_O_F);

   9535  5 003306   000132 236000 6                  LDQ     90
         5 003307   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003310   000133 236000 6                  LDQ     91
         5 003311   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003312   000345 701000 5                  TSX1    GET_CMD
         5 003313   003345 702000 5                  TSX2    E_O_F

      798     9536    1       CALL WRITE_A_LINE('A%');

   9536  5 003314   000025 236000 6                  LDQ     21
         5 003315   200301 756100                    STQ     @DBK+1,,AUTO
         5 003316   000003 701000 5                  TSX1    WRITE_A_LINE
         5 003317   000000 011000                    NOP     0

      799     9537
      800     9538    1       FUNC_CODE=OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

   9538  5 003320   002341 470400 0                  LDP0    PCB+3
         5 003321   000003 471500                    LDP1    3,,PR0
         5 003322   100000 236100                    LDQ     0,,PR1
         5 003323   777777 376007                    ANQ     -1,DL
         5 003324   000033 736000                    QLS     27
         5 003325   002126 756000 0                  STQ     FUNC_CODE

      801     9539    2       DO CASE(FUNC_CODE);

   9539  5 003326   002126 236000 0                  LDQ     FUNC_CODE
         5 003327   000033 772000                    QRL     27
         5 003330   000012 116007                    CMPQ    10,DL
         5 003331   003333 602006 5                  TNC     s:9539+5,QL
         5 003332   005545 710000 5                  TRA     s:9873
         5 003333   005545 710000 5                  TRA     s:9873
         5 003334   003345 710000 5                  TRA     E_O_F
         5 003335   003400 710000 5                  TRA     s:9556
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:137  
         5 003336   005545 710000 5                  TRA     s:9873
         5 003337   005166 710000 5                  TRA     s:9821
         5 003340   004434 710000 5                  TRA     s:9710
         5 003341   003464 710000 5                  TRA     s:9575
         5 003342   004405 710000 5                  TRA     s:9700
         5 003343   003447 710000 5                  TRA     s:9570
         5 003344   003464 710000 5                  TRA     s:9575

      802     9540
      803     9541    2       CASE(#END2); /* RETURN TO MAIN */

      804     9542    2   E_O_F:
      805     9543    3           DO III=0 TO NO_AREAS-1;

   9543  5 003345   002003 450000 0     E_O_F        STZ     III
         5 003346   003364 710000 5                  TRA     s:9550+1

      806     9544    3               IF AREA_KEY_XREF.DCB#(III)>0 THEN

   9544  5 003347   002003 236000 0                  LDQ     III
         5 003350   000012 402007                    MPY     10,DL
         5 003351   000000 470400 xsym               LDP0    AREA_KEY$
         5 003352   000000 220106                    LDX0    0,QL,PR0
         5 003353   003363 600000 5                  TZE     s:9550

      807     9545    4               DO;

      808     9546    4                   DCBSF=AREA_KEY_XREF.DCB#(III);

   9546  5 003354   000000 740000 xsym               STX0    DCBSF

      809     9547    4                   CALL SYS_FUNC_CLOS;

   9547  5 003355   000006 631400 6                  EPPR1   6
         5 003356   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         5 003357   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:138  
      810     9548    4                   CALL SYS_FUNC_RELDCB;

   9548  5 003360   000006 631400 6                  EPPR1   6
         5 003361   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         5 003362   000000 011000                    NOP     0

      811     9549    4                   END;

      812     9550    3               END; /* ALL OPENED DCB NOW CLOSED */

   9550  5 003363   002003 054000 0                  AOS     III
         5 003364   002003 236000 0                  LDQ     III
         5 003365   000000 116000 xsym               CMPQ    NO_AREAS
         5 003366   003347 604000 5                  TMI     s:9544

      813     9551    2           DCBSF=JRNL_DCB#;

   9551  5 003367   002027 720000 0                  LXL0    JRNL_DCB#
         5 003370   000000 740000 xsym               STX0    DCBSF

      814     9552    2           CALL SYS_FUNC_CLOS;

   9552  5 003371   000006 631400 6                  EPPR1   6
         5 003372   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         5 003373   000000 011000                    NOP     0

      815     9553    2           CALL SYS_FUNC_RELDCB;

   9553  5 003374   000006 631400 6                  EPPR1   6
         5 003375   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         5 003376   000000 011000                    NOP     0

      816     9554    2           GOTO EXIT_RTN;

   9554  5 003377   005546 710000 5                  TRA     EXIT_RTN

      817     9555    2       CASE(#UNDO2); /* ROLL BACK */
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:139  

      818     9556    2           FPT_PFIL.V.DCB#=JRNL_DCB#;

   9556  5 003400   002027 720000 0                  LXL0    JRNL_DCB#
         5 003401   002214 740000 0                  STX0    FPT_PFIL+2

      819     9557    2           CALL M$PFIL(FPT_PFIL);

   9557  5 003402   002212 630400 0                  EPPR0   FPT_PFIL
         5 003403   040004 713400                    CLIMB   16388
         5 003404   400000 401760                    pmme    nvectors=1

      820     9558    3           DO III=1 TO JRNL_CNT;

   9558  5 003405   000001 235007                    LDA     1,DL
         5 003406   002003 755000 0                  STA     III
         5 003407   003415 710000 5                  TRA     s:9561+1

      821     9559    3               CALL JRNL_READ ALTRET(QUIT_UNDO);

   9559  5 003410   000753 701000 5                  TSX1    JRNL_READ
         5 003411   003441 702000 5                  TSX2    QUIT_UNDO

      822     9560    3               CALL WRITE_A_PAGE ALTRET(QUIT_UNDO);

   9560  5 003412   001102 701000 5                  TSX1    WRITE_A_PAGE
         5 003413   003441 702000 5                  TSX2    QUIT_UNDO

      823     9561    3               END;

   9561  5 003414   002003 054000 0                  AOS     III
         5 003415   002026 236000 0                  LDQ     JRNL_CNT
         5 003416   003410 604000 5                  TMI     s:9559
         5 003417   002003 116000 0                  CMPQ    III
         5 003420   003410 605000 5                  TPL     s:9559

      824     9562    2           CALL CONV_DBK(JRNL_CNT,DBK_CUR,V1);
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:140  

   9562  5 003421   000032 237000 6                  LDAQ    26
         5 003422   200306 757100                    STAQ    @DBK_BIN+1,,AUTO
         5 003423   000134 236000 6                  LDQ     92
         5 003424   200305 756100                    STQ     @INDX+3,,AUTO
         5 003425   000721 701000 5                  TSX1    CONV_DBK
         5 003426   000000 011000                    NOP     0

      825     9563    2           CALL CONCAT(BUF,'@    Number of updated pages recovered: ',

   9563  5 003427   040000 100400                    MLR     fill='040'O
         5 003430   000375 000050 1                  ADSC9   DCB_LO+202               cn=0,n=40
         5 003431   002036 000050 0                  ADSC9   BUF                      cn=0,n=40
         5 003432   040000 100400                    MLR     fill='040'O
         5 003433   002062 000012 0                  ADSC9   DBK_CUR                  cn=0,n=10
         5 003434   002050 000050 0                  ADSC9   BUF+10                   cn=0,n=40

      826     9564    2              DBK_CUR);
      827     9565    2           CALL WRITE_A_LINE;

   9565  5 003435   000000 236000 6                  LDQ     0
         5 003436   200301 756100                    STQ     @DBK+1,,AUTO
         5 003437   000003 701000 5                  TSX1    WRITE_A_LINE
         5 003440   000000 011000                    NOP     0

      828     9566    2   QUIT_UNDO: DCBSF=JRNL_DCB#;

   9566  5 003441   002027 720000 0     QUIT_UNDO    LXL0    JRNL_DCB#
         5 003442   000000 740000 xsym               STX0    DCBSF

      829     9567    2           CALL SYS_FUNC_RELEASE;

   9567  5 003443   000006 631400 6                  EPPR1   6
         5 003444   000000 701000 xent               TSX1    SYS_FUNC_RELEASE
         5 003445   000000 011000                    NOP     0

      830     9568    2           GOTO RE_START;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:141  

   9568  5 003446   003256 710000 5                  TRA     RE_START

      831     9569    2       CASE(#HELP2);

      832     9570    2           CALL WRITE_A_LINE('A  The available commands are %');

   9570  5 003447   000135 236000 6                  LDQ     93
         5 003450   200301 756100                    STQ     @DBK+1,,AUTO
         5 003451   000003 701000 5                  TSX1    WRITE_A_LINE
         5 003452   000000 011000                    NOP     0

      833     9571    2           CALL WRITE_A_LINE('A      DISP,WALK,LINK,UNDO,COMMIT,END and QUIT.%');

   9571  5 003453   000136 236000 6                  LDQ     94
         5 003454   200301 756100                    STQ     @DBK+1,,AUTO
         5 003455   000003 701000 5                  TSX1    WRITE_A_LINE
         5 003456   000000 011000                    NOP     0

      834     9572    2           CALL WRITE_A_LINE(
              9572                    '@  To get more info, enter "HELP REPAIR" in directive entry.%');

   9572  5 003457   000137 236000 6                  LDQ     95
         5 003460   200301 756100                    STQ     @DBK+1,,AUTO
         5 003461   000003 701000 5                  TSX1    WRITE_A_LINE
         5 003462   000000 011000                    NOP     0
         5 003463   005545 710000 5                  TRA     s:9873

      835     9573        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:142  
      836     9574    2       CASE(#LINK2,#LYNX2);

      837     9575    2           IF K_CNT=-1 THEN

   9575  5 003464   002121 235000 0                  LDA     K_CNT
         5 003465   000014 115000 6                  CMPA    12
         5 003466   003475 601000 5                  TNZ     s:9577

      838     9576    2               CALL GET_CMD(DBK_DASH_NODE,'@  DBKEY TO PATCH:') ALTRET(NEXT_CMD);

   9576  5 003467   000140 236000 6                  LDQ     96
         5 003470   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003471   000141 236000 6                  LDQ     97
         5 003472   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003473   000345 701000 5                  TSX1    GET_CMD
         5 003474   003264 702000 5                  TSX2    NEXT_CMD

      839     9577    2           IF N_OR_P=0 THEN

   9577  5 003475   002131 235000 0                  LDA     N_OR_P
         5 003476   003505 601000 5                  TNZ     s:9579

      840     9578    2               CALL GET_CMD(NOP_NODE,'@  PRIOR/OWNER/NEXT:') ALTRET(NEXT_CMD);

   9578  5 003477   000142 236000 6                  LDQ     98
         5 003500   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003501   000143 236000 6                  LDQ     99
         5 003502   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003503   000345 701000 5                  TSX1    GET_CMD
         5 003504   003264 702000 5                  TSX2    NEXT_CMD

      841     9579    2           IF S_CNT=-1 AND SC_SIZ>0 THEN

   9579  5 003505   002120 236000 0                  LDQ     S_CNT
         5 003506   777000 376003                    ANQ     -512,DU
         5 003507   777000 116003                    CMPQ    -512,DU
         5 003510   003522 601000 5                  TNZ     s:9582
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:143  
         5 003511   000001 235000 0                  LDA     SC_SIZ
         5 003512   003522 604400 5                  TMOZ    s:9582

      842     9580    2               CALL GET_CMD(SET_NODE,'@  SET-NAME:') ALTRET(NEXT_CMD);

   9580  5 003513   000144 236000 6                  LDQ     100
         5 003514   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003515   000145 236000 6                  LDQ     101
         5 003516   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003517   000345 701000 5                  TSX1    GET_CMD
         5 003520   003264 702000 5                  TSX2    NEXT_CMD
         5 003521   003530 710000 5                  TRA     s:9584

      843     9581    2           ELSE
      844     9582    2               IF S_CNT=-1 THEN

   9582  5 003522   002120 236000 0                  LDQ     S_CNT
         5 003523   777000 376003                    ANQ     -512,DU
         5 003524   777000 116003                    CMPQ    -512,DU
         5 003525   003530 601000 5                  TNZ     s:9584

      845     9583    2                   CALL MOVE_SET_NAME; /* USE DEFAULT SET NAME */

   9583  5 003526   000040 701000 5                  TSX1    MOVE_SET_NAME
         5 003527   000000 011000                    NOP     0

      846     9584    2           CALL VERIFY_SETS ALTRET(NEXT_CMD);

   9584  5 003530   000072 701000 5                  TSX1    VERIFY_SETS
         5 003531   003264 702000 5                  TSX2    NEXT_CMD

      847     9585    2           IF K_CNT=0 OR (K_CNT=1 AND DASH_ON=1) THEN

   9585  5 003532   002121 235000 0                  LDA     K_CNT
         5 003533   003542 600000 5                  TZE     s:9586
         5 003534   000001 115007                    CMPA    1,DL
         5 003535   003550 601000 5                  TNZ     s:9587
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:144  
         5 003536   002123 236000 0                  LDQ     DASH_ON
         5 003537   777000 376003                    ANQ     -512,DU
         5 003540   001000 116003                    CMPQ    512,DU
         5 003541   003550 601000 5                  TNZ     s:9587

      848     9586    2               CALL GET_CMD(DBK_NODE,'@  NEW POINTER:') ALTRET(NEXT_CMD);

   9586  5 003542   000146 236000 6                  LDQ     102
         5 003543   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003544   000147 236000 6                  LDQ     103
         5 003545   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003546   000345 701000 5                  TSX1    GET_CMD
         5 003547   003264 702000 5                  TSX2    NEXT_CMD

      849     9587    2           IF III>1 THEN

   9587  5 003550   002003 235000 0                  LDA     III
         5 003551   000001 115007                    CMPA    1,DL
         5 003552   003557 604400 5                  TMOZ    s:9589

      850     9588    2               CALL WRITE_A_LINE('A%');

   9588  5 003553   000150 236000 6                  LDQ     104
         5 003554   200301 756100                    STQ     @DBK+1,,AUTO
         5 003555   000003 701000 5                  TSX1    WRITE_A_LINE
         5 003556   000000 011000                    NOP     0

      851     9589    2           CALL CHK_SET ALTRET(NEXT_CMD);

   9589  5 003557   001154 701000 5                  TSX1    CHK_SET
         5 003560   003264 702000 5                  TSX2    NEXT_CMD

      852     9590    2           IF PA_DBK.FIR(0)>0 AND PA_DBK.FIR(K_CNT)>0 THEN GOTO TWO_PA;

   9590  5 003561   002132 235000 0                  LDA     PA_DBK
         5 003562   003567 604400 5                  TMOZ    s:9591
         5 003563   002121 236000 0                  LDQ     K_CNT
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:145  
         5 003564   000001 736000                    QLS     1
         5 003565   002132 235006 0                  LDA     PA_DBK,QL
         5 003566   004251 605400 5                  TPNZ    TWO_PA

      853     9591    2           IF K_CNT=2 AND N_OR_P~=#OWNER2 THEN GOTO NOT_AUTO_OWNER;

   9591  5 003567   002121 235000 0                  LDA     K_CNT
         5 003570   000002 115007                    CMPA    2,DL
         5 003571   003575 601000 5                  TNZ     s:9592
         5 003572   002131 236000 0                  LDQ     N_OR_P
         5 003573   000020 116007                    CMPQ    16,DL
         5 003574   004305 601000 5                  TNZ     NOT_AUTO_OWNER

      854     9592    2           CALL FINDBKEY ALTRET(NEXT_CMD);

   9592  5 003575   002226 701000 5                  TSX1    FINDBKEY
         5 003576   003264 702000 5                  TSX2    NEXT_CMD

      855     9593    2           CALL GET_POINTERS(0,0,RC_TYP1) ALTRET(NEXT_CMD);

   9593  5 003577   000152 237000 6                  LDAQ    106
         5 003600   200274 757100                    STAQ    @PTR_TYPE+1,,AUTO
         5 003601   000152 236000 6                  LDQ     106
         5 003602   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003603   001201 701000 5                  TSX1    GET_POINTERS
         5 003604   003264 702000 5                  TSX2    NEXT_CMD

      856     9594    2           IF N_OR_P=#OWNER2 AND SET_HDR.OWNER=' ' THEN GOTO NO_OWNER_PTR;

   9594  5 003605   002131 235000 0                  LDA     N_OR_P
         5 003606   000020 115007                    CMPA    16,DL
         5 003607   003614 601000 5                  TNZ     s:9595
         5 003610   040000 106400                    CMPC    fill='040'O
         5 003611   000015 600012 xsym               ADSC9   SET_HDR+13               cn=3,n=10
         5 003612   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 003613   004256 600000 5                  TZE     NO_OWNER_PTR

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:146  
      857     9595    2           IF FUNC_CODE=#LYNX2 THEN /* SPECIAL LINK COMMAND */

   9595  5 003614   002126 236000 0                  LDQ     FUNC_CODE
         5 003615   777000 376003                    ANQ     -512,DU
         5 003616   011000 116003                    CMPQ    4608,DU
         5 003617   003636 601000 5                  TNZ     s:9602

      858     9596    3           DO; /* FOR DEVELOPMEMT USE */

      859     9597    3               IF RC_TYP1=%PA_ENT THEN

   9597  5 003620   002127 235000 0                  LDA     RC_TYP1
         5 003621   000020 115007                    CMPA    16,DL
         5 003622   003625 601000 5                  TNZ     s:9599

      860     9598    3                   N_OR_P=3+#NEXT2; /* LINK PA POINTER */

   9598  5 003623   000021 235007                    LDA     17,DL
         5 003624   002131 755000 0                  STA     N_OR_P

      861     9599    3               CALL PATCH_IT(N_OR_P,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);

   9599  5 003625   002121 236000 0                  LDQ     K_CNT
         5 003626   000023 736000                    QLS     19
         5 003627   000105 036000 6                  ADLQ    69
         5 003630   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003631   000154 236000 6                  LDQ     108
         5 003632   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003633   002373 701000 5                  TSX1    PATCH_IT
         5 003634   003264 702000 5                  TSX2    NEXT_CMD

      862     9600    3               GOTO NEXT_CMD; /* BYPASS ALL ERROR CHECKING */

   9600  5 003635   003264 710000 5                  TRA     NEXT_CMD

      863     9601    3               END;
      864     9602    2           IF RC_TYP1=%MEMBER AND KEY_RNG.FIR(0)=KEY_RNG.FIR(K_CNT) THEN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:147  

   9602  5 003636   002127 235000 0                  LDA     RC_TYP1
         5 003637   003645 601000 5                  TNZ     s:9604
         5 003640   002121 235000 0                  LDA     K_CNT
         5 003641   000001 735000                    ALS     1
         5 003642   000000 236000 xsym               LDQ     KEY_RNG
         5 003643   000000 116005 xsym               CMPQ    KEY_RNG,AL
         5 003644   004317 600000 5                  TZE     MEM_TO_ITSELF

      865     9603    2               GOTO MEM_TO_ITSELF;
      866     9604    2           KKK=KEY_RNG.FIR(0);

   9604  5 003645   000000 235000 xsym               LDA     KEY_RNG
         5 003646   002005 755000 0                  STA     KKK

      867     9605    2           KEY_RNG.FIR(0)=KEY_RNG.FIR(K_CNT);

   9605  5 003647   002121 236000 0                  LDQ     K_CNT
         5 003650   000001 736000                    QLS     1
         5 003651   000000 235006 xsym               LDA     KEY_RNG,QL
         5 003652   000000 755000 xsym               STA     KEY_RNG

      868     9606    2           CALL FINDBKEY ALTRET(NEXT_CMD);

   9606  5 003653   002226 701000 5                  TSX1    FINDBKEY
         5 003654   003264 702000 5                  TSX2    NEXT_CMD

      869     9607    2           CALL GET_POINTERS(K_CNT,0,RC_TYP2) ALTRET(NEXT_CMD);

   9607  5 003655   000156 237000 6                  LDAQ    110
         5 003656   200274 757100                    STAQ    @PTR_TYPE+1,,AUTO
         5 003657   000160 236000 6                  LDQ     112
         5 003660   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003661   001201 701000 5                  TSX1    GET_POINTERS
         5 003662   003264 702000 5                  TSX2    NEXT_CMD

      870     9608    2           IF RC_TYP1=%OWNER AND RC_TYP2=%OWNER AND
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:148  

   9608  5 003663   002127 235000 0                  LDA     RC_TYP1
         5 003664   000001 115007                    CMPA    1,DL
         5 003665   003677 601000 5                  TNZ     s:9610
         5 003666   002130 236000 0                  LDQ     RC_TYP2
         5 003667   000001 116007                    CMPQ    1,DL
         5 003670   003677 601000 5                  TNZ     s:9610
         5 003671   002121 235000 0                  LDA     K_CNT
         5 003672   000001 735000                    ALS     1
         5 003673   002005 236000 0                  LDQ     KKK
         5 003674   004312 604000 5                  TMI     TWO_OWNERS
         5 003675   000000 116005 xsym               CMPQ    KEY_RNG,AL
         5 003676   004312 601000 5                  TNZ     TWO_OWNERS

      871     9609    2              KKK~=KEY_RNG.FIR(K_CNT) THEN GOTO TWO_OWNERS;
      872     9610    2           IF N_OR_P=#OWNER2 AND (RC_TYP2=%MEMBER OR RC_TYP2=%PA_MEM) THEN

   9610  5 003677   002131 235000 0                  LDA     N_OR_P
         5 003700   000020 115007                    CMPA    16,DL
         5 003701   003706 601000 5                  TNZ     s:9612
         5 003702   002130 236000 0                  LDQ     RC_TYP2
         5 003703   004340 600000 5                  TZE     BAD_OWNER
         5 003704   000010 116007                    CMPQ    8,DL
         5 003705   004340 600000 5                  TZE     BAD_OWNER

      873     9611    2               GOTO BAD_OWNER;
      874     9612    2           IF MSTR_REF.SET.PATYPE(MSTR_INDX)='1'B THEN

   9612  5 003706   000000 236000 xsym               LDQ     MSTR_INDX
         5 003707   000012 402007                    MPY     10,DL
         5 003710   000000 470400 xsym               LDP0    MSTR$
         5 003711   000011 236106                    LDQ     9,QL,PR0
         5 003712   000002 316003                    CANQ    2,DU
         5 003713   004013 600000 5                  TZE     s:9630

      875     9613    3           DO;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:149  
      876     9614    4               DO III=0 TO 11;

   9614  5 003714   002003 450000 0                  STZ     III

      877     9615    4                   IF PA_LINK(III)=RC_TYP1+RC_TYP2 AND

   9615  5 003715   002127 236000 0                  LDQ     RC_TYP1
         5 003716   002130 036000 0                  ADLQ    RC_TYP2
         5 003717   200310 756100                    STQ     @INDX+1,,AUTO
         5 003720   002003 235000 0                  LDA     III
         5 003721   000100 101405                    MRL     fill='000'O
         5 003722   000000 000001 1                  ADSC9   PA_LINK,A                cn=0,n=1
         5 003723   200311 000004                    ADSC9   @INDX+2,,AUTO            cn=0,n=4
         5 003724   200311 236100                    LDQ     @INDX+2,,AUTO
         5 003725   200310 116100                    CMPQ    @INDX+1,,AUTO
         5 003726   003745 601000 5                  TNZ     s:9618
         5 003727   000100 101405                    MRL     fill='000'O
         5 003730   000000 200001 1                  ADSC9   PA_LINK,A                cn=1,n=1
         5 003731   200312 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         5 003732   200312 236100                    LDQ     @INDX+3,,AUTO
         5 003733   002131 116000 0                  CMPQ    N_OR_P
         5 003734   003743 600000 5                  TZE     s:9617
         5 003735   000100 101405                    MRL     fill='000'O
         5 003736   000000 200001 1                  ADSC9   PA_LINK,A                cn=1,n=1
         5 003737   200313 000004                    ADSC9   @INDX+4,,AUTO            cn=0,n=4
         5 003740   200313 236100                    LDQ     @INDX+4,,AUTO
         5 003741   000000 116003                    CMPQ    0,DU
         5 003742   003745 601000 5                  TNZ     s:9618

      878     9616    4                      (N_OR_P=PA_LINK(III+1) OR PA_LINK(III+1)=0) THEN
      879     9617    4                       III=999;

   9617  5 003743   001747 236007                    LDQ     999,DL
         5 003744   002003 756000 0                  STQ     III

      880     9618    4                   III=III+1;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:150  
   9618  5 003745   002003 054000 0                  AOS     III

      881     9619    4                   END;

   9619  5 003746   002003 054000 0                  AOS     III
         5 003747   002003 235000 0                  LDA     III
         5 003750   000013 115007                    CMPA    11,DL
         5 003751   003715 604400 5                  TMOZ    s:9615

      882     9620    3               IF III<999 THEN GOTO ILLEGAL_PA_LINK;

   9620  5 003752   001747 115007                    CMPA    999,DL
         5 003753   004367 604000 5                  TMI     ILLEGAL_PA_LINK

      883     9621    3               IF RC_TYP2=%PA_ENT THEN

   9621  5 003754   002130 236000 0                  LDQ     RC_TYP2
         5 003755   000020 116007                    CMPQ    16,DL
         5 003756   003766 601000 5                  TNZ     s:9624

      884     9622    3                   CALL PATCH_IT(#NEXT2+3,KKK) ALTRET(NEXT_CMD);

   9622  5 003757   000034 236000 6                  LDQ     28
         5 003760   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003761   000162 236000 6                  LDQ     114
         5 003762   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003763   002373 701000 5                  TSX1    PATCH_IT
         5 003764   003264 702000 5                  TSX2    NEXT_CMD
         5 003765   004013 710000 5                  TRA     s:9630

      885     9623    3               ELSE
      886     9624    3                   IF RC_TYP2=%PA_MEM AND RC_TYP1=%PA_ENT THEN

   9624  5 003766   000010 116007                    CMPQ    8,DL
         5 003767   004002 601000 5                  TNZ     s:9627
         5 003770   002127 235000 0                  LDA     RC_TYP1
         5 003771   000020 115007                    CMPA    16,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:151  
         5 003772   004002 601000 5                  TNZ     s:9627

      887     9625    3                       CALL PATCH_IT(#NEXT2,KKK) ALTRET(NEXT_CMD);

   9625  5 003773   000034 236000 6                  LDQ     28
         5 003774   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 003775   000164 236000 6                  LDQ     116
         5 003776   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 003777   002373 701000 5                  TSX1    PATCH_IT
         5 004000   003264 702000 5                  TSX2    NEXT_CMD
         5 004001   004013 710000 5                  TRA     s:9630

      888     9626    3                   ELSE
      889     9627    3                       IF RC_TYP1=%PA_ENT THEN

   9627  5 004002   002127 235000 0                  LDA     RC_TYP1
         5 004003   000020 115007                    CMPA    16,DL
         5 004004   004013 601000 5                  TNZ     s:9630

      890     9628    3                           CALL PATCH_IT(#OWNER2,KKK) ALTRET(NEXT_CMD);

   9628  5 004005   000034 236000 6                  LDQ     28
         5 004006   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004007   000166 236000 6                  LDQ     118
         5 004010   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004011   002373 701000 5                  TSX1    PATCH_IT
         5 004012   003264 702000 5                  TSX2    NEXT_CMD

      891     9629    3               END;

      892     9630    2           IF PA_DBK.FIR(0)=0 AND PA_DBK.FIR(K_CNT)=0 THEN

   9630  5 004013   002132 235000 0                  LDA     PA_DBK
         5 004014   004043 601000 5                  TNZ     s:9638
         5 004015   002121 236000 0                  LDQ     K_CNT
         5 004016   000001 736000                    QLS     1
         5 004017   002132 235006 0                  LDA     PA_DBK,QL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:152  
         5 004020   004043 601000 5                  TNZ     s:9638

      893     9631    3           DO;

      894     9632    3               IF N_OR_P=#NEXT2 THEN

   9632  5 004021   002131 235000 0                  LDA     N_OR_P
         5 004022   000016 115007                    CMPA    14,DL
         5 004023   004033 601000 5                  TNZ     s:9635

      895     9633    3                   CALL PATCH_IT(#PRIOR2,KKK) ALTRET(NEXT_CMD);

   9633  5 004024   000034 236000 6                  LDQ     28
         5 004025   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004026   000170 236000 6                  LDQ     120
         5 004027   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004030   002373 701000 5                  TSX1    PATCH_IT
         5 004031   003264 702000 5                  TSX2    NEXT_CMD
         5 004032   004043 710000 5                  TRA     s:9638

      896     9634    3               ELSE
      897     9635    3                   IF N_OR_P=#PRIOR2 THEN

   9635  5 004033   000017 115007                    CMPA    15,DL
         5 004034   004043 601000 5                  TNZ     s:9638

      898     9636    3                       CALL PATCH_IT(#NEXT2,KKK) ALTRET(NEXT_CMD);

   9636  5 004035   000034 236000 6                  LDQ     28
         5 004036   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004037   000164 236000 6                  LDQ     116
         5 004040   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004041   002373 701000 5                  TSX1    PATCH_IT
         5 004042   003264 702000 5                  TSX2    NEXT_CMD

      899     9637    3               END;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:153  
      900     9638    2           KEY_RNG.FIR(0)=KKK;

   9638  5 004043   002005 235000 0                  LDA     KKK
         5 004044   000000 755000 xsym               STA     KEY_RNG

      901     9639    2   AUTO_OWNER: /* AUTO OWNER POINTER PATCH */
      902     9640    2           CALL FINDBKEY ALTRET(BAD_LINK);

   9640  5 004045   002226 701000 5     AUTO_OWNER   TSX1    FINDBKEY
         5 004046   004157 702000 5                  TSX2    BAD_LINK

      903     9641    2           CALL GET_POINTERS(0,0,RC_TYP1) ALTRET(BAD_LINK);

   9641  5 004047   000152 237000 6                  LDAQ    106
         5 004050   200274 757100                    STAQ    @PTR_TYPE+1,,AUTO
         5 004051   000152 236000 6                  LDQ     106
         5 004052   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004053   001201 701000 5                  TSX1    GET_POINTERS
         5 004054   004157 702000 5                  TSX2    BAD_LINK

      904     9642    2           IF RC_TYP1 = %OWNER AND DASH_ON = 1 THEN

   9642  5 004055   002127 235000 0                  LDA     RC_TYP1
         5 004056   000001 115007                    CMPA    1,DL
         5 004057   004064 601000 5                  TNZ     s:9644
         5 004060   002123 236000 0                  LDQ     DASH_ON
         5 004061   777000 376003                    ANQ     -512,DU
         5 004062   001000 116003                    CMPQ    512,DU
         5 004063   004140 600000 5                  TZE     NEXT_MEMBER

      905     9643    2               GOTO NEXT_MEMBER;
      906     9644    2           IF PA_DBK.FIR(0)=0 AND PA_DBK.SEC(0)=0 THEN

   9644  5 004064   002132 236000 0                  LDQ     PA_DBK
         5 004065   004101 601000 5                  TNZ     s:9648
         5 004066   002133 235000 0                  LDA     PA_DBK+1
         5 004067   004101 601000 5                  TNZ     s:9648
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:154  

      907     9645    2               CALL PATCH_IT(N_OR_P,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);

   9645  5 004070   002121 236000 0                  LDQ     K_CNT
         5 004071   000023 736000                    QLS     19
         5 004072   000105 036000 6                  ADLQ    69
         5 004073   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004074   000154 236000 6                  LDQ     108
         5 004075   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004076   002373 701000 5                  TSX1    PATCH_IT
         5 004077   003264 702000 5                  TSX2    NEXT_CMD
         5 004100   004140 710000 5                  TRA     NEXT_MEMBER

      908     9646    2           ELSE
      909     9647    3           DO;

      910     9648    3               IF RC_TYP1=%PA_ENT THEN

   9648  5 004101   002127 235000 0                  LDA     RC_TYP1
         5 004102   000020 115007                    CMPA    16,DL
         5 004103   004115 601000 5                  TNZ     s:9651

      911     9649    3                   CALL PATCH_IT(3+#NEXT2,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);

   9649  5 004104   002121 236000 0                  LDQ     K_CNT
         5 004105   000023 736000                    QLS     19
         5 004106   000105 036000 6                  ADLQ    69
         5 004107   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004110   000162 236000 6                  LDQ     114
         5 004111   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004112   002373 701000 5                  TSX1    PATCH_IT
         5 004113   003264 702000 5                  TSX2    NEXT_CMD
         5 004114   004140 710000 5                  TRA     NEXT_MEMBER

      912     9650    3               ELSE
      913     9651    3                   IF RC_TYP1=%PA_MEM THEN

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:155  
   9651  5 004115   000010 115007                    CMPA    8,DL
         5 004116   004130 601000 5                  TNZ     s:9654

      914     9652    3                       CALL PATCH_IT(#NEXT2,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);

   9652  5 004117   002121 236000 0                  LDQ     K_CNT
         5 004120   000023 736000                    QLS     19
         5 004121   000105 036000 6                  ADLQ    69
         5 004122   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004123   000164 236000 6                  LDQ     116
         5 004124   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004125   002373 701000 5                  TSX1    PATCH_IT
         5 004126   003264 702000 5                  TSX2    NEXT_CMD
         5 004127   004140 710000 5                  TRA     NEXT_MEMBER

      915     9653    3                   ELSE
      916     9654    3                       CALL PATCH_IT(#OWNER2,KEY_RNG.FIR(K_CNT)) ALTRET(NEXT_CMD);

   9654  5 004130   002121 236000 0                  LDQ     K_CNT
         5 004131   000023 736000                    QLS     19
         5 004132   000105 036000 6                  ADLQ    69
         5 004133   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004134   000166 236000 6                  LDQ     118
         5 004135   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004136   002373 701000 5                  TSX1    PATCH_IT
         5 004137   003264 702000 5                  TSX2    NEXT_CMD

      917     9655    3               END;

      918     9656    2   NEXT_MEMBER:
      919     9657    2           KEY_RNG.FIR(0)=N_K;

   9657  5 004140   002014 235000 0     NEXT_MEMBER  LDA     N_K
         5 004141   000000 755000 xsym               STA     KEY_RNG

      920     9658    2          IF DASH_ON=1 AND N_K~=KKK AND KEY_RNG.FIR(0)~=KEY_RNG.FIR(1) AND BREAK_FLAG=
              9658                    0 THEN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:156  

   9658  5 004142   002123 236000 0                  LDQ     DASH_ON
         5 004143   777000 376003                    ANQ     -512,DU
         5 004144   001000 116003                    CMPQ    512,DU
         5 004145   004157 601000 5                  TNZ     BAD_LINK
         5 004146   002014 236000 0                  LDQ     N_K
         5 004147   004152 604000 5                  TMI     s:9658+8
         5 004150   002005 116000 0                  CMPQ    KKK
         5 004151   004157 600000 5                  TZE     BAD_LINK
         5 004152   000000 236000 xsym               LDQ     KEY_RNG
         5 004153   000002 116000 xsym               CMPQ    KEY_RNG+2
         5 004154   004157 600000 5                  TZE     BAD_LINK
         5 004155   000000 235000 xsym               LDA     BREAK_FLAG
         5 004156   004045 600000 5                  TZE     AUTO_OWNER

      921     9659    2               GOTO AUTO_OWNER; /* REPAIR OWNER POINTERS */
      922     9660    2   BAD_LINK:
      923     9661    2           IF DASH_ON=1 THEN

   9661  5 004157   002123 236000 0     BAD_LINK     LDQ     DASH_ON
         5 004160   777000 376003                    ANQ     -512,DU
         5 004161   001000 116003                    CMPQ    512,DU
         5 004162   004250 601000 5                  TNZ     s:9670

      924     9662    3           DO;

      925     9663    3               CALL CONV_DBK(WALK_CNT,DBK_CUR,V1);

   9663  5 004163   000032 237000 6                  LDAQ    26
         5 004164   200306 757100                    STAQ    @DBK_BIN+1,,AUTO
         5 004165   000171 236000 6                  LDQ     121
         5 004166   200305 756100                    STQ     @INDX+3,,AUTO
         5 004167   000721 701000 5                  TSX1    CONV_DBK
         5 004170   000000 011000                    NOP     0

      926     9664    3               CALL CONV_DBK(OWNER_CNT,PA_POINTER,V2);

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:157  
   9664  5 004171   000172 237000 6                  LDAQ    122
         5 004172   200306 757100                    STAQ    @DBK_BIN+1,,AUTO
         5 004173   000174 236000 6                  LDQ     124
         5 004174   200305 756100                    STQ     @INDX+3,,AUTO
         5 004175   000721 701000 5                  TSX1    CONV_DBK
         5 004176   000000 011000                    NOP     0

      927     9665    3               CALL CONCAT(BUF,'a    ',ADDR(DBK_CUR)->DBK_V,

   9665  5 004177   040000 100400                    MLR     fill='040'O
         5 004200   000475 000005 1                  ADSC9   DCB_LO+266               cn=0,n=5
         5 004201   002036 000005 0                  ADSC9   BUF                      cn=0,n=5
         5 004202   002006 720000 0                  LXL0    V1
         5 004203   040000 100440                    MLR     fill='040'O
         5 004204   002062 000010 0                  ADSC9   DBK_CUR                  cn=0,n=*X0
         5 004205   002037 200113 0                  ADSC9   BUF+1                    cn=1,n=75
         5 004206   002006 236000 0                  LDQ     V1
         5 004207   000113 116007                    CMPQ    75,DL
         5 004210   004244 603000 5                  TRC     s:9668
         5 004211   777664 621006                    EAX1    -76,QL
         5 004212   777777 661003                    ERX1    -1,DU
         5 004213   040046 100400                    MLR     fill='040'O
         5 004214   000477 000034 1                  ADSC9   DCB_LO+268               cn=0,n=28
         5 004215   002037 200011 0                  ADSC9   BUF+1,Q                  cn=1,n=*X1
         5 004216   002006 236000 0                  LDQ     V1
         5 004217   000057 116007                    CMPQ    47,DL
         5 004220   004244 603000 5                  TRC     s:9668
         5 004221   777720 620006                    EAX0    -48,QL
         5 004222   777777 660003                    ERX0    -1,DU
         5 004223   002007 721000 0                  LXL1    V2
         5 004224   040046 100440                    MLR     fill='040'O
         5 004225   002033 000011 0                  ADSC9   PA_POINTER               cn=0,n=*X1
         5 004226   002046 200010 0                  ADSC9   BUF+8,Q                  cn=1,n=*X0
         5 004227   002006 236000 0                  LDQ     V1
         5 004230   002007 036000 0                  ADLQ    V2
         5 004231   000057 116007                    CMPQ    47,DL
         5 004232   004244 603000 5                  TRC     s:9668
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:158  
         5 004233   200310 756100                    STQ     @INDX+1,,AUTO
         5 004234   002006 236000 0                  LDQ     V1
         5 004235   002007 036000 0                  ADLQ    V2
         5 004236   200310 720100                    LXL0    @INDX+1,,AUTO
         5 004237   777720 620010                    EAX0    -48,X0
         5 004240   777777 660003                    ERX0    -1,DU
         5 004241   040046 100400                    MLR     fill='040'O
         5 004242   000506 000012 1                  ADSC9   DCB_LO+275               cn=0,n=10
         5 004243   002046 200010 0                  ADSC9   BUF+8,Q                  cn=1,n=*X0

      928     9666    3                  ' OWNER pointers patched and ',
      929     9667    3                  ADDR(PA_POINTER)->REC_V,' unchanged');
      930     9668    3               CALL WRITE_A_LINE;

   9668  5 004244   000000 236000 6                  LDQ     0
         5 004245   200301 756100                    STQ     @DBK+1,,AUTO
         5 004246   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004247   000000 011000                    NOP     0

      931     9669    3               END;

      932     9670    2           GOTO NEXT_CMD;

   9670  5 004250   003264 710000 5                  TRA     NEXT_CMD

      933     9671    2   TWO_PA:
      934     9672    2           CALL WRITE_A_LINE('@   No linkage between PA entries%');

   9672  5 004251   000175 236000 6     TWO_PA       LDQ     125
         5 004252   200301 756100                    STQ     @DBK+1,,AUTO
         5 004253   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004254   000000 011000                    NOP     0

      935     9673    2           GOTO NEXT_CMD;

   9673  5 004255   003264 710000 5                  TRA     NEXT_CMD

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:159  
      936     9674    2   NO_OWNER_PTR:
      937     9675    2           CALL CONCAT(BUF,'@   ',DBK_REC,' has no OWNER pointer in set ',

   9675  5 004256   000375 236000 1     NO_OWNER_PTR LDQ     DCB_LO+202
         5 004257   002036 756000 0                  STQ     BUF
         5 004260   002023 470400 0                  LDP0    DBK_REC$
         5 004261   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 004262   040000 100540                    MLR     fill='040'O
         5 004263   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 004264   002037 000114 0                  ADSC9   BUF+1                    cn=0,n=76
         5 004265   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 004266   000114 116007                    CMPQ    76,DL
         5 004267   004304 603000 5                  TRC     s:9677
         5 004270   777663 621006                    EAX1    -77,QL
         5 004271   777777 661003                    ERX1    -1,DU
         5 004272   040046 100400                    MLR     fill='040'O
         5 004273   000522 000035 1                  ADSC9   DCB_LO+287               cn=0,n=29
         5 004274   002037 000011 0                  ADSC9   BUF+1,Q                  cn=0,n=*X1
         5 004275   000057 116007                    CMPQ    47,DL
         5 004276   004304 603000 5                  TRC     s:9677
         5 004277   777720 622006                    EAX2    -48,QL
         5 004300   777777 662003                    ERX2    -1,DU
         5 004301   040046 100400                    MLR     fill='040'O
         5 004302   000000 000036 xsym               ADSC9   ITEM_LIST                cn=0,n=30
         5 004303   002046 200012 0                  ADSC9   BUF+8,Q                  cn=1,n=*X2

      938     9676    2              ITEM_LIST.NAME(0));
      939     9677    2           GOTO ALT_LINK;

   9677  5 004304   004400 710000 5                  TRA     ALT_LINK

      940     9678    2   NOT_AUTO_OWNER:
      941     9679    2           CALL WRITE_A_LINE('@   Auto repair for OWNER pointers only%');

   9679  5 004305   000176 236000 6     NOT_AUTO_OW* LDQ     126
         5 004306   200301 756100                    STQ     @DBK+1,,AUTO
         5 004307   000003 701000 5                  TSX1    WRITE_A_LINE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:160  
         5 004310   000000 011000                    NOP     0

      942     9680    2           GOTO NEXT_CMD;

   9680  5 004311   003264 710000 5                  TRA     NEXT_CMD

      943     9681    2   TWO_OWNERS:
      944     9682    2           CALL WRITE_A_LINE('@   Cannot link two owners for you%');

   9682  5 004312   000177 236000 6     TWO_OWNERS   LDQ     127
         5 004313   200301 756100                    STQ     @DBK+1,,AUTO
         5 004314   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004315   000000 011000                    NOP     0

      945     9683    2           GOTO NEXT_CMD;

   9683  5 004316   003264 710000 5                  TRA     NEXT_CMD

      946     9684    2   MEM_TO_ITSELF:
      947     9685    2           CALL CONCAT(BUF,'@  Member record ',DBK_REC,' cannot be linked to itself');

   9685  5 004317   040000 100400       MEM_TO_ITSE* MLR     fill='040'O
         5 004320   000555 000022 1                  ADSC9   DCB_LO+314               cn=0,n=18
         5 004321   002036 000022 0                  ADSC9   BUF                      cn=0,n=18
         5 004322   002023 470400 0                  LDP0    DBK_REC$
         5 004323   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 004324   040000 100540                    MLR     fill='040'O
         5 004325   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 004326   002042 400076 0                  ADSC9   BUF+4                    cn=2,n=62
         5 004327   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 004330   000076 116007                    CMPQ    62,DL
         5 004331   004337 603000 5                  TRC     s:9686
         5 004332   777701 621006                    EAX1    -63,QL
         5 004333   777777 661003                    ERX1    -1,DU
         5 004334   040046 100400                    MLR     fill='040'O
         5 004335   000562 000033 1                  ADSC9   DCB_LO+319               cn=0,n=27
         5 004336   002042 400011 0                  ADSC9   BUF+4,Q                  cn=2,n=*X1
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:161  

      948     9686    2           GOTO ALT_LINK;

   9686  5 004337   004400 710000 5                  TRA     ALT_LINK

      949     9687    2   BAD_OWNER:
      950     9688    2           CALL CONCAT(BUF,'@   ',DBK_REC,' is not an owner in set ',

   9688  5 004340   000375 236000 1     BAD_OWNER    LDQ     DCB_LO+202
         5 004341   002036 756000 0                  STQ     BUF
         5 004342   002023 470400 0                  LDP0    DBK_REC$
         5 004343   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 004344   040000 100540                    MLR     fill='040'O
         5 004345   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 004346   002037 000114 0                  ADSC9   BUF+1                    cn=0,n=76
         5 004347   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 004350   000114 116007                    CMPQ    76,DL
         5 004351   004366 603000 5                  TRC     s:9690
         5 004352   777663 621006                    EAX1    -77,QL
         5 004353   777777 661003                    ERX1    -1,DU
         5 004354   040046 100400                    MLR     fill='040'O
         5 004355   000571 000030 1                  ADSC9   DCB_LO+326               cn=0,n=24
         5 004356   002037 000011 0                  ADSC9   BUF+1,Q                  cn=0,n=*X1
         5 004357   000064 116007                    CMPQ    52,DL
         5 004360   004366 603000 5                  TRC     s:9690
         5 004361   777713 622006                    EAX2    -53,QL
         5 004362   777777 662003                    ERX2    -1,DU
         5 004363   040046 100400                    MLR     fill='040'O
         5 004364   000000 000036 xsym               ADSC9   ITEM_LIST                cn=0,n=30
         5 004365   002045 000012 0                  ADSC9   BUF+7,Q                  cn=0,n=*X2

      951     9689    2              ITEM_LIST.NAME(0));
      952     9690    2           GOTO ALT_LINK;

   9690  5 004366   004400 710000 5                  TRA     ALT_LINK

      953     9691    2   ILLEGAL_PA_LINK:
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:162  
      954     9692    2           CALL WRITE_A_LINE('A   This type of link is not legal in a PA set%');

   9692  5 004367   000200 236000 6     ILLEGAL_PA_* LDQ     128
         5 004370   200301 756100                    STQ     @DBK+1,,AUTO
         5 004371   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004372   000000 011000                    NOP     0

      955     9693    2           CALL WRITE_A_LINE('@   Please check and retry%');

   9693  5 004373   000201 236000 6                  LDQ     129
         5 004374   200301 756100                    STQ     @DBK+1,,AUTO
         5 004375   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004376   000000 011000                    NOP     0

      956     9694    2           GOTO NEXT_CMD;

   9694  5 004377   003264 710000 5                  TRA     NEXT_CMD

      957     9695    2   ALT_LINK:
      958     9696    2           CALL WRITE_A_LINE;

   9696  5 004400   000000 236000 6     ALT_LINK     LDQ     0
         5 004401   200301 756100                    STQ     @DBK+1,,AUTO
         5 004402   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004403   000000 011000                    NOP     0
         5 004404   005545 710000 5                  TRA     s:9873

      959     9697    2       CASE(#DELETE2); /* REMOVE A RECORD */

      960     9698        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:163  
      961     9699    2       CASE(#CHKPNT2); /* CHECK POINT */

      962     9700    2           CALL CONV_DBK(JRNL_CNT,DBK_CUR,V1);

   9700  5 004405   000032 237000 6                  LDAQ    26
         5 004406   200306 757100                    STAQ    @DBK_BIN+1,,AUTO
         5 004407   000134 236000 6                  LDQ     92
         5 004410   200305 756100                    STQ     @INDX+3,,AUTO
         5 004411   000721 701000 5                  TSX1    CONV_DBK
         5 004412   000000 011000                    NOP     0

      963     9701    2           CALL CONCAT(BUF,'@    Number of updated pages committed: ',

   9701  5 004413   040000 100400                    MLR     fill='040'O
         5 004414   000622 000050 1                  ADSC9   DCB_LO+351               cn=0,n=40
         5 004415   002036 000050 0                  ADSC9   BUF                      cn=0,n=40
         5 004416   040000 100400                    MLR     fill='040'O
         5 004417   002062 000012 0                  ADSC9   DBK_CUR                  cn=0,n=10
         5 004420   002050 000050 0                  ADSC9   BUF+10                   cn=0,n=40

      964     9702    2              DBK_CUR);
      965     9703    2           JRNL_CNT=0;

   9703  5 004421   002026 450000 0                  STZ     JRNL_CNT

      966     9704    2           DCBSF=JRNL_DCB#;

   9704  5 004422   002027 720000 0                  LXL0    JRNL_DCB#
         5 004423   000000 740000 xsym               STX0    DCBSF

      967     9705    2           CALL SYS_FUNC_CLOS;

   9705  5 004424   000006 631400 6                  EPPR1   6
         5 004425   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         5 004426   000000 011000                    NOP     0

      968     9706    2           CALL WRITE_A_LINE;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:164  

   9706  5 004427   000000 236000 6                  LDQ     0
         5 004430   200301 756100                    STQ     @DBK+1,,AUTO
         5 004431   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004432   000000 011000                    NOP     0

      969     9707    2           GOTO RE_START;

   9707  5 004433   003256 710000 5                  TRA     RE_START

      970     9708        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:165  
      971     9709    2       CASE(#WALK2); /* WALK A SET */

      972     9710    2           IF K_CNT=-1 THEN

   9710  5 004434   002121 235000 0                  LDA     K_CNT
         5 004435   000014 115000 6                  CMPA    12
         5 004436   004445 601000 5                  TNZ     s:9712

      973     9711    2               CALL GET_CMD(DBK_NODE,'@  DBKEY TO START:') ALTRET(NEXT_CMD);

   9711  5 004437   000202 236000 6                  LDQ     130
         5 004440   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004441   000147 236000 6                  LDQ     103
         5 004442   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004443   000345 701000 5                  TSX1    GET_CMD
         5 004444   003264 702000 5                  TSX2    NEXT_CMD

      974     9712    2           IF N_OR_P=0 THEN

   9712  5 004445   002131 235000 0                  LDA     N_OR_P
         5 004446   004455 601000 5                  TNZ     s:9714

      975     9713    2               CALL GET_CMD(N_OR_P_NODE,'@  NEXT/PRIOR:') ALTRET(NEXT_CMD);

   9713  5 004447   000203 236000 6                  LDQ     131
         5 004450   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004451   000204 236000 6                  LDQ     132
         5 004452   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004453   000345 701000 5                  TSX1    GET_CMD
         5 004454   003264 702000 5                  TSX2    NEXT_CMD

      976     9714    2           IF S_CNT=-1 AND SC_SIZ>0 THEN

   9714  5 004455   002120 236000 0                  LDQ     S_CNT
         5 004456   777000 376003                    ANQ     -512,DU
         5 004457   777000 116003                    CMPQ    -512,DU
         5 004460   004472 601000 5                  TNZ     s:9717
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:166  
         5 004461   000001 235000 0                  LDA     SC_SIZ
         5 004462   004472 604400 5                  TMOZ    s:9717

      977     9715    2               CALL GET_CMD(SET_NODE,'@  SET TO WALK: ') ALTRET(NEXT_CMD);

   9715  5 004463   000205 236000 6                  LDQ     133
         5 004464   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004465   000145 236000 6                  LDQ     101
         5 004466   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004467   000345 701000 5                  TSX1    GET_CMD
         5 004470   003264 702000 5                  TSX2    NEXT_CMD
         5 004471   004500 710000 5                  TRA     s:9719

      978     9716    2           ELSE
      979     9717    2               IF S_CNT=-1 THEN

   9717  5 004472   002120 236000 0                  LDQ     S_CNT
         5 004473   777000 376003                    ANQ     -512,DU
         5 004474   777000 116003                    CMPQ    -512,DU
         5 004475   004500 601000 5                  TNZ     s:9719

      980     9718    2                   CALL MOVE_SET_NAME;

   9718  5 004476   000040 701000 5                  TSX1    MOVE_SET_NAME
         5 004477   000000 011000                    NOP     0

      981     9719    2           CALL VERIFY_SETS ALTRET(NEXT_CMD);

   9719  5 004500   000072 701000 5                  TSX1    VERIFY_SETS
         5 004501   003264 702000 5                  TSX2    NEXT_CMD

      982     9720    2           IF K_CNT=0 AND III>=3 THEN

   9720  5 004502   002121 235000 0                  LDA     K_CNT
         5 004503   004515 601000 5                  TNZ     s:9722
         5 004504   002003 236000 0                  LDQ     III
         5 004505   000003 116007                    CMPQ    3,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:167  
         5 004506   004515 604000 5                  TMI     s:9722

      983     9721    2               CALL GET_CMD(DBK_LIST_NODE,'@  DBKEYs TO STOP:') ALTRET(NEXT_CMD);

   9721  5 004507   000206 236000 6                  LDQ     134
         5 004510   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004511   000207 236000 6                  LDQ     135
         5 004512   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004513   000345 701000 5                  TSX1    GET_CMD
         5 004514   003264 702000 5                  TSX2    NEXT_CMD

      984     9722    2           K_CNT=K_CNT+1; /* FORCE TO STOP AT STARTING DBK */

   9722  5 004515   002121 054000 0                  AOS     K_CNT

      985     9723    2           KEY_RNG.FIR(K_CNT)=KEY_RNG.FIR(0);

   9723  5 004516   002121 235000 0                  LDA     K_CNT
         5 004517   000001 735000                    ALS     1
         5 004520   000000 236000 xsym               LDQ     KEY_RNG
         5 004521   000000 756005 xsym               STQ     KEY_RNG,AL

      986     9724    2           PA_DBK.FIR(0)=0; /* IGNORE PA ENTRY NUMBER */

   9724  5 004522   002132 450000 0                  STZ     PA_DBK

      987     9725    2           IF WALK_OPT=1 AND R_CNT=-1 AND III<3 THEN

   9725  5 004523   002116 236000 0                  LDQ     WALK_OPT
         5 004524   777000 376003                    ANQ     -512,DU
         5 004525   001000 116003                    CMPQ    512,DU
         5 004526   004540 601000 5                  TNZ     s:9727
         5 004527   002117 236000 0                  LDQ     R_CNT
         5 004530   777000 376003                    ANQ     -512,DU
         5 004531   777000 116003                    CMPQ    -512,DU
         5 004532   004540 601000 5                  TNZ     s:9727
         5 004533   002003 236000 0                  LDQ     III
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:168  
         5 004534   000003 116007                    CMPQ    3,DL
         5 004535   004540 605000 5                  TPL     s:9727

      988     9726    2               WALK_OPT=#ALL2; /* DEFAULT WALK OPTION ALL */

   9726  5 004536   014000 236003                    LDQ     6144,DU
         5 004537   002116 756000 0                  STQ     WALK_OPT

      989     9727    2           IF WALK_OPT=1 AND R_CNT=-1 THEN

   9727  5 004540   002116 236000 0                  LDQ     WALK_OPT
         5 004541   777000 376003                    ANQ     -512,DU
         5 004542   001000 116003                    CMPQ    512,DU
         5 004543   004556 601000 5                  TNZ     s:9730
         5 004544   002117 236000 0                  LDQ     R_CNT
         5 004545   777000 376003                    ANQ     -512,DU
         5 004546   777000 116003                    CMPQ    -512,DU
         5 004547   004556 601000 5                  TNZ     s:9730

      990     9728    2               CALL GET_CMD(WALK_OPT_NODE,

   9728  5 004550   000210 236000 6                  LDQ     136
         5 004551   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 004552   000211 236000 6                  LDQ     137
         5 004553   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004554   000345 701000 5                  TSX1    GET_CMD
         5 004555   003264 702000 5                  TSX2    NEXT_CMD

      991     9729    2                  '@  TRACE(ALL/OWNER/MEMBER/RECORD-LIST):') ALTRET(NEXT_CMD);
      992     9730    2           IF III>1 THEN CALL WRITE_A_LINE('A%');

   9730  5 004556   002003 235000 0                  LDA     III
         5 004557   000001 115007                    CMPA    1,DL
         5 004560   004565 604400 5                  TMOZ    s:9731

   9730  5 004561   000150 236000 6                  LDQ     104
         5 004562   200301 756100                    STQ     @DBK+1,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:169  
         5 004563   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004564   000000 011000                    NOP     0

      993     9731    2           KCNT_SAVE = K_CNT; /* TO TELL STOP BY DEFAULT OR NOT */

   9731  5 004565   002121 235000 0                  LDA     K_CNT
         5 004566   000033 735000                    ALS     27
         5 004567   002124 755000 0                  STA     KCNT_SAVE

      994     9732    2           TRACE_CNT=0;

   9732  5 004570   002031 450000 0                  STZ     TRACE_CNT

      995     9733    2           OWNER_KEY=-1;

   9733  5 004571   000001 336007                    LCQ     1,DL
         5 004572   002203 756000 0                  STQ     OWNER_KEY

      996     9734    2           C_POS=255;

   9734  5 004573   000377 235007                    LDA     255,DL
         5 004574   002021 755000 0                  STA     C_POS

      997     9735    2           BAD_FLAG=0;

   9735  5 004575   002206 450000 0                  STZ     BAD_FLAG

      998     9736    2           ADD_FLAG=0;

   9736  5 004576   002125 450000 0                  STZ     ADD_FLAG

      999     9737    2           PRIOR_KEY=KEY_RNG.FIR(0);

   9737  5 004577   000000 235000 xsym               LDA     KEY_RNG
         5 004600   002204 755000 0                  STA     PRIOR_KEY

     1000     9738    2   KEEP_WALKING:
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:170  
     1001     9739    2           CALL FINDBKEY ALTRET(ABN_WALK);

   9739  5 004601   002226 701000 5     KEEP_WALKING TSX1    FINDBKEY
         5 004602   005026 702000 5                  TSX2    ABN_WALK

     1002     9740    2           CALL GET_POINTERS(0,0,RC_TYP1) ALTRET(ABN_WALK);

   9740  5 004603   000152 237000 6                  LDAQ    106
         5 004604   200274 757100                    STAQ    @PTR_TYPE+1,,AUTO
         5 004605   000152 236000 6                  LDQ     106
         5 004606   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004607   001201 701000 5                  TSX1    GET_POINTERS
         5 004610   005026 702000 5                  TSX2    ABN_WALK

     1003     9741    2           CURRENT_KEY=KEY_RNG.FIR(0);

   9741  5 004611   000000 235000 xsym               LDA     KEY_RNG
         5 004612   002207 755000 0                  STA     CURRENT_KEY

     1004     9742    2           IF N_OR_P=#NEXT2 THEN

   9742  5 004613   002131 236000 0                  LDQ     N_OR_P
         5 004614   000016 116007                    CMPQ    14,DL
         5 004615   004621 601000 5                  TNZ     s:9745

     1005     9743    2               KEY_RNG.FIR(0)=N_K; /* FOLLOW NEXT POINTER */

   9743  5 004616   002014 235000 0                  LDA     N_K
         5 004617   000000 755000 xsym               STA     KEY_RNG
         5 004620   004623 710000 5                  TRA     s:9746

     1006     9744    2           ELSE
     1007     9745    2               KEY_RNG.FIR(0)=P_K; /* ELSE PRIOR POINTER */

   9745  5 004621   002015 235000 0                  LDA     P_K
         5 004622   000000 755000 xsym               STA     KEY_RNG

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:171  
     1008     9746    2           IF WALK_CNT=0 THEN

   9746  5 004623   002030 235000 0                  LDA     WALK_CNT
         5 004624   004661 601000 5                  TNZ     s:9761

     1009     9747    3           DO;

     1010     9748    3               CALL CONCAT(BUF,'A  Starts at ',DBK_REC);

   9748  5 004625   040000 100400                    MLR     fill='040'O
         5 004626   000670 000015 1                  ADSC9   DCB_LO+389               cn=0,n=13
         5 004627   002036 000015 0                  ADSC9   BUF                      cn=0,n=13
         5 004630   002023 470400 0                  LDP0    DBK_REC$
         5 004631   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 004632   040000 100540                    MLR     fill='040'O
         5 004633   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 004634   002041 200103 0                  ADSC9   BUF+3                    cn=1,n=67

     1011     9749    3               CALL WRITE_A_LINE;

   9749  5 004635   000000 236000 6                  LDQ     0
         5 004636   200301 756100                    STQ     @DBK+1,,AUTO
         5 004637   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004640   000000 011000                    NOP     0

     1012     9750    3               IF RC_TYP1 = %PA_MEM THEN

   9750  5 004641   002127 235000 0                  LDA     RC_TYP1
         5 004642   000010 115007                    CMPA    8,DL
         5 004643   004651 601000 5                  TNZ     s:9755

     1013     9751    4               DO;

     1014     9752    4                   CALL WRITE_A_LINE('@  Stops at any PA member%');

   9752  5 004644   000212 236000 6                  LDQ     138
         5 004645   200301 756100                    STQ     @DBK+1,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:172  
         5 004646   000003 701000 5                  TSX1    WRITE_A_LINE
         5 004647   000000 011000                    NOP     0

     1015     9753    4                   GOTO NEXT_CMD;

   9753  5 004650   003264 710000 5                  TRA     NEXT_CMD

     1016     9754    4                   END;
     1017     9755    3               IF RC_TYP1 = %OWNER THEN

   9755  5 004651   000001 115007                    CMPA    1,DL
         5 004652   004656 601000 5                  TNZ     s:9758

     1018     9756    3                   OWNER_KEY = CURRENT_KEY;

   9756  5 004653   002207 236000 0                  LDQ     CURRENT_KEY
         5 004654   002203 756000 0                  STQ     OWNER_KEY
         5 004655   004660 710000 5                  TRA     s:9759

     1019     9757    3               ELSE
     1020     9758    3                   OWNER_KEY = O_K;

   9758  5 004656   002016 236000 0                  LDQ     O_K
         5 004657   002203 756000 0                  STQ     OWNER_KEY

     1021     9759    3               GOTO ADD_CNT;

   9759  5 004660   004774 710000 5                  TRA     ADD_CNT

     1022     9760    3               END;
     1023     9761    2           IF RC_TYP1=%OWNER THEN

   9761  5 004661   002127 235000 0                  LDA     RC_TYP1
         5 004662   000001 115007                    CMPA    1,DL
         5 004663   004666 601000 5                  TNZ     s:9763

     1024     9762    2               O_K = CURRENT_KEY; /* USE DBK AS OWNER'S OWNER PTR */
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:173  

   9762  5 004664   002207 235000 0                  LDA     CURRENT_KEY
         5 004665   002016 755000 0                  STA     O_K

     1025     9763    2           IF O_K ~= OWNER_KEY THEN /* BAD OWNER PTR FOUND */

   9763  5 004666   002016 236000 0                  LDQ     O_K
         5 004667   004672 604000 5                  TMI     s:9764
         5 004670   002203 116000 0                  CMPQ    OWNER_KEY
         5 004671   004674 600000 5                  TZE     s:9765

     1026     9764    2               BAD_FLAG=1;

   9764  5 004672   000001 235007                    LDA     1,DL
         5 004673   002206 755000 0                  STA     BAD_FLAG

     1027     9765    2           IF (N_OR_P=#NEXT2 AND PRIOR_KEY~=P_K) OR

   9765  5 004674   002131 235000 0                  LDA     N_OR_P
         5 004675   000016 115007                    CMPA    14,DL
         5 004676   004702 601000 5                  TNZ     s:9765+6
         5 004677   002204 236000 0                  LDQ     PRIOR_KEY
         5 004700   002015 116000 0                  CMPQ    P_K
         5 004701   004707 601000 5                  TNZ     s:9767
         5 004702   000017 115007                    CMPA    15,DL
         5 004703   004714 601000 5                  TNZ     s:9769
         5 004704   002204 236000 0                  LDQ     PRIOR_KEY
         5 004705   002014 116000 0                  CMPQ    N_K
         5 004706   004714 600000 5                  TZE     s:9769

     1028     9766    2              (N_OR_P=#PRIOR2 AND PRIOR_KEY~=N_K) THEN
     1029     9767    2               CALL TRACE_OUT(2); /* BAD BACKWARD PTR */

   9767  5 004707   000214 236000 6                  LDQ     140
         5 004710   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004711   000603 701000 5                  TSX1    TRACE_OUT
         5 004712   000000 011000                    NOP     0
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:174  
         5 004713   004760 710000 5                  TRA     s:9778

     1030     9768    2           ELSE
     1031     9769    2               IF WALK_OPT=#ALL2 OR

   9769  5 004714   002116 236000 0                  LDQ     WALK_OPT
         5 004715   777000 376003                    ANQ     -512,DU
         5 004716   014000 116003                    CMPQ    6144,DU
         5 004717   004732 600000 5                  TZE     s:9772
         5 004720   020000 116003                    CMPQ    8192,DU
         5 004721   004725 601000 5                  TNZ     s:9769+9
         5 004722   002127 235000 0                  LDA     RC_TYP1
         5 004723   000001 115007                    CMPA    1,DL
         5 004724   004732 600000 5                  TZE     s:9772
         5 004725   021000 116003                    CMPQ    8704,DU
         5 004726   004737 601000 5                  TNZ     s:9774
         5 004727   002127 235000 0                  LDA     RC_TYP1
         5 004730   000001 115007                    CMPA    1,DL
         5 004731   004737 600000 5                  TZE     s:9774

     1032     9770    2                  (WALK_OPT=#OWNER2 AND RC_TYP1=%OWNER) OR
     1033     9771    2                  (WALK_OPT=#MEMBER2 AND RC_TYP1~=%OWNER) THEN
     1034     9772    2                   CALL TRACE_OUT(0);

   9772  5 004732   000152 236000 6                  LDQ     106
         5 004733   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004734   000603 701000 5                  TSX1    TRACE_OUT
         5 004735   000000 011000                    NOP     0
         5 004736   004760 710000 5                  TRA     s:9778

     1035     9773    2               ELSE
     1036     9774    3               DO III=0 TO R_CNT;

   9774  5 004737   002003 450000 0                  STZ     III
         5 004740   004754 710000 5                  TRA     s:9777+1

     1037     9775    3                   IF RECORD_LIST.NAME(III)=REC_HDR.REC_NM THEN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:175  

   9775  5 004741   002003 235000 0                  LDA     III
         5 004742   000005 735000                    ALS     5
         5 004743   040000 106405                    CMPC    fill='040'O
         5 004744   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         5 004745   000000 200031 xsym               ADSC9   REC_HDR                  cn=1,n=25
         5 004746   004753 601000 5                  TNZ     s:9777

     1038     9776    3                       CALL TRACE_OUT(0);

   9776  5 004747   000152 236000 6                  LDQ     106
         5 004750   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 004751   000603 701000 5                  TSX1    TRACE_OUT
         5 004752   000000 011000                    NOP     0

     1039     9777    3                   END;

   9777  5 004753   002003 054000 0                  AOS     III
         5 004754   002117 236000 0                  LDQ     R_CNT
         5 004755   000033 732000                    QRS     27
         5 004756   002003 116000 0                  CMPQ    III
         5 004757   004741 605000 5                  TPL     s:9775

     1040     9778    3           DO III=1 TO K_CNT;

   9778  5 004760   000001 235007                    LDA     1,DL
         5 004761   002003 755000 0                  STA     III
         5 004762   004771 710000 5                  TRA     s:9781+1

     1041     9779    3               IF CURRENT_KEY=KEY_RNG.FIR(III) THEN

   9779  5 004763   002003 235000 0                  LDA     III
         5 004764   000001 735000                    ALS     1
         5 004765   002207 236000 0                  LDQ     CURRENT_KEY
         5 004766   000000 116005 xsym               CMPQ    KEY_RNG,AL
         5 004767   005043 600000 5                  TZE     STOP_WALKING

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:176  
     1042     9780    3                   GOTO STOP_WALKING;
     1043     9781    3               END;

   9781  5 004770   002003 054000 0                  AOS     III
         5 004771   002003 236000 0                  LDQ     III
         5 004772   002121 116000 0                  CMPQ    K_CNT
         5 004773   004763 604400 5                  TMOZ    s:9779

     1044     9782    2   ADD_CNT:
     1045     9783    2           IF RC_TYP1 = %OWNER THEN

   9783  5 004774   002127 235000 0     ADD_CNT      LDA     RC_TYP1
         5 004775   000001 115007                    CMPA    1,DL
         5 004776   005002 601000 5                  TNZ     s:9785

     1046     9784    2               OWNER_CNT = OWNER_CNT + 1;

   9784  5 004777   002205 236000 0                  LDQ     OWNER_CNT
         5 005000   000001 036007                    ADLQ    1,DL
         5 005001   002205 756000 0                  STQ     OWNER_CNT

     1047     9785    2           WALK_CNT=WALK_CNT+1;

   9785  5 005002   002030 236000 0                  LDQ     WALK_CNT
         5 005003   000001 036007                    ADLQ    1,DL
         5 005004   002030 756000 0                  STQ     WALK_CNT

     1048     9786    2           PRIOR_KEY=CURRENT_KEY;

   9786  5 005005   002207 235000 0                  LDA     CURRENT_KEY
         5 005006   002204 755000 0                  STA     PRIOR_KEY

     1049     9787    2           IF ADD_FLAG = 1 THEN /* ADD A DEFAULT STOP DBK */

   9787  5 005007   002125 236000 0                  LDQ     ADD_FLAG
         5 005010   777000 376003                    ANQ     -512,DU
         5 005011   001000 116003                    CMPQ    512,DU
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:177  
         5 005012   005023 601000 5                  TNZ     s:9793

     1050     9788    3           DO;

     1051     9789    3               IF K_CNT < 19 THEN K_CNT = K_CNT + 1;

   9789  5 005013   002121 236000 0                  LDQ     K_CNT
         5 005014   000023 116007                    CMPQ    19,DL
         5 005015   005017 605000 5                  TPL     s:9790

   9789  5 005016   002121 054000 0                  AOS     K_CNT

     1052     9790    3               KEY_RNG.FIR(K_CNT) = CURRENT_KEY; /* ADD TO LIST */

   9790  5 005017   002121 236000 0                  LDQ     K_CNT
         5 005020   000001 736000                    QLS     1
         5 005021   000000 755006 xsym               STA     KEY_RNG,QL

     1053     9791    3               ADD_FLAG = 0; /* RESET THE ADD FLAG */

   9791  5 005022   002125 450000 0                  STZ     ADD_FLAG

     1054     9792    3               END;

     1055     9793    2           IF BREAK_FLAG>0 THEN GOTO STOP_BY_BREAK;

   9793  5 005023   000000 236000 xsym               LDQ     BREAK_FLAG
         5 005024   005066 605400 5                  TPNZ    STOP_BY_BREAK

     1056     9794    2           GOTO KEEP_WALKING;

   9794  5 005025   004601 710000 5                  TRA     KEEP_WALKING

     1057     9795    2   ABN_WALK:
     1058     9796    2           CALL CONV_DBK(PRIOR_KEY,DBK_CUR,V1);

   9796  5 005026   000032 237000 6     ABN_WALK     LDAQ    26
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:178  
         5 005027   200306 757100                    STAQ    @DBK_BIN+1,,AUTO
         5 005030   000215 236000 6                  LDQ     141
         5 005031   200305 756100                    STQ     @INDX+3,,AUTO
         5 005032   000721 701000 5                  TSX1    CONV_DBK
         5 005033   000000 011000                    NOP     0

     1059     9797    2           CALL CONCAT(BUF,'b  Unable to proceed from DBKEY ',DBK_CUR);

   9797  5 005034   040000 100400                    MLR     fill='040'O
         5 005035   000703 000040 1                  ADSC9   DCB_LO+400               cn=0,n=32
         5 005036   002036 000040 0                  ADSC9   BUF                      cn=0,n=32
         5 005037   040000 100400                    MLR     fill='040'O
         5 005040   002062 000012 0                  ADSC9   DBK_CUR                  cn=0,n=10
         5 005041   002046 000060 0                  ADSC9   BUF+8                    cn=0,n=48

     1060     9798    2           GOTO WALK_SUMMARY;

   9798  5 005042   005106 710000 5                  TRA     WALK_SUMMARY

     1061     9799    2   STOP_WALKING:
     1062     9800    2           IF III >= KCNT_SAVE THEN

   9800  5 005043   002124 236000 0     STOP_WALKING LDQ     KCNT_SAVE
         5 005044   000033 732000                    QRS     27
         5 005045   002003 116000 0                  CMPQ    III
         5 005046   005066 605400 5                  TPNZ    STOP_BY_BREAK

     1063     9801    3           DO;

     1064     9802    3               CALL CONCAT(RBUF,DBK_REC,' before looping');

   9802  5 005047   002023 470400 0                  LDP0    DBK_REC$
         5 005050   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 005051   040000 100540                    MLR     fill='040'O
         5 005052   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 005053   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256
         5 005054   002022 236000 0                  LDQ     DBK_REC_SIZE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:179  
         5 005055   000400 116007                    CMPQ    256,DL
         5 005056   005064 603000 5                  TRC     s:9803
         5 005057   777377 621006                    EAX1    -257,QL
         5 005060   777777 661003                    ERX1    -1,DU
         5 005061   040046 100400                    MLR     fill='040'O
         5 005062   000713 000017 1                  ADSC9   DCB_LO+408               cn=0,n=15
         5 005063   000000 000011 xsym               ADSC9   RBUF,Q                   cn=0,n=*X1

     1065     9803    3               DBK_REC_SIZE = DBK_REC_SIZE + 20;

   9803  5 005064   000024 036007                    ADLQ    20,DL
         5 005065   002022 756000 0                  STQ     DBK_REC_SIZE

     1066     9804    3               END;

     1067     9805    2   STOP_BY_BREAK:
     1068     9806    2           CALL CONCAT(BUF,'b  Stops at ',DBK_REC);

   9806  5 005066   040000 100400       STOP_BY_BRE* MLR     fill='040'O
         5 005067   000717 000014 1                  ADSC9   DCB_LO+412               cn=0,n=12
         5 005070   002036 000014 0                  ADSC9   BUF                      cn=0,n=12
         5 005071   002023 470400 0                  LDP0    DBK_REC$
         5 005072   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 005073   040000 100540                    MLR     fill='040'O
         5 005074   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 005075   002041 000104 0                  ADSC9   BUF+3                    cn=0,n=68

     1069     9807    2           IF CURRENT_KEY~=KEY_RNG.FIR(K_CNT) THEN

   9807  5 005076   002121 235000 0                  LDA     K_CNT
         5 005077   000001 735000                    ALS     1
         5 005100   002207 236000 0                  LDQ     CURRENT_KEY
         5 005101   000000 116005 xsym               CMPQ    KEY_RNG,AL
         5 005102   005106 600000 5                  TZE     WALK_SUMMARY

     1070     9808    2               WALK_CNT=WALK_CNT+1;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:180  
   9808  5 005103   002030 235000 0                  LDA     WALK_CNT
         5 005104   000001 035007                    ADLA    1,DL
         5 005105   002030 755000 0                  STA     WALK_CNT

     1071     9809    2   WALK_SUMMARY:
     1072     9810    2           CALL WRITE_A_LINE;

   9810  5 005106   000000 236000 6     WALK_SUMMARY LDQ     0
         5 005107   200301 756100                    STQ     @DBK+1,,AUTO
         5 005110   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005111   000000 011000                    NOP     0

     1073     9811    2           CALL CONV_DBK(WALK_CNT,DBK_CUR,V1);

   9811  5 005112   000032 237000 6                  LDAQ    26
         5 005113   200306 757100                    STAQ    @DBK_BIN+1,,AUTO
         5 005114   000171 236000 6                  LDQ     121
         5 005115   200305 756100                    STQ     @INDX+3,,AUTO
         5 005116   000721 701000 5                  TSX1    CONV_DBK
         5 005117   000000 011000                    NOP     0

     1074     9812    2           CALL CONCAT(BUF,'a  ',ADDR(DBK_CUR)->DBK_V,' records walked');

   9812  5 005120   000722 236000 1                  LDQ     DCB_LO+415
         5 005121   002036 552070 0                  STBQ    BUF,'70'O
         5 005122   002006 720000 0                  LXL0    V1
         5 005123   040000 100440                    MLR     fill='040'O
         5 005124   002062 000010 0                  ADSC9   DBK_CUR                  cn=0,n=*X0
         5 005125   002036 600115 0                  ADSC9   BUF                      cn=3,n=77
         5 005126   002006 236000 0                  LDQ     V1
         5 005127   000115 116007                    CMPQ    77,DL
         5 005130   005136 603000 5                  TRC     s:9813
         5 005131   777662 621006                    EAX1    -78,QL
         5 005132   777777 661003                    ERX1    -1,DU
         5 005133   040046 100400                    MLR     fill='040'O
         5 005134   000723 000017 1                  ADSC9   DCB_LO+416               cn=0,n=15
         5 005135   002036 600011 0                  ADSC9   BUF,Q                    cn=3,n=*X1
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:181  

     1075     9813    2           CALL WRITE_A_LINE;

   9813  5 005136   000000 236000 6                  LDQ     0
         5 005137   200301 756100                    STQ     @DBK+1,,AUTO
         5 005140   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005141   000000 011000                    NOP     0

     1076     9814    2           IF OWNER_CNT > 1 THEN

   9814  5 005142   002205 235000 0                  LDA     OWNER_CNT
         5 005143   000002 115007                    CMPA    2,DL
         5 005144   005152 602000 5                  TNC     s:9817

     1077     9815    2               CALL WRITE_A_LINE('@ with more than one owners found%');

   9815  5 005145   000216 236000 6                  LDQ     142
         5 005146   200301 756100                    STQ     @DBK+1,,AUTO
         5 005147   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005150   000000 011000                    NOP     0
         5 005151   005545 710000 5                  TRA     s:9873

     1078     9816    2           ELSE
     1079     9817    2               IF BAD_FLAG=1 AND ITEM_LIST.NAME(0)~='*CALC' THEN

   9817  5 005152   002206 236000 0                  LDQ     BAD_FLAG
         5 005153   000001 116007                    CMPQ    1,DL
         5 005154   005545 601000 5                  TNZ     s:9873
         5 005155   040000 106400                    CMPC    fill='040'O
         5 005156   000000 000036 xsym               ADSC9   ITEM_LIST                cn=0,n=30
         5 005157   000740 000005 1                  ADSC9   DCB_LO+429               cn=0,n=5
         5 005160   005545 600000 5                  TZE     s:9873

     1080     9818    2                   CALL WRITE_A_LINE('@ with bad owner pointers detected%');

   9818  5 005161   000217 236000 6                  LDQ     143
         5 005162   200301 756100                    STQ     @DBK+1,,AUTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:182  
         5 005163   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005164   000000 011000                    NOP     0
         5 005165   005545 710000 5                  TRA     s:9873

     1081     9819        %EJECT;
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:183  
     1082     9820    2       CASE(#DISP2); /* PRINT DBK */

     1083     9821    2           IF K_CNT>=0 AND PRINT_OPT=0 AND S_CNT=-1 THEN

   9821  5 005166   002121 235000 0                  LDA     K_CNT
         5 005167   005201 604000 5                  TMI     s:9823
         5 005170   002115 236000 0                  LDQ     PRINT_OPT
         5 005171   777000 316003                    CANQ    -512,DU
         5 005172   005201 601000 5                  TNZ     s:9823
         5 005173   002120 236000 0                  LDQ     S_CNT
         5 005174   777000 376003                    ANQ     -512,DU
         5 005175   777000 116003                    CMPQ    -512,DU
         5 005176   005201 601000 5                  TNZ     s:9823

     1084     9822    2               CALL MOVE_SET_NAME;

   9822  5 005177   000040 701000 5                  TSX1    MOVE_SET_NAME
         5 005200   000000 011000                    NOP     0

     1085     9823    2           IF K_CNT = -1 THEN

   9823  5 005201   002121 235000 0                  LDA     K_CNT
         5 005202   000014 115000 6                  CMPA    12
         5 005203   005212 601000 5                  TNZ     s:9825

     1086     9824    2               CALL GET_CMD(DBK_LIST_NODE,'@  DBKEY TO PRINT:') ALTRET(NEXT_CMD);

   9824  5 005204   000220 236000 6                  LDQ     144
         5 005205   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 005206   000207 236000 6                  LDQ     135
         5 005207   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 005210   000345 701000 5                  TSX1    GET_CMD
         5 005211   003264 702000 5                  TSX2    NEXT_CMD

     1087     9825    2           IF PRINT_OPT=0 AND S_CNT=-1 THEN /* PRINT OPTION MISSING */

   9825  5 005212   002115 236000 0                  LDQ     PRINT_OPT
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:184  
         5 005213   777000 316003                    CANQ    -512,DU
         5 005214   005227 601000 5                  TNZ     s:9827
         5 005215   002120 236000 0                  LDQ     S_CNT
         5 005216   777000 376003                    ANQ     -512,DU
         5 005217   777000 116003                    CMPQ    -512,DU
         5 005220   005227 601000 5                  TNZ     s:9827

     1088     9826    2               CALL GET_CMD(DISP_OPT_NODE,'@  SETS/ALL/SET_LIST:') ALTRET(NEXT_CMD);

   9826  5 005221   000221 236000 6                  LDQ     145
         5 005222   200274 756100                    STQ     @PTR_TYPE+1,,AUTO
         5 005223   000222 236000 6                  LDQ     146
         5 005224   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 005225   000345 701000 5                  TSX1    GET_CMD
         5 005226   003264 702000 5                  TSX2    NEXT_CMD

     1089     9827    2           CALL VERIFY_SETS ALTRET(NEXT_CMD);

   9827  5 005227   000072 701000 5                  TSX1    VERIFY_SETS
         5 005230   003264 702000 5                  TSX2    NEXT_CMD

     1090     9828    2           IF PRINT_OPT=#SETS2 THEN

   9828  5 005231   002115 236000 0                  LDQ     PRINT_OPT
         5 005232   777000 376003                    ANQ     -512,DU
         5 005233   013000 116003                    CMPQ    5632,DU
         5 005234   005237 601000 5                  TNZ     s:9830

     1091     9829    2               CALL MOVE_SET_NAME;

   9829  5 005235   000040 701000 5                  TSX1    MOVE_SET_NAME
         5 005236   000000 011000                    NOP     0

     1092     9830    2           IF III>1 THEN CALL WRITE_A_LINE('A%');

   9830  5 005237   002003 235000 0                  LDA     III
         5 005240   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:185  
         5 005241   005246 604400 5                  TMOZ    s:9831

   9830  5 005242   000223 236000 6                  LDQ     147
         5 005243   200301 756100                    STQ     @DBK+1,,AUTO
         5 005244   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005245   000000 011000                    NOP     0

     1093     9831    2           IF PRINT_OPT=#ALL2 THEN

   9831  5 005246   002115 236000 0                  LDQ     PRINT_OPT
         5 005247   777000 376003                    ANQ     -512,DU
         5 005250   014000 116003                    CMPQ    6144,DU
         5 005251   005301 601000 5                  TNZ     s:9844

     1094     9832    3           DO;

     1095     9833    3               ZI$DIR.PITEM='1'B; /* PRINT ITEM BITS ON */

   9833  5 005252   000040 236003                    LDQ     32,DU
         5 005253   000125 256000 xsym               ORSQ    ZI$DIR+85

     1096     9834    3               ZI$DIR.PCALC='1'B; /* PRINT CALC HEADER BIT ON */

   9834  5 005254   000100 236003                    LDQ     64,DU
         5 005255   000125 256000 xsym               ORSQ    ZI$DIR+85

     1097     9835    3               SXCNT=-1;

   9835  5 005256   000001 335007                    LCA     1,DL
         5 005257   000000 755000 0                  STA     SXCNT

     1098     9836    4               DO III=0 TO K_CNT;

   9836  5 005260   002003 450000 0                  STZ     III
         5 005261   005273 710000 5                  TRA     s:9840+1

     1099     9837    4                   KEY_RNG.FIR(0)=KEY_RNG.FIR(III);
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:186  

   9837  5 005262   002003 235000 0                  LDA     III
         5 005263   000001 735000                    ALS     1
         5 005264   000000 235005 xsym               LDA     KEY_RNG,AL
         5 005265   000000 755000 xsym               STA     KEY_RNG

     1100     9838    4                   CALL FINDBKEY;

   9838  5 005266   002226 701000 5                  TSX1    FINDBKEY
         5 005267   000000 011000                    NOP     0

     1101     9839    4                   IF BREAK_FLAG>0 THEN GOTO NEXT_CMD;

   9839  5 005270   000000 235000 xsym               LDA     BREAK_FLAG
         5 005271   003264 605400 5                  TPNZ    NEXT_CMD

     1102     9840    4                   END;

   9840  5 005272   002003 054000 0                  AOS     III
         5 005273   002003 236000 0                  LDQ     III
         5 005274   002121 116000 0                  CMPQ    K_CNT
         5 005275   005262 604400 5                  TMOZ    s:9837

     1103     9841    3               ZI$DIR.PCALC = '0'B; /* TURN IT OFF */

   9841  5 005276   000224 236000 6                  LDQ     148
         5 005277   000125 356000 xsym               ANSQ    ZI$DIR+85

     1104     9842    3               GOTO NEXT_CMD;

   9842  5 005300   003264 710000 5                  TRA     NEXT_CMD

     1105     9843    3               END;
     1106     9844    3           DO JJJ=0 TO K_CNT;

   9844  5 005301   002004 450000 0                  STZ     JJJ
         5 005302   005542 710000 5                  TRA     s:9871+1
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:187  

     1107     9845    3               KEY_RNG.FIR(0)=KEY_RNG.FIR(JJJ);

   9845  5 005303   002004 235000 0                  LDA     JJJ
         5 005304   000001 735000                    ALS     1
         5 005305   000000 235005 xsym               LDA     KEY_RNG,AL
         5 005306   000000 755000 xsym               STA     KEY_RNG

     1108     9846    3               CALL FINDBKEY ALTRET(NEXT_DBKEY);

   9846  5 005307   002226 701000 5                  TSX1    FINDBKEY
         5 005310   005537 702000 5                  TSX2    NEXT_DBKEY

     1109     9847    3               IF JJJ>0 THEN CALL WRITE_A_LINE('B%');

   9847  5 005311   002004 235000 0                  LDA     JJJ
         5 005312   005317 604400 5                  TMOZ    s:9848

   9847  5 005313   000225 236000 6                  LDQ     149
         5 005314   200301 756100                    STQ     @DBK+1,,AUTO
         5 005315   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005316   000000 011000                    NOP     0

     1110     9848    4               DO III=0 TO S_CNT;

   9848  5 005317   002003 450000 0                  STZ     III
         5 005320   005512 710000 5                  TRA     s:9865+1

     1111     9849    4                   CALL GET_POINTERS(JJJ,III,RC_TYP1) ALTRET(NEXT_SET);

   9849  5 005321   000226 237000 6                  LDAQ    150
         5 005322   200274 757100                    STAQ    @PTR_TYPE+1,,AUTO
         5 005323   000230 236000 6                  LDQ     152
         5 005324   200273 756100                    STQ     AREA_ENCRPT+34,,AUTO
         5 005325   001201 701000 5                  TSX1    GET_POINTERS
         5 005326   005507 702000 5                  TSX2    NEXT_SET

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:188  
     1112     9850    4                   CALL CONCAT(BUF,'@  ',DBK_REC,'  ',ITEM_LIST.NAME(III));

   9850  5 005327   000753 236000 1                  LDQ     DCB_LO+440
         5 005330   002036 552070 0                  STBQ    BUF,'70'O
         5 005331   002023 470400 0                  LDP0    DBK_REC$
         5 005332   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 005333   040000 100540                    MLR     fill='040'O
         5 005334   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 005335   002036 600115 0                  ADSC9   BUF                      cn=3,n=77
         5 005336   002022 236000 0                  LDQ     DBK_REC_SIZE
         5 005337   000115 116007                    CMPQ    77,DL
         5 005340   005357 603000 5                  TRC     s:9851
         5 005341   777662 621006                    EAX1    -78,QL
         5 005342   777777 661003                    ERX1    -1,DU
         5 005343   040046 100400                    MLR     fill='040'O
         5 005344   000770 000002 1                  ADSC9   DCB_LO+453               cn=0,n=2
         5 005345   002036 600011 0                  ADSC9   BUF,Q                    cn=3,n=*X1
         5 005346   000113 116007                    CMPQ    75,DL
         5 005347   005357 603000 5                  TRC     s:9851
         5 005350   002003 235000 0                  LDA     III
         5 005351   000005 735000                    ALS     5
         5 005352   777664 622006                    EAX2    -76,QL
         5 005353   777777 662003                    ERX2    -1,DU
         5 005354   040046 100405                    MLR     fill='040'O
         5 005355   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30
         5 005356   002037 200012 0                  ADSC9   BUF+1,Q                  cn=1,n=*X2

     1113     9851    4                   IF DBK_REC=' ' THEN

   9851  5 005357   040000 106540                    CMPC    fill='040'O
         5 005360   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 005361   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 005362   005365 601000 5                  TNZ     s:9853

     1114     9852    4                       ADDR(BUF)->CHAR1='a'; /* PRINT NEXT SET */

   9852  5 005363   141000 236003                    LDQ     49664,DU
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:189  
         5 005364   002036 552040 0                  STBQ    BUF,'40'O

     1115     9853    4                   CALL WRITE_A_LINE;

   9853  5 005365   000000 236000 6                  LDQ     0
         5 005366   200301 756100                    STQ     @DBK+1,,AUTO
         5 005367   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005370   000000 011000                    NOP     0

     1116     9854    4                   IF RC_TYP1=%PA_ENT THEN /* WITH AN EXTRA PA PTR */

   9854  5 005371   002127 235000 0                  LDA     RC_TYP1
         5 005372   000020 115007                    CMPA    16,DL
         5 005373   005423 601000 5                  TNZ     s:9858

     1117     9855    4                       CALL CONCAT(SC_MSG3.MEMBER,', ',

   9855  5 005374   000771 220000 1                  LDX0    DCB_LO+454
         5 005375   002106 440000 0                  SXL0    SC_MSG3+13
         5 005376   002012 721000 0                  LXL1    V5
         5 005377   040000 100440                    MLR     fill='040'O
         5 005400   000020 600011 xsym               ADSC9   SET_HDR+16               cn=3,n=*X1
         5 005401   002107 000030 0                  ADSC9   SC_MSG3+14               cn=0,n=24
         5 005402   002012 236000 0                  LDQ     V5
         5 005403   000030 116007                    CMPQ    24,DL
         5 005404   005422 603000 5                  TRC     s:9855+22
         5 005405   777747 622006                    EAX2    -25,QL
         5 005406   777777 662003                    ERX2    -1,DU
         5 005407   040046 100400                    MLR     fill='040'O
         5 005410   000771 000002 1                  ADSC9   DCB_LO+454               cn=0,n=2
         5 005411   002107 000012 0                  ADSC9   SC_MSG3+14,Q             cn=0,n=*X2
         5 005412   002012 236000 0                  LDQ     V5
         5 005413   000026 116007                    CMPQ    22,DL
         5 005414   005422 603000 5                  TRC     s:9855+22
         5 005415   777751 621006                    EAX1    -23,QL
         5 005416   777777 661003                    ERX1    -1,DU
         5 005417   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:190  
         5 005420   002033 000012 0                  ADSC9   PA_POINTER               cn=0,n=10
         5 005421   002107 400011 0                  ADSC9   SC_MSG3+14,Q             cn=2,n=*X1
         5 005422   005430 710000 5                  TRA     s:9859

     1118     9856    4                          ADDR(SET_HDR.NEXT)->DBN_V,', ',PA_POINTER);
     1119     9857    4                   ELSE
     1120     9858    4                       CALL CONCAT(SC_MSG3.MEMBER,', ',SET_HDR.NEXT);

   9858  5 005423   000771 220000 1                  LDX0    DCB_LO+454
         5 005424   002106 440000 0                  SXL0    SC_MSG3+13
         5 005425   040000 100400                    MLR     fill='040'O
         5 005426   000020 600012 xsym               ADSC9   SET_HDR+16               cn=3,n=10
         5 005427   002107 000030 0                  ADSC9   SC_MSG3+14               cn=0,n=24

     1121     9859    4                   CALL CONCAT(BUF,'@  ',ADDR(SET_HDR.PRIOR)->DBP_V,

   9859  5 005430   000753 236000 1                  LDQ     DCB_LO+440
         5 005431   002036 552070 0                  STBQ    BUF,'70'O
         5 005432   002010 720000 0                  LXL0    V3
         5 005433   040000 100440                    MLR     fill='040'O
         5 005434   000012 600010 xsym               ADSC9   SET_HDR+10               cn=3,n=*X0
         5 005435   002036 600115 0                  ADSC9   BUF                      cn=3,n=77
         5 005436   002010 236000 0                  LDQ     V3
         5 005437   000115 116007                    CMPQ    77,DL
         5 005440   005474 603000 5                  TRC     s:9861
         5 005441   777662 621006                    EAX1    -78,QL
         5 005442   777777 661003                    ERX1    -1,DU
         5 005443   040046 100400                    MLR     fill='040'O
         5 005444   000771 000002 1                  ADSC9   DCB_LO+454               cn=0,n=2
         5 005445   002036 600011 0                  ADSC9   BUF,Q                    cn=3,n=*X1
         5 005446   002010 236000 0                  LDQ     V3
         5 005447   000113 116007                    CMPQ    75,DL
         5 005450   005474 603000 5                  TRC     s:9861
         5 005451   777664 620006                    EAX0    -76,QL
         5 005452   777777 660003                    ERX0    -1,DU
         5 005453   002011 721000 0                  LXL1    V4
         5 005454   040046 100440                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:191  
         5 005455   000015 600011 xsym               ADSC9   SET_HDR+13               cn=3,n=*X1
         5 005456   002037 200010 0                  ADSC9   BUF+1,Q                  cn=1,n=*X0
         5 005457   002010 236000 0                  LDQ     V3
         5 005460   002011 036000 0                  ADLQ    V4
         5 005461   000113 116007                    CMPQ    75,DL
         5 005462   005474 603000 5                  TRC     s:9861
         5 005463   200310 756100                    STQ     @INDX+1,,AUTO
         5 005464   002010 236000 0                  LDQ     V3
         5 005465   002011 036000 0                  ADLQ    V4
         5 005466   200310 720100                    LXL0    @INDX+1,,AUTO
         5 005467   777664 620010                    EAX0    -76,X0
         5 005470   777777 660003                    ERX0    -1,DU
         5 005471   040046 100400                    MLR     fill='040'O
         5 005472   002106 400032 0                  ADSC9   SC_MSG3+13               cn=2,n=26
         5 005473   002037 200010 0                  ADSC9   BUF+1,Q                  cn=1,n=*X0

     1122     9860    4                      ', ',ADDR(SET_HDR.OWNER)->DBO_V,SC_MSG3.MEMBER);
     1123     9861    4                   CALL WRITE_A_LINE;

   9861  5 005474   000000 236000 6                  LDQ     0
         5 005475   200301 756100                    STQ     @DBK+1,,AUTO
         5 005476   000003 701000 5                  TSX1    WRITE_A_LINE
         5 005477   000000 011000                    NOP     0

     1124     9862    4                   DBK_REC=' ';

   9862  5 005500   002023 470400 0                  LDP0    DBK_REC$
         5 005501   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 005502   040140 100400                    MLR     fill='040'O
         5 005503   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 005504   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1125     9863    4                   REC_INDX=-1; /* INDICATES DBK IS CORRECT */

   9863  5 005505   000001 335007                    LCA     1,DL
         5 005506   002017 755000 0                  STA     REC_INDX

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:192  
     1126     9864    4   NEXT_SET:       IF REC_INDX>=0 THEN GOTO NEXT_DBKEY; /* BAD DBK */

   9864  5 005507   002017 235000 0     NEXT_SET     LDA     REC_INDX
         5 005510   005537 605000 5                  TPL     NEXT_DBKEY

     1127     9865    4                   END;

   9865  5 005511   002003 054000 0                  AOS     III
         5 005512   002120 236000 0                  LDQ     S_CNT
         5 005513   000033 732000                    QRS     27
         5 005514   002003 116000 0                  CMPQ    III
         5 005515   005321 605000 5                  TPL     s:9849

     1128     9866    3               CALL CONCAT(BUF,'@  ',DBK_REC);

   9866  5 005516   000753 236000 1                  LDQ     DCB_LO+440
         5 005517   002036 552070 0                  STBQ    BUF,'70'O
         5 005520   002023 470400 0                  LDP0    DBK_REC$
         5 005521   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 005522   040000 100540                    MLR     fill='040'O
         5 005523   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 005524   002036 600115 0                  ADSC9   BUF                      cn=3,n=77

     1129     9867    3               IF DBK_REC~=' ' THEN

   9867  5 005525   002023 470400 0                  LDP0    DBK_REC$
         5 005526   002022 720000 0                  LXL0    DBK_REC_SIZE
         5 005527   040000 106540                    CMPC    fill='040'O
         5 005530   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 005531   000013 000001 6                  ADSC9   11                       cn=0,n=1
         5 005532   005537 600000 5                  TZE     NEXT_DBKEY

     1130     9868    3                   CALL WRITE_A_LINE;

   9868  5 005533   000000 236000 6                  LDQ     0
         5 005534   200301 756100                    STQ     @DBK+1,,AUTO
         5 005535   000003 701000 5                  TSX1    WRITE_A_LINE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:193  
         5 005536   000000 011000                    NOP     0

     1131     9869    3   NEXT_DBKEY:
     1132     9870    3               IF BREAK_FLAG>0 THEN GOTO NEXT_CMD;

   9870  5 005537   000000 235000 xsym  NEXT_DBKEY   LDA     BREAK_FLAG
         5 005540   003264 605400 5                  TPNZ    NEXT_CMD

     1133     9871    3               END;

   9871  5 005541   002004 054000 0                  AOS     JJJ
         5 005542   002004 236000 0                  LDQ     JJJ
         5 005543   002121 116000 0                  CMPQ    K_CNT
         5 005544   005303 604400 5                  TMOZ    s:9845

     1134     9872    2           END;

     1135     9873    1       GOTO NEXT_CMD;

   9873  5 005545   003264 710000 5                  TRA     NEXT_CMD

     1136     9874
     1137     9875    1   EXIT_RTN:
     1138     9876    1       FPT_TRMPRG.V.CTLFLG.PURGEOUTPUT#=%YES#;

   9876  5 005546   001000 236003       EXIT_RTN     LDQ     512,DU
         5 005547   000006 256000 xsym               ORSQ    FPT_TRMPRG+6

     1139     9877    1   END ZIU$Q2RP;

   9877  5 005550   000000 702200 xent               TSX2  ! X66_ARET

WK
 Sect OctLoc
   0     003   ****** ******   ****** ******   ****** ******   ****** ******    ................

DBK_REC$
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:194  
 Sect OctLoc
   0    2023   000000 006000                                                    ....

PROMPT_CHAR
 Sect OctLoc
   0    2025   040*** ******                                                     ...

BUF
 Sect OctLoc
   0    2036   ****** ******   ****** ******   ****** ******   ****** ******    ................

AREA_INDX
 Sect OctLoc
   0    2070   777777 777777                                                    ....

SC_MSG3
 Sect OctLoc
   0    2071   102040 040040   040040 040040   040040 040040   040040 040040    B
   0    2075   040040 040040   040040 040040   040040 040040   040040 040040
   0    2111*  040040 040040   040040 040040   040040 040040   040040 040040

WALK_OPT
 Sect OctLoc
   0    2116   000*** ******                                                    ....

PA_DBK
 Sect OctLoc
   0    2132   ****** ******   ****** ******   ****** ******   ****** ******    ................

GDS_RESULT
 Sect OctLoc
   0    2210   000000 177640   000000 006014                                    ........

FPT_PFIL
 Sect OctLoc
   0    2212   000001 777640   002214 006000   000000 400000   000000 000000    ................

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:195  
FPT_PROMPT
 Sect OctLoc
   0    2216   000003 777640   002224 006000   000000 177640   000000 006014    ................
   0    2222   000000 177640   002025 006000   000000 000000   000000 000000    ................
   0    2226   000000 000000   000000 000000                                    ........

FPT_JRNL
 Sect OctLoc
   0    2230   000003 777640   002240 006000   000077 777640   000000 006000    .........?......
   0    2234   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    2240   000000 400200   000000 000000   000000 000000   000000 000000    ................

OPEN_JRNL
 Sect OctLoc
   0    2244   000025 777640   002310 006000   000000 177640   000000 006014    ................
   0    2250   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    2310*  000000 000602   000000 003001   252525 002002   000040 252520    ............. ..
   0    2314   000040 040040   000000 000001   000000 777777   000000 000000    .   ............
   0    2320   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    2324   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   0    2330   040040 040040   000000 000000   000000 000000   000000 000000        ............
   0    2334   000000 000000   ****** ******                                    ........

PCB
 Sect OctLoc
   0    2336   000000 006000   000000 006014   000003 006000   000000 006014    ................
   0    2342   000000 000000   002000 600000   000000 000000   040042 040042    ............ " "
   0    2346   000000 040000   000000 000000   000000 000000   000000 006014    .. .............
   0    2352   000000 006014   000000 000000                                    ........

PA_LINK
 Sect OctLoc
   1     000   005000 010016   010017 024016   030016 011020                    ............

NOP_TEXT
 Sect OctLoc
   1     003   040116 105130   124120 122111   117122 117127   116105 122040     NEXTPRIOROWNER
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:196  
   1     007   120101 040040                                                    PA

SC_MSG1
 Sect OctLoc
   1     010   101040 040040   040040 123105   124055 116101   115105 040040    A     SET-NAME
   1     014   040040 040040   040040 040040   040040 040040   040040 117127                  OW
   1     020   116105 122055   122105 103117   122104 040040   040040 040040    NER-RECORD
   1     024   040040 040040   040040 115105   115102 105122   055122 105103          MEMBER-REC
   1     030   117122 104040   040040 040040   040040 040040   040040 040040    ORD

SC_MSG2
 Sect OctLoc
   1     034   100040 040040   040040 055055   055055 055055   055055 040040    @     --------
   1     040   040040 040040   040040 040040   040040 040040   040040 055055                  --
   1     044   055055 055055   055055 055055   055055 040040   040040 040040    ----------
   1     050   040040 040040   040040 055055   055055 055055   055055 055055          ----------
   1     054   055055 055040   040040 040040   040040 040040   040040 040040    ---

JRNL_KEY$
 Sect OctLoc
   1     060   000000 006000                                                    ....

DCB_UC
 Sect OctLoc
   1     061   000000 ******                                                    ....

DCB_SI
 Sect OctLoc
   1     062   000000 ******                                                    ....

DCB_LO
 Sect OctLoc
   1     063   000000 ******                                                    ....

(unnamed)
 Sect OctLoc
   1     064   102040 040040   040123 145164   040040 040040   040156 157164    B    Set     not
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:197  
   1     070   040144 145146   151156 145144   040151 156040   163143 150145     defined in sche
   1     074   155141 040040   141040 040040   040040 040040   040151 163040    ma  a        is
   1     100   141040 162145   143157 162144   040142 165164   040156 157164    a record but not
   1     104   040141 040163   145164 040151   156040 163143   150145 155141     a set in schema
   1     110   040040 040040   100040 040040   101045 040040   121125 111124        @   A%  QUIT
   1     114   105110 100040   141040 040105   162162 157162   040162 145141    EH@ a  Error rea
   1     120   144151 156147   040143 157155   155141 156144   040055 040121    ding command - Q
   1     124   125111 124040   163151 155165   154141 164145   144056 045040    UIT simulated.%
   1     130   040055 076040   040075 076040   100040 102141   144040 120162     ->  => @ Bad Pr
   1     134   151157 162045   100040 102141   144040 116145   170164 045040    ior%@ Bad Next%
   1     140   100040 040106   141151 154040   164157 040162   145141 144040    @  Fail to read
   1     144   152157 165162   156141 154054   040143 141156   164040 125116    journal, cant UN
   1     150   104117 040146   157162 040171   157165 045040   101040 040105    DO for you% A  E
   1     154   162162 157162   040151 156040   167162 151164   151156 147040    rror in writing
   1     160   152157 165162   156141 154040   146151 154145   056056 056040    journal file...
   1     164   045040 040040   101040 040123   165147 147145   163164 040171    %   A  Suggest y
   1     170   157165 040144   157040 141040   103117 115115   111124 040143    ou do a COMMIT c
   1     174   157155 155141   156144 040156   157167 056045   100040 040106    ommand now.%@  F
   1     200   141151 154040   164157 040165   160144 141164   145040 144141    ail to update da
   1     204   164141 142141   163145 054040   103117 115115   101116 104040    tabase, COMMAND
   1     210   141142 157162   164145 144045   100040 040040   040123 157162    aborted%@    Sor
   1     214   162171 041040   171157 165040   141162 145040   156157 164040    ry! you are not
   1     220   162145 160141   151162 151156   147040 164150   151163 040163    repairing this s
   1     224   145164 045040   040151 163040   156157 164040   141040 164145    et%  is not a te
   1     230   156141 156164   040151 156040   163145 164040   040151 163040    nant in set  is
   1     234   156157 164040   141040 120101   040162 145143   157162 144040    not a PA record
   1     240   141040 040040   040122 145161   165151 162145   040120 101040    a    Require PA
   1     244   147162 157165   160040 151156   144145 170040   164157 040151    group index to i
   1     250   144145 156164   151146 171040   141040 040040   040120 101040    dentify a    PA
   1     254   147162 157165   160040 151156   144145 170040   164157 157040    group index too
   1     260   142151 147040   151156 040040   141040 040040   040116 157040    big in  a    No
   1     264   156145 145144   040157 146040   120101 040147   162157 165160    need of PA group
   1     270   040151 156144   145170 040151   156040 040040   141040 040040     index in   a
   1     274   040120 101040   145156 164162   171040 151156   144145 170040     PA entry index
   1     300   164157 157040   142151 147040   151156 040040   141040 040040    too big in  a
   1     304   040104 102113   105131 040040   040151 163040   151154 154145     DBKEY   is ille
   1     310   147141 154040   151156 040163   143150 145155   141040 040040    gal in schema
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:198  
   1     314   141040 040040   040116 157040   162145 143157   162144 040146    a    No record f
   1     320   157165 156144   040141 164040   104102 113105   131040 040040    ound at DBKEY
   1     324   040040 116157   164040 143150   141156 147145   144040 040040      Not changed
   1     330   040040 127141   163040 040040   040040 116145   167040 040040      Was     New
   1     334   040160 157151   156164 145162   040040 040040   142040 040127     pointer    b  W
   1     340   141162 156151   156147 072040   171157 165162   040115 044114    arning: your M$L
   1     344   117040 151163   040156 157164   040163 145164   040164 157040    O is not set to
   1     350   171157 165045   100040 105116   124105 122040   105116 103122    you%@ ENTER ENCR
   1     354   131120 124137   123105 105104   040106 117122   040101 122105    YPT_SEED FOR ARE
   1     360   101040 040040   050121 040164   157040 161165   151164 054060    A   (Q to quit,0
   1     364   040151 146040   156157 156145   051072 040040   122105 120101     if none):  REPA
   1     370   111122 137104   103102 040040   142103 117115   115101 116104    IR_DCB  bCOMMAND
   1     374   072040 040040   100040 040040   040116 165155   142145 162040    :   @    Number
   1     400   157146 040165   160144 141164   145144 040160   141147 145163    of updated pages
   1     404   040162 145143   157166 145162   145144 072040   101040 040124     recovered: A  T
   1     410   150145 040141   166141 151154   141142 154145   040143 157155    he available com
   1     414   155141 156144   163040 141162   145040 045040   101040 040040    mands are % A
   1     420   040040 040104   111123 120054   127101 114113   054114 111116       DISP,WALK,LIN
   1     424   113054 125116   104117 054103   117115 115111   124054 105116    K,UNDO,COMMIT,EN
   1     430   104040 141156   144040 121125   111124 056045   100040 040124    D and QUIT.%@  T
   1     434   157040 147145   164040 155157   162145 040151   156146 157054    o get more info,
   1     440   040145 156164   145162 040042   110105 114120   040122 105120     enter "HELP REP
   1     444   101111 122042   040151 156040   144151 162145   143164 151166    AIR" in directiv
   1     450   145040 145156   164162 171056   045040 040040   100040 040104    e entry.%   @  D
   1     454   102113 105131   040124 117040   120101 124103   110072 040040    BKEY TO PATCH:
   1     460   100040 040120   122111 117122   057117 127116   105122 057116    @  PRIOR/OWNER/N
   1     464   105130 124072   100040 040123   105124 055116   101115 105072    EXT:@  SET-NAME:
   1     470   100040 040116   105127 040120   117111 116124   105122 072040    @  NEW POINTER:
   1     474   101045 040040   141040 040040   040040 040040   040117 127116    A%  a        OWN
   1     500   105122 040160   157151 156164   145162 163040   160141 164143    ER pointers patc
   1     504   150145 144040   141156 144040   040165 156143   150141 156147    hed and  unchang
   1     510   145144 040040   100040 040040   116157 040154   151156 153141    ed  @   No linka
   1     514   147145 040142   145164 167145   145156 040120   101040 145156    ge between PA en
   1     520   164162 151145   163045 040040   040150 141163   040156 157040    tries%   has no
   1     524   117127 116105   122040 160157   151156 164145   162040 151156    OWNER pointer in
   1     530   040163 145164   040040 040040   100040 040040   101165 164157     set    @   Auto
   1     534   040162 145160   141151 162040   146157 162040   117127 116105     repair for OWNE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:199  
   1     540   122040 160157   151156 164145   162163 040157   156154 171045    R pointers only%
   1     544   100040 040040   103141 156156   157164 040154   151156 153040    @   Cannot link
   1     550   164167 157040   157167 156145   162163 040146   157162 040171    two owners for y
   1     554   157165 045040   100040 040040   115145 155142   145162 040162    ou% @   Member r
   1     560   145143 157162   144040 040040   040143 141156   156157 164040    ecord    cannot
   1     564   142145 040154   151156 153145   144040 164157   040151 164163    be linked to its
   1     570   145154 146040   040151 163040   156157 164040   141156 040157    elf  is not an o
   1     574   167156 145162   040151 156040   163145 164040   101040 040040    wner in set A
   1     600   124150 151163   040164 171160   145040 157146   040154 151156    This type of lin
   1     604   153040 151163   040156 157164   040154 145147   141154 040151    k is not legal i
   1     610   156040 141040   120101 040163   145164 045040   100040 040040    n a PA set% @
   1     614   120154 145141   163145 040143   150145 143153   040141 156144    Please check and
   1     620   040162 145164   162171 045040   100040 040040   040116 165155     retry% @    Num
   1     624   142145 162040   157146 040165   160144 141164   145144 040160    ber of updated p
   1     630   141147 145163   040143 157155   155151 164164   145144 072040    ages committed:
   1     634   100040 040104   102113 105131   040124 117040   123124 101122    @  DBKEY TO STAR
   1     640   124072 040040   100040 040116   105130 124057   120122 111117    T:  @  NEXT/PRIO
   1     644   122072 040040   100040 040123   105124 040124   117040 127101    R:  @  SET TO WA
   1     650   114113 072040   100040 040104   102113 105131   163040 124117    LK: @  DBKEYs TO
   1     654   040123 124117   120072 040040   100040 040124   122101 103105     STOP:  @  TRACE
   1     660   050101 114114   057117 127116   105122 057115   105115 102105    (ALL/OWNER/MEMBE
   1     664   122057 122105   103117 122104   055114 111123   124051 072040    R/RECORD-LIST):
   1     670   101040 040123   164141 162164   163040 141164   040040 040040    A  Starts at
   1     674   100040 040123   164157 160163   040141 164040   141156 171040    @  Stops at any
   1     700   120101 040155   145155 142145   162045 040040   142040 040125    PA member%  b  U
   1     704   156141 142154   145040 164157   040160 162157   143145 145144    nable to proceed
   1     710   040146 162157   155040 104102   113105 131040   040142 145146     from DBKEY  bef
   1     714   157162 145040   154157 157160   151156 147040   142040 040123    ore looping b  S
   1     720   164157 160163   040141 164040   141040 040040   040162 145143    tops at a    rec
   1     724   157162 144163   040167 141154   153145 144040   100040 167151    ords walked @ wi
   1     730   164150 040155   157162 145040   164150 141156   040157 156145    th more than one
   1     734   040157 167156   145162 163040   146157 165156   144045 040040     owners found%
   1     740   052103 101114   103040 040040   100040 167151   164150 040142    *CALC   @ with b
   1     744   141144 040157   167156 145162   040160 157151   156164 145162    ad owner pointer
   1     750   163040 144145   164145 143164   145144 045040   100040 040104    s detected% @  D
   1     754   102113 105131   040124 117040   120122 111116   124072 040040    BKEY TO PRINT:
   1     760   100040 040123   105124 123057   101114 114057   123105 124137    @  SETS/ALL/SET_
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:200  
   1     764   114111 123124   072040 040040   101045 040040   102045 040040    LIST:   A%  B%
   1     770   040040 040040   054040 040040                                        ,

(unnamed)
 Sect OctLoc
   6     000   000000 006014   000000 000000   000023 777640   002036 006000    ................
   6     004   000023 377640   045040 040040   000000 000000   777777 777770    ....%   ........
   6     010   000002 000000   000000 006000   000000 006000   040040 040040    ............
   6     014   777777 777777   000001 000000   000234 006000   002003 006000    ................
   6     020   072040 040040   000016 777640   000077 777640   000000 006000    :   .....?......
   6     024   000000 006003   000112 006000   121040 040040   002336 006000    .....J..Q   ....
   6     030   002341 006000   000000 000000   002062 006000   002006 006000    .........2......
   6     034   002005 006000   100040 040040   077040 040040   000115 006000    ....@   ?   .M..
   6     040   000132 006000   000135 006000   000003 000000   000000 000012    .Z...]..........
   6     044   400000 000000   000044 006000   000043 006000   001777 777640    .....$...#......
   6     050   000140 006000   001777 600000   000153 006000   000165 006000    .`.......k...u..
   6     054   000177 006000   000212 006000   002036 006000   002010 006000    ................
   6     060   002132 006000   056040 040040   050040 040040   051040 040040    .Z...   (   )
   6     064   000077 777777   002133 006000   002050 006000   002011 006000    .?...[...(......
   6     070   002015 006000   000012 606000   002016 006000   000015 606000    ................
   6     074   002012 006000   000000 000000   002014 006000   000020 606000    ................
   6     100   002013 006000   000000 000000   000000 006000   002033 006000    ................
   6     104   000014 006000   000000 006000   002065 006000   002006 006000    .........5......
   6     110   777777 400000   000061 006000   000062 006000   000061 006000    .....1...2...1..
   6     114   000063 006000   000337 006000   000000 006000   000000 000000    .3..............
   6     120   000023 777640   000010 006000   000023 777640   000034 006000    ................
   6     124   000023 777640   002071 006000   142040 040040   141040 040040    .....9..b   a
   6     130   776777 777777   777737 777777   000372 006000   000000 006000    ................
   6     134   002026 006000   000407 006000   000417 006000   000433 006000    ................
   6     140   000453 006000   000000 006000   000460 006000   000000 006000    ................
   6     144   000465 006000   000000 006000   000470 006000   000000 006000    ................
   6     150   000474 006000   000000 000000   000006 006000   002127 006000    .............W..
   6     154   002131 006000   000000 000000   000006 006000   002130 006000    .Y...........X..
   6     160   002121 006000   000000 000021   000161 006000   000000 000016    .Q.......q......
   6     164   000163 006000   000000 000020   000165 006000   000000 000017    .s.......u......
   6     170   000167 006000   002030 006000   002033 006000   002007 006000    .w..............
   6     174   002205 006000   000511 006000   000532 006000   000544 006000    ................
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:201  
   6     200   000577 006000   000613 006000   000634 006000   000641 006000    ................
   6     204   000000 006000   000645 006000   000651 006000   000000 006000    ................
   6     210   000656 006000   000000 006000   000674 006000   000000 000002    ................
   6     214   000213 006000   002204 006000   000727 006000   000742 006000    ................
   6     220   000753 006000   000760 006000   000000 006000   000766 006000    ................
   6     224   777677 777777   000767 006000   002003 006000   002127 006000    .............W..
   6     230   002004 006000                                                    ....
     1140     9878        %EOD;

PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:202  
--  Include file information  --

   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI_RVA_C.:ZIC0TOU  is referenced.
   ZI_UWA_C.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   XU_PERR_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$Q2RP.

   Procedure ZIU$Q2RP requires 2921 words for executable code.
   Procedure ZIU$Q2RP requires 204 words of local(AUTO) storage.
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:203  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:204  
          MINI XREF LISTING

ABN_WALK
      9796**LABEL    9739--CALLALT  9740--CALLALT
ADD_CNT
      9783**LABEL    9759--GOTO
ADD_FLAG
       166**DCL      9149<<ASSIGN   9736<<ASSIGN   9787>>IF       9791<<ASSIGN
ALTRTN IN PROCEDURE GET_CMD
      9121**LABEL    9096--CALLALT
ALT_LINK
      9696**LABEL    9677--GOTO     9686--GOTO     9690--GOTO
ALT_RET IN PROCEDURE FINDBKEY
      9394**LABEL    9378--CALLALT
ALT_RETURN IN PROCEDURE FINDBKEY
      9392**LABEL    9388--GOTO
ALT_RETURN IN PROCEDURE GET_POINTERS
      9340**LABEL    9324--GOTO     9327--GOTO     9330--GOTO     9333--GOTO     9336--GOTO
AREA_ENCRPT
       175**DCL      9050>>ASSIGN   9180>>ASSIGN   9472<<ASSIGN
AREA_INDX
       133**DCL      9051>>IF       9064<<ASSIGN   9178<<ASSIGN   9179>>ASSIGN   9180>>ASSIGN   9194>>ASSIGN
      9367>>IF       9368>>ASSIGN   9411>>IF       9412>>ASSIGN   9509<<ASSIGN
AREA_KEY$
       396**DCL       399--IMP-PTR  9047>>IF       9053>>ASSIGN   9054>>IF       9061>>ASSIGN   9179>>ASSIGN
      9368>>ASSIGN   9412>>ASSIGN   9459>>ASSIGN   9544>>IF       9546>>ASSIGN
AREA_KEY_XREF.DCB#
       400**DCL      9054>>IF       9061<<ASSIGN   9179>>ASSIGN   9459<<ASSIGN   9544>>IF       9546>>ASSIGN
AREA_KEY_XREF.MAX_KEY
       401**DCL      9047>>IF       9368>>ASSIGN   9412>>ASSIGN
AREA_KEY_XREF.NAME
       402**DCL      9053>>ASSIGN
AREA_SELECTION
      9043**PROC     9376--CALL
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:205  
AUTO_OWNER
      9640**LABEL    9659--GOTO
B$EXCFR.ASL
      2506**DCL      2506--REDEF
B$EXCFR.ERR
      2520**DCL      9202>>ASSIGN
B$EXCFR.ERR.ERR#
      2520**DCL      2520--REDEF    9200>>IF
B$EXCFR.EVID
      2519**DCL      2519--REDEF    2520--REDEF
B$EXCFR.IR
      2507**DCL      2507--REDEF
B$EXCFR.PREVSZ
      2506**DCL      2506--REDEF
B$EXCFR.SUBC
      2518**DCL      2518--REDEF    2519--REDEF    2519--REDEF
B$TCB.ALT$
      2524**DCL      9200>>IF       9202>>ASSIGN
B$TCB$
       648**DCL      9200>>IF       9202>>ASSIGN
BAD_ENTRY_NO IN PROCEDURE GET_POINTERS
      9338**LABEL    9281--GOTO
BAD_FLAG
       179**DCL      9020<<ASSIGN   9029<<ASSIGN   9029>>ASSIGN   9037<<ASSIGN   9037>>ASSIGN   9040>>IF
      9735<<ASSIGN   9764<<ASSIGN   9817>>IF
BAD_GROUP_NO IN PROCEDURE GET_POINTERS
      9332**LABEL    9298--GOTO
BAD_KEY IN PROCEDURE FINDBKEY
      9386**LABEL    9376--CALLALT
BAD_LINK
      9661**LABEL    9640--CALLALT  9641--CALLALT
BAD_OWNER
      9688**LABEL    9611--GOTO
BREAK_FLAG
       658**DCL      9520<<ASSIGN   9658>>IF       9793>>IF       9839>>IF       9870>>IF
BUF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:206  
       124**DCL       125--REDEF    8999--ASSIGN   9026<<CALLBLT  9034<<CALLBLT  9100<<CALLBLT  9115<<CALLBLT
      9117--ASSIGN   9139<<CALLBLT  9144<<CALLBLT  9275<>CALL     9277--CALLBLT  9322<<CALLBLT  9326<<CALLBLT
      9329<<CALLBLT  9332<<CALLBLT  9335<<CALLBLT  9338<<CALLBLT  9386<<CALLBLT  9390<<CALLBLT  9429<<CALLBLT
      9466<<CALLBLT  9470<>CALL     9563<<CALLBLT  9665<<CALLBLT  9675<<CALLBLT  9685<<CALLBLT  9688<<CALLBLT
      9701<<CALLBLT  9748<<CALLBLT  9797<<CALLBLT  9806<<CALLBLT  9812<<CALLBLT  9850<<CALLBLT  9852--ASSIGN
      9859<<CALLBLT  9866<<CALLBLT
BUF2.SEC
       127**DCL      9114--ASSIGN   9115--CALLBLT  9292<>CALL     9294--CALLBLT
BUFLNSF
       694**DCL      9000<<ASSIGN   9005<<CALLBLT  9080<<ASSIGN   9095<<ASSIGN   9118<<ASSIGN   9173<<ASSIGN
      9214<<ASSIGN   9478<<ASSIGN
BUFSF
       695**DCL      8999<<ASSIGN   9004<<ASSIGN   9081<<ASSIGN   9094<<ASSIGN   9117<<ASSIGN   9172<<ASSIGN
      9213<<ASSIGN   9479<<ASSIGN   9481<<ASSIGN   9483<<ASSIGN
BUILD_MSTR_TBL
       187**DCL-ENT  9441--CALL
BUILD_RECXREF
       189**DCL-ENT  9443--CALL
BUILD_SETXREF
       188**DCL-ENT  9442--CALL
CHAR1
        71**DCL      9852<<ASSIGN
CHAR4
        82**DCL      9130<<ASSIGN   9132<<ASSIGN   9139>>CALLBLT  9144>>CALLBLT
CHKSUM
      8971**DCL-ENT  9224--CALL
CHK_LO
      9448**LABEL    9445--CALLALT
CHK_NODE
      8972**DCL-ENT  9108--CALL
CHK_SET
      9235**PROC     9589--CALL
CHK_SUM
        30**DCL      9222>>IF
CNT
       623**DCL      9097<<ASSIGN   9106>>ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:207  
CONV_DBK
      9158**PROC     9112--CALL     9275--CALL     9292--CALL     9369--CALL     9375--CALL     9413--CALL
      9562--CALL     9663--CALL     9664--CALL     9700--CALL     9796--CALL     9811--CALL
COUNTSF
       745**DCL       746--REDEF
CRPT_NODE
       162**DCL      9470<>CALL
CURRENT_KEY
       180**DCL      9741<<ASSIGN   9756>>ASSIGN   9762>>ASSIGN   9779>>IF       9786>>ASSIGN   9790>>ASSIGN
      9807>>IF
CURR_REC
        62**DCL      9260>>ASSIGN   9267>>IF       9274>>ASSIGN   9282>>ASSIGN   9282>>ASSIGN   9305>>IF
      9316>>ASSIGN
CURR_SCHNM
         9**DCL      9026>>CALLBLT  9034>>CALLBLT  9386>>CALLBLT
C_POS
        72**DCL      9136>>IF       9138<<ASSIGN   9143<<ASSIGN   9143>>ASSIGN   9734<<ASSIGN
DASH_ON
       164**DCL      9431>>IF       9530<<ASSIGN   9585>>IF       9642>>IF       9658>>IF       9661>>IF
DATA$
      8951**DCL      8952--IMP-PTR  9195>>ASSIGN   9219>>ASSIGN   9225>>ASSIGN
DATA_PG.ACT_DATA
      8964**DCL      8965--REDEF    8966--REDEF    8967--REDEF
DATA_PG.CHKSUM_WD
      8956**DCL      9225<<ASSIGN
DATA_PG.CON_INTRVAL
      8960**DCL      9195>>ASSIGN   9219>>ASSIGN
DBK IN PROCEDURE GET_PTR
      9352**DCL      9344--PROC     9358<<ASSIGN   9366--ASSIGN   9367>>IF       9368<<ASSIGN   9368>>ASSIGN
      9369<>CALL
DBK_BIN IN PROCEDURE CONV_DBK
      9160**DCL      9158--PROC     9164>>CALLBLT
DBK_CUR
       129**DCL      9112<>CALL     9115--CALLBLT  9277--CALLBLT  9375<>CALL     9382--CALLBLT  9386--CALLBLT
      9390>>CALLBLT  9562<>CALL     9563>>CALLBLT  9663<>CALL     9665--CALLBLT  9700<>CALL     9701>>CALLBLT
      9796<>CALL     9797>>CALLBLT  9811<>CALL     9812--CALLBLT
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:208  
DBK_DASH_NODE
        38**DCL      9576<>CALL
DBK_LIST_NODE
        39**DCL      9721<>CALL     9824<>CALL
DBK_NEW
       130**DCL      9413<>CALL     9415--CALLBLT  9420--CALLBLT
DBK_NODE
        37**DCL      9586<>CALL     9711<>CALL
DBK_REC
        76**DCL      9139>>CALLBLT  9144>>CALLBLT  9277<<CALLBLT  9294>>CALLBLT  9322>>CALLBLT  9326>>CALLBLT
      9329>>CALLBLT  9332>>CALLBLT  9335>>CALLBLT  9338>>CALLBLT  9382<<CALLBLT  9429>>CALLBLT  9675>>CALLBLT
      9685>>CALLBLT  9688>>CALLBLT  9748>>CALLBLT  9802>>CALLBLT  9806>>CALLBLT  9850>>CALLBLT  9851>>IF
      9862<<ASSIGN   9866>>CALLBLT  9867>>IF
DBK_REC$
        74**DCL        76--IMP-PTR  9139>>CALLBLT  9144>>CALLBLT  9277>>CALLBLT  9294>>CALLBLT  9322>>CALLBLT
      9326>>CALLBLT  9329>>CALLBLT  9332>>CALLBLT  9335>>CALLBLT  9338>>CALLBLT  9382>>CALLBLT  9429>>CALLBLT
      9675>>CALLBLT  9685>>CALLBLT  9688>>CALLBLT  9748>>CALLBLT  9802>>CALLBLT  9806>>CALLBLT  9850>>CALLBLT
      9851>>IF       9862>>ASSIGN   9866>>CALLBLT  9867>>IF
DBK_REC_SIZE
        73**DCL        76--IMP-SIZ  9134>>ASSIGN   9139>>CALLBLT  9144>>CALLBLT  9276<<ASSIGN   9277>>CALLBLT
      9293<<ASSIGN   9294>>CALLBLT  9296<<ASSIGN   9322>>CALLBLT  9326>>CALLBLT  9329>>CALLBLT  9332>>CALLBLT
      9335>>CALLBLT  9338>>CALLBLT  9381<<ASSIGN   9382>>CALLBLT  9429>>CALLBLT  9675>>CALLBLT  9685>>CALLBLT
      9688>>CALLBLT  9748>>CALLBLT  9802>>CALLBLT  9803<<ASSIGN   9803>>ASSIGN   9806>>CALLBLT  9850>>CALLBLT
      9851>>IF       9862>>ASSIGN   9866>>CALLBLT  9867>>IF
DBK_TXT IN PROCEDURE CONV_DBK
      9161**DCL      9158--PROC     9164<<CALLBLT  9165<>CALL     9166>>CALLBLT
DBK_V
        64**DCL      9115>>CALLBLT  9277>>CALLBLT  9382>>CALLBLT  9386>>CALLBLT  9415>>CALLBLT  9420>>CALLBLT
      9665>>CALLBLT  9812>>CALLBLT
DBN_V
        68**DCL      9855>>CALLBLT
DBO_V
        67**DCL      9294>>CALLBLT  9859>>CALLBLT
DBP_V
        66**DCL      9277>>CALLBLT  9859>>CALLBLT
DCBSF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:209  
       674**DCL      8993<<ASSIGN   9083<<ASSIGN   9088<<ASSIGN   9093<<ASSIGN   9097--ASSIGN   9171<<ASSIGN
      9212<<ASSIGN   9451<<ASSIGN   9546<<ASSIGN   9551<<ASSIGN   9566<<ASSIGN   9704<<ASSIGN
DCB_LO
       183**DCL      8993>>ASSIGN   9083>>ASSIGN   9449<>CALL
DCB_SI
       182**DCL      9445<>CALL
DCB_UC
       181**DCL      9088>>ASSIGN   9445<>CALL     9449<>CALL     9451>>ASSIGN
DISP_OPT_NODE
        40**DCL      9826<>CALL
EIS IN PROCEDURE GET_PTR
      9346**DCL      9344--PROC
EIS.BY_OFST IN PROCEDURE GET_PTR
      9349**DCL      9363>>ASSIGN
EIS.PTR_SZ IN PROCEDURE GET_PTR
      9351**DCL      9359>>IF       9360>>IF       9364>>ASSIGN
EIS.WD_OFST IN PROCEDURE GET_PTR
      9348**DCL      9362>>ASSIGN
ENCRP_SEEDSF
       703**DCL       704--REDEF    9217<<ASSIGN
ENTRY$
       101**DCL        92--IMP-PTR  9282<<ASSIGN   9285>>ASSIGN   9286>>ASSIGN   9287>>IF
ENT_ADDR
        48**DCL      9049<<ASSIGN   9055<<ASSIGN   9057<<ASSIGN   9378>>CALL
ERRCODESF
       705**DCL       710--REDEF
EXIT_RTN
      9876**LABEL    9441--CALLALT  9442--CALLALT  9443--CALLALT  9456--CALLALT  9470--CALLALT  9554--GOTO
EXTRA_GROUP IN PROCEDURE GET_POINTERS
      9335**LABEL    9303--GOTO
E_O_F
      9543**LABEL    9535--CALLALT
F$DCB.ACTPOS
      2559**DCL      2559--REDEF
F$DCB.ARS#
      2533**DCL      2533--REDEF    9097>>ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:210  
F$DCB.ATTR
      2552**DCL      2553--REDEF
F$DCB.BORROW
      2567**DCL      2567--REDEF    2567--REDEF    2567--REDEF
F$DCB.DCBNAME.L
      2581**DCL      2581--IMP-SIZ
F$DCB.EOMCHAR#
      2537**DCL      2537--REDEF
F$DCB.FLDID
      2562**DCL      2562--REDEF
F$DCB.FORM$
      2556**DCL      2556--REDEF
F$DCB.FSECT
      2572**DCL      2572--REDEF
F$DCB.FSN#
      2549**DCL      2549--REDEF    2549--REDEF    2550--REDEF
F$DCB.HEADER$
      2555**DCL      2555--REDEF
F$DCB.IXTNSIZE#
      2553**DCL      2553--REDEF
F$DCB.LASTSTA$
      2542**DCL      2542--REDEF
F$DCB.LVL
      2568**DCL      2568--REDEF
F$DCB.NAME#.C
      2543**DCL      2543--REDEF
F$DCB.NOEOF
      2565**DCL      2565--REDEF
F$DCB.NRECS#
      2554**DCL      2554--REDEF
F$DCB.NRECX
      2573**DCL      2573--REDEF
F$DCB.OHDR
      2565**DCL      2565--REDEF
F$DCB.ORG#
      2548**DCL      2548--REDEF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:211  
F$DCB.PRECNO
      2571**DCL      2571--REDEF
F$DCB.RCSZ
      2577**DCL      2577--REDEF
F$DCB.RES#
      2544**DCL      2544--REDEF
F$DCB.SETX
      2556**DCL      2556--REDEF
F$DCB.TAB$
      2556**DCL      2556--REDEF
F$DCB.TDA
      2570**DCL      2571--REDEF
F$DCB.WSN#
      2544**DCL      2544--REDEF
FAIL_PATCH IN PROCEDURE PATCH_IT
      9436**LABEL    9427--CALLALT
FAIL_READ_JRNL IN PROCEDURE JRNL_READ
      9183**LABEL    9177--CALLALT
FAIL_UPDATE IN PROCEDURE WRITE_A_PAGE
      9230**LABEL    9227--CALLALT
FIDSF_RD
       721**DCL       722--REDEF
FINDBKEY
      9372**PROC     9592--CALL     9606--CALL     9640--CALL     9739--CALL     9838--CALL     9846--CALL
FIND_MSTR_ENTRY
       185**DCL-ENT  9022--CALL     9489--CALL
FLAG IN PROCEDURE TRACE_OUT
      9127**DCL      9125--PROC     9135>>IF       9147>>IF
FPT_JRNL
      2659**DCL      9196<>CALL
FPT_JRNL.BUF_
      2659**DCL      9190<<ASSIGN
FPT_JRNL.BUF_.BOUND
      2659**DCL      9191<<ASSIGN
FPT_JRNL.STATION_
      2661**DCL      2661--REDEF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:212  
FPT_JRNL.V
      2662**DCL      2659--DCLINIT
FPT_JRNL.V.DCB#
      2662**DCL      9189<<ASSIGN
FPT_JRNL.V.DVBYTE.VFC#
      2668**DCL      2668--REDEF
FPT_PFIL
      2610**DCL      9557<>CALL
FPT_PFIL.V
      2610**DCL      2610--DCLINIT
FPT_PFIL.V.DCB#
      2610**DCL      9556<<ASSIGN
FPT_PROMPT
      2630**DCL      9091<>CALL
FPT_PROMPT.V
      2638**DCL      2632--DCLINIT
FPT_TRMPRG.V.CTLFLG.PURGEOUTPUT#
      2699**DCL      9513<<ASSIGN   9876<<ASSIGN
FPT_TRMPRG.V.CTLFLG.RSTBRK#
      2697**DCL      2698--REDEF
FULLSF
       692**DCL      9215<<ASSIGN
FUNC_CODE
       167**DCL      9321>>IF       9422>>IF       9538<<ASSIGN   9539>>DOCASE   9595>>IF
FUNSF
       685**DCL      9058<<ASSIGN
GDS_RESULT.W2
      2596**DCL      2597--REDEF
GET_CMD
      9072**PROC     9470--CALL     9535--CALL     9576--CALL     9578--CALL     9580--CALL     9586--CALL
      9711--CALL     9713--CALL     9715--CALL     9721--CALL     9728--CALL     9824--CALL     9826--CALL
GET_DCB
      8976**DCL-ENT  9060--CALL     9511--CALL
GET_NXT_AC
      8980**DCL-ENT  9063--CALL     9461--CALL
GET_POINTERS
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:213  
      9253**PROC     9593--CALL     9607--CALL     9641--CALL     9740--CALL     9849--CALL
GET_PTR
      9344**PROC     9307--CALL     9308--CALL     9309--CALL     9313--CALL     9403--CALL     9406--CALL
      9409--CALL
GROUP$
       102**DCL        97--IMP-PTR  9289<<ASSIGN   9297>>IF       9299>>ASSIGN
HELPCODE
       739**DCL       744--REDEF
ICHKSUM
       659**DCL       660--REDEF    9225>>ASSIGN
III
        50**DCL      9063<>CALL     9077<<ASSIGN   9077>>ASSIGN   9105>>IF       9155<<ASSIGN   9237<<DOINDEX
      9238>>IF       9410<<ASSIGN   9411>>IF       9412<<ASSIGN   9412>>ASSIGN   9421--ASSIGN   9469<<ASSIGN
      9484<<DOINDEX  9487>>ASSIGN   9488>>ASSIGN   9488>>ASSIGN   9489>>CALL     9526<<ASSIGN   9543<<DOINDEX
      9544>>IF       9546>>ASSIGN   9558<<DOINDEX  9587>>IF       9614<<DOINDEX  9615>>IF       9615>>IF
      9615>>IF       9617<<ASSIGN   9618<<ASSIGN   9618>>ASSIGN   9620>>IF       9720>>IF       9725>>IF
      9730>>IF       9774<<DOINDEX  9775>>IF       9778<<DOINDEX  9779>>IF       9800>>IF       9830>>IF
      9836<<DOINDEX  9837>>ASSIGN   9848<<DOINDEX  9849<>CALL     9850>>CALLBLT
ILLEGAL_PA_LINK
      9692**LABEL    9620--GOTO
INCL_ERR
       717**DCL      9203<<ASSIGN
INDX IN PROCEDURE CONV_DBK
      9162**DCL      9158--PROC     9166<<CALLBLT
INDX IN PROCEDURE GET_PTR
      9354**DCL      9344--PROC     9357<<ASSIGN   9369<>CALL
ITEM_LIST.NAME
      6653**DCL      9013<<ASSIGN   9022<>CALL     9023>>CALLBLT  9026--CALLBLT  9034--CALLBLT  9238>>IF
      9263>>IF       9322>>CALLBLT  9487>>ASSIGN   9488>>ASSIGN   9489<>CALL     9675>>CALLBLT  9688>>CALLBLT
      9817>>IF       9850>>CALLBLT
ITMCNT
       661**DCL      9455>>ASSIGN   9476>>ASSIGN   9477<<ASSIGN
I_O_BUF
       638**DCL      9172--ASSIGN   9190--ASSIGN   9213--ASSIGN
I_O_BUF$
       637**DCL       638--IMP-PTR  9172>>ASSIGN   9190>>ASSIGN   9213>>ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:214  
JJJ
        51**DCL      9490<<ASSIGN   9491>>ASSIGN   9492>>DOWHILE  9493<<ASSIGN   9493>>ASSIGN   9494>>ASSIGN
      9495>>IF       9844<<DOINDEX  9845>>ASSIGN   9847>>IF       9849<>CALL
JRNL_CNT
        78**DCL      9197<<ASSIGN   9197>>ASSIGN   9515<<ASSIGN   9558>>DOINDEX  9562<>CALL     9700<>CALL
      9703<<ASSIGN
JRNL_DCB#
        79**DCL      9171>>ASSIGN   9189>>ASSIGN   9512<<ASSIGN   9516>>ASSIGN   9551>>ASSIGN   9556>>ASSIGN
      9566>>ASSIGN   9704>>ASSIGN
JRNL_KEY.AREA_INDX
       154**DCL      9178>>ASSIGN   9194<<ASSIGN
JRNL_KEY.L
       152**DCL      9192<<ASSIGN
JRNL_KEY.MBZ
       153**DCL      9193<<ASSIGN
JRNL_KEY.PAGE_NO
       155**DCL      9195<<ASSIGN
JRNL_KEY$
       150**DCL       151--IMP-PTR  9178>>ASSIGN   9192>>ASSIGN   9193>>ASSIGN   9194>>ASSIGN   9195>>ASSIGN
JRNL_READ
      9169**PROC     9559--CALL
JRNL_WRITE
      9187**PROC     9419--CALL
KCNT
       630**DCL      9524<<ASSIGN
KCNT_SAVE
       165**DCL      9731<<ASSIGN   9800>>IF
KEEP_WALKING
      9739**LABEL    9794--GOTO
KEYRSF
       727**DCL      9176<<ASSIGN
KEYSF
       676**DCL      9174<<ASSIGN   9216<<ASSIGN
KEYVSF
       677**DCL       150--DCLINIT   682--REDEF    2659--DCLINIT
KEYVSF.IDSKEY
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:215  
       680**DCL      9219<<ASSIGN
KEYVSF.LEN
       678**DCL      9218<<ASSIGN
KEYVSF.WD_ONE
       679**DCL       680--REDEF
KEY_RNG.FIR
      6650**DCL      9045>>IF       9047>>IF       9374>>ASSIGN   9375<>CALL     9462<<ASSIGN   9472>>ASSIGN
      9599<>CALL     9602>>IF       9602>>IF       9604>>ASSIGN   9605<<ASSIGN   9605>>ASSIGN   9608>>IF
      9638<<ASSIGN   9645<>CALL     9649<>CALL     9652<>CALL     9654<>CALL     9657<<ASSIGN   9658>>IF
      9658>>IF       9723<<ASSIGN   9723>>ASSIGN   9737>>ASSIGN   9741>>ASSIGN   9743<<ASSIGN   9745<<ASSIGN
      9779>>IF       9790<<ASSIGN   9807>>IF       9837<<ASSIGN   9837>>ASSIGN   9845<<ASSIGN   9845>>ASSIGN
KEY_RNG.SEC
      6651**DCL      9374<<ASSIGN
KKK
        52**DCL      9111<<ASSIGN   9112<>CALL     9461<>CALL     9485<<ASSIGN   9497<<ASSIGN   9497>>ASSIGN
      9498>>IF       9604<<ASSIGN   9608>>IF       9622<>CALL     9625<>CALL     9628<>CALL     9633<>CALL
      9636<>CALL     9638>>ASSIGN   9658>>IF
KKK IN PROCEDURE GET_POINTERS
      9255**DCL      9253--PROC     9269>>IF       9275>>CALL     9280>>IF       9282>>ASSIGN   9290>>IF
      9292>>CALL     9297>>IF       9299>>ASSIGN   9302>>IF
K_CNT
       161**DCL      9468<<ASSIGN   9523<<ASSIGN   9575>>IF       9585>>IF       9585>>IF       9590>>IF
      9591>>IF       9599>>CALL     9602>>IF       9605>>ASSIGN   9607<>CALL     9608>>IF       9630>>IF
      9645>>CALL     9649>>CALL     9652>>CALL     9654>>CALL     9710>>IF       9720>>IF       9722<<ASSIGN
      9722>>ASSIGN   9723>>ASSIGN   9731>>ASSIGN   9778>>DOINDEX  9789>>IF       9789<<ASSIGN   9789>>ASSIGN
      9790>>ASSIGN   9807>>IF       9821>>IF       9823>>IF       9836>>DOINDEX  9844>>DOINDEX
LAST_DBK
        46**DCL      9062<<ASSIGN   9457<<ASSIGN
M$OPEN
      1306**DCL-ENT  9517--CALL
M$PFIL
      1308**DCL-ENT  9557--CALL
M$PROMPT
      1330**DCL-ENT  9091--CALL
M$SI
      8970**DCL      9093>>ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:216  
M$WRITE
      1307**DCL-ENT  9196--CALL
MEM_TO_ITSELF
      9685**LABEL    9603--GOTO
MONITOR_ERR
       712**DCL      9202<<ASSIGN
MOVE_SET_NAME
      9010**PROC     9583--CALL     9718--CALL     9822--CALL     9829--CALL
MSG IN PROCEDURE WRITE_A_LINE
      8991**DCL      8989--PROC     8995--ENTRY    8997--IF       9004--ASSIGN   9005>>CALLBLT
MSGCODE
       711**DCL       712--REDEF
MSTR$
       365**DCL       368--IMP-PTR  9032>>IF       9260>>ASSIGN   9263>>IF       9265>>IF       9267>>IF
      9274>>ASSIGN   9282>>ASSIGN   9282>>ASSIGN   9305>>IF       9316>>ASSIGN   9367>>IF       9411>>IF
      9460>>ASSIGN   9490>>ASSIGN   9491>>ASSIGN   9494>>ASSIGN   9495>>IF       9612>>IF
MSTR_INDX
       391**DCL      9022<>CALL     9024>>IF       9032>>IF       9262<<ASSIGN   9263>>IF       9265>>IF
      9305>>IF       9367>>IF       9411>>IF       9489<>CALL     9490>>ASSIGN   9612>>IF
MSTR_REF.GLOBAL
       375**DCL      9367>>IF       9411>>IF
MSTR_REF.NAME
       373**DCL      9263>>IF       9460>>ASSIGN   9491>>ASSIGN   9494>>ASSIGN
MSTR_REF.NEXT
       370**DCL      9260>>ASSIGN   9305>>IF       9490>>ASSIGN
MSTR_REF.NXTHSH
       371**DCL       372--REDEF
MSTR_REF.PAENT
       377**DCL       378--REDEF    9282>>ASSIGN   9495>>IF
MSTR_REF.PAOFF
       374**DCL       375--REDEF    9267>>IF       9274>>ASSIGN   9282>>ASSIGN
MSTR_REF.SET.PATYPE
       383**DCL      9265>>IF       9612>>IF
MSTR_REF.TYPE
       369**DCL      9032>>IF       9316>>ASSIGN
NEW_PTR IN PROCEDURE PATCH_IT
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:217  
      9400**DCL      9397--PROC     9410>>ASSIGN   9413<>CALL     9414>>IF       9431>>IF
NEXT_CMD
      9520**LABEL    9576--CALLALT  9578--CALLALT  9580--CALLALT  9584--CALLALT  9586--CALLALT  9589--CALLALT
      9592--CALLALT  9593--CALLALT  9599--CALLALT  9600--GOTO     9606--CALLALT  9607--CALLALT  9622--CALLALT
      9625--CALLALT  9628--CALLALT  9633--CALLALT  9636--CALLALT  9645--CALLALT  9649--CALLALT  9652--CALLALT
      9654--CALLALT  9670--GOTO     9673--GOTO     9680--GOTO     9683--GOTO     9694--GOTO     9711--CALLALT
      9713--CALLALT  9715--CALLALT  9719--CALLALT  9721--CALLALT  9728--CALLALT  9753--GOTO     9824--CALLALT
      9826--CALLALT  9827--CALLALT  9839--GOTO     9842--GOTO     9870--GOTO     9873--GOTO
NEXT_DBKEY
      9870**LABEL    9846--CALLALT  9864--GOTO
NEXT_MEMBER
      9657**LABEL    9643--GOTO
NEXT_SET
      9864**LABEL    9849--CALLALT
NOP_NODE
        45**DCL      9578<>CALL
NOP_TEXT
       131**DCL      9429>>CALLBLT
NOTIMESF
       684**DCL      9221<<ASSIGN
NOT_AUTO_OWNER
      9679**LABEL    9591--GOTO
NOT_PA_REC IN PROCEDURE GET_POINTERS
      9326**LABEL    9272--GOTO
NOT_THERE IN PROCEDURE FINDBKEY
      9390**LABEL    9379--GOTO
NO_AREAS
       407**DCL      9046>>DOINDEX  9458>>DOINDEX  9543>>DOINDEX
NO_GROUP_INDX IN PROCEDURE GET_POINTERS
      9329**LABEL    9291--GOTO
NO_OWNER_PTR
      9675**LABEL    9594--GOTO
NO_RECS
       427**DCL      9460>>ASSIGN
NO_SETS
       428**DCL      9460>>ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:218  
N_K
        59**DCL      9309<>CALL     9657>>ASSIGN   9658>>IF       9743>>ASSIGN   9765>>IF
N_OR_P
       170**DCL      9150>>IF       9533<<ASSIGN   9577>>IF       9591>>IF       9594>>IF       9598<<ASSIGN
      9599<>CALL     9610>>IF       9615>>IF       9632>>IF       9635>>IF       9645<>CALL     9712>>IF
      9742>>IF       9765>>IF       9765>>IF
N_OR_P_NODE
        44**DCL      9713<>CALL
OKAY
      9455**LABEL    9446--GOTO     9449--CALLALT
OPEN_JRNL
      2768**DCL      9517<>CALL
OPEN_JRNL.ACSVEH_
      2770**DCL      2771--REDEF
OPEN_JRNL.ALTKEYS_
      2776**DCL      2777--REDEF    2777--REDEF
OPEN_JRNL.HDR_
      2775**DCL      2776--REDEF
OPEN_JRNL.TAB_
      2774**DCL      2775--REDEF
OPEN_JRNL.UHL_
      2768**DCL      2769--REDEF    2769--REDEF
OPEN_JRNL.V
      2777**DCL      2768--DCLINIT
OPEN_JRNL.V.DCB#
      2777**DCL      9516<<ASSIGN
OPEN_JRNL.V.FSN#
      2808**DCL      2808--REDEF    2808--REDEF
OPEN_JRNL.WSN_
      2774**DCL      2774--REDEF
OUT$BLK.CODE
      6324**DCL      9538>>ASSIGN
OUT$BLK.SUBLK$
      6349**DCL      9538>>ASSIGN
OUTPUT_UC
       163**DCL      9086>>IF       9448<<ASSIGN   9450<<ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:219  
OWNER_CNT
       178**DCL      9432<<ASSIGN   9432>>ASSIGN   9532<<ASSIGN   9664<>CALL     9784<<ASSIGN   9784>>ASSIGN
      9814>>IF
OWNER_KEY
       176**DCL      9733<<ASSIGN   9756<<ASSIGN   9758<<ASSIGN   9763>>IF
O_K
        61**DCL      9308<>CALL     9758>>ASSIGN   9762<<ASSIGN   9763>>IF
PARSE_ERR IN PROCEDURE GET_CMD
      9111**LABEL    9107--CALLALT
PARSE_TREE IN PROCEDURE GET_CMD
      9074**DCL      9072--PROC     9084--ASSIGN
PATCH_IT
      9397**PROC     9599--CALL     9622--CALL     9625--CALL     9628--CALL     9633--CALL     9636--CALL
      9645--CALL     9649--CALL     9652--CALL     9654--CALL
PA_DBK.FIR
       172**DCL      9269>>IF       9275<>CALL     9280>>IF       9282>>ASSIGN   9590>>IF       9590>>IF
      9630>>IF       9630>>IF       9644>>IF       9724<<ASSIGN
PA_DBK.SEC
       173**DCL      9290>>IF       9292<>CALL     9297>>IF       9299>>ASSIGN   9302>>IF       9644>>IF
PA_ENTRY.C
        93**DCL      9287>>IF
PA_ENTRY.PTRS
        96**DCL      9285>>ASSIGN   9286--ASSIGN
PA_GROUP.NO_GROUPS
        98**DCL      9297>>IF
PA_LINK
       121**DCL      9615>>IF       9615>>IF       9615>>IF
PA_POINTER
        84**DCL      9313<>CALL     9403<>CALL     9406<>CALL     9409<>CALL     9420>>CALLBLT  9664<>CALL
      9665--CALLBLT  9855>>CALLBLT
PA_REC.ENTRIES
        90**DCL      9280>>IF
PCB
      6129**DCL      9107<>CALL
PCB.HI_CHAR
      6280**DCL      9111>>ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:220  
PCB.NCHARS
      6276**DCL      9106<<ASSIGN
PCB.OUT$
      6142**DCL      6316--IMP-PTR  9108<>CALL     9538>>ASSIGN
PCB.ROOT$
      6134**DCL      9084<<ASSIGN
PRINT_HDR
        31**DCL      9098>>IF
PRINT_OPT
       157**DCL      9528<<ASSIGN   9821>>IF       9825>>IF       9828>>IF       9831>>IF
PRIOR_KEY
       177**DCL      9737<<ASSIGN   9765>>IF       9765>>IF       9786<<ASSIGN   9796<>CALL
PROMPT_CHAR
        77**DCL      2636--DCLINIT
PROMPT_MSG IN PROCEDURE GET_CMD
      9075**DCL      9072--PROC     9078>>CALLBLT  9081--ASSIGN
PTR_SIZE
       103**DCL        83--IMP-SIZ    96--IMP-SIZ   100--IMP-SIZ  9274<<ASSIGN   9285>>ASSIGN   9285>>ASSIGN
      9285>>ASSIGN   9299>>ASSIGN   9364<<ASSIGN   9366>>ASSIGN   9366>>ASSIGN   9366>>ASSIGN   9421>>ASSIGN
      9421>>ASSIGN   9421>>ASSIGN
PTR_TYPE IN PROCEDURE PATCH_IT
      9399**DCL      9397--PROC     9402>>IF       9405>>IF       9408>>IF       9422>>IF       9429>>CALLBLT
PTR_V
        83**DCL      9285<<ASSIGN   9366<<ASSIGN   9366>>ASSIGN   9421<<ASSIGN   9421>>ASSIGN
P_K
        60**DCL      9307<>CALL     9745>>ASSIGN   9765>>IF
QUIT_UNDO
      9566**LABEL    9559--CALLALT  9560--CALLALT
RBUF
         8**DCL        74--DCLINIT  6130--DCLINIT  9092<<ASSIGN   9094--ASSIGN   9100>>CALLBLT  9104>>IF
      9105>>IF       9105>>IF       9294<<CALLBLT  9802<<CALLBLT
RC_IN_PA
        70**DCL      9425<<ASSIGN
RC_TYP IN PROCEDURE GET_POINTERS
      9257**DCL      9253--PROC     9259<<ASSIGN   9266<<ASSIGN   9268<<ASSIGN   9271>>IF       9273<<ASSIGN
      9306<<ASSIGN   9310>>IF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:221  
RC_TYP1
       168**DCL      9593<>CALL     9597>>IF       9602>>IF       9608>>IF       9615>>IF       9624>>IF
      9627>>IF       9641<>CALL     9642>>IF       9648>>IF       9651>>IF       9740<>CALL     9750>>IF
      9755>>IF       9761>>IF       9769>>IF       9769>>IF       9783>>IF       9849<>CALL     9854>>IF
RC_TYP2
       169**DCL      9607<>CALL     9608>>IF       9610>>IF       9610>>IF       9615>>IF       9621>>IF
      9624>>IF
REC$
       618**DCL        85--IMP-PTR   641--IMP-PTR  9280>>IF       9282>>ASSIGN   9289>>ASSIGN   9362>>ASSIGN
RECORD_LIST.NAME
      6632**DCL      9775>>IF
REC_DATA_LN
       646**DCL       645--IMP-SIZ
REC_EXIST IN PROCEDURE JRNL_WRITE
      9200**LABEL    9196--CALLALT
REC_HDR.REC_NM
        27**DCL      9277--CALLBLT  9294--CALLBLT  9377<<ASSIGN   9379>>IF       9380>>CALLBLT  9382--CALLBLT
      9775>>IF
REC_INDX
        63**DCL      9260<<ASSIGN   9261>>DOWHILE  9262>>ASSIGN   9307>>CALL     9308>>CALL     9309>>CALL
      9319<<ASSIGN   9319>>ASSIGN   9403>>CALL     9406>>CALL     9409>>CALL     9863<<ASSIGN   9864>>IF
REC_TYPE
        69**DCL      9316<<ASSIGN   9425>>ASSIGN
REC_V
        65**DCL      9026>>CALLBLT  9034>>CALLBLT  9114<<ASSIGN   9115>>CALLBLT  9277>>CALLBLT  9294>>CALLBLT
      9382>>CALLBLT  9466>>CALLBLT  9665>>CALLBLT
REC_XREF.MSTRINDX
       423**DCL      9305>>IF       9491>>ASSIGN   9494>>ASSIGN   9495>>IF
REC_XREF.NEXT
       422**DCL      9492>>DOWHILE  9493>>ASSIGN
REC_XREF$
       420**DCL       421--IMP-PTR  9305>>IF       9491>>ASSIGN   9492>>DOWHILE  9493>>ASSIGN   9494>>ASSIGN
      9495>>IF
REP_SUB_CMD
        36**DCL      9535<>CALL
REREAD_SUBCOM IN PROCEDURE GET_CMD
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:222  
      9083**LABEL    9119--GOTO
RE_READ IN PROCEDURE GET_CMD
      9080**LABEL    9104--GOTO
RE_START
      9515**LABEL    9568--GOTO     9707--GOTO
R_CNT
       159**DCL      9522<<ASSIGN   9725>>IF       9727>>IF       9774>>DOINDEX
SC_MSG1
       135**DCL      9479--ASSIGN
SC_MSG2
       140**DCL      9481--ASSIGN
SC_MSG3
       145**DCL      9483--ASSIGN
SC_MSG3.MEMBER
       149**DCL      9415<<CALLBLT  9420<<CALLBLT  9429>>CALLBLT  9494<<ASSIGN   9855<<CALLBLT  9858<<CALLBLT
      9859>>CALLBLT
SC_MSG3.OWNER
       148**DCL      9491<<ASSIGN   9505<<ASSIGN
SC_MSG3.SETNAME
       147**DCL      9487<<ASSIGN   9504<<ASSIGN
SC_MSG3.VFC
       146**DCL      9486<<ASSIGN   9503<<ASSIGN
SC_SIZ
        33**DCL      9012>>DOINDEX  9015>>ASSIGN   9237>>DOINDEX  9476<<ASSIGN   9484>>DOINDEX  9579>>IF
      9714>>IF
SET$
        28**DCL        70--IMP-PTR  9312<<ASSIGN   9362<<ASSIGN   9363<<ASSIGN   9363>>ASSIGN   9366>>ASSIGN
      9421>>ASSIGN   9424<<ASSIGN   9424>>ASSIGN   9425>>ASSIGN
SET_HDR.NEXT
        20**DCL      9309<>CALL     9855--CALLBLT  9858>>CALLBLT
SET_HDR.OWNER
        18**DCL      9308<>CALL     9594>>IF       9859--CALLBLT
SET_HDR.PRIOR
        16**DCL      9307<>CALL     9859--CALLBLT
SET_NAMES
        34**DCL      9013>>ASSIGN   9238>>IF       9488<<ASSIGN
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:223  
SET_NODE
        42**DCL      9580<>CALL     9715<>CALL
SET_PA$
        75**DCL      9286<<ASSIGN   9299<<ASSIGN   9312>>ASSIGN
SET_XREF.EIS.NEXT
       416**DCL      9309<>CALL     9409<>CALL
SET_XREF.EIS.OWNR
       415**DCL      9308<>CALL     9406<>CALL
SET_XREF.EIS.PRIOR
       414**DCL      9307<>CALL     9403<>CALL
SET_XREF.MSTRINDX
       411**DCL      9262>>ASSIGN
SET_XREF.NEXT
       412**DCL      9319>>ASSIGN
SET_XREF$
       409**DCL       410--IMP-PTR  9262>>ASSIGN   9307>>CALL     9308>>CALL     9309>>CALL     9319>>ASSIGN
      9403>>CALL     9406>>CALL     9409>>CALL
SHARESF
       725**DCL      9059<<ASSIGN
SSS IN PROCEDURE GET_POINTERS
      9256**DCL      9253--PROC     9263>>IF       9322>>CALLBLT
STOP_BY_BREAK
      9806**LABEL    9793--GOTO
STOP_WALKING
      9800**LABEL    9780--GOTO
SXCNT
        29**DCL      9525<<ASSIGN   9835<<ASSIGN
SYS_FUNC_CLOS
      8982**DCL-ENT  9547--CALL     9552--CALL     9705--CALL
SYS_FUNC_CORRES
      8987**DCL-ENT  9445--CALL     9449--CALL
SYS_FUNC_ERRMSG
      8985**DCL-ENT  9204--CALL
SYS_FUNC_READ
      8983**DCL-ENT  9096--CALL     9177--CALL
SYS_FUNC_RELDCB
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:224  
      8986**DCL-ENT  9548--CALL     9553--CALL
SYS_FUNC_RELEASE
      8984**DCL-ENT  9567--CALL
SYS_FUNC_WRIT
      8973**DCL-ENT  9007--CALL     9085--CALL     9089--CALL     9227--CALL     9480--CALL     9482--CALL
      9499--CALL     9502--CALL
S_CNT
       160**DCL      9012<<DOINDEX  9013>>ASSIGN   9013>>ASSIGN   9015<<ASSIGN   9021>>DOINDEX  9455<<ASSIGN
      9521<<ASSIGN   9579>>IF       9582>>IF       9714>>IF       9717>>IF       9821>>IF       9825>>IF
      9848>>DOINDEX
TRACE_CNT
        81**DCL      9129>>IF       9133<<ASSIGN   9732<<ASSIGN
TRACE_OUT
      9125**PROC     9767--CALL     9772--CALL     9776--CALL
TWO_OWNERS
      9682**LABEL    9609--GOTO
TWO_PA
      9672**LABEL    9590--GOTO
TXT IN PROCEDURE GET_PTR
      9353**DCL      9344--PROC     9356<<ASSIGN   9369<>CALL
UWA.AC_REC.CALC_NEXT
      7621**DCL      7622--REDEF
UWA.AC_REC.CALC_PRIOR
      7630**DCL      7631--REDEF
UWA.AC_REC.DEFAULTS
      7579**DCL      7580--REDEF
UWA.AC_REC.FILE_CODE
      7584**DCL      7585--REDEF
UWA.AC_REC.FLAG1.ERROR_TYPE
      7581**DCL      7582--REDEF
UWA.AC_REC.PG_TYPE
      7596**DCL      7597--REDEF
UWA.AC_REC.SWS.ENCRYP
      7587**DCL      9463>>IF
UWA.AD_REC.ADDATE
      7561**DCL      7562--REDEF
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:225  
UWA.SF_REC.DBKOA
      7527**DCL      9062>>ASSIGN   9457>>ASSIGN
V1
        53**DCL        64--IMP-SIZ  9112<>CALL     9113>>ASSIGN   9115>>CALLBLT  9276>>ASSIGN   9277>>CALLBLT
      9293>>ASSIGN   9296>>ASSIGN   9375<>CALL     9381>>ASSIGN   9382>>CALLBLT  9386>>CALLBLT  9413<>CALL
      9415>>CALLBLT  9420>>CALLBLT  9562<>CALL     9663<>CALL     9665>>CALLBLT  9700<>CALL     9796<>CALL
      9811<>CALL     9812>>CALLBLT
V2
        54**DCL        65--IMP-SIZ  9023<<CALLBLT  9026>>CALLBLT  9034>>CALLBLT  9113<<ASSIGN   9114>>ASSIGN
      9115>>CALLBLT  9276>>ASSIGN   9277>>CALLBLT  9294>>CALLBLT  9296>>ASSIGN   9380<<CALLBLT  9381>>ASSIGN
      9382>>CALLBLT  9465<<CALLBLT  9466>>CALLBLT  9664<>CALL     9665>>CALLBLT
V3
        55**DCL        66--IMP-SIZ  9078<<CALLBLT  9080>>ASSIGN   9113>>ASSIGN   9275<>CALL     9276>>ASSIGN
      9277>>CALLBLT  9293>>ASSIGN   9296>>ASSIGN   9307<>CALL     9403<>CALL     9859>>CALLBLT
V4
        56**DCL        67--IMP-SIZ  9292<>CALL     9294>>CALLBLT  9296>>ASSIGN   9308<>CALL     9406<>CALL
      9859>>CALLBLT
V5
        57**DCL        68--IMP-SIZ  9134<<ASSIGN   9135<<ASSIGN   9135>>ASSIGN   9136>>IF       9138>>ASSIGN
      9143>>ASSIGN   9309<>CALL     9409<>CALL     9855>>CALLBLT
V6
        58**DCL      9313<>CALL     9458<<DOINDEX  9459>>ASSIGN   9460>>ASSIGN   9472>>ASSIGN
VERIFY_SETS
      9018**PROC     9456--CALL     9584--CALL     9719--CALL     9827--CALL
VFCSF
       691**DCL      8996<<ASSIGN   9175<<ASSIGN   9220<<ASSIGN
WALK_CNT
        80**DCL      9129>>IF       9133>>ASSIGN   9418<<ASSIGN   9418>>ASSIGN   9531<<ASSIGN   9663<>CALL
      9746>>IF       9785<<ASSIGN   9785>>ASSIGN   9808<<ASSIGN   9808>>ASSIGN   9811<>CALL
WALK_OPT
       158**DCL      9529<<ASSIGN   9725>>IF       9726<<ASSIGN   9727>>IF       9769>>IF       9769>>IF
      9769>>IF
WALK_OPT_NODE
        43**DCL      9728<>CALL
WALK_SUMMARY
      9810**LABEL    9798--GOTO
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:226  
WK
        49**DCL      6138--DCLINIT
WRITE_A_LINE
      8989**PROC     9028--CALL     9036--CALL     9101--CALL     9102--CALL     9121--CALL     9146--CALL
      9151--CALL     9153--CALL     9183--CALL     9205--CALL     9206--CALL     9230--CALL     9240--CALL
      9340--CALL     9392--CALL     9434--CALL     9474--CALL     9536--CALL     9565--CALL     9570--CALL
      9571--CALL     9572--CALL     9588--CALL     9668--CALL     9672--CALL     9679--CALL     9682--CALL
      9692--CALL     9693--CALL     9696--CALL     9706--CALL     9730--CALL     9749--CALL     9752--CALL
      9810--CALL     9813--CALL     9815--CALL     9818--CALL     9830--CALL     9847--CALL     9853--CALL
      9861--CALL     9868--CALL
WRITE_A_PAGE
      9210**PROC     9427--CALL     9560--CALL
WRITE_TO_UC IN PROCEDURE WRITE_A_LINE
      8995**ENTRY    9452--CALL
X
       635**DCL      9021<<DOINDEX  9022>>CALL     9023>>CALLBLT  9026>>CALLBLT  9034>>CALLBLT  9046<<DOINDEX
      9047>>IF       9050>>ASSIGN   9051>>IF       9053>>ASSIGN   9054>>IF       9061>>ASSIGN   9064>>ASSIGN
      9284<<ASSIGN   9285--ASSIGN   9289>>ASSIGN   9313<>CALL     9403<>CALL     9406<>CALL     9409<>CALL
      9414>>IF       9431>>IF
X$PARSE
      8975**DCL-ENT  9107--CALL
XREF_BUILT
       429**DCL      9439>>IF
ZERO_SUP
      8974**DCL-ENT  9165--CALL
ZI$DIR.ALTKEY
      6585**DCL      6586--REDEF    6587--REDEF
ZI$DIR.AREAFID
      6551**DCL      6552--REDEF
ZI$DIR.AREA_NM
      6614**DCL      9060<>CALL     9511<>CALL
ZI$DIR.AREA_NM.DCB#
      6618**DCL      9061>>ASSIGN   9179<<ASSIGN   9212>>ASSIGN   9512>>ASSIGN
ZI$DIR.AREA_NM.NAME.TEXT
      6617**DCL      9053<<ASSIGN   9460<<ASSIGN   9465>>CALLBLT  9466--CALLBLT  9510<<ASSIGN
ZI$DIR.DATE
PL6.E3A0      #001=ZIU$Q2RP File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:24 Page:227  
      6590**DCL      6594--REDEF
ZI$DIR.DEST_SEED
      6546**DCL      6547--REDEF    6548--REDEF
ZI$DIR.ENCP_SEED
      6543**DCL      6544--REDEF    6545--REDEF    9217>>ASSIGN
ZI$DIR.ENCP_SEED_RD
      6544**DCL      9050<<ASSIGN   9180<<ASSIGN
ZI$DIR.PCALC
      6563**DCL      9834<<ASSIGN   9841<<ASSIGN
ZI$DIR.PGRG_RESET
      6557**DCL      9052<<ASSIGN
ZI$DIR.PITEM
      6564**DCL      9527<<ASSIGN   9833<<ASSIGN
ZI$DIR.REPRT_ZERO
      6577**DCL      6578--REDEF
ZI$DIR.SCHFID
      6549**DCL      6550--REDEF
ZI$DIR.TIME
      6595**DCL      6600--REDEF
ZIU$Q2PR1
      8977**DCL-ENT  9057--ASSIGN
ZIU$Q2PR2
      8978**DCL-ENT  9055--ASSIGN
ZIU$Q2PR3
      8979**DCL-ENT  9049--ASSIGN

PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:228  
     1141        1        /*T***********************************************************/
     1142        2        /*T*                                                         */
     1143        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1144        4        /*T*                                                         */
     1145        5        /*T***********************************************************/
     1146        6        %EJECT;
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:229  
     1147        7        /*M*   CHK_NODE     PARSER INTERPRTER FOR
     1148        8                            REPAIR COMMAND IN DBUTIL          */
     1149        9        CHK_NODE: PROC(NODE$) ALTRET;
     1150       10
     1151       11    1   DCL INDX SBIN;
     1152       12    1   DCL NODE$ PTR;
     1153       13    1   DCL JJJ SBIN SYMREF;
     1154       14    1   DCL KKK SBIN SYMREF;
     1155       15    1   DCL 1 PA_DBK(0:0) SYMREF,
     1156       16    1         2 FIR UBIN UNAL,
     1157       17    1         2 SEC UBIN UNAL;
     1158       18
     1159       19        %INCLUDE XU_MACRO_C;
     1160     3125
     1161     3126        %PARSE$OUT(NAME=OUT$BLK,STCLASS="BASED(NODE$)");
     1162     3171        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(NODE$)");
     1163     3209
     1164     3210        %INCLUDE ZI$DIR;
     1165     3367        %DIR;
     1166     3511
     1167     3512        %INCLUDE ZI_GLOBAL_DBUTIL;
     1168     3690        %MISC_DCLS;
     1169     3743
     1170     3744        %INCLUDE XU_SUBS_C;
     1171     3836        %INCLUDE ZI_PRSE_SUBS;
     1172     3992
     1173     3993    1   DCL PRINT_OPT UBIN BYTE SYMREF UNAL;
     1174     3994    1   DCL WALK_OPT UBIN BYTE SYMREF UNAL;
     1175     3995    1   DCL N_OR_P UBIN SYMREF;
     1176     3996    1   DCL R_CNT SBIN BYTE SYMREF UNAL;
     1177     3997    1   DCL S_CNT SBIN BYTE SYMREF UNAL;
     1178     3998    1   DCL K_CNT SBIN SYMREF;
     1179     3999    1   DCL DASH_ON SBIN BYTE SYMREF UNAL;
     1180     4000
     1181     4001    2       DO CASE(OUT$BLK.CODE);
     1182     4002
     1183     4003    2       CASE(#DBK2);
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:230  
     1184     4004    2           K_CNT=K_CNT+1;
     1185     4005    2           PA_DBK.FIR(K_CNT)=0;
     1186     4006    2           PA_DBK.SEC(K_CNT)=0;
     1187     4007    3           DO JJJ=1 TO OUT$BLK.NSUBLKS;
     1188     4008    3               CALL CHARBIN(KKK,OUT$BLK.SUBLK$(JJJ-1)->OUT$SYM.TEXT);
     1189     4009    3               IF JJJ=1 THEN
     1190     4010    4               DO;
     1191     4011    4                   KEY_RNG.FIR(K_CNT)=KKK;
     1192     4012    4                   KEY_RNG.SEC(K_CNT)=KKK;
     1193     4013    4                   END;
     1194     4014    3               ELSE
     1195     4015    3                   IF JJJ=2 THEN
     1196     4016    3                       PA_DBK.FIR(K_CNT)=KKK;
     1197     4017    3                   ELSE
     1198     4018    3                       PA_DBK.SEC(K_CNT)=KKK;
     1199     4019    3               END;
     1200     4020    2           RETURN;
     1201     4021    2       CASE(#SET_NAME2);
     1202     4022    2           S_CNT=S_CNT+1;
     1203     4023    2           ITEM_LIST.NAME(S_CNT)=OUT$SYM.TEXT;
     1204     4024    2       CASE(#REC_NAME2);
     1205     4025    2           R_CNT=R_CNT+1;
     1206     4026    2           RECORD_LIST.NAME(R_CNT)=OUT$SYM.TEXT;
     1207     4027    2       CASE(#NEXT2,#PRIOR2);
     1208     4028    2           N_OR_P=OUT$BLK.CODE;
     1209     4029    2       CASE(#MEMBER2,#OWNER2,#ALL2);
     1210     4030    2           WALK_OPT=OUT$BLK.CODE;
     1211     4031    2           PRINT_OPT=OUT$BLK.CODE;
     1212     4032    2           IF OUT$BLK.CODE=#OWNER2 THEN N_OR_P=#OWNER2;
     1213     4033    2       CASE(#SETS2);
     1214     4034    2           PRINT_OPT=OUT$BLK.CODE;
     1215     4035    2       CASE(#DASH2);
     1216     4036    2           DASH_ON = 1;
     1217     4037    2           END;
     1218     4038
     1219     4039    2       DO CASE(OUT$BLK.NDTYPE);
     1220     4040
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:231  
     1221     4041    2       CASE(%OCT#);
     1222     4042    3           DO INDX=0 TO OUT$SYM.COUNT-1;
     1223     4043    3               CALL INDEX1(JJJ,SUBSTR(OUT$SYM.TEXT,INDX,1),'01234567');
     1224     4044    3               KEY_RNG.FIR(0)=KEY_RNG.FIR(0)*8+JJJ;
     1225     4045    3               END;
     1226     4046    2       CASE(%DSTRING#,%NULL#,%DEC#,%ALPHA#,%ALNUM#,%SYM#,%ASYM#,%FID#);
     1227     4047    2       CASE(ELSE);
     1228     4048    3           DO INDX=0 TO OUT$BLK.NSUBLKS - 1;
     1229     4049    3               CALL CHK_NODE(OUT$BLK.SUBLK$(INDX));
     1230     4050    3               END;
     1231     4051    2           END;
     1232     4052    1   END CHK_NODE;
     1233     4053
     1234     4054
     1235     4055
     1236     4056
     1237     4057
     1238     4058
     1239     4059
     1240     4060
     1241     4061
     1242     4062
     1243     4063

PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:232  
--  Include file information  --

   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   XU_SUBS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure CHK_NODE.

   Procedure CHK_NODE requires 192 words for executable code.
   Procedure CHK_NODE requires 8 words of local(AUTO) storage.

    No errors detected in file ZIU$Q2RP.:ZIC0TSI    .

PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:233  

 Object Unit name= CHK_NODE                                   File name= ZIU$Q2RP.:ZIC0TOU
 UTS= SEP 05 '97 13:25:40.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      2      2  CHK_NODE
    2   Proc  even  none   192    300  CHK_NODE
    3  RoData even  none     2      2  CHK_NODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  CHK_NODE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:234  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     JJJ                                   KKK                                   PA_DBK
     ZI$DIR                                SCHEMA_ACTIVE                         RECORD_LIST
     SET_LIST                              RETAIN_LIST                           DUMP_FID
     ALTKY                                 INIT_RG                               KEY_RNG
     ITEM_LIST                             REC$                                  RB
     RE                                    IE                                    IB
     CNT                                   ICNT                                  RCNT
     SCNT                                  FIRST_SET                             RETCNT
     DMPCNT                                KCNT                                  ACNT_IDX
     I                                     J                                     K
     X                                     STEPCC                                I_O_BUF$
     OUT_INDX                              I_O_SIZE                              REC_DATA_LN
     M$LO                                  B$TCB$                                B$ROS$
     B$JIT$                                KEYFID                                I_O_KEY
     RESTART                               BREAK_FLAG                            ICHKSUM
     ITMCNT                                GAP1                                  PRINT_OPT
     WALK_OPT                              N_OR_P                                R_CNT
     S_CNT                                 K_CNT                                 DASH_ON
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:235  


     1141        1        /*T***********************************************************/
     1142        2        /*T*                                                         */
     1143        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1144        4        /*T*                                                         */
     1145        5        /*T***********************************************************/
     1146        6        %EJECT;
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:236  
     1147        7        /*M*   CHK_NODE     PARSER INTERPRTER FOR
     1148        8                            REPAIR COMMAND IN DBUTIL          */
     1149        9        CHK_NODE: PROC(NODE$) ALTRET;

      9  2 000000   000000 700200 xent  CHK_NODE     TSX0  ! X66_AUTO_1
         2 000001   000010 000001                    ZERO    8,1

     1150       10
     1151       11    1   DCL INDX SBIN;
     1152       12    1   DCL NODE$ PTR;
     1153       13    1   DCL JJJ SBIN SYMREF;
     1154       14    1   DCL KKK SBIN SYMREF;
     1155       15    1   DCL 1 PA_DBK(0:0) SYMREF,
     1156       16    1         2 FIR UBIN UNAL,
     1157       17    1         2 SEC UBIN UNAL;
     1158       18
     1159       19        %INCLUDE XU_MACRO_C;
     1160     3125
     1161     3126        %PARSE$OUT(NAME=OUT$BLK,STCLASS="BASED(NODE$)");
     1162     3171        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(NODE$)");
     1163     3209
     1164     3210        %INCLUDE ZI$DIR;
     1165     3367        %DIR;
     1166     3511
     1167     3512        %INCLUDE ZI_GLOBAL_DBUTIL;
     1168     3690        %MISC_DCLS;
     1169     3743
     1170     3744        %INCLUDE XU_SUBS_C;
     1171     3836        %INCLUDE ZI_PRSE_SUBS;
     1172     3992
     1173     3993    1   DCL PRINT_OPT UBIN BYTE SYMREF UNAL;
     1174     3994    1   DCL WALK_OPT UBIN BYTE SYMREF UNAL;
     1175     3995    1   DCL N_OR_P UBIN SYMREF;
     1176     3996    1   DCL R_CNT SBIN BYTE SYMREF UNAL;
     1177     3997    1   DCL S_CNT SBIN BYTE SYMREF UNAL;
     1178     3998    1   DCL K_CNT SBIN SYMREF;
     1179     3999    1   DCL DASH_ON SBIN BYTE SYMREF UNAL;
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:237  
     1180     4000
     1181     4001    2       DO CASE(OUT$BLK.CODE);

   4001  2 000002   200003 470500                    LDP0    @NODE$,,AUTO
         2 000003   000000 471500                    LDP1    0,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000012 136007                    SBLQ    10,DL
         2 000007   000012 116007                    CMPQ    10,DL
         2 000010   000012 602006 2                  TNC     s:4001+8,QL
         2 000011   000174 710000 2                  TRA     s:4039
         2 000012   000024 710000 2                  TRA     s:4004
         2 000013   000165 710000 2                  TRA     s:4034
         2 000014   000145 710000 2                  TRA     s:4030
         2 000015   000101 710000 2                  TRA     s:4022
         2 000016   000141 710000 2                  TRA     s:4028
         2 000017   000141 710000 2                  TRA     s:4028
         2 000020   000145 710000 2                  TRA     s:4030
         2 000021   000145 710000 2                  TRA     s:4030
         2 000022   000121 710000 2                  TRA     s:4025
         2 000023   000172 710000 2                  TRA     s:4036

     1182     4002
     1183     4003    2       CASE(#DBK2);

     1184     4004    2           K_CNT=K_CNT+1;

   4004  2 000024   000000 054000 xsym               AOS     K_CNT

     1185     4005    2           PA_DBK.FIR(K_CNT)=0;

   4005  2 000025   000000 235000 xsym               LDA     K_CNT
         2 000026   000001 735000                    ALS     1
         2 000027   000000 450005 xsym               STZ     PA_DBK,AL

     1186     4006    2           PA_DBK.SEC(K_CNT)=0;

PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:238  
   4006  2 000030   000001 450005 xsym               STZ     PA_DBK+1,AL

     1187     4007    3           DO JJJ=1 TO OUT$BLK.NSUBLKS;

   4007  2 000031   000001 236007                    LDQ     1,DL
         2 000032   000000 756000 xsym               STQ     JJJ
         2 000033   000073 710000 2                  TRA     s:4019+1

     1188     4008    3               CALL CHARBIN(KKK,OUT$BLK.SUBLK$(JJJ-1)->OUT$SYM.TEXT);

   4008  2 000034   200003 470500                    LDP0    @NODE$,,AUTO
         2 000035   000000 471500                    LDP1    0,,PR0
         2 000036   000000 720000 xsym               LXL0    JJJ
         2 000037   100002 473510                    LDP3    2,X0,PR1
         2 000040   300004 236100                    LDQ     4,,PR3
         2 000041   000033 772000                    QRL     27
         2 000042   000000 621006                    EAX1    0,QL
         2 000043   000000 305540                    DTB
         2 000044   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         2 000045   000000 000004 xsym               NDSC9   KKK                      cn=0,s=lsgnf,sf=0,n=4

     1189     4009    3               IF JJJ=1 THEN

   4009  2 000046   000000 235000 xsym               LDA     JJJ
         2 000047   000001 115007                    CMPA    1,DL
         2 000050   000057 601000 2                  TNZ     s:4015

     1190     4010    4               DO;

     1191     4011    4                   KEY_RNG.FIR(K_CNT)=KKK;

   4011  2 000051   000000 236000 xsym               LDQ     K_CNT
         2 000052   000001 736000                    QLS     1
         2 000053   000000 235000 xsym               LDA     KKK
         2 000054   000000 755006 xsym               STA     KEY_RNG,QL

     1192     4012    4                   KEY_RNG.SEC(K_CNT)=KKK;
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:239  

   4012  2 000055   000001 755006 xsym               STA     KEY_RNG+1,QL

     1193     4013    4                   END;

   4013  2 000056   000072 710000 2                  TRA     s:4019

     1194     4014    3               ELSE
     1195     4015    3                   IF JJJ=2 THEN

   4015  2 000057   000002 115007                    CMPA    2,DL
         2 000060   000066 601000 2                  TNZ     s:4018

     1196     4016    3                       PA_DBK.FIR(K_CNT)=KKK;

   4016  2 000061   000000 236000 xsym               LDQ     K_CNT
         2 000062   000001 736000                    QLS     1
         2 000063   000000 235000 xsym               LDA     KKK
         2 000064   000000 755006 xsym               STA     PA_DBK,QL
         2 000065   000072 710000 2                  TRA     s:4019

     1197     4017    3                   ELSE
     1198     4018    3                       PA_DBK.SEC(K_CNT)=KKK;

   4018  2 000066   000000 236000 xsym               LDQ     K_CNT
         2 000067   000001 736000                    QLS     1
         2 000070   000000 235000 xsym               LDA     KKK
         2 000071   000001 755006 xsym               STA     PA_DBK+1,QL

     1199     4019    3               END;

   4019  2 000072   000000 054000 xsym               AOS     JJJ
         2 000073   000000 471500                    LDP1    0,,PR0
         2 000074   100001 236100                    LDQ     1,,PR1
         2 000075   000022 772000                    QRL     18
         2 000076   000000 116000 xsym               CMPQ    JJJ
         2 000077   000034 605000 2                  TPL     s:4008
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:240  

     1200     4020    2           RETURN;

   4020  2 000100   000000 702200 xent               TSX2  ! X66_ARET

     1201     4021    2       CASE(#SET_NAME2);

     1202     4022    2           S_CNT=S_CNT+1;

   4022  2 000101   001000 236003                    LDQ     512,DU
         2 000102   000000 056000 xsym               ASQ     S_CNT

     1203     4023    2           ITEM_LIST.NAME(S_CNT)=OUT$SYM.TEXT;

   4023  2 000103   000000 236000 xsym               LDQ     S_CNT
         2 000104   000030 732000                    QRS     24
         2 000105   000000 376000 3                  ANQ     0
         2 000106   000000 471500                    LDP1    0,,PR0
         2 000107   000000 620006                    EAX0    0,QL
         2 000110   100004 236100                    LDQ     4,,PR1
         2 000111   000033 772000                    QRL     27
         2 000112   000000 635010                    EAA     0,X0
         2 000113   000020 771000                    ARL     16
         2 000114   000000 620006                    EAX0    0,QL
         2 000115   040005 100540                    MLR     fill='040'O
         2 000116   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000117   000000 000036 xsym               ADSC9   ITEM_LIST,A              cn=0,n=30
         2 000120   000174 710000 2                  TRA     s:4039

     1204     4024    2       CASE(#REC_NAME2);

     1205     4025    2           R_CNT=R_CNT+1;

   4025  2 000121   001000 236003                    LDQ     512,DU
         2 000122   000000 056000 xsym               ASQ     R_CNT

     1206     4026    2           RECORD_LIST.NAME(R_CNT)=OUT$SYM.TEXT;
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:241  

   4026  2 000123   000000 236000 xsym               LDQ     R_CNT
         2 000124   000030 732000                    QRS     24
         2 000125   000000 376000 3                  ANQ     0
         2 000126   000000 471500                    LDP1    0,,PR0
         2 000127   000000 620006                    EAX0    0,QL
         2 000130   100004 236100                    LDQ     4,,PR1
         2 000131   000033 772000                    QRL     27
         2 000132   000000 635010                    EAA     0,X0
         2 000133   000020 771000                    ARL     16
         2 000134   000000 620006                    EAX0    0,QL
         2 000135   040005 100540                    MLR     fill='040'O
         2 000136   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000137   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         2 000140   000174 710000 2                  TRA     s:4039

     1207     4027    2       CASE(#NEXT2,#PRIOR2);

     1208     4028    2           N_OR_P=OUT$BLK.CODE;

   4028  2 000141   100000 236100                    LDQ     0,,PR1
         2 000142   777777 376007                    ANQ     -1,DL
         2 000143   000000 756000 xsym               STQ     N_OR_P
         2 000144   000174 710000 2                  TRA     s:4039

     1209     4029    2       CASE(#MEMBER2,#OWNER2,#ALL2);

     1210     4030    2           WALK_OPT=OUT$BLK.CODE;

   4030  2 000145   100000 236100                    LDQ     0,,PR1
         2 000146   777777 376007                    ANQ     -1,DL
         2 000147   000033 736000                    QLS     27
         2 000150   000000 756000 xsym               STQ     WALK_OPT

     1211     4031    2           PRINT_OPT=OUT$BLK.CODE;

   4031  2 000151   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:242  
         2 000152   100000 236100                    LDQ     0,,PR1
         2 000153   777777 376007                    ANQ     -1,DL
         2 000154   000033 736000                    QLS     27
         2 000155   000000 756000 xsym               STQ     PRINT_OPT

     1212     4032    2           IF OUT$BLK.CODE=#OWNER2 THEN N_OR_P=#OWNER2;

   4032  2 000156   000000 471500                    LDP1    0,,PR0
         2 000157   100000 720100                    LXL0    0,,PR1
         2 000160   000020 100003                    CMPX0   16,DU
         2 000161   000174 601000 2                  TNZ     s:4039

   4032  2 000162   000020 235007                    LDA     16,DL
         2 000163   000000 755000 xsym               STA     N_OR_P
         2 000164   000174 710000 2                  TRA     s:4039

     1213     4033    2       CASE(#SETS2);

     1214     4034    2           PRINT_OPT=OUT$BLK.CODE;

   4034  2 000165   100000 236100                    LDQ     0,,PR1
         2 000166   777777 376007                    ANQ     -1,DL
         2 000167   000033 736000                    QLS     27
         2 000170   000000 756000 xsym               STQ     PRINT_OPT
         2 000171   000174 710000 2                  TRA     s:4039

     1215     4035    2       CASE(#DASH2);

     1216     4036    2           DASH_ON = 1;

   4036  2 000172   001000 236003                    LDQ     512,DU
         2 000173   000000 756000 xsym               STQ     DASH_ON

     1217     4037    2           END;

     1218     4038
     1219     4039    2       DO CASE(OUT$BLK.NDTYPE);
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:243  

   4039  2 000174   000000 471500                    LDP1    0,,PR0
         2 000175   100000 236100                    LDQ     0,,PR1
         2 000176   000022 772000                    QRL     18
         2 000177   000077 376007                    ANQ     63,DL
         2 000200   000005 136007                    SBLQ    5,DL
         2 000201   000023 116007                    CMPQ    19,DL
         2 000202   000204 602006 2                  TNC     s:4039+8,QL
         2 000203   000255 710000 2                  TRA     s:4048
         2 000204   000277 710000 2                  TRA     s:4052
         2 000205   000255 710000 2                  TRA     s:4048
         2 000206   000255 710000 2                  TRA     s:4048
         2 000207   000255 710000 2                  TRA     s:4048
         2 000210   000255 710000 2                  TRA     s:4048
         2 000211   000255 710000 2                  TRA     s:4048
         2 000212   000255 710000 2                  TRA     s:4048
         2 000213   000255 710000 2                  TRA     s:4048
         2 000214   000255 710000 2                  TRA     s:4048
         2 000215   000255 710000 2                  TRA     s:4048
         2 000216   000255 710000 2                  TRA     s:4048
         2 000217   000277 710000 2                  TRA     s:4052
         2 000220   000227 710000 2                  TRA     s:4042
         2 000221   000277 710000 2                  TRA     s:4052
         2 000222   000277 710000 2                  TRA     s:4052
         2 000223   000277 710000 2                  TRA     s:4052
         2 000224   000277 710000 2                  TRA     s:4052
         2 000225   000277 710000 2                  TRA     s:4052
         2 000226   000277 710000 2                  TRA     s:4052

     1220     4040
     1221     4041    2       CASE(%OCT#);

     1222     4042    3           DO INDX=0 TO OUT$SYM.COUNT-1;

   4042  2 000227   200004 450100                    STZ     INDX,,AUTO
         2 000230   000247 710000 2                  TRA     s:4045+1

PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:244  
     1223     4043    3               CALL INDEX1(JJJ,SUBSTR(OUT$SYM.TEXT,INDX,1),'01234567');

   4043  2 000231   200003 470500                    LDP0    @NODE$,,AUTO
         2 000232   000000 471500                    LDP1    0,,PR0
         2 000233   100004 236100                    LDQ     4,,PR1
         2 000234   000033 772000                    QRL     27
         2 000235   200004 235100                    LDA     INDX,,AUTO
         2 000236   000105 124400                    SCM     mask='000'O
         2 000237   000000 000010 1                  ADSC9   0                        cn=0,n=8
         2 000240   100004 200001                    ADSC9   4,A,PR1                  cn=1,n=1
         2 000241   000000 000000 xsym               ARG     JJJ

     1224     4044    3               KEY_RNG.FIR(0)=KEY_RNG.FIR(0)*8+JJJ;

   4044  2 000242   000000 236000 xsym               LDQ     KEY_RNG
         2 000243   000003 736000                    QLS     3
         2 000244   000000 036000 xsym               ADLQ    JJJ
         2 000245   000000 756000 xsym               STQ     KEY_RNG

     1225     4045    3               END;

   4045  2 000246   200004 054100                    AOS     INDX,,AUTO
         2 000247   000000 471500                    LDP1    0,,PR0
         2 000250   100004 236100                    LDQ     4,,PR1
         2 000251   000033 772000                    QRL     27
         2 000252   200004 116100                    CMPQ    INDX,,AUTO
         2 000253   000231 605400 2                  TPNZ    s:4043
         2 000254   000277 710000 2                  TRA     s:4052

     1226     4046    2       CASE(%DSTRING#,%NULL#,%DEC#,%ALPHA#,%ALNUM#,%SYM#,%ASYM#,%FID#);

     1227     4047    2       CASE(ELSE);

     1228     4048    3           DO INDX=0 TO OUT$BLK.NSUBLKS - 1;

   4048  2 000255   200004 450100                    STZ     INDX,,AUTO
         2 000256   000271 710000 2                  TRA     s:4050+1
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:245  

     1229     4049    3               CALL CHK_NODE(OUT$BLK.SUBLK$(INDX));

   4049  2 000257   200003 470500                    LDP0    @NODE$,,AUTO
         2 000260   000000 471500                    LDP1    0,,PR0
         2 000261   200004 720100                    LXL0    INDX,,AUTO
         2 000262   100003 633510                    EPPR3   3,X0,PR1
         2 000263   200006 453500                    STP3    INDX+2,,AUTO
         2 000264   200006 630500                    EPPR0   INDX+2,,AUTO
         2 000265   000001 631400 3                  EPPR1   1
         2 000266   000000 701000 2                  TSX1    s:9
         2 000267   000000 011000                    NOP     0

     1230     4050    3               END;

   4050  2 000270   200004 054100                    AOS     INDX,,AUTO
         2 000271   200003 470500                    LDP0    @NODE$,,AUTO
         2 000272   000000 471500                    LDP1    0,,PR0
         2 000273   100001 236100                    LDQ     1,,PR1
         2 000274   000022 772000                    QRL     18
         2 000275   200004 116100                    CMPQ    INDX,,AUTO
         2 000276   000257 605400 2                  TPNZ    s:4049

     1231     4051    2           END;

     1232     4052    1   END CHK_NODE;

   4052  2 000277   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   060061 062063   064065 066067                                    01234567

(unnamed)
 Sect OctLoc
   3     000   777777 777770   000001 000000                                    ........
     1233     4053
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:246  
     1234     4054
     1235     4055
     1236     4056
     1237     4057
     1238     4058
     1239     4059
     1240     4060
     1241     4061
     1242     4062
     1243     4063

PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:247  
--  Include file information  --

   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   XU_SUBS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure CHK_NODE.

   Procedure CHK_NODE requires 192 words for executable code.
   Procedure CHK_NODE requires 8 words of local(AUTO) storage.

    No errors detected in file ZIU$Q2RP.:ZIC0TSI    .
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:248  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:249  
          MINI XREF LISTING

CHK_NODE
         9**PROC     4049--CALL
DASH_ON
      3999**DCL      4036<<ASSIGN
ICHKSUM
      3738**DCL      3739--REDEF
INDX
        11**DCL      4042<<DOINDEX  4043>>CALLBLT  4048<<DOINDEX  4049>>CALL
ITEM_LIST.NAME
      3507**DCL      4023<<ASSIGN
I_O_BUF$
      3716**DCL      3717--IMP-PTR
JJJ
        13**DCL      4007<<DOINDEX  4008>>CALLBLT  4008>>CALLBLT  4009>>IF       4015>>IF       4043<<CALLBLT
      4044>>ASSIGN
KEY_RNG.FIR
      3504**DCL      4011<<ASSIGN   4044<<ASSIGN   4044>>ASSIGN
KEY_RNG.SEC
      3505**DCL      4012<<ASSIGN
KKK
        14**DCL      4008<<CALLBLT  4011>>ASSIGN   4012>>ASSIGN   4016>>ASSIGN   4018>>ASSIGN
K_CNT
      3998**DCL      4004<<ASSIGN   4004>>ASSIGN   4005>>ASSIGN   4006>>ASSIGN   4011>>ASSIGN   4012>>ASSIGN
      4016>>ASSIGN   4018>>ASSIGN
NODE$
        12**DCL         9--PROC     3132--IMP-PTR  3178--IMP-PTR  4001>>DOCASE   4007>>DOINDEX  4008>>CALLBLT
      4008>>CALLBLT  4023>>ASSIGN   4023>>ASSIGN   4026>>ASSIGN   4026>>ASSIGN   4028>>ASSIGN   4030>>ASSIGN
      4031>>ASSIGN   4032>>IF       4034>>ASSIGN   4039>>DOCASE   4042>>DOINDEX  4043>>CALLBLT  4043>>CALLBLT
      4048>>DOINDEX  4049>>CALL
N_OR_P
      3995**DCL      4028<<ASSIGN   4032<<ASSIGN
OUT$BLK.CODE
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:250  
      3140**DCL      4001>>DOCASE   4028>>ASSIGN   4030>>ASSIGN   4031>>ASSIGN   4032>>IF       4034>>ASSIGN
OUT$BLK.NDTYPE
      3135**DCL      4039>>DOCASE
OUT$BLK.NSUBLKS
      3144**DCL      4007>>DOINDEX  4048>>DOINDEX
OUT$BLK.SUBLK$
      3165**DCL      4008>>CALLBLT  4008>>CALLBLT  4049<>CALL
OUT$SYM.COUNT
      3201**DCL      3204--IMP-SIZ  4008>>CALLBLT  4023>>ASSIGN   4026>>ASSIGN   4042>>DOINDEX  4043>>CALLBLT
OUT$SYM.TEXT
      3204**DCL      4008>>CALLBLT  4023>>ASSIGN   4026>>ASSIGN   4043>>CALLBLT
PA_DBK.FIR
        16**DCL      4005<<ASSIGN   4016<<ASSIGN
PA_DBK.SEC
        17**DCL      4006<<ASSIGN   4018<<ASSIGN
PRINT_OPT
      3993**DCL      4031<<ASSIGN   4034<<ASSIGN
REC$
      3697**DCL      3720--IMP-PTR
RECORD_LIST.NAME
      3486**DCL      4026<<ASSIGN
REC_DATA_LN
      3725**DCL      3724--IMP-SIZ
R_CNT
      3996**DCL      4025<<ASSIGN   4025>>ASSIGN   4026>>ASSIGN
S_CNT
      3997**DCL      4022<<ASSIGN   4022>>ASSIGN   4023>>ASSIGN
WALK_OPT
      3994**DCL      4030<<ASSIGN
ZI$DIR.ALTKEY
      3439**DCL      3440--REDEF    3441--REDEF
ZI$DIR.AREAFID
      3405**DCL      3406--REDEF
ZI$DIR.DATE
      3444**DCL      3448--REDEF
ZI$DIR.DEST_SEED
PL6.E3A0      #002=CHK_NODE File=ZIU$Q2RP.:ZIC0TSI                               FRI 09/05/97 13:25 Page:251  
      3400**DCL      3401--REDEF    3402--REDEF
ZI$DIR.ENCP_SEED
      3397**DCL      3398--REDEF    3399--REDEF
ZI$DIR.REPRT_ZERO
      3431**DCL      3432--REDEF
ZI$DIR.SCHFID
      3403**DCL      3404--REDEF
ZI$DIR.TIME
      3449**DCL      3454--REDEF
