
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:1    
        1        1        /*M* ZIG$DDS6         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        PURJ:
        8        8            PROC;
        9        9    1   DCL LK3 SBIN(17);
       10       10    1   DCL BIT36_RDEF(0:35) BIT(1);
       11       11    1   DCL BIT36 BIT(36) BASED;
       12       12    1   DCL PP PTR;
       13       13    1   DCL MSK_18B(0:5) BIT(18) BASED;
       14       14    1   DCL X SBIN STATIC INIT(0);
       15       15    1   DCL ERASE_COUNT UBIN WORD STATIC INIT(0);
       16       16    1   DCL FIVESTAREOF UBIN(36) STATIC;
       17       17    1   DCL 1 W25 BASED(W25$),
       18       18    1         2 * CHAR(100);
       19       19    1   DCL W25$ PTR;
       20       20    1   DCL READ64 ENTRY(2);
       21       21    1   DCL BLKPTR PTR;
       22       22    1   DCL Y UBIN WORD STATIC INIT(25);
       23       23        %INCLUDE ZIG_FIVESTAR_DESC;
       24       66        %INCLUDE ZIG_DBA_INT;
       25      114        %INCLUDE ZI_SUB4_CAN;
       26      771        %UWA;
       27     1106        %INCLUDE ZIG_DIR_STRUCS;
       28     1236        %INCLUDE ZIG_GENERAL;
       29     1344        %INCLUDE ZI_SUB_LANG;
       30     3059        %CONTROL_BLOCK;
       31     3167        %INCLUDE CP_6;
       32     3248        %INCLUDE CP_6_SUBS;
       33     3788        %FPT_DELREC( KEY=DEL_REC# );
       34     3807    1   DCL ERR BIT(1);
       35     3808    1   DCL OL CHAR(128);
       36     3809    1   DCL UNSC ENTRY(2);
       37     3810    1   DCL LKV CHAR(12);
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:2    
       38     3811    1   DCL C64 CHAR(64);
       39     3812    1   DCL C5 CHAR(5);
       40     3813    1   DCL 1 FIELD1 EXT,
       41     3814    1         2 COUNT1 UBIN(9) UNAL,
       42     3815    1         2 TEXT1 CHAR(31) UNAL;
       43     3816    1   DCL WRIT64 ENTRY (2);
       44     3817    1   DCL CLOSE_64 ENTRY;
       45     3818    1   DCL COPY_64 ENTRY;
       46     3819    1   DCL ANS_TIME ENTRY (2);
       47     3820    1   DCL UTS BIT(36) STATIC;
       48     3821    1   DCL READSF ENTRY (2);
       49     3822    1   DCL WRITSF ENTRY (2);
       50     3823    1   DCL 1 SUBDCB ALIGNED SYMREF,
       51     3824    1         2 SUBNM UNAL,
       52     3825    1           3 CNT UBIN(9) UNAL,
       53     3826    1           3 TEXT CHAR(31) UNAL,
       54     3827    1         2 DCB# UBIN(18) ALIGNED;
       55     3828    1   DCL 1 CU STATIC,
       56     3829    1         2 NEXT SBIN WORD,
       57     3830    1         2 FILL1(0:18) SBIN WORD,
       58     3831    1         2 GTIME,
       59     3832    1           3 DATE BIT(36),
       60     3833    1           3 TIME BIT(36),
       61     3834    1         2 FILL2 CHAR (40);
       62     3835    1   DCL FIRST_CROSS_OVER BIT(1);
       63     3836    1   DCL FIRST_CU BIT (1);
       64     3837    1   DCL FIRST_SAVE BIT(1);
       65     3838    1   DCL CU_RECORD UBIN WORD;
       66     3839    1   DCL NEXT_AVAIL_CU UBIN WORD;
       67     3840    1   DCL 1 DEL_REC# STATIC,
       68     3841    1         2 CNT UBIN(9) UNAL,
       69     3842    1         2 KEY UBIN(27) UNAL;
       70     3843    1   DCL 1 SAVE_CU STATIC,
       71     3844    1         2 NEXT SBIN WORD,
       72     3845    1         2 FILL1(0:18) SBIN WORD,
       73     3846    1         2 GTIME,
       74     3847    1           3 DATE BIT(36),
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:3    
       75     3848    1           3 TIME BIT(36),
       76     3849    1         2 FILL2 CHAR (40);
       77     3850    1   DCL 1 TEMP_CU STATIC,
       78     3851    1         2 NEXT SBIN WORD,
       79     3852    1         2 FILL1(0:18) SBIN WORD,
       80     3853    1         2 GTIME,
       81     3854    1           3 DATE BIT(36),
       82     3855    1           3 TIME BIT(36),
       83     3856    1         2 FILL2 CHAR(40);
       84     3857    1   DCL CHAR_128 CHAR (128) BASED;
       85     3858        /******************************************************************/
       86     3859        /*  Temp variables for DATE strings used for Year 2000 changes    */
       87     3860        /******************************************************************/
       88     3861    1   DCL DT1_R CHAR (7) AUTO UNAL;
       89     3862    1   DCL 1 DT1 REDEF DT1_R, /* TEMP STORAGE FOR CURRENT DATE YYMMDD */
       90     3863    1         2 CEN CHAR (1), /* CENTURY INDICATOR */
       91     3864    1         2 DT_R CHAR(6), /* YYMMDD DATE */
       92     3865    1         2 DT REDEF DT_R, /* YYMMDD DATE */
       93     3866    1           3 YR CHAR (2), /* YEAR */
       94     3867    1           3 * CHAR (4); /* MMDD */
       95     3868    1   DCL DT2_R CHAR (7) AUTO UNAL;
       96     3869    1   DCL 1 DT2 REDEF DT2_R, /* TEMP STORE FOR RETENTION DATE YYMMDD */
       97     3870    1         2 CEN CHAR (1), /* CENTURY INDICATOR */
       98     3871    1         2 DT_R CHAR(6), /* YYMMDD DATE */
       99     3872    1         2 DT REDEF DT_R, /* YYMMDD DATE */
      100     3873    1           3 YR CHAR (2), /* YEAR */
      101     3874    1           3 * CHAR (4); /* MMDD */
      102     3875        /******************************************************************/
      103     3876    1       C64 = 'PURGE PROCESSOR';
      104     3877    1       CALL SUBLST(C64);
      105     3878         /* Ready data base */
      106     3879         /* Get sf */
      107     3880    1       CALL FETCHD_6('SF      ',2) ALTRET(DBCSERR);
      108     3881         /* Get da */
      109     3882    1       CALL FETCHD_6('DA      ', UWA.SF.DBKEY_DA) ALTRET(DBCSERR);
      110     3883         /* Get sn element */
      111     3884    1       UWA.SN.SETYPE = 0;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:4    
      112     3885    2       DO WHILE(UWA.SN.SETYPE ~= 10);
      113     3886    2           CALL FETCHNS_6('DA-SN   ') ALTRET(DBCSERR);
      114     3887    2           END;
      115     3888    1       IF PURGE.SNAME ~= ' ' THEN /* */
      116     3889    2           IF UWA.SN.SENAME ~= PURGE.SNAME THEN DO;
      117     3890    2               CALL CONCAT(OL,PURGE.SNAME,' IS NOT NAME OF ASSIGNED SCHEMA FILE');
      118     3891    2               CALL LIST(OL);
      119     3892    2               RETURN;
      120     3893    2               END;
      121     3894
      122     3895         /*Check priv key for alter*/
      123     3896         /* Mark lock on alter not found */
      124     3897    1       LK3 = 0;
      125     3898    2       DO WHILE(PURGE.ALTER_KEY ~= LKV);
      126     3899    2           CALL FETCHNS_6('SN-LT   ') ALTRET(L30);
      127     3900    2           BIT36_RDEF = ADDR(UWA.LT.PLOCKS) -> BIT36;
      128     3901    2           IF BIT36_RDEF(3) = '1'B
      129     3902    3           THEN DO;
      130     3903         /* There is a lock for alter */
      131     3904    3               LK3 = 1;
      132     3905         /* Get lk element */
      133     3906    3               CALL FETCHOS_6('LK-LT  ') ALTRET(DBCSERR);
      134     3907    3               IF UWA.LK.PLVALUE = '"NULL"' THEN /* */
      135     3908    3                   GOTO A1;
      136     3909    3               ELSE CALL UNSC(UWA.LK.PLVALUE,LKV);
      137     3910    3               END;
      138     3911    2           END;
      139     3912    1   A1:
      140     3913    1       IF PURGE.TYPE.DDL THEN /* */
      141     3914    2       DO;
      142     3915         /* Get sa */
      143     3916    2           CALL FETCHD_6('SA      ',UWA.SF.DBKEY_SA) ALTRET(DBCSERR);
      144     3917         /*Get 1ST ddl*/
      145     3918    2           CALL FINDNS_6('SA-DD   ') ALTRET(L11);
      146     3919    3           DO WHILE(UWA.DB_STATUS ~= '0502100');
      147     3920    3               CALL ERASE_6('DD      ') ALTRET(L13);
      148     3921    3               CALL FINDNS_6('SA-DD   ') ALTRET(L13);
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:5    
      149     3922    3               END;
      150     3923    2   L11:
      151     3924    2           IF UWA.DB_STATUS = '0502100' THEN /* */
      152     3925    3           DO;
      153     3926    3               OL = 'NO DDL ON SCHEMA FILE TO PURGE';
      154     3927    3               CALL LIST(OL);
      155     3928    3               GOTO CKDMCL;
      156     3929    3               END;
      157     3930    2           ELSE /* */
      158     3931    2   L13:
      159     3932    2               IF UWA.DB_STATUS ~= '0502100' THEN /* */
      160     3933    3               DO;
      161     3934    3                   OL = 'IDS2 ERROR, - DDL NOT PURGED IN ENTIRETY';
      162     3935    3                   CALL LIST(OL);
      163     3936    3                   GOTO WR_DBCSERR;
      164     3937    3                   END;
      165     3938    2               ELSE /* */
      166     3939    3               DO;
      167     3940    3                   OL = 'SCHEMA FILE DDL PURGED';
      168     3941    3                   CALL LIST(OL);
      169     3942    3                   CALL FCURR_R_6('SA      ') ALTRET(L13);
      170     3943    3                   UWA.SA.NUMB_DD = 0;
      171     3944    3                   CALL MODIFY_6('SA      ') ALTRET(L13);
      172     3945    3                   END;
      173     3946    2           END;
      174     3947    1   CKDMCL:
      175     3948    1       IF PURGE.TYPE.DMCL THEN /* */
      176     3949    2       DO;
      177     3950         /* Get sa*/
      178     3951    2           CALL FETCHD_6('SA      ',UWA.SF.DBKEY_SA) ALTRET(DBCSERR);
      179     3952         /* Get 1ST dmcl*/
      180     3953    2           CALL FINDNS_6('SA-DM   ') ALTRET(L14);
      181     3954    3           DO WHILE(UWA.DB_STATUS ~= '0502100');
      182     3955    3               CALL ERASE_6('DM      ') ALTRET(L15);
      183     3956    3               CALL FINDNS_6('SA-DM   ') ALTRET(L15);
      184     3957    3               END;
      185     3958    2   L14:
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:6    
      186     3959    2           IF UWA.DB_STATUS ='0502100' THEN /* */
      187     3960    3           DO;
      188     3961    3               OL = 'NO DMCL ON SCHEMA FILE TO PURGE';
      189     3962    3               CALL LIST(OL);
      190     3963    3               GOTO CKACTS;
      191     3964    3               END;
      192     3965    2           ELSE /* */
      193     3966    2   L15:
      194     3967    2               IF UWA.DB_STATUS ~= '0502100' THEN /* */
      195     3968    3               DO;
      196     3969    3                   OL = 'IDS2 ERROR, - DMCL NOT PURGED IN ENTIRETY';
      197     3970    3                   CALL LIST(OL);
      198     3971    3                   GOTO WR_DBCSERR;
      199     3972    3                   END;
      200     3973    2               ELSE /* */
      201     3974    3               DO;
      202     3975    3                   OL = 'SCHEMA FILE DMCL PURGED';
      203     3976    3                   CALL LIST(OL);
      204     3977    3                   CALL FCURR_R_6('SA      ') ALTRET(L15);
      205     3978    3                   UWA.SA.NUMB_DM = 0;
      206     3979    3                   CALL MODIFY_6('SA      ') ALTRET(L15);
      207     3980    3                   END;
      208     3981    2           END;
      209     3982    1   CKACTS:
      210     3983    1       IF PURGE.TYPE.SACTS THEN /* */
      211     3984    2       DO;
      212     3985    2           ERASE_COUNT = 0;
      213     3986    2           CALL FETCHNS_6('SF-AD   ') ALTRET(L16);
      214     3987    3           DO WHILE(UWA.DB_STATUS ~= '0502100');
      215     3988    3               IF UWA.A_D.AD_FUNCTION > 2 THEN /* */
      216     3989    4               DO; /* Year 2000 modifications */
      217     3990    4                   DT1.DT_R = UWA.A_D.AD_DATE; /* UWA Date */
      218     3991    4                   DT2.DT_R = PURGE.SACTS_RET_DATE; /* RET. Date */
      219     3992    4                   IF DT1.DT.YR >= '00' AND DT1.DT.YR < '21' THEN
      220     3993    4                       DT1.CEN = '0'; /* SET CENTURY TO '0' OR ' ' */
      221     3994    4                   ELSE DT1.CEN = ' ';/* DEPENDING IF 19xx OR 20xx */
      222     3995    4                   IF DT2.DT.YR >= '00' AND DT2.DT.YR < '21' THEN
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:7    
      223     3996    4                       DT2.CEN = '0'; /* SET CENTURY TO '0' OR ' ' */
      224     3997    4                   ELSE DT2.CEN = ' ';/* DEPENDING IF 19xx OR 20xx */
      225     3998    4                   END;
      226     3999    3               IF DT1_R < DT2_R THEN
      227     4000    4               DO;
      228     4001    4                   CALL ERASE_6('A-D     ') ALTRET(L17);
      229     4002    4                   ERASE_COUNT = ERASE_COUNT + 1;
      230     4003    4                   END;
      231     4004    3               CALL FETCHNS_6('SF-AD  ') ALTRET(L17);
      232     4005    3               END;
      233     4006    2   L16:
      234     4007    3           IF UWA.DB_STATUS = '0502100' THEN DO; /* */
      235     4008    3               OL = 'NO ACTIVITIES ON SCHEMA FILE TO PURGE';
      236     4009    3               CALL LIST(OL);
      237     4010    3               END;
      238     4011    2           ELSE /* */
      239     4012    2   L17:
      240     4013    2               IF UWA.DB_STATUS ~= '0502100' THEN /* */
      241     4014    3               DO;
      242     4015    3                   OL = 'IDS2 ERROR, - ACTIVITIES NOT PURGED IN ENTIRETY' ;
      243     4016    3                   CALL LIST(OL);
      244     4017    3                   GOTO WR_DBCSERR;
      245     4018    3                   END;
      246     4019    3               ELSE DO; /* */
      247     4020    3                   CALL SET_FIELD_NUM(1,ERASE_COUNT);
      248     4021    3                   C5 = ' ';
      249     4022    3                   CALL INSERT(C5,5-FIELD1.COUNT1,FIELD1.COUNT1,SUBSTR(FIELD1.TEXT1,0,
              4022                            FIELD1.COUNT1));
      250     4023    3                   CALL CONCAT(OL,C5,' ACTIVITIES PRIOR TO ',
      251     4024    3                      PURGE.SACTS_RET_DATE, ' PURGED FROM SCHEMA FILE');
      252     4025    3                   CALL LIST(OL);
      253     4026    3                   END;
      254     4027    2           END;
      255     4028    1       IF PURGE.TYPE.SDICT THEN /* */
      256     4029    2       DO;
      257     4030    2           ERASE_COUNT = 0;
      258     4031    2           IF PURGE.SDICT_SSNAMES.ALL THEN /* */
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:8    
      259     4032    3           DO;
      260     4033    3               CALL FINDNS_6('SF-AS   ') ALTRET(L18);
      261     4034    4               DO WHILE(UWA.DB_STATUS ~= '0502100');
      262     4035    4                   CALL ERASE_6('AS      ') ALTRET(L19);
      263     4036    4                   ERASE_COUNT = ERASE_COUNT + 1;
      264     4037    4                   CALL FINDNS_6('SF-AS   ') ALTRET(L19);
      265     4038    4                   END;
      266     4039    3   L18:
      267     4040    4               IF UWA.DB_STATUS = '0502100' THEN DO; /* */
      268     4041    4                   OL = 'NO VALIDATED SUBSCHEMA RECORDED ON SCHEMA FILE';
      269     4042    4                   CALL LIST(OL);
      270     4043    4                   END;
      271     4044    3               ELSE /* */
      272     4045    3   L19:
      273     4046    3                   IF UWA.DB_STATUS ~= '0502100' THEN /* */
      274     4047    4                   DO;
      275     4048    4                       OL = 'IDS2 ERROR, - VALIDATED SUBSCHEMAS NOT PURGED IN ENTIRETY'
              4048                                ;
      276     4049    4                       CALL LIST(OL);
      277     4050    4                       GOTO WR_DBCSERR;
      278     4051    4                       END;
      279     4052    4                   ELSE DO; /* */
      280     4053    4                       CALL SET_FIELD_NUM(1,ERASE_COUNT);
      281     4054    4                       CALL CONCAT(OL,SUBSTR(FIELD1.TEXT1,0,5),
              4054                                ' VALIDATED SUBSCHEMAS PURGED FROM SCHEMA FILE');
      282     4055    4                       CALL LIST(OL);
      283     4056    4                       END;
      284     4057    3               END;
      285     4058    2           ELSE /* */
      286     4059    2               IF PURGE.SDICT_SSNAMES.SSNAMES THEN /* */
      287     4060    3               DO;
      288     4061    3                   CALL UOPEN('5*',0);
      289     4062    3   MORE:           CALL UGET('5*',W25$,FIVESTAREOF,Y);
      290     4063    3                   PURGE_DESC = W25;
      291     4064    4                   DO WHILE(FIVESTAREOF = 0);
      292     4065    4                       CALL INDEX1(X,'_',PURGE_DESC.SS_NAMES);
      293     4066    5                       DO WHILE(X ~= LENGTHC(PURGE_DESC.SS_NAMES));
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:9    
      294     4067    5                           CALL INSERT(PURGE_DESC.SS_NAMES,X,1,'-');
      295     4068    5                           CALL INDEX1(X,'_',PURGE_DESC.SS_NAMES);
      296     4069    5                           END;
      297     4070    4                       UWA.AS.SS_NAME = PURGE_DESC.SS_NAMES;
      298     4071    4                       CALL FETCHC_6('AS      ') ALTRET(L20);
      299     4072    4                       CALL ERASE_6('AS      ') ALTRET(L21);
      300     4073    4                       CALL CONCAT(OL,'RECORDING OF ',PURGE_DESC.SS_NAMES,
              4073                                ' PURGED FROM SCHEMA FILE DICTIONARY');
      301     4074    4                       CALL LIST(OL);
      302     4075    4                       CALL UGET('5*',W25$,FIVESTAREOF,Y);
      303     4076    4                       PURGE_DESC = W25;
      304     4077    4                       END;
      305     4078    3                   CALL UCLOSE('5*');
      306     4079    3                   GOTO RET;
      307     4080    3   L20:
      308     4081    3                   CALL CONCAT(OL,'RECORDING OF ',PURGE_DESC.SS_NAMES,
              4081                            ' NOT FOUND IN SCHEMA FILE');
      309     4082    3                   CALL LIST(OL);
      310     4083    3                   GOTO MORE;
      311     4084    3   L21:
      312     4085    3                   CALL CONCAT(OL,'IDS2 ERROR, - ',PURGE_DESC.SS_NAMES,
              4085                            ' NOT PURGED FROM SCHEMA FILE');
      313     4086    3                   CALL LIST(OL);
      314     4087    3                   GOTO WR_DBCSERR;
      315     4088    3                   END;
      316     4089    2           END;
      317     4090
      318     4091    1   RET: ;
      319     4092
      320     4093    1       ERR = '0'B;
      321     4094    1       GOTO WR_AD_RECORD;
      322     4095
      323     4096    2       DO WHILE '0'B;
      324     4097
      325     4098    2   WR_DBCSERR: ;
      326     4099
      327     4100    2           ERR = '1'B;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:10   
      328     4101    2           END;
      329     4102
      330     4103    1   WR_AD_RECORD: ;
      331     4104
      332     4105        /* Record purge function against schema */
      333     4106
      334     4107    1       UWA.A_D.AD_FUNCTION = 7;
      335     4108    1       UWA.A_D.AD_IDENT = ' ';
      336     4109    1       CALL GET_TIME( UWA.A_D.AD_DATE );
      337     4110    1       CALL STRE_6('A-D     ');
      338     4111
      339     4112    1       IF NOT ERR THEN
      340     4113    1           RETURN;
      341     4114
      342     4115    1   DBCSERR: CALL ABORT;
      343     4116    1   L30:
      344     4117    1       IF UWA.DB_STATUS ~= '0502100' THEN GOTO DBCSERR;
      345     4118    1       IF LK3 = 0 THEN GOTO A1;
      346     4119    1       CALL CONCAT(OL,'ILLEGAL PRIVACY KEY FOR ALTER - ',PURGE.ALTER_KEY);
      347     4120    1       CALL LIST(OL);
      348     4121    1       RETURN;
      349     4122    1   ZIG$PURGE_SUB:
      350     4123    1       ENTRY;
      351     4124    1       BLKPTR = ADDR(CONTROL);
      352     4125    1       CALL READ64(0, BLKPTR);
      353     4126    1       IF CONTROL.TYPE30 ~= 30 OR CONTROL.TYPE100 ~= 100
      354     4127    2       THEN DO;
      355     4128    2           CALL CONCAT(OL,CONTROL.SUBSCHEMA_NAME , 'NOT RECOGNIZED AS SUBSCHEMA FILE.')
              4128                    ;
      356     4129    2           CALL LIST(OL);
      357     4130    2           RETURN;
      358     4131    2           END;
      359     4132        /*
      360     4133              Read the control block of the subschema.
      361     4134        */
      362     4135    1       FPT_DELREC.V.DCB# = SUBDCB.DCB#;
      363     4136    1       DEL_REC#.CNT = 3;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:11   
      364     4137    1       IF PURGE.SACTS_RET_DATE = '      '
      365     4138    2       THEN DO;
      366     4139    2           UTS = '0'B;
      367     4140    2           GOTO DELETE_ALL_CU;
      368     4141    2           END;
      369     4142    2       ELSE DO;
      370     4143    2           CALL ANS_TIME(PURGE.SACTS_RET_DATE,BITBIN(UTS));
      371     4144    2           CU_RECORD = CONTROL.FIRST_CU_RECORD;
      372     4145    2           FIRST_SAVE = '1'B;
      373     4146    2           FIRST_CU = '1'B;
      374     4147    3           DO WHILE CU_RECORD ~= 0;
      375     4148    3               CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );
      376     4149    3               IF FIRST_SAVE
      377     4150    4               THEN DO;
      378     4151    4                   FIRST_SAVE = '0'B;
      379     4152    4                   SAVE_CU = CU;
      380     4153    4                   NEXT_AVAIL_CU = CU_RECORD;
      381     4154    4                   END;
      382     4155    3               IF UTS < CU.GTIME.TIME
      383     4156    4               THEN DO;
      384     4157    4                   FIRST_CU = '0'B;
      385     4158    4                   TEMP_CU = CU;
      386     4159    4                   IF TEMP_CU.NEXT ~= 0 THEN
      387     4160    4                       TEMP_CU.NEXT = SAVE_CU.NEXT;
      388     4161    4                   CALL WRITSF( NEXT_AVAIL_CU, ADDR(TEMP_CU)->CHAR_128 );
      389     4162    4                   NEXT_AVAIL_CU = SAVE_CU.NEXT;
      390     4163    4                   IF NEXT_AVAIL_CU ~= 0 THEN
      391     4164    4                       CALL READSF( NEXT_AVAIL_CU, ADDR(SAVE_CU)->CHAR_128 );
      392     4165    4                   END;
      393     4166    3               CU_RECORD = CU.NEXT;
      394     4167    3               END;
      395     4168    2           IF FIRST_CU THEN
      396     4169    2               GOTO DELETE_ALL_CU;
      397     4170    2           END;
      398     4171    1       IF NEXT_AVAIL_CU ~=0
      399     4172    2       THEN DO;
      400     4173    2           FIRST_CROSS_OVER = '1'B;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:12   
      401     4174    2           IF NEXT_AVAIL_CU > CONTROL.FIRST_NFE_RECORD
      402     4175    3           THEN DO;
      403     4176    3               FIRST_CROSS_OVER = '0'B;
      404     4177    3               CONTROL.NEXT_AVAILABLE_RECORD = NEXT_AVAIL_CU;
      405     4178    3               END;
      406     4179    2           CU_RECORD = NEXT_AVAIL_CU;
      407     4180    2           GOTO DELETE;
      408     4181    2           END;
      409     4182    1       CALL WRIT64( 0, BLKPTR );
      410     4183    1       CALL CLOSE_64;
      411     4184    1       RETURN;
      412     4185
      413     4186    1   DELETE_ALL_CU:
      414     4187    1       FIRST_CROSS_OVER = '1'B;
      415     4188    1       IF CONTROL.FIRST_NFE_RECORD < CONTROL.FIRST_CU_RECORD
      416     4189    2       THEN DO;
      417     4190    2           FIRST_CROSS_OVER = '0'B;
      418     4191    2           CONTROL.NEXT_AVAILABLE_RECORD = CONTROL.FIRST_CU_RECORD;
      419     4192    2           END;
      420     4193    1       CU_RECORD = CONTROL.FIRST_CU_RECORD;
      421     4194    1       CONTROL.FIRST_CU_RECORD = 0;
      422     4195
      423     4196    1   DELETE:
      424     4197    1       IF MOD( CU_RECORD, 2 ) ~= 0
      425     4198    2       THEN DO;
      426     4199    2           CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );
      427     4200    2           CU_RECORD = CU.NEXT;
      428     4201    2           IF ( CU_RECORD > CONTROL.FIRST_NFE_RECORD ) AND FIRST_CROSS_OVER
      429     4202    3           THEN DO;
      430     4203    3               FIRST_CROSS_OVER = '0'B;
      431     4204    3               CONTROL.NEXT_AVAILABLE_RECORD = CU_RECORD;
      432     4205    3               CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );
      433     4206    3               CU_RECORD = CU.NEXT;
      434     4207    3               END;
      435     4208    2           END;
      436     4209    2       DO WHILE CU_RECORD ~= 0;
      437     4210    2           DEL_REC#.KEY = CU_RECORD/2;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:13   
      438     4211    2           CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );
      439     4212    2           CU_RECORD = CU.NEXT;
      440     4213    2           IF ( CU_RECORD > CONTROL.FIRST_NFE_RECORD ) AND FIRST_CROSS_OVER
      441     4214    3           THEN DO;
      442     4215    3               FIRST_CROSS_OVER = '0'B;
      443     4216    3               CONTROL.NEXT_AVAILABLE_RECORD = CU_RECORD;
      444     4217    3               END;
      445     4218    2           IF CU_RECORD ~= 0
      446     4219    3           THEN DO;
      447     4220    3               CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );
      448     4221    3               CU_RECORD = CU.NEXT;
      449     4222    3               IF ( CU_RECORD > CONTROL.FIRST_NFE_RECORD ) AND FIRST_CROSS_OVER
      450     4223    4               THEN DO;
      451     4224    4                   FIRST_CROSS_OVER = '0'B;
      452     4225    4                   CONTROL.NEXT_AVAILABLE_RECORD = CU_RECORD;
      453     4226    4                   CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );
      454     4227    4                   CU_RECORD = CU.NEXT;
      455     4228    4                   END;
      456     4229    3               END;
      457     4230    2           CALL M$DELREC( FPT_DELREC );
      458     4231    2           END;
      459     4232    1       CALL WRIT64(0, BLKPTR);
      460     4233    1       CALL CLOSE_64;
      461     4234    1       CALL COPY_64;
      462     4235    1       RETURN;
      463     4236    1   END;

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:14   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_FIVESTAR_DESC.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PURJ.

   Procedure PURJ requires 838 words for executable code.
   Procedure PURJ requires 76 words of local(AUTO) storage.

    No errors detected in file ZIG$DDS6.:ZIC0TSI    .

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:15   

 Object Unit name= PURJ                                       File name= ZIG$DDS6.:ZIC0TOU
 UTS= SEP 05 '97 11:50:38.64 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   150    226  PURJ
    1  LblCom even  none    25     31  DESC
    2  LblCom even  none   656   1220  UWA
    3  LblCom even  none    12     14  ANALS
    4  LblCom even  none    13     15  PURGE
    5  LblCom even  none    19     23  DICTS
    6  LblCom even  none    23     27  DISPS
    7  LblCom even  none    22     26  VALIDS
    8  LblCom even  none    12     14  LOCKS
    9  LblCom even  none    10     12  STRAN
   10  LblCom even  none    12     14  DTRAN
   11  LblCom even  none    16     20  SSTRANS
   12  LblCom even  none    20     24  SSGEN
   13  LblCom even  none     1      1  NUM_ERROR_MSG
   14  LblCom even  none     1      1  NUM_WARN_MSG
   15  LblCom even  none     1      1  ALLOCATE_END
   16  LblCom even  none     2      2  SUBSCHEMA_KEY
   17  LblCom even  none     1      1  BUFFER$
   18  LblCom even  none     1      1  ERROR_IO
   19  LblCom even  none     1      1  BUFFER_LEN
   20  LblCom even  none     2      2  UWA_KEY
   21  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   22  LblCom even  none     2      2  RVA_KEY
   23  LblCom even  none     2      2  IA__KEY
   24  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   25  LblCom even  none    32     40  SEARCHR_NB
   26  LblCom even  none    32     40  SEM_COM
   27  LblCom even  none    32     40  DMCL_XLATE
   28  LblCom even  none    32     40  Q2_PERCENT
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:16   
   29  LblCom even  none    64    100  CONTROL
   30   DCB   even  none     0      0  M$UC
   31  LblCom even  none     8     10  FIELD1
   32  RoData even  UTS    216    330  PURJ
   33   Proc  even  none   838   1506  PURJ
   34  RoData even  none    40     50  PURJ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    33      0   yes            yes      Std        0  PURJ
    33   1126                  yes      Std        0  ZIG$PURGE_SUB

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 SUBLST
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHOS_6
         yes           Std       2 UOPEN
         yes           Std       4 UGET
 yes     yes           Std       1 FETCHNS_6
         yes           Std       1 LIST
         yes           Std       2 UNSC
 yes     yes           Std       1 ERASE_6
         yes           Std       2 SET_FIELD_NUM
         yes           Std       2 ANS_TIME
 yes     yes           Std       1 FETCHC_6
         yes           Std       0 CLOSE_64
         yes           Std       0 COPY_64
 yes     yes           Std       1 STRE_6
 yes     yes           Std       1 FINDNS_6
 yes     yes           Std       1 FCURR_R_6
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:17   
         yes           Std       2 READ64
         yes           Std       2 READSF
         yes           Std       1 UCLOSE
         yes           Std       2 WRITSF
         yes           Std       1 GET_TIME
         yes           Std       0 ABORT
 yes     yes           Std       1 MODIFY_6
         yes           Std       2 WRIT64
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  SUBDCB

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:18   


        1        1        /*M* ZIG$DDS6         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        PURJ:
        8        8            PROC;

      8 33 000000   000000 700200 xent  PURJ         TSX0  ! X66_AUTO_0
        33 000001   000114 000000                    ZERO    76,0

        9        9    1   DCL LK3 SBIN(17);
       10       10    1   DCL BIT36_RDEF(0:35) BIT(1);
       11       11    1   DCL BIT36 BIT(36) BASED;
       12       12    1   DCL PP PTR;
       13       13    1   DCL MSK_18B(0:5) BIT(18) BASED;
       14       14    1   DCL X SBIN STATIC INIT(0);
       15       15    1   DCL ERASE_COUNT UBIN WORD STATIC INIT(0);
       16       16    1   DCL FIVESTAREOF UBIN(36) STATIC;
       17       17    1   DCL 1 W25 BASED(W25$),
       18       18    1         2 * CHAR(100);
       19       19    1   DCL W25$ PTR;
       20       20    1   DCL READ64 ENTRY(2);
       21       21    1   DCL BLKPTR PTR;
       22       22    1   DCL Y UBIN WORD STATIC INIT(25);
       23       23        %INCLUDE ZIG_FIVESTAR_DESC;
       24       66        %INCLUDE ZIG_DBA_INT;
       25      114        %INCLUDE ZI_SUB4_CAN;
       26      771        %UWA;
       27     1106        %INCLUDE ZIG_DIR_STRUCS;
       28     1236        %INCLUDE ZIG_GENERAL;
       29     1344        %INCLUDE ZI_SUB_LANG;
       30     3059        %CONTROL_BLOCK;
       31     3167        %INCLUDE CP_6;
       32     3248        %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:19   
       33     3788        %FPT_DELREC( KEY=DEL_REC# );
       34     3807    1   DCL ERR BIT(1);
       35     3808    1   DCL OL CHAR(128);
       36     3809    1   DCL UNSC ENTRY(2);
       37     3810    1   DCL LKV CHAR(12);
       38     3811    1   DCL C64 CHAR(64);
       39     3812    1   DCL C5 CHAR(5);
       40     3813    1   DCL 1 FIELD1 EXT,
       41     3814    1         2 COUNT1 UBIN(9) UNAL,
       42     3815    1         2 TEXT1 CHAR(31) UNAL;
       43     3816    1   DCL WRIT64 ENTRY (2);
       44     3817    1   DCL CLOSE_64 ENTRY;
       45     3818    1   DCL COPY_64 ENTRY;
       46     3819    1   DCL ANS_TIME ENTRY (2);
       47     3820    1   DCL UTS BIT(36) STATIC;
       48     3821    1   DCL READSF ENTRY (2);
       49     3822    1   DCL WRITSF ENTRY (2);
       50     3823    1   DCL 1 SUBDCB ALIGNED SYMREF,
       51     3824    1         2 SUBNM UNAL,
       52     3825    1           3 CNT UBIN(9) UNAL,
       53     3826    1           3 TEXT CHAR(31) UNAL,
       54     3827    1         2 DCB# UBIN(18) ALIGNED;
       55     3828    1   DCL 1 CU STATIC,
       56     3829    1         2 NEXT SBIN WORD,
       57     3830    1         2 FILL1(0:18) SBIN WORD,
       58     3831    1         2 GTIME,
       59     3832    1           3 DATE BIT(36),
       60     3833    1           3 TIME BIT(36),
       61     3834    1         2 FILL2 CHAR (40);
       62     3835    1   DCL FIRST_CROSS_OVER BIT(1);
       63     3836    1   DCL FIRST_CU BIT (1);
       64     3837    1   DCL FIRST_SAVE BIT(1);
       65     3838    1   DCL CU_RECORD UBIN WORD;
       66     3839    1   DCL NEXT_AVAIL_CU UBIN WORD;
       67     3840    1   DCL 1 DEL_REC# STATIC,
       68     3841    1         2 CNT UBIN(9) UNAL,
       69     3842    1         2 KEY UBIN(27) UNAL;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:20   
       70     3843    1   DCL 1 SAVE_CU STATIC,
       71     3844    1         2 NEXT SBIN WORD,
       72     3845    1         2 FILL1(0:18) SBIN WORD,
       73     3846    1         2 GTIME,
       74     3847    1           3 DATE BIT(36),
       75     3848    1           3 TIME BIT(36),
       76     3849    1         2 FILL2 CHAR (40);
       77     3850    1   DCL 1 TEMP_CU STATIC,
       78     3851    1         2 NEXT SBIN WORD,
       79     3852    1         2 FILL1(0:18) SBIN WORD,
       80     3853    1         2 GTIME,
       81     3854    1           3 DATE BIT(36),
       82     3855    1           3 TIME BIT(36),
       83     3856    1         2 FILL2 CHAR(40);
       84     3857    1   DCL CHAR_128 CHAR (128) BASED;
       85     3858        /******************************************************************/
       86     3859        /*  Temp variables for DATE strings used for Year 2000 changes    */
       87     3860        /******************************************************************/
       88     3861    1   DCL DT1_R CHAR (7) AUTO UNAL;
       89     3862    1   DCL 1 DT1 REDEF DT1_R, /* TEMP STORAGE FOR CURRENT DATE YYMMDD */
       90     3863    1         2 CEN CHAR (1), /* CENTURY INDICATOR */
       91     3864    1         2 DT_R CHAR(6), /* YYMMDD DATE */
       92     3865    1         2 DT REDEF DT_R, /* YYMMDD DATE */
       93     3866    1           3 YR CHAR (2), /* YEAR */
       94     3867    1           3 * CHAR (4); /* MMDD */
       95     3868    1   DCL DT2_R CHAR (7) AUTO UNAL;
       96     3869    1   DCL 1 DT2 REDEF DT2_R, /* TEMP STORE FOR RETENTION DATE YYMMDD */
       97     3870    1         2 CEN CHAR (1), /* CENTURY INDICATOR */
       98     3871    1         2 DT_R CHAR(6), /* YYMMDD DATE */
       99     3872    1         2 DT REDEF DT_R, /* YYMMDD DATE */
      100     3873    1           3 YR CHAR (2), /* YEAR */
      101     3874    1           3 * CHAR (4); /* MMDD */
      102     3875        /******************************************************************/
      103     3876    1       C64 = 'PURGE PROCESSOR';

   3876 33 000002   040100 100400                    MLR     fill='040'O
        33 000003   000000 000017 32                 ADSC9   0                        cn=0,n=15
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:21   
        33 000004   200054 000100                    ADSC9   C64,,AUTO                cn=0,n=64

      104     3877    1       CALL SUBLST(C64);

   3877 33 000005   200054 630500                    EPPR0   C64,,AUTO
        33 000006   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000007   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000010   000000 631400 34                 EPPR1   0
        33 000011   000000 701000 xent               TSX1    SUBLST
        33 000012   000000 011000                    NOP     0

      105     3878         /* Ready data base */
      106     3879         /* Get sf */
      107     3880    1       CALL FETCHD_6('SF      ',2) ALTRET(DBCSERR);

   3880 33 000013   000003 630400 34                 EPPR0   3
        33 000014   000001 631400 34                 EPPR1   1
        33 000015   000000 701000 xent               TSX1    FETCHD_6
        33 000016   001077 702000 33                 TSX2    DBCSERR

      108     3881         /* Get da */
      109     3882    1       CALL FETCHD_6('DA      ', UWA.SF.DBKEY_DA) ALTRET(DBCSERR);

   3882 33 000017   000005 630400 34                 EPPR0   5
        33 000020   000001 631400 34                 EPPR1   1
        33 000021   000000 701000 xent               TSX1    FETCHD_6
        33 000022   001077 702000 33                 TSX2    DBCSERR

      110     3883         /* Get sn element */
      111     3884    1       UWA.SN.SETYPE = 0;

   3884 33 000023   000424 450000 2                  STZ     UWA+276

      112     3885    2       DO WHILE(UWA.SN.SETYPE ~= 10);

   3885 33 000024   000424 235000 2                  LDA     UWA+276
        33 000025   000012 115007                    CMPA    10,DL
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:22   
        33 000026   000036 600000 33                 TZE     s:3888

      113     3886    2           CALL FETCHNS_6('DA-SN   ') ALTRET(DBCSERR);

   3886 33 000027   000007 630400 34                 EPPR0   7
        33 000030   000000 631400 34                 EPPR1   0
        33 000031   000000 701000 xent               TSX1    FETCHNS_6
        33 000032   001077 702000 33                 TSX2    DBCSERR

      114     3887    2           END;

   3887 33 000033   000424 235000 2                  LDA     UWA+276
        33 000034   000012 115007                    CMPA    10,DL
        33 000035   000027 601000 33                 TNZ     s:3886

      115     3888    1       IF PURGE.SNAME ~= ' ' THEN /* */

   3888 33 000036   040000 106400                    CMPC    fill='040'O
        33 000037   000005 400036 4                  ADSC9   PURGE+5                  cn=2,n=30
        33 000040   000010 000001 34                 ADSC9   8                        cn=0,n=1
        33 000041   000063 600000 33                 TZE     s:3897

      116     3889    2           IF UWA.SN.SENAME ~= PURGE.SNAME THEN DO;

   3889 33 000042   040000 106400                    CMPC    fill='040'O
        33 000043   000427 000036 2                  ADSC9   UWA+279                  cn=0,n=30
        33 000044   000005 400036 4                  ADSC9   PURGE+5                  cn=2,n=30
        33 000045   000063 600000 33                 TZE     s:3897

      117     3890    2               CALL CONCAT(OL,PURGE.SNAME,' IS NOT NAME OF ASSIGNED SCHEMA FILE');

   3890 33 000046   040100 100400                    MLR     fill='040'O
        33 000047   000005 400036 4                  ADSC9   PURGE+5                  cn=2,n=30
        33 000050   200011 000036                    ADSC9   OL,,AUTO                 cn=0,n=30
        33 000051   040100 100400                    MLR     fill='040'O
        33 000052   000012 000044 32                 ADSC9   10                       cn=0,n=36
        33 000053   200020 400142                    ADSC9   OL+7,,AUTO               cn=2,n=98
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:23   

      118     3891    2               CALL LIST(OL);

   3891 33 000054   200011 630500                    EPPR0   OL,,AUTO
        33 000055   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000056   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000057   000000 631400 34                 EPPR1   0
        33 000060   000000 701000 xent               TSX1    LIST
        33 000061   000000 011000                    NOP     0

      119     3892    2               RETURN;

   3892 33 000062   000000 702200 xent               TSX2  ! X66_ARET

      120     3893    2               END;
      121     3894
      122     3895         /*Check priv key for alter*/
      123     3896         /* Mark lock on alter not found */
      124     3897    1       LK3 = 0;

   3897 33 000063   200003 450100                    STZ     LK3,,AUTO

      125     3898    2       DO WHILE(PURGE.ALTER_KEY ~= LKV);

   3898 33 000064   040100 106400                    CMPC    fill='040'O
        33 000065   000002 400014 4                  ADSC9   PURGE+2                  cn=2,n=12
        33 000066   200051 000014                    ADSC9   LKV,,AUTO                cn=0,n=12
        33 000067   000127 600000 33                 TZE     A1

      126     3899    2           CALL FETCHNS_6('SN-LT   ') ALTRET(L30);

   3899 33 000070   000011 630400 34                 EPPR0   9
        33 000071   000000 631400 34                 EPPR1   0
        33 000072   000000 701000 xent               TSX1    FETCHNS_6
        33 000073   001102 702000 33                 TSX2    L30

      127     3900    2           BIT36_RDEF = ADDR(UWA.LT.PLOCKS) -> BIT36;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:24   

   3900 33 000074   000473 236000 2                  LDQ     UWA+315
        33 000075   200004 756100                    STQ     BIT36_RDEF,,AUTO

      128     3901    2           IF BIT36_RDEF(3) = '1'B

   3901 33 000076   200004 236100                    LDQ     BIT36_RDEF,,AUTO
        33 000077   040000 316003                    CANQ    16384,DU
        33 000100   000123 600000 33                 TZE     s:3911

      129     3902    3           THEN DO;

      130     3903         /* There is a lock for alter */
      131     3904    3               LK3 = 1;

   3904 33 000101   000002 236003                    LDQ     2,DU
        33 000102   200003 756100                    STQ     LK3,,AUTO

      132     3905         /* Get lk element */
      133     3906    3               CALL FETCHOS_6('LK-LT  ') ALTRET(DBCSERR);

   3906 33 000103   000012 630400 34                 EPPR0   10
        33 000104   000000 631400 34                 EPPR1   0
        33 000105   000000 701000 xent               TSX1    FETCHOS_6
        33 000106   001077 702000 33                 TSX2    DBCSERR

      134     3907    3               IF UWA.LK.PLVALUE = '"NULL"' THEN /* */

   3907 33 000107   040000 106400                    CMPC    fill='040'O
        33 000110   000447 400014 2                  ADSC9   UWA+295                  cn=2,n=12
        33 000111   000027 000006 32                 ADSC9   23                       cn=0,n=6
        33 000112   000127 600000 33                 TZE     A1

      135     3908    3                   GOTO A1;
      136     3909    3               ELSE CALL UNSC(UWA.LK.PLVALUE,LKV);

   3909 33 000113   200051 630500                    EPPR0   LKV,,AUTO
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:25   
        33 000114   200111 450500                    STP0    DT2_R+4,,AUTO
        33 000115   000013 236000 34                 LDQ     11
        33 000116   200110 756100                    STQ     DT2_R+3,,AUTO
        33 000117   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000120   000001 631400 34                 EPPR1   1
        33 000121   000000 701000 xent               TSX1    UNSC
        33 000122   000000 011000                    NOP     0

      137     3910    3               END;

      138     3911    2           END;

   3911 33 000123   040100 106400                    CMPC    fill='040'O
        33 000124   000002 400014 4                  ADSC9   PURGE+2                  cn=2,n=12
        33 000125   200051 000014                    ADSC9   LKV,,AUTO                cn=0,n=12
        33 000126   000070 601000 33                 TNZ     s:3899

      139     3912    1   A1:
      140     3913    1       IF PURGE.TYPE.DDL THEN /* */

   3913 33 000127   000000 236000 4     A1           LDQ     PURGE
        33 000130   040000 316003                    CANQ    16384,DU
        33 000131   000240 600000 33                 TZE     CKDMCL

      141     3914    2       DO;

      142     3915         /* Get sa */
      143     3916    2           CALL FETCHD_6('SA      ',UWA.SF.DBKEY_SA) ALTRET(DBCSERR);

   3916 33 000132   000014 630400 34                 EPPR0   12
        33 000133   000001 631400 34                 EPPR1   1
        33 000134   000000 701000 xent               TSX1    FETCHD_6
        33 000135   001077 702000 33                 TSX2    DBCSERR

      144     3917         /*Get 1ST ddl*/
      145     3918    2           CALL FINDNS_6('SA-DD   ') ALTRET(L11);

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:26   
   3918 33 000136   000016 630400 34                 EPPR0   14
        33 000137   000000 631400 34                 EPPR1   0
        33 000140   000000 701000 xent               TSX1    FINDNS_6
        33 000141   000162 702000 33                 TSX2    L11

      146     3919    3           DO WHILE(UWA.DB_STATUS ~= '0502100');

   3919 33 000142   040000 106400                    CMPC    fill='040'O
        33 000143   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000144   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000145   000162 600000 33                 TZE     L11

      147     3920    3               CALL ERASE_6('DD      ') ALTRET(L13);

   3920 33 000146   000017 630400 34                 EPPR0   15
        33 000147   000000 631400 34                 EPPR1   0
        33 000150   000000 701000 xent               TSX1    ERASE_6
        33 000151   000200 702000 33                 TSX2    L13

      148     3921    3               CALL FINDNS_6('SA-DD   ') ALTRET(L13);

   3921 33 000152   000016 630400 34                 EPPR0   14
        33 000153   000000 631400 34                 EPPR1   0
        33 000154   000000 701000 xent               TSX1    FINDNS_6
        33 000155   000200 702000 33                 TSX2    L13

      149     3922    3               END;

   3922 33 000156   040000 106400                    CMPC    fill='040'O
        33 000157   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000160   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000161   000146 601000 33                 TNZ     s:3920

      150     3923    2   L11:
      151     3924    2           IF UWA.DB_STATUS = '0502100' THEN /* */

   3924 33 000162   040000 106400       L11          CMPC    fill='040'O
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:27   
        33 000163   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000164   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000165   000200 601000 33                 TNZ     L13

      152     3925    3           DO;

      153     3926    3               OL = 'NO DDL ON SCHEMA FILE TO PURGE';

   3926 33 000166   040100 100400                    MLR     fill='040'O
        33 000167   000041 000036 32                 ADSC9   33                       cn=0,n=30
        33 000170   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      154     3927    3               CALL LIST(OL);

   3927 33 000171   200011 630500                    EPPR0   OL,,AUTO
        33 000172   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000173   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000174   000000 631400 34                 EPPR1   0
        33 000175   000000 701000 xent               TSX1    LIST
        33 000176   000000 011000                    NOP     0

      155     3928    3               GOTO CKDMCL;

   3928 33 000177   000240 710000 33                 TRA     CKDMCL

      156     3929    3               END;
      157     3930    2           ELSE /* */
      158     3931    2   L13:
      159     3932    2               IF UWA.DB_STATUS ~= '0502100' THEN /* */

   3932 33 000200   040000 106400       L13          CMPC    fill='040'O
        33 000201   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000202   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000203   000216 600000 33                 TZE     s:3940

      160     3933    3               DO;

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:28   
      161     3934    3                   OL = 'IDS2 ERROR, - DDL NOT PURGED IN ENTIRETY';

   3934 33 000204   040100 100400                    MLR     fill='040'O
        33 000205   000051 000050 32                 ADSC9   41                       cn=0,n=40
        33 000206   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      162     3935    3                   CALL LIST(OL);

   3935 33 000207   200011 630500                    EPPR0   OL,,AUTO
        33 000210   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000211   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000212   000000 631400 34                 EPPR1   0
        33 000213   000000 701000 xent               TSX1    LIST
        33 000214   000000 011000                    NOP     0

      163     3936    3                   GOTO WR_DBCSERR;

   3936 33 000215   001055 710000 33                 TRA     WR_DBCSERR

      164     3937    3                   END;
      165     3938    2               ELSE /* */
      166     3939    3               DO;

      167     3940    3                   OL = 'SCHEMA FILE DDL PURGED';

   3940 33 000216   040100 100400                    MLR     fill='040'O
        33 000217   000063 000026 32                 ADSC9   51                       cn=0,n=22
        33 000220   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      168     3941    3                   CALL LIST(OL);

   3941 33 000221   200011 630500                    EPPR0   OL,,AUTO
        33 000222   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000223   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000224   000000 631400 34                 EPPR1   0
        33 000225   000000 701000 xent               TSX1    LIST
        33 000226   000000 011000                    NOP     0
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:29   

      169     3942    3                   CALL FCURR_R_6('SA      ') ALTRET(L13);

   3942 33 000227   000014 630400 34                 EPPR0   12
        33 000230   000000 631400 34                 EPPR1   0
        33 000231   000000 701000 xent               TSX1    FCURR_R_6
        33 000232   000200 702000 33                 TSX2    L13

      170     3943    3                   UWA.SA.NUMB_DD = 0;

   3943 33 000233   000522 450000 2                  STZ     UWA+338

      171     3944    3                   CALL MODIFY_6('SA      ') ALTRET(L13);

   3944 33 000234   000014 630400 34                 EPPR0   12
        33 000235   000000 631400 34                 EPPR1   0
        33 000236   000000 701000 xent               TSX1    MODIFY_6
        33 000237   000200 702000 33                 TSX2    L13

      172     3945    3                   END;

      173     3946    2           END;

      174     3947    1   CKDMCL:
      175     3948    1       IF PURGE.TYPE.DMCL THEN /* */

   3948 33 000240   000000 236000 4     CKDMCL       LDQ     PURGE
        33 000241   020000 316003                    CANQ    8192,DU
        33 000242   000351 600000 33                 TZE     CKACTS

      176     3949    2       DO;

      177     3950         /* Get sa*/
      178     3951    2           CALL FETCHD_6('SA      ',UWA.SF.DBKEY_SA) ALTRET(DBCSERR);

   3951 33 000243   000014 630400 34                 EPPR0   12
        33 000244   000001 631400 34                 EPPR1   1
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:30   
        33 000245   000000 701000 xent               TSX1    FETCHD_6
        33 000246   001077 702000 33                 TSX2    DBCSERR

      179     3952         /* Get 1ST dmcl*/
      180     3953    2           CALL FINDNS_6('SA-DM   ') ALTRET(L14);

   3953 33 000247   000020 630400 34                 EPPR0   16
        33 000250   000000 631400 34                 EPPR1   0
        33 000251   000000 701000 xent               TSX1    FINDNS_6
        33 000252   000273 702000 33                 TSX2    L14

      181     3954    3           DO WHILE(UWA.DB_STATUS ~= '0502100');

   3954 33 000253   040000 106400                    CMPC    fill='040'O
        33 000254   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000255   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000256   000273 600000 33                 TZE     L14

      182     3955    3               CALL ERASE_6('DM      ') ALTRET(L15);

   3955 33 000257   000021 630400 34                 EPPR0   17
        33 000260   000000 631400 34                 EPPR1   0
        33 000261   000000 701000 xent               TSX1    ERASE_6
        33 000262   000311 702000 33                 TSX2    L15

      183     3956    3               CALL FINDNS_6('SA-DM   ') ALTRET(L15);

   3956 33 000263   000020 630400 34                 EPPR0   16
        33 000264   000000 631400 34                 EPPR1   0
        33 000265   000000 701000 xent               TSX1    FINDNS_6
        33 000266   000311 702000 33                 TSX2    L15

      184     3957    3               END;

   3957 33 000267   040000 106400                    CMPC    fill='040'O
        33 000270   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000271   000035 000007 32                 ADSC9   29                       cn=0,n=7
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:31   
        33 000272   000257 601000 33                 TNZ     s:3955

      185     3958    2   L14:
      186     3959    2           IF UWA.DB_STATUS ='0502100' THEN /* */

   3959 33 000273   040000 106400       L14          CMPC    fill='040'O
        33 000274   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000275   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000276   000311 601000 33                 TNZ     L15

      187     3960    3           DO;

      188     3961    3               OL = 'NO DMCL ON SCHEMA FILE TO PURGE';

   3961 33 000277   040100 100400                    MLR     fill='040'O
        33 000300   000075 000037 32                 ADSC9   61                       cn=0,n=31
        33 000301   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      189     3962    3               CALL LIST(OL);

   3962 33 000302   200011 630500                    EPPR0   OL,,AUTO
        33 000303   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000304   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000305   000000 631400 34                 EPPR1   0
        33 000306   000000 701000 xent               TSX1    LIST
        33 000307   000000 011000                    NOP     0

      190     3963    3               GOTO CKACTS;

   3963 33 000310   000351 710000 33                 TRA     CKACTS

      191     3964    3               END;
      192     3965    2           ELSE /* */
      193     3966    2   L15:
      194     3967    2               IF UWA.DB_STATUS ~= '0502100' THEN /* */

   3967 33 000311   040000 106400       L15          CMPC    fill='040'O
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:32   
        33 000312   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000313   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000314   000327 600000 33                 TZE     s:3975

      195     3968    3               DO;

      196     3969    3                   OL = 'IDS2 ERROR, - DMCL NOT PURGED IN ENTIRETY';

   3969 33 000315   040100 100400                    MLR     fill='040'O
        33 000316   000105 000051 32                 ADSC9   69                       cn=0,n=41
        33 000317   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      197     3970    3                   CALL LIST(OL);

   3970 33 000320   200011 630500                    EPPR0   OL,,AUTO
        33 000321   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000322   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000323   000000 631400 34                 EPPR1   0
        33 000324   000000 701000 xent               TSX1    LIST
        33 000325   000000 011000                    NOP     0

      198     3971    3                   GOTO WR_DBCSERR;

   3971 33 000326   001055 710000 33                 TRA     WR_DBCSERR

      199     3972    3                   END;
      200     3973    2               ELSE /* */
      201     3974    3               DO;

      202     3975    3                   OL = 'SCHEMA FILE DMCL PURGED';

   3975 33 000327   040100 100400                    MLR     fill='040'O
        33 000330   000120 000027 32                 ADSC9   80                       cn=0,n=23
        33 000331   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      203     3976    3                   CALL LIST(OL);

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:33   
   3976 33 000332   200011 630500                    EPPR0   OL,,AUTO
        33 000333   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000334   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000335   000000 631400 34                 EPPR1   0
        33 000336   000000 701000 xent               TSX1    LIST
        33 000337   000000 011000                    NOP     0

      204     3977    3                   CALL FCURR_R_6('SA      ') ALTRET(L15);

   3977 33 000340   000014 630400 34                 EPPR0   12
        33 000341   000000 631400 34                 EPPR1   0
        33 000342   000000 701000 xent               TSX1    FCURR_R_6
        33 000343   000311 702000 33                 TSX2    L15

      205     3978    3                   UWA.SA.NUMB_DM = 0;

   3978 33 000344   000523 450000 2                  STZ     UWA+339

      206     3979    3                   CALL MODIFY_6('SA      ') ALTRET(L15);

   3979 33 000345   000014 630400 34                 EPPR0   12
        33 000346   000000 631400 34                 EPPR1   0
        33 000347   000000 701000 xent               TSX1    MODIFY_6
        33 000350   000311 702000 33                 TSX2    L15

      207     3980    3                   END;

      208     3981    2           END;

      209     3982    1   CKACTS:
      210     3983    1       IF PURGE.TYPE.SACTS THEN /* */

   3983 33 000351   000000 236000 4     CKACTS       LDQ     PURGE
        33 000352   010000 316003                    CANQ    4096,DU
        33 000353   000554 600000 33                 TZE     s:4028

      211     3984    2       DO;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:34   

      212     3985    2           ERASE_COUNT = 0;

   3985 33 000354   000001 450000 0                  STZ     ERASE_COUNT

      213     3986    2           CALL FETCHNS_6('SF-AD   ') ALTRET(L16);

   3986 33 000355   000022 630400 34                 EPPR0   18
        33 000356   000000 631400 34                 EPPR1   0
        33 000357   000000 701000 xent               TSX1    FETCHNS_6
        33 000360   000453 702000 33                 TSX2    L16

      214     3987    3           DO WHILE(UWA.DB_STATUS ~= '0502100');

   3987 33 000361   040000 106400                    CMPC    fill='040'O
        33 000362   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000363   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000364   000453 600000 33                 TZE     L16

      215     3988    3               IF UWA.A_D.AD_FUNCTION > 2 THEN /* */

   3988 33 000365   000170 235000 2                  LDA     UWA+120
        33 000366   000002 115007                    CMPA    2,DL
        33 000367   000430 604400 33                 TMOZ    s:3999

      216     3989    4               DO; /* Year 2000 modifications */

      217     3990    4                   DT1.DT_R = UWA.A_D.AD_DATE; /* UWA Date */

   3990 33 000370   040100 100400                    MLR     fill='040'O
        33 000371   000171 000006 2                  ADSC9   UWA+121                  cn=0,n=6
        33 000372   200103 200006                    ADSC9   DT1_R,,AUTO              cn=1,n=6

      218     3991    4                   DT2.DT_R = PURGE.SACTS_RET_DATE; /* RET. Date */

   3991 33 000373   040100 100400                    MLR     fill='040'O
        33 000374   000001 000006 4                  ADSC9   PURGE+1                  cn=0,n=6
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:35   
        33 000375   200105 200006                    ADSC9   DT2_R,,AUTO              cn=1,n=6

      219     3992    4                   IF DT1.DT.YR >= '00' AND DT1.DT.YR < '21' THEN

   3992 33 000376   040000 106500                    CMPC    fill='040'O
        33 000377   200103 200002                    ADSC9   DT1_R,,AUTO              cn=1,n=2
        33 000400   000130 000002 32                 ADSC9   88                       cn=0,n=2
        33 000401   000411 602000 33                 TNC     s:3994
        33 000402   040000 106500                    CMPC    fill='040'O
        33 000403   200103 200002                    ADSC9   DT1_R,,AUTO              cn=1,n=2
        33 000404   000131 000002 32                 ADSC9   89                       cn=0,n=2
        33 000405   000411 603000 33                 TRC     s:3994

      220     3993    4                       DT1.CEN = '0'; /* SET CENTURY TO '0' OR ' ' */

   3993 33 000406   060000 236003                    LDQ     24576,DU
        33 000407   200103 552140                    STBQ    DT1_R,'40'O,AUTO
        33 000410   000413 710000 33                 TRA     s:3995

      221     3994    4                   ELSE DT1.CEN = ' ';/* DEPENDING IF 19xx OR 20xx */

   3994 33 000411   040000 236003                    LDQ     16384,DU
        33 000412   200103 552140                    STBQ    DT1_R,'40'O,AUTO

      222     3995    4                   IF DT2.DT.YR >= '00' AND DT2.DT.YR < '21' THEN

   3995 33 000413   040000 106500                    CMPC    fill='040'O
        33 000414   200105 200002                    ADSC9   DT2_R,,AUTO              cn=1,n=2
        33 000415   000130 000002 32                 ADSC9   88                       cn=0,n=2
        33 000416   000426 602000 33                 TNC     s:3997
        33 000417   040000 106500                    CMPC    fill='040'O
        33 000420   200105 200002                    ADSC9   DT2_R,,AUTO              cn=1,n=2
        33 000421   000131 000002 32                 ADSC9   89                       cn=0,n=2
        33 000422   000426 603000 33                 TRC     s:3997

      223     3996    4                       DT2.CEN = '0'; /* SET CENTURY TO '0' OR ' ' */

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:36   
   3996 33 000423   060000 236003                    LDQ     24576,DU
        33 000424   200105 552140                    STBQ    DT2_R,'40'O,AUTO
        33 000425   000430 710000 33                 TRA     s:3999

      224     3997    4                   ELSE DT2.CEN = ' ';/* DEPENDING IF 19xx OR 20xx */

   3997 33 000426   040000 236003                    LDQ     16384,DU
        33 000427   200105 552140                    STBQ    DT2_R,'40'O,AUTO

      225     3998    4                   END;

      226     3999    3               IF DT1_R < DT2_R THEN

   3999 33 000430   040100 106500                    CMPC    fill='040'O
        33 000431   200103 000007                    ADSC9   DT1_R,,AUTO              cn=0,n=7
        33 000432   200105 000007                    ADSC9   DT2_R,,AUTO              cn=0,n=7
        33 000433   000443 603000 33                 TRC     s:4004

      227     4000    4               DO;

      228     4001    4                   CALL ERASE_6('A-D     ') ALTRET(L17);

   4001 33 000434   000023 630400 34                 EPPR0   19
        33 000435   000000 631400 34                 EPPR1   0
        33 000436   000000 701000 xent               TSX1    ERASE_6
        33 000437   000471 702000 33                 TSX2    L17

      229     4002    4                   ERASE_COUNT = ERASE_COUNT + 1;

   4002 33 000440   000001 235000 0                  LDA     ERASE_COUNT
        33 000441   000001 035007                    ADLA    1,DL
        33 000442   000001 755000 0                  STA     ERASE_COUNT

      230     4003    4                   END;

      231     4004    3               CALL FETCHNS_6('SF-AD  ') ALTRET(L17);

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:37   
   4004 33 000443   000022 630400 34                 EPPR0   18
        33 000444   000000 631400 34                 EPPR1   0
        33 000445   000000 701000 xent               TSX1    FETCHNS_6
        33 000446   000471 702000 33                 TSX2    L17

      232     4005    3               END;

   4005 33 000447   040000 106400                    CMPC    fill='040'O
        33 000450   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000451   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000452   000365 601000 33                 TNZ     s:3988

      233     4006    2   L16:
      234     4007    3           IF UWA.DB_STATUS = '0502100' THEN DO; /* */

   4007 33 000453   040000 106400       L16          CMPC    fill='040'O
        33 000454   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000455   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000456   000471 601000 33                 TNZ     L17

      235     4008    3               OL = 'NO ACTIVITIES ON SCHEMA FILE TO PURGE';

   4008 33 000457   040100 100400                    MLR     fill='040'O
        33 000460   000134 000045 32                 ADSC9   92                       cn=0,n=37
        33 000461   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      236     4009    3               CALL LIST(OL);

   4009 33 000462   200011 630500                    EPPR0   OL,,AUTO
        33 000463   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000464   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000465   000000 631400 34                 EPPR1   0
        33 000466   000000 701000 xent               TSX1    LIST
        33 000467   000000 011000                    NOP     0

      237     4010    3               END;

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:38   
   4010 33 000470   000554 710000 33                 TRA     s:4028

      238     4011    2           ELSE /* */
      239     4012    2   L17:
      240     4013    2               IF UWA.DB_STATUS ~= '0502100' THEN /* */

   4013 33 000471   040000 106400       L17          CMPC    fill='040'O
        33 000472   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000473   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000474   000507 600000 33                 TZE     s:4020

      241     4014    3               DO;

      242     4015    3                   OL = 'IDS2 ERROR, - ACTIVITIES NOT PURGED IN ENTIRETY' ;

   4015 33 000475   040100 100400                    MLR     fill='040'O
        33 000476   000146 000057 32                 ADSC9   102                      cn=0,n=47
        33 000477   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      243     4016    3                   CALL LIST(OL);

   4016 33 000500   200011 630500                    EPPR0   OL,,AUTO
        33 000501   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000502   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000503   000000 631400 34                 EPPR1   0
        33 000504   000000 701000 xent               TSX1    LIST
        33 000505   000000 011000                    NOP     0

      244     4017    3                   GOTO WR_DBCSERR;

   4017 33 000506   001055 710000 33                 TRA     WR_DBCSERR

      245     4018    3                   END;
      246     4019    3               ELSE DO; /* */

      247     4020    3                   CALL SET_FIELD_NUM(1,ERASE_COUNT);

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:39   
   4020 33 000507   000025 630400 34                 EPPR0   21
        33 000510   000001 631400 34                 EPPR1   1
        33 000511   000000 701000 xent               TSX1    SET_FIELD_NUM
        33 000512   000000 011000                    NOP     0

      248     4021    3                   C5 = ' ';

   4021 33 000513   040100 100400                    MLR     fill='040'O
        33 000514   000010 000001 34                 ADSC9   8                        cn=0,n=1
        33 000515   200074 000005                    ADSC9   C5,,AUTO                 cn=0,n=5

      249     4022    3                   CALL INSERT(C5,5-FIELD1.COUNT1,FIELD1.COUNT1,SUBSTR(FIELD1.TEXT1,0,
              4022                            FIELD1.COUNT1));

   4022 33 000516   000000 236000 31                 LDQ     FIELD1
        33 000517   000033 772000                    QRL     27
        33 000520   000000 620006                    EAX0    0,QL
        33 000521   000000 236000 31                 LDQ     FIELD1
        33 000522   000033 772000                    QRL     27
        33 000523   200110 756100                    STQ     DT2_R+3,,AUTO
        33 000524   000000 235003                    LDA     0,DU
        33 000525   200110 135100                    SBLA    DT2_R+3,,AUTO
        33 000526   000000 621006                    EAX1    0,QL
        33 000527   040145 100440                    MLR     fill='040'O
        33 000530   000000 200010 31                 ADSC9   FIELD1                   cn=1,n=*X0
        33 000531   200075 200011                    ADSC9   C5+1,A,AUTO              cn=1,n=*X1

      250     4023    3                   CALL CONCAT(OL,C5,' ACTIVITIES PRIOR TO ',

   4023 33 000532   040100 100500                    MLR     fill='040'O
        33 000533   200074 000005                    ADSC9   C5,,AUTO                 cn=0,n=5
        33 000534   200011 000005                    ADSC9   OL,,AUTO                 cn=0,n=5
        33 000535   040100 100400                    MLR     fill='040'O
        33 000536   000162 000025 32                 ADSC9   114                      cn=0,n=21
        33 000537   200012 200025                    ADSC9   OL+1,,AUTO               cn=1,n=21
        33 000540   040100 100400                    MLR     fill='040'O
        33 000541   000001 000006 4                  ADSC9   PURGE+1                  cn=0,n=6
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:40   
        33 000542   200017 400006                    ADSC9   OL+6,,AUTO               cn=2,n=6
        33 000543   040100 100400                    MLR     fill='040'O
        33 000544   000170 000030 32                 ADSC9   120                      cn=0,n=24
        33 000545   200021 000140                    ADSC9   OL+8,,AUTO               cn=0,n=96

      251     4024    3                      PURGE.SACTS_RET_DATE, ' PURGED FROM SCHEMA FILE');
      252     4025    3                   CALL LIST(OL);

   4025 33 000546   200011 630500                    EPPR0   OL,,AUTO
        33 000547   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000550   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000551   000000 631400 34                 EPPR1   0
        33 000552   000000 701000 xent               TSX1    LIST
        33 000553   000000 011000                    NOP     0

      253     4026    3                   END;

      254     4027    2           END;

      255     4028    1       IF PURGE.TYPE.SDICT THEN /* */

   4028 33 000554   000000 236000 4                  LDQ     PURGE
        33 000555   004000 316003                    CANQ    2048,DU
        33 000556   001053 600000 33                 TZE     RET

      256     4029    2       DO;

      257     4030    2           ERASE_COUNT = 0;

   4030 33 000557   000001 450000 0                  STZ     ERASE_COUNT

      258     4031    2           IF PURGE.SDICT_SSNAMES.ALL THEN /* */

   4031 33 000560   002000 316003                    CANQ    1024,DU
        33 000561   000666 600000 33                 TZE     s:4059

      259     4032    3           DO;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:41   

      260     4033    3               CALL FINDNS_6('SF-AS   ') ALTRET(L18);

   4033 33 000562   000027 630400 34                 EPPR0   23
        33 000563   000000 631400 34                 EPPR1   0
        33 000564   000000 701000 xent               TSX1    FINDNS_6
        33 000565   000611 702000 33                 TSX2    L18

      261     4034    4               DO WHILE(UWA.DB_STATUS ~= '0502100');

   4034 33 000566   040000 106400                    CMPC    fill='040'O
        33 000567   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000570   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000571   000611 600000 33                 TZE     L18

      262     4035    4                   CALL ERASE_6('AS      ') ALTRET(L19);

   4035 33 000572   000030 630400 34                 EPPR0   24
        33 000573   000000 631400 34                 EPPR1   0
        33 000574   000000 701000 xent               TSX1    ERASE_6
        33 000575   000627 702000 33                 TSX2    L19

      263     4036    4                   ERASE_COUNT = ERASE_COUNT + 1;

   4036 33 000576   000001 235000 0                  LDA     ERASE_COUNT
        33 000577   000001 035007                    ADLA    1,DL
        33 000600   000001 755000 0                  STA     ERASE_COUNT

      264     4037    4                   CALL FINDNS_6('SF-AS   ') ALTRET(L19);

   4037 33 000601   000027 630400 34                 EPPR0   23
        33 000602   000000 631400 34                 EPPR1   0
        33 000603   000000 701000 xent               TSX1    FINDNS_6
        33 000604   000627 702000 33                 TSX2    L19

      265     4038    4                   END;

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:42   
   4038 33 000605   040000 106400                    CMPC    fill='040'O
        33 000606   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000607   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000610   000572 601000 33                 TNZ     s:4035

      266     4039    3   L18:
      267     4040    4               IF UWA.DB_STATUS = '0502100' THEN DO; /* */

   4040 33 000611   040000 106400       L18          CMPC    fill='040'O
        33 000612   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000613   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000614   000627 601000 33                 TNZ     L19

      268     4041    4                   OL = 'NO VALIDATED SUBSCHEMA RECORDED ON SCHEMA FILE';

   4041 33 000615   040100 100400                    MLR     fill='040'O
        33 000616   000202 000056 32                 ADSC9   130                      cn=0,n=46
        33 000617   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      269     4042    4                   CALL LIST(OL);

   4042 33 000620   200011 630500                    EPPR0   OL,,AUTO
        33 000621   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000622   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000623   000000 631400 34                 EPPR1   0
        33 000624   000000 701000 xent               TSX1    LIST
        33 000625   000000 011000                    NOP     0

      270     4043    4                   END;

   4043 33 000626   001053 710000 33                 TRA     RET

      271     4044    3               ELSE /* */
      272     4045    3   L19:
      273     4046    3                   IF UWA.DB_STATUS ~= '0502100' THEN /* */

   4046 33 000627   040000 106400       L19          CMPC    fill='040'O
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:43   
        33 000630   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 000631   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 000632   000645 600000 33                 TZE     s:4053

      274     4047    4                   DO;

      275     4048    4                      OL = 'IDS2 ERROR, - VALIDATED SUBSCHEMAS NOT PURGED IN ENTIRETY'
              4048                                ;

   4048 33 000633   040100 100400                    MLR     fill='040'O
        33 000634   000216 000071 32                 ADSC9   142                      cn=0,n=57
        33 000635   200011 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      276     4049    4                       CALL LIST(OL);

   4049 33 000636   200011 630500                    EPPR0   OL,,AUTO
        33 000637   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000640   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000641   000000 631400 34                 EPPR1   0
        33 000642   000000 701000 xent               TSX1    LIST
        33 000643   000000 011000                    NOP     0

      277     4050    4                       GOTO WR_DBCSERR;

   4050 33 000644   001055 710000 33                 TRA     WR_DBCSERR

      278     4051    4                       END;
      279     4052    4                   ELSE DO; /* */

      280     4053    4                       CALL SET_FIELD_NUM(1,ERASE_COUNT);

   4053 33 000645   000025 630400 34                 EPPR0   21
        33 000646   000001 631400 34                 EPPR1   1
        33 000647   000000 701000 xent               TSX1    SET_FIELD_NUM
        33 000650   000000 011000                    NOP     0

      281     4054    4                       CALL CONCAT(OL,SUBSTR(FIELD1.TEXT1,0,5),
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:44   
              4054                                ' VALIDATED SUBSCHEMAS PURGED FROM SCHEMA FILE');

   4054 33 000651   040100 100400                    MLR     fill='040'O
        33 000652   000000 200005 31                 ADSC9   FIELD1                   cn=1,n=5
        33 000653   200011 000005                    ADSC9   OL,,AUTO                 cn=0,n=5
        33 000654   040100 100400                    MLR     fill='040'O
        33 000655   000235 000055 32                 ADSC9   157                      cn=0,n=45
        33 000656   200012 200173                    ADSC9   OL+1,,AUTO               cn=1,n=123

      282     4055    4                       CALL LIST(OL);

   4055 33 000657   200011 630500                    EPPR0   OL,,AUTO
        33 000660   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000661   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000662   000000 631400 34                 EPPR1   0
        33 000663   000000 701000 xent               TSX1    LIST
        33 000664   000000 011000                    NOP     0

      283     4056    4                       END;

      284     4057    3               END;

   4057 33 000665   001053 710000 33                 TRA     RET

      285     4058    2           ELSE /* */
      286     4059    2               IF PURGE.SDICT_SSNAMES.SSNAMES THEN /* */

   4059 33 000666   000000 430000 4                  FSZN    PURGE
        33 000667   001053 605000 33                 TPL     RET

      287     4060    3               DO;

      288     4061    3                   CALL UOPEN('5*',0);

   4061 33 000670   000032 630400 34                 EPPR0   26
        33 000671   000001 631400 34                 EPPR1   1
        33 000672   000000 701000 xent               TSX1    UOPEN
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:45   
        33 000673   000000 011000                    NOP     0

      289     4062    3   MORE:           CALL UGET('5*',W25$,FIVESTAREOF,Y);

   4062 33 000674   000036 237000 34    MORE         LDAQ    30
        33 000675   200112 757100                    STAQ    DT2_R+5,,AUTO
        33 000676   200006 630500                    EPPR0   W25$,,AUTO
        33 000677   200111 450500                    STP0    DT2_R+4,,AUTO
        33 000700   000032 236000 34                 LDQ     26
        33 000701   200110 756100                    STQ     DT2_R+3,,AUTO
        33 000702   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000703   000034 631400 34                 EPPR1   28
        33 000704   000000 701000 xent               TSX1    UGET
        33 000705   000000 011000                    NOP     0

      290     4063    3                   PURGE_DESC = W25;

   4063 33 000706   200006 470500                    LDP0    W25$,,AUTO
        33 000707   000000 100500                    MLR     fill='000'O
        33 000710   000000 000144                    ADSC9   0,,PR0                   cn=0,n=100
        33 000711   000000 000144 1                  ADSC9   DESC                     cn=0,n=100

      291     4064    4                   DO WHILE(FIVESTAREOF = 0);

   4064 33 000712   000002 235000 0                  LDA     FIVESTAREOF
        33 000713   001006 601000 33                 TNZ     s:4078

      292     4065    4                       CALL INDEX1(X,'_',PURGE_DESC.SS_NAMES);

   4065 33 000714   000000 124400                    SCM     mask='000'O
        33 000715   000000 000036 1                  ADSC9   DESC                     cn=0,n=30
        33 000716   000035 000001 34                 ADSC9   29                       cn=0,n=1
        33 000717   000000 000000 0                  ARG     X

      293     4066    5                       DO WHILE(X ~= LENGTHC(PURGE_DESC.SS_NAMES));

   4066 33 000720   000731 710000 33                 TRA     s:4069
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:46   

      294     4067    5                           CALL INSERT(PURGE_DESC.SS_NAMES,X,1,'-');

   4067 33 000721   000000 235000 0                  LDA     X
        33 000722   040005 100400                    MLR     fill='040'O
        33 000723   000040 000001 34                 ADSC9   32                       cn=0,n=1
        33 000724   000000 000001 1                  ADSC9   DESC,A                   cn=0,n=1

      295     4068    5                           CALL INDEX1(X,'_',PURGE_DESC.SS_NAMES);

   4068 33 000725   000000 124400                    SCM     mask='000'O
        33 000726   000000 000036 1                  ADSC9   DESC                     cn=0,n=30
        33 000727   000035 000001 34                 ADSC9   29                       cn=0,n=1
        33 000730   000000 000000 0                  ARG     X

      296     4069    5                           END;

   4069 33 000731   000000 235000 0                  LDA     X
        33 000732   000036 115007                    CMPA    30,DL
        33 000733   000721 601000 33                 TNZ     s:4067

      297     4070    4                       UWA.AS.SS_NAME = PURGE_DESC.SS_NAMES;

   4070 33 000734   040000 100400                    MLR     fill='040'O
        33 000735   000000 000036 1                  ADSC9   DESC                     cn=0,n=30
        33 000736   000066 000036 2                  ADSC9   UWA+54                   cn=0,n=30

      298     4071    4                       CALL FETCHC_6('AS      ') ALTRET(L20);

   4071 33 000737   000030 630400 34                 EPPR0   24
        33 000740   000000 631400 34                 EPPR1   0
        33 000741   000000 701000 xent               TSX1    FETCHC_6
        33 000742   001013 702000 33                 TSX2    L20

      299     4072    4                       CALL ERASE_6('AS      ') ALTRET(L21);

   4072 33 000743   000030 630400 34                 EPPR0   24
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:47   
        33 000744   000000 631400 34                 EPPR1   0
        33 000745   000000 701000 xent               TSX1    ERASE_6
        33 000746   001033 702000 33                 TSX2    L21

      300     4073    4                       CALL CONCAT(OL,'RECORDING OF ',PURGE_DESC.SS_NAMES,
              4073                                ' PURGED FROM SCHEMA FILE DICTIONARY');

   4073 33 000747   040100 100400                    MLR     fill='040'O
        33 000750   000252 000015 32                 ADSC9   170                      cn=0,n=13
        33 000751   200011 000015                    ADSC9   OL,,AUTO                 cn=0,n=13
        33 000752   040100 100400                    MLR     fill='040'O
        33 000753   000000 000036 1                  ADSC9   DESC                     cn=0,n=30
        33 000754   200014 200036                    ADSC9   OL+3,,AUTO               cn=1,n=30
        33 000755   040100 100400                    MLR     fill='040'O
        33 000756   000256 000043 32                 ADSC9   174                      cn=0,n=35
        33 000757   200023 600125                    ADSC9   OL+10,,AUTO              cn=3,n=85

      301     4074    4                       CALL LIST(OL);

   4074 33 000760   200011 630500                    EPPR0   OL,,AUTO
        33 000761   200110 450500                    STP0    DT2_R+3,,AUTO
        33 000762   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000763   000000 631400 34                 EPPR1   0
        33 000764   000000 701000 xent               TSX1    LIST
        33 000765   000000 011000                    NOP     0

      302     4075    4                       CALL UGET('5*',W25$,FIVESTAREOF,Y);

   4075 33 000766   000036 237000 34                 LDAQ    30
        33 000767   200112 757100                    STAQ    DT2_R+5,,AUTO
        33 000770   200006 630500                    EPPR0   W25$,,AUTO
        33 000771   200111 450500                    STP0    DT2_R+4,,AUTO
        33 000772   000032 236000 34                 LDQ     26
        33 000773   200110 756100                    STQ     DT2_R+3,,AUTO
        33 000774   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 000775   000034 631400 34                 EPPR1   28
        33 000776   000000 701000 xent               TSX1    UGET
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:48   
        33 000777   000000 011000                    NOP     0

      303     4076    4                       PURGE_DESC = W25;

   4076 33 001000   200006 470500                    LDP0    W25$,,AUTO
        33 001001   000000 100500                    MLR     fill='000'O
        33 001002   000000 000144                    ADSC9   0,,PR0                   cn=0,n=100
        33 001003   000000 000144 1                  ADSC9   DESC                     cn=0,n=100

      304     4077    4                       END;

   4077 33 001004   000002 235000 0                  LDA     FIVESTAREOF
        33 001005   000714 600000 33                 TZE     s:4065

      305     4078    3                   CALL UCLOSE('5*');

   4078 33 001006   000032 630400 34                 EPPR0   26
        33 001007   000000 631400 34                 EPPR1   0
        33 001010   000000 701000 xent               TSX1    UCLOSE
        33 001011   000000 011000                    NOP     0

      306     4079    3                   GOTO RET;

   4079 33 001012   001053 710000 33                 TRA     RET

      307     4080    3   L20:
      308     4081    3                   CALL CONCAT(OL,'RECORDING OF ',PURGE_DESC.SS_NAMES,
              4081                            ' NOT FOUND IN SCHEMA FILE');

   4081 33 001013   040100 100400       L20          MLR     fill='040'O
        33 001014   000252 000015 32                 ADSC9   170                      cn=0,n=13
        33 001015   200011 000015                    ADSC9   OL,,AUTO                 cn=0,n=13
        33 001016   040100 100400                    MLR     fill='040'O
        33 001017   000000 000036 1                  ADSC9   DESC                     cn=0,n=30
        33 001020   200014 200036                    ADSC9   OL+3,,AUTO               cn=1,n=30
        33 001021   040100 100400                    MLR     fill='040'O
        33 001022   000267 000031 32                 ADSC9   183                      cn=0,n=25
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:49   
        33 001023   200023 600125                    ADSC9   OL+10,,AUTO              cn=3,n=85

      309     4082    3                   CALL LIST(OL);

   4082 33 001024   200011 630500                    EPPR0   OL,,AUTO
        33 001025   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001026   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001027   000000 631400 34                 EPPR1   0
        33 001030   000000 701000 xent               TSX1    LIST
        33 001031   000000 011000                    NOP     0

      310     4083    3                   GOTO MORE;

   4083 33 001032   000674 710000 33                 TRA     MORE

      311     4084    3   L21:
      312     4085    3                   CALL CONCAT(OL,'IDS2 ERROR, - ',PURGE_DESC.SS_NAMES,
              4085                            ' NOT PURGED FROM SCHEMA FILE');

   4085 33 001033   040100 100400       L21          MLR     fill='040'O
        33 001034   000051 000016 32                 ADSC9   41                       cn=0,n=14
        33 001035   200011 000016                    ADSC9   OL,,AUTO                 cn=0,n=14
        33 001036   040100 100400                    MLR     fill='040'O
        33 001037   000000 000036 1                  ADSC9   DESC                     cn=0,n=30
        33 001040   200014 400036                    ADSC9   OL+3,,AUTO               cn=2,n=30
        33 001041   040100 100400                    MLR     fill='040'O
        33 001042   000276 000034 32                 ADSC9   190                      cn=0,n=28
        33 001043   200024 000124                    ADSC9   OL+11,,AUTO              cn=0,n=84

      313     4086    3                   CALL LIST(OL);

   4086 33 001044   200011 630500                    EPPR0   OL,,AUTO
        33 001045   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001046   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001047   000000 631400 34                 EPPR1   0
        33 001050   000000 701000 xent               TSX1    LIST
        33 001051   000000 011000                    NOP     0
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:50   

      314     4087    3                   GOTO WR_DBCSERR;

   4087 33 001052   001055 710000 33                 TRA     WR_DBCSERR

   4083 33 001053                       RET          null
      315     4088    3                   END;
      316     4089    2           END;
      317     4090
      318     4091    1   RET: ;
      319     4092
      320     4093    1       ERR = '0'B;

   4093 33 001053   200010 450100                    STZ     ERR,,AUTO

      321     4094    1       GOTO WR_AD_RECORD;

   4094 33 001054   001057 710000 33                 TRA     WR_AD_RECORD

      322     4095
      323     4096    2       DO WHILE '0'B;

   4085 33 001055                       WR_DBCSERR   null
      324     4097
      325     4098    2   WR_DBCSERR: ;
      326     4099
      327     4100    2           ERR = '1'B;

   4100 33 001055   400000 236003                    LDQ     -131072,DU
        33 001056   200010 756100                    STQ     ERR,,AUTO

      328     4101    2           END;

   4098 33 001057                       WR_AD_RECORD null
      329     4102
      330     4103    1   WR_AD_RECORD: ;
      331     4104
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:51   
      332     4105        /* Record purge function against schema */
      333     4106
      334     4107    1       UWA.A_D.AD_FUNCTION = 7;

   4107 33 001057   000007 235007                    LDA     7,DL
        33 001060   000170 755000 2                  STA     UWA+120

      335     4108    1       UWA.A_D.AD_IDENT = ' ';

   4108 33 001061   040000 100400                    MLR     fill='040'O
        33 001062   000010 000001 34                 ADSC9   8                        cn=0,n=1
        33 001063   000174 000074 2                  ADSC9   UWA+124                  cn=0,n=60

      336     4109    1       CALL GET_TIME( UWA.A_D.AD_DATE );

   4109 33 001064   000041 630400 34                 EPPR0   33
        33 001065   000000 631400 34                 EPPR1   0
        33 001066   000000 701000 xent               TSX1    GET_TIME
        33 001067   000000 011000                    NOP     0

      337     4110    1       CALL STRE_6('A-D     ');

   4110 33 001070   000023 630400 34                 EPPR0   19
        33 001071   000000 631400 34                 EPPR1   0
        33 001072   000000 701000 xent               TSX1    STRE_6
        33 001073   000000 011000                    NOP     0

      338     4111
      339     4112    1       IF NOT ERR THEN

   4112 33 001074   200010 234100                    SZN     ERR,,AUTO
        33 001075   001077 604000 33                 TMI     DBCSERR

      340     4113    1           RETURN;

   4113 33 001076   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:52   
      341     4114
      342     4115    1   DBCSERR: CALL ABORT;

   4115 33 001077   000031 631400 34    DBCSERR      EPPR1   25
        33 001100   000000 701000 xent               TSX1    ABORT
        33 001101   000000 011000                    NOP     0

      343     4116    1   L30:
      344     4117    1       IF UWA.DB_STATUS ~= '0502100' THEN GOTO DBCSERR;

   4117 33 001102   040000 106400       L30          CMPC    fill='040'O
        33 001103   000001 000007 2                  ADSC9   UWA+1                    cn=0,n=7
        33 001104   000035 000007 32                 ADSC9   29                       cn=0,n=7
        33 001105   001077 601000 33                 TNZ     DBCSERR

      345     4118    1       IF LK3 = 0 THEN GOTO A1;

   4118 33 001106   200003 236100                    LDQ     LK3,,AUTO
        33 001107   777776 316003                    CANQ    -2,DU
        33 001110   000127 600000 33                 TZE     A1

      346     4119    1       CALL CONCAT(OL,'ILLEGAL PRIVACY KEY FOR ALTER - ',PURGE.ALTER_KEY);

   4119 33 001111   040100 100400                    MLR     fill='040'O
        33 001112   000305 000040 32                 ADSC9   197                      cn=0,n=32
        33 001113   200011 000040                    ADSC9   OL,,AUTO                 cn=0,n=32
        33 001114   040100 100400                    MLR     fill='040'O
        33 001115   000002 400014 4                  ADSC9   PURGE+2                  cn=2,n=12
        33 001116   200021 000140                    ADSC9   OL+8,,AUTO               cn=0,n=96

      347     4120    1       CALL LIST(OL);

   4120 33 001117   200011 630500                    EPPR0   OL,,AUTO
        33 001120   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001121   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001122   000000 631400 34                 EPPR1   0
        33 001123   000000 701000 xent               TSX1    LIST
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:53   
        33 001124   000000 011000                    NOP     0

      348     4121    1       RETURN;

   4121 33 001125   000000 702200 xent               TSX2  ! X66_ARET

      349     4122    1   ZIG$PURGE_SUB:
      350     4123    1       ENTRY;

   4123 33 001126   000000 700200 xent  ZIG$PURGE_S* TSX0  ! X66_AUTO_0
        33 001127   000114 000000                    ZERO    76,0

      351     4124    1       BLKPTR = ADDR(CONTROL);

   4124 33 001130   000042 236000 34                 LDQ     34
        33 001131   200007 756100                    STQ     BLKPTR,,AUTO

      352     4125    1       CALL READ64(0, BLKPTR);

   4125 33 001132   200007 630500                    EPPR0   BLKPTR,,AUTO
        33 001133   200111 450500                    STP0    DT2_R+4,,AUTO
        33 001134   000033 236000 34                 LDQ     27
        33 001135   200110 756100                    STQ     DT2_R+3,,AUTO
        33 001136   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001137   000001 631400 34                 EPPR1   1
        33 001140   000000 701000 xent               TSX1    READ64
        33 001141   000000 011000                    NOP     0

      353     4126    1       IF CONTROL.TYPE30 ~= 30 OR CONTROL.TYPE100 ~= 100

   4126 33 001142   000003 235000 29                 LDA     CONTROL+3
        33 001143   000036 115007                    CMPA    30,DL
        33 001144   001150 601000 33                 TNZ     s:4128
        33 001145   000040 236000 29                 LDQ     CONTROL+32
        33 001146   000144 116007                    CMPQ    100,DL
        33 001147   001165 600000 33                 TZE     s:4135

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:54   
      354     4127    2       THEN DO;

      355     4128    2          CALL CONCAT(OL,CONTROL.SUBSCHEMA_NAME , 'NOT RECOGNIZED AS SUBSCHEMA FILE.')
              4128                    ;

   4128 33 001150   040100 100400                    MLR     fill='040'O
        33 001151   000030 000040 29                 ADSC9   CONTROL+24               cn=0,n=32
        33 001152   200011 000040                    ADSC9   OL,,AUTO                 cn=0,n=32
        33 001153   040100 100400                    MLR     fill='040'O
        33 001154   000315 000041 32                 ADSC9   205                      cn=0,n=33
        33 001155   200021 000140                    ADSC9   OL+8,,AUTO               cn=0,n=96

      356     4129    2           CALL LIST(OL);

   4129 33 001156   200011 630500                    EPPR0   OL,,AUTO
        33 001157   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001160   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001161   000000 631400 34                 EPPR1   0
        33 001162   000000 701000 xent               TSX1    LIST
        33 001163   000000 011000                    NOP     0

      357     4130    2           RETURN;

   4130 33 001164   000000 702200 xent               TSX2  ! X66_ARET

      358     4131    2           END;
      359     4132        /*
      360     4133              Read the control block of the subschema.
      361     4134        */
      362     4135    1       FPT_DELREC.V.DCB# = SUBDCB.DCB#;

   4135 33 001165   000010 220000 xsym               LDX0    SUBDCB+8
        33 001166   000062 740000 0                  STX0    FPT_DELREC+8

      363     4136    1       DEL_REC#.CNT = 3;

   4136 33 001167   003000 236003                    LDQ     1536,DU
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:55   
        33 001170   000125 552040 0                  STBQ    DEL_REC#,'40'O

      364     4137    1       IF PURGE.SACTS_RET_DATE = '      '

   4137 33 001171   040000 106400                    CMPC    fill='040'O
        33 001172   000001 000006 4                  ADSC9   PURGE+1                  cn=0,n=6
        33 001173   000326 000006 32                 ADSC9   214                      cn=0,n=6
        33 001174   001177 601000 33                 TNZ     s:4143

      365     4138    2       THEN DO;

      366     4139    2           UTS = '0'B;

   4139 33 001175   000064 450000 0                  STZ     UTS

      367     4140    2           GOTO DELETE_ALL_CU;

   4140 33 001176   001326 710000 33                 TRA     DELETE_ALL_CU

      368     4141    2           END;
      369     4142    2       ELSE DO;

      370     4143    2           CALL ANS_TIME(PURGE.SACTS_RET_DATE,BITBIN(UTS));

   4143 33 001177   000043 630400 34                 EPPR0   35
        33 001200   000001 631400 34                 EPPR1   1
        33 001201   000000 701000 xent               TSX1    ANS_TIME
        33 001202   000000 011000                    NOP     0

      371     4144    2           CU_RECORD = CONTROL.FIRST_CU_RECORD;

   4144 33 001203   000073 235000 29                 LDA     CONTROL+59
        33 001204   200101 755100                    STA     CU_RECORD,,AUTO

      372     4145    2           FIRST_SAVE = '1'B;

   4145 33 001205   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:56   
        33 001206   200100 756100                    STQ     FIRST_SAVE,,AUTO

      373     4146    2           FIRST_CU = '1'B;

   4146 33 001207   200077 756100                    STQ     FIRST_CU,,AUTO

      374     4147    3           DO WHILE CU_RECORD ~= 0;

   4147 33 001210   000000 115003                    CMPA    0,DU
        33 001211   001273 600000 33                 TZE     s:4168

      375     4148    3               CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );

   4148 33 001212   000045 236000 34                 LDQ     37
        33 001213   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001214   200101 630500                    EPPR0   CU_RECORD,,AUTO
        33 001215   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001216   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001217   000001 631400 34                 EPPR1   1
        33 001220   000000 701000 xent               TSX1    READSF
        33 001221   000000 011000                    NOP     0

      376     4149    3               IF FIRST_SAVE

   4149 33 001222   200100 234100                    SZN     FIRST_SAVE,,AUTO
        33 001223   001232 605000 33                 TPL     s:4155

      377     4150    4               THEN DO;

      378     4151    4                   FIRST_SAVE = '0'B;

   4151 33 001224   200100 450100                    STZ     FIRST_SAVE,,AUTO

      379     4152    4                   SAVE_CU = CU;

   4152 33 001225   000000 100400                    MLR     fill='000'O
        33 001226   000065 000200 0                  ADSC9   CU                       cn=0,n=128
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:57   
        33 001227   000126 000200 0                  ADSC9   SAVE_CU                  cn=0,n=128

      380     4153    4                   NEXT_AVAIL_CU = CU_RECORD;

   4153 33 001230   200101 235100                    LDA     CU_RECORD,,AUTO
        33 001231   200102 755100                    STA     NEXT_AVAIL_CU,,AUTO

      381     4154    4                   END;

      382     4155    3               IF UTS < CU.GTIME.TIME

   4155 33 001232   000064 236000 0                  LDQ     UTS
        33 001233   000112 116000 0                  CMPQ    CU+21
        33 001234   001270 603000 33                 TRC     s:4166

      383     4156    4               THEN DO;

      384     4157    4                   FIRST_CU = '0'B;

   4157 33 001235   200077 450100                    STZ     FIRST_CU,,AUTO

      385     4158    4                   TEMP_CU = CU;

   4158 33 001236   000000 100400                    MLR     fill='000'O
        33 001237   000065 000200 0                  ADSC9   CU                       cn=0,n=128
        33 001240   000166 000200 0                  ADSC9   TEMP_CU                  cn=0,n=128

      386     4159    4                   IF TEMP_CU.NEXT ~= 0 THEN

   4159 33 001241   000166 235000 0                  LDA     TEMP_CU
        33 001242   001245 600000 33                 TZE     s:4161

      387     4160    4                       TEMP_CU.NEXT = SAVE_CU.NEXT;

   4160 33 001243   000126 235000 0                  LDA     SAVE_CU
        33 001244   000166 755000 0                  STA     TEMP_CU

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:58   
      388     4161    4                   CALL WRITSF( NEXT_AVAIL_CU, ADDR(TEMP_CU)->CHAR_128 );

   4161 33 001245   000046 236000 34                 LDQ     38
        33 001246   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001247   200102 630500                    EPPR0   NEXT_AVAIL_CU,,AUTO
        33 001250   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001251   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001252   000001 631400 34                 EPPR1   1
        33 001253   000000 701000 xent               TSX1    WRITSF
        33 001254   000000 011000                    NOP     0

      389     4162    4                   NEXT_AVAIL_CU = SAVE_CU.NEXT;

   4162 33 001255   000126 235000 0                  LDA     SAVE_CU
        33 001256   200102 755100                    STA     NEXT_AVAIL_CU,,AUTO

      390     4163    4                   IF NEXT_AVAIL_CU ~= 0 THEN

   4163 33 001257   001270 600000 33                 TZE     s:4166

      391     4164    4                       CALL READSF( NEXT_AVAIL_CU, ADDR(SAVE_CU)->CHAR_128 );

   4164 33 001260   000047 236000 34                 LDQ     39
        33 001261   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001262   200102 630500                    EPPR0   NEXT_AVAIL_CU,,AUTO
        33 001263   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001264   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001265   000001 631400 34                 EPPR1   1
        33 001266   000000 701000 xent               TSX1    READSF
        33 001267   000000 011000                    NOP     0

      392     4165    4                   END;

      393     4166    3               CU_RECORD = CU.NEXT;

   4166 33 001270   000065 235000 0                  LDA     CU
        33 001271   200101 755100                    STA     CU_RECORD,,AUTO
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:59   

      394     4167    3               END;

   4167 33 001272   001212 601000 33                 TNZ     s:4148

      395     4168    2           IF FIRST_CU THEN

   4168 33 001273   200077 234100                    SZN     FIRST_CU,,AUTO
        33 001274   001326 604000 33                 TMI     DELETE_ALL_CU

      396     4169    2               GOTO DELETE_ALL_CU;
      397     4170    2           END;

      398     4171    1       IF NEXT_AVAIL_CU ~=0

   4171 33 001275   200102 236100                    LDQ     NEXT_AVAIL_CU,,AUTO
        33 001276   001312 600000 33                 TZE     s:4182

      399     4172    2       THEN DO;

      400     4173    2           FIRST_CROSS_OVER = '1'B;

   4173 33 001277   400000 236003                    LDQ     -131072,DU
        33 001300   200076 756100                    STQ     FIRST_CROSS_OVER,,AUTO

      401     4174    2           IF NEXT_AVAIL_CU > CONTROL.FIRST_NFE_RECORD

   4174 33 001301   000076 236000 29                 LDQ     CONTROL+62
        33 001302   200102 116100                    CMPQ    NEXT_AVAIL_CU,,AUTO
        33 001303   001307 603000 33                 TRC     s:4179

      402     4175    3           THEN DO;

      403     4176    3               FIRST_CROSS_OVER = '0'B;

   4176 33 001304   200076 450100                    STZ     FIRST_CROSS_OVER,,AUTO

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:60   
      404     4177    3               CONTROL.NEXT_AVAILABLE_RECORD = NEXT_AVAIL_CU;

   4177 33 001305   200102 235100                    LDA     NEXT_AVAIL_CU,,AUTO
        33 001306   000072 755000 29                 STA     CONTROL+58

      405     4178    3               END;

      406     4179    2           CU_RECORD = NEXT_AVAIL_CU;

   4179 33 001307   200102 235100                    LDA     NEXT_AVAIL_CU,,AUTO
        33 001310   200101 755100                    STA     CU_RECORD,,AUTO

      407     4180    2           GOTO DELETE;

   4180 33 001311   001341 710000 33                 TRA     DELETE

      408     4181    2           END;
      409     4182    1       CALL WRIT64( 0, BLKPTR );

   4182 33 001312   200007 630500                    EPPR0   BLKPTR,,AUTO
        33 001313   200111 450500                    STP0    DT2_R+4,,AUTO
        33 001314   000033 236000 34                 LDQ     27
        33 001315   200110 756100                    STQ     DT2_R+3,,AUTO
        33 001316   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001317   000001 631400 34                 EPPR1   1
        33 001320   000000 701000 xent               TSX1    WRIT64
        33 001321   000000 011000                    NOP     0

      410     4183    1       CALL CLOSE_64;

   4183 33 001322   000031 631400 34                 EPPR1   25
        33 001323   000000 701000 xent               TSX1    CLOSE_64
        33 001324   000000 011000                    NOP     0

      411     4184    1       RETURN;

   4184 33 001325   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:61   

      412     4185
      413     4186    1   DELETE_ALL_CU:
      414     4187    1       FIRST_CROSS_OVER = '1'B;

   4187 33 001326   400000 236003       DELETE_ALL_* LDQ     -131072,DU
        33 001327   200076 756100                    STQ     FIRST_CROSS_OVER,,AUTO

      415     4188    1       IF CONTROL.FIRST_NFE_RECORD < CONTROL.FIRST_CU_RECORD

   4188 33 001330   000076 236000 29                 LDQ     CONTROL+62
        33 001331   000073 116000 29                 CMPQ    CONTROL+59
        33 001332   001336 603000 33                 TRC     s:4193

      416     4189    2       THEN DO;

      417     4190    2           FIRST_CROSS_OVER = '0'B;

   4190 33 001333   200076 450100                    STZ     FIRST_CROSS_OVER,,AUTO

      418     4191    2           CONTROL.NEXT_AVAILABLE_RECORD = CONTROL.FIRST_CU_RECORD;

   4191 33 001334   000073 235000 29                 LDA     CONTROL+59
        33 001335   000072 755000 29                 STA     CONTROL+58

      419     4192    2           END;

      420     4193    1       CU_RECORD = CONTROL.FIRST_CU_RECORD;

   4193 33 001336   000073 235000 29                 LDA     CONTROL+59
        33 001337   200101 755100                    STA     CU_RECORD,,AUTO

      421     4194    1       CONTROL.FIRST_CU_RECORD = 0;

   4194 33 001340   000073 450000 29                 STZ     CONTROL+59

      422     4195
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:62   
      423     4196    1   DELETE:
      424     4197    1       IF MOD( CU_RECORD, 2 ) ~= 0

   4197 33 001341   200101 236100       DELETE       LDQ     CU_RECORD,,AUTO
        33 001342   000001 376007                    ANQ     1,DL
        33 001343   001377 600000 33                 TZE     s:4209

      425     4198    2       THEN DO;

      426     4199    2           CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );

   4199 33 001344   000045 236000 34                 LDQ     37
        33 001345   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001346   200101 630500                    EPPR0   CU_RECORD,,AUTO
        33 001347   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001350   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001351   000001 631400 34                 EPPR1   1
        33 001352   000000 701000 xent               TSX1    READSF
        33 001353   000000 011000                    NOP     0

      427     4200    2           CU_RECORD = CU.NEXT;

   4200 33 001354   000065 235000 0                  LDA     CU
        33 001355   200101 755100                    STA     CU_RECORD,,AUTO

      428     4201    2           IF ( CU_RECORD > CONTROL.FIRST_NFE_RECORD ) AND FIRST_CROSS_OVER

   4201 33 001356   000076 236000 29                 LDQ     CONTROL+62
        33 001357   200101 116100                    CMPQ    CU_RECORD,,AUTO
        33 001360   001377 603000 33                 TRC     s:4209
        33 001361   200076 234100                    SZN     FIRST_CROSS_OVER,,AUTO
        33 001362   001377 605000 33                 TPL     s:4209

      429     4202    3           THEN DO;

      430     4203    3               FIRST_CROSS_OVER = '0'B;

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:63   
   4203 33 001363   200076 450100                    STZ     FIRST_CROSS_OVER,,AUTO

      431     4204    3               CONTROL.NEXT_AVAILABLE_RECORD = CU_RECORD;

   4204 33 001364   000072 755000 29                 STA     CONTROL+58

      432     4205    3               CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );

   4205 33 001365   000045 236000 34                 LDQ     37
        33 001366   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001367   200101 630500                    EPPR0   CU_RECORD,,AUTO
        33 001370   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001371   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001372   000001 631400 34                 EPPR1   1
        33 001373   000000 701000 xent               TSX1    READSF
        33 001374   000000 011000                    NOP     0

      433     4206    3               CU_RECORD = CU.NEXT;

   4206 33 001375   000065 235000 0                  LDA     CU
        33 001376   200101 755100                    STA     CU_RECORD,,AUTO

      434     4207    3               END;

      435     4208    2           END;

      436     4209    2       DO WHILE CU_RECORD ~= 0;

   4209 33 001377   000000 115003                    CMPA    0,DU
        33 001400   001467 600000 33                 TZE     s:4232

      437     4210    2           DEL_REC#.KEY = CU_RECORD/2;

   4210 33 001401   200101 236100                    LDQ     CU_RECORD,,AUTO
        33 001402   000001 772000                    QRL     1
        33 001403   000125 552034 0                  STBQ    DEL_REC#,'34'O

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:64   
      438     4211    2           CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );

   4211 33 001404   000045 236000 34                 LDQ     37
        33 001405   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001406   200101 630500                    EPPR0   CU_RECORD,,AUTO
        33 001407   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001410   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001411   000001 631400 34                 EPPR1   1
        33 001412   000000 701000 xent               TSX1    READSF
        33 001413   000000 011000                    NOP     0

      439     4212    2           CU_RECORD = CU.NEXT;

   4212 33 001414   000065 235000 0                  LDA     CU
        33 001415   200101 755100                    STA     CU_RECORD,,AUTO

      440     4213    2           IF ( CU_RECORD > CONTROL.FIRST_NFE_RECORD ) AND FIRST_CROSS_OVER

   4213 33 001416   000076 236000 29                 LDQ     CONTROL+62
        33 001417   200101 116100                    CMPQ    CU_RECORD,,AUTO
        33 001420   001425 603000 33                 TRC     s:4218
        33 001421   200076 234100                    SZN     FIRST_CROSS_OVER,,AUTO
        33 001422   001425 605000 33                 TPL     s:4218

      441     4214    3           THEN DO;

      442     4215    3               FIRST_CROSS_OVER = '0'B;

   4215 33 001423   200076 450100                    STZ     FIRST_CROSS_OVER,,AUTO

      443     4216    3               CONTROL.NEXT_AVAILABLE_RECORD = CU_RECORD;

   4216 33 001424   000072 755000 29                 STA     CONTROL+58

      444     4217    3               END;

      445     4218    2           IF CU_RECORD ~= 0
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:65   

   4218 33 001425   000000 115003                    CMPA    0,DU
        33 001426   001462 600000 33                 TZE     s:4230

      446     4219    3           THEN DO;

      447     4220    3               CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );

   4220 33 001427   000045 236000 34                 LDQ     37
        33 001430   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001431   200101 630500                    EPPR0   CU_RECORD,,AUTO
        33 001432   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001433   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001434   000001 631400 34                 EPPR1   1
        33 001435   000000 701000 xent               TSX1    READSF
        33 001436   000000 011000                    NOP     0

      448     4221    3               CU_RECORD = CU.NEXT;

   4221 33 001437   000065 235000 0                  LDA     CU
        33 001440   200101 755100                    STA     CU_RECORD,,AUTO

      449     4222    3               IF ( CU_RECORD > CONTROL.FIRST_NFE_RECORD ) AND FIRST_CROSS_OVER

   4222 33 001441   000076 236000 29                 LDQ     CONTROL+62
        33 001442   200101 116100                    CMPQ    CU_RECORD,,AUTO
        33 001443   001462 603000 33                 TRC     s:4230
        33 001444   200076 234100                    SZN     FIRST_CROSS_OVER,,AUTO
        33 001445   001462 605000 33                 TPL     s:4230

      450     4223    4               THEN DO;

      451     4224    4                   FIRST_CROSS_OVER = '0'B;

   4224 33 001446   200076 450100                    STZ     FIRST_CROSS_OVER,,AUTO

      452     4225    4                   CONTROL.NEXT_AVAILABLE_RECORD = CU_RECORD;
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:66   

   4225 33 001447   000072 755000 29                 STA     CONTROL+58

      453     4226    4                   CALL READSF( CU_RECORD, ADDR(CU)->CHAR_128 );

   4226 33 001450   000045 236000 34                 LDQ     37
        33 001451   200111 756100                    STQ     DT2_R+4,,AUTO
        33 001452   200101 630500                    EPPR0   CU_RECORD,,AUTO
        33 001453   200110 450500                    STP0    DT2_R+3,,AUTO
        33 001454   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001455   000001 631400 34                 EPPR1   1
        33 001456   000000 701000 xent               TSX1    READSF
        33 001457   000000 011000                    NOP     0

      454     4227    4                   CU_RECORD = CU.NEXT;

   4227 33 001460   000065 235000 0                  LDA     CU
        33 001461   200101 755100                    STA     CU_RECORD,,AUTO

      455     4228    4                   END;

      456     4229    3               END;

      457     4230    2           CALL M$DELREC( FPT_DELREC );

   4230 33 001462   000052 630400 0                  EPPR0   FPT_DELREC
        33 001463   040002 713400                    CLIMB   16386
        33 001464   401400 401760                    pmme    nvectors=4

      458     4231    2           END;

   4231 33 001465   200101 235100                    LDA     CU_RECORD,,AUTO
        33 001466   001401 601000 33                 TNZ     s:4210

      459     4232    1       CALL WRIT64(0, BLKPTR);

   4232 33 001467   200007 630500                    EPPR0   BLKPTR,,AUTO
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:67   
        33 001470   200111 450500                    STP0    DT2_R+4,,AUTO
        33 001471   000033 236000 34                 LDQ     27
        33 001472   200110 756100                    STQ     DT2_R+3,,AUTO
        33 001473   200110 630500                    EPPR0   DT2_R+3,,AUTO
        33 001474   000001 631400 34                 EPPR1   1
        33 001475   000000 701000 xent               TSX1    WRIT64
        33 001476   000000 011000                    NOP     0

      460     4233    1       CALL CLOSE_64;

   4233 33 001477   000031 631400 34                 EPPR1   25
        33 001500   000000 701000 xent               TSX1    CLOSE_64
        33 001501   000000 011000                    NOP     0

      461     4234    1       CALL COPY_64;

   4234 33 001502   000031 631400 34                 EPPR1   25
        33 001503   000000 701000 xent               TSX1    COPY_64
        33 001504   000000 011000                    NOP     0

      462     4235    1       RETURN;

   4235 33 001505   000000 702200 xent               TSX2  ! X66_ARET

X
 Sect OctLoc
   0     000   000000 000000                                                    ....

ERASE_COUNT
 Sect OctLoc
   0     001   000000 000000                                                    ....

Y
 Sect OctLoc
   0     003   000000 000031                                                    ....

TYPE_NAME
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:68   
 Sect OctLoc
   0     004   101122 105101   137116 101115   105040 040040   040040 040040    AREA_NAME
   0     010   040040 040040   040040 040040   040040 040040   040040 123105                  SE
   0     014   124137 116101   115105 040040   040040 040040   040040 040040    T_NAME
   0     020   040040 040040   040040 040040   040040 040040   113105 131137                KEY_
   0     024   116101 115105   040040 040040   040040 040040   040040 040040    NAME
   0     030   040040 040040   040040 040040   040040 122105   103117 122104              RECORD
   0     034   137116 101115   105040 040040   040040 040040   040040 040040    _NAME
   0     040   040040 040040   040040 040040   104101 124101   137116 101115            DATA_NAM
   0     044   105040 040040   040040 040040   040040 040040   040040 040040    E
   0     050   040040 040040   040040 ******                                          ..

FPT_DELREC
 Sect OctLoc
   0     052   000001 777640   000062 006000   000000 777640   000125 006000    .....2.......U..
   0     056   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0     062   000000 000000   000000 000000                                    ........

CU
 Sect OctLoc
   0     065   ****** ******   ****** ******   ****** ******   ****** ******    ................

SAVE_CU
 Sect OctLoc
   0     126   ****** ******   ****** ******   ****** ******   ****** ******    ................

TEMP_CU
 Sect OctLoc
   0     166   ****** ******   ****** ******   ****** ******   ****** ******    ................

DESC
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA
 Sect OctLoc
   2     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:69   
   2     004   040040 040040   040040 040040   040040 040040   040040 040040
   2     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
   2     014   040040 040040   040040 040040   040040 040040   040040 040040
   2     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
   2     024   040040 040040   040040 040040   040040 040040   040040 040040
   2     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
   2     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
   2     040   040040 040040   040040 040040   040040 040040   040040 040040
   2     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
   2     050   040040 040040   040040 040040   040040 040040   040040 040040
   2     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
   2     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
   2     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
   2     070   040040 040040   040040 040040   040040 040040   040040 040040
   2     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
   2     104   040040 040040   040040 040040   040040 040040   040040 040040
   2     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
   2     130   040040 040040   040040 040040   040040 040040   040040 040040
   2     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
   2     140   040040 040040   040040 040040   040040 040040   040040 040040
   2     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
   2     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     154   040040 040040   040040 040040   040040 040040   040040 040040
   2     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
   2     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
   2     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
   2     174   040040 040040   040040 040040   040040 040040   040040 040040
   2     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   2     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
   2     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
   2     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   2     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
   2     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:70   
   2     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
   2     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
   2     430   040040 040040   040040 040040   040040 040040   040040 040040
   2     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
   2     440   040040 040040   040040 040040   040040 040040   040040 040040
   2     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
   2     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
   2     460   040040 040040   040040 040040   040040 040040   040040 040040
   2     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
   2     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
   2     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
   2     504   040040 040040   040040 040040   040040 040040   040040 040040
   2     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
   2     524   040040 040040   040040 040040   040040 040040   040040 040040
   2     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
   2     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
   2     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
   2     614   040040 040040   040040 040040   040040 040040   040040 040040
   2     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
   2     624   040040 040040   040040 040040   040040 040040   040040 040040
   2     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   2     664   040040 040040   040040 040040   040040 040040   040040 040040
   2     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   2     700   040040 040040   040040 040040   040040 040040   040040 040040
   2     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   2     714   040040 040040   040040 040040   040040 040040   040040 040040
   2     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
   2     724   040040 040040   040040 040040   040040 040040   040040 040040
   2     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   2     744   040040 040040   040040 040040   040040 040040   040040 040040
   2     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   2    1000   040040 040040   040040 040040   040040 040040   040040 040040
   2    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:71   
   2    1040   040040 040040   040040 040040   040040 040040   040040 040040
   2    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   2    1064   040040 040040   040040 040040   040040 040040   040040 040040
   2    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   2    1120   040040 040040   040040 040040   040040 040040   040040 040040
   2    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   2    1140   040040 040040   040040 040040   040040 040040   040040 040040
   2    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
   2    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
   2    1154   040040 040040   040040 040040   040040 040040   040040 040040
   2    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
   2    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
   2    1170   040040 040040   040040 040040   040040 040040   040040 040040
   2    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   2    1204   040040 040040   040040 040040   040040 040040   040040 040040
   2    1214*  040040 040040   040040 040040   040040 040040   040040 040040

ANALS
 Sect OctLoc
   3     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
   4     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
   5     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
   6     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
   6     024*  ****** ******   ****** ******   ****** ******                    ............

VALIDS
 Sect OctLoc
   7     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:72   

LOCKS
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
   9     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
  10     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
  11     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
 Sect OctLoc
  12     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  20     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  22     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  23     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  25     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  25     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:73   
  25     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  25     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  26     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  26     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  26     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  26     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  26     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  26     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  26     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  26     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  27     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  27     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  27     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  27     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  27     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  27     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  27     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  27     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  28     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  28     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  28     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  28     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  28     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  28     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  28     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  28     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

CONTROL
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:74   
 Sect OctLoc
  29     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
  29     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
  29     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
  29     020*  040040 040040   040040 040040   040040 040040   040040 040040
  29     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
  29     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
  29     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
  29     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  29     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
  29     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
  29     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

FIELD1
 Sect OctLoc
  31     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
  32     000   120125 122107   105040 120122   117103 105123   123117 122040    PURGE PROCESSOR
  32     004   123106 040040   040040 040040   104101 040040   040040 040040    SF      DA
  32     010   104101 055123   116040 040040   040111 123040   116117 124040    DA-SN    IS NOT
  32     014   116101 115105   040117 106040   101123 123111   107116 105104    NAME OF ASSIGNED
  32     020   040123 103110   105115 101040   106111 114105   123116 055114     SCHEMA FILESN-L
  32     024   124040 040040   114113 055114   124040 040040   042116 125114    T   LK-LT   "NUL
  32     030   114042 040040   123101 040040   040040 040040   123101 055104    L"  SA      SA-D
  32     034   104040 040040   060065 060062   061060 060040   104104 040040    D   0502100 DD
  32     040   040040 040040   116117 040104   104114 040117   116040 123103        NO DDL ON SC
  32     044   110105 115101   040106 111114   105040 124117   040120 125122    HEMA FILE TO PUR
  32     050   107105 040040   111104 123062   040105 122122   117122 054040    GE  IDS2 ERROR,
  32     054   055040 104104   114040 116117   124040 120125   122107 105104    - DDL NOT PURGED
  32     060   040111 116040   105116 124111   122105 124131   123103 110105     IN ENTIRETYSCHE
  32     064   115101 040106   111114 105040   104104 114040   120125 122107    MA FILE DDL PURG
  32     070   105104 040040   123101 055104   115040 040040   104115 040040    ED  SA-DM   DM
  32     074   040040 040040   116117 040104   115103 114040   117116 040123        NO DMCL ON S
  32     100   103110 105115   101040 106111   114105 040124   117040 120125    CHEMA FILE TO PU
  32     104   122107 105040   111104 123062   040105 122122   117122 054040    RGE IDS2 ERROR,
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:75   
  32     110   055040 104115   103114 040116   117124 040120   125122 107105    - DMCL NOT PURGE
  32     114   104040 111116   040105 116124   111122 105124   131040 040040    D IN ENTIRETY
  32     120   123103 110105   115101 040106   111114 105040   104115 103114    SCHEMA FILE DMCL
  32     124   040120 125122   107105 104040   123106 055101   104040 040040     PURGED SF-AD
  32     130   060060 040040   062061 040040   101055 104040   040040 040040    00  21  A-D
  32     134   116117 040101   103124 111126   111124 111105   123040 117116    NO ACTIVITIES ON
  32     140   040123 103110   105115 101040   106111 114105   040124 117040     SCHEMA FILE TO
  32     144   120125 122107   105040 040040   111104 123062   040105 122122    PURGE   IDS2 ERR
  32     150   117122 054040   055040 101103   124111 126111   124111 105123    OR, - ACTIVITIES
  32     154   040116 117124   040120 125122   107105 104040   111116 040105     NOT PURGED IN E
  32     160   116124 111122   105124 131040   040101 103124   111126 111124    NTIRETY  ACTIVIT
  32     164   111105 123040   120122 111117   122040 124117   040040 040040    IES PRIOR TO
  32     170   040120 125122   107105 104040   106122 117115   040123 103110     PURGED FROM SCH
  32     174   105115 101040   106111 114105   123106 055101   123040 040040    EMA FILESF-AS
  32     200   101123 040040   040040 040040   116117 040126   101114 111104    AS      NO VALID
  32     204   101124 105104   040123 125102   123103 110105   115101 040122    ATED SUBSCHEMA R
  32     210   105103 117122   104105 104040   117116 040123   103110 105115    ECORDED ON SCHEM
  32     214   101040 106111   114105 040040   111104 123062   040105 122122    A FILE  IDS2 ERR
  32     220   117122 054040   055040 126101   114111 104101   124105 104040    OR, - VALIDATED
  32     224   123125 102123   103110 105115   101123 040116   117124 040120    SUBSCHEMAS NOT P
  32     230   125122 107105   104040 111116   040105 116124   111122 105124    URGED IN ENTIRET
  32     234   131040 040040   040126 101114   111104 101124   105104 040123    Y    VALIDATED S
  32     240   125102 123103   110105 115101   123040 120125   122107 105104    UBSCHEMAS PURGED
  32     244   040106 122117   115040 123103   110105 115101   040106 111114     FROM SCHEMA FIL
  32     250   105040 040040   065052 040040   122105 103117   122104 111116    E   5*  RECORDIN
  32     254   107040 117106   040040 040040   040120 125122   107105 104040    G OF     PURGED
  32     260   106122 117115   040123 103110   105115 101040   106111 114105    FROM SCHEMA FILE
  32     264   040104 111103   124111 117116   101122 131040   040116 117124     DICTIONARY  NOT
  32     270   040106 117125   116104 040111   116040 123103   110105 115101     FOUND IN SCHEMA
  32     274   040106 111114   105040 040040   040116 117124   040120 125122     FILE    NOT PUR
  32     300   107105 104040   106122 117115   040123 103110   105115 101040    GED FROM SCHEMA
  32     304   106111 114105   111114 114105   107101 114040   120122 111126    FILEILLEGAL PRIV
  32     310   101103 131040   113105 131040   106117 122040   101114 124105    ACY KEY FOR ALTE
  32     314   122040 055040   116117 124040   122105 103117   107116 111132    R - NOT RECOGNIZ
  32     320   105104 040101   123040 123125   102123 103110   105115 101040    ED AS SUBSCHEMA
  32     324   106111 114105   056040 040040   040040 040040   040040 040040    FILE.

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:76   
(unnamed)
 Sect OctLoc
  34     000   000001 000000   000002 000000   000000 000002   000004 006000    ................
  34     004   000002 006000   000006 006000   000064 006000   000010 006000    .........4......
  34     010   040040 040040   000023 006000   000025 006000   000447 406000        ............
  34     014   000031 006000   000062 006000   000033 006000   000037 006000    .....2..........
  34     020   000071 006000   000073 006000   000126 006000   000132 006000    .9...;...V...Z..
  34     024   000000 000001   000024 006000   000001 006000   000176 006000    .............~..
  34     030   000200 006000   000000 000000   000251 006000   000031 006000    ................
  34     034   000004 000000   137040 040040   000002 006000   000003 006000    ...._   ........
  34     040   055040 040040   000171 006000   000000 006000   000001 006000    -   .y..........
  34     044   000064 006000   000065 006000   000166 006000   000126 006000    .4...5...v...V..
      463     4236    1   END;

PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:77   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_FIVESTAR_DESC.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PURJ.

   Procedure PURJ requires 838 words for executable code.
   Procedure PURJ requires 76 words of local(AUTO) storage.

    No errors detected in file ZIG$DDS6.:ZIC0TSI    .
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:78   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:79   
          MINI XREF LISTING

A1
      3913**LABEL    3908--GOTO     4118--GOTO
ABORT
      1257**DCL-ENT  4115--CALL
ANS_TIME
      3819**DCL-ENT  4143--CALL
BIT36
        11**DCL      3900>>ASSIGN
BIT36_RDEF
        10**DCL      3900<<ASSIGN   3901>>IF
BLKPTR
        21**DCL      4124<<ASSIGN   4125<>CALL     4182<>CALL     4232<>CALL
C5
      3812**DCL      4021<<ASSIGN   4022<<CALLBLT  4023>>CALLBLT
C64
      3811**DCL      3876<<ASSIGN   3877<>CALL
CHAR_128
      3857**DCL      4148<>CALL     4161<>CALL     4164<>CALL     4199<>CALL     4205<>CALL     4211<>CALL
      4220<>CALL     4226<>CALL
CKACTS
      3983**LABEL    3963--GOTO
CKDMCL
      3948**LABEL    3928--GOTO
CLOSE_64
      3817**DCL-ENT  4183--CALL     4233--CALL
CONTROL
      3124**DCL      4124--ASSIGN
CONTROL.FIRST_CU_RECORD
      3161**DCL      4144>>ASSIGN   4188>>IF       4191>>ASSIGN   4193>>ASSIGN   4194<<ASSIGN
CONTROL.FIRST_NFE_RECORD
      3164**DCL      4174>>IF       4188>>IF       4201>>IF       4213>>IF       4222>>IF
CONTROL.NEXT_AVAILABLE_RECORD
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:80   
      3160**DCL      4177<<ASSIGN   4191<<ASSIGN   4204<<ASSIGN   4216<<ASSIGN   4225<<ASSIGN
CONTROL.SUBSCHEMA_NAME
      3140**DCL      4128>>CALLBLT
CONTROL.TYPE100
      3141**DCL      4126>>IF
CONTROL.TYPE30
      3128**DCL      4126>>IF
COPY_64
      3818**DCL-ENT  4234--CALL
CU
      3828**DCL      4148--CALL     4152>>ASSIGN   4158>>ASSIGN   4199--CALL     4205--CALL     4211--CALL
      4220--CALL     4226--CALL
CU.GTIME.TIME
      3833**DCL      4155>>IF
CU.NEXT
      3829**DCL      4166>>ASSIGN   4200>>ASSIGN   4206>>ASSIGN   4212>>ASSIGN   4221>>ASSIGN   4227>>ASSIGN
CU_RECORD
      3838**DCL      4144<<ASSIGN   4147>>DOWHILE  4148<>CALL     4153>>ASSIGN   4166<<ASSIGN   4179<<ASSIGN
      4193<<ASSIGN   4197>>IF       4199<>CALL     4200<<ASSIGN   4201>>IF       4204>>ASSIGN   4205<>CALL
      4206<<ASSIGN   4209>>DOWHILE  4210>>ASSIGN   4211<>CALL     4212<<ASSIGN   4213>>IF       4216>>ASSIGN
      4218>>IF       4220<>CALL     4221<<ASSIGN   4222>>IF       4225>>ASSIGN   4226<>CALL     4227<<ASSIGN
DBCSERR
      4115**LABEL    3880--CALLALT  3882--CALLALT  3886--CALLALT  3906--CALLALT  3916--CALLALT  3951--CALLALT
      4117--GOTO
DELETE
      4197**LABEL    4180--GOTO
DELETE_ALL_CU
      4187**LABEL    4140--GOTO     4169--GOTO
DEL_REC#
      3840**DCL      3799--DCLINIT  3800--DCLINIT
DEL_REC#.CNT
      3841**DCL      4136<<ASSIGN
DEL_REC#.KEY
      3842**DCL      4210<<ASSIGN
DESC
        36**DCL        37--REDEF      46--REDEF      49--REDEF      54--REDEF
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:81   
DT1.CEN
      3863**DCL      3993<<ASSIGN   3994<<ASSIGN
DT1.DT.YR
      3866**DCL      3992>>IF       3992>>IF
DT1.DT_R
      3864**DCL      3865--REDEF    3990<<ASSIGN
DT1_R
      3861**DCL      3862--REDEF    3999>>IF
DT2.CEN
      3870**DCL      3996<<ASSIGN   3997<<ASSIGN
DT2.DT.YR
      3873**DCL      3995>>IF       3995>>IF
DT2.DT_R
      3871**DCL      3872--REDEF    3991<<ASSIGN
DT2_R
      3868**DCL      3869--REDEF    3999>>IF
ERASE_6
        75**DCL-ENT  3920--CALL     3955--CALL     4001--CALL     4035--CALL     4072--CALL
ERASE_COUNT
        15**DCL      3985<<ASSIGN   4002<<ASSIGN   4002>>ASSIGN   4020<>CALL     4030<<ASSIGN   4036<<ASSIGN
      4036>>ASSIGN   4053<>CALL
ERR
      3807**DCL      4093<<ASSIGN   4100<<ASSIGN   4112>>IF
FCURR_R_6
        78**DCL-ENT  3942--CALL     3977--CALL
FETCHC_6
        74**DCL-ENT  4071--CALL
FETCHD_6
        76**DCL-ENT  3880--CALL     3882--CALL     3916--CALL     3951--CALL
FETCHNS_6
        81**DCL-ENT  3886--CALL     3899--CALL     3986--CALL     4004--CALL
FETCHOS_6
        85**DCL-ENT  3906--CALL
FIELD1.COUNT1
      3814**DCL      4022>>CALLBLT  4022>>CALLBLT  4022>>CALLBLT
FIELD1.TEXT1
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:82   
      3815**DCL      4022>>CALLBLT  4054>>CALLBLT
FINDNS_6
        80**DCL-ENT  3918--CALL     3921--CALL     3953--CALL     3956--CALL     4033--CALL     4037--CALL
FIRST_CROSS_OVER
      3835**DCL      4173<<ASSIGN   4176<<ASSIGN   4187<<ASSIGN   4190<<ASSIGN   4201>>IF       4203<<ASSIGN
      4213>>IF       4215<<ASSIGN   4222>>IF       4224<<ASSIGN
FIRST_CU
      3836**DCL      4146<<ASSIGN   4157<<ASSIGN   4168>>IF
FIRST_SAVE
      3837**DCL      4145<<ASSIGN   4149>>IF       4151<<ASSIGN
FIVESTAREOF
        16**DCL      4062<>CALL     4064>>DOWHILE  4075<>CALL
FPT_DELREC
      3799**DCL      4230<>CALL
FPT_DELREC.V
      3802**DCL      3799--DCLINIT
FPT_DELREC.V.DCB#
      3803**DCL      4135<<ASSIGN
GET_TIME
      1268**DCL-ENT  4109--CALL
L11
      3924**LABEL    3918--CALLALT
L13
      3932**LABEL    3920--CALLALT  3921--CALLALT  3942--CALLALT  3944--CALLALT
L14
      3959**LABEL    3953--CALLALT
L15
      3967**LABEL    3955--CALLALT  3956--CALLALT  3977--CALLALT  3979--CALLALT
L16
      4007**LABEL    3986--CALLALT
L17
      4013**LABEL    4001--CALLALT  4004--CALLALT
L18
      4040**LABEL    4033--CALLALT
L19
      4046**LABEL    4035--CALLALT  4037--CALLALT
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:83   
L20
      4081**LABEL    4071--CALLALT
L21
      4085**LABEL    4072--CALLALT
L30
      4117**LABEL    3899--CALLALT
LIST
      1264**DCL-ENT  3891--CALL     3927--CALL     3935--CALL     3941--CALL     3962--CALL     3970--CALL
      3976--CALL     4009--CALL     4016--CALL     4025--CALL     4042--CALL     4049--CALL     4055--CALL
      4074--CALL     4082--CALL     4086--CALL     4120--CALL     4129--CALL
LK3
         9**DCL      3897<<ASSIGN   3904<<ASSIGN   4118>>IF
LKV
      3810**DCL      3898>>DOWHILE  3909<>CALL
M$DELREC
      3178**DCL-ENT  4230--CALL
MODIFY_6
        79**DCL-ENT  3944--CALL     3979--CALL
MORE
      4062**LABEL    4083--GOTO
NEXT_AVAIL_CU
      3839**DCL      4153<<ASSIGN   4161<>CALL     4162<<ASSIGN   4163>>IF       4164<>CALL     4171>>IF
      4174>>IF       4177>>ASSIGN   4179>>ASSIGN
OL
      3808**DCL      3890<<CALLBLT  3891<>CALL     3926<<ASSIGN   3927<>CALL     3934<<ASSIGN   3935<>CALL
      3940<<ASSIGN   3941<>CALL     3961<<ASSIGN   3962<>CALL     3969<<ASSIGN   3970<>CALL     3975<<ASSIGN
      3976<>CALL     4008<<ASSIGN   4009<>CALL     4015<<ASSIGN   4016<>CALL     4023<<CALLBLT  4025<>CALL
      4041<<ASSIGN   4042<>CALL     4048<<ASSIGN   4049<>CALL     4054<<CALLBLT  4055<>CALL     4073<<CALLBLT
      4074<>CALL     4081<<CALLBLT  4082<>CALL     4085<<CALLBLT  4086<>CALL     4119<<CALLBLT  4120<>CALL
      4128<<CALLBLT  4129<>CALL
PURGE.ALTER_KEY
      1137**DCL      3898>>DOWHILE  4119>>CALLBLT
PURGE.SACTS_RET_DATE
      1136**DCL      3991>>ASSIGN   4023>>CALLBLT  4137>>IF       4143<>CALL
PURGE.SDICT_SSNAMES.ALL
      1133**DCL      4031>>IF
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:84   
PURGE.SDICT_SSNAMES.SSNAMES
      1134**DCL      4059>>IF
PURGE.SNAME
      1138**DCL      3888>>IF       3889>>IF       3890>>CALLBLT
PURGE.TYPE.DDL
      1128**DCL      3913>>IF
PURGE.TYPE.DMCL
      1129**DCL      3948>>IF
PURGE.TYPE.SACTS
      1130**DCL      3983>>IF
PURGE.TYPE.SDICT
      1131**DCL      4028>>IF
PURGE_DESC
        46**DCL      4063<<ASSIGN   4076<<ASSIGN
PURGE_DESC.SS_NAMES
        47**DCL      4065>>CALLBLT  4066--DOWHILE  4067<<CALLBLT  4068>>CALLBLT  4070>>ASSIGN   4073>>CALLBLT
      4081>>CALLBLT  4085>>CALLBLT
READ64
        20**DCL-ENT  4125--CALL
READSF
      3821**DCL-ENT  4148--CALL     4164--CALL     4199--CALL     4205--CALL     4211--CALL     4220--CALL
      4226--CALL
RET
      4083**LABEL    4079--GOTO
SAVE_CU
      3843**DCL      4152<<ASSIGN   4164--CALL
SAVE_CU.NEXT
      3844**DCL      4160>>ASSIGN   4162>>ASSIGN
SET_FIELD_NUM
      1253**DCL-ENT  4020--CALL     4053--CALL
STRE_6
        73**DCL-ENT  4110--CALL
SUBDCB.DCB#
      3827**DCL      4135>>ASSIGN
SUBLST
      1266**DCL-ENT  3877--CALL
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:85   
SUBSCHEMA_KEY
      1284**DCL      1285--REDEF
TEMP_CU
      3850**DCL      4158<<ASSIGN   4161--CALL
TEMP_CU.NEXT
      3851**DCL      4159>>IF       4160<<ASSIGN
UCLOSE
      1273**DCL-ENT  4078--CALL
UGET
      1271**DCL-ENT  4062--CALL     4075--CALL
UNSC
      3809**DCL-ENT  3909--CALL
UOPEN
      1270**DCL-ENT  4061--CALL
UTS
      3820**DCL      4139<<ASSIGN   4143<>CALL     4155>>IF
UWA.AC.CALC_NEXT
       882**DCL       883--REDEF
UWA.AC.CALC_PRIOR
       891**DCL       892--REDEF
UWA.AC.DEFAULTS
       843**DCL       844--REDEF
UWA.AC.FILE_CODE
       848**DCL       849--REDEF
UWA.AC.FLAG1.ERROR_TYPE
       845**DCL       846--REDEF
UWA.AS.SS_NAME
       796**DCL      4070<<ASSIGN
UWA.A_D.AD_DATE
       826**DCL      3990>>ASSIGN   4109<>CALL
UWA.A_D.AD_FUNCTION
       825**DCL      3988>>IF       4107<<ASSIGN
UWA.A_D.AD_IDENT
       827**DCL      4108<<ASSIGN
UWA.DB_STATUS
       774**DCL      3919>>DOWHILE  3924>>IF       3932>>IF       3954>>DOWHILE  3959>>IF       3967>>IF
PL6.E3A0      #001=PURJ File=ZIG$DDS6.:ZIC0TSI                                   FRI 09/05/97 11:50 Page:86   
      3987>>DOWHILE  4007>>IF       4013>>IF       4034>>DOWHILE  4040>>IF       4046>>IF       4117>>IF
UWA.LK.PLVALUE
      1004**DCL      3907>>IF       3909<>CALL
UWA.LT.PLOCKS
      1015**DCL      3900--ASSIGN
UWA.SA.NUMB_DD
      1026**DCL      3943<<ASSIGN
UWA.SA.NUMB_DM
      1027**DCL      3978<<ASSIGN
UWA.SF.DBKEY_DA
       793**DCL      3882<>CALL
UWA.SF.DBKEY_SA
       791**DCL      3916<>CALL     3951<>CALL
UWA.SN.SENAME
      1001**DCL      3889>>IF
UWA.SN.SETYPE
       998**DCL      3884<<ASSIGN   3885>>DOWHILE
W25
        17**DCL      4063>>ASSIGN   4076>>ASSIGN
W25$
        19**DCL        17--IMP-PTR  4062<>CALL     4063>>ASSIGN   4075<>CALL     4076>>ASSIGN
WRIT64
      3816**DCL-ENT  4182--CALL     4232--CALL
WRITSF
      3822**DCL-ENT  4161--CALL
WR_AD_RECORD
      4098**LABEL    4094--GOTO
WR_DBCSERR
      4085**LABEL    3936--GOTO     3971--GOTO     4017--GOTO     4050--GOTO     4087--GOTO
X
        14**DCL      4065<<CALLBLT  4066>>DOWHILE  4067>>CALLBLT  4068<<CALLBLT
Y
        22**DCL      4062<>CALL     4075<>CALL
