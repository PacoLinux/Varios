VERSION E05

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:1    
        1        1        /*M* JPB$EVENT Event receiver for the PRESCAN ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         JPB$EVENT
       10       10             PURPOSE:      To receive EVENTs for the PRESCAN ghost
       11       11        */
       12       12        /**/
       13       13        /*F* NAME:         JPB$EVENT
       14       14             PURPOSE:      To receive EVENTs for the PRESCAN ghost
       15       15             DESCRIPTION:  Enter here asynchronously when an event
       16       16                           occurs.
       17       17
       18       18                           The event ID (JP_XXXX#) in the TCB frame
       19       19                           tells us what kind of event it is.
       20       20
       21       21                           Based on this, the appropriate action is
       22       22                           taken.  Currently, all event processing
       23       23                           takes place at the event level, that is
       24       24                           within this routine.
       25       25        */
       26       26        JPB$EVENT: PROC ASYNC;
       27       27
       28       28
       29       29
       30       30        /**/
       31       31        /* INCLUDES */
       32       32        /**/
       33       33        %INCLUDE CP_6;
       34      114        %INCLUDE JP_MACRO_C;
       35      269        %INCLUDE JP_SUBS_C;
       36      294        %INCLUDE OC_SUBS_C;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:2    
       37     1025        %INCLUDE OC_MESSHD_C;
       38     1078        %INCLUDE FOS_SUBS_C;
       39     1095        %INCLUDE JP_SCODE_C;
       40     1111        %INCLUDE IR_DATA_M;
       41     1275        %INCLUDE JG_EVID_C;
       42     1500        %INCLUDE FOO_MAC_C;
       43     2248        %INCLUDE UE_ERRORS_C;
       44     2266        %INCLUDE AS_SUPER_C;
       45     2701        %INCLUDE KL_SUPER_C;
       46     5603        %INCLUDE JP_DATA_R;
       47     6148
       48     6149
       49     6150
       50     6151        /**/
       51     6152        /* BASED STRUCTURES */
       52     6153        /**/
       53     6154        %B$NWIO;
       54     6239        %JP_CITE (FPTN=JP$CITE,TYP=JOB,STCLASS=BASED);
       55     6271        %JP_KEYIN (FPTN=JP$KEYIN,STCLASS=BASED);
       56     6298        %JP$JOB;
       57     6308    1   DCL B$$CHARS CHAR(I) BASED CALIGNED;
       58     6309
       59     6310
       60     6311
       61     6312        /**/
       62     6313        /* AUTO */
       63     6314        /**/
       64     6315    1   DCL EVENT UBIN WORD;
       65     6316    1   DCL 1 EVNT REDEF EVENT,
       66     6317    1         2 * UBIN HALF HALIGNED,
       67     6318    1         2 EVID UBIN HALF HALIGNED;
       68     6319    1   DCL STK$ PTR;
       69     6320    1   DCL I UBIN;
       70     6321    1   DCL RENV UBIN WORD;
       71     6322    1   DCL P$ PTR;
       72     6323    1   DCL JOB$ PTR;
       73     6324    1   DCL CITE$ PTR;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:3    
       74     6325    1   DCL KEYIN$ REDEF CITE$ PTR;
       75     6326
       76     6327
       77     6328
       78     6329        /**/
       79     6330        /* CONSTANT */
       80     6331        /**/
       81     6332        %VLP_ACCT (FPTN=JDACCT,ACCT=':SYSTAC',STCLASS=CONSTANT);
       82     6345    1   DCL STARS CHAR(80) CONSTANT ALIGNED INIT('*'*0);
       83     6346    1   DCL COMMENT CHAR(80) CONSTANT ALIGNED INIT
       84     6347    1        (' FIRST THE RECORD THAT PRESCAN DIDN''T LIKE, THEN THE FILE ');
       85     6348        %JP_CITE (FPTN=JP_BTON,COD=JPEV_JPGO#,STCLASS=CONSTANT);
       86     6380        %JP_CITE (FPTN=JP_OPFB,COD=JPEV_OPFB#,STCLASS=CONSTANT);
       87     6412        %JP_CITE (FPTN=JP_CNCL,COD=JPEV_NOP# ,STCLASS=CONSTANT);
       88     6444        %JP_CITE (FPTN=JP_SUSR,COD=JPEV_SUSR#,STCLASS=CONSTANT);
       89     6476        %VLP_STATION (FPTN=MYSTA,STATION='PRESCAN',STCLASS=CONSTANT);
       90     6503
       91     6504
       92     6505
       93     6506        /**/
       94     6507        /* STATIC */
       95     6508        /**/
       96     6509    1   DCL DEEP SBIN STATIC INIT(0);
       97     6510    1   DCL NEED2READ SBIN STATIC INIT(0);
       98     6511    1   DCL XCON UBIN WORD STATIC INIT(0);
       99     6512        %VLP_NAME (FPTN=JDNAME,NAME=':JPVVVBNNN',STCLASS=STATIC);
      100     6539        %RV_DFNAME (NAME=RV_DFNAME,STCLASS=STATIC);
      101     6543    1   DCL EIBUF CHAR(512) STATIC ALIGNED INIT(' ');
      102     6544        %OC_MESSHD_D            (NAME=OPMSG_UNIMP,
      103     6545                 NPARMS    = 0,
      104     6546                 MSG       = UNIMP_MSG#,
      105     6547                 DELIM     =";",
      106     6548                 STCLASS   = STATIC);
      107     6561        %OC_MESSHD_D                          (NAME=OPMSG_NTBL,
      108     6562                 NPARMS    = 2,
      109     6563                 ATR       = M_SYS,
      110     6564                 MSG       = JP_ERR_MSG#,
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:4    
      111     6565                 STCLASS   = STATIC);
      112     6578    1         2 * UBIN BYTE UNAL INIT(1),
      113     6579    1         2 * UBIN BYTE UNAL INIT(2),
      114     6580    1         2 CODE UBIN BYTE UNAL INIT(JPKE_NSLOT#),
      115     6581    1         2 LSYSID UBIN HALF UNAL;
      116     6582
      117     6583
      118     6584
      119     6585        /**/
      120     6586        /* DCBS */
      121     6587        /**/
      122     6588    1   DCL M$JD DCB;
      123     6589
      124     6590
      125     6591
      126     6592        /**/
      127     6593        /* FPTS */
      128     6594        /**/
      129     6595        %FPT_WRITE                            (FPTN=OCMSG_UNIMP,
      130     6596                 DCB       = M$CG,
      131     6597                 BUF       = OPMSG_UNIMP,
      132     6598                 STCLASS   = CONSTANT);
      133     6629        %FPT_WRITE                            (FPTN=OCMSG_NTBL,
      134     6630                 DCB       = M$CG,
      135     6631                 BUF       = OPMSG_NTBL);
      136     6662        %FPT_READ                             (FPTN=READ_CSCG,
      137     6663                 DCB       = M$CG,
      138     6664                 BUF       = JP_CSCGBUF,
      139     6665                 WAIT      = NO,
      140     6666                 EVENT     = JP_CSRD#,
      141     6667                 STCLASS   = CONSTANT);
      142     6706        %FPT_JOBSTATS                         (FPTN=UNMAP,
      143     6707                 ORDER     = REMAP,
      144     6708                 BUF       = NIL,
      145     6709                 STATSEG   = FOSS_PREHDR#,
      146     6710                 STCLASS   = CONSTANT);
      147     6730        %FPT_PFIL                             (FPTN=REW,
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:5    
      148     6731                 DCB       = M$EI,
      149     6732                 BOF       = YES,
      150     6733                 STCLASS   = CONSTANT);
      151     6748        %FPT_OPEN                             (FPTN=OPENJD,
      152     6749                 DCB       = M$JD,
      153     6750                 ASN       = FILE,
      154     6751                 ORG       = CONSEC,
      155     6752                 FUN       = CREATE,
      156     6753                 EXIST     = NEWFILE,
      157     6754                 NAME      = JDNAME,
      158     6755                 ACCT      = JDACCT,
      159     6756                 STCLASS   = CONSTANT);
      160     6865        %FPT_CLOSE                            (FPTN=CLSJD,
      161     6866                 DCB       = M$JD,
      162     6867                 DISP      = SAVE,
      163     6868                 STCLASS   = CONSTANT);
      164     6910        %FPT_READ                             (FPTN=READEI,
      165     6911                 DCB       = M$EI,
      166     6912                 WAIT      = YES,
      167     6913                 BUF       = EIBUF,
      168     6914                 STCLASS   = CONSTANT);
      169     6953        %FPT_WRITE                            (FPTN=WRITEJD,
      170     6954                 DCB       = M$JD,
      171     6955                 WAIT      = YES,
      172     6956                 BUF       = NIL,
      173     6957                 STCLASS   = STATIC);
      174     6988        %FPT_CLOSE                            (FPTN=CLSEI,
      175     6989                 DCB       = M$EI,
      176     6990                 DISP      = RELEASE,
      177     6991                 STCLASS   = CONSTANT);
      178     7033        %FPT_WRITE                            (FPTN=WRITESTARS,
      179     7034                 DCB       = M$JD,
      180     7035                 WAIT      = YES,
      181     7036                 BUF       = STARS,
      182     7037                 STCLASS   = CONSTANT);
      183     7068        %FPT_WRITE                            (FPTN=WRITECOMMENT,
      184     7069                 DCB       = M$JD,
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:6    
      185     7070                 WAIT      = YES,
      186     7071                 BUF       = STARS,
      187     7072                 STCLASS   = CONSTANT);
      188     7103        %FPT_WRITE                            (FPTN=WRITELINE,
      189     7104                 DCB       = M$JD,
      190     7105                 WAIT      = YES,
      191     7106                 BUF       = NIL,
      192     7107                 STCLASS   = STATIC);
      193     7138        %FPT_WRITE                            (FPTN=WRITESUSR,
      194     7139                 DCB       = M$CG,
      195     7140                 BUF       = JP_SUSR,
      196     7141                 STATION   = MYSTA,
      197     7142                 STCLASS   = CONSTANT);
      198     7173        %FPT_WRITE                            (FPTN=WRITEBTON,
      199     7174                 DCB       = M$CG,
      200     7175                 BUF       = JP_BTON,
      201     7176                 STATION   = MYSTA,
      202     7177                 STCLASS   = CONSTANT);
      203     7208        %FPT_WRITE                            (FPTN=WRITEOPFB,
      204     7209                 DCB       = M$CG,
      205     7210                 BUF       = JP_OPFB,
      206     7211                 STATION   = MYSTA,
      207     7212                 STCLASS   = CONSTANT);
      208     7243        %FPT_WRITE                            (FPTN=WRITECNCL,
      209     7244                 DCB       = M$CG,
      210     7245                 BUF       = JP_CNCL,
      211     7246                 STATION   = MYSTA,
      212     7247                 STCLASS   = CONSTANT);
      213     7278
      214     7279
      215     7280
      216     7281        /**/
      217     7282        /* ENTREFS */
      218     7283        /**/
      219     7284    1   DCL FOI$CRASH     ENTRY(3) ALTRET;
      220     7285    1   DCL FOI$GBUF      ENTRY(2) ALTRET;
      221     7286    1   DCL FOI$LDTRC     ENTRY(4) ALTRET;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:7    
      222     7287    1   DCL FOI$RBUF      ENTRY(2) ALTRET;
      223     7288    1   DCL FOI$SNAP      ENTRY(4) ALTRET;
      224     7289
      225     7290
      226     7291
      227     7292        /**/
      228     7293        /* SYMREFS */
      229     7294        /**/
      230     7295        %FO_SCB (FPTN=JP_JOBSCB,STCLASS=SYMREF);
      231     7325        %JP$Q (NAME=JP_Q,STCLASS=SYMREF);
      232     7356
      233     7357
      234     7358
      235     7359        /**/
      236     7360        /* SUBS */
      237     7361        /**/
      238     7362        %SUB F_JP='1220'O;
      239     7363        %SUB M_B='02'O;
      240     7364        %SUB FOREVER="WHILE ('1'B)";
      241     7365        %SUB B$ERRCODE=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      242     7366        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:8    
      243     7367        /**/
      244     7368        /* BEGIN HERE */
      245     7369        /**/
      246     7370    2           DO INHIBIT;
      247     7371    2           STK$=B$TCB$->B$TCB.STK$;
      248     7372    2           RENV=0;
      249     7373    2           DEEP=DEEP+1;
      250     7374    2           CALL SENV;
      251     7375    2           EVENT=STK$->B$NWIO.EVID;
      252     7376    3             DO CASE (EVNT.EVID);
      253     7377        /***
      254     7378         ***
      255     7379         ***          CSCG READ COMPLETE
      256     7380         ***
      257     7381         ***/
      258     7382    3               CASE (JP_CSRD#);
      259     7383                     /*    Messages received by PRESCAN thru
      260     7384                      *    the CSCG are either from KEYIN
      261     7385                      *    (in which case they are keyins),
      262     7386                      *    or are framed by JP_CITE.
      263     7387                      */
      264     7388    3                 NEED2READ=1;
      265     7389    3                 IF STK$->B$NWIO.ERR THEN
      266     7390    4                   DO;
      267     7391    4                   CALL FOI$SNAP (%S$JPCSCG,F_JP,M_B);
      268     7392        /*S* SCREECH_CODE: JPB-S$JPCSCG
      269     7393             TYPE:         SNAP
      270     7394             MESSAGE:      PRESCAN error reading CSCG
      271     7395             REMARKS:      When PRESCAN gets an error in his no-wait I/O
      272     7396                           event from a read of CSCG, he just issues this
      273     7397                           snap and marches on. */
      274     7398    4                   END;
      275     7399    3                 ELSE
      276     7400    4                   DO; /* READ OK */
      277     7401        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:9    
      278     7402    4                   IF STK$->B$NWIO.CGPARM.STATION# = 'KEYIN' THEN
      279     7403    5                     DO; /* KEYIN */
      280     7404        /**
      281     7405         **
      282     7406         **      KEYIN
      283     7407         **
      284     7408         **
      285     7409         **/
      286     7410    5                     KEYIN$=ADDR(JP_CSCGBUF);
      287     7411    6                       DO CASE (KEYIN$->JP$KEYIN.KIN#);
      288     7412
      289     7413    6                         CASE (KEY_ZAP#);
      290     7414    6                           JP_GOODNGT=1;
      291     7415
      292     7416    6                         CASE (ELSE);
      293     7417    6                           OPMSG_UNIMP.CADDR=KEYIN$->JP$KEYIN.CADDR;
      294     7418    6                           CALL M$WRITE (OCMSG_UNIMP);
      295     7419
      296     7420    6                       END;
      297     7421    5                     END; /* KEYIN */
      298     7422    4                   ELSE
      299     7423    5                     DO; /* EVENT */
      300     7424        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:10   
      301     7425        /**
      302     7426         **
      303     7427         **      EVENT
      304     7428         **
      305     7429         **/
      306     7430
      307     7431    5                     CITE$=ADDR(JP_CSCGBUF);
      308     7432    6                       DO CASE (CITE$->JP$CITE.CODE);
      309     7433
      310     7434        /**
      311     7435         **      NOP EVENT
      312     7436         **/
      313     7437    6                         CASE (JPEV_NOP#);
      314     7438
      315     7439        /**
      316     7440         **      !BATCH ON   /   !BATCH OFF
      317     7441         **/
      318     7442    6                         CASE (JPEV_JPGO#);
      319     7443    6                           JP_NOGO.BATCHON=BINBIT(CITE$->JP$CITE.GO,1);
      320     7444        /**
      321     7445         **      OPEN FOR BUSINESS (FROM SLUG STARTUP PHASE DONE)
      322     7446         **/
      323     7447    6                         CASE (JPEV_OPFB#);
      324     7448    6                           JP_NOGO.OPFB='0'B;
      325     7449        /**
      326     7450         **      OK TO START USERS
      327     7451         **/
      328     7452    6                         CASE (JPEV_SUSR#);
      329     7453    6                           JP_NOGO.SUSR='0'B;
      330     7454        /**
      331     7455         **      MBS ACK (JOB RECEIVED)
      332     7456         **/
      333     7457    6                         CASE (JPEV_JACK#);
      334     7458                     /*    Remove the job from the
      335     7459                      *    'scanned' list
      336     7460                      */
      337     7461    6                           CALL FINDJOB (JP_Q.SCAN$) ALTRET(ACK1);
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:11   
      338     7462    6                           IF JOB$->JP$JOB.SCANNING THEN GOTO ACK1;
      339     7463    6                           IF P$ = ADDR(NIL) THEN
      340     7464    6                            JP_Q.SCAN$=JOB$->JP$JOB.LNK$;
      341     7465    6                           ELSE P$->JP$JOB.LNK$=JOB$->JP$JOB.LNK$;
      342     7466    6                           CALL FOI$RBUF (JP_JOBSCB,JOB$);
      343     7467    6                           GOTO DUN;
      344     7468                     /*    Did not find
      345     7469                      *    it.
      346     7470                      */
      347     7471    6   ACK1:                   CALL FOI$SNAP (%S$JPBACK,F_JP,M_B);
      348     7472        /*S* SCREECH_CODE: JPB-S$JPBACK
      349     7473             TYPE:         SNAP
      350     7474             MESSAGE:      MBS acked unknown SYSID to PRESCAN
      351     7475             REMARKS:      MBS is acnowleging receipt of a job which
      352     7476                           PRESCAN cannot find in his tables. */
      353     7477    6   DUN:                    ;
      354     7478        /**
      355     7479         **      ADD NEW JOB (TO BE PRESCANNED)
      356     7480         **/
      357     7481    6                         CASE (JPEV_NEWF#);
      358     7482                     /*    Ignore
      359     7483                      *    if added
      360     7484                      *    twice
      361     7485                      */
      362     7486    6                           CALL FINDJOB (JP_Q.SCAN$) ALTRET(ADD1);
      363     7487    6                           GOTO NDUN;
      364     7488    6   ADD1:                   CALL FINDJOB (JP_Q.HEAD$) ALTRET(ADD2);
      365     7489    6                           GOTO NDUN;
      366     7490    6   ADD2:                   IF JP_Q.FREE$ ~= ADDR(NIL) THEN
      367     7491    7                             DO;
      368     7492    7                             JOB$=JP_Q.FREE$;
      369     7493    7                             JP_Q.FREE$=JOB$->JP$JOB.LNK$;
      370     7494    7                             END;
      371     7495    6                           ELSE
      372     7496    6                            CALL FOI$GBUF (JP_JOBSCB,JOB$) ALTRET(NOFRAMES);
      373     7497    6                           JOB$->JP$JOB.SYSID=CITE$->JP$CITE.SYSID;
      374     7498    6                           IF JP_Q.TAIL$ ~= ADDR(NIL) THEN
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:12   
      375     7499    6                            JP_Q.TAIL$->JP$JOB.LNK$=JOB$;
      376     7500    6                           ELSE JP_Q.HEAD$=JOB$;
      377     7501    6                           JP_Q.TAIL$=JOB$;
      378     7502    6                           JOB$->JP$JOB.LNK$=ADDR(NIL);
      379     7503    6                           GOTO NDUN;
      380     7504    6   NOFRAMES:               ;
      381     7505    6                           IF JP_NJFR = 0 THEN
      382     7506    7                             DO;
      383     7507    7                             CALL FOI$SNAP (%S$JPNJFR,F_JP,M_B);
      384     7508        /*S* SCREECH_CODE: JPB-S$JPNJFR
      385     7509             TYPE:         SNAP
      386     7510             MESSAGE:      PRESCAN can't get dynamic space for this job
      387     7511             REMARKS:      PRESCAN's job data segment cannot be expanded
      388     7512                           sufficiently to hold this job.  The job is
      389     7513                           lost until the next boot.  This should not
      390     7514                           happen unless there is something wrong with
      391     7515                           PRESCAN.
      392     7516
      393     7517                           This snap happens only once per boot.  Thereafter
      394     7518                           we just throw away the jobs.  Each occurance of
      395     7519                           this is accompanied by a message on the SYS
      396     7520                           console(s), identifying the job which has been
      397     7521                           ignored. */
      398     7522    7                             JP_NJFR=1;
      399     7523    7                             END;
      400     7524    6                           OPMSG_NTBL.LSYSID=CITE$->JP$CITE.SYSID;
      401     7525    6                           CALL M$WRITE (OCMSG_NTBL);
      402     7526    6   NDUN:                   ;
      403     7527
      404     7528    6                       END;
      405     7529    5                     END; /* EVENT */
      406     7530    4                   END; /* READ OK */
      407     7531
      408     7532
      409     7533        /***
      410     7534         ***
      411     7535         ***          UNKNOWN EVENT CODE
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:13   
      412     7536         ***
      413     7537         ***/
      414     7538    3               CASE (ELSE);
      415     7539    3                 CALL FOI$SNAP (%S$JPBDEV,F_JP,M_B);
      416     7540        /*S* SCREECH_CODE: JPB-S$JPBDEV
      417     7541             TYPE:         SNAP
      418     7542             MESSAGE:      Unknown event passed to PRESCAN
      419     7543             REMARKS:      PRESCAN's event routine has been passed an
      420     7544                           unknown external event.  It has been ignored. */
      421     7545
      422     7546    3             END; /* CASE EVID */
      423     7547        /**/
      424     7548    3             DO WHILE (JP_Q.FREE$ ~= ADDR(NIL));
      425     7549    3             JOB$=JP_Q.FREE$;
      426     7550    3             JP_Q.FREE$=JOB$->JP$JOB.LNK$;
      427     7551    3             CALL FOI$RBUF (JP_JOBSCB,JOB$);
      428     7552    3             END;
      429     7553        /**/
      430     7554
      431     7555                     /*         EXIT here, restoring
      432     7556                      *         the TCB ALTRET frame
      433     7557                      *         if nescessary.
      434     7558                      */
      435     7559    2           IF RENV ~= 0 THEN CALL M$RENV;
      436     7560        /**/
      437     7561    2           IF DEEP = 1 THEN
      438     7562    3             DO WHILE (NEED2READ ~= 0);
      439     7563    3             NEED2READ=0;
      440     7564    3             IF XCON+JP_GOODNGT = 0 THEN
      441     7565    3              CALL M$READ (READ_CSCG);
      442     7566    3             END;
      443     7567    2           DEEP=DEEP-1;
      444     7568    2           RETURN;
      445     7569    2           END; /* INHIBIT */
      446     7570        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:14   
      447     7571        /**/
      448     7572        /*F* NAME:         JPB$XCON
      449     7573             PURPOSE:      To receive exit control for PRESCAN
      450     7574             DESCRIPTION:  A SNAP dump is generated.  If the jcl file DCB
      451     7575                           is open, then we will copy the file out of
      452     7576                           :SYMI into :JPVERNNN.:SYSTAC, where 'VERNNN'
      453     7577                           is the part of the name of the dumpfile we
      454     7578                           just created by the snap (:DFVERNNN).
      455     7579
      456     7580                           When this is done we LDTRC to ourselves. */
      457     7581    1   JPB$XCON: ENTRY ASYNC;
      458     7582        /**/
      459     7583    1         XCON=XCON+1;
      460     7584    1         CALL FOI$SNAP (%S$JPABORT,F_JP,M_B,RV_DFNAME) ALTRET(NODUMP);
      461     7585        /*S* SCREECH_CODE: JPB-S$JPABORT
      462     7586             TYPE:         SNAP
      463     7587             MESSAGE:      PRESCAN has aborted
      464     7588             REMARKS:      PRESCAN will write the offending input file
      465     7589                           (if any) from :SYMI to :SYSTAC under the name
      466     7590                           :JPVERNNN where VERNNN is from the name of
      467     7591                           the SNAP dump file :DFVERNNN.  The :SYMI file
      468     7592                           will be deleted, and PRESCAN will LDTRC to
      469     7593                           itself. */
      470     7594    1         CALL DUMPJCL;
      471     7595    1   NODUMP:;
      472     7596                          /*    Write the current on/off bits
      473     7597                           *    as messages to us on CSCG.
      474     7598                           *    We'll pick them up when we
      475     7599                           *    come around.  First send
      476     7600                           *    a NOP event, to cancel the
      477     7601                           *    outstanding read.
      478     7602                           */
      479     7603    1         CALL M$WRITE (WRITECNCL) ALTRET(MARCHON);
      480     7604    1   MARCHON:;
      481     7605    1         IF NOT JP_NOGO.BATCHON THEN
      482     7606    1          CALL M$WRITE (WRITEBTON) ALTRET(WHOCARES);
      483     7607    1   WHOCARES:;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:15   
      484     7608    1         IF NOT JP_NOGO.SUSR THEN
      485     7609    1          CALL M$WRITE (WRITESUSR) ALTRET(WHOCARES0);
      486     7610    1   WHOCARES0:;
      487     7611    1         IF NOT JP_NOGO.OPFB THEN
      488     7612    1          CALL M$WRITE (WRITEOPFB) ALTRET(WHOCARES1);
      489     7613    1   WHOCARES1:;
      490     7614    1         CALL M$JOBSTATS (UNMAP) ALTRET(LDTRC);
      491     7615    1   LDTRC:;
      492     7616    1         CALL FOI$LDTRC (,,,'PRESCAN ');
      493     7617        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:16   
      494     7618        /********************************************************
      495     7619        *********************************************************/
      496     7620        /*D* NAME:         SENV
      497     7621             PURPOSE:      To save the TCB ALTRET frame via M$SENV
      498     7622        */
      499     7623    1   SENV: PROC;
      500     7624    2         CALL M$SENV ALTRET(NOSENV);
      501     7625    2         RENV=1;
      502     7626    2         RETURN;
      503     7627    2   NOSENV:;
      504     7628    2         IF B$ERRCODE = %E$ALTEMPTY THEN RETURN;
      505     7629    2         CALL M$MERC;
      506     7630    2         RETURN;
      507     7631    2   END SENV;
      508     7632        /********************************************************
      509     7633        *********************************************************/
      510     7634        /*D* NAME:         FINDJOB
      511     7635             PURPOSE:      To find the job frame for the sysid
      512     7636                           in CITE$->JP$CITE.SYSID
      513     7637             DESCRIPTION:  ALTRETs if not found; else returns
      514     7638                           JOB$ pointing to the job frame,
      515     7639                           and P$ to its blink (or NIL if JOB$ is head).
      516     7640                           HEAD$ is the head pointer of the
      517     7641                           list to be searched. */
      518     7642    1   FINDJOB: PROC (HEAD$) ALTRET;
      519     7643        /**/
      520     7644    2   DCL HEAD$ PTR;
      521     7645        /**/
      522     7646    2         JOB$=HEAD$;
      523     7647    2         P$=ADDR(NIL);
      524     7648    3           DO WHILE (JOB$ ~= ADDR(NIL));
      525     7649    3           IF JOB$->JP$JOB.SYSID = CITE$->JP$CITE.SYSID THEN RETURN;
      526     7650    3           P$=JOB$;
      527     7651    3           JOB$=JOB$->JP$JOB.LNK$;
      528     7652    3           END;
      529     7653    2         ALTRETURN;
      530     7654    2   END FINDJOB;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:17   
      531     7655        /********************************************************
      532     7656        *********************************************************/
      533     7657        /*D* NAME:         DUMPJCL
      534     7658             PURPOSE:      To dump the current JCL file into :SYSTAC
      535     7659             DESCRIPTION:  A SNAP dump has already been taken.
      536     7660                           If the :SYMI file DCB is open, then we
      537     7661                           copy the file into :SYSTAC and delete
      538     7662                           it from :SYMI. */
      539     7663    1   DUMPJCL: PROC ALTRET;
      540     7664        /**/
      541     7665    2   DCL DCB$ PTR;
      542     7666        /**/
      543     7667    2         DCB$=DCBADDR(DCBNUM(M$EI));
      544     7668    2         IF DCB$->F$DCB.FCD# = '0'B THEN RETURN;
      545     7669    2         CALL CONCAT (JDNAME.NAME#,':JP',RV_DFNAME.MONID4,RV_DFNAME.DUMPC);
      546     7670    2         CALL M$OPEN (OPENJD) ALTRET(ALTRT);
      547     7671    2         IF XCON < 1 THEN
      548     7672                                /* Don't try this more than once */
      549     7673    3           DO;
      550     7674    3           CALL M$WRITE (WRITESTARS) ALTRET(DONE);
      551     7675    3           CALL M$WRITE (WRITECOMMENT) ALTRET(DONE);
      552     7676    3           I=DCB$->F$DCB.ARS#;
      553     7677    3           IF I = 0 THEN WRITELINE.BUF_=VECTOR(NIL);
      554     7678    3           ELSE WRITELINE.BUF_=VECTOR(READ_CARD.BUF_.BUF$->B$$CHARS);
      555     7679    3           CALL M$WRITE (WRITELINE) ALTRET(DONE);
      556     7680    3           CALL M$WRITE (WRITESTARS) ALTRET(DONE);
      557     7681    3           END;
      558     7682    2         CALL M$PFIL (REW) ALTRET (DONE);
      559     7683    3           DO FOREVER;
      560     7684    3           CALL M$READ (READEI) ALTRET(DONE);
      561     7685    3           I=DCB$->F$DCB.ARS#;
      562     7686    3           WRITEJD.BUF_=VECTOR(ADDR(EIBUF)->B$$CHARS);
      563     7687    3           CALL M$WRITE (WRITEJD) ALTRET(DONE);
      564     7688    3           END;
      565     7689    2   DONE: CALL M$CLOSE (CLSJD) ALTRET(D1);
      566     7690    2   D1:   CALL M$CLOSE (CLSEI) ALTRET(D2);
      567     7691    2   D2:   RETURN;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:18   
      568     7692    2   ALTRT:;
      569     7693    2         ALTRETURN;
      570     7694    2   END DUMPJCL;
      571     7695    1   END JPB$EVENT;

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:19   
--  Include file information  --

   JP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   UE_ERRORS_C.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   JP_SCODE_C.:E05TOU  is referenced.
   FOS_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   JP_SUBS_C.:E05TOU  is referenced.
   JP_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JPB$EVENT.

   Procedure JPB$EVENT requires 388 words for executable code.
   Procedure JPB$EVENT requires 16 words of local(AUTO) storage.

    No errors detected in file JPB$EVENT.:E05TSI    .

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:20   

 Object Unit name= JPB$EVENT                                  File name= JPB$EVENT.:E05TOU
 UTS= JUL 29 '97 23:33:56.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   DCB   even  none     0      0  M$EI
    3   DCB   even  none     0      0  M$LO
    4   DCB   even  none     0      0  M$JOBSTAT
    5   DCB   even  none     0      0  M$HLP
    6   DCB   even  none     0      0  M$USERS
    7  RoData even  UTS    337    521  JPB$EVENT
    8   Data  even  none   186    272  JPB$EVENT
    9   DCB   even  none     0      0  M$JD
   10   Proc  even  none   388    604  JPB$EVENT
   11  RoData even  none    35     43  JPB$EVENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes            yes     Async       0  JPB$EVENT
    10    322                  yes     Async       0  JPB$XCON
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:21   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 FOI$GBUF
 yes     yes           Std       4 FOI$SNAP
 yes     yes           Std       4 FOI$LDTRC
 yes     yes           Std       2 FOI$RBUF
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  READ_CARD                        r    B$TCB$
     M$CG                                  M$EI                                  M$LO
     M$JOBSTAT                             M$HLP                                 M$USERS
     JP_CSCGBUF                            JP_NOGO                               JP_GOODNGT
     JP_NJFR                               ES$                                   M$JD
     JP_JOBSCB                             JP_Q                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:22   


        1        1        /*M* JPB$EVENT Event receiver for the PRESCAN ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         JPB$EVENT
       10       10             PURPOSE:      To receive EVENTs for the PRESCAN ghost
       11       11        */
       12       12        /**/
       13       13        /*F* NAME:         JPB$EVENT
       14       14             PURPOSE:      To receive EVENTs for the PRESCAN ghost
       15       15             DESCRIPTION:  Enter here asynchronously when an event
       16       16                           occurs.
       17       17
       18       18                           The event ID (JP_XXXX#) in the TCB frame
       19       19                           tells us what kind of event it is.
       20       20
       21       21                           Based on this, the appropriate action is
       22       22                           taken.  Currently, all event processing
       23       23                           takes place at the event level, that is
       24       24                           within this routine.
       25       25        */
       26       26        JPB$EVENT: PROC ASYNC;

     26 10 000000   000000 700200 xent  JPB$EVENT    TSX0  ! X66_AAUTO
        10 000001   000020 000000                    ZERO    16,0

       27       27
       28       28
       29       29
       30       30        /**/
       31       31        /* INCLUDES */
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:23   
       32       32        /**/
       33       33        %INCLUDE CP_6;
       34      114        %INCLUDE JP_MACRO_C;
       35      269        %INCLUDE JP_SUBS_C;
       36      294        %INCLUDE OC_SUBS_C;
       37     1025        %INCLUDE OC_MESSHD_C;
       38     1078        %INCLUDE FOS_SUBS_C;
       39     1095        %INCLUDE JP_SCODE_C;
       40     1111        %INCLUDE IR_DATA_M;
       41     1275        %INCLUDE JG_EVID_C;
       42     1500        %INCLUDE FOO_MAC_C;
       43     2248        %INCLUDE UE_ERRORS_C;
       44     2266        %INCLUDE AS_SUPER_C;
       45     2701        %INCLUDE KL_SUPER_C;
       46     5603        %INCLUDE JP_DATA_R;
       47     6148
       48     6149
       49     6150
       50     6151        /**/
       51     6152        /* BASED STRUCTURES */
       52     6153        /**/
       53     6154        %B$NWIO;
       54     6239        %JP_CITE (FPTN=JP$CITE,TYP=JOB,STCLASS=BASED);
       55     6271        %JP_KEYIN (FPTN=JP$KEYIN,STCLASS=BASED);
       56     6298        %JP$JOB;
       57     6308    1   DCL B$$CHARS CHAR(I) BASED CALIGNED;
       58     6309
       59     6310
       60     6311
       61     6312        /**/
       62     6313        /* AUTO */
       63     6314        /**/
       64     6315    1   DCL EVENT UBIN WORD;
       65     6316    1   DCL 1 EVNT REDEF EVENT,
       66     6317    1         2 * UBIN HALF HALIGNED,
       67     6318    1         2 EVID UBIN HALF HALIGNED;
       68     6319    1   DCL STK$ PTR;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:24   
       69     6320    1   DCL I UBIN;
       70     6321    1   DCL RENV UBIN WORD;
       71     6322    1   DCL P$ PTR;
       72     6323    1   DCL JOB$ PTR;
       73     6324    1   DCL CITE$ PTR;
       74     6325    1   DCL KEYIN$ REDEF CITE$ PTR;
       75     6326
       76     6327
       77     6328
       78     6329        /**/
       79     6330        /* CONSTANT */
       80     6331        /**/
       81     6332        %VLP_ACCT (FPTN=JDACCT,ACCT=':SYSTAC',STCLASS=CONSTANT);
       82     6345    1   DCL STARS CHAR(80) CONSTANT ALIGNED INIT('*'*0);
       83     6346    1   DCL COMMENT CHAR(80) CONSTANT ALIGNED INIT
       84     6347    1        (' FIRST THE RECORD THAT PRESCAN DIDN''T LIKE, THEN THE FILE ');
       85     6348        %JP_CITE (FPTN=JP_BTON,COD=JPEV_JPGO#,STCLASS=CONSTANT);
       86     6380        %JP_CITE (FPTN=JP_OPFB,COD=JPEV_OPFB#,STCLASS=CONSTANT);
       87     6412        %JP_CITE (FPTN=JP_CNCL,COD=JPEV_NOP# ,STCLASS=CONSTANT);
       88     6444        %JP_CITE (FPTN=JP_SUSR,COD=JPEV_SUSR#,STCLASS=CONSTANT);
       89     6476        %VLP_STATION (FPTN=MYSTA,STATION='PRESCAN',STCLASS=CONSTANT);
       90     6503
       91     6504
       92     6505
       93     6506        /**/
       94     6507        /* STATIC */
       95     6508        /**/
       96     6509    1   DCL DEEP SBIN STATIC INIT(0);
       97     6510    1   DCL NEED2READ SBIN STATIC INIT(0);
       98     6511    1   DCL XCON UBIN WORD STATIC INIT(0);
       99     6512        %VLP_NAME (FPTN=JDNAME,NAME=':JPVVVBNNN',STCLASS=STATIC);
      100     6539        %RV_DFNAME (NAME=RV_DFNAME,STCLASS=STATIC);
      101     6543    1   DCL EIBUF CHAR(512) STATIC ALIGNED INIT(' ');
      102     6544        %OC_MESSHD_D            (NAME=OPMSG_UNIMP,
      103     6545                 NPARMS    = 0,
      104     6546                 MSG       = UNIMP_MSG#,
      105     6547                 DELIM     =";",
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:25   
      106     6548                 STCLASS   = STATIC);
      107     6561        %OC_MESSHD_D                          (NAME=OPMSG_NTBL,
      108     6562                 NPARMS    = 2,
      109     6563                 ATR       = M_SYS,
      110     6564                 MSG       = JP_ERR_MSG#,
      111     6565                 STCLASS   = STATIC);
      112     6578    1         2 * UBIN BYTE UNAL INIT(1),
      113     6579    1         2 * UBIN BYTE UNAL INIT(2),
      114     6580    1         2 CODE UBIN BYTE UNAL INIT(JPKE_NSLOT#),
      115     6581    1         2 LSYSID UBIN HALF UNAL;
      116     6582
      117     6583
      118     6584
      119     6585        /**/
      120     6586        /* DCBS */
      121     6587        /**/
      122     6588    1   DCL M$JD DCB;
      123     6589
      124     6590
      125     6591
      126     6592        /**/
      127     6593        /* FPTS */
      128     6594        /**/
      129     6595        %FPT_WRITE                            (FPTN=OCMSG_UNIMP,
      130     6596                 DCB       = M$CG,
      131     6597                 BUF       = OPMSG_UNIMP,
      132     6598                 STCLASS   = CONSTANT);
      133     6629        %FPT_WRITE                            (FPTN=OCMSG_NTBL,
      134     6630                 DCB       = M$CG,
      135     6631                 BUF       = OPMSG_NTBL);
      136     6662        %FPT_READ                             (FPTN=READ_CSCG,
      137     6663                 DCB       = M$CG,
      138     6664                 BUF       = JP_CSCGBUF,
      139     6665                 WAIT      = NO,
      140     6666                 EVENT     = JP_CSRD#,
      141     6667                 STCLASS   = CONSTANT);
      142     6706        %FPT_JOBSTATS                         (FPTN=UNMAP,
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:26   
      143     6707                 ORDER     = REMAP,
      144     6708                 BUF       = NIL,
      145     6709                 STATSEG   = FOSS_PREHDR#,
      146     6710                 STCLASS   = CONSTANT);
      147     6730        %FPT_PFIL                             (FPTN=REW,
      148     6731                 DCB       = M$EI,
      149     6732                 BOF       = YES,
      150     6733                 STCLASS   = CONSTANT);
      151     6748        %FPT_OPEN                             (FPTN=OPENJD,
      152     6749                 DCB       = M$JD,
      153     6750                 ASN       = FILE,
      154     6751                 ORG       = CONSEC,
      155     6752                 FUN       = CREATE,
      156     6753                 EXIST     = NEWFILE,
      157     6754                 NAME      = JDNAME,
      158     6755                 ACCT      = JDACCT,
      159     6756                 STCLASS   = CONSTANT);
      160     6865        %FPT_CLOSE                            (FPTN=CLSJD,
      161     6866                 DCB       = M$JD,
      162     6867                 DISP      = SAVE,
      163     6868                 STCLASS   = CONSTANT);
      164     6910        %FPT_READ                             (FPTN=READEI,
      165     6911                 DCB       = M$EI,
      166     6912                 WAIT      = YES,
      167     6913                 BUF       = EIBUF,
      168     6914                 STCLASS   = CONSTANT);
      169     6953        %FPT_WRITE                            (FPTN=WRITEJD,
      170     6954                 DCB       = M$JD,
      171     6955                 WAIT      = YES,
      172     6956                 BUF       = NIL,
      173     6957                 STCLASS   = STATIC);
      174     6988        %FPT_CLOSE                            (FPTN=CLSEI,
      175     6989                 DCB       = M$EI,
      176     6990                 DISP      = RELEASE,
      177     6991                 STCLASS   = CONSTANT);
      178     7033        %FPT_WRITE                            (FPTN=WRITESTARS,
      179     7034                 DCB       = M$JD,
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:27   
      180     7035                 WAIT      = YES,
      181     7036                 BUF       = STARS,
      182     7037                 STCLASS   = CONSTANT);
      183     7068        %FPT_WRITE                            (FPTN=WRITECOMMENT,
      184     7069                 DCB       = M$JD,
      185     7070                 WAIT      = YES,
      186     7071                 BUF       = STARS,
      187     7072                 STCLASS   = CONSTANT);
      188     7103        %FPT_WRITE                            (FPTN=WRITELINE,
      189     7104                 DCB       = M$JD,
      190     7105                 WAIT      = YES,
      191     7106                 BUF       = NIL,
      192     7107                 STCLASS   = STATIC);
      193     7138        %FPT_WRITE                            (FPTN=WRITESUSR,
      194     7139                 DCB       = M$CG,
      195     7140                 BUF       = JP_SUSR,
      196     7141                 STATION   = MYSTA,
      197     7142                 STCLASS   = CONSTANT);
      198     7173        %FPT_WRITE                            (FPTN=WRITEBTON,
      199     7174                 DCB       = M$CG,
      200     7175                 BUF       = JP_BTON,
      201     7176                 STATION   = MYSTA,
      202     7177                 STCLASS   = CONSTANT);
      203     7208        %FPT_WRITE                            (FPTN=WRITEOPFB,
      204     7209                 DCB       = M$CG,
      205     7210                 BUF       = JP_OPFB,
      206     7211                 STATION   = MYSTA,
      207     7212                 STCLASS   = CONSTANT);
      208     7243        %FPT_WRITE                            (FPTN=WRITECNCL,
      209     7244                 DCB       = M$CG,
      210     7245                 BUF       = JP_CNCL,
      211     7246                 STATION   = MYSTA,
      212     7247                 STCLASS   = CONSTANT);
      213     7278
      214     7279
      215     7280
      216     7281        /**/
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:28   
      217     7282        /* ENTREFS */
      218     7283        /**/
      219     7284    1   DCL FOI$CRASH     ENTRY(3) ALTRET;
      220     7285    1   DCL FOI$GBUF      ENTRY(2) ALTRET;
      221     7286    1   DCL FOI$LDTRC     ENTRY(4) ALTRET;
      222     7287    1   DCL FOI$RBUF      ENTRY(2) ALTRET;
      223     7288    1   DCL FOI$SNAP      ENTRY(4) ALTRET;
      224     7289
      225     7290
      226     7291
      227     7292        /**/
      228     7293        /* SYMREFS */
      229     7294        /**/
      230     7295        %FO_SCB (FPTN=JP_JOBSCB,STCLASS=SYMREF);
      231     7325        %JP$Q (NAME=JP_Q,STCLASS=SYMREF);
      232     7356
      233     7357
      234     7358
      235     7359        /**/
      236     7360        /* SUBS */
      237     7361        /**/
      238     7362        %SUB F_JP='1220'O;
      239     7363        %SUB M_B='02'O;
      240     7364        %SUB FOREVER="WHILE ('1'B)";
      241     7365        %SUB B$ERRCODE=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      242     7366        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:29   
      243     7367        /**/
      244     7368        /* BEGIN HERE */
      245     7369        /**/
      246     7370    2           DO INHIBIT;

      247     7371    2           STK$=B$TCB$->B$TCB.STK$;

   7371 10 000002   000000 470600 xsym               LDP0  ! B$TCB$
        10 000003   000001 236300                    LDQ   ! 1,,PR0
        10 000004   200004 756300                    STQ   ! STK$,,AUTO

      248     7372    2           RENV=0;

   7372 10 000005   200006 450300                    STZ   ! RENV,,AUTO

      249     7373    2           DEEP=DEEP+1;

   7373 10 000006   000000 054200 8                  AOS   ! DEEP

      250     7374    2           CALL SENV;

   7374 10 000007   000404 701200 10                 TSX1  ! SENV
        10 000010   000000 011200                    NOP   ! 0

      251     7375    2           EVENT=STK$->B$NWIO.EVID;

   7375 10 000011   200004 470700                    LDP0  ! STK$,,AUTO
        10 000012   000101 235300                    LDA   ! 65,,PR0
        10 000013   200003 755300                    STA   ! EVENT,,AUTO

      252     7376    3             DO CASE (EVNT.EVID);

   7376 10 000014   200003 720300                    LXL0  ! EVENT,,AUTO
        10 000015   000002 100203                    CMPX0 ! 2,DU
        10 000016   000020 602210 10                 TNC   ! s:7376+4,X0
        10 000017   000247 710200 10                 TRA   ! s:7539
        10 000020   000247 710200 10                 TRA   ! s:7539
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:30   
        10 000021   000022 710200 10                 TRA   ! s:7388

      253     7377        /***
      254     7378         ***
      255     7379         ***          CSCG READ COMPLETE
      256     7380         ***
      257     7381         ***/
      258     7382    3               CASE (JP_CSRD#);

      259     7383                     /*    Messages received by PRESCAN thru
      260     7384                      *    the CSCG are either from KEYIN
      261     7385                      *    (in which case they are keyins),
      262     7386                      *    or are framed by JP_CITE.
      263     7387                      */
      264     7388    3                 NEED2READ=1;

   7388 10 000022   000001 236207                    LDQ   ! 1,DL
        10 000023   000001 756200 8                  STQ   ! NEED2READ

      265     7389    3                 IF STK$->B$NWIO.ERR THEN

   7389 10 000024   000102 235300                    LDA   ! 66,,PR0
        10 000025   000033 600200 10                 TZE   ! s:7402

      266     7390    4                   DO;

      267     7391    4                   CALL FOI$SNAP (%S$JPCSCG,F_JP,M_B);

   7391 10 000026   000003 630600 11                 EPPR0 ! 3
        10 000027   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
        10 000030   000000 701200 xent               TSX1  ! FOI$SNAP
        10 000031   000000 011200                    NOP   ! 0

      268     7392        /*S* SCREECH_CODE: JPB-S$JPCSCG
      269     7393             TYPE:         SNAP
      270     7394             MESSAGE:      PRESCAN error reading CSCG
      271     7395             REMARKS:      When PRESCAN gets an error in his no-wait I/O
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:31   
      272     7396                           event from a read of CSCG, he just issues this
      273     7397                           snap and marches on. */
      274     7398    4                   END;

   7398 10 000032   000253 710200 10                 TRA   ! s:7548

      275     7399    3                 ELSE
      276     7400    4                   DO; /* READ OK */

      277     7401        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:32   
      278     7402    4                   IF STK$->B$NWIO.CGPARM.STATION# = 'KEYIN' THEN

   7402 10 000033   040000 106700                    CMPC  ! fill='040'O
        10 000034   000107 000010                    ADSC9   71,,PR0                  cn=0,n=8
        10 000035   000514 000005 7                  ADSC9   WRITECNCL+12             cn=0,n=5
        10 000036   000062 601200 10                 TNZ   ! s:7431

      279     7403    5                     DO; /* KEYIN */

      280     7404        /**
      281     7405         **
      282     7406         **      KEYIN
      283     7407         **
      284     7408         **
      285     7409         **/
      286     7410    5                     KEYIN$=ADDR(JP_CSCGBUF);

   7410 10 000037   000006 236200 11                 LDQ   ! 6
        10 000040   200011 756300                    STQ   ! CITE$,,AUTO

      287     7411    6                       DO CASE (KEYIN$->JP$KEYIN.KIN#);

   7411 10 000041   200011 471700                    LDP1  ! CITE$,,AUTO
        10 000042   100000 236300                    LDQ   ! 0,,PR1
        10 000043   000022 772200                    QRL   ! 18
        10 000044   000067 136207                    SBLQ  ! 55,DL
        10 000045   000001 116207                    CMPQ  ! 1,DL
        10 000046   000050 602206 10                 TNC   ! s:7411+7,QL
        10 000047   000054 710200 10                 TRA   ! s:7417
        10 000050   000051 710200 10                 TRA   ! s:7414

      288     7412
      289     7413    6                         CASE (KEY_ZAP#);

      290     7414    6                           JP_GOODNGT=1;

   7414 10 000051   000001 235207                    LDA   ! 1,DL
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:33   
        10 000052   000000 755200 xsym               STA   ! JP_GOODNGT
        10 000053   000253 710200 10                 TRA   ! s:7548

      291     7415
      292     7416    6                         CASE (ELSE);

      293     7417    6                           OPMSG_UNIMP.CADDR=KEYIN$->JP$KEYIN.CADDR;

   7417 10 000054   100000 721300                    LXL1  ! 0,,PR1
        10 000055   000212 741200 8                  STX1  ! OPMSG_UNIMP

      294     7418    6                           CALL M$WRITE (OCMSG_UNIMP);

   7418 10 000056   000076 630600 7                  EPPR0 ! OCMSG_UNIMP
        10 000057   040001 713600                    CLIMB ! write
        10 000060   401400 401760                    pmme    nvectors=4

      295     7419
      296     7420    6                       END;

      297     7421    5                     END; /* KEYIN */

   7421 10 000061   000253 710200 10                 TRA   ! s:7548

      298     7422    4                   ELSE
      299     7423    5                     DO; /* EVENT */

      300     7424        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:34   
      301     7425        /**
      302     7426         **
      303     7427         **      EVENT
      304     7428         **
      305     7429         **/
      306     7430
      307     7431    5                     CITE$=ADDR(JP_CSCGBUF);

   7431 10 000062   000006 236200 11                 LDQ   ! 6
        10 000063   200011 756300                    STQ   ! CITE$,,AUTO

      308     7432    6                       DO CASE (CITE$->JP$CITE.CODE);

   7432 10 000064   200011 471700                    LDP1  ! CITE$,,AUTO
        10 000065   100000 221300                    LDX1  ! 0,,PR1
        10 000066   000006 101203                    CMPX1 ! 6,DU
        10 000067   000071 602211 10                 TNC   ! s:7432+5,X1
        10 000070   000253 710200 10                 TRA   ! s:7548
        10 000071   000246 710200 10                 TRA   ! NDUN
        10 000072   000152 710200 10                 TRA   ! s:7486
        10 000073   000114 710200 10                 TRA   ! s:7461
        10 000074   000077 710200 10                 TRA   ! s:7443
        10 000075   000106 710200 10                 TRA   ! s:7448
        10 000076   000111 710200 10                 TRA   ! s:7453

      309     7433
      310     7434        /**
      311     7435         **      NOP EVENT
      312     7436         **/
      313     7437    6                         CASE (JPEV_NOP#);

      314     7438
      315     7439        /**
      316     7440         **      !BATCH ON   /   !BATCH OFF
      317     7441         **/
      318     7442    6                         CASE (JPEV_JPGO#);

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:35   
      319     7443    6                           JP_NOGO.BATCHON=BINBIT(CITE$->JP$CITE.GO,1);

   7443 10 000077   100000 236300                    LDQ   ! 0,,PR1
        10 000100   777777 376207                    ANQ   ! -1,DL
        10 000101   000043 736200                    QLS   ! 35
        10 000102   000000 676200 xsym               ERQ   ! JP_NOGO
        10 000103   400000 376203                    ANQ   ! -131072,DU
        10 000104   000000 656200 xsym               ERSQ  ! JP_NOGO
        10 000105   000253 710200 10                 TRA   ! s:7548

      320     7444        /**
      321     7445         **      OPEN FOR BUSINESS (FROM SLUG STARTUP PHASE DONE)
      322     7446         **/
      323     7447    6                         CASE (JPEV_OPFB#);

      324     7448    6                           JP_NOGO.OPFB='0'B;

   7448 10 000106   000007 236200 11                 LDQ   ! 7
        10 000107   000000 356200 xsym               ANSQ  ! JP_NOGO
        10 000110   000253 710200 10                 TRA   ! s:7548

      325     7449        /**
      326     7450         **      OK TO START USERS
      327     7451         **/
      328     7452    6                         CASE (JPEV_SUSR#);

      329     7453    6                           JP_NOGO.SUSR='0'B;

   7453 10 000111   000010 236200 11                 LDQ   ! 8
        10 000112   000000 356200 xsym               ANSQ  ! JP_NOGO
        10 000113   000253 710200 10                 TRA   ! s:7548

      330     7454        /**
      331     7455         **      MBS ACK (JOB RECEIVED)
      332     7456         **/
      333     7457    6                         CASE (JPEV_JACK#);

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:36   
      334     7458                     /*    Remove the job from the
      335     7459                      *    'scanned' list
      336     7460                      */
      337     7461    6                           CALL FINDJOB (JP_Q.SCAN$) ALTRET(ACK1);

   7461 10 000114   000011 236200 11                 LDQ   ! 9
        10 000115   200013 756300                    STQ   ! CITE$+2,,AUTO
        10 000116   000430 701200 10                 TSX1  ! FINDJOB
        10 000117   000145 702200 10                 TSX2  ! ACK1

      338     7462    6                           IF JOB$->JP$JOB.SCANNING THEN GOTO ACK1;

   7462 10 000120   200010 470700                    LDP0  ! JOB$,,AUTO
        10 000121   000001 234300                    SZN   ! 1,,PR0
        10 000122   000145 604200 10                 TMI   ! ACK1

      339     7463    6                           IF P$ = ADDR(NIL) THEN

   7463 10 000123   200007 236300                    LDQ   ! P$,,AUTO
        10 000124   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
        10 000125   000131 601200 10                 TNZ   ! s:7465

      340     7464    6                            JP_Q.SCAN$=JOB$->JP$JOB.LNK$;

   7464 10 000126   000000 236300                    LDQ   ! 0,,PR0
        10 000127   000005 756200 xsym               STQ   ! JP_Q+5
        10 000130   000134 710200 10                 TRA   ! s:7466

      341     7465    6                           ELSE P$->JP$JOB.LNK$=JOB$->JP$JOB.LNK$;

   7465 10 000131   000000 236300                    LDQ   ! 0,,PR0
        10 000132   200007 471700                    LDP1  ! P$,,AUTO
        10 000133   100000 756300                    STQ   ! 0,,PR1

      342     7466    6                           CALL FOI$RBUF (JP_JOBSCB,JOB$);

   7466 10 000134   200010 630700                    EPPR0 ! JOB$,,AUTO
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:37   
        10 000135   200015 450700                    STP0  ! DCB$+2,,AUTO
        10 000136   000012 236200 11                 LDQ   ! 10
        10 000137   200014 756300                    STQ   ! DCB$+1,,AUTO
        10 000140   200014 630700                    EPPR0 ! DCB$+1,,AUTO
        10 000141   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
        10 000142   000000 701200 xent               TSX1  ! FOI$RBUF
        10 000143   000000 011200                    NOP   ! 0

      343     7467    6                           GOTO DUN;

   7467 10 000144   000151 710200 10                 TRA   ! DUN

      344     7468                     /*    Did not find
      345     7469                      *    it.
      346     7470                      */
      347     7471    6   ACK1:                   CALL FOI$SNAP (%S$JPBACK,F_JP,M_B);

   7471 10 000145   000014 630600 11    ACK1         EPPR0 ! 12
        10 000146   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
        10 000147   000000 701200 xent               TSX1  ! FOI$SNAP
        10 000150   000000 011200                    NOP   ! 0

   7471 10 000151   000253 710200 10    DUN          TRA   ! s:7548

      348     7472        /*S* SCREECH_CODE: JPB-S$JPBACK
      349     7473             TYPE:         SNAP
      350     7474             MESSAGE:      MBS acked unknown SYSID to PRESCAN
      351     7475             REMARKS:      MBS is acnowleging receipt of a job which
      352     7476                           PRESCAN cannot find in his tables. */
      353     7477    6   DUN:                    ;
      354     7478        /**
      355     7479         **      ADD NEW JOB (TO BE PRESCANNED)
      356     7480         **/
      357     7481    6                         CASE (JPEV_NEWF#);

      358     7482                     /*    Ignore
      359     7483                      *    if added
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:38   
      360     7484                      *    twice
      361     7485                      */
      362     7486    6                           CALL FINDJOB (JP_Q.SCAN$) ALTRET(ADD1);

   7486 10 000152   000011 236200 11                 LDQ   ! 9
        10 000153   200013 756300                    STQ   ! CITE$+2,,AUTO
        10 000154   000430 701200 10                 TSX1  ! FINDJOB
        10 000155   000157 702200 10                 TSX2  ! ADD1

      363     7487    6                           GOTO NDUN;

   7487 10 000156   000246 710200 10                 TRA   ! NDUN

      364     7488    6   ADD1:                   CALL FINDJOB (JP_Q.HEAD$) ALTRET(ADD2);

   7488 10 000157   000017 236200 11    ADD1         LDQ   ! 15
        10 000160   200013 756300                    STQ   ! CITE$+2,,AUTO
        10 000161   000430 701200 10                 TSX1  ! FINDJOB
        10 000162   000164 702200 10                 TSX2  ! ADD2

      365     7489    6                           GOTO NDUN;

   7489 10 000163   000246 710200 10                 TRA   ! NDUN

      366     7490    6   ADD2:                   IF JP_Q.FREE$ ~= ADDR(NIL) THEN

   7490 10 000164   000004 236200 xsym  ADD2         LDQ   ! JP_Q+4
        10 000165   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
        10 000166   000174 600200 10                 TZE   ! s:7496

      367     7491    7                             DO;

      368     7492    7                             JOB$=JP_Q.FREE$;

   7492 10 000167   200010 756300                    STQ   ! JOB$,,AUTO

      369     7493    7                             JP_Q.FREE$=JOB$->JP$JOB.LNK$;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:39   

   7493 10 000170   200010 470700                    LDP0  ! JOB$,,AUTO
        10 000171   000000 236300                    LDQ   ! 0,,PR0
        10 000172   000004 756200 xsym               STQ   ! JP_Q+4

      370     7494    7                             END;

   7494 10 000173   000204 710200 10                 TRA   ! s:7497

      371     7495    6                           ELSE
      372     7496    6                            CALL FOI$GBUF (JP_JOBSCB,JOB$) ALTRET(NOFRAMES);

   7496 10 000174   200010 630700                    EPPR0 ! JOB$,,AUTO
        10 000175   200015 450700                    STP0  ! DCB$+2,,AUTO
        10 000176   000012 236200 11                 LDQ   ! 10
        10 000177   200014 756300                    STQ   ! DCB$+1,,AUTO
        10 000200   200014 630700                    EPPR0 ! DCB$+1,,AUTO
        10 000201   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
        10 000202   000000 701200 xent               TSX1  ! FOI$GBUF
        10 000203   000227 702200 10                 TSX2  ! NOFRAMES

      373     7497    6                           JOB$->JP$JOB.SYSID=CITE$->JP$CITE.SYSID;

   7497 10 000204   200011 470700                    LDP0  ! CITE$,,AUTO
        10 000205   000000 720300                    LXL0  ! 0,,PR0
        10 000206   200010 471700                    LDP1  ! JOB$,,AUTO
        10 000207   100001 440300                    SXL0  ! 1,,PR1

      374     7498    6                           IF JP_Q.TAIL$ ~= ADDR(NIL) THEN

   7498 10 000210   000003 236200 xsym               LDQ   ! JP_Q+3
        10 000211   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
        10 000212   000217 600200 10                 TZE   ! s:7500

      375     7499    6                            JP_Q.TAIL$->JP$JOB.LNK$=JOB$;

   7499 10 000213   200010 236300                    LDQ   ! JOB$,,AUTO
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:40   
        10 000214   000003 471600 xsym               LDP1  ! JP_Q+3
        10 000215   100000 756300                    STQ   ! 0,,PR1
        10 000216   000221 710200 10                 TRA   ! s:7501

      376     7500    6                           ELSE JP_Q.HEAD$=JOB$;

   7500 10 000217   200010 236300                    LDQ   ! JOB$,,AUTO
        10 000220   000002 756200 xsym               STQ   ! JP_Q+2

      377     7501    6                           JP_Q.TAIL$=JOB$;

   7501 10 000221   200010 236300                    LDQ   ! JOB$,,AUTO
        10 000222   000003 756200 xsym               STQ   ! JP_Q+3

      378     7502    6                           JOB$->JP$JOB.LNK$=ADDR(NIL);

   7502 10 000223   000001 236200 xsym               LDQ   ! B_VECTNIL+1
        10 000224   200010 471700                    LDP1  ! JOB$,,AUTO
        10 000225   100000 756300                    STQ   ! 0,,PR1

      379     7503    6                           GOTO NDUN;

   7503 10 000226   000246 710200 10                 TRA   ! NDUN

   7502 10 000227                       NOFRAMES     null
      380     7504    6   NOFRAMES:               ;
      381     7505    6                           IF JP_NJFR = 0 THEN

   7505 10 000227   000000 235200 xsym               LDA   ! JP_NJFR
        10 000230   000237 601200 10                 TNZ   ! s:7524

      382     7506    7                             DO;

      383     7507    7                             CALL FOI$SNAP (%S$JPNJFR,F_JP,M_B);

   7507 10 000231   000021 630600 11                 EPPR0 ! 17
        10 000232   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:41   
        10 000233   000000 701200 xent               TSX1  ! FOI$SNAP
        10 000234   000000 011200                    NOP   ! 0

      384     7508        /*S* SCREECH_CODE: JPB-S$JPNJFR
      385     7509             TYPE:         SNAP
      386     7510             MESSAGE:      PRESCAN can't get dynamic space for this job
      387     7511             REMARKS:      PRESCAN's job data segment cannot be expanded
      388     7512                           sufficiently to hold this job.  The job is
      389     7513                           lost until the next boot.  This should not
      390     7514                           happen unless there is something wrong with
      391     7515                           PRESCAN.
      392     7516
      393     7517                           This snap happens only once per boot.  Thereafter
      394     7518                           we just throw away the jobs.  Each occurance of
      395     7519                           this is accompanied by a message on the SYS
      396     7520                           console(s), identifying the job which has been
      397     7521                           ignored. */
      398     7522    7                             JP_NJFR=1;

   7522 10 000235   000001 235207                    LDA   ! 1,DL
        10 000236   000000 755200 xsym               STA   ! JP_NJFR

      399     7523    7                             END;

      400     7524    6                           OPMSG_NTBL.LSYSID=CITE$->JP$CITE.SYSID;

   7524 10 000237   200011 470700                    LDP0  ! CITE$,,AUTO
        10 000240   000000 100700                    MLR   ! fill='000'O
        10 000241   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
        10 000242   000224 600002 8                  ADSC9   OPMSG_NTBL+5             cn=3,n=2

      401     7525    6                           CALL M$WRITE (OCMSG_NTBL);

   7525 10 000243   000226 630600 8                  EPPR0 ! OCMSG_NTBL
        10 000244   040001 713600                    CLIMB ! write
        10 000245   401400 401760                    pmme    nvectors=4

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:42   
   7524 10 000246                       NDUN         null
      402     7526    6   NDUN:                   ;
      403     7527
      404     7528    6                       END;

      405     7529    5                     END; /* EVENT */

      406     7530    4                   END; /* READ OK */

   7530 10 000246   000253 710200 10                 TRA   ! s:7548

      407     7531
      408     7532
      409     7533        /***
      410     7534         ***
      411     7535         ***          UNKNOWN EVENT CODE
      412     7536         ***
      413     7537         ***/
      414     7538    3               CASE (ELSE);

      415     7539    3                 CALL FOI$SNAP (%S$JPBDEV,F_JP,M_B);

   7539 10 000247   000025 630600 11                 EPPR0 ! 21
        10 000250   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
        10 000251   000000 701200 xent               TSX1  ! FOI$SNAP
        10 000252   000000 011200                    NOP   ! 0

      416     7540        /*S* SCREECH_CODE: JPB-S$JPBDEV
      417     7541             TYPE:         SNAP
      418     7542             MESSAGE:      Unknown event passed to PRESCAN
      419     7543             REMARKS:      PRESCAN's event routine has been passed an
      420     7544                           unknown external event.  It has been ignored. */
      421     7545
      422     7546    3             END; /* CASE EVID */

      423     7547        /**/
      424     7548    3             DO WHILE (JP_Q.FREE$ ~= ADDR(NIL));
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:43   

   7548 10 000253   000271 710200 10                 TRA   ! s:7552

      425     7549    3             JOB$=JP_Q.FREE$;

   7549 10 000254   000004 236200 xsym               LDQ   ! JP_Q+4
        10 000255   200010 756300                    STQ   ! JOB$,,AUTO

      426     7550    3             JP_Q.FREE$=JOB$->JP$JOB.LNK$;

   7550 10 000256   200010 470700                    LDP0  ! JOB$,,AUTO
        10 000257   000000 236300                    LDQ   ! 0,,PR0
        10 000260   000004 756200 xsym               STQ   ! JP_Q+4

      427     7551    3             CALL FOI$RBUF (JP_JOBSCB,JOB$);

   7551 10 000261   200010 631700                    EPPR1 ! JOB$,,AUTO
        10 000262   200015 451700                    STP1  ! DCB$+2,,AUTO
        10 000263   000012 236200 11                 LDQ   ! 10
        10 000264   200014 756300                    STQ   ! DCB$+1,,AUTO
        10 000265   200014 630700                    EPPR0 ! DCB$+1,,AUTO
        10 000266   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
        10 000267   000000 701200 xent               TSX1  ! FOI$RBUF
        10 000270   000000 011200                    NOP   ! 0

      428     7552    3             END;

   7552 10 000271   000004 236200 xsym               LDQ   ! JP_Q+4
        10 000272   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
        10 000273   000254 601200 10                 TNZ   ! s:7549

      429     7553        /**/
      430     7554
      431     7555                     /*         EXIT here, restoring
      432     7556                      *         the TCB ALTRET frame
      433     7557                      *         if nescessary.
      434     7558                      */
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:44   
      435     7559    2           IF RENV ~= 0 THEN CALL M$RENV;

   7559 10 000274   200006 235300                    LDA   ! RENV,,AUTO
        10 000275   000300 600200 10                 TZE   ! s:7561

   7559 10 000276   010016 713600                    CLIMB ! 4110
        10 000277   000000 401760                    pmme    nvectors=0

      436     7560        /**/
      437     7561    2           IF DEEP = 1 THEN

   7561 10 000300   000000 235200 8                  LDA   ! DEEP
        10 000301   000001 115207                    CMPA  ! 1,DL
        10 000302   000316 601200 10                 TNZ   ! s:7567

      438     7562    3             DO WHILE (NEED2READ ~= 0);

   7562 10 000303   000001 236200 8                  LDQ   ! NEED2READ
        10 000304   000316 600200 10                 TZE   ! s:7567

      439     7563    3             NEED2READ=0;

   7563 10 000305   000001 450200 8                  STZ   ! NEED2READ

      440     7564    3             IF XCON+JP_GOODNGT = 0 THEN

   7564 10 000306   000002 236200 8                  LDQ   ! XCON
        10 000307   000000 036200 xsym               ADLQ  ! JP_GOODNGT
        10 000310   000314 601200 10                 TNZ   ! s:7566

      441     7565    3              CALL M$READ (READ_CSCG);

   7565 10 000311   000112 630600 7                  EPPR0 ! READ_CSCG
        10 000312   040000 713600                    CLIMB ! read
        10 000313   401400 401760                    pmme    nvectors=4

      442     7566    3             END;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:45   

   7566 10 000314   000001 235200 8                  LDA   ! NEED2READ
        10 000315   000305 601200 10                 TNZ   ! s:7563

      443     7567    2           DEEP=DEEP-1;

   7567 10 000316   000001 336207                    LCQ   ! 1,DL
        10 000317   000000 056200 8                  ASQ   ! DEEP

      444     7568    2           RETURN;

   7568 10 000320   000000 702200 xent               TSX2  ! X66_AARET

      445     7569    2           END; /* INHIBIT */

   7569 10 000321   000324 710000 10                 TRA     s:7583

      446     7570        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:46   
      447     7571        /**/
      448     7572        /*F* NAME:         JPB$XCON
      449     7573             PURPOSE:      To receive exit control for PRESCAN
      450     7574             DESCRIPTION:  A SNAP dump is generated.  If the jcl file DCB
      451     7575                           is open, then we will copy the file out of
      452     7576                           :SYMI into :JPVERNNN.:SYSTAC, where 'VERNNN'
      453     7577                           is the part of the name of the dumpfile we
      454     7578                           just created by the snap (:DFVERNNN).
      455     7579
      456     7580                           When this is done we LDTRC to ourselves. */
      457     7581    1   JPB$XCON: ENTRY ASYNC;

   7581 10 000322   000000 700200 xent  JPB$XCON     TSX0  ! X66_AAUTO
        10 000323   000020 000000                    ZERO    16,0

      458     7582        /**/
      459     7583    1         XCON=XCON+1;

   7583 10 000324   000002 235000 8                  LDA     XCON
        10 000325   000001 035007                    ADLA    1,DL
        10 000326   000002 755000 8                  STA     XCON

      460     7584    1         CALL FOI$SNAP (%S$JPABORT,F_JP,M_B,RV_DFNAME) ALTRET(NODUMP);

   7584 10 000327   000031 630400 11                 EPPR0   25
        10 000330   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000331   000000 701000 xent               TSX1    FOI$SNAP
        10 000332   000335 702000 10                 TSX2    NODUMP

      461     7585        /*S* SCREECH_CODE: JPB-S$JPABORT
      462     7586             TYPE:         SNAP
      463     7587             MESSAGE:      PRESCAN has aborted
      464     7588             REMARKS:      PRESCAN will write the offending input file
      465     7589                           (if any) from :SYMI to :SYSTAC under the name
      466     7590                           :JPVERNNN where VERNNN is from the name of
      467     7591                           the SNAP dump file :DFVERNNN.  The :SYMI file
      468     7592                           will be deleted, and PRESCAN will LDTRC to
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:47   
      469     7593                           itself. */
      470     7594    1         CALL DUMPJCL;

   7594 10 000333   000460 701000 10                 TSX1    DUMPJCL
        10 000334   000000 011000                    NOP     0

   7583 10 000335                       NODUMP       null
      471     7595    1   NODUMP:;
      472     7596                          /*    Write the current on/off bits
      473     7597                           *    as messages to us on CSCG.
      474     7598                           *    We'll pick them up when we
      475     7599                           *    come around.  First send
      476     7600                           *    a NOP event, to cancel the
      477     7601                           *    outstanding read.
      478     7602                           */
      479     7603    1         CALL M$WRITE (WRITECNCL) ALTRET(MARCHON);

   7603 10 000335   000500 630400 7                  EPPR0   WRITECNCL
        10 000336   440001 713400                    CLIMB   alt,write
        10 000337   401400 401760                    pmme    nvectors=4
        10 000340   000341 702000 10                 TSX2    MARCHON

   7583 10 000341                       MARCHON      null
      480     7604    1   MARCHON:;
      481     7605    1         IF NOT JP_NOGO.BATCHON THEN

   7605 10 000341   000000 234000 xsym               SZN     JP_NOGO
        10 000342   000347 604000 10                 TMI     WHOCARES

      482     7606    1          CALL M$WRITE (WRITEBTON) ALTRET(WHOCARES);

   7606 10 000343   000450 630400 7                  EPPR0   WRITEBTON
        10 000344   440001 713400                    CLIMB   alt,write
        10 000345   401400 401760                    pmme    nvectors=4
        10 000346   000347 702000 10                 TSX2    WHOCARES

   7605 10 000347                       WHOCARES     null
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:48   
      483     7607    1   WHOCARES:;
      484     7608    1         IF NOT JP_NOGO.SUSR THEN

   7608 10 000347   000000 236000 xsym               LDQ     JP_NOGO
        10 000350   100000 316003                    CANQ    32768,DU
        10 000351   000356 601000 10                 TNZ     WHOCARES0

      485     7609    1          CALL M$WRITE (WRITESUSR) ALTRET(WHOCARES0);

   7609 10 000352   000434 630400 7                  EPPR0   WRITESUSR
        10 000353   440001 713400                    CLIMB   alt,write
        10 000354   401400 401760                    pmme    nvectors=4
        10 000355   000356 702000 10                 TSX2    WHOCARES0

   7608 10 000356                       WHOCARES0    null
      486     7610    1   WHOCARES0:;
      487     7611    1         IF NOT JP_NOGO.OPFB THEN

   7611 10 000356   000000 236000 xsym               LDQ     JP_NOGO
        10 000357   200000 316003                    CANQ    65536,DU
        10 000360   000365 601000 10                 TNZ     WHOCARES1

      488     7612    1          CALL M$WRITE (WRITEOPFB) ALTRET(WHOCARES1);

   7612 10 000361   000464 630400 7                  EPPR0   WRITEOPFB
        10 000362   440001 713400                    CLIMB   alt,write
        10 000363   401400 401760                    pmme    nvectors=4
        10 000364   000365 702000 10                 TSX2    WHOCARES1

   7611 10 000365                       WHOCARES1    null
      489     7613    1   WHOCARES1:;
      490     7614    1         CALL M$JOBSTATS (UNMAP) ALTRET(LDTRC);

   7614 10 000365   000130 630400 7                  EPPR0   UNMAP
        10 000366   570001 713400                    CLIMB   alt,+61441
        10 000367   405400 401760                    pmme    nvectors=12
        10 000370   000371 702000 10                 TSX2    LDTRC
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:49   

   7611 10 000371                       LDTRC        null
      491     7615    1   LDTRC:;
      492     7616    1         CALL FOI$LDTRC (,,,'PRESCAN ');

   7616 10 000371   000035 236000 11                 LDQ     29
        10 000372   000001 235000 xsym               LDA     B_VECTNIL+1
        10 000373   200016 757100                    STAQ    DCB$+3,,AUTO
        10 000374   000001 236000 xsym               LDQ     B_VECTNIL+1
        10 000375   000001 235000 xsym               LDA     B_VECTNIL+1
        10 000376   200014 757100                    STAQ    DCB$+1,,AUTO
        10 000377   200014 630500                    EPPR0   DCB$+1,,AUTO
        10 000400   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000401   000000 701000 xent               TSX1    FOI$LDTRC
        10 000402   000000 011000                    NOP     0
        10 000403   000603 710000 10                 TRA     s:7695

      493     7617        %EJECT;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:50   
      494     7618        /********************************************************
      495     7619        *********************************************************/
      496     7620        /*D* NAME:         SENV
      497     7621             PURPOSE:      To save the TCB ALTRET frame via M$SENV
      498     7622        */
      499     7623    1   SENV: PROC;

   7623 10 000404   200012 741300       SENV         STX1  ! CITE$+1,,AUTO

      500     7624    2         CALL M$SENV ALTRET(NOSENV);

   7624 10 000405   410011 713400                    CLIMB   alt,+4105
        10 000406   000000 401760                    pmme    nvectors=0
        10 000407   000414 702000 10                 TSX2    NOSENV

      501     7625    2         RENV=1;

   7625 10 000410   000001 235007                    LDA     1,DL
        10 000411   200006 755100                    STA     RENV,,AUTO

      502     7626    2         RETURN;

   7626 10 000412   200012 221300                    LDX1  ! CITE$+1,,AUTO
        10 000413   000001 702211                    TSX2  ! 1,X1

   7625 10 000414                       NOSENV       null
      503     7627    2   NOSENV:;
      504     7628    2         IF B$ERRCODE = %E$ALTEMPTY THEN RETURN;

   7628 10 000414   000000 470400 xsym               LDP0    B$TCB$
        10 000415   000000 471500                    LDP1    0,,PR0
        10 000416   100102 236100                    LDQ     66,,PR1
        10 000417   377770 376007                    ANQ     131064,DL
        10 000420   007610 116007                    CMPQ    3976,DL
        10 000421   000424 601000 10                 TNZ     s:7629

   7628 10 000422   200012 221300                    LDX1  ! CITE$+1,,AUTO
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:51   
        10 000423   000001 702211                    TSX2  ! 1,X1

      505     7629    2         CALL M$MERC;

   7629 10 000424   010007 713400                    CLIMB   4103
        10 000425   000000 401760                    pmme    nvectors=0

      506     7630    2         RETURN;

   7630 10 000426   200012 221300                    LDX1  ! CITE$+1,,AUTO
        10 000427   000001 702211                    TSX2  ! 1,X1

      507     7631    2   END SENV;
      508     7632        /********************************************************
      509     7633        *********************************************************/
      510     7634        /*D* NAME:         FINDJOB
      511     7635             PURPOSE:      To find the job frame for the sysid
      512     7636                           in CITE$->JP$CITE.SYSID
      513     7637             DESCRIPTION:  ALTRETs if not found; else returns
      514     7638                           JOB$ pointing to the job frame,
      515     7639                           and P$ to its blink (or NIL if JOB$ is head).
      516     7640                           HEAD$ is the head pointer of the
      517     7641                           list to be searched. */
      518     7642    1   FINDJOB: PROC (HEAD$) ALTRET;

   7642 10 000430   200012 741300       FINDJOB      STX1  ! CITE$+1,,AUTO

      519     7643        /**/
      520     7644    2   DCL HEAD$ PTR;
      521     7645        /**/
      522     7646    2         JOB$=HEAD$;

   7646 10 000431   200013 470500                    LDP0    @HEAD$,,AUTO
        10 000432   000000 236100                    LDQ     0,,PR0
        10 000433   200010 756100                    STQ     JOB$,,AUTO

      523     7647    2         P$=ADDR(NIL);
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:52   

   7647 10 000434   000001 236000 xsym               LDQ     B_VECTNIL+1
        10 000435   200007 756100                    STQ     P$,,AUTO

      524     7648    3           DO WHILE (JOB$ ~= ADDR(NIL));

   7648 10 000436   000453 710000 10                 TRA     s:7652

      525     7649    3           IF JOB$->JP$JOB.SYSID = CITE$->JP$CITE.SYSID THEN RETURN;

   7649 10 000437   200011 470500                    LDP0    CITE$,,AUTO
        10 000440   200010 471500                    LDP1    JOB$,,AUTO
        10 000441   100001 236100                    LDQ     1,,PR1
        10 000442   000000 676100                    ERQ     0,,PR0
        10 000443   777777 376007                    ANQ     -1,DL
        10 000444   000447 601000 10                 TNZ     s:7650

   7649 10 000445   200012 221300                    LDX1  ! CITE$+1,,AUTO
        10 000446   000001 702211                    TSX2  ! 1,X1

      526     7650    3           P$=JOB$;

   7650 10 000447   200010 236100                    LDQ     JOB$,,AUTO
        10 000450   200007 756100                    STQ     P$,,AUTO

      527     7651    3           JOB$=JOB$->JP$JOB.LNK$;

   7651 10 000451   100000 236100                    LDQ     0,,PR1
        10 000452   200010 756100                    STQ     JOB$,,AUTO

      528     7652    3           END;

   7652 10 000453   200010 236100                    LDQ     JOB$,,AUTO
        10 000454   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 000455   000437 601000 10                 TNZ     s:7649

      529     7653    2         ALTRETURN;
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:53   

   7653 10 000456   200012 221300                    LDX1  ! CITE$+1,,AUTO
        10 000457   000000 702211                    TSX2  ! 0,X1

      530     7654    2   END FINDJOB;
      531     7655        /********************************************************
      532     7656        *********************************************************/
      533     7657        /*D* NAME:         DUMPJCL
      534     7658             PURPOSE:      To dump the current JCL file into :SYSTAC
      535     7659             DESCRIPTION:  A SNAP dump has already been taken.
      536     7660                           If the :SYMI file DCB is open, then we
      537     7661                           copy the file into :SYSTAC and delete
      538     7662                           it from :SYMI. */
      539     7663    1   DUMPJCL: PROC ALTRET;

   7663 10 000460   200012 741300       DUMPJCL      STX1  ! CITE$+1,,AUTO

      540     7664        /**/
      541     7665    2   DCL DCB$ PTR;
      542     7666        /**/
      543     7667    2         DCB$=DCBADDR(DCBNUM(M$EI));

   7667 10 000461   000000 236007 xsym               LDQ     M$EI,DL
        10 000462   000036 470400 11                 LDP0    30
        10 000463   000000 471500                    LDP1    0,,PR0
        10 000464   100000 236106                    LDQ     0,QL,PR1
        10 000465   200013 756100                    STQ     DCB$,,AUTO

      544     7668    2         IF DCB$->F$DCB.FCD# = '0'B THEN RETURN;

   7668 10 000466   200013 473500                    LDP3    DCB$,,AUTO
        10 000467   300031 236100                    LDQ     25,,PR3
        10 000470   020000 316007                    CANQ    8192,DL
        10 000471   000473 601000 10                 TNZ     s:7669

   7668 10 000472   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:54   
      545     7669    2         CALL CONCAT (JDNAME.NAME#,':JP',RV_DFNAME.MONID4,RV_DFNAME.DUMPC);

   7669 10 000473   000520 236000 7                  LDQ     WRITECNCL+16
        10 000474   000011 772000                    QRL     9
        10 000475   000003 552034 8                  STBQ    JDNAME,'34'O
        10 000476   000007 236000 8                  LDQ     RV_DFNAME+1
        10 000477   000004 756000 8                  STQ     JDNAME+1
        10 000500   000010 236000 8                  LDQ     RV_DFNAME+2
        10 000501   000005 552070 8                  STBQ    JDNAME+2,'70'O

      546     7670    2         CALL M$OPEN (OPENJD) ALTRET(ALTRT);

   7670 10 000502   000200 630400 7                  EPPR0   OPENJD
        10 000503   450000 713400                    CLIMB   alt,open
        10 000504   410400 401760                    pmme    nvectors=18
        10 000505   000601 702000 10                 TSX2    ALTRT

      547     7671    2         IF XCON < 1 THEN

   7671 10 000506   000002 235000 8                  LDA     XCON
        10 000507   000543 601000 10                 TNZ     s:7682

      548     7672                                /* Don't try this more than once */
      549     7673    3           DO;

      550     7674    3           CALL M$WRITE (WRITESTARS) ALTRET(DONE);

   7674 10 000510   000404 630400 7                  EPPR0   WRITESTARS
        10 000511   440001 713400                    CLIMB   alt,write
        10 000512   401400 401760                    pmme    nvectors=4
        10 000513   000567 702000 10                 TSX2    DONE

      551     7675    3           CALL M$WRITE (WRITECOMMENT) ALTRET(DONE);

   7675 10 000514   000420 630400 7                  EPPR0   WRITECOMMENT
        10 000515   440001 713400                    CLIMB   alt,write
        10 000516   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:55   
        10 000517   000567 702000 10                 TSX2    DONE

      552     7676    3           I=DCB$->F$DCB.ARS#;

   7676 10 000520   200013 470500                    LDP0    DCB$,,AUTO
        10 000521   000000 235100                    LDA     0,,PR0
        10 000522   200005 755100                    STA     I,,AUTO

      553     7677    3           IF I = 0 THEN WRITELINE.BUF_=VECTOR(NIL);

   7677 10 000523   000527 601000 10                 TNZ     s:7678

   7677 10 000524   000040 237000 11                 LDAQ    32
        10 000525   000262 757000 8                  STAQ    WRITELINE+4
        10 000526   000533 710000 10                 TRA     s:7679

      554     7678    3           ELSE WRITELINE.BUF_=VECTOR(READ_CARD.BUF_.BUF$->B$$CHARS);

   7678 10 000527   000020 735000                    ALS     16
        10 000530   000140 135007                    SBLA    96,DL
        10 000531   000005 236000 xsym               LDQ     READ_CARD+5
        10 000532   000262 757000 8                  STAQ    WRITELINE+4

      555     7679    3           CALL M$WRITE (WRITELINE) ALTRET(DONE);

   7679 10 000533   000256 630400 8                  EPPR0   WRITELINE
        10 000534   440001 713400                    CLIMB   alt,write
        10 000535   401400 401760                    pmme    nvectors=4
        10 000536   000567 702000 10                 TSX2    DONE

      556     7680    3           CALL M$WRITE (WRITESTARS) ALTRET(DONE);

   7680 10 000537   000404 630400 7                  EPPR0   WRITESTARS
        10 000540   440001 713400                    CLIMB   alt,write
        10 000541   401400 401760                    pmme    nvectors=4
        10 000542   000567 702000 10                 TSX2    DONE

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:56   
      557     7681    3           END;

      558     7682    2         CALL M$PFIL (REW) ALTRET (DONE);

   7682 10 000543   000174 630400 7                  EPPR0   REW
        10 000544   440004 713400                    CLIMB   alt,+16388
        10 000545   400000 401760                    pmme    nvectors=1
        10 000546   000567 702000 10                 TSX2    DONE

      559     7683    3           DO FOREVER;

      560     7684    3           CALL M$READ (READEI) ALTRET(DONE);

   7684 10 000547   000330 630400 7                  EPPR0   READEI
        10 000550   440000 713400                    CLIMB   alt,read
        10 000551   401400 401760                    pmme    nvectors=4
        10 000552   000567 702000 10                 TSX2    DONE

      561     7685    3           I=DCB$->F$DCB.ARS#;

   7685 10 000553   200013 470500                    LDP0    DCB$,,AUTO
        10 000554   000000 235100                    LDA     0,,PR0
        10 000555   200005 755100                    STA     I,,AUTO

      562     7686    3           WRITEJD.BUF_=VECTOR(ADDR(EIBUF)->B$$CHARS);

   7686 10 000556   000020 735000                    ALS     16
        10 000557   000140 135007                    SBLA    96,DL
        10 000560   000042 236000 11                 LDQ     34
        10 000561   000246 757000 8                  STAQ    WRITEJD+4

      563     7687    3           CALL M$WRITE (WRITEJD) ALTRET(DONE);

   7687 10 000562   000242 630400 8                  EPPR0   WRITEJD
        10 000563   440001 713400                    CLIMB   alt,write
        10 000564   401400 401760                    pmme    nvectors=4
        10 000565   000567 702000 10                 TSX2    DONE
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:57   

      564     7688    3           END;

   7688 10 000566   000547 710000 10                 TRA     s:7684

      565     7689    2   DONE: CALL M$CLOSE (CLSJD) ALTRET(D1);

   7689 10 000567   000272 630400 7     DONE         EPPR0   CLSJD
        10 000570   450001 713400                    CLIMB   alt,close
        10 000571   406000 401760                    pmme    nvectors=13
        10 000572   000573 702000 10                 TSX2    D1

      566     7690    2   D1:   CALL M$CLOSE (CLSEI) ALTRET(D2);

   7690 10 000573   000346 630400 7     D1           EPPR0   CLSEI
        10 000574   450001 713400                    CLIMB   alt,close
        10 000575   406000 401760                    pmme    nvectors=13
        10 000576   000577 702000 10                 TSX2    D2

      567     7691    2   D2:   RETURN;

   7691 10 000577   200012 221300       D2           LDX1  ! CITE$+1,,AUTO
        10 000600   000001 702211                    TSX2  ! 1,X1

   7689 10 000601                       ALTRT        null
      568     7692    2   ALTRT:;
      569     7693    2         ALTRETURN;

   7693 10 000601   200012 221300                    LDX1  ! CITE$+1,,AUTO
        10 000602   000000 702211                    TSX2  ! 0,X1

      570     7694    2   END DUMPJCL;
      571     7695    1   END JPB$EVENT;

   7695 10 000603   000000 702200 xent               TSX2  ! X66_AARET

PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:58   
--  Include file information  --

   JP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   UE_ERRORS_C.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   JP_SCODE_C.:E05TOU  is referenced.
   FOS_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   JP_SUBS_C.:E05TOU  is referenced.
   JP_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JPB$EVENT.
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:59   

 **** Variables and constants ****

  ****  Section 007 RoData JPB$EVENT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   346-0-0/d STRC(1080)  r     1 CLSEI                    272-0-0/d STRC(1080)  r     1 CLSJD
     0-0-0/c STRC(72)    r     1 JDACCT                    52-0-0/w STRC(108)   r     1 JP_BTON
    60-0-0/w STRC(108)   r     1 JP_CNCL                   55-0-0/w STRC(108)   r     1 JP_OPFB
    63-0-0/w STRC(108)   r     1 JP_SUSR                   66-0-0/w STRC(288)   r     1 MYSTA
    76-0-0/d STRC(432)   r     1 OCMSG_UNIMP              200-0-0/d STRC(2088)  r     1 OPENJD
   330-0-0/d STRC(504)   r     1 READEI                   112-0-0/d STRC(504)   r     1 READ_CSCG
   174-0-0/d STRC(144)   r     1 REW                        2-0-0/w CHAR(80)    r     1 STARS
   130-0-0/d STRC(1296)  r     1 UNMAP                    450-0-0/d STRC(432)   r     1 WRITEBTON
   500-0-0/d STRC(432)   r     1 WRITECNCL                420-0-0/d STRC(432)   r     1 WRITECOMMENT
   464-0-0/d STRC(432)   r     1 WRITEOPFB                404-0-0/d STRC(432)   r     1 WRITESTARS
   434-0-0/d STRC(432)   r     1 WRITESUSR

  ****  Section 008  Data  JPB$EVENT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 DEEP                      12-0-0/w CHAR(512)   r     1 EIBUF
     3-0-0/c STRC(99)    r     1 JDNAME                     1-0-0/w SBIN        r     1 NEED2READ
   226-0-0/d STRC(432)   r     1 OCMSG_NTBL               217-0-0/c STRC(225)   r     1 OPMSG_NTBL
   212-0-0/c STRC(180)   r     1 OPMSG_UNIMP                6-0-0/d STRC(99)    r     1 RV_DFNAME
   242-0-0/d STRC(432)   r     1 WRITEJD                  256-0-0/d STRC(432)   r     1 WRITELINE
     2-0-0/w UBIN        r     1 XCON

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    13-0-0/w PTR         r     1 @HEAD$                    11-0-0/w PTR         r     1 CITE$
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:60   
    13-0-0/w PTR         r     1 DCB$                       3-0-0/w UBIN        r     1 EVENT
     3-0-0/w STRC        r     1 EVNT                      *0-0-0/w PTR         r     1 HEAD$
     5-0-0/w UBIN        r     1 I                         10-0-0/w PTR         r     1 JOB$
    11-0-0/w PTR         r     1 KEYIN$                     7-0-0/w PTR         r     1 P$
     6-0-0/w UBIN        r     1 RENV                       4-0-0/w PTR         r     1 STK$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 ES$
     0-0-0/d CHAR(256)   r     1 JP_CSCGBUF                 0-0-0/w UBIN        r     1 JP_GOODNGT
     0-0-0/w STRC(288)   r     1 JP_JOBSCB                  0-0-0/w UBIN        r     1 JP_NJFR
     0-0-0/w STRC        r     1 JP_NOGO                    0-0-0/w STRC(216)   r     1 JP_Q
     0-0-0/d STRC(504)   r     1 READ_CARD

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 B$$CHARS                   0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/w STRC(2880)  r     1 B$NWIO                     0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(108)   r     1 JP$CITE
     0-0-0/w STRC(72)    r     1 JP$JOB                     0-0-0/w STRC        r     1 JP$KEYIN
     0-0-0N  NULL        r     1 M$CG                       0-0-0N  NULL        r     1 M$EI
     0-0-0N  NULL        r     1 M$JD


   Procedure JPB$EVENT requires 388 words for executable code.
   Procedure JPB$EVENT requires 16 words of local(AUTO) storage.

    No errors detected in file JPB$EVENT.:E05TSI    .
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:61   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:62   
          MINI XREF LISTING

ACK1
      7471**LABEL    7461--CALLALT  7462--GOTO
ADD1
      7488**LABEL    7486--CALLALT
ADD2
      7490**LABEL    7488--CALLALT
ALTRT IN PROCEDURE DUMPJCL
      7689**LABEL    7670--CALLALT
AS_USERS.BANNER_PERM
      5907**DCL      5908--REDEF
AS_USERS.BUDGET.MACCT
      5812**DCL      5816--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
      5825**DCL      5828--REDEF
AS_USERS.BUDGET.PACCUM
      5808**DCL      5810--REDEF
AS_USERS.BUDGET.PMAXC
      5803**DCL      5805--REDEF
AS_USERS.SETUP_CHRA.TXT
      5923**DCL      5924--REDEF    5925--REDEF
B$$CHARS
      6308**DCL      7678--ASSIGN   7686--ASSIGN
B$ALT.CODE
      5716**DCL      5716--REDEF    5717--REDEF    5717--REDEF
B$ALT.ERR.CODE
      5718**DCL      7628>>IF
B$ALT.ERR.ERR#
      5718**DCL      5718--REDEF
B$ALT.EVID
      5717**DCL      5717--REDEF    5717--REDEF
B$NWIO.CGPARM.MSGIDXT
      6188**DCL      6191--REDEF
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:63   
B$NWIO.CGPARM.STATION#
      6182**DCL      7402>>IF
B$NWIO.CODE
      6157**DCL      6157--REDEF    6158--REDEF    6158--REDEF
B$NWIO.ERR
      6158**DCL      7389>>IF
B$NWIO.ERR.ERR#
      6159**DCL      6159--REDEF
B$NWIO.EVID
      6158**DCL      6158--REDEF    6158--REDEF    7375>>ASSIGN
B$TCB.ALT$
      5712**DCL      7628>>IF
B$TCB.STK$
      5712**DCL      7371>>ASSIGN
B$TCB$
      5706**DCL      5712--IMP-PTR  7371>>ASSIGN   7628>>IF
CITE$
      6324**DCL      6325--REDEF    7431<<ASSIGN   7432>>DOCASE   7443>>ASSIGN   7497>>ASSIGN   7524>>ASSIGN
      7649>>IF
CLSEI
      7014**DCL      7690<>CALL
CLSEI.SN_
      7014**DCL      7014--REDEF
CLSEI.UTL_
      7015**DCL      7015--REDEF
CLSEI.V
      7019**DCL      7014--DCLINIT
CLSEI.V.EXPIRE#
      7029**DCL      7029--REDEF
CLSEI.V.TYPE#
      7027**DCL      7027--REDEF
CLSEI.V.XTNSIZE#
      7024**DCL      7024--REDEF    7026--REDEF
CLSJD
      6891**DCL      7689<>CALL
CLSJD.SN_
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:64   
      6891**DCL      6891--REDEF
CLSJD.UTL_
      6892**DCL      6892--REDEF
CLSJD.V
      6896**DCL      6891--DCLINIT
CLSJD.V.EXPIRE#
      6906**DCL      6906--REDEF
CLSJD.V.TYPE#
      6904**DCL      6904--REDEF
CLSJD.V.XTNSIZE#
      6901**DCL      6901--REDEF    6903--REDEF
D1 IN PROCEDURE DUMPJCL
      7690**LABEL    7689--CALLALT
D2 IN PROCEDURE DUMPJCL
      7691**LABEL    7690--CALLALT
DCB$ IN PROCEDURE DUMPJCL
      7665**DCL      7667<<ASSIGN   7668>>IF       7676>>ASSIGN   7685>>ASSIGN
DEEP
      6509**DCL      7373<<ASSIGN   7373>>ASSIGN   7561>>IF       7567<<ASSIGN   7567>>ASSIGN
DONE IN PROCEDURE DUMPJCL
      7689**LABEL    7674--CALLALT  7675--CALLALT  7679--CALLALT  7680--CALLALT  7682--CALLALT  7684--CALLALT
      7687--CALLALT
DUMPJCL
      7663**PROC     7594--CALL
DUN
      7471**LABEL    7467--GOTO
EIBUF
      6543**DCL      6933--DCLINIT  6934--DCLINIT  7686--ASSIGN
ES$
      6141**DCL      6142--REDEF    6145--IMP-PTR
EVENT
      6315**DCL      6316--REDEF    7375<<ASSIGN
EVNT.EVID
      6318**DCL      7376>>DOCASE
F$DCB.ACTPOS
      5755**DCL      5755--REDEF
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:65   
F$DCB.ARS#
      5729**DCL      5729--REDEF    7676>>ASSIGN   7685>>ASSIGN
F$DCB.ATTR
      5748**DCL      5749--REDEF
F$DCB.BORROW
      5763**DCL      5763--REDEF    5763--REDEF    5763--REDEF
F$DCB.DCBNAME.L
      5777**DCL      5777--IMP-SIZ
F$DCB.EOMCHAR#
      5733**DCL      5733--REDEF
F$DCB.FCD#
      5742**DCL      7668>>IF
F$DCB.FLDID
      5758**DCL      5758--REDEF
F$DCB.FORM$
      5752**DCL      5752--REDEF
F$DCB.FSECT
      5768**DCL      5768--REDEF
F$DCB.FSN#
      5745**DCL      5745--REDEF    5745--REDEF    5746--REDEF
F$DCB.HEADER$
      5751**DCL      5751--REDEF
F$DCB.IXTNSIZE#
      5749**DCL      5749--REDEF
F$DCB.LASTSTA$
      5738**DCL      5738--REDEF
F$DCB.LVL
      5764**DCL      5764--REDEF
F$DCB.NAME#.C
      5739**DCL      5739--REDEF
F$DCB.NOEOF
      5761**DCL      5761--REDEF
F$DCB.NRECS#
      5750**DCL      5750--REDEF
F$DCB.NRECX
      5769**DCL      5769--REDEF
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:66   
F$DCB.OHDR
      5761**DCL      5761--REDEF
F$DCB.ORG#
      5744**DCL      5744--REDEF
F$DCB.PRECNO
      5767**DCL      5767--REDEF
F$DCB.RCSZ
      5773**DCL      5773--REDEF
F$DCB.RES#
      5740**DCL      5740--REDEF
F$DCB.SETX
      5752**DCL      5752--REDEF
F$DCB.TAB$
      5752**DCL      5752--REDEF
F$DCB.TDA
      5766**DCL      5767--REDEF
F$DCB.WSN#
      5740**DCL      5740--REDEF
FINDJOB
      7642**PROC     7461--CALL     7486--CALL     7488--CALL
FOI$GBUF
      7285**DCL-ENT  7496--CALL
FOI$LDTRC
      7286**DCL-ENT  7616--CALL
FOI$RBUF
      7287**DCL-ENT  7466--CALL     7551--CALL
FOI$SNAP
      7288**DCL-ENT  7391--CALL     7471--CALL     7507--CALL     7539--CALL     7584--CALL
HEAD$ IN PROCEDURE FINDJOB
      7644**DCL      7642--PROC     7646>>ASSIGN
I
      6320**DCL      6308--IMP-SIZ  7676<<ASSIGN   7677>>IF       7678>>ASSIGN   7685<<ASSIGN   7686>>ASSIGN
JDACCT
      6343**DCL      6826--DCLINIT
JDNAME
      6537**DCL      6822--DCLINIT
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:67   
JDNAME.NAME#
      6537**DCL      7669<<CALLBLT
JOB$
      6323**DCL      7462>>IF       7464>>ASSIGN   7465>>ASSIGN   7466<>CALL     7492<<ASSIGN   7493>>ASSIGN
      7496<>CALL     7497>>ASSIGN   7499>>ASSIGN   7500>>ASSIGN   7501>>ASSIGN   7502>>ASSIGN   7549<<ASSIGN
      7550>>ASSIGN   7551<>CALL     7646<<ASSIGN   7648>>DOWHILE  7649>>IF       7650>>ASSIGN   7651<<ASSIGN
      7651>>ASSIGN
JP$CITE.CODE
      6259**DCL      7432>>DOCASE
JP$CITE.GO
      6265**DCL      7443>>ASSIGN
JP$CITE.SYSID
      6263**DCL      6265--REDEF    7497>>ASSIGN   7524>>ASSIGN   7649>>IF
JP$JOB.LNK$
      6300**DCL      7464>>ASSIGN   7465<<ASSIGN   7465>>ASSIGN   7493>>ASSIGN   7499<<ASSIGN   7502<<ASSIGN
      7550>>ASSIGN   7651>>ASSIGN
JP$JOB.SCANNING
      6302**DCL      7462>>IF
JP$JOB.SYSID
      6305**DCL      7497<<ASSIGN   7649>>IF
JP$KEYIN.CADDR
      6293**DCL      7417>>ASSIGN
JP$KEYIN.KIN#
      6291**DCL      7411>>DOCASE
JP_BTON
      6363**DCL      7195--DCLINIT  7196--DCLINIT
JP_BTON.SYSID
      6372**DCL      6374--REDEF
JP_CNCL
      6427**DCL      7265--DCLINIT  7266--DCLINIT
JP_CNCL.SYSID
      6436**DCL      6438--REDEF
JP_CSCGBUF
      6132**DCL      6686--DCLINIT  6687--DCLINIT  7410--ASSIGN   7431--ASSIGN
JP_GOODNGT
      6138**DCL      7414<<ASSIGN   7564>>IF
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:68   
JP_JOBSCB
      7308**DCL      7466<>CALL     7496<>CALL     7551<>CALL
JP_NJFR
      6139**DCL      7505>>IF       7522<<ASSIGN
JP_NOGO.BATCHON
      6134**DCL      7443<<ASSIGN   7605>>IF
JP_NOGO.OPFB
      6135**DCL      7448<<ASSIGN   7611>>IF
JP_NOGO.SUSR
      6136**DCL      7453<<ASSIGN   7608>>IF
JP_OPFB
      6395**DCL      7230--DCLINIT  7231--DCLINIT
JP_OPFB.SYSID
      6404**DCL      6406--REDEF
JP_Q.FREE$
      7350**DCL      7490>>IF       7492>>ASSIGN   7493<<ASSIGN   7548>>DOWHILE  7549>>ASSIGN   7550<<ASSIGN
JP_Q.HEAD$
      7346**DCL      7488<>CALL     7500<<ASSIGN
JP_Q.SCAN$
      7352**DCL      7461<>CALL     7464<<ASSIGN   7486<>CALL
JP_Q.TAIL$
      7348**DCL      7498>>IF       7499>>ASSIGN   7501<<ASSIGN
JP_SUSR
      6459**DCL      7160--DCLINIT  7161--DCLINIT
JP_SUSR.SYSID
      6468**DCL      6470--REDEF
KEYIN$
      6325**DCL      7410<<ASSIGN   7411>>DOCASE   7417>>ASSIGN
KL_DREC.PASSWORD
      6028**DCL      6032--REDEF
KL_DREC.RENAME
      6051**DCL      6052--REDEF
LDTRC
      7611**LABEL    7614--CALLALT
M$CLOSE
        42**DCL-ENT  7689--CALL     7690--CALL
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:69   
M$EI
      6121**DCL      7667--ASSIGN
M$JOBSTATS
       107**DCL-ENT  7614--CALL
M$MERC
        98**DCL-ENT  7629--CALL
M$OPEN
        42**DCL-ENT  7670--CALL
M$PFIL
        44**DCL-ENT  7682--CALL
M$READ
        43**DCL-ENT  7565--CALL     7684--CALL
M$RENV
        98**DCL-ENT  7559--CALL
M$SENV
        98**DCL-ENT  7624--CALL
M$WRITE
        43**DCL-ENT  7418--CALL     7525--CALL     7603--CALL     7606--CALL     7609--CALL     7612--CALL
      7674--CALL     7675--CALL     7679--CALL     7680--CALL     7687--CALL
MARCHON
      7583**LABEL    7603--CALLALT
MYSTA
      6488**DCL      7161--DCLINIT  7196--DCLINIT  7231--DCLINIT  7266--DCLINIT
MYSTA.MSGIDXT
      6498**DCL      6501--REDEF
NDUN
      7524**LABEL    7487--GOTO     7489--GOTO     7503--GOTO
NEED2READ
      6510**DCL      7388<<ASSIGN   7562>>DOWHILE  7563<<ASSIGN
NODUMP
      7583**LABEL    7584--CALLALT
NOFRAMES
      7502**LABEL    7496--CALLALT
NOSENV IN PROCEDURE SENV
      7625**LABEL    7624--CALLALT
OCMSG_NTBL
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:70   
      6648**DCL      7525<>CALL
OCMSG_NTBL.STATION_
      6650**DCL      6650--REDEF
OCMSG_NTBL.V
      6651**DCL      6648--DCLINIT
OCMSG_NTBL.V.DVBYTE.VFC#
      6657**DCL      6657--REDEF
OCMSG_UNIMP
      6615**DCL      7418<>CALL
OCMSG_UNIMP.STATION_
      6617**DCL      6617--REDEF
OCMSG_UNIMP.V
      6618**DCL      6615--DCLINIT
OCMSG_UNIMP.V.DVBYTE.VFC#
      6624**DCL      6624--REDEF
OPENJD
      6821**DCL      7670<>CALL
OPENJD.ACSVEH_
      6823**DCL      6824--REDEF
OPENJD.ALTKEYS_
      6829**DCL      6830--REDEF    6830--REDEF
OPENJD.HDR_
      6828**DCL      6829--REDEF
OPENJD.TAB_
      6827**DCL      6828--REDEF
OPENJD.UHL_
      6821**DCL      6822--REDEF    6822--REDEF
OPENJD.V
      6830**DCL      6821--DCLINIT
OPENJD.V.FSN#
      6861**DCL      6861--REDEF    6861--REDEF
OPENJD.WSN_
      6827**DCL      6827--REDEF
OPMSG_NTBL
      6566**DCL      6649--DCLINIT  6650--DCLINIT
OPMSG_NTBL.FLAGS
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:71   
      6573**DCL      6574--REDEF
OPMSG_NTBL.LSYSID
      6581**DCL      7524<<ASSIGN
OPMSG_NTBL.MSGID
      6569**DCL      6570--REDEF
OPMSG_UNIMP
      6549**DCL      6616--DCLINIT  6617--DCLINIT
OPMSG_UNIMP.CADDR
      6550**DCL      7417<<ASSIGN
OPMSG_UNIMP.FLAGS
      6556**DCL      6557--REDEF
OPMSG_UNIMP.MSGID
      6552**DCL      6553--REDEF
P$
      6322**DCL      7463>>IF       7465>>ASSIGN   7647<<ASSIGN   7650<<ASSIGN
READEI
      6931**DCL      7684<>CALL
READEI.STATION_
      6934**DCL      6935--REDEF
READEI.V
      6935**DCL      6931--DCLINIT
READEI.V.DVBYTE.REREAD#
      6946**DCL      6946--REDEF
READEI.V.INDX#
      6944**DCL      6944--REDEF
READ_CARD.BUF_.BUF$
      5677**DCL      7678>>ASSIGN
READ_CARD.STATION_
      5677**DCL      5678--REDEF
READ_CARD.V.DVBYTE.REREAD#
      5689**DCL      5689--REDEF
READ_CARD.V.INDX#
      5687**DCL      5687--REDEF
READ_CSCG
      6684**DCL      7565<>CALL
READ_CSCG.STATION_
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:72   
      6687**DCL      6688--REDEF
READ_CSCG.V
      6688**DCL      6684--DCLINIT
READ_CSCG.V.DVBYTE.REREAD#
      6699**DCL      6699--REDEF
READ_CSCG.V.INDX#
      6697**DCL      6697--REDEF
RENV
      6321**DCL      7372<<ASSIGN   7559>>IF       7625<<ASSIGN
REW
      6744**DCL      7682<>CALL
REW.V
      6744**DCL      6744--DCLINIT
RV_DFNAME
      6540**DCL      7584<>CALL
RV_DFNAME.DUMPC
      6540**DCL      7669>>CALLBLT
RV_DFNAME.MONID
      6540**DCL      6540--REDEF
RV_DFNAME.MONID4
      6540**DCL      7669>>CALLBLT
SENV
      7623**PROC     7374--CALL
STARS
      6345**DCL      7055--DCLINIT  7056--DCLINIT  7090--DCLINIT  7091--DCLINIT
STK$
      6319**DCL      7371<<ASSIGN   7375>>ASSIGN   7389>>IF       7402>>IF
UNMAP
      6721**DCL      7614<>CALL
UNMAP.V
      6725**DCL      6721--DCLINIT
WHOCARES
      7605**LABEL    7606--CALLALT
WHOCARES0
      7608**LABEL    7609--CALLALT
WHOCARES1
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:73   
      7611**LABEL    7612--CALLALT
WRITEBTON
      7194**DCL      7606<>CALL
WRITEBTON.STATION_
      7196**DCL      7196--REDEF
WRITEBTON.V
      7197**DCL      7194--DCLINIT
WRITEBTON.V.DVBYTE.VFC#
      7203**DCL      7203--REDEF
WRITECNCL
      7264**DCL      7603<>CALL
WRITECNCL.STATION_
      7266**DCL      7266--REDEF
WRITECNCL.V
      7267**DCL      7264--DCLINIT
WRITECNCL.V.DVBYTE.VFC#
      7273**DCL      7273--REDEF
WRITECOMMENT
      7089**DCL      7675<>CALL
WRITECOMMENT.STATION_
      7091**DCL      7091--REDEF
WRITECOMMENT.V
      7092**DCL      7089--DCLINIT
WRITECOMMENT.V.DVBYTE.VFC#
      7098**DCL      7098--REDEF
WRITEJD
      6974**DCL      7687<>CALL
WRITEJD.BUF_
      6974**DCL      7686<<ASSIGN
WRITEJD.STATION_
      6976**DCL      6976--REDEF
WRITEJD.V
      6977**DCL      6974--DCLINIT
WRITEJD.V.DVBYTE.VFC#
      6983**DCL      6983--REDEF
WRITELINE
PL6.E3A0      #001=JPB$EVENT File=JPB$EVENT.:E05TSI                              TUE 07/29/97 23:33 Page:74   
      7124**DCL      7679<>CALL
WRITELINE.BUF_
      7124**DCL      7677<<ASSIGN   7678<<ASSIGN
WRITELINE.STATION_
      7126**DCL      7126--REDEF
WRITELINE.V
      7127**DCL      7124--DCLINIT
WRITELINE.V.DVBYTE.VFC#
      7133**DCL      7133--REDEF
WRITEOPFB
      7229**DCL      7612<>CALL
WRITEOPFB.STATION_
      7231**DCL      7231--REDEF
WRITEOPFB.V
      7232**DCL      7229--DCLINIT
WRITEOPFB.V.DVBYTE.VFC#
      7238**DCL      7238--REDEF
WRITESTARS
      7054**DCL      7674<>CALL     7680<>CALL
WRITESTARS.STATION_
      7056**DCL      7056--REDEF
WRITESTARS.V
      7057**DCL      7054--DCLINIT
WRITESTARS.V.DVBYTE.VFC#
      7063**DCL      7063--REDEF
WRITESUSR
      7159**DCL      7609<>CALL
WRITESUSR.STATION_
      7161**DCL      7161--REDEF
WRITESUSR.V
      7162**DCL      7159--DCLINIT
WRITESUSR.V.DVBYTE.VFC#
      7168**DCL      7168--REDEF
XCON
      6511**DCL      7564>>IF       7583<<ASSIGN   7583>>ASSIGN   7671>>IF
