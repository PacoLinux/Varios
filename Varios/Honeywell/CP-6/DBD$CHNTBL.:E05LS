VERSION E05

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:1    
        1        1        /*M* DBD$CHNTBL - Display channel table */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        DBD$CHNTBL: PROC(TOP);
        9        9
       10       10        %INCLUDE DB_PERR_C;
       11       28        %INCLUDE KI_CP6;
       12     1124        %INCLUDE KH$CHN;
       13     1246        %INCLUDE G$BOBCAT_M;
       14     1266        %INCLUDE DA_FORMAT_C;
       15     1508        %INCLUDE DA_CMD_C;
       16     1857        %INCLUDE DA_ANLZ_R;
       17     1870        %INCLUDE DB_ANLZ_M;
       18     2037        %INCLUDE XU_MACRO_C;
       19     5143
       20     5144        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
       21     5189        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
       22     5234        %PARSE$SYM (NAME=SYM,STCLASS=BASED);
       23     5272
       24     5273    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       25     5274    1   DCL DAA$ERRMSG ENTRY(1);
       26     5275    1   DCL DAF$INIT ENTRY(1) ALTRET;
       27     5276    1   DCL DAF$WRITE EPTR SYMREF;
       28     5277    1   DCL DBA$EXPRESSION ENTRY(3) ALTRET;
       29     5278    1   DCL DBA$SELECTION ENTRY(3) ALTRET;
       30     5279    1   DCL DBB$EDIT ENTRY(2) ALTRET;
       31     5280    1   DCL DBD$CHNTREE ENTRY(2);
       32     5281    1   DCL DBM$GETBOBCAT ENTRY(1) ALTRET;
       33     5282    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       34     5283    1   DCL DBM$PACK2 ENTRY(2);
       35     5284    1   DCL DBM$PACK4 ENTRY(2);
       36     5285
       37     5286    1   DCL DB_U# SBIN SYMREF;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:2    
       38     5287        %DB_FMT (NAME=DB_FMT,STCLASS="STATIC SYMDEF");
       39     5323        %DB_FMT (NAME=DB_FMT_INIT,STCLASS=CONSTANT);
       40     5359        %DB_FMT (NAME=DB_FMT_DEFAULT,STCLASS="STATIC SYMDEF");
       41     5395        %DB_FMT (NAME=DB$FMT,STCLASS=AUTO);
       42     5431    1   DCL DB$FMTA(0:35) REDEF DB$FMT BIT(1) UNAL;
       43     5432
       44     5433        %G$BOBCAT (FPTN=G$BOBCAT,STCLASS=AUTO);
       45     5446        %KH$CHN (NAME=KH$CHN,STCLASS=AUTO);
       46     5570        %KH$CHN (NAME=KH$CHN_CUR,STCLASS=AUTO);
       47     5694
       48     5695        %REPORT (NAME=CHNRPT, TITLE='Channel Display', EDIT=DBB$EDIT);
       49     5761
       50     5762    1   DCL CHNLOW UBIN;
       51     5763    1   DCL CHNLOWPTR UBIN;
       52     5764    1   DCL CHNHI UBIN;
       53     5765    1   DCL CHNADR UBIN;
       54     5766    1   DCL 1 OPTION,
       55     5767    1    2 CHNADR BIT(1),
       56     5768    1    2 ALL BIT(1),
       57     5769    1    2 FULL BIT(1),
       58     5770    1    2 SYSID BIT(1),
       59     5771    1    2 ATTR BIT(1),
       60     5772    1    2 RES BIT(1);
       61     5773    1   DCL TEMP UBIN;
       62     5774    1   DCL OPTION_SYSID UBIN;
       63     5775    1   DCL OPTION_ATTR UBIN;
       64     5776    1   DCL OPTION_RES CHAR(2);
       65     5777
       66     5778    1   DCL ACTIVESTATES_ CONSTANT BIT(36) INIT('3414'O);
       67     5779    1   DCL ACTIVESTATES(0:35) REDEF ACTIVESTATES_ BIT(1) UNAL;
       68     5780
       69     5781        %EJECT;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:3    
       70     5782
       71     5783    2           CALL OPTIONS WHENALTRETURN DO;
       72     5784    2              RETURN;
       73     5785    2              END;
       74     5786    1           DB_FMT='0'B;
       75     5787    1           DB_FMT.CHT='1'B;
       76     5788    1           DB_FMT.FULL=OPTION.FULL;
       77     5789    1           GOTO COMMON;
       78     5790
       79     5791    1   DBD$FMT: ENTRY(TOP);
       80     5792
       81     5793    2           IF TOP.NSUBLKS=0 THEN DO;
       82     5794    2              CALL DISPOPTS;
       83     5795    2              RETURN;
       84     5796    2              END;
       85     5797    2           CALL OPTIONS WHENALTRETURN DO;
       86     5798    2              RETURN;
       87     5799    2              END;
       88     5800    2           IF DB$FMT THEN DO;
       89     5801    2              DB_FMT=DB$FMT;
       90     5802    2              END;
       91     5803    2           ELSE DO;
       92     5804    2              DB_FMT=DB_FMT_DEFAULT;
       93     5805    2              END;
       94     5806    1           DB_FMT.FULL=OPTION.FULL;
       95     5807    1           GOTO COMMON;
       96     5808
       97     5809    1   DBD$ADD: ENTRY(TOP);
       98     5810
       99     5811    1           CALL OPTIONS;
      100     5812    2           IF DB$FMT THEN DO;
      101     5813    2              DB_FMT_DEFAULT.TREE='0'B;
      102     5814    2              DB_FMT_DEFAULT=DB_FMT_DEFAULT | DB$FMT;
      103     5815    2              END;
      104     5816    2           ELSE DO;
      105     5817    2              DB_FMT_DEFAULT=DB_FMT_INIT;
      106     5818    2              END;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:4    
      107     5819    1           DB_FMT=DB_FMT_DEFAULT;
      108     5820    1           RETURN;
      109     5821
      110     5822    1   DBD$DROP: ENTRY(TOP);
      111     5823
      112     5824    1           CALL OPTIONS;
      113     5825    2           IF DB$FMT THEN DO;
      114     5826    2              DB$FMT=~DB$FMT;
      115     5827    2              DB_FMT_DEFAULT=DB_FMT_DEFAULT & DB$FMT;
      116     5828    2              END;
      117     5829    2           ELSE DO;
      118     5830    2              DB_FMT_DEFAULT='0'B;
      119     5831    2              DB_FMT_DEFAULT.TREE='1'B;
      120     5832    2              END;
      121     5833    1           DB_FMT=DB_FMT_DEFAULT;
      122     5834    1           RETURN;
      123     5835
      124     5836    1   DBD$CHANNELS: ENTRY(TOP);
      125     5837
      126     5838    1           CALL OPTIONS;
      127     5839    1           DB_FMT='0'B;
      128     5840    1           DB_FMT.FULL='1'B;
      129     5841    1           DB_FMT.TREE='1'B;
      130     5842
      131     5843    1   COMMON:;
      132     5844    2           IF OPTION.CHNADR THEN DO;
      133     5845    2              CALL DBD$CHNTREE(KH$CHN,KH$CHN_CUR);
      134     5846    2              RETURN;
      135     5847    2              END;
      136     5848    2           CALL DBM$GETBOBCAT(G$BOBCAT) WHENALTRETURN DO;
      137     5849    2              RETURN;
      138     5850    2              END;
      139     5851    1           CALL DBM$PACK4(G$BOBCAT.CHNLOW$,CHNLOW);
      140     5852    1           CALL DBM$PACK4(G$BOBCAT.CHNHI$,CHNHI);
      141     5853    2           DO WHILE(CHNLOW<=CHNHI);
      142     5854    3              CALL DBM$GETMEM(CHNLOW,KH$CHN,,SIZEC(KH$CHN),,SIZEC(KH$CHN)) WHENRETURN
              5854                       DO;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:5    
      143     5855    3                 IF KH$CHN.TERMID.LEV=0 THEN EXIT;
      144     5856    3                 IF NOT OPTION.ALL AND NOT ACTIVESTATES(KH$CHN.STT.BYT) THEN EXIT;
      145     5857    3                 IF OPTION.RES AND OPTION_RES~=KH$CHN.RESOURCE THEN EXIT;
      146     5858    3                 TEMP=OPTION_SYSID;
      147     5859    3                 CALL DBM$PACK2(KH$CHN.SYSID,DB_U#);
      148     5860    3                 IF OPTION.SYSID THEN TEMP=DB_U#;
      149     5861    3                 IF OPTION_SYSID~=TEMP THEN EXIT;
      150     5862    3                 TEMP=BITBIN('10000'X);
      151     5863    3                 IF OPTION.ATTR THEN CALL DBM$PACK2(KH$CHN.ATTR,TEMP);
      152     5864    3                 IF NOT BINBIT(TEMP,36)&BINBIT(OPTION_ATTR,36) THEN EXIT;
      153     5865    3                 CALL DBD$CHNTREE(KH$CHN,KH$CHN);
      154     5866    3                 END;
      155     5867    3              WHENALTRETURN DO;
      156     5868    3                 CALL DAA$ERRMSG;
      157     5869    3                 END;
      158     5870    2              CHNLOW=CHNLOW+SIZEC(KH$CHN)/2;
      159     5871    2              END;
      160     5872
      161     5873    1           RETURN;
      162     5874
      163     5875    1   OPTIONS: PROC ALTRET;
      164     5876
      165     5877    2   DCL TX SBIN;
      166     5878    2   DCL T$ PTR;
      167     5879    2   DCL SX SBIN;
      168     5880    2   DCL NUM SBIN;
      169     5881    2   DCL LEV SBIN;
      170     5882    2   DCL CHN UBIN;
      171     5883    2   DCL SUBDEV UBIN;
      172     5884    2   DCL SUBSUBDEV UBIN;
      173     5885    2   DCL LNK UBIN;
      174     5886
      175     5887    2           CALL DAF$INIT(CHNRPT);
      176     5888    2           DB$FMT='0'B;
      177     5889    2           OPTION='0'B;
      178     5890    2           OPTION_ATTR=BITBIN('10000'X);
      179     5891    2           LEV=0;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:6    
      180     5892
      181     5893    3           DO TX=0 TO TOP.NSUBLKS-1;
      182     5894    3              T$=TOP.SUBLK$(TX);
      183     5895    4              DO CASE(T$->OUT.CODE);
      184     5896    4               CASE(%DB_CHNTBL_CHN);
      185     5897    4                 OPTION.CHNADR='1'B;
      186     5898    5                 DO SX=0 TO T$->OUT.NSUBLKS-1;
      187     5899    5                    LEV=LEV+1;
      188     5900    6                    CALL DAA$VALUE(T$->OUT.SUBLK$(SX)->OUT,NUM) WHENALTRETURN DO;
      189     5901    6                       ALTRETURN;
      190     5902    6                       END;
      191     5903    6                    DO CASE(SX);
      192     5904    6                     CASE(0);
      193     5905    6                       CHN=(NUM/128)*128;
      194     5906    6                     CASE(1);
      195     5907    6                       SUBDEV=NUM;
      196     5908    6                     CASE(2);
      197     5909    6                       SUBSUBDEV=NUM;
      198     5910    6                     END;
      199     5911    5                    END;
      200     5912    5                 CALL DBM$GETBOBCAT(G$BOBCAT) WHENALTRETURN DO;
      201     5913    5                    RETURN;
      202     5914    5                    END;
      203     5915    4                 CALL DBM$PACK2(G$BOBCAT.CHNLOW,CHNLOW);
      204     5916    4                 CALL DBM$PACK4(G$BOBCAT.CHNLOW$,CHNLOWPTR);
      205     5917    4                 CALL DBM$PACK2(G$BOBCAT.CHNHI,CHNHI);
      206     5918    5                 IF CHN<CHNLOW OR CHN>CHNHI THEN DO;
      207     5919    5                    CALL SETERR(%E$DB_BAD_CHAN);
      208     5920        /*E*             ERROR:  DBD-E$DB_BAD_CHAN
      209     5921                         MESSAGE:  Invalid channel identifier.
      210     5922        */
      211     5923    5                    ALTRETURN;
      212     5924    5                    END;
      213     5925    4                 CHNADR=CHNLOWPTR+CHN*SIZEC(KH$CHN)/256;
      214     5926    5                 CALL DBM$GETMEM(CHNADR,KH$CHN,,SIZEC(KH$CHN),,SIZEC(KH$CHN))
              5926                          WHENALTRETURN DO;
      215     5927    5                    ALTRETURN;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:7    
      216     5928    5                    END;
      217     5929    4                 KH$CHN_CUR=KH$CHN;
      218     5930    4                 CALL DBM$PACK2(KH$CHN_CUR.SYSID,DB_U#);
      219     5931    4                 CALL DBM$PACK4(KH$CHN_CUR.SUB$,LNK);
      220     5932    5                 IF LEV>1 THEN DO UNTIL NUM=SUBDEV;
      221     5933    6                       IF LNK=0 THEN DO;
      222     5934    6                          CALL SETERR(%E$DB_BAD_CHAN);
      223     5935    6                          ALTRETURN;
      224     5936    6                          END;
      225     5937    6                       CALL DBM$GETMEM(LNK,KH$CHN_CUR,DB_U#,SIZEC(KH$CHN),,SIZEC(KH$CHN
              5937                                )) WHENALTRETURN DO;
      226     5938    6                          ALTRETURN;
      227     5939    6                          END;
      228     5940    5                       CALL DBM$PACK2(KH$CHN_CUR.TERMID.TERM.SUBDEVICE,NUM);
      229     5941    5                       CALL DBM$PACK4(KH$CHN_CUR.LNK$,LNK);
      230     5942    5                       END;
      231     5943    4                    CALL DBM$PACK4(KH$CHN_CUR.SUB$,LNK);
      232     5944    5                    IF LEV>2 THEN DO UNTIL NUM=SUBSUBDEV;
      233     5945    6                          IF LNK=0 THEN DO;
      234     5946    6                             CALL SETERR(%E$DB_BAD_CHAN);
      235     5947    6                             ALTRETURN;
      236     5948    6                             END;
      237     5949    6                          CALL DBM$GETMEM(LNK,KH$CHN_CUR,DB_U#,SIZEC(KH$CHN),,SIZEC(
              5949                                   KH$CHN)) WHENALTRETURN DO;
      238     5950    6                             ALTRETURN;
      239     5951    6                             END;
      240     5952    5                          CALL DBM$PACK2(KH$CHN_CUR.TERMID.TERM.SUBSUBDEVICE,NUM);
      241     5953    5                          CALL DBM$PACK4(KH$CHN_CUR.LNK$,LNK);
      242     5954    5                    END;
      243     5955    4               CASE(%DB_CHNTBL_AT);
      244     5956    4                 OPTION.CHNADR='1'B;
      245     5957    4                 IF T$->OUT.NSUBLKS>1
      246     5958    4                 THEN CALL DBA$SELECTION(T$->OUT.SUBLK$(1)->OUT,DB_U#)
      247     5959    5                 WHENALTRETURN DO; RETURN; END;
      248     5960    4                 ELSE DB_U# = 0;
      249     5961    4                 CALL DBA$EXPRESSION(T$->OUT.SUBLK$(0)->OUT,CHNADR,DB_U#)
      250     5962    5                 WHENALTRETURN DO; ALTRETURN; END;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:8    
      251     5963    4                 CALL DBM$GETMEM(CHNADR,KH$CHN,DB_U#,SIZEC(KH$CHN),,SIZEC(KH$CHN))
      252     5964    5                 WHENALTRETURN DO; ALTRETURN; END;
      253     5965    4                 KH$CHN_CUR=KH$CHN;
      254     5966    4               CASE(%DB_CHNTBL_FULL);
      255     5967    4                 OPTION.FULL='1'B;
      256     5968    4               CASE(%DB_CHNTBL_ALL);
      257     5969    4                 OPTION.ALL='1'B;
      258     5970    4               CASE(%DB_CHNTBL_BUSY);
      259     5971    4               CASE(%DB_CHNTBL_RES);
      260     5972    4                 OPTION.RES='1'B;
      261     5973    4                 OPTION_RES=T$->OUT.SUBLK$(0)->SYM.TEXT;
      262     5974    4               CASE(%DB_CHNTBL_SYSID);
      263     5975    4                 OPTION.SYSID='1'B;
      264     5976    4                 CALL DAA$VALUE(T$->OUT.SUBLK$(0)->OUT,OPTION_SYSID);
      265     5977    4               CASE(%DB_CHNTBL_ATTR);
      266     5978    4                 OPTION.ATTR='1'B;
      267     5979    4                 CALL DAA$VALUE(T$->OUT.SUBLK$(0)->OUT,OPTION_ATTR);
      268     5980    4               CASE(%DB_CHNTBL_OPT);
      269     5981    5                 DO SX=0 TO T$->OUT.NSUBLKS-1;
      270     5982    5                    DB$FMTA(T$->OUT.SUBLK$(SX)->OUT.CODE+2)='1'B;
      271     5983    5                    END;
      272     5984    4               END;
      273     5985    3              END;
      274     5986    2           RETURN;
      275     5987
      276     5988    2   END OPTIONS;
      277     5989
      278     5990    1   DISPOPTS: PROC;
      279     5991
      280     5992    2   DCL FMT0 CHAR(0) CONSTANT INIT('%/%\Display Options: %>A');
      281     5993    2   DCL FMT1 CHAR(0) CONSTANT INIT('%\, %7R%>A');
      282     5994    2   DCL FMT2 CHAR(0) CONSTANT INIT('%\%/');
      283     5995    2   DCL FMTV VECTOR;
      284     5996    2   DCL I UBIN;
      285     5997    2   DCL B(0:35) BIT(1);
      286     5998    2   DCL NONE CHAR(0) CONSTANT INIT('None');
      287     5999    2   DCL FLAGNAMES(0:18) CHAR(4) CONSTANT INIT('FULL',
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:9    
      288     6000    2                                             'TREE',
      289     6001    2                                             'CHT ',
      290     6002    2                                             'VDI ',
      291     6003    2                                             'OTP ',
      292     6004    2                                             'PST ',
      293     6005    2                                             'INP ',
      294     6006    2                                             'SSN ',
      295     6007    2                                             'TYP ',
      296     6008    2                                             'STR ',
      297     6009    2                                             'LCT ',
      298     6010    2                                             'ERD ',
      299     6011    2                                             'FLD ',
      300     6012    2                                             'MRD ',
      301     6013    2                                             'MVD ',
      302     6014    2                                             'RCR ',
      303     6015    2                                             'SRD ',
      304     6016    2                                             'TRC ',
      305     6017    2                                             'USR ');
      306     6018
      307     6019    2           B=DB_FMT_DEFAULT;
      308     6020    2           FMTV=VECTOR(FMT0);
      309     6021    3           DO I=0 TO SIZEW(FLAGNAMES)-1;
      310     6022    4              IF B(I) THEN DO;
      311     6023    4                 CALL DAF$WRITE(FMTV,VECTOR(FLAGNAMES(I)));
      312     6024    4                 FMTV=VECTOR(FMT1);
      313     6025    4                 END;
      314     6026    3              END;
      315     6027    3           IF FMTV=VECTOR(FMT0) THEN DO;
      316     6028    3              CALL DAF$WRITE(FMTV,VECTOR(NONE));
      317     6029    3              END;
      318     6030    2           CALL DAF$WRITE(VECTOR(FMT2));
      319     6031    2           RETURN;
      320     6032
      321     6033    2   END DISPOPTS;
      322     6034
      323     6035
      324     6036    1   SETERR: PROC(CODE);
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:10   
      325     6037
      326     6038    2   DCL CODE UBIN;
      327     6039
      328     6040    2           DA_ANLZERR='040204000000'O;
      329     6041    2           DA_ANLZERR.CODE=CODE;
      330     6042    2           RETURN;
      331     6043
      332     6044    2   END SETERR;
      333     6045
      334     6046    1   END DBD$CHNTBL;
      335     6047
      336     6048        %EOD;

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:11   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   DB_ANLZ_M.:E05TOU  is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   DB_PERR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DBD$CHNTBL.

   Procedure DBD$CHNTBL requires 674 words for executable code.
   Procedure DBD$CHNTBL requires 118 words of local(AUTO) storage.

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:12   

 Object Unit name= DBD$CHNTBL                                 File name= DBD$CHNTBL.:E05TOU
 UTS= JUL 29 '97 13:00:08.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    14     16  DBD$CHNTBL
    1  RoData even  UTS     34     42  DBD$CHNTBL
    2   Proc  even  none   674   1242  DBD$CHNTBL
    3  RoData even  none    25     31  DBD$CHNTBL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  DBD$CHNTBL
     2     17                  yes      Std        1  DBD$FMT
     2     53                  yes      Std        1  DBD$ADD
     2    103                  yes      Std        1  DBD$DROP
     2    137                  yes      Std        1  DBD$CHANNELS

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  DB_FMT                             0      1  DB_FMT_DEFAULT
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DBB$EDIT
         yes           Std       2 DBM$PACK4
 yes     yes           Std      10 DBM$GETMEM
         yes           Std       2 DBM$PACK2
         yes           Std       1 DAA$ERRMSG
         yes           Std       2 DBD$CHNTREE
 yes     yes           Std       1 DBM$GETBOBCAT
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       3 DAA$VALUE
 yes     yes           Std       3 DBA$EXPRESSION
 yes     yes           Std       3 DBA$SELECTION
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DA_ANLZERR                            DAF$WRITE                             DB_U#
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:14   


        1        1        /*M* DBD$CHNTBL - Display channel table */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        DBD$CHNTBL: PROC(TOP);

      8  2 000000   000000 700200 xent  DBD$CHNTBL   TSX0  ! X66_AUTO_1
         2 000001   000166 000001                    ZERO    118,1

        9        9
       10       10        %INCLUDE DB_PERR_C;
       11       28        %INCLUDE KI_CP6;
       12     1124        %INCLUDE KH$CHN;
       13     1246        %INCLUDE G$BOBCAT_M;
       14     1266        %INCLUDE DA_FORMAT_C;
       15     1508        %INCLUDE DA_CMD_C;
       16     1857        %INCLUDE DA_ANLZ_R;
       17     1870        %INCLUDE DB_ANLZ_M;
       18     2037        %INCLUDE XU_MACRO_C;
       19     5143
       20     5144        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
       21     5189        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
       22     5234        %PARSE$SYM (NAME=SYM,STCLASS=BASED);
       23     5272
       24     5273    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       25     5274    1   DCL DAA$ERRMSG ENTRY(1);
       26     5275    1   DCL DAF$INIT ENTRY(1) ALTRET;
       27     5276    1   DCL DAF$WRITE EPTR SYMREF;
       28     5277    1   DCL DBA$EXPRESSION ENTRY(3) ALTRET;
       29     5278    1   DCL DBA$SELECTION ENTRY(3) ALTRET;
       30     5279    1   DCL DBB$EDIT ENTRY(2) ALTRET;
       31     5280    1   DCL DBD$CHNTREE ENTRY(2);
       32     5281    1   DCL DBM$GETBOBCAT ENTRY(1) ALTRET;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:15   
       33     5282    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       34     5283    1   DCL DBM$PACK2 ENTRY(2);
       35     5284    1   DCL DBM$PACK4 ENTRY(2);
       36     5285
       37     5286    1   DCL DB_U# SBIN SYMREF;
       38     5287        %DB_FMT (NAME=DB_FMT,STCLASS="STATIC SYMDEF");
       39     5323        %DB_FMT (NAME=DB_FMT_INIT,STCLASS=CONSTANT);
       40     5359        %DB_FMT (NAME=DB_FMT_DEFAULT,STCLASS="STATIC SYMDEF");
       41     5395        %DB_FMT (NAME=DB$FMT,STCLASS=AUTO);
       42     5431    1   DCL DB$FMTA(0:35) REDEF DB$FMT BIT(1) UNAL;
       43     5432
       44     5433        %G$BOBCAT (FPTN=G$BOBCAT,STCLASS=AUTO);
       45     5446        %KH$CHN (NAME=KH$CHN,STCLASS=AUTO);
       46     5570        %KH$CHN (NAME=KH$CHN_CUR,STCLASS=AUTO);
       47     5694
       48     5695        %REPORT (NAME=CHNRPT, TITLE='Channel Display', EDIT=DBB$EDIT);
       49     5761
       50     5762    1   DCL CHNLOW UBIN;
       51     5763    1   DCL CHNLOWPTR UBIN;
       52     5764    1   DCL CHNHI UBIN;
       53     5765    1   DCL CHNADR UBIN;
       54     5766    1   DCL 1 OPTION,
       55     5767    1    2 CHNADR BIT(1),
       56     5768    1    2 ALL BIT(1),
       57     5769    1    2 FULL BIT(1),
       58     5770    1    2 SYSID BIT(1),
       59     5771    1    2 ATTR BIT(1),
       60     5772    1    2 RES BIT(1);
       61     5773    1   DCL TEMP UBIN;
       62     5774    1   DCL OPTION_SYSID UBIN;
       63     5775    1   DCL OPTION_ATTR UBIN;
       64     5776    1   DCL OPTION_RES CHAR(2);
       65     5777
       66     5778    1   DCL ACTIVESTATES_ CONSTANT BIT(36) INIT('3414'O);
       67     5779    1   DCL ACTIVESTATES(0:35) REDEF ACTIVESTATES_ BIT(1) UNAL;
       68     5780
       69     5781        %EJECT;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:16   
       70     5782
       71     5783    2           CALL OPTIONS WHENALTRETURN DO;

   5783  2 000002   000347 701000 2                  TSX1    OPTIONS
         2 000003   000005 702000 2                  TSX2    s:5784
         2 000004   000006 710000 2                  TRA     s:5786

       72     5784    2              RETURN;

   5784  2 000005   000000 702200 xent               TSX2  ! X66_ARET

       73     5785    2              END;
       74     5786    1           DB_FMT='0'B;

   5786  2 000006   000000 450000 0                  STZ     DB_FMT

       75     5787    1           DB_FMT.CHT='1'B;

   5787  2 000007   100000 236003                    LDQ     32768,DU
         2 000010   000000 256000 0                  ORSQ    DB_FMT

       76     5788    1           DB_FMT.FULL=OPTION.FULL;

   5788  2 000011   200136 236100                    LDQ     OPTION,,AUTO
         2 000012   000002 736000                    QLS     2
         2 000013   000000 676000 0                  ERQ     DB_FMT
         2 000014   400000 376003                    ANQ     -131072,DU
         2 000015   000000 656000 0                  ERSQ    DB_FMT

       77     5789    1           GOTO COMMON;

   5789  2 000016   000150 710000 2                  TRA     COMMON

       78     5790
       79     5791    1   DBD$FMT: ENTRY(TOP);

   5791  2 000017   000000 700200 xent  DBD$FMT      TSX0  ! X66_AUTO_1
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:17   
         2 000020   000166 000001                    ZERO    118,1

       80     5792
       81     5793    2           IF TOP.NSUBLKS=0 THEN DO;

   5793  2 000021   200003 470500                    LDP0    @TOP,,AUTO
         2 000022   000001 220100                    LDX0    1,,PR0
         2 000023   000027 601000 2                  TNZ     s:5797

       82     5794    2              CALL DISPOPTS;

   5794  2 000024   001142 701000 2                  TSX1    DISPOPTS
         2 000025   000000 011000                    NOP     0

       83     5795    2              RETURN;

   5795  2 000026   000000 702200 xent               TSX2  ! X66_ARET

       84     5796    2              END;
       85     5797    2           CALL OPTIONS WHENALTRETURN DO;

   5797  2 000027   000347 701000 2                  TSX1    OPTIONS
         2 000030   000032 702000 2                  TSX2    s:5798
         2 000031   000033 710000 2                  TRA     s:5800

       86     5798    2              RETURN;

   5798  2 000032   000000 702200 xent               TSX2  ! X66_ARET

       87     5799    2              END;
       88     5800    2           IF DB$FMT THEN DO;

   5800  2 000033   200004 236100                    LDQ     DB$FMT,,AUTO
         2 000034   000000 316000 3                  CANQ    0
         2 000035   000042 600000 2                  TZE     s:5804

       89     5801    2              DB_FMT=DB$FMT;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:18   

   5801  2 000036   200004 236100                    LDQ     DB$FMT,,AUTO
         2 000037   000000 376000 3                  ANQ     0
         2 000040   000000 756000 0                  STQ     DB_FMT

       90     5802    2              END;

   5802  2 000041   000045 710000 2                  TRA     s:5806

       91     5803    2           ELSE DO;

       92     5804    2              DB_FMT=DB_FMT_DEFAULT;

   5804  2 000042   000001 236000 0                  LDQ     DB_FMT_DEFAULT
         2 000043   000000 376000 3                  ANQ     0
         2 000044   000000 756000 0                  STQ     DB_FMT

       93     5805    2              END;

       94     5806    1           DB_FMT.FULL=OPTION.FULL;

   5806  2 000045   200136 236100                    LDQ     OPTION,,AUTO
         2 000046   000002 736000                    QLS     2
         2 000047   000000 676000 0                  ERQ     DB_FMT
         2 000050   400000 376003                    ANQ     -131072,DU
         2 000051   000000 656000 0                  ERSQ    DB_FMT

       95     5807    1           GOTO COMMON;

   5807  2 000052   000150 710000 2                  TRA     COMMON

       96     5808
       97     5809    1   DBD$ADD: ENTRY(TOP);

   5809  2 000053   000000 700200 xent  DBD$ADD      TSX0  ! X66_AUTO_1
         2 000054   000166 000001                    ZERO    118,1

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:19   
       98     5810
       99     5811    1           CALL OPTIONS;

   5811  2 000055   000347 701000 2                  TSX1    OPTIONS
         2 000056   000000 011000                    NOP     0

      100     5812    2           IF DB$FMT THEN DO;

   5812  2 000057   200004 236100                    LDQ     DB$FMT,,AUTO
         2 000060   000000 316000 3                  CANQ    0
         2 000061   000074 600000 2                  TZE     s:5817

      101     5813    2              DB_FMT_DEFAULT.TREE='0'B;

   5813  2 000062   000001 236000 3                  LDQ     1
         2 000063   000001 356000 0                  ANSQ    DB_FMT_DEFAULT

      102     5814    2              DB_FMT_DEFAULT=DB_FMT_DEFAULT | DB$FMT;

   5814  2 000064   200004 236100                    LDQ     DB$FMT,,AUTO
         2 000065   000000 376000 3                  ANQ     0
         2 000066   200160 756100                    STQ     @CODE+1,,AUTO
         2 000067   000001 236000 0                  LDQ     DB_FMT_DEFAULT
         2 000070   000000 376000 3                  ANQ     0
         2 000071   200160 276100                    ORQ     @CODE+1,,AUTO
         2 000072   000001 756000 0                  STQ     DB_FMT_DEFAULT

      103     5815    2              END;

   5815  2 000073   000077 710000 2                  TRA     s:5819

      104     5816    2           ELSE DO;

      105     5817    2              DB_FMT_DEFAULT=DB_FMT_INIT;

   5817  2 000074   000000 236000 1                  LDQ     DB_FMT_INIT
         2 000075   000000 376000 3                  ANQ     0
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:20   
         2 000076   000001 756000 0                  STQ     DB_FMT_DEFAULT

      106     5818    2              END;

      107     5819    1           DB_FMT=DB_FMT_DEFAULT;

   5819  2 000077   000001 236000 0                  LDQ     DB_FMT_DEFAULT
         2 000100   000000 376000 3                  ANQ     0
         2 000101   000000 756000 0                  STQ     DB_FMT

      108     5820    1           RETURN;

   5820  2 000102   000000 702200 xent               TSX2  ! X66_ARET

      109     5821
      110     5822    1   DBD$DROP: ENTRY(TOP);

   5822  2 000103   000000 700200 xent  DBD$DROP     TSX0  ! X66_AUTO_1
         2 000104   000166 000001                    ZERO    118,1

      111     5823
      112     5824    1           CALL OPTIONS;

   5824  2 000105   000347 701000 2                  TSX1    OPTIONS
         2 000106   000000 011000                    NOP     0

      113     5825    2           IF DB$FMT THEN DO;

   5825  2 000107   200004 236100                    LDQ     DB$FMT,,AUTO
         2 000110   000000 316000 3                  CANQ    0
         2 000111   000130 600000 2                  TZE     s:5830

      114     5826    2              DB$FMT=~DB$FMT;

   5826  2 000112   200004 236100                    LDQ     DB$FMT,,AUTO
         2 000113   000000 376000 3                  ANQ     0
         2 000114   000000 676000 3                  ERQ     0
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:21   
         2 000115   200004 676100                    ERQ     DB$FMT,,AUTO
         2 000116   000000 376000 3                  ANQ     0
         2 000117   200004 656100                    ERSQ    DB$FMT,,AUTO

      115     5827    2              DB_FMT_DEFAULT=DB_FMT_DEFAULT & DB$FMT;

   5827  2 000120   200004 236100                    LDQ     DB$FMT,,AUTO
         2 000121   000000 376000 3                  ANQ     0
         2 000122   200160 756100                    STQ     @CODE+1,,AUTO
         2 000123   000001 236000 0                  LDQ     DB_FMT_DEFAULT
         2 000124   000000 376000 3                  ANQ     0
         2 000125   200160 376100                    ANQ     @CODE+1,,AUTO
         2 000126   000001 756000 0                  STQ     DB_FMT_DEFAULT

      116     5828    2              END;

   5828  2 000127   000133 710000 2                  TRA     s:5833

      117     5829    2           ELSE DO;

      118     5830    2              DB_FMT_DEFAULT='0'B;

   5830  2 000130   000001 450000 0                  STZ     DB_FMT_DEFAULT

      119     5831    2              DB_FMT_DEFAULT.TREE='1'B;

   5831  2 000131   200000 236003                    LDQ     65536,DU
         2 000132   000001 256000 0                  ORSQ    DB_FMT_DEFAULT

      120     5832    2              END;

      121     5833    1           DB_FMT=DB_FMT_DEFAULT;

   5833  2 000133   000001 236000 0                  LDQ     DB_FMT_DEFAULT
         2 000134   000000 376000 3                  ANQ     0
         2 000135   000000 756000 0                  STQ     DB_FMT

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:22   
      122     5834    1           RETURN;

   5834  2 000136   000000 702200 xent               TSX2  ! X66_ARET

      123     5835
      124     5836    1   DBD$CHANNELS: ENTRY(TOP);

   5836  2 000137   000000 700200 xent  DBD$CHANNELS TSX0  ! X66_AUTO_1
         2 000140   000166 000001                    ZERO    118,1

      125     5837
      126     5838    1           CALL OPTIONS;

   5838  2 000141   000347 701000 2                  TSX1    OPTIONS
         2 000142   000000 011000                    NOP     0

      127     5839    1           DB_FMT='0'B;

   5839  2 000143   000000 450000 0                  STZ     DB_FMT

      128     5840    1           DB_FMT.FULL='1'B;

   5840  2 000144   400000 236003                    LDQ     -131072,DU
         2 000145   000000 256000 0                  ORSQ    DB_FMT

      129     5841    1           DB_FMT.TREE='1'B;

   5841  2 000146   200000 236003                    LDQ     65536,DU
         2 000147   000000 256000 0                  ORSQ    DB_FMT

   5841  2 000150                       COMMON       null
      130     5842
      131     5843    1   COMMON:;
      132     5844    2           IF OPTION.CHNADR THEN DO;

   5844  2 000150   200136 234100                    SZN     OPTION,,AUTO
         2 000151   000163 605000 2                  TPL     s:5848
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:23   

      133     5845    2              CALL DBD$CHNTREE(KH$CHN,KH$CHN_CUR);

   5845  2 000152   200112 630500                    EPPR0   KH$CHN_CUR,,AUTO
         2 000153   200161 450500                    STP0    @CODE+2,,AUTO
         2 000154   200072 631500                    EPPR1   KH$CHN,,AUTO
         2 000155   200160 451500                    STP1    @CODE+1,,AUTO
         2 000156   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000157   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000160   000000 701000 xent               TSX1    DBD$CHNTREE
         2 000161   000000 011000                    NOP     0

      134     5846    2              RETURN;

   5846  2 000162   000000 702200 xent               TSX2  ! X66_ARET

      135     5847    2              END;
      136     5848    2           CALL DBM$GETBOBCAT(G$BOBCAT) WHENALTRETURN DO;

   5848  2 000163   200005 630500                    EPPR0   G$BOBCAT,,AUTO
         2 000164   200160 450500                    STP0    @CODE+1,,AUTO
         2 000165   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000166   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000167   000000 701000 xent               TSX1    DBM$GETBOBCAT
         2 000170   000172 702000 2                  TSX2    s:5849
         2 000171   000173 710000 2                  TRA     s:5851

      137     5849    2              RETURN;

   5849  2 000172   000000 702200 xent               TSX2  ! X66_ARET

      138     5850    2              END;
      139     5851    1           CALL DBM$PACK4(G$BOBCAT.CHNLOW$,CHNLOW);

   5851  2 000173   200132 630500                    EPPR0   CHNLOW,,AUTO
         2 000174   200161 450500                    STP0    @CODE+2,,AUTO
         2 000175   200041 631500                    EPPR1   G$BOBCAT+28,,AUTO
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:24   
         2 000176   200160 451500                    STP1    @CODE+1,,AUTO
         2 000177   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000200   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000201   000000 701000 xent               TSX1    DBM$PACK4
         2 000202   000000 011000                    NOP     0

      140     5852    1           CALL DBM$PACK4(G$BOBCAT.CHNHI$,CHNHI);

   5852  2 000203   200134 630500                    EPPR0   CHNHI,,AUTO
         2 000204   200161 450500                    STP0    @CODE+2,,AUTO
         2 000205   200042 631500                    EPPR1   G$BOBCAT+29,,AUTO
         2 000206   200160 451500                    STP1    @CODE+1,,AUTO
         2 000207   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000210   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000211   000000 701000 xent               TSX1    DBM$PACK4
         2 000212   000000 011000                    NOP     0

      141     5853    2           DO WHILE(CHNLOW<=CHNHI);

   5853  2 000213   200134 236100                    LDQ     CHNHI,,AUTO
         2 000214   200132 116100                    CMPQ    CHNLOW,,AUTO
         2 000215   000346 602000 2                  TNC     s:5873

      142     5854    3              CALL DBM$GETMEM(CHNLOW,KH$CHN,,SIZEC(KH$CHN),,SIZEC(KH$CHN)) WHENRETURN
              5854                       DO;

   5854  2 000216   000003 236000 3                  LDQ     3
         2 000217   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000220   200164 757100                    STAQ    @CODE+5,,AUTO
         2 000221   000003 236000 3                  LDQ     3
         2 000222   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000223   200162 757100                    STAQ    @CODE+3,,AUTO
         2 000224   200072 630500                    EPPR0   KH$CHN,,AUTO
         2 000225   200161 450500                    STP0    @CODE+2,,AUTO
         2 000226   200132 631500                    EPPR1   CHNLOW,,AUTO
         2 000227   200160 451500                    STP1    @CODE+1,,AUTO
         2 000230   200160 630500                    EPPR0   @CODE+1,,AUTO
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:25   
         2 000231   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000232   000000 701000 xent               TSX1    DBM$GETMEM
         2 000233   000335 702000 2                  TSX2    s:5868

      143     5855    3                 IF KH$CHN.TERMID.LEV=0 THEN EXIT;

   5855  2 000234   200103 236100                    LDQ     KH$CHN+9,,AUTO
         2 000235   000777 316003                    CANQ    511,DU
         2 000236   000334 600000 2                  TZE     s:5866

      144     5856    3                 IF NOT OPTION.ALL AND NOT ACTIVESTATES(KH$CHN.STT.BYT) THEN EXIT;

   5856  2 000237   200136 236100                    LDQ     OPTION,,AUTO
         2 000240   200000 316003                    CANQ    65536,DU
         2 000241   000251 601000 2                  TNZ     s:5857
         2 000242   200072 236100                    LDQ     KH$CHN,,AUTO
         2 000243   000011 772000                    QRL     9
         2 000244   000377 376007                    ANQ     255,DL
         2 000245   000000 066406                    CMPB    filb='0'B
         2 000246   000001 000001 1                  BDSC    ACTIVESTATES_,Q          by=0,bit=0,n=1
         2 000247   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000250   000334 600000 2                  TZE     s:5866

      145     5857    3                 IF OPTION.RES AND OPTION_RES~=KH$CHN.RESOURCE THEN EXIT;

   5857  2 000251   200136 236100                    LDQ     OPTION,,AUTO
         2 000252   010000 316003                    CANQ    4096,DU
         2 000253   000257 600000 2                  TZE     s:5858
         2 000254   200142 220100                    LDX0    OPTION_RES,,AUTO
         2 000255   200074 100100                    CMPX0   KH$CHN+2,,AUTO
         2 000256   000334 601000 2                  TNZ     s:5866

      146     5858    3                 TEMP=OPTION_SYSID;

   5858  2 000257   200140 235100                    LDA     OPTION_SYSID,,AUTO
         2 000260   200137 755100                    STA     TEMP,,AUTO

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:26   
      147     5859    3                 CALL DBM$PACK2(KH$CHN.SYSID,DB_U#);

   5859  2 000261   000004 236000 3                  LDQ     4
         2 000262   200161 756100                    STQ     @CODE+2,,AUTO
         2 000263   200075 630500                    EPPR0   KH$CHN+3,,AUTO
         2 000264   200160 450500                    STP0    @CODE+1,,AUTO
         2 000265   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000266   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000267   000000 701000 xent               TSX1    DBM$PACK2
         2 000270   000000 011000                    NOP     0

      148     5860    3                 IF OPTION.SYSID THEN TEMP=DB_U#;

   5860  2 000271   200136 236100                    LDQ     OPTION,,AUTO
         2 000272   040000 316003                    CANQ    16384,DU
         2 000273   000276 600000 2                  TZE     s:5861

   5860  2 000274   000000 235000 xsym               LDA     DB_U#
         2 000275   200137 755100                    STA     TEMP,,AUTO

      149     5861    3                 IF OPTION_SYSID~=TEMP THEN EXIT;

   5861  2 000276   200140 236100                    LDQ     OPTION_SYSID,,AUTO
         2 000277   200137 116100                    CMPQ    TEMP,,AUTO
         2 000300   000334 601000 2                  TNZ     s:5866

      150     5862    3                 TEMP=BITBIN('10000'X);

   5862  2 000301   000040 236000 1                  LDQ     FLAGNAMES+19
         2 000302   000020 772000                    QRL     16
         2 000303   200137 756100                    STQ     TEMP,,AUTO

      151     5863    3                 IF OPTION.ATTR THEN CALL DBM$PACK2(KH$CHN.ATTR,TEMP);

   5863  2 000304   200136 236100                    LDQ     OPTION,,AUTO
         2 000305   020000 316003                    CANQ    8192,DU
         2 000306   000321 600000 2                  TZE     s:5864
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:27   

   5863  2 000307   200137 630500                    EPPR0   TEMP,,AUTO
         2 000310   200161 450500                    STP0    @CODE+2,,AUTO
         2 000311   200162 452500                    STP2    @CODE+3,,AUTO
         2 000312   200162 236100                    LDQ     @CODE+3,,AUTO
         2 000313   000005 036000 3                  ADLQ    5
         2 000314   200160 756100                    STQ     @CODE+1,,AUTO
         2 000315   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000316   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000317   000000 701000 xent               TSX1    DBM$PACK2
         2 000320   000000 011000                    NOP     0

      152     5864    3                 IF NOT BINBIT(TEMP,36)&BINBIT(OPTION_ATTR,36) THEN EXIT;

   5864  2 000321   200137 236100                    LDQ     TEMP,,AUTO
         2 000322   200141 376100                    ANQ     OPTION_ATTR,,AUTO
         2 000323   000334 600000 2                  TZE     s:5866

      153     5865    3                 CALL DBD$CHNTREE(KH$CHN,KH$CHN);

   5865  2 000324   200072 630500                    EPPR0   KH$CHN,,AUTO
         2 000325   200161 450500                    STP0    @CODE+2,,AUTO
         2 000326   200072 631500                    EPPR1   KH$CHN,,AUTO
         2 000327   200160 451500                    STP1    @CODE+1,,AUTO
         2 000330   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000331   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000332   000000 701000 xent               TSX1    DBD$CHNTREE
         2 000333   000000 011000                    NOP     0

      154     5866    3                 END;

   5866  2 000334   000340 710000 2                  TRA     s:5870

      155     5867    3              WHENALTRETURN DO;

      156     5868    3                 CALL DAA$ERRMSG;

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:28   
   5868  2 000335   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000336   000000 701000 xent               TSX1    DAA$ERRMSG
         2 000337   000000 011000                    NOP     0

      157     5869    3                 END;

      158     5870    2              CHNLOW=CHNLOW+SIZEC(KH$CHN)/2;

   5870  2 000340   200132 235100                    LDA     CHNLOW,,AUTO
         2 000341   000040 035007                    ADLA    32,DL
         2 000342   200132 755100                    STA     CHNLOW,,AUTO

      159     5871    2              END;

   5871  2 000343   200134 236100                    LDQ     CHNHI,,AUTO
         2 000344   200132 116100                    CMPQ    CHNLOW,,AUTO
         2 000345   000216 603000 2                  TRC     s:5854

      160     5872
      161     5873    1           RETURN;

   5873  2 000346   000000 702200 xent               TSX2  ! X66_ARET

      162     5874
      163     5875    1   OPTIONS: PROC ALTRET;

   5875  2 000347   200144 741300       OPTIONS      STX1  ! OPTION_RES+2,,AUTO

      164     5876
      165     5877    2   DCL TX SBIN;
      166     5878    2   DCL T$ PTR;
      167     5879    2   DCL SX SBIN;
      168     5880    2   DCL NUM SBIN;
      169     5881    2   DCL LEV SBIN;
      170     5882    2   DCL CHN UBIN;
      171     5883    2   DCL SUBDEV UBIN;
      172     5884    2   DCL SUBSUBDEV UBIN;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:29   
      173     5885    2   DCL LNK UBIN;
      174     5886
      175     5887    2           CALL DAF$INIT(CHNRPT);

   5887  2 000350   000006 630400 3                  EPPR0   6
         2 000351   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000352   000000 701000 xent               TSX1    DAF$INIT
         2 000353   000000 011000                    NOP     0

      176     5888    2           DB$FMT='0'B;

   5888  2 000354   377777 236007                    LDQ     131071,DL
         2 000355   200004 356100                    ANSQ    DB$FMT,,AUTO

      177     5889    2           OPTION='0'B;

   5889  2 000356   200136 450100                    STZ     OPTION,,AUTO

      178     5890    2           OPTION_ATTR=BITBIN('10000'X);

   5890  2 000357   000040 236000 1                  LDQ     FLAGNAMES+19
         2 000360   000020 772000                    QRL     16
         2 000361   200141 756100                    STQ     OPTION_ATTR,,AUTO

      179     5891    2           LEV=0;

   5891  2 000362   200151 450100                    STZ     LEV,,AUTO

      180     5892
      181     5893    3           DO TX=0 TO TOP.NSUBLKS-1;

   5893  2 000363   200145 450100                    STZ     TX,,AUTO
         2 000364   001133 710000 2                  TRA     s:5985+1

      182     5894    3              T$=TOP.SUBLK$(TX);

   5894  2 000365   200003 470500                    LDP0    @TOP,,AUTO
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:30   
         2 000366   200145 720100                    LXL0    TX,,AUTO
         2 000367   000003 236110                    LDQ     3,X0,PR0
         2 000370   200146 756100                    STQ     T$,,AUTO

      183     5895    4              DO CASE(T$->OUT.CODE);

   5895  2 000371   200146 471500                    LDP1    T$,,AUTO
         2 000372   100000 721100                    LXL1    0,,PR1
         2 000373   000011 101003                    CMPX1   9,DU
         2 000374   000376 602011 2                  TNC     s:5895+5,X1
         2 000375   001132 710000 2                  TRA     s:5985
         2 000376   000407 710000 2                  TRA     s:5897
         2 000377   000760 710000 2                  TRA     s:5956
         2 000400   001044 710000 2                  TRA     s:5967
         2 000401   001112 710000 2                  TRA     s:5981
         2 000402   001047 710000 2                  TRA     s:5969
         2 000403   001077 710000 2                  TRA     s:5978
         2 000404   001132 710000 2                  TRA     s:5985
         2 000405   001052 710000 2                  TRA     s:5972
         2 000406   001064 710000 2                  TRA     s:5975

      184     5896    4               CASE(%DB_CHNTBL_CHN);

      185     5897    4                 OPTION.CHNADR='1'B;

   5897  2 000407   400000 236003                    LDQ     -131072,DU
         2 000410   200136 256100                    ORSQ    OPTION,,AUTO

      186     5898    5                 DO SX=0 TO T$->OUT.NSUBLKS-1;

   5898  2 000411   200147 450100                    STZ     SX,,AUTO
         2 000412   000453 710000 2                  TRA     s:5911+1

      187     5899    5                    LEV=LEV+1;

   5899  2 000413   200151 054100                    AOS     LEV,,AUTO

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:31   
      188     5900    6                    CALL DAA$VALUE(T$->OUT.SUBLK$(SX)->OUT,NUM) WHENALTRETURN DO;

   5900  2 000414   200146 470500                    LDP0    T$,,AUTO
         2 000415   200147 720100                    LXL0    SX,,AUTO
         2 000416   000003 471510                    LDP1    3,X0,PR0
         2 000417   200150 633500                    EPPR3   NUM,,AUTO
         2 000420   200161 453500                    STP3    @CODE+2,,AUTO
         2 000421   200160 451500                    STP1    @CODE+1,,AUTO
         2 000422   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000423   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000424   000000 701000 xent               TSX1    DAA$VALUE
         2 000425   000427 702000 2                  TSX2    s:5901
         2 000426   000431 710000 2                  TRA     s:5903

      189     5901    6                       ALTRETURN;

   5901  2 000427   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000430   000000 702211                    TSX2  ! 0,X1

      190     5902    6                       END;
      191     5903    6                    DO CASE(SX);

   5903  2 000431   200147 235100                    LDA     SX,,AUTO
         2 000432   000003 115007                    CMPA    3,DL
         2 000433   000435 602005 2                  TNC     s:5903+4,AL
         2 000434   000452 710000 2                  TRA     s:5911
         2 000435   000440 710000 2                  TRA     s:5905
         2 000436   000445 710000 2                  TRA     s:5907
         2 000437   000450 710000 2                  TRA     s:5909

      192     5904    6                     CASE(0);

      193     5905    6                       CHN=(NUM/128)*128;

   5905  2 000440   200150 236100                    LDQ     NUM,,AUTO
         2 000441   000200 506007                    DIV     128,DL
         2 000442   000007 736000                    QLS     7
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:32   
         2 000443   200152 756100                    STQ     CHN,,AUTO
         2 000444   000452 710000 2                  TRA     s:5911

      194     5906    6                     CASE(1);

      195     5907    6                       SUBDEV=NUM;

   5907  2 000445   200150 236100                    LDQ     NUM,,AUTO
         2 000446   200153 756100                    STQ     SUBDEV,,AUTO
         2 000447   000452 710000 2                  TRA     s:5911

      196     5908    6                     CASE(2);

      197     5909    6                       SUBSUBDEV=NUM;

   5909  2 000450   200150 236100                    LDQ     NUM,,AUTO
         2 000451   200154 756100                    STQ     SUBSUBDEV,,AUTO

      198     5910    6                     END;

      199     5911    5                    END;

   5911  2 000452   200147 054100                    AOS     SX,,AUTO
         2 000453   200146 470500                    LDP0    T$,,AUTO
         2 000454   000001 236100                    LDQ     1,,PR0
         2 000455   000022 772000                    QRL     18
         2 000456   200147 116100                    CMPQ    SX,,AUTO
         2 000457   000413 605400 2                  TPNZ    s:5899

      200     5912    5                 CALL DBM$GETBOBCAT(G$BOBCAT) WHENALTRETURN DO;

   5912  2 000460   200005 631500                    EPPR1   G$BOBCAT,,AUTO
         2 000461   200160 451500                    STP1    @CODE+1,,AUTO
         2 000462   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000464   000000 701000 xent               TSX1    DBM$GETBOBCAT
         2 000465   000467 702000 2                  TSX2    s:5913
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:33   
         2 000466   000471 710000 2                  TRA     s:5915

      201     5913    5                    RETURN;

   5913  2 000467   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000470   000001 702211                    TSX2  ! 1,X1

      202     5914    5                    END;
      203     5915    4                 CALL DBM$PACK2(G$BOBCAT.CHNLOW,CHNLOW);

   5915  2 000471   200132 630500                    EPPR0   CHNLOW,,AUTO
         2 000472   200161 450500                    STP0    @CODE+2,,AUTO
         2 000473   200037 631500                    EPPR1   G$BOBCAT+26,,AUTO
         2 000474   200160 451500                    STP1    @CODE+1,,AUTO
         2 000475   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000476   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000477   000000 701000 xent               TSX1    DBM$PACK2
         2 000500   000000 011000                    NOP     0

      204     5916    4                 CALL DBM$PACK4(G$BOBCAT.CHNLOW$,CHNLOWPTR);

   5916  2 000501   200133 630500                    EPPR0   CHNLOWPTR,,AUTO
         2 000502   200161 450500                    STP0    @CODE+2,,AUTO
         2 000503   200041 631500                    EPPR1   G$BOBCAT+28,,AUTO
         2 000504   200160 451500                    STP1    @CODE+1,,AUTO
         2 000505   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000506   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000507   000000 701000 xent               TSX1    DBM$PACK4
         2 000510   000000 011000                    NOP     0

      205     5917    4                 CALL DBM$PACK2(G$BOBCAT.CHNHI,CHNHI);

   5917  2 000511   200134 630500                    EPPR0   CHNHI,,AUTO
         2 000512   200161 450500                    STP0    @CODE+2,,AUTO
         2 000513   200162 452500                    STP2    @CODE+3,,AUTO
         2 000514   200162 236100                    LDQ     @CODE+3,,AUTO
         2 000515   000007 036000 3                  ADLQ    7
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:34   
         2 000516   200160 756100                    STQ     @CODE+1,,AUTO
         2 000517   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000520   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000521   000000 701000 xent               TSX1    DBM$PACK2
         2 000522   000000 011000                    NOP     0

      206     5918    5                 IF CHN<CHNLOW OR CHN>CHNHI THEN DO;

   5918  2 000523   200152 236100                    LDQ     CHN,,AUTO
         2 000524   200132 116100                    CMPQ    CHNLOW,,AUTO
         2 000525   000531 602000 2                  TNC     s:5919
         2 000526   200134 116100                    CMPQ    CHNHI,,AUTO
         2 000527   000537 602000 2                  TNC     s:5925
         2 000530   000537 600000 2                  TZE     s:5925

      207     5919    5                    CALL SETERR(%E$DB_BAD_CHAN);

   5919  2 000531   000010 236000 3                  LDQ     8
         2 000532   200157 756100                    STQ     LNK+2,,AUTO
         2 000533   001230 701000 2                  TSX1    SETERR
         2 000534   000000 011000                    NOP     0

      208     5920        /*E*             ERROR:  DBD-E$DB_BAD_CHAN
      209     5921                         MESSAGE:  Invalid channel identifier.
      210     5922        */
      211     5923    5                    ALTRETURN;

   5923  2 000535   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000536   000000 702211                    TSX2  ! 0,X1

      212     5924    5                    END;
      213     5925    4                 CHNADR=CHNLOWPTR+CHN*SIZEC(KH$CHN)/256;

   5925  2 000537   000006 736000                    QLS     6
         2 000540   000010 772000                    QRL     8
         2 000541   200133 036100                    ADLQ    CHNLOWPTR,,AUTO
         2 000542   200135 756100                    STQ     CHNADR,,AUTO
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:35   

      214     5926    5                 CALL DBM$GETMEM(CHNADR,KH$CHN,,SIZEC(KH$CHN),,SIZEC(KH$CHN))
              5926                          WHENALTRETURN DO;

   5926  2 000543   000003 236000 3                  LDQ     3
         2 000544   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000545   200164 757100                    STAQ    @CODE+5,,AUTO
         2 000546   000003 236000 3                  LDQ     3
         2 000547   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000550   200162 757100                    STAQ    @CODE+3,,AUTO
         2 000551   200072 630500                    EPPR0   KH$CHN,,AUTO
         2 000552   200161 450500                    STP0    @CODE+2,,AUTO
         2 000553   200135 631500                    EPPR1   CHNADR,,AUTO
         2 000554   200160 451500                    STP1    @CODE+1,,AUTO
         2 000555   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000556   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000557   000000 701000 xent               TSX1    DBM$GETMEM
         2 000560   000562 702000 2                  TSX2    s:5927
         2 000561   000564 710000 2                  TRA     s:5929

      215     5927    5                    ALTRETURN;

   5927  2 000562   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000563   000000 702211                    TSX2  ! 0,X1

      216     5928    5                    END;
      217     5929    4                 KH$CHN_CUR=KH$CHN;

   5929  2 000564   000100 100500                    MLR     fill='000'O
         2 000565   200072 000100                    ADSC9   KH$CHN,,AUTO             cn=0,n=64
         2 000566   200112 000100                    ADSC9   KH$CHN_CUR,,AUTO         cn=0,n=64

      218     5930    4                 CALL DBM$PACK2(KH$CHN_CUR.SYSID,DB_U#);

   5930  2 000567   000004 236000 3                  LDQ     4
         2 000570   200161 756100                    STQ     @CODE+2,,AUTO
         2 000571   200115 630500                    EPPR0   KH$CHN_CUR+3,,AUTO
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:36   
         2 000572   200160 450500                    STP0    @CODE+1,,AUTO
         2 000573   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000574   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000575   000000 701000 xent               TSX1    DBM$PACK2
         2 000576   000000 011000                    NOP     0

      219     5931    4                 CALL DBM$PACK4(KH$CHN_CUR.SUB$,LNK);

   5931  2 000577   200155 630500                    EPPR0   LNK,,AUTO
         2 000600   200161 450500                    STP0    @CODE+2,,AUTO
         2 000601   200127 631500                    EPPR1   KH$CHN_CUR+13,,AUTO
         2 000602   200160 451500                    STP1    @CODE+1,,AUTO
         2 000603   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000604   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000605   000000 701000 xent               TSX1    DBM$PACK4
         2 000606   000000 011000                    NOP     0

      220     5932    5                 IF LEV>1 THEN DO UNTIL NUM=SUBDEV;

   5932  2 000607   200151 235100                    LDA     LEV,,AUTO
         2 000610   000001 115007                    CMPA    1,DL
         2 000611   000666 604400 2                  TMOZ    s:5943

      221     5933    6                       IF LNK=0 THEN DO;

   5933  2 000612   200155 235100                    LDA     LNK,,AUTO
         2 000613   000622 601000 2                  TNZ     s:5937

      222     5934    6                          CALL SETERR(%E$DB_BAD_CHAN);

   5934  2 000614   000010 236000 3                  LDQ     8
         2 000615   200157 756100                    STQ     LNK+2,,AUTO
         2 000616   001230 701000 2                  TSX1    SETERR
         2 000617   000000 011000                    NOP     0

      223     5935    6                          ALTRETURN;

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:37   
   5935  2 000620   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000621   000000 702211                    TSX2  ! 0,X1

      224     5936    6                          END;
      225     5937    6                      CALL DBM$GETMEM(LNK,KH$CHN_CUR,DB_U#,SIZEC(KH$CHN),,SIZEC(KH$CHN
              5937                                )) WHENALTRETURN DO;

   5937  2 000622   000003 236000 3                  LDQ     3
         2 000623   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000624   200164 757100                    STAQ    @CODE+5,,AUTO
         2 000625   000012 237000 3                  LDAQ    10
         2 000626   200162 757100                    STAQ    @CODE+3,,AUTO
         2 000627   200112 630500                    EPPR0   KH$CHN_CUR,,AUTO
         2 000630   200161 450500                    STP0    @CODE+2,,AUTO
         2 000631   200155 631500                    EPPR1   LNK,,AUTO
         2 000632   200160 451500                    STP1    @CODE+1,,AUTO
         2 000633   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000634   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000635   000000 701000 xent               TSX1    DBM$GETMEM
         2 000636   000640 702000 2                  TSX2    s:5938
         2 000637   000642 710000 2                  TRA     s:5940

      226     5938    6                          ALTRETURN;

   5938  2 000640   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000641   000000 702211                    TSX2  ! 0,X1

      227     5939    6                          END;
      228     5940    5                       CALL DBM$PACK2(KH$CHN_CUR.TERMID.TERM.SUBDEVICE,NUM);

   5940  2 000642   200150 630500                    EPPR0   NUM,,AUTO
         2 000643   200161 450500                    STP0    @CODE+2,,AUTO
         2 000644   200124 631500                    EPPR1   KH$CHN_CUR+10,,AUTO
         2 000645   200160 451500                    STP1    @CODE+1,,AUTO
         2 000646   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000647   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000650   000000 701000 xent               TSX1    DBM$PACK2
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:38   
         2 000651   000000 011000                    NOP     0

      229     5941    5                       CALL DBM$PACK4(KH$CHN_CUR.LNK$,LNK);

   5941  2 000652   200155 630500                    EPPR0   LNK,,AUTO
         2 000653   200161 450500                    STP0    @CODE+2,,AUTO
         2 000654   200130 631500                    EPPR1   KH$CHN_CUR+14,,AUTO
         2 000655   200160 451500                    STP1    @CODE+1,,AUTO
         2 000656   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000660   000000 701000 xent               TSX1    DBM$PACK4
         2 000661   000000 011000                    NOP     0

      230     5942    5                       END;

   5942  2 000662   200150 236100                    LDQ     NUM,,AUTO
         2 000663   000612 604000 2                  TMI     s:5933
         2 000664   200153 116100                    CMPQ    SUBDEV,,AUTO
         2 000665   000612 601000 2                  TNZ     s:5933

      231     5943    4                    CALL DBM$PACK4(KH$CHN_CUR.SUB$,LNK);

   5943  2 000666   200155 630500                    EPPR0   LNK,,AUTO
         2 000667   200161 450500                    STP0    @CODE+2,,AUTO
         2 000670   200127 631500                    EPPR1   KH$CHN_CUR+13,,AUTO
         2 000671   200160 451500                    STP1    @CODE+1,,AUTO
         2 000672   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000673   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000674   000000 701000 xent               TSX1    DBM$PACK4
         2 000675   000000 011000                    NOP     0

      232     5944    5                    IF LEV>2 THEN DO UNTIL NUM=SUBSUBDEV;

   5944  2 000676   200151 235100                    LDA     LEV,,AUTO
         2 000677   000002 115007                    CMPA    2,DL
         2 000700   001132 604400 2                  TMOZ    s:5985

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:39   
      233     5945    6                          IF LNK=0 THEN DO;

   5945  2 000701   200155 235100                    LDA     LNK,,AUTO
         2 000702   000711 601000 2                  TNZ     s:5949

      234     5946    6                             CALL SETERR(%E$DB_BAD_CHAN);

   5946  2 000703   000010 236000 3                  LDQ     8
         2 000704   200157 756100                    STQ     LNK+2,,AUTO
         2 000705   001230 701000 2                  TSX1    SETERR
         2 000706   000000 011000                    NOP     0

      235     5947    6                             ALTRETURN;

   5947  2 000707   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000710   000000 702211                    TSX2  ! 0,X1

      236     5948    6                             END;
      237     5949    6                          CALL DBM$GETMEM(LNK,KH$CHN_CUR,DB_U#,SIZEC(KH$CHN),,SIZEC(
              5949                                   KH$CHN)) WHENALTRETURN DO;

   5949  2 000711   000003 236000 3                  LDQ     3
         2 000712   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000713   200164 757100                    STAQ    @CODE+5,,AUTO
         2 000714   000012 237000 3                  LDAQ    10
         2 000715   200162 757100                    STAQ    @CODE+3,,AUTO
         2 000716   200112 630500                    EPPR0   KH$CHN_CUR,,AUTO
         2 000717   200161 450500                    STP0    @CODE+2,,AUTO
         2 000720   200155 631500                    EPPR1   LNK,,AUTO
         2 000721   200160 451500                    STP1    @CODE+1,,AUTO
         2 000722   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000723   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000724   000000 701000 xent               TSX1    DBM$GETMEM
         2 000725   000727 702000 2                  TSX2    s:5950
         2 000726   000731 710000 2                  TRA     s:5952

      238     5950    6                             ALTRETURN;
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:40   

   5950  2 000727   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000730   000000 702211                    TSX2  ! 0,X1

      239     5951    6                             END;
      240     5952    5                          CALL DBM$PACK2(KH$CHN_CUR.TERMID.TERM.SUBSUBDEVICE,NUM);

   5952  2 000731   200150 630500                    EPPR0   NUM,,AUTO
         2 000732   200161 450500                    STP0    @CODE+2,,AUTO
         2 000733   200162 452500                    STP2    @CODE+3,,AUTO
         2 000734   200162 236100                    LDQ     @CODE+3,,AUTO
         2 000735   000014 036000 3                  ADLQ    12
         2 000736   200160 756100                    STQ     @CODE+1,,AUTO
         2 000737   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000740   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000741   000000 701000 xent               TSX1    DBM$PACK2
         2 000742   000000 011000                    NOP     0

      241     5953    5                          CALL DBM$PACK4(KH$CHN_CUR.LNK$,LNK);

   5953  2 000743   200155 630500                    EPPR0   LNK,,AUTO
         2 000744   200161 450500                    STP0    @CODE+2,,AUTO
         2 000745   200130 631500                    EPPR1   KH$CHN_CUR+14,,AUTO
         2 000746   200160 451500                    STP1    @CODE+1,,AUTO
         2 000747   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000750   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000751   000000 701000 xent               TSX1    DBM$PACK4
         2 000752   000000 011000                    NOP     0

      242     5954    5                    END;

   5954  2 000753   200150 236100                    LDQ     NUM,,AUTO
         2 000754   000701 604000 2                  TMI     s:5945
         2 000755   200154 116100                    CMPQ    SUBSUBDEV,,AUTO
         2 000756   000701 601000 2                  TNZ     s:5945
         2 000757   001132 710000 2                  TRA     s:5985

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:41   
      243     5955    4               CASE(%DB_CHNTBL_AT);

      244     5956    4                 OPTION.CHNADR='1'B;

   5956  2 000760   400000 236003                    LDQ     -131072,DU
         2 000761   200136 256100                    ORSQ    OPTION,,AUTO

      245     5957    4                 IF T$->OUT.NSUBLKS>1

   5957  2 000762   100001 222100                    LDX2    1,,PR1
         2 000763   000002 102003                    CMPX2   2,DU
         2 000764   001001 602000 2                  TNC     s:5960

      246     5958    4                 THEN CALL DBA$SELECTION(T$->OUT.SUBLK$(1)->OUT,DB_U#)

   5958  2 000765   100004 473500                    LDP3    4,,PR1
         2 000766   000004 236000 3                  LDQ     4
         2 000767   200161 756100                    STQ     @CODE+2,,AUTO
         2 000770   200160 453500                    STP3    @CODE+1,,AUTO
         2 000771   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 000772   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000773   000000 701000 xent               TSX1    DBA$SELECTION
         2 000774   000776 702000 2                  TSX2    s:5959
         2 000775   001000 710000 2                  TRA     s:5959+2

      247     5959    5                 WHENALTRETURN DO; RETURN; END;

   5959  2 000776   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 000777   000001 702211                    TSX2  ! 1,X1
         2 001000   001002 710000 2                  TRA     s:5961

      248     5960    4                 ELSE DB_U# = 0;

   5960  2 001001   000000 450000 xsym               STZ     DB_U#

      249     5961    4                 CALL DBA$EXPRESSION(T$->OUT.SUBLK$(0)->OUT,CHNADR,DB_U#)

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:42   
   5961  2 001002   200146 470500                    LDP0    T$,,AUTO
         2 001003   000003 471500                    LDP1    3,,PR0
         2 001004   000004 236000 3                  LDQ     4
         2 001005   200162 756100                    STQ     @CODE+3,,AUTO
         2 001006   200135 633500                    EPPR3   CHNADR,,AUTO
         2 001007   200161 453500                    STP3    @CODE+2,,AUTO
         2 001010   200160 451500                    STP1    @CODE+1,,AUTO
         2 001011   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 001012   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001013   000000 701000 xent               TSX1    DBA$EXPRESSION
         2 001014   001016 702000 2                  TSX2    s:5962
         2 001015   001020 710000 2                  TRA     s:5963

      250     5962    5                 WHENALTRETURN DO; ALTRETURN; END;

   5962  2 001016   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 001017   000000 702211                    TSX2  ! 0,X1

      251     5963    4                 CALL DBM$GETMEM(CHNADR,KH$CHN,DB_U#,SIZEC(KH$CHN),,SIZEC(KH$CHN))

   5963  2 001020   000003 236000 3                  LDQ     3
         2 001021   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001022   200164 757100                    STAQ    @CODE+5,,AUTO
         2 001023   000012 237000 3                  LDAQ    10
         2 001024   200162 757100                    STAQ    @CODE+3,,AUTO
         2 001025   200072 630500                    EPPR0   KH$CHN,,AUTO
         2 001026   200161 450500                    STP0    @CODE+2,,AUTO
         2 001027   200135 631500                    EPPR1   CHNADR,,AUTO
         2 001030   200160 451500                    STP1    @CODE+1,,AUTO
         2 001031   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 001032   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001033   000000 701000 xent               TSX1    DBM$GETMEM
         2 001034   001036 702000 2                  TSX2    s:5964
         2 001035   001040 710000 2                  TRA     s:5965

      252     5964    5                 WHENALTRETURN DO; ALTRETURN; END;

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:43   
   5964  2 001036   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 001037   000000 702211                    TSX2  ! 0,X1

      253     5965    4                 KH$CHN_CUR=KH$CHN;

   5965  2 001040   000100 100500                    MLR     fill='000'O
         2 001041   200072 000100                    ADSC9   KH$CHN,,AUTO             cn=0,n=64
         2 001042   200112 000100                    ADSC9   KH$CHN_CUR,,AUTO         cn=0,n=64
         2 001043   001132 710000 2                  TRA     s:5985

      254     5966    4               CASE(%DB_CHNTBL_FULL);

      255     5967    4                 OPTION.FULL='1'B;

   5967  2 001044   100000 236003                    LDQ     32768,DU
         2 001045   200136 256100                    ORSQ    OPTION,,AUTO
         2 001046   001132 710000 2                  TRA     s:5985

      256     5968    4               CASE(%DB_CHNTBL_ALL);

      257     5969    4                 OPTION.ALL='1'B;

   5969  2 001047   200000 236003                    LDQ     65536,DU
         2 001050   200136 256100                    ORSQ    OPTION,,AUTO
         2 001051   001132 710000 2                  TRA     s:5985

      258     5970    4               CASE(%DB_CHNTBL_BUSY);

      259     5971    4               CASE(%DB_CHNTBL_RES);

      260     5972    4                 OPTION.RES='1'B;

   5972  2 001052   010000 236003                    LDQ     4096,DU
         2 001053   200136 256100                    ORSQ    OPTION,,AUTO

      261     5973    4                 OPTION_RES=T$->OUT.SUBLK$(0)->SYM.TEXT;

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:44   
   5973  2 001054   100003 473500                    LDP3    3,,PR1
         2 001055   300004 236100                    LDQ     4,,PR3
         2 001056   000033 772000                    QRL     27
         2 001057   000000 622006                    EAX2    0,QL
         2 001060   040100 100540                    MLR     fill='040'O
         2 001061   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         2 001062   200142 000002                    ADSC9   OPTION_RES,,AUTO         cn=0,n=2
         2 001063   001132 710000 2                  TRA     s:5985

      262     5974    4               CASE(%DB_CHNTBL_SYSID);

      263     5975    4                 OPTION.SYSID='1'B;

   5975  2 001064   040000 236003                    LDQ     16384,DU
         2 001065   200136 256100                    ORSQ    OPTION,,AUTO

      264     5976    4                 CALL DAA$VALUE(T$->OUT.SUBLK$(0)->OUT,OPTION_SYSID);

   5976  2 001066   100003 473500                    LDP3    3,,PR1
         2 001067   200140 634500                    EPPR4   OPTION_SYSID,,AUTO
         2 001070   200161 454500                    STP4    @CODE+2,,AUTO
         2 001071   200160 453500                    STP3    @CODE+1,,AUTO
         2 001072   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 001073   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001074   000000 701000 xent               TSX1    DAA$VALUE
         2 001075   000000 011000                    NOP     0
         2 001076   001132 710000 2                  TRA     s:5985

      265     5977    4               CASE(%DB_CHNTBL_ATTR);

      266     5978    4                 OPTION.ATTR='1'B;

   5978  2 001077   020000 236003                    LDQ     8192,DU
         2 001100   200136 256100                    ORSQ    OPTION,,AUTO

      267     5979    4                 CALL DAA$VALUE(T$->OUT.SUBLK$(0)->OUT,OPTION_ATTR);

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:45   
   5979  2 001101   100003 473500                    LDP3    3,,PR1
         2 001102   200141 634500                    EPPR4   OPTION_ATTR,,AUTO
         2 001103   200161 454500                    STP4    @CODE+2,,AUTO
         2 001104   200160 453500                    STP3    @CODE+1,,AUTO
         2 001105   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 001106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001107   000000 701000 xent               TSX1    DAA$VALUE
         2 001110   000000 011000                    NOP     0
         2 001111   001132 710000 2                  TRA     s:5985

      268     5980    4               CASE(%DB_CHNTBL_OPT);

      269     5981    5                 DO SX=0 TO T$->OUT.NSUBLKS-1;

   5981  2 001112   200147 450100                    STZ     SX,,AUTO
         2 001113   001125 710000 2                  TRA     s:5983+1

      270     5982    5                    DB$FMTA(T$->OUT.SUBLK$(SX)->OUT.CODE+2)='1'B;

   5982  2 001114   200146 470500                    LDP0    T$,,AUTO
         2 001115   200147 720100                    LXL0    SX,,AUTO
         2 001116   000003 471510                    LDP1    3,X0,PR0
         2 001117   100000 236100                    LDQ     0,,PR1
         2 001120   777777 376007                    ANQ     -1,DL
         2 001121   003106 060400                    CSL     bolr='003'O
         2 001122   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 001123   200004 020001                    BDSC    DB$FMT,Q,AUTO            by=0,bit=2,n=1

      271     5983    5                    END;

   5983  2 001124   200147 054100                    AOS     SX,,AUTO
         2 001125   200146 470500                    LDP0    T$,,AUTO
         2 001126   000001 236100                    LDQ     1,,PR0
         2 001127   000022 772000                    QRL     18
         2 001130   200147 116100                    CMPQ    SX,,AUTO
         2 001131   001114 605400 2                  TPNZ    s:5982

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:46   
      272     5984    4               END;

      273     5985    3              END;

   5985  2 001132   200145 054100                    AOS     TX,,AUTO
         2 001133   200003 470500                    LDP0    @TOP,,AUTO
         2 001134   000001 236100                    LDQ     1,,PR0
         2 001135   000022 772000                    QRL     18
         2 001136   200145 116100                    CMPQ    TX,,AUTO
         2 001137   000365 605400 2                  TPNZ    s:5894

      274     5986    2           RETURN;

   5986  2 001140   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 001141   000001 702211                    TSX2  ! 1,X1

      275     5987
      276     5988    2   END OPTIONS;
      277     5989
      278     5990    1   DISPOPTS: PROC;

   5990  2 001142   200144 741300       DISPOPTS     STX1  ! OPTION_RES+2,,AUTO

      279     5991
      280     5992    2   DCL FMT0 CHAR(0) CONSTANT INIT('%/%\Display Options: %>A');
      281     5993    2   DCL FMT1 CHAR(0) CONSTANT INIT('%\, %7R%>A');
      282     5994    2   DCL FMT2 CHAR(0) CONSTANT INIT('%\%/');
      283     5995    2   DCL FMTV VECTOR;
      284     5996    2   DCL I UBIN;
      285     5997    2   DCL B(0:35) BIT(1);
      286     5998    2   DCL NONE CHAR(0) CONSTANT INIT('None');
      287     5999    2   DCL FLAGNAMES(0:18) CHAR(4) CONSTANT INIT('FULL',
      288     6000    2                                             'TREE',
      289     6001    2                                             'CHT ',
      290     6002    2                                             'VDI ',
      291     6003    2                                             'OTP ',
      292     6004    2                                             'PST ',
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:47   
      293     6005    2                                             'INP ',
      294     6006    2                                             'SSN ',
      295     6007    2                                             'TYP ',
      296     6008    2                                             'STR ',
      297     6009    2                                             'LCT ',
      298     6010    2                                             'ERD ',
      299     6011    2                                             'FLD ',
      300     6012    2                                             'MRD ',
      301     6013    2                                             'MVD ',
      302     6014    2                                             'RCR ',
      303     6015    2                                             'SRD ',
      304     6016    2                                             'TRC ',
      305     6017    2                                             'USR ');
      306     6018
      307     6019    2           B=DB_FMT_DEFAULT;

   6019  2 001143   000001 236000 0                  LDQ     DB_FMT_DEFAULT
         2 001144   000000 376000 3                  ANQ     0
         2 001145   200151 756100                    STQ     B,,AUTO

      308     6020    2           FMTV=VECTOR(FMT0);

   6020  2 001146   000016 237000 3                  LDAQ    14
         2 001147   200146 757100                    STAQ    FMTV,,AUTO

      309     6021    3           DO I=0 TO SIZEW(FLAGNAMES)-1;

   6021  2 001150   200150 450100                    STZ     I,,AUTO
         2 001151   001202 710000 2                  TRA     s:6026+3

      310     6022    4              IF B(I) THEN DO;

   6022  2 001152   200150 235100                    LDA     I,,AUTO
         2 001153   000000 066505                    CMPB    filb='0'B
         2 001154   200151 000001                    BDSC    B,A,AUTO                 by=0,bit=0,n=1
         2 001155   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 001156   001177 600000 2                  TZE     s:6026
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:48   

      311     6023    4                 CALL DAF$WRITE(FMTV,VECTOR(FLAGNAMES(I)));

   6023  2 001157   777640 235007                    LDA     -96,DL
         2 001160   200150 236100                    LDQ     I,,AUTO
         2 001161   000022 736000                    QLS     18
         2 001162   000015 036000 3                  ADLQ    13
         2 001163   200160 757100                    STAQ    @CODE+1,,AUTO
         2 001164   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 001165   200163 450500                    STP0    @CODE+4,,AUTO
         2 001166   200146 631500                    EPPR1   FMTV,,AUTO
         2 001167   200162 451500                    STP1    @CODE+3,,AUTO
         2 001170   200162 630500                    EPPR0   @CODE+3,,AUTO
         2 001171   000000 220000 xsym               LDX0    DAF$WRITE
         2 001172   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001173   000000 701010                    TSX1    0,X0
         2 001174   000000 011000                    NOP     0

      312     6024    4                 FMTV=VECTOR(FMT1);

   6024  2 001175   000020 237000 3                  LDAQ    16
         2 001176   200146 757100                    STAQ    FMTV,,AUTO

      313     6025    4                 END;

      314     6026    3              END;

   6026  2 001177   200150 235100                    LDA     I,,AUTO
         2 001200   000001 035007                    ADLA    1,DL
         2 001201   200150 755100                    STA     I,,AUTO
         2 001202   200150 235100                    LDA     I,,AUTO
         2 001203   000023 115007                    CMPA    19,DL
         2 001204   001152 602000 2                  TNC     s:6022

      315     6027    3           IF FMTV=VECTOR(FMT0) THEN DO;

   6027  2 001205   200146 237100                    LDAQ    FMTV,,AUTO
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:49   
         2 001206   000016 117000 3                  CMPAQ   14
         2 001207   001221 601000 2                  TNZ     s:6030

      316     6028    3              CALL DAF$WRITE(FMTV,VECTOR(NONE));

   6028  2 001210   000024 236000 3                  LDQ     20
         2 001211   200161 756100                    STQ     @CODE+2,,AUTO
         2 001212   200146 630500                    EPPR0   FMTV,,AUTO
         2 001213   200160 450500                    STP0    @CODE+1,,AUTO
         2 001214   200160 630500                    EPPR0   @CODE+1,,AUTO
         2 001215   000000 220000 xsym               LDX0    DAF$WRITE
         2 001216   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001217   000000 701010                    TSX1    0,X0
         2 001220   000000 011000                    NOP     0

      317     6029    3              END;

      318     6030    2           CALL DAF$WRITE(VECTOR(FMT2));

   6030  2 001221   000030 630400 3                  EPPR0   24
         2 001222   000000 220000 xsym               LDX0    DAF$WRITE
         2 001223   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001224   000000 701010                    TSX1    0,X0
         2 001225   000000 011000                    NOP     0

      319     6031    2           RETURN;

   6031  2 001226   200144 221300                    LDX1  ! OPTION_RES+2,,AUTO
         2 001227   000001 702211                    TSX2  ! 1,X1

      320     6032
      321     6033    2   END DISPOPTS;
      322     6034
      323     6035
      324     6036    1   SETERR: PROC(CODE);

   6036  2 001230   200156 741300       SETERR       STX1  ! LNK+1,,AUTO
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:50   

      325     6037
      326     6038    2   DCL CODE UBIN;
      327     6039
      328     6040    2           DA_ANLZERR='040204000000'O;

   6040  2 001231   000041 236000 1                  LDQ     FLAGNAMES+20
         2 001232   000000 756000 xsym               STQ     DA_ANLZERR

      329     6041    2           DA_ANLZERR.CODE=CODE;

   6041  2 001233   200157 470500                    LDP0    @CODE,,AUTO
         2 001234   000000 236100                    LDQ     0,,PR0
         2 001235   000003 736000                    QLS     3
         2 001236   000000 676000 xsym               ERQ     DA_ANLZERR
         2 001237   377770 376007                    ANQ     131064,DL
         2 001240   000000 656000 xsym               ERSQ    DA_ANLZERR

      330     6042    2           RETURN;

   6042  2 001241   000001 702211                    TSX2  ! 1,X1
      331     6043
      332     6044    2   END SETERR;
      333     6045
      334     6046    1   END DBD$CHNTBL;
      335     6047
      336     6048        %EOD;

PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:51   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   DB_ANLZ_M.:E05TOU  is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   DB_PERR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DBD$CHNTBL.
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:52   

 **** Variables and constants ****

  ****  Section 000  Data  DBD$CHNTBL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/w STRC(288)   r     1 CHNRPT                    12-0-0/c STRC(144)   r     1 CHNRPTTX00
     0-0-0/w STRC(19)    r     1 DB_FMT                     1-0-0/w STRC(19)    r     1 DB_FMT_DEFAULT

  ****  Section 001 RoData DBD$CHNTBL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b BIT         r     1 ACTIVESTATES(0:35)
     1-0-0/b BIT         r     1 ACTIVESTATES_              0-0-0/w STRC(19)    r     1 DB_FMT_INIT
    15-0-0/c CHAR(4)     r     1 FLAGNAMES(0:18)
     2-0-0/c CHAR(24)    r     1 FMT0                      10-0-0/c CHAR(10)    r     1 FMT1
    13-0-0/c CHAR(4)     r     1 FMT2                      14-0-0/c CHAR(4)     r     1 NONE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   157-0-0/w PTR         r     1 @CODE                      3-0-0/w PTR         r     1 @TOP
   151-0-0/b BIT         r     1 B(0:35)                  152-0-0/w UBIN        r     1 CHN
   135-0-0/w UBIN        r     1 CHNADR                   134-0-0/w UBIN        r     1 CHNHI
   132-0-0/w UBIN        r     1 CHNLOW                   133-0-0/w UBIN        r     1 CHNLOWPTR
    *0-0-0/w UBIN        r     1 CODE                       4-0-0/w STRC(19)    r     1 DB$FMT
     4-0-0/w BIT         r     1 DB$FMTA(0:35)            146-0-0/d VECT        r     1 FMTV
     5-0-0/w STRC(1908)  r     1 G$BOBCAT                 150-0-0/w UBIN        r     1 I
    72-0-0/w STRC(576)   r     1 KH$CHN                   112-0-0/w STRC(576)   r     1 KH$CHN_CUR
   151-0-0/w SBIN        r     1 LEV                      155-0-0/w UBIN        r     1 LNK
   150-0-0/w SBIN        r     1 NUM                      136-0-0/b STRC(6)     r     1 OPTION
   141-0-0/w UBIN        r     1 OPTION_ATTR              142-0-0/c CHAR(2)     r     1 OPTION_RES
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:53   
   140-0-0/w UBIN        r     1 OPTION_SYSID             153-0-0/w UBIN        r     1 SUBDEV
   154-0-0/w UBIN        r     1 SUBSUBDEV                147-0-0/w SBIN        r     1 SX
   146-0-0/w PTR         r     1 T$                       137-0-0/w UBIN        r     1 TEMP
    *0-0-0/w STRC(144)   r     1 TOP                      145-0-0/w SBIN        r     1 TX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/w STRC        r     1 DA_ANLZERR
     0-0-0/w SBIN        r     1 DB_U#

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT                        0-0-0/w ASTR(153)   r     1 SYM


   Procedure DBD$CHNTBL requires 674 words for executable code.
   Procedure DBD$CHNTBL requires 118 words of local(AUTO) storage.
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:54   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:55   
          MINI XREF LISTING

ACTIVESTATES
      5779**DCL      5856>>IF
ACTIVESTATES_
      5778**DCL      5779--REDEF
B IN PROCEDURE DISPOPTS
      5997**DCL      6019<<ASSIGN   6022>>IF
CHN IN PROCEDURE OPTIONS
      5882**DCL      5905<<ASSIGN   5918>>IF       5918>>IF       5925>>ASSIGN
CHNADR
      5765**DCL      5925<<ASSIGN   5926<>CALL     5961<>CALL     5963<>CALL
CHNHI
      5764**DCL      5852<>CALL     5853>>DOWHILE  5917<>CALL     5918>>IF
CHNLOW
      5762**DCL      5851<>CALL     5853>>DOWHILE  5854<>CALL     5870<<ASSIGN   5870>>ASSIGN   5915<>CALL
      5918>>IF
CHNLOWPTR
      5763**DCL      5916<>CALL     5925>>ASSIGN
CHNRPT
      5712**DCL      5887<>CALL
CHNRPTTX00
      5755**DCL      5742--DCLINIT
CODE IN PROCEDURE SETERR
      6038**DCL      6036--PROC     6041>>ASSIGN
COMMON
      5841**LABEL    5789--GOTO     5807--GOTO
DAA$ERRMSG
      5274**DCL-ENT  5868--CALL
DAA$VALUE
      5273**DCL-ENT  5900--CALL     5976--CALL     5979--CALL
DAF$INIT
      5275**DCL-ENT  5887--CALL
DAF$WRITE
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:56   
      5276**DCL      6023>>CALL     6028>>CALL     6030>>CALL
DA_ANLZERR
      1865**DCL      6040<<ASSIGN
DA_ANLZERR.CODE
      1865**DCL      6041<<ASSIGN
DB$FMT
      5410**DCL      5431--REDEF    5800>>IF       5801>>ASSIGN   5812>>IF       5814>>ASSIGN   5825>>IF
      5826<<ASSIGN   5826>>ASSIGN   5827>>ASSIGN   5888<<ASSIGN
DB$FMTA
      5431**DCL      5982<<ASSIGN
DBA$EXPRESSION
      5277**DCL-ENT  5961--CALL
DBA$SELECTION
      5278**DCL-ENT  5958--CALL
DBB$EDIT
      5279**DCL-ENT  5738--DCLINIT
DBD$CHNTREE
      5280**DCL-ENT  5845--CALL     5865--CALL
DBM$GETBOBCAT
      5281**DCL-ENT  5848--CALL     5912--CALL
DBM$GETMEM
      5282**DCL-ENT  5854--CALL     5926--CALL     5937--CALL     5949--CALL     5963--CALL
DBM$PACK2
      5283**DCL-ENT  5859--CALL     5863--CALL     5915--CALL     5917--CALL     5930--CALL     5940--CALL
      5952--CALL
DBM$PACK4
      5284**DCL-ENT  5851--CALL     5852--CALL     5916--CALL     5931--CALL     5941--CALL     5943--CALL
      5953--CALL
DB_FMT
      5302**DCL      5786<<ASSIGN   5801<<ASSIGN   5804<<ASSIGN   5819<<ASSIGN   5833<<ASSIGN   5839<<ASSIGN
DB_FMT.CHT
      5305**DCL      5787<<ASSIGN
DB_FMT.FULL
      5303**DCL      5788<<ASSIGN   5806<<ASSIGN   5840<<ASSIGN
DB_FMT.TREE
      5304**DCL      5841<<ASSIGN
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:57   
DB_FMT_DEFAULT
      5374**DCL      5804>>ASSIGN   5814<<ASSIGN   5814>>ASSIGN   5817<<ASSIGN   5819>>ASSIGN   5827<<ASSIGN
      5827>>ASSIGN   5830<<ASSIGN   5833>>ASSIGN   6019>>ASSIGN
DB_FMT_DEFAULT.TREE
      5376**DCL      5813<<ASSIGN   5831<<ASSIGN
DB_FMT_INIT
      5338**DCL      5817>>ASSIGN
DB_U#
      5286**DCL      5859<>CALL     5860>>ASSIGN   5930<>CALL     5937<>CALL     5949<>CALL     5958<>CALL
      5960<<ASSIGN   5961<>CALL     5963<>CALL
DISPOPTS
      5990**PROC     5794--CALL
FLAGNAMES IN PROCEDURE DISPOPTS
      5999**DCL      6021--DOINDEX  6023--CALL
FMT0 IN PROCEDURE DISPOPTS
      5992**DCL      6020--ASSIGN   6027--IF
FMT1 IN PROCEDURE DISPOPTS
      5993**DCL      6024--ASSIGN
FMT2 IN PROCEDURE DISPOPTS
      5994**DCL      6030--CALL
FMTV IN PROCEDURE DISPOPTS
      5995**DCL      6020<<ASSIGN   6023<>CALL     6024<<ASSIGN   6027>>IF       6028<>CALL
G$BOBCAT
      5434**DCL      5848<>CALL     5912<>CALL
G$BOBCAT.CHNHI
      5440**DCL      5917<>CALL
G$BOBCAT.CHNHI$
      5441**DCL      5852<>CALL
G$BOBCAT.CHNLOW
      5440**DCL      5915<>CALL
G$BOBCAT.CHNLOW$
      5441**DCL      5851<>CALL     5916<>CALL
I IN PROCEDURE DISPOPTS
      5996**DCL      6021<<DOINDEX  6022>>IF       6023>>CALL
KH$CHN
      5461**DCL      5845<>CALL     5854<>CALL     5854--CALL     5854--CALL     5865<>CALL     5865<>CALL
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:58   
      5870--ASSIGN   5925--ASSIGN   5926<>CALL     5926--CALL     5926--CALL     5929>>ASSIGN   5937--CALL
      5937--CALL     5949--CALL     5949--CALL     5963<>CALL     5963--CALL     5963--CALL     5965>>ASSIGN
KH$CHN.ATTR
      5491**DCL      5863<>CALL
KH$CHN.RESOURCE
      5489**DCL      5857>>IF
KH$CHN.STT.BYT
      5475**DCL      5856>>IF
KH$CHN.SYSID
      5491**DCL      5859<>CALL
KH$CHN.TERMID.LEV
      5557**DCL      5855>>IF
KH$CHN.TERMID.TERM
      5557**DCL      5566--REDEF
KH$CHN_CUR
      5585**DCL      5845<>CALL     5929<<ASSIGN   5937<>CALL     5949<>CALL     5965<<ASSIGN
KH$CHN_CUR.LNK$
      5692**DCL      5941<>CALL     5953<>CALL
KH$CHN_CUR.SUB$
      5692**DCL      5931<>CALL     5943<>CALL
KH$CHN_CUR.SYSID
      5615**DCL      5930<>CALL
KH$CHN_CUR.TERMID.TERM
      5681**DCL      5690--REDEF
KH$CHN_CUR.TERMID.TERM.SUBDEVICE
      5683**DCL      5940<>CALL
KH$CHN_CUR.TERMID.TERM.SUBSUBDEVICE
      5684**DCL      5952<>CALL
LEV IN PROCEDURE OPTIONS
      5881**DCL      5891<<ASSIGN   5899<<ASSIGN   5899>>ASSIGN   5932>>IF       5944>>IF
LNK IN PROCEDURE OPTIONS
      5885**DCL      5931<>CALL     5933>>IF       5937<>CALL     5941<>CALL     5943<>CALL     5945>>IF
      5949<>CALL     5953<>CALL
NONE IN PROCEDURE DISPOPTS
      5998**DCL      6028--CALL
NUM IN PROCEDURE OPTIONS
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:59   
      5880**DCL      5900<>CALL     5905>>ASSIGN   5907>>ASSIGN   5909>>ASSIGN   5932>>DOUNTIL  5940<>CALL
      5944>>DOUNTIL  5952<>CALL
OPTION
      5766**DCL      5889<<ASSIGN
OPTION.ALL
      5768**DCL      5856>>IF       5969<<ASSIGN
OPTION.ATTR
      5771**DCL      5863>>IF       5978<<ASSIGN
OPTION.CHNADR
      5767**DCL      5844>>IF       5897<<ASSIGN   5956<<ASSIGN
OPTION.FULL
      5769**DCL      5788>>ASSIGN   5806>>ASSIGN   5967<<ASSIGN
OPTION.RES
      5772**DCL      5857>>IF       5972<<ASSIGN
OPTION.SYSID
      5770**DCL      5860>>IF       5975<<ASSIGN
OPTIONS
      5875**PROC     5783--CALL     5797--CALL     5811--CALL     5824--CALL     5838--CALL
OPTION_ATTR
      5775**DCL      5864>>IF       5890<<ASSIGN   5979<>CALL
OPTION_RES
      5776**DCL      5857>>IF       5973<<ASSIGN
OPTION_SYSID
      5774**DCL      5858>>ASSIGN   5861>>IF       5976<>CALL
OUT
      5195**DCL      5900<>CALL     5958<>CALL     5961<>CALL     5976<>CALL     5979<>CALL
OUT.CODE
      5203**DCL      5895>>DOCASE   5982>>ASSIGN
OUT.NSUBLKS
      5207**DCL      5898>>DOINDEX  5957>>IF       5981>>DOINDEX
OUT.SUBLK$
      5228**DCL      5900>>CALL     5958>>CALL     5961>>CALL     5973>>ASSIGN   5973>>ASSIGN   5976>>CALL
      5979>>CALL     5982>>ASSIGN
SETERR
      6036**PROC     5919--CALL     5934--CALL     5946--CALL
SUBDEV IN PROCEDURE OPTIONS
PL6.E3A0      #001=DBD$CHNTBL File=DBD$CHNTBL.:E05TSI                            TUE 07/29/97 13:00 Page:60   
      5883**DCL      5907<<ASSIGN   5932>>DOUNTIL
SUBSUBDEV IN PROCEDURE OPTIONS
      5884**DCL      5909<<ASSIGN   5944>>DOUNTIL
SX IN PROCEDURE OPTIONS
      5879**DCL      5898<<DOINDEX  5900>>CALL     5903>>DOCASE   5981<<DOINDEX  5982>>ASSIGN
SYM.COUNT
      5264**DCL      5267--IMP-SIZ  5973>>ASSIGN
SYM.TEXT
      5267**DCL      5973>>ASSIGN
T$ IN PROCEDURE OPTIONS
      5878**DCL      5894<<ASSIGN   5895>>DOCASE   5898>>DOINDEX  5900>>CALL     5957>>IF       5958>>CALL
      5961>>CALL     5973>>ASSIGN   5973>>ASSIGN   5976>>CALL     5979>>CALL     5981>>DOINDEX  5982>>ASSIGN
TEMP
      5773**DCL      5858<<ASSIGN   5860<<ASSIGN   5861>>IF       5862<<ASSIGN   5863<>CALL     5864>>IF
TOP
      5150**DCL         8--PROC     5791--ENTRY    5809--ENTRY    5822--ENTRY    5836--ENTRY
TOP.NSUBLKS
      5162**DCL      5793>>IF       5893>>DOINDEX
TOP.SUBLK$
      5183**DCL      5894>>ASSIGN
TX IN PROCEDURE OPTIONS
      5877**DCL      5893<<DOINDEX  5894>>ASSIGN

PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:61   
      337        1        /*T***********************************************************/
      338        2        /*T*                                                         */
      339        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      340        4        /*T*                                                         */
      341        5        /*T***********************************************************/
      342        6
      343        7        DBD$CHNTREE: PROC(KH$CHN_TOP,KH$CHN_CUR);
      344        8
      345        9        %INCLUDE DB_ANLZ_M;
      346      176        %INCLUDE KI_CP6;
      347     1272        %INCLUDE KH$CHN;
      348     1394        %INCLUDE KL_SUPER_C;
      349     4296        %INCLUDE B$TABLES_C;
      350     4404
      351     4405    1   DCL DAF$WRITE EPTR SYMREF;
      352     4406    1   DCL DBB$DUMPLCT ENTRY(2);
      353     4407    1   DCL DBD$DISPCHN ENTRY(1);
      354     4408    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
      355     4409    1   DCL DBM$PACK1 ENTRY(2);
      356     4410    1   DCL DBM$PACK2 ENTRY(2);
      357     4411    1   DCL DBM$PACK4 ENTRY(2);
      358     4412
      359     4413    1   DCL DBD$ASYNC ENTRY(2);
      360     4414    1   DCL DBD$SDEV ENTRY(2) ALTRET;
      361     4415    1   DCL DBD$CLM ENTRY(2);
      362     4416    1   DCL DBD$X25LINK ENTRY(2);
      363     4417    1   DCL DBD$URP ENTRY(2);
      364     4418    1   DCL DBD$VIRCIR ENTRY(2);
      365     4419    1   DCL DBD$3270 ENTRY(2);
      366     4420    1   DCL DBD$3270CONT ENTRY(2);
      367     4421    1   DCL DBD$3270DEV ENTRY(2);
      368     4422    1   DCL DBD$X29 ENTRY(2);
      369     4423
      370     4424        %KH$CHN (NAME=KH$CHN_TOP,STCLASS=PARAM);
      371     4548        %KH$CHN (NAME=KH$CHN_CUR,STCLASS=PARAM);
      372     4672        %EQU MY_CHN=CHARTEXT('ADDR(DATBUF)->BASED_CHN');
      373     4673        %KH$CHN (NAME=BASED_CHN, STCLASS=BASED);
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:62   
      374     4797
      375     4798    1   DCL 1 TEXTC BASED CALIGNED,
      376     4799    1      2 L UBIN BYTE CALIGNED,
      377     4800    1      2 T CHAR(LNK);
      378     4801    1   DCL BASED_UBIN BASED UBIN CALIGNED;
      379     4802
      380     4803        %DB_FMT (NAME=DB_FMT,STCLASS="SYMREF");
      381     4839        %DB_FMT (NAME=DB$FMT,STCLASS=AUTO);
      382     4875
      383     4876        %B$XL_ASC_DUMP (NAME=DA_PRINTABLE_TBL);
      384     4880
      385     4881    1   DCL DATBUF(0:511) UBIN;
      386     4882    1   DCL FMTBUF CHAR(2048);
      387     4883    1   DCL 1 VEC1,
      388     4884    1      2 ADR UBIN,
      389     4885    1      2 CHN,
      390     4886    1        3 CHN UBIN(10) UNAL,
      391     4887    1        3 SUB UBIN(13) UNAL,
      392     4888    1        3 SUBSUB UBIN(13) UNAL,
      393     4889    1      2 DB_FMT BIT(36);
      394     4890    1   DCL 1 NXTBUF,
      395     4891    1      2 OFFSET SBIN,
      396     4892    1      2 BUF CHAR(508);
      397     4893    1   DCL DB_NXT$ PTR SYMREF;
      398     4894    1   DCL DB_U# SBIN SYMREF;
      399     4895    1   DCL DB_D# SBIN SYMREF;
      400     4896    1   DCL LNK SBIN;
      401     4897        %EJECT;
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:63   
      402     4898    1           ADDR(DATBUF)->BASED_CHN=KH$CHN_CUR;
      403     4899    1           DB_D#=0;
      404     4900    1           DB_NXT$=ADDR(NXTBUF);
      405     4901    1           NXTBUF.OFFSET=SIZEC(NXTBUF);
      406     4902    1           DB$FMT=DB_FMT;
      407     4903    1           DB$FMT.LCT='0'B;
      408     4904    1           DB$FMT.TREE='0'B;
      409     4905    1           DB$FMT.CHT='0'B;
      410     4906    1           VEC1.DB_FMT=DB_FMT;
      411     4907
      412     4908    1   NEXT_CHN:;
      413     4909    1           IF DB_FMT.TREE THEN FMTBUF='%4E%(KH$CHT%)';
      414     4910    1           ELSE FMTBUF='%4E%(KH$CHN%)';
      415     4911    1           VEC1.CHN='0'B;
      416     4912    1           VEC1.CHN.CHN=2*%MY_CHN.TERMID.TERM.CHANNEL.BYT(0)+
      417     4913    1             %MY_CHN.TERMID.TERM.CHANNEL.BYT(1)/128+512;
      418     4914    2           IF %MY_CHN.TERMID.LEV>1 THEN DO;
      419     4915    2              VEC1.CHN.SUB=%MY_CHN.TERMID.TERM.SUBDEVICE.BYT(0)*256+
      420     4916    2                %MY_CHN.TERMID.TERM.SUBDEVICE.BYT(1)+4096;
      421     4917    2              IF %MY_CHN.TERMID.LEV>2
      422     4918    2              THEN VEC1.CHN.SUBSUB=%MY_CHN.TERMID.TERM.SUBSUBDEVICE.BYT(0)*256+
      423     4919    2                %MY_CHN.TERMID.TERM.SUBSUBDEVICE.BYT(1)+4096;
      424     4920    2              END;
      425     4921    1           CALL DAF$WRITE(VECTOR(FMTBUF),VECTOR(VEC1),VECTOR(DATBUF));
      426     4922
      427     4923    1           IF DB_FMT.LCT AND %MY_CHN.TERMID.LEV=1 AND
      428     4924    1              (%MY_CHN.DVCID.BYT(0) = '21'X OR
      429     4925    2               %MY_CHN.DVCID.BYT(0) = '29'X) THEN DO;
      430     4926    2              LNK=VEC1.CHN.CHN*128-512*128;
      431     4927    2              CALL DBB$DUMPLCT(LNK,DA_PRINTABLE_TBL);
      432     4928    2              END;
      433     4929
      434     4930    1           FMTBUF='%4E%(DBD$FMT%)';
      435     4931    2           IF DB$FMT THEN DO WHILE '1'B;
      436     4932    2   FMT_VDH:   CALL DAF$WRITE(VECTOR(FMTBUF),VECTOR(VEC1),VECTOR(DATBUF),
      437     4933    2                VECTOR(KH$CHN_TOP));
      438     4934
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:64   
      439     4935    2              IF NXTBUF.OFFSET=SIZEC(NXTBUF) THEN RETURN;
      440     4936    2              FMTBUF='%4.xxxxxxxxE%(';
      441     4937    2              LNK=PINCRC(ADDR(NXTBUF),NXTBUF.OFFSET)->TEXTC.L;
      442     4938    2              SUBSTR(FMTBUF,14)=PINCRC(ADDR(NXTBUF),NXTBUF.OFFSET)->TEXTC.T;
      443     4939    2              SUBSTR(FMTBUF,14+LNK)='%)';
      444     4940    2              NXTBUF.OFFSET=NXTBUF.OFFSET+LNK+5;
      445     4941    2              LNK=PINCRC(ADDR(NXTBUF),NXTBUF.OFFSET-4)->BASED_UBIN;
      446     4942    2              CALL BINCHAR(SUBSTR(FMTBUF,3,8), LNK);
      447     4943    3              IF SUBSTR(FMTBUF,14)='KH$CHN%)' THEN DO;
      448     4944    3                 CALL DBM$GETMEM(LNK,%MY_CHN,DB_U#,SIZEC(%MY_CHN),,SIZEC(%MY_CHN))
      449     4945    4                 WHENRETURN DO; GOTO NEXT_CHN; END;
      450     4946    3                 END;
      451     4947    2              END;
      452     4948
      453     4949    1           RETURN;
      454     4950
      455     4951    1   DBD$VDH: ENTRY (KH$CHN_TOP);
      456     4952    1           CALL DBM$GETMEM (KH$CHN_TOP,DATBUF,DB_U#,64,,64)
      457     4953    2           WHENALTRETURN DO; RETURN; END;
      458     4954    1           VEC1.ADR=ADDR(KH$CHN_TOP)->BASED_UBIN;
      459     4955    1           VEC1.CHN='0'B;
      460     4956    1           VEC1.DB_FMT=DB_FMT;
      461     4957    1           DB_NXT$=ADDR(NXTBUF);
      462     4958    1           NXTBUF.OFFSET=SIZEC(NXTBUF);
      463     4959    1           FMTBUF='%4E%(KV$VDI%)';
      464     4960    1           GOTO FMT_VDH;
      465     4961    1   END DBD$CHNTREE;

PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:65   
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   DB_ANLZ_M.:E05TOU  is referenced.
      No diagnostics issued in procedure DBD$CHNTREE.

   Procedure DBD$CHNTREE requires 266 words for executable code.
   Procedure DBD$CHNTREE requires 1188 words of local(AUTO) storage.

    No errors detected in file DBD$CHNTBL.:E05TSI    .

PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:66   

 Object Unit name= DBD$CHNTREE                                File name= DBD$CHNTBL.:E05TOU
 UTS= JUL 29 '97 13:01:00.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     22     26  DBD$CHNTREE
    1   Proc  even  none   266    412  DBD$CHNTREE
    2  RoData even  none    12     14  DBD$CHNTREE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  DBD$CHNTREE
     1    352                  yes      Std        1  DBD$VDH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std      10 DBM$GETMEM
         yes           Std       2 DBB$DUMPLCT
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:67   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DAF$WRITE                             DB_FMT                           r    B$XL_ASC_DUMP$
     DB_NXT$                               DB_U#                                 DB_D#
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:68   


      337        1        /*T***********************************************************/
      338        2        /*T*                                                         */
      339        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      340        4        /*T*                                                         */
      341        5        /*T***********************************************************/
      342        6
      343        7        DBD$CHNTREE: PROC(KH$CHN_TOP,KH$CHN_CUR);

      7  1 000000   000000 700200 xent  DBD$CHNTREE  TSX0  ! X66_AUTO_2
         1 000001   002244 000002                    ZERO    1188,2

      344        8
      345        9        %INCLUDE DB_ANLZ_M;
      346      176        %INCLUDE KI_CP6;
      347     1272        %INCLUDE KH$CHN;
      348     1394        %INCLUDE KL_SUPER_C;
      349     4296        %INCLUDE B$TABLES_C;
      350     4404
      351     4405    1   DCL DAF$WRITE EPTR SYMREF;
      352     4406    1   DCL DBB$DUMPLCT ENTRY(2);
      353     4407    1   DCL DBD$DISPCHN ENTRY(1);
      354     4408    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
      355     4409    1   DCL DBM$PACK1 ENTRY(2);
      356     4410    1   DCL DBM$PACK2 ENTRY(2);
      357     4411    1   DCL DBM$PACK4 ENTRY(2);
      358     4412
      359     4413    1   DCL DBD$ASYNC ENTRY(2);
      360     4414    1   DCL DBD$SDEV ENTRY(2) ALTRET;
      361     4415    1   DCL DBD$CLM ENTRY(2);
      362     4416    1   DCL DBD$X25LINK ENTRY(2);
      363     4417    1   DCL DBD$URP ENTRY(2);
      364     4418    1   DCL DBD$VIRCIR ENTRY(2);
      365     4419    1   DCL DBD$3270 ENTRY(2);
      366     4420    1   DCL DBD$3270CONT ENTRY(2);
      367     4421    1   DCL DBD$3270DEV ENTRY(2);
      368     4422    1   DCL DBD$X29 ENTRY(2);
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:69   
      369     4423
      370     4424        %KH$CHN (NAME=KH$CHN_TOP,STCLASS=PARAM);
      371     4548        %KH$CHN (NAME=KH$CHN_CUR,STCLASS=PARAM);
      372     4672        %EQU MY_CHN=CHARTEXT('ADDR(DATBUF)->BASED_CHN');
      373     4673        %KH$CHN (NAME=BASED_CHN, STCLASS=BASED);
      374     4797
      375     4798    1   DCL 1 TEXTC BASED CALIGNED,
      376     4799    1      2 L UBIN BYTE CALIGNED,
      377     4800    1      2 T CHAR(LNK);
      378     4801    1   DCL BASED_UBIN BASED UBIN CALIGNED;
      379     4802
      380     4803        %DB_FMT (NAME=DB_FMT,STCLASS="SYMREF");
      381     4839        %DB_FMT (NAME=DB$FMT,STCLASS=AUTO);
      382     4875
      383     4876        %B$XL_ASC_DUMP (NAME=DA_PRINTABLE_TBL);
      384     4880
      385     4881    1   DCL DATBUF(0:511) UBIN;
      386     4882    1   DCL FMTBUF CHAR(2048);
      387     4883    1   DCL 1 VEC1,
      388     4884    1      2 ADR UBIN,
      389     4885    1      2 CHN,
      390     4886    1        3 CHN UBIN(10) UNAL,
      391     4887    1        3 SUB UBIN(13) UNAL,
      392     4888    1        3 SUBSUB UBIN(13) UNAL,
      393     4889    1      2 DB_FMT BIT(36);
      394     4890    1   DCL 1 NXTBUF,
      395     4891    1      2 OFFSET SBIN,
      396     4892    1      2 BUF CHAR(508);
      397     4893    1   DCL DB_NXT$ PTR SYMREF;
      398     4894    1   DCL DB_U# SBIN SYMREF;
      399     4895    1   DCL DB_D# SBIN SYMREF;
      400     4896    1   DCL LNK SBIN;
      401     4897        %EJECT;
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:70   
      402     4898    1           ADDR(DATBUF)->BASED_CHN=KH$CHN_CUR;

   4898  1 000002   200004 470500                    LDP0    @KH$CHN_CUR,,AUTO
         1 000003   000100 100500                    MLR     fill='000'O
         1 000004   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64
         1 000005   200006 000100                    ADSC9   DATBUF,,AUTO             cn=0,n=64

      403     4899    1           DB_D#=0;

   4899  1 000006   000000 450000 xsym               STZ     DB_D#

      404     4900    1           DB_NXT$=ADDR(NXTBUF);

   4900  1 000007   202011 631500                    EPPR1   NXTBUF,,AUTO
         1 000010   000000 451400 xsym               STP1    DB_NXT$

      405     4901    1           NXTBUF.OFFSET=SIZEC(NXTBUF);

   4901  1 000011   001000 235007                    LDA     512,DL
         1 000012   202011 755100                    STA     NXTBUF,,AUTO

      406     4902    1           DB$FMT=DB_FMT;

   4902  1 000013   000000 236000 xsym               LDQ     DB_FMT
         1 000014   000000 376000 2                  ANQ     0
         1 000015   200005 756100                    STQ     DB$FMT,,AUTO

      407     4903    1           DB$FMT.LCT='0'B;

   4903  1 000016   000001 236000 2                  LDQ     1
         1 000017   200005 356100                    ANSQ    DB$FMT,,AUTO

      408     4904    1           DB$FMT.TREE='0'B;

   4904  1 000020   000002 236000 2                  LDQ     2
         1 000021   200005 356100                    ANSQ    DB$FMT,,AUTO

PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:71   
      409     4905    1           DB$FMT.CHT='0'B;

   4905  1 000022   000003 236000 2                  LDQ     3
         1 000023   200005 356100                    ANSQ    DB$FMT,,AUTO

      410     4906    1           VEC1.DB_FMT=DB_FMT;

   4906  1 000024   000000 236000 xsym               LDQ     DB_FMT
         1 000025   000000 376000 2                  ANQ     0
         1 000026   202010 756100                    STQ     VEC1+2,,AUTO

   4906  1 000027                       NEXT_CHN     null
      411     4907
      412     4908    1   NEXT_CHN:;
      413     4909    1           IF DB_FMT.TREE THEN FMTBUF='%4E%(KH$CHT%)';

   4909  1 000027   000000 236000 xsym               LDQ     DB_FMT
         1 000030   200000 316003                    CANQ    65536,DU
         1 000031   000036 600000 1                  TZE     s:4910

   4909  1 000032   040100 100400                    MLR     fill='040'O
         1 000033   000000 000015 0                  ADSC9   0                        cn=0,n=13
         1 000034   201006 004000                    ADSC9   FMTBUF,,AUTO             cn=0,n=2048
         1 000035   000041 710000 1                  TRA     s:4911

      414     4910    1           ELSE FMTBUF='%4E%(KH$CHN%)';

   4910  1 000036   040100 100400                    MLR     fill='040'O
         1 000037   000004 000015 0                  ADSC9   4                        cn=0,n=13
         1 000040   201006 004000                    ADSC9   FMTBUF,,AUTO             cn=0,n=2048

      415     4911    1           VEC1.CHN='0'B;

   4911  1 000041   202007 450100                    STZ     VEC1+1,,AUTO

      416     4912    1           VEC1.CHN.CHN=2*%MY_CHN.TERMID.TERM.CHANNEL.BYT(0)+

PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:72   
   4912  1 000042   200017 236100                    LDQ     DATBUF+9,,AUTO
         1 000043   000377 376007                    ANQ     255,DL
         1 000044   000007 772000                    QRL     7
         1 000045   202212 756100                    STQ     LNK+1,,AUTO
         1 000046   200017 236100                    LDQ     DATBUF+9,,AUTO
         1 000047   000010 772000                    QRL     8
         1 000050   000776 376007                    ANQ     510,DL
         1 000051   202212 036100                    ADLQ    LNK+1,,AUTO
         1 000052   001000 036007                    ADLQ    512,DL
         1 000053   000032 736000                    QLS     26
         1 000054   202007 676100                    ERQ     VEC1+1,,AUTO
         1 000055   777400 376003                    ANQ     -256,DU
         1 000056   202007 656100                    ERSQ    VEC1+1,,AUTO

      417     4913    1             %MY_CHN.TERMID.TERM.CHANNEL.BYT(1)/128+512;
      418     4914    2           IF %MY_CHN.TERMID.LEV>1 THEN DO;

   4914  1 000057   200017 236100                    LDQ     DATBUF+9,,AUTO
         1 000060   000777 376003                    ANQ     511,DU
         1 000061   000002 116003                    CMPQ    2,DU
         1 000062   000117 602000 1                  TNC     s:4921

      419     4915    2              VEC1.CHN.SUB=%MY_CHN.TERMID.TERM.SUBDEVICE.BYT(0)*256+

   4915  1 000063   200020 236100                    LDQ     DATBUF+10,,AUTO
         1 000064   000022 772000                    QRL     18
         1 000065   000377 376007                    ANQ     255,DL
         1 000066   202212 756100                    STQ     LNK+1,,AUTO
         1 000067   200020 236100                    LDQ     DATBUF+10,,AUTO
         1 000070   000023 772000                    QRL     19
         1 000071   177400 376007                    ANQ     65280,DL
         1 000072   202212 036100                    ADLQ    LNK+1,,AUTO
         1 000073   010000 036007                    ADLQ    4096,DL
         1 000074   000015 736000                    QLS     13
         1 000075   202007 676100                    ERQ     VEC1+1,,AUTO
         1 000076   000004 376000 2                  ANQ     4
         1 000077   202007 656100                    ERSQ    VEC1+1,,AUTO
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:73   

      420     4916    2                %MY_CHN.TERMID.TERM.SUBDEVICE.BYT(1)+4096;
      421     4917    2              IF %MY_CHN.TERMID.LEV>2

   4917  1 000100   200017 236100                    LDQ     DATBUF+9,,AUTO
         1 000101   000777 376003                    ANQ     511,DU
         1 000102   000003 116003                    CMPQ    3,DU
         1 000103   000117 602000 1                  TNC     s:4921

      422     4918    2              THEN VEC1.CHN.SUBSUB=%MY_CHN.TERMID.TERM.SUBSUBDEVICE.BYT(0)*256+

   4918  1 000104   200020 236100                    LDQ     DATBUF+10,,AUTO
         1 000105   000377 376007                    ANQ     255,DL
         1 000106   202212 756100                    STQ     LNK+1,,AUTO
         1 000107   200020 236100                    LDQ     DATBUF+10,,AUTO
         1 000110   000001 772000                    QRL     1
         1 000111   177400 376007                    ANQ     65280,DL
         1 000112   202212 036100                    ADLQ    LNK+1,,AUTO
         1 000113   010000 036007                    ADLQ    4096,DL
         1 000114   202007 676100                    ERQ     VEC1+1,,AUTO
         1 000115   017777 376007                    ANQ     8191,DL
         1 000116   202007 656100                    ERSQ    VEC1+1,,AUTO

      423     4919    2                %MY_CHN.TERMID.TERM.SUBSUBDEVICE.BYT(1)+4096;
      424     4920    2              END;

      425     4921    1           CALL DAF$WRITE(VECTOR(FMTBUF),VECTOR(VEC1),VECTOR(DATBUF));

   4921  1 000117   000005 235000 2                  LDA     5
         1 000120   202212 452500                    STP2    LNK+1,,AUTO
         1 000121   202212 236100                    LDQ     LNK+1,,AUTO
         1 000122   001006 036003                    ADLQ    518,DU
         1 000123   202214 757100                    STAQ    LNK+3,,AUTO
         1 000124   000006 235000 2                  LDA     6
         1 000125   202216 452500                    STP2    LNK+5,,AUTO
         1 000126   202216 236100                    LDQ     LNK+5,,AUTO
         1 000127   002006 036003                    ADLQ    1030,DU
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:74   
         1 000130   202220 757100                    STAQ    LNK+7,,AUTO
         1 000131   000005 235000 2                  LDA     5
         1 000132   202222 452500                    STP2    LNK+9,,AUTO
         1 000133   202222 236100                    LDQ     LNK+9,,AUTO
         1 000134   000006 036003                    ADLQ    6,DU
         1 000135   202226 757100                    STAQ    LNK+13,,AUTO
         1 000136   202214 237100                    LDAQ    LNK+3,,AUTO
         1 000137   202224 757100                    STAQ    LNK+11,,AUTO
         1 000140   202220 237100                    LDAQ    LNK+7,,AUTO
         1 000141   202230 757100                    STAQ    LNK+15,,AUTO
         1 000142   202226 237100                    LDAQ    LNK+13,,AUTO
         1 000143   202232 757100                    STAQ    LNK+17,,AUTO
         1 000144   202232 630500                    EPPR0   LNK+17,,AUTO
         1 000145   202236 450500                    STP0    LNK+21,,AUTO
         1 000146   202230 631500                    EPPR1   LNK+15,,AUTO
         1 000147   202235 451500                    STP1    LNK+20,,AUTO
         1 000150   202224 633500                    EPPR3   LNK+11,,AUTO
         1 000151   202234 453500                    STP3    LNK+19,,AUTO
         1 000152   202234 630500                    EPPR0   LNK+19,,AUTO
         1 000153   000000 220000 xsym               LDX0    DAF$WRITE
         1 000154   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000155   000000 701010                    TSX1    0,X0
         1 000156   000000 011000                    NOP     0

      426     4922
      427     4923    1           IF DB_FMT.LCT AND %MY_CHN.TERMID.LEV=1 AND

   4923  1 000157   000000 236000 xsym               LDQ     DB_FMT
         1 000160   000200 316003                    CANQ    128,DU
         1 000161   000213 600000 1                  TZE     s:4930
         1 000162   200017 236100                    LDQ     DATBUF+9,,AUTO
         1 000163   000777 376003                    ANQ     511,DU
         1 000164   000001 116003                    CMPQ    1,DU
         1 000165   000213 601000 1                  TNZ     s:4930
         1 000166   200007 236100                    LDQ     DATBUF+1,,AUTO
         1 000167   377000 376003                    ANQ     130560,DU
         1 000170   041000 116003                    CMPQ    16896,DU
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:75   
         1 000171   000176 600000 1                  TZE     s:4926
         1 000172   200007 236100                    LDQ     DATBUF+1,,AUTO
         1 000173   377000 376003                    ANQ     130560,DU
         1 000174   051000 116003                    CMPQ    20992,DU
         1 000175   000213 601000 1                  TNZ     s:4930

      428     4924    1              (%MY_CHN.DVCID.BYT(0) = '21'X OR
      429     4925    2               %MY_CHN.DVCID.BYT(0) = '29'X) THEN DO;

      430     4926    2              LNK=VEC1.CHN.CHN*128-512*128;

   4926  1 000176   202007 236100                    LDQ     VEC1+1,,AUTO
         1 000177   000023 772000                    QRL     19
         1 000200   377600 376007                    ANQ     130944,DL
         1 000201   200000 136007                    SBLQ    65536,DL
         1 000202   202211 756100                    STQ     LNK,,AUTO

      431     4927    2              CALL DBB$DUMPLCT(LNK,DA_PRINTABLE_TBL);

   4927  1 000203   000000 236000 xsym               LDQ     B$XL_ASC_DUMP$
         1 000204   202213 756100                    STQ     LNK+2,,AUTO
         1 000205   202211 630500                    EPPR0   LNK,,AUTO
         1 000206   202212 450500                    STP0    LNK+1,,AUTO
         1 000207   202212 630500                    EPPR0   LNK+1,,AUTO
         1 000210   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000211   000000 701000 xent               TSX1    DBB$DUMPLCT
         1 000212   000000 011000                    NOP     0

      432     4928    2              END;

      433     4929
      434     4930    1           FMTBUF='%4E%(DBD$FMT%)';

   4930  1 000213   040100 100400                    MLR     fill='040'O
         1 000214   000010 000016 0                  ADSC9   8                        cn=0,n=14
         1 000215   201006 004000                    ADSC9   FMTBUF,,AUTO             cn=0,n=2048

PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:76   
      435     4931    2           IF DB$FMT THEN DO WHILE '1'B;

   4931  1 000216   200005 236100                    LDQ     DB$FMT,,AUTO
         1 000217   000000 316000 2                  CANQ    0
         1 000220   000351 600000 1                  TZE     s:4949

      436     4932    2   FMT_VDH:   CALL DAF$WRITE(VECTOR(FMTBUF),VECTOR(VEC1),VECTOR(DATBUF),

   4932  1 000221   000005 235000 2     FMT_VDH      LDA     5
         1 000222   202212 452500                    STP2    LNK+1,,AUTO
         1 000223   202212 236100                    LDQ     LNK+1,,AUTO
         1 000224   001006 036003                    ADLQ    518,DU
         1 000225   202214 757100                    STAQ    LNK+3,,AUTO
         1 000226   000006 235000 2                  LDA     6
         1 000227   202216 452500                    STP2    LNK+5,,AUTO
         1 000230   202216 236100                    LDQ     LNK+5,,AUTO
         1 000231   002006 036003                    ADLQ    1030,DU
         1 000232   202220 757100                    STAQ    LNK+7,,AUTO
         1 000233   000005 235000 2                  LDA     5
         1 000234   202222 452500                    STP2    LNK+9,,AUTO
         1 000235   202222 236100                    LDQ     LNK+9,,AUTO
         1 000236   000006 036003                    ADLQ    6,DU
         1 000237   202224 757100                    STAQ    LNK+11,,AUTO
         1 000240   000007 235000 2                  LDA     7
         1 000241   200003 236100                    LDQ     @KH$CHN_TOP,,AUTO
         1 000242   202230 757100                    STAQ    LNK+15,,AUTO
         1 000243   202214 237100                    LDAQ    LNK+3,,AUTO
         1 000244   202226 757100                    STAQ    LNK+13,,AUTO
         1 000245   202220 237100                    LDAQ    LNK+7,,AUTO
         1 000246   202232 757100                    STAQ    LNK+17,,AUTO
         1 000247   202224 237100                    LDAQ    LNK+11,,AUTO
         1 000250   202234 757100                    STAQ    LNK+19,,AUTO
         1 000251   202230 237100                    LDAQ    LNK+15,,AUTO
         1 000252   202236 757100                    STAQ    LNK+21,,AUTO
         1 000253   202236 630500                    EPPR0   LNK+21,,AUTO
         1 000254   202243 450500                    STP0    LNK+26,,AUTO
         1 000255   202234 631500                    EPPR1   LNK+19,,AUTO
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:77   
         1 000256   202242 451500                    STP1    LNK+25,,AUTO
         1 000257   202232 633500                    EPPR3   LNK+17,,AUTO
         1 000260   202241 453500                    STP3    LNK+24,,AUTO
         1 000261   202226 634500                    EPPR4   LNK+13,,AUTO
         1 000262   202240 454500                    STP4    LNK+23,,AUTO
         1 000263   202240 630500                    EPPR0   LNK+23,,AUTO
         1 000264   000000 220000 xsym               LDX0    DAF$WRITE
         1 000265   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000266   000000 701010                    TSX1    0,X0
         1 000267   000000 011000                    NOP     0

      437     4933    2                VECTOR(KH$CHN_TOP));
      438     4934
      439     4935    2              IF NXTBUF.OFFSET=SIZEC(NXTBUF) THEN RETURN;

   4935  1 000270   202011 235100                    LDA     NXTBUF,,AUTO
         1 000271   001000 115007                    CMPA    512,DL
         1 000272   000274 601000 1                  TNZ     s:4936

   4935  1 000273   000000 702200 xent               TSX2  ! X66_ARET

      440     4936    2              FMTBUF='%4.xxxxxxxxE%(';

   4936  1 000274   040100 100400                    MLR     fill='040'O
         1 000275   000014 000016 0                  ADSC9   12                       cn=0,n=14
         1 000276   201006 004000                    ADSC9   FMTBUF,,AUTO             cn=0,n=2048

      441     4937    2              LNK=PINCRC(ADDR(NXTBUF),NXTBUF.OFFSET)->TEXTC.L;

   4937  1 000277   000100 101505                    MRL     fill='000'O
         1 000300   202011 000001                    ADSC9   NXTBUF,A,AUTO            cn=0,n=1
         1 000301   202211 000004                    ADSC9   LNK,,AUTO                cn=0,n=4

      442     4938    2              SUBSTR(FMTBUF,14)=PINCRC(ADDR(NXTBUF),NXTBUF.OFFSET)->TEXTC.T;

   4938  1 000302   202211 720100                    LXL0    LNK,,AUTO
         1 000303   040100 100545                    MLR     fill='040'O
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:78   
         1 000304   202011 200010                    ADSC9   NXTBUF,A,AUTO            cn=1,n=*X0
         1 000305   201011 403762                    ADSC9   FMTBUF+3,,AUTO           cn=2,n=2034

      443     4939    2              SUBSTR(FMTBUF,14+LNK)='%)';

   4939  1 000306   774015 620010                    EAX0    -2035,X0
         1 000307   777777 660003                    ERX0    -1,DU
         1 000310   202211 236100                    LDQ     LNK,,AUTO
         1 000311   040146 100400                    MLR     fill='040'O
         1 000312   000013 000002 0                  ADSC9   11                       cn=0,n=2
         1 000313   201011 400010                    ADSC9   FMTBUF+3,Q,AUTO          cn=2,n=*X0

      444     4940    2              NXTBUF.OFFSET=NXTBUF.OFFSET+LNK+5;

   4940  1 000314   202011 236100                    LDQ     NXTBUF,,AUTO
         1 000315   202211 036100                    ADLQ    LNK,,AUTO
         1 000316   000005 036007                    ADLQ    5,DL
         1 000317   202011 756100                    STQ     NXTBUF,,AUTO

      445     4941    2              LNK=PINCRC(ADDR(NXTBUF),NXTBUF.OFFSET-4)->BASED_UBIN;

   4941  1 000320   000100 100506                    MLR     fill='000'O
         1 000321   202010 000004                    ADSC9   VEC1+2,Q,AUTO            cn=0,n=4
         1 000322   202211 000004                    ADSC9   LNK,,AUTO                cn=0,n=4

      446     4942    2              CALL BINCHAR(SUBSTR(FMTBUF,3,8), LNK);

   4942  1 000323   000100 301500                    BTD
         1 000324   202211 000004                    NDSC9   LNK,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         1 000325   201006 630010                    NDSC9   FMTBUF,,AUTO             cn=3,s=nosgn,sf=0,n=8

      447     4943    3              IF SUBSTR(FMTBUF,14)='KH$CHN%)' THEN DO;

   4943  1 000326   040000 106500                    CMPC    fill='040'O
         1 000327   201011 403762                    ADSC9   FMTBUF+3,,AUTO           cn=2,n=2034
         1 000330   000020 000010 0                  ADSC9   16                       cn=0,n=8
         1 000331   000221 601000 1                  TNZ     FMT_VDH
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:79   

      448     4944    3                 CALL DBM$GETMEM(LNK,%MY_CHN,DB_U#,SIZEC(%MY_CHN),,SIZEC(%MY_CHN))

   4944  1 000332   000011 236000 2                  LDQ     9
         1 000333   000001 235000 xsym               LDA     B_VECTNIL+1
         1 000334   202216 757100                    STAQ    LNK+5,,AUTO
         1 000335   000012 237000 2                  LDAQ    10
         1 000336   202214 757100                    STAQ    LNK+3,,AUTO
         1 000337   200006 630500                    EPPR0   DATBUF,,AUTO
         1 000340   202213 450500                    STP0    LNK+2,,AUTO
         1 000341   202211 631500                    EPPR1   LNK,,AUTO
         1 000342   202212 451500                    STP1    LNK+1,,AUTO
         1 000343   202212 630500                    EPPR0   LNK+1,,AUTO
         1 000344   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000345   000000 701000 xent               TSX1    DBM$GETMEM
         1 000346   000350 702000 1                  TSX2    s:4947

      449     4945    4                 WHENRETURN DO; GOTO NEXT_CHN; END;

   4945  1 000347   000027 710000 1                  TRA     NEXT_CHN

      450     4946    3                 END;

      451     4947    2              END;

   4947  1 000350   000221 710000 1                  TRA     FMT_VDH

      452     4948
      453     4949    1           RETURN;

   4949  1 000351   000000 702200 xent               TSX2  ! X66_ARET

      454     4950
      455     4951    1   DBD$VDH: ENTRY (KH$CHN_TOP);

   4951  1 000352   000000 700200 xent  DBD$VDH      TSX0  ! X66_AUTO_2
         1 000353   002244 000002                    ZERO    1188,2
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:80   

      456     4952    1           CALL DBM$GETMEM (KH$CHN_TOP,DATBUF,DB_U#,64,,64)

   4952  1 000354   000011 236000 2                  LDQ     9
         1 000355   000001 235000 xsym               LDA     B_VECTNIL+1
         1 000356   202216 757100                    STAQ    LNK+5,,AUTO
         1 000357   000012 237000 2                  LDAQ    10
         1 000360   202214 757100                    STAQ    LNK+3,,AUTO
         1 000361   200006 630500                    EPPR0   DATBUF,,AUTO
         1 000362   202213 450500                    STP0    LNK+2,,AUTO
         1 000363   200003 236100                    LDQ     @KH$CHN_TOP,,AUTO
         1 000364   202212 756100                    STQ     LNK+1,,AUTO
         1 000365   202212 630500                    EPPR0   LNK+1,,AUTO
         1 000366   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000367   000000 701000 xent               TSX1    DBM$GETMEM
         1 000370   000372 702000 1                  TSX2    s:4953
         1 000371   000373 710000 1                  TRA     s:4954

      457     4953    2           WHENALTRETURN DO; RETURN; END;

   4953  1 000372   000000 702200 xent               TSX2  ! X66_ARET

      458     4954    1           VEC1.ADR=ADDR(KH$CHN_TOP)->BASED_UBIN;

   4954  1 000373   200003 470500                    LDP0    @KH$CHN_TOP,,AUTO
         1 000374   000000 235100                    LDA     0,,PR0
         1 000375   202006 755100                    STA     VEC1,,AUTO

      459     4955    1           VEC1.CHN='0'B;

   4955  1 000376   202007 450100                    STZ     VEC1+1,,AUTO

      460     4956    1           VEC1.DB_FMT=DB_FMT;

   4956  1 000377   000000 236000 xsym               LDQ     DB_FMT
         1 000400   000000 376000 2                  ANQ     0
         1 000401   202010 756100                    STQ     VEC1+2,,AUTO
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:81   

      461     4957    1           DB_NXT$=ADDR(NXTBUF);

   4957  1 000402   202011 631500                    EPPR1   NXTBUF,,AUTO
         1 000403   000000 451400 xsym               STP1    DB_NXT$

      462     4958    1           NXTBUF.OFFSET=SIZEC(NXTBUF);

   4958  1 000404   001000 235007                    LDA     512,DL
         1 000405   202011 755100                    STA     NXTBUF,,AUTO

      463     4959    1           FMTBUF='%4E%(KV$VDI%)';

   4959  1 000406   040100 100400                    MLR     fill='040'O
         1 000407   000022 000015 0                  ADSC9   18                       cn=0,n=13
         1 000410   201006 004000                    ADSC9   FMTBUF,,AUTO             cn=0,n=2048

      464     4960    1           GOTO FMT_VDH;

   4960  1 000411   000221 710000 1                  TRA     FMT_VDH
      465     4961    1   END DBD$CHNTREE;

PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:82   
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   DB_ANLZ_M.:E05TOU  is referenced.
      No diagnostics issued in procedure DBD$CHNTREE.
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:83   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KH$CHN_CUR                3-0-0/w PTR         r     1 @KH$CHN_TOP
     6-0-0/w UBIN        r     1 DATBUF(0:511)              5-0-0/w STRC(19)    r     1 DB$FMT
  1006-0-0/c CHAR(2048)  r     1 FMTBUF                    *0-0-0/w STRC(576)   r     1 KH$CHN_CUR
    *0-0-0/w STRC(576)   r     1 KH$CHN_TOP              2211-0-0/w SBIN        r     1 LNK
  2011-0-0/w STRC(4608)  r     1 NXTBUF                  2006-0-0/w STRC(108)   r     1 VEC1

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$XL_ASC_DUMP$             0-0-0/w EPTR        r     1 DAF$WRITE
     0-0-0/w SBIN        r     1 DB_D#                      0-0-0/w STRC(19)    r     1 DB_FMT
     0-0-0/w PTR         r     1 DB_NXT$                    0-0-0/w SBIN        r     1 DB_U#

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 BASED_CHN                  0-0-0/c UBIN        r     1 BASED_UBIN
     0-0-0/d STRC(4608)  r     1 DA_PRINTABLE_TBL           0-0-0/c ASTR(9)     r     1 TEXTC


   Procedure DBD$CHNTREE requires 266 words for executable code.
   Procedure DBD$CHNTREE requires 1188 words of local(AUTO) storage.

    No errors detected in file DBD$CHNTBL.:E05TSI    .
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:84   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:85   
          MINI XREF LISTING

B$XL_ASC_DUMP$
      4877**DCL      4878--IMP-PTR  4927>>CALL
BASED_CHN
      4688**DCL      4898<<ASSIGN   4944<>CALL     4944--CALL     4944--CALL
BASED_CHN.DVCID.BYT
      4711**DCL      4923>>IF       4923>>IF
BASED_CHN.TERMID.LEV
      4784**DCL      4914>>IF       4917>>IF       4923>>IF
BASED_CHN.TERMID.TERM
      4784**DCL      4793--REDEF
BASED_CHN.TERMID.TERM.CHANNEL.BYT
      4786**DCL      4912>>ASSIGN   4912>>ASSIGN
BASED_CHN.TERMID.TERM.SUBDEVICE.BYT
      4787**DCL      4915>>ASSIGN   4915>>ASSIGN
BASED_CHN.TERMID.TERM.SUBSUBDEVICE.BYT
      4788**DCL      4918>>ASSIGN   4918>>ASSIGN
BASED_UBIN
      4801**DCL      4941>>ASSIGN   4954>>ASSIGN
DAF$WRITE
      4405**DCL      4921>>CALL     4932>>CALL
DATBUF
      4881**DCL      4898--ASSIGN   4912--ASSIGN   4912--ASSIGN   4914--IF       4915--ASSIGN   4915--ASSIGN
      4917--IF       4918--ASSIGN   4918--ASSIGN   4921--CALL     4923--IF       4923--IF       4923--IF
      4932--CALL     4944--CALL     4944--CALL     4944--CALL     4952<>CALL
DA_PRINTABLE_TBL
      4878**DCL      4927<>CALL
DB$FMT
      4854**DCL      4902<<ASSIGN   4931>>IF
DB$FMT.CHT
      4857**DCL      4905<<ASSIGN
DB$FMT.LCT
      4865**DCL      4903<<ASSIGN
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:86   
DB$FMT.TREE
      4856**DCL      4904<<ASSIGN
DBB$DUMPLCT
      4406**DCL-ENT  4927--CALL
DBM$GETMEM
      4408**DCL-ENT  4944--CALL     4952--CALL
DB_D#
      4895**DCL      4899<<ASSIGN
DB_FMT
      4818**DCL      4902>>ASSIGN   4906>>ASSIGN   4956>>ASSIGN
DB_FMT.LCT
      4829**DCL      4923>>IF
DB_FMT.TREE
      4820**DCL      4909>>IF
DB_NXT$
      4893**DCL      4900<<ASSIGN   4957<<ASSIGN
DB_U#
      4894**DCL      4944<>CALL     4952<>CALL
FMTBUF
      4882**DCL      4909<<ASSIGN   4910<<ASSIGN   4921--CALL     4930<<ASSIGN   4932--CALL     4936<<ASSIGN
      4938<<ASSIGN   4939<<ASSIGN   4942<<CALLBLT  4943>>IF       4959<<ASSIGN
FMT_VDH
      4932**LABEL    4960--GOTO
KH$CHN_CUR
      4563**DCL         7--PROC     4898>>ASSIGN
KH$CHN_CUR.TERMID.TERM
      4659**DCL      4668--REDEF
KH$CHN_TOP
      4439**DCL         7--PROC     4932--CALL     4951--ENTRY    4952<>CALL     4954--ASSIGN
KH$CHN_TOP.TERMID.TERM
      4535**DCL      4544--REDEF
LNK
      4896**DCL      4800--IMP-SIZ  4926<<ASSIGN   4927<>CALL     4937<<ASSIGN   4938>>ASSIGN   4939>>ASSIGN
      4940>>ASSIGN   4941<<ASSIGN   4942>>CALLBLT  4944<>CALL
NEXT_CHN
      4906**LABEL    4945--GOTO
PL6.E3A0      #002=DBD$CHNTREE File=DBD$CHNTBL.:E05TSI                           TUE 07/29/97 13:01 Page:87   
NXTBUF
      4890**DCL      4900--ASSIGN   4901--ASSIGN   4935--IF       4937--ASSIGN   4938--ASSIGN   4941--ASSIGN
      4957--ASSIGN   4958--ASSIGN
NXTBUF.OFFSET
      4891**DCL      4901<<ASSIGN   4935>>IF       4937>>ASSIGN   4938>>ASSIGN   4940<<ASSIGN   4940>>ASSIGN
      4941>>ASSIGN   4958<<ASSIGN
TEXTC.L
      4799**DCL      4937>>ASSIGN
TEXTC.T
      4800**DCL      4938>>ASSIGN
VEC1
      4883**DCL      4921--CALL     4932--CALL
VEC1.ADR
      4884**DCL      4954<<ASSIGN
VEC1.CHN
      4885**DCL      4911<<ASSIGN   4955<<ASSIGN
VEC1.CHN.CHN
      4886**DCL      4912<<ASSIGN   4926>>ASSIGN
VEC1.CHN.SUB
      4887**DCL      4915<<ASSIGN
VEC1.CHN.SUBSUB
      4888**DCL      4918<<ASSIGN
VEC1.DB_FMT
      4889**DCL      4906<<ASSIGN   4956<<ASSIGN
