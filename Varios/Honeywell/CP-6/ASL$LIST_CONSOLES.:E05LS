VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:1    
        1        1        /*M* ASL$LIST_ALL_CONSOLES: Routine to list consoles.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_CONSOLES: PROC ;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_CONSOLES
       13       13             CALL:     CALL ASL$LIST_ALL_CONSOLES ;
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_CONSOLES is the routine that
       17       17                           lists console names and calls the display
       18       18                           console routine.
       19       19                           This routine will read the following records
       20       20                           from :HLP  :
       21       21                                 console records - keys 'xxxxxxxx*'
       22       22                                 console records - keys 'xxxxxxxx'
       23       23                                 station records - keys 'xxxxxxxxSTATION'
       24       24                                 TERM record - keys 'TERM'
       25       25                                 TWSN records - keys 'TWSN9999'
       26       26                            Of the above records only the console records
       27       27                            are sure to be read in, the reading of the others
       28       28                            is dependent upon the actual command that was
       29       29                            input.
       30       30                       MEMORY UTILIZATION.
       31       31                            If the station clause was specified on the input
       32       32                            command, then the TERM record will be read into
       33       33                            data segment 1 and the TWSNxxxx record will be
       34       34                            read into data segment 2.
       35       35                            If the terminal clause was specified on the input
       36       36                            command, then the terminal record(s) will be read
       37       37                            into data segment 1 and the TWSNxxxx record will
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:2    
       38       38                            be read into data segment 2.
       39       39                            The individual console records will be read into
       40       40                            data segment 3.
       41       41        */
       42       42        /********************************************************************/
       43       43        /*   Include files   include files   include files   include files  */
       44       44        /********************************************************************/
       45       45        %INCLUDE AS_PERR_C;
       46      647        %INCLUDE AS_SUPER_C;
       47     1082        %INCLUDE AS_SUBS_C;
       48     2496        %INCLUDE AS_MAC_C;
       49     2576        %INCLUDE AS_ENTRIES_M;
       50     3626        %INCLUDE AS_SSUBS_C;
       51     3718        %INCLUDE B_ERRORS_C;
       52     4845        %INCLUDE CP_6;
       53     4926        %INCLUDE CP_6_SUBS;
       54     5466        %INCLUDE KL_CONFIG_M;
       55     6228        %INCLUDE KL_MACRO_C;
       56     9580        %INCLUDE KL_SUPER_C;
       57    12482        %INCLUDE XU_MACRO_C;
       58    15588        %INCLUDE XU_FORMAT_C;
       59    15750        %INCLUDE OCI_SUBS_C;
       60    15848        %INCLUDE AS_SUPER_R;
       61    18864        /********************************************************************/
       62    18865        /*   Equs            equs            equs            equs           */
       63    18866        /********************************************************************/
       64    18867        %EQU SINGLE_CONSOLE = 0;
       65    18868        %EQU CONSOLE_WILD = 2;
       66    18869        %EQU TERMINAL = 4;
       67    18870        %EQU TERMINAL_WILD = 5;
       68    18871        %EQU STATION = 6;
       69    18872        %EQU STATION_WILD = 7;
       70    18873        %EQU ALL = 8;
       71    18874        /********************************************************************/
       72    18875        /*   Static data     static data     static data     static data    */
       73    18876        /********************************************************************/
       74    18877        %KL$CONFIG_KEY (NAME=CONFIG_KEY,STCLASS=STATIC);
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:3    
       75    18924    1   DCL LINCNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
       76    18925    1   DCL LINCNFG$ PTR STATIC INIT(ADDR(LINCNFG_BUF));
       77    18926        %KL$LINCNFG (NAME=LINCNFG,STCLASS="BASED(LINCNFG$)");
       78    19084        /********************************************************************/
       79    19085        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       80    19086        /********************************************************************/
       81    19087        %ASA$ERROR ;
       82    19090        %ASB$BOF_HLP ;
       83    19093        %ASB$CHECK_TYPE ;
       84    19096        %ASB$GET_NEXT_STATION ;
       85    19099        %ASB$INIT_GET_STATION ;
       86    19102        %ASB$PREC_AND_SKIP_HLP ;
       87    19105        %ASB$PREC_HLP ;
       88    19108        %ASB$READ_HLP ;
       89    19111        %ASB$READ_HLP_SEQ ;
       90    19114        %ASB$WILD_MATCH ;
       91    19117        %ASB$WRITE_LO ;
       92    19120        %ASH$ERROR ;
       93    19123        %ASL$DISP_ONE_DEVICE ;
       94    19126        %ASL$FORMAT_CONNAME ;
       95    19129    1   DCL X$FORMAT ENTRY(1);
       96    19130        /********************************************************************/
       97    19131        /*   Local based     local based     local based     local based    */
       98    19132        /********************************************************************/
       99    19133        %KL_DREC      ( NAME = KL$TREC, STCLASS = "BASED(DSEG3$)", LAST = ",");
      100    19246        %KL_GJOB      ( NAME = GJOB, STCLASS = BASED, LVL = 2, LAST = "," );
      101    19270        %KL_HASP      ( NAME = HASP, STCLASS = BASED, LVL = 2 );
      102    19420        %KL_TWSNREC   ( NAME = KL$TWSNREC,STCLASS = "BASED(DSEG2$)");
      103    19445        %KL_DREC      ( NAME = KL$DREC, LAST = ";", STCLASS = BASED) ;
      104    19558        %KL_WSNCVT    ( NAME = KL$WSNCVT, STCLASS = "BASED(DSEG1$)");
      105    19565        %PARSE$OUT    ( NAME = P$B, STCLASS = BASED,
      106    19566                        NDTYPE = TYPE);
      107    19611        %PARSE$SYM    ( NAME = OUT$SYM, STCLASS = "BASED(BLK$)" );
      108    19649        /********************************************************************/
      109    19650        /*   Auto data       auto data       auto data       auto data      */
      110    19651        /********************************************************************/
      111    19652    1   DCL ACCT                     CHAR(8);
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:4    
      112    19653    1   DCL ACCT_LEN                 UBIN;
      113    19654    1   DCL ARS                      SBIN;
      114    19655    1   DCL 1 BEGIN_KEY,
      115    19656    1          2 COUNT               UBIN BYTE UNAL,
      116    19657    1          2 TEXT                CHAR(20) UNAL;
      117    19658    1   DCL BLK$                     PTR;
      118    19659    1   DCL 1 DEV_NAME,
      119    19660    1          2 COUNT               UBIN BYTE UNAL,
      120    19661    1          2 TEXT                CHAR(8) UNAL,
      121    19662    1          2 *                   CHAR(33) UNAL;
      122    19663    1   DCL DEV_TYPE                 UBIN;
      123    19664    1   DCL DISP                     BIT(1);
      124    19665    1   DCL DISP_CONSOLES            UBIN;
      125    19666    1   DCL 1 END_KEY,
      126    19667    1          2 COUNT               UBIN BYTE UNAL,
      127    19668    1          2 TEXT                CHAR(20) UNAL;
      128    19669    1   DCL I                        SBIN;
      129    19670    1   DCL JCL                      BIT(1);
      130    19671    1   DCL K                        SBIN;
      131    19672    1   DCL MATCH_LEN                UBIN;
      132    19673    1   DCL NAME_LEN                 UBIN;
      133    19674    1   DCL OPTION_CODE              UBIN;
      134    19675    1   DCL 1 STATION_NAME,
      135    19676    1          2 COUNT               UBIN BYTE UNAL,
      136    19677    1          2 TEXT                CHAR(8) UNAL;
      137    19678    1   DCL 1 TERMINAL_NAME,
      138    19679    1          2 COUNT               UBIN BYTE UNAL,
      139    19680    1          2 TEXT                CHAR(8) UNAL;
      140    19681    1   DCL TWSN_CHAR                CHAR(4);
      141    19682    1   DCL TWSN_NUMBER              UBIN;
      142    19683        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:5    
      143    19684        /********************************************************************/
      144    19685        /*   Constant data   constant data   constant data   constant data  */
      145    19686        /********************************************************************/
      146    19687    1   DCL CONSOLE_STR CHAR(0) CONSTANT INIT ('console');
      147    19688    1   DCL CONSOLES_STR CHAR(0) CONSTANT INIT ('consoles');
      148    19689    1   DCL DISPLAY_STR CHAR(0) CONSTANT INIT ('displayed');
      149    19690    1   DCL LIST_STR CHAR(0) CONSTANT INIT ('listed');
      150    19691        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:6    
      151    19692        /********************************************************************/
      152    19693        /*   Procedure       procedure       procedure       procedure      */
      153    19694        /********************************************************************/
      154    19695    1   JCL = %NO#;
      155    19696
      156    19697    1   OPTION_CODE = %SINGLE_CONSOLE;
      157    19698    1   DEV_NAME.COUNT = 1;
      158    19699    1   DEV_NAME.TEXT = '?';
      159    19700    1   STATION_NAME.COUNT = 1;
      160    19701    1   STATION_NAME.TEXT = '?';
      161    19702    1   TERMINAL_NAME.COUNT = 1;
      162    19703    1   TERMINAL_NAME.TEXT = '?';
      163    19704    1   DISP_CONSOLES = 0;
      164    19705    1   DEV_TYPE = %AS_CON#;
      165    19706
      166    19707    2   DO I = 0 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      167    19708
      168    19709    2      CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      169    19710
      170    19711    3      DO SELECT (CODE);
      171    19712
      172    19713    3         SELECT ( %LIST_ALL_VAL );
      173    19714
      174    19715    3         DISP = %NO#;
      175    19716    3         OPTION_CODE = %ALL ;
      176    19717
      177    19718    3         SELECT ( %DISPLAY_ALL_VAL );
      178    19719
      179    19720    3         DISP = %YES#;
      180    19721    3         OPTION_CODE = %ALL ;
      181    19722    3         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN
      182    19723    4         DO K = 0 TO P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS - 1;
      183    19724    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(K)->P$B.CODE = %JCL_VAL THEN
      184    19725    4               JCL = %YES#;
      185    19726    4            END;
      186    19727
      187    19728    3         SELECT (%DISPLAY_CONS_VAL, %LIST_CONS_VAL);
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:7    
      188    19729
      189    19730    3         DISP = (CODE = %DISPLAY_CONS_VAL);
      190    19731
      191    19732    3         SELECT (%CONSOLE_NAME_WILD_VAL);
      192    19733
      193    19734    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      194    19735    3         DEV_NAME.COUNT = OUT$SYM.COUNT;
      195    19736    3         DEV_NAME.TEXT = OUT$SYM.TEXT;
      196    19737
      197    19738    3         SELECT (%STATION_NAME_WILD_VAL);
      198    19739
      199    19740    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      200    19741    3         STATION_NAME.COUNT = OUT$SYM.COUNT;
      201    19742    3         STATION_NAME.TEXT = OUT$SYM.TEXT;
      202    19743    3         OPTION_CODE = %STATION;
      203    19744    3         CALL INDEX (K, '?', STATION_NAME.TEXT)
      204    19745    4         WHENRETURN DO;
      205    19746    4            OPTION_CODE = %STATION_WILD;
      206    19747    4            END; /*  Whenreturn  */
      207    19748
      208    19749    3         SELECT (%TERMINAL_NAME_WILD_VAL);
      209    19750
      210    19751    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      211    19752    3         TERMINAL_NAME.COUNT = OUT$SYM.COUNT;
      212    19753    3         TERMINAL_NAME.TEXT = OUT$SYM.TEXT;
      213    19754    3         OPTION_CODE = %TERMINAL;
      214    19755    3         CALL INDEX (K, '?', TERMINAL_NAME.TEXT)
      215    19756    4         WHENRETURN DO;
      216    19757    4            OPTION_CODE = %TERMINAL_WILD;
      217    19758    4            END; /*  Whenreturn  */
      218    19759
      219    19760    3         SELECT (%JCL_VAL);
      220    19761
      221    19762    3         JCL = %YES#;
      222    19763
      223    19764    3         END;  /*  Do select on code  */
      224    19765
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:8    
      225    19766    2      END;  /*  Do i  */
      226    19767
      227    19768    1   FDS.NVECS# = 0;
      228    19769    2   IF JCL THEN DO;
      229    19770    2      CALL CONCAT (FMT_BUF, '%1/"', CONSOLES_STR, '%1/');
      230    19771    2      FDS.FMT_.BOUND = LENGTHC (CONSOLES_STR) + 6;
      231    19772    2      END;   /*  Jcl  */
      232    19773    2   ELSE DO;
      233    19774    2      CALL CONCAT (FMT_BUF, '%1/', CONSOLES_STR, '%1/');
      234    19775    2      FDS.FMT_.BOUND = LENGTHC (CONSOLES_STR) + 5;
      235    19776    2      END;  /*  Not jcl  */
      236    19777    1   FDS.TABDFLT# = 10;
      237    19778    1   CALL X$FORMAT (FDS);
      238    19779
      239    19780    1   IF OPTION_CODE = %SINGLE_CONSOLE THEN
      240    19781    1      CALL INDEX (I, '?', DEV_NAME.TEXT)
      241    19782    2      WHENRETURN DO;
      242    19783    2         OPTION_CODE = %CONSOLE_WILD;
      243    19784    2         END; /*  Whenreturn  */
      244    19785
      245    19786    1   IF OPTION_CODE = %CONSOLE_WILD THEN
      246    19787    1      IF DEV_NAME.TEXT = '?' THEN
      247    19788    1         OPTION_CODE = %ALL;
      248    19789
      249    19790    2   DO SELECT (OPTION_CODE);
      250    19791
      251    19792    2      SELECT (%ALL); /*  List/display all devices  */
      252    19793
      253    19794    2      CALL ASB$BOF_HLP;
      254    19795    3      DO FOREVER;
      255    19796    3         ARS = DSEG3SIZE;
      256    19797    3         CALL ASB$READ_HLP_SEQ( DSEG3$, ARS, 3 )
      257    19798    4         WHENRETURN DO;
      258    19799    4            DEV_NAME = USERS_KEY;
      259    19800    5            IF DEV_TYPE = DSEG3$->KL$DREC.SUPER THEN DO;
      260    19801    6               IF DISP THEN DO;
      261    19802    6                  CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:9    
      262    19803    6                  CALL ASB$WRITE_LO (' ',1);
      263    19804    6                  END;  /*  Disp  */
      264    19805    6               ELSE DO; /*  list out the device name  */
      265    19806    6                  CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);
      266    19807    6                  END; /*  List  */
      267    19808    5               DISP_CONSOLES = DISP_CONSOLES + 1;
      268    19809    5               END; /*  The right type  */
      269    19810    5            IF DEV_NAME ~= USERS_KEY THEN DO;
      270    19811    5               USERS_KEY = DEV_NAME;
      271    19812    5               CALL ASB$PREC_AND_SKIP_HLP;
      272    19813    5               END; /*  DEV_NAME ~= USERS_KEY  */
      273    19814    4            END; /*  Whenreturn  */
      274    19815    4         WHENALTRETURN DO;
      275    19816    4            IF MERR_CODE.CODE ~= %E$EOF THEN
      276    19817    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      277    19818    4            GOTO FINISH_UP;
      278    19819    4            END; /*  Whenaltreturn  */
      279    19820    3         END; /*  Do forever  */
      280    19821
      281    19822    2      SELECT (%STATION_WILD);
      282    19823
      283    19824    2      CALL ASB$INIT_GET_STATION;
      284    19825    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;
      285    19826    3         CALL INDEX (NAME_LEN, ' ', KL$WSNCVT.WSN(TWSN_NUMBER));
      286    19827    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;
      287    19828    3         MATCH_LEN = STATION_NAME.COUNT;
      288    19829    3         CALL ASB$WILD_MATCH (NAME_LEN,KL$WSNCVT.WSN(TWSN_NUMBER),MATCH_LEN,
             19829                  STATION_NAME.TEXT) ALTRET (NEXT_STATION);
      289    19830    3         CALL ASB$GET_NEXT_STATION (TWSN_NUMBER) ALTRET (FINISH_UP);
      290    19831    4         DO I = 0 TO KL$TWSNREC.NDEV - 1;
      291    19832    5            IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;
      292    19833    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      293    19834    6                  NAME_LEN = 4;
      294    19835    6                  USERS_KEY.COUNT = 8;
      295    19836    6                  END; /*  A tdev  */
      296    19837    6               ELSE DO;          /* Not a tdev         */
      297    19838    6                  CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:10   
      298    19839    6                  USERS_KEY.COUNT = 9;
      299    19840    6                  END; /*  Not a tdev  */
      300    19841    5               MATCH_LEN = DEV_NAME.COUNT;
      301    19842    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME
             19842                        .TEXT)
      302    19843    6               WHENRETURN DO;
      303    19844    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      304    19845    6                  ARS = DSEG3SIZE;
      305    19846    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION1);
      306    19847    7                  IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      307    19848    7                     IF ~ DISP THEN
      308    19849    7                        CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);
      309    19850    8                     ELSE DO;
      310    19851    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      311    19852    8                        CALL ASB$WRITE_LO (' ',1);
      312    19853    8                        END; /*  Disp  */
      313    19854    7                     DISP_CONSOLES = DISP_CONSOLES + 1;
      314    19855    7                     END; /*  The right type  */
      315    19856    6                  END; /*  Whenreturn  */
      316    19857    5               END; /*  Not iom connected  */
      317    19858    4   NO_REC_FOR_STATION1:
      318    19859    4            END; /*  Do ndevs times  */
      319    19860    3   NEXT_STATION:
      320    19861    3         END; /*  Do ltwsn  */
      321    19862    2      GOTO FINISH_UP;
      322    19863
      323    19864    2      SELECT (%STATION);
      324    19865
      325    19866    2      USERS_KEY.COUNT = 15;
      326    19867    2      CALL CONCAT( USERS_KEY.TXTC, STATION_NAME.TEXT, 'STATION' );
      327    19868    2      ARS = DSEG1SIZE;
      328    19869    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ALT3 );
      329    19870    2      USERS_KEY.COUNT = 8;
      330    19871    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );
      331    19872    2      ARS = DSEG2SIZE;
      332    19873    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      333    19874    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:11   
      334    19875    4         IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;
      335    19876    5            IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      336    19877    5               NAME_LEN = 4;
      337    19878    5               USERS_KEY.COUNT = 8;
      338    19879    5               END; /*  A tdev  */
      339    19880    5            ELSE DO;          /* Not a tdev         */
      340    19881    5               CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));
      341    19882    5               USERS_KEY.COUNT = 9;
      342    19883    5               END; /*  Not a tdev  */
      343    19884    4            MATCH_LEN = DEV_NAME.COUNT;
      344    19885    4            CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             19885                     TEXT)
      345    19886    5            WHENRETURN DO;
      346    19887    5               CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      347    19888    5               ARS = DSEG3SIZE;
      348    19889    5               CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION2);
      349    19890    6               IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      350    19891    7                  IF ~ DISP THEN DO;
      351    19892    7                     CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);
      352    19893    7                     END; /*  ~disp  */
      353    19894    7                  ELSE DO;
      354    19895    7                     CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      355    19896    7                     CALL ASB$WRITE_LO (' ',1);
      356    19897    7                     END; /*  Disp  */
      357    19898    6                  DISP_CONSOLES = DISP_CONSOLES + 1;
      358    19899    6                  END; /*  The right type  */
      359    19900    5               END; /*  Whenreturn  */
      360    19901    4            END; /*  Not iom connected  */
      361    19902    3   NO_REC_FOR_STATION2:
      362    19903    3         END; /*  Do ndevs times  */
      363    19904    2      GOTO FINISH_UP;
      364    19905
      365    19906    2      SELECT (%TERMINAL_WILD);
      366    19907
      367    19908    2      USERS_KEY.COUNT = 4;
      368    19909    2      USERS_KEY.TXTC = 'TERM';
      369    19910    2      ARS = DSEG1SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:12   
      370    19911    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );
      371    19912    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;
      372    19913    4         IF KL$WSNCVT.WSN(TWSN_NUMBER) ~= ' ' THEN DO;
      373    19914    4            USERS_KEY.COUNT = 8;
      374    19915    4            CALL BINCHAR (TWSN_CHAR, TWSN_NUMBER);
      375    19916    4            CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSN_CHAR );
      376    19917    4            ARS = DSEG2SIZE;
      377    19918    4            CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      378    19919    5            DO I = 0 TO KL$TWSNREC.NDEV - 1;
      379    19920    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      380    19921    6                  MATCH_LEN = DEV_NAME.COUNT;
      381    19922    6                  CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             19922                           TEXT)
      382    19923    7                  WHENRETURN DO;
      383    19924    7                     CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));
      384    19925    7                     MATCH_LEN = TERMINAL_NAME.COUNT;
      385    19926    7                     CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             19926                              TERMINAL_NAME.TEXT)
      386    19927    8                     WHENRETURN DO;
      387    19928    8                        USERS_KEY.COUNT = 8;
      388    19929    8                        CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      389    19930    8                        ARS = DSEG3SIZE;
      390    19931    8                        CALL ASB$READ_HLP(DSEG3$, ARS, 3)
      391    19932    9                        WHENRETURN DO;
      392    19933   10                           IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      393    19934   11                              IF ~ DISP THEN DO;
      394    19935   11                                 CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);
      395    19936   11                                 END; /*  ~disp  */
      396    19937   11                              ELSE DO;
      397    19938   11                                 CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      398    19939   11                                 CALL ASB$WRITE_LO (' ',1);
      399    19940   11                                 END; /*  Disp  */
      400    19941   10                              DISP_CONSOLES = DISP_CONSOLES + 1;
      401    19942   10                              END; /*  The right type  */
      402    19943    9                           END; /*  Whenreturn from READ_HLP of device record  */
      403    19944    9                        WHENALTRETURN DO;
      404    19945        /*E* ERROR: ASL-E$NOCONFORTERM-C
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:13   
      405    19946             MESSAGE:  Console %U1 does not exist.
      406    19947             MESSAGE1:  It is listed in TWSN %U2 but can't be read from :HLP.
      407    19948        */
      408    19949    9                           AS_FIELD1.TEXT = KL$TWSNREC.DEVS.ACCT(I);
      409    19950    9                           AS_FIELD1.COUNT = 4;
      410    19951    9                           AS_FIELD2.TEXT = TWSN_CHAR;
      411    19952    9                           AS_FIELD2.COUNT = 4;
      412    19953                                %SCREAM (ERR#=%E$NOCONFORTERM,LEVEL=ERROR,MID='L');
      413    19968    9                           END; /*  Whenaltreturn from READ_HLP  */
      414    19969    8                        END; /*  Whenreturn from WILD_MATCH of terminal name */
      415    19970    7                     END; /*  Whenreturn  from WILD_MATCH of device name  */
      416    19971    6                  END; /*  A tdev  */
      417    19972    5               END; /*  Do ndevs times  */
      418    19973    4            USERS_KEY.COUNT = 4;
      419    19974    4            USERS_KEY.TXTC = 'TERM';
      420    19975    4            ARS = DSEG1SIZE;
      421    19976    4            CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );
      422    19977    4            END; /*  If station name not blank  */
      423    19978    3         END; /*  Do 0 to KL$WSNCVT.LTWSN  */
      424    19979
      425    19980    2      SELECT (%TERMINAL);
      426    19981
      427    19982    2      USERS_KEY.COUNT = 9;
      428    19983    2      CALL CONCAT( USERS_KEY.TXTC, TERMINAL_NAME.TEXT, '*' );
      429    19984    2      ARS = DSEG1SIZE;
      430    19985    2      CALL ASB$READ_HLP( DSEG1$, ARS, 1) ALTRET( READ_ERR );
      431    19986    2      AS_FIELD1.COUNT = TERMINAL_NAME.COUNT;
      432    19987    2      AS_FIELD1.TEXT = TERMINAL_NAME.TEXT;
      433    19988    2      AS_FIELD2.COUNT = 8;
      434    19989    2      AS_FIELD2.TEXT = 'TERMINAL';
      435    19990    2      CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_TERM#, %NO#, TERMINAL_NAME ) ALTRET(
             19990               FINISH_UP);
      436    19991    2      USERS_KEY.COUNT = 8;
      437    19992    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );
      438    19993    2      ARS = DSEG2SIZE;
      439    19994    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      440    19995    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:14   
      441    19996    3         USERS_KEY.COUNT = 8;
      442    19997    4         IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      443    19998    4            MATCH_LEN = DEV_NAME.COUNT;
      444    19999    4            CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.TEXT)
      445    20000    5            WHENRETURN DO;
      446    20001    5               CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));
      447    20002    5               MATCH_LEN = TERMINAL_NAME.COUNT;
      448    20003    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             20003                        TERMINAL_NAME.TEXT)
      449    20004    6               WHENRETURN DO;
      450    20005    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      451    20006    6                  ARS = DSEG3SIZE;
      452    20007    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_TERM2);
      453    20008    7                  IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      454    20009    8                     IF ~ DISP THEN DO;
      455    20010    8                        CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);
      456    20011    8                        END; /*  ~disp  */
      457    20012    8                     ELSE DO;
      458    20013    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      459    20014    8                        CALL ASB$WRITE_LO (' ',1);
      460    20015    8                        END; /*  Disp  */
      461    20016    7                     DISP_CONSOLES = DISP_CONSOLES + 1;
      462    20017    7                     END; /*  The right type  */
      463    20018    6                  END; /*  Whenreturn  */
      464    20019    5               END; /*  Whenreturn  */
      465    20020    4            END; /*  A tdev  */
      466    20021    3   NO_REC_FOR_TERM2:
      467    20022    3         END; /*  Do ndevs times  */
      468    20023
      469    20024    2      SELECT (%CONSOLE_WILD);
      470    20025
      471    20026                 /*  Setup begin key  */
      472    20027                 /*  Setup end key  */
      473    20028    2      CALL INDEX (I,'?',DEV_NAME.TEXT);
      474    20029    2      BEGIN_KEY.TEXT = SUBSTR (DEV_NAME.TEXT,0,I);
      475    20030    2      CALL CONCAT (END_KEY.TEXT,SUBSTR (DEV_NAME.TEXT,0,I),'~');
      476    20031    2      BEGIN_KEY.COUNT = 8;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:15   
      477    20032    2      END_KEY.COUNT = 8;
      478    20033    2      USERS_KEY = BEGIN_KEY;
      479    20034    2      CALL ASB$PREC_HLP;
      480    20035    2      ARS = DSEG3SIZE;
      481    20036    3      CALL ASB$READ_HLP_SEQ (DSEG3$,ARS,3) WHENRETURN DO;
      482    20037    4         DO WHILE USERS_KEY.TXTC < END_KEY.TEXT;
      483    20038        /*  Calculate ACCT_LEN and MATCH_LEN  */
      484    20039    4            CALL INDEX (ACCT_LEN,' ',USERS_KEY.TXTC);
      485    20040    4            IF ACCT_LEN > 7 THEN ACCT_LEN = 8;
      486    20041    4            ELSE IF ACCT_LEN = 0 THEN ACCT_LEN = 1;
      487    20042    4            CALL INDEX (MATCH_LEN,' ',DEV_NAME.TEXT);
      488    20043    4            IF MATCH_LEN < 8 THEN
      489    20044    4               MATCH_LEN = MATCH_LEN + 1;
      490    20045    4            ACCT = SUBSTR (USERS_KEY.TXTC,0,ACCT_LEN);
      491    20046    4            CALL ASB$WILD_MATCH (ACCT_LEN,ACCT,MATCH_LEN,DEV_NAME.TEXT)
      492    20047    5            WHENRETURN DO;
      493    20048    6               IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      494    20049    7                  IF DISP THEN DO;
      495    20050    7                     CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      496    20051    7                     CALL ASB$WRITE_LO (' ',1);
      497    20052    7                     END; /*  Disp  */
      498    20053    7                  ELSE DO;
      499    20054    7                     CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);
      500    20055    7                     END; /*  List  */
      501    20056    6                  DISP_CONSOLES = DISP_CONSOLES + 1;
      502    20057    6                  END; /*  KL$DREC.SUPER = DEV_TYPE  */
      503    20058    5               END; /*  Whenreturn from ASB$WILD_MATCH on acct  */
      504    20059    4            ARS = DSEG3SIZE;
      505    20060    4            CALL ASB$READ_HLP_SEQ (DSEG3$, ARS, 3) ALTRET(FINISH_UP);
      506    20061    4            END; /*  Do while USERS_KEY < END_KEY  */
      507    20062    3         END; /*  Whenreturn from ASB$READ_HLP_SEQ  */
      508    20063
      509    20064    2      SELECT (%SINGLE_CONSOLE);
      510    20065
      511    20066    2      USERS_KEY.COUNT = 9;
      512    20067    2      CALL CONCAT( USERS_KEY.TXTC, DEV_NAME.TEXT, '*' );
      513    20068    2      ARS = DSEG3SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:16   
      514    20069    2      CALL ASB$READ_HLP( DSEG3$, ARS, 3) ALTRET(RD_ALT2);
      515    20070    2      CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE, %NO#, DEV_NAME ) ALTRET(FINISH_UP);
      516    20071    3      IF DISP THEN DO;
      517    20072    3         CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      518    20073    3         CALL ASB$WRITE_LO (' ',1);
      519    20074    3         END;  /*  Disp  */
      520    20075    3      ELSE DO;
      521    20076    3         CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);
      522    20077    3         END; /*  List  */
      523    20078    2      DISP_CONSOLES = DISP_CONSOLES + 1;
      524    20079
      525    20080    2      END; /*  Do case (OPTION_CODE)  */
      526    20081
      527    20082    2   DO NEVER;
      528    20083    2   RD_ALT2:
      529    20084    3      IF MERR_CODE.CODE = %E$NOKEY THEN DO;
      530    20085        /*E*  ERROR:  ASL-E$DEV_NO_EXIST-C
      531    20086              MESSAGE: %U1 does not exist.
      532    20087              MESSAGE1: The specified CONSOLE does not exist.
      533    20088        */
      534    20089    3         AS_FIELD1 = DEV_NAME;
      535    20090              %SCREAM( ERR#=E$DEV_NO_EXIST2, LEVEL=ERROR, MID='L' );
      536    20105    3         END; /*  Error  */
      537    20106    2      ELSE CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      538    20107    2      GOTO FINISH_UP;
      539    20108
      540    20109    3   READ_ALT3: IF MERR_CODE.CODE = %E$NOKEY THEN DO;
      541    20110    3         AS_FIELD1.COUNT = STATION_NAME.COUNT;
      542    20111    3         AS_FIELD1.TEXT  = STATION_NAME.TEXT;
      543    20112              %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='L' );
      544    20127    3         END;  /*  No such key error  */
      545    20128    2      ELSE
      546    20129    2   READ_ERR: CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      547    20130    2      END;  /*  Do never  */
      548    20131    1   FINISH_UP:
      549    20132    2   IF NOT DISP THEN DO;
      550    20133    2      FMT_BUF = '%\%/';
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:17   
      551    20134    2      FDS.FMT_.BOUND = 3;
      552    20135    2      FDS.NVECS# = 0;
      553    20136    2      CALL X$FORMAT (FDS);
      554    20137    2      END; /*  If not disp  */
      555    20138    2   IF NOT JCL THEN DO;
      556    20139    2      FMT_VEC(0) = VECTOR (DISP_CONSOLES);
      557    20140    2      IF DISP_CONSOLES = 1 THEN
      558    20141    3      DO;
      559    20142    3         FMT_VEC(1) = VECTOR (CONSOLE_STR);
      560    20143    3         END; /*  DISP_CONSOLES = 1  */
      561    20144    3      ELSE DO;
      562    20145    3         FMT_VEC(1) = VECTOR (CONSOLES_STR);
      563    20146    3         END; /*  DISP_CONSOLES ~= 1  */
      564    20147    2      IF DISP THEN
      565    20148    3      DO;
      566    20149    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      567    20150    3         END; /*  If disp  */
      568    20151    3      ELSE DO;
      569    20152    3         FMT_VEC(2) = VECTOR (LIST_STR);
      570    20153    3         END; /*  If ~ disp  */
      571    20154    2      FDS.NVECS# = 3;
      572    20155    2      FMT_BUF = '   %5D %A %A.';
      573    20156    2      FDS.FMT_.BOUND = 12;
      574    20157    2      CALL X$FORMAT(FDS);
      575    20158    2      END; /* Not jcl */
      576    20159    1   RETURN;
      577    20160    1   END ASL$LIST_ALL_CONSOLES;
      578    20161        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:18   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_CONSOLES.

   Procedure ASL$LIST_ALL_CONSOLES requires 1275 words for executable code.
   Procedure ASL$LIST_ALL_CONSOLES requires 54 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:19   

 Object Unit name= ASL$LIST_ALL_CONSOLES                      File name= ASL$LIST_CONSOLES.:E05TOU
 UTS= JUL 29 '97 10:04:24.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    56     70  ASL$LIST_ALL_CONSOLES
    3  RoData even  UTS     24     30  ASL$LIST_ALL_CONSOLES
    4   Proc  even  none  1275   2373  ASL$LIST_ALL_CONSOLES
    5  RoData even  none    36     44  ASL$LIST_ALL_CONSOLES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASL$LIST_ALL_CONSOLES
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:20   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       0 ASB$BOF_HLP
         yes           Std       2 ASB$WRITE_LO
         yes           Std       2 ASL$FORMAT_CONNAME
 yes     yes           Std       0 ASB$PREC_AND_SKIP_HLP
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP_SEQ
         yes           Std       2 ASL$DISP_ONE_DEVICE
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$INIT_GET_STATION
 yes     yes           Std       3 ASB$READ_HLP
 yes     yes           Std       0 ASB$PREC_HLP
 yes     yes           Std       4 ASB$WILD_MATCH
         yes           Std       2 ASH$ERROR
 yes     yes           Std       1 ASB$GET_NEXT_STATION
 yes     yes           Std       5 ASB$CHECK_TYPE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:21   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             FDS
     FMT_BUF                               FMT_VEC                               CODE
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG1$                                DSEG1SIZE                             DSEG2$
     DSEG2SIZE                             DSEG3$                                DSEG3SIZE
     P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:22   


        1        1        /*M* ASL$LIST_ALL_CONSOLES: Routine to list consoles.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_CONSOLES: PROC ;

      9  4 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         4 000001   000066 000000                    ZERO    54,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_CONSOLES
       13       13             CALL:     CALL ASL$LIST_ALL_CONSOLES ;
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_CONSOLES is the routine that
       17       17                           lists console names and calls the display
       18       18                           console routine.
       19       19                           This routine will read the following records
       20       20                           from :HLP  :
       21       21                                 console records - keys 'xxxxxxxx*'
       22       22                                 console records - keys 'xxxxxxxx'
       23       23                                 station records - keys 'xxxxxxxxSTATION'
       24       24                                 TERM record - keys 'TERM'
       25       25                                 TWSN records - keys 'TWSN9999'
       26       26                            Of the above records only the console records
       27       27                            are sure to be read in, the reading of the others
       28       28                            is dependent upon the actual command that was
       29       29                            input.
       30       30                       MEMORY UTILIZATION.
       31       31                            If the station clause was specified on the input
       32       32                            command, then the TERM record will be read into
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:23   
       33       33                            data segment 1 and the TWSNxxxx record will be
       34       34                            read into data segment 2.
       35       35                            If the terminal clause was specified on the input
       36       36                            command, then the terminal record(s) will be read
       37       37                            into data segment 1 and the TWSNxxxx record will
       38       38                            be read into data segment 2.
       39       39                            The individual console records will be read into
       40       40                            data segment 3.
       41       41        */
       42       42        /********************************************************************/
       43       43        /*   Include files   include files   include files   include files  */
       44       44        /********************************************************************/
       45       45        %INCLUDE AS_PERR_C;
       46      647        %INCLUDE AS_SUPER_C;
       47     1082        %INCLUDE AS_SUBS_C;
       48     2496        %INCLUDE AS_MAC_C;
       49     2576        %INCLUDE AS_ENTRIES_M;
       50     3626        %INCLUDE AS_SSUBS_C;
       51     3718        %INCLUDE B_ERRORS_C;
       52     4845        %INCLUDE CP_6;
       53     4926        %INCLUDE CP_6_SUBS;
       54     5466        %INCLUDE KL_CONFIG_M;
       55     6228        %INCLUDE KL_MACRO_C;
       56     9580        %INCLUDE KL_SUPER_C;
       57    12482        %INCLUDE XU_MACRO_C;
       58    15588        %INCLUDE XU_FORMAT_C;
       59    15750        %INCLUDE OCI_SUBS_C;
       60    15848        %INCLUDE AS_SUPER_R;
       61    18864        /********************************************************************/
       62    18865        /*   Equs            equs            equs            equs           */
       63    18866        /********************************************************************/
       64    18867        %EQU SINGLE_CONSOLE = 0;
       65    18868        %EQU CONSOLE_WILD = 2;
       66    18869        %EQU TERMINAL = 4;
       67    18870        %EQU TERMINAL_WILD = 5;
       68    18871        %EQU STATION = 6;
       69    18872        %EQU STATION_WILD = 7;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:24   
       70    18873        %EQU ALL = 8;
       71    18874        /********************************************************************/
       72    18875        /*   Static data     static data     static data     static data    */
       73    18876        /********************************************************************/
       74    18877        %KL$CONFIG_KEY (NAME=CONFIG_KEY,STCLASS=STATIC);
       75    18924    1   DCL LINCNFG_BUF(0:49) UBIN WORD STATIC INIT(0*0);
       76    18925    1   DCL LINCNFG$ PTR STATIC INIT(ADDR(LINCNFG_BUF));
       77    18926        %KL$LINCNFG (NAME=LINCNFG,STCLASS="BASED(LINCNFG$)");
       78    19084        /********************************************************************/
       79    19085        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       80    19086        /********************************************************************/
       81    19087        %ASA$ERROR ;
       82    19090        %ASB$BOF_HLP ;
       83    19093        %ASB$CHECK_TYPE ;
       84    19096        %ASB$GET_NEXT_STATION ;
       85    19099        %ASB$INIT_GET_STATION ;
       86    19102        %ASB$PREC_AND_SKIP_HLP ;
       87    19105        %ASB$PREC_HLP ;
       88    19108        %ASB$READ_HLP ;
       89    19111        %ASB$READ_HLP_SEQ ;
       90    19114        %ASB$WILD_MATCH ;
       91    19117        %ASB$WRITE_LO ;
       92    19120        %ASH$ERROR ;
       93    19123        %ASL$DISP_ONE_DEVICE ;
       94    19126        %ASL$FORMAT_CONNAME ;
       95    19129    1   DCL X$FORMAT ENTRY(1);
       96    19130        /********************************************************************/
       97    19131        /*   Local based     local based     local based     local based    */
       98    19132        /********************************************************************/
       99    19133        %KL_DREC      ( NAME = KL$TREC, STCLASS = "BASED(DSEG3$)", LAST = ",");
      100    19246        %KL_GJOB      ( NAME = GJOB, STCLASS = BASED, LVL = 2, LAST = "," );
      101    19270        %KL_HASP      ( NAME = HASP, STCLASS = BASED, LVL = 2 );
      102    19420        %KL_TWSNREC   ( NAME = KL$TWSNREC,STCLASS = "BASED(DSEG2$)");
      103    19445        %KL_DREC      ( NAME = KL$DREC, LAST = ";", STCLASS = BASED) ;
      104    19558        %KL_WSNCVT    ( NAME = KL$WSNCVT, STCLASS = "BASED(DSEG1$)");
      105    19565        %PARSE$OUT    ( NAME = P$B, STCLASS = BASED,
      106    19566                        NDTYPE = TYPE);
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:25   
      107    19611        %PARSE$SYM    ( NAME = OUT$SYM, STCLASS = "BASED(BLK$)" );
      108    19649        /********************************************************************/
      109    19650        /*   Auto data       auto data       auto data       auto data      */
      110    19651        /********************************************************************/
      111    19652    1   DCL ACCT                     CHAR(8);
      112    19653    1   DCL ACCT_LEN                 UBIN;
      113    19654    1   DCL ARS                      SBIN;
      114    19655    1   DCL 1 BEGIN_KEY,
      115    19656    1          2 COUNT               UBIN BYTE UNAL,
      116    19657    1          2 TEXT                CHAR(20) UNAL;
      117    19658    1   DCL BLK$                     PTR;
      118    19659    1   DCL 1 DEV_NAME,
      119    19660    1          2 COUNT               UBIN BYTE UNAL,
      120    19661    1          2 TEXT                CHAR(8) UNAL,
      121    19662    1          2 *                   CHAR(33) UNAL;
      122    19663    1   DCL DEV_TYPE                 UBIN;
      123    19664    1   DCL DISP                     BIT(1);
      124    19665    1   DCL DISP_CONSOLES            UBIN;
      125    19666    1   DCL 1 END_KEY,
      126    19667    1          2 COUNT               UBIN BYTE UNAL,
      127    19668    1          2 TEXT                CHAR(20) UNAL;
      128    19669    1   DCL I                        SBIN;
      129    19670    1   DCL JCL                      BIT(1);
      130    19671    1   DCL K                        SBIN;
      131    19672    1   DCL MATCH_LEN                UBIN;
      132    19673    1   DCL NAME_LEN                 UBIN;
      133    19674    1   DCL OPTION_CODE              UBIN;
      134    19675    1   DCL 1 STATION_NAME,
      135    19676    1          2 COUNT               UBIN BYTE UNAL,
      136    19677    1          2 TEXT                CHAR(8) UNAL;
      137    19678    1   DCL 1 TERMINAL_NAME,
      138    19679    1          2 COUNT               UBIN BYTE UNAL,
      139    19680    1          2 TEXT                CHAR(8) UNAL;
      140    19681    1   DCL TWSN_CHAR                CHAR(4);
      141    19682    1   DCL TWSN_NUMBER              UBIN;
      142    19683        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:26   
      143    19684        /********************************************************************/
      144    19685        /*   Constant data   constant data   constant data   constant data  */
      145    19686        /********************************************************************/
      146    19687    1   DCL CONSOLE_STR CHAR(0) CONSTANT INIT ('console');
      147    19688    1   DCL CONSOLES_STR CHAR(0) CONSTANT INIT ('consoles');
      148    19689    1   DCL DISPLAY_STR CHAR(0) CONSTANT INIT ('displayed');
      149    19690    1   DCL LIST_STR CHAR(0) CONSTANT INIT ('listed');
      150    19691        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:27   
      151    19692        /********************************************************************/
      152    19693        /*   Procedure       procedure       procedure       procedure      */
      153    19694        /********************************************************************/
      154    19695    1   JCL = %NO#;

  19695  4 000002   200043 450100                    STZ     JCL,,AUTO

      155    19696
      156    19697    1   OPTION_CODE = %SINGLE_CONSOLE;

  19697  4 000003   200047 450100                    STZ     OPTION_CODE,,AUTO

      157    19698    1   DEV_NAME.COUNT = 1;

  19698  4 000004   001000 236003                    LDQ     512,DU
         4 000005   200016 552140                    STBQ    DEV_NAME,'40'O,AUTO

      158    19699    1   DEV_NAME.TEXT = '?';

  19699  4 000006   040100 100400                    MLR     fill='040'O
         4 000007   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000010   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8

      159    19700    1   STATION_NAME.COUNT = 1;

  19700  4 000011   200050 552140                    STBQ    STATION_NAME,'40'O,AUTO

      160    19701    1   STATION_NAME.TEXT = '?';

  19701  4 000012   040100 100400                    MLR     fill='040'O
         4 000013   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000014   200050 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8

      161    19702    1   TERMINAL_NAME.COUNT = 1;

  19702  4 000015   200053 552140                    STBQ    TERMINAL_NAME,'40'O,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:28   
      162    19703    1   TERMINAL_NAME.TEXT = '?';

  19703  4 000016   040100 100400                    MLR     fill='040'O
         4 000017   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000020   200053 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8

      163    19704    1   DISP_CONSOLES = 0;

  19704  4 000021   200033 450100                    STZ     DISP_CONSOLES,,AUTO

      164    19705    1   DEV_TYPE = %AS_CON#;

  19705  4 000022   000004 235007                    LDA     4,DL
         4 000023   200031 755100                    STA     DEV_TYPE,,AUTO

      165    19706
      166    19707    2   DO I = 0 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  19707  4 000024   200042 450100                    STZ     I,,AUTO
         4 000025   000222 710000 4                  TRA     s:19766+1

      167    19708
      168    19709    2      CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  19709  4 000026   000003 470400 xsym               LDP0    P_PCB+3
         4 000027   200042 720100                    LXL0    I,,AUTO
         4 000030   000003 471510                    LDP1    3,X0,PR0
         4 000031   100000 236100                    LDQ     0,,PR1
         4 000032   777777 376007                    ANQ     -1,DL
         4 000033   000000 756000 xsym               STQ     CODE

      169    19710
      170    19711    3      DO SELECT (CODE);

  19711  4 000034   000123 116007                    CMPQ    83,DL
         4 000035   000053 602000 4                  TNC     s:19711+15
         4 000036   000122 600000 4                  TZE     s:19730
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:29   
         4 000037   000311 116007                    CMPQ    201,DL
         4 000040   000050 602000 4                  TNC     s:19711+12
         4 000041   000145 600000 4                  TZE     s:19740
         4 000042   000345 116007                    CMPQ    229,DL
         4 000043   000221 602000 4                  TNC     s:19766
         4 000044   000131 600000 4                  TZE     s:19734
         4 000045   000351 116007                    CMPQ    233,DL
         4 000046   000221 601000 4                  TNZ     s:19766
         4 000047   000172 710000 4                  TRA     s:19751
         4 000050   000144 116007                    CMPQ    100,DL
         4 000051   000221 601000 4                  TNZ     s:19766
         4 000052   000070 710000 4                  TRA     s:19720
         4 000053   000015 116007                    CMPQ    13,DL
         4 000054   000061 602000 4                  TNC     s:19711+21
         4 000055   000122 600000 4                  TZE     s:19730
         4 000056   000022 116007                    CMPQ    18,DL
         4 000057   000221 601000 4                  TNZ     s:19766
         4 000060   000064 710000 4                  TRA     s:19715
         4 000061   000001 116007                    CMPQ    1,DL
         4 000062   000221 601000 4                  TNZ     s:19766
         4 000063   000217 710000 4                  TRA     s:19762

      171    19712
      172    19713    3         SELECT ( %LIST_ALL_VAL );

      173    19714
      174    19715    3         DISP = %NO#;

  19715  4 000064   200032 450100                    STZ     DISP,,AUTO

      175    19716    3         OPTION_CODE = %ALL ;

  19716  4 000065   000010 235007                    LDA     8,DL
         4 000066   200047 755100                    STA     OPTION_CODE,,AUTO
         4 000067   000221 710000 4                  TRA     s:19766

      176    19717
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:30   
      177    19718    3         SELECT ( %DISPLAY_ALL_VAL );

      178    19719
      179    19720    3         DISP = %YES#;

  19720  4 000070   400000 236003                    LDQ     -131072,DU
         4 000071   200032 756100                    STQ     DISP,,AUTO

      180    19721    3         OPTION_CODE = %ALL ;

  19721  4 000072   000010 235007                    LDA     8,DL
         4 000073   200047 755100                    STA     OPTION_CODE,,AUTO

      181    19722    3         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN

  19722  4 000074   000003 471510                    LDP1    3,X0,PR0
         4 000075   100001 221100                    LDX1    1,,PR1
         4 000076   000221 600000 4                  TZE     s:19766

      182    19723    4         DO K = 0 TO P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS - 1;

  19723  4 000077   200044 450100                    STZ     K,,AUTO
         4 000100   000114 710000 4                  TRA     s:19726+1

      183    19724    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(K)->P$B.CODE = %JCL_VAL THEN

  19724  4 000101   000003 470400 xsym               LDP0    P_PCB+3
         4 000102   200042 720100                    LXL0    I,,AUTO
         4 000103   000003 471510                    LDP1    3,X0,PR0
         4 000104   200044 721100                    LXL1    K,,AUTO
         4 000105   100003 473511                    LDP3    3,X1,PR1
         4 000106   300000 722100                    LXL2    0,,PR3
         4 000107   000001 102003                    CMPX2   1,DU
         4 000110   000113 601000 4                  TNZ     s:19726

      184    19725    4               JCL = %YES#;

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:31   
  19725  4 000111   400000 236003                    LDQ     -131072,DU
         4 000112   200043 756100                    STQ     JCL,,AUTO

      185    19726    4            END;

  19726  4 000113   200044 054100                    AOS     K,,AUTO
         4 000114   000003 471510                    LDP1    3,X0,PR0
         4 000115   100001 236100                    LDQ     1,,PR1
         4 000116   000022 772000                    QRL     18
         4 000117   200044 116100                    CMPQ    K,,AUTO
         4 000120   000101 605400 4                  TPNZ    s:19724
         4 000121   000221 710000 4                  TRA     s:19766

      186    19727
      187    19728    3         SELECT (%DISPLAY_CONS_VAL, %LIST_CONS_VAL);

      188    19729
      189    19730    3         DISP = (CODE = %DISPLAY_CONS_VAL);

  19730  4 000122   400000 221003                    LDX1    -131072,DU
         4 000123   000123 116007                    CMPQ    83,DL
         4 000124   000126 600000 4                  TZE     s:19730+4
         4 000125   000000 221003                    LDX1    0,DU
         4 000126   000000 636011                    EAQ     0,X1
         4 000127   200032 756100                    STQ     DISP,,AUTO
         4 000130   000221 710000 4                  TRA     s:19766

      190    19731
      191    19732    3         SELECT (%CONSOLE_NAME_WILD_VAL);

      192    19733
      193    19734    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19734  4 000131   000003 236110                    LDQ     3,X0,PR0
         4 000132   200015 756100                    STQ     BLK$,,AUTO

      194    19735    3         DEV_NAME.COUNT = OUT$SYM.COUNT;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:32   

  19735  4 000133   200015 471500                    LDP1    BLK$,,AUTO
         4 000134   100004 236100                    LDQ     4,,PR1
         4 000135   200016 552140                    STBQ    DEV_NAME,'40'O,AUTO

      195    19736    3         DEV_NAME.TEXT = OUT$SYM.TEXT;

  19736  4 000136   100004 236100                    LDQ     4,,PR1
         4 000137   000033 772000                    QRL     27
         4 000140   000000 621006                    EAX1    0,QL
         4 000141   040100 100540                    MLR     fill='040'O
         4 000142   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000143   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 000144   000221 710000 4                  TRA     s:19766

      196    19737
      197    19738    3         SELECT (%STATION_NAME_WILD_VAL);

      198    19739
      199    19740    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19740  4 000145   000003 236110                    LDQ     3,X0,PR0
         4 000146   200015 756100                    STQ     BLK$,,AUTO

      200    19741    3         STATION_NAME.COUNT = OUT$SYM.COUNT;

  19741  4 000147   200015 471500                    LDP1    BLK$,,AUTO
         4 000150   100004 236100                    LDQ     4,,PR1
         4 000151   200050 552140                    STBQ    STATION_NAME,'40'O,AUTO

      201    19742    3         STATION_NAME.TEXT = OUT$SYM.TEXT;

  19742  4 000152   100004 236100                    LDQ     4,,PR1
         4 000153   000033 772000                    QRL     27
         4 000154   000000 621006                    EAX1    0,QL
         4 000155   040100 100540                    MLR     fill='040'O
         4 000156   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:33   
         4 000157   200050 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8

      202    19743    3         OPTION_CODE = %STATION;

  19743  4 000160   000006 235007                    LDA     6,DL
         4 000161   200047 755100                    STA     OPTION_CODE,,AUTO

      203    19744    3         CALL INDEX (K, '?', STATION_NAME.TEXT)

  19744  4 000162   000000 124500                    SCM     mask='000'O
         4 000163   200050 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 000164   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000165   200044 000100                    ARG     K,,AUTO
         4 000166   000171 606400 4                  TTN     s:19747

      204    19745    4         WHENRETURN DO;

      205    19746    4            OPTION_CODE = %STATION_WILD;

  19746  4 000167   000007 236007                    LDQ     7,DL
         4 000170   200047 756100                    STQ     OPTION_CODE,,AUTO

      206    19747    4            END; /*  Whenreturn  */

  19747  4 000171   000221 710000 4                  TRA     s:19766

      207    19748
      208    19749    3         SELECT (%TERMINAL_NAME_WILD_VAL);

      209    19750
      210    19751    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19751  4 000172   000003 236110                    LDQ     3,X0,PR0
         4 000173   200015 756100                    STQ     BLK$,,AUTO

      211    19752    3         TERMINAL_NAME.COUNT = OUT$SYM.COUNT;

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:34   
  19752  4 000174   200015 471500                    LDP1    BLK$,,AUTO
         4 000175   100004 236100                    LDQ     4,,PR1
         4 000176   200053 552140                    STBQ    TERMINAL_NAME,'40'O,AUTO

      212    19753    3         TERMINAL_NAME.TEXT = OUT$SYM.TEXT;

  19753  4 000177   100004 236100                    LDQ     4,,PR1
         4 000200   000033 772000                    QRL     27
         4 000201   000000 621006                    EAX1    0,QL
         4 000202   040100 100540                    MLR     fill='040'O
         4 000203   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000204   200053 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8

      213    19754    3         OPTION_CODE = %TERMINAL;

  19754  4 000205   000004 235007                    LDA     4,DL
         4 000206   200047 755100                    STA     OPTION_CODE,,AUTO

      214    19755    3         CALL INDEX (K, '?', TERMINAL_NAME.TEXT)

  19755  4 000207   000000 124500                    SCM     mask='000'O
         4 000210   200053 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 000211   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000212   200044 000100                    ARG     K,,AUTO
         4 000213   000216 606400 4                  TTN     s:19758

      215    19756    4         WHENRETURN DO;

      216    19757    4            OPTION_CODE = %TERMINAL_WILD;

  19757  4 000214   000005 236007                    LDQ     5,DL
         4 000215   200047 756100                    STQ     OPTION_CODE,,AUTO

      217    19758    4            END; /*  Whenreturn  */

  19758  4 000216   000221 710000 4                  TRA     s:19766

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:35   
      218    19759
      219    19760    3         SELECT (%JCL_VAL);

      220    19761
      221    19762    3         JCL = %YES#;

  19762  4 000217   400000 236003                    LDQ     -131072,DU
         4 000220   200043 756100                    STQ     JCL,,AUTO

      222    19763
      223    19764    3         END;  /*  Do select on code  */

      224    19765
      225    19766    2      END;  /*  Do i  */

  19766  4 000221   200042 054100                    AOS     I,,AUTO
         4 000222   000003 470400 xsym               LDP0    P_PCB+3
         4 000223   000001 236100                    LDQ     1,,PR0
         4 000224   000022 772000                    QRL     18
         4 000225   200042 116100                    CMPQ    I,,AUTO
         4 000226   000026 605400 4                  TPNZ    s:19709

      226    19767
      227    19768    1   FDS.NVECS# = 0;

  19768  4 000227   000011 450000 xsym               STZ     FDS+9

      228    19769    2   IF JCL THEN DO;

  19769  4 000230   200043 234100                    SZN     JCL,,AUTO
         4 000231   000247 605000 4                  TPL     s:19774

      229    19770    2      CALL CONCAT (FMT_BUF, '%1/"', CONSOLES_STR, '%1/');

  19770  4 000232   000011 236000 3                  LDQ     LIST_STR+2
         4 000233   000000 756000 xsym               STQ     FMT_BUF
         4 000234   000002 237000 3                  LDAQ    CONSOLES_STR
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:36   
         4 000235   000001 755000 xsym               STA     FMT_BUF+1
         4 000236   000002 756000 xsym               STQ     FMT_BUF+2
         4 000237   040000 100400                    MLR     fill='040'O
         4 000240   000011 000003 3                  ADSC9   LIST_STR+2               cn=0,n=3
         4 000241   000003 000363 xsym               ADSC9   FMT_BUF+3                cn=0,n=243

      230    19771    2      FDS.FMT_.BOUND = LENGTHC (CONSOLES_STR) + 6;

  19771  4 000242   000000 236000 xsym               LDQ     FDS
         4 000243   177777 376007                    ANQ     65535,DL
         4 000244   000001 276000 5                  ORQ     1
         4 000245   000000 756000 xsym               STQ     FDS

      231    19772    2      END;   /*  Jcl  */

  19772  4 000246   000265 710000 4                  TRA     s:19777

      232    19773    2   ELSE DO;

      233    19774    2      CALL CONCAT (FMT_BUF, '%1/', CONSOLES_STR, '%1/');

  19774  4 000247   000011 236000 3                  LDQ     LIST_STR+2
         4 000250   000002 376000 5                  ANQ     2
         4 000251   000040 276007                    ORQ     32,DL
         4 000252   000000 756000 xsym               STQ     FMT_BUF
         4 000253   040000 100400                    MLR     fill='040'O
         4 000254   000002 000010 3                  ADSC9   CONSOLES_STR             cn=0,n=8
         4 000255   000000 600010 xsym               ADSC9   FMT_BUF                  cn=3,n=8
         4 000256   040000 100400                    MLR     fill='040'O
         4 000257   000011 000003 3                  ADSC9   LIST_STR+2               cn=0,n=3
         4 000260   000002 600364 xsym               ADSC9   FMT_BUF+2                cn=3,n=244

      234    19775    2      FDS.FMT_.BOUND = LENGTHC (CONSOLES_STR) + 5;

  19775  4 000261   000000 236000 xsym               LDQ     FDS
         4 000262   177777 376007                    ANQ     65535,DL
         4 000263   000003 276000 5                  ORQ     3
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:37   
         4 000264   000000 756000 xsym               STQ     FDS

      235    19776    2      END;  /*  Not jcl  */

      236    19777    1   FDS.TABDFLT# = 10;

  19777  4 000265   000012 235007                    LDA     10,DL
         4 000266   000017 755000 xsym               STA     FDS+15

      237    19778    1   CALL X$FORMAT (FDS);

  19778  4 000267   000004 630400 5                  EPPR0   4
         4 000270   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000271   000000 701000 xent               TSX1    X$FORMAT
         4 000272   000000 011000                    NOP     0

      238    19779
      239    19780    1   IF OPTION_CODE = %SINGLE_CONSOLE THEN

  19780  4 000273   200047 235100                    LDA     OPTION_CODE,,AUTO
         4 000274   000304 601000 4                  TNZ     s:19786

      240    19781    1      CALL INDEX (I, '?', DEV_NAME.TEXT)

  19781  4 000275   000000 124500                    SCM     mask='000'O
         4 000276   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 000277   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000300   200042 000100                    ARG     I,,AUTO
         4 000301   000304 606400 4                  TTN     s:19786

      241    19782    2      WHENRETURN DO;

      242    19783    2         OPTION_CODE = %CONSOLE_WILD;

  19783  4 000302   000002 236007                    LDQ     2,DL
         4 000303   200047 756100                    STQ     OPTION_CODE,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:38   
      243    19784    2         END; /*  Whenreturn  */

      244    19785
      245    19786    1   IF OPTION_CODE = %CONSOLE_WILD THEN

  19786  4 000304   200047 235100                    LDA     OPTION_CODE,,AUTO
         4 000305   000002 115007                    CMPA    2,DL
         4 000306   000315 601000 4                  TNZ     s:19790

      246    19787    1      IF DEV_NAME.TEXT = '?' THEN

  19787  4 000307   040000 106500                    CMPC    fill='040'O
         4 000310   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 000311   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000312   000315 601000 4                  TNZ     s:19790

      247    19788    1         OPTION_CODE = %ALL;

  19788  4 000313   000010 236007                    LDQ     8,DL
         4 000314   200047 756100                    STQ     OPTION_CODE,,AUTO

      248    19789
      249    19790    2   DO SELECT (OPTION_CODE);

  19790  4 000315   200047 236100                    LDQ     OPTION_CODE,,AUTO
         4 000316   000005 116007                    CMPQ    5,DL
         4 000317   000332 602000 4                  TNC     s:19790+13
         4 000320   001133 600000 4                  TZE     s:19908
         4 000321   000007 116007                    CMPQ    7,DL
         4 000322   000327 602000 4                  TNC     s:19790+10
         4 000323   000451 600000 4                  TZE     s:19824
         4 000324   000010 116007                    CMPQ    8,DL
         4 000325   002240 601000 4                  TNZ     s:20082
         4 000326   000343 710000 4                  TRA     s:19794
         4 000327   000006 116007                    CMPQ    6,DL
         4 000330   002240 601000 4                  TNZ     s:20082
         4 000331   000706 710000 4                  TRA     s:19866
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:39   
         4 000332   000002 116007                    CMPQ    2,DL
         4 000333   000340 602000 4                  TNC     s:19790+19
         4 000334   001737 600000 4                  TZE     s:20028
         4 000335   000004 116007                    CMPQ    4,DL
         4 000336   002240 601000 4                  TNZ     s:20082
         4 000337   001454 710000 4                  TRA     s:19982
         4 000340   000000 116003                    CMPQ    0,DU
         4 000341   002144 600000 4                  TZE     s:20066
         4 000342   002240 710000 4                  TRA     s:20082

      250    19791
      251    19792    2      SELECT (%ALL); /*  List/display all devices  */

      252    19793
      253    19794    2      CALL ASB$BOF_HLP;

  19794  4 000343   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000344   000000 701000 xent               TSX1    ASB$BOF_HLP
         4 000345   000000 011000                    NOP     0

      254    19795    3      DO FOREVER;

      255    19796    3         ARS = DSEG3SIZE;

  19796  4 000346   000000 235000 xsym               LDA     DSEG3SIZE
         4 000347   200006 755100                    STA     ARS,,AUTO

      256    19797    3         CALL ASB$READ_HLP_SEQ( DSEG3$, ARS, 3 )

  19797  4 000350   000005 236000 5                  LDQ     5
         4 000351   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000352   200006 630500                    EPPR0   ARS,,AUTO
         4 000353   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000354   000006 236000 5                  LDQ     6
         4 000355   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 000356   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000357   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:40   
         4 000360   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         4 000361   000437 702000 4                  TSX2    s:19816

      257    19798    4         WHENRETURN DO;

      258    19799    4            DEV_NAME = USERS_KEY;

  19799  4 000362   000100 100400                    MLR     fill='000'O
         4 000363   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 000364   200016 000052                    ADSC9   DEV_NAME,,AUTO           cn=0,n=42

      259    19800    5            IF DEV_TYPE = DSEG3$->KL$DREC.SUPER THEN DO;

  19800  4 000365   000000 470400 xsym               LDP0    DSEG3$
         4 000366   000000 236100                    LDQ     0,,PR0
         4 000367   000777 376007                    ANQ     511,DL
         4 000370   200031 116100                    CMPQ    DEV_TYPE,,AUTO
         4 000371   000424 601000 4                  TNZ     s:19810

      260    19801    6               IF DISP THEN DO;

  19801  4 000372   200032 234100                    SZN     DISP,,AUTO
         4 000373   000411 605000 4                  TPL     s:19806

      261    19802    6                  CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  19802  4 000374   000007 236000 5                  LDQ     7
         4 000375   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000376   200043 631500                    EPPR1   JCL,,AUTO
         4 000377   200060 451500                    STP1    TWSN_NUMBER+1,,AUTO
         4 000400   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000401   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000402   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 000403   000000 011000                    NOP     0

      262    19803    6                  CALL ASB$WRITE_LO (' ',1);

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:41   
  19803  4 000404   000010 630400 5                  EPPR0   8
         4 000405   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000406   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000407   000000 011000                    NOP     0

      263    19804    6                  END;  /*  Disp  */

  19804  4 000410   000421 710000 4                  TRA     s:19808

      264    19805    6               ELSE DO; /*  list out the device name  */

      265    19806    6                  CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);

  19806  4 000411   200033 631500                    EPPR1   DISP_CONSOLES,,AUTO
         4 000412   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 000413   000012 236000 5                  LDQ     10
         4 000414   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 000415   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000416   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000417   000000 701000 xent               TSX1    ASL$FORMAT_CONNAME
         4 000420   000000 011000                    NOP     0

      266    19807    6                  END; /*  List  */

      267    19808    5               DISP_CONSOLES = DISP_CONSOLES + 1;

  19808  4 000421   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 000422   000001 035007                    ADLA    1,DL
         4 000423   200033 755100                    STA     DISP_CONSOLES,,AUTO

      268    19809    5               END; /*  The right type  */

      269    19810    5            IF DEV_NAME ~= USERS_KEY THEN DO;

  19810  4 000424   000000 106500                    CMPC    fill='000'O
         4 000425   200016 000052                    ADSC9   DEV_NAME,,AUTO           cn=0,n=42
         4 000426   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:42   
         4 000427   000436 600000 4                  TZE     s:19814

      270    19811    5               USERS_KEY = DEV_NAME;

  19811  4 000430   000000 100500                    MLR     fill='000'O
         4 000431   200016 000052                    ADSC9   DEV_NAME,,AUTO           cn=0,n=42
         4 000432   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      271    19812    5               CALL ASB$PREC_AND_SKIP_HLP;

  19812  4 000433   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000434   000000 701000 xent               TSX1    ASB$PREC_AND_SKIP_HLP
         4 000435   000000 011000                    NOP     0

      272    19813    5               END; /*  DEV_NAME ~= USERS_KEY  */

      273    19814    4            END; /*  Whenreturn  */

  19814  4 000436   000450 710000 4                  TRA     s:19820

      274    19815    4         WHENALTRETURN DO;

      275    19816    4            IF MERR_CODE.CODE ~= %E$EOF THEN

  19816  4 000437   000000 236000 xsym               LDQ     ERR_CODE
         4 000440   377770 376007                    ANQ     131064,DL
         4 000441   000060 116007                    CMPQ    48,DL
         4 000442   000447 600000 4                  TZE     s:19818

      276    19817    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  19817  4 000443   000014 630400 5                  EPPR0   12
         4 000444   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000445   000000 701000 xent               TSX1    ASA$ERROR
         4 000446   000000 011000                    NOP     0

      277    19818    4            GOTO FINISH_UP;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:43   

  19818  4 000447   002304 710000 4                  TRA     FINISH_UP

      278    19819    4            END; /*  Whenaltreturn  */
      279    19820    3         END; /*  Do forever  */

  19820  4 000450   000346 710000 4                  TRA     s:19796

      280    19821
      281    19822    2      SELECT (%STATION_WILD);

      282    19823
      283    19824    2      CALL ASB$INIT_GET_STATION;

  19824  4 000451   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000452   000000 701000 xent               TSX1    ASB$INIT_GET_STATION
         4 000453   000000 011000                    NOP     0

      284    19825    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;

  19825  4 000454   200057 450100                    STZ     TWSN_NUMBER,,AUTO
         4 000455   000701 710000 4                  TRA     NEXT_STATION+3

      285    19826    3         CALL INDEX (NAME_LEN, ' ', KL$WSNCVT.WSN(TWSN_NUMBER));

  19826  4 000456   200057 235100                    LDA     TWSN_NUMBER,,AUTO
         4 000457   000003 735000                    ALS     3
         4 000460   000000 470400 xsym               LDP0    DSEG1$
         4 000461   000000 124505                    SCM     mask='000'O
         4 000462   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         4 000463   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000464   200046 000100                    ARG     NAME_LEN,,AUTO

      286    19827    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;

  19827  4 000465   200046 236100                    LDQ     NAME_LEN,,AUTO
         4 000466   000471 601000 4                  TNZ     s:19828
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:44   

  19827  4 000467   000001 235007                    LDA     1,DL
         4 000470   200046 755100                    STA     NAME_LEN,,AUTO

      287    19828    3         MATCH_LEN = STATION_NAME.COUNT;

  19828  4 000471   200050 236100                    LDQ     STATION_NAME,,AUTO
         4 000472   000033 772000                    QRL     27
         4 000473   200045 756100                    STQ     MATCH_LEN,,AUTO

      288    19829    3         CALL ASB$WILD_MATCH (NAME_LEN,KL$WSNCVT.WSN(TWSN_NUMBER),MATCH_LEN,
             19829                  STATION_NAME.TEXT) ALTRET (NEXT_STATION);

  19829  4 000474   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 000475   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 000476   000016 036000 5                  ADLQ    14
         4 000477   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 000500   200045 631500                    EPPR1   MATCH_LEN,,AUTO
         4 000501   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 000502   200057 236100                    LDQ     TWSN_NUMBER,,AUTO
         4 000503   000023 736000                    QLS     19
         4 000504   000002 036003                    ADLQ    2,DU
         4 000505   000000 036000 xsym               ADLQ    DSEG1$
         4 000506   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000507   200046 633500                    EPPR3   NAME_LEN,,AUTO
         4 000510   200060 453500                    STP3    TWSN_NUMBER+1,,AUTO
         4 000511   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000512   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000513   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 000514   000676 702000 4                  TSX2    NEXT_STATION

      289    19830    3         CALL ASB$GET_NEXT_STATION (TWSN_NUMBER) ALTRET (FINISH_UP);

  19830  4 000515   200057 630500                    EPPR0   TWSN_NUMBER,,AUTO
         4 000516   200060 450500                    STP0    TWSN_NUMBER+1,,AUTO
         4 000517   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000520   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:45   
         4 000521   000000 701000 xent               TSX1    ASB$GET_NEXT_STATION
         4 000522   002304 702000 4                  TSX2    FINISH_UP

      290    19831    4         DO I = 0 TO KL$TWSNREC.NDEV - 1;

  19831  4 000523   200042 450100                    STZ     I,,AUTO
         4 000524   000671 710000 4                  TRA     NO_REC_FOR_STATION1+1

      291    19832    5            IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;

  19832  4 000525   200042 236100                    LDQ     I,,AUTO
         4 000526   000013 402007                    MPY     11,DL
         4 000527   000000 470400 xsym               LDP0    DSEG2$
         4 000530   000006 236106                    LDQ     6,QL,PR0
         4 000531   000036 736000                    QLS     30
         4 000532   400000 376003                    ANQ     -131072,DU
         4 000533   400000 676003                    ERQ     -131072,DU
         4 000534   000670 600000 4                  TZE     NO_REC_FOR_STATION1

      292    19833    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  19833  4 000535   200042 236100                    LDQ     I,,AUTO
         4 000536   000013 402007                    MPY     11,DL
         4 000537   000006 236106                    LDQ     6,QL,PR0
         4 000540   000100 316007                    CANQ    64,DL
         4 000541   000547 600000 4                  TZE     s:19838

      293    19834    6                  NAME_LEN = 4;

  19834  4 000542   000004 235007                    LDA     4,DL
         4 000543   200046 755100                    STA     NAME_LEN,,AUTO

      294    19835    6                  USERS_KEY.COUNT = 8;

  19835  4 000544   010000 236003                    LDQ     4096,DU
         4 000545   000000 552040 xsym               STBQ    USERS_KEY,'40'O

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:46   
      295    19836    6                  END; /*  A tdev  */

  19836  4 000546   000557 710000 4                  TRA     s:19841

      296    19837    6               ELSE DO;          /* Not a tdev         */

      297    19838    6                  CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));

  19838  4 000547   200042 236100                    LDQ     I,,AUTO
         4 000550   000054 402007                    MPY     44,DL
         4 000551   000000 124506                    SCM     mask='000'O
         4 000552   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 000553   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000554   200046 000100                    ARG     NAME_LEN,,AUTO

      298    19839    6                  USERS_KEY.COUNT = 9;

  19839  4 000555   011000 236003                    LDQ     4608,DU
         4 000556   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      299    19840    6                  END; /*  Not a tdev  */

      300    19841    5               MATCH_LEN = DEV_NAME.COUNT;

  19841  4 000557   200016 236100                    LDQ     DEV_NAME,,AUTO
         4 000560   000033 772000                    QRL     27
         4 000561   200045 756100                    STQ     MATCH_LEN,,AUTO

      301    19842    5              CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME
             19842                        .TEXT)

  19842  4 000562   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 000563   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 000564   000017 036000 5                  ADLQ    15
         4 000565   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 000566   200045 631500                    EPPR1   MATCH_LEN,,AUTO
         4 000567   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:47   
         4 000570   200042 236100                    LDQ     I,,AUTO
         4 000571   000013 402003                    MPY     11,DU
         4 000572   000011 036003                    ADLQ    9,DU
         4 000573   000000 036000 xsym               ADLQ    DSEG2$
         4 000574   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000575   200046 633500                    EPPR3   NAME_LEN,,AUTO
         4 000576   200060 453500                    STP3    TWSN_NUMBER+1,,AUTO
         4 000577   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000600   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000601   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 000602   000670 702000 4                  TSX2    NO_REC_FOR_STATION1

      302    19843    6               WHENRETURN DO;

      303    19844    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  19844  4 000603   200042 236100                    LDQ     I,,AUTO
         4 000604   000054 402007                    MPY     44,DL
         4 000605   000000 470400 xsym               LDP0    DSEG2$
         4 000606   040000 100506                    MLR     fill='040'O
         4 000607   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 000610   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000611   000052 236003                    LDQ     42,DU
         4 000612   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      304    19845    6                  ARS = DSEG3SIZE;

  19845  4 000613   000000 235000 xsym               LDA     DSEG3SIZE
         4 000614   200006 755100                    STA     ARS,,AUTO

      305    19846    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION1);

  19846  4 000615   000005 236000 5                  LDQ     5
         4 000616   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000617   200006 630500                    EPPR0   ARS,,AUTO
         4 000620   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000621   000006 236000 5                  LDQ     6
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:48   
         4 000622   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 000623   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000624   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000625   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000626   000670 702000 4                  TSX2    NO_REC_FOR_STATION1

      306    19847    7                  IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  19847  4 000627   000000 470400 xsym               LDP0    DSEG3$
         4 000630   000000 236100                    LDQ     0,,PR0
         4 000631   000777 376007                    ANQ     511,DL
         4 000632   200031 116100                    CMPQ    DEV_TYPE,,AUTO
         4 000633   000670 601000 4                  TNZ     NO_REC_FOR_STATION1

      307    19848    7                     IF ~ DISP THEN

  19848  4 000634   200032 236100                    LDQ     DISP,,AUTO
         4 000635   400000 376003                    ANQ     -131072,DU
         4 000636   400000 676003                    ERQ     -131072,DU
         4 000637   000651 600000 4                  TZE     s:19851

      308    19849    7                        CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);

  19849  4 000640   200033 631500                    EPPR1   DISP_CONSOLES,,AUTO
         4 000641   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 000642   000012 236000 5                  LDQ     10
         4 000643   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 000644   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000645   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000646   000000 701000 xent               TSX1    ASL$FORMAT_CONNAME
         4 000647   000000 011000                    NOP     0
         4 000650   000665 710000 4                  TRA     s:19854

      309    19850    8                     ELSE DO;

      310    19851    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:49   
  19851  4 000651   000007 236000 5                  LDQ     7
         4 000652   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000653   200043 631500                    EPPR1   JCL,,AUTO
         4 000654   200060 451500                    STP1    TWSN_NUMBER+1,,AUTO
         4 000655   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000656   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000657   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 000660   000000 011000                    NOP     0

      311    19852    8                        CALL ASB$WRITE_LO (' ',1);

  19852  4 000661   000010 630400 5                  EPPR0   8
         4 000662   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000663   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000664   000000 011000                    NOP     0

      312    19853    8                        END; /*  Disp  */

      313    19854    7                     DISP_CONSOLES = DISP_CONSOLES + 1;

  19854  4 000665   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 000666   000001 035007                    ADLA    1,DL
         4 000667   200033 755100                    STA     DISP_CONSOLES,,AUTO

      314    19855    7                     END; /*  The right type  */

      315    19856    6                  END; /*  Whenreturn  */

      316    19857    5               END; /*  Not iom connected  */

      317    19858    4   NO_REC_FOR_STATION1:
      318    19859    4            END; /*  Do ndevs times  */

  19859  4 000670   200042 054100       NO_REC_FOR_* AOS     I,,AUTO
         4 000671   000000 470400 xsym               LDP0    DSEG2$
         4 000672   200042 236100                    LDQ     I,,AUTO
         4 000673   000525 604000 4                  TMI     s:19832
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:50   
         4 000674   000004 116100                    CMPQ    4,,PR0
         4 000675   000525 602000 4                  TNC     s:19832

      319    19860    3   NEXT_STATION:
      320    19861    3         END; /*  Do ltwsn  */

  19861  4 000676   200057 235100       NEXT_STATION LDA     TWSN_NUMBER,,AUTO
         4 000677   000001 035007                    ADLA    1,DL
         4 000700   200057 755100                    STA     TWSN_NUMBER,,AUTO
         4 000701   000000 470400 xsym               LDP0    DSEG1$
         4 000702   000001 236100                    LDQ     1,,PR0
         4 000703   200057 116100                    CMPQ    TWSN_NUMBER,,AUTO
         4 000704   000456 603000 4                  TRC     s:19826

      321    19862    2      GOTO FINISH_UP;

  19862  4 000705   002304 710000 4                  TRA     FINISH_UP

      322    19863
      323    19864    2      SELECT (%STATION);

      324    19865
      325    19866    2      USERS_KEY.COUNT = 15;

  19866  4 000706   017000 236003                    LDQ     7680,DU
         4 000707   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      326    19867    2      CALL CONCAT( USERS_KEY.TXTC, STATION_NAME.TEXT, 'STATION' );

  19867  4 000710   040000 100500                    MLR     fill='040'O
         4 000711   200050 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 000712   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000713   040000 100400                    MLR     fill='040'O
         4 000714   000012 000007 3                  ADSC9   LIST_STR+3               cn=0,n=7
         4 000715   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      327    19868    2      ARS = DSEG1SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:51   

  19868  4 000716   000000 235000 xsym               LDA     DSEG1SIZE
         4 000717   200006 755100                    STA     ARS,,AUTO

      328    19869    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ALT3 );

  19869  4 000720   000011 236000 5                  LDQ     9
         4 000721   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000722   200006 630500                    EPPR0   ARS,,AUTO
         4 000723   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000724   000020 236000 5                  LDQ     16
         4 000725   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 000726   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000727   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000730   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000731   002262 702000 4                  TSX2    READ_ALT3

      329    19870    2      USERS_KEY.COUNT = 8;

  19870  4 000732   010000 236003                    LDQ     4096,DU
         4 000733   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      330    19871    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );

  19871  4 000734   040000 100400                    MLR     fill='040'O
         4 000735   000014 000004 3                  ADSC9   LIST_STR+5               cn=0,n=4
         4 000736   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000737   000000 470400 xsym               LDP0    DSEG1$
         4 000740   040000 100500                    MLR     fill='040'O
         4 000741   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         4 000742   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      331    19872    2      ARS = DSEG2SIZE;

  19872  4 000743   000000 235000 xsym               LDA     DSEG2SIZE
         4 000744   200006 755100                    STA     ARS,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:52   
      332    19873    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );

  19873  4 000745   000021 236000 5                  LDQ     17
         4 000746   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000747   200006 630500                    EPPR0   ARS,,AUTO
         4 000750   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000751   000022 236000 5                  LDQ     18
         4 000752   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 000753   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 000754   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000755   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000756   002300 702000 4                  TSX2    READ_ERR

      333    19874    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;

  19874  4 000757   200042 450100                    STZ     I,,AUTO
         4 000760   001125 710000 4                  TRA     NO_REC_FOR_STATION2+1

      334    19875    4         IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;

  19875  4 000761   200042 236100                    LDQ     I,,AUTO
         4 000762   000013 402007                    MPY     11,DL
         4 000763   000000 470400 xsym               LDP0    DSEG2$
         4 000764   000006 236106                    LDQ     6,QL,PR0
         4 000765   000036 736000                    QLS     30
         4 000766   400000 376003                    ANQ     -131072,DU
         4 000767   400000 676003                    ERQ     -131072,DU
         4 000770   001124 600000 4                  TZE     NO_REC_FOR_STATION2

      335    19876    5            IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  19876  4 000771   200042 236100                    LDQ     I,,AUTO
         4 000772   000013 402007                    MPY     11,DL
         4 000773   000006 236106                    LDQ     6,QL,PR0
         4 000774   000100 316007                    CANQ    64,DL
         4 000775   001003 600000 4                  TZE     s:19881

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:53   
      336    19877    5               NAME_LEN = 4;

  19877  4 000776   000004 235007                    LDA     4,DL
         4 000777   200046 755100                    STA     NAME_LEN,,AUTO

      337    19878    5               USERS_KEY.COUNT = 8;

  19878  4 001000   010000 236003                    LDQ     4096,DU
         4 001001   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      338    19879    5               END; /*  A tdev  */

  19879  4 001002   001013 710000 4                  TRA     s:19884

      339    19880    5            ELSE DO;          /* Not a tdev         */

      340    19881    5               CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));

  19881  4 001003   200042 236100                    LDQ     I,,AUTO
         4 001004   000054 402007                    MPY     44,DL
         4 001005   000000 124506                    SCM     mask='000'O
         4 001006   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001007   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001010   200046 000100                    ARG     NAME_LEN,,AUTO

      341    19882    5               USERS_KEY.COUNT = 9;

  19882  4 001011   011000 236003                    LDQ     4608,DU
         4 001012   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      342    19883    5               END; /*  Not a tdev  */

      343    19884    4            MATCH_LEN = DEV_NAME.COUNT;

  19884  4 001013   200016 236100                    LDQ     DEV_NAME,,AUTO
         4 001014   000033 772000                    QRL     27
         4 001015   200045 756100                    STQ     MATCH_LEN,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:54   

      344    19885    4            CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             19885                     TEXT)

  19885  4 001016   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 001017   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 001020   000017 036000 5                  ADLQ    15
         4 001021   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001022   200045 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001023   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001024   200042 236100                    LDQ     I,,AUTO
         4 001025   000013 402003                    MPY     11,DU
         4 001026   000011 036003                    ADLQ    9,DU
         4 001027   000000 036000 xsym               ADLQ    DSEG2$
         4 001030   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001031   200046 633500                    EPPR3   NAME_LEN,,AUTO
         4 001032   200060 453500                    STP3    TWSN_NUMBER+1,,AUTO
         4 001033   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001034   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001035   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001036   001124 702000 4                  TSX2    NO_REC_FOR_STATION2

      345    19886    5            WHENRETURN DO;

      346    19887    5               CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  19887  4 001037   200042 236100                    LDQ     I,,AUTO
         4 001040   000054 402007                    MPY     44,DL
         4 001041   000000 470400 xsym               LDP0    DSEG2$
         4 001042   040000 100506                    MLR     fill='040'O
         4 001043   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001044   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001045   000052 236003                    LDQ     42,DU
         4 001046   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      347    19888    5               ARS = DSEG3SIZE;

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:55   
  19888  4 001047   000000 235000 xsym               LDA     DSEG3SIZE
         4 001050   200006 755100                    STA     ARS,,AUTO

      348    19889    5               CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION2);

  19889  4 001051   000005 236000 5                  LDQ     5
         4 001052   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001053   200006 630500                    EPPR0   ARS,,AUTO
         4 001054   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001055   000006 236000 5                  LDQ     6
         4 001056   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001057   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001060   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001061   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001062   001124 702000 4                  TSX2    NO_REC_FOR_STATION2

      349    19890    6               IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  19890  4 001063   000000 470400 xsym               LDP0    DSEG3$
         4 001064   000000 236100                    LDQ     0,,PR0
         4 001065   000777 376007                    ANQ     511,DL
         4 001066   200031 116100                    CMPQ    DEV_TYPE,,AUTO
         4 001067   001124 601000 4                  TNZ     NO_REC_FOR_STATION2

      350    19891    7                  IF ~ DISP THEN DO;

  19891  4 001070   200032 236100                    LDQ     DISP,,AUTO
         4 001071   400000 376003                    ANQ     -131072,DU
         4 001072   400000 676003                    ERQ     -131072,DU
         4 001073   001105 600000 4                  TZE     s:19895

      351    19892    7                     CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);

  19892  4 001074   200033 631500                    EPPR1   DISP_CONSOLES,,AUTO
         4 001075   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 001076   000012 236000 5                  LDQ     10
         4 001077   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:56   
         4 001100   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001102   000000 701000 xent               TSX1    ASL$FORMAT_CONNAME
         4 001103   000000 011000                    NOP     0

      352    19893    7                     END; /*  ~disp  */

  19893  4 001104   001121 710000 4                  TRA     s:19898

      353    19894    7                  ELSE DO;

      354    19895    7                     CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  19895  4 001105   000007 236000 5                  LDQ     7
         4 001106   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001107   200043 631500                    EPPR1   JCL,,AUTO
         4 001110   200060 451500                    STP1    TWSN_NUMBER+1,,AUTO
         4 001111   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001112   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001113   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 001114   000000 011000                    NOP     0

      355    19896    7                     CALL ASB$WRITE_LO (' ',1);

  19896  4 001115   000010 630400 5                  EPPR0   8
         4 001116   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001117   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 001120   000000 011000                    NOP     0

      356    19897    7                     END; /*  Disp  */

      357    19898    6                  DISP_CONSOLES = DISP_CONSOLES + 1;

  19898  4 001121   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 001122   000001 035007                    ADLA    1,DL
         4 001123   200033 755100                    STA     DISP_CONSOLES,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:57   
      358    19899    6                  END; /*  The right type  */

      359    19900    5               END; /*  Whenreturn  */

      360    19901    4            END; /*  Not iom connected  */

      361    19902    3   NO_REC_FOR_STATION2:
      362    19903    3         END; /*  Do ndevs times  */

  19903  4 001124   200042 054100       NO_REC_FOR_* AOS     I,,AUTO
         4 001125   000000 470400 xsym               LDP0    DSEG2$
         4 001126   200042 236100                    LDQ     I,,AUTO
         4 001127   000761 604000 4                  TMI     s:19875
         4 001130   000004 116100                    CMPQ    4,,PR0
         4 001131   000761 602000 4                  TNC     s:19875

      363    19904    2      GOTO FINISH_UP;

  19904  4 001132   002304 710000 4                  TRA     FINISH_UP

      364    19905
      365    19906    2      SELECT (%TERMINAL_WILD);

      366    19907
      367    19908    2      USERS_KEY.COUNT = 4;

  19908  4 001133   004000 236003                    LDQ     2048,DU
         4 001134   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      368    19909    2      USERS_KEY.TXTC = 'TERM';

  19909  4 001135   040000 100400                    MLR     fill='040'O
         4 001136   000015 000004 3                  ADSC9   LIST_STR+6               cn=0,n=4
         4 001137   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      369    19910    2      ARS = DSEG1SIZE;

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:58   
  19910  4 001140   000000 235000 xsym               LDA     DSEG1SIZE
         4 001141   200006 755100                    STA     ARS,,AUTO

      370    19911    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );

  19911  4 001142   000011 236000 5                  LDQ     9
         4 001143   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001144   200006 630500                    EPPR0   ARS,,AUTO
         4 001145   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001146   000020 236000 5                  LDQ     16
         4 001147   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001150   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001151   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001152   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001153   002300 702000 4                  TSX2    READ_ERR

      371    19912    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;

  19912  4 001154   200057 450100                    STZ     TWSN_NUMBER,,AUTO
         4 001155   001447 710000 4                  TRA     s:19978+3

      372    19913    4         IF KL$WSNCVT.WSN(TWSN_NUMBER) ~= ' ' THEN DO;

  19913  4 001156   200057 235100                    LDA     TWSN_NUMBER,,AUTO
         4 001157   000003 735000                    ALS     3
         4 001160   000000 470400 xsym               LDP0    DSEG1$
         4 001161   040000 106505                    CMPC    fill='040'O
         4 001162   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         4 001163   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001164   001444 600000 4                  TZE     s:19978

      373    19914    4            USERS_KEY.COUNT = 8;

  19914  4 001165   010000 236003                    LDQ     4096,DU
         4 001166   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      374    19915    4            CALL BINCHAR (TWSN_CHAR, TWSN_NUMBER);
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:59   

  19915  4 001167   200057 235100                    LDA     TWSN_NUMBER,,AUTO
         4 001170   000044 773000                    LRL     36
         4 001171   200060 757100                    STAQ    TWSN_NUMBER+1,,AUTO
         4 001172   000100 301500                    BTD
         4 001173   200060 000010                    NDSC9   TWSN_NUMBER+1,,AUTO      cn=0,s=lsgnf,sf=0,n=8
         4 001174   200056 030004                    NDSC9   TWSN_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=4

      375    19916    4            CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSN_CHAR );

  19916  4 001175   040000 100400                    MLR     fill='040'O
         4 001176   000014 000004 3                  ADSC9   LIST_STR+5               cn=0,n=4
         4 001177   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 001200   040000 100500                    MLR     fill='040'O
         4 001201   200056 000004                    ADSC9   TWSN_CHAR,,AUTO          cn=0,n=4
         4 001202   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      376    19917    4            ARS = DSEG2SIZE;

  19917  4 001203   000000 235000 xsym               LDA     DSEG2SIZE
         4 001204   200006 755100                    STA     ARS,,AUTO

      377    19918    4            CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );

  19918  4 001205   000021 236000 5                  LDQ     17
         4 001206   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001207   200006 630500                    EPPR0   ARS,,AUTO
         4 001210   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001211   000022 236000 5                  LDQ     18
         4 001212   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001213   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001214   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001215   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001216   002300 702000 4                  TSX2    READ_ERR

      378    19919    5            DO I = 0 TO KL$TWSNREC.NDEV - 1;

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:60   
  19919  4 001217   200042 450100                    STZ     I,,AUTO
         4 001220   001416 710000 4                  TRA     s:19972+1

      379    19920    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  19920  4 001221   200042 236100                    LDQ     I,,AUTO
         4 001222   000013 402007                    MPY     11,DL
         4 001223   000000 470400 xsym               LDP0    DSEG2$
         4 001224   000006 236106                    LDQ     6,QL,PR0
         4 001225   000100 316007                    CANQ    64,DL
         4 001226   001415 600000 4                  TZE     s:19972

      380    19921    6                  MATCH_LEN = DEV_NAME.COUNT;

  19921  4 001227   200016 236100                    LDQ     DEV_NAME,,AUTO
         4 001230   000033 772000                    QRL     27
         4 001231   200045 756100                    STQ     MATCH_LEN,,AUTO

      381    19922    6                  CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             19922                           TEXT)

  19922  4 001232   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 001233   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 001234   000017 036000 5                  ADLQ    15
         4 001235   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001236   200045 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001237   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001240   200042 236100                    LDQ     I,,AUTO
         4 001241   000013 402003                    MPY     11,DU
         4 001242   000011 036003                    ADLQ    9,DU
         4 001243   000000 036000 xsym               ADLQ    DSEG2$
         4 001244   000023 235000 5                  LDA     19
         4 001245   200060 757100                    STAQ    TWSN_NUMBER+1,,AUTO
         4 001246   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001247   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001250   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001251   001415 702000 4                  TSX2    s:19972
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:61   

      382    19923    7                  WHENRETURN DO;

      383    19924    7                     CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));

  19924  4 001252   200042 236100                    LDQ     I,,AUTO
         4 001253   000054 402007                    MPY     44,DL
         4 001254   000000 470400 xsym               LDP0    DSEG2$
         4 001255   000000 124506                    SCM     mask='000'O
         4 001256   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001257   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001260   200046 000100                    ARG     NAME_LEN,,AUTO

      384    19925    7                     MATCH_LEN = TERMINAL_NAME.COUNT;

  19925  4 001261   200053 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 001262   000033 772000                    QRL     27
         4 001263   200045 756100                    STQ     MATCH_LEN,,AUTO

      385    19926    7                     CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             19926                              TERMINAL_NAME.TEXT)

  19926  4 001264   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 001265   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 001266   000024 036000 5                  ADLQ    20
         4 001267   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001270   200045 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001271   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001272   200042 236100                    LDQ     I,,AUTO
         4 001273   000013 402003                    MPY     11,DU
         4 001274   000013 036003                    ADLQ    11,DU
         4 001275   000000 036000 xsym               ADLQ    DSEG2$
         4 001276   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001277   200046 633500                    EPPR3   NAME_LEN,,AUTO
         4 001300   200060 453500                    STP3    TWSN_NUMBER+1,,AUTO
         4 001301   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001302   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:62   
         4 001303   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001304   001415 702000 4                  TSX2    s:19972

      386    19927    8                     WHENRETURN DO;

      387    19928    8                        USERS_KEY.COUNT = 8;

  19928  4 001305   010000 236003                    LDQ     4096,DU
         4 001306   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      388    19929    8                        CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  19929  4 001307   200042 236100                    LDQ     I,,AUTO
         4 001310   000054 402007                    MPY     44,DL
         4 001311   000000 470400 xsym               LDP0    DSEG2$
         4 001312   040000 100506                    MLR     fill='040'O
         4 001313   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001314   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001315   000052 236003                    LDQ     42,DU
         4 001316   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      389    19930    8                        ARS = DSEG3SIZE;

  19930  4 001317   000000 235000 xsym               LDA     DSEG3SIZE
         4 001320   200006 755100                    STA     ARS,,AUTO

      390    19931    8                        CALL ASB$READ_HLP(DSEG3$, ARS, 3)

  19931  4 001321   000005 236000 5                  LDQ     5
         4 001322   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001323   200006 630500                    EPPR0   ARS,,AUTO
         4 001324   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001325   000006 236000 5                  LDQ     6
         4 001326   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001327   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001330   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001331   000000 701000 xent               TSX1    ASB$READ_HLP
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:63   
         4 001332   001375 702000 4                  TSX2    s:19949

      391    19932    9                        WHENRETURN DO;

      392    19933   10                           IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  19933  4 001333   000000 470400 xsym               LDP0    DSEG3$
         4 001334   000000 236100                    LDQ     0,,PR0
         4 001335   000777 376007                    ANQ     511,DL
         4 001336   200031 116100                    CMPQ    DEV_TYPE,,AUTO
         4 001337   001374 601000 4                  TNZ     s:19943

      393    19934   11                              IF ~ DISP THEN DO;

  19934  4 001340   200032 236100                    LDQ     DISP,,AUTO
         4 001341   400000 376003                    ANQ     -131072,DU
         4 001342   400000 676003                    ERQ     -131072,DU
         4 001343   001355 600000 4                  TZE     s:19938

      394    19935   11                                 CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);

  19935  4 001344   200033 631500                    EPPR1   DISP_CONSOLES,,AUTO
         4 001345   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 001346   000012 236000 5                  LDQ     10
         4 001347   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001350   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001351   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001352   000000 701000 xent               TSX1    ASL$FORMAT_CONNAME
         4 001353   000000 011000                    NOP     0

      395    19936   11                                 END; /*  ~disp  */

  19936  4 001354   001371 710000 4                  TRA     s:19941

      396    19937   11                              ELSE DO;

      397    19938   11                                 CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:64   

  19938  4 001355   000007 236000 5                  LDQ     7
         4 001356   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001357   200043 631500                    EPPR1   JCL,,AUTO
         4 001360   200060 451500                    STP1    TWSN_NUMBER+1,,AUTO
         4 001361   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001362   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001363   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 001364   000000 011000                    NOP     0

      398    19939   11                                 CALL ASB$WRITE_LO (' ',1);

  19939  4 001365   000010 630400 5                  EPPR0   8
         4 001366   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001367   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 001370   000000 011000                    NOP     0

      399    19940   11                                 END; /*  Disp  */

      400    19941   10                              DISP_CONSOLES = DISP_CONSOLES + 1;

  19941  4 001371   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 001372   000001 035007                    ADLA    1,DL
         4 001373   200033 755100                    STA     DISP_CONSOLES,,AUTO

      401    19942   10                              END; /*  The right type  */

      402    19943    9                           END; /*  Whenreturn from READ_HLP of device record  */

  19943  4 001374   001415 710000 4                  TRA     s:19972

      403    19944    9                        WHENALTRETURN DO;

      404    19945        /*E* ERROR: ASL-E$NOCONFORTERM-C
      405    19946             MESSAGE:  Console %U1 does not exist.
      406    19947             MESSAGE1:  It is listed in TWSN %U2 but can't be read from :HLP.
      407    19948        */
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:65   
      408    19949    9                           AS_FIELD1.TEXT = KL$TWSNREC.DEVS.ACCT(I);

  19949  4 001375   200042 236100                    LDQ     I,,AUTO
         4 001376   000054 402007                    MPY     44,DL
         4 001377   000000 470400 xsym               LDP0    DSEG2$
         4 001400   040000 100506                    MLR     fill='040'O
         4 001401   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001402   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      409    19950    9                           AS_FIELD1.COUNT = 4;

  19950  4 001403   004000 236003                    LDQ     2048,DU
         4 001404   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      410    19951    9                           AS_FIELD2.TEXT = TWSN_CHAR;

  19951  4 001405   040000 100500                    MLR     fill='040'O
         4 001406   200056 000004                    ADSC9   TWSN_CHAR,,AUTO          cn=0,n=4
         4 001407   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      411    19952    9                           AS_FIELD2.COUNT = 4;

  19952  4 001410   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      412    19953                                %SCREAM (ERR#=%E$NOCONFORTERM,LEVEL=ERROR,MID='L');

  19965  4 001411   000025 630400 5                  EPPR0   21
         4 001412   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001413   000000 701000 xent               TSX1    ASH$ERROR
         4 001414   000000 011000                    NOP     0

      413    19968    9                           END; /*  Whenaltreturn from READ_HLP  */

      414    19969    8                        END; /*  Whenreturn from WILD_MATCH of terminal name */

      415    19970    7                     END; /*  Whenreturn  from WILD_MATCH of device name  */

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:66   
      416    19971    6                  END; /*  A tdev  */

      417    19972    5               END; /*  Do ndevs times  */

  19972  4 001415   200042 054100                    AOS     I,,AUTO
         4 001416   000000 470400 xsym               LDP0    DSEG2$
         4 001417   200042 236100                    LDQ     I,,AUTO
         4 001420   001221 604000 4                  TMI     s:19920
         4 001421   000004 116100                    CMPQ    4,,PR0
         4 001422   001221 602000 4                  TNC     s:19920

      418    19973    4            USERS_KEY.COUNT = 4;

  19973  4 001423   004000 236003                    LDQ     2048,DU
         4 001424   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      419    19974    4            USERS_KEY.TXTC = 'TERM';

  19974  4 001425   040000 100400                    MLR     fill='040'O
         4 001426   000015 000004 3                  ADSC9   LIST_STR+6               cn=0,n=4
         4 001427   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      420    19975    4            ARS = DSEG1SIZE;

  19975  4 001430   000000 235000 xsym               LDA     DSEG1SIZE
         4 001431   200006 755100                    STA     ARS,,AUTO

      421    19976    4            CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );

  19976  4 001432   000011 236000 5                  LDQ     9
         4 001433   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001434   200006 631500                    EPPR1   ARS,,AUTO
         4 001435   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 001436   000020 236000 5                  LDQ     16
         4 001437   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001440   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001441   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:67   
         4 001442   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001443   002300 702000 4                  TSX2    READ_ERR

      422    19977    4            END; /*  If station name not blank  */

      423    19978    3         END; /*  Do 0 to KL$WSNCVT.LTWSN  */

  19978  4 001444   200057 235100                    LDA     TWSN_NUMBER,,AUTO
         4 001445   000001 035007                    ADLA    1,DL
         4 001446   200057 755100                    STA     TWSN_NUMBER,,AUTO
         4 001447   000000 470400 xsym               LDP0    DSEG1$
         4 001450   000001 236100                    LDQ     1,,PR0
         4 001451   200057 116100                    CMPQ    TWSN_NUMBER,,AUTO
         4 001452   001156 603000 4                  TRC     s:19913
         4 001453   002240 710000 4                  TRA     s:20082

      424    19979
      425    19980    2      SELECT (%TERMINAL);

      426    19981
      427    19982    2      USERS_KEY.COUNT = 9;

  19982  4 001454   011000 236003                    LDQ     4608,DU
         4 001455   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      428    19983    2      CALL CONCAT( USERS_KEY.TXTC, TERMINAL_NAME.TEXT, '*' );

  19983  4 001456   040000 100500                    MLR     fill='040'O
         4 001457   200053 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 001460   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001461   040000 100400                    MLR     fill='040'O
         4 001462   000026 000001 5                  ADSC9   22                       cn=0,n=1
         4 001463   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      429    19984    2      ARS = DSEG1SIZE;

  19984  4 001464   000000 235000 xsym               LDA     DSEG1SIZE
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:68   
         4 001465   200006 755100                    STA     ARS,,AUTO

      430    19985    2      CALL ASB$READ_HLP( DSEG1$, ARS, 1) ALTRET( READ_ERR );

  19985  4 001466   000011 236000 5                  LDQ     9
         4 001467   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001470   200006 630500                    EPPR0   ARS,,AUTO
         4 001471   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001472   000020 236000 5                  LDQ     16
         4 001473   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001474   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001475   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001476   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001477   002300 702000 4                  TSX2    READ_ERR

      431    19986    2      AS_FIELD1.COUNT = TERMINAL_NAME.COUNT;

  19986  4 001500   200053 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 001501   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      432    19987    2      AS_FIELD1.TEXT = TERMINAL_NAME.TEXT;

  19987  4 001502   040000 100500                    MLR     fill='040'O
         4 001503   200053 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 001504   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      433    19988    2      AS_FIELD2.COUNT = 8;

  19988  4 001505   010000 236003                    LDQ     4096,DU
         4 001506   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      434    19989    2      AS_FIELD2.TEXT = 'TERMINAL';

  19989  4 001507   040000 100400                    MLR     fill='040'O
         4 001510   000017 000010 3                  ADSC9   LIST_STR+8               cn=0,n=8
         4 001511   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:69   
      435    19990    2      CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_TERM#, %NO#, TERMINAL_NAME ) ALTRET(
             19990               FINISH_UP);

  19990  4 001512   200053 630500                    EPPR0   TERMINAL_NAME,,AUTO
         4 001513   200064 450500                    STP0    TWSN_NUMBER+5,,AUTO
         4 001514   000030 237000 5                  LDAQ    24
         4 001515   200062 757100                    STAQ    TWSN_NUMBER+3,,AUTO
         4 001516   200006 631500                    EPPR1   ARS,,AUTO
         4 001517   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 001520   000020 236000 5                  LDQ     16
         4 001521   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001522   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001523   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 001524   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 001525   002304 702000 4                  TSX2    FINISH_UP

      436    19991    2      USERS_KEY.COUNT = 8;

  19991  4 001526   010000 236003                    LDQ     4096,DU
         4 001527   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      437    19992    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );

  19992  4 001530   040000 100400                    MLR     fill='040'O
         4 001531   000014 000004 3                  ADSC9   LIST_STR+5               cn=0,n=4
         4 001532   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 001533   000000 470400 xsym               LDP0    DSEG1$
         4 001534   040000 100500                    MLR     fill='040'O
         4 001535   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         4 001536   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      438    19993    2      ARS = DSEG2SIZE;

  19993  4 001537   000000 235000 xsym               LDA     DSEG2SIZE
         4 001540   200006 755100                    STA     ARS,,AUTO

      439    19994    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:70   

  19994  4 001541   000021 236000 5                  LDQ     17
         4 001542   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001543   200006 630500                    EPPR0   ARS,,AUTO
         4 001544   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001545   000022 236000 5                  LDQ     18
         4 001546   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001547   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001550   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001551   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001552   002300 702000 4                  TSX2    READ_ERR

      440    19995    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;

  19995  4 001553   200042 450100                    STZ     I,,AUTO
         4 001554   001731 710000 4                  TRA     NO_REC_FOR_TERM2+1

      441    19996    3         USERS_KEY.COUNT = 8;

  19996  4 001555   010000 236003                    LDQ     4096,DU
         4 001556   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      442    19997    4         IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  19997  4 001557   200042 236100                    LDQ     I,,AUTO
         4 001560   000013 402007                    MPY     11,DL
         4 001561   000000 470400 xsym               LDP0    DSEG2$
         4 001562   000006 236106                    LDQ     6,QL,PR0
         4 001563   000100 316007                    CANQ    64,DL
         4 001564   001730 600000 4                  TZE     NO_REC_FOR_TERM2

      443    19998    4            MATCH_LEN = DEV_NAME.COUNT;

  19998  4 001565   200016 236100                    LDQ     DEV_NAME,,AUTO
         4 001566   000033 772000                    QRL     27
         4 001567   200045 756100                    STQ     MATCH_LEN,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:71   
      444    19999    4            CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.TEXT)

  19999  4 001570   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 001571   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 001572   000017 036000 5                  ADLQ    15
         4 001573   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001574   200045 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001575   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001576   200042 236100                    LDQ     I,,AUTO
         4 001577   000013 402003                    MPY     11,DU
         4 001600   000011 036003                    ADLQ    9,DU
         4 001601   000000 036000 xsym               ADLQ    DSEG2$
         4 001602   000023 235000 5                  LDA     19
         4 001603   200060 757100                    STAQ    TWSN_NUMBER+1,,AUTO
         4 001604   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001605   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001606   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001607   001730 702000 4                  TSX2    NO_REC_FOR_TERM2

      445    20000    5            WHENRETURN DO;

      446    20001    5               CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));

  20001  4 001610   200042 236100                    LDQ     I,,AUTO
         4 001611   000054 402007                    MPY     44,DL
         4 001612   000000 470400 xsym               LDP0    DSEG2$
         4 001613   000000 124506                    SCM     mask='000'O
         4 001614   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001615   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001616   200046 000100                    ARG     NAME_LEN,,AUTO

      447    20002    5               MATCH_LEN = TERMINAL_NAME.COUNT;

  20002  4 001617   200053 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 001620   000033 772000                    QRL     27
         4 001621   200045 756100                    STQ     MATCH_LEN,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:72   
      448    20003    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             20003                        TERMINAL_NAME.TEXT)

  20003  4 001622   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 001623   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 001624   000024 036000 5                  ADLQ    20
         4 001625   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001626   200045 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001627   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001630   200042 236100                    LDQ     I,,AUTO
         4 001631   000013 402003                    MPY     11,DU
         4 001632   000013 036003                    ADLQ    11,DU
         4 001633   000000 036000 xsym               ADLQ    DSEG2$
         4 001634   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001635   200046 633500                    EPPR3   NAME_LEN,,AUTO
         4 001636   200060 453500                    STP3    TWSN_NUMBER+1,,AUTO
         4 001637   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001640   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001641   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001642   001730 702000 4                  TSX2    NO_REC_FOR_TERM2

      449    20004    6               WHENRETURN DO;

      450    20005    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  20005  4 001643   200042 236100                    LDQ     I,,AUTO
         4 001644   000054 402007                    MPY     44,DL
         4 001645   000000 470400 xsym               LDP0    DSEG2$
         4 001646   040000 100506                    MLR     fill='040'O
         4 001647   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001650   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001651   000052 236003                    LDQ     42,DU
         4 001652   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      451    20006    6                  ARS = DSEG3SIZE;

  20006  4 001653   000000 235000 xsym               LDA     DSEG3SIZE
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:73   
         4 001654   200006 755100                    STA     ARS,,AUTO

      452    20007    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_TERM2);

  20007  4 001655   000005 236000 5                  LDQ     5
         4 001656   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001657   200006 630500                    EPPR0   ARS,,AUTO
         4 001660   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001661   000006 236000 5                  LDQ     6
         4 001662   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001663   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001664   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001665   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001666   001730 702000 4                  TSX2    NO_REC_FOR_TERM2

      453    20008    7                  IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  20008  4 001667   000000 470400 xsym               LDP0    DSEG3$
         4 001670   000000 236100                    LDQ     0,,PR0
         4 001671   000777 376007                    ANQ     511,DL
         4 001672   200031 116100                    CMPQ    DEV_TYPE,,AUTO
         4 001673   001730 601000 4                  TNZ     NO_REC_FOR_TERM2

      454    20009    8                     IF ~ DISP THEN DO;

  20009  4 001674   200032 236100                    LDQ     DISP,,AUTO
         4 001675   400000 376003                    ANQ     -131072,DU
         4 001676   400000 676003                    ERQ     -131072,DU
         4 001677   001711 600000 4                  TZE     s:20013

      455    20010    8                        CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);

  20010  4 001700   200033 631500                    EPPR1   DISP_CONSOLES,,AUTO
         4 001701   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 001702   000012 236000 5                  LDQ     10
         4 001703   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 001704   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:74   
         4 001705   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001706   000000 701000 xent               TSX1    ASL$FORMAT_CONNAME
         4 001707   000000 011000                    NOP     0

      456    20011    8                        END; /*  ~disp  */

  20011  4 001710   001725 710000 4                  TRA     s:20016

      457    20012    8                     ELSE DO;

      458    20013    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20013  4 001711   000007 236000 5                  LDQ     7
         4 001712   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001713   200043 631500                    EPPR1   JCL,,AUTO
         4 001714   200060 451500                    STP1    TWSN_NUMBER+1,,AUTO
         4 001715   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 001716   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001717   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 001720   000000 011000                    NOP     0

      459    20014    8                        CALL ASB$WRITE_LO (' ',1);

  20014  4 001721   000010 630400 5                  EPPR0   8
         4 001722   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001723   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 001724   000000 011000                    NOP     0

      460    20015    8                        END; /*  Disp  */

      461    20016    7                     DISP_CONSOLES = DISP_CONSOLES + 1;

  20016  4 001725   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 001726   000001 035007                    ADLA    1,DL
         4 001727   200033 755100                    STA     DISP_CONSOLES,,AUTO

      462    20017    7                     END; /*  The right type  */
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:75   

      463    20018    6                  END; /*  Whenreturn  */

      464    20019    5               END; /*  Whenreturn  */

      465    20020    4            END; /*  A tdev  */

      466    20021    3   NO_REC_FOR_TERM2:
      467    20022    3         END; /*  Do ndevs times  */

  20022  4 001730   200042 054100       NO_REC_FOR_* AOS     I,,AUTO
         4 001731   000000 470400 xsym               LDP0    DSEG2$
         4 001732   200042 236100                    LDQ     I,,AUTO
         4 001733   001555 604000 4                  TMI     s:19996
         4 001734   000004 116100                    CMPQ    4,,PR0
         4 001735   001555 602000 4                  TNC     s:19996
         4 001736   002240 710000 4                  TRA     s:20082

      468    20023
      469    20024    2      SELECT (%CONSOLE_WILD);

      470    20025
      471    20026                 /*  Setup begin key  */
      472    20027                 /*  Setup end key  */
      473    20028    2      CALL INDEX (I,'?',DEV_NAME.TEXT);

  20028  4 001737   000000 124500                    SCM     mask='000'O
         4 001740   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 001741   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 001742   200042 000100                    ARG     I,,AUTO

      474    20029    2      BEGIN_KEY.TEXT = SUBSTR (DEV_NAME.TEXT,0,I);

  20029  4 001743   200042 720100                    LXL0    I,,AUTO
         4 001744   040100 100540                    MLR     fill='040'O
         4 001745   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X0
         4 001746   200007 200024                    ADSC9   BEGIN_KEY,,AUTO          cn=1,n=20
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:76   

      475    20030    2      CALL CONCAT (END_KEY.TEXT,SUBSTR (DEV_NAME.TEXT,0,I),'~');

  20030  4 001747   040100 100540                    MLR     fill='040'O
         4 001750   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X0
         4 001751   200034 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 001752   200042 236100                    LDQ     I,,AUTO
         4 001753   000024 116007                    CMPQ    20,DL
         4 001754   001762 605000 4                  TPL     s:20031
         4 001755   777753 621006                    EAX1    -21,QL
         4 001756   777777 661003                    ERX1    -1,DU
         4 001757   040146 100400                    MLR     fill='040'O
         4 001760   000027 000001 5                  ADSC9   23                       cn=0,n=1
         4 001761   200034 200011                    ADSC9   END_KEY,Q,AUTO           cn=1,n=*X1

      476    20031    2      BEGIN_KEY.COUNT = 8;

  20031  4 001762   010000 236003                    LDQ     4096,DU
         4 001763   200007 552140                    STBQ    BEGIN_KEY,'40'O,AUTO

      477    20032    2      END_KEY.COUNT = 8;

  20032  4 001764   200034 552140                    STBQ    END_KEY,'40'O,AUTO

      478    20033    2      USERS_KEY = BEGIN_KEY;

  20033  4 001765   000000 100500                    MLR     fill='000'O
         4 001766   200007 000025                    ADSC9   BEGIN_KEY,,AUTO          cn=0,n=21
         4 001767   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      479    20034    2      CALL ASB$PREC_HLP;

  20034  4 001770   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001771   000000 701000 xent               TSX1    ASB$PREC_HLP
         4 001772   000000 011000                    NOP     0

      480    20035    2      ARS = DSEG3SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:77   

  20035  4 001773   000000 235000 xsym               LDA     DSEG3SIZE
         4 001774   200006 755100                    STA     ARS,,AUTO

      481    20036    3      CALL ASB$READ_HLP_SEQ (DSEG3$,ARS,3) WHENRETURN DO;

  20036  4 001775   000005 236000 5                  LDQ     5
         4 001776   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001777   200006 630500                    EPPR0   ARS,,AUTO
         4 002000   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 002001   000006 236000 5                  LDQ     6
         4 002002   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 002003   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002004   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002005   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         4 002006   002143 702000 4                  TSX2    s:20062

      482    20037    4         DO WHILE USERS_KEY.TXTC < END_KEY.TEXT;

  20037  4 002007   040100 106400                    CMPC    fill='040'O
         4 002010   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 002011   200034 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 002012   002143 603000 4                  TRC     s:20062

      483    20038        /*  Calculate ACCT_LEN and MATCH_LEN  */
      484    20039    4            CALL INDEX (ACCT_LEN,' ',USERS_KEY.TXTC);

  20039  4 002013   000000 124400                    SCM     mask='000'O
         4 002014   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 002015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002016   200005 000100                    ARG     ACCT_LEN,,AUTO

      485    20040    4            IF ACCT_LEN > 7 THEN ACCT_LEN = 8;

  20040  4 002017   200005 235100                    LDA     ACCT_LEN,,AUTO
         4 002020   000010 115007                    CMPA    8,DL
         4 002021   002025 602000 4                  TNC     s:20041
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:78   

  20040  4 002022   000010 236007                    LDQ     8,DL
         4 002023   200005 756100                    STQ     ACCT_LEN,,AUTO
         4 002024   002031 710000 4                  TRA     s:20042

      486    20041    4            ELSE IF ACCT_LEN = 0 THEN ACCT_LEN = 1;

  20041  4 002025   000000 115003                    CMPA    0,DU
         4 002026   002031 601000 4                  TNZ     s:20042

  20041  4 002027   000001 236007                    LDQ     1,DL
         4 002030   200005 756100                    STQ     ACCT_LEN,,AUTO

      487    20042    4            CALL INDEX (MATCH_LEN,' ',DEV_NAME.TEXT);

  20042  4 002031   000000 124500                    SCM     mask='000'O
         4 002032   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 002033   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002034   200045 000100                    ARG     MATCH_LEN,,AUTO

      488    20043    4            IF MATCH_LEN < 8 THEN

  20043  4 002035   200045 235100                    LDA     MATCH_LEN,,AUTO
         4 002036   000010 115007                    CMPA    8,DL
         4 002037   002042 603000 4                  TRC     s:20045

      489    20044    4               MATCH_LEN = MATCH_LEN + 1;

  20044  4 002040   000001 035007                    ADLA    1,DL
         4 002041   200045 755100                    STA     MATCH_LEN,,AUTO

      490    20045    4            ACCT = SUBSTR (USERS_KEY.TXTC,0,ACCT_LEN);

  20045  4 002042   200005 720100                    LXL0    ACCT_LEN,,AUTO
         4 002043   040100 100440                    MLR     fill='040'O
         4 002044   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         4 002045   200003 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:79   

      491    20046    4            CALL ASB$WILD_MATCH (ACCT_LEN,ACCT,MATCH_LEN,DEV_NAME.TEXT)

  20046  4 002046   200064 452500                    STP2    TWSN_NUMBER+5,,AUTO
         4 002047   200064 236100                    LDQ     TWSN_NUMBER+5,,AUTO
         4 002050   000017 036000 5                  ADLQ    15
         4 002051   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 002052   200045 630500                    EPPR0   MATCH_LEN,,AUTO
         4 002053   200062 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002054   200003 631500                    EPPR1   ACCT,,AUTO
         4 002055   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 002056   200005 633500                    EPPR3   ACCT_LEN,,AUTO
         4 002057   200060 453500                    STP3    TWSN_NUMBER+1,,AUTO
         4 002060   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002061   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 002062   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 002063   002123 702000 4                  TSX2    s:20059

      492    20047    5            WHENRETURN DO;

      493    20048    6               IF DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  20048  4 002064   000000 470400 xsym               LDP0    DSEG3$
         4 002065   000000 236100                    LDQ     0,,PR0
         4 002066   000777 376007                    ANQ     511,DL
         4 002067   200031 116100                    CMPQ    DEV_TYPE,,AUTO
         4 002070   002123 601000 4                  TNZ     s:20059

      494    20049    7                  IF DISP THEN DO;

  20049  4 002071   200032 234100                    SZN     DISP,,AUTO
         4 002072   002110 605000 4                  TPL     s:20054

      495    20050    7                     CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20050  4 002073   000007 236000 5                  LDQ     7
         4 002074   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:80   
         4 002075   200043 631500                    EPPR1   JCL,,AUTO
         4 002076   200060 451500                    STP1    TWSN_NUMBER+1,,AUTO
         4 002077   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002100   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002101   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 002102   000000 011000                    NOP     0

      496    20051    7                     CALL ASB$WRITE_LO (' ',1);

  20051  4 002103   000010 630400 5                  EPPR0   8
         4 002104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002105   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002106   000000 011000                    NOP     0

      497    20052    7                     END; /*  Disp  */

  20052  4 002107   002120 710000 4                  TRA     s:20056

      498    20053    7                  ELSE DO;

      499    20054    7                     CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);

  20054  4 002110   200033 631500                    EPPR1   DISP_CONSOLES,,AUTO
         4 002111   200061 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 002112   000012 236000 5                  LDQ     10
         4 002113   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 002114   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002116   000000 701000 xent               TSX1    ASL$FORMAT_CONNAME
         4 002117   000000 011000                    NOP     0

      500    20055    7                     END; /*  List  */

      501    20056    6                  DISP_CONSOLES = DISP_CONSOLES + 1;

  20056  4 002120   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 002121   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:81   
         4 002122   200033 755100                    STA     DISP_CONSOLES,,AUTO

      502    20057    6                  END; /*  KL$DREC.SUPER = DEV_TYPE  */

      503    20058    5               END; /*  Whenreturn from ASB$WILD_MATCH on acct  */

      504    20059    4            ARS = DSEG3SIZE;

  20059  4 002123   000000 235000 xsym               LDA     DSEG3SIZE
         4 002124   200006 755100                    STA     ARS,,AUTO

      505    20060    4            CALL ASB$READ_HLP_SEQ (DSEG3$, ARS, 3) ALTRET(FINISH_UP);

  20060  4 002125   000005 236000 5                  LDQ     5
         4 002126   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 002127   200006 630500                    EPPR0   ARS,,AUTO
         4 002130   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 002131   000006 236000 5                  LDQ     6
         4 002132   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 002133   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002134   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002135   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         4 002136   002304 702000 4                  TSX2    FINISH_UP

      506    20061    4            END; /*  Do while USERS_KEY < END_KEY  */

  20061  4 002137   040100 106400                    CMPC    fill='040'O
         4 002140   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 002141   200034 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 002142   002013 602000 4                  TNC     s:20039

      507    20062    3         END; /*  Whenreturn from ASB$READ_HLP_SEQ  */

  20062  4 002143   002240 710000 4                  TRA     s:20082

      508    20063
      509    20064    2      SELECT (%SINGLE_CONSOLE);
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:82   

      510    20065
      511    20066    2      USERS_KEY.COUNT = 9;

  20066  4 002144   011000 236003                    LDQ     4608,DU
         4 002145   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      512    20067    2      CALL CONCAT( USERS_KEY.TXTC, DEV_NAME.TEXT, '*' );

  20067  4 002146   040000 100500                    MLR     fill='040'O
         4 002147   200016 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 002150   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 002151   040000 100400                    MLR     fill='040'O
         4 002152   000026 000001 5                  ADSC9   22                       cn=0,n=1
         4 002153   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      513    20068    2      ARS = DSEG3SIZE;

  20068  4 002154   000000 235000 xsym               LDA     DSEG3SIZE
         4 002155   200006 755100                    STA     ARS,,AUTO

      514    20069    2      CALL ASB$READ_HLP( DSEG3$, ARS, 3) ALTRET(RD_ALT2);

  20069  4 002156   000005 236000 5                  LDQ     5
         4 002157   200062 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 002160   200006 630500                    EPPR0   ARS,,AUTO
         4 002161   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 002162   000006 236000 5                  LDQ     6
         4 002163   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 002164   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002165   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002166   000000 701000 xent               TSX1    ASB$READ_HLP
         4 002167   002241 702000 4                  TSX2    RD_ALT2

      515    20070    2      CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE, %NO#, DEV_NAME ) ALTRET(FINISH_UP);

  20070  4 002170   200016 630500                    EPPR0   DEV_NAME,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:83   
         4 002171   200064 450500                    STP0    TWSN_NUMBER+5,,AUTO
         4 002172   000007 236000 5                  LDQ     7
         4 002173   200063 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 002174   200031 631500                    EPPR1   DEV_TYPE,,AUTO
         4 002175   200062 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 002176   200006 633500                    EPPR3   ARS,,AUTO
         4 002177   200061 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 002200   000006 236000 5                  LDQ     6
         4 002201   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 002202   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002203   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 002204   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 002205   002304 702000 4                  TSX2    FINISH_UP

      516    20071    3      IF DISP THEN DO;

  20071  4 002206   200032 234100                    SZN     DISP,,AUTO
         4 002207   002225 605000 4                  TPL     s:20076

      517    20072    3         CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20072  4 002210   000007 236000 5                  LDQ     7
         4 002211   200061 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002212   200043 630500                    EPPR0   JCL,,AUTO
         4 002213   200060 450500                    STP0    TWSN_NUMBER+1,,AUTO
         4 002214   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002215   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002216   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 002217   000000 011000                    NOP     0

      518    20073    3         CALL ASB$WRITE_LO (' ',1);

  20073  4 002220   000010 630400 5                  EPPR0   8
         4 002221   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002222   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002223   000000 011000                    NOP     0

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:84   
      519    20074    3         END;  /*  Disp  */

  20074  4 002224   002235 710000 4                  TRA     s:20078

      520    20075    3      ELSE DO;

      521    20076    3         CALL ASL$FORMAT_CONNAME (USERS_KEY, DISP_CONSOLES);

  20076  4 002225   200033 630500                    EPPR0   DISP_CONSOLES,,AUTO
         4 002226   200061 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 002227   000012 236000 5                  LDQ     10
         4 002230   200060 756100                    STQ     TWSN_NUMBER+1,,AUTO
         4 002231   200060 630500                    EPPR0   TWSN_NUMBER+1,,AUTO
         4 002232   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002233   000000 701000 xent               TSX1    ASL$FORMAT_CONNAME
         4 002234   000000 011000                    NOP     0

      522    20077    3         END; /*  List  */

      523    20078    2      DISP_CONSOLES = DISP_CONSOLES + 1;

  20078  4 002235   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 002236   000001 035007                    ADLA    1,DL
         4 002237   200033 755100                    STA     DISP_CONSOLES,,AUTO

      524    20079
      525    20080    2      END; /*  Do case (OPTION_CODE)  */

      526    20081
      527    20082    2   DO NEVER;

  20082  4 002240   002304 710000 4                  TRA     FINISH_UP

      528    20083    2   RD_ALT2:
      529    20084    3      IF MERR_CODE.CODE = %E$NOKEY THEN DO;

  20084  4 002241   000000 236000 xsym  RD_ALT2      LDQ     ERR_CODE
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:85   
         4 002242   377770 376007                    ANQ     131064,DL
         4 002243   001020 116007                    CMPQ    528,DL
         4 002244   002255 601000 4                  TNZ     s:20106

      530    20085        /*E*  ERROR:  ASL-E$DEV_NO_EXIST-C
      531    20086              MESSAGE: %U1 does not exist.
      532    20087              MESSAGE1: The specified CONSOLE does not exist.
      533    20088        */
      534    20089    3         AS_FIELD1 = DEV_NAME;

  20089  4 002245   000000 100500                    MLR     fill='000'O
         4 002246   200016 000051                    ADSC9   DEV_NAME,,AUTO           cn=0,n=41
         4 002247   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      535    20090              %SCREAM( ERR#=E$DEV_NO_EXIST2, LEVEL=ERROR, MID='L' );

  20102  4 002250   000032 630400 5                  EPPR0   26
         4 002251   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002252   000000 701000 xent               TSX1    ASH$ERROR
         4 002253   000000 011000                    NOP     0

      536    20105    3         END; /*  Error  */

  20105  4 002254   002261 710000 4                  TRA     s:20107

      537    20106    2      ELSE CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  20106  4 002255   000014 630400 5                  EPPR0   12
         4 002256   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002257   000000 701000 xent               TSX1    ASA$ERROR
         4 002260   000000 011000                    NOP     0

      538    20107    2      GOTO FINISH_UP;

  20107  4 002261   002304 710000 4                  TRA     FINISH_UP

      539    20108
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:86   
      540    20109    3   READ_ALT3: IF MERR_CODE.CODE = %E$NOKEY THEN DO;

  20109  4 002262   000000 236000 xsym  READ_ALT3    LDQ     ERR_CODE
         4 002263   377770 376007                    ANQ     131064,DL
         4 002264   001020 116007                    CMPQ    528,DL
         4 002265   002300 601000 4                  TNZ     READ_ERR

      541    20110    3         AS_FIELD1.COUNT = STATION_NAME.COUNT;

  20110  4 002266   200050 236100                    LDQ     STATION_NAME,,AUTO
         4 002267   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      542    20111    3         AS_FIELD1.TEXT  = STATION_NAME.TEXT;

  20111  4 002270   040000 100500                    MLR     fill='040'O
         4 002271   200050 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 002272   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      543    20112              %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='L' );

  20124  4 002273   000033 630400 5                  EPPR0   27
         4 002274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002275   000000 701000 xent               TSX1    ASH$ERROR
         4 002276   000000 011000                    NOP     0

      544    20127    3         END;  /*  No such key error  */

  20127  4 002277   002304 710000 4                  TRA     FINISH_UP

      545    20128    2      ELSE
      546    20129    2   READ_ERR: CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  20129  4 002300   000014 630400 5     READ_ERR     EPPR0   12
         4 002301   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002302   000000 701000 xent               TSX1    ASA$ERROR
         4 002303   000000 011000                    NOP     0

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:87   
      547    20130    2      END;  /*  Do never  */

      548    20131    1   FINISH_UP:
      549    20132    2   IF NOT DISP THEN DO;

  20132  4 002304   200032 234100       FINISH_UP    SZN     DISP,,AUTO
         4 002305   002322 604000 4                  TMI     s:20138

      550    20133    2      FMT_BUF = '%\%/';

  20133  4 002306   040000 100400                    MLR     fill='040'O
         4 002307   000023 000004 3                  ADSC9   LIST_STR+12              cn=0,n=4
         4 002310   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      551    20134    2      FDS.FMT_.BOUND = 3;

  20134  4 002311   000000 236000 xsym               LDQ     FDS
         4 002312   177777 376007                    ANQ     65535,DL
         4 002313   600000 276007                    ORQ     -65536,DL
         4 002314   000000 756000 xsym               STQ     FDS

      552    20135    2      FDS.NVECS# = 0;

  20135  4 002315   000011 450000 xsym               STZ     FDS+9

      553    20136    2      CALL X$FORMAT (FDS);

  20136  4 002316   000004 630400 5                  EPPR0   4
         4 002317   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002320   000000 701000 xent               TSX1    X$FORMAT
         4 002321   000000 011000                    NOP     0

      554    20137    2      END; /*  If not disp  */

      555    20138    2   IF NOT JCL THEN DO;

  20138  4 002322   200043 234100                    SZN     JCL,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:88   
         4 002323   002372 604000 4                  TMI     s:20159

      556    20139    2      FMT_VEC(0) = VECTOR (DISP_CONSOLES);

  20139  4 002324   777640 235007                    LDA     -96,DL
         4 002325   200060 452500                    STP2    TWSN_NUMBER+1,,AUTO
         4 002326   200060 236100                    LDQ     TWSN_NUMBER+1,,AUTO
         4 002327   000033 036003                    ADLQ    27,DU
         4 002330   000000 755000 xsym               STA     FMT_VEC
         4 002331   000001 756000 xsym               STQ     FMT_VEC+1

      557    20140    2      IF DISP_CONSOLES = 1 THEN

  20140  4 002332   200033 235100                    LDA     DISP_CONSOLES,,AUTO
         4 002333   000001 115007                    CMPA    1,DL
         4 002334   002341 601000 4                  TNZ     s:20145

      558    20141    3      DO;

      559    20142    3         FMT_VEC(1) = VECTOR (CONSOLE_STR);

  20142  4 002335   000034 237000 5                  LDAQ    28
         4 002336   000002 755000 xsym               STA     FMT_VEC+2
         4 002337   000003 756000 xsym               STQ     FMT_VEC+3

      560    20143    3         END; /*  DISP_CONSOLES = 1  */

  20143  4 002340   002344 710000 4                  TRA     s:20147

      561    20144    3      ELSE DO;

      562    20145    3         FMT_VEC(1) = VECTOR (CONSOLES_STR);

  20145  4 002341   000036 237000 5                  LDAQ    30
         4 002342   000002 755000 xsym               STA     FMT_VEC+2
         4 002343   000003 756000 xsym               STQ     FMT_VEC+3

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:89   
      563    20146    3         END; /*  DISP_CONSOLES ~= 1  */

      564    20147    2      IF DISP THEN

  20147  4 002344   200032 234100                    SZN     DISP,,AUTO
         4 002345   002352 605000 4                  TPL     s:20152

      565    20148    3      DO;

      566    20149    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  20149  4 002346   000040 237000 5                  LDAQ    32
         4 002347   000004 755000 xsym               STA     FMT_VEC+4
         4 002350   000005 756000 xsym               STQ     FMT_VEC+5

      567    20150    3         END; /*  If disp  */

  20150  4 002351   002355 710000 4                  TRA     s:20154

      568    20151    3      ELSE DO;

      569    20152    3         FMT_VEC(2) = VECTOR (LIST_STR);

  20152  4 002352   000042 237000 5                  LDAQ    34
         4 002353   000004 755000 xsym               STA     FMT_VEC+4
         4 002354   000005 756000 xsym               STQ     FMT_VEC+5

      570    20153    3         END; /*  If ~ disp  */

      571    20154    2      FDS.NVECS# = 3;

  20154  4 002355   000003 235007                    LDA     3,DL
         4 002356   000011 755000 xsym               STA     FDS+9

      572    20155    2      FMT_BUF = '   %5D %A %A.';

  20155  4 002357   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:90   
         4 002360   000024 000015 3                  ADSC9   LIST_STR+13              cn=0,n=13
         4 002361   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      573    20156    2      FDS.FMT_.BOUND = 12;

  20156  4 002362   000000 236000 xsym               LDQ     FDS
         4 002363   177777 376007                    ANQ     65535,DL
         4 002364   000003 276003                    ORQ     3,DU
         4 002365   000000 756000 xsym               STQ     FDS

      574    20157    2      CALL X$FORMAT(FDS);

  20157  4 002366   000004 630400 5                  EPPR0   4
         4 002367   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002370   000000 701000 xent               TSX1    X$FORMAT
         4 002371   000000 011000                    NOP     0

      575    20158    2      END; /* Not jcl */

      576    20159    1   RETURN;

  20159  4 002372   000000 702200 xent               TSX2  ! X66_ARET
      577    20160    1   END ASL$LIST_ALL_CONSOLES;
      578    20161        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:91   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_CONSOLES.
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:92   

 **** Variables and constants ****

  ****  Section 002  Data  ASL$LIST_ALL_CONSOLES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    67-0-0/w PTR         r     1 LINCNFG$
     5-0-0/w UBIN        r     1 LINCNFG_BUF(0:49)

  ****  Section 003 RoData ASL$LIST_ALL_CONSOLES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/c CHAR(8)     r     1 CONSOLES_STR               0-0-0/c CHAR(7)     r     1 CONSOLE_STR
     4-0-0/c CHAR(9)     r     1 DISPLAY_STR                7-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/c CHAR(8)     r     1 ACCT                       5-0-0/w UBIN        r     1 ACCT_LEN
     6-0-0/w SBIN        r     1 ARS                        7-0-0/c STRC(189)   r     1 BEGIN_KEY
    15-0-0/w PTR         r     1 BLK$                      16-0-0/c STRC(378)   r     1 DEV_NAME
    31-0-0/w UBIN        r     1 DEV_TYPE                  32-0-0/b BIT         r     1 DISP
    33-0-0/w UBIN        r     1 DISP_CONSOLES             34-0-0/c STRC(189)   r     1 END_KEY
    42-0-0/w SBIN        r     1 I                         43-0-0/b BIT         r     1 JCL
    44-0-0/w SBIN        r     1 K                         45-0-0/w UBIN        r     1 MATCH_LEN
    46-0-0/w UBIN        r     1 NAME_LEN                  47-0-0/w UBIN        r     1 OPTION_CODE
    50-0-0/c STRC(81)    r     1 STATION_NAME              53-0-0/c STRC(81)    r     1 TERMINAL_NAME
    56-0-0/c CHAR(4)     r     1 TWSN_CHAR                 57-0-0/w UBIN        r     1 TWSN_NUMBER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:93   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w UBIN        r     1 DSEG1SIZE                  0-0-0/w PTR         r     1 DSEG2$
     0-0-0/w UBIN        r     1 DSEG2SIZE                  0-0-0/w PTR         r     1 DSEG3$
     0-0-0/w UBIN        r     1 DSEG3SIZE                  0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)              0-0-0/b STRC        r     1 MERR_CODE
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL$DREC                    0-0-0/w STRC(576)   r     1 KL$TWSNREC
     0-0-0/w STRC(144)   r     1 KL$WSNCVT                  0-0-0/w ASTR(387)   r     1 LINCNFG
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(144)   r     1 P$B


   Procedure ASL$LIST_ALL_CONSOLES requires 1275 words for executable code.
   Procedure ASL$LIST_ALL_CONSOLES requires 54 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:94   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:95   
          MINI XREF LISTING

ACCT
     19652**DCL     20045<<ASSIGN  20046<>CALL
ACCT_LEN
     19653**DCL     20039<<CALLBLT 20040>>IF      20040<<ASSIGN  20041>>IF      20041<<ASSIGN  20045>>ASSIGN
     20046<>CALL
ARS
     19654**DCL     19796<<ASSIGN  19797<>CALL    19845<<ASSIGN  19846<>CALL    19868<<ASSIGN  19869<>CALL
     19872<<ASSIGN  19873<>CALL    19888<<ASSIGN  19889<>CALL    19910<<ASSIGN  19911<>CALL    19917<<ASSIGN
     19918<>CALL    19930<<ASSIGN  19931<>CALL    19975<<ASSIGN  19976<>CALL    19984<<ASSIGN  19985<>CALL
     19990<>CALL    19993<<ASSIGN  19994<>CALL    20006<<ASSIGN  20007<>CALL    20035<<ASSIGN  20036<>CALL
     20059<<ASSIGN  20060<>CALL    20068<<ASSIGN  20069<>CALL    20070<>CALL
ASA$ERROR
     19088**DCL-ENT 19817--CALL    20106--CALL    20129--CALL
ASA_BRKS_LOC
     16012**DCL     16012--REDEF
ASB$BOF_HLP
     19091**DCL-ENT 19794--CALL
ASB$CHECK_TYPE
     19094**DCL-ENT 19990--CALL    20070--CALL
ASB$GET_NEXT_STATION
     19097**DCL-ENT 19830--CALL
ASB$INIT_GET_STATION
     19100**DCL-ENT 19824--CALL
ASB$PREC_AND_SKIP_HLP
     19103**DCL-ENT 19812--CALL
ASB$PREC_HLP
     19106**DCL-ENT 20034--CALL
ASB$READ_HLP
     19109**DCL-ENT 19846--CALL    19869--CALL    19873--CALL    19889--CALL    19911--CALL    19918--CALL
     19931--CALL    19976--CALL    19985--CALL    19994--CALL    20007--CALL    20069--CALL
ASB$READ_HLP_SEQ
     19112**DCL-ENT 19797--CALL    20036--CALL    20060--CALL
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:96   
ASB$WILD_MATCH
     19115**DCL-ENT 19829--CALL    19842--CALL    19885--CALL    19922--CALL    19926--CALL    19999--CALL
     20003--CALL    20046--CALL
ASB$WRITE_LO
     19118**DCL-ENT 19803--CALL    19852--CALL    19896--CALL    19939--CALL    20014--CALL    20051--CALL
     20073--CALL
ASH$ERROR
     19121**DCL-ENT 19965--CALL    20102--CALL    20124--CALL
ASL$DISP_ONE_DEVICE
     19124**DCL-ENT 19802--CALL    19851--CALL    19895--CALL    19938--CALL    20013--CALL    20050--CALL
     20072--CALL
ASL$FORMAT_CONNAME
     19127**DCL-ENT 19806--CALL    19849--CALL    19892--CALL    19935--CALL    20010--CALL    20054--CALL
     20076--CALL
AS_DEFAULT.BANNER_PERM
     16705**DCL     16706--REDEF
AS_DEFAULT.BUDGET.MACCT
     16610**DCL     16614--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     16623**DCL     16626--REDEF
AS_DEFAULT.BUDGET.PACCUM
     16606**DCL     16608--REDEF
AS_DEFAULT.BUDGET.PMAXC
     16601**DCL     16603--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     16721**DCL     16722--REDEF   16723--REDEF
AS_DEFAULT_DREC.PASSWORD
     17975**DCL     17979--REDEF
AS_DEFAULT_DREC.RENAME
     17998**DCL     17999--REDEF
AS_DFLT.BANNER_PERM
     16527**DCL     16528--REDEF
AS_DFLT.BUDGET.MACCT
     16432**DCL     16436--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     16445**DCL     16448--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:97   
AS_DFLT.BUDGET.PACCUM
     16428**DCL     16430--REDEF
AS_DFLT.BUDGET.PMAXC
     16423**DCL     16425--REDEF
AS_DFLT.SETUP_CHRA.TXT
     16543**DCL     16544--REDEF   16545--REDEF
AS_FE_MODE
     15878**DCL     15879--REDEF
AS_FIELD1
     16008**DCL     20089<<ASSIGN
AS_FIELD1.COUNT
     16009**DCL     19950<<ASSIGN  19986<<ASSIGN  20110<<ASSIGN
AS_FIELD1.TEXT
     16009**DCL     19949<<ASSIGN  19987<<ASSIGN  20111<<ASSIGN
AS_FIELD2.COUNT
     16009**DCL     19952<<ASSIGN  19988<<ASSIGN
AS_FIELD2.TEXT
     16009**DCL     19951<<ASSIGN  19989<<ASSIGN
AS_MODE
     15875**DCL     15877--REDEF
AS_MOD_USER.ACCESS
     18740**DCL     18741--REDEF
AS_MOD_USER.BANNER
     18727**DCL     18728--REDEF
AS_MOD_USER.BANNER_PERM
     18729**DCL     18730--REDEF
AS_MOD_USER.BILL
     18735**DCL     18736--REDEF
AS_MOD_USER.CPROC
     18731**DCL     18732--REDEF
AS_MOD_USER.FEBILL
     18811**DCL     18812--REDEF
AS_MOD_USER.FECXTMEM
     18828**DCL     18829--REDEF
AS_MOD_USER.FEMINTS
     18813**DCL     18814--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:98   
AS_MOD_USER.FEMMEM
     18824**DCL     18825--REDEF
AS_MOD_USER.FEMTIME
     18822**DCL     18823--REDEF
AS_MOD_USER.FEPPRIV
     18819**DCL     18821--REDEF
AS_MOD_USER.FEPRIV
     18816**DCL     18818--REDEF
AS_MOD_USER.FORCE_BIT
     18725**DCL     18726--REDEF
AS_MOD_USER.KEY
     18807**DCL     18809--REDEF
AS_MOD_USER.LASTCPROC
     18733**DCL     18734--REDEF
AS_MOD_USER.LIMITS.DO_
     18781**DCL     18782--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     18797**DCL     18798--REDEF
AS_MOD_USER.LIMITS.LO
     18777**DCL     18778--REDEF
AS_MOD_USER.LIMITS.MEM
     18773**DCL     18774--REDEF
AS_MOD_USER.LIMITS.MPRIO
     18801**DCL     18802--REDEF
AS_MOD_USER.LIMITS.PDIS
     18789**DCL     18790--REDEF
AS_MOD_USER.LIMITS.PO
     18785**DCL     18786--REDEF
AS_MOD_USER.LIMITS.TDIS
     18793**DCL     18794--REDEF
AS_MOD_USER.LIMITS.TIME
     18769**DCL     18770--REDEF
AS_MOD_USER.MAXENQ
     18750**DCL     18751--REDEF
AS_MOD_USER.PERM_BIT
     18723**DCL     18724--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:99   
AS_MOD_USER.PPRIV
     18745**DCL     18747--REDEF
AS_MOD_USER.PRIOB
     18752**DCL     18753--REDEF
AS_MOD_USER.PRIV
     18742**DCL     18744--REDEF
AS_MOD_USER.QUAN
     18748**DCL     18749--REDEF
AS_MOD_USER.SETUP
     18721**DCL     18722--REDEF
AS_PROJECT.BANNER_PERM
     17061**DCL     17062--REDEF
AS_PROJECT.BUDGET.MACCT
     16966**DCL     16970--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     16979**DCL     16982--REDEF
AS_PROJECT.BUDGET.PACCUM
     16962**DCL     16964--REDEF
AS_PROJECT.BUDGET.PMAXC
     16957**DCL     16959--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     17077**DCL     17078--REDEF   17079--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     17239**DCL     17240--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     17144**DCL     17148--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     17157**DCL     17160--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     17140**DCL     17142--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     17135**DCL     17137--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     17255**DCL     17256--REDEF   17257--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     18461**DCL     18465--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:100  
AS_PROJECT_DFLT_DREC.RENAME
     18484**DCL     18485--REDEF
AS_PROJECT_DREC.PASSWORD
     18299**DCL     18303--REDEF
AS_PROJECT_DREC.RENAME
     18322**DCL     18323--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     16883**DCL     16884--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     16788**DCL     16792--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     16801**DCL     16804--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     16784**DCL     16786--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     16779**DCL     16781--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     16899**DCL     16900--REDEF   16901--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     18137**DCL     18141--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     18160**DCL     18161--REDEF
AS_USERS.BANNER_PERM
     16349**DCL     16350--REDEF
AS_USERS.BUDGET.MACCT
     16254**DCL     16258--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     16267**DCL     16270--REDEF
AS_USERS.BUDGET.PACCUM
     16250**DCL     16252--REDEF
AS_USERS.BUDGET.PMAXC
     16245**DCL     16247--REDEF
AS_USERS.SETUP_CHRA.TXT
     16365**DCL     16366--REDEF   16367--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     17417**DCL     17418--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:101  
AS_USERS_CONSTANT.BUDGET.MACCT
     17322**DCL     17326--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     17335**DCL     17338--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     17318**DCL     17320--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     17313**DCL     17315--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     17433**DCL     17434--REDEF   17435--REDEF
BEGIN_KEY
     19655**DCL     20033>>ASSIGN
BEGIN_KEY.COUNT
     19656**DCL     20031<<ASSIGN
BEGIN_KEY.TEXT
     19657**DCL     20029<<ASSIGN
BLK$
     19658**DCL     19618--IMP-PTR 19734<<ASSIGN  19735>>ASSIGN  19736>>ASSIGN  19736>>ASSIGN  19740<<ASSIGN
     19741>>ASSIGN  19742>>ASSIGN  19742>>ASSIGN  19751<<ASSIGN  19752>>ASSIGN  19753>>ASSIGN  19753>>ASSIGN
CODE
     16005**DCL     19709<<ASSIGN  19711>>DOSELCT 19730>>ASSIGN
CONFIG_KEY.TERMID.TERM
     18912**DCL     18921--REDEF
CONSOLES_STR
     19688**DCL     19770>>CALLBLT 19771--ASSIGN  19774>>CALLBLT 19775--ASSIGN  20145--ASSIGN
CONSOLE_STR
     19687**DCL     20142--ASSIGN
DEV_NAME
     19659**DCL     19799<<ASSIGN  19810>>IF      19811>>ASSIGN  20070<>CALL    20089>>ASSIGN
DEV_NAME.COUNT
     19660**DCL     19698<<ASSIGN  19735<<ASSIGN  19841>>ASSIGN  19884>>ASSIGN  19921>>ASSIGN  19998>>ASSIGN
DEV_NAME.TEXT
     19661**DCL     19699<<ASSIGN  19736<<ASSIGN  19781>>CALLBLT 19787>>IF      19842<>CALL    19885<>CALL
     19922<>CALL    19999<>CALL    20028>>CALLBLT 20029>>ASSIGN  20030>>CALLBLT 20042>>CALLBLT 20046<>CALL
     20067>>CALLBLT
DEV_TYPE
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:102  
     19663**DCL     19705<<ASSIGN  19800>>IF      19847>>IF      19890>>IF      19933>>IF      20008>>IF
     20048>>IF      20070<>CALL
DISP
     19664**DCL     19715<<ASSIGN  19720<<ASSIGN  19730<<ASSIGN  19801>>IF      19848>>IF      19891>>IF
     19934>>IF      20009>>IF      20049>>IF      20071>>IF      20132>>IF      20147>>IF
DISPLAY_STR
     19689**DCL     20149--ASSIGN
DISP_CONSOLES
     19665**DCL     19704<<ASSIGN  19806<>CALL    19808<<ASSIGN  19808>>ASSIGN  19849<>CALL    19854<<ASSIGN
     19854>>ASSIGN  19892<>CALL    19898<<ASSIGN  19898>>ASSIGN  19935<>CALL    19941<<ASSIGN  19941>>ASSIGN
     20010<>CALL    20016<<ASSIGN  20016>>ASSIGN  20054<>CALL    20056<<ASSIGN  20056>>ASSIGN  20076<>CALL
     20078<<ASSIGN  20078>>ASSIGN  20139--ASSIGN  20140>>IF
DSEG1$
     16013**DCL     19559--IMP-PTR 19825>>DOINDEX 19826>>CALLBLT 19829>>CALL    19869<>CALL    19871>>CALLBLT
     19911<>CALL    19912>>DOINDEX 19913>>IF      19976<>CALL    19985<>CALL    19990<>CALL    19992>>CALLBLT
DSEG1SIZE
     16014**DCL     19868>>ASSIGN  19910>>ASSIGN  19975>>ASSIGN  19984>>ASSIGN
DSEG2$
     16014**DCL     19421--IMP-PTR 19831>>DOINDEX 19832>>IF      19833>>IF      19838>>CALLBLT 19842>>CALL
     19844>>CALLBLT 19873<>CALL    19874>>DOINDEX 19875>>IF      19876>>IF      19881>>CALLBLT 19885>>CALL
     19887>>CALLBLT 19918<>CALL    19919>>DOINDEX 19920>>IF      19922>>CALL    19924>>CALLBLT 19926>>CALL
     19929>>CALLBLT 19949>>ASSIGN  19994<>CALL    19995>>DOINDEX 19997>>IF      19999>>CALL    20001>>CALLBLT
     20003>>CALL    20005>>CALLBLT
DSEG2SIZE
     16014**DCL     19872>>ASSIGN  19917>>ASSIGN  19993>>ASSIGN
DSEG3$
     16014**DCL     19146--IMP-PTR 19797<>CALL    19800>>IF      19846<>CALL    19847>>IF      19889<>CALL
     19890>>IF      19931<>CALL    19933>>IF      20007<>CALL    20008>>IF      20036<>CALL    20048>>IF
     20060<>CALL    20069<>CALL    20070<>CALL
DSEG3SIZE
     16014**DCL     19796>>ASSIGN  19845>>ASSIGN  19888>>ASSIGN  19930>>ASSIGN  20006>>ASSIGN  20035>>ASSIGN
     20059>>ASSIGN  20068>>ASSIGN
END_KEY.COUNT
     19667**DCL     20032<<ASSIGN
END_KEY.TEXT
     19668**DCL     20030<<CALLBLT 20037>>DOWHILE
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:103  
ERR_CODE
     16007**DCL     16008--REDEF
FDS
     15904**DCL     19778<>CALL    20136<>CALL    20157<>CALL
FDS.FMT_.BOUND
     15909**DCL     19771<<ASSIGN  19775<<ASSIGN  20134<<ASSIGN  20156<<ASSIGN
FDS.NVECS#
     15932**DCL     19768<<ASSIGN  20135<<ASSIGN  20154<<ASSIGN
FDS.TABDFLT#
     15970**DCL     19777<<ASSIGN
FINISH_UP
     20132**LABEL   19818--GOTO    19830--CALLALT 19862--GOTO    19904--GOTO    19990--CALLALT 20060--CALLALT
     20070--CALLALT 20107--GOTO
FMT_BUF
     16003**DCL     19770<<CALLBLT 19774<<CALLBLT 20133<<ASSIGN  20155<<ASSIGN
FMT_VEC
     16003**DCL     20139<<ASSIGN  20142<<ASSIGN  20145<<ASSIGN  20149<<ASSIGN  20152<<ASSIGN
I
     19669**DCL     19707<<DOINDEX 19709>>ASSIGN  19722>>IF      19723>>DOINDEX 19724>>IF      19734>>ASSIGN
     19740>>ASSIGN  19751>>ASSIGN  19781<<CALLBLT 19831<<DOINDEX 19832>>IF      19833>>IF      19838>>CALLBLT
     19842>>CALL    19844>>CALLBLT 19874<<DOINDEX 19875>>IF      19876>>IF      19881>>CALLBLT 19885>>CALL
     19887>>CALLBLT 19919<<DOINDEX 19920>>IF      19922>>CALL    19924>>CALLBLT 19926>>CALL    19929>>CALLBLT
     19949>>ASSIGN  19995<<DOINDEX 19997>>IF      19999>>CALL    20001>>CALLBLT 20003>>CALL    20005>>CALLBLT
     20028<<CALLBLT 20029>>ASSIGN  20030>>CALLBLT
JCL
     19670**DCL     19695<<ASSIGN  19725<<ASSIGN  19762<<ASSIGN  19769>>IF      19802<>CALL    19851<>CALL
     19895<>CALL    19938<>CALL    20013<>CALL    20050<>CALL    20072<>CALL    20138>>IF
K
     19671**DCL     19723<<DOINDEX 19724>>IF      19744<<CALLBLT 19755<<CALLBLT
KL$DREC.PASSWORD
     19516**DCL     19520--REDEF
KL$DREC.RENAME
     19539**DCL     19540--REDEF
KL$DREC.SUPER
     19510**DCL     19800>>IF      19847>>IF      19890>>IF      19933>>IF      20008>>IF      20048>>IF
KL$DREC.TWSN#
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:104  
     19513**DCL     19871>>CALLBLT 19992>>CALLBLT
KL$TREC.PASSWORD
     19204**DCL     19208--REDEF
KL$TREC.RENAME
     19227**DCL     19228--REDEF
KL$TWSNREC.DEVS.ACCT
     19439**DCL     19838>>CALLBLT 19842<>CALL    19844>>CALLBLT 19881>>CALLBLT 19885<>CALL    19887>>CALLBLT
     19922<>CALL    19929>>CALLBLT 19949>>ASSIGN  19999<>CALL    20005>>CALLBLT
KL$TWSNREC.DEVS.IOM_CONNECTED
     19434**DCL     19832>>IF      19875>>IF
KL$TWSNREC.DEVS.TDEV
     19433**DCL     19833>>IF      19876>>IF      19920>>IF      19997>>IF
KL$TWSNREC.DEVS.TERM
     19440**DCL     19924>>CALLBLT 19926<>CALL    20001>>CALLBLT 20003<>CALL
KL$TWSNREC.NDEV
     19424**DCL     19831>>DOINDEX 19874>>DOINDEX 19919>>DOINDEX 19995>>DOINDEX
KL$WSNCVT.LTWSN
     19562**DCL     19825>>DOINDEX 19912>>DOINDEX
KL$WSNCVT.WSN
     19563**DCL     19826>>CALLBLT 19829<>CALL    19913>>IF
KL_DEFAULT.PASSWORD
     18623**DCL     18627--REDEF
KL_DEFAULT.RENAME
     18646**DCL     18647--REDEF
KL_DFLT.PASSWORD
     17813**DCL     17817--REDEF
KL_DFLT.RENAME
     17836**DCL     17837--REDEF
KL_DREC.PASSWORD
     17651**DCL     17655--REDEF
KL_DREC.RENAME
     17674**DCL     17675--REDEF
KL_DREC_CNT.PASSWORD
     17538**DCL     17542--REDEF
KL_DREC_CNT.RENAME
     17561**DCL     17562--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:105  
LINCNFG.LGN.LGNSIZE
     19081**DCL     19082--IMP-SIZ
LINCNFG$
     18925**DCL     18944--IMP-PTR
LINCNFG_BUF
     18924**DCL     18925--DCLINIT
LIST_STR
     19690**DCL     20152--ASSIGN
MATCH_LEN
     19672**DCL     19828<<ASSIGN  19829<>CALL    19841<<ASSIGN  19842<>CALL    19884<<ASSIGN  19885<>CALL
     19921<<ASSIGN  19922<>CALL    19925<<ASSIGN  19926<>CALL    19998<<ASSIGN  19999<>CALL    20002<<ASSIGN
     20003<>CALL    20042<<CALLBLT 20043>>IF      20044<<ASSIGN  20044>>ASSIGN  20046<>CALL
MERR_CODE.CODE
     16008**DCL     19816>>IF      20084>>IF      20109>>IF
NAME_LEN
     19673**DCL     19826<<CALLBLT 19827>>IF      19827<<ASSIGN  19829<>CALL    19834<<ASSIGN  19838<<CALLBLT
     19842<>CALL    19877<<ASSIGN  19881<<CALLBLT 19885<>CALL    19924<<CALLBLT 19926<>CALL    20001<<CALLBLT
     20003<>CALL
NEXT_STATION
     19861**LABEL   19829--CALLALT
NO_REC_FOR_STATION1
     19859**LABEL   19846--CALLALT
NO_REC_FOR_STATION2
     19903**LABEL   19889--CALLALT
NO_REC_FOR_TERM2
     20022**LABEL   20007--CALLALT
OPTION_CODE
     19674**DCL     19697<<ASSIGN  19716<<ASSIGN  19721<<ASSIGN  19743<<ASSIGN  19746<<ASSIGN  19754<<ASSIGN
     19757<<ASSIGN  19780>>IF      19783<<ASSIGN  19786>>IF      19788<<ASSIGN  19790>>DOSELCT
OUT$SYM.COUNT
     19641**DCL     19644--IMP-SIZ 19735>>ASSIGN  19736>>ASSIGN  19741>>ASSIGN  19742>>ASSIGN  19752>>ASSIGN
     19753>>ASSIGN
OUT$SYM.TEXT
     19644**DCL     19736>>ASSIGN  19742>>ASSIGN  19753>>ASSIGN
P$B.CODE
     19580**DCL     19709>>ASSIGN  19724>>IF
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:106  
P$B.NSUBLKS
     19584**DCL     19707>>DOINDEX 19722>>IF      19723>>DOINDEX
P$B.SUBLK$
     19605**DCL     19709>>ASSIGN  19722>>IF      19723>>DOINDEX 19724>>IF      19724>>IF      19734>>ASSIGN
     19740>>ASSIGN  19751>>ASSIGN
PROJ_KEY.TEXT
     15885**DCL     15885--REDEF
PROJ_KEY.TXT.PROJECT
     15885**DCL     15885--REDEF
P_PCB.OUT$
     16053**DCL     19707>>DOINDEX 19709>>ASSIGN  19722>>IF      19723>>DOINDEX 19724>>IF      19734>>ASSIGN
     19740>>ASSIGN  19751>>ASSIGN
RD_ALT2
     20084**LABEL   20069--CALLALT
READ_ALT3
     20109**LABEL   19869--CALLALT
READ_ERR
     20129**LABEL   19873--CALLALT 19911--CALLALT 19918--CALLALT 19976--CALLALT 19985--CALLALT 19994--CALLALT
REMEM_VAR
     16011**DCL     16011--REDEF
REM_FCMD
     16011**DCL     16012--REDEF
STATION_NAME.COUNT
     19676**DCL     19700<<ASSIGN  19741<<ASSIGN  19828>>ASSIGN  20110>>ASSIGN
STATION_NAME.TEXT
     19677**DCL     19701<<ASSIGN  19742<<ASSIGN  19744>>CALLBLT 19829<>CALL    19867>>CALLBLT 20111>>ASSIGN
TERMINAL_NAME
     19678**DCL     19990<>CALL
TERMINAL_NAME.COUNT
     19679**DCL     19702<<ASSIGN  19752<<ASSIGN  19925>>ASSIGN  19986>>ASSIGN  20002>>ASSIGN
TERMINAL_NAME.TEXT
     19680**DCL     19703<<ASSIGN  19753<<ASSIGN  19755>>CALLBLT 19926<>CALL    19983>>CALLBLT 19987>>ASSIGN
     20003<>CALL
TWSN_CHAR
     19681**DCL     19915<<CALLBLT 19916>>CALLBLT 19951>>ASSIGN
TWSN_NUMBER
PL6.E3A0      #001=ASL$LIST_ALL_CONSOLES File=ASL$LIST_CONSOLES.:E05TSI          TUE 07/29/97 10:04 Page:107  
     19682**DCL     19825<<DOINDEX 19826>>CALLBLT 19829>>CALL    19830<>CALL    19912<<DOINDEX 19913>>IF
     19915>>CALLBLT
USERS_KEY
     15882**DCL     19799>>ASSIGN  19806<>CALL    19810>>IF      19811<<ASSIGN  19817<>CALL    19849<>CALL
     19892<>CALL    19935<>CALL    20010<>CALL    20033<<ASSIGN  20054<>CALL    20076<>CALL    20106<>CALL
     20129<>CALL
USERS_KEY.COUNT
     15882**DCL     19835<<ASSIGN  19839<<ASSIGN  19866<<ASSIGN  19870<<ASSIGN  19878<<ASSIGN  19882<<ASSIGN
     19908<<ASSIGN  19914<<ASSIGN  19928<<ASSIGN  19973<<ASSIGN  19982<<ASSIGN  19991<<ASSIGN  19996<<ASSIGN
     20066<<ASSIGN
USERS_KEY.TEXT
     15882**DCL     15883--REDEF   15883--REDEF   15883--REDEF   15884--REDEF
USERS_KEY.TXTC
     15883**DCL     19844<<CALLBLT 19867<<CALLBLT 19871<<CALLBLT 19887<<CALLBLT 19909<<ASSIGN  19916<<CALLBLT
     19929<<CALLBLT 19974<<ASSIGN  19983<<CALLBLT 19992<<CALLBLT 20005<<CALLBLT 20037>>DOWHILE 20039>>CALLBLT
     20045>>ASSIGN  20067<<CALLBLT
X$FORMAT
     19129**DCL-ENT 19778--CALL    20136--CALL    20157--CALL

PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:108  
      579        1        /*T***********************************************************/
      580        2        /*T*                                                         */
      581        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      582        4        /*T*                                                         */
      583        5        /*T***********************************************************/
      584        6        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:109  
      585        7        ASL$FORMAT_CONNAME: PROC (TEXT$C, NUMBER);
      586        8        /**********************************************************/
      587        9
      588       10        /*D* NAME:     ASL$FORMAT_CONNAME
      589       11             CALL:     CALL ASL$FORMAT_CONNAME ;
      590       12             INPUT:    TEXT$C - A TEXTC string containing the key of the
      591       13                                 last device record read.
      592       14             OUTPUT:   Nothing is returned.
      593       15             DESCRIPTION:  ASL$FORMAT_CONNAME is the routine that
      594       16                           formats the device records key into a device name
      595       17                           that can be recognized and used by a user.
      596       18                           This routine recognizes the following types of
      597       19                           record keys from :HLP:
      598       20                                 type 1 - device records - keys 'xxxxxxxx*'
      599       21                                 type 2 - device records - keys 'ddnn9999'
      600       22                           And will format them like the following:
      601       23                                 type 1 - 'xxxxxxxx'  format - %>A
      602       24                                 type 2 - 'ddnn'      format - %A
      603       25
      604       26                           The keys belong to the following types of devices:
      605       27                                 type 1 - regular devices and tp devices created
      606       28                                          with an account but no name.
      607       29                                 type 2 - devices belonging to a terminal.
      608       30        */
      609       31        /********************************************************************/
      610       32        /*   Include files   include files   include files   include files  */
      611       33        /********************************************************************/
      612       34        %INCLUDE AS_SUPER_C;
      613      469        %INCLUDE AS_SUBS_C;
      614     1883        %INCLUDE AS_MAC_C;
      615     1963        %INCLUDE KL_SUPER_C;
      616     4865        %INCLUDE XU_MACRO_C;
      617     7971        %INCLUDE XU_FORMAT_C;
      618     8133        %INCLUDE AS_SUPER_R;
      619    11149        /********************************************************************/
      620    11150        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      621    11151        /********************************************************************/
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:110  
      622    11152    1   DCL X$FORMAT ENTRY(1);
      623    11153        /********************************************************************/
      624    11154        /*   Parameters      parameters      parameters      parameters     */
      625    11155        /********************************************************************/
      626    11156    1   DCL NUMBER UBIN;
      627    11157    1   DCL 1 TEXT$C,
      628    11158    1          2 COUNT UBIN BYTE UNAL,
      629    11159    1          2 TEXT CHAR(41) UNAL;
      630    11160        /********************************************************************/
      631    11161        /*   Auto data       auto data       auto data       auto data      */
      632    11162        /********************************************************************/
      633    11163    1   DCL ACCT                     CHAR(8);
      634    11164    1   DCL ACCT_LEN                 UBIN;
      635    11165    1   DCL 1 DEV_NAME,
      636    11166    1          2 COUNT               UBIN BYTE UNAL,
      637    11167    1          2 TEXT                CHAR(41) UNAL;
      638    11168    1   DCL LEN                      UBIN;
      639    11169    1   DCL NAME_LEN                 UBIN;
      640    11170    1   DCL NAME                     CHAR(12);
      641    11171        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:111  
      642    11172        /********************************************************************/
      643    11173        /*   Procedure       procedure       procedure       procedure      */
      644    11174        /********************************************************************/
      645    11175    2   IF TEXT$C.COUNT = 8 THEN DO;
      646    11176    2      DEV_NAME.COUNT = 4;
      647    11177    2      DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,4);
      648    11178    2      END;  /*  Count = 8  */
      649    11179    2   ELSE IF TEXT$C.COUNT = 9 THEN DO;
      650    11180    2         CALL INDEX (LEN, ' ', SUBSTR (TEXT$C.TEXT,0,8));
      651    11181    2         DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,LEN);
      652    11182    2         DEV_NAME.COUNT = LEN;
      653    11183    2         END; /*  If count = 9  */
      654    11184    2      ELSE DO;
      655    11185    2         CALL INDEX(ACCT_LEN, ' ', SUBSTR(TEXT$C.TEXT,0,8));
      656    11186    2         ACCT = SUBSTR (TEXT$C.TEXT,0,ACCT_LEN);
      657    11187    2         CALL INDEX (NAME_LEN, ' ', SUBSTR(TEXT$C.TEXT,8,12));
      658    11188    2         NAME = SUBSTR (TEXT$C.TEXT,8,NAME_LEN);
      659    11189    2         CALL CONCAT (DEV_NAME.TEXT, SUBSTR (ACCT,0,ACCT_LEN), ',', SUBSTR(NAME,0,
             11189                  NAME_LEN));
      660    11190    2         DEV_NAME.COUNT = ACCT_LEN + NAME_LEN + 1;
      661    11191    2         END; /*   Else  */
      662    11192    2   IF NUMBER = 0 THEN DO;
      663    11193    2      CALL CONCAT (FMT_BUF, '%\', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));
      664    11194    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 1;
      665    11195    2      END; /*  Number = 0  */
      666    11196    2   ELSE DO;
      667    11197    2      FMT_VEC(0) = VECTOR (DEV_NAME.COUNT);
      668    11198    2      FDS.NVECS# = 1;
      669    11199    2      CALL CONCAT (FMT_BUF, '%\%-%NR', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));
      670    11200    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 6;
      671    11201    2      END; /*  Else  */
      672    11202    1   CALL X$FORMAT(FDS);
      673    11203    1   END  ASL$FORMAT_CONNAME;

PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:112  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FORMAT_CONNAME.

   Procedure ASL$FORMAT_CONNAME requires 119 words for executable code.
   Procedure ASL$FORMAT_CONNAME requires 26 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_CONSOLES.:E05TSI    .

PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:113  

 Object Unit name= ASL$FORMAT_CONNAME                         File name= ASL$LIST_CONSOLES.:E05TOU
 UTS= JUL 29 '97 10:07:35.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      3      3  ASL$FORMAT_CONNAME
    2   Proc  even  none   119    167  ASL$FORMAT_CONNAME
    3  RoData even  none     2      2  ASL$FORMAT_CONNAME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  ASL$FORMAT_CONNAME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:114  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     FDS                                   FMT_BUF                               FMT_VEC
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:115  


      579        1        /*T***********************************************************/
      580        2        /*T*                                                         */
      581        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      582        4        /*T*                                                         */
      583        5        /*T***********************************************************/
      584        6        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:116  
      585        7        ASL$FORMAT_CONNAME: PROC (TEXT$C, NUMBER);

      7  2 000000   000000 700200 xent  ASL$FORMAT_* TSX0  ! X66_AUTO_2
         2 000001   000032 000002                    ZERO    26,2

      586        8        /**********************************************************/
      587        9
      588       10        /*D* NAME:     ASL$FORMAT_CONNAME
      589       11             CALL:     CALL ASL$FORMAT_CONNAME ;
      590       12             INPUT:    TEXT$C - A TEXTC string containing the key of the
      591       13                                 last device record read.
      592       14             OUTPUT:   Nothing is returned.
      593       15             DESCRIPTION:  ASL$FORMAT_CONNAME is the routine that
      594       16                           formats the device records key into a device name
      595       17                           that can be recognized and used by a user.
      596       18                           This routine recognizes the following types of
      597       19                           record keys from :HLP:
      598       20                                 type 1 - device records - keys 'xxxxxxxx*'
      599       21                                 type 2 - device records - keys 'ddnn9999'
      600       22                           And will format them like the following:
      601       23                                 type 1 - 'xxxxxxxx'  format - %>A
      602       24                                 type 2 - 'ddnn'      format - %A
      603       25
      604       26                           The keys belong to the following types of devices:
      605       27                                 type 1 - regular devices and tp devices created
      606       28                                          with an account but no name.
      607       29                                 type 2 - devices belonging to a terminal.
      608       30        */
      609       31        /********************************************************************/
      610       32        /*   Include files   include files   include files   include files  */
      611       33        /********************************************************************/
      612       34        %INCLUDE AS_SUPER_C;
      613      469        %INCLUDE AS_SUBS_C;
      614     1883        %INCLUDE AS_MAC_C;
      615     1963        %INCLUDE KL_SUPER_C;
      616     4865        %INCLUDE XU_MACRO_C;
      617     7971        %INCLUDE XU_FORMAT_C;
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:117  
      618     8133        %INCLUDE AS_SUPER_R;
      619    11149        /********************************************************************/
      620    11150        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      621    11151        /********************************************************************/
      622    11152    1   DCL X$FORMAT ENTRY(1);
      623    11153        /********************************************************************/
      624    11154        /*   Parameters      parameters      parameters      parameters     */
      625    11155        /********************************************************************/
      626    11156    1   DCL NUMBER UBIN;
      627    11157    1   DCL 1 TEXT$C,
      628    11158    1          2 COUNT UBIN BYTE UNAL,
      629    11159    1          2 TEXT CHAR(41) UNAL;
      630    11160        /********************************************************************/
      631    11161        /*   Auto data       auto data       auto data       auto data      */
      632    11162        /********************************************************************/
      633    11163    1   DCL ACCT                     CHAR(8);
      634    11164    1   DCL ACCT_LEN                 UBIN;
      635    11165    1   DCL 1 DEV_NAME,
      636    11166    1          2 COUNT               UBIN BYTE UNAL,
      637    11167    1          2 TEXT                CHAR(41) UNAL;
      638    11168    1   DCL LEN                      UBIN;
      639    11169    1   DCL NAME_LEN                 UBIN;
      640    11170    1   DCL NAME                     CHAR(12);
      641    11171        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:118  
      642    11172        /********************************************************************/
      643    11173        /*   Procedure       procedure       procedure       procedure      */
      644    11174        /********************************************************************/
      645    11175    2   IF TEXT$C.COUNT = 8 THEN DO;

  11175  2 000002   200003 470500                    LDP0    @TEXT$C,,AUTO
         2 000003   000100 101500                    MRL     fill='000'O
         2 000004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000005   200030 000004                    ADSC9   NAME+3,,AUTO             cn=0,n=4
         2 000006   200030 236100                    LDQ     NAME+3,,AUTO
         2 000007   000010 116007                    CMPQ    8,DL
         2 000010   000017 601000 2                  TNZ     s:11179

      646    11176    2      DEV_NAME.COUNT = 4;

  11176  2 000011   004000 236003                    LDQ     2048,DU
         2 000012   200010 552140                    STBQ    DEV_NAME,'40'O,AUTO

      647    11177    2      DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,4);

  11177  2 000013   040100 100500                    MLR     fill='040'O
         2 000014   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         2 000015   200010 200051                    ADSC9   DEV_NAME,,AUTO           cn=1,n=41

      648    11178    2      END;  /*  Count = 8  */

  11178  2 000016   000107 710000 2                  TRA     s:11192

      649    11179    2   ELSE IF TEXT$C.COUNT = 9 THEN DO;

  11179  2 000017   000100 101500                    MRL     fill='000'O
         2 000020   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000021   200030 000004                    ADSC9   NAME+3,,AUTO             cn=0,n=4
         2 000022   200030 236100                    LDQ     NAME+3,,AUTO
         2 000023   000011 116007                    CMPQ    9,DL
         2 000024   000041 601000 2                  TNZ     s:11185

PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:119  
      650    11180    2         CALL INDEX (LEN, ' ', SUBSTR (TEXT$C.TEXT,0,8));

  11180  2 000025   000000 124500                    SCM     mask='000'O
         2 000026   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         2 000027   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000030   200023 000100                    ARG     LEN,,AUTO

      651    11181    2         DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,LEN);

  11181  2 000031   200023 720100                    LXL0    LEN,,AUTO
         2 000032   040100 100540                    MLR     fill='040'O
         2 000033   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         2 000034   200010 200051                    ADSC9   DEV_NAME,,AUTO           cn=1,n=41

      652    11182    2         DEV_NAME.COUNT = LEN;

  11182  2 000035   200023 236100                    LDQ     LEN,,AUTO
         2 000036   000033 736000                    QLS     27
         2 000037   200010 552140                    STBQ    DEV_NAME,'40'O,AUTO

      653    11183    2         END; /*  If count = 9  */

  11183  2 000040   000107 710000 2                  TRA     s:11192

      654    11184    2      ELSE DO;

      655    11185    2         CALL INDEX(ACCT_LEN, ' ', SUBSTR(TEXT$C.TEXT,0,8));

  11185  2 000041   000000 124500                    SCM     mask='000'O
         2 000042   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         2 000043   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000044   200007 000100                    ARG     ACCT_LEN,,AUTO

      656    11186    2         ACCT = SUBSTR (TEXT$C.TEXT,0,ACCT_LEN);

  11186  2 000045   200007 720100                    LXL0    ACCT_LEN,,AUTO
         2 000046   040100 100540                    MLR     fill='040'O
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:120  
         2 000047   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         2 000050   200005 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

      657    11187    2         CALL INDEX (NAME_LEN, ' ', SUBSTR(TEXT$C.TEXT,8,12));

  11187  2 000051   000000 124500                    SCM     mask='000'O
         2 000052   000002 200014                    ADSC9   2,,PR0                   cn=1,n=12
         2 000053   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000054   200024 000100                    ARG     NAME_LEN,,AUTO

      658    11188    2         NAME = SUBSTR (TEXT$C.TEXT,8,NAME_LEN);

  11188  2 000055   200024 721100                    LXL1    NAME_LEN,,AUTO
         2 000056   040100 100540                    MLR     fill='040'O
         2 000057   000002 200011                    ADSC9   2,,PR0                   cn=1,n=*X1
         2 000060   200025 000014                    ADSC9   NAME,,AUTO               cn=0,n=12

      659    11189    2         CALL CONCAT (DEV_NAME.TEXT, SUBSTR (ACCT,0,ACCT_LEN), ',', SUBSTR(NAME,0,
             11189                  NAME_LEN));

  11189  2 000061   040100 100540                    MLR     fill='040'O
         2 000062   200005 000010                    ADSC9   ACCT,,AUTO               cn=0,n=*X0
         2 000063   200010 200051                    ADSC9   DEV_NAME,,AUTO           cn=1,n=41
         2 000064   200007 236100                    LDQ     ACCT_LEN,,AUTO
         2 000065   000051 116007                    CMPQ    41,DL
         2 000066   000103 603000 2                  TRC     s:11190
         2 000067   777726 622006                    EAX2    -42,QL
         2 000070   777777 662003                    ERX2    -1,DU
         2 000071   040146 100400                    MLR     fill='040'O
         2 000072   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000073   200010 200012                    ADSC9   DEV_NAME,Q,AUTO          cn=1,n=*X2
         2 000074   000050 116007                    CMPQ    40,DL
         2 000075   000103 603000 2                  TRC     s:11190
         2 000076   777727 623006                    EAX3    -41,QL
         2 000077   777777 663003                    ERX3    -1,DU
         2 000100   040146 100540                    MLR     fill='040'O
         2 000101   200025 000011                    ADSC9   NAME,,AUTO               cn=0,n=*X1
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:121  
         2 000102   200010 400013                    ADSC9   DEV_NAME,Q,AUTO          cn=2,n=*X3

      660    11190    2         DEV_NAME.COUNT = ACCT_LEN + NAME_LEN + 1;

  11190  2 000103   200024 036100                    ADLQ    NAME_LEN,,AUTO
         2 000104   000001 036007                    ADLQ    1,DL
         2 000105   000033 736000                    QLS     27
         2 000106   200010 552140                    STBQ    DEV_NAME,'40'O,AUTO

      661    11191    2         END; /*   Else  */

      662    11192    2   IF NUMBER = 0 THEN DO;

  11192  2 000107   200004 471500                    LDP1    @NUMBER,,AUTO
         2 000110   100000 235100                    LDA     0,,PR1
         2 000111   000132 601000 2                  TNZ     s:11197

      663    11193    2      CALL CONCAT (FMT_BUF, '%\', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));

  11193  2 000112   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000113   000033 772000                    QRL     27
         2 000114   000000 220000 1                  LDX0    0
         2 000115   000000 740000 xsym               STX0    FMT_BUF
         2 000116   000000 621006                    EAX1    0,QL
         2 000117   040000 100540                    MLR     fill='040'O
         2 000120   200010 200011                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X1
         2 000121   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      664    11194    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 1;

  11194  2 000122   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000123   000033 772000                    QRL     27
         2 000124   000001 036007                    ADLQ    1,DL
         2 000125   000020 736000                    QLS     16
         2 000126   000000 676000 xsym               ERQ     FDS
         2 000127   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000130   000000 656000 xsym               ERSQ    FDS
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:122  

      665    11195    2      END; /*  Number = 0  */

  11195  2 000131   000162 710000 2                  TRA     s:11202

      666    11196    2   ELSE DO;

      667    11197    2      FMT_VEC(0) = VECTOR (DEV_NAME.COUNT);

  11197  2 000132   177640 235007                    LDA     65440,DL
         2 000133   200030 452500                    STP2    NAME+3,,AUTO
         2 000134   200030 236100                    LDQ     NAME+3,,AUTO
         2 000135   000010 036003                    ADLQ    8,DU
         2 000136   000000 755000 xsym               STA     FMT_VEC
         2 000137   000001 756000 xsym               STQ     FMT_VEC+1

      668    11198    2      FDS.NVECS# = 1;

  11198  2 000140   000001 235007                    LDA     1,DL
         2 000141   000011 755000 xsym               STA     FDS+9

      669    11199    2      CALL CONCAT (FMT_BUF, '%\%-%NR', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));

  11199  2 000142   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000143   000033 772000                    QRL     27
         2 000144   040000 100400                    MLR     fill='040'O
         2 000145   000001 000007 1                  ADSC9   1                        cn=0,n=7
         2 000146   000000 000007 xsym               ADSC9   FMT_BUF                  cn=0,n=7
         2 000147   000000 620006                    EAX0    0,QL
         2 000150   040000 100540                    MLR     fill='040'O
         2 000151   200010 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X0
         2 000152   000001 600370 xsym               ADSC9   FMT_BUF+1                cn=3,n=248

      670    11200    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 6;

  11200  2 000153   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000154   000033 772000                    QRL     27
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:123  
         2 000155   000006 036007                    ADLQ    6,DL
         2 000156   000020 736000                    QLS     16
         2 000157   000000 676000 xsym               ERQ     FDS
         2 000160   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000161   000000 656000 xsym               ERSQ    FDS

      671    11201    2      END; /*  Else  */

      672    11202    1   CALL X$FORMAT(FDS);

  11202  2 000162   000001 630400 3                  EPPR0   1
         2 000163   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000164   000000 701000 xent               TSX1    X$FORMAT
         2 000165   000000 011000                    NOP     0

      673    11203    1   END  ASL$FORMAT_CONNAME;

  11203  2 000166   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:124  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FORMAT_CONNAME.
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:125  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @NUMBER                    3-0-0/w PTR         r     1 @TEXT$C
     5-0-0/c CHAR(8)     r     1 ACCT                       7-0-0/w UBIN        r     1 ACCT_LEN
    10-0-0/c STRC(378)   r     1 DEV_NAME                  23-0-0/w UBIN        r     1 LEN
    25-0-0/c CHAR(12)    r     1 NAME                      24-0-0/w UBIN        r     1 NAME_LEN
    *0-0-0/w UBIN        r     1 NUMBER                    *0-0-0/c STRC(378)   r     1 TEXT$C

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)


   Procedure ASL$FORMAT_CONNAME requires 119 words for executable code.
   Procedure ASL$FORMAT_CONNAME requires 26 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_CONSOLES.:E05TSI    .
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:126  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:127  
          MINI XREF LISTING

ACCT
     11163**DCL     11186<<ASSIGN  11189>>CALLBLT
ACCT_LEN
     11164**DCL     11185<<CALLBLT 11186>>ASSIGN  11189>>CALLBLT 11190>>ASSIGN
ASA_BRKS_LOC
      8297**DCL      8297--REDEF
AS_DEFAULT.BANNER_PERM
      8990**DCL      8991--REDEF
AS_DEFAULT.BUDGET.MACCT
      8895**DCL      8899--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
      8908**DCL      8911--REDEF
AS_DEFAULT.BUDGET.PACCUM
      8891**DCL      8893--REDEF
AS_DEFAULT.BUDGET.PMAXC
      8886**DCL      8888--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
      9006**DCL      9007--REDEF    9008--REDEF
AS_DEFAULT_DREC.PASSWORD
     10260**DCL     10264--REDEF
AS_DEFAULT_DREC.RENAME
     10283**DCL     10284--REDEF
AS_DFLT.BANNER_PERM
      8812**DCL      8813--REDEF
AS_DFLT.BUDGET.MACCT
      8717**DCL      8721--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
      8730**DCL      8733--REDEF
AS_DFLT.BUDGET.PACCUM
      8713**DCL      8715--REDEF
AS_DFLT.BUDGET.PMAXC
      8708**DCL      8710--REDEF
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:128  
AS_DFLT.SETUP_CHRA.TXT
      8828**DCL      8829--REDEF    8830--REDEF
AS_FE_MODE
      8163**DCL      8164--REDEF
AS_MODE
      8160**DCL      8162--REDEF
AS_MOD_USER.ACCESS
     11025**DCL     11026--REDEF
AS_MOD_USER.BANNER
     11012**DCL     11013--REDEF
AS_MOD_USER.BANNER_PERM
     11014**DCL     11015--REDEF
AS_MOD_USER.BILL
     11020**DCL     11021--REDEF
AS_MOD_USER.CPROC
     11016**DCL     11017--REDEF
AS_MOD_USER.FEBILL
     11096**DCL     11097--REDEF
AS_MOD_USER.FECXTMEM
     11113**DCL     11114--REDEF
AS_MOD_USER.FEMINTS
     11098**DCL     11099--REDEF
AS_MOD_USER.FEMMEM
     11109**DCL     11110--REDEF
AS_MOD_USER.FEMTIME
     11107**DCL     11108--REDEF
AS_MOD_USER.FEPPRIV
     11104**DCL     11106--REDEF
AS_MOD_USER.FEPRIV
     11101**DCL     11103--REDEF
AS_MOD_USER.FORCE_BIT
     11010**DCL     11011--REDEF
AS_MOD_USER.KEY
     11092**DCL     11094--REDEF
AS_MOD_USER.LASTCPROC
     11018**DCL     11019--REDEF
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:129  
AS_MOD_USER.LIMITS.DO_
     11066**DCL     11067--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     11082**DCL     11083--REDEF
AS_MOD_USER.LIMITS.LO
     11062**DCL     11063--REDEF
AS_MOD_USER.LIMITS.MEM
     11058**DCL     11059--REDEF
AS_MOD_USER.LIMITS.MPRIO
     11086**DCL     11087--REDEF
AS_MOD_USER.LIMITS.PDIS
     11074**DCL     11075--REDEF
AS_MOD_USER.LIMITS.PO
     11070**DCL     11071--REDEF
AS_MOD_USER.LIMITS.TDIS
     11078**DCL     11079--REDEF
AS_MOD_USER.LIMITS.TIME
     11054**DCL     11055--REDEF
AS_MOD_USER.MAXENQ
     11035**DCL     11036--REDEF
AS_MOD_USER.PERM_BIT
     11008**DCL     11009--REDEF
AS_MOD_USER.PPRIV
     11030**DCL     11032--REDEF
AS_MOD_USER.PRIOB
     11037**DCL     11038--REDEF
AS_MOD_USER.PRIV
     11027**DCL     11029--REDEF
AS_MOD_USER.QUAN
     11033**DCL     11034--REDEF
AS_MOD_USER.SETUP
     11006**DCL     11007--REDEF
AS_PROJECT.BANNER_PERM
      9346**DCL      9347--REDEF
AS_PROJECT.BUDGET.MACCT
      9251**DCL      9255--REDEF
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:130  
AS_PROJECT.BUDGET.MAX_PROJECTS
      9264**DCL      9267--REDEF
AS_PROJECT.BUDGET.PACCUM
      9247**DCL      9249--REDEF
AS_PROJECT.BUDGET.PMAXC
      9242**DCL      9244--REDEF
AS_PROJECT.SETUP_CHRA.TXT
      9362**DCL      9363--REDEF    9364--REDEF
AS_PROJECT_DFLT.BANNER_PERM
      9524**DCL      9525--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
      9429**DCL      9433--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
      9442**DCL      9445--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
      9425**DCL      9427--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
      9420**DCL      9422--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
      9540**DCL      9541--REDEF    9542--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     10746**DCL     10750--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     10769**DCL     10770--REDEF
AS_PROJECT_DREC.PASSWORD
     10584**DCL     10588--REDEF
AS_PROJECT_DREC.RENAME
     10607**DCL     10608--REDEF
AS_PROJ_ADMIN.BANNER_PERM
      9168**DCL      9169--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
      9073**DCL      9077--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
      9086**DCL      9089--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
      9069**DCL      9071--REDEF
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:131  
AS_PROJ_ADMIN.BUDGET.PMAXC
      9064**DCL      9066--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
      9184**DCL      9185--REDEF    9186--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     10422**DCL     10426--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     10445**DCL     10446--REDEF
AS_USERS.BANNER_PERM
      8634**DCL      8635--REDEF
AS_USERS.BUDGET.MACCT
      8539**DCL      8543--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
      8552**DCL      8555--REDEF
AS_USERS.BUDGET.PACCUM
      8535**DCL      8537--REDEF
AS_USERS.BUDGET.PMAXC
      8530**DCL      8532--REDEF
AS_USERS.SETUP_CHRA.TXT
      8650**DCL      8651--REDEF    8652--REDEF
AS_USERS_CONSTANT.BANNER_PERM
      9702**DCL      9703--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
      9607**DCL      9611--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
      9620**DCL      9623--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
      9603**DCL      9605--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
      9598**DCL      9600--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
      9718**DCL      9719--REDEF    9720--REDEF
DEV_NAME.COUNT
     11166**DCL     11176<<ASSIGN  11182<<ASSIGN  11190<<ASSIGN  11193>>CALLBLT 11194>>ASSIGN  11197--ASSIGN
     11199>>CALLBLT 11200>>ASSIGN
DEV_NAME.TEXT
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:132  
     11167**DCL     11177<<ASSIGN  11181<<ASSIGN  11189<<CALLBLT 11193>>CALLBLT 11199>>CALLBLT
ERR_CODE
      8292**DCL      8293--REDEF
FDS
      8189**DCL     11202<>CALL
FDS.FMT_.BOUND
      8194**DCL     11194<<ASSIGN  11200<<ASSIGN
FDS.NVECS#
      8217**DCL     11198<<ASSIGN
FMT_BUF
      8288**DCL     11193<<CALLBLT 11199<<CALLBLT
FMT_VEC
      8288**DCL     11197<<ASSIGN
KL_DEFAULT.PASSWORD
     10908**DCL     10912--REDEF
KL_DEFAULT.RENAME
     10931**DCL     10932--REDEF
KL_DFLT.PASSWORD
     10098**DCL     10102--REDEF
KL_DFLT.RENAME
     10121**DCL     10122--REDEF
KL_DREC.PASSWORD
      9936**DCL      9940--REDEF
KL_DREC.RENAME
      9959**DCL      9960--REDEF
KL_DREC_CNT.PASSWORD
      9823**DCL      9827--REDEF
KL_DREC_CNT.RENAME
      9846**DCL      9847--REDEF
LEN
     11168**DCL     11180<<CALLBLT 11181>>ASSIGN  11182>>ASSIGN
NAME
     11170**DCL     11188<<ASSIGN  11189>>CALLBLT
NAME_LEN
     11169**DCL     11187<<CALLBLT 11188>>ASSIGN  11189>>CALLBLT 11190>>ASSIGN
NUMBER
PL6.E3A0      #002=ASL$FORMAT_CONNAME File=ASL$LIST_CONSOLES.:E05TSI             TUE 07/29/97 10:07 Page:133  
     11156**DCL         7--PROC    11192>>IF
PROJ_KEY.TEXT
      8170**DCL      8170--REDEF
PROJ_KEY.TXT.PROJECT
      8170**DCL      8170--REDEF
REMEM_VAR
      8296**DCL      8296--REDEF
REM_FCMD
      8296**DCL      8297--REDEF
TEXT$C
     11157**DCL         7--PROC
TEXT$C.COUNT
     11158**DCL     11175>>IF      11179>>IF
TEXT$C.TEXT
     11159**DCL     11177>>ASSIGN  11180>>CALLBLT 11181>>ASSIGN  11185>>CALLBLT 11186>>ASSIGN  11187>>CALLBLT
     11188>>ASSIGN
USERS_KEY.TEXT
      8167**DCL      8168--REDEF    8168--REDEF    8168--REDEF    8169--REDEF
X$FORMAT
     11152**DCL-ENT 11202--CALL
