VERSION E05

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:1    
        1        1        /*M*     KZT$3270IO - Line driver code for 3270 and passthru       */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  */
        8        8
        9        9        KZT$3270IO: PROC (KZ@LINCTX,KZ@BSCFPT) ALTRET;
       10       10
       11       11        %INCLUDE LCP_6;
       12     4290        %INCLUDE KV_GLBCNS_E;
       13     4631        %INCLUDE KZ$LINCTX;
       14     5251        %INCLUDE KZ$OTPBFR;
       15     5352        %INCLUDE KZ_BSCFPT;
       16     5382        %INCLUDE KZ_CLM_E;
       17     5554        %INCLUDE KZ_3270M_C;
       18     6411        %INCLUDE KZ_LIN_C;
       19     6467        %INCLUDE KZ_MLCP_C;
       20     6542        %INCLUDE KZ_3270_C;
       21     6700        %INCLUDE KZ_PERR_C;
       22     6782        %INCLUDE KZ$3270STT;
       23     6846        %INCLUDE KZ$BSCSTT;
       24     6952        %INCLUDE KH$STT;
       25     6982        %INCLUDE KH_CLKFNC_E;
       26     7027        %INCLUDE KH$CLK;
       27     7397        %INCLUDE KL_MACRO_C;
       28    10749        %INCLUDE KL_SUPER_C;
       29    13651        %INCLUDE KL_AFCN_C;
       30    13752        %INCLUDE K_ID_E;
       31    13802        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:2    
       32    13803        %KV_INPOPRX_E;
       33    13815        %KZ_3270_E;
       34    13943        %KZ$LINCTX (NAME=KZ@LINCTX,STCLASS="");
       35    14374        %KZ_BSCFPT (NAME=KZ@BSCFPT,STCLASS="");
       36    14383        %KZ_BSCFPTEQUS;
       37    14389        %KZ$OTPBFR (NAME=KZ$OTPBFR,STCLASS=BASED);
       38    14454        %K#ENTID_E;
       39    14473        %KZ_3270M_HDR (STCLASS=SYMREF);
       40    14497        %KZ$3270STT (STCLASS="BASED(KZ_3270M_HDR.STTBFR$)");
       41    14929        %KZ$EVENT (FPTN=KZ_EVENT,STCLASS=CONSTANT);
       42    15011        %KZ$EVENT (STCLASS="");
       43    15093        %KH$CLK (FPTN=KH_CLK_SET,FNC=%KH#CLK_SETCLK,STCLASS=CONSTANT);
       44    15242        %KH$CLK (STCLASS="");
       45    15391
       46    15392    1   DCL CTR(0:0) UBIN BYTE BASED CALIGNED;
       47    15393    1   DCL TIME UBIN(32) ALIGNED;
       48    15394    1   DCL 1 TINY_TIME_PARTICLES REDEF TIME,
       49    15395    1         2 WD1 UBIN WORD,
       50    15396    1         2 WD2 UBIN WORD;
       51    15397    1   DCL TEMP_BIT16 BIT(16) ALIGNED;
       52    15398    1   DCL I REDEF TEMP_BIT16 UBIN;
       53    15399    1   DCL TSIZE UBIN;
       54    15400    1   DCL T$ PTR;
       55    15401
       56    15402    1   DCL KZT_GO@ EPTR SYMREF;
       57    15403    1   DCL KZT_ORDERS@ EPTR SYMREF;
       58    15404    1   DCL KZV$DSC_LINE ENTRY (1) ALTRET;
       59    15405    1   DCL KHC$CLOCK ENTRY (1) ALTRET;
       60    15406    1   DCL KHC$TIME2 ENTRY (1) ALTRET;
       61    15407    1   DCL KVB$GETSYS ENTRY (2) ALTRET;
       62    15408    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
       63    15409        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:3    
       64    15410    1           KZ$EVENT=KZ_EVENT;
       65    15411    1           KZ$EVENT.LINCTX$=ADDR(KZ@LINCTX);
       66    15412    2           DO CASE ( KZ@BSCFPT.ACT );
       67    15413    2            CASE ( %KZ#3270ACT_INIT );
       68    15414
       69    15415    2              KZ@BSCFPT.FNC = %KZ#FNC_DSC;
       70    15416    2              ALTRETURN;
       71    15417        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:4    
       72    15418    2            CASE ( %KZ#3270ACT_RQSCTR );
       73    15419
       74    15420    2              KZ@LINCTX.OPR = %KZ#3270_OPR_RQSCTR;
       75    15421    2              IF KZ@LINCTX.ACTCTR = 0 THEN
       76    15422    2                 KZ@LINCTX.FLAGS.CTRINITDONE = '0'B;
       77    15423
       78    15424    2   RQSCTR:
       79    15425    2              KZ$EVENT.EVENT=%KZ#LINFCN_INACT_CTR;
       80    15426    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)
       81    15427    2                ALTRET ( RQSCTR_DONE );
       82    15428    2              IF NOT KZ@LINCTX.FLAGS.CTRINITDONE AND
       83    15429    3                KZ@LINCTX.POLX = KZ@LINCTX.POLSIZ-1 THEN DO;
       84    15430    3                 CALL KHC$TIME2 (TIME);
       85    15431    3                 KZ@LINCTX.TIMER.POL = TIME;
       86    15432    3                 KZ@LINCTX.TIMR.GENPOL = TIME;
       87    15433    3                 KZ@LINCTX.TIMR.SPCPOL = TIME - 120*30;
       88    15434    3                 KZ@LINCTX.FLAGS.CTRINITDONE = '1'B;
       89    15435    3                 END;
       90    15436    2              KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);
       91    15437    2              KZ@LINCTX.OTPDATSIZ = 1;
       92    15438    2              KZ@LINCTX.OTPBFRSIZ = 0;
       93    15439    2              CALL KZT_ORDERS@ ( %KZ#SEND_GEPOLL, KZ@LINCTX );
       94    15440    2              GOTO RQSCTR_EXIT;
       95    15441
       96    15442    2   RQSCTR_DONE:
       97    15443    3              IF NOT KZ@LINCTX.FLAGS.CTRINITDONE THEN DO;
       98    15444    3                 CALL KHC$TIME2 (TIME);
       99    15445    3                 KZ@LINCTX.TIMER.POL = TIME;
      100    15446    3                 KZ@LINCTX.TIMR.GENPOL = TIME;
      101    15447    3                 KZ@LINCTX.TIMR.SPCPOL = TIME - 120*30;
      102    15448    3                 KZ@LINCTX.FLAGS.CTRINITDONE = '1'B;
      103    15449    3                 END;
      104    15450    2              IF KZ@LINCTX.ACTCTR = 0 THEN
      105    15451    2                 GOTO RQSCTR;
      106    15452    2              KZ@LINCTX.OPR = 0;
      107    15453    2              KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      108    15454    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:5    
      109    15455    2              ALTRETURN;
      110    15456    2   RQSCTR_EXIT:;
      111    15457        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:6    
      112    15458    2            CASE ( %KZ#3270ACT_SPCPOLCTR );
      113    15459
      114    15460    2              KZ@LINCTX.OPR = %KZ#3270_OPR_SPCPOLCTR;
      115    15461    2              KZ$EVENT.EVENT=%KZ#LINFCN_NEWCTR;
      116    15462    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)
      117    15463    2                ALTRET ( SPCPOLCTR_END );
      118    15464    2              GOTO SPCPOL;
      119    15465
      120    15466    2   SPCPOLCTR_END:
      121    15467    2              IF KZ@LINCTX.FLAGS.CTRINITDONE THEN
      122    15468    2                 KZ@BSCFPT.EVT = %KZ#3270EVT_POL; /* GENPOL                      */
      123    15469    2              ELSE
      124    15470    2                 KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      125    15471    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      126    15472    2              ALTRETURN;
      127    15473        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:7    
      128    15474    2            CASE ( %KZ#3270ACT_SPCPOLALL );
      129    15475
      130    15476    2              KZ$EVENT.EVENT=%KZ#LINFCN_SPCPOLALL;
      131    15477    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)
      132    15478    2                ALTRET(END_SPCPOLALL);
      133    15479    2              KZ@LINCTX.OPR = %KZ#3270_OPR_SPCPOLALL;
      134    15480    2              GOTO SPCPOL;
      135    15481
      136    15482    2   END_SPCPOLALL:
      137    15483    2              KZ@LINCTX.OPR = 0;
      138    15484    2              KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      139    15485    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      140    15486    2              ALTRETURN;
      141    15487        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:8    
      142    15488    2            CASE ( %KZ#3270ACT_SELPOL );
      143    15489
      144    15490    2              KZ@LINCTX.OPR = 0;
      145    15491    2              IF KZ@BSCFPT.EVT = %KZ#3270EVT_GO OR
      146    15492    2                KZ@BSCFPT.EVT = %KZ#3270EVT_EOT THEN
      147    15493    3              DO;
      148    15494    3                 KZ$EVENT.EVENT=%KZ#LINFCN_GETOTP;
      149    15495    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)
      150    15496    3                   ALTRET ( CANT_GET_OTP );
      151    15497    3                 END;
      152    15498    2              ELSE
      153    15499    2                 IF KZ@BSCFPT.EVT=%KZ#3270EVT_RCVERR THEN
      154    15500    3                 DO;
      155    15501    3                    KZ@LINCTX.RTRCNT=KZ@LINCTX.RTRCNT+1;
      156    15502    3                    IF KZ@LINCTX.PRO.RETRYS>0 AND
      157    15503    3                      KZ@LINCTX.RTRCNT>KZ@LINCTX.PRO.RETRYS THEN
      158    15504    4                    DO;
      159    15505    4                       KZ@BSCFPT.EVT=%KZ#3270EVT_TIMOUT;
      160    15506    4                       KZ@BSCFPT.FNC=%KZ#FNC_MOV;
      161    15507    4                       ALTRETURN;
      162    15508    4                       END;
      163    15509    3                    END;
      164    15510    2              KZ$3270STT.SEL = KZ$3270STT.SEL + 1;
      165    15511    2              KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);
      166    15512    2              KZ@LINCTX.OTPDATSIZ = 2;
      167    15513    2              KZ@LINCTX.OTPBFRSIZ = 0;
      168    15514    2              CALL KZT_ORDERS@ ( %KZ#SEND_SEPOLL, KZ@LINCTX );
      169    15515    2              GOTO SELPOL_EXIT;
      170    15516    2   CANT_GET_OTP:;
      171    15517    2              KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      172    15518    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      173    15519    2              ALTRETURN;
      174    15520    2   SELPOL_EXIT:;
      175    15521        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:9    
      176    15522    2            CASE ( %KZ#3270ACT_SPCPOL );
      177    15523
      178    15524    2              KZ$EVENT.EVENT=%KZ#LINFCN_REQOTP;
      179    15525    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
      180    15526    2              KZ$EVENT.EVENT=%KZ#LINFCN_SPCPOL;
      181    15527    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
      182    15528    2   SPCPOL:
      183    15529    2              KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);
      184    15530    2              KZ@LINCTX.OTPDATSIZ = 2;
      185    15531    2              KZ@LINCTX.OTPBFRSIZ = 0;
      186    15532    2              CALL KZT_ORDERS@ ( %KZ#SEND_SPPOLL, KZ@LINCTX );
      187    15533        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:10   
      188    15534    2            CASE ( %KZ#3270ACT_GENPOL );
      189    15535    2              IF KZ@BSCFPT.OLDSTT ~= %KZ#M3270STT_EOT THEN
      190    15536    3              DO;
      191    15537    3                 KZ$EVENT.EVENT=%KZ#LINFCN_POLL_ANSWERED;
      192    15538    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
      193    15539    3                 END;
      194    15540    2              KZ@LINCTX.CURCTR$ = ADDR(NIL);
      195    15541    2              KZ@LINCTX.CURDEV$ = ADDR(NIL);
      196    15542    2              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_EOT AND
      197    15543    3                KZ@BSCFPT.EVT ~= %KZ#3270EVT_POL THEN DO;
      198    15544    3   GENPOL:       KZ@LINCTX.POLX = 0;
      199    15545    3                 KZ$3270STT.GENPOL = KZ$3270STT.GENPOL + 1;
      200    15546    3                 CALL KHC$TIME2 (TIME);
      201    15547    4                 IF TIME - KZ@LINCTX.TIMR.SPCPOL >= 120*60 THEN DO;
      202    15548    4                    KZ@LINCTX.TIMR.SPCPOL = TIME;
      203    15549    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_POLALL;
      204    15550    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      205    15551    4                    ALTRETURN;
      206    15552    4                    END;
      207    15553    4                 IF TIME - KZ@LINCTX.TIMER.POL >= 120*120 THEN DO;
      208    15554    4                    KZ@LINCTX.TIMER.POL = TIME;
      209    15555    4                    KZ@LINCTX.OPR = %KZ#3270_OPR_RQSCTR;
      210    15556    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_POLINACT;
      211    15557    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      212    15558    4                    ALTRETURN;
      213    15559    4                    END;
      214    15560    3                 KZ@LINCTX.TIMR.GENPOL = TIME;
      215    15561    3                 KZ@LINCTX.OPR = %KZ#3270_OPR_GENPOL;
      216    15562    3                 END;
      217    15563    2              ELSE
      218    15564    2   GENPOLNXT:    KZ@LINCTX.POLX = KZ@LINCTX.POLX + 1;
      219    15565    3              IF KZ@LINCTX.POLX < KZ@LINCTX.POLSIZ THEN DO;
      220    15566    3                 KZ@LINCTX.POLADR.CTR = KZ@LINCTX.POLLST$ ->
      221    15567    3                   CTR(KZ@LINCTX.POLX);
      222    15568    3                 IF KZ@LINCTX.POLADR.CTR = 0 THEN
      223    15569    3                    GOTO GENPOLNXT;        /* This one not active                */
      224    15570    3                 KZ@LINCTX.POLADR.DEV = BITBIN('00'X);
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:11   
      225    15571    3                 KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);
      226    15572    3                 KZ@LINCTX.OTPDATSIZ = 1;
      227    15573    3                 KZ@LINCTX.OTPBFRSIZ = 0;
      228    15574    3                 CALL KZT_ORDERS@ ( %KZ#SEND_GEPOLL, KZ@LINCTX);
      229    15575    3                 END;
      230    15576    3              ELSE DO;
      231    15577    3                 KZ@LINCTX.POLX = 0;
      232    15578    3                 KZ@LINCTX.OPR = 0;
      233    15579    4                 IF KZ@LINCTX.ACTCTR = 0 THEN DO;
      234    15580    4                    KZ@LINCTX.FLAGS.CTRINITDONE = '0'B;
      235    15581    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_POLINACT;
      236    15582    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      237    15583    4                    ALTRETURN;
      238    15584    4                    END;
      239    15585    3                 IF KZ@LINCTX.OTPCNT = 0 THEN
      240    15586    3                    GOTO NO_OTP;           /* Try to save some overhead          */
      241    15587    3                 KZ$EVENT.EVENT=%KZ#LINFCN_GETOTP;
      242    15588    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)
      243    15589    3                   ALTRET ( NO_OTP );
      244    15590    3                 KZ$3270STT.SNDOTP = KZ$3270STT.SNDOTP + 1;
      245    15591    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SNDOTP;
      246    15592    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      247    15593    3                 ALTRETURN;
      248    15594
      249    15595    3   NO_OTP:       CALL KHC$TIME2 (TIME);
      250    15596    3                 IF TIME - KZ@LINCTX.TIMR.GENPOL >= KZ@LINCTX.PRO.INTERVAL THEN
      251    15597    3                    GOTO GENPOL;
      252    15598    3                 KZ$3270STT.WAT = KZ$3270STT.WAT + 1;
      253    15599    3                 KH$CLK=KH_CLK_SET;
      254    15600    3                 KH$CLK.PRDUNT = %KH#C_TMIL;
      255    15601    3                 KH$CLK.UID$ = ADDR(KZ@LINCTX);
      256    15602    3                 KH$CLK.SBR$ = KZT_GO@;
      257    15603    3                 TIME = KZ@LINCTX.PRO.INTERVAL -
      258    15604    3                   TIME + KZ@LINCTX.TIMR.GENPOL;
      259    15605    3                 TINY_TIME_PARTICLES.WD2 = (TINY_TIME_PARTICLES.WD2*5)/6;
      260    15606    3                 IF TINY_TIME_PARTICLES.WD2=0 THEN
      261    15607    3                    TINY_TIME_PARTICLES.WD2=1;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:12   
      262    15608    3                 IF TINY_TIME_PARTICLES.WD2>25500 THEN
      263    15609    3                    TINY_TIME_PARTICLES.WD2=25500;
      264    15610    3                 IF TINY_TIME_PARTICLES.WD2 <= 255 THEN
      265    15611    3                    KH$CLK.PRD = TINY_TIME_PARTICLES.WD2;
      266    15612    4                 ELSE DO;                  /* Must change resolution             */
      267    15613    4                    KH$CLK.PRD = TINY_TIME_PARTICLES.WD2 / 100;
      268    15614    4                    KH$CLK.PRDUNT = %KH#C_SEC;
      269    15615    4                    END;
      270    15616    3                 CALL KHC$CLOCK (KH$CLK) ALTRET (OUCH);
      271    15617    3                 KZ@LINCTX.CTB.PRM$=KH$CLK.CTBCTX$;
      272    15618    3                 KZ@LINCTX.PRMCTBTYP = %KZ#CTBTYP_DELAY;
      273    15619
      274    15620    3                 END;
      275    15621        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:13   
      276    15622    2            CASE ( %KZ#3270ACT_EOT );
      277    15623
      278    15624    3              DO CASE(KZ@LINCTX.OPR);
      279    15625
      280    15626    3               CASE (%KZ#3270_OPR_GENPOL,0);
      281    15627    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_POL; /* GENPOL                      */
      282    15628
      283    15629    3               CASE (%KZ#3270_OPR_SPCPOLALL);
      284    15630    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_POLALL;
      285    15631
      286    15632    3               CASE (%KZ#3270_OPR_SPCPOL);
      287    15633    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SNDOTP;
      288    15634
      289    15635    3               CASE (%KZ#3270_OPR_RQSCTR);
      290    15636    3                 IF KZ@BSCFPT.EVT = %KZ#3270EVT_EOT THEN
      291    15637    3                    KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      292    15638    3                 ELSE
      293    15639    3                    IF NOT KZ@LINCTX.FLAGS.CTRINITDONE THEN
      294    15640    3                       KZ@BSCFPT.EVT = %KZ#3270EVT_POLINACT;
      295    15641    3                    ELSE
      296    15642    3                       KZ@BSCFPT.EVT = %KZ#3270EVT_POL; /* GENPOL                */
      297    15643
      298    15644    3               CASE (%KZ#3270_OPR_SPCPOLCTR);
      299    15645    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      300    15646    3               END;
      301    15647
      302    15648    2              KZ@LINCTX.CURCTR$=ADDR(NIL);
      303    15649    2              KZ@LINCTX.CURDEV$=ADDR(NIL);
      304    15650
      305    15651    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      306    15652    2              ALTRETURN;
      307    15653        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:14   
      308    15654    2            CASE ( %KZ#3270ACT_1STSND,
      309    15655    2                %KZ#3270ACT_EVNSND,
      310    15656    2                %KZ#3270ACT_ODDSND );
      311    15657
      312    15658    2              IF (KZ@BSCFPT.OLDSTT = %KZ#M3270STT_ODDENQSND AND
      313    15659    2                KZ@BSCFPT.EVT = %KZ#3270EVT_ACK0) OR
      314    15660    2                (KZ@BSCFPT.OLDSTT = %KZ#M3270STT_EVNENQSND AND
      315    15661    2                KZ@BSCFPT.EVT = %KZ#3270EVT_ACK1) THEN GOTO SND;
      316    15662    3              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_NAK THEN DO;
      317    15663    4                 IF KZ@LINCTX.RTRCNT~=0 THEN DO;
      318    15664    4                    CALL ERRLOG (%E$3270IO_OK);
      319    15665    4                    KZ@LINCTX.RTRCNT = 0;
      320    15666    4                    END;
      321    15667    3                 IF KZ@BSCFPT.ACT ~= %KZ#3270ACT_1STSND THEN
      322    15668    4                 DO;
      323    15669    4                    KZ$EVENT.EVENT=%KZ#LINFCN_RELOTP;
      324    15670    4                    CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
      325    15671    4                    END;
      326    15672    3                 IF KZ@BSCFPT.EVT=%KZ#3270EVT_RVI THEN
      327    15673    4                 DO;
      328    15674    4                    KZ@BSCFPT.EVT=%KZ#3270EVT_GO;
      329    15675    4                    KZ@BSCFPT.FNC=%KZ#FNC_MOV;
      330    15676    4                    ALTRETURN;
      331    15677    4                    END;
      332    15678    3                 IF KZ@BSCFPT.EVT = %KZ#3270EVT_WACK THEN
      333    15679    4                 DO;
      334    15680    4                    KZ$EVENT.EVENT=%KZ#LINFCN_WAIT;
      335    15681    4                    CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
      336    15682    4                    END;
      337    15683    4                 IF KZ@LINCTX.OTPHD$ = ADDR(NIL) THEN DO;
      338    15684    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      339    15685    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      340    15686    4                    ALTRETURN;
      341    15687    4                    END;
      342    15688    3                 KZ@LINCTX.OTPBFR$ = PINCRW(KZ@LINCTX.OTPHD$,
      343    15689    3                   SIZEW(KZ$OTPBFR));
      344    15690    3                 KZ@LINCTX.OTPDATSIZ = KZ@LINCTX.OTPHD$ ->
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:15   
      345    15691    3                   KZ$OTPBFR.DATA_SIZ;
      346    15692    3   SND:
      347    15693        /*N*               IF KZ@LINCTX.OTPHD$ ~= KZ@LINCTX.OTPTL$ THEN
      348    15694                                CALL KZT_ORDERS@ ( %KZ#SEND_BLOCK, KZ@LINCTX );
      349    15695                           ELSE */
      350    15696    3                 IF KZ@LINCTX.OTPHD$ -> KZ$OTPBFR.FLAGS.TRANS# THEN
      351    15697    3                    CALL KZT_ORDERS@ ( %KZ#SEND_TTEXT, KZ@LINCTX );
      352    15698    3                 ELSE
      353    15699    3                    CALL KZT_ORDERS@ ( %KZ#SEND_TEXT, KZ@LINCTX );
      354    15700    3                 END;
      355    15701    3              ELSE DO;
      356    15702    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;
      357    15703    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND
      358    15704    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;
      359    15705    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;
      360    15706    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      361    15707    4                    ALTRETURN;
      362    15708    4                    END;
      363    15709    3                 ELSE
      364    15710    3                    GOTO SND;
      365    15711    3                 END;
      366    15712        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:16   
      367    15713    2            CASE ( %KZ#3270ACT_1STENQ,
      368    15714    2                   %KZ#3270ACT_ODDENQ,
      369    15715    2                   %KZ#3270ACT_EVNENQ );
      370    15716
      371    15717    2              KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;
      372    15718    2              IF KZ@LINCTX.PRO.RETRYS > 0 AND
      373    15719    3                KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;
      374    15720    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SPARE25;
      375    15721    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      376    15722    3                 ALTRETURN;
      377    15723    3                 END;
      378    15724    2              ELSE
      379    15725    2                 CALL KZT_ORDERS@ ( %KZ#SEND_ENQ, KZ@LINCTX );
      380    15726        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:17   
      381    15727    2            CASE ( %KZ#3270ACT_GNACK1 );
      382    15728
      383    15729    3              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_ENQ THEN DO;
      384    15730    3                 CALL RPTINP;
      385    15731    4                 IF KZ@LINCTX.RTRCNT ~= 0 THEN DO;
      386    15732    4                    CALL ERRLOG (%E$3270IO_OK);
      387    15733    4                    KZ@LINCTX.RTRCNT = 0;
      388    15734    4                    END;
      389    15735    3                 END;
      390    15736    3              ELSE DO;
      391    15737    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;
      392    15738    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND
      393    15739    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;
      394    15740    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;
      395    15741    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      396    15742    4                    ALTRETURN;
      397    15743    4                    END;
      398    15744    3                 END;
      399    15745    2              CALL KZT_ORDERS@ ( %KZ#SEND_ACK1, KZ@LINCTX );
      400    15746        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:18   
      401    15747    2            CASE ( %KZ#3270ACT_GNACK0 );
      402    15748
      403    15749    3              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_ENQ THEN DO;
      404    15750    3                 CALL RPTINP;
      405    15751    4                 IF KZ@LINCTX.RTRCNT ~= 0 THEN DO;
      406    15752    4                    CALL ERRLOG (%E$3270IO_OK);
      407    15753    4                    KZ@LINCTX.RTRCNT = 0;
      408    15754    4                    END;
      409    15755    3                 END;
      410    15756    3              ELSE DO;
      411    15757    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;
      412    15758    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND
      413    15759    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;
      414    15760    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;
      415    15761    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      416    15762    4                    ALTRETURN;
      417    15763    4                    END;
      418    15764    3                 END;
      419    15765    2              CALL KZT_ORDERS@ ( %KZ#SEND_ACK0, KZ@LINCTX );
      420    15766        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:19   
      421    15767    2            CASE ( %KZ#3270ACT_ENQNAK,
      422    15768    2                %KZ#3270ACT_ODDNAK,
      423    15769    2                %KZ#3270ACT_EVNNAK );
      424    15770
      425    15771    2              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_TTD THEN
      426    15772    2                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;
      427    15773
      428    15774    2              IF KZ@LINCTX.PRO.RETRYS > 0 AND
      429    15775    3                KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;
      430    15776    3                 CALL KZT_ORDERS@ ( %KZ#SEND_EOT, KZ@LINCTX );
      431    15777    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;
      432    15778    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      433    15779    3                 ALTRETURN;
      434    15780    3                 END;
      435    15781    2              ELSE
      436    15782    2                 CALL KZT_ORDERS@ ( %KZ#SEND_NAK, KZ@LINCTX );
      437    15783        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:20   
      438    15784    2            CASE ( %KZ#3270ACT_LISTEN );
      439    15785
      440    15786    2              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_GO THEN
      441    15787    2                 CALL KZT_ORDERS@ ( %KZ#SEND_NOTHING, KZ@LINCTX );
      442    15788    2              ELSE
      443    15789    2                 CALL KZT_ORDERS@ ( %KZ#SEND_EOT, KZ@LINCTX );
      444    15790        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:21   
      445    15791    2            CASE ( %KZ#3270ACT_POL_RCVD );
      446    15792
      447    15793    2              KZ@LINCTX.FLAGS.CTRINITDONE = '1'B;
      448    15794    2              KZ@LINCTX.INPDATSIZ = KZ@BSCFPT.SIZ;
      449    15795    2              KZ$EVENT.EVENT=%KZ#LINFCN_POL;
      450    15796    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT,I);
      451    15797    3              DO CASE (I);
      452    15798    3               CASE (%KZ#LINRSP_EOT);
      453    15799    4                 IF KZ@LINCTX.PRO.INTERVAL~=0 THEN DO;
      454    15800    4                    KH$CLK=KH_CLK_SET;
      455    15801    4                    KH$CLK.PRDUNT=%KH#C_TMIL;
      456    15802    4                    KH$CLK.PRD=(KZ@LINCTX.PRO.INTERVAL*100)/120;
      457    15803    4                    KH$CLK.UID$=ADDR(KZ@LINCTX);
      458    15804    4                    KH$CLK.SBR$=KZT_GO@;
      459    15805    4                    IF KH$CLK.PRD=0 THEN KH$CLK.PRD=1;
      460    15806    4                    CALL KHC$CLOCK (KH$CLK) ALTRET (OUCH);
      461    15807    4                    KZ@LINCTX.CTB.PRM$=KH$CLK.CTBCTX$;
      462    15808    4                    KZ@LINCTX.PRMCTBTYP = %KZ#CTBTYP_DELAY;
      463    15809    4                    END;
      464    15810    4                 ELSE DO;
      465    15811    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_GO;
      466    15812    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      467    15813    4                    ALTRETURN;
      468    15814    4                    END;
      469    15815    3               CASE (%KZ#LINRSP_DAT);
      470    15816    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SNDOTP;
      471    15817    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      472    15818    3                 ALTRETURN;
      473    15819    3               CASE (%KZ#LINRSP_ACK);
      474    15820    3                 CALL KZT_ORDERS@ ( %KZ#SEND_ACK0, KZ@LINCTX );
      475    15821    3               CASE (%KZ#LINRSP_NUL);
      476    15822    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_EOTCMP;
      477    15823    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      478    15824    3                 ALTRETURN;
      479    15825    3               END;
      480    15826        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:22   
      481    15827    2            CASE ( %KZ#3270ACT_TIMOUT );
      482    15828
      483    15829    3              IF KZ@LINCTX.ACTCTR = 0 THEN DO;
      484    15830    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;
      485    15831    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND
      486    15832    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;
      487    15833    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;
      488    15834    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      489    15835    4                    ALTRETURN;
      490    15836    4                    END;
      491    15837    3                 END;
      492    15838    3              IF NOT KZ@LINCTX.PRO.SLAVE THEN DO;
      493    15839    3                 KZ$EVENT.EVENT=%KZ#LINFCN_POLTIMOUT;
      494    15840    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
      495    15841    3                 END;
      496    15842    2              KZ@BSCFPT.EVT = %KZ#3270EVT_EOTCMP; /* NO NEED TO SEND EOT         */
      497    15843    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;
      498    15844    2              ALTRETURN;
      499    15845
      500    15846    2            END;
      501    15847    1           RETURN;
      502    15848    1   OUCH:   CALL SCREECH;
      503    15849        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:23   
      504    15850    1   RPTINP: PROC;
      505    15851
      506    15852    2           IF KZ@BSCFPT.SIZ > 0 THEN
      507    15853    2              KZ@LINCTX.INPDATSIZ = KZ@BSCFPT.SIZ - 1; /* DON'T COUNT ETX/ETB    */
      508    15854    2           ELSE KZ@LINCTX.INPDATSIZ = 0;
      509    15855    2           IF KZ@BSCFPT.EVT = %KZ#3270EVT_TSTRQS OR
      510    15856    3             KZ@LINCTX.CNTTSTRQS THEN DO;
      511    15857    3              KZ@LINCTX.CURDEV$ = ADDR(NIL);
      512    15858    3              KZ@LINCTX.CURCTR$ = ADDR(NIL);
      513    15859    3              IF KZ@LINCTX.INPBFR$->CTR(KZ@LINCTX.INPDATSIZ)=3 /*ETX*/
      514    15860    3              THEN KZ@LINCTX.CNTTSTRQS='0'B;
      515    15861    3              ELSE KZ@LINCTX.CNTTSTRQS='1'B;
      516    15862    3              RETURN;                      /* Ignore test-request                */
      517    15863    3              END;
      518    15864    3           IF KZ@BSCFPT.EVT = %KZ#3270EVT_STATUS THEN DO;
      519    15865    3              KZ$EVENT.EVENT=%KZ#LINFCN_STATUS;
      520    15866    3              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
      521    15867    3              END;
      522    15868    3           ELSE DO;
      523    15869    3              TEMP_BIT16 = '0'B;
      524    15870    3              IF KZ@LINCTX.FLAGS.FIRST THEN
      525    15871    3                 TEMP_BIT16 = %KZ#LINSTAT_FIRST;
      526    15872    4              IF KZ@BSCFPT.EVT = %KZ#3270EVT_ETXBLK THEN DO;
      527    15873    4                 TEMP_BIT16 = %KZ#LINSTAT_LAST | TEMP_BIT16;
      528    15874    4                 KZ@LINCTX.FLAGS.FIRST = '1'B;
      529    15875    4                 END;
      530    15876    3              ELSE KZ@LINCTX.FLAGS.FIRST = '0'B;
      531    15877    3              KZ$EVENT.EVENT=%KZ#LINFCN_INP;
      532    15878    3              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT,TEMP_BIT16);
      533    15879    4              IF KZ@LINCTX.INPBFR$ = ADDR(NIL) THEN DO;
      534    15880                      /*  Input buffers should always be 256 bytes for
      535    15881                          3270 master mode.  For SLAVE mode, BLKBYTES should
      536    15882                          be used to calculate the buffer size, which will
      537    15883                          ultimately depend on the maximum output block size
      538    15884                          of the remote end.  */
      539    15885    4                 IF KZ@LINCTX.PRO.SLAVE
      540    15886    4                 THEN TSIZE = ( KZ@LINCTX.PRO.BLKBYTES + 1 ) / 2;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:24   
      541    15887    4                 ELSE TSIZE = 128;
      542    15888    4                 CALL KVB$GETSYS ( TSIZE, T$ )
      543    15889    4                 WHENALTRETURN
      544    15890    5                 DO;
      545    15891    5                    CALL ERRLOG ( %E$NO_MEMORY );
      546    15892    5                    KZ@LINCTX.INPBFR$ = ADDR(NIL);
      547    15893    5                    KZ@LINCTX.INPBFRSIZ = 0;
      548    15894    5                    CALL KZV$DSC_LINE ( KZ@LINCTX );
      549    15895    5                    RETURN;
      550    15896    5                    END;
      551    15897    4                 KZ@LINCTX.INPBFR$ = T$;
      552    15898    4                 KZ@LINCTX.INPBFRSIZ = TSIZE;
      553    15899    4                 IF KZ@LINCTX.PRO.PROTYP = %KLPT_POLL# THEN
      554    15900    4                    KZ$3270STT.KHSTT.INPBFRBYTUTL =
      555    15901    4                      KZ$3270STT.KHSTT.INPBFRBYTUTL + (TSIZE * 2);
      556    15902    4                 END;
      557    15903    3              END;
      558    15904    2           RETURN;
      559    15905    2   END RPTINP;
      560    15906        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:25   
      561    15907        /* SCREECH */
      562    15908
      563    15909    1   SCREECH: PROC;
      564    15910    2           CALL M$XXX;
      565    15911    2   END SCREECH;
      566    15912        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:26   
      567    15913    1   ERRLOG: PROC (ERROR);
      568    15914    2   DCL ERROR UBIN;
      569    15915        %FPT_WRSYSLOG (STCLASS="");
      570    16010        %FPT_WRSYSLOG (FPTN=FPT@WRSYSLOG,STCLASS=CONSTANT,FCG='KZ',MID='T');
      571    16105
      572    16106    2           FPT_WRSYSLOG = FPT@WRSYSLOG;
      573    16107    2           FPT_WRSYSLOG.V.TERMID = KZ@LINCTX.LINID;
      574    16108    2           FPT_WRSYSLOG.V.ERRCODE.ERR# = ERROR;
      575    16109    3           DO CASE (ERROR);
      576    16110
      577    16111    3            CASE (%E$3270IO_OK);
      578    16112        /*E* ERROR:        KZT-E$3270IO_OK-1
      579    16113             MESSAGE:      Corrected 3270 I/O error.
      580    16114             DESCRIPTION:  A NAK or ENQ occurred on a BSC 3270 LINE and a retry
      581    16115                           of the operation causing the error was successful.
      582    16116                           V0 = Channel number.
      583    16117                           V1 = Number of retries before good completion.
      584    16118                           DATA = Vector of KZ$LINCTX.HIST.
      585    16119        */
      586    16120    3              FPT_WRSYSLOG.V.ERRCODE.SEV=%G_WRSYSLOG_SEV_GOOD_HARD#;
      587    16121    3              FPT_WRSYSLOG.V.VALUES(0)=KZ@LINCTX.CHAN;
      588    16122    3              FPT_WRSYSLOG.V.VALUES(1)=KZ@LINCTX.RTRCNT;
      589    16123    3              FPT_WRSYSLOG.V.VALUES(2)=0;
      590    16124    3              FPT_WRSYSLOG.V.VALUES(3)=0;
      591    16125    3              FPT_WRSYSLOG.BUF_=VECTOR(KZ@LINCTX.HIST);
      592    16126
      593    16127    3            CASE (%E$3270POLTIMOUT);
      594    16128        /*E* ERROR:        KZT-E$3270POLTIMOUT-4
      595    16129             MESSAGE:      General Poll timed out.
      596    16130             DESCRIPTION:  A General Poll to a controller timed out.
      597    16131                           The controller will be removed from active
      598    16132                           controller list.
      599    16133                           V0 = Channel number.
      600    16134                           DATA = Vector of KZ$LINTCX.HIST.
      601    16135        */
      602    16136    3              FPT_WRSYSLOG.V.ERRCODE.SEV=%G_WRSYSLOG_SEV_NONFATAL_PROT#;
      603    16137    3              FPT_WRSYSLOG.V.VALUES(0)=KZ@LINCTX.CHAN;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:27   
      604    16138    3              FPT_WRSYSLOG.V.VALUES(1)=0;
      605    16139    3              FPT_WRSYSLOG.V.VALUES(2)=0;
      606    16140    3              FPT_WRSYSLOG.V.VALUES(3)=0;
      607    16141    3              FPT_WRSYSLOG.BUF_=VECTOR(KZ@LINCTX.HIST);
      608    16142
      609    16143    3            CASE (%E$NO_MEMORY);
      610    16144        /*  Uses same error message as KZT$3270.  See ERRLOG in that routine.  */
      611    16145    3              FPT_WRSYSLOG.V.ERRCODE.SEV=%G_WRSYSLOG_SEV_LINE_ABORT#;
      612    16146    3              FPT_WRSYSLOG.V.VALUES(0)=KZ@LINCTX.CHAN;
      613    16147    3              FPT_WRSYSLOG.V.VALUES(1)=0;
      614    16148    3              FPT_WRSYSLOG.V.VALUES(2)=0;
      615    16149    3              FPT_WRSYSLOG.V.VALUES(3)=TSIZE;
      616    16150
      617    16151    3            END;
      618    16152    2           CALL KHA$ERRLOG(FPT_WRSYSLOG);
      619    16153    2           RETURN;
      620    16154    2   END ERRLOG;
      621    16155    1   END KZT$3270IO;
      622    16156        %EOD;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:28   
--  Include file information  --

   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KZ$3270STT.:E05TOU  is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KZ_3270_C.:E05TOU  is referenced.
   KZ_MLCP_C.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ_3270M_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KZ_BSCFPT.:E05TOU  is referenced.
   KZ$OTPBFR.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KZT$3270IO.

   Procedure KZT$3270IO requires 1953 words for executable code.
   Procedure KZT$3270IO requires 72 words of local(AUTO) storage.
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:29   

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:30   

 Object Unit name= KZT$3270IO                                 File name= KZT$3270IO.:E05TOU
 UTS= JUL 30 '97 03:02:39.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS     46     2E  KZT$3270IO
    1   Proc  even  none  1953    7A1  KZT$3270IO
    2  RoData even  none     4      4  KZT$3270IO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  KZT$3270IO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KHC$TIME2
 yes     yes           Std       1 KHC$CLOCK
 yes     yes           Std       2 KVB$GETSYS
 yes     yes           Std       1 KZV$DSC_LINE
 yes     yes           Std       2 KHA$ERRLOG
                       nStd      0 X6A_AUTO_2
                       nStd      0 X6A_AALT
                       nStd      0 X6D_MID
                       nStd      0 X6A_ARET
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:31   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KZ_3270M_HDR                          KZT_GO@                               KZT_ORDERS@
r    G$ROS$
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:32   


        1        1        /*M*     KZT$3270IO - Line driver code for 3270 and passthru       */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  */
        8        8
        9        9        KZT$3270IO: PROC (KZ@LINCTX,KZ@BSCFPT) ALTRET;

      9   1 000000  D380 0000 0000  xent KZT$3270IO      LNJ,B5   X6A_AUTO_2
          1 000003       0048 0002                       DC       72,2

       10       10
       11       11        %INCLUDE LCP_6;
       12     4290        %INCLUDE KV_GLBCNS_E;
       13     4631        %INCLUDE KZ$LINCTX;
       14     5251        %INCLUDE KZ$OTPBFR;
       15     5352        %INCLUDE KZ_BSCFPT;
       16     5382        %INCLUDE KZ_CLM_E;
       17     5554        %INCLUDE KZ_3270M_C;
       18     6411        %INCLUDE KZ_LIN_C;
       19     6467        %INCLUDE KZ_MLCP_C;
       20     6542        %INCLUDE KZ_3270_C;
       21     6700        %INCLUDE KZ_PERR_C;
       22     6782        %INCLUDE KZ$3270STT;
       23     6846        %INCLUDE KZ$BSCSTT;
       24     6952        %INCLUDE KH$STT;
       25     6982        %INCLUDE KH_CLKFNC_E;
       26     7027        %INCLUDE KH$CLK;
       27     7397        %INCLUDE KL_MACRO_C;
       28    10749        %INCLUDE KL_SUPER_C;
       29    13651        %INCLUDE KL_AFCN_C;
       30    13752        %INCLUDE K_ID_E;
       31    13802        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:33   
       32    13803        %KV_INPOPRX_E;
       33    13815        %KZ_3270_E;
       34    13943        %KZ$LINCTX (NAME=KZ@LINCTX,STCLASS="");
       35    14374        %KZ_BSCFPT (NAME=KZ@BSCFPT,STCLASS="");
       36    14383        %KZ_BSCFPTEQUS;
       37    14389        %KZ$OTPBFR (NAME=KZ$OTPBFR,STCLASS=BASED);
       38    14454        %K#ENTID_E;
       39    14473        %KZ_3270M_HDR (STCLASS=SYMREF);
       40    14497        %KZ$3270STT (STCLASS="BASED(KZ_3270M_HDR.STTBFR$)");
       41    14929        %KZ$EVENT (FPTN=KZ_EVENT,STCLASS=CONSTANT);
       42    15011        %KZ$EVENT (STCLASS="");
       43    15093        %KH$CLK (FPTN=KH_CLK_SET,FNC=%KH#CLK_SETCLK,STCLASS=CONSTANT);
       44    15242        %KH$CLK (STCLASS="");
       45    15391
       46    15392    1   DCL CTR(0:0) UBIN BYTE BASED CALIGNED;
       47    15393    1   DCL TIME UBIN(32) ALIGNED;
       48    15394    1   DCL 1 TINY_TIME_PARTICLES REDEF TIME,
       49    15395    1         2 WD1 UBIN WORD,
       50    15396    1         2 WD2 UBIN WORD;
       51    15397    1   DCL TEMP_BIT16 BIT(16) ALIGNED;
       52    15398    1   DCL I REDEF TEMP_BIT16 UBIN;
       53    15399    1   DCL TSIZE UBIN;
       54    15400    1   DCL T$ PTR;
       55    15401
       56    15402    1   DCL KZT_GO@ EPTR SYMREF;
       57    15403    1   DCL KZT_ORDERS@ EPTR SYMREF;
       58    15404    1   DCL KZV$DSC_LINE ENTRY (1) ALTRET;
       59    15405    1   DCL KHC$CLOCK ENTRY (1) ALTRET;
       60    15406    1   DCL KHC$TIME2 ENTRY (1) ALTRET;
       61    15407    1   DCL KVB$GETSYS ENTRY (2) ALTRET;
       62    15408    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
       63    15409        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:34   
       64    15410    1           KZ$EVENT=KZ_EVENT;

  15410   1 000005  AB80 0000 0000  00                   LAB,B2   KZ_EVENT
          1 000008  2C00                                 LDV,R2   0
          1 000009  6C1C                                 LDV,R6   28
          1 00000A  BB87                                 LAB,B3   ,AUTO
          1 00000B  3C10                                 LDV,R3   16
          1 00000C  0008                                 MMM

       65    15411    1           KZ$EVENT.LINCTX$=ADDR(KZ@LINCTX);

  15411   1 00000D  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 00000F  EFC7 000B                            STB,B6   KZ$EVENT+3,AUTO

       66    15412    2           DO CASE ( KZ@BSCFPT.ACT );

  15412   1 000011  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 000013  B805                                 LDR,R3   ,B5
          1 000014  3D16                                 CMV,R3   22
          1 000015  0281 060F                            BGE      s:15847,PREL
          1 000017  A830 0000 001D  01                   LDR,R2   s:15412+12,R3
          1 00001A  83A0 0000 0033  01                   JMP      s:15415,R2
          1 00001D       0000                            DC       s:15415,PREL
          1 00001E       04F4                            DC       s:15786,PREL
          1 00001F       051B                            DC       s:15793,PREL
          1 000020       0360                            DC       s:15658,PREL
          1 000021       0360                            DC       s:15658,PREL
          1 000022       0360                            DC       s:15658,PREL
          1 000023       043C                            DC       s:15729,PREL
          1 000024       047B                            DC       s:15749,PREL
          1 000025       05BD                            DC       s:15829,PREL
          1 000026       04BA                            DC       s:15771,PREL
          1 000027       04BA                            DC       s:15771,PREL
          1 000028       0418                            DC       s:15717,PREL
          1 000029       0418                            DC       s:15717,PREL
          1 00002A       0006                            DC       s:15420,PREL
          1 00002B       00A0                            DC       s:15460,PREL
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:35   
          1 00002C       00CE                            DC       s:15476,PREL
          1 00002D       00F5                            DC       s:15490,PREL
          1 00002E       0157                            DC       s:15524,PREL
          1 00002F       0193                            DC       s:15535,PREL
          1 000030       0418                            DC       s:15717,PREL
          1 000031       0312                            DC       s:15624,PREL
          1 000032       04BA                            DC       s:15771,PREL

       67    15413    2            CASE ( %KZ#3270ACT_INIT );

       68    15414
       69    15415    2              KZ@BSCFPT.FNC = %KZ#FNC_DSC;

  15415   1 000033  6C02                                 LDV,R6   2
          1 000034  EF45 0004                            STR,R6   4,B5

       70    15416    2              ALTRETURN;

  15416   1 000036  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

       71    15417        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:36   
       72    15418    2            CASE ( %KZ#3270ACT_RQSCTR );

       73    15419
       74    15420    2              KZ@LINCTX.OPR = %KZ#3270_OPR_RQSCTR;

  15420   1 000039  6C04                                 LDV,R6   4
          1 00003A  EAC6 006D                            SRM,R6,'00FF'X    109,B6
          1 00003C       00FF

       75    15421    2              IF KZ@LINCTX.ACTCTR = 0 THEN

  15421   1 00003D  D2C6 006D                            LLH,R5   109,B6
          1 00003F  5981 0004                            BNEZ,R5  s:15425,PREL

       76    15422    2                 KZ@LINCTX.FLAGS.CTRINITDONE = '0'B;

  15422   1 000041  8846 0034                            LBF,'0010'X       52,B6
  15422   1 000043       0010

       77    15423
       78    15424    2   RQSCTR:
       79    15425    2              KZ$EVENT.EVENT=%KZ#LINFCN_INACT_CTR;

  15425   1 000044  6C0D                 RQSCTR          LDV,R6   13
          1 000045  EF47 0008                            STR,R6   KZ$EVENT,AUTO

       80    15426    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)

  15426   1 000047  EBC7 0008                            LAB,B6   KZ$EVENT,AUTO
          1 000049  EFC7 0044                            STB,B6   FPT_WRSYSLOG+22,AUTO
          1 00004B  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 00004D  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 00004F  9CC5 006E                            LDB,B1   110,B5
          1 000051  CBF0 0100                            LAB,B4   256,IMO
          1 000053  E381                                 LNJ,B6   ,B1
          1 000054       0048                            DC       s:15443,PREL

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:37   
       81    15427    2                ALTRET ( RQSCTR_DONE );
       82    15428    2              IF NOT KZ@LINCTX.FLAGS.CTRINITDONE AND

  15428   1 000055  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000057  82C6 0034                            LB,'0010'X        52,B6
          1 000059       0010
          1 00005A  0501 0027                            BBT      s:15436,PREL
          1 00005C  E846 006C                            LDR,R6   108,B6
          1 00005E  E570 00FF                            AND,R6   255,IMO
          1 000060  D846 0065                            LDR,R5   101,B6
          1 000062  5EFF                                 ADV,R5   -1
          1 000063  E955                                 CMR,R6   R5
          1 000064  0981 001D                            BNE      s:15436,PREL

       83    15429    3                KZ@LINCTX.POLX = KZ@LINCTX.POLSIZ-1 THEN DO;

       84    15430    3                 CALL KHC$TIME2 (TIME);

  15430   1 000066  DBC7 0021                            LAB,B5   TIME,AUTO
          1 000068  DFC7 0044                            STB,B5   FPT_WRSYSLOG+22,AUTO
          1 00006A  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 00006C  CBF0 0100                            LAB,B4   256,IMO
          1 00006E  E380 0000 0000  xent                 LNJ,B6   KHC$TIME2
          1 000071       0001                            DC       s:15431,PREL

       85    15431    3                 KZ@LINCTX.TIMER.POL = TIME;

  15431   1 000072  8CC7 0021                            LDI      TIME,AUTO
          1 000074  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000076  8D46 0028                            SDI      40,B6

       86    15432    3                 KZ@LINCTX.TIMR.GENPOL = TIME;

  15432   1 000078  8D46 0077                            SDI      119,B6

       87    15433    3                 KZ@LINCTX.TIMR.SPCPOL = TIME - 120*30;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:38   
  15433   1 00007A  8470 FFFF F1F0                       AID      -3600,IMO
          1 00007D  8D46 0079                            SDI      121,B6

       88    15434    3                 KZ@LINCTX.FLAGS.CTRINITDONE = '1'B;

  15434   1 00007F  8946 0034                            LBT,'0010'X       52,B6
  15434   1 000081       0010

       89    15435    3                 END;

       90    15436    2              KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);

  15436   1 000082  DBC6 0064                            LAB,B5   100,B6
          1 000084  DFC6 005A                            STB,B5   90,B6

       91    15437    2              KZ@LINCTX.OTPDATSIZ = 1;

  15437   1 000086  6C01                                 LDV,R6   1
          1 000087  EF46 005D                            STR,R6   93,B6

       92    15438    2              KZ@LINCTX.OTPBFRSIZ = 0;

  15438   1 000089  8746 005C                            CL       92,B6

       93    15439    2              CALL KZT_ORDERS@ ( %KZ#SEND_GEPOLL, KZ@LINCTX );

  15439   1 00008B  CBF0 000E                            LAB,B4   14,IMO
          1 00008D  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 00008F  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000091  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000093  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000096  CBF0 0200                            LAB,B4   512,IMO
          1 000098  E381                                 LNJ,B6   ,B1
          1 000099       0001                            DC       s:15440,PREL

       94    15440    2              GOTO RQSCTR_EXIT;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:39   
  15440   1 00009A  0F81 0036                            B        s:15454,PREL

       95    15441
       96    15442    2   RQSCTR_DONE:
       97    15443    3              IF NOT KZ@LINCTX.FLAGS.CTRINITDONE THEN DO;

  15443   1 00009C  ECC7 0004            RQSCTR_DONE     LDB,B6   @KZ@LINCTX,AUTO
          1 00009E  82C6 0034                            LB,'0010'X        52,B6
          1 0000A0       0010
          1 0000A1  0501 001D                            BBT      s:15450,PREL

       98    15444    3                 CALL KHC$TIME2 (TIME);

  15444   1 0000A3  DBC7 0021                            LAB,B5   TIME,AUTO
          1 0000A5  DFC7 0044                            STB,B5   FPT_WRSYSLOG+22,AUTO
          1 0000A7  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0000A9  CBF0 0100                            LAB,B4   256,IMO
          1 0000AB  E380 0000 0000  xent                 LNJ,B6   KHC$TIME2
          1 0000AE       0001                            DC       s:15445,PREL

       99    15445    3                 KZ@LINCTX.TIMER.POL = TIME;

  15445   1 0000AF  8CC7 0021                            LDI      TIME,AUTO
          1 0000B1  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0000B3  8D46 0028                            SDI      40,B6

      100    15446    3                 KZ@LINCTX.TIMR.GENPOL = TIME;

  15446   1 0000B5  8D46 0077                            SDI      119,B6

      101    15447    3                 KZ@LINCTX.TIMR.SPCPOL = TIME - 120*30;

  15447   1 0000B7  8470 FFFF F1F0                       AID      -3600,IMO
          1 0000BA  8D46 0079                            SDI      121,B6

      102    15448    3                 KZ@LINCTX.FLAGS.CTRINITDONE = '1'B;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:40   
  15448   1 0000BC  8946 0034                            LBT,'0010'X       52,B6
  15448   1 0000BE       0010

      103    15449    3                 END;

      104    15450    2              IF KZ@LINCTX.ACTCTR = 0 THEN

  15450   1 0000BF  E2C6 006D                            LLH,R6   109,B6
          1 0000C1  6901 FF82                            BEZ,R6   s:15425,PREL

      105    15451    2                 GOTO RQSCTR;
      106    15452    2              KZ@LINCTX.OPR = 0;

  15452   1 0000C3  8846 006D                            LBF,'00FF'X       109,B6
  15452   1 0000C5       00FF

      107    15453    2              KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15453   1 0000C6  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 0000C8  5C01                                 LDV,R5   1
          1 0000C9  DF45 0001                            STR,R5   1,B5

      108    15454    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15454   1 0000CB  6C03                                 LDV,R6   3
          1 0000CC  EF45 0004                            STR,R6   4,B5

      109    15455    2              ALTRETURN;

  15455   1 0000CE  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

  15454   1 0000D1  0F81 0553            RQSCTR_EXIT     B        s:15847,PREL

      110    15456    2   RQSCTR_EXIT:;
      111    15457        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:41   
      112    15458    2            CASE ( %KZ#3270ACT_SPCPOLCTR );

      113    15459
      114    15460    2              KZ@LINCTX.OPR = %KZ#3270_OPR_SPCPOLCTR;

  15460   1 0000D3  6C05                                 LDV,R6   5
          1 0000D4  EAC6 006D                            SRM,R6,'00FF'X    109,B6
          1 0000D6       00FF

      115    15461    2              KZ$EVENT.EVENT=%KZ#LINFCN_NEWCTR;

  15461   1 0000D7  5C07                                 LDV,R5   7
          1 0000D8  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      116    15462    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)

  15462   1 0000DA  CBC7 0008                            LAB,B4   KZ$EVENT,AUTO
          1 0000DC  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 0000DE  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0000E0  9CC6 006E                            LDB,B1   110,B6
          1 0000E2  CBF0 0100                            LAB,B4   256,IMO
          1 0000E4  E381                                 LNJ,B6   ,B1
          1 0000E5       0003                            DC       s:15467,PREL

      117    15463    2                ALTRET ( SPCPOLCTR_END );
      118    15464    2              GOTO SPCPOL;

  15464   1 0000E6  0F81 00C3                            B        s:15529,PREL

      119    15465
      120    15466    2   SPCPOLCTR_END:
      121    15467    2              IF KZ@LINCTX.FLAGS.CTRINITDONE THEN

  15467   1 0000E8  ECC7 0004            SPCPOLCTR_END   LDB,B6   @KZ@LINCTX,AUTO
          1 0000EA  82C6 0034                            LB,'0010'X        52,B6
          1 0000EC       0010
          1 0000ED  0581 0008                            BBF      s:15470,PREL
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:42   

      122    15468    2                 KZ@BSCFPT.EVT = %KZ#3270EVT_POL; /* GENPOL                      */

  15468   1 0000EF  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 0000F1  6C15                                 LDV,R6   21
          1 0000F2  EF45 0001                            STR,R6   1,B5
          1 0000F4  0F81 0006                            B        s:15471,PREL

      123    15469    2              ELSE
      124    15470    2                 KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15470   1 0000F6  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 0000F8  6C01                                 LDV,R6   1
          1 0000F9  EF45 0001                            STR,R6   1,B5

      125    15471    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15471   1 0000FB  5C03                                 LDV,R5   3
          1 0000FC  DF45 0004                            STR,R5   4,B5

      126    15472    2              ALTRETURN;

  15472   1 0000FE  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      127    15473        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:43   
      128    15474    2            CASE ( %KZ#3270ACT_SPCPOLALL );

      129    15475
      130    15476    2              KZ$EVENT.EVENT=%KZ#LINFCN_SPCPOLALL;

  15476   1 000101  6C0C                                 LDV,R6   12
          1 000102  EF47 0008                            STR,R6   KZ$EVENT,AUTO

      131    15477    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)

  15477   1 000104  CBC7 0008                            LAB,B4   KZ$EVENT,AUTO
          1 000106  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000108  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 00010A  9CC6 006E                            LDB,B1   110,B6
          1 00010C  CBF0 0100                            LAB,B4   256,IMO
          1 00010E  E381                                 LNJ,B6   ,B1
          1 00010F       0009                            DC       s:15483,PREL

      132    15478    2                ALTRET(END_SPCPOLALL);
      133    15479    2              KZ@LINCTX.OPR = %KZ#3270_OPR_SPCPOLALL;

  15479   1 000110  6C02                                 LDV,R6   2
          1 000111  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000113  EAC6 006D                            SRM,R6,'00FF'X    109,B6
          1 000115       00FF

      134    15480    2              GOTO SPCPOL;

  15480   1 000116  0F81 0093                            B        s:15529,PREL

      135    15481
      136    15482    2   END_SPCPOLALL:
      137    15483    2              KZ@LINCTX.OPR = 0;

  15483   1 000118  ECC7 0004            END_SPCPOLALL   LDB,B6   @KZ@LINCTX,AUTO
          1 00011A  8846 006D                            LBF,'00FF'X       109,B6
          1 00011C       00FF
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:44   

      138    15484    2              KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15484   1 00011D  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 00011F  6C01                                 LDV,R6   1
          1 000120  EF45 0001                            STR,R6   1,B5

      139    15485    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15485   1 000122  5C03                                 LDV,R5   3
          1 000123  DF45 0004                            STR,R5   4,B5

      140    15486    2              ALTRETURN;

  15486   1 000125  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      141    15487        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:45   
      142    15488    2            CASE ( %KZ#3270ACT_SELPOL );

      143    15489
      144    15490    2              KZ@LINCTX.OPR = 0;

  15490   1 000128  8846 006D                            LBF,'00FF'X       109,B6
  15490   1 00012A       00FF

      145    15491    2              IF KZ@BSCFPT.EVT = %KZ#3270EVT_GO OR

  15491   1 00012B  E845 0001                            LDR,R6   1,B5
          1 00012D  6D01                                 CMV,R6   1
          1 00012E  0901 0004                            BE       s:15494,PREL
          1 000130  6D0F                                 CMV,R6   15
          1 000131  0981 0012                            BNE      s:15499,PREL

      146    15492    2                KZ@BSCFPT.EVT = %KZ#3270EVT_EOT THEN
      147    15493    3              DO;

      148    15494    3                 KZ$EVENT.EVENT=%KZ#LINFCN_GETOTP;

  15494   1 000133  5C01                                 LDV,R5   1
          1 000134  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      149    15495    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)

  15495   1 000136  CBC7 0008                            LAB,B4   KZ$EVENT,AUTO
          1 000138  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 00013A  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 00013C  9CC6 006E                            LDB,B1   110,B6
          1 00013E  CBF0 0100                            LAB,B4   256,IMO
          1 000140  E381                                 LNJ,B6   ,B1
          1 000141       003C                            DC       s:15513,PREL

      150    15496    3                   ALTRET ( CANT_GET_OTP );
      151    15497    3                 END;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:46   
  15497   1 000142  0F81 0017                            B        s:15510,PREL

      152    15498    2              ELSE
      153    15499    2                 IF KZ@BSCFPT.EVT=%KZ#3270EVT_RCVERR THEN

  15499   1 000144  6D03                                 CMV,R6   3
          1 000145  0981 0014                            BNE      s:15510,PREL

      154    15500    3                 DO;

      155    15501    3                    KZ@LINCTX.RTRCNT=KZ@LINCTX.RTRCNT+1;

  15501   1 000147  8AC6 0039                            INC      57,B6

      156    15502    3                    IF KZ@LINCTX.PRO.RETRYS>0 AND

  15502   1 000149  E846 003D                            LDR,R6   61,B6
          1 00014B  6901 000E                            BEZ,R6   s:15510,PREL
          1 00014D  E946 0039                            CMR,R6   57,B6
          1 00014F  0281 000A                            BGE      s:15510,PREL

      157    15503    3                      KZ@LINCTX.RTRCNT>KZ@LINCTX.PRO.RETRYS THEN
      158    15504    4                    DO;

      159    15505    4                       KZ@BSCFPT.EVT=%KZ#3270EVT_TIMOUT;

  15505   1 000151  5C12                                 LDV,R5   18
          1 000152  DF45 0001                            STR,R5   1,B5

      160    15506    4                       KZ@BSCFPT.FNC=%KZ#FNC_MOV;

  15506   1 000154  6C03                                 LDV,R6   3
          1 000155  EF45 0004                            STR,R6   4,B5

      161    15507    4                       ALTRETURN;

  15507   1 000157  C380 0000 0000  xent                 LNJ,B4   X6A_AALT
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:47   

      162    15508    4                       END;
      163    15509    3                    END;
      164    15510    2              KZ$3270STT.SEL = KZ$3270STT.SEL + 1;

  15510   1 00015A  EC80 0000 0006  xsym                 LDB,B6   KZ_3270M_HDR+6
          1 00015D  8AC6 0097                            INC      151,B6
          1 00015F  8EC6 0096                            CAD      150,B6

      165    15511    2              KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);

  15511   1 000161  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 000163  CBC5 0064                            LAB,B4   100,B5
          1 000165  CFC5 005A                            STB,B4   90,B5

      166    15512    2              KZ@LINCTX.OTPDATSIZ = 2;

  15512   1 000167  6C02                                 LDV,R6   2
          1 000168  EF45 005D                            STR,R6   93,B5

      167    15513    2              KZ@LINCTX.OTPBFRSIZ = 0;

  15513   1 00016A  8745 005C                            CL       92,B5

      168    15514    2              CALL KZT_ORDERS@ ( %KZ#SEND_SEPOLL, KZ@LINCTX );

  15514   1 00016C  BBF0 000F                            LAB,B3   15,IMO
          1 00016E  DFC7 0046                            STB,B5   FPT_WRSYSLOG+24,AUTO
          1 000170  BFC7 0044                            STB,B3   FPT_WRSYSLOG+22,AUTO
          1 000172  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000174  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000177  CBF0 0200                            LAB,B4   512,IMO
          1 000179  E381                                 LNJ,B6   ,B1
          1 00017A       0001                            DC       s:15515,PREL

      169    15515    2              GOTO SELPOL_EXIT;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:48   
  15515   1 00017B  0F81 000C                            B        s:15518,PREL

  15513   1                              CANT_GET_OTP    null
      170    15516    2   CANT_GET_OTP:;
      171    15517    2              KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15517   1 00017D  ECC7 0006            CANT_GET_OTP    LDB,B6   @KZ@BSCFPT,AUTO
          1 00017F  6C01                                 LDV,R6   1
          1 000180  EF46 0001                            STR,R6   1,B6

      172    15518    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15518   1 000182  5C03                                 LDV,R5   3
          1 000183  DF46 0004                            STR,R5   4,B6

      173    15519    2              ALTRETURN;

  15519   1 000185  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

  15518   1 000188  0F81 049C            SELPOL_EXIT     B        s:15847,PREL

      174    15520    2   SELPOL_EXIT:;
      175    15521        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:49   
      176    15522    2            CASE ( %KZ#3270ACT_SPCPOL );

      177    15523
      178    15524    2              KZ$EVENT.EVENT=%KZ#LINFCN_REQOTP;

  15524   1 00018A  6C02                                 LDV,R6   2
          1 00018B  EF47 0008                            STR,R6   KZ$EVENT,AUTO

      179    15525    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);

  15525   1 00018D  CBC7 0008                            LAB,B4   KZ$EVENT,AUTO
          1 00018F  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000191  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000193  9CC6 006E                            LDB,B1   110,B6
          1 000195  CBF0 0100                            LAB,B4   256,IMO
          1 000197  E381                                 LNJ,B6   ,B1
          1 000198       0001                            DC       s:15526,PREL

      180    15526    2              KZ$EVENT.EVENT=%KZ#LINFCN_SPCPOL;

  15526   1 000199  6C0B                                 LDV,R6   11
          1 00019A  EF47 0008                            STR,R6   KZ$EVENT,AUTO

      181    15527    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);

  15527   1 00019C  EBC7 0008                            LAB,B6   KZ$EVENT,AUTO
          1 00019E  EFC7 0044                            STB,B6   FPT_WRSYSLOG+22,AUTO
          1 0001A0  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0001A2  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 0001A4  9CC5 006E                            LDB,B1   110,B5
          1 0001A6  CBF0 0100                            LAB,B4   256,IMO
          1 0001A8  E381                                 LNJ,B6   ,B1
          1 0001A9       0001                            DC       s:15529,PREL

      182    15528    2   SPCPOL:
      183    15529    2              KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:50   
  15529   1 0001AA  ECC7 0004            SPCPOL          LDB,B6   @KZ@LINCTX,AUTO
          1 0001AC  DBC6 0064                            LAB,B5   100,B6
          1 0001AE  DFC6 005A                            STB,B5   90,B6

      184    15530    2              KZ@LINCTX.OTPDATSIZ = 2;

  15530   1 0001B0  6C02                                 LDV,R6   2
          1 0001B1  EF46 005D                            STR,R6   93,B6

      185    15531    2              KZ@LINCTX.OTPBFRSIZ = 0;

  15531   1 0001B3  8746 005C                            CL       92,B6

      186    15532    2              CALL KZT_ORDERS@ ( %KZ#SEND_SPPOLL, KZ@LINCTX );

  15532   1 0001B5  CBF0 000F                            LAB,B4   15,IMO
          1 0001B7  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 0001B9  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 0001BB  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0001BD  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 0001C0  CBF0 0200                            LAB,B4   512,IMO
          1 0001C2  E381                                 LNJ,B6   ,B1
          1 0001C3       0001                            DC       s:15532+15,PREL
          1 0001C4  0F81 0460                            B        s:15847,PREL

      187    15533        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:51   
      188    15534    2            CASE ( %KZ#3270ACT_GENPOL );

      189    15535    2              IF KZ@BSCFPT.OLDSTT ~= %KZ#M3270STT_EOT THEN

  15535   1 0001C6  E845 0002                            LDR,R6   2,B5
          1 0001C8  E570 00FF                            AND,R6   255,IMO
          1 0001CA  6D12                                 CMV,R6   18
          1 0001CB  0901 0010                            BE       s:15540,PREL

      190    15536    3              DO;

      191    15537    3                 KZ$EVENT.EVENT=%KZ#LINFCN_POLL_ANSWERED;

  15537   1 0001CD  5C13                                 LDV,R5   19
          1 0001CE  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      192    15538    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);

  15538   1 0001D0  CBC7 0008                            LAB,B4   KZ$EVENT,AUTO
          1 0001D2  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 0001D4  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0001D6  9CC6 006E                            LDB,B1   110,B6
          1 0001D8  CBF0 0100                            LAB,B4   256,IMO
          1 0001DA  E381                                 LNJ,B6   ,B1
          1 0001DB       0001                            DC       s:15540,PREL

      193    15539    3                 END;

      194    15540    2              KZ@LINCTX.CURCTR$ = ADDR(NIL);

  15540   1 0001DC  EB80 0000 0000                       LAB,B6   0
          1 0001DF  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 0001E1  EFC5 004E                            STB,B6   78,B5

      195    15541    2              KZ@LINCTX.CURDEV$ = ADDR(NIL);

  15541   1 0001E3  CB80 0000 0000                       LAB,B4   0
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:52   
          1 0001E6  CFC5 0050                            STB,B4   80,B5

      196    15542    2              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_EOT AND

  15542   1 0001E8  BCC7 0006                            LDB,B3   @KZ@BSCFPT,AUTO
          1 0001EA  E843 0001                            LDR,R6   1,B3
          1 0001EC  6D0F                                 CMV,R6   15
          1 0001ED  0901 005C                            BE       s:15564,PREL
          1 0001EF  6D15                                 CMV,R6   21
          1 0001F0  0901 0059                            BE       s:15564,PREL

      197    15543    3                KZ@BSCFPT.EVT ~= %KZ#3270EVT_POL THEN DO;

      198    15544    3   GENPOL:       KZ@LINCTX.POLX = 0;

  15544   1 0001F2  ECC7 0004            GENPOL          LDB,B6   @KZ@LINCTX,AUTO
          1 0001F4  8846 006C                            LBF,'00FF'X       108,B6
          1 0001F6       00FF

      199    15545    3                 KZ$3270STT.GENPOL = KZ$3270STT.GENPOL + 1;

  15545   1 0001F7  DC80 0000 0006  xsym                 LDB,B5   KZ_3270M_HDR+6
          1 0001FA  8AC5 0093                            INC      147,B5
          1 0001FC  8EC5 0092                            CAD      146,B5

      200    15546    3                 CALL KHC$TIME2 (TIME);

  15546   1 0001FE  CBC7 0021                            LAB,B4   TIME,AUTO
          1 000200  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000202  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000204  CBF0 0100                            LAB,B4   256,IMO
          1 000206  E380 0000 0000  xent                 LNJ,B6   KHC$TIME2
          1 000209       0001                            DC       s:15547,PREL

      201    15547    4                 IF TIME - KZ@LINCTX.TIMR.SPCPOL >= 120*60 THEN DO;

  15547   1 00020A  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:53   
          1 00020C  8CC7 0021                            LDI      TIME,AUTO
          1 00020E  84C6 0079                            SID      121,B6
          1 000210  84F0 0000 1C20                       SID      7200,IMO
          1 000213  6801 0010                            BLZ,R6   s:15553,PREL

      202    15548    4                    KZ@LINCTX.TIMR.SPCPOL = TIME;

  15548   1 000215  8CC7 0021                            LDI      TIME,AUTO
          1 000217  8D46 0079                            SDI      121,B6

      203    15549    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_POLALL;

  15549   1 000219  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 00021B  5C14                                 LDV,R5   20
          1 00021C  DF45 0001                            STR,R5   1,B5

      204    15550    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15550   1 00021E  6C03                                 LDV,R6   3
          1 00021F  EF45 0004                            STR,R6   4,B5

      205    15551    4                    ALTRETURN;

  15551   1 000221  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      206    15552    4                    END;
      207    15553    4                 IF TIME - KZ@LINCTX.TIMER.POL >= 120*120 THEN DO;

  15553   1 000224  8CC7 0021                            LDI      TIME,AUTO
          1 000226  84C6 0028                            SID      40,B6
          1 000228  84F0 0000 3840                       SID      14400,IMO
          1 00022B  6801 0014                            BLZ,R6   s:15560,PREL

      208    15554    4                    KZ@LINCTX.TIMER.POL = TIME;

  15554   1 00022D  8CC7 0021                            LDI      TIME,AUTO
          1 00022F  8D46 0028                            SDI      40,B6
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:54   

      209    15555    4                    KZ@LINCTX.OPR = %KZ#3270_OPR_RQSCTR;

  15555   1 000231  5C04                                 LDV,R5   4
          1 000232  DAC6 006D                            SRM,R5,'00FF'X    109,B6
          1 000234       00FF

      210    15556    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_POLINACT;

  15556   1 000235  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 000237  4C1B                                 LDV,R4   27
          1 000238  CF45 0001                            STR,R4   1,B5

      211    15557    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15557   1 00023A  6C03                                 LDV,R6   3
          1 00023B  EF45 0004                            STR,R6   4,B5

      212    15558    4                    ALTRETURN;

  15558   1 00023D  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      213    15559    4                    END;
      214    15560    3                 KZ@LINCTX.TIMR.GENPOL = TIME;

  15560   1 000240  8CC7 0021                            LDI      TIME,AUTO
          1 000242  8D46 0077                            SDI      119,B6

      215    15561    3                 KZ@LINCTX.OPR = %KZ#3270_OPR_GENPOL;

  15561   1 000244  5C01                                 LDV,R5   1
          1 000245  DAC6 006D                            SRM,R5,'00FF'X    109,B6
          1 000247       00FF

      216    15562    3                 END;

  15562   1 000248  0F81 000A                            B        s:15565,PREL
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:55   

      217    15563    2              ELSE
      218    15564    2   GENPOLNXT:    KZ@LINCTX.POLX = KZ@LINCTX.POLX + 1;

  15564   1 00024A  ECC7 0004            GENPOLNXT       LDB,B6   @KZ@LINCTX,AUTO
          1 00024C  E846 006C                            LDR,R6   108,B6
          1 00024E  EA70 0001                            ADD,R6   1,IMO
          1 000250  EAC6 006C                            SRM,R6,'00FF'X    108,B6
          1 000252       00FF

      219    15565    3              IF KZ@LINCTX.POLX < KZ@LINCTX.POLSIZ THEN DO;

  15565   1 000253  E846 006C                            LDR,R6   108,B6
          1 000255  E570 00FF                            AND,R6   255,IMO
          1 000257  E946 0065                            CMR,R6   101,B6
          1 000259  0881 0027                            BAGE     s:15577,PREL

      220    15566    3                 KZ@LINCTX.POLADR.CTR = KZ@LINCTX.POLLST$ ->

  15566   1 00025B  DCC6 0066                            LDB,B5   102,B6
          1 00025D  B856                                 LDR,R3   R6
          1 00025E  D2B5                                 LLH,R5   ,B5,R3
          1 00025F  D7C6 0064                            STH,R5   100,B6

      221    15567    3                   CTR(KZ@LINCTX.POLX);
      222    15568    3                 IF KZ@LINCTX.POLADR.CTR = 0 THEN

  15568   1 000261  D2C6 0064                            LLH,R5   100,B6
          1 000263  5967                                 BEZ,R5   s:15564,SPREL

      223    15569    3                    GOTO GENPOLNXT;        /* This one not active                */
      224    15570    3                 KZ@LINCTX.POLADR.DEV = BITBIN('00'X);

  15570   1 000264  8846 0064                            LBF,'00FF'X       100,B6
  15570   1 000266       00FF

      225    15571    3                 KZ@LINCTX.OTPBFR$ = ADDR(KZ@LINCTX.POLADR);
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:56   

  15571   1 000267  CBC6 0064                            LAB,B4   100,B6
          1 000269  CFC6 005A                            STB,B4   90,B6

      226    15572    3                 KZ@LINCTX.OTPDATSIZ = 1;

  15572   1 00026B  4C01                                 LDV,R4   1
          1 00026C  CF46 005D                            STR,R4   93,B6

      227    15573    3                 KZ@LINCTX.OTPBFRSIZ = 0;

  15573   1 00026E  8746 005C                            CL       92,B6

      228    15574    3                 CALL KZT_ORDERS@ ( %KZ#SEND_GEPOLL, KZ@LINCTX);

  15574   1 000270  BBF0 000E                            LAB,B3   14,IMO
          1 000272  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 000274  BFC7 0044                            STB,B3   FPT_WRSYSLOG+22,AUTO
          1 000276  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000278  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 00027B  CBF0 0200                            LAB,B4   512,IMO
          1 00027D  E381                                 LNJ,B6   ,B1
          1 00027E       0001                            DC       s:15575,PREL

      229    15575    3                 END;

  15575   1 00027F  0F81 03A5                            B        s:15847,PREL

      230    15576    3              ELSE DO;

      231    15577    3                 KZ@LINCTX.POLX = 0;

  15577   1 000281  8846 006C                            LBF,'00FF'X       108,B6
  15577   1 000283       00FF

      232    15578    3                 KZ@LINCTX.OPR = 0;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:57   
  15578   1 000284  8846 006D                            LBF,'00FF'X       109,B6
  15578   1 000286       00FF

      233    15579    4                 IF KZ@LINCTX.ACTCTR = 0 THEN DO;

  15579   1 000287  E2C6 006D                            LLH,R6   109,B6
          1 000289  6981 000F                            BNEZ,R6  s:15585,PREL

      234    15580    4                    KZ@LINCTX.FLAGS.CTRINITDONE = '0'B;

  15580   1 00028B  8846 0034                            LBF,'0010'X       52,B6
  15580   1 00028D       0010

      235    15581    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_POLINACT;

  15581   1 00028E  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 000290  5C1B                                 LDV,R5   27
          1 000291  DF45 0001                            STR,R5   1,B5

      236    15582    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15582   1 000293  6C03                                 LDV,R6   3
          1 000294  EF45 0004                            STR,R6   4,B5

      237    15583    4                    ALTRETURN;

  15583   1 000296  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      238    15584    4                    END;
      239    15585    3                 IF KZ@LINCTX.OTPCNT = 0 THEN

  15585   1 000299  D846 004D                            LDR,R5   77,B6
          1 00029B  5901 0022                            BEZ,R5   s:15595,PREL

      240    15586    3                    GOTO NO_OTP;           /* Try to save some overhead          */
      241    15587    3                 KZ$EVENT.EVENT=%KZ#LINFCN_GETOTP;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:58   
  15587   1 00029D  4C01                                 LDV,R4   1
          1 00029E  CF47 0008                            STR,R4   KZ$EVENT,AUTO

      242    15588    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT)

  15588   1 0002A0  DBC7 0008                            LAB,B5   KZ$EVENT,AUTO
          1 0002A2  DFC7 0044                            STB,B5   FPT_WRSYSLOG+22,AUTO
          1 0002A4  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0002A6  9CC6 006E                            LDB,B1   110,B6
          1 0002A8  CBF0 0100                            LAB,B4   256,IMO
          1 0002AA  E381                                 LNJ,B6   ,B1
          1 0002AB       0013                            DC       s:15595,PREL

      243    15589    3                   ALTRET ( NO_OTP );
      244    15590    3                 KZ$3270STT.SNDOTP = KZ$3270STT.SNDOTP + 1;

  15590   1 0002AC  EC80 0000 0006  xsym                 LDB,B6   KZ_3270M_HDR+6
          1 0002AF  8AC6 0095                            INC      149,B6
          1 0002B1  8EC6 0094                            CAD      148,B6

      245    15591    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SNDOTP;

  15591   1 0002B3  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 0002B5  6C13                                 LDV,R6   19
          1 0002B6  EF45 0001                            STR,R6   1,B5

      246    15592    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15592   1 0002B8  5C03                                 LDV,R5   3
          1 0002B9  DF45 0004                            STR,R5   4,B5

      247    15593    3                 ALTRETURN;

  15593   1 0002BB  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      248    15594
      249    15595    3   NO_OTP:       CALL KHC$TIME2 (TIME);
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:59   

  15595   1 0002BE  EBC7 0021            NO_OTP          LAB,B6   TIME,AUTO
          1 0002C0  EFC7 0044                            STB,B6   FPT_WRSYSLOG+22,AUTO
          1 0002C2  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0002C4  CBF0 0100                            LAB,B4   256,IMO
          1 0002C6  E380 0000 0000  xent                 LNJ,B6   KHC$TIME2
          1 0002C9       0001                            DC       s:15596,PREL

      250    15596    3                 IF TIME - KZ@LINCTX.TIMR.GENPOL >= KZ@LINCTX.PRO.INTERVAL THEN

  15596   1 0002CA  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0002CC  8CC7 0021                            LDI      TIME,AUTO
          1 0002CE  84C6 0077                            SID      119,B6
          1 0002D0  8D47 0044                            SDI      FPT_WRSYSLOG+22,AUTO
          1 0002D2  F846 003F                            LDR,R7   63,B6
          1 0002D4  6C00                                 LDV,R6   0
          1 0002D5  84C7 0044                            SID      FPT_WRSYSLOG+22,AUTO
          1 0002D7  6801 FF1A                            BLZ,R6   s:15543,PREL
          1 0002D9  6A01 0003                            BGZ,R6   s:15598,PREL
          1 0002DB  7901 FF16                            BEZ,R7   s:15543,PREL

      251    15597    3                    GOTO GENPOL;
      252    15598    3                 KZ$3270STT.WAT = KZ$3270STT.WAT + 1;

  15598   1 0002DD  DC80 0000 0006  xsym                 LDB,B5   KZ_3270M_HDR+6
          1 0002E0  8AC5 0099                            INC      153,B5
          1 0002E2  8EC5 0098                            CAD      152,B5

      253    15599    3                 KH$CLK=KH_CLK_SET;

  15599   1 0002E4  AB80 0000 0000  00                   LAB,B2   KZ_EVENT
          1 0002E7  2C1C                                 LDV,R2   28
          1 0002E8  6C16                                 LDV,R6   22
          1 0002E9  BB87                                 LAB,B3   ,AUTO
          1 0002EA  3C2C                                 LDV,R3   44
          1 0002EB  0008                                 MMM

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:60   
      254    15600    3                 KH$CLK.PRDUNT = %KH#C_TMIL;

  15600   1 0002EC  8847 001C                            LBF,'00FF'X       KH$CLK+6,AUTO
  15600   1 0002EE       00FF

      255    15601    3                 KH$CLK.UID$ = ADDR(KZ@LINCTX);

  15601   1 0002EF  EFC7 0018                            STB,B6   KH$CLK+2,AUTO

      256    15602    3                 KH$CLK.SBR$ = KZT_GO@;

  15602   1 0002F1  DC80 0000 0000  xsym                 LDB,B5   KZT_GO@
          1 0002F4  DFC7 001E                            STB,B5   KH$CLK+8,AUTO

      257    15603    3                 TIME = KZ@LINCTX.PRO.INTERVAL -

  15603   1 0002F6  F846 003F                            LDR,R7   63,B6
          1 0002F8  6C00                                 LDV,R6   0
          1 0002F9  84C7 0021                            SID      TIME,AUTO
          1 0002FB  8446 0077                            AID      119,B6
          1 0002FD  8D47 0021                            SDI      TIME,AUTO

      258    15604    3                   TIME + KZ@LINCTX.TIMR.GENPOL;
      259    15605    3                 TINY_TIME_PARTICLES.WD2 = (TINY_TIME_PARTICLES.WD2*5)/6;

  15605   1 0002FF  F847 0022                            LDR,R7   TIME+1,AUTO
          1 000301  6C00                                 LDV,R6   0
          1 000302  9B80 0000 0000  02                   LAB,B1   0
          1 000305  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          1 000308  F370 0006                            DIV,R7   6,IMO
          1 00030A  E857                                 LDR,R6   R7
          1 00030B  EF47 0022                            STR,R6   TIME+1,AUTO

      260    15606    3                 IF TINY_TIME_PARTICLES.WD2=0 THEN

  15606   1 00030D  6981 0004                            BNEZ,R6  s:15608,PREL

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:61   
      261    15607    3                    TINY_TIME_PARTICLES.WD2=1;

  15607   1 00030F  6C01                                 LDV,R6   1
          1 000310  EF47 0022                            STR,R6   TIME+1,AUTO

      262    15608    3                 IF TINY_TIME_PARTICLES.WD2>25500 THEN

  15608   1 000312  E970 639C                            CMR,R6   25500,IMO
          1 000314  0381 0005                            BLE      s:15610,PREL

      263    15609    3                    TINY_TIME_PARTICLES.WD2=25500;

  15609   1 000316  E870 639C                            LDR,R6   25500,IMO
          1 000318  EF47 0022                            STR,R6   TIME+1,AUTO

      264    15610    3                 IF TINY_TIME_PARTICLES.WD2 <= 255 THEN

  15610   1 00031A  E970 00FF                            CMR,R6   255,IMO
          1 00031C  0301 0005                            BG       s:15613,PREL

      265    15611    3                    KH$CLK.PRD = TINY_TIME_PARTICLES.WD2;

  15611   1 00031E  EF47 0020                            STR,R6   KH$CLK+10,AUTO
          1 000320  0F81 000C                            B        s:15616,PREL

      266    15612    4                 ELSE DO;                  /* Must change resolution             */

      267    15613    4                    KH$CLK.PRD = TINY_TIME_PARTICLES.WD2 / 100;

  15613   1 000322  F856                                 LDR,R7   R6
          1 000323  6C00                                 LDV,R6   0
          1 000324  F370 0064                            DIV,R7   100,IMO
          1 000326  E857                                 LDR,R6   R7
          1 000327  EF47 0020                            STR,R6   KH$CLK+10,AUTO

      268    15614    4                    KH$CLK.PRDUNT = %KH#C_SEC;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:62   
  15614   1 000329  5C01                                 LDV,R5   1
          1 00032A  DAC7 001C                            SRM,R5,'00FF'X    KH$CLK+6,AUTO
          1 00032C       00FF

      269    15615    4                    END;

      270    15616    3                 CALL KHC$CLOCK (KH$CLK) ALTRET (OUCH);

  15616   1 00032D  EBC7 0016                            LAB,B6   KH$CLK,AUTO
          1 00032F  EFC7 0044                            STB,B6   FPT_WRSYSLOG+22,AUTO
          1 000331  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000333  CBF0 0100                            LAB,B4   256,IMO
          1 000335  E380 0000 0000  xent                 LNJ,B6   KHC$CLOCK
          1 000338       02F0                            DC       s:15848,PREL

      271    15617    3                 KZ@LINCTX.CTB.PRM$=KH$CLK.CTBCTX$;

  15617   1 000339  ECC7 0016                            LDB,B6   KH$CLK,AUTO
          1 00033B  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 00033D  EFC5 0031                            STB,B6   49,B5

      272    15618    3                 KZ@LINCTX.PRMCTBTYP = %KZ#CTBTYP_DELAY;

  15618   1 00033F  6C03                                 LDV,R6   3
          1 000340  EAC5 000C                            SRM,R6,'00FF'X    12,B5
          1 000342       00FF

      273    15619
      274    15620    3                 END;

  15620   1 000343  0F81 02E1                            B        s:15847,PREL

      275    15621        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:63   
      276    15622    2            CASE ( %KZ#3270ACT_EOT );

      277    15623
      278    15624    3              DO CASE(KZ@LINCTX.OPR);

  15624   1 000345  9846 006D                            LDR,R1   109,B6
          1 000347  9570 00FF                            AND,R1   255,IMO
          1 000349  1D06                                 CMV,R1   6
          1 00034A  0281 0038                            BGE      s:15648,PREL
          1 00034C  B810 0000 0352  01                   LDR,R3   s:15624+13,R1
          1 00034F  83B0 0000 0358  01                   JMP      s:15627,R3
          1 000352       0000                            DC       s:15627,PREL
          1 000353       0000                            DC       s:15627,PREL
          1 000354       0005                            DC       s:15630,PREL
          1 000355       000A                            DC       s:15633,PREL
          1 000356       000F                            DC       s:15636,PREL
          1 000357       0028                            DC       s:15645,PREL

      279    15625
      280    15626    3               CASE (%KZ#3270_OPR_GENPOL,0);

      281    15627    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_POL; /* GENPOL                      */

  15627   1 000358  6C15                                 LDV,R6   21
          1 000359  EF45 0001                            STR,R6   1,B5
          1 00035B  0F81 0027                            B        s:15648,PREL

      282    15628
      283    15629    3               CASE (%KZ#3270_OPR_SPCPOLALL);

      284    15630    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_POLALL;

  15630   1 00035D  6C14                                 LDV,R6   20
          1 00035E  EF45 0001                            STR,R6   1,B5
          1 000360  0F81 0022                            B        s:15648,PREL

      285    15631
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:64   
      286    15632    3               CASE (%KZ#3270_OPR_SPCPOL);

      287    15633    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SNDOTP;

  15633   1 000362  6C13                                 LDV,R6   19
          1 000363  EF45 0001                            STR,R6   1,B5
          1 000365  0F81 001D                            B        s:15648,PREL

      288    15634
      289    15635    3               CASE (%KZ#3270_OPR_RQSCTR);

      290    15636    3                 IF KZ@BSCFPT.EVT = %KZ#3270EVT_EOT THEN

  15636   1 000367  E845 0001                            LDR,R6   1,B5
          1 000369  6D0F                                 CMV,R6   15
          1 00036A  0981 0006                            BNE      s:15639,PREL

      291    15637    3                    KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15637   1 00036C  6C01                                 LDV,R6   1
          1 00036D  EF45 0001                            STR,R6   1,B5
          1 00036F  0F81 0013                            B        s:15648,PREL

      292    15638    3                 ELSE
      293    15639    3                    IF NOT KZ@LINCTX.FLAGS.CTRINITDONE THEN

  15639   1 000371  82C6 0034                            LB,'0010'X        52,B6
  15639   1 000373       0010
          1 000374  0501 0006                            BBT      s:15642,PREL

      294    15640    3                       KZ@BSCFPT.EVT = %KZ#3270EVT_POLINACT;

  15640   1 000376  6C1B                                 LDV,R6   27
          1 000377  EF45 0001                            STR,R6   1,B5
          1 000379  0F81 0009                            B        s:15648,PREL

      295    15641    3                    ELSE
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:65   
      296    15642    3                       KZ@BSCFPT.EVT = %KZ#3270EVT_POL; /* GENPOL                */

  15642   1 00037B  6C15                                 LDV,R6   21
          1 00037C  EF45 0001                            STR,R6   1,B5
          1 00037E  0F81 0004                            B        s:15648,PREL

      297    15643
      298    15644    3               CASE (%KZ#3270_OPR_SPCPOLCTR);

      299    15645    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15645   1 000380  6C01                                 LDV,R6   1
          1 000381  EF45 0001                            STR,R6   1,B5

      300    15646    3               END;

      301    15647
      302    15648    2              KZ@LINCTX.CURCTR$=ADDR(NIL);

  15648   1 000383  CB80 0000 0000                       LAB,B4   0
          1 000386  CFC6 004E                            STB,B4   78,B6

      303    15649    2              KZ@LINCTX.CURDEV$=ADDR(NIL);

  15649   1 000388  AB80 0000 0000                       LAB,B2   0
          1 00038B  AFC6 0050                            STB,B2   80,B6

      304    15650
      305    15651    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15651   1 00038D  6C03                                 LDV,R6   3
          1 00038E  EF45 0004                            STR,R6   4,B5

      306    15652    2              ALTRETURN;

  15652   1 000390  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:66   
      307    15653        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:67   
      308    15654    2            CASE ( %KZ#3270ACT_1STSND,

      309    15655    2                %KZ#3270ACT_EVNSND,
      310    15656    2                %KZ#3270ACT_ODDSND );
      311    15657
      312    15658    2              IF (KZ@BSCFPT.OLDSTT = %KZ#M3270STT_ODDENQSND AND

  15658   1 000393  E845 0002                            LDR,R6   2,B5
          1 000395  E570 00FF                            AND,R6   255,IMO
          1 000397  6D14                                 CMV,R6   20
          1 000398  0981 0006                            BNE      s:15658+12,PREL
          1 00039A  D845 0001                            LDR,R5   1,B5
          1 00039C  5D0A                                 CMV,R5   10
          1 00039D  0901 0071                            BE       s:15696,PREL
          1 00039F  6D15                                 CMV,R6   21
          1 0003A0  0981 0006                            BNE      s:15662,PREL
          1 0003A2  D845 0001                            LDR,R5   1,B5
          1 0003A4  5D0B                                 CMV,R5   11
          1 0003A5  0901 0069                            BE       s:15696,PREL

      313    15659    2                KZ@BSCFPT.EVT = %KZ#3270EVT_ACK0) OR
      314    15660    2                (KZ@BSCFPT.OLDSTT = %KZ#M3270STT_EVNENQSND AND
      315    15661    2                KZ@BSCFPT.EVT = %KZ#3270EVT_ACK1) THEN GOTO SND;
      316    15662    3              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_NAK THEN DO;

  15662   1 0003A7  D845 0001                            LDR,R5   1,B5
          1 0003A9  5D0C                                 CMV,R5   12
          1 0003AA  0901 008F                            BE       s:15702,PREL

      317    15663    4                 IF KZ@LINCTX.RTRCNT~=0 THEN DO;

  15663   1 0003AC  C846 0039                            LDR,R4   57,B6
          1 0003AE  4901 000C                            BEZ,R4   s:15667,PREL

      318    15664    4                    CALL ERRLOG (%E$3270IO_OK);

  15664   1 0003B0  CBF0 00CD                            LAB,B4   205,IMO
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:68   
          1 0003B2  CFC7 002C                            STB,B4   T$+7,AUTO
          1 0003B4  E3C0 0362                            LNJ,B6   s:0,PREL
          1 0003B6       0001                            DC       s:15665,PREL

      319    15665    4                    KZ@LINCTX.RTRCNT = 0;

  15665   1 0003B7  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0003B9  8746 0039                            CL       57,B6

      320    15666    4                    END;

      321    15667    3                 IF KZ@BSCFPT.ACT ~= %KZ#3270ACT_1STSND THEN

  15667   1 0003BB  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 0003BD  E805                                 LDR,R6   ,B5
          1 0003BE  6D03                                 CMV,R6   3
          1 0003BF  0901 0010                            BE       s:15672,PREL

      322    15668    4                 DO;

      323    15669    4                    KZ$EVENT.EVENT=%KZ#LINFCN_RELOTP;

  15669   1 0003C1  5C03                                 LDV,R5   3
          1 0003C2  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      324    15670    4                    CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);

  15670   1 0003C4  CBC7 0008                            LAB,B4   KZ$EVENT,AUTO
          1 0003C6  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 0003C8  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0003CA  9CC6 006E                            LDB,B1   110,B6
          1 0003CC  CBF0 0100                            LAB,B4   256,IMO
          1 0003CE  E381                                 LNJ,B6   ,B1
          1 0003CF       0001                            DC       s:15672,PREL

      325    15671    4                    END;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:69   
      326    15672    3                 IF KZ@BSCFPT.EVT=%KZ#3270EVT_RVI THEN

  15672   1 0003D0  ECC7 0006                            LDB,B6   @KZ@BSCFPT,AUTO
          1 0003D2  E846 0001                            LDR,R6   1,B6
          1 0003D4  6D0D                                 CMV,R6   13
          1 0003D5  0981 000A                            BNE      s:15678,PREL

      327    15673    4                 DO;

      328    15674    4                    KZ@BSCFPT.EVT=%KZ#3270EVT_GO;

  15674   1 0003D7  6C01                                 LDV,R6   1
          1 0003D8  EF46 0001                            STR,R6   1,B6

      329    15675    4                    KZ@BSCFPT.FNC=%KZ#FNC_MOV;

  15675   1 0003DA  5C03                                 LDV,R5   3
          1 0003DB  DF46 0004                            STR,R5   4,B6

      330    15676    4                    ALTRETURN;

  15676   1 0003DD  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      331    15677    4                    END;
      332    15678    3                 IF KZ@BSCFPT.EVT = %KZ#3270EVT_WACK THEN

  15678   1 0003E0  6D09                                 CMV,R6   9
          1 0003E1  0981 0012                            BNE      s:15683,PREL

      333    15679    4                 DO;

      334    15680    4                    KZ$EVENT.EVENT=%KZ#LINFCN_WAIT;

  15680   1 0003E3  5C0A                                 LDV,R5   10
          1 0003E4  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      335    15681    4                    CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:70   

  15681   1 0003E6  DBC7 0008                            LAB,B5   KZ$EVENT,AUTO
          1 0003E8  DFC7 0044                            STB,B5   FPT_WRSYSLOG+22,AUTO
          1 0003EA  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0003EC  CCC7 0004                            LDB,B4   @KZ@LINCTX,AUTO
          1 0003EE  9CC4 006E                            LDB,B1   110,B4
          1 0003F0  CBF0 0100                            LAB,B4   256,IMO
          1 0003F2  E381                                 LNJ,B6   ,B1
          1 0003F3       0001                            DC       s:15683,PREL

      336    15682    4                    END;

      337    15683    4                 IF KZ@LINCTX.OTPHD$ = ADDR(NIL) THEN DO;

  15683   1 0003F4  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0003F6  8DC6 0052                            CMN      82,B6
          1 0003F8  0981 000C                            BNE      s:15688,PREL

      338    15684    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15684   1 0003FA  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 0003FC  6C01                                 LDV,R6   1
          1 0003FD  EF45 0001                            STR,R6   1,B5

      339    15685    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15685   1 0003FF  5C03                                 LDV,R5   3
          1 000400  DF45 0004                            STR,R5   4,B5

      340    15686    4                    ALTRETURN;

  15686   1 000402  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      341    15687    4                    END;
      342    15688    3                 KZ@LINCTX.OTPBFR$ = PINCRW(KZ@LINCTX.OTPHD$,

  15688   1 000405  DCC6 0052                            LDB,B5   82,B6
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:71   
          1 000407  CBC5 0008                            LAB,B4   8,B5
          1 000409  CFC6 005A                            STB,B4   90,B6

      343    15689    3                   SIZEW(KZ$OTPBFR));
      344    15690    3                 KZ@LINCTX.OTPDATSIZ = KZ@LINCTX.OTPHD$ ->

  15690   1 00040B  E845 0003                            LDR,R6   3,B5
          1 00040D  EF46 005D                            STR,R6   93,B6

      345    15691    3                   KZ$OTPBFR.DATA_SIZ;
      346    15692    3   SND:
      347    15693        /*N*               IF KZ@LINCTX.OTPHD$ ~= KZ@LINCTX.OTPTL$ THEN
      348    15694                                CALL KZT_ORDERS@ ( %KZ#SEND_BLOCK, KZ@LINCTX );
      349    15695                           ELSE */
      350    15696    3                 IF KZ@LINCTX.OTPHD$ -> KZ$OTPBFR.FLAGS.TRANS# THEN

  15696   1 00040F  ECC7 0004            SND             LDB,B6   @KZ@LINCTX,AUTO
          1 000411  DCC6 0052                            LDB,B5   82,B6
          1 000413  82C5 0002                            LB,'0001'X        2,B5
          1 000415       0001
          1 000416  0581 0012                            BBF      s:15699,PREL

      351    15697    3                    CALL KZT_ORDERS@ ( %KZ#SEND_TTEXT, KZ@LINCTX );

  15697   1 000418  CBF0 0011                            LAB,B4   17,IMO
          1 00041A  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 00041C  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 00041E  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000420  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000423  CBF0 0200                            LAB,B4   512,IMO
          1 000425  E381                                 LNJ,B6   ,B1
          1 000426       0001                            DC       s:15697+15,PREL
          1 000427  0F81 01FD                            B        s:15847,PREL

      352    15698    3                 ELSE
      353    15699    3                    CALL KZT_ORDERS@ ( %KZ#SEND_TEXT, KZ@LINCTX );

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:72   
  15699   1 000429  CBF0 0002                            LAB,B4   2,IMO
          1 00042B  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 00042D  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 00042F  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000431  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000434  CBF0 0200                            LAB,B4   512,IMO
          1 000436  E381                                 LNJ,B6   ,B1
          1 000437       0001                            DC       s:15700,PREL

      354    15700    3                 END;

  15700   1 000438  0F81 01EC                            B        s:15847,PREL

      355    15701    3              ELSE DO;

      356    15702    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;

  15702   1 00043A  8AC6 0039                            INC      57,B6

      357    15703    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND

  15703   1 00043C  E846 003D                            LDR,R6   61,B6
          1 00043E  6951                                 BEZ,R6   s:15696,SPREL
          1 00043F  E946 0039                            CMR,R6   57,B6
          1 000441  02CE                                 BGE      s:15696,SPREL

      358    15704    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;

      359    15705    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;

  15705   1 000442  5C04                                 LDV,R5   4
          1 000443  DF45 0001                            STR,R5   1,B5

      360    15706    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15706   1 000445  6C03                                 LDV,R6   3
          1 000446  EF45 0004                            STR,R6   4,B5
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:73   

      361    15707    4                    ALTRETURN;

  15707   1 000448  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      362    15708    4                    END;
      363    15709    3                 ELSE
      364    15710    3                    GOTO SND;
      365    15711    3                 END;
      366    15712        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:74   
      367    15713    2            CASE ( %KZ#3270ACT_1STENQ,

      368    15714    2                   %KZ#3270ACT_ODDENQ,
      369    15715    2                   %KZ#3270ACT_EVNENQ );
      370    15716
      371    15717    2              KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;

  15717   1 00044B  8AC6 0039                            INC      57,B6

      372    15718    2              IF KZ@LINCTX.PRO.RETRYS > 0 AND

  15718   1 00044D  E846 003D                            LDR,R6   61,B6
          1 00044F  6901 000E                            BEZ,R6   s:15725,PREL
          1 000451  E946 0039                            CMR,R6   57,B6
          1 000453  0281 000A                            BGE      s:15725,PREL

      373    15719    3                KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;

      374    15720    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SPARE25;

  15720   1 000455  5C16                                 LDV,R5   22
          1 000456  DF45 0001                            STR,R5   1,B5

      375    15721    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15721   1 000458  6C03                                 LDV,R6   3
          1 000459  EF45 0004                            STR,R6   4,B5

      376    15722    3                 ALTRETURN;

  15722   1 00045B  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      377    15723    3                 END;
      378    15724    2              ELSE
      379    15725    2                 CALL KZT_ORDERS@ ( %KZ#SEND_ENQ, KZ@LINCTX );

  15725   1 00045E  CBF0 000D                            LAB,B4   13,IMO
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:75   
          1 000460  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 000462  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000464  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000466  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000469  CBF0 0200                            LAB,B4   512,IMO
          1 00046B  E381                                 LNJ,B6   ,B1
          1 00046C       0001                            DC       s:15725+15,PREL
          1 00046D  0F81 01B7                            B        s:15847,PREL

      380    15726        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:76   
      381    15727    2            CASE ( %KZ#3270ACT_GNACK1 );

      382    15728
      383    15729    3              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_ENQ THEN DO;

  15729   1 00046F  E845 0001                            LDR,R6   1,B5
          1 000471  6D0E                                 CMV,R6   14
          1 000472  0901 0017                            BE       s:15737,PREL

      384    15730    3                 CALL RPTINP;

  15730   1 000474  E3C0 01B8                            LNJ,B6   s:0,PREL
          1 000476       0001                            DC       s:15731,PREL

      385    15731    4                 IF KZ@LINCTX.RTRCNT ~= 0 THEN DO;

  15731   1 000477  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000479  E846 0039                            LDR,R6   57,B6
          1 00047B  6901 0021                            BEZ,R6   s:15745,PREL

      386    15732    4                    CALL ERRLOG (%E$3270IO_OK);

  15732   1 00047D  DBF0 00CD                            LAB,B5   205,IMO
          1 00047F  DFC7 002C                            STB,B5   T$+7,AUTO
          1 000481  E3C0 0295                            LNJ,B6   s:0,PREL
          1 000483       0001                            DC       s:15733,PREL

      387    15733    4                    KZ@LINCTX.RTRCNT = 0;

  15733   1 000484  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000486  8746 0039                            CL       57,B6

      388    15734    4                    END;

      389    15735    3                 END;

  15735   1 000488  0F81 0014                            B        s:15745,PREL
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:77   

      390    15736    3              ELSE DO;

      391    15737    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;

  15737   1 00048A  8AC6 0039                            INC      57,B6

      392    15738    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND

  15738   1 00048C  E846 003D                            LDR,R6   61,B6
          1 00048E  6901 000E                            BEZ,R6   s:15745,PREL
          1 000490  E946 0039                            CMR,R6   57,B6
          1 000492  0281 000A                            BGE      s:15745,PREL

      393    15739    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;

      394    15740    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;

  15740   1 000494  5C04                                 LDV,R5   4
          1 000495  DF45 0001                            STR,R5   1,B5

      395    15741    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15741   1 000497  6C03                                 LDV,R6   3
          1 000498  EF45 0004                            STR,R6   4,B5

      396    15742    4                    ALTRETURN;

  15742   1 00049A  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      397    15743    4                    END;
      398    15744    3                 END;
      399    15745    2              CALL KZT_ORDERS@ ( %KZ#SEND_ACK1, KZ@LINCTX );

  15745   1 00049D  DBF0 000B                            LAB,B5   11,IMO
          1 00049F  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 0004A1  DFC7 0044                            STB,B5   FPT_WRSYSLOG+22,AUTO
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:78   
          1 0004A3  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0004A5  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 0004A8  CBF0 0200                            LAB,B4   512,IMO
          1 0004AA  E381                                 LNJ,B6   ,B1
          1 0004AB       0001                            DC       s:15745+15,PREL
          1 0004AC  0F81 0178                            B        s:15847,PREL

      400    15746        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:79   
      401    15747    2            CASE ( %KZ#3270ACT_GNACK0 );

      402    15748
      403    15749    3              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_ENQ THEN DO;

  15749   1 0004AE  E845 0001                            LDR,R6   1,B5
          1 0004B0  6D0E                                 CMV,R6   14
          1 0004B1  0901 0017                            BE       s:15757,PREL

      404    15750    3                 CALL RPTINP;

  15750   1 0004B3  E3C0 0179                            LNJ,B6   s:0,PREL
          1 0004B5       0001                            DC       s:15751,PREL

      405    15751    4                 IF KZ@LINCTX.RTRCNT ~= 0 THEN DO;

  15751   1 0004B6  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0004B8  E846 0039                            LDR,R6   57,B6
          1 0004BA  6901 0021                            BEZ,R6   s:15765,PREL

      406    15752    4                    CALL ERRLOG (%E$3270IO_OK);

  15752   1 0004BC  DBF0 00CD                            LAB,B5   205,IMO
          1 0004BE  DFC7 002C                            STB,B5   T$+7,AUTO
          1 0004C0  E3C0 0256                            LNJ,B6   s:0,PREL
          1 0004C2       0001                            DC       s:15753,PREL

      407    15753    4                    KZ@LINCTX.RTRCNT = 0;

  15753   1 0004C3  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0004C5  8746 0039                            CL       57,B6

      408    15754    4                    END;

      409    15755    3                 END;

  15755   1 0004C7  0F81 0014                            B        s:15765,PREL
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:80   

      410    15756    3              ELSE DO;

      411    15757    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;

  15757   1 0004C9  8AC6 0039                            INC      57,B6

      412    15758    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND

  15758   1 0004CB  E846 003D                            LDR,R6   61,B6
          1 0004CD  6901 000E                            BEZ,R6   s:15765,PREL
          1 0004CF  E946 0039                            CMR,R6   57,B6
          1 0004D1  0281 000A                            BGE      s:15765,PREL

      413    15759    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;

      414    15760    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;

  15760   1 0004D3  5C04                                 LDV,R5   4
          1 0004D4  DF45 0001                            STR,R5   1,B5

      415    15761    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15761   1 0004D6  6C03                                 LDV,R6   3
          1 0004D7  EF45 0004                            STR,R6   4,B5

      416    15762    4                    ALTRETURN;

  15762   1 0004D9  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      417    15763    4                    END;
      418    15764    3                 END;
      419    15765    2              CALL KZT_ORDERS@ ( %KZ#SEND_ACK0, KZ@LINCTX );

  15765   1 0004DC  DBF0 000A                            LAB,B5   10,IMO
          1 0004DE  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 0004E0  DFC7 0044                            STB,B5   FPT_WRSYSLOG+22,AUTO
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:81   
          1 0004E2  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0004E4  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 0004E7  CBF0 0200                            LAB,B4   512,IMO
          1 0004E9  E381                                 LNJ,B6   ,B1
          1 0004EA       0001                            DC       s:15765+15,PREL
          1 0004EB  0F81 0139                            B        s:15847,PREL

      420    15766        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:82   
      421    15767    2            CASE ( %KZ#3270ACT_ENQNAK,

      422    15768    2                %KZ#3270ACT_ODDNAK,
      423    15769    2                %KZ#3270ACT_EVNNAK );
      424    15770
      425    15771    2              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_TTD THEN

  15771   1 0004ED  E845 0001                            LDR,R6   1,B5
          1 0004EF  6D08                                 CMV,R6   8
          1 0004F0  0901 0003                            BE       s:15774,PREL

      426    15772    2                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;

  15772   1 0004F2  8AC6 0039                            INC      57,B6

      427    15773
      428    15774    2              IF KZ@LINCTX.PRO.RETRYS > 0 AND

  15774   1 0004F4  E846 003D                            LDR,R6   61,B6
          1 0004F6  6901 001F                            BEZ,R6   s:15782,PREL
          1 0004F8  E946 0039                            CMR,R6   57,B6
          1 0004FA  0281 001B                            BGE      s:15782,PREL

      429    15775    3                KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;

      430    15776    3                 CALL KZT_ORDERS@ ( %KZ#SEND_EOT, KZ@LINCTX );

  15776   1 0004FC  CBF0 0009                            LAB,B4   9,IMO
          1 0004FE  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 000500  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000502  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000504  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000507  CBF0 0200                            LAB,B4   512,IMO
          1 000509  E381                                 LNJ,B6   ,B1
          1 00050A       0001                            DC       s:15777,PREL

      431    15777    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:83   

  15777   1 00050B  ECC7 0006                            LDB,B6   @KZ@BSCFPT,AUTO
          1 00050D  6C04                                 LDV,R6   4
          1 00050E  EF46 0001                            STR,R6   1,B6

      432    15778    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15778   1 000510  5C03                                 LDV,R5   3
          1 000511  DF46 0004                            STR,R5   4,B6

      433    15779    3                 ALTRETURN;

  15779   1 000513  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      434    15780    3                 END;
      435    15781    2              ELSE
      436    15782    2                 CALL KZT_ORDERS@ ( %KZ#SEND_NAK, KZ@LINCTX );

  15782   1 000516  CBF0 0006                            LAB,B4   6,IMO
          1 000518  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 00051A  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 00051C  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 00051E  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000521  CBF0 0200                            LAB,B4   512,IMO
          1 000523  E381                                 LNJ,B6   ,B1
          1 000524       0001                            DC       s:15782+15,PREL
          1 000525  0F81 00FF                            B        s:15847,PREL

      437    15783        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:84   
      438    15784    2            CASE ( %KZ#3270ACT_LISTEN );

      439    15785
      440    15786    2              IF KZ@BSCFPT.EVT ~= %KZ#3270EVT_GO THEN

  15786   1 000527  E845 0001                            LDR,R6   1,B5
          1 000529  6D01                                 CMV,R6   1
          1 00052A  0901 0012                            BE       s:15789,PREL

      441    15787    2                 CALL KZT_ORDERS@ ( %KZ#SEND_NOTHING, KZ@LINCTX );

  15787   1 00052C  CBF0 000C                            LAB,B4   12,IMO
          1 00052E  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 000530  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000532  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000534  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000537  CBF0 0200                            LAB,B4   512,IMO
          1 000539  E381                                 LNJ,B6   ,B1
          1 00053A       0001                            DC       s:15787+15,PREL
          1 00053B  0F81 00E9                            B        s:15847,PREL

      442    15788    2              ELSE
      443    15789    2                 CALL KZT_ORDERS@ ( %KZ#SEND_EOT, KZ@LINCTX );

  15789   1 00053D  CBF0 0009                            LAB,B4   9,IMO
          1 00053F  EFC7 0046                            STB,B6   FPT_WRSYSLOG+24,AUTO
          1 000541  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000543  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000545  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 000548  CBF0 0200                            LAB,B4   512,IMO
          1 00054A  E381                                 LNJ,B6   ,B1
          1 00054B       0001                            DC       s:15789+15,PREL
          1 00054C  0F81 00D8                            B        s:15847,PREL

      444    15790        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:85   
      445    15791    2            CASE ( %KZ#3270ACT_POL_RCVD );

      446    15792
      447    15793    2              KZ@LINCTX.FLAGS.CTRINITDONE = '1'B;

  15793   1 00054E  8946 0034                            LBT,'0010'X       52,B6
  15793   1 000550       0010

      448    15794    2              KZ@LINCTX.INPDATSIZ = KZ@BSCFPT.SIZ;

  15794   1 000551  E845 0003                            LDR,R6   3,B5
          1 000553  EF46 0059                            STR,R6   89,B6

      449    15795    2              KZ$EVENT.EVENT=%KZ#LINFCN_POL;

  15795   1 000555  5C11                                 LDV,R5   17
          1 000556  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      450    15796    2              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT,I);

  15796   1 000558  CBC7 0023                            LAB,B4   TEMP_BIT16,AUTO
          1 00055A  CFC7 0046                            STB,B4   FPT_WRSYSLOG+24,AUTO
          1 00055C  ABC7 0008                            LAB,B2   KZ$EVENT,AUTO
          1 00055E  AFC7 0044                            STB,B2   FPT_WRSYSLOG+22,AUTO
          1 000560  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000562  9CC6 006E                            LDB,B1   110,B6
          1 000564  CBF0 0200                            LAB,B4   512,IMO
          1 000566  E381                                 LNJ,B6   ,B1
          1 000567       0001                            DC       s:15797,PREL

      451    15797    3              DO CASE (I);

  15797   1 000568  B847 0023                            LDR,R3   TEMP_BIT16,AUTO
          1 00056A  3D04                                 CMV,R3   4
          1 00056B  0281 00B9                            BGE      s:15847,PREL
          1 00056D  A830 0000 0573  01                   LDR,R2   s:15797+11,R3
          1 000570  83A0 0000 0577  01                   JMP      s:15799,R2
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:86   
          1 000573       006E                            DC       s:15822,PREL
          1 000574       0000                            DC       s:15799,PREL
          1 000575       0050                            DC       s:15816,PREL
          1 000576       005B                            DC       s:15820,PREL

      452    15798    3               CASE (%KZ#LINRSP_EOT);

      453    15799    4                 IF KZ@LINCTX.PRO.INTERVAL~=0 THEN DO;

  15799   1 000577  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000579  E846 003F                            LDR,R6   63,B6
          1 00057B  6901 0040                            BEZ,R6   s:15811,PREL

      454    15800    4                    KH$CLK=KH_CLK_SET;

  15800   1 00057D  AB80 0000 0000  00                   LAB,B2   KZ_EVENT
          1 000580  2C1C                                 LDV,R2   28
          1 000581  6C16                                 LDV,R6   22
          1 000582  BB87                                 LAB,B3   ,AUTO
          1 000583  3C2C                                 LDV,R3   44
          1 000584  0008                                 MMM

      455    15801    4                    KH$CLK.PRDUNT=%KH#C_TMIL;

  15801   1 000585  8847 001C                            LBF,'00FF'X       KH$CLK+6,AUTO
  15801   1 000587       00FF

      456    15802    4                    KH$CLK.PRD=(KZ@LINCTX.PRO.INTERVAL*100)/120;

  15802   1 000588  F846 003F                            LDR,R7   63,B6
          1 00058A  6C00                                 LDV,R6   0
          1 00058B  9B80 0000 0002  02                   LAB,B1   +2
          1 00058E  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          1 000591  F370 0078                            DIV,R7   120,IMO
          1 000593  E857                                 LDR,R6   R7
          1 000594  EF47 0020                            STR,R6   KH$CLK+10,AUTO

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:87   
      457    15803    4                    KH$CLK.UID$=ADDR(KZ@LINCTX);

  15803   1 000596  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000598  EFC7 0018                            STB,B6   KH$CLK+2,AUTO

      458    15804    4                    KH$CLK.SBR$=KZT_GO@;

  15804   1 00059A  DC80 0000 0000  xsym                 LDB,B5   KZT_GO@
          1 00059D  DFC7 001E                            STB,B5   KH$CLK+8,AUTO

      459    15805    4                    IF KH$CLK.PRD=0 THEN KH$CLK.PRD=1;

  15805   1 00059F  6981 0004                            BNEZ,R6  s:15806,PREL

  15805   1 0005A1  6C01                                 LDV,R6   1
          1 0005A2  EF47 0020                            STR,R6   KH$CLK+10,AUTO

      460    15806    4                    CALL KHC$CLOCK (KH$CLK) ALTRET (OUCH);

  15806   1 0005A4  CBC7 0016                            LAB,B4   KH$CLK,AUTO
          1 0005A6  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 0005A8  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0005AA  CBF0 0100                            LAB,B4   256,IMO
          1 0005AC  E380 0000 0000  xent                 LNJ,B6   KHC$CLOCK
          1 0005AF       0079                            DC       s:15848,PREL

      461    15807    4                    KZ@LINCTX.CTB.PRM$=KH$CLK.CTBCTX$;

  15807   1 0005B0  ECC7 0016                            LDB,B6   KH$CLK,AUTO
          1 0005B2  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 0005B4  EFC5 0031                            STB,B6   49,B5

      462    15808    4                    KZ@LINCTX.PRMCTBTYP = %KZ#CTBTYP_DELAY;

  15808   1 0005B6  6C03                                 LDV,R6   3
          1 0005B7  EAC5 000C                            SRM,R6,'00FF'X    12,B5
          1 0005B9       00FF
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:88   

      463    15809    4                    END;

  15809   1 0005BA  0F81 006A                            B        s:15847,PREL

      464    15810    4                 ELSE DO;

      465    15811    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_GO;

  15811   1 0005BC  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 0005BE  5C01                                 LDV,R5   1
          1 0005BF  DF45 0001                            STR,R5   1,B5

      466    15812    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15812   1 0005C1  6C03                                 LDV,R6   3
          1 0005C2  EF45 0004                            STR,R6   4,B5

      467    15813    4                    ALTRETURN;

  15813   1 0005C4  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      468    15814    4                    END;
      469    15815    3               CASE (%KZ#LINRSP_DAT);

      470    15816    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_SNDOTP;

  15816   1 0005C7  ECC7 0006                            LDB,B6   @KZ@BSCFPT,AUTO
          1 0005C9  6C13                                 LDV,R6   19
          1 0005CA  EF46 0001                            STR,R6   1,B6

      471    15817    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15817   1 0005CC  5C03                                 LDV,R5   3
          1 0005CD  DF46 0004                            STR,R5   4,B6

      472    15818    3                 ALTRETURN;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:89   

  15818   1 0005CF  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      473    15819    3               CASE (%KZ#LINRSP_ACK);

      474    15820    3                 CALL KZT_ORDERS@ ( %KZ#SEND_ACK0, KZ@LINCTX );

  15820   1 0005D2  EBF0 000A                            LAB,B6   10,IMO
          1 0005D4  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 0005D6  DFC7 0046                            STB,B5   FPT_WRSYSLOG+24,AUTO
          1 0005D8  EFC7 0044                            STB,B6   FPT_WRSYSLOG+22,AUTO
          1 0005DA  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0005DC  9C80 0000 0000  xsym                 LDB,B1   KZT_ORDERS@
          1 0005DF  CBF0 0200                            LAB,B4   512,IMO
          1 0005E1  E381                                 LNJ,B6   ,B1
          1 0005E2       0001                            DC       s:15820+17,PREL
          1 0005E3  0F81 0041                            B        s:15847,PREL

      475    15821    3               CASE (%KZ#LINRSP_NUL);

      476    15822    3                 KZ@BSCFPT.EVT = %KZ#3270EVT_EOTCMP;

  15822   1 0005E5  ECC7 0006                            LDB,B6   @KZ@BSCFPT,AUTO
          1 0005E7  6C18                                 LDV,R6   24
          1 0005E8  EF46 0001                            STR,R6   1,B6

      477    15823    3                 KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15823   1 0005EA  5C03                                 LDV,R5   3
          1 0005EB  DF46 0004                            STR,R5   4,B6

      478    15824    3                 ALTRETURN;

  15824   1 0005ED  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      479    15825    3               END;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:90   
      480    15826        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:91   
      481    15827    2            CASE ( %KZ#3270ACT_TIMOUT );

      482    15828
      483    15829    3              IF KZ@LINCTX.ACTCTR = 0 THEN DO;

  15829   1 0005F0  E2C6 006D                            LLH,R6   109,B6
          1 0005F2  6981 0014                            BNEZ,R6  s:15838,PREL

      484    15830    3                 KZ@LINCTX.RTRCNT = KZ@LINCTX.RTRCNT + 1;

  15830   1 0005F4  8AC6 0039                            INC      57,B6

      485    15831    3                 IF KZ@LINCTX.PRO.RETRYS > 0 AND

  15831   1 0005F6  D846 003D                            LDR,R5   61,B6
          1 0005F8  5901 000E                            BEZ,R5   s:15838,PREL
          1 0005FA  D946 0039                            CMR,R5   57,B6
          1 0005FC  0281 000A                            BGE      s:15838,PREL

      486    15832    4                   KZ@LINCTX.RTRCNT > KZ@LINCTX.PRO.RETRYS THEN DO;

      487    15833    4                    KZ@BSCFPT.EVT = %KZ#3270EVT_URCERR;

  15833   1 0005FE  4C04                                 LDV,R4   4
          1 0005FF  CF45 0001                            STR,R4   1,B5

      488    15834    4                    KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15834   1 000601  6C03                                 LDV,R6   3
          1 000602  EF45 0004                            STR,R6   4,B5

      489    15835    4                    ALTRETURN;

  15835   1 000604  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      490    15836    4                    END;
      491    15837    3                 END;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:92   
      492    15838    3              IF NOT KZ@LINCTX.PRO.SLAVE THEN DO;

  15838   1 000607  89C6 004B                            CMZ      75,B6
          1 000609  0801 0010                            BAL      s:15842,PREL

      493    15839    3                 KZ$EVENT.EVENT=%KZ#LINFCN_POLTIMOUT;

  15839   1 00060B  5C05                                 LDV,R5   5
          1 00060C  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      494    15840    3                 CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);

  15840   1 00060E  CBC7 0008                            LAB,B4   KZ$EVENT,AUTO
          1 000610  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 000612  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000614  9CC6 006E                            LDB,B1   110,B6
          1 000616  CBF0 0100                            LAB,B4   256,IMO
          1 000618  E381                                 LNJ,B6   ,B1
          1 000619       0001                            DC       s:15842,PREL

      495    15841    3                 END;

      496    15842    2              KZ@BSCFPT.EVT = %KZ#3270EVT_EOTCMP; /* NO NEED TO SEND EOT         */

  15842   1 00061A  ECC7 0006                            LDB,B6   @KZ@BSCFPT,AUTO
          1 00061C  6C18                                 LDV,R6   24
          1 00061D  EF46 0001                            STR,R6   1,B6

      497    15843    2              KZ@BSCFPT.FNC = %KZ#FNC_MOV;

  15843   1 00061F  5C03                                 LDV,R5   3
          1 000620  DF46 0004                            STR,R5   4,B6

      498    15844    2              ALTRETURN;

  15844   1 000622  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:93   
      499    15845
      500    15846    2            END;

      501    15847    1           RETURN;

  15847   1 000625  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      502    15848    1   OUCH:   CALL SCREECH;

  15848   1 000628  E3C0 00E4            OUCH            LNJ,B6   s:0,PREL
          1 00062A       0001                            DC       s:15848+3,PREL
          1 00062B  0F81 0172                            B        s:16155,PREL

      503    15849        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:94   
      504    15850    1   RPTINP: PROC;

  15850   1 00062D  EFC7 0028            RPTINP          STB,B6   T$+3,AUTO

      505    15851
      506    15852    2           IF KZ@BSCFPT.SIZ > 0 THEN

  15852   1 00062F  DCC7 0006                            LDB,B5   @KZ@BSCFPT,AUTO
          1 000631  E845 0003                            LDR,R6   3,B5
          1 000633  6901 0008                            BEZ,R6   s:15854,PREL

      507    15853    2              KZ@LINCTX.INPDATSIZ = KZ@BSCFPT.SIZ - 1; /* DON'T COUNT ETX/ETB    */

  15853   1 000635  CCC7 0004                            LDB,B4   @KZ@LINCTX,AUTO
          1 000637  6EFF                                 ADV,R6   -1
          1 000638  EF44 0059                            STR,R6   89,B4
          1 00063A  0F81 0005                            B        s:15855,PREL

      508    15854    2           ELSE KZ@LINCTX.INPDATSIZ = 0;

  15854   1 00063C  CCC7 0004                            LDB,B4   @KZ@LINCTX,AUTO
          1 00063E  8744 0059                            CL       89,B4

      509    15855    2           IF KZ@BSCFPT.EVT = %KZ#3270EVT_TSTRQS OR

  15855   1 000640  E845 0001                            LDR,R6   1,B5
          1 000642  6D11                                 CMV,R6   17
          1 000643  0901 0005                            BE       s:15857,PREL
          1 000645  89C4 0085                            CMZ      133,B4
          1 000647  0881 001F                            BAGE     s:15864,PREL

      510    15856    3             KZ@LINCTX.CNTTSTRQS THEN DO;

      511    15857    3              KZ@LINCTX.CURDEV$ = ADDR(NIL);

  15857   1 000649  BB80 0000 0000                       LAB,B3   0
          1 00064C  BFC4 0050                            STB,B3   80,B4
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:95   

      512    15858    3              KZ@LINCTX.CURCTR$ = ADDR(NIL);

  15858   1 00064E  AB80 0000 0000                       LAB,B2   0
          1 000651  AFC4 004E                            STB,B2   78,B4

      513    15859    3              IF KZ@LINCTX.INPBFR$->CTR(KZ@LINCTX.INPDATSIZ)=3 /*ETX*/

  15859   1 000653  9CC4 0056                            LDB,B1   86,B4
          1 000655  B844 0059                            LDR,R3   89,B4
          1 000657  E2B1                                 LLH,R6   ,B1,R3
          1 000658  6D03                                 CMV,R6   3
          1 000659  0981 0006                            BNE      s:15861,PREL

      514    15860    3              THEN KZ@LINCTX.CNTTSTRQS='0'B;

  15860   1 00065B  8844 0085                            LBF,'8000'X       133,B4
  15860   1 00065D       8000
          1 00065E  0F81 0004                            B        s:15862,PREL

      515    15861    3              ELSE KZ@LINCTX.CNTTSTRQS='1'B;

  15861   1 000660  8944 0085                            LBT,'8000'X       133,B4
  15861   1 000662       8000

      516    15862    3              RETURN;                      /* Ignore test-request                */

  15862   1 000663  ECC7 0028                            LDB,B6   T$+3,AUTO
          1 000665  C3C6 0001                            LNJ,B4   1,B6

      517    15863    3              END;
      518    15864    3           IF KZ@BSCFPT.EVT = %KZ#3270EVT_STATUS THEN DO;

  15864   1 000667  6D10                                 CMV,R6   16
          1 000668  0981 0012                            BNE      s:15869,PREL

      519    15865    3              KZ$EVENT.EVENT=%KZ#LINFCN_STATUS;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:96   

  15865   1 00066A  5C0F                                 LDV,R5   15
          1 00066B  DF47 0008                            STR,R5   KZ$EVENT,AUTO

      520    15866    3              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT);

  15866   1 00066D  BBC7 0008                            LAB,B3   KZ$EVENT,AUTO
          1 00066F  BFC7 0044                            STB,B3   FPT_WRSYSLOG+22,AUTO
          1 000671  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000673  9CC4 006E                            LDB,B1   110,B4
          1 000675  CBF0 0100                            LAB,B4   256,IMO
          1 000677  E381                                 LNJ,B6   ,B1
          1 000678       0001                            DC       s:15867,PREL

      521    15867    3              END;

  15867   1 000679  0F81 008F                            B        s:15904,PREL

      522    15868    3           ELSE DO;

      523    15869    3              TEMP_BIT16 = '0'B;

  15869   1 00067B  8747 0023                            CL       TEMP_BIT16,AUTO

      524    15870    3              IF KZ@LINCTX.FLAGS.FIRST THEN

  15870   1 00067D  82C4 0034                            LB,'0080'X        52,B4
  15870   1 00067F       0080
          1 000680  0581 0005                            BBF      s:15872,PREL

      525    15871    3                 TEMP_BIT16 = %KZ#LINSTAT_FIRST;

  15871   1 000682  E870 8000                            LDR,R6   -32768,IMO
          1 000684  EF47 0023                            STR,R6   TEMP_BIT16,AUTO

      526    15872    4              IF KZ@BSCFPT.EVT = %KZ#3270EVT_ETXBLK THEN DO;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:97   
  15872   1 000686  E845 0001                            LDR,R6   1,B5
          1 000688  6D06                                 CMV,R6   6
          1 000689  0981 000C                            BNE      s:15876,PREL

      527    15873    4                 TEMP_BIT16 = %KZ#LINSTAT_LAST | TEMP_BIT16;

  15873   1 00068B  D847 0023                            LDR,R5   TEMP_BIT16,AUTO
          1 00068D  D470 4000                            OR,R5    16384,IMO
          1 00068F  DF47 0023                            STR,R5   TEMP_BIT16,AUTO

      528    15874    4                 KZ@LINCTX.FLAGS.FIRST = '1'B;

  15874   1 000691  8944 0034                            LBT,'0080'X       52,B4
  15874   1 000693       0080

      529    15875    4                 END;

  15875   1 000694  0F81 0004                            B        s:15877,PREL

      530    15876    3              ELSE KZ@LINCTX.FLAGS.FIRST = '0'B;

  15876   1 000696  8844 0034                            LBF,'0080'X       52,B4
  15876   1 000698       0080

      531    15877    3              KZ$EVENT.EVENT=%KZ#LINFCN_INP;

  15877   1 000699  6C04                                 LDV,R6   4
          1 00069A  EF47 0008                            STR,R6   KZ$EVENT,AUTO

      532    15878    3              CALL KZ@LINCTX.DEVMGR@ (KZ$EVENT,TEMP_BIT16);

  15878   1 00069C  BBC7 0023                            LAB,B3   TEMP_BIT16,AUTO
          1 00069E  BFC7 0046                            STB,B3   FPT_WRSYSLOG+24,AUTO
          1 0006A0  ABC7 0008                            LAB,B2   KZ$EVENT,AUTO
          1 0006A2  AFC7 0044                            STB,B2   FPT_WRSYSLOG+22,AUTO
          1 0006A4  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0006A6  9CC4 006E                            LDB,B1   110,B4
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:98   
          1 0006A8  CBF0 0200                            LAB,B4   512,IMO
          1 0006AA  E381                                 LNJ,B6   ,B1
          1 0006AB       0001                            DC       s:15879,PREL

      533    15879    4              IF KZ@LINCTX.INPBFR$ = ADDR(NIL) THEN DO;

  15879   1 0006AC  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0006AE  8DC6 0056                            CMN      86,B6
          1 0006B0  0981 0058                            BNE      s:15904,PREL

      534    15880                      /*  Input buffers should always be 256 bytes for
      535    15881                          3270 master mode.  For SLAVE mode, BLKBYTES should
      536    15882                          be used to calculate the buffer size, which will
      537    15883                          ultimately depend on the maximum output block size
      538    15884                          of the remote end.  */
      539    15885    4                 IF KZ@LINCTX.PRO.SLAVE

  15885   1 0006B2  89C6 004B                            CMZ      75,B6
          1 0006B4  0881 0009                            BAGE     s:15887,PREL

      540    15886    4                 THEN TSIZE = ( KZ@LINCTX.PRO.BLKBYTES + 1 ) / 2;

  15886   1 0006B6  E846 003C                            LDR,R6   60,B6
          1 0006B8  6E01                                 ADV,R6   1
          1 0006B9  6041                                 SOR,R6   1
          1 0006BA  EF47 0024                            STR,R6   TSIZE,AUTO
          1 0006BC  0F81 0005                            B        s:15888,PREL

      541    15887    4                 ELSE TSIZE = 128;

  15887   1 0006BE  E870 0080                            LDR,R6   128,IMO
          1 0006C0  EF47 0024                            STR,R6   TSIZE,AUTO

      542    15888    4                 CALL KVB$GETSYS ( TSIZE, T$ )

  15888   1 0006C2  DBC7 0025                            LAB,B5   T$,AUTO
          1 0006C4  DFC7 0046                            STB,B5   FPT_WRSYSLOG+24,AUTO
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:99   
          1 0006C6  CBC7 0024                            LAB,B4   TSIZE,AUTO
          1 0006C8  CFC7 0044                            STB,B4   FPT_WRSYSLOG+22,AUTO
          1 0006CA  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 0006CC  CBF0 0200                            LAB,B4   512,IMO
          1 0006CE  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          1 0006D1       0003                            DC       s:15891,PREL
          1 0006D2  0F81 001D                            B        s:15897,PREL

      543    15889    4                 WHENALTRETURN
      544    15890    5                 DO;

      545    15891    5                    CALL ERRLOG ( %E$NO_MEMORY );

  15891   1 0006D4  EBF0 00D0                            LAB,B6   208,IMO
          1 0006D6  EFC7 002C                            STB,B6   T$+7,AUTO
          1 0006D8  E3C0 003E                            LNJ,B6   s:0,PREL
          1 0006DA       0001                            DC       s:15892,PREL

      546    15892    5                    KZ@LINCTX.INPBFR$ = ADDR(NIL);

  15892   1 0006DB  EB80 0000 0000                       LAB,B6   0
          1 0006DE  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 0006E0  EFC5 0056                            STB,B6   86,B5

      547    15893    5                    KZ@LINCTX.INPBFRSIZ = 0;

  15893   1 0006E2  8745 0058                            CL       88,B5

      548    15894    5                    CALL KZV$DSC_LINE ( KZ@LINCTX );

  15894   1 0006E4  BBC7 0004                            LAB,B3   @KZ@LINCTX,AUTO
          1 0006E6  CBF0 0100                            LAB,B4   256,IMO
          1 0006E8  E380 0000 0000  xent                 LNJ,B6   KZV$DSC_LINE
          1 0006EB       0001                            DC       s:15895,PREL

      549    15895    5                    RETURN;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:100  
  15895   1 0006EC  ECC7 0028                            LDB,B6   T$+3,AUTO
          1 0006EE  C3C6 0001                            LNJ,B4   1,B6

      550    15896    5                    END;
      551    15897    4                 KZ@LINCTX.INPBFR$ = T$;

  15897   1 0006F0  ECC7 0025                            LDB,B6   T$,AUTO
          1 0006F2  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 0006F4  EFC5 0056                            STB,B6   86,B5

      552    15898    4                 KZ@LINCTX.INPBFRSIZ = TSIZE;

  15898   1 0006F6  E847 0024                            LDR,R6   TSIZE,AUTO
          1 0006F8  EF45 0058                            STR,R6   88,B5

      553    15899    4                 IF KZ@LINCTX.PRO.PROTYP = %KLPT_POLL# THEN

  15899   1 0006FA  D845 003A                            LDR,R5   58,B5
          1 0006FC  5D04                                 CMV,R5   4
          1 0006FD  0981 000B                            BNE      s:15904,PREL

      554    15900    4                    KZ$3270STT.KHSTT.INPBFRBYTUTL =

  15900   1 0006FF  CC80 0000 0006  xsym                 LDB,B4   KZ_3270M_HDR+6
          1 000702  F856                                 LDR,R7   R6
          1 000703  6C00                                 LDV,R6   0
          1 000704  7081                                 DOL,R7   1
          1 000705  8444 001C                            AID      28,B4
          1 000707  8D44 001C                            SDI      28,B4

      555    15901    4                      KZ$3270STT.KHSTT.INPBFRBYTUTL + (TSIZE * 2);
      556    15902    4                 END;

      557    15903    3              END;

      558    15904    2           RETURN;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:101  
  15904   1 000709  ECC7 0028                            LDB,B6   T$+3,AUTO
          1 00070B  C3C6 0001                            LNJ,B4   1,B6

      559    15905    2   END RPTINP;
      560    15906        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:102  
      561    15907        /* SCREECH */
      562    15908
      563    15909    1   SCREECH: PROC;

  15909   1 00070D  EFC7 0028            SCREECH         STB,B6   T$+3,AUTO

      564    15910    2           CALL M$XXX;

  15910   1 00070F  B870 0082                            LDR,R3   130,IMO
          1 000711  0001                                 MCL
          1 000712       0000                            DC       s:15910+3,PREL

      565    15911    2   END SCREECH;

  15911   1 000713  ECC7 0028                            LDB,B6   T$+3,AUTO
          1 000715  C3C6 0001                            LNJ,B4   1,B6

      566    15912        %EJECT;
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:103  
      567    15913    1   ERRLOG: PROC (ERROR);

  15913   1 000717  EFC7 002A            ERRLOG          STB,B6   T$+5,AUTO

      568    15914    2   DCL ERROR UBIN;
      569    15915        %FPT_WRSYSLOG (STCLASS="");
      570    16010        %FPT_WRSYSLOG (FPTN=FPT@WRSYSLOG,STCLASS=CONSTANT,FCG='KZ',MID='T');
      571    16105
      572    16106    2           FPT_WRSYSLOG = FPT@WRSYSLOG;

  16106   1 000719  AB80 0000 0000  00                   LAB,B2   KZ_EVENT
          1 00071C  2C32                                 LDV,R2   50
          1 00071D  6C2A                                 LDV,R6   42
          1 00071E  BB87                                 LAB,B3   ,AUTO
          1 00071F  3C5C                                 LDV,R3   92
          1 000720  0008                                 MMM

      573    16107    2           FPT_WRSYSLOG.V.TERMID = KZ@LINCTX.LINID;

  16107   1 000721  ACC7 0004                            LDB,B2   @KZ@LINCTX,AUTO
          1 000723  2C08                                 LDV,R2   8
          1 000724  6C10                                 LDV,R6   16
          1 000725  BB87                                 LAB,B3   ,AUTO
          1 000726  3C6C                                 LDV,R3   108
          1 000727  0008                                 MMM

      574    16108    2           FPT_WRSYSLOG.V.ERRCODE.ERR# = ERROR;

  16108   1 000728  ECC7 002C                            LDB,B6   @ERROR,AUTO
          1 00072A  E806                                 LDR,R6   ,B6
          1 00072B  6003                                 SOL,R6   3
          1 00072C  EAC7 0035                            SRM,R6,'FFF8'X    FPT_WRSYSLOG+7,AUTO
          1 00072E       FFF8

      575    16109    3           DO CASE (ERROR);

  16109   1 00072F  B806                                 LDR,R3   ,B6
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:104  
          1 000730  BA70 FF34                            ADD,R3   -204,IMO
          1 000732  3D05                                 CMV,R3   5
          1 000733  0281 005A                            BGE      s:16152,PREL
          1 000735  A830 0000 073B  01                   LDR,R2   s:16109+12,R3
          1 000738  83A0 0000 0740  01                   JMP      s:16120,R2
          1 00073B       0020                            DC       s:16136,PREL
          1 00073C       0000                            DC       s:16120,PREL
          1 00073D       004E                            DC       s:16152,PREL
          1 00073E       004E                            DC       s:16152,PREL
          1 00073F       003E                            DC       s:16145,PREL

      576    16110
      577    16111    3            CASE (%E$3270IO_OK);

      578    16112        /*E* ERROR:        KZT-E$3270IO_OK-1
      579    16113             MESSAGE:      Corrected 3270 I/O error.
      580    16114             DESCRIPTION:  A NAK or ENQ occurred on a BSC 3270 LINE and a retry
      581    16115                           of the operation causing the error was successful.
      582    16116                           V0 = Channel number.
      583    16117                           V1 = Number of retries before good completion.
      584    16118                           DATA = Vector of KZ$LINCTX.HIST.
      585    16119        */
      586    16120    3              FPT_WRSYSLOG.V.ERRCODE.SEV=%G_WRSYSLOG_SEV_GOOD_HARD#;

  16120   1 000740  6C01                                 LDV,R6   1
          1 000741  EAC7 0035                            SRM,R6,'0007'X    FPT_WRSYSLOG+7,AUTO
          1 000743       0007

      587    16121    3              FPT_WRSYSLOG.V.VALUES(0)=KZ@LINCTX.CHAN;

  16121   1 000744  D842 0033                            LDR,R5   51,B2
          1 000746  DF47 003E                            STR,R5   FPT_WRSYSLOG+16,AUTO

      588    16122    3              FPT_WRSYSLOG.V.VALUES(1)=KZ@LINCTX.RTRCNT;

  16122   1 000748  C842 0039                            LDR,R4   57,B2
          1 00074A  CF47 003F                            STR,R4   FPT_WRSYSLOG+17,AUTO
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:105  

      589    16123    3              FPT_WRSYSLOG.V.VALUES(2)=0;

  16123   1 00074C  8747 0040                            CL       FPT_WRSYSLOG+18,AUTO

      590    16124    3              FPT_WRSYSLOG.V.VALUES(3)=0;

  16124   1 00074E  8747 0041                            CL       FPT_WRSYSLOG+19,AUTO

      591    16125    3              FPT_WRSYSLOG.BUF_=VECTOR(KZ@LINCTX.HIST);

  16125   1 000750  DBC2 0013                            LAB,B5   19,B2
          1 000752  DFC7 0045                            STB,B5   FPT_WRSYSLOG+23,AUTO
          1 000754  3C21                                 LDV,R3   33
          1 000755  BF47 0044                            STR,R3   FPT_WRSYSLOG+22,AUTO
          1 000757  ABC7 0044                            LAB,B2   FPT_WRSYSLOG+22,AUTO
          1 000759  2C00                                 LDV,R2   0
          1 00075A  6C06                                 LDV,R6   6
          1 00075B  BB87                                 LAB,B3   ,AUTO
          1 00075C  3C62                                 LDV,R3   98
          1 00075D  0008                                 MMM
          1 00075E  0F81 002F                            B        s:16152,PREL

      592    16126
      593    16127    3            CASE (%E$3270POLTIMOUT);

      594    16128        /*E* ERROR:        KZT-E$3270POLTIMOUT-4
      595    16129             MESSAGE:      General Poll timed out.
      596    16130             DESCRIPTION:  A General Poll to a controller timed out.
      597    16131                           The controller will be removed from active
      598    16132                           controller list.
      599    16133                           V0 = Channel number.
      600    16134                           DATA = Vector of KZ$LINTCX.HIST.
      601    16135        */
      602    16136    3              FPT_WRSYSLOG.V.ERRCODE.SEV=%G_WRSYSLOG_SEV_NONFATAL_PROT#;

  16136   1 000760  6C04                                 LDV,R6   4
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:106  
          1 000761  EAC7 0035                            SRM,R6,'0007'X    FPT_WRSYSLOG+7,AUTO
          1 000763       0007

      603    16137    3              FPT_WRSYSLOG.V.VALUES(0)=KZ@LINCTX.CHAN;

  16137   1 000764  D842 0033                            LDR,R5   51,B2
          1 000766  DF47 003E                            STR,R5   FPT_WRSYSLOG+16,AUTO

      604    16138    3              FPT_WRSYSLOG.V.VALUES(1)=0;

  16138   1 000768  8747 003F                            CL       FPT_WRSYSLOG+17,AUTO

      605    16139    3              FPT_WRSYSLOG.V.VALUES(2)=0;

  16139   1 00076A  8747 0040                            CL       FPT_WRSYSLOG+18,AUTO

      606    16140    3              FPT_WRSYSLOG.V.VALUES(3)=0;

  16140   1 00076C  8747 0041                            CL       FPT_WRSYSLOG+19,AUTO

      607    16141    3              FPT_WRSYSLOG.BUF_=VECTOR(KZ@LINCTX.HIST);

  16141   1 00076E  DBC2 0013                            LAB,B5   19,B2
          1 000770  DFC7 0045                            STB,B5   FPT_WRSYSLOG+23,AUTO
          1 000772  4C21                                 LDV,R4   33
          1 000773  CF47 0044                            STR,R4   FPT_WRSYSLOG+22,AUTO
          1 000775  ABC7 0044                            LAB,B2   FPT_WRSYSLOG+22,AUTO
          1 000777  2C00                                 LDV,R2   0
          1 000778  6C06                                 LDV,R6   6
          1 000779  BB87                                 LAB,B3   ,AUTO
          1 00077A  3C62                                 LDV,R3   98
          1 00077B  0008                                 MMM
          1 00077C  0F81 0011                            B        s:16152,PREL

      608    16142
      609    16143    3            CASE (%E$NO_MEMORY);

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:107  
      610    16144        /*  Uses same error message as KZT$3270.  See ERRLOG in that routine.  */
      611    16145    3              FPT_WRSYSLOG.V.ERRCODE.SEV=%G_WRSYSLOG_SEV_LINE_ABORT#;

  16145   1 00077E  6C06                                 LDV,R6   6
          1 00077F  EAC7 0035                            SRM,R6,'0007'X    FPT_WRSYSLOG+7,AUTO
          1 000781       0007

      612    16146    3              FPT_WRSYSLOG.V.VALUES(0)=KZ@LINCTX.CHAN;

  16146   1 000782  D842 0033                            LDR,R5   51,B2
          1 000784  DF47 003E                            STR,R5   FPT_WRSYSLOG+16,AUTO

      613    16147    3              FPT_WRSYSLOG.V.VALUES(1)=0;

  16147   1 000786  8747 003F                            CL       FPT_WRSYSLOG+17,AUTO

      614    16148    3              FPT_WRSYSLOG.V.VALUES(2)=0;

  16148   1 000788  8747 0040                            CL       FPT_WRSYSLOG+18,AUTO

      615    16149    3              FPT_WRSYSLOG.V.VALUES(3)=TSIZE;

  16149   1 00078A  C847 0024                            LDR,R4   TSIZE,AUTO
          1 00078C  CF47 0041                            STR,R4   FPT_WRSYSLOG+19,AUTO

      616    16150
      617    16151    3            END;

      618    16152    2           CALL KHA$ERRLOG(FPT_WRSYSLOG);

  16152   1 00078E  DBC7 002E                            LAB,B5   FPT_WRSYSLOG,AUTO
          1 000790  DFC7 0044                            STB,B5   FPT_WRSYSLOG+22,AUTO
          1 000792  BBC7 0044                            LAB,B3   FPT_WRSYSLOG+22,AUTO
          1 000794  CBF0 0100                            LAB,B4   256,IMO
          1 000796  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          1 000799       0001                            DC       s:16153,PREL

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:108  
      619    16153    2           RETURN;

  16153   1 00079A  ECC7 002A                            LDB,B6   T$+5,AUTO
          1 00079C  C3C6 0001                            LNJ,B4   1,B6

      620    16154    2   END ERRLOG;
      621    16155    1   END KZT$3270IO;

  16155   1 00079E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      622    16156        %EOD;

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:109  
--  Include file information  --

   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KZ$3270STT.:E05TOU  is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KZ_3270_C.:E05TOU  is referenced.
   KZ_MLCP_C.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ_3270M_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KZ_BSCFPT.:E05TOU  is referenced.
   KZ$OTPBFR.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KZT$3270IO.
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:110  

 **** Variables and constants ****

  ****  Section 000 RoData KZT$3270IO

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    19-0-0/w STRC(336)   r     1 FPT@WRSYSLOG               E-0-0/w STRC(176)   r     1 KH_CLK_SET
     0-0-0/w STRC(224)   r     1 KZ_EVENT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    2C-0-0/w PTR         r     1 @ERROR                     6-0-0/w PTR         r     1 @KZ@BSCFPT
     4-0-0/w PTR         r     1 @KZ@LINCTX                *0-0-0/w UBIN(16)    r     1 ERROR
    2E-0-0/w STRC(336)   r     1 FPT_WRSYSLOG              23-0-0/w UBIN(16)    r     1 I
    16-0-0/w STRC(176)   r     1 KH$CLK                     8-0-0/w STRC(224)   r     1 KZ$EVENT
    *0-0-0/w STRC(80)    r     1 KZ@BSCFPT                 *0-0-0/w STRC(2192)  r     1 KZ@LINCTX
    25-0-0/w PTR         r     1 T$                        23-0-0/w BIT (16)    r     1 TEMP_BIT16
    21-0-0/w UBIN(32)    r     1 TIME                      21-0-0/w STRC(32)    r     1 TINY_TIME_PARTICLES
    24-0-0/w UBIN(16)    r     1 TSIZE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 KZT_GO@                    0-0-0/w EPTR        r     1 KZT_ORDERS@
     0-0-0/w STRC(272)   r     1 KZ_3270M_HDR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:111  
     0-0-0/c UBIN(8)     r     1 CTR(0:0)                   0-0-0/w STRC(2656)  r     1 KZ$3270STT
     0-0-0/w STRC(128)   r     1 KZ$OTPBFR


   Procedure KZT$3270IO requires 1953 words for executable code.
   Procedure KZT$3270IO requires 72 words of local(AUTO) storage.
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:112  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:113  
          MINI XREF LISTING

CANT_GET_OTP
     15513**LABEL   15495--CALLALT
CTR
     15392**DCL     15566>>ASSIGN  15859>>IF
END_SPCPOLALL
     15483**LABEL   15477--CALLALT
ERRLOG
     15913**PROC    15664--CALL    15732--CALL    15752--CALL    15891--CALL
ERROR IN PROCEDURE ERRLOG
     15914**DCL     15913--PROC    16108>>ASSIGN  16109>>DOCASE
FPT@WRSYSLOG IN PROCEDURE ERRLOG
     16023**DCL     16106>>ASSIGN
FPT@WRSYSLOG.V IN PROCEDURE ERRLOG
     16027**DCL     16025--DCLINIT
FPT@WRSYSLOG.V.TERMID.TERM IN PROCEDURE ERRLOG
     16092**DCL     16101--REDEF
FPT_WRSYSLOG IN PROCEDURE ERRLOG
     15928**DCL     16106<<ASSIGN  16152<>CALL
FPT_WRSYSLOG.BUF_ IN PROCEDURE ERRLOG
     15930**DCL     16125<<ASSIGN  16141<<ASSIGN
FPT_WRSYSLOG.V.ERRCODE.ERR# IN PROCEDURE ERRLOG
     15976**DCL     16108<<ASSIGN
FPT_WRSYSLOG.V.ERRCODE.SEV IN PROCEDURE ERRLOG
     15977**DCL     16120<<ASSIGN  16136<<ASSIGN  16145<<ASSIGN
FPT_WRSYSLOG.V.TERMID IN PROCEDURE ERRLOG
     15995**DCL     16107<<ASSIGN
FPT_WRSYSLOG.V.TERMID.TERM IN PROCEDURE ERRLOG
     15997**DCL     16006--REDEF
FPT_WRSYSLOG.V.VALUES IN PROCEDURE ERRLOG
     16008**DCL     16121<<ASSIGN  16122<<ASSIGN  16123<<ASSIGN  16124<<ASSIGN  16137<<ASSIGN  16138<<ASSIGN
     16139<<ASSIGN  16140<<ASSIGN  16146<<ASSIGN  16147<<ASSIGN  16148<<ASSIGN  16149<<ASSIGN
GENPOL
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:114  
     15544**LABEL   15597--GOTO
GENPOLNXT
     15564**LABEL   15569--GOTO
I
     15398**DCL     15796<>CALL    15797>>DOCASE
KH$CLK
     15256**DCL     15599<<ASSIGN  15616<>CALL    15800<<ASSIGN  15806<>CALL
KH$CLK.CTBCTX$
     15262**DCL     15617>>ASSIGN  15807>>ASSIGN
KH$CLK.PRD
     15377**DCL     15611<<ASSIGN  15613<<ASSIGN  15802<<ASSIGN  15805>>IF      15805<<ASSIGN
KH$CLK.PRDUNT
     15359**DCL     15600<<ASSIGN  15614<<ASSIGN  15801<<ASSIGN
KH$CLK.SBR$
     15373**DCL     15602<<ASSIGN  15804<<ASSIGN
KH$CLK.UID
     15272**DCL     15273--REDEF   15274--REDEF
KH$CLK.UID$
     15273**DCL     15601<<ASSIGN  15803<<ASSIGN
KHA$ERRLOG
     15408**DCL-ENT 16152--CALL
KHC$CLOCK
     15405**DCL-ENT 15616--CALL    15806--CALL
KHC$TIME2
     15406**DCL-ENT 15430--CALL    15444--CALL    15546--CALL    15595--CALL
KH_CLK_SET
     15107**DCL     15599>>ASSIGN  15800>>ASSIGN
KH_CLK_SET.UID
     15123**DCL     15124--REDEF   15125--REDEF
KVB$GETSYS
     15407**DCL-ENT 15888--CALL
KZ$3270STT.GENPOL
     14910**DCL     15545<<ASSIGN  15545>>ASSIGN
KZ$3270STT.KHSTT.INPBFRBYTUTL
     14860**DCL     15900<<ASSIGN  15900>>ASSIGN
KZ$3270STT.REQSTATS.DSPMSK
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:115  
     14788**DCL     14794--REDEF
KZ$3270STT.REQSTATS.SLCMSK
     14829**DCL     14836--REDEF
KZ$3270STT.SEL
     14918**DCL     15510<<ASSIGN  15510>>ASSIGN
KZ$3270STT.SNDOTP
     14914**DCL     15590<<ASSIGN  15590>>ASSIGN
KZ$3270STT.WAT
     14923**DCL     15598<<ASSIGN  15598>>ASSIGN
KZ$EVENT
     15025**DCL     15410<<ASSIGN  15426<>CALL    15462<>CALL    15477<>CALL    15495<>CALL    15525<>CALL
     15527<>CALL    15538<>CALL    15588<>CALL    15670<>CALL    15681<>CALL    15796<>CALL    15840<>CALL
     15866<>CALL    15878<>CALL
KZ$EVENT.EVENT
     15026**DCL     15425<<ASSIGN  15461<<ASSIGN  15476<<ASSIGN  15494<<ASSIGN  15524<<ASSIGN  15526<<ASSIGN
     15537<<ASSIGN  15587<<ASSIGN  15669<<ASSIGN  15680<<ASSIGN  15795<<ASSIGN  15839<<ASSIGN  15865<<ASSIGN
     15877<<ASSIGN
KZ$EVENT.LINCTX$
     15032**DCL     15411<<ASSIGN
KZ$OTPBFR
     14400**DCL     15688--ASSIGN
KZ$OTPBFR.DATA_SIZ
     14441**DCL     15690>>ASSIGN
KZ$OTPBFR.FLAGS.TRANS#
     14427**DCL     15696>>IF
KZ@BSCFPT
     14375**DCL         9--PROC
KZ@BSCFPT.ACT
     14376**DCL     15412>>DOCASE  15667>>IF
KZ@BSCFPT.EVT
     14377**DCL     15453<<ASSIGN  15468<<ASSIGN  15470<<ASSIGN  15484<<ASSIGN  15491>>IF      15491>>IF
     15499>>IF      15505<<ASSIGN  15517<<ASSIGN  15542>>IF      15542>>IF      15549<<ASSIGN  15556<<ASSIGN
     15581<<ASSIGN  15591<<ASSIGN  15627<<ASSIGN  15630<<ASSIGN  15633<<ASSIGN  15636>>IF      15637<<ASSIGN
     15640<<ASSIGN  15642<<ASSIGN  15645<<ASSIGN  15658>>IF      15658>>IF      15662>>IF      15672>>IF
     15674<<ASSIGN  15678>>IF      15684<<ASSIGN  15705<<ASSIGN  15720<<ASSIGN  15729>>IF      15740<<ASSIGN
     15749>>IF      15760<<ASSIGN  15771>>IF      15777<<ASSIGN  15786>>IF      15811<<ASSIGN  15816<<ASSIGN
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:116  
     15822<<ASSIGN  15833<<ASSIGN  15842<<ASSIGN  15855>>IF      15864>>IF      15872>>IF
KZ@BSCFPT.FNC
     14381**DCL     15415<<ASSIGN  15454<<ASSIGN  15471<<ASSIGN  15485<<ASSIGN  15506<<ASSIGN  15518<<ASSIGN
     15550<<ASSIGN  15557<<ASSIGN  15582<<ASSIGN  15592<<ASSIGN  15651<<ASSIGN  15675<<ASSIGN  15685<<ASSIGN
     15706<<ASSIGN  15721<<ASSIGN  15741<<ASSIGN  15761<<ASSIGN  15778<<ASSIGN  15812<<ASSIGN  15817<<ASSIGN
     15823<<ASSIGN  15834<<ASSIGN  15843<<ASSIGN
KZ@BSCFPT.OLDSTT
     14379**DCL     15535>>IF      15658>>IF      15658>>IF
KZ@BSCFPT.SIZ
     14380**DCL     15794>>ASSIGN  15852>>IF      15853>>ASSIGN
KZ@LINCTX
     13954**DCL         9--PROC    15411--ASSIGN  15439<>CALL    15514<>CALL    15532<>CALL    15574<>CALL
     15601--ASSIGN  15697<>CALL    15699<>CALL    15725<>CALL    15745<>CALL    15765<>CALL    15776<>CALL
     15782<>CALL    15787<>CALL    15789<>CALL    15803--ASSIGN  15820<>CALL    15894<>CALL
KZ@LINCTX.ACTCTR
     14313**DCL     15421>>IF      15450>>IF      15579>>IF      15829>>IF
KZ@LINCTX.CHAN
     14045**DCL     16121>>ASSIGN  16137>>ASSIGN  16146>>ASSIGN
KZ@LINCTX.CNTTSTRQS
     14347**DCL     15855>>IF      15860<<ASSIGN  15861<<ASSIGN
KZ@LINCTX.CTB.PRM$
     14043**DCL     15617<<ASSIGN  15807<<ASSIGN
KZ@LINCTX.CURCTR$
     14250**DCL     15540<<ASSIGN  15648<<ASSIGN  15858<<ASSIGN
KZ@LINCTX.CURDEV$
     14253**DCL     15541<<ASSIGN  15649<<ASSIGN  15857<<ASSIGN
KZ@LINCTX.DEVMGR@
     14317**DCL     15426>>CALL    15462>>CALL    15477>>CALL    15495>>CALL    15525>>CALL    15527>>CALL
     15538>>CALL    15588>>CALL    15670>>CALL    15681>>CALL    15796>>CALL    15840>>CALL    15866>>CALL
     15878>>CALL
KZ@LINCTX.FLAGS.CTRINITDONE
     14099**DCL     15422<<ASSIGN  15428>>IF      15434<<ASSIGN  15443>>IF      15448<<ASSIGN  15467>>IF
     15580<<ASSIGN  15639>>IF      15793<<ASSIGN
KZ@LINCTX.FLAGS.FIRST
     14087**DCL     15870>>IF      15874<<ASSIGN  15876<<ASSIGN
KZ@LINCTX.HIST
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:117  
     14000**DCL     16125--ASSIGN  16141--ASSIGN
KZ@LINCTX.INPBFR$
     14260**DCL     15859>>IF      15879>>IF      15892<<ASSIGN  15897<<ASSIGN
KZ@LINCTX.INPBFRSIZ
     14262**DCL     15893<<ASSIGN  15898<<ASSIGN
KZ@LINCTX.INPDATSIZ
     14264**DCL     15794<<ASSIGN  15853<<ASSIGN  15854<<ASSIGN  15859>>IF
KZ@LINCTX.LINID
     13975**DCL     16107>>ASSIGN
KZ@LINCTX.LINID.TERM
     13977**DCL     13986--REDEF
KZ@LINCTX.OPR
     14315**DCL     15420<<ASSIGN  15452<<ASSIGN  15460<<ASSIGN  15479<<ASSIGN  15483<<ASSIGN  15490<<ASSIGN
     15555<<ASSIGN  15561<<ASSIGN  15578<<ASSIGN  15624>>DOCASE
KZ@LINCTX.OTPBFR$
     14266**DCL     15436<<ASSIGN  15511<<ASSIGN  15529<<ASSIGN  15571<<ASSIGN  15688<<ASSIGN
KZ@LINCTX.OTPBFRSIZ
     14268**DCL     15438<<ASSIGN  15513<<ASSIGN  15531<<ASSIGN  15573<<ASSIGN
KZ@LINCTX.OTPCNT
     14242**DCL     14245--REDEF   15585>>IF
KZ@LINCTX.OTPDATSIZ
     14270**DCL     15437<<ASSIGN  15512<<ASSIGN  15530<<ASSIGN  15572<<ASSIGN  15690<<ASSIGN
KZ@LINCTX.OTPHD$
     14255**DCL     15683>>IF      15688>>ASSIGN  15690>>ASSIGN  15696>>IF
KZ@LINCTX.POLADR
     14282**DCL     15436--ASSIGN  15511--ASSIGN  15529--ASSIGN  15571--ASSIGN
KZ@LINCTX.POLADR.CTR
     14286**DCL     15566<<ASSIGN  15568>>IF
KZ@LINCTX.POLADR.DEV
     14287**DCL     15570<<ASSIGN
KZ@LINCTX.POLLST$
     14293**DCL     15566>>ASSIGN
KZ@LINCTX.POLSIZ
     14288**DCL     14290--REDEF   15428>>IF      15565>>IF
KZ@LINCTX.POLX
     14308**DCL     15428>>IF      15544<<ASSIGN  15564<<ASSIGN  15564>>ASSIGN  15565>>IF      15566>>ASSIGN
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:118  
     15577<<ASSIGN
KZ@LINCTX.PRMCTBTYP
     13990**DCL     15618<<ASSIGN  15808<<ASSIGN
KZ@LINCTX.PRO.BLKBYTES
     14145**DCL     15886>>ASSIGN
KZ@LINCTX.PRO.INTERVAL
     14156**DCL     15596>>IF      15603>>ASSIGN  15799>>IF      15802>>ASSIGN
KZ@LINCTX.PRO.PROTYP
     14138**DCL     15899>>IF
KZ@LINCTX.PRO.RETRYS
     14149**DCL     15502>>IF      15502>>IF      15703>>IF      15703>>IF      15718>>IF      15718>>IF
     15738>>IF      15738>>IF      15758>>IF      15758>>IF      15774>>IF      15774>>IF      15831>>IF
     15831>>IF
KZ@LINCTX.PRO.SLAVE
     14193**DCL     15838>>IF      15885>>IF
KZ@LINCTX.RTRCNT
     14130**DCL     15501<<ASSIGN  15501>>ASSIGN  15502>>IF      15663>>IF      15665<<ASSIGN  15702<<ASSIGN
     15702>>ASSIGN  15703>>IF      15717<<ASSIGN  15717>>ASSIGN  15718>>IF      15731>>IF      15733<<ASSIGN
     15737<<ASSIGN  15737>>ASSIGN  15738>>IF      15751>>IF      15753<<ASSIGN  15757<<ASSIGN  15757>>ASSIGN
     15758>>IF      15772<<ASSIGN  15772>>ASSIGN  15774>>IF      15830<<ASSIGN  15830>>ASSIGN  15831>>IF
     16122>>ASSIGN
KZ@LINCTX.TIMER.POL
     14019**DCL     15431<<ASSIGN  15445<<ASSIGN  15553>>IF      15554<<ASSIGN
KZ@LINCTX.TIMR.GENPOL
     14329**DCL     15432<<ASSIGN  15446<<ASSIGN  15560<<ASSIGN  15596>>IF      15603>>ASSIGN
KZ@LINCTX.TIMR.SPCPOL
     14331**DCL     15433<<ASSIGN  15447<<ASSIGN  15547>>IF      15548<<ASSIGN
KZT_GO@
     15402**DCL     15602>>ASSIGN  15804>>ASSIGN
KZT_ORDERS@
     15403**DCL     15439>>CALL    15514>>CALL    15532>>CALL    15574>>CALL    15697>>CALL    15699>>CALL
     15725>>CALL    15745>>CALL    15765>>CALL    15776>>CALL    15782>>CALL    15787>>CALL    15789>>CALL
     15820>>CALL
KZV$DSC_LINE
     15404**DCL-ENT 15894--CALL
KZ_3270M_HDR.STTBFR$
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:119  
     14489**DCL     14517--IMP-PTR 15510>>ASSIGN  15510>>ASSIGN  15545>>ASSIGN  15545>>ASSIGN  15590>>ASSIGN
     15590>>ASSIGN  15598>>ASSIGN  15598>>ASSIGN  15900>>ASSIGN  15900>>ASSIGN
KZ_EVENT
     14943**DCL     15410>>ASSIGN
M$XXX
      4249**DCL-ENT 15910--CALL
NO_OTP
     15595**LABEL   15586--GOTO    15588--CALLALT
OUCH
     15848**LABEL   15616--CALLALT 15806--CALLALT
RPTINP
     15850**PROC    15730--CALL    15750--CALL
RQSCTR
     15425**LABEL   15451--GOTO
RQSCTR_DONE
     15443**LABEL   15426--CALLALT
RQSCTR_EXIT
     15454**LABEL   15440--GOTO
SCREECH
     15909**PROC    15848--CALL
SELPOL_EXIT
     15518**LABEL   15515--GOTO
SND
     15696**LABEL   15661--GOTO    15710--GOTO
SPCPOL
     15529**LABEL   15464--GOTO    15480--GOTO
SPCPOLCTR_END
     15467**LABEL   15462--CALLALT
T$
     15400**DCL     15888<>CALL    15897>>ASSIGN
TEMP_BIT16
     15397**DCL     15398--REDEF   15869<<ASSIGN  15871<<ASSIGN  15873<<ASSIGN  15873>>ASSIGN  15878<>CALL
TIME
     15393**DCL     15394--REDEF   15430<>CALL    15431>>ASSIGN  15432>>ASSIGN  15433>>ASSIGN  15444<>CALL
     15445>>ASSIGN  15446>>ASSIGN  15447>>ASSIGN  15546<>CALL    15547>>IF      15548>>ASSIGN  15553>>IF
     15554>>ASSIGN  15560>>ASSIGN  15595<>CALL    15596>>IF      15603<<ASSIGN  15603>>ASSIGN
PL6.E3A0      #001=KZT$3270IO File=KZT$3270IO.:E05TSI                            WED 07/30/97 03:02 Page:120  
TINY_TIME_PARTICLES.WD2
     15396**DCL     15605<<ASSIGN  15605>>ASSIGN  15606>>IF      15607<<ASSIGN  15608>>IF      15609<<ASSIGN
     15610>>IF      15611>>ASSIGN  15613>>ASSIGN
TSIZE
     15399**DCL     15886<<ASSIGN  15887<<ASSIGN  15888<>CALL    15898>>ASSIGN  15900>>ASSIGN  16149>>ASSIGN

PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:121  
      623        1        /*T***********************************************************/
      624        2        /*T*                                                         */
      625        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      626        4        /*T*                                                         */
      627        5        /*T***********************************************************/
      628        6        %EJECT;
PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:122  
      629        7        /*F*     NAME:     KZT$3270STT */
      630        8
      631        9        KZT$3270STT: PROC (KZ_VDHSTT_V,KZ_3270STT_V);
      632       10
      633       11        %INCLUDE KZ$3270STT;
      634       75        %INCLUDE KZ$BSCSTT;
      635      181        %INCLUDE KZ_3270M_C;
      636     1038        %INCLUDE KH$STT;
      637     1068        %INCLUDE KV$GLB;
      638     1487        %INCLUDE KV_GLBCNS_E;
      639     1828        %INCLUDE KL_MACRO_C;
      640     5180        %INCLUDE KL_AFCN_C;
      641     5281        %INCLUDE K_ID_E;
      642     5331        %INCLUDE LCP_6;
      643     9610
      644     9611        %K#ENTID_E;
      645     9630    1   DCL KZ_VDHSTT_V VECTOR;
      646     9631    1   DCL KZ_3270STT_V VECTOR;
      647     9632        %KV$STT;
      648    10026        %KZ_3270M_HDR (STCLASS=SYMREF);
      649    10050        %KZ$3270STT;
      650    10482    1   DCL KZ_VDHSTT$ PTR SYMREF;
      651    10483
      652    10484    1           KZ_VDHSTT_V=VECTOR (KZ_VDHSTT$->KV$STT);
      653    10485    1           KZ_3270STT_V=VECTOR (KZ_3270M_HDR.STTBFR$->KZ$3270STT);
      654    10486
      655    10487    1   END KZT$3270STT;

PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:123  
--  Include file information  --

   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KZ_3270M_C.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KZ$3270STT.:E05TOU  is referenced.
      No diagnostics issued in procedure KZT$3270STT.

   Procedure KZT$3270STT requires 42 words for executable code.
   Procedure KZT$3270STT requires 11 words of local(AUTO) storage.

    No errors detected in file KZT$3270IO.:E05TSI    .

PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:124  

 Object Unit name= KZT$3270STT                                File name= KZT$3270IO.:E05TOU
 UTS= JUL 30 '97 03:04:07.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none    42     2A  KZT$3270STT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  KZT$3270STT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X6A_AUTO_2
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KZ_3270M_HDR                          KZ_VDHSTT$                       r    G$ROS$
PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:125  


      623        1        /*T***********************************************************/
      624        2        /*T*                                                         */
      625        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      626        4        /*T*                                                         */
      627        5        /*T***********************************************************/
      628        6        %EJECT;
PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:126  
      629        7        /*F*     NAME:     KZT$3270STT */
      630        8
      631        9        KZT$3270STT: PROC (KZ_VDHSTT_V,KZ_3270STT_V);

      9   0 000000  D380 0000 0000  xent KZT$3270STT     LNJ,B5   X6A_AUTO_2
          0 000003       000B 0002                       DC       11,2

      632       10
      633       11        %INCLUDE KZ$3270STT;
      634       75        %INCLUDE KZ$BSCSTT;
      635      181        %INCLUDE KZ_3270M_C;
      636     1038        %INCLUDE KH$STT;
      637     1068        %INCLUDE KV$GLB;
      638     1487        %INCLUDE KV_GLBCNS_E;
      639     1828        %INCLUDE KL_MACRO_C;
      640     5180        %INCLUDE KL_AFCN_C;
      641     5281        %INCLUDE K_ID_E;
      642     5331        %INCLUDE LCP_6;
      643     9610
      644     9611        %K#ENTID_E;
      645     9630    1   DCL KZ_VDHSTT_V VECTOR;
      646     9631    1   DCL KZ_3270STT_V VECTOR;
      647     9632        %KV$STT;
      648    10026        %KZ_3270M_HDR (STCLASS=SYMREF);
      649    10050        %KZ$3270STT;
      650    10482    1   DCL KZ_VDHSTT$ PTR SYMREF;
      651    10483
      652    10484    1           KZ_VDHSTT_V=VECTOR (KZ_VDHSTT$->KV$STT);

  10484   0 000005  EC80 0000 0000  xsym                 LDB,B6   KZ_VDHSTT$
          0 000008  EFC7 0009                            STB,B6   @KZ_3270STT_V+3,AUTO
          0 00000A  E870 045F                            LDR,R6   1119,IMO
          0 00000C  EF47 0008                            STR,R6   @KZ_3270STT_V+2,AUTO
          0 00000E  ABC7 0008                            LAB,B2   @KZ_3270STT_V+2,AUTO
          0 000010  2C00                                 LDV,R2   0
          0 000011  6C06                                 LDV,R6   6
          0 000012  BCC7 0004                            LDB,B3   @KZ_VDHSTT_V,AUTO
PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:127  
          0 000014  3C00                                 LDV,R3   0
          0 000015  0008                                 MMM

      653    10485    1           KZ_3270STT_V=VECTOR (KZ_3270M_HDR.STTBFR$->KZ$3270STT);

  10485   0 000016  EC80 0000 0006  xsym                 LDB,B6   KZ_3270M_HDR+6
          0 000019  EFC7 0009                            STB,B6   @KZ_3270STT_V+3,AUTO
          0 00001B  E870 014B                            LDR,R6   331,IMO
          0 00001D  EF47 0008                            STR,R6   @KZ_3270STT_V+2,AUTO
          0 00001F  ABC7 0008                            LAB,B2   @KZ_3270STT_V+2,AUTO
          0 000021  2C00                                 LDV,R2   0
          0 000022  6C06                                 LDV,R6   6
          0 000023  BCC7 0006                            LDB,B3   @KZ_3270STT_V,AUTO
          0 000025  3C00                                 LDV,R3   0
          0 000026  0008                                 MMM

      654    10486
      655    10487    1   END KZT$3270STT;

  10487   0 000027  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:128  
--  Include file information  --

   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KZ_3270M_C.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KZ$3270STT.:E05TOU  is referenced.
      No diagnostics issued in procedure KZT$3270STT.
PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:129  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @KZ_3270STT_V              4-0-0/w PTR         r     1 @KZ_VDHSTT_V
    *0-0-0/w VECT        r     1 KZ_3270STT_V              *0-0-0/w VECT        r     1 KZ_VDHSTT_V

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(272)   r     1 KZ_3270M_HDR               0-0-0/w PTR         r     1 KZ_VDHSTT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(8960)  r     1 KV$STT                     0-0-0/w STRC(2656)  r     1 KZ$3270STT


   Procedure KZT$3270STT requires 42 words for executable code.
   Procedure KZT$3270STT requires 11 words of local(AUTO) storage.

    No errors detected in file KZT$3270IO.:E05TSI    .
PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:130  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KZT$3270STT File=KZT$3270IO.:E05TSI                           WED 07/30/97 03:04 Page:131  
          MINI XREF LISTING

KV$STT
      9659**DCL     10484--ASSIGN
KV$STT.REQSTATS.DSPMSK
      9905**DCL      9911--REDEF
KV$STT.REQSTATS.SLCMSK
      9946**DCL      9953--REDEF
KZ$3270STT
     10070**DCL     10485--ASSIGN
KZ$3270STT.REQSTATS.DSPMSK
     10341**DCL     10347--REDEF
KZ$3270STT.REQSTATS.SLCMSK
     10382**DCL     10389--REDEF
KZ_3270M_HDR.STTBFR$
     10042**DCL     10485>>ASSIGN
KZ_3270STT_V
      9631**DCL         9--PROC    10485<<ASSIGN
KZ_VDHSTT$
     10482**DCL     10484>>ASSIGN
KZ_VDHSTT_V
      9630**DCL         9--PROC    10484<<ASSIGN
