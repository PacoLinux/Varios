VERSION A05

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:1    
        1        1        /*M* VDP$NAMES - Note updated names associated with windows.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P* NAME:         VDP$NAMES
       10       10             PURPOSE:      Presenter's "note updated name" module.
       11       11             DESCRIPTION:  Updates selected WINDOW_SPECs to reflect the new
       12       12                           value of the name.
       13       13        */
       14       14
       15       15        /*D* NAME:         VDP$NKEYIN
       16       16             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
       17       17                           text of the keystroke(s) to IMP.
       18       18                           KEY_VALUE is a list of VD$BUFFERs containing the
       19       19                           text(s) which KEY_NAME is to be IMP'ed to.
       20       20                           WINDOW_SPEC is unused.
       21       21             INPUT:        None.
       22       22             OUTPUT:       Error if the library service ALTRETURNs;
       23       23                           otherwise, the keystroke(s) are IMP'ed.
       24       24             DESCRIPTION:  Called from VDA$WRITERS when a write operation
       25       25                           has been performed on the (internal) KEYINS
       26       26                           file.
       27       27                           Fills in the library service's parameter
       28       28                           "packet", and calls it.
       29       29        */
       30       30
       31       31        VDP$NKEYIN: PROC (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;
       32       32
       33       33          %INCLUDE CP_6;
       34      114          %INCLUDE VDP_MACRO_C;
       35      140          %INCLUDE VD_MACROS_M;
       36     2355
       37     2356          %VD$TEXTC (NAME=KEY_NAME, STCLASS=PARAM);
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:2    
       38     2379          %VD$NAME_SPEC (NAME=EQUALS_SPEC);
       39     2427    1     DCL SECOND_PARAMETER CHAR(AUTO_VARIABLE) PARAM;
       40     2428          %VD$BUFFER (NAME=WHATEVER_VALUE, STCLASS="REDEF SECOND_PARAMETER");
       41     2486          %VD$BUFFER (NAME=KEY_VALUE, STCLASS="REDEF SECOND_PARAMETER");
       42     2544    1     DCL EQUALS_VALUE REDEF SECOND_PARAMETER SBIN;
       43     2545          %VD$WINDOW_SPEC (NAME=WINDOW_SPEC, STCLASS="PARAM");
       44     2611
       45     2612          %VD_6E (STCLASS=SYMREF);
       46     2648          %VD_BUFFER (NAME=VD_$INTRO_1, MXNB=%MXNB_$INTRO, STCLASS=SYMREF);
       47     2708          %VD_BUFFER (NAME=VD_$INTRO_2, MXNB=%MXNB_$INTRO, STCLASS=SYMREF);
       48     2768
       49     2769    1     DCL VDG$ESCREECH ENTRY (3);
       50     2770    1     DCL VDG$OALLOC ENTRY (3) ALTRET;
       51     2771    1     DCL VDP$IMP ENTRY (1) ALTRET;
       52     2772
       53     2773          %XUI_IMP;
       54     2834
       55     2835    1     DCL AUTO_VARIABLE UBIN;
       56     2836    1     DCL CURRENT_WINDOW$ PTR;
       57     2837    1     DCL FOUND_INTRO BIT(1) ALIGNED;
       58     2838    1     DCL ITS_A_DELETE BIT(1) ALIGNED;
       59     2839    1     DCL ITS_A_NEQUALS BIT(1) ALIGNED;
       60     2840    1     DCL NEW_WINDOW_SPECIFIC_VALUE$ PTR;
       61     2841    1     DCL VD_ERR$ PTR;
       62     2842    1     DCL WINDOW$ PTR;
       63     2843    1     DCL WINDOW_INDEX SBIN;
       64     2844    1     DCL WINDOW_NUMBER$ PTR;
       65     2845    1     DCL WINDOW_SPECIFIC_VALUE$ PTR;
       66     2846
       67     2847    1     DCL BIT1$ALIGNED BIT(1) ALIGNED BASED;
       68     2848    1     DCL UBIN$WORD UBIN WORD BASED;
       69     2849          %VD$BUFFER;
       70     2907          %VD$BUFFER_HEADER;
       71     2943          %VD$BUFFER (NAME=NEW_WINDOW$SPECIFIC_VALUE,
       72     2944                      STCLASS="BASED(NEW_WINDOW_SPECIFIC_VALUE$)");
       73     3002          %VD$BUFFER (NAME=WINDOW$SPECIFIC_VALUE,
       74     3003                      STCLASS="BASED(WINDOW_SPECIFIC_VALUE$)");
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:3    
       75     3061          %VD$BUFFER (NAME=WINDOW$SPECIFIC_KEYIN_VALUE,
       76     3062                      STCLASS="BASED(WINDOW_SPECIFIC_VALUE$)");
       77     3120          %VD$CMD_STREAM (NAME=CMD$STREAM, STCLASS="BASED(VD_6E.CMD_STREAM$)");
       78     3159          %VD$ERR (STCLASS="BASED(VD_ERR$)");
       79     3212          %VD$FILE_NODE;
       80     3305          %VD$NUMBER (NAME=WINDOW$SPECIFIC_EQUALS_VALUE,
       81     3306                      STCLASS="BASED(WINDOW_SPECIFIC_VALUE$)");
       82     3351          %VD$PORT;
       83     3449          %VD$STREAM;
       84     3555          %VD$TEXTC_NUMBER (NAME=WINDOW$NUMBER,
       85     3556                            STCLASS="BASED(WINDOW_NUMBER$)");
       86     3570          %VD$TEXTC_REMOTE;
       87     3631          %VD$WINDOW_SPEC (NAME=WINDOW$SPEC, STCLASS="BASED(CURRENT_WINDOW$)");
       88     3697        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:4    
       89     3698        /* VDP$NKEYIN: PROC (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET; */
       90     3699        /*           REALLY (KEY_NAME, KEY_VALUE, nil) ALTRET;                */
       91     3700    1       IF ADDR(WINDOW_SPEC) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;
       92     3701    1       ITS_A_NEQUALS = %FALSE;
       93     3702    1       ITS_A_DELETE = %FALSE;
       94     3703    1       GOTO NCOMMON;
       95     3704
       96     3705        /*D* NAME:         VDP$NKEYIN_DELETE
       97     3706             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
       98     3707                           text of the keystroke(s) to be un-IMP'ed.
       99     3708                           KEY_VALUE is unused.
      100     3709                           WINDOW_SPEC is unused.
      101     3710             INPUT:        None.
      102     3711             OUTPUT:       Error if the library service ALTRETURNs;
      103     3712                           otherwise, the keystroke(s) are un-IMP'ed.
      104     3713             DESCRIPTION:  Called from VDA$WRITERS when a write operation
      105     3714                           has been performed on the (internal) KEYINS
      106     3715                           file.
      107     3716                           Fills in the library service's parameter
      108     3717                           "packet", and calls it.
      109     3718        */
      110     3719    1   VDP$NKEYIN_DELETE: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;
      111     3720        /*                REALLY (KEY_NAME, nil, nil) ALTRET;                     */
      112     3721    1       IF ADDR(KEY_VALUE) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;
      113     3722    1       IF ADDR(WINDOW_SPEC) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;
      114     3723    1       ITS_A_NEQUALS = %FALSE;
      115     3724    1       ITS_A_DELETE = %TRUE;
      116     3725    1       GOTO NCOMMON;
      117     3726
      118     3727        /*D* NAME:         VDP$NKEYIN_1_WINDOW
      119     3728             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
      120     3729                           text of the keystroke(s) to IMP.
      121     3730                           KEY_VALUE is a VD$BUFFER containing the
      122     3731                           text which KEY_NAME is to be IMP'ed to.
      123     3732                           WINDOW_SPEC is the VD$WINDOW_SPEC of the
      124     3733                           specific window to apply the KEYIN to.
      125     3734             INPUT:        None.
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:5    
      126     3735             OUTPUT:       Error if the library service ALTRETURNs;
      127     3736                           otherwise, the keystroke(s) are IMP'ed.
      128     3737             DESCRIPTION:  Called from VDA$WWINDOWS when a write operation
      129     3738                           has been performed on the (internal) KEYINS
      130     3739                           file.
      131     3740                           Fills in the library service's parameter
      132     3741                           "packet", and calls it.
      133     3742        */
      134     3743    1   VDP$NKEYIN_1_WINDOW: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;
      135     3744        /*                  REALLY (KEY_NAME, KEY_VALUE, WINDOW_SPEC) ALTRET;        */
      136     3745    1       IF ADDR(WINDOW_SPEC) = ADDR(NIL) THEN CALL VDG$ESCREECH;
      137     3746    1       ITS_A_NEQUALS = %FALSE;
      138     3747    1       ITS_A_DELETE = %FALSE;
      139     3748    1       CURRENT_WINDOW$ = ADDR(WINDOW_SPEC);
      140     3749    1       WINDOW_SPECIFIC_VALUE$ = ADDR(KEY_VALUE);
      141     3750    1       CALL IMP_A_WINDOW;
      142     3751    1       RETURN;
      143     3752
      144     3753        /*D* NAME:         VDP$NKEYIN_DELETE_1_WINDOW
      145     3754             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
      146     3755                           text of the keystroke(s) to be un-IMP'ed.
      147     3756                           KEY_VALUE is unused.
      148     3757                           WINDOW_SPEC is the VD$WINDOW_SPEC of the
      149     3758                           specific window to delete the KEYIN from.
      150     3759             INPUT:        None.
      151     3760             OUTPUT:       Error if the library service ALTRETURNs;
      152     3761                           otherwise, the keystroke(s) are IMP'ed.
      153     3762             DESCRIPTION:  Called from VDA$WWINDOWS when a write operation
      154     3763                           has been performed on the (internal) KEYINS
      155     3764                           file.
      156     3765                           Fills in the library service's parameter
      157     3766                           "packet", and calls it.
      158     3767        */
      159     3768    1   VDP$NKEYIN_DELETE_1_WINDOW: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;
      160     3769        /*                          REALLY (KEY_NAME, nil, WINDOW_SPEC) ALTRET;
              3769        */
      161     3770    1       IF ADDR(KEY_VALUE) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:6    
      162     3771    1       IF ADDR(WINDOW_SPEC) = ADDR(NIL) THEN CALL VDG$ESCREECH;
      163     3772    1       ITS_A_NEQUALS = %FALSE;
      164     3773    1       ITS_A_DELETE = %TRUE;
      165     3774    1       CURRENT_WINDOW$ = ADDR(WINDOW_SPEC);
      166     3775    1       WINDOW_SPECIFIC_VALUE$ = ADDR(KEY_VALUE);
      167     3776    1       CALL IMP_A_WINDOW;
      168     3777    1       RETURN;
      169     3778        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:7    
      170     3779        /*D* NAME:         VDP$NEQUALS_1_WINDOW
      171     3780             PARAMETERS:   EQUALS_SPEC is a VD$name_spec describing the
      172     3781                           EQUALS name being used.
      173     3782                           EQUALS_VALUE is a VD$BUFFER or VD$NUMBER containing
      174     3783                           the value of the EQUALS name.
      175     3784                           WINDOW_SPEC is the VD$WINDOW_SPEC of the specific
      176     3785                           window to set the value for.
      177     3786             INPUT:        None.
      178     3787             OUTPUT:       VD$WINDOW_SPEC for the selected window updated
      179     3788                           for later VDP$NFLUSHing.
      180     3789             DESCRIPTION:  Called from VDA$WWINDOWs when a window is initially
      181     3790                           created, to merge initial values for the EQUALs
      182     3791                           parameters into the window.
      183     3792        */
      184     3793    1   VDP$NEQUALS_1_WINDOW: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;
      185     3794        /*                   REALLY (EQUALS_SPEC, EQUALS_VALUE, WINDOW_SPEC) */
      186     3795
      187     3796    1       CURRENT_WINDOW$ = ADDR(WINDOW_SPEC);
      188     3797    1       WINDOW_SPECIFIC_VALUE$ = ADDR(SECOND_PARAMETER);
      189     3798    1       ITS_A_NEQUALS = %FALSE; /* Lie a bit to force setting the value */
      190     3799    1       CALL EQUATE_A_WINDOW
      191     3800    2       WHENALTRETURN DO; ALTRETURN; END;
      192     3801    1       RETURN;
      193     3802        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:8    
      194     3803        /*D* NAME:         VDP$NEQUALS
      195     3804             PARAMETERS:   EQUALS_SPEC is a VD$NAME_SPEC describing
      196     3805                           the EQUALS name to equate.
      197     3806                           EQUALS_VALUE is a list of VD$BUFFERs containing the
      198     3807                           text(s) which EQUALS_NAME is to be EQUATEd to.
      199     3808                           WINDOW_SPEC is unused.
      200     3809             INPUT:        None.
      201     3810             OUTPUT:       VD$WINDOW_SPECs for selected windows updated.
      202     3811             DESCRIPTION:  Called from VDA$WRITERS when a write operation
      203     3812                           has been performed on the (internal) EQUALS file.
      204     3813                           Updates relevent WINDOW_SPECs for later VDP$NFLUSHing.
      205     3814        */
      206     3815    1   VDP$NEQUALS: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;
      207     3816        /*          REALLY (EQUALS_SPEC, EQUALS_VALUE, nil)               */
      208     3817
      209     3818    1       ITS_A_NEQUALS = %TRUE;
      210     3819    1       ITS_A_DELETE = %FALSE;
      211     3820
      212     3821    1   NCOMMON:
      213     3822    1       WINDOW$ = VD_6E.WINDOWS$ -> VD$STREAM.PORT$ ->
      214     3823    1         VD$PORT.LEVEL.INTERNAL$ (%LVL_FILE) -> VD$FILE_NODE.HEAD$;
      215     3824
      216     3825    1   NWHATEVER_ALL_THE_WINDOWS:
      217     3826    2       DO WHILE (WINDOW$ ~= ADDR(NIL));
      218     3827
      219     3828    2         CURRENT_WINDOW$ = WINDOW$ -> VD$FILE_NODE.DESC.SPEC.V$;
      220     3829
      221     3830    2         IF ITS_A_DELETE
      222     3831    2         THEN GOTO DO_THE_WINDOW;
      223     3832    2         ELSE
      224     3833    2   FIND_WINDOW_VALUE:
      225     3834    3           DO;
      226     3835                  /* First guess:  entry #0, for all windows */
      227     3836    3             WINDOW_SPECIFIC_VALUE$ = ADDR(WHATEVER_VALUE);
      228     3837                  /* Is there an entry #1:  for all editing windows? */
      229     3838    3             NEW_WINDOW_SPECIFIC_VALUE$ = WHATEVER_VALUE.FLINK$;
      230     3839    3             IF NEW_WINDOW_SPECIFIC_VALUE$ = ADDR(NIL) THEN
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:9    
      231     3840    3               EXIT FIND_WINDOW_VALUE;    /* Entry #0 is all there is */
      232     3841
      233     3842    3             IF NEW_WINDOW$SPECIFIC_VALUE.LENGTH# > 0
      234     3843    3               AND NOT WINDOW$SPEC.COMMAND THEN
      235     3844    4               DO;
      236     3845                      /* Newest guess */
      237     3846    4                 WINDOW_SPECIFIC_VALUE$ = NEW_WINDOW_SPECIFIC_VALUE$;
      238     3847    4               END;
      239     3848
      240     3849                  %GETKEY (KEY="WINDOW$->VD$FILE_NODE.DESC.KEY", PTR=WINDOW_NUMBER$);
      241     3859
      242     3860                  /* See if there's an entry for this window specifically */
      243     3861    4             DO WINDOW_INDEX = WINDOW$NUMBER.BYTES# DOWNTO 0;
      244     3862    4               NEW_WINDOW_SPECIFIC_VALUE$ = NEW_WINDOW$SPECIFIC_VALUE.FLINK$;
      245     3863    4               IF NEW_WINDOW_SPECIFIC_VALUE$ = ADDR(NIL) THEN
      246     3864    4                 EXIT FIND_WINDOW_VALUE; /* No value for this specific window */
      247     3865    4             END;
      248     3866
      249     3867    3             IF NEW_WINDOW$SPECIFIC_VALUE.LENGTH# > 0 THEN
      250     3868    4               DO;
      251     3869                      /* Found it */
      252     3870    4                 WINDOW_SPECIFIC_VALUE$ = NEW_WINDOW_SPECIFIC_VALUE$;
      253     3871    4               END;
      254     3872    3           END FIND_WINDOW_VALUE;
      255     3873
      256     3874              /* Did we find any entry we can use? */
      257     3875    2         IF WINDOW$SPECIFIC_VALUE.LENGTH# > 0 THEN
      258     3876    2   DO_THE_WINDOW:
      259     3877    3           DO;
      260     3878    3             IF ITS_A_NEQUALS
      261     3879    3             THEN
      262     3880    3               CALL EQUATE_A_WINDOW
      263     3881    4               WHENALTRETURN DO; ALTRETURN; END;
      264     3882    3             ELSE
      265     3883    3               CALL IMP_A_WINDOW
      266     3884    4               WHENALTRETURN DO; ALTRETURN; END;
      267     3885    3           END DO_THE_WINDOW;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:10   
      268     3886
      269     3887              /* On to the next window */
      270     3888    2         WINDOW$ = WINDOW$ -> VD$FILE_NODE.FLINK$;
      271     3889
      272     3890    2       END NWHATEVER_ALL_THE_WINDOWS;
      273     3891
      274     3892    1       RETURN;
      275     3893
      276     3894        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:11   
      277     3895    1   EQUATE_A_WINDOW: PROC ALTRET;
      278     3896
      279     3897    2       FOUND_INTRO = BINBIT(WINDOW$SPECIFIC_EQUALS_VALUE.V#, 1);
      280     3898    3       DO CASE (ADDR(KEY_NAME) -> EQUALS_SPEC.WRITER#);
      281     3899
      282     3900    3         CASE (%WRTR_$KEY_GENERATION);
      283     3901    3           IF WINDOW$SPEC.EDTCTL.KEY_GENERATION# = WINDOW$SPECIFIC_EQUALS_VALUE.V#
      284     3902    3             AND ITS_A_NEQUALS THEN EXIT;
      285     3903    3           WINDOW$SPEC.EDTCTL.KEY_GENERATION# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;
      286     3904    3           WINDOW$SPEC.EDTCTL.FLUSH.KEY_GENERATION = %TRUE;
      287     3905    3         CASE (%WRTR_$RECORDWRAP);
      288     3906    3           IF WINDOW$SPEC.EDTCTL.RECORDWRAP = FOUND_INTRO
      289     3907    3             AND ITS_A_NEQUALS THEN EXIT;
      290     3908    3           WINDOW$SPEC.EDTCTL.RECORDWRAP = FOUND_INTRO;
      291     3909    3           WINDOW$SPEC.EDTCTL.FLUSH.RECWRAP = %TRUE;
      292     3910    3         CASE (%WRTR_$VSCROLL);
      293     3911    3           IF WINDOW$SPEC.EDTCTL.VSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#
      294     3912    3             AND ITS_A_NEQUALS THEN EXIT;
      295     3913    3           WINDOW$SPEC.EDTCTL.VSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;
      296     3914    3           WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL = %TRUE;
      297     3915    3         CASE (%WRTR_$VSCROLL_MARGIN);
      298     3916    3           IF WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#
      299     3917    3             AND ITS_A_NEQUALS THEN EXIT;
      300     3918    3           WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;
      301     3919    3           WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL_MARGIN = %TRUE;
      302     3920    3         CASE (%WRTR_$EZ_APPEND);
      303     3921    3           IF WINDOW$SPEC.EDTCTL.EZAPPEND# = FOUND_INTRO
      304     3922    3             AND ITS_A_NEQUALS THEN EXIT;
      305     3923    3           WINDOW$SPEC.EDTCTL.EZAPPEND# = FOUND_INTRO;
      306     3924    3           WINDOW$SPEC.EDTCTL.FLUSH.EZAPPEND = %TRUE;
      307     3925    3         CASE (%WRTR_$HSALL);
      308     3926    3           IF WINDOW$SPEC.EDTCTL.HSALL# = FOUND_INTRO
      309     3927    3             AND ITS_A_NEQUALS THEN EXIT;
      310     3928    3           WINDOW$SPEC.EDTCTL.HSALL# = FOUND_INTRO;
      311     3929    3           WINDOW$SPEC.EDTCTL.FLUSH.HSALL = %TRUE;
      312     3930    3         CASE (%WRTR_$ONESPACEEDIT);
      313     3931    3           IF WINDOW$SPEC.EDTCTL.ONESPACEEDIT# = FOUND_INTRO
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:12   
      314     3932    3             AND ITS_A_NEQUALS THEN EXIT;
      315     3933    3           WINDOW$SPEC.EDTCTL.ONESPACEEDIT# = FOUND_INTRO;
      316     3934    3           WINDOW$SPEC.EDTCTL.FLUSH.ONESPACEEDIT = %TRUE;
      317     3935    3         CASE (%WRTR_$TEXTEDIT);
      318     3936    3           IF WINDOW$SPEC.EDTCTL.TEXTEDIT# = FOUND_INTRO
      319     3937    3             AND ITS_A_NEQUALS THEN EXIT;
      320     3938    3           WINDOW$SPEC.EDTCTL.TEXTEDIT# = FOUND_INTRO;
      321     3939    3           WINDOW$SPEC.EDTCTL.FLUSH.TEXTEDIT = %TRUE;
      322     3940    3         CASE (%WRTR_$AUTOTAB);
      323     3941    3           IF WINDOW$SPEC.TRMCTL.AUTOTAB# = WINDOW$SPECIFIC_EQUALS_VALUE.V#
      324     3942    3             AND ITS_A_NEQUALS THEN EXIT;
      325     3943    3           WINDOW$SPEC.TRMCTL.AUTOTAB# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;
      326     3944    3           WINDOW$SPEC.TRMCTL.FLUSH.AUTOTAB = %TRUE;
      327     3945    3         CASE (%WRTR_$HSCROLL);
      328     3946    3           IF WINDOW$SPEC.TRMCTL.HSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#
      329     3947    3             AND ITS_A_NEQUALS THEN EXIT;
      330     3948    3           WINDOW$SPEC.TRMCTL.HSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;
      331     3949    3           WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL = %TRUE;
      332     3950    3         CASE (%WRTR_$HSCROLL_MARGIN);
      333     3951    3           IF WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#
      334     3952    3             AND ITS_A_NEQUALS THEN EXIT;
      335     3953    3           WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;
      336     3954    3           WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL_MARGIN = %TRUE;
      337     3955    3         CASE (%WRTR_$INSERT);
      338     3956    3           IF WINDOW$SPEC.TRMCTL.INSERT_MODE = FOUND_INTRO
      339     3957    3             AND ITS_A_NEQUALS THEN EXIT;
      340     3958    3           WINDOW$SPEC.TRMCTL.INSERT_MODE = FOUND_INTRO;
      341     3959    3           WINDOW$SPEC.TRMCTL.FLUSH.INSERT_MODE = %TRUE;
      342     3960    3         CASE (%WRTR_$SCROLL);
      343     3961    3           IF WINDOW$SPEC.TRMCTL.SCROLL# = FOUND_INTRO
      344     3962    3             AND ITS_A_NEQUALS THEN EXIT;
      345     3963    3           WINDOW$SPEC.TRMCTL.SCROLL# = FOUND_INTRO;
      346     3964    3           WINDOW$SPEC.TRMCTL.FLUSH.SCROLL = %TRUE;
      347     3965    3         CASE (%WRTR_$WORDWRAP);
      348     3966    3           IF WINDOW$SPEC.TRMCTL.WORDWRAP# = WINDOW$SPECIFIC_EQUALS_VALUE.V#
      349     3967    3             AND ITS_A_NEQUALS THEN EXIT;
      350     3968    3           WINDOW$SPEC.TRMCTL.WORDWRAP# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:13   
      351     3969    3           WINDOW$SPEC.TRMCTL.FLUSH.WORDWRAP = %TRUE;
      352     3970
      353     3971    3         CASE (%WRTR_$INTRO_1);
      354     3972    3           WINDOW$SPEC.INTRO_1.LENGTH# = MINIMUM(%MXNB_$INTRO,
      355     3973    3             WINDOW$SPECIFIC_VALUE.LENGTH#);
      356     3974    3           WINDOW$SPEC.INTRO_1.BYTES = WINDOW$SPECIFIC_VALUE.BYTES;
      357     3975    3         CASE (%WRTR_$INTRO_2);
      358     3976    3           WINDOW$SPEC.INTRO_2.LENGTH# = MINIMUM(%MXNB_$INTRO,
      359     3977    3             WINDOW$SPECIFIC_VALUE.LENGTH#);
      360     3978    3           WINDOW$SPEC.INTRO_2.BYTES = WINDOW$SPECIFIC_VALUE.BYTES;
      361     3979
      362     3980              /*N* Tabs36719 */
      363     3981    3         CASE (%WRTR_$EOF_MARK);
      364     3982    4           IF WINDOW$SPEC.EOFMARK$ = ADDR(NIL) THEN DO;
      365     3983    4               IF WINDOW$SPECIFIC_VALUE.LENGTH# = 0 THEN RETURN;
      366     3984    4               CALL VDG$OALLOC (%CLS_BUFFER, WINDOW$SPEC.EOFMARK$,
      367     3985    4                 (%MXNB_$EOF_MARK+SIZEC(VD$BUFFER_HEADER)) / %NB_PER_WORD)
      368     3986    5               WHENALTRETURN DO; ALTRETURN; END;
      369     3987    4               WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.LENGTH# = 0;
      370     3988    4             END;
      371     3989    3           IF WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.BYTES =
      372     3990    3             WINDOW$SPECIFIC_VALUE.BYTES
      373     3991    3             AND ITS_A_NEQUALS THEN EXIT;
      374     3992    3           WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.LENGTH# =
      375     3993    3             WINDOW$SPECIFIC_VALUE.LENGTH#;
      376     3994    3           WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.BYTES =
      377     3995    3             WINDOW$SPECIFIC_VALUE.BYTES;
      378     3996    3           WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK = %TRUE;
      379     3997    3         CASE (ELSE);
      380     3998    3           CALL VDG$ESCREECH;
      381     3999
      382     4000    3       END;
      383     4001
      384     4002    2       RETURN;
      385     4003
      386     4004    2   END EQUATE_A_WINDOW;
      387     4005        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:14   
      388     4006    1   IMP_A_WINDOW: PROC ALTRET;
      389     4007
      390     4008    2     DCL 1 MY_KEY_NAME,
      391     4009    2           2 LENGTH# UBIN BYTE CALIGNED,
      392     4010    2           2 BYTES CHAR(7),
      393     4011    2           2 UBYTES(0:6) REDEF BYTES UBIN BYTE CALIGNED;
      394     4012
      395     4013    2       IF ADDR(KEY_NAME)=ADDR(NIL) THEN CALL VDG$ESCREECH;
      396     4014    2       XUI_IMP_FLG.F = '0'B;
      397     4015    2       XUI_IMP.KEY_NAME$ = ADDR(MY_KEY_NAME);
      398     4016    2       MY_KEY_NAME.BYTES = SUBSTR(KEY_NAME.BYTES,0,4);
      399     4017    2       IF MY_KEY_NAME.UBYTES(0) = 511
      400     4018    2       THEN
      401     4019    3         DO; /* We have an escape sequence, see what it means */
      402     4020    3           MY_KEY_NAME.BYTES = SUBSTR(MY_KEY_NAME.BYTES,1);
      403     4021    3           IF MY_KEY_NAME.UBYTES(0) ~= 511
      404     4022    3           THEN
      405     4023    3             XUI_IMP.CTRSTR# = %TRUE;
      406     4024    3           MY_KEY_NAME.LENGTH# = KEY_NAME.LENGTH#-1;
      407     4025    3         END;
      408     4026    2       ELSE
      409     4027    2         MY_KEY_NAME.LENGTH# = KEY_NAME.LENGTH#;
      410     4028    2       IF MY_KEY_NAME.UBYTES(0)>255
      411     4029    2       THEN
      412     4030    2         XUI_IMP.FNCKEY# = %TRUE;
      413     4031
      414     4032        /*N*IF ADDR(INPUT) ~= ADDR(NIL)      *N*/
      415     4033        /*N*THEN                             *N*/
      416     4034        /*N*  XUI_IMP.INPUT_OPTION# = INPUT; *N*/
      417     4035
      418     4036    3       DO CASE (MY_KEY_NAME.LENGTH#);
      419     4037
      420     4038    3         CASE (1);
      421     4039
      422     4040    3         CASE (2, 3);
      423     4041    3           IF VD_$INTRO_1.LENGTH# > 0
      424     4042    3             AND VD_$INTRO_1.BYTES = SUBSTR(KEY_NAME.BYTES, 0, KEY_NAME.LENGTH#-1)
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:15   
      425     4043    3           THEN
      426     4044    3             XUI_IMP.PRIMARY# = %TRUE;
      427     4045    3           ELSE IF VD_$INTRO_2.LENGTH# > 0
      428     4046    3               AND VD_$INTRO_2.BYTES = SUBSTR(KEY_NAME.BYTES, 0, KEY_NAME.LENGTH#-1)
      429     4047    3             THEN
      430     4048    3               XUI_IMP.SECONDARY# = %TRUE;
      431     4049    3             ELSE
      432     4050    3               CALL VDG$ESCREECH;
      433     4051
      434     4052    3         CASE (ELSE);
      435     4053    3           CALL VDG$ESCREECH;
      436     4054
      437     4055    3       END;
      438     4056
      439     4057    2       IF WINDOW$SPEC.KEY_DEFINITION_BUFFER$ = ADDR(NIL)
      440     4058    2       THEN
      441     4059    2   OALLOC_THE_IMP_BUFFER:
      442     4060    3         DO;
      443     4061    3           CALL VDG$OALLOC (%CLS_BUFFER,
      444     4062    3             WINDOW$SPEC.KEY_DEFINITION_BUFFER$,
      445     4063    3             1024 / %NB_PER_WORD)
      446     4064    4           WHENALTRETURN DO; ALTRETURN; END;
      447     4065
      448     4066    3           WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH# = 0;
      449     4067    3         END OALLOC_THE_IMP_BUFFER;
      450     4068
      451     4069    2       VBASE (XUI_IMP.IMP_BUFFER_) =
      452     4070    2         ADDR (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.BYTES);
      453     4071    2       VBOUND (XUI_IMP.IMP_BUFFER_) =
      454     4072    2         (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.OBJECT.SIZE#
      455     4073    2         * %NB_PER_WORD)
      456     4074    2         - SIZEC (VD$BUFFER_HEADER);
      457     4075    2       XUI_IMP.IMP_BUFFER_OFFSET =
      458     4076    2         WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH#;
      459     4077
      460     4078    2       IF ITS_A_DELETE
      461     4079    2       THEN
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:16   
      462     4080    2         XUI_IMP.KEY_VALUE$ = ADDR (NIL);
      463     4081    2       ELSE
      464     4082    2         XUI_IMP.KEY_VALUE$ = ADDR(WINDOW$SPECIFIC_KEYIN_VALUE.LENGTH#);
      465     4083    2       XUI_IMP.IMPDCBNUM# = WINDOW$SPEC.DCB#;
      466     4084
      467     4085    2       CALL VDP$IMP (XUI_IMP)
      468     4086    2       WHENALTRETURN
      469     4087    3         DO;
      470     4088    3           CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)
      471     4089    4           WHENALTRETURN DO; ALTRETURN; END;
      472     4090    3           VD$ERR.ERR = XUI_IMP.ERRCODE;
      473     4091    3           VD$ERR.FLAGLEV# = %FLV_SERIOUS;
      474     4092    3           ALTRETURN;
      475     4093    3         END;
      476     4094
      477     4095    2       IF XUI_IMP.IMP_BUFFER_OFFSET ~= 0
      478     4096    2       THEN
      479     4097    2         WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH# =
      480     4098    2           XUI_IMP.IMP_BUFFER_OFFSET;
      481     4099
      482     4100    2       RETURN;
      483     4101
      484     4102    2   END IMP_A_WINDOW;
      485     4103
      486     4104    1   END VDP$NKEYIN;
      487     4105        %EOD;

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:17   
--  Include file information  --

   VD_MACROS_M.:VDA5TOU  is referenced.
   VDP_MACRO_C.:VDA5TOU  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDP$NKEYIN.

   Procedure VDP$NKEYIN requires 659 words for executable code.
   Procedure VDP$NKEYIN requires 26 words of local(AUTO) storage.

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:18   

 Object Unit name= VDP$NKEYIN                                 File name= VDP$NAMES.:VDA5TOU
 UTS= JUL 04 '97 11:36:45.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     8     10  VDP$NKEYIN
    2   Proc  even  none   659   1223  VDP$NKEYIN
    3  RoData even  none     8     10  VDP$NKEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        3  VDP$NKEYIN
     2     13          yes     yes      Std        3  VDP$NKEYIN_DELETE
     2     35          yes     yes      Std        3  VDP$NKEYIN_1_WINDOW
     2     56          yes     yes      Std        3  VDP$NKEYIN_DELETE_1_WINDOW
     2    106          yes     yes      Std        3  VDP$NEQUALS_1_WINDOW
     2    122          yes     yes      Std        3  VDP$NEQUALS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 VDG$ESCREECH
 yes     yes           Std       3 VDG$OALLOC
 yes     yes           Std       1 VDP$IMP
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:19   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VD_6E                                 VD_$INTRO_1
     VD_$INTRO_2                           B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:20   


        1        1        /*M* VDP$NAMES - Note updated names associated with windows.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P* NAME:         VDP$NAMES
       10       10             PURPOSE:      Presenter's "note updated name" module.
       11       11             DESCRIPTION:  Updates selected WINDOW_SPECs to reflect the new
       12       12                           value of the name.
       13       13        */
       14       14
       15       15        /*D* NAME:         VDP$NKEYIN
       16       16             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
       17       17                           text of the keystroke(s) to IMP.
       18       18                           KEY_VALUE is a list of VD$BUFFERs containing the
       19       19                           text(s) which KEY_NAME is to be IMP'ed to.
       20       20                           WINDOW_SPEC is unused.
       21       21             INPUT:        None.
       22       22             OUTPUT:       Error if the library service ALTRETURNs;
       23       23                           otherwise, the keystroke(s) are IMP'ed.
       24       24             DESCRIPTION:  Called from VDA$WRITERS when a write operation
       25       25                           has been performed on the (internal) KEYINS
       26       26                           file.
       27       27                           Fills in the library service's parameter
       28       28                           "packet", and calls it.
       29       29        */
       30       30
       31       31        VDP$NKEYIN: PROC (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;

     31  2 000000   000000 700200 xent  VDP$NKEYIN   TSX0  ! X66_AUTO_3
         2 000001   000032 000003                    ZERO    26,3

       32       32
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:21   
       33       33          %INCLUDE CP_6;
       34      114          %INCLUDE VDP_MACRO_C;
       35      140          %INCLUDE VD_MACROS_M;
       36     2355
       37     2356          %VD$TEXTC (NAME=KEY_NAME, STCLASS=PARAM);
       38     2379          %VD$NAME_SPEC (NAME=EQUALS_SPEC);
       39     2427    1     DCL SECOND_PARAMETER CHAR(AUTO_VARIABLE) PARAM;
       40     2428          %VD$BUFFER (NAME=WHATEVER_VALUE, STCLASS="REDEF SECOND_PARAMETER");
       41     2486          %VD$BUFFER (NAME=KEY_VALUE, STCLASS="REDEF SECOND_PARAMETER");
       42     2544    1     DCL EQUALS_VALUE REDEF SECOND_PARAMETER SBIN;
       43     2545          %VD$WINDOW_SPEC (NAME=WINDOW_SPEC, STCLASS="PARAM");
       44     2611
       45     2612          %VD_6E (STCLASS=SYMREF);
       46     2648          %VD_BUFFER (NAME=VD_$INTRO_1, MXNB=%MXNB_$INTRO, STCLASS=SYMREF);
       47     2708          %VD_BUFFER (NAME=VD_$INTRO_2, MXNB=%MXNB_$INTRO, STCLASS=SYMREF);
       48     2768
       49     2769    1     DCL VDG$ESCREECH ENTRY (3);
       50     2770    1     DCL VDG$OALLOC ENTRY (3) ALTRET;
       51     2771    1     DCL VDP$IMP ENTRY (1) ALTRET;
       52     2772
       53     2773          %XUI_IMP;
       54     2834
       55     2835    1     DCL AUTO_VARIABLE UBIN;
       56     2836    1     DCL CURRENT_WINDOW$ PTR;
       57     2837    1     DCL FOUND_INTRO BIT(1) ALIGNED;
       58     2838    1     DCL ITS_A_DELETE BIT(1) ALIGNED;
       59     2839    1     DCL ITS_A_NEQUALS BIT(1) ALIGNED;
       60     2840    1     DCL NEW_WINDOW_SPECIFIC_VALUE$ PTR;
       61     2841    1     DCL VD_ERR$ PTR;
       62     2842    1     DCL WINDOW$ PTR;
       63     2843    1     DCL WINDOW_INDEX SBIN;
       64     2844    1     DCL WINDOW_NUMBER$ PTR;
       65     2845    1     DCL WINDOW_SPECIFIC_VALUE$ PTR;
       66     2846
       67     2847    1     DCL BIT1$ALIGNED BIT(1) ALIGNED BASED;
       68     2848    1     DCL UBIN$WORD UBIN WORD BASED;
       69     2849          %VD$BUFFER;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:22   
       70     2907          %VD$BUFFER_HEADER;
       71     2943          %VD$BUFFER (NAME=NEW_WINDOW$SPECIFIC_VALUE,
       72     2944                      STCLASS="BASED(NEW_WINDOW_SPECIFIC_VALUE$)");
       73     3002          %VD$BUFFER (NAME=WINDOW$SPECIFIC_VALUE,
       74     3003                      STCLASS="BASED(WINDOW_SPECIFIC_VALUE$)");
       75     3061          %VD$BUFFER (NAME=WINDOW$SPECIFIC_KEYIN_VALUE,
       76     3062                      STCLASS="BASED(WINDOW_SPECIFIC_VALUE$)");
       77     3120          %VD$CMD_STREAM (NAME=CMD$STREAM, STCLASS="BASED(VD_6E.CMD_STREAM$)");
       78     3159          %VD$ERR (STCLASS="BASED(VD_ERR$)");
       79     3212          %VD$FILE_NODE;
       80     3305          %VD$NUMBER (NAME=WINDOW$SPECIFIC_EQUALS_VALUE,
       81     3306                      STCLASS="BASED(WINDOW_SPECIFIC_VALUE$)");
       82     3351          %VD$PORT;
       83     3449          %VD$STREAM;
       84     3555          %VD$TEXTC_NUMBER (NAME=WINDOW$NUMBER,
       85     3556                            STCLASS="BASED(WINDOW_NUMBER$)");
       86     3570          %VD$TEXTC_REMOTE;
       87     3631          %VD$WINDOW_SPEC (NAME=WINDOW$SPEC, STCLASS="BASED(CURRENT_WINDOW$)");
       88     3697        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:23   
       89     3698        /* VDP$NKEYIN: PROC (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET; */
       90     3699        /*           REALLY (KEY_NAME, KEY_VALUE, nil) ALTRET;                */
       91     3700    1       IF ADDR(WINDOW_SPEC) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;

   3700  2 000002   200005 236100                    LDQ     @WINDOW_SPEC,,AUTO
         2 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000004   000010 600000 2                  TZE     s:3701

   3700  2 000005   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000006   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000007   000000 011000                    NOP     0

       92     3701    1       ITS_A_NEQUALS = %FALSE;

   3701  2 000010   200012 450100                    STZ     ITS_A_NEQUALS,,AUTO

       93     3702    1       ITS_A_DELETE = %FALSE;

   3702  2 000011   200011 450100                    STZ     ITS_A_DELETE,,AUTO

       94     3703    1       GOTO NCOMMON;

   3703  2 000012   000127 710000 2                  TRA     NCOMMON

       95     3704
       96     3705        /*D* NAME:         VDP$NKEYIN_DELETE
       97     3706             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
       98     3707                           text of the keystroke(s) to be un-IMP'ed.
       99     3708                           KEY_VALUE is unused.
      100     3709                           WINDOW_SPEC is unused.
      101     3710             INPUT:        None.
      102     3711             OUTPUT:       Error if the library service ALTRETURNs;
      103     3712                           otherwise, the keystroke(s) are un-IMP'ed.
      104     3713             DESCRIPTION:  Called from VDA$WRITERS when a write operation
      105     3714                           has been performed on the (internal) KEYINS
      106     3715                           file.
      107     3716                           Fills in the library service's parameter
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:24   
      108     3717                           "packet", and calls it.
      109     3718        */
      110     3719    1   VDP$NKEYIN_DELETE: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;

   3719  2 000013   000000 700200 xent  VDP$NKEYIN_* TSX0  ! X66_AUTO_3
         2 000014   000032 000003                    ZERO    26,3

      111     3720        /*                REALLY (KEY_NAME, nil, nil) ALTRET;                     */
      112     3721    1       IF ADDR(KEY_VALUE) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;

   3721  2 000015   200004 236100                    LDQ     @SECOND_PARAMETER,,AUTO
         2 000016   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000017   000023 600000 2                  TZE     s:3722

   3721  2 000020   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000021   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000022   000000 011000                    NOP     0

      113     3722    1       IF ADDR(WINDOW_SPEC) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;

   3722  2 000023   200005 236100                    LDQ     @WINDOW_SPEC,,AUTO
         2 000024   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000025   000031 600000 2                  TZE     s:3723

   3722  2 000026   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000027   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000030   000000 011000                    NOP     0

      114     3723    1       ITS_A_NEQUALS = %FALSE;

   3723  2 000031   200012 450100                    STZ     ITS_A_NEQUALS,,AUTO

      115     3724    1       ITS_A_DELETE = %TRUE;

   3724  2 000032   400000 236003                    LDQ     -131072,DU
         2 000033   200011 756100                    STQ     ITS_A_DELETE,,AUTO

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:25   
      116     3725    1       GOTO NCOMMON;

   3725  2 000034   000127 710000 2                  TRA     NCOMMON

      117     3726
      118     3727        /*D* NAME:         VDP$NKEYIN_1_WINDOW
      119     3728             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
      120     3729                           text of the keystroke(s) to IMP.
      121     3730                           KEY_VALUE is a VD$BUFFER containing the
      122     3731                           text which KEY_NAME is to be IMP'ed to.
      123     3732                           WINDOW_SPEC is the VD$WINDOW_SPEC of the
      124     3733                           specific window to apply the KEYIN to.
      125     3734             INPUT:        None.
      126     3735             OUTPUT:       Error if the library service ALTRETURNs;
      127     3736                           otherwise, the keystroke(s) are IMP'ed.
      128     3737             DESCRIPTION:  Called from VDA$WWINDOWS when a write operation
      129     3738                           has been performed on the (internal) KEYINS
      130     3739                           file.
      131     3740                           Fills in the library service's parameter
      132     3741                           "packet", and calls it.
      133     3742        */
      134     3743    1   VDP$NKEYIN_1_WINDOW: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;

   3743  2 000035   000000 700200 xent  VDP$NKEYIN_* TSX0  ! X66_AUTO_3
         2 000036   000032 000003                    ZERO    26,3

      135     3744        /*                  REALLY (KEY_NAME, KEY_VALUE, WINDOW_SPEC) ALTRET;        */
      136     3745    1       IF ADDR(WINDOW_SPEC) = ADDR(NIL) THEN CALL VDG$ESCREECH;

   3745  2 000037   200005 236100                    LDQ     @WINDOW_SPEC,,AUTO
         2 000040   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000041   000045 601000 2                  TNZ     s:3746

   3745  2 000042   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000043   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000044   000000 011000                    NOP     0

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:26   
      137     3746    1       ITS_A_NEQUALS = %FALSE;

   3746  2 000045   200012 450100                    STZ     ITS_A_NEQUALS,,AUTO

      138     3747    1       ITS_A_DELETE = %FALSE;

   3747  2 000046   200011 450100                    STZ     ITS_A_DELETE,,AUTO

      139     3748    1       CURRENT_WINDOW$ = ADDR(WINDOW_SPEC);

   3748  2 000047   200005 236100                    LDQ     @WINDOW_SPEC,,AUTO
         2 000050   200007 756100                    STQ     CURRENT_WINDOW$,,AUTO

      140     3749    1       WINDOW_SPECIFIC_VALUE$ = ADDR(KEY_VALUE);

   3749  2 000051   200004 236100                    LDQ     @SECOND_PARAMETER,,AUTO
         2 000052   200020 756100                    STQ     WINDOW_SPECIFIC_VALUE$,,AUTO

      141     3750    1       CALL IMP_A_WINDOW;

   3750  2 000053   000760 701000 2                  TSX1    IMP_A_WINDOW
         2 000054   000000 011000                    NOP     0

      142     3751    1       RETURN;

   3751  2 000055   000000 702200 xent               TSX2  ! X66_ARET

      143     3752
      144     3753        /*D* NAME:         VDP$NKEYIN_DELETE_1_WINDOW
      145     3754             PARAMETERS:   KEY_NAME is a VD$TEXTC containing the
      146     3755                           text of the keystroke(s) to be un-IMP'ed.
      147     3756                           KEY_VALUE is unused.
      148     3757                           WINDOW_SPEC is the VD$WINDOW_SPEC of the
      149     3758                           specific window to delete the KEYIN from.
      150     3759             INPUT:        None.
      151     3760             OUTPUT:       Error if the library service ALTRETURNs;
      152     3761                           otherwise, the keystroke(s) are IMP'ed.
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:27   
      153     3762             DESCRIPTION:  Called from VDA$WWINDOWS when a write operation
      154     3763                           has been performed on the (internal) KEYINS
      155     3764                           file.
      156     3765                           Fills in the library service's parameter
      157     3766                           "packet", and calls it.
      158     3767        */
      159     3768    1   VDP$NKEYIN_DELETE_1_WINDOW: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;

   3768  2 000056   000000 700200 xent  VDP$NKEYIN_* TSX0  ! X66_AUTO_3
         2 000057   000032 000003                    ZERO    26,3

      160     3769        /*                          REALLY (KEY_NAME, nil, WINDOW_SPEC) ALTRET;
              3769        */
      161     3770    1       IF ADDR(KEY_VALUE) ~= ADDR(NIL) THEN CALL VDG$ESCREECH;

   3770  2 000060   200004 236100                    LDQ     @SECOND_PARAMETER,,AUTO
         2 000061   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000062   000066 600000 2                  TZE     s:3771

   3770  2 000063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000064   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000065   000000 011000                    NOP     0

      162     3771    1       IF ADDR(WINDOW_SPEC) = ADDR(NIL) THEN CALL VDG$ESCREECH;

   3771  2 000066   200005 236100                    LDQ     @WINDOW_SPEC,,AUTO
         2 000067   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000070   000074 601000 2                  TNZ     s:3772

   3771  2 000071   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000072   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000073   000000 011000                    NOP     0

      163     3772    1       ITS_A_NEQUALS = %FALSE;

   3772  2 000074   200012 450100                    STZ     ITS_A_NEQUALS,,AUTO

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:28   
      164     3773    1       ITS_A_DELETE = %TRUE;

   3773  2 000075   400000 236003                    LDQ     -131072,DU
         2 000076   200011 756100                    STQ     ITS_A_DELETE,,AUTO

      165     3774    1       CURRENT_WINDOW$ = ADDR(WINDOW_SPEC);

   3774  2 000077   200005 236100                    LDQ     @WINDOW_SPEC,,AUTO
         2 000100   200007 756100                    STQ     CURRENT_WINDOW$,,AUTO

      166     3775    1       WINDOW_SPECIFIC_VALUE$ = ADDR(KEY_VALUE);

   3775  2 000101   200004 236100                    LDQ     @SECOND_PARAMETER,,AUTO
         2 000102   200020 756100                    STQ     WINDOW_SPECIFIC_VALUE$,,AUTO

      167     3776    1       CALL IMP_A_WINDOW;

   3776  2 000103   000760 701000 2                  TSX1    IMP_A_WINDOW
         2 000104   000000 011000                    NOP     0

      168     3777    1       RETURN;

   3777  2 000105   000000 702200 xent               TSX2  ! X66_ARET

      169     3778        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:29   
      170     3779        /*D* NAME:         VDP$NEQUALS_1_WINDOW
      171     3780             PARAMETERS:   EQUALS_SPEC is a VD$name_spec describing the
      172     3781                           EQUALS name being used.
      173     3782                           EQUALS_VALUE is a VD$BUFFER or VD$NUMBER containing
      174     3783                           the value of the EQUALS name.
      175     3784                           WINDOW_SPEC is the VD$WINDOW_SPEC of the specific
      176     3785                           window to set the value for.
      177     3786             INPUT:        None.
      178     3787             OUTPUT:       VD$WINDOW_SPEC for the selected window updated
      179     3788                           for later VDP$NFLUSHing.
      180     3789             DESCRIPTION:  Called from VDA$WWINDOWs when a window is initially
      181     3790                           created, to merge initial values for the EQUALs
      182     3791                           parameters into the window.
      183     3792        */
      184     3793    1   VDP$NEQUALS_1_WINDOW: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;

   3793  2 000106   000000 700200 xent  VDP$NEQUALS* TSX0  ! X66_AUTO_3
         2 000107   000032 000003                    ZERO    26,3

      185     3794        /*                   REALLY (EQUALS_SPEC, EQUALS_VALUE, WINDOW_SPEC) */
      186     3795
      187     3796    1       CURRENT_WINDOW$ = ADDR(WINDOW_SPEC);

   3796  2 000110   200005 236100                    LDQ     @WINDOW_SPEC,,AUTO
         2 000111   200007 756100                    STQ     CURRENT_WINDOW$,,AUTO

      188     3797    1       WINDOW_SPECIFIC_VALUE$ = ADDR(SECOND_PARAMETER);

   3797  2 000112   200004 236100                    LDQ     @SECOND_PARAMETER,,AUTO
         2 000113   200020 756100                    STQ     WINDOW_SPECIFIC_VALUE$,,AUTO

      189     3798    1       ITS_A_NEQUALS = %FALSE; /* Lie a bit to force setting the value */

   3798  2 000114   200012 450100                    STZ     ITS_A_NEQUALS,,AUTO

      190     3799    1       CALL EQUATE_A_WINDOW

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:30   
   3799  2 000115   000243 701000 2                  TSX1    EQUATE_A_WINDOW
         2 000116   000120 702000 2                  TSX2    s:3800
         2 000117   000121 710000 2                  TRA     s:3801

      191     3800    2       WHENALTRETURN DO; ALTRETURN; END;

   3800  2 000120   000000 702200 xent               TSX2  ! X66_AALT

      192     3801    1       RETURN;

   3801  2 000121   000000 702200 xent               TSX2  ! X66_ARET

      193     3802        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:31   
      194     3803        /*D* NAME:         VDP$NEQUALS
      195     3804             PARAMETERS:   EQUALS_SPEC is a VD$NAME_SPEC describing
      196     3805                           the EQUALS name to equate.
      197     3806                           EQUALS_VALUE is a list of VD$BUFFERs containing the
      198     3807                           text(s) which EQUALS_NAME is to be EQUATEd to.
      199     3808                           WINDOW_SPEC is unused.
      200     3809             INPUT:        None.
      201     3810             OUTPUT:       VD$WINDOW_SPECs for selected windows updated.
      202     3811             DESCRIPTION:  Called from VDA$WRITERS when a write operation
      203     3812                           has been performed on the (internal) EQUALS file.
      204     3813                           Updates relevent WINDOW_SPECs for later VDP$NFLUSHing.
      205     3814        */
      206     3815    1   VDP$NEQUALS: ENTRY (KEY_NAME, SECOND_PARAMETER, WINDOW_SPEC) ALTRET;

   3815  2 000122   000000 700200 xent  VDP$NEQUALS  TSX0  ! X66_AUTO_3
         2 000123   000032 000003                    ZERO    26,3

      207     3816        /*          REALLY (EQUALS_SPEC, EQUALS_VALUE, nil)               */
      208     3817
      209     3818    1       ITS_A_NEQUALS = %TRUE;

   3818  2 000124   400000 236003                    LDQ     -131072,DU
         2 000125   200012 756100                    STQ     ITS_A_NEQUALS,,AUTO

      210     3819    1       ITS_A_DELETE = %FALSE;

   3819  2 000126   200011 450100                    STZ     ITS_A_DELETE,,AUTO

      211     3820
      212     3821    1   NCOMMON:
      213     3822    1       WINDOW$ = VD_6E.WINDOWS$ -> VD$STREAM.PORT$ ->

   3822  2 000127   000006 470400 xsym  NCOMMON      LDP0    VD_6E+6
         2 000130   000001 471500                    LDP1    1,,PR0
         2 000131   100031 473500                    LDP3    25,,PR1
         2 000132   300012 236100                    LDQ     10,,PR3
         2 000133   200015 756100                    STQ     WINDOW$,,AUTO
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:32   

      214     3823    1         VD$PORT.LEVEL.INTERNAL$ (%LVL_FILE) -> VD$FILE_NODE.HEAD$;
      215     3824
      216     3825    1   NWHATEVER_ALL_THE_WINDOWS:
      217     3826    2       DO WHILE (WINDOW$ ~= ADDR(NIL));

   3826  2 000134   000240 710000 2     NWHATEVER_A* TRA     s:3890

      218     3827
      219     3828    2         CURRENT_WINDOW$ = WINDOW$ -> VD$FILE_NODE.DESC.SPEC.V$;

   3828  2 000135   200015 470500                    LDP0    WINDOW$,,AUTO
         2 000136   000007 236100                    LDQ     7,,PR0
         2 000137   200007 756100                    STQ     CURRENT_WINDOW$,,AUTO

      220     3829
      221     3830    2         IF ITS_A_DELETE

   3830  2 000140   200011 234100                    SZN     ITS_A_DELETE,,AUTO
         2 000141   000222 604000 2                  TMI     DO_THE_WINDOW

      222     3831    2         THEN GOTO DO_THE_WINDOW;
      223     3832    2         ELSE
      224     3833    2   FIND_WINDOW_VALUE:
      225     3834    3           DO;

   3834  2 000142                       FIND_WINDOW* null
      226     3835                  /* First guess:  entry #0, for all windows */
      227     3836    3             WINDOW_SPECIFIC_VALUE$ = ADDR(WHATEVER_VALUE);

   3836  2 000142   200004 236100                    LDQ     @SECOND_PARAMETER,,AUTO
         2 000143   200020 756100                    STQ     WINDOW_SPECIFIC_VALUE$,,AUTO

      228     3837                  /* Is there an entry #1:  for all editing windows? */
      229     3838    3             NEW_WINDOW_SPECIFIC_VALUE$ = WHATEVER_VALUE.FLINK$;

   3838  2 000144   200004 471500                    LDP1    @SECOND_PARAMETER,,AUTO
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:33   
         2 000145   100001 236100                    LDQ     1,,PR1
         2 000146   200013 756100                    STQ     NEW_WINDOW_SPECIFIC_VALUE$,,AUTO

      230     3839    3             IF NEW_WINDOW_SPECIFIC_VALUE$ = ADDR(NIL) THEN

   3839  2 000147   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000150   000217 600000 2                  TZE     s:3875

      231     3840    3               EXIT FIND_WINDOW_VALUE;    /* Entry #0 is all there is */
      232     3841
      233     3842    3             IF NEW_WINDOW$SPECIFIC_VALUE.LENGTH# > 0

   3842  2 000151   200013 473500                    LDP3    NEW_WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000152   300002 220100                    LDX0    2,,PR3
         2 000153   000162 604400 2                  TMOZ    s:3856
         2 000154   200007 474500                    LDP4    CURRENT_WINDOW$,,AUTO
         2 000155   400002 236100                    LDQ     2,,PR4
         2 000156   000400 316003                    CANQ    256,DU
         2 000157   000162 601000 2                  TNZ     s:3856

      234     3843    3               AND NOT WINDOW$SPEC.COMMAND THEN
      235     3844    4               DO;

      236     3845                      /* Newest guess */
      237     3846    4                 WINDOW_SPECIFIC_VALUE$ = NEW_WINDOW_SPECIFIC_VALUE$;

   3846  2 000160   200013 236100                    LDQ     NEW_WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000161   200020 756100                    STQ     WINDOW_SPECIFIC_VALUE$,,AUTO

      238     3847    4               END;

      239     3848
      240     3849                  %GETKEY (KEY="WINDOW$->VD$FILE_NODE.DESC.KEY", PTR=WINDOW_NUMBER$);

   3856  2 000162   000004 721100                    LXL1    4,,PR0
         2 000163   000002 101003                    CMPX1   2,DU
         2 000164   000171 601000 2                  TNZ     s:3856+7
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:34   

   3856  2 000165   000005 474500                    LDP4    5,,PR0
         2 000166   400002 635500                    EPPR5   2,,PR4
         2 000167   200017 455500                    STP5    WINDOW_NUMBER$,,AUTO
         2 000170   000174 710000 2                  TRA     s:3861

   3856  2 000171   200015 236100                    LDQ     WINDOW$,,AUTO
         2 000172   000005 036003                    ADLQ    5,DU
         2 000173   200017 756100                    STQ     WINDOW_NUMBER$,,AUTO

      241     3859
      242     3860                  /* See if there's an entry for this window specifically */
      243     3861    4             DO WINDOW_INDEX = WINDOW$NUMBER.BYTES# DOWNTO 0;

   3861  2 000174   200017 474500                    LDP4    WINDOW_NUMBER$,,AUTO
         2 000175   400000 236100                    LDQ     0,,PR4
         2 000176   000032 376000 xsym               ANQ     B_VECTNIL+26
         2 000177   200016 756100                    STQ     WINDOW_INDEX,,AUTO
         2 000200   000210 710000 2                  TRA     s:3865+2

      244     3862    4               NEW_WINDOW_SPECIFIC_VALUE$ = NEW_WINDOW$SPECIFIC_VALUE.FLINK$;

   3862  2 000201   200013 470500                    LDP0    NEW_WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000202   000001 236100                    LDQ     1,,PR0
         2 000203   200013 756100                    STQ     NEW_WINDOW_SPECIFIC_VALUE$,,AUTO

      245     3863    4               IF NEW_WINDOW_SPECIFIC_VALUE$ = ADDR(NIL) THEN

   3863  2 000204   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000205   000217 600000 2                  TZE     s:3875

      246     3864    4                 EXIT FIND_WINDOW_VALUE; /* No value for this specific window */
      247     3865    4             END;

   3865  2 000206   000001 336007                    LCQ     1,DL
         2 000207   200016 056100                    ASQ     WINDOW_INDEX,,AUTO
         2 000210   200016 235100                    LDA     WINDOW_INDEX,,AUTO
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:35   
         2 000211   000201 605000 2                  TPL     s:3862

      248     3866
      249     3867    3             IF NEW_WINDOW$SPECIFIC_VALUE.LENGTH# > 0 THEN

   3867  2 000212   200013 470500                    LDP0    NEW_WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000213   000002 220100                    LDX0    2,,PR0
         2 000214   000217 604400 2                  TMOZ    s:3875

      250     3868    4               DO;

      251     3869                      /* Found it */
      252     3870    4                 WINDOW_SPECIFIC_VALUE$ = NEW_WINDOW_SPECIFIC_VALUE$;

   3870  2 000215   200013 236100                    LDQ     NEW_WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000216   200020 756100                    STQ     WINDOW_SPECIFIC_VALUE$,,AUTO

      253     3871    4               END;

      254     3872    3           END FIND_WINDOW_VALUE;

      255     3873
      256     3874              /* Did we find any entry we can use? */
      257     3875    2         IF WINDOW$SPECIFIC_VALUE.LENGTH# > 0 THEN

   3875  2 000217   200020 470500                    LDP0    WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000220   000002 220100                    LDX0    2,,PR0
         2 000221   000235 604400 2                  TMOZ    s:3888

      258     3876    2   DO_THE_WINDOW:
      259     3877    3           DO;

   3877  2 000222                       DO_THE_WIND* null
      260     3878    3             IF ITS_A_NEQUALS

   3878  2 000222   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000223   000231 605000 2                  TPL     s:3883
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:36   

      261     3879    3             THEN
      262     3880    3               CALL EQUATE_A_WINDOW

   3880  2 000224   000243 701000 2                  TSX1    EQUATE_A_WINDOW
         2 000225   000227 702000 2                  TSX2    s:3881
         2 000226   000230 710000 2                  TRA     s:3881+1

      263     3881    4               WHENALTRETURN DO; ALTRETURN; END;

   3881  2 000227   000000 702200 xent               TSX2  ! X66_AALT
         2 000230   000235 710000 2                  TRA     s:3888

      264     3882    3             ELSE
      265     3883    3               CALL IMP_A_WINDOW

   3883  2 000231   000760 701000 2                  TSX1    IMP_A_WINDOW
         2 000232   000234 702000 2                  TSX2    s:3884
         2 000233   000235 710000 2                  TRA     s:3888

      266     3884    4               WHENALTRETURN DO; ALTRETURN; END;

   3884  2 000234   000000 702200 xent               TSX2  ! X66_AALT

      267     3885    3           END DO_THE_WINDOW;

      268     3886
      269     3887              /* On to the next window */
      270     3888    2         WINDOW$ = WINDOW$ -> VD$FILE_NODE.FLINK$;

   3888  2 000235   200015 470500                    LDP0    WINDOW$,,AUTO
         2 000236   000002 236100                    LDQ     2,,PR0
         2 000237   200015 756100                    STQ     WINDOW$,,AUTO

      271     3889
      272     3890    2       END NWHATEVER_ALL_THE_WINDOWS;

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:37   
   3890  2 000240   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000241   000135 601000 2                  TNZ     s:3828

      273     3891
      274     3892    1       RETURN;

   3892  2 000242   000000 702200 xent               TSX2  ! X66_ARET

      275     3893
      276     3894        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:38   
      277     3895    1   EQUATE_A_WINDOW: PROC ALTRET;

   3895  2 000243   200022 741300       EQUATE_A_WI* STX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO

      278     3896
      279     3897    2       FOUND_INTRO = BINBIT(WINDOW$SPECIFIC_EQUALS_VALUE.V#, 1);

   3897  2 000244   200020 470500                    LDP0    WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000245   000003 236100                    LDQ     3,,PR0
         2 000246   000043 736000                    QLS     35
         2 000247   200010 756100                    STQ     FOUND_INTRO,,AUTO

      280     3898    3       DO CASE (ADDR(KEY_NAME) -> EQUALS_SPEC.WRITER#);

   3898  2 000250   200003 471500                    LDP1    @KEY_NAME,,AUTO
         2 000251   100006 236100                    LDQ     6,,PR1
         2 000252   777777 376007                    ANQ     -1,DL
         2 000253   000006 136007                    SBLQ    6,DL
         2 000254   000065 116007                    CMPQ    53,DL
         2 000255   000257 602006 2                  TNC     s:3898+7,QL
         2 000256   000753 710000 2                  TRA     s:3998
         2 000257   000524 710000 2                  TRA     s:3941
         2 000260   000753 710000 2                  TRA     s:3998
         2 000261   000753 710000 2                  TRA     s:3998
         2 000262   000753 710000 2                  TRA     s:3998
         2 000263   000753 710000 2                  TRA     s:3998
         2 000264   000753 710000 2                  TRA     s:3998
         2 000265   000753 710000 2                  TRA     s:3998
         2 000266   000753 710000 2                  TRA     s:3998
         2 000267   000753 710000 2                  TRA     s:3998
         2 000270   000753 710000 2                  TRA     s:3998
         2 000271   000753 710000 2                  TRA     s:3998
         2 000272   000753 710000 2                  TRA     s:3998
         2 000273   000753 710000 2                  TRA     s:3998
         2 000274   000541 710000 2                  TRA     s:3946
         2 000275   000555 710000 2                  TRA     s:3951
         2 000276   000572 710000 2                  TRA     s:3956
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:39   
         2 000277   000644 710000 2                  TRA     s:3972
         2 000300   000661 710000 2                  TRA     s:3976
         2 000301   000344 710000 2                  TRA     s:3901
         2 000302   000753 710000 2                  TRA     s:3998
         2 000303   000753 710000 2                  TRA     s:3998
         2 000304   000753 710000 2                  TRA     s:3998
         2 000305   000753 710000 2                  TRA     s:3998
         2 000306   000753 710000 2                  TRA     s:3998
         2 000307   000753 710000 2                  TRA     s:3998
         2 000310   000753 710000 2                  TRA     s:3998
         2 000311   000753 710000 2                  TRA     s:3998
         2 000312   000753 710000 2                  TRA     s:3998
         2 000313   000753 710000 2                  TRA     s:3998
         2 000314   000753 710000 2                  TRA     s:3998
         2 000315   000360 710000 2                  TRA     s:3906
         2 000316   000753 710000 2                  TRA     s:3998
         2 000317   000753 710000 2                  TRA     s:3998
         2 000320   000753 710000 2                  TRA     s:3998
         2 000321   000753 710000 2                  TRA     s:3998
         2 000322   000753 710000 2                  TRA     s:3998
         2 000323   000753 710000 2                  TRA     s:3998
         2 000324   000753 710000 2                  TRA     s:3998
         2 000325   000377 710000 2                  TRA     s:3911
         2 000326   000414 710000 2                  TRA     s:3916
         2 000327   000753 710000 2                  TRA     s:3998
         2 000330   000753 710000 2                  TRA     s:3998
         2 000331   000630 710000 2                  TRA     s:3966
         2 000332   000753 710000 2                  TRA     s:3998
         2 000333   000753 710000 2                  TRA     s:3998
         2 000334   000447 710000 2                  TRA     s:3926
         2 000335   000505 710000 2                  TRA     s:3936
         2 000336   000430 710000 2                  TRA     s:3921
         2 000337   000611 710000 2                  TRA     s:3961
         2 000340   000676 710000 2                  TRA     s:3982
         2 000341   000753 710000 2                  TRA     s:3998
         2 000342   000753 710000 2                  TRA     s:3998
         2 000343   000466 710000 2                  TRA     s:3931
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:40   

      281     3899
      282     3900    3         CASE (%WRTR_$KEY_GENERATION);

      283     3901    3           IF WINDOW$SPEC.EDTCTL.KEY_GENERATION# = WINDOW$SPECIFIC_EQUALS_VALUE.V#

   3901  2 000344   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000345   300022 236100                    LDQ     18,,PR3
         2 000346   000022 732000                    QRS     18
         2 000347   000003 116100                    CMPQ    3,,PR0
         2 000350   000353 601000 2                  TNZ     s:3903
         2 000351   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000352   000756 604000 2                  TMI     s:4002

      284     3902    3             AND ITS_A_NEQUALS THEN EXIT;
      285     3903    3           WINDOW$SPEC.EDTCTL.KEY_GENERATION# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;

   3903  2 000353   000003 720100                    LXL0    3,,PR0
         2 000354   300022 740100                    STX0    18,,PR3

      286     3904    3           WINDOW$SPEC.EDTCTL.FLUSH.KEY_GENERATION = %TRUE;

   3904  2 000355   400000 236007                    LDQ     -131072,DL
         2 000356   300021 256100                    ORSQ    17,,PR3
         2 000357   000756 710000 2                  TRA     s:4002

      287     3905    3         CASE (%WRTR_$RECORDWRAP);

      288     3906    3           IF WINDOW$SPEC.EDTCTL.RECORDWRAP = FOUND_INTRO

   3906  2 000360   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000361   000100 066500                    CMPB    filb='0'B
         2 000362   300021 650001                    BDSC    17,,PR3                  by=3,bit=5,n=1
         2 000363   200010 000001                    BDSC    FOUND_INTRO,,AUTO        by=0,bit=0,n=1
         2 000364   000367 601000 2                  TNZ     s:3908
         2 000365   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000366   000756 604000 2                  TMI     s:4002
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:41   

      289     3907    3             AND ITS_A_NEQUALS THEN EXIT;
      290     3908    3           WINDOW$SPEC.EDTCTL.RECORDWRAP = FOUND_INTRO;

   3908  2 000367   200010 236100                    LDQ     FOUND_INTRO,,AUTO
         2 000370   000040 772000                    QRL     32
         2 000371   300021 676100                    ERQ     17,,PR3
         2 000372   000010 376007                    ANQ     8,DL
         2 000373   300021 656100                    ERSQ    17,,PR3

      291     3909    3           WINDOW$SPEC.EDTCTL.FLUSH.RECWRAP = %TRUE;

   3909  2 000374   200000 236007                    LDQ     65536,DL
         2 000375   300021 256100                    ORSQ    17,,PR3
         2 000376   000756 710000 2                  TRA     s:4002

      292     3910    3         CASE (%WRTR_$VSCROLL);

      293     3911    3           IF WINDOW$SPEC.EDTCTL.VSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#

   3911  2 000377   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000400   300022 236100                    LDQ     18,,PR3
         2 000401   000022 736000                    QLS     18
         2 000402   000022 732000                    QRS     18
         2 000403   000003 116100                    CMPQ    3,,PR0
         2 000404   000407 601000 2                  TNZ     s:3913
         2 000405   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000406   000756 604000 2                  TMI     s:4002

      294     3912    3             AND ITS_A_NEQUALS THEN EXIT;
      295     3913    3           WINDOW$SPEC.EDTCTL.VSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;

   3913  2 000407   000003 720100                    LXL0    3,,PR0
         2 000410   300022 440100                    SXL0    18,,PR3

      296     3914    3           WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL = %TRUE;

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:42   
   3914  2 000411   100000 236007                    LDQ     32768,DL
         2 000412   300021 256100                    ORSQ    17,,PR3
         2 000413   000756 710000 2                  TRA     s:4002

      297     3915    3         CASE (%WRTR_$VSCROLL_MARGIN);

      298     3916    3           IF WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#

   3916  2 000414   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000415   300023 236100                    LDQ     19,,PR3
         2 000416   000022 732000                    QRS     18
         2 000417   000003 116100                    CMPQ    3,,PR0
         2 000420   000423 601000 2                  TNZ     s:3918
         2 000421   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000422   000756 604000 2                  TMI     s:4002

      299     3917    3             AND ITS_A_NEQUALS THEN EXIT;
      300     3918    3           WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;

   3918  2 000423   000003 720100                    LXL0    3,,PR0
         2 000424   300023 740100                    STX0    19,,PR3

      301     3919    3           WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL_MARGIN = %TRUE;

   3919  2 000425   040000 236007                    LDQ     16384,DL
         2 000426   300021 256100                    ORSQ    17,,PR3
         2 000427   000756 710000 2                  TRA     s:4002

      302     3920    3         CASE (%WRTR_$EZ_APPEND);

      303     3921    3           IF WINDOW$SPEC.EDTCTL.EZAPPEND# = FOUND_INTRO

   3921  2 000430   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000431   000100 066500                    CMPB    filb='0'B
         2 000432   300021 700001                    BDSC    17,,PR3                  by=3,bit=8,n=1
         2 000433   200010 000001                    BDSC    FOUND_INTRO,,AUTO        by=0,bit=0,n=1
         2 000434   000437 601000 2                  TNZ     s:3923
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:43   
         2 000435   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000436   000756 604000 2                  TMI     s:4002

      304     3922    3             AND ITS_A_NEQUALS THEN EXIT;
      305     3923    3           WINDOW$SPEC.EDTCTL.EZAPPEND# = FOUND_INTRO;

   3923  2 000437   200010 236100                    LDQ     FOUND_INTRO,,AUTO
         2 000440   000043 772000                    QRL     35
         2 000441   300021 676100                    ERQ     17,,PR3
         2 000442   000001 376007                    ANQ     1,DL
         2 000443   300021 656100                    ERSQ    17,,PR3

      306     3924    3           WINDOW$SPEC.EDTCTL.FLUSH.EZAPPEND = %TRUE;

   3924  2 000444   004000 236007                    LDQ     2048,DL
         2 000445   300021 256100                    ORSQ    17,,PR3
         2 000446   000756 710000 2                  TRA     s:4002

      307     3925    3         CASE (%WRTR_$HSALL);

      308     3926    3           IF WINDOW$SPEC.EDTCTL.HSALL# = FOUND_INTRO

   3926  2 000447   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000450   000100 066500                    CMPB    filb='0'B
         2 000451   300021 660001                    BDSC    17,,PR3                  by=3,bit=6,n=1
         2 000452   200010 000001                    BDSC    FOUND_INTRO,,AUTO        by=0,bit=0,n=1
         2 000453   000456 601000 2                  TNZ     s:3928
         2 000454   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000455   000756 604000 2                  TMI     s:4002

      309     3927    3             AND ITS_A_NEQUALS THEN EXIT;
      310     3928    3           WINDOW$SPEC.EDTCTL.HSALL# = FOUND_INTRO;

   3928  2 000456   200010 236100                    LDQ     FOUND_INTRO,,AUTO
         2 000457   000041 772000                    QRL     33
         2 000460   300021 676100                    ERQ     17,,PR3
         2 000461   000004 376007                    ANQ     4,DL
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:44   
         2 000462   300021 656100                    ERSQ    17,,PR3

      311     3929    3           WINDOW$SPEC.EDTCTL.FLUSH.HSALL = %TRUE;

   3929  2 000463   020000 236007                    LDQ     8192,DL
         2 000464   300021 256100                    ORSQ    17,,PR3
         2 000465   000756 710000 2                  TRA     s:4002

      312     3930    3         CASE (%WRTR_$ONESPACEEDIT);

      313     3931    3           IF WINDOW$SPEC.EDTCTL.ONESPACEEDIT# = FOUND_INTRO

   3931  2 000466   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000467   000100 066500                    CMPB    filb='0'B
         2 000470   300021 630001                    BDSC    17,,PR3                  by=3,bit=3,n=1
         2 000471   200010 000001                    BDSC    FOUND_INTRO,,AUTO        by=0,bit=0,n=1
         2 000472   000475 601000 2                  TNZ     s:3933
         2 000473   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000474   000756 604000 2                  TMI     s:4002

      314     3932    3             AND ITS_A_NEQUALS THEN EXIT;
      315     3933    3           WINDOW$SPEC.EDTCTL.ONESPACEEDIT# = FOUND_INTRO;

   3933  2 000475   200010 236100                    LDQ     FOUND_INTRO,,AUTO
         2 000476   000036 772000                    QRL     30
         2 000477   300021 676100                    ERQ     17,,PR3
         2 000500   000040 376007                    ANQ     32,DL
         2 000501   300021 656100                    ERSQ    17,,PR3

      316     3934    3           WINDOW$SPEC.EDTCTL.FLUSH.ONESPACEEDIT = %TRUE;

   3934  2 000502   000400 236007                    LDQ     256,DL
         2 000503   300021 256100                    ORSQ    17,,PR3
         2 000504   000756 710000 2                  TRA     s:4002

      317     3935    3         CASE (%WRTR_$TEXTEDIT);

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:45   
      318     3936    3           IF WINDOW$SPEC.EDTCTL.TEXTEDIT# = FOUND_INTRO

   3936  2 000505   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000506   000100 066500                    CMPB    filb='0'B
         2 000507   300021 670001                    BDSC    17,,PR3                  by=3,bit=7,n=1
         2 000510   200010 000001                    BDSC    FOUND_INTRO,,AUTO        by=0,bit=0,n=1
         2 000511   000514 601000 2                  TNZ     s:3938
         2 000512   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000513   000756 604000 2                  TMI     s:4002

      319     3937    3             AND ITS_A_NEQUALS THEN EXIT;
      320     3938    3           WINDOW$SPEC.EDTCTL.TEXTEDIT# = FOUND_INTRO;

   3938  2 000514   200010 236100                    LDQ     FOUND_INTRO,,AUTO
         2 000515   000042 772000                    QRL     34
         2 000516   300021 676100                    ERQ     17,,PR3
         2 000517   000002 376007                    ANQ     2,DL
         2 000520   300021 656100                    ERSQ    17,,PR3

      321     3939    3           WINDOW$SPEC.EDTCTL.FLUSH.TEXTEDIT = %TRUE;

   3939  2 000521   010000 236007                    LDQ     4096,DL
         2 000522   300021 256100                    ORSQ    17,,PR3
         2 000523   000756 710000 2                  TRA     s:4002

      322     3940    3         CASE (%WRTR_$AUTOTAB);

      323     3941    3           IF WINDOW$SPEC.TRMCTL.AUTOTAB# = WINDOW$SPECIFIC_EQUALS_VALUE.V#

   3941  2 000524   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000525   300017 236100                    LDQ     15,,PR3
         2 000526   000022 736000                    QLS     18
         2 000527   000022 732000                    QRS     18
         2 000530   000003 116100                    CMPQ    3,,PR0
         2 000531   000534 601000 2                  TNZ     s:3943
         2 000532   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000533   000756 604000 2                  TMI     s:4002
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:46   

      324     3942    3             AND ITS_A_NEQUALS THEN EXIT;
      325     3943    3           WINDOW$SPEC.TRMCTL.AUTOTAB# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;

   3943  2 000534   000003 720100                    LXL0    3,,PR0
         2 000535   300017 440100                    SXL0    15,,PR3

      326     3944    3           WINDOW$SPEC.TRMCTL.FLUSH.AUTOTAB = %TRUE;

   3944  2 000536   400000 236003                    LDQ     -131072,DU
         2 000537   300017 256100                    ORSQ    15,,PR3
         2 000540   000756 710000 2                  TRA     s:4002

      327     3945    3         CASE (%WRTR_$HSCROLL);

      328     3946    3           IF WINDOW$SPEC.TRMCTL.HSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#

   3946  2 000541   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000542   300020 236100                    LDQ     16,,PR3
         2 000543   000022 732000                    QRS     18
         2 000544   000003 116100                    CMPQ    3,,PR0
         2 000545   000550 601000 2                  TNZ     s:3948
         2 000546   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000547   000756 604000 2                  TMI     s:4002

      329     3947    3             AND ITS_A_NEQUALS THEN EXIT;
      330     3948    3           WINDOW$SPEC.TRMCTL.HSCROLL# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;

   3948  2 000550   000003 720100                    LXL0    3,,PR0
         2 000551   300020 740100                    STX0    16,,PR3

      331     3949    3           WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL = %TRUE;

   3949  2 000552   200000 236003                    LDQ     65536,DU
         2 000553   300017 256100                    ORSQ    15,,PR3
         2 000554   000756 710000 2                  TRA     s:4002

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:47   
      332     3950    3         CASE (%WRTR_$HSCROLL_MARGIN);

      333     3951    3           IF WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#

   3951  2 000555   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000556   300020 236100                    LDQ     16,,PR3
         2 000557   000022 736000                    QLS     18
         2 000560   000022 732000                    QRS     18
         2 000561   000003 116100                    CMPQ    3,,PR0
         2 000562   000565 601000 2                  TNZ     s:3953
         2 000563   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000564   000756 604000 2                  TMI     s:4002

      334     3952    3             AND ITS_A_NEQUALS THEN EXIT;
      335     3953    3           WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;

   3953  2 000565   000003 720100                    LXL0    3,,PR0
         2 000566   300020 440100                    SXL0    16,,PR3

      336     3954    3           WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL_MARGIN = %TRUE;

   3954  2 000567   100000 236003                    LDQ     32768,DU
         2 000570   300017 256100                    ORSQ    15,,PR3
         2 000571   000756 710000 2                  TRA     s:4002

      337     3955    3         CASE (%WRTR_$INSERT);

      338     3956    3           IF WINDOW$SPEC.TRMCTL.INSERT_MODE = FOUND_INTRO

   3956  2 000572   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000573   000100 066500                    CMPB    filb='0'B
         2 000574   300017 270001                    BDSC    15,,PR3                  by=1,bit=7,n=1
         2 000575   200010 000001                    BDSC    FOUND_INTRO,,AUTO        by=0,bit=0,n=1
         2 000576   000601 601000 2                  TNZ     s:3958
         2 000577   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000600   000756 604000 2                  TMI     s:4002

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:48   
      339     3957    3             AND ITS_A_NEQUALS THEN EXIT;
      340     3958    3           WINDOW$SPEC.TRMCTL.INSERT_MODE = FOUND_INTRO;

   3958  2 000601   200010 236100                    LDQ     FOUND_INTRO,,AUTO
         2 000602   000020 772000                    QRL     16
         2 000603   300017 676100                    ERQ     15,,PR3
         2 000604   000002 376003                    ANQ     2,DU
         2 000605   300017 656100                    ERSQ    15,,PR3

      341     3959    3           WINDOW$SPEC.TRMCTL.FLUSH.INSERT_MODE = %TRUE;

   3959  2 000606   040000 236003                    LDQ     16384,DU
         2 000607   300017 256100                    ORSQ    15,,PR3
         2 000610   000756 710000 2                  TRA     s:4002

      342     3960    3         CASE (%WRTR_$SCROLL);

      343     3961    3           IF WINDOW$SPEC.TRMCTL.SCROLL# = FOUND_INTRO

   3961  2 000611   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000612   000100 066500                    CMPB    filb='0'B
         2 000613   300017 300001                    BDSC    15,,PR3                  by=1,bit=8,n=1
         2 000614   200010 000001                    BDSC    FOUND_INTRO,,AUTO        by=0,bit=0,n=1
         2 000615   000620 601000 2                  TNZ     s:3963
         2 000616   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000617   000756 604000 2                  TMI     s:4002

      344     3962    3             AND ITS_A_NEQUALS THEN EXIT;
      345     3963    3           WINDOW$SPEC.TRMCTL.SCROLL# = FOUND_INTRO;

   3963  2 000620   200010 236100                    LDQ     FOUND_INTRO,,AUTO
         2 000621   000021 772000                    QRL     17
         2 000622   300017 676100                    ERQ     15,,PR3
         2 000623   000001 376003                    ANQ     1,DU
         2 000624   300017 656100                    ERSQ    15,,PR3

      346     3964    3           WINDOW$SPEC.TRMCTL.FLUSH.SCROLL = %TRUE;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:49   

   3964  2 000625   020000 236003                    LDQ     8192,DU
         2 000626   300017 256100                    ORSQ    15,,PR3
         2 000627   000756 710000 2                  TRA     s:4002

      347     3965    3         CASE (%WRTR_$WORDWRAP);

      348     3966    3           IF WINDOW$SPEC.TRMCTL.WORDWRAP# = WINDOW$SPECIFIC_EQUALS_VALUE.V#

   3966  2 000630   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000631   300021 236100                    LDQ     17,,PR3
         2 000632   000022 732000                    QRS     18
         2 000633   000003 116100                    CMPQ    3,,PR0
         2 000634   000637 601000 2                  TNZ     s:3968
         2 000635   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000636   000756 604000 2                  TMI     s:4002

      349     3967    3             AND ITS_A_NEQUALS THEN EXIT;
      350     3968    3           WINDOW$SPEC.TRMCTL.WORDWRAP# = WINDOW$SPECIFIC_EQUALS_VALUE.V#;

   3968  2 000637   000003 720100                    LXL0    3,,PR0
         2 000640   300021 740100                    STX0    17,,PR3

      351     3969    3           WINDOW$SPEC.TRMCTL.FLUSH.WORDWRAP = %TRUE;

   3969  2 000641   010000 236003                    LDQ     4096,DU
         2 000642   300017 256100                    ORSQ    15,,PR3
         2 000643   000756 710000 2                  TRA     s:4002

      352     3970
      353     3971    3         CASE (%WRTR_$INTRO_1);

      354     3972    3           WINDOW$SPEC.INTRO_1.LENGTH# = MINIMUM(%MXNB_$INTRO,

   3972  2 000644   000002 236100                    LDQ     2,,PR0
         2 000645   000022 732000                    QRS     18
         2 000646   000002 116007                    CMPQ    2,DL
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:50   
         2 000647   000651 604400 2                  TMOZ    s:3972+5
         2 000650   000002 236007                    LDQ     2,DL
         2 000651   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000652   000033 736000                    QLS     27
         2 000653   300026 552140                    STBQ    22,'40'O,PR3

      355     3973    3             WINDOW$SPECIFIC_VALUE.LENGTH#);
      356     3974    3           WINDOW$SPEC.INTRO_1.BYTES = WINDOW$SPECIFIC_VALUE.BYTES;

   3974  2 000654   000002 220100                    LDX0    2,,PR0
         2 000655   040100 100540                    MLR     fill='040'O
         2 000656   000002 400010                    ADSC9   2,,PR0                   cn=2,n=*X0
         2 000657   300026 200002                    ADSC9   22,,PR3                  cn=1,n=2
         2 000660   000756 710000 2                  TRA     s:4002

      357     3975    3         CASE (%WRTR_$INTRO_2);

      358     3976    3           WINDOW$SPEC.INTRO_2.LENGTH# = MINIMUM(%MXNB_$INTRO,

   3976  2 000661   000002 236100                    LDQ     2,,PR0
         2 000662   000022 732000                    QRS     18
         2 000663   000002 116007                    CMPQ    2,DL
         2 000664   000666 604400 2                  TMOZ    s:3976+5
         2 000665   000002 236007                    LDQ     2,DL
         2 000666   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000667   000033 736000                    QLS     27
         2 000670   300027 552140                    STBQ    23,'40'O,PR3

      359     3977    3             WINDOW$SPECIFIC_VALUE.LENGTH#);
      360     3978    3           WINDOW$SPEC.INTRO_2.BYTES = WINDOW$SPECIFIC_VALUE.BYTES;

   3978  2 000671   000002 220100                    LDX0    2,,PR0
         2 000672   040100 100540                    MLR     fill='040'O
         2 000673   000002 400010                    ADSC9   2,,PR0                   cn=2,n=*X0
         2 000674   300027 200002                    ADSC9   23,,PR3                  cn=1,n=2
         2 000675   000756 710000 2                  TRA     s:4002

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:51   
      361     3979
      362     3980              /*N* Tabs36719 */
      363     3981    3         CASE (%WRTR_$EOF_MARK);

      364     3982    4           IF WINDOW$SPEC.EOFMARK$ = ADDR(NIL) THEN DO;

   3982  2 000676   200007 473500                    LDP3    CURRENT_WINDOW$,,AUTO
         2 000677   300025 236100                    LDQ     21,,PR3
         2 000700   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000701   000726 601000 2                  TNZ     s:3989

      365     3983    4               IF WINDOW$SPECIFIC_VALUE.LENGTH# = 0 THEN RETURN;

   3983  2 000702   000002 220100                    LDX0    2,,PR0
         2 000703   000705 601000 2                  TNZ     s:3984

   3983  2 000704   000001 702211                    TSX2  ! 1,X1

      366     3984    4               CALL VDG$OALLOC (%CLS_BUFFER, WINDOW$SPEC.EOFMARK$,

   3984  2 000705   000001 236000 3                  LDQ     1
         2 000706   200030 756100                    STQ     MY_KEY_NAME+5,,AUTO
         2 000707   200007 236100                    LDQ     CURRENT_WINDOW$,,AUTO
         2 000710   000025 036003                    ADLQ    21,DU
         2 000711   000002 235000 3                  LDA     2
         2 000712   200026 757100                    STAQ    MY_KEY_NAME+3,,AUTO
         2 000713   200026 630500                    EPPR0   MY_KEY_NAME+3,,AUTO
         2 000714   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000715   000000 701000 xent               TSX1    VDG$OALLOC
         2 000716   000720 702000 2                  TSX2    s:3986
         2 000717   000722 710000 2                  TRA     s:3987

      367     3985    4                 (%MXNB_$EOF_MARK+SIZEC(VD$BUFFER_HEADER)) / %NB_PER_WORD)
      368     3986    5               WHENALTRETURN DO; ALTRETURN; END;

   3986  2 000720   200022 221300                    LDX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO
         2 000721   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:52   

      369     3987    4               WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.LENGTH# = 0;

   3987  2 000722   200007 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         2 000723   000025 471500                    LDP1    21,,PR0
         2 000724   000000 220003                    LDX0    0,DU
         2 000725   100002 740100                    STX0    2,,PR1

      370     3988    4             END;

      371     3989    3           IF WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.BYTES =

   3989  2 000726   200007 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         2 000727   000025 471500                    LDP1    21,,PR0
         2 000730   100002 220100                    LDX0    2,,PR1
         2 000731   200020 473500                    LDP3    WINDOW_SPECIFIC_VALUE$,,AUTO
         2 000732   300002 221100                    LDX1    2,,PR3
         2 000733   040140 106540                    CMPC    fill='040'O
         2 000734   100002 400010                    ADSC9   2,,PR1                   cn=2,n=*X0
         2 000735   300002 400011                    ADSC9   2,,PR3                   cn=2,n=*X1
         2 000736   000741 601000 2                  TNZ     s:3992
         2 000737   200012 234100                    SZN     ITS_A_NEQUALS,,AUTO
         2 000740   000756 604000 2                  TMI     s:4002

      372     3990    3             WINDOW$SPECIFIC_VALUE.BYTES
      373     3991    3             AND ITS_A_NEQUALS THEN EXIT;
      374     3992    3           WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.LENGTH# =

   3992  2 000741   100002 741100                    STX1    2,,PR1

      375     3993    3             WINDOW$SPECIFIC_VALUE.LENGTH#;
      376     3994    3           WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.BYTES =

   3994  2 000742   000025 471500                    LDP1    21,,PR0
         2 000743   100002 220100                    LDX0    2,,PR1
         2 000744   300002 221100                    LDX1    2,,PR3
         2 000745   040140 100540                    MLR     fill='040'O
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:53   
         2 000746   300002 400011                    ADSC9   2,,PR3                   cn=2,n=*X1
         2 000747   100002 400010                    ADSC9   2,,PR1                   cn=2,n=*X0

      377     3995    3             WINDOW$SPECIFIC_VALUE.BYTES;
      378     3996    3           WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK = %TRUE;

   3996  2 000750   002000 236007                    LDQ     1024,DL
         2 000751   000021 256100                    ORSQ    17,,PR0
         2 000752   000756 710000 2                  TRA     s:4002

      379     3997    3         CASE (ELSE);

      380     3998    3           CALL VDG$ESCREECH;

   3998  2 000753   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000754   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000755   000000 011000                    NOP     0

      381     3999
      382     4000    3       END;

      383     4001
      384     4002    2       RETURN;

   4002  2 000756   200022 221300                    LDX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO
         2 000757   000001 702211                    TSX2  ! 1,X1

      385     4003
      386     4004    2   END EQUATE_A_WINDOW;
      387     4005        %EJECT;
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:54   
      388     4006    1   IMP_A_WINDOW: PROC ALTRET;

   4006  2 000760   200022 741300       IMP_A_WINDOW STX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO

      389     4007
      390     4008    2     DCL 1 MY_KEY_NAME,
      391     4009    2           2 LENGTH# UBIN BYTE CALIGNED,
      392     4010    2           2 BYTES CHAR(7),
      393     4011    2           2 UBYTES(0:6) REDEF BYTES UBIN BYTE CALIGNED;
      394     4012
      395     4013    2       IF ADDR(KEY_NAME)=ADDR(NIL) THEN CALL VDG$ESCREECH;

   4013  2 000761   200003 236100                    LDQ     @KEY_NAME,,AUTO
         2 000762   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000763   000767 601000 2                  TNZ     s:4014

   4013  2 000764   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000765   000000 701000 xent               TSX1    VDG$ESCREECH
         2 000766   000000 011000                    NOP     0

      396     4014    2       XUI_IMP_FLG.F = '0'B;

   4014  2 000767   000000 220003                    LDX0    0,DU
         2 000770   000005 740000 1                  STX0    XUI_IMP+5

      397     4015    2       XUI_IMP.KEY_NAME$ = ADDR(MY_KEY_NAME);

   4015  2 000771   200023 630500                    EPPR0   MY_KEY_NAME,,AUTO
         2 000772   000003 450400 1                  STP0    XUI_IMP+3

      398     4016    2       MY_KEY_NAME.BYTES = SUBSTR(KEY_NAME.BYTES,0,4);

   4016  2 000773   200003 471500                    LDP1    @KEY_NAME,,AUTO
         2 000774   100000 236100                    LDQ     0,,PR1
         2 000775   000033 772000                    QRL     27
         2 000776   040100 100500                    MLR     fill='040'O
         2 000777   100000 200004                    ADSC9   0,,PR1                   cn=1,n=4
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:55   
         2 001000   200023 200007                    ADSC9   MY_KEY_NAME,,AUTO        cn=1,n=7

      399     4017    2       IF MY_KEY_NAME.UBYTES(0) = 511

   4017  2 001001   200023 236100                    LDQ     MY_KEY_NAME,,AUTO
         2 001002   000777 376003                    ANQ     511,DU
         2 001003   000777 116003                    CMPQ    511,DU
         2 001004   001024 601000 2                  TNZ     s:4027

      400     4018    2       THEN
      401     4019    3         DO; /* We have an escape sequence, see what it means */

      402     4020    3           MY_KEY_NAME.BYTES = SUBSTR(MY_KEY_NAME.BYTES,1);

   4020  2 001005   040100 100500                    MLR     fill='040'O
         2 001006   200023 400006                    ADSC9   MY_KEY_NAME,,AUTO        cn=2,n=6
         2 001007   200023 200007                    ADSC9   MY_KEY_NAME,,AUTO        cn=1,n=7

      403     4021    3           IF MY_KEY_NAME.UBYTES(0) ~= 511

   4021  2 001010   200023 236100                    LDQ     MY_KEY_NAME,,AUTO
         2 001011   000777 376003                    ANQ     511,DU
         2 001012   000777 116003                    CMPQ    511,DU
         2 001013   001016 600000 2                  TZE     s:4024

      404     4022    3           THEN
      405     4023    3             XUI_IMP.CTRSTR# = %TRUE;

   4023  2 001014   020000 236003                    LDQ     8192,DU
         2 001015   000005 256000 1                  ORSQ    XUI_IMP+5

      406     4024    3           MY_KEY_NAME.LENGTH# = KEY_NAME.LENGTH#-1;

   4024  2 001016   100000 236100                    LDQ     0,,PR1
         2 001017   000033 772000                    QRL     27
         2 001020   000001 136007                    SBLQ    1,DL
         2 001021   000033 736000                    QLS     27
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:56   
         2 001022   200023 552140                    STBQ    MY_KEY_NAME,'40'O,AUTO

      407     4025    3         END;

   4025  2 001023   001026 710000 2                  TRA     s:4028

      408     4026    2       ELSE
      409     4027    2         MY_KEY_NAME.LENGTH# = KEY_NAME.LENGTH#;

   4027  2 001024   100000 236100                    LDQ     0,,PR1
         2 001025   200023 552140                    STBQ    MY_KEY_NAME,'40'O,AUTO

      410     4028    2       IF MY_KEY_NAME.UBYTES(0)>255

   4028  2 001026   200023 236100                    LDQ     MY_KEY_NAME,,AUTO
         2 001027   000777 376003                    ANQ     511,DU
         2 001030   000400 116003                    CMPQ    256,DU
         2 001031   001034 602000 2                  TNC     s:4036

      411     4029    2       THEN
      412     4030    2         XUI_IMP.FNCKEY# = %TRUE;

   4030  2 001032   010000 236003                    LDQ     4096,DU
         2 001033   000005 256000 1                  ORSQ    XUI_IMP+5

      413     4031
      414     4032        /*N*IF ADDR(INPUT) ~= ADDR(NIL)      *N*/
      415     4033        /*N*THEN                             *N*/
      416     4034        /*N*  XUI_IMP.INPUT_OPTION# = INPUT; *N*/
      417     4035
      418     4036    3       DO CASE (MY_KEY_NAME.LENGTH#);

   4036  2 001034   200023 236100                    LDQ     MY_KEY_NAME,,AUTO
         2 001035   000033 772000                    QRL     27
         2 001036   000004 116007                    CMPQ    4,DL
         2 001037   001041 602006 2                  TNC     s:4036+5,QL
         2 001040   001101 710000 2                  TRA     s:4053
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:57   
         2 001041   001101 710000 2                  TRA     s:4053
         2 001042   001104 710000 2                  TRA     s:4057
         2 001043   001045 710000 2                  TRA     s:4041
         2 001044   001045 710000 2                  TRA     s:4041

      419     4037
      420     4038    3         CASE (1);

      421     4039
      422     4040    3         CASE (2, 3);

      423     4041    3           IF VD_$INTRO_1.LENGTH# > 0

   4041  2 001045   000002 221000 xsym               LDX1    VD_$INTRO_1+2
         2 001046   001061 604400 2                  TMOZ    s:4045
         2 001047   100000 236100                    LDQ     0,,PR1
         2 001050   000033 772000                    QRL     27
         2 001051   777777 622006                    EAX2    -1,QL
         2 001052   040140 106440                    CMPC    fill='040'O
         2 001053   000002 400011 xsym               ADSC9   VD_$INTRO_1+2            cn=2,n=*X1
         2 001054   100000 200012                    ADSC9   0,,PR1                   cn=1,n=*X2
         2 001055   001061 601000 2                  TNZ     s:4045

      424     4042    3             AND VD_$INTRO_1.BYTES = SUBSTR(KEY_NAME.BYTES, 0, KEY_NAME.LENGTH#-1)
      425     4043    3           THEN
      426     4044    3             XUI_IMP.PRIMARY# = %TRUE;

   4044  2 001056   400000 236003                    LDQ     -131072,DU
         2 001057   000005 256000 1                  ORSQ    XUI_IMP+5
         2 001060   001104 710000 2                  TRA     s:4057

      427     4045    3           ELSE IF VD_$INTRO_2.LENGTH# > 0

   4045  2 001061   000002 222000 xsym               LDX2    VD_$INTRO_2+2
         2 001062   001075 604400 2                  TMOZ    s:4050
         2 001063   100000 236100                    LDQ     0,,PR1
         2 001064   000033 772000                    QRL     27
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:58   
         2 001065   777777 623006                    EAX3    -1,QL
         2 001066   040140 106440                    CMPC    fill='040'O
         2 001067   000002 400012 xsym               ADSC9   VD_$INTRO_2+2            cn=2,n=*X2
         2 001070   100000 200013                    ADSC9   0,,PR1                   cn=1,n=*X3
         2 001071   001075 601000 2                  TNZ     s:4050

      428     4046    3               AND VD_$INTRO_2.BYTES = SUBSTR(KEY_NAME.BYTES, 0, KEY_NAME.LENGTH#-1)
      429     4047    3             THEN
      430     4048    3               XUI_IMP.SECONDARY# = %TRUE;

   4048  2 001072   200000 236003                    LDQ     65536,DU
         2 001073   000005 256000 1                  ORSQ    XUI_IMP+5
         2 001074   001104 710000 2                  TRA     s:4057

      431     4049    3             ELSE
      432     4050    3               CALL VDG$ESCREECH;

   4050  2 001075   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001076   000000 701000 xent               TSX1    VDG$ESCREECH
         2 001077   000000 011000                    NOP     0
         2 001100   001104 710000 2                  TRA     s:4057

      433     4051
      434     4052    3         CASE (ELSE);

      435     4053    3           CALL VDG$ESCREECH;

   4053  2 001101   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001102   000000 701000 xent               TSX1    VDG$ESCREECH
         2 001103   000000 011000                    NOP     0

      436     4054
      437     4055    3       END;

      438     4056
      439     4057    2       IF WINDOW$SPEC.KEY_DEFINITION_BUFFER$ = ADDR(NIL)

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:59   
   4057  2 001104   200007 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         2 001105   000030 236100                    LDQ     24,,PR0
         2 001106   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001107   001131 601000 2                  TNZ     s:4069

      440     4058    2       THEN
      441     4059    2   OALLOC_THE_IMP_BUFFER:
      442     4060    3         DO;

   4060  2 001110                       OALLOC_THE_* null
      443     4061    3           CALL VDG$OALLOC (%CLS_BUFFER,

   4061  2 001110   000004 236000 3                  LDQ     4
         2 001111   200030 756100                    STQ     MY_KEY_NAME+5,,AUTO
         2 001112   200007 236100                    LDQ     CURRENT_WINDOW$,,AUTO
         2 001113   000030 036003                    ADLQ    24,DU
         2 001114   000002 235000 3                  LDA     2
         2 001115   200026 757100                    STAQ    MY_KEY_NAME+3,,AUTO
         2 001116   200026 630500                    EPPR0   MY_KEY_NAME+3,,AUTO
         2 001117   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001120   000000 701000 xent               TSX1    VDG$OALLOC
         2 001121   001123 702000 2                  TSX2    s:4064
         2 001122   001125 710000 2                  TRA     s:4066

      444     4062    3             WINDOW$SPEC.KEY_DEFINITION_BUFFER$,
      445     4063    3             1024 / %NB_PER_WORD)
      446     4064    4           WHENALTRETURN DO; ALTRETURN; END;

   4064  2 001123   200022 221300                    LDX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO
         2 001124   000000 702211                    TSX2  ! 0,X1

      447     4065
      448     4066    3           WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH# = 0;

   4066  2 001125   200007 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         2 001126   000030 471500                    LDP1    24,,PR0
         2 001127   000000 220003                    LDX0    0,DU
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:60   
         2 001130   100002 740100                    STX0    2,,PR1

      449     4067    3         END OALLOC_THE_IMP_BUFFER;

      450     4068
      451     4069    2       VBASE (XUI_IMP.IMP_BUFFER_) =

   4069  2 001131   000030 471500                    LDP1    24,,PR0
         2 001132   200026 451500                    STP1    MY_KEY_NAME+3,,AUTO
         2 001133   200026 236100                    LDQ     MY_KEY_NAME+3,,AUTO
         2 001134   000005 036000 3                  ADLQ    5
         2 001135   000001 756000 1                  STQ     XUI_IMP+1

      452     4070    2         ADDR (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.BYTES);
      453     4071    2       VBOUND (XUI_IMP.IMP_BUFFER_) =

   4071  2 001136   100000 236100                    LDQ     0,,PR1
         2 001137   000022 736000                    QLS     18
         2 001140   000020 732000                    QRS     16
         2 001141   000014 136007                    SBLQ    12,DL
         2 001142   000020 736000                    QLS     16
         2 001143   000000 676000 1                  ERQ     XUI_IMP
         2 001144   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001145   000000 656000 1                  ERSQ    XUI_IMP

      454     4072    2         (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.OBJECT.SIZE#
      455     4073    2         * %NB_PER_WORD)
      456     4074    2         - SIZEC (VD$BUFFER_HEADER);
      457     4075    2       XUI_IMP.IMP_BUFFER_OFFSET =

   4075  2 001146   100002 236100                    LDQ     2,,PR1
         2 001147   000022 732000                    QRS     18
         2 001150   000002 756000 1                  STQ     XUI_IMP+2

      458     4076    2         WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH#;
      459     4077
      460     4078    2       IF ITS_A_DELETE
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:61   

   4078  2 001151   200011 234100                    SZN     ITS_A_DELETE,,AUTO
         2 001152   001156 605000 2                  TPL     s:4082

      461     4079    2       THEN
      462     4080    2         XUI_IMP.KEY_VALUE$ = ADDR (NIL);

   4080  2 001153   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001154   000004 756000 1                  STQ     XUI_IMP+4
         2 001155   001161 710000 2                  TRA     s:4083

      463     4081    2       ELSE
      464     4082    2         XUI_IMP.KEY_VALUE$ = ADDR(WINDOW$SPECIFIC_KEYIN_VALUE.LENGTH#);

   4082  2 001156   200020 236100                    LDQ     WINDOW_SPECIFIC_VALUE$,,AUTO
         2 001157   000002 036003                    ADLQ    2,DU
         2 001160   000004 756000 1                  STQ     XUI_IMP+4

      465     4083    2       XUI_IMP.IMPDCBNUM# = WINDOW$SPEC.DCB#;

   4083  2 001161   000014 720100                    LXL0    12,,PR0
         2 001162   000005 440000 1                  SXL0    XUI_IMP+5

      466     4084
      467     4085    2       CALL VDP$IMP (XUI_IMP)

   4085  2 001163   000006 630400 3                  EPPR0   6
         2 001164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001165   000000 701000 xent               TSX1    VDP$IMP
         2 001166   001170 702000 2                  TSX2    s:4088
         2 001167   001213 710000 2                  TRA     s:4095

      468     4086    2       WHENALTRETURN
      469     4087    3         DO;

      470     4088    3           CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:62   
   4088  2 001170   200014 630500                    EPPR0   VD_ERR$,,AUTO
         2 001171   200027 450500                    STP0    MY_KEY_NAME+4,,AUTO
         2 001172   000007 236000 3                  LDQ     7
         2 001173   200026 756100                    STQ     MY_KEY_NAME+3,,AUTO
         2 001174   200026 630500                    EPPR0   MY_KEY_NAME+3,,AUTO
         2 001175   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001176   000000 701000 xent               TSX1    VDG$OALLOC
         2 001177   001201 702000 2                  TSX2    s:4089
         2 001200   001203 710000 2                  TRA     s:4090

      471     4089    4           WHENALTRETURN DO; ALTRETURN; END;

   4089  2 001201   200022 221300                    LDX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO
         2 001202   000000 702211                    TSX2  ! 0,X1

      472     4090    3           VD$ERR.ERR = XUI_IMP.ERRCODE;

   4090  2 001203   000006 236000 1                  LDQ     XUI_IMP+6
         2 001204   200014 470500                    LDP0    VD_ERR$,,AUTO
         2 001205   000002 756100                    STQ     2,,PR0

      473     4091    3           VD$ERR.FLAGLEV# = %FLV_SERIOUS;

   4091  2 001206   000003 220003                    LDX0    3,DU
         2 001207   200014 470500                    LDP0    VD_ERR$,,AUTO
         2 001210   000003 740100                    STX0    3,,PR0

      474     4092    3           ALTRETURN;

   4092  2 001211   200022 221300                    LDX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO
         2 001212   000000 702211                    TSX2  ! 0,X1

      475     4093    3         END;
      476     4094
      477     4095    2       IF XUI_IMP.IMP_BUFFER_OFFSET ~= 0

   4095  2 001213   000002 235000 1                  LDA     XUI_IMP+2
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:63   
         2 001214   001221 600000 2                  TZE     s:4100

      478     4096    2       THEN
      479     4097    2         WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH# =

   4097  2 001215   200007 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         2 001216   000030 471500                    LDP1    24,,PR0
         2 001217   000000 620005                    EAX0    0,AL
         2 001220   100002 740100                    STX0    2,,PR1

      480     4098    2           XUI_IMP.IMP_BUFFER_OFFSET;
      481     4099
      482     4100    2       RETURN;

   4100  2 001221   200022 221300                    LDX1  ! WINDOW_SPECIFIC_VALUE$+2,,AUTO
         2 001222   000001 702211                    TSX2  ! 1,X1
      483     4101
      484     4102    2   END IMP_A_WINDOW;
      485     4103
      486     4104    1   END VDP$NKEYIN;
      487     4105        %EOD;

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:64   
--  Include file information  --

   VD_MACROS_M.:VDA5TOU  is referenced.
   VDP_MACRO_C.:VDA5TOU  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDP$NKEYIN.
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:65   

 **** Variables and constants ****

  ****  Section 001  Data  VDP$NKEYIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(252)   r     1 XUI_IMP                    0-0-0/d STRC(288)   r     1 XUI_IMP_FLG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @KEY_NAME                  4-0-0/w PTR         r     1 @SECOND_PARAMETER
     5-0-0/w PTR         r     1 @WINDOW_SPEC               6-0-0/w UBIN        r     1 AUTO_VARIABLE
     7-0-0/w PTR         r     1 CURRENT_WINDOW$           10-0-0/w BIT         r     1 FOUND_INTRO
    11-0-0/w BIT         r     1 ITS_A_DELETE              12-0-0/w BIT         r     1 ITS_A_NEQUALS
    *0-0-0/w ASTR(9)     r     1 KEY_NAME                  *0-0-0/w ASTR(90)    r     1 KEY_VALUE
    23-0-0/c STRC(72)    r     1 MY_KEY_NAME
    13-0-0/w PTR         r     1 NEW_WINDOW_SPECIFIC_VALUE$
    *0-0-0/w ACHR        r     1 SECOND_PARAMETER          14-0-0/w PTR         r     1 VD_ERR$
    *0-0-0/w ASTR(90)    r     1 WHATEVER_VALUE            15-0-0/w PTR         r     1 WINDOW$
    16-0-0/w SBIN        r     1 WINDOW_INDEX              17-0-0/w PTR         r     1 WINDOW_NUMBER$
    *0-0-0/w STRC(900)   r     1 WINDOW_SPEC
    20-0-0/w PTR         r     1 WINDOW_SPECIFIC_VALUE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(90)    r     1 VD_$INTRO_1                0-0-0/w ASTR(90)    r     1 VD_$INTRO_2
     0-0-0/w STRC(22644) r     1 VD_6E

  ****  BASED and DCB variables  ****

PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:66   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 EQUALS_SPEC                0-0-0N  NULL        r     1 M$UC
     0-0-0/w ASTR(90)    r     1 NEW_WINDOW$SPECIFIC_VALUE
     0-0-0/w ASTR(90)    r     1 VD$BUFFER                  0-0-0/w STRC(90)    r     1 VD$BUFFER_HEADER
     0-0-0/w STRC(180)   r     1 VD$ERR                     0-0-0/w STRC(468)   r     1 VD$FILE_NODE
     0-0-0/w STRC(1944)  r     1 VD$PORT                    0-0-0/w STRC(864)   r     1 VD$STREAM
     0-0-0/w ASTR(81)    r     1 VD$TEXTC_REMOTE            0-0-0/w STRC        r     1 WINDOW$NUMBER
     0-0-0/w STRC(900)   r     1 WINDOW$SPEC
     0-0-0/w STRC(144)   r     1 WINDOW$SPECIFIC_EQUALS_VALUE
     0-0-0/w ASTR(90)    r     1 WINDOW$SPECIFIC_KEYIN_VALUE
     0-0-0/w ASTR(90)    r     1 WINDOW$SPECIFIC_VALUE


   Procedure VDP$NKEYIN requires 659 words for executable code.
   Procedure VDP$NKEYIN requires 26 words of local(AUTO) storage.
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:67   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:68   
          MINI XREF LISTING

AUTO_VARIABLE
      2835**DCL      2427--IMP-SIZ
CURRENT_WINDOW$
      2836**DCL      3639--IMP-PTR  3748<<ASSIGN   3774<<ASSIGN   3796<<ASSIGN   3828<<ASSIGN   3842>>IF
      3901>>IF       3903>>ASSIGN   3904>>ASSIGN   3906>>IF       3908>>ASSIGN   3909>>ASSIGN   3911>>IF
      3913>>ASSIGN   3914>>ASSIGN   3916>>IF       3918>>ASSIGN   3919>>ASSIGN   3921>>IF       3923>>ASSIGN
      3924>>ASSIGN   3926>>IF       3928>>ASSIGN   3929>>ASSIGN   3931>>IF       3933>>ASSIGN   3934>>ASSIGN
      3936>>IF       3938>>ASSIGN   3939>>ASSIGN   3941>>IF       3943>>ASSIGN   3944>>ASSIGN   3946>>IF
      3948>>ASSIGN   3949>>ASSIGN   3951>>IF       3953>>ASSIGN   3954>>ASSIGN   3956>>IF       3958>>ASSIGN
      3959>>ASSIGN   3961>>IF       3963>>ASSIGN   3964>>ASSIGN   3966>>IF       3968>>ASSIGN   3969>>ASSIGN
      3972>>ASSIGN   3974>>ASSIGN   3976>>ASSIGN   3978>>ASSIGN   3982>>IF       3984>>CALL     3987>>ASSIGN
      3989>>IF       3989>>IF       3992>>ASSIGN   3994>>ASSIGN   3994>>ASSIGN   3996>>ASSIGN   4057>>IF
      4061>>CALL     4066>>ASSIGN   4069>>ASSIGN   4071>>ASSIGN   4075>>ASSIGN   4083>>ASSIGN   4097>>ASSIGN
DO_THE_WINDOW
      3877**LABEL    3831--GOTO
EQUALS_SPEC.WRITER#
      2424**DCL      3898>>DOCASE
EQUATE_A_WINDOW
      3895**PROC     3799--CALL     3880--CALL
FIND_WINDOW_VALUE
      3834**LABEL    3840--EXIT     3864--EXIT
FOUND_INTRO
      2837**DCL      3897<<ASSIGN   3906>>IF       3908>>ASSIGN   3921>>IF       3923>>ASSIGN   3926>>IF
      3928>>ASSIGN   3931>>IF       3933>>ASSIGN   3936>>IF       3938>>ASSIGN   3956>>IF       3958>>ASSIGN
      3961>>IF       3963>>ASSIGN
IMP_A_WINDOW
      4006**PROC     3750--CALL     3776--CALL     3883--CALL
ITS_A_DELETE
      2838**DCL      3702<<ASSIGN   3724<<ASSIGN   3747<<ASSIGN   3773<<ASSIGN   3819<<ASSIGN   3830>>IF
      4078>>IF
ITS_A_NEQUALS
      2839**DCL      3701<<ASSIGN   3723<<ASSIGN   3746<<ASSIGN   3772<<ASSIGN   3798<<ASSIGN   3818<<ASSIGN
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:69   
      3878>>IF       3901>>IF       3906>>IF       3911>>IF       3916>>IF       3921>>IF       3926>>IF
      3931>>IF       3936>>IF       3941>>IF       3946>>IF       3951>>IF       3956>>IF       3961>>IF
      3966>>IF       3989>>IF
KEY_NAME
      2364**DCL        31--PROC     3719--ENTRY    3743--ENTRY    3768--ENTRY    3793--ENTRY    3815--ENTRY
      3898--DOCASE   4013--IF
KEY_NAME.BYTES
      2374**DCL      4016>>ASSIGN   4041>>IF       4045>>IF
KEY_NAME.LENGTH#
      2372**DCL      2374--IMP-SIZ  4016>>ASSIGN   4024>>ASSIGN   4027>>ASSIGN   4041>>IF       4041>>IF
      4045>>IF       4045>>IF
KEY_VALUE
      2511**DCL      3721--IF       3749--ASSIGN   3770--IF       3775--ASSIGN
KEY_VALUE.LENGTH#
      2537**DCL      2539--IMP-SIZ
MY_KEY_NAME IN PROCEDURE IMP_A_WINDOW
      4008**DCL      4015--ASSIGN
MY_KEY_NAME.BYTES IN PROCEDURE IMP_A_WINDOW
      4010**DCL      4011--REDEF    4016<<ASSIGN   4020<<ASSIGN   4020>>ASSIGN
MY_KEY_NAME.LENGTH# IN PROCEDURE IMP_A_WINDOW
      4009**DCL      4024<<ASSIGN   4027<<ASSIGN   4036>>DOCASE
MY_KEY_NAME.UBYTES IN PROCEDURE IMP_A_WINDOW
      4011**DCL      4017>>IF       4021>>IF       4028>>IF
NCOMMON
      3822**LABEL    3703--GOTO     3725--GOTO
NEW_WINDOW$SPECIFIC_VALUE.FLINK$
      2995**DCL      3862>>ASSIGN
NEW_WINDOW$SPECIFIC_VALUE.LENGTH#
      2995**DCL      2997--IMP-SIZ  3842>>IF       3867>>IF
NEW_WINDOW_SPECIFIC_VALUE$
      2840**DCL      2969--IMP-PTR  3838<<ASSIGN   3839>>IF       3842>>IF       3846>>ASSIGN   3862<<ASSIGN
      3862>>ASSIGN   3863>>IF       3867>>IF       3870>>ASSIGN
SECOND_PARAMETER
      2427**DCL        31--PROC     2453--REDEF    2511--REDEF    2544--REDEF    3719--ENTRY    3743--ENTRY
      3768--ENTRY    3793--ENTRY    3797--ASSIGN   3815--ENTRY
VD$BUFFER.BYTES
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:70   
      2902**DCL      3989>>IF       3994<<ASSIGN   4069--ASSIGN
VD$BUFFER.LENGTH#
      2900**DCL      2902--IMP-SIZ  3987<<ASSIGN   3989>>IF       3992<<ASSIGN   3994>>ASSIGN   4066<<ASSIGN
      4075>>ASSIGN   4097<<ASSIGN
VD$BUFFER.OBJECT.SIZE#
      2898**DCL      4071>>ASSIGN
VD$BUFFER_HEADER
      2915**DCL      3984--CALL     4071--ASSIGN
VD$ERR.ERR
      3204**DCL      4090<<ASSIGN
VD$ERR.FLAGLEV#
      3209**DCL      4091<<ASSIGN
VD$FILE_NODE.DESC.KEY.REP#
      3285**DCL      3856>>IF
VD$FILE_NODE.DESC.KEY.V$
      3285**DCL      3856>>ASSIGN   3856--ASSIGN
VD$FILE_NODE.DESC.SPEC.V$
      3299**DCL      3828>>ASSIGN
VD$FILE_NODE.FLINK$
      3246**DCL      3888>>ASSIGN
VD$FILE_NODE.HEAD$
      3303**DCL      3822>>ASSIGN
VD$PORT.LEVEL.INTERNAL$
      3446**DCL      3822>>ASSIGN
VD$STREAM.PORT$
      3483**DCL      3822>>ASSIGN
VD$TEXTC_REMOTE.LENGTH#
      3624**DCL      3626--IMP-SIZ  3856--ASSIGN
VDG$ESCREECH
      2769**DCL-ENT  3700--CALL     3721--CALL     3722--CALL     3745--CALL     3770--CALL     3771--CALL
      3998--CALL     4013--CALL     4050--CALL     4053--CALL
VDG$OALLOC
      2770**DCL-ENT  3984--CALL     4061--CALL     4088--CALL
VDP$IMP
      2771**DCL-ENT  4085--CALL
VD_$INTRO_1.BYTES
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:71   
      2702**DCL      4041>>IF
VD_$INTRO_1.LENGTH#
      2700**DCL      2702--IMP-SIZ  4041>>IF       4041>>IF
VD_$INTRO_2.BYTES
      2762**DCL      4045>>IF
VD_$INTRO_2.LENGTH#
      2760**DCL      2762--IMP-SIZ  4045>>IF       4045>>IF
VD_6E.CMD_STREAM$
      2643**DCL      3128--IMP-PTR
VD_6E.WINDOWS$
      2626**DCL      3822>>ASSIGN
VD_ERR$
      2841**DCL      3167--IMP-PTR  4088<>CALL     4090>>ASSIGN   4091>>ASSIGN
WHATEVER_VALUE
      2453**DCL      3836--ASSIGN
WHATEVER_VALUE.FLINK$
      2479**DCL      3838>>ASSIGN
WHATEVER_VALUE.LENGTH#
      2479**DCL      2481--IMP-SIZ
WINDOW$
      2842**DCL      3822<<ASSIGN   3826>>DOWHILE  3828>>ASSIGN   3856>>IF       3856>>ASSIGN   3856>>ASSIGN
      3888<<ASSIGN   3888>>ASSIGN
WINDOW$NUMBER.BYTES#
      3568**DCL      3861>>DOINDEX
WINDOW$SPEC.COMMAND
      3665**DCL      3842>>IF
WINDOW$SPEC.DCB#
      3682**DCL      4083>>ASSIGN
WINDOW$SPEC.EDTCTL.EZAPPEND#
      3691**DCL      3921>>IF       3923<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK
      3689**DCL      3996<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.EZAPPEND
      3689**DCL      3924<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.HSALL
      3688**DCL      3929<<ASSIGN
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:72   
WINDOW$SPEC.EDTCTL.FLUSH.KEY_GENERATION
      3688**DCL      3904<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.ONESPACEEDIT
      3689**DCL      3934<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.RECWRAP
      3688**DCL      3909<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.TEXTEDIT
      3689**DCL      3939<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL
      3688**DCL      3914<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL_MARGIN
      3688**DCL      3919<<ASSIGN
WINDOW$SPEC.EDTCTL.HSALL#
      3690**DCL      3926>>IF       3928<<ASSIGN
WINDOW$SPEC.EDTCTL.KEY_GENERATION#
      3691**DCL      3901>>IF       3903<<ASSIGN
WINDOW$SPEC.EDTCTL.ONESPACEEDIT#
      3690**DCL      3931>>IF       3933<<ASSIGN
WINDOW$SPEC.EDTCTL.RECORDWRAP
      3690**DCL      3906>>IF       3908<<ASSIGN
WINDOW$SPEC.EDTCTL.TEXTEDIT#
      3691**DCL      3936>>IF       3938<<ASSIGN
WINDOW$SPEC.EDTCTL.VSCROLL#
      3691**DCL      3911>>IF       3913<<ASSIGN
WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN#
      3692**DCL      3916>>IF       3918<<ASSIGN
WINDOW$SPEC.EOFMARK$
      3693**DCL      3982>>IF       3984<>CALL     3987>>ASSIGN   3989>>IF       3989>>IF       3992>>ASSIGN
      3994>>ASSIGN   3994>>ASSIGN
WINDOW$SPEC.INTRO_1.BYTES
      3693**DCL      3974<<ASSIGN
WINDOW$SPEC.INTRO_1.LENGTH#
      3693**DCL      3972<<ASSIGN
WINDOW$SPEC.INTRO_2.BYTES
      3694**DCL      3978<<ASSIGN
WINDOW$SPEC.INTRO_2.LENGTH#
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:73   
      3694**DCL      3976<<ASSIGN
WINDOW$SPEC.KEY_DEFINITION_BUFFER$
      3694**DCL      4057>>IF       4061<>CALL     4066>>ASSIGN   4069>>ASSIGN   4071>>ASSIGN   4075>>ASSIGN
      4097>>ASSIGN
WINDOW$SPEC.TRMCTL.AUTOTAB#
      3686**DCL      3941>>IF       3943<<ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH.AUTOTAB
      3684**DCL      3944<<ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL
      3684**DCL      3949<<ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL_MARGIN
      3684**DCL      3954<<ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH.INSERT_MODE
      3685**DCL      3959<<ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH.SCROLL
      3685**DCL      3964<<ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH.WORDWRAP
      3685**DCL      3969<<ASSIGN
WINDOW$SPEC.TRMCTL.HSCROLL#
      3686**DCL      3946>>IF       3948<<ASSIGN
WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN#
      3687**DCL      3951>>IF       3953<<ASSIGN
WINDOW$SPEC.TRMCTL.INSERT_MODE
      3686**DCL      3956>>IF       3958<<ASSIGN
WINDOW$SPEC.TRMCTL.SCROLL#
      3686**DCL      3961>>IF       3963<<ASSIGN
WINDOW$SPEC.TRMCTL.WORDWRAP#
      3687**DCL      3966>>IF       3968<<ASSIGN
WINDOW$SPECIFIC_EQUALS_VALUE.V#
      3348**DCL      3897>>ASSIGN   3901>>IF       3903>>ASSIGN   3911>>IF       3913>>ASSIGN   3916>>IF
      3918>>ASSIGN   3941>>IF       3943>>ASSIGN   3946>>IF       3948>>ASSIGN   3951>>IF       3953>>ASSIGN
      3966>>IF       3968>>ASSIGN
WINDOW$SPECIFIC_KEYIN_VALUE.LENGTH#
      3113**DCL      3115--IMP-SIZ  4082--ASSIGN
WINDOW$SPECIFIC_VALUE.BYTES
      3056**DCL      3974>>ASSIGN   3978>>ASSIGN   3989>>IF       3994>>ASSIGN
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:74   
WINDOW$SPECIFIC_VALUE.LENGTH#
      3054**DCL      3056--IMP-SIZ  3875>>IF       3972>>ASSIGN   3974>>ASSIGN   3976>>ASSIGN   3978>>ASSIGN
      3983>>IF       3989>>IF       3992>>ASSIGN   3994>>ASSIGN
WINDOW_INDEX
      2843**DCL      3861<<DOINDEX
WINDOW_NUMBER$
      2844**DCL      3564--IMP-PTR  3856<<ASSIGN   3856<<ASSIGN   3861>>DOINDEX
WINDOW_SPEC
      2553**DCL        31--PROC     3700--IF       3719--ENTRY    3722--IF       3743--ENTRY    3745--IF
      3748--ASSIGN   3768--ENTRY    3771--IF       3774--ASSIGN   3793--ENTRY    3796--ASSIGN   3815--ENTRY
WINDOW_SPECIFIC_VALUE$
      2845**DCL      3028--IMP-PTR  3087--IMP-PTR  3314--IMP-PTR  3749<<ASSIGN   3775<<ASSIGN   3797<<ASSIGN
      3836<<ASSIGN   3846<<ASSIGN   3870<<ASSIGN   3875>>IF       3897>>ASSIGN   3901>>IF       3903>>ASSIGN
      3911>>IF       3913>>ASSIGN   3916>>IF       3918>>ASSIGN   3941>>IF       3943>>ASSIGN   3946>>IF
      3948>>ASSIGN   3951>>IF       3953>>ASSIGN   3966>>IF       3968>>ASSIGN   3972>>ASSIGN   3974>>ASSIGN
      3974>>ASSIGN   3976>>ASSIGN   3978>>ASSIGN   3978>>ASSIGN   3983>>IF       3989>>IF       3989>>IF
      3992>>ASSIGN   3994>>ASSIGN   3994>>ASSIGN   4082>>ASSIGN
XUI_IMP
      2782**DCL      2832--REDEF    4085<>CALL
XUI_IMP.CTRSTR#
      2785**DCL      4023<<ASSIGN
XUI_IMP.ERRCODE
      2801**DCL      4090>>ASSIGN
XUI_IMP.FNCKEY#
      2785**DCL      4030<<ASSIGN
XUI_IMP.IMPDCBNUM#
      2785**DCL      4083<<ASSIGN
XUI_IMP.IMP_BUFFER_
      2782**DCL      4069<<ASSIGN   4071<<ASSIGN
XUI_IMP.IMP_BUFFER_OFFSET
      2782**DCL      4075<<ASSIGN   4095>>IF       4097>>ASSIGN
XUI_IMP.KEY_NAME$
      2783**DCL      4015<<ASSIGN
XUI_IMP.KEY_VALUE$
      2783**DCL      4080<<ASSIGN   4082<<ASSIGN
XUI_IMP.PRIMARY#
PL6.E3A0      #001=VDP$NKEYIN File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:36 Page:75   
      2783**DCL      4044<<ASSIGN
XUI_IMP.SECONDARY#
      2784**DCL      4048<<ASSIGN
XUI_IMP_FLG.F
      2832**DCL      4014<<ASSIGN

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:76   
      488        1        /*M* VDP$NFLUSH:  Update window information.  */
      489        2        /*T***********************************************************/
      490        3        /*T*                                                         */
      491        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      492        5        /*T*                                                         */
      493        6        /*T***********************************************************/
      494        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
      495        8
      496        9        VDP$NFLUSH: PROC (UPDATE_SCREEN) ALTRET;
      497       10
      498       11    1     DCL UPDATE_SCREEN BIT(1) ALIGNED;
      499       12
      500       13          %INCLUDE CP_6;
      501       94          %INCLUDE CP_6_SUBS;
      502      634          %INCLUDE VDP_MACRO_C;
      503      660          %INCLUDE VD_MACROS_M;
      504     2875
      505     2876          %B$TCB;
      506     2879          %B$ALT;
      507     2887    1     DCL B$TCB$ PTR SYMREF;
      508     2888          %FPT_DEVICE;
      509     2906        %FPT_TRMCTL (FPTN=FPT_EDTCTL, VLPTYPE=EDTCTL);
      510     2933        %VLP_EDTCTL (FPTN=CONST_VLP_EDTCTL, STCLASS=CONSTANT);
      511     2961        %VLP_EDTCTL (FPTN=VLP_EDTCTL, STCLASS=AUTO);
      512     2989        %FPT_TRMCTL (FPTN=FPT_TRMCTL);
      513     3016        %VLP_TRMCTL (FPTN=CONST_VLP_TRMCTL, STCLASS=CONSTANT);
      514     3056        %VLP_TRMCTL (FPTN=VLP_TRMCTL, STCLASS=AUTO);
      515     3096        %VLP_HDR (STCLASS=AUTO, LEN=%MXNB_$EOF_MARK);
      516     3112
      517     3113          %VD_6E (STCLASS=SYMREF);
      518     3149          %VD$NUMBER (NAME=VD_$$MON_PRES, STCLASS=SYMREF);
      519     3194        %VD$NUMBER (NAME=VD_$BY, STCLASS=SYMREF);
      520     3239          %VD$NUMBER (NAME=VD_$SCREEN, STCLASS=SYMREF);
      521     3284    1     DCL VD_CURRENT_WINDOW$ PTR SYMREF;
      522     3285    1     DCL VD_SCREEN_HEIGHT UBIN SYMREF;
      523     3286
      524     3287          %XUI_IMP (FLUSH=YES);
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:77   
      525     3348
      526     3349    1     DCL CURRENT_WINDOW$ PTR;
      527     3350    1     DCL WINDOW$ PTR;
      528     3351    1     DCL HAD_FEP_ERROR BIT(1) ALIGNED;
      529     3352    1     DCL VD_ERR$ PTR;
      530     3353
      531     3354          %VD$BUFFER;
      532     3412          %VD$BUFFER_HEADER;
      533     3448          %VD$CMD_STREAM (NAME=CMD$STREAM, STCLASS="BASED(VD_6E.CMD_STREAM$)");
      534     3487          %VD$ERR (STCLASS="BASED(VD_ERR$)");
      535     3540          %VD$FILE_NODE;
      536     3633          %VD$PORT;
      537     3731          %VD$STREAM;
      538     3837          %VD$WINDOW_SPEC (NAME=WINDOW$SPEC, STCLASS="BASED(CURRENT_WINDOW$)");
      539     3903
      540     3904    1     DCL VDG$MPRES_FEPDEVICE ENTRY (1);
      541     3905    1     DCL VDG$MPRES_RETURN ENTRY (1);
      542     3906    1     DCL VDG$MPRES_NFLUSH ENTRY;
      543     3907    1     DCL VDG$OALLOC ENTRY (3) ALTRET;
      544     3908    1     DCL VDG$OFREE ENTRY (1) ALTRET;
      545     3909    1     DCL VDP$IMP ENTRY (1) ALTRET;
      546     3910        %EJECT;
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:78   
      547     3911    1       IF VD_$$MON_PRES.V# > 0
      548     3912    1       THEN
      549     3913    1         CALL VDG$MPRES_NFLUSH;
      550     3914
      551     3915    1       IF VD_$SCREEN.V# < %MN_SCREEN_EDITING_HEIGHT
      552     3916    1       THEN
      553     3917    1         RETURN; /*??* Shouldn't 1Dim do TRMCTLs, etc--just not update screen??*/
      554     3918
      555     3919    1       WINDOW$ = VD_6E.WINDOWS$ -> VD$STREAM.PORT$ ->
      556     3920    1         VD$PORT.LEVEL.INTERNAL$ (%LVL_FILE) -> VD$FILE_NODE.HEAD$;
      557     3921    1       HAD_FEP_ERROR = %FALSE;
      558     3922
      559     3923    1   FLUSH_WINDOWS:
      560     3924    2       DO WHILE (WINDOW$ ~= ADDR(NIL));
      561     3925    2         CURRENT_WINDOW$ = WINDOW$ -> VD$FILE_NODE.DESC.SPEC.V$;
      562     3926
      563     3927    2         IF NOT WINDOW$SPEC.COMMAND
      564     3928    2           AND NOT WINDOW$SPEC.SCREEN_UPDATED
      565     3929    2           AND UPDATE_SCREEN
      566     3930    2         THEN
      567     3931    2   UPDATE_SCREEN:
      568     3932    3           DO;
      569     3933    3             FPT_DEVICE.V.DCB# = WINDOW$SPEC.DCB#;
      570     3934
      571     3935    3             IF VD_$$MON_PRES.V# > 0
      572     3936    3             THEN
      573     3937    3               CALL VDG$MPRES_FEPDEVICE (WINDOW$SPEC.DCB#);
      574     3938
      575     3939    3             CALL M$DEVICE (FPT_DEVICE)
      576     3940    4             WHENALTRETURN DO;
      577     3941    4                 CALL MONERR;
      578     3942    4               END;
      579     3943
      580     3944    3             WINDOW$SPEC.SCREEN_UPDATED = %TRUE;
      581     3945    3           END UPDATE_SCREEN;
      582     3946
      583     3947    2         IF WINDOW$SPEC.KEY_DEFINITION_BUFFER$ ~= ADDR(NIL)
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:79   
      584     3948    2         THEN
      585     3949    2   UPDATE_KEYINS:
      586     3950    3           DO;
      587     3951    3             IF WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH# > 0
      588     3952    3             THEN
      589     3953    3   FLUSH_KEYINS:
      590     3954    4               DO;
      591     3955
      592     3956    4                 VBASE (XUI_IMP.IMP_BUFFER_) =
      593     3957    4                   ADDR (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.BYTES);
      594     3958    4                 VBOUND (XUI_IMP.IMP_BUFFER_) =
      595     3959    4                   (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.OBJECT.SIZE#
      596     3960    4                   * %NB_PER_WORD)
      597     3961    4                   - SIZEC (VD$BUFFER_HEADER);
      598     3962    4                 XUI_IMP.IMP_BUFFER_OFFSET =
      599     3963    4                   WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH#;
      600     3964    4                 XUI_IMP.IMPDCBNUM# = WINDOW$SPEC.DCB#;
      601     3965
      602     3966    4                 CALL VDP$IMP (XUI_IMP)
      603     3967    4                 WHENALTRETURN
      604     3968    5                   DO;
      605     3969    5                     CALL MONERR;
      606     3970    5                     VD$ERR.ERR = XUI_IMP.ERRCODE;
      607     3971    5                   END;
      608     3972    4               END FLUSH_KEYINS;
      609     3973
      610     3974    3   OFREE_THE_IMP_BUFFER:
      611     3975    4             DO;
      612     3976    4               CALL VDG$OFREE (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ ->
      613     3977    4                 VD$BUFFER)
      614     3978    4               WHENALTRETURN
      615     3979    5                 DO;
      616     3980    5                   ALTRETURN;
      617     3981    5                 END;
      618     3982    4               WINDOW$SPEC.KEY_DEFINITION_BUFFER$ = ADDR (NIL);
      619     3983    4             END OFREE_THE_IMP_BUFFER;
      620     3984    3           END UPDATE_KEYINS;
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:80   
      621     3985
      622     3986    2         IF (WINDOW$SPEC.COMMAND) THEN WINDOW$SPEC.EDTCTL.FLUSH = %CLEAR;
      623     3987
      624     3988    3         IF (WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK) THEN DO;
      625     3989    3             WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK = '0'B;
      626     3990    3             FPT_DEVICE.V.DCB# = WINDOW$SPEC.DCB#;
      627     3991    3             FPT_DEVICE.HDR_ = VECTOR (VLP_HDR);
      628     3992    3             VLP_HDR = '0'B;
      629     3993    3             VLP_HDR.TITL.L# = WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.LENGTH#;
      630     3994    3             VLP_HDR.TITL.TITLE# = WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.BYTES;
      631     3995    3             CALL M$DEVICE (FPT_DEVICE)
      632     3996    4             WHENALTRETURN DO; CALL MONERR; END;
      633     3997    3             FPT_DEVICE.HDR_ = VECTOR(NIL);
      634     3998    3           END;
      635     3999
      636     4000    2         IF (WINDOW$SPEC.EDTCTL.FLUSH)
      637     4001    2         THEN
      638     4002    2   FLUSH_EDTCTL:
      639     4003    3           DO;
      640     4004    3             VLP_EDTCTL = CONST_VLP_EDTCTL;
      641     4005    3             FPT_EDTCTL.TRMCTL_ = VECTOR(VLP_EDTCTL);
      642     4006
      643     4007    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.KEY_GENERATION) THEN
      644     4008    3               VLP_EDTCTL.KEYTYPE# = WINDOW$SPEC.EDTCTL.KEY_GENERATION#;
      645     4009
      646     4010    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.RECWRAP) THEN
      647     4011    3               VLP_EDTCTL.RCRWRAP# = WINDOW$SPEC.EDTCTL.RECORDWRAP;
      648     4012    4             IF (WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL) THEN DO;
      649     4013    4                 WINDOW$SPEC.EDTCTL.VSCROLL# =
      650     4014    4                   MINIMUM (VD_SCREEN_HEIGHT,WINDOW$SPEC.EDTCTL.VSCROLL#);
      651     4015    4                 IF (WINDOW$SPEC.EDTCTL.VSCROLL# = 0) THEN
      652     4016    4                   VLP_EDTCTL.VSSHIFT# = %SCROLL_CENTER#;/* "0" means center */
      653     4017    4                 ELSE
      654     4018    4                   VLP_EDTCTL.VSSHIFT# = WINDOW$SPEC.EDTCTL.VSCROLL#;
      655     4019    4               END;
      656     4020    4             IF (WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL_MARGIN) THEN DO;
      657     4021    4                 WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN# =
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:81   
      658     4022    4                   MINIMUM (WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN#,(VD_SCREEN_HEIGHT/2));
      659     4023    4                 VLP_EDTCTL.VSMARGIN# = WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN#;
      660     4024    4               END;
      661     4025    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.HSALL) THEN
      662     4026    3               VLP_EDTCTL.HSALL# = WINDOW$SPEC.EDTCTL.HSALL#;
      663     4027    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.TEXTEDIT) THEN
      664     4028    3               VLP_EDTCTL.TEXTEDIT# = WINDOW$SPEC.EDTCTL.TEXTEDIT#;
      665     4029    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.EZAPPEND) THEN
      666     4030    3               VLP_EDTCTL.EASYAPPEND# = WINDOW$SPEC.EDTCTL.EZAPPEND#;
      667     4031    3             IF WINDOW$SPEC.EDTCTL.KEY_INCR# = 0 THEN
      668     4032    3               WINDOW$SPEC.EDTCTL.KEY_INCR# = VD_$BY.V#;
      669     4033    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.ONESPACEEDIT) THEN
      670     4034    3               VLP_EDTCTL.ONESPACEEDIT# = WINDOW$SPEC.EDTCTL.ONESPACEEDIT#;
      671     4035    3             VLP_EDTCTL.KEYINCR# = WINDOW$SPEC.EDTCTL.KEY_INCR#;
      672     4036    3             FPT_EDTCTL.V.DCB# = WINDOW$SPEC.DCB#;
      673     4037    3             WINDOW$SPEC.EDTCTL.FLUSH = %CLEAR;
      674     4038    3             CALL M$STRMCTL (FPT_EDTCTL)
      675     4039    4             WHENALTRETURN DO; CALL MONERR; END;
      676     4040    3           END FLUSH_EDTCTL;
      677     4041
      678     4042    2         IF (WINDOW$SPEC.TRMCTL.FLUSH) THEN
      679     4043    2   FLUSH_TRMCTL:
      680     4044    3           DO;
      681     4045
      682     4046    3             VLP_TRMCTL = CONST_VLP_TRMCTL;
      683     4047    3             FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_TRMCTL);
      684     4048    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.AUTOTAB) THEN
      685     4049    3               VLP_TRMCTL.AUTOTABCLM# = WINDOW$SPEC.TRMCTL.AUTOTAB#;
      686     4050    4             IF (WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL) THEN DO;
      687     4051    4                 IF (WINDOW$SPEC.TRMCTL.HSCROLL# = 0) THEN
      688     4052    4                   VLP_TRMCTL.HSSHIFT# = %SCROLL_CENTER#; /* "0" means center */
      689     4053    4                 ELSE
      690     4054    4                   VLP_TRMCTL.HSSHIFT# = WINDOW$SPEC.TRMCTL.HSCROLL#;
      691     4055    4               END;
      692     4056    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL_MARGIN) THEN
      693     4057    3               VLP_TRMCTL.HSMARGIN# = WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN#;
      694     4058    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.INSERT_MODE) THEN
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:82   
      695     4059    3               VLP_TRMCTL.INSERTMODE# = WINDOW$SPEC.TRMCTL.INSERT_MODE;
      696     4060    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.SCROLL) THEN
      697     4061    3               VLP_TRMCTL.SCROLL# = WINDOW$SPEC.TRMCTL.SCROLL#;
      698     4062    4             IF (WINDOW$SPEC.TRMCTL.FLUSH.WORDWRAP) THEN DO;
      699     4063    4                 VLP_TRMCTL.WORDWRAPCLM# = WINDOW$SPEC.TRMCTL.WORDWRAP#;
      700     4064    4               END;
      701     4065
      702     4066    3             IF (WINDOW$SPEC.TRMCTL.HSCROLL# = 0) AND
      703     4067    3               (WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN# = 0) THEN
      704     4068    3               VLP_TRMCTL.HSCROLL# = %FALSE;
      705     4069    3             ELSE
      706     4070    3               VLP_TRMCTL.HSCROLL# = %TRUE;
      707     4071    3             FPT_TRMCTL.V.DCB# = WINDOW$SPEC.DCB#;
      708     4072    3             WINDOW$SPEC.TRMCTL.FLUSH = %CLEAR;
      709     4073
      710     4074    3             CALL M$STRMCTL (FPT_TRMCTL)
      711     4075    4             WHENALTRETURN DO; CALL MONERR; END;
      712     4076    3           END FLUSH_TRMCTL;
      713     4077
      714     4078        /*N*  IF WINDOW$SPEC.TABS.FLUSH
      715     4079              THEN
      716     4080        FLUSH_TABS:
      717     4081                DO;
      718     4082                  \* EH? *\
      719     4083                END FLUSH_TABS;  *N*/
      720     4084
      721     4085    2         WINDOW$ = WINDOW$ -> VD$FILE_NODE.FLINK$;
      722     4086    2       END FLUSH_WINDOWS;
      723     4087
      724     4088    1       IF VD_$$MON_PRES.V# > 0
      725     4089    1       THEN
      726     4090    1         CALL VDG$MPRES_RETURN;
      727     4091
      728     4092    1       IF HAD_FEP_ERROR
      729     4093    1       THEN
      730     4094    1         ALTRETURN;
      731     4095
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:83   
      732     4096    1       RETURN;
      733     4097
      734     4098        %EJECT;
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:84   
      735     4099    1   MONERR: PROC;
      736     4100
      737     4101    2       HAD_FEP_ERROR = %TRUE;
      738     4102    2       CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)
      739     4103    3       WHENALTRETURN DO; RETURN; END;
      740     4104    2       VD$ERR.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      741     4105    2       VD$ERR.FLAGLEV# = %FLV_SERIOUS;
      742     4106    2       VD$ERR.DCB# = WINDOW$SPEC.DCB#;
      743     4107                /*
      744     4108                * We want to continue in spite of error, so that:
      745     4109                *   o TRMCTLs and EDTCTLs get flushed too
      746     4110                *   o All flush flags get reset -- else we'll loop forever
      747     4111                *       trying to flush things that get errors!
      748     4112                */
      749     4113    2       RETURN;
      750     4114    2   END MONERR;
      751     4115    1   END VDP$NFLUSH;

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:85   
--  Include file information  --

   VD_MACROS_M.:VDA5TOU  is referenced.
   VDP_MACRO_C.:VDA5TOU  is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDP$NFLUSH.

   Procedure VDP$NFLUSH requires 366 words for executable code.
   Procedure VDP$NFLUSH requires 42 words of local(AUTO) storage.

    No errors detected in file VDP$NAMES.:VDA5TSI    .

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:86   

 Object Unit name= VDP$NFLUSH                                 File name= VDP$NAMES.:VDA5TOU
 UTS= JUL 04 '97 11:37:05.68 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    34     42  VDP$NFLUSH
    2  RoData even  UTS      8     10  VDP$NFLUSH
    3   Proc  even  none   366    556  VDP$NFLUSH
    4  RoData even  none    10     12  VDP$NFLUSH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  VDP$NFLUSH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 VDG$MPRES_NFLUSH
         yes           Std       1 VDG$MPRES_FEPDEVICE
 yes     yes           Std       1 VDG$OFREE
         yes           Std       1 VDG$MPRES_RETURN
 yes     yes           Std       1 VDP$IMP
 yes     yes           Std       3 VDG$OALLOC
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:87   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                VD_6E
     VD_$$MON_PRES                         VD_$BY                                VD_$SCREEN
     VD_SCREEN_HEIGHT                      B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:88   


      488        1        /*M* VDP$NFLUSH:  Update window information.  */
      489        2        /*T***********************************************************/
      490        3        /*T*                                                         */
      491        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      492        5        /*T*                                                         */
      493        6        /*T***********************************************************/
      494        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
      495        8
      496        9        VDP$NFLUSH: PROC (UPDATE_SCREEN) ALTRET;

      9  3 000000   000000 700200 xent  VDP$NFLUSH   TSX0  ! X66_AUTO_1
         3 000001   000052 000001                    ZERO    42,1

      497       10
      498       11    1     DCL UPDATE_SCREEN BIT(1) ALIGNED;
      499       12
      500       13          %INCLUDE CP_6;
      501       94          %INCLUDE CP_6_SUBS;
      502      634          %INCLUDE VDP_MACRO_C;
      503      660          %INCLUDE VD_MACROS_M;
      504     2875
      505     2876          %B$TCB;
      506     2879          %B$ALT;
      507     2887    1     DCL B$TCB$ PTR SYMREF;
      508     2888          %FPT_DEVICE;
      509     2906        %FPT_TRMCTL (FPTN=FPT_EDTCTL, VLPTYPE=EDTCTL);
      510     2933        %VLP_EDTCTL (FPTN=CONST_VLP_EDTCTL, STCLASS=CONSTANT);
      511     2961        %VLP_EDTCTL (FPTN=VLP_EDTCTL, STCLASS=AUTO);
      512     2989        %FPT_TRMCTL (FPTN=FPT_TRMCTL);
      513     3016        %VLP_TRMCTL (FPTN=CONST_VLP_TRMCTL, STCLASS=CONSTANT);
      514     3056        %VLP_TRMCTL (FPTN=VLP_TRMCTL, STCLASS=AUTO);
      515     3096        %VLP_HDR (STCLASS=AUTO, LEN=%MXNB_$EOF_MARK);
      516     3112
      517     3113          %VD_6E (STCLASS=SYMREF);
      518     3149          %VD$NUMBER (NAME=VD_$$MON_PRES, STCLASS=SYMREF);
      519     3194        %VD$NUMBER (NAME=VD_$BY, STCLASS=SYMREF);
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:89   
      520     3239          %VD$NUMBER (NAME=VD_$SCREEN, STCLASS=SYMREF);
      521     3284    1     DCL VD_CURRENT_WINDOW$ PTR SYMREF;
      522     3285    1     DCL VD_SCREEN_HEIGHT UBIN SYMREF;
      523     3286
      524     3287          %XUI_IMP (FLUSH=YES);
      525     3348
      526     3349    1     DCL CURRENT_WINDOW$ PTR;
      527     3350    1     DCL WINDOW$ PTR;
      528     3351    1     DCL HAD_FEP_ERROR BIT(1) ALIGNED;
      529     3352    1     DCL VD_ERR$ PTR;
      530     3353
      531     3354          %VD$BUFFER;
      532     3412          %VD$BUFFER_HEADER;
      533     3448          %VD$CMD_STREAM (NAME=CMD$STREAM, STCLASS="BASED(VD_6E.CMD_STREAM$)");
      534     3487          %VD$ERR (STCLASS="BASED(VD_ERR$)");
      535     3540          %VD$FILE_NODE;
      536     3633          %VD$PORT;
      537     3731          %VD$STREAM;
      538     3837          %VD$WINDOW_SPEC (NAME=WINDOW$SPEC, STCLASS="BASED(CURRENT_WINDOW$)");
      539     3903
      540     3904    1     DCL VDG$MPRES_FEPDEVICE ENTRY (1);
      541     3905    1     DCL VDG$MPRES_RETURN ENTRY (1);
      542     3906    1     DCL VDG$MPRES_NFLUSH ENTRY;
      543     3907    1     DCL VDG$OALLOC ENTRY (3) ALTRET;
      544     3908    1     DCL VDG$OFREE ENTRY (1) ALTRET;
      545     3909    1     DCL VDP$IMP ENTRY (1) ALTRET;
      546     3910        %EJECT;
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:90   
      547     3911    1       IF VD_$$MON_PRES.V# > 0

   3911  3 000002   000003 235000 xsym               LDA     VD_$$MON_PRES+3
         3 000003   000007 604400 3                  TMOZ    s:3915

      548     3912    1       THEN
      549     3913    1         CALL VDG$MPRES_NFLUSH;

   3913  3 000004   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000005   000000 701000 xent               TSX1    VDG$MPRES_NFLUSH
         3 000006   000000 011000                    NOP     0

      550     3914
      551     3915    1       IF VD_$SCREEN.V# < %MN_SCREEN_EDITING_HEIGHT

   3915  3 000007   000003 235000 xsym               LDA     VD_$SCREEN+3
         3 000010   000003 115007                    CMPA    3,DL
         3 000011   000013 605000 3                  TPL     s:3919

      552     3916    1       THEN
      553     3917    1         RETURN; /*??* Shouldn't 1Dim do TRMCTLs, etc--just not update screen??*/

   3917  3 000012   000000 702200 xent               TSX2  ! X66_ARET

      554     3918
      555     3919    1       WINDOW$ = VD_6E.WINDOWS$ -> VD$STREAM.PORT$ ->

   3919  3 000013   000006 470400 xsym               LDP0    VD_6E+6
         3 000014   000001 471500                    LDP1    1,,PR0
         3 000015   100031 473500                    LDP3    25,,PR1
         3 000016   300012 236100                    LDQ     10,,PR3
         3 000017   200043 756100                    STQ     WINDOW$,,AUTO

      556     3920    1         VD$PORT.LEVEL.INTERNAL$ (%LVL_FILE) -> VD$FILE_NODE.HEAD$;
      557     3921    1       HAD_FEP_ERROR = %FALSE;

   3921  3 000020   200044 450100                    STZ     HAD_FEP_ERROR,,AUTO
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:91   

      558     3922
      559     3923    1   FLUSH_WINDOWS:
      560     3924    2       DO WHILE (WINDOW$ ~= ADDR(NIL));

   3924  3 000021   000507 710000 3     FLUSH_WINDO* TRA     s:4086

      561     3925    2         CURRENT_WINDOW$ = WINDOW$ -> VD$FILE_NODE.DESC.SPEC.V$;

   3925  3 000022   200043 470500                    LDP0    WINDOW$,,AUTO
         3 000023   000007 236100                    LDQ     7,,PR0
         3 000024   200042 756100                    STQ     CURRENT_WINDOW$,,AUTO

      562     3926
      563     3927    2         IF NOT WINDOW$SPEC.COMMAND

   3927  3 000025   200042 471500                    LDP1    CURRENT_WINDOW$,,AUTO
         3 000026   100002 236100                    LDQ     2,,PR1
         3 000027   000400 316003                    CANQ    256,DU
         3 000030   000064 601000 3                  TNZ     s:3947
         3 000031   100015 236100                    LDQ     13,,PR1
         3 000032   100000 316003                    CANQ    32768,DU
         3 000033   000064 601000 3                  TNZ     s:3947
         3 000034   200003 473500                    LDP3    @UPDATE_SCREEN,,AUTO
         3 000035   300000 234100                    SZN     0,,PR3
         3 000036   000064 605000 3                  TPL     s:3947

      564     3928    2           AND NOT WINDOW$SPEC.SCREEN_UPDATED
      565     3929    2           AND UPDATE_SCREEN
      566     3930    2         THEN
      567     3931    2   UPDATE_SCREEN:
      568     3932    3           DO;

   3932  3 000037                       UPDATE_SCRE* null
      569     3933    3             FPT_DEVICE.V.DCB# = WINDOW$SPEC.DCB#;

   3933  3 000037   100014 720100                    LXL0    12,,PR1
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:92   
         3 000040   000006 740000 1                  STX0    FPT_DEVICE+6

      570     3934
      571     3935    3             IF VD_$$MON_PRES.V# > 0

   3935  3 000041   000003 235000 xsym               LDA     VD_$$MON_PRES+3
         3 000042   000052 604400 3                  TMOZ    s:3939

      572     3936    3             THEN
      573     3937    3               CALL VDG$MPRES_FEPDEVICE (WINDOW$SPEC.DCB#);

   3937  3 000043   200042 236100                    LDQ     CURRENT_WINDOW$,,AUTO
         3 000044   000000 036000 4                  ADLQ    0
         3 000045   200050 756100                    STQ     VD_ERR$+3,,AUTO
         3 000046   200050 630500                    EPPR0   VD_ERR$+3,,AUTO
         3 000047   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000050   000000 701000 xent               TSX1    VDG$MPRES_FEPDEVICE
         3 000051   000000 011000                    NOP     0

      574     3938
      575     3939    3             CALL M$DEVICE (FPT_DEVICE)

   3939  3 000052   000000 630400 1                  EPPR0   FPT_DEVICE
         3 000053   450006 713400                    CLIMB   alt,+20486
         3 000054   401000 401760                    pmme    nvectors=3
         3 000055   000057 702000 3                  TSX2    s:3941
         3 000056   000061 710000 3                  TRA     s:3944

      576     3940    4             WHENALTRETURN DO;

      577     3941    4                 CALL MONERR;

   3941  3 000057   000522 701000 3                  TSX1    MONERR
         3 000060   000000 011000                    NOP     0

      578     3942    4               END;

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:93   
      579     3943
      580     3944    3             WINDOW$SPEC.SCREEN_UPDATED = %TRUE;

   3944  3 000061   200042 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         3 000062   100000 236003                    LDQ     32768,DU
         3 000063   000015 256100                    ORSQ    13,,PR0

      581     3945    3           END UPDATE_SCREEN;

      582     3946
      583     3947    2         IF WINDOW$SPEC.KEY_DEFINITION_BUFFER$ ~= ADDR(NIL)

   3947  3 000064   200042 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         3 000065   000030 236100                    LDQ     24,,PR0
         3 000066   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000067   000144 600000 3                  TZE     s:3986

      584     3948    2         THEN
      585     3949    2   UPDATE_KEYINS:
      586     3950    3           DO;

   3950  3 000070                       UPDATE_KEYI* null
      587     3951    3             IF WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH# > 0

   3951  3 000070   000030 471500                    LDP1    24,,PR0
         3 000071   100002 220100                    LDX0    2,,PR1
         3 000072   000130 604400 3                  TMOZ    OFREE_THE_IMP_BUFFER

      588     3952    3             THEN
      589     3953    3   FLUSH_KEYINS:
      590     3954    4               DO;

   3954  3 000073                       FLUSH_KEYINS null
      591     3955
      592     3956    4                 VBASE (XUI_IMP.IMP_BUFFER_) =

   3956  3 000073   200050 451500                    STP1    VD_ERR$+3,,AUTO
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:94   
         3 000074   200050 236100                    LDQ     VD_ERR$+3,,AUTO
         3 000075   000001 036000 4                  ADLQ    1
         3 000076   000033 756000 1                  STQ     XUI_IMP+1

      593     3957    4                   ADDR (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.BYTES);
      594     3958    4                 VBOUND (XUI_IMP.IMP_BUFFER_) =

   3958  3 000077   000030 471500                    LDP1    24,,PR0
         3 000100   100000 236100                    LDQ     0,,PR1
         3 000101   000022 736000                    QLS     18
         3 000102   000020 732000                    QRS     16
         3 000103   000014 136007                    SBLQ    12,DL
         3 000104   000020 736000                    QLS     16
         3 000105   000032 676000 1                  ERQ     XUI_IMP
         3 000106   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000107   000032 656000 1                  ERSQ    XUI_IMP

      595     3959    4                   (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.OBJECT.SIZE#
      596     3960    4                   * %NB_PER_WORD)
      597     3961    4                   - SIZEC (VD$BUFFER_HEADER);
      598     3962    4                 XUI_IMP.IMP_BUFFER_OFFSET =

   3962  3 000110   000030 471500                    LDP1    24,,PR0
         3 000111   100002 236100                    LDQ     2,,PR1
         3 000112   000022 732000                    QRS     18
         3 000113   000034 756000 1                  STQ     XUI_IMP+2

      599     3963    4                   WINDOW$SPEC.KEY_DEFINITION_BUFFER$ -> VD$BUFFER.LENGTH#;
      600     3964    4                 XUI_IMP.IMPDCBNUM# = WINDOW$SPEC.DCB#;

   3964  3 000114   000014 720100                    LXL0    12,,PR0
         3 000115   000037 440000 1                  SXL0    XUI_IMP+5

      601     3965
      602     3966    4                 CALL VDP$IMP (XUI_IMP)

   3966  3 000116   000002 630400 4                  EPPR0   2
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:95   
         3 000117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000120   000000 701000 xent               TSX1    VDP$IMP
         3 000121   000123 702000 3                  TSX2    s:3969
         3 000122   000130 710000 3                  TRA     OFREE_THE_IMP_BUFFER

      603     3967    4                 WHENALTRETURN
      604     3968    5                   DO;

      605     3969    5                     CALL MONERR;

   3969  3 000123   000522 701000 3                  TSX1    MONERR
         3 000124   000000 011000                    NOP     0

      606     3970    5                     VD$ERR.ERR = XUI_IMP.ERRCODE;

   3970  3 000125   000040 236000 1                  LDQ     XUI_IMP+6
         3 000126   200045 470500                    LDP0    VD_ERR$,,AUTO
         3 000127   000002 756100                    STQ     2,,PR0

      607     3971    5                   END;

      608     3972    4               END FLUSH_KEYINS;

      609     3973
      610     3974    3   OFREE_THE_IMP_BUFFER:
      611     3975    4             DO;

   3975  3 000130                       OFREE_THE_I* null
      612     3976    4               CALL VDG$OFREE (WINDOW$SPEC.KEY_DEFINITION_BUFFER$ ->

   3976  3 000130   200042 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         3 000131   000030 471500                    LDP1    24,,PR0
         3 000132   200050 451500                    STP1    VD_ERR$+3,,AUTO
         3 000133   200050 630500                    EPPR0   VD_ERR$+3,,AUTO
         3 000134   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000135   000000 701000 xent               TSX1    VDG$OFREE
         3 000136   000140 702000 3                  TSX2    s:3980
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:96   
         3 000137   000141 710000 3                  TRA     s:3982

      613     3977    4                 VD$BUFFER)
      614     3978    4               WHENALTRETURN
      615     3979    5                 DO;

      616     3980    5                   ALTRETURN;

   3980  3 000140   000000 702200 xent               TSX2  ! X66_AALT

      617     3981    5                 END;
      618     3982    4               WINDOW$SPEC.KEY_DEFINITION_BUFFER$ = ADDR (NIL);

   3982  3 000141   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000142   200042 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         3 000143   000030 756100                    STQ     24,,PR0

      619     3983    4             END OFREE_THE_IMP_BUFFER;

      620     3984    3           END UPDATE_KEYINS;

      621     3985
      622     3986    2         IF (WINDOW$SPEC.COMMAND) THEN WINDOW$SPEC.EDTCTL.FLUSH = %CLEAR;

   3986  3 000144   000002 236100                    LDQ     2,,PR0
         3 000145   000400 316003                    CANQ    256,DU
         3 000146   000151 600000 3                  TZE     s:3988

   3986  3 000147   000000 236003                    LDQ     0,DU
         3 000150   000021 752106                    STCQ    17,'06'O,PR0

      623     3987
      624     3988    3         IF (WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK) THEN DO;

   3988  3 000151   000021 236100                    LDQ     17,,PR0
         3 000152   002000 316007                    CANQ    1024,DL
         3 000153   000211 600000 3                  TZE     s:4000
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:97   

      625     3989    3             WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK = '0'B;

   3989  3 000154   000003 236000 4                  LDQ     3
         3 000155   000021 356100                    ANSQ    17,,PR0

      626     3990    3             FPT_DEVICE.V.DCB# = WINDOW$SPEC.DCB#;

   3990  3 000156   000014 720100                    LXL0    12,,PR0
         3 000157   000006 740000 1                  STX0    FPT_DEVICE+6

      627     3991    3             FPT_DEVICE.HDR_ = VECTOR (VLP_HDR);

   3991  3 000160   000004 235000 4                  LDA     4
         3 000161   200050 452500                    STP2    VD_ERR$+3,,AUTO
         3 000162   200050 236100                    LDQ     VD_ERR$+3,,AUTO
         3 000163   000014 036003                    ADLQ    12,DU
         3 000164   000004 757000 1                  STAQ    FPT_DEVICE+4

      628     3992    3             VLP_HDR = '0'B;

   3992  3 000165   000100 100400                    MLR     fill='000'O
         3 000166   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000167   200014 000125                    ADSC9   VLP_HDR,,AUTO            cn=0,n=85

      629     3993    3             VLP_HDR.TITL.L# = WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.LENGTH#;

   3993  3 000170   000025 471500                    LDP1    21,,PR0
         3 000171   100002 236100                    LDQ     2,,PR1
         3 000172   000011 736000                    QLS     9
         3 000173   200015 552140                    STBQ    VLP_HDR+1,'40'O,AUTO

      630     3994    3             VLP_HDR.TITL.TITLE# = WINDOW$SPEC.EOFMARK$ -> VD$BUFFER.BYTES;

   3994  3 000174   100002 221100                    LDX1    2,,PR1
         3 000175   040100 100540                    MLR     fill='040'O
         3 000176   100002 400011                    ADSC9   2,,PR1                   cn=2,n=*X1
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:98   
         3 000177   200015 200120                    ADSC9   VLP_HDR+1,,AUTO          cn=1,n=80

      631     3995    3             CALL M$DEVICE (FPT_DEVICE)

   3995  3 000200   000000 630400 1                  EPPR0   FPT_DEVICE
         3 000201   450006 713400                    CLIMB   alt,+20486
         3 000202   401000 401760                    pmme    nvectors=3
         3 000203   000205 702000 3                  TSX2    s:3996
         3 000204   000207 710000 3                  TRA     s:3997

      632     3996    4             WHENALTRETURN DO; CALL MONERR; END;

   3996  3 000205   000522 701000 3                  TSX1    MONERR
         3 000206   000000 011000                    NOP     0

      633     3997    3             FPT_DEVICE.HDR_ = VECTOR(NIL);

   3997  3 000207   000006 237000 4                  LDAQ    6
         3 000210   000004 757000 1                  STAQ    FPT_DEVICE+4

      634     3998    3           END;

      635     3999
      636     4000    2         IF (WINDOW$SPEC.EDTCTL.FLUSH)

   4000  3 000211   200042 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         3 000212   000021 236100                    LDQ     17,,PR0
         3 000213   777700 316007                    CANQ    -64,DL
         3 000214   000370 600000 3                  TZE     s:4042

      637     4001    2         THEN
      638     4002    2   FLUSH_EDTCTL:
      639     4003    3           DO;

   4003  3 000215                       FLUSH_EDTCTL null
      640     4004    3             VLP_EDTCTL = CONST_VLP_EDTCTL;

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:99   
   4004  3 000215   000100 100400                    MLR     fill='000'O
         3 000216   000000 000020 2                  ADSC9   CONST_VLP_EDTCTL         cn=0,n=16
         3 000217   200004 000020                    ADSC9   VLP_EDTCTL,,AUTO         cn=0,n=16

      641     4005    3             FPT_EDTCTL.TRMCTL_ = VECTOR(VLP_EDTCTL);

   4005  3 000220   000005 235000 4                  LDA     5
         3 000221   200050 452500                    STP2    VD_ERR$+3,,AUTO
         3 000222   200050 236100                    LDQ     VD_ERR$+3,,AUTO
         3 000223   000004 036003                    ADLQ    4,DU
         3 000224   000016 757000 1                  STAQ    FPT_EDTCTL+4

      642     4006
      643     4007    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.KEY_GENERATION) THEN

   4007  3 000225   000021 236100                    LDQ     17,,PR0
         3 000226   400000 316007                    CANQ    -131072,DL
         3 000227   000232 600000 3                  TZE     s:4010

      644     4008    3               VLP_EDTCTL.KEYTYPE# = WINDOW$SPEC.EDTCTL.KEY_GENERATION#;

   4008  3 000230   000022 236100                    LDQ     18,,PR0
         3 000231   200004 552120                    STBQ    VLP_EDTCTL,'20'O,AUTO

      645     4009
      646     4010    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.RECWRAP) THEN

   4010  3 000232   000021 236100                    LDQ     17,,PR0
         3 000233   200000 316007                    CANQ    65536,DL
         3 000234   000242 600000 3                  TZE     s:4012

      647     4011    3               VLP_EDTCTL.RCRWRAP# = WINDOW$SPEC.EDTCTL.RECORDWRAP;

   4011  3 000235   000010 376007                    ANQ     8,DL
         3 000236   000035 736000                    QLS     29
         3 000237   200004 676100                    ERQ     VLP_EDTCTL,,AUTO
         3 000240   060000 376003                    ANQ     24576,DU
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:100  
         3 000241   200004 656100                    ERSQ    VLP_EDTCTL,,AUTO

      648     4012    4             IF (WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL) THEN DO;

   4012  3 000242   000021 236100                    LDQ     17,,PR0
         3 000243   100000 316007                    CANQ    32768,DL
         3 000244   000265 600000 3                  TZE     s:4020

      649     4013    4                 WINDOW$SPEC.EDTCTL.VSCROLL# =

   4013  3 000245   000022 236100                    LDQ     18,,PR0
         3 000246   000022 736000                    QLS     18
         3 000247   000022 732000                    QRS     18
         3 000250   000255 604000 3                  TMI     s:4013+8
         3 000251   000000 116000 xsym               CMPQ    VD_SCREEN_HEIGHT
         3 000252   000255 602000 3                  TNC     s:4013+8
         3 000253   000255 600000 3                  TZE     s:4013+8
         3 000254   000000 236000 xsym               LDQ     VD_SCREEN_HEIGHT
         3 000255   000000 620006                    EAX0    0,QL
         3 000256   000022 440100                    SXL0    18,,PR0

      650     4014    4                   MINIMUM (VD_SCREEN_HEIGHT,WINDOW$SPEC.EDTCTL.VSCROLL#);
      651     4015    4                 IF (WINDOW$SPEC.EDTCTL.VSCROLL# = 0) THEN

   4015  3 000257   000263 601000 3                  TNZ     s:4018

      652     4016    4                   VLP_EDTCTL.VSSHIFT# = %SCROLL_CENTER#;/* "0" means center */

   4016  3 000260   000177 236007                    LDQ     127,DL
         3 000261   200004 552104                    STBQ    VLP_EDTCTL,'04'O,AUTO
         3 000262   000265 710000 3                  TRA     s:4020

      653     4017    4                 ELSE
      654     4018    4                   VLP_EDTCTL.VSSHIFT# = WINDOW$SPEC.EDTCTL.VSCROLL#;

   4018  3 000263   000022 236100                    LDQ     18,,PR0
         3 000264   200004 552104                    STBQ    VLP_EDTCTL,'04'O,AUTO
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:101  

      655     4019    4               END;

      656     4020    4             IF (WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL_MARGIN) THEN DO;

   4020  3 000265   000021 236100                    LDQ     17,,PR0
         3 000266   040000 316007                    CANQ    16384,DL
         3 000267   000307 600000 3                  TZE     s:4025

      657     4021    4                 WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN# =

   4021  3 000270   000000 236000 xsym               LDQ     VD_SCREEN_HEIGHT
         3 000271   000001 772000                    QRL     1
         3 000272   200050 756100                    STQ     VD_ERR$+3,,AUTO
         3 000273   000023 236100                    LDQ     19,,PR0
         3 000274   000022 732000                    QRS     18
         3 000275   000302 604000 3                  TMI     s:4021+10
         3 000276   200050 116100                    CMPQ    VD_ERR$+3,,AUTO
         3 000277   000302 602000 3                  TNC     s:4021+10
         3 000300   000302 600000 3                  TZE     s:4021+10
         3 000301   200050 236100                    LDQ     VD_ERR$+3,,AUTO
         3 000302   000000 620006                    EAX0    0,QL
         3 000303   000023 740100                    STX0    19,,PR0

      658     4022    4                   MINIMUM (WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN#,(VD_SCREEN_HEIGHT/2));
      659     4023    4                 VLP_EDTCTL.VSMARGIN# = WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN#;

   4023  3 000304   000023 236100                    LDQ     19,,PR0
         3 000305   000011 772000                    QRL     9
         3 000306   200004 552110                    STBQ    VLP_EDTCTL,'10'O,AUTO

      660     4024    4               END;

      661     4025    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.HSALL) THEN

   4025  3 000307   000021 236100                    LDQ     17,,PR0
         3 000310   020000 316007                    CANQ    8192,DL
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:102  
         3 000311   000317 600000 3                  TZE     s:4027

      662     4026    3               VLP_EDTCTL.HSALL# = WINDOW$SPEC.EDTCTL.HSALL#;

   4026  3 000312   000004 376007                    ANQ     4,DL
         3 000313   000040 736000                    QLS     32
         3 000314   200004 676100                    ERQ     VLP_EDTCTL,,AUTO
         3 000315   300000 376003                    ANQ     98304,DU
         3 000316   200004 656100                    ERSQ    VLP_EDTCTL,,AUTO

      663     4027    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.TEXTEDIT) THEN

   4027  3 000317   000021 236100                    LDQ     17,,PR0
         3 000320   010000 316007                    CANQ    4096,DL
         3 000321   000327 600000 3                  TZE     s:4029

      664     4028    3               VLP_EDTCTL.TEXTEDIT# = WINDOW$SPEC.EDTCTL.TEXTEDIT#;

   4028  3 000322   000002 376007                    ANQ     2,DL
         3 000323   000035 736000                    QLS     29
         3 000324   200004 676100                    ERQ     VLP_EDTCTL,,AUTO
         3 000325   014000 376003                    ANQ     6144,DU
         3 000326   200004 656100                    ERSQ    VLP_EDTCTL,,AUTO

      665     4029    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.EZAPPEND) THEN

   4029  3 000327   000021 236100                    LDQ     17,,PR0
         3 000330   004000 316007                    CANQ    2048,DL
         3 000331   000337 600000 3                  TZE     s:4031

      666     4030    3               VLP_EDTCTL.EASYAPPEND# = WINDOW$SPEC.EDTCTL.EZAPPEND#;

   4030  3 000332   000001 376007                    ANQ     1,DL
         3 000333   000034 736000                    QLS     28
         3 000334   200004 676100                    ERQ     VLP_EDTCTL,,AUTO
         3 000335   003000 376003                    ANQ     1536,DU
         3 000336   200004 656100                    ERSQ    VLP_EDTCTL,,AUTO
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:103  

      667     4031    3             IF WINDOW$SPEC.EDTCTL.KEY_INCR# = 0 THEN

   4031  3 000337   000023 720100                    LXL0    19,,PR0
         3 000340   000343 601000 3                  TNZ     s:4033

      668     4032    3               WINDOW$SPEC.EDTCTL.KEY_INCR# = VD_$BY.V#;

   4032  3 000341   000003 721000 xsym               LXL1    VD_$BY+3
         3 000342   000023 441100                    SXL1    19,,PR0

      669     4033    3             IF (WINDOW$SPEC.EDTCTL.FLUSH.ONESPACEEDIT) THEN

   4033  3 000343   000021 236100                    LDQ     17,,PR0
         3 000344   000400 316007                    CANQ    256,DL
         3 000345   000353 600000 3                  TZE     s:4035

      670     4034    3               VLP_EDTCTL.ONESPACEEDIT# = WINDOW$SPEC.EDTCTL.ONESPACEEDIT#;

   4034  3 000346   000040 376007                    ANQ     32,DL
         3 000347   000035 736000                    QLS     29
         3 000350   200006 676100                    ERQ     VLP_EDTCTL+2,,AUTO
         3 000351   300000 376003                    ANQ     98304,DU
         3 000352   200006 656100                    ERSQ    VLP_EDTCTL+2,,AUTO

      671     4035    3             VLP_EDTCTL.KEYINCR# = WINDOW$SPEC.EDTCTL.KEY_INCR#;

   4035  3 000353   000023 720100                    LXL0    19,,PR0
         3 000354   200005 440100                    SXL0    VLP_EDTCTL+1,,AUTO

      672     4036    3             FPT_EDTCTL.V.DCB# = WINDOW$SPEC.DCB#;

   4036  3 000355   000014 721100                    LXL1    12,,PR0
         3 000356   000020 741000 1                  STX1    FPT_EDTCTL+6

      673     4037    3             WINDOW$SPEC.EDTCTL.FLUSH = %CLEAR;

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:104  
   4037  3 000357   000000 236003                    LDQ     0,DU
         3 000360   000021 752106                    STCQ    17,'06'O,PR0

      674     4038    3             CALL M$STRMCTL (FPT_EDTCTL)

   4038  3 000361   000012 630400 1                  EPPR0   FPT_EDTCTL
         3 000362   560000 713400                    CLIMB   alt,+57344
         3 000363   401000 401760                    pmme    nvectors=3
         3 000364   000366 702000 3                  TSX2    s:4039
         3 000365   000370 710000 3                  TRA     s:4042

      675     4039    4             WHENALTRETURN DO; CALL MONERR; END;

   4039  3 000366   000522 701000 3                  TSX1    MONERR
         3 000367   000000 011000                    NOP     0

      676     4040    3           END FLUSH_EDTCTL;

      677     4041
      678     4042    2         IF (WINDOW$SPEC.TRMCTL.FLUSH) THEN

   4042  3 000370   200042 470500                    LDP0    CURRENT_WINDOW$,,AUTO
         3 000371   000017 236100                    LDQ     15,,PR0
         3 000372   777000 316003                    CANQ    -512,DU
         3 000373   000504 600000 3                  TZE     s:4085

      679     4043    2   FLUSH_TRMCTL:
      680     4044    3           DO;

   4044  3 000374                       FLUSH_TRMCTL null
      681     4045
      682     4046    3             VLP_TRMCTL = CONST_VLP_TRMCTL;

   4046  3 000374   000100 100400                    MLR     fill='000'O
         3 000375   000004 000020 2                  ADSC9   CONST_VLP_TRMCTL         cn=0,n=16
         3 000376   200010 000020                    ADSC9   VLP_TRMCTL,,AUTO         cn=0,n=16

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:105  
      683     4047    3             FPT_TRMCTL.TRMCTL_ = VECTOR(VLP_TRMCTL);

   4047  3 000377   000005 235000 4                  LDA     5
         3 000400   200050 452500                    STP2    VD_ERR$+3,,AUTO
         3 000401   200050 236100                    LDQ     VD_ERR$+3,,AUTO
         3 000402   000010 036003                    ADLQ    8,DU
         3 000403   000026 757000 1                  STAQ    FPT_TRMCTL+4

      684     4048    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.AUTOTAB) THEN

   4048  3 000404   000017 234100                    SZN     15,,PR0
         3 000405   000410 605000 3                  TPL     s:4050

      685     4049    3               VLP_TRMCTL.AUTOTABCLM# = WINDOW$SPEC.TRMCTL.AUTOTAB#;

   4049  3 000406   000017 236100                    LDQ     15,,PR0
         3 000407   200012 552104                    STBQ    VLP_TRMCTL+2,'04'O,AUTO

      686     4050    4             IF (WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL) THEN DO;

   4050  3 000410   000017 236100                    LDQ     15,,PR0
         3 000411   200000 316003                    CANQ    65536,DU
         3 000412   000422 600000 3                  TZE     s:4056

      687     4051    4                 IF (WINDOW$SPEC.TRMCTL.HSCROLL# = 0) THEN

   4051  3 000413   000020 220100                    LDX0    16,,PR0
         3 000414   000420 601000 3                  TNZ     s:4054

      688     4052    4                   VLP_TRMCTL.HSSHIFT# = %SCROLL_CENTER#; /* "0" means center */

   4052  3 000415   000177 236003                    LDQ     127,DU
         3 000416   200013 552120                    STBQ    VLP_TRMCTL+3,'20'O,AUTO
         3 000417   000422 710000 3                  TRA     s:4056

      689     4053    4                 ELSE
      690     4054    4                   VLP_TRMCTL.HSSHIFT# = WINDOW$SPEC.TRMCTL.HSCROLL#;
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:106  

   4054  3 000420   000020 236100                    LDQ     16,,PR0
         3 000421   200013 552120                    STBQ    VLP_TRMCTL+3,'20'O,AUTO

      691     4055    4               END;

      692     4056    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL_MARGIN) THEN

   4056  3 000422   000017 236100                    LDQ     15,,PR0
         3 000423   100000 316003                    CANQ    32768,DU
         3 000424   000430 600000 3                  TZE     s:4058

      693     4057    3               VLP_TRMCTL.HSMARGIN# = WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN#;

   4057  3 000425   000020 236100                    LDQ     16,,PR0
         3 000426   000033 736000                    QLS     27
         3 000427   200013 552140                    STBQ    VLP_TRMCTL+3,'40'O,AUTO

      694     4058    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.INSERT_MODE) THEN

   4058  3 000430   000017 236100                    LDQ     15,,PR0
         3 000431   040000 316003                    CANQ    16384,DU
         3 000432   000440 600000 3                  TZE     s:4060

      695     4059    3               VLP_TRMCTL.INSERTMODE# = WINDOW$SPEC.TRMCTL.INSERT_MODE;

   4059  3 000433   000002 376003                    ANQ     2,DU
         3 000434   000015 736000                    QLS     13
         3 000435   200012 676100                    ERQ     VLP_TRMCTL+2,,AUTO
         3 000436   060000 376003                    ANQ     24576,DU
         3 000437   200012 656100                    ERSQ    VLP_TRMCTL+2,,AUTO

      696     4060    3             IF (WINDOW$SPEC.TRMCTL.FLUSH.SCROLL) THEN

   4060  3 000440   000017 236100                    LDQ     15,,PR0
         3 000441   020000 316003                    CANQ    8192,DU
         3 000442   000450 600000 3                  TZE     s:4062
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:107  

      697     4061    3               VLP_TRMCTL.SCROLL# = WINDOW$SPEC.TRMCTL.SCROLL#;

   4061  3 000443   000001 376003                    ANQ     1,DU
         3 000444   000020 736000                    QLS     16
         3 000445   200011 676100                    ERQ     VLP_TRMCTL+1,,AUTO
         3 000446   300000 376003                    ANQ     98304,DU
         3 000447   200011 656100                    ERSQ    VLP_TRMCTL+1,,AUTO

      698     4062    4             IF (WINDOW$SPEC.TRMCTL.FLUSH.WORDWRAP) THEN DO;

   4062  3 000450   000017 236100                    LDQ     15,,PR0
         3 000451   010000 316003                    CANQ    4096,DU
         3 000452   000456 600000 3                  TZE     s:4066

      699     4063    4                 VLP_TRMCTL.WORDWRAPCLM# = WINDOW$SPEC.TRMCTL.WORDWRAP#;

   4063  3 000453   000021 236100                    LDQ     17,,PR0
         3 000454   000011 772000                    QRL     9
         3 000455   200012 552110                    STBQ    VLP_TRMCTL+2,'10'O,AUTO

      700     4064    4               END;

      701     4065
      702     4066    3             IF (WINDOW$SPEC.TRMCTL.HSCROLL# = 0) AND

   4066  3 000456   000020 220100                    LDX0    16,,PR0
         3 000457   000465 601000 3                  TNZ     s:4070
         3 000460   000020 721100                    LXL1    16,,PR0
         3 000461   000465 601000 3                  TNZ     s:4070

      703     4067    3               (WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN# = 0) THEN
      704     4068    3               VLP_TRMCTL.HSCROLL# = %FALSE;

   4068  3 000462   000010 236000 4                  LDQ     8
         3 000463   200012 356100                    ANSQ    VLP_TRMCTL+2,,AUTO
         3 000464   000471 710000 3                  TRA     s:4071
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:108  

      705     4069    3             ELSE
      706     4070    3               VLP_TRMCTL.HSCROLL# = %TRUE;

   4070  3 000465   200012 236100                    LDQ     VLP_TRMCTL+2,,AUTO
         3 000466   000010 376000 4                  ANQ     8
         3 000467   200000 276003                    ORQ     65536,DU
         3 000470   200012 756100                    STQ     VLP_TRMCTL+2,,AUTO

      707     4071    3             FPT_TRMCTL.V.DCB# = WINDOW$SPEC.DCB#;

   4071  3 000471   000014 721100                    LXL1    12,,PR0
         3 000472   000030 741000 1                  STX1    FPT_TRMCTL+6

      708     4072    3             WINDOW$SPEC.TRMCTL.FLUSH = %CLEAR;

   4072  3 000473   000000 236003                    LDQ     0,DU
         3 000474   000017 552140                    STBQ    15,'40'O,PR0

      709     4073
      710     4074    3             CALL M$STRMCTL (FPT_TRMCTL)

   4074  3 000475   000022 630400 1                  EPPR0   FPT_TRMCTL
         3 000476   560000 713400                    CLIMB   alt,+57344
         3 000477   401000 401760                    pmme    nvectors=3
         3 000500   000502 702000 3                  TSX2    s:4075
         3 000501   000504 710000 3                  TRA     s:4085

      711     4075    4             WHENALTRETURN DO; CALL MONERR; END;

   4075  3 000502   000522 701000 3                  TSX1    MONERR
         3 000503   000000 011000                    NOP     0

      712     4076    3           END FLUSH_TRMCTL;

      713     4077
      714     4078        /*N*  IF WINDOW$SPEC.TABS.FLUSH
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:109  
      715     4079              THEN
      716     4080        FLUSH_TABS:
      717     4081                DO;
      718     4082                  \* EH? *\
      719     4083                END FLUSH_TABS;  *N*/
      720     4084
      721     4085    2         WINDOW$ = WINDOW$ -> VD$FILE_NODE.FLINK$;

   4085  3 000504   200043 470500                    LDP0    WINDOW$,,AUTO
         3 000505   000002 236100                    LDQ     2,,PR0
         3 000506   200043 756100                    STQ     WINDOW$,,AUTO

      722     4086    2       END FLUSH_WINDOWS;

   4086  3 000507   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000510   000022 601000 3                  TNZ     s:3925

      723     4087
      724     4088    1       IF VD_$$MON_PRES.V# > 0

   4088  3 000511   000003 235000 xsym               LDA     VD_$$MON_PRES+3
         3 000512   000516 604400 3                  TMOZ    s:4092

      725     4089    1       THEN
      726     4090    1         CALL VDG$MPRES_RETURN;

   4090  3 000513   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000514   000000 701000 xent               TSX1    VDG$MPRES_RETURN
         3 000515   000000 011000                    NOP     0

      727     4091
      728     4092    1       IF HAD_FEP_ERROR

   4092  3 000516   200044 234100                    SZN     HAD_FEP_ERROR,,AUTO
         3 000517   000521 605000 3                  TPL     s:4096

      729     4093    1       THEN
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:110  
      730     4094    1         ALTRETURN;

   4094  3 000520   000000 702200 xent               TSX2  ! X66_AALT

      731     4095
      732     4096    1       RETURN;

   4096  3 000521   000000 702200 xent               TSX2  ! X66_ARET

      733     4097
      734     4098        %EJECT;
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:111  
      735     4099    1   MONERR: PROC;

   4099  3 000522   200046 741300       MONERR       STX1  ! VD_ERR$+1,,AUTO

      736     4100
      737     4101    2       HAD_FEP_ERROR = %TRUE;

   4101  3 000523   400000 236003                    LDQ     -131072,DU
         3 000524   200044 756100                    STQ     HAD_FEP_ERROR,,AUTO

      738     4102    2       CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)

   4102  3 000525   200045 630500                    EPPR0   VD_ERR$,,AUTO
         3 000526   200051 450500                    STP0    VD_ERR$+4,,AUTO
         3 000527   000011 236000 4                  LDQ     9
         3 000530   200050 756100                    STQ     VD_ERR$+3,,AUTO
         3 000531   200050 630500                    EPPR0   VD_ERR$+3,,AUTO
         3 000532   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000533   000000 701000 xent               TSX1    VDG$OALLOC
         3 000534   000536 702000 3                  TSX2    s:4103
         3 000535   000540 710000 3                  TRA     s:4104

      739     4103    3       WHENALTRETURN DO; RETURN; END;

   4103  3 000536   200046 221300                    LDX1  ! VD_ERR$+1,,AUTO
         3 000537   000001 702211                    TSX2  ! 1,X1

      740     4104    2       VD$ERR.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4104  3 000540   000000 470400 xsym               LDP0    B$TCB$
         3 000541   000000 471500                    LDP1    0,,PR0
         3 000542   100102 236100                    LDQ     66,,PR1
         3 000543   200045 473500                    LDP3    VD_ERR$,,AUTO
         3 000544   300002 756100                    STQ     2,,PR3

      741     4105    2       VD$ERR.FLAGLEV# = %FLV_SERIOUS;

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:112  
   4105  3 000545   000003 220003                    LDX0    3,DU
         3 000546   200045 471500                    LDP1    VD_ERR$,,AUTO
         3 000547   100003 740100                    STX0    3,,PR1

      742     4106    2       VD$ERR.DCB# = WINDOW$SPEC.DCB#;

   4106  3 000550   200042 471500                    LDP1    CURRENT_WINDOW$,,AUTO
         3 000551   100014 721100                    LXL1    12,,PR1
         3 000552   200045 473500                    LDP3    VD_ERR$,,AUTO
         3 000553   300004 741100                    STX1    4,,PR3

      743     4107                /*
      744     4108                * We want to continue in spite of error, so that:
      745     4109                *   o TRMCTLs and EDTCTLs get flushed too
      746     4110                *   o All flush flags get reset -- else we'll loop forever
      747     4111                *       trying to flush things that get errors!
      748     4112                */
      749     4113    2       RETURN;

   4113  3 000554   200046 221300                    LDX1  ! VD_ERR$+1,,AUTO
         3 000555   000001 702211                    TSX2  ! 1,X1
      750     4114    2   END MONERR;
      751     4115    1   END VDP$NFLUSH;

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:113  
--  Include file information  --

   VD_MACROS_M.:VDA5TOU  is referenced.
   VDP_MACRO_C.:VDA5TOU  is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDP$NFLUSH.
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:114  

 **** Variables and constants ****

  ****  Section 001  Data  VDP$NFLUSH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(360)   r     1 FPT_DEVICE                12-0-0/d STRC(288)   r     1 FPT_EDTCTL
    22-0-0/d STRC(288)   r     1 FPT_TRMCTL                32-0-0/d STRC(252)   r     1 XUI_IMP

  ****  Section 002 RoData VDP$NFLUSH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(144)   r     1 CONST_VLP_EDTCTL           4-0-0/d STRC(144)   r     1 CONST_VLP_TRMCTL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @UPDATE_SCREEN            42-0-0/w PTR         r     1 CURRENT_WINDOW$
    44-0-0/w BIT         r     1 HAD_FEP_ERROR             *0-0-0/w BIT         r     1 UPDATE_SCREEN
    45-0-0/w PTR         r     1 VD_ERR$                    4-0-0/d STRC(144)   r     1 VLP_EDTCTL
    14-0-0/w STRC(765)   r     1 VLP_HDR                   10-0-0/d STRC(144)   r     1 VLP_TRMCTL
    43-0-0/w PTR         r     1 WINDOW$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(144)   r     1 VD_$$MON_PRES
     0-0-0/w STRC(144)   r     1 VD_$BY                     0-0-0/w STRC(144)   r     1 VD_$SCREEN
     0-0-0/w STRC(22644) r     1 VD_6E                      0-0-0/w UBIN        r     1 VD_SCREEN_HEIGHT

PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:115  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w ASTR(90)    r     1 VD$BUFFER
     0-0-0/w STRC(90)    r     1 VD$BUFFER_HEADER           0-0-0/w STRC(180)   r     1 VD$ERR
     0-0-0/w STRC(468)   r     1 VD$FILE_NODE               0-0-0/w STRC(1944)  r     1 VD$PORT
     0-0-0/w STRC(864)   r     1 VD$STREAM                  0-0-0/w STRC(900)   r     1 WINDOW$SPEC


   Procedure VDP$NFLUSH requires 366 words for executable code.
   Procedure VDP$NFLUSH requires 42 words of local(AUTO) storage.

    No errors detected in file VDP$NAMES.:VDA5TSI    .
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:116  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:117  
          MINI XREF LISTING

B$ALT.CODE
      2881**DCL      2881--REDEF    2882--REDEF    2882--REDEF
B$ALT.ERR
      2882**DCL      4104>>ASSIGN
B$ALT.ERR.ERR#
      2883**DCL      2883--REDEF
B$ALT.EVID
      2882**DCL      2882--REDEF    2882--REDEF
B$TCB.ALT$
      2877**DCL      4104>>ASSIGN
B$TCB$
      2887**DCL      4104>>ASSIGN
CONST_VLP_EDTCTL
      2951**DCL      4004>>ASSIGN
CONST_VLP_TRMCTL
      3033**DCL      4046>>ASSIGN
CONST_VLP_TRMCTL.BREAKCOUNT
      3045**DCL      3045--REDEF
CURRENT_WINDOW$
      3349**DCL      3845--IMP-PTR  3925<<ASSIGN   3927>>IF       3927>>IF       3933>>ASSIGN   3937>>CALL
      3944>>ASSIGN   3947>>IF       3951>>IF       3956>>ASSIGN   3958>>ASSIGN   3962>>ASSIGN   3964>>ASSIGN
      3976>>CALL     3976>>CALL     3982>>ASSIGN   3986>>IF       3986>>ASSIGN   3988>>IF       3989>>ASSIGN
      3990>>ASSIGN   3993>>ASSIGN   3994>>ASSIGN   3994>>ASSIGN   4000>>IF       4007>>IF       4008>>ASSIGN
      4010>>IF       4011>>ASSIGN   4012>>IF       4013>>ASSIGN   4013>>ASSIGN   4015>>IF       4018>>ASSIGN
      4020>>IF       4021>>ASSIGN   4021>>ASSIGN   4023>>ASSIGN   4025>>IF       4026>>ASSIGN   4027>>IF
      4028>>ASSIGN   4029>>IF       4030>>ASSIGN   4031>>IF       4032>>ASSIGN   4033>>IF       4034>>ASSIGN
      4035>>ASSIGN   4036>>ASSIGN   4037>>ASSIGN   4042>>IF       4048>>IF       4049>>ASSIGN   4050>>IF
      4051>>IF       4054>>ASSIGN   4056>>IF       4057>>ASSIGN   4058>>IF       4059>>ASSIGN   4060>>IF
      4061>>ASSIGN   4062>>IF       4063>>ASSIGN   4066>>IF       4066>>IF       4071>>ASSIGN   4072>>ASSIGN
      4106>>ASSIGN
FPT_DEVICE
      2899**DCL      3939<>CALL     3995<>CALL
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:118  
FPT_DEVICE.HDR_
      2899**DCL      3991<<ASSIGN   3997<<ASSIGN
FPT_DEVICE.V
      2900**DCL      2899--DCLINIT
FPT_DEVICE.V.DCB#
      2900**DCL      3933<<ASSIGN   3990<<ASSIGN
FPT_EDTCTL
      2922**DCL      4038<>CALL
FPT_EDTCTL.TRMCTL_
      2928**DCL      4005<<ASSIGN
FPT_EDTCTL.V
      2930**DCL      2924--DCLINIT
FPT_EDTCTL.V.DCB#
      2930**DCL      4036<<ASSIGN
FPT_TRMCTL
      3005**DCL      4074<>CALL
FPT_TRMCTL.TRMCTL_
      3011**DCL      4047<<ASSIGN
FPT_TRMCTL.V
      3013**DCL      3007--DCLINIT
FPT_TRMCTL.V.DCB#
      3013**DCL      4071<<ASSIGN
HAD_FEP_ERROR
      3351**DCL      3921<<ASSIGN   4092>>IF       4101<<ASSIGN
M$DEVICE
        26**DCL-ENT  3939--CALL     3995--CALL
M$STRMCTL
        46**DCL-ENT  4038--CALL     4074--CALL
MONERR
      4099**PROC     3941--CALL     3969--CALL     3996--CALL     4039--CALL     4075--CALL
UPDATE_SCREEN
      3932**LABEL       9--PROC     3927>>IF
VD$BUFFER
      3379**DCL      3976<>CALL
VD$BUFFER.BYTES
      3407**DCL      3956--ASSIGN   3994>>ASSIGN
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:119  
VD$BUFFER.LENGTH#
      3405**DCL      3407--IMP-SIZ  3951>>IF       3962>>ASSIGN   3976>>CALL     3993>>ASSIGN   3994>>ASSIGN
VD$BUFFER.OBJECT.SIZE#
      3403**DCL      3958>>ASSIGN
VD$BUFFER_HEADER
      3420**DCL      3958--ASSIGN
VD$ERR.DCB#
      3537**DCL      4106<<ASSIGN
VD$ERR.ERR
      3532**DCL      3970<<ASSIGN   4104<<ASSIGN
VD$ERR.FLAGLEV#
      3537**DCL      4105<<ASSIGN
VD$FILE_NODE.DESC.SPEC.V$
      3627**DCL      3925>>ASSIGN
VD$FILE_NODE.FLINK$
      3574**DCL      4085>>ASSIGN
VD$FILE_NODE.HEAD$
      3631**DCL      3919>>ASSIGN
VD$PORT.LEVEL.INTERNAL$
      3728**DCL      3919>>ASSIGN
VD$STREAM.PORT$
      3765**DCL      3919>>ASSIGN
VDG$MPRES_FEPDEVICE
      3904**DCL-ENT  3937--CALL
VDG$MPRES_NFLUSH
      3906**DCL-ENT  3913--CALL
VDG$MPRES_RETURN
      3905**DCL-ENT  4090--CALL
VDG$OALLOC
      3907**DCL-ENT  4102--CALL
VDG$OFREE
      3908**DCL-ENT  3976--CALL
VDP$IMP
      3909**DCL-ENT  3966--CALL
VD_$$MON_PRES.V#
      3191**DCL      3911>>IF       3935>>IF       4088>>IF
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:120  
VD_$BY.V#
      3236**DCL      4032>>ASSIGN
VD_$SCREEN.V#
      3281**DCL      3915>>IF
VD_6E.CMD_STREAM$
      3144**DCL      3456--IMP-PTR
VD_6E.WINDOWS$
      3127**DCL      3919>>ASSIGN
VD_ERR$
      3352**DCL      3495--IMP-PTR  3970>>ASSIGN   4102<>CALL     4104>>ASSIGN   4105>>ASSIGN   4106>>ASSIGN
VD_SCREEN_HEIGHT
      3285**DCL      4013>>ASSIGN   4021>>ASSIGN
VLP_EDTCTL
      2979**DCL      4004<<ASSIGN   4005--ASSIGN
VLP_EDTCTL.EASYAPPEND#
      2980**DCL      4030<<ASSIGN
VLP_EDTCTL.HSALL#
      2979**DCL      4026<<ASSIGN
VLP_EDTCTL.KEYINCR#
      2982**DCL      4035<<ASSIGN
VLP_EDTCTL.KEYTYPE#
      2980**DCL      4008<<ASSIGN
VLP_EDTCTL.ONESPACEEDIT#
      2983**DCL      4034<<ASSIGN
VLP_EDTCTL.RCRWRAP#
      2979**DCL      4011<<ASSIGN
VLP_EDTCTL.TEXTEDIT#
      2980**DCL      4028<<ASSIGN
VLP_EDTCTL.VSMARGIN#
      2981**DCL      4023<<ASSIGN
VLP_EDTCTL.VSSHIFT#
      2982**DCL      4016<<ASSIGN   4018<<ASSIGN
VLP_HDR
      3107**DCL      3991--ASSIGN   3992<<ASSIGN
VLP_HDR.TITL.L#
      3109**DCL      3993<<ASSIGN
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:121  
VLP_HDR.TITL.TITLE#
      3110**DCL      3994<<ASSIGN
VLP_TRMCTL
      3073**DCL      4046<<ASSIGN   4047--ASSIGN
VLP_TRMCTL.AUTOTABCLM#
      3089**DCL      4049<<ASSIGN
VLP_TRMCTL.BREAKCOUNT
      3085**DCL      3085--REDEF
VLP_TRMCTL.HSCROLL#
      3085**DCL      4068<<ASSIGN   4070<<ASSIGN
VLP_TRMCTL.HSMARGIN#
      3090**DCL      4057<<ASSIGN
VLP_TRMCTL.HSSHIFT#
      3091**DCL      4052<<ASSIGN   4054<<ASSIGN
VLP_TRMCTL.INSERTMODE#
      3086**DCL      4059<<ASSIGN
VLP_TRMCTL.SCROLL#
      3081**DCL      4061<<ASSIGN
VLP_TRMCTL.WORDWRAPCLM#
      3089**DCL      4063<<ASSIGN
WINDOW$
      3350**DCL      3919<<ASSIGN   3924>>DOWHILE  3925>>ASSIGN   4085<<ASSIGN   4085>>ASSIGN
WINDOW$SPEC.COMMAND
      3871**DCL      3927>>IF       3986>>IF
WINDOW$SPEC.DCB#
      3888**DCL      3933>>ASSIGN   3937<>CALL     3964>>ASSIGN   3990>>ASSIGN   4036>>ASSIGN   4071>>ASSIGN
      4106>>ASSIGN
WINDOW$SPEC.EDTCTL.EZAPPEND#
      3897**DCL      4030>>ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH
      3893**DCL      3986<<ASSIGN   4000>>IF       4037<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.EOFMARK
      3895**DCL      3988>>IF       3989<<ASSIGN
WINDOW$SPEC.EDTCTL.FLUSH.EZAPPEND
      3895**DCL      4029>>IF
WINDOW$SPEC.EDTCTL.FLUSH.HSALL
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:122  
      3894**DCL      4025>>IF
WINDOW$SPEC.EDTCTL.FLUSH.KEY_GENERATION
      3894**DCL      4007>>IF
WINDOW$SPEC.EDTCTL.FLUSH.ONESPACEEDIT
      3895**DCL      4033>>IF
WINDOW$SPEC.EDTCTL.FLUSH.RECWRAP
      3894**DCL      4010>>IF
WINDOW$SPEC.EDTCTL.FLUSH.TEXTEDIT
      3895**DCL      4027>>IF
WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL
      3894**DCL      4012>>IF
WINDOW$SPEC.EDTCTL.FLUSH.VSCROLL_MARGIN
      3894**DCL      4020>>IF
WINDOW$SPEC.EDTCTL.HSALL#
      3896**DCL      4026>>ASSIGN
WINDOW$SPEC.EDTCTL.KEY_GENERATION#
      3897**DCL      4008>>ASSIGN
WINDOW$SPEC.EDTCTL.KEY_INCR#
      3898**DCL      4031>>IF       4032<<ASSIGN   4035>>ASSIGN
WINDOW$SPEC.EDTCTL.ONESPACEEDIT#
      3896**DCL      4034>>ASSIGN
WINDOW$SPEC.EDTCTL.RECORDWRAP
      3896**DCL      4011>>ASSIGN
WINDOW$SPEC.EDTCTL.TEXTEDIT#
      3897**DCL      4028>>ASSIGN
WINDOW$SPEC.EDTCTL.VSCROLL#
      3897**DCL      4013<<ASSIGN   4013>>ASSIGN   4015>>IF       4018>>ASSIGN
WINDOW$SPEC.EDTCTL.VSCROLL_MARGIN#
      3898**DCL      4021<<ASSIGN   4021>>ASSIGN   4023>>ASSIGN
WINDOW$SPEC.EOFMARK$
      3899**DCL      3993>>ASSIGN   3994>>ASSIGN   3994>>ASSIGN
WINDOW$SPEC.KEY_DEFINITION_BUFFER$
      3900**DCL      3947>>IF       3951>>IF       3956>>ASSIGN   3958>>ASSIGN   3962>>ASSIGN   3976>>CALL
      3976>>CALL     3982<<ASSIGN
WINDOW$SPEC.SCREEN_UPDATED
      3889**DCL      3927>>IF       3944<<ASSIGN
PL6.E3A0      #002=VDP$NFLUSH File=VDP$NAMES.:VDA5TSI                            FRI 07/04/97 11:37 Page:123  
WINDOW$SPEC.TRMCTL.AUTOTAB#
      3892**DCL      4049>>ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH
      3890**DCL      4042>>IF       4072<<ASSIGN
WINDOW$SPEC.TRMCTL.FLUSH.AUTOTAB
      3890**DCL      4048>>IF
WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL
      3890**DCL      4050>>IF
WINDOW$SPEC.TRMCTL.FLUSH.HSCROLL_MARGIN
      3890**DCL      4056>>IF
WINDOW$SPEC.TRMCTL.FLUSH.INSERT_MODE
      3891**DCL      4058>>IF
WINDOW$SPEC.TRMCTL.FLUSH.SCROLL
      3891**DCL      4060>>IF
WINDOW$SPEC.TRMCTL.FLUSH.WORDWRAP
      3891**DCL      4062>>IF
WINDOW$SPEC.TRMCTL.HSCROLL#
      3892**DCL      4051>>IF       4054>>ASSIGN   4066>>IF
WINDOW$SPEC.TRMCTL.HSCROLL_MARGIN#
      3893**DCL      4057>>ASSIGN   4066>>IF
WINDOW$SPEC.TRMCTL.INSERT_MODE
      3892**DCL      4059>>ASSIGN
WINDOW$SPEC.TRMCTL.SCROLL#
      3892**DCL      4061>>ASSIGN
WINDOW$SPEC.TRMCTL.WORDWRAP#
      3893**DCL      4063>>ASSIGN
XUI_IMP
      3296**DCL      3346--REDEF    3966<>CALL
XUI_IMP.ERRCODE
      3315**DCL      3970>>ASSIGN
XUI_IMP.IMPDCBNUM#
      3299**DCL      3964<<ASSIGN
XUI_IMP.IMP_BUFFER_
      3296**DCL      3956<<ASSIGN   3958<<ASSIGN
XUI_IMP.IMP_BUFFER_OFFSET
      3296**DCL      3962<<ASSIGN
