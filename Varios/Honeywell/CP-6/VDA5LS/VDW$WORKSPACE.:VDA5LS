VERSION A05

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:1    
        1        1        /*M* VDW$WORKSPACE - Utility for the internal workspace */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* MCR=NO, DMC=YES */
        9        9        /*T*/
       10       10
       11       11
       12       12        /*P* NAME: VDW$WORKSPACE
       13       13            PURPOSE:
       14       14                Utility to LOAD the internal workspace.
       15       15            DESCRIPTION:
       16       16                This module contains two external routines:
       17       17
       18       18                VDW$LOAD
       19       19                Given a workspace file, read it and rebuild its
       20       20                structures in the internal VD$WORKSPACE.  If there are
       21       21                already structures in the VD$WORKSPACE, selectively
       22       22                merge those from the file into the VD$WORKSPACE.
       23       23                Special handling is accorded to:
       24       24                Windows
       25       25                    Under certain conditions the entire internal Windows
       26       26                    file is freed (deleted) before we start loading; under
       27       27                    other conditions, all Windows-file nodes in the
       28       28                    workspace file are ignored (not loaded).
       29       29                Predefined Names-file nodes
       30       30                    Certain predefined names should not appear in
       31       31                    the workspace file:  names whose values are stored
       32       32                    elsewhere in the Windows, Structures, or History
       33       33                    files (e.g., THAT, HERE, CURRENT, $RANGE, $FP, $ENCLOSING, ...).
       34       34                    If these do appear in the workspace file, they are ignored.
       35       35                Predefined Structures-file nodes
       36       36                    Certain predefined Structures should not appear in
       37       37                    the workspace file.  If these do appear in the
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:2    
       38       38                    workspace file, they are ignored.
       39       39                As file nodes are read from the workspace file, they
       40       40                are written to the internal files via the Accessor, since
       41       41                there may be a window open to these files.  The Accessor
       42       42                will take care of updating global values, legal-value
       43       43                checking, protection of certain nodes of internal files
       44       44                against change by the user (in this case, loading entries
       45       45                from the workspace file is considered a change by the user,
       46       46                and is subject to VD$FILE_NODE.ACCESS protection), opening
       47       47                windows and their streams, etc.
       48       48
       49       49                VDW$RESTORE_NODE
       50       50                Given a single node from a workspace or History file,
       51       51                will restore it in it's original location, whether that is
       52       52                in an internal or external file, predefined or user-defined.
       53       53                Will also invoke any side-effects appropriate to the
       54       54                restoration of the node.
       55       55
       56       56                VDW$SAVE
       57       57                Given a stream open to a predefined file and an open SAVE-file, will
       58       58                copy all file-nodes from the predefined file to the SAVE-file in
       59       59                encoded form.
       60       60
       61       61                VDW$STOW_NODE
       62       62                Given a single node in a predefined file, will encode it and write
       63       63                it to a workspace file.
       64       64        */
       65       65
       66       66        /*D* NAME: VDW$LOAD
       67       67            PARAMETERS:
       68       68                LOAD_FLAGS - An ALIGNED array of BIT(1) UNAL flags.  Entries are
       69       69                    accessed using %PDFF_ values as subscripts.  Each bit flag
       70       70                    represents an internal file which may be loaded from the workspace
       71       71                    file; if a bit-flag in LOAD_FLAGS is off and the workspace file
       72       72                    contains a node for that file, we'll ignore the record in the
       73       73                    workspace file.
       74       74            INPUT:
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:3    
       75       75                VD_6E.CMD_STREAM$->VD$CMD_STREAM (the top entry on the
       76       76                    command-stream stack) must specify a workspace file which has
       77       77                    just been opened:  the next read from the file should
       78       78                    read the first record of the file.
       79       79                VD_6E.EQUALS$, .LOCATIONS$, .SYNONYMS$, .KEYINS$,
       80       80                    and .WINDOWS$ must point to open VD$STREAMs
       81       81                    for the Names and Windows internal files.  These files
       82       82                    must initially be empty.
       83       83                VD_6E.STRUCTURES$ must point to a VD$STREAM which is open
       84       84                    to at least a minimal Structures internal file.
       85       85                VD_6E.STRUCTURE_EXTERNAL$, _NAMES$, _STRUCTURES$, and _WINDOWS$
       86       86                    must point to the level-0 VD$FILE_NODEs for the appropriate
       87       87                    predefined entries in the Structures file.
       88       88                VD_$SCREEN is a VD$NUMBER for the $SCREEN predefined name.  It's .V#
       89       89                    must contain the number of lines of the terminal screen which
       90       90                    the user wants 6Edit to use.  (This is only used if we load
       91       91                    windows from the workspace file.)
       92       92            OUTPUT:
       93       93                VD_6E.WS will be loaded from the workspace file.  If any
       94       94                    editing windows were loaded, they have been declared and
       95       95                    their files opened.
       96       96            DESCRIPTION:
       97       97                Read records from the workspace file:  each one contains either:
       98       98                A header record (only the first record):
       99       99                    Save the header record's Spec component in VD_LAST_LOADED_FILE_SPEC.
      100      100                    In the VD$ENCODED_FILE_SPEC is a set of bit-flags (using %PDFF_
      101      101                        offsets) indicating the kinds of file-nodes this workspace
      102      102                        file contains.  If the file contains Windows nodes, and
      103      103                        LOAD_FLAGS says we're allowed to load Windows nodes, then
      104      104                        delete the current Windows file contents:  this will close
      105      105                        down all the current windows.
      106      106                A file node from a predefined file:
      107      107                    Restore the node to it's original predefined file.  This should
      108      108                        have all the side-effects necessary to restore the original
      109      109                        condition of the editor:  windows closed or re-opened, etc.
      110      110                Special handling for VD$WINDOW_SPECs:  Because of the way we tell the
      111      111                    FEP to create windows, we have to do some special-casing for
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:4    
      112      112                    the height of windows created from a workspace file.  As saved
      113      113                    in the workspace file, VD$WINDOW_SPECs contain the exact number
      114      114                    of lines the window is intended to occupy.  But when creating
      115      115                    the window (ie, when calling VDA$LWRITE to write the
      116      116                    VD$WINDOW_SPEC to the Accessor), the VD$WINDOW_SPEC must include
      117      117                    the height not only of itself, but of all windows which follow
      118      118                    it (are below it on the screen).  Therefore, we always create
      119      119                    each window using the entire remaining portion of the screen;
      120      120                    when the next window is created, it will take into account the
      121      121                    intended height of the previous window in order to determine
      122      122                    the "entire remaining portion" it's s'posed to use.
      123      123        */
      124      124
      125      125        VDW$LOAD: PROC (LOAD_FLAGS) ALTRET;
      126      126
      127      127        %INCLUDE VD_MACROS_M;
      128     2342        %INCLUDE VD_PERR_C;
      129     2490        %INCLUDE CP_6;
      130     2571        %INCLUDE CP_6_SUBS;
      131     3111        %INCLUDE B$JIT;
      132     3401
      133     3402
      134     3403    1   DCL 1 LOAD_FLAGS ALIGNED PARAM,
      135     3404              %VD$PDFF (NAME=F, STCLASS=PARAM, LEV=2, LAST=YES);
      136     3418
      137     3419
      138     3420        /*
      139     3421        *   POINTERIZE:  Code to turn a record-offset into a pointer.
      140     3422        *   PTR is the name of the pointer field in the object in ENCODED$NODE
      141     3423        *       which is to be converted from an offset into ENCODED_NODE$
      142     3424        *       into a real pointer.
      143     3425        */
      144     3426
      145     3427        %MACRO POINTERIZE (PTR="Must be supplied", BASE$=ENCODED_NODE$);
      146     3428                IF ADDR(PTR)->BASED$SBIN = 0 THEN
      147     3429                   PTR = ADDR(NIL);
      148     3430                ELSE
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:5    
      149     3431                   PTR = PINCRW(BASE$, ADDR(PTR)->BASED$SBIN);
      150     3432        %MEND;
      151     3433
      152     3434
      153     3435
      154     3436    1   DCL VDI$PREAD_FILE_READ     ENTRY (2) ALTRET;
      155     3437    1   DCL VDA$LDELETE             ENTRY (2) ALTRET;
      156     3438    1   DCL VDA$FCLOSE              ENTRY (1) ALTRET;
      157     3439    1   DCL VDG$ERRMSG              ENTRY (4) ALTRET;
      158     3440    1   DCL VDG$MONERR              ENTRY ALTRET;
      159     3441    1   DCL VDG$WARNMSG             ENTRY (4) ALTRET;
      160     3442    1   DCL VDG$OALLOC              ENTRY (3) ALTRET;
      161     3443    1   DCL VDG$OCOPY               ENTRY (2) ALTRET;
      162     3444    1   DCL VDG$OCOPY_RANGE         ENTRY (2) ALTRET;
      163     3445    1   DCL VDG$OFREE               ENTRY (1) ALTRET;
      164     3446    1   DCL VDG$OCLEAR_RANGE        ENTRY (1) ALTRET;
      165     3447    1   DCL VDW$RESTORE_NODE        ENTRY (3) ALTRET;
      166     3448    1   DCL VDG$EREPORT_ERROR   ENTRY (1);
      167     3449    1   DCL VDG$ESCREECH        ENTRY (3);
      168     3450
      169     3451
      170     3452        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
      171     3488        %VD$KEY (NAME=VD_KEY_NUMERIC_BOF, STCLASS=SYMREF);
      172     3502        %VD_OBJECTS (NAME=VD_OBJECTS, STCLASS=SYMREF);
      173     3542        %VD$NUMBER (NAME=VD_$SCREEN, STCLASS=SYMREF);
      174     3587        %VD$ENCODED_FILE_SPEC (NAME=VD_LAST_LOADED_FILE_SPEC, STCLASS=SYMREF);
      175     3616    1   DCL B$JIT$ PTR SYMREF;
      176     3617    1   DCL M$EI DCB;
      177     3618
      178     3619
      179     3620    1   DCL STREAM$ PTR;
      180     3621    1   DCL EOF BIT(1) ALIGNED;
      181     3622    1   DCL ENCODED_NODE$ PTR;
      182     3623    1   DCL SUM SBIN;
      183     3624    1   DCL BASED_ARRAY$ PTR;
      184     3625    1   DCL I SBIN;
      185     3626    1   DCL PREV_WINDOW_INTENDED_HEIGHT SBIN;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:6    
      186     3627    1   DCL THIS_WINDOW_INTENDED_HEIGHT SBIN;
      187     3628    1   DCL WINDOW_SPEC$ PTR;
      188     3629
      189     3630
      190     3631        %VD$CMD_STREAM (NAME=CMD$STREAM, STCLASS="BASED(VD_6E.CMD_STREAM$)");
      191     3670        %VD$STREAM (NAME=STREAM, STCLASS="BASED(STREAM$)");
      192     3776        %VD$ENCODED_NODE (NAME=ENCODED$NODE, STCLASS="BASED(ENCODED_NODE$)");
      193     3897    1   DCL BASED$ARRAY (0:0) SBIN BASED(BASED_ARRAY$);
      194     3898    1   DCL BASED$SBIN SBIN BASED;
      195     3899        %VD$STREAM (NAME=WINDOWS$STREAM, STCLASS="BASED(VD_6E.WINDOWS$)");
      196     4005        %VD$WINDOW_SPEC (NAME=WINDOW$SPEC, STCLASS="BASED(WINDOW_SPEC$)");
      197     4071        %VD$WINDOW_SPEC;
      198     4137        %VD$PORT;
      199     4235        %VD$BUFFER;
      200     4293        %VD$ERR (NAME=VD$ERR, STCLASS="BASED(VD_6E.ERR_TAIL$)");
      201     4346
      202     4347
      203     4348
      204     4349    1           STREAM$ = ADDR(NIL);
      205     4350    1           PREV_WINDOW_INTENDED_HEIGHT = 0;
      206     4351
      207     4352                /*
      208     4353                *   Build a temporary stream to be used by VDW$RESTORE_NODE
      209     4354                *       for writing external-file nodes.
      210     4355                */
      211     4356    1           CALL VDG$OALLOC (%CLS_STREAM, STREAM$)
      212     4357    1             ALTRET (OALLOC_FAILED);
      213     4358
      214     4359                /*
      215     4360                *   Read, decode, and restore each record from the workspace file.
      216     4361                */
      217     4362
      218     4363    1           CMD$STREAM.REC_NUM# = 0;
      219     4364    1   EACH_WORKSPACE_RECORD:
      220     4365    2           DO UNTIL EOF;
      221     4366    2              CALL VDI$PREAD_FILE_READ (%MXNB_COMMAND, EOF)
      222     4367    2                ALTRET (PREAD_FILE_READ_FAILED);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:7    
      223     4368    2              IF EOF THEN
      224     4369    2                 EXIT EACH_WORKSPACE_RECORD;
      225     4370    2              ENCODED_NODE$ = CMD$STREAM.RECORD$;
      226     4371    2              IF ENCODED$NODE.RECORD_ID ~= %CHR_ENCODED_RECID
      227     4372    2                OR ENCODED$NODE.RECORD_NUM# ~= CMD$STREAM.REC_NUM# THEN
      228     4373    2                 GOTO WS_FILE_INVALID_FAILURE;
      229     4374
      230     4375    2              SUM = 0;
      231     4376    2              BASED_ARRAY$ = PINCRW(ADDR(ENCODED$NODE.CHECKSUM#), 1);
      232     4377    2              DO I =
      233     4378    2                ((ENCODED$NODE.LENGTH# - POFFC(BASED_ARRAY$, ENCODED_NODE$)) /
      234     4379    3                %NB_PER_WORD) DOWNTO 0;
      235     4380    3                 SUM = SUM + BASED$ARRAY (I);
      236     4381    3                 END;
      237     4382    2              IF SUM ~= ENCODED$NODE.CHECKSUM# THEN
      238     4383    2                 GOTO WS_FILE_INVALID_FAILURE;
      239     4384
      240     4385    3              IF ENCODED$NODE.DESC.SPEC.TYPE# = %SPT_ENCODED_FILE_SPEC THEN DO;
      241     4386                      /* This looks like a header record */
      242     4387    3                 IF ENCODED$NODE.RECORD_NUM# ~= 0
      243     4388    3                   OR ENCODED$NODE.DESC.FILE_KEY ~= %CLEAR
      244     4389    3                   OR ENCODED$NODE.DESC.LOCATION ~= %CLEAR
      245     4390    3                   OR ADDR(ENCODED$NODE.DESC.DATA$)->BASED$SBIN ~= 0 THEN
      246     4391    3                    GOTO WS_FILE_INVALID_FAILURE;
      247     4392    3                 CALL HEADER_RECORD (ENCODED$NODE.DESC)
      248     4393    3                   ALTRET (HEADER_RECORD_FAILED);
      249     4394    3                 END;
      250     4395    3              ELSE DO;
      251     4396                      /* This is a file node to restore to its original location */
      252     4397    3                 CALL POINTERIZE_RECORD
      253     4398    3                   ALTRET (POINTERIZE_RECORD_FAILED);
      254     4399
      255     4400    3                 IF LOAD_FLAGS.F (%PDFF_WINDOWS)
      256     4401    3                   AND ENCODED$NODE.DESC.SPEC.TYPE# = %SPT_WINDOW_SPEC THEN
      257     4402    4   ADJUST_WINDOW_HEIGHT: DO;
      258     4403    4                    WINDOW_SPEC$ = ENCODED$NODE.DESC.SPEC.V$;
      259     4404    4                    THIS_WINDOW_INTENDED_HEIGHT = WINDOW$SPEC.COORDS.HEIGHT#;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:8    
      260     4405    4                    IF NOT WINDOWS$STREAM.PORT$->VD$PORT.CURRENT.EOF THEN
      261     4406    4                       WINDOW$SPEC.COORDS.HEIGHT# = MAXIMUM (0,
      262     4407    4                         WINDOWS$STREAM.PORT$ ->
      263     4408    4                         VD$PORT.LEVEL.SPEC.V$ (%LVL_LOWER) ->
      264     4409    4                         VD$WINDOW_SPEC.COORDS.HEIGHT# -
      265     4410    4                         PREV_WINDOW_INTENDED_HEIGHT);
      266     4411    4                    ELSE  /* First window gets entire screen */
      267     4412    4                       WINDOW$SPEC.COORDS.HEIGHT# = VD_$SCREEN.V#;
      268     4413    4                    PREV_WINDOW_INTENDED_HEIGHT = THIS_WINDOW_INTENDED_HEIGHT;
      269     4414    4                    END ADJUST_WINDOW_HEIGHT;
      270     4415
      271     4416    3                 CALL VDW$RESTORE_NODE (STREAM, ENCODED$NODE.DESC, LOAD_FLAGS)
      272     4417    3                   ALTRET (WRESTORE_NODE_FAILED);
      273     4418    3                 END;
      274     4419
      275     4420    2              CMD$STREAM.REC_NUM# = CMD$STREAM.REC_NUM# + 1;
      276     4421    2              END EACH_WORKSPACE_RECORD;
      277     4422
      278     4423    2           IF STREAM$ ~= ADDR(NIL) THEN DO;
      279     4424    2              CALL VDA$FCLOSE (STREAM)
      280     4425    2                ALTRET (FCLOSE_FAILED);
      281     4426    2              CALL VDG$OFREE (STREAM)
      282     4427    2                ALTRET (OFREE_FAILED);
      283     4428    2              END;
      284     4429
      285     4430    1           RETURN;
      286     4431
      287     4432
      288     4433
      289     4434    1   WS_FILE_INVALID_FAILURE:
      290     4435    1           CALL VDG$ERRMSG (%E$BAD_WS_FILE,
      291     4436    1             , BINBIT (CMD$STREAM.REC_NUM#,36)) ALTRET (CLEAN_UP);
      292     4437    1           VD$ERR.DCB# = DCBNUM(M$EI);
      293     4438    1           GOTO CLEAN_UP;
      294     4439
      295     4440
      296     4441    1   POINTERIZE_RECORD_FAILED: ;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:9    
      297     4442    1           CALL VDG$EREPORT_ERROR;
      298     4443    1   LDELETE_FAILED: ;
      299     4444    1   HEADER_RECORD_FAILED: ;
      300     4445    1   PREAD_FILE_READ_FAILED: ;
      301     4446    1   WRESTORE_NODE_FAILED: ;
      302     4447    1   CLEAN_UP:
      303     4448    2           IF STREAM$ ~= ADDR(NIL) THEN DO;
      304     4449    2              CALL VDA$FCLOSE (STREAM)
      305     4450    2                ALTRET (FCLOSE_FAILED);
      306     4451    2              CALL VDG$OFREE (STREAM)
      307     4452    2                ALTRET (OFREE_FAILED);
      308     4453    2              END;
      309     4454    1           ALTRETURN;
      310     4455
      311     4456
      312     4457    1   OALLOC_FAILED: ;
      313     4458    1   OFREE_FAILED: ;
      314     4459    1   FCLOSE_FAILED: ;
      315     4460    1           ALTRETURN;
      316     4461
      317     4462
      318     4463        %BOX (TITLE=POINTERIZE_RECORD, PAGE=YES);
              4471    1
              4475    1   /***************************************************************************
              4477    1    *                                                                         *
              4481    1            *                             POINTERIZE_RECORD                           *
              4483    1            *                                                                         *
              4485    1           ***************************************************************************/

      319     4489
      320     4490        /*I* NAME: POINTERIZE_RECORD
      321     4491            PARAMETERS:
      322     4492                None.
      323     4493            INPUT:
      324     4494                ENCODED$NODE is the VD$ENCODED_NODE for the workspace-file record.
      325     4495            OUTPUT:
      326     4496                ENCODED$NODE's record-offsets will be converted to real pointers.
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:10   
      327     4497                VD_ERR$ - If an error in the record is found, VD_ERR$ will
      328     4498                    point to the allocated VD$ERR for the error.  It's
      329     4499                    first substitution field will contain the %CLS_ code for
      330     4500                    the object in error, as a CLS_NUMBER.
      331     4501            DESCRIPTION:
      332     4502                Loop thru the objects in ENCODED$NODE; in these objects, all
      333     4503                pointers have been stored in the file as word-offsets into
      334     4504                the record of the object pointed-to.  Find these word
      335     4505                offsets, and replace them with pointers to the objects in
      336     4506                the workspace record.
      337     4507        */
      338     4508
      339     4509    1   POINTERIZE_RECORD: PROC ALTRET;
      340     4510
      341     4511
      342     4512    2   DCL OBJECT_HEADER$ PTR;
      343     4513    2   DCL OBJECT_LIMIT$ PTR;
      344     4514    2   DCL I SBIN;
      345     4515
      346     4516
      347     4517        %VD$OBJECT_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
      348     4539        %VD$WINDOW_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
      349     4605        %VD$WINDOW_BLOCK (STCLASS="BASED(OBJECT_HEADER$)");
      350     4642        %VD$RECORD_SET (STCLASS="BASED(OBJECT_HEADER$)");
      351     4720        %VD$STRUCTURE_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
      352     4757        %VD$IT_ADJUST (STCLASS="BASED(OBJECT_HEADER$)");
      353     4794        %VD$IT_BLOCK_EXPR (STCLASS="BASED(OBJECT_HEADER$)");
      354     4944        %VD$IT_COMMAND (STCLASS="BASED(OBJECT_HEADER$)");
      355     4982        %VD$IT_OPERAND (STCLASS="BASED(OBJECT_HEADER$)");
      356     5048        %VD$IT_OPERATOR (STCLASS="BASED(OBJECT_HEADER$)");
      357     5085        %VD$IT_SELECT (STCLASS="BASED(OBJECT_HEADER$)");
      358     5122        %VD$BLOCK_DESC (STCLASS="BASED(OBJECT_HEADER$)");
      359     5269        %VD$BUFFER (STCLASS="BASED(OBJECT_HEADER$)");
      360     5327        %VD$BUFFER_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
      361     5363        %VD$STRING_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
      362     5399        %VD$PATTERN (STCLASS="BASED(OBJECT_HEADER$)");
      363     5450        %VD$EVAL (STCLASS="BASED(OBJECT_HEADER$)");
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:11   
      364     5695        %VD$FIT (STCLASS="BASED(OBJECT_HEADER$)");
      365     5731        %VD$POINTER (STCLASS="BASED(OBJECT_HEADER$)");
      366     5776
      367     5777
      368     5778
      369     5779    3           IF ENCODED$NODE.DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;
      370     5780                   %POINTERIZE (PTR=ENCODED$NODE.DESC.FILE_KEY.V$);
      371     5786    3              END;
      372     5787    2           CALL POINTERIZE_LOCATION (ENCODED$NODE.DESC.LOCATION);
      373     5788    3           IF ENCODED$NODE.DESC.SPEC.REP# = %REP_REMOTE THEN DO;
      374     5789                   %POINTERIZE (PTR=ENCODED$NODE.DESC.SPEC.V$);
      375     5795    3              END;
      376     5796                %POINTERIZE (PTR=ENCODED$NODE.DESC.DATA$);
      377     5802
      378     5803
      379     5804    2           OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));
      380     5805    2           OBJECT_LIMIT$ = PINCRC(ADDR(ENCODED_NODE$->VD$BUFFER.BYTES),
      381     5806    2             ENCODED$NODE.LENGTH#);
      382     5807
      383     5808    2   EACH_OBJECT:
      384     5809    3           DO WHILE (POFFW(OBJECT_LIMIT$, OBJECT_HEADER$) > 0);
      385     5810
      386     5811    3   OBJECT_TYPE_CASES:
      387     5812    4              DO CASE (VD$OBJECT_HEADER.CLASS#);
      388     5813
      389     5814    4               CASE (%CLS_TEXTC_REMOTE, %CLS_FILE_KEY, %CLS_NAME_SPEC,
      390     5815    4                %CLS_STRUCTURE_LEVEL);
      391     5816                      %POINTERIZE (PTR=VD$STRING_HEADER.FLINK$);
      392     5822
      393     5823    4               CASE (%CLS_BUFFER, %CLS_NUMBER, %CLS_BOOLEAN, %CLS_FILE_STCLASS,
      394     5824    4                   %CLS_ORG, %CLS_KEY_TYPE, %CLS_EXIST, %CLS_NAME_DATA_TYPE,
      395     5825    4                   %CLS_COMPONENT, %CLS_POINT, %CLS_DIRECTION, %CLS_PROTECT);
      396     5826                      %POINTERIZE (PTR=VD$BUFFER_HEADER.FLINK$);
      397     5832
      398     5833    4               CASE (%CLS_WINDOW_SPEC);
      399     5834                      %POINTERIZE (PTR=VD$WINDOW_SPEC.FLINK$);
      400     5840    4                 VD$WINDOW_SPEC.OPERAND.STREAM$ = ADDR(NIL);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:12   
      401     5841                      %POINTERIZE (PTR=VD$WINDOW_SPEC.OPERAND.INTREE$);
      402     5847                      %POINTERIZE (PTR=VD$WINDOW_SPEC.OPERAND.EDIT_BLOCK$);
      403     5853                      %POINTERIZE (PTR=VD$WINDOW_SPEC.OPERAND.EVAL$);
      404     5859                      %POINTERIZE (PTR=VD$WINDOW_SPEC.RECORD_SET$);
      405     5865                      %POINTERIZE (PTR=VD$WINDOW_SPEC.KEY_DEFINITION_BUFFER$);
      406     5871                      %POINTERIZE (PTR=VD$WINDOW_SPEC.TABS$);
      407     5877    5                 IF VD$WINDOW_SPEC.EOFMARK$~=ADDR(NIL) THEN DO;
      408     5878                         %POINTERIZE (PTR=VD$WINDOW_SPEC.EOFMARK$);
      409     5884    5                    END;
      410     5885
      411     5886    4               CASE (%CLS_WINDOW_BLOCK);
      412     5887                      %POINTERIZE (PTR=VD$WINDOW_BLOCK.FLINK$);
      413     5893                      %POINTERIZE (PTR=VD$WINDOW_BLOCK.EDIT_BLOCK$);
      414     5899                      %POINTERIZE (PTR=VD$WINDOW_BLOCK.EVAL$);
      415     5905
      416     5906    4               CASE (%CLS_RECORD_SET);
      417     5907    5                 DO I = 0 TO (VD$RECORD_SET.N_ENTRIES# - 1);
      418     5908    6                    IF VD$RECORD_SET.DESC.KEY.REP# (I) = %REP_REMOTE THEN DO;
      419     5909                            %POINTERIZE (PTR="VD$RECORD_SET.DESC.KEY.V$ (I)");
      420     5915    6                       END;
      421     5916    5                    END;
      422     5917
      423     5918    4               CASE (%CLS_STRUCTURE_SPEC);
      424     5919                      %POINTERIZE (PTR=VD$STRUCTURE_SPEC.FLINK$);
      425     5925                      %POINTERIZE (PTR=VD$STRUCTURE_SPEC.ACCESSOR$);
      426     5931                      %POINTERIZE (PTR=VD$STRUCTURE_SPEC.FIT$);
      427     5937
      428     5938    4               CASE (%CLS_IT_ADJUST);
      429     5939                      %POINTERIZE (PTR=VD$IT_ADJUST.PARENT$);
      430     5945                      %POINTERIZE (PTR=VD$IT_ADJUST.FLINK$);
      431     5951                      %POINTERIZE (PTR=VD$IT_ADJUST.MOVEMENTS$);
      432     5957                      %POINTERIZE (PTR=VD$IT_ADJUST.MOVEMENTS_TAIL$);
      433     5963
      434     5964    4               CASE (%CLS_IT_BLOCK_EXPR);
      435     5965                      %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.FLINK$);
      436     5971    5                 IF VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.REP# = %REP_REMOTE THEN DO;
      437     5972                         %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.V$);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:13   
      438     5978    5                    END;
      439     5979    4                 CALL POINTERIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.START);
      440     5980    4                 CALL POINTERIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.ENDD);
      441     5981    4                 VD$IT_BLOCK_EXPR.OPTIONS.STRUCTURE$ = ADDR(NIL);
      442     5982    5                 IF VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;
      443     5983                         %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.V$);
      444     5989    5                    END;
      445     5990                      %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.SELECTS$);
      446     5996                      %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.SELECTS_TAIL$);
      447     6002
      448     6003    4               CASE (%CLS_IT_COMMAND);
      449     6004                      %POINTERIZE (PTR=VD$IT_COMMAND.PARENT$);
      450     6010                      %POINTERIZE (PTR=VD$IT_COMMAND.FLINK$);
      451     6016    5                 DO I = 0 TO %MX_COMMAND_PARAMS-1;
      452     6017                         %POINTERIZE (PTR="VD$IT_COMMAND.PARAM$ (I)");
      453     6023    5                    END;
      454     6024
      455     6025    4               CASE (%CLS_IT_OPERAND);
      456     6026                      %POINTERIZE (PTR=VD$IT_OPERAND.PARENT$);
      457     6032                      %POINTERIZE (PTR=VD$IT_OPERAND.FLINK$);
      458     6038    5                 IF VD$IT_OPERAND.KEY.REP# = %REP_REMOTE THEN DO;
      459     6039                         %POINTERIZE (PTR=VD$IT_OPERAND.KEY.V$);
      460     6045    5                    END;
      461     6046                      %POINTERIZE (PTR=VD$IT_OPERAND.PARAM$);
      462     6052
      463     6053    4               CASE (%CLS_IT_OPERATOR);
      464     6054                      %POINTERIZE (PTR=VD$IT_OPERATOR.PARENT$);
      465     6060                      %POINTERIZE (PTR=VD$IT_OPERATOR.FLINK$);
      466     6066                      %POINTERIZE (PTR=VD$IT_OPERATOR.OPERAND$);
      467     6072                      %POINTERIZE (PTR=VD$IT_OPERATOR.R_OPERAND$);
      468     6078
      469     6079    4               CASE (%CLS_IT_SELECT);
      470     6080                      %POINTERIZE (PTR=VD$IT_SELECT.PARENT$);
      471     6086                      %POINTERIZE (PTR=VD$IT_SELECT.FLINK$);
      472     6092                      %POINTERIZE (PTR=VD$IT_SELECT.ADJUSTS$);
      473     6098                      %POINTERIZE (PTR=VD$IT_SELECT.ADJUSTS_TAIL$);
      474     6104
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:14   
      475     6105    4               CASE (%CLS_BLOCK_DESC, %CLS_BLOCK_BUFFER);
      476     6106    5                 IF VD$OBJECT_HEADER.CLASS# = %CLS_BLOCK_BUFFER THEN DO;
      477     6107                         %POINTERIZE (PTR=VD$BUFFER_HEADER.FLINK$);
      478     6113    5                    OBJECT_HEADER$ = PALIGNW(ADDR(VD$BUFFER.BYTES));
      479     6114    5                    END;
      480     6115    5                 IF VD$BLOCK_DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;
      481     6116                         %POINTERIZE (PTR=VD$BLOCK_DESC.FILE_KEY.V$);
      482     6122    5                    END;
      483     6123    4                 CALL POINTERIZE_LOCATION (VD$BLOCK_DESC.RANGE.START);
      484     6124    4                 CALL POINTERIZE_LOCATION (VD$BLOCK_DESC.RANGE.ENDD);
      485     6125                      %POINTERIZE (PTR=VD$BLOCK_DESC.OPTIONS.STRUCTURE$);
      486     6131    5                 IF VD$BLOCK_DESC.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;
      487     6132                         %POINTERIZE (PTR=VD$BLOCK_DESC.OPTIONS.KEY_INCR.V$);
      488     6138    5                    END;
      489     6139
      490     6140    4               CASE (%CLS_PATTERN);
      491     6141    5                 DO I = 0 TO VD$PATTERN.N_ENTRIES# - 1;
      492     6142                         %POINTERIZE (PTR="VD$PATTERN.ENTRIES.MATCH$ (I)");
      493     6148    5                    END;
      494     6149
      495     6150    4               CASE (%CLS_EVAL);
      496     6151                      %POINTERIZE (PTR=VD$EVAL.BLINK$);
      497     6157    4                 CALL POINTERIZE_LOCATION (VD$EVAL.ENCLOSING.START);
      498     6158    4                 CALL POINTERIZE_LOCATION (VD$EVAL.ENCLOSING.ENDD);
      499     6159    4                 CALL POINTERIZE_LOCATION (VD$EVAL.RANGE.START);
      500     6160    4                 CALL POINTERIZE_LOCATION (VD$EVAL.RANGE.ENDD);
      501     6161        /*N**N**N* How do we pointerize VD$EVAL.NODE$?  It can't be stored
      502     6162        **N**N**N*  in the same record.  Maybe store a "walking index":
      503     6163        **N**N**N*  count of # of node when walking the InTree?
      504     6164        **N**N**N*/
      505     6165
      506     6166    4               CASE (%CLS_FIT);
      507     6167                      %POINTERIZE (PTR=VD$FIT.CODE2$);
      508     6173                      %POINTERIZE (PTR=VD$FIT.CODE3$);
      509     6179
      510     6180    4               CASE (%CLS_PTR_BLOCK_DESC, %CLS_PTR_FILE_NODE,
      511     6181    4                   %CLS_PTR_INTREE, %CLS_PTR_KEY, %CLS_PTR_LOCATION, %CLS_PTR_TEXTC);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:15   
      512     6182                      %POINTERIZE (PTR=VD$POINTER.FLINK$);
      513     6188                      %POINTERIZE (PTR=VD$POINTER.V$);
      514     6194
      515     6195    4               CASE (%CLS_CMD_STREAM, %CLS_ENCODED_NODE, %CLS_DIR_NODE,
      516     6196    4                   %CLS_FILE_NODE, %CLS_STREAM, %CLS_PORT, ELSE);
      517     6197                      /* Invalid object class stored in workspace record */
      518     6198    4                 GOTO WS_FILE_INVALID_FAILURE;
      519     6199
      520     6200    4               END OBJECT_TYPE_CASES;
      521     6201
      522     6202    3              IF VD$OBJECT_HEADER.SIZE# = 0 THEN
      523     6203    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,
      524     6204    3                   VD_OBJECTS.SIZE (VD$OBJECT_HEADER.CLASS#));
      525     6205    3              ELSE
      526     6206    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,
      527     6207    3                   VD$OBJECT_HEADER.SIZE#);
      528     6208    3              END EACH_OBJECT;
      529     6209
      530     6210    2           OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));
      531     6211
      532     6212    2   EACH_OBJECT_AGAIN:
      533     6213    3           DO WHILE (POFFW(OBJECT_LIMIT$, OBJECT_HEADER$) > 0);
      534     6214
      535     6215    3   OBJECT_TYPE_CASES_AGAIN:
      536     6216    4              DO CASE (VD$OBJECT_HEADER.CLASS#);
      537     6217
      538     6218    4               CASE (%CLS_BLOCK_DESC, %CLS_BLOCK_BUFFER);
      539     6219    4                 IF VD$OBJECT_HEADER.CLASS# = %CLS_BLOCK_BUFFER THEN
      540     6220    4                    OBJECT_HEADER$ = PALIGNW(ADDR(VD$BUFFER.BYTES));
      541     6221    4                 CALL POINTERIZE_STRUCTURE (VD$BLOCK_DESC.OPTIONS.STRUCTURE$);
      542     6222
      543     6223    4               CASE (%CLS_PTR_FILE_NODE);
      544     6224    4                 CALL POINTERIZE_STRUCTURE (VD$POINTER.V$);
      545     6225
      546     6226    4               CASE (ELSE);
      547     6227
      548     6228    4               END OBJECT_TYPE_CASES_AGAIN;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:16   
      549     6229
      550     6230    3              IF VD$OBJECT_HEADER.SIZE# = 0 THEN
      551     6231    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,
      552     6232    3                   VD_OBJECTS.SIZE (VD$OBJECT_HEADER.CLASS#));
      553     6233    3              ELSE
      554     6234    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,
      555     6235    3                   VD$OBJECT_HEADER.SIZE#);
      556     6236    3              END EACH_OBJECT_AGAIN;
      557     6237
      558     6238    2           RETURN;
      559     6239
      560     6240
      561     6241
      562     6242    2   INVALID_WORKSPACE_FAILURE: ;
      563     6243    2   WS_FILE_INVALID_FAILURE: ;
      564     6244    2           CALL VDG$ERRMSG (%E$BAD_WS_FILE, BINBIT (VD$OBJECT_HEADER.CLASS#, 36),
      565     6245    3             BINBIT(CMD$STREAM.REC_NUM#, 36)) WHENRETURN DO;
      566     6246    3              VD$ERR.DCB# = DCBNUM(M$EI);
      567     6247    3              END;
      568     6248    2           ALTRETURN;
      569     6249
      570     6250        %BOX (TITLE=POINTERIZE_STRUCTURE);

              6262    2   /***************************************************************************
              6264    2    *                                                                         *
              6268    2            *                            POINTERIZE_STRUCTURE                         *
              6270    2            *                                                                         *
              6272    2           ***************************************************************************/

      571     6276
      572     6277        /*I* NAME: POINTERIZE_STRUCTURE
      573     6278            PARAMETERS:
      574     6279                STRUCTURE, actually an index into a VD$ENCODED_NODE, possibly zero.
      575     6280            INPUT:
      576     6281                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing STRUCTURE.
      577     6282            OUTPUT:
      578     6283                STRUCTURE resolved to a pointer into the STRUCTURES internal file.
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:17   
      579     6284            DESCRIPTION:
      580     6285                If STRUCTURE ~= 0, read the key which STRUCTURE "indexes" to from
      581     6286                the internal STRUCTURES file, and place the address of that
      582     6287                VD$FILE_NODE into STRUCTURE.
      583     6288        */
      584     6289
      585     6290    2   POINTERIZE_STRUCTURE: PROC (STRUCTURE) ALTRET;
      586     6291
      587     6292    3   DCL STRUCTURE PTR PARAM;
      588     6293
      589     6294    3   DCL VDA$LREAD               ENTRY (4) ALTRET;
      590     6295
      591     6296        %VD$BLOCK_DESC;
      592     6443        %VD$BUFFER;
      593     6501        %VD$PORT;
      594     6599        %VD$STREAM;
      595     6705
      596     6706
      597     6707             /* %POINTERIZE (PTR=STRUCTURE); */
      598     6708    3           IF STRUCTURE ~= ADDR(NIL) THEN
      599     6709    3   READ_THE_STRUCTURES_FILE:
      600     6710    4           DO;
      601     6711    4              CALL VDA$LREAD (VD_6E.STRUCTURES$->VD$STREAM,
      602     6712    4                STRUCTURE->VD$BLOCK_DESC.RANGE.START, 0, %TRUE)
      603     6713    5              WHENALTRETURN DO; ALTRETURN; END;
      604     6714    4              IF VD_6E.STRUCTURES$->VD$STREAM.CURRENT.EOF = %TRUE THEN
      605     6715    4                 CALL VDG$ESCREECH;
      606     6716    4              STRUCTURE = VD_6E.STRUCTURES$->VD$STREAM.PORT$->
      607     6717    4                VD$PORT.LEVEL.INTERNAL$ (%LVL_LOWER);
      608     6718    4              END READ_THE_STRUCTURES_FILE;
      609     6719
      610     6720    3           RETURN;
      611     6721
      612     6722    3   END POINTERIZE_STRUCTURE;
      613     6723
      614     6724        %BOX (TITLE=POINTERIZE_LOCATION);

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:18   
              6736    3   /***************************************************************************
              6738    3    *                                                                         *
              6742    3            *                            POINTERIZE_LOCATION                          *
              6744    3            *                                                                         *
              6746    3           ***************************************************************************/

      615     6750
      616     6751        /*I* NAME: POINTERIZE_LOCATION
      617     6752            PARAMETERS:
      618     6753                LOCATION - VD$LOCATION to pointerize.
      619     6754            INPUT:
      620     6755                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing LOCATION.
      621     6756            OUTPUT:
      622     6757                LOCATION's pointers will be resolved into actual pointers.
      623     6758            DESCRIPTION:
      624     6759                Go thru LOCATION's levels, and pointerize any offsets found.
      625     6760        */
      626     6761
      627     6762    2   POINTERIZE_LOCATION: PROC (LOCATION) ALTRET;
      628     6763
      629     6764        %VD$LOCATION (NAME=LOCATION, STCLASS=PARAM);
      630     6792
      631     6793
      632     6794    3   DCL LVL SBIN;
      633     6795
      634     6796
      635     6797
      636     6798    4           DO LVL = 0 TO (%(MX_LOCATION_LEVELS-1));
      637     6799    5              IF LOCATION.KEY.REP# (LVL) = %REP_REMOTE THEN DO;
      638     6800                      %POINTERIZE (PTR="LOCATION.KEY.V$ (LVL)");
      639     6806    5                 END;
      640     6807    4              END;
      641     6808    3           RETURN;
      642     6809
      643     6810    3   END POINTERIZE_LOCATION;
      644     6811
      645     6812    2   END POINTERIZE_RECORD;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:19   
      646     6813
      647     6814        %BOX (TITLE=HEADER_RECORD, PAGE=YES);
              6822    2
              6826    2   /***************************************************************************
              6828    2    *                                                                         *
              6832    2            *                               HEADER_RECORD                             *
              6834    2            *                                                                         *
              6836    2           ***************************************************************************/

      648     6840
      649     6841        /*I* NAME:  HEADER_RECORD
      650     6842            PARAMETERS:
      651     6843                DESC - VD$ENCODED_DESC for the header record of a workspace file.
      652     6844                    It's .SPEC.TYPE# must be %SPT_ENCODED_FILE_SPEC.
      653     6845                                    !! CAUTION !!
      654     6846                        DESC is assumed to be unPOINTERIZEd:  its
      655     6847                        .SPEC.V$ isn't a pointer, but a word-offset
      656     6848                        from ENCODED_NODE$.
      657     6849            INPUT:
      658     6850                LOAD_FLAGS - An array of bits specifying which predefined files we're
      659     6851                    allowed to load from the workspace file.
      660     6852                ENCODED_NODE$ - Pointer to the VD$ENCODED_NODE read from the
      661     6853                    workspace file.
      662     6854            OUTPUT:
      663     6855                VD_LAST_LOADED_FILE_SPEC will contain DESC's VD$ENCODED_FILE_SPEC.
      664     6856                The entire contents of the Windows file may have been deleted.
      665     6857            DESCRIPTION:
      666     6858                Save DESC's Spec component in the global VD_LAST_LOADED_FILE_SPEC.
      667     6859                Check the bits in the ENCODED_FILE_SPEC indicating what types of
      668     6860                info is in the workspace file:
      669     6861                    If the workspace file contains Windows-file nodes, and LOAD_FLAGS
      670     6862                        says we're allowed to load Windows-file nodes, then delete the
      671     6863                        entire contents of the Windows file now, before we load the
      672     6864                        workspace file.
      673     6865                    If the workspace file contains Keyins, and LOAD_FLAGS says we're
      674     6866                        allowed to load Keyins, but the user's current terminal profile
      675     6867                        isn't the same as the terminal profile at the time the
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:20   
      676     6868                        workspace file was last modified, then warn the user.
      677     6869        */
      678     6870
      679     6871    1   HEADER_RECORD: PROC (DESC) ALTRET;
      680     6872
      681     6873        %VD$ENCODED_DESC (NAME=DESC, STCLASS=PARAM);
      682     6957
      683     6958
      684     6959        %FPT_GLINEATTR (STCLASS=STATIC, DCB=M$UC);
      685     6984
      686     6985
      687     6986
      688     6987        %VD$RANGE (NAME=DEL_FILE_RANGE, STCLASS=AUTO);
      689     7056        %VLP_LINEATTR (STCLASS=AUTO);
      690     7078        %VD$ENCODED_FILE_SPEC;
      691     7107
      692     7108
      693     7109
      694     7110    2           VD_LAST_LOADED_FILE_SPEC =
      695     7111    2             PINCRW(ENCODED_NODE$, ADDR(DESC.SPEC.V$)->BASED$SBIN) ->
      696     7112    2             VD$ENCODED_FILE_SPEC;
      697     7113
      698     7114    2           IF VD_LAST_LOADED_FILE_SPEC.CONTENTS (%PDFF_WINDOWS)
      699     7115    3             AND LOAD_FLAGS.F (%PDFF_WINDOWS) THEN DO;
      700     7116    3              DEL_FILE_RANGE = %CLEAR;
      701     7117    3              DEL_FILE_RANGE.START.KEY (%LVL_LOWER-1) =
      702     7118    3                VD_KEY_NUMERIC_BOF;   /* Windows-file keys are numeric */
      703     7119    3              DEL_FILE_RANGE.ENDD.EOF = %TRUE;
      704     7120    3              CALL VDA$LDELETE (WINDOWS$STREAM, DEL_FILE_RANGE)
      705     7121    3                ALTRET (LDELETE_FAILED);
      706     7122    3              END;
      707     7123
      708     7124    2           IF VD_LAST_LOADED_FILE_SPEC.CONTENTS (%PDFF_KEYINS)
      709     7125    2             AND LOAD_FLAGS.F (%PDFF_KEYINS)
      710     7126    3             AND B$JIT.MODE = %M_INT# THEN DO;
      711     7127    3              FPT_GLINEATTR.LINEATTR_ = VECTOR(VLP_LINEATTR);
      712     7128    3              CALL M$GLINEATTR (FPT_GLINEATTR)
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:21   
      713     7129    3                ALTRET (GLINEATTR_FAILED);
      714     7130    3              IF SUBSTR(VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE.BYTES, 0,
      715     7131    3                VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE.LENGTH#) ~=
      716     7132    3                SUBSTR(VLP_LINEATTR.PROTXTC.TXT, 0,
      717     7133    4                VLP_LINEATTR.PROTXTC.CNT) THEN DO;
      718     7134    4                 CALL VDG$WARNMSG (%E$WARN_SAVED_W_DIFF_PROFILE,
      719     7135    4                   VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE,
      720     7136    4                   VLP_LINEATTR.PROTXTC);
      721     7137    4                 CALL VDG$EREPORT_ERROR;
      722     7138    4                 END;
      723     7139    3              END;
      724     7140
      725     7141    2           RETURN;
      726     7142
      727     7143
      728     7144    2   GLINEATTR_FAILED:
      729     7145    2           CALL VDG$MONERR;
      730     7146    2           ALTRETURN;
      731     7147
      732     7148
      733     7149    2   LDELETE_FAILED: ;
      734     7150    2   OALLOC_FAILED: ;
      735     7151    2           ALTRETURN;
      736     7152
      737     7153    2   END HEADER_RECORD;
      738     7154
      739     7155
      740     7156    1   END VDW$LOAD;
      741     7157        %EOD;

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:22   
--  Include file information  --

   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDW$LOAD.

   Procedure VDW$LOAD requires 1130 words for executable code.
   Procedure VDW$LOAD requires 56 words of local(AUTO) storage.

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:23   

 Object Unit name= VDW$LOAD                                   File name= VDW$WORKSPACE.:VDA5TOU
 UTS= JUL 04 '97 11:41:42.72 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   Data  even  none     8     10  VDW$LOAD
    3  RoData even  UTS      4      4  VDW$LOAD
    4   Proc  even  none  1130   2152  VDW$LOAD
    5  RoData even  none    14     16  VDW$LOAD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  VDW$LOAD
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 VDG$OALLOC
         yes           Std       1 VDG$EREPORT_ERROR
 yes     yes           Std       2 VDI$PREAD_FILE_READ
 yes     yes           Std       3 VDW$RESTORE_NODE
 yes     yes           Std       1 VDA$FCLOSE
 yes     yes           Std       1 VDG$OFREE
 yes     yes           Std       4 VDG$ERRMSG
 yes     yes           Std       4 VDA$LREAD
         yes           Std       3 VDG$ESCREECH
 yes     yes           Std       2 VDA$LDELETE
 yes     yes           Std       0 VDG$MONERR
 yes     yes           Std       4 VDG$WARNMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VD_6E                                 VD_KEY_NUMERIC_BOF
     VD_OBJECTS                            VD_$SCREEN                            VD_LAST_LOADED_FILE_SPEC
     B$JIT$                                M$EI                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:25   


        1        1        /*M* VDW$WORKSPACE - Utility for the internal workspace */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* MCR=NO, DMC=YES */
        9        9        /*T*/
       10       10
       11       11
       12       12        /*P* NAME: VDW$WORKSPACE
       13       13            PURPOSE:
       14       14                Utility to LOAD the internal workspace.
       15       15            DESCRIPTION:
       16       16                This module contains two external routines:
       17       17
       18       18                VDW$LOAD
       19       19                Given a workspace file, read it and rebuild its
       20       20                structures in the internal VD$WORKSPACE.  If there are
       21       21                already structures in the VD$WORKSPACE, selectively
       22       22                merge those from the file into the VD$WORKSPACE.
       23       23                Special handling is accorded to:
       24       24                Windows
       25       25                    Under certain conditions the entire internal Windows
       26       26                    file is freed (deleted) before we start loading; under
       27       27                    other conditions, all Windows-file nodes in the
       28       28                    workspace file are ignored (not loaded).
       29       29                Predefined Names-file nodes
       30       30                    Certain predefined names should not appear in
       31       31                    the workspace file:  names whose values are stored
       32       32                    elsewhere in the Windows, Structures, or History
       33       33                    files (e.g., THAT, HERE, CURRENT, $RANGE, $FP, $ENCLOSING, ...).
       34       34                    If these do appear in the workspace file, they are ignored.
       35       35                Predefined Structures-file nodes
       36       36                    Certain predefined Structures should not appear in
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:26   
       37       37                    the workspace file.  If these do appear in the
       38       38                    workspace file, they are ignored.
       39       39                As file nodes are read from the workspace file, they
       40       40                are written to the internal files via the Accessor, since
       41       41                there may be a window open to these files.  The Accessor
       42       42                will take care of updating global values, legal-value
       43       43                checking, protection of certain nodes of internal files
       44       44                against change by the user (in this case, loading entries
       45       45                from the workspace file is considered a change by the user,
       46       46                and is subject to VD$FILE_NODE.ACCESS protection), opening
       47       47                windows and their streams, etc.
       48       48
       49       49                VDW$RESTORE_NODE
       50       50                Given a single node from a workspace or History file,
       51       51                will restore it in it's original location, whether that is
       52       52                in an internal or external file, predefined or user-defined.
       53       53                Will also invoke any side-effects appropriate to the
       54       54                restoration of the node.
       55       55
       56       56                VDW$SAVE
       57       57                Given a stream open to a predefined file and an open SAVE-file, will
       58       58                copy all file-nodes from the predefined file to the SAVE-file in
       59       59                encoded form.
       60       60
       61       61                VDW$STOW_NODE
       62       62                Given a single node in a predefined file, will encode it and write
       63       63                it to a workspace file.
       64       64        */
       65       65
       66       66        /*D* NAME: VDW$LOAD
       67       67            PARAMETERS:
       68       68                LOAD_FLAGS - An ALIGNED array of BIT(1) UNAL flags.  Entries are
       69       69                    accessed using %PDFF_ values as subscripts.  Each bit flag
       70       70                    represents an internal file which may be loaded from the workspace
       71       71                    file; if a bit-flag in LOAD_FLAGS is off and the workspace file
       72       72                    contains a node for that file, we'll ignore the record in the
       73       73                    workspace file.
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:27   
       74       74            INPUT:
       75       75                VD_6E.CMD_STREAM$->VD$CMD_STREAM (the top entry on the
       76       76                    command-stream stack) must specify a workspace file which has
       77       77                    just been opened:  the next read from the file should
       78       78                    read the first record of the file.
       79       79                VD_6E.EQUALS$, .LOCATIONS$, .SYNONYMS$, .KEYINS$,
       80       80                    and .WINDOWS$ must point to open VD$STREAMs
       81       81                    for the Names and Windows internal files.  These files
       82       82                    must initially be empty.
       83       83                VD_6E.STRUCTURES$ must point to a VD$STREAM which is open
       84       84                    to at least a minimal Structures internal file.
       85       85                VD_6E.STRUCTURE_EXTERNAL$, _NAMES$, _STRUCTURES$, and _WINDOWS$
       86       86                    must point to the level-0 VD$FILE_NODEs for the appropriate
       87       87                    predefined entries in the Structures file.
       88       88                VD_$SCREEN is a VD$NUMBER for the $SCREEN predefined name.  It's .V#
       89       89                    must contain the number of lines of the terminal screen which
       90       90                    the user wants 6Edit to use.  (This is only used if we load
       91       91                    windows from the workspace file.)
       92       92            OUTPUT:
       93       93                VD_6E.WS will be loaded from the workspace file.  If any
       94       94                    editing windows were loaded, they have been declared and
       95       95                    their files opened.
       96       96            DESCRIPTION:
       97       97                Read records from the workspace file:  each one contains either:
       98       98                A header record (only the first record):
       99       99                    Save the header record's Spec component in VD_LAST_LOADED_FILE_SPEC.
      100      100                    In the VD$ENCODED_FILE_SPEC is a set of bit-flags (using %PDFF_
      101      101                        offsets) indicating the kinds of file-nodes this workspace
      102      102                        file contains.  If the file contains Windows nodes, and
      103      103                        LOAD_FLAGS says we're allowed to load Windows nodes, then
      104      104                        delete the current Windows file contents:  this will close
      105      105                        down all the current windows.
      106      106                A file node from a predefined file:
      107      107                    Restore the node to it's original predefined file.  This should
      108      108                        have all the side-effects necessary to restore the original
      109      109                        condition of the editor:  windows closed or re-opened, etc.
      110      110                Special handling for VD$WINDOW_SPECs:  Because of the way we tell the
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:28   
      111      111                    FEP to create windows, we have to do some special-casing for
      112      112                    the height of windows created from a workspace file.  As saved
      113      113                    in the workspace file, VD$WINDOW_SPECs contain the exact number
      114      114                    of lines the window is intended to occupy.  But when creating
      115      115                    the window (ie, when calling VDA$LWRITE to write the
      116      116                    VD$WINDOW_SPEC to the Accessor), the VD$WINDOW_SPEC must include
      117      117                    the height not only of itself, but of all windows which follow
      118      118                    it (are below it on the screen).  Therefore, we always create
      119      119                    each window using the entire remaining portion of the screen;
      120      120                    when the next window is created, it will take into account the
      121      121                    intended height of the previous window in order to determine
      122      122                    the "entire remaining portion" it's s'posed to use.
      123      123        */
      124      124
      125      125        VDW$LOAD: PROC (LOAD_FLAGS) ALTRET;

    125  4 000000   000000 700200 xent  VDW$LOAD     TSX0  ! X66_AUTO_1
         4 000001   000070 000001                    ZERO    56,1

      126      126
      127      127        %INCLUDE VD_MACROS_M;
      128     2342        %INCLUDE VD_PERR_C;
      129     2490        %INCLUDE CP_6;
      130     2571        %INCLUDE CP_6_SUBS;
      131     3111        %INCLUDE B$JIT;
      132     3401
      133     3402
      134     3403    1   DCL 1 LOAD_FLAGS ALIGNED PARAM,
      135     3404              %VD$PDFF (NAME=F, STCLASS=PARAM, LEV=2, LAST=YES);
      136     3418
      137     3419
      138     3420        /*
      139     3421        *   POINTERIZE:  Code to turn a record-offset into a pointer.
      140     3422        *   PTR is the name of the pointer field in the object in ENCODED$NODE
      141     3423        *       which is to be converted from an offset into ENCODED_NODE$
      142     3424        *       into a real pointer.
      143     3425        */
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:29   
      144     3426
      145     3427        %MACRO POINTERIZE (PTR="Must be supplied", BASE$=ENCODED_NODE$);
      146     3428                IF ADDR(PTR)->BASED$SBIN = 0 THEN
      147     3429                   PTR = ADDR(NIL);
      148     3430                ELSE
      149     3431                   PTR = PINCRW(BASE$, ADDR(PTR)->BASED$SBIN);
      150     3432        %MEND;
      151     3433
      152     3434
      153     3435
      154     3436    1   DCL VDI$PREAD_FILE_READ     ENTRY (2) ALTRET;
      155     3437    1   DCL VDA$LDELETE             ENTRY (2) ALTRET;
      156     3438    1   DCL VDA$FCLOSE              ENTRY (1) ALTRET;
      157     3439    1   DCL VDG$ERRMSG              ENTRY (4) ALTRET;
      158     3440    1   DCL VDG$MONERR              ENTRY ALTRET;
      159     3441    1   DCL VDG$WARNMSG             ENTRY (4) ALTRET;
      160     3442    1   DCL VDG$OALLOC              ENTRY (3) ALTRET;
      161     3443    1   DCL VDG$OCOPY               ENTRY (2) ALTRET;
      162     3444    1   DCL VDG$OCOPY_RANGE         ENTRY (2) ALTRET;
      163     3445    1   DCL VDG$OFREE               ENTRY (1) ALTRET;
      164     3446    1   DCL VDG$OCLEAR_RANGE        ENTRY (1) ALTRET;
      165     3447    1   DCL VDW$RESTORE_NODE        ENTRY (3) ALTRET;
      166     3448    1   DCL VDG$EREPORT_ERROR   ENTRY (1);
      167     3449    1   DCL VDG$ESCREECH        ENTRY (3);
      168     3450
      169     3451
      170     3452        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
      171     3488        %VD$KEY (NAME=VD_KEY_NUMERIC_BOF, STCLASS=SYMREF);
      172     3502        %VD_OBJECTS (NAME=VD_OBJECTS, STCLASS=SYMREF);
      173     3542        %VD$NUMBER (NAME=VD_$SCREEN, STCLASS=SYMREF);
      174     3587        %VD$ENCODED_FILE_SPEC (NAME=VD_LAST_LOADED_FILE_SPEC, STCLASS=SYMREF);
      175     3616    1   DCL B$JIT$ PTR SYMREF;
      176     3617    1   DCL M$EI DCB;
      177     3618
      178     3619
      179     3620    1   DCL STREAM$ PTR;
      180     3621    1   DCL EOF BIT(1) ALIGNED;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:30   
      181     3622    1   DCL ENCODED_NODE$ PTR;
      182     3623    1   DCL SUM SBIN;
      183     3624    1   DCL BASED_ARRAY$ PTR;
      184     3625    1   DCL I SBIN;
      185     3626    1   DCL PREV_WINDOW_INTENDED_HEIGHT SBIN;
      186     3627    1   DCL THIS_WINDOW_INTENDED_HEIGHT SBIN;
      187     3628    1   DCL WINDOW_SPEC$ PTR;
      188     3629
      189     3630
      190     3631        %VD$CMD_STREAM (NAME=CMD$STREAM, STCLASS="BASED(VD_6E.CMD_STREAM$)");
      191     3670        %VD$STREAM (NAME=STREAM, STCLASS="BASED(STREAM$)");
      192     3776        %VD$ENCODED_NODE (NAME=ENCODED$NODE, STCLASS="BASED(ENCODED_NODE$)");
      193     3897    1   DCL BASED$ARRAY (0:0) SBIN BASED(BASED_ARRAY$);
      194     3898    1   DCL BASED$SBIN SBIN BASED;
      195     3899        %VD$STREAM (NAME=WINDOWS$STREAM, STCLASS="BASED(VD_6E.WINDOWS$)");
      196     4005        %VD$WINDOW_SPEC (NAME=WINDOW$SPEC, STCLASS="BASED(WINDOW_SPEC$)");
      197     4071        %VD$WINDOW_SPEC;
      198     4137        %VD$PORT;
      199     4235        %VD$BUFFER;
      200     4293        %VD$ERR (NAME=VD$ERR, STCLASS="BASED(VD_6E.ERR_TAIL$)");
      201     4346
      202     4347
      203     4348
      204     4349    1           STREAM$ = ADDR(NIL);

   4349  4 000002   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000003   200004 756100                    STQ     STREAM$,,AUTO

      205     4350    1           PREV_WINDOW_INTENDED_HEIGHT = 0;

   4350  4 000004   200012 450100                    STZ     PREV_WINDOW_INTENDED_HEIGHT,,AUTO

      206     4351
      207     4352                /*
      208     4353                *   Build a temporary stream to be used by VDW$RESTORE_NODE
      209     4354                *       for writing external-file nodes.
      210     4355                */
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:31   
      211     4356    1           CALL VDG$OALLOC (%CLS_STREAM, STREAM$)

   4356  4 000005   200004 630500                    EPPR0   STREAM$,,AUTO
         4 000006   200063 450500                    STP0    VLP_LINEATTR+17,,AUTO
         4 000007   000001 236000 5                  LDQ     1
         4 000010   200062 756100                    STQ     VLP_LINEATTR+16,,AUTO
         4 000011   200062 630500                    EPPR0   VLP_LINEATTR+16,,AUTO
         4 000012   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000013   000000 701000 xent               TSX1    VDG$OALLOC
         4 000014   000257 702000 4                  TSX2    OALLOC_FAILED

      212     4357    1             ALTRET (OALLOC_FAILED);
      213     4358
      214     4359                /*
      215     4360                *   Read, decode, and restore each record from the workspace file.
      216     4361                */
      217     4362
      218     4363    1           CMD$STREAM.REC_NUM# = 0;

   4363  4 000015   000026 470400 xsym               LDP0    VD_6E+22
         4 000016   000030 450100                    STZ     24,,PR0

      219     4364    1   EACH_WORKSPACE_RECORD:
      220     4365    2           DO UNTIL EOF;

   4365  4 000017                       EACH_WORKSP* null
      221     4366    2              CALL VDI$PREAD_FILE_READ (%MXNB_COMMAND, EOF)

   4366  4 000017   200005 630500                    EPPR0   EOF,,AUTO
         4 000020   200063 450500                    STP0    VLP_LINEATTR+17,,AUTO
         4 000021   000003 236000 5                  LDQ     3
         4 000022   200062 756100                    STQ     VLP_LINEATTR+16,,AUTO
         4 000023   200062 630500                    EPPR0   VLP_LINEATTR+16,,AUTO
         4 000024   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000025   000000 701000 xent               TSX1    VDI$PREAD_FILE_READ
         4 000026   000243 702000 4                  TSX2    LDELETE_FAILED

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:32   
      222     4367    2                ALTRET (PREAD_FILE_READ_FAILED);
      223     4368    2              IF EOF THEN

   4368  4 000027   200005 234100                    SZN     EOF,,AUTO
         4 000030   000205 604000 4                  TMI     s:4423

      224     4369    2                 EXIT EACH_WORKSPACE_RECORD;
      225     4370    2              ENCODED_NODE$ = CMD$STREAM.RECORD$;

   4370  4 000031   000026 470400 xsym               LDP0    VD_6E+22
         4 000032   000025 236100                    LDQ     21,,PR0
         4 000033   200006 756100                    STQ     ENCODED_NODE$,,AUTO

      226     4371    2              IF ENCODED$NODE.RECORD_ID ~= %CHR_ENCODED_RECID

   4371  4 000034   200006 471500                    LDP1    ENCODED_NODE$,,AUTO
         4 000035   040000 106500                    CMPC    fill='040'O
         4 000036   100002 400015                    ADSC9   2,,PR1                   cn=2,n=13
         4 000037   000000 000015 3                  ADSC9   0                        cn=0,n=13
         4 000040   000221 601000 4                  TNZ     WS_FILE_INVALID_FAILURE
         4 000041   100011 236100                    LDQ     9,,PR1
         4 000042   000030 116100                    CMPQ    24,,PR0
         4 000043   000221 601000 4                  TNZ     WS_FILE_INVALID_FAILURE

      227     4372    2                OR ENCODED$NODE.RECORD_NUM# ~= CMD$STREAM.REC_NUM# THEN
      228     4373    2                 GOTO WS_FILE_INVALID_FAILURE;
      229     4374
      230     4375    2              SUM = 0;

   4375  4 000044   200007 450100                    STZ     SUM,,AUTO

      231     4376    2              BASED_ARRAY$ = PINCRW(ADDR(ENCODED$NODE.CHECKSUM#), 1);

   4376  4 000045   200006 236100                    LDQ     ENCODED_NODE$,,AUTO
         4 000046   000011 036003                    ADLQ    9,DU
         4 000047   200010 756100                    STQ     BASED_ARRAY$,,AUTO

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:33   
      232     4377    2              DO I =
      233     4378    2                ((ENCODED$NODE.LENGTH# - POFFC(BASED_ARRAY$, ENCODED_NODE$)) /
      234     4379    3                %NB_PER_WORD) DOWNTO 0;

   4379  4 000050   200006 236100                    LDQ     ENCODED_NODE$,,AUTO
         4 000051   000020 772000                    QRL     16
         4 000052   200062 756100                    STQ     VLP_LINEATTR+16,,AUTO
         4 000053   200010 236100                    LDQ     BASED_ARRAY$,,AUTO
         4 000054   000020 772000                    QRL     16
         4 000055   200062 136100                    SBLQ    VLP_LINEATTR+16,,AUTO
         4 000056   200063 756100                    STQ     VLP_LINEATTR+17,,AUTO
         4 000057   100002 236100                    LDQ     2,,PR1
         4 000060   000022 732000                    QRS     18
         4 000061   200063 136100                    SBLQ    VLP_LINEATTR+17,,AUTO
         4 000062   000004 506007                    DIV     4,DL
         4 000063   200011 756100                    STQ     I,,AUTO
         4 000064   000074 710000 4                  TRA     s:4381+2

      235     4380    3                 SUM = SUM + BASED$ARRAY (I);

   4380  4 000065   200010 470500                    LDP0    BASED_ARRAY$,,AUTO
         4 000066   200011 720100                    LXL0    I,,AUTO
         4 000067   200007 236100                    LDQ     SUM,,AUTO
         4 000070   000000 036110                    ADLQ    0,X0,PR0
         4 000071   200007 756100                    STQ     SUM,,AUTO

      236     4381    3                 END;

   4381  4 000072   000001 336007                    LCQ     1,DL
         4 000073   200011 056100                    ASQ     I,,AUTO
         4 000074   200011 235100                    LDA     I,,AUTO
         4 000075   000065 605000 4                  TPL     s:4380

      237     4382    2              IF SUM ~= ENCODED$NODE.CHECKSUM# THEN

   4382  4 000076   200006 470500                    LDP0    ENCODED_NODE$,,AUTO
         4 000077   200007 236100                    LDQ     SUM,,AUTO
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:34   
         4 000100   000010 116100                    CMPQ    8,,PR0
         4 000101   000221 601000 4                  TNZ     WS_FILE_INVALID_FAILURE

      238     4383    2                 GOTO WS_FILE_INVALID_FAILURE;
      239     4384
      240     4385    3              IF ENCODED$NODE.DESC.SPEC.TYPE# = %SPT_ENCODED_FILE_SPEC THEN DO;

   4385  4 000102   000026 220100                    LDX0    22,,PR0
         4 000103   000010 100003                    CMPX0   8,DU
         4 000104   000127 601000 4                  TNZ     s:4397

      241     4386                      /* This looks like a header record */
      242     4387    3                 IF ENCODED$NODE.RECORD_NUM# ~= 0

   4387  4 000105   000011 235100                    LDA     9,,PR0
         4 000106   000221 601000 4                  TNZ     WS_FILE_INVALID_FAILURE
         4 000107   000000 106500                    CMPC    fill='000'O
         4 000110   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8
         4 000111   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         4 000112   000221 601000 4                  TNZ     WS_FILE_INVALID_FAILURE
         4 000113   000000 106500                    CMPC    fill='000'O
         4 000114   000014 000044                    ADSC9   12,,PR0                  cn=0,n=36
         4 000115   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         4 000116   000221 601000 4                  TNZ     WS_FILE_INVALID_FAILURE
         4 000117   000030 235100                    LDA     24,,PR0
         4 000120   000221 601000 4                  TNZ     WS_FILE_INVALID_FAILURE

      243     4388    3                   OR ENCODED$NODE.DESC.FILE_KEY ~= %CLEAR
      244     4389    3                   OR ENCODED$NODE.DESC.LOCATION ~= %CLEAR
      245     4390    3                   OR ADDR(ENCODED$NODE.DESC.DATA$)->BASED$SBIN ~= 0 THEN
      246     4391    3                    GOTO WS_FILE_INVALID_FAILURE;
      247     4392    3                 CALL HEADER_RECORD (ENCODED$NODE.DESC)

   4392  4 000121   200006 236100                    LDQ     ENCODED_NODE$,,AUTO
         4 000122   000012 036003                    ADLQ    10,DU
         4 000123   200017 756100                    STQ     WINDOW_SPEC$+3,,AUTO
         4 000124   002030 701000 4                  TSX1    HEADER_RECORD
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:35   
         4 000125   000243 702000 4                  TSX2    LDELETE_FAILED

      248     4393    3                   ALTRET (HEADER_RECORD_FAILED);
      249     4394    3                 END;

   4394  4 000126   000201 710000 4                  TRA     s:4420

      250     4395    3              ELSE DO;

      251     4396                      /* This is a file node to restore to its original location */
      252     4397    3                 CALL POINTERIZE_RECORD

   4397  4 000127   000260 701000 4                  TSX1    POINTERIZE_RECORD
         4 000130   000240 702000 4                  TSX2    POINTERIZE_RECORD_FAILED

      253     4398    3                   ALTRET (POINTERIZE_RECORD_FAILED);
      254     4399
      255     4400    3                 IF LOAD_FLAGS.F (%PDFF_WINDOWS)

   4400  4 000131   200003 470500                    LDP0    @LOAD_FLAGS,,AUTO
         4 000132   000000 236100                    LDQ     0,,PR0
         4 000133   004000 316003                    CANQ    2048,DU
         4 000134   000167 600000 4                  TZE     s:4416
         4 000135   200006 471500                    LDP1    ENCODED_NODE$,,AUTO
         4 000136   100026 220100                    LDX0    22,,PR1
         4 000137   000006 100003                    CMPX0   6,DU
         4 000140   000167 601000 4                  TNZ     s:4416

      256     4401    3                   AND ENCODED$NODE.DESC.SPEC.TYPE# = %SPT_WINDOW_SPEC THEN
      257     4402    4   ADJUST_WINDOW_HEIGHT: DO;

   4402  4 000141                       ADJUST_WIND* null
      258     4403    4                    WINDOW_SPEC$ = ENCODED$NODE.DESC.SPEC.V$;

   4403  4 000141   100027 236100                    LDQ     23,,PR1
         4 000142   200014 756100                    STQ     WINDOW_SPEC$,,AUTO

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:36   
      259     4404    4                    THIS_WINDOW_INTENDED_HEIGHT = WINDOW$SPEC.COORDS.HEIGHT#;

   4404  4 000143   200014 473500                    LDP3    WINDOW_SPEC$,,AUTO
         4 000144   300005 235100                    LDA     5,,PR3
         4 000145   200013 755100                    STA     THIS_WINDOW_INTENDED_HEIGHT,,AUTO

      260     4405    4                    IF NOT WINDOWS$STREAM.PORT$->VD$PORT.CURRENT.EOF THEN

   4405  4 000146   000006 474400 xsym               LDP4    VD_6E+6
         4 000147   400001 475500                    LDP5    1,,PR4
         4 000150   500022 236100                    LDQ     18,,PR5
         4 000151   400000 316007                    CANQ    -131072,DL
         4 000152   000163 601000 4                  TNZ     s:4412

      261     4406    4                       WINDOW$SPEC.COORDS.HEIGHT# = MAXIMUM (0,

   4406  4 000153   500035 476500                    LDP6    29,,PR5
         4 000154   600005 236100                    LDQ     5,,PR6
         4 000155   200012 136100                    SBLQ    PREV_WINDOW_INTENDED_HEIGHT,,AUTO
         4 000156   000000 116003                    CMPQ    0,DU
         4 000157   000161 605000 4                  TPL     s:4406+6
         4 000160   000000 236003                    LDQ     0,DU
         4 000161   300005 756100                    STQ     5,,PR3
         4 000162   000165 710000 4                  TRA     s:4413

      262     4407    4                         WINDOWS$STREAM.PORT$ ->
      263     4408    4                         VD$PORT.LEVEL.SPEC.V$ (%LVL_LOWER) ->
      264     4409    4                         VD$WINDOW_SPEC.COORDS.HEIGHT# -
      265     4410    4                         PREV_WINDOW_INTENDED_HEIGHT);
      266     4411    4                    ELSE  /* First window gets entire screen */
      267     4412    4                       WINDOW$SPEC.COORDS.HEIGHT# = VD_$SCREEN.V#;

   4412  4 000163   000003 235000 xsym               LDA     VD_$SCREEN+3
         4 000164   300005 755100                    STA     5,,PR3

      268     4413    4                    PREV_WINDOW_INTENDED_HEIGHT = THIS_WINDOW_INTENDED_HEIGHT;

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:37   
   4413  4 000165   200013 235100                    LDA     THIS_WINDOW_INTENDED_HEIGHT,,AUTO
         4 000166   200012 755100                    STA     PREV_WINDOW_INTENDED_HEIGHT,,AUTO

      269     4414    4                    END ADJUST_WINDOW_HEIGHT;

      270     4415
      271     4416    3                 CALL VDW$RESTORE_NODE (STREAM, ENCODED$NODE.DESC, LOAD_FLAGS)

   4416  4 000167   200003 236100                    LDQ     @LOAD_FLAGS,,AUTO
         4 000170   200064 756100                    STQ     VLP_LINEATTR+18,,AUTO
         4 000171   200006 236100                    LDQ     ENCODED_NODE$,,AUTO
         4 000172   000012 036003                    ADLQ    10,DU
         4 000173   200004 235100                    LDA     STREAM$,,AUTO
         4 000174   200062 757100                    STAQ    VLP_LINEATTR+16,,AUTO
         4 000175   200062 630500                    EPPR0   VLP_LINEATTR+16,,AUTO
         4 000176   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000177   000000 701000 xent               TSX1    VDW$RESTORE_NODE
         4 000200   000243 702000 4                  TSX2    LDELETE_FAILED

      272     4417    3                   ALTRET (WRESTORE_NODE_FAILED);
      273     4418    3                 END;

      274     4419
      275     4420    2              CMD$STREAM.REC_NUM# = CMD$STREAM.REC_NUM# + 1;

   4420  4 000201   000026 470400 xsym               LDP0    VD_6E+22
         4 000202   000030 054100                    AOS     24,,PR0

      276     4421    2              END EACH_WORKSPACE_RECORD;

   4421  4 000203   200005 234100                    SZN     EOF,,AUTO
         4 000204   000017 605000 4                  TPL     EACH_WORKSPACE_RECORD

      277     4422
      278     4423    2           IF STREAM$ ~= ADDR(NIL) THEN DO;

   4423  4 000205   200004 236100                    LDQ     STREAM$,,AUTO
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:38   
         4 000206   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000207   000220 600000 4                  TZE     s:4430

      279     4424    2              CALL VDA$FCLOSE (STREAM)

   4424  4 000210   200004 630500                    EPPR0   STREAM$,,AUTO
         4 000211   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000212   000000 701000 xent               TSX1    VDA$FCLOSE
         4 000213   000257 702000 4                  TSX2    OALLOC_FAILED

      280     4425    2                ALTRET (FCLOSE_FAILED);
      281     4426    2              CALL VDG$OFREE (STREAM)

   4426  4 000214   200004 630500                    EPPR0   STREAM$,,AUTO
         4 000215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000216   000000 701000 xent               TSX1    VDG$OFREE
         4 000217   000257 702000 4                  TSX2    OALLOC_FAILED

      282     4427    2                ALTRET (OFREE_FAILED);
      283     4428    2              END;

      284     4429
      285     4430    1           RETURN;

   4430  4 000220   000000 702200 xent               TSX2  ! X66_ARET

      286     4431
      287     4432
      288     4433
      289     4434    1   WS_FILE_INVALID_FAILURE:
      290     4435    1           CALL VDG$ERRMSG (%E$BAD_WS_FILE,

   4435  4 000221   000026 236000 xsym  WS_FILE_INV* LDQ     VD_6E+22
         4 000222   000030 036003                    ADLQ    24,DU
         4 000223   200064 756100                    STQ     VLP_LINEATTR+18,,AUTO
         4 000224   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000225   000004 235000 5                  LDA     4
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:39   
         4 000226   200062 757100                    STAQ    VLP_LINEATTR+16,,AUTO
         4 000227   200062 630500                    EPPR0   VLP_LINEATTR+16,,AUTO
         4 000230   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000231   000000 701000 xent               TSX1    VDG$ERRMSG
         4 000232   000243 702000 4                  TSX2    LDELETE_FAILED

      291     4436    1             , BINBIT (CMD$STREAM.REC_NUM#,36)) ALTRET (CLEAN_UP);
      292     4437    1           VD$ERR.DCB# = DCBNUM(M$EI);

   4437  4 000233   000000 236007 xsym               LDQ     M$EI,DL
         4 000234   000000 620006                    EAX0    0,QL
         4 000235   000032 470400 xsym               LDP0    VD_6E+26
         4 000236   000004 740100                    STX0    4,,PR0

      293     4438    1           GOTO CLEAN_UP;

   4438  4 000237   000243 710000 4                  TRA     LDELETE_FAILED

   4437  4 000240                       POINTERIZE_* null
      294     4439
      295     4440
      296     4441    1   POINTERIZE_RECORD_FAILED: ;
      297     4442    1           CALL VDG$EREPORT_ERROR;

   4442  4 000240   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000241   000000 701000 xent               TSX1    VDG$EREPORT_ERROR
         4 000242   000000 011000                    NOP     0

   4437  4 000243                       LDELETE_FAI* null
   4437  4 000243                       HEADER_RECO* null
   4437  4 000243                       PREAD_FILE_* null
   4437  4 000243                       WRESTORE_NO* null
      298     4443    1   LDELETE_FAILED: ;
      299     4444    1   HEADER_RECORD_FAILED: ;
      300     4445    1   PREAD_FILE_READ_FAILED: ;
      301     4446    1   WRESTORE_NODE_FAILED: ;
      302     4447    1   CLEAN_UP:
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:40   
      303     4448    2           IF STREAM$ ~= ADDR(NIL) THEN DO;

   4448  4 000243   200004 236100       CLEAN_UP     LDQ     STREAM$,,AUTO
         4 000244   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000245   000256 600000 4                  TZE     s:4454

      304     4449    2              CALL VDA$FCLOSE (STREAM)

   4449  4 000246   200004 630500                    EPPR0   STREAM$,,AUTO
         4 000247   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000250   000000 701000 xent               TSX1    VDA$FCLOSE
         4 000251   000257 702000 4                  TSX2    OALLOC_FAILED

      305     4450    2                ALTRET (FCLOSE_FAILED);
      306     4451    2              CALL VDG$OFREE (STREAM)

   4451  4 000252   200004 630500                    EPPR0   STREAM$,,AUTO
         4 000253   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000254   000000 701000 xent               TSX1    VDG$OFREE
         4 000255   000257 702000 4                  TSX2    OALLOC_FAILED

      307     4452    2                ALTRET (OFREE_FAILED);
      308     4453    2              END;

      309     4454    1           ALTRETURN;

   4454  4 000256   000000 702200 xent               TSX2  ! X66_AALT

   4448  4 000257                       OALLOC_FAIL* null
   4448  4 000257                       OFREE_FAILED null
   4448  4 000257                       FCLOSE_FAIL* null
      310     4455
      311     4456
      312     4457    1   OALLOC_FAILED: ;
      313     4458    1   OFREE_FAILED: ;
      314     4459    1   FCLOSE_FAILED: ;
      315     4460    1           ALTRETURN;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:41   

   4460  4 000257   000000 702200 xent               TSX2  ! X66_AALT

      316     4461
      317     4462
      318     4463        %BOX (TITLE=POINTERIZE_RECORD, PAGE=YES);
              4471    1
              4475    1   /***************************************************************************
              4477    1    *                                                                         *
              4481    1            *                             POINTERIZE_RECORD                          *
              4483    1            *                                                                        *
              4485    1          ***************************************************************************/

      319     4489
      320     4490        /*I* NAME: POINTERIZE_RECORD
      321     4491            PARAMETERS:
      322     4492                None.
      323     4493            INPUT:
      324     4494                ENCODED$NODE is the VD$ENCODED_NODE for the workspace-file record.
      325     4495            OUTPUT:
      326     4496                ENCODED$NODE's record-offsets will be converted to real pointers.
      327     4497                VD_ERR$ - If an error in the record is found, VD_ERR$ will
      328     4498                    point to the allocated VD$ERR for the error.  It's
      329     4499                    first substitution field will contain the %CLS_ code for
      330     4500                    the object in error, as a CLS_NUMBER.
      331     4501            DESCRIPTION:
      332     4502                Loop thru the objects in ENCODED$NODE; in these objects, all
      333     4503                pointers have been stored in the file as word-offsets into
      334     4504                the record of the object pointed-to.  Find these word
      335     4505                offsets, and replace them with pointers to the objects in
      336     4506                the workspace record.
      337     4507        */
      338     4508
      339     4509    1   POINTERIZE_RECORD: PROC ALTRET;

   4509  4 000260   200016 741300       POINTERIZE_* STX1  ! WINDOW_SPEC$+2,,AUTO

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:42   
      340     4510
      341     4511
      342     4512    2   DCL OBJECT_HEADER$ PTR;
      343     4513    2   DCL OBJECT_LIMIT$ PTR;
      344     4514    2   DCL I SBIN;
      345     4515
      346     4516
      347     4517        %VD$OBJECT_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
      348     4539        %VD$WINDOW_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
      349     4605        %VD$WINDOW_BLOCK (STCLASS="BASED(OBJECT_HEADER$)");
      350     4642        %VD$RECORD_SET (STCLASS="BASED(OBJECT_HEADER$)");
      351     4720        %VD$STRUCTURE_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
      352     4757        %VD$IT_ADJUST (STCLASS="BASED(OBJECT_HEADER$)");
      353     4794        %VD$IT_BLOCK_EXPR (STCLASS="BASED(OBJECT_HEADER$)");
      354     4944        %VD$IT_COMMAND (STCLASS="BASED(OBJECT_HEADER$)");
      355     4982        %VD$IT_OPERAND (STCLASS="BASED(OBJECT_HEADER$)");
      356     5048        %VD$IT_OPERATOR (STCLASS="BASED(OBJECT_HEADER$)");
      357     5085        %VD$IT_SELECT (STCLASS="BASED(OBJECT_HEADER$)");
      358     5122        %VD$BLOCK_DESC (STCLASS="BASED(OBJECT_HEADER$)");
      359     5269        %VD$BUFFER (STCLASS="BASED(OBJECT_HEADER$)");
      360     5327        %VD$BUFFER_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
      361     5363        %VD$STRING_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
      362     5399        %VD$PATTERN (STCLASS="BASED(OBJECT_HEADER$)");
      363     5450        %VD$EVAL (STCLASS="BASED(OBJECT_HEADER$)");
      364     5695        %VD$FIT (STCLASS="BASED(OBJECT_HEADER$)");
      365     5731        %VD$POINTER (STCLASS="BASED(OBJECT_HEADER$)");
      366     5776
      367     5777
      368     5778
      369     5779    3           IF ENCODED$NODE.DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;

   5779  4 000261   200006 470500                    LDP0    ENCODED_NODE$,,AUTO
         4 000262   000012 720100                    LXL0    10,,PR0
         4 000263   000002 100003                    CMPX0   2,DU
         4 000264   000276 601000 4                  TNZ     s:5787

      370     5780                   %POINTERIZE (PTR=ENCODED$NODE.DESC.FILE_KEY.V$);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:43   

   5781  4 000265   000013 235100                    LDA     11,,PR0
         4 000266   000272 601000 4                  TNZ     s:5784

   5782  4 000267   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000270   000013 756100                    STQ     11,,PR0
         4 000271   000276 710000 4                  TRA     s:5787

   5784  4 000272   000013 236100                    LDQ     11,,PR0
         4 000273   000022 736000                    QLS     18
         4 000274   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000275   000013 756100                    STQ     11,,PR0

      371     5786    3              END;

      372     5787    2           CALL POINTERIZE_LOCATION (ENCODED$NODE.DESC.LOCATION);

   5787  4 000276   200006 236100                    LDQ     ENCODED_NODE$,,AUTO
         4 000277   000014 036003                    ADLQ    12,DU
         4 000300   200023 756100                    STQ     I+2,,AUTO
         4 000301   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 000302   000000 011000                    NOP     0

      373     5788    3           IF ENCODED$NODE.DESC.SPEC.REP# = %REP_REMOTE THEN DO;

   5788  4 000303   200006 470500                    LDP0    ENCODED_NODE$,,AUTO
         4 000304   000026 720100                    LXL0    22,,PR0
         4 000305   000002 100003                    CMPX0   2,DU
         4 000306   000320 601000 4                  TNZ     s:5797

      374     5789                   %POINTERIZE (PTR=ENCODED$NODE.DESC.SPEC.V$);

   5790  4 000307   000027 235100                    LDA     23,,PR0
         4 000310   000314 601000 4                  TNZ     s:5793

   5791  4 000311   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000312   000027 756100                    STQ     23,,PR0
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:44   
         4 000313   000320 710000 4                  TRA     s:5797

   5793  4 000314   000027 236100                    LDQ     23,,PR0
         4 000315   000022 736000                    QLS     18
         4 000316   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000317   000027 756100                    STQ     23,,PR0

      375     5795    3              END;

      376     5796                %POINTERIZE (PTR=ENCODED$NODE.DESC.DATA$);

   5797  4 000320   000030 235100                    LDA     24,,PR0
         4 000321   000325 601000 4                  TNZ     s:5800

   5798  4 000322   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000323   000030 756100                    STQ     24,,PR0
         4 000324   000331 710000 4                  TRA     s:5804

   5800  4 000325   000030 236100                    LDQ     24,,PR0
         4 000326   000022 736000                    QLS     18
         4 000327   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000330   000030 756100                    STQ     24,,PR0

      377     5802
      378     5803
      379     5804    2           OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));

   5804  4 000331   200006 236100                    LDQ     ENCODED_NODE$,,AUTO
         4 000332   000031 036003                    ADLQ    25,DU
         4 000333   200017 756100                    STQ     OBJECT_HEADER$,,AUTO

      380     5805    2           OBJECT_LIMIT$ = PINCRC(ADDR(ENCODED_NODE$->VD$BUFFER.BYTES),

   5805  4 000334   000002 236100                    LDQ     2,,PR0
         4 000335   000022 732000                    QRS     18
         4 000336   000020 736000                    QLS     16
         4 000337   000005 036000 5                  ADLQ    5
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:45   
         4 000340   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000341   200020 756100                    STQ     OBJECT_LIMIT$,,AUTO

      381     5806    2             ENCODED$NODE.LENGTH#);
      382     5807
      383     5808    2   EACH_OBJECT:
      384     5809    3           DO WHILE (POFFW(OBJECT_LIMIT$, OBJECT_HEADER$) > 0);

   5809  4 000342   001555 710000 4     EACH_OBJECT  TRA     s:6208

      385     5810
      386     5811    3   OBJECT_TYPE_CASES:
      387     5812    4              DO CASE (VD$OBJECT_HEADER.CLASS#);

   5812  4 000343   200017 470500       OBJECT_TYPE* LDP0    OBJECT_HEADER$,,AUTO
         4 000344   000000 220100                    LDX0    0,,PR0
         4 000345   000060 100003                    CMPX0   48,DU
         4 000346   000350 602010 4                  TNC     OBJECT_TYPE_CASES+5,X0
         4 000347   001537 710000 4                  TRA     s:6198
         4 000350   001537 710000 4                  TRA     s:6198
         4 000351   001305 710000 4                  TRA     s:6106
         4 000352   001305 710000 4                  TRA     s:6106
         4 000353   000442 710000 4                  TRA     s:5827
         4 000354   000442 710000 4                  TRA     s:5827
         4 000355   001537 710000 4                  TRA     s:6198
         4 000356   000442 710000 4                  TRA     s:5827
         4 000357   000442 710000 4                  TRA     s:5827
         4 000360   001537 710000 4                  TRA     s:6198
         4 000361   001537 710000 4                  TRA     s:6198
         4 000362   001537 710000 4                  TRA     s:6198
         4 000363   001433 710000 4                  TRA     s:6152
         4 000364   001537 710000 4                  TRA     s:6198
         4 000365   000442 710000 4                  TRA     s:5827
         4 000366   000430 710000 4                  TRA     s:5817
         4 000367   001537 710000 4                  TRA     s:6198
         4 000370   000442 710000 4                  TRA     s:5827
         4 000371   001471 710000 4                  TRA     s:6168
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:46   
         4 000372   000712 710000 4                  TRA     s:5940
         4 000373   000757 710000 4                  TRA     s:5966
         4 000374   001057 710000 4                  TRA     s:6005
         4 000375   001123 710000 4                  TRA     s:6027
         4 000376   001173 710000 4                  TRA     s:6055
         4 000377   001240 710000 4                  TRA     s:6081
         4 000400   000442 710000 4                  TRA     s:5827
         4 000401   000442 710000 4                  TRA     s:5827
         4 000402   000430 710000 4                  TRA     s:5817
         4 000403   000442 710000 4                  TRA     s:5827
         4 000404   000442 710000 4                  TRA     s:5827
         4 000405   001403 710000 4                  TRA     s:6141
         4 000406   000442 710000 4                  TRA     s:5827
         4 000407   001537 710000 4                  TRA     s:6198
         4 000410   001514 710000 4                  TRA     s:6183
         4 000411   001514 710000 4                  TRA     s:6183
         4 000412   001514 710000 4                  TRA     s:6183
         4 000413   001514 710000 4                  TRA     s:6183
         4 000414   001514 710000 4                  TRA     s:6183
         4 000415   001514 710000 4                  TRA     s:6183
         4 000416   000625 710000 4                  TRA     s:5907
         4 000417   001537 710000 4                  TRA     s:6198
         4 000420   000430 710000 4                  TRA     s:5817
         4 000421   000656 710000 4                  TRA     s:5920
         4 000422   001537 710000 4                  TRA     s:6198
         4 000423   000430 710000 4                  TRA     s:5817
         4 000424   000571 710000 4                  TRA     s:5888
         4 000425   000454 710000 4                  TRA     s:5835
         4 000426   001537 710000 4                  TRA     s:6198
         4 000427   000442 710000 4                  TRA     s:5827

      388     5813
      389     5814    4               CASE (%CLS_TEXTC_REMOTE, %CLS_FILE_KEY, %CLS_NAME_SPEC,

      390     5815    4                %CLS_STRUCTURE_LEVEL);
      391     5816                      %POINTERIZE (PTR=VD$STRING_HEADER.FLINK$);

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:47   
   5817  4 000430   000001 235100                    LDA     1,,PR0
         4 000431   000435 601000 4                  TNZ     s:5820

   5818  4 000432   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000433   000001 756100                    STQ     1,,PR0
         4 000434   001540 710000 4                  TRA     s:6202

   5820  4 000435   000001 236100                    LDQ     1,,PR0
         4 000436   000022 736000                    QLS     18
         4 000437   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000440   000001 756100                    STQ     1,,PR0
         4 000441   001540 710000 4                  TRA     s:6202

      392     5822
      393     5823    4               CASE (%CLS_BUFFER, %CLS_NUMBER, %CLS_BOOLEAN, %CLS_FILE_STCLASS,

      394     5824    4                   %CLS_ORG, %CLS_KEY_TYPE, %CLS_EXIST, %CLS_NAME_DATA_TYPE,
      395     5825    4                   %CLS_COMPONENT, %CLS_POINT, %CLS_DIRECTION, %CLS_PROTECT);
      396     5826                      %POINTERIZE (PTR=VD$BUFFER_HEADER.FLINK$);

   5827  4 000442   000001 235100                    LDA     1,,PR0
         4 000443   000447 601000 4                  TNZ     s:5830

   5828  4 000444   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000445   000001 756100                    STQ     1,,PR0
         4 000446   001540 710000 4                  TRA     s:6202

   5830  4 000447   000001 236100                    LDQ     1,,PR0
         4 000450   000022 736000                    QLS     18
         4 000451   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000452   000001 756100                    STQ     1,,PR0
         4 000453   001540 710000 4                  TRA     s:6202

      397     5832
      398     5833    4               CASE (%CLS_WINDOW_SPEC);

      399     5834                      %POINTERIZE (PTR=VD$WINDOW_SPEC.FLINK$);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:48   

   5835  4 000454   000001 235100                    LDA     1,,PR0
         4 000455   000461 601000 4                  TNZ     s:5838

   5836  4 000456   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000457   000001 756100                    STQ     1,,PR0
         4 000460   000465 710000 4                  TRA     s:5840

   5838  4 000461   000001 236100                    LDQ     1,,PR0
         4 000462   000022 736000                    QLS     18
         4 000463   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000464   000001 756100                    STQ     1,,PR0

      400     5840    4                 VD$WINDOW_SPEC.OPERAND.STREAM$ = ADDR(NIL);

   5840  4 000465   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000466   000010 756100                    STQ     8,,PR0

      401     5841                      %POINTERIZE (PTR=VD$WINDOW_SPEC.OPERAND.INTREE$);

   5842  4 000467   000011 235100                    LDA     9,,PR0
         4 000470   000473 601000 4                  TNZ     s:5845

   5843  4 000471   000011 756100                    STQ     9,,PR0
         4 000472   000477 710000 4                  TRA     s:5848

   5845  4 000473   000011 236100                    LDQ     9,,PR0
         4 000474   000022 736000                    QLS     18
         4 000475   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000476   000011 756100                    STQ     9,,PR0

      402     5847                      %POINTERIZE (PTR=VD$WINDOW_SPEC.OPERAND.EDIT_BLOCK$);

   5848  4 000477   000012 235100                    LDA     10,,PR0
         4 000500   000504 601000 4                  TNZ     s:5851

   5849  4 000501   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:49   
         4 000502   000012 756100                    STQ     10,,PR0
         4 000503   000510 710000 4                  TRA     s:5854

   5851  4 000504   000012 236100                    LDQ     10,,PR0
         4 000505   000022 736000                    QLS     18
         4 000506   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000507   000012 756100                    STQ     10,,PR0

      403     5853                      %POINTERIZE (PTR=VD$WINDOW_SPEC.OPERAND.EVAL$);

   5854  4 000510   000013 235100                    LDA     11,,PR0
         4 000511   000515 601000 4                  TNZ     s:5857

   5855  4 000512   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000513   000013 756100                    STQ     11,,PR0
         4 000514   000521 710000 4                  TRA     s:5860

   5857  4 000515   000013 236100                    LDQ     11,,PR0
         4 000516   000022 736000                    QLS     18
         4 000517   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000520   000013 756100                    STQ     11,,PR0

      404     5859                      %POINTERIZE (PTR=VD$WINDOW_SPEC.RECORD_SET$);

   5860  4 000521   000016 235100                    LDA     14,,PR0
         4 000522   000526 601000 4                  TNZ     s:5863

   5861  4 000523   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000524   000016 756100                    STQ     14,,PR0
         4 000525   000532 710000 4                  TRA     s:5866

   5863  4 000526   000016 236100                    LDQ     14,,PR0
         4 000527   000022 736000                    QLS     18
         4 000530   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000531   000016 756100                    STQ     14,,PR0

      405     5865                      %POINTERIZE (PTR=VD$WINDOW_SPEC.KEY_DEFINITION_BUFFER$);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:50   

   5866  4 000532   000030 235100                    LDA     24,,PR0
         4 000533   000537 601000 4                  TNZ     s:5869

   5867  4 000534   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000535   000030 756100                    STQ     24,,PR0
         4 000536   000543 710000 4                  TRA     s:5872

   5869  4 000537   000030 236100                    LDQ     24,,PR0
         4 000540   000022 736000                    QLS     18
         4 000541   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000542   000030 756100                    STQ     24,,PR0

      406     5871                      %POINTERIZE (PTR=VD$WINDOW_SPEC.TABS$);

   5872  4 000543   000024 235100                    LDA     20,,PR0
         4 000544   000550 601000 4                  TNZ     s:5875

   5873  4 000545   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000546   000024 756100                    STQ     20,,PR0
         4 000547   000554 710000 4                  TRA     s:5877

   5875  4 000550   000024 236100                    LDQ     20,,PR0
         4 000551   000022 736000                    QLS     18
         4 000552   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000553   000024 756100                    STQ     20,,PR0

      407     5877    5                 IF VD$WINDOW_SPEC.EOFMARK$~=ADDR(NIL) THEN DO;

   5877  4 000554   000025 236100                    LDQ     21,,PR0
         4 000555   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000556   001540 600000 4                  TZE     s:6202

      408     5878                         %POINTERIZE (PTR=VD$WINDOW_SPEC.EOFMARK$);

   5879  4 000557   000025 235100                    LDA     21,,PR0
         4 000560   000564 601000 4                  TNZ     s:5882
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:51   

   5880  4 000561   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000562   000025 756100                    STQ     21,,PR0
         4 000563   001540 710000 4                  TRA     s:6202

   5882  4 000564   000025 236100                    LDQ     21,,PR0
         4 000565   000022 736000                    QLS     18
         4 000566   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000567   000025 756100                    STQ     21,,PR0

      409     5884    5                    END;

   5884  4 000570   001540 710000 4                  TRA     s:6202

      410     5885
      411     5886    4               CASE (%CLS_WINDOW_BLOCK);

      412     5887                      %POINTERIZE (PTR=VD$WINDOW_BLOCK.FLINK$);

   5888  4 000571   000001 235100                    LDA     1,,PR0
         4 000572   000576 601000 4                  TNZ     s:5891

   5889  4 000573   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000574   000001 756100                    STQ     1,,PR0
         4 000575   000602 710000 4                  TRA     s:5894

   5891  4 000576   000001 236100                    LDQ     1,,PR0
         4 000577   000022 736000                    QLS     18
         4 000600   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000601   000001 756100                    STQ     1,,PR0

      413     5893                      %POINTERIZE (PTR=VD$WINDOW_BLOCK.EDIT_BLOCK$);

   5894  4 000602   000003 235100                    LDA     3,,PR0
         4 000603   000607 601000 4                  TNZ     s:5897

   5895  4 000604   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:52   
         4 000605   000003 756100                    STQ     3,,PR0
         4 000606   000613 710000 4                  TRA     s:5900

   5897  4 000607   000003 236100                    LDQ     3,,PR0
         4 000610   000022 736000                    QLS     18
         4 000611   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000612   000003 756100                    STQ     3,,PR0

      414     5899                      %POINTERIZE (PTR=VD$WINDOW_BLOCK.EVAL$);

   5900  4 000613   000004 235100                    LDA     4,,PR0
         4 000614   000620 601000 4                  TNZ     s:5903

   5901  4 000615   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000616   000004 756100                    STQ     4,,PR0
         4 000617   001540 710000 4                  TRA     s:6202

   5903  4 000620   000004 236100                    LDQ     4,,PR0
         4 000621   000022 736000                    QLS     18
         4 000622   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000623   000004 756100                    STQ     4,,PR0
         4 000624   001540 710000 4                  TRA     s:6202

      415     5905
      416     5906    4               CASE (%CLS_RECORD_SET);

      417     5907    5                 DO I = 0 TO (VD$RECORD_SET.N_ENTRIES# - 1);

   5907  4 000625   200021 450100                    STZ     I,,AUTO
         4 000626   000651 710000 4                  TRA     s:5916+1

      418     5908    6                    IF VD$RECORD_SET.DESC.KEY.REP# (I) = %REP_REMOTE THEN DO;

   5908  4 000627   200021 236100                    LDQ     I,,AUTO
         4 000630   000006 402007                    MPY     6,DL
         4 000631   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 000632   000003 720106                    LXL0    3,QL,PR0
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:53   
         4 000633   000002 100003                    CMPX0   2,DU
         4 000634   000650 601000 4                  TNZ     s:5916

      419     5909                            %POINTERIZE (PTR="VD$RECORD_SET.DESC.KEY.V$ (I)");

   5910  4 000635   000004 235106                    LDA     4,QL,PR0
         4 000636   000643 601000 4                  TNZ     s:5913

   5911  4 000637   000000 621006                    EAX1    0,QL
         4 000640   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000641   000004 756111                    STQ     4,X1,PR0
         4 000642   000650 710000 4                  TRA     s:5916

   5913  4 000643   000000 621006                    EAX1    0,QL
         4 000644   000004 236106                    LDQ     4,QL,PR0
         4 000645   000022 736000                    QLS     18
         4 000646   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000647   000004 756111                    STQ     4,X1,PR0

      420     5915    6                       END;

      421     5916    5                    END;

   5916  4 000650   200021 054100                    AOS     I,,AUTO
         4 000651   000002 236100                    LDQ     2,,PR0
         4 000652   000022 732000                    QRS     18
         4 000653   200021 116100                    CMPQ    I,,AUTO
         4 000654   000627 605400 4                  TPNZ    s:5908
         4 000655   001540 710000 4                  TRA     s:6202

      422     5917
      423     5918    4               CASE (%CLS_STRUCTURE_SPEC);

      424     5919                      %POINTERIZE (PTR=VD$STRUCTURE_SPEC.FLINK$);

   5920  4 000656   000001 235100                    LDA     1,,PR0
         4 000657   000663 601000 4                  TNZ     s:5923
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:54   

   5921  4 000660   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000661   000001 756100                    STQ     1,,PR0
         4 000662   000667 710000 4                  TRA     s:5926

   5923  4 000663   000001 236100                    LDQ     1,,PR0
         4 000664   000022 736000                    QLS     18
         4 000665   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000666   000001 756100                    STQ     1,,PR0

      425     5925                      %POINTERIZE (PTR=VD$STRUCTURE_SPEC.ACCESSOR$);

   5926  4 000667   000003 235100                    LDA     3,,PR0
         4 000670   000674 601000 4                  TNZ     s:5929

   5927  4 000671   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000672   000003 756100                    STQ     3,,PR0
         4 000673   000700 710000 4                  TRA     s:5932

   5929  4 000674   000003 236100                    LDQ     3,,PR0
         4 000675   000022 736000                    QLS     18
         4 000676   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000677   000003 756100                    STQ     3,,PR0

      426     5931                      %POINTERIZE (PTR=VD$STRUCTURE_SPEC.FIT$);

   5932  4 000700   000004 235100                    LDA     4,,PR0
         4 000701   000705 601000 4                  TNZ     s:5935

   5933  4 000702   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000703   000004 756100                    STQ     4,,PR0
         4 000704   001540 710000 4                  TRA     s:6202

   5935  4 000705   000004 236100                    LDQ     4,,PR0
         4 000706   000022 736000                    QLS     18
         4 000707   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000710   000004 756100                    STQ     4,,PR0
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:55   
         4 000711   001540 710000 4                  TRA     s:6202

      427     5937
      428     5938    4               CASE (%CLS_IT_ADJUST);

      429     5939                      %POINTERIZE (PTR=VD$IT_ADJUST.PARENT$);

   5940  4 000712   000001 235100                    LDA     1,,PR0
         4 000713   000717 601000 4                  TNZ     s:5943

   5941  4 000714   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000715   000001 756100                    STQ     1,,PR0
         4 000716   000723 710000 4                  TRA     s:5946

   5943  4 000717   000001 236100                    LDQ     1,,PR0
         4 000720   000022 736000                    QLS     18
         4 000721   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000722   000001 756100                    STQ     1,,PR0

      430     5945                      %POINTERIZE (PTR=VD$IT_ADJUST.FLINK$);

   5946  4 000723   000002 235100                    LDA     2,,PR0
         4 000724   000730 601000 4                  TNZ     s:5949

   5947  4 000725   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000726   000002 756100                    STQ     2,,PR0
         4 000727   000734 710000 4                  TRA     s:5952

   5949  4 000730   000002 236100                    LDQ     2,,PR0
         4 000731   000022 736000                    QLS     18
         4 000732   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000733   000002 756100                    STQ     2,,PR0

      431     5951                      %POINTERIZE (PTR=VD$IT_ADJUST.MOVEMENTS$);

   5952  4 000734   000004 235100                    LDA     4,,PR0
         4 000735   000741 601000 4                  TNZ     s:5955
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:56   

   5953  4 000736   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000737   000004 756100                    STQ     4,,PR0
         4 000740   000745 710000 4                  TRA     s:5958

   5955  4 000741   000004 236100                    LDQ     4,,PR0
         4 000742   000022 736000                    QLS     18
         4 000743   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000744   000004 756100                    STQ     4,,PR0

      432     5957                      %POINTERIZE (PTR=VD$IT_ADJUST.MOVEMENTS_TAIL$);

   5958  4 000745   000005 235100                    LDA     5,,PR0
         4 000746   000752 601000 4                  TNZ     s:5961

   5959  4 000747   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000750   000005 756100                    STQ     5,,PR0
         4 000751   001540 710000 4                  TRA     s:6202

   5961  4 000752   000005 236100                    LDQ     5,,PR0
         4 000753   000022 736000                    QLS     18
         4 000754   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000755   000005 756100                    STQ     5,,PR0
         4 000756   001540 710000 4                  TRA     s:6202

      433     5963
      434     5964    4               CASE (%CLS_IT_BLOCK_EXPR);

      435     5965                      %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.FLINK$);

   5966  4 000757   000002 235100                    LDA     2,,PR0
         4 000760   000764 601000 4                  TNZ     s:5969

   5967  4 000761   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000762   000002 756100                    STQ     2,,PR0
         4 000763   000770 710000 4                  TRA     s:5971

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:57   
   5969  4 000764   000002 236100                    LDQ     2,,PR0
         4 000765   000022 736000                    QLS     18
         4 000766   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 000767   000002 756100                    STQ     2,,PR0

      436     5971    5                 IF VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.REP# = %REP_REMOTE THEN DO;

   5971  4 000770   000004 721100                    LXL1    4,,PR0
         4 000771   000002 101003                    CMPX1   2,DU
         4 000772   001004 601000 4                  TNZ     s:5979

      437     5972                         %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.V$);

   5973  4 000773   000005 235100                    LDA     5,,PR0
         4 000774   001000 601000 4                  TNZ     s:5976

   5974  4 000775   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000776   000005 756100                    STQ     5,,PR0
         4 000777   001004 710000 4                  TRA     s:5979

   5976  4 001000   000005 236100                    LDQ     5,,PR0
         4 001001   000022 736000                    QLS     18
         4 001002   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001003   000005 756100                    STQ     5,,PR0

      438     5978    5                    END;

      439     5979    4                 CALL POINTERIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.START);

   5979  4 001004   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001005   000006 036003                    ADLQ    6,DU
         4 001006   200023 756100                    STQ     I+2,,AUTO
         4 001007   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 001010   000000 011000                    NOP     0

      440     5980    4                 CALL POINTERIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.ENDD);

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:58   
   5980  4 001011   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001012   000017 036003                    ADLQ    15,DU
         4 001013   200023 756100                    STQ     I+2,,AUTO
         4 001014   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 001015   000000 011000                    NOP     0

      441     5981    4                 VD$IT_BLOCK_EXPR.OPTIONS.STRUCTURE$ = ADDR(NIL);

   5981  4 001016   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001017   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 001020   000030 756100                    STQ     24,,PR0

      442     5982    5                 IF VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;

   5982  4 001021   000033 720100                    LXL0    27,,PR0
         4 001022   000002 100003                    CMPX0   2,DU
         4 001023   001034 601000 4                  TNZ     s:5991

      443     5983                         %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.V$);

   5984  4 001024   000034 235100                    LDA     28,,PR0
         4 001025   001030 601000 4                  TNZ     s:5987

   5985  4 001026   000034 756100                    STQ     28,,PR0
         4 001027   001034 710000 4                  TRA     s:5991

   5987  4 001030   000034 236100                    LDQ     28,,PR0
         4 001031   000022 736000                    QLS     18
         4 001032   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001033   000034 756100                    STQ     28,,PR0

      444     5989    5                    END;

      445     5990                      %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.SELECTS$);

   5991  4 001034   000035 235100                    LDA     29,,PR0
         4 001035   001041 601000 4                  TNZ     s:5994
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:59   

   5992  4 001036   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001037   000035 756100                    STQ     29,,PR0
         4 001040   001045 710000 4                  TRA     s:5997

   5994  4 001041   000035 236100                    LDQ     29,,PR0
         4 001042   000022 736000                    QLS     18
         4 001043   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001044   000035 756100                    STQ     29,,PR0

      446     5996                      %POINTERIZE (PTR=VD$IT_BLOCK_EXPR.SELECTS_TAIL$);

   5997  4 001045   000036 235100                    LDA     30,,PR0
         4 001046   001052 601000 4                  TNZ     s:6000

   5998  4 001047   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001050   000036 756100                    STQ     30,,PR0
         4 001051   001540 710000 4                  TRA     s:6202

   6000  4 001052   000036 236100                    LDQ     30,,PR0
         4 001053   000022 736000                    QLS     18
         4 001054   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001055   000036 756100                    STQ     30,,PR0
         4 001056   001540 710000 4                  TRA     s:6202

      447     6002
      448     6003    4               CASE (%CLS_IT_COMMAND);

      449     6004                      %POINTERIZE (PTR=VD$IT_COMMAND.PARENT$);

   6005  4 001057   000001 235100                    LDA     1,,PR0
         4 001060   001064 601000 4                  TNZ     s:6008

   6006  4 001061   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001062   000001 756100                    STQ     1,,PR0
         4 001063   001070 710000 4                  TRA     s:6011

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:60   
   6008  4 001064   000001 236100                    LDQ     1,,PR0
         4 001065   000022 736000                    QLS     18
         4 001066   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001067   000001 756100                    STQ     1,,PR0

      450     6010                      %POINTERIZE (PTR=VD$IT_COMMAND.FLINK$);

   6011  4 001070   000002 235100                    LDA     2,,PR0
         4 001071   001075 601000 4                  TNZ     s:6014

   6012  4 001072   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001073   000002 756100                    STQ     2,,PR0
         4 001074   001101 710000 4                  TRA     s:6016

   6014  4 001075   000002 236100                    LDQ     2,,PR0
         4 001076   000022 736000                    QLS     18
         4 001077   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001100   000002 756100                    STQ     2,,PR0

      451     6016    5                 DO I = 0 TO %MX_COMMAND_PARAMS-1;

   6016  4 001101   200021 450100                    STZ     I,,AUTO
         4 001102   001117 710000 4                  TRA     s:6023+1

      452     6017                         %POINTERIZE (PTR="VD$IT_COMMAND.PARAM$ (I)");

   6018  4 001103   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 001104   200021 720100                    LXL0    I,,AUTO
         4 001105   000006 235110                    LDA     6,X0,PR0
         4 001106   001112 601000 4                  TNZ     s:6021

   6019  4 001107   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001110   000006 756110                    STQ     6,X0,PR0
         4 001111   001116 710000 4                  TRA     s:6023

   6021  4 001112   000006 236110                    LDQ     6,X0,PR0
         4 001113   000022 736000                    QLS     18
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:61   
         4 001114   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001115   000006 756110                    STQ     6,X0,PR0

      453     6023    5                    END;

   6023  4 001116   200021 054100                    AOS     I,,AUTO
         4 001117   200021 235100                    LDA     I,,AUTO
         4 001120   000010 115007                    CMPA    8,DL
         4 001121   001103 604400 4                  TMOZ    s:6018
         4 001122   001540 710000 4                  TRA     s:6202

      454     6024
      455     6025    4               CASE (%CLS_IT_OPERAND);

      456     6026                      %POINTERIZE (PTR=VD$IT_OPERAND.PARENT$);

   6027  4 001123   000001 235100                    LDA     1,,PR0
         4 001124   001130 601000 4                  TNZ     s:6030

   6028  4 001125   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001126   000001 756100                    STQ     1,,PR0
         4 001127   001134 710000 4                  TRA     s:6033

   6030  4 001130   000001 236100                    LDQ     1,,PR0
         4 001131   000022 736000                    QLS     18
         4 001132   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001133   000001 756100                    STQ     1,,PR0

      457     6032                      %POINTERIZE (PTR=VD$IT_OPERAND.FLINK$);

   6033  4 001134   000002 235100                    LDA     2,,PR0
         4 001135   001141 601000 4                  TNZ     s:6036

   6034  4 001136   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001137   000002 756100                    STQ     2,,PR0
         4 001140   001145 710000 4                  TRA     s:6038

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:62   
   6036  4 001141   000002 236100                    LDQ     2,,PR0
         4 001142   000022 736000                    QLS     18
         4 001143   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001144   000002 756100                    STQ     2,,PR0

      458     6038    5                 IF VD$IT_OPERAND.KEY.REP# = %REP_REMOTE THEN DO;

   6038  4 001145   000006 721100                    LXL1    6,,PR0
         4 001146   000002 101003                    CMPX1   2,DU
         4 001147   001161 601000 4                  TNZ     s:6047

      459     6039                         %POINTERIZE (PTR=VD$IT_OPERAND.KEY.V$);

   6040  4 001150   000007 235100                    LDA     7,,PR0
         4 001151   001155 601000 4                  TNZ     s:6043

   6041  4 001152   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001153   000007 756100                    STQ     7,,PR0
         4 001154   001161 710000 4                  TRA     s:6047

   6043  4 001155   000007 236100                    LDQ     7,,PR0
         4 001156   000022 736000                    QLS     18
         4 001157   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001160   000007 756100                    STQ     7,,PR0

      460     6045    5                    END;

      461     6046                      %POINTERIZE (PTR=VD$IT_OPERAND.PARAM$);

   6047  4 001161   000010 235100                    LDA     8,,PR0
         4 001162   001166 601000 4                  TNZ     s:6050

   6048  4 001163   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001164   000010 756100                    STQ     8,,PR0
         4 001165   001540 710000 4                  TRA     s:6202

   6050  4 001166   000010 236100                    LDQ     8,,PR0
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:63   
         4 001167   000022 736000                    QLS     18
         4 001170   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001171   000010 756100                    STQ     8,,PR0
         4 001172   001540 710000 4                  TRA     s:6202

      462     6052
      463     6053    4               CASE (%CLS_IT_OPERATOR);

      464     6054                      %POINTERIZE (PTR=VD$IT_OPERATOR.PARENT$);

   6055  4 001173   000001 235100                    LDA     1,,PR0
         4 001174   001200 601000 4                  TNZ     s:6058

   6056  4 001175   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001176   000001 756100                    STQ     1,,PR0
         4 001177   001204 710000 4                  TRA     s:6061

   6058  4 001200   000001 236100                    LDQ     1,,PR0
         4 001201   000022 736000                    QLS     18
         4 001202   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001203   000001 756100                    STQ     1,,PR0

      465     6060                      %POINTERIZE (PTR=VD$IT_OPERATOR.FLINK$);

   6061  4 001204   000002 235100                    LDA     2,,PR0
         4 001205   001211 601000 4                  TNZ     s:6064

   6062  4 001206   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001207   000002 756100                    STQ     2,,PR0
         4 001210   001215 710000 4                  TRA     s:6067

   6064  4 001211   000002 236100                    LDQ     2,,PR0
         4 001212   000022 736000                    QLS     18
         4 001213   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001214   000002 756100                    STQ     2,,PR0

      466     6066                      %POINTERIZE (PTR=VD$IT_OPERATOR.OPERAND$);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:64   

   6067  4 001215   000004 235100                    LDA     4,,PR0
         4 001216   001222 601000 4                  TNZ     s:6070

   6068  4 001217   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001220   000004 756100                    STQ     4,,PR0
         4 001221   001226 710000 4                  TRA     s:6073

   6070  4 001222   000004 236100                    LDQ     4,,PR0
         4 001223   000022 736000                    QLS     18
         4 001224   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001225   000004 756100                    STQ     4,,PR0

      467     6072                      %POINTERIZE (PTR=VD$IT_OPERATOR.R_OPERAND$);

   6073  4 001226   000005 235100                    LDA     5,,PR0
         4 001227   001233 601000 4                  TNZ     s:6076

   6074  4 001230   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001231   000005 756100                    STQ     5,,PR0
         4 001232   001540 710000 4                  TRA     s:6202

   6076  4 001233   000005 236100                    LDQ     5,,PR0
         4 001234   000022 736000                    QLS     18
         4 001235   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001236   000005 756100                    STQ     5,,PR0
         4 001237   001540 710000 4                  TRA     s:6202

      468     6078
      469     6079    4               CASE (%CLS_IT_SELECT);

      470     6080                      %POINTERIZE (PTR=VD$IT_SELECT.PARENT$);

   6081  4 001240   000001 235100                    LDA     1,,PR0
         4 001241   001245 601000 4                  TNZ     s:6084

   6082  4 001242   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:65   
         4 001243   000001 756100                    STQ     1,,PR0
         4 001244   001251 710000 4                  TRA     s:6087

   6084  4 001245   000001 236100                    LDQ     1,,PR0
         4 001246   000022 736000                    QLS     18
         4 001247   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001250   000001 756100                    STQ     1,,PR0

      471     6086                      %POINTERIZE (PTR=VD$IT_SELECT.FLINK$);

   6087  4 001251   000002 235100                    LDA     2,,PR0
         4 001252   001256 601000 4                  TNZ     s:6090

   6088  4 001253   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001254   000002 756100                    STQ     2,,PR0
         4 001255   001262 710000 4                  TRA     s:6093

   6090  4 001256   000002 236100                    LDQ     2,,PR0
         4 001257   000022 736000                    QLS     18
         4 001260   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001261   000002 756100                    STQ     2,,PR0

      472     6092                      %POINTERIZE (PTR=VD$IT_SELECT.ADJUSTS$);

   6093  4 001262   000004 235100                    LDA     4,,PR0
         4 001263   001267 601000 4                  TNZ     s:6096

   6094  4 001264   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001265   000004 756100                    STQ     4,,PR0
         4 001266   001273 710000 4                  TRA     s:6099

   6096  4 001267   000004 236100                    LDQ     4,,PR0
         4 001270   000022 736000                    QLS     18
         4 001271   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001272   000004 756100                    STQ     4,,PR0

      473     6098                      %POINTERIZE (PTR=VD$IT_SELECT.ADJUSTS_TAIL$);
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:66   

   6099  4 001273   000005 235100                    LDA     5,,PR0
         4 001274   001300 601000 4                  TNZ     s:6102

   6100  4 001275   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001276   000005 756100                    STQ     5,,PR0
         4 001277   001540 710000 4                  TRA     s:6202

   6102  4 001300   000005 236100                    LDQ     5,,PR0
         4 001301   000022 736000                    QLS     18
         4 001302   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001303   000005 756100                    STQ     5,,PR0
         4 001304   001540 710000 4                  TRA     s:6202

      474     6104
      475     6105    4               CASE (%CLS_BLOCK_DESC, %CLS_BLOCK_BUFFER);

      476     6106    5                 IF VD$OBJECT_HEADER.CLASS# = %CLS_BLOCK_BUFFER THEN DO;

   6106  4 001305   000001 100003                    CMPX0   1,DU
         4 001306   001325 601000 4                  TNZ     s:6115

      477     6107                         %POINTERIZE (PTR=VD$BUFFER_HEADER.FLINK$);

   6108  4 001307   000001 235100                    LDA     1,,PR0
         4 001310   001314 601000 4                  TNZ     s:6111

   6109  4 001311   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001312   000001 756100                    STQ     1,,PR0
         4 001313   001320 710000 4                  TRA     s:6113

   6111  4 001314   000001 236100                    LDQ     1,,PR0
         4 001315   000022 736000                    QLS     18
         4 001316   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001317   000001 756100                    STQ     1,,PR0

      478     6113    5                    OBJECT_HEADER$ = PALIGNW(ADDR(VD$BUFFER.BYTES));
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:67   

   6113  4 001320   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001321   000005 036000 5                  ADLQ    5
         4 001322   770000 036007                    ADLQ    -4096,DL
         4 001323   000006 376000 5                  ANQ     6
         4 001324   200017 756100                    STQ     OBJECT_HEADER$,,AUTO

      479     6114    5                    END;

      480     6115    5                 IF VD$BLOCK_DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;

   6115  4 001325   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 001326   000001 720100                    LXL0    1,,PR0
         4 001327   000002 100003                    CMPX0   2,DU
         4 001330   001342 601000 4                  TNZ     s:6123

      481     6116                         %POINTERIZE (PTR=VD$BLOCK_DESC.FILE_KEY.V$);

   6117  4 001331   000002 235100                    LDA     2,,PR0
         4 001332   001336 601000 4                  TNZ     s:6120

   6118  4 001333   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001334   000002 756100                    STQ     2,,PR0
         4 001335   001342 710000 4                  TRA     s:6123

   6120  4 001336   000002 236100                    LDQ     2,,PR0
         4 001337   000022 736000                    QLS     18
         4 001340   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001341   000002 756100                    STQ     2,,PR0

      482     6122    5                    END;

      483     6123    4                 CALL POINTERIZE_LOCATION (VD$BLOCK_DESC.RANGE.START);

   6123  4 001342   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001343   000003 036003                    ADLQ    3,DU
         4 001344   200023 756100                    STQ     I+2,,AUTO
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:68   
         4 001345   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 001346   000000 011000                    NOP     0

      484     6124    4                 CALL POINTERIZE_LOCATION (VD$BLOCK_DESC.RANGE.ENDD);

   6124  4 001347   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001350   000014 036003                    ADLQ    12,DU
         4 001351   200023 756100                    STQ     I+2,,AUTO
         4 001352   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 001353   000000 011000                    NOP     0

      485     6125                      %POINTERIZE (PTR=VD$BLOCK_DESC.OPTIONS.STRUCTURE$);

   6126  4 001354   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 001355   000025 235100                    LDA     21,,PR0
         4 001356   001362 601000 4                  TNZ     s:6129

   6127  4 001357   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001360   000025 756100                    STQ     21,,PR0
         4 001361   001366 710000 4                  TRA     s:6131

   6129  4 001362   000025 236100                    LDQ     21,,PR0
         4 001363   000022 736000                    QLS     18
         4 001364   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001365   000025 756100                    STQ     21,,PR0

      486     6131    5                 IF VD$BLOCK_DESC.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;

   6131  4 001366   000030 720100                    LXL0    24,,PR0
         4 001367   000002 100003                    CMPX0   2,DU
         4 001370   001540 601000 4                  TNZ     s:6202

      487     6132                         %POINTERIZE (PTR=VD$BLOCK_DESC.OPTIONS.KEY_INCR.V$);

   6133  4 001371   000031 235100                    LDA     25,,PR0
         4 001372   001376 601000 4                  TNZ     s:6136

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:69   
   6134  4 001373   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001374   000031 756100                    STQ     25,,PR0
         4 001375   001540 710000 4                  TRA     s:6202

   6136  4 001376   000031 236100                    LDQ     25,,PR0
         4 001377   000022 736000                    QLS     18
         4 001400   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001401   000031 756100                    STQ     25,,PR0

      488     6138    5                    END;

   6138  4 001402   001540 710000 4                  TRA     s:6202

      489     6139
      490     6140    4               CASE (%CLS_PATTERN);

      491     6141    5                 DO I = 0 TO VD$PATTERN.N_ENTRIES# - 1;

   6141  4 001403   200021 450100                    STZ     I,,AUTO
         4 001404   001426 710000 4                  TRA     s:6148+1

      492     6142                         %POINTERIZE (PTR="VD$PATTERN.ENTRIES.MATCH$ (I)");

   6143  4 001405   200021 235100                    LDA     I,,AUTO
         4 001406   000002 735000                    ALS     2
         4 001407   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 001410   000006 235105                    LDA     6,AL,PR0
         4 001411   001417 601000 4                  TNZ     s:6146

   6144  4 001412   200021 235100                    LDA     I,,AUTO
         4 001413   000002 735000                    ALS     2
         4 001414   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001415   000006 756105                    STQ     6,AL,PR0
         4 001416   001425 710000 4                  TRA     s:6148

   6146  4 001417   200021 235100                    LDA     I,,AUTO
         4 001420   000002 735000                    ALS     2
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:70   
         4 001421   000006 236105                    LDQ     6,AL,PR0
         4 001422   000022 736000                    QLS     18
         4 001423   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001424   000006 756105                    STQ     6,AL,PR0

      493     6148    5                    END;

   6148  4 001425   200021 054100                    AOS     I,,AUTO
         4 001426   000002 236100                    LDQ     2,,PR0
         4 001427   000022 732000                    QRS     18
         4 001430   200021 116100                    CMPQ    I,,AUTO
         4 001431   001405 605400 4                  TPNZ    s:6143
         4 001432   001540 710000 4                  TRA     s:6202

      494     6149
      495     6150    4               CASE (%CLS_EVAL);

      496     6151                      %POINTERIZE (PTR=VD$EVAL.BLINK$);

   6152  4 001433   000001 235100                    LDA     1,,PR0
         4 001434   001440 601000 4                  TNZ     s:6155

   6153  4 001435   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001436   000001 756100                    STQ     1,,PR0
         4 001437   001444 710000 4                  TRA     s:6157

   6155  4 001440   000001 236100                    LDQ     1,,PR0
         4 001441   000022 736000                    QLS     18
         4 001442   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001443   000001 756100                    STQ     1,,PR0

      497     6157    4                 CALL POINTERIZE_LOCATION (VD$EVAL.ENCLOSING.START);

   6157  4 001444   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001445   000002 036003                    ADLQ    2,DU
         4 001446   200023 756100                    STQ     I+2,,AUTO
         4 001447   001775 701000 4                  TSX1    POINTERIZE_LOCATION
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:71   
         4 001450   000000 011000                    NOP     0

      498     6158    4                 CALL POINTERIZE_LOCATION (VD$EVAL.ENCLOSING.ENDD);

   6158  4 001451   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001452   000013 036003                    ADLQ    11,DU
         4 001453   200023 756100                    STQ     I+2,,AUTO
         4 001454   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 001455   000000 011000                    NOP     0

      499     6159    4                 CALL POINTERIZE_LOCATION (VD$EVAL.RANGE.START);

   6159  4 001456   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001457   000024 036003                    ADLQ    20,DU
         4 001460   200023 756100                    STQ     I+2,,AUTO
         4 001461   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 001462   000000 011000                    NOP     0

      500     6160    4                 CALL POINTERIZE_LOCATION (VD$EVAL.RANGE.ENDD);

   6160  4 001463   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001464   000035 036003                    ADLQ    29,DU
         4 001465   200023 756100                    STQ     I+2,,AUTO
         4 001466   001775 701000 4                  TSX1    POINTERIZE_LOCATION
         4 001467   000000 011000                    NOP     0
         4 001470   001540 710000 4                  TRA     s:6202

      501     6161        /*N**N**N* How do we pointerize VD$EVAL.NODE$?  It can't be stored
      502     6162        **N**N**N*  in the same record.  Maybe store a "walking index":
      503     6163        **N**N**N*  count of # of node when walking the InTree?
      504     6164        **N**N**N*/
      505     6165
      506     6166    4               CASE (%CLS_FIT);

      507     6167                      %POINTERIZE (PTR=VD$FIT.CODE2$);

   6168  4 001471   000001 235100                    LDA     1,,PR0
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:72   
         4 001472   001476 601000 4                  TNZ     s:6171

   6169  4 001473   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001474   000001 756100                    STQ     1,,PR0
         4 001475   001502 710000 4                  TRA     s:6174

   6171  4 001476   000001 236100                    LDQ     1,,PR0
         4 001477   000022 736000                    QLS     18
         4 001500   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001501   000001 756100                    STQ     1,,PR0

      508     6173                      %POINTERIZE (PTR=VD$FIT.CODE3$);

   6174  4 001502   000002 235100                    LDA     2,,PR0
         4 001503   001507 601000 4                  TNZ     s:6177

   6175  4 001504   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001505   000002 756100                    STQ     2,,PR0
         4 001506   001540 710000 4                  TRA     s:6202

   6177  4 001507   000002 236100                    LDQ     2,,PR0
         4 001510   000022 736000                    QLS     18
         4 001511   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001512   000002 756100                    STQ     2,,PR0
         4 001513   001540 710000 4                  TRA     s:6202

      509     6179
      510     6180    4               CASE (%CLS_PTR_BLOCK_DESC, %CLS_PTR_FILE_NODE,

      511     6181    4                   %CLS_PTR_INTREE, %CLS_PTR_KEY, %CLS_PTR_LOCATION, %CLS_PTR_TEXTC);
      512     6182                      %POINTERIZE (PTR=VD$POINTER.FLINK$);

   6183  4 001514   000001 235100                    LDA     1,,PR0
         4 001515   001521 601000 4                  TNZ     s:6186

   6184  4 001516   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001517   000001 756100                    STQ     1,,PR0
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:73   
         4 001520   001525 710000 4                  TRA     s:6189

   6186  4 001521   000001 236100                    LDQ     1,,PR0
         4 001522   000022 736000                    QLS     18
         4 001523   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001524   000001 756100                    STQ     1,,PR0

      513     6188                      %POINTERIZE (PTR=VD$POINTER.V$);

   6189  4 001525   000003 235100                    LDA     3,,PR0
         4 001526   001532 601000 4                  TNZ     s:6192

   6190  4 001527   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001530   000003 756100                    STQ     3,,PR0
         4 001531   001540 710000 4                  TRA     s:6202

   6192  4 001532   000003 236100                    LDQ     3,,PR0
         4 001533   000022 736000                    QLS     18
         4 001534   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 001535   000003 756100                    STQ     3,,PR0
         4 001536   001540 710000 4                  TRA     s:6202

      514     6194
      515     6195    4               CASE (%CLS_CMD_STREAM, %CLS_ENCODED_NODE, %CLS_DIR_NODE,

      516     6196    4                   %CLS_FILE_NODE, %CLS_STREAM, %CLS_PORT, ELSE);
      517     6197                      /* Invalid object class stored in workspace record */
      518     6198    4                 GOTO WS_FILE_INVALID_FAILURE;

   6198  4 001537   001710 710000 4                  TRA     INVALID_WORKSPACE_FAILURE

      519     6199
      520     6200    4               END OBJECT_TYPE_CASES;

      521     6201
      522     6202    3              IF VD$OBJECT_HEADER.SIZE# = 0 THEN

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:74   
   6202  4 001540   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 001541   000000 720100                    LXL0    0,,PR0
         4 001542   001552 601000 4                  TNZ     s:6206

      523     6203    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,

   6203  4 001543   000000 221100                    LDX1    0,,PR0
         4 001544   000000 021100                    ADLX1   0,,PR0
         4 001545   000000 222011 xsym               LDX2    VD_OBJECTS,X1
         4 001546   000000 636012                    EAQ     0,X2
         4 001547   200017 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         4 001550   200017 756100                    STQ     OBJECT_HEADER$,,AUTO
         4 001551   001555 710000 4                  TRA     s:6208

      524     6204    3                   VD_OBJECTS.SIZE (VD$OBJECT_HEADER.CLASS#));
      525     6205    3              ELSE
      526     6206    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,

   6206  4 001552   000000 636010                    EAQ     0,X0
         4 001553   200017 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         4 001554   200017 756100                    STQ     OBJECT_HEADER$,,AUTO

      527     6207    3                   VD$OBJECT_HEADER.SIZE#);
      528     6208    3              END EACH_OBJECT;

   6208  4 001555   200017 235100                    LDA     OBJECT_HEADER$,,AUTO
         4 001556   000022 771000                    ARL     18
         4 001557   200062 755100                    STA     VLP_LINEATTR+16,,AUTO
         4 001560   200020 236100                    LDQ     OBJECT_LIMIT$,,AUTO
         4 001561   000022 772000                    QRL     18
         4 001562   200062 136100                    SBLQ    VLP_LINEATTR+16,,AUTO
         4 001563   000343 605400 4                  TPNZ    OBJECT_TYPE_CASES

      529     6209
      530     6210    2           OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));

   6210  4 001564   200006 236100                    LDQ     ENCODED_NODE$,,AUTO
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:75   
         4 001565   000031 036003                    ADLQ    25,DU
         4 001566   200017 756100                    STQ     OBJECT_HEADER$,,AUTO

      531     6211
      532     6212    2   EACH_OBJECT_AGAIN:
      533     6213    3           DO WHILE (POFFW(OBJECT_LIMIT$, OBJECT_HEADER$) > 0);

   6213  4 001567   001677 710000 4     EACH_OBJECT* TRA     s:6236

      534     6214
      535     6215    3   OBJECT_TYPE_CASES_AGAIN:
      536     6216    4              DO CASE (VD$OBJECT_HEADER.CLASS#);

   6216  4 001570   200017 470500       OBJECT_TYPE* LDP0    OBJECT_HEADER$,,AUTO
         4 001571   000000 220100                    LDX0    0,,PR0
         4 001572   000042 100003                    CMPX0   34,DU
         4 001573   001575 602010 4                  TNC     OBJECT_TYPE_CASES_AGAIN+5,X0
         4 001574   001662 710000 4                  TRA     s:6230
         4 001575   001662 710000 4                  TRA     s:6230
         4 001576   001637 710000 4                  TRA     s:6219
         4 001577   001637 710000 4                  TRA     s:6219
         4 001600   001662 710000 4                  TRA     s:6230
         4 001601   001662 710000 4                  TRA     s:6230
         4 001602   001662 710000 4                  TRA     s:6230
         4 001603   001662 710000 4                  TRA     s:6230
         4 001604   001662 710000 4                  TRA     s:6230
         4 001605   001662 710000 4                  TRA     s:6230
         4 001606   001662 710000 4                  TRA     s:6230
         4 001607   001662 710000 4                  TRA     s:6230
         4 001610   001662 710000 4                  TRA     s:6230
         4 001611   001662 710000 4                  TRA     s:6230
         4 001612   001662 710000 4                  TRA     s:6230
         4 001613   001662 710000 4                  TRA     s:6230
         4 001614   001662 710000 4                  TRA     s:6230
         4 001615   001662 710000 4                  TRA     s:6230
         4 001616   001662 710000 4                  TRA     s:6230
         4 001617   001662 710000 4                  TRA     s:6230
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:76   
         4 001620   001662 710000 4                  TRA     s:6230
         4 001621   001662 710000 4                  TRA     s:6230
         4 001622   001662 710000 4                  TRA     s:6230
         4 001623   001662 710000 4                  TRA     s:6230
         4 001624   001662 710000 4                  TRA     s:6230
         4 001625   001662 710000 4                  TRA     s:6230
         4 001626   001662 710000 4                  TRA     s:6230
         4 001627   001662 710000 4                  TRA     s:6230
         4 001630   001662 710000 4                  TRA     s:6230
         4 001631   001662 710000 4                  TRA     s:6230
         4 001632   001662 710000 4                  TRA     s:6230
         4 001633   001662 710000 4                  TRA     s:6230
         4 001634   001662 710000 4                  TRA     s:6230
         4 001635   001662 710000 4                  TRA     s:6230
         4 001636   001654 710000 4                  TRA     s:6224

      537     6217
      538     6218    4               CASE (%CLS_BLOCK_DESC, %CLS_BLOCK_BUFFER);

      539     6219    4                 IF VD$OBJECT_HEADER.CLASS# = %CLS_BLOCK_BUFFER THEN

   6219  4 001637   000001 100003                    CMPX0   1,DU
         4 001640   001646 601000 4                  TNZ     s:6221

      540     6220    4                    OBJECT_HEADER$ = PALIGNW(ADDR(VD$BUFFER.BYTES));

   6220  4 001641   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001642   000005 036000 5                  ADLQ    5
         4 001643   770000 036007                    ADLQ    -4096,DL
         4 001644   000006 376000 5                  ANQ     6
         4 001645   200017 756100                    STQ     OBJECT_HEADER$,,AUTO

      541     6221    4                 CALL POINTERIZE_STRUCTURE (VD$BLOCK_DESC.OPTIONS.STRUCTURE$);

   6221  4 001646   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001647   000025 036003                    ADLQ    21,DU
         4 001650   200023 756100                    STQ     I+2,,AUTO
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:77   
         4 001651   001734 701000 4                  TSX1    POINTERIZE_STRUCTURE
         4 001652   000000 011000                    NOP     0
         4 001653   001662 710000 4                  TRA     s:6230

      542     6222
      543     6223    4               CASE (%CLS_PTR_FILE_NODE);

      544     6224    4                 CALL POINTERIZE_STRUCTURE (VD$POINTER.V$);

   6224  4 001654   200017 236100                    LDQ     OBJECT_HEADER$,,AUTO
         4 001655   000003 036003                    ADLQ    3,DU
         4 001656   200023 756100                    STQ     I+2,,AUTO
         4 001657   001734 701000 4                  TSX1    POINTERIZE_STRUCTURE
         4 001660   000000 011000                    NOP     0
         4 001661   001662 710000 4                  TRA     s:6230

      545     6225
      546     6226    4               CASE (ELSE);

      547     6227
      548     6228    4               END OBJECT_TYPE_CASES_AGAIN;

      549     6229
      550     6230    3              IF VD$OBJECT_HEADER.SIZE# = 0 THEN

   6230  4 001662   200017 470500                    LDP0    OBJECT_HEADER$,,AUTO
         4 001663   000000 720100                    LXL0    0,,PR0
         4 001664   001674 601000 4                  TNZ     s:6234

      551     6231    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,

   6231  4 001665   000000 221100                    LDX1    0,,PR0
         4 001666   000000 021100                    ADLX1   0,,PR0
         4 001667   000000 222011 xsym               LDX2    VD_OBJECTS,X1
         4 001670   000000 636012                    EAQ     0,X2
         4 001671   200017 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         4 001672   200017 756100                    STQ     OBJECT_HEADER$,,AUTO
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:78   
         4 001673   001677 710000 4                  TRA     s:6236

      552     6232    3                   VD_OBJECTS.SIZE (VD$OBJECT_HEADER.CLASS#));
      553     6233    3              ELSE
      554     6234    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,

   6234  4 001674   000000 636010                    EAQ     0,X0
         4 001675   200017 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         4 001676   200017 756100                    STQ     OBJECT_HEADER$,,AUTO

      555     6235    3                   VD$OBJECT_HEADER.SIZE#);
      556     6236    3              END EACH_OBJECT_AGAIN;

   6236  4 001677   200017 235100                    LDA     OBJECT_HEADER$,,AUTO
         4 001700   000022 771000                    ARL     18
         4 001701   200062 755100                    STA     VLP_LINEATTR+16,,AUTO
         4 001702   200020 236100                    LDQ     OBJECT_LIMIT$,,AUTO
         4 001703   000022 772000                    QRL     18
         4 001704   200062 136100                    SBLQ    VLP_LINEATTR+16,,AUTO
         4 001705   001570 605400 4                  TPNZ    OBJECT_TYPE_CASES_AGAIN

      557     6237
      558     6238    2           RETURN;

   6238  4 001706   200016 221300                    LDX1  ! WINDOW_SPEC$+2,,AUTO
         4 001707   000001 702211                    TSX2  ! 1,X1

   6231  4 001710                       INVALID_WOR* null
   6231  4 001710                       WS_FILE_INV* null
      559     6239
      560     6240
      561     6241
      562     6242    2   INVALID_WORKSPACE_FAILURE: ;
      563     6243    2   WS_FILE_INVALID_FAILURE: ;
      564     6244    2           CALL VDG$ERRMSG (%E$BAD_WS_FILE, BINBIT (VD$OBJECT_HEADER.CLASS#, 36),

   6244  4 001710   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:79   
         4 001711   000022 772000                    QRL     18
         4 001712   200062 756100                    STQ     VLP_LINEATTR+16,,AUTO
         4 001713   000026 236000 xsym               LDQ     VD_6E+22
         4 001714   000030 036003                    ADLQ    24,DU
         4 001715   200066 756100                    STQ     VLP_LINEATTR+20,,AUTO
         4 001716   200062 631500                    EPPR1   VLP_LINEATTR+16,,AUTO
         4 001717   200065 451500                    STP1    VLP_LINEATTR+19,,AUTO
         4 001720   000004 236000 5                  LDQ     4
         4 001721   200064 756100                    STQ     VLP_LINEATTR+18,,AUTO
         4 001722   200064 630500                    EPPR0   VLP_LINEATTR+18,,AUTO
         4 001723   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001724   000000 701000 xent               TSX1    VDG$ERRMSG
         4 001725   001732 702000 4                  TSX2    s:6248

      565     6245    3             BINBIT(CMD$STREAM.REC_NUM#, 36)) WHENRETURN DO;

      566     6246    3              VD$ERR.DCB# = DCBNUM(M$EI);

   6246  4 001726   000000 236007 xsym               LDQ     M$EI,DL
         4 001727   000000 620006                    EAX0    0,QL
         4 001730   000032 470400 xsym               LDP0    VD_6E+26
         4 001731   000004 740100                    STX0    4,,PR0

      567     6247    3              END;

      568     6248    2           ALTRETURN;

   6248  4 001732   200016 221300                    LDX1  ! WINDOW_SPEC$+2,,AUTO
         4 001733   000000 702211                    TSX2  ! 0,X1

      569     6249
      570     6250        %BOX (TITLE=POINTERIZE_STRUCTURE);

              6262    2   /***************************************************************************
              6264    2    *                                                                         *
              6268    2            *                            POINTERIZE_STRUCTURE                        *
              6270    2            *                                                                        *
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:80   
              6272    2          ***************************************************************************/

      571     6276
      572     6277        /*I* NAME: POINTERIZE_STRUCTURE
      573     6278            PARAMETERS:
      574     6279                STRUCTURE, actually an index into a VD$ENCODED_NODE, possibly zero.
      575     6280            INPUT:
      576     6281                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing STRUCTURE.
      577     6282            OUTPUT:
      578     6283                STRUCTURE resolved to a pointer into the STRUCTURES internal file.
      579     6284            DESCRIPTION:
      580     6285                If STRUCTURE ~= 0, read the key which STRUCTURE "indexes" to from
      581     6286                the internal STRUCTURES file, and place the address of that
      582     6287                VD$FILE_NODE into STRUCTURE.
      583     6288        */
      584     6289
      585     6290    2   POINTERIZE_STRUCTURE: PROC (STRUCTURE) ALTRET;

   6290  4 001734   200022 741300       POINTERIZE_* STX1  ! I+1,,AUTO

      586     6291
      587     6292    3   DCL STRUCTURE PTR PARAM;
      588     6293
      589     6294    3   DCL VDA$LREAD               ENTRY (4) ALTRET;
      590     6295
      591     6296        %VD$BLOCK_DESC;
      592     6443        %VD$BUFFER;
      593     6501        %VD$PORT;
      594     6599        %VD$STREAM;
      595     6705
      596     6706
      597     6707             /* %POINTERIZE (PTR=STRUCTURE); */
      598     6708    3           IF STRUCTURE ~= ADDR(NIL) THEN

   6708  4 001735   200023 470500                    LDP0    @STRUCTURE,,AUTO
         4 001736   000000 236100                    LDQ     0,,PR0
         4 001737   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:81   
         4 001740   001773 600000 4                  TZE     s:6720

      599     6709    3   READ_THE_STRUCTURES_FILE:
      600     6710    4           DO;

   6710  4 001741                       READ_THE_ST* null
      601     6711    4              CALL VDA$LREAD (VD_6E.STRUCTURES$->VD$STREAM,

   6711  4 001741   000000 471500                    LDP1    0,,PR0
         4 001742   000010 237000 5                  LDAQ    8
         4 001743   200064 757100                    STAQ    VLP_LINEATTR+18,,AUTO
         4 001744   100003 633500                    EPPR3   3,,PR1
         4 001745   200063 453500                    STP3    VLP_LINEATTR+17,,AUTO
         4 001746   000005 236000 xsym               LDQ     VD_6E+5
         4 001747   200062 756100                    STQ     VLP_LINEATTR+16,,AUTO
         4 001750   200062 630500                    EPPR0   VLP_LINEATTR+16,,AUTO
         4 001751   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001752   000000 701000 xent               TSX1    VDA$LREAD
         4 001753   001755 702000 4                  TSX2    s:6713
         4 001754   001757 710000 4                  TRA     s:6714

      602     6712    4                STRUCTURE->VD$BLOCK_DESC.RANGE.START, 0, %TRUE)
      603     6713    5              WHENALTRETURN DO; ALTRETURN; END;

   6713  4 001755   200022 221300                    LDX1  ! I+1,,AUTO
         4 001756   000000 702211                    TSX2  ! 0,X1

      604     6714    4              IF VD_6E.STRUCTURES$->VD$STREAM.CURRENT.EOF = %TRUE THEN

   6714  4 001757   000005 470400 xsym               LDP0    VD_6E+5
         4 001760   000016 236100                    LDQ     14,,PR0
         4 001761   400000 316007                    CANQ    -131072,DL
         4 001762   001766 600000 4                  TZE     s:6716

      605     6715    4                 CALL VDG$ESCREECH;

   6715  4 001763   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:82   
         4 001764   000000 701000 xent               TSX1    VDG$ESCREECH
         4 001765   000000 011000                    NOP     0

      606     6716    4              STRUCTURE = VD_6E.STRUCTURES$->VD$STREAM.PORT$->

   6716  4 001766   000005 470400 xsym               LDP0    VD_6E+5
         4 001767   000001 471500                    LDP1    1,,PR0
         4 001770   100040 236100                    LDQ     32,,PR1
         4 001771   200023 473500                    LDP3    @STRUCTURE,,AUTO
         4 001772   300000 756100                    STQ     0,,PR3

      607     6717    4                VD$PORT.LEVEL.INTERNAL$ (%LVL_LOWER);
      608     6718    4              END READ_THE_STRUCTURES_FILE;

      609     6719
      610     6720    3           RETURN;

   6720  4 001773   200022 221300                    LDX1  ! I+1,,AUTO
         4 001774   000001 702211                    TSX2  ! 1,X1

      611     6721
      612     6722    3   END POINTERIZE_STRUCTURE;
      613     6723
      614     6724        %BOX (TITLE=POINTERIZE_LOCATION);

              6736    3   /***************************************************************************
              6738    3    *                                                                         *
              6742    3            *                            POINTERIZE_LOCATION                         *
              6744    3            *                                                                        *
              6746    3          ***************************************************************************/

      615     6750
      616     6751        /*I* NAME: POINTERIZE_LOCATION
      617     6752            PARAMETERS:
      618     6753                LOCATION - VD$LOCATION to pointerize.
      619     6754            INPUT:
      620     6755                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing LOCATION.
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:83   
      621     6756            OUTPUT:
      622     6757                LOCATION's pointers will be resolved into actual pointers.
      623     6758            DESCRIPTION:
      624     6759                Go thru LOCATION's levels, and pointerize any offsets found.
      625     6760        */
      626     6761
      627     6762    2   POINTERIZE_LOCATION: PROC (LOCATION) ALTRET;

   6762  4 001775   200022 741300       POINTERIZE_* STX1  ! I+1,,AUTO

      628     6763
      629     6764        %VD$LOCATION (NAME=LOCATION, STCLASS=PARAM);
      630     6792
      631     6793
      632     6794    3   DCL LVL SBIN;
      633     6795
      634     6796
      635     6797
      636     6798    4           DO LVL = 0 TO (%(MX_LOCATION_LEVELS-1));

   6798  4 001776   200024 450100                    STZ     LVL,,AUTO

      637     6799    5              IF LOCATION.KEY.REP# (LVL) = %REP_REMOTE THEN DO;

   6799  4 001777   200024 235100                    LDA     LVL,,AUTO
         4 002000   000001 735000                    ALS     1
         4 002001   200023 470500                    LDP0    @LOCATION,,AUTO
         4 002002   000000 720105                    LXL0    0,AL,PR0
         4 002003   000002 100003                    CMPX0   2,DU
         4 002004   002022 601000 4                  TNZ     s:6807

      638     6800                      %POINTERIZE (PTR="LOCATION.KEY.V$ (LVL)");

   6801  4 002005   000001 235105                    LDA     1,AL,PR0
         4 002006   002014 601000 4                  TNZ     s:6804

   6802  4 002007   200024 235100                    LDA     LVL,,AUTO
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:84   
         4 002010   000001 735000                    ALS     1
         4 002011   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 002012   000001 756105                    STQ     1,AL,PR0
         4 002013   002022 710000 4                  TRA     s:6807

   6804  4 002014   200024 235100                    LDA     LVL,,AUTO
         4 002015   000001 735000                    ALS     1
         4 002016   000001 236105                    LDQ     1,AL,PR0
         4 002017   000022 736000                    QLS     18
         4 002020   200006 036100                    ADLQ    ENCODED_NODE$,,AUTO
         4 002021   000001 756105                    STQ     1,AL,PR0

      639     6806    5                 END;

      640     6807    4              END;

   6807  4 002022   200024 054100                    AOS     LVL,,AUTO
         4 002023   200024 235100                    LDA     LVL,,AUTO
         4 002024   000003 115007                    CMPA    3,DL
         4 002025   001777 604400 4                  TMOZ    s:6799

      641     6808    3           RETURN;

   6808  4 002026   200022 221300                    LDX1  ! I+1,,AUTO
         4 002027   000001 702211                    TSX2  ! 1,X1

      642     6809
      643     6810    3   END POINTERIZE_LOCATION;
      644     6811
      645     6812    2   END POINTERIZE_RECORD;
      646     6813
      647     6814        %BOX (TITLE=HEADER_RECORD, PAGE=YES);
              6822    2
              6826    2   /***************************************************************************
              6828    2    *                                                                         *
              6832    2            *                               HEADER_RECORD                            *
              6834    2            *                                                                        *
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:85   
              6836    2          ***************************************************************************/

      648     6840
      649     6841        /*I* NAME:  HEADER_RECORD
      650     6842            PARAMETERS:
      651     6843                DESC - VD$ENCODED_DESC for the header record of a workspace file.
      652     6844                    It's .SPEC.TYPE# must be %SPT_ENCODED_FILE_SPEC.
      653     6845                                    !! CAUTION !!
      654     6846                        DESC is assumed to be unPOINTERIZEd:  its
      655     6847                        .SPEC.V$ isn't a pointer, but a word-offset
      656     6848                        from ENCODED_NODE$.
      657     6849            INPUT:
      658     6850                LOAD_FLAGS - An array of bits specifying which predefined files we're
      659     6851                    allowed to load from the workspace file.
      660     6852                ENCODED_NODE$ - Pointer to the VD$ENCODED_NODE read from the
      661     6853                    workspace file.
      662     6854            OUTPUT:
      663     6855                VD_LAST_LOADED_FILE_SPEC will contain DESC's VD$ENCODED_FILE_SPEC.
      664     6856                The entire contents of the Windows file may have been deleted.
      665     6857            DESCRIPTION:
      666     6858                Save DESC's Spec component in the global VD_LAST_LOADED_FILE_SPEC.
      667     6859                Check the bits in the ENCODED_FILE_SPEC indicating what types of
      668     6860                info is in the workspace file:
      669     6861                    If the workspace file contains Windows-file nodes, and LOAD_FLAGS
      670     6862                        says we're allowed to load Windows-file nodes, then delete the
      671     6863                        entire contents of the Windows file now, before we load the
      672     6864                        workspace file.
      673     6865                    If the workspace file contains Keyins, and LOAD_FLAGS says we're
      674     6866                        allowed to load Keyins, but the user's current terminal profile
      675     6867                        isn't the same as the terminal profile at the time the
      676     6868                        workspace file was last modified, then warn the user.
      677     6869        */
      678     6870
      679     6871    1   HEADER_RECORD: PROC (DESC) ALTRET;

   6871  4 002030   200016 741300       HEADER_RECO* STX1  ! WINDOW_SPEC$+2,,AUTO

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:86   
      680     6872
      681     6873        %VD$ENCODED_DESC (NAME=DESC, STCLASS=PARAM);
      682     6957
      683     6958
      684     6959        %FPT_GLINEATTR (STCLASS=STATIC, DCB=M$UC);
      685     6984
      686     6985
      687     6986
      688     6987        %VD$RANGE (NAME=DEL_FILE_RANGE, STCLASS=AUTO);
      689     7056        %VLP_LINEATTR (STCLASS=AUTO);
      690     7078        %VD$ENCODED_FILE_SPEC;
      691     7107
      692     7108
      693     7109
      694     7110    2           VD_LAST_LOADED_FILE_SPEC =

   7110  4 002031   200017 470500                    LDP0    @DESC,,AUTO
         4 002032   000015 236100                    LDQ     13,,PR0
         4 002033   000002 736000                    QLS     2
         4 002034   200006 471500                    LDP1    ENCODED_NODE$,,AUTO
         4 002035   000000 100506                    MLR     fill='000'O
         4 002036   100000 000040                    ADSC9   0,Q,PR1                  cn=0,n=32
         4 002037   000000 000040 xsym               ADSC9   VD_LAST_LOADED_FILE_SPEC cn=0,n=32

      695     7111    2             PINCRW(ENCODED_NODE$, ADDR(DESC.SPEC.V$)->BASED$SBIN) ->
      696     7112    2             VD$ENCODED_FILE_SPEC;
      697     7113
      698     7114    2           IF VD_LAST_LOADED_FILE_SPEC.CONTENTS (%PDFF_WINDOWS)

   7114  4 002040   000000 236000 xsym               LDQ     VD_LAST_LOADED_FILE_SPEC
         4 002041   004000 316003                    CANQ    2048,DU
         4 002042   002067 600000 4                  TZE     s:7124
         4 002043   200003 473500                    LDP3    @LOAD_FLAGS,,AUTO
         4 002044   300000 236100                    LDQ     0,,PR3
         4 002045   004000 316003                    CANQ    2048,DU
         4 002046   002067 600000 4                  TZE     s:7124

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:87   
      699     7115    3             AND LOAD_FLAGS.F (%PDFF_WINDOWS) THEN DO;

      700     7116    3              DEL_FILE_RANGE = %CLEAR;

   7116  4 002047   000100 100400                    MLR     fill='000'O
         4 002050   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 002051   200020 000110                    ADSC9   DEL_FILE_RANGE,,AUTO     cn=0,n=72

      701     7117    3              DEL_FILE_RANGE.START.KEY (%LVL_LOWER-1) =

   7117  4 002052   000100 100400                    MLR     fill='000'O
         4 002053   000000 000010 xsym               ADSC9   VD_KEY_NUMERIC_BOF       cn=0,n=8
         4 002054   200020 000010                    ADSC9   DEL_FILE_RANGE,,AUTO     cn=0,n=8

      702     7118    3                VD_KEY_NUMERIC_BOF;   /* Windows-file keys are numeric */
      703     7119    3              DEL_FILE_RANGE.ENDD.EOF = %TRUE;

   7119  4 002055   400000 236007                    LDQ     -131072,DL
         4 002056   200041 256100                    ORSQ    LVL+13,,AUTO

      704     7120    3              CALL VDA$LDELETE (WINDOWS$STREAM, DEL_FILE_RANGE)

   7120  4 002057   200020 634500                    EPPR4   DEL_FILE_RANGE,,AUTO
         4 002060   200063 454500                    STP4    VLP_LINEATTR+17,,AUTO
         4 002061   000006 236000 xsym               LDQ     VD_6E+6
         4 002062   200062 756100                    STQ     VLP_LINEATTR+16,,AUTO
         4 002063   200062 630500                    EPPR0   VLP_LINEATTR+16,,AUTO
         4 002064   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002065   000000 701000 xent               TSX1    VDA$LDELETE
         4 002066   002150 702000 4                  TSX2    LDELETE_FAILED

      705     7121    3                ALTRET (LDELETE_FAILED);
      706     7122    3              END;

      707     7123
      708     7124    2           IF VD_LAST_LOADED_FILE_SPEC.CONTENTS (%PDFF_KEYINS)

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:88   
   7124  4 002067   000000 236000 xsym               LDQ     VD_LAST_LOADED_FILE_SPEC
         4 002070   100000 316003                    CANQ    32768,DU
         4 002071   002141 600000 4                  TZE     s:7141
         4 002072   200003 470500                    LDP0    @LOAD_FLAGS,,AUTO
         4 002073   000000 236100                    LDQ     0,,PR0
         4 002074   100000 316003                    CANQ    32768,DU
         4 002075   002141 600000 4                  TZE     s:7141
         4 002076   000000 471400 xsym               LDP1    B$JIT$
         4 002077   100000 236100                    LDQ     0,,PR1
         4 002100   740000 376003                    ANQ     -16384,DU
         4 002101   140000 116003                    CMPQ    49152,DU
         4 002102   002141 601000 4                  TNZ     s:7141

      709     7125    2             AND LOAD_FLAGS.F (%PDFF_KEYINS)
      710     7126    3             AND B$JIT.MODE = %M_INT# THEN DO;

      711     7127    3              FPT_GLINEATTR.LINEATTR_ = VECTOR(VLP_LINEATTR);

   7127  4 002103   000007 235000 5                  LDA     7
         4 002104   200062 452500                    STP2    VLP_LINEATTR+16,,AUTO
         4 002105   200062 236100                    LDQ     VLP_LINEATTR+16,,AUTO
         4 002106   000042 036003                    ADLQ    34,DU
         4 002107   000004 757000 2                  STAQ    FPT_GLINEATTR+4

      712     7128    3              CALL M$GLINEATTR (FPT_GLINEATTR)

   7128  4 002110   000000 630400 2                  EPPR0   FPT_GLINEATTR
         4 002111   560005 713400                    CLIMB   alt,+57349
         4 002112   401000 401760                    pmme    nvectors=3
         4 002113   002143 702000 4                  TSX2    GLINEATTR_FAILED

      713     7129    3                ALTRET (GLINEATTR_FAILED);
      714     7130    3              IF SUBSTR(VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE.BYTES, 0,

   7130  4 002114   000005 236000 xsym               LDQ     VD_LAST_LOADED_FILE_SPEC+5
         4 002115   000033 772000                    QRL     27
         4 002116   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:89   
         4 002117   200044 236100                    LDQ     VLP_LINEATTR+2,,AUTO
         4 002120   000033 772000                    QRL     27
         4 002121   000000 621006                    EAX1    0,QL
         4 002122   040140 106440                    CMPC    fill='040'O
         4 002123   000005 200010 xsym               ADSC9   VD_LAST_LOADED_FILE_SPEC+5 cn=1,n=*X0
         4 002124   200044 200011                    ADSC9   VLP_LINEATTR+2,,AUTO     cn=1,n=*X1
         4 002125   002141 600000 4                  TZE     s:7141

      715     7131    3                VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE.LENGTH#) ~=
      716     7132    3                SUBSTR(VLP_LINEATTR.PROTXTC.TXT, 0,
      717     7133    4                VLP_LINEATTR.PROTXTC.CNT) THEN DO;

      718     7134    4                 CALL VDG$WARNMSG (%E$WARN_SAVED_W_DIFF_PROFILE,

   7134  4 002126   200044 630500                    EPPR0   VLP_LINEATTR+2,,AUTO
         4 002127   200064 450500                    STP0    VLP_LINEATTR+18,,AUTO
         4 002130   000014 237000 5                  LDAQ    12
         4 002131   200062 757100                    STAQ    VLP_LINEATTR+16,,AUTO
         4 002132   200062 630500                    EPPR0   VLP_LINEATTR+16,,AUTO
         4 002133   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002134   000000 701000 xent               TSX1    VDG$WARNMSG
         4 002135   000000 011000                    NOP     0

      719     7135    4                   VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE,
      720     7136    4                   VLP_LINEATTR.PROTXTC);
      721     7137    4                 CALL VDG$EREPORT_ERROR;

   7137  4 002136   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002137   000000 701000 xent               TSX1    VDG$EREPORT_ERROR
         4 002140   000000 011000                    NOP     0

      722     7138    4                 END;

      723     7139    3              END;

      724     7140
      725     7141    2           RETURN;
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:90   

   7141  4 002141   200016 221300                    LDX1  ! WINDOW_SPEC$+2,,AUTO
         4 002142   000001 702211                    TSX2  ! 1,X1

      726     7142
      727     7143
      728     7144    2   GLINEATTR_FAILED:
      729     7145    2           CALL VDG$MONERR;

   7145  4 002143   000002 631400 xsym  GLINEATTR_F* EPPR1   B_VECTNIL+2
         4 002144   000000 701000 xent               TSX1    VDG$MONERR
         4 002145   000000 011000                    NOP     0

      730     7146    2           ALTRETURN;

   7146  4 002146   200016 221300                    LDX1  ! WINDOW_SPEC$+2,,AUTO
         4 002147   000000 702211                    TSX2  ! 0,X1

   7138  4 002150                       LDELETE_FAI* null
   7138  4 002150                       OALLOC_FAIL* null
      731     7147
      732     7148
      733     7149    2   LDELETE_FAILED: ;
      734     7150    2   OALLOC_FAILED: ;
      735     7151    2           ALTRETURN;

   7151  4 002150   200016 221300                    LDX1  ! WINDOW_SPEC$+2,,AUTO
         4 002151   000000 702211                    TSX2  ! 0,X1
      736     7152
      737     7153    2   END HEADER_RECORD;
      738     7154
      739     7155
      740     7156    1   END VDW$LOAD;
      741     7157        %EOD;

PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:91   
--  Include file information  --

   B$JIT.:LIBRARY  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDW$LOAD.
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:92   

 **** Variables and constants ****

  ****  Section 002  Data  VDW$LOAD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 FPT_GLINEATTR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    17-0-0/w PTR         r     1 @DESC                      3-0-0/w PTR         r     1 @LOAD_FLAGS
    23-0-0/w PTR         r     1 @LOCATION                 23-0-0/w PTR         r     1 @STRUCTURE
    10-0-0/w PTR         r     1 BASED_ARRAY$              20-0-0/w STRC(648)   r     1 DEL_FILE_RANGE
    *0-0-0/w STRC(540)   r     1 DESC                       6-0-0/w PTR         r     1 ENCODED_NODE$
     5-0-0/w BIT         r     1 EOF                       11-0-0/w SBIN        r     1 I
    21-0-0/w SBIN        r     1 I                         *0-0-0/w STRC(9)     r     1 LOAD_FLAGS
    *0-0-0/w STRC(324)   r     1 LOCATION                  24-0-0/w SBIN        r     1 LVL
    17-0-0/w PTR         r     1 OBJECT_HEADER$            20-0-0/w PTR         r     1 OBJECT_LIMIT$
    12-0-0/w SBIN        r     1 PREV_WINDOW_INTENDED_HEIGHT
     4-0-0/w PTR         r     1 STREAM$                   *0-0-0/w PTR         r     1 STRUCTURE
     7-0-0/w SBIN        r     1 SUM
    13-0-0/w SBIN        r     1 THIS_WINDOW_INTENDED_HEIGHT
    42-0-0/d STRC(576)   r     1 VLP_LINEATTR              14-0-0/w PTR         r     1 WINDOW_SPEC$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w STRC(144)   r     1 VD_$SCREEN
     0-0-0/w STRC(22644) r     1 VD_6E                      0-0-0/w STRC(72)    r     1 VD_KEY_NUMERIC_BOF
     0-0-0/w STRC(288)   r     1 VD_LAST_LOADED_FILE_SPEC
     0-0-0/w STRC(72)    r     1 VD_OBJECTS(0:98)
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:93   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w SBIN        r     1 BASED$ARRAY(0:0)
     0-0-0/w SBIN        r     1 BASED$SBIN                 0-0-0/w STRC(900)   r     1 CMD$STREAM
     0-0-0/w STRC(900)   r     1 ENCODED$NODE               0-0-0N  NULL        r     1 M$EI
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(864)   r     1 STREAM
     0-0-0/w STRC(936)   r     1 VD$BLOCK_DESC              0-0-0/w STRC(936)   r     1 VD$BLOCK_DESC
     0-0-0/w ASTR(90)    r     1 VD$BUFFER                  0-0-0/w ASTR(90)    r     1 VD$BUFFER
     0-0-0/w ASTR(90)    r     1 VD$BUFFER                  0-0-0/w STRC(90)    r     1 VD$BUFFER_HEADER
     0-0-0/w STRC(288)   r     1 VD$ENCODED_FILE_SPEC       0-0-0/w STRC(180)   r     1 VD$ERR
     0-0-0/w STRC(2124)  r     1 VD$EVAL                    0-0-0/w STRC(36972) r     1 VD$FIT
     0-0-0/w STRC(216)   r     1 VD$IT_ADJUST               0-0-0/w STRC(1116)  r     1 VD$IT_BLOCK_EXPR
     0-0-0/w STRC(540)   r     1 VD$IT_COMMAND              0-0-0/w STRC(324)   r     1 VD$IT_OPERAND
     0-0-0/w STRC(216)   r     1 VD$IT_OPERATOR             0-0-0/w STRC(216)   r     1 VD$IT_SELECT
     0-0-0/w STRC        r     1 VD$OBJECT_HEADER           0-0-0/w STRC(252)   r     1 VD$PATTERN
     0-0-0/w STRC(144)   r     1 VD$POINTER                 0-0-0/w STRC(1944)  r     1 VD$PORT
     0-0-0/w STRC(1944)  r     1 VD$PORT                    0-0-0/w STRC(324)   r     1 VD$RECORD_SET
     0-0-0/w STRC(864)   r     1 VD$STREAM                  0-0-0/w STRC(81)    r     1 VD$STRING_HEADER
     0-0-0/w STRC(180)   r     1 VD$STRUCTURE_SPEC          0-0-0/w STRC(180)   r     1 VD$WINDOW_BLOCK
     0-0-0/w STRC(900)   r     1 VD$WINDOW_SPEC             0-0-0/w STRC(900)   r     1 VD$WINDOW_SPEC
     0-0-0/w STRC(900)   r     1 WINDOW$SPEC                0-0-0/w STRC(864)   r     1 WINDOWS$STREAM


   Procedure VDW$LOAD requires 1130 words for executable code.
   Procedure VDW$LOAD requires 56 words of local(AUTO) storage.
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:94   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:95   
          MINI XREF LISTING

B$JIT.CPFLAGS1.SLEAZE
      3219**DCL      3219--REDEF
B$JIT.ERR.MID
      3126**DCL      3126--REDEF
B$JIT.JRESPEAK
      3287**DCL      3288--REDEF
B$JIT.MODE
      3120**DCL      7124>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      3396**DCL      3396--REDEF    3397--REDEF
B$JIT.PNR
      3300**DCL      3300--REDEF
B$JIT.TSLINE
      3394**DCL      3395--REDEF
B$JIT$
      3616**DCL      3120--IMP-PTR  7124>>IF
BASED$ARRAY
      3897**DCL      4380>>ASSIGN
BASED$SBIN
      3898**DCL      4387>>IF       5781>>IF       5784>>ASSIGN   5790>>IF       5793>>ASSIGN   5797>>IF
      5800>>ASSIGN   5817>>IF       5820>>ASSIGN   5827>>IF       5830>>ASSIGN   5835>>IF       5838>>ASSIGN
      5842>>IF       5845>>ASSIGN   5848>>IF       5851>>ASSIGN   5854>>IF       5857>>ASSIGN   5860>>IF
      5863>>ASSIGN   5866>>IF       5869>>ASSIGN   5872>>IF       5875>>ASSIGN   5879>>IF       5882>>ASSIGN
      5888>>IF       5891>>ASSIGN   5894>>IF       5897>>ASSIGN   5900>>IF       5903>>ASSIGN   5910>>IF
      5913>>ASSIGN   5920>>IF       5923>>ASSIGN   5926>>IF       5929>>ASSIGN   5932>>IF       5935>>ASSIGN
      5940>>IF       5943>>ASSIGN   5946>>IF       5949>>ASSIGN   5952>>IF       5955>>ASSIGN   5958>>IF
      5961>>ASSIGN   5966>>IF       5969>>ASSIGN   5973>>IF       5976>>ASSIGN   5984>>IF       5987>>ASSIGN
      5991>>IF       5994>>ASSIGN   5997>>IF       6000>>ASSIGN   6005>>IF       6008>>ASSIGN   6011>>IF
      6014>>ASSIGN   6018>>IF       6021>>ASSIGN   6027>>IF       6030>>ASSIGN   6033>>IF       6036>>ASSIGN
      6040>>IF       6043>>ASSIGN   6047>>IF       6050>>ASSIGN   6055>>IF       6058>>ASSIGN   6061>>IF
      6064>>ASSIGN   6067>>IF       6070>>ASSIGN   6073>>IF       6076>>ASSIGN   6081>>IF       6084>>ASSIGN
      6087>>IF       6090>>ASSIGN   6093>>IF       6096>>ASSIGN   6099>>IF       6102>>ASSIGN   6108>>IF
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:96   
      6111>>ASSIGN   6117>>IF       6120>>ASSIGN   6126>>IF       6129>>ASSIGN   6133>>IF       6136>>ASSIGN
      6143>>IF       6146>>ASSIGN   6152>>IF       6155>>ASSIGN   6168>>IF       6171>>ASSIGN   6174>>IF
      6177>>ASSIGN   6183>>IF       6186>>ASSIGN   6189>>IF       6192>>ASSIGN   6801>>IF       6804>>ASSIGN
      7110>>ASSIGN
BASED_ARRAY$
      3624**DCL      3897--IMP-PTR  4376<<ASSIGN   4379>>DOINDEX  4380>>ASSIGN
CLEAN_UP
      4448**LABEL    4435--CALLALT  4438--GOTO
CMD$STREAM.RECORD$
      3666**DCL      4370>>ASSIGN
CMD$STREAM.REC_NUM#
      3668**DCL      4363<<ASSIGN   4371>>IF       4420<<ASSIGN   4420>>ASSIGN   4435>>CALL     6244>>CALL
DEL_FILE_RANGE IN PROCEDURE HEADER_RECORD
      6995**DCL      7116<<ASSIGN   7120<>CALL
DEL_FILE_RANGE.ENDD.EOF IN PROCEDURE HEADER_RECORD
      7053**DCL      7119<<ASSIGN
DEL_FILE_RANGE.START.KEY IN PROCEDURE HEADER_RECORD
      7021**DCL      7117<<ASSIGN
DESC IN PROCEDURE HEADER_RECORD
      6881**DCL      6871--PROC
DESC.SPEC.V$ IN PROCEDURE HEADER_RECORD
      6953**DCL      7110--ASSIGN
EACH_WORKSPACE_RECORD
      4365**LABEL    4369--EXIT
ENCODED$NODE
      3784**DCL      5804--ASSIGN   6210--ASSIGN
ENCODED$NODE.CHECKSUM#
      3811**DCL      4376--ASSIGN   4382>>IF
ENCODED$NODE.DESC
      3822**DCL      4392<>CALL     4416<>CALL
ENCODED$NODE.DESC.DATA$
      3894**DCL      4387--IF       5797--IF       5798<<ASSIGN   5800<<ASSIGN   5800--ASSIGN
ENCODED$NODE.DESC.FILE_KEY
      3834**DCL      4387>>IF
ENCODED$NODE.DESC.FILE_KEY.REP#
      3836**DCL      5779>>IF
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:97   
ENCODED$NODE.DESC.FILE_KEY.V$
      3836**DCL      5781--IF       5782<<ASSIGN   5784<<ASSIGN   5784--ASSIGN
ENCODED$NODE.DESC.LOCATION
      3848**DCL      4387>>IF       5787<>CALL
ENCODED$NODE.DESC.SPEC.REP#
      3892**DCL      5788>>IF
ENCODED$NODE.DESC.SPEC.TYPE#
      3892**DCL      4385>>IF       4400>>IF
ENCODED$NODE.DESC.SPEC.V$
      3892**DCL      4403>>ASSIGN   5790--IF       5791<<ASSIGN   5793<<ASSIGN   5793--ASSIGN
ENCODED$NODE.LENGTH#
      3810**DCL      4379>>DOINDEX  5805>>ASSIGN
ENCODED$NODE.RECORD_ID
      3810**DCL      4371>>IF
ENCODED$NODE.RECORD_NUM#
      3811**DCL      4371>>IF       4387>>IF
ENCODED_NODE$
      3622**DCL      3784--IMP-PTR  4370<<ASSIGN   4371>>IF       4371>>IF       4376>>ASSIGN   4379>>DOINDEX
      4379>>DOINDEX  4382>>IF       4385>>IF       4387>>IF       4387>>IF       4387>>IF       4387>>IF
      4392>>CALL     4400>>IF       4403>>ASSIGN   4416>>CALL     5779>>IF       5781>>IF       5782>>ASSIGN
      5784>>ASSIGN   5784>>ASSIGN   5784>>ASSIGN   5787>>CALL     5788>>IF       5790>>IF       5791>>ASSIGN
      5793>>ASSIGN   5793>>ASSIGN   5793>>ASSIGN   5797>>IF       5798>>ASSIGN   5800>>ASSIGN   5800>>ASSIGN
      5800>>ASSIGN   5804>>ASSIGN   5805>>ASSIGN   5805>>ASSIGN   5820>>ASSIGN   5830>>ASSIGN   5838>>ASSIGN
      5845>>ASSIGN   5851>>ASSIGN   5857>>ASSIGN   5863>>ASSIGN   5869>>ASSIGN   5875>>ASSIGN   5882>>ASSIGN
      5891>>ASSIGN   5897>>ASSIGN   5903>>ASSIGN   5913>>ASSIGN   5923>>ASSIGN   5929>>ASSIGN   5935>>ASSIGN
      5943>>ASSIGN   5949>>ASSIGN   5955>>ASSIGN   5961>>ASSIGN   5969>>ASSIGN   5976>>ASSIGN   5987>>ASSIGN
      5994>>ASSIGN   6000>>ASSIGN   6008>>ASSIGN   6014>>ASSIGN   6021>>ASSIGN   6030>>ASSIGN   6036>>ASSIGN
      6043>>ASSIGN   6050>>ASSIGN   6058>>ASSIGN   6064>>ASSIGN   6070>>ASSIGN   6076>>ASSIGN   6084>>ASSIGN
      6090>>ASSIGN   6096>>ASSIGN   6102>>ASSIGN   6111>>ASSIGN   6120>>ASSIGN   6129>>ASSIGN   6136>>ASSIGN
      6146>>ASSIGN   6155>>ASSIGN   6171>>ASSIGN   6177>>ASSIGN   6186>>ASSIGN   6192>>ASSIGN   6210>>ASSIGN
      6804>>ASSIGN   7110>>ASSIGN
EOF
      3621**DCL      4365>>DOUNTIL  4366<>CALL     4368>>IF
FCLOSE_FAILED
      4448**LABEL    4424--CALLALT  4449--CALLALT
FPT_GLINEATTR IN PROCEDURE HEADER_RECORD
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:98   
      6974**DCL      7128<>CALL
FPT_GLINEATTR.LINEATTR_ IN PROCEDURE HEADER_RECORD
      6980**DCL      7127<<ASSIGN
FPT_GLINEATTR.V IN PROCEDURE HEADER_RECORD
      6982**DCL      6976--DCLINIT
GLINEATTR_FAILED IN PROCEDURE HEADER_RECORD
      7145**LABEL    7128--CALLALT
HEADER_RECORD
      6871**PROC     4392--CALL
HEADER_RECORD_FAILED
      4437**LABEL    4392--CALLALT
I
      3625**DCL      4379<<DOINDEX  4380>>ASSIGN
I IN PROCEDURE POINTERIZE_RECORD
      4514**DCL      5907<<DOINDEX  5908>>IF       5910>>IF       5911>>ASSIGN   5913>>ASSIGN   5913>>ASSIGN
      6016<<DOINDEX  6018>>IF       6019>>ASSIGN   6021>>ASSIGN   6021>>ASSIGN   6141<<DOINDEX  6143>>IF
      6144>>ASSIGN   6146>>ASSIGN   6146>>ASSIGN
LDELETE_FAILED IN PROCEDURE HEADER_RECORD
      7138**LABEL    7120--CALLALT
LOAD_FLAGS
      3403**DCL       125--PROC     4416<>CALL
LOAD_FLAGS.F
      3415**DCL      4400>>IF       7114>>IF       7124>>IF
LOCATION IN PROCEDURE POINTERIZE_LOCATION
      6772**DCL      6762--PROC
LOCATION.KEY.REP# IN PROCEDURE POINTERIZE_LOCATION
      6788**DCL      6799>>IF
LOCATION.KEY.V$ IN PROCEDURE POINTERIZE_LOCATION
      6788**DCL      6801--IF       6802<<ASSIGN   6804<<ASSIGN   6804--ASSIGN
LVL IN PROCEDURE POINTERIZE_LOCATION
      6794**DCL      6798<<DOINDEX  6799>>IF       6801>>IF       6802>>ASSIGN   6804>>ASSIGN   6804>>ASSIGN
M$EI
      3617**DCL      4437>>ASSIGN   6246>>ASSIGN
M$GLINEATTR
      2524**DCL-ENT  7128--CALL
OALLOC_FAILED
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:99   
      4448**LABEL    4356--CALLALT
OBJECT_HEADER$ IN PROCEDURE POINTERIZE_RECORD
      4512**DCL      4533--IMP-PTR  4547--IMP-PTR  4613--IMP-PTR  4650--IMP-PTR  4728--IMP-PTR  4765--IMP-PTR
      4802--IMP-PTR  4952--IMP-PTR  4990--IMP-PTR  5056--IMP-PTR  5093--IMP-PTR  5130--IMP-PTR  5294--IMP-PTR
      5335--IMP-PTR  5371--IMP-PTR  5407--IMP-PTR  5458--IMP-PTR  5703--IMP-PTR  5747--IMP-PTR  5804<<ASSIGN
      5809>>DOWHILE  5812>>DOCASE   5817>>IF       5818>>ASSIGN   5820>>ASSIGN   5820>>ASSIGN   5827>>IF
      5828>>ASSIGN   5830>>ASSIGN   5830>>ASSIGN   5835>>IF       5836>>ASSIGN   5838>>ASSIGN   5838>>ASSIGN
      5840>>ASSIGN   5842>>IF       5843>>ASSIGN   5845>>ASSIGN   5845>>ASSIGN   5848>>IF       5849>>ASSIGN
      5851>>ASSIGN   5851>>ASSIGN   5854>>IF       5855>>ASSIGN   5857>>ASSIGN   5857>>ASSIGN   5860>>IF
      5861>>ASSIGN   5863>>ASSIGN   5863>>ASSIGN   5866>>IF       5867>>ASSIGN   5869>>ASSIGN   5869>>ASSIGN
      5872>>IF       5873>>ASSIGN   5875>>ASSIGN   5875>>ASSIGN   5877>>IF       5879>>IF       5880>>ASSIGN
      5882>>ASSIGN   5882>>ASSIGN   5888>>IF       5889>>ASSIGN   5891>>ASSIGN   5891>>ASSIGN   5894>>IF
      5895>>ASSIGN   5897>>ASSIGN   5897>>ASSIGN   5900>>IF       5901>>ASSIGN   5903>>ASSIGN   5903>>ASSIGN
      5907>>DOINDEX  5908>>IF       5910>>IF       5911>>ASSIGN   5913>>ASSIGN   5913>>ASSIGN   5920>>IF
      5921>>ASSIGN   5923>>ASSIGN   5923>>ASSIGN   5926>>IF       5927>>ASSIGN   5929>>ASSIGN   5929>>ASSIGN
      5932>>IF       5933>>ASSIGN   5935>>ASSIGN   5935>>ASSIGN   5940>>IF       5941>>ASSIGN   5943>>ASSIGN
      5943>>ASSIGN   5946>>IF       5947>>ASSIGN   5949>>ASSIGN   5949>>ASSIGN   5952>>IF       5953>>ASSIGN
      5955>>ASSIGN   5955>>ASSIGN   5958>>IF       5959>>ASSIGN   5961>>ASSIGN   5961>>ASSIGN   5966>>IF
      5967>>ASSIGN   5969>>ASSIGN   5969>>ASSIGN   5971>>IF       5973>>IF       5974>>ASSIGN   5976>>ASSIGN
      5976>>ASSIGN   5979>>CALL     5980>>CALL     5981>>ASSIGN   5982>>IF       5984>>IF       5985>>ASSIGN
      5987>>ASSIGN   5987>>ASSIGN   5991>>IF       5992>>ASSIGN   5994>>ASSIGN   5994>>ASSIGN   5997>>IF
      5998>>ASSIGN   6000>>ASSIGN   6000>>ASSIGN   6005>>IF       6006>>ASSIGN   6008>>ASSIGN   6008>>ASSIGN
      6011>>IF       6012>>ASSIGN   6014>>ASSIGN   6014>>ASSIGN   6018>>IF       6019>>ASSIGN   6021>>ASSIGN
      6021>>ASSIGN   6027>>IF       6028>>ASSIGN   6030>>ASSIGN   6030>>ASSIGN   6033>>IF       6034>>ASSIGN
      6036>>ASSIGN   6036>>ASSIGN   6038>>IF       6040>>IF       6041>>ASSIGN   6043>>ASSIGN   6043>>ASSIGN
      6047>>IF       6048>>ASSIGN   6050>>ASSIGN   6050>>ASSIGN   6055>>IF       6056>>ASSIGN   6058>>ASSIGN
      6058>>ASSIGN   6061>>IF       6062>>ASSIGN   6064>>ASSIGN   6064>>ASSIGN   6067>>IF       6068>>ASSIGN
      6070>>ASSIGN   6070>>ASSIGN   6073>>IF       6074>>ASSIGN   6076>>ASSIGN   6076>>ASSIGN   6081>>IF
      6082>>ASSIGN   6084>>ASSIGN   6084>>ASSIGN   6087>>IF       6088>>ASSIGN   6090>>ASSIGN   6090>>ASSIGN
      6093>>IF       6094>>ASSIGN   6096>>ASSIGN   6096>>ASSIGN   6099>>IF       6100>>ASSIGN   6102>>ASSIGN
      6102>>ASSIGN   6106>>IF       6108>>IF       6109>>ASSIGN   6111>>ASSIGN   6111>>ASSIGN   6113<<ASSIGN
      6113>>ASSIGN   6115>>IF       6117>>IF       6118>>ASSIGN   6120>>ASSIGN   6120>>ASSIGN   6123>>CALL
      6124>>CALL     6126>>IF       6127>>ASSIGN   6129>>ASSIGN   6129>>ASSIGN   6131>>IF       6133>>IF
      6134>>ASSIGN   6136>>ASSIGN   6136>>ASSIGN   6141>>DOINDEX  6143>>IF       6144>>ASSIGN   6146>>ASSIGN
      6146>>ASSIGN   6152>>IF       6153>>ASSIGN   6155>>ASSIGN   6155>>ASSIGN   6157>>CALL     6158>>CALL
      6159>>CALL     6160>>CALL     6168>>IF       6169>>ASSIGN   6171>>ASSIGN   6171>>ASSIGN   6174>>IF
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:100  
      6175>>ASSIGN   6177>>ASSIGN   6177>>ASSIGN   6183>>IF       6184>>ASSIGN   6186>>ASSIGN   6186>>ASSIGN
      6189>>IF       6190>>ASSIGN   6192>>ASSIGN   6192>>ASSIGN   6202>>IF       6203<<ASSIGN   6203>>ASSIGN
      6203>>ASSIGN   6206<<ASSIGN   6206>>ASSIGN   6206>>ASSIGN   6210<<ASSIGN   6213>>DOWHILE  6216>>DOCASE
      6219>>IF       6220<<ASSIGN   6220>>ASSIGN   6221>>CALL     6224>>CALL     6230>>IF       6231<<ASSIGN
      6231>>ASSIGN   6231>>ASSIGN   6234<<ASSIGN   6234>>ASSIGN   6234>>ASSIGN   6244>>CALL
OBJECT_LIMIT$ IN PROCEDURE POINTERIZE_RECORD
      4513**DCL      5805<<ASSIGN   5809>>DOWHILE  6213>>DOWHILE
OFREE_FAILED
      4448**LABEL    4426--CALLALT  4451--CALLALT
POINTERIZE_LOCATION IN PROCEDURE POINTERIZE_RECORD
      6762**PROC     5787--CALL     5979--CALL     5980--CALL     6123--CALL     6124--CALL     6157--CALL
      6158--CALL     6159--CALL     6160--CALL
POINTERIZE_RECORD
      4509**PROC     4397--CALL
POINTERIZE_RECORD_FAILED
      4437**LABEL    4397--CALLALT
POINTERIZE_STRUCTURE IN PROCEDURE POINTERIZE_RECORD
      6290**PROC     6221--CALL     6224--CALL
PREAD_FILE_READ_FAILED
      4437**LABEL    4366--CALLALT
PREV_WINDOW_INTENDED_HEIGHT
      3626**DCL      4350<<ASSIGN   4406>>ASSIGN   4413<<ASSIGN
STREAM
      3678**DCL      4416<>CALL     4424<>CALL     4426<>CALL     4449<>CALL     4451<>CALL
STREAM$
      3620**DCL      3678--IMP-PTR  4349<<ASSIGN   4356<>CALL     4416>>CALL     4423>>IF       4424>>CALL
      4426>>CALL     4448>>IF       4449>>CALL     4451>>CALL
STRUCTURE IN PROCEDURE POINTERIZE_STRUCTURE
      6292**DCL      6290--PROC     6708>>IF       6711>>CALL     6716<<ASSIGN
SUM
      3623**DCL      4375<<ASSIGN   4380<<ASSIGN   4380>>ASSIGN   4382>>IF
THIS_WINDOW_INTENDED_HEIGHT
      3627**DCL      4404<<ASSIGN   4413>>ASSIGN
VD$BLOCK_DESC.FILE_KEY.REP# IN PROCEDURE POINTERIZE_RECORD
      5168**DCL      6115>>IF
VD$BLOCK_DESC.FILE_KEY.V$ IN PROCEDURE POINTERIZE_RECORD
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:101  
      5168**DCL      6117--IF       6118<<ASSIGN   6120<<ASSIGN   6120--ASSIGN
VD$BLOCK_DESC.OPTIONS.KEY_INCR.REP# IN PROCEDURE POINTERIZE_RECORD
      5265**DCL      6131>>IF
VD$BLOCK_DESC.OPTIONS.KEY_INCR.V$ IN PROCEDURE POINTERIZE_RECORD
      5265**DCL      6133--IF       6134<<ASSIGN   6136<<ASSIGN   6136--ASSIGN
VD$BLOCK_DESC.OPTIONS.STRUCTURE$ IN PROCEDURE POINTERIZE_RECORD
      5251**DCL      6126--IF       6127<<ASSIGN   6129<<ASSIGN   6129--ASSIGN   6221<>CALL
VD$BLOCK_DESC.RANGE.ENDD IN PROCEDURE POINTERIZE_RECORD
      5220**DCL      6124<>CALL
VD$BLOCK_DESC.RANGE.START IN PROCEDURE POINTERIZE_RECORD
      5192**DCL      6123<>CALL
VD$BLOCK_DESC.RANGE.START IN PROCEDURE POINTERIZE_STRUCTURE
      6366**DCL      6711<>CALL
VD$BUFFER.LENGTH#
      4286**DCL      4288--IMP-SIZ
VD$BUFFER.BYTES IN PROCEDURE POINTERIZE_RECORD
      5322**DCL      5805--ASSIGN   6113--ASSIGN   6220--ASSIGN
VD$BUFFER.LENGTH# IN PROCEDURE POINTERIZE_RECORD
      5320**DCL      5322--IMP-SIZ
VD$BUFFER.LENGTH# IN PROCEDURE POINTERIZE_STRUCTURE
      6494**DCL      6496--IMP-SIZ
VD$BUFFER_HEADER.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      5361**DCL      5827--IF       5828<<ASSIGN   5830<<ASSIGN   5830--ASSIGN   6108--IF       6109<<ASSIGN
      6111<<ASSIGN   6111--ASSIGN
VD$ENCODED_FILE_SPEC IN PROCEDURE HEADER_RECORD
      7086**DCL      7110>>ASSIGN
VD$ERR.DCB#
      4343**DCL      4437<<ASSIGN   6246<<ASSIGN
VD$EVAL.BLINK$ IN PROCEDURE POINTERIZE_RECORD
      5484**DCL      6152--IF       6153<<ASSIGN   6155<<ASSIGN   6155--ASSIGN
VD$EVAL.ENCLOSING.ENDD IN PROCEDURE POINTERIZE_RECORD
      5535**DCL      6158<>CALL
VD$EVAL.ENCLOSING.START IN PROCEDURE POINTERIZE_RECORD
      5507**DCL      6157<>CALL
VD$EVAL.RANGE.ENDD IN PROCEDURE POINTERIZE_RECORD
      5604**DCL      6160<>CALL
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:102  
VD$EVAL.RANGE.START IN PROCEDURE POINTERIZE_RECORD
      5576**DCL      6159<>CALL
VD$FIT.CODE2$ IN PROCEDURE POINTERIZE_RECORD
      5729**DCL      6168--IF       6169<<ASSIGN   6171<<ASSIGN   6171--ASSIGN
VD$FIT.CODE3$ IN PROCEDURE POINTERIZE_RECORD
      5729**DCL      6174--IF       6175<<ASSIGN   6177<<ASSIGN   6177--ASSIGN
VD$IT_ADJUST.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      4791**DCL      5946--IF       5947<<ASSIGN   5949<<ASSIGN   5949--ASSIGN
VD$IT_ADJUST.MOVEMENTS$ IN PROCEDURE POINTERIZE_RECORD
      4791**DCL      5952--IF       5953<<ASSIGN   5955<<ASSIGN   5955--ASSIGN
VD$IT_ADJUST.MOVEMENTS_TAIL$ IN PROCEDURE POINTERIZE_RECORD
      4792**DCL      5958--IF       5959<<ASSIGN   5961<<ASSIGN   5961--ASSIGN
VD$IT_ADJUST.PARENT$ IN PROCEDURE POINTERIZE_RECORD
      4791**DCL      5940--IF       5941<<ASSIGN   5943<<ASSIGN   5943--ASSIGN
VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.REP# IN PROCEDURE POINTERIZE_RECORD
      4842**DCL      5971>>IF
VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.V$ IN PROCEDURE POINTERIZE_RECORD
      4842**DCL      5973--IF       5974<<ASSIGN   5976<<ASSIGN   5976--ASSIGN
VD$IT_BLOCK_EXPR.DOMAINN.RANGE.ENDD IN PROCEDURE POINTERIZE_RECORD
      4894**DCL      5980<>CALL
VD$IT_BLOCK_EXPR.DOMAINN.RANGE.START IN PROCEDURE POINTERIZE_RECORD
      4866**DCL      5979<>CALL
VD$IT_BLOCK_EXPR.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      4828**DCL      5966--IF       5967<<ASSIGN   5969<<ASSIGN   5969--ASSIGN
VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.REP# IN PROCEDURE POINTERIZE_RECORD
      4939**DCL      5982>>IF
VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.V$ IN PROCEDURE POINTERIZE_RECORD
      4939**DCL      5984--IF       5985<<ASSIGN   5987<<ASSIGN   5987--ASSIGN
VD$IT_BLOCK_EXPR.OPTIONS.STRUCTURE$ IN PROCEDURE POINTERIZE_RECORD
      4925**DCL      5981<<ASSIGN
VD$IT_BLOCK_EXPR.SELECTS$ IN PROCEDURE POINTERIZE_RECORD
      4942**DCL      5991--IF       5992<<ASSIGN   5994<<ASSIGN   5994--ASSIGN
VD$IT_BLOCK_EXPR.SELECTS_TAIL$ IN PROCEDURE POINTERIZE_RECORD
      4942**DCL      5997--IF       5998<<ASSIGN   6000<<ASSIGN   6000--ASSIGN
VD$IT_COMMAND.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      4978**DCL      6011--IF       6012<<ASSIGN   6014<<ASSIGN   6014--ASSIGN
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:103  
VD$IT_COMMAND.PARAM$ IN PROCEDURE POINTERIZE_RECORD
      4979**DCL      6018--IF       6019<<ASSIGN   6021<<ASSIGN   6021--ASSIGN
VD$IT_COMMAND.PARENT$ IN PROCEDURE POINTERIZE_RECORD
      4978**DCL      6005--IF       6006<<ASSIGN   6008<<ASSIGN   6008--ASSIGN
VD$IT_OPERAND.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      5016**DCL      6033--IF       6034<<ASSIGN   6036<<ASSIGN   6036--ASSIGN
VD$IT_OPERAND.KEY.REP# IN PROCEDURE POINTERIZE_RECORD
      5044**DCL      6038>>IF
VD$IT_OPERAND.KEY.V$ IN PROCEDURE POINTERIZE_RECORD
      5044**DCL      6040--IF       6041<<ASSIGN   6043<<ASSIGN   6043--ASSIGN
VD$IT_OPERAND.PARAM$ IN PROCEDURE POINTERIZE_RECORD
      5046**DCL      6047--IF       6048<<ASSIGN   6050<<ASSIGN   6050--ASSIGN
VD$IT_OPERAND.PARENT$ IN PROCEDURE POINTERIZE_RECORD
      5016**DCL      6027--IF       6028<<ASSIGN   6030<<ASSIGN   6030--ASSIGN
VD$IT_OPERATOR.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      5082**DCL      6061--IF       6062<<ASSIGN   6064<<ASSIGN   6064--ASSIGN
VD$IT_OPERATOR.OPERAND$ IN PROCEDURE POINTERIZE_RECORD
      5082**DCL      6067--IF       6068<<ASSIGN   6070<<ASSIGN   6070--ASSIGN
VD$IT_OPERATOR.PARENT$ IN PROCEDURE POINTERIZE_RECORD
      5082**DCL      6055--IF       6056<<ASSIGN   6058<<ASSIGN   6058--ASSIGN
VD$IT_OPERATOR.R_OPERAND$ IN PROCEDURE POINTERIZE_RECORD
      5083**DCL      6073--IF       6074<<ASSIGN   6076<<ASSIGN   6076--ASSIGN
VD$IT_SELECT.ADJUSTS$ IN PROCEDURE POINTERIZE_RECORD
      5120**DCL      6093--IF       6094<<ASSIGN   6096<<ASSIGN   6096--ASSIGN
VD$IT_SELECT.ADJUSTS_TAIL$ IN PROCEDURE POINTERIZE_RECORD
      5120**DCL      6099--IF       6100<<ASSIGN   6102<<ASSIGN   6102--ASSIGN
VD$IT_SELECT.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      5119**DCL      6087--IF       6088<<ASSIGN   6090<<ASSIGN   6090--ASSIGN
VD$IT_SELECT.PARENT$ IN PROCEDURE POINTERIZE_RECORD
      5119**DCL      6081--IF       6082<<ASSIGN   6084<<ASSIGN   6084--ASSIGN
VD$OBJECT_HEADER.CLASS# IN PROCEDURE POINTERIZE_RECORD
      4537**DCL      5812>>DOCASE   6106>>IF       6203>>ASSIGN   6216>>DOCASE   6219>>IF       6231>>ASSIGN
      6244>>CALL
VD$OBJECT_HEADER.SIZE# IN PROCEDURE POINTERIZE_RECORD
      4537**DCL      6202>>IF       6206>>ASSIGN   6230>>IF       6234>>ASSIGN
VD$PATTERN.ENTRIES.MATCH$ IN PROCEDURE POINTERIZE_RECORD
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:104  
      5447**DCL      6143--IF       6144<<ASSIGN   6146<<ASSIGN   6146--ASSIGN
VD$PATTERN.N_ENTRIES# IN PROCEDURE POINTERIZE_RECORD
      5433**DCL      6141>>DOINDEX
VD$POINTER.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      5773**DCL      6183--IF       6184<<ASSIGN   6186<<ASSIGN   6186--ASSIGN
VD$POINTER.V$ IN PROCEDURE POINTERIZE_RECORD
      5773**DCL      6189--IF       6190<<ASSIGN   6192<<ASSIGN   6192--ASSIGN   6224<>CALL
VD$PORT.CURRENT.EOF
      4214**DCL      4405>>IF
VD$PORT.LEVEL.SPEC.V$
      4230**DCL      4406>>ASSIGN
VD$PORT.LEVEL.INTERNAL$ IN PROCEDURE POINTERIZE_STRUCTURE
      6596**DCL      6716>>ASSIGN
VD$RECORD_SET.DESC.KEY.REP# IN PROCEDURE POINTERIZE_RECORD
      4701**DCL      5908>>IF
VD$RECORD_SET.DESC.KEY.V$ IN PROCEDURE POINTERIZE_RECORD
      4701**DCL      5910--IF       5911<<ASSIGN   5913<<ASSIGN   5913--ASSIGN
VD$RECORD_SET.N_ENTRIES# IN PROCEDURE POINTERIZE_RECORD
      4676**DCL      5907>>DOINDEX
VD$STREAM IN PROCEDURE POINTERIZE_STRUCTURE
      6607**DCL      6711<>CALL
VD$STREAM.CURRENT.EOF IN PROCEDURE POINTERIZE_STRUCTURE
      6674**DCL      6714>>IF
VD$STREAM.PORT$ IN PROCEDURE POINTERIZE_STRUCTURE
      6633**DCL      6716>>ASSIGN
VD$STRING_HEADER.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      5397**DCL      5817--IF       5818<<ASSIGN   5820<<ASSIGN   5820--ASSIGN
VD$STRUCTURE_SPEC.ACCESSOR$ IN PROCEDURE POINTERIZE_RECORD
      4754**DCL      5926--IF       5927<<ASSIGN   5929<<ASSIGN   5929--ASSIGN
VD$STRUCTURE_SPEC.FIT$ IN PROCEDURE POINTERIZE_RECORD
      4754**DCL      5932--IF       5933<<ASSIGN   5935<<ASSIGN   5935--ASSIGN
VD$STRUCTURE_SPEC.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      4754**DCL      5920--IF       5921<<ASSIGN   5923<<ASSIGN   5923--ASSIGN
VD$WINDOW_BLOCK.EDIT_BLOCK$ IN PROCEDURE POINTERIZE_RECORD
      4639**DCL      5894--IF       5895<<ASSIGN   5897<<ASSIGN   5897--ASSIGN
VD$WINDOW_BLOCK.EVAL$ IN PROCEDURE POINTERIZE_RECORD
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:105  
      4639**DCL      5900--IF       5901<<ASSIGN   5903<<ASSIGN   5903--ASSIGN
VD$WINDOW_BLOCK.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      4639**DCL      5888--IF       5889<<ASSIGN   5891<<ASSIGN   5891--ASSIGN
VD$WINDOW_SPEC.COORDS.HEIGHT#
      4106**DCL      4406>>ASSIGN
VD$WINDOW_SPEC.EOFMARK$ IN PROCEDURE POINTERIZE_RECORD
      4601**DCL      5877>>IF       5879--IF       5880<<ASSIGN   5882<<ASSIGN   5882--ASSIGN
VD$WINDOW_SPEC.FLINK$ IN PROCEDURE POINTERIZE_RECORD
      4573**DCL      5835--IF       5836<<ASSIGN   5838<<ASSIGN   5838--ASSIGN
VD$WINDOW_SPEC.KEY_DEFINITION_BUFFER$ IN PROCEDURE POINTERIZE_RECORD
      4602**DCL      5866--IF       5867<<ASSIGN   5869<<ASSIGN   5869--ASSIGN
VD$WINDOW_SPEC.OPERAND.EDIT_BLOCK$ IN PROCEDURE POINTERIZE_RECORD
      4588**DCL      5848--IF       5849<<ASSIGN   5851<<ASSIGN   5851--ASSIGN
VD$WINDOW_SPEC.OPERAND.EVAL$ IN PROCEDURE POINTERIZE_RECORD
      4588**DCL      5854--IF       5855<<ASSIGN   5857<<ASSIGN   5857--ASSIGN
VD$WINDOW_SPEC.OPERAND.INTREE$ IN PROCEDURE POINTERIZE_RECORD
      4588**DCL      5842--IF       5843<<ASSIGN   5845<<ASSIGN   5845--ASSIGN
VD$WINDOW_SPEC.OPERAND.STREAM$ IN PROCEDURE POINTERIZE_RECORD
      4588**DCL      5840<<ASSIGN
VD$WINDOW_SPEC.RECORD_SET$ IN PROCEDURE POINTERIZE_RECORD
      4591**DCL      5860--IF       5861<<ASSIGN   5863<<ASSIGN   5863--ASSIGN
VD$WINDOW_SPEC.TABS$ IN PROCEDURE POINTERIZE_RECORD
      4600**DCL      5872--IF       5873<<ASSIGN   5875<<ASSIGN   5875--ASSIGN
VDA$FCLOSE
      3438**DCL-ENT  4424--CALL     4449--CALL
VDA$LDELETE
      3437**DCL-ENT  7120--CALL
VDA$LREAD IN PROCEDURE POINTERIZE_STRUCTURE
      6294**DCL-ENT  6711--CALL
VDG$EREPORT_ERROR
      3448**DCL-ENT  4442--CALL     7137--CALL
VDG$ERRMSG
      3439**DCL-ENT  4435--CALL     6244--CALL
VDG$ESCREECH
      3449**DCL-ENT  6715--CALL
VDG$MONERR
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:106  
      3440**DCL-ENT  7145--CALL
VDG$OALLOC
      3442**DCL-ENT  4356--CALL
VDG$OFREE
      3445**DCL-ENT  4426--CALL     4451--CALL
VDG$WARNMSG
      3441**DCL-ENT  7134--CALL
VDI$PREAD_FILE_READ
      3436**DCL-ENT  4366--CALL
VDW$RESTORE_NODE
      3447**DCL-ENT  4416--CALL
VD_$SCREEN.V#
      3584**DCL      4412>>ASSIGN
VD_6E.CMD_STREAM$
      3483**DCL      3639--IMP-PTR  4363>>ASSIGN   4370>>ASSIGN   4371>>IF       4420>>ASSIGN   4420>>ASSIGN
      4435>>CALL     6244>>CALL
VD_6E.ERR_TAIL$
      3484**DCL      4301--IMP-PTR  4437>>ASSIGN   6246>>ASSIGN
VD_6E.STRUCTURES$
      3465**DCL      6711>>CALL     6714>>IF       6716>>ASSIGN
VD_6E.WINDOWS$
      3466**DCL      3907--IMP-PTR  4405>>IF       4406>>ASSIGN   7120>>CALL
VD_KEY_NUMERIC_BOF
      3496**DCL      7117>>ASSIGN
VD_LAST_LOADED_FILE_SPEC
      3595**DCL      7110<<ASSIGN
VD_LAST_LOADED_FILE_SPEC.CONTENTS
      3610**DCL      7114>>IF       7124>>IF
VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE
      3613**DCL      7134<>CALL
VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE.BYTES
      3614**DCL      7130>>IF
VD_LAST_LOADED_FILE_SPEC.LAST_MODIFIED.PROFILE.LENGTH#
      3613**DCL      7130>>IF
VD_OBJECTS.SIZE
      3509**DCL      6203>>ASSIGN   6231>>ASSIGN
PL6.E3A0      #001=VDW$LOAD File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:41 Page:107  
VLP_LINEATTR IN PROCEDURE HEADER_RECORD
      7072**DCL      7127--ASSIGN
VLP_LINEATTR.PROFILE# IN PROCEDURE HEADER_RECORD
      7074**DCL      7074--REDEF
VLP_LINEATTR.PROTXTC IN PROCEDURE HEADER_RECORD
      7074**DCL      7134<>CALL
VLP_LINEATTR.PROTXTC.CNT IN PROCEDURE HEADER_RECORD
      7074**DCL      7130>>IF
VLP_LINEATTR.PROTXTC.TXT IN PROCEDURE HEADER_RECORD
      7075**DCL      7130>>IF
WINDOW$SPEC.COORDS.HEIGHT#
      4040**DCL      4404>>ASSIGN   4406<<ASSIGN   4412<<ASSIGN
WINDOWS$STREAM
      3907**DCL      7120<>CALL
WINDOWS$STREAM.PORT$
      3933**DCL      4405>>IF       4406>>ASSIGN
WINDOW_SPEC$
      3628**DCL      4013--IMP-PTR  4403<<ASSIGN   4404>>ASSIGN   4406>>ASSIGN   4412>>ASSIGN
WRESTORE_NODE_FAILED
      4437**LABEL    4416--CALLALT
WS_FILE_INVALID_FAILURE
      4435**LABEL    4373--GOTO     4383--GOTO     4391--GOTO
WS_FILE_INVALID_FAILURE IN PROCEDURE POINTERIZE_RECORD
      6231**LABEL    6198--GOTO

PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:108  
      742        1        /*T***********************************************************/
      743        2        /*T*                                                         */
      744        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      745        4        /*T*                                                         */
      746        5        /*T***********************************************************/
      747        6
      748        7        /*D* NAME: VDW$RESTORE_NODE
      749        8            PARAMETERS:
      750        9        *N**N*  STREAM - The VD$STREAM to use when restoring nodes to external files.
      751       10                ENCODED_DESC - The VD$ENCODED_DESC containing the node to
      752       11                    restore.
      753       12                LOAD_FLAGS - An ALIGNED array of BIT(1) UNAL flags.  Entries are
      754       13                    accessed using %PDFF_ values as subscripts.  Each bit flag
      755       14                    represents an internal file which may be loaded from the workspace
      756       15                    file; if a bit-flag in LOAD_FLAGS is off and the workspace file
      757       16                    contains a node for that file, we'll ignore the record in the
      758       17                    workspace file.
      759       18            INPUT:
      760       19                VD_6E.EQUALS$, .LOCATIONS$, .SYNONYMS$, .KEYINS$,
      761       20                    and .WINDOWS$ must point to open VD$STREAMs
      762       21                    for the Names and Windows internal files.
      763       22                VD_6E.STRUCTURES$ must point to a VD$STREAM which is open
      764       23                    to at least a minimal Structures internal file.
      765       24            OUTPUT:
      766       25                VD_COMMAND_WINDOW$ may be set, if ENCODED_DESC represents
      767       26                    the command window.
      768       27            DESCRIPTION:
      769       28                If ENCODED_DESC is a Names-file node, see if the name is one
      770       29                    of the predefined names whose value is stored elsewhere
      771       30                    in the History, Structures, or Windows files
      772       31                    (e.g., CURRENT, HERE, THAT, $ENCLOSING, $FP, $RANGE, ...).
      773       32                    If so, ignore the workspace-file record.
      774       33                If ENCODED_DESC is a predefined Structures-file node, ignore it.
      775       34                    The "predefined" Structures-file entries are those
      776       35                    whose level-1 key equals a %DK_ value.
      777       36        */
      778       37
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:109  
      779       38        VDW$RESTORE_NODE: PROC (STREAM, ENCODED_DESC, LOAD_FLAGS) ALTRET;
      780       39
      781       40
      782       41        %INCLUDE VD_MACROS_M;
      783     2256        %INCLUDE VD_PERR_C;
      784     2404
      785     2405
      786     2406        %VD$ENCODED_DESC (NAME=ENCODED_DESC, STCLASS=PARAM);
      787     2490        %VD$STREAM (NAME=STREAM, STCLASS=PARAM);
      788     2596    1   DCL 1 LOAD_FLAGS ALIGNED PARAM,
      789     2597              %VD$PDFF (NAME=F, STCLASS=PARAM, LEV=2, LAST=YES);
      790     2611
      791     2612
      792     2613
      793     2614    1   DCL VDA$FOPEN           ENTRY (4) ALTRET;
      794     2615    1   DCL VDA$LWRITE          ENTRY (4) ALTRET;
      795     2616    1   DCL VDA$PFLUSH          ENTRY (2) ALTRET;
      796     2617    1   DCL VDG$OCOPY           ENTRY (2) ALTRET;
      797     2618    1   DCL VDG$OFREE           ENTRY (1) ALTRET;
      798     2619    1   DCL VDG$ESCREECH        ENTRY (3);
      799     2620
      800     2621
      801     2622        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
      802     2658    1   DCL 1 VD_ACCESSOR_PRIV ALIGNED SYMREF,
      803     2659              %VD$NAC (NAME=ACCESS, LEV=2, LAST=YES, ALIGNMENT=UNAL);
      804     2673
      805     2674
      806     2675    1   DCL 1 SAVE_ACCESSOR_PRIV ALIGNED,
      807     2676              %VD$NAC (NAME=ACCESS, LEV=2, LAST=YES, ALIGNMENT=UNAL);
      808     2690        %VD$ACCESS_OPTIONS (NAME=OPTIONS, STCLASS=AUTO);
      809     2719    1   DCL PREDEF_STREAM$ PTR;
      810     2720    1   DCL FILE_KEY_NAME$ PTR;
      811     2721    1   DCL FILE_STCLASS CHAR(1);
      812     2722    1   DCL PFN_INDEX SBIN;
      813     2723    1   DCL DIR_KEY CHAR(%MXNB_FILE_NAME);
      814     2724    1   DCL FILE_ID_WITHIN_DIR CHAR(%MXNB_FILE_NAME);
      815     2725    1   DCL FILE_KEY_TEXTC$ PTR;
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:110  
      816     2726    1   DCL TEST_KEY_TEXTC$ PTR;
      817     2727    1   DCL CAND_DIR$ PTR;
      818     2728        %VD$SPEC (NAME=WRITE_SPEC, STCLASS=AUTO);
      819     2742    1   DCL WRITE_DATA$ PTR;
      820     2743
      821     2744
      822     2745        %VD$STREAM (NAME=PREDEF$STREAM, STCLASS="BASED(PREDEF_STREAM$)");
      823     2851        %VD$FILE_KEY (NAME=FILE$KEY,
      824     2852            STCLASS="BASED(ENCODED_DESC.FILE_KEY.V$)");
      825     2901        %VD$TEXTC (NAME=FILE$KEY_TEXTC, STCLASS="BASED(FILE_KEY_TEXTC$)");
      826     2924        %VD$TEXTC (NAME=TEST$KEY_TEXTC, STCLASS="BASED(TEST_KEY_TEXTC$)");
      827     2947        %VD$TEXTC (NAME=FILE$KEY_NAME, STCLASS="BASED(FILE_KEY_NAME$)",
      828     2948            ALIGNMENT=CALIGNED);
      829     2971        %VD$DIR_NODE (NAME=CAND$DIR, STCLASS="BASED(CAND_DIR$)");
      830     3009        %VD$BUFFER (NAME=WRITE$DATA, STCLASS="BASED(WRITE_DATA$)");
      831     3067        %VD$TEXTC_REMOTE;
      832     3128        %VD$NAME_SPEC;
      833     3176        %VD$WINDOW_SPEC;
      834     3242        %VD$PORT;
      835     3340        %VD$BUFFER;
      836     3398
      837     3399
      838     3400
      839     3401    1           OPTIONS = %CLEAR;
      840     3402
      841     3403                /*
      842     3404                *   Determine if the file belongs in an internal directory.
      843     3405                *   If so, see if the stream for that file is closed, and
      844     3406                *       if so, create the file.
      845     3407                *   If any of the above is false, just open STREAM
      846     3408                *       to the file with EXIST=ANY.
      847     3409                */
      848     3410
      849     3411    1           PREDEF_STREAM$ = ADDR(NIL); /* Assume file isn't predefined */
      850     3412    1           IF ENCODED_DESC.FILE_KEY.REP# ~= %REP_REMOTE THEN
      851     3413    1              CALL VDG$ESCREECH (ENCODED_DESC.FILE_KEY.REP#);
      852     3414    1           FILE_KEY_NAME$ = ADDR(FILE$KEY.UNIQUE.FNAME);
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:111  
      853     3415    1           FILE_STCLASS = SUBSTR(FILE$KEY_NAME.BYTES, 0, 1);
      854     3416    1           IF FILE$KEY.PSN = ' ' AND FILE$KEY.UNIQUE.ACCT = ' '
      855     3417    1             AND FILE_STCLASS ~= %FSTCL_EXTERNAL
      856     3418    1             AND FILE$KEY_NAME.LENGTH# >=
      857     3419    1             %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT))
      858     3420    1             AND SUBSTR(FILE$KEY_NAME.BYTES, LENGTHC(FILE_STCLASS),
      859     3421    1             %LENGTHC(PFK_CONSTANT)) = %PFK_CONSTANT THEN
      860     3422    2   MAY_BE_PREDEF: DO;
      861     3423    2              CALL INDEX (PFN_INDEX, %CHR_UNDERSCORE, FILE$KEY_NAME.BYTES,
      862     3424    2                %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT)));
      863     3425    2              DIR_KEY = SUBSTR(FILE$KEY_NAME.BYTES,
      864     3426    2                %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT)),
      865     3427    2                PFN_INDEX - %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT)));
      866     3428
      867     3429    3              DO SELECT (DIR_KEY);
      868     3430    3                 SELECT (%DK_NAMES);
      869     3431                      /*
      870     3432                      *  If the node has no Data component, then it
      871     3433                      *      represents a name whose value is stored
      872     3434                      *      elsewhere in the workspace (ie, the Data
      873     3435                      *      component is "found" each time the node is
      874     3436                      *      read by the Names-file node-reader).
      875     3437                      *      Therefore, ignore this Names-file node.
      876     3438                      */
      877     3439    3                 IF ENCODED_DESC.DATA$ = ADDR(NIL) THEN
      878     3440    3                    RETURN;      /* Ignore this node */
      879     3441    3                 OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_NAMES$;
      880     3442    3                 IF PFN_INDEX < FILE$KEY.LENGTH# THEN
      881     3443    3                    FILE_ID_WITHIN_DIR = SUBSTR(FILE$KEY_NAME.BYTES,
      882     3444    3                      PFN_INDEX + 1);
      883     3445    3                 ELSE
      884     3446    3                    FILE_ID_WITHIN_DIR = ' ';
      885     3447    4                 DO SELECT (FILE_ID_WITHIN_DIR);
      886     3448    4                    SELECT (%PFN_NAMES_EQUALS);
      887     3449    4                    IF NOT LOAD_FLAGS.F (%PDFF_EQUALS) THEN
      888     3450    4                       RETURN; /* Ignore this node */
      889     3451    4                    PREDEF_STREAM$ = VD_6E.EQUALS$;
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:112  
      890     3452    4                    SELECT (%PFN_NAMES_LOCATIONS);
      891     3453    4                    IF NOT LOAD_FLAGS.F (%PDFF_LOCATIONS) THEN
      892     3454    4                       RETURN; /* Ignore this node */
      893     3455    4                    PREDEF_STREAM$ = VD_6E.LOCATIONS$;
      894     3456    4                    SELECT (%PFN_NAMES_SYNONYMS);
      895     3457    4                    IF NOT LOAD_FLAGS.F (%PDFF_SYNONYMS) THEN
      896     3458    4                       RETURN; /* Ignore this node */
      897     3459    4                    PREDEF_STREAM$ = VD_6E.SYNONYMS$;
      898     3460    4                    SELECT (%PFN_NAMES_KEYINS);
      899     3461    4                    IF NOT LOAD_FLAGS.F (%PDFF_KEYINS) THEN
      900     3462    4                       RETURN; /* Ignore this node */
      901     3463    4                    PREDEF_STREAM$ = VD_6E.KEYINS$;
      902     3464    4                    SELECT (ELSE);
      903     3465    4                 ; /* Fall thru with no PREDEF_STREAM$:  try user-def */
      904     3466    4                    END;
      905     3467
      906     3468    3              SELECT (%DK_STRUCTURES);
      907     3469    3              IF NOT LOAD_FLAGS.F (%PDFF_STRUCTURES) THEN
      908     3470    3                 RETURN; /* Ignore this node */
      909     3471                   %GETKEY (KEY=ENCODED_DESC.LOCATION.KEY, INDX="%(LVL_LOWER-1)",
      910     3472                   PTR=TEST_KEY_TEXTC$);
      911     3482    3              CAND_DIR$ = VD_6E.WS.INTERNAL_DIR$;
      912     3483    4              DO WHILE CAND_DIR$ ~= ADDR(NIL);
      913     3484    4                 IF TEST$KEY_TEXTC.BYTES = CAND$DIR.KEY THEN
      914     3485    4                    RETURN;  /* Ignore this node */
      915     3486    4                 CAND_DIR$ = CAND$DIR.FLINK$;
      916     3487    4                 END;
      917     3488    3              OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_STRUCTURES$;
      918     3489    3              PREDEF_STREAM$ = VD_6E.STRUCTURES$;
      919     3490
      920     3491    3              SELECT (%DK_WINDOWS);
      921     3492    3              IF NOT LOAD_FLAGS.F (%PDFF_WINDOWS) THEN
      922     3493    3                 RETURN;     /* Ignore this node */
      923     3494    3              OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_WINDOWS$;
      924     3495    3              PREDEF_STREAM$ = VD_6E.WINDOWS$;
      925     3496
      926     3497    3              SELECT (ELSE);
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:113  
      927     3498    3              ; /* Fall thru with no PREDEF_STREAM$:  try user-def */
      928     3499    3                 END;
      929     3500    2              END MAY_BE_PREDEF;
      930     3501
      931     3502
      932     3503                /*
      933     3504                *  Make copies of the components for Accessor: we want to keep
      934     3505                *     the originals.
      935     3506                */
      936     3507
      937     3508                %COPYSPEC (FSPEC=ENCODED_DESC.SPEC, TSPEC=WRITE_SPEC);
      938     3524    1           IF ENCODED_DESC.DATA$ = ADDR(NIL) THEN
      939     3525    1              WRITE_DATA$ = ADDR(NIL);
      940     3526    2           ELSE DO;
      941     3527    2              CALL VDG$OCOPY (ENCODED_DESC.DATA$->VD$BUFFER, WRITE_DATA$)
      942     3528    2                ALTRET (OCOPY_FAILED);
      943     3529    2              END;
      944     3530
      945     3531    2           IF PREDEF_STREAM$ ~= ADDR(NIL) THEN DO;
      946     3532    2              SAVE_ACCESSOR_PRIV = VD_ACCESSOR_PRIV;
      947     3533    2              VD_ACCESSOR_PRIV = %NAC_ALL_BITS;
      948     3534    2              CALL VDA$LWRITE (PREDEF$STREAM, ENCODED_DESC.LOCATION,
      949     3535    2                WRITE_SPEC, WRITE$DATA)
      950     3536    2                ALTRET (PREDEF_LWRITE_FAILED);
      951     3537    2              CALL VDA$PFLUSH (PREDEF$STREAM.PORT$->VD$PORT, %TO_PRESENTER)
      952     3538    2                ALTRET (PREDEF_PFLUSH_FAILED);
      953     3539    2              VD_ACCESSOR_PRIV = SAVE_ACCESSOR_PRIV;
      954     3540    2              END;
      955     3541    2           ELSE DO;
      956     3542    2              IF STREAM.PORT$ ~= ADDR(NIL)
      957     3543    3                AND STREAM.PORT$->VD$PORT.EXIST# ~= 0 THEN DO;
      958     3544                      %GETKEY (KEY=STREAM.FILE_KEY, PTR=TEST_KEY_TEXTC$);
      959     3554    3                 END;
      960     3555    2              FILE_KEY_TEXTC$ = ADDR(FILE$KEY.LENGTH#);
      961     3556    2              IF STREAM.PORT$ = ADDR(NIL)
      962     3557    2                OR STREAM.PORT$->VD$PORT.EXIST# = 0
      963     3558    3                OR TEST$KEY_TEXTC.BYTES ~= FILE$KEY_TEXTC.BYTES THEN DO;
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:114  
      964     3559    3                 OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_EXTERNAL$;
      965     3560    3                 OPTIONS.PROTECT# = %DONT_PROTECT;
      966     3561    3                 OPTIONS.EXIST# = %EX_ANY;
      967     3562    3                 CALL VDA$FOPEN (STREAM, ENCODED_DESC.FILE_KEY, 0, OPTIONS)
      968     3563    3                   ALTRET (FOPEN_FAILED);
      969     3564    3                 END;
      970     3565    2              CALL VDA$LWRITE (STREAM, ENCODED_DESC.LOCATION,
      971     3566    2                WRITE_SPEC, WRITE$DATA)
      972     3567    2                ALTRET (USERDEF_LWRITE_FAILED);
      973     3568    2              CALL VDA$PFLUSH (STREAM.PORT$->VD$PORT, %TO_PRESENTER)
      974     3569    2                ALTRET (USERDEF_PFLUSH_FAILED);
      975     3570    2              END;
      976     3571
      977     3572    1           RETURN;
      978     3573
      979     3574
      980     3575
      981     3576    1   PREDEF_LWRITE_FAILED: ;
      982     3577    1           VD_ACCESSOR_PRIV = SAVE_ACCESSOR_PRIV;
      983     3578    1   USERDEF_LWRITE_FAILED: ;
      984     3579                %CLEARSPEC (SPEC=WRITE_SPEC);
      985     3589    1           CALL VDG$OFREE (WRITE$DATA)
      986     3590    1             ALTRET (OFREE_FAILED);
      987     3591    1           ALTRETURN;
      988     3592    1   PREDEF_PFLUSH_FAILED: ;
      989     3593    1           VD_ACCESSOR_PRIV = SAVE_ACCESSOR_PRIV;
      990     3594    1   FOPEN_FAILED: ;
      991     3595    1   USERDEF_PFLUSH_FAILED: ;
      992     3596    1   OCOPY_FAILED: ;
      993     3597    1   OFREE_FAILED: ;
      994     3598    1           ALTRETURN;
      995     3599
      996     3600    1   END VDW$RESTORE_NODE;
      997     3601        %EOD;

PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:115  
--  Include file information  --

   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure VDW$RESTORE_NODE.

   Procedure VDW$RESTORE_NODE requires 386 words for executable code.
   Procedure VDW$RESTORE_NODE requires 42 words of local(AUTO) storage.

PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:116  

 Object Unit name= VDW$RESTORE_NODE                           File name= VDW$WORKSPACE.:VDA5TOU
 UTS= JUL 04 '97 11:42:22.88 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     18     22  VDW$RESTORE_NODE
    1   Proc  even  none   386    602  VDW$RESTORE_NODE
    2  RoData even  none     3      3  VDW$RESTORE_NODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        3  VDW$RESTORE_NODE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 VDG$ESCREECH
 yes     yes           Std       4 VDA$LWRITE
 yes     yes           Std       2 VDG$OCOPY
 yes     yes           Std       4 VDA$FOPEN
 yes     yes           Std       1 VDG$OFREE
 yes     yes           Std       2 VDA$PFLUSH
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:117  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     VD_6E                                 VD_ACCESSOR_PRIV                      B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:118  


      742        1        /*T***********************************************************/
      743        2        /*T*                                                         */
      744        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      745        4        /*T*                                                         */
      746        5        /*T***********************************************************/
      747        6
      748        7        /*D* NAME: VDW$RESTORE_NODE
      749        8            PARAMETERS:
      750        9        *N**N*  STREAM - The VD$STREAM to use when restoring nodes to external files.
      751       10                ENCODED_DESC - The VD$ENCODED_DESC containing the node to
      752       11                    restore.
      753       12                LOAD_FLAGS - An ALIGNED array of BIT(1) UNAL flags.  Entries are
      754       13                    accessed using %PDFF_ values as subscripts.  Each bit flag
      755       14                    represents an internal file which may be loaded from the workspace
      756       15                    file; if a bit-flag in LOAD_FLAGS is off and the workspace file
      757       16                    contains a node for that file, we'll ignore the record in the
      758       17                    workspace file.
      759       18            INPUT:
      760       19                VD_6E.EQUALS$, .LOCATIONS$, .SYNONYMS$, .KEYINS$,
      761       20                    and .WINDOWS$ must point to open VD$STREAMs
      762       21                    for the Names and Windows internal files.
      763       22                VD_6E.STRUCTURES$ must point to a VD$STREAM which is open
      764       23                    to at least a minimal Structures internal file.
      765       24            OUTPUT:
      766       25                VD_COMMAND_WINDOW$ may be set, if ENCODED_DESC represents
      767       26                    the command window.
      768       27            DESCRIPTION:
      769       28                If ENCODED_DESC is a Names-file node, see if the name is one
      770       29                    of the predefined names whose value is stored elsewhere
      771       30                    in the History, Structures, or Windows files
      772       31                    (e.g., CURRENT, HERE, THAT, $ENCLOSING, $FP, $RANGE, ...).
      773       32                    If so, ignore the workspace-file record.
      774       33                If ENCODED_DESC is a predefined Structures-file node, ignore it.
      775       34                    The "predefined" Structures-file entries are those
      776       35                    whose level-1 key equals a %DK_ value.
      777       36        */
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:119  
      778       37
      779       38        VDW$RESTORE_NODE: PROC (STREAM, ENCODED_DESC, LOAD_FLAGS) ALTRET;

     38  1 000000   000000 700200 xent  VDW$RESTORE* TSX0  ! X66_AUTO_3
         1 000001   000052 000003                    ZERO    42,3

      780       39
      781       40
      782       41        %INCLUDE VD_MACROS_M;
      783     2256        %INCLUDE VD_PERR_C;
      784     2404
      785     2405
      786     2406        %VD$ENCODED_DESC (NAME=ENCODED_DESC, STCLASS=PARAM);
      787     2490        %VD$STREAM (NAME=STREAM, STCLASS=PARAM);
      788     2596    1   DCL 1 LOAD_FLAGS ALIGNED PARAM,
      789     2597              %VD$PDFF (NAME=F, STCLASS=PARAM, LEV=2, LAST=YES);
      790     2611
      791     2612
      792     2613
      793     2614    1   DCL VDA$FOPEN           ENTRY (4) ALTRET;
      794     2615    1   DCL VDA$LWRITE          ENTRY (4) ALTRET;
      795     2616    1   DCL VDA$PFLUSH          ENTRY (2) ALTRET;
      796     2617    1   DCL VDG$OCOPY           ENTRY (2) ALTRET;
      797     2618    1   DCL VDG$OFREE           ENTRY (1) ALTRET;
      798     2619    1   DCL VDG$ESCREECH        ENTRY (3);
      799     2620
      800     2621
      801     2622        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
      802     2658    1   DCL 1 VD_ACCESSOR_PRIV ALIGNED SYMREF,
      803     2659              %VD$NAC (NAME=ACCESS, LEV=2, LAST=YES, ALIGNMENT=UNAL);
      804     2673
      805     2674
      806     2675    1   DCL 1 SAVE_ACCESSOR_PRIV ALIGNED,
      807     2676              %VD$NAC (NAME=ACCESS, LEV=2, LAST=YES, ALIGNMENT=UNAL);
      808     2690        %VD$ACCESS_OPTIONS (NAME=OPTIONS, STCLASS=AUTO);
      809     2719    1   DCL PREDEF_STREAM$ PTR;
      810     2720    1   DCL FILE_KEY_NAME$ PTR;
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:120  
      811     2721    1   DCL FILE_STCLASS CHAR(1);
      812     2722    1   DCL PFN_INDEX SBIN;
      813     2723    1   DCL DIR_KEY CHAR(%MXNB_FILE_NAME);
      814     2724    1   DCL FILE_ID_WITHIN_DIR CHAR(%MXNB_FILE_NAME);
      815     2725    1   DCL FILE_KEY_TEXTC$ PTR;
      816     2726    1   DCL TEST_KEY_TEXTC$ PTR;
      817     2727    1   DCL CAND_DIR$ PTR;
      818     2728        %VD$SPEC (NAME=WRITE_SPEC, STCLASS=AUTO);
      819     2742    1   DCL WRITE_DATA$ PTR;
      820     2743
      821     2744
      822     2745        %VD$STREAM (NAME=PREDEF$STREAM, STCLASS="BASED(PREDEF_STREAM$)");
      823     2851        %VD$FILE_KEY (NAME=FILE$KEY,
      824     2852            STCLASS="BASED(ENCODED_DESC.FILE_KEY.V$)");
      825     2901        %VD$TEXTC (NAME=FILE$KEY_TEXTC, STCLASS="BASED(FILE_KEY_TEXTC$)");
      826     2924        %VD$TEXTC (NAME=TEST$KEY_TEXTC, STCLASS="BASED(TEST_KEY_TEXTC$)");
      827     2947        %VD$TEXTC (NAME=FILE$KEY_NAME, STCLASS="BASED(FILE_KEY_NAME$)",
      828     2948            ALIGNMENT=CALIGNED);
      829     2971        %VD$DIR_NODE (NAME=CAND$DIR, STCLASS="BASED(CAND_DIR$)");
      830     3009        %VD$BUFFER (NAME=WRITE$DATA, STCLASS="BASED(WRITE_DATA$)");
      831     3067        %VD$TEXTC_REMOTE;
      832     3128        %VD$NAME_SPEC;
      833     3176        %VD$WINDOW_SPEC;
      834     3242        %VD$PORT;
      835     3340        %VD$BUFFER;
      836     3398
      837     3399
      838     3400
      839     3401    1           OPTIONS = %CLEAR;

   3401  1 000002   000100 100400                    MLR     fill='000'O
         1 000003   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000004   200007 000024                    ADSC9   OPTIONS,,AUTO            cn=0,n=20

      840     3402
      841     3403                /*
      842     3404                *   Determine if the file belongs in an internal directory.
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:121  
      843     3405                *   If so, see if the stream for that file is closed, and
      844     3406                *       if so, create the file.
      845     3407                *   If any of the above is false, just open STREAM
      846     3408                *       to the file with EXIST=ANY.
      847     3409                */
      848     3410
      849     3411    1           PREDEF_STREAM$ = ADDR(NIL); /* Assume file isn't predefined */

   3411  1 000005   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000006   200014 756100                    STQ     PREDEF_STREAM$,,AUTO

      850     3412    1           IF ENCODED_DESC.FILE_KEY.REP# ~= %REP_REMOTE THEN

   3412  1 000007   200004 470500                    LDP0    @ENCODED_DESC,,AUTO
         1 000010   000000 720100                    LXL0    0,,PR0
         1 000011   000002 100003                    CMPX0   2,DU
         1 000012   000022 600000 1                  TZE     s:3414

      851     3413    1              CALL VDG$ESCREECH (ENCODED_DESC.FILE_KEY.REP#);

   3413  1 000013   200004 236100                    LDQ     @ENCODED_DESC,,AUTO
         1 000014   400000 036007                    ADLQ    -131072,DL
         1 000015   200046 756100                    STQ     WRITE_DATA$+1,,AUTO
         1 000016   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000020   000000 701000 xent               TSX1    VDG$ESCREECH
         1 000021   000000 011000                    NOP     0

      852     3414    1           FILE_KEY_NAME$ = ADDR(FILE$KEY.UNIQUE.FNAME);

   3414  1 000022   200004 470500                    LDP0    @ENCODED_DESC,,AUTO
         1 000023   000001 471500                    LDP1    1,,PR0
         1 000024   200046 451500                    STP1    WRITE_DATA$+1,,AUTO
         1 000025   200046 236100                    LDQ     WRITE_DATA$+1,,AUTO
         1 000026   000000 036000 2                  ADLQ    0
         1 000027   200015 756100                    STQ     FILE_KEY_NAME$,,AUTO

PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:122  
      853     3415    1           FILE_STCLASS = SUBSTR(FILE$KEY_NAME.BYTES, 0, 1);

   3415  1 000030   200015 471500                    LDP1    FILE_KEY_NAME$,,AUTO
         1 000031   000100 101500                    MRL     fill='000'O
         1 000032   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000033   200046 000002                    ADSC9   WRITE_DATA$+1,,AUTO      cn=0,n=2
         1 000034   200046 220100                    LDX0    WRITE_DATA$+1,,AUTO
         1 000035   040100 100500                    MLR     fill='040'O
         1 000036   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1
         1 000037   200016 000001                    ADSC9   FILE_STCLASS,,AUTO       cn=0,n=1

      854     3416    1           IF FILE$KEY.PSN = ' ' AND FILE$KEY.UNIQUE.ACCT = ' '

   3416  1 000040   000001 473500                    LDP3    1,,PR0
         1 000041   040000 106500                    CMPC    fill='040'O
         1 000042   300015 400006                    ADSC9   13,,PR3                  cn=2,n=6
         1 000043   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000044   000335 601000 1                  TNZ     s:3521
         1 000045   040000 106500                    CMPC    fill='040'O
         1 000046   300002 200010                    ADSC9   2,,PR3                   cn=1,n=8
         1 000047   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000050   000335 601000 1                  TNZ     s:3521
         1 000051   200016 236100                    LDQ     FILE_STCLASS,,AUTO
         1 000052   777000 376003                    ANQ     -512,DU
         1 000053   072000 116003                    CMPQ    29696,DU
         1 000054   000335 600000 1                  TZE     s:3521
         1 000055   000100 101500                    MRL     fill='000'O
         1 000056   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000057   200046 000004                    ADSC9   WRITE_DATA$+1,,AUTO      cn=0,n=4
         1 000060   200046 236100                    LDQ     WRITE_DATA$+1,,AUTO
         1 000061   000007 116007                    CMPQ    7,DL
         1 000062   000335 604000 1                  TMI     s:3521
         1 000063   000100 101500                    MRL     fill='000'O
         1 000064   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000065   200047 000002                    ADSC9   WRITE_DATA$+2,,AUTO      cn=0,n=2
         1 000066   200047 220100                    LDX0    WRITE_DATA$+2,,AUTO
         1 000067   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:123  
         1 000070   100000 400006                    ADSC9   0,,PR1                   cn=2,n=6
         1 000071   000000 000006 0                  ADSC9   0                        cn=0,n=6
         1 000072   000335 601000 1                  TNZ     s:3521

      855     3417    1             AND FILE_STCLASS ~= %FSTCL_EXTERNAL
      856     3418    1             AND FILE$KEY_NAME.LENGTH# >=
      857     3419    1             %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT))
      858     3420    1             AND SUBSTR(FILE$KEY_NAME.BYTES, LENGTHC(FILE_STCLASS),
      859     3421    1             %LENGTHC(PFK_CONSTANT)) = %PFK_CONSTANT THEN
      860     3422    2   MAY_BE_PREDEF: DO;

   3422  1 000073                       MAY_BE_PRED* null
      861     3423    2              CALL INDEX (PFN_INDEX, %CHR_UNDERSCORE, FILE$KEY_NAME.BYTES,

   3423  1 000073   000100 101500                    MRL     fill='000'O
         1 000074   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000075   200046 000002                    ADSC9   WRITE_DATA$+1,,AUTO      cn=0,n=2
         1 000076   200046 220100                    LDX0    WRITE_DATA$+1,,AUTO
         1 000077   777771 621010                    EAX1    -7,X0
         1 000100   000000 124540                    SCM     mask='000'O
         1 000101   100002 000011                    ADSC9   2,,PR1                   cn=0,n=*X1
         1 000102   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000103   200017 000100                    ARG     PFN_INDEX,,AUTO
         1 000104   000007 236007                    LDQ     7,DL
         1 000105   200017 056100                    ASQ     PFN_INDEX,,AUTO

      862     3424    2                %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT)));
      863     3425    2              DIR_KEY = SUBSTR(FILE$KEY_NAME.BYTES,

   3425  1 000106   000100 101500                    MRL     fill='000'O
         1 000107   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000110   200046 000002                    ADSC9   WRITE_DATA$+1,,AUTO      cn=0,n=2
         1 000111   200046 220100                    LDX0    WRITE_DATA$+1,,AUTO
         1 000112   200017 721100                    LXL1    PFN_INDEX,,AUTO
         1 000113   777771 622011                    EAX2    -7,X1
         1 000114   040100 100540                    MLR     fill='040'O
         1 000115   100002 000012                    ADSC9   2,,PR1                   cn=0,n=*X2
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:124  
         1 000116   200020 000037                    ADSC9   DIR_KEY,,AUTO            cn=0,n=31

      864     3426    2                %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT)),
      865     3427    2                PFN_INDEX - %(LENGTHC(FSTCL_INTERNAL)+LENGTHC(PFK_CONSTANT)));
      866     3428
      867     3429    3              DO SELECT (DIR_KEY);

   3429  1 000117   040000 106500                    CMPC    fill='040'O
         1 000120   200020 000037                    ADSC9   DIR_KEY,,AUTO            cn=0,n=31
         1 000121   000002 000012 0                  ADSC9   2                        cn=0,n=10
         1 000122   000131 602000 1                  TNC     s:3429+10
         1 000123   000256 600000 1                  TZE     s:3469
         1 000124   040000 106500                    CMPC    fill='040'O
         1 000125   200020 000037                    ADSC9   DIR_KEY,,AUTO            cn=0,n=31
         1 000126   000005 000007 0                  ADSC9   5                        cn=0,n=7
         1 000127   000335 601000 1                  TNZ     s:3521
         1 000130   000323 710000 1                  TRA     s:3492
         1 000131   040000 106500                    CMPC    fill='040'O
         1 000132   200020 000037                    ADSC9   DIR_KEY,,AUTO            cn=0,n=31
         1 000133   000007 000005 0                  ADSC9   7                        cn=0,n=5
         1 000134   000335 601000 1                  TNZ     s:3521
         1 000135   000136 710000 1                  TRA     s:3439

      868     3430    3                 SELECT (%DK_NAMES);

      869     3431                      /*
      870     3432                      *  If the node has no Data component, then it
      871     3433                      *      represents a name whose value is stored
      872     3434                      *      elsewhere in the workspace (ie, the Data
      873     3435                      *      component is "found" each time the node is
      874     3436                      *      read by the Names-file node-reader).
      875     3437                      *      Therefore, ignore this Names-file node.
      876     3438                      */
      877     3439    3                 IF ENCODED_DESC.DATA$ = ADDR(NIL) THEN

   3439  1 000136   000016 236100                    LDQ     14,,PR0
         1 000137   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:125  
         1 000140   000142 601000 1                  TNZ     s:3441

      878     3440    3                    RETURN;      /* Ignore this node */

   3440  1 000141   000000 702200 xent               TSX2  ! X66_ARET

      879     3441    3                 OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_NAMES$;

   3441  1 000142   000011 236000 xsym               LDQ     VD_6E+9
         1 000143   200007 756100                    STQ     OPTIONS,,AUTO

      880     3442    3                 IF PFN_INDEX < FILE$KEY.LENGTH# THEN

   3442  1 000144   000001 473500                    LDP3    1,,PR0
         1 000145   300002 236100                    LDQ     2,,PR3
         1 000146   000033 772000                    QRL     27
         1 000147   200017 116100                    CMPQ    PFN_INDEX,,AUTO
         1 000150   000166 604400 1                  TMOZ    s:3446

      881     3443    3                    FILE_ID_WITHIN_DIR = SUBSTR(FILE$KEY_NAME.BYTES,

   3443  1 000151   000100 101500                    MRL     fill='000'O
         1 000152   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000153   200046 000002                    ADSC9   WRITE_DATA$+1,,AUTO      cn=0,n=2
         1 000154   200046 220100                    LDX0    WRITE_DATA$+1,,AUTO
         1 000155   000000 636010                    EAQ     0,X0
         1 000156   000022 772000                    QRL     18
         1 000157   200017 136100                    SBLQ    PFN_INDEX,,AUTO
         1 000160   777777 623006                    EAX3    -1,QL
         1 000161   200017 235100                    LDA     PFN_INDEX,,AUTO
         1 000162   040100 100545                    MLR     fill='040'O
         1 000163   100000 400013                    ADSC9   0,A,PR1                  cn=2,n=*X3
         1 000164   200030 000037                    ADSC9   FILE_ID_WITHIN_DIR,,AUTO cn=0,n=31
         1 000165   000171 710000 1                  TRA     s:3447

      882     3444    3                      PFN_INDEX + 1);
      883     3445    3                 ELSE
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:126  
      884     3446    3                    FILE_ID_WITHIN_DIR = ' ';

   3446  1 000166   040100 100400                    MLR     fill='040'O
         1 000167   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000170   200030 000037                    ADSC9   FILE_ID_WITHIN_DIR,,AUTO cn=0,n=31

      885     3447    4                 DO SELECT (FILE_ID_WITHIN_DIR);

   3447  1 000171   040000 106500                    CMPC    fill='040'O
         1 000172   200030 000037                    ADSC9   FILE_ID_WITHIN_DIR,,AUTO cn=0,n=31
         1 000173   000011 000011 0                  ADSC9   9                        cn=0,n=9
         1 000174   000203 602000 1                  TNC     s:3447+10
         1 000175   000225 600000 1                  TZE     s:3453
         1 000176   040000 106500                    CMPC    fill='040'O
         1 000177   200030 000037                    ADSC9   FILE_ID_WITHIN_DIR,,AUTO cn=0,n=31
         1 000200   000014 000010 0                  ADSC9   12                       cn=0,n=8
         1 000201   000255 601000 1                  TNZ     s:3466
         1 000202   000235 710000 1                  TRA     s:3457
         1 000203   040000 106500                    CMPC    fill='040'O
         1 000204   200030 000037                    ADSC9   FILE_ID_WITHIN_DIR,,AUTO cn=0,n=31
         1 000205   000016 000006 0                  ADSC9   14                       cn=0,n=6
         1 000206   000255 602000 1                  TNC     s:3466
         1 000207   000215 600000 1                  TZE     s:3449
         1 000210   040000 106500                    CMPC    fill='040'O
         1 000211   200030 000037                    ADSC9   FILE_ID_WITHIN_DIR,,AUTO cn=0,n=31
         1 000212   000020 000006 0                  ADSC9   16                       cn=0,n=6
         1 000213   000255 601000 1                  TNZ     s:3466
         1 000214   000245 710000 1                  TRA     s:3461

      886     3448    4                    SELECT (%PFN_NAMES_EQUALS);

      887     3449    4                    IF NOT LOAD_FLAGS.F (%PDFF_EQUALS) THEN

   3449  1 000215   200005 473500                    LDP3    @LOAD_FLAGS,,AUTO
         1 000216   300000 236100                    LDQ     0,,PR3
         1 000217   200000 316003                    CANQ    65536,DU
         1 000220   000222 601000 1                  TNZ     s:3451
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:127  

      888     3450    4                       RETURN; /* Ignore this node */

   3450  1 000221   000000 702200 xent               TSX2  ! X66_ARET

      889     3451    4                    PREDEF_STREAM$ = VD_6E.EQUALS$;

   3451  1 000222   000001 236000 xsym               LDQ     VD_6E+1
         1 000223   200014 756100                    STQ     PREDEF_STREAM$,,AUTO
         1 000224   000335 710000 1                  TRA     s:3521

      890     3452    4                    SELECT (%PFN_NAMES_LOCATIONS);

      891     3453    4                    IF NOT LOAD_FLAGS.F (%PDFF_LOCATIONS) THEN

   3453  1 000225   200005 473500                    LDP3    @LOAD_FLAGS,,AUTO
         1 000226   300000 236100                    LDQ     0,,PR3
         1 000227   040000 316003                    CANQ    16384,DU
         1 000230   000232 601000 1                  TNZ     s:3455

      892     3454    4                       RETURN; /* Ignore this node */

   3454  1 000231   000000 702200 xent               TSX2  ! X66_ARET

      893     3455    4                    PREDEF_STREAM$ = VD_6E.LOCATIONS$;

   3455  1 000232   000002 236000 xsym               LDQ     VD_6E+2
         1 000233   200014 756100                    STQ     PREDEF_STREAM$,,AUTO
         1 000234   000335 710000 1                  TRA     s:3521

      894     3456    4                    SELECT (%PFN_NAMES_SYNONYMS);

      895     3457    4                    IF NOT LOAD_FLAGS.F (%PDFF_SYNONYMS) THEN

   3457  1 000235   200005 473500                    LDP3    @LOAD_FLAGS,,AUTO
         1 000236   300000 236100                    LDQ     0,,PR3
         1 000237   020000 316003                    CANQ    8192,DU
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:128  
         1 000240   000242 601000 1                  TNZ     s:3459

      896     3458    4                       RETURN; /* Ignore this node */

   3458  1 000241   000000 702200 xent               TSX2  ! X66_ARET

      897     3459    4                    PREDEF_STREAM$ = VD_6E.SYNONYMS$;

   3459  1 000242   000003 236000 xsym               LDQ     VD_6E+3
         1 000243   200014 756100                    STQ     PREDEF_STREAM$,,AUTO
         1 000244   000335 710000 1                  TRA     s:3521

      898     3460    4                    SELECT (%PFN_NAMES_KEYINS);

      899     3461    4                    IF NOT LOAD_FLAGS.F (%PDFF_KEYINS) THEN

   3461  1 000245   200005 473500                    LDP3    @LOAD_FLAGS,,AUTO
         1 000246   300000 236100                    LDQ     0,,PR3
         1 000247   100000 316003                    CANQ    32768,DU
         1 000250   000252 601000 1                  TNZ     s:3463

      900     3462    4                       RETURN; /* Ignore this node */

   3462  1 000251   000000 702200 xent               TSX2  ! X66_ARET

      901     3463    4                    PREDEF_STREAM$ = VD_6E.KEYINS$;

   3463  1 000252   000004 236000 xsym               LDQ     VD_6E+4
         1 000253   200014 756100                    STQ     PREDEF_STREAM$,,AUTO
         1 000254   000335 710000 1                  TRA     s:3521

      902     3464    4                    SELECT (ELSE);

      903     3465    4                 ; /* Fall thru with no PREDEF_STREAM$:  try user-def */
      904     3466    4                    END;

   3466  1 000255   000335 710000 1                  TRA     s:3521
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:129  

      905     3467
      906     3468    3              SELECT (%DK_STRUCTURES);

      907     3469    3              IF NOT LOAD_FLAGS.F (%PDFF_STRUCTURES) THEN

   3469  1 000256   200005 473500                    LDP3    @LOAD_FLAGS,,AUTO
         1 000257   300000 236100                    LDQ     0,,PR3
         1 000260   010000 316003                    CANQ    4096,DU
         1 000261   000263 601000 1                  TNZ     s:3479

      908     3470    3                 RETURN; /* Ignore this node */

   3470  1 000262   000000 702200 xent               TSX2  ! X66_ARET

      909     3471                   %GETKEY (KEY=ENCODED_DESC.LOCATION.KEY, INDX="%(LVL_LOWER-1)",
      910     3472                   PTR=TEST_KEY_TEXTC$);

   3479  1 000263   000002 720100                    LXL0    2,,PR0
         1 000264   000002 100003                    CMPX0   2,DU
         1 000265   000272 601000 1                  TNZ     s:3479+7

   3479  1 000266   000003 474500                    LDP4    3,,PR0
         1 000267   400002 635500                    EPPR5   2,,PR4
         1 000270   200041 455500                    STP5    TEST_KEY_TEXTC$,,AUTO
         1 000271   000275 710000 1                  TRA     s:3482

   3479  1 000272   200004 236100                    LDQ     @ENCODED_DESC,,AUTO
         1 000273   000003 036003                    ADLQ    3,DU
         1 000274   200041 756100                    STQ     TEST_KEY_TEXTC$,,AUTO

      911     3482    3              CAND_DIR$ = VD_6E.WS.INTERNAL_DIR$;

   3482  1 000275   000017 236000 xsym               LDQ     VD_6E+15
         1 000276   200042 756100                    STQ     CAND_DIR$,,AUTO

      912     3483    4              DO WHILE CAND_DIR$ ~= ADDR(NIL);
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:130  

   3483  1 000277   000314 710000 1                  TRA     s:3487

      913     3484    4                 IF TEST$KEY_TEXTC.BYTES = CAND$DIR.KEY THEN

   3484  1 000300   200041 470500                    LDP0    TEST_KEY_TEXTC$,,AUTO
         1 000301   000000 236100                    LDQ     0,,PR0
         1 000302   000033 772000                    QRL     27
         1 000303   000000 620006                    EAX0    0,QL
         1 000304   200042 471500                    LDP1    CAND_DIR$,,AUTO
         1 000305   040100 106540                    CMPC    fill='040'O
         1 000306   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         1 000307   100003 000037                    ADSC9   3,,PR1                   cn=0,n=31
         1 000310   000312 601000 1                  TNZ     s:3486

      914     3485    4                    RETURN;  /* Ignore this node */

   3485  1 000311   000000 702200 xent               TSX2  ! X66_ARET

      915     3486    4                 CAND_DIR$ = CAND$DIR.FLINK$;

   3486  1 000312   100002 236100                    LDQ     2,,PR1
         1 000313   200042 756100                    STQ     CAND_DIR$,,AUTO

      916     3487    4                 END;

   3487  1 000314   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000315   000300 601000 1                  TNZ     s:3484

      917     3488    3              OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_STRUCTURES$;

   3488  1 000316   000015 236000 xsym               LDQ     VD_6E+13
         1 000317   200007 756100                    STQ     OPTIONS,,AUTO

      918     3489    3              PREDEF_STREAM$ = VD_6E.STRUCTURES$;

   3489  1 000320   000005 236000 xsym               LDQ     VD_6E+5
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:131  
         1 000321   200014 756100                    STQ     PREDEF_STREAM$,,AUTO
         1 000322   000335 710000 1                  TRA     s:3521

      919     3490
      920     3491    3              SELECT (%DK_WINDOWS);

      921     3492    3              IF NOT LOAD_FLAGS.F (%PDFF_WINDOWS) THEN

   3492  1 000323   200005 473500                    LDP3    @LOAD_FLAGS,,AUTO
         1 000324   300000 236100                    LDQ     0,,PR3
         1 000325   004000 316003                    CANQ    2048,DU
         1 000326   000330 601000 1                  TNZ     s:3494

      922     3493    3                 RETURN;     /* Ignore this node */

   3493  1 000327   000000 702200 xent               TSX2  ! X66_ARET

      923     3494    3              OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_WINDOWS$;

   3494  1 000330   000016 236000 xsym               LDQ     VD_6E+14
         1 000331   200007 756100                    STQ     OPTIONS,,AUTO

      924     3495    3              PREDEF_STREAM$ = VD_6E.WINDOWS$;

   3495  1 000332   000006 236000 xsym               LDQ     VD_6E+6
         1 000333   200014 756100                    STQ     PREDEF_STREAM$,,AUTO
         1 000334   000335 710000 1                  TRA     s:3521

      925     3496
      926     3497    3              SELECT (ELSE);

      927     3498    3              ; /* Fall thru with no PREDEF_STREAM$:  try user-def */
      928     3499    3                 END;

      929     3500    2              END MAY_BE_PREDEF;

      930     3501
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:132  
      931     3502
      932     3503                /*
      933     3504                *  Make copies of the components for Accessor: we want to keep
      934     3505                *     the originals.
      935     3506                */
      936     3507
      937     3508                %COPYSPEC (FSPEC=ENCODED_DESC.SPEC, TSPEC=WRITE_SPEC);

   3521  1 000335   200004 470500                    LDP0    @ENCODED_DESC,,AUTO
         1 000336   000100 100500                    MLR     fill='000'O
         1 000337   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8
         1 000340   200043 000010                    ADSC9   WRITE_SPEC,,AUTO         cn=0,n=8

   3521  1 000341   000014 720100                    LXL0    12,,PR0
         1 000342   000002 100003                    CMPX0   2,DU
         1 000343   000356 601000 1                  TNZ     s:3524

   3521  1 000344   000015 471500                    LDP1    13,,PR0
         1 000345   200044 633500                    EPPR3   WRITE_SPEC+1,,AUTO
         1 000346   200047 453500                    STP3    WRITE_DATA$+2,,AUTO
         1 000347   200046 451500                    STP1    WRITE_DATA$+1,,AUTO
         1 000350   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000351   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000352   000000 701000 xent               TSX1    VDG$OCOPY
         1 000353   000355 702000 1                  TSX2    s:3522
         1 000354   000356 710000 1                  TRA     s:3524

   3522  1 000355   000000 702200 xent               TSX2  ! X66_AALT

      938     3524    1           IF ENCODED_DESC.DATA$ = ADDR(NIL) THEN

   3524  1 000356   200004 470500                    LDP0    @ENCODED_DESC,,AUTO
         1 000357   000016 236100                    LDQ     14,,PR0
         1 000360   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000361   000365 601000 1                  TNZ     s:3527

      939     3525    1              WRITE_DATA$ = ADDR(NIL);
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:133  

   3525  1 000362   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000363   200045 756100                    STQ     WRITE_DATA$,,AUTO
         1 000364   000375 710000 1                  TRA     s:3531

      940     3526    2           ELSE DO;

      941     3527    2              CALL VDG$OCOPY (ENCODED_DESC.DATA$->VD$BUFFER, WRITE_DATA$)

   3527  1 000365   000016 471500                    LDP1    14,,PR0
         1 000366   200045 633500                    EPPR3   WRITE_DATA$,,AUTO
         1 000367   200047 453500                    STP3    WRITE_DATA$+2,,AUTO
         1 000370   200046 451500                    STP1    WRITE_DATA$+1,,AUTO
         1 000371   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000372   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000373   000000 701000 xent               TSX1    VDG$OCOPY
         1 000374   000601 702000 1                  TSX2    FOPEN_FAILED

      942     3528    2                ALTRET (OCOPY_FAILED);
      943     3529    2              END;

      944     3530
      945     3531    2           IF PREDEF_STREAM$ ~= ADDR(NIL) THEN DO;

   3531  1 000375   200014 236100                    LDQ     PREDEF_STREAM$,,AUTO
         1 000376   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000377   000436 600000 1                  TZE     s:3542

      946     3532    2              SAVE_ACCESSOR_PRIV = VD_ACCESSOR_PRIV;

   3532  1 000400   000000 236000 xsym               LDQ     VD_ACCESSOR_PRIV
         1 000401   777000 376003                    ANQ     -512,DU
         1 000402   200006 756100                    STQ     SAVE_ACCESSOR_PRIV,,AUTO

      947     3533    2              VD_ACCESSOR_PRIV = %NAC_ALL_BITS;

   3533  1 000403   777000 236003                    LDQ     -512,DU
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:134  
         1 000404   000000 756000 xsym               STQ     VD_ACCESSOR_PRIV

      948     3534    2              CALL VDA$LWRITE (PREDEF$STREAM, ENCODED_DESC.LOCATION,

   3534  1 000405   200045 236100                    LDQ     WRITE_DATA$,,AUTO
         1 000406   200051 756100                    STQ     WRITE_DATA$+4,,AUTO
         1 000407   200043 630500                    EPPR0   WRITE_SPEC,,AUTO
         1 000410   200050 450500                    STP0    WRITE_DATA$+3,,AUTO
         1 000411   200004 236100                    LDQ     @ENCODED_DESC,,AUTO
         1 000412   000002 036003                    ADLQ    2,DU
         1 000413   200014 235100                    LDA     PREDEF_STREAM$,,AUTO
         1 000414   200046 757100                    STAQ    WRITE_DATA$+1,,AUTO
         1 000415   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000416   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000417   000000 701000 xent               TSX1    VDA$LWRITE
         1 000420   000553 702000 1                  TSX2    PREDEF_LWRITE_FAILED

      949     3535    2                WRITE_SPEC, WRITE$DATA)
      950     3536    2                ALTRET (PREDEF_LWRITE_FAILED);
      951     3537    2              CALL VDA$PFLUSH (PREDEF$STREAM.PORT$->VD$PORT, %TO_PRESENTER)

   3537  1 000421   200014 470500                    LDP0    PREDEF_STREAM$,,AUTO
         1 000422   000001 471500                    LDP1    1,,PR0
         1 000423   000002 236000 2                  LDQ     2
         1 000424   200047 756100                    STQ     WRITE_DATA$+2,,AUTO
         1 000425   200046 451500                    STP1    WRITE_DATA$+1,,AUTO
         1 000426   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000427   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000430   000000 701000 xent               TSX1    VDA$PFLUSH
         1 000431   000576 702000 1                  TSX2    PREDEF_PFLUSH_FAILED

      952     3538    2                ALTRET (PREDEF_PFLUSH_FAILED);
      953     3539    2              VD_ACCESSOR_PRIV = SAVE_ACCESSOR_PRIV;

   3539  1 000432   200006 236100                    LDQ     SAVE_ACCESSOR_PRIV,,AUTO
         1 000433   777000 376003                    ANQ     -512,DU
         1 000434   000000 756000 xsym               STQ     VD_ACCESSOR_PRIV
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:135  

      954     3540    2              END;

   3540  1 000435   000552 710000 1                  TRA     s:3572

      955     3541    2           ELSE DO;

      956     3542    2              IF STREAM.PORT$ ~= ADDR(NIL)

   3542  1 000436   200003 470500                    LDP0    @STREAM,,AUTO
         1 000437   000001 236100                    LDQ     1,,PR0
         1 000440   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000441   000457 600000 1                  TZE     s:3555
         1 000442   000001 471500                    LDP1    1,,PR0
         1 000443   100003 720100                    LXL0    3,,PR1
         1 000444   000457 600000 1                  TZE     s:3555

      957     3543    3                AND STREAM.PORT$->VD$PORT.EXIST# ~= 0 THEN DO;

      958     3544                      %GETKEY (KEY=STREAM.FILE_KEY, PTR=TEST_KEY_TEXTC$);

   3551  1 000445   000004 721100                    LXL1    4,,PR0
         1 000446   000002 101003                    CMPX1   2,DU
         1 000447   000454 601000 1                  TNZ     s:3551+7

   3551  1 000450   000005 473500                    LDP3    5,,PR0
         1 000451   300002 634500                    EPPR4   2,,PR3
         1 000452   200041 454500                    STP4    TEST_KEY_TEXTC$,,AUTO
         1 000453   000457 710000 1                  TRA     s:3555

   3551  1 000454   200003 236100                    LDQ     @STREAM,,AUTO
         1 000455   000005 036003                    ADLQ    5,DU
         1 000456   200041 756100                    STQ     TEST_KEY_TEXTC$,,AUTO

      959     3554    3                 END;

      960     3555    2              FILE_KEY_TEXTC$ = ADDR(FILE$KEY.LENGTH#);
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:136  

   3555  1 000457   200004 471500                    LDP1    @ENCODED_DESC,,AUTO
         1 000460   100001 473500                    LDP3    1,,PR1
         1 000461   300002 634500                    EPPR4   2,,PR3
         1 000462   200040 454500                    STP4    FILE_KEY_TEXTC$,,AUTO

      961     3556    2              IF STREAM.PORT$ = ADDR(NIL)

   3556  1 000463   000001 236100                    LDQ     1,,PR0
         1 000464   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000465   000504 600000 1                  TZE     s:3559
         1 000466   000001 475500                    LDP5    1,,PR0
         1 000467   500003 720100                    LXL0    3,,PR5
         1 000470   000504 600000 1                  TZE     s:3559
         1 000471   200041 476500                    LDP6    TEST_KEY_TEXTC$,,AUTO
         1 000472   600000 236100                    LDQ     0,,PR6
         1 000473   000033 772000                    QRL     27
         1 000474   000000 621006                    EAX1    0,QL
         1 000475   400000 236100                    LDQ     0,,PR4
         1 000476   000033 772000                    QRL     27
         1 000477   000000 622006                    EAX2    0,QL
         1 000500   040140 106540                    CMPC    fill='040'O
         1 000501   600000 200011                    ADSC9   0,,PR6                   cn=1,n=*X1
         1 000502   400000 200012                    ADSC9   0,,PR4                   cn=1,n=*X2
         1 000503   000525 600000 1                  TZE     s:3565

      962     3557    2                OR STREAM.PORT$->VD$PORT.EXIST# = 0
      963     3558    3                OR TEST$KEY_TEXTC.BYTES ~= FILE$KEY_TEXTC.BYTES THEN DO;

      964     3559    3                 OPTIONS.STRUCTURE$ = VD_6E.STRUCTURE_EXTERNAL$;

   3559  1 000504   000010 236000 xsym               LDQ     VD_6E+8
         1 000505   200007 756100                    STQ     OPTIONS,,AUTO

      965     3560    3                 OPTIONS.PROTECT# = %DONT_PROTECT;

   3560  1 000506   000002 220003                    LDX0    2,DU
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:137  
         1 000507   200011 740100                    STX0    OPTIONS+2,,AUTO

      966     3561    3                 OPTIONS.EXIST# = %EX_ANY;

   3561  1 000510   000003 221003                    LDX1    3,DU
         1 000511   200011 441100                    SXL1    OPTIONS+2,,AUTO

      967     3562    3                 CALL VDA$FOPEN (STREAM, ENCODED_DESC.FILE_KEY, 0, OPTIONS)

   3562  1 000512   200007 633500                    EPPR3   OPTIONS,,AUTO
         1 000513   200051 453500                    STP3    WRITE_DATA$+4,,AUTO
         1 000514   000002 236000 2                  LDQ     2
         1 000515   200050 756100                    STQ     WRITE_DATA$+3,,AUTO
         1 000516   200004 236100                    LDQ     @ENCODED_DESC,,AUTO
         1 000517   200003 235100                    LDA     @STREAM,,AUTO
         1 000520   200046 757100                    STAQ    WRITE_DATA$+1,,AUTO
         1 000521   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000522   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000523   000000 701000 xent               TSX1    VDA$FOPEN
         1 000524   000601 702000 1                  TSX2    FOPEN_FAILED

      968     3563    3                   ALTRET (FOPEN_FAILED);
      969     3564    3                 END;

      970     3565    2              CALL VDA$LWRITE (STREAM, ENCODED_DESC.LOCATION,

   3565  1 000525   200045 236100                    LDQ     WRITE_DATA$,,AUTO
         1 000526   200051 756100                    STQ     WRITE_DATA$+4,,AUTO
         1 000527   200043 630500                    EPPR0   WRITE_SPEC,,AUTO
         1 000530   200050 450500                    STP0    WRITE_DATA$+3,,AUTO
         1 000531   200004 236100                    LDQ     @ENCODED_DESC,,AUTO
         1 000532   000002 036003                    ADLQ    2,DU
         1 000533   200003 235100                    LDA     @STREAM,,AUTO
         1 000534   200046 757100                    STAQ    WRITE_DATA$+1,,AUTO
         1 000535   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000536   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000537   000000 701000 xent               TSX1    VDA$LWRITE
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:138  
         1 000540   000556 702000 1                  TSX2    USERDEF_LWRITE_FAILED

      971     3566    2                WRITE_SPEC, WRITE$DATA)
      972     3567    2                ALTRET (USERDEF_LWRITE_FAILED);
      973     3568    2              CALL VDA$PFLUSH (STREAM.PORT$->VD$PORT, %TO_PRESENTER)

   3568  1 000541   200003 470500                    LDP0    @STREAM,,AUTO
         1 000542   000001 471500                    LDP1    1,,PR0
         1 000543   000002 236000 2                  LDQ     2
         1 000544   200047 756100                    STQ     WRITE_DATA$+2,,AUTO
         1 000545   200046 451500                    STP1    WRITE_DATA$+1,,AUTO
         1 000546   200046 630500                    EPPR0   WRITE_DATA$+1,,AUTO
         1 000547   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000550   000000 701000 xent               TSX1    VDA$PFLUSH
         1 000551   000601 702000 1                  TSX2    FOPEN_FAILED

      974     3569    2                ALTRET (USERDEF_PFLUSH_FAILED);
      975     3570    2              END;

      976     3571
      977     3572    1           RETURN;

   3572  1 000552   000000 702200 xent               TSX2  ! X66_ARET

   3565  1 000553                       PREDEF_LWRI* null
      978     3573
      979     3574
      980     3575
      981     3576    1   PREDEF_LWRITE_FAILED: ;
      982     3577    1           VD_ACCESSOR_PRIV = SAVE_ACCESSOR_PRIV;

   3577  1 000553   200006 236100                    LDQ     SAVE_ACCESSOR_PRIV,,AUTO
         1 000554   777000 376003                    ANQ     -512,DU
         1 000555   000000 756000 xsym               STQ     VD_ACCESSOR_PRIV

   3577  1 000556                       USERDEF_LWR* null
      983     3578    1   USERDEF_LWRITE_FAILED: ;
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:139  
      984     3579                %CLEARSPEC (SPEC=WRITE_SPEC);

   3586  1 000556   200043 720100                    LXL0    WRITE_SPEC,,AUTO
         1 000557   000002 100003                    CMPX0   2,DU
         1 000560   000567 601000 1                  TNZ     s:3587+1

   3586  1 000561   200044 630500                    EPPR0   WRITE_SPEC+1,,AUTO
         1 000562   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000563   000000 701000 xent               TSX1    VDG$OFREE
         1 000564   000566 702000 1                  TSX2    s:3587
         1 000565   000567 710000 1                  TRA     s:3587+1

   3587  1 000566   000000 702200 xent               TSX2  ! X66_AALT

   3587  1 000567   200043 450100                    STZ     WRITE_SPEC,,AUTO
         1 000570   200044 450100                    STZ     WRITE_SPEC+1,,AUTO

      985     3589    1           CALL VDG$OFREE (WRITE$DATA)

   3589  1 000571   200045 630500                    EPPR0   WRITE_DATA$,,AUTO
         1 000572   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000573   000000 701000 xent               TSX1    VDG$OFREE
         1 000574   000601 702000 1                  TSX2    FOPEN_FAILED

      986     3590    1             ALTRET (OFREE_FAILED);
      987     3591    1           ALTRETURN;

   3591  1 000575   000000 702200 xent               TSX2  ! X66_AALT

   3587  1 000576                       PREDEF_PFLU* null
      988     3592    1   PREDEF_PFLUSH_FAILED: ;
      989     3593    1           VD_ACCESSOR_PRIV = SAVE_ACCESSOR_PRIV;

   3593  1 000576   200006 236100                    LDQ     SAVE_ACCESSOR_PRIV,,AUTO
         1 000577   777000 376003                    ANQ     -512,DU
         1 000600   000000 756000 xsym               STQ     VD_ACCESSOR_PRIV

PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:140  
   3593  1 000601                       FOPEN_FAILED null
   3593  1 000601                       USERDEF_PFL* null
   3593  1 000601                       OCOPY_FAILED null
   3593  1 000601                       OFREE_FAILED null
      990     3594    1   FOPEN_FAILED: ;
      991     3595    1   USERDEF_PFLUSH_FAILED: ;
      992     3596    1   OCOPY_FAILED: ;
      993     3597    1   OFREE_FAILED: ;
      994     3598    1           ALTRETURN;

   3598  1 000601   000000 702200 xent               TSX2  ! X66_AALT
      995     3599
      996     3600    1   END VDW$RESTORE_NODE;
      997     3601        %EOD;

PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:141  
--  Include file information  --

   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure VDW$RESTORE_NODE.
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:142  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ENCODED_DESC              5-0-0/w PTR         r     1 @LOAD_FLAGS
     3-0-0/w PTR         r     1 @STREAM                   42-0-0/w PTR         r     1 CAND_DIR$
    20-0-0/c CHAR(31)    r     1 DIR_KEY                   *0-0-0/w STRC(540)   r     1 ENCODED_DESC
    30-0-0/c CHAR(31)    r     1 FILE_ID_WITHIN_DIR        15-0-0/w PTR         r     1 FILE_KEY_NAME$
    40-0-0/w PTR         r     1 FILE_KEY_TEXTC$           16-0-0/c CHAR        r     1 FILE_STCLASS
    *0-0-0/w STRC(9)     r     1 LOAD_FLAGS                 7-0-0/w STRC(180)   r     1 OPTIONS
    17-0-0/w SBIN        r     1 PFN_INDEX                 14-0-0/w PTR         r     1 PREDEF_STREAM$
     6-0-0/w STRC(9)     r     1 SAVE_ACCESSOR_PRIV        *0-0-0/w STRC(864)   r     1 STREAM
    41-0-0/w PTR         r     1 TEST_KEY_TEXTC$           45-0-0/w PTR         r     1 WRITE_DATA$
    43-0-0/w STRC(72)    r     1 WRITE_SPEC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(22644) r     1 VD_6E                      0-0-0/w STRC(9)     r     1 VD_ACCESSOR_PRIV

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 CAND$DIR                   0-0-0/w STRC(648)   r     1 FILE$KEY
     0-0-0/c ASTR(9)     r     1 FILE$KEY_NAME              0-0-0/w ASTR(9)     r     1 FILE$KEY_TEXTC
     0-0-0/w STRC(864)   r     1 PREDEF$STREAM              0-0-0/w ASTR(9)     r     1 TEST$KEY_TEXTC
     0-0-0/w ASTR(90)    r     1 VD$BUFFER                  0-0-0/w STRC(1944)  r     1 VD$PORT
     0-0-0/w ASTR(81)    r     1 VD$TEXTC_REMOTE            0-0-0/w ASTR(90)    r     1 WRITE$DATA

PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:143  

   Procedure VDW$RESTORE_NODE requires 386 words for executable code.
   Procedure VDW$RESTORE_NODE requires 42 words of local(AUTO) storage.
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:144  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:145  
          MINI XREF LISTING

CAND$DIR.FLINK$
      3005**DCL      3486>>ASSIGN
CAND$DIR.KEY
      3005**DCL      3484>>IF
CAND_DIR$
      2727**DCL      2979--IMP-PTR  3482<<ASSIGN   3483>>DOWHILE  3484>>IF       3486<<ASSIGN   3486>>ASSIGN
DIR_KEY
      2723**DCL      3425<<ASSIGN   3429>>DOSELCT
ENCODED_DESC
      2414**DCL        38--PROC
ENCODED_DESC.DATA$
      2488**DCL      3439>>IF       3524>>IF       3527>>CALL     3527>>CALL
ENCODED_DESC.FILE_KEY
      2428**DCL      3562<>CALL
ENCODED_DESC.FILE_KEY.REP#
      2430**DCL      3412>>IF       3413<>CALL
ENCODED_DESC.FILE_KEY.V$
      2430**DCL      2868--IMP-PTR  3414>>ASSIGN   3416>>IF       3416>>IF       3442>>IF       3555>>ASSIGN
ENCODED_DESC.LOCATION
      2442**DCL      3534<>CALL     3565<>CALL
ENCODED_DESC.LOCATION.KEY.REP#
      2456**DCL      3479>>IF
ENCODED_DESC.LOCATION.KEY.V$
      2456**DCL      3479>>ASSIGN   3479--ASSIGN
ENCODED_DESC.SPEC
      2484**DCL      3521>>ASSIGN
ENCODED_DESC.SPEC.REP#
      2486**DCL      3521>>IF
ENCODED_DESC.SPEC.V$
      2486**DCL      3521>>CALL     3521>>CALL
FILE$KEY.LENGTH#
      2895**DCL      3442>>IF       3555--ASSIGN
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:146  
FILE$KEY.PSN
      2898**DCL      3416>>IF
FILE$KEY.UNIQUE.ACCT
      2896**DCL      3416>>IF
FILE$KEY.UNIQUE.FNAME
      2896**DCL      3414--ASSIGN
FILE$KEY_NAME.BYTES
      2966**DCL      3415>>ASSIGN   3416>>IF       3423>>CALLBLT  3425>>ASSIGN   3443>>ASSIGN
FILE$KEY_NAME.LENGTH#
      2964**DCL      2966--IMP-SIZ  3415>>ASSIGN   3416>>IF       3416>>IF       3423>>CALLBLT  3425>>ASSIGN
      3443>>ASSIGN
FILE$KEY_TEXTC.BYTES
      2919**DCL      3556>>IF
FILE$KEY_TEXTC.LENGTH#
      2917**DCL      2919--IMP-SIZ  3556>>IF
FILE_ID_WITHIN_DIR
      2724**DCL      3443<<ASSIGN   3446<<ASSIGN   3447>>DOSELCT
FILE_KEY_NAME$
      2720**DCL      2956--IMP-PTR  3414<<ASSIGN   3415>>ASSIGN   3415>>ASSIGN   3416>>IF       3416>>IF
      3416>>IF       3423>>CALLBLT  3423>>CALLBLT  3425>>ASSIGN   3425>>ASSIGN   3443>>ASSIGN   3443>>ASSIGN
FILE_KEY_TEXTC$
      2725**DCL      2909--IMP-PTR  3555<<ASSIGN   3556>>IF       3556>>IF
FILE_STCLASS
      2721**DCL      3415<<ASSIGN   3416>>IF       3416--IF
FOPEN_FAILED
      3593**LABEL    3562--CALLALT
LOAD_FLAGS
      2596**DCL        38--PROC
LOAD_FLAGS.F
      2608**DCL      3449>>IF       3453>>IF       3457>>IF       3461>>IF       3469>>IF       3492>>IF
OCOPY_FAILED
      3593**LABEL    3527--CALLALT
OFREE_FAILED
      3593**LABEL    3589--CALLALT
OPTIONS
      2698**DCL      3401<<ASSIGN   3562<>CALL
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:147  
OPTIONS.EXIST#
      2703**DCL      3561<<ASSIGN
OPTIONS.PROTECT#
      2702**DCL      3560<<ASSIGN
OPTIONS.STRUCTURE$
      2702**DCL      3441<<ASSIGN   3488<<ASSIGN   3494<<ASSIGN   3559<<ASSIGN
PFN_INDEX
      2722**DCL      3423<<CALLBLT  3425>>ASSIGN   3442>>IF       3443>>ASSIGN
PREDEF$STREAM
      2753**DCL      3534<>CALL
PREDEF$STREAM.PORT$
      2779**DCL      3537>>CALL
PREDEF_LWRITE_FAILED
      3565**LABEL    3534--CALLALT
PREDEF_PFLUSH_FAILED
      3587**LABEL    3537--CALLALT
PREDEF_STREAM$
      2719**DCL      2753--IMP-PTR  3411<<ASSIGN   3451<<ASSIGN   3455<<ASSIGN   3459<<ASSIGN   3463<<ASSIGN
      3489<<ASSIGN   3495<<ASSIGN   3531>>IF       3534>>CALL     3537>>CALL
SAVE_ACCESSOR_PRIV
      2675**DCL      3532<<ASSIGN   3539>>ASSIGN   3577>>ASSIGN   3593>>ASSIGN
STREAM
      2498**DCL        38--PROC     3562<>CALL     3565<>CALL
STREAM.FILE_KEY.REP#
      2537**DCL      3551>>IF
STREAM.FILE_KEY.V$
      2537**DCL      3551>>ASSIGN   3551--ASSIGN
STREAM.PORT$
      2524**DCL      3542>>IF       3542>>IF       3556>>IF       3556>>IF       3568>>CALL
TEST$KEY_TEXTC.BYTES
      2942**DCL      3484>>IF       3556>>IF
TEST$KEY_TEXTC.LENGTH#
      2940**DCL      2942--IMP-SIZ  3484>>IF       3556>>IF
TEST_KEY_TEXTC$
      2726**DCL      2932--IMP-PTR  3479<<ASSIGN   3479<<ASSIGN   3484>>IF       3484>>IF       3551<<ASSIGN
      3551<<ASSIGN   3556>>IF       3556>>IF
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:148  
USERDEF_LWRITE_FAILED
      3577**LABEL    3565--CALLALT
USERDEF_PFLUSH_FAILED
      3593**LABEL    3568--CALLALT
VD$BUFFER
      3365**DCL      3527<>CALL
VD$BUFFER.LENGTH#
      3391**DCL      3393--IMP-SIZ  3527>>CALL
VD$PORT
      3250**DCL      3537<>CALL     3568<>CALL
VD$PORT.EXIST#
      3276**DCL      3542>>IF       3556>>IF
VD$TEXTC_REMOTE
      3092**DCL      3521<>CALL     3586<>CALL
VD$TEXTC_REMOTE.LENGTH#
      3121**DCL      3123--IMP-SIZ  3479--ASSIGN   3521>>CALL     3551--ASSIGN   3586>>CALL
VDA$FOPEN
      2614**DCL-ENT  3562--CALL
VDA$LWRITE
      2615**DCL-ENT  3534--CALL     3565--CALL
VDA$PFLUSH
      2616**DCL-ENT  3537--CALL     3568--CALL
VDG$ESCREECH
      2619**DCL-ENT  3413--CALL
VDG$OCOPY
      2617**DCL-ENT  3521--CALL     3527--CALL
VDG$OFREE
      2618**DCL-ENT  3586--CALL     3589--CALL
VD_6E.EQUALS$
      2635**DCL      3451>>ASSIGN
VD_6E.KEYINS$
      2635**DCL      3463>>ASSIGN
VD_6E.LOCATIONS$
      2635**DCL      3455>>ASSIGN
VD_6E.STRUCTURES$
      2635**DCL      3489>>ASSIGN
PL6.E3A0      #002=VDW$RESTORE_NODE File=VDW$WORKSPACE.:VDA5TSI                  FRI 07/04/97 11:42 Page:149  
VD_6E.STRUCTURE_EXTERNAL$
      2636**DCL      3559>>ASSIGN
VD_6E.STRUCTURE_NAMES$
      2636**DCL      3441>>ASSIGN
VD_6E.STRUCTURE_STRUCTURES$
      2638**DCL      3488>>ASSIGN
VD_6E.STRUCTURE_WINDOWS$
      2638**DCL      3494>>ASSIGN
VD_6E.SYNONYMS$
      2635**DCL      3459>>ASSIGN
VD_6E.WINDOWS$
      2636**DCL      3495>>ASSIGN
VD_6E.WS.INTERNAL_DIR$
      2638**DCL      3482>>ASSIGN
VD_ACCESSOR_PRIV
      2658**DCL      3532>>ASSIGN   3533<<ASSIGN   3539<<ASSIGN   3577<<ASSIGN   3593<<ASSIGN
WRITE$DATA
      3034**DCL      3534<>CALL     3565<>CALL     3589<>CALL
WRITE$DATA.LENGTH#
      3060**DCL      3062--IMP-SIZ  3534>>CALL     3565>>CALL     3589>>CALL
WRITE_DATA$
      2742**DCL      3034--IMP-PTR  3525<<ASSIGN   3527<>CALL     3534>>CALL     3534>>CALL     3565>>CALL
      3565>>CALL     3589>>CALL     3589>>CALL
WRITE_SPEC
      2736**DCL      3521<<ASSIGN   3534<>CALL     3565<>CALL     3587<<ASSIGN
WRITE_SPEC.REP#
      2740**DCL      3586>>IF
WRITE_SPEC.V$
      2740**DCL      3521<>CALL     3586>>CALL     3586>>CALL

PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:150  
      998        1        /*T***********************************************************/
      999        2        /*T*                                                         */
     1000        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1001        4        /*T*                                                         */
     1002        5        /*T***********************************************************/
     1003        6        /*D* NAME: VDW$SAVE
     1004        7            PARAMETERS:
     1005        8                SAVE_FILE_DCB - UBIN HALF HALIGNED containing the DCB# of the
     1006        9                    SAVE-file to write to.  This DCB must be open and positioned to
     1007       10                    write the next record.
     1008       11                SAVE_FILE_RECORD_NUMBER must contain the number of the next record
     1009       12                    to be written to the SAVE-file (the first record is # 0).
     1010       13                STREAM - VD$STREAM for the predefined file which we are to encode and
     1011       14                    write to the SAVE-file.  STREAM must be open, and must be one of
     1012       15                    the VD_6E.EQUALS$, .LOCATIONS$, etc. stream pointers.
     1013       16            INPUT:
     1014       17            OUTPUT:
     1015       18                SAVE_FILE_RECORD_NUMBER will be incremented for each record written
     1016       19                    to the SAVE-file.
     1017       20            DESCRIPTION:
     1018       21                The Structures and Windows predefined files are always memory-resident;
     1019       22                    therefore its fastest to scan these by simply walking their
     1020       23                    file-node trees.
     1021       24        *N**N*  However, the Names-files (Equals, Keyins, Locations, and Synonyms) may
     1022       25        *N**N*      be memory- or disk-resident; therefore use the Accessor to read
     1023       26        *N**N*      the nodes of these files.
     1024       27                Either way, walk the file, hitting each node in the file.  Call
     1025       28                    VDW$STOW_NODE for each node to encode it and write it to the
     1026       29                    SAVE-file.
     1027       30        */
     1028       31
     1029       32        VDW$SAVE: PROC (SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER, STREAM) ALTRET;
     1030       33
     1031       34        %INCLUDE VD_MACROS_M;
     1032     2249        %INCLUDE VD_PERR_C;
     1033     2397
     1034     2398
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:151  
     1035     2399    1   DCL SAVE_FILE_DCB UBIN HALF HALIGNED;
     1036     2400    1   DCL SAVE_FILE_RECORD_NUMBER SBIN;
     1037     2401        %VD$STREAM (NAME=STREAM, STCLASS=PARAM);
     1038     2507
     1039     2508
     1040     2509        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
     1041     2545
     1042     2546
     1043     2547    1   DCL VDG$ESCREECH            ENTRY (3);
     1044     2548    1   DCL VDA$LREAD               ENTRY (4) ALTRET;
     1045     2549    1   DCL VDG$OALLOC              ENTRY (3) ALTRET;
     1046     2550    1   DCL VDG$OCOPY               ENTRY (2) ALTRET;
     1047     2551    1   DCL VDG$OCOPY_RANGE         ENTRY (2) ALTRET;
     1048     2552    1   DCL VDG$OFREE               ENTRY (1) ALTRET;
     1049     2553    1   DCL VDG$OCLEAR_RANGE        ENTRY (1) ALTRET;
     1050     2554    1   DCL VDW$STOW_NODE           ENTRY (5) ALTRET;
     1051     2555
     1052     2556
     1053     2557        %VD$LOCATION (NAME=LREAD_LOCATION, STCLASS=AUTO);
     1054     2585        %VD$LOCATION (NAME=STOW_NODE_LOCATION, STCLASS=AUTO);
     1055     2613    1   DCL L0_NODE$ PTR;
     1056     2614    1   DCL L1_NODE$ PTR;
     1057     2615    1   DCL L2_NODE$ PTR;
     1058     2616    1   DCL LOCATION$ PTR;
     1059     2617    1   DCL RELATIVE SBIN;
     1060     2618    1   DCL VD_ERR$ PTR;
     1061     2619
     1062     2620
     1063     2621        %VD$BUFFER;
     1064     2679        %VD$ERR (NAME=VD$ERR, STCLASS="BASED(VD_ERR$)");
     1065     2732        %VD$FILE_NODE;
     1066     2825        %VD$FILE_NODE (NAME=L0$NODE, STCLASS="BASED(L0_NODE$)");
     1067     2918        %VD$FILE_NODE (NAME=L1$NODE, STCLASS="BASED(L1_NODE$)");
     1068     3011        %VD$FILE_NODE (NAME=L2$NODE, STCLASS="BASED(L2_NODE$)");
     1069     3104        %VD$LOCATION;
     1070     3132        %VD$NAME_SPEC;
     1071     3180        %VD$PORT;
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:152  
     1072     3278        %VD$TEXTC_REMOTE;
     1073     3339        %VD$WINDOW_SPEC;
     1074     3405
     1075     3406
     1076     3407    1           IF ADDR(STREAM) = VD_6E.STRUCTURES$
     1077     3408    1             OR ADDR(STREAM) = VD_6E.WINDOWS$
     1078     3409    1           THEN
     1079     3410    1   MULTI_LEVEL_INTERNAL_FILE:
     1080     3411    2           DO;
     1081     3412    2              STOW_NODE_LOCATION = %CLEAR;
     1082     3413    2              L0_NODE$ = STREAM.PORT$->VD$PORT.LEVEL.INTERNAL$ (%LVL_FILE);
     1083     3414    2              L1_NODE$ = L0$NODE.HEAD$;
     1084     3415    3              DO WHILE L1_NODE$ ~= ADDR(NIL);
     1085     3416    3                 STOW_NODE_LOCATION.KEY (%LVL_LOWER-1) = L1$NODE.DESC.KEY;
     1086     3417    3                 STOW_NODE_LOCATION.KEY (%LVL_LOWER) = %CLEAR;
     1087     3418    3                 CALL VDW$STOW_NODE (STREAM.FILE_KEY, STOW_NODE_LOCATION,
     1088     3419    3                   L1$NODE, SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER)
     1089     3420    3                   ALTRET (STOW_NODE_FAILED);
     1090     3421    3                 L2_NODE$ = L1$NODE.HEAD$;
     1091     3422    4                 DO WHILE L2_NODE$ ~= ADDR(NIL);
     1092     3423    4                    STOW_NODE_LOCATION.KEY (%LVL_LOWER) = L2$NODE.DESC.KEY;
     1093     3424    4                    CALL VDW$STOW_NODE (STREAM.FILE_KEY, STOW_NODE_LOCATION,
     1094     3425    4                      L2$NODE, SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER)
     1095     3426    4                      ALTRET (STOW_NODE_FAILED);
     1096     3427    4                    L2_NODE$ = L2$NODE.FLINK$;
     1097     3428    4                    END;
     1098     3429    3                 L1_NODE$ = L1$NODE.FLINK$;
     1099     3430    3                 END;
     1100     3431    2              END MULTI_LEVEL_INTERNAL_FILE;
     1101     3432    1           ELSE
     1102     3433    1   SINGLE_LEVEL_INTERNAL_FILE:
     1103     3434    2           DO;
     1104     3435    2              LREAD_LOCATION = %CLEAR;
     1105     3436    2              LOCATION$ = ADDR(LREAD_LOCATION);
     1106     3437    2              RELATIVE = 0;
     1107     3438
     1108     3439    2   EACH_INTERNAL_FILE_RECORD:
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:153  
     1109     3440    3              DO UNTIL (STREAM.CURRENT.EOF = %TRUE);
     1110     3441    3                 CALL VDA$LREAD (STREAM, LOCATION$->VD$LOCATION, RELATIVE, %TRUE)
     1111     3442    3                   ALTRET (LREAD_FAILED);
     1112     3443    3                 IF STREAM.CURRENT.EOF = %TRUE THEN
     1113     3444    3                    EXIT EACH_INTERNAL_FILE_RECORD;
     1114     3445
     1115     3446    3                 CALL VDW$STOW_NODE (STREAM.FILE_KEY, STREAM.CURRENT,
     1116     3447    3                   STREAM.PORT$->VD$PORT.LEVEL.INTERNAL$ (%LVL_LOWER)->VD$FILE_NODE,
     1117     3448    3                   SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER)
     1118     3449    3                   ALTRET (STOW_NODE_FAILED);
     1119     3450
     1120     3451    3                 LOCATION$ = ADDR(NIL);
     1121     3452    3                 RELATIVE = 1;
     1122     3453    3                 END EACH_INTERNAL_FILE_RECORD;
     1123     3454
     1124     3455    2              END SINGLE_LEVEL_INTERNAL_FILE;
     1125     3456
     1126     3457    1           RETURN;
     1127     3458
     1128     3459    1   FOPEN_FAILED: ;
     1129     3460    1   LDELETE_FAILED: ;
     1130     3461    1   LREAD_FAILED: ;
     1131     3462    1   STOW_NODE_FAILED: ;
     1132     3463    1           ALTRETURN;
     1133     3464
     1134     3465
     1135     3466    1   END VDW$SAVE;
     1136     3467        %EOD;

PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:154  
--  Include file information  --

   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure VDW$SAVE.

   Procedure VDW$SAVE requires 119 words for executable code.
   Procedure VDW$SAVE requires 36 words of local(AUTO) storage.

PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:155  

 Object Unit name= VDW$SAVE                                   File name= VDW$WORKSPACE.:VDA5TOU
 UTS= JUL 04 '97 11:42:39.20 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   119    167  VDW$SAVE
    1  RoData even  none     1      1  VDW$SAVE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        3  VDW$SAVE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       5 VDW$STOW_NODE
 yes     yes           Std       4 VDA$LREAD
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     VD_6E                                 B_VECTNIL
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:156  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:157  


      998        1        /*T***********************************************************/
      999        2        /*T*                                                         */
     1000        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1001        4        /*T*                                                         */
     1002        5        /*T***********************************************************/
     1003        6        /*D* NAME: VDW$SAVE
     1004        7            PARAMETERS:
     1005        8                SAVE_FILE_DCB - UBIN HALF HALIGNED containing the DCB# of the
     1006        9                    SAVE-file to write to.  This DCB must be open and positioned to
     1007       10                    write the next record.
     1008       11                SAVE_FILE_RECORD_NUMBER must contain the number of the next record
     1009       12                    to be written to the SAVE-file (the first record is # 0).
     1010       13                STREAM - VD$STREAM for the predefined file which we are to encode and
     1011       14                    write to the SAVE-file.  STREAM must be open, and must be one of
     1012       15                    the VD_6E.EQUALS$, .LOCATIONS$, etc. stream pointers.
     1013       16            INPUT:
     1014       17            OUTPUT:
     1015       18                SAVE_FILE_RECORD_NUMBER will be incremented for each record written
     1016       19                    to the SAVE-file.
     1017       20            DESCRIPTION:
     1018       21                The Structures and Windows predefined files are always memory-resident;
     1019       22                    therefore its fastest to scan these by simply walking their
     1020       23                    file-node trees.
     1021       24        *N**N*  However, the Names-files (Equals, Keyins, Locations, and Synonyms) may
     1022       25        *N**N*      be memory- or disk-resident; therefore use the Accessor to read
     1023       26        *N**N*      the nodes of these files.
     1024       27                Either way, walk the file, hitting each node in the file.  Call
     1025       28                    VDW$STOW_NODE for each node to encode it and write it to the
     1026       29                    SAVE-file.
     1027       30        */
     1028       31
     1029       32        VDW$SAVE: PROC (SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER, STREAM) ALTRET;

     32  0 000000   000000 700200 xent  VDW$SAVE     TSX0  ! X66_AUTO_3
         0 000001   000044 000003                    ZERO    36,3

PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:158  
     1030       33
     1031       34        %INCLUDE VD_MACROS_M;
     1032     2249        %INCLUDE VD_PERR_C;
     1033     2397
     1034     2398
     1035     2399    1   DCL SAVE_FILE_DCB UBIN HALF HALIGNED;
     1036     2400    1   DCL SAVE_FILE_RECORD_NUMBER SBIN;
     1037     2401        %VD$STREAM (NAME=STREAM, STCLASS=PARAM);
     1038     2507
     1039     2508
     1040     2509        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
     1041     2545
     1042     2546
     1043     2547    1   DCL VDG$ESCREECH            ENTRY (3);
     1044     2548    1   DCL VDA$LREAD               ENTRY (4) ALTRET;
     1045     2549    1   DCL VDG$OALLOC              ENTRY (3) ALTRET;
     1046     2550    1   DCL VDG$OCOPY               ENTRY (2) ALTRET;
     1047     2551    1   DCL VDG$OCOPY_RANGE         ENTRY (2) ALTRET;
     1048     2552    1   DCL VDG$OFREE               ENTRY (1) ALTRET;
     1049     2553    1   DCL VDG$OCLEAR_RANGE        ENTRY (1) ALTRET;
     1050     2554    1   DCL VDW$STOW_NODE           ENTRY (5) ALTRET;
     1051     2555
     1052     2556
     1053     2557        %VD$LOCATION (NAME=LREAD_LOCATION, STCLASS=AUTO);
     1054     2585        %VD$LOCATION (NAME=STOW_NODE_LOCATION, STCLASS=AUTO);
     1055     2613    1   DCL L0_NODE$ PTR;
     1056     2614    1   DCL L1_NODE$ PTR;
     1057     2615    1   DCL L2_NODE$ PTR;
     1058     2616    1   DCL LOCATION$ PTR;
     1059     2617    1   DCL RELATIVE SBIN;
     1060     2618    1   DCL VD_ERR$ PTR;
     1061     2619
     1062     2620
     1063     2621        %VD$BUFFER;
     1064     2679        %VD$ERR (NAME=VD$ERR, STCLASS="BASED(VD_ERR$)");
     1065     2732        %VD$FILE_NODE;
     1066     2825        %VD$FILE_NODE (NAME=L0$NODE, STCLASS="BASED(L0_NODE$)");
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:159  
     1067     2918        %VD$FILE_NODE (NAME=L1$NODE, STCLASS="BASED(L1_NODE$)");
     1068     3011        %VD$FILE_NODE (NAME=L2$NODE, STCLASS="BASED(L2_NODE$)");
     1069     3104        %VD$LOCATION;
     1070     3132        %VD$NAME_SPEC;
     1071     3180        %VD$PORT;
     1072     3278        %VD$TEXTC_REMOTE;
     1073     3339        %VD$WINDOW_SPEC;
     1074     3405
     1075     3406
     1076     3407    1           IF ADDR(STREAM) = VD_6E.STRUCTURES$

   3407  0 000002   200005 236100                    LDQ     @STREAM,,AUTO
         0 000003   000005 116000 xsym               CMPQ    VD_6E+5
         0 000004   000007 600000 0                  TZE     MULTI_LEVEL_INTERNAL_FILE
         0 000005   000006 116000 xsym               CMPQ    VD_6E+6
         0 000006   000107 601000 0                  TNZ     SINGLE_LEVEL_INTERNAL_FILE

     1077     3408    1             OR ADDR(STREAM) = VD_6E.WINDOWS$
     1078     3409    1           THEN
     1079     3410    1   MULTI_LEVEL_INTERNAL_FILE:
     1080     3411    2           DO;

   3411  0 000007                       MULTI_LEVEL* null
     1081     3412    2              STOW_NODE_LOCATION = %CLEAR;

   3412  0 000007   000100 100400                    MLR     fill='000'O
         0 000010   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         0 000011   200017 000044                    ADSC9   STOW_NODE_LOCATION,,AUTO cn=0,n=36

     1082     3413    2              L0_NODE$ = STREAM.PORT$->VD$PORT.LEVEL.INTERNAL$ (%LVL_FILE);

   3413  0 000012   200005 470500                    LDP0    @STREAM,,AUTO
         0 000013   000001 471500                    LDP1    1,,PR0
         0 000014   100031 236100                    LDQ     25,,PR1
         0 000015   200030 756100                    STQ     L0_NODE$,,AUTO

     1083     3414    2              L1_NODE$ = L0$NODE.HEAD$;
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:160  

   3414  0 000016   200030 473500                    LDP3    L0_NODE$,,AUTO
         0 000017   300012 236100                    LDQ     10,,PR3
         0 000020   200031 756100                    STQ     L1_NODE$,,AUTO

     1084     3415    3              DO WHILE L1_NODE$ ~= ADDR(NIL);

   3415  0 000021   000104 710000 0                  TRA     s:3430

     1085     3416    3                 STOW_NODE_LOCATION.KEY (%LVL_LOWER-1) = L1$NODE.DESC.KEY;

   3416  0 000022   200031 470500                    LDP0    L1_NODE$,,AUTO
         0 000023   000100 100500                    MLR     fill='000'O
         0 000024   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         0 000025   200017 000010                    ADSC9   STOW_NODE_LOCATION,,AUTO cn=0,n=8

     1086     3417    3                 STOW_NODE_LOCATION.KEY (%LVL_LOWER) = %CLEAR;

   3417  0 000026   200021 450100                    STZ     STOW_NODE_LOCATION+2,,AUTO
         0 000027   200022 450100                    STZ     STOW_NODE_LOCATION+3,,AUTO

     1087     3418    3                 CALL VDW$STOW_NODE (STREAM.FILE_KEY, STOW_NODE_LOCATION,

   3418  0 000030   200004 236100                    LDQ     @SAVE_FILE_RECORD_NUMBER,,AUTO
         0 000031   200042 756100                    STQ     VD_ERR$+5,,AUTO
         0 000032   200003 236100                    LDQ     @SAVE_FILE_DCB,,AUTO
         0 000033   200031 235100                    LDA     L1_NODE$,,AUTO
         0 000034   200040 757100                    STAQ    VD_ERR$+3,,AUTO
         0 000035   200017 631500                    EPPR1   STOW_NODE_LOCATION,,AUTO
         0 000036   200037 451500                    STP1    VD_ERR$+2,,AUTO
         0 000037   200005 236100                    LDQ     @STREAM,,AUTO
         0 000040   000004 036003                    ADLQ    4,DU
         0 000041   200036 756100                    STQ     VD_ERR$+1,,AUTO
         0 000042   200036 630500                    EPPR0   VD_ERR$+1,,AUTO
         0 000043   000023 631400 xsym               EPPR1   B_VECTNIL+19
         0 000044   000000 701000 xent               TSX1    VDW$STOW_NODE
         0 000045   000166 702000 0                  TSX2    FOPEN_FAILED
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:161  

     1088     3419    3                   L1$NODE, SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER)
     1089     3420    3                   ALTRET (STOW_NODE_FAILED);
     1090     3421    3                 L2_NODE$ = L1$NODE.HEAD$;

   3421  0 000046   200031 470500                    LDP0    L1_NODE$,,AUTO
         0 000047   000012 236100                    LDQ     10,,PR0
         0 000050   200032 756100                    STQ     L2_NODE$,,AUTO

     1091     3422    4                 DO WHILE L2_NODE$ ~= ADDR(NIL);

   3422  0 000051   000077 710000 0                  TRA     s:3428

     1092     3423    4                    STOW_NODE_LOCATION.KEY (%LVL_LOWER) = L2$NODE.DESC.KEY;

   3423  0 000052   200032 470500                    LDP0    L2_NODE$,,AUTO
         0 000053   000100 100500                    MLR     fill='000'O
         0 000054   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         0 000055   200021 000010                    ADSC9   STOW_NODE_LOCATION+2,,AUTO cn=0,n=8

     1093     3424    4                    CALL VDW$STOW_NODE (STREAM.FILE_KEY, STOW_NODE_LOCATION,

   3424  0 000056   200004 236100                    LDQ     @SAVE_FILE_RECORD_NUMBER,,AUTO
         0 000057   200042 756100                    STQ     VD_ERR$+5,,AUTO
         0 000060   200003 236100                    LDQ     @SAVE_FILE_DCB,,AUTO
         0 000061   200032 235100                    LDA     L2_NODE$,,AUTO
         0 000062   200040 757100                    STAQ    VD_ERR$+3,,AUTO
         0 000063   200017 631500                    EPPR1   STOW_NODE_LOCATION,,AUTO
         0 000064   200037 451500                    STP1    VD_ERR$+2,,AUTO
         0 000065   200005 236100                    LDQ     @STREAM,,AUTO
         0 000066   000004 036003                    ADLQ    4,DU
         0 000067   200036 756100                    STQ     VD_ERR$+1,,AUTO
         0 000070   200036 630500                    EPPR0   VD_ERR$+1,,AUTO
         0 000071   000023 631400 xsym               EPPR1   B_VECTNIL+19
         0 000072   000000 701000 xent               TSX1    VDW$STOW_NODE
         0 000073   000166 702000 0                  TSX2    FOPEN_FAILED

PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:162  
     1094     3425    4                      L2$NODE, SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER)
     1095     3426    4                      ALTRET (STOW_NODE_FAILED);
     1096     3427    4                    L2_NODE$ = L2$NODE.FLINK$;

   3427  0 000074   200032 470500                    LDP0    L2_NODE$,,AUTO
         0 000075   000002 236100                    LDQ     2,,PR0
         0 000076   200032 756100                    STQ     L2_NODE$,,AUTO

     1097     3428    4                    END;

   3428  0 000077   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000100   000052 601000 0                  TNZ     s:3423

     1098     3429    3                 L1_NODE$ = L1$NODE.FLINK$;

   3429  0 000101   200031 470500                    LDP0    L1_NODE$,,AUTO
         0 000102   000002 236100                    LDQ     2,,PR0
         0 000103   200031 756100                    STQ     L1_NODE$,,AUTO

     1099     3430    3                 END;

   3430  0 000104   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000105   000022 601000 0                  TNZ     s:3416

     1100     3431    2              END MULTI_LEVEL_INTERNAL_FILE;

   3431  0 000106   000165 710000 0                  TRA     s:3457

     1101     3432    1           ELSE
     1102     3433    1   SINGLE_LEVEL_INTERNAL_FILE:
     1103     3434    2           DO;

   3434  0 000107                       SINGLE_LEVE* null
     1104     3435    2              LREAD_LOCATION = %CLEAR;

   3435  0 000107   000100 100400                    MLR     fill='000'O
         0 000110   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:163  
         0 000111   200006 000044                    ADSC9   LREAD_LOCATION,,AUTO     cn=0,n=36

     1105     3436    2              LOCATION$ = ADDR(LREAD_LOCATION);

   3436  0 000112   200006 630500                    EPPR0   LREAD_LOCATION,,AUTO
         0 000113   200033 450500                    STP0    LOCATION$,,AUTO

     1106     3437    2              RELATIVE = 0;

   3437  0 000114   200034 450100                    STZ     RELATIVE,,AUTO

     1107     3438
     1108     3439    2   EACH_INTERNAL_FILE_RECORD:
     1109     3440    3              DO UNTIL (STREAM.CURRENT.EOF = %TRUE);

   3440  0 000115                       EACH_INTERN* null
     1110     3441    3                 CALL VDA$LREAD (STREAM, LOCATION$->VD$LOCATION, RELATIVE, %TRUE)

   3441  0 000115   000000 236000 1                  LDQ     0
         0 000116   200041 756100                    STQ     VD_ERR$+4,,AUTO
         0 000117   200034 630500                    EPPR0   RELATIVE,,AUTO
         0 000120   200040 450500                    STP0    VD_ERR$+3,,AUTO
         0 000121   200033 236100                    LDQ     LOCATION$,,AUTO
         0 000122   200005 235100                    LDA     @STREAM,,AUTO
         0 000123   200036 757100                    STAQ    VD_ERR$+1,,AUTO
         0 000124   200036 630500                    EPPR0   VD_ERR$+1,,AUTO
         0 000125   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000126   000000 701000 xent               TSX1    VDA$LREAD
         0 000127   000166 702000 0                  TSX2    FOPEN_FAILED

     1111     3442    3                   ALTRET (LREAD_FAILED);
     1112     3443    3                 IF STREAM.CURRENT.EOF = %TRUE THEN

   3443  0 000130   200005 470500                    LDP0    @STREAM,,AUTO
         0 000131   000016 236100                    LDQ     14,,PR0
         0 000132   400000 316007                    CANQ    -131072,DL
         0 000133   000165 601000 0                  TNZ     s:3457
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:164  

     1113     3444    3                    EXIT EACH_INTERNAL_FILE_RECORD;
     1114     3445
     1115     3446    3                 CALL VDW$STOW_NODE (STREAM.FILE_KEY, STREAM.CURRENT,

   3446  0 000134   000001 471500                    LDP1    1,,PR0
         0 000135   100040 473500                    LDP3    32,,PR1
         0 000136   200004 236100                    LDQ     @SAVE_FILE_RECORD_NUMBER,,AUTO
         0 000137   200042 756100                    STQ     VD_ERR$+5,,AUTO
         0 000140   200003 236100                    LDQ     @SAVE_FILE_DCB,,AUTO
         0 000141   200041 756100                    STQ     VD_ERR$+4,,AUTO
         0 000142   200040 453500                    STP3    VD_ERR$+3,,AUTO
         0 000143   200005 236100                    LDQ     @STREAM,,AUTO
         0 000144   000006 036003                    ADLQ    6,DU
         0 000145   200037 756100                    STQ     VD_ERR$+2,,AUTO
         0 000146   200005 236100                    LDQ     @STREAM,,AUTO
         0 000147   000004 036003                    ADLQ    4,DU
         0 000150   200036 756100                    STQ     VD_ERR$+1,,AUTO
         0 000151   200036 630500                    EPPR0   VD_ERR$+1,,AUTO
         0 000152   000023 631400 xsym               EPPR1   B_VECTNIL+19
         0 000153   000000 701000 xent               TSX1    VDW$STOW_NODE
         0 000154   000166 702000 0                  TSX2    FOPEN_FAILED

     1116     3447    3                   STREAM.PORT$->VD$PORT.LEVEL.INTERNAL$ (%LVL_LOWER)->VD$FILE_NODE,
     1117     3448    3                   SAVE_FILE_DCB, SAVE_FILE_RECORD_NUMBER)
     1118     3449    3                   ALTRET (STOW_NODE_FAILED);
     1119     3450
     1120     3451    3                 LOCATION$ = ADDR(NIL);

   3451  0 000155   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000156   200033 756100                    STQ     LOCATION$,,AUTO

     1121     3452    3                 RELATIVE = 1;

   3452  0 000157   000001 235007                    LDA     1,DL
         0 000160   200034 755100                    STA     RELATIVE,,AUTO

PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:165  
     1122     3453    3                 END EACH_INTERNAL_FILE_RECORD;

   3453  0 000161   200005 470500                    LDP0    @STREAM,,AUTO
         0 000162   000016 236100                    LDQ     14,,PR0
         0 000163   400000 316007                    CANQ    -131072,DL
         0 000164   000115 600000 0                  TZE     EACH_INTERNAL_FILE_RECORD

     1123     3454
     1124     3455    2              END SINGLE_LEVEL_INTERNAL_FILE;

     1125     3456
     1126     3457    1           RETURN;

   3457  0 000165   000000 702200 xent               TSX2  ! X66_ARET

   3451  0 000166                       FOPEN_FAILED null
   3451  0 000166                       LDELETE_FAI* null
   3451  0 000166                       LREAD_FAILED null
   3451  0 000166                       STOW_NODE_F* null
     1127     3458
     1128     3459    1   FOPEN_FAILED: ;
     1129     3460    1   LDELETE_FAILED: ;
     1130     3461    1   LREAD_FAILED: ;
     1131     3462    1   STOW_NODE_FAILED: ;
     1132     3463    1           ALTRETURN;

   3463  0 000166   000000 702200 xent               TSX2  ! X66_AALT
     1133     3464
     1134     3465
     1135     3466    1   END VDW$SAVE;
     1136     3467        %EOD;

PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:166  
--  Include file information  --

   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure VDW$SAVE.
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:167  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @SAVE_FILE_DCB
     4-0-0/w PTR         r     1 @SAVE_FILE_RECORD_NUMBER
     5-0-0/w PTR         r     1 @STREAM                   30-0-0/w PTR         r     1 L0_NODE$
    31-0-0/w PTR         r     1 L1_NODE$                  32-0-0/w PTR         r     1 L2_NODE$
    33-0-0/w PTR         r     1 LOCATION$                  6-0-0/w STRC(324)   r     1 LREAD_LOCATION
    34-0-0/w SBIN        r     1 RELATIVE                  *0-0-0/h UBIN(18)    r     1 SAVE_FILE_DCB
    *0-0-0/w SBIN        r     1 SAVE_FILE_RECORD_NUMBER
    17-0-0/w STRC(324)   r     1 STOW_NODE_LOCATION        *0-0-0/w STRC(864)   r     1 STREAM
    35-0-0/w PTR         r     1 VD_ERR$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(22644) r     1 VD_6E

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(468)   r     1 L0$NODE                    0-0-0/w STRC(468)   r     1 L1$NODE
     0-0-0/w STRC(468)   r     1 L2$NODE                    0-0-0/w ASTR(90)    r     1 VD$BUFFER
     0-0-0/w STRC(468)   r     1 VD$FILE_NODE               0-0-0/w STRC(324)   r     1 VD$LOCATION
     0-0-0/w STRC(1944)  r     1 VD$PORT                    0-0-0/w ASTR(81)    r     1 VD$TEXTC_REMOTE


   Procedure VDW$SAVE requires 119 words for executable code.
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:168  
   Procedure VDW$SAVE requires 36 words of local(AUTO) storage.
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:169  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:170  
          MINI XREF LISTING

EACH_INTERNAL_FILE_RECORD
      3440**LABEL    3444--EXIT
L0$NODE.HEAD$
      2916**DCL      3414>>ASSIGN
L0_NODE$
      2613**DCL      2833--IMP-PTR  3413<<ASSIGN   3414>>ASSIGN
L1$NODE
      2926**DCL      3418<>CALL
L1$NODE.DESC.KEY
      2989**DCL      3416>>ASSIGN
L1$NODE.FLINK$
      2952**DCL      3429>>ASSIGN
L1$NODE.HEAD$
      3009**DCL      3421>>ASSIGN
L1_NODE$
      2614**DCL      2926--IMP-PTR  3414<<ASSIGN   3415>>DOWHILE  3416>>ASSIGN   3418>>CALL     3421>>ASSIGN
      3429<<ASSIGN   3429>>ASSIGN
L2$NODE
      3019**DCL      3424<>CALL
L2$NODE.DESC.KEY
      3082**DCL      3423>>ASSIGN
L2$NODE.FLINK$
      3045**DCL      3427>>ASSIGN
L2_NODE$
      2615**DCL      3019--IMP-PTR  3421<<ASSIGN   3422>>DOWHILE  3423>>ASSIGN   3424>>CALL     3427<<ASSIGN
      3427>>ASSIGN
LOCATION$
      2616**DCL      3436<<ASSIGN   3441>>CALL     3451<<ASSIGN
LREAD_FAILED
      3451**LABEL    3441--CALLALT
LREAD_LOCATION
      2565**DCL      3435<<ASSIGN   3436--ASSIGN
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:171  
RELATIVE
      2617**DCL      3437<<ASSIGN   3441<>CALL     3452<<ASSIGN
SAVE_FILE_DCB
      2399**DCL        32--PROC     3418<>CALL     3424<>CALL     3446<>CALL
SAVE_FILE_RECORD_NUMBER
      2400**DCL        32--PROC     3418<>CALL     3424<>CALL     3446<>CALL
STOW_NODE_FAILED
      3451**LABEL    3418--CALLALT  3424--CALLALT  3446--CALLALT
STOW_NODE_LOCATION
      2593**DCL      3412<<ASSIGN   3418<>CALL     3424<>CALL
STOW_NODE_LOCATION.KEY
      2607**DCL      3416<<ASSIGN   3417<<ASSIGN   3423<<ASSIGN
STREAM
      2409**DCL        32--PROC     3407--IF       3407--IF       3441<>CALL
STREAM.CURRENT
      2460**DCL      3446<>CALL
STREAM.CURRENT.EOF
      2476**DCL      3440>>DOUNTIL  3443>>IF
STREAM.FILE_KEY
      2446**DCL      3418<>CALL     3424<>CALL     3446<>CALL
STREAM.PORT$
      2435**DCL      3413>>ASSIGN   3446>>CALL
VD$BUFFER.LENGTH#
      2672**DCL      2674--IMP-SIZ
VD$FILE_NODE
      2740**DCL      3446<>CALL
VD$LOCATION
      3112**DCL      3441<>CALL
VD$PORT.LEVEL.INTERNAL$
      3275**DCL      3413>>ASSIGN   3446>>CALL
VD$TEXTC_REMOTE.LENGTH#
      3332**DCL      3334--IMP-SIZ
VDA$LREAD
      2548**DCL-ENT  3441--CALL
VDW$STOW_NODE
      2554**DCL-ENT  3418--CALL     3424--CALL     3446--CALL
PL6.E3A0      #003=VDW$SAVE File=VDW$WORKSPACE.:VDA5TSI                          FRI 07/04/97 11:42 Page:172  
VD_6E.STRUCTURES$
      2522**DCL      3407>>IF
VD_6E.WINDOWS$
      2523**DCL      3407>>IF
VD_ERR$
      2618**DCL      2687--IMP-PTR

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:173  
     1137        1        /*T***********************************************************/
     1138        2        /*T*                                                         */
     1139        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1140        4        /*T*                                                         */
     1141        5        /*T***********************************************************/
     1142        6
     1143        7        /*D* NAME: VDW$STOW_NODE
     1144        8            PARAMETERS:
     1145        9                FILE_KEY - VD$KEY containing the file key of the file to which the
     1146       10                    node being written belongs.
     1147       11                    When writing the header record for an encoded file, FILE_KEY
     1148       12                    must be %CLEAR.
     1149       13                LOCATION - A VD$LOCATION specifying the exact location of FILE_NODE
     1150       14                    in its file (ie, all appropriate key levels filled in).
     1151       15                    When writing the header record for an encoded file, LOCATION
     1152       16                    must be %CLEAR.
     1153       17                FILE_NODE - The VD$FILE_NODE to encode and write to the workspace file.
     1154       18                    When writing the header record for an encoded file,
     1155       19                    FILE_NODE.DESC.DATA$ must be NIL, and FILE_NODE.DESC.SPEC must
     1156       20                    specify the header:  .TYPE# = %SPT_ENCODED_FILE_SPEC, .REP# =
     1157       21                    %REP_REMOTE, and .V$ pointing to a VD$ENCODED_FILE_SPEC.
     1158       22                WS_FILE_DCB - UBIN HALF HALIGNED containing the DCB # to write
     1159       23                    to.  The DCB must be open and positioned to write the next record.
     1160       24                WS_FILE_RECORD_NUMBER - The number of the next record to be
     1161       25                    written to the workspace file (the first record is # 0).
     1162       26            INPUT:
     1163       27            OUTPUT:
     1164       28                WS_FILE_RECORD_NUMBER will be incremented once, for the single record
     1165       29                    written thru WS_FILE_DCB#.
     1166       30            DESCRIPTION:
     1167       31                Encode FILE_NODE and write it to the workspace file.
     1168       32        */
     1169       33
     1170       34        VDW$STOW_NODE: PROC (FILE_KEY, LOCATION, FILE_NODE, WS_FILE_DCB,
     1171       35                  WS_FILE_RECORD_NUMBER) ALTRET;
     1172       36
     1173       37        %INCLUDE CP_6;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:174  
     1174      118        %INCLUDE CP_6_SUBS;
     1175      658
     1176      659        %FPT_WRITE (FPTN=FPT_WRITE_CONTEXT_FILE);
     1177      690
     1178      691        %INCLUDE VD_MACROS_M;
     1179     2906        %INCLUDE VD_PERR_C;
     1180     3054
     1181     3055
     1182     3056        %VD$KEY (NAME=FILE_KEY, STCLASS=PARAM);
     1183     3070        %VD$LOCATION (NAME=LOCATION, STCLASS=PARAM);
     1184     3098        %VD$FILE_NODE (NAME=FILE_NODE, STCLASS=PARAM);
     1185     3191    1   DCL WS_FILE_DCB UBIN HALF HALIGNED;
     1186     3192    1   DCL WS_FILE_RECORD_NUMBER SBIN;
     1187     3193
     1188     3194
     1189     3195
     1190     3196    1   DCL VDG$OALLOC          ENTRY (3) ALTRET;
     1191     3197    1   DCL VDG$OFREE           ENTRY (1) ALTRET;
     1192     3198    1   DCL VDG$ESCREECH        ENTRY (3);
     1193     3199
     1194     3200
     1195     3201    1   DCL 1 B_VERSION CALIGNED SYMREF,
     1196     3202    1         2 LENGTH UBIN BYTE UNAL,
     1197     3203    1         2 TEXT CHAR(B_VERSION.LENGTH);
     1198     3204        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
     1199     3240        %VD_OBJECTS (NAME=VD_OBJECTS, STCLASS=SYMREF);
     1200     3280    1   DCL B$TCB$ PTR SYMREF;
     1201     3281
     1202     3282
     1203     3283    1   DCL BASED_ARRAY$ PTR;
     1204     3284    1   DCL BIGGER_ENCODED_NODE$ PTR;
     1205     3285    1   DCL ENCODED_NODE$ PTR;
     1206     3286    1   DCL ENCODED_NODE_SIZE UBIN;
     1207     3287    1   DCL I SBIN;
     1208     3288    1   DCL OBJECT_HEADER$ PTR;
     1209     3289    1   DCL OBJECT_LIMIT$ PTR;
     1210     3290    1   DCL OBJECT_NEXT$ PTR;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:175  
     1211     3291    1   DCL OBJECT_SIZE UBIN;
     1212     3292    1   DCL SUM SBIN;
     1213     3293    1   DCL VD_ERR$ PTR;
     1214     3294    1   DCL VD_NUMBER$ PTR;
     1215     3295
     1216     3296
     1217     3297    1   DCL BASED$ARRAY (0:0) SBIN BASED(BASED_ARRAY$);
     1218     3298    1   DCL BASED$OBJECT CHAR(OBJECT_SIZE) BASED;
     1219     3299    1   DCL BASED$SBIN SBIN BASED;
     1220     3300        %VD$OBJECT_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
     1221     3322        %VD$ENCODED_NODE (NAME=ENCODED$NODE, STCLASS="BASED(ENCODED_NODE$)");
     1222     3443        %VD$ENCODED_NODE (NAME=BIGGER_ENCODED$NODE,
     1223     3444            STCLASS="BASED(BIGGER_ENCODED_NODE$)");
     1224     3565        %VD$ERR (NAME=VD$ERR, STCLASS="BASED(VD_ERR$)");
     1225     3618        %VD$NUMBER (NAME=VD$NUMBER, DIM="(0:2)", STCLASS="BASED(VD_NUMBER$)");
     1226     3663        %VD$ENCODED_FILE_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
     1227     3692        %VD$KEY;
     1228     3706        %VD$TEXTC_REMOTE;
     1229     3767        %VD$NAME_SPEC;
     1230     3815        %VD$WINDOW_SPEC;
     1231     3881        %VD$PORT;
     1232     3979        %VD$BUFFER;
     1233     4037        %B$TCB (NAME=B$TCB, STCLASS="BASED(B$TCB$)");
     1234     4040        %B$ALT;
     1235     4048
     1236     4049
     1237     4050                /* Don't bother to save constants (read_only equals variables) */
     1238     4051    1           IF FILE_NODE.DESC.SPEC.TYPE# = %SPT_NAME_SPEC
     1239     4052    1             AND FILE_NODE.DESC.SPEC.V$ -> VD$NAME_SPEC.DATA_TYPE# = %NDT_EQUALS
     1240     4053    1             AND FILE_NODE.ACCESS = %NAC_READ_BIT THEN
     1241     4054    1              RETURN;
     1242     4055    1           ENCODED_NODE_SIZE = 1024;  /* Start with 1K */
     1243     4056    1           CALL VDG$OALLOC (%CLS_ENCODED_NODE, ENCODED_NODE$, ENCODED_NODE_SIZE)
     1244     4057    1             ALTRET (OALLOC_FAILED);
     1245     4058    1           ENCODED$NODE.RECORD_ID = %CHR_ENCODED_RECID;
     1246     4059    1           ENCODED$NODE.RECORD_VERSION = B_VERSION.TEXT;
     1247     4060    1           ENCODED$NODE.RECORD_NUM# = WS_FILE_RECORD_NUMBER;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:176  
     1248     4061    1           ENCODED$NODE.DESC.FILE_KEY = FILE_KEY;
     1249     4062    1           ENCODED$NODE.DESC.LOCATION = LOCATION;
     1250     4063    1           ENCODED$NODE.DESC.ACCESS = FILE_NODE.ACCESS;
     1251     4064    1           ENCODED$NODE.DESC.SPEC = FILE_NODE.DESC.SPEC;
     1252     4065    1           ENCODED$NODE.DESC.DATA$ = FILE_NODE.DESC.DATA$;
     1253     4066
     1254     4067    1           IF FILE_KEY = %CLEAR AND LOCATION = %CLEAR
     1255     4068    1             AND FILE_NODE.DESC.SPEC.TYPE# = %SPT_ENCODED_FILE_SPEC
     1256     4069    1             AND FILE_NODE.DESC.DATA$ = ADDR(NIL)
     1257     4070    1             AND WS_FILE_RECORD_NUMBER = 0 THEN
     1258     4071    2   STOW_HEADER_RECORD: DO;
     1259     4072                   /*
     1260     4073                   *  Spec component isn't a real object (no object header), so
     1261     4074                   *    we can't call INDEXIZE_xxx to build the record.
     1262     4075                   */
     1263     4076    2              OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));
     1264     4077    2              VD$ENCODED_FILE_SPEC = FILE_NODE.DESC.SPEC.V$->VD$ENCODED_FILE_SPEC;
     1265     4078    2              ADDR(ENCODED$NODE.DESC.SPEC.V$)->BASED$SBIN = SIZEW(ENCODED$NODE);
     1266     4079    2              ADDR(ENCODED$NODE.DESC.DATA$)->BASED$SBIN = 0;
     1267     4080                   /* VD$ENCODED_FILE_SPEC contains no pointers, so we're done */
     1268     4081    2              OBJECT_NEXT$ = PINCRW(OBJECT_HEADER$, SIZEW(VD$ENCODED_FILE_SPEC));
     1269     4082    2              END STOW_HEADER_RECORD;
     1270     4083    2           ELSE DO;
     1271     4084    2              CALL INDEXIZE_RECORD
     1272     4085    2                ALTRET (INDEXIZE_RECORD_FAILED);
     1273     4086    2              END;
     1274     4087
     1275     4088    1           ENCODED$NODE.LENGTH# = POFFC(OBJECT_NEXT$,
     1276     4089    1             ADDR(ENCODED_NODE$->VD$BUFFER.BYTES));
     1277     4090
     1278     4091    1           SUM = 0;
     1279     4092    1           BASED_ARRAY$ = PINCRW(ADDR(ENCODED$NODE.CHECKSUM#), 1);
     1280     4093    1           DO I =
     1281     4094    1             ((ENCODED$NODE.LENGTH# - POFFC(BASED_ARRAY$, ENCODED_NODE$)) /
     1282     4095    2             %NB_PER_WORD) DOWNTO 0;
     1283     4096    2              SUM = SUM + BASED$ARRAY (I);
     1284     4097    2              END;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:177  
     1285     4098    1           ENCODED$NODE.CHECKSUM# = SUM;
     1286     4099
     1287     4100    1           FPT_WRITE_CONTEXT_FILE.V.DCB# = WS_FILE_DCB;
     1288     4101    1           FPT_WRITE_CONTEXT_FILE.BUF_.BUF$ = ADDR(ENCODED_NODE$ ->
     1289     4102    1             VD$BUFFER.BYTES);
     1290     4103    1           FPT_WRITE_CONTEXT_FILE.BUF_.BOUND = POFFC(OBJECT_NEXT$,
     1291     4104    1             FPT_WRITE_CONTEXT_FILE.BUF_.BUF$)
     1292     4105    1             - 1;
     1293     4106
     1294     4107    1           CALL M$WRITE (FPT_WRITE_CONTEXT_FILE)
     1295     4108    1             ALTRET (WRITE_CONTEXT_FILE_FAILED);
     1296     4109
     1297     4110    1           ENCODED$NODE.FLINK$ = ADDR(NIL);
     1298     4111    1           ENCODED$NODE.DESC = %CLEAR;
     1299     4112    1           ENCODED$NODE.DESC.DATA$ = ADDR(NIL);
     1300     4113
     1301     4114    1           CALL VDG$OFREE (ENCODED$NODE)
     1302     4115    1             ALTRET (OFREE_FAILED);
     1303     4116
     1304     4117    1           WS_FILE_RECORD_NUMBER = WS_FILE_RECORD_NUMBER + 1;
     1305     4118
     1306     4119    1           RETURN;
     1307     4120
     1308     4121
     1309     4122
     1310     4123    1   INDEXIZE_RECORD_FAILED:
     1311     4124        /*??*   CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)         *??*/
     1312     4125        /*??*     ALTRET (OALLOC_FAILED);                   *??*/
     1313     4126        /*??*   VD$ERR.ERR.CODE# = ??????                   *??*/
     1314     4127        /*??*   VD$ERR.FLAGLEV# = ??????                    *??*/
     1315     4128        /*??*   VD_NUMBER$ = PINCRW(VD_ERR$, SIZEW(VD$ERR));*??*/
     1316     4129        /*??*   VD$NUMBER.OBJECT.CLASS# (1) = %CLS_NUMBER;  *??*/
     1317     4130        /*??*   VD$NUMBER.V# (1) = WS_FILE_RECORD_NUMBER;   *??*/
     1318     4131
     1319     4132    1           ENCODED$NODE.FLINK$ = ADDR(NIL);
     1320     4133    1           ENCODED$NODE.DESC = %CLEAR;
     1321     4134    1           ENCODED$NODE.DESC.DATA$ = ADDR(NIL);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:178  
     1322     4135    1           CALL VDG$OFREE (ENCODED$NODE)
     1323     4136    1             ALTRET (OFREE_FAILED);
     1324     4137    1           ALTRETURN;
     1325     4138
     1326     4139
     1327     4140    1   WRITE_CONTEXT_FILE_FAILED:
     1328     4141    1           CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)
     1329     4142    1             ALTRET (OALLOC_FAILED);
     1330     4143    1           VD$ERR.ERR = B$TCB.ALT$->B$ALT.ERR;
     1331     4144    1           VD$ERR.FLAGLEV# = %FLV_SERIOUS;
     1332     4145
     1333     4146    1           ENCODED$NODE.FLINK$ = ADDR(NIL);
     1334     4147    1           ENCODED$NODE.DESC = %CLEAR;
     1335     4148    1           ENCODED$NODE.DESC.DATA$ = ADDR(NIL);
     1336     4149    1           CALL VDG$OFREE (ENCODED$NODE)
     1337     4150    1             ALTRET (OFREE_FAILED);
     1338     4151    1           ALTRETURN;
     1339     4152
     1340     4153
     1341     4154    1   OALLOC_FAILED: ;
     1342     4155    1   OFREE_FAILED:
     1343     4156    1           ALTRETURN;
     1344     4157
     1345     4158        %BOX (TITLE=INDEXIZE_RECORD, PAGE=YES);
              4166    1
              4170    1   /***************************************************************************
              4172    1    *                                                                         *
              4176    1            *                              INDEXIZE_RECORD                            *
              4178    1            *                                                                         *
              4180    1           ***************************************************************************/

     1346     4184
     1347     4185        /*I* NAME: INDEXIZE_RECORD
     1348     4186            PARAMETERS:
     1349     4187                None.
     1350     4188            INPUT:
     1351     4189                ENCODED$NODE is the VD$ENCODED_NODE for the workspace-file record.
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:179  
     1352     4190            OUTPUT:
     1353     4191                ENCODED$NODE's pointers will be converted to relative indexes.
     1354     4192                VD_ERR$ - If an error in the record is found, VD_ERR$ will
     1355     4193                    point to the allocated VD$ERR for the error.  It's
     1356     4194                    first substitution field will contain the %CLS_ code for
     1357     4195                    the object in error, as a CLS_NUMBER.
     1358     4196            DESCRIPTION:
     1359     4197                Loop thru the objects in ENCODED$NODE; in these objects, all
     1360     4198                pointers will be stored in the file as indexes into
     1361     4199                the record of the object pointed-to.  Find these word
     1362     4200                pointers, and replace them with indexes to the objects in
     1363     4201                the workspace record.
     1364     4202                The "tree" pointers to be worried about are FLINK$ and "CHILD$"
     1365     4203                (e.g., .FLINK$ and .MOVEMENTS$ for VD$IT_ADJUST).
     1366     4204                The other "tree" pointers (PARENT$, BLINK$, and TAIL$) are
     1367     4205                zeroed in the saved record (will be NIL at VDW$LOAD time):
     1368     4206                they're rebuilt by VDA$LWRITE when the record is written to
     1369     4207                the appropriate file.
     1370     4208        */
     1371     4209
     1372     4210    1   INDEXIZE_RECORD: PROC ALTRET;
     1373     4211
     1374     4212
     1375     4213        %VD$WINDOW_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
     1376     4279        %VD$WINDOW_BLOCK (STCLASS="BASED(OBJECT_HEADER$)");
     1377     4316        %VD$RECORD_SET (STCLASS="BASED(OBJECT_HEADER$)");
     1378     4394        %VD$STRUCTURE_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
     1379     4431        %VD$IT_ADJUST (STCLASS="BASED(OBJECT_HEADER$)");
     1380     4468        %VD$IT_BLOCK_EXPR (STCLASS="BASED(OBJECT_HEADER$)");
     1381     4618        %VD$IT_COMMAND (STCLASS="BASED(OBJECT_HEADER$)");
     1382     4656        %VD$IT_OPERAND (STCLASS="BASED(OBJECT_HEADER$)");
     1383     4722        %VD$IT_OPERATOR (STCLASS="BASED(OBJECT_HEADER$)");
     1384     4759        %VD$IT_SELECT (STCLASS="BASED(OBJECT_HEADER$)");
     1385     4796        %VD$BLOCK_DESC (STCLASS="BASED(OBJECT_HEADER$)");
     1386     4943        %VD$BUFFER (STCLASS="BASED(OBJECT_HEADER$)");
     1387     5001        %VD$BUFFER_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
     1388     5037        %VD$STRING_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:180  
     1389     5073        %VD$PATTERN (STCLASS="BASED(OBJECT_HEADER$)");
     1390     5124        %VD$EVAL (STCLASS="BASED(OBJECT_HEADER$)");
     1391     5369        %VD$FIT (STCLASS="BASED(OBJECT_HEADER$)");
     1392     5405        %VD$POINTER (STCLASS="BASED(OBJECT_HEADER$)");
     1393     5450
     1394     5451
     1395     5452
     1396     5453    2           OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));
     1397     5454    2           OBJECT_NEXT$ = OBJECT_HEADER$;
     1398     5455
     1399     5456    3           IF ENCODED$NODE.DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;
     1400     5457    3              CALL INDEXIZE (ENCODED$NODE.DESC.FILE_KEY.V$) ALTRET (INDEXIZE_FAILURE);
     1401     5458    3              END;
     1402     5459    2           CALL INDEXIZE_LOCATION (ENCODED$NODE.DESC.LOCATION);
     1403     5460    3           IF ENCODED$NODE.DESC.SPEC.REP# = %REP_REMOTE THEN DO;
     1404     5461    3              CALL INDEXIZE (ENCODED$NODE.DESC.SPEC.V$) ALTRET (INDEXIZE_FAILURE);
     1405     5462    3              END;
     1406     5463    2           CALL INDEXIZE (ENCODED$NODE.DESC.DATA$) ALTRET (INDEXIZE_FAILURE);
     1407     5464
     1408     5465
     1409     5466    2   EACH_OBJECT:
     1410     5467    3           DO WHILE (POFFW(OBJECT_NEXT$, OBJECT_HEADER$) > 0);
     1411     5468
     1412     5469    3   OBJECT_TYPE_CASES:
     1413     5470    4              DO CASE (VD$OBJECT_HEADER.CLASS#);
     1414     5471
     1415     5472    4               CASE (%CLS_TEXTC_REMOTE, %CLS_FILE_KEY, %CLS_NAME_SPEC,
     1416     5473    4                %CLS_STRUCTURE_LEVEL);
     1417     5474    4                 CALL INDEXIZE (VD$STRING_HEADER.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1418     5475
     1419     5476    4               CASE (%CLS_BUFFER, %CLS_NUMBER, %CLS_BOOLEAN, %CLS_FILE_STCLASS,
     1420     5477    4                   %CLS_ORG, %CLS_KEY_TYPE, %CLS_EXIST, %CLS_NAME_DATA_TYPE,
     1421     5478    4                   %CLS_COMPONENT, %CLS_POINT, %CLS_DIRECTION, %CLS_PROTECT);
     1422     5479    4                 CALL INDEXIZE (VD$BUFFER_HEADER.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1423     5480
     1424     5481    4               CASE (%CLS_WINDOW_SPEC);
     1425     5482                      /*
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:181  
     1426     5483                      * When saving VD$WINDOW_SPECs:
     1427     5484                      * o set .DCB# to 0;
     1428     5485                      * o don't save the .OPERAND.STREAM;
     1429     5486                      * o don't save the .RECORD_SET.
     1430     5487                      */
     1431     5488    4                 VD$WINDOW_SPEC.DCB# = 0;
     1432     5489    4                 CALL INDEXIZE (VD$WINDOW_SPEC.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1433     5490    4                 ADDR(VD$WINDOW_SPEC.OPERAND.STREAM$)->BASED$SBIN = 0;
     1434     5491    4                 CALL INDEXIZE (VD$WINDOW_SPEC.OPERAND.INTREE$) ALTRET (
              5491                          INDEXIZE_FAILURE);
     1435     5492    4                 CALL INDEXIZE (VD$WINDOW_SPEC.OPERAND.EDIT_BLOCK$) ALTRET (
              5492                          INDEXIZE_FAILURE);
     1436     5493    4                 CALL INDEXIZE (VD$WINDOW_SPEC.OPERAND.EVAL$) ALTRET (INDEXIZE_FAILURE)
              5493                          ;
     1437     5494    4                 ADDR(VD$WINDOW_SPEC.RECORD_SET$)->BASED$SBIN = 0;
     1438     5495    4                 CALL INDEXIZE (VD$WINDOW_SPEC.KEY_DEFINITION_BUFFER$) ALTRET (
              5495                          INDEXIZE_FAILURE);
     1439     5496    4                 CALL INDEXIZE (VD$WINDOW_SPEC.EOFMARK$) ALTRET (INDEXIZE_FAILURE);
     1440     5497    4                 CALL INDEXIZE (VD$WINDOW_SPEC.TABS$) ALTRET (INDEXIZE_FAILURE);
     1441     5498
     1442     5499    4               CASE (%CLS_WINDOW_BLOCK);
     1443     5500    4                 CALL INDEXIZE (VD$WINDOW_BLOCK.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1444     5501    4                 CALL INDEXIZE (VD$WINDOW_BLOCK.EDIT_BLOCK$) ALTRET (INDEXIZE_FAILURE);
     1445     5502    4                 CALL INDEXIZE (VD$WINDOW_BLOCK.EVAL$) ALTRET (INDEXIZE_FAILURE);
     1446     5503
     1447     5504    4               CASE (%CLS_RECORD_SET);
     1448     5505    5                 DO I = 0 TO (VD$RECORD_SET.N_ENTRIES# - 1);
     1449     5506    6                    IF VD$RECORD_SET.DESC.KEY.REP# (I) = %REP_REMOTE THEN DO;
     1450     5507    6                       CALL INDEXIZE (VD$RECORD_SET.DESC.KEY.V$ (I)) ALTRET (
              5507                                INDEXIZE_FAILURE);
     1451     5508    6                       END;
     1452     5509    5                    END;
     1453     5510
     1454     5511    4               CASE (%CLS_STRUCTURE_SPEC);
     1455     5512    4                 CALL INDEXIZE (VD$STRUCTURE_SPEC.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1456     5513    4                 CALL INDEXIZE (VD$STRUCTURE_SPEC.ACCESSOR$) ALTRET (INDEXIZE_FAILURE);
     1457     5514    4                 CALL INDEXIZE (VD$STRUCTURE_SPEC.FIT$) ALTRET (INDEXIZE_FAILURE);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:182  
     1458     5515
     1459     5516    4               CASE (%CLS_IT_ADJUST);
     1460     5517    4                 ADDR(VD$IT_ADJUST.PARENT$)->BASED$SBIN = 0;
     1461     5518    4                 CALL INDEXIZE (VD$IT_ADJUST.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1462     5519    4                 CALL INDEXIZE (VD$IT_ADJUST.MOVEMENTS$) ALTRET (INDEXIZE_FAILURE);
     1463     5520    4                 ADDR(VD$IT_ADJUST.MOVEMENTS_TAIL$)->BASED$SBIN = 0;
     1464     5521
     1465     5522    4               CASE (%CLS_IT_BLOCK_EXPR);
     1466     5523    4                 CALL INDEXIZE (VD$IT_BLOCK_EXPR.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1467     5524    5                 IF VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.REP# = %REP_REMOTE THEN DO;
     1468     5525    5                    CALL INDEXIZE (VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.V$) ALTRET (
              5525                             INDEXIZE_FAILURE);
     1469     5526    5                    END;
     1470     5527    4                 CALL INDEXIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.START) ALTRET (
              5527                          INDEXIZE_FAILURE);
     1471     5528    4                 CALL INDEXIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.ENDD) ALTRET (
              5528                          INDEXIZE_FAILURE);
     1472     5529    4                 ADDR(VD$IT_BLOCK_EXPR.OPTIONS.STRUCTURE$)->BASED$SBIN = 0;
     1473     5530    5                 IF VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;
     1474     5531    5                    CALL INDEXIZE (VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.V$) ALTRET (
              5531                             INDEXIZE_FAILURE);
     1475     5532    5                    END;
     1476     5533    4                 CALL INDEXIZE (VD$IT_BLOCK_EXPR.SELECTS$) ALTRET (INDEXIZE_FAILURE);
     1477     5534    4                 ADDR(VD$IT_BLOCK_EXPR.SELECTS_TAIL$)->BASED$SBIN = 0;
     1478     5535
     1479     5536    4               CASE (%CLS_IT_COMMAND);
     1480     5537    4                 ADDR(VD$IT_COMMAND.PARENT$)->BASED$SBIN = 0;
     1481     5538    4                 CALL INDEXIZE (VD$IT_COMMAND.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1482     5539    5                 DO I = 0 TO %MX_COMMAND_PARAMS-1;
     1483     5540    5                    CALL INDEXIZE (VD$IT_COMMAND.PARAM$ (I)) ALTRET (INDEXIZE_FAILURE);
     1484     5541    5                    END;
     1485     5542
     1486     5543    4               CASE (%CLS_IT_OPERAND);
     1487     5544    4                 ADDR(VD$IT_OPERAND.PARENT$)->BASED$SBIN = 0;
     1488     5545    4                 CALL INDEXIZE (VD$IT_OPERAND.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1489     5546    5                 IF VD$IT_OPERAND.KEY.REP# = %REP_REMOTE THEN DO;
     1490     5547    5                    CALL INDEXIZE (VD$IT_OPERAND.KEY.V$) ALTRET (INDEXIZE_FAILURE);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:183  
     1491     5548    5                    END;
     1492     5549    4                 CALL INDEXIZE (VD$IT_OPERAND.PARAM$) ALTRET (INDEXIZE_FAILURE);
     1493     5550
     1494     5551    4               CASE (%CLS_IT_OPERATOR);
     1495     5552    4                 ADDR(VD$IT_OPERATOR.PARENT$)->BASED$SBIN = 0;
     1496     5553    4                 CALL INDEXIZE (VD$IT_OPERATOR.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1497     5554    4                 CALL INDEXIZE (VD$IT_OPERATOR.OPERAND$) ALTRET (INDEXIZE_FAILURE);
     1498     5555    4                 CALL INDEXIZE (VD$IT_OPERATOR.R_OPERAND$) ALTRET (INDEXIZE_FAILURE);
     1499     5556
     1500     5557    4               CASE (%CLS_IT_SELECT);
     1501     5558    4                 ADDR(VD$IT_SELECT.PARENT$)->BASED$SBIN = 0;
     1502     5559    4                 CALL INDEXIZE (VD$IT_SELECT.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1503     5560    4                 CALL INDEXIZE (VD$IT_SELECT.ADJUSTS$) ALTRET (INDEXIZE_FAILURE);
     1504     5561    4                 ADDR(VD$IT_SELECT.ADJUSTS_TAIL$)->BASED$SBIN = 0;
     1505     5562
     1506     5563    4               CASE (%CLS_BLOCK_DESC, %CLS_BLOCK_BUFFER);
     1507     5564    5                 IF VD$OBJECT_HEADER.CLASS# = %CLS_BLOCK_BUFFER THEN DO;
     1508     5565    5                    CALL INDEXIZE (VD$BUFFER_HEADER.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1509     5566    5                    OBJECT_HEADER$ = PALIGNW(ADDR(VD$BUFFER.BYTES));
     1510     5567    5                    END;
     1511     5568    5                 IF VD$BLOCK_DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;
     1512     5569    5                    CALL INDEXIZE (VD$BLOCK_DESC.FILE_KEY.V$) ALTRET (INDEXIZE_FAILURE)
              5569                             ;
     1513     5570    5                    END;
     1514     5571    4                 CALL INDEXIZE_LOCATION (VD$BLOCK_DESC.RANGE.START) ALTRET (
              5571                          INDEXIZE_FAILURE);
     1515     5572    4                 CALL INDEXIZE_LOCATION (VD$BLOCK_DESC.RANGE.ENDD) ALTRET (
              5572                          INDEXIZE_FAILURE);
     1516     5573    4                 CALL INDEXIZE_STRUCTURE (VD$BLOCK_DESC.OPTIONS.STRUCTURE$) ALTRET (
              5573                          INDEXIZE_FAILURE);
     1517     5574    5                 IF VD$BLOCK_DESC.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;
     1518     5575    5                    CALL INDEXIZE (VD$BLOCK_DESC.OPTIONS.KEY_INCR.V$) ALTRET (
              5575                             INDEXIZE_FAILURE);
     1519     5576    5                    END;
     1520     5577
     1521     5578    4               CASE (%CLS_PATTERN);
     1522     5579    5                 DO I = 0 TO VD$PATTERN.N_ENTRIES# - 1;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:184  
     1523     5580    5                    CALL INDEXIZE (VD$PATTERN.ENTRIES.MATCH$ (I)) ALTRET (
              5580                             INDEXIZE_FAILURE);
     1524     5581    5                    END;
     1525     5582
     1526     5583    4               CASE (%CLS_EVAL);
     1527     5584    4                 ADDR(VD$EVAL.BLINK$)->BASED$SBIN = 0;
     1528     5585    4                 CALL INDEXIZE_LOCATION (VD$EVAL.ENCLOSING.START) ALTRET (
              5585                          INDEXIZE_FAILURE);
     1529     5586    4                 CALL INDEXIZE_LOCATION (VD$EVAL.ENCLOSING.ENDD) ALTRET (
              5586                          INDEXIZE_FAILURE);
     1530     5587    4                 CALL INDEXIZE_LOCATION (VD$EVAL.RANGE.START) ALTRET (INDEXIZE_FAILURE)
              5587                          ;
     1531     5588    4                 CALL INDEXIZE_LOCATION (VD$EVAL.RANGE.ENDD) ALTRET (INDEXIZE_FAILURE);
     1532     5589        /*N**N**N* How do we indexize VD$EVAL.NODE$?  It can't be stored
     1533     5590        **N**N**N*  in the same record.  Maybe store a "walking index":
     1534     5591        **N**N**N*  count of # of node when walking the InTree?
     1535     5592        **N**N**N*/
     1536     5593    4                 ADDR(VD$EVAL.NODE$)->BASED$SBIN = 0;
     1537     5594
     1538     5595    4               CASE (%CLS_FIT);
     1539     5596    4                 CALL INDEXIZE (VD$FIT.CODE2$) ALTRET (INDEXIZE_FAILURE);
     1540     5597    4                 CALL INDEXIZE (VD$FIT.CODE3$) ALTRET (INDEXIZE_FAILURE);
     1541     5598
     1542     5599    4               CASE (%CLS_PTR_FILE_NODE);
     1543     5600    4                 CALL INDEXIZE_STRUCTURE (VD$POINTER.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1544     5601    4                 CALL INDEXIZE_STRUCTURE (VD$POINTER.V$) ALTRET (INDEXIZE_FAILURE);
     1545     5602
     1546     5603    4               CASE (%CLS_PTR_KEY);
     1547     5604    4                 VD$OBJECT_HEADER.SIZE# = SIZEW(VD$POINTER) + SIZEW(VD$KEY);
     1548     5605    4                 CALL INDEXIZE (VD$POINTER.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1549     5606    4                 PINCRW(OBJECT_HEADER$, SIZEW(VD$POINTER)) -> VD$KEY =
     1550     5607    4                   VD$POINTER.V$ -> VD$KEY;
     1551     5608    4                 IF VD$POINTER.V$ -> VD$KEY.REP# = %REP_REMOTE THEN
     1552     5609    4                    CALL INDEXIZE
     1553     5610    4                      (ADDR(PINCRW(OBJECT_HEADER$,SIZEW(VD$POINTER))->VD$KEY.V$))
     1554     5611    4                      ALTRET (INDEXIZE_FAILURE);
     1555     5612    4                 ADDR(VD$POINTER.V$) -> BASED$SBIN =
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:185  
     1556     5613    4                   POFFW (OBJECT_HEADER$, ENCODED_NODE$) + SIZEW(VD$POINTER);
     1557     5614    4               CASE (%CLS_PTR_BLOCK_DESC, %CLS_PTR_INTREE);
     1558     5615    4                 CALL INDEXIZE (VD$POINTER.FLINK$) ALTRET (INDEXIZE_FAILURE);
     1559     5616    4                 CALL INDEXIZE (VD$POINTER.V$) ALTRET (INDEXIZE_FAILURE);
     1560     5617
     1561     5618    4               CASE (%CLS_CMD_STREAM, %CLS_ENCODED_NODE, %CLS_DIR_NODE,
     1562     5619    4                   %CLS_FILE_NODE, %CLS_STREAM, %CLS_PORT, ELSE);
     1563     5620                      /* Invalid object class stored in workspace record */
     1564     5621    4                 GOTO WS_FILE_INVALID_FAILURE;
     1565     5622
     1566     5623    4               END OBJECT_TYPE_CASES;
     1567     5624
     1568     5625    3              IF VD$OBJECT_HEADER.SIZE# = 0 THEN
     1569     5626    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,
     1570     5627    3                   VD_OBJECTS.SIZE (VD$OBJECT_HEADER.CLASS#));
     1571     5628    3              ELSE
     1572     5629    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,
     1573     5630    3                   VD$OBJECT_HEADER.SIZE#);
     1574     5631    3              END EACH_OBJECT;
     1575     5632
     1576     5633    2           RETURN;
     1577     5634
     1578     5635
     1579     5636    2   INVALID_WORKSPACE_FAILURE: ;
     1580     5637    2   WS_FILE_INVALID_FAILURE: ;
     1581     5638    2           CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)
     1582     5639    3           WHENALTRETURN DO; ALTRETURN; END;
     1583     5640    2           VD$ERR.ERR.CODE# = %E$BAD_WS_FILE;
     1584     5641    2           VD$ERR.FLAGLEV# = %FLV_SERIOUS;
     1585     5642    2           VD_NUMBER$ = PINCRW(VD_ERR$, SIZEW(VD$ERR));
     1586     5643    2           VD$NUMBER.OBJECT.CLASS# (0) = %CLS_NUMBER;
     1587     5644    2           VD$NUMBER.V# (0) = VD$OBJECT_HEADER.CLASS#;
     1588     5645
     1589     5646    2   INDEXIZE_FAILURE:
     1590     5647    2           ALTRETURN;
     1591     5648
     1592     5649        %BOX (TITLE=INDEXIZE_STRUCTURE);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:186  

              5661    2   /***************************************************************************
              5663    2    *                                                                         *
              5667    2            *                             INDEXIZE_STRUCTURE                          *
              5669    2            *                                                                         *
              5671    2           ***************************************************************************/

     1593     5675
     1594     5676        /*I* NAME: INDEXIZE_STRUCTURE
     1595     5677            PARAMETERS:
     1596     5678                STRUCTURE - pointer to a VD$FILE_NODE within the STRUCTURES
     1597     5679                  internal file to indexize.
     1598     5680            INPUT:
     1599     5681                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing STRUCTURE.
     1600     5682            OUTPUT:
     1601     5683                STRUCTURE's pointer will be resolved into an index into the
     1602     5684                  VD$ENCODED_NODE, where a VD$LOCATION is located.
     1603     5685            DESCRIPTION:
     1604     5686                The pointer we're INDEXIZING points to a VD$FILE_NODE within
     1605     5687                  the STRUCTURES internal file.  So, we'll try and save just
     1606     5688                  the VD$KEY to a level-1 node of the file within a VD$LOCATION.
     1607     5689        */
     1608     5690
     1609     5691    2   INDEXIZE_STRUCTURE: PROC (STRUCTURE) ALTRET;
     1610     5692
     1611     5693    3   DCL STRUCTURE PTR PARAM;
     1612     5694
     1613     5695        %VD$BLOCK_DESC (NAME=STRUCTURES_FILE_BLOCK_DESC, STCLASS=AUTO);
     1614     5842
     1615     5843        %VD$FILE_NODE;
     1616     5936
     1617     5937
     1618     5938    3           IF STRUCTURE ~= ADDR(NIL) THEN
     1619     5939    3   SAVE_THE_STRUCTURES_FILE_KEY:
     1620     5940    4           DO;
     1621     5941    4              STRUCTURES_FILE_BLOCK_DESC = %CLEAR;
     1622     5942    4              STRUCTURES_FILE_BLOCK_DESC.OBJECT.CLASS# = %CLS_BLOCK_DESC;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:187  
     1623     5943    4              STRUCTURES_FILE_BLOCK_DESC.OPTIONS.STRUCTURE$ = ADDR(NIL);
     1624     5944    4              STRUCTURES_FILE_BLOCK_DESC.RANGE.START.KEY (%LVL_LOWER-1) =
     1625     5945    4                STRUCTURE->VD$FILE_NODE.DESC.KEY;
     1626     5946    4              STRUCTURE = ADDR(STRUCTURES_FILE_BLOCK_DESC);
     1627     5947    4              END SAVE_THE_STRUCTURES_FILE_KEY;
     1628     5948    3           CALL INDEXIZE (STRUCTURE) ALTRET (INDEXIZE_FAILURE);
     1629     5949
     1630     5950    3           RETURN;
     1631     5951
     1632     5952    3   INDEXIZE_FAILURE:
     1633     5953    3           ALTRETURN;
     1634     5954
     1635     5955
     1636     5956    3   END INDEXIZE_STRUCTURE;
     1637     5957
     1638     5958        %BOX (TITLE=INDEXIZE_LOCATION);

              5970    3   /***************************************************************************
              5972    3    *                                                                         *
              5976    3            *                             INDEXIZE_LOCATION                           *
              5978    3            *                                                                         *
              5980    3           ***************************************************************************/

     1639     5984
     1640     5985        /*I* NAME: INDEXIZE_LOCATION
     1641     5986            PARAMETERS:
     1642     5987                LOCATION - VD$LOCATION to indexize.
     1643     5988            INPUT:
     1644     5989                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing LOCATION.
     1645     5990            OUTPUT:
     1646     5991                LOCATION's pointers will be resolved into actual pointers.
     1647     5992            DESCRIPTION:
     1648     5993                Go thru LOCATION's levels, and indexize any pointers found.
     1649     5994        */
     1650     5995
     1651     5996    2   INDEXIZE_LOCATION: PROC (LOCATION) ALTRET;
     1652     5997
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:188  
     1653     5998        %VD$LOCATION (NAME=LOCATION, STCLASS=PARAM);
     1654     6026
     1655     6027
     1656     6028    3   DCL LVL SBIN;
     1657     6029
     1658     6030
     1659     6031
     1660     6032    4           DO LVL = 0 TO (%(MX_LOCATION_LEVELS-1));
     1661     6033    5              IF LOCATION.KEY.REP# (LVL) = %REP_REMOTE THEN DO;
     1662     6034    5                 CALL INDEXIZE (LOCATION.KEY.V$ (LVL)) ALTRET (INDEXIZE_FAILURE);
     1663     6035    5                 END;
     1664     6036    4              END;
     1665     6037    3           RETURN;
     1666     6038
     1667     6039    3   INDEXIZE_FAILURE:
     1668     6040    3           ALTRETURN;
     1669     6041
     1670     6042
     1671     6043    3   END INDEXIZE_LOCATION;
     1672     6044
     1673     6045    2   END INDEXIZE_RECORD;
     1674     6046
     1675     6047        %BOX (TITLE=INDEXIZE);

              6059    2   /***************************************************************************
              6061    2    *                                                                         *
              6065    2            *                                  INDEXIZE                               *
              6067    2            *                                                                         *
              6069    2           ***************************************************************************/

     1676     6073
     1677     6074        /*I* NAME: INDEXIZE
     1678     6075            PARAMETERS:
     1679     6076                INDX, actually a pointer, possibly NIL.
     1680     6077            INPUT:
     1681     6078                ENCODED_NODE$ is addr of VD$ENCODED_NODE.
     1682     6079                ENCODED_NODE_SIZE is the size in words of the VD$ENCODED_NODE.
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:189  
     1683     6080                OBJECT_NEXT$ is the next available location to place an object
     1684     6081                  within the VD$ENCODED_NODE.
     1685     6082            OUTPUT:
     1686     6083                VD$ENCODED_NODE updated (see below).
     1687     6084
     1688     6085            DESCRIPTION:
     1689     6086                The object pointed to (if any) by the "INDX" passed in is
     1690     6087                placed in the VD$ENCODED_NODE at the next available location.
     1691     6088                The pointer is then turned into an index from the start of the
     1692     6089                VD$ENCODED_NODE.
     1693     6090        */
     1694     6091
     1695     6092    1   INDEXIZE: PROC (INDX) ALTRET;
     1696     6093
     1697     6094    2   DCL INDX PTR PARAM;
     1698     6095
     1699     6096
     1700     6097    2           IF INDX = ADDR(NIL) THEN
     1701     6098    2              ADDR(INDX)->BASED$SBIN = 0;
     1702     6099    3           ELSE DO;
     1703     6100    3              IF INDX->VD$OBJECT_HEADER.SIZE# = 0 THEN
     1704     6101    3                 OBJECT_SIZE = VD_OBJECTS.SIZE (INDX->VD$OBJECT_HEADER.CLASS#)
     1705     6102    3                   * %NB_PER_WORD;
     1706     6103    3              ELSE
     1707     6104    3                 OBJECT_SIZE = INDX->VD$OBJECT_HEADER.SIZE#
     1708     6105    3                   * %NB_PER_WORD;
     1709     6106    3              IF INDX->VD$OBJECT_HEADER.CLASS# = %CLS_PTR_KEY THEN
     1710     6107    3                 OBJECT_SIZE = OBJECT_SIZE + SIZEC(VD$KEY);
     1711     6108    3              IF (POFFC(OBJECT_NEXT$, ENCODED_NODE$) + OBJECT_SIZE)
     1712     6109    4                > ENCODED_NODE_SIZE * %NB_PER_WORD THEN DO;
     1713     6110    4                 CALL VDG$OALLOC (%CLS_ENCODED_NODE, BIGGER_ENCODED_NODE$,
     1714     6111    4                   ENCODED_NODE_SIZE + 1024  /* Get another 1K */)
     1715     6112    5                 WHENALTRETURN DO; ALTRETURN; END;
     1716     6113    4                 BIGGER_ENCODED$NODE = ENCODED$NODE;
     1717     6114
     1718     6115    4                 ENCODED$NODE.FLINK$ = ADDR(NIL);
     1719     6116    4                 ENCODED$NODE.DESC = %CLEAR;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:190  
     1720     6117    4                 ENCODED$NODE.DESC.DATA$ = ADDR(NIL);
     1721     6118    4                 CALL VDG$OFREE (ENCODED$NODE)
     1722     6119    5                 WHENALTRETURN DO; ALTRETURN; END;
     1723     6120
     1724     6121    4                 ENCODED_NODE_SIZE = ENCODED_NODE_SIZE + 1024;
     1725     6122    4                 END;
     1726     6123    3              OBJECT_NEXT$->BASED$OBJECT = INDX->BASED$OBJECT;
     1727     6124    3              ADDR(INDX)->BASED$SBIN = POFFW(OBJECT_NEXT$, ENCODED_NODE$);
     1728     6125    3              OBJECT_NEXT$ = PINCRW(OBJECT_NEXT$, OBJECT_SIZE / %NB_PER_WORD);
     1729     6126    3              END;
     1730     6127
     1731     6128    2           RETURN;
     1732     6129
     1733     6130    2   END INDEXIZE;
     1734     6131
     1735     6132    1   END VDW$STOW_NODE;

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:191  
--  Include file information  --

   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDW$STOW_NODE.

   Procedure VDW$STOW_NODE requires 897 words for executable code.
   Procedure VDW$STOW_NODE requires 58 words of local(AUTO) storage.

    No errors detected in file VDW$WORKSPACE.:VDA5TSI    .

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:192  

 Object Unit name= VDW$STOW_NODE                              File name= VDW$WORKSPACE.:VDA5TOU
 UTS= JUL 04 '97 11:42:50.56 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    12     14  VDW$STOW_NODE
    2  RoData even  UTS      4      4  VDW$STOW_NODE
    3   Proc  even  none   897   1601  VDW$STOW_NODE
    4  RoData even  none     6      6  VDW$STOW_NODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        5  VDW$STOW_NODE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 VDG$OALLOC
 yes     yes           Std       1 VDG$OFREE
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:193  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VERSION                             VD_OBJECTS
     B$TCB$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:194  


     1137        1        /*T***********************************************************/
     1138        2        /*T*                                                         */
     1139        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1140        4        /*T*                                                         */
     1141        5        /*T***********************************************************/
     1142        6
     1143        7        /*D* NAME: VDW$STOW_NODE
     1144        8            PARAMETERS:
     1145        9                FILE_KEY - VD$KEY containing the file key of the file to which the
     1146       10                    node being written belongs.
     1147       11                    When writing the header record for an encoded file, FILE_KEY
     1148       12                    must be %CLEAR.
     1149       13                LOCATION - A VD$LOCATION specifying the exact location of FILE_NODE
     1150       14                    in its file (ie, all appropriate key levels filled in).
     1151       15                    When writing the header record for an encoded file, LOCATION
     1152       16                    must be %CLEAR.
     1153       17                FILE_NODE - The VD$FILE_NODE to encode and write to the workspace file.
     1154       18                    When writing the header record for an encoded file,
     1155       19                    FILE_NODE.DESC.DATA$ must be NIL, and FILE_NODE.DESC.SPEC must
     1156       20                    specify the header:  .TYPE# = %SPT_ENCODED_FILE_SPEC, .REP# =
     1157       21                    %REP_REMOTE, and .V$ pointing to a VD$ENCODED_FILE_SPEC.
     1158       22                WS_FILE_DCB - UBIN HALF HALIGNED containing the DCB # to write
     1159       23                    to.  The DCB must be open and positioned to write the next record.
     1160       24                WS_FILE_RECORD_NUMBER - The number of the next record to be
     1161       25                    written to the workspace file (the first record is # 0).
     1162       26            INPUT:
     1163       27            OUTPUT:
     1164       28                WS_FILE_RECORD_NUMBER will be incremented once, for the single record
     1165       29                    written thru WS_FILE_DCB#.
     1166       30            DESCRIPTION:
     1167       31                Encode FILE_NODE and write it to the workspace file.
     1168       32        */
     1169       33
     1170       34        VDW$STOW_NODE: PROC (FILE_KEY, LOCATION, FILE_NODE, WS_FILE_DCB,

     34  3 000000   000000 700200 xent  VDW$STOW_NO* TSX0  ! X66_AUTO_5
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:195  
         3 000001   000072 000005                    ZERO    58,5

     1171       35                  WS_FILE_RECORD_NUMBER) ALTRET;
     1172       36
     1173       37        %INCLUDE CP_6;
     1174      118        %INCLUDE CP_6_SUBS;
     1175      658
     1176      659        %FPT_WRITE (FPTN=FPT_WRITE_CONTEXT_FILE);
     1177      690
     1178      691        %INCLUDE VD_MACROS_M;
     1179     2906        %INCLUDE VD_PERR_C;
     1180     3054
     1181     3055
     1182     3056        %VD$KEY (NAME=FILE_KEY, STCLASS=PARAM);
     1183     3070        %VD$LOCATION (NAME=LOCATION, STCLASS=PARAM);
     1184     3098        %VD$FILE_NODE (NAME=FILE_NODE, STCLASS=PARAM);
     1185     3191    1   DCL WS_FILE_DCB UBIN HALF HALIGNED;
     1186     3192    1   DCL WS_FILE_RECORD_NUMBER SBIN;
     1187     3193
     1188     3194
     1189     3195
     1190     3196    1   DCL VDG$OALLOC          ENTRY (3) ALTRET;
     1191     3197    1   DCL VDG$OFREE           ENTRY (1) ALTRET;
     1192     3198    1   DCL VDG$ESCREECH        ENTRY (3);
     1193     3199
     1194     3200
     1195     3201    1   DCL 1 B_VERSION CALIGNED SYMREF,
     1196     3202    1         2 LENGTH UBIN BYTE UNAL,
     1197     3203    1         2 TEXT CHAR(B_VERSION.LENGTH);
     1198     3204        %VD_6E (NAME=VD_6E, STCLASS=SYMREF);
     1199     3240        %VD_OBJECTS (NAME=VD_OBJECTS, STCLASS=SYMREF);
     1200     3280    1   DCL B$TCB$ PTR SYMREF;
     1201     3281
     1202     3282
     1203     3283    1   DCL BASED_ARRAY$ PTR;
     1204     3284    1   DCL BIGGER_ENCODED_NODE$ PTR;
     1205     3285    1   DCL ENCODED_NODE$ PTR;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:196  
     1206     3286    1   DCL ENCODED_NODE_SIZE UBIN;
     1207     3287    1   DCL I SBIN;
     1208     3288    1   DCL OBJECT_HEADER$ PTR;
     1209     3289    1   DCL OBJECT_LIMIT$ PTR;
     1210     3290    1   DCL OBJECT_NEXT$ PTR;
     1211     3291    1   DCL OBJECT_SIZE UBIN;
     1212     3292    1   DCL SUM SBIN;
     1213     3293    1   DCL VD_ERR$ PTR;
     1214     3294    1   DCL VD_NUMBER$ PTR;
     1215     3295
     1216     3296
     1217     3297    1   DCL BASED$ARRAY (0:0) SBIN BASED(BASED_ARRAY$);
     1218     3298    1   DCL BASED$OBJECT CHAR(OBJECT_SIZE) BASED;
     1219     3299    1   DCL BASED$SBIN SBIN BASED;
     1220     3300        %VD$OBJECT_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
     1221     3322        %VD$ENCODED_NODE (NAME=ENCODED$NODE, STCLASS="BASED(ENCODED_NODE$)");
     1222     3443        %VD$ENCODED_NODE (NAME=BIGGER_ENCODED$NODE,
     1223     3444            STCLASS="BASED(BIGGER_ENCODED_NODE$)");
     1224     3565        %VD$ERR (NAME=VD$ERR, STCLASS="BASED(VD_ERR$)");
     1225     3618        %VD$NUMBER (NAME=VD$NUMBER, DIM="(0:2)", STCLASS="BASED(VD_NUMBER$)");
     1226     3663        %VD$ENCODED_FILE_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
     1227     3692        %VD$KEY;
     1228     3706        %VD$TEXTC_REMOTE;
     1229     3767        %VD$NAME_SPEC;
     1230     3815        %VD$WINDOW_SPEC;
     1231     3881        %VD$PORT;
     1232     3979        %VD$BUFFER;
     1233     4037        %B$TCB (NAME=B$TCB, STCLASS="BASED(B$TCB$)");
     1234     4040        %B$ALT;
     1235     4048
     1236     4049
     1237     4050                /* Don't bother to save constants (read_only equals variables) */
     1238     4051    1           IF FILE_NODE.DESC.SPEC.TYPE# = %SPT_NAME_SPEC

   4051  3 000002   200005 470500                    LDP0    @FILE_NODE,,AUTO
         3 000003   000006 220100                    LDX0    6,,PR0
         3 000004   000003 100003                    CMPX0   3,DU
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:197  
         3 000005   000017 601000 3                  TNZ     s:4055
         3 000006   000007 471500                    LDP1    7,,PR0
         3 000007   100002 721100                    LXL1    2,,PR1
         3 000010   000001 101003                    CMPX1   1,DU
         3 000011   000017 601000 3                  TNZ     s:4055
         3 000012   000003 236100                    LDQ     3,,PR0
         3 000013   777000 376003                    ANQ     -512,DU
         3 000014   200000 116003                    CMPQ    65536,DU
         3 000015   000017 601000 3                  TNZ     s:4055

     1239     4052    1             AND FILE_NODE.DESC.SPEC.V$ -> VD$NAME_SPEC.DATA_TYPE# = %NDT_EQUALS
     1240     4053    1             AND FILE_NODE.ACCESS = %NAC_READ_BIT THEN
     1241     4054    1              RETURN;

   4054  3 000016   000000 702200 xent               TSX2  ! X66_ARET

     1242     4055    1           ENCODED_NODE_SIZE = 1024;  /* Start with 1K */

   4055  3 000017   002000 235007                    LDA     1024,DL
         3 000020   200013 755100                    STA     ENCODED_NODE_SIZE,,AUTO

     1243     4056    1           CALL VDG$OALLOC (%CLS_ENCODED_NODE, ENCODED_NODE$, ENCODED_NODE_SIZE)

   4056  3 000021   200013 631500                    EPPR1   ENCODED_NODE_SIZE,,AUTO
         3 000022   200066 451500                    STP1    @INDX+3,,AUTO
         3 000023   200012 633500                    EPPR3   ENCODED_NODE$,,AUTO
         3 000024   200065 453500                    STP3    @INDX+2,,AUTO
         3 000025   000000 236000 4                  LDQ     0
         3 000026   200064 756100                    STQ     @INDX+1,,AUTO
         3 000027   200064 630500                    EPPR0   @INDX+1,,AUTO
         3 000030   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000031   000000 701000 xent               TSX1    VDG$OALLOC
         3 000032   000332 702000 3                  TSX2    OALLOC_FAILED

     1244     4057    1             ALTRET (OALLOC_FAILED);
     1245     4058    1           ENCODED$NODE.RECORD_ID = %CHR_ENCODED_RECID;

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:198  
   4058  3 000033   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000034   040100 100400                    MLR     fill='040'O
         3 000035   000000 000015 2                  ADSC9   0                        cn=0,n=13
         3 000036   000002 400015                    ADSC9   2,,PR0                   cn=2,n=13

     1246     4059    1           ENCODED$NODE.RECORD_VERSION = B_VERSION.TEXT;

   4059  3 000037   000000 236000 xsym               LDQ     B_VERSION
         3 000040   000033 772000                    QRL     27
         3 000041   000000 620006                    EAX0    0,QL
         3 000042   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000043   040100 100440                    MLR     fill='040'O
         3 000044   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         3 000045   000005 600006                    ADSC9   5,,PR0                   cn=3,n=6

     1247     4060    1           ENCODED$NODE.RECORD_NUM# = WS_FILE_RECORD_NUMBER;

   4060  3 000046   200007 470500                    LDP0    @WS_FILE_RECORD_NUMBER,,AUTO
         3 000047   200012 471500                    LDP1    ENCODED_NODE$,,AUTO
         3 000050   000000 235100                    LDA     0,,PR0
         3 000051   100011 755100                    STA     9,,PR1

     1248     4061    1           ENCODED$NODE.DESC.FILE_KEY = FILE_KEY;

   4061  3 000052   200003 471500                    LDP1    @FILE_KEY,,AUTO
         3 000053   200012 473500                    LDP3    ENCODED_NODE$,,AUTO
         3 000054   000100 100500                    MLR     fill='000'O
         3 000055   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         3 000056   300012 000010                    ADSC9   10,,PR3                  cn=0,n=8

     1249     4062    1           ENCODED$NODE.DESC.LOCATION = LOCATION;

   4062  3 000057   200004 473500                    LDP3    @LOCATION,,AUTO
         3 000060   200012 474500                    LDP4    ENCODED_NODE$,,AUTO
         3 000061   000100 100500                    MLR     fill='000'O
         3 000062   300000 000044                    ADSC9   0,,PR3                   cn=0,n=36
         3 000063   400014 000044                    ADSC9   12,,PR4                  cn=0,n=36
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:199  

     1250     4063    1           ENCODED$NODE.DESC.ACCESS = FILE_NODE.ACCESS;

   4063  3 000064   200005 475500                    LDP5    @FILE_NODE,,AUTO
         3 000065   500003 236100                    LDQ     3,,PR5
         3 000066   400025 552140                    STBQ    21,'40'O,PR4

     1251     4064    1           ENCODED$NODE.DESC.SPEC = FILE_NODE.DESC.SPEC;

   4064  3 000067   000100 100500                    MLR     fill='000'O
         3 000070   500006 000010                    ADSC9   6,,PR5                   cn=0,n=8
         3 000071   400026 000010                    ADSC9   22,,PR4                  cn=0,n=8

     1252     4065    1           ENCODED$NODE.DESC.DATA$ = FILE_NODE.DESC.DATA$;

   4065  3 000072   500010 236100                    LDQ     8,,PR5
         3 000073   400030 756100                    STQ     24,,PR4

     1253     4066
     1254     4067    1           IF FILE_KEY = %CLEAR AND LOCATION = %CLEAR

   4067  3 000074   000000 106500                    CMPC    fill='000'O
         3 000075   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         3 000076   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         3 000077   000133 601000 3                  TNZ     s:4084
         3 000100   000000 106500                    CMPC    fill='000'O
         3 000101   300000 000044                    ADSC9   0,,PR3                   cn=0,n=36
         3 000102   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         3 000103   000133 601000 3                  TNZ     s:4084
         3 000104   500006 221100                    LDX1    6,,PR5
         3 000105   000010 101003                    CMPX1   8,DU
         3 000106   000133 601000 3                  TNZ     s:4084
         3 000107   500010 236100                    LDQ     8,,PR5
         3 000110   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000111   000133 601000 3                  TNZ     s:4084
         3 000112   000000 235100                    LDA     0,,PR0
         3 000113   000133 601000 3                  TNZ     s:4084
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:200  

     1255     4068    1             AND FILE_NODE.DESC.SPEC.TYPE# = %SPT_ENCODED_FILE_SPEC
     1256     4069    1             AND FILE_NODE.DESC.DATA$ = ADDR(NIL)
     1257     4070    1             AND WS_FILE_RECORD_NUMBER = 0 THEN
     1258     4071    2   STOW_HEADER_RECORD: DO;

   4071  3 000114                       STOW_HEADER* null
     1259     4072                   /*
     1260     4073                   *  Spec component isn't a real object (no object header), so
     1261     4074                   *    we can't call INDEXIZE_xxx to build the record.
     1262     4075                   */
     1263     4076    2              OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));

   4076  3 000114   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000115   000031 036003                    ADLQ    25,DU
         3 000116   200015 756100                    STQ     OBJECT_HEADER$,,AUTO

     1264     4077    2              VD$ENCODED_FILE_SPEC = FILE_NODE.DESC.SPEC.V$->VD$ENCODED_FILE_SPEC;

   4077  3 000117   500007 476500                    LDP6    7,,PR5
         3 000120   200015 477500                    LDP7    OBJECT_HEADER$,,AUTO
         3 000121   000100 100500                    MLR     fill='000'O
         3 000122   600000 000040                    ADSC9   0,,PR6                   cn=0,n=32
         3 000123   700000 000040                    ADSC9   0,,PR7                   cn=0,n=32

     1265     4078    2              ADDR(ENCODED$NODE.DESC.SPEC.V$)->BASED$SBIN = SIZEW(ENCODED$NODE);

   4078  3 000124   000031 235007                    LDA     25,DL
         3 000125   200012 474500                    LDP4    ENCODED_NODE$,,AUTO
         3 000126   400027 755100                    STA     23,,PR4

     1266     4079    2              ADDR(ENCODED$NODE.DESC.DATA$)->BASED$SBIN = 0;

   4079  3 000127   400030 450100                    STZ     24,,PR4

     1267     4080                   /* VD$ENCODED_FILE_SPEC contains no pointers, so we're done */
     1268     4081    2              OBJECT_NEXT$ = PINCRW(OBJECT_HEADER$, SIZEW(VD$ENCODED_FILE_SPEC));
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:201  

   4081  3 000130   000010 036003                    ADLQ    8,DU
         3 000131   200017 756100                    STQ     OBJECT_NEXT$,,AUTO

     1269     4082    2              END STOW_HEADER_RECORD;

   4082  3 000132   000135 710000 3                  TRA     s:4088

     1270     4083    2           ELSE DO;

     1271     4084    2              CALL INDEXIZE_RECORD

   4084  3 000133   000333 701000 3                  TSX1    INDEXIZE_RECORD
         3 000134   000254 702000 3                  TSX2    INDEXIZE_RECORD_FAILED

     1272     4085    2                ALTRET (INDEXIZE_RECORD_FAILED);
     1273     4086    2              END;

     1274     4087
     1275     4088    1           ENCODED$NODE.LENGTH# = POFFC(OBJECT_NEXT$,

   4088  3 000135   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000136   000001 036000 4                  ADLQ    1
         3 000137   000020 772000                    QRL     16
         3 000140   200064 756100                    STQ     @INDX+1,,AUTO
         3 000141   200017 236100                    LDQ     OBJECT_NEXT$,,AUTO
         3 000142   000020 772000                    QRL     16
         3 000143   200064 136100                    SBLQ    @INDX+1,,AUTO
         3 000144   000000 620006                    EAX0    0,QL
         3 000145   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000146   000002 740100                    STX0    2,,PR0

     1276     4089    1             ADDR(ENCODED_NODE$->VD$BUFFER.BYTES));
     1277     4090
     1278     4091    1           SUM = 0;

   4091  3 000147   200021 450100                    STZ     SUM,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:202  

     1279     4092    1           BASED_ARRAY$ = PINCRW(ADDR(ENCODED$NODE.CHECKSUM#), 1);

   4092  3 000150   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000151   000011 036003                    ADLQ    9,DU
         3 000152   200010 756100                    STQ     BASED_ARRAY$,,AUTO

     1280     4093    1           DO I =
     1281     4094    1             ((ENCODED$NODE.LENGTH# - POFFC(BASED_ARRAY$, ENCODED_NODE$)) /
     1282     4095    2             %NB_PER_WORD) DOWNTO 0;

   4095  3 000153   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000154   000020 772000                    QRL     16
         3 000155   200064 756100                    STQ     @INDX+1,,AUTO
         3 000156   200010 236100                    LDQ     BASED_ARRAY$,,AUTO
         3 000157   000020 772000                    QRL     16
         3 000160   200064 136100                    SBLQ    @INDX+1,,AUTO
         3 000161   200065 756100                    STQ     @INDX+2,,AUTO
         3 000162   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000163   000002 236100                    LDQ     2,,PR0
         3 000164   000022 732000                    QRS     18
         3 000165   200065 136100                    SBLQ    @INDX+2,,AUTO
         3 000166   000004 506007                    DIV     4,DL
         3 000167   200014 756100                    STQ     I,,AUTO
         3 000170   000200 710000 3                  TRA     s:4097+2

     1283     4096    2              SUM = SUM + BASED$ARRAY (I);

   4096  3 000171   200010 470500                    LDP0    BASED_ARRAY$,,AUTO
         3 000172   200014 720100                    LXL0    I,,AUTO
         3 000173   200021 236100                    LDQ     SUM,,AUTO
         3 000174   000000 036110                    ADLQ    0,X0,PR0
         3 000175   200021 756100                    STQ     SUM,,AUTO

     1284     4097    2              END;

   4097  3 000176   000001 336007                    LCQ     1,DL
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:203  
         3 000177   200014 056100                    ASQ     I,,AUTO
         3 000200   200014 235100                    LDA     I,,AUTO
         3 000201   000171 605000 3                  TPL     s:4096

     1285     4098    1           ENCODED$NODE.CHECKSUM# = SUM;

   4098  3 000202   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000203   200021 236100                    LDQ     SUM,,AUTO
         3 000204   000010 756100                    STQ     8,,PR0

     1286     4099
     1287     4100    1           FPT_WRITE_CONTEXT_FILE.V.DCB# = WS_FILE_DCB;

   4100  3 000205   200006 470500                    LDP0    @WS_FILE_DCB,,AUTO
         3 000206   000000 100500                    MLR     fill='000'O
         3 000207   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 000210   000010 000002 1                  ADSC9   FPT_WRITE_CONTEXT_FILE+8 cn=0,n=2

     1288     4101    1           FPT_WRITE_CONTEXT_FILE.BUF_.BUF$ = ADDR(ENCODED_NODE$ ->

   4101  3 000211   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000212   000001 036000 4                  ADLQ    1
         3 000213   000005 756000 1                  STQ     FPT_WRITE_CONTEXT_FILE+5

     1289     4102    1             VD$BUFFER.BYTES);
     1290     4103    1           FPT_WRITE_CONTEXT_FILE.BUF_.BOUND = POFFC(OBJECT_NEXT$,

   4103  3 000214   000005 236000 1                  LDQ     FPT_WRITE_CONTEXT_FILE+5
         3 000215   000020 772000                    QRL     16
         3 000216   200064 756100                    STQ     @INDX+1,,AUTO
         3 000217   200017 236100                    LDQ     OBJECT_NEXT$,,AUTO
         3 000220   000020 772000                    QRL     16
         3 000221   200064 136100                    SBLQ    @INDX+1,,AUTO
         3 000222   000001 136007                    SBLQ    1,DL
         3 000223   000020 736000                    QLS     16
         3 000224   000004 676000 1                  ERQ     FPT_WRITE_CONTEXT_FILE+4
         3 000225   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:204  
         3 000226   000004 656000 1                  ERSQ    FPT_WRITE_CONTEXT_FILE+4

     1291     4104    1             FPT_WRITE_CONTEXT_FILE.BUF_.BUF$)
     1292     4105    1             - 1;
     1293     4106
     1294     4107    1           CALL M$WRITE (FPT_WRITE_CONTEXT_FILE)

   4107  3 000227   000000 630400 1                  EPPR0   FPT_WRITE_CONTEXT_FILE
         3 000230   440001 713400                    CLIMB   alt,write
         3 000231   401400 401760                    pmme    nvectors=4
         3 000232   000273 702000 3                  TSX2    WRITE_CONTEXT_FILE_FAILED

     1295     4108    1             ALTRET (WRITE_CONTEXT_FILE_FAILED);
     1296     4109
     1297     4110    1           ENCODED$NODE.FLINK$ = ADDR(NIL);

   4110  3 000233   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000234   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000235   000001 756100                    STQ     1,,PR0

     1298     4111    1           ENCODED$NODE.DESC = %CLEAR;

   4111  3 000236   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000237   000100 100400                    MLR     fill='000'O
         3 000240   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000241   000012 000074                    ADSC9   10,,PR0                  cn=0,n=60

     1299     4112    1           ENCODED$NODE.DESC.DATA$ = ADDR(NIL);

   4112  3 000242   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000243   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000244   000030 756100                    STQ     24,,PR0

     1300     4113
     1301     4114    1           CALL VDG$OFREE (ENCODED$NODE)

   4114  3 000245   200012 630500                    EPPR0   ENCODED_NODE$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:205  
         3 000246   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000247   000000 701000 xent               TSX1    VDG$OFREE
         3 000250   000332 702000 3                  TSX2    OALLOC_FAILED

     1302     4115    1             ALTRET (OFREE_FAILED);
     1303     4116
     1304     4117    1           WS_FILE_RECORD_NUMBER = WS_FILE_RECORD_NUMBER + 1;

   4117  3 000251   200007 470500                    LDP0    @WS_FILE_RECORD_NUMBER,,AUTO
         3 000252   000000 054100                    AOS     0,,PR0

     1305     4118
     1306     4119    1           RETURN;

   4119  3 000253   000000 702200 xent               TSX2  ! X66_ARET

     1307     4120
     1308     4121
     1309     4122
     1310     4123    1   INDEXIZE_RECORD_FAILED:
     1311     4124        /*??*   CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)         *??*/
     1312     4125        /*??*     ALTRET (OALLOC_FAILED);                   *??*/
     1313     4126        /*??*   VD$ERR.ERR.CODE# = ??????                   *??*/
     1314     4127        /*??*   VD$ERR.FLAGLEV# = ??????                    *??*/
     1315     4128        /*??*   VD_NUMBER$ = PINCRW(VD_ERR$, SIZEW(VD$ERR));*??*/
     1316     4129        /*??*   VD$NUMBER.OBJECT.CLASS# (1) = %CLS_NUMBER;  *??*/
     1317     4130        /*??*   VD$NUMBER.V# (1) = WS_FILE_RECORD_NUMBER;   *??*/
     1318     4131
     1319     4132    1           ENCODED$NODE.FLINK$ = ADDR(NIL);

   4132  3 000254   000001 236000 xsym  INDEXIZE_RE* LDQ     B_VECTNIL+1
         3 000255   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000256   000001 756100                    STQ     1,,PR0

     1320     4133    1           ENCODED$NODE.DESC = %CLEAR;

   4133  3 000257   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:206  
         3 000260   000100 100400                    MLR     fill='000'O
         3 000261   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000262   000012 000074                    ADSC9   10,,PR0                  cn=0,n=60

     1321     4134    1           ENCODED$NODE.DESC.DATA$ = ADDR(NIL);

   4134  3 000263   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000264   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000265   000030 756100                    STQ     24,,PR0

     1322     4135    1           CALL VDG$OFREE (ENCODED$NODE)

   4135  3 000266   200012 630500                    EPPR0   ENCODED_NODE$,,AUTO
         3 000267   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000270   000000 701000 xent               TSX1    VDG$OFREE
         3 000271   000332 702000 3                  TSX2    OALLOC_FAILED

     1323     4136    1             ALTRET (OFREE_FAILED);
     1324     4137    1           ALTRETURN;

   4137  3 000272   000000 702200 xent               TSX2  ! X66_AALT

     1325     4138
     1326     4139
     1327     4140    1   WRITE_CONTEXT_FILE_FAILED:
     1328     4141    1           CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)

   4141  3 000273   200022 630500       WRITE_CONTE* EPPR0   VD_ERR$,,AUTO
         3 000274   200065 450500                    STP0    @INDX+2,,AUTO
         3 000275   000002 236000 4                  LDQ     2
         3 000276   200064 756100                    STQ     @INDX+1,,AUTO
         3 000277   200064 630500                    EPPR0   @INDX+1,,AUTO
         3 000300   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000301   000000 701000 xent               TSX1    VDG$OALLOC
         3 000302   000332 702000 3                  TSX2    OALLOC_FAILED

     1329     4142    1             ALTRET (OALLOC_FAILED);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:207  
     1330     4143    1           VD$ERR.ERR = B$TCB.ALT$->B$ALT.ERR;

   4143  3 000303   000000 470400 xsym               LDP0    B$TCB$
         3 000304   000000 471500                    LDP1    0,,PR0
         3 000305   100102 236100                    LDQ     66,,PR1
         3 000306   200022 473500                    LDP3    VD_ERR$,,AUTO
         3 000307   300002 756100                    STQ     2,,PR3

     1331     4144    1           VD$ERR.FLAGLEV# = %FLV_SERIOUS;

   4144  3 000310   000003 220003                    LDX0    3,DU
         3 000311   200022 471500                    LDP1    VD_ERR$,,AUTO
         3 000312   100003 740100                    STX0    3,,PR1

     1332     4145
     1333     4146    1           ENCODED$NODE.FLINK$ = ADDR(NIL);

   4146  3 000313   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000314   200012 471500                    LDP1    ENCODED_NODE$,,AUTO
         3 000315   100001 756100                    STQ     1,,PR1

     1334     4147    1           ENCODED$NODE.DESC = %CLEAR;

   4147  3 000316   200012 471500                    LDP1    ENCODED_NODE$,,AUTO
         3 000317   000100 100400                    MLR     fill='000'O
         3 000320   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000321   100012 000074                    ADSC9   10,,PR1                  cn=0,n=60

     1335     4148    1           ENCODED$NODE.DESC.DATA$ = ADDR(NIL);

   4148  3 000322   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000323   200012 471500                    LDP1    ENCODED_NODE$,,AUTO
         3 000324   100030 756100                    STQ     24,,PR1

     1336     4149    1           CALL VDG$OFREE (ENCODED$NODE)

   4149  3 000325   200012 630500                    EPPR0   ENCODED_NODE$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:208  
         3 000326   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000327   000000 701000 xent               TSX1    VDG$OFREE
         3 000330   000332 702000 3                  TSX2    OALLOC_FAILED

     1337     4150    1             ALTRET (OFREE_FAILED);
     1338     4151    1           ALTRETURN;

   4151  3 000331   000000 702200 xent               TSX2  ! X66_AALT

   4148  3 000332                       OALLOC_FAIL* null
     1339     4152
     1340     4153
     1341     4154    1   OALLOC_FAILED: ;
     1342     4155    1   OFREE_FAILED:
     1343     4156    1           ALTRETURN;

   4156  3 000332   000000 702200 xent  OFREE_FAILED TSX2  ! X66_AALT

     1344     4157
     1345     4158        %BOX (TITLE=INDEXIZE_RECORD, PAGE=YES);
              4166    1
              4170    1   /***************************************************************************
              4172    1    *                                                                         *
              4176    1            *                              INDEXIZE_RECORD                           *
              4178    1            *                                                                        *
              4180    1          ***************************************************************************/

     1346     4184
     1347     4185        /*I* NAME: INDEXIZE_RECORD
     1348     4186            PARAMETERS:
     1349     4187                None.
     1350     4188            INPUT:
     1351     4189                ENCODED$NODE is the VD$ENCODED_NODE for the workspace-file record.
     1352     4190            OUTPUT:
     1353     4191                ENCODED$NODE's pointers will be converted to relative indexes.
     1354     4192                VD_ERR$ - If an error in the record is found, VD_ERR$ will
     1355     4193                    point to the allocated VD$ERR for the error.  It's
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:209  
     1356     4194                    first substitution field will contain the %CLS_ code for
     1357     4195                    the object in error, as a CLS_NUMBER.
     1358     4196            DESCRIPTION:
     1359     4197                Loop thru the objects in ENCODED$NODE; in these objects, all
     1360     4198                pointers will be stored in the file as indexes into
     1361     4199                the record of the object pointed-to.  Find these word
     1362     4200                pointers, and replace them with indexes to the objects in
     1363     4201                the workspace record.
     1364     4202                The "tree" pointers to be worried about are FLINK$ and "CHILD$"
     1365     4203                (e.g., .FLINK$ and .MOVEMENTS$ for VD$IT_ADJUST).
     1366     4204                The other "tree" pointers (PARENT$, BLINK$, and TAIL$) are
     1367     4205                zeroed in the saved record (will be NIL at VDW$LOAD time):
     1368     4206                they're rebuilt by VDA$LWRITE when the record is written to
     1369     4207                the appropriate file.
     1370     4208        */
     1371     4209
     1372     4210    1   INDEXIZE_RECORD: PROC ALTRET;

   4210  3 000333   200024 741300       INDEXIZE_RE* STX1  ! VD_NUMBER$+1,,AUTO

     1373     4211
     1374     4212
     1375     4213        %VD$WINDOW_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
     1376     4279        %VD$WINDOW_BLOCK (STCLASS="BASED(OBJECT_HEADER$)");
     1377     4316        %VD$RECORD_SET (STCLASS="BASED(OBJECT_HEADER$)");
     1378     4394        %VD$STRUCTURE_SPEC (STCLASS="BASED(OBJECT_HEADER$)");
     1379     4431        %VD$IT_ADJUST (STCLASS="BASED(OBJECT_HEADER$)");
     1380     4468        %VD$IT_BLOCK_EXPR (STCLASS="BASED(OBJECT_HEADER$)");
     1381     4618        %VD$IT_COMMAND (STCLASS="BASED(OBJECT_HEADER$)");
     1382     4656        %VD$IT_OPERAND (STCLASS="BASED(OBJECT_HEADER$)");
     1383     4722        %VD$IT_OPERATOR (STCLASS="BASED(OBJECT_HEADER$)");
     1384     4759        %VD$IT_SELECT (STCLASS="BASED(OBJECT_HEADER$)");
     1385     4796        %VD$BLOCK_DESC (STCLASS="BASED(OBJECT_HEADER$)");
     1386     4943        %VD$BUFFER (STCLASS="BASED(OBJECT_HEADER$)");
     1387     5001        %VD$BUFFER_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
     1388     5037        %VD$STRING_HEADER (STCLASS="BASED(OBJECT_HEADER$)");
     1389     5073        %VD$PATTERN (STCLASS="BASED(OBJECT_HEADER$)");
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:210  
     1390     5124        %VD$EVAL (STCLASS="BASED(OBJECT_HEADER$)");
     1391     5369        %VD$FIT (STCLASS="BASED(OBJECT_HEADER$)");
     1392     5405        %VD$POINTER (STCLASS="BASED(OBJECT_HEADER$)");
     1393     5450
     1394     5451
     1395     5452
     1396     5453    2           OBJECT_HEADER$ = PINCRW(ENCODED_NODE$, SIZEW(ENCODED$NODE));

   5453  3 000334   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000335   000031 036003                    ADLQ    25,DU
         3 000336   200015 756100                    STQ     OBJECT_HEADER$,,AUTO

     1397     5454    2           OBJECT_NEXT$ = OBJECT_HEADER$;

   5454  3 000337   200017 756100                    STQ     OBJECT_NEXT$,,AUTO

     1398     5455
     1399     5456    3           IF ENCODED$NODE.DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;

   5456  3 000340   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000341   000012 720100                    LXL0    10,,PR0
         3 000342   000002 100003                    CMPX0   2,DU
         3 000343   000351 601000 3                  TNZ     s:5459

     1400     5457    3              CALL INDEXIZE (ENCODED$NODE.DESC.FILE_KEY.V$) ALTRET (INDEXIZE_FAILURE);

   5457  3 000344   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000345   000013 036003                    ADLQ    11,DU
         3 000346   200063 756100                    STQ     LVL+27,,AUTO
         3 000347   001434 701000 3                  TSX1    INDEXIZE
         3 000350   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1401     5458    3              END;

     1402     5459    2           CALL INDEXIZE_LOCATION (ENCODED$NODE.DESC.LOCATION);

   5459  3 000351   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:211  
         3 000352   000014 036003                    ADLQ    12,DU
         3 000353   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 000354   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 000355   000000 011000                    NOP     0

     1403     5460    3           IF ENCODED$NODE.DESC.SPEC.REP# = %REP_REMOTE THEN DO;

   5460  3 000356   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 000357   000026 720100                    LXL0    22,,PR0
         3 000360   000002 100003                    CMPX0   2,DU
         3 000361   000367 601000 3                  TNZ     s:5463

     1404     5461    3              CALL INDEXIZE (ENCODED$NODE.DESC.SPEC.V$) ALTRET (INDEXIZE_FAILURE);

   5461  3 000362   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000363   000027 036003                    ADLQ    23,DU
         3 000364   200063 756100                    STQ     LVL+27,,AUTO
         3 000365   001434 701000 3                  TSX1    INDEXIZE
         3 000366   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1405     5462    3              END;

     1406     5463    2           CALL INDEXIZE (ENCODED$NODE.DESC.DATA$) ALTRET (INDEXIZE_FAILURE);

   5463  3 000367   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 000370   000030 036003                    ADLQ    24,DU
         3 000371   200063 756100                    STQ     LVL+27,,AUTO
         3 000372   001434 701000 3                  TSX1    INDEXIZE
         3 000373   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1407     5464
     1408     5465
     1409     5466    2   EACH_OBJECT:
     1410     5467    3           DO WHILE (POFFW(OBJECT_NEXT$, OBJECT_HEADER$) > 0);

   5467  3 000374   001303 710000 3     EACH_OBJECT  TRA     s:5631

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:212  
     1411     5468
     1412     5469    3   OBJECT_TYPE_CASES:
     1413     5470    4              DO CASE (VD$OBJECT_HEADER.CLASS#);

   5470  3 000375   200015 470500       OBJECT_TYPE* LDP0    OBJECT_HEADER$,,AUTO
         3 000376   000000 220100                    LDX0    0,,PR0
         3 000377   000060 100003                    CMPX0   48,DU
         3 000400   000402 602010 3                  TNC     OBJECT_TYPE_CASES+5,X0
         3 000401   001265 710000 3                  TRA     s:5621
         3 000402   001265 710000 3                  TRA     s:5621
         3 000403   001036 710000 3                  TRA     s:5564
         3 000404   001036 710000 3                  TRA     s:5564
         3 000405   000470 710000 3                  TRA     s:5479
         3 000406   000470 710000 3                  TRA     s:5479
         3 000407   001265 710000 3                  TRA     s:5621
         3 000410   000470 710000 3                  TRA     s:5479
         3 000411   000470 710000 3                  TRA     s:5479
         3 000412   001265 710000 3                  TRA     s:5621
         3 000413   001265 710000 3                  TRA     s:5621
         3 000414   001265 710000 3                  TRA     s:5621
         3 000415   001134 710000 3                  TRA     s:5584
         3 000416   001265 710000 3                  TRA     s:5621
         3 000417   000470 710000 3                  TRA     s:5479
         3 000420   000462 710000 3                  TRA     s:5474
         3 000421   001265 710000 3                  TRA     s:5621
         3 000422   000470 710000 3                  TRA     s:5479
         3 000423   001164 710000 3                  TRA     s:5596
         3 000424   000636 710000 3                  TRA     s:5517
         3 000425   000654 710000 3                  TRA     s:5523
         3 000426   000726 710000 3                  TRA     s:5537
         3 000427   000752 710000 3                  TRA     s:5544
         3 000430   000777 710000 3                  TRA     s:5552
         3 000431   001020 710000 3                  TRA     s:5558
         3 000432   000470 710000 3                  TRA     s:5479
         3 000433   000470 710000 3                  TRA     s:5479
         3 000434   000462 710000 3                  TRA     s:5474
         3 000435   000470 710000 3                  TRA     s:5479
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:213  
         3 000436   000470 710000 3                  TRA     s:5479
         3 000437   001114 710000 3                  TRA     s:5579
         3 000440   000470 710000 3                  TRA     s:5479
         3 000441   001265 710000 3                  TRA     s:5621
         3 000442   001252 710000 3                  TRA     s:5615
         3 000443   001177 710000 3                  TRA     s:5600
         3 000444   001252 710000 3                  TRA     s:5615
         3 000445   001212 710000 3                  TRA     s:5604
         3 000446   001265 710000 3                  TRA     s:5621
         3 000447   001265 710000 3                  TRA     s:5621
         3 000450   000570 710000 3                  TRA     s:5505
         3 000451   001265 710000 3                  TRA     s:5621
         3 000452   000462 710000 3                  TRA     s:5474
         3 000453   000616 710000 3                  TRA     s:5512
         3 000454   001265 710000 3                  TRA     s:5621
         3 000455   000462 710000 3                  TRA     s:5474
         3 000456   000550 710000 3                  TRA     s:5500
         3 000457   000476 710000 3                  TRA     s:5488
         3 000460   001265 710000 3                  TRA     s:5621
         3 000461   000470 710000 3                  TRA     s:5479

     1414     5471
     1415     5472    4               CASE (%CLS_TEXTC_REMOTE, %CLS_FILE_KEY, %CLS_NAME_SPEC,

     1416     5473    4                %CLS_STRUCTURE_LEVEL);
     1417     5474    4                 CALL INDEXIZE (VD$STRING_HEADER.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5474  3 000462   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000463   000001 036003                    ADLQ    1,DU
         3 000464   200063 756100                    STQ     LVL+27,,AUTO
         3 000465   001434 701000 3                  TSX1    INDEXIZE
         3 000466   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 000467   001266 710000 3                  TRA     s:5625

     1418     5475
     1419     5476    4               CASE (%CLS_BUFFER, %CLS_NUMBER, %CLS_BOOLEAN, %CLS_FILE_STCLASS,

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:214  
     1420     5477    4                   %CLS_ORG, %CLS_KEY_TYPE, %CLS_EXIST, %CLS_NAME_DATA_TYPE,
     1421     5478    4                   %CLS_COMPONENT, %CLS_POINT, %CLS_DIRECTION, %CLS_PROTECT);
     1422     5479    4                 CALL INDEXIZE (VD$BUFFER_HEADER.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5479  3 000470   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000471   000001 036003                    ADLQ    1,DU
         3 000472   200063 756100                    STQ     LVL+27,,AUTO
         3 000473   001434 701000 3                  TSX1    INDEXIZE
         3 000474   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 000475   001266 710000 3                  TRA     s:5625

     1423     5480
     1424     5481    4               CASE (%CLS_WINDOW_SPEC);

     1425     5482                      /*
     1426     5483                      * When saving VD$WINDOW_SPECs:
     1427     5484                      * o set .DCB# to 0;
     1428     5485                      * o don't save the .OPERAND.STREAM;
     1429     5486                      * o don't save the .RECORD_SET.
     1430     5487                      */
     1431     5488    4                 VD$WINDOW_SPEC.DCB# = 0;

   5488  3 000476   000000 221003                    LDX1    0,DU
         3 000477   000014 441100                    SXL1    12,,PR0

     1432     5489    4                 CALL INDEXIZE (VD$WINDOW_SPEC.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5489  3 000500   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000501   000001 036003                    ADLQ    1,DU
         3 000502   200063 756100                    STQ     LVL+27,,AUTO
         3 000503   001434 701000 3                  TSX1    INDEXIZE
         3 000504   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1433     5490    4                 ADDR(VD$WINDOW_SPEC.OPERAND.STREAM$)->BASED$SBIN = 0;

   5490  3 000505   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000506   000010 450100                    STZ     8,,PR0
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:215  

     1434     5491    4                 CALL INDEXIZE (VD$WINDOW_SPEC.OPERAND.INTREE$) ALTRET (
              5491                          INDEXIZE_FAILURE);

   5491  3 000507   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000510   000011 036003                    ADLQ    9,DU
         3 000511   200063 756100                    STQ     LVL+27,,AUTO
         3 000512   001434 701000 3                  TSX1    INDEXIZE
         3 000513   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1435     5492    4                 CALL INDEXIZE (VD$WINDOW_SPEC.OPERAND.EDIT_BLOCK$) ALTRET (
              5492                          INDEXIZE_FAILURE);

   5492  3 000514   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000515   000012 036003                    ADLQ    10,DU
         3 000516   200063 756100                    STQ     LVL+27,,AUTO
         3 000517   001434 701000 3                  TSX1    INDEXIZE
         3 000520   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1436     5493    4                CALL INDEXIZE (VD$WINDOW_SPEC.OPERAND.EVAL$) ALTRET (INDEXIZE_FAILURE)
              5493                          ;

   5493  3 000521   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000522   000013 036003                    ADLQ    11,DU
         3 000523   200063 756100                    STQ     LVL+27,,AUTO
         3 000524   001434 701000 3                  TSX1    INDEXIZE
         3 000525   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1437     5494    4                 ADDR(VD$WINDOW_SPEC.RECORD_SET$)->BASED$SBIN = 0;

   5494  3 000526   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000527   000016 450100                    STZ     14,,PR0

     1438     5495    4                 CALL INDEXIZE (VD$WINDOW_SPEC.KEY_DEFINITION_BUFFER$) ALTRET (
              5495                          INDEXIZE_FAILURE);

   5495  3 000530   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:216  
         3 000531   000030 036003                    ADLQ    24,DU
         3 000532   200063 756100                    STQ     LVL+27,,AUTO
         3 000533   001434 701000 3                  TSX1    INDEXIZE
         3 000534   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1439     5496    4                 CALL INDEXIZE (VD$WINDOW_SPEC.EOFMARK$) ALTRET (INDEXIZE_FAILURE);

   5496  3 000535   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000536   000025 036003                    ADLQ    21,DU
         3 000537   200063 756100                    STQ     LVL+27,,AUTO
         3 000540   001434 701000 3                  TSX1    INDEXIZE
         3 000541   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1440     5497    4                 CALL INDEXIZE (VD$WINDOW_SPEC.TABS$) ALTRET (INDEXIZE_FAILURE);

   5497  3 000542   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000543   000024 036003                    ADLQ    20,DU
         3 000544   200063 756100                    STQ     LVL+27,,AUTO
         3 000545   001434 701000 3                  TSX1    INDEXIZE
         3 000546   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 000547   001266 710000 3                  TRA     s:5625

     1441     5498
     1442     5499    4               CASE (%CLS_WINDOW_BLOCK);

     1443     5500    4                 CALL INDEXIZE (VD$WINDOW_BLOCK.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5500  3 000550   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000551   000001 036003                    ADLQ    1,DU
         3 000552   200063 756100                    STQ     LVL+27,,AUTO
         3 000553   001434 701000 3                  TSX1    INDEXIZE
         3 000554   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1444     5501    4                CALL INDEXIZE (VD$WINDOW_BLOCK.EDIT_BLOCK$) ALTRET (INDEXIZE_FAILURE);

   5501  3 000555   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000556   000003 036003                    ADLQ    3,DU
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:217  
         3 000557   200063 756100                    STQ     LVL+27,,AUTO
         3 000560   001434 701000 3                  TSX1    INDEXIZE
         3 000561   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1445     5502    4                 CALL INDEXIZE (VD$WINDOW_BLOCK.EVAL$) ALTRET (INDEXIZE_FAILURE);

   5502  3 000562   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000563   000004 036003                    ADLQ    4,DU
         3 000564   200063 756100                    STQ     LVL+27,,AUTO
         3 000565   001434 701000 3                  TSX1    INDEXIZE
         3 000566   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 000567   001266 710000 3                  TRA     s:5625

     1446     5503
     1447     5504    4               CASE (%CLS_RECORD_SET);

     1448     5505    5                 DO I = 0 TO (VD$RECORD_SET.N_ENTRIES# - 1);

   5505  3 000570   200014 450100                    STZ     I,,AUTO
         3 000571   000610 710000 3                  TRA     s:5509+1

     1449     5506    6                    IF VD$RECORD_SET.DESC.KEY.REP# (I) = %REP_REMOTE THEN DO;

   5506  3 000572   200014 236100                    LDQ     I,,AUTO
         3 000573   000006 402007                    MPY     6,DL
         3 000574   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000575   000003 720106                    LXL0    3,QL,PR0
         3 000576   000002 100003                    CMPX0   2,DU
         3 000577   000607 601000 3                  TNZ     s:5509

     1450     5507    6                       CALL INDEXIZE (VD$RECORD_SET.DESC.KEY.V$ (I)) ALTRET (
              5507                                INDEXIZE_FAILURE);

   5507  3 000600   200014 236100                    LDQ     I,,AUTO
         3 000601   000006 402003                    MPY     6,DU
         3 000602   000004 036003                    ADLQ    4,DU
         3 000603   200015 036100                    ADLQ    OBJECT_HEADER$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:218  
         3 000604   200063 756100                    STQ     LVL+27,,AUTO
         3 000605   001434 701000 3                  TSX1    INDEXIZE
         3 000606   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1451     5508    6                       END;

     1452     5509    5                    END;

   5509  3 000607   200014 054100                    AOS     I,,AUTO
         3 000610   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000611   000002 236100                    LDQ     2,,PR0
         3 000612   000022 732000                    QRS     18
         3 000613   200014 116100                    CMPQ    I,,AUTO
         3 000614   000572 605400 3                  TPNZ    s:5506
         3 000615   001266 710000 3                  TRA     s:5625

     1453     5510
     1454     5511    4               CASE (%CLS_STRUCTURE_SPEC);

     1455     5512    4                 CALL INDEXIZE (VD$STRUCTURE_SPEC.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5512  3 000616   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000617   000001 036003                    ADLQ    1,DU
         3 000620   200063 756100                    STQ     LVL+27,,AUTO
         3 000621   001434 701000 3                  TSX1    INDEXIZE
         3 000622   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1456     5513    4                CALL INDEXIZE (VD$STRUCTURE_SPEC.ACCESSOR$) ALTRET (INDEXIZE_FAILURE);

   5513  3 000623   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000624   000003 036003                    ADLQ    3,DU
         3 000625   200063 756100                    STQ     LVL+27,,AUTO
         3 000626   001434 701000 3                  TSX1    INDEXIZE
         3 000627   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1457     5514    4                 CALL INDEXIZE (VD$STRUCTURE_SPEC.FIT$) ALTRET (INDEXIZE_FAILURE);

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:219  
   5514  3 000630   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000631   000004 036003                    ADLQ    4,DU
         3 000632   200063 756100                    STQ     LVL+27,,AUTO
         3 000633   001434 701000 3                  TSX1    INDEXIZE
         3 000634   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 000635   001266 710000 3                  TRA     s:5625

     1458     5515
     1459     5516    4               CASE (%CLS_IT_ADJUST);

     1460     5517    4                 ADDR(VD$IT_ADJUST.PARENT$)->BASED$SBIN = 0;

   5517  3 000636   000001 450100                    STZ     1,,PR0

     1461     5518    4                 CALL INDEXIZE (VD$IT_ADJUST.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5518  3 000637   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000640   000002 036003                    ADLQ    2,DU
         3 000641   200063 756100                    STQ     LVL+27,,AUTO
         3 000642   001434 701000 3                  TSX1    INDEXIZE
         3 000643   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1462     5519    4                 CALL INDEXIZE (VD$IT_ADJUST.MOVEMENTS$) ALTRET (INDEXIZE_FAILURE);

   5519  3 000644   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000645   000004 036003                    ADLQ    4,DU
         3 000646   200063 756100                    STQ     LVL+27,,AUTO
         3 000647   001434 701000 3                  TSX1    INDEXIZE
         3 000650   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1463     5520    4                 ADDR(VD$IT_ADJUST.MOVEMENTS_TAIL$)->BASED$SBIN = 0;

   5520  3 000651   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000652   000005 450100                    STZ     5,,PR0
         3 000653   001266 710000 3                  TRA     s:5625

     1464     5521
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:220  
     1465     5522    4               CASE (%CLS_IT_BLOCK_EXPR);

     1466     5523    4                 CALL INDEXIZE (VD$IT_BLOCK_EXPR.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5523  3 000654   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000655   000002 036003                    ADLQ    2,DU
         3 000656   200063 756100                    STQ     LVL+27,,AUTO
         3 000657   001434 701000 3                  TSX1    INDEXIZE
         3 000660   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1467     5524    5                 IF VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.REP# = %REP_REMOTE THEN DO;

   5524  3 000661   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000662   000004 720100                    LXL0    4,,PR0
         3 000663   000002 100003                    CMPX0   2,DU
         3 000664   000672 601000 3                  TNZ     s:5527

     1468     5525    5                    CALL INDEXIZE (VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.V$) ALTRET (
              5525                             INDEXIZE_FAILURE);

   5525  3 000665   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000666   000005 036003                    ADLQ    5,DU
         3 000667   200063 756100                    STQ     LVL+27,,AUTO
         3 000670   001434 701000 3                  TSX1    INDEXIZE
         3 000671   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1469     5526    5                    END;

     1470     5527    4                CALL INDEXIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.START) ALTRET (
              5527                          INDEXIZE_FAILURE);

   5527  3 000672   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000673   000006 036003                    ADLQ    6,DU
         3 000674   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 000675   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 000676   001351 702000 3                  TSX2    INDEXIZE_FAILURE

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:221  
     1471     5528    4                 CALL INDEXIZE_LOCATION (VD$IT_BLOCK_EXPR.DOMAINN.RANGE.ENDD) ALTRET (
              5528                          INDEXIZE_FAILURE);

   5528  3 000677   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000700   000017 036003                    ADLQ    15,DU
         3 000701   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 000702   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 000703   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1472     5529    4                 ADDR(VD$IT_BLOCK_EXPR.OPTIONS.STRUCTURE$)->BASED$SBIN = 0;

   5529  3 000704   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000705   000030 450100                    STZ     24,,PR0

     1473     5530    5                 IF VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;

   5530  3 000706   000033 720100                    LXL0    27,,PR0
         3 000707   000002 100003                    CMPX0   2,DU
         3 000710   000716 601000 3                  TNZ     s:5533

     1474     5531    5                    CALL INDEXIZE (VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.V$) ALTRET (
              5531                             INDEXIZE_FAILURE);

   5531  3 000711   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000712   000034 036003                    ADLQ    28,DU
         3 000713   200063 756100                    STQ     LVL+27,,AUTO
         3 000714   001434 701000 3                  TSX1    INDEXIZE
         3 000715   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1475     5532    5                    END;

     1476     5533    4                 CALL INDEXIZE (VD$IT_BLOCK_EXPR.SELECTS$) ALTRET (INDEXIZE_FAILURE);

   5533  3 000716   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000717   000035 036003                    ADLQ    29,DU
         3 000720   200063 756100                    STQ     LVL+27,,AUTO
         3 000721   001434 701000 3                  TSX1    INDEXIZE
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:222  
         3 000722   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1477     5534    4                 ADDR(VD$IT_BLOCK_EXPR.SELECTS_TAIL$)->BASED$SBIN = 0;

   5534  3 000723   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000724   000036 450100                    STZ     30,,PR0
         3 000725   001266 710000 3                  TRA     s:5625

     1478     5535
     1479     5536    4               CASE (%CLS_IT_COMMAND);

     1480     5537    4                 ADDR(VD$IT_COMMAND.PARENT$)->BASED$SBIN = 0;

   5537  3 000726   000001 450100                    STZ     1,,PR0

     1481     5538    4                 CALL INDEXIZE (VD$IT_COMMAND.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5538  3 000727   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000730   000002 036003                    ADLQ    2,DU
         3 000731   200063 756100                    STQ     LVL+27,,AUTO
         3 000732   001434 701000 3                  TSX1    INDEXIZE
         3 000733   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1482     5539    5                 DO I = 0 TO %MX_COMMAND_PARAMS-1;

   5539  3 000734   200014 450100                    STZ     I,,AUTO
         3 000735   000746 710000 3                  TRA     s:5541+1

     1483     5540    5                   CALL INDEXIZE (VD$IT_COMMAND.PARAM$ (I)) ALTRET (INDEXIZE_FAILURE);

   5540  3 000736   200014 236100                    LDQ     I,,AUTO
         3 000737   000022 736000                    QLS     18
         3 000740   000006 036003                    ADLQ    6,DU
         3 000741   200015 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         3 000742   200063 756100                    STQ     LVL+27,,AUTO
         3 000743   001434 701000 3                  TSX1    INDEXIZE
         3 000744   001351 702000 3                  TSX2    INDEXIZE_FAILURE
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:223  

     1484     5541    5                    END;

   5541  3 000745   200014 054100                    AOS     I,,AUTO
         3 000746   200014 235100                    LDA     I,,AUTO
         3 000747   000010 115007                    CMPA    8,DL
         3 000750   000736 604400 3                  TMOZ    s:5540
         3 000751   001266 710000 3                  TRA     s:5625

     1485     5542
     1486     5543    4               CASE (%CLS_IT_OPERAND);

     1487     5544    4                 ADDR(VD$IT_OPERAND.PARENT$)->BASED$SBIN = 0;

   5544  3 000752   000001 450100                    STZ     1,,PR0

     1488     5545    4                 CALL INDEXIZE (VD$IT_OPERAND.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5545  3 000753   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000754   000002 036003                    ADLQ    2,DU
         3 000755   200063 756100                    STQ     LVL+27,,AUTO
         3 000756   001434 701000 3                  TSX1    INDEXIZE
         3 000757   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1489     5546    5                 IF VD$IT_OPERAND.KEY.REP# = %REP_REMOTE THEN DO;

   5546  3 000760   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 000761   000006 720100                    LXL0    6,,PR0
         3 000762   000002 100003                    CMPX0   2,DU
         3 000763   000771 601000 3                  TNZ     s:5549

     1490     5547    5                    CALL INDEXIZE (VD$IT_OPERAND.KEY.V$) ALTRET (INDEXIZE_FAILURE);

   5547  3 000764   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000765   000007 036003                    ADLQ    7,DU
         3 000766   200063 756100                    STQ     LVL+27,,AUTO
         3 000767   001434 701000 3                  TSX1    INDEXIZE
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:224  
         3 000770   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1491     5548    5                    END;

     1492     5549    4                 CALL INDEXIZE (VD$IT_OPERAND.PARAM$) ALTRET (INDEXIZE_FAILURE);

   5549  3 000771   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 000772   000010 036003                    ADLQ    8,DU
         3 000773   200063 756100                    STQ     LVL+27,,AUTO
         3 000774   001434 701000 3                  TSX1    INDEXIZE
         3 000775   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 000776   001266 710000 3                  TRA     s:5625

     1493     5550
     1494     5551    4               CASE (%CLS_IT_OPERATOR);

     1495     5552    4                 ADDR(VD$IT_OPERATOR.PARENT$)->BASED$SBIN = 0;

   5552  3 000777   000001 450100                    STZ     1,,PR0

     1496     5553    4                 CALL INDEXIZE (VD$IT_OPERATOR.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5553  3 001000   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001001   000002 036003                    ADLQ    2,DU
         3 001002   200063 756100                    STQ     LVL+27,,AUTO
         3 001003   001434 701000 3                  TSX1    INDEXIZE
         3 001004   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1497     5554    4                 CALL INDEXIZE (VD$IT_OPERATOR.OPERAND$) ALTRET (INDEXIZE_FAILURE);

   5554  3 001005   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001006   000004 036003                    ADLQ    4,DU
         3 001007   200063 756100                    STQ     LVL+27,,AUTO
         3 001010   001434 701000 3                  TSX1    INDEXIZE
         3 001011   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1498     5555    4                 CALL INDEXIZE (VD$IT_OPERATOR.R_OPERAND$) ALTRET (INDEXIZE_FAILURE);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:225  

   5555  3 001012   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001013   000005 036003                    ADLQ    5,DU
         3 001014   200063 756100                    STQ     LVL+27,,AUTO
         3 001015   001434 701000 3                  TSX1    INDEXIZE
         3 001016   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 001017   001266 710000 3                  TRA     s:5625

     1499     5556
     1500     5557    4               CASE (%CLS_IT_SELECT);

     1501     5558    4                 ADDR(VD$IT_SELECT.PARENT$)->BASED$SBIN = 0;

   5558  3 001020   000001 450100                    STZ     1,,PR0

     1502     5559    4                 CALL INDEXIZE (VD$IT_SELECT.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5559  3 001021   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001022   000002 036003                    ADLQ    2,DU
         3 001023   200063 756100                    STQ     LVL+27,,AUTO
         3 001024   001434 701000 3                  TSX1    INDEXIZE
         3 001025   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1503     5560    4                 CALL INDEXIZE (VD$IT_SELECT.ADJUSTS$) ALTRET (INDEXIZE_FAILURE);

   5560  3 001026   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001027   000004 036003                    ADLQ    4,DU
         3 001030   200063 756100                    STQ     LVL+27,,AUTO
         3 001031   001434 701000 3                  TSX1    INDEXIZE
         3 001032   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1504     5561    4                 ADDR(VD$IT_SELECT.ADJUSTS_TAIL$)->BASED$SBIN = 0;

   5561  3 001033   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 001034   000005 450100                    STZ     5,,PR0
         3 001035   001266 710000 3                  TRA     s:5625

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:226  
     1505     5562
     1506     5563    4               CASE (%CLS_BLOCK_DESC, %CLS_BLOCK_BUFFER);

     1507     5564    5                 IF VD$OBJECT_HEADER.CLASS# = %CLS_BLOCK_BUFFER THEN DO;

   5564  3 001036   000001 100003                    CMPX0   1,DU
         3 001037   001052 601000 3                  TNZ     s:5568

     1508     5565    5                    CALL INDEXIZE (VD$BUFFER_HEADER.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5565  3 001040   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001041   000001 036003                    ADLQ    1,DU
         3 001042   200063 756100                    STQ     LVL+27,,AUTO
         3 001043   001434 701000 3                  TSX1    INDEXIZE
         3 001044   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1509     5566    5                    OBJECT_HEADER$ = PALIGNW(ADDR(VD$BUFFER.BYTES));

   5566  3 001045   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001046   000001 036000 4                  ADLQ    1
         3 001047   770000 036007                    ADLQ    -4096,DL
         3 001050   000003 376000 4                  ANQ     3
         3 001051   200015 756100                    STQ     OBJECT_HEADER$,,AUTO

     1510     5567    5                    END;

     1511     5568    5                 IF VD$BLOCK_DESC.FILE_KEY.REP# = %REP_REMOTE THEN DO;

   5568  3 001052   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 001053   000001 720100                    LXL0    1,,PR0
         3 001054   000002 100003                    CMPX0   2,DU
         3 001055   001063 601000 3                  TNZ     s:5571

     1512     5569    5                   CALL INDEXIZE (VD$BLOCK_DESC.FILE_KEY.V$) ALTRET (INDEXIZE_FAILURE)
              5569                             ;

   5569  3 001056   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:227  
         3 001057   000002 036003                    ADLQ    2,DU
         3 001060   200063 756100                    STQ     LVL+27,,AUTO
         3 001061   001434 701000 3                  TSX1    INDEXIZE
         3 001062   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1513     5570    5                    END;

     1514     5571    4                 CALL INDEXIZE_LOCATION (VD$BLOCK_DESC.RANGE.START) ALTRET (
              5571                          INDEXIZE_FAILURE);

   5571  3 001063   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001064   000003 036003                    ADLQ    3,DU
         3 001065   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001066   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 001067   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1515     5572    4                 CALL INDEXIZE_LOCATION (VD$BLOCK_DESC.RANGE.ENDD) ALTRET (
              5572                          INDEXIZE_FAILURE);

   5572  3 001070   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001071   000014 036003                    ADLQ    12,DU
         3 001072   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001073   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 001074   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1516     5573    4                 CALL INDEXIZE_STRUCTURE (VD$BLOCK_DESC.OPTIONS.STRUCTURE$) ALTRET (
              5573                          INDEXIZE_FAILURE);

   5573  3 001075   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001076   000025 036003                    ADLQ    21,DU
         3 001077   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001100   001353 701000 3                  TSX1    INDEXIZE_STRUCTURE
         3 001101   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1517     5574    5                 IF VD$BLOCK_DESC.OPTIONS.KEY_INCR.REP# = %REP_REMOTE THEN DO;

   5574  3 001102   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:228  
         3 001103   000030 720100                    LXL0    24,,PR0
         3 001104   000002 100003                    CMPX0   2,DU
         3 001105   001266 601000 3                  TNZ     s:5625

     1518     5575    5                    CALL INDEXIZE (VD$BLOCK_DESC.OPTIONS.KEY_INCR.V$) ALTRET (
              5575                             INDEXIZE_FAILURE);

   5575  3 001106   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001107   000031 036003                    ADLQ    25,DU
         3 001110   200063 756100                    STQ     LVL+27,,AUTO
         3 001111   001434 701000 3                  TSX1    INDEXIZE
         3 001112   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1519     5576    5                    END;

   5576  3 001113   001266 710000 3                  TRA     s:5625

     1520     5577
     1521     5578    4               CASE (%CLS_PATTERN);

     1522     5579    5                 DO I = 0 TO VD$PATTERN.N_ENTRIES# - 1;

   5579  3 001114   200014 450100                    STZ     I,,AUTO
         3 001115   001126 710000 3                  TRA     s:5581+1

     1523     5580    5                    CALL INDEXIZE (VD$PATTERN.ENTRIES.MATCH$ (I)) ALTRET (
              5580                             INDEXIZE_FAILURE);

   5580  3 001116   200014 236100                    LDQ     I,,AUTO
         3 001117   000024 736000                    QLS     20
         3 001120   000006 036003                    ADLQ    6,DU
         3 001121   200015 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         3 001122   200063 756100                    STQ     LVL+27,,AUTO
         3 001123   001434 701000 3                  TSX1    INDEXIZE
         3 001124   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1524     5581    5                    END;
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:229  

   5581  3 001125   200014 054100                    AOS     I,,AUTO
         3 001126   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 001127   000002 236100                    LDQ     2,,PR0
         3 001130   000022 732000                    QRS     18
         3 001131   200014 116100                    CMPQ    I,,AUTO
         3 001132   001116 605400 3                  TPNZ    s:5580
         3 001133   001266 710000 3                  TRA     s:5625

     1525     5582
     1526     5583    4               CASE (%CLS_EVAL);

     1527     5584    4                 ADDR(VD$EVAL.BLINK$)->BASED$SBIN = 0;

   5584  3 001134   000001 450100                    STZ     1,,PR0

     1528     5585    4                 CALL INDEXIZE_LOCATION (VD$EVAL.ENCLOSING.START) ALTRET (
              5585                          INDEXIZE_FAILURE);

   5585  3 001135   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001136   000002 036003                    ADLQ    2,DU
         3 001137   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001140   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 001141   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1529     5586    4                 CALL INDEXIZE_LOCATION (VD$EVAL.ENCLOSING.ENDD) ALTRET (
              5586                          INDEXIZE_FAILURE);

   5586  3 001142   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001143   000013 036003                    ADLQ    11,DU
         3 001144   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001145   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 001146   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1530     5587    4                CALL INDEXIZE_LOCATION (VD$EVAL.RANGE.START) ALTRET (INDEXIZE_FAILURE)
              5587                          ;

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:230  
   5587  3 001147   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001150   000024 036003                    ADLQ    20,DU
         3 001151   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001152   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 001153   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1531     5588    4                CALL INDEXIZE_LOCATION (VD$EVAL.RANGE.ENDD) ALTRET (INDEXIZE_FAILURE);

   5588  3 001154   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001155   000035 036003                    ADLQ    29,DU
         3 001156   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001157   001405 701000 3                  TSX1    INDEXIZE_LOCATION
         3 001160   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1532     5589        /*N**N**N* How do we indexize VD$EVAL.NODE$?  It can't be stored
     1533     5590        **N**N**N*  in the same record.  Maybe store a "walking index":
     1534     5591        **N**N**N*  count of # of node when walking the InTree?
     1535     5592        **N**N**N*/
     1536     5593    4                 ADDR(VD$EVAL.NODE$)->BASED$SBIN = 0;

   5593  3 001161   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 001162   000071 450100                    STZ     57,,PR0
         3 001163   001266 710000 3                  TRA     s:5625

     1537     5594
     1538     5595    4               CASE (%CLS_FIT);

     1539     5596    4                 CALL INDEXIZE (VD$FIT.CODE2$) ALTRET (INDEXIZE_FAILURE);

   5596  3 001164   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001165   000001 036003                    ADLQ    1,DU
         3 001166   200063 756100                    STQ     LVL+27,,AUTO
         3 001167   001434 701000 3                  TSX1    INDEXIZE
         3 001170   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1540     5597    4                 CALL INDEXIZE (VD$FIT.CODE3$) ALTRET (INDEXIZE_FAILURE);

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:231  
   5597  3 001171   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001172   000002 036003                    ADLQ    2,DU
         3 001173   200063 756100                    STQ     LVL+27,,AUTO
         3 001174   001434 701000 3                  TSX1    INDEXIZE
         3 001175   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 001176   001266 710000 3                  TRA     s:5625

     1541     5598
     1542     5599    4               CASE (%CLS_PTR_FILE_NODE);

     1543     5600    4                CALL INDEXIZE_STRUCTURE (VD$POINTER.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5600  3 001177   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001200   000001 036003                    ADLQ    1,DU
         3 001201   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001202   001353 701000 3                  TSX1    INDEXIZE_STRUCTURE
         3 001203   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1544     5601    4                 CALL INDEXIZE_STRUCTURE (VD$POINTER.V$) ALTRET (INDEXIZE_FAILURE);

   5601  3 001204   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001205   000003 036003                    ADLQ    3,DU
         3 001206   200027 756100                    STQ     VD_NUMBER$+4,,AUTO
         3 001207   001353 701000 3                  TSX1    INDEXIZE_STRUCTURE
         3 001210   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 001211   001266 710000 3                  TRA     s:5625

     1545     5602
     1546     5603    4               CASE (%CLS_PTR_KEY);

     1547     5604    4                 VD$OBJECT_HEADER.SIZE# = SIZEW(VD$POINTER) + SIZEW(VD$KEY);

   5604  3 001212   000006 221003                    LDX1    6,DU
         3 001213   000000 441100                    SXL1    0,,PR0

     1548     5605    4                 CALL INDEXIZE (VD$POINTER.FLINK$) ALTRET (INDEXIZE_FAILURE);

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:232  
   5605  3 001214   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001215   000001 036003                    ADLQ    1,DU
         3 001216   200063 756100                    STQ     LVL+27,,AUTO
         3 001217   001434 701000 3                  TSX1    INDEXIZE
         3 001220   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1549     5606    4                 PINCRW(OBJECT_HEADER$, SIZEW(VD$POINTER)) -> VD$KEY =

   5606  3 001221   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 001222   000003 471500                    LDP1    3,,PR0
         3 001223   000100 100500                    MLR     fill='000'O
         3 001224   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         3 001225   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

     1550     5607    4                   VD$POINTER.V$ -> VD$KEY;
     1551     5608    4                 IF VD$POINTER.V$ -> VD$KEY.REP# = %REP_REMOTE THEN

   5608  3 001226   100000 720100                    LXL0    0,,PR1
         3 001227   000002 100003                    CMPX0   2,DU
         3 001230   001240 601000 3                  TNZ     s:5612

     1552     5609    4                    CALL INDEXIZE

   5609  3 001231   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001232   000005 036003                    ADLQ    5,DU
         3 001233   200070 756100                    STQ     @INDX+5,,AUTO
         3 001234   200070 631500                    EPPR1   @INDX+5,,AUTO
         3 001235   200063 451500                    STP1    LVL+27,,AUTO
         3 001236   001434 701000 3                  TSX1    INDEXIZE
         3 001237   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1553     5610    4                      (ADDR(PINCRW(OBJECT_HEADER$,SIZEW(VD$POINTER))->VD$KEY.V$))
     1554     5611    4                      ALTRET (INDEXIZE_FAILURE);
     1555     5612    4                 ADDR(VD$POINTER.V$) -> BASED$SBIN =

   5612  3 001240   200012 235100                    LDA     ENCODED_NODE$,,AUTO
         3 001241   000022 771000                    ARL     18
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:233  
         3 001242   200064 755100                    STA     @INDX+1,,AUTO
         3 001243   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001244   000022 772000                    QRL     18
         3 001245   200064 136100                    SBLQ    @INDX+1,,AUTO
         3 001246   000004 036007                    ADLQ    4,DL
         3 001247   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 001250   000003 756100                    STQ     3,,PR0
         3 001251   001266 710000 3                  TRA     s:5625

     1556     5613    4                   POFFW (OBJECT_HEADER$, ENCODED_NODE$) + SIZEW(VD$POINTER);
     1557     5614    4               CASE (%CLS_PTR_BLOCK_DESC, %CLS_PTR_INTREE);

     1558     5615    4                 CALL INDEXIZE (VD$POINTER.FLINK$) ALTRET (INDEXIZE_FAILURE);

   5615  3 001252   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001253   000001 036003                    ADLQ    1,DU
         3 001254   200063 756100                    STQ     LVL+27,,AUTO
         3 001255   001434 701000 3                  TSX1    INDEXIZE
         3 001256   001351 702000 3                  TSX2    INDEXIZE_FAILURE

     1559     5616    4                 CALL INDEXIZE (VD$POINTER.V$) ALTRET (INDEXIZE_FAILURE);

   5616  3 001257   200015 236100                    LDQ     OBJECT_HEADER$,,AUTO
         3 001260   000003 036003                    ADLQ    3,DU
         3 001261   200063 756100                    STQ     LVL+27,,AUTO
         3 001262   001434 701000 3                  TSX1    INDEXIZE
         3 001263   001351 702000 3                  TSX2    INDEXIZE_FAILURE
         3 001264   001266 710000 3                  TRA     s:5625

     1560     5617
     1561     5618    4               CASE (%CLS_CMD_STREAM, %CLS_ENCODED_NODE, %CLS_DIR_NODE,

     1562     5619    4                   %CLS_FILE_NODE, %CLS_STREAM, %CLS_PORT, ELSE);
     1563     5620                      /* Invalid object class stored in workspace record */
     1564     5621    4                 GOTO WS_FILE_INVALID_FAILURE;

   5621  3 001265   001314 710000 3                  TRA     INVALID_WORKSPACE_FAILURE
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:234  

     1565     5622
     1566     5623    4               END OBJECT_TYPE_CASES;

     1567     5624
     1568     5625    3              IF VD$OBJECT_HEADER.SIZE# = 0 THEN

   5625  3 001266   200015 470500                    LDP0    OBJECT_HEADER$,,AUTO
         3 001267   000000 720100                    LXL0    0,,PR0
         3 001270   001300 601000 3                  TNZ     s:5629

     1569     5626    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,

   5626  3 001271   000000 221100                    LDX1    0,,PR0
         3 001272   000000 021100                    ADLX1   0,,PR0
         3 001273   000000 222011 xsym               LDX2    VD_OBJECTS,X1
         3 001274   000000 636012                    EAQ     0,X2
         3 001275   200015 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         3 001276   200015 756100                    STQ     OBJECT_HEADER$,,AUTO
         3 001277   001303 710000 3                  TRA     s:5631

     1570     5627    3                   VD_OBJECTS.SIZE (VD$OBJECT_HEADER.CLASS#));
     1571     5628    3              ELSE
     1572     5629    3                 OBJECT_HEADER$ = PINCRW(OBJECT_HEADER$,

   5629  3 001300   000000 636010                    EAQ     0,X0
         3 001301   200015 036100                    ADLQ    OBJECT_HEADER$,,AUTO
         3 001302   200015 756100                    STQ     OBJECT_HEADER$,,AUTO

     1573     5630    3                   VD$OBJECT_HEADER.SIZE#);
     1574     5631    3              END EACH_OBJECT;

   5631  3 001303   200015 235100                    LDA     OBJECT_HEADER$,,AUTO
         3 001304   000022 771000                    ARL     18
         3 001305   200064 755100                    STA     @INDX+1,,AUTO
         3 001306   200017 236100                    LDQ     OBJECT_NEXT$,,AUTO
         3 001307   000022 772000                    QRL     18
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:235  
         3 001310   200064 136100                    SBLQ    @INDX+1,,AUTO
         3 001311   000375 605400 3                  TPNZ    OBJECT_TYPE_CASES

     1575     5632
     1576     5633    2           RETURN;

   5633  3 001312   200024 221300                    LDX1  ! VD_NUMBER$+1,,AUTO
         3 001313   000001 702211                    TSX2  ! 1,X1

   5630  3 001314                       INVALID_WOR* null
   5630  3 001314                       WS_FILE_INV* null
     1577     5634
     1578     5635
     1579     5636    2   INVALID_WORKSPACE_FAILURE: ;
     1580     5637    2   WS_FILE_INVALID_FAILURE: ;
     1581     5638    2           CALL VDG$OALLOC (%CLS_ERR, VD_ERR$)

   5638  3 001314   200022 631500                    EPPR1   VD_ERR$,,AUTO
         3 001315   200065 451500                    STP1    @INDX+2,,AUTO
         3 001316   000002 236000 4                  LDQ     2
         3 001317   200064 756100                    STQ     @INDX+1,,AUTO
         3 001320   200064 630500                    EPPR0   @INDX+1,,AUTO
         3 001321   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001322   000000 701000 xent               TSX1    VDG$OALLOC
         3 001323   001325 702000 3                  TSX2    s:5639
         3 001324   001327 710000 3                  TRA     s:5640

     1582     5639    3           WHENALTRETURN DO; ALTRETURN; END;

   5639  3 001325   200024 221300                    LDX1  ! VD_NUMBER$+1,,AUTO
         3 001326   000000 702211                    TSX2  ! 0,X1

     1583     5640    2           VD$ERR.ERR.CODE# = %E$BAD_WS_FILE;

   5640  3 001327   200022 470500                    LDP0    VD_ERR$,,AUTO
         3 001330   000002 236100                    LDQ     2,,PR0
         3 001331   000004 376000 4                  ANQ     4
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:236  
         3 001332   000100 276007                    ORQ     64,DL
         3 001333   000002 756100                    STQ     2,,PR0

     1584     5641    2           VD$ERR.FLAGLEV# = %FLV_SERIOUS;

   5641  3 001334   000003 220003                    LDX0    3,DU
         3 001335   200022 470500                    LDP0    VD_ERR$,,AUTO
         3 001336   000003 740100                    STX0    3,,PR0

     1585     5642    2           VD_NUMBER$ = PINCRW(VD_ERR$, SIZEW(VD$ERR));

   5642  3 001337   200022 236100                    LDQ     VD_ERR$,,AUTO
         3 001340   000005 036003                    ADLQ    5,DU
         3 001341   200023 756100                    STQ     VD_NUMBER$,,AUTO

     1586     5643    2           VD$NUMBER.OBJECT.CLASS# (0) = %CLS_NUMBER;

   5643  3 001342   000033 221003                    LDX1    27,DU
         3 001343   200023 470500                    LDP0    VD_NUMBER$,,AUTO
         3 001344   000000 741100                    STX1    0,,PR0

     1587     5644    2           VD$NUMBER.V# (0) = VD$OBJECT_HEADER.CLASS#;

   5644  3 001345   200015 471500                    LDP1    OBJECT_HEADER$,,AUTO
         3 001346   100000 236100                    LDQ     0,,PR1
         3 001347   000022 772000                    QRL     18
         3 001350   000003 756100                    STQ     3,,PR0

     1588     5645
     1589     5646    2   INDEXIZE_FAILURE:
     1590     5647    2           ALTRETURN;

   5647  3 001351   200024 221300       INDEXIZE_FA* LDX1  ! VD_NUMBER$+1,,AUTO
         3 001352   000000 702211                    TSX2  ! 0,X1

     1591     5648
     1592     5649        %BOX (TITLE=INDEXIZE_STRUCTURE);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:237  

              5661    2   /***************************************************************************
              5663    2    *                                                                         *
              5667    2            *                             INDEXIZE_STRUCTURE                         *
              5669    2            *                                                                        *
              5671    2          ***************************************************************************/

     1593     5675
     1594     5676        /*I* NAME: INDEXIZE_STRUCTURE
     1595     5677            PARAMETERS:
     1596     5678                STRUCTURE - pointer to a VD$FILE_NODE within the STRUCTURES
     1597     5679                  internal file to indexize.
     1598     5680            INPUT:
     1599     5681                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing STRUCTURE.
     1600     5682            OUTPUT:
     1601     5683                STRUCTURE's pointer will be resolved into an index into the
     1602     5684                  VD$ENCODED_NODE, where a VD$LOCATION is located.
     1603     5685            DESCRIPTION:
     1604     5686                The pointer we're INDEXIZING points to a VD$FILE_NODE within
     1605     5687                  the STRUCTURES internal file.  So, we'll try and save just
     1606     5688                  the VD$KEY to a level-1 node of the file within a VD$LOCATION.
     1607     5689        */
     1608     5690
     1609     5691    2   INDEXIZE_STRUCTURE: PROC (STRUCTURE) ALTRET;

   5691  3 001353   200026 741300       INDEXIZE_ST* STX1  ! VD_NUMBER$+3,,AUTO

     1610     5692
     1611     5693    3   DCL STRUCTURE PTR PARAM;
     1612     5694
     1613     5695        %VD$BLOCK_DESC (NAME=STRUCTURES_FILE_BLOCK_DESC, STCLASS=AUTO);
     1614     5842
     1615     5843        %VD$FILE_NODE;
     1616     5936
     1617     5937
     1618     5938    3           IF STRUCTURE ~= ADDR(NIL) THEN

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:238  
   5938  3 001354   200027 470500                    LDP0    @STRUCTURE,,AUTO
         3 001355   000000 236100                    LDQ     0,,PR0
         3 001356   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001357   001375 600000 3                  TZE     s:5948

     1619     5939    3   SAVE_THE_STRUCTURES_FILE_KEY:
     1620     5940    4           DO;

   5940  3 001360                       SAVE_THE_ST* null
     1621     5941    4              STRUCTURES_FILE_BLOCK_DESC = %CLEAR;

   5941  3 001360   000100 100400                    MLR     fill='000'O
         3 001361   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001362   200030 000150                    ADSC9   STRUCTURES_FILE_BLOCK_DESC,,AUTO cn=0,n=104

     1622     5942    4              STRUCTURES_FILE_BLOCK_DESC.OBJECT.CLASS# = %CLS_BLOCK_DESC;

   5942  3 001363   000002 220003                    LDX0    2,DU
         3 001364   200030 740100                    STX0    STRUCTURES_FILE_BLOCK_DESC,,AUTO

     1623     5943    4              STRUCTURES_FILE_BLOCK_DESC.OPTIONS.STRUCTURE$ = ADDR(NIL);

   5943  3 001365   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 001366   200055 756100                    STQ     LVL+21,,AUTO

     1624     5944    4              STRUCTURES_FILE_BLOCK_DESC.RANGE.START.KEY (%LVL_LOWER-1) =

   5944  3 001367   000000 471500                    LDP1    0,,PR0
         3 001370   000100 100500                    MLR     fill='000'O
         3 001371   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         3 001372   200033 000010                    ADSC9   LVL+3,,AUTO              cn=0,n=8

     1625     5945    4                STRUCTURE->VD$FILE_NODE.DESC.KEY;
     1626     5946    4              STRUCTURE = ADDR(STRUCTURES_FILE_BLOCK_DESC);

   5946  3 001373   200030 631500                    EPPR1   STRUCTURES_FILE_BLOCK_DESC,,AUTO
         3 001374   000000 451500                    STP1    0,,PR0
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:239  

     1627     5947    4              END SAVE_THE_STRUCTURES_FILE_KEY;

     1628     5948    3           CALL INDEXIZE (STRUCTURE) ALTRET (INDEXIZE_FAILURE);

   5948  3 001375   200027 236100                    LDQ     @STRUCTURE,,AUTO
         3 001376   200063 756100                    STQ     LVL+27,,AUTO
         3 001377   001434 701000 3                  TSX1    INDEXIZE
         3 001400   001403 702000 3                  TSX2    INDEXIZE_FAILURE

     1629     5949
     1630     5950    3           RETURN;

   5950  3 001401   200026 221300                    LDX1  ! VD_NUMBER$+3,,AUTO
         3 001402   000001 702211                    TSX2  ! 1,X1

     1631     5951
     1632     5952    3   INDEXIZE_FAILURE:
     1633     5953    3           ALTRETURN;

   5953  3 001403   200026 221300       INDEXIZE_FA* LDX1  ! VD_NUMBER$+3,,AUTO
         3 001404   000000 702211                    TSX2  ! 0,X1

     1634     5954
     1635     5955
     1636     5956    3   END INDEXIZE_STRUCTURE;
     1637     5957
     1638     5958        %BOX (TITLE=INDEXIZE_LOCATION);

              5970    3   /***************************************************************************
              5972    3    *                                                                         *
              5976    3            *                             INDEXIZE_LOCATION                          *
              5978    3            *                                                                        *
              5980    3          ***************************************************************************/

     1639     5984
     1640     5985        /*I* NAME: INDEXIZE_LOCATION
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:240  
     1641     5986            PARAMETERS:
     1642     5987                LOCATION - VD$LOCATION to indexize.
     1643     5988            INPUT:
     1644     5989                ENCODED_NODE$ is addr of VD$ENCODED_NODE containing LOCATION.
     1645     5990            OUTPUT:
     1646     5991                LOCATION's pointers will be resolved into actual pointers.
     1647     5992            DESCRIPTION:
     1648     5993                Go thru LOCATION's levels, and indexize any pointers found.
     1649     5994        */
     1650     5995
     1651     5996    2   INDEXIZE_LOCATION: PROC (LOCATION) ALTRET;

   5996  3 001405   200026 741300       INDEXIZE_LO* STX1  ! VD_NUMBER$+3,,AUTO

     1652     5997
     1653     5998        %VD$LOCATION (NAME=LOCATION, STCLASS=PARAM);
     1654     6026
     1655     6027
     1656     6028    3   DCL LVL SBIN;
     1657     6029
     1658     6030
     1659     6031
     1660     6032    4           DO LVL = 0 TO (%(MX_LOCATION_LEVELS-1));

   6032  3 001406   200030 450100                    STZ     LVL,,AUTO

     1661     6033    5              IF LOCATION.KEY.REP# (LVL) = %REP_REMOTE THEN DO;

   6033  3 001407   200030 235100                    LDA     LVL,,AUTO
         3 001410   000001 735000                    ALS     1
         3 001411   200027 470500                    LDP0    @LOCATION,,AUTO
         3 001412   000000 720105                    LXL0    0,AL,PR0
         3 001413   000002 100003                    CMPX0   2,DU
         3 001414   001424 601000 3                  TNZ     s:6036

     1662     6034    5                 CALL INDEXIZE (LOCATION.KEY.V$ (LVL)) ALTRET (INDEXIZE_FAILURE);

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:241  
   6034  3 001415   200030 236100                    LDQ     LVL,,AUTO
         3 001416   000023 736000                    QLS     19
         3 001417   000001 036003                    ADLQ    1,DU
         3 001420   200027 036100                    ADLQ    @LOCATION,,AUTO
         3 001421   200063 756100                    STQ     LVL+27,,AUTO
         3 001422   001434 701000 3                  TSX1    INDEXIZE
         3 001423   001432 702000 3                  TSX2    INDEXIZE_FAILURE

     1663     6035    5                 END;

     1664     6036    4              END;

   6036  3 001424   200030 054100                    AOS     LVL,,AUTO
         3 001425   200030 235100                    LDA     LVL,,AUTO
         3 001426   000003 115007                    CMPA    3,DL
         3 001427   001407 604400 3                  TMOZ    s:6033

     1665     6037    3           RETURN;

   6037  3 001430   200026 221300                    LDX1  ! VD_NUMBER$+3,,AUTO
         3 001431   000001 702211                    TSX2  ! 1,X1

     1666     6038
     1667     6039    3   INDEXIZE_FAILURE:
     1668     6040    3           ALTRETURN;

   6040  3 001432   200026 221300       INDEXIZE_FA* LDX1  ! VD_NUMBER$+3,,AUTO
         3 001433   000000 702211                    TSX2  ! 0,X1

     1669     6041
     1670     6042
     1671     6043    3   END INDEXIZE_LOCATION;
     1672     6044
     1673     6045    2   END INDEXIZE_RECORD;
     1674     6046
     1675     6047        %BOX (TITLE=INDEXIZE);

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:242  
              6059    2   /***************************************************************************
              6061    2    *                                                                         *
              6065    2            *                                  INDEXIZE                              *
              6067    2            *                                                                        *
              6069    2          ***************************************************************************/

     1676     6073
     1677     6074        /*I* NAME: INDEXIZE
     1678     6075            PARAMETERS:
     1679     6076                INDX, actually a pointer, possibly NIL.
     1680     6077            INPUT:
     1681     6078                ENCODED_NODE$ is addr of VD$ENCODED_NODE.
     1682     6079                ENCODED_NODE_SIZE is the size in words of the VD$ENCODED_NODE.
     1683     6080                OBJECT_NEXT$ is the next available location to place an object
     1684     6081                  within the VD$ENCODED_NODE.
     1685     6082            OUTPUT:
     1686     6083                VD$ENCODED_NODE updated (see below).
     1687     6084
     1688     6085            DESCRIPTION:
     1689     6086                The object pointed to (if any) by the "INDX" passed in is
     1690     6087                placed in the VD$ENCODED_NODE at the next available location.
     1691     6088                The pointer is then turned into an index from the start of the
     1692     6089                VD$ENCODED_NODE.
     1693     6090        */
     1694     6091
     1695     6092    1   INDEXIZE: PROC (INDX) ALTRET;

   6092  3 001434   200062 741300       INDEXIZE     STX1  ! LVL+26,,AUTO

     1696     6093
     1697     6094    2   DCL INDX PTR PARAM;
     1698     6095
     1699     6096
     1700     6097    2           IF INDX = ADDR(NIL) THEN

   6097  3 001435   200063 470500                    LDP0    @INDX,,AUTO
         3 001436   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:243  
         3 001437   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001440   001443 601000 3                  TNZ     s:6100

     1701     6098    2              ADDR(INDX)->BASED$SBIN = 0;

   6098  3 001441   000000 450100                    STZ     0,,PR0
         3 001442   001577 710000 3                  TRA     s:6128

     1702     6099    3           ELSE DO;

     1703     6100    3              IF INDX->VD$OBJECT_HEADER.SIZE# = 0 THEN

   6100  3 001443   000000 471500                    LDP1    0,,PR0
         3 001444   100000 720100                    LXL0    0,,PR1
         3 001445   001455 601000 3                  TNZ     s:6104

     1704     6101    3                 OBJECT_SIZE = VD_OBJECTS.SIZE (INDX->VD$OBJECT_HEADER.CLASS#)

   6101  3 001446   100000 222100                    LDX2    0,,PR1
         3 001447   100000 022100                    ADLX2   0,,PR1
         3 001450   000000 236012 xsym               LDQ     VD_OBJECTS,X2
         3 001451   000020 732000                    QRS     16
         3 001452   000005 376000 4                  ANQ     5
         3 001453   200020 756100                    STQ     OBJECT_SIZE,,AUTO
         3 001454   001461 710000 3                  TRA     s:6106

     1705     6102    3                   * %NB_PER_WORD;
     1706     6103    3              ELSE
     1707     6104    3                 OBJECT_SIZE = INDX->VD$OBJECT_HEADER.SIZE#

   6104  3 001455   100000 236100                    LDQ     0,,PR1
         3 001456   000022 736000                    QLS     18
         3 001457   000020 732000                    QRS     16
         3 001460   200020 756100                    STQ     OBJECT_SIZE,,AUTO

     1708     6105    3                   * %NB_PER_WORD;
     1709     6106    3              IF INDX->VD$OBJECT_HEADER.CLASS# = %CLS_PTR_KEY THEN
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:244  

   6106  3 001461   100000 222100                    LDX2    0,,PR1
         3 001462   000043 102003                    CMPX2   35,DU
         3 001463   001466 601000 3                  TNZ     s:6108

     1710     6107    3                 OBJECT_SIZE = OBJECT_SIZE + SIZEC(VD$KEY);

   6107  3 001464   000010 036007                    ADLQ    8,DL
         3 001465   200020 756100                    STQ     OBJECT_SIZE,,AUTO

     1711     6108    3              IF (POFFC(OBJECT_NEXT$, ENCODED_NODE$) + OBJECT_SIZE)

   6108  3 001466   200012 236100                    LDQ     ENCODED_NODE$,,AUTO
         3 001467   000020 772000                    QRL     16
         3 001470   200064 756100                    STQ     @INDX+1,,AUTO
         3 001471   200017 236100                    LDQ     OBJECT_NEXT$,,AUTO
         3 001472   000020 772000                    QRL     16
         3 001473   200064 136100                    SBLQ    @INDX+1,,AUTO
         3 001474   200020 036100                    ADLQ    OBJECT_SIZE,,AUTO
         3 001475   200065 756100                    STQ     @INDX+2,,AUTO
         3 001476   200013 236100                    LDQ     ENCODED_NODE_SIZE,,AUTO
         3 001477   000002 736000                    QLS     2
         3 001500   001554 604000 3                  TMI     s:6123
         3 001501   200065 116100                    CMPQ    @INDX+2,,AUTO
         3 001502   001554 605000 3                  TPL     s:6123

     1712     6109    4                > ENCODED_NODE_SIZE * %NB_PER_WORD THEN DO;

     1713     6110    4                 CALL VDG$OALLOC (%CLS_ENCODED_NODE, BIGGER_ENCODED_NODE$,

   6110  3 001503   200013 235100                    LDA     ENCODED_NODE_SIZE,,AUTO
         3 001504   002000 035007                    ADLA    1024,DL
         3 001505   200064 755100                    STA     @INDX+1,,AUTO
         3 001506   200064 631500                    EPPR1   @INDX+1,,AUTO
         3 001507   200067 451500                    STP1    @INDX+4,,AUTO
         3 001510   200011 633500                    EPPR3   BIGGER_ENCODED_NODE$,,AUTO
         3 001511   200066 453500                    STP3    @INDX+3,,AUTO
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:245  
         3 001512   000000 236000 4                  LDQ     0
         3 001513   200065 756100                    STQ     @INDX+2,,AUTO
         3 001514   200065 630500                    EPPR0   @INDX+2,,AUTO
         3 001515   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001516   000000 701000 xent               TSX1    VDG$OALLOC
         3 001517   001521 702000 3                  TSX2    s:6112
         3 001520   001523 710000 3                  TRA     s:6113

     1714     6111    4                   ENCODED_NODE_SIZE + 1024  /* Get another 1K */)
     1715     6112    5                 WHENALTRETURN DO; ALTRETURN; END;

   6112  3 001521   200062 221300                    LDX1  ! LVL+26,,AUTO
         3 001522   000000 702211                    TSX2  ! 0,X1

     1716     6113    4                 BIGGER_ENCODED$NODE = ENCODED$NODE;

   6113  3 001523   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 001524   200011 471500                    LDP1    BIGGER_ENCODED_NODE$,,AUTO
         3 001525   000100 100500                    MLR     fill='000'O
         3 001526   000000 000144                    ADSC9   0,,PR0                   cn=0,n=100
         3 001527   100000 000144                    ADSC9   0,,PR1                   cn=0,n=100

     1717     6114
     1718     6115    4                 ENCODED$NODE.FLINK$ = ADDR(NIL);

   6115  3 001530   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 001531   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 001532   000001 756100                    STQ     1,,PR0

     1719     6116    4                 ENCODED$NODE.DESC = %CLEAR;

   6116  3 001533   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 001534   000100 100400                    MLR     fill='000'O
         3 001535   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001536   000012 000074                    ADSC9   10,,PR0                  cn=0,n=60

     1720     6117    4                 ENCODED$NODE.DESC.DATA$ = ADDR(NIL);
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:246  

   6117  3 001537   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 001540   200012 470500                    LDP0    ENCODED_NODE$,,AUTO
         3 001541   000030 756100                    STQ     24,,PR0

     1721     6118    4                 CALL VDG$OFREE (ENCODED$NODE)

   6118  3 001542   200012 630500                    EPPR0   ENCODED_NODE$,,AUTO
         3 001543   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001544   000000 701000 xent               TSX1    VDG$OFREE
         3 001545   001547 702000 3                  TSX2    s:6119
         3 001546   001551 710000 3                  TRA     s:6121

     1722     6119    5                 WHENALTRETURN DO; ALTRETURN; END;

   6119  3 001547   200062 221300                    LDX1  ! LVL+26,,AUTO
         3 001550   000000 702211                    TSX2  ! 0,X1

     1723     6120
     1724     6121    4                 ENCODED_NODE_SIZE = ENCODED_NODE_SIZE + 1024;

   6121  3 001551   200013 235100                    LDA     ENCODED_NODE_SIZE,,AUTO
         3 001552   002000 035007                    ADLA    1024,DL
         3 001553   200013 755100                    STA     ENCODED_NODE_SIZE,,AUTO

     1725     6122    4                 END;

     1726     6123    3              OBJECT_NEXT$->BASED$OBJECT = INDX->BASED$OBJECT;

   6123  3 001554   200063 470500                    LDP0    @INDX,,AUTO
         3 001555   000000 471500                    LDP1    0,,PR0
         3 001556   200020 720100                    LXL0    OBJECT_SIZE,,AUTO
         3 001557   200017 473500                    LDP3    OBJECT_NEXT$,,AUTO
         3 001560   040140 100540                    MLR     fill='040'O
         3 001561   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         3 001562   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:247  
     1727     6124    3              ADDR(INDX)->BASED$SBIN = POFFW(OBJECT_NEXT$, ENCODED_NODE$);

   6124  3 001563   200012 235100                    LDA     ENCODED_NODE$,,AUTO
         3 001564   000022 771000                    ARL     18
         3 001565   200064 755100                    STA     @INDX+1,,AUTO
         3 001566   200017 236100                    LDQ     OBJECT_NEXT$,,AUTO
         3 001567   000022 772000                    QRL     18
         3 001570   200064 136100                    SBLQ    @INDX+1,,AUTO
         3 001571   000000 756100                    STQ     0,,PR0

     1728     6125    3              OBJECT_NEXT$ = PINCRW(OBJECT_NEXT$, OBJECT_SIZE / %NB_PER_WORD);

   6125  3 001572   200020 236100                    LDQ     OBJECT_SIZE,,AUTO
         3 001573   000002 772000                    QRL     2
         3 001574   000022 736000                    QLS     18
         3 001575   200017 036100                    ADLQ    OBJECT_NEXT$,,AUTO
         3 001576   200017 756100                    STQ     OBJECT_NEXT$,,AUTO

     1729     6126    3              END;

     1730     6127
     1731     6128    2           RETURN;

   6128  3 001577   200062 221300                    LDX1  ! LVL+26,,AUTO
         3 001600   000001 702211                    TSX2  ! 1,X1
     1732     6129
     1733     6130    2   END INDEXIZE;
     1734     6131
     1735     6132    1   END VDW$STOW_NODE;

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:248  
--  Include file information  --

   VD_PERR_C.:VDA5TOU  is referenced.
   VD_MACROS_M.:VDA5TOU  is referenced.
   CP_6_SUBS.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E04TOU  was found in the system file and is never referenced.
   CP_6_C.:E04TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VDW$STOW_NODE.
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:249  

 **** Variables and constants ****

  ****  Section 001  Data  VDW$STOW_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 FPT_WRITE_CONTEXT_FILE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FILE_KEY                  5-0-0/w PTR         r     1 @FILE_NODE
    63-0-0/w PTR         r     1 @INDX                      4-0-0/w PTR         r     1 @LOCATION
    27-0-0/w PTR         r     1 @LOCATION                 27-0-0/w PTR         r     1 @STRUCTURE
     6-0-0/w PTR         r     1 @WS_FILE_DCB
     7-0-0/w PTR         r     1 @WS_FILE_RECORD_NUMBER
    10-0-0/w PTR         r     1 BASED_ARRAY$              11-0-0/w PTR         r     1 BIGGER_ENCODED_NODE$
    12-0-0/w PTR         r     1 ENCODED_NODE$             13-0-0/w UBIN        r     1 ENCODED_NODE_SIZE
    *0-0-0/w STRC(72)    r     1 FILE_KEY                  *0-0-0/w STRC(468)   r     1 FILE_NODE
    14-0-0/w SBIN        r     1 I                         *0-0-0/w PTR         r     1 INDX
    *0-0-0/w STRC(324)   r     1 LOCATION                  *0-0-0/w STRC(324)   r     1 LOCATION
    30-0-0/w SBIN        r     1 LVL                       15-0-0/w PTR         r     1 OBJECT_HEADER$
    17-0-0/w PTR         r     1 OBJECT_NEXT$              20-0-0/w UBIN        r     1 OBJECT_SIZE
    *0-0-0/w PTR         r     1 STRUCTURE
    30-0-0/w STRC(936)   r     1 STRUCTURES_FILE_BLOCK_DESC
    21-0-0/w SBIN        r     1 SUM                       22-0-0/w PTR         r     1 VD_ERR$
    23-0-0/w PTR         r     1 VD_NUMBER$                *0-0-0/h UBIN(18)    r     1 WS_FILE_DCB
    *0-0-0/w SBIN        r     1 WS_FILE_RECORD_NUMBER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:250  
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/c ASTR(9)     r     1 B_VERSION
     0-0-0/w STRC(72)    r     1 VD_OBJECTS(0:98)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w SBIN        r     1 BASED$ARRAY(0:0)
     0-0-0/c ACHR        r     1 BASED$OBJECT               0-0-0/w SBIN        r     1 BASED$SBIN
     0-0-0/w STRC(900)   r     1 BIGGER_ENCODED$NODE        0-0-0/w STRC(900)   r     1 ENCODED$NODE
     0-0-0/w STRC(936)   r     1 VD$BLOCK_DESC              0-0-0/w ASTR(90)    r     1 VD$BUFFER
     0-0-0/w ASTR(90)    r     1 VD$BUFFER                  0-0-0/w STRC(90)    r     1 VD$BUFFER_HEADER
     0-0-0/w STRC(288)   r     1 VD$ENCODED_FILE_SPEC       0-0-0/w STRC(180)   r     1 VD$ERR
     0-0-0/w STRC(2124)  r     1 VD$EVAL                    0-0-0/w STRC(468)   r     1 VD$FILE_NODE
     0-0-0/w STRC(36972) r     1 VD$FIT                     0-0-0/w STRC(216)   r     1 VD$IT_ADJUST
     0-0-0/w STRC(1116)  r     1 VD$IT_BLOCK_EXPR           0-0-0/w STRC(540)   r     1 VD$IT_COMMAND
     0-0-0/w STRC(324)   r     1 VD$IT_OPERAND              0-0-0/w STRC(216)   r     1 VD$IT_OPERATOR
     0-0-0/w STRC(216)   r     1 VD$IT_SELECT               0-0-0/w STRC(72)    r     1 VD$KEY
     0-0-0/w STRC(252)   r     1 VD$NAME_SPEC
     0-0-0/w STRC(144)   r     1 VD$NUMBER(0:2)
     0-0-0/w STRC        r     1 VD$OBJECT_HEADER           0-0-0/w STRC(252)   r     1 VD$PATTERN
     0-0-0/w STRC(144)   r     1 VD$POINTER                 0-0-0/w STRC(324)   r     1 VD$RECORD_SET
     0-0-0/w STRC(81)    r     1 VD$STRING_HEADER           0-0-0/w STRC(180)   r     1 VD$STRUCTURE_SPEC
     0-0-0/w ASTR(81)    r     1 VD$TEXTC_REMOTE            0-0-0/w STRC(180)   r     1 VD$WINDOW_BLOCK
     0-0-0/w STRC(900)   r     1 VD$WINDOW_SPEC


   Procedure VDW$STOW_NODE requires 897 words for executable code.
   Procedure VDW$STOW_NODE requires 58 words of local(AUTO) storage.

    No errors detected in file VDW$WORKSPACE.:VDA5TSI    .
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:251  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:252  
          MINI XREF LISTING

B$ALT.CODE
      4042**DCL      4042--REDEF    4043--REDEF    4043--REDEF
B$ALT.ERR
      4043**DCL      4143>>ASSIGN
B$ALT.ERR.ERR#
      4044**DCL      4044--REDEF
B$ALT.EVID
      4043**DCL      4043--REDEF    4043--REDEF
B$TCB.ALT$
      4038**DCL      4143>>ASSIGN
B$TCB$
      3280**DCL      4038--IMP-PTR  4143>>ASSIGN
BASED$ARRAY
      3297**DCL      4096>>ASSIGN
BASED$OBJECT
      3298**DCL      6123<<ASSIGN   6123>>ASSIGN
BASED$SBIN
      3299**DCL      4078<<ASSIGN   4079<<ASSIGN   5490<<ASSIGN   5494<<ASSIGN   5517<<ASSIGN   5520<<ASSIGN
      5529<<ASSIGN   5534<<ASSIGN   5537<<ASSIGN   5544<<ASSIGN   5552<<ASSIGN   5558<<ASSIGN   5561<<ASSIGN
      5584<<ASSIGN   5593<<ASSIGN   5612<<ASSIGN   6098<<ASSIGN   6124<<ASSIGN
BASED_ARRAY$
      3283**DCL      3297--IMP-PTR  4092<<ASSIGN   4095>>DOINDEX  4096>>ASSIGN
BIGGER_ENCODED$NODE
      3452**DCL      6113<<ASSIGN
BIGGER_ENCODED_NODE$
      3284**DCL      3452--IMP-PTR  6110<>CALL     6113>>ASSIGN
B_VERSION.LENGTH
      3202**DCL      3203--IMP-SIZ  4059>>ASSIGN
B_VERSION.TEXT
      3203**DCL      4059>>ASSIGN
ENCODED$NODE
      3330**DCL      4076--ASSIGN   4078--ASSIGN   4114<>CALL     4135<>CALL     4149<>CALL     5453--ASSIGN
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:253  
      6113>>ASSIGN   6118<>CALL
ENCODED$NODE.CHECKSUM#
      3357**DCL      4092--ASSIGN   4098<<ASSIGN
ENCODED$NODE.DESC
      3368**DCL      4111<<ASSIGN   4133<<ASSIGN   4147<<ASSIGN   6116<<ASSIGN
ENCODED$NODE.DESC.ACCESS
      3423**DCL      4063<<ASSIGN
ENCODED$NODE.DESC.DATA$
      3440**DCL      4065<<ASSIGN   4079--ASSIGN   4112<<ASSIGN   4134<<ASSIGN   4148<<ASSIGN   5463<>CALL
      6117<<ASSIGN
ENCODED$NODE.DESC.FILE_KEY
      3380**DCL      4061<<ASSIGN
ENCODED$NODE.DESC.FILE_KEY.REP#
      3382**DCL      5456>>IF
ENCODED$NODE.DESC.FILE_KEY.V$
      3382**DCL      5457<>CALL
ENCODED$NODE.DESC.LOCATION
      3394**DCL      4062<<ASSIGN   5459<>CALL
ENCODED$NODE.DESC.SPEC
      3436**DCL      4064<<ASSIGN
ENCODED$NODE.DESC.SPEC.REP#
      3438**DCL      5460>>IF
ENCODED$NODE.DESC.SPEC.V$
      3438**DCL      4078--ASSIGN   5461<>CALL
ENCODED$NODE.FLINK$
      3356**DCL      4110<<ASSIGN   4132<<ASSIGN   4146<<ASSIGN   6115<<ASSIGN
ENCODED$NODE.LENGTH#
      3356**DCL      4088<<ASSIGN   4095>>DOINDEX
ENCODED$NODE.RECORD_ID
      3356**DCL      4058<<ASSIGN
ENCODED$NODE.RECORD_NUM#
      3357**DCL      4060<<ASSIGN
ENCODED$NODE.RECORD_VERSION
      3356**DCL      4059<<ASSIGN
ENCODED_NODE$
      3285**DCL      3330--IMP-PTR  4056<>CALL     4058>>ASSIGN   4059>>ASSIGN   4060>>ASSIGN   4061>>ASSIGN
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:254  
      4062>>ASSIGN   4063>>ASSIGN   4064>>ASSIGN   4065>>ASSIGN   4076>>ASSIGN   4078>>ASSIGN   4079>>ASSIGN
      4088>>ASSIGN   4088>>ASSIGN   4092>>ASSIGN   4095>>DOINDEX  4095>>DOINDEX  4098>>ASSIGN   4101>>ASSIGN
      4110>>ASSIGN   4111>>ASSIGN   4112>>ASSIGN   4114>>CALL     4132>>ASSIGN   4133>>ASSIGN   4134>>ASSIGN
      4135>>CALL     4146>>ASSIGN   4147>>ASSIGN   4148>>ASSIGN   4149>>CALL     5453>>ASSIGN   5456>>IF
      5457>>CALL     5459>>CALL     5460>>IF       5461>>CALL     5463>>CALL     5612>>ASSIGN   6108>>IF
      6113>>ASSIGN   6115>>ASSIGN   6116>>ASSIGN   6117>>ASSIGN   6118>>CALL     6124>>ASSIGN
ENCODED_NODE_SIZE
      3286**DCL      4055<<ASSIGN   4056<>CALL     6108>>IF       6110>>CALL     6121<<ASSIGN   6121>>ASSIGN
FILE_KEY
      3064**DCL        34--PROC     4061>>ASSIGN   4067>>IF
FILE_NODE
      3106**DCL        34--PROC
FILE_NODE.ACCESS
      3144**DCL      4051>>IF       4063>>ASSIGN
FILE_NODE.DESC.DATA$
      3187**DCL      4065>>ASSIGN   4067>>IF
FILE_NODE.DESC.SPEC
      3183**DCL      4064>>ASSIGN
FILE_NODE.DESC.SPEC.TYPE#
      3185**DCL      4051>>IF       4067>>IF
FILE_NODE.DESC.SPEC.V$
      3185**DCL      4051>>IF       4077>>ASSIGN
FPT_WRITE_CONTEXT_FILE
       676**DCL      4107<>CALL
FPT_WRITE_CONTEXT_FILE.BUF_.BOUND
       676**DCL      4103<<ASSIGN
FPT_WRITE_CONTEXT_FILE.BUF_.BUF$
       678**DCL      4101<<ASSIGN   4103>>ASSIGN
FPT_WRITE_CONTEXT_FILE.STATION_
       678**DCL       678--REDEF
FPT_WRITE_CONTEXT_FILE.V
       679**DCL       676--DCLINIT
FPT_WRITE_CONTEXT_FILE.V.DCB#
       679**DCL      4100<<ASSIGN
FPT_WRITE_CONTEXT_FILE.V.DVBYTE.VFC#
       685**DCL       685--REDEF
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:255  
I
      3287**DCL      4095<<DOINDEX  4096>>ASSIGN   5505<<DOINDEX  5506>>IF       5507>>CALL     5539<<DOINDEX
      5540>>CALL     5579<<DOINDEX  5580>>CALL
INDEXIZE
      6092**PROC     5457--CALL     5461--CALL     5463--CALL     5474--CALL     5479--CALL     5489--CALL
      5491--CALL     5492--CALL     5493--CALL     5495--CALL     5496--CALL     5497--CALL     5500--CALL
      5501--CALL     5502--CALL     5507--CALL     5512--CALL     5513--CALL     5514--CALL     5518--CALL
      5519--CALL     5523--CALL     5525--CALL     5531--CALL     5533--CALL     5538--CALL     5540--CALL
      5545--CALL     5547--CALL     5549--CALL     5553--CALL     5554--CALL     5555--CALL     5559--CALL
      5560--CALL     5565--CALL     5569--CALL     5575--CALL     5580--CALL     5596--CALL     5597--CALL
      5605--CALL     5609--CALL     5615--CALL     5616--CALL     5948--CALL     6034--CALL
INDEXIZE_FAILURE IN PROCEDURE INDEXIZE_LOCATION
      6040**LABEL    6034--CALLALT
INDEXIZE_FAILURE IN PROCEDURE INDEXIZE_RECORD
      5647**LABEL    5457--CALLALT  5461--CALLALT  5463--CALLALT  5474--CALLALT  5479--CALLALT  5489--CALLALT
      5491--CALLALT  5492--CALLALT  5493--CALLALT  5495--CALLALT  5496--CALLALT  5497--CALLALT  5500--CALLALT
      5501--CALLALT  5502--CALLALT  5507--CALLALT  5512--CALLALT  5513--CALLALT  5514--CALLALT  5518--CALLALT
      5519--CALLALT  5523--CALLALT  5525--CALLALT  5527--CALLALT  5528--CALLALT  5531--CALLALT  5533--CALLALT
      5538--CALLALT  5540--CALLALT  5545--CALLALT  5547--CALLALT  5549--CALLALT  5553--CALLALT  5554--CALLALT
      5555--CALLALT  5559--CALLALT  5560--CALLALT  5565--CALLALT  5569--CALLALT  5571--CALLALT  5572--CALLALT
      5573--CALLALT  5575--CALLALT  5580--CALLALT  5585--CALLALT  5586--CALLALT  5587--CALLALT  5588--CALLALT
      5596--CALLALT  5597--CALLALT  5600--CALLALT  5601--CALLALT  5605--CALLALT  5609--CALLALT  5615--CALLALT
      5616--CALLALT
INDEXIZE_FAILURE IN PROCEDURE INDEXIZE_STRUCTURE
      5953**LABEL    5948--CALLALT
INDEXIZE_LOCATION IN PROCEDURE INDEXIZE_RECORD
      5996**PROC     5459--CALL     5527--CALL     5528--CALL     5571--CALL     5572--CALL     5585--CALL
      5586--CALL     5587--CALL     5588--CALL
INDEXIZE_RECORD
      4210**PROC     4084--CALL
INDEXIZE_RECORD_FAILED
      4132**LABEL    4084--CALLALT
INDEXIZE_STRUCTURE IN PROCEDURE INDEXIZE_RECORD
      5691**PROC     5573--CALL     5600--CALL     5601--CALL
INDX IN PROCEDURE INDEXIZE
      6094**DCL      6092--PROC     6097>>IF       6098--ASSIGN   6100>>IF       6101>>ASSIGN   6104>>ASSIGN
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:256  
      6106>>IF       6123>>ASSIGN   6124--ASSIGN
LOCATION
      3078**DCL        34--PROC     4062>>ASSIGN   4067>>IF
LOCATION IN PROCEDURE INDEXIZE_LOCATION
      6006**DCL      5996--PROC
LOCATION.KEY.REP# IN PROCEDURE INDEXIZE_LOCATION
      6022**DCL      6033>>IF
LOCATION.KEY.V$ IN PROCEDURE INDEXIZE_LOCATION
      6022**DCL      6034<>CALL
LVL IN PROCEDURE INDEXIZE_LOCATION
      6028**DCL      6032<<DOINDEX  6033>>IF       6034>>CALL
M$WRITE
        47**DCL-ENT  4107--CALL
OALLOC_FAILED
      4148**LABEL    4056--CALLALT  4141--CALLALT
OBJECT_HEADER$
      3288**DCL      3316--IMP-PTR  3671--IMP-PTR  4076<<ASSIGN   4077>>ASSIGN   4081>>ASSIGN   4221--IMP-PTR
      4287--IMP-PTR  4324--IMP-PTR  4402--IMP-PTR  4439--IMP-PTR  4476--IMP-PTR  4626--IMP-PTR  4664--IMP-PTR
      4730--IMP-PTR  4767--IMP-PTR  4804--IMP-PTR  4968--IMP-PTR  5009--IMP-PTR  5045--IMP-PTR  5081--IMP-PTR
      5132--IMP-PTR  5377--IMP-PTR  5421--IMP-PTR  5453<<ASSIGN   5454>>ASSIGN   5467>>DOWHILE  5470>>DOCASE
      5474>>CALL     5479>>CALL     5488>>ASSIGN   5489>>CALL     5490>>ASSIGN   5491>>CALL     5492>>CALL
      5493>>CALL     5494>>ASSIGN   5495>>CALL     5496>>CALL     5497>>CALL     5500>>CALL     5501>>CALL
      5502>>CALL     5505>>DOINDEX  5506>>IF       5507>>CALL     5512>>CALL     5513>>CALL     5514>>CALL
      5517>>ASSIGN   5518>>CALL     5519>>CALL     5520>>ASSIGN   5523>>CALL     5524>>IF       5525>>CALL
      5527>>CALL     5528>>CALL     5529>>ASSIGN   5530>>IF       5531>>CALL     5533>>CALL     5534>>ASSIGN
      5537>>ASSIGN   5538>>CALL     5540>>CALL     5544>>ASSIGN   5545>>CALL     5546>>IF       5547>>CALL
      5549>>CALL     5552>>ASSIGN   5553>>CALL     5554>>CALL     5555>>CALL     5558>>ASSIGN   5559>>CALL
      5560>>CALL     5561>>ASSIGN   5564>>IF       5565>>CALL     5566<<ASSIGN   5566>>ASSIGN   5568>>IF
      5569>>CALL     5571>>CALL     5572>>CALL     5573>>CALL     5574>>IF       5575>>CALL     5579>>DOINDEX
      5580>>CALL     5584>>ASSIGN   5585>>CALL     5586>>CALL     5587>>CALL     5588>>CALL     5593>>ASSIGN
      5596>>CALL     5597>>CALL     5600>>CALL     5601>>CALL     5604>>ASSIGN   5605>>CALL     5606>>ASSIGN
      5606>>ASSIGN   5608>>IF       5609>>CALL     5612>>ASSIGN   5612>>ASSIGN   5615>>CALL     5616>>CALL
      5625>>IF       5626<<ASSIGN   5626>>ASSIGN   5626>>ASSIGN   5629<<ASSIGN   5629>>ASSIGN   5629>>ASSIGN
      5644>>ASSIGN
OBJECT_NEXT$
      3290**DCL      4081<<ASSIGN   4088>>ASSIGN   4103>>ASSIGN   5454<<ASSIGN   5467>>DOWHILE  6108>>IF
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:257  
      6123>>ASSIGN   6124>>ASSIGN   6125<<ASSIGN   6125>>ASSIGN
OBJECT_SIZE
      3291**DCL      3298--IMP-SIZ  6101<<ASSIGN   6104<<ASSIGN   6107<<ASSIGN   6107>>ASSIGN   6108>>IF
      6123>>ASSIGN   6123>>ASSIGN   6125>>ASSIGN
OFREE_FAILED
      4156**LABEL    4114--CALLALT  4135--CALLALT  4149--CALLALT
STRUCTURE IN PROCEDURE INDEXIZE_STRUCTURE
      5693**DCL      5691--PROC     5938>>IF       5944>>ASSIGN   5946<<ASSIGN   5948<>CALL
STRUCTURES_FILE_BLOCK_DESC IN PROCEDURE INDEXIZE_STRUCTURE
      5703**DCL      5941<<ASSIGN   5946--ASSIGN
STRUCTURES_FILE_BLOCK_DESC.OBJECT.CLASS# IN PROCEDURE INDEXIZE_STRUCTURE
      5727**DCL      5942<<ASSIGN
STRUCTURES_FILE_BLOCK_DESC.OPTIONS.STRUCTURE$ IN PROCEDURE INDEXIZE_STRUCTURE
      5824**DCL      5943<<ASSIGN
STRUCTURES_FILE_BLOCK_DESC.RANGE.START.KEY IN PROCEDURE INDEXIZE_STRUCTURE
      5777**DCL      5944<<ASSIGN
SUM
      3292**DCL      4091<<ASSIGN   4096<<ASSIGN   4096>>ASSIGN   4098>>ASSIGN
VD$BLOCK_DESC.FILE_KEY.REP# IN PROCEDURE INDEXIZE_RECORD
      4842**DCL      5568>>IF
VD$BLOCK_DESC.FILE_KEY.V$ IN PROCEDURE INDEXIZE_RECORD
      4842**DCL      5569<>CALL
VD$BLOCK_DESC.OPTIONS.KEY_INCR.REP# IN PROCEDURE INDEXIZE_RECORD
      4939**DCL      5574>>IF
VD$BLOCK_DESC.OPTIONS.KEY_INCR.V$ IN PROCEDURE INDEXIZE_RECORD
      4939**DCL      5575<>CALL
VD$BLOCK_DESC.OPTIONS.STRUCTURE$ IN PROCEDURE INDEXIZE_RECORD
      4925**DCL      5573<>CALL
VD$BLOCK_DESC.RANGE.ENDD IN PROCEDURE INDEXIZE_RECORD
      4894**DCL      5572<>CALL
VD$BLOCK_DESC.RANGE.START IN PROCEDURE INDEXIZE_RECORD
      4866**DCL      5571<>CALL
VD$BUFFER.BYTES
      4032**DCL      4088--ASSIGN   4101--ASSIGN
VD$BUFFER.LENGTH#
      4030**DCL      4032--IMP-SIZ
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:258  
VD$BUFFER.BYTES IN PROCEDURE INDEXIZE_RECORD
      4996**DCL      5566--ASSIGN
VD$BUFFER.LENGTH# IN PROCEDURE INDEXIZE_RECORD
      4994**DCL      4996--IMP-SIZ
VD$BUFFER_HEADER.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      5035**DCL      5479<>CALL     5565<>CALL
VD$ENCODED_FILE_SPEC
      3671**DCL      4077<<ASSIGN   4077>>ASSIGN   4081--ASSIGN
VD$ERR
      3573**DCL      5642--ASSIGN
VD$ERR.ERR
      3610**DCL      4143<<ASSIGN
VD$ERR.ERR.CODE#
      3612**DCL      5640<<ASSIGN
VD$ERR.FLAGLEV#
      3615**DCL      4144<<ASSIGN   5641<<ASSIGN
VD$EVAL.BLINK$ IN PROCEDURE INDEXIZE_RECORD
      5158**DCL      5584--ASSIGN
VD$EVAL.ENCLOSING.ENDD IN PROCEDURE INDEXIZE_RECORD
      5209**DCL      5586<>CALL
VD$EVAL.ENCLOSING.START IN PROCEDURE INDEXIZE_RECORD
      5181**DCL      5585<>CALL
VD$EVAL.NODE$ IN PROCEDURE INDEXIZE_RECORD
      5366**DCL      5593--ASSIGN
VD$EVAL.RANGE.ENDD IN PROCEDURE INDEXIZE_RECORD
      5278**DCL      5588<>CALL
VD$EVAL.RANGE.START IN PROCEDURE INDEXIZE_RECORD
      5250**DCL      5587<>CALL
VD$FILE_NODE.DESC.KEY IN PROCEDURE INDEXIZE_STRUCTURE
      5914**DCL      5944>>ASSIGN
VD$FIT.CODE2$ IN PROCEDURE INDEXIZE_RECORD
      5403**DCL      5596<>CALL
VD$FIT.CODE3$ IN PROCEDURE INDEXIZE_RECORD
      5403**DCL      5597<>CALL
VD$IT_ADJUST.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4465**DCL      5518<>CALL
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:259  
VD$IT_ADJUST.MOVEMENTS$ IN PROCEDURE INDEXIZE_RECORD
      4465**DCL      5519<>CALL
VD$IT_ADJUST.MOVEMENTS_TAIL$ IN PROCEDURE INDEXIZE_RECORD
      4466**DCL      5520--ASSIGN
VD$IT_ADJUST.PARENT$ IN PROCEDURE INDEXIZE_RECORD
      4465**DCL      5517--ASSIGN
VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.REP# IN PROCEDURE INDEXIZE_RECORD
      4516**DCL      5524>>IF
VD$IT_BLOCK_EXPR.DOMAINN.FILE_KEY.V$ IN PROCEDURE INDEXIZE_RECORD
      4516**DCL      5525<>CALL
VD$IT_BLOCK_EXPR.DOMAINN.RANGE.ENDD IN PROCEDURE INDEXIZE_RECORD
      4568**DCL      5528<>CALL
VD$IT_BLOCK_EXPR.DOMAINN.RANGE.START IN PROCEDURE INDEXIZE_RECORD
      4540**DCL      5527<>CALL
VD$IT_BLOCK_EXPR.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4502**DCL      5523<>CALL
VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.REP# IN PROCEDURE INDEXIZE_RECORD
      4613**DCL      5530>>IF
VD$IT_BLOCK_EXPR.OPTIONS.KEY_INCR.V$ IN PROCEDURE INDEXIZE_RECORD
      4613**DCL      5531<>CALL
VD$IT_BLOCK_EXPR.OPTIONS.STRUCTURE$ IN PROCEDURE INDEXIZE_RECORD
      4599**DCL      5529--ASSIGN
VD$IT_BLOCK_EXPR.SELECTS$ IN PROCEDURE INDEXIZE_RECORD
      4616**DCL      5533<>CALL
VD$IT_BLOCK_EXPR.SELECTS_TAIL$ IN PROCEDURE INDEXIZE_RECORD
      4616**DCL      5534--ASSIGN
VD$IT_COMMAND.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4652**DCL      5538<>CALL
VD$IT_COMMAND.PARAM$ IN PROCEDURE INDEXIZE_RECORD
      4653**DCL      5540<>CALL
VD$IT_COMMAND.PARENT$ IN PROCEDURE INDEXIZE_RECORD
      4652**DCL      5537--ASSIGN
VD$IT_OPERAND.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4690**DCL      5545<>CALL
VD$IT_OPERAND.KEY.REP# IN PROCEDURE INDEXIZE_RECORD
      4718**DCL      5546>>IF
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:260  
VD$IT_OPERAND.KEY.V$ IN PROCEDURE INDEXIZE_RECORD
      4718**DCL      5547<>CALL
VD$IT_OPERAND.PARAM$ IN PROCEDURE INDEXIZE_RECORD
      4720**DCL      5549<>CALL
VD$IT_OPERAND.PARENT$ IN PROCEDURE INDEXIZE_RECORD
      4690**DCL      5544--ASSIGN
VD$IT_OPERATOR.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4756**DCL      5553<>CALL
VD$IT_OPERATOR.OPERAND$ IN PROCEDURE INDEXIZE_RECORD
      4756**DCL      5554<>CALL
VD$IT_OPERATOR.PARENT$ IN PROCEDURE INDEXIZE_RECORD
      4756**DCL      5552--ASSIGN
VD$IT_OPERATOR.R_OPERAND$ IN PROCEDURE INDEXIZE_RECORD
      4757**DCL      5555<>CALL
VD$IT_SELECT.ADJUSTS$ IN PROCEDURE INDEXIZE_RECORD
      4794**DCL      5560<>CALL
VD$IT_SELECT.ADJUSTS_TAIL$ IN PROCEDURE INDEXIZE_RECORD
      4794**DCL      5561--ASSIGN
VD$IT_SELECT.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4793**DCL      5559<>CALL
VD$IT_SELECT.PARENT$ IN PROCEDURE INDEXIZE_RECORD
      4793**DCL      5558--ASSIGN
VD$KEY
      3700**DCL      5604--ASSIGN   5606<<ASSIGN   5606>>ASSIGN   6107--ASSIGN
VD$KEY.REP#
      3704**DCL      5608>>IF
VD$KEY.V$
      3704**DCL      5609--CALL
VD$NAME_SPEC.DATA_TYPE#
      3810**DCL      4051>>IF
VD$NUMBER.OBJECT.CLASS#
      3658**DCL      5643<<ASSIGN
VD$NUMBER.V#
      3660**DCL      5644<<ASSIGN
VD$OBJECT_HEADER.CLASS#
      3320**DCL      5470>>DOCASE   5564>>IF       5626>>ASSIGN   5644>>ASSIGN   6101>>ASSIGN   6106>>IF
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:261  
VD$OBJECT_HEADER.SIZE#
      3320**DCL      5604<<ASSIGN   5625>>IF       5629>>ASSIGN   6100>>IF       6104>>ASSIGN
VD$PATTERN.ENTRIES.MATCH$ IN PROCEDURE INDEXIZE_RECORD
      5121**DCL      5580<>CALL
VD$PATTERN.N_ENTRIES# IN PROCEDURE INDEXIZE_RECORD
      5107**DCL      5579>>DOINDEX
VD$POINTER IN PROCEDURE INDEXIZE_RECORD
      5421**DCL      5604--ASSIGN   5606--ASSIGN   5609--CALL     5612--ASSIGN
VD$POINTER.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      5447**DCL      5600<>CALL     5605<>CALL     5615<>CALL
VD$POINTER.V$ IN PROCEDURE INDEXIZE_RECORD
      5447**DCL      5601<>CALL     5606>>ASSIGN   5608>>IF       5612--ASSIGN   5616<>CALL
VD$RECORD_SET.DESC.KEY.REP# IN PROCEDURE INDEXIZE_RECORD
      4375**DCL      5506>>IF
VD$RECORD_SET.DESC.KEY.V$ IN PROCEDURE INDEXIZE_RECORD
      4375**DCL      5507<>CALL
VD$RECORD_SET.N_ENTRIES# IN PROCEDURE INDEXIZE_RECORD
      4350**DCL      5505>>DOINDEX
VD$STRING_HEADER.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      5071**DCL      5474<>CALL
VD$STRUCTURE_SPEC.ACCESSOR$ IN PROCEDURE INDEXIZE_RECORD
      4428**DCL      5513<>CALL
VD$STRUCTURE_SPEC.FIT$ IN PROCEDURE INDEXIZE_RECORD
      4428**DCL      5514<>CALL
VD$STRUCTURE_SPEC.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4428**DCL      5512<>CALL
VD$TEXTC_REMOTE.LENGTH#
      3760**DCL      3762--IMP-SIZ
VD$WINDOW_BLOCK.EDIT_BLOCK$ IN PROCEDURE INDEXIZE_RECORD
      4313**DCL      5501<>CALL
VD$WINDOW_BLOCK.EVAL$ IN PROCEDURE INDEXIZE_RECORD
      4313**DCL      5502<>CALL
VD$WINDOW_BLOCK.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4313**DCL      5500<>CALL
VD$WINDOW_SPEC.DCB# IN PROCEDURE INDEXIZE_RECORD
      4264**DCL      5488<<ASSIGN
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:262  
VD$WINDOW_SPEC.EOFMARK$ IN PROCEDURE INDEXIZE_RECORD
      4275**DCL      5496<>CALL
VD$WINDOW_SPEC.FLINK$ IN PROCEDURE INDEXIZE_RECORD
      4247**DCL      5489<>CALL
VD$WINDOW_SPEC.KEY_DEFINITION_BUFFER$ IN PROCEDURE INDEXIZE_RECORD
      4276**DCL      5495<>CALL
VD$WINDOW_SPEC.OPERAND.EDIT_BLOCK$ IN PROCEDURE INDEXIZE_RECORD
      4262**DCL      5492<>CALL
VD$WINDOW_SPEC.OPERAND.EVAL$ IN PROCEDURE INDEXIZE_RECORD
      4262**DCL      5493<>CALL
VD$WINDOW_SPEC.OPERAND.INTREE$ IN PROCEDURE INDEXIZE_RECORD
      4262**DCL      5491<>CALL
VD$WINDOW_SPEC.OPERAND.STREAM$ IN PROCEDURE INDEXIZE_RECORD
      4262**DCL      5490--ASSIGN
VD$WINDOW_SPEC.RECORD_SET$ IN PROCEDURE INDEXIZE_RECORD
      4265**DCL      5494--ASSIGN
VD$WINDOW_SPEC.TABS$ IN PROCEDURE INDEXIZE_RECORD
      4274**DCL      5497<>CALL
VDG$OALLOC
      3196**DCL-ENT  4056--CALL     4141--CALL     5638--CALL     6110--CALL
VDG$OFREE
      3197**DCL-ENT  4114--CALL     4135--CALL     4149--CALL     6118--CALL
VD_ERR$
      3293**DCL      3573--IMP-PTR  4141<>CALL     4143>>ASSIGN   4144>>ASSIGN   5638<>CALL     5640>>ASSIGN
      5641>>ASSIGN   5642>>ASSIGN
VD_NUMBER$
      3294**DCL      3626--IMP-PTR  5642<<ASSIGN   5643>>ASSIGN   5644>>ASSIGN
VD_OBJECTS.SIZE
      3247**DCL      5626>>ASSIGN   6101>>ASSIGN
WRITE_CONTEXT_FILE_FAILED
      4141**LABEL    4107--CALLALT
WS_FILE_DCB
      3191**DCL        34--PROC     4100>>ASSIGN
WS_FILE_INVALID_FAILURE IN PROCEDURE INDEXIZE_RECORD
      5630**LABEL    5621--GOTO
WS_FILE_RECORD_NUMBER
PL6.E3A0      #004=VDW$STOW_NODE File=VDW$WORKSPACE.:VDA5TSI                     FRI 07/04/97 11:42 Page:263  
      3192**DCL        34--PROC     4060>>ASSIGN   4067>>IF       4117<<ASSIGN   4117>>ASSIGN
