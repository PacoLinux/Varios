VERSION A06

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:1    
        1        1        /*M*  Z8EL$LEX - Lexical analyzer */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        Z8EL$LEX :PROC NOAUTO;
        9        9
       10       10
       11       11        /*P*
       12       12               NAME:  Z8EL$LEX
       13       13            PURPOSE:  Main driver for the lexical analyzer.  It builds the next token
       14       14                      to be processed by the parser from the symbol returned by the
       15       15                      scanner.
       16       16        */
       17       17
       18       18        /*D*
       19       19               NAME:  Z8EL$LEX
       20       20               CALL:  CALL Z8EL$LEX ;
       21       21          INTERFACE:  Z8ES$SCANNER   -- Returns the next symbol.
       22       22                      Z8AH$SEARCH    -- Returns DNT$ pointing to the LEXEME item.
       23       23                      Z8AE$ERROR     -- Error message routine.
       24       24
       25       25              INPUT:  LA_PUT - Pointer to the current position in O1COM.LA_STK.
       26       26             OUTPUT:  LA_STK - Lexical analysis stack containing current symbols.
       27       27            SCRATCH:  O1COM.RECORD_DCL - Inside of a record declaration?
       28       28
       29       29        DESCRIPTION:  This procedure is called by the parser to get the next token.
       30       30                      The scanner is called and LA_STK is set up.  If a DNT entry is
       31       31                      needed the search routine to return the pointer.  All of the
       32       32                      values that need to be set up in the LA_STK are then
       33       33                      assigned to be used by the parser.
       34       34        */
       35       35        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:2    
       36       36
       37       37
       38       38        %EQU PHASE = 1;
       39       39        %EQU LOCALLY_LEAST_COST_RECOVERY = '0'B;
       40       40
       41       41        %INCLUDE Z8A_DEFC;
       42      109        %INCLUDE Z8A_SUPP_MAC;
       43     2509        %INCLUDE Z8A_COMCOM;
       44     3159        %INCLUDE Z8E_STACKS;
       45     5425        %INCLUDE Z8E_WINDOW;
       46     7495        %INCLUDE Z8E_TABLES;
       47     8048        %INCLUDE Z8E_BUFFERS;
       48     8238        %INCLUDE Z8E_O1COM;
       49     8999        %INCLUDE Z8A_TYPES;
       50     9173        %INCLUDE Z8A_ST;
       51    12832        %INCLUDE Z8A_DNT;
       52    13053        %INCLUDE Z8A_ERR_NUMS;
       53    13817        %INCLUDE Z8A_P_STATE;
       54    13827        %INCLUDE Z8E_HEAP;
       55    13883        %INCLUDE Z8E_REPLACE;
       56    14186
       57    14187    1   DCL GET_NEXT_SCANNER_LINE EPTR EXT INIT(ENTADDR(Z8EL$GET_NEXT_SCANNER_LINE));
       58    14188    1   DCL Z9AA$IS_ES_REQUIRED ENTRY;
       59    14189    1   DCL Z8EL$PROCESS_COPY ENTRY;
       60    14190    1   DCL Z8EL$PROCESS_REPLACE ENTRY;
       61    14191    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
       62    14192    1   DCL Z8EL$POSSIBLE_REPLACE ENTRY(1) ALTRET;
       63    14193    1   DCL Z8AU$CREATE_NUM_DESC ENTRY(3);
       64    14194    1   DCL Z8ED$DISPOSE_ABSSYN_TREE ENTRY(1);
       65    14195
       66    14196
       67    14197    1   DCL SEARCH_REQUIRED BOOLEAN EXT;
       68    14198
       69    14199    1   DCL LEX_STATE SBIN WORD EXT INIT(%LS_NORMAL);
       70    14200
       71    14201        %EQU ANSI_NUM_LIT_MAX_SIZE = 18;
       72    14202        %EQU NUM_LIT_MAX_SIZE = 63;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:3    
       73    14203        %EQU MAX_EXPONENT_DIGITS = 3;
       74    14204        %EQU USER_WORD_MAX_SIZE = 30;
       75    14205
       76    14206        %DCL_NUM_DESC;
       77    14215
       78    14216    1   DCL I SBIN WORD;
       79    14217        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:4    
       80    14218    1   DCL Z8AH$SEARCH_ ENTRY;
       81    14219    1   DCL Z8AE$ERROR ENTRY(12);
       82    14220
       83    14221    1   DCL 1 SAVED_SYMBOL STATIC ALIGNED, /* Storage for start of imperative stmt */
       84    14222    1         2 ALL_FIELDS_BUT_LINK,
       85    14223                %LA_STK_INFO(LVL=3);
       86    14242    1         2 LINK   UBIN WORD;
       87    14243    1   DCL SAVED_LEX_STATE SBIN STATIC;
       88    14244    1   DCL SAVED_CONT_FLAG BOOLEAN STATIC INIT(FALSE);
       89    14245
       90    14246    1   DCL CHAR_COLUMN SBIN WORD;
       91    14247    1   DCL CHAR_CLASS  SBIN WORD;
       92    14248
       93    14249    1   DCL TDNT$ PTR;
       94    14250    1   DCL HEAP$$  PTR;
       95    14251    1   DCL PROC$$  PTR;
       96    14252    1   DCL 1 PICTURE_SYMBOL STATIC,
       97    14253              %LEX_SYMBOL_INFO;
       98    14271    1         2 SYMBOL  CHAR(%MAX_SYMBOL_SIZE_PLUS_1);
       99    14272    1   DCL PARSING_PICTURE BOOLEAN STATIC INIT(FALSE);
      100    14273
      101    14274        %DEF_BUCKETS;
      102    14277        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:5    
      103    14278        %MACRO SAVE_IMPERATIVE_STMT_RSV_WRD ;
      104    14279               DO ;
      105    14280                  SAVED_SYMBOL = O1COM.LA_STK(O1COM.LA_PUT);
      106    14281                  SAVED_LEX_STATE = %LS_NORMAL;
      107    14282                  O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %INVISIBLE_STMT_START ;
      108    14283                  O1COM.LA_STK.DNT$(O1COM.LA_PUT) = ADDR(NIL) ;
      109    14284                  O1COM.LA_STK.FLAGS(O1COM.LA_PUT) = FALSE;
      110    14285                  O1COM.LA_STK.ST$(O1COM.LA_PUT) = ADDR(NIL);
      111    14286                  O1COM.LA_STK.TYPE(O1COM.LA_PUT) = 0;
      112    14287                  /* Leave line and column the same */
      113    14288                  LEX_STATE = %LS_PICK_UP_SAVED_SYMBOL;
      114    14289               END ;
      115    14290        %MEND ;
      116    14291
      117    14292        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:6    
      118    14293        %MACRO INITIALIZE_LA_STK_ITEM;
      119    14294          DO;
      120    14295            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
      121    14296                                @LA_ITEM = TRUE,
      122    14297                                @SYMBOL = LEX_SYMBOL.TYPE,
      123    14298                                @LINE = LEX_SYMBOL.LINE,
      124    14299                                @COLUMN = LEX_SYMBOL.COLUMN);
      125    14300          END;
      126    14301        %MEND;
      127    14302        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:7    
      128    14303        %MACRO CHECK_DELIM_AND_SIZE;
      129    14304          DO;
      130    14305
      131    14306          /* Check symbol for length */
      132    14307          IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN
      133    14308            DO;
      134    14309              CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,
      135    14310                              LEX_SYMBOL.LINE,
      136    14311                              LEX_SYMBOL.COLUMN);
      137    14312              LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;
      138    14313            END;
      139    14314
      140    14315          /* Check symbol for delimiter error */
      141    14316          IF LEX_SYMBOL.B.DELIM_ERROR THEN
      142    14317            DO;
      143    14318              CALL Z8AE$ERROR (%E$MISSING_DELIMITER,
      144    14319                               LEX_SYMBOL.LINE,
      145    14320                               LEX_SYMBOL.COLUMN);
      146    14321            END;
      147    14322
      148    14323
      149    14324          END;
      150    14325        %MEND;
      151    14326        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:8    
      152    14327    1   CREATE_DUMMY_NUM_LIT : PROC;
      153    14328
      154    14329    2     O1COM.LA_STK.B.ERROR(O1COM.LA_PUT) = TRUE;
      155    14330    2     O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT_OF_1$;
      156    14331
      157    14332    2   END CREATE_DUMMY_NUM_LIT;
      158    14333        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:9    
      159    14334        %MACRO VALIDATE_NUM_DESC;
      160    14335          DO;
      161    14336            IF COMCOM.OB.FIPS.LEVEL > 0
      162    14337                  AND NUM_DESC.DIGITS_LEFT
      163    14338                        + NUM_DESC.DIGITS_RIGHT
      164    14339                          > %ANSI_NUM_LIT_MAX_SIZE THEN
      165    14340              DO;
      166    14341                CALL Z8AE$ERROR (%E$ANSI_LARGE_NUMERIC_ITEM,
      167    14342                                 LEX_SYMBOL.LINE,
      168    14343                                 LEX_SYMBOL.COLUMN);
      169    14344              END;
      170    14345
      171    14346            IF COMCOM.OB.FIPS.LEVEL > 0
      172    14347                   AND NUM_DESC.DIGITS_EXPONENT > 0 THEN
      173    14348              DO;
      174    14349                CALL Z8AE$ERROR (%E$ANSI_FLOATING_POINT,
      175    14350                                 LEX_SYMBOL.LINE,
      176    14351                                 LEX_SYMBOL.COLUMN);
      177    14352              END;
      178    14353
      179    14354            IF NUM_DESC.DIGITS_LEFT
      180    14355                   + NUM_DESC.DIGITS_RIGHT
      181    14356                     > %NUM_LIT_MAX_SIZE THEN
      182    14357              DO;
      183    14358                CALL Z8AE$ERROR (%E$NUMERIC_ITEM_TOO_LONG,
      184    14359                                 LEX_SYMBOL.LINE,
      185    14360                                 LEX_SYMBOL.COLUMN);
      186    14361                CALL CREATE_DUMMY_NUM_LIT;
      187    14362              END;
      188    14363            ELSE
      189    14364              IF NUM_DESC.DIGITS_EXPONENT > %MAX_EXPONENT_DIGITS THEN
      190    14365                DO;
      191    14366                  CALL Z8AE$ERROR (%E$TOO_LARGE_NUM_EXP,
      192    14367                                   LEX_SYMBOL.LINE,
      193    14368                                   LEX_SYMBOL.COLUMN);
      194    14369                  CALL CREATE_DUMMY_NUM_LIT;
      195    14370                END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:10   
      196    14371
      197    14372            IF NUM_DESC.COMMA_PRESENT
      198    14373            AND (O1COM.CURRENT_PROC$ = ADDR(NIL)
      199    14374                 OR NOT O1COM.CURRENT_PROC$ -> PROC_.B.COMMA_IS_DECIMAL) THEN
      200    14375              CALL Z8AE$ERROR(%E$COMMA_IN_NUMBER,
      201    14376                              LEX_SYMBOL.LINE,
      202    14377                              LEX_SYMBOL.COLUMN);
      203    14378          END;
      204    14379        %MEND;
      205    14380        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:11   
      206    14381    1   REPLACED_TOKEN : PROC;
      207    14382
      208    14383           %LIST;
      209    14384
      210    14385
      211    14386    2   NEW_TOKEN:
      212    14387
      213    14388          %GET_A_TOKEN;
             14389    3   DO;
             14390    3     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN
             14391          %GET_LEX_SYMBOL_FROM_QUEUE;
             14392    4     DO;
             14393            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14394                                   TO$ = "ADDR(LEX_SYMBOL)");
             14395    5     DO;
             14396    5       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14397    5       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14398    5     END;
             14400    4       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
             14401                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14402    4     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14404    4                                 );
             14405    4       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
             14406    4       LEX_SYMBOL.NEXT$ = ADDR(NIL);
             14407    4     END;
             14409    3     ELSE
             14410    4       DO;
             14411              %GET_BRAND_NEW_TOKEN;
             14412    5       DO;
             14413    5         CALL Z8ES$SCANNER;
             14414    6         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;
             14415    6           CALL Z8EL$GET_NEXT_SCANNER_LINE;
             14416    6           CALL Z8ES$SCANNER;
             14417    6         END;
             14418    5       END;
             14420    4         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL
             14421    4              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:12   
             14422    4           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);
             14423    4     END;
             14424    3   END;
      214    14426    2   GOT_TOKEN:
      215    14427
      216    14428    2     IF SAVED_CONT_FLAG THEN
      217    14429    2       LEX_SYMBOL.B.CONTINUED_TOKEN = TRUE;
      218    14430
      219    14431    2     IF NOT REPLACE_ACTIVE THEN
      220    14432    3       DO;
      221    14433    3         SEARCH_REQUIRED = TRUE;
      222    14434    3       END;
      223    14435    2     ELSE
      224    14436    3       DO;
      225    14437    3         CALL Z8AH$SEARCH_;
      226    14438    3         IF DNT$ -> DNT.B.REPLACE_TOKEN THEN
      227    14439    4           DO;
      228    14440
      229    14441                  /* Put lex symbol at front of queue */
      230    14442                  %SAVE_TOKEN_ON_THE_QUEUE;
             14443    5      DO;
             14444             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14445                                      TO$   = HEAP$);
             14446    6     DO;
             14447    6       CALL Z8ED$NEW_HEAP (TO$,
             14448                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14449    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14451    6                             );
             14452            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14453    7     DO;
             14454    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14455    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14456    7     END;
             14458    6     END;
             14460    5        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
             14461    5        LEX_SYMBOL_QUEUE$ = HEAP$;
             14462    5      END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:13   
      231    14464
      232    14465                  /* Check for end of PIC before calling POSSIBLE_REPLACE.  */
      233    14466                  /* See procedure CONSOLIDATE_PICTURE_STRING (STAR T02424) */
      234    14467
      235    14468    4             IF PARSING_PICTURE AND
      236    14469    4               (PICTURE_SYMBOL.END_COLUMN ~= LEX_SYMBOL.COLUMN
      237    14470    4                OR PICTURE_SYMBOL.END_LINE   ~= LEX_SYMBOL.LINE
      238    14471    4                OR LEX_SYMBOL.TYPE = %PERIOD) THEN
      239    14472    5                  DO;
      240    14473    5                    LEX_STATE = %LS_NORMAL;
      241    14474    5                    PARSING_PICTURE = FALSE;
      242    14475    5                  END;
      243    14476
      244    14477    4             CALL Z8EL$POSSIBLE_REPLACE (0)
      245    14478    4               WHENRETURN
      246    14479    5                 DO;
      247    14480    5                   GOTO NEW_TOKEN;
      248    14481    5                 END;
      249    14482    4               WHENALTRETURN
      250    14483    5                 DO;
      251    14484                        %GET_LEX_SYMBOL_FROM_QUEUE;
             14485    6     DO;
             14486            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14487                                   TO$ = "ADDR(LEX_SYMBOL)");
             14488    7     DO;
             14489    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14490    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14491    7     END;
             14493    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
             14494                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14495    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14497    6                                 );
             14498    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
             14499    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);
             14500    6     END;
      252    14502    5                   SEARCH_REQUIRED = TRUE;
      253    14503    5                 END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:14   
      254    14504    4           END;
      255    14505    3         ELSE IF BUFFER.CLASS = %SPACE OR
      256    14506    3             BUFFER.CLASS = %END_OF_LINE OR
      257    14507    3             BUFFER.CLASS = %END_OF_FILE OR
      258    14508    3             (LEX_SYMBOL.TYPE ~= %USER_WORD AND
      259    14509    3              LEX_SYMBOL.TYPE ~= %NUMBER_OR_PARAGRAPH AND
      260    14510    3              LEX_SYMBOL.TYPE ~= %NUMBER AND
      261    14511    3              LEX_SYMBOL.TYPE ~= %NAME AND
      262    14512    3              LEX_SYMBOL.TYPE ~= %LETTER_E) OR
      263    14513    3             PARSING_PICTURE THEN
      264    14514    3           SEARCH_REQUIRED = FALSE;
      265    14515    3         ELSE
      266    14516    4           DO;
      267    14517                  %SAVE_CURRENT_TOKEN;
             14518    5      DO;
             14519    5        TEMP_LEX_SYMBOL = LEX_SYMBOL;
             14520    5      END;
      268    14522                  %GET_A_TOKEN;
             14523    5   DO;
             14524    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN
             14525          %GET_LEX_SYMBOL_FROM_QUEUE;
             14526    6     DO;
             14527            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14528                                   TO$ = "ADDR(LEX_SYMBOL)");
             14529    7     DO;
             14530    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14531    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14532    7     END;
             14534    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
             14535                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14536    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14538    6                                 );
             14539    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
             14540    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);
             14541    6     END;
             14543    5     ELSE
             14544    6       DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:15   
             14545              %GET_BRAND_NEW_TOKEN;
             14546    7       DO;
             14547    7         CALL Z8ES$SCANNER;
             14548    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;
             14549    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;
             14550    8           CALL Z8ES$SCANNER;
             14551    8         END;
             14552    7       END;
             14554    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL
             14555    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14556    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);
             14557    6     END;
             14558    5   END;
      269    14560    4             CALL Z8AH$SEARCH_;
      270    14561                  %SAVE_TOKEN_ON_THE_QUEUE;
             14562    5      DO;
             14563             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14564                                      TO$   = HEAP$);
             14565    6     DO;
             14566    6       CALL Z8ED$NEW_HEAP (TO$,
             14567                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14568    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14570    6                             );
             14571            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14572    7     DO;
             14573    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14574    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14575    7     END;
             14577    6     END;
             14579    5        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
             14580    5        LEX_SYMBOL_QUEUE$ = HEAP$;
             14581    5      END;
      271    14583    4             IF DNT$ -> DNT.B.REPLACE_TOKEN THEN
      272    14584    5               DO;
      273    14585
      274    14586    5                 CALL Z8EL$POSSIBLE_REPLACE (0)
      275    14587    6                   WHENRETURN DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:16   
      276    14588                          %LOAD_SAVED_TOKEN;
             14589    7      DO;
             14590    7        LEX_SYMBOL = TEMP_LEX_SYMBOL;
             14591    7      END;
      277    14593    6                     IF LEX_SYMBOL_QUEUE$ ~= ADDR (NIL) AND
      278    14594    6                         SUBSTR (BUFFER_LINE,
      279    14595    6                                 LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.COLUMN - 1,
      280    14596    6                                 1) ~= ' ' THEN
      281    14597    7                       DO;
      282    14598    7                       I = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.SIZE;
      283    14599    7                       IF I > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE
      284    14600    7                         THEN I = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;
      285    14601    7                       SUBSTR (LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, I)
      286    14602    7                         = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.SYMBOL;
      287    14603    7                       LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + I;
      288    14604    7                       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;
      289    14605    7                       HEAP$$ = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.NEXT$;
      290    14606    7                       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
      291    14607                                                    %LEX_SYMBOL_ACTUAL_WORD_LEN (S$=
             14607                                                        LEX_SYMBOL_QUEUE$);
             14608    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
      292    14610    7                                               );
      293    14611    7                       LEX_SYMBOL_QUEUE$ = HEAP$$;
      294    14612    7                       END;
      295    14613    6                     GOTO GOT_TOKEN;
      296    14614    6                   END;
      297    14615    5               END; /* DNT$ -> DNT.B.REPLACE_TOKEN */
      298    14616                  %LOAD_SAVED_TOKEN;
             14617    5      DO;
             14618    5        LEX_SYMBOL = TEMP_LEX_SYMBOL;
             14619    5      END;
      299    14621    4             SEARCH_REQUIRED = TRUE;
      300    14622    4           END;
      301    14623    3       END;
      302    14624
      303    14625          /* Ignore COPY & REPLACE in comment entries if column > 11 */
      304    14626
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:17   
      305    14627    2     IF NOT IGNORE_COPY_REPLACE
      306    14628    2     OR LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START THEN
      307    14629    3       DO;
      308    14630              /* Check for copy/replace */
      309    14631    3         IF LEX_SYMBOL.SIZE = 4
      310    14632    3             AND SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'COPY' THEN
      311    14633    4           DO;
      312    14634    4             CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;
      313    14635    4             CALL Z8EL$PROCESS_COPY;
      314    14636    4             GOTO NEW_TOKEN;
      315    14637    4           END;
      316    14638    3         ELSE
      317    14639    3           IF LEX_SYMBOL.SIZE = 7
      318    14640    3             AND SUBSTR(LEX_SYMBOL.SYMBOL,0,7) = 'REPLACE' THEN
      319    14641    4             DO;
      320    14642    4               IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN
      321    14643    4                 CALL Z8AE$ERROR (%E$LEVEL_CHECK,
      322    14644    4                                  LEX_SYMBOL.LINE,
      323    14645    4                                  LEX_SYMBOL.COLUMN);
      324    14646    4               CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;
      325    14647    4               CALL Z8EL$PROCESS_REPLACE;
      326    14648    4               GOTO NEW_TOKEN;
      327    14649    4             END;
      328    14650    3       END;
      329    14651
      330    14652        /* Next two macro calls are designed to resolve the problems
      331    14653           of LALR1 parsing limitation, so WITH DATA or NO DATA won't
      332    14654           mess up with WITH NO ADVANCING clause, and, ON SIZE ERROR
      333    14655           won't mess up with NOT ON EXCEPTION clause                */
      334    14656
      335    14657          %REPLACE_WITH_DATA_NO_DATA;
             14658    3     DO;
             14659    3       IF LEX_SYMBOL.SIZE = 4 AND
             14660    3         SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'WITH' THEN
             14661    4          DO;
             14662                 %SAVE_CURRENT_TOKEN;
             14663    5      DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:18   
             14664    5        TEMP_LEX_SYMBOL = LEX_SYMBOL;
             14665    5      END;
             14667                 %GET_A_TOKEN;
             14668    5   DO;
             14669    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN
             14670          %GET_LEX_SYMBOL_FROM_QUEUE;
             14671    6     DO;
             14672            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14673                                   TO$ = "ADDR(LEX_SYMBOL)");
             14674    7     DO;
             14675    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14676    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14677    7     END;
             14679    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
             14680                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14681    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14683    6                                 );
             14684    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
             14685    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);
             14686    6     END;
             14688    5     ELSE
             14689    6       DO;
             14690              %GET_BRAND_NEW_TOKEN;
             14691    7       DO;
             14692    7         CALL Z8ES$SCANNER;
             14693    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;
             14694    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;
             14695    8           CALL Z8ES$SCANNER;
             14696    8         END;
             14697    7       END;
             14699    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL
             14700    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14701    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);
             14702    6     END;
             14703    5   END;
             14705    4            IF LEX_SYMBOL.SIZE = 4 AND
             14706    4              SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'DATA' THEN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:19   
             14707                     %REPLACE_WITH_DATA_TOKEN;
             14708    5      DO;
             14709    5        LEX_SYMBOL.LINE = TEMP_LEX_SYMBOL.LINE;
             14710    5        LEX_SYMBOL.COLUMN = TEMP_LEX_SYMBOL.COLUMN;
             14711    5        LEX_SYMBOL.SIZE = %WITH_DATA_SIZE;
             14712    5        SUBSTR(LEX_SYMBOL.SYMBOL,0,%WITH_DATA_SIZE) = %WITH_DATA_TEXT;
             14713    5      END;
             14715    4            ELSE
             14716    5              DO;
             14717                     %SAVE_TOKEN_ON_THE_QUEUE;
             14718    6      DO;
             14719             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14720                                      TO$   = HEAP$);
             14721    7     DO;
             14722    7       CALL Z8ED$NEW_HEAP (TO$,
             14723                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14724    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14726    7                             );
             14727            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14728    8     DO;
             14729    8       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14730    8       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14731    8     END;
             14733    7     END;
             14735    6        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
             14736    6        LEX_SYMBOL_QUEUE$ = HEAP$;
             14737    6      END;
             14739                     %LOAD_SAVED_TOKEN;
             14740    6      DO;
             14741    6        LEX_SYMBOL = TEMP_LEX_SYMBOL;
             14742    6      END;
             14744    5              END;
             14745    4          END;
             14746    3       IF LEX_SYMBOL.SIZE = 2 AND
             14747    3         SUBSTR(LEX_SYMBOL.SYMBOL,0,2) = 'NO' THEN
             14748    4          DO;
             14749                 %SAVE_CURRENT_TOKEN;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:20   
             14750    5      DO;
             14751    5        TEMP_LEX_SYMBOL = LEX_SYMBOL;
             14752    5      END;
             14754                 %GET_A_TOKEN;
             14755    5   DO;
             14756    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN
             14757          %GET_LEX_SYMBOL_FROM_QUEUE;
             14758    6     DO;
             14759            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14760                                   TO$ = "ADDR(LEX_SYMBOL)");
             14761    7     DO;
             14762    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14763    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14764    7     END;
             14766    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
             14767                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14768    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14770    6                                 );
             14771    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
             14772    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);
             14773    6     END;
             14775    5     ELSE
             14776    6       DO;
             14777              %GET_BRAND_NEW_TOKEN;
             14778    7       DO;
             14779    7         CALL Z8ES$SCANNER;
             14780    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;
             14781    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;
             14782    8           CALL Z8ES$SCANNER;
             14783    8         END;
             14784    7       END;
             14786    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL
             14787    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14788    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);
             14789    6     END;
             14790    5   END;
             14792    4            IF LEX_SYMBOL.SIZE = 4 AND
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:21   
             14793    4              SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'DATA' THEN
             14794                     %REPLACE_NO_DATA_TOKEN;
             14795    5      DO;
             14796    5        LEX_SYMBOL.LINE = TEMP_LEX_SYMBOL.LINE;
             14797    5        LEX_SYMBOL.COLUMN = TEMP_LEX_SYMBOL.COLUMN;
             14798    5        LEX_SYMBOL.SIZE = %NO_DATA_SIZE;
             14799    5        SUBSTR(LEX_SYMBOL.SYMBOL,0,%NO_DATA_SIZE) = %NO_DATA_TEXT;
             14800    5      END;
             14802    4            ELSE
             14803    5              DO;
             14804                     %SAVE_TOKEN_ON_THE_QUEUE;
             14805    6      DO;
             14806             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14807                                      TO$   = HEAP$);
             14808    7     DO;
             14809    7       CALL Z8ED$NEW_HEAP (TO$,
             14810                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14811    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14813    7                             );
             14814            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14815    8     DO;
             14816    8       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14817    8       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14818    8     END;
             14820    7     END;
             14822    6        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
             14823    6        LEX_SYMBOL_QUEUE$ = HEAP$;
             14824    6      END;
             14826                     %LOAD_SAVED_TOKEN;
             14827    6      DO;
             14828    6        LEX_SYMBOL = TEMP_LEX_SYMBOL;
             14829    6      END;
             14831    5              END;
             14832    4          END;
             14833    3     END;
      336    14835
      337    14836          %REPLACE_NOT_ON_EXCEPTION_TOKEN;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:22   
             14837    3     DO;
             14838    3       IF LEX_SYMBOL.SIZE = 3 AND
             14839    3          SUBSTR(LEX_SYMBOL.SYMBOL,0,3) = 'NOT' THEN
             14840    4         DO;
             14841    4           TEMP_LEX_SYMBOL2 = LEX_SYMBOL;
             14842                %GET_A_TOKEN;
             14843    5   DO;
             14844    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN
             14845          %GET_LEX_SYMBOL_FROM_QUEUE;
             14846    6     DO;
             14847            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14848                                   TO$ = "ADDR(LEX_SYMBOL)");
             14849    7     DO;
             14850    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14851    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14852    7     END;
             14854    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
             14855                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14856    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14858    6                                 );
             14859    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
             14860    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);
             14861    6     END;
             14863    5     ELSE
             14864    6       DO;
             14865              %GET_BRAND_NEW_TOKEN;
             14866    7       DO;
             14867    7         CALL Z8ES$SCANNER;
             14868    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;
             14869    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;
             14870    8           CALL Z8ES$SCANNER;
             14871    8         END;
             14872    7       END;
             14874    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL
             14875    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14876    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);
             14877    6     END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:23   
             14878    5   END;
             14880                %REPLACE_ON_EXCEPTION_TOKEN;
             14881    5     DO;
             14882    5       IF LEX_SYMBOL.SIZE = 2 AND
             14883    5         SUBSTR(LEX_SYMBOL.SYMBOL,0,2) = 'ON' THEN
             14884    6         DO;
             14885                %SAVE_CURRENT_TOKEN;
             14886    7      DO;
             14887    7        TEMP_LEX_SYMBOL = LEX_SYMBOL;
             14888    7      END;
             14890                %GET_A_TOKEN;
             14891    7   DO;
             14892    7     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN
             14893          %GET_LEX_SYMBOL_FROM_QUEUE;
             14894    8     DO;
             14895            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14896                                   TO$ = "ADDR(LEX_SYMBOL)");
             14897    9     DO;
             14898    9       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14899    9       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14900    9     END;
             14902    8       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,
             14903                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14904    8     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14906    8                                 );
             14907    8       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
             14908    8       LEX_SYMBOL.NEXT$ = ADDR(NIL);
             14909    8     END;
             14911    7     ELSE
             14912    8       DO;
             14913              %GET_BRAND_NEW_TOKEN;
             14914    9       DO;
             14915    9         CALL Z8ES$SCANNER;
             14916   10         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;
             14917   10           CALL Z8EL$GET_NEXT_SCANNER_LINE;
             14918   10           CALL Z8ES$SCANNER;
             14919   10         END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:24   
             14920    9       END;
             14922    8         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL
             14923    8              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14924    8           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);
             14925    8     END;
             14926    7   END;
             14928    6           IF LEX_SYMBOL.SIZE ~= 9 OR
             14929    6             SUBSTR(LEX_SYMBOL.SYMBOL,0,9) ~= 'EXCEPTION' THEN
             14930    7             DO;
             14931                    %SAVE_TOKEN_ON_THE_QUEUE;
             14932    8      DO;
             14933             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14934                                      TO$   = HEAP$);
             14935    9     DO;
             14936    9       CALL Z8ED$NEW_HEAP (TO$,
             14937                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14938    9     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14940    9                             );
             14941            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14942   10     DO;
             14943   10       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14944   10       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14945   10     END;
             14947    9     END;
             14949    8        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
             14950    8        LEX_SYMBOL_QUEUE$ = HEAP$;
             14951    8      END;
             14953                    %LOAD_SAVED_TOKEN;
             14954    8      DO;
             14955    8        LEX_SYMBOL = TEMP_LEX_SYMBOL;
             14956    8      END;
             14958    7             END;
             14959    6         END;
             14960    5     END;
             14962    4           IF LEX_SYMBOL.SIZE ~= 9 OR
             14963    4              SUBSTR(LEX_SYMBOL.SYMBOL,0,9) ~= 'EXCEPTION' THEN
             14964    5             DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:25   
             14965                    %SAVE_TOKEN_ON_THE_QUEUE;
             14966    6      DO;
             14967             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14968                                      TO$   = HEAP$);
             14969    7     DO;
             14970    7       CALL Z8ED$NEW_HEAP (TO$,
             14971                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14972    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14974    7                             );
             14975            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14976    8     DO;
             14977    8       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;
             14978    8       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;
             14979    8     END;
             14981    7     END;
             14983    6        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
             14984    6        LEX_SYMBOL_QUEUE$ = HEAP$;
             14985    6      END;
             14987    5               LEX_SYMBOL = TEMP_LEX_SYMBOL2;
             14988    5             END;
             14989    4           ELSE
             14990    5             DO;
             14991    5               LEX_SYMBOL.LINE = TEMP_LEX_SYMBOL2.LINE;
             14992    5               LEX_SYMBOL.COLUMN = TEMP_LEX_SYMBOL2.COLUMN;
             14993    5               LEX_SYMBOL.SIZE = 16;
             14994    5               SUBSTR(LEX_SYMBOL.SYMBOL,0,16) = 'NOT ON EXCEPTION';
             14995    5             END;
             14996    4         END;
             14997    3      END;
      338    14999
      339    15000
      340    15001    2   IF (NOT O1COM.DEBUGGING_MODE)
      341    15002    2         AND LEX_SYMBOL.B.DEBUG_TOKEN THEN
      342    15003    2     GOTO NEW_TOKEN;
      343    15004
      344    15005    2   END REPLACED_TOKEN;
      345    15006        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:26   
      346    15007    1   SCAN_COMMENT_ENTRY: PROC ;
      347    15008
      348    15009    2     DCL CONTINUATION_ISN SBIN WORD;
      349    15010
      350    15011    2     CONTINUATION_ISN = CURRENT_BUFFER$ -> FILL_BUFFER.ISN;
      351    15012
      352    15013    2     IGNORE_COPY_REPLACE = TRUE;
      353    15014
      354    15015             /*N* Free_Format -- The following DO is valid for fixed_format
      355    15016                                 and the free_format subset only.
      356    15017             */
      357    15018
      358    15019    3          DO UNTIL LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START
      359    15020    3                    OR
      360    15021    3                   LEX_SYMBOL.TYPE = %END_OF_FILE;
      361    15022
      362    15023    3            CALL REPLACED_TOKEN;
      363    15024
      364    15025    3            IF O1COM.AUTHOR_COMMENT     THEN
      365    15026    4             DO;
      366    15027    4                IF LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START OR
      367    15028    4                    LEX_SYMBOL.TYPE = %END_OF_FILE        THEN   ;
      368    15029    4                  ELSE
      369    15030    5                    DO;
      370    15031    5                      CALL Z8AH$SEARCH_;
      371    15032    5                      COMCOM.AUTHOR$ = DNT$;
      372    15033    5                    END;
      373    15034    4                O1COM.AUTHOR_COMMENT = %FALSE;
      374    15035    4             END;
      375    15036
      376    15037    3            IF O1COM.ID_DIV_COUNT = 0  AND O1COM.INSTAL_ON THEN
      377    15038    4              DO;
      378    15039    4                IF LEX_SYMBOL.COLUMN >= O1COM.AREA_B_COLUMN_START AND
      379    15040    4                  (LEX_SYMBOL.TYPE = %ALPHA_LITERAL OR
      380    15041    4                   LEX_SYMBOL.TYPE = %SINGLE_QUOTE) THEN
      381    15042    5                  DO;
      382    15043    5                    CALL Z8AH$SEARCH_;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:27   
      383    15044
      384    15045                         %NEW_HEAP (@POINTER = HEAP$$);
             15046    6     DO;
             15047    6       CALL Z8ED$NEW_HEAP (@POINTER, @SIZE);
             15048    6     END;
      385    15050
      386    15051                         %INIT_LX_TERMINAL (@POINTER = HEAP$$,
      387    15052                                            @DNT$    = DNT$,
      388    15053                                            @SYMBOL  = LEX_SYMBOL.TYPE,
      389    15054                                            @LINE    = LEX_SYMBOL.LINE,
      390    15055                                            @COLUMN  = LEX_SYMBOL.COLUMN);
             15056    6     DO;
             15057    6       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;
             15058    6       @POINTER -> LX_TERMINAL.B      = '0'B;
             15059            %IF (TEXTCHAR(@BERROR) ~= '');
             15061            %ENDIF;
             15062    6       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;
             15063            %IF (TEXTCHAR(@LA_ITEM) = '');
             15064    6         @POINTER -> LX_TERMINAL.LINK   = @LINK;
             15065            %ENDIF;
             15066    6       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;
             15067    6       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;
             15068    6       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;
             15069    6       @POINTER -> LX_TERMINAL.LINE   = @LINE;
             15070    6       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;
             15071    6     END;
      391    15073
      392    15074    5                    IF COMCOM.INSTALLATION$ ~= ADDR(NIL) THEN
      393    15075    5                      CALL Z8ED$DISPOSE_ABSSYN_TREE (COMCOM.INSTALLATION$);
      394    15076
      395    15077    5                    COMCOM.INSTALLATION$ = HEAP$$;
      396    15078
      397    15079    5                  END;
      398    15080    4                O1COM.INSTAL_ON = FALSE;
      399    15081    4              END;
      400    15082
      401    15083    3            IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.CONTINUATION THEN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:28   
      402    15084    3              IF CONTINUATION_ISN ~=
      403    15085    3                   CURRENT_BUFFER$ -> FILL_BUFFER.ISN THEN
      404    15086    4                DO;
      405    15087    4                  CALL Z8AE$ERROR (%E$ERR_COMMENT_ENTRY_CONTINUE,
      406    15088    4                           CURRENT_BUFFER$ -> FILL_BUFFER.ISN,
      407    15089    4                           O1COM.AREA_A_COLUMN_START - 1);
      408    15090    4                  CONTINUATION_ISN = CURRENT_BUFFER$ -> FILL_BUFFER.ISN;
      409    15091    4                END;
      410    15092
      411    15093    3          END ;
      412    15094
      413    15095    2     IGNORE_COPY_REPLACE = FALSE;
      414    15096
      415    15097    2   END SCAN_COMMENT_ENTRY ;
      416    15098        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:29   
      417    15099        %MACRO CHECK_REDECL_OF_RESERVED_WORD;
      418    15100          DO;
      419    15101
      420    15102               IF O1COM.RECORD_DCL THEN
      421    15103                 DO;
      422    15104
      423    15105        /*V*
      424    15106            RESERVED_WRD_DCL_CHECK -- If the item is a reserved word and we are in
      425    15107                                      the process of a declaration the reserved word
      426    15108                                      bit is turned off in the DNT.  The item is changed
      427    15109                                      to a user word so that a person can declare a
      428    15110                                      reserved word and use that data name in the
      429    15111                                      program.  He may not use it as a reserved
      430    15112                                      word though.
      431    15113
      432    15114                                      This was done due to the fact that there are
      433    15115                                      new reserved words in COBOL85 in addition to
      434    15116                                      to the many before.
      435    15117        */
      436    15118
      437    15119                   IF DNT$->DNT.B.RW AND O1COM.PARSE_ERROR_COUNT = 0 THEN
      438    15120                     DO CASE (DNT$ -> DNT.RW_NO);
      439    15121
      440    15122                       CASE(ELSE);
      441    15123
      442    15124                         CALL Z8AE$ERROR (%E$RW_USED_AS_DATA_NAME,
      443    15125                                          LEX_SYMBOL.LINE,
      444    15126                                          LEX_SYMBOL.COLUMN,
      445    15127                                          DNT$);
      446    15128                         /* Create new DNT for non-reserved word since reserved
      447    15129                               word is in constant storage */
      448    15130                         TDNT$ = DNT$;
      449    15131                         %NEW_DNT(@SIZE = LEX_SYMBOL.SIZE,
      450    15132                                     @NAME = LEX_SYMBOL.SYMBOL,
      451    15133                                     @ST$ = TDNT$ -> DNT.ST$,
      452    15134                                     @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");
      453    15135                         DNT$ -> DNT.ATTR = TDNT$ -> DNT.ATTR;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:30   
      454    15136                         DNT$ -> DNT.B.USER_WORD = TRUE;
      455    15137                         DNT$ -> DNT.B.RW = FALSE;
      456    15138                         DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;
      457    15139
      458    15140                       CASE (%RSV_WRD_FILLER,  %RSV_WRD_PICTURE, %RSV_WRD_USAGE,
      459    15141                             %RSV_WRD_SIGN,    %RSV_WRD_LEADING, %RSV_WRD_TRAILING,
      460    15142                             %RSV_WRD_DISPLAY, %RSV_WRD_JUSTIFIED, %RSV_WRD_BLANK,
      461    15143                             %RSV_WRD_SOURCE,     %RSV_WRD_LINE,    %RSV_WRD_COLUMN,
      462    15144                             %RSV_WRD_VALUE,   %RSV_WRD_VALUES,  %RSV_WRD_SUM,
      463    15145                             %RSV_WRD_GROUP,   %RSV_WRD_NEXT,    %RSV_WRD_TYPE,
      464    15146                             %RSV_WRD_REDEFINES, %RSV_WRD_IS,    %RSV_WRD_EXTERNAL,
      465    15147                             %RSV_WRD_GLOBAL,  %RSV_WRD_COMP,    %RSV_WRD_INDEX,
      466    15148                             %RSV_WRD_OCCURS,  %RSV_WRD_ASCENDING,  %RSV_WRD_DESCENDING,
      467    15149                             %RSV_WRD_INDEXED,  %RSV_WRD_SYNCHRONIZED, %RSV_WRD_RENAMES,
      468    15150                             %RSV_WRD_COMP_1,  %RSV_WRD_COMP_2,  %RSV_WRD_COMP_3,
      469    15151                             %RSV_WRD_COMP_4,  %RSV_WRD_COMP_5,  %RSV_WRD_COMP_6,
      470    15152                             %RSV_WRD_COMP_7,  %RSV_WRD_COMP_8,  %RSV_WRD_COMP_11,
      471    15153                             %RSV_WRD_COMP_12, %RSV_WRD_COMP_13, %RSV_WRD_COMP_14,
      472    15154                             %RSV_WRD_DB_KEY, %RSV_WRD_POINTER);
      473    15155                        ;  /* do nothing */
      474    15156                     END;
      475    15157
      476    15158                   O1COM.RECORD_DCL = '0'B;
      477    15159                 END;
      478    15160
      479    15161          END;
      480    15162        %MEND;
      481    15163        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:31   
      482    15164        %MACRO PROCESS_RESERVED_WORD;
      483    15165                 DO ;
      484    15166
      485    15167        /*V*
      486    15168            RESERVED_WORD -- If we have encountered a reserved word then the symbol
      487    15169                             field in the stack is assigned the reserved word number.
      488    15170                             If we see the start of a picture string (PIC or PICTURE)
      489    15171                             then we set the state symbolizing the start of a picture
      490    15172                             string.
      491    15173
      492    15174        */
      493    15175
      494    15176                   IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START
      495    15177                      /*N* Free_Format --  AND NOT COMCOM.OB.FORMAT */
      496    15178                       AND O1COM.PD_FLAG
      497    15179                       AND NOT DNT$ -> DNT.B.MUST_AREA_A
      498    15180                       AND NOT DNT$ -> DNT.B.ACCEPT_AREA_A THEN
      499    15181                     CALL Z8AE$ERROR(%E$AREA_A_ERROR,
      500    15182                                     O1COM.LA_STK.LINE(O1COM.LA_PUT),
      501    15183                                     O1COM.LA_STK.COLUMN(O1COM.LA_PUT),
      502    15184                                     DNT$);
      503    15185
      504    15186                   IF DNT$ -> DNT.B.MUST_AREA_A
      505    15187                   /*N* Free_Format -- AND NOT COMCOM.OB.FORMAT */
      506    15188                   AND O1COM.LA_STK.COLUMN(O1COM.LA_PUT) >= O1COM.AREA_B_COLUMN_START THEN
      507    15189                     CALL Z8AE$ERROR (%E$MUST_BE_IN_AREA_A,
      508    15190                                      O1COM.LA_STK.LINE (O1COM.LA_PUT),
      509    15191                                      O1COM.LA_STK.COLUMN (O1COM.LA_PUT),
      510    15192                                      DNT$);
      511    15193
      512    15194                   O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = DNT$->DNT.RW_NO;
      513    15195
      514    15196                   DO CASE(O1COM.LA_STK.SYMBOL(O1COM.LA_PUT)) ;
      515    15197
      516    15198                     CASE( %RSV_WRD_DATE_COMPILED,
      517    15199                         %RSV_WRD_DATE_WRITTEN,
      518    15200                         %RSV_WRD_SECURITY);
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:32   
      519    15201
      520    15202                       LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
      521    15203
      522    15204                     CASE(%RSV_WRD_AUTHOR);
      523    15205
      524    15206                            LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
      525    15207                            O1COM.AUTHOR_COMMENT = %TRUE;
      526    15208
      527    15209                     CASE(%RSV_WRD_INSTALLATION);
      528    15210
      529    15211                            LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
      530    15212                            O1COM.INSTAL_ON = %TRUE;
      531    15213
      532    15214                     CASE(%RSV_WRD_PICTURE) ;
      533    15215
      534    15216                       LEX_STATE = %LS_PICTURE_OR_IS;
      535    15217
      536    15218                     CASE(%RSV_WRD_ACCEPT,    %RSV_WRD_ADD,      %RSV_WRD_ALTER,
      537    15219                          %RSV_WRD_CALL,      %RSV_WRD_CANCEL,   %RSV_WRD_CLOSE,
      538    15220                          %RSV_WRD_COMPUTE,   %RSV_WRD_CONTINUE, %RSV_WRD_DELETE,
      539    15221                          %RSV_WRD_DISABLE,   %RSV_WRD_DIVIDE,   %RSV_WRD_ENABLE,
      540    15222                          %RSV_WRD_EVALUATE,  %RSV_WRD_EXAMINE,  %RSV_WRD_EXIT,
      541    15223                          %RSV_WRD_GO,        %RSV_WRD_GENERATE, %RSV_WRD_IF,
      542    15224                          %RSV_WRD_INITIATE,  %RSV_WRD_INITIALIZE,%RSV_WRD_INSPECT,
      543    15225                          %RSV_WRD_MERGE,     %RSV_WRD_MOVE,     %RSV_WRD_MULTIPLY,
      544    15226                          %RSV_WRD_OPEN,      %RSV_WRD_PERFORM,  %RSV_WRD_PURGE,
      545    15227                          %RSV_WRD_READ,      %RSV_WRD_RECEIVE,  %RSV_WRD_RELEASE,
      546    15228                          %RSV_WRD_RETURN,    %RSV_WRD_REWRITE,  %RSV_WRD_SEND,
      547    15229                          %RSV_WRD_SEARCH,    %RSV_WRD_START,    %RSV_WRD_SET,
      548    15230                          %RSV_WRD_STRING,    %RSV_WRD_STOP,     %RSV_WRD_SUBTRACT,
      549    15231                          %RSV_WRD_SUPPRESS,  %RSV_WRD_TERMINATE,%RSV_WRD_UNSTRING,
      550    15232                          %RSV_WRD_WRITE,
      551    15233                          %RSV_WRD_CONNECT,   %RSV_WRD_DISCONNECT,%RSV_WRD_ERASE,
      552    15234                          %RSV_WRD_FIND,      %RSV_WRD_FINISH,   %RSV_WRD_GET,
      553    15235                          %RSV_WRD_MODIFY,    %RSV_WRD_PRECALCULATE,
      554    15236                          %RSV_WRD_READY,    %RSV_WRD_STORE);
      555    15237
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:33   
      556    15238                       %SAVE_IMPERATIVE_STMT_RSV_WRD ;
      557    15239
      558    15240                     CASE(%RSV_WRD_QUOTES,    %RSV_WRD_LOW_VALUES,
      559    15241                          %RSV_WRD_SPACES,    %RSV_WRD_ZEROES,     %RSV_WRD_HIGH_VALUES);
      560    15242
      561    15243                       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;
      562    15244
      563    15245
      564    15246
      565    15247                   END ;
      566    15248
      567    15249                   IF NOT LEX_SYMBOL.B.CONTINUED_TOKEN THEN
      568    15250                     SAVED_CONT_FLAG = FALSE;
      569    15251
      570    15252                 END ;
      571    15253        %MEND;
      572    15254        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:34   
      573    15255        %MACRO PROCESS_USER_WORD;
      574    15256                 DO;
      575    15257                   /* for user word */
      576    15258
      577    15259                   DNT$ -> DNT.B.USER_WORD = TRUE;
      578    15260
      579    15261                   /* Check to make sure userword does not end in dash */
      580    15262                   IF SUBSTR(LEX_SYMBOL.SYMBOL,
      581    15263                             LEX_SYMBOL.SIZE - 1,
      582    15264                             1) = '-' THEN
      583    15265                     DO;
      584    15266                       CALL Z8AE$ERROR (%E$USERWORD_END_DASH_ERROR,
      585    15267                                        LEX_SYMBOL.LINE,
      586    15268                                        LEX_SYMBOL.COLUMN);
      587    15269                     END;
      588    15270
      589    15271                   /* Check to make sure userword <= 30 characters */
      590    15272                   IF LEX_SYMBOL.SIZE > %USER_WORD_MAX_SIZE
      591    15273                           AND NOT O1COM.PD_FLAG THEN
      592    15274                     DO;
      593    15275                       CALL Z8AE$ERROR (%E$USERWORD_TOO_LONG,
      594    15276                                        LEX_SYMBOL.LINE,
      595    15277                                        LEX_SYMBOL.COLUMN);
      596    15278                       LEX_SYMBOL.SIZE = 30;
      597    15279                       DNT$ -> DNT.TEXT.LENGTH = 30;
      598    15280                     END;
      599    15281
      600    15282                   /* Check for at least one letter in userword */
      601    15283
      602    15284              /* Check was disabled because paragraph names do not have to
      603    15285                    contain letters in the name.  Therefore, the check must
      604    15286                    either be:
      605    15287
      606    15288                       1) done after the parse to differentiate between
      607    15289                            paragraph names and data names.
      608    15290
      609    15291                       2) Change user word that contain no letters to be
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:35   
      610    15292                            paragraph names
      611    15293
      612    15294                       3) Disabled completely.
      613    15295                   CALL SEARCH (CHAR_COLUMN,
      614    15296                                CHAR_CLASS,
      615    15297                                LETTER_SEARCH_TABLE,
      616    15298                                SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE));
      617    15299                   IF CHAR_CLASS = %END_OF_LINE THEN
      618    15300                     DO;
      619    15301                       CALL Z8AE$ERROR (%E$NO_LETTER_USERWORD,
      620    15302                                        LEX_SYMBOL.LINE,
      621    15303                                        LEX_SYMBOL.COLUMN);
      622    15304                     END;
      623    15305
      624    15306              */
      625    15307                   /* Check for no $ or _ if ANSI option */
      626    15308                   IF COMCOM.OB.FIPS.LEVEL > 0 THEN
      627    15309                     DO;
      628    15310                       CALL SEARCH (CHAR_COLUMN,
      629    15311                                    CHAR_CLASS,
      630    15312                                    ANSI_USERWORD_SCAN_TABLE,
      631    15313                                    SUBSTR(LEX_SYMBOL.SYMBOL,
      632    15314                                           0,
      633    15315                                           LEX_SYMBOL.SIZE));
      634    15316                       IF CHAR_CLASS ~= %END_OF_LINE THEN
      635    15317                         CALL Z8AE$ERROR (%E$USERWORD_ANSI_ERROR,
      636    15318                                          LEX_SYMBOL.LINE,
      637    15319                                          LEX_SYMBOL.COLUMN);
      638    15320                     END;
      639    15321                   IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START THEN
      640    15322                     DO;
      641    15323                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
      642    15324                         IF O1COM.PD_FLAG THEN
      643    15325                           O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_DEF;
      644    15326                         ELSE
      645    15327                           O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;
      646    15328                     END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:36   
      647    15329                   ELSE
      648    15330                     IF (O1COM.LA_STK.ST$(O1COM.LA_PUT) ~= ADDR(NIL))
      649    15331                     AND ((O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %PARA
      650    15332                              OR
      651    15333                          O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %SECTION)
      652    15334            AND O1COM.LA_STK.ST$(O1COM.LA_PUT) -> VARIABLE.PROC$ = O1COM.CURRENT_PROC$) THEN
      653    15335                       O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_REF;
      654    15336                     ELSE
      655    15337                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
      656    15338                         O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;
      657    15339
      658    15340                     /*N* Free_Format --
      659    15341                       ELSE
      660    15342                         O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME_OR_PARA;
      661    15343                     */
      662    15344
      663    15345
      664    15346                   IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) ~= ADDR(NIL) THEN
      665    15347                     IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> ST.ID = %SYM_CHAR THEN
      666    15348        CHECK_SYM_CHAR: DO;
      667    15349                          PROC$$ = O1COM.CURRENT_PROC$;
      668    15350                          DO WHILE (O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> VARIABLE.PROC$ ~=
      669    15351                              PROC$$);
      670    15352                            PROC$$ = PROC$$ -> PROC_.FATHER;
      671    15353                            IF PROC$$ = ADDR(NIL) THEN
      672    15354                              EXIT CHECK_SYM_CHAR;
      673    15355                          END; /* WHILE */
      674    15356                          O1COM.LA_STK.B.ALL  (O1COM.LA_PUT) = TRUE;
      675    15357                          O1COM.LA_STK.SYMBOL (O1COM.LA_PUT) = %ALPHA_LITERAL;
      676    15358                        END; /* CHECK_SYM_CHAR */
      677    15359
      678    15360                   SAVED_CONT_FLAG = FALSE;
      679    15361
      680    15362                  END;
      681    15363        %MEND;
      682    15364        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:37   
      683    15365    1   PROCESS_SYMBOL : PROC;
      684    15366
      685    15367    2   IF LEX_SYMBOL.B.CONTINUED_TOKEN THEN
      686    15368    2     SAVED_CONT_FLAG = TRUE;
      687    15369    2   O1COM.LA_STK.B.HIGH_LEV(O1COM.LA_PUT) = SAVED_CONT_FLAG;
      688    15370
      689    15371    3   DO CASE(LEX_SYMBOL.TYPE);
      690    15372
      691    15373    3     CASE(%LEFT_PAREN,  %RIGHT_PAREN,   %STAR,
      692    15374    3          %STAR_STAR,   %PLUS,          %MINUS,
      693    15375    3                        %SLASH,         %COLON,
      694    15376    3          %LESS_THAN,   %GREATER_THAN,  %EQUAL,
      695    15377    3          %LESS_THAN_OR_EQUAL, %GREATER_THAN_OR_EQUAL,
      696    15378    3          %UP_ARROW,    %END_OF_FILE);
      697    15379
      698    15380            /* These symbols require no special handling */
      699    15381    3       ;
      700    15382
      701    15383    3     CASE(%ILLEGAL_SYMBOL, %PSEUDO);
      702    15384
      703    15385    3       O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %ILLEGAL_SYMBOL;
      704    15386    3       IF SEARCH_REQUIRED THEN
      705    15387    3         CALL Z8AH$SEARCH_;
      706    15388    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;
      707    15389
      708    15390    3     CASE(%PERIOD);
      709    15391
      710    15392    3       IF LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY THEN
      711    15393    4         DO;
      712    15394    4           LEX_STATE = %LS_COMMENT_ENTRY;
      713    15395    4         END;
      714    15396    3       ELSE
      715    15397    3         SAVED_CONT_FLAG = FALSE;
      716    15398
      717    15399    3     CASE(%ALPHA_LITERAL, %SINGLE_QUOTE);
      718    15400
      719    15401    3       IF SEARCH_REQUIRED THEN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:38   
      720    15402    3         CALL Z8AH$SEARCH_;
      721    15403            /* Check for null string */
      722    15404    3       IF LEX_SYMBOL.SIZE <= 2 THEN
      723    15405    4         DO;
      724    15406    4           CALL Z8AE$ERROR(%E$NULL_QUOTE_STRING,
      725    15407    4                           LEX_SYMBOL.LINE,
      726    15408    4                           LEX_SYMBOL.COLUMN);
      727    15409                /* "NULL QUOTE STRING ILLEGAL; A SPACE HAS BEEN INSERTED." */
      728    15410    4           LEX_SYMBOL.SIZE = 3;
      729    15411    4           LEX_SYMBOL.SYMBOL = '" "';
      730    15412    4           CALL Z8AH$SEARCH_;
      731    15413    4         END;
      732    15414    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;
      733    15415    3       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;
      734    15416    3       DNT$ -> DNT.B.ALPHA_LITERAL = TRUE;
      735    15417
      736    15418    3     CASE(%NUMBER);
      737    15419
      738    15420    3       IF SEARCH_REQUIRED THEN
      739    15421    3         CALL Z8AH$SEARCH_;
      740    15422
      741    15423          /*N* Free_Format --
      742    15424            IF COMCOM.OB.FORMAT THEN
      743    15425              O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NUMBER_OR_PARAGRAPH;
      744    15426            ELSE
      745    15427          */
      746    15428
      747    15429    3         IF LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START THEN
      748    15430    3           O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NUMBER_OR_PARAGRAPH;
      749    15431    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;
      750    15432    3       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;
      751    15433    3       SAVED_CONT_FLAG = FALSE;
      752    15434    3       DNT$ -> DNT.B.NUMERIC_LITERAL = TRUE;
      753    15435
      754    15436    3       IF LEX_SYMBOL.SIZE > %NUM_LIT_MAX_SIZE THEN
      755    15437    4         DO;
      756    15438    4           CALL Z8AE$ERROR(%E$NUMERIC_ITEM_TOO_LONG,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:39   
      757    15439    4                           LEX_SYMBOL.LINE,
      758    15440    4                           LEX_SYMBOL.COLUMN);
      759    15441    4           CALL CREATE_DUMMY_NUM_LIT;
      760    15442    4         END;
      761    15443    3       ELSE
      762    15444    3         IF COMCOM.OB.FIPS.LEVEL > 0
      763    15445    3               AND LEX_SYMBOL.SIZE > %ANSI_NUM_LIT_MAX_SIZE THEN
      764    15446    4           DO;
      765    15447    4             CALL Z8AE$ERROR (%E$ANSI_LARGE_NUMERIC_ITEM,
      766    15448    4                              LEX_SYMBOL.LINE,
      767    15449    4                              LEX_SYMBOL.COLUMN);
      768    15450    4           END;
      769    15451
      770    15452    3     CASE(%NUMERIC_LITERAL);
      771    15453
      772    15454    3       IF SEARCH_REQUIRED THEN
      773    15455    3         CALL Z8AH$SEARCH_;
      774    15456    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;
      775    15457    3       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;
      776    15458    3       SAVED_CONT_FLAG = FALSE;
      777    15459    3       DNT$ -> DNT.B.NUMERIC_LITERAL = TRUE;
      778    15460
      779    15461    3       CALL Z8AU$CREATE_NUM_DESC (LEX_SYMBOL.SYMBOL,
      780    15462    3                                  LEX_SYMBOL.SIZE,
      781    15463    3                                  NUM_DESC);
      782    15464            %VALIDATE_NUM_DESC;
             15465    4     DO;
             15466    4       IF COMCOM.OB.FIPS.LEVEL > 0
             15467    4             AND NUM_DESC.DIGITS_LEFT
             15468    4                   + NUM_DESC.DIGITS_RIGHT
             15469    4                     > %ANSI_NUM_LIT_MAX_SIZE THEN
             15470    5         DO;
             15471    5           CALL Z8AE$ERROR (%E$ANSI_LARGE_NUMERIC_ITEM,
             15472    5                            LEX_SYMBOL.LINE,
             15473    5                            LEX_SYMBOL.COLUMN);
             15474    5         END;
             15475    4       IF COMCOM.OB.FIPS.LEVEL > 0
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:40   
             15476    4              AND NUM_DESC.DIGITS_EXPONENT > 0 THEN
             15477    5         DO;
             15478    5           CALL Z8AE$ERROR (%E$ANSI_FLOATING_POINT,
             15479    5                            LEX_SYMBOL.LINE,
             15480    5                            LEX_SYMBOL.COLUMN);
             15481    5         END;
             15482    4       IF NUM_DESC.DIGITS_LEFT
             15483    4              + NUM_DESC.DIGITS_RIGHT
             15484    4                > %NUM_LIT_MAX_SIZE THEN
             15485    5         DO;
             15486    5           CALL Z8AE$ERROR (%E$NUMERIC_ITEM_TOO_LONG,
             15487    5                            LEX_SYMBOL.LINE,
             15488    5                            LEX_SYMBOL.COLUMN);
             15489    5           CALL CREATE_DUMMY_NUM_LIT;
             15490    5         END;
             15491    4       ELSE
             15492    4         IF NUM_DESC.DIGITS_EXPONENT > %MAX_EXPONENT_DIGITS THEN
             15493    5           DO;
             15494    5             CALL Z8AE$ERROR (%E$TOO_LARGE_NUM_EXP,
             15495    5                              LEX_SYMBOL.LINE,
             15496    5                              LEX_SYMBOL.COLUMN);
             15497    5             CALL CREATE_DUMMY_NUM_LIT;
             15498    5           END;
             15499    4       IF NUM_DESC.COMMA_PRESENT
             15500    4       AND (O1COM.CURRENT_PROC$ = ADDR(NIL)
             15501    4            OR NOT O1COM.CURRENT_PROC$ -> PROC_.B.COMMA_IS_DECIMAL) THEN
             15502    4         CALL Z8AE$ERROR(%E$COMMA_IN_NUMBER,
             15503    4                         LEX_SYMBOL.LINE,
             15504    4                         LEX_SYMBOL.COLUMN);
             15505    4     END;
      783    15507
      784    15508    3     CASE(%USER_WORD);
      785    15509
      786    15510    3       IF SEARCH_REQUIRED THEN
      787    15511    3         CALL Z8AH$SEARCH_;
      788    15512
      789    15513            %CHECK_REDECL_OF_RESERVED_WORD;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:41   
             15514    4     DO;
             15515    4          IF O1COM.RECORD_DCL THEN
             15516    5            DO;
             15517        /*V*
             15518            RESERVED_WRD_DCL_CHECK -- If the item is a reserved word and we are in
             15519                                      the process of a declaration the reserved word
             15520                                      bit is turned off in the DNT.  The item is changed
             15521                                      to a user word so that a person can declare a
             15522                                      reserved word and use that data name in the
             15523                                      program.  He may not use it as a reserved
             15524                                      word though.
             15525                                      This was done due to the fact that there are
             15526                                      new reserved words in COBOL85 in addition to
             15527                                      to the many before.
             15528        */
             15529    5              IF DNT$->DNT.B.RW AND O1COM.PARSE_ERROR_COUNT = 0 THEN
             15530    6                DO CASE (DNT$ -> DNT.RW_NO);
             15531    6                  CASE(ELSE);
             15532    6                    CALL Z8AE$ERROR (%E$RW_USED_AS_DATA_NAME,
             15533    6                                     LEX_SYMBOL.LINE,
             15534    6                                     LEX_SYMBOL.COLUMN,
             15535    6                                     DNT$);
             15536                         /* Create new DNT for non-reserved word since reserved
             15537                               word is in constant storage */
             15538    6                    TDNT$ = DNT$;
             15539                         %NEW_DNT(@SIZE = LEX_SYMBOL.SIZE,
             15540                                     @NAME = LEX_SYMBOL.SYMBOL,
             15541                                     @ST$ = TDNT$ -> DNT.ST$,
             15542                                     @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");
             15543          %RESERVE_DNT(POINTER = @POINTER,  SIZE = @SIZE);
             15544    7          DO ;
             15545    7            ITERATION = (SIZE+21)/4 ;
             15546    7            IF DNT_.BOTTOM + ITERATION >= DNT_.FLOOR THEN
             15547    7              CALL Z8AR$RESERVER(ADDR(DNT_));
             15548    7            POINTER                  = PINCRW (DNT_.FIRST, DNT_.BOTTOM);
             15549    7            DNT_.BOTTOM              = DNT_.BOTTOM + ITERATION ;
             15550    7            POINTER->DNT.ID          = ITEM % ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:42   
             15551    7            POINTER->DNT.N           = ITERATION ;
             15552    7            POINTER->DNT.TEXT.LENGTH = SIZE;
             15553    7          END ;
             15555    6     @POINTER -> DNT.ST$        = @ST$;
             15556    6     @POINTER -> DNT.NEXT       = @NEXT;
             15557    6     @POINTER -> DNT.ATTR       = '0'B;
             15558    6     @POINTER -> DNT.RW_NO      = @RW_NO;
             15559    6     @POINTER -> DNT.TEXT.NAME  = @NAME;
             15560          %IF @RW;
             15562          %ENDIF;
             15563          %IF @USER_WORD;
             15565          %ENDIF;
             15566          %IF @SYSTEM_NAME;
             15568          %ENDIF;
             15569          %IF @DUPLICATE;
             15571          %ENDIF;
             15572          %IF @NUMERIC_LITERAL;
             15574          %ENDIF;
             15575          %IF @REPLACE_TOKEN;
             15577          %ENDIF;
             15578          %IF @ALPHA_LITERAL;
             15580          %ENDIF;
             15581          %IF @FIGURATIVE_CONSTANT;
             15583          %ENDIF;
             15584          %IF @ALL;
             15586          %ENDIF;
             15587          %IF @VERB;
             15589          %ENDIF;
             15590          %IF @ACCEPT_AREA_A;
             15592          %ENDIF;
             15593          %IF @ERROR_VARIABLE;
             15595          %ENDIF;
             15596          %IF @MUST_AREA_A;
             15598          %ENDIF;
             15600    6                    DNT$ -> DNT.ATTR = TDNT$ -> DNT.ATTR;
             15601    6                    DNT$ -> DNT.B.USER_WORD = TRUE;
             15602    6                    DNT$ -> DNT.B.RW = FALSE;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:43   
             15603    6                    DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;
             15604    6                  CASE (%RSV_WRD_FILLER,  %RSV_WRD_PICTURE, %RSV_WRD_USAGE,
             15605    6                        %RSV_WRD_SIGN,    %RSV_WRD_LEADING, %RSV_WRD_TRAILING,
             15606    6                        %RSV_WRD_DISPLAY, %RSV_WRD_JUSTIFIED, %RSV_WRD_BLANK,
             15607    6                        %RSV_WRD_SOURCE,     %RSV_WRD_LINE,    %RSV_WRD_COLUMN,
             15608    6                        %RSV_WRD_VALUE,   %RSV_WRD_VALUES,  %RSV_WRD_SUM,
             15609    6                        %RSV_WRD_GROUP,   %RSV_WRD_NEXT,    %RSV_WRD_TYPE,
             15610    6                        %RSV_WRD_REDEFINES, %RSV_WRD_IS,    %RSV_WRD_EXTERNAL,
             15611    6                        %RSV_WRD_GLOBAL,  %RSV_WRD_COMP,    %RSV_WRD_INDEX,
             15612    6                        %RSV_WRD_OCCURS,  %RSV_WRD_ASCENDING,  %RSV_WRD_DESCENDING,
             15613    6                        %RSV_WRD_INDEXED,  %RSV_WRD_SYNCHRONIZED, %RSV_WRD_RENAMES,
             15614    6                        %RSV_WRD_COMP_1,  %RSV_WRD_COMP_2,  %RSV_WRD_COMP_3,
             15615    6                        %RSV_WRD_COMP_4,  %RSV_WRD_COMP_5,  %RSV_WRD_COMP_6,
             15616    6                        %RSV_WRD_COMP_7,  %RSV_WRD_COMP_8,  %RSV_WRD_COMP_11,
             15617    6                        %RSV_WRD_COMP_12, %RSV_WRD_COMP_13, %RSV_WRD_COMP_14,
             15618    6                        %RSV_WRD_DB_KEY, %RSV_WRD_POINTER);
             15619    6                   ;  /* do nothing */
             15620    6                END;
             15621    5              O1COM.RECORD_DCL = '0'B;
             15622    5            END;
             15623    4     END;
      790    15625
      791    15626    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;
      792    15627    3       O1COM.LA_STK.ST$(O1COM.LA_PUT) = DNT$ -> DNT.ST$;
      793    15628
      794    15629    3       IF DNT$ -> DNT.B.RW THEN
      795    15630              %PROCESS_RESERVED_WORD;
             15631    4            DO ;
             15632        /*V*
             15633            RESERVED_WORD -- If we have encountered a reserved word then the symbol
             15634                             field in the stack is assigned the reserved word number.
             15635                             If we see the start of a picture string (PIC or PICTURE)
             15636                             then we set the state symbolizing the start of a picture
             15637                             string.
             15638        */
             15639    4              IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START
             15640                      /*N* Free_Format --  AND NOT COMCOM.OB.FORMAT */
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:44   
             15641    4                  AND O1COM.PD_FLAG
             15642    4                  AND NOT DNT$ -> DNT.B.MUST_AREA_A
             15643    4                  AND NOT DNT$ -> DNT.B.ACCEPT_AREA_A THEN
             15644    4                CALL Z8AE$ERROR(%E$AREA_A_ERROR,
             15645    4                                O1COM.LA_STK.LINE(O1COM.LA_PUT),
             15646    4                                O1COM.LA_STK.COLUMN(O1COM.LA_PUT),
             15647    4                                DNT$);
             15648    4              IF DNT$ -> DNT.B.MUST_AREA_A
             15649                   /*N* Free_Format -- AND NOT COMCOM.OB.FORMAT */
             15650    4              AND O1COM.LA_STK.COLUMN(O1COM.LA_PUT) >= O1COM.AREA_B_COLUMN_START THEN
             15651    4                CALL Z8AE$ERROR (%E$MUST_BE_IN_AREA_A,
             15652    4                                 O1COM.LA_STK.LINE (O1COM.LA_PUT),
             15653    4                                 O1COM.LA_STK.COLUMN (O1COM.LA_PUT),
             15654    4                                 DNT$);
             15655    4              O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = DNT$->DNT.RW_NO;
             15656    5              DO CASE(O1COM.LA_STK.SYMBOL(O1COM.LA_PUT)) ;
             15657    5                CASE( %RSV_WRD_DATE_COMPILED,
             15658    5                    %RSV_WRD_DATE_WRITTEN,
             15659    5                    %RSV_WRD_SECURITY);
             15660    5                  LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
             15661    5                CASE(%RSV_WRD_AUTHOR);
             15662    5                       LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
             15663    5                       O1COM.AUTHOR_COMMENT = %TRUE;
             15664    5                CASE(%RSV_WRD_INSTALLATION);
             15665    5                       LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
             15666    5                       O1COM.INSTAL_ON = %TRUE;
             15667    5                CASE(%RSV_WRD_PICTURE) ;
             15668    5                  LEX_STATE = %LS_PICTURE_OR_IS;
             15669    5                CASE(%RSV_WRD_ACCEPT,    %RSV_WRD_ADD,      %RSV_WRD_ALTER,
             15670    5                     %RSV_WRD_CALL,      %RSV_WRD_CANCEL,   %RSV_WRD_CLOSE,
             15671    5                     %RSV_WRD_COMPUTE,   %RSV_WRD_CONTINUE, %RSV_WRD_DELETE,
             15672    5                     %RSV_WRD_DISABLE,   %RSV_WRD_DIVIDE,   %RSV_WRD_ENABLE,
             15673    5                     %RSV_WRD_EVALUATE,  %RSV_WRD_EXAMINE,  %RSV_WRD_EXIT,
             15674    5                     %RSV_WRD_GO,        %RSV_WRD_GENERATE, %RSV_WRD_IF,
             15675    5                     %RSV_WRD_INITIATE,  %RSV_WRD_INITIALIZE,%RSV_WRD_INSPECT,
             15676    5                     %RSV_WRD_MERGE,     %RSV_WRD_MOVE,     %RSV_WRD_MULTIPLY,
             15677    5                     %RSV_WRD_OPEN,      %RSV_WRD_PERFORM,  %RSV_WRD_PURGE,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:45   
             15678    5                     %RSV_WRD_READ,      %RSV_WRD_RECEIVE,  %RSV_WRD_RELEASE,
             15679    5                     %RSV_WRD_RETURN,    %RSV_WRD_REWRITE,  %RSV_WRD_SEND,
             15680    5                     %RSV_WRD_SEARCH,    %RSV_WRD_START,    %RSV_WRD_SET,
             15681    5                     %RSV_WRD_STRING,    %RSV_WRD_STOP,     %RSV_WRD_SUBTRACT,
             15682    5                     %RSV_WRD_SUPPRESS,  %RSV_WRD_TERMINATE,%RSV_WRD_UNSTRING,
             15683    5                     %RSV_WRD_WRITE,
             15684    5                     %RSV_WRD_CONNECT,   %RSV_WRD_DISCONNECT,%RSV_WRD_ERASE,
             15685    5                     %RSV_WRD_FIND,      %RSV_WRD_FINISH,   %RSV_WRD_GET,
             15686    5                     %RSV_WRD_MODIFY,    %RSV_WRD_PRECALCULATE,
             15687    5                     %RSV_WRD_READY,    %RSV_WRD_STORE);
             15688                       %SAVE_IMPERATIVE_STMT_RSV_WRD ;
             15689    6          DO ;
             15690    6             SAVED_SYMBOL = O1COM.LA_STK(O1COM.LA_PUT);
             15691    6             SAVED_LEX_STATE = %LS_NORMAL;
             15692    6             O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %INVISIBLE_STMT_START ;
             15693    6             O1COM.LA_STK.DNT$(O1COM.LA_PUT) = ADDR(NIL) ;
             15694    6             O1COM.LA_STK.FLAGS(O1COM.LA_PUT) = FALSE;
             15695    6             O1COM.LA_STK.ST$(O1COM.LA_PUT) = ADDR(NIL);
             15696    6             O1COM.LA_STK.TYPE(O1COM.LA_PUT) = 0;
             15697                  /* Leave line and column the same */
             15698    6             LEX_STATE = %LS_PICK_UP_SAVED_SYMBOL;
             15699    6          END ;
             15701    5                CASE(%RSV_WRD_QUOTES,    %RSV_WRD_LOW_VALUES,
             15702    5                     %RSV_WRD_SPACES,    %RSV_WRD_ZEROES,     %RSV_WRD_HIGH_VALUES);
             15703    5                  O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;
             15704    5              END ;
             15705    4              IF NOT LEX_SYMBOL.B.CONTINUED_TOKEN THEN
             15706    4                SAVED_CONT_FLAG = FALSE;
             15707    4            END ;
      796    15709    3       ELSE
      797    15710              %PROCESS_USER_WORD;
             15711    4            DO;
             15712                   /* for user word */
             15713    4              DNT$ -> DNT.B.USER_WORD = TRUE;
             15714                   /* Check to make sure userword does not end in dash */
             15715    4              IF SUBSTR(LEX_SYMBOL.SYMBOL,
             15716    4                        LEX_SYMBOL.SIZE - 1,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:46   
             15717    4                        1) = '-' THEN
             15718    5                DO;
             15719    5                  CALL Z8AE$ERROR (%E$USERWORD_END_DASH_ERROR,
             15720    5                                   LEX_SYMBOL.LINE,
             15721    5                                   LEX_SYMBOL.COLUMN);
             15722    5                END;
             15723                   /* Check to make sure userword <= 30 characters */
             15724    4              IF LEX_SYMBOL.SIZE > %USER_WORD_MAX_SIZE
             15725    4                      AND NOT O1COM.PD_FLAG THEN
             15726    5                DO;
             15727    5                  CALL Z8AE$ERROR (%E$USERWORD_TOO_LONG,
             15728    5                                   LEX_SYMBOL.LINE,
             15729    5                                   LEX_SYMBOL.COLUMN);
             15730    5                  LEX_SYMBOL.SIZE = 30;
             15731    5                  DNT$ -> DNT.TEXT.LENGTH = 30;
             15732    5                END;
             15733                   /* Check for at least one letter in userword */
             15734              /* Check was disabled because paragraph names do not have to
             15735                    contain letters in the name.  Therefore, the check must
             15736                    either be:
             15737                       1) done after the parse to differentiate between
             15738                            paragraph names and data names.
             15739                       2) Change user word that contain no letters to be
             15740                            paragraph names
             15741                       3) Disabled completely.
             15742                   CALL SEARCH (CHAR_COLUMN,
             15743                                CHAR_CLASS,
             15744                                LETTER_SEARCH_TABLE,
             15745                                SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE));
             15746                   IF CHAR_CLASS = %END_OF_LINE THEN
             15747                     DO;
             15748                       CALL Z8AE$ERROR (%E$NO_LETTER_USERWORD,
             15749                                        LEX_SYMBOL.LINE,
             15750                                        LEX_SYMBOL.COLUMN);
             15751                     END;
             15752              */
             15753                   /* Check for no $ or _ if ANSI option */
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:47   
             15754    4              IF COMCOM.OB.FIPS.LEVEL > 0 THEN
             15755    5                DO;
             15756    5                  CALL SEARCH (CHAR_COLUMN,
             15757    5                               CHAR_CLASS,
             15758    5                               ANSI_USERWORD_SCAN_TABLE,
             15759    5                               SUBSTR(LEX_SYMBOL.SYMBOL,
             15760    5                                      0,
             15761    5                                      LEX_SYMBOL.SIZE));
             15762    5                  IF CHAR_CLASS ~= %END_OF_LINE THEN
             15763    5                    CALL Z8AE$ERROR (%E$USERWORD_ANSI_ERROR,
             15764    5                                     LEX_SYMBOL.LINE,
             15765    5                                     LEX_SYMBOL.COLUMN);
             15766    5                END;
             15767    4              IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START THEN
             15768    5                DO;
             15769                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
             15770    5                    IF O1COM.PD_FLAG THEN
             15771    5                      O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_DEF;
             15772    5                    ELSE
             15773    5                      O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;
             15774    5                END;
             15775    4              ELSE
             15776    4                IF (O1COM.LA_STK.ST$(O1COM.LA_PUT) ~= ADDR(NIL))
             15777    4                AND ((O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %PARA
             15778    4                         OR
             15779    4                     O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %SECTION)
             15780    4                     AND O1COM.LA_STK.ST$(O1COM.LA_PUT) -> VARIABLE.PROC$ = O1COM.
             15780                              CURRENT_PROC$) THEN
             15781    4                  O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_REF;
             15782    4                ELSE
             15783                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
             15784    4                    O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;
             15785                     /*N* Free_Format --
             15786                       ELSE
             15787                         O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME_OR_PARA;
             15788                     */
             15789    4              IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) ~= ADDR(NIL) THEN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:48   
             15790    4                IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> ST.ID = %SYM_CHAR THEN
             15791    5   CHECK_SYM_CHAR: DO;
             15792    5                     PROC$$ = O1COM.CURRENT_PROC$;
             15793    6                     DO WHILE (O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> VARIABLE.PROC$ ~=
             15794    6                         PROC$$);
             15795    6                       PROC$$ = PROC$$ -> PROC_.FATHER;
             15796    6                       IF PROC$$ = ADDR(NIL) THEN
             15797    6                         EXIT CHECK_SYM_CHAR;
             15798    6                     END; /* WHILE */
             15799    5                     O1COM.LA_STK.B.ALL  (O1COM.LA_PUT) = TRUE;
             15800    5                     O1COM.LA_STK.SYMBOL (O1COM.LA_PUT) = %ALPHA_LITERAL;
             15801    5                   END; /* CHECK_SYM_CHAR */
             15802    4              SAVED_CONT_FLAG = FALSE;
             15803    4             END;
      798    15805
      799    15806
      800    15807
      801    15808    3     CASE(ELSE);
      802    15809
      803    15810    3       CALL Z8AE$ERROR(%E$SCANNER_FAILURE,
      804    15811    3                       LEX_SYMBOL.LINE,
      805    15812    3                       LEX_SYMBOL.COLUMN);
      806    15813    3       O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %ILLEGAL_SYMBOL;
      807    15814
      808    15815    3   END;  /* DO CASE ON LEX_SYMBOL.TYPE */
      809    15816
      810    15817
      811    15818    2   END PROCESS_SYMBOL;
      812    15819        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:49   
      813    15820    1   CONSOLIDATE_PICTURE_STRING : PROC;
      814    15821
      815    15822    2     DCL INSERT_SIZE SBIN WORD;
      816    15823
      817    15824    2     PICTURE_SYMBOL             = LEX_SYMBOL;
      818    15825    2     PICTURE_SYMBOL.TYPE        = %PICTURE_STRING;
      819    15826    2     PICTURE_SYMBOL.END_COLUMN  = LEX_SYMBOL.COLUMN;
      820    15827    2     PICTURE_SYMBOL.END_LINE    = LEX_SYMBOL.LINE;
      821    15828    2     PICTURE_SYMBOL.SIZE        = 0;
      822    15829    2     PARSING_PICTURE = TRUE;
      823    15830
      824    15831    3     DO WHILE (PICTURE_SYMBOL.END_COLUMN = LEX_SYMBOL.COLUMN)
      825    15832    3               AND (PICTURE_SYMBOL.END_LINE = LEX_SYMBOL.LINE)
      826    15833    3               AND (LEX_SYMBOL.TYPE ~= %PERIOD);
      827    15834
      828    15835    3       INSERT_SIZE = MINIMUM(%MAX_SYMBOL_SIZE - PICTURE_SYMBOL.SIZE,
      829    15836    3                             LEX_SYMBOL.SIZE);
      830    15837
      831    15838    3       PICTURE_SYMBOL.SIZE = PICTURE_SYMBOL.SIZE + INSERT_SIZE;
      832    15839
      833    15840    3       CALL INSERT (PICTURE_SYMBOL.SYMBOL,
      834    15841    3                    PICTURE_SYMBOL.SIZE - INSERT_SIZE,
      835    15842    3                    INSERT_SIZE,
      836    15843    3                    LEX_SYMBOL.SYMBOL);
      837    15844
      838    15845    3       PICTURE_SYMBOL.END_COLUMN = LEX_SYMBOL.END_COLUMN;
      839    15846    3       PICTURE_SYMBOL.END_LINE   = LEX_SYMBOL.END_LINE;
      840    15847    3       CALL REPLACED_TOKEN;
      841    15848
      842    15849    3       IF LEX_SYMBOL.B.CONTINUED_TOKEN THEN
      843    15850    3           PICTURE_SYMBOL.B.CONTINUED_TOKEN = TRUE;
      844    15851
      845    15852    3     END;  /* DO WHILE */
      846    15853
      847    15854    2     IF SAVED_CONT_FLAG THEN
      848    15855    2       PICTURE_SYMBOL.B.CONTINUED_TOKEN = TRUE;
      849    15856
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:50   
      850    15857    2     IF PICTURE_SYMBOL.SIZE = 0 THEN
      851    15858    3       DO;
      852    15859    3         PICTURE_SYMBOL      = LEX_SYMBOL;
      853    15860    3         PICTURE_SYMBOL.TYPE = %ILLEGAL_SYMBOL;
      854    15861    3       END;
      855    15862
      856    15863    2     LEX_STATE = %LS_NORMAL;
      857    15864    2     PARSING_PICTURE = FALSE;
      858    15865          %INITIALIZE_LA_STK_ITEM;
             15866    3     DO;
             15867            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             15868                                @LA_ITEM = TRUE,
             15869                                @SYMBOL = LEX_SYMBOL.TYPE,
             15870                                @LINE = LEX_SYMBOL.LINE,
             15871                                @COLUMN = LEX_SYMBOL.COLUMN);
             15872    4     DO;
             15873    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;
             15874    4       @POINTER -> LX_TERMINAL.B      = '0'B;
             15875            %IF (TEXTCHAR(@BERROR) ~= '');
             15877            %ENDIF;
             15878    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;
             15879            %IF (TEXTCHAR(@LA_ITEM) = '');
             15881            %ENDIF;
             15882    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;
             15883    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;
             15884    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;
             15885    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;
             15886    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;
             15887    4     END;
             15889    3     END;
      859    15891    2     CALL PROCESS_SYMBOL;
      860    15892    2     SAVED_SYMBOL          = O1COM.LA_STK(O1COM.LA_PUT);
      861    15893                                                                 /*#29924*/
      862    15894    2     IF LEX_STATE ~= %LS_PICK_UP_SAVED_SYMBOL  THEN
      863    15895    2       SAVED_LEX_STATE = LEX_STATE;
      864    15896    2     LEX_STATE             = %LS_PICK_UP_SAVED_SYMBOL;
      865    15897    2     LEX_SYMBOL            = PICTURE_SYMBOL;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:51   
      866    15898          %INITIALIZE_LA_STK_ITEM;
             15899    3     DO;
             15900            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             15901                                @LA_ITEM = TRUE,
             15902                                @SYMBOL = LEX_SYMBOL.TYPE,
             15903                                @LINE = LEX_SYMBOL.LINE,
             15904                                @COLUMN = LEX_SYMBOL.COLUMN);
             15905    4     DO;
             15906    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;
             15907    4       @POINTER -> LX_TERMINAL.B      = '0'B;
             15908            %IF (TEXTCHAR(@BERROR) ~= '');
             15910            %ENDIF;
             15911    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;
             15912            %IF (TEXTCHAR(@LA_ITEM) = '');
             15914            %ENDIF;
             15915    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;
             15916    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;
             15917    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;
             15918    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;
             15919    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;
             15920    4     END;
             15922    3     END;
      867    15924    2     O1COM.LA_STK.B.HIGH_LEV(O1COM.LA_PUT) = LEX_SYMBOL.B.CONTINUED_TOKEN;
      868    15925    2     CALL Z8AH$SEARCH_;
      869    15926    2     O1COM.LA_STK.DNT$(O1COM.LA_PUT)   = DNT$;
      870    15927
      871    15928
      872    15929    2   END CONSOLIDATE_PICTURE_STRING;
      873    15930        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:52   
      874    15931        /* Main body of Z8EL$LEX */
      875    15932
      876    15933
      877    15934    2     DO CASE(LEX_STATE);
      878    15935
      879    15936    2       CASE(%LS_NORMAL, %LS_PERIOD_BEFORE_COMMENT_ENTRY);
      880    15937
      881    15938    2         CALL REPLACED_TOKEN;
      882    15939              %CHECK_DELIM_AND_SIZE;
             15940    3     DO;
             15941          /* Check symbol for length */
             15942    3     IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN
             15943    4       DO;
             15944    4         CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,
             15945    4                         LEX_SYMBOL.LINE,
             15946    4                         LEX_SYMBOL.COLUMN);
             15947    4         LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;
             15948    4       END;
             15949          /* Check symbol for delimiter error */
             15950    3     IF LEX_SYMBOL.B.DELIM_ERROR THEN
             15951    4       DO;
             15952    4         CALL Z8AE$ERROR (%E$MISSING_DELIMITER,
             15953    4                          LEX_SYMBOL.LINE,
             15954    4                          LEX_SYMBOL.COLUMN);
             15955    4       END;
             15956    3     END;
      883    15958              %INITIALIZE_LA_STK_ITEM;
             15959    3     DO;
             15960            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             15961                                @LA_ITEM = TRUE,
             15962                                @SYMBOL = LEX_SYMBOL.TYPE,
             15963                                @LINE = LEX_SYMBOL.LINE,
             15964                                @COLUMN = LEX_SYMBOL.COLUMN);
             15965    4     DO;
             15966    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;
             15967    4       @POINTER -> LX_TERMINAL.B      = '0'B;
             15968            %IF (TEXTCHAR(@BERROR) ~= '');
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:53   
             15970            %ENDIF;
             15971    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;
             15972            %IF (TEXTCHAR(@LA_ITEM) = '');
             15974            %ENDIF;
             15975    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;
             15976    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;
             15977    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;
             15978    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;
             15979    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;
             15980    4     END;
             15982    3     END;
      884    15984    2         CALL PROCESS_SYMBOL;
      885    15985
      886    15986    2       CASE(%LS_COMMENT_ENTRY);
      887    15987
      888    15988    2         CALL SCAN_COMMENT_ENTRY;
      889    15989    2         LEX_STATE = %LS_NORMAL;
      890    15990              %CHECK_DELIM_AND_SIZE;
             15991    3     DO;
             15992          /* Check symbol for length */
             15993    3     IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN
             15994    4       DO;
             15995    4         CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,
             15996    4                         LEX_SYMBOL.LINE,
             15997    4                         LEX_SYMBOL.COLUMN);
             15998    4         LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;
             15999    4       END;
             16000          /* Check symbol for delimiter error */
             16001    3     IF LEX_SYMBOL.B.DELIM_ERROR THEN
             16002    4       DO;
             16003    4         CALL Z8AE$ERROR (%E$MISSING_DELIMITER,
             16004    4                          LEX_SYMBOL.LINE,
             16005    4                          LEX_SYMBOL.COLUMN);
             16006    4       END;
             16007    3     END;
      891    16009              %INITIALIZE_LA_STK_ITEM;
             16010    3     DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:54   
             16011            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             16012                                @LA_ITEM = TRUE,
             16013                                @SYMBOL = LEX_SYMBOL.TYPE,
             16014                                @LINE = LEX_SYMBOL.LINE,
             16015                                @COLUMN = LEX_SYMBOL.COLUMN);
             16016    4     DO;
             16017    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;
             16018    4       @POINTER -> LX_TERMINAL.B      = '0'B;
             16019            %IF (TEXTCHAR(@BERROR) ~= '');
             16021            %ENDIF;
             16022    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;
             16023            %IF (TEXTCHAR(@LA_ITEM) = '');
             16025            %ENDIF;
             16026    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;
             16027    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;
             16028    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;
             16029    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;
             16030    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;
             16031    4     END;
             16033    3     END;
      892    16035    2         CALL PROCESS_SYMBOL;
      893    16036
      894    16037    2       CASE(%LS_PICK_UP_SAVED_SYMBOL);
      895    16038
      896    16039    2         O1COM.LA_STK_FIELDS.ALL_BUT_LINK(O1COM.LA_PUT) = SAVED_SYMBOL.
             16039                  ALL_FIELDS_BUT_LINK;
      897    16040    2         LEX_STATE = SAVED_LEX_STATE;
      898    16041
      899    16042    2       CASE(%LS_PICTURE_OR_IS);
      900    16043
      901    16044    2         CALL REPLACED_TOKEN;
      902    16045    2         IF LEX_SYMBOL.SIZE = 2
      903    16046    2             AND SUBSTR(LEX_SYMBOL.SYMBOL, 0, 2) = 'IS' THEN
      904    16047    3           DO;
      905    16048                  %CHECK_DELIM_AND_SIZE;
             16049    4     DO;
             16050          /* Check symbol for length */
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:55   
             16051    4     IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN
             16052    5       DO;
             16053    5         CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,
             16054    5                         LEX_SYMBOL.LINE,
             16055    5                         LEX_SYMBOL.COLUMN);
             16056    5         LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;
             16057    5       END;
             16058          /* Check symbol for delimiter error */
             16059    4     IF LEX_SYMBOL.B.DELIM_ERROR THEN
             16060    5       DO;
             16061    5         CALL Z8AE$ERROR (%E$MISSING_DELIMITER,
             16062    5                          LEX_SYMBOL.LINE,
             16063    5                          LEX_SYMBOL.COLUMN);
             16064    5       END;
             16065    4     END;
      906    16067                  %INITIALIZE_LA_STK_ITEM;
             16068    4     DO;
             16069            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             16070                                @LA_ITEM = TRUE,
             16071                                @SYMBOL = LEX_SYMBOL.TYPE,
             16072                                @LINE = LEX_SYMBOL.LINE,
             16073                                @COLUMN = LEX_SYMBOL.COLUMN);
             16074    5     DO;
             16075    5       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;
             16076    5       @POINTER -> LX_TERMINAL.B      = '0'B;
             16077            %IF (TEXTCHAR(@BERROR) ~= '');
             16079            %ENDIF;
             16080    5       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;
             16081            %IF (TEXTCHAR(@LA_ITEM) = '');
             16083            %ENDIF;
             16084    5       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;
             16085    5       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;
             16086    5       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;
             16087    5       @POINTER -> LX_TERMINAL.LINE   = @LINE;
             16088    5       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;
             16089    5     END;
             16091    4     END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:56   
      907    16093    3             CALL PROCESS_SYMBOL;
      908    16094    3           END;
      909    16095    2         ELSE
      910    16096    2           CALL CONSOLIDATE_PICTURE_STRING;
      911    16097
      912    16098    2     END;  /* CASE ON LEX_STATE */
      913    16099
      914    16100
      915    16101    1     RETURN;
      916    16102
      917    16103
      918    16104        /* Initialization call to LEX */
      919    16105
      920    16106    1   Z8EL$LEX_INIT : ENTRY;
      921    16107
      922    16108    1     CALL Z9AA$IS_ES_REQUIRED;
      923    16109
      924    16110
      925    16111    1     CALL Z8EL$GET_NEXT_SCANNER_LINE;
      926    16112
      927    16113    1     RETURN;
      928    16114
      929    16115
      930    16116    1   END Z8EL$LEX;
      931    16117        %EOD;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:57   
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_P_STATE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$LEX.

   Procedure Z8EL$LEX requires 2714 words for executable code.
   Procedure Z8EL$LEX is declared NOAUTO and requires 126 words of local(STATIC) storage.

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:58   

 Object Unit name= Z8EL$LEX                                   File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:03:12.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   126    176  Z8EL$LEX
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none    90    132  LEX_SYMBOL
    3  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    5  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    6  LblCom even  none     1      1  SCANNER_STATE
    7  LblCom even  none     1      1  CURRENT_BUFFER$
    8  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    9  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   10  LblCom even  none     1      1  LINE_LIST$
   11  LblCom even  none     7      7  BUFFER
   12  LblCom even  none     1      1  ORIGINAL_ISN
   13  LblCom even  none     1      1  EXPANDED_ISN
   14  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   15  LblCom even  none     1      1  ST$
   16  LblCom even  none     5      5  ST_
   17  LblCom even  none     1      1  DNT$
   18  LblCom even  none     5      5  DNT_
   19  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   20  LblCom even  none     1      1  DNT_OF_1$
   21  LblCom even  none     1      1  HEAP$
   22  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
   23  LblCom even  none     1      1  REPLACE_ACTIVE
   24  LblCom even  none     1      1  IGNORE_COPY_REPLACE
   25  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   26  LblCom even  none     4      4  REPLACE_LIST
   27  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   28  LblCom even  none     1      1  GET_NEXT_SCANNER_LINE
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:59   
   29  LblCom even  none     1      1  SEARCH_REQUIRED
   30  LblCom even  none     1      1  LEX_STATE
   31  RoData even  UTS     22     26  Z8EL$LEX
   32   Proc  even  none  2714   5232  Z8EL$LEX
   33  RoData even  none    87    127  Z8EL$LEX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    32      0   yes            yes      Std        0  Z8EL$LEX
    32   5221                  yes      Std        0  Z8EL$LEX_INIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8EL$GET_NEXT_SCANNER_LINE
         yes           Std      12 Z8AE$ERROR
         yes           Std       0 Z9AA$IS_ES_REQUIRED
         yes           Std       2 Z8ED$DISPOSE_HEAP
         yes           Std       0 Z8ES$SCANNER
         yes           Std       1 Z8EL$HANDLE_LEVEL_CHANGE
         yes           Std       0 Z8AH$SEARCH_
         yes           Std       2 Z8ED$NEW_HEAP
 yes     yes           Std       1 Z8EL$POSSIBLE_REPLACE
         yes           Std       0 Z8EL$PROCESS_COPY
         yes           Std       0 Z8EL$PROCESS_REPLACE
         yes           Std       1 Z8ED$DISPOSE_ABSSYN_TREE
         yes           Std       3 Z8AU$CREATE_NUM_DESC
         yes           Std       1 Z8AR$RESERVER
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:60   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    USERWORD_SCAN_TABLE              r    ANSI_USERWORD_SCAN_TABLE
r    ASCII_SEARCH_TABLE               r    BLANK_SCAN_TABLE                 r    DIGIT_SCAN_TABLE
r    LETTER_SEARCH_TABLE              r    DOUBLE_QUOTE_SEARCH_TABLE        r    SINGLE_QUOTE_SEARCH_TABLE
r    DBL_QUOTE_PSEUDO_SEARCH_TABLE    r    SNGL_QUOTE_PSEUDO_SEARCH_TABLE   r    SEPARATORS_TABLE
r    LOWER_TO_UPPER_CASE              r    CURRENCY_SIGN_CHARS                   O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK                               DNT_BUCKETS

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:61   


        1        1        /*M*  Z8EL$LEX - Lexical analyzer */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        Z8EL$LEX :PROC NOAUTO;

      8 32 000000   000000 741200 0     Z8EL$LEX     STX1  ! 0
        32 000001   004732 710000 32                 TRA     s:15934

        9        9
       10       10
       11       11        /*P*
       12       12               NAME:  Z8EL$LEX
       13       13            PURPOSE:  Main driver for the lexical analyzer.  It builds the next token
       14       14                      to be processed by the parser from the symbol returned by the
       15       15                      scanner.
       16       16        */
       17       17
       18       18        /*D*
       19       19               NAME:  Z8EL$LEX
       20       20               CALL:  CALL Z8EL$LEX ;
       21       21          INTERFACE:  Z8ES$SCANNER   -- Returns the next symbol.
       22       22                      Z8AH$SEARCH    -- Returns DNT$ pointing to the LEXEME item.
       23       23                      Z8AE$ERROR     -- Error message routine.
       24       24
       25       25              INPUT:  LA_PUT - Pointer to the current position in O1COM.LA_STK.
       26       26             OUTPUT:  LA_STK - Lexical analysis stack containing current symbols.
       27       27            SCRATCH:  O1COM.RECORD_DCL - Inside of a record declaration?
       28       28
       29       29        DESCRIPTION:  This procedure is called by the parser to get the next token.
       30       30                      The scanner is called and LA_STK is set up.  If a DNT entry is
       31       31                      needed the search routine to return the pointer.  All of the
       32       32                      values that need to be set up in the LA_STK are then
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:62   
       33       33                      assigned to be used by the parser.
       34       34        */
       35       35        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:63   
       36       36
       37       37
       38       38        %EQU PHASE = 1;
       39       39        %EQU LOCALLY_LEAST_COST_RECOVERY = '0'B;
       40       40
       41       41        %INCLUDE Z8A_DEFC;
       42      109        %INCLUDE Z8A_SUPP_MAC;
       43     2509        %INCLUDE Z8A_COMCOM;
       44     3159        %INCLUDE Z8E_STACKS;
       45     5425        %INCLUDE Z8E_WINDOW;
       46     7495        %INCLUDE Z8E_TABLES;
       47     8048        %INCLUDE Z8E_BUFFERS;
       48     8238        %INCLUDE Z8E_O1COM;
       49     8999        %INCLUDE Z8A_TYPES;
       50     9173        %INCLUDE Z8A_ST;
       51    12832        %INCLUDE Z8A_DNT;
       52    13053        %INCLUDE Z8A_ERR_NUMS;
       53    13817        %INCLUDE Z8A_P_STATE;
       54    13827        %INCLUDE Z8E_HEAP;
       55    13883        %INCLUDE Z8E_REPLACE;
       56    14186
       57    14187    1   DCL GET_NEXT_SCANNER_LINE EPTR EXT INIT(ENTADDR(Z8EL$GET_NEXT_SCANNER_LINE));
       58    14188    1   DCL Z9AA$IS_ES_REQUIRED ENTRY;
       59    14189    1   DCL Z8EL$PROCESS_COPY ENTRY;
       60    14190    1   DCL Z8EL$PROCESS_REPLACE ENTRY;
       61    14191    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
       62    14192    1   DCL Z8EL$POSSIBLE_REPLACE ENTRY(1) ALTRET;
       63    14193    1   DCL Z8AU$CREATE_NUM_DESC ENTRY(3);
       64    14194    1   DCL Z8ED$DISPOSE_ABSSYN_TREE ENTRY(1);
       65    14195
       66    14196
       67    14197    1   DCL SEARCH_REQUIRED BOOLEAN EXT;
       68    14198
       69    14199    1   DCL LEX_STATE SBIN WORD EXT INIT(%LS_NORMAL);
       70    14200
       71    14201        %EQU ANSI_NUM_LIT_MAX_SIZE = 18;
       72    14202        %EQU NUM_LIT_MAX_SIZE = 63;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:64   
       73    14203        %EQU MAX_EXPONENT_DIGITS = 3;
       74    14204        %EQU USER_WORD_MAX_SIZE = 30;
       75    14205
       76    14206        %DCL_NUM_DESC;
       77    14215
       78    14216    1   DCL I SBIN WORD;
       79    14217        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:65   
       80    14218    1   DCL Z8AH$SEARCH_ ENTRY;
       81    14219    1   DCL Z8AE$ERROR ENTRY(12);
       82    14220
       83    14221    1   DCL 1 SAVED_SYMBOL STATIC ALIGNED, /* Storage for start of imperative stmt */
       84    14222    1         2 ALL_FIELDS_BUT_LINK,
       85    14223                %LA_STK_INFO(LVL=3);
       86    14242    1         2 LINK   UBIN WORD;
       87    14243    1   DCL SAVED_LEX_STATE SBIN STATIC;
       88    14244    1   DCL SAVED_CONT_FLAG BOOLEAN STATIC INIT(FALSE);
       89    14245
       90    14246    1   DCL CHAR_COLUMN SBIN WORD;
       91    14247    1   DCL CHAR_CLASS  SBIN WORD;
       92    14248
       93    14249    1   DCL TDNT$ PTR;
       94    14250    1   DCL HEAP$$  PTR;
       95    14251    1   DCL PROC$$  PTR;
       96    14252    1   DCL 1 PICTURE_SYMBOL STATIC,
       97    14253              %LEX_SYMBOL_INFO;
       98    14271    1         2 SYMBOL  CHAR(%MAX_SYMBOL_SIZE_PLUS_1);
       99    14272    1   DCL PARSING_PICTURE BOOLEAN STATIC INIT(FALSE);
      100    14273
      101    14274        %DEF_BUCKETS;
      102    14277        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:66   
      103    14278        %MACRO SAVE_IMPERATIVE_STMT_RSV_WRD ;
      104    14279               DO ;
      105    14280                  SAVED_SYMBOL = O1COM.LA_STK(O1COM.LA_PUT);
      106    14281                  SAVED_LEX_STATE = %LS_NORMAL;
      107    14282                  O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %INVISIBLE_STMT_START ;
      108    14283                  O1COM.LA_STK.DNT$(O1COM.LA_PUT) = ADDR(NIL) ;
      109    14284                  O1COM.LA_STK.FLAGS(O1COM.LA_PUT) = FALSE;
      110    14285                  O1COM.LA_STK.ST$(O1COM.LA_PUT) = ADDR(NIL);
      111    14286                  O1COM.LA_STK.TYPE(O1COM.LA_PUT) = 0;
      112    14287                  /* Leave line and column the same */
      113    14288                  LEX_STATE = %LS_PICK_UP_SAVED_SYMBOL;
      114    14289               END ;
      115    14290        %MEND ;
      116    14291
      117    14292        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:67   
      118    14293        %MACRO INITIALIZE_LA_STK_ITEM;
      119    14294          DO;
      120    14295            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
      121    14296                                @LA_ITEM = TRUE,
      122    14297                                @SYMBOL = LEX_SYMBOL.TYPE,
      123    14298                                @LINE = LEX_SYMBOL.LINE,
      124    14299                                @COLUMN = LEX_SYMBOL.COLUMN);
      125    14300          END;
      126    14301        %MEND;
      127    14302        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:68   
      128    14303        %MACRO CHECK_DELIM_AND_SIZE;
      129    14304          DO;
      130    14305
      131    14306          /* Check symbol for length */
      132    14307          IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN
      133    14308            DO;
      134    14309              CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,
      135    14310                              LEX_SYMBOL.LINE,
      136    14311                              LEX_SYMBOL.COLUMN);
      137    14312              LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;
      138    14313            END;
      139    14314
      140    14315          /* Check symbol for delimiter error */
      141    14316          IF LEX_SYMBOL.B.DELIM_ERROR THEN
      142    14317            DO;
      143    14318              CALL Z8AE$ERROR (%E$MISSING_DELIMITER,
      144    14319                               LEX_SYMBOL.LINE,
      145    14320                               LEX_SYMBOL.COLUMN);
      146    14321            END;
      147    14322
      148    14323
      149    14324          END;
      150    14325        %MEND;
      151    14326        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:69   
      152    14327    1   CREATE_DUMMY_NUM_LIT : PROC;

  14327 32 000002   000163 741200 0     CREATE_DUMM* STX1  ! PARSING_PICTURE+1

      153    14328
      154    14329    2     O1COM.LA_STK.B.ERROR(O1COM.LA_PUT) = TRUE;

  14329 32 000003   000132 235000 xsym               LDA     O1COM+90
        32 000004   000003 735000                    ALS     3
        32 000005   400000 236007                    LDQ     -131072,DL
        32 000006   000237 256005 xsym               ORSQ    O1COM+159,AL

      155    14330    2     O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT_OF_1$;

  14330 32 000007   000132 235000 xsym               LDA     O1COM+90
        32 000010   000003 735000                    ALS     3
        32 000011   000000 236000 20                 LDQ     DNT_OF_1$
        32 000012   000241 756005 xsym               STQ     O1COM+161,AL

      156    14331
      157    14332    2   END CREATE_DUMMY_NUM_LIT;

  14332 32 000013   000001 702211                    TSX2  ! 1,X1

      158    14333        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:70   
      159    14334        %MACRO VALIDATE_NUM_DESC;
      160    14335          DO;
      161    14336            IF COMCOM.OB.FIPS.LEVEL > 0
      162    14337                  AND NUM_DESC.DIGITS_LEFT
      163    14338                        + NUM_DESC.DIGITS_RIGHT
      164    14339                          > %ANSI_NUM_LIT_MAX_SIZE THEN
      165    14340              DO;
      166    14341                CALL Z8AE$ERROR (%E$ANSI_LARGE_NUMERIC_ITEM,
      167    14342                                 LEX_SYMBOL.LINE,
      168    14343                                 LEX_SYMBOL.COLUMN);
      169    14344              END;
      170    14345
      171    14346            IF COMCOM.OB.FIPS.LEVEL > 0
      172    14347                   AND NUM_DESC.DIGITS_EXPONENT > 0 THEN
      173    14348              DO;
      174    14349                CALL Z8AE$ERROR (%E$ANSI_FLOATING_POINT,
      175    14350                                 LEX_SYMBOL.LINE,
      176    14351                                 LEX_SYMBOL.COLUMN);
      177    14352              END;
      178    14353
      179    14354            IF NUM_DESC.DIGITS_LEFT
      180    14355                   + NUM_DESC.DIGITS_RIGHT
      181    14356                     > %NUM_LIT_MAX_SIZE THEN
      182    14357              DO;
      183    14358                CALL Z8AE$ERROR (%E$NUMERIC_ITEM_TOO_LONG,
      184    14359                                 LEX_SYMBOL.LINE,
      185    14360                                 LEX_SYMBOL.COLUMN);
      186    14361                CALL CREATE_DUMMY_NUM_LIT;
      187    14362              END;
      188    14363            ELSE
      189    14364              IF NUM_DESC.DIGITS_EXPONENT > %MAX_EXPONENT_DIGITS THEN
      190    14365                DO;
      191    14366                  CALL Z8AE$ERROR (%E$TOO_LARGE_NUM_EXP,
      192    14367                                   LEX_SYMBOL.LINE,
      193    14368                                   LEX_SYMBOL.COLUMN);
      194    14369                  CALL CREATE_DUMMY_NUM_LIT;
      195    14370                END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:71   
      196    14371
      197    14372            IF NUM_DESC.COMMA_PRESENT
      198    14373            AND (O1COM.CURRENT_PROC$ = ADDR(NIL)
      199    14374                 OR NOT O1COM.CURRENT_PROC$ -> PROC_.B.COMMA_IS_DECIMAL) THEN
      200    14375              CALL Z8AE$ERROR(%E$COMMA_IN_NUMBER,
      201    14376                              LEX_SYMBOL.LINE,
      202    14377                              LEX_SYMBOL.COLUMN);
      203    14378          END;
      204    14379        %MEND;
      205    14380        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:72   
      206    14381    1   REPLACED_TOKEN : PROC;

  14381 32 000014   000164 741200 0     REPLACED_TO* STX1  ! PARSING_PICTURE+2

      207    14382
      208    14383           %LIST;
      209    14384
      210    14385
      211    14386    2   NEW_TOKEN:
      212    14387
      213    14388          %GET_A_TOKEN;
             14389    3   DO;

  14389 32 000015                       NEW_TOKEN    null
             14390    3     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN

  14390 32 000015   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 000016   000000 116000 33                 CMPQ    0
        32 000017   000055 600000 32                 TZE     s:14413

             14391          %GET_LEX_SYMBOL_FROM_QUEUE;
             14392    4     DO;

             14393            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14394                                   TO$ = "ADDR(LEX_SYMBOL)");
             14395    5     DO;

             14396    5       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14396 32 000020   000000 470400 27                 LDP0    LEX_SYMBOL_QUEUE$
        32 000021   000010 235100                    LDA     8,,PR0
        32 000022   000010 755000 2                  STA     LEX_SYMBOL+8

             14397    5       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14397 32 000023   000010 720100                    LXL0    8,,PR0
        32 000024   000044 621010                    EAX1    36,X0
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:73   
        32 000025   000044 622005                    EAX2    36,AL
        32 000026   000040 100540                    MLR     fill='000'O
        32 000027   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        32 000030   000000 000012 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

             14398    5     END;

             14400    4       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

  14400 32 000031   000010 720100                    LXL0    8,,PR0
        32 000032   000044 621010                    EAX1    36,X0
        32 000033   000000 636011                    EAQ     0,X1
        32 000034   000022 732000                    QRS     18
        32 000035   000003 036007                    ADLQ    3,DL
        32 000036   000004 506007                    DIV     4,DL
        32 000037   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000040   000172 631400 0                  EPPR1   INSERT_SIZE+1
        32 000041   000175 451400 0                  STP1    INSERT_SIZE+4
        32 000042   000002 236000 33                 LDQ     2
        32 000043   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000044   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000045   000001 631400 33                 EPPR1   1
        32 000046   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        32 000047   000000 011000                    NOP     0

             14401                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14402    4     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14404    4                                 );
             14405    4       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  14405 32 000050   000000 236000 2                  LDQ     LEX_SYMBOL
        32 000051   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14406    4       LEX_SYMBOL.NEXT$ = ADDR(NIL);

  14406 32 000052   000000 236000 33                 LDQ     0
        32 000053   000000 756000 2                  STQ     LEX_SYMBOL
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:74   

             14407    4     END;

  14407 32 000054   000104 710000 32                 TRA     GOT_TOKEN

             14409    3     ELSE
             14410    4       DO;

             14411              %GET_BRAND_NEW_TOKEN;
             14412    5       DO;

             14413    5         CALL Z8ES$SCANNER;

  14413 32 000055   000003 631400 33                 EPPR1   3
        32 000056   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 000057   000000 011000                    NOP     0

             14414    6         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;

  14414 32 000060   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 000061   000072 601000 32                 TNZ     s:14420

             14415    6           CALL Z8EL$GET_NEXT_SCANNER_LINE;

  14415 32 000062   000003 631400 33                 EPPR1   3
        32 000063   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        32 000064   000000 011000                    NOP     0

             14416    6           CALL Z8ES$SCANNER;

  14416 32 000065   000003 631400 33                 EPPR1   3
        32 000066   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 000067   000000 011000                    NOP     0

             14417    6         END;

  14417 32 000070   000001 235000 2                  LDA     LEX_SYMBOL+1
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:75   
        32 000071   000062 600000 32                 TZE     s:14415

             14418    5       END;

             14420    4         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL

  14420 32 000072   000003 236000 2                  LDQ     LEX_SYMBOL+3
        32 000073   000000 116000 22                 CMPQ    CURRENT_SYMBOL_LEVEL
        32 000074   000104 600000 32                 TZE     GOT_TOKEN
        32 000075   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 000076   200000 316003                    CANQ    65536,DU
        32 000077   000104 601000 32                 TNZ     GOT_TOKEN

             14421    4              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14422    4           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);

  14422 32 000100   000005 630400 33                 EPPR0   5
        32 000101   000004 631400 33                 EPPR1   4
        32 000102   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        32 000103   000000 011000                    NOP     0

             14423    4     END;

             14424    3   END;

      214    14426    2   GOT_TOKEN:
      215    14427
      216    14428    2     IF SAVED_CONT_FLAG THEN

  14428 32 000104   000022 234000 0     GOT_TOKEN    SZN     SAVED_CONT_FLAG
        32 000105   000110 605000 32                 TPL     s:14431

      217    14429    2       LEX_SYMBOL.B.CONTINUED_TOKEN = TRUE;

  14429 32 000106   040000 236003                    LDQ     16384,DU
        32 000107   000002 256000 2                  ORSQ    LEX_SYMBOL+2

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:76   
      218    14430
      219    14431    2     IF NOT REPLACE_ACTIVE THEN

  14431 32 000110   000000 234000 23                 SZN     REPLACE_ACTIVE
        32 000111   000115 604000 32                 TMI     s:14437

      220    14432    3       DO;

      221    14433    3         SEARCH_REQUIRED = TRUE;

  14433 32 000112   400000 236003                    LDQ     -131072,DU
        32 000113   000000 756000 29                 STQ     SEARCH_REQUIRED

      222    14434    3       END;

  14434 32 000114   000516 710000 32                 TRA     s:14627

      223    14435    2     ELSE
      224    14436    3       DO;

      225    14437    3         CALL Z8AH$SEARCH_;

  14437 32 000115   000003 631400 33                 EPPR1   3
        32 000116   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 000117   000000 011000                    NOP     0

      226    14438    3         IF DNT$ -> DNT.B.REPLACE_TOKEN THEN

  14438 32 000120   000000 470400 17                 LDP0    DNT$
        32 000121   000003 236100                    LDQ     3,,PR0
        32 000122   010000 316003                    CANQ    4096,DU
        32 000123   000240 600000 32                 TZE     s:14505

      227    14439    4           DO;

      228    14440
      229    14441                  /* Put lex symbol at front of queue */
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:77   
      230    14442                  %SAVE_TOKEN_ON_THE_QUEUE;
             14443    5      DO;

             14444             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14445                                      TO$   = HEAP$);
             14446    6     DO;

             14447    6       CALL Z8ED$NEW_HEAP (TO$,

  14447 32 000124   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 000125   000047 036007                    ADLQ    39,DL
        32 000126   000004 506007                    DIV     4,DL
        32 000127   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000130   000172 631400 0                  EPPR1   INSERT_SIZE+1
        32 000131   000175 451400 0                  STP1    INSERT_SIZE+4
        32 000132   000006 236000 33                 LDQ     6
        32 000133   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000134   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000135   000001 631400 33                 EPPR1   1
        32 000136   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        32 000137   000000 011000                    NOP     0

             14448                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14449    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14451    6                             );
             14452            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14453    7     DO;

             14454    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14454 32 000140   000000 470400 21                 LDP0    HEAP$
        32 000141   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000142   000010 755100                    STA     8,,PR0

             14455    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14455 32 000143   000010 720100                    LXL0    8,,PR0
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:78   
        32 000144   000044 621010                    EAX1    36,X0
        32 000145   000010 722000 2                  LXL2    LEX_SYMBOL+8
        32 000146   000044 623012                    EAX3    36,X2
        32 000147   000140 100440                    MLR     fill='000'O
        32 000150   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        32 000151   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

             14456    7     END;

             14458    6     END;

             14460    5        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

  14460 32 000152   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 000153   000000 470400 21                 LDP0    HEAP$
        32 000154   000000 756100                    STQ     0,,PR0

             14461    5        LEX_SYMBOL_QUEUE$ = HEAP$;

  14461 32 000155   000000 236000 21                 LDQ     HEAP$
        32 000156   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14462    5      END;

      231    14464
      232    14465                  /* Check for end of PIC before calling POSSIBLE_REPLACE.  */
      233    14466                  /* See procedure CONSOLIDATE_PICTURE_STRING (STAR T02424) */
      234    14467
      235    14468    4             IF PARSING_PICTURE AND

  14468 32 000157   000162 234000 0                  SZN     PARSING_PICTURE
        32 000160   000174 605000 32                 TPL     s:14477
        32 000161   000037 236000 0                  LDQ     PICTURE_SYMBOL+7
        32 000162   000005 116000 2                  CMPQ    LEX_SYMBOL+5
        32 000163   000172 601000 32                 TNZ     s:14473
        32 000164   000036 236000 0                  LDQ     PICTURE_SYMBOL+6
        32 000165   000004 116000 2                  CMPQ    LEX_SYMBOL+4
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:79   
        32 000166   000172 601000 32                 TNZ     s:14473
        32 000167   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 000170   000014 115007                    CMPA    12,DL
        32 000171   000174 601000 32                 TNZ     s:14477

      236    14469    4               (PICTURE_SYMBOL.END_COLUMN ~= LEX_SYMBOL.COLUMN
      237    14470    4                OR PICTURE_SYMBOL.END_LINE   ~= LEX_SYMBOL.LINE
      238    14471    4                OR LEX_SYMBOL.TYPE = %PERIOD) THEN
      239    14472    5                  DO;

      240    14473    5                    LEX_STATE = %LS_NORMAL;

  14473 32 000172   000000 450000 30                 STZ     LEX_STATE

      241    14474    5                    PARSING_PICTURE = FALSE;

  14474 32 000173   000162 450000 0                  STZ     PARSING_PICTURE

      242    14475    5                  END;

      243    14476
      244    14477    4             CALL Z8EL$POSSIBLE_REPLACE (0)

  14477 32 000174   000007 630400 33                 EPPR0   7
        32 000175   000004 631400 33                 EPPR1   4
        32 000176   000000 701000 xent               TSX1    Z8EL$POSSIBLE_REPLACE
        32 000177   000201 702000 32                 TSX2    s:14489

      245    14478    4               WHENRETURN
      246    14479    5                 DO;

      247    14480    5                   GOTO NEW_TOKEN;

  14480 32 000200   000015 710000 32                 TRA     NEW_TOKEN

      248    14481    5                 END;
      249    14482    4               WHENALTRETURN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:80   
      250    14483    5                 DO;

      251    14484                        %GET_LEX_SYMBOL_FROM_QUEUE;
             14485    6     DO;

             14486            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14487                                   TO$ = "ADDR(LEX_SYMBOL)");
             14488    7     DO;

             14489    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14489 32 000201   000000 470400 27                 LDP0    LEX_SYMBOL_QUEUE$
        32 000202   000010 235100                    LDA     8,,PR0
        32 000203   000010 755000 2                  STA     LEX_SYMBOL+8

             14490    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14490 32 000204   000010 720100                    LXL0    8,,PR0
        32 000205   000044 621010                    EAX1    36,X0
        32 000206   000044 622005                    EAX2    36,AL
        32 000207   000040 100540                    MLR     fill='000'O
        32 000210   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        32 000211   000000 000012 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

             14491    7     END;

             14493    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

  14493 32 000212   000010 720100                    LXL0    8,,PR0
        32 000213   000044 621010                    EAX1    36,X0
        32 000214   000000 636011                    EAQ     0,X1
        32 000215   000022 732000                    QRS     18
        32 000216   000003 036007                    ADLQ    3,DL
        32 000217   000004 506007                    DIV     4,DL
        32 000220   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000221   000172 631400 0                  EPPR1   INSERT_SIZE+1
        32 000222   000175 451400 0                  STP1    INSERT_SIZE+4
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:81   
        32 000223   000002 236000 33                 LDQ     2
        32 000224   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000225   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000226   000001 631400 33                 EPPR1   1
        32 000227   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        32 000230   000000 011000                    NOP     0

             14494                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14495    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14497    6                                 );
             14498    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  14498 32 000231   000000 236000 2                  LDQ     LEX_SYMBOL
        32 000232   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14499    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);

  14499 32 000233   000000 236000 33                 LDQ     0
        32 000234   000000 756000 2                  STQ     LEX_SYMBOL

             14500    6     END;

      252    14502    5                   SEARCH_REQUIRED = TRUE;

  14502 32 000235   400000 236003                    LDQ     -131072,DU
        32 000236   000000 756000 29                 STQ     SEARCH_REQUIRED

      253    14503    5                 END;

      254    14504    4           END;

  14504 32 000237   000516 710000 32                 TRA     s:14627

      255    14505    3         ELSE IF BUFFER.CLASS = %SPACE OR

  14505 32 000240   000001 235000 11                 LDA     BUFFER+1
        32 000241   000042 115007                    CMPA    34,DL
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:82   
        32 000242   000264 600000 32                 TZE     s:14514
        32 000243   000000 115003                    CMPA    0,DU
        32 000244   000264 600000 32                 TZE     s:14514
        32 000245   000001 115007                    CMPA    1,DL
        32 000246   000264 600000 32                 TZE     s:14514
        32 000247   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 000250   000005 115007                    CMPA    5,DL
        32 000251   000262 600000 32                 TZE     s:14505+18
        32 000252   000002 115007                    CMPA    2,DL
        32 000253   000262 600000 32                 TZE     s:14505+18
        32 000254   000025 115007                    CMPA    21,DL
        32 000255   000262 600000 32                 TZE     s:14505+18
        32 000256   000027 115007                    CMPA    23,DL
        32 000257   000262 600000 32                 TZE     s:14505+18
        32 000260   000041 115007                    CMPA    33,DL
        32 000261   000264 601000 32                 TNZ     s:14514
        32 000262   000162 234000 0                  SZN     PARSING_PICTURE
        32 000263   000266 605000 32                 TPL     s:14519

      256    14506    3             BUFFER.CLASS = %END_OF_LINE OR
      257    14507    3             BUFFER.CLASS = %END_OF_FILE OR
      258    14508    3             (LEX_SYMBOL.TYPE ~= %USER_WORD AND
      259    14509    3              LEX_SYMBOL.TYPE ~= %NUMBER_OR_PARAGRAPH AND
      260    14510    3              LEX_SYMBOL.TYPE ~= %NUMBER AND
      261    14511    3              LEX_SYMBOL.TYPE ~= %NAME AND
      262    14512    3              LEX_SYMBOL.TYPE ~= %LETTER_E) OR
      263    14513    3             PARSING_PICTURE THEN
      264    14514    3           SEARCH_REQUIRED = FALSE;

  14514 32 000264   000000 450000 29                 STZ     SEARCH_REQUIRED
        32 000265   000516 710000 32                 TRA     s:14627

      265    14515    3         ELSE
      266    14516    4           DO;

      267    14517                  %SAVE_CURRENT_TOKEN;
             14518    5      DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:83   

             14519    5        TEMP_LEX_SYMBOL = LEX_SYMBOL;

  14519 32 000266   000000 100400                    MLR     fill='000'O
        32 000267   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360
        32 000270   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360

             14520    5      END;

      268    14522                  %GET_A_TOKEN;
             14523    5   DO;

             14524    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN

  14524 32 000271   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 000272   000000 116000 33                 CMPQ    0
        32 000273   000331 600000 32                 TZE     s:14547

             14525          %GET_LEX_SYMBOL_FROM_QUEUE;
             14526    6     DO;

             14527            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14528                                   TO$ = "ADDR(LEX_SYMBOL)");
             14529    7     DO;

             14530    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14530 32 000274   000000 471400 27                 LDP1    LEX_SYMBOL_QUEUE$
        32 000275   100010 235100                    LDA     8,,PR1
        32 000276   000010 755000 2                  STA     LEX_SYMBOL+8

             14531    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14531 32 000277   100010 720100                    LXL0    8,,PR1
        32 000300   000044 621010                    EAX1    36,X0
        32 000301   000044 622005                    EAX2    36,AL
        32 000302   000040 100540                    MLR     fill='000'O
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:84   
        32 000303   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        32 000304   000000 000012 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

             14532    7     END;

             14534    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

  14534 32 000305   100010 720100                    LXL0    8,,PR1
        32 000306   000044 621010                    EAX1    36,X0
        32 000307   000000 636011                    EAQ     0,X1
        32 000310   000022 732000                    QRS     18
        32 000311   000003 036007                    ADLQ    3,DL
        32 000312   000004 506007                    DIV     4,DL
        32 000313   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000314   000172 633400 0                  EPPR3   INSERT_SIZE+1
        32 000315   000175 453400 0                  STP3    INSERT_SIZE+4
        32 000316   000002 236000 33                 LDQ     2
        32 000317   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000320   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000321   000001 631400 33                 EPPR1   1
        32 000322   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        32 000323   000000 011000                    NOP     0

             14535                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14536    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14538    6                                 );
             14539    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  14539 32 000324   000000 236000 2                  LDQ     LEX_SYMBOL
        32 000325   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14540    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);

  14540 32 000326   000000 236000 33                 LDQ     0
        32 000327   000000 756000 2                  STQ     LEX_SYMBOL

             14541    6     END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:85   

  14541 32 000330   000360 710000 32                 TRA     s:14560

             14543    5     ELSE
             14544    6       DO;

             14545              %GET_BRAND_NEW_TOKEN;
             14546    7       DO;

             14547    7         CALL Z8ES$SCANNER;

  14547 32 000331   000003 631400 33                 EPPR1   3
        32 000332   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 000333   000000 011000                    NOP     0

             14548    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;

  14548 32 000334   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 000335   000346 601000 32                 TNZ     s:14554

             14549    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;

  14549 32 000336   000003 631400 33                 EPPR1   3
        32 000337   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        32 000340   000000 011000                    NOP     0

             14550    8           CALL Z8ES$SCANNER;

  14550 32 000341   000003 631400 33                 EPPR1   3
        32 000342   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 000343   000000 011000                    NOP     0

             14551    8         END;

  14551 32 000344   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 000345   000336 600000 32                 TZE     s:14549

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:86   
             14552    7       END;

             14554    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL

  14554 32 000346   000003 236000 2                  LDQ     LEX_SYMBOL+3
        32 000347   000000 116000 22                 CMPQ    CURRENT_SYMBOL_LEVEL
        32 000350   000360 600000 32                 TZE     s:14560
        32 000351   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 000352   200000 316003                    CANQ    65536,DU
        32 000353   000360 601000 32                 TNZ     s:14560

             14555    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14556    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);

  14556 32 000354   000005 630400 33                 EPPR0   5
        32 000355   000004 631400 33                 EPPR1   4
        32 000356   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        32 000357   000000 011000                    NOP     0

             14557    6     END;

             14558    5   END;

      269    14560    4             CALL Z8AH$SEARCH_;

  14560 32 000360   000003 631400 33                 EPPR1   3
        32 000361   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 000362   000000 011000                    NOP     0

      270    14561                  %SAVE_TOKEN_ON_THE_QUEUE;
             14562    5      DO;

             14563             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14564                                      TO$   = HEAP$);
             14565    6     DO;

             14566    6       CALL Z8ED$NEW_HEAP (TO$,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:87   

  14566 32 000363   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 000364   000047 036007                    ADLQ    39,DL
        32 000365   000004 506007                    DIV     4,DL
        32 000366   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000367   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 000370   000175 450400 0                  STP0    INSERT_SIZE+4
        32 000371   000006 236000 33                 LDQ     6
        32 000372   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000373   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000374   000001 631400 33                 EPPR1   1
        32 000375   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        32 000376   000000 011000                    NOP     0

             14567                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14568    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14570    6                             );
             14571            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14572    7     DO;

             14573    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14573 32 000377   000000 470400 21                 LDP0    HEAP$
        32 000400   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000401   000010 755100                    STA     8,,PR0

             14574    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14574 32 000402   000010 720100                    LXL0    8,,PR0
        32 000403   000044 621010                    EAX1    36,X0
        32 000404   000010 722000 2                  LXL2    LEX_SYMBOL+8
        32 000405   000044 623012                    EAX3    36,X2
        32 000406   000140 100440                    MLR     fill='000'O
        32 000407   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        32 000410   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

             14575    7     END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:88   

             14577    6     END;

             14579    5        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

  14579 32 000411   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 000412   000000 470400 21                 LDP0    HEAP$
        32 000413   000000 756100                    STQ     0,,PR0

             14580    5        LEX_SYMBOL_QUEUE$ = HEAP$;

  14580 32 000414   000000 236000 21                 LDQ     HEAP$
        32 000415   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14581    5      END;

      271    14583    4             IF DNT$ -> DNT.B.REPLACE_TOKEN THEN

  14583 32 000416   000000 470400 17                 LDP0    DNT$
        32 000417   000003 236100                    LDQ     3,,PR0
        32 000420   010000 316003                    CANQ    4096,DU
        32 000421   000511 600000 32                 TZE     s:14618

      272    14584    5               DO;

      273    14585
      274    14586    5                 CALL Z8EL$POSSIBLE_REPLACE (0)

  14586 32 000422   000007 630400 33                 EPPR0   7
        32 000423   000004 631400 33                 EPPR1   4
        32 000424   000000 701000 xent               TSX1    Z8EL$POSSIBLE_REPLACE
        32 000425   000511 702000 32                 TSX2    s:14618

      275    14587    6                   WHENRETURN DO;

      276    14588                          %LOAD_SAVED_TOKEN;
             14589    7      DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:89   

             14590    7        LEX_SYMBOL = TEMP_LEX_SYMBOL;

  14590 32 000426   000000 100400                    MLR     fill='000'O
        32 000427   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360
        32 000430   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360

             14591    7      END;

      277    14593    6                     IF LEX_SYMBOL_QUEUE$ ~= ADDR (NIL) AND

  14593 32 000431   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 000432   000000 116000 33                 CMPQ    0
        32 000433   000510 600000 32                 TZE     s:14613
        32 000434   000000 470400 27                 LDP0    LEX_SYMBOL_QUEUE$
        32 000435   000005 235100                    LDA     5,,PR0
        32 000436   000006 471400 11                 LDP1    BUFFER+6
        32 000437   040000 106505                    CMPC    fill='040'O
        32 000440   177777 600001                    ADSC9   -1,A,PR1                 cn=3,n=1
        32 000441   000010 000001 33                 ADSC9   8                        cn=0,n=1
        32 000442   000510 600000 32                 TZE     s:14613

      278    14594    6                         SUBSTR (BUFFER_LINE,
      279    14595    6                                 LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.COLUMN - 1,
      280    14596    6                                 1) ~= ' ' THEN
      281    14597    7                       DO;

      282    14598    7                       I = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.SIZE;

  14598 32 000443   000010 235100                    LDA     8,,PR0
        32 000444   000010 755000 0                  STA     I

      283    14599    7                       IF I > %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE

  14599 32 000445   000504 236007                    LDQ     324,DL
        32 000446   000010 136000 2                  SBLQ    LEX_SYMBOL+8
        32 000447   000010 116000 0                  CMPQ    I
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:90   
        32 000450   000452 605000 32                 TPL     s:14601

      284    14600    7                         THEN I = %MAX_SYMBOL_SIZE_PLUS_1 - LEX_SYMBOL.SIZE;

  14600 32 000451   000010 756000 0                  STQ     I

      285    14601    7                       SUBSTR (LEX_SYMBOL.SYMBOL, LEX_SYMBOL.SIZE, I)

  14601 32 000452   000010 720100                    LXL0    8,,PR0
        32 000453   000010 721000 0                  LXL1    I
        32 000454   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000455   040045 100540                    MLR     fill='040'O
        32 000456   000011 000010                    ADSC9   9,,PR0                   cn=0,n=*X0
        32 000457   000011 000011 2                  ADSC9   LEX_SYMBOL+9,A           cn=0,n=*X1

      286    14602    7                         = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.SYMBOL;
      287    14603    7                       LEX_SYMBOL.SIZE = LEX_SYMBOL.SIZE + I;

  14603 32 000460   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 000461   000010 036000 0                  ADLQ    I
        32 000462   000010 756000 2                  STQ     LEX_SYMBOL+8

      288    14604    7                       LEX_SYMBOL.END_COLUMN = BUFFER.COLUMN;

  14604 32 000463   000000 235000 11                 LDA     BUFFER
        32 000464   000007 755000 2                  STA     LEX_SYMBOL+7

      289    14605    7                       HEAP$$ = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.NEXT$;

  14605 32 000465   000000 236100                    LDQ     0,,PR0
        32 000466   000026 756000 0                  STQ     HEAP$$

      290    14606    7                       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

  14606 32 000467   000010 720100                    LXL0    8,,PR0
        32 000470   000044 622010                    EAX2    36,X0
        32 000471   000000 636012                    EAQ     0,X2
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:91   
        32 000472   000022 732000                    QRS     18
        32 000473   000003 036007                    ADLQ    3,DL
        32 000474   000004 506007                    DIV     4,DL
        32 000475   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000476   000172 633400 0                  EPPR3   INSERT_SIZE+1
        32 000477   000175 453400 0                  STP3    INSERT_SIZE+4
        32 000500   000002 236000 33                 LDQ     2
        32 000501   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000502   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000503   000001 631400 33                 EPPR1   1
        32 000504   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        32 000505   000000 011000                    NOP     0

      291    14607                                                    %LEX_SYMBOL_ACTUAL_WORD_LEN (S$=
             14607                                                        LEX_SYMBOL_QUEUE$);
             14608    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
      292    14610    7                                               );
      293    14611    7                       LEX_SYMBOL_QUEUE$ = HEAP$$;

  14611 32 000506   000026 236000 0                  LDQ     HEAP$$
        32 000507   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

      294    14612    7                       END;

      295    14613    6                     GOTO GOT_TOKEN;

  14613 32 000510   000104 710000 32                 TRA     GOT_TOKEN

      296    14614    6                   END;
      297    14615    5               END; /* DNT$ -> DNT.B.REPLACE_TOKEN */

      298    14616                  %LOAD_SAVED_TOKEN;
             14617    5      DO;

             14618    5        LEX_SYMBOL = TEMP_LEX_SYMBOL;

  14618 32 000511   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:92   
        32 000512   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360
        32 000513   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360

             14619    5      END;

      299    14621    4             SEARCH_REQUIRED = TRUE;

  14621 32 000514   400000 236003                    LDQ     -131072,DU
        32 000515   000000 756000 29                 STQ     SEARCH_REQUIRED

      300    14622    4           END;

      301    14623    3       END;

      302    14624
      303    14625          /* Ignore COPY & REPLACE in comment entries if column > 11 */
      304    14626
      305    14627    2     IF NOT IGNORE_COPY_REPLACE

  14627 32 000516   000000 234000 24                 SZN     IGNORE_COPY_REPLACE
        32 000517   000523 605000 32                 TPL     s:14631
        32 000520   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 000521   000121 116000 xsym               CMPQ    O1COM+81
        32 000522   000564 605000 32                 TPL     s:14659

      306    14628    2     OR LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START THEN
      307    14629    3       DO;

      308    14630              /* Check for copy/replace */
      309    14631    3         IF LEX_SYMBOL.SIZE = 4

  14631 32 000523   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000524   000004 115007                    CMPA    4,DL
        32 000525   000540 601000 32                 TNZ     s:14639
        32 000526   000011 236000 2                  LDQ     LEX_SYMBOL+9
        32 000527   000000 116000 31                 CMPQ    0
        32 000530   000540 601000 32                 TNZ     s:14639
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:93   

      310    14632    3             AND SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'COPY' THEN
      311    14633    4           DO;

      312    14634    4             CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;

  14634 32 000531   000000 470400 7                  LDP0    CURRENT_BUFFER$
        32 000532   000010 236003                    LDQ     8,DU
        32 000533   000011 256100                    ORSQ    9,,PR0

      313    14635    4             CALL Z8EL$PROCESS_COPY;

  14635 32 000534   000003 631400 33                 EPPR1   3
        32 000535   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        32 000536   000000 011000                    NOP     0

      314    14636    4             GOTO NEW_TOKEN;

  14636 32 000537   000015 710000 32                 TRA     NEW_TOKEN

      315    14637    4           END;
      316    14638    3         ELSE
      317    14639    3           IF LEX_SYMBOL.SIZE = 7

  14639 32 000540   000007 115007                    CMPA    7,DL
        32 000541   000564 601000 32                 TNZ     s:14659
        32 000542   040000 106400                    CMPC    fill='040'O
        32 000543   000011 000007 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=7
        32 000544   000001 000007 31                 ADSC9   1                        cn=0,n=7
        32 000545   000564 601000 32                 TNZ     s:14659

      318    14640    3             AND SUBSTR(LEX_SYMBOL.SYMBOL,0,7) = 'REPLACE' THEN
      319    14641    4             DO;

      320    14642    4               IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN

  14642 32 000546   000036 720000 xsym               LXL0    COMCOM+30
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:94   
        32 000547   000002 100003                    CMPX0   2,DU
        32 000550   000555 604000 32                 TMI     s:14646

      321    14643    4                 CALL Z8AE$ERROR (%E$LEVEL_CHECK,

  14643 32 000551   000013 630400 33                 EPPR0   11
        32 000552   000011 631400 33                 EPPR1   9
        32 000553   000000 701000 xent               TSX1    Z8AE$ERROR
        32 000554   000000 011000                    NOP     0

      322    14644    4                                  LEX_SYMBOL.LINE,
      323    14645    4                                  LEX_SYMBOL.COLUMN);
      324    14646    4               CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;

  14646 32 000555   000000 470400 7                  LDP0    CURRENT_BUFFER$
        32 000556   000010 236003                    LDQ     8,DU
        32 000557   000011 256100                    ORSQ    9,,PR0

      325    14647    4               CALL Z8EL$PROCESS_REPLACE;

  14647 32 000560   000003 631400 33                 EPPR1   3
        32 000561   000000 701000 xent               TSX1    Z8EL$PROCESS_REPLACE
        32 000562   000000 011000                    NOP     0

      326    14648    4               GOTO NEW_TOKEN;

  14648 32 000563   000015 710000 32                 TRA     NEW_TOKEN

      327    14649    4             END;
      328    14650    3       END;
      329    14651
      330    14652        /* Next two macro calls are designed to resolve the problems
      331    14653           of LALR1 parsing limitation, so WITH DATA or NO DATA won't
      332    14654           mess up with WITH NO ADVANCING clause, and, ON SIZE ERROR
      333    14655           won't mess up with NOT ON EXCEPTION clause                */
      334    14656
      335    14657          %REPLACE_WITH_DATA_NO_DATA;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:95   
             14658    3     DO;

             14659    3       IF LEX_SYMBOL.SIZE = 4 AND

  14659 32 000564   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000565   000004 115007                    CMPA    4,DL
        32 000566   000742 601000 32                 TNZ     s:14746
        32 000567   000011 236000 2                  LDQ     LEX_SYMBOL+9
        32 000570   000003 116000 31                 CMPQ    3
        32 000571   000742 601000 32                 TNZ     s:14746

             14660    3         SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'WITH' THEN
             14661    4          DO;

             14662                 %SAVE_CURRENT_TOKEN;
             14663    5      DO;

             14664    5        TEMP_LEX_SYMBOL = LEX_SYMBOL;

  14664 32 000572   000000 100400                    MLR     fill='000'O
        32 000573   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360
        32 000574   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360

             14665    5      END;

             14667                 %GET_A_TOKEN;
             14668    5   DO;

             14669    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN

  14669 32 000575   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 000576   000000 116000 33                 CMPQ    0
        32 000577   000635 600000 32                 TZE     s:14692

             14670          %GET_LEX_SYMBOL_FROM_QUEUE;
             14671    6     DO;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:96   
             14672            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14673                                   TO$ = "ADDR(LEX_SYMBOL)");
             14674    7     DO;

             14675    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14675 32 000600   000000 470400 27                 LDP0    LEX_SYMBOL_QUEUE$
        32 000601   000010 235100                    LDA     8,,PR0
        32 000602   000010 755000 2                  STA     LEX_SYMBOL+8

             14676    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14676 32 000603   000010 720100                    LXL0    8,,PR0
        32 000604   000044 621010                    EAX1    36,X0
        32 000605   000044 622005                    EAX2    36,AL
        32 000606   000040 100540                    MLR     fill='000'O
        32 000607   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        32 000610   000000 000012 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

             14677    7     END;

             14679    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

  14679 32 000611   000010 720100                    LXL0    8,,PR0
        32 000612   000044 621010                    EAX1    36,X0
        32 000613   000000 636011                    EAQ     0,X1
        32 000614   000022 732000                    QRS     18
        32 000615   000003 036007                    ADLQ    3,DL
        32 000616   000004 506007                    DIV     4,DL
        32 000617   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000620   000172 631400 0                  EPPR1   INSERT_SIZE+1
        32 000621   000175 451400 0                  STP1    INSERT_SIZE+4
        32 000622   000002 236000 33                 LDQ     2
        32 000623   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000624   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000625   000001 631400 33                 EPPR1   1
        32 000626   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:97   
        32 000627   000000 011000                    NOP     0

             14680                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14681    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14683    6                                 );
             14684    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  14684 32 000630   000000 236000 2                  LDQ     LEX_SYMBOL
        32 000631   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14685    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);

  14685 32 000632   000000 236000 33                 LDQ     0
        32 000633   000000 756000 2                  STQ     LEX_SYMBOL

             14686    6     END;

  14686 32 000634   000664 710000 32                 TRA     s:14705

             14688    5     ELSE
             14689    6       DO;

             14690              %GET_BRAND_NEW_TOKEN;
             14691    7       DO;

             14692    7         CALL Z8ES$SCANNER;

  14692 32 000635   000003 631400 33                 EPPR1   3
        32 000636   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 000637   000000 011000                    NOP     0

             14693    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;

  14693 32 000640   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 000641   000652 601000 32                 TNZ     s:14699

             14694    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:98   

  14694 32 000642   000003 631400 33                 EPPR1   3
        32 000643   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        32 000644   000000 011000                    NOP     0

             14695    8           CALL Z8ES$SCANNER;

  14695 32 000645   000003 631400 33                 EPPR1   3
        32 000646   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 000647   000000 011000                    NOP     0

             14696    8         END;

  14696 32 000650   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 000651   000642 600000 32                 TZE     s:14694

             14697    7       END;

             14699    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL

  14699 32 000652   000003 236000 2                  LDQ     LEX_SYMBOL+3
        32 000653   000000 116000 22                 CMPQ    CURRENT_SYMBOL_LEVEL
        32 000654   000664 600000 32                 TZE     s:14705
        32 000655   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 000656   200000 316003                    CANQ    65536,DU
        32 000657   000664 601000 32                 TNZ     s:14705

             14700    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14701    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);

  14701 32 000660   000005 630400 33                 EPPR0   5
        32 000661   000004 631400 33                 EPPR1   4
        32 000662   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        32 000663   000000 011000                    NOP     0

             14702    6     END;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:99   
             14703    5   END;

             14705    4            IF LEX_SYMBOL.SIZE = 4 AND

  14705 32 000664   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000665   000004 115007                    CMPA    4,DL
        32 000666   000704 601000 32                 TNZ     s:14722
        32 000667   000011 236000 2                  LDQ     LEX_SYMBOL+9
        32 000670   000004 116000 31                 CMPQ    4
        32 000671   000704 601000 32                 TNZ     s:14722

             14706    4              SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'DATA' THEN
             14707                     %REPLACE_WITH_DATA_TOKEN;
             14708    5      DO;

             14709    5        LEX_SYMBOL.LINE = TEMP_LEX_SYMBOL.LINE;

  14709 32 000672   000004 235000 4                  LDA     TEMP_LEX_SYMBOL+4
        32 000673   000004 755000 2                  STA     LEX_SYMBOL+4

             14710    5        LEX_SYMBOL.COLUMN = TEMP_LEX_SYMBOL.COLUMN;

  14710 32 000674   000005 235000 4                  LDA     TEMP_LEX_SYMBOL+5
        32 000675   000005 755000 2                  STA     LEX_SYMBOL+5

             14711    5        LEX_SYMBOL.SIZE = %WITH_DATA_SIZE;

  14711 32 000676   000011 235007                    LDA     9,DL
        32 000677   000010 755000 2                  STA     LEX_SYMBOL+8

             14712    5        SUBSTR(LEX_SYMBOL.SYMBOL,0,%WITH_DATA_SIZE) = %WITH_DATA_TEXT;

  14712 32 000700   040000 100400                    MLR     fill='040'O
        32 000701   000005 000011 31                 ADSC9   5                        cn=0,n=9
        32 000702   000011 000011 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=9

             14713    5      END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:100  

  14713 32 000703   000742 710000 32                 TRA     s:14746

             14715    4            ELSE
             14716    5              DO;

             14717                     %SAVE_TOKEN_ON_THE_QUEUE;
             14718    6      DO;

             14719             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14720                                      TO$   = HEAP$);
             14721    7     DO;

             14722    7       CALL Z8ED$NEW_HEAP (TO$,

  14722 32 000704   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 000705   000047 036007                    ADLQ    39,DL
        32 000706   000004 506007                    DIV     4,DL
        32 000707   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000710   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 000711   000175 450400 0                  STP0    INSERT_SIZE+4
        32 000712   000006 236000 33                 LDQ     6
        32 000713   000174 756000 0                  STQ     INSERT_SIZE+3
        32 000714   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 000715   000001 631400 33                 EPPR1   1
        32 000716   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        32 000717   000000 011000                    NOP     0

             14723                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14724    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14726    7                             );
             14727            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14728    8     DO;

             14729    8       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14729 32 000720   000000 470400 21                 LDP0    HEAP$
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:101  
        32 000721   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000722   000010 755100                    STA     8,,PR0

             14730    8       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14730 32 000723   000010 720100                    LXL0    8,,PR0
        32 000724   000044 621010                    EAX1    36,X0
        32 000725   000010 722000 2                  LXL2    LEX_SYMBOL+8
        32 000726   000044 623012                    EAX3    36,X2
        32 000727   000140 100440                    MLR     fill='000'O
        32 000730   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        32 000731   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

             14731    8     END;

             14733    7     END;

             14735    6        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

  14735 32 000732   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 000733   000000 470400 21                 LDP0    HEAP$
        32 000734   000000 756100                    STQ     0,,PR0

             14736    6        LEX_SYMBOL_QUEUE$ = HEAP$;

  14736 32 000735   000000 236000 21                 LDQ     HEAP$
        32 000736   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14737    6      END;

             14739                     %LOAD_SAVED_TOKEN;
             14740    6      DO;

             14741    6        LEX_SYMBOL = TEMP_LEX_SYMBOL;

  14741 32 000737   000000 100400                    MLR     fill='000'O
        32 000740   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:102  
        32 000741   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360

             14742    6      END;

             14744    5              END;

             14745    4          END;

             14746    3       IF LEX_SYMBOL.SIZE = 2 AND

  14746 32 000742   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 000743   000002 115007                    CMPA    2,DL
        32 000744   001120 601000 32                 TNZ     s:14838
        32 000745   000011 220000 2                  LDX0    LEX_SYMBOL+9
        32 000746   000010 100000 31                 CMPX0   8
        32 000747   001120 601000 32                 TNZ     s:14838

             14747    3         SUBSTR(LEX_SYMBOL.SYMBOL,0,2) = 'NO' THEN
             14748    4          DO;

             14749                 %SAVE_CURRENT_TOKEN;
             14750    5      DO;

             14751    5        TEMP_LEX_SYMBOL = LEX_SYMBOL;

  14751 32 000750   000000 100400                    MLR     fill='000'O
        32 000751   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360
        32 000752   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360

             14752    5      END;

             14754                 %GET_A_TOKEN;
             14755    5   DO;

             14756    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN

  14756 32 000753   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:103  
        32 000754   000000 116000 33                 CMPQ    0
        32 000755   001013 600000 32                 TZE     s:14779

             14757          %GET_LEX_SYMBOL_FROM_QUEUE;
             14758    6     DO;

             14759            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14760                                   TO$ = "ADDR(LEX_SYMBOL)");
             14761    7     DO;

             14762    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14762 32 000756   000000 470400 27                 LDP0    LEX_SYMBOL_QUEUE$
        32 000757   000010 235100                    LDA     8,,PR0
        32 000760   000010 755000 2                  STA     LEX_SYMBOL+8

             14763    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14763 32 000761   000010 721100                    LXL1    8,,PR0
        32 000762   000044 622011                    EAX2    36,X1
        32 000763   000044 623005                    EAX3    36,AL
        32 000764   000040 100540                    MLR     fill='000'O
        32 000765   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        32 000766   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3

             14764    7     END;

             14766    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

  14766 32 000767   000010 720100                    LXL0    8,,PR0
        32 000770   000044 621010                    EAX1    36,X0
        32 000771   000000 636011                    EAQ     0,X1
        32 000772   000022 732000                    QRS     18
        32 000773   000003 036007                    ADLQ    3,DL
        32 000774   000004 506007                    DIV     4,DL
        32 000775   000172 756000 0                  STQ     INSERT_SIZE+1
        32 000776   000172 631400 0                  EPPR1   INSERT_SIZE+1
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:104  
        32 000777   000175 451400 0                  STP1    INSERT_SIZE+4
        32 001000   000002 236000 33                 LDQ     2
        32 001001   000174 756000 0                  STQ     INSERT_SIZE+3
        32 001002   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 001003   000001 631400 33                 EPPR1   1
        32 001004   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        32 001005   000000 011000                    NOP     0

             14767                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14768    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14770    6                                 );
             14771    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  14771 32 001006   000000 236000 2                  LDQ     LEX_SYMBOL
        32 001007   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14772    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);

  14772 32 001010   000000 236000 33                 LDQ     0
        32 001011   000000 756000 2                  STQ     LEX_SYMBOL

             14773    6     END;

  14773 32 001012   001042 710000 32                 TRA     s:14792

             14775    5     ELSE
             14776    6       DO;

             14777              %GET_BRAND_NEW_TOKEN;
             14778    7       DO;

             14779    7         CALL Z8ES$SCANNER;

  14779 32 001013   000003 631400 33                 EPPR1   3
        32 001014   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 001015   000000 011000                    NOP     0

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:105  
             14780    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;

  14780 32 001016   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001017   001030 601000 32                 TNZ     s:14786

             14781    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;

  14781 32 001020   000003 631400 33                 EPPR1   3
        32 001021   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        32 001022   000000 011000                    NOP     0

             14782    8           CALL Z8ES$SCANNER;

  14782 32 001023   000003 631400 33                 EPPR1   3
        32 001024   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 001025   000000 011000                    NOP     0

             14783    8         END;

  14783 32 001026   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001027   001020 600000 32                 TZE     s:14781

             14784    7       END;

             14786    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL

  14786 32 001030   000003 236000 2                  LDQ     LEX_SYMBOL+3
        32 001031   000000 116000 22                 CMPQ    CURRENT_SYMBOL_LEVEL
        32 001032   001042 600000 32                 TZE     s:14792
        32 001033   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 001034   200000 316003                    CANQ    65536,DU
        32 001035   001042 601000 32                 TNZ     s:14792

             14787    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14788    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);

  14788 32 001036   000005 630400 33                 EPPR0   5
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:106  
        32 001037   000004 631400 33                 EPPR1   4
        32 001040   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        32 001041   000000 011000                    NOP     0

             14789    6     END;

             14790    5   END;

             14792    4            IF LEX_SYMBOL.SIZE = 4 AND

  14792 32 001042   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001043   000004 115007                    CMPA    4,DL
        32 001044   001062 601000 32                 TNZ     s:14809
        32 001045   000011 236000 2                  LDQ     LEX_SYMBOL+9
        32 001046   000004 116000 31                 CMPQ    4
        32 001047   001062 601000 32                 TNZ     s:14809

             14793    4              SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'DATA' THEN
             14794                     %REPLACE_NO_DATA_TOKEN;
             14795    5      DO;

             14796    5        LEX_SYMBOL.LINE = TEMP_LEX_SYMBOL.LINE;

  14796 32 001050   000004 235000 4                  LDA     TEMP_LEX_SYMBOL+4
        32 001051   000004 755000 2                  STA     LEX_SYMBOL+4

             14797    5        LEX_SYMBOL.COLUMN = TEMP_LEX_SYMBOL.COLUMN;

  14797 32 001052   000005 235000 4                  LDA     TEMP_LEX_SYMBOL+5
        32 001053   000005 755000 2                  STA     LEX_SYMBOL+5

             14798    5        LEX_SYMBOL.SIZE = %NO_DATA_SIZE;

  14798 32 001054   000007 235007                    LDA     7,DL
        32 001055   000010 755000 2                  STA     LEX_SYMBOL+8

             14799    5        SUBSTR(LEX_SYMBOL.SYMBOL,0,%NO_DATA_SIZE) = %NO_DATA_TEXT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:107  

  14799 32 001056   040000 100400                    MLR     fill='040'O
        32 001057   000011 000007 31                 ADSC9   9                        cn=0,n=7
        32 001060   000011 000007 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=7

             14800    5      END;

  14800 32 001061   001120 710000 32                 TRA     s:14838

             14802    4            ELSE
             14803    5              DO;

             14804                     %SAVE_TOKEN_ON_THE_QUEUE;
             14805    6      DO;

             14806             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14807                                      TO$   = HEAP$);
             14808    7     DO;

             14809    7       CALL Z8ED$NEW_HEAP (TO$,

  14809 32 001062   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 001063   000047 036007                    ADLQ    39,DL
        32 001064   000004 506007                    DIV     4,DL
        32 001065   000172 756000 0                  STQ     INSERT_SIZE+1
        32 001066   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 001067   000175 450400 0                  STP0    INSERT_SIZE+4
        32 001070   000006 236000 33                 LDQ     6
        32 001071   000174 756000 0                  STQ     INSERT_SIZE+3
        32 001072   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 001073   000001 631400 33                 EPPR1   1
        32 001074   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        32 001075   000000 011000                    NOP     0

             14810                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14811    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14813    7                             );
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:108  
             14814            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14815    8     DO;

             14816    8       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14816 32 001076   000000 470400 21                 LDP0    HEAP$
        32 001077   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001100   000010 755100                    STA     8,,PR0

             14817    8       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14817 32 001101   000010 720100                    LXL0    8,,PR0
        32 001102   000044 621010                    EAX1    36,X0
        32 001103   000010 722000 2                  LXL2    LEX_SYMBOL+8
        32 001104   000044 623012                    EAX3    36,X2
        32 001105   000140 100440                    MLR     fill='000'O
        32 001106   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        32 001107   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

             14818    8     END;

             14820    7     END;

             14822    6        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

  14822 32 001110   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 001111   000000 470400 21                 LDP0    HEAP$
        32 001112   000000 756100                    STQ     0,,PR0

             14823    6        LEX_SYMBOL_QUEUE$ = HEAP$;

  14823 32 001113   000000 236000 21                 LDQ     HEAP$
        32 001114   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14824    6      END;

             14826                     %LOAD_SAVED_TOKEN;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:109  
             14827    6      DO;

             14828    6        LEX_SYMBOL = TEMP_LEX_SYMBOL;

  14828 32 001115   000000 100400                    MLR     fill='000'O
        32 001116   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360
        32 001117   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360

             14829    6      END;

             14831    5              END;

             14832    4          END;

             14833    3     END;

      336    14835
      337    14836          %REPLACE_NOT_ON_EXCEPTION_TOKEN;
             14837    3     DO;

             14838    3       IF LEX_SYMBOL.SIZE = 3 AND

  14838 32 001120   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001121   000003 115007                    CMPA    3,DL
        32 001122   001445 601000 32                 TNZ     s:15001
        32 001123   000011 236000 2                  LDQ     LEX_SYMBOL+9
        32 001124   000013 676000 31                 ERQ     11
        32 001125   000016 376000 33                 ANQ     14
        32 001126   001445 601000 32                 TNZ     s:15001

             14839    3          SUBSTR(LEX_SYMBOL.SYMBOL,0,3) = 'NOT' THEN
             14840    4         DO;

             14841    4           TEMP_LEX_SYMBOL2 = LEX_SYMBOL;

  14841 32 001127   000000 100400                    MLR     fill='000'O
        32 001130   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:110  
        32 001131   000000 000550 5                  ADSC9   TEMP_LEX_SYMBOL2         cn=0,n=360

             14842                %GET_A_TOKEN;
             14843    5   DO;

             14844    5     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN

  14844 32 001132   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 001133   000000 116000 33                 CMPQ    0
        32 001134   001172 600000 32                 TZE     s:14867

             14845          %GET_LEX_SYMBOL_FROM_QUEUE;
             14846    6     DO;

             14847            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14848                                   TO$ = "ADDR(LEX_SYMBOL)");
             14849    7     DO;

             14850    7       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14850 32 001135   000000 470400 27                 LDP0    LEX_SYMBOL_QUEUE$
        32 001136   000010 235100                    LDA     8,,PR0
        32 001137   000010 755000 2                  STA     LEX_SYMBOL+8

             14851    7       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14851 32 001140   000010 720100                    LXL0    8,,PR0
        32 001141   000044 621010                    EAX1    36,X0
        32 001142   000044 622005                    EAX2    36,AL
        32 001143   000040 100540                    MLR     fill='000'O
        32 001144   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        32 001145   000000 000012 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

             14852    7     END;

             14854    6       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:111  
  14854 32 001146   000010 720100                    LXL0    8,,PR0
        32 001147   000044 621010                    EAX1    36,X0
        32 001150   000000 636011                    EAQ     0,X1
        32 001151   000022 732000                    QRS     18
        32 001152   000003 036007                    ADLQ    3,DL
        32 001153   000004 506007                    DIV     4,DL
        32 001154   000172 756000 0                  STQ     INSERT_SIZE+1
        32 001155   000172 631400 0                  EPPR1   INSERT_SIZE+1
        32 001156   000175 451400 0                  STP1    INSERT_SIZE+4
        32 001157   000002 236000 33                 LDQ     2
        32 001160   000174 756000 0                  STQ     INSERT_SIZE+3
        32 001161   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 001162   000001 631400 33                 EPPR1   1
        32 001163   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        32 001164   000000 011000                    NOP     0

             14855                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14856    6     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14858    6                                 );
             14859    6       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  14859 32 001165   000000 236000 2                  LDQ     LEX_SYMBOL
        32 001166   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14860    6       LEX_SYMBOL.NEXT$ = ADDR(NIL);

  14860 32 001167   000000 236000 33                 LDQ     0
        32 001170   000000 756000 2                  STQ     LEX_SYMBOL

             14861    6     END;

  14861 32 001171   001221 710000 32                 TRA     s:14882

             14863    5     ELSE
             14864    6       DO;

             14865              %GET_BRAND_NEW_TOKEN;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:112  
             14866    7       DO;

             14867    7         CALL Z8ES$SCANNER;

  14867 32 001172   000003 631400 33                 EPPR1   3
        32 001173   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 001174   000000 011000                    NOP     0

             14868    8         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;

  14868 32 001175   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001176   001207 601000 32                 TNZ     s:14874

             14869    8           CALL Z8EL$GET_NEXT_SCANNER_LINE;

  14869 32 001177   000003 631400 33                 EPPR1   3
        32 001200   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        32 001201   000000 011000                    NOP     0

             14870    8           CALL Z8ES$SCANNER;

  14870 32 001202   000003 631400 33                 EPPR1   3
        32 001203   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 001204   000000 011000                    NOP     0

             14871    8         END;

  14871 32 001205   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001206   001177 600000 32                 TZE     s:14869

             14872    7       END;

             14874    6         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL

  14874 32 001207   000003 236000 2                  LDQ     LEX_SYMBOL+3
        32 001210   000000 116000 22                 CMPQ    CURRENT_SYMBOL_LEVEL
        32 001211   001221 600000 32                 TZE     s:14882
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:113  
        32 001212   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 001213   200000 316003                    CANQ    65536,DU
        32 001214   001221 601000 32                 TNZ     s:14882

             14875    6              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14876    6           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);

  14876 32 001215   000005 630400 33                 EPPR0   5
        32 001216   000004 631400 33                 EPPR1   4
        32 001217   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        32 001220   000000 011000                    NOP     0

             14877    6     END;

             14878    5   END;

             14880                %REPLACE_ON_EXCEPTION_TOKEN;
             14881    5     DO;

             14882    5       IF LEX_SYMBOL.SIZE = 2 AND

  14882 32 001221   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001222   000002 115007                    CMPA    2,DL
        32 001223   001366 601000 32                 TNZ     s:14962
        32 001224   000011 220000 2                  LDX0    LEX_SYMBOL+9
        32 001225   000014 100000 31                 CMPX0   12
        32 001226   001366 601000 32                 TNZ     s:14962

             14883    5         SUBSTR(LEX_SYMBOL.SYMBOL,0,2) = 'ON' THEN
             14884    6         DO;

             14885                %SAVE_CURRENT_TOKEN;
             14886    7      DO;

             14887    7        TEMP_LEX_SYMBOL = LEX_SYMBOL;

  14887 32 001227   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:114  
        32 001230   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360
        32 001231   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360

             14888    7      END;

             14890                %GET_A_TOKEN;
             14891    7   DO;

             14892    7     IF LEX_SYMBOL_QUEUE$ ~= ADDR(NIL) THEN

  14892 32 001232   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 001233   000000 116000 33                 CMPQ    0
        32 001234   001272 600000 32                 TZE     s:14915

             14893          %GET_LEX_SYMBOL_FROM_QUEUE;
             14894    8     DO;

             14895            %COPY_BASED_LEX_SYMBOL(FROM$=LEX_SYMBOL_QUEUE$,
             14896                                   TO$ = "ADDR(LEX_SYMBOL)");
             14897    9     DO;

             14898    9       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14898 32 001235   000000 470400 27                 LDP0    LEX_SYMBOL_QUEUE$
        32 001236   000010 235100                    LDA     8,,PR0
        32 001237   000010 755000 2                  STA     LEX_SYMBOL+8

             14899    9       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14899 32 001240   000010 721100                    LXL1    8,,PR0
        32 001241   000044 622011                    EAX2    36,X1
        32 001242   000044 623005                    EAX3    36,AL
        32 001243   000040 100540                    MLR     fill='000'O
        32 001244   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
        32 001245   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3

             14900    9     END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:115  

             14902    8       CALL Z8ED$DISPOSE_HEAP (LEX_SYMBOL_QUEUE$,

  14902 32 001246   000010 720100                    LXL0    8,,PR0
        32 001247   000044 621010                    EAX1    36,X0
        32 001250   000000 636011                    EAQ     0,X1
        32 001251   000022 732000                    QRS     18
        32 001252   000003 036007                    ADLQ    3,DL
        32 001253   000004 506007                    DIV     4,DL
        32 001254   000172 756000 0                  STQ     INSERT_SIZE+1
        32 001255   000172 631400 0                  EPPR1   INSERT_SIZE+1
        32 001256   000175 451400 0                  STP1    INSERT_SIZE+4
        32 001257   000002 236000 33                 LDQ     2
        32 001260   000174 756000 0                  STQ     INSERT_SIZE+3
        32 001261   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 001262   000001 631400 33                 EPPR1   1
        32 001263   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        32 001264   000000 011000                    NOP     0

             14903                                       %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX_SYMBOL_QUEUE$);
             14904    8     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14906    8                                 );
             14907    8       LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  14907 32 001265   000000 236000 2                  LDQ     LEX_SYMBOL
        32 001266   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14908    8       LEX_SYMBOL.NEXT$ = ADDR(NIL);

  14908 32 001267   000000 236000 33                 LDQ     0
        32 001270   000000 756000 2                  STQ     LEX_SYMBOL

             14909    8     END;

  14909 32 001271   001321 710000 32                 TRA     s:14928

             14911    7     ELSE
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:116  
             14912    8       DO;

             14913              %GET_BRAND_NEW_TOKEN;
             14914    9       DO;

             14915    9         CALL Z8ES$SCANNER;

  14915 32 001272   000003 631400 33                 EPPR1   3
        32 001273   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 001274   000000 011000                    NOP     0

             14916   10         DO WHILE LEX_SYMBOL.TYPE = %END_OF_LINE;

  14916 32 001275   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001276   001307 601000 32                 TNZ     s:14922

             14917   10           CALL Z8EL$GET_NEXT_SCANNER_LINE;

  14917 32 001277   000003 631400 33                 EPPR1   3
        32 001300   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        32 001301   000000 011000                    NOP     0

             14918   10           CALL Z8ES$SCANNER;

  14918 32 001302   000003 631400 33                 EPPR1   3
        32 001303   000000 701000 xent               TSX1    Z8ES$SCANNER
        32 001304   000000 011000                    NOP     0

             14919   10         END;

  14919 32 001305   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001306   001277 600000 32                 TZE     s:14917

             14920    9       END;

             14922    8         IF LEX_SYMBOL.LEVEL ~= CURRENT_SYMBOL_LEVEL

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:117  
  14922 32 001307   000003 236000 2                  LDQ     LEX_SYMBOL+3
        32 001310   000000 116000 22                 CMPQ    CURRENT_SYMBOL_LEVEL
        32 001311   001321 600000 32                 TZE     s:14928
        32 001312   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 001313   200000 316003                    CANQ    65536,DU
        32 001314   001321 601000 32                 TNZ     s:14928

             14923    8              AND NOT LEX_SYMBOL.B.REPLACED_TOKEN THEN
             14924    8           CALL Z8EL$HANDLE_LEVEL_CHANGE(LEX_SYMBOL.LEVEL);

  14924 32 001315   000005 630400 33                 EPPR0   5
        32 001316   000004 631400 33                 EPPR1   4
        32 001317   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        32 001320   000000 011000                    NOP     0

             14925    8     END;

             14926    7   END;

             14928    6           IF LEX_SYMBOL.SIZE ~= 9 OR

  14928 32 001321   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001322   000011 115007                    CMPA    9,DL
        32 001323   001330 601000 32                 TNZ     s:14936
        32 001324   040000 106400                    CMPC    fill='040'O
        32 001325   000011 000011 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=9
        32 001326   000015 000011 31                 ADSC9   13                       cn=0,n=9
        32 001327   001366 600000 32                 TZE     s:14962

             14929    6             SUBSTR(LEX_SYMBOL.SYMBOL,0,9) ~= 'EXCEPTION' THEN
             14930    7             DO;

             14931                    %SAVE_TOKEN_ON_THE_QUEUE;
             14932    8      DO;

             14933             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14934                                      TO$   = HEAP$);
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:118  
             14935    9     DO;

             14936    9       CALL Z8ED$NEW_HEAP (TO$,

  14936 32 001330   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 001331   000047 036007                    ADLQ    39,DL
        32 001332   000004 506007                    DIV     4,DL
        32 001333   000172 756000 0                  STQ     INSERT_SIZE+1
        32 001334   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 001335   000175 450400 0                  STP0    INSERT_SIZE+4
        32 001336   000006 236000 33                 LDQ     6
        32 001337   000174 756000 0                  STQ     INSERT_SIZE+3
        32 001340   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 001341   000001 631400 33                 EPPR1   1
        32 001342   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        32 001343   000000 011000                    NOP     0

             14937                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14938    9     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14940    9                             );
             14941            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14942   10     DO;

             14943   10       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14943 32 001344   000000 470400 21                 LDP0    HEAP$
        32 001345   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001346   000010 755100                    STA     8,,PR0

             14944   10       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14944 32 001347   000010 720100                    LXL0    8,,PR0
        32 001350   000044 621010                    EAX1    36,X0
        32 001351   000010 722000 2                  LXL2    LEX_SYMBOL+8
        32 001352   000044 623012                    EAX3    36,X2
        32 001353   000140 100440                    MLR     fill='000'O
        32 001354   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:119  
        32 001355   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

             14945   10     END;

             14947    9     END;

             14949    8        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

  14949 32 001356   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 001357   000000 470400 21                 LDP0    HEAP$
        32 001360   000000 756100                    STQ     0,,PR0

             14950    8        LEX_SYMBOL_QUEUE$ = HEAP$;

  14950 32 001361   000000 236000 21                 LDQ     HEAP$
        32 001362   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14951    8      END;

             14953                    %LOAD_SAVED_TOKEN;
             14954    8      DO;

             14955    8        LEX_SYMBOL = TEMP_LEX_SYMBOL;

  14955 32 001363   000000 100400                    MLR     fill='000'O
        32 001364   000000 000550 4                  ADSC9   TEMP_LEX_SYMBOL          cn=0,n=360
        32 001365   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360

             14956    8      END;

             14958    7             END;

             14959    6         END;

             14960    5     END;

             14962    4           IF LEX_SYMBOL.SIZE ~= 9 OR
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:120  

  14962 32 001366   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001367   000011 115007                    CMPA    9,DL
        32 001370   001375 601000 32                 TNZ     s:14970
        32 001371   040000 106400                    CMPC    fill='040'O
        32 001372   000011 000011 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=9
        32 001373   000015 000011 31                 ADSC9   13                       cn=0,n=9
        32 001374   001434 600000 32                 TZE     s:14991

             14963    4              SUBSTR(LEX_SYMBOL.SYMBOL,0,9) ~= 'EXCEPTION' THEN
             14964    5             DO;

             14965                    %SAVE_TOKEN_ON_THE_QUEUE;
             14966    6      DO;

             14967             %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
             14968                                      TO$   = HEAP$);
             14969    7     DO;

             14970    7       CALL Z8ED$NEW_HEAP (TO$,

  14970 32 001375   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 001376   000047 036007                    ADLQ    39,DL
        32 001377   000004 506007                    DIV     4,DL
        32 001400   000172 756000 0                  STQ     INSERT_SIZE+1
        32 001401   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 001402   000175 450400 0                  STP0    INSERT_SIZE+4
        32 001403   000006 236000 33                 LDQ     6
        32 001404   000174 756000 0                  STQ     INSERT_SIZE+3
        32 001405   000174 630400 0                  EPPR0   INSERT_SIZE+3
        32 001406   000001 631400 33                 EPPR1   1
        32 001407   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        32 001410   000000 011000                    NOP     0

             14971                                   %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=FROM$);
             14972    7     ((LENGTHC(S$ -> BASED_LEX_SYMBOL) + 3) / 4)
             14974    7                             );
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:121  
             14975            %COPY_BASED_LEX_SYMBOL(FROM$=FROM$, TO$=TO$);
             14976    8     DO;

             14977    8       TO$ -> BASED_LEX_SYMBOL.SIZE = FROM$ -> BASED_LEX_SYMBOL.SIZE;

  14977 32 001411   000000 470400 21                 LDP0    HEAP$
        32 001412   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001413   000010 755100                    STA     8,,PR0

             14978    8       TO$ -> BASED_LEX_SYMBOL = FROM$ -> BASED_LEX_SYMBOL;

  14978 32 001414   000010 720100                    LXL0    8,,PR0
        32 001415   000044 621010                    EAX1    36,X0
        32 001416   000010 722000 2                  LXL2    LEX_SYMBOL+8
        32 001417   000044 623012                    EAX3    36,X2
        32 001420   000140 100440                    MLR     fill='000'O
        32 001421   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        32 001422   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

             14979    8     END;

             14981    7     END;

             14983    6        HEAP$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

  14983 32 001423   000000 236000 27                 LDQ     LEX_SYMBOL_QUEUE$
        32 001424   000000 470400 21                 LDP0    HEAP$
        32 001425   000000 756100                    STQ     0,,PR0

             14984    6        LEX_SYMBOL_QUEUE$ = HEAP$;

  14984 32 001426   000000 236000 21                 LDQ     HEAP$
        32 001427   000000 756000 27                 STQ     LEX_SYMBOL_QUEUE$

             14985    6      END;

             14987    5               LEX_SYMBOL = TEMP_LEX_SYMBOL2;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:122  

  14987 32 001430   000000 100400                    MLR     fill='000'O
        32 001431   000000 000550 5                  ADSC9   TEMP_LEX_SYMBOL2         cn=0,n=360
        32 001432   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360

             14988    5             END;

  14988 32 001433   001445 710000 32                 TRA     s:15001

             14989    4           ELSE
             14990    5             DO;

             14991    5               LEX_SYMBOL.LINE = TEMP_LEX_SYMBOL2.LINE;

  14991 32 001434   000004 236000 5                  LDQ     TEMP_LEX_SYMBOL2+4
        32 001435   000004 756000 2                  STQ     LEX_SYMBOL+4

             14992    5               LEX_SYMBOL.COLUMN = TEMP_LEX_SYMBOL2.COLUMN;

  14992 32 001436   000005 235000 5                  LDA     TEMP_LEX_SYMBOL2+5
        32 001437   000005 755000 2                  STA     LEX_SYMBOL+5

             14993    5               LEX_SYMBOL.SIZE = 16;

  14993 32 001440   000020 235007                    LDA     16,DL
        32 001441   000010 755000 2                  STA     LEX_SYMBOL+8

             14994    5               SUBSTR(LEX_SYMBOL.SYMBOL,0,16) = 'NOT ON EXCEPTION';

  14994 32 001442   040000 100400                    MLR     fill='040'O
        32 001443   000020 000020 31                 ADSC9   16                       cn=0,n=16
        32 001444   000011 000020 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=16

             14995    5             END;

             14996    4         END;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:123  
             14997    3      END;

      338    14999
      339    15000
      340    15001    2   IF (NOT O1COM.DEBUGGING_MODE)

  15001 32 001445   000026 234000 xsym               SZN     O1COM+22
        32 001446   001452 604000 32                 TMI     s:15005
        32 001447   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 001450   100000 316003                    CANQ    32768,DU
        32 001451   000015 601000 32                 TNZ     NEW_TOKEN

      341    15002    2         AND LEX_SYMBOL.B.DEBUG_TOKEN THEN
      342    15003    2     GOTO NEW_TOKEN;
      343    15004
      344    15005    2   END REPLACED_TOKEN;

  15005 32 001452   000164 221200 0                  LDX1  ! PARSING_PICTURE+2
        32 001453   000001 702211                    TSX2  ! 1,X1

      345    15006        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:124  
      346    15007    1   SCAN_COMMENT_ENTRY: PROC ;

  15007 32 001454   000165 741200 0     SCAN_COMMEN* STX1  ! PARSING_PICTURE+3

      347    15008
      348    15009    2     DCL CONTINUATION_ISN SBIN WORD;
      349    15010
      350    15011    2     CONTINUATION_ISN = CURRENT_BUFFER$ -> FILL_BUFFER.ISN;

  15011 32 001455   000000 470400 7                  LDP0    CURRENT_BUFFER$
        32 001456   000004 235100                    LDA     4,,PR0
        32 001457   000166 755000 0                  STA     CONTINUATION_ISN

      351    15012
      352    15013    2     IGNORE_COPY_REPLACE = TRUE;

  15013 32 001460   400000 236003                    LDQ     -131072,DU
        32 001461   000000 756000 24                 STQ     IGNORE_COPY_REPLACE

      353    15014
      354    15015             /*N* Free_Format -- The following DO is valid for fixed_format
      355    15016                                 and the free_format subset only.
      356    15017             */
      357    15018
      358    15019    3          DO UNTIL LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START

      359    15020    3                    OR
      360    15021    3                   LEX_SYMBOL.TYPE = %END_OF_FILE;
      361    15022
      362    15023    3            CALL REPLACED_TOKEN;

  15023 32 001462   000014 701000 32                 TSX1    REPLACED_TOKEN
        32 001463   000000 011000                    NOP     0

      363    15024
      364    15025    3            IF O1COM.AUTHOR_COMMENT     THEN

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:125  
  15025 32 001464   000114 234000 xsym               SZN     O1COM+76
        32 001465   001502 605000 32                 TPL     s:15037

      365    15026    4             DO;

      366    15027    4                IF LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START OR

  15027 32 001466   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 001467   000121 116000 xsym               CMPQ    O1COM+81
        32 001470   001501 604000 32                 TMI     s:15034
        32 001471   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001472   000001 115007                    CMPA    1,DL
        32 001473   001501 600000 32                 TZE     s:15034

      367    15028    4                    LEX_SYMBOL.TYPE = %END_OF_FILE        THEN   ;
      368    15029    4                  ELSE
      369    15030    5                    DO;

      370    15031    5                      CALL Z8AH$SEARCH_;

  15031 32 001474   000003 631400 33                 EPPR1   3
        32 001475   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 001476   000000 011000                    NOP     0

      371    15032    5                      COMCOM.AUTHOR$ = DNT$;

  15032 32 001477   000000 236000 17                 LDQ     DNT$
        32 001500   000505 756000 xsym               STQ     COMCOM+325

      372    15033    5                    END;

      373    15034    4                O1COM.AUTHOR_COMMENT = %FALSE;

  15034 32 001501   000114 450000 xsym               STZ     O1COM+76

      374    15035    4             END;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:126  
      375    15036
      376    15037    3            IF O1COM.ID_DIV_COUNT = 0  AND O1COM.INSTAL_ON THEN

  15037 32 001502   000116 235000 xsym               LDA     O1COM+78
        32 001503   001572 601000 32                 TNZ     s:15083
        32 001504   000117 234000 xsym               SZN     O1COM+79
        32 001505   001572 605000 32                 TPL     s:15083

      377    15038    4              DO;

      378    15039    4                IF LEX_SYMBOL.COLUMN >= O1COM.AREA_B_COLUMN_START AND

  15039 32 001506   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 001507   000121 116000 xsym               CMPQ    O1COM+81
        32 001510   001570 604000 32                 TMI     s:15080
        32 001511   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001512   000003 115007                    CMPA    3,DL
        32 001513   001516 600000 32                 TZE     s:15043
        32 001514   000004 115007                    CMPA    4,DL
        32 001515   001570 601000 32                 TNZ     s:15080

      379    15040    4                  (LEX_SYMBOL.TYPE = %ALPHA_LITERAL OR
      380    15041    4                   LEX_SYMBOL.TYPE = %SINGLE_QUOTE) THEN
      381    15042    5                  DO;

      382    15043    5                    CALL Z8AH$SEARCH_;

  15043 32 001516   000003 631400 33                 EPPR1   3
        32 001517   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 001520   000000 011000                    NOP     0

      383    15044
      384    15045                         %NEW_HEAP (@POINTER = HEAP$$);
             15046    6     DO;

             15047    6       CALL Z8ED$NEW_HEAP (@POINTER, @SIZE);

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:127  
  15047 32 001521   000020 630400 33                 EPPR0   16
        32 001522   000001 631400 33                 EPPR1   1
        32 001523   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        32 001524   000000 011000                    NOP     0

             15048    6     END;

      385    15050
      386    15051                         %INIT_LX_TERMINAL (@POINTER = HEAP$$,
      387    15052                                            @DNT$    = DNT$,
      388    15053                                            @SYMBOL  = LEX_SYMBOL.TYPE,
      389    15054                                            @LINE    = LEX_SYMBOL.LINE,
      390    15055                                            @COLUMN  = LEX_SYMBOL.COLUMN);
             15056    6     DO;

             15057    6       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;

  15057 32 001525   000000 220003                    LDX0    0,DU
        32 001526   000026 470400 0                  LDP0    HEAP$$
        32 001527   000000 740100                    STX0    0,,PR0

             15058    6       @POINTER -> LX_TERMINAL.B      = '0'B;

  15058 32 001530   000000 221003                    LDX1    0,DU
        32 001531   000026 470400 0                  LDP0    HEAP$$
        32 001532   000000 441100                    SXL1    0,,PR0

             15059            %IF (TEXTCHAR(@BERROR) ~= '');
             15061            %ENDIF;
             15062    6       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;

  15062 32 001533   000015 235007                    LDA     13,DL
        32 001534   000026 470400 0                  LDP0    HEAP$$
        32 001535   000004 755100                    STA     4,,PR0

             15063            %IF (TEXTCHAR(@LA_ITEM) = '');
             15064    6         @POINTER -> LX_TERMINAL.LINK   = @LINK;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:128  

  15064 32 001536   000000 236000 33                 LDQ     0
        32 001537   000026 470400 0                  LDP0    HEAP$$
        32 001540   000007 756100                    STQ     7,,PR0

             15065            %ENDIF;
             15066    6       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;

  15066 32 001541   000026 470400 0                  LDP0    HEAP$$
        32 001542   000001 756100                    STQ     1,,PR0

             15067    6       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;

  15067 32 001543   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001544   000026 470400 0                  LDP0    HEAP$$
        32 001545   000003 755100                    STA     3,,PR0

             15068    6       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;

  15068 32 001546   000000 236000 17                 LDQ     DNT$
        32 001547   000026 470400 0                  LDP0    HEAP$$
        32 001550   000002 756100                    STQ     2,,PR0

             15069    6       @POINTER -> LX_TERMINAL.LINE   = @LINE;

  15069 32 001551   000004 235000 2                  LDA     LEX_SYMBOL+4
        32 001552   000026 470400 0                  LDP0    HEAP$$
        32 001553   000005 755100                    STA     5,,PR0

             15070    6       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;

  15070 32 001554   000005 235000 2                  LDA     LEX_SYMBOL+5
        32 001555   000026 470400 0                  LDP0    HEAP$$
        32 001556   000006 755100                    STA     6,,PR0

             15071    6     END;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:129  
      391    15073
      392    15074    5                    IF COMCOM.INSTALLATION$ ~= ADDR(NIL) THEN

  15074 32 001557   000500 236000 xsym               LDQ     COMCOM+320
        32 001560   000000 116000 33                 CMPQ    0
        32 001561   001566 600000 32                 TZE     s:15077

      393    15075    5                      CALL Z8ED$DISPOSE_ABSSYN_TREE (COMCOM.INSTALLATION$);

  15075 32 001562   000022 630400 33                 EPPR0   18
        32 001563   000004 631400 33                 EPPR1   4
        32 001564   000000 701000 xent               TSX1    Z8ED$DISPOSE_ABSSYN_TREE
        32 001565   000000 011000                    NOP     0

      394    15076
      395    15077    5                    COMCOM.INSTALLATION$ = HEAP$$;

  15077 32 001566   000026 236000 0                  LDQ     HEAP$$
        32 001567   000500 756000 xsym               STQ     COMCOM+320

      396    15078
      397    15079    5                  END;

      398    15080    4                O1COM.INSTAL_ON = FALSE;

  15080 32 001570   000023 236000 33                 LDQ     19
        32 001571   000117 356000 xsym               ANSQ    O1COM+79

      399    15081    4              END;

      400    15082
      401    15083    3            IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.CONTINUATION THEN

  15083 32 001572   000000 470400 7                  LDP0    CURRENT_BUFFER$
        32 001573   000011 234100                    SZN     9,,PR0
        32 001574   001621 605000 32                 TPL     s:15093

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:130  
      402    15084    3              IF CONTINUATION_ISN ~=

  15084 32 001575   000166 236000 0                  LDQ     CONTINUATION_ISN
        32 001576   000004 116100                    CMPQ    4,,PR0
        32 001577   001621 600000 32                 TZE     s:15093

      403    15085    3                   CURRENT_BUFFER$ -> FILL_BUFFER.ISN THEN
      404    15086    4                DO;

      405    15087    4                  CALL Z8AE$ERROR (%E$ERR_COMMENT_ENTRY_CONTINUE,

  15087 32 001600   000122 235000 xsym               LDA     O1COM+82
        32 001601   000001 135007                    SBLA    1,DL
        32 001602   000172 755000 0                  STA     INSERT_SIZE+1
        32 001603   000172 631400 0                  EPPR1   INSERT_SIZE+1
        32 001604   000175 451400 0                  STP1    INSERT_SIZE+4
        32 001605   000000 236000 7                  LDQ     CURRENT_BUFFER$
        32 001606   000004 036003                    ADLQ    4,DU
        32 001607   000174 756000 0                  STQ     INSERT_SIZE+3
        32 001610   000025 236000 33                 LDQ     21
        32 001611   000173 756000 0                  STQ     INSERT_SIZE+2
        32 001612   000173 630400 0                  EPPR0   INSERT_SIZE+2
        32 001613   000011 631400 33                 EPPR1   9
        32 001614   000000 701000 xent               TSX1    Z8AE$ERROR
        32 001615   000000 011000                    NOP     0

      406    15088    4                           CURRENT_BUFFER$ -> FILL_BUFFER.ISN,
      407    15089    4                           O1COM.AREA_A_COLUMN_START - 1);
      408    15090    4                  CONTINUATION_ISN = CURRENT_BUFFER$ -> FILL_BUFFER.ISN;

  15090 32 001616   000000 470400 7                  LDP0    CURRENT_BUFFER$
        32 001617   000004 235100                    LDA     4,,PR0
        32 001620   000166 755000 0                  STA     CONTINUATION_ISN

      409    15091    4                END;

      410    15092
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:131  
      411    15093    3          END ;

  15093 32 001621   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 001622   000121 116000 xsym               CMPQ    O1COM+81
        32 001623   001627 604000 32                 TMI     s:15095
        32 001624   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001625   000001 115007                    CMPA    1,DL
        32 001626   001462 601000 32                 TNZ     s:15023

      412    15094
      413    15095    2     IGNORE_COPY_REPLACE = FALSE;

  15095 32 001627   000000 450000 24                 STZ     IGNORE_COPY_REPLACE

      414    15096
      415    15097    2   END SCAN_COMMENT_ENTRY ;

  15097 32 001630   000165 221200 0                  LDX1  ! PARSING_PICTURE+3
        32 001631   000001 702211                    TSX2  ! 1,X1

      416    15098        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:132  
      417    15099        %MACRO CHECK_REDECL_OF_RESERVED_WORD;
      418    15100          DO;
      419    15101
      420    15102               IF O1COM.RECORD_DCL THEN
      421    15103                 DO;
      422    15104
      423    15105        /*V*
      424    15106            RESERVED_WRD_DCL_CHECK -- If the item is a reserved word and we are in
      425    15107                                      the process of a declaration the reserved word
      426    15108                                      bit is turned off in the DNT.  The item is changed
      427    15109                                      to a user word so that a person can declare a
      428    15110                                      reserved word and use that data name in the
      429    15111                                      program.  He may not use it as a reserved
      430    15112                                      word though.
      431    15113
      432    15114                                      This was done due to the fact that there are
      433    15115                                      new reserved words in COBOL85 in addition to
      434    15116                                      to the many before.
      435    15117        */
      436    15118
      437    15119                   IF DNT$->DNT.B.RW AND O1COM.PARSE_ERROR_COUNT = 0 THEN
      438    15120                     DO CASE (DNT$ -> DNT.RW_NO);
      439    15121
      440    15122                       CASE(ELSE);
      441    15123
      442    15124                         CALL Z8AE$ERROR (%E$RW_USED_AS_DATA_NAME,
      443    15125                                          LEX_SYMBOL.LINE,
      444    15126                                          LEX_SYMBOL.COLUMN,
      445    15127                                          DNT$);
      446    15128                         /* Create new DNT for non-reserved word since reserved
      447    15129                               word is in constant storage */
      448    15130                         TDNT$ = DNT$;
      449    15131                         %NEW_DNT(@SIZE = LEX_SYMBOL.SIZE,
      450    15132                                     @NAME = LEX_SYMBOL.SYMBOL,
      451    15133                                     @ST$ = TDNT$ -> DNT.ST$,
      452    15134                                     @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");
      453    15135                         DNT$ -> DNT.ATTR = TDNT$ -> DNT.ATTR;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:133  
      454    15136                         DNT$ -> DNT.B.USER_WORD = TRUE;
      455    15137                         DNT$ -> DNT.B.RW = FALSE;
      456    15138                         DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;
      457    15139
      458    15140                       CASE (%RSV_WRD_FILLER,  %RSV_WRD_PICTURE, %RSV_WRD_USAGE,
      459    15141                             %RSV_WRD_SIGN,    %RSV_WRD_LEADING, %RSV_WRD_TRAILING,
      460    15142                             %RSV_WRD_DISPLAY, %RSV_WRD_JUSTIFIED, %RSV_WRD_BLANK,
      461    15143                             %RSV_WRD_SOURCE,     %RSV_WRD_LINE,    %RSV_WRD_COLUMN,
      462    15144                             %RSV_WRD_VALUE,   %RSV_WRD_VALUES,  %RSV_WRD_SUM,
      463    15145                             %RSV_WRD_GROUP,   %RSV_WRD_NEXT,    %RSV_WRD_TYPE,
      464    15146                             %RSV_WRD_REDEFINES, %RSV_WRD_IS,    %RSV_WRD_EXTERNAL,
      465    15147                             %RSV_WRD_GLOBAL,  %RSV_WRD_COMP,    %RSV_WRD_INDEX,
      466    15148                             %RSV_WRD_OCCURS,  %RSV_WRD_ASCENDING,  %RSV_WRD_DESCENDING,
      467    15149                             %RSV_WRD_INDEXED,  %RSV_WRD_SYNCHRONIZED, %RSV_WRD_RENAMES,
      468    15150                             %RSV_WRD_COMP_1,  %RSV_WRD_COMP_2,  %RSV_WRD_COMP_3,
      469    15151                             %RSV_WRD_COMP_4,  %RSV_WRD_COMP_5,  %RSV_WRD_COMP_6,
      470    15152                             %RSV_WRD_COMP_7,  %RSV_WRD_COMP_8,  %RSV_WRD_COMP_11,
      471    15153                             %RSV_WRD_COMP_12, %RSV_WRD_COMP_13, %RSV_WRD_COMP_14,
      472    15154                             %RSV_WRD_DB_KEY, %RSV_WRD_POINTER);
      473    15155                        ;  /* do nothing */
      474    15156                     END;
      475    15157
      476    15158                   O1COM.RECORD_DCL = '0'B;
      477    15159                 END;
      478    15160
      479    15161          END;
      480    15162        %MEND;
      481    15163        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:134  
      482    15164        %MACRO PROCESS_RESERVED_WORD;
      483    15165                 DO ;
      484    15166
      485    15167        /*V*
      486    15168            RESERVED_WORD -- If we have encountered a reserved word then the symbol
      487    15169                             field in the stack is assigned the reserved word number.
      488    15170                             If we see the start of a picture string (PIC or PICTURE)
      489    15171                             then we set the state symbolizing the start of a picture
      490    15172                             string.
      491    15173
      492    15174        */
      493    15175
      494    15176                   IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START
      495    15177                      /*N* Free_Format --  AND NOT COMCOM.OB.FORMAT */
      496    15178                       AND O1COM.PD_FLAG
      497    15179                       AND NOT DNT$ -> DNT.B.MUST_AREA_A
      498    15180                       AND NOT DNT$ -> DNT.B.ACCEPT_AREA_A THEN
      499    15181                     CALL Z8AE$ERROR(%E$AREA_A_ERROR,
      500    15182                                     O1COM.LA_STK.LINE(O1COM.LA_PUT),
      501    15183                                     O1COM.LA_STK.COLUMN(O1COM.LA_PUT),
      502    15184                                     DNT$);
      503    15185
      504    15186                   IF DNT$ -> DNT.B.MUST_AREA_A
      505    15187                   /*N* Free_Format -- AND NOT COMCOM.OB.FORMAT */
      506    15188                   AND O1COM.LA_STK.COLUMN(O1COM.LA_PUT) >= O1COM.AREA_B_COLUMN_START THEN
      507    15189                     CALL Z8AE$ERROR (%E$MUST_BE_IN_AREA_A,
      508    15190                                      O1COM.LA_STK.LINE (O1COM.LA_PUT),
      509    15191                                      O1COM.LA_STK.COLUMN (O1COM.LA_PUT),
      510    15192                                      DNT$);
      511    15193
      512    15194                   O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = DNT$->DNT.RW_NO;
      513    15195
      514    15196                   DO CASE(O1COM.LA_STK.SYMBOL(O1COM.LA_PUT)) ;
      515    15197
      516    15198                     CASE( %RSV_WRD_DATE_COMPILED,
      517    15199                         %RSV_WRD_DATE_WRITTEN,
      518    15200                         %RSV_WRD_SECURITY);
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:135  
      519    15201
      520    15202                       LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
      521    15203
      522    15204                     CASE(%RSV_WRD_AUTHOR);
      523    15205
      524    15206                            LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
      525    15207                            O1COM.AUTHOR_COMMENT = %TRUE;
      526    15208
      527    15209                     CASE(%RSV_WRD_INSTALLATION);
      528    15210
      529    15211                            LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;
      530    15212                            O1COM.INSTAL_ON = %TRUE;
      531    15213
      532    15214                     CASE(%RSV_WRD_PICTURE) ;
      533    15215
      534    15216                       LEX_STATE = %LS_PICTURE_OR_IS;
      535    15217
      536    15218                     CASE(%RSV_WRD_ACCEPT,    %RSV_WRD_ADD,      %RSV_WRD_ALTER,
      537    15219                          %RSV_WRD_CALL,      %RSV_WRD_CANCEL,   %RSV_WRD_CLOSE,
      538    15220                          %RSV_WRD_COMPUTE,   %RSV_WRD_CONTINUE, %RSV_WRD_DELETE,
      539    15221                          %RSV_WRD_DISABLE,   %RSV_WRD_DIVIDE,   %RSV_WRD_ENABLE,
      540    15222                          %RSV_WRD_EVALUATE,  %RSV_WRD_EXAMINE,  %RSV_WRD_EXIT,
      541    15223                          %RSV_WRD_GO,        %RSV_WRD_GENERATE, %RSV_WRD_IF,
      542    15224                          %RSV_WRD_INITIATE,  %RSV_WRD_INITIALIZE,%RSV_WRD_INSPECT,
      543    15225                          %RSV_WRD_MERGE,     %RSV_WRD_MOVE,     %RSV_WRD_MULTIPLY,
      544    15226                          %RSV_WRD_OPEN,      %RSV_WRD_PERFORM,  %RSV_WRD_PURGE,
      545    15227                          %RSV_WRD_READ,      %RSV_WRD_RECEIVE,  %RSV_WRD_RELEASE,
      546    15228                          %RSV_WRD_RETURN,    %RSV_WRD_REWRITE,  %RSV_WRD_SEND,
      547    15229                          %RSV_WRD_SEARCH,    %RSV_WRD_START,    %RSV_WRD_SET,
      548    15230                          %RSV_WRD_STRING,    %RSV_WRD_STOP,     %RSV_WRD_SUBTRACT,
      549    15231                          %RSV_WRD_SUPPRESS,  %RSV_WRD_TERMINATE,%RSV_WRD_UNSTRING,
      550    15232                          %RSV_WRD_WRITE,
      551    15233                          %RSV_WRD_CONNECT,   %RSV_WRD_DISCONNECT,%RSV_WRD_ERASE,
      552    15234                          %RSV_WRD_FIND,      %RSV_WRD_FINISH,   %RSV_WRD_GET,
      553    15235                          %RSV_WRD_MODIFY,    %RSV_WRD_PRECALCULATE,
      554    15236                          %RSV_WRD_READY,    %RSV_WRD_STORE);
      555    15237
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:136  
      556    15238                       %SAVE_IMPERATIVE_STMT_RSV_WRD ;
      557    15239
      558    15240                     CASE(%RSV_WRD_QUOTES,    %RSV_WRD_LOW_VALUES,
      559    15241                          %RSV_WRD_SPACES,    %RSV_WRD_ZEROES,     %RSV_WRD_HIGH_VALUES);
      560    15242
      561    15243                       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;
      562    15244
      563    15245
      564    15246
      565    15247                   END ;
      566    15248
      567    15249                   IF NOT LEX_SYMBOL.B.CONTINUED_TOKEN THEN
      568    15250                     SAVED_CONT_FLAG = FALSE;
      569    15251
      570    15252                 END ;
      571    15253        %MEND;
      572    15254        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:137  
      573    15255        %MACRO PROCESS_USER_WORD;
      574    15256                 DO;
      575    15257                   /* for user word */
      576    15258
      577    15259                   DNT$ -> DNT.B.USER_WORD = TRUE;
      578    15260
      579    15261                   /* Check to make sure userword does not end in dash */
      580    15262                   IF SUBSTR(LEX_SYMBOL.SYMBOL,
      581    15263                             LEX_SYMBOL.SIZE - 1,
      582    15264                             1) = '-' THEN
      583    15265                     DO;
      584    15266                       CALL Z8AE$ERROR (%E$USERWORD_END_DASH_ERROR,
      585    15267                                        LEX_SYMBOL.LINE,
      586    15268                                        LEX_SYMBOL.COLUMN);
      587    15269                     END;
      588    15270
      589    15271                   /* Check to make sure userword <= 30 characters */
      590    15272                   IF LEX_SYMBOL.SIZE > %USER_WORD_MAX_SIZE
      591    15273                           AND NOT O1COM.PD_FLAG THEN
      592    15274                     DO;
      593    15275                       CALL Z8AE$ERROR (%E$USERWORD_TOO_LONG,
      594    15276                                        LEX_SYMBOL.LINE,
      595    15277                                        LEX_SYMBOL.COLUMN);
      596    15278                       LEX_SYMBOL.SIZE = 30;
      597    15279                       DNT$ -> DNT.TEXT.LENGTH = 30;
      598    15280                     END;
      599    15281
      600    15282                   /* Check for at least one letter in userword */
      601    15283
      602    15284              /* Check was disabled because paragraph names do not have to
      603    15285                    contain letters in the name.  Therefore, the check must
      604    15286                    either be:
      605    15287
      606    15288                       1) done after the parse to differentiate between
      607    15289                            paragraph names and data names.
      608    15290
      609    15291                       2) Change user word that contain no letters to be
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:138  
      610    15292                            paragraph names
      611    15293
      612    15294                       3) Disabled completely.
      613    15295                   CALL SEARCH (CHAR_COLUMN,
      614    15296                                CHAR_CLASS,
      615    15297                                LETTER_SEARCH_TABLE,
      616    15298                                SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE));
      617    15299                   IF CHAR_CLASS = %END_OF_LINE THEN
      618    15300                     DO;
      619    15301                       CALL Z8AE$ERROR (%E$NO_LETTER_USERWORD,
      620    15302                                        LEX_SYMBOL.LINE,
      621    15303                                        LEX_SYMBOL.COLUMN);
      622    15304                     END;
      623    15305
      624    15306              */
      625    15307                   /* Check for no $ or _ if ANSI option */
      626    15308                   IF COMCOM.OB.FIPS.LEVEL > 0 THEN
      627    15309                     DO;
      628    15310                       CALL SEARCH (CHAR_COLUMN,
      629    15311                                    CHAR_CLASS,
      630    15312                                    ANSI_USERWORD_SCAN_TABLE,
      631    15313                                    SUBSTR(LEX_SYMBOL.SYMBOL,
      632    15314                                           0,
      633    15315                                           LEX_SYMBOL.SIZE));
      634    15316                       IF CHAR_CLASS ~= %END_OF_LINE THEN
      635    15317                         CALL Z8AE$ERROR (%E$USERWORD_ANSI_ERROR,
      636    15318                                          LEX_SYMBOL.LINE,
      637    15319                                          LEX_SYMBOL.COLUMN);
      638    15320                     END;
      639    15321                   IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START THEN
      640    15322                     DO;
      641    15323                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
      642    15324                         IF O1COM.PD_FLAG THEN
      643    15325                           O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_DEF;
      644    15326                         ELSE
      645    15327                           O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;
      646    15328                     END;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:139  
      647    15329                   ELSE
      648    15330                     IF (O1COM.LA_STK.ST$(O1COM.LA_PUT) ~= ADDR(NIL))
      649    15331                     AND ((O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %PARA
      650    15332                              OR
      651    15333                          O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %SECTION)
      652    15334           AND O1COM.LA_STK.ST$(O1COM.LA_PUT) -> VARIABLE.PROC$ = O1COM.CURRENT_PROC$) THEN
      653    15335                       O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_REF;
      654    15336                     ELSE
      655    15337                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
      656    15338                         O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;
      657    15339
      658    15340                     /*N* Free_Format --
      659    15341                       ELSE
      660    15342                         O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME_OR_PARA;
      661    15343                     */
      662    15344
      663    15345
      664    15346                   IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) ~= ADDR(NIL) THEN
      665    15347                     IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> ST.ID = %SYM_CHAR THEN
      666    15348        CHECK_SYM_CHAR: DO;
      667    15349                          PROC$$ = O1COM.CURRENT_PROC$;
      668    15350                          DO WHILE (O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> VARIABLE.PROC$ ~=
      669    15351                              PROC$$);
      670    15352                            PROC$$ = PROC$$ -> PROC_.FATHER;
      671    15353                            IF PROC$$ = ADDR(NIL) THEN
      672    15354                              EXIT CHECK_SYM_CHAR;
      673    15355                          END; /* WHILE */
      674    15356                          O1COM.LA_STK.B.ALL  (O1COM.LA_PUT) = TRUE;
      675    15357                          O1COM.LA_STK.SYMBOL (O1COM.LA_PUT) = %ALPHA_LITERAL;
      676    15358                        END; /* CHECK_SYM_CHAR */
      677    15359
      678    15360                   SAVED_CONT_FLAG = FALSE;
      679    15361
      680    15362                  END;
      681    15363        %MEND;
      682    15364        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:140  
      683    15365    1   PROCESS_SYMBOL : PROC;

  15365 32 001632   000167 741200 0     PROCESS_SYM* STX1  ! CONTINUATION_ISN+1

      684    15366
      685    15367    2   IF LEX_SYMBOL.B.CONTINUED_TOKEN THEN

  15367 32 001633   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 001634   040000 316003                    CANQ    16384,DU
        32 001635   001640 600000 32                 TZE     s:15369

      686    15368    2     SAVED_CONT_FLAG = TRUE;

  15368 32 001636   400000 236003                    LDQ     -131072,DU
        32 001637   000022 756000 0                  STQ     SAVED_CONT_FLAG

      687    15369    2   O1COM.LA_STK.B.HIGH_LEV(O1COM.LA_PUT) = SAVED_CONT_FLAG;

  15369 32 001640   000132 235000 xsym               LDA     O1COM+90
        32 001641   000003 735000                    ALS     3
        32 001642   000022 236000 0                  LDQ     SAVED_CONT_FLAG
        32 001643   000030 772000                    QRL     24
        32 001644   000237 676005 xsym               ERQ     O1COM+159,AL
        32 001645   004000 376007                    ANQ     2048,DL
        32 001646   000237 656005 xsym               ERSQ    O1COM+159,AL

      688    15370
      689    15371    3   DO CASE(LEX_SYMBOL.TYPE);

  15371 32 001647   000001 235000 2                  LDA     LEX_SYMBOL+1
        32 001650   000041 115007                    CMPA    33,DL
        32 001651   001653 602005 32                 TNC     s:15371+4,AL
        32 001652   004463 710000 32                 TRA     s:15810
        32 001653   004463 710000 32                 TRA     s:15810
        32 001654   004473 710000 32                 TRA     s:15818
        32 001655   004463 710000 32                 TRA     s:15810
        32 001656   001742 710000 32                 TRA     s:15401
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:141  
        32 001657   001742 710000 32                 TRA     s:15401
        32 001660   002166 710000 32                 TRA     s:15510
        32 001661   004473 710000 32                 TRA     s:15818
        32 001662   004473 710000 32                 TRA     s:15818
        32 001663   004473 710000 32                 TRA     s:15818
        32 001664   004473 710000 32                 TRA     s:15818
        32 001665   004473 710000 32                 TRA     s:15818
        32 001666   004473 710000 32                 TRA     s:15818
        32 001667   001732 710000 32                 TRA     s:15392
        32 001670   004473 710000 32                 TRA     s:15818
        32 001671   004473 710000 32                 TRA     s:15818
        32 001672   004473 710000 32                 TRA     s:15818
        32 001673   004473 710000 32                 TRA     s:15818
        32 001674   004473 710000 32                 TRA     s:15818
        32 001675   004473 710000 32                 TRA     s:15818
        32 001676   004473 710000 32                 TRA     s:15818
        32 001677   004473 710000 32                 TRA     s:15818
        32 001700   002002 710000 32                 TRA     s:15420
        32 001701   002055 710000 32                 TRA     s:15454
        32 001702   004463 710000 32                 TRA     s:15810
        32 001703   004463 710000 32                 TRA     s:15810
        32 001704   004463 710000 32                 TRA     s:15810
        32 001705   004463 710000 32                 TRA     s:15810
        32 001706   001714 710000 32                 TRA     s:15385
        32 001707   004463 710000 32                 TRA     s:15810
        32 001710   004463 710000 32                 TRA     s:15810
        32 001711   004463 710000 32                 TRA     s:15810
        32 001712   004463 710000 32                 TRA     s:15810
        32 001713   001714 710000 32                 TRA     s:15385

      690    15372
      691    15373    3     CASE(%LEFT_PAREN,  %RIGHT_PAREN,   %STAR,

      692    15374    3          %STAR_STAR,   %PLUS,          %MINUS,
      693    15375    3                        %SLASH,         %COLON,
      694    15376    3          %LESS_THAN,   %GREATER_THAN,  %EQUAL,
      695    15377    3          %LESS_THAN_OR_EQUAL, %GREATER_THAN_OR_EQUAL,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:142  
      696    15378    3          %UP_ARROW,    %END_OF_FILE);
      697    15379
      698    15380            /* These symbols require no special handling */
      699    15381    3       ;
      700    15382
      701    15383    3     CASE(%ILLEGAL_SYMBOL, %PSEUDO);

      702    15384
      703    15385    3       O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %ILLEGAL_SYMBOL;

  15385 32 001714   000132 236000 xsym               LDQ     O1COM+90
        32 001715   000003 736000                    QLS     3
        32 001716   000033 235007                    LDA     27,DL
        32 001717   000242 755006 xsym               STA     O1COM+162,QL

      704    15386    3       IF SEARCH_REQUIRED THEN

  15386 32 001720   000000 234000 29                 SZN     SEARCH_REQUIRED
        32 001721   001725 605000 32                 TPL     s:15388

      705    15387    3         CALL Z8AH$SEARCH_;

  15387 32 001722   000003 631400 33                 EPPR1   3
        32 001723   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 001724   000000 011000                    NOP     0

      706    15388    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;

  15388 32 001725   000132 235000 xsym               LDA     O1COM+90
        32 001726   000003 735000                    ALS     3
        32 001727   000000 236000 17                 LDQ     DNT$
        32 001730   000241 756005 xsym               STQ     O1COM+161,AL
        32 001731   004473 710000 32                 TRA     s:15818

      707    15389
      708    15390    3     CASE(%PERIOD);

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:143  
      709    15391
      710    15392    3       IF LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY THEN

  15392 32 001732   000000 236000 30                 LDQ     LEX_STATE
        32 001733   000001 116007                    CMPQ    1,DL
        32 001734   001740 601000 32                 TNZ     s:15397

      711    15393    4         DO;

      712    15394    4           LEX_STATE = %LS_COMMENT_ENTRY;

  15394 32 001735   000002 235007                    LDA     2,DL
        32 001736   000000 755000 30                 STA     LEX_STATE

      713    15395    4         END;

  15395 32 001737   004473 710000 32                 TRA     s:15818

      714    15396    3       ELSE
      715    15397    3         SAVED_CONT_FLAG = FALSE;

  15397 32 001740   000022 450000 0                  STZ     SAVED_CONT_FLAG
        32 001741   004473 710000 32                 TRA     s:15818

      716    15398
      717    15399    3     CASE(%ALPHA_LITERAL, %SINGLE_QUOTE);

      718    15400
      719    15401    3       IF SEARCH_REQUIRED THEN

  15401 32 001742   000000 234000 29                 SZN     SEARCH_REQUIRED
        32 001743   001747 605000 32                 TPL     s:15404

      720    15402    3         CALL Z8AH$SEARCH_;

  15402 32 001744   000003 631400 33                 EPPR1   3
        32 001745   000000 701000 xent               TSX1    Z8AH$SEARCH_
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:144  
        32 001746   000000 011000                    NOP     0

      721    15403            /* Check for null string */
      722    15404    3       IF LEX_SYMBOL.SIZE <= 2 THEN

  15404 32 001747   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 001750   000002 115007                    CMPA    2,DL
        32 001751   001766 605400 32                 TPNZ    s:15414

      723    15405    4         DO;

      724    15406    4           CALL Z8AE$ERROR(%E$NULL_QUOTE_STRING,

  15406 32 001752   000027 630400 33                 EPPR0   23
        32 001753   000011 631400 33                 EPPR1   9
        32 001754   000000 701000 xent               TSX1    Z8AE$ERROR
        32 001755   000000 011000                    NOP     0

      725    15407    4                           LEX_SYMBOL.LINE,
      726    15408    4                           LEX_SYMBOL.COLUMN);
      727    15409                /* "NULL QUOTE STRING ILLEGAL; A SPACE HAS BEEN INSERTED." */
      728    15410    4           LEX_SYMBOL.SIZE = 3;

  15410 32 001756   000003 235007                    LDA     3,DL
        32 001757   000010 755000 2                  STA     LEX_SYMBOL+8

      729    15411    4           LEX_SYMBOL.SYMBOL = '" "';

  15411 32 001760   040000 100400                    MLR     fill='040'O
        32 001761   000024 000003 31                 ADSC9   20                       cn=0,n=3
        32 001762   000011 000504 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=324

      730    15412    4           CALL Z8AH$SEARCH_;

  15412 32 001763   000003 631400 33                 EPPR1   3
        32 001764   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 001765   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:145  

      731    15413    4         END;

      732    15414    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;

  15414 32 001766   000132 235000 xsym               LDA     O1COM+90
        32 001767   000003 735000                    ALS     3
        32 001770   000000 236000 17                 LDQ     DNT$
        32 001771   000241 756005 xsym               STQ     O1COM+161,AL

      733    15415    3       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;

  15415 32 001772   000132 235000 xsym               LDA     O1COM+90
        32 001773   000003 735000                    ALS     3
        32 001774   000015 236007                    LDQ     13,DL
        32 001775   000243 756005 xsym               STQ     O1COM+163,AL

      734    15416    3       DNT$ -> DNT.B.ALPHA_LITERAL = TRUE;

  15416 32 001776   000000 470400 17                 LDP0    DNT$
        32 001777   004000 236003                    LDQ     2048,DU
        32 002000   000003 256100                    ORSQ    3,,PR0
        32 002001   004473 710000 32                 TRA     s:15818

      735    15417
      736    15418    3     CASE(%NUMBER);

      737    15419
      738    15420    3       IF SEARCH_REQUIRED THEN

  15420 32 002002   000000 234000 29                 SZN     SEARCH_REQUIRED
        32 002003   002007 605000 32                 TPL     s:15429

      739    15421    3         CALL Z8AH$SEARCH_;

  15421 32 002004   000003 631400 33                 EPPR1   3
        32 002005   000000 701000 xent               TSX1    Z8AH$SEARCH_
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:146  
        32 002006   000000 011000                    NOP     0

      740    15422
      741    15423          /*N* Free_Format --
      742    15424            IF COMCOM.OB.FORMAT THEN
      743    15425              O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NUMBER_OR_PARAGRAPH;
      744    15426            ELSE
      745    15427          */
      746    15428
      747    15429    3         IF LEX_SYMBOL.COLUMN < O1COM.AREA_B_COLUMN_START THEN

  15429 32 002007   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 002010   000121 116000 xsym               CMPQ    O1COM+81
        32 002011   002016 605000 32                 TPL     s:15431

      748    15430    3           O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NUMBER_OR_PARAGRAPH;

  15430 32 002012   000132 235000 xsym               LDA     O1COM+90
        32 002013   000003 735000                    ALS     3
        32 002014   000002 236007                    LDQ     2,DL
        32 002015   000242 756005 xsym               STQ     O1COM+162,AL

      749    15431    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;

  15431 32 002016   000132 235000 xsym               LDA     O1COM+90
        32 002017   000003 735000                    ALS     3
        32 002020   000000 236000 17                 LDQ     DNT$
        32 002021   000241 756005 xsym               STQ     O1COM+161,AL

      750    15432    3       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;

  15432 32 002022   000132 235000 xsym               LDA     O1COM+90
        32 002023   000003 735000                    ALS     3
        32 002024   000015 236007                    LDQ     13,DL
        32 002025   000243 756005 xsym               STQ     O1COM+163,AL

      751    15433    3       SAVED_CONT_FLAG = FALSE;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:147  

  15433 32 002026   000022 450000 0                  STZ     SAVED_CONT_FLAG

      752    15434    3       DNT$ -> DNT.B.NUMERIC_LITERAL = TRUE;

  15434 32 002027   000000 470400 17                 LDP0    DNT$
        32 002030   020000 236003                    LDQ     8192,DU
        32 002031   000003 256100                    ORSQ    3,,PR0

      753    15435
      754    15436    3       IF LEX_SYMBOL.SIZE > %NUM_LIT_MAX_SIZE THEN

  15436 32 002032   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 002033   000077 115007                    CMPA    63,DL
        32 002034   002044 604400 32                 TMOZ    s:15444

      755    15437    4         DO;

      756    15438    4           CALL Z8AE$ERROR(%E$NUMERIC_ITEM_TOO_LONG,

  15438 32 002035   000033 630400 33                 EPPR0   27
        32 002036   000011 631400 33                 EPPR1   9
        32 002037   000000 701000 xent               TSX1    Z8AE$ERROR
        32 002040   000000 011000                    NOP     0

      757    15439    4                           LEX_SYMBOL.LINE,
      758    15440    4                           LEX_SYMBOL.COLUMN);
      759    15441    4           CALL CREATE_DUMMY_NUM_LIT;

  15441 32 002041   000002 701000 32                 TSX1    CREATE_DUMMY_NUM_LIT
        32 002042   000000 011000                    NOP     0

      760    15442    4         END;

  15442 32 002043   004473 710000 32                 TRA     s:15818

      761    15443    3       ELSE
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:148  
      762    15444    3         IF COMCOM.OB.FIPS.LEVEL > 0

  15444 32 002044   000036 720000 xsym               LXL0    COMCOM+30
        32 002045   004473 604400 32                 TMOZ    s:15818
        32 002046   000022 115007                    CMPA    18,DL
        32 002047   004473 604400 32                 TMOZ    s:15818

      763    15445    3               AND LEX_SYMBOL.SIZE > %ANSI_NUM_LIT_MAX_SIZE THEN
      764    15446    4           DO;

      765    15447    4             CALL Z8AE$ERROR (%E$ANSI_LARGE_NUMERIC_ITEM,

  15447 32 002050   000037 630400 33                 EPPR0   31
        32 002051   000011 631400 33                 EPPR1   9
        32 002052   000000 701000 xent               TSX1    Z8AE$ERROR
        32 002053   000000 011000                    NOP     0

      766    15448    4                              LEX_SYMBOL.LINE,
      767    15449    4                              LEX_SYMBOL.COLUMN);
      768    15450    4           END;

  15450 32 002054   004473 710000 32                 TRA     s:15818

      769    15451
      770    15452    3     CASE(%NUMERIC_LITERAL);

      771    15453
      772    15454    3       IF SEARCH_REQUIRED THEN

  15454 32 002055   000000 234000 29                 SZN     SEARCH_REQUIRED
        32 002056   002062 605000 32                 TPL     s:15456

      773    15455    3         CALL Z8AH$SEARCH_;

  15455 32 002057   000003 631400 33                 EPPR1   3
        32 002060   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 002061   000000 011000                    NOP     0
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:149  

      774    15456    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;

  15456 32 002062   000132 235000 xsym               LDA     O1COM+90
        32 002063   000003 735000                    ALS     3
        32 002064   000000 236000 17                 LDQ     DNT$
        32 002065   000241 756005 xsym               STQ     O1COM+161,AL

      775    15457    3       O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;

  15457 32 002066   000132 235000 xsym               LDA     O1COM+90
        32 002067   000003 735000                    ALS     3
        32 002070   000015 236007                    LDQ     13,DL
        32 002071   000243 756005 xsym               STQ     O1COM+163,AL

      776    15458    3       SAVED_CONT_FLAG = FALSE;

  15458 32 002072   000022 450000 0                  STZ     SAVED_CONT_FLAG

      777    15459    3       DNT$ -> DNT.B.NUMERIC_LITERAL = TRUE;

  15459 32 002073   000000 470400 17                 LDP0    DNT$
        32 002074   020000 236003                    LDQ     8192,DU
        32 002075   000003 256100                    ORSQ    3,,PR0

      778    15460
      779    15461    3       CALL Z8AU$CREATE_NUM_DESC (LEX_SYMBOL.SYMBOL,

  15461 32 002076   000042 630400 33                 EPPR0   34
        32 002077   000011 631400 33                 EPPR1   9
        32 002100   000000 701000 xent               TSX1    Z8AU$CREATE_NUM_DESC
        32 002101   000000 011000                    NOP     0

      780    15462    3                                  LEX_SYMBOL.SIZE,
      781    15463    3                                  NUM_DESC);
      782    15464            %VALIDATE_NUM_DESC;
             15465    4     DO;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:150  

             15466    4       IF COMCOM.OB.FIPS.LEVEL > 0

  15466 32 002102   000036 720000 xsym               LXL0    COMCOM+30
        32 002103   002114 604400 32                 TMOZ    s:15475
        32 002104   000002 236000 0                  LDQ     NUM_DESC
        32 002105   000003 036000 0                  ADLQ    NUM_DESC+1
        32 002106   000022 116007                    CMPQ    18,DL
        32 002107   002114 604400 32                 TMOZ    s:15475

             15467    4             AND NUM_DESC.DIGITS_LEFT
             15468    4                   + NUM_DESC.DIGITS_RIGHT
             15469    4                     > %ANSI_NUM_LIT_MAX_SIZE THEN
             15470    5         DO;

             15471    5           CALL Z8AE$ERROR (%E$ANSI_LARGE_NUMERIC_ITEM,

  15471 32 002110   000037 630400 33                 EPPR0   31
        32 002111   000011 631400 33                 EPPR1   9
        32 002112   000000 701000 xent               TSX1    Z8AE$ERROR
        32 002113   000000 011000                    NOP     0

             15472    5                            LEX_SYMBOL.LINE,
             15473    5                            LEX_SYMBOL.COLUMN);
             15474    5         END;

             15475    4       IF COMCOM.OB.FIPS.LEVEL > 0

  15475 32 002114   000036 720000 xsym               LXL0    COMCOM+30
        32 002115   002124 604400 32                 TMOZ    s:15482
        32 002116   000004 235000 0                  LDA     NUM_DESC+2
        32 002117   002124 604400 32                 TMOZ    s:15482

             15476    4              AND NUM_DESC.DIGITS_EXPONENT > 0 THEN
             15477    5         DO;

             15478    5           CALL Z8AE$ERROR (%E$ANSI_FLOATING_POINT,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:151  

  15478 32 002120   000046 630400 33                 EPPR0   38
        32 002121   000011 631400 33                 EPPR1   9
        32 002122   000000 701000 xent               TSX1    Z8AE$ERROR
        32 002123   000000 011000                    NOP     0

             15479    5                            LEX_SYMBOL.LINE,
             15480    5                            LEX_SYMBOL.COLUMN);
             15481    5         END;

             15482    4       IF NUM_DESC.DIGITS_LEFT

  15482 32 002124   000002 236000 0                  LDQ     NUM_DESC
        32 002125   000003 036000 0                  ADLQ    NUM_DESC+1
        32 002126   000077 116007                    CMPQ    63,DL
        32 002127   002137 604400 32                 TMOZ    s:15492

             15483    4              + NUM_DESC.DIGITS_RIGHT
             15484    4                > %NUM_LIT_MAX_SIZE THEN
             15485    5         DO;

             15486    5           CALL Z8AE$ERROR (%E$NUMERIC_ITEM_TOO_LONG,

  15486 32 002130   000033 630400 33                 EPPR0   27
        32 002131   000011 631400 33                 EPPR1   9
        32 002132   000000 701000 xent               TSX1    Z8AE$ERROR
        32 002133   000000 011000                    NOP     0

             15487    5                            LEX_SYMBOL.LINE,
             15488    5                            LEX_SYMBOL.COLUMN);
             15489    5           CALL CREATE_DUMMY_NUM_LIT;

  15489 32 002134   000002 701000 32                 TSX1    CREATE_DUMMY_NUM_LIT
        32 002135   000000 011000                    NOP     0

             15490    5         END;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:152  
  15490 32 002136   002150 710000 32                 TRA     s:15499

             15491    4       ELSE
             15492    4         IF NUM_DESC.DIGITS_EXPONENT > %MAX_EXPONENT_DIGITS THEN

  15492 32 002137   000004 235000 0                  LDA     NUM_DESC+2
        32 002140   000003 115007                    CMPA    3,DL
        32 002141   002150 604400 32                 TMOZ    s:15499

             15493    5           DO;

             15494    5             CALL Z8AE$ERROR (%E$TOO_LARGE_NUM_EXP,

  15494 32 002142   000052 630400 33                 EPPR0   42
        32 002143   000011 631400 33                 EPPR1   9
        32 002144   000000 701000 xent               TSX1    Z8AE$ERROR
        32 002145   000000 011000                    NOP     0

             15495    5                              LEX_SYMBOL.LINE,
             15496    5                              LEX_SYMBOL.COLUMN);
             15497    5             CALL CREATE_DUMMY_NUM_LIT;

  15497 32 002146   000002 701000 32                 TSX1    CREATE_DUMMY_NUM_LIT
        32 002147   000000 011000                    NOP     0

             15498    5           END;

             15499    4       IF NUM_DESC.COMMA_PRESENT

  15499 32 002150   000007 234000 0                  SZN     NUM_DESC+5
        32 002151   004473 605000 32                 TPL     s:15818
        32 002152   000057 236000 xsym               LDQ     O1COM+47
        32 002153   000000 116000 33                 CMPQ    0
        32 002154   002161 600000 32                 TZE     s:15502
        32 002155   000057 470400 xsym               LDP0    O1COM+47
        32 002156   000003 236100                    LDQ     3,,PR0
        32 002157   010000 316003                    CANQ    4096,DU
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:153  
        32 002160   004473 601000 32                 TNZ     s:15818

             15500    4       AND (O1COM.CURRENT_PROC$ = ADDR(NIL)
             15501    4            OR NOT O1COM.CURRENT_PROC$ -> PROC_.B.COMMA_IS_DECIMAL) THEN
             15502    4         CALL Z8AE$ERROR(%E$COMMA_IN_NUMBER,

  15502 32 002161   000056 630400 33                 EPPR0   46
        32 002162   000011 631400 33                 EPPR1   9
        32 002163   000000 701000 xent               TSX1    Z8AE$ERROR
        32 002164   000000 011000                    NOP     0

             15503    4                         LEX_SYMBOL.LINE,
             15504    4                         LEX_SYMBOL.COLUMN);
             15505    4     END;

  15505 32 002165   004473 710000 32                 TRA     s:15818

      783    15507
      784    15508    3     CASE(%USER_WORD);

      785    15509
      786    15510    3       IF SEARCH_REQUIRED THEN

  15510 32 002166   000000 234000 29                 SZN     SEARCH_REQUIRED
        32 002167   002173 605000 32                 TPL     s:15515

      787    15511    3         CALL Z8AH$SEARCH_;

  15511 32 002170   000003 631400 33                 EPPR1   3
        32 002171   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 002172   000000 011000                    NOP     0

      788    15512
      789    15513            %CHECK_REDECL_OF_RESERVED_WORD;
             15514    4     DO;

             15515    4          IF O1COM.RECORD_DCL THEN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:154  

  15515 32 002173   000012 234000 xsym               SZN     O1COM+10
        32 002174   003165 605000 32                 TPL     s:15626

             15516    5            DO;

             15517        /*V*
             15518            RESERVED_WRD_DCL_CHECK -- If the item is a reserved word and we are in
             15519                                      the process of a declaration the reserved word
             15520                                      bit is turned off in the DNT.  The item is changed
             15521                                      to a user word so that a person can declare a
             15522                                      reserved word and use that data name in the
             15523                                      program.  He may not use it as a reserved
             15524                                      word though.
             15525                                      This was done due to the fact that there are
             15526                                      new reserved words in COBOL85 in addition to
             15527                                      to the many before.
             15528        */
             15529    5              IF DNT$->DNT.B.RW AND O1COM.PARSE_ERROR_COUNT = 0 THEN

  15529 32 002175   000000 470400 17                 LDP0    DNT$
        32 002176   000003 234100                    SZN     3,,PR0
        32 002177   003164 605000 32                 TPL     s:15621
        32 002200   000144 235000 xsym               LDA     O1COM+100
        32 002201   003164 601000 32                 TNZ     s:15621

             15530    6                DO CASE (DNT$ -> DNT.RW_NO);

  15530 32 002202   000003 236100                    LDQ     3,,PR0
        32 002203   777777 376007                    ANQ     -1,DL
        32 002204   000067 136007                    SBLQ    55,DL
        32 002205   000660 116007                    CMPQ    432,DL
        32 002206   002210 602006 32                 TNC     s:15530+6,QL
        32 002207   003070 710000 32                 TRA     s:15532
        32 002210   003164 710000 32                 TRA     s:15621
        32 002211   003070 710000 32                 TRA     s:15532
        32 002212   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:155  
        32 002213   003070 710000 32                 TRA     s:15532
        32 002214   003070 710000 32                 TRA     s:15532
        32 002215   003070 710000 32                 TRA     s:15532
        32 002216   003070 710000 32                 TRA     s:15532
        32 002217   003070 710000 32                 TRA     s:15532
        32 002220   003070 710000 32                 TRA     s:15532
        32 002221   003164 710000 32                 TRA     s:15621
        32 002222   003070 710000 32                 TRA     s:15532
        32 002223   003070 710000 32                 TRA     s:15532
        32 002224   003070 710000 32                 TRA     s:15532
        32 002225   003070 710000 32                 TRA     s:15532
        32 002226   003070 710000 32                 TRA     s:15532
        32 002227   003070 710000 32                 TRA     s:15532
        32 002230   003070 710000 32                 TRA     s:15532
        32 002231   003070 710000 32                 TRA     s:15532
        32 002232   003070 710000 32                 TRA     s:15532
        32 002233   003070 710000 32                 TRA     s:15532
        32 002234   003070 710000 32                 TRA     s:15532
        32 002235   003070 710000 32                 TRA     s:15532
        32 002236   003070 710000 32                 TRA     s:15532
        32 002237   003070 710000 32                 TRA     s:15532
        32 002240   003070 710000 32                 TRA     s:15532
        32 002241   003070 710000 32                 TRA     s:15532
        32 002242   003070 710000 32                 TRA     s:15532
        32 002243   003070 710000 32                 TRA     s:15532
        32 002244   003070 710000 32                 TRA     s:15532
        32 002245   003070 710000 32                 TRA     s:15532
        32 002246   003070 710000 32                 TRA     s:15532
        32 002247   003070 710000 32                 TRA     s:15532
        32 002250   003070 710000 32                 TRA     s:15532
        32 002251   003070 710000 32                 TRA     s:15532
        32 002252   003164 710000 32                 TRA     s:15621
        32 002253   003070 710000 32                 TRA     s:15532
        32 002254   003070 710000 32                 TRA     s:15532
        32 002255   003070 710000 32                 TRA     s:15532
        32 002256   003164 710000 32                 TRA     s:15621
        32 002257   003164 710000 32                 TRA     s:15621
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:156  
        32 002260   003164 710000 32                 TRA     s:15621
        32 002261   003164 710000 32                 TRA     s:15621
        32 002262   003164 710000 32                 TRA     s:15621
        32 002263   003164 710000 32                 TRA     s:15621
        32 002264   003164 710000 32                 TRA     s:15621
        32 002265   003164 710000 32                 TRA     s:15621
        32 002266   003164 710000 32                 TRA     s:15621
        32 002267   003164 710000 32                 TRA     s:15621
        32 002270   003164 710000 32                 TRA     s:15621
        32 002271   003164 710000 32                 TRA     s:15621
        32 002272   003164 710000 32                 TRA     s:15621
        32 002273   003070 710000 32                 TRA     s:15532
        32 002274   003070 710000 32                 TRA     s:15532
        32 002275   003070 710000 32                 TRA     s:15532
        32 002276   003070 710000 32                 TRA     s:15532
        32 002277   003070 710000 32                 TRA     s:15532
        32 002300   003070 710000 32                 TRA     s:15532
        32 002301   003070 710000 32                 TRA     s:15532
        32 002302   003070 710000 32                 TRA     s:15532
        32 002303   003070 710000 32                 TRA     s:15532
        32 002304   003070 710000 32                 TRA     s:15532
        32 002305   003070 710000 32                 TRA     s:15532
        32 002306   003070 710000 32                 TRA     s:15532
        32 002307   003070 710000 32                 TRA     s:15532
        32 002310   003070 710000 32                 TRA     s:15532
        32 002311   003070 710000 32                 TRA     s:15532
        32 002312   003070 710000 32                 TRA     s:15532
        32 002313   003070 710000 32                 TRA     s:15532
        32 002314   003070 710000 32                 TRA     s:15532
        32 002315   003070 710000 32                 TRA     s:15532
        32 002316   003070 710000 32                 TRA     s:15532
        32 002317   003070 710000 32                 TRA     s:15532
        32 002320   003070 710000 32                 TRA     s:15532
        32 002321   003070 710000 32                 TRA     s:15532
        32 002322   003070 710000 32                 TRA     s:15532
        32 002323   003164 710000 32                 TRA     s:15621
        32 002324   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:157  
        32 002325   003070 710000 32                 TRA     s:15532
        32 002326   003070 710000 32                 TRA     s:15532
        32 002327   003070 710000 32                 TRA     s:15532
        32 002330   003070 710000 32                 TRA     s:15532
        32 002331   003070 710000 32                 TRA     s:15532
        32 002332   003070 710000 32                 TRA     s:15532
        32 002333   003070 710000 32                 TRA     s:15532
        32 002334   003070 710000 32                 TRA     s:15532
        32 002335   003070 710000 32                 TRA     s:15532
        32 002336   003164 710000 32                 TRA     s:15621
        32 002337   003070 710000 32                 TRA     s:15532
        32 002340   003070 710000 32                 TRA     s:15532
        32 002341   003070 710000 32                 TRA     s:15532
        32 002342   003070 710000 32                 TRA     s:15532
        32 002343   003070 710000 32                 TRA     s:15532
        32 002344   003070 710000 32                 TRA     s:15532
        32 002345   003070 710000 32                 TRA     s:15532
        32 002346   003164 710000 32                 TRA     s:15621
        32 002347   003070 710000 32                 TRA     s:15532
        32 002350   003070 710000 32                 TRA     s:15532
        32 002351   003070 710000 32                 TRA     s:15532
        32 002352   003070 710000 32                 TRA     s:15532
        32 002353   003070 710000 32                 TRA     s:15532
        32 002354   003070 710000 32                 TRA     s:15532
        32 002355   003070 710000 32                 TRA     s:15532
        32 002356   003070 710000 32                 TRA     s:15532
        32 002357   003070 710000 32                 TRA     s:15532
        32 002360   003070 710000 32                 TRA     s:15532
        32 002361   003070 710000 32                 TRA     s:15532
        32 002362   003070 710000 32                 TRA     s:15532
        32 002363   003070 710000 32                 TRA     s:15532
        32 002364   003070 710000 32                 TRA     s:15532
        32 002365   003070 710000 32                 TRA     s:15532
        32 002366   003070 710000 32                 TRA     s:15532
        32 002367   003070 710000 32                 TRA     s:15532
        32 002370   003070 710000 32                 TRA     s:15532
        32 002371   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:158  
        32 002372   003070 710000 32                 TRA     s:15532
        32 002373   003070 710000 32                 TRA     s:15532
        32 002374   003070 710000 32                 TRA     s:15532
        32 002375   003070 710000 32                 TRA     s:15532
        32 002376   003070 710000 32                 TRA     s:15532
        32 002377   003070 710000 32                 TRA     s:15532
        32 002400   003070 710000 32                 TRA     s:15532
        32 002401   003070 710000 32                 TRA     s:15532
        32 002402   003070 710000 32                 TRA     s:15532
        32 002403   003070 710000 32                 TRA     s:15532
        32 002404   003070 710000 32                 TRA     s:15532
        32 002405   003070 710000 32                 TRA     s:15532
        32 002406   003070 710000 32                 TRA     s:15532
        32 002407   003070 710000 32                 TRA     s:15532
        32 002410   003070 710000 32                 TRA     s:15532
        32 002411   003070 710000 32                 TRA     s:15532
        32 002412   003070 710000 32                 TRA     s:15532
        32 002413   003070 710000 32                 TRA     s:15532
        32 002414   003070 710000 32                 TRA     s:15532
        32 002415   003070 710000 32                 TRA     s:15532
        32 002416   003070 710000 32                 TRA     s:15532
        32 002417   003070 710000 32                 TRA     s:15532
        32 002420   003070 710000 32                 TRA     s:15532
        32 002421   003070 710000 32                 TRA     s:15532
        32 002422   003070 710000 32                 TRA     s:15532
        32 002423   003070 710000 32                 TRA     s:15532
        32 002424   003070 710000 32                 TRA     s:15532
        32 002425   003070 710000 32                 TRA     s:15532
        32 002426   003070 710000 32                 TRA     s:15532
        32 002427   003070 710000 32                 TRA     s:15532
        32 002430   003070 710000 32                 TRA     s:15532
        32 002431   003070 710000 32                 TRA     s:15532
        32 002432   003164 710000 32                 TRA     s:15621
        32 002433   003070 710000 32                 TRA     s:15532
        32 002434   003070 710000 32                 TRA     s:15532
        32 002435   003070 710000 32                 TRA     s:15532
        32 002436   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:159  
        32 002437   003070 710000 32                 TRA     s:15532
        32 002440   003070 710000 32                 TRA     s:15532
        32 002441   003164 710000 32                 TRA     s:15621
        32 002442   003070 710000 32                 TRA     s:15532
        32 002443   003070 710000 32                 TRA     s:15532
        32 002444   003070 710000 32                 TRA     s:15532
        32 002445   003070 710000 32                 TRA     s:15532
        32 002446   003070 710000 32                 TRA     s:15532
        32 002447   003070 710000 32                 TRA     s:15532
        32 002450   003070 710000 32                 TRA     s:15532
        32 002451   003070 710000 32                 TRA     s:15532
        32 002452   003070 710000 32                 TRA     s:15532
        32 002453   003070 710000 32                 TRA     s:15532
        32 002454   003070 710000 32                 TRA     s:15532
        32 002455   003070 710000 32                 TRA     s:15532
        32 002456   003070 710000 32                 TRA     s:15532
        32 002457   003070 710000 32                 TRA     s:15532
        32 002460   003070 710000 32                 TRA     s:15532
        32 002461   003070 710000 32                 TRA     s:15532
        32 002462   003164 710000 32                 TRA     s:15621
        32 002463   003070 710000 32                 TRA     s:15532
        32 002464   003070 710000 32                 TRA     s:15532
        32 002465   003070 710000 32                 TRA     s:15532
        32 002466   003164 710000 32                 TRA     s:15621
        32 002467   003070 710000 32                 TRA     s:15532
        32 002470   003070 710000 32                 TRA     s:15532
        32 002471   003070 710000 32                 TRA     s:15532
        32 002472   003070 710000 32                 TRA     s:15532
        32 002473   003070 710000 32                 TRA     s:15532
        32 002474   003070 710000 32                 TRA     s:15532
        32 002475   003070 710000 32                 TRA     s:15532
        32 002476   003070 710000 32                 TRA     s:15532
        32 002477   003070 710000 32                 TRA     s:15532
        32 002500   003070 710000 32                 TRA     s:15532
        32 002501   003070 710000 32                 TRA     s:15532
        32 002502   003070 710000 32                 TRA     s:15532
        32 002503   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:160  
        32 002504   003070 710000 32                 TRA     s:15532
        32 002505   003070 710000 32                 TRA     s:15532
        32 002506   003164 710000 32                 TRA     s:15621
        32 002507   003164 710000 32                 TRA     s:15621
        32 002510   003070 710000 32                 TRA     s:15532
        32 002511   003070 710000 32                 TRA     s:15532
        32 002512   003070 710000 32                 TRA     s:15532
        32 002513   003070 710000 32                 TRA     s:15532
        32 002514   003070 710000 32                 TRA     s:15532
        32 002515   003070 710000 32                 TRA     s:15532
        32 002516   003070 710000 32                 TRA     s:15532
        32 002517   003070 710000 32                 TRA     s:15532
        32 002520   003070 710000 32                 TRA     s:15532
        32 002521   003070 710000 32                 TRA     s:15532
        32 002522   003070 710000 32                 TRA     s:15532
        32 002523   003164 710000 32                 TRA     s:15621
        32 002524   003070 710000 32                 TRA     s:15532
        32 002525   003070 710000 32                 TRA     s:15532
        32 002526   003164 710000 32                 TRA     s:15621
        32 002527   003070 710000 32                 TRA     s:15532
        32 002530   003070 710000 32                 TRA     s:15532
        32 002531   003070 710000 32                 TRA     s:15532
        32 002532   003070 710000 32                 TRA     s:15532
        32 002533   003070 710000 32                 TRA     s:15532
        32 002534   003070 710000 32                 TRA     s:15532
        32 002535   003070 710000 32                 TRA     s:15532
        32 002536   003164 710000 32                 TRA     s:15621
        32 002537   003070 710000 32                 TRA     s:15532
        32 002540   003070 710000 32                 TRA     s:15532
        32 002541   003070 710000 32                 TRA     s:15532
        32 002542   003070 710000 32                 TRA     s:15532
        32 002543   003070 710000 32                 TRA     s:15532
        32 002544   003070 710000 32                 TRA     s:15532
        32 002545   003070 710000 32                 TRA     s:15532
        32 002546   003164 710000 32                 TRA     s:15621
        32 002547   003070 710000 32                 TRA     s:15532
        32 002550   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:161  
        32 002551   003070 710000 32                 TRA     s:15532
        32 002552   003070 710000 32                 TRA     s:15532
        32 002553   003070 710000 32                 TRA     s:15532
        32 002554   003070 710000 32                 TRA     s:15532
        32 002555   003070 710000 32                 TRA     s:15532
        32 002556   003070 710000 32                 TRA     s:15532
        32 002557   003070 710000 32                 TRA     s:15532
        32 002560   003070 710000 32                 TRA     s:15532
        32 002561   003070 710000 32                 TRA     s:15532
        32 002562   003070 710000 32                 TRA     s:15532
        32 002563   003070 710000 32                 TRA     s:15532
        32 002564   003070 710000 32                 TRA     s:15532
        32 002565   003070 710000 32                 TRA     s:15532
        32 002566   003070 710000 32                 TRA     s:15532
        32 002567   003070 710000 32                 TRA     s:15532
        32 002570   003070 710000 32                 TRA     s:15532
        32 002571   003070 710000 32                 TRA     s:15532
        32 002572   003070 710000 32                 TRA     s:15532
        32 002573   003070 710000 32                 TRA     s:15532
        32 002574   003070 710000 32                 TRA     s:15532
        32 002575   003070 710000 32                 TRA     s:15532
        32 002576   003164 710000 32                 TRA     s:15621
        32 002577   003070 710000 32                 TRA     s:15532
        32 002600   003070 710000 32                 TRA     s:15532
        32 002601   003070 710000 32                 TRA     s:15532
        32 002602   003070 710000 32                 TRA     s:15532
        32 002603   003070 710000 32                 TRA     s:15532
        32 002604   003070 710000 32                 TRA     s:15532
        32 002605   003070 710000 32                 TRA     s:15532
        32 002606   003070 710000 32                 TRA     s:15532
        32 002607   003070 710000 32                 TRA     s:15532
        32 002610   003070 710000 32                 TRA     s:15532
        32 002611   003070 710000 32                 TRA     s:15532
        32 002612   003164 710000 32                 TRA     s:15621
        32 002613   003070 710000 32                 TRA     s:15532
        32 002614   003070 710000 32                 TRA     s:15532
        32 002615   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:162  
        32 002616   003070 710000 32                 TRA     s:15532
        32 002617   003070 710000 32                 TRA     s:15532
        32 002620   003070 710000 32                 TRA     s:15532
        32 002621   003070 710000 32                 TRA     s:15532
        32 002622   003070 710000 32                 TRA     s:15532
        32 002623   003070 710000 32                 TRA     s:15532
        32 002624   003070 710000 32                 TRA     s:15532
        32 002625   003070 710000 32                 TRA     s:15532
        32 002626   003070 710000 32                 TRA     s:15532
        32 002627   003070 710000 32                 TRA     s:15532
        32 002630   003070 710000 32                 TRA     s:15532
        32 002631   003070 710000 32                 TRA     s:15532
        32 002632   003070 710000 32                 TRA     s:15532
        32 002633   003070 710000 32                 TRA     s:15532
        32 002634   003070 710000 32                 TRA     s:15532
        32 002635   003070 710000 32                 TRA     s:15532
        32 002636   003070 710000 32                 TRA     s:15532
        32 002637   003070 710000 32                 TRA     s:15532
        32 002640   003070 710000 32                 TRA     s:15532
        32 002641   003164 710000 32                 TRA     s:15621
        32 002642   003070 710000 32                 TRA     s:15532
        32 002643   003164 710000 32                 TRA     s:15621
        32 002644   003070 710000 32                 TRA     s:15532
        32 002645   003070 710000 32                 TRA     s:15532
        32 002646   003070 710000 32                 TRA     s:15532
        32 002647   003070 710000 32                 TRA     s:15532
        32 002650   003070 710000 32                 TRA     s:15532
        32 002651   003070 710000 32                 TRA     s:15532
        32 002652   003070 710000 32                 TRA     s:15532
        32 002653   003070 710000 32                 TRA     s:15532
        32 002654   003070 710000 32                 TRA     s:15532
        32 002655   003070 710000 32                 TRA     s:15532
        32 002656   003070 710000 32                 TRA     s:15532
        32 002657   003070 710000 32                 TRA     s:15532
        32 002660   003070 710000 32                 TRA     s:15532
        32 002661   003070 710000 32                 TRA     s:15532
        32 002662   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:163  
        32 002663   003070 710000 32                 TRA     s:15532
        32 002664   003070 710000 32                 TRA     s:15532
        32 002665   003070 710000 32                 TRA     s:15532
        32 002666   003070 710000 32                 TRA     s:15532
        32 002667   003070 710000 32                 TRA     s:15532
        32 002670   003070 710000 32                 TRA     s:15532
        32 002671   003070 710000 32                 TRA     s:15532
        32 002672   003070 710000 32                 TRA     s:15532
        32 002673   003070 710000 32                 TRA     s:15532
        32 002674   003070 710000 32                 TRA     s:15532
        32 002675   003070 710000 32                 TRA     s:15532
        32 002676   003070 710000 32                 TRA     s:15532
        32 002677   003070 710000 32                 TRA     s:15532
        32 002700   003164 710000 32                 TRA     s:15621
        32 002701   003070 710000 32                 TRA     s:15532
        32 002702   003070 710000 32                 TRA     s:15532
        32 002703   003070 710000 32                 TRA     s:15532
        32 002704   003070 710000 32                 TRA     s:15532
        32 002705   003070 710000 32                 TRA     s:15532
        32 002706   003070 710000 32                 TRA     s:15532
        32 002707   003070 710000 32                 TRA     s:15532
        32 002710   003070 710000 32                 TRA     s:15532
        32 002711   003070 710000 32                 TRA     s:15532
        32 002712   003164 710000 32                 TRA     s:15621
        32 002713   003070 710000 32                 TRA     s:15532
        32 002714   003070 710000 32                 TRA     s:15532
        32 002715   003070 710000 32                 TRA     s:15532
        32 002716   003070 710000 32                 TRA     s:15532
        32 002717   003070 710000 32                 TRA     s:15532
        32 002720   003070 710000 32                 TRA     s:15532
        32 002721   003070 710000 32                 TRA     s:15532
        32 002722   003070 710000 32                 TRA     s:15532
        32 002723   003070 710000 32                 TRA     s:15532
        32 002724   003070 710000 32                 TRA     s:15532
        32 002725   003070 710000 32                 TRA     s:15532
        32 002726   003070 710000 32                 TRA     s:15532
        32 002727   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:164  
        32 002730   003070 710000 32                 TRA     s:15532
        32 002731   003070 710000 32                 TRA     s:15532
        32 002732   003070 710000 32                 TRA     s:15532
        32 002733   003070 710000 32                 TRA     s:15532
        32 002734   003070 710000 32                 TRA     s:15532
        32 002735   003070 710000 32                 TRA     s:15532
        32 002736   003070 710000 32                 TRA     s:15532
        32 002737   003070 710000 32                 TRA     s:15532
        32 002740   003070 710000 32                 TRA     s:15532
        32 002741   003070 710000 32                 TRA     s:15532
        32 002742   003070 710000 32                 TRA     s:15532
        32 002743   003070 710000 32                 TRA     s:15532
        32 002744   003070 710000 32                 TRA     s:15532
        32 002745   003070 710000 32                 TRA     s:15532
        32 002746   003070 710000 32                 TRA     s:15532
        32 002747   003070 710000 32                 TRA     s:15532
        32 002750   003070 710000 32                 TRA     s:15532
        32 002751   003070 710000 32                 TRA     s:15532
        32 002752   003070 710000 32                 TRA     s:15532
        32 002753   003070 710000 32                 TRA     s:15532
        32 002754   003070 710000 32                 TRA     s:15532
        32 002755   003070 710000 32                 TRA     s:15532
        32 002756   003070 710000 32                 TRA     s:15532
        32 002757   003070 710000 32                 TRA     s:15532
        32 002760   003070 710000 32                 TRA     s:15532
        32 002761   003070 710000 32                 TRA     s:15532
        32 002762   003070 710000 32                 TRA     s:15532
        32 002763   003164 710000 32                 TRA     s:15621
        32 002764   003070 710000 32                 TRA     s:15532
        32 002765   003070 710000 32                 TRA     s:15532
        32 002766   003070 710000 32                 TRA     s:15532
        32 002767   003164 710000 32                 TRA     s:15621
        32 002770   003070 710000 32                 TRA     s:15532
        32 002771   003070 710000 32                 TRA     s:15532
        32 002772   003070 710000 32                 TRA     s:15532
        32 002773   003070 710000 32                 TRA     s:15532
        32 002774   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:165  
        32 002775   003070 710000 32                 TRA     s:15532
        32 002776   003070 710000 32                 TRA     s:15532
        32 002777   003070 710000 32                 TRA     s:15532
        32 003000   003070 710000 32                 TRA     s:15532
        32 003001   003070 710000 32                 TRA     s:15532
        32 003002   003070 710000 32                 TRA     s:15532
        32 003003   003070 710000 32                 TRA     s:15532
        32 003004   003070 710000 32                 TRA     s:15532
        32 003005   003070 710000 32                 TRA     s:15532
        32 003006   003070 710000 32                 TRA     s:15532
        32 003007   003070 710000 32                 TRA     s:15532
        32 003010   003070 710000 32                 TRA     s:15532
        32 003011   003070 710000 32                 TRA     s:15532
        32 003012   003070 710000 32                 TRA     s:15532
        32 003013   003070 710000 32                 TRA     s:15532
        32 003014   003164 710000 32                 TRA     s:15621
        32 003015   003070 710000 32                 TRA     s:15532
        32 003016   003070 710000 32                 TRA     s:15532
        32 003017   003070 710000 32                 TRA     s:15532
        32 003020   003164 710000 32                 TRA     s:15621
        32 003021   003070 710000 32                 TRA     s:15532
        32 003022   003070 710000 32                 TRA     s:15532
        32 003023   003070 710000 32                 TRA     s:15532
        32 003024   003070 710000 32                 TRA     s:15532
        32 003025   003070 710000 32                 TRA     s:15532
        32 003026   003070 710000 32                 TRA     s:15532
        32 003027   003070 710000 32                 TRA     s:15532
        32 003030   003070 710000 32                 TRA     s:15532
        32 003031   003070 710000 32                 TRA     s:15532
        32 003032   003070 710000 32                 TRA     s:15532
        32 003033   003070 710000 32                 TRA     s:15532
        32 003034   003070 710000 32                 TRA     s:15532
        32 003035   003070 710000 32                 TRA     s:15532
        32 003036   003070 710000 32                 TRA     s:15532
        32 003037   003070 710000 32                 TRA     s:15532
        32 003040   003070 710000 32                 TRA     s:15532
        32 003041   003070 710000 32                 TRA     s:15532
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:166  
        32 003042   003070 710000 32                 TRA     s:15532
        32 003043   003070 710000 32                 TRA     s:15532
        32 003044   003164 710000 32                 TRA     s:15621
        32 003045   003070 710000 32                 TRA     s:15532
        32 003046   003070 710000 32                 TRA     s:15532
        32 003047   003164 710000 32                 TRA     s:15621
        32 003050   003070 710000 32                 TRA     s:15532
        32 003051   003070 710000 32                 TRA     s:15532
        32 003052   003070 710000 32                 TRA     s:15532
        32 003053   003070 710000 32                 TRA     s:15532
        32 003054   003070 710000 32                 TRA     s:15532
        32 003055   003070 710000 32                 TRA     s:15532
        32 003056   003070 710000 32                 TRA     s:15532
        32 003057   003070 710000 32                 TRA     s:15532
        32 003060   003070 710000 32                 TRA     s:15532
        32 003061   003164 710000 32                 TRA     s:15621
        32 003062   003070 710000 32                 TRA     s:15532
        32 003063   003070 710000 32                 TRA     s:15532
        32 003064   003070 710000 32                 TRA     s:15532
        32 003065   003070 710000 32                 TRA     s:15532
        32 003066   003164 710000 32                 TRA     s:15621
        32 003067   003164 710000 32                 TRA     s:15621

             15531    6                  CASE(ELSE);

             15532    6                    CALL Z8AE$ERROR (%E$RW_USED_AS_DATA_NAME,

  15532 32 003070   000063 630400 33                 EPPR0   51
        32 003071   000061 631400 33                 EPPR1   49
        32 003072   000000 701000 xent               TSX1    Z8AE$ERROR
        32 003073   000000 011000                    NOP     0

             15533    6                                     LEX_SYMBOL.LINE,
             15534    6                                     LEX_SYMBOL.COLUMN,
             15535    6                                     DNT$);
             15536                         /* Create new DNT for non-reserved word since reserved
             15537                               word is in constant storage */
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:167  
             15538    6                    TDNT$ = DNT$;

  15538 32 003074   000000 236000 17                 LDQ     DNT$
        32 003075   000025 756000 0                  STQ     TDNT$

             15539                         %NEW_DNT(@SIZE = LEX_SYMBOL.SIZE,
             15540                                     @NAME = LEX_SYMBOL.SYMBOL,
             15541                                     @ST$ = TDNT$ -> DNT.ST$,
             15542                                     @NEXT = "DNT_BUCKETS(DNT_BUCKET_NUMBER)");
             15543          %RESERVE_DNT(POINTER = @POINTER,  SIZE = @SIZE);
             15544    7          DO ;

             15545    7            ITERATION = (SIZE+21)/4 ;

  15545 32 003076   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 003077   000025 036007                    ADLQ    21,DL
        32 003100   000004 506007                    DIV     4,DL
        32 003101   000000 756000 1                  STQ     ITERATION

             15546    7            IF DNT_.BOTTOM + ITERATION >= DNT_.FLOOR THEN

  15546 32 003102   000002 036000 18                 ADLQ    DNT_+2
        32 003103   003116 604000 32                 TMI     s:15548
        32 003104   000003 116000 18                 CMPQ    DNT_+3
        32 003105   003116 602000 32                 TNC     s:15548

             15547    7              CALL Z8AR$RESERVER(ADDR(DNT_));

  15547 32 003106   000067 236000 33                 LDQ     55
        32 003107   000172 756000 0                  STQ     INSERT_SIZE+1
        32 003110   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 003111   000173 450400 0                  STP0    INSERT_SIZE+2
        32 003112   000173 630400 0                  EPPR0   INSERT_SIZE+2
        32 003113   000004 631400 33                 EPPR1   4
        32 003114   000000 701000 xent               TSX1    Z8AR$RESERVER
        32 003115   000000 011000                    NOP     0

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:168  
             15548    7            POINTER                  = PINCRW (DNT_.FIRST, DNT_.BOTTOM);

  15548 32 003116   000002 236000 18                 LDQ     DNT_+2
        32 003117   000022 736000                    QLS     18
        32 003120   000001 036000 18                 ADLQ    DNT_+1
        32 003121   000000 756000 17                 STQ     DNT$

             15549    7            DNT_.BOTTOM              = DNT_.BOTTOM + ITERATION ;

  15549 32 003122   000002 236000 18                 LDQ     DNT_+2
        32 003123   000000 036000 1                  ADLQ    ITERATION
        32 003124   000002 756000 18                 STQ     DNT_+2

             15550    7            POINTER->DNT.ID          = ITEM % ;

  15550 32 003125   001046 220003                    LDX0    550,DU
        32 003126   000000 470400 17                 LDP0    DNT$
        32 003127   000000 740100                    STX0    0,,PR0

             15551    7            POINTER->DNT.N           = ITERATION ;

  15551 32 003130   000000 721000 1                  LXL1    ITERATION
        32 003131   000000 470400 17                 LDP0    DNT$
        32 003132   000000 441100                    SXL1    0,,PR0

             15552    7            POINTER->DNT.TEXT.LENGTH = SIZE;

  15552 32 003133   000010 721000 2                  LXL1    LEX_SYMBOL+8
        32 003134   000000 470400 17                 LDP0    DNT$
        32 003135   000004 741100                    STX1    4,,PR0

             15553    7          END ;

             15555    6     @POINTER -> DNT.ST$        = @ST$;

  15555 32 003136   000025 471400 0                  LDP1    TDNT$
        32 003137   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:169  
        32 003140   000001 756100                    STQ     1,,PR0

             15556    6     @POINTER -> DNT.NEXT       = @NEXT;

  15556 32 003141   000000 722000 19                 LXL2    DNT_BUCKET_NUMBER
        32 003142   000000 236012 xsym               LDQ     DNT_BUCKETS,X2
        32 003143   000002 756100                    STQ     2,,PR0

             15557    6     @POINTER -> DNT.ATTR       = '0'B;

  15557 32 003144   000000 223003                    LDX3    0,DU
        32 003145   000003 743100                    STX3    3,,PR0

             15558    6     @POINTER -> DNT.RW_NO      = @RW_NO;

  15558 32 003146   000000 224003                    LDX4    0,DU
        32 003147   000003 444100                    SXL4    3,,PR0

             15559    6     @POINTER -> DNT.TEXT.NAME  = @NAME;

  15559 32 003150   040140 100400                    MLR     fill='040'O
        32 003151   000011 000504 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=324
        32 003152   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1

             15560          %IF @RW;
             15562          %ENDIF;
             15563          %IF @USER_WORD;
             15565          %ENDIF;
             15566          %IF @SYSTEM_NAME;
             15568          %ENDIF;
             15569          %IF @DUPLICATE;
             15571          %ENDIF;
             15572          %IF @NUMERIC_LITERAL;
             15574          %ENDIF;
             15575          %IF @REPLACE_TOKEN;
             15577          %ENDIF;
             15578          %IF @ALPHA_LITERAL;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:170  
             15580          %ENDIF;
             15581          %IF @FIGURATIVE_CONSTANT;
             15583          %ENDIF;
             15584          %IF @ALL;
             15586          %ENDIF;
             15587          %IF @VERB;
             15589          %ENDIF;
             15590          %IF @ACCEPT_AREA_A;
             15592          %ENDIF;
             15593          %IF @ERROR_VARIABLE;
             15595          %ENDIF;
             15596          %IF @MUST_AREA_A;
             15598          %ENDIF;
             15600    6                    DNT$ -> DNT.ATTR = TDNT$ -> DNT.ATTR;

  15600 32 003153   100003 225100                    LDX5    3,,PR1
        32 003154   000003 745100                    STX5    3,,PR0

             15601    6                    DNT$ -> DNT.B.USER_WORD = TRUE;

  15601 32 003155   200000 236003                    LDQ     65536,DU
        32 003156   000003 256100                    ORSQ    3,,PR0

             15602    6                    DNT$ -> DNT.B.RW = FALSE;

  15602 32 003157   000023 236000 33                 LDQ     19
        32 003160   000003 356100                    ANSQ    3,,PR0

             15603    6                    DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;

  15603 32 003161   000000 236000 17                 LDQ     DNT$
        32 003162   000000 756012 xsym               STQ     DNT_BUCKETS,X2
        32 003163   003164 710000 32                 TRA     s:15621

             15604    6                  CASE (%RSV_WRD_FILLER,  %RSV_WRD_PICTURE, %RSV_WRD_USAGE,

             15605    6                        %RSV_WRD_SIGN,    %RSV_WRD_LEADING, %RSV_WRD_TRAILING,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:171  
             15606    6                        %RSV_WRD_DISPLAY, %RSV_WRD_JUSTIFIED, %RSV_WRD_BLANK,
             15607    6                        %RSV_WRD_SOURCE,     %RSV_WRD_LINE,    %RSV_WRD_COLUMN,
             15608    6                        %RSV_WRD_VALUE,   %RSV_WRD_VALUES,  %RSV_WRD_SUM,
             15609    6                        %RSV_WRD_GROUP,   %RSV_WRD_NEXT,    %RSV_WRD_TYPE,
             15610    6                        %RSV_WRD_REDEFINES, %RSV_WRD_IS,    %RSV_WRD_EXTERNAL,
             15611    6                        %RSV_WRD_GLOBAL,  %RSV_WRD_COMP,    %RSV_WRD_INDEX,
             15612    6                        %RSV_WRD_OCCURS,  %RSV_WRD_ASCENDING,  %RSV_WRD_DESCENDING,

             15613    6                        %RSV_WRD_INDEXED,  %RSV_WRD_SYNCHRONIZED, %RSV_WRD_RENAMES,
             15614    6                        %RSV_WRD_COMP_1,  %RSV_WRD_COMP_2,  %RSV_WRD_COMP_3,
             15615    6                        %RSV_WRD_COMP_4,  %RSV_WRD_COMP_5,  %RSV_WRD_COMP_6,
             15616    6                        %RSV_WRD_COMP_7,  %RSV_WRD_COMP_8,  %RSV_WRD_COMP_11,
             15617    6                        %RSV_WRD_COMP_12, %RSV_WRD_COMP_13, %RSV_WRD_COMP_14,
             15618    6                        %RSV_WRD_DB_KEY, %RSV_WRD_POINTER);
             15619    6                   ;  /* do nothing */
             15620    6                END;

             15621    5              O1COM.RECORD_DCL = '0'B;

  15621 32 003164   000012 450000 xsym               STZ     O1COM+10

             15622    5            END;

             15623    4     END;

      790    15625
      791    15626    3       O1COM.LA_STK.DNT$(O1COM.LA_PUT) = DNT$;

  15626 32 003165   000132 235000 xsym               LDA     O1COM+90
        32 003166   000003 735000                    ALS     3
        32 003167   000000 236000 17                 LDQ     DNT$
        32 003170   000241 756005 xsym               STQ     O1COM+161,AL

      792    15627    3       O1COM.LA_STK.ST$(O1COM.LA_PUT) = DNT$ -> DNT.ST$;

  15627 32 003171   000132 235000 xsym               LDA     O1COM+90
        32 003172   000003 735000                    ALS     3
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:172  
        32 003173   000000 470400 17                 LDP0    DNT$
        32 003174   000001 236100                    LDQ     1,,PR0
        32 003175   000240 756005 xsym               STQ     O1COM+160,AL

      793    15628
      794    15629    3       IF DNT$ -> DNT.B.RW THEN

  15629 32 003176   000003 234100                    SZN     3,,PR0
        32 003177   004314 605000 32                 TPL     s:15713

      795    15630              %PROCESS_RESERVED_WORD;
             15631    4            DO ;

             15632        /*V*
             15633            RESERVED_WORD -- If we have encountered a reserved word then the symbol
             15634                             field in the stack is assigned the reserved word number.
             15635                             If we see the start of a picture string (PIC or PICTURE)
             15636                             then we set the state symbolizing the start of a picture
             15637                             string.
             15638        */
             15639    4              IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START

  15639 32 003200   000132 235000 xsym               LDA     O1COM+90
        32 003201   000003 735000                    ALS     3
        32 003202   000245 236005 xsym               LDQ     O1COM+165,AL
        32 003203   003234 604000 32                 TMI     s:15648
        32 003204   000121 116000 xsym               CMPQ    O1COM+81
        32 003205   003234 605000 32                 TPL     s:15648
        32 003206   000013 234000 xsym               SZN     O1COM+11
        32 003207   003234 605000 32                 TPL     s:15648
        32 003210   000003 236100                    LDQ     3,,PR0
        32 003211   000040 316003                    CANQ    32,DU
        32 003212   003234 601000 32                 TNZ     s:15648
        32 003213   000200 316003                    CANQ    128,DU
        32 003214   003234 601000 32                 TNZ     s:15648

             15640                      /*N* Free_Format --  AND NOT COMCOM.OB.FORMAT */
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:173  
             15641    4                  AND O1COM.PD_FLAG
             15642    4                  AND NOT DNT$ -> DNT.B.MUST_AREA_A
             15643    4                  AND NOT DNT$ -> DNT.B.ACCEPT_AREA_A THEN
             15644    4                CALL Z8AE$ERROR(%E$AREA_A_ERROR,

  15644 32 003215   000066 236000 33                 LDQ     54
        32 003216   000175 756000 0                  STQ     INSERT_SIZE+4
        32 003217   000132 236000 xsym               LDQ     O1COM+90
        32 003220   000025 736000                    QLS     21
        32 003221   000071 036000 33                 ADLQ    57
        32 003222   000174 756000 0                  STQ     INSERT_SIZE+3
        32 003223   000132 236000 xsym               LDQ     O1COM+90
        32 003224   000025 736000                    QLS     21
        32 003225   000072 036000 33                 ADLQ    58
        32 003226   000073 235000 33                 LDA     59
        32 003227   000172 757000 0                  STAQ    INSERT_SIZE+1
        32 003230   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 003231   000061 631400 33                 EPPR1   49
        32 003232   000000 701000 xent               TSX1    Z8AE$ERROR
        32 003233   000000 011000                    NOP     0

             15645    4                                O1COM.LA_STK.LINE(O1COM.LA_PUT),
             15646    4                                O1COM.LA_STK.COLUMN(O1COM.LA_PUT),
             15647    4                                DNT$);
             15648    4              IF DNT$ -> DNT.B.MUST_AREA_A

  15648 32 003234   000000 470400 17                 LDP0    DNT$
        32 003235   000003 236100                    LDQ     3,,PR0
        32 003236   000040 316003                    CANQ    32,DU
        32 003237   003265 600000 32                 TZE     s:15655
        32 003240   000132 235000 xsym               LDA     O1COM+90
        32 003241   000003 735000                    ALS     3
        32 003242   000245 236005 xsym               LDQ     O1COM+165,AL
        32 003243   003246 604000 32                 TMI     s:15651
        32 003244   000121 116000 xsym               CMPQ    O1COM+81
        32 003245   003265 604000 32                 TMI     s:15655

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:174  
             15649                   /*N* Free_Format -- AND NOT COMCOM.OB.FORMAT */
             15650    4              AND O1COM.LA_STK.COLUMN(O1COM.LA_PUT) >= O1COM.AREA_B_COLUMN_START THEN
             15651    4                CALL Z8AE$ERROR (%E$MUST_BE_IN_AREA_A,

  15651 32 003246   000066 236000 33                 LDQ     54
        32 003247   000175 756000 0                  STQ     INSERT_SIZE+4
        32 003250   000132 236000 xsym               LDQ     O1COM+90
        32 003251   000025 736000                    QLS     21
        32 003252   000071 036000 33                 ADLQ    57
        32 003253   000174 756000 0                  STQ     INSERT_SIZE+3
        32 003254   000132 236000 xsym               LDQ     O1COM+90
        32 003255   000025 736000                    QLS     21
        32 003256   000072 036000 33                 ADLQ    58
        32 003257   000075 235000 33                 LDA     61
        32 003260   000172 757000 0                  STAQ    INSERT_SIZE+1
        32 003261   000172 630400 0                  EPPR0   INSERT_SIZE+1
        32 003262   000061 631400 33                 EPPR1   49
        32 003263   000000 701000 xent               TSX1    Z8AE$ERROR
        32 003264   000000 011000                    NOP     0

             15652    4                                 O1COM.LA_STK.LINE (O1COM.LA_PUT),
             15653    4                                 O1COM.LA_STK.COLUMN (O1COM.LA_PUT),
             15654    4                                 DNT$);
             15655    4              O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = DNT$->DNT.RW_NO;

  15655 32 003265   000132 235000 xsym               LDA     O1COM+90
        32 003266   000003 735000                    ALS     3
        32 003267   000000 470400 17                 LDP0    DNT$
        32 003270   000003 236100                    LDQ     3,,PR0
        32 003271   777777 376007                    ANQ     -1,DL
        32 003272   000242 756005 xsym               STQ     O1COM+162,AL

             15656    5              DO CASE(O1COM.LA_STK.SYMBOL(O1COM.LA_PUT)) ;

  15656 32 003273   000132 235000 xsym               LDA     O1COM+90
        32 003274   000003 735000                    ALS     3
        32 003275   000242 235005 xsym               LDA     O1COM+162,AL
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:175  
        32 003276   000035 135007                    SBLA    29,DL
        32 003277   000725 115007                    CMPA    469,DL
        32 003300   003302 602005 32                 TNC     s:15656+7,AL
        32 003301   004307 710000 32                 TRA     s:15705
        32 003302   004247 710000 32                 TRA     s:15690
        32 003303   004307 710000 32                 TRA     s:15705
        32 003304   004307 710000 32                 TRA     s:15705
        32 003305   004247 710000 32                 TRA     s:15690
        32 003306   004307 710000 32                 TRA     s:15705
        32 003307   004307 710000 32                 TRA     s:15705
        32 003310   004307 710000 32                 TRA     s:15705
        32 003311   004307 710000 32                 TRA     s:15705
        32 003312   004307 710000 32                 TRA     s:15705
        32 003313   004307 710000 32                 TRA     s:15705
        32 003314   004307 710000 32                 TRA     s:15705
        32 003315   004307 710000 32                 TRA     s:15705
        32 003316   004307 710000 32                 TRA     s:15705
        32 003317   004307 710000 32                 TRA     s:15705
        32 003320   004307 710000 32                 TRA     s:15705
        32 003321   004307 710000 32                 TRA     s:15705
        32 003322   004307 710000 32                 TRA     s:15705
        32 003323   004247 710000 32                 TRA     s:15690
        32 003324   004307 710000 32                 TRA     s:15705
        32 003325   004307 710000 32                 TRA     s:15705
        32 003326   004307 710000 32                 TRA     s:15705
        32 003327   004307 710000 32                 TRA     s:15705
        32 003330   004307 710000 32                 TRA     s:15705
        32 003331   004307 710000 32                 TRA     s:15705
        32 003332   004307 710000 32                 TRA     s:15705
        32 003333   004307 710000 32                 TRA     s:15705
        32 003334   004307 710000 32                 TRA     s:15705
        32 003335   004307 710000 32                 TRA     s:15705
        32 003336   004307 710000 32                 TRA     s:15705
        32 003337   004307 710000 32                 TRA     s:15705
        32 003340   004307 710000 32                 TRA     s:15705
        32 003341   004232 710000 32                 TRA     s:15662
        32 003342   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:176  
        32 003343   004307 710000 32                 TRA     s:15705
        32 003344   004307 710000 32                 TRA     s:15705
        32 003345   004307 710000 32                 TRA     s:15705
        32 003346   004307 710000 32                 TRA     s:15705
        32 003347   004307 710000 32                 TRA     s:15705
        32 003350   004307 710000 32                 TRA     s:15705
        32 003351   004307 710000 32                 TRA     s:15705
        32 003352   004307 710000 32                 TRA     s:15705
        32 003353   004307 710000 32                 TRA     s:15705
        32 003354   004247 710000 32                 TRA     s:15690
        32 003355   004247 710000 32                 TRA     s:15690
        32 003356   004307 710000 32                 TRA     s:15705
        32 003357   004307 710000 32                 TRA     s:15705
        32 003360   004307 710000 32                 TRA     s:15705
        32 003361   004307 710000 32                 TRA     s:15705
        32 003362   004307 710000 32                 TRA     s:15705
        32 003363   004307 710000 32                 TRA     s:15705
        32 003364   004307 710000 32                 TRA     s:15705
        32 003365   004307 710000 32                 TRA     s:15705
        32 003366   004307 710000 32                 TRA     s:15705
        32 003367   004307 710000 32                 TRA     s:15705
        32 003370   004307 710000 32                 TRA     s:15705
        32 003371   004247 710000 32                 TRA     s:15690
        32 003372   004307 710000 32                 TRA     s:15705
        32 003373   004307 710000 32                 TRA     s:15705
        32 003374   004307 710000 32                 TRA     s:15705
        32 003375   004307 710000 32                 TRA     s:15705
        32 003376   004307 710000 32                 TRA     s:15705
        32 003377   004307 710000 32                 TRA     s:15705
        32 003400   004307 710000 32                 TRA     s:15705
        32 003401   004307 710000 32                 TRA     s:15705
        32 003402   004307 710000 32                 TRA     s:15705
        32 003403   004307 710000 32                 TRA     s:15705
        32 003404   004307 710000 32                 TRA     s:15705
        32 003405   004307 710000 32                 TRA     s:15705
        32 003406   004307 710000 32                 TRA     s:15705
        32 003407   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:177  
        32 003410   004307 710000 32                 TRA     s:15705
        32 003411   004307 710000 32                 TRA     s:15705
        32 003412   004307 710000 32                 TRA     s:15705
        32 003413   004307 710000 32                 TRA     s:15705
        32 003414   004307 710000 32                 TRA     s:15705
        32 003415   004307 710000 32                 TRA     s:15705
        32 003416   004307 710000 32                 TRA     s:15705
        32 003417   004247 710000 32                 TRA     s:15690
        32 003420   004307 710000 32                 TRA     s:15705
        32 003421   004247 710000 32                 TRA     s:15690
        32 003422   004307 710000 32                 TRA     s:15705
        32 003423   004307 710000 32                 TRA     s:15705
        32 003424   004307 710000 32                 TRA     s:15705
        32 003425   004247 710000 32                 TRA     s:15690
        32 003426   004307 710000 32                 TRA     s:15705
        32 003427   004307 710000 32                 TRA     s:15705
        32 003430   004307 710000 32                 TRA     s:15705
        32 003431   004307 710000 32                 TRA     s:15705
        32 003432   004307 710000 32                 TRA     s:15705
        32 003433   004307 710000 32                 TRA     s:15705
        32 003434   004307 710000 32                 TRA     s:15705
        32 003435   004307 710000 32                 TRA     s:15705
        32 003436   004307 710000 32                 TRA     s:15705
        32 003437   004307 710000 32                 TRA     s:15705
        32 003440   004307 710000 32                 TRA     s:15705
        32 003441   004227 710000 32                 TRA     s:15660
        32 003442   004227 710000 32                 TRA     s:15660
        32 003443   004307 710000 32                 TRA     s:15705
        32 003444   004307 710000 32                 TRA     s:15705
        32 003445   004307 710000 32                 TRA     s:15705
        32 003446   004307 710000 32                 TRA     s:15705
        32 003447   004307 710000 32                 TRA     s:15705
        32 003450   004307 710000 32                 TRA     s:15705
        32 003451   004307 710000 32                 TRA     s:15705
        32 003452   004307 710000 32                 TRA     s:15705
        32 003453   004307 710000 32                 TRA     s:15705
        32 003454   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:178  
        32 003455   004247 710000 32                 TRA     s:15690
        32 003456   004307 710000 32                 TRA     s:15705
        32 003457   004307 710000 32                 TRA     s:15705
        32 003460   004307 710000 32                 TRA     s:15705
        32 003461   004307 710000 32                 TRA     s:15705
        32 003462   004307 710000 32                 TRA     s:15705
        32 003463   004307 710000 32                 TRA     s:15705
        32 003464   004307 710000 32                 TRA     s:15705
        32 003465   004307 710000 32                 TRA     s:15705
        32 003466   004307 710000 32                 TRA     s:15705
        32 003467   004307 710000 32                 TRA     s:15705
        32 003470   004247 710000 32                 TRA     s:15690
        32 003471   004247 710000 32                 TRA     s:15690
        32 003472   004307 710000 32                 TRA     s:15705
        32 003473   004307 710000 32                 TRA     s:15705
        32 003474   004307 710000 32                 TRA     s:15705
        32 003475   004247 710000 32                 TRA     s:15690
        32 003476   004307 710000 32                 TRA     s:15705
        32 003477   004307 710000 32                 TRA     s:15705
        32 003500   004307 710000 32                 TRA     s:15705
        32 003501   004307 710000 32                 TRA     s:15705
        32 003502   004307 710000 32                 TRA     s:15705
        32 003503   004307 710000 32                 TRA     s:15705
        32 003504   004307 710000 32                 TRA     s:15705
        32 003505   004307 710000 32                 TRA     s:15705
        32 003506   004307 710000 32                 TRA     s:15705
        32 003507   004307 710000 32                 TRA     s:15705
        32 003510   004247 710000 32                 TRA     s:15690
        32 003511   004307 710000 32                 TRA     s:15705
        32 003512   004307 710000 32                 TRA     s:15705
        32 003513   004307 710000 32                 TRA     s:15705
        32 003514   004307 710000 32                 TRA     s:15705
        32 003515   004307 710000 32                 TRA     s:15705
        32 003516   004307 710000 32                 TRA     s:15705
        32 003517   004307 710000 32                 TRA     s:15705
        32 003520   004307 710000 32                 TRA     s:15705
        32 003521   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:179  
        32 003522   004307 710000 32                 TRA     s:15705
        32 003523   004307 710000 32                 TRA     s:15705
        32 003524   004307 710000 32                 TRA     s:15705
        32 003525   004307 710000 32                 TRA     s:15705
        32 003526   004307 710000 32                 TRA     s:15705
        32 003527   004307 710000 32                 TRA     s:15705
        32 003530   004307 710000 32                 TRA     s:15705
        32 003531   004307 710000 32                 TRA     s:15705
        32 003532   004307 710000 32                 TRA     s:15705
        32 003533   004307 710000 32                 TRA     s:15705
        32 003534   004307 710000 32                 TRA     s:15705
        32 003535   004307 710000 32                 TRA     s:15705
        32 003536   004307 710000 32                 TRA     s:15705
        32 003537   004307 710000 32                 TRA     s:15705
        32 003540   004307 710000 32                 TRA     s:15705
        32 003541   004307 710000 32                 TRA     s:15705
        32 003542   004307 710000 32                 TRA     s:15705
        32 003543   004307 710000 32                 TRA     s:15705
        32 003544   004247 710000 32                 TRA     s:15690
        32 003545   004307 710000 32                 TRA     s:15705
        32 003546   004307 710000 32                 TRA     s:15705
        32 003547   004247 710000 32                 TRA     s:15690
        32 003550   004307 710000 32                 TRA     s:15705
        32 003551   004247 710000 32                 TRA     s:15690
        32 003552   004307 710000 32                 TRA     s:15705
        32 003553   004307 710000 32                 TRA     s:15705
        32 003554   004247 710000 32                 TRA     s:15690
        32 003555   004307 710000 32                 TRA     s:15705
        32 003556   004307 710000 32                 TRA     s:15705
        32 003557   004307 710000 32                 TRA     s:15705
        32 003560   004307 710000 32                 TRA     s:15705
        32 003561   004307 710000 32                 TRA     s:15705
        32 003562   004307 710000 32                 TRA     s:15705
        32 003563   004307 710000 32                 TRA     s:15705
        32 003564   004307 710000 32                 TRA     s:15705
        32 003565   004307 710000 32                 TRA     s:15705
        32 003566   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:180  
        32 003567   004247 710000 32                 TRA     s:15690
        32 003570   004247 710000 32                 TRA     s:15690
        32 003571   004307 710000 32                 TRA     s:15705
        32 003572   004307 710000 32                 TRA     s:15705
        32 003573   004307 710000 32                 TRA     s:15705
        32 003574   004307 710000 32                 TRA     s:15705
        32 003575   004307 710000 32                 TRA     s:15705
        32 003576   004307 710000 32                 TRA     s:15705
        32 003577   004307 710000 32                 TRA     s:15705
        32 003600   004307 710000 32                 TRA     s:15705
        32 003601   004247 710000 32                 TRA     s:15690
        32 003602   004307 710000 32                 TRA     s:15705
        32 003603   004247 710000 32                 TRA     s:15690
        32 003604   004307 710000 32                 TRA     s:15705
        32 003605   004307 710000 32                 TRA     s:15705
        32 003606   004307 710000 32                 TRA     s:15705
        32 003607   004247 710000 32                 TRA     s:15690
        32 003610   004307 710000 32                 TRA     s:15705
        32 003611   004307 710000 32                 TRA     s:15705
        32 003612   004307 710000 32                 TRA     s:15705
        32 003613   004307 710000 32                 TRA     s:15705
        32 003614   004307 710000 32                 TRA     s:15705
        32 003615   004307 710000 32                 TRA     s:15705
        32 003616   004303 710000 32                 TRA     s:15703
        32 003617   004307 710000 32                 TRA     s:15705
        32 003620   004307 710000 32                 TRA     s:15705
        32 003621   004307 710000 32                 TRA     s:15705
        32 003622   004307 710000 32                 TRA     s:15705
        32 003623   004307 710000 32                 TRA     s:15705
        32 003624   004307 710000 32                 TRA     s:15705
        32 003625   004307 710000 32                 TRA     s:15705
        32 003626   004307 710000 32                 TRA     s:15705
        32 003627   004247 710000 32                 TRA     s:15690
        32 003630   004307 710000 32                 TRA     s:15705
        32 003631   004307 710000 32                 TRA     s:15705
        32 003632   004307 710000 32                 TRA     s:15705
        32 003633   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:181  
        32 003634   004307 710000 32                 TRA     s:15705
        32 003635   004307 710000 32                 TRA     s:15705
        32 003636   004247 710000 32                 TRA     s:15690
        32 003637   004247 710000 32                 TRA     s:15690
        32 003640   004307 710000 32                 TRA     s:15705
        32 003641   004307 710000 32                 TRA     s:15705
        32 003642   004247 710000 32                 TRA     s:15690
        32 003643   004237 710000 32                 TRA     s:15665
        32 003644   004307 710000 32                 TRA     s:15705
        32 003645   004307 710000 32                 TRA     s:15705
        32 003646   004307 710000 32                 TRA     s:15705
        32 003647   004307 710000 32                 TRA     s:15705
        32 003650   004307 710000 32                 TRA     s:15705
        32 003651   004307 710000 32                 TRA     s:15705
        32 003652   004307 710000 32                 TRA     s:15705
        32 003653   004307 710000 32                 TRA     s:15705
        32 003654   004307 710000 32                 TRA     s:15705
        32 003655   004307 710000 32                 TRA     s:15705
        32 003656   004307 710000 32                 TRA     s:15705
        32 003657   004307 710000 32                 TRA     s:15705
        32 003660   004307 710000 32                 TRA     s:15705
        32 003661   004307 710000 32                 TRA     s:15705
        32 003662   004307 710000 32                 TRA     s:15705
        32 003663   004307 710000 32                 TRA     s:15705
        32 003664   004307 710000 32                 TRA     s:15705
        32 003665   004307 710000 32                 TRA     s:15705
        32 003666   004307 710000 32                 TRA     s:15705
        32 003667   004307 710000 32                 TRA     s:15705
        32 003670   004307 710000 32                 TRA     s:15705
        32 003671   004307 710000 32                 TRA     s:15705
        32 003672   004307 710000 32                 TRA     s:15705
        32 003673   004307 710000 32                 TRA     s:15705
        32 003674   004307 710000 32                 TRA     s:15705
        32 003675   004307 710000 32                 TRA     s:15705
        32 003676   004307 710000 32                 TRA     s:15705
        32 003677   004307 710000 32                 TRA     s:15705
        32 003700   004303 710000 32                 TRA     s:15703
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:182  
        32 003701   004307 710000 32                 TRA     s:15705
        32 003702   004307 710000 32                 TRA     s:15705
        32 003703   004307 710000 32                 TRA     s:15705
        32 003704   004307 710000 32                 TRA     s:15705
        32 003705   004307 710000 32                 TRA     s:15705
        32 003706   004247 710000 32                 TRA     s:15690
        32 003707   004307 710000 32                 TRA     s:15705
        32 003710   004307 710000 32                 TRA     s:15705
        32 003711   004307 710000 32                 TRA     s:15705
        32 003712   004247 710000 32                 TRA     s:15690
        32 003713   004307 710000 32                 TRA     s:15705
        32 003714   004247 710000 32                 TRA     s:15690
        32 003715   004307 710000 32                 TRA     s:15705
        32 003716   004307 710000 32                 TRA     s:15705
        32 003717   004247 710000 32                 TRA     s:15690
        32 003720   004307 710000 32                 TRA     s:15705
        32 003721   004307 710000 32                 TRA     s:15705
        32 003722   004307 710000 32                 TRA     s:15705
        32 003723   004307 710000 32                 TRA     s:15705
        32 003724   004307 710000 32                 TRA     s:15705
        32 003725   004307 710000 32                 TRA     s:15705
        32 003726   004307 710000 32                 TRA     s:15705
        32 003727   004307 710000 32                 TRA     s:15705
        32 003730   004307 710000 32                 TRA     s:15705
        32 003731   004307 710000 32                 TRA     s:15705
        32 003732   004307 710000 32                 TRA     s:15705
        32 003733   004307 710000 32                 TRA     s:15705
        32 003734   004307 710000 32                 TRA     s:15705
        32 003735   004307 710000 32                 TRA     s:15705
        32 003736   004307 710000 32                 TRA     s:15705
        32 003737   004307 710000 32                 TRA     s:15705
        32 003740   004307 710000 32                 TRA     s:15705
        32 003741   004307 710000 32                 TRA     s:15705
        32 003742   004307 710000 32                 TRA     s:15705
        32 003743   004307 710000 32                 TRA     s:15705
        32 003744   004247 710000 32                 TRA     s:15690
        32 003745   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:183  
        32 003746   004307 710000 32                 TRA     s:15705
        32 003747   004307 710000 32                 TRA     s:15705
        32 003750   004307 710000 32                 TRA     s:15705
        32 003751   004307 710000 32                 TRA     s:15705
        32 003752   004307 710000 32                 TRA     s:15705
        32 003753   004307 710000 32                 TRA     s:15705
        32 003754   004307 710000 32                 TRA     s:15705
        32 003755   004307 710000 32                 TRA     s:15705
        32 003756   004307 710000 32                 TRA     s:15705
        32 003757   004307 710000 32                 TRA     s:15705
        32 003760   004307 710000 32                 TRA     s:15705
        32 003761   004247 710000 32                 TRA     s:15690
        32 003762   004307 710000 32                 TRA     s:15705
        32 003763   004307 710000 32                 TRA     s:15705
        32 003764   004307 710000 32                 TRA     s:15705
        32 003765   004244 710000 32                 TRA     s:15668
        32 003766   004307 710000 32                 TRA     s:15705
        32 003767   004307 710000 32                 TRA     s:15705
        32 003770   004307 710000 32                 TRA     s:15705
        32 003771   004307 710000 32                 TRA     s:15705
        32 003772   004307 710000 32                 TRA     s:15705
        32 003773   004247 710000 32                 TRA     s:15690
        32 003774   004307 710000 32                 TRA     s:15705
        32 003775   004307 710000 32                 TRA     s:15705
        32 003776   004307 710000 32                 TRA     s:15705
        32 003777   004307 710000 32                 TRA     s:15705
        32 004000   004307 710000 32                 TRA     s:15705
        32 004001   004307 710000 32                 TRA     s:15705
        32 004002   004307 710000 32                 TRA     s:15705
        32 004003   004307 710000 32                 TRA     s:15705
        32 004004   004307 710000 32                 TRA     s:15705
        32 004005   004307 710000 32                 TRA     s:15705
        32 004006   004247 710000 32                 TRA     s:15690
        32 004007   004307 710000 32                 TRA     s:15705
        32 004010   004303 710000 32                 TRA     s:15703
        32 004011   004307 710000 32                 TRA     s:15705
        32 004012   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:184  
        32 004013   004247 710000 32                 TRA     s:15690
        32 004014   004247 710000 32                 TRA     s:15690
        32 004015   004307 710000 32                 TRA     s:15705
        32 004016   004307 710000 32                 TRA     s:15705
        32 004017   004307 710000 32                 TRA     s:15705
        32 004020   004247 710000 32                 TRA     s:15690
        32 004021   004307 710000 32                 TRA     s:15705
        32 004022   004307 710000 32                 TRA     s:15705
        32 004023   004307 710000 32                 TRA     s:15705
        32 004024   004307 710000 32                 TRA     s:15705
        32 004025   004307 710000 32                 TRA     s:15705
        32 004026   004307 710000 32                 TRA     s:15705
        32 004027   004307 710000 32                 TRA     s:15705
        32 004030   004307 710000 32                 TRA     s:15705
        32 004031   004307 710000 32                 TRA     s:15705
        32 004032   004307 710000 32                 TRA     s:15705
        32 004033   004247 710000 32                 TRA     s:15690
        32 004034   004307 710000 32                 TRA     s:15705
        32 004035   004307 710000 32                 TRA     s:15705
        32 004036   004307 710000 32                 TRA     s:15705
        32 004037   004307 710000 32                 TRA     s:15705
        32 004040   004307 710000 32                 TRA     s:15705
        32 004041   004307 710000 32                 TRA     s:15705
        32 004042   004307 710000 32                 TRA     s:15705
        32 004043   004307 710000 32                 TRA     s:15705
        32 004044   004307 710000 32                 TRA     s:15705
        32 004045   004307 710000 32                 TRA     s:15705
        32 004046   004307 710000 32                 TRA     s:15705
        32 004047   004307 710000 32                 TRA     s:15705
        32 004050   004307 710000 32                 TRA     s:15705
        32 004051   004307 710000 32                 TRA     s:15705
        32 004052   004307 710000 32                 TRA     s:15705
        32 004053   004307 710000 32                 TRA     s:15705
        32 004054   004247 710000 32                 TRA     s:15690
        32 004055   004307 710000 32                 TRA     s:15705
        32 004056   004307 710000 32                 TRA     s:15705
        32 004057   004247 710000 32                 TRA     s:15690
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:185  
        32 004060   004307 710000 32                 TRA     s:15705
        32 004061   004307 710000 32                 TRA     s:15705
        32 004062   004307 710000 32                 TRA     s:15705
        32 004063   004307 710000 32                 TRA     s:15705
        32 004064   004307 710000 32                 TRA     s:15705
        32 004065   004307 710000 32                 TRA     s:15705
        32 004066   004307 710000 32                 TRA     s:15705
        32 004067   004307 710000 32                 TRA     s:15705
        32 004070   004307 710000 32                 TRA     s:15705
        32 004071   004247 710000 32                 TRA     s:15690
        32 004072   004307 710000 32                 TRA     s:15705
        32 004073   004227 710000 32                 TRA     s:15660
        32 004074   004307 710000 32                 TRA     s:15705
        32 004075   004307 710000 32                 TRA     s:15705
        32 004076   004307 710000 32                 TRA     s:15705
        32 004077   004247 710000 32                 TRA     s:15690
        32 004100   004307 710000 32                 TRA     s:15705
        32 004101   004307 710000 32                 TRA     s:15705
        32 004102   004307 710000 32                 TRA     s:15705
        32 004103   004307 710000 32                 TRA     s:15705
        32 004104   004307 710000 32                 TRA     s:15705
        32 004105   004247 710000 32                 TRA     s:15690
        32 004106   004307 710000 32                 TRA     s:15705
        32 004107   004307 710000 32                 TRA     s:15705
        32 004110   004307 710000 32                 TRA     s:15705
        32 004111   004307 710000 32                 TRA     s:15705
        32 004112   004307 710000 32                 TRA     s:15705
        32 004113   004307 710000 32                 TRA     s:15705
        32 004114   004307 710000 32                 TRA     s:15705
        32 004115   004303 710000 32                 TRA     s:15703
        32 004116   004307 710000 32                 TRA     s:15705
        32 004117   004307 710000 32                 TRA     s:15705
        32 004120   004307 710000 32                 TRA     s:15705
        32 004121   004307 710000 32                 TRA     s:15705
        32 004122   004307 710000 32                 TRA     s:15705
        32 004123   004307 710000 32                 TRA     s:15705
        32 004124   004247 710000 32                 TRA     s:15690
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:186  
        32 004125   004307 710000 32                 TRA     s:15705
        32 004126   004247 710000 32                 TRA     s:15690
        32 004127   004247 710000 32                 TRA     s:15690
        32 004130   004307 710000 32                 TRA     s:15705
        32 004131   004247 710000 32                 TRA     s:15690
        32 004132   004307 710000 32                 TRA     s:15705
        32 004133   004307 710000 32                 TRA     s:15705
        32 004134   004307 710000 32                 TRA     s:15705
        32 004135   004307 710000 32                 TRA     s:15705
        32 004136   004307 710000 32                 TRA     s:15705
        32 004137   004247 710000 32                 TRA     s:15690
        32 004140   004307 710000 32                 TRA     s:15705
        32 004141   004247 710000 32                 TRA     s:15690
        32 004142   004307 710000 32                 TRA     s:15705
        32 004143   004307 710000 32                 TRA     s:15705
        32 004144   004307 710000 32                 TRA     s:15705
        32 004145   004307 710000 32                 TRA     s:15705
        32 004146   004307 710000 32                 TRA     s:15705
        32 004147   004307 710000 32                 TRA     s:15705
        32 004150   004307 710000 32                 TRA     s:15705
        32 004151   004307 710000 32                 TRA     s:15705
        32 004152   004307 710000 32                 TRA     s:15705
        32 004153   004307 710000 32                 TRA     s:15705
        32 004154   004307 710000 32                 TRA     s:15705
        32 004155   004307 710000 32                 TRA     s:15705
        32 004156   004247 710000 32                 TRA     s:15690
        32 004157   004307 710000 32                 TRA     s:15705
        32 004160   004307 710000 32                 TRA     s:15705
        32 004161   004307 710000 32                 TRA     s:15705
        32 004162   004307 710000 32                 TRA     s:15705
        32 004163   004307 710000 32                 TRA     s:15705
        32 004164   004307 710000 32                 TRA     s:15705
        32 004165   004307 710000 32                 TRA     s:15705
        32 004166   004307 710000 32                 TRA     s:15705
        32 004167   004307 710000 32                 TRA     s:15705
        32 004170   004307 710000 32                 TRA     s:15705
        32 004171   004307 710000 32                 TRA     s:15705
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:187  
        32 004172   004307 710000 32                 TRA     s:15705
        32 004173   004307 710000 32                 TRA     s:15705
        32 004174   004307 710000 32                 TRA     s:15705
        32 004175   004307 710000 32                 TRA     s:15705
        32 004176   004307 710000 32                 TRA     s:15705
        32 004177   004307 710000 32                 TRA     s:15705
        32 004200   004247 710000 32                 TRA     s:15690
        32 004201   004307 710000 32                 TRA     s:15705
        32 004202   004307 710000 32                 TRA     s:15705
        32 004203   004307 710000 32                 TRA     s:15705
        32 004204   004307 710000 32                 TRA     s:15705
        32 004205   004307 710000 32                 TRA     s:15705
        32 004206   004307 710000 32                 TRA     s:15705
        32 004207   004307 710000 32                 TRA     s:15705
        32 004210   004307 710000 32                 TRA     s:15705
        32 004211   004307 710000 32                 TRA     s:15705
        32 004212   004307 710000 32                 TRA     s:15705
        32 004213   004307 710000 32                 TRA     s:15705
        32 004214   004307 710000 32                 TRA     s:15705
        32 004215   004307 710000 32                 TRA     s:15705
        32 004216   004307 710000 32                 TRA     s:15705
        32 004217   004307 710000 32                 TRA     s:15705
        32 004220   004307 710000 32                 TRA     s:15705
        32 004221   004307 710000 32                 TRA     s:15705
        32 004222   004307 710000 32                 TRA     s:15705
        32 004223   004307 710000 32                 TRA     s:15705
        32 004224   004307 710000 32                 TRA     s:15705
        32 004225   004247 710000 32                 TRA     s:15690
        32 004226   004303 710000 32                 TRA     s:15703

             15657    5                CASE( %RSV_WRD_DATE_COMPILED,

             15658    5                    %RSV_WRD_DATE_WRITTEN,
             15659    5                    %RSV_WRD_SECURITY);
             15660    5                  LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;

  15660 32 004227   000001 235007                    LDA     1,DL
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:188  
        32 004230   000000 755000 30                 STA     LEX_STATE
        32 004231   004307 710000 32                 TRA     s:15705

             15661    5                CASE(%RSV_WRD_AUTHOR);

             15662    5                       LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;

  15662 32 004232   000001 235007                    LDA     1,DL
        32 004233   000000 755000 30                 STA     LEX_STATE

             15663    5                       O1COM.AUTHOR_COMMENT = %TRUE;

  15663 32 004234   400000 236003                    LDQ     -131072,DU
        32 004235   000114 756000 xsym               STQ     O1COM+76
        32 004236   004307 710000 32                 TRA     s:15705

             15664    5                CASE(%RSV_WRD_INSTALLATION);

             15665    5                       LEX_STATE = %LS_PERIOD_BEFORE_COMMENT_ENTRY;

  15665 32 004237   000001 235007                    LDA     1,DL
        32 004240   000000 755000 30                 STA     LEX_STATE

             15666    5                       O1COM.INSTAL_ON = %TRUE;

  15666 32 004241   400000 236003                    LDQ     -131072,DU
        32 004242   000117 256000 xsym               ORSQ    O1COM+79
        32 004243   004307 710000 32                 TRA     s:15705

             15667    5                CASE(%RSV_WRD_PICTURE) ;

             15668    5                  LEX_STATE = %LS_PICTURE_OR_IS;

  15668 32 004244   000004 235007                    LDA     4,DL
        32 004245   000000 755000 30                 STA     LEX_STATE
        32 004246   004307 710000 32                 TRA     s:15705

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:189  
             15669    5                CASE(%RSV_WRD_ACCEPT,    %RSV_WRD_ADD,      %RSV_WRD_ALTER,

             15670    5                     %RSV_WRD_CALL,      %RSV_WRD_CANCEL,   %RSV_WRD_CLOSE,
             15671    5                     %RSV_WRD_COMPUTE,   %RSV_WRD_CONTINUE, %RSV_WRD_DELETE,
             15672    5                     %RSV_WRD_DISABLE,   %RSV_WRD_DIVIDE,   %RSV_WRD_ENABLE,
             15673    5                     %RSV_WRD_EVALUATE,  %RSV_WRD_EXAMINE,  %RSV_WRD_EXIT,
             15674    5                     %RSV_WRD_GO,        %RSV_WRD_GENERATE, %RSV_WRD_IF,
             15675    5                     %RSV_WRD_INITIATE,  %RSV_WRD_INITIALIZE,%RSV_WRD_INSPECT,
             15676    5                     %RSV_WRD_MERGE,     %RSV_WRD_MOVE,     %RSV_WRD_MULTIPLY,
             15677    5                     %RSV_WRD_OPEN,      %RSV_WRD_PERFORM,  %RSV_WRD_PURGE,
             15678    5                     %RSV_WRD_READ,      %RSV_WRD_RECEIVE,  %RSV_WRD_RELEASE,
             15679    5                     %RSV_WRD_RETURN,    %RSV_WRD_REWRITE,  %RSV_WRD_SEND,
             15680    5                     %RSV_WRD_SEARCH,    %RSV_WRD_START,    %RSV_WRD_SET,
             15681    5                     %RSV_WRD_STRING,    %RSV_WRD_STOP,     %RSV_WRD_SUBTRACT,
             15682    5                     %RSV_WRD_SUPPRESS,  %RSV_WRD_TERMINATE,%RSV_WRD_UNSTRING,
             15683    5                     %RSV_WRD_WRITE,
             15684    5                     %RSV_WRD_CONNECT,   %RSV_WRD_DISCONNECT,%RSV_WRD_ERASE,
             15685    5                     %RSV_WRD_FIND,      %RSV_WRD_FINISH,   %RSV_WRD_GET,
             15686    5                     %RSV_WRD_MODIFY,    %RSV_WRD_PRECALCULATE,
             15687    5                     %RSV_WRD_READY,    %RSV_WRD_STORE);
             15688                       %SAVE_IMPERATIVE_STMT_RSV_WRD ;
             15689    6          DO ;

             15690    6             SAVED_SYMBOL = O1COM.LA_STK(O1COM.LA_PUT);

  15690 32 004247   000132 235000 xsym               LDA     O1COM+90
        32 004250   000005 735000                    ALS     5
        32 004251   000000 100405                    MLR     fill='000'O
        32 004252   000237 000040 xsym               ADSC9   O1COM+159,A              cn=0,n=32
        32 004253   000011 000040 0                  ADSC9   SAVED_SYMBOL             cn=0,n=32

             15691    6             SAVED_LEX_STATE = %LS_NORMAL;

  15691 32 004254   000021 450000 0                  STZ     SAVED_LEX_STATE

             15692    6             O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %INVISIBLE_STMT_START ;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:190  
  15692 32 004255   000132 236000 xsym               LDQ     O1COM+90
        32 004256   000003 736000                    QLS     3
        32 004257   000034 235007                    LDA     28,DL
        32 004260   000242 755006 xsym               STA     O1COM+162,QL

             15693    6             O1COM.LA_STK.DNT$(O1COM.LA_PUT) = ADDR(NIL) ;

  15693 32 004261   000132 236000 xsym               LDQ     O1COM+90
        32 004262   000003 736000                    QLS     3
        32 004263   000000 620006                    EAX0    0,QL
        32 004264   000000 236000 33                 LDQ     0
        32 004265   000241 756010 xsym               STQ     O1COM+161,X0

             15694    6             O1COM.LA_STK.FLAGS(O1COM.LA_PUT) = FALSE;

  15694 32 004266   000132 235000 xsym               LDA     O1COM+90
        32 004267   000003 735000                    ALS     3
        32 004270   000000 220003                    LDX0    0,DU
        32 004271   000237 440005 xsym               SXL0    O1COM+159,AL

             15695    6             O1COM.LA_STK.ST$(O1COM.LA_PUT) = ADDR(NIL);

  15695 32 004272   000132 235000 xsym               LDA     O1COM+90
        32 004273   000003 735000                    ALS     3
        32 004274   000240 756005 xsym               STQ     O1COM+160,AL

             15696    6             O1COM.LA_STK.TYPE(O1COM.LA_PUT) = 0;

  15696 32 004275   000132 235000 xsym               LDA     O1COM+90
        32 004276   000003 735000                    ALS     3
        32 004277   000243 450005 xsym               STZ     O1COM+163,AL

             15697                  /* Leave line and column the same */
             15698    6             LEX_STATE = %LS_PICK_UP_SAVED_SYMBOL;

  15698 32 004300   000003 235007                    LDA     3,DL
        32 004301   000000 755000 30                 STA     LEX_STATE
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:191  

             15699    6          END ;

  15699 32 004302   004307 710000 32                 TRA     s:15705

             15701    5                CASE(%RSV_WRD_QUOTES,    %RSV_WRD_LOW_VALUES,

             15702    5                     %RSV_WRD_SPACES,    %RSV_WRD_ZEROES,     %RSV_WRD_HIGH_VALUES);
             15703    5                  O1COM.LA_STK.TYPE(O1COM.LA_PUT) = %TYT;

  15703 32 004303   000132 235000 xsym               LDA     O1COM+90
        32 004304   000003 735000                    ALS     3
        32 004305   000015 236007                    LDQ     13,DL
        32 004306   000243 756005 xsym               STQ     O1COM+163,AL

             15704    5              END ;

             15705    4              IF NOT LEX_SYMBOL.B.CONTINUED_TOKEN THEN

  15705 32 004307   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 004310   040000 316003                    CANQ    16384,DU
        32 004311   004473 601000 32                 TNZ     s:15818

             15706    4                SAVED_CONT_FLAG = FALSE;

  15706 32 004312   000022 450000 0                  STZ     SAVED_CONT_FLAG

             15707    4            END ;

  15707 32 004313   004473 710000 32                 TRA     s:15818

      796    15709    3       ELSE
      797    15710              %PROCESS_USER_WORD;
             15711    4            DO;

             15712                   /* for user word */
             15713    4              DNT$ -> DNT.B.USER_WORD = TRUE;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:192  

  15713 32 004314   200000 236003                    LDQ     65536,DU
        32 004315   000003 256100                    ORSQ    3,,PR0

             15714                   /* Check to make sure userword does not end in dash */
             15715    4              IF SUBSTR(LEX_SYMBOL.SYMBOL,

  15715 32 004316   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 004317   040000 106405                    CMPC    fill='040'O
        32 004320   000010 600001 2                  ADSC9   LEX_SYMBOL+8,A           cn=3,n=1
        32 004321   000076 000001 33                 ADSC9   62                       cn=0,n=1
        32 004322   004327 601000 32                 TNZ     s:15724

             15716    4                        LEX_SYMBOL.SIZE - 1,
             15717    4                        1) = '-' THEN
             15718    5                DO;

             15719    5                  CALL Z8AE$ERROR (%E$USERWORD_END_DASH_ERROR,

  15719 32 004323   000100 630400 33                 EPPR0   64
        32 004324   000011 631400 33                 EPPR1   9
        32 004325   000000 701000 xent               TSX1    Z8AE$ERROR
        32 004326   000000 011000                    NOP     0

             15720    5                                   LEX_SYMBOL.LINE,
             15721    5                                   LEX_SYMBOL.COLUMN);
             15722    5                END;

             15723                   /* Check to make sure userword <= 30 characters */
             15724    4              IF LEX_SYMBOL.SIZE > %USER_WORD_MAX_SIZE

  15724 32 004327   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 004330   000036 115007                    CMPA    30,DL
        32 004331   004345 604400 32                 TMOZ    s:15754
        32 004332   000013 234000 xsym               SZN     O1COM+11
        32 004333   004345 604000 32                 TMI     s:15754

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:193  
             15725    4                      AND NOT O1COM.PD_FLAG THEN
             15726    5                DO;

             15727    5                  CALL Z8AE$ERROR (%E$USERWORD_TOO_LONG,

  15727 32 004334   000104 630400 33                 EPPR0   68
        32 004335   000011 631400 33                 EPPR1   9
        32 004336   000000 701000 xent               TSX1    Z8AE$ERROR
        32 004337   000000 011000                    NOP     0

             15728    5                                   LEX_SYMBOL.LINE,
             15729    5                                   LEX_SYMBOL.COLUMN);
             15730    5                  LEX_SYMBOL.SIZE = 30;

  15730 32 004340   000036 235007                    LDA     30,DL
        32 004341   000010 755000 2                  STA     LEX_SYMBOL+8

             15731    5                  DNT$ -> DNT.TEXT.LENGTH = 30;

  15731 32 004342   000036 220003                    LDX0    30,DU
        32 004343   000000 470400 17                 LDP0    DNT$
        32 004344   000004 740100                    STX0    4,,PR0

             15732    5                END;

             15733                   /* Check for at least one letter in userword */
             15734              /* Check was disabled because paragraph names do not have to
             15735                    contain letters in the name.  Therefore, the check must
             15736                    either be:
             15737                       1) done after the parse to differentiate between
             15738                            paragraph names and data names.
             15739                       2) Change user word that contain no letters to be
             15740                            paragraph names
             15741                       3) Disabled completely.
             15742                   CALL SEARCH (CHAR_COLUMN,
             15743                                CHAR_CLASS,
             15744                                LETTER_SEARCH_TABLE,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:194  
             15745                                SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE));
             15746                   IF CHAR_CLASS = %END_OF_LINE THEN
             15747                     DO;
             15748                       CALL Z8AE$ERROR (%E$NO_LETTER_USERWORD,
             15749                                        LEX_SYMBOL.LINE,
             15750                                        LEX_SYMBOL.COLUMN);
             15751                     END;
             15752              */
             15753                   /* Check for no $ or _ if ANSI option */
             15754    4              IF COMCOM.OB.FIPS.LEVEL > 0 THEN

  15754 32 004345   000036 720000 xsym               LXL0    COMCOM+30
        32 004346   004365 604400 32                 TMOZ    s:15767

             15755    5                DO;

             15756    5                  CALL SEARCH (CHAR_COLUMN,

  15756 32 004347   000010 721000 2                  LXL1    LEX_SYMBOL+8
        32 004350   000000 164440                    TCT
        32 004351   000011 000011 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X1
        32 004352   000000 000000 xsym               ARG     ANSI_USERWORD_SCAN_TABLE
        32 004353   000023 000000 0                  ARG     CHAR_COLUMN
        32 004354   000023 235000 0                  LDA     CHAR_COLUMN
        32 004355   000033 771000                    ARL     27
        32 004356   000024 755000 0                  STA     CHAR_CLASS
        32 004357   000023 551040 0                  STBA    CHAR_COLUMN,'40'O

             15757    5                               CHAR_CLASS,
             15758    5                               ANSI_USERWORD_SCAN_TABLE,
             15759    5                               SUBSTR(LEX_SYMBOL.SYMBOL,
             15760    5                                      0,
             15761    5                                      LEX_SYMBOL.SIZE));
             15762    5                  IF CHAR_CLASS ~= %END_OF_LINE THEN

  15762 32 004360   004365 600000 32                 TZE     s:15767

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:195  
             15763    5                    CALL Z8AE$ERROR (%E$USERWORD_ANSI_ERROR,

  15763 32 004361   000110 630400 33                 EPPR0   72
        32 004362   000011 631400 33                 EPPR1   9
        32 004363   000000 701000 xent               TSX1    Z8AE$ERROR
        32 004364   000000 011000                    NOP     0

             15764    5                                     LEX_SYMBOL.LINE,
             15765    5                                     LEX_SYMBOL.COLUMN);
             15766    5                END;

             15767    4              IF O1COM.LA_STK.COLUMN(O1COM.LA_PUT) < O1COM.AREA_B_COLUMN_START THEN

  15767 32 004365   000132 235000 xsym               LDA     O1COM+90
        32 004366   000003 735000                    ALS     3
        32 004367   000245 236005 xsym               LDQ     O1COM+165,AL
        32 004370   004403 604000 32                 TMI     s:15776
        32 004371   000121 116000 xsym               CMPQ    O1COM+81
        32 004372   004403 605000 32                 TPL     s:15776

             15768    5                DO;

             15769                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
             15770    5                    IF O1COM.PD_FLAG THEN

  15770 32 004373   000013 234000 xsym               SZN     O1COM+11
        32 004374   004400 605000 32                 TPL     s:15773

             15771    5                      O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_DEF;

  15771 32 004375   000030 236007                    LDQ     24,DL
        32 004376   000242 756005 xsym               STQ     O1COM+162,AL
        32 004377   004424 710000 32                 TRA     s:15789

             15772    5                    ELSE
             15773    5                      O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:196  
  15773 32 004400   000027 236007                    LDQ     23,DL
        32 004401   000242 756005 xsym               STQ     O1COM+162,AL

             15774    5                END;

  15774 32 004402   004424 710000 32                 TRA     s:15789

             15775    4              ELSE
             15776    4                IF (O1COM.LA_STK.ST$(O1COM.LA_PUT) ~= ADDR(NIL))

  15776 32 004403   000240 236005 xsym               LDQ     O1COM+160,AL
        32 004404   000000 116000 33                 CMPQ    0
        32 004405   004422 600000 32                 TZE     s:15784
        32 004406   000240 470405 xsym               LDP0    O1COM+160,AL
        32 004407   000000 220100                    LDX0    0,,PR0
        32 004410   000771 100003                    CMPX0   505,DU
        32 004411   004414 600000 32                 TZE     s:15776+9
        32 004412   000770 100003                    CMPX0   504,DU
        32 004413   004422 601000 32                 TNZ     s:15784
        32 004414   000011 236100                    LDQ     9,,PR0
        32 004415   000057 116000 xsym               CMPQ    O1COM+47
        32 004416   004422 601000 32                 TNZ     s:15784

             15777    4                AND ((O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %PARA
             15778    4                         OR
             15779    4                     O1COM.LA_STK.ST$(O1COM.LA_PUT) -> ST.ID = %SECTION)
             15780    4                     AND O1COM.LA_STK.ST$(O1COM.LA_PUT) -> VARIABLE.PROC$ = O1COM.
             15780                              CURRENT_PROC$) THEN
             15781    4                  O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %PARA_REF;

  15781 32 004417   000031 236007                    LDQ     25,DL
        32 004420   000242 756005 xsym               STQ     O1COM+162,AL
        32 004421   004424 710000 32                 TRA     s:15789

             15782    4                ELSE
             15783                       /*N* Free_Format -- IF NOT COMCOM.OB.FORMAT THEN */
             15784    4                    O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:197  

  15784 32 004422   000027 236007                    LDQ     23,DL
        32 004423   000242 756005 xsym               STQ     O1COM+162,AL

             15785                     /*N* Free_Format --
             15786                       ELSE
             15787                         O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %NAME_OR_PARA;
             15788                     */
             15789    4              IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) ~= ADDR(NIL) THEN

  15789 32 004424   000132 235000 xsym               LDA     O1COM+90
        32 004425   000003 735000                    ALS     3
        32 004426   000240 236005 xsym               LDQ     O1COM+160,AL
        32 004427   000000 116000 33                 CMPQ    0
        32 004430   004461 600000 32                 TZE     s:15802

             15790    4                IF O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> ST.ID = %SYM_CHAR THEN

  15790 32 004431   000240 470405 xsym               LDP0    O1COM+160,AL
        32 004432   000000 220100                    LDX0    0,,PR0
        32 004433   001001 100003                    CMPX0   513,DU
        32 004434   004461 601000 32                 TNZ     s:15802

             15791    5   CHECK_SYM_CHAR: DO;

  15791 32 004435                       CHECK_SYM_C* null
             15792    5                     PROC$$ = O1COM.CURRENT_PROC$;

  15792 32 004435   000057 236000 xsym               LDQ     O1COM+47
        32 004436   000027 756000 0                  STQ     PROC$$

             15793    6                     DO WHILE (O1COM.LA_STK.ST$ (O1COM.LA_PUT) -> VARIABLE.PROC$ ~=

  15793 32 004437   000011 116100                    CMPQ    9,,PR0
        32 004440   004453 600000 32                 TZE     s:15799

             15794    6                         PROC$$);
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:198  
             15795    6                       PROC$$ = PROC$$ -> PROC_.FATHER;

  15795 32 004441   000027 470400 0                  LDP0    PROC$$
        32 004442   000011 236100                    LDQ     9,,PR0
        32 004443   000027 756000 0                  STQ     PROC$$

             15796    6                       IF PROC$$ = ADDR(NIL) THEN

  15796 32 004444   000000 116000 33                 CMPQ    0
        32 004445   004461 600000 32                 TZE     s:15802

             15797    6                         EXIT CHECK_SYM_CHAR;
             15798    6                     END; /* WHILE */

  15798 32 004446   000132 235000 xsym               LDA     O1COM+90
        32 004447   000003 735000                    ALS     3
        32 004450   000240 470405 xsym               LDP0    O1COM+160,AL
        32 004451   000011 116100                    CMPQ    9,,PR0
        32 004452   004441 601000 32                 TNZ     s:15795

             15799    5                     O1COM.LA_STK.B.ALL  (O1COM.LA_PUT) = TRUE;

  15799 32 004453   040000 236007                    LDQ     16384,DL
        32 004454   000237 256005 xsym               ORSQ    O1COM+159,AL

             15800    5                     O1COM.LA_STK.SYMBOL (O1COM.LA_PUT) = %ALPHA_LITERAL;

  15800 32 004455   000132 235000 xsym               LDA     O1COM+90
        32 004456   000003 735000                    ALS     3
        32 004457   000003 236007                    LDQ     3,DL
        32 004460   000242 756005 xsym               STQ     O1COM+162,AL

             15801    5                   END; /* CHECK_SYM_CHAR */

             15802    4              SAVED_CONT_FLAG = FALSE;

  15802 32 004461   000022 450000 0                  STZ     SAVED_CONT_FLAG
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:199  

             15803    4             END;

  15803 32 004462   004473 710000 32                 TRA     s:15818

      798    15805
      799    15806
      800    15807
      801    15808    3     CASE(ELSE);

      802    15809
      803    15810    3       CALL Z8AE$ERROR(%E$SCANNER_FAILURE,

  15810 32 004463   000114 630400 33                 EPPR0   76
        32 004464   000011 631400 33                 EPPR1   9
        32 004465   000000 701000 xent               TSX1    Z8AE$ERROR
        32 004466   000000 011000                    NOP     0

      804    15811    3                       LEX_SYMBOL.LINE,
      805    15812    3                       LEX_SYMBOL.COLUMN);
      806    15813    3       O1COM.LA_STK.SYMBOL(O1COM.LA_PUT) = %ILLEGAL_SYMBOL;

  15813 32 004467   000132 235000 xsym               LDA     O1COM+90
        32 004470   000003 735000                    ALS     3
        32 004471   000033 236007                    LDQ     27,DL
        32 004472   000242 756005 xsym               STQ     O1COM+162,AL

      807    15814
      808    15815    3   END;  /* DO CASE ON LEX_SYMBOL.TYPE */

      809    15816
      810    15817
      811    15818    2   END PROCESS_SYMBOL;

  15818 32 004473   000167 221200 0                  LDX1  ! CONTINUATION_ISN+1
        32 004474   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:200  
      812    15819        %EJECT ;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:201  
      813    15820    1   CONSOLIDATE_PICTURE_STRING : PROC;

  15820 32 004475   000170 741200 0     CONSOLIDATE* STX1  ! CONTINUATION_ISN+2

      814    15821
      815    15822    2     DCL INSERT_SIZE SBIN WORD;
      816    15823
      817    15824    2     PICTURE_SYMBOL             = LEX_SYMBOL;

  15824 32 004476   000000 100400                    MLR     fill='000'O
        32 004477   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360
        32 004500   000030 000550 0                  ADSC9   PICTURE_SYMBOL           cn=0,n=360

      818    15825    2     PICTURE_SYMBOL.TYPE        = %PICTURE_STRING;

  15825 32 004501   000032 235007                    LDA     26,DL
        32 004502   000031 755000 0                  STA     PICTURE_SYMBOL+1

      819    15826    2     PICTURE_SYMBOL.END_COLUMN  = LEX_SYMBOL.COLUMN;

  15826 32 004503   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 004504   000037 756000 0                  STQ     PICTURE_SYMBOL+7

      820    15827    2     PICTURE_SYMBOL.END_LINE    = LEX_SYMBOL.LINE;

  15827 32 004505   000004 235000 2                  LDA     LEX_SYMBOL+4
        32 004506   000036 755000 0                  STA     PICTURE_SYMBOL+6

      821    15828    2     PICTURE_SYMBOL.SIZE        = 0;

  15828 32 004507   000040 450000 0                  STZ     PICTURE_SYMBOL+8

      822    15829    2     PARSING_PICTURE = TRUE;

  15829 32 004510   400000 236003                    LDQ     -131072,DU
        32 004511   000162 756000 0                  STQ     PARSING_PICTURE

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:202  
      823    15830
      824    15831    3     DO WHILE (PICTURE_SYMBOL.END_COLUMN = LEX_SYMBOL.COLUMN)

  15831 32 004512   004543 710000 32                 TRA     s:15852

      825    15832    3               AND (PICTURE_SYMBOL.END_LINE = LEX_SYMBOL.LINE)
      826    15833    3               AND (LEX_SYMBOL.TYPE ~= %PERIOD);
      827    15834
      828    15835    3       INSERT_SIZE = MINIMUM(%MAX_SYMBOL_SIZE - PICTURE_SYMBOL.SIZE,

  15835 32 004513   000502 236007                    LDQ     322,DL
        32 004514   000040 136000 0                  SBLQ    PICTURE_SYMBOL+8
        32 004515   000010 116000 2                  CMPQ    LEX_SYMBOL+8
        32 004516   004520 604400 32                 TMOZ    s:15835+5
        32 004517   000010 236000 2                  LDQ     LEX_SYMBOL+8
        32 004520   000171 756000 0                  STQ     INSERT_SIZE

      829    15836    3                             LEX_SYMBOL.SIZE);
      830    15837
      831    15838    3       PICTURE_SYMBOL.SIZE = PICTURE_SYMBOL.SIZE + INSERT_SIZE;

  15838 32 004521   000040 036000 0                  ADLQ    PICTURE_SYMBOL+8
        32 004522   000040 756000 0                  STQ     PICTURE_SYMBOL+8

      832    15839
      833    15840    3       CALL INSERT (PICTURE_SYMBOL.SYMBOL,

  15840 32 004523   000171 136000 0                  SBLQ    INSERT_SIZE
        32 004524   000171 720000 0                  LXL0    INSERT_SIZE
        32 004525   040046 100400                    MLR     fill='040'O
        32 004526   000011 000504 2                  ADSC9   LEX_SYMBOL+9             cn=0,n=324
        32 004527   000041 000010 0                  ADSC9   PICTURE_SYMBOL+9,Q       cn=0,n=*X0

      834    15841    3                    PICTURE_SYMBOL.SIZE - INSERT_SIZE,
      835    15842    3                    INSERT_SIZE,
      836    15843    3                    LEX_SYMBOL.SYMBOL);
      837    15844
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:203  
      838    15845    3       PICTURE_SYMBOL.END_COLUMN = LEX_SYMBOL.END_COLUMN;

  15845 32 004530   000007 235000 2                  LDA     LEX_SYMBOL+7
        32 004531   000037 755000 0                  STA     PICTURE_SYMBOL+7

      839    15846    3       PICTURE_SYMBOL.END_LINE   = LEX_SYMBOL.END_LINE;

  15846 32 004532   000006 236000 2                  LDQ     LEX_SYMBOL+6
        32 004533   000036 756000 0                  STQ     PICTURE_SYMBOL+6

      840    15847    3       CALL REPLACED_TOKEN;

  15847 32 004534   000014 701000 32                 TSX1    REPLACED_TOKEN
        32 004535   000000 011000                    NOP     0

      841    15848
      842    15849    3       IF LEX_SYMBOL.B.CONTINUED_TOKEN THEN

  15849 32 004536   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 004537   040000 316003                    CANQ    16384,DU
        32 004540   004543 600000 32                 TZE     s:15852

      843    15850    3           PICTURE_SYMBOL.B.CONTINUED_TOKEN = TRUE;

  15850 32 004541   040000 236003                    LDQ     16384,DU
        32 004542   000032 256000 0                  ORSQ    PICTURE_SYMBOL+2

      844    15851
      845    15852    3     END;  /* DO WHILE */

  15852 32 004543   000037 236000 0                  LDQ     PICTURE_SYMBOL+7
        32 004544   000005 116000 2                  CMPQ    LEX_SYMBOL+5
        32 004545   004554 601000 32                 TNZ     s:15854
        32 004546   000036 236000 0                  LDQ     PICTURE_SYMBOL+6
        32 004547   000004 116000 2                  CMPQ    LEX_SYMBOL+4
        32 004550   004554 601000 32                 TNZ     s:15854
        32 004551   000001 235000 2                  LDA     LEX_SYMBOL+1
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:204  
        32 004552   000014 115007                    CMPA    12,DL
        32 004553   004513 601000 32                 TNZ     s:15835

      846    15853
      847    15854    2     IF SAVED_CONT_FLAG THEN

  15854 32 004554   000022 234000 0                  SZN     SAVED_CONT_FLAG
        32 004555   004560 605000 32                 TPL     s:15857

      848    15855    2       PICTURE_SYMBOL.B.CONTINUED_TOKEN = TRUE;

  15855 32 004556   040000 236003                    LDQ     16384,DU
        32 004557   000032 256000 0                  ORSQ    PICTURE_SYMBOL+2

      849    15856
      850    15857    2     IF PICTURE_SYMBOL.SIZE = 0 THEN

  15857 32 004560   000040 235000 0                  LDA     PICTURE_SYMBOL+8
        32 004561   004567 601000 32                 TNZ     s:15863

      851    15858    3       DO;

      852    15859    3         PICTURE_SYMBOL      = LEX_SYMBOL;

  15859 32 004562   000000 100400                    MLR     fill='000'O
        32 004563   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360
        32 004564   000030 000550 0                  ADSC9   PICTURE_SYMBOL           cn=0,n=360

      853    15860    3         PICTURE_SYMBOL.TYPE = %ILLEGAL_SYMBOL;

  15860 32 004565   000033 235007                    LDA     27,DL
        32 004566   000031 755000 0                  STA     PICTURE_SYMBOL+1

      854    15861    3       END;

      855    15862
      856    15863    2     LEX_STATE = %LS_NORMAL;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:205  

  15863 32 004567   000000 450000 30                 STZ     LEX_STATE

      857    15864    2     PARSING_PICTURE = FALSE;

  15864 32 004570   000162 450000 0                  STZ     PARSING_PICTURE

      858    15865          %INITIALIZE_LA_STK_ITEM;
             15866    3     DO;

             15867            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             15868                                @LA_ITEM = TRUE,
             15869                                @SYMBOL = LEX_SYMBOL.TYPE,
             15870                                @LINE = LEX_SYMBOL.LINE,
             15871                                @COLUMN = LEX_SYMBOL.COLUMN);
             15872    4     DO;

             15873    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;

  15873 32 004571   000132 235000 xsym               LDA     O1COM+90
        32 004572   000003 735000                    ALS     3
        32 004573   000000 220003                    LDX0    0,DU
        32 004574   000237 740005 xsym               STX0    O1COM+159,AL

             15874    4       @POINTER -> LX_TERMINAL.B      = '0'B;

  15874 32 004575   000132 235000 xsym               LDA     O1COM+90
        32 004576   000003 735000                    ALS     3
        32 004577   000000 221003                    LDX1    0,DU
        32 004600   000237 441005 xsym               SXL1    O1COM+159,AL

             15875            %IF (TEXTCHAR(@BERROR) ~= '');
             15877            %ENDIF;
             15878    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;

  15878 32 004601   000132 235000 xsym               LDA     O1COM+90
        32 004602   000003 735000                    ALS     3
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:206  
        32 004603   000015 236007                    LDQ     13,DL
        32 004604   000243 756005 xsym               STQ     O1COM+163,AL

             15879            %IF (TEXTCHAR(@LA_ITEM) = '');
             15881            %ENDIF;
             15882    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;

  15882 32 004605   000132 235000 xsym               LDA     O1COM+90
        32 004606   000003 735000                    ALS     3
        32 004607   000000 236000 33                 LDQ     0
        32 004610   000240 756005 xsym               STQ     O1COM+160,AL

             15883    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;

  15883 32 004611   000132 235000 xsym               LDA     O1COM+90
        32 004612   000003 735000                    ALS     3
        32 004613   000001 236000 2                  LDQ     LEX_SYMBOL+1
        32 004614   000242 756005 xsym               STQ     O1COM+162,AL

             15884    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;

  15884 32 004615   000132 235000 xsym               LDA     O1COM+90
        32 004616   000003 735000                    ALS     3
        32 004617   000000 236000 33                 LDQ     0
        32 004620   000241 756005 xsym               STQ     O1COM+161,AL

             15885    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;

  15885 32 004621   000132 235000 xsym               LDA     O1COM+90
        32 004622   000003 735000                    ALS     3
        32 004623   000004 236000 2                  LDQ     LEX_SYMBOL+4
        32 004624   000244 756005 xsym               STQ     O1COM+164,AL

             15886    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;

  15886 32 004625   000132 235000 xsym               LDA     O1COM+90
        32 004626   000003 735000                    ALS     3
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:207  
        32 004627   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 004630   000245 756005 xsym               STQ     O1COM+165,AL

             15887    4     END;

             15889    3     END;

      859    15891    2     CALL PROCESS_SYMBOL;

  15891 32 004631   001632 701000 32                 TSX1    PROCESS_SYMBOL
        32 004632   000000 011000                    NOP     0

      860    15892    2     SAVED_SYMBOL          = O1COM.LA_STK(O1COM.LA_PUT);

  15892 32 004633   000132 235000 xsym               LDA     O1COM+90
        32 004634   000005 735000                    ALS     5
        32 004635   000000 100405                    MLR     fill='000'O
        32 004636   000237 000040 xsym               ADSC9   O1COM+159,A              cn=0,n=32
        32 004637   000011 000040 0                  ADSC9   SAVED_SYMBOL             cn=0,n=32

      861    15893                                                                 /*#29924*/
      862    15894    2     IF LEX_STATE ~= %LS_PICK_UP_SAVED_SYMBOL  THEN

  15894 32 004640   000000 236000 30                 LDQ     LEX_STATE
        32 004641   000003 116007                    CMPQ    3,DL
        32 004642   004644 600000 32                 TZE     s:15896

      863    15895    2       SAVED_LEX_STATE = LEX_STATE;

  15895 32 004643   000021 756000 0                  STQ     SAVED_LEX_STATE

      864    15896    2     LEX_STATE             = %LS_PICK_UP_SAVED_SYMBOL;

  15896 32 004644   000003 235007                    LDA     3,DL
        32 004645   000000 755000 30                 STA     LEX_STATE

      865    15897    2     LEX_SYMBOL            = PICTURE_SYMBOL;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:208  

  15897 32 004646   000000 100400                    MLR     fill='000'O
        32 004647   000030 000550 0                  ADSC9   PICTURE_SYMBOL           cn=0,n=360
        32 004650   000000 000550 2                  ADSC9   LEX_SYMBOL               cn=0,n=360

      866    15898          %INITIALIZE_LA_STK_ITEM;
             15899    3     DO;

             15900            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             15901                                @LA_ITEM = TRUE,
             15902                                @SYMBOL = LEX_SYMBOL.TYPE,
             15903                                @LINE = LEX_SYMBOL.LINE,
             15904                                @COLUMN = LEX_SYMBOL.COLUMN);
             15905    4     DO;

             15906    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;

  15906 32 004651   000132 236000 xsym               LDQ     O1COM+90
        32 004652   000003 736000                    QLS     3
        32 004653   000000 220003                    LDX0    0,DU
        32 004654   000237 740006 xsym               STX0    O1COM+159,QL

             15907    4       @POINTER -> LX_TERMINAL.B      = '0'B;

  15907 32 004655   000132 236000 xsym               LDQ     O1COM+90
        32 004656   000003 736000                    QLS     3
        32 004657   000000 221003                    LDX1    0,DU
        32 004660   000237 441006 xsym               SXL1    O1COM+159,QL

             15908            %IF (TEXTCHAR(@BERROR) ~= '');
             15910            %ENDIF;
             15911    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;

  15911 32 004661   000132 236000 xsym               LDQ     O1COM+90
        32 004662   000003 736000                    QLS     3
        32 004663   000015 235007                    LDA     13,DL
        32 004664   000243 755006 xsym               STA     O1COM+163,QL
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:209  

             15912            %IF (TEXTCHAR(@LA_ITEM) = '');
             15914            %ENDIF;
             15915    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;

  15915 32 004665   000132 236000 xsym               LDQ     O1COM+90
        32 004666   000003 736000                    QLS     3
        32 004667   000000 622006                    EAX2    0,QL
        32 004670   000000 236000 33                 LDQ     0
        32 004671   000240 756012 xsym               STQ     O1COM+160,X2

             15916    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;

  15916 32 004672   000132 235000 xsym               LDA     O1COM+90
        32 004673   000003 735000                    ALS     3
        32 004674   000001 236000 2                  LDQ     LEX_SYMBOL+1
        32 004675   000242 756005 xsym               STQ     O1COM+162,AL

             15917    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;

  15917 32 004676   000132 235000 xsym               LDA     O1COM+90
        32 004677   000003 735000                    ALS     3
        32 004700   000000 236000 33                 LDQ     0
        32 004701   000241 756005 xsym               STQ     O1COM+161,AL

             15918    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;

  15918 32 004702   000132 235000 xsym               LDA     O1COM+90
        32 004703   000003 735000                    ALS     3
        32 004704   000004 236000 2                  LDQ     LEX_SYMBOL+4
        32 004705   000244 756005 xsym               STQ     O1COM+164,AL

             15919    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;

  15919 32 004706   000132 235000 xsym               LDA     O1COM+90
        32 004707   000003 735000                    ALS     3
        32 004710   000005 236000 2                  LDQ     LEX_SYMBOL+5
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:210  
        32 004711   000245 756005 xsym               STQ     O1COM+165,AL

             15920    4     END;

             15922    3     END;

      867    15924    2     O1COM.LA_STK.B.HIGH_LEV(O1COM.LA_PUT) = LEX_SYMBOL.B.CONTINUED_TOKEN;

  15924 32 004712   000132 235000 xsym               LDA     O1COM+90
        32 004713   000003 735000                    ALS     3
        32 004714   000002 236000 2                  LDQ     LEX_SYMBOL+2
        32 004715   000025 772000                    QRL     21
        32 004716   000237 676005 xsym               ERQ     O1COM+159,AL
        32 004717   004000 376007                    ANQ     2048,DL
        32 004720   000237 656005 xsym               ERSQ    O1COM+159,AL

      868    15925    2     CALL Z8AH$SEARCH_;

  15925 32 004721   000003 631400 33                 EPPR1   3
        32 004722   000000 701000 xent               TSX1    Z8AH$SEARCH_
        32 004723   000000 011000                    NOP     0

      869    15926    2     O1COM.LA_STK.DNT$(O1COM.LA_PUT)   = DNT$;

  15926 32 004724   000132 235000 xsym               LDA     O1COM+90
        32 004725   000003 735000                    ALS     3
        32 004726   000000 236000 17                 LDQ     DNT$
        32 004727   000241 756005 xsym               STQ     O1COM+161,AL

      870    15927
      871    15928
      872    15929    2   END CONSOLIDATE_PICTURE_STRING;

  15929 32 004730   000170 221200 0                  LDX1  ! CONTINUATION_ISN+2
        32 004731   000001 702211                    TSX2  ! 1,X1

      873    15930        %EJECT;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:211  
      874    15931        /* Main body of Z8EL$LEX */
      875    15932
      876    15933
      877    15934    2     DO CASE(LEX_STATE);

  15934 32 004732   000000 235000 30                 LDA     LEX_STATE
        32 004733   000005 115007                    CMPA    5,DL
        32 004734   004736 602005 32                 TNC     s:15934+4,AL
        32 004735   005217 710000 32                 TRA     s:16101
        32 004736   004743 710000 32                 TRA     s:15938
        32 004737   004743 710000 32                 TRA     s:15938
        32 004740   005027 710000 32                 TRA     s:15988
        32 004741   005114 710000 32                 TRA     s:16039
        32 004742   005124 710000 32                 TRA     s:16044

      878    15935
      879    15936    2       CASE(%LS_NORMAL, %LS_PERIOD_BEFORE_COMMENT_ENTRY);

      880    15937
      881    15938    2         CALL REPLACED_TOKEN;

  15938 32 004743   000014 701000 32                 TSX1    REPLACED_TOKEN
        32 004744   000000 011000                    NOP     0

      882    15939              %CHECK_DELIM_AND_SIZE;
             15940    3     DO;

             15941          /* Check symbol for length */
             15942    3     IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN

  15942 32 004745   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 004746   000502 115007                    CMPA    322,DL
        32 004747   004756 604400 32                 TMOZ    s:15950

             15943    4       DO;

             15944    4         CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:212  

  15944 32 004750   000120 630400 33                 EPPR0   80
        32 004751   000011 631400 33                 EPPR1   9
        32 004752   000000 701000 xent               TSX1    Z8AE$ERROR
        32 004753   000000 011000                    NOP     0

             15945    4                         LEX_SYMBOL.LINE,
             15946    4                         LEX_SYMBOL.COLUMN);
             15947    4         LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;

  15947 32 004754   000502 235007                    LDA     322,DL
        32 004755   000010 755000 2                  STA     LEX_SYMBOL+8

             15948    4       END;

             15949          /* Check symbol for delimiter error */
             15950    3     IF LEX_SYMBOL.B.DELIM_ERROR THEN

  15950 32 004756   000002 234000 2                  SZN     LEX_SYMBOL+2
        32 004757   004764 605000 32                 TPL     s:15966

             15951    4       DO;

             15952    4         CALL Z8AE$ERROR (%E$MISSING_DELIMITER,

  15952 32 004760   000124 630400 33                 EPPR0   84
        32 004761   000011 631400 33                 EPPR1   9
        32 004762   000000 701000 xent               TSX1    Z8AE$ERROR
        32 004763   000000 011000                    NOP     0

             15953    4                          LEX_SYMBOL.LINE,
             15954    4                          LEX_SYMBOL.COLUMN);
             15955    4       END;

             15956    3     END;

      883    15958              %INITIALIZE_LA_STK_ITEM;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:213  
             15959    3     DO;

             15960            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             15961                                @LA_ITEM = TRUE,
             15962                                @SYMBOL = LEX_SYMBOL.TYPE,
             15963                                @LINE = LEX_SYMBOL.LINE,
             15964                                @COLUMN = LEX_SYMBOL.COLUMN);
             15965    4     DO;

             15966    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;

  15966 32 004764   000132 235000 xsym               LDA     O1COM+90
        32 004765   000003 735000                    ALS     3
        32 004766   000000 220003                    LDX0    0,DU
        32 004767   000237 740005 xsym               STX0    O1COM+159,AL

             15967    4       @POINTER -> LX_TERMINAL.B      = '0'B;

  15967 32 004770   000132 235000 xsym               LDA     O1COM+90
        32 004771   000003 735000                    ALS     3
        32 004772   000000 221003                    LDX1    0,DU
        32 004773   000237 441005 xsym               SXL1    O1COM+159,AL

             15968            %IF (TEXTCHAR(@BERROR) ~= '');
             15970            %ENDIF;
             15971    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;

  15971 32 004774   000132 235000 xsym               LDA     O1COM+90
        32 004775   000003 735000                    ALS     3
        32 004776   000015 236007                    LDQ     13,DL
        32 004777   000243 756005 xsym               STQ     O1COM+163,AL

             15972            %IF (TEXTCHAR(@LA_ITEM) = '');
             15974            %ENDIF;
             15975    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;

  15975 32 005000   000132 235000 xsym               LDA     O1COM+90
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:214  
        32 005001   000003 735000                    ALS     3
        32 005002   000000 236000 33                 LDQ     0
        32 005003   000240 756005 xsym               STQ     O1COM+160,AL

             15976    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;

  15976 32 005004   000132 235000 xsym               LDA     O1COM+90
        32 005005   000003 735000                    ALS     3
        32 005006   000001 236000 2                  LDQ     LEX_SYMBOL+1
        32 005007   000242 756005 xsym               STQ     O1COM+162,AL

             15977    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;

  15977 32 005010   000132 235000 xsym               LDA     O1COM+90
        32 005011   000003 735000                    ALS     3
        32 005012   000000 236000 33                 LDQ     0
        32 005013   000241 756005 xsym               STQ     O1COM+161,AL

             15978    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;

  15978 32 005014   000132 235000 xsym               LDA     O1COM+90
        32 005015   000003 735000                    ALS     3
        32 005016   000004 236000 2                  LDQ     LEX_SYMBOL+4
        32 005017   000244 756005 xsym               STQ     O1COM+164,AL

             15979    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;

  15979 32 005020   000132 235000 xsym               LDA     O1COM+90
        32 005021   000003 735000                    ALS     3
        32 005022   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 005023   000245 756005 xsym               STQ     O1COM+165,AL

             15980    4     END;

             15982    3     END;

      884    15984    2         CALL PROCESS_SYMBOL;
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:215  

  15984 32 005024   001632 701000 32                 TSX1    PROCESS_SYMBOL
        32 005025   000000 011000                    NOP     0
        32 005026   005217 710000 32                 TRA     s:16101

      885    15985
      886    15986    2       CASE(%LS_COMMENT_ENTRY);

      887    15987
      888    15988    2         CALL SCAN_COMMENT_ENTRY;

  15988 32 005027   001454 701000 32                 TSX1    SCAN_COMMENT_ENTRY
        32 005030   000000 011000                    NOP     0

      889    15989    2         LEX_STATE = %LS_NORMAL;

  15989 32 005031   000000 450000 30                 STZ     LEX_STATE

      890    15990              %CHECK_DELIM_AND_SIZE;
             15991    3     DO;

             15992          /* Check symbol for length */
             15993    3     IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN

  15993 32 005032   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 005033   000502 115007                    CMPA    322,DL
        32 005034   005043 604400 32                 TMOZ    s:16001

             15994    4       DO;

             15995    4         CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,

  15995 32 005035   000120 630400 33                 EPPR0   80
        32 005036   000011 631400 33                 EPPR1   9
        32 005037   000000 701000 xent               TSX1    Z8AE$ERROR
        32 005040   000000 011000                    NOP     0

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:216  
             15996    4                         LEX_SYMBOL.LINE,
             15997    4                         LEX_SYMBOL.COLUMN);
             15998    4         LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;

  15998 32 005041   000502 235007                    LDA     322,DL
        32 005042   000010 755000 2                  STA     LEX_SYMBOL+8

             15999    4       END;

             16000          /* Check symbol for delimiter error */
             16001    3     IF LEX_SYMBOL.B.DELIM_ERROR THEN

  16001 32 005043   000002 234000 2                  SZN     LEX_SYMBOL+2
        32 005044   005051 605000 32                 TPL     s:16017

             16002    4       DO;

             16003    4         CALL Z8AE$ERROR (%E$MISSING_DELIMITER,

  16003 32 005045   000124 630400 33                 EPPR0   84
        32 005046   000011 631400 33                 EPPR1   9
        32 005047   000000 701000 xent               TSX1    Z8AE$ERROR
        32 005050   000000 011000                    NOP     0

             16004    4                          LEX_SYMBOL.LINE,
             16005    4                          LEX_SYMBOL.COLUMN);
             16006    4       END;

             16007    3     END;

      891    16009              %INITIALIZE_LA_STK_ITEM;
             16010    3     DO;

             16011            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             16012                                @LA_ITEM = TRUE,
             16013                                @SYMBOL = LEX_SYMBOL.TYPE,
             16014                                @LINE = LEX_SYMBOL.LINE,
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:217  
             16015                                @COLUMN = LEX_SYMBOL.COLUMN);
             16016    4     DO;

             16017    4       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;

  16017 32 005051   000132 235000 xsym               LDA     O1COM+90
        32 005052   000003 735000                    ALS     3
        32 005053   000000 220003                    LDX0    0,DU
        32 005054   000237 740005 xsym               STX0    O1COM+159,AL

             16018    4       @POINTER -> LX_TERMINAL.B      = '0'B;

  16018 32 005055   000132 235000 xsym               LDA     O1COM+90
        32 005056   000003 735000                    ALS     3
        32 005057   000000 221003                    LDX1    0,DU
        32 005060   000237 441005 xsym               SXL1    O1COM+159,AL

             16019            %IF (TEXTCHAR(@BERROR) ~= '');
             16021            %ENDIF;
             16022    4       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;

  16022 32 005061   000132 235000 xsym               LDA     O1COM+90
        32 005062   000003 735000                    ALS     3
        32 005063   000015 236007                    LDQ     13,DL
        32 005064   000243 756005 xsym               STQ     O1COM+163,AL

             16023            %IF (TEXTCHAR(@LA_ITEM) = '');
             16025            %ENDIF;
             16026    4       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;

  16026 32 005065   000132 235000 xsym               LDA     O1COM+90
        32 005066   000003 735000                    ALS     3
        32 005067   000000 236000 33                 LDQ     0
        32 005070   000240 756005 xsym               STQ     O1COM+160,AL

             16027    4       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:218  
  16027 32 005071   000132 235000 xsym               LDA     O1COM+90
        32 005072   000003 735000                    ALS     3
        32 005073   000001 236000 2                  LDQ     LEX_SYMBOL+1
        32 005074   000242 756005 xsym               STQ     O1COM+162,AL

             16028    4       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;

  16028 32 005075   000132 235000 xsym               LDA     O1COM+90
        32 005076   000003 735000                    ALS     3
        32 005077   000000 236000 33                 LDQ     0
        32 005100   000241 756005 xsym               STQ     O1COM+161,AL

             16029    4       @POINTER -> LX_TERMINAL.LINE   = @LINE;

  16029 32 005101   000132 235000 xsym               LDA     O1COM+90
        32 005102   000003 735000                    ALS     3
        32 005103   000004 236000 2                  LDQ     LEX_SYMBOL+4
        32 005104   000244 756005 xsym               STQ     O1COM+164,AL

             16030    4       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;

  16030 32 005105   000132 235000 xsym               LDA     O1COM+90
        32 005106   000003 735000                    ALS     3
        32 005107   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 005110   000245 756005 xsym               STQ     O1COM+165,AL

             16031    4     END;

             16033    3     END;

      892    16035    2         CALL PROCESS_SYMBOL;

  16035 32 005111   001632 701000 32                 TSX1    PROCESS_SYMBOL
        32 005112   000000 011000                    NOP     0
        32 005113   005217 710000 32                 TRA     s:16101

      893    16036
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:219  
      894    16037    2       CASE(%LS_PICK_UP_SAVED_SYMBOL);

      895    16038
      896    16039    2         O1COM.LA_STK_FIELDS.ALL_BUT_LINK(O1COM.LA_PUT) = SAVED_SYMBOL.
             16039                  ALL_FIELDS_BUT_LINK;

  16039 32 005114   000132 236000 xsym               LDQ     O1COM+90
        32 005115   000005 736000                    QLS     5
        32 005116   000006 100400                    MLR     fill='000'O
        32 005117   000011 000034 0                  ADSC9   SAVED_SYMBOL             cn=0,n=28
        32 005120   000237 000034 xsym               ADSC9   O1COM+159,Q              cn=0,n=28

      897    16040    2         LEX_STATE = SAVED_LEX_STATE;

  16040 32 005121   000021 236000 0                  LDQ     SAVED_LEX_STATE
        32 005122   000000 756000 30                 STQ     LEX_STATE
        32 005123   005217 710000 32                 TRA     s:16101

      898    16041
      899    16042    2       CASE(%LS_PICTURE_OR_IS);

      900    16043
      901    16044    2         CALL REPLACED_TOKEN;

  16044 32 005124   000014 701000 32                 TSX1    REPLACED_TOKEN
        32 005125   000000 011000                    NOP     0

      902    16045    2         IF LEX_SYMBOL.SIZE = 2

  16045 32 005126   000010 235000 2                  LDA     LEX_SYMBOL+8
        32 005127   000002 115007                    CMPA    2,DL
        32 005130   005215 601000 32                 TNZ     s:16096
        32 005131   000011 220000 2                  LDX0    LEX_SYMBOL+9
        32 005132   000025 100000 31                 CMPX0   21
        32 005133   005215 601000 32                 TNZ     s:16096

      903    16046    2             AND SUBSTR(LEX_SYMBOL.SYMBOL, 0, 2) = 'IS' THEN
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:220  
      904    16047    3           DO;

      905    16048                  %CHECK_DELIM_AND_SIZE;
             16049    4     DO;

             16050          /* Check symbol for length */
             16051    4     IF LEX_SYMBOL.SIZE > %MAX_SYMBOL_SIZE THEN

  16051 32 005134   000502 115007                    CMPA    322,DL
        32 005135   005144 604400 32                 TMOZ    s:16059

             16052    5       DO;

             16053    5         CALL Z8AE$ERROR(%E$SYMBOL_TOO_LARGE,

  16053 32 005136   000120 630400 33                 EPPR0   80
        32 005137   000011 631400 33                 EPPR1   9
        32 005140   000000 701000 xent               TSX1    Z8AE$ERROR
        32 005141   000000 011000                    NOP     0

             16054    5                         LEX_SYMBOL.LINE,
             16055    5                         LEX_SYMBOL.COLUMN);
             16056    5         LEX_SYMBOL.SIZE = %MAX_SYMBOL_SIZE;

  16056 32 005142   000502 235007                    LDA     322,DL
        32 005143   000010 755000 2                  STA     LEX_SYMBOL+8

             16057    5       END;

             16058          /* Check symbol for delimiter error */
             16059    4     IF LEX_SYMBOL.B.DELIM_ERROR THEN

  16059 32 005144   000002 234000 2                  SZN     LEX_SYMBOL+2
        32 005145   005152 605000 32                 TPL     s:16075

             16060    5       DO;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:221  
             16061    5         CALL Z8AE$ERROR (%E$MISSING_DELIMITER,

  16061 32 005146   000124 630400 33                 EPPR0   84
        32 005147   000011 631400 33                 EPPR1   9
        32 005150   000000 701000 xent               TSX1    Z8AE$ERROR
        32 005151   000000 011000                    NOP     0

             16062    5                          LEX_SYMBOL.LINE,
             16063    5                          LEX_SYMBOL.COLUMN);
             16064    5       END;

             16065    4     END;

      906    16067                  %INITIALIZE_LA_STK_ITEM;
             16068    4     DO;

             16069            %INIT_LX_TERMINAL ( @POINTER = "ADDR(O1COM.LA_STK(O1COM.LA_PUT))",
             16070                                @LA_ITEM = TRUE,
             16071                                @SYMBOL = LEX_SYMBOL.TYPE,
             16072                                @LINE = LEX_SYMBOL.LINE,
             16073                                @COLUMN = LEX_SYMBOL.COLUMN);
             16074    5     DO;

             16075    5       @POINTER -> LX_TERMINAL.ID     = %LX_TERMINAL;

  16075 32 005152   000132 235000 xsym               LDA     O1COM+90
        32 005153   000003 735000                    ALS     3
        32 005154   000000 220003                    LDX0    0,DU
        32 005155   000237 740005 xsym               STX0    O1COM+159,AL

             16076    5       @POINTER -> LX_TERMINAL.B      = '0'B;

  16076 32 005156   000132 235000 xsym               LDA     O1COM+90
        32 005157   000003 735000                    ALS     3
        32 005160   000000 221003                    LDX1    0,DU
        32 005161   000237 441005 xsym               SXL1    O1COM+159,AL

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:222  
             16077            %IF (TEXTCHAR(@BERROR) ~= '');
             16079            %ENDIF;
             16080    5       @POINTER -> LX_TERMINAL.TYPE   = @TYPE %;

  16080 32 005162   000132 235000 xsym               LDA     O1COM+90
        32 005163   000003 735000                    ALS     3
        32 005164   000015 236007                    LDQ     13,DL
        32 005165   000243 756005 xsym               STQ     O1COM+163,AL

             16081            %IF (TEXTCHAR(@LA_ITEM) = '');
             16083            %ENDIF;
             16084    5       @POINTER -> LX_TERMINAL.ST$    = @ST$ ;

  16084 32 005166   000132 235000 xsym               LDA     O1COM+90
        32 005167   000003 735000                    ALS     3
        32 005170   000000 236000 33                 LDQ     0
        32 005171   000240 756005 xsym               STQ     O1COM+160,AL

             16085    5       @POINTER -> LX_TERMINAL.SYMBOL = @SYMBOL;

  16085 32 005172   000132 235000 xsym               LDA     O1COM+90
        32 005173   000003 735000                    ALS     3
        32 005174   000001 236000 2                  LDQ     LEX_SYMBOL+1
        32 005175   000242 756005 xsym               STQ     O1COM+162,AL

             16086    5       @POINTER -> LX_TERMINAL.DNT$   = @DNT$;

  16086 32 005176   000132 235000 xsym               LDA     O1COM+90
        32 005177   000003 735000                    ALS     3
        32 005200   000000 236000 33                 LDQ     0
        32 005201   000241 756005 xsym               STQ     O1COM+161,AL

             16087    5       @POINTER -> LX_TERMINAL.LINE   = @LINE;

  16087 32 005202   000132 235000 xsym               LDA     O1COM+90
        32 005203   000003 735000                    ALS     3
        32 005204   000004 236000 2                  LDQ     LEX_SYMBOL+4
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:223  
        32 005205   000244 756005 xsym               STQ     O1COM+164,AL

             16088    5       @POINTER -> LX_TERMINAL.COLUMN = @COLUMN;

  16088 32 005206   000132 235000 xsym               LDA     O1COM+90
        32 005207   000003 735000                    ALS     3
        32 005210   000005 236000 2                  LDQ     LEX_SYMBOL+5
        32 005211   000245 756005 xsym               STQ     O1COM+165,AL

             16089    5     END;

             16091    4     END;

      907    16093    3             CALL PROCESS_SYMBOL;

  16093 32 005212   001632 701000 32                 TSX1    PROCESS_SYMBOL
        32 005213   000000 011000                    NOP     0

      908    16094    3           END;

  16094 32 005214   005217 710000 32                 TRA     s:16101

      909    16095    2         ELSE
      910    16096    2           CALL CONSOLIDATE_PICTURE_STRING;

  16096 32 005215   004475 701000 32                 TSX1    CONSOLIDATE_PICTURE_STRING
        32 005216   000000 011000                    NOP     0

      911    16097
      912    16098    2     END;  /* CASE ON LEX_STATE */

      913    16099
      914    16100
      915    16101    1     RETURN;

  16101 32 005217   000000 221200 0                  LDX1  ! 0
        32 005220   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:224  

      916    16102
      917    16103
      918    16104        /* Initialization call to LEX */
      919    16105
      920    16106    1   Z8EL$LEX_INIT : ENTRY;

  16106 32 005221   000000 741200 0     Z8EL$LEX_IN* STX1  ! 0

      921    16107
      922    16108    1     CALL Z9AA$IS_ES_REQUIRED;

  16108 32 005222   000003 631400 33                 EPPR1   3
        32 005223   000000 701000 xent               TSX1    Z9AA$IS_ES_REQUIRED
        32 005224   000000 011000                    NOP     0

      923    16109
      924    16110
      925    16111    1     CALL Z8EL$GET_NEXT_SCANNER_LINE;

  16111 32 005225   000003 631400 33                 EPPR1   3
        32 005226   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        32 005227   000000 011000                    NOP     0

      926    16112
      927    16113    1     RETURN;

  16113 32 005230   000000 221200 0                  LDX1  ! 0
        32 005231   000001 702211                    TSX2  ! 1,X1
      928    16114
      929    16115
      930    16116    1   END Z8EL$LEX;
      931    16117        %EOD;

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:225  
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_P_STATE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$LEX.
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:226  

 **** Variables and constants ****

  ****  Section 000  Data  Z8EL$LEX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/w SBIN        r     1 CHAR_CLASS                23-0-0/w SBIN        r     1 CHAR_COLUMN
   166-0-0/w SBIN        r     1 CONTINUATION_ISN          26-0-0/w PTR         r     1 HEAP$$
    10-0-0/w SBIN        r     1 I                        171-0-0/w SBIN        r     1 INSERT_SIZE
     2-0-0/w STRC(216)   r     1 NUM_DESC
     1-0-0/w SBIN        r     1 PARSE_STACK_IDX_IN_CHARS
   162-0-0/b BIT         r     1 PARSING_PICTURE           30-0-0/w STRC(3240)  r     1 PICTURE_SYMBOL
    27-0-0/w PTR         r     1 PROC$$                    22-0-0/b BIT         r     1 SAVED_CONT_FLAG
    21-0-0/w SBIN        r     1 SAVED_LEX_STATE           11-0-0/w STRC(288)   r     1 SAVED_SYMBOL
    25-0-0/w PTR         r     1 TDNT$

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 002 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 003 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:227  

  ****  Section 004 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 TEMP_LEX_SYMBOL

  ****  Section 005 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 TEMP_LEX_SYMBOL2

  ****  Section 006 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 007 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_BUFFER$

  ****  Section 008 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 009 LblCom CURRENT_LINE_LEVEL
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:228  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 010 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 011 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 012 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 013 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 014 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:229  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 015 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 016 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 017 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 018 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 DNT_

  ****  Section 019 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:230  
     0-0-0/w UBIN        r     1 DNT_BUCKET_NUMBER

  ****  Section 020 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT_OF_1$

  ****  Section 021 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAP$

  ****  Section 022 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CURRENT_SYMBOL_LEVEL

  ****  Section 023 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 REPLACE_ACTIVE

  ****  Section 024 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 IGNORE_COPY_REPLACE

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:231  
  ****  Section 025 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 026 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 027 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LEX_SYMBOL_QUEUE$

  ****  Section 028 LblCom GET_NEXT_SCANNER_LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 GET_NEXT_SCANNER_LINE

  ****  Section 029 LblCom SEARCH_REQUIRED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 SEARCH_REQUIRED

  ****  Section 030 LblCom LEX_STATE

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:232  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LEX_STATE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4608)  r     1 ANSI_USERWORD_SCAN_TABLE
     0-0-0/w STRC(4608)        1 ASCII_SEARCH_TABLE         0-0-0/w STRC(4608)        1 BLANK_SCAN_TABLE
     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/c CHAR              1 CURRENCY_SIGN_CHARS(0:511)
     0-0-0/w STRC(4608)        1 DBL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 DIGIT_SCAN_TABLE
     0-0-0/w PTR         r     1 DNT_BUCKETS(0:1128)
     0-0-0/w STRC(4608)        1 DOUBLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w STRC(4608)        1 LETTER_SEARCH_TABLE
     0-0-0/c CHAR              1 LOWER_TO_UPPER_CASE(0:511)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR
     0-0-0/w STRC(4608)        1 SEPARATORS_TABLE
     0-0-0/w STRC(4608)        1 SINGLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 SNGL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 USERWORD_SCAN_TABLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:233  
     0-0-0/c ACHR        r     1 BUFFER_LINE                0-0-0/w STRC(288)         1 CALL_STMT
     0-0-0/w STRC(396)         1 CD                         0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w STRC(396)         1 FD
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)   r     1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)   r     1 LX_TERMINAL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/c ACHR              1 PARSE_STACK_USED           0-0-0/w STRC(396)   r     1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(252)         1 REPLACE_ITEM
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(396)         1 SCALAR
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(288)         1 WRITE_STMT

PL6.E3A0      #001=Z8EL$LEX File=Z8EL.:Z8A6TSI                                   SAT 08/09/97 12:03 Page:234  

   Procedure Z8EL$LEX requires 2714 words for executable code.
   Procedure Z8EL$LEX is declared NOAUTO and requires 126 words of local(STATIC) storage.

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:235  
      932        1        /*T***********************************************************/
      933        2        /*T*                                                         */
      934        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      935        4        /*T*                                                         */
      936        5        /*T***********************************************************/
      937        6        Z8EL$GET_CHECK_SRC_LINE : PROC NOAUTO;
      938        7
      939        8        %EQU PHASE = 1;
      940        9
      941       10        %INCLUDE Z8A_DEFC;
      942       78        %INCLUDE Z8A_SUPP_MAC;
      943     2478        %INCLUDE Z8A_COMCOM;
      944     3128        %INCLUDE Z8E_BUFFERS;
      945     3318        %INCLUDE Z8E_TABLES;
      946     3871        %INCLUDE Z8E_HEAP;
      947     3927        %INCLUDE Z8E_REPLACE;
      948     4230        %INCLUDE Z8A_ERR_NUMS ;
      949     4994
      950     4995    1   DCL Z8AA$GET_NEXT_SRC_LINE ENTRY ALTRET;
      951     4996    1   DCL Z8AE$ERROR             ENTRY (12) ;
      952     4997
      953     4998    1   DCL LINE_GT_80_ISSUED      BOOLEAN STATIC INIT (FALSE) ;
      954     4999
      955     5000          %NEW_HEAP(@POINTER=LOOKAHEAD_BUFFER$, @SIZE=%MAX_INPUT_BUFFER_LEN);
      956     5005
      957     5006    1     CALL Z8AA$GET_NEXT_SRC_LINE ALTRET(GNSLEOF);
      958     5007
      959     5008        %EJECT;
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:236  
      960     5009        /*===========================*/
      961     5010        /* Process Unformatted Line  */
      962     5011        /*===========================*/
      963     5012        /*N* This is a subset of the full Free_Format Option --
      964     5013             Column 1 = *, /, D, -, or blank
      965     5014             Column 2-5 = Area A (paragraph labels, divisions, etc.)
      966     5015             Column 6-256 = Area B (no identification field).
      967     5016        */
      968     5017
      969     5018    1     IF COMCOM.OB.FORMAT THEN /* Free Format */
      970     5019    2       DO;
      971     5020    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.LINE_LENGTH, 256);
      972     5021    2         CALL SEARCHR(FILL_BUFFER.COLUMN,
      973     5022    2                      FILL_BUFFER.CLASS,
      974     5023    2                      BLANK_SCAN_TABLE,
      975     5024    2                      FILL_BUFFER.SOURCE_LINE,
      976     5025    2                      FILL_BUFFER.STRIPPED_LINE_LENGTH);
      977     5026    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.STRIPPED_LINE_LENGTH,
      978     5027    2                                           FILL_BUFFER.COLUMN + 1);
      979     5028    2         IF FILL_BUFFER.STRIPPED_LINE_LENGTH > 0 THEN
      980     5029    3           DO;
      981     5030    3             IF SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = '*'
      982     5031    3                  OR SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = '/' THEN
      983     5032    3               FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;
      984     5033    3             ELSE
      985     5034    4               DO;
      986     5035    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = '-' THEN
      987     5036    4                   FILL_BUFFER.LINE_TYPE.CONTINUATION = TRUE;
      988     5037    4                 ELSE
      989     5038    4                   IF COPY_DEBUG_LEVEL > 0
      990     5039    4                       AND COPY_DEBUG_LEVEL <= FILL_BUFFER.LEVEL THEN
      991     5040    5                     DO;
      992     5041    5                       FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;
      993     5042    5                       SUBSTR(FILL_BUFFER.SOURCE_LINE,
      994     5043    5                              0,
      995     5044    5                              1) = 'D';
      996     5045    5                     END;
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:237  
      997     5046    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = 'D'
      998     5047    4                      OR SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = 'd' THEN
      999     5048    4                   FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;
     1000     5049    4                 CALL SEARCH (FILL_BUFFER.COLUMN,
     1001     5050    4                              FILL_BUFFER.CLASS,
     1002     5051    4                              BLANK_SCAN_TABLE,
     1003     5052    4                              SUBSTR(FILL_BUFFER.SOURCE_LINE,
     1004     5053    4                                       0,
     1005     5054    4                                       FILL_BUFFER.STRIPPED_LINE_LENGTH),
     1006     5055    4                              1);
     1007     5056    4                 IF FILL_BUFFER.COLUMN >= FILL_BUFFER.STRIPPED_LINE_LENGTH THEN
     1008     5057    4                   FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */
     1009     5058    4                 ELSE
     1010     5059    4                   IF FILL_BUFFER.LINE_TYPE.CONTINUATION
     1011     5060    4                         AND FILL_BUFFER.COLUMN < 5 THEN
     1012     5061    4                     FILL_BUFFER.LINE_TYPE.CONTINUATION_COL_8_11_ERROR
     1013     5062    4                              = TRUE;
     1014     5063    4               END;
     1015     5064    3           END;
     1016     5065    2         ELSE
     1017     5066    2           FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */
     1018     5067
     1019     5068    2         IF  FILL_BUFFER.LEVEL < COPY_DEBUG_LEVEL THEN
     1020     5069    2            COPY_DEBUG_LEVEL = 0;
     1021     5070    2       END;
     1022     5071
     1023     5072        %EJECT;
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:238  
     1024     5073        /*===========================*/
     1025     5074        /* Process Fixed Format Line */
     1026     5075        /*===========================*/
     1027     5076
     1028     5077    1     ELSE
     1029     5078    2       DO;
     1030     5079    2         IF  FILL_BUFFER.LINE_LENGTH > 80
     1031     5080    3         AND LINE_GT_80_ISSUED = FALSE THEN DO ;
     1032     5081    3           CALL Z8AE$ERROR (%E$LINE_LENGTH_GT_80, FILL_BUFFER.ISN, 80) ;
     1033     5082    3           LINE_GT_80_ISSUED = TRUE ;
     1034     5083    3         END ; /* Line > 80 bytes -- first time only */
     1035     5084    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.LINE_LENGTH, 72);
     1036     5085    2         CALL SEARCHR(FILL_BUFFER.COLUMN,
     1037     5086    2                      FILL_BUFFER.CLASS,
     1038     5087    2                      BLANK_SCAN_TABLE,
     1039     5088    2                      FILL_BUFFER.SOURCE_LINE,
     1040     5089    2                      FILL_BUFFER.STRIPPED_LINE_LENGTH);
     1041     5090    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.STRIPPED_LINE_LENGTH,
     1042     5091    2                                           FILL_BUFFER.COLUMN + 1);
     1043     5092    2         IF FILL_BUFFER.STRIPPED_LINE_LENGTH > 6 THEN
     1044     5093    3           DO;
     1045     5094    3             IF SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = '*'
     1046     5095    3                  OR SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = '/' THEN
     1047     5096    3               FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;
     1048     5097    3             ELSE
     1049     5098    4               DO;
     1050     5099    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = '-' THEN
     1051     5100    4                   FILL_BUFFER.LINE_TYPE.CONTINUATION = TRUE;
     1052     5101    4                 ELSE
     1053     5102    4                   IF COPY_DEBUG_LEVEL > 0
     1054     5103    4                       AND COPY_DEBUG_LEVEL <= FILL_BUFFER.LEVEL THEN
     1055     5104    5                     DO;
     1056     5105    5                       FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;
     1057     5106    5                       SUBSTR(FILL_BUFFER.SOURCE_LINE,
     1058     5107    5                              6,
     1059     5108    5                              1) = 'D';
     1060     5109    5                     END;
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:239  
     1061     5110    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = 'D'
     1062     5111    4                      OR SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = 'd' THEN
     1063     5112    4                   FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;
     1064     5113    4                 CALL SEARCH (FILL_BUFFER.COLUMN,
     1065     5114    4                              FILL_BUFFER.CLASS,
     1066     5115    4                              BLANK_SCAN_TABLE,
     1067     5116    4                              SUBSTR(FILL_BUFFER.SOURCE_LINE,
     1068     5117    4                                       0,
     1069     5118    4                                       FILL_BUFFER.STRIPPED_LINE_LENGTH),
     1070     5119    4                              7);
     1071     5120    4                 IF FILL_BUFFER.COLUMN >= FILL_BUFFER.STRIPPED_LINE_LENGTH THEN
     1072     5121    4                   FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */
     1073     5122    4                 ELSE
     1074     5123    4                   IF FILL_BUFFER.LINE_TYPE.CONTINUATION
     1075     5124    4                         AND FILL_BUFFER.COLUMN < 11 THEN
     1076     5125    4                     FILL_BUFFER.LINE_TYPE.CONTINUATION_COL_8_11_ERROR
     1077     5126    4                              = TRUE;
     1078     5127    4               END;
     1079     5128    3           END;
     1080     5129    2         ELSE
     1081     5130    2           FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */
     1082     5131
     1083     5132    2         IF  FILL_BUFFER.LEVEL < COPY_DEBUG_LEVEL THEN
     1084     5133    2            COPY_DEBUG_LEVEL = 0;
     1085     5134    2       END;
     1086     5135
     1087     5136
     1088     5137
     1089     5138    1   GNSLEOF:
     1090     5139    1     RETURN;
     1091     5140
     1092     5141    1   END Z8EL$GET_CHECK_SRC_LINE;
     1093     5142        %EOD;

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:240  
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$GET_CHECK_SRC_LINE.

   Procedure Z8EL$GET_CHECK_SRC_LINE requires 232 words for executable code.
   Procedure Z8EL$GET_CHECK_SRC_LINE is declared NOAUTO and requires 6 words of local(STATIC) storage.

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:241  

 Object Unit name= Z8EL$GET_CHECK_SRC_LINE                    File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:07:24.56 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     6      6  Z8EL$GET_CHECK_SRC_LINE
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  SCANNER_STATE
    3  LblCom even  none     1      1  CURRENT_BUFFER$
    4  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    5  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    6  LblCom even  none     1      1  LINE_LIST$
    7  LblCom even  none     7      7  BUFFER
    8  LblCom even  none     1      1  ORIGINAL_ISN
    9  LblCom even  none     1      1  EXPANDED_ISN
   10  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   11  LblCom even  none     1      1  HEAP$
   12  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
   13  LblCom even  none     1      1  REPLACE_ACTIVE
   14  LblCom even  none     1      1  IGNORE_COPY_REPLACE
   15  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   16  LblCom even  none     4      4  REPLACE_LIST
   17  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   18   Proc  even  none   232    350  Z8EL$GET_CHECK_SRC_LINE
   19  RoData even  none    10     12  Z8EL$GET_CHECK_SRC_LINE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    18      0   yes            yes      Std        0  Z8EL$GET_CHECK_SRC_LINE
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:242  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8ED$NEW_HEAP
 yes     yes           Std       0 Z8AA$GET_NEXT_SRC_LINE
         yes           Std      12 Z8AE$ERROR

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    USERWORD_SCAN_TABLE              r    ANSI_USERWORD_SCAN_TABLE
r    ASCII_SEARCH_TABLE               r    BLANK_SCAN_TABLE                 r    DIGIT_SCAN_TABLE
r    LETTER_SEARCH_TABLE              r    DOUBLE_QUOTE_SEARCH_TABLE        r    SINGLE_QUOTE_SEARCH_TABLE
r    DBL_QUOTE_PSEUDO_SEARCH_TABLE    r    SNGL_QUOTE_PSEUDO_SEARCH_TABLE   r    SEPARATORS_TABLE
r    LOWER_TO_UPPER_CASE              r    CURRENCY_SIGN_CHARS

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:243  


      932        1        /*T***********************************************************/
      933        2        /*T*                                                         */
      934        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      935        4        /*T*                                                         */
      936        5        /*T***********************************************************/
      937        6        Z8EL$GET_CHECK_SRC_LINE : PROC NOAUTO;

      6 18 000000   000000 741200 0     Z8EL$GET_CH* STX1  ! 0

      938        7
      939        8        %EQU PHASE = 1;
      940        9
      941       10        %INCLUDE Z8A_DEFC;
      942       78        %INCLUDE Z8A_SUPP_MAC;
      943     2478        %INCLUDE Z8A_COMCOM;
      944     3128        %INCLUDE Z8E_BUFFERS;
      945     3318        %INCLUDE Z8E_TABLES;
      946     3871        %INCLUDE Z8E_HEAP;
      947     3927        %INCLUDE Z8E_REPLACE;
      948     4230        %INCLUDE Z8A_ERR_NUMS ;
      949     4994
      950     4995    1   DCL Z8AA$GET_NEXT_SRC_LINE ENTRY ALTRET;
      951     4996    1   DCL Z8AE$ERROR             ENTRY (12) ;
      952     4997
      953     4998    1   DCL LINE_GT_80_ISSUED      BOOLEAN STATIC INIT (FALSE) ;
      954     4999
      955     5000          %NEW_HEAP(@POINTER=LOOKAHEAD_BUFFER$, @SIZE=%MAX_INPUT_BUFFER_LEN);

   5002 18 000001   000002 630400 19                 EPPR0   2
        18 000002   000000 631400 19                 EPPR1   0
        18 000003   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        18 000004   000000 011000                    NOP     0

      956     5005
      957     5006    1     CALL Z8AA$GET_NEXT_SRC_LINE ALTRET(GNSLEOF);

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:244  
   5006 18 000005   000004 631400 19                 EPPR1   4
        18 000006   000000 701000 xent               TSX1    Z8AA$GET_NEXT_SRC_LINE
        18 000007   000346 702000 18                 TSX2    GNSLEOF

      958     5007
      959     5008        %EJECT;
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:245  
      960     5009        /*===========================*/
      961     5010        /* Process Unformatted Line  */
      962     5011        /*===========================*/
      963     5012        /*N* This is a subset of the full Free_Format Option --
      964     5013             Column 1 = *, /, D, -, or blank
      965     5014             Column 2-5 = Area A (paragraph labels, divisions, etc.)
      966     5015             Column 6-256 = Area B (no identification field).
      967     5016        */
      968     5017
      969     5018    1     IF COMCOM.OB.FORMAT THEN /* Free Format */

   5018 18 000010   000030 234000 xsym               SZN     COMCOM+24
        18 000011   000157 605000 18                 TPL     s:5079

      970     5019    2       DO;

      971     5020    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.LINE_LENGTH, 256);

   5020 18 000012   000400 236007                    LDQ     256,DL
        18 000013   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        18 000014   000017 604000 18                 TMI     s:5020+5
        18 000015   000012 116100                    CMPQ    10,,PR0
        18 000016   000020 604400 18                 TMOZ    s:5020+6
        18 000017   000012 236100                    LDQ     10,,PR0
        18 000020   000003 756100                    STQ     3,,PR0

      972     5021    2         CALL SEARCHR(FILL_BUFFER.COLUMN,

   5021 18 000021   000012 720100                    LXL0    10,,PR0
        18 000022   000003 721100                    LXL1    3,,PR0
        18 000023   000000 165540                    TCTR
        18 000024   000013 000011                    ADSC9   11,,PR0                  cn=0,n=*X1
        18 000025   000000 000000 xsym               ARG     BLANK_SCAN_TABLE
        18 000026   000000 000100                    ARG     0,,PR0
        18 000027   000000 235100                    LDA     0,,PR0
        18 000030   000033 771000                    ARL     27
        18 000031   000000 471400 4                  LDP1    LOOKAHEAD_BUFFER$
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:246  
        18 000032   100010 755100                    STA     8,,PR1
        18 000033   000000 551140                    STBA    0,'40'O,PR0
        18 000034   000037 606400 18                 TTN     s:5026
        18 000035   000000 054100                    AOS     0,,PR0
        18 000036   000000 156100                    SSQ     0,,PR0

      973     5022    2                      FILL_BUFFER.CLASS,
      974     5023    2                      BLANK_SCAN_TABLE,
      975     5024    2                      FILL_BUFFER.SOURCE_LINE,
      976     5025    2                      FILL_BUFFER.STRIPPED_LINE_LENGTH);
      977     5026    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.STRIPPED_LINE_LENGTH,

   5026 18 000037   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        18 000040   000000 236100                    LDQ     0,,PR0
        18 000041   000001 036007                    ADLQ    1,DL
        18 000042   000003 116100                    CMPQ    3,,PR0
        18 000043   000045 604400 18                 TMOZ    s:5026+6
        18 000044   000003 236100                    LDQ     3,,PR0
        18 000045   000003 756100                    STQ     3,,PR0

      978     5027    2                                           FILL_BUFFER.COLUMN + 1);
      979     5028    2         IF FILL_BUFFER.STRIPPED_LINE_LENGTH > 0 THEN

   5028 18 000046   000000 116003                    CMPQ    0,DU
        18 000047   000150 604400 18                 TMOZ    s:5066

      980     5029    3           DO;

      981     5030    3             IF SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = '*'

   5030 18 000050   000012 720100                    LXL0    10,,PR0
        18 000051   000013 236100                    LDQ     11,,PR0
        18 000052   777000 376003                    ANQ     -512,DU
        18 000053   052000 116003                    CMPQ    21504,DU
        18 000054   000061 600000 18                 TZE     s:5032
        18 000055   000013 236100                    LDQ     11,,PR0
        18 000056   777000 376003                    ANQ     -512,DU
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:247  
        18 000057   057000 116003                    CMPQ    24064,DU
        18 000060   000064 601000 18                 TNZ     s:5035

      982     5031    3                  OR SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = '/' THEN
      983     5032    3               FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;

   5032 18 000061   004000 236003                    LDQ     2048,DU
        18 000062   000011 256100                    ORSQ    9,,PR0
        18 000063   000152 710000 18                 TRA     s:5068

      984     5033    3             ELSE
      985     5034    4               DO;

      986     5035    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = '-' THEN

   5035 18 000064   000013 236100                    LDQ     11,,PR0
        18 000065   777000 376003                    ANQ     -512,DU
        18 000066   055000 116003                    CMPQ    23040,DU
        18 000067   000073 601000 18                 TNZ     s:5038

      987     5036    4                   FILL_BUFFER.LINE_TYPE.CONTINUATION = TRUE;

   5036 18 000070   400000 236003                    LDQ     -131072,DU
        18 000071   000011 256100                    ORSQ    9,,PR0
        18 000072   000104 710000 18                 TRA     s:5046

      988     5037    4                 ELSE
      989     5038    4                   IF COPY_DEBUG_LEVEL > 0

   5038 18 000073   000000 235000 15                 LDA     COPY_DEBUG_LEVEL
        18 000074   000104 604400 18                 TMOZ    s:5046
        18 000075   000000 236000 15                 LDQ     COPY_DEBUG_LEVEL
        18 000076   000001 116100                    CMPQ    1,,PR0
        18 000077   000104 605400 18                 TPNZ    s:5046

      990     5039    4                       AND COPY_DEBUG_LEVEL <= FILL_BUFFER.LEVEL THEN
      991     5040    5                     DO;
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:248  

      992     5041    5                       FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;

   5041 18 000100   010000 236003                    LDQ     4096,DU
        18 000101   000011 256100                    ORSQ    9,,PR0

      993     5042    5                       SUBSTR(FILL_BUFFER.SOURCE_LINE,

   5042 18 000102   104000 236003                    LDQ     34816,DU
        18 000103   000013 552140                    STBQ    11,'40'O,PR0

      994     5043    5                              0,
      995     5044    5                              1) = 'D';
      996     5045    5                     END;

      997     5046    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = 'D'

   5046 18 000104   000013 236100                    LDQ     11,,PR0
        18 000105   777000 376003                    ANQ     -512,DU
        18 000106   104000 116003                    CMPQ    34816,DU
        18 000107   000114 600000 18                 TZE     s:5048
        18 000110   000013 236100                    LDQ     11,,PR0
        18 000111   777000 376003                    ANQ     -512,DU
        18 000112   144000 116003                    CMPQ    51200,DU
        18 000113   000116 601000 18                 TNZ     s:5049

      998     5047    4                      OR SUBSTR(FILL_BUFFER.SOURCE_LINE,0,1) = 'd' THEN
      999     5048    4                   FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;

   5048 18 000114   010000 236003                    LDQ     4096,DU
        18 000115   000011 256100                    ORSQ    9,,PR0

     1000     5049    4                 CALL SEARCH (FILL_BUFFER.COLUMN,

   5049 18 000116   000003 721100                    LXL1    3,,PR0
        18 000117   777777 622011                    EAX2    -1,X1
        18 000120   000000 164540                    TCT
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:249  
        18 000121   000013 200012                    ADSC9   11,,PR0                  cn=1,n=*X2
        18 000122   000000 000000 xsym               ARG     BLANK_SCAN_TABLE
        18 000123   000000 000100                    ARG     0,,PR0
        18 000124   000000 235100                    LDA     0,,PR0
        18 000125   000033 771000                    ARL     27
        18 000126   000000 471400 4                  LDP1    LOOKAHEAD_BUFFER$
        18 000127   100010 755100                    STA     8,,PR1
        18 000130   000000 551140                    STBA    0,'40'O,PR0
        18 000131   000000 054100                    AOS     0,,PR0

     1001     5050    4                              FILL_BUFFER.CLASS,
     1002     5051    4                              BLANK_SCAN_TABLE,
     1003     5052    4                              SUBSTR(FILL_BUFFER.SOURCE_LINE,
     1004     5053    4                                       0,
     1005     5054    4                                       FILL_BUFFER.STRIPPED_LINE_LENGTH),
     1006     5055    4                              1);
     1007     5056    4                 IF FILL_BUFFER.COLUMN >= FILL_BUFFER.STRIPPED_LINE_LENGTH THEN

   5056 18 000132   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        18 000133   000000 236100                    LDQ     0,,PR0
        18 000134   000003 116100                    CMPQ    3,,PR0
        18 000135   000141 604000 18                 TMI     s:5059

     1008     5057    4                   FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */

   5057 18 000136   004000 236003                    LDQ     2048,DU
        18 000137   000011 256100                    ORSQ    9,,PR0
        18 000140   000152 710000 18                 TRA     s:5068

     1009     5058    4                 ELSE
     1010     5059    4                   IF FILL_BUFFER.LINE_TYPE.CONTINUATION

   5059 18 000141   000011 234100                    SZN     9,,PR0
        18 000142   000152 605000 18                 TPL     s:5068
        18 000143   000005 116007                    CMPQ    5,DL
        18 000144   000152 605000 18                 TPL     s:5068

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:250  
     1011     5060    4                         AND FILL_BUFFER.COLUMN < 5 THEN
     1012     5061    4                     FILL_BUFFER.LINE_TYPE.CONTINUATION_COL_8_11_ERROR

   5061 18 000145   002000 236003                    LDQ     1024,DU
        18 000146   000011 256100                    ORSQ    9,,PR0

     1013     5062    4                              = TRUE;
     1014     5063    4               END;

     1015     5064    3           END;

   5064 18 000147   000152 710000 18                 TRA     s:5068

     1016     5065    2         ELSE
     1017     5066    2           FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */

   5066 18 000150   004000 236003                    LDQ     2048,DU
        18 000151   000011 256100                    ORSQ    9,,PR0

     1018     5067
     1019     5068    2         IF  FILL_BUFFER.LEVEL < COPY_DEBUG_LEVEL THEN

   5068 18 000152   000001 236100                    LDQ     1,,PR0
        18 000153   000000 116000 15                 CMPQ    COPY_DEBUG_LEVEL
        18 000154   000346 605000 18                 TPL     GNSLEOF

     1020     5069    2            COPY_DEBUG_LEVEL = 0;

   5069 18 000155   000000 450000 15                 STZ     COPY_DEBUG_LEVEL

     1021     5070    2       END;

   5070 18 000156   000346 710000 18                 TRA     GNSLEOF

     1022     5071
     1023     5072        %EJECT;
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:251  
     1024     5073        /*===========================*/
     1025     5074        /* Process Fixed Format Line */
     1026     5075        /*===========================*/
     1027     5076
     1028     5077    1     ELSE
     1029     5078    2       DO;

     1030     5079    2         IF  FILL_BUFFER.LINE_LENGTH > 80

   5079 18 000157   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        18 000160   000012 235100                    LDA     10,,PR0
        18 000161   000120 115007                    CMPA    80,DL
        18 000162   000201 604400 18                 TMOZ    s:5084
        18 000163   000001 234000 0                  SZN     LINE_GT_80_ISSUED
        18 000164   000201 604000 18                 TMI     s:5084

     1031     5080    3         AND LINE_GT_80_ISSUED = FALSE THEN DO ;

     1032     5081    3           CALL Z8AE$ERROR (%E$LINE_LENGTH_GT_80, FILL_BUFFER.ISN, 80) ;

   5081 18 000165   000010 236000 19                 LDQ     8
        18 000166   000004 756000 0                  STQ     LINE_GT_80_ISSUED+3
        18 000167   000000 236000 4                  LDQ     LOOKAHEAD_BUFFER$
        18 000170   000004 036003                    ADLQ    4,DU
        18 000171   000011 235000 19                 LDA     9
        18 000172   000002 757000 0                  STAQ    LINE_GT_80_ISSUED+1
        18 000173   000002 630400 0                  EPPR0   LINE_GT_80_ISSUED+1
        18 000174   000005 631400 19                 EPPR1   5
        18 000175   000000 701000 xent               TSX1    Z8AE$ERROR
        18 000176   000000 011000                    NOP     0

     1033     5082    3           LINE_GT_80_ISSUED = TRUE ;

   5082 18 000177   400000 236003                    LDQ     -131072,DU
        18 000200   000001 756000 0                  STQ     LINE_GT_80_ISSUED

     1034     5083    3         END ; /* Line > 80 bytes -- first time only */
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:252  

     1035     5084    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.LINE_LENGTH, 72);

   5084 18 000201   000110 236007                    LDQ     72,DL
        18 000202   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        18 000203   000206 604000 18                 TMI     s:5084+5
        18 000204   000012 116100                    CMPQ    10,,PR0
        18 000205   000207 604400 18                 TMOZ    s:5084+6
        18 000206   000012 236100                    LDQ     10,,PR0
        18 000207   000003 756100                    STQ     3,,PR0

     1036     5085    2         CALL SEARCHR(FILL_BUFFER.COLUMN,

   5085 18 000210   000012 720100                    LXL0    10,,PR0
        18 000211   000003 721100                    LXL1    3,,PR0
        18 000212   000000 165540                    TCTR
        18 000213   000013 000011                    ADSC9   11,,PR0                  cn=0,n=*X1
        18 000214   000000 000000 xsym               ARG     BLANK_SCAN_TABLE
        18 000215   000000 000100                    ARG     0,,PR0
        18 000216   000000 235100                    LDA     0,,PR0
        18 000217   000033 771000                    ARL     27
        18 000220   000000 471400 4                  LDP1    LOOKAHEAD_BUFFER$
        18 000221   100010 755100                    STA     8,,PR1
        18 000222   000000 551140                    STBA    0,'40'O,PR0
        18 000223   000226 606400 18                 TTN     s:5090
        18 000224   000000 054100                    AOS     0,,PR0
        18 000225   000000 156100                    SSQ     0,,PR0

     1037     5086    2                      FILL_BUFFER.CLASS,
     1038     5087    2                      BLANK_SCAN_TABLE,
     1039     5088    2                      FILL_BUFFER.SOURCE_LINE,
     1040     5089    2                      FILL_BUFFER.STRIPPED_LINE_LENGTH);
     1041     5090    2         FILL_BUFFER.STRIPPED_LINE_LENGTH = MINIMUM(FILL_BUFFER.STRIPPED_LINE_LENGTH,

   5090 18 000226   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        18 000227   000000 236100                    LDQ     0,,PR0
        18 000230   000001 036007                    ADLQ    1,DL
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:253  
        18 000231   000003 116100                    CMPQ    3,,PR0
        18 000232   000234 604400 18                 TMOZ    s:5090+6
        18 000233   000003 236100                    LDQ     3,,PR0
        18 000234   000003 756100                    STQ     3,,PR0

     1042     5091    2                                           FILL_BUFFER.COLUMN + 1);
     1043     5092    2         IF FILL_BUFFER.STRIPPED_LINE_LENGTH > 6 THEN

   5092 18 000235   000006 116007                    CMPQ    6,DL
        18 000236   000340 604400 18                 TMOZ    s:5130

     1044     5093    3           DO;

     1045     5094    3             IF SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = '*'

   5094 18 000237   000012 720100                    LXL0    10,,PR0
        18 000240   000014 236100                    LDQ     12,,PR0
        18 000241   777000 376007                    ANQ     -512,DL
        18 000242   052000 116007                    CMPQ    21504,DL
        18 000243   000250 600000 18                 TZE     s:5096
        18 000244   000014 236100                    LDQ     12,,PR0
        18 000245   777000 376007                    ANQ     -512,DL
        18 000246   057000 116007                    CMPQ    24064,DL
        18 000247   000253 601000 18                 TNZ     s:5099

     1046     5095    3                  OR SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = '/' THEN
     1047     5096    3               FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;

   5096 18 000250   004000 236003                    LDQ     2048,DU
        18 000251   000011 256100                    ORSQ    9,,PR0
        18 000252   000342 710000 18                 TRA     s:5132

     1048     5097    3             ELSE
     1049     5098    4               DO;

     1050     5099    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = '-' THEN

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:254  
   5099 18 000253   000014 236100                    LDQ     12,,PR0
        18 000254   777000 376007                    ANQ     -512,DL
        18 000255   055000 116007                    CMPQ    23040,DL
        18 000256   000262 601000 18                 TNZ     s:5102

     1051     5100    4                   FILL_BUFFER.LINE_TYPE.CONTINUATION = TRUE;

   5100 18 000257   400000 236003                    LDQ     -131072,DU
        18 000260   000011 256100                    ORSQ    9,,PR0
        18 000261   000273 710000 18                 TRA     s:5110

     1052     5101    4                 ELSE
     1053     5102    4                   IF COPY_DEBUG_LEVEL > 0

   5102 18 000262   000000 235000 15                 LDA     COPY_DEBUG_LEVEL
        18 000263   000273 604400 18                 TMOZ    s:5110
        18 000264   000000 236000 15                 LDQ     COPY_DEBUG_LEVEL
        18 000265   000001 116100                    CMPQ    1,,PR0
        18 000266   000273 605400 18                 TPNZ    s:5110

     1054     5103    4                       AND COPY_DEBUG_LEVEL <= FILL_BUFFER.LEVEL THEN
     1055     5104    5                     DO;

     1056     5105    5                       FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;

   5105 18 000267   010000 236003                    LDQ     4096,DU
        18 000270   000011 256100                    ORSQ    9,,PR0

     1057     5106    5                       SUBSTR(FILL_BUFFER.SOURCE_LINE,

   5106 18 000271   104000 236007                    LDQ     34816,DL
        18 000272   000014 552110                    STBQ    12,'10'O,PR0

     1058     5107    5                              6,
     1059     5108    5                              1) = 'D';
     1060     5109    5                     END;

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:255  
     1061     5110    4                 IF SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = 'D'

   5110 18 000273   000014 236100                    LDQ     12,,PR0
        18 000274   777000 376007                    ANQ     -512,DL
        18 000275   104000 116007                    CMPQ    34816,DL
        18 000276   000303 600000 18                 TZE     s:5112
        18 000277   000014 236100                    LDQ     12,,PR0
        18 000300   777000 376007                    ANQ     -512,DL
        18 000301   144000 116007                    CMPQ    51200,DL
        18 000302   000305 601000 18                 TNZ     s:5113

     1062     5111    4                      OR SUBSTR(FILL_BUFFER.SOURCE_LINE,6,1) = 'd' THEN
     1063     5112    4                   FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;

   5112 18 000303   010000 236003                    LDQ     4096,DU
        18 000304   000011 256100                    ORSQ    9,,PR0

     1064     5113    4                 CALL SEARCH (FILL_BUFFER.COLUMN,

   5113 18 000305   000003 721100                    LXL1    3,,PR0
        18 000306   777771 622011                    EAX2    -7,X1
        18 000307   000000 164540                    TCT
        18 000310   000014 600012                    ADSC9   12,,PR0                  cn=3,n=*X2
        18 000311   000000 000000 xsym               ARG     BLANK_SCAN_TABLE
        18 000312   000000 000100                    ARG     0,,PR0
        18 000313   000000 235100                    LDA     0,,PR0
        18 000314   000033 771000                    ARL     27
        18 000315   000000 471400 4                  LDP1    LOOKAHEAD_BUFFER$
        18 000316   100010 755100                    STA     8,,PR1
        18 000317   000000 551140                    STBA    0,'40'O,PR0
        18 000320   000007 236007                    LDQ     7,DL
        18 000321   000000 056100                    ASQ     0,,PR0

     1065     5114    4                              FILL_BUFFER.CLASS,
     1066     5115    4                              BLANK_SCAN_TABLE,
     1067     5116    4                              SUBSTR(FILL_BUFFER.SOURCE_LINE,
     1068     5117    4                                       0,
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:256  
     1069     5118    4                                       FILL_BUFFER.STRIPPED_LINE_LENGTH),
     1070     5119    4                              7);
     1071     5120    4                 IF FILL_BUFFER.COLUMN >= FILL_BUFFER.STRIPPED_LINE_LENGTH THEN

   5120 18 000322   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        18 000323   000000 236100                    LDQ     0,,PR0
        18 000324   000003 116100                    CMPQ    3,,PR0
        18 000325   000331 604000 18                 TMI     s:5123

     1072     5121    4                   FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */

   5121 18 000326   004000 236003                    LDQ     2048,DU
        18 000327   000011 256100                    ORSQ    9,,PR0
        18 000330   000342 710000 18                 TRA     s:5132

     1073     5122    4                 ELSE
     1074     5123    4                   IF FILL_BUFFER.LINE_TYPE.CONTINUATION

   5123 18 000331   000011 234100                    SZN     9,,PR0
        18 000332   000342 605000 18                 TPL     s:5132
        18 000333   000013 116007                    CMPQ    11,DL
        18 000334   000342 605000 18                 TPL     s:5132

     1075     5124    4                         AND FILL_BUFFER.COLUMN < 11 THEN
     1076     5125    4                     FILL_BUFFER.LINE_TYPE.CONTINUATION_COL_8_11_ERROR

   5125 18 000335   002000 236003                    LDQ     1024,DU
        18 000336   000011 256100                    ORSQ    9,,PR0

     1077     5126    4                              = TRUE;
     1078     5127    4               END;

     1079     5128    3           END;

   5128 18 000337   000342 710000 18                 TRA     s:5132

     1080     5129    2         ELSE
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:257  
     1081     5130    2           FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE = TRUE;  /* BLANK LINE */

   5130 18 000340   004000 236003                    LDQ     2048,DU
        18 000341   000011 256100                    ORSQ    9,,PR0

     1082     5131
     1083     5132    2         IF  FILL_BUFFER.LEVEL < COPY_DEBUG_LEVEL THEN

   5132 18 000342   000001 236100                    LDQ     1,,PR0
        18 000343   000000 116000 15                 CMPQ    COPY_DEBUG_LEVEL
        18 000344   000346 605000 18                 TPL     GNSLEOF

     1084     5133    2            COPY_DEBUG_LEVEL = 0;

   5133 18 000345   000000 450000 15                 STZ     COPY_DEBUG_LEVEL

     1085     5134    2       END;

     1086     5135
     1087     5136
     1088     5137
     1089     5138    1   GNSLEOF:
     1090     5139    1     RETURN;

   5139 18 000346   000000 221200 0     GNSLEOF      LDX1  ! 0
        18 000347   000001 702211                    TSX2  ! 1,X1
     1091     5140
     1092     5141    1   END Z8EL$GET_CHECK_SRC_LINE;
     1093     5142        %EOD;

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:258  
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$GET_CHECK_SRC_LINE.
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:259  

 **** Variables and constants ****

  ****  Section 000  Data  Z8EL$GET_CHECK_SRC_LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b BIT         r     1 LINE_GT_80_ISSUED

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 003 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 004 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:260  
  ****  Section 005 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 006 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 007 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 008 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 009 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 010 LblCom ISN_FOR_EXP_SRC

PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:261  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 011 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 012 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 013 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 014 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 015 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:262  

     0-0-0/w SBIN        r     1 COPY_DEBUG_LEVEL

  ****  Section 016 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 017 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4608)        1 ANSI_USERWORD_SCAN_TABLE
     0-0-0/w STRC(4608)        1 ASCII_SEARCH_TABLE         0-0-0/w STRC(4608)  r     1 BLANK_SCAN_TABLE
     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/c CHAR              1 CURRENCY_SIGN_CHARS(0:511)
     0-0-0/w STRC(4608)        1 DBL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 DIGIT_SCAN_TABLE
     0-0-0/w STRC(4608)        1 DOUBLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 LETTER_SEARCH_TABLE
     0-0-0/c CHAR              1 LOWER_TO_UPPER_CASE(0:511)
     0-0-0/w STRC(4608)        1 SEPARATORS_TABLE
     0-0-0/w STRC(4608)        1 SINGLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 SNGL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 USERWORD_SCAN_TABLE

  ****  BASED and DCB variables  ****
PL6.E3A0      #002=Z8EL$GET_CHECK_SRC_LINE File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:07 Page:263  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR              1 BUFFER_LINE                0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(252)         1 REPLACE_ITEM


   Procedure Z8EL$GET_CHECK_SRC_LINE requires 232 words for executable code.
   Procedure Z8EL$GET_CHECK_SRC_LINE is declared NOAUTO and requires 6 words of local(STATIC) storage.

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:264  
     1094        1        /*T***********************************************************/
     1095        2        /*T*                                                         */
     1096        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1097        4        /*T*                                                         */
     1098        5        /*T***********************************************************/
     1099        6        Z8EL$GET_NEXT_SCANNER_LINE : PROC NOAUTO;
     1100        7
     1101        8        %EQU PHASE = 1;
     1102        9        %INCLUDE Z8A_DEFC;
     1103       77        %INCLUDE Z8A_SUPP_MAC;
     1104     2477        %INCLUDE Z9A_FLAGS;
     1105     2491        %INCLUDE Z8A_COMCOM;
     1106     3141        %INCLUDE Z8E_BUFFERS;
     1107     3331        %INCLUDE Z8E_TABLES;
     1108     3884        %INCLUDE Z8E_WINDOW;
     1109     5954        %INCLUDE Z8A_ERR_NUMS;
     1110     6718        %INCLUDE Z8E_STACKS ; /* Required for Z8E_O1COM -- LENGTH_LX_ITEM */
     1111     8984        %INCLUDE Z8E_O1COM ;
     1112     9745
     1113     9746    1   DCL Z8EL$GET_CHECK_SRC_LINE ENTRY;
     1114     9747    1   DCL Z8AE$ERROR ENTRY(12);
     1115     9748    1   DCL Z8EL$DUMP_USED_LINES ENTRY;
     1116     9749
     1117     9750    1   DCL NEXT_CURRENT_BUFFER$ PTR;
     1118     9751
     1119     9752
     1120     9753    1     ADD_NON_CURRENT_LEVEL_LINE : PROC(BUFFER$);
     1121     9754
     1122     9755    2       DCL BUFFER$ PTR;
     1123     9756
     1124     9757    2       DCL CP$ PTR;
     1125     9758
     1126     9759    2       CP$ = BUFFER$;
     1127     9760    3       DO WHILE CP$ -> FILL_BUFFER.NEXT$ ~= ADDR(NIL)
     1128     9761    3             AND CP$ -> FILL_BUFFER.LEVEL
     1129     9762    3                   >= LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL;
     1130     9763
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:265  
     1131     9764    3         CP$ = CP$ -> FILL_BUFFER.NEXT$;
     1132     9765
     1133     9766    3       END;
     1134     9767
     1135     9768    2       LOOKAHEAD_BUFFER$ -> FILL_BUFFER.NEXT$
     1136     9769    2               = CP$ -> FILL_BUFFER.NEXT$;
     1137     9770    2       CP$ -> FILL_BUFFER.NEXT$ = LOOKAHEAD_BUFFER$;
     1138     9771
     1139     9772    2     END ADD_NON_CURRENT_LEVEL_LINE;
     1140     9773
     1141     9774
     1142     9775        /* Get current record */
     1143     9776    2   DO UNTIL (NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE
     1144     9777    2               AND (O1COM.DEBUGGING_MODE
     1145     9778    2                    OR NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE)
     1146     9779    2             OR O1COM.PSEUDO_TEXT_FLAG
     1147     9780    2                AND O1COM.REPLACE_BY_FLAG)
     1148     9781    2        AND NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE
     1149     9782    2        AND NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.IDS_LINE;
     1150     9783
     1151     9784    2     IF CURRENT_BUFFER$ = ADDR(NIL) THEN
     1152     9785    3       DO;
     1153     9786    3         CALL Z8EL$GET_CHECK_SRC_LINE;
     1154     9787    3         CURRENT_BUFFER$ = LOOKAHEAD_BUFFER$;
     1155     9788    3         LINE_LIST$ = LOOKAHEAD_BUFFER$;
     1156     9789    3       END;
     1157     9790    2     ELSE
     1158     9791    3       DO;
     1159     9792    3         IF CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = ADDR(NIL)
     1160     9793    3               OR
     1161     9794    3            CURRENT_LINE_LEVEL > CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$
     1162     9795    3                                     -> FILL_BUFFER.LEVEL THEN
     1163     9796    4           DO;
     1164     9797    4             CALL Z8EL$GET_CHECK_SRC_LINE;
     1165     9798    4             IF LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL
     1166     9799    4                    = CURRENT_LINE_LEVEL THEN
     1167     9800    5               DO;
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:266  
     1168     9801    5                 LOOKAHEAD_BUFFER$ -> FILL_BUFFER.NEXT$
     1169     9802    5                        = CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;
     1170     9803    5                 CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = LOOKAHEAD_BUFFER$;
     1171     9804    5               END;
     1172     9805    4             ELSE
     1173     9806    5               DO;
     1174     9807    5                 CURRENT_LINE_LEVEL = LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL;
     1175     9808    5                 CALL ADD_NON_CURRENT_LEVEL_LINE (CURRENT_BUFFER$);
     1176     9809    5               END;
     1177     9810    4           END;
     1178     9811    3         CURRENT_BUFFER$ = CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;
     1179     9812    3       END;
     1180     9813
     1181     9814    2     EXPANDED_ISN = EXPANDED_ISN + 1;
     1182     9815    2     CURRENT_BUFFER$ -> FILL_BUFFER.ISN = EXPANDED_ISN;
     1183     9816
     1184     9817    2   END;  /* Do until */
     1185     9818
     1186     9819    1   IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE THEN
     1187     9820    2     DO; /* Possible only in pseudotext */
     1188     9821    2       IF CURRENT_BUFFER$ -> FILL_BUFFER.STRIPPED_LINE_LENGTH <
     1189     9822    2           O1COM.AREA_A_COLUMN_START THEN
     1190     9823    3         DO;
     1191     9824    3           CURRENT_BUFFER$ -> FILL_BUFFER.COLUMN = CURRENT_BUFFER$ -> FILL_BUFFER.
              9824                    STRIPPED_LINE_LENGTH;
     1192     9825    3           CURRENT_BUFFER$ -> FILL_BUFFER.CLASS = %END_OF_LINE;
     1193     9826    3         END;
     1194     9827    2       ELSE
     1195     9828    2         CALL SEARCH (CURRENT_BUFFER$ -> FILL_BUFFER.COLUMN,
     1196     9829    2                      CURRENT_BUFFER$ -> FILL_BUFFER.CLASS,
     1197     9830    2                      BLANK_SCAN_TABLE,
     1198     9831    2                      SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     1199     9832    2                              0,
     1200     9833    2                              CURRENT_BUFFER$ -> FILL_BUFFER.STRIPPED_LINE_LENGTH),
     1201     9834    2                      O1COM.AREA_A_COLUMN_START);
     1202     9835    2     END;
     1203     9836
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:267  
     1204     9837        /* Get possible continuation record */
     1205     9838
     1206     9839    1   NEXT_CURRENT_BUFFER$ = CURRENT_BUFFER$;
     1207     9840
     1208     9841    2   DO UNTIL NOT NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE
     1209     9842    2         AND NOT NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE
     1210     9843    2         AND NOT NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.IDS_LINE;
     1211     9844
     1212     9845    2     IF NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = ADDR(NIL)
     1213     9846    2           OR
     1214     9847    2          CURRENT_LINE_LEVEL > NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$
     1215     9848    2                                    -> FILL_BUFFER.LEVEL THEN
     1216     9849    3       DO;
     1217     9850    3         CALL Z8EL$GET_CHECK_SRC_LINE;
     1218     9851    3         IF LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL = CURRENT_LINE_LEVEL THEN
     1219     9852    4           DO;
     1220     9853    4             LOOKAHEAD_BUFFER$ -> FILL_BUFFER.NEXT$
     1221     9854    4                   = NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;
     1222     9855    4             NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = LOOKAHEAD_BUFFER$;
     1223     9856    4           END;
     1224     9857    3         ELSE
     1225     9858    4           DO;
     1226     9859    4             CURRENT_LINE_LEVEL = LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL;
     1227     9860    4             CALL ADD_NON_CURRENT_LEVEL_LINE (NEXT_CURRENT_BUFFER$);
     1228     9861    4           END;
     1229     9862    3       END;
     1230     9863    2     NEXT_CURRENT_BUFFER$ = NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;
     1231     9864    2   END;  /* DO UNTIL */
     1232     9865
     1233     9866    1   LOOKAHEAD_BUFFER$ = NEXT_CURRENT_BUFFER$;
     1234     9867
     1235     9868
     1236     9869
     1237     9870    1     CALL Z8EL$DUMP_USED_LINES;
     1238     9871
     1239     9872    1     BUFFER.COLUMN = CURRENT_BUFFER$ -> FILL_BUFFER.COLUMN;
     1240     9873    1     BUFFER.CLASS = CURRENT_BUFFER$ -> FILL_BUFFER.CLASS;
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:268  
     1241     9874    1     BUFFER.ISN = CURRENT_BUFFER$ -> FILL_BUFFER.ISN;
     1242     9875    1     BUFFER.LEVEL = CURRENT_BUFFER$ -> FILL_BUFFER.LEVEL;
     1243     9876    1     BUFFER.LINE_TYPE.LINE_CONTINUED = LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LINE_TYPE.
              9876              CONTINUATION;
     1244     9877    1     BUFFER.LINE_TYPE.DEBUG_LINE = CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE;
     1245     9878    1     BUFFER.LINE_LENGTH = CURRENT_BUFFER$ -> FILL_BUFFER.STRIPPED_LINE_LENGTH;
     1246     9879    1     BUFFER.LINE$ = ADDR(CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE);
     1247     9880
     1248     9881    1     IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.CONTINUATION_COL_8_11_ERROR AND
     1249     9882              %IF GCOS;
     1252     9885              %ENDIF;
     1253     9886    1         COMCOM.OB.FIPS.LEVEL >= %HIGH_LEV THEN
     1254     9887    2       DO;
     1255     9888    2         CALL Z8AE$ERROR(%E$CONT_COL_8_11_ERROR,
     1256     9889    2                         CURRENT_BUFFER$ -> FILL_BUFFER.ISN,
     1257     9890    2                         O1COM.AREA_B_COLUMN_START);
     1258     9891    2       END;
     1259     9892
     1260     9893    1     RETURN;
     1261     9894
     1262     9895    1   END Z8EL$GET_NEXT_SCANNER_LINE;
     1263     9896        %EOD;

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:269  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$GET_NEXT_SCANNER_LINE.

   Procedure Z8EL$GET_NEXT_SCANNER_LINE requires 198 words for executable code.
   Procedure Z8EL$GET_NEXT_SCANNER_LINE is declared NOAUTO and requires 10 words of local(STATIC) storage.

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:270  

 Object Unit name= Z8EL$GET_NEXT_SCANNER_LINE                 File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:08:06.60 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    10     12  Z8EL$GET_NEXT_SCANNER_LINE
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  SCANNER_STATE
    3  LblCom even  none     1      1  CURRENT_BUFFER$
    4  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    5  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    6  LblCom even  none     1      1  LINE_LIST$
    7  LblCom even  none     7      7  BUFFER
    8  LblCom even  none     1      1  ORIGINAL_ISN
    9  LblCom even  none     1      1  EXPANDED_ISN
   10  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   11  LblCom even  none    90    132  LEX_SYMBOL
   12  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   13  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   14  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   15   Proc  even  none   198    306  Z8EL$GET_NEXT_SCANNER_LINE
   16  RoData even  none     8     10  Z8EL$GET_NEXT_SCANNER_LINE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    15      0   yes            yes      Std        0  Z8EL$GET_NEXT_SCANNER_LINE
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:271  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8EL$GET_CHECK_SRC_LINE
         yes           Std       0 Z8EL$DUMP_USED_LINES
         yes           Std      12 Z8AE$ERROR

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    USERWORD_SCAN_TABLE              r    ANSI_USERWORD_SCAN_TABLE
r    ASCII_SEARCH_TABLE               r    BLANK_SCAN_TABLE                 r    DIGIT_SCAN_TABLE
r    LETTER_SEARCH_TABLE              r    DOUBLE_QUOTE_SEARCH_TABLE        r    SINGLE_QUOTE_SEARCH_TABLE
r    DBL_QUOTE_PSEUDO_SEARCH_TABLE    r    SNGL_QUOTE_PSEUDO_SEARCH_TABLE   r    SEPARATORS_TABLE
r    LOWER_TO_UPPER_CASE              r    CURRENCY_SIGN_CHARS                   O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:272  


     1094        1        /*T***********************************************************/
     1095        2        /*T*                                                         */
     1096        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1097        4        /*T*                                                         */
     1098        5        /*T***********************************************************/
     1099        6        Z8EL$GET_NEXT_SCANNER_LINE : PROC NOAUTO;

      6 15 000000   000000 741200 0     Z8EL$GET_NE* STX1  ! 0
        15 000001   000031 710000 15                 TRA     s:9784

     1100        7
     1101        8        %EQU PHASE = 1;
     1102        9        %INCLUDE Z8A_DEFC;
     1103       77        %INCLUDE Z8A_SUPP_MAC;
     1104     2477        %INCLUDE Z9A_FLAGS;
     1105     2491        %INCLUDE Z8A_COMCOM;
     1106     3141        %INCLUDE Z8E_BUFFERS;
     1107     3331        %INCLUDE Z8E_TABLES;
     1108     3884        %INCLUDE Z8E_WINDOW;
     1109     5954        %INCLUDE Z8A_ERR_NUMS;
     1110     6718        %INCLUDE Z8E_STACKS ; /* Required for Z8E_O1COM -- LENGTH_LX_ITEM */
     1111     8984        %INCLUDE Z8E_O1COM ;
     1112     9745
     1113     9746    1   DCL Z8EL$GET_CHECK_SRC_LINE ENTRY;
     1114     9747    1   DCL Z8AE$ERROR ENTRY(12);
     1115     9748    1   DCL Z8EL$DUMP_USED_LINES ENTRY;
     1116     9749
     1117     9750    1   DCL NEXT_CURRENT_BUFFER$ PTR;
     1118     9751
     1119     9752
     1120     9753    1     ADD_NON_CURRENT_LEVEL_LINE : PROC(BUFFER$);

   9753 15 000002   000002 741200 0     ADD_NON_CUR* STX1  ! NEXT_CURRENT_BUFFER$+1

     1121     9754
     1122     9755    2       DCL BUFFER$ PTR;
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:273  
     1123     9756
     1124     9757    2       DCL CP$ PTR;
     1125     9758
     1126     9759    2       CP$ = BUFFER$;

   9759 15 000003   000003 470400 0                  LDP0    @BUFFER$
        15 000004   000000 236100                    LDQ     0,,PR0
        15 000005   000004 756000 0                  STQ     CP$

     1127     9760    3       DO WHILE CP$ -> FILL_BUFFER.NEXT$ ~= ADDR(NIL)

   9760 15 000006   000012 710000 15                 TRA     s:9766

     1128     9761    3             AND CP$ -> FILL_BUFFER.LEVEL
     1129     9762    3                   >= LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL;
     1130     9763
     1131     9764    3         CP$ = CP$ -> FILL_BUFFER.NEXT$;

   9764 15 000007   000004 470400 0                  LDP0    CP$
        15 000010   000002 236100                    LDQ     2,,PR0
        15 000011   000004 756000 0                  STQ     CP$

     1132     9765
     1133     9766    3       END;

   9766 15 000012   000004 470400 0                  LDP0    CP$
        15 000013   000002 236100                    LDQ     2,,PR0
        15 000014   000000 116000 16                 CMPQ    0
        15 000015   000022 600000 15                 TZE     s:9768
        15 000016   000000 471400 4                  LDP1    LOOKAHEAD_BUFFER$
        15 000017   000001 236100                    LDQ     1,,PR0
        15 000020   100001 116100                    CMPQ    1,,PR1
        15 000021   000007 605000 15                 TPL     s:9764

     1134     9767
     1135     9768    2       LOOKAHEAD_BUFFER$ -> FILL_BUFFER.NEXT$

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:274  
   9768 15 000022   000002 236100                    LDQ     2,,PR0
        15 000023   000000 471400 4                  LDP1    LOOKAHEAD_BUFFER$
        15 000024   100002 756100                    STQ     2,,PR1

     1136     9769    2               = CP$ -> FILL_BUFFER.NEXT$;
     1137     9770    2       CP$ -> FILL_BUFFER.NEXT$ = LOOKAHEAD_BUFFER$;

   9770 15 000025   000000 236000 4                  LDQ     LOOKAHEAD_BUFFER$
        15 000026   000002 756100                    STQ     2,,PR0

     1138     9771
     1139     9772    2     END ADD_NON_CURRENT_LEVEL_LINE;

   9772 15 000027   000002 221200 0                  LDX1  ! NEXT_CURRENT_BUFFER$+1
        15 000030   000001 702211                    TSX2  ! 1,X1

     1140     9773
     1141     9774
     1142     9775        /* Get current record */
     1143     9776    2   DO UNTIL (NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE

     1144     9777    2               AND (O1COM.DEBUGGING_MODE
     1145     9778    2                    OR NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE)
     1146     9779    2             OR O1COM.PSEUDO_TEXT_FLAG
     1147     9780    2                AND O1COM.REPLACE_BY_FLAG)
     1148     9781    2        AND NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE
     1149     9782    2        AND NOT CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.IDS_LINE;
     1150     9783
     1151     9784    2     IF CURRENT_BUFFER$ = ADDR(NIL) THEN

   9784 15 000031   000000 236000 3                  LDQ     CURRENT_BUFFER$
        15 000032   000000 116000 16                 CMPQ    0
        15 000033   000043 601000 15                 TNZ     s:9792

     1152     9785    3       DO;

     1153     9786    3         CALL Z8EL$GET_CHECK_SRC_LINE;
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:275  

   9786 15 000034   000001 631400 16                 EPPR1   1
        15 000035   000000 701000 xent               TSX1    Z8EL$GET_CHECK_SRC_LINE
        15 000036   000000 011000                    NOP     0

     1154     9787    3         CURRENT_BUFFER$ = LOOKAHEAD_BUFFER$;

   9787 15 000037   000000 236000 4                  LDQ     LOOKAHEAD_BUFFER$
        15 000040   000000 756000 3                  STQ     CURRENT_BUFFER$

     1155     9788    3         LINE_LIST$ = LOOKAHEAD_BUFFER$;

   9788 15 000041   000000 756000 6                  STQ     LINE_LIST$

     1156     9789    3       END;

   9789 15 000042   000100 710000 15                 TRA     s:9814

     1157     9790    2     ELSE
     1158     9791    3       DO;

     1159     9792    3         IF CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = ADDR(NIL)

   9792 15 000043   000000 470400 3                  LDP0    CURRENT_BUFFER$
        15 000044   000002 236100                    LDQ     2,,PR0
        15 000045   000000 116000 16                 CMPQ    0
        15 000046   000053 600000 15                 TZE     s:9797
        15 000047   000002 471500                    LDP1    2,,PR0
        15 000050   000000 236000 5                  LDQ     CURRENT_LINE_LEVEL
        15 000051   100001 116100                    CMPQ    1,,PR1
        15 000052   000075 604400 15                 TMOZ    s:9811

     1160     9793    3               OR
     1161     9794    3            CURRENT_LINE_LEVEL > CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$
     1162     9795    3                                     -> FILL_BUFFER.LEVEL THEN
     1163     9796    4           DO;

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:276  
     1164     9797    4             CALL Z8EL$GET_CHECK_SRC_LINE;

   9797 15 000053   000001 631400 16                 EPPR1   1
        15 000054   000000 701000 xent               TSX1    Z8EL$GET_CHECK_SRC_LINE
        15 000055   000000 011000                    NOP     0

     1165     9798    4             IF LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL

   9798 15 000056   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        15 000057   000001 236100                    LDQ     1,,PR0
        15 000060   000000 116000 5                  CMPQ    CURRENT_LINE_LEVEL
        15 000061   000070 601000 15                 TNZ     s:9807

     1166     9799    4                    = CURRENT_LINE_LEVEL THEN
     1167     9800    5               DO;

     1168     9801    5                 LOOKAHEAD_BUFFER$ -> FILL_BUFFER.NEXT$

   9801 15 000062   000000 471400 3                  LDP1    CURRENT_BUFFER$
        15 000063   100002 236100                    LDQ     2,,PR1
        15 000064   000002 756100                    STQ     2,,PR0

     1169     9802    5                        = CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;
     1170     9803    5                 CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = LOOKAHEAD_BUFFER$;

   9803 15 000065   000000 236000 4                  LDQ     LOOKAHEAD_BUFFER$
        15 000066   100002 756100                    STQ     2,,PR1

     1171     9804    5               END;

   9804 15 000067   000075 710000 15                 TRA     s:9811

     1172     9805    4             ELSE
     1173     9806    5               DO;

     1174     9807    5                 CURRENT_LINE_LEVEL = LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL;

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:277  
   9807 15 000070   000000 756000 5                  STQ     CURRENT_LINE_LEVEL

     1175     9808    5                 CALL ADD_NON_CURRENT_LEVEL_LINE (CURRENT_BUFFER$);

   9808 15 000071   000002 236000 16                 LDQ     2
        15 000072   000003 756000 0                  STQ     NEXT_CURRENT_BUFFER$+2
        15 000073   000002 701000 15                 TSX1    ADD_NON_CURRENT_LEVEL_LINE
        15 000074   000000 011000                    NOP     0

     1176     9809    5               END;

     1177     9810    4           END;

     1178     9811    3         CURRENT_BUFFER$ = CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;

   9811 15 000075   000000 470400 3                  LDP0    CURRENT_BUFFER$
        15 000076   000002 236100                    LDQ     2,,PR0
        15 000077   000000 756000 3                  STQ     CURRENT_BUFFER$

     1179     9812    3       END;

     1180     9813
     1181     9814    2     EXPANDED_ISN = EXPANDED_ISN + 1;

   9814 15 000100   000000 054000 9                  AOS     EXPANDED_ISN

     1182     9815    2     CURRENT_BUFFER$ -> FILL_BUFFER.ISN = EXPANDED_ISN;

   9815 15 000101   000000 470400 3                  LDP0    CURRENT_BUFFER$
        15 000102   000000 235000 9                  LDA     EXPANDED_ISN
        15 000103   000004 755100                    STA     4,,PR0

     1183     9816
     1184     9817    2   END;  /* Do until */

   9817 15 000104   000011 236100                    LDQ     9,,PR0
        15 000105   004000 316003                    CANQ    2048,DU
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:278  
        15 000106   000113 601000 15                 TNZ     s:9817+7
        15 000107   000026 234000 xsym               SZN     O1COM+22
        15 000110   000120 604000 15                 TMI     s:9817+12
        15 000111   010000 316003                    CANQ    4096,DU
        15 000112   000120 600000 15                 TZE     s:9817+12
        15 000113   001330 234000 xsym               SZN     O1COM+728
        15 000114   000031 605000 15                 TPL     s:9784
        15 000115   001337 236000 xsym               LDQ     O1COM+735
        15 000116   200000 316003                    CANQ    65536,DU
        15 000117   000031 600000 15                 TZE     s:9784
        15 000120   000011 430100                    FSZN    9,,PR0
        15 000121   000031 604000 15                 TMI     s:9784
        15 000122   000011 236100                    LDQ     9,,PR0
        15 000123   040000 316003                    CANQ    16384,DU
        15 000124   000031 601000 15                 TNZ     s:9784

     1185     9818
     1186     9819    1   IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE THEN

   9819 15 000125   004000 316003                    CANQ    2048,DU
        15 000126   000160 600000 15                 TZE     s:9839

     1187     9820    2     DO; /* Possible only in pseudotext */

     1188     9821    2       IF CURRENT_BUFFER$ -> FILL_BUFFER.STRIPPED_LINE_LENGTH <

   9821 15 000127   000003 236100                    LDQ     3,,PR0
        15 000130   000122 116000 xsym               CMPQ    O1COM+82
        15 000131   000136 605000 15                 TPL     s:9828

     1189     9822    2           O1COM.AREA_A_COLUMN_START THEN
     1190     9823    3         DO;

     1191     9824    3           CURRENT_BUFFER$ -> FILL_BUFFER.COLUMN = CURRENT_BUFFER$ -> FILL_BUFFER.
              9824                    STRIPPED_LINE_LENGTH;

   9824 15 000132   000000 756100                    STQ     0,,PR0
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:279  

     1192     9825    3           CURRENT_BUFFER$ -> FILL_BUFFER.CLASS = %END_OF_LINE;

   9825 15 000133   000000 470400 3                  LDP0    CURRENT_BUFFER$
        15 000134   000010 450100                    STZ     8,,PR0

     1193     9826    3         END;

   9826 15 000135   000160 710000 15                 TRA     s:9839

     1194     9827    2       ELSE
     1195     9828    2         CALL SEARCH (CURRENT_BUFFER$ -> FILL_BUFFER.COLUMN,

   9828 15 000136   000012 720100                    LXL0    10,,PR0
        15 000137   000003 721100                    LXL1    3,,PR0
        15 000140   000000 636011                    EAQ     0,X1
        15 000141   000022 772000                    QRL     18
        15 000142   000122 136000 xsym               SBLQ    O1COM+82
        15 000143   000006 756000 0                  STQ     CP$+2
        15 000144   000122 236000 xsym               LDQ     O1COM+82
        15 000145   000006 721000 0                  LXL1    CP$+2
        15 000146   000000 164546                    TCT
        15 000147   000013 000011                    ADSC9   11,Q,PR0                 cn=0,n=*X1
        15 000150   000000 000000 xsym               ARG     BLANK_SCAN_TABLE
        15 000151   000000 000100                    ARG     0,,PR0
        15 000152   000000 235100                    LDA     0,,PR0
        15 000153   000033 771000                    ARL     27
        15 000154   000000 471400 3                  LDP1    CURRENT_BUFFER$
        15 000155   100010 755100                    STA     8,,PR1
        15 000156   000000 551140                    STBA    0,'40'O,PR0
        15 000157   000000 056100                    ASQ     0,,PR0

     1196     9829    2                      CURRENT_BUFFER$ -> FILL_BUFFER.CLASS,
     1197     9830    2                      BLANK_SCAN_TABLE,
     1198     9831    2                      SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     1199     9832    2                              0,
     1200     9833    2                              CURRENT_BUFFER$ -> FILL_BUFFER.STRIPPED_LINE_LENGTH),
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:280  
     1201     9834    2                      O1COM.AREA_A_COLUMN_START);
     1202     9835    2     END;

     1203     9836
     1204     9837        /* Get possible continuation record */
     1205     9838
     1206     9839    1   NEXT_CURRENT_BUFFER$ = CURRENT_BUFFER$;

   9839 15 000160   000000 236000 3                  LDQ     CURRENT_BUFFER$
        15 000161   000001 756000 0                  STQ     NEXT_CURRENT_BUFFER$

     1207     9840
     1208     9841    2   DO UNTIL NOT NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE

     1209     9842    2         AND NOT NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE
     1210     9843    2         AND NOT NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.IDS_LINE;
     1211     9844
     1212     9845    2     IF NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = ADDR(NIL)

   9845 15 000162   000001 470400 0                  LDP0    NEXT_CURRENT_BUFFER$
        15 000163   000002 236100                    LDQ     2,,PR0
        15 000164   000000 116000 16                 CMPQ    0
        15 000165   000172 600000 15                 TZE     s:9850
        15 000166   000002 471500                    LDP1    2,,PR0
        15 000167   000000 236000 5                  LDQ     CURRENT_LINE_LEVEL
        15 000170   100001 116100                    CMPQ    1,,PR1
        15 000171   000214 604400 15                 TMOZ    s:9863

     1213     9846    2           OR
     1214     9847    2          CURRENT_LINE_LEVEL > NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$
     1215     9848    2                                    -> FILL_BUFFER.LEVEL THEN
     1216     9849    3       DO;

     1217     9850    3         CALL Z8EL$GET_CHECK_SRC_LINE;

   9850 15 000172   000001 631400 16                 EPPR1   1
        15 000173   000000 701000 xent               TSX1    Z8EL$GET_CHECK_SRC_LINE
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:281  
        15 000174   000000 011000                    NOP     0

     1218     9851    3         IF LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL = CURRENT_LINE_LEVEL THEN

   9851 15 000175   000000 470400 4                  LDP0    LOOKAHEAD_BUFFER$
        15 000176   000001 236100                    LDQ     1,,PR0
        15 000177   000000 116000 5                  CMPQ    CURRENT_LINE_LEVEL
        15 000200   000207 601000 15                 TNZ     s:9859

     1219     9852    4           DO;

     1220     9853    4             LOOKAHEAD_BUFFER$ -> FILL_BUFFER.NEXT$

   9853 15 000201   000001 471400 0                  LDP1    NEXT_CURRENT_BUFFER$
        15 000202   100002 236100                    LDQ     2,,PR1
        15 000203   000002 756100                    STQ     2,,PR0

     1221     9854    4                   = NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;
     1222     9855    4             NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$ = LOOKAHEAD_BUFFER$;

   9855 15 000204   000000 236000 4                  LDQ     LOOKAHEAD_BUFFER$
        15 000205   100002 756100                    STQ     2,,PR1

     1223     9856    4           END;

   9856 15 000206   000214 710000 15                 TRA     s:9863

     1224     9857    3         ELSE
     1225     9858    4           DO;

     1226     9859    4             CURRENT_LINE_LEVEL = LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LEVEL;

   9859 15 000207   000000 756000 5                  STQ     CURRENT_LINE_LEVEL

     1227     9860    4             CALL ADD_NON_CURRENT_LEVEL_LINE (NEXT_CURRENT_BUFFER$);

   9860 15 000210   000003 236000 16                 LDQ     3
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:282  
        15 000211   000003 756000 0                  STQ     NEXT_CURRENT_BUFFER$+2
        15 000212   000002 701000 15                 TSX1    ADD_NON_CURRENT_LEVEL_LINE
        15 000213   000000 011000                    NOP     0

     1228     9861    4           END;

     1229     9862    3       END;

     1230     9863    2     NEXT_CURRENT_BUFFER$ = NEXT_CURRENT_BUFFER$ -> FILL_BUFFER.NEXT$;

   9863 15 000214   000001 470400 0                  LDP0    NEXT_CURRENT_BUFFER$
        15 000215   000002 236100                    LDQ     2,,PR0
        15 000216   000001 756000 0                  STQ     NEXT_CURRENT_BUFFER$

     1231     9864    2   END;  /* DO UNTIL */

   9864 15 000217   000001 470400 0                  LDP0    NEXT_CURRENT_BUFFER$
        15 000220   000011 236100                    LDQ     9,,PR0
        15 000221   004000 316003                    CANQ    2048,DU
        15 000222   000162 601000 15                 TNZ     s:9845
        15 000223   000011 430100                    FSZN    9,,PR0
        15 000224   000162 604000 15                 TMI     s:9845
        15 000225   040000 316003                    CANQ    16384,DU
        15 000226   000162 601000 15                 TNZ     s:9845

     1232     9865
     1233     9866    1   LOOKAHEAD_BUFFER$ = NEXT_CURRENT_BUFFER$;

   9866 15 000227   000001 236000 0                  LDQ     NEXT_CURRENT_BUFFER$
        15 000230   000000 756000 4                  STQ     LOOKAHEAD_BUFFER$

     1234     9867
     1235     9868
     1236     9869
     1237     9870    1     CALL Z8EL$DUMP_USED_LINES;

   9870 15 000231   000001 631400 16                 EPPR1   1
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:283  
        15 000232   000000 701000 xent               TSX1    Z8EL$DUMP_USED_LINES
        15 000233   000000 011000                    NOP     0

     1238     9871
     1239     9872    1     BUFFER.COLUMN = CURRENT_BUFFER$ -> FILL_BUFFER.COLUMN;

   9872 15 000234   000000 470400 3                  LDP0    CURRENT_BUFFER$
        15 000235   000000 235100                    LDA     0,,PR0
        15 000236   000000 755000 7                  STA     BUFFER

     1240     9873    1     BUFFER.CLASS = CURRENT_BUFFER$ -> FILL_BUFFER.CLASS;

   9873 15 000237   000010 235100                    LDA     8,,PR0
        15 000240   000001 755000 7                  STA     BUFFER+1

     1241     9874    1     BUFFER.ISN = CURRENT_BUFFER$ -> FILL_BUFFER.ISN;

   9874 15 000241   000004 235100                    LDA     4,,PR0
        15 000242   000002 755000 7                  STA     BUFFER+2

     1242     9875    1     BUFFER.LEVEL = CURRENT_BUFFER$ -> FILL_BUFFER.LEVEL;

   9875 15 000243   000001 235100                    LDA     1,,PR0
        15 000244   000003 755000 7                  STA     BUFFER+3

     1243     9876    1     BUFFER.LINE_TYPE.LINE_CONTINUED = LOOKAHEAD_BUFFER$ -> FILL_BUFFER.LINE_TYPE.
              9876              CONTINUATION;

   9876 15 000245   000000 471400 4                  LDP1    LOOKAHEAD_BUFFER$
        15 000246   100011 236100                    LDQ     9,,PR1
        15 000247   000002 772000                    QRL     2
        15 000250   000004 676000 7                  ERQ     BUFFER+4
        15 000251   100000 376003                    ANQ     32768,DU
        15 000252   000004 656000 7                  ERSQ    BUFFER+4

     1244     9877    1    BUFFER.LINE_TYPE.DEBUG_LINE = CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE;

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:284  
   9877 15 000253   000011 236100                    LDQ     9,,PR0
        15 000254   000004 736000                    QLS     4
        15 000255   000004 676000 7                  ERQ     BUFFER+4
        15 000256   200000 376003                    ANQ     65536,DU
        15 000257   000004 656000 7                  ERSQ    BUFFER+4

     1245     9878    1     BUFFER.LINE_LENGTH = CURRENT_BUFFER$ -> FILL_BUFFER.STRIPPED_LINE_LENGTH;

   9878 15 000260   000003 235100                    LDA     3,,PR0
        15 000261   000005 755000 7                  STA     BUFFER+5

     1246     9879    1     BUFFER.LINE$ = ADDR(CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE);

   9879 15 000262   000000 236000 3                  LDQ     CURRENT_BUFFER$
        15 000263   000013 036003                    ADLQ    11,DU
        15 000264   000006 756000 7                  STQ     BUFFER+6

     1247     9880
     1248     9881    1     IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.CONTINUATION_COL_8_11_ERROR AND

   9881 15 000265   000011 236100                    LDQ     9,,PR0
        15 000266   002000 316003                    CANQ    1024,DU
        15 000267   000304 600000 15                 TZE     s:9893
        15 000270   000036 720000 xsym               LXL0    COMCOM+30
        15 000271   000304 604400 15                 TMOZ    s:9893

     1249     9882              %IF GCOS;
     1252     9885              %ENDIF;
     1253     9886    1         COMCOM.OB.FIPS.LEVEL >= %HIGH_LEV THEN
     1254     9887    2       DO;

     1255     9888    2         CALL Z8AE$ERROR(%E$CONT_COL_8_11_ERROR,

   9888 15 000272   000006 236000 16                 LDQ     6
        15 000273   000010 756000 0                  STQ     CP$+4
        15 000274   000000 236000 3                  LDQ     CURRENT_BUFFER$
        15 000275   000004 036003                    ADLQ    4,DU
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:285  
        15 000276   000007 235000 16                 LDA     7
        15 000277   000006 757000 0                  STAQ    CP$+2
        15 000300   000006 630400 0                  EPPR0   CP$+2
        15 000301   000004 631400 16                 EPPR1   4
        15 000302   000000 701000 xent               TSX1    Z8AE$ERROR
        15 000303   000000 011000                    NOP     0

     1256     9889    2                         CURRENT_BUFFER$ -> FILL_BUFFER.ISN,
     1257     9890    2                         O1COM.AREA_B_COLUMN_START);
     1258     9891    2       END;

     1259     9892
     1260     9893    1     RETURN;

   9893 15 000304   000000 221200 0                  LDX1  ! 0
        15 000305   000001 702211                    TSX2  ! 1,X1
     1261     9894
     1262     9895    1   END Z8EL$GET_NEXT_SCANNER_LINE;
     1263     9896        %EOD;

PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:286  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$GET_NEXT_SCANNER_LINE.
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:287  

 **** Variables and constants ****

  ****  Section 000  Data  Z8EL$GET_NEXT_SCANNER_LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUFFER$                  *0-0-0/w PTR         r     1 BUFFER$
     4-0-0/w PTR         r     1 CP$                        1-0-0/w PTR         r     1 NEXT_CURRENT_BUFFER$

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 003 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_BUFFER$

  ****  Section 004 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:288  

  ****  Section 005 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CURRENT_LINE_LEVEL

  ****  Section 006 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LINE_LIST$

  ****  Section 007 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 008 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 009 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 EXPANDED_ISN

  ****  Section 010 LblCom ISN_FOR_EXP_SRC
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:289  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 011 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 012 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 013 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 014 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:290  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4608)        1 ANSI_USERWORD_SCAN_TABLE
     0-0-0/w STRC(4608)        1 ASCII_SEARCH_TABLE         0-0-0/w STRC(4608)  r     1 BLANK_SCAN_TABLE
     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/c CHAR              1 CURRENCY_SIGN_CHARS(0:511)
     0-0-0/w STRC(4608)        1 DBL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 DIGIT_SCAN_TABLE
     0-0-0/w STRC(4608)        1 DOUBLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w STRC(4608)        1 LETTER_SEARCH_TABLE
     0-0-0/c CHAR              1 LOWER_TO_UPPER_CASE(0:511)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR
     0-0-0/w STRC(4608)        1 SEPARATORS_TABLE
     0-0-0/w STRC(4608)        1 SINGLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 SNGL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 USERWORD_SCAN_TABLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
PL6.E3A0      #003=Z8EL$GET_NEXT_SCANNER_LINE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:08 Page:291  
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$GET_NEXT_SCANNER_LINE requires 198 words for executable code.
   Procedure Z8EL$GET_NEXT_SCANNER_LINE is declared NOAUTO and requires 10 words of local(STATIC) storage.

PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:292  
     1264        1        /*T***********************************************************/
     1265        2        /*T*                                                         */
     1266        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1267        4        /*T*                                                         */
     1268        5        /*T***********************************************************/
     1269        6        Z8EL$DUMP_USED_LINES : PROC NOAUTO;
     1270        7
     1271        8        %EQU PHASE = 1;
     1272        9        %INCLUDE Z8A_DEFC;
     1273       77        %INCLUDE Z8A_SUPP_MAC;
     1274     2477        %INCLUDE Z8E_BUFFERS;
     1275     2667        %INCLUDE Z8E_HEAP;
     1276     2723        %INCLUDE Z8A_COMCOM;
     1277     3373
     1278     3374    1   DCL INHIBIT_DUMP_LINES BOOLEAN EXT INIT(FALSE);
     1279     3375    1   DCL Z9AA$WRITE_LINE_ES ENTRY;
     1280     3376
     1281     3377
     1282     3378    2     DO WHILE (LINE_LIST$ ~= ADDR(NIL))
     1283     3379    2               AND (LINE_LIST$ ~= CURRENT_BUFFER$)
     1284     3380    2               AND NOT INHIBIT_DUMP_LINES
     1285     3381    2               AND (LINE_LIST$ -> FILL_BUFFER.ISN < COMCOM.CURRENT.LINE);
     1286     3382
     1287     3383    2       CALL Z9AA$WRITE_LINE_ES;
     1288     3384
     1289     3385    2       HEAP$ = LINE_LIST$;
     1290     3386    2       LINE_LIST$ = LINE_LIST$ -> FILL_BUFFER.NEXT$;
     1291     3387            %DISPOSE_HEAP(@POINTER=HEAP$, @SIZE=%MAX_INPUT_BUFFER_LEN);
     1292     3392
     1293     3393    2     END;
     1294     3394
     1295     3395    1   END Z8EL$DUMP_USED_LINES;
     1296     3396        %EOD;

PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:293  
--  Include file information  --

   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$DUMP_USED_LINES.

   Procedure Z8EL$DUMP_USED_LINES requires 27 words for executable code.
   Procedure Z8EL$DUMP_USED_LINES is declared NOAUTO and requires 2 words of local(STATIC) storage.

PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:294  

 Object Unit name= Z8EL$DUMP_USED_LINES                       File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:09:17.56 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     2      2  Z8EL$DUMP_USED_LINES
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  SCANNER_STATE
    3  LblCom even  none     1      1  CURRENT_BUFFER$
    4  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    5  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    6  LblCom even  none     1      1  LINE_LIST$
    7  LblCom even  none     7      7  BUFFER
    8  LblCom even  none     1      1  ORIGINAL_ISN
    9  LblCom even  none     1      1  EXPANDED_ISN
   10  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   11  LblCom even  none     1      1  HEAP$
   12  LblCom even  none     1      1  INHIBIT_DUMP_LINES
   13   Proc  even  none    27     33  Z8EL$DUMP_USED_LINES
   14  RoData even  none     6      6  Z8EL$DUMP_USED_LINES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        0  Z8EL$DUMP_USED_LINES
PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:295  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z9AA$WRITE_LINE_ES
         yes           Std       2 Z8ED$DISPOSE_HEAP

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:296  


     1264        1        /*T***********************************************************/
     1265        2        /*T*                                                         */
     1266        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1267        4        /*T*                                                         */
     1268        5        /*T***********************************************************/
     1269        6        Z8EL$DUMP_USED_LINES : PROC NOAUTO;

      6 13 000000   000000 741200 0     Z8EL$DUMP_U* STX1  ! 0

     1270        7
     1271        8        %EQU PHASE = 1;
     1272        9        %INCLUDE Z8A_DEFC;
     1273       77        %INCLUDE Z8A_SUPP_MAC;
     1274     2477        %INCLUDE Z8E_BUFFERS;
     1275     2667        %INCLUDE Z8E_HEAP;
     1276     2723        %INCLUDE Z8A_COMCOM;
     1277     3373
     1278     3374    1   DCL INHIBIT_DUMP_LINES BOOLEAN EXT INIT(FALSE);
     1279     3375    1   DCL Z9AA$WRITE_LINE_ES ENTRY;
     1280     3376
     1281     3377
     1282     3378    2     DO WHILE (LINE_LIST$ ~= ADDR(NIL))

   3378 13 000001   000016 710000 13                 TRA     s:3393

     1283     3379    2               AND (LINE_LIST$ ~= CURRENT_BUFFER$)
     1284     3380    2               AND NOT INHIBIT_DUMP_LINES
     1285     3381    2               AND (LINE_LIST$ -> FILL_BUFFER.ISN < COMCOM.CURRENT.LINE);
     1286     3382
     1287     3383    2       CALL Z9AA$WRITE_LINE_ES;

   3383 13 000002   000000 631400 14                 EPPR1   0
        13 000003   000000 701000 xent               TSX1    Z9AA$WRITE_LINE_ES
        13 000004   000000 011000                    NOP     0

     1288     3384
PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:297  
     1289     3385    2       HEAP$ = LINE_LIST$;

   3385 13 000005   000000 236000 6                  LDQ     LINE_LIST$
        13 000006   000000 756000 11                 STQ     HEAP$

     1290     3386    2       LINE_LIST$ = LINE_LIST$ -> FILL_BUFFER.NEXT$;

   3386 13 000007   000000 470400 6                  LDP0    LINE_LIST$
        13 000010   000002 236100                    LDQ     2,,PR0
        13 000011   000000 756000 6                  STQ     LINE_LIST$

     1291     3387            %DISPOSE_HEAP(@POINTER=HEAP$, @SIZE=%MAX_INPUT_BUFFER_LEN);

   3389 13 000012   000003 630400 14                 EPPR0   3
        13 000013   000001 631400 14                 EPPR1   1
        13 000014   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        13 000015   000000 011000                    NOP     0

     1292     3392
     1293     3393    2     END;

   3393 13 000016   000000 236000 6                  LDQ     LINE_LIST$
        13 000017   000005 116000 14                 CMPQ    5
        13 000020   000031 600000 13                 TZE     s:3395
        13 000021   000000 116000 3                  CMPQ    CURRENT_BUFFER$
        13 000022   000031 600000 13                 TZE     s:3395
        13 000023   000000 234000 12                 SZN     INHIBIT_DUMP_LINES
        13 000024   000031 604000 13                 TMI     s:3395
        13 000025   000000 470400 6                  LDP0    LINE_LIST$
        13 000026   000004 236100                    LDQ     4,,PR0
        13 000027   000133 116000 xsym               CMPQ    COMCOM+91
        13 000030   000002 604000 13                 TMI     s:3383

     1294     3394
     1295     3395    1   END Z8EL$DUMP_USED_LINES;

   3395 13 000031   000000 221200 0                  LDX1  ! 0
PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:298  
        13 000032   000001 702211                    TSX2  ! 1,X1
     1296     3396        %EOD;

PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:299  
--  Include file information  --

   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$DUMP_USED_LINES.
PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:300  

 **** Variables and constants ****

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 003 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_BUFFER$

  ****  Section 004 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 005 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:301  
  ****  Section 006 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LINE_LIST$

  ****  Section 007 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 008 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 009 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 010 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 011 LblCom HEAP$

PL6.E3A0      #004=Z8EL$DUMP_USED_LINES File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:09 Page:302  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAP$

  ****  Section 012 LblCom INHIBIT_DUMP_LINES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 INHIBIT_DUMP_LINES

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR              1 BUFFER_LINE                0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0/w STRC(36864)       1 PAGE


   Procedure Z8EL$DUMP_USED_LINES requires 27 words for executable code.
   Procedure Z8EL$DUMP_USED_LINES is declared NOAUTO and requires 2 words of local(STATIC) storage.

PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:303  
     1297        1        /*T***********************************************************/
     1298        2        /*T*                                                         */
     1299        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1300        4        /*T*                                                         */
     1301        5        /*T***********************************************************/
     1302        6        Z8EL$START_WRITING_ES_FILE : PROC (ISN) NOAUTO;
     1303        7
     1304        8
     1305        9    1   DCL Z8EL$GET_NEXT_SCANNER_LINE ENTRY;
     1306       10
     1307       11    1   DCL ISN SBIN;   /* At which to start */
     1308       12
     1309       13        %EQU PHASE = 1;
     1310       14        %INCLUDE Z8A_DEFC;
     1311       82        %INCLUDE Z8A_SUPP_MAC;
     1312     2482        %INCLUDE Z8E_BUFFERS;
     1313     2672
     1314     2673    1   DCL Z8AA$PREPARE_ES_OUTPUT ENTRY ALTRET;
     1315     2674
     1316     2675    1   IF ISN_FOR_EXP_SRC < 0 THEN
     1317     2676    2     DO;
     1318     2677    2       ISN_FOR_EXP_SRC = ISN;
     1319     2678    2       CALL Z8AA$PREPARE_ES_OUTPUT;
     1320     2679    2     END;
     1321     2680
     1322     2681    1   END Z8EL$START_WRITING_ES_FILE;
     1323     2682        %EOD;

PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:304  
--  Include file information  --

   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$START_WRITING_ES_FILE.

   Procedure Z8EL$START_WRITING_ES_FILE requires 12 words for executable code.
   Procedure Z8EL$START_WRITING_ES_FILE is declared NOAUTO and requires 2 words of local(STATIC) storage.

PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:305  

 Object Unit name= Z8EL$START_WRITING_ES_FILE                 File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:09:39.20 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     2      2  Z8EL$START_WRITING_ES_FILE
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  SCANNER_STATE
    3  LblCom even  none     1      1  CURRENT_BUFFER$
    4  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    5  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    6  LblCom even  none     1      1  LINE_LIST$
    7  LblCom even  none     7      7  BUFFER
    8  LblCom even  none     1      1  ORIGINAL_ISN
    9  LblCom even  none     1      1  EXPANDED_ISN
   10  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   11   Proc  even  none    12     14  Z8EL$START_WRITING_ES_FILE
   12  RoData even  none     1      1  Z8EL$START_WRITING_ES_FILE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        1  Z8EL$START_WRITING_ES_FILE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 Z8AA$PREPARE_ES_OUTPUT
                       nStd      0 X66_STATIC_1
PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:306  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:307  


     1297        1        /*T***********************************************************/
     1298        2        /*T*                                                         */
     1299        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1300        4        /*T*                                                         */
     1301        5        /*T***********************************************************/
     1302        6        Z8EL$START_WRITING_ES_FILE : PROC (ISN) NOAUTO;

      6 11 000000   000000 700200 xent  Z8EL$START_* TSX0  ! X66_STATIC_1
        11 000001   000000 000001 0                  ZERO    0,1

     1303        7
     1304        8
     1305        9    1   DCL Z8EL$GET_NEXT_SCANNER_LINE ENTRY;
     1306       10
     1307       11    1   DCL ISN SBIN;   /* At which to start */
     1308       12
     1309       13        %EQU PHASE = 1;
     1310       14        %INCLUDE Z8A_DEFC;
     1311       82        %INCLUDE Z8A_SUPP_MAC;
     1312     2482        %INCLUDE Z8E_BUFFERS;
     1313     2672
     1314     2673    1   DCL Z8AA$PREPARE_ES_OUTPUT ENTRY ALTRET;
     1315     2674
     1316     2675    1   IF ISN_FOR_EXP_SRC < 0 THEN

   2675 11 000002   000000 235000 10                 LDA     ISN_FOR_EXP_SRC
        11 000003   000012 605000 11                 TPL     s:2681

     1317     2676    2     DO;

     1318     2677    2       ISN_FOR_EXP_SRC = ISN;

   2677 11 000004   000001 470400 0                  LDP0    @ISN
        11 000005   000000 235100                    LDA     0,,PR0
        11 000006   000000 755000 10                 STA     ISN_FOR_EXP_SRC

PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:308  
     1319     2678    2       CALL Z8AA$PREPARE_ES_OUTPUT;

   2678 11 000007   000000 631400 12                 EPPR1   0
        11 000010   000000 701000 xent               TSX1    Z8AA$PREPARE_ES_OUTPUT
        11 000011   000000 011000                    NOP     0

     1320     2679    2     END;

     1321     2680
     1322     2681    1   END Z8EL$START_WRITING_ES_FILE;

   2681 11 000012   000000 221200 0                  LDX1  ! 0
        11 000013   000001 702211                    TSX2  ! 1,X1
     1323     2682        %EOD;

PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:309  
--  Include file information  --

   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$START_WRITING_ES_FILE.
PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:310  

 **** Variables and constants ****

  ****  Section 000  Data  Z8EL$START_WRITING_ES_FILE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w PTR         r     1 @ISN                      *0-0-0/w SBIN        r     1 ISN

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 002 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 003 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 004 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:311  
  ****  Section 005 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 006 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 007 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 008 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 009 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 010 LblCom ISN_FOR_EXP_SRC

PL6.E3A0      #005=Z8EL$START_WRITING_ES_FILE File=Z8EL.:Z8A6TSI                 SAT 08/09/97 12:09 Page:312  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ISN_FOR_EXP_SRC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR              1 BUFFER_LINE                0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0/w STRC(36864)       1 PAGE


   Procedure Z8EL$START_WRITING_ES_FILE requires 12 words for executable code.
   Procedure Z8EL$START_WRITING_ES_FILE is declared NOAUTO and requires 2 words of local(STATIC) storage.

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:313  
     1324        1        /*T***********************************************************/
     1325        2        /*T*                                                         */
     1326        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1327        4        /*T*                                                         */
     1328        5        /*T***********************************************************/
     1329        6        Z8EL$PROCESS_COPY : PROC;
     1330        7
     1331        8
     1332        9        %EQU PHASE = 1;
     1333       10        %INCLUDE Z8A_DEFC;
     1334       78        %INCLUDE Z8A_SUPP_MAC;
     1335     2478        %INCLUDE Z8A_ERR_NUMS;
     1336     3242        %INCLUDE Z8A_DNT;
     1337     3463        %INCLUDE Z8A_COMCOM;
     1338     4113        %INCLUDE Z8E_HEAP;
     1339     4169        %INCLUDE Z8E_STACKS;
     1340     6435        %INCLUDE Z8E_BUFFERS;
     1341     6625        %INCLUDE Z8E_WINDOW;
     1342     8695        %INCLUDE Z8E_REPLACE;
     1343     8998        %INCLUDE Z8A_TYPES;
     1344     9172        %INCLUDE Z8E_O1COM ;
     1345     9933
     1346     9934    1   DCL Z8AH$SEARCH_ ENTRY;
     1347     9935    1   DCL Z8AE$ERROR ENTRY(12);
     1348     9936    1   DCL Z9AA$OPEN_COPY_FILE ENTRY(5);
     1349     9937    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
     1350     9938    1   DCL Z8EL$PARSE_REPLACE ENTRY(7);
     1351     9939    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     1352     9940    1   DCL Z8EL$ADD_REPL_LEVEL ENTRY(2);
     1353     9941    1   DCL Z8EL$BLANK_SOURCE_LINES ENTRY(4);
     1354     9942    1   DCL Z8EL$START_WRITING_ES_FILE ENTRY(1);
     1355     9943    1   DCL Z8AH$NEW_DNT ENTRY(3);
     1356     9944    1   DCL Z8EC$INTERNAL_STRING_REP ENTRY(2);
     1357     9945    1   DCL Z8EL$POSITION_LINE_LIST ENTRY(3);
     1358     9946
     1359     9947        %DEF_BUCKETS;
     1360     9950
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:314  
     1361     9951    1   DCL START_LINE SBIN WORD;
     1362     9952    1   DCL START_COLUMN SBIN WORD;
     1363     9953    1   DCL COPY_START_LINE SBIN;
     1364     9954    1   DCL COPY_START_COLUMN SBIN;
     1365     9955    1   DCL COPY_START_DEBUG BOOLEAN;
     1366     9956    1   DCL END_LINE SBIN;
     1367     9957    1   DCL END_COLUMN SBIN;
     1368     9958    1   DCL END_LEVEL SBIN;
     1369     9959    1   DCL L$ PTR;
     1370     9960    1   DCL TL$ PTR;
     1371     9961
     1372     9962    1   DCL COPY_FILE_NAME$ PTR;
     1373     9963    1   DCL COPY_LIBRARY_NAME$ PTR;
     1374     9964    1   DCL COPY_LIBRARY_DNT$ PTR;
     1375     9965
     1376     9966        %DCL_AUTO_LX_ITEM(@NAME = STR_TERM);
     1377     9970
     1378     9971
     1379     9972
     1380     9973    1   DCL REPLACE$ PTR;
     1381     9974    1   DCL ERROR_IN_REPLACE BOOLEAN;
     1382     9975    1   DCL ERROR_IN_COPY    BOOLEAN;               /*#34384*/
     1383     9976
     1384     9977            /* Main body of PROCESS_COPY */
     1385     9978
     1386     9979
     1387     9980    1   IF LEX_SYMBOL.LEVEL ~= 0 THEN                      /*#32204*/
     1388     9981    2     DO;
     1389     9982    2       CALL COPY_ERROR;
     1390     9983    2       RETURN;
     1391     9984    2     END;
     1392     9985    1   IF COMCOM.OB.FIPS.LEVEL = %LOW_LEV THEN
     1393     9986    1     CALL Z8AE$ERROR (%E$LEVEL_CHECK,
     1394     9987    1                      LEX_SYMBOL.LINE,
     1395     9988    1                      LEX_SYMBOL.COLUMN);
     1396     9989
     1397     9990    1   COPY_START_LINE = LEX_SYMBOL.LINE;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:315  
     1398     9991    1   COPY_START_COLUMN = LEX_SYMBOL.COLUMN;
     1399     9992    1   COPY_START_DEBUG = LEX_SYMBOL.B.DEBUG_TOKEN;
     1400     9993    1   ERROR_IN_REPLACE = FALSE;
     1401     9994    1   ERROR_IN_COPY    = FALSE;                   /*#34384*/
     1402     9995    1   CALL Z8EL$START_WRITING_ES_FILE (COPY_START_LINE);
     1403     9996
     1404     9997    1   IF COPY_START_COLUMN > O1COM.AREA_A_COLUMN_START THEN
     1405     9998    2     DO;
     1406     9999    2       L$ = ADDR(NIL);
     1407    10000    2       CALL Z8EL$POSITION_LINE_LIST(COPY_START_LINE, L$, 999999999);
     1408    10001    2       IF SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,
     1409    10002    2                  O1COM.AREA_A_COLUMN_START,
     1410    10003    2                  COPY_START_COLUMN - O1COM.AREA_A_COLUMN_START) ~= ' ' THEN
     1411    10004    3         DO;
     1412    10005    3           L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_C_R_LINE = TRUE;
     1413    10006    3           L$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;
     1414    10007    3           L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_COLUMN = COPY_START_COLUMN;
     1415    10008    3         END;
     1416    10009    2     END;
     1417    10010        %PARSE_A_TOKEN;   /* The file name */
     1418    10058
     1419    10059        %COPY_TO_NEW_LEX_SYMBOL (FROM$="ADDR(LEX_SYMBOL)",
     1420    10060                                 TO$ = COPY_FILE_NAME$);
     1421    10075                                                             /*#34384*/
     1422    10076    1   IF LEX_SYMBOL.SIZE > 30   THEN
     1423    10077    2     DO;
     1424    10078    2       CALL Z8AE$ERROR( %E$USERWORD_TOO_LONG,
     1425    10079    2                        LEX_SYMBOL.LINE,
     1426    10080    2                        LEX_SYMBOL.COLUMN );
     1427    10081    2       LEX_SYMBOL.SIZE = 30;
     1428    10082    2       ERROR_IN_COPY   = TRUE;                 /*#34384*/
     1429    10083    2     END;
     1430    10084
     1431    10085        %GET_A_TOKEN;  /* period, REPLACING, SUPPRESS, or OF/IN */
     1432    10123
     1433    10124    1   IF (SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'OF')
     1434    10125    1         OR (SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'IN') THEN
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:316  
     1435    10126    2     DO;
     1436    10127    2       IF COMCOM.OB.FIPS.LEVEL = %INT_LEV THEN
     1437    10128    2         CALL Z8AE$ERROR (%E$LEVEL_CHECK,
     1438    10129    2                          COPY_START_LINE,
     1439    10130    2                          COPY_START_COLUMN);
     1440    10131            %GET_A_TOKEN;
     1441    10169
     1442    10170            %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)",
     1443    10171                                    TO$ = COPY_LIBRARY_NAME$);
     1444    10186
     1445    10187    2       CALL Z8AH$NEW_DNT (COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.SYMBOL,
     1446    10188    2                          COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.SIZE,
     1447    10189    2                          COPY_LIBRARY_DNT$);
     1448    10190
     1449    10191    2       IF COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.TYPE = %SINGLE_QUOTE
     1450    10192    2            OR COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.TYPE = %DOUBLE_QUOTE THEN
     1451    10193    3         DO;
     1452    10194                %INIT_LX_TERMINAL (@POINTER = "ADDR(STR_TERM)",
     1453    10195                                   @SYMBOL = "COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.TYPE",
     1454    10196                                   @DNT$ = COPY_LIBRARY_DNT$,
     1455    10197                                   @LINE = "COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.LINE",
     1456    10198                                   @COLUMN = "COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.COLUMN"
             10198                                       );
     1457    10216    3           CALL Z8EC$INTERNAL_STRING_REP (ADDR(STR_TERM),
     1458    10217    3                                          COPY_LIBRARY_DNT$);
     1459    10218
     1460    10219    3           CALL Z8AH$NEW_DNT (SUBSTR(COPY_LIBRARY_DNT$ -> DNT.TEXT.NAME,
     1461    10220    3                                     1,
     1462    10221    3                                     COPY_LIBRARY_DNT$ -> DNT.TEXT.LENGTH - 2),
     1463    10222    3                              COPY_LIBRARY_DNT$ -> DNT.TEXT.LENGTH - 2,
     1464    10223    3                              COPY_LIBRARY_DNT$);
     1465    10224    3         END;
     1466    10225            %GET_A_TOKEN;
     1467    10263    2     END;
     1468    10264    1   ELSE
     1469    10265    2     DO;
     1470    10266    2       COPY_LIBRARY_NAME$ = ADDR(NIL);
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:317  
     1471    10267    2     END;
     1472    10268
     1473    10269    1   IF SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'SUPPRESS' THEN
     1474    10270          %GET_A_TOKEN;           /*  Skip SUPPRESS  */
     1475    10308    1   IF SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'REPLACING' THEN
     1476    10309    2     DO;
     1477    10310    2       IF COMCOM.OB.FIPS.LEVEL = %INT_LEV THEN
     1478    10311    2         CALL Z8AE$ERROR (%E$LEVEL_CHECK,
     1479    10312    2                          COPY_START_LINE,
     1480    10313    2                          COPY_START_COLUMN);
     1481    10314    2       CALL Z8EL$PARSE_REPLACE (REPLACE$,
     1482    10315    2                                START_LINE,
     1483    10316    2                                START_COLUMN,
     1484    10317    2                                END_LINE,
     1485    10318    2                                END_COLUMN,
     1486    10319    2                                END_LEVEL,
     1487    10320    2                                ERROR_IN_REPLACE);
     1488    10321    2       CALL Z8EL$ADD_REPL_LEVEL (CURRENT_SYMBOL_LEVEL+1, REPLACE$);
     1489    10322    2       CURRENT_SYMBOL_LEVEL = CURRENT_SYMBOL_LEVEL + 1;
     1490    10323    2       IF ERROR_IN_REPLACE THEN
     1491    10324    2         CALL Z8EL$DELETE_REPLACE_LEVEL(CURRENT_SYMBOL_LEVEL+1);
     1492    10325    2     END;
     1493    10326    1   ELSE
     1494    10327    1     IF LEX_SYMBOL.TYPE = %PERIOD THEN
     1495    10328    2       DO;
     1496    10329    2         END_LINE = LEX_SYMBOL.END_LINE;
     1497    10330    2         END_COLUMN = LEX_SYMBOL.END_COLUMN;
     1498    10331    2         END_LEVEL  = LEX_SYMBOL.LEVEL;
     1499    10332    2       END;
     1500    10333    1     ELSE
     1501    10334    2       DO;  /* ERROR */
     1502    10335    2         CALL Z8AE$ERROR (%E$COPY_PERIOD_EXPECTED,
     1503    10336    2                          LEX_SYMBOL.LINE,
     1504    10337    2                          LEX_SYMBOL.COLUMN);
     1505    10338    2         ERROR_IN_REPLACE = TRUE;
     1506    10339    2       END;
     1507    10340
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:318  
     1508    10341    1   IF NOT ERROR_IN_REPLACE  AND  NOT ERROR_IN_COPY  THEN    /*#34384*/
     1509    10342    2     DO;
     1510    10343    2       CURRENT_LINE_LEVEL = END_LEVEL + 1;
     1511    10344
     1512    10345    2       IF COPY_START_DEBUG THEN
     1513    10346    2         IF COPY_DEBUG_LEVEL = 0 THEN
     1514    10347    2           COPY_DEBUG_LEVEL = CURRENT_LINE_LEVEL;
     1515    10348    2         ELSE
     1516    10349    2           COPY_DEBUG_LEVEL = MINIMUM (COPY_DEBUG_LEVEL,
     1517    10350    2                                       CURRENT_LINE_LEVEL);
     1518    10351
     1519    10352            /* Check for trailing tokens on same line as COPY */
     1520    10353
     1521    10354    2       L$ = ADDR(NIL);
     1522    10355    2       CALL Z8EL$POSITION_LINE_LIST(END_LINE, L$, COPY_START_LINE + 1);
     1523    10356
     1524    10357    2       IF SUBSTR(L$ -> FILL_BUFFER.SOURCE_LINE,
     1525    10358    2                 END_COLUMN,
     1526    10359    2                 MINIMUM (L$ -> FILL_BUFFER.LINE_LENGTH,
     1527    10360    2                          O1COM.MARGIN_R) - END_COLUMN) ~= ' ' THEN
     1528    10361    3         DO;
     1529    10362                %NEW_HEAP (@POINTER = TL$,
     1530    10363                           @SIZE = %MAX_INPUT_BUFFER_LEN);
     1531    10368    3           TL$ -> FILL_BUFFER.LINE_LENGTH = L$ -> FILL_BUFFER.LINE_LENGTH;
     1532    10369    3           TL$ -> FILL_BUFFER = L$ -> FILL_BUFFER;
     1533    10370    3           TL$ -> FILL_BUFFER.ESN = ' ';
     1534    10371    3           TL$ -> FILL_BUFFER.COLUMN = O1COM.AREA_A_COLUMN_START ;
     1535    10372    3           TL$ -> FILL_BUFFER.CLASS  = %SPACE;
     1536    10373    3           TL$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;
     1537    10374    3           TL$ -> FILL_BUFFER.LINE_TYPE.SPLIT_C_R_LINE = FALSE;
     1538    10375    3           SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,
     1539    10376    3                  O1COM.AREA_A_COLUMN_START,
     1540    10377    3                  END_COLUMN - O1COM.AREA_A_COLUMN_START) = ' ';
     1541    10378
     1542    10379    3           IF SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,
     1543    10380    3                     O1COM.AREA_A_COLUMN_START - 1,
     1544    10381    3                     1) = '-' THEN
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:319  
     1545    10382    3             SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,
     1546    10383    3                    O1COM.AREA_A_COLUMN_START - 1,
     1547    10384    3                    1) = ' ';
     1548    10385
     1549    10386    3           L$ -> FILL_BUFFER.NEXT$ = TL$;
     1550    10387    3           SUBSTR(L$ -> FILL_BUFFER.SOURCE_LINE,
     1551    10388    3                  END_COLUMN,
     1552    10389    3                  MINIMUM (L$ -> FILL_BUFFER.LINE_LENGTH,
     1553    10390    3                           O1COM.MARGIN_R) - END_COLUMN) = ' ';
     1554    10391
     1555    10392                /* Clear previously processed tokens */
     1556    10393    3           SCANNER_STATE = 0;
     1557    10394    3           CURRENT_BUFFER$ = L$;
     1558    10395    3           EXPANDED_ISN = END_LINE;
     1559    10396    3           BUFFER.COLUMN = BUFFER.LINE_LENGTH;
     1560    10397
     1561    10398    4           DO WHILE LEX_SYMBOL_QUEUE$ ~= ADDR(NIL)
     1562    10399    4                AND LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.LINE >= END_LINE;
     1563    10400
     1564    10401    4             TL$ = LEX_SYMBOL_QUEUE$;
     1565    10402    4             LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.NEXT$;
     1566    10403
     1567    10404    4             CALL Z8ED$DISPOSE_HEAP (TL$,
     1568    10405                                          %LEX_SYMBOL_ACTUAL_WORD_LEN (S$ = TL$);
     1569    10408    4                                    );
     1570    10409    4           END;
     1571    10410    3         END;
     1572    10411
     1573    10412    2       IF COPY_LIBRARY_NAME$ ~= ADDR(NIL) THEN
     1574    10413    3         DO;
     1575    10414    3           CALL Z9AA$OPEN_COPY_FILE (COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SYMBOL,
     1576    10415    3                                     COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SIZE,
     1577    10416    3                                     CURRENT_LINE_LEVEL,
     1578    10417    3                                     COPY_LIBRARY_DNT$ -> DNT.TEXT.NAME,
     1579    10418    3                                     BINBIT(COPY_LIBRARY_DNT$ -> DNT.TEXT.LENGTH,36));
     1580    10419    3         END;
     1581    10420    2       ELSE
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:320  
     1582    10421    3         DO;
     1583    10422    3           CALL Z9AA$OPEN_COPY_FILE (COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SYMBOL,
     1584    10423    3                                     COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SIZE,
     1585    10424    3                                     CURRENT_LINE_LEVEL);
     1586    10425    3         END;
     1587    10426    2     END;
     1588    10427
     1589    10428    1   CALL Z8ED$DISPOSE_HEAP(COPY_FILE_NAME$,
     1590    10429                    %LEX_SYMBOL_ACTUAL_WORD_LEN (S$=COPY_FILE_NAME$);
     1591    10432    1               );
     1592    10433
     1593    10434    1   IF COPY_LIBRARY_NAME$ ~= ADDR(NIL) THEN
     1594    10435    1     CALL Z8ED$DISPOSE_HEAP(COPY_LIBRARY_NAME$,
     1595    10436                    %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=COPY_LIBRARY_NAME$);
     1596    10439    1               );
     1597    10440
     1598    10441
     1599    10442    1   RETURN;
     1600    10443        %EJECT;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:321  
     1601    10444        /*----------*/
     1602    10445    1     COPY_ERROR : PROC;
     1603    10446        /*----------*/
     1604    10447
     1605    10448
     1606    10449    2   CALL Z8AE$ERROR( %E$INTERNAL_COPY,
     1607    10450    2                    LEX_SYMBOL.LINE,
     1608    10451    2                    LEX_SYMBOL.COLUMN );
     1609    10452
     1610    10453        %PARSE_A_TOKEN;                      /* FILE NAME */
     1611    10501
     1612    10502    3   DO WHILE LEX_SYMBOL.TYPE ~= %PERIOD;
     1613    10503          %GET_A_TOKEN;
     1614    10541    3   END;
     1615    10542
     1616    10543    2   END COPY_ERROR;
     1617    10544    1   END Z8EL$PROCESS_COPY;
     1618    10545
     1619    10546        %EOD;

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:322  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$PROCESS_COPY.

   Procedure Z8EL$PROCESS_COPY requires 920 words for executable code.
   Procedure Z8EL$PROCESS_COPY requires 38 words of local(AUTO) storage.

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:323  

 Object Unit name= Z8EL$PROCESS_COPY                          File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:09:55.08 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  DNT$
    2  LblCom even  none     5      5  DNT_
    3  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    4  LblCom even  none     1      1  DNT_OF_1$
    5  LblCom even  none     1      1  HEAP$
    6  LblCom even  none    90    132  LEX_SYMBOL
    7  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    8  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    9  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   10  LblCom even  none     1      1  SCANNER_STATE
   11  LblCom even  none     1      1  CURRENT_BUFFER$
   12  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
   13  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   14  LblCom even  none     1      1  LINE_LIST$
   15  LblCom even  none     7      7  BUFFER
   16  LblCom even  none     1      1  ORIGINAL_ISN
   17  LblCom even  none     1      1  EXPANDED_ISN
   18  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   19  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
   20  LblCom even  none     1      1  REPLACE_ACTIVE
   21  LblCom even  none     1      1  IGNORE_COPY_REPLACE
   22  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   23  LblCom even  none     4      4  REPLACE_LIST
   24  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   25  RoData even  UTS      7      7  Z8EL$PROCESS_COPY
   26   Proc  even  none   920   1630  Z8EL$PROCESS_COPY
   27  RoData even  none    36     44  Z8EL$PROCESS_COPY
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:324  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    26      0   yes            yes      Std        0  Z8EL$PROCESS_COPY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       0 Z8ES$SCANNER
         yes           Std       1 Z8EL$HANDLE_LEVEL_CHANGE
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       1 Z8EL$START_WRITING_ES_FILE
         yes           Std       2 Z8ED$DISPOSE_HEAP
         yes           Std       3 Z8AH$NEW_DNT
         yes           Std       7 Z8EL$PARSE_REPLACE
         yes           Std       2 Z8EL$ADD_REPL_LEVEL
         yes           Std       5 Z9AA$OPEN_COPY_FILE
         yes           Std       1 Z8EL$DELETE_REPLACE_LEVEL
         yes           Std       0 Z8EL$GET_NEXT_SCANNER_LINE
         yes           Std       2 Z8EC$INTERNAL_STRING_REP
         yes           Std       3 Z8EL$POSITION_LINE_LIST
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                               DNT_BUCKETS
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:325  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:326  


     1324        1        /*T***********************************************************/
     1325        2        /*T*                                                         */
     1326        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1327        4        /*T*                                                         */
     1328        5        /*T***********************************************************/
     1329        6        Z8EL$PROCESS_COPY : PROC;

      6 26 000000   000000 700200 xent  Z8EL$PROCES* TSX0  ! X66_AUTO_0
        26 000001   000046 000000                    ZERO    38,0

     1330        7
     1331        8
     1332        9        %EQU PHASE = 1;
     1333       10        %INCLUDE Z8A_DEFC;
     1334       78        %INCLUDE Z8A_SUPP_MAC;
     1335     2478        %INCLUDE Z8A_ERR_NUMS;
     1336     3242        %INCLUDE Z8A_DNT;
     1337     3463        %INCLUDE Z8A_COMCOM;
     1338     4113        %INCLUDE Z8E_HEAP;
     1339     4169        %INCLUDE Z8E_STACKS;
     1340     6435        %INCLUDE Z8E_BUFFERS;
     1341     6625        %INCLUDE Z8E_WINDOW;
     1342     8695        %INCLUDE Z8E_REPLACE;
     1343     8998        %INCLUDE Z8A_TYPES;
     1344     9172        %INCLUDE Z8E_O1COM ;
     1345     9933
     1346     9934    1   DCL Z8AH$SEARCH_ ENTRY;
     1347     9935    1   DCL Z8AE$ERROR ENTRY(12);
     1348     9936    1   DCL Z9AA$OPEN_COPY_FILE ENTRY(5);
     1349     9937    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
     1350     9938    1   DCL Z8EL$PARSE_REPLACE ENTRY(7);
     1351     9939    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     1352     9940    1   DCL Z8EL$ADD_REPL_LEVEL ENTRY(2);
     1353     9941    1   DCL Z8EL$BLANK_SOURCE_LINES ENTRY(4);
     1354     9942    1   DCL Z8EL$START_WRITING_ES_FILE ENTRY(1);
     1355     9943    1   DCL Z8AH$NEW_DNT ENTRY(3);
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:327  
     1356     9944    1   DCL Z8EC$INTERNAL_STRING_REP ENTRY(2);
     1357     9945    1   DCL Z8EL$POSITION_LINE_LIST ENTRY(3);
     1358     9946
     1359     9947        %DEF_BUCKETS;
     1360     9950
     1361     9951    1   DCL START_LINE SBIN WORD;
     1362     9952    1   DCL START_COLUMN SBIN WORD;
     1363     9953    1   DCL COPY_START_LINE SBIN;
     1364     9954    1   DCL COPY_START_COLUMN SBIN;
     1365     9955    1   DCL COPY_START_DEBUG BOOLEAN;
     1366     9956    1   DCL END_LINE SBIN;
     1367     9957    1   DCL END_COLUMN SBIN;
     1368     9958    1   DCL END_LEVEL SBIN;
     1369     9959    1   DCL L$ PTR;
     1370     9960    1   DCL TL$ PTR;
     1371     9961
     1372     9962    1   DCL COPY_FILE_NAME$ PTR;
     1373     9963    1   DCL COPY_LIBRARY_NAME$ PTR;
     1374     9964    1   DCL COPY_LIBRARY_DNT$ PTR;
     1375     9965
     1376     9966        %DCL_AUTO_LX_ITEM(@NAME = STR_TERM);
     1377     9970
     1378     9971
     1379     9972
     1380     9973    1   DCL REPLACE$ PTR;
     1381     9974    1   DCL ERROR_IN_REPLACE BOOLEAN;
     1382     9975    1   DCL ERROR_IN_COPY    BOOLEAN;               /*#34384*/
     1383     9976
     1384     9977            /* Main body of PROCESS_COPY */
     1385     9978
     1386     9979
     1387     9980    1   IF LEX_SYMBOL.LEVEL ~= 0 THEN                      /*#32204*/

   9980 26 000002   000003 235000 6                  LDA     LEX_SYMBOL+3
        26 000003   000007 600000 26                 TZE     s:9985

     1388     9981    2     DO;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:328  

     1389     9982    2       CALL COPY_ERROR;

   9982 26 000004   001431 701000 26                 TSX1    COPY_ERROR
        26 000005   000000 011000                    NOP     0

     1390     9983    2       RETURN;

   9983 26 000006   000000 702200 xent               TSX2  ! X66_ARET

     1391     9984    2     END;
     1392     9985    1   IF COMCOM.OB.FIPS.LEVEL = %LOW_LEV THEN

   9985 26 000007   000036 720000 xsym               LXL0    COMCOM+30
        26 000010   000003 100003                    CMPX0   3,DU
        26 000011   000016 601000 26                 TNZ     s:9990

     1393     9986    1     CALL Z8AE$ERROR (%E$LEVEL_CHECK,

   9986 26 000012   000002 630400 27                 EPPR0   2
        26 000013   000000 631400 27                 EPPR1   0
        26 000014   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000015   000000 011000                    NOP     0

     1394     9987    1                      LEX_SYMBOL.LINE,
     1395     9988    1                      LEX_SYMBOL.COLUMN);
     1396     9989
     1397     9990    1   COPY_START_LINE = LEX_SYMBOL.LINE;

   9990 26 000016   000004 235000 6                  LDA     LEX_SYMBOL+4
        26 000017   200005 755100                    STA     COPY_START_LINE,,AUTO

     1398     9991    1   COPY_START_COLUMN = LEX_SYMBOL.COLUMN;

   9991 26 000020   000005 236000 6                  LDQ     LEX_SYMBOL+5
        26 000021   200006 756100                    STQ     COPY_START_COLUMN,,AUTO

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:329  
     1399     9992    1   COPY_START_DEBUG = LEX_SYMBOL.B.DEBUG_TOKEN;

   9992 26 000022   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 000023   000002 736000                    QLS     2
        26 000024   400000 376003                    ANQ     -131072,DU
        26 000025   200007 756100                    STQ     COPY_START_DEBUG,,AUTO

     1400     9993    1   ERROR_IN_REPLACE = FALSE;

   9993 26 000026   200031 450100                    STZ     ERROR_IN_REPLACE,,AUTO

     1401     9994    1   ERROR_IN_COPY    = FALSE;                   /*#34384*/

   9994 26 000027   200032 450100                    STZ     ERROR_IN_COPY,,AUTO

     1402     9995    1   CALL Z8EL$START_WRITING_ES_FILE (COPY_START_LINE);

   9995 26 000030   200005 630500                    EPPR0   COPY_START_LINE,,AUTO
        26 000031   200036 450500                    STP0    ERROR_IN_COPY+4,,AUTO
        26 000032   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 000033   000005 631400 27                 EPPR1   5
        26 000034   000000 701000 xent               TSX1    Z8EL$START_WRITING_ES_FILE
        26 000035   000000 011000                    NOP     0

     1403     9996
     1404     9997    1   IF COPY_START_COLUMN > O1COM.AREA_A_COLUMN_START THEN

   9997 26 000036   200006 236100                    LDQ     COPY_START_COLUMN,,AUTO
        26 000037   000122 116000 xsym               CMPQ    O1COM+82
        26 000040   000077 604400 26                 TMOZ    s:10014

     1405     9998    2     DO;

     1406     9999    2       L$ = ADDR(NIL);

   9999 26 000041   000006 236000 27                 LDQ     6
        26 000042   200013 756100                    STQ     L$,,AUTO
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:330  

     1407    10000    2       CALL Z8EL$POSITION_LINE_LIST(COPY_START_LINE, L$, 999999999);

  10000 26 000043   000010 236000 27                 LDQ     8
        26 000044   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 000045   200013 630500                    EPPR0   L$,,AUTO
        26 000046   200037 450500                    STP0    ERROR_IN_COPY+5,,AUTO
        26 000047   200005 631500                    EPPR1   COPY_START_LINE,,AUTO
        26 000050   200036 451500                    STP1    ERROR_IN_COPY+4,,AUTO
        26 000051   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 000052   000000 631400 27                 EPPR1   0
        26 000053   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        26 000054   000000 011000                    NOP     0

     1408    10001    2       IF SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,

  10001 26 000055   200013 470500                    LDP0    L$,,AUTO
        26 000056   000012 720100                    LXL0    10,,PR0
        26 000057   200006 236100                    LDQ     COPY_START_COLUMN,,AUTO
        26 000060   000122 136000 xsym               SBLQ    O1COM+82
        26 000061   000000 621006                    EAX1    0,QL
        26 000062   000122 235000 xsym               LDA     O1COM+82
        26 000063   040000 106545                    CMPC    fill='040'O
        26 000064   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1
        26 000065   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 000066   000077 600000 26                 TZE     s:10014

     1409    10002    2                  O1COM.AREA_A_COLUMN_START,
     1410    10003    2                  COPY_START_COLUMN - O1COM.AREA_A_COLUMN_START) ~= ' ' THEN
     1411    10004    3         DO;

     1412    10005    3           L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_C_R_LINE = TRUE;

  10005 26 000067   000004 236003                    LDQ     4,DU
        26 000070   000011 256100                    ORSQ    9,,PR0

     1413    10006    3           L$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:331  

  10006 26 000071   200013 470500                    LDP0    L$,,AUTO
        26 000072   000012 236000 27                 LDQ     10
        26 000073   000011 356100                    ANSQ    9,,PR0

     1414    10007    3           L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_COLUMN = COPY_START_COLUMN;

  10007 26 000074   200013 470500                    LDP0    L$,,AUTO
        26 000075   200006 236100                    LDQ     COPY_START_COLUMN,,AUTO
        26 000076   000011 552104                    STBQ    9,'04'O,PR0

     1415    10008    3         END;

     1416    10009    2     END;

     1417    10010        %PARSE_A_TOKEN;   /* The file name */

  10014 26 000077   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 000100   000006 116000 27                 CMPQ    6
        26 000101   000137 600000 26                 TZE     s:10037

  10020 26 000102   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 000103   000010 235100                    LDA     8,,PR0
        26 000104   000010 755000 6                  STA     LEX_SYMBOL+8

  10021 26 000105   000010 720100                    LXL0    8,,PR0
        26 000106   000044 621010                    EAX1    36,X0
        26 000107   000044 622005                    EAX2    36,AL
        26 000110   000040 100540                    MLR     fill='000'O
        26 000111   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        26 000112   000000 000012 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

  10024 26 000113   000010 720100                    LXL0    8,,PR0
        26 000114   000044 621010                    EAX1    36,X0
        26 000115   000000 636011                    EAQ     0,X1
        26 000116   000022 732000                    QRS     18
        26 000117   000003 036007                    ADLQ    3,DL
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:332  
        26 000120   000004 506007                    DIV     4,DL
        26 000121   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000122   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 000123   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 000124   000014 236000 27                 LDQ     12
        26 000125   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 000126   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000127   000013 631400 27                 EPPR1   11
        26 000130   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 000131   000000 011000                    NOP     0

  10029 26 000132   000000 236000 6                  LDQ     LEX_SYMBOL
        26 000133   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$

  10030 26 000134   000006 236000 27                 LDQ     6
        26 000135   000000 756000 6                  STQ     LEX_SYMBOL

  10031 26 000136   000166 710000 26                 TRA     s:10052

  10037 26 000137   000015 631400 27                 EPPR1   13
        26 000140   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000141   000000 011000                    NOP     0

  10038 26 000142   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000143   000154 601000 26                 TNZ     s:10044

  10039 26 000144   000015 631400 27                 EPPR1   13
        26 000145   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        26 000146   000000 011000                    NOP     0

  10040 26 000147   000015 631400 27                 EPPR1   13
        26 000150   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000151   000000 011000                    NOP     0

  10041 26 000152   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000153   000144 600000 26                 TZE     s:10039

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:333  
  10044 26 000154   000003 236000 6                  LDQ     LEX_SYMBOL+3
        26 000155   000000 116000 19                 CMPQ    CURRENT_SYMBOL_LEVEL
        26 000156   000166 600000 26                 TZE     s:10052
        26 000157   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 000160   200000 316003                    CANQ    65536,DU
        26 000161   000166 601000 26                 TNZ     s:10052

  10046 26 000162   000016 630400 27                 EPPR0   14
        26 000163   000005 631400 27                 EPPR1   5
        26 000164   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        26 000165   000000 011000                    NOP     0

  10052 26 000166   000004 235000 6                  LDA     LEX_SYMBOL+4
        26 000167   000133 755000 xsym               STA     COMCOM+91

  10053 26 000170   000005 236000 6                  LDQ     LEX_SYMBOL+5
        26 000171   000134 756000 xsym               STQ     COMCOM+92

     1418    10058
     1419    10059        %COPY_TO_NEW_LEX_SYMBOL (FROM$="ADDR(LEX_SYMBOL)",
     1420    10060                                 TO$ = COPY_FILE_NAME$);

  10062 26 000172   000010 236000 6                  LDQ     LEX_SYMBOL+8
        26 000173   000047 036007                    ADLQ    39,DL
        26 000174   000004 506007                    DIV     4,DL
        26 000175   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000176   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 000177   200041 450500                    STP0    ERROR_IN_COPY+7,,AUTO
        26 000200   200015 631500                    EPPR1   COPY_FILE_NAME$,,AUTO
        26 000201   200040 451500                    STP1    ERROR_IN_COPY+6,,AUTO
        26 000202   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000203   000013 631400 27                 EPPR1   11
        26 000204   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        26 000205   000000 011000                    NOP     0

  10069 26 000206   200015 470500                    LDP0    COPY_FILE_NAME$,,AUTO
        26 000207   000010 235000 6                  LDA     LEX_SYMBOL+8
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:334  
        26 000210   000010 755100                    STA     8,,PR0

  10070 26 000211   200015 470500                    LDP0    COPY_FILE_NAME$,,AUTO
        26 000212   000010 720100                    LXL0    8,,PR0
        26 000213   000044 621010                    EAX1    36,X0
        26 000214   000010 722000 6                  LXL2    LEX_SYMBOL+8
        26 000215   000044 623012                    EAX3    36,X2
        26 000216   000140 100440                    MLR     fill='000'O
        26 000217   000000 000013 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        26 000220   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     1421    10075                                                             /*#34384*/
     1422    10076    1   IF LEX_SYMBOL.SIZE > 30   THEN

  10076 26 000221   000010 235000 6                  LDA     LEX_SYMBOL+8
        26 000222   000036 115007                    CMPA    30,DL
        26 000223   000234 604400 26                 TMOZ    s:10087

     1423    10077    2     DO;

     1424    10078    2       CALL Z8AE$ERROR( %E$USERWORD_TOO_LONG,

  10078 26 000224   000020 630400 27                 EPPR0   16
        26 000225   000000 631400 27                 EPPR1   0
        26 000226   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000227   000000 011000                    NOP     0

     1425    10079    2                        LEX_SYMBOL.LINE,
     1426    10080    2                        LEX_SYMBOL.COLUMN );
     1427    10081    2       LEX_SYMBOL.SIZE = 30;

  10081 26 000230   000036 235007                    LDA     30,DL
        26 000231   000010 755000 6                  STA     LEX_SYMBOL+8

     1428    10082    2       ERROR_IN_COPY   = TRUE;                 /*#34384*/

  10082 26 000232   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:335  
        26 000233   200032 756100                    STQ     ERROR_IN_COPY,,AUTO

     1429    10083    2     END;

     1430    10084
     1431    10085        %GET_A_TOKEN;  /* period, REPLACING, SUPPRESS, or OF/IN */

  10087 26 000234   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 000235   000006 116000 27                 CMPQ    6
        26 000236   000274 600000 26                 TZE     s:10110

  10093 26 000237   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 000240   000010 235100                    LDA     8,,PR0
        26 000241   000010 755000 6                  STA     LEX_SYMBOL+8

  10094 26 000242   000010 720100                    LXL0    8,,PR0
        26 000243   000044 621010                    EAX1    36,X0
        26 000244   000044 622005                    EAX2    36,AL
        26 000245   000040 100540                    MLR     fill='000'O
        26 000246   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        26 000247   000000 000012 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

  10097 26 000250   000010 720100                    LXL0    8,,PR0
        26 000251   000044 621010                    EAX1    36,X0
        26 000252   000000 636011                    EAQ     0,X1
        26 000253   000022 732000                    QRS     18
        26 000254   000003 036007                    ADLQ    3,DL
        26 000255   000004 506007                    DIV     4,DL
        26 000256   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000257   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 000260   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 000261   000014 236000 27                 LDQ     12
        26 000262   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 000263   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000264   000013 631400 27                 EPPR1   11
        26 000265   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 000266   000000 011000                    NOP     0
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:336  

  10102 26 000267   000000 236000 6                  LDQ     LEX_SYMBOL
        26 000270   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$

  10103 26 000271   000006 236000 27                 LDQ     6
        26 000272   000000 756000 6                  STQ     LEX_SYMBOL

  10104 26 000273   000323 710000 26                 TRA     s:10124

  10110 26 000274   000015 631400 27                 EPPR1   13
        26 000275   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000276   000000 011000                    NOP     0

  10111 26 000277   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000300   000311 601000 26                 TNZ     s:10117

  10112 26 000301   000015 631400 27                 EPPR1   13
        26 000302   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        26 000303   000000 011000                    NOP     0

  10113 26 000304   000015 631400 27                 EPPR1   13
        26 000305   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000306   000000 011000                    NOP     0

  10114 26 000307   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000310   000301 600000 26                 TZE     s:10112

  10117 26 000311   000003 236000 6                  LDQ     LEX_SYMBOL+3
        26 000312   000000 116000 19                 CMPQ    CURRENT_SYMBOL_LEVEL
        26 000313   000323 600000 26                 TZE     s:10124
        26 000314   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 000315   200000 316003                    CANQ    65536,DU
        26 000316   000323 601000 26                 TNZ     s:10124

  10119 26 000317   000016 630400 27                 EPPR0   14
        26 000320   000005 631400 27                 EPPR1   5
        26 000321   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:337  
        26 000322   000000 011000                    NOP     0

     1432    10123
     1433    10124    1   IF (SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'OF')

  10124 26 000323   000010 720000 6                  LXL0    LEX_SYMBOL+8
        26 000324   040000 106440                    CMPC    fill='040'O
        26 000325   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        26 000326   000000 000002 25                 ADSC9   0                        cn=0,n=2
        26 000327   000334 600000 26                 TZE     s:10127
        26 000330   040000 106440                    CMPC    fill='040'O
        26 000331   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        26 000332   000001 000002 25                 ADSC9   1                        cn=0,n=2
        26 000333   000656 601000 26                 TNZ     s:10266

     1434    10125    1         OR (SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'IN') THEN
     1435    10126    2     DO;

     1436    10127    2       IF COMCOM.OB.FIPS.LEVEL = %INT_LEV THEN

  10127 26 000334   000036 721000 xsym               LXL1    COMCOM+30
        26 000335   000002 101003                    CMPX1   2,DU
        26 000336   000351 601000 26                 TNZ     s:10133

     1437    10128    2         CALL Z8AE$ERROR (%E$LEVEL_CHECK,

  10128 26 000337   200006 630500                    EPPR0   COPY_START_COLUMN,,AUTO
        26 000340   200040 450500                    STP0    ERROR_IN_COPY+6,,AUTO
        26 000341   200005 631500                    EPPR1   COPY_START_LINE,,AUTO
        26 000342   200037 451500                    STP1    ERROR_IN_COPY+5,,AUTO
        26 000343   000002 236000 27                 LDQ     2
        26 000344   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000345   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 000346   000000 631400 27                 EPPR1   0
        26 000347   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000350   000000 011000                    NOP     0

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:338  
     1438    10129    2                          COPY_START_LINE,
     1439    10130    2                          COPY_START_COLUMN);
     1440    10131            %GET_A_TOKEN;

  10133 26 000351   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 000352   000006 116000 27                 CMPQ    6
        26 000353   000411 600000 26                 TZE     s:10156

  10139 26 000354   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 000355   000010 235100                    LDA     8,,PR0
        26 000356   000010 755000 6                  STA     LEX_SYMBOL+8

  10140 26 000357   000010 720100                    LXL0    8,,PR0
        26 000360   000044 621010                    EAX1    36,X0
        26 000361   000044 622005                    EAX2    36,AL
        26 000362   000040 100540                    MLR     fill='000'O
        26 000363   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        26 000364   000000 000012 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

  10143 26 000365   000010 720100                    LXL0    8,,PR0
        26 000366   000044 621010                    EAX1    36,X0
        26 000367   000000 636011                    EAQ     0,X1
        26 000370   000022 732000                    QRS     18
        26 000371   000003 036007                    ADLQ    3,DL
        26 000372   000004 506007                    DIV     4,DL
        26 000373   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000374   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 000375   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 000376   000014 236000 27                 LDQ     12
        26 000377   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 000400   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000401   000013 631400 27                 EPPR1   11
        26 000402   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 000403   000000 011000                    NOP     0

  10148 26 000404   000000 236000 6                  LDQ     LEX_SYMBOL
        26 000405   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:339  

  10149 26 000406   000006 236000 27                 LDQ     6
        26 000407   000000 756000 6                  STQ     LEX_SYMBOL

  10150 26 000410   000440 710000 26                 TRA     s:10173

  10156 26 000411   000015 631400 27                 EPPR1   13
        26 000412   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000413   000000 011000                    NOP     0

  10157 26 000414   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000415   000426 601000 26                 TNZ     s:10163

  10158 26 000416   000015 631400 27                 EPPR1   13
        26 000417   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        26 000420   000000 011000                    NOP     0

  10159 26 000421   000015 631400 27                 EPPR1   13
        26 000422   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000423   000000 011000                    NOP     0

  10160 26 000424   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000425   000416 600000 26                 TZE     s:10158

  10163 26 000426   000003 236000 6                  LDQ     LEX_SYMBOL+3
        26 000427   000000 116000 19                 CMPQ    CURRENT_SYMBOL_LEVEL
        26 000430   000440 600000 26                 TZE     s:10173
        26 000431   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 000432   200000 316003                    CANQ    65536,DU
        26 000433   000440 601000 26                 TNZ     s:10173

  10165 26 000434   000016 630400 27                 EPPR0   14
        26 000435   000005 631400 27                 EPPR1   5
        26 000436   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        26 000437   000000 011000                    NOP     0

     1441    10169
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:340  
     1442    10170            %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)",
     1443    10171                                    TO$ = COPY_LIBRARY_NAME$);

  10173 26 000440   000010 236000 6                  LDQ     LEX_SYMBOL+8
        26 000441   000047 036007                    ADLQ    39,DL
        26 000442   000004 506007                    DIV     4,DL
        26 000443   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000444   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 000445   200041 450500                    STP0    ERROR_IN_COPY+7,,AUTO
        26 000446   200016 631500                    EPPR1   COPY_LIBRARY_NAME$,,AUTO
        26 000447   200040 451500                    STP1    ERROR_IN_COPY+6,,AUTO
        26 000450   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000451   000013 631400 27                 EPPR1   11
        26 000452   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        26 000453   000000 011000                    NOP     0

  10180 26 000454   200016 470500                    LDP0    COPY_LIBRARY_NAME$,,AUTO
        26 000455   000010 235000 6                  LDA     LEX_SYMBOL+8
        26 000456   000010 755100                    STA     8,,PR0

  10181 26 000457   200016 470500                    LDP0    COPY_LIBRARY_NAME$,,AUTO
        26 000460   000010 720100                    LXL0    8,,PR0
        26 000461   000044 621010                    EAX1    36,X0
        26 000462   000010 722000 6                  LXL2    LEX_SYMBOL+8
        26 000463   000044 623012                    EAX3    36,X2
        26 000464   000140 100440                    MLR     fill='000'O
        26 000465   000000 000013 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        26 000466   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     1444    10186
     1445    10187    2       CALL Z8AH$NEW_DNT (COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.SYMBOL,

  10187 26 000467   200017 630500                    EPPR0   COPY_LIBRARY_DNT$,,AUTO
        26 000470   200040 450500                    STP0    ERROR_IN_COPY+6,,AUTO
        26 000471   200016 236100                    LDQ     COPY_LIBRARY_NAME$,,AUTO
        26 000472   000010 036003                    ADLQ    8,DU
        26 000473   200037 756100                    STQ     ERROR_IN_COPY+5,,AUTO
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:341  
        26 000474   200016 236100                    LDQ     COPY_LIBRARY_NAME$,,AUTO
        26 000475   000011 036003                    ADLQ    9,DU
        26 000476   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000477   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 000500   000000 631400 27                 EPPR1   0
        26 000501   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        26 000502   000000 011000                    NOP     0

     1446    10188    2                          COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.SIZE,
     1447    10189    2                          COPY_LIBRARY_DNT$);
     1448    10190
     1449    10191    2       IF COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.TYPE = %SINGLE_QUOTE

  10191 26 000503   200016 470500                    LDP0    COPY_LIBRARY_NAME$,,AUTO
        26 000504   000001 235100                    LDA     1,,PR0
        26 000505   000004 115007                    CMPA    4,DL
        26 000506   000511 600000 26                 TZE     s:10200
        26 000507   000003 115007                    CMPA    3,DL
        26 000510   000566 601000 26                 TNZ     s:10227

     1450    10192    2            OR COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.TYPE = %DOUBLE_QUOTE THEN
     1451    10193    3         DO;

     1452    10194                %INIT_LX_TERMINAL (@POINTER = "ADDR(STR_TERM)",
     1453    10195                                   @SYMBOL = "COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.TYPE",
     1454    10196                                   @DNT$ = COPY_LIBRARY_DNT$,
     1455    10197                                   @LINE = "COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.LINE",
     1456    10198                                  @COLUMN = "COPY_LIBRARY_NAME$ -> BASED_LEX_SYMBOL.COLUMN"
             10198                                       );

  10200 26 000511   000000 220003                    LDX0    0,DU
        26 000512   200020 740100                    STX0    STR_TERM,,AUTO

  10201 26 000513   000000 221003                    LDX1    0,DU
        26 000514   200020 441100                    SXL1    STR_TERM,,AUTO

  10205 26 000515   000015 235007                    LDA     13,DL
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:342  
        26 000516   200024 755100                    STA     STR_TERM+4,,AUTO

  10207 26 000517   000006 236000 27                 LDQ     6
        26 000520   200027 756100                    STQ     STR_TERM+7,,AUTO

  10209 26 000521   200021 756100                    STQ     STR_TERM+1,,AUTO

  10210 26 000522   000001 235100                    LDA     1,,PR0
        26 000523   200023 755100                    STA     STR_TERM+3,,AUTO

  10211 26 000524   200017 236100                    LDQ     COPY_LIBRARY_DNT$,,AUTO
        26 000525   200022 756100                    STQ     STR_TERM+2,,AUTO

  10212 26 000526   000004 235100                    LDA     4,,PR0
        26 000527   200025 755100                    STA     STR_TERM+5,,AUTO

  10213 26 000530   000005 235100                    LDA     5,,PR0
        26 000531   200026 755100                    STA     STR_TERM+6,,AUTO

     1457    10216    3           CALL Z8EC$INTERNAL_STRING_REP (ADDR(STR_TERM),

  10216 26 000532   200020 631500                    EPPR1   STR_TERM,,AUTO
        26 000533   200036 451500                    STP1    ERROR_IN_COPY+4,,AUTO
        26 000534   200017 633500                    EPPR3   COPY_LIBRARY_DNT$,,AUTO
        26 000535   200041 453500                    STP3    ERROR_IN_COPY+7,,AUTO
        26 000536   200036 634500                    EPPR4   ERROR_IN_COPY+4,,AUTO
        26 000537   200040 454500                    STP4    ERROR_IN_COPY+6,,AUTO
        26 000540   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000541   000013 631400 27                 EPPR1   11
        26 000542   000000 701000 xent               TSX1    Z8EC$INTERNAL_STRING_REP
        26 000543   000000 011000                    NOP     0

     1458    10217    3                                          COPY_LIBRARY_DNT$);
     1459    10218
     1460    10219    3           CALL Z8AH$NEW_DNT (SUBSTR(COPY_LIBRARY_DNT$ -> DNT.TEXT.NAME,

  10219 26 000544   200017 470500                    LDP0    COPY_LIBRARY_DNT$,,AUTO
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:343  
        26 000545   000004 220100                    LDX0    4,,PR0
        26 000546   777776 621010                    EAX1    -2,X0
        26 000547   000004 236100                    LDQ     4,,PR0
        26 000550   000022 772000                    QRL     18
        26 000551   000002 136007                    SBLQ    2,DL
        26 000552   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000553   200017 631500                    EPPR1   COPY_LIBRARY_DNT$,,AUTO
        26 000554   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 000555   200036 633500                    EPPR3   ERROR_IN_COPY+4,,AUTO
        26 000556   200040 453500                    STP3    ERROR_IN_COPY+6,,AUTO
        26 000557   200017 236100                    LDQ     COPY_LIBRARY_DNT$,,AUTO
        26 000560   000023 036000 27                 ADLQ    19
        26 000561   200037 756100                    STQ     ERROR_IN_COPY+5,,AUTO
        26 000562   200037 630500                    EPPR0   ERROR_IN_COPY+5,,AUTO
        26 000563   000000 631400 27                 EPPR1   0
        26 000564   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        26 000565   000000 011000                    NOP     0

     1461    10220    3                                     1,
     1462    10221    3                                     COPY_LIBRARY_DNT$ -> DNT.TEXT.LENGTH - 2),
     1463    10222    3                              COPY_LIBRARY_DNT$ -> DNT.TEXT.LENGTH - 2,
     1464    10223    3                              COPY_LIBRARY_DNT$);
     1465    10224    3         END;

     1466    10225            %GET_A_TOKEN;

  10227 26 000566   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 000567   000006 116000 27                 CMPQ    6
        26 000570   000626 600000 26                 TZE     s:10250

  10233 26 000571   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 000572   000010 235100                    LDA     8,,PR0
        26 000573   000010 755000 6                  STA     LEX_SYMBOL+8

  10234 26 000574   000010 720100                    LXL0    8,,PR0
        26 000575   000044 621010                    EAX1    36,X0
        26 000576   000044 622005                    EAX2    36,AL
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:344  
        26 000577   000040 100540                    MLR     fill='000'O
        26 000600   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        26 000601   000000 000012 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

  10237 26 000602   000010 720100                    LXL0    8,,PR0
        26 000603   000044 621010                    EAX1    36,X0
        26 000604   000000 636011                    EAQ     0,X1
        26 000605   000022 732000                    QRS     18
        26 000606   000003 036007                    ADLQ    3,DL
        26 000607   000004 506007                    DIV     4,DL
        26 000610   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000611   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 000612   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 000613   000014 236000 27                 LDQ     12
        26 000614   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 000615   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000616   000013 631400 27                 EPPR1   11
        26 000617   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 000620   000000 011000                    NOP     0

  10242 26 000621   000000 236000 6                  LDQ     LEX_SYMBOL
        26 000622   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$

  10243 26 000623   000006 236000 27                 LDQ     6
        26 000624   000000 756000 6                  STQ     LEX_SYMBOL

  10244 26 000625   000660 710000 26                 TRA     s:10269

  10250 26 000626   000015 631400 27                 EPPR1   13
        26 000627   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000630   000000 011000                    NOP     0

  10251 26 000631   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000632   000643 601000 26                 TNZ     s:10257

  10252 26 000633   000015 631400 27                 EPPR1   13
        26 000634   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:345  
        26 000635   000000 011000                    NOP     0

  10253 26 000636   000015 631400 27                 EPPR1   13
        26 000637   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000640   000000 011000                    NOP     0

  10254 26 000641   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000642   000633 600000 26                 TZE     s:10252

  10257 26 000643   000003 236000 6                  LDQ     LEX_SYMBOL+3
        26 000644   000000 116000 19                 CMPQ    CURRENT_SYMBOL_LEVEL
        26 000645   000660 600000 26                 TZE     s:10269
        26 000646   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 000647   200000 316003                    CANQ    65536,DU
        26 000650   000660 601000 26                 TNZ     s:10269

  10259 26 000651   000016 630400 27                 EPPR0   14
        26 000652   000005 631400 27                 EPPR1   5
        26 000653   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        26 000654   000000 011000                    NOP     0

     1467    10263    2     END;

  10263 26 000655   000660 710000 26                 TRA     s:10269

     1468    10264    1   ELSE
     1469    10265    2     DO;

     1470    10266    2       COPY_LIBRARY_NAME$ = ADDR(NIL);

  10266 26 000656   000006 236000 27                 LDQ     6
        26 000657   200016 756100                    STQ     COPY_LIBRARY_NAME$,,AUTO

     1471    10267    2     END;

     1472    10268
     1473    10269    1   IF SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'SUPPRESS' THEN
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:346  

  10269 26 000660   000010 720000 6                  LXL0    LEX_SYMBOL+8
        26 000661   040000 106440                    CMPC    fill='040'O
        26 000662   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        26 000663   000002 000010 25                 ADSC9   2                        cn=0,n=8
        26 000664   000754 601000 26                 TNZ     s:10308

     1474    10270          %GET_A_TOKEN;           /*  Skip SUPPRESS  */

  10272 26 000665   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 000666   000006 116000 27                 CMPQ    6
        26 000667   000725 600000 26                 TZE     s:10295

  10278 26 000670   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 000671   000010 235100                    LDA     8,,PR0
        26 000672   000010 755000 6                  STA     LEX_SYMBOL+8

  10279 26 000673   000010 720100                    LXL0    8,,PR0
        26 000674   000044 621010                    EAX1    36,X0
        26 000675   000044 622005                    EAX2    36,AL
        26 000676   000040 100540                    MLR     fill='000'O
        26 000677   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        26 000700   000000 000012 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

  10282 26 000701   000010 720100                    LXL0    8,,PR0
        26 000702   000044 621010                    EAX1    36,X0
        26 000703   000000 636011                    EAQ     0,X1
        26 000704   000022 732000                    QRS     18
        26 000705   000003 036007                    ADLQ    3,DL
        26 000706   000004 506007                    DIV     4,DL
        26 000707   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000710   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 000711   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 000712   000014 236000 27                 LDQ     12
        26 000713   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 000714   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 000715   000013 631400 27                 EPPR1   11
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:347  
        26 000716   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 000717   000000 011000                    NOP     0

  10287 26 000720   000000 236000 6                  LDQ     LEX_SYMBOL
        26 000721   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$

  10288 26 000722   000006 236000 27                 LDQ     6
        26 000723   000000 756000 6                  STQ     LEX_SYMBOL

  10289 26 000724   000754 710000 26                 TRA     s:10308

  10295 26 000725   000015 631400 27                 EPPR1   13
        26 000726   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000727   000000 011000                    NOP     0

  10296 26 000730   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000731   000742 601000 26                 TNZ     s:10302

  10297 26 000732   000015 631400 27                 EPPR1   13
        26 000733   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        26 000734   000000 011000                    NOP     0

  10298 26 000735   000015 631400 27                 EPPR1   13
        26 000736   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 000737   000000 011000                    NOP     0

  10299 26 000740   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 000741   000732 600000 26                 TZE     s:10297

  10302 26 000742   000003 236000 6                  LDQ     LEX_SYMBOL+3
        26 000743   000000 116000 19                 CMPQ    CURRENT_SYMBOL_LEVEL
        26 000744   000754 600000 26                 TZE     s:10308
        26 000745   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 000746   200000 316003                    CANQ    65536,DU
        26 000747   000754 601000 26                 TNZ     s:10308

  10304 26 000750   000016 630400 27                 EPPR0   14
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:348  
        26 000751   000005 631400 27                 EPPR1   5
        26 000752   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        26 000753   000000 011000                    NOP     0

     1475    10308    1   IF SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'REPLACING' THEN

  10308 26 000754   000010 720000 6                  LXL0    LEX_SYMBOL+8
        26 000755   040000 106440                    CMPC    fill='040'O
        26 000756   000011 000010 6                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        26 000757   000004 000011 25                 ADSC9   4                        cn=0,n=9
        26 000760   001050 601000 26                 TNZ     s:10327

     1476    10309    2     DO;

     1477    10310    2       IF COMCOM.OB.FIPS.LEVEL = %INT_LEV THEN

  10310 26 000761   000036 721000 xsym               LXL1    COMCOM+30
        26 000762   000002 101003                    CMPX1   2,DU
        26 000763   000776 601000 26                 TNZ     s:10314

     1478    10311    2         CALL Z8AE$ERROR (%E$LEVEL_CHECK,

  10311 26 000764   200006 630500                    EPPR0   COPY_START_COLUMN,,AUTO
        26 000765   200040 450500                    STP0    ERROR_IN_COPY+6,,AUTO
        26 000766   200005 631500                    EPPR1   COPY_START_LINE,,AUTO
        26 000767   200037 451500                    STP1    ERROR_IN_COPY+5,,AUTO
        26 000770   000002 236000 27                 LDQ     2
        26 000771   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 000772   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 000773   000000 631400 27                 EPPR1   0
        26 000774   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000775   000000 011000                    NOP     0

     1479    10312    2                          COPY_START_LINE,
     1480    10313    2                          COPY_START_COLUMN);
     1481    10314    2       CALL Z8EL$PARSE_REPLACE (REPLACE$,

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:349  
  10314 26 000776   200031 630500                    EPPR0   ERROR_IN_REPLACE,,AUTO
        26 000777   200044 450500                    STP0    ERROR_IN_COPY+10,,AUTO
        26 001000   200012 631500                    EPPR1   END_LEVEL,,AUTO
        26 001001   200043 451500                    STP1    ERROR_IN_COPY+9,,AUTO
        26 001002   200011 633500                    EPPR3   END_COLUMN,,AUTO
        26 001003   200042 453500                    STP3    ERROR_IN_COPY+8,,AUTO
        26 001004   200010 634500                    EPPR4   END_LINE,,AUTO
        26 001005   200041 454500                    STP4    ERROR_IN_COPY+7,,AUTO
        26 001006   200004 635500                    EPPR5   START_COLUMN,,AUTO
        26 001007   200040 455500                    STP5    ERROR_IN_COPY+6,,AUTO
        26 001010   200003 636500                    EPPR6   START_LINE,,AUTO
        26 001011   200037 456500                    STP6    ERROR_IN_COPY+5,,AUTO
        26 001012   200030 637500                    EPPR7   REPLACE$,,AUTO
        26 001013   200036 457500                    STP7    ERROR_IN_COPY+4,,AUTO
        26 001014   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 001015   000024 631400 27                 EPPR1   20
        26 001016   000000 701000 xent               TSX1    Z8EL$PARSE_REPLACE
        26 001017   000000 011000                    NOP     0

     1482    10315    2                                START_LINE,
     1483    10316    2                                START_COLUMN,
     1484    10317    2                                END_LINE,
     1485    10318    2                                END_COLUMN,
     1486    10319    2                                END_LEVEL,
     1487    10320    2                                ERROR_IN_REPLACE);
     1488    10321    2       CALL Z8EL$ADD_REPL_LEVEL (CURRENT_SYMBOL_LEVEL+1, REPLACE$);

  10321 26 001020   000000 235000 19                 LDA     CURRENT_SYMBOL_LEVEL
        26 001021   000001 035007                    ADLA    1,DL
        26 001022   200036 755100                    STA     ERROR_IN_COPY+4,,AUTO
        26 001023   200030 630500                    EPPR0   REPLACE$,,AUTO
        26 001024   200041 450500                    STP0    ERROR_IN_COPY+7,,AUTO
        26 001025   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 001026   200040 451500                    STP1    ERROR_IN_COPY+6,,AUTO
        26 001027   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 001030   000013 631400 27                 EPPR1   11
        26 001031   000000 701000 xent               TSX1    Z8EL$ADD_REPL_LEVEL
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:350  
        26 001032   000000 011000                    NOP     0

     1489    10322    2       CURRENT_SYMBOL_LEVEL = CURRENT_SYMBOL_LEVEL + 1;

  10322 26 001033   000000 054000 19                 AOS     CURRENT_SYMBOL_LEVEL

     1490    10323    2       IF ERROR_IN_REPLACE THEN

  10323 26 001034   200031 234100                    SZN     ERROR_IN_REPLACE,,AUTO
        26 001035   001070 605000 26                 TPL     s:10341

     1491    10324    2         CALL Z8EL$DELETE_REPLACE_LEVEL(CURRENT_SYMBOL_LEVEL+1);

  10324 26 001036   000000 235000 19                 LDA     CURRENT_SYMBOL_LEVEL
        26 001037   000001 035007                    ADLA    1,DL
        26 001040   200036 755100                    STA     ERROR_IN_COPY+4,,AUTO
        26 001041   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 001042   200037 450500                    STP0    ERROR_IN_COPY+5,,AUTO
        26 001043   200037 630500                    EPPR0   ERROR_IN_COPY+5,,AUTO
        26 001044   000005 631400 27                 EPPR1   5
        26 001045   000000 701000 xent               TSX1    Z8EL$DELETE_REPLACE_LEVEL
        26 001046   000000 011000                    NOP     0

     1492    10325    2     END;

  10325 26 001047   001070 710000 26                 TRA     s:10341

     1493    10326    1   ELSE
     1494    10327    1     IF LEX_SYMBOL.TYPE = %PERIOD THEN

  10327 26 001050   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 001051   000014 115007                    CMPA    12,DL
        26 001052   001062 601000 26                 TNZ     s:10335

     1495    10328    2       DO;

     1496    10329    2         END_LINE = LEX_SYMBOL.END_LINE;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:351  

  10329 26 001053   000006 236000 6                  LDQ     LEX_SYMBOL+6
        26 001054   200010 756100                    STQ     END_LINE,,AUTO

     1497    10330    2         END_COLUMN = LEX_SYMBOL.END_COLUMN;

  10330 26 001055   000007 235000 6                  LDA     LEX_SYMBOL+7
        26 001056   200011 755100                    STA     END_COLUMN,,AUTO

     1498    10331    2         END_LEVEL  = LEX_SYMBOL.LEVEL;

  10331 26 001057   000003 235000 6                  LDA     LEX_SYMBOL+3
        26 001060   200012 755100                    STA     END_LEVEL,,AUTO

     1499    10332    2       END;

  10332 26 001061   001070 710000 26                 TRA     s:10341

     1500    10333    1     ELSE
     1501    10334    2       DO;  /* ERROR */

     1502    10335    2         CALL Z8AE$ERROR (%E$COPY_PERIOD_EXPECTED,

  10335 26 001062   000026 630400 27                 EPPR0   22
        26 001063   000000 631400 27                 EPPR1   0
        26 001064   000000 701000 xent               TSX1    Z8AE$ERROR
        26 001065   000000 011000                    NOP     0

     1503    10336    2                          LEX_SYMBOL.LINE,
     1504    10337    2                          LEX_SYMBOL.COLUMN);
     1505    10338    2         ERROR_IN_REPLACE = TRUE;

  10338 26 001066   400000 236003                    LDQ     -131072,DU
        26 001067   200031 756100                    STQ     ERROR_IN_REPLACE,,AUTO

     1506    10339    2       END;

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:352  
     1507    10340
     1508    10341    1   IF NOT ERROR_IN_REPLACE  AND  NOT ERROR_IN_COPY  THEN    /*#34384*/

  10341 26 001070   200031 234100                    SZN     ERROR_IN_REPLACE,,AUTO
        26 001071   001365 604000 26                 TMI     s:10428
        26 001072   200032 234100                    SZN     ERROR_IN_COPY,,AUTO
        26 001073   001365 604000 26                 TMI     s:10428

     1509    10342    2     DO;

     1510    10343    2       CURRENT_LINE_LEVEL = END_LEVEL + 1;

  10343 26 001074   200012 235100                    LDA     END_LEVEL,,AUTO
        26 001075   000001 035007                    ADLA    1,DL
        26 001076   000000 755000 13                 STA     CURRENT_LINE_LEVEL

     1511    10344
     1512    10345    2       IF COPY_START_DEBUG THEN

  10345 26 001077   200007 234100                    SZN     COPY_START_DEBUG,,AUTO
        26 001100   001112 605000 26                 TPL     s:10354

     1513    10346    2         IF COPY_DEBUG_LEVEL = 0 THEN

  10346 26 001101   000000 236000 22                 LDQ     COPY_DEBUG_LEVEL
        26 001102   001105 601000 26                 TNZ     s:10349

     1514    10347    2           COPY_DEBUG_LEVEL = CURRENT_LINE_LEVEL;

  10347 26 001103   000000 755000 22                 STA     COPY_DEBUG_LEVEL
        26 001104   001112 710000 26                 TRA     s:10354

     1515    10348    2         ELSE
     1516    10349    2           COPY_DEBUG_LEVEL = MINIMUM (COPY_DEBUG_LEVEL,

  10349 26 001105   000000 236000 13                 LDQ     CURRENT_LINE_LEVEL
        26 001106   000000 116000 22                 CMPQ    COPY_DEBUG_LEVEL
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:353  
        26 001107   001111 604400 26                 TMOZ    s:10349+4
        26 001110   000000 236000 22                 LDQ     COPY_DEBUG_LEVEL
        26 001111   000000 756000 22                 STQ     COPY_DEBUG_LEVEL

     1517    10350    2                                       CURRENT_LINE_LEVEL);
     1518    10351
     1519    10352            /* Check for trailing tokens on same line as COPY */
     1520    10353
     1521    10354    2       L$ = ADDR(NIL);

  10354 26 001112   000006 236000 27                 LDQ     6
        26 001113   200013 756100                    STQ     L$,,AUTO

     1522    10355    2       CALL Z8EL$POSITION_LINE_LIST(END_LINE, L$, COPY_START_LINE + 1);

  10355 26 001114   200005 235100                    LDA     COPY_START_LINE,,AUTO
        26 001115   000001 035007                    ADLA    1,DL
        26 001116   200036 755100                    STA     ERROR_IN_COPY+4,,AUTO
        26 001117   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 001120   200041 450500                    STP0    ERROR_IN_COPY+7,,AUTO
        26 001121   200013 631500                    EPPR1   L$,,AUTO
        26 001122   200040 451500                    STP1    ERROR_IN_COPY+6,,AUTO
        26 001123   200010 633500                    EPPR3   END_LINE,,AUTO
        26 001124   200037 453500                    STP3    ERROR_IN_COPY+5,,AUTO
        26 001125   200037 630500                    EPPR0   ERROR_IN_COPY+5,,AUTO
        26 001126   000000 631400 27                 EPPR1   0
        26 001127   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        26 001130   000000 011000                    NOP     0

     1523    10356
     1524    10357    2       IF SUBSTR(L$ -> FILL_BUFFER.SOURCE_LINE,

  10357 26 001131   200013 470500                    LDP0    L$,,AUTO
        26 001132   000012 720100                    LXL0    10,,PR0
        26 001133   000123 236000 xsym               LDQ     O1COM+83
        26 001134   000012 116100                    CMPQ    10,,PR0
        26 001135   001137 604400 26                 TMOZ    s:10357+6
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:354  
        26 001136   000012 236100                    LDQ     10,,PR0
        26 001137   200011 136100                    SBLQ    END_COLUMN,,AUTO
        26 001140   000000 621006                    EAX1    0,QL
        26 001141   200011 235100                    LDA     END_COLUMN,,AUTO
        26 001142   040000 106545                    CMPC    fill='040'O
        26 001143   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1
        26 001144   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 001145   001321 600000 26                 TZE     s:10412

     1525    10358    2                 END_COLUMN,
     1526    10359    2                 MINIMUM (L$ -> FILL_BUFFER.LINE_LENGTH,
     1527    10360    2                          O1COM.MARGIN_R) - END_COLUMN) ~= ' ' THEN
     1528    10361    3         DO;

     1529    10362                %NEW_HEAP (@POINTER = TL$,
     1530    10363                           @SIZE = %MAX_INPUT_BUFFER_LEN);

  10365 26 001146   000032 236000 27                 LDQ     26
        26 001147   200037 756100                    STQ     ERROR_IN_COPY+5,,AUTO
        26 001150   200014 631500                    EPPR1   TL$,,AUTO
        26 001151   200036 451500                    STP1    ERROR_IN_COPY+4,,AUTO
        26 001152   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 001153   000013 631400 27                 EPPR1   11
        26 001154   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        26 001155   000000 011000                    NOP     0

     1531    10368    3           TL$ -> FILL_BUFFER.LINE_LENGTH = L$ -> FILL_BUFFER.LINE_LENGTH;

  10368 26 001156   200013 470500                    LDP0    L$,,AUTO
        26 001157   200014 471500                    LDP1    TL$,,AUTO
        26 001160   000012 235100                    LDA     10,,PR0
        26 001161   100012 755100                    STA     10,,PR1

     1532    10369    3           TL$ -> FILL_BUFFER = L$ -> FILL_BUFFER;

  10369 26 001162   200014 470500                    LDP0    TL$,,AUTO
        26 001163   000012 720100                    LXL0    10,,PR0
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:355  
        26 001164   000054 621010                    EAX1    44,X0
        26 001165   200013 471500                    LDP1    L$,,AUTO
        26 001166   100012 722100                    LXL2    10,,PR1
        26 001167   000054 623012                    EAX3    44,X2
        26 001170   000140 100540                    MLR     fill='000'O
        26 001171   100000 000013                    ADSC9   0,,PR1                   cn=0,n=*X3
        26 001172   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     1533    10370    3           TL$ -> FILL_BUFFER.ESN = ' ';

  10370 26 001173   200014 470500                    LDP0    TL$,,AUTO
        26 001174   040100 100400                    MLR     fill='040'O
        26 001175   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 001176   000005 000012                    ADSC9   5,,PR0                   cn=0,n=10

     1534    10371    3           TL$ -> FILL_BUFFER.COLUMN = O1COM.AREA_A_COLUMN_START ;

  10371 26 001177   200014 470500                    LDP0    TL$,,AUTO
        26 001200   000122 235000 xsym               LDA     O1COM+82
        26 001201   000000 755100                    STA     0,,PR0

     1535    10372    3           TL$ -> FILL_BUFFER.CLASS  = %SPACE;

  10372 26 001202   000042 235007                    LDA     34,DL
        26 001203   200014 470500                    LDP0    TL$,,AUTO
        26 001204   000010 755100                    STA     8,,PR0

     1536    10373    3           TL$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;

  10373 26 001205   200014 470500                    LDP0    TL$,,AUTO
        26 001206   000012 236000 27                 LDQ     10
        26 001207   000011 356100                    ANSQ    9,,PR0

     1537    10374    3           TL$ -> FILL_BUFFER.LINE_TYPE.SPLIT_C_R_LINE = FALSE;

  10374 26 001210   200014 470500                    LDP0    TL$,,AUTO
        26 001211   000033 236000 27                 LDQ     27
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:356  
        26 001212   000011 356100                    ANSQ    9,,PR0

     1538    10375    3           SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,

  10375 26 001213   200014 470500                    LDP0    TL$,,AUTO
        26 001214   000012 720100                    LXL0    10,,PR0
        26 001215   200011 236100                    LDQ     END_COLUMN,,AUTO
        26 001216   000122 136000 xsym               SBLQ    O1COM+82
        26 001217   000000 621006                    EAX1    0,QL
        26 001220   000122 236000 xsym               LDQ     O1COM+82
        26 001221   040146 100400                    MLR     fill='040'O
        26 001222   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 001223   000013 000011                    ADSC9   11,Q,PR0                 cn=0,n=*X1

     1539    10376    3                  O1COM.AREA_A_COLUMN_START,
     1540    10377    3                  END_COLUMN - O1COM.AREA_A_COLUMN_START) = ' ';
     1541    10378
     1542    10379    3           IF SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,

  10379 26 001224   200014 470500                    LDP0    TL$,,AUTO
        26 001225   000012 720100                    LXL0    10,,PR0
        26 001226   000122 236000 xsym               LDQ     O1COM+82
        26 001227   040000 106506                    CMPC    fill='040'O
        26 001230   000012 600001                    ADSC9   10,Q,PR0                 cn=3,n=1
        26 001231   000034 000001 27                 ADSC9   28                       cn=0,n=1
        26 001232   001236 601000 26                 TNZ     s:10386

     1543    10380    3                     O1COM.AREA_A_COLUMN_START - 1,
     1544    10381    3                     1) = '-' THEN
     1545    10382    3             SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,

  10382 26 001233   040106 100400                    MLR     fill='040'O
        26 001234   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 001235   000012 600001                    ADSC9   10,Q,PR0                 cn=3,n=1

     1546    10383    3                    O1COM.AREA_A_COLUMN_START - 1,
     1547    10384    3                    1) = ' ';
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:357  
     1548    10385
     1549    10386    3           L$ -> FILL_BUFFER.NEXT$ = TL$;

  10386 26 001236   200014 236100                    LDQ     TL$,,AUTO
        26 001237   200013 470500                    LDP0    L$,,AUTO
        26 001240   000002 756100                    STQ     2,,PR0

     1550    10387    3           SUBSTR(L$ -> FILL_BUFFER.SOURCE_LINE,

  10387 26 001241   200013 470500                    LDP0    L$,,AUTO
        26 001242   000012 720100                    LXL0    10,,PR0
        26 001243   000123 236000 xsym               LDQ     O1COM+83
        26 001244   000012 116100                    CMPQ    10,,PR0
        26 001245   001247 604400 26                 TMOZ    s:10387+6
        26 001246   000012 236100                    LDQ     10,,PR0
        26 001247   200011 136100                    SBLQ    END_COLUMN,,AUTO
        26 001250   000000 621006                    EAX1    0,QL
        26 001251   200011 236100                    LDQ     END_COLUMN,,AUTO
        26 001252   040146 100400                    MLR     fill='040'O
        26 001253   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 001254   000013 000011                    ADSC9   11,Q,PR0                 cn=0,n=*X1

     1551    10388    3                  END_COLUMN,
     1552    10389    3                  MINIMUM (L$ -> FILL_BUFFER.LINE_LENGTH,
     1553    10390    3                           O1COM.MARGIN_R) - END_COLUMN) = ' ';
     1554    10391
     1555    10392                /* Clear previously processed tokens */
     1556    10393    3           SCANNER_STATE = 0;

  10393 26 001255   000000 450000 10                 STZ     SCANNER_STATE

     1557    10394    3           CURRENT_BUFFER$ = L$;

  10394 26 001256   200013 236100                    LDQ     L$,,AUTO
        26 001257   000000 756000 11                 STQ     CURRENT_BUFFER$

     1558    10395    3           EXPANDED_ISN = END_LINE;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:358  

  10395 26 001260   200010 235100                    LDA     END_LINE,,AUTO
        26 001261   000000 755000 17                 STA     EXPANDED_ISN

     1559    10396    3           BUFFER.COLUMN = BUFFER.LINE_LENGTH;

  10396 26 001262   000005 235000 15                 LDA     BUFFER+5
        26 001263   000000 755000 15                 STA     BUFFER

     1560    10397
     1561    10398    4           DO WHILE LEX_SYMBOL_QUEUE$ ~= ADDR(NIL)

  10398 26 001264   001312 710000 26                 TRA     s:10409

     1562    10399    4                AND LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.LINE >= END_LINE;
     1563    10400
     1564    10401    4             TL$ = LEX_SYMBOL_QUEUE$;

  10401 26 001265   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 001266   200014 756100                    STQ     TL$,,AUTO

     1565    10402    4             LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.NEXT$;

  10402 26 001267   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 001270   000000 236100                    LDQ     0,,PR0
        26 001271   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$

     1566    10403
     1567    10404    4             CALL Z8ED$DISPOSE_HEAP (TL$,

  10404 26 001272   200014 470500                    LDP0    TL$,,AUTO
        26 001273   000010 720100                    LXL0    8,,PR0
        26 001274   000044 621010                    EAX1    36,X0
        26 001275   000000 636011                    EAQ     0,X1
        26 001276   000022 732000                    QRS     18
        26 001277   000003 036007                    ADLQ    3,DL
        26 001300   000004 506007                    DIV     4,DL
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:359  
        26 001301   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 001302   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 001303   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 001304   200014 633500                    EPPR3   TL$,,AUTO
        26 001305   200040 453500                    STP3    ERROR_IN_COPY+6,,AUTO
        26 001306   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 001307   000013 631400 27                 EPPR1   11
        26 001310   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 001311   000000 011000                    NOP     0

     1568    10405                                          %LEX_SYMBOL_ACTUAL_WORD_LEN (S$ = TL$);
     1569    10408    4                                    );
     1570    10409    4           END;

  10409 26 001312   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 001313   000006 116000 27                 CMPQ    6
        26 001314   001321 600000 26                 TZE     s:10412
        26 001315   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 001316   000004 236100                    LDQ     4,,PR0
        26 001317   200010 116100                    CMPQ    END_LINE,,AUTO
        26 001320   001265 605000 26                 TPL     s:10401

     1571    10410    3         END;

     1572    10411
     1573    10412    2       IF COPY_LIBRARY_NAME$ ~= ADDR(NIL) THEN

  10412 26 001321   200016 236100                    LDQ     COPY_LIBRARY_NAME$,,AUTO
        26 001322   000006 116000 27                 CMPQ    6
        26 001323   001351 600000 26                 TZE     s:10422

     1574    10413    3         DO;

     1575    10414    3           CALL Z9AA$OPEN_COPY_FILE (COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SYMBOL,

  10414 26 001324   200017 470500                    LDP0    COPY_LIBRARY_DNT$,,AUTO
        26 001325   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:360  
        26 001326   000022 772000                    QRL     18
        26 001327   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 001330   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 001331   200044 451500                    STP1    ERROR_IN_COPY+10,,AUTO
        26 001332   200017 236100                    LDQ     COPY_LIBRARY_DNT$,,AUTO
        26 001333   000036 036000 27                 ADLQ    30
        26 001334   000037 235000 27                 LDA     31
        26 001335   200042 757100                    STAQ    ERROR_IN_COPY+8,,AUTO
        26 001336   200015 236100                    LDQ     COPY_FILE_NAME$,,AUTO
        26 001337   000010 036003                    ADLQ    8,DU
        26 001340   200041 756100                    STQ     ERROR_IN_COPY+7,,AUTO
        26 001341   200015 236100                    LDQ     COPY_FILE_NAME$,,AUTO
        26 001342   000011 036003                    ADLQ    9,DU
        26 001343   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 001344   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 001345   000035 631400 27                 EPPR1   29
        26 001346   000000 701000 xent               TSX1    Z9AA$OPEN_COPY_FILE
        26 001347   000000 011000                    NOP     0

     1576    10415    3                                     COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SIZE,
     1577    10416    3                                     CURRENT_LINE_LEVEL,
     1578    10417    3                                     COPY_LIBRARY_DNT$ -> DNT.TEXT.NAME,
     1579    10418    3                                     BINBIT(COPY_LIBRARY_DNT$ -> DNT.TEXT.LENGTH,36));
     1580    10419    3         END;

  10419 26 001350   001365 710000 26                 TRA     s:10428

     1581    10420    2       ELSE
     1582    10421    3         DO;

     1583    10422    3           CALL Z9AA$OPEN_COPY_FILE (COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SYMBOL,

  10422 26 001351   000037 236000 27                 LDQ     31
        26 001352   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 001353   200015 236100                    LDQ     COPY_FILE_NAME$,,AUTO
        26 001354   000010 036003                    ADLQ    8,DU
        26 001355   200037 756100                    STQ     ERROR_IN_COPY+5,,AUTO
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:361  
        26 001356   200015 236100                    LDQ     COPY_FILE_NAME$,,AUTO
        26 001357   000011 036003                    ADLQ    9,DU
        26 001360   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 001361   200036 630500                    EPPR0   ERROR_IN_COPY+4,,AUTO
        26 001362   000000 631400 27                 EPPR1   0
        26 001363   000000 701000 xent               TSX1    Z9AA$OPEN_COPY_FILE
        26 001364   000000 011000                    NOP     0

     1584    10423    3                                     COPY_FILE_NAME$ -> BASED_LEX_SYMBOL.SIZE,
     1585    10424    3                                     CURRENT_LINE_LEVEL);
     1586    10425    3         END;

     1587    10426    2     END;

     1588    10427
     1589    10428    1   CALL Z8ED$DISPOSE_HEAP(COPY_FILE_NAME$,

  10428 26 001365   200015 470500                    LDP0    COPY_FILE_NAME$,,AUTO
        26 001366   000010 720100                    LXL0    8,,PR0
        26 001367   000044 621010                    EAX1    36,X0
        26 001370   000000 636011                    EAQ     0,X1
        26 001371   000022 732000                    QRS     18
        26 001372   000003 036007                    ADLQ    3,DL
        26 001373   000004 506007                    DIV     4,DL
        26 001374   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 001375   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 001376   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 001377   200015 633500                    EPPR3   COPY_FILE_NAME$,,AUTO
        26 001400   200040 453500                    STP3    ERROR_IN_COPY+6,,AUTO
        26 001401   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 001402   000013 631400 27                 EPPR1   11
        26 001403   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 001404   000000 011000                    NOP     0

     1590    10429                    %LEX_SYMBOL_ACTUAL_WORD_LEN (S$=COPY_FILE_NAME$);
     1591    10432    1               );
     1592    10433
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:362  
     1593    10434    1   IF COPY_LIBRARY_NAME$ ~= ADDR(NIL) THEN

  10434 26 001405   200016 236100                    LDQ     COPY_LIBRARY_NAME$,,AUTO
        26 001406   000006 116000 27                 CMPQ    6
        26 001407   001430 600000 26                 TZE     s:10442

     1594    10435    1     CALL Z8ED$DISPOSE_HEAP(COPY_LIBRARY_NAME$,

  10435 26 001410   200016 470500                    LDP0    COPY_LIBRARY_NAME$,,AUTO
        26 001411   000010 720100                    LXL0    8,,PR0
        26 001412   000044 621010                    EAX1    36,X0
        26 001413   000000 636011                    EAQ     0,X1
        26 001414   000022 732000                    QRS     18
        26 001415   000003 036007                    ADLQ    3,DL
        26 001416   000004 506007                    DIV     4,DL
        26 001417   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 001420   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 001421   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 001422   200016 633500                    EPPR3   COPY_LIBRARY_NAME$,,AUTO
        26 001423   200040 453500                    STP3    ERROR_IN_COPY+6,,AUTO
        26 001424   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 001425   000013 631400 27                 EPPR1   11
        26 001426   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 001427   000000 011000                    NOP     0

     1595    10436                    %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=COPY_LIBRARY_NAME$);
     1596    10439    1               );
     1597    10440
     1598    10441
     1599    10442    1   RETURN;

  10442 26 001430   000000 702200 xent               TSX2  ! X66_ARET

     1600    10443        %EJECT;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:363  
     1601    10444        /*----------*/
     1602    10445    1     COPY_ERROR : PROC;

  10445 26 001431   200034 741300       COPY_ERROR   STX1  ! ERROR_IN_COPY+2,,AUTO

     1603    10446        /*----------*/
     1604    10447
     1605    10448
     1606    10449    2   CALL Z8AE$ERROR( %E$INTERNAL_COPY,

  10449 26 001432   000041 630400 27                 EPPR0   33
        26 001433   000000 631400 27                 EPPR1   0
        26 001434   000000 701000 xent               TSX1    Z8AE$ERROR
        26 001435   000000 011000                    NOP     0

     1607    10450    2                    LEX_SYMBOL.LINE,
     1608    10451    2                    LEX_SYMBOL.COLUMN );
     1609    10452
     1610    10453        %PARSE_A_TOKEN;                      /* FILE NAME */

  10457 26 001436   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 001437   000006 116000 27                 CMPQ    6
        26 001440   001476 600000 26                 TZE     s:10480

  10463 26 001441   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 001442   000010 235100                    LDA     8,,PR0
        26 001443   000010 755000 6                  STA     LEX_SYMBOL+8

  10464 26 001444   000010 720100                    LXL0    8,,PR0
        26 001445   000044 621010                    EAX1    36,X0
        26 001446   000044 622005                    EAX2    36,AL
        26 001447   000040 100540                    MLR     fill='000'O
        26 001450   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        26 001451   000000 000012 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

  10467 26 001452   000010 720100                    LXL0    8,,PR0
        26 001453   000044 621010                    EAX1    36,X0
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:364  
        26 001454   000000 636011                    EAQ     0,X1
        26 001455   000022 732000                    QRS     18
        26 001456   000003 036007                    ADLQ    3,DL
        26 001457   000004 506007                    DIV     4,DL
        26 001460   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 001461   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 001462   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 001463   000014 236000 27                 LDQ     12
        26 001464   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 001465   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 001466   000013 631400 27                 EPPR1   11
        26 001467   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 001470   000000 011000                    NOP     0

  10472 26 001471   000000 236000 6                  LDQ     LEX_SYMBOL
        26 001472   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$

  10473 26 001473   000006 236000 27                 LDQ     6
        26 001474   000000 756000 6                  STQ     LEX_SYMBOL

  10474 26 001475   001525 710000 26                 TRA     s:10495

  10480 26 001476   000015 631400 27                 EPPR1   13
        26 001477   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 001500   000000 011000                    NOP     0

  10481 26 001501   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 001502   001513 601000 26                 TNZ     s:10487

  10482 26 001503   000015 631400 27                 EPPR1   13
        26 001504   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        26 001505   000000 011000                    NOP     0

  10483 26 001506   000015 631400 27                 EPPR1   13
        26 001507   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 001510   000000 011000                    NOP     0

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:365  
  10484 26 001511   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 001512   001503 600000 26                 TZE     s:10482

  10487 26 001513   000003 236000 6                  LDQ     LEX_SYMBOL+3
        26 001514   000000 116000 19                 CMPQ    CURRENT_SYMBOL_LEVEL
        26 001515   001525 600000 26                 TZE     s:10495
        26 001516   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 001517   200000 316003                    CANQ    65536,DU
        26 001520   001525 601000 26                 TNZ     s:10495

  10489 26 001521   000016 630400 27                 EPPR0   14
        26 001522   000005 631400 27                 EPPR1   5
        26 001523   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        26 001524   000000 011000                    NOP     0

  10495 26 001525   000004 235000 6                  LDA     LEX_SYMBOL+4
        26 001526   000133 755000 xsym               STA     COMCOM+91

  10496 26 001527   000005 236000 6                  LDQ     LEX_SYMBOL+5
        26 001530   000134 756000 xsym               STQ     COMCOM+92

     1611    10501
     1612    10502    3   DO WHILE LEX_SYMBOL.TYPE ~= %PERIOD;

  10502 26 001531   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 001532   000014 115007                    CMPA    12,DL
        26 001533   001626 600000 26                 TZE     s:10543

     1613    10503          %GET_A_TOKEN;

  10505 26 001534   000000 236000 24                 LDQ     LEX_SYMBOL_QUEUE$
        26 001535   000006 116000 27                 CMPQ    6
        26 001536   001574 600000 26                 TZE     s:10528

  10511 26 001537   000000 470400 24                 LDP0    LEX_SYMBOL_QUEUE$
        26 001540   000010 235100                    LDA     8,,PR0
        26 001541   000010 755000 6                  STA     LEX_SYMBOL+8
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:366  

  10512 26 001542   000010 720100                    LXL0    8,,PR0
        26 001543   000044 621010                    EAX1    36,X0
        26 001544   000044 622005                    EAX2    36,AL
        26 001545   000040 100540                    MLR     fill='000'O
        26 001546   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        26 001547   000000 000012 6                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

  10515 26 001550   000010 720100                    LXL0    8,,PR0
        26 001551   000044 621010                    EAX1    36,X0
        26 001552   000000 636011                    EAQ     0,X1
        26 001553   000022 732000                    QRS     18
        26 001554   000003 036007                    ADLQ    3,DL
        26 001555   000004 506007                    DIV     4,DL
        26 001556   200036 756100                    STQ     ERROR_IN_COPY+4,,AUTO
        26 001557   200036 631500                    EPPR1   ERROR_IN_COPY+4,,AUTO
        26 001560   200041 451500                    STP1    ERROR_IN_COPY+7,,AUTO
        26 001561   000014 236000 27                 LDQ     12
        26 001562   200040 756100                    STQ     ERROR_IN_COPY+6,,AUTO
        26 001563   200040 630500                    EPPR0   ERROR_IN_COPY+6,,AUTO
        26 001564   000013 631400 27                 EPPR1   11
        26 001565   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        26 001566   000000 011000                    NOP     0

  10520 26 001567   000000 236000 6                  LDQ     LEX_SYMBOL
        26 001570   000000 756000 24                 STQ     LEX_SYMBOL_QUEUE$

  10521 26 001571   000006 236000 27                 LDQ     6
        26 001572   000000 756000 6                  STQ     LEX_SYMBOL

  10522 26 001573   001623 710000 26                 TRA     s:10541

  10528 26 001574   000015 631400 27                 EPPR1   13
        26 001575   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 001576   000000 011000                    NOP     0

  10529 26 001577   000001 235000 6                  LDA     LEX_SYMBOL+1
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:367  
        26 001600   001611 601000 26                 TNZ     s:10535

  10530 26 001601   000015 631400 27                 EPPR1   13
        26 001602   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        26 001603   000000 011000                    NOP     0

  10531 26 001604   000015 631400 27                 EPPR1   13
        26 001605   000000 701000 xent               TSX1    Z8ES$SCANNER
        26 001606   000000 011000                    NOP     0

  10532 26 001607   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 001610   001601 600000 26                 TZE     s:10530

  10535 26 001611   000003 236000 6                  LDQ     LEX_SYMBOL+3
        26 001612   000000 116000 19                 CMPQ    CURRENT_SYMBOL_LEVEL
        26 001613   001623 600000 26                 TZE     s:10541
        26 001614   000002 236000 6                  LDQ     LEX_SYMBOL+2
        26 001615   200000 316003                    CANQ    65536,DU
        26 001616   001623 601000 26                 TNZ     s:10541

  10537 26 001617   000016 630400 27                 EPPR0   14
        26 001620   000005 631400 27                 EPPR1   5
        26 001621   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        26 001622   000000 011000                    NOP     0

     1614    10541    3   END;

  10541 26 001623   000001 235000 6                  LDA     LEX_SYMBOL+1
        26 001624   000014 115007                    CMPA    12,DL
        26 001625   001534 601000 26                 TNZ     s:10505

     1615    10542
     1616    10543    2   END COPY_ERROR;

  10543 26 001626   200034 221300                    LDX1  ! ERROR_IN_COPY+2,,AUTO
        26 001627   000001 702211                    TSX2  ! 1,X1
     1617    10544    1   END Z8EL$PROCESS_COPY;
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:368  
     1618    10545
     1619    10546        %EOD;

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:369  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$PROCESS_COPY.
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:370  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 002 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 003 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 004 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:371  
  ****  Section 005 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 006 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 007 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 008 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 009 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 010 LblCom SCANNER_STATE

PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:372  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 SCANNER_STATE

  ****  Section 011 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_BUFFER$

  ****  Section 012 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 013 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CURRENT_LINE_LEVEL

  ****  Section 014 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 015 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:373  

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 016 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 017 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 EXPANDED_ISN

  ****  Section 018 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 019 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CURRENT_SYMBOL_LEVEL

  ****  Section 020 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:374  

  ****  Section 021 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 022 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 COPY_DEBUG_LEVEL

  ****  Section 023 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 024 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LEX_SYMBOL_QUEUE$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w PTR         r     1 COPY_FILE_NAME$           17-0-0/w PTR         r     1 COPY_LIBRARY_DNT$
    16-0-0/w PTR         r     1 COPY_LIBRARY_NAME$         6-0-0/w SBIN        r     1 COPY_START_COLUMN
     7-0-0/b BIT         r     1 COPY_START_DEBUG           5-0-0/w SBIN        r     1 COPY_START_LINE
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:375  
    11-0-0/w SBIN        r     1 END_COLUMN                12-0-0/w SBIN        r     1 END_LEVEL
    10-0-0/w SBIN        r     1 END_LINE                  32-0-0/b BIT         r     1 ERROR_IN_COPY
    31-0-0/b BIT         r     1 ERROR_IN_REPLACE          13-0-0/w PTR         r     1 L$
    30-0-0/w PTR         r     1 REPLACE$                   4-0-0/w SBIN        r     1 START_COLUMN
     3-0-0/w SBIN        r     1 START_LINE                20-0-0/d STRC(288)   r     1 STR_TERM
    14-0-0/w PTR         r     1 TL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w PTR               1 DNT_BUCKETS(0:1128)
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/d STRC(11580) r     1 O1COM
     0-0-0/w STRC(144)         1 PAGE_FORMAT                0-0-0/w STRC(153)         1 REP_STK(0:50)
     0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF
     0-0-0/w ASTR(396)   r     1 FILL_BUFFER                0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(288)         1 LA_ITEM
PL6.E3A0      #006=Z8EL$PROCESS_COPY File=Z8EL.:Z8A6TSI                          SAT 08/09/97 12:09 Page:376  
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)   r     1 LX_TERMINAL
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(252)         1 REPLACE_ITEM
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$PROCESS_COPY requires 920 words for executable code.
   Procedure Z8EL$PROCESS_COPY requires 38 words of local(AUTO) storage.

PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:377  
     1620        1        /*T***********************************************************/
     1621        2        /*T*                                                         */
     1622        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1623        4        /*T*                                                         */
     1624        5        /*T***********************************************************/
     1625        6        Z8EL$PROCESS_REPLACE : PROC;
     1626        7
     1627        8        %EQU PHASE = 1;
     1628        9        %INCLUDE Z8A_DEFC;
     1629       77        %INCLUDE Z8A_SUPP_MAC;
     1630     2477        %INCLUDE Z8E_HEAP;
     1631     2533        %INCLUDE Z8E_STACKS;
     1632     4799        %INCLUDE Z8E_REPLACE;
     1633     5102        %INCLUDE Z8E_BUFFERS;
     1634     5292        %INCLUDE Z8E_O1COM;
     1635     6053        %INCLUDE Z8A_COMCOM;
     1636     6703
     1637     6704    1   DCL Z8EL$PARSE_REPLACE ENTRY(7);
     1638     6705    1   DCL Z8EL$ADD_REPL_LEVEL ENTRY(2);
     1639     6706    1   DCL Z8EL$BLANK_SOURCE_LINES ENTRY(4);
     1640     6707    1   DCL Z8EL$START_WRITING_ES_FILE ENTRY(1);
     1641     6708    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     1642     6709    1   DCL Z8EL$POSITION_LINE_LIST ENTRY(3);
     1643     6710
     1644     6711
     1645     6712    1   DCL START_LINE SBIN WORD;
     1646     6713    1   DCL START_COLUMN SBIN WORD;
     1647     6714    1   DCL END_LINE SBIN ;
     1648     6715    1   DCL END_COLUMN SBIN;
     1649     6716    1   DCL END_LEVEL SBIN;
     1650     6717
     1651     6718    1   DCL REPLACE_LEVEL SBIN WORD;
     1652     6719    1   DCL COPY_LEVEL SBIN WORD;
     1653     6720    1   DCL L$ PTR;
     1654     6721
     1655     6722
     1656     6723    1   DCL REPLACE$ PTR;
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:378  
     1657     6724    1   DCL ERROR_IN_REPLACE BOOLEAN;
     1658     6725
     1659     6726
     1660     6727          %UPDATE_PARSE_POSITION;
     1661     6733
     1662     6734    1     CALL Z8EL$START_WRITING_ES_FILE (LEX_SYMBOL.LINE);
     1663     6735
     1664     6736    1     IF LEX_SYMBOL.COLUMN > O1COM.AREA_A_COLUMN_START THEN
     1665     6737    2       DO;
     1666     6738    2         L$ = ADDR(NIL);
     1667     6739    2         CALL Z8EL$POSITION_LINE_LIST(LEX_SYMBOL.LINE, L$, 999999999);
     1668     6740    2         IF SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,
     1669     6741    2                    O1COM.AREA_A_COLUMN_START,
     1670     6742    2                    LEX_SYMBOL.COLUMN - O1COM.AREA_A_COLUMN_START) ~= ' ' THEN
     1671     6743    3           DO;
     1672     6744    3             L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_C_R_LINE = TRUE;
     1673     6745    3             L$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;
     1674     6746    3             L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_COLUMN = LEX_SYMBOL.COLUMN;
     1675     6747    3           END;
     1676     6748    2       END;
     1677     6749    1     CALL Z8EL$PARSE_REPLACE (REPLACE$,
     1678     6750    1                              START_LINE,
     1679     6751    1                              START_COLUMN,
     1680     6752    1                              END_LINE,
     1681     6753    1                              END_COLUMN,
     1682     6754    1                              END_LEVEL,
     1683     6755    1                              ERROR_IN_REPLACE);
     1684     6756    1     IF NOT ERROR_IN_REPLACE THEN
     1685     6757    2       DO;
     1686     6758    2         L$ = ADDR(NIL);
     1687     6759    2         CALL Z8EL$POSITION_LINE_LIST(END_LINE, L$, START_LINE);
     1688     6760    2         IF SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE, END_COLUMN,
     1689     6761    2             O1COM.MARGIN_R - END_COLUMN) ~= ' ' THEN
     1690     6762    3           DO;
     1691     6763    3             L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_COLUMN = END_COLUMN;
     1692     6764    3             L$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;
     1693     6765    3           END;
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:379  
     1694     6766    2       END;
     1695     6767
     1696     6768    1     CALL Z8EL$ADD_REPL_LEVEL(0, REPLACE$);
     1697     6769
     1698     6770    1     IF ERROR_IN_REPLACE
     1699     6771    1        OR SUBSTR(REPLACE$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SYMBOL,
     1700     6772    1               0,
     1701     6773    1               REPLACE$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SIZE)
     1702     6774    1             = 'OFF' THEN
     1703     6775    2       DO;
     1704     6776    2         CALL Z8EL$DELETE_REPLACE_LEVEL (0);
     1705     6777    2       END;
     1706     6778
     1707     6779
     1708     6780    1   END Z8EL$PROCESS_REPLACE;
     1709     6781
     1710     6782        %EOD;

PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:380  
--  Include file information  --

   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$PROCESS_REPLACE.

   Procedure Z8EL$PROCESS_REPLACE requires 112 words for executable code.
   Procedure Z8EL$PROCESS_REPLACE requires 22 words of local(AUTO) storage.

PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:381  

 Object Unit name= Z8EL$PROCESS_REPLACE                       File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:11:37.68 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  HEAP$
    2  LblCom even  none    90    132  LEX_SYMBOL
    3  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    5  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    6  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    7  LblCom even  none     1      1  REPLACE_ACTIVE
    8  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    9  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   10  LblCom even  none     4      4  REPLACE_LIST
   11  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   12  LblCom even  none     1      1  SCANNER_STATE
   13  LblCom even  none     1      1  CURRENT_BUFFER$
   14  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
   15  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   16  LblCom even  none     1      1  LINE_LIST$
   17  LblCom even  none     7      7  BUFFER
   18  LblCom even  none     1      1  ORIGINAL_ISN
   19  LblCom even  none     1      1  EXPANDED_ISN
   20  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   21  RoData even  UTS      1      1  Z8EL$PROCESS_REPLACE
   22   Proc  even  none   112    160  Z8EL$PROCESS_REPLACE
   23  RoData even  none    12     14  Z8EL$PROCESS_REPLACE
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:382  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    22      0   yes            yes      Std        0  Z8EL$PROCESS_REPLACE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8EL$START_WRITING_ES_FILE
         yes           Std       7 Z8EL$PARSE_REPLACE
         yes           Std       2 Z8EL$ADD_REPL_LEVEL
         yes           Std       1 Z8EL$DELETE_REPLACE_LEVEL
         yes           Std       3 Z8EL$POSITION_LINE_LIST
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK
     COMCOM

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:383  


     1620        1        /*T***********************************************************/
     1621        2        /*T*                                                         */
     1622        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1623        4        /*T*                                                         */
     1624        5        /*T***********************************************************/
     1625        6        Z8EL$PROCESS_REPLACE : PROC;

      6 22 000000   000000 700200 xent  Z8EL$PROCES* TSX0  ! X66_AUTO_0
        22 000001   000026 000000                    ZERO    22,0

     1626        7
     1627        8        %EQU PHASE = 1;
     1628        9        %INCLUDE Z8A_DEFC;
     1629       77        %INCLUDE Z8A_SUPP_MAC;
     1630     2477        %INCLUDE Z8E_HEAP;
     1631     2533        %INCLUDE Z8E_STACKS;
     1632     4799        %INCLUDE Z8E_REPLACE;
     1633     5102        %INCLUDE Z8E_BUFFERS;
     1634     5292        %INCLUDE Z8E_O1COM;
     1635     6053        %INCLUDE Z8A_COMCOM;
     1636     6703
     1637     6704    1   DCL Z8EL$PARSE_REPLACE ENTRY(7);
     1638     6705    1   DCL Z8EL$ADD_REPL_LEVEL ENTRY(2);
     1639     6706    1   DCL Z8EL$BLANK_SOURCE_LINES ENTRY(4);
     1640     6707    1   DCL Z8EL$START_WRITING_ES_FILE ENTRY(1);
     1641     6708    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     1642     6709    1   DCL Z8EL$POSITION_LINE_LIST ENTRY(3);
     1643     6710
     1644     6711
     1645     6712    1   DCL START_LINE SBIN WORD;
     1646     6713    1   DCL START_COLUMN SBIN WORD;
     1647     6714    1   DCL END_LINE SBIN ;
     1648     6715    1   DCL END_COLUMN SBIN;
     1649     6716    1   DCL END_LEVEL SBIN;
     1650     6717
     1651     6718    1   DCL REPLACE_LEVEL SBIN WORD;
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:384  
     1652     6719    1   DCL COPY_LEVEL SBIN WORD;
     1653     6720    1   DCL L$ PTR;
     1654     6721
     1655     6722
     1656     6723    1   DCL REPLACE$ PTR;
     1657     6724    1   DCL ERROR_IN_REPLACE BOOLEAN;
     1658     6725
     1659     6726
     1660     6727          %UPDATE_PARSE_POSITION;

   6729 22 000002   000004 235000 2                  LDA     LEX_SYMBOL+4
        22 000003   000133 755000 xsym               STA     COMCOM+91

   6730 22 000004   000005 236000 2                  LDQ     LEX_SYMBOL+5
        22 000005   000134 756000 xsym               STQ     COMCOM+92

     1661     6733
     1662     6734    1     CALL Z8EL$START_WRITING_ES_FILE (LEX_SYMBOL.LINE);

   6734 22 000006   000001 630400 23                 EPPR0   1
        22 000007   000000 631400 23                 EPPR1   0
        22 000010   000000 701000 xent               TSX1    Z8EL$START_WRITING_ES_FILE
        22 000011   000000 011000                    NOP     0

     1663     6735
     1664     6736    1     IF LEX_SYMBOL.COLUMN > O1COM.AREA_A_COLUMN_START THEN

   6736 22 000012   000005 236000 2                  LDQ     LEX_SYMBOL+5
        22 000013   000122 116000 xsym               CMPQ    O1COM+82
        22 000014   000053 604400 22                 TMOZ    s:6749

     1665     6737    2       DO;

     1666     6738    2         L$ = ADDR(NIL);

   6738 22 000015   000002 236000 23                 LDQ     2
        22 000016   200012 756100                    STQ     L$,,AUTO
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:385  

     1667     6739    2         CALL Z8EL$POSITION_LINE_LIST(LEX_SYMBOL.LINE, L$, 999999999);

   6739 22 000017   000005 236000 23                 LDQ     5
        22 000020   200020 756100                    STQ     ERROR_IN_REPLACE+4,,AUTO
        22 000021   200012 630500                    EPPR0   L$,,AUTO
        22 000022   200017 450500                    STP0    ERROR_IN_REPLACE+3,,AUTO
        22 000023   000001 236000 23                 LDQ     1
        22 000024   200016 756100                    STQ     ERROR_IN_REPLACE+2,,AUTO
        22 000025   200016 630500                    EPPR0   ERROR_IN_REPLACE+2,,AUTO
        22 000026   000003 631400 23                 EPPR1   3
        22 000027   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        22 000030   000000 011000                    NOP     0

     1668     6740    2         IF SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,

   6740 22 000031   200012 470500                    LDP0    L$,,AUTO
        22 000032   000012 720100                    LXL0    10,,PR0
        22 000033   000005 236000 2                  LDQ     LEX_SYMBOL+5
        22 000034   000122 136000 xsym               SBLQ    O1COM+82
        22 000035   000000 621006                    EAX1    0,QL
        22 000036   000122 235000 xsym               LDA     O1COM+82
        22 000037   040000 106545                    CMPC    fill='040'O
        22 000040   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1
        22 000041   000006 000001 23                 ADSC9   6                        cn=0,n=1
        22 000042   000053 600000 22                 TZE     s:6749

     1669     6741    2                    O1COM.AREA_A_COLUMN_START,
     1670     6742    2                    LEX_SYMBOL.COLUMN - O1COM.AREA_A_COLUMN_START) ~= ' ' THEN
     1671     6743    3           DO;

     1672     6744    3             L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_C_R_LINE = TRUE;

   6744 22 000043   000004 236003                    LDQ     4,DU
        22 000044   000011 256100                    ORSQ    9,,PR0

     1673     6745    3             L$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:386  

   6745 22 000045   200012 470500                    LDP0    L$,,AUTO
        22 000046   000007 236000 23                 LDQ     7
        22 000047   000011 356100                    ANSQ    9,,PR0

     1674     6746    3             L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_COLUMN = LEX_SYMBOL.COLUMN;

   6746 22 000050   200012 470500                    LDP0    L$,,AUTO
        22 000051   000005 236000 2                  LDQ     LEX_SYMBOL+5
        22 000052   000011 552104                    STBQ    9,'04'O,PR0

     1675     6747    3           END;

     1676     6748    2       END;

     1677     6749    1     CALL Z8EL$PARSE_REPLACE (REPLACE$,

   6749 22 000053   200014 630500                    EPPR0   ERROR_IN_REPLACE,,AUTO
        22 000054   200024 450500                    STP0    ERROR_IN_REPLACE+8,,AUTO
        22 000055   200007 631500                    EPPR1   END_LEVEL,,AUTO
        22 000056   200023 451500                    STP1    ERROR_IN_REPLACE+7,,AUTO
        22 000057   200006 633500                    EPPR3   END_COLUMN,,AUTO
        22 000060   200022 453500                    STP3    ERROR_IN_REPLACE+6,,AUTO
        22 000061   200005 634500                    EPPR4   END_LINE,,AUTO
        22 000062   200021 454500                    STP4    ERROR_IN_REPLACE+5,,AUTO
        22 000063   200004 635500                    EPPR5   START_COLUMN,,AUTO
        22 000064   200020 455500                    STP5    ERROR_IN_REPLACE+4,,AUTO
        22 000065   200003 636500                    EPPR6   START_LINE,,AUTO
        22 000066   200017 456500                    STP6    ERROR_IN_REPLACE+3,,AUTO
        22 000067   200013 637500                    EPPR7   REPLACE$,,AUTO
        22 000070   200016 457500                    STP7    ERROR_IN_REPLACE+2,,AUTO
        22 000071   200016 630500                    EPPR0   ERROR_IN_REPLACE+2,,AUTO
        22 000072   000010 631400 23                 EPPR1   8
        22 000073   000000 701000 xent               TSX1    Z8EL$PARSE_REPLACE
        22 000074   000000 011000                    NOP     0

     1678     6750    1                              START_LINE,
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:387  
     1679     6751    1                              START_COLUMN,
     1680     6752    1                              END_LINE,
     1681     6753    1                              END_COLUMN,
     1682     6754    1                              END_LEVEL,
     1683     6755    1                              ERROR_IN_REPLACE);
     1684     6756    1     IF NOT ERROR_IN_REPLACE THEN

   6756 22 000075   200014 234100                    SZN     ERROR_IN_REPLACE,,AUTO
        22 000076   000132 604000 22                 TMI     s:6768

     1685     6757    2       DO;

     1686     6758    2         L$ = ADDR(NIL);

   6758 22 000077   000002 236000 23                 LDQ     2
        22 000100   200012 756100                    STQ     L$,,AUTO

     1687     6759    2         CALL Z8EL$POSITION_LINE_LIST(END_LINE, L$, START_LINE);

   6759 22 000101   200003 630500                    EPPR0   START_LINE,,AUTO
        22 000102   200020 450500                    STP0    ERROR_IN_REPLACE+4,,AUTO
        22 000103   200012 631500                    EPPR1   L$,,AUTO
        22 000104   200017 451500                    STP1    ERROR_IN_REPLACE+3,,AUTO
        22 000105   200005 633500                    EPPR3   END_LINE,,AUTO
        22 000106   200016 453500                    STP3    ERROR_IN_REPLACE+2,,AUTO
        22 000107   200016 630500                    EPPR0   ERROR_IN_REPLACE+2,,AUTO
        22 000110   000003 631400 23                 EPPR1   3
        22 000111   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        22 000112   000000 011000                    NOP     0

     1688     6760    2         IF SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE, END_COLUMN,

   6760 22 000113   200012 470500                    LDP0    L$,,AUTO
        22 000114   000012 720100                    LXL0    10,,PR0
        22 000115   000123 236000 xsym               LDQ     O1COM+83
        22 000116   200006 136100                    SBLQ    END_COLUMN,,AUTO
        22 000117   000000 621006                    EAX1    0,QL
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:388  
        22 000120   200006 235100                    LDA     END_COLUMN,,AUTO
        22 000121   040000 106545                    CMPC    fill='040'O
        22 000122   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1
        22 000123   000006 000001 23                 ADSC9   6                        cn=0,n=1
        22 000124   000132 600000 22                 TZE     s:6768

     1689     6761    2             O1COM.MARGIN_R - END_COLUMN) ~= ' ' THEN
     1690     6762    3           DO;

     1691     6763    3             L$ -> FILL_BUFFER.LINE_TYPE.SPLIT_COLUMN = END_COLUMN;

   6763 22 000125   200006 236100                    LDQ     END_COLUMN,,AUTO
        22 000126   000011 552104                    STBQ    9,'04'O,PR0

     1692     6764    3             L$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;

   6764 22 000127   200012 470500                    LDP0    L$,,AUTO
        22 000130   000007 236000 23                 LDQ     7
        22 000131   000011 356100                    ANSQ    9,,PR0

     1693     6765    3           END;

     1694     6766    2       END;

     1695     6767
     1696     6768    1     CALL Z8EL$ADD_REPL_LEVEL(0, REPLACE$);

   6768 22 000132   200013 630500                    EPPR0   REPLACE$,,AUTO
        22 000133   200017 450500                    STP0    ERROR_IN_REPLACE+3,,AUTO
        22 000134   000013 236000 23                 LDQ     11
        22 000135   200016 756100                    STQ     ERROR_IN_REPLACE+2,,AUTO
        22 000136   200016 630500                    EPPR0   ERROR_IN_REPLACE+2,,AUTO
        22 000137   000011 631400 23                 EPPR1   9
        22 000140   000000 701000 xent               TSX1    Z8EL$ADD_REPL_LEVEL
        22 000141   000000 011000                    NOP     0

     1697     6769
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:389  
     1698     6770    1     IF ERROR_IN_REPLACE

   6770 22 000142   200014 234100                    SZN     ERROR_IN_REPLACE,,AUTO
        22 000143   000153 604000 22                 TMI     s:6776
        22 000144   200013 470500                    LDP0    REPLACE$,,AUTO
        22 000145   000001 471500                    LDP1    1,,PR0
        22 000146   100010 720100                    LXL0    8,,PR1
        22 000147   040000 106540                    CMPC    fill='040'O
        22 000150   100011 000010                    ADSC9   9,,PR1                   cn=0,n=*X0
        22 000151   000000 000003 21                 ADSC9   0                        cn=0,n=3
        22 000152   000157 601000 22                 TNZ     s:6780

     1699     6771    1        OR SUBSTR(REPLACE$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SYMBOL,
     1700     6772    1               0,
     1701     6773    1               REPLACE$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SIZE)
     1702     6774    1             = 'OFF' THEN
     1703     6775    2       DO;

     1704     6776    2         CALL Z8EL$DELETE_REPLACE_LEVEL (0);

   6776 22 000153   000013 630400 23                 EPPR0   11
        22 000154   000000 631400 23                 EPPR1   0
        22 000155   000000 701000 xent               TSX1    Z8EL$DELETE_REPLACE_LEVEL
        22 000156   000000 011000                    NOP     0

     1705     6777    2       END;

     1706     6778
     1707     6779
     1708     6780    1   END Z8EL$PROCESS_REPLACE;

   6780 22 000157   000000 702200 xent               TSX2  ! X66_ARET
     1709     6781
     1710     6782        %EOD;

PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:390  
--  Include file information  --

   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$PROCESS_REPLACE.
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:391  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 002 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 003 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 004 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:392  
  ****  Section 005 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 006 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 007 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 008 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 009 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 010 LblCom REPLACE_LIST

PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:393  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 011 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Section 012 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 013 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 014 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 015 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:394  

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 016 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 017 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 018 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 019 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 020 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:395  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/w SBIN              1 COPY_LEVEL                 6-0-0/w SBIN        r     1 END_COLUMN
     7-0-0/w SBIN        r     1 END_LEVEL                  5-0-0/w SBIN        r     1 END_LINE
    14-0-0/b BIT         r     1 ERROR_IN_REPLACE          12-0-0/w PTR         r     1 L$
    13-0-0/w PTR         r     1 REPLACE$                  10-0-0/w SBIN              1 REPLACE_LEVEL
     4-0-0/w SBIN        r     1 START_COLUMN               3-0-0/w SBIN        r     1 START_LINE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/d STRC(11580) r     1 O1COM
     0-0-0/w STRC(144)         1 PAGE_FORMAT                0-0-0/w STRC(153)         1 REP_STK(0:50)
     0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
PL6.E3A0      #007=Z8EL$PROCESS_REPLACE File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:11 Page:396  
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(252)   r     1 REPLACE_ITEM               0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$PROCESS_REPLACE requires 112 words for executable code.
   Procedure Z8EL$PROCESS_REPLACE requires 22 words of local(AUTO) storage.

PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:397  
     1711        1        /*T***********************************************************/
     1712        2        /*T*                                                         */
     1713        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1714        4        /*T*                                                         */
     1715        5        /*T***********************************************************/
     1716        6
     1717        7        Z8EL$UNMARK_REPLACE_TOKEN : PROC(REPLACED_TOKEN$);
     1718        8
     1719        9    1   DCL REPLACED_TOKEN$ PTR;
     1720       10
     1721       11        /* REPLACED_TOKEN$ points to the first LEX_SYMBOL on the
     1722       12           REPLACE_ITEM.FROM_LIST$ */
     1723       13        /* The REPLACE_ITEM referring to the REPLACED_TOKEN should
     1724       14           have been removed from the REPLACE_LIST linked list */
     1725       15
     1726       16    1   DCL TEMPSYM$ PTR;
     1727       17
     1728       18        %EQU PHASE = 1;
     1729       19        %INCLUDE Z8A_DEFC;
     1730       87        %INCLUDE Z8A_SUPP_MAC;
     1731     2487        %INCLUDE Z8A_DNT;
     1732     2708        %INCLUDE Z8E_HEAP;
     1733     2764        %INCLUDE Z8E_REPLACE;
     1734     3067        %INCLUDE Z8E_STACKS;
     1735     5333
     1736     5334    1   DCL Z8AH$SEARCH_ ENTRY;
     1737     5335
     1738     5336
     1739     5337    1   IF REPLACED_TOKEN$ ~= ADDR(NIL) THEN
     1740     5338    2     DO;
     1741     5339
     1742     5340             /* If the token is on some other list, leave it marked*/
     1743     5341    2       TEMPSYM$ = REPLACE_LIST.LINK$;
     1744     5342
     1745     5343    3       DO WHILE TEMPSYM$ ~= ADDR(NIL)
     1746     5344    3           AND  TEMPSYM$ -> REPLACE_ITEM.FROM_LIST$ ->BASED_LEX_SYMBOL.SYMBOL
     1747     5345    3                      ~= REPLACED_TOKEN$ -> BASED_LEX_SYMBOL.SYMBOL;
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:398  
     1748     5346    3         TEMPSYM$ = TEMPSYM$ -> REPLACE_ITEM.LINK$;
     1749     5347    3       END;
     1750     5348
     1751     5349
     1752     5350    2       IF TEMPSYM$ = ADDR(NIL) THEN
     1753     5351    3         DO;  /* Token needs to be unmarked */
     1754     5352                /* save LEX_SYMBOL temporarily */
     1755     5353                %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)", TO$=TEMPSYM$);
     1756     5368
     1757     5369                %COPY_BASED_LEX_SYMBOL (FROM$=REPLACED_TOKEN$, TO$="ADDR(LEX_SYMBOL)");
     1758     5375    3           CALL Z8AH$SEARCH_;
     1759     5376    3           DNT$ -> DNT.B.REPLACE_TOKEN = FALSE;
     1760     5377
     1761     5378                /* restore LEX_SYMBOL */
     1762     5379                %COPY_BASED_LEX_SYMBOL(FROM$=TEMPSYM$, TO$="ADDR(LEX_SYMBOL)");
     1763     5385    3           CALL Z8ED$DISPOSE_HEAP(TEMPSYM$,
     1764     5386                                          %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=TEMPSYM$);
     1765     5389    3                                    );
     1766     5390    3         END;
     1767     5391    2     END;
     1768     5392
     1769     5393    1   END Z8EL$UNMARK_REPLACE_TOKEN;
     1770     5394
     1771     5395
     1772     5396        %EOD;

PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:399  
--  Include file information  --

   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$UNMARK_REPLACE_TOKEN.

   Procedure Z8EL$UNMARK_REPLACE_TOKEN requires 90 words for executable code.
   Procedure Z8EL$UNMARK_REPLACE_TOKEN requires 10 words of local(AUTO) storage.

PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:400  

 Object Unit name= Z8EL$UNMARK_REPLACE_TOKEN                  File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:12:31.24 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  DNT$
    2  LblCom even  none     5      5  DNT_
    3  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    4  LblCom even  none     1      1  DNT_OF_1$
    5  LblCom even  none     1      1  HEAP$
    6  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    7  LblCom even  none     1      1  REPLACE_ACTIVE
    8  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    9  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   10  LblCom even  none     4      4  REPLACE_LIST
   11  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   12  LblCom even  none    90    132  LEX_SYMBOL
   13  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   14  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   15  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   16   Proc  even  none    90    132  Z8EL$UNMARK_REPLACE_TOKEN
   17  RoData even  none     4      4  Z8EL$UNMARK_REPLACE_TOKEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    16      0   yes            yes      Std        1  Z8EL$UNMARK_REPLACE_TOKEN
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:401  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       0 Z8AH$SEARCH_
         yes           Std       2 Z8ED$DISPOSE_HEAP
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:402  


     1711        1        /*T***********************************************************/
     1712        2        /*T*                                                         */
     1713        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1714        4        /*T*                                                         */
     1715        5        /*T***********************************************************/
     1716        6
     1717        7        Z8EL$UNMARK_REPLACE_TOKEN : PROC(REPLACED_TOKEN$);

      7 16 000000   000000 700200 xent  Z8EL$UNMARK* TSX0  ! X66_AUTO_1
        16 000001   000012 000001                    ZERO    10,1

     1718        8
     1719        9    1   DCL REPLACED_TOKEN$ PTR;
     1720       10
     1721       11        /* REPLACED_TOKEN$ points to the first LEX_SYMBOL on the
     1722       12           REPLACE_ITEM.FROM_LIST$ */
     1723       13        /* The REPLACE_ITEM referring to the REPLACED_TOKEN should
     1724       14           have been removed from the REPLACE_LIST linked list */
     1725       15
     1726       16    1   DCL TEMPSYM$ PTR;
     1727       17
     1728       18        %EQU PHASE = 1;
     1729       19        %INCLUDE Z8A_DEFC;
     1730       87        %INCLUDE Z8A_SUPP_MAC;
     1731     2487        %INCLUDE Z8A_DNT;
     1732     2708        %INCLUDE Z8E_HEAP;
     1733     2764        %INCLUDE Z8E_REPLACE;
     1734     3067        %INCLUDE Z8E_STACKS;
     1735     5333
     1736     5334    1   DCL Z8AH$SEARCH_ ENTRY;
     1737     5335
     1738     5336
     1739     5337    1   IF REPLACED_TOKEN$ ~= ADDR(NIL) THEN

   5337 16 000002   200003 470500                    LDP0    @REPLACED_TOKEN$,,AUTO
        16 000003   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:403  
        16 000004   000000 116000 17                 CMPQ    0
        16 000005   000131 600000 16                 TZE     s:5393

     1740     5338    2     DO;

     1741     5339
     1742     5340             /* If the token is on some other list, leave it marked*/
     1743     5341    2       TEMPSYM$ = REPLACE_LIST.LINK$;

   5341 16 000006   000000 236000 10                 LDQ     REPLACE_LIST
        16 000007   200004 756100                    STQ     TEMPSYM$,,AUTO

     1744     5342
     1745     5343    3       DO WHILE TEMPSYM$ ~= ADDR(NIL)

   5343 16 000010   000014 710000 16                 TRA     s:5347

     1746     5344    3           AND  TEMPSYM$ -> REPLACE_ITEM.FROM_LIST$ ->BASED_LEX_SYMBOL.SYMBOL
     1747     5345    3                      ~= REPLACED_TOKEN$ -> BASED_LEX_SYMBOL.SYMBOL;
     1748     5346    3         TEMPSYM$ = TEMPSYM$ -> REPLACE_ITEM.LINK$;

   5346 16 000011   200004 470500                    LDP0    TEMPSYM$,,AUTO
        16 000012   000000 236100                    LDQ     0,,PR0
        16 000013   200004 756100                    STQ     TEMPSYM$,,AUTO

     1749     5347    3       END;

   5347 16 000014   000000 116000 17                 CMPQ    0
        16 000015   000030 600000 16                 TZE     s:5350
        16 000016   200004 470500                    LDP0    TEMPSYM$,,AUTO
        16 000017   000001 471500                    LDP1    1,,PR0
        16 000020   100010 720100                    LXL0    8,,PR1
        16 000021   200003 473500                    LDP3    @REPLACED_TOKEN$,,AUTO
        16 000022   300000 474500                    LDP4    0,,PR3
        16 000023   400010 721100                    LXL1    8,,PR4
        16 000024   040140 106540                    CMPC    fill='040'O
        16 000025   100011 000010                    ADSC9   9,,PR1                   cn=0,n=*X0
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:404  
        16 000026   400011 000011                    ADSC9   9,,PR4                   cn=0,n=*X1
        16 000027   000011 601000 16                 TNZ     s:5346

     1750     5348
     1751     5349
     1752     5350    2       IF TEMPSYM$ = ADDR(NIL) THEN

   5350 16 000030   000000 116000 17                 CMPQ    0
        16 000031   000131 601000 16                 TNZ     s:5393

     1753     5351    3         DO;  /* Token needs to be unmarked */

     1754     5352                /* save LEX_SYMBOL temporarily */
     1755     5353                %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)", TO$=TEMPSYM$);

   5355 16 000032   000010 236000 12                 LDQ     LEX_SYMBOL+8
        16 000033   000047 036007                    ADLQ    39,DL
        16 000034   000004 506007                    DIV     4,DL
        16 000035   200006 756100                    STQ     TEMPSYM$+2,,AUTO
        16 000036   200006 630500                    EPPR0   TEMPSYM$+2,,AUTO
        16 000037   200011 450500                    STP0    TEMPSYM$+5,,AUTO
        16 000040   200004 631500                    EPPR1   TEMPSYM$,,AUTO
        16 000041   200010 451500                    STP1    TEMPSYM$+4,,AUTO
        16 000042   200010 630500                    EPPR0   TEMPSYM$+4,,AUTO
        16 000043   000001 631400 17                 EPPR1   1
        16 000044   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        16 000045   000000 011000                    NOP     0

   5362 16 000046   200004 470500                    LDP0    TEMPSYM$,,AUTO
        16 000047   000010 235000 12                 LDA     LEX_SYMBOL+8
        16 000050   000010 755100                    STA     8,,PR0

   5363 16 000051   000010 720100                    LXL0    8,,PR0
        16 000052   000044 621010                    EAX1    36,X0
        16 000053   000010 722000 12                 LXL2    LEX_SYMBOL+8
        16 000054   000044 623012                    EAX3    36,X2
        16 000055   000140 100440                    MLR     fill='000'O
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:405  
        16 000056   000000 000013 12                 ADSC9   LEX_SYMBOL               cn=0,n=*X3
        16 000057   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     1756     5368
     1757     5369                %COPY_BASED_LEX_SYMBOL (FROM$=REPLACED_TOKEN$, TO$="ADDR(LEX_SYMBOL)");

   5371 16 000060   200003 470500                    LDP0    @REPLACED_TOKEN$,,AUTO
        16 000061   000000 471500                    LDP1    0,,PR0
        16 000062   100010 235100                    LDA     8,,PR1
        16 000063   000010 755000 12                 STA     LEX_SYMBOL+8

   5372 16 000064   000000 471500                    LDP1    0,,PR0
        16 000065   100010 720100                    LXL0    8,,PR1
        16 000066   000044 621010                    EAX1    36,X0
        16 000067   000044 622005                    EAX2    36,AL
        16 000070   000040 100540                    MLR     fill='000'O
        16 000071   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        16 000072   000000 000012 12                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

     1758     5375    3           CALL Z8AH$SEARCH_;

   5375 16 000073   000002 631400 17                 EPPR1   2
        16 000074   000000 701000 xent               TSX1    Z8AH$SEARCH_
        16 000075   000000 011000                    NOP     0

     1759     5376    3           DNT$ -> DNT.B.REPLACE_TOKEN = FALSE;

   5376 16 000076   000000 470400 1                  LDP0    DNT$
        16 000077   000003 236000 17                 LDQ     3
        16 000100   000003 356100                    ANSQ    3,,PR0

     1760     5377
     1761     5378                /* restore LEX_SYMBOL */
     1762     5379                %COPY_BASED_LEX_SYMBOL(FROM$=TEMPSYM$, TO$="ADDR(LEX_SYMBOL)");

   5381 16 000101   200004 471500                    LDP1    TEMPSYM$,,AUTO
        16 000102   100010 235100                    LDA     8,,PR1
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:406  
        16 000103   000010 755000 12                 STA     LEX_SYMBOL+8

   5382 16 000104   100010 720100                    LXL0    8,,PR1
        16 000105   000044 621010                    EAX1    36,X0
        16 000106   000044 622005                    EAX2    36,AL
        16 000107   000040 100540                    MLR     fill='000'O
        16 000110   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        16 000111   000000 000012 12                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

     1763     5385    3           CALL Z8ED$DISPOSE_HEAP(TEMPSYM$,

   5385 16 000112   100010 720100                    LXL0    8,,PR1
        16 000113   000044 621010                    EAX1    36,X0
        16 000114   000000 636011                    EAQ     0,X1
        16 000115   000022 732000                    QRS     18
        16 000116   000003 036007                    ADLQ    3,DL
        16 000117   000004 506007                    DIV     4,DL
        16 000120   200006 756100                    STQ     TEMPSYM$+2,,AUTO
        16 000121   200006 633500                    EPPR3   TEMPSYM$+2,,AUTO
        16 000122   200011 453500                    STP3    TEMPSYM$+5,,AUTO
        16 000123   200004 634500                    EPPR4   TEMPSYM$,,AUTO
        16 000124   200010 454500                    STP4    TEMPSYM$+4,,AUTO
        16 000125   200010 630500                    EPPR0   TEMPSYM$+4,,AUTO
        16 000126   000001 631400 17                 EPPR1   1
        16 000127   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        16 000130   000000 011000                    NOP     0

     1764     5386                                          %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=TEMPSYM$);
     1765     5389    3                                    );
     1766     5390    3         END;

     1767     5391    2     END;

     1768     5392
     1769     5393    1   END Z8EL$UNMARK_REPLACE_TOKEN;

   5393 16 000131   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:407  
     1770     5394
     1771     5395
     1772     5396        %EOD;

PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:408  
--  Include file information  --

   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$UNMARK_REPLACE_TOKEN.
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:409  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 002 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 003 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 004 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:410  
  ****  Section 005 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 006 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 007 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 008 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 009 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 010 LblCom REPLACE_LIST

PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:411  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 REPLACE_LIST

  ****  Section 011 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Section 012 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 013 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 014 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 015 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:412  

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @REPLACED_TOKEN$          *0-0-0/w PTR         r     1 REPLACED_TOKEN$
     4-0-0/w PTR         r     1 TEMPSYM$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(288)         1 CALL_STMT
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(252)   r     1 REPLACE_ITEM
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
PL6.E3A0      #008=Z8EL$UNMARK_REPLACE_TOKEN File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:12 Page:413  
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$UNMARK_REPLACE_TOKEN requires 90 words for executable code.
   Procedure Z8EL$UNMARK_REPLACE_TOKEN requires 10 words of local(AUTO) storage.

PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:414  
     1773        1        /*T***********************************************************/
     1774        2        /*T*                                                         */
     1775        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1776        4        /*T*                                                         */
     1777        5        /*T***********************************************************/
     1778        6        Z8EL$MARK_REPL_TOKEN : PROC(REPLACED_TOKEN$);
     1779        7
     1780        8    1   DCL REPLACED_TOKEN$ PTR;
     1781        9
     1782       10        /* REPLACED_TOKEN$ points to the first LEX_SYMBOL on the
     1783       11           REPLACE_ITEM.FROM_LIST$ */
     1784       12
     1785       13
     1786       14    1   DCL TDNT$ PTR;
     1787       15
     1788       16        %EQU PHASE = 1;
     1789       17        %INCLUDE Z8A_DEFC;
     1790       85        %INCLUDE Z8A_SUPP_MAC;
     1791     2485        %INCLUDE Z8A_DNT;
     1792     2706        %INCLUDE Z8E_HEAP;
     1793     2762        %INCLUDE Z8E_REPLACE;
     1794     3065        %INCLUDE Z8E_STACKS;
     1795     5331
     1796     5332        %DEF_BUCKETS;
     1797     5335
     1798     5336    1   DCL Z8AH$SEARCH_ ENTRY;
     1799     5337
     1800     5338
     1801     5339    1   IF REPLACED_TOKEN$ ~= ADDR(NIL) THEN
     1802     5340    2     DO;
     1803     5341            %COPY_BASED_LEX_SYMBOL(FROM$=REPLACED_TOKEN$, TO$="ADDR(LEX_SYMBOL)");
     1804     5347    2       CALL Z8AH$SEARCH_;
     1805     5348
     1806     5349    2       IF NOT DNT$ -> DNT.B.REPLACE_TOKEN THEN
     1807     5350    3         DO;
     1808     5351    3           IF DNT$ -> DNT.B.RW THEN
     1809     5352    4             DO;
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:415  
     1810     5353    4               TDNT$ = DNT$;
     1811     5354                    %RESERVE_DNT(SIZE="TDNT$ -> DNT.TEXT.LENGTH");
     1812     5366    4               DNT$ -> DNT = TDNT$ -> DNT;
     1813     5367    4               DNT$ -> DNT.NEXT = DNT_BUCKETS(DNT_BUCKET_NUMBER);
     1814     5368    4               DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;
     1815     5369    4             END;
     1816     5370
     1817     5371    3           DNT$ -> DNT.B.REPLACE_TOKEN = TRUE;
     1818     5372    3         END;
     1819     5373    2     END;
     1820     5374
     1821     5375    1   END Z8EL$MARK_REPL_TOKEN;
     1822     5376
     1823     5377
     1824     5378        %EOD;

PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:416  
--  Include file information  --

   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$MARK_REPL_TOKEN.

   Procedure Z8EL$MARK_REPL_TOKEN requires 78 words for executable code.
   Procedure Z8EL$MARK_REPL_TOKEN requires 8 words of local(AUTO) storage.

PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:417  

 Object Unit name= Z8EL$MARK_REPL_TOKEN                       File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:13:15.92 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  DNT$
    2  LblCom even  none     5      5  DNT_
    3  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    4  LblCom even  none     1      1  DNT_OF_1$
    5  LblCom even  none     1      1  HEAP$
    6  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    7  LblCom even  none     1      1  REPLACE_ACTIVE
    8  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    9  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   10  LblCom even  none     4      4  REPLACE_LIST
   11  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   12  LblCom even  none    90    132  LEX_SYMBOL
   13  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   14  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   15  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   16   Proc  even  none    78    116  Z8EL$MARK_REPL_TOKEN
   17  RoData even  none     4      4  Z8EL$MARK_REPL_TOKEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    16      0   yes            yes      Std        1  Z8EL$MARK_REPL_TOKEN
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:418  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8AH$SEARCH_
         yes           Std       1 Z8AR$RESERVER
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DNT_BUCKETS

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:419  


     1773        1        /*T***********************************************************/
     1774        2        /*T*                                                         */
     1775        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1776        4        /*T*                                                         */
     1777        5        /*T***********************************************************/
     1778        6        Z8EL$MARK_REPL_TOKEN : PROC(REPLACED_TOKEN$);

      6 16 000000   000000 700200 xent  Z8EL$MARK_R* TSX0  ! X66_AUTO_1
        16 000001   000010 000001                    ZERO    8,1

     1779        7
     1780        8    1   DCL REPLACED_TOKEN$ PTR;
     1781        9
     1782       10        /* REPLACED_TOKEN$ points to the first LEX_SYMBOL on the
     1783       11           REPLACE_ITEM.FROM_LIST$ */
     1784       12
     1785       13
     1786       14    1   DCL TDNT$ PTR;
     1787       15
     1788       16        %EQU PHASE = 1;
     1789       17        %INCLUDE Z8A_DEFC;
     1790       85        %INCLUDE Z8A_SUPP_MAC;
     1791     2485        %INCLUDE Z8A_DNT;
     1792     2706        %INCLUDE Z8E_HEAP;
     1793     2762        %INCLUDE Z8E_REPLACE;
     1794     3065        %INCLUDE Z8E_STACKS;
     1795     5331
     1796     5332        %DEF_BUCKETS;
     1797     5335
     1798     5336    1   DCL Z8AH$SEARCH_ ENTRY;
     1799     5337
     1800     5338
     1801     5339    1   IF REPLACED_TOKEN$ ~= ADDR(NIL) THEN

   5339 16 000002   200003 470500                    LDP0    @REPLACED_TOKEN$,,AUTO
        16 000003   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:420  
        16 000004   000000 116000 17                 CMPQ    0
        16 000005   000115 600000 16                 TZE     s:5375

     1802     5340    2     DO;

     1803     5341            %COPY_BASED_LEX_SYMBOL(FROM$=REPLACED_TOKEN$, TO$="ADDR(LEX_SYMBOL)");

   5343 16 000006   000000 471500                    LDP1    0,,PR0
        16 000007   100010 235100                    LDA     8,,PR1
        16 000010   000010 755000 12                 STA     LEX_SYMBOL+8

   5344 16 000011   000000 471500                    LDP1    0,,PR0
        16 000012   100010 720100                    LXL0    8,,PR1
        16 000013   000044 621010                    EAX1    36,X0
        16 000014   000044 622005                    EAX2    36,AL
        16 000015   000040 100540                    MLR     fill='000'O
        16 000016   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        16 000017   000000 000012 12                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

     1804     5347    2       CALL Z8AH$SEARCH_;

   5347 16 000020   000001 631400 17                 EPPR1   1
        16 000021   000000 701000 xent               TSX1    Z8AH$SEARCH_
        16 000022   000000 011000                    NOP     0

     1805     5348
     1806     5349    2       IF NOT DNT$ -> DNT.B.REPLACE_TOKEN THEN

   5349 16 000023   000000 470400 1                  LDP0    DNT$
        16 000024   000003 236100                    LDQ     3,,PR0
        16 000025   010000 316003                    CANQ    4096,DU
        16 000026   000115 601000 16                 TNZ     s:5375

     1807     5350    3         DO;

     1808     5351    3           IF DNT$ -> DNT.B.RW THEN

PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:421  
   5351 16 000027   000003 234100                    SZN     3,,PR0
        16 000030   000112 605000 16                 TPL     s:5371

     1809     5352    4             DO;

     1810     5353    4               TDNT$ = DNT$;

   5353 16 000031   000000 236000 1                  LDQ     DNT$
        16 000032   200004 756100                    STQ     TDNT$,,AUTO

     1811     5354                    %RESERVE_DNT(SIZE="TDNT$ -> DNT.TEXT.LENGTH");

   5356 16 000033   200004 471500                    LDP1    TDNT$,,AUTO
        16 000034   100004 236100                    LDQ     4,,PR1
        16 000035   000022 772000                    QRL     18
        16 000036   000025 036007                    ADLQ    21,DL
        16 000037   000002 772000                    QRL     2
        16 000040   000000 756000 0                  STQ     ITERATION

   5357 16 000041   000002 036000 2                  ADLQ    DNT_+2
        16 000042   000055 604000 16                 TMI     s:5359
        16 000043   000003 116000 2                  CMPQ    DNT_+3
        16 000044   000055 602000 16                 TNC     s:5359

   5358 16 000045   000003 236000 17                 LDQ     3
        16 000046   200006 756100                    STQ     TDNT$+2,,AUTO
        16 000047   200006 633500                    EPPR3   TDNT$+2,,AUTO
        16 000050   200007 453500                    STP3    TDNT$+3,,AUTO
        16 000051   200007 630500                    EPPR0   TDNT$+3,,AUTO
        16 000052   000002 631400 17                 EPPR1   2
        16 000053   000000 701000 xent               TSX1    Z8AR$RESERVER
        16 000054   000000 011000                    NOP     0

   5359 16 000055   000002 236000 2                  LDQ     DNT_+2
        16 000056   000022 736000                    QLS     18
        16 000057   000001 036000 2                  ADLQ    DNT_+1
        16 000060   000000 756000 1                  STQ     DNT$
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:422  

   5360 16 000061   000002 236000 2                  LDQ     DNT_+2
        16 000062   000000 036000 0                  ADLQ    ITERATION
        16 000063   000002 756000 2                  STQ     DNT_+2

   5361 16 000064   001046 220003                    LDX0    550,DU
        16 000065   000000 470400 1                  LDP0    DNT$
        16 000066   000000 740100                    STX0    0,,PR0

   5362 16 000067   000000 721000 0                  LXL1    ITERATION
        16 000070   000000 470400 1                  LDP0    DNT$
        16 000071   000000 441100                    SXL1    0,,PR0

   5363 16 000072   200004 470500                    LDP0    TDNT$,,AUTO
        16 000073   000004 221100                    LDX1    4,,PR0
        16 000074   000000 471400 1                  LDP1    DNT$
        16 000075   100004 741100                    STX1    4,,PR1

     1812     5366    4               DNT$ -> DNT = TDNT$ -> DNT;

   5366 16 000076   000022 622011                    EAX2    18,X1
        16 000077   000004 223100                    LDX3    4,,PR0
        16 000100   000022 624013                    EAX4    18,X3
        16 000101   000140 100540                    MLR     fill='000'O
        16 000102   000000 000014                    ADSC9   0,,PR0                   cn=0,n=*X4
        16 000103   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2

     1813     5367    4               DNT$ -> DNT.NEXT = DNT_BUCKETS(DNT_BUCKET_NUMBER);

   5367 16 000104   000000 721000 3                  LXL1    DNT_BUCKET_NUMBER
        16 000105   000000 236011 xsym               LDQ     DNT_BUCKETS,X1
        16 000106   000000 471400 1                  LDP1    DNT$
        16 000107   100002 756100                    STQ     2,,PR1

     1814     5368    4               DNT_BUCKETS(DNT_BUCKET_NUMBER) = DNT$;

   5368 16 000110   000000 236000 1                  LDQ     DNT$
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:423  
        16 000111   000000 756011 xsym               STQ     DNT_BUCKETS,X1

     1815     5369    4             END;

     1816     5370
     1817     5371    3           DNT$ -> DNT.B.REPLACE_TOKEN = TRUE;

   5371 16 000112   000000 470400 1                  LDP0    DNT$
        16 000113   010000 236003                    LDQ     4096,DU
        16 000114   000003 256100                    ORSQ    3,,PR0

     1818     5372    3         END;

     1819     5373    2     END;

     1820     5374
     1821     5375    1   END Z8EL$MARK_REPL_TOKEN;

   5375 16 000115   000000 702200 xent               TSX2  ! X66_ARET
     1822     5376
     1823     5377
     1824     5378        %EOD;

PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:424  
--  Include file information  --

   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$MARK_REPL_TOKEN.
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:425  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 002 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 DNT_

  ****  Section 003 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 DNT_BUCKET_NUMBER

  ****  Section 004 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:426  
  ****  Section 005 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 006 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 007 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 008 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 009 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 010 LblCom REPLACE_LIST

PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:427  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 011 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Section 012 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 013 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 014 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 015 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:428  

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @REPLACED_TOKEN$          *0-0-0/w PTR         r     1 REPLACED_TOKEN$
     4-0-0/w PTR         r     1 TDNT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT_BUCKETS(0:1128)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(288)         1 CALL_STMT
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
PL6.E3A0      #009=Z8EL$MARK_REPL_TOKEN File=Z8EL.:Z8A6TSI                       SAT 08/09/97 12:13 Page:429  
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(252)         1 REPLACE_ITEM
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$MARK_REPL_TOKEN requires 78 words for executable code.
   Procedure Z8EL$MARK_REPL_TOKEN requires 8 words of local(AUTO) storage.

PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:430  
     1825        1        /*T***********************************************************/
     1826        2        /*T*                                                         */
     1827        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1828        4        /*T*                                                         */
     1829        5        /*T***********************************************************/
     1830        6        Z8EL$POSITION_TO_LEVEL : PROC (REQ_LEVEL, REPLACE$);
     1831        7
     1832        8    1   DCL REQ_LEVEL SBIN WORD;
     1833        9    1   DCL REPLACE$ PTR;
     1834       10
     1835       11        /* Returns pointer to item (or head of list) which points to
     1836       12           the desired level item.  Does not point directly to item
     1837       13           so that list manipulations can be done.
     1838       14        */
     1839       15
     1840       16        %EQU PHASE=1;
     1841       17        %INCLUDE Z8A_DEFC;
     1842       85        %INCLUDE Z8A_SUPP_MAC;
     1843     2485        %INCLUDE Z8E_REPLACE;
     1844     2788
     1845     2789
     1846     2790    1   REPLACE$ = ADDR(REPLACE_LIST);
     1847     2791
     1848     2792    2   DO WHILE REPLACE$ -> REPLACE_ITEM.LINK$ ~= ADDR(NIL)
     1849     2793    2                AND REPLACE$ -> REPLACE_ITEM.LINK$ ->
     1850     2794    2                         REPLACE_ITEM.LEVEL > REQ_LEVEL;
     1851     2795    2     REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;
     1852     2796    2   END;
     1853     2797
     1854     2798    1   END Z8EL$POSITION_TO_LEVEL;
     1855     2799
     1856     2800
     1857     2801        %EOD;

PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:431  
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$POSITION_TO_LEVEL.

   Procedure Z8EL$POSITION_TO_LEVEL requires 20 words for executable code.
   Procedure Z8EL$POSITION_TO_LEVEL requires 6 words of local(AUTO) storage.

PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:432  

 Object Unit name= Z8EL$POSITION_TO_LEVEL                     File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:14:03.48 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    2  LblCom even  none     1      1  REPLACE_ACTIVE
    3  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    4  LblCom even  none     1      1  COPY_DEBUG_LEVEL
    5  LblCom even  none     4      4  REPLACE_LIST
    6  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
    7   Proc  even  none    20     24  Z8EL$POSITION_TO_LEVEL
    8  RoData even  none     2      2  Z8EL$POSITION_TO_LEVEL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Std        2  Z8EL$POSITION_TO_LEVEL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:433  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:434  


     1825        1        /*T***********************************************************/
     1826        2        /*T*                                                         */
     1827        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1828        4        /*T*                                                         */
     1829        5        /*T***********************************************************/
     1830        6        Z8EL$POSITION_TO_LEVEL : PROC (REQ_LEVEL, REPLACE$);

      6  7 000000   000000 700200 xent  Z8EL$POSITI* TSX0  ! X66_AUTO_2
         7 000001   000006 000002                    ZERO    6,2

     1831        7
     1832        8    1   DCL REQ_LEVEL SBIN WORD;
     1833        9    1   DCL REPLACE$ PTR;
     1834       10
     1835       11        /* Returns pointer to item (or head of list) which points to
     1836       12           the desired level item.  Does not point directly to item
     1837       13           so that list manipulations can be done.
     1838       14        */
     1839       15
     1840       16        %EQU PHASE=1;
     1841       17        %INCLUDE Z8A_DEFC;
     1842       85        %INCLUDE Z8A_SUPP_MAC;
     1843     2485        %INCLUDE Z8E_REPLACE;
     1844     2788
     1845     2789
     1846     2790    1   REPLACE$ = ADDR(REPLACE_LIST);

   2790  7 000002   000000 236000 8                  LDQ     0
         7 000003   200004 470500                    LDP0    @REPLACE$,,AUTO
         7 000004   000000 756100                    STQ     0,,PR0

     1847     2791
     1848     2792    2   DO WHILE REPLACE$ -> REPLACE_ITEM.LINK$ ~= ADDR(NIL)

   2792  7 000005   000012 710000 7                  TRA     s:2796

PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:435  
     1849     2793    2                AND REPLACE$ -> REPLACE_ITEM.LINK$ ->
     1850     2794    2                         REPLACE_ITEM.LEVEL > REQ_LEVEL;
     1851     2795    2     REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;

   2795  7 000006   200004 470500                    LDP0    @REPLACE$,,AUTO
         7 000007   000000 471500                    LDP1    0,,PR0
         7 000010   100000 236100                    LDQ     0,,PR1
         7 000011   000000 756100                    STQ     0,,PR0

     1852     2796    2   END;

   2796  7 000012   000000 471500                    LDP1    0,,PR0
         7 000013   100000 236100                    LDQ     0,,PR1
         7 000014   000001 116000 8                  CMPQ    1
         7 000015   000023 600000 7                  TZE     s:2798
         7 000016   100000 473500                    LDP3    0,,PR1
         7 000017   200003 474500                    LDP4    @REQ_LEVEL,,AUTO
         7 000020   300003 236100                    LDQ     3,,PR3
         7 000021   400000 116100                    CMPQ    0,,PR4
         7 000022   000006 605400 7                  TPNZ    s:2795

     1853     2797
     1854     2798    1   END Z8EL$POSITION_TO_LEVEL;

   2798  7 000023   000000 702200 xent               TSX2  ! X66_ARET
     1855     2799
     1856     2800
     1857     2801        %EOD;

PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:436  
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$POSITION_TO_LEVEL.
PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:437  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 002 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 003 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 004 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

PL6.E3A0      #010=Z8EL$POSITION_TO_LEVEL File=Z8EL.:Z8A6TSI                     SAT 08/09/97 12:14 Page:438  
  ****  Section 005 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 REPLACE_LIST

  ****  Section 006 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @REPLACE$                  3-0-0/w PTR         r     1 @REQ_LEVEL
    *0-0-0/w PTR         r     1 REPLACE$                  *0-0-0/w SBIN        r     1 REQ_LEVEL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(252)   r     1 REPLACE_ITEM


   Procedure Z8EL$POSITION_TO_LEVEL requires 20 words for executable code.
   Procedure Z8EL$POSITION_TO_LEVEL requires 6 words of local(AUTO) storage.

PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:439  
     1858        1        /*T***********************************************************/
     1859        2        /*T*                                                         */
     1860        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1861        4        /*T*                                                         */
     1862        5        /*T***********************************************************/
     1863        6        Z8EL$DELETE_REPLACE_LEVEL : PROC (DEL_LEVEL);
     1864        7
     1865        8    1   DCL DEL_LEVEL SBIN WORD;
     1866        9
     1867       10        %EQU PHASE=1;
     1868       11        %INCLUDE Z8A_DEFC;
     1869       79        %INCLUDE Z8A_SUPP_MAC;
     1870     2479        %INCLUDE Z8E_HEAP;
     1871     2535        %INCLUDE Z8E_REPLACE;
     1872     2838        %INCLUDE Z8E_STACKS;
     1873     5104        %INCLUDE Z8E_BUFFERS;
     1874     5294    1   DCL Z8EL$UNMARK_REPLACE_TOKEN ENTRY(1);
     1875     5295    1   DCL Z8EL$POSITION_TO_LEVEL ENTRY(2);
     1876     5296    1   DCL RP$ PTR;
     1877     5297    1   DCL REPLACE$ PTR;
     1878     5298
     1879     5299
     1880     5300    1     PURGE_LIST : PROC(LIST$);
     1881     5301
     1882     5302    2       DCL LIST$ PTR;
     1883     5303    2       DCL L$ PTR;
     1884     5304
     1885     5305    3       DO WHILE LIST$ ~= ADDR(NIL);
     1886     5306    3         L$ = LIST$;
     1887     5307    3         LIST$ = L$ -> BASED_LEX_SYMBOL.NEXT$;
     1888     5308    3         CALL Z8ED$DISPOSE_HEAP(L$,
     1889     5309                                        %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=L$);
     1890     5312    3                                  );
     1891     5313    3       END;
     1892     5314
     1893     5315    2     END PURGE_LIST;
     1894     5316
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:440  
     1895     5317
     1896     5318
     1897     5319    1     PURGE_PSEUDO_LINES : PROC(LIST$);
     1898     5320
     1899     5321    2       DCL LIST$ PTR;
     1900     5322    2       DCL L$ PTR;
     1901     5323
     1902     5324    3       DO WHILE LIST$ ~= ADDR(NIL);
     1903     5325    3         L$ = LIST$;
     1904     5326    3         LIST$ = L$ -> FILL_BUFFER.NEXT$;
     1905     5327    3         CALL Z8ED$DISPOSE_HEAP(L$,
     1906     5328    3                                %MAX_INPUT_BUFFER_LEN);
     1907     5329    3       END;
     1908     5330
     1909     5331    2     END PURGE_PSEUDO_LINES;
     1910     5332
     1911     5333    1   CALL Z8EL$POSITION_TO_LEVEL (DEL_LEVEL, REPLACE$);
     1912     5334
     1913     5335    2   DO WHILE (REPLACE$ -> REPLACE_ITEM.LINK$ ~= ADDR(NIL))
     1914     5336    2                AND (REPLACE$ -> REPLACE_ITEM.LINK$ ->
     1915     5337    2                          REPLACE_ITEM.LEVEL = DEL_LEVEL);
     1916     5338
     1917     5339    2     RP$ = REPLACE$ -> REPLACE_ITEM.LINK$;
     1918     5340    2     REPLACE$ -> REPLACE_ITEM.LINK$ = RP$ -> REPLACE_ITEM.LINK$;
     1919     5341
     1920     5342    2     CALL Z8EL$UNMARK_REPLACE_TOKEN(RP$ -> REPLACE_ITEM.FROM_LIST$);
     1921     5343    2     CALL PURGE_LIST(RP$ -> REPLACE_ITEM.FROM_LIST$);
     1922     5344    2     CALL PURGE_LIST(RP$ -> REPLACE_ITEM.TO_LIST$);
     1923     5345    2     CALL PURGE_PSEUDO_LINES (RP$ -> REPLACE_ITEM.TO_PSEUDO_TEXT_LINES$);
     1924     5346    2     CALL Z8ED$DISPOSE_HEAP(RP$, LENGTHW(REPLACE_ITEM));
     1925     5347
     1926     5348    2   END;  /* DO WHILE */
     1927     5349
     1928     5350    1   IF REPLACE_LIST.LINK$ = ADDR(NIL) THEN
     1929     5351    1     REPLACE_ACTIVE = FALSE;
     1930     5352
     1931     5353    1   END Z8EL$DELETE_REPLACE_LEVEL;
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:441  
     1932     5354        %EOD;

PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:442  
--  Include file information  --

   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$DELETE_REPLACE_LEVEL.

   Procedure Z8EL$DELETE_REPLACE_LEVEL requires 114 words for executable code.
   Procedure Z8EL$DELETE_REPLACE_LEVEL requires 14 words of local(AUTO) storage.

PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:443  

 Object Unit name= Z8EL$DELETE_REPLACE_LEVEL                  File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:14:29.92 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  HEAP$
    2  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    3  LblCom even  none     1      1  REPLACE_ACTIVE
    4  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    5  LblCom even  none     1      1  COPY_DEBUG_LEVEL
    6  LblCom even  none     4      4  REPLACE_LIST
    7  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
    8  LblCom even  none    90    132  LEX_SYMBOL
    9  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   10  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   11  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   12  LblCom even  none     1      1  SCANNER_STATE
   13  LblCom even  none     1      1  CURRENT_BUFFER$
   14  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
   15  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   16  LblCom even  none     1      1  LINE_LIST$
   17  LblCom even  none     7      7  BUFFER
   18  LblCom even  none     1      1  ORIGINAL_ISN
   19  LblCom even  none     1      1  EXPANDED_ISN
   20  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   21   Proc  even  none   114    162  Z8EL$DELETE_REPLACE_LEVEL
   22  RoData even  none     7      7  Z8EL$DELETE_REPLACE_LEVEL
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:444  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    21      0   yes            yes      Std        1  Z8EL$DELETE_REPLACE_LEVEL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8EL$POSITION_TO_LEVEL
         yes           Std       1 Z8EL$UNMARK_REPLACE_TOKEN
         yes           Std       2 Z8ED$DISPOSE_HEAP
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:445  


     1858        1        /*T***********************************************************/
     1859        2        /*T*                                                         */
     1860        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1861        4        /*T*                                                         */
     1862        5        /*T***********************************************************/
     1863        6        Z8EL$DELETE_REPLACE_LEVEL : PROC (DEL_LEVEL);

      6 21 000000   000000 700200 xent  Z8EL$DELETE* TSX0  ! X66_AUTO_1
        21 000001   000016 000001                    ZERO    14,1
        21 000002   000067 710000 21                 TRA     s:5333

     1864        7
     1865        8    1   DCL DEL_LEVEL SBIN WORD;
     1866        9
     1867       10        %EQU PHASE=1;
     1868       11        %INCLUDE Z8A_DEFC;
     1869       79        %INCLUDE Z8A_SUPP_MAC;
     1870     2479        %INCLUDE Z8E_HEAP;
     1871     2535        %INCLUDE Z8E_REPLACE;
     1872     2838        %INCLUDE Z8E_STACKS;
     1873     5104        %INCLUDE Z8E_BUFFERS;
     1874     5294    1   DCL Z8EL$UNMARK_REPLACE_TOKEN ENTRY(1);
     1875     5295    1   DCL Z8EL$POSITION_TO_LEVEL ENTRY(2);
     1876     5296    1   DCL RP$ PTR;
     1877     5297    1   DCL REPLACE$ PTR;
     1878     5298
     1879     5299
     1880     5300    1     PURGE_LIST : PROC(LIST$);

   5300 21 000003   200006 741300       PURGE_LIST   STX1  ! REPLACE$+1,,AUTO

     1881     5301
     1882     5302    2       DCL LIST$ PTR;
     1883     5303    2       DCL L$ PTR;
     1884     5304
     1885     5305    3       DO WHILE LIST$ ~= ADDR(NIL);
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:446  

   5305 21 000004   000033 710000 21                 TRA     s:5313

     1886     5306    3         L$ = LIST$;

   5306 21 000005   200007 470500                    LDP0    @LIST$,,AUTO
        21 000006   000000 236100                    LDQ     0,,PR0
        21 000007   200010 756100                    STQ     L$,,AUTO

     1887     5307    3         LIST$ = L$ -> BASED_LEX_SYMBOL.NEXT$;

   5307 21 000010   200010 471500                    LDP1    L$,,AUTO
        21 000011   100000 236100                    LDQ     0,,PR1
        21 000012   000000 756100                    STQ     0,,PR0

     1888     5308    3         CALL Z8ED$DISPOSE_HEAP(L$,

   5308 21 000013   200010 471500                    LDP1    L$,,AUTO
        21 000014   100010 720100                    LXL0    8,,PR1
        21 000015   000044 621010                    EAX1    36,X0
        21 000016   000000 636011                    EAQ     0,X1
        21 000017   000022 732000                    QRS     18
        21 000020   000003 036007                    ADLQ    3,DL
        21 000021   000004 506007                    DIV     4,DL
        21 000022   200012 756100                    STQ     L$+2,,AUTO
        21 000023   200012 633500                    EPPR3   L$+2,,AUTO
        21 000024   200015 453500                    STP3    L$+5,,AUTO
        21 000025   200010 634500                    EPPR4   L$,,AUTO
        21 000026   200014 454500                    STP4    L$+4,,AUTO
        21 000027   200014 630500                    EPPR0   L$+4,,AUTO
        21 000030   000000 631400 22                 EPPR1   0
        21 000031   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        21 000032   000000 011000                    NOP     0

     1889     5309                                        %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=L$);
     1890     5312    3                                  );
     1891     5313    3       END;
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:447  

   5313 21 000033   200007 470500                    LDP0    @LIST$,,AUTO
        21 000034   000000 236100                    LDQ     0,,PR0
        21 000035   000001 116000 22                 CMPQ    1
        21 000036   000005 601000 21                 TNZ     s:5306

     1892     5314
     1893     5315    2     END PURGE_LIST;

   5315 21 000037   200006 221300                    LDX1  ! REPLACE$+1,,AUTO
        21 000040   000001 702211                    TSX2  ! 1,X1

     1894     5316
     1895     5317
     1896     5318
     1897     5319    1     PURGE_PSEUDO_LINES : PROC(LIST$);

   5319 21 000041   200006 741300       PURGE_PSEUD* STX1  ! REPLACE$+1,,AUTO

     1898     5320
     1899     5321    2       DCL LIST$ PTR;
     1900     5322    2       DCL L$ PTR;
     1901     5323
     1902     5324    3       DO WHILE LIST$ ~= ADDR(NIL);

   5324 21 000042   000061 710000 21                 TRA     s:5329

     1903     5325    3         L$ = LIST$;

   5325 21 000043   200007 470500                    LDP0    @LIST$,,AUTO
        21 000044   000000 236100                    LDQ     0,,PR0
        21 000045   200010 756100                    STQ     L$,,AUTO

     1904     5326    3         LIST$ = L$ -> FILL_BUFFER.NEXT$;

   5326 21 000046   200010 471500                    LDP1    L$,,AUTO
        21 000047   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:448  
        21 000050   000000 756100                    STQ     0,,PR0

     1905     5327    3         CALL Z8ED$DISPOSE_HEAP(L$,

   5327 21 000051   000003 236000 22                 LDQ     3
        21 000052   200013 756100                    STQ     L$+3,,AUTO
        21 000053   200010 631500                    EPPR1   L$,,AUTO
        21 000054   200012 451500                    STP1    L$+2,,AUTO
        21 000055   200012 630500                    EPPR0   L$+2,,AUTO
        21 000056   000000 631400 22                 EPPR1   0
        21 000057   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        21 000060   000000 011000                    NOP     0

     1906     5328    3                                %MAX_INPUT_BUFFER_LEN);
     1907     5329    3       END;

   5329 21 000061   200007 470500                    LDP0    @LIST$,,AUTO
        21 000062   000000 236100                    LDQ     0,,PR0
        21 000063   000001 116000 22                 CMPQ    1
        21 000064   000043 601000 21                 TNZ     s:5325

     1908     5330
     1909     5331    2     END PURGE_PSEUDO_LINES;

   5331 21 000065   200006 221300                    LDX1  ! REPLACE$+1,,AUTO
        21 000066   000001 702211                    TSX2  ! 1,X1

     1910     5332
     1911     5333    1   CALL Z8EL$POSITION_TO_LEVEL (DEL_LEVEL, REPLACE$);

   5333 21 000067   200005 630500                    EPPR0   REPLACE$,,AUTO
        21 000070   200013 450500                    STP0    L$+3,,AUTO
        21 000071   200003 236100                    LDQ     @DEL_LEVEL,,AUTO
        21 000072   200012 756100                    STQ     L$+2,,AUTO
        21 000073   200012 630500                    EPPR0   L$+2,,AUTO
        21 000074   000000 631400 22                 EPPR1   0
        21 000075   000000 701000 xent               TSX1    Z8EL$POSITION_TO_LEVEL
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:449  
        21 000076   000000 011000                    NOP     0

     1912     5334
     1913     5335    2   DO WHILE (REPLACE$ -> REPLACE_ITEM.LINK$ ~= ADDR(NIL))

   5335 21 000077   000144 710000 21                 TRA     s:5348

     1914     5336    2                AND (REPLACE$ -> REPLACE_ITEM.LINK$ ->
     1915     5337    2                          REPLACE_ITEM.LEVEL = DEL_LEVEL);
     1916     5338
     1917     5339    2     RP$ = REPLACE$ -> REPLACE_ITEM.LINK$;

   5339 21 000100   200005 470500                    LDP0    REPLACE$,,AUTO
        21 000101   000000 236100                    LDQ     0,,PR0
        21 000102   200004 756100                    STQ     RP$,,AUTO

     1918     5340    2     REPLACE$ -> REPLACE_ITEM.LINK$ = RP$ -> REPLACE_ITEM.LINK$;

   5340 21 000103   200004 471500                    LDP1    RP$,,AUTO
        21 000104   100000 236100                    LDQ     0,,PR1
        21 000105   000000 756100                    STQ     0,,PR0

     1919     5341
     1920     5342    2     CALL Z8EL$UNMARK_REPLACE_TOKEN(RP$ -> REPLACE_ITEM.FROM_LIST$);

   5342 21 000106   200004 236100                    LDQ     RP$,,AUTO
        21 000107   000001 036003                    ADLQ    1,DU
        21 000110   200012 756100                    STQ     L$+2,,AUTO
        21 000111   200012 630500                    EPPR0   L$+2,,AUTO
        21 000112   000004 631400 22                 EPPR1   4
        21 000113   000000 701000 xent               TSX1    Z8EL$UNMARK_REPLACE_TOKEN
        21 000114   000000 011000                    NOP     0

     1921     5343    2     CALL PURGE_LIST(RP$ -> REPLACE_ITEM.FROM_LIST$);

   5343 21 000115   200004 236100                    LDQ     RP$,,AUTO
        21 000116   000001 036003                    ADLQ    1,DU
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:450  
        21 000117   200007 756100                    STQ     REPLACE$+2,,AUTO
        21 000120   000003 701000 21                 TSX1    PURGE_LIST
        21 000121   000000 011000                    NOP     0

     1922     5344    2     CALL PURGE_LIST(RP$ -> REPLACE_ITEM.TO_LIST$);

   5344 21 000122   200004 236100                    LDQ     RP$,,AUTO
        21 000123   000002 036003                    ADLQ    2,DU
        21 000124   200007 756100                    STQ     REPLACE$+2,,AUTO
        21 000125   000003 701000 21                 TSX1    PURGE_LIST
        21 000126   000000 011000                    NOP     0

     1923     5345    2     CALL PURGE_PSEUDO_LINES (RP$ -> REPLACE_ITEM.TO_PSEUDO_TEXT_LINES$);

   5345 21 000127   200004 236100                    LDQ     RP$,,AUTO
        21 000130   000006 036003                    ADLQ    6,DU
        21 000131   200007 756100                    STQ     REPLACE$+2,,AUTO
        21 000132   000041 701000 21                 TSX1    PURGE_PSEUDO_LINES
        21 000133   000000 011000                    NOP     0

     1924     5346    2     CALL Z8ED$DISPOSE_HEAP(RP$, LENGTHW(REPLACE_ITEM));

   5346 21 000134   000006 236000 22                 LDQ     6
        21 000135   200013 756100                    STQ     L$+3,,AUTO
        21 000136   200004 630500                    EPPR0   RP$,,AUTO
        21 000137   200012 450500                    STP0    L$+2,,AUTO
        21 000140   200012 630500                    EPPR0   L$+2,,AUTO
        21 000141   000000 631400 22                 EPPR1   0
        21 000142   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        21 000143   000000 011000                    NOP     0

     1925     5347
     1926     5348    2   END;  /* DO WHILE */

   5348 21 000144   200005 470500                    LDP0    REPLACE$,,AUTO
        21 000145   000000 236100                    LDQ     0,,PR0
        21 000146   000001 116000 22                 CMPQ    1
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:451  
        21 000147   000155 600000 21                 TZE     s:5350
        21 000150   000000 471500                    LDP1    0,,PR0
        21 000151   200003 473500                    LDP3    @DEL_LEVEL,,AUTO
        21 000152   100003 236100                    LDQ     3,,PR1
        21 000153   300000 116100                    CMPQ    0,,PR3
        21 000154   000100 600000 21                 TZE     s:5339

     1927     5349
     1928     5350    1   IF REPLACE_LIST.LINK$ = ADDR(NIL) THEN

   5350 21 000155   000000 236000 6                  LDQ     REPLACE_LIST
        21 000156   000001 116000 22                 CMPQ    1
        21 000157   000161 601000 21                 TNZ     s:5353

     1929     5351    1     REPLACE_ACTIVE = FALSE;

   5351 21 000160   000000 450000 3                  STZ     REPLACE_ACTIVE

     1930     5352
     1931     5353    1   END Z8EL$DELETE_REPLACE_LEVEL;

   5353 21 000161   000000 702200 xent               TSX2  ! X66_ARET
     1932     5354        %EOD;

PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:452  
--  Include file information  --

   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$DELETE_REPLACE_LEVEL.
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:453  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 002 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 003 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 REPLACE_ACTIVE

  ****  Section 004 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:454  
  ****  Section 005 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 006 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 REPLACE_LIST

  ****  Section 007 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Section 008 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 009 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 010 LblCom TEMP_LEX_SYMBOL

PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:455  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 011 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 012 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 013 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 014 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 015 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:456  

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 016 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 017 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 018 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 019 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 020 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:457  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DEL_LEVEL                 7-0-0/w PTR         r     1 @LIST$
     7-0-0/w PTR         r     1 @LIST$                    *0-0-0/w SBIN        r     1 DEL_LEVEL
    10-0-0/w PTR         r     1 L$                        10-0-0/w PTR         r     1 L$
    *0-0-0/w PTR         r     1 LIST$                     *0-0-0/w PTR         r     1 LIST$
     5-0-0/w PTR         r     1 REPLACE$                   4-0-0/w PTR         r     1 RP$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(252)   r     1 REPLACE_ITEM               0-0-0/w STRC(288)         1 REWRITE_STMT
PL6.E3A0      #011=Z8EL$DELETE_REPLACE_LEVEL File=Z8EL.:Z8A6TSI                  SAT 08/09/97 12:14 Page:458  
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$DELETE_REPLACE_LEVEL requires 114 words for executable code.
   Procedure Z8EL$DELETE_REPLACE_LEVEL requires 14 words of local(AUTO) storage.

PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:459  
     1933        1        /*T***********************************************************/
     1934        2        /*T*                                                         */
     1935        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1936        4        /*T*                                                         */
     1937        5        /*T***********************************************************/
     1938        6        Z8EL$ADD_REPL_LEVEL : PROC (LEVEL, REPLACE$);
     1939        7
     1940        8    1   DCL REPLACE$ PTR;
     1941        9    1   DCL LEVEL SBIN;
     1942       10
     1943       11        %EQU PHASE = 1;
     1944       12        %INCLUDE Z8A_DEFC;
     1945       80        %INCLUDE Z8A_SUPP_MAC;
     1946     2480        %INCLUDE Z8E_REPLACE;
     1947     2783
     1948     2784    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     1949     2785    1   DCL Z8EL$POSITION_TO_LEVEL ENTRY(2);
     1950     2786    1   DCL Z8EL$MARK_REPL_TOKEN ENTRY(1);
     1951     2787
     1952     2788    1   DCL END_LIST$ PTR;
     1953     2789    1   DCL LEVEL$ PTR;
     1954     2790
     1955     2791
     1956     2792    1     CALL Z8EL$DELETE_REPLACE_LEVEL(LEVEL);
     1957     2793    1     CALL Z8EL$POSITION_TO_LEVEL(LEVEL, LEVEL$);
     1958     2794    1     END_LIST$ = LEVEL$ -> REPLACE_ITEM.LINK$;
     1959     2795    1     LEVEL$ -> REPLACE_ITEM.LINK$ = REPLACE$;
     1960     2796
     1961     2797    2     DO WHILE REPLACE$ -> REPLACE_ITEM.LINK$ ~= ADDR(NIL);
     1962     2798
     1963     2799    2       REPLACE$ -> REPLACE_ITEM.LEVEL = LEVEL;
     1964     2800    2       CALL Z8EL$MARK_REPL_TOKEN (REPLACE$->REPLACE_ITEM.FROM_LIST$);
     1965     2801    2       REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;
     1966     2802
     1967     2803    2     END;  /* do while */
     1968     2804
     1969     2805    1     REPLACE$ -> REPLACE_ITEM.LEVEL = LEVEL;
PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:460  
     1970     2806    1     CALL Z8EL$MARK_REPL_TOKEN (REPLACE$->REPLACE_ITEM.FROM_LIST$);
     1971     2807    1     REPLACE$ -> REPLACE_ITEM.LINK$ = END_LIST$;
     1972     2808
     1973     2809    1     IF REPLACE_LIST.LINK$ ~= ADDR(NIL) THEN
     1974     2810    1       REPLACE_ACTIVE = TRUE;
     1975     2811
     1976     2812    1   END Z8EL$ADD_REPL_LEVEL;
     1977     2813
     1978     2814
     1979     2815        %EOD;

PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:461  
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$ADD_REPL_LEVEL.

   Procedure Z8EL$ADD_REPL_LEVEL requires 62 words for executable code.
   Procedure Z8EL$ADD_REPL_LEVEL requires 10 words of local(AUTO) storage.

PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:462  

 Object Unit name= Z8EL$ADD_REPL_LEVEL                        File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:15:20.68 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    2  LblCom even  none     1      1  REPLACE_ACTIVE
    3  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    4  LblCom even  none     1      1  COPY_DEBUG_LEVEL
    5  LblCom even  none     4      4  REPLACE_LIST
    6  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
    7   Proc  even  none    62     76  Z8EL$ADD_REPL_LEVEL
    8  RoData even  none     3      3  Z8EL$ADD_REPL_LEVEL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Std        2  Z8EL$ADD_REPL_LEVEL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8EL$DELETE_REPLACE_LEVEL
         yes           Std       2 Z8EL$POSITION_TO_LEVEL
         yes           Std       1 Z8EL$MARK_REPL_TOKEN
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:463  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:464  


     1933        1        /*T***********************************************************/
     1934        2        /*T*                                                         */
     1935        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1936        4        /*T*                                                         */
     1937        5        /*T***********************************************************/
     1938        6        Z8EL$ADD_REPL_LEVEL : PROC (LEVEL, REPLACE$);

      6  7 000000   000000 700200 xent  Z8EL$ADD_RE* TSX0  ! X66_AUTO_2
         7 000001   000012 000002                    ZERO    10,2

     1939        7
     1940        8    1   DCL REPLACE$ PTR;
     1941        9    1   DCL LEVEL SBIN;
     1942       10
     1943       11        %EQU PHASE = 1;
     1944       12        %INCLUDE Z8A_DEFC;
     1945       80        %INCLUDE Z8A_SUPP_MAC;
     1946     2480        %INCLUDE Z8E_REPLACE;
     1947     2783
     1948     2784    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     1949     2785    1   DCL Z8EL$POSITION_TO_LEVEL ENTRY(2);
     1950     2786    1   DCL Z8EL$MARK_REPL_TOKEN ENTRY(1);
     1951     2787
     1952     2788    1   DCL END_LIST$ PTR;
     1953     2789    1   DCL LEVEL$ PTR;
     1954     2790
     1955     2791
     1956     2792    1     CALL Z8EL$DELETE_REPLACE_LEVEL(LEVEL);

   2792  7 000002   200003 630500                    EPPR0   @LEVEL,,AUTO
         7 000003   000000 631400 8                  EPPR1   0
         7 000004   000000 701000 xent               TSX1    Z8EL$DELETE_REPLACE_LEVEL
         7 000005   000000 011000                    NOP     0

     1957     2793    1     CALL Z8EL$POSITION_TO_LEVEL(LEVEL, LEVEL$);

PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:465  
   2793  7 000006   200006 630500                    EPPR0   LEVEL$,,AUTO
         7 000007   200011 450500                    STP0    LEVEL$+3,,AUTO
         7 000010   200003 236100                    LDQ     @LEVEL,,AUTO
         7 000011   200010 756100                    STQ     LEVEL$+2,,AUTO
         7 000012   200010 630500                    EPPR0   LEVEL$+2,,AUTO
         7 000013   000001 631400 8                  EPPR1   1
         7 000014   000000 701000 xent               TSX1    Z8EL$POSITION_TO_LEVEL
         7 000015   000000 011000                    NOP     0

     1958     2794    1     END_LIST$ = LEVEL$ -> REPLACE_ITEM.LINK$;

   2794  7 000016   200006 470500                    LDP0    LEVEL$,,AUTO
         7 000017   000000 236100                    LDQ     0,,PR0
         7 000020   200005 756100                    STQ     END_LIST$,,AUTO

     1959     2795    1     LEVEL$ -> REPLACE_ITEM.LINK$ = REPLACE$;

   2795  7 000021   200004 471500                    LDP1    @REPLACE$,,AUTO
         7 000022   100000 236100                    LDQ     0,,PR1
         7 000023   000000 756100                    STQ     0,,PR0

     1960     2796
     1961     2797    2     DO WHILE REPLACE$ -> REPLACE_ITEM.LINK$ ~= ADDR(NIL);

   2797  7 000024   000045 710000 7                  TRA     s:2803

     1962     2798
     1963     2799    2       REPLACE$ -> REPLACE_ITEM.LEVEL = LEVEL;

   2799  7 000025   200004 470500                    LDP0    @REPLACE$,,AUTO
         7 000026   000000 471500                    LDP1    0,,PR0
         7 000027   200003 473500                    LDP3    @LEVEL,,AUTO
         7 000030   300000 235100                    LDA     0,,PR3
         7 000031   100003 755100                    STA     3,,PR1

     1964     2800    2       CALL Z8EL$MARK_REPL_TOKEN (REPLACE$->REPLACE_ITEM.FROM_LIST$);

PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:466  
   2800  7 000032   000000 471500                    LDP1    0,,PR0
         7 000033   100001 634500                    EPPR4   1,,PR1
         7 000034   200010 454500                    STP4    LEVEL$+2,,AUTO
         7 000035   200010 630500                    EPPR0   LEVEL$+2,,AUTO
         7 000036   000000 631400 8                  EPPR1   0
         7 000037   000000 701000 xent               TSX1    Z8EL$MARK_REPL_TOKEN
         7 000040   000000 011000                    NOP     0

     1965     2801    2       REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;

   2801  7 000041   200004 470500                    LDP0    @REPLACE$,,AUTO
         7 000042   000000 471500                    LDP1    0,,PR0
         7 000043   100000 236100                    LDQ     0,,PR1
         7 000044   000000 756100                    STQ     0,,PR0

     1966     2802
     1967     2803    2     END;  /* do while */

   2803  7 000045   200004 470500                    LDP0    @REPLACE$,,AUTO
         7 000046   000000 471500                    LDP1    0,,PR0
         7 000047   100000 236100                    LDQ     0,,PR1
         7 000050   000002 116000 8                  CMPQ    2
         7 000051   000025 601000 7                  TNZ     s:2799

     1968     2804
     1969     2805    1     REPLACE$ -> REPLACE_ITEM.LEVEL = LEVEL;

   2805  7 000052   200003 473500                    LDP3    @LEVEL,,AUTO
         7 000053   300000 235100                    LDA     0,,PR3
         7 000054   100003 755100                    STA     3,,PR1

     1970     2806    1     CALL Z8EL$MARK_REPL_TOKEN (REPLACE$->REPLACE_ITEM.FROM_LIST$);

   2806  7 000055   000000 471500                    LDP1    0,,PR0
         7 000056   100001 634500                    EPPR4   1,,PR1
         7 000057   200010 454500                    STP4    LEVEL$+2,,AUTO
         7 000060   200010 630500                    EPPR0   LEVEL$+2,,AUTO
PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:467  
         7 000061   000000 631400 8                  EPPR1   0
         7 000062   000000 701000 xent               TSX1    Z8EL$MARK_REPL_TOKEN
         7 000063   000000 011000                    NOP     0

     1971     2807    1     REPLACE$ -> REPLACE_ITEM.LINK$ = END_LIST$;

   2807  7 000064   200004 470500                    LDP0    @REPLACE$,,AUTO
         7 000065   000000 471500                    LDP1    0,,PR0
         7 000066   200005 236100                    LDQ     END_LIST$,,AUTO
         7 000067   100000 756100                    STQ     0,,PR1

     1972     2808
     1973     2809    1     IF REPLACE_LIST.LINK$ ~= ADDR(NIL) THEN

   2809  7 000070   000000 236000 5                  LDQ     REPLACE_LIST
         7 000071   000002 116000 8                  CMPQ    2
         7 000072   000075 600000 7                  TZE     s:2812

     1974     2810    1       REPLACE_ACTIVE = TRUE;

   2810  7 000073   400000 236003                    LDQ     -131072,DU
         7 000074   000000 756000 2                  STQ     REPLACE_ACTIVE

     1975     2811
     1976     2812    1   END Z8EL$ADD_REPL_LEVEL;

   2812  7 000075   000000 702200 xent               TSX2  ! X66_ARET
     1977     2813
     1978     2814
     1979     2815        %EOD;

PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:468  
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$ADD_REPL_LEVEL.
PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:469  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 002 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 REPLACE_ACTIVE

  ****  Section 003 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 004 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

PL6.E3A0      #012=Z8EL$ADD_REPL_LEVEL File=Z8EL.:Z8A6TSI                        SAT 08/09/97 12:15 Page:470  
  ****  Section 005 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 REPLACE_LIST

  ****  Section 006 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @LEVEL                     4-0-0/w PTR         r     1 @REPLACE$
     5-0-0/w PTR         r     1 END_LIST$                 *0-0-0/w SBIN        r     1 LEVEL
     6-0-0/w PTR         r     1 LEVEL$                    *0-0-0/w PTR         r     1 REPLACE$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(252)   r     1 REPLACE_ITEM


   Procedure Z8EL$ADD_REPL_LEVEL requires 62 words for executable code.
   Procedure Z8EL$ADD_REPL_LEVEL requires 10 words of local(AUTO) storage.

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:471  
     1980        1        /*T***********************************************************/
     1981        2        /*T*                                                         */
     1982        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1983        4        /*T*                                                         */
     1984        5        /*T***********************************************************/
     1985        6        Z8EL$GET_REPLACE_TOKENS : PROC(LIST$,
     1986        7                                       PSEUDO_TEXT_FLAG,
     1987        8                                       PSEUDO_TEXT_START_LINE,
     1988        9                                       PSEUDO_TEXT_START_COLUMN,
     1989       10                                       PSEUDO_TEXT_END_LINE,
     1990       11                                       PSEUDO_TEXT_END_COLUMN) ALTRET;
     1991       12
     1992       13
     1993       14    1   DCL LIST$ PTR;
     1994       15        /* LIST$ is set to point to a list of lex_symbols which represent
     1995       16           either the FROM_LIST or the TO_LIST of the replace */
     1996       17    1   DCL PSEUDO_TEXT_FLAG BIT(1) ALIGNED;
     1997       18    1   DCL PSEUDO_TEXT_START_LINE     SBIN;
     1998       19    1   DCL PSEUDO_TEXT_END_LINE       SBIN;
     1999       20    1   DCL PSEUDO_TEXT_START_COLUMN   SBIN;
     2000       21    1   DCL PSEUDO_TEXT_END_COLUMN     SBIN;
     2001       22
     2002       23        %EQU PHASE=1;
     2003       24        %INCLUDE Z8A_DEFC;
     2004       92        %INCLUDE Z8A_SUPP_MAC;
     2005     2492        %INCLUDE Z8A_COMCOM;
     2006     3142        %INCLUDE Z8E_BUFFERS;
     2007     3332        %INCLUDE Z8E_STACKS;
     2008     5598        %INCLUDE Z8E_HEAP;
     2009     5654        %INCLUDE Z8E_REPLACE;
     2010     5957        %INCLUDE Z8E_WINDOW;
     2011     8027
     2012     8028
     2013     8029    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
     2014     8030    1   DCL Z8EL$PROCESS_COPY        ENTRY;
     2015     8031    1   DCL ADDRLIST$ PTR;
     2016     8032    1   DCL L$ PTR BASED(ADDRLIST$);
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:472  
     2017     8033    1   DCL END_LIST$ PTR;
     2018     8034
     2019     8035
     2020     8036    1   PARSE_QUALIFIERS : PROC (END_LIST$) ALTRET;
     2021     8037
     2022     8038    2     DCL END_LIST$ PTR;
     2023     8039
     2024     8040    3     DO WHILE SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'OF'
     2025     8041    3           OR SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'IN';
     2026     8042
     2027     8043            %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2028     8044                                     TO$   = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$);
     2029     8059
     2030     8060    3       END_LIST$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$;
     2031     8061
     2032     8062            %GET_A_TOKEN_OR_COPY;
     2033     8151
     2034     8152    3       IF LEX_SYMBOL.TYPE ~= %USER_WORD THEN
     2035     8153    3         ALTRETURN;
     2036     8154
     2037     8155            %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2038     8156                                     TO$   = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$);
     2039     8171
     2040     8172    3       END_LIST$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$;
     2041     8173
     2042     8174            %GET_A_TOKEN_OR_COPY;
     2043     8263    3     END;
     2044     8264
     2045     8265    2   END PARSE_QUALIFIERS;
     2046     8266
     2047     8267
     2048     8268    1   PARSE_SUB_REFMOD : PROC (END_LIST$) ALTRET;
     2049     8269
     2050     8270    2     DCL END_LIST$ PTR;
     2051     8271    2     DCL LEXICAL_LEVEL SBIN;
     2052     8272
     2053     8273
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:473  
     2054     8274    2     IF LEX_SYMBOL.TYPE = %LEFT_PAREN THEN
     2055     8275    3       DO;
     2056     8276    3         LEXICAL_LEVEL = 0;
     2057     8277
     2058     8278    4         DO UNTIL LEXICAL_LEVEL = 0;
     2059     8279
     2060     8280    4           IF LEX_SYMBOL.TYPE = %LEFT_PAREN THEN
     2061     8281    4             LEXICAL_LEVEL = LEXICAL_LEVEL + 1;
     2062     8282    4           ELSE
     2063     8283    4             IF LEX_SYMBOL.TYPE = %RIGHT_PAREN THEN
     2064     8284    4               LEXICAL_LEVEL = LEXICAL_LEVEL - 1;
     2065     8285    4             ELSE
     2066     8286    4               IF LEX_SYMBOL.TYPE = %PERIOD
     2067     8287    4                   OR LEX_SYMBOL.TYPE = %END_OF_FILE
     2068     8288    4                   OR LEX_SYMBOL.TYPE = %PSEUDO THEN
     2069     8289    4                 ALTRETURN;
     2070     8290
     2071     8291                %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2072     8292                                         TO$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$);
     2073     8307
     2074     8308    4           END_LIST$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$;
     2075     8309
     2076     8310                %GET_A_TOKEN_OR_COPY;
     2077     8399
     2078     8400    4         END;
     2079     8401    3       END;
     2080     8402
     2081     8403    2   END PARSE_SUB_REFMOD;
     2082     8404
     2083     8405
     2084     8406    1   FAKE_PSEUDO_TEXT : PROC (LIST$, END_LIST$);
     2085     8407
     2086     8408    2     DCL LIST$ PTR;
     2087     8409    2     DCL END_LIST$ PTR;
     2088     8410
     2089     8411    2     PSEUDO_TEXT_FLAG = TRUE;
     2090     8412    2     PSEUDO_TEXT_START_LINE = LIST$ -> BASED_LEX_SYMBOL.LINE;
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:474  
     2091     8413    2     PSEUDO_TEXT_START_COLUMN = LIST$ -> BASED_LEX_SYMBOL.COLUMN - 1;
     2092     8414
     2093     8415    2     PSEUDO_TEXT_END_LINE = END_LIST$ -> BASED_LEX_SYMBOL.END_LINE;
     2094     8416    2     PSEUDO_TEXT_END_COLUMN = END_LIST$ -> BASED_LEX_SYMBOL.END_COLUMN + 1;
     2095     8417    2   END FAKE_PSEUDO_TEXT;
     2096     8418
     2097     8419
     2098     8420
     2099     8421        /* One token is already present */
     2100     8422    1   IF LEX_SYMBOL.TYPE = %PSEUDO THEN
     2101     8423    2     DO;
     2102     8424    2       PSEUDO_TEXT_FLAG = TRUE;
     2103     8425    2       PSEUDO_TEXT_START_LINE = LEX_SYMBOL.END_LINE;
     2104     8426    2       PSEUDO_TEXT_START_COLUMN = LEX_SYMBOL.END_COLUMN;
     2105     8427    2       ADDRLIST$ = ADDR(LIST$);
     2106     8428
     2107     8429            %GET_A_TOKEN_OR_COPY;
     2108     8518
     2109     8519    3       DO WHILE LEX_SYMBOL.TYPE ~= %PSEUDO
     2110     8520    3            AND LEX_SYMBOL.TYPE ~= %END_OF_FILE;
     2111     8521
     2112     8522    3         IF LEX_SYMBOL.B.DELIM_ERROR THEN
     2113     8523    3           ALTRETURN;
     2114     8524
     2115     8525              %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)", TO$=HEAP$);
     2116     8540    3         IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE
     2117     8541    3           THEN HEAP$ -> BASED_LEX_SYMBOL.B.COMMENT_TOKEN = TRUE;
     2118     8542    3         ADDRLIST$ -> L$ = HEAP$;
     2119     8543    3         ADDRLIST$ = ADDR(HEAP$ -> BASED_LEX_SYMBOL.NEXT$);
     2120     8544              %GET_A_TOKEN_OR_COPY;
     2121     8633
     2122     8634    3       END; /* DO WHILE */
     2123     8635    2       PSEUDO_TEXT_END_LINE = LEX_SYMBOL.LINE;
     2124     8636    2       PSEUDO_TEXT_END_COLUMN = LEX_SYMBOL.COLUMN;
     2125     8637
     2126     8638    2       IF LEX_SYMBOL.TYPE = %END_OF_FILE THEN
     2127     8639    2         ALTRETURN;
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:475  
     2128     8640
     2129     8641            %GET_A_TOKEN_OR_COPY;
     2130     8730
     2131     8731    2     END;
     2132     8732    1   ELSE
     2133     8733    2     DO;
     2134     8734    2       PSEUDO_TEXT_FLAG = FALSE;
     2135     8735
     2136     8736            %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2137     8737                                     TO$   = LIST$);
     2138     8752
     2139     8753            %GET_A_TOKEN_OR_COPY;
     2140     8842
     2141     8843    2       IF LIST$ -> BASED_LEX_SYMBOL.TYPE = %USER_WORD THEN
     2142     8844    3         DO;
     2143     8845    3           END_LIST$ = LIST$;
     2144     8846
     2145     8847    3           CALL PARSE_QUALIFIERS (END_LIST$)
     2146     8848    3             WHENALTRETURN
     2147     8849    4               DO;
     2148     8850    4                 ALTRETURN;
     2149     8851    4               END;
     2150     8852
     2151     8853    3           CALL PARSE_SUB_REFMOD (END_LIST$)
     2152     8854    3             WHENALTRETURN
     2153     8855    4               DO;
     2154     8856    4                 ALTRETURN;
     2155     8857    4               END;
     2156     8858
     2157     8859    3           CALL PARSE_SUB_REFMOD (END_LIST$)
     2158     8860    3             WHENALTRETURN
     2159     8861    4               DO;
     2160     8862    4                 ALTRETURN;
     2161     8863    4               END;
     2162     8864
     2163     8865    3           IF LIST$ -> BASED_LEX_SYMBOL.NEXT$ ~= ADDR(NIL) THEN
     2164     8866    3             CALL FAKE_PSEUDO_TEXT (LIST$, END_LIST$);
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:476  
     2165     8867    3         END;
     2166     8868    2     END;
     2167     8869
     2168     8870    1   END Z8EL$GET_REPLACE_TOKENS;
     2169     8871        %EOD;

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:477  
--  Include file information  --

   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$GET_REPLACE_TOKENS.

   Procedure Z8EL$GET_REPLACE_TOKENS requires 1128 words for executable code.
   Procedure Z8EL$GET_REPLACE_TOKENS requires 20 words of local(AUTO) storage.

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:478  

 Object Unit name= Z8EL$GET_REPLACE_TOKENS                    File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:15:40.80 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  SCANNER_STATE
    2  LblCom even  none     1      1  CURRENT_BUFFER$
    3  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    4  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    5  LblCom even  none     1      1  LINE_LIST$
    6  LblCom even  none     7      7  BUFFER
    7  LblCom even  none     1      1  ORIGINAL_ISN
    8  LblCom even  none     1      1  EXPANDED_ISN
    9  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   10  LblCom even  none    90    132  LEX_SYMBOL
   11  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   12  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   13  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   14  LblCom even  none     1      1  HEAP$
   15  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
   16  LblCom even  none     1      1  REPLACE_ACTIVE
   17  LblCom even  none     1      1  IGNORE_COPY_REPLACE
   18  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   19  LblCom even  none     4      4  REPLACE_LIST
   20  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   21  RoData even  UTS      3      3  Z8EL$GET_REPLACE_TOKENS
   22   Proc  even  none  1128   2150  Z8EL$GET_REPLACE_TOKENS
   23  RoData even  none     7      7  Z8EL$GET_REPLACE_TOKENS
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:479  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    22      0   yes    yes     yes      Std        6  Z8EL$GET_REPLACE_TOKENS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8ED$DISPOSE_HEAP
         yes           Std       0 Z8ES$SCANNER
         yes           Std       1 Z8EL$HANDLE_LEVEL_CHANGE
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       0 Z8EL$GET_NEXT_SCANNER_LINE
         yes           Std       0 Z8EL$PROCESS_COPY
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:480  


     1980        1        /*T***********************************************************/
     1981        2        /*T*                                                         */
     1982        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1983        4        /*T*                                                         */
     1984        5        /*T***********************************************************/
     1985        6        Z8EL$GET_REPLACE_TOKENS : PROC(LIST$,

      6 22 000000   000000 700200 xent  Z8EL$GET_RE* TSX0  ! X66_AUTO_N
        22 000001   000024 000006                    ZERO    20,6
        22 000002   001011 710000 22                 TRA     s:8422

     1986        7                                       PSEUDO_TEXT_FLAG,
     1987        8                                       PSEUDO_TEXT_START_LINE,
     1988        9                                       PSEUDO_TEXT_START_COLUMN,
     1989       10                                       PSEUDO_TEXT_END_LINE,
     1990       11                                       PSEUDO_TEXT_END_COLUMN) ALTRET;
     1991       12
     1992       13
     1993       14    1   DCL LIST$ PTR;
     1994       15        /* LIST$ is set to point to a list of lex_symbols which represent
     1995       16           either the FROM_LIST or the TO_LIST of the replace */
     1996       17    1   DCL PSEUDO_TEXT_FLAG BIT(1) ALIGNED;
     1997       18    1   DCL PSEUDO_TEXT_START_LINE     SBIN;
     1998       19    1   DCL PSEUDO_TEXT_END_LINE       SBIN;
     1999       20    1   DCL PSEUDO_TEXT_START_COLUMN   SBIN;
     2000       21    1   DCL PSEUDO_TEXT_END_COLUMN     SBIN;
     2001       22
     2002       23        %EQU PHASE=1;
     2003       24        %INCLUDE Z8A_DEFC;
     2004       92        %INCLUDE Z8A_SUPP_MAC;
     2005     2492        %INCLUDE Z8A_COMCOM;
     2006     3142        %INCLUDE Z8E_BUFFERS;
     2007     3332        %INCLUDE Z8E_STACKS;
     2008     5598        %INCLUDE Z8E_HEAP;
     2009     5654        %INCLUDE Z8E_REPLACE;
     2010     5957        %INCLUDE Z8E_WINDOW;
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:481  
     2011     8027
     2012     8028
     2013     8029    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
     2014     8030    1   DCL Z8EL$PROCESS_COPY        ENTRY;
     2015     8031    1   DCL ADDRLIST$ PTR;
     2016     8032    1   DCL L$ PTR BASED(ADDRLIST$);
     2017     8033    1   DCL END_LIST$ PTR;
     2018     8034
     2019     8035
     2020     8036    1   PARSE_QUALIFIERS : PROC (END_LIST$) ALTRET;

   8036 22 000003   200014 741300       PARSE_QUALI* STX1  ! END_LIST$+2,,AUTO

     2021     8037
     2022     8038    2     DCL END_LIST$ PTR;
     2023     8039
     2024     8040    3     DO WHILE SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'OF'

   8040 22 000004   000464 710000 22                 TRA     s:8263

     2025     8041    3           OR SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) = 'IN';
     2026     8042
     2027     8043            %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2028     8044                                     TO$   = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$);

   8046 22 000005   200015 470500                    LDP0    @END_LIST$,,AUTO
        22 000006   000000 471500                    LDP1    0,,PR0
        22 000007   000010 236000 10                 LDQ     LEX_SYMBOL+8
        22 000010   000047 036007                    ADLQ    39,DL
        22 000011   000004 506007                    DIV     4,DL
        22 000012   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000013   200020 633500                    EPPR3   @END_LIST$+2,,AUTO
        22 000014   200023 453500                    STP3    @END_LIST$+5,,AUTO
        22 000015   200022 451500                    STP1    @END_LIST$+4,,AUTO
        22 000016   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000017   000000 631400 23                 EPPR1   0
        22 000020   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:482  
        22 000021   000000 011000                    NOP     0

   8053 22 000022   200015 470500                    LDP0    @END_LIST$,,AUTO
        22 000023   000000 471500                    LDP1    0,,PR0
        22 000024   100000 473500                    LDP3    0,,PR1
        22 000025   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 000026   300010 755100                    STA     8,,PR3

   8054 22 000027   000000 471500                    LDP1    0,,PR0
        22 000030   100000 473500                    LDP3    0,,PR1
        22 000031   300010 720100                    LXL0    8,,PR3
        22 000032   000044 621010                    EAX1    36,X0
        22 000033   000010 722000 10                 LXL2    LEX_SYMBOL+8
        22 000034   000044 623012                    EAX3    36,X2
        22 000035   000140 100440                    MLR     fill='000'O
        22 000036   000000 000013 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X3
        22 000037   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     2029     8059
     2030     8060    3       END_LIST$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$;

   8060 22 000040   000000 471500                    LDP1    0,,PR0
        22 000041   100000 236100                    LDQ     0,,PR1
        22 000042   000000 756100                    STQ     0,,PR0

     2031     8061
     2032     8062            %GET_A_TOKEN_OR_COPY;

   8071 22 000043   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 000044   000001 116000 23                 CMPQ    1
        22 000045   000103 600000 22                 TZE     s:8094

   8077 22 000046   000000 471400 20                 LDP1    LEX_SYMBOL_QUEUE$
        22 000047   100010 235100                    LDA     8,,PR1
        22 000050   000010 755000 10                 STA     LEX_SYMBOL+8

   8078 22 000051   100010 720100                    LXL0    8,,PR1
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:483  
        22 000052   000044 621010                    EAX1    36,X0
        22 000053   000044 622005                    EAX2    36,AL
        22 000054   000040 100540                    MLR     fill='000'O
        22 000055   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        22 000056   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8081 22 000057   100010 720100                    LXL0    8,,PR1
        22 000060   000044 621010                    EAX1    36,X0
        22 000061   000000 636011                    EAQ     0,X1
        22 000062   000022 732000                    QRS     18
        22 000063   000003 036007                    ADLQ    3,DL
        22 000064   000004 506007                    DIV     4,DL
        22 000065   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000066   200020 633500                    EPPR3   @END_LIST$+2,,AUTO
        22 000067   200023 453500                    STP3    @END_LIST$+5,,AUTO
        22 000070   000002 236000 23                 LDQ     2
        22 000071   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 000072   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000073   000000 631400 23                 EPPR1   0
        22 000074   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 000075   000000 011000                    NOP     0

   8086 22 000076   000000 236000 10                 LDQ     LEX_SYMBOL
        22 000077   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8087 22 000100   000001 236000 23                 LDQ     1
        22 000101   000000 756000 10                 STQ     LEX_SYMBOL

   8088 22 000102   000132 710000 22                 TRA     s:8107

   8094 22 000103   000003 631400 23                 EPPR1   3
        22 000104   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000105   000000 011000                    NOP     0

   8095 22 000106   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000107   000120 601000 22                 TNZ     s:8101

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:484  
   8096 22 000110   000003 631400 23                 EPPR1   3
        22 000111   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 000112   000000 011000                    NOP     0

   8097 22 000113   000003 631400 23                 EPPR1   3
        22 000114   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000115   000000 011000                    NOP     0

   8098 22 000116   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000117   000110 600000 22                 TZE     s:8096

   8101 22 000120   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 000121   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 000122   000132 600000 22                 TZE     s:8107
        22 000123   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 000124   200000 316003                    CANQ    65536,DU
        22 000125   000132 601000 22                 TNZ     s:8107

   8103 22 000126   000005 630400 23                 EPPR0   5
        22 000127   000004 631400 23                 EPPR1   4
        22 000130   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 000131   000000 011000                    NOP     0

   8107 22 000132   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 000133   000004 115007                    CMPA    4,DL
        22 000134   000232 601000 22                 TNZ     s:8152
        22 000135   000011 236000 10                 LDQ     LEX_SYMBOL+9
        22 000136   000000 116000 21                 CMPQ    0
        22 000137   000232 601000 22                 TNZ     s:8152

   8109 22 000140   000003 631400 23                 EPPR1   3
        22 000141   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        22 000142   000000 011000                    NOP     0

   8112 22 000143   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 000144   000001 116000 23                 CMPQ    1
        22 000145   000203 600000 22                 TZE     s:8135
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:485  

   8118 22 000146   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
        22 000147   000010 235100                    LDA     8,,PR0
        22 000150   000010 755000 10                 STA     LEX_SYMBOL+8

   8119 22 000151   000010 720100                    LXL0    8,,PR0
        22 000152   000044 621010                    EAX1    36,X0
        22 000153   000044 622005                    EAX2    36,AL
        22 000154   000040 100540                    MLR     fill='000'O
        22 000155   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 000156   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8122 22 000157   000010 720100                    LXL0    8,,PR0
        22 000160   000044 621010                    EAX1    36,X0
        22 000161   000000 636011                    EAQ     0,X1
        22 000162   000022 732000                    QRS     18
        22 000163   000003 036007                    ADLQ    3,DL
        22 000164   000004 506007                    DIV     4,DL
        22 000165   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000166   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 000167   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 000170   000002 236000 23                 LDQ     2
        22 000171   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 000172   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000173   000000 631400 23                 EPPR1   0
        22 000174   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 000175   000000 011000                    NOP     0

   8127 22 000176   000000 236000 10                 LDQ     LEX_SYMBOL
        22 000177   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8128 22 000200   000001 236000 23                 LDQ     1
        22 000201   000000 756000 10                 STQ     LEX_SYMBOL

   8129 22 000202   000232 710000 22                 TRA     s:8152

   8135 22 000203   000003 631400 23                 EPPR1   3
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:486  
        22 000204   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000205   000000 011000                    NOP     0

   8136 22 000206   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000207   000220 601000 22                 TNZ     s:8142

   8137 22 000210   000003 631400 23                 EPPR1   3
        22 000211   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 000212   000000 011000                    NOP     0

   8138 22 000213   000003 631400 23                 EPPR1   3
        22 000214   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000215   000000 011000                    NOP     0

   8139 22 000216   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000217   000210 600000 22                 TZE     s:8137

   8142 22 000220   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 000221   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 000222   000232 600000 22                 TZE     s:8152
        22 000223   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 000224   200000 316003                    CANQ    65536,DU
        22 000225   000232 601000 22                 TNZ     s:8152

   8144 22 000226   000005 630400 23                 EPPR0   5
        22 000227   000004 631400 23                 EPPR1   4
        22 000230   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 000231   000000 011000                    NOP     0

     2033     8151
     2034     8152    3       IF LEX_SYMBOL.TYPE ~= %USER_WORD THEN

   8152 22 000232   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000233   000005 115007                    CMPA    5,DL
        22 000234   000237 600000 22                 TZE     s:8158

     2035     8153    3         ALTRETURN;
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:487  

   8153 22 000235   200014 221300                    LDX1  ! END_LIST$+2,,AUTO
        22 000236   000000 702211                    TSX2  ! 0,X1

     2036     8154
     2037     8155            %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2038     8156                                     TO$   = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$);

   8158 22 000237   200015 470500                    LDP0    @END_LIST$,,AUTO
        22 000240   000000 471500                    LDP1    0,,PR0
        22 000241   000010 236000 10                 LDQ     LEX_SYMBOL+8
        22 000242   000047 036007                    ADLQ    39,DL
        22 000243   000004 506007                    DIV     4,DL
        22 000244   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000245   200020 633500                    EPPR3   @END_LIST$+2,,AUTO
        22 000246   200023 453500                    STP3    @END_LIST$+5,,AUTO
        22 000247   200022 451500                    STP1    @END_LIST$+4,,AUTO
        22 000250   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000251   000000 631400 23                 EPPR1   0
        22 000252   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 000253   000000 011000                    NOP     0

   8165 22 000254   200015 470500                    LDP0    @END_LIST$,,AUTO
        22 000255   000000 471500                    LDP1    0,,PR0
        22 000256   100000 473500                    LDP3    0,,PR1
        22 000257   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 000260   300010 755100                    STA     8,,PR3

   8166 22 000261   000000 471500                    LDP1    0,,PR0
        22 000262   100000 473500                    LDP3    0,,PR1
        22 000263   300010 720100                    LXL0    8,,PR3
        22 000264   000044 621010                    EAX1    36,X0
        22 000265   000010 722000 10                 LXL2    LEX_SYMBOL+8
        22 000266   000044 623012                    EAX3    36,X2
        22 000267   000140 100440                    MLR     fill='000'O
        22 000270   000000 000013 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X3
        22 000271   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:488  

     2039     8171
     2040     8172    3       END_LIST$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$;

   8172 22 000272   000000 471500                    LDP1    0,,PR0
        22 000273   100000 236100                    LDQ     0,,PR1
        22 000274   000000 756100                    STQ     0,,PR0

     2041     8173
     2042     8174            %GET_A_TOKEN_OR_COPY;

   8183 22 000275   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 000276   000001 116000 23                 CMPQ    1
        22 000277   000335 600000 22                 TZE     s:8206

   8189 22 000300   000000 471400 20                 LDP1    LEX_SYMBOL_QUEUE$
        22 000301   100010 235100                    LDA     8,,PR1
        22 000302   000010 755000 10                 STA     LEX_SYMBOL+8

   8190 22 000303   100010 720100                    LXL0    8,,PR1
        22 000304   000044 621010                    EAX1    36,X0
        22 000305   000044 622005                    EAX2    36,AL
        22 000306   000040 100540                    MLR     fill='000'O
        22 000307   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        22 000310   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8193 22 000311   100010 720100                    LXL0    8,,PR1
        22 000312   000044 621010                    EAX1    36,X0
        22 000313   000000 636011                    EAQ     0,X1
        22 000314   000022 732000                    QRS     18
        22 000315   000003 036007                    ADLQ    3,DL
        22 000316   000004 506007                    DIV     4,DL
        22 000317   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000320   200020 633500                    EPPR3   @END_LIST$+2,,AUTO
        22 000321   200023 453500                    STP3    @END_LIST$+5,,AUTO
        22 000322   000002 236000 23                 LDQ     2
        22 000323   200022 756100                    STQ     @END_LIST$+4,,AUTO
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:489  
        22 000324   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000325   000000 631400 23                 EPPR1   0
        22 000326   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 000327   000000 011000                    NOP     0

   8198 22 000330   000000 236000 10                 LDQ     LEX_SYMBOL
        22 000331   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8199 22 000332   000001 236000 23                 LDQ     1
        22 000333   000000 756000 10                 STQ     LEX_SYMBOL

   8200 22 000334   000364 710000 22                 TRA     s:8219

   8206 22 000335   000003 631400 23                 EPPR1   3
        22 000336   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000337   000000 011000                    NOP     0

   8207 22 000340   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000341   000352 601000 22                 TNZ     s:8213

   8208 22 000342   000003 631400 23                 EPPR1   3
        22 000343   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 000344   000000 011000                    NOP     0

   8209 22 000345   000003 631400 23                 EPPR1   3
        22 000346   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000347   000000 011000                    NOP     0

   8210 22 000350   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000351   000342 600000 22                 TZE     s:8208

   8213 22 000352   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 000353   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 000354   000364 600000 22                 TZE     s:8219
        22 000355   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 000356   200000 316003                    CANQ    65536,DU
        22 000357   000364 601000 22                 TNZ     s:8219
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:490  

   8215 22 000360   000005 630400 23                 EPPR0   5
        22 000361   000004 631400 23                 EPPR1   4
        22 000362   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 000363   000000 011000                    NOP     0

   8219 22 000364   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 000365   000004 115007                    CMPA    4,DL
        22 000366   000464 601000 22                 TNZ     s:8263
        22 000367   000011 236000 10                 LDQ     LEX_SYMBOL+9
        22 000370   000000 116000 21                 CMPQ    0
        22 000371   000464 601000 22                 TNZ     s:8263

   8221 22 000372   000003 631400 23                 EPPR1   3
        22 000373   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        22 000374   000000 011000                    NOP     0

   8224 22 000375   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 000376   000001 116000 23                 CMPQ    1
        22 000377   000435 600000 22                 TZE     s:8247

   8230 22 000400   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
        22 000401   000010 235100                    LDA     8,,PR0
        22 000402   000010 755000 10                 STA     LEX_SYMBOL+8

   8231 22 000403   000010 720100                    LXL0    8,,PR0
        22 000404   000044 621010                    EAX1    36,X0
        22 000405   000044 622005                    EAX2    36,AL
        22 000406   000040 100540                    MLR     fill='000'O
        22 000407   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 000410   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8234 22 000411   000010 720100                    LXL0    8,,PR0
        22 000412   000044 621010                    EAX1    36,X0
        22 000413   000000 636011                    EAQ     0,X1
        22 000414   000022 732000                    QRS     18
        22 000415   000003 036007                    ADLQ    3,DL
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:491  
        22 000416   000004 506007                    DIV     4,DL
        22 000417   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000420   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 000421   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 000422   000002 236000 23                 LDQ     2
        22 000423   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 000424   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000425   000000 631400 23                 EPPR1   0
        22 000426   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 000427   000000 011000                    NOP     0

   8239 22 000430   000000 236000 10                 LDQ     LEX_SYMBOL
        22 000431   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8240 22 000432   000001 236000 23                 LDQ     1
        22 000433   000000 756000 10                 STQ     LEX_SYMBOL

   8241 22 000434   000464 710000 22                 TRA     s:8263

   8247 22 000435   000003 631400 23                 EPPR1   3
        22 000436   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000437   000000 011000                    NOP     0

   8248 22 000440   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000441   000452 601000 22                 TNZ     s:8254

   8249 22 000442   000003 631400 23                 EPPR1   3
        22 000443   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 000444   000000 011000                    NOP     0

   8250 22 000445   000003 631400 23                 EPPR1   3
        22 000446   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000447   000000 011000                    NOP     0

   8251 22 000450   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000451   000442 600000 22                 TZE     s:8249

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:492  
   8254 22 000452   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 000453   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 000454   000464 600000 22                 TZE     s:8263
        22 000455   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 000456   200000 316003                    CANQ    65536,DU
        22 000457   000464 601000 22                 TNZ     s:8263

   8256 22 000460   000005 630400 23                 EPPR0   5
        22 000461   000004 631400 23                 EPPR1   4
        22 000462   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 000463   000000 011000                    NOP     0

     2043     8263    3     END;

   8263 22 000464   000010 720000 10                 LXL0    LEX_SYMBOL+8
        22 000465   040000 106440                    CMPC    fill='040'O
        22 000466   000011 000010 10                 ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        22 000467   000001 000002 21                 ADSC9   1                        cn=0,n=2
        22 000470   000005 600000 22                 TZE     s:8046
        22 000471   040000 106440                    CMPC    fill='040'O
        22 000472   000011 000010 10                 ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        22 000473   000002 000002 21                 ADSC9   2                        cn=0,n=2
        22 000474   000005 600000 22                 TZE     s:8046

     2044     8264
     2045     8265    2   END PARSE_QUALIFIERS;

   8265 22 000475   200014 221300                    LDX1  ! END_LIST$+2,,AUTO
        22 000476   000001 702211                    TSX2  ! 1,X1

     2046     8266
     2047     8267
     2048     8268    1   PARSE_SUB_REFMOD : PROC (END_LIST$) ALTRET;

   8268 22 000477   200014 741300       PARSE_SUB_R* STX1  ! END_LIST$+2,,AUTO

     2049     8269
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:493  
     2050     8270    2     DCL END_LIST$ PTR;
     2051     8271    2     DCL LEXICAL_LEVEL SBIN;
     2052     8272
     2053     8273
     2054     8274    2     IF LEX_SYMBOL.TYPE = %LEFT_PAREN THEN

   8274 22 000500   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000501   000006 115007                    CMPA    6,DL
        22 000502   000755 601000 22                 TNZ     s:8403

     2055     8275    3       DO;

     2056     8276    3         LEXICAL_LEVEL = 0;

   8276 22 000503   200016 450100                    STZ     LEXICAL_LEVEL,,AUTO

     2057     8277
     2058     8278    4         DO UNTIL LEXICAL_LEVEL = 0;

     2059     8279
     2060     8280    4           IF LEX_SYMBOL.TYPE = %LEFT_PAREN THEN

   8280 22 000504   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000505   000006 115007                    CMPA    6,DL
        22 000506   000511 601000 22                 TNZ     s:8283

     2061     8281    4             LEXICAL_LEVEL = LEXICAL_LEVEL + 1;

   8281 22 000507   200016 054100                    AOS     LEXICAL_LEVEL,,AUTO
        22 000510   000526 710000 22                 TRA     s:8294

     2062     8282    4           ELSE
     2063     8283    4             IF LEX_SYMBOL.TYPE = %RIGHT_PAREN THEN

   8283 22 000511   000007 115007                    CMPA    7,DL
        22 000512   000516 601000 22                 TNZ     s:8286

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:494  
     2064     8284    4               LEXICAL_LEVEL = LEXICAL_LEVEL - 1;

   8284 22 000513   000001 336007                    LCQ     1,DL
        22 000514   200016 056100                    ASQ     LEXICAL_LEVEL,,AUTO
        22 000515   000526 710000 22                 TRA     s:8294

     2065     8285    4             ELSE
     2066     8286    4               IF LEX_SYMBOL.TYPE = %PERIOD

   8286 22 000516   000014 115007                    CMPA    12,DL
        22 000517   000524 600000 22                 TZE     s:8289
        22 000520   000001 115007                    CMPA    1,DL
        22 000521   000524 600000 22                 TZE     s:8289
        22 000522   000040 115007                    CMPA    32,DL
        22 000523   000526 601000 22                 TNZ     s:8294

     2067     8287    4                   OR LEX_SYMBOL.TYPE = %END_OF_FILE
     2068     8288    4                   OR LEX_SYMBOL.TYPE = %PSEUDO THEN
     2069     8289    4                 ALTRETURN;

   8289 22 000524   200014 221300                    LDX1  ! END_LIST$+2,,AUTO
        22 000525   000000 702211                    TSX2  ! 0,X1

     2070     8290
     2071     8291                %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2072     8292                                         TO$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$);

   8294 22 000526   200015 470500                    LDP0    @END_LIST$,,AUTO
        22 000527   000000 471500                    LDP1    0,,PR0
        22 000530   000010 236000 10                 LDQ     LEX_SYMBOL+8
        22 000531   000047 036007                    ADLQ    39,DL
        22 000532   000004 506007                    DIV     4,DL
        22 000533   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000534   200020 633500                    EPPR3   @END_LIST$+2,,AUTO
        22 000535   200023 453500                    STP3    @END_LIST$+5,,AUTO
        22 000536   200022 451500                    STP1    @END_LIST$+4,,AUTO
        22 000537   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:495  
        22 000540   000000 631400 23                 EPPR1   0
        22 000541   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 000542   000000 011000                    NOP     0

   8301 22 000543   200015 470500                    LDP0    @END_LIST$,,AUTO
        22 000544   000000 471500                    LDP1    0,,PR0
        22 000545   100000 473500                    LDP3    0,,PR1
        22 000546   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 000547   300010 755100                    STA     8,,PR3

   8302 22 000550   000000 471500                    LDP1    0,,PR0
        22 000551   100000 473500                    LDP3    0,,PR1
        22 000552   300010 720100                    LXL0    8,,PR3
        22 000553   000044 621010                    EAX1    36,X0
        22 000554   000010 722000 10                 LXL2    LEX_SYMBOL+8
        22 000555   000044 623012                    EAX3    36,X2
        22 000556   000140 100440                    MLR     fill='000'O
        22 000557   000000 000013 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X3
        22 000560   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     2073     8307
     2074     8308    4           END_LIST$ = END_LIST$ -> BASED_LEX_SYMBOL.NEXT$;

   8308 22 000561   000000 471500                    LDP1    0,,PR0
        22 000562   100000 236100                    LDQ     0,,PR1
        22 000563   000000 756100                    STQ     0,,PR0

     2075     8309
     2076     8310                %GET_A_TOKEN_OR_COPY;

   8319 22 000564   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 000565   000001 116000 23                 CMPQ    1
        22 000566   000624 600000 22                 TZE     s:8342

   8325 22 000567   000000 471400 20                 LDP1    LEX_SYMBOL_QUEUE$
        22 000570   100010 235100                    LDA     8,,PR1
        22 000571   000010 755000 10                 STA     LEX_SYMBOL+8
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:496  

   8326 22 000572   100010 720100                    LXL0    8,,PR1
        22 000573   000044 621010                    EAX1    36,X0
        22 000574   000044 622005                    EAX2    36,AL
        22 000575   000040 100540                    MLR     fill='000'O
        22 000576   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        22 000577   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8329 22 000600   100010 720100                    LXL0    8,,PR1
        22 000601   000044 621010                    EAX1    36,X0
        22 000602   000000 636011                    EAQ     0,X1
        22 000603   000022 732000                    QRS     18
        22 000604   000003 036007                    ADLQ    3,DL
        22 000605   000004 506007                    DIV     4,DL
        22 000606   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000607   200020 633500                    EPPR3   @END_LIST$+2,,AUTO
        22 000610   200023 453500                    STP3    @END_LIST$+5,,AUTO
        22 000611   000002 236000 23                 LDQ     2
        22 000612   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 000613   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000614   000000 631400 23                 EPPR1   0
        22 000615   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 000616   000000 011000                    NOP     0

   8334 22 000617   000000 236000 10                 LDQ     LEX_SYMBOL
        22 000620   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8335 22 000621   000001 236000 23                 LDQ     1
        22 000622   000000 756000 10                 STQ     LEX_SYMBOL

   8336 22 000623   000653 710000 22                 TRA     s:8355

   8342 22 000624   000003 631400 23                 EPPR1   3
        22 000625   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000626   000000 011000                    NOP     0

   8343 22 000627   000001 235000 10                 LDA     LEX_SYMBOL+1
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:497  
        22 000630   000641 601000 22                 TNZ     s:8349

   8344 22 000631   000003 631400 23                 EPPR1   3
        22 000632   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 000633   000000 011000                    NOP     0

   8345 22 000634   000003 631400 23                 EPPR1   3
        22 000635   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000636   000000 011000                    NOP     0

   8346 22 000637   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000640   000631 600000 22                 TZE     s:8344

   8349 22 000641   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 000642   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 000643   000653 600000 22                 TZE     s:8355
        22 000644   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 000645   200000 316003                    CANQ    65536,DU
        22 000646   000653 601000 22                 TNZ     s:8355

   8351 22 000647   000005 630400 23                 EPPR0   5
        22 000650   000004 631400 23                 EPPR1   4
        22 000651   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 000652   000000 011000                    NOP     0

   8355 22 000653   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 000654   000004 115007                    CMPA    4,DL
        22 000655   000753 601000 22                 TNZ     s:8400
        22 000656   000011 236000 10                 LDQ     LEX_SYMBOL+9
        22 000657   000000 116000 21                 CMPQ    0
        22 000660   000753 601000 22                 TNZ     s:8400

   8357 22 000661   000003 631400 23                 EPPR1   3
        22 000662   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        22 000663   000000 011000                    NOP     0

   8360 22 000664   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:498  
        22 000665   000001 116000 23                 CMPQ    1
        22 000666   000724 600000 22                 TZE     s:8383

   8366 22 000667   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
        22 000670   000010 235100                    LDA     8,,PR0
        22 000671   000010 755000 10                 STA     LEX_SYMBOL+8

   8367 22 000672   000010 720100                    LXL0    8,,PR0
        22 000673   000044 621010                    EAX1    36,X0
        22 000674   000044 622005                    EAX2    36,AL
        22 000675   000040 100540                    MLR     fill='000'O
        22 000676   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 000677   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8370 22 000700   000010 720100                    LXL0    8,,PR0
        22 000701   000044 621010                    EAX1    36,X0
        22 000702   000000 636011                    EAQ     0,X1
        22 000703   000022 732000                    QRS     18
        22 000704   000003 036007                    ADLQ    3,DL
        22 000705   000004 506007                    DIV     4,DL
        22 000706   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 000707   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 000710   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 000711   000002 236000 23                 LDQ     2
        22 000712   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 000713   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 000714   000000 631400 23                 EPPR1   0
        22 000715   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 000716   000000 011000                    NOP     0

   8375 22 000717   000000 236000 10                 LDQ     LEX_SYMBOL
        22 000720   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8376 22 000721   000001 236000 23                 LDQ     1
        22 000722   000000 756000 10                 STQ     LEX_SYMBOL

   8377 22 000723   000753 710000 22                 TRA     s:8400
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:499  

   8383 22 000724   000003 631400 23                 EPPR1   3
        22 000725   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000726   000000 011000                    NOP     0

   8384 22 000727   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000730   000741 601000 22                 TNZ     s:8390

   8385 22 000731   000003 631400 23                 EPPR1   3
        22 000732   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 000733   000000 011000                    NOP     0

   8386 22 000734   000003 631400 23                 EPPR1   3
        22 000735   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 000736   000000 011000                    NOP     0

   8387 22 000737   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 000740   000731 600000 22                 TZE     s:8385

   8390 22 000741   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 000742   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 000743   000753 600000 22                 TZE     s:8400
        22 000744   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 000745   200000 316003                    CANQ    65536,DU
        22 000746   000753 601000 22                 TNZ     s:8400

   8392 22 000747   000005 630400 23                 EPPR0   5
        22 000750   000004 631400 23                 EPPR1   4
        22 000751   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 000752   000000 011000                    NOP     0

     2077     8399
     2078     8400    4         END;

   8400 22 000753   200016 235100                    LDA     LEXICAL_LEVEL,,AUTO
        22 000754   000504 601000 22                 TNZ     s:8280

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:500  
     2079     8401    3       END;

     2080     8402
     2081     8403    2   END PARSE_SUB_REFMOD;

   8403 22 000755   200014 221300                    LDX1  ! END_LIST$+2,,AUTO
        22 000756   000001 702211                    TSX2  ! 1,X1

     2082     8404
     2083     8405
     2084     8406    1   FAKE_PSEUDO_TEXT : PROC (LIST$, END_LIST$);

   8406 22 000757   200014 741300       FAKE_PSEUDO* STX1  ! END_LIST$+2,,AUTO

     2085     8407
     2086     8408    2     DCL LIST$ PTR;
     2087     8409    2     DCL END_LIST$ PTR;
     2088     8410
     2089     8411    2     PSEUDO_TEXT_FLAG = TRUE;

   8411 22 000760   400000 236003                    LDQ     -131072,DU
        22 000761   200004 470500                    LDP0    @PSEUDO_TEXT_FLAG,,AUTO
        22 000762   000000 756100                    STQ     0,,PR0

     2090     8412    2     PSEUDO_TEXT_START_LINE = LIST$ -> BASED_LEX_SYMBOL.LINE;

   8412 22 000763   200015 471500                    LDP1    @LIST$,,AUTO
        22 000764   100000 473500                    LDP3    0,,PR1
        22 000765   200005 474500                    LDP4    @PSEUDO_TEXT_START_LINE,,AUTO
        22 000766   300004 235100                    LDA     4,,PR3
        22 000767   400000 755100                    STA     0,,PR4

     2091     8413    2     PSEUDO_TEXT_START_COLUMN = LIST$ -> BASED_LEX_SYMBOL.COLUMN - 1;

   8413 22 000770   100000 473500                    LDP3    0,,PR1
        22 000771   200006 475500                    LDP5    @PSEUDO_TEXT_START_COLUMN,,AUTO
        22 000772   300005 235100                    LDA     5,,PR3
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:501  
        22 000773   000001 135007                    SBLA    1,DL
        22 000774   500000 755100                    STA     0,,PR5

     2092     8414
     2093     8415    2     PSEUDO_TEXT_END_LINE = END_LIST$ -> BASED_LEX_SYMBOL.END_LINE;

   8415 22 000775   200016 473500                    LDP3    @END_LIST$,,AUTO
        22 000776   300000 476500                    LDP6    0,,PR3
        22 000777   200007 477500                    LDP7    @PSEUDO_TEXT_END_LINE,,AUTO
        22 001000   600006 235100                    LDA     6,,PR6
        22 001001   700000 755100                    STA     0,,PR7

     2094     8416    2     PSEUDO_TEXT_END_COLUMN = END_LIST$ -> BASED_LEX_SYMBOL.END_COLUMN + 1;

   8416 22 001002   300000 476500                    LDP6    0,,PR3
        22 001003   200010 470500                    LDP0    @PSEUDO_TEXT_END_COLUMN,,AUTO
        22 001004   600007 235100                    LDA     7,,PR6
        22 001005   000001 035007                    ADLA    1,DL
        22 001006   000000 755100                    STA     0,,PR0

     2095     8417    2   END FAKE_PSEUDO_TEXT;

   8417 22 001007   200014 221300                    LDX1  ! END_LIST$+2,,AUTO
        22 001010   000001 702211                    TSX2  ! 1,X1

     2096     8418
     2097     8419
     2098     8420
     2099     8421        /* One token is already present */
     2100     8422    1   IF LEX_SYMBOL.TYPE = %PSEUDO THEN

   8422 22 001011   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001012   000040 115007                    CMPA    32,DL
        22 001013   001662 601000 22                 TNZ     s:8734

     2101     8423    2     DO;

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:502  
     2102     8424    2       PSEUDO_TEXT_FLAG = TRUE;

   8424 22 001014   400000 236003                    LDQ     -131072,DU
        22 001015   200004 470500                    LDP0    @PSEUDO_TEXT_FLAG,,AUTO
        22 001016   000000 756100                    STQ     0,,PR0

     2103     8425    2       PSEUDO_TEXT_START_LINE = LEX_SYMBOL.END_LINE;

   8425 22 001017   200005 471500                    LDP1    @PSEUDO_TEXT_START_LINE,,AUTO
        22 001020   000006 235000 10                 LDA     LEX_SYMBOL+6
        22 001021   100000 755100                    STA     0,,PR1

     2104     8426    2       PSEUDO_TEXT_START_COLUMN = LEX_SYMBOL.END_COLUMN;

   8426 22 001022   200006 473500                    LDP3    @PSEUDO_TEXT_START_COLUMN,,AUTO
        22 001023   000007 235000 10                 LDA     LEX_SYMBOL+7
        22 001024   300000 755100                    STA     0,,PR3

     2105     8427    2       ADDRLIST$ = ADDR(LIST$);

   8427 22 001025   200003 236100                    LDQ     @LIST$,,AUTO
        22 001026   200011 756100                    STQ     ADDRLIST$,,AUTO

     2106     8428
     2107     8429            %GET_A_TOKEN_OR_COPY;

   8438 22 001027   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 001030   000001 116000 23                 CMPQ    1
        22 001031   001067 600000 22                 TZE     s:8461

   8444 22 001032   000000 474400 20                 LDP4    LEX_SYMBOL_QUEUE$
        22 001033   400010 235100                    LDA     8,,PR4
        22 001034   000010 755000 10                 STA     LEX_SYMBOL+8

   8445 22 001035   400010 720100                    LXL0    8,,PR4
        22 001036   000044 621010                    EAX1    36,X0
        22 001037   000044 622005                    EAX2    36,AL
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:503  
        22 001040   000040 100540                    MLR     fill='000'O
        22 001041   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
        22 001042   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8448 22 001043   400010 720100                    LXL0    8,,PR4
        22 001044   000044 621010                    EAX1    36,X0
        22 001045   000000 636011                    EAQ     0,X1
        22 001046   000022 732000                    QRS     18
        22 001047   000003 036007                    ADLQ    3,DL
        22 001050   000004 506007                    DIV     4,DL
        22 001051   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001052   200020 635500                    EPPR5   @END_LIST$+2,,AUTO
        22 001053   200023 455500                    STP5    @END_LIST$+5,,AUTO
        22 001054   000002 236000 23                 LDQ     2
        22 001055   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001056   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001057   000000 631400 23                 EPPR1   0
        22 001060   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 001061   000000 011000                    NOP     0

   8453 22 001062   000000 236000 10                 LDQ     LEX_SYMBOL
        22 001063   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8454 22 001064   000001 236000 23                 LDQ     1
        22 001065   000000 756000 10                 STQ     LEX_SYMBOL

   8455 22 001066   001116 710000 22                 TRA     s:8474

   8461 22 001067   000003 631400 23                 EPPR1   3
        22 001070   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001071   000000 011000                    NOP     0

   8462 22 001072   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001073   001104 601000 22                 TNZ     s:8468

   8463 22 001074   000003 631400 23                 EPPR1   3
        22 001075   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:504  
        22 001076   000000 011000                    NOP     0

   8464 22 001077   000003 631400 23                 EPPR1   3
        22 001100   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001101   000000 011000                    NOP     0

   8465 22 001102   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001103   001074 600000 22                 TZE     s:8463

   8468 22 001104   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 001105   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 001106   001116 600000 22                 TZE     s:8474
        22 001107   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 001110   200000 316003                    CANQ    65536,DU
        22 001111   001116 601000 22                 TNZ     s:8474

   8470 22 001112   000005 630400 23                 EPPR0   5
        22 001113   000004 631400 23                 EPPR1   4
        22 001114   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 001115   000000 011000                    NOP     0

   8474 22 001116   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 001117   000004 115007                    CMPA    4,DL
        22 001120   001216 601000 22                 TNZ     s:8519
        22 001121   000011 236000 10                 LDQ     LEX_SYMBOL+9
        22 001122   000000 116000 21                 CMPQ    0
        22 001123   001216 601000 22                 TNZ     s:8519

   8476 22 001124   000003 631400 23                 EPPR1   3
        22 001125   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        22 001126   000000 011000                    NOP     0

   8479 22 001127   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 001130   000001 116000 23                 CMPQ    1
        22 001131   001167 600000 22                 TZE     s:8502

   8485 22 001132   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:505  
        22 001133   000010 235100                    LDA     8,,PR0
        22 001134   000010 755000 10                 STA     LEX_SYMBOL+8

   8486 22 001135   000010 720100                    LXL0    8,,PR0
        22 001136   000044 621010                    EAX1    36,X0
        22 001137   000044 622005                    EAX2    36,AL
        22 001140   000040 100540                    MLR     fill='000'O
        22 001141   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 001142   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8489 22 001143   000010 720100                    LXL0    8,,PR0
        22 001144   000044 621010                    EAX1    36,X0
        22 001145   000000 636011                    EAQ     0,X1
        22 001146   000022 732000                    QRS     18
        22 001147   000003 036007                    ADLQ    3,DL
        22 001150   000004 506007                    DIV     4,DL
        22 001151   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001152   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 001153   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 001154   000002 236000 23                 LDQ     2
        22 001155   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001156   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001157   000000 631400 23                 EPPR1   0
        22 001160   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 001161   000000 011000                    NOP     0

   8494 22 001162   000000 236000 10                 LDQ     LEX_SYMBOL
        22 001163   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8495 22 001164   000001 236000 23                 LDQ     1
        22 001165   000000 756000 10                 STQ     LEX_SYMBOL

   8496 22 001166   001216 710000 22                 TRA     s:8519

   8502 22 001167   000003 631400 23                 EPPR1   3
        22 001170   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001171   000000 011000                    NOP     0
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:506  

   8503 22 001172   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001173   001204 601000 22                 TNZ     s:8509

   8504 22 001174   000003 631400 23                 EPPR1   3
        22 001175   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 001176   000000 011000                    NOP     0

   8505 22 001177   000003 631400 23                 EPPR1   3
        22 001200   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001201   000000 011000                    NOP     0

   8506 22 001202   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001203   001174 600000 22                 TZE     s:8504

   8509 22 001204   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 001205   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 001206   001216 600000 22                 TZE     s:8519
        22 001207   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 001210   200000 316003                    CANQ    65536,DU
        22 001211   001216 601000 22                 TNZ     s:8519

   8511 22 001212   000005 630400 23                 EPPR0   5
        22 001213   000004 631400 23                 EPPR1   4
        22 001214   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 001215   000000 011000                    NOP     0

     2108     8518
     2109     8519    3       DO WHILE LEX_SYMBOL.TYPE ~= %PSEUDO

   8519 22 001216   001453 710000 22                 TRA     s:8634

     2110     8520    3            AND LEX_SYMBOL.TYPE ~= %END_OF_FILE;
     2111     8521
     2112     8522    3         IF LEX_SYMBOL.B.DELIM_ERROR THEN

   8522 22 001217   000002 234000 10                 SZN     LEX_SYMBOL+2
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:507  
        22 001220   001222 605000 22                 TPL     s:8527

     2113     8523    3           ALTRETURN;

   8523 22 001221   000000 702200 xent               TSX2  ! X66_AALT

     2114     8524
     2115     8525              %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)", TO$=HEAP$);

   8527 22 001222   000010 236000 10                 LDQ     LEX_SYMBOL+8
        22 001223   000047 036007                    ADLQ    39,DL
        22 001224   000004 506007                    DIV     4,DL
        22 001225   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001226   200020 630500                    EPPR0   @END_LIST$+2,,AUTO
        22 001227   200023 450500                    STP0    @END_LIST$+5,,AUTO
        22 001230   000006 236000 23                 LDQ     6
        22 001231   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001232   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001233   000000 631400 23                 EPPR1   0
        22 001234   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 001235   000000 011000                    NOP     0

   8534 22 001236   000000 470400 14                 LDP0    HEAP$
        22 001237   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 001240   000010 755100                    STA     8,,PR0

   8535 22 001241   000010 720100                    LXL0    8,,PR0
        22 001242   000044 621010                    EAX1    36,X0
        22 001243   000010 722000 10                 LXL2    LEX_SYMBOL+8
        22 001244   000044 623012                    EAX3    36,X2
        22 001245   000140 100440                    MLR     fill='000'O
        22 001246   000000 000013 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X3
        22 001247   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     2116     8540    3         IF CURRENT_BUFFER$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE

   8540 22 001250   000000 470400 2                  LDP0    CURRENT_BUFFER$
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:508  
        22 001251   000011 236100                    LDQ     9,,PR0
        22 001252   004000 316003                    CANQ    2048,DU
        22 001253   001257 600000 22                 TZE     s:8542

     2117     8541    3           THEN HEAP$ -> BASED_LEX_SYMBOL.B.COMMENT_TOKEN = TRUE;

   8541 22 001254   000000 471400 14                 LDP1    HEAP$
        22 001255   020000 236003                    LDQ     8192,DU
        22 001256   100002 256100                    ORSQ    2,,PR1

     2118     8542    3         ADDRLIST$ -> L$ = HEAP$;

   8542 22 001257   000000 236000 14                 LDQ     HEAP$
        22 001260   200011 471500                    LDP1    ADDRLIST$,,AUTO
        22 001261   100000 756100                    STQ     0,,PR1

     2119     8543    3         ADDRLIST$ = ADDR(HEAP$ -> BASED_LEX_SYMBOL.NEXT$);

   8543 22 001262   000000 236000 14                 LDQ     HEAP$
        22 001263   200011 756100                    STQ     ADDRLIST$,,AUTO

     2120     8544              %GET_A_TOKEN_OR_COPY;

   8553 22 001264   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 001265   000001 116000 23                 CMPQ    1
        22 001266   001324 600000 22                 TZE     s:8576

   8559 22 001267   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
        22 001270   000010 235100                    LDA     8,,PR0
        22 001271   000010 755000 10                 STA     LEX_SYMBOL+8

   8560 22 001272   000010 720100                    LXL0    8,,PR0
        22 001273   000044 621010                    EAX1    36,X0
        22 001274   000044 622005                    EAX2    36,AL
        22 001275   000040 100540                    MLR     fill='000'O
        22 001276   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 001277   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:509  

   8563 22 001300   000010 720100                    LXL0    8,,PR0
        22 001301   000044 621010                    EAX1    36,X0
        22 001302   000000 636011                    EAQ     0,X1
        22 001303   000022 732000                    QRS     18
        22 001304   000003 036007                    ADLQ    3,DL
        22 001305   000004 506007                    DIV     4,DL
        22 001306   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001307   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 001310   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 001311   000002 236000 23                 LDQ     2
        22 001312   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001313   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001314   000000 631400 23                 EPPR1   0
        22 001315   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 001316   000000 011000                    NOP     0

   8568 22 001317   000000 236000 10                 LDQ     LEX_SYMBOL
        22 001320   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8569 22 001321   000001 236000 23                 LDQ     1
        22 001322   000000 756000 10                 STQ     LEX_SYMBOL

   8570 22 001323   001353 710000 22                 TRA     s:8589

   8576 22 001324   000003 631400 23                 EPPR1   3
        22 001325   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001326   000000 011000                    NOP     0

   8577 22 001327   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001330   001341 601000 22                 TNZ     s:8583

   8578 22 001331   000003 631400 23                 EPPR1   3
        22 001332   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 001333   000000 011000                    NOP     0

   8579 22 001334   000003 631400 23                 EPPR1   3
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:510  
        22 001335   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001336   000000 011000                    NOP     0

   8580 22 001337   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001340   001331 600000 22                 TZE     s:8578

   8583 22 001341   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 001342   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 001343   001353 600000 22                 TZE     s:8589
        22 001344   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 001345   200000 316003                    CANQ    65536,DU
        22 001346   001353 601000 22                 TNZ     s:8589

   8585 22 001347   000005 630400 23                 EPPR0   5
        22 001350   000004 631400 23                 EPPR1   4
        22 001351   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 001352   000000 011000                    NOP     0

   8589 22 001353   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 001354   000004 115007                    CMPA    4,DL
        22 001355   001453 601000 22                 TNZ     s:8634
        22 001356   000011 236000 10                 LDQ     LEX_SYMBOL+9
        22 001357   000000 116000 21                 CMPQ    0
        22 001360   001453 601000 22                 TNZ     s:8634

   8591 22 001361   000003 631400 23                 EPPR1   3
        22 001362   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        22 001363   000000 011000                    NOP     0

   8594 22 001364   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 001365   000001 116000 23                 CMPQ    1
        22 001366   001424 600000 22                 TZE     s:8617

   8600 22 001367   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
        22 001370   000010 235100                    LDA     8,,PR0
        22 001371   000010 755000 10                 STA     LEX_SYMBOL+8

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:511  
   8601 22 001372   000010 720100                    LXL0    8,,PR0
        22 001373   000044 621010                    EAX1    36,X0
        22 001374   000044 622005                    EAX2    36,AL
        22 001375   000040 100540                    MLR     fill='000'O
        22 001376   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 001377   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8604 22 001400   000010 720100                    LXL0    8,,PR0
        22 001401   000044 621010                    EAX1    36,X0
        22 001402   000000 636011                    EAQ     0,X1
        22 001403   000022 732000                    QRS     18
        22 001404   000003 036007                    ADLQ    3,DL
        22 001405   000004 506007                    DIV     4,DL
        22 001406   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001407   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 001410   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 001411   000002 236000 23                 LDQ     2
        22 001412   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001413   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001414   000000 631400 23                 EPPR1   0
        22 001415   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 001416   000000 011000                    NOP     0

   8609 22 001417   000000 236000 10                 LDQ     LEX_SYMBOL
        22 001420   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8610 22 001421   000001 236000 23                 LDQ     1
        22 001422   000000 756000 10                 STQ     LEX_SYMBOL

   8611 22 001423   001453 710000 22                 TRA     s:8634

   8617 22 001424   000003 631400 23                 EPPR1   3
        22 001425   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001426   000000 011000                    NOP     0

   8618 22 001427   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001430   001441 601000 22                 TNZ     s:8624
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:512  

   8619 22 001431   000003 631400 23                 EPPR1   3
        22 001432   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 001433   000000 011000                    NOP     0

   8620 22 001434   000003 631400 23                 EPPR1   3
        22 001435   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001436   000000 011000                    NOP     0

   8621 22 001437   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001440   001431 600000 22                 TZE     s:8619

   8624 22 001441   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 001442   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 001443   001453 600000 22                 TZE     s:8634
        22 001444   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 001445   200000 316003                    CANQ    65536,DU
        22 001446   001453 601000 22                 TNZ     s:8634

   8626 22 001447   000005 630400 23                 EPPR0   5
        22 001450   000004 631400 23                 EPPR1   4
        22 001451   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 001452   000000 011000                    NOP     0

     2121     8633
     2122     8634    3       END; /* DO WHILE */

   8634 22 001453   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001454   000040 115007                    CMPA    32,DL
        22 001455   001460 600000 22                 TZE     s:8635
        22 001456   000001 115007                    CMPA    1,DL
        22 001457   001217 601000 22                 TNZ     s:8522

     2123     8635    2       PSEUDO_TEXT_END_LINE = LEX_SYMBOL.LINE;

   8635 22 001460   200007 470500                    LDP0    @PSEUDO_TEXT_END_LINE,,AUTO
        22 001461   000004 236000 10                 LDQ     LEX_SYMBOL+4
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:513  
        22 001462   000000 756100                    STQ     0,,PR0

     2124     8636    2       PSEUDO_TEXT_END_COLUMN = LEX_SYMBOL.COLUMN;

   8636 22 001463   200010 471500                    LDP1    @PSEUDO_TEXT_END_COLUMN,,AUTO
        22 001464   000005 235000 10                 LDA     LEX_SYMBOL+5
        22 001465   100000 755100                    STA     0,,PR1

     2125     8637
     2126     8638    2       IF LEX_SYMBOL.TYPE = %END_OF_FILE THEN

   8638 22 001466   000001 236000 10                 LDQ     LEX_SYMBOL+1
        22 001467   000001 116007                    CMPQ    1,DL
        22 001470   001472 601000 22                 TNZ     s:8650

     2127     8639    2         ALTRETURN;

   8639 22 001471   000000 702200 xent               TSX2  ! X66_AALT

     2128     8640
     2129     8641            %GET_A_TOKEN_OR_COPY;

   8650 22 001472   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 001473   000001 116000 23                 CMPQ    1
        22 001474   001532 600000 22                 TZE     s:8673

   8656 22 001475   000000 473400 20                 LDP3    LEX_SYMBOL_QUEUE$
        22 001476   300010 235100                    LDA     8,,PR3
        22 001477   000010 755000 10                 STA     LEX_SYMBOL+8

   8657 22 001500   300010 720100                    LXL0    8,,PR3
        22 001501   000044 621010                    EAX1    36,X0
        22 001502   000044 622005                    EAX2    36,AL
        22 001503   000040 100540                    MLR     fill='000'O
        22 001504   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
        22 001505   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:514  
   8660 22 001506   300010 720100                    LXL0    8,,PR3
        22 001507   000044 621010                    EAX1    36,X0
        22 001510   000000 636011                    EAQ     0,X1
        22 001511   000022 732000                    QRS     18
        22 001512   000003 036007                    ADLQ    3,DL
        22 001513   000004 506007                    DIV     4,DL
        22 001514   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001515   200020 634500                    EPPR4   @END_LIST$+2,,AUTO
        22 001516   200023 454500                    STP4    @END_LIST$+5,,AUTO
        22 001517   000002 236000 23                 LDQ     2
        22 001520   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001521   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001522   000000 631400 23                 EPPR1   0
        22 001523   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 001524   000000 011000                    NOP     0

   8665 22 001525   000000 236000 10                 LDQ     LEX_SYMBOL
        22 001526   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8666 22 001527   000001 236000 23                 LDQ     1
        22 001530   000000 756000 10                 STQ     LEX_SYMBOL

   8667 22 001531   001561 710000 22                 TRA     s:8686

   8673 22 001532   000003 631400 23                 EPPR1   3
        22 001533   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001534   000000 011000                    NOP     0

   8674 22 001535   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001536   001547 601000 22                 TNZ     s:8680

   8675 22 001537   000003 631400 23                 EPPR1   3
        22 001540   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 001541   000000 011000                    NOP     0

   8676 22 001542   000003 631400 23                 EPPR1   3
        22 001543   000000 701000 xent               TSX1    Z8ES$SCANNER
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:515  
        22 001544   000000 011000                    NOP     0

   8677 22 001545   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001546   001537 600000 22                 TZE     s:8675

   8680 22 001547   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 001550   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 001551   001561 600000 22                 TZE     s:8686
        22 001552   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 001553   200000 316003                    CANQ    65536,DU
        22 001554   001561 601000 22                 TNZ     s:8686

   8682 22 001555   000005 630400 23                 EPPR0   5
        22 001556   000004 631400 23                 EPPR1   4
        22 001557   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 001560   000000 011000                    NOP     0

   8686 22 001561   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 001562   000004 115007                    CMPA    4,DL
        22 001563   002147 601000 22                 TNZ     s:8870
        22 001564   000011 236000 10                 LDQ     LEX_SYMBOL+9
        22 001565   000000 116000 21                 CMPQ    0
        22 001566   002147 601000 22                 TNZ     s:8870

   8688 22 001567   000003 631400 23                 EPPR1   3
        22 001570   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        22 001571   000000 011000                    NOP     0

   8691 22 001572   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 001573   000001 116000 23                 CMPQ    1
        22 001574   001632 600000 22                 TZE     s:8714

   8697 22 001575   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
        22 001576   000010 235100                    LDA     8,,PR0
        22 001577   000010 755000 10                 STA     LEX_SYMBOL+8

   8698 22 001600   000010 720100                    LXL0    8,,PR0
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:516  
        22 001601   000044 621010                    EAX1    36,X0
        22 001602   000044 622005                    EAX2    36,AL
        22 001603   000040 100540                    MLR     fill='000'O
        22 001604   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 001605   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8701 22 001606   000010 720100                    LXL0    8,,PR0
        22 001607   000044 621010                    EAX1    36,X0
        22 001610   000000 636011                    EAQ     0,X1
        22 001611   000022 732000                    QRS     18
        22 001612   000003 036007                    ADLQ    3,DL
        22 001613   000004 506007                    DIV     4,DL
        22 001614   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001615   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 001616   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 001617   000002 236000 23                 LDQ     2
        22 001620   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001621   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001622   000000 631400 23                 EPPR1   0
        22 001623   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 001624   000000 011000                    NOP     0

   8706 22 001625   000000 236000 10                 LDQ     LEX_SYMBOL
        22 001626   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8707 22 001627   000001 236000 23                 LDQ     1
        22 001630   000000 756000 10                 STQ     LEX_SYMBOL

   8708 22 001631   002147 710000 22                 TRA     s:8870

   8714 22 001632   000003 631400 23                 EPPR1   3
        22 001633   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001634   000000 011000                    NOP     0

   8715 22 001635   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001636   001647 601000 22                 TNZ     s:8721

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:517  
   8716 22 001637   000003 631400 23                 EPPR1   3
        22 001640   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 001641   000000 011000                    NOP     0

   8717 22 001642   000003 631400 23                 EPPR1   3
        22 001643   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001644   000000 011000                    NOP     0

   8718 22 001645   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001646   001637 600000 22                 TZE     s:8716

   8721 22 001647   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 001650   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 001651   002147 600000 22                 TZE     s:8870
        22 001652   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 001653   200000 316003                    CANQ    65536,DU
        22 001654   002147 601000 22                 TNZ     s:8870

   8723 22 001655   000005 630400 23                 EPPR0   5
        22 001656   000004 631400 23                 EPPR1   4
        22 001657   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 001660   000000 011000                    NOP     0

     2130     8730
     2131     8731    2     END;

   8731 22 001661   002147 710000 22                 TRA     s:8870

     2132     8732    1   ELSE
     2133     8733    2     DO;

     2134     8734    2       PSEUDO_TEXT_FLAG = FALSE;

   8734 22 001662   200004 470500                    LDP0    @PSEUDO_TEXT_FLAG,,AUTO
        22 001663   000000 450100                    STZ     0,,PR0

     2135     8735
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:518  
     2136     8736            %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2137     8737                                     TO$   = LIST$);

   8739 22 001664   000010 236000 10                 LDQ     LEX_SYMBOL+8
        22 001665   000047 036007                    ADLQ    39,DL
        22 001666   000004 506007                    DIV     4,DL
        22 001667   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001670   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 001671   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 001672   200003 236100                    LDQ     @LIST$,,AUTO
        22 001673   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001674   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001675   000000 631400 23                 EPPR1   0
        22 001676   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        22 001677   000000 011000                    NOP     0

   8746 22 001700   200003 470500                    LDP0    @LIST$,,AUTO
        22 001701   000000 471500                    LDP1    0,,PR0
        22 001702   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 001703   100010 755100                    STA     8,,PR1

   8747 22 001704   000000 471500                    LDP1    0,,PR0
        22 001705   100010 720100                    LXL0    8,,PR1
        22 001706   000044 621010                    EAX1    36,X0
        22 001707   000010 722000 10                 LXL2    LEX_SYMBOL+8
        22 001710   000044 623012                    EAX3    36,X2
        22 001711   000140 100440                    MLR     fill='000'O
        22 001712   000000 000013 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X3
        22 001713   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2138     8752
     2139     8753            %GET_A_TOKEN_OR_COPY;

   8762 22 001714   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 001715   000001 116000 23                 CMPQ    1
        22 001716   001754 600000 22                 TZE     s:8785

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:519  
   8768 22 001717   000000 471400 20                 LDP1    LEX_SYMBOL_QUEUE$
        22 001720   100010 235100                    LDA     8,,PR1
        22 001721   000010 755000 10                 STA     LEX_SYMBOL+8

   8769 22 001722   100010 720100                    LXL0    8,,PR1
        22 001723   000044 621010                    EAX1    36,X0
        22 001724   000044 622005                    EAX2    36,AL
        22 001725   000040 100540                    MLR     fill='000'O
        22 001726   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        22 001727   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8772 22 001730   100010 720100                    LXL0    8,,PR1
        22 001731   000044 621010                    EAX1    36,X0
        22 001732   000000 636011                    EAQ     0,X1
        22 001733   000022 732000                    QRS     18
        22 001734   000003 036007                    ADLQ    3,DL
        22 001735   000004 506007                    DIV     4,DL
        22 001736   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 001737   200020 633500                    EPPR3   @END_LIST$+2,,AUTO
        22 001740   200023 453500                    STP3    @END_LIST$+5,,AUTO
        22 001741   000002 236000 23                 LDQ     2
        22 001742   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 001743   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 001744   000000 631400 23                 EPPR1   0
        22 001745   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 001746   000000 011000                    NOP     0

   8777 22 001747   000000 236000 10                 LDQ     LEX_SYMBOL
        22 001750   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8778 22 001751   000001 236000 23                 LDQ     1
        22 001752   000000 756000 10                 STQ     LEX_SYMBOL

   8779 22 001753   002003 710000 22                 TRA     s:8798

   8785 22 001754   000003 631400 23                 EPPR1   3
        22 001755   000000 701000 xent               TSX1    Z8ES$SCANNER
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:520  
        22 001756   000000 011000                    NOP     0

   8786 22 001757   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001760   001771 601000 22                 TNZ     s:8792

   8787 22 001761   000003 631400 23                 EPPR1   3
        22 001762   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 001763   000000 011000                    NOP     0

   8788 22 001764   000003 631400 23                 EPPR1   3
        22 001765   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 001766   000000 011000                    NOP     0

   8789 22 001767   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 001770   001761 600000 22                 TZE     s:8787

   8792 22 001771   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 001772   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 001773   002003 600000 22                 TZE     s:8798
        22 001774   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 001775   200000 316003                    CANQ    65536,DU
        22 001776   002003 601000 22                 TNZ     s:8798

   8794 22 001777   000005 630400 23                 EPPR0   5
        22 002000   000004 631400 23                 EPPR1   4
        22 002001   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 002002   000000 011000                    NOP     0

   8798 22 002003   000010 235000 10                 LDA     LEX_SYMBOL+8
        22 002004   000004 115007                    CMPA    4,DL
        22 002005   002103 601000 22                 TNZ     s:8843
        22 002006   000011 236000 10                 LDQ     LEX_SYMBOL+9
        22 002007   000000 116000 21                 CMPQ    0
        22 002010   002103 601000 22                 TNZ     s:8843

   8800 22 002011   000003 631400 23                 EPPR1   3
        22 002012   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:521  
        22 002013   000000 011000                    NOP     0

   8803 22 002014   000000 236000 20                 LDQ     LEX_SYMBOL_QUEUE$
        22 002015   000001 116000 23                 CMPQ    1
        22 002016   002054 600000 22                 TZE     s:8826

   8809 22 002017   000000 470400 20                 LDP0    LEX_SYMBOL_QUEUE$
        22 002020   000010 235100                    LDA     8,,PR0
        22 002021   000010 755000 10                 STA     LEX_SYMBOL+8

   8810 22 002022   000010 720100                    LXL0    8,,PR0
        22 002023   000044 621010                    EAX1    36,X0
        22 002024   000044 622005                    EAX2    36,AL
        22 002025   000040 100540                    MLR     fill='000'O
        22 002026   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        22 002027   000000 000012 10                 ADSC9   LEX_SYMBOL               cn=0,n=*X2

   8813 22 002030   000010 720100                    LXL0    8,,PR0
        22 002031   000044 621010                    EAX1    36,X0
        22 002032   000000 636011                    EAQ     0,X1
        22 002033   000022 732000                    QRS     18
        22 002034   000003 036007                    ADLQ    3,DL
        22 002035   000004 506007                    DIV     4,DL
        22 002036   200020 756100                    STQ     @END_LIST$+2,,AUTO
        22 002037   200020 631500                    EPPR1   @END_LIST$+2,,AUTO
        22 002040   200023 451500                    STP1    @END_LIST$+5,,AUTO
        22 002041   000002 236000 23                 LDQ     2
        22 002042   200022 756100                    STQ     @END_LIST$+4,,AUTO
        22 002043   200022 630500                    EPPR0   @END_LIST$+4,,AUTO
        22 002044   000000 631400 23                 EPPR1   0
        22 002045   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        22 002046   000000 011000                    NOP     0

   8818 22 002047   000000 236000 10                 LDQ     LEX_SYMBOL
        22 002050   000000 756000 20                 STQ     LEX_SYMBOL_QUEUE$

   8819 22 002051   000001 236000 23                 LDQ     1
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:522  
        22 002052   000000 756000 10                 STQ     LEX_SYMBOL

   8820 22 002053   002103 710000 22                 TRA     s:8843

   8826 22 002054   000003 631400 23                 EPPR1   3
        22 002055   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 002056   000000 011000                    NOP     0

   8827 22 002057   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 002060   002071 601000 22                 TNZ     s:8833

   8828 22 002061   000003 631400 23                 EPPR1   3
        22 002062   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        22 002063   000000 011000                    NOP     0

   8829 22 002064   000003 631400 23                 EPPR1   3
        22 002065   000000 701000 xent               TSX1    Z8ES$SCANNER
        22 002066   000000 011000                    NOP     0

   8830 22 002067   000001 235000 10                 LDA     LEX_SYMBOL+1
        22 002070   002061 600000 22                 TZE     s:8828

   8833 22 002071   000003 236000 10                 LDQ     LEX_SYMBOL+3
        22 002072   000000 116000 15                 CMPQ    CURRENT_SYMBOL_LEVEL
        22 002073   002103 600000 22                 TZE     s:8843
        22 002074   000002 236000 10                 LDQ     LEX_SYMBOL+2
        22 002075   200000 316003                    CANQ    65536,DU
        22 002076   002103 601000 22                 TNZ     s:8843

   8835 22 002077   000005 630400 23                 EPPR0   5
        22 002100   000004 631400 23                 EPPR1   4
        22 002101   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        22 002102   000000 011000                    NOP     0

     2140     8842
     2141     8843    2       IF LIST$ -> BASED_LEX_SYMBOL.TYPE = %USER_WORD THEN

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:523  
   8843 22 002103   200003 470500                    LDP0    @LIST$,,AUTO
        22 002104   000000 471500                    LDP1    0,,PR0
        22 002105   100001 235100                    LDA     1,,PR1
        22 002106   000005 115007                    CMPA    5,DL
        22 002107   002147 601000 22                 TNZ     s:8870

     2142     8844    3         DO;

     2143     8845    3           END_LIST$ = LIST$;

   8845 22 002110   000000 236100                    LDQ     0,,PR0
        22 002111   200012 756100                    STQ     END_LIST$,,AUTO

     2144     8846
     2145     8847    3           CALL PARSE_QUALIFIERS (END_LIST$)

   8847 22 002112   200012 631500                    EPPR1   END_LIST$,,AUTO
        22 002113   200015 451500                    STP1    END_LIST$+3,,AUTO
        22 002114   000003 701000 22                 TSX1    PARSE_QUALIFIERS
        22 002115   002117 702000 22                 TSX2    s:8850
        22 002116   002120 710000 22                 TRA     s:8853

     2146     8848    3             WHENALTRETURN
     2147     8849    4               DO;

     2148     8850    4                 ALTRETURN;

   8850 22 002117   000000 702200 xent               TSX2  ! X66_AALT

     2149     8851    4               END;
     2150     8852
     2151     8853    3           CALL PARSE_SUB_REFMOD (END_LIST$)

   8853 22 002120   200012 630500                    EPPR0   END_LIST$,,AUTO
        22 002121   200015 450500                    STP0    END_LIST$+3,,AUTO
        22 002122   000477 701000 22                 TSX1    PARSE_SUB_REFMOD
        22 002123   002125 702000 22                 TSX2    s:8856
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:524  
        22 002124   002126 710000 22                 TRA     s:8859

     2152     8854    3             WHENALTRETURN
     2153     8855    4               DO;

     2154     8856    4                 ALTRETURN;

   8856 22 002125   000000 702200 xent               TSX2  ! X66_AALT

     2155     8857    4               END;
     2156     8858
     2157     8859    3           CALL PARSE_SUB_REFMOD (END_LIST$)

   8859 22 002126   200012 630500                    EPPR0   END_LIST$,,AUTO
        22 002127   200015 450500                    STP0    END_LIST$+3,,AUTO
        22 002130   000477 701000 22                 TSX1    PARSE_SUB_REFMOD
        22 002131   002133 702000 22                 TSX2    s:8862
        22 002132   002134 710000 22                 TRA     s:8865

     2158     8860    3             WHENALTRETURN
     2159     8861    4               DO;

     2160     8862    4                 ALTRETURN;

   8862 22 002133   000000 702200 xent               TSX2  ! X66_AALT

     2161     8863    4               END;
     2162     8864
     2163     8865    3           IF LIST$ -> BASED_LEX_SYMBOL.NEXT$ ~= ADDR(NIL) THEN

   8865 22 002134   200003 470500                    LDP0    @LIST$,,AUTO
        22 002135   000000 471500                    LDP1    0,,PR0
        22 002136   100000 236100                    LDQ     0,,PR1
        22 002137   000001 116000 23                 CMPQ    1
        22 002140   002147 600000 22                 TZE     s:8870

     2164     8866    3             CALL FAKE_PSEUDO_TEXT (LIST$, END_LIST$);
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:525  

   8866 22 002141   200012 633500                    EPPR3   END_LIST$,,AUTO
        22 002142   200016 453500                    STP3    @LIST$+1,,AUTO
        22 002143   200003 236100                    LDQ     @LIST$,,AUTO
        22 002144   200015 756100                    STQ     END_LIST$+3,,AUTO
        22 002145   000757 701000 22                 TSX1    FAKE_PSEUDO_TEXT
        22 002146   000000 011000                    NOP     0

     2165     8867    3         END;

     2166     8868    2     END;

     2167     8869
     2168     8870    1   END Z8EL$GET_REPLACE_TOKENS;

   8870 22 002147   000000 702200 xent               TSX2  ! X66_ARET
     2169     8871        %EOD;

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:526  
--  Include file information  --

   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$GET_REPLACE_TOKENS.
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:527  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 002 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_BUFFER$

  ****  Section 003 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 004 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:528  
  ****  Section 005 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 006 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 007 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 008 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 009 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 010 LblCom LEX_SYMBOL

PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:529  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 011 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 012 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 013 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 014 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAP$

  ****  Section 015 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:530  

     0-0-0/w SBIN        r     1 CURRENT_SYMBOL_LEVEL

  ****  Section 016 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 017 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 018 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 019 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 020 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LEX_SYMBOL_QUEUE$
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:531  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w PTR         r     1 @END_LIST$                15-0-0/w PTR         r     1 @END_LIST$
    16-0-0/w PTR         r     1 @END_LIST$                 3-0-0/w PTR         r     1 @LIST$
    15-0-0/w PTR         r     1 @LIST$
    10-0-0/w PTR         r     1 @PSEUDO_TEXT_END_COLUMN
     7-0-0/w PTR         r     1 @PSEUDO_TEXT_END_LINE
     4-0-0/w PTR         r     1 @PSEUDO_TEXT_FLAG
     6-0-0/w PTR         r     1 @PSEUDO_TEXT_START_COLUMN
     5-0-0/w PTR         r     1 @PSEUDO_TEXT_START_LINE
    11-0-0/w PTR         r     1 ADDRLIST$                 12-0-0/w PTR         r     1 END_LIST$
    *0-0-0/w PTR         r     1 END_LIST$                 *0-0-0/w PTR         r     1 END_LIST$
    *0-0-0/w PTR         r     1 END_LIST$                 16-0-0/w SBIN        r     1 LEXICAL_LEVEL
    *0-0-0/w PTR         r     1 LIST$                     *0-0-0/w PTR         r     1 LIST$
    *0-0-0/w SBIN        r     1 PSEUDO_TEXT_END_COLUMN
    *0-0-0/w SBIN        r     1 PSEUDO_TEXT_END_LINE      *0-0-0/w BIT         r     1 PSEUDO_TEXT_FLAG
    *0-0-0/w SBIN        r     1 PSEUDO_TEXT_START_COLUMN
    *0-0-0/w SBIN        r     1 PSEUDO_TEXT_START_LINE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248)       1 COMCOM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
PL6.E3A0      #013=Z8EL$GET_REPLACE_TOKENS File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:15 Page:532  
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w PTR         r     1 L$                         0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(252)         1 REPLACE_ITEM
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$GET_REPLACE_TOKENS requires 1128 words for executable code.
   Procedure Z8EL$GET_REPLACE_TOKENS requires 20 words of local(AUTO) storage.

PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:533  
     2170        1        /*T***********************************************************/
     2171        2        /*T*                                                         */
     2172        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2173        4        /*T*                                                         */
     2174        5        /*T***********************************************************/
     2175        6        Z8EL$POSITION_LINE_LIST : PROC (LINE,
     2176        7                                        LINE$,
     2177        8                                        START_LINE);
     2178        9
     2179       10    1     DCL LINE SBIN;
     2180       11    1     DCL LINE$ PTR;
     2181       12    1     DCL START_LINE SBIN;
     2182       13
     2183       14        %EQU PHASE = 1;
     2184       15        %INCLUDE Z8A_DEFC;
     2185       83        %INCLUDE Z8A_SUPP_MAC;
     2186     2483        %INCLUDE Z8E_STACKS;
     2187     4749        %INCLUDE Z8E_REPLACE;
     2188     5052        %INCLUDE Z8E_BUFFERS;
     2189     5242
     2190     5243
     2191     5244
     2192     5245    1     IF LINE$ = ADDR(NIL) THEN
     2193     5246    1       LINE$ = LINE_LIST$;
     2194     5247
     2195     5248    2     DO WHILE LINE$ ~= ADDR(NIL)
     2196     5249    2               AND (LINE$ -> FILL_BUFFER.ISN ~= LINE
     2197     5250    2                      OR LINE$ -> FILL_BUFFER.LINE_TYPE.OLD_REP_LINE);
     2198     5251
     2199     5252    2       IF LINE$ -> FILL_BUFFER.ISN >= START_LINE THEN
     2200     5253    2         LINE$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;
     2201     5254    2       LINE$ = LINE$ -> FILL_BUFFER.NEXT$;
     2202     5255    2     END;
     2203     5256
     2204     5257    1     IF LINE$ ~= ADDR(NIL) AND
     2205     5258    1         LINE$ -> FILL_BUFFER.ISN >= START_LINE THEN
     2206     5259    1       LINE$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:534  
     2207     5260
     2208     5261    1   END Z8EL$POSITION_LINE_LIST;
     2209     5262        %EOD;

PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:535  
--  Include file information  --

   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$POSITION_LINE_LIST.

   Procedure Z8EL$POSITION_LINE_LIST requires 41 words for executable code.
   Procedure Z8EL$POSITION_LINE_LIST requires 6 words of local(AUTO) storage.

PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:536  

 Object Unit name= Z8EL$POSITION_LINE_LIST                    File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:17:16.56 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    6  LblCom even  none     1      1  REPLACE_ACTIVE
    7  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    8  LblCom even  none     1      1  COPY_DEBUG_LEVEL
    9  LblCom even  none     4      4  REPLACE_LIST
   10  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   11  LblCom even  none     1      1  SCANNER_STATE
   12  LblCom even  none     1      1  CURRENT_BUFFER$
   13  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
   14  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   15  LblCom even  none     1      1  LINE_LIST$
   16  LblCom even  none     7      7  BUFFER
   17  LblCom even  none     1      1  ORIGINAL_ISN
   18  LblCom even  none     1      1  EXPANDED_ISN
   19  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   20   Proc  even  none    41     51  Z8EL$POSITION_LINE_LIST
   21  RoData even  none     1      1  Z8EL$POSITION_LINE_LIST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    20      0   yes            yes      Std        3  Z8EL$POSITION_LINE_LIST
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:537  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:538  


     2170        1        /*T***********************************************************/
     2171        2        /*T*                                                         */
     2172        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2173        4        /*T*                                                         */
     2174        5        /*T***********************************************************/
     2175        6        Z8EL$POSITION_LINE_LIST : PROC (LINE,

      6 20 000000   000000 700200 xent  Z8EL$POSITI* TSX0  ! X66_AUTO_3
        20 000001   000006 000003                    ZERO    6,3

     2176        7                                        LINE$,
     2177        8                                        START_LINE);
     2178        9
     2179       10    1     DCL LINE SBIN;
     2180       11    1     DCL LINE$ PTR;
     2181       12    1     DCL START_LINE SBIN;
     2182       13
     2183       14        %EQU PHASE = 1;
     2184       15        %INCLUDE Z8A_DEFC;
     2185       83        %INCLUDE Z8A_SUPP_MAC;
     2186     2483        %INCLUDE Z8E_STACKS;
     2187     4749        %INCLUDE Z8E_REPLACE;
     2188     5052        %INCLUDE Z8E_BUFFERS;
     2189     5242
     2190     5243
     2191     5244
     2192     5245    1     IF LINE$ = ADDR(NIL) THEN

   5245 20 000002   200004 470500                    LDP0    @LINE$,,AUTO
        20 000003   000000 236100                    LDQ     0,,PR0
        20 000004   000000 116000 21                 CMPQ    0
        20 000005   000010 601000 20                 TNZ     s:5248

     2193     5246    1       LINE$ = LINE_LIST$;

   5246 20 000006   000000 236000 15                 LDQ     LINE_LIST$
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:539  
        20 000007   000000 756100                    STQ     0,,PR0

     2194     5247
     2195     5248    2     DO WHILE LINE$ ~= ADDR(NIL)

   5248 20 000010   000024 710000 20                 TRA     s:5255

     2196     5249    2               AND (LINE$ -> FILL_BUFFER.ISN ~= LINE
     2197     5250    2                      OR LINE$ -> FILL_BUFFER.LINE_TYPE.OLD_REP_LINE);
     2198     5251
     2199     5252    2       IF LINE$ -> FILL_BUFFER.ISN >= START_LINE THEN

   5252 20 000011   200004 470500                    LDP0    @LINE$,,AUTO
        20 000012   000000 471500                    LDP1    0,,PR0
        20 000013   200005 473500                    LDP3    @START_LINE,,AUTO
        20 000014   100004 236100                    LDQ     4,,PR1
        20 000015   300000 116100                    CMPQ    0,,PR3
        20 000016   000021 604000 20                 TMI     s:5254

     2200     5253    2         LINE$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;

   5253 20 000017   000010 236003                    LDQ     8,DU
        20 000020   100011 256100                    ORSQ    9,,PR1

     2201     5254    2       LINE$ = LINE$ -> FILL_BUFFER.NEXT$;

   5254 20 000021   000000 471500                    LDP1    0,,PR0
        20 000022   100002 236100                    LDQ     2,,PR1
        20 000023   000000 756100                    STQ     0,,PR0

     2202     5255    2     END;

   5255 20 000024   000000 116000 21                 CMPQ    0
        20 000025   000036 600000 20                 TZE     s:5257
        20 000026   000000 471500                    LDP1    0,,PR0
        20 000027   200003 473500                    LDP3    @LINE,,AUTO
        20 000030   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:540  
        20 000031   300000 116100                    CMPQ    0,,PR3
        20 000032   000011 601000 20                 TNZ     s:5252
        20 000033   100011 236100                    LDQ     9,,PR1
        20 000034   020000 316003                    CANQ    8192,DU
        20 000035   000011 601000 20                 TNZ     s:5252

     2203     5256
     2204     5257    1     IF LINE$ ~= ADDR(NIL) AND

   5257 20 000036   000000 236100                    LDQ     0,,PR0
        20 000037   000000 116000 21                 CMPQ    0
        20 000040   000050 600000 20                 TZE     s:5261
        20 000041   000000 471500                    LDP1    0,,PR0
        20 000042   200005 473500                    LDP3    @START_LINE,,AUTO
        20 000043   100004 236100                    LDQ     4,,PR1
        20 000044   300000 116100                    CMPQ    0,,PR3
        20 000045   000050 604000 20                 TMI     s:5261

     2205     5258    1         LINE$ -> FILL_BUFFER.ISN >= START_LINE THEN
     2206     5259    1       LINE$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = TRUE;

   5259 20 000046   000010 236003                    LDQ     8,DU
        20 000047   100011 256100                    ORSQ    9,,PR1

     2207     5260
     2208     5261    1   END Z8EL$POSITION_LINE_LIST;

   5261 20 000050   000000 702200 xent               TSX2  ! X66_ARET
     2209     5262        %EOD;

PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:541  
--  Include file information  --

   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$POSITION_LINE_LIST.
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:542  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:543  
  ****  Section 005 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 006 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 007 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 008 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 009 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 010 LblCom LEX_SYMBOL_QUEUE$

PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:544  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Section 011 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 012 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 013 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 014 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 015 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:545  

     0-0-0/w PTR         r     1 LINE_LIST$

  ****  Section 016 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 017 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 018 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 019 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @LINE                      4-0-0/w PTR         r     1 @LINE$
PL6.E3A0      #014=Z8EL$POSITION_LINE_LIST File=Z8EL.:Z8A6TSI                    SAT 08/09/97 12:17 Page:546  
     5-0-0/w PTR         r     1 @START_LINE               *0-0-0/w SBIN        r     1 LINE
    *0-0-0/w PTR         r     1 LINE$                     *0-0-0/w SBIN        r     1 START_LINE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(252)         1 REPLACE_ITEM               0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$POSITION_LINE_LIST requires 41 words for executable code.
   Procedure Z8EL$POSITION_LINE_LIST requires 6 words of local(AUTO) storage.

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:547  
     2210        1        /*T***********************************************************/
     2211        2        /*T*                                                         */
     2212        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2213        4        /*T*                                                         */
     2214        5        /*T***********************************************************/
     2215        6        Z8EL$EXTRACT_PSEUDO_TEXT : PROC (LINES$,
     2216        7                                         LINE,
     2217        8                                         COLUMN,
     2218        9                                         END_LINE,
     2219       10                                         END_COLUMN);
     2220       11
     2221       12    1     DCL LINES$ PTR;
     2222       13    1     DCL LINE SBIN;
     2223       14    1     DCL COLUMN SBIN;
     2224       15    1     DCL END_LINE SBIN;
     2225       16    1     DCL END_COLUMN SBIN;
     2226       17
     2227       18        %EQU PHASE = 1;
     2228       19        %INCLUDE Z8A_DEFC;
     2229       87        %INCLUDE Z8A_SUPP_MAC;
     2230     2487        %INCLUDE Z8E_STACKS;
     2231     4753        %INCLUDE Z8E_BUFFERS;
     2232     4943        %INCLUDE Z8E_HEAP;
     2233     4999        %INCLUDE Z8E_REPLACE;
     2234     5302        %INCLUDE Z8A_COMCOM ;
     2235     5952        %INCLUDE Z8E_O1COM ;
     2236     6713
     2237     6714
     2238     6715    1   DCL Z8EL$POSITION_LINE_LIST ENTRY(3);
     2239     6716
     2240     6717    1   DCL LINE$ PTR;
     2241     6718    1   DCL L$ PTR;
     2242     6719
     2243     6720    1   DCL NEW_LINE$ PTR;
     2244     6721    1   DCL LAST_NEW_LINE$ PTR;
     2245     6722
     2246     6723
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:548  
     2247     6724          /* Main body of EXTRACT_PSEUDO_TEXT */
     2248     6725
     2249     6726    1   LINES$ = ADDR(NIL);
     2250     6727    1   LAST_NEW_LINE$ = ADDR(NIL);
     2251     6728
     2252     6729    1   L$ = ADDR(NIL);
     2253     6730    1   CALL Z8EL$POSITION_LINE_LIST (LINE,
     2254     6731    1                                 L$,
     2255     6732    1                                 999999999);
     2256     6733
     2257     6734    1   IF L$ ~= ADDR(NIL) THEN
     2258     6735    2     DO UNTIL L$ = ADDR(NIL);
     2259     6736
     2260     6737            %NEW_HEAP (@POINTER = NEW_LINE$,
     2261     6738                       @SIZE = %MAX_INPUT_BUFFER_LEN);
     2262     6743
     2263     6744    2       IF LAST_NEW_LINE$ = ADDR(NIL) THEN
     2264     6745    2         LINES$ = NEW_LINE$;
     2265     6746    2       ELSE
     2266     6747    2         LAST_NEW_LINE$ -> FILL_BUFFER.NEXT$ = NEW_LINE$;
     2267     6748
     2268     6749    2       LAST_NEW_LINE$ = NEW_LINE$;
     2269     6750    2       NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH = L$ -> FILL_BUFFER.LINE_LENGTH;
     2270     6751    2       NEW_LINE$ -> FILL_BUFFER = L$ -> FILL_BUFFER;
     2271     6752    2       NEW_LINE$ -> FILL_BUFFER.NEXT$ = ADDR(NIL);
     2272     6753
     2273     6754    2       IF COMCOM.OB.FORMAT = FALSE THEN
     2274     6755    2         SUBSTR(NEW_LINE$ -> FILL_BUFFER.SOURCE_LINE,
     2275     6756    2                0,
     2276     6757    2                6) = ' ';
     2277     6758
     2278     6759    2       IF NEW_LINE$ -> FILL_BUFFER.ISN = LINE THEN
     2279     6760    2         SUBSTR(NEW_LINE$ -> FILL_BUFFER.SOURCE_LINE,
     2280     6761    2                O1COM.AREA_A_COLUMN_START,
     2281     6762    2                COLUMN - O1COM.AREA_A_COLUMN_START) = ' ';
     2282     6763
     2283     6764    2       IF  NEW_LINE$ -> FILL_BUFFER.ISN = END_LINE
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:549  
     2284     6765    2       AND NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH > END_COLUMN THEN
     2285     6766    3         DO;
     2286     6767    3           SUBSTR(NEW_LINE$ -> FILL_BUFFER.SOURCE_LINE,
     2287     6768    3                  END_COLUMN,
     2288     6769    3                  NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH - END_COLUMN) = ' ';
     2289     6770    3           NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH = END_COLUMN;
     2290     6771    3           L$ = ADDR(NIL);
     2291     6772    3         END;
     2292     6773    2       ELSE
     2293     6774    2         L$ = L$ -> FILL_BUFFER.NEXT$;
     2294     6775    2     END;
     2295     6776
     2296     6777    1   IF LINES$ ~= ADDR(NIL)
     2297     6778    1       AND SUBSTR(LINES$ -> FILL_BUFFER.SOURCE_LINE,
     2298     6779    1                  O1COM.AREA_A_COLUMN_START,
     2299     6780    1                  LINES$ -> FILL_BUFFER.LINE_LENGTH - O1COM.AREA_A_COLUMN_START) = ' '
              6780                           THEN
     2300     6781    2     DO;
     2301     6782    2       L$ = LINES$;
     2302     6783    2       LINES$ = LINES$ -> FILL_BUFFER.NEXT$;
     2303     6784    2       CALL Z8ED$DISPOSE_HEAP (L$,
     2304     6785    2                               %MAX_INPUT_BUFFER_LEN);
     2305     6786    2     END;
     2306     6787
     2307     6788    1   END Z8EL$EXTRACT_PSEUDO_TEXT;
     2308     6789        %EOD;

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:550  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$EXTRACT_PSEUDO_TEXT.

   Procedure Z8EL$EXTRACT_PSEUDO_TEXT requires 132 words for executable code.
   Procedure Z8EL$EXTRACT_PSEUDO_TEXT requires 16 words of local(AUTO) storage.

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:551  

 Object Unit name= Z8EL$EXTRACT_PSEUDO_TEXT                   File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:17:57.00 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  SCANNER_STATE
    6  LblCom even  none     1      1  CURRENT_BUFFER$
    7  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
    8  LblCom even  none     1      1  CURRENT_LINE_LEVEL
    9  LblCom even  none     1      1  LINE_LIST$
   10  LblCom even  none     7      7  BUFFER
   11  LblCom even  none     1      1  ORIGINAL_ISN
   12  LblCom even  none     1      1  EXPANDED_ISN
   13  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   14  LblCom even  none     1      1  HEAP$
   15  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
   16  LblCom even  none     1      1  REPLACE_ACTIVE
   17  LblCom even  none     1      1  IGNORE_COPY_REPLACE
   18  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   19  LblCom even  none     4      4  REPLACE_LIST
   20  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   21   Proc  even  none   132    204  Z8EL$EXTRACT_PSEUDO_TEXT
   22  RoData even  none     8     10  Z8EL$EXTRACT_PSEUDO_TEXT
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:552  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    21      0   yes            yes      Std        5  Z8EL$EXTRACT_PSEUDO_TEXT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 Z8EL$POSITION_LINE_LIST
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       2 Z8ED$DISPOSE_HEAP
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:553  


     2210        1        /*T***********************************************************/
     2211        2        /*T*                                                         */
     2212        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2213        4        /*T*                                                         */
     2214        5        /*T***********************************************************/
     2215        6        Z8EL$EXTRACT_PSEUDO_TEXT : PROC (LINES$,

      6 21 000000   000000 700200 xent  Z8EL$EXTRAC* TSX0  ! X66_AUTO_5
        21 000001   000020 000005                    ZERO    16,5

     2216        7                                         LINE,
     2217        8                                         COLUMN,
     2218        9                                         END_LINE,
     2219       10                                         END_COLUMN);
     2220       11
     2221       12    1     DCL LINES$ PTR;
     2222       13    1     DCL LINE SBIN;
     2223       14    1     DCL COLUMN SBIN;
     2224       15    1     DCL END_LINE SBIN;
     2225       16    1     DCL END_COLUMN SBIN;
     2226       17
     2227       18        %EQU PHASE = 1;
     2228       19        %INCLUDE Z8A_DEFC;
     2229       87        %INCLUDE Z8A_SUPP_MAC;
     2230     2487        %INCLUDE Z8E_STACKS;
     2231     4753        %INCLUDE Z8E_BUFFERS;
     2232     4943        %INCLUDE Z8E_HEAP;
     2233     4999        %INCLUDE Z8E_REPLACE;
     2234     5302        %INCLUDE Z8A_COMCOM ;
     2235     5952        %INCLUDE Z8E_O1COM ;
     2236     6713
     2237     6714
     2238     6715    1   DCL Z8EL$POSITION_LINE_LIST ENTRY(3);
     2239     6716
     2240     6717    1   DCL LINE$ PTR;
     2241     6718    1   DCL L$ PTR;
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:554  
     2242     6719
     2243     6720    1   DCL NEW_LINE$ PTR;
     2244     6721    1   DCL LAST_NEW_LINE$ PTR;
     2245     6722
     2246     6723
     2247     6724          /* Main body of EXTRACT_PSEUDO_TEXT */
     2248     6725
     2249     6726    1   LINES$ = ADDR(NIL);

   6726 21 000002   000000 236000 22                 LDQ     0
        21 000003   200003 470500                    LDP0    @LINES$,,AUTO
        21 000004   000000 756100                    STQ     0,,PR0

     2250     6727    1   LAST_NEW_LINE$ = ADDR(NIL);

   6727 21 000005   000000 236000 22                 LDQ     0
        21 000006   200013 756100                    STQ     LAST_NEW_LINE$,,AUTO

     2251     6728
     2252     6729    1   L$ = ADDR(NIL);

   6729 21 000007   200011 756100                    STQ     L$,,AUTO

     2253     6730    1   CALL Z8EL$POSITION_LINE_LIST (LINE,

   6730 21 000010   000003 236000 22                 LDQ     3
        21 000011   200016 756100                    STQ     LAST_NEW_LINE$+3,,AUTO
        21 000012   200011 631500                    EPPR1   L$,,AUTO
        21 000013   200015 451500                    STP1    LAST_NEW_LINE$+2,,AUTO
        21 000014   200004 236100                    LDQ     @LINE,,AUTO
        21 000015   200014 756100                    STQ     LAST_NEW_LINE$+1,,AUTO
        21 000016   200014 630500                    EPPR0   LAST_NEW_LINE$+1,,AUTO
        21 000017   000001 631400 22                 EPPR1   1
        21 000020   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        21 000021   000000 011000                    NOP     0

     2254     6731    1                                 L$,
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:555  
     2255     6732    1                                 999999999);
     2256     6733
     2257     6734    1   IF L$ ~= ADDR(NIL) THEN

   6734 21 000022   200011 236100                    LDQ     L$,,AUTO
        21 000023   000000 116000 22                 CMPQ    0
        21 000024   000150 600000 21                 TZE     s:6777

     2258     6735    2     DO UNTIL L$ = ADDR(NIL);

     2259     6736
     2260     6737            %NEW_HEAP (@POINTER = NEW_LINE$,
     2261     6738                       @SIZE = %MAX_INPUT_BUFFER_LEN);

   6740 21 000025   000006 236000 22                 LDQ     6
        21 000026   200015 756100                    STQ     LAST_NEW_LINE$+2,,AUTO
        21 000027   200012 630500                    EPPR0   NEW_LINE$,,AUTO
        21 000030   200014 450500                    STP0    LAST_NEW_LINE$+1,,AUTO
        21 000031   200014 630500                    EPPR0   LAST_NEW_LINE$+1,,AUTO
        21 000032   000004 631400 22                 EPPR1   4
        21 000033   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        21 000034   000000 011000                    NOP     0

     2262     6743
     2263     6744    2       IF LAST_NEW_LINE$ = ADDR(NIL) THEN

   6744 21 000035   200013 236100                    LDQ     LAST_NEW_LINE$,,AUTO
        21 000036   000000 116000 22                 CMPQ    0
        21 000037   000044 601000 21                 TNZ     s:6747

     2264     6745    2         LINES$ = NEW_LINE$;

   6745 21 000040   200012 236100                    LDQ     NEW_LINE$,,AUTO
        21 000041   200003 470500                    LDP0    @LINES$,,AUTO
        21 000042   000000 756100                    STQ     0,,PR0
        21 000043   000047 710000 21                 TRA     s:6749

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:556  
     2265     6746    2       ELSE
     2266     6747    2         LAST_NEW_LINE$ -> FILL_BUFFER.NEXT$ = NEW_LINE$;

   6747 21 000044   200012 236100                    LDQ     NEW_LINE$,,AUTO
        21 000045   200013 470500                    LDP0    LAST_NEW_LINE$,,AUTO
        21 000046   000002 756100                    STQ     2,,PR0

     2267     6748
     2268     6749    2       LAST_NEW_LINE$ = NEW_LINE$;

   6749 21 000047   200012 236100                    LDQ     NEW_LINE$,,AUTO
        21 000050   200013 756100                    STQ     LAST_NEW_LINE$,,AUTO

     2269     6750    2       NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH = L$ -> FILL_BUFFER.LINE_LENGTH;

   6750 21 000051   200011 470500                    LDP0    L$,,AUTO
        21 000052   200012 471500                    LDP1    NEW_LINE$,,AUTO
        21 000053   000012 235100                    LDA     10,,PR0
        21 000054   100012 755100                    STA     10,,PR1

     2270     6751    2       NEW_LINE$ -> FILL_BUFFER = L$ -> FILL_BUFFER;

   6751 21 000055   200012 471500                    LDP1    NEW_LINE$,,AUTO
        21 000056   100012 720100                    LXL0    10,,PR1
        21 000057   000054 621010                    EAX1    44,X0
        21 000060   000012 722100                    LXL2    10,,PR0
        21 000061   000054 623012                    EAX3    44,X2
        21 000062   000140 100540                    MLR     fill='000'O
        21 000063   000000 000013                    ADSC9   0,,PR0                   cn=0,n=*X3
        21 000064   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2271     6752    2       NEW_LINE$ -> FILL_BUFFER.NEXT$ = ADDR(NIL);

   6752 21 000065   000000 236000 22                 LDQ     0
        21 000066   200012 470500                    LDP0    NEW_LINE$,,AUTO
        21 000067   000002 756100                    STQ     2,,PR0

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:557  
     2272     6753
     2273     6754    2       IF COMCOM.OB.FORMAT = FALSE THEN

   6754 21 000070   000030 234000 xsym               SZN     COMCOM+24
        21 000071   000077 604000 21                 TMI     s:6759

     2274     6755    2         SUBSTR(NEW_LINE$ -> FILL_BUFFER.SOURCE_LINE,

   6755 21 000072   200012 470500                    LDP0    NEW_LINE$,,AUTO
        21 000073   000012 720100                    LXL0    10,,PR0
        21 000074   040100 100400                    MLR     fill='040'O
        21 000075   000007 000001 22                 ADSC9   7                        cn=0,n=1
        21 000076   000013 000006                    ADSC9   11,,PR0                  cn=0,n=6

     2275     6756    2                0,
     2276     6757    2                6) = ' ';
     2277     6758
     2278     6759    2       IF NEW_LINE$ -> FILL_BUFFER.ISN = LINE THEN

   6759 21 000077   200012 470500                    LDP0    NEW_LINE$,,AUTO
        21 000100   200004 471500                    LDP1    @LINE,,AUTO
        21 000101   000004 236100                    LDQ     4,,PR0
        21 000102   100000 116100                    CMPQ    0,,PR1
        21 000103   000115 601000 21                 TNZ     s:6764

     2279     6760    2         SUBSTR(NEW_LINE$ -> FILL_BUFFER.SOURCE_LINE,

   6760 21 000104   000012 720100                    LXL0    10,,PR0
        21 000105   200005 473500                    LDP3    @COLUMN,,AUTO
        21 000106   300000 236100                    LDQ     0,,PR3
        21 000107   000122 136000 xsym               SBLQ    O1COM+82
        21 000110   000000 621006                    EAX1    0,QL
        21 000111   000122 235000 xsym               LDA     O1COM+82
        21 000112   040145 100400                    MLR     fill='040'O
        21 000113   000007 000001 22                 ADSC9   7                        cn=0,n=1
        21 000114   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:558  
     2280     6761    2                O1COM.AREA_A_COLUMN_START,
     2281     6762    2                COLUMN - O1COM.AREA_A_COLUMN_START) = ' ';
     2282     6763
     2283     6764    2       IF  NEW_LINE$ -> FILL_BUFFER.ISN = END_LINE

   6764 21 000115   200012 470500                    LDP0    NEW_LINE$,,AUTO
        21 000116   200006 473500                    LDP3    @END_LINE,,AUTO
        21 000117   000004 236100                    LDQ     4,,PR0
        21 000120   300000 116100                    CMPQ    0,,PR3
        21 000121   000143 601000 21                 TNZ     s:6774
        21 000122   200007 474500                    LDP4    @END_COLUMN,,AUTO
        21 000123   000012 236100                    LDQ     10,,PR0
        21 000124   400000 116100                    CMPQ    0,,PR4
        21 000125   000143 604400 21                 TMOZ    s:6774

     2284     6765    2       AND NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH > END_COLUMN THEN
     2285     6766    3         DO;

     2286     6767    3           SUBSTR(NEW_LINE$ -> FILL_BUFFER.SOURCE_LINE,

   6767 21 000126   000012 720100                    LXL0    10,,PR0
        21 000127   400000 136100                    SBLQ    0,,PR4
        21 000130   400000 235100                    LDA     0,,PR4
        21 000131   000000 621006                    EAX1    0,QL
        21 000132   040145 100400                    MLR     fill='040'O
        21 000133   000007 000001 22                 ADSC9   7                        cn=0,n=1
        21 000134   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1

     2287     6768    3                  END_COLUMN,
     2288     6769    3                  NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH - END_COLUMN) = ' ';
     2289     6770    3           NEW_LINE$ -> FILL_BUFFER.LINE_LENGTH = END_COLUMN;

   6770 21 000135   200012 470500                    LDP0    NEW_LINE$,,AUTO
        21 000136   400000 235100                    LDA     0,,PR4
        21 000137   000012 755100                    STA     10,,PR0

     2290     6771    3           L$ = ADDR(NIL);
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:559  

   6771 21 000140   000000 236000 22                 LDQ     0
        21 000141   200011 756100                    STQ     L$,,AUTO

     2291     6772    3         END;

   6772 21 000142   000146 710000 21                 TRA     s:6775

     2292     6773    2       ELSE
     2293     6774    2         L$ = L$ -> FILL_BUFFER.NEXT$;

   6774 21 000143   200011 474500                    LDP4    L$,,AUTO
        21 000144   400002 236100                    LDQ     2,,PR4
        21 000145   200011 756100                    STQ     L$,,AUTO

     2294     6775    2     END;

   6775 21 000146   000000 116000 22                 CMPQ    0
        21 000147   000025 601000 21                 TNZ     s:6740

     2295     6776
     2296     6777    1   IF LINES$ ~= ADDR(NIL)

   6777 21 000150   200003 470500                    LDP0    @LINES$,,AUTO
        21 000151   000000 236100                    LDQ     0,,PR0
        21 000152   000000 116000 22                 CMPQ    0
        21 000153   000203 600000 21                 TZE     s:6788
        21 000154   000000 471500                    LDP1    0,,PR0
        21 000155   100012 720100                    LXL0    10,,PR1
        21 000156   100012 236100                    LDQ     10,,PR1
        21 000157   000122 136000 xsym               SBLQ    O1COM+82
        21 000160   000000 621006                    EAX1    0,QL
        21 000161   000122 235000 xsym               LDA     O1COM+82
        21 000162   040000 106545                    CMPC    fill='040'O
        21 000163   100013 000011                    ADSC9   11,A,PR1                 cn=0,n=*X1
        21 000164   000007 000001 22                 ADSC9   7                        cn=0,n=1
        21 000165   000203 601000 21                 TNZ     s:6788
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:560  

     2297     6778    1       AND SUBSTR(LINES$ -> FILL_BUFFER.SOURCE_LINE,
     2298     6779    1                  O1COM.AREA_A_COLUMN_START,
     2299     6780    1                  LINES$ -> FILL_BUFFER.LINE_LENGTH - O1COM.AREA_A_COLUMN_START) = ' '
              6780                           THEN
     2300     6781    2     DO;

     2301     6782    2       L$ = LINES$;

   6782 21 000166   000000 236100                    LDQ     0,,PR0
        21 000167   200011 756100                    STQ     L$,,AUTO

     2302     6783    2       LINES$ = LINES$ -> FILL_BUFFER.NEXT$;

   6783 21 000170   000000 471500                    LDP1    0,,PR0
        21 000171   100002 236100                    LDQ     2,,PR1
        21 000172   000000 756100                    STQ     0,,PR0

     2303     6784    2       CALL Z8ED$DISPOSE_HEAP (L$,

   6784 21 000173   000006 236000 22                 LDQ     6
        21 000174   200015 756100                    STQ     LAST_NEW_LINE$+2,,AUTO
        21 000175   200011 631500                    EPPR1   L$,,AUTO
        21 000176   200014 451500                    STP1    LAST_NEW_LINE$+1,,AUTO
        21 000177   200014 630500                    EPPR0   LAST_NEW_LINE$+1,,AUTO
        21 000200   000004 631400 22                 EPPR1   4
        21 000201   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        21 000202   000000 011000                    NOP     0

     2304     6785    2                               %MAX_INPUT_BUFFER_LEN);
     2305     6786    2     END;

     2306     6787
     2307     6788    1   END Z8EL$EXTRACT_PSEUDO_TEXT;

   6788 21 000203   000000 702200 xent               TSX2  ! X66_ARET
     2308     6789        %EOD;
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:561  

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:562  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$EXTRACT_PSEUDO_TEXT.
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:563  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:564  
  ****  Section 005 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SCANNER_STATE

  ****  Section 006 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 CURRENT_BUFFER$

  ****  Section 007 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 008 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 009 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 010 LblCom BUFFER

PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:565  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 011 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 012 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 EXPANDED_ISN

  ****  Section 013 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC

  ****  Section 014 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 015 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:566  

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 016 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 017 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 018 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 019 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 020 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:567  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @COLUMN                    7-0-0/w PTR         r     1 @END_COLUMN
     6-0-0/w PTR         r     1 @END_LINE                  4-0-0/w PTR         r     1 @LINE
     3-0-0/w PTR         r     1 @LINES$                   *0-0-0/w SBIN        r     1 COLUMN
    *0-0-0/w SBIN        r     1 END_COLUMN                *0-0-0/w SBIN        r     1 END_LINE
    11-0-0/w PTR         r     1 L$                        13-0-0/w PTR         r     1 LAST_NEW_LINE$
    *0-0-0/w SBIN        r     1 LINE                      10-0-0/w PTR               1 LINE$
    *0-0-0/w PTR         r     1 LINES$                    12-0-0/w PTR         r     1 NEW_LINE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/d STRC(11580) r     1 O1COM
     0-0-0/w STRC(144)         1 PAGE_FORMAT                0-0-0/w STRC(153)         1 REP_STK(0:50)
     0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR              1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
PL6.E3A0      #015=Z8EL$EXTRACT_PSEUDO_TEXT File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:17 Page:568  
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(252)         1 REPLACE_ITEM               0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$EXTRACT_PSEUDO_TEXT requires 132 words for executable code.
   Procedure Z8EL$EXTRACT_PSEUDO_TEXT requires 16 words of local(AUTO) storage.

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:569  
     2309        1        /*T***********************************************************/
     2310        2        /*T*                                                         */
     2311        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2312        4        /*T*                                                         */
     2313        5        /*T***********************************************************/
     2314        6        Z8EL$PARSE_REPLACE : PROC ( REPLACE$,
     2315        7                                    START_LINE,
     2316        8                                    START_COLUMN,
     2317        9                                    END_LINE,
     2318       10                                    END_COLUMN,
     2319       11                                    END_LEVEL,
     2320       12                                    ERROR_IN_REPLACE);
     2321       13
     2322       14    1   DCL REPLACE$ PTR;
     2323       15    1   DCL START_LINE SBIN;
     2324       16    1   DCL START_COLUMN SBIN;
     2325       17    1   DCL END_LINE SBIN;
     2326       18    1   DCL END_COLUMN SBIN;
     2327       19    1   DCL END_LEVEL SBIN;
     2328       20    1   DCL ERROR_IN_REPLACE BIT(1) ALIGNED;
     2329       21
     2330       22        %EQU PHASE=1;
     2331       23        %INCLUDE Z8A_DEFC;
     2332       91        %INCLUDE Z8A_SUPP_MAC;
     2333     2491        %INCLUDE Z8A_COMCOM;
     2334     3141        %INCLUDE Z8E_STACKS;
     2335     5407        %INCLUDE Z8E_HEAP;
     2336     5463        %INCLUDE Z8E_O1COM;
     2337     6224        %INCLUDE Z8E_REPLACE;
     2338     6527        %INCLUDE Z8E_WINDOW;
     2339     8597        %INCLUDE Z8A_ERR_NUMS;
     2340     9361
     2341     9362    1   DCL Z8AE$ERROR ENTRY(12);
     2342     9363    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
     2343     9364    1   DCL Z8EL$GET_REPLACE_TOKENS ENTRY(6) ALTRET;
     2344     9365    1   DCL Z8EL$EXTRACT_PSEUDO_TEXT ENTRY(5);
     2345     9366    1   DCL Z8EL$PROCESS_COPY        ENTRY;
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:570  
     2346     9367
     2347     9368    1   DCL RP$ PTR;
     2348     9369    1   DCL PSEUDO_START_LINE SBIN;
     2349     9370    1   DCL PSEUDO_START_COLUMN SBIN;
     2350     9371    1   DCL PSEUDO_END_LINE SBIN;
     2351     9372    1   DCL PSEUDO_END_COLUMN SBIN;
     2352     9373
     2353     9374        /* Process a replace statement */
     2354     9375
     2355     9376    1   ERROR_IN_REPLACE = FALSE;
     2356     9377    1   START_LINE = LEX_SYMBOL.LINE;
     2357     9378    1   START_COLUMN = LEX_SYMBOL.COLUMN;
     2358     9379
     2359     9380        %NEW_REPLACE_ITEM;
     2360     9393    1   RP$ = REPLACE$;
     2361     9394
     2362     9395        %GET_A_TOKEN_OR_COPY;
     2363     9484
     2364     9485
     2365     9486    2       DO UNTIL LEX_SYMBOL.TYPE = %PERIOD
     2366     9487    2                    OR ERROR_IN_REPLACE;
     2367     9488
     2368     9489
     2369     9490    2         CALL Z8EL$GET_REPLACE_TOKENS (RP$ -> REPLACE_ITEM.FROM_LIST$,
     2370     9491    2                                       RP$ -> REPLACE_ITEM.FROM_IS_PSEUDO_TEXT,
     2371     9492    2                                       PSEUDO_START_LINE,
     2372     9493    2                                       PSEUDO_START_COLUMN,
     2373     9494    2                                       PSEUDO_END_LINE,
     2374     9495    2                                       PSEUDO_END_COLUMN) ALTRET(REP_ERR);
     2375     9496
     2376     9497    2         IF RP$ -> REPLACE_ITEM.FROM_LIST$ = ADDR(NIL) THEN
     2377     9498    3           DO;
     2378     9499    3             CALL Z8AE$ERROR(%E$REPLACE_NULL_SPEC,
     2379     9500    3                             LEX_SYMBOL.LINE,
     2380     9501    3                             LEX_SYMBOL.COLUMN);
     2381     9502                  %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2382     9503                                         TO$   = RP$ -> REPLACE_ITEM.FROM_LIST$);
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:571  
     2383     9518    3             ERROR_IN_REPLACE = TRUE;
     2384     9519    3           END;
     2385     9520    2         ELSE
     2386     9521    2           IF NOT RP$ -> REPLACE_ITEM.FROM_IS_PSEUDO_TEXT
     2387     9522    2             AND SUBSTR(RP$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SYMBOL,
     2388     9523    2                     0,
     2389     9524    2                     RP$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SIZE) = 'OFF'
              9524                              THEN
     2390     9525    3             DO;
     2391     9526    3               IF LEX_SYMBOL.TYPE ~= %PERIOD THEN
     2392     9527    4                 DO;
     2393     9528    4                   CALL Z8AE$ERROR (%E$REPLACE_PERIOD_EXPECTED,
     2394     9529    4                                    LEX_SYMBOL.LINE,
     2395     9530    4                                    LEX_SYMBOL.COLUMN);
     2396     9531    4                   ERROR_IN_REPLACE = TRUE;
     2397     9532    4                 END;
     2398     9533    3             END;
     2399     9534    2           ELSE
     2400     9535    3             DO;  /* get the TO_LIST */
     2401     9536
     2402     9537
     2403     9538    3                IF (SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) ~= 'BY') THEN
     2404     9539    4                 DO;
     2405     9540    4                   CALL Z8AE$ERROR (%E$REPLACE_BY_EXPECTED,
     2406     9541    4                                    LEX_SYMBOL.LINE,
     2407     9542    4                                    LEX_SYMBOL.COLUMN);
     2408     9543    4                   ERROR_IN_REPLACE = TRUE;
     2409     9544    4                 END;
     2410     9545    3               ELSE
     2411     9546    4                 DO;
     2412     9547    4                   O1COM.REPLACE_BY_FLAG = TRUE;
     2413     9548                        /* Get to replace clause */
     2414     9549                        %GET_A_TOKEN_OR_COPY;
     2415     9638    4                   CALL Z8EL$GET_REPLACE_TOKENS (RP$ -> REPLACE_ITEM.TO_LIST$,
     2416     9639    4                                                 RP$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT,
     2417     9640    4                                                 PSEUDO_START_LINE,
     2418     9641    4                                                 PSEUDO_START_COLUMN,
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:572  
     2419     9642    4                                                 PSEUDO_END_LINE,
     2420     9643    4                                                 PSEUDO_END_COLUMN) ALTRET(REP_ERR);
     2421     9644    4                   IF RP$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT THEN
     2422     9645    4                     CALL Z8EL$EXTRACT_PSEUDO_TEXT (RP$ -> REPLACE_ITEM.
              9645                              TO_PSEUDO_TEXT_LINES$,
     2423     9646    4                                                    PSEUDO_START_LINE,
     2424     9647    4                                                    PSEUDO_START_COLUMN,
     2425     9648    4                                                    PSEUDO_END_LINE,
     2426     9649    4                                                    PSEUDO_END_COLUMN);
     2427     9650    4                   O1COM.REPLACE_BY_FLAG = FALSE;
     2428     9651    4                   IF LEX_SYMBOL.TYPE ~= %PERIOD THEN
     2429     9652    5                     DO;
     2430     9653                            %NEW_REPLACE_ITEM(@REPLACE$="RP$ -> REPLACE_ITEM.LINK$");
     2431     9666    5                       RP$ = RP$ -> REPLACE_ITEM.LINK$;
     2432     9667    5                     END;
     2433     9668    4                 END;
     2434     9669    3             END;
     2435     9670
     2436     9671    2       END;   /* DO UNTIL */
     2437     9672
     2438     9673    1   END_LINE = LEX_SYMBOL.END_LINE;
     2439     9674    1   END_COLUMN = LEX_SYMBOL.END_COLUMN;
     2440     9675    1   END_LEVEL = LEX_SYMBOL.LEVEL;
     2441     9676
     2442     9677    1   RETURN;
     2443     9678
     2444     9679        /* Error exit */
     2445     9680
     2446     9681    1   REP_ERR:
     2447     9682    1     ERROR_IN_REPLACE = TRUE;
     2448     9683    1     O1COM.REPLACE_BY_FLAG = FALSE;
     2449     9684    1     O1COM.PSEUDO_TEXT_FLAG = FALSE;
     2450     9685
     2451     9686    1     CALL Z8AE$ERROR (%E$REPLACE_SYNTAX_ERROR,
     2452     9687    1                      LEX_SYMBOL.LINE,
     2453     9688    1                      LEX_SYMBOL.COLUMN);
     2454     9689
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:573  
     2455     9690    1     RETURN;
     2456     9691
     2457     9692    1   END Z8EL$PARSE_REPLACE;
     2458     9693        %EOD;

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:574  
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$PARSE_REPLACE.

   Procedure Z8EL$PARSE_REPLACE requires 457 words for executable code.
   Procedure Z8EL$PARSE_REPLACE requires 22 words of local(AUTO) storage.

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:575  

 Object Unit name= Z8EL$PARSE_REPLACE                         File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:18:58.80 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  HEAP$
    6  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    7  LblCom even  none     1      1  REPLACE_ACTIVE
    8  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    9  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   10  LblCom even  none     4      4  REPLACE_LIST
   11  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   12  RoData even  UTS      3      3  Z8EL$PARSE_REPLACE
   13   Proc  even  none   457    711  Z8EL$PARSE_REPLACE
   14  RoData even  none    28     34  Z8EL$PARSE_REPLACE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        7  Z8EL$PARSE_REPLACE
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:576  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       0 Z8ES$SCANNER
         yes           Std       1 Z8EL$HANDLE_LEVEL_CHANGE
         yes           Std       2 Z8ED$DISPOSE_HEAP
 yes     yes           Std       6 Z8EL$GET_REPLACE_TOKENS
         yes           Std      12 Z8AE$ERROR
         yes           Std       5 Z8EL$EXTRACT_PSEUDO_TEXT
         yes           Std       0 Z8EL$GET_NEXT_SCANNER_LINE
         yes           Std       0 Z8EL$PROCESS_COPY
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:577  


     2309        1        /*T***********************************************************/
     2310        2        /*T*                                                         */
     2311        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2312        4        /*T*                                                         */
     2313        5        /*T***********************************************************/
     2314        6        Z8EL$PARSE_REPLACE : PROC ( REPLACE$,

      6 13 000000   000000 700200 xent  Z8EL$PARSE_* TSX0  ! X66_AUTO_N
        13 000001   000026 000007                    ZERO    22,7

     2315        7                                    START_LINE,
     2316        8                                    START_COLUMN,
     2317        9                                    END_LINE,
     2318       10                                    END_COLUMN,
     2319       11                                    END_LEVEL,
     2320       12                                    ERROR_IN_REPLACE);
     2321       13
     2322       14    1   DCL REPLACE$ PTR;
     2323       15    1   DCL START_LINE SBIN;
     2324       16    1   DCL START_COLUMN SBIN;
     2325       17    1   DCL END_LINE SBIN;
     2326       18    1   DCL END_COLUMN SBIN;
     2327       19    1   DCL END_LEVEL SBIN;
     2328       20    1   DCL ERROR_IN_REPLACE BIT(1) ALIGNED;
     2329       21
     2330       22        %EQU PHASE=1;
     2331       23        %INCLUDE Z8A_DEFC;
     2332       91        %INCLUDE Z8A_SUPP_MAC;
     2333     2491        %INCLUDE Z8A_COMCOM;
     2334     3141        %INCLUDE Z8E_STACKS;
     2335     5407        %INCLUDE Z8E_HEAP;
     2336     5463        %INCLUDE Z8E_O1COM;
     2337     6224        %INCLUDE Z8E_REPLACE;
     2338     6527        %INCLUDE Z8E_WINDOW;
     2339     8597        %INCLUDE Z8A_ERR_NUMS;
     2340     9361
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:578  
     2341     9362    1   DCL Z8AE$ERROR ENTRY(12);
     2342     9363    1   DCL Z8EL$HANDLE_LEVEL_CHANGE ENTRY(1);
     2343     9364    1   DCL Z8EL$GET_REPLACE_TOKENS ENTRY(6) ALTRET;
     2344     9365    1   DCL Z8EL$EXTRACT_PSEUDO_TEXT ENTRY(5);
     2345     9366    1   DCL Z8EL$PROCESS_COPY        ENTRY;
     2346     9367
     2347     9368    1   DCL RP$ PTR;
     2348     9369    1   DCL PSEUDO_START_LINE SBIN;
     2349     9370    1   DCL PSEUDO_START_COLUMN SBIN;
     2350     9371    1   DCL PSEUDO_END_LINE SBIN;
     2351     9372    1   DCL PSEUDO_END_COLUMN SBIN;
     2352     9373
     2353     9374        /* Process a replace statement */
     2354     9375
     2355     9376    1   ERROR_IN_REPLACE = FALSE;

   9376 13 000002   200011 470500                    LDP0    @ERROR_IN_REPLACE,,AUTO
        13 000003   000000 450100                    STZ     0,,PR0

     2356     9377    1   START_LINE = LEX_SYMBOL.LINE;

   9377 13 000004   200004 471500                    LDP1    @START_LINE,,AUTO
        13 000005   000004 235000 1                  LDA     LEX_SYMBOL+4
        13 000006   100000 755100                    STA     0,,PR1

     2357     9378    1   START_COLUMN = LEX_SYMBOL.COLUMN;

   9378 13 000007   200005 473500                    LDP3    @START_COLUMN,,AUTO
        13 000010   000005 236000 1                  LDQ     LEX_SYMBOL+5
        13 000011   300000 756100                    STQ     0,,PR3

     2358     9379
     2359     9380        %NEW_REPLACE_ITEM;

   9382 13 000012   000003 236000 14                 LDQ     3
        13 000013   200003 235100                    LDA     @REPLACE$,,AUTO
        13 000014   200020 757100                    STAQ    PSEUDO_END_COLUMN+2,,AUTO
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:579  
        13 000015   200020 630500                    EPPR0   PSEUDO_END_COLUMN+2,,AUTO
        13 000016   000001 631400 14                 EPPR1   1
        13 000017   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        13 000020   000000 011000                    NOP     0

   9384 13 000021   200003 470500                    LDP0    @REPLACE$,,AUTO
        13 000022   000000 471500                    LDP1    0,,PR0
        13 000023   000000 236000 14                 LDQ     0
        13 000024   100001 756100                    STQ     1,,PR1

   9385 13 000025   000000 471500                    LDP1    0,,PR0
        13 000026   100002 756100                    STQ     2,,PR1

   9386 13 000027   000000 471500                    LDP1    0,,PR0
        13 000030   100003 450100                    STZ     3,,PR1

   9387 13 000031   000000 471500                    LDP1    0,,PR0
        13 000032   100000 756100                    STQ     0,,PR1

   9388 13 000033   000000 471500                    LDP1    0,,PR0
        13 000034   100005 450100                    STZ     5,,PR1

   9389 13 000035   000000 471500                    LDP1    0,,PR0
        13 000036   100004 450100                    STZ     4,,PR1

   9390 13 000037   000000 471500                    LDP1    0,,PR0
        13 000040   000000 236000 14                 LDQ     0
        13 000041   100006 756100                    STQ     6,,PR1

     2360     9393    1   RP$ = REPLACE$;

   9393 13 000042   000000 236100                    LDQ     0,,PR0
        13 000043   200012 756100                    STQ     RP$,,AUTO

     2361     9394
     2362     9395        %GET_A_TOKEN_OR_COPY;

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:580  
   9404 13 000044   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        13 000045   000000 116000 14                 CMPQ    0
        13 000046   000104 600000 13                 TZE     s:9427

   9410 13 000047   000000 471400 11                 LDP1    LEX_SYMBOL_QUEUE$
        13 000050   100010 235100                    LDA     8,,PR1
        13 000051   000010 755000 1                  STA     LEX_SYMBOL+8

   9411 13 000052   100010 720100                    LXL0    8,,PR1
        13 000053   000044 621010                    EAX1    36,X0
        13 000054   000044 622005                    EAX2    36,AL
        13 000055   000040 100540                    MLR     fill='000'O
        13 000056   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        13 000057   000000 000012 1                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

   9414 13 000060   100010 720100                    LXL0    8,,PR1
        13 000061   000044 621010                    EAX1    36,X0
        13 000062   000000 636011                    EAQ     0,X1
        13 000063   000022 732000                    QRS     18
        13 000064   000003 036007                    ADLQ    3,DL
        13 000065   000004 506007                    DIV     4,DL
        13 000066   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000067   200020 633500                    EPPR3   PSEUDO_END_COLUMN+2,,AUTO
        13 000070   200023 453500                    STP3    PSEUDO_END_COLUMN+5,,AUTO
        13 000071   000004 236000 14                 LDQ     4
        13 000072   200022 756100                    STQ     PSEUDO_END_COLUMN+4,,AUTO
        13 000073   200022 630500                    EPPR0   PSEUDO_END_COLUMN+4,,AUTO
        13 000074   000001 631400 14                 EPPR1   1
        13 000075   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        13 000076   000000 011000                    NOP     0

   9419 13 000077   000000 236000 1                  LDQ     LEX_SYMBOL
        13 000100   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

   9420 13 000101   000000 236000 14                 LDQ     0
        13 000102   000000 756000 1                  STQ     LEX_SYMBOL

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:581  
   9421 13 000103   000133 710000 13                 TRA     s:9440

   9427 13 000104   000005 631400 14                 EPPR1   5
        13 000105   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000106   000000 011000                    NOP     0

   9428 13 000107   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000110   000121 601000 13                 TNZ     s:9434

   9429 13 000111   000005 631400 14                 EPPR1   5
        13 000112   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        13 000113   000000 011000                    NOP     0

   9430 13 000114   000005 631400 14                 EPPR1   5
        13 000115   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000116   000000 011000                    NOP     0

   9431 13 000117   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000120   000111 600000 13                 TZE     s:9429

   9434 13 000121   000003 236000 1                  LDQ     LEX_SYMBOL+3
        13 000122   000000 116000 6                  CMPQ    CURRENT_SYMBOL_LEVEL
        13 000123   000133 600000 13                 TZE     s:9440
        13 000124   000002 236000 1                  LDQ     LEX_SYMBOL+2
        13 000125   200000 316003                    CANQ    65536,DU
        13 000126   000133 601000 13                 TNZ     s:9440

   9436 13 000127   000007 630400 14                 EPPR0   7
        13 000130   000006 631400 14                 EPPR1   6
        13 000131   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        13 000132   000000 011000                    NOP     0

   9440 13 000133   000010 235000 1                  LDA     LEX_SYMBOL+8
        13 000134   000004 115007                    CMPA    4,DL
        13 000135   000233 601000 13                 TNZ     s:9490
        13 000136   000011 236000 1                  LDQ     LEX_SYMBOL+9
        13 000137   000000 116000 12                 CMPQ    0
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:582  
        13 000140   000233 601000 13                 TNZ     s:9490

   9442 13 000141   000005 631400 14                 EPPR1   5
        13 000142   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        13 000143   000000 011000                    NOP     0

   9445 13 000144   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        13 000145   000000 116000 14                 CMPQ    0
        13 000146   000204 600000 13                 TZE     s:9468

   9451 13 000147   000000 470400 11                 LDP0    LEX_SYMBOL_QUEUE$
        13 000150   000010 235100                    LDA     8,,PR0
        13 000151   000010 755000 1                  STA     LEX_SYMBOL+8

   9452 13 000152   000010 720100                    LXL0    8,,PR0
        13 000153   000044 621010                    EAX1    36,X0
        13 000154   000044 622005                    EAX2    36,AL
        13 000155   000040 100540                    MLR     fill='000'O
        13 000156   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        13 000157   000000 000012 1                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

   9455 13 000160   000010 720100                    LXL0    8,,PR0
        13 000161   000044 621010                    EAX1    36,X0
        13 000162   000000 636011                    EAQ     0,X1
        13 000163   000022 732000                    QRS     18
        13 000164   000003 036007                    ADLQ    3,DL
        13 000165   000004 506007                    DIV     4,DL
        13 000166   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000167   200020 631500                    EPPR1   PSEUDO_END_COLUMN+2,,AUTO
        13 000170   200023 451500                    STP1    PSEUDO_END_COLUMN+5,,AUTO
        13 000171   000004 236000 14                 LDQ     4
        13 000172   200022 756100                    STQ     PSEUDO_END_COLUMN+4,,AUTO
        13 000173   200022 630500                    EPPR0   PSEUDO_END_COLUMN+4,,AUTO
        13 000174   000001 631400 14                 EPPR1   1
        13 000175   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        13 000176   000000 011000                    NOP     0

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:583  
   9460 13 000177   000000 236000 1                  LDQ     LEX_SYMBOL
        13 000200   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

   9461 13 000201   000000 236000 14                 LDQ     0
        13 000202   000000 756000 1                  STQ     LEX_SYMBOL

   9462 13 000203   000233 710000 13                 TRA     s:9490

   9468 13 000204   000005 631400 14                 EPPR1   5
        13 000205   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000206   000000 011000                    NOP     0

   9469 13 000207   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000210   000221 601000 13                 TNZ     s:9475

   9470 13 000211   000005 631400 14                 EPPR1   5
        13 000212   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        13 000213   000000 011000                    NOP     0

   9471 13 000214   000005 631400 14                 EPPR1   5
        13 000215   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000216   000000 011000                    NOP     0

   9472 13 000217   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000220   000211 600000 13                 TZE     s:9470

   9475 13 000221   000003 236000 1                  LDQ     LEX_SYMBOL+3
        13 000222   000000 116000 6                  CMPQ    CURRENT_SYMBOL_LEVEL
        13 000223   000233 600000 13                 TZE     s:9490
        13 000224   000002 236000 1                  LDQ     LEX_SYMBOL+2
        13 000225   200000 316003                    CANQ    65536,DU
        13 000226   000233 601000 13                 TNZ     s:9490

   9477 13 000227   000007 630400 14                 EPPR0   7
        13 000230   000006 631400 14                 EPPR1   6
        13 000231   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        13 000232   000000 011000                    NOP     0
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:584  

     2363     9484
     2364     9485
     2365     9486    2       DO UNTIL LEX_SYMBOL.TYPE = %PERIOD

     2366     9487    2                    OR ERROR_IN_REPLACE;
     2367     9488
     2368     9489
     2369     9490    2         CALL Z8EL$GET_REPLACE_TOKENS (RP$ -> REPLACE_ITEM.FROM_LIST$,

   9490 13 000233   200016 630500                    EPPR0   PSEUDO_END_COLUMN,,AUTO
        13 000234   200025 450500                    STP0    PSEUDO_END_COLUMN+7,,AUTO
        13 000235   200015 631500                    EPPR1   PSEUDO_END_LINE,,AUTO
        13 000236   200024 451500                    STP1    PSEUDO_END_COLUMN+6,,AUTO
        13 000237   200014 633500                    EPPR3   PSEUDO_START_COLUMN,,AUTO
        13 000240   200023 453500                    STP3    PSEUDO_END_COLUMN+5,,AUTO
        13 000241   200013 634500                    EPPR4   PSEUDO_START_LINE,,AUTO
        13 000242   200022 454500                    STP4    PSEUDO_END_COLUMN+4,,AUTO
        13 000243   200012 236100                    LDQ     RP$,,AUTO
        13 000244   000004 036003                    ADLQ    4,DU
        13 000245   200021 756100                    STQ     PSEUDO_END_COLUMN+3,,AUTO
        13 000246   200012 236100                    LDQ     RP$,,AUTO
        13 000247   000001 036003                    ADLQ    1,DU
        13 000250   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000251   200020 630500                    EPPR0   PSEUDO_END_COLUMN+2,,AUTO
        13 000252   000010 631400 14                 EPPR1   8
        13 000253   000000 701000 xent               TSX1    Z8EL$GET_REPLACE_TOKENS
        13 000254   000676 702000 13                 TSX2    REP_ERR

     2370     9491    2                                       RP$ -> REPLACE_ITEM.FROM_IS_PSEUDO_TEXT,
     2371     9492    2                                       PSEUDO_START_LINE,
     2372     9493    2                                       PSEUDO_START_COLUMN,
     2373     9494    2                                       PSEUDO_END_LINE,
     2374     9495    2                                       PSEUDO_END_COLUMN) ALTRET(REP_ERR);
     2375     9496
     2376     9497    2         IF RP$ -> REPLACE_ITEM.FROM_LIST$ = ADDR(NIL) THEN

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:585  
   9497 13 000255   200012 470500                    LDP0    RP$,,AUTO
        13 000256   000001 236100                    LDQ     1,,PR0
        13 000257   000000 116000 14                 CMPQ    0
        13 000260   000322 601000 13                 TNZ     s:9521

     2377     9498    3           DO;

     2378     9499    3             CALL Z8AE$ERROR(%E$REPLACE_NULL_SPEC,

   9499 13 000261   000013 630400 14                 EPPR0   11
        13 000262   000011 631400 14                 EPPR1   9
        13 000263   000000 701000 xent               TSX1    Z8AE$ERROR
        13 000264   000000 011000                    NOP     0

     2379     9500    3                             LEX_SYMBOL.LINE,
     2380     9501    3                             LEX_SYMBOL.COLUMN);
     2381     9502                  %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2382     9503                                         TO$   = RP$ -> REPLACE_ITEM.FROM_LIST$);

   9505 13 000265   000010 236000 1                  LDQ     LEX_SYMBOL+8
        13 000266   000047 036007                    ADLQ    39,DL
        13 000267   000004 506007                    DIV     4,DL
        13 000270   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000271   200020 630500                    EPPR0   PSEUDO_END_COLUMN+2,,AUTO
        13 000272   200023 450500                    STP0    PSEUDO_END_COLUMN+5,,AUTO
        13 000273   200012 236100                    LDQ     RP$,,AUTO
        13 000274   000001 036003                    ADLQ    1,DU
        13 000275   200022 756100                    STQ     PSEUDO_END_COLUMN+4,,AUTO
        13 000276   200022 630500                    EPPR0   PSEUDO_END_COLUMN+4,,AUTO
        13 000277   000001 631400 14                 EPPR1   1
        13 000300   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        13 000301   000000 011000                    NOP     0

   9512 13 000302   200012 470500                    LDP0    RP$,,AUTO
        13 000303   000001 471500                    LDP1    1,,PR0
        13 000304   000010 235000 1                  LDA     LEX_SYMBOL+8
        13 000305   100010 755100                    STA     8,,PR1
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:586  

   9513 13 000306   000001 471500                    LDP1    1,,PR0
        13 000307   100010 720100                    LXL0    8,,PR1
        13 000310   000044 621010                    EAX1    36,X0
        13 000311   000010 722000 1                  LXL2    LEX_SYMBOL+8
        13 000312   000044 623012                    EAX3    36,X2
        13 000313   000140 100440                    MLR     fill='000'O
        13 000314   000000 000013 1                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        13 000315   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2383     9518    3             ERROR_IN_REPLACE = TRUE;

   9518 13 000316   400000 236003                    LDQ     -131072,DU
        13 000317   200011 471500                    LDP1    @ERROR_IN_REPLACE,,AUTO
        13 000320   100000 756100                    STQ     0,,PR1

     2384     9519    3           END;

   9519 13 000321   000656 710000 13                 TRA     s:9671

     2385     9520    2         ELSE
     2386     9521    2           IF NOT RP$ -> REPLACE_ITEM.FROM_IS_PSEUDO_TEXT

   9521 13 000322   000004 234100                    SZN     4,,PR0
        13 000323   000345 604000 13                 TMI     s:9538
        13 000324   000001 471500                    LDP1    1,,PR0
        13 000325   100010 720100                    LXL0    8,,PR1
        13 000326   040000 106540                    CMPC    fill='040'O
        13 000327   100011 000010                    ADSC9   9,,PR1                   cn=0,n=*X0
        13 000330   000001 000003 12                 ADSC9   1                        cn=0,n=3
        13 000331   000345 601000 13                 TNZ     s:9538

     2387     9522    2             AND SUBSTR(RP$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SYMBOL,
     2388     9523    2                     0,
     2389     9524    2                     RP$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SIZE) = 'OFF'
              9524                              THEN
     2390     9525    3             DO;
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:587  

     2391     9526    3               IF LEX_SYMBOL.TYPE ~= %PERIOD THEN

   9526 13 000332   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000333   000014 115007                    CMPA    12,DL
        13 000334   000656 600000 13                 TZE     s:9671

     2392     9527    4                 DO;

     2393     9528    4                   CALL Z8AE$ERROR (%E$REPLACE_PERIOD_EXPECTED,

   9528 13 000335   000017 630400 14                 EPPR0   15
        13 000336   000011 631400 14                 EPPR1   9
        13 000337   000000 701000 xent               TSX1    Z8AE$ERROR
        13 000340   000000 011000                    NOP     0

     2394     9529    4                                    LEX_SYMBOL.LINE,
     2395     9530    4                                    LEX_SYMBOL.COLUMN);
     2396     9531    4                   ERROR_IN_REPLACE = TRUE;

   9531 13 000341   400000 236003                    LDQ     -131072,DU
        13 000342   200011 470500                    LDP0    @ERROR_IN_REPLACE,,AUTO
        13 000343   000000 756100                    STQ     0,,PR0

     2397     9532    4                 END;

     2398     9533    3             END;

   9533 13 000344   000656 710000 13                 TRA     s:9671

     2399     9534    2           ELSE
     2400     9535    3             DO;  /* get the TO_LIST */

     2401     9536
     2402     9537
     2403     9538    3                IF (SUBSTR(LEX_SYMBOL.SYMBOL, 0, LEX_SYMBOL.SIZE) ~= 'BY') THEN

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:588  
   9538 13 000345   000010 720000 1                  LXL0    LEX_SYMBOL+8
        13 000346   040000 106440                    CMPC    fill='040'O
        13 000347   000011 000010 1                  ADSC9   LEX_SYMBOL+9             cn=0,n=*X0
        13 000350   000002 000002 12                 ADSC9   2                        cn=0,n=2
        13 000351   000362 600000 13                 TZE     s:9547

     2404     9539    4                 DO;

     2405     9540    4                   CALL Z8AE$ERROR (%E$REPLACE_BY_EXPECTED,

   9540 13 000352   000023 630400 14                 EPPR0   19
        13 000353   000011 631400 14                 EPPR1   9
        13 000354   000000 701000 xent               TSX1    Z8AE$ERROR
        13 000355   000000 011000                    NOP     0

     2406     9541    4                                    LEX_SYMBOL.LINE,
     2407     9542    4                                    LEX_SYMBOL.COLUMN);
     2408     9543    4                   ERROR_IN_REPLACE = TRUE;

   9543 13 000356   400000 236003                    LDQ     -131072,DU
        13 000357   200011 470500                    LDP0    @ERROR_IN_REPLACE,,AUTO
        13 000360   000000 756100                    STQ     0,,PR0

     2409     9544    4                 END;

   9544 13 000361   000656 710000 13                 TRA     s:9671

     2410     9545    3               ELSE
     2411     9546    4                 DO;

     2412     9547    4                   O1COM.REPLACE_BY_FLAG = TRUE;

   9547 13 000362   200000 236003                    LDQ     65536,DU
        13 000363   001337 256000 xsym               ORSQ    O1COM+735

     2413     9548                        /* Get to replace clause */
     2414     9549                        %GET_A_TOKEN_OR_COPY;
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:589  

   9558 13 000364   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        13 000365   000000 116000 14                 CMPQ    0
        13 000366   000424 600000 13                 TZE     s:9581

   9564 13 000367   000000 471400 11                 LDP1    LEX_SYMBOL_QUEUE$
        13 000370   100010 235100                    LDA     8,,PR1
        13 000371   000010 755000 1                  STA     LEX_SYMBOL+8

   9565 13 000372   100010 720100                    LXL0    8,,PR1
        13 000373   000044 621010                    EAX1    36,X0
        13 000374   000044 622005                    EAX2    36,AL
        13 000375   000040 100540                    MLR     fill='000'O
        13 000376   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        13 000377   000000 000012 1                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

   9568 13 000400   100010 720100                    LXL0    8,,PR1
        13 000401   000044 621010                    EAX1    36,X0
        13 000402   000000 636011                    EAQ     0,X1
        13 000403   000022 732000                    QRS     18
        13 000404   000003 036007                    ADLQ    3,DL
        13 000405   000004 506007                    DIV     4,DL
        13 000406   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000407   200020 633500                    EPPR3   PSEUDO_END_COLUMN+2,,AUTO
        13 000410   200023 453500                    STP3    PSEUDO_END_COLUMN+5,,AUTO
        13 000411   000004 236000 14                 LDQ     4
        13 000412   200022 756100                    STQ     PSEUDO_END_COLUMN+4,,AUTO
        13 000413   200022 630500                    EPPR0   PSEUDO_END_COLUMN+4,,AUTO
        13 000414   000001 631400 14                 EPPR1   1
        13 000415   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        13 000416   000000 011000                    NOP     0

   9573 13 000417   000000 236000 1                  LDQ     LEX_SYMBOL
        13 000420   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

   9574 13 000421   000000 236000 14                 LDQ     0
        13 000422   000000 756000 1                  STQ     LEX_SYMBOL
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:590  

   9575 13 000423   000453 710000 13                 TRA     s:9594

   9581 13 000424   000005 631400 14                 EPPR1   5
        13 000425   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000426   000000 011000                    NOP     0

   9582 13 000427   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000430   000441 601000 13                 TNZ     s:9588

   9583 13 000431   000005 631400 14                 EPPR1   5
        13 000432   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        13 000433   000000 011000                    NOP     0

   9584 13 000434   000005 631400 14                 EPPR1   5
        13 000435   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000436   000000 011000                    NOP     0

   9585 13 000437   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000440   000431 600000 13                 TZE     s:9583

   9588 13 000441   000003 236000 1                  LDQ     LEX_SYMBOL+3
        13 000442   000000 116000 6                  CMPQ    CURRENT_SYMBOL_LEVEL
        13 000443   000453 600000 13                 TZE     s:9594
        13 000444   000002 236000 1                  LDQ     LEX_SYMBOL+2
        13 000445   200000 316003                    CANQ    65536,DU
        13 000446   000453 601000 13                 TNZ     s:9594

   9590 13 000447   000007 630400 14                 EPPR0   7
        13 000450   000006 631400 14                 EPPR1   6
        13 000451   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
        13 000452   000000 011000                    NOP     0

   9594 13 000453   000010 235000 1                  LDA     LEX_SYMBOL+8
        13 000454   000004 115007                    CMPA    4,DL
        13 000455   000553 601000 13                 TNZ     s:9638
        13 000456   000011 236000 1                  LDQ     LEX_SYMBOL+9
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:591  
        13 000457   000000 116000 12                 CMPQ    0
        13 000460   000553 601000 13                 TNZ     s:9638

   9596 13 000461   000005 631400 14                 EPPR1   5
        13 000462   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        13 000463   000000 011000                    NOP     0

   9599 13 000464   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        13 000465   000000 116000 14                 CMPQ    0
        13 000466   000524 600000 13                 TZE     s:9622

   9605 13 000467   000000 470400 11                 LDP0    LEX_SYMBOL_QUEUE$
        13 000470   000010 235100                    LDA     8,,PR0
        13 000471   000010 755000 1                  STA     LEX_SYMBOL+8

   9606 13 000472   000010 720100                    LXL0    8,,PR0
        13 000473   000044 621010                    EAX1    36,X0
        13 000474   000044 622005                    EAX2    36,AL
        13 000475   000040 100540                    MLR     fill='000'O
        13 000476   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        13 000477   000000 000012 1                  ADSC9   LEX_SYMBOL               cn=0,n=*X2

   9609 13 000500   000010 720100                    LXL0    8,,PR0
        13 000501   000044 621010                    EAX1    36,X0
        13 000502   000000 636011                    EAQ     0,X1
        13 000503   000022 732000                    QRS     18
        13 000504   000003 036007                    ADLQ    3,DL
        13 000505   000004 506007                    DIV     4,DL
        13 000506   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000507   200020 631500                    EPPR1   PSEUDO_END_COLUMN+2,,AUTO
        13 000510   200023 451500                    STP1    PSEUDO_END_COLUMN+5,,AUTO
        13 000511   000004 236000 14                 LDQ     4
        13 000512   200022 756100                    STQ     PSEUDO_END_COLUMN+4,,AUTO
        13 000513   200022 630500                    EPPR0   PSEUDO_END_COLUMN+4,,AUTO
        13 000514   000001 631400 14                 EPPR1   1
        13 000515   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        13 000516   000000 011000                    NOP     0
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:592  

   9614 13 000517   000000 236000 1                  LDQ     LEX_SYMBOL
        13 000520   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

   9615 13 000521   000000 236000 14                 LDQ     0
        13 000522   000000 756000 1                  STQ     LEX_SYMBOL

   9616 13 000523   000553 710000 13                 TRA     s:9638

   9622 13 000524   000005 631400 14                 EPPR1   5
        13 000525   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000526   000000 011000                    NOP     0

   9623 13 000527   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000530   000541 601000 13                 TNZ     s:9629

   9624 13 000531   000005 631400 14                 EPPR1   5
        13 000532   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        13 000533   000000 011000                    NOP     0

   9625 13 000534   000005 631400 14                 EPPR1   5
        13 000535   000000 701000 xent               TSX1    Z8ES$SCANNER
        13 000536   000000 011000                    NOP     0

   9626 13 000537   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000540   000531 600000 13                 TZE     s:9624

   9629 13 000541   000003 236000 1                  LDQ     LEX_SYMBOL+3
        13 000542   000000 116000 6                  CMPQ    CURRENT_SYMBOL_LEVEL
        13 000543   000553 600000 13                 TZE     s:9638
        13 000544   000002 236000 1                  LDQ     LEX_SYMBOL+2
        13 000545   200000 316003                    CANQ    65536,DU
        13 000546   000553 601000 13                 TNZ     s:9638

   9631 13 000547   000007 630400 14                 EPPR0   7
        13 000550   000006 631400 14                 EPPR1   6
        13 000551   000000 701000 xent               TSX1    Z8EL$HANDLE_LEVEL_CHANGE
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:593  
        13 000552   000000 011000                    NOP     0

     2415     9638    4                   CALL Z8EL$GET_REPLACE_TOKENS (RP$ -> REPLACE_ITEM.TO_LIST$,

   9638 13 000553   200016 630500                    EPPR0   PSEUDO_END_COLUMN,,AUTO
        13 000554   200025 450500                    STP0    PSEUDO_END_COLUMN+7,,AUTO
        13 000555   200015 631500                    EPPR1   PSEUDO_END_LINE,,AUTO
        13 000556   200024 451500                    STP1    PSEUDO_END_COLUMN+6,,AUTO
        13 000557   200014 633500                    EPPR3   PSEUDO_START_COLUMN,,AUTO
        13 000560   200023 453500                    STP3    PSEUDO_END_COLUMN+5,,AUTO
        13 000561   200013 634500                    EPPR4   PSEUDO_START_LINE,,AUTO
        13 000562   200022 454500                    STP4    PSEUDO_END_COLUMN+4,,AUTO
        13 000563   200012 236100                    LDQ     RP$,,AUTO
        13 000564   000005 036003                    ADLQ    5,DU
        13 000565   200021 756100                    STQ     PSEUDO_END_COLUMN+3,,AUTO
        13 000566   200012 236100                    LDQ     RP$,,AUTO
        13 000567   000002 036003                    ADLQ    2,DU
        13 000570   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000571   200020 630500                    EPPR0   PSEUDO_END_COLUMN+2,,AUTO
        13 000572   000010 631400 14                 EPPR1   8
        13 000573   000000 701000 xent               TSX1    Z8EL$GET_REPLACE_TOKENS
        13 000574   000676 702000 13                 TSX2    REP_ERR

     2416     9639    4                                                RP$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT,
     2417     9640    4                                                 PSEUDO_START_LINE,
     2418     9641    4                                                 PSEUDO_START_COLUMN,
     2419     9642    4                                                 PSEUDO_END_LINE,
     2420     9643    4                                                 PSEUDO_END_COLUMN) ALTRET(REP_ERR);
     2421     9644    4                   IF RP$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT THEN

   9644 13 000575   200012 470500                    LDP0    RP$,,AUTO
        13 000576   000005 234100                    SZN     5,,PR0
        13 000577   000617 605000 13                 TPL     s:9650

     2422     9645    4                     CALL Z8EL$EXTRACT_PSEUDO_TEXT (RP$ -> REPLACE_ITEM.
              9645                              TO_PSEUDO_TEXT_LINES$,

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:594  
   9645 13 000600   200016 631500                    EPPR1   PSEUDO_END_COLUMN,,AUTO
        13 000601   200024 451500                    STP1    PSEUDO_END_COLUMN+6,,AUTO
        13 000602   200015 633500                    EPPR3   PSEUDO_END_LINE,,AUTO
        13 000603   200023 453500                    STP3    PSEUDO_END_COLUMN+5,,AUTO
        13 000604   200014 634500                    EPPR4   PSEUDO_START_COLUMN,,AUTO
        13 000605   200022 454500                    STP4    PSEUDO_END_COLUMN+4,,AUTO
        13 000606   200013 635500                    EPPR5   PSEUDO_START_LINE,,AUTO
        13 000607   200021 455500                    STP5    PSEUDO_END_COLUMN+3,,AUTO
        13 000610   200012 236100                    LDQ     RP$,,AUTO
        13 000611   000006 036003                    ADLQ    6,DU
        13 000612   200020 756100                    STQ     PSEUDO_END_COLUMN+2,,AUTO
        13 000613   200020 630500                    EPPR0   PSEUDO_END_COLUMN+2,,AUTO
        13 000614   000026 631400 14                 EPPR1   22
        13 000615   000000 701000 xent               TSX1    Z8EL$EXTRACT_PSEUDO_TEXT
        13 000616   000000 011000                    NOP     0

     2423     9646    4                                                    PSEUDO_START_LINE,
     2424     9647    4                                                    PSEUDO_START_COLUMN,
     2425     9648    4                                                    PSEUDO_END_LINE,
     2426     9649    4                                                    PSEUDO_END_COLUMN);
     2427     9650    4                   O1COM.REPLACE_BY_FLAG = FALSE;

   9650 13 000617   000027 236000 14                 LDQ     23
        13 000620   001337 356000 xsym               ANSQ    O1COM+735

     2428     9651    4                   IF LEX_SYMBOL.TYPE ~= %PERIOD THEN

   9651 13 000621   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000622   000014 115007                    CMPA    12,DL
        13 000623   000656 600000 13                 TZE     s:9671

     2429     9652    5                     DO;

     2430     9653                            %NEW_REPLACE_ITEM(@REPLACE$="RP$ -> REPLACE_ITEM.LINK$");

   9655 13 000624   000003 236000 14                 LDQ     3
        13 000625   200012 235100                    LDA     RP$,,AUTO
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:595  
        13 000626   200020 757100                    STAQ    PSEUDO_END_COLUMN+2,,AUTO
        13 000627   200020 630500                    EPPR0   PSEUDO_END_COLUMN+2,,AUTO
        13 000630   000001 631400 14                 EPPR1   1
        13 000631   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        13 000632   000000 011000                    NOP     0

   9657 13 000633   200012 470500                    LDP0    RP$,,AUTO
        13 000634   000000 471500                    LDP1    0,,PR0
        13 000635   000000 236000 14                 LDQ     0
        13 000636   100001 756100                    STQ     1,,PR1

   9658 13 000637   000000 471500                    LDP1    0,,PR0
        13 000640   100002 756100                    STQ     2,,PR1

   9659 13 000641   000000 471500                    LDP1    0,,PR0
        13 000642   100003 450100                    STZ     3,,PR1

   9660 13 000643   000000 471500                    LDP1    0,,PR0
        13 000644   100000 756100                    STQ     0,,PR1

   9661 13 000645   000000 471500                    LDP1    0,,PR0
        13 000646   100005 450100                    STZ     5,,PR1

   9662 13 000647   000000 471500                    LDP1    0,,PR0
        13 000650   100004 450100                    STZ     4,,PR1

   9663 13 000651   000000 471500                    LDP1    0,,PR0
        13 000652   000000 236000 14                 LDQ     0
        13 000653   100006 756100                    STQ     6,,PR1

     2431     9666    5                       RP$ = RP$ -> REPLACE_ITEM.LINK$;

   9666 13 000654   000000 236100                    LDQ     0,,PR0
        13 000655   200012 756100                    STQ     RP$,,AUTO

     2432     9667    5                     END;

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:596  
     2433     9668    4                 END;

     2434     9669    3             END;

     2435     9670
     2436     9671    2       END;   /* DO UNTIL */

   9671 13 000656   000001 235000 1                  LDA     LEX_SYMBOL+1
        13 000657   000014 115007                    CMPA    12,DL
        13 000660   000664 600000 13                 TZE     s:9673
        13 000661   200011 470500                    LDP0    @ERROR_IN_REPLACE,,AUTO
        13 000662   000000 234100                    SZN     0,,PR0
        13 000663   000233 605000 13                 TPL     s:9490

     2437     9672
     2438     9673    1   END_LINE = LEX_SYMBOL.END_LINE;

   9673 13 000664   200006 470500                    LDP0    @END_LINE,,AUTO
        13 000665   000006 236000 1                  LDQ     LEX_SYMBOL+6
        13 000666   000000 756100                    STQ     0,,PR0

     2439     9674    1   END_COLUMN = LEX_SYMBOL.END_COLUMN;

   9674 13 000667   200007 471500                    LDP1    @END_COLUMN,,AUTO
        13 000670   000007 235000 1                  LDA     LEX_SYMBOL+7
        13 000671   100000 755100                    STA     0,,PR1

     2440     9675    1   END_LEVEL = LEX_SYMBOL.LEVEL;

   9675 13 000672   200010 473500                    LDP3    @END_LEVEL,,AUTO
        13 000673   000003 236000 1                  LDQ     LEX_SYMBOL+3
        13 000674   300000 756100                    STQ     0,,PR3

     2441     9676
     2442     9677    1   RETURN;

   9677 13 000675   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:597  

     2443     9678
     2444     9679        /* Error exit */
     2445     9680
     2446     9681    1   REP_ERR:
     2447     9682    1     ERROR_IN_REPLACE = TRUE;

   9682 13 000676   400000 236003       REP_ERR      LDQ     -131072,DU
        13 000677   200011 470500                    LDP0    @ERROR_IN_REPLACE,,AUTO
        13 000700   000000 756100                    STQ     0,,PR0

     2448     9683    1     O1COM.REPLACE_BY_FLAG = FALSE;

   9683 13 000701   000027 236000 14                 LDQ     23
        13 000702   001337 356000 xsym               ANSQ    O1COM+735

     2449     9684    1     O1COM.PSEUDO_TEXT_FLAG = FALSE;

   9684 13 000703   001330 450000 xsym               STZ     O1COM+728

     2450     9685
     2451     9686    1     CALL Z8AE$ERROR (%E$REPLACE_SYNTAX_ERROR,

   9686 13 000704   000031 630400 14                 EPPR0   25
        13 000705   000011 631400 14                 EPPR1   9
        13 000706   000000 701000 xent               TSX1    Z8AE$ERROR
        13 000707   000000 011000                    NOP     0

     2452     9687    1                      LEX_SYMBOL.LINE,
     2453     9688    1                      LEX_SYMBOL.COLUMN);
     2454     9689
     2455     9690    1     RETURN;

   9690 13 000710   000000 702200 xent               TSX2  ! X66_ARET
     2456     9691
     2457     9692    1   END Z8EL$PARSE_REPLACE;
     2458     9693        %EOD;
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:598  

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:599  
--  Include file information  --

   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$PARSE_REPLACE.
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:600  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:601  
  ****  Section 005 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 006 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CURRENT_SYMBOL_LEVEL

  ****  Section 007 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 008 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 009 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 010 LblCom REPLACE_LIST

PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:602  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 011 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LEX_SYMBOL_QUEUE$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @END_COLUMN               10-0-0/w PTR         r     1 @END_LEVEL
     6-0-0/w PTR         r     1 @END_LINE                 11-0-0/w PTR         r     1 @ERROR_IN_REPLACE
     3-0-0/w PTR         r     1 @REPLACE$                  5-0-0/w PTR         r     1 @START_COLUMN
     4-0-0/w PTR         r     1 @START_LINE               *0-0-0/w SBIN        r     1 END_COLUMN
    *0-0-0/w SBIN        r     1 END_LEVEL                 *0-0-0/w SBIN        r     1 END_LINE
    *0-0-0/w BIT         r     1 ERROR_IN_REPLACE          16-0-0/w SBIN        r     1 PSEUDO_END_COLUMN
    15-0-0/w SBIN        r     1 PSEUDO_END_LINE           14-0-0/w SBIN        r     1 PSEUDO_START_COLUMN
    13-0-0/w SBIN        r     1 PSEUDO_START_LINE         *0-0-0/w PTR         r     1 REPLACE$
    12-0-0/w PTR         r     1 RP$                       *0-0-0/w SBIN        r     1 START_COLUMN
    *0-0-0/w SBIN        r     1 START_LINE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248)       1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/d STRC(11580) r     1 O1COM
     0-0-0/w STRC(144)         1 PAGE_FORMAT                0-0-0/w STRC(153)         1 REP_STK(0:50)
PL6.E3A0      #016=Z8EL$PARSE_REPLACE File=Z8EL.:Z8A6TSI                         SAT 08/09/97 12:18 Page:603  
     0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(288)         1 CALL_STMT
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(252)   r     1 REPLACE_ITEM               0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$PARSE_REPLACE requires 457 words for executable code.
   Procedure Z8EL$PARSE_REPLACE requires 22 words of local(AUTO) storage.

PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:604  
     2459        1        /*T***********************************************************/
     2460        2        /*T*                                                         */
     2461        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2462        4        /*T*                                                         */
     2463        5        /*T***********************************************************/
     2464        6        Z8EL$HANDLE_LEVEL_CHANGE : PROC (NEW_LEVEL);
     2465        7
     2466        8    1   DCL NEW_LEVEL SBIN;
     2467        9
     2468       10        %EQU PHASE = 1;
     2469       11        %INCLUDE Z8A_DEFC;
     2470       79        %INCLUDE Z8A_SUPP_MAC;
     2471     2479        %INCLUDE Z8E_REPLACE;
     2472     2782
     2473     2783    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     2474     2784
     2475     2785    1     IF NEW_LEVEL > CURRENT_SYMBOL_LEVEL THEN
     2476     2786    1       CURRENT_SYMBOL_LEVEL = NEW_LEVEL;
     2477     2787    1     ELSE
     2478     2788    2       DO WHILE NEW_LEVEL < CURRENT_SYMBOL_LEVEL;
     2479     2789              /* DELETE REPLACE DATA DOWN TO CURRENT LEVEL */
     2480     2790    2         CALL Z8EL$DELETE_REPLACE_LEVEL (CURRENT_SYMBOL_LEVEL);
     2481     2791    2         CURRENT_SYMBOL_LEVEL = CURRENT_SYMBOL_LEVEL - 1;
     2482     2792    2       END;
     2483     2793
     2484     2794    1     RETURN;
     2485     2795
     2486     2796
     2487     2797    1   END Z8EL$HANDLE_LEVEL_CHANGE;
     2488     2798        %EOD;

PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:605  
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$HANDLE_LEVEL_CHANGE.

   Procedure Z8EL$HANDLE_LEVEL_CHANGE requires 20 words for executable code.
   Procedure Z8EL$HANDLE_LEVEL_CHANGE requires 4 words of local(AUTO) storage.

PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:606  

 Object Unit name= Z8EL$HANDLE_LEVEL_CHANGE                   File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:20:27.24 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    2  LblCom even  none     1      1  REPLACE_ACTIVE
    3  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    4  LblCom even  none     1      1  COPY_DEBUG_LEVEL
    5  LblCom even  none     4      4  REPLACE_LIST
    6  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
    7   Proc  even  none    20     24  Z8EL$HANDLE_LEVEL_CHANGE
    8  RoData even  none     2      2  Z8EL$HANDLE_LEVEL_CHANGE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Std        1  Z8EL$HANDLE_LEVEL_CHANGE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8EL$DELETE_REPLACE_LEVEL
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:607  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:608  


     2459        1        /*T***********************************************************/
     2460        2        /*T*                                                         */
     2461        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2462        4        /*T*                                                         */
     2463        5        /*T***********************************************************/
     2464        6        Z8EL$HANDLE_LEVEL_CHANGE : PROC (NEW_LEVEL);

      6  7 000000   000000 700200 xent  Z8EL$HANDLE* TSX0  ! X66_AUTO_1
         7 000001   000004 000001                    ZERO    4,1

     2465        7
     2466        8    1   DCL NEW_LEVEL SBIN;
     2467        9
     2468       10        %EQU PHASE = 1;
     2469       11        %INCLUDE Z8A_DEFC;
     2470       79        %INCLUDE Z8A_SUPP_MAC;
     2471     2479        %INCLUDE Z8E_REPLACE;
     2472     2782
     2473     2783    1   DCL Z8EL$DELETE_REPLACE_LEVEL ENTRY(1);
     2474     2784
     2475     2785    1     IF NEW_LEVEL > CURRENT_SYMBOL_LEVEL THEN

   2785  7 000002   200003 470500                    LDP0    @NEW_LEVEL,,AUTO
         7 000003   000000 236100                    LDQ     0,,PR0
         7 000004   000000 116000 1                  CMPQ    CURRENT_SYMBOL_LEVEL
         7 000005   000010 604400 7                  TMOZ    s:2788

     2476     2786    1       CURRENT_SYMBOL_LEVEL = NEW_LEVEL;

   2786  7 000006   000000 756000 1                  STQ     CURRENT_SYMBOL_LEVEL
         7 000007   000023 710000 7                  TRA     s:2794

     2477     2787    1     ELSE
     2478     2788    2       DO WHILE NEW_LEVEL < CURRENT_SYMBOL_LEVEL;

   2788  7 000010   000023 605000 7                  TPL     s:2794
PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:609  

     2479     2789              /* DELETE REPLACE DATA DOWN TO CURRENT LEVEL */
     2480     2790    2         CALL Z8EL$DELETE_REPLACE_LEVEL (CURRENT_SYMBOL_LEVEL);

   2790  7 000011   000001 630400 8                  EPPR0   1
         7 000012   000000 631400 8                  EPPR1   0
         7 000013   000000 701000 xent               TSX1    Z8EL$DELETE_REPLACE_LEVEL
         7 000014   000000 011000                    NOP     0

     2481     2791    2         CURRENT_SYMBOL_LEVEL = CURRENT_SYMBOL_LEVEL - 1;

   2791  7 000015   000001 336007                    LCQ     1,DL
         7 000016   000000 056000 1                  ASQ     CURRENT_SYMBOL_LEVEL

     2482     2792    2       END;

   2792  7 000017   200003 470500                    LDP0    @NEW_LEVEL,,AUTO
         7 000020   000000 236100                    LDQ     0,,PR0
         7 000021   000000 116000 1                  CMPQ    CURRENT_SYMBOL_LEVEL
         7 000022   000011 604000 7                  TMI     s:2790

     2483     2793
     2484     2794    1     RETURN;

   2794  7 000023   000000 702200 xent               TSX2  ! X66_ARET
     2485     2795
     2486     2796
     2487     2797    1   END Z8EL$HANDLE_LEVEL_CHANGE;
     2488     2798        %EOD;

PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:610  
--  Include file information  --

   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$HANDLE_LEVEL_CHANGE.
PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:611  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CURRENT_SYMBOL_LEVEL

  ****  Section 002 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 003 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 004 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

PL6.E3A0      #017=Z8EL$HANDLE_LEVEL_CHANGE File=Z8EL.:Z8A6TSI                   SAT 08/09/97 12:20 Page:612  
  ****  Section 005 LblCom REPLACE_LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)         1 REPLACE_LIST

  ****  Section 006 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LEX_SYMBOL_QUEUE$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @NEW_LEVEL                *0-0-0/w SBIN        r     1 NEW_LEVEL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(252)         1 REPLACE_ITEM


   Procedure Z8EL$HANDLE_LEVEL_CHANGE requires 20 words for executable code.
   Procedure Z8EL$HANDLE_LEVEL_CHANGE requires 4 words of local(AUTO) storage.

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:613  
     2489        1        /*T***********************************************************/
     2490        2        /*T*                                                         */
     2491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2492        4        /*T*                                                         */
     2493        5        /*T***********************************************************/
     2494        6        Z8EL$POSSIBLE_REPLACE : PROC (LOWEST_LEVEL) ALTRET;
     2495        7
     2496        8    1   DCL LOWEST_LEVEL SBIN;
     2497        9
     2498       10        %EQU PHASE = 1;
     2499       11        %INCLUDE Z8A_DEFC;
     2500       79        %INCLUDE Z8A_SUPP_MAC;
     2501     2479        %INCLUDE Z8E_HEAP;
     2502     2535        %INCLUDE Z8E_STACKS;
     2503     4801        %INCLUDE Z8E_REPLACE;
     2504     5104        %INCLUDE Z8E_WINDOW;
     2505     7174        %INCLUDE Z8E_BUFFERS;
     2506     7364        %INCLUDE Z8E_TABLES;
     2507     7917        %INCLUDE Z8A_COMCOM ;
     2508     8567        %INCLUDE Z8E_O1COM ;
     2509     9328
     2510     9329    1   DCL Z8EL$POSITION_LINE_LIST ENTRY (3);
     2511     9330    1   DCL Z8EL$PROCESS_COPY ENTRY;
     2512     9331
     2513     9332
     2514     9333
     2515     9334    1   DCL REPLACE$ PTR;
     2516     9335    1   DCL REPLACEMENT_FOUND BOOLEAN;
     2517     9336    1   DCL SAVE_INHIBIT_DUMP_LINES BOOLEAN;
     2518     9337    1   DCL INHIBIT_DUMP_LINES BOOLEAN EXT;
     2519     9338    1   DCL LEX_STATE          SBIN WORD EXT; /* Normal or Picture or ... */
     2520     9339    1   DCL PICTURE_TOKEN      BOOLEAN;       /* PICTURE found in match list */
     2521     9340
     2522     9341
     2523     9342
     2524     9343        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:614  
     2525     9344    1     MATCH_LISTS : PROC ALTRET;
     2526     9345
     2527     9346    2       DCL MATCH$ PTR;
     2528     9347    2       DCL LEX$ PTR;
     2529     9348
     2530     9349
     2531     9350    2       EMBEDDED_COPY : PROC;
     2532     9351
     2533     9352    3         DCL SAVED_LEX_SYMBOL_QUEUE$ PTR;
     2534     9353
     2535     9354    3         SAVED_LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$;
     2536     9355    3         LEX_SYMBOL_QUEUE$ = ADDR(NIL);
     2537     9356
     2538     9357    3         CALL Z8EL$PROCESS_COPY;
     2539     9358
     2540     9359    3         LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
     2541     9360    3         LEX_SYMBOL_QUEUE$ = SAVED_LEX_SYMBOL_QUEUE$;
     2542     9361
     2543     9362    3       END EMBEDDED_COPY;
     2544     9363
     2545     9364
     2546     9365    2     CHECK_LOWER_LEVEL : PROC;
     2547     9366
     2548     9367    3       DCL SAVED_LEX_SYMBOL_QUEUE$ PTR;
     2549     9368
     2550     9369    3       IF LEX$ -> BASED_LEX_SYMBOL.NEXT$ -> BASED_LEX_SYMBOL.LEVEL >
     2551     9370    3             REPLACE$ -> REPLACE_ITEM.LEVEL THEN
     2552     9371    4         DO;
     2553     9372    4           SAVED_LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$;
     2554     9373    4           LEX_SYMBOL_QUEUE$ = LEX$ -> BASED_LEX_SYMBOL.NEXT$;
     2555     9374
     2556     9375    4           CALL Z8EL$POSSIBLE_REPLACE (REPLACE$ -> REPLACE_ITEM.LEVEL)
     2557     9376    4             WHENALTRETURN
     2558     9377    5               DO;
     2559     9378    5                 LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.LEVEL
     2560     9379    5                     = REPLACE$ -> REPLACE_ITEM.LEVEL;
     2561     9380    5               END;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:615  
     2562     9381
     2563     9382    4           LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
     2564     9383    4           LEX_SYMBOL_QUEUE$ = SAVED_LEX_SYMBOL_QUEUE$;
     2565     9384    4         END;
     2566     9385
     2567     9386    3     END CHECK_LOWER_LEVEL;
     2568     9387
     2569     9388            /* Main body of MATCH_LISTS */
     2570     9389
     2571     9390    2       LEX$ = LEX_SYMBOL_QUEUE$;
     2572     9391    2       MATCH$ = REPLACE$ -> REPLACE_ITEM.FROM_LIST$;
     2573     9392    2       PICTURE_TOKEN = FALSE;
     2574     9393
     2575     9394    3       DO WHILE MATCH$ ~= ADDR(NIL)
     2576     9395    3                    AND MATCH$ -> BASED_LEX_SYMBOL.SYMBOL
     2577     9396    3                            = LEX$ -> BASED_LEX_SYMBOL.SYMBOL
     2578     9397    3                     AND LEX$ -> BASED_LEX_SYMBOL.LEVEL >=
     2579     9398    3                             REPLACE$ -> REPLACE_ITEM.LEVEL;
     2580     9399
     2581     9400              /*Don't replace parts of picture strings (STAR T02424) */
     2582     9401
     2583     9402    3         IF SUBSTR (MATCH$ -> BASED_LEX_SYMBOL.SYMBOL, 0, MATCH$ -> BASED_LEX_SYMBOL.
              9402                  SIZE) = 'PICTURE'
     2584     9403    3         OR SUBSTR (MATCH$ -> BASED_LEX_SYMBOL.SYMBOL, 0, MATCH$ -> BASED_LEX_SYMBOL.
              9403                  SIZE) = 'PIC' THEN
     2585     9404    3           PICTURE_TOKEN = TRUE;
     2586     9405
     2587     9406    3         IF PICTURE_TOKEN = FALSE
     2588     9407    3         AND LEX_STATE = %LS_PICTURE_OR_IS THEN
     2589     9408    3           RETURN; /* REPLACEMENT_FOUND = FALSE */
     2590     9409
     2591     9410    3         MATCH$ = MATCH$ -> BASED_LEX_SYMBOL.NEXT$;
     2592     9411
     2593     9412    3         IF MATCH$ ~= ADDR(NIL) THEN
     2594     9413    4           DO;
     2595     9414    4             IF LEX$ -> BASED_LEX_SYMBOL.NEXT$ = ADDR(NIL) THEN
     2596     9415    5               DO;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:616  
     2597     9416                      %GET_BRAND_NEW_TOKEN;
     2598     9425
     2599     9426                      /* Check for embedded copy */
     2600     9427    5                 IF LEX_SYMBOL.SIZE = 4
     2601     9428    5                      AND SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'COPY' THEN
     2602     9429    6                   DO;
     2603     9430    6                     CALL EMBEDDED_COPY;
     2604     9431    6                     ALTRETURN;
     2605     9432    6                   END;
     2606     9433
     2607     9434                      %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)",
     2608     9435                                              TO$ = HEAP$);
     2609     9450    5                 LEX$ -> BASED_LEX_SYMBOL.NEXT$ = HEAP$;
     2610     9451    5               END;
     2611     9452
     2612     9453    4             CALL CHECK_LOWER_LEVEL;
     2613     9454
     2614     9455    4             LEX$ = LEX$ -> BASED_LEX_SYMBOL.NEXT$;
     2615     9456    4           END;
     2616     9457
     2617     9458    3       END;  /* DO WHILE */
     2618     9459
     2619     9460    2       IF MATCH$ = ADDR(NIL) THEN
     2620     9461    2         REPLACEMENT_FOUND = TRUE;
     2621     9462
     2622     9463    2     END MATCH_LISTS;
     2623     9464
     2624     9465        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:617  
     2625     9466    1     DO_REPLACE : PROC;
     2626     9467    2       DCL MATCH$ PTR;
     2627     9468    2       DCL LEX$ PTR;
     2628     9469
     2629     9470    2       DCL REP_BEG_LINE SBIN;
     2630     9471    2       DCL REP_BEG_COLUMN SBIN;
     2631     9472    2       DCL REP_DEBUG_LINE BOOLEAN;
     2632     9473    2       DCL CUMM_LINE_OFFSET SBIN;
     2633     9474    2       DCL CUMM_LINE_PTR$ PTR;
     2634     9475    2       DCL REP_END_LINE SBIN;
     2635     9476    2       DCL REP_END_COLUMN SBIN;
     2636     9477
     2637     9478    2       DCL L$               PTR;
     2638     9479    2       DCL TL$              PTR;
     2639     9480    2       DCL TISN             SBIN;
     2640     9481    2       DCL ISN_INC          SBIN;
     2641     9482    2       DCL ISN_BASE         SBIN;
     2642     9483    2       DCL NON_BLANK_COL    SBIN;
     2643     9484    2       DCL CHAR_CLASS       SBIN;
     2644     9485    2       DCL TEMP_SBIN        SBIN BYTE CALIGNED;
     2645     9486    2       DCL TEMP_CHAR1       REDEF TEMP_SBIN CHAR (1);
     2646     9487    2       DCL MAX_TOKEN_LENGTH SBIN;
     2647     9488    2       DCL SAVE_SIZE        SBIN;
     2648     9489    2       DCL NEXT$            PTR;
     2649     9490    2       DCL NEW$             PTR;
     2650     9491    2       DCL REP_SIZE         SBIN;
     2651     9492    2       DCL BLANK_SPACE      SBIN;
     2652     9493    2       DCL TO_LIST$         PTR;
     2653     9494    2       DCL OLD_LINE$        PTR;
     2654     9495    2       DCL TEMP_CHAR60      CHAR (60);
     2655     9496    2       DCL SHIFT_RIGHT      SBIN;
     2656     9497
     2657     9498        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:618  
     2658     9499
     2659     9500    2       ADJUST_ISN : PROC (ISN_INC,
     2660     9501    2                          LINE$);
     2661     9502
     2662     9503    3         DCL ISN_INC SBIN;
     2663     9504    3         DCL LINE$ PTR;
     2664     9505
     2665     9506    3         DCL L$ PTR;
     2666     9507    3         DCL T$ PTR;
     2667     9508
     2668     9509    3         L$ = LINE$;
     2669     9510
     2670     9511    4         DO WHILE L$ ~= ADDR(NIL)
     2671     9512    4              AND L$ ~= CURRENT_BUFFER$;
     2672     9513
     2673     9514    4           L$ -> FILL_BUFFER.ISN = L$ -> FILL_BUFFER.ISN + ISN_INC;
     2674     9515    4           L$ = L$ -> FILL_BUFFER.NEXT$;
     2675     9516    4         END;
     2676     9517
     2677     9518    3         IF L$ = CURRENT_BUFFER$ THEN
     2678     9519    4           DO;
     2679     9520    4             EXPANDED_ISN = EXPANDED_ISN + ISN_INC;
     2680     9521    4             L$ -> FILL_BUFFER.ISN = L$ -> FILL_BUFFER.ISN + ISN_INC;
     2681     9522    4             BUFFER.ISN = L$ -> FILL_BUFFER.ISN;
     2682     9523    4           END;
     2683     9524
     2684     9525                /* Adjust tokens previously scanned */
     2685     9526
     2686     9527    3           T$ = LEX_SYMBOL_QUEUE$;
     2687     9528    4           DO WHILE T$ ~= ADDR(NIL);
     2688     9529    4             T$ -> BASED_LEX_SYMBOL.LINE = T$ -> BASED_LEX_SYMBOL.LINE + ISN_INC;
     2689     9530    4             T$ -> BASED_LEX_SYMBOL.END_LINE = T$ -> BASED_LEX_SYMBOL.END_LINE +
              9530                      ISN_INC;
     2690     9531    4             T$ = T$ -> BASED_LEX_SYMBOL.NEXT$;
     2691     9532    4           END;
     2692     9533    3       END ADJUST_ISN;
     2693     9534
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:619  
     2694     9535        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:620  
     2695     9536    2       SPLIT_LINE : PROC (LINE,
     2696     9537    2                          COLUMN,
     2697     9538    2                          LINE$);
     2698     9539
     2699     9540    3         DCL LINE SBIN;
     2700     9541    3         DCL COLUMN SBIN;
     2701     9542    3         DCL LINE$ PTR;
     2702     9543
     2703     9544    3         DCL L$ PTR;
     2704     9545
     2705     9546    3         LINE$ = ADDR(NIL);
     2706     9547    3         CALL Z8EL$POSITION_LINE_LIST (LINE, LINE$, 999999999);
     2707     9548
     2708     9549    3         IF LINE$ ~= ADDR(NIL) THEN
     2709     9550    4           DO;
     2710     9551    4             IF SUBSTR (LINE$ -> FILL_BUFFER.SOURCE_LINE,
     2711     9552    4                        COLUMN,
     2712     9553    4                        MINIMUM (O1COM.MARGIN_R, LINE$ -> FILL_BUFFER.LINE_LENGTH) -
              9553                                 COLUMN)
     2713     9554    4                    ~= ' ' THEN
     2714     9555    5               DO;
     2715     9556    5                 CALL DUP_FOR_REP (LINE$,
     2716     9557    5                                   CUMM_LINE_OFFSET);
     2717     9558
     2718     9559                      %NEW_HEAP (@POINTER = L$,
     2719     9560                                 @SIZE = %MAX_INPUT_BUFFER_LEN);
     2720     9565
     2721     9566    5                 LINE$ -> FILL_BUFFER.ESN = ' ';
     2722     9567    5                 L$ -> FILL_BUFFER.LINE_LENGTH = LINE$ -> FILL_BUFFER.LINE_LENGTH;
     2723     9568    5                 L$ -> FILL_BUFFER = LINE$ -> FILL_BUFFER;
     2724     9569    5                 LINE$ -> FILL_BUFFER.NEXT$ = L$;
     2725     9570    5                 IF CURRENT_BUFFER$ = LINE$ THEN
     2726     9571    5                   CURRENT_BUFFER$ = L$;
     2727     9572
     2728     9573    5                 CALL ADJUST_ISN (1, L$);
     2729     9574
     2730     9575    5                 SUBSTR (LINE$ -> FILL_BUFFER.SOURCE_LINE,
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:621  
     2731     9576    5                         COLUMN,
     2732     9577    5                         MINIMUM (O1COM.MARGIN_R, LINE$ -> FILL_BUFFER.LINE_LENGTH) -
              9577                                  COLUMN)
     2733     9578    5                     = ' ';
     2734     9579
     2735     9580    5                 SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,
     2736     9581    5                         0,
     2737     9582    5                         COLUMN) = ' ';
     2738     9583    5                 IF LINE$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE THEN
     2739     9584    5                   SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,
     2740     9585    5                           O1COM.AREA_A_COLUMN_START - 1, 1) = 'D';
     2741     9586    5               END;
     2742     9587    4           END;
     2743     9588    3       END SPLIT_LINE;
     2744     9589
     2745     9590        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:622  
     2746     9591    2       DUP_FOR_REP : PROC (LINE$,
     2747     9592    2                           ISN_INC);
     2748     9593
     2749     9594    3         DCL LINE$ PTR;
     2750     9595    3         DCL ISN_INC SBIN;
     2751     9596
     2752     9597    3         DCL L$ PTR;
     2753     9598
     2754     9599
     2755     9600    3         ISN_INC = 0;
     2756     9601    3         IF NOT LINE$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE THEN
     2757     9602    4           DO;
     2758     9603                  %NEW_HEAP (@POINTER = L$,
     2759     9604                             @SIZE = %MAX_INPUT_BUFFER_LEN);
     2760     9609
     2761     9610    4             L$ -> FILL_BUFFER.LINE_LENGTH = LINE$ -> FILL_BUFFER.LINE_LENGTH;
     2762     9611    4             L$ -> FILL_BUFFER = LINE$ -> FILL_BUFFER;
     2763     9612    4             L$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE = TRUE;
     2764     9613    4             L$ -> FILL_BUFFER.ESN = ' ';
     2765     9614    4             LINE$ -> FILL_BUFFER.LINE_TYPE.OLD_REP_LINE = TRUE;
     2766     9615    4             LINE$ -> FILL_BUFFER.NEXT$ = L$;
     2767     9616
     2768     9617    4             IF CURRENT_BUFFER$ = LINE$ THEN
     2769     9618    4               CURRENT_BUFFER$ = L$;
     2770     9619    4             LINE$ = L$;
     2771     9620
     2772     9621    4             CALL ADJUST_ISN (1, L$);
     2773     9622
     2774     9623    4             ISN_INC = 1;
     2775     9624    4           END;
     2776     9625    3       END DUP_FOR_REP;
     2777     9626
     2778     9627        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:623  
     2779     9628    2       INSERT_TOKEN : PROC (SYMBOL$,
     2780     9629    2                            LINE,
     2781     9630    2                            COLUMN);
     2782     9631
     2783     9632    3         DCL SYMBOL$ PTR;
     2784     9633    3         DCL LINE SBIN;
     2785     9634    3         DCL COLUMN SBIN;
     2786     9635
     2787     9636    3         DCL LEX$ PTR;
     2788     9637
     2789     9638              %COPY_TO_NEW_LEX_SYMBOL (FROM$ = SYMBOL$,
     2790     9639                                       TO$ = LEX$);
     2791     9654    3         LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
     2792     9655    3         LEX$ -> BASED_LEX_SYMBOL.LEVEL = REPLACE$ -> REPLACE_ITEM.LEVEL - 1;
     2793     9656    3         LEX_SYMBOL_QUEUE$ = LEX$;
     2794     9657    3         LEX$ -> BASED_LEX_SYMBOL.LINE = LINE;
     2795     9658    3         LEX$ -> BASED_LEX_SYMBOL.COLUMN = COLUMN;
     2796     9659    3         LEX$ -> BASED_LEX_SYMBOL.END_LINE = LINE;
     2797     9660    3         LEX$ -> BASED_LEX_SYMBOL.END_COLUMN = COLUMN + SYMBOL$ -> BASED_LEX_SYMBOL.
              9660                  SIZE;
     2798     9661    3         LEX$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN = REP_DEBUG_LINE;
     2799     9662
     2800     9663    3         IF LEX$ -> BASED_LEX_SYMBOL.END_COLUMN > O1COM.MARGIN_R THEN
     2801     9664    3           LEX$ -> BASED_LEX_SYMBOL.END_COLUMN = O1COM.MARGIN_R;
     2802     9665    3       END INSERT_TOKEN;
     2803     9666
     2804     9667        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:624  
     2805     9668    2       CALC_MAX_TOKEN_LENGTH : PROC;
     2806     9669
     2807     9670    3         CUMM_LINE_PTR$ = ADDR(NIL);
     2808     9671    3         CALL Z8EL$POSITION_LINE_LIST (REP_BEG_LINE,
     2809     9672    3                                       CUMM_LINE_PTR$,
     2810     9673    3                                       999999999);
     2811     9674
     2812     9675              /* Calculate blank space on line */
     2813     9676
     2814     9677    3         CALL SEARCH ( NON_BLANK_COL,
     2815     9678    3                       CHAR_CLASS,
     2816     9679    3                       BLANK_SCAN_TABLE,
     2817     9680    3                       SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
     2818     9681    3                              0,
     2819     9682    3                              MINIMUM(O1COM.MARGIN_R, CUMM_LINE_PTR$ -> FILL_BUFFER.
              9682                                       LINE_LENGTH)),
     2820     9683    3                        REP_BEG_COLUMN);
     2821     9684
     2822     9685    3         IF CHAR_CLASS = %END_OF_LINE THEN
     2823     9686    3           MAX_TOKEN_LENGTH = O1COM.MARGIN_R - REP_BEG_COLUMN;
     2824     9687    3         ELSE
     2825     9688    3           MAX_TOKEN_LENGTH = NON_BLANK_COL - REP_BEG_COLUMN - 1;
     2826     9689
     2827     9690    3       END CALC_MAX_TOKEN_LENGTH ;
     2828     9691
     2829     9692        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:625  
     2830     9693    2       DO_STRAIGHT_IN_LINE_REPLACE: PROC (ADD_BLANKS);
     2831     9694
     2832     9695    3         DCL  ADD_BLANKS    SBIN WORD;
     2833     9696
     2834     9697    3         SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
     2835     9698    3                REP_BEG_COLUMN + ADD_BLANKS,
     2836     9699    3                REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SIZE)
     2837     9700    3            = REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SYMBOL;
     2838     9701
     2839     9702    3         CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH =
     2840     9703    3               MAXIMUM (CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH,
     2841     9704    3                        REP_BEG_COLUMN + REPLACE$ -> REPLACE_ITEM.TO_LIST$
     2842     9705    3                                            -> BASED_LEX_SYMBOL.SIZE);
     2843     9706
     2844     9707    3         CALL INSERT_TOKEN (REPLACE$ -> REPLACE_ITEM.TO_LIST$,
     2845     9708    3                            CUMM_LINE_PTR$ -> FILL_BUFFER.ISN,
     2846     9709    3                            REP_BEG_COLUMN);
     2847     9710
     2848     9711    3       END DO_STRAIGHT_IN_LINE_REPLACE;
     2849     9712
     2850     9713        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:626  
     2851     9714            /* DO_REPLACE main body */
     2852     9715
     2853     9716            /* Save info from first token being deleted */
     2854     9717
     2855     9718    2       REP_BEG_LINE = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.LINE;
     2856     9719    2       REP_BEG_COLUMN = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.COLUMN;
     2857     9720    2       REP_DEBUG_LINE = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN;
     2858     9721
     2859     9722            /* Clear Scanner from RESTART_STATE */
     2860     9723    2       IF SCANNER_STATE ~= 0 THEN
     2861     9724    3         DO;
     2862     9725    3           LEX$ = LEX_SYMBOL_QUEUE$;
     2863     9726
     2864     9727    4           DO WHILE LEX$ -> BASED_LEX_SYMBOL.NEXT$ ~= ADDR(NIL);
     2865     9728
     2866     9729    4             LEX$ = LEX$ -> BASED_LEX_SYMBOL.NEXT$;
     2867     9730    4           END;
     2868     9731
     2869     9732    4           DO UNTIL SCANNER_STATE = 0;
     2870     9733
     2871     9734                  %GET_BRAND_NEW_TOKEN;
     2872     9743
     2873     9744                  %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2874     9745                                           TO$   = HEAP$);
     2875     9760
     2876     9761    4             LEX$ -> BASED_LEX_SYMBOL.NEXT$ = HEAP$;
     2877     9762    4             LEX$ = HEAP$;
     2878     9763    4           END;
     2879     9764    3         END;
     2880     9765
     2881     9766
     2882     9767            /* Delete matched tokens */
     2883     9768    2       MATCH$ = REPLACE$ -> REPLACE_ITEM.FROM_LIST$;
     2884     9769
     2885     9770    3       DO UNTIL MATCH$ = ADDR(NIL);
     2886     9771
     2887     9772    3         LEX$ = LEX_SYMBOL_QUEUE$;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:627  
     2888     9773    3         REP_END_LINE = LEX$ -> BASED_LEX_SYMBOL.END_LINE;
     2889     9774    3         REP_END_COLUMN = LEX$ -> BASED_LEX_SYMBOL.END_COLUMN;
     2890     9775    3         LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.NEXT$;
     2891     9776
     2892     9777    3         CALL Z8ED$DISPOSE_HEAP(LEX$,
     2893     9778                                        %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX$);
     2894     9781    3                                  );
     2895     9782    3         MATCH$ = MATCH$ -> BASED_LEX_SYMBOL.NEXT$;
     2896     9783
     2897     9784    3       END;
     2898     9785
     2899     9786
     2900     9787            /* Delete  matched lines for listing */
     2901     9788
     2902     9789    2       CUMM_LINE_PTR$ = ADDR(NIL);
     2903     9790    2       CALL Z8EL$POSITION_LINE_LIST ( REP_BEG_LINE,
     2904     9791    2                                      CUMM_LINE_PTR$,
     2905     9792    2                                      999999999);
     2906     9793    2       OLD_LINE$ = CUMM_LINE_PTR$;
     2907     9794
     2908     9795            /* Check for pseudo text in-line replacement --           */
     2909     9796            /* (1) TO is one token within pseudo text                 */
     2910     9797            /* (2) TO starting column is in area B (cc 12 - 72)       */
     2911     9798            /* (3) the new line will not go beyond cc 72              */
     2912     9799
     2913     9800    2       TO_LIST$ = REPLACE$ -> REPLACE_ITEM.TO_LIST$;
     2914     9801
     2915     9802    2       IF  (TO_LIST$ = ADDR (NIL)
     2916     9803    2            OR   TO_LIST$ -> BASED_LEX_SYMBOL.NEXT$ = ADDR (NIL)
     2917     9804    2            AND  TO_LIST$ -> BASED_LEX_SYMBOL.COLUMN >= 12)
     2918     9805    2       AND REPLACE$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT
     2919     9806    2       AND REPLACE$ -> REPLACE_ITEM.FROM_IS_PSEUDO_TEXT
     2920     9807    2       AND CUMM_LINE_PTR$ ~= ADDR(NIL)
     2921     9808    2       AND REP_BEG_LINE = REP_END_LINE THEN
     2922     9809    3         DO;
     2923     9810                /* Check item (3) above: new line <= 72 bytes */
     2924     9811
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:628  
     2925     9812    3           CALL DUP_FOR_REP (CUMM_LINE_PTR$, CUMM_LINE_OFFSET);
     2926     9813    3           REP_BEG_LINE = REP_BEG_LINE + CUMM_LINE_OFFSET;
     2927     9814    3           REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;
     2928     9815    3           REP_SIZE = REP_END_COLUMN - REP_BEG_COLUMN;
     2929     9816    3           SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
     2930     9817    3                  REP_BEG_COLUMN,
     2931     9818    3                  REP_SIZE) = ' ';
     2932     9819
     2933     9820    3           CALL CALC_MAX_TOKEN_LENGTH;
     2934     9821
     2935     9822    3           IF TO_LIST$ ~= ADDR (NIL)
     2936     9823    3           AND REP_SIZE ~= TO_LIST$ -> BASED_LEX_SYMBOL.SIZE THEN
     2937     9824    3             SHIFT_RIGHT = TO_LIST$ -> BASED_LEX_SYMBOL.SIZE - REP_SIZE;
     2938     9825    3           ELSE
     2939     9826    3             SHIFT_RIGHT = 0;
     2940     9827
     2941     9828    3           IF  CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH + SHIFT_RIGHT <= 72
     2942     9829    3           AND ((TO_LIST$ = ADDR (NIL)
     2943     9830    3                 AND BUFFER.CLASS ~= %SPACE)
     2944     9831    3              OR TO_LIST$ ~= ADDR (NIL)
     2945     9832    3                 AND (TO_LIST$ -> BASED_LEX_SYMBOL.TYPE = %USER_WORD
     2946     9833    3                      OR TO_LIST$ -> BASED_LEX_SYMBOL.TYPE = %NUMBER
     2947     9834    3                      OR TO_LIST$ -> BASED_LEX_SYMBOL.TYPE = %NUMERIC_LITERAL
     2948     9835    3                      OR SUBSTR (TO_LIST$ -> BASED_LEX_SYMBOL.SYMBOL, 0, 1) = '-' ))
              9835                               THEN
     2949     9836    4             DO;
     2950     9837
     2951     9838                    /* Check for combining tokens      */
     2952     9839                    /* e.g., (*)-FIELD1 ==> XYZ-FIELD1 */
     2953     9840                    /*       ---            ---        */
     2954     9841
     2955     9842    4               NEXT$ = LEX_SYMBOL_QUEUE$;
     2956     9843
     2957     9844    4               IF NEXT$ = ADDR(NIL) THEN
     2958     9845    5                 DO;
     2959     9846                        %GET_BRAND_NEW_TOKEN;
     2960     9855    5                   IF  LEX_SYMBOL.SIZE = 4
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:629  
     2961     9856    5                   AND SUBSTR (LEX_SYMBOL.SYMBOL, 0, 4) = 'COPY' THEN
     2962     9857    6                     DO;
     2963     9858    6                       IF TO_LIST$ ~= ADDR (NIL)
     2964     9859    6                         THEN CALL DO_STRAIGHT_IN_LINE_REPLACE (0);
     2965     9860    6                         ELSE CALL Z8EL$PROCESS_COPY;
     2966     9861    6                       RETURN;
     2967     9862    6                     END;
     2968     9863                        %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)",
     2969     9864                                                TO$ = NEXT$);
     2970     9879    5                 END; /* If NEXT$ = null */
     2971     9880
     2972     9881    4               IF SHIFT_RIGHT > 0 THEN
     2973     9882    5                 DO;
     2974     9883    5                   SUBSTR (TEMP_CHAR60, 0, SHIFT_RIGHT) = ' ';
     2975     9884    5                   SUBSTR (TEMP_CHAR60, SHIFT_RIGHT, 60 - SHIFT_RIGHT)
     2976     9885    5                     = SUBSTR (CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
              9885                              REP_END_COLUMN, 60) ;
     2977     9886    5                   SUBSTR (CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
     2978     9887    5                           REP_END_COLUMN,
     2979     9888    5                           72 - REP_END_COLUMN)
     2980     9889    5                     = TEMP_CHAR60;
     2981     9890    5                   CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH =
     2982     9891    5                     CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH + SHIFT_RIGHT;
     2983     9892
     2984     9893                        /* Update the Scanner's Buffer, Length & Column */
     2985     9894
     2986     9895    5                   SUBSTR (TEMP_CHAR60, SHIFT_RIGHT, 60 - SHIFT_RIGHT)
     2987     9896    5                     = SUBSTR (BUFFER_LINE, BUFFER.COLUMN, 60);
     2988     9897    5                   SUBSTR (BUFFER_LINE, BUFFER.COLUMN, 72 - BUFFER.COLUMN)
     2989     9898    5                     = TEMP_CHAR60;
     2990     9899    5                   BUFFER.LINE_LENGTH = BUFFER.LINE_LENGTH
     2991     9900    5                     + SHIFT_RIGHT;
     2992     9901    5                   BUFFER.COLUMN = BUFFER.COLUMN + SHIFT_RIGHT ;
     2993     9902    5                 END; /* Shift_Right non-zero */
     2994     9903    4               ELSE IF SHIFT_RIGHT < 0 THEN
     2995     9904    5                 DO;
     2996     9905    5                   TEMP_CHAR1 = SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:630  
     2997     9906    5                       NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE - 1, 1);
     2998     9907    5                   IF USERWORD_SCAN_TABLE.T (TEMP_SBIN) = %SCAN THEN
     2999     9908    6                     DO;
     3000     9909    6                       SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     3001     9910    6                           NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE) =
     3002     9911    6                           SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     3003     9912    6                           NEXT$ -> BASED_LEX_SYMBOL.COLUMN - TO_LIST$ ->
              9912                                    BASED_LEX_SYMBOL.SIZE);
     3004     9913    6                       SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE
              9913                                ) =
     3005     9914    6                           SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN -
              9914                                    TO_LIST$ -> BASED_LEX_SYMBOL.SIZE);
     3006     9915    6                     END;
     3007     9916    5                   ELSE
     3008     9917    5                     SHIFT_RIGHT = 0;
     3009     9918    5                 END;
     3010     9919
     3011     9920    4               IF  REP_END_COLUMN
     3012     9921    4                   = NEXT$ -> BASED_LEX_SYMBOL.COLUMN
     3013     9922    4               AND REP_BEG_LINE = NEXT$ -> BASED_LEX_SYMBOL.LINE
     3014     9923    4               AND ( NEXT$ -> BASED_LEX_SYMBOL.TYPE = %USER_WORD
     3015     9924    4                  OR NEXT$ -> BASED_LEX_SYMBOL.TYPE = %NUMBER
     3016     9925    4                  OR NEXT$ -> BASED_LEX_SYMBOL.TYPE = %NUMERIC_LITERAL
     3017     9926    4                  OR SUBSTR (NEXT$ -> BASED_LEX_SYMBOL.SYMBOL, 0, 1) = '-' ) THEN
     3018     9927    5                 DO;
     3019     9928
     3020     9929    5                   IF TO_LIST$ = ADDR (NIL) THEN
     3021     9930    6                     DO;
     3022     9931    6                       TEMP_CHAR1 = SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     3023     9932    6                                     NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE - 1, 1
              9932                                              );
     3024     9933    6                       IF USERWORD_SCAN_TABLE.T (TEMP_SBIN) = %SCAN THEN
     3025     9934    7                         DO;
     3026     9935    7                           SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     3027     9936    7                                   NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE) =
     3028     9937    7                               SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     3029     9938    7                                       NEXT$ -> BASED_LEX_SYMBOL.COLUMN);
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:631  
     3030     9939    7                           SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN -
              9939                                    REP_SIZE) =
     3031     9940    7                               SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN);
     3032     9941    7                         END;
     3033     9942    6                       LEX_SYMBOL_QUEUE$ = NEXT$;
     3034     9943
     3035     9944    6                       RETURN;
     3036     9945
     3037     9946    6                     END;
     3038     9947    5                   BLANK_SPACE = REP_SIZE - TO_LIST$ -> BASED_LEX_SYMBOL.SIZE;
     3039     9948    5                   CALL DO_STRAIGHT_IN_LINE_REPLACE (BLANK_SPACE + SHIFT_RIGHT);
     3040     9949    5                   LEX$ = LEX_SYMBOL_QUEUE$;
     3041     9950    5                   SAVE_SIZE = LEX$ -> BASED_LEX_SYMBOL.SIZE;
     3042     9951    5                   LEX$ -> BASED_LEX_SYMBOL.SIZE
     3043     9952    5                     = LEX$ -> BASED_LEX_SYMBOL.SIZE
     3044     9953    5                     + NEXT$ -> BASED_LEX_SYMBOL.SIZE ;
     3045     9954
     3046     9955                        %COPY_TO_NEW_LEX_SYMBOL (FROM$ = LEX$,
     3047     9956                                                 TO$   = NEW$);
     3048     9971
     3049     9972    5                   SUBSTR (NEW$ -> BASED_LEX_SYMBOL.SYMBOL,
     3050     9973    5                           SAVE_SIZE,
     3051     9974    5                           NEXT$ -> BASED_LEX_SYMBOL.SIZE)
     3052     9975    5                     = NEXT$ -> BASED_LEX_SYMBOL.SYMBOL;
     3053     9976
     3054     9977    5                   LEX$ -> BASED_LEX_SYMBOL.SIZE = SAVE_SIZE;
     3055     9978    5                   LEX_SYMBOL_QUEUE$ = NEW$;
     3056     9979    5                   NEW$ -> BASED_LEX_SYMBOL.NEXT$
     3057     9980    5                     = NEXT$ -> BASED_LEX_SYMBOL.NEXT$;
     3058     9981
     3059     9982                        /* DISPOSE of LEX$ and NEXT$ tokens. */
     3060     9983
     3061     9984    5                   CALL Z8ED$DISPOSE_HEAP(LEX$,
     3062     9985                                %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX$);
     3063     9988    5                          );
     3064     9989    5                   CALL Z8ED$DISPOSE_HEAP(NEXT$,
     3065     9990                                %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=NEXT$);
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:632  
     3066     9993    5                          );
     3067     9994
     3068     9995    5                   RETURN;
     3069     9996
     3070     9997    5                 END; /* If LEX$_end_column + 1 = NEXT$_column */
     3071     9998    4               ELSE
     3072     9999    5                 DO;
     3073    10000    5                   LEX_SYMBOL_QUEUE$ = NEXT$;
     3074    10001    5                   IF TO_LIST$ ~= ADDR (NIL) THEN
     3075    10002    5                     CALL DO_STRAIGHT_IN_LINE_REPLACE (0);
     3076    10003    5                   RETURN;
     3077    10004    5                 END;
     3078    10005    4             END; /* If Max_Token_Length >= Replacement symbol size */
     3079    10006    3         END; /* If NEXT$ = null & "TO" is area B & ==from== BY ==to== */
     3080    10007
     3081    10008    2       IF CUMM_LINE_PTR$ ~= ADDR(NIL) THEN
     3082    10009    3         DO;
     3083    10010    3           IF REP_BEG_LINE = REP_END_LINE THEN
     3084    10011    4             DO;
     3085    10012    4               CALL DUP_FOR_REP (CUMM_LINE_PTR$, CUMM_LINE_OFFSET);
     3086    10013    4               REP_BEG_LINE = REP_BEG_LINE + CUMM_LINE_OFFSET;
     3087    10014    4               REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;
     3088    10015    4               SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
     3089    10016    4                      REP_BEG_COLUMN,
     3090    10017    4                      REP_END_COLUMN - REP_BEG_COLUMN) = ' ';
     3091    10018    4             END;
     3092    10019    3           ELSE
     3093    10020    4             DO;
     3094    10021    4               CALL DUP_FOR_REP (CUMM_LINE_PTR$, CUMM_LINE_OFFSET);
     3095    10022    4               REP_BEG_LINE = REP_BEG_LINE + CUMM_LINE_OFFSET;
     3096    10023    4               REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;
     3097    10024
     3098    10025
     3099    10026    4               SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
     3100    10027    4                      REP_BEG_COLUMN,
     3101    10028    4                      MINIMUM (O1COM.MARGIN_R, CUMM_LINE_PTR$ -> FILL_BUFFER.
             10028                               LINE_LENGTH)
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:633  
     3102    10029    4                          - REP_BEG_COLUMN) = ' ';
     3103    10030
     3104    10031    4                L$ = CUMM_LINE_PTR$;
     3105    10032
     3106    10033    5                DO WHILE L$ ~= ADDR(NIL)
     3107    10034    5                     AND L$ -> FILL_BUFFER.NEXT$ ~= ADDR(NIL)
     3108    10035    5                     AND L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.ISN < REP_END_LINE;
     3109    10036
     3110    10037    5                  IF L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE THEN
     3111    10038    6                    DO;
     3112    10039    6                      TL$ = L$ -> FILL_BUFFER.NEXT$;
     3113    10040    6                      L$ -> FILL_BUFFER.NEXT$ = TL$ -> FILL_BUFFER.NEXT$;
     3114    10041    6                      CALL Z8ED$DISPOSE_HEAP (TL$,
     3115    10042    6                                              %MAX_INPUT_BUFFER_LEN);
     3116    10043    6                    END;
     3117    10044    5                  ELSE
     3118    10045    6                    DO;
     3119    10046    6                      IF NOT L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.
             10046                               OLD_REP_LINE THEN
     3120    10047    6                        L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.OLD_REP_LINE =
             10047                                 TRUE;
     3121    10048
     3122    10049    6                      L$ = L$ -> FILL_BUFFER.NEXT$;
     3123    10050    6                    END;
     3124    10051
     3125    10052    5                END;  /* DO WHILE */
     3126    10053
     3127    10054    4                CALL Z8EL$POSITION_LINE_LIST (REP_END_LINE,
     3128    10055    4                                              L$,
     3129    10056    4                                              999999999);
     3130    10057
     3131    10058    4                IF L$ ~= ADDR(NIL) THEN
     3132    10059    5                  DO;
     3133    10060    5                    CALL DUP_FOR_REP (L$, CUMM_LINE_OFFSET);
     3134    10061    5                    REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;
     3135    10062    5                    SUBSTR(L$ -> FILL_BUFFER.SOURCE_LINE,
     3136    10063    5                           O1COM.AREA_A_COLUMN_START - 1,
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:634  
     3137    10064    5                           REP_END_COLUMN - (O1COM.AREA_A_COLUMN_START - 1)) = ' ';
     3138    10065    5                  END;
     3139    10066    4              END;
     3140    10067    3         END;
     3141    10068
     3142    10069
     3143    10070    2       IF REPLACE$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT THEN
     3144    10071    3         DO;
     3145    10072    3           IF REPLACE$ -> REPLACE_ITEM.TO_PSEUDO_TEXT_LINES$ ~= ADDR(NIL) THEN
     3146    10073    4             DO;
     3147    10074    4               CALL SPLIT_LINE (REP_BEG_LINE,
     3148    10075    4                                REP_BEG_COLUMN,
     3149    10076    4                                CUMM_LINE_PTR$);
     3150    10077    4               TISN = CUMM_LINE_PTR$ -> FILL_BUFFER.ISN;
     3151    10078    4               ISN_INC = 0;
     3152    10079    4               L$ = REPLACE$ -> REPLACE_ITEM.TO_PSEUDO_TEXT_LINES$;
     3153    10080    4               ISN_BASE = L$ -> FILL_BUFFER.ISN;
     3154    10081
     3155    10082    5               DO WHILE (L$ ~= ADDR(NIL)
     3156    10083    5                         AND (L$ -> FILL_BUFFER.NEXT$ ~= ADDR(NIL)
     3157    10084    5                              OR SUBSTR (CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ ->
     3158    10085    5                                             FILL_BUFFER.SOURCE_LINE,
     3159    10086    5                                         O1COM.AREA_A_COLUMN_START,
     3160    10087    5                                         L$ -> FILL_BUFFER.LINE_LENGTH -
     3161    10088    5                                             O1COM.AREA_A_COLUMN_START) ~= ' '
     3162    10089    5                              OR NOT CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER
             10089                                       .LINE_TYPE.NEW_REP_LINE));
     3163    10090    5                 ISN_INC = ISN_INC + 1;
     3164    10091
     3165    10092                      %NEW_HEAP (@POINTER = TL$,
     3166    10093                                 @SIZE = %MAX_INPUT_BUFFER_LEN);
     3167    10098
     3168    10099    5                 TL$ -> FILL_BUFFER.LINE_LENGTH = L$ -> FILL_BUFFER.LINE_LENGTH;
     3169    10100    5                 TL$ -> FILL_BUFFER = L$ -> FILL_BUFFER;
     3170    10101    5                 IF OLD_LINE$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE THEN
     3171    10102    6                   DO;
     3172    10103    6                     TL$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:635  
     3173    10104    6                     CALL INSERT (TL$ -> FILL_BUFFER.SOURCE_LINE,
     3174    10105    6                                  O1COM.AREA_A_COLUMN_START - 1,
     3175    10106    6                                  1,
     3176    10107    6                                  'D');
     3177    10108    6                   END;
     3178    10109    5                 TL$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE = TRUE;
     3179    10110    5                 TL$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;
     3180    10111    5                 TL$ -> FILL_BUFFER.ISN = TISN + ISN_INC;
     3181    10112    5                 TL$ -> FILL_BUFFER.NEXT$ = CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$;
     3182    10113    5                 TL$ -> FILL_BUFFER.ESN = ' ';
     3183    10114    5                 TL$ -> FILL_BUFFER.LEVEL = CUMM_LINE_PTR$ -> FILL_BUFFER.LEVEL;
     3184    10115    5                 CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ = TL$;
     3185    10116
     3186    10117    5                 IF CUMM_LINE_PTR$ = CURRENT_BUFFER$ THEN
     3187    10118    6                   DO;
     3188    10119    6                     CURRENT_BUFFER$ = TL$;
     3189    10120    6                     EXPANDED_ISN = EXPANDED_ISN + 1;
     3190    10121    6                     BUFFER.ISN = EXPANDED_ISN;
     3191    10122    6                   END;
     3192    10123
     3193    10124    5                 CUMM_LINE_PTR$ = TL$;
     3194    10125    5                 L$ = L$ -> FILL_BUFFER.NEXT$;
     3195    10126    5               END;
     3196    10127
     3197    10128    4               IF L$ ~= ADDR(NIL) THEN
     3198    10129    5                 DO;
     3199    10130    5                   CALL INSERT (CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ ->
     3200    10131    5                                    FILL_BUFFER.SOURCE_LINE,
     3201    10132    5                                0,
     3202    10133    5                                L$ -> FILL_BUFFER.LINE_LENGTH,
     3203    10134    5                                L$ -> FILL_BUFFER.SOURCE_LINE);
     3204    10135    5                   IF CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.
             10135                            DEBUG_LINE THEN
     3205    10136    5                     CALL INSERT (CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ ->
     3206    10137    5                                      FILL_BUFFER.SOURCE_LINE,
     3207    10138    5                                  O1COM.AREA_A_COLUMN_START - 1, 1, 'D');
     3208    10139    5                   CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.FLAGS =
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:636  
     3209    10140    5                       CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.FLAGS
     3210    10141    5                       | L$ -> FILL_BUFFER.FLAGS;
     3211    10142    5                   CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.
             10142                            COPY_REPL_LINE = FALSE;
     3212    10143    5                   IF L$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE OR
     3213    10144    5                       (L$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE AND
     3214    10145    5                        NOT O1COM.DEBUGGING_MODE) THEN
     3215    10146    5                     BUFFER.CLASS = %END_OF_LINE;
     3216    10147    5                 END;
     3217    10148
     3218    10149    4               CALL ADJUST_ISN (ISN_INC,
     3219    10150    4                                CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$);
     3220    10151
     3221    10152                    /* Insert new tokens */
     3222    10153
     3223    10154    4               MATCH$ = REPLACE$ -> REPLACE_ITEM.TO_LIST$;
     3224    10155
     3225    10156    4               IF MATCH$ ~= ADDR(NIL) THEN
     3226    10157    5                 DO;
     3227    10158    5                   LEX$ = ADDR(LEX_SYMBOL);
     3228    10159
     3229    10160    6                   DO UNTIL MATCH$ = ADDR(NIL);
     3230    10161
     3231    10162    6                     IF NOT MATCH$ -> BASED_LEX_SYMBOL.B.COMMENT_TOKEN AND
     3232    10163    6                         (O1COM.DEBUGGING_MODE OR
     3233    10164    6                          NOT MATCH$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN) THEN
     3234    10165    7                       DO;
     3235    10166                              %COPY_TO_NEW_LEX_SYMBOL(FROM$=MATCH$, TO$=TL$);
     3236    10181    7                         LEX$ -> BASED_LEX_SYMBOL.NEXT$ = TL$;
     3237    10182    7                         IF CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE THEN
     3238    10183    7                           TL$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN = TRUE;
     3239    10184    7                         TL$ -> BASED_LEX_SYMBOL.LEVEL
     3240    10185    7                              = REPLACE$ -> REPLACE_ITEM.LEVEL - 1;
     3241    10186    7                         TL$ -> BASED_LEX_SYMBOL.LINE =
     3242    10187    7                            (TL$ -> BASED_LEX_SYMBOL.LINE - ISN_BASE) + TISN + 1;
     3243    10188    7                         TL$ -> BASED_LEX_SYMBOL.END_LINE =
     3244    10189    7                            (TL$ -> BASED_LEX_SYMBOL.END_LINE - ISN_BASE) + TISN + 1;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:637  
     3245    10190    7                         TL$ -> BASED_LEX_SYMBOL.B.REPLACED_TOKEN = TRUE;
     3246    10191    7                         LEX$ = TL$;
     3247    10192    7                       END;
     3248    10193    6                     MATCH$ = MATCH$ -> BASED_LEX_SYMBOL.NEXT$;
     3249    10194
     3250    10195    6                   END;  /* DO UNTIL */
     3251    10196
     3252    10197    5                   LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;
     3253    10198    5                   LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;
     3254    10199    5                 END;
     3255    10200    4             END;
     3256    10201    3         END;
     3257    10202    2       ELSE
     3258    10203    3         DO;
     3259    10204                /* Do a single token replace (non pseudo text) */
     3260    10205
     3261    10206    3           CALL CALC_MAX_TOKEN_LENGTH;
     3262    10207
     3263    10208    3           IF MAX_TOKEN_LENGTH < REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.
             10208                    SIZE THEN
     3264    10209    4             DO; /* Too Big -- at least two lines. */
     3265    10210    4               CALL SPLIT_LINE (REP_BEG_LINE,
     3266    10211    4                                REP_BEG_COLUMN,
     3267    10212    4                                CUMM_LINE_PTR$);
     3268    10213
     3269    10214                    %NEW_HEAP (@POINTER = TL$,
     3270    10215                               @SIZE = %MAX_INPUT_BUFFER_LEN);
     3271    10220
     3272    10221                    %INIT_BUFFER (@POINTER = TL$,
     3273    10222                                  @ISN = "CUMM_LINE_PTR$ -> FILL_BUFFER.ISN + 1",
     3274    10223                                  @NEXT$ = "CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$",
     3275    10224                                  @LEVEL = "CUMM_LINE_PTR$ -> FILL_BUFFER.LEVEL",
     3276    10225                                  @NEW_REP_LINE = TRUE,
     3277    10226                                  @LINE_LENGTH = O1COM.MARGIN_R,
     3278    10227                                  @SOURCE_LINE = ' ');
     3279    10255
     3280    10256    4               IF REP_DEBUG_LINE THEN
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:638  
     3281    10257    5                 DO;
     3282    10258    5                   TL$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;
     3283    10259    5                   SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,
     3284    10260    5                          O1COM.AREA_A_COLUMN_START - 1,
     3285    10261    5                          1) = 'D';
     3286    10262    5                 END;
     3287    10263
     3288    10264    4               CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ = TL$;
     3289    10265
     3290    10266    4               SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,
     3291    10267    4                      REP_BEG_COLUMN,
     3292    10268    4                      O1COM.MARGIN_R - REP_BEG_COLUMN)
     3293    10269    4                 = REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SYMBOL;
     3294    10270
     3295    10271    4               IF  REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SIZE
     3296    10272    4                     > O1COM.MARGIN_R - REP_BEG_COLUMN
     3297    10273    4               AND COMCOM.OB.FORMAT = FALSE THEN
     3298    10274    5                 DO;
     3299    10275                        /*N*
     3300    10276                           May want to expand this later to issue actual continuation
     3301    10277                           lines.
     3302    10278                        */
     3303    10279    5                   TL$ -> FILL_BUFFER.LINE_LENGTH = 75;
     3304    10280    5                   SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,
     3305    10281    5                          O1COM.MARGIN_R,
     3306    10282    5                          3) = '...';
     3307    10283    5                 END;
     3308    10284
     3309    10285    4               CALL ADJUST_ISN (1,
     3310    10286    4                                TL$ -> FILL_BUFFER.NEXT$);
     3311    10287
     3312    10288    4               CALL INSERT_TOKEN (REPLACE$ -> REPLACE_ITEM.TO_LIST$,
     3313    10289    4                                  TL$ -> FILL_BUFFER.ISN,
     3314    10290    4                                  REP_BEG_COLUMN);
     3315    10291    4             END;
     3316    10292    3           ELSE /* One line -- do straight in-line replacement */
     3317    10293    3             CALL DO_STRAIGHT_IN_LINE_REPLACE (0);
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:639  
     3318    10294
     3319    10295    3         END;
     3320    10296
     3321    10297    2     END DO_REPLACE;
     3322    10298
     3323    10299        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:640  
     3324    10300    1   START_REPLACE_LEVEL : PROC ;
     3325    10301
     3326    10302
     3327    10303          /* Find a potential candidate for replacement */
     3328    10304
     3329    10305    2     REPLACE$ = REPLACE_LIST.LINK$;
     3330    10306
     3331    10307    3     DO WHILE REPLACE$ ~= ADDR(NIL)
     3332    10308    3                AND (REPLACE$ -> REPLACE_ITEM.LEVEL > LEX_SYMBOL_QUEUE$ ->
             10308                         BASED_LEX_SYMBOL.LEVEL
     3333    10309    3                        OR
     3334    10310    3                     REPLACE$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SYMBOL
     3335    10311    3                        ~= LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.SYMBOL);
     3336    10312
     3337    10313    3       REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;
     3338    10314
     3339    10315    3     END;  /* DO WHILE */
     3340    10316
     3341    10317    2   END START_REPLACE_LEVEL;
     3342    10318
     3343    10319        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:641  
     3344    10320        /* Main body of POSSIBLE_REPLACE */
     3345    10321
     3346    10322    1   SAVE_INHIBIT_DUMP_LINES = INHIBIT_DUMP_LINES;
     3347    10323    1   INHIBIT_DUMP_LINES = TRUE;
     3348    10324
     3349    10325    1   CALL START_REPLACE_LEVEL ;
     3350    10326
     3351    10327    1   IF REPLACE$ ~= ADDR(NIL) THEN
     3352    10328    2     DO;
     3353    10329    2       REPLACEMENT_FOUND = FALSE;
     3354    10330
     3355    10331    3       DO WHILE NOT REPLACEMENT_FOUND
     3356    10332    3                     AND REPLACE$ ~= ADDR(NIL);
     3357    10333
     3358    10334    3         IF REPLACE$ -> REPLACE_ITEM.LEVEL >= LOWEST_LEVEL THEN
     3359    10335    3           CALL MATCH_LISTS
     3360    10336    3             WHENRETURN
     3361    10337    4               DO;
     3362    10338    4                 IF REPLACEMENT_FOUND THEN
     3363    10339    4                   CALL DO_REPLACE;
     3364    10340    4                 ELSE
     3365    10341    4                   REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;
     3366    10342    4               END;
     3367    10343    3             WHENALTRETURN
     3368    10344    4               DO;
     3369    10345    4                 CALL START_REPLACE_LEVEL ;
     3370    10346    4               END;
     3371    10347    3         ELSE
     3372    10348    3           REPLACE$ = ADDR(NIL);
     3373    10349
     3374    10350    3       END;
     3375    10351
     3376    10352    2       IF REPLACEMENT_FOUND THEN
     3377    10353    3         DO;
     3378    10354    3           INHIBIT_DUMP_LINES = SAVE_INHIBIT_DUMP_LINES;
     3379    10355    3           RETURN;
     3380    10356    3         END;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:642  
     3381    10357    2     END;
     3382    10358
     3383    10359    1   INHIBIT_DUMP_LINES = SAVE_INHIBIT_DUMP_LINES;
     3384    10360    1   ALTRETURN;  /* No replace was done */
     3385    10361
     3386    10362    1   END Z8EL$POSSIBLE_REPLACE;
     3387    10363
     3388    10364

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:643  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$POSSIBLE_REPLACE.

   Procedure Z8EL$POSSIBLE_REPLACE requires 1644 words for executable code.
   Procedure Z8EL$POSSIBLE_REPLACE requires 72 words of local(AUTO) storage.

    No errors detected in file Z8EL.:Z8A6TSI    .

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:644  

 Object Unit name= Z8EL$POSSIBLE_REPLACE                      File name= Z8EL.:Z8A6TOU
 UTS= AUG 09 '97 12:20:45.00 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  HEAP$
    2  LblCom even  none    90    132  LEX_SYMBOL
    3  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    5  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    6  LblCom even  none     1      1  CURRENT_SYMBOL_LEVEL
    7  LblCom even  none     1      1  REPLACE_ACTIVE
    8  LblCom even  none     1      1  IGNORE_COPY_REPLACE
    9  LblCom even  none     1      1  COPY_DEBUG_LEVEL
   10  LblCom even  none     4      4  REPLACE_LIST
   11  LblCom even  none     1      1  LEX_SYMBOL_QUEUE$
   12  LblCom even  none     1      1  SCANNER_STATE
   13  LblCom even  none     1      1  CURRENT_BUFFER$
   14  LblCom even  none     1      1  LOOKAHEAD_BUFFER$
   15  LblCom even  none     1      1  CURRENT_LINE_LEVEL
   16  LblCom even  none     1      1  LINE_LIST$
   17  LblCom even  none     7      7  BUFFER
   18  LblCom even  none     1      1  ORIGINAL_ISN
   19  LblCom even  none     1      1  EXPANDED_ISN
   20  LblCom even  none     1      1  ISN_FOR_EXP_SRC
   21  LblCom even  none     1      1  INHIBIT_DUMP_LINES
   22  LblCom even  none     1      1  LEX_STATE
   23  RoData even  UTS      4      4  Z8EL$POSSIBLE_REPLACE
   24   Proc  even  none  1644   3154  Z8EL$POSSIBLE_REPLACE
   25  RoData even  none    17     21  Z8EL$POSSIBLE_REPLACE
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:645  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    24      0   yes    yes     yes      Std        1  Z8EL$POSSIBLE_REPLACE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8ES$SCANNER
         yes           Std       0 Z8EL$GET_NEXT_SCANNER_LINE
         yes           Std       2 Z8ED$NEW_HEAP
         yes           Std       0 Z8EL$PROCESS_COPY
         yes           Std       2 Z8ED$DISPOSE_HEAP
         yes           Std       3 Z8EL$POSITION_LINE_LIST
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    USERWORD_SCAN_TABLE              r    ANSI_USERWORD_SCAN_TABLE         r    ASCII_SEARCH_TABLE
r    BLANK_SCAN_TABLE                 r    DIGIT_SCAN_TABLE                 r    LETTER_SEARCH_TABLE
r    DOUBLE_QUOTE_SEARCH_TABLE        r    SINGLE_QUOTE_SEARCH_TABLE        r   DBL_QUOTE_PSEUDO_SEARCH_TABLE
r    SNGL_QUOTE_PSEUDO_SEARCH_TABLE   r    SEPARATORS_TABLE                 r    LOWER_TO_UPPER_CASE
r    CURRENCY_SIGN_CHARS                   COMCOM                                O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:646  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:647  


     2489        1        /*T***********************************************************/
     2490        2        /*T*                                                         */
     2491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2492        4        /*T*                                                         */
     2493        5        /*T***********************************************************/
     2494        6        Z8EL$POSSIBLE_REPLACE : PROC (LOWEST_LEVEL) ALTRET;

      6 24 000000   000000 700200 xent  Z8EL$POSSIB* TSX0  ! X66_AUTO_1
        24 000001   000110 000001                    ZERO    72,1
        24 000002   003074 710000 24                 TRA     s:10322

     2495        7
     2496        8    1   DCL LOWEST_LEVEL SBIN;
     2497        9
     2498       10        %EQU PHASE = 1;
     2499       11        %INCLUDE Z8A_DEFC;
     2500       79        %INCLUDE Z8A_SUPP_MAC;
     2501     2479        %INCLUDE Z8E_HEAP;
     2502     2535        %INCLUDE Z8E_STACKS;
     2503     4801        %INCLUDE Z8E_REPLACE;
     2504     5104        %INCLUDE Z8E_WINDOW;
     2505     7174        %INCLUDE Z8E_BUFFERS;
     2506     7364        %INCLUDE Z8E_TABLES;
     2507     7917        %INCLUDE Z8A_COMCOM ;
     2508     8567        %INCLUDE Z8E_O1COM ;
     2509     9328
     2510     9329    1   DCL Z8EL$POSITION_LINE_LIST ENTRY (3);
     2511     9330    1   DCL Z8EL$PROCESS_COPY ENTRY;
     2512     9331
     2513     9332
     2514     9333
     2515     9334    1   DCL REPLACE$ PTR;
     2516     9335    1   DCL REPLACEMENT_FOUND BOOLEAN;
     2517     9336    1   DCL SAVE_INHIBIT_DUMP_LINES BOOLEAN;
     2518     9337    1   DCL INHIBIT_DUMP_LINES BOOLEAN EXT;
     2519     9338    1   DCL LEX_STATE          SBIN WORD EXT; /* Normal or Picture or ... */
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:648  
     2520     9339    1   DCL PICTURE_TOKEN      BOOLEAN;       /* PICTURE found in match list */
     2521     9340
     2522     9341
     2523     9342
     2524     9343        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:649  
     2525     9344    1     MATCH_LISTS : PROC ALTRET;

   9344 24 000003   200010 741300       MATCH_LISTS  STX1  ! PICTURE_TOKEN+1,,AUTO
        24 000004   000062 710000 24                 TRA     s:9390

     2526     9345
     2527     9346    2       DCL MATCH$ PTR;
     2528     9347    2       DCL LEX$ PTR;
     2529     9348
     2530     9349
     2531     9350    2       EMBEDDED_COPY : PROC;

   9350 24 000005   200014 741300       EMBEDDED_CO* STX1  ! REP_BEG_LINE+1,,AUTO

     2532     9351
     2533     9352    3         DCL SAVED_LEX_SYMBOL_QUEUE$ PTR;
     2534     9353
     2535     9354    3         SAVED_LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$;

   9354 24 000006   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 000007   200015 756100                    STQ     SAVED_LEX_SYMBOL_QUEUE$,,AUTO

     2536     9355    3         LEX_SYMBOL_QUEUE$ = ADDR(NIL);

   9355 24 000010   000000 236000 25                 LDQ     0
        24 000011   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     2537     9356
     2538     9357    3         CALL Z8EL$PROCESS_COPY;

   9357 24 000012   000001 631400 25                 EPPR1   1
        24 000013   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        24 000014   000000 011000                    NOP     0

     2539     9358
     2540     9359    3         LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:650  
   9359 24 000015   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 000016   200012 470500                    LDP0    LEX$,,AUTO
        24 000017   000000 756100                    STQ     0,,PR0

     2541     9360    3         LEX_SYMBOL_QUEUE$ = SAVED_LEX_SYMBOL_QUEUE$;

   9360 24 000020   200015 236100                    LDQ     SAVED_LEX_SYMBOL_QUEUE$,,AUTO
        24 000021   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     2542     9361
     2543     9362    3       END EMBEDDED_COPY;

   9362 24 000022   200014 221300                    LDX1  ! REP_BEG_LINE+1,,AUTO
        24 000023   000001 702211                    TSX2  ! 1,X1

     2544     9363
     2545     9364
     2546     9365    2     CHECK_LOWER_LEVEL : PROC;

   9365 24 000024   200014 741300       CHECK_LOWER* STX1  ! REP_BEG_LINE+1,,AUTO

     2547     9366
     2548     9367    3       DCL SAVED_LEX_SYMBOL_QUEUE$ PTR;
     2549     9368
     2550     9369    3       IF LEX$ -> BASED_LEX_SYMBOL.NEXT$ -> BASED_LEX_SYMBOL.LEVEL >

   9369 24 000025   200012 470500                    LDP0    LEX$,,AUTO
        24 000026   000000 471500                    LDP1    0,,PR0
        24 000027   200004 473500                    LDP3    REPLACE$,,AUTO
        24 000030   100003 236100                    LDQ     3,,PR1
        24 000031   300003 116100                    CMPQ    3,,PR3
        24 000032   000060 604400 24                 TMOZ    s:9386

     2551     9370    3             REPLACE$ -> REPLACE_ITEM.LEVEL THEN
     2552     9371    4         DO;

     2553     9372    4           SAVED_LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:651  

   9372 24 000033   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 000034   200015 756100                    STQ     SAVED_LEX_SYMBOL_QUEUE$,,AUTO

     2554     9373    4           LEX_SYMBOL_QUEUE$ = LEX$ -> BASED_LEX_SYMBOL.NEXT$;

   9373 24 000035   000000 236100                    LDQ     0,,PR0
        24 000036   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     2555     9374
     2556     9375    4           CALL Z8EL$POSSIBLE_REPLACE (REPLACE$ -> REPLACE_ITEM.LEVEL)

   9375 24 000037   200004 236100                    LDQ     REPLACE$,,AUTO
        24 000040   000003 036003                    ADLQ    3,DU
        24 000041   200102 756100                    STQ     T$+2,,AUTO
        24 000042   200102 630500                    EPPR0   T$+2,,AUTO
        24 000043   000002 631400 25                 EPPR1   2
        24 000044   000000 701000 24                 TSX1    s:6
        24 000045   000047 702000 24                 TSX2    s:9378
        24 000046   000053 710000 24                 TRA     s:9382

     2557     9376    4             WHENALTRETURN
     2558     9377    5               DO;

     2559     9378    5                 LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.LEVEL

   9378 24 000047   200004 470500                    LDP0    REPLACE$,,AUTO
        24 000050   000000 471400 11                 LDP1    LEX_SYMBOL_QUEUE$
        24 000051   000003 235100                    LDA     3,,PR0
        24 000052   100003 755100                    STA     3,,PR1

     2560     9379    5                     = REPLACE$ -> REPLACE_ITEM.LEVEL;
     2561     9380    5               END;

     2562     9381
     2563     9382    4           LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:652  
   9382 24 000053   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 000054   200012 470500                    LDP0    LEX$,,AUTO
        24 000055   000000 756100                    STQ     0,,PR0

     2564     9383    4           LEX_SYMBOL_QUEUE$ = SAVED_LEX_SYMBOL_QUEUE$;

   9383 24 000056   200015 236100                    LDQ     SAVED_LEX_SYMBOL_QUEUE$,,AUTO
        24 000057   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     2565     9384    4         END;

     2566     9385
     2567     9386    3     END CHECK_LOWER_LEVEL;

   9386 24 000060   200014 221300                    LDX1  ! REP_BEG_LINE+1,,AUTO
        24 000061   000001 702211                    TSX2  ! 1,X1

     2568     9387
     2569     9388            /* Main body of MATCH_LISTS */
     2570     9389
     2571     9390    2       LEX$ = LEX_SYMBOL_QUEUE$;

   9390 24 000062   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 000063   200012 756100                    STQ     LEX$,,AUTO

     2572     9391    2       MATCH$ = REPLACE$ -> REPLACE_ITEM.FROM_LIST$;

   9391 24 000064   200004 470500                    LDP0    REPLACE$,,AUTO
        24 000065   000001 236100                    LDQ     1,,PR0
        24 000066   200011 756100                    STQ     MATCH$,,AUTO

     2573     9392    2       PICTURE_TOKEN = FALSE;

   9392 24 000067   200007 450100                    STZ     PICTURE_TOKEN,,AUTO

     2574     9393
     2575     9394    3       DO WHILE MATCH$ ~= ADDR(NIL)
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:653  

   9394 24 000070   000212 710000 24                 TRA     s:9458

     2576     9395    3                    AND MATCH$ -> BASED_LEX_SYMBOL.SYMBOL
     2577     9396    3                            = LEX$ -> BASED_LEX_SYMBOL.SYMBOL
     2578     9397    3                     AND LEX$ -> BASED_LEX_SYMBOL.LEVEL >=
     2579     9398    3                             REPLACE$ -> REPLACE_ITEM.LEVEL;
     2580     9399
     2581     9400              /*Don't replace parts of picture strings (STAR T02424) */
     2582     9401
     2583     9402    3         IF SUBSTR (MATCH$ -> BASED_LEX_SYMBOL.SYMBOL, 0, MATCH$ -> BASED_LEX_SYMBOL.
              9402                  SIZE) = 'PICTURE'

   9402 24 000071   200011 470500                    LDP0    MATCH$,,AUTO
        24 000072   000010 720100                    LXL0    8,,PR0
        24 000073   040000 106540                    CMPC    fill='040'O
        24 000074   000011 000010                    ADSC9   9,,PR0                   cn=0,n=*X0
        24 000075   000000 000007 23                 ADSC9   0                        cn=0,n=7
        24 000076   000104 600000 24                 TZE     s:9404
        24 000077   000010 720100                    LXL0    8,,PR0
        24 000100   040000 106540                    CMPC    fill='040'O
        24 000101   000011 000010                    ADSC9   9,,PR0                   cn=0,n=*X0
        24 000102   000000 000003 23                 ADSC9   0                        cn=0,n=3
        24 000103   000106 601000 24                 TNZ     s:9406

     2584     9403    3         OR SUBSTR (MATCH$ -> BASED_LEX_SYMBOL.SYMBOL, 0, MATCH$ -> BASED_LEX_SYMBOL.
              9403                  SIZE) = 'PIC' THEN
     2585     9404    3           PICTURE_TOKEN = TRUE;

   9404 24 000104   400000 236003                    LDQ     -131072,DU
        24 000105   200007 756100                    STQ     PICTURE_TOKEN,,AUTO

     2586     9405
     2587     9406    3         IF PICTURE_TOKEN = FALSE

   9406 24 000106   200007 234100                    SZN     PICTURE_TOKEN,,AUTO
        24 000107   000115 604000 24                 TMI     s:9410
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:654  
        24 000110   000000 235000 22                 LDA     LEX_STATE
        24 000111   000004 115007                    CMPA    4,DL
        24 000112   000115 601000 24                 TNZ     s:9410

     2588     9407    3         AND LEX_STATE = %LS_PICTURE_OR_IS THEN
     2589     9408    3           RETURN; /* REPLACEMENT_FOUND = FALSE */

   9408 24 000113   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 000114   000001 702211                    TSX2  ! 1,X1

     2590     9409
     2591     9410    3         MATCH$ = MATCH$ -> BASED_LEX_SYMBOL.NEXT$;

   9410 24 000115   000000 236100                    LDQ     0,,PR0
        24 000116   200011 756100                    STQ     MATCH$,,AUTO

     2592     9411
     2593     9412    3         IF MATCH$ ~= ADDR(NIL) THEN

   9412 24 000117   000000 116000 25                 CMPQ    0
        24 000120   000212 600000 24                 TZE     s:9458

     2594     9413    4           DO;

     2595     9414    4             IF LEX$ -> BASED_LEX_SYMBOL.NEXT$ = ADDR(NIL) THEN

   9414 24 000121   200012 470500                    LDP0    LEX$,,AUTO
        24 000122   000000 236100                    LDQ     0,,PR0
        24 000123   000000 116000 25                 CMPQ    0
        24 000124   000205 601000 24                 TNZ     s:9453

     2596     9415    5               DO;

     2597     9416                      %GET_BRAND_NEW_TOKEN;

   9418 24 000125   000001 631400 25                 EPPR1   1
        24 000126   000000 701000 xent               TSX1    Z8ES$SCANNER
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:655  
        24 000127   000000 011000                    NOP     0

   9419 24 000130   000001 235000 2                  LDA     LEX_SYMBOL+1
        24 000131   000142 601000 24                 TNZ     s:9427

   9420 24 000132   000001 631400 25                 EPPR1   1
        24 000133   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        24 000134   000000 011000                    NOP     0

   9421 24 000135   000001 631400 25                 EPPR1   1
        24 000136   000000 701000 xent               TSX1    Z8ES$SCANNER
        24 000137   000000 011000                    NOP     0

   9422 24 000140   000001 235000 2                  LDA     LEX_SYMBOL+1
        24 000141   000132 600000 24                 TZE     s:9420

     2598     9425
     2599     9426                      /* Check for embedded copy */
     2600     9427    5                 IF LEX_SYMBOL.SIZE = 4

   9427 24 000142   000010 236000 2                  LDQ     LEX_SYMBOL+8
        24 000143   000004 116007                    CMPQ    4,DL
        24 000144   000154 601000 24                 TNZ     s:9437
        24 000145   000011 236000 2                  LDQ     LEX_SYMBOL+9
        24 000146   000002 116000 23                 CMPQ    2
        24 000147   000154 601000 24                 TNZ     s:9437

     2601     9428    5                      AND SUBSTR(LEX_SYMBOL.SYMBOL,0,4) = 'COPY' THEN
     2602     9429    6                   DO;

     2603     9430    6                     CALL EMBEDDED_COPY;

   9430 24 000150   000005 701000 24                 TSX1    EMBEDDED_COPY
        24 000151   000000 011000                    NOP     0

     2604     9431    6                     ALTRETURN;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:656  
   9431 24 000152   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 000153   000000 702211                    TSX2  ! 0,X1

     2605     9432    6                   END;
     2606     9433
     2607     9434                      %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)",
     2608     9435                                              TO$ = HEAP$);

   9437 24 000154   000010 236000 2                  LDQ     LEX_SYMBOL+8
        24 000155   000047 036007                    ADLQ    39,DL
        24 000156   000004 506007                    DIV     4,DL
        24 000157   200102 756100                    STQ     T$+2,,AUTO
        24 000160   200102 630500                    EPPR0   T$+2,,AUTO
        24 000161   200105 450500                    STP0    T$+5,,AUTO
        24 000162   000004 236000 25                 LDQ     4
        24 000163   200104 756100                    STQ     T$+4,,AUTO
        24 000164   200104 630500                    EPPR0   T$+4,,AUTO
        24 000165   000003 631400 25                 EPPR1   3
        24 000166   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 000167   000000 011000                    NOP     0

   9444 24 000170   000000 470400 1                  LDP0    HEAP$
        24 000171   000010 235000 2                  LDA     LEX_SYMBOL+8
        24 000172   000010 755100                    STA     8,,PR0

   9445 24 000173   000010 720100                    LXL0    8,,PR0
        24 000174   000044 621010                    EAX1    36,X0
        24 000175   000010 722000 2                  LXL2    LEX_SYMBOL+8
        24 000176   000044 623012                    EAX3    36,X2
        24 000177   000140 100440                    MLR     fill='000'O
        24 000200   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        24 000201   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     2609     9450    5                 LEX$ -> BASED_LEX_SYMBOL.NEXT$ = HEAP$;

   9450 24 000202   000000 236000 1                  LDQ     HEAP$
        24 000203   200012 470500                    LDP0    LEX$,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:657  
        24 000204   000000 756100                    STQ     0,,PR0

     2610     9451    5               END;

     2611     9452
     2612     9453    4             CALL CHECK_LOWER_LEVEL;

   9453 24 000205   000024 701000 24                 TSX1    CHECK_LOWER_LEVEL
        24 000206   000000 011000                    NOP     0

     2613     9454
     2614     9455    4             LEX$ = LEX$ -> BASED_LEX_SYMBOL.NEXT$;

   9455 24 000207   200012 470500                    LDP0    LEX$,,AUTO
        24 000210   000000 236100                    LDQ     0,,PR0
        24 000211   200012 756100                    STQ     LEX$,,AUTO

     2615     9456    4           END;

     2616     9457
     2617     9458    3       END;  /* DO WHILE */

   9458 24 000212   200011 236100                    LDQ     MATCH$,,AUTO
        24 000213   000000 116000 25                 CMPQ    0
        24 000214   000231 600000 24                 TZE     s:9460
        24 000215   200011 470500                    LDP0    MATCH$,,AUTO
        24 000216   000010 720100                    LXL0    8,,PR0
        24 000217   200012 471500                    LDP1    LEX$,,AUTO
        24 000220   100010 721100                    LXL1    8,,PR1
        24 000221   040140 106540                    CMPC    fill='040'O
        24 000222   000011 000010                    ADSC9   9,,PR0                   cn=0,n=*X0
        24 000223   100011 000011                    ADSC9   9,,PR1                   cn=0,n=*X1
        24 000224   000231 601000 24                 TNZ     s:9460
        24 000225   200004 473500                    LDP3    REPLACE$,,AUTO
        24 000226   100003 236100                    LDQ     3,,PR1
        24 000227   300003 116100                    CMPQ    3,,PR3
        24 000230   000071 605000 24                 TPL     s:9402
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:658  

     2618     9459
     2619     9460    2       IF MATCH$ = ADDR(NIL) THEN

   9460 24 000231   200011 236100                    LDQ     MATCH$,,AUTO
        24 000232   000000 116000 25                 CMPQ    0
        24 000233   000236 601000 24                 TNZ     s:9463

     2620     9461    2         REPLACEMENT_FOUND = TRUE;

   9461 24 000234   400000 236003                    LDQ     -131072,DU
        24 000235   200005 756100                    STQ     REPLACEMENT_FOUND,,AUTO

     2621     9462
     2622     9463    2     END MATCH_LISTS;

   9463 24 000236   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 000237   000001 702211                    TSX2  ! 1,X1

     2623     9464
     2624     9465        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:659  
     2625     9466    1     DO_REPLACE : PROC;

   9466 24 000240   200010 741300       DO_REPLACE   STX1  ! PICTURE_TOKEN+1,,AUTO
        24 000241   001015 710000 24                 TRA     s:9718

     2626     9467    2       DCL MATCH$ PTR;
     2627     9468    2       DCL LEX$ PTR;
     2628     9469
     2629     9470    2       DCL REP_BEG_LINE SBIN;
     2630     9471    2       DCL REP_BEG_COLUMN SBIN;
     2631     9472    2       DCL REP_DEBUG_LINE BOOLEAN;
     2632     9473    2       DCL CUMM_LINE_OFFSET SBIN;
     2633     9474    2       DCL CUMM_LINE_PTR$ PTR;
     2634     9475    2       DCL REP_END_LINE SBIN;
     2635     9476    2       DCL REP_END_COLUMN SBIN;
     2636     9477
     2637     9478    2       DCL L$               PTR;
     2638     9479    2       DCL TL$              PTR;
     2639     9480    2       DCL TISN             SBIN;
     2640     9481    2       DCL ISN_INC          SBIN;
     2641     9482    2       DCL ISN_BASE         SBIN;
     2642     9483    2       DCL NON_BLANK_COL    SBIN;
     2643     9484    2       DCL CHAR_CLASS       SBIN;
     2644     9485    2       DCL TEMP_SBIN        SBIN BYTE CALIGNED;
     2645     9486    2       DCL TEMP_CHAR1       REDEF TEMP_SBIN CHAR (1);
     2646     9487    2       DCL MAX_TOKEN_LENGTH SBIN;
     2647     9488    2       DCL SAVE_SIZE        SBIN;
     2648     9489    2       DCL NEXT$            PTR;
     2649     9490    2       DCL NEW$             PTR;
     2650     9491    2       DCL REP_SIZE         SBIN;
     2651     9492    2       DCL BLANK_SPACE      SBIN;
     2652     9493    2       DCL TO_LIST$         PTR;
     2653     9494    2       DCL OLD_LINE$        PTR;
     2654     9495    2       DCL TEMP_CHAR60      CHAR (60);
     2655     9496    2       DCL SHIFT_RIGHT      SBIN;
     2656     9497
     2657     9498        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:660  
     2658     9499
     2659     9500    2       ADJUST_ISN : PROC (ISN_INC,

   9500 24 000242   200074 741300       ADJUST_ISN   STX1  ! L$+1,,AUTO

     2660     9501    2                          LINE$);
     2661     9502
     2662     9503    3         DCL ISN_INC SBIN;
     2663     9504    3         DCL LINE$ PTR;
     2664     9505
     2665     9506    3         DCL L$ PTR;
     2666     9507    3         DCL T$ PTR;
     2667     9508
     2668     9509    3         L$ = LINE$;

   9509 24 000243   200076 470500                    LDP0    @LINE$,,AUTO
        24 000244   000000 236100                    LDQ     0,,PR0
        24 000245   200077 756100                    STQ     L$,,AUTO

     2669     9510
     2670     9511    4         DO WHILE L$ ~= ADDR(NIL)

   9511 24 000246   000256 710000 24                 TRA     s:9516

     2671     9512    4              AND L$ ~= CURRENT_BUFFER$;
     2672     9513
     2673     9514    4           L$ -> FILL_BUFFER.ISN = L$ -> FILL_BUFFER.ISN + ISN_INC;

   9514 24 000247   200077 470500                    LDP0    L$,,AUTO
        24 000250   200075 471500                    LDP1    @ISN_INC,,AUTO
        24 000251   000004 236100                    LDQ     4,,PR0
        24 000252   100000 036100                    ADLQ    0,,PR1
        24 000253   000004 756100                    STQ     4,,PR0

     2674     9515    4           L$ = L$ -> FILL_BUFFER.NEXT$;

   9515 24 000254   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:661  
        24 000255   200077 756100                    STQ     L$,,AUTO

     2675     9516    4         END;

   9516 24 000256   000000 116000 25                 CMPQ    0
        24 000257   000262 600000 24                 TZE     s:9518
        24 000260   000000 116000 13                 CMPQ    CURRENT_BUFFER$
        24 000261   000247 601000 24                 TNZ     s:9514

     2676     9517
     2677     9518    3         IF L$ = CURRENT_BUFFER$ THEN

   9518 24 000262   000000 116000 13                 CMPQ    CURRENT_BUFFER$
        24 000263   000275 601000 24                 TNZ     s:9527

     2678     9519    4           DO;

     2679     9520    4             EXPANDED_ISN = EXPANDED_ISN + ISN_INC;

   9520 24 000264   200075 470500                    LDP0    @ISN_INC,,AUTO
        24 000265   000000 236000 19                 LDQ     EXPANDED_ISN
        24 000266   000000 036100                    ADLQ    0,,PR0
        24 000267   000000 756000 19                 STQ     EXPANDED_ISN

     2680     9521    4             L$ -> FILL_BUFFER.ISN = L$ -> FILL_BUFFER.ISN + ISN_INC;

   9521 24 000270   200077 471500                    LDP1    L$,,AUTO
        24 000271   100004 236100                    LDQ     4,,PR1
        24 000272   000000 036100                    ADLQ    0,,PR0
        24 000273   100004 756100                    STQ     4,,PR1

     2681     9522    4             BUFFER.ISN = L$ -> FILL_BUFFER.ISN;

   9522 24 000274   000002 756000 17                 STQ     BUFFER+2

     2682     9523    4           END;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:662  
     2683     9524
     2684     9525                /* Adjust tokens previously scanned */
     2685     9526
     2686     9527    3           T$ = LEX_SYMBOL_QUEUE$;

   9527 24 000275   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 000276   200100 756100                    STQ     T$,,AUTO

     2687     9528    4           DO WHILE T$ ~= ADDR(NIL);

   9528 24 000277   000312 710000 24                 TRA     s:9532

     2688     9529    4             T$ -> BASED_LEX_SYMBOL.LINE = T$ -> BASED_LEX_SYMBOL.LINE + ISN_INC;

   9529 24 000300   200100 470500                    LDP0    T$,,AUTO
        24 000301   200075 471500                    LDP1    @ISN_INC,,AUTO
        24 000302   000004 236100                    LDQ     4,,PR0
        24 000303   100000 036100                    ADLQ    0,,PR1
        24 000304   000004 756100                    STQ     4,,PR0

     2689     9530    4             T$ -> BASED_LEX_SYMBOL.END_LINE = T$ -> BASED_LEX_SYMBOL.END_LINE +
              9530                      ISN_INC;

   9530 24 000305   000006 236100                    LDQ     6,,PR0
        24 000306   100000 036100                    ADLQ    0,,PR1
        24 000307   000006 756100                    STQ     6,,PR0

     2690     9531    4             T$ = T$ -> BASED_LEX_SYMBOL.NEXT$;

   9531 24 000310   000000 236100                    LDQ     0,,PR0
        24 000311   200100 756100                    STQ     T$,,AUTO

     2691     9532    4           END;

   9532 24 000312   000000 116000 25                 CMPQ    0
        24 000313   000300 601000 24                 TNZ     s:9529

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:663  
     2692     9533    3       END ADJUST_ISN;

   9533 24 000314   200074 221300                    LDX1  ! L$+1,,AUTO
        24 000315   000001 702211                    TSX2  ! 1,X1

     2693     9534
     2694     9535        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:664  
     2695     9536    2       SPLIT_LINE : PROC (LINE,

   9536 24 000316   200062 741300       SPLIT_LINE   STX1  ! SHIFT_RIGHT+1,,AUTO

     2696     9537    2                          COLUMN,
     2697     9538    2                          LINE$);
     2698     9539
     2699     9540    3         DCL LINE SBIN;
     2700     9541    3         DCL COLUMN SBIN;
     2701     9542    3         DCL LINE$ PTR;
     2702     9543
     2703     9544    3         DCL L$ PTR;
     2704     9545
     2705     9546    3         LINE$ = ADDR(NIL);

   9546 24 000317   000000 236000 25                 LDQ     0
        24 000320   200065 470500                    LDP0    @LINE$,,AUTO
        24 000321   000000 756100                    STQ     0,,PR0

     2706     9547    3         CALL Z8EL$POSITION_LINE_LIST (LINE, LINE$, 999999999);

   9547 24 000322   000007 236000 25                 LDQ     7
        24 000323   200104 756100                    STQ     T$+4,,AUTO
        24 000324   200065 236100                    LDQ     @LINE$,,AUTO
        24 000325   200063 235100                    LDA     @LINE,,AUTO
        24 000326   200102 757100                    STAQ    T$+2,,AUTO
        24 000327   200102 630500                    EPPR0   T$+2,,AUTO
        24 000330   000005 631400 25                 EPPR1   5
        24 000331   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        24 000332   000000 011000                    NOP     0

     2707     9548
     2708     9549    3         IF LINE$ ~= ADDR(NIL) THEN

   9549 24 000333   200065 470500                    LDP0    @LINE$,,AUTO
        24 000334   000000 236100                    LDQ     0,,PR0
        24 000335   000000 116000 25                 CMPQ    0
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:665  
        24 000336   000471 600000 24                 TZE     s:9588

     2709     9550    4           DO;

     2710     9551    4             IF SUBSTR (LINE$ -> FILL_BUFFER.SOURCE_LINE,

   9551 24 000337   000000 471500                    LDP1    0,,PR0
        24 000340   100012 720100                    LXL0    10,,PR1
        24 000341   100012 236100                    LDQ     10,,PR1
        24 000342   000123 116000 xsym               CMPQ    O1COM+83
        24 000343   000345 604400 24                 TMOZ    s:9551+6
        24 000344   000123 236000 xsym               LDQ     O1COM+83
        24 000345   200064 473500                    LDP3    @COLUMN,,AUTO
        24 000346   300000 136100                    SBLQ    0,,PR3
        24 000347   300000 235100                    LDA     0,,PR3
        24 000350   000000 621006                    EAX1    0,QL
        24 000351   040000 106545                    CMPC    fill='040'O
        24 000352   100013 000011                    ADSC9   11,A,PR1                 cn=0,n=*X1
        24 000353   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 000354   000471 600000 24                 TZE     s:9588

     2711     9552    4                        COLUMN,
     2712     9553    4                        MINIMUM (O1COM.MARGIN_R, LINE$ -> FILL_BUFFER.LINE_LENGTH) -
              9553                                 COLUMN)
     2713     9554    4                    ~= ' ' THEN
     2714     9555    5               DO;

     2715     9556    5                 CALL DUP_FOR_REP (LINE$,

   9556 24 000355   200016 634500                    EPPR4   CUMM_LINE_OFFSET,,AUTO
        24 000356   200072 454500                    STP4    @LINE$+1,,AUTO
        24 000357   200065 236100                    LDQ     @LINE$,,AUTO
        24 000360   200071 756100                    STQ     LEX$+1,,AUTO
        24 000361   000473 701000 24                 TSX1    DUP_FOR_REP
        24 000362   000000 011000                    NOP     0

     2716     9557    5                                   CUMM_LINE_OFFSET);
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:666  
     2717     9558
     2718     9559                      %NEW_HEAP (@POINTER = L$,
     2719     9560                                 @SIZE = %MAX_INPUT_BUFFER_LEN);

   9562 24 000363   000012 236000 25                 LDQ     10
        24 000364   200103 756100                    STQ     T$+3,,AUTO
        24 000365   200066 630500                    EPPR0   L$,,AUTO
        24 000366   200102 450500                    STP0    T$+2,,AUTO
        24 000367   200102 630500                    EPPR0   T$+2,,AUTO
        24 000370   000003 631400 25                 EPPR1   3
        24 000371   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 000372   000000 011000                    NOP     0

     2720     9565
     2721     9566    5                 LINE$ -> FILL_BUFFER.ESN = ' ';

   9566 24 000373   200065 470500                    LDP0    @LINE$,,AUTO
        24 000374   000000 471500                    LDP1    0,,PR0
        24 000375   040100 100400                    MLR     fill='040'O
        24 000376   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 000377   100005 000012                    ADSC9   5,,PR1                   cn=0,n=10

     2722     9567    5                 L$ -> FILL_BUFFER.LINE_LENGTH = LINE$ -> FILL_BUFFER.LINE_LENGTH;

   9567 24 000400   000000 471500                    LDP1    0,,PR0
        24 000401   200066 473500                    LDP3    L$,,AUTO
        24 000402   100012 235100                    LDA     10,,PR1
        24 000403   300012 755100                    STA     10,,PR3

     2723     9568    5                 L$ -> FILL_BUFFER = LINE$ -> FILL_BUFFER;

   9568 24 000404   200066 471500                    LDP1    L$,,AUTO
        24 000405   100012 720100                    LXL0    10,,PR1
        24 000406   000054 621010                    EAX1    44,X0
        24 000407   000000 473500                    LDP3    0,,PR0
        24 000410   300012 722100                    LXL2    10,,PR3
        24 000411   000054 623012                    EAX3    44,X2
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:667  
        24 000412   000140 100540                    MLR     fill='000'O
        24 000413   300000 000013                    ADSC9   0,,PR3                   cn=0,n=*X3
        24 000414   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2724     9569    5                 LINE$ -> FILL_BUFFER.NEXT$ = L$;

   9569 24 000415   000000 471500                    LDP1    0,,PR0
        24 000416   200066 236100                    LDQ     L$,,AUTO
        24 000417   100002 756100                    STQ     2,,PR1

     2725     9570    5                 IF CURRENT_BUFFER$ = LINE$ THEN

   9570 24 000420   000000 236000 13                 LDQ     CURRENT_BUFFER$
        24 000421   000000 116100                    CMPQ    0,,PR0
        24 000422   000425 601000 24                 TNZ     s:9573

     2726     9571    5                   CURRENT_BUFFER$ = L$;

   9571 24 000423   200066 236100                    LDQ     L$,,AUTO
        24 000424   000000 756000 13                 STQ     CURRENT_BUFFER$

     2727     9572
     2728     9573    5                 CALL ADJUST_ISN (1, L$);

   9573 24 000425   200066 631500                    EPPR1   L$,,AUTO
        24 000426   200076 451500                    STP1    @LINE$,,AUTO
        24 000427   000014 236000 25                 LDQ     12
        24 000430   200075 756100                    STQ     @ISN_INC,,AUTO
        24 000431   000242 701000 24                 TSX1    ADJUST_ISN
        24 000432   000000 011000                    NOP     0

     2729     9574
     2730     9575    5                 SUBSTR (LINE$ -> FILL_BUFFER.SOURCE_LINE,

   9575 24 000433   200065 470500                    LDP0    @LINE$,,AUTO
        24 000434   000000 471500                    LDP1    0,,PR0
        24 000435   100012 720100                    LXL0    10,,PR1
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:668  
        24 000436   100012 236100                    LDQ     10,,PR1
        24 000437   000123 116000 xsym               CMPQ    O1COM+83
        24 000440   000442 604400 24                 TMOZ    s:9575+7
        24 000441   000123 236000 xsym               LDQ     O1COM+83
        24 000442   200064 473500                    LDP3    @COLUMN,,AUTO
        24 000443   300000 136100                    SBLQ    0,,PR3
        24 000444   300000 235100                    LDA     0,,PR3
        24 000445   000000 621006                    EAX1    0,QL
        24 000446   040145 100400                    MLR     fill='040'O
        24 000447   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 000450   100013 000011                    ADSC9   11,A,PR1                 cn=0,n=*X1

     2731     9576    5                         COLUMN,
     2732     9577    5                         MINIMUM (O1COM.MARGIN_R, LINE$ -> FILL_BUFFER.LINE_LENGTH) -
              9577                                  COLUMN)
     2733     9578    5                     = ' ';
     2734     9579
     2735     9580    5                 SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,

   9580 24 000451   200066 471500                    LDP1    L$,,AUTO
        24 000452   100012 720100                    LXL0    10,,PR1
        24 000453   300000 721100                    LXL1    0,,PR3
        24 000454   040140 100400                    MLR     fill='040'O
        24 000455   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 000456   100013 000011                    ADSC9   11,,PR1                  cn=0,n=*X1

     2736     9581    5                         0,
     2737     9582    5                         COLUMN) = ' ';
     2738     9583    5                 IF LINE$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE THEN

   9583 24 000457   000000 471500                    LDP1    0,,PR0
        24 000460   100011 236100                    LDQ     9,,PR1
        24 000461   010000 316003                    CANQ    4096,DU
        24 000462   000471 600000 24                 TZE     s:9588

     2739     9584    5                   SUBSTR (L$ -> FILL_BUFFER.SOURCE_LINE,

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:669  
   9584 24 000463   200066 474500                    LDP4    L$,,AUTO
        24 000464   400012 720100                    LXL0    10,,PR4
        24 000465   000122 235000 xsym               LDA     O1COM+82
        24 000466   040105 100400                    MLR     fill='040'O
        24 000467   000015 000001 25                 ADSC9   13                       cn=0,n=1
        24 000470   400012 600001                    ADSC9   10,A,PR4                 cn=3,n=1

     2740     9585    5                           O1COM.AREA_A_COLUMN_START - 1, 1) = 'D';
     2741     9586    5               END;

     2742     9587    4           END;

     2743     9588    3       END SPLIT_LINE;

   9588 24 000471   200062 221300                    LDX1  ! SHIFT_RIGHT+1,,AUTO
        24 000472   000001 702211                    TSX2  ! 1,X1

     2744     9589
     2745     9590        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:670  
     2746     9591    2       DUP_FOR_REP : PROC (LINE$,

   9591 24 000473   200070 741300       DUP_FOR_REP  STX1  ! @COLUMN+1,,AUTO

     2747     9592    2                           ISN_INC);
     2748     9593
     2749     9594    3         DCL LINE$ PTR;
     2750     9595    3         DCL ISN_INC SBIN;
     2751     9596
     2752     9597    3         DCL L$ PTR;
     2753     9598
     2754     9599
     2755     9600    3         ISN_INC = 0;

   9600 24 000474   200072 470500                    LDP0    @ISN_INC,,AUTO
        24 000475   000000 450100                    STZ     0,,PR0

     2756     9601    3         IF NOT LINE$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE THEN

   9601 24 000476   200071 471500                    LDP1    @LINE$,,AUTO
        24 000477   100000 473500                    LDP3    0,,PR1
        24 000500   300011 430100                    FSZN    9,,PR3
        24 000501   000565 604000 24                 TMI     s:9625

     2757     9602    4           DO;

     2758     9603                  %NEW_HEAP (@POINTER = L$,
     2759     9604                             @SIZE = %MAX_INPUT_BUFFER_LEN);

   9606 24 000502   000012 236000 25                 LDQ     10
        24 000503   200103 756100                    STQ     T$+3,,AUTO
        24 000504   200073 633500                    EPPR3   L$,,AUTO
        24 000505   200102 453500                    STP3    T$+2,,AUTO
        24 000506   200102 630500                    EPPR0   T$+2,,AUTO
        24 000507   000003 631400 25                 EPPR1   3
        24 000510   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 000511   000000 011000                    NOP     0
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:671  

     2760     9609
     2761     9610    4             L$ -> FILL_BUFFER.LINE_LENGTH = LINE$ -> FILL_BUFFER.LINE_LENGTH;

   9610 24 000512   200071 470500                    LDP0    @LINE$,,AUTO
        24 000513   000000 471500                    LDP1    0,,PR0
        24 000514   200073 473500                    LDP3    L$,,AUTO
        24 000515   100012 235100                    LDA     10,,PR1
        24 000516   300012 755100                    STA     10,,PR3

     2762     9611    4             L$ -> FILL_BUFFER = LINE$ -> FILL_BUFFER;

   9611 24 000517   200073 471500                    LDP1    L$,,AUTO
        24 000520   100012 720100                    LXL0    10,,PR1
        24 000521   000054 621010                    EAX1    44,X0
        24 000522   000000 473500                    LDP3    0,,PR0
        24 000523   300012 722100                    LXL2    10,,PR3
        24 000524   000054 623012                    EAX3    44,X2
        24 000525   000140 100540                    MLR     fill='000'O
        24 000526   300000 000013                    ADSC9   0,,PR3                   cn=0,n=*X3
        24 000527   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2763     9612    4             L$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE = TRUE;

   9612 24 000530   200073 471500                    LDP1    L$,,AUTO
        24 000531   001000 236003                    LDQ     512,DU
        24 000532   100011 256100                    ORSQ    9,,PR1

     2764     9613    4             L$ -> FILL_BUFFER.ESN = ' ';

   9613 24 000533   200073 471500                    LDP1    L$,,AUTO
        24 000534   040100 100400                    MLR     fill='040'O
        24 000535   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 000536   100005 000012                    ADSC9   5,,PR1                   cn=0,n=10

     2765     9614    4             LINE$ -> FILL_BUFFER.LINE_TYPE.OLD_REP_LINE = TRUE;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:672  
   9614 24 000537   000000 471500                    LDP1    0,,PR0
        24 000540   020000 236003                    LDQ     8192,DU
        24 000541   100011 256100                    ORSQ    9,,PR1

     2766     9615    4             LINE$ -> FILL_BUFFER.NEXT$ = L$;

   9615 24 000542   000000 471500                    LDP1    0,,PR0
        24 000543   200073 236100                    LDQ     L$,,AUTO
        24 000544   100002 756100                    STQ     2,,PR1

     2767     9616
     2768     9617    4             IF CURRENT_BUFFER$ = LINE$ THEN

   9617 24 000545   000000 236000 13                 LDQ     CURRENT_BUFFER$
        24 000546   000000 116100                    CMPQ    0,,PR0
        24 000547   000552 601000 24                 TNZ     s:9619

     2769     9618    4               CURRENT_BUFFER$ = L$;

   9618 24 000550   200073 236100                    LDQ     L$,,AUTO
        24 000551   000000 756000 13                 STQ     CURRENT_BUFFER$

     2770     9619    4             LINE$ = L$;

   9619 24 000552   200073 236100                    LDQ     L$,,AUTO
        24 000553   000000 756100                    STQ     0,,PR0

     2771     9620
     2772     9621    4             CALL ADJUST_ISN (1, L$);

   9621 24 000554   200073 631500                    EPPR1   L$,,AUTO
        24 000555   200076 451500                    STP1    @LINE$,,AUTO
        24 000556   000014 236000 25                 LDQ     12
        24 000557   200075 756100                    STQ     @ISN_INC,,AUTO
        24 000560   000242 701000 24                 TSX1    ADJUST_ISN
        24 000561   000000 011000                    NOP     0

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:673  
     2773     9622
     2774     9623    4             ISN_INC = 1;

   9623 24 000562   000001 235007                    LDA     1,DL
        24 000563   200072 470500                    LDP0    @ISN_INC,,AUTO
        24 000564   000000 755100                    STA     0,,PR0

     2775     9624    4           END;

     2776     9625    3       END DUP_FOR_REP;

   9625 24 000565   200070 221300                    LDX1  ! @COLUMN+1,,AUTO
        24 000566   000001 702211                    TSX2  ! 1,X1

     2777     9626
     2778     9627        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:674  
     2779     9628    2       INSERT_TOKEN : PROC (SYMBOL$,

   9628 24 000567   200064 741300       INSERT_TOKEN STX1  ! @COLUMN,,AUTO

     2780     9629    2                            LINE,
     2781     9630    2                            COLUMN);
     2782     9631
     2783     9632    3         DCL SYMBOL$ PTR;
     2784     9633    3         DCL LINE SBIN;
     2785     9634    3         DCL COLUMN SBIN;
     2786     9635
     2787     9636    3         DCL LEX$ PTR;
     2788     9637
     2789     9638              %COPY_TO_NEW_LEX_SYMBOL (FROM$ = SYMBOL$,
     2790     9639                                       TO$ = LEX$);

   9641 24 000570   200065 470500                    LDP0    @SYMBOL$,,AUTO
        24 000571   000000 471500                    LDP1    0,,PR0
        24 000572   100010 720100                    LXL0    8,,PR1
        24 000573   000044 622010                    EAX2    36,X0
        24 000574   000000 636012                    EAQ     0,X2
        24 000575   000022 732000                    QRS     18
        24 000576   000003 036007                    ADLQ    3,DL
        24 000577   000004 506007                    DIV     4,DL
        24 000600   200102 756100                    STQ     T$+2,,AUTO
        24 000601   200102 631500                    EPPR1   T$+2,,AUTO
        24 000602   200105 451500                    STP1    T$+5,,AUTO
        24 000603   200070 633500                    EPPR3   LEX$,,AUTO
        24 000604   200104 453500                    STP3    T$+4,,AUTO
        24 000605   200104 630500                    EPPR0   T$+4,,AUTO
        24 000606   000003 631400 25                 EPPR1   3
        24 000607   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 000610   000000 011000                    NOP     0

   9648 24 000611   200065 470500                    LDP0    @SYMBOL$,,AUTO
        24 000612   000000 471500                    LDP1    0,,PR0
        24 000613   200070 473500                    LDP3    LEX$,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:675  
        24 000614   100010 235100                    LDA     8,,PR1
        24 000615   300010 755100                    STA     8,,PR3

   9649 24 000616   200070 471500                    LDP1    LEX$,,AUTO
        24 000617   100010 720100                    LXL0    8,,PR1
        24 000620   000044 621010                    EAX1    36,X0
        24 000621   000000 473500                    LDP3    0,,PR0
        24 000622   300010 722100                    LXL2    8,,PR3
        24 000623   000044 623012                    EAX3    36,X2
        24 000624   000140 100540                    MLR     fill='000'O
        24 000625   300000 000013                    ADSC9   0,,PR3                   cn=0,n=*X3
        24 000626   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     2791     9654    3         LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

   9654 24 000627   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 000630   200070 471500                    LDP1    LEX$,,AUTO
        24 000631   100000 756100                    STQ     0,,PR1

     2792     9655    3         LEX$ -> BASED_LEX_SYMBOL.LEVEL = REPLACE$ -> REPLACE_ITEM.LEVEL - 1;

   9655 24 000632   200004 471500                    LDP1    REPLACE$,,AUTO
        24 000633   200070 473500                    LDP3    LEX$,,AUTO
        24 000634   100003 235100                    LDA     3,,PR1
        24 000635   000001 135007                    SBLA    1,DL
        24 000636   300003 755100                    STA     3,,PR3

     2793     9656    3         LEX_SYMBOL_QUEUE$ = LEX$;

   9656 24 000637   200070 236100                    LDQ     LEX$,,AUTO
        24 000640   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     2794     9657    3         LEX$ -> BASED_LEX_SYMBOL.LINE = LINE;

   9657 24 000641   200066 473500                    LDP3    @LINE,,AUTO
        24 000642   200070 474500                    LDP4    LEX$,,AUTO
        24 000643   300000 235100                    LDA     0,,PR3
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:676  
        24 000644   400004 755100                    STA     4,,PR4

     2795     9658    3         LEX$ -> BASED_LEX_SYMBOL.COLUMN = COLUMN;

   9658 24 000645   200067 474500                    LDP4    @COLUMN,,AUTO
        24 000646   200070 475500                    LDP5    LEX$,,AUTO
        24 000647   400000 235100                    LDA     0,,PR4
        24 000650   500005 755100                    STA     5,,PR5

     2796     9659    3         LEX$ -> BASED_LEX_SYMBOL.END_LINE = LINE;

   9659 24 000651   200070 475500                    LDP5    LEX$,,AUTO
        24 000652   300000 235100                    LDA     0,,PR3
        24 000653   500006 755100                    STA     6,,PR5

     2797     9660    3         LEX$ -> BASED_LEX_SYMBOL.END_COLUMN = COLUMN + SYMBOL$ -> BASED_LEX_SYMBOL.
              9660                  SIZE;

   9660 24 000654   000000 475500                    LDP5    0,,PR0
        24 000655   400000 236100                    LDQ     0,,PR4
        24 000656   500010 036100                    ADLQ    8,,PR5
        24 000657   200070 476500                    LDP6    LEX$,,AUTO
        24 000660   600007 756100                    STQ     7,,PR6

     2798     9661    3         LEX$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN = REP_DEBUG_LINE;

   9661 24 000661   200070 475500                    LDP5    LEX$,,AUTO
        24 000662   200015 236100                    LDQ     REP_DEBUG_LINE,,AUTO
        24 000663   000002 772000                    QRL     2
        24 000664   500002 676100                    ERQ     2,,PR5
        24 000665   100000 376003                    ANQ     32768,DU
        24 000666   500002 656100                    ERSQ    2,,PR5

     2799     9662
     2800     9663    3         IF LEX$ -> BASED_LEX_SYMBOL.END_COLUMN > O1COM.MARGIN_R THEN

   9663 24 000667   200070 475500                    LDP5    LEX$,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:677  
        24 000670   500007 236100                    LDQ     7,,PR5
        24 000671   000123 116000 xsym               CMPQ    O1COM+83
        24 000672   000675 604400 24                 TMOZ    s:9665

     2801     9664    3           LEX$ -> BASED_LEX_SYMBOL.END_COLUMN = O1COM.MARGIN_R;

   9664 24 000673   000123 235000 xsym               LDA     O1COM+83
        24 000674   500007 755100                    STA     7,,PR5

     2802     9665    3       END INSERT_TOKEN;

   9665 24 000675   200064 221300                    LDX1  ! @COLUMN,,AUTO
        24 000676   000001 702211                    TSX2  ! 1,X1

     2803     9666
     2804     9667        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:678  
     2805     9668    2       CALC_MAX_TOKEN_LENGTH : PROC;

   9668 24 000677   200062 741300       CALC_MAX_TO* STX1  ! SHIFT_RIGHT+1,,AUTO

     2806     9669
     2807     9670    3         CUMM_LINE_PTR$ = ADDR(NIL);

   9670 24 000700   000000 236000 25                 LDQ     0
        24 000701   200017 756100                    STQ     CUMM_LINE_PTR$,,AUTO

     2808     9671    3         CALL Z8EL$POSITION_LINE_LIST (REP_BEG_LINE,

   9671 24 000702   000007 236000 25                 LDQ     7
        24 000703   200104 756100                    STQ     T$+4,,AUTO
        24 000704   200017 630500                    EPPR0   CUMM_LINE_PTR$,,AUTO
        24 000705   200103 450500                    STP0    T$+3,,AUTO
        24 000706   200013 631500                    EPPR1   REP_BEG_LINE,,AUTO
        24 000707   200102 451500                    STP1    T$+2,,AUTO
        24 000710   200102 630500                    EPPR0   T$+2,,AUTO
        24 000711   000005 631400 25                 EPPR1   5
        24 000712   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        24 000713   000000 011000                    NOP     0

     2809     9672    3                                       CUMM_LINE_PTR$,
     2810     9673    3                                       999999999);
     2811     9674
     2812     9675              /* Calculate blank space on line */
     2813     9676
     2814     9677    3         CALL SEARCH ( NON_BLANK_COL,

   9677 24 000714   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 000715   000012 720100                    LXL0    10,,PR0
        24 000716   000012 236100                    LDQ     10,,PR0
        24 000717   000123 116000 xsym               CMPQ    O1COM+83
        24 000720   000722 604400 24                 TMOZ    s:9677+6
        24 000721   000123 236000 xsym               LDQ     O1COM+83
        24 000722   200102 756100                    STQ     T$+2,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:679  
        24 000723   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
        24 000724   200103 756100                    STQ     T$+3,,AUTO
        24 000725   200014 236100                    LDQ     REP_BEG_COLUMN,,AUTO
        24 000726   200103 720100                    LXL0    T$+3,,AUTO
        24 000727   000000 164546                    TCT
        24 000730   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=*X0
        24 000731   000000 000000 xsym               ARG     BLANK_SCAN_TABLE
        24 000732   200027 000100                    ARG     NON_BLANK_COL,,AUTO
        24 000733   200027 235100                    LDA     NON_BLANK_COL,,AUTO
        24 000734   000033 771000                    ARL     27
        24 000735   200030 755100                    STA     CHAR_CLASS,,AUTO
        24 000736   200027 551140                    STBA    NON_BLANK_COL,'40'O,AUTO
        24 000737   200027 056100                    ASQ     NON_BLANK_COL,,AUTO

     2815     9678    3                       CHAR_CLASS,
     2816     9679    3                       BLANK_SCAN_TABLE,
     2817     9680    3                       SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
     2818     9681    3                              0,
     2819     9682    3                              MINIMUM(O1COM.MARGIN_R, CUMM_LINE_PTR$ -> FILL_BUFFER.
              9682                                       LINE_LENGTH)),
     2820     9683    3                        REP_BEG_COLUMN);
     2821     9684
     2822     9685    3         IF CHAR_CLASS = %END_OF_LINE THEN

   9685 24 000740   000000 115003                    CMPA    0,DU
        24 000741   000746 601000 24                 TNZ     s:9688

     2823     9686    3           MAX_TOKEN_LENGTH = O1COM.MARGIN_R - REP_BEG_COLUMN;

   9686 24 000742   000123 236000 xsym               LDQ     O1COM+83
        24 000743   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
        24 000744   200032 756100                    STQ     MAX_TOKEN_LENGTH,,AUTO
        24 000745   000752 710000 24                 TRA     s:9690

     2824     9687    3         ELSE
     2825     9688    3           MAX_TOKEN_LENGTH = NON_BLANK_COL - REP_BEG_COLUMN - 1;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:680  
   9688 24 000746   200027 236100                    LDQ     NON_BLANK_COL,,AUTO
        24 000747   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
        24 000750   000001 136007                    SBLQ    1,DL
        24 000751   200032 756100                    STQ     MAX_TOKEN_LENGTH,,AUTO

     2826     9689
     2827     9690    3       END CALC_MAX_TOKEN_LENGTH ;

   9690 24 000752   200062 221300                    LDX1  ! SHIFT_RIGHT+1,,AUTO
        24 000753   000001 702211                    TSX2  ! 1,X1

     2828     9691
     2829     9692        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:681  
     2830     9693    2       DO_STRAIGHT_IN_LINE_REPLACE: PROC (ADD_BLANKS);

   9693 24 000754   200062 741300       DO_STRAIGHT* STX1  ! SHIFT_RIGHT+1,,AUTO

     2831     9694
     2832     9695    3         DCL  ADD_BLANKS    SBIN WORD;
     2833     9696
     2834     9697    3         SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,

   9697 24 000755   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 000756   000012 720100                    LXL0    10,,PR0
        24 000757   200063 471500                    LDP1    @ADD_BLANKS,,AUTO
        24 000760   200014 236100                    LDQ     REP_BEG_COLUMN,,AUTO
        24 000761   100000 036100                    ADLQ    0,,PR1
        24 000762   200004 473500                    LDP3    REPLACE$,,AUTO
        24 000763   300002 474500                    LDP4    2,,PR3
        24 000764   400010 722100                    LXL2    8,,PR4
        24 000765   400010 723100                    LXL3    8,,PR4
        24 000766   040146 100540                    MLR     fill='040'O
        24 000767   400011 000013                    ADSC9   9,,PR4                   cn=0,n=*X3
        24 000770   000013 000012                    ADSC9   11,Q,PR0                 cn=0,n=*X2

     2835     9698    3                REP_BEG_COLUMN + ADD_BLANKS,
     2836     9699    3                REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SIZE)
     2837     9700    3            = REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SYMBOL;
     2838     9701
     2839     9702    3         CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH =

   9702 24 000771   300002 470500                    LDP0    2,,PR3
        24 000772   200014 236100                    LDQ     REP_BEG_COLUMN,,AUTO
        24 000773   000010 036100                    ADLQ    8,,PR0
        24 000774   200017 474500                    LDP4    CUMM_LINE_PTR$,,AUTO
        24 000775   400012 116100                    CMPQ    10,,PR4
        24 000776   001000 605000 24                 TPL     s:9702+7
        24 000777   400012 236100                    LDQ     10,,PR4
        24 001000   400012 756100                    STQ     10,,PR4

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:682  
     2840     9703    3               MAXIMUM (CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH,
     2841     9704    3                        REP_BEG_COLUMN + REPLACE$ -> REPLACE_ITEM.TO_LIST$
     2842     9705    3                                            -> BASED_LEX_SYMBOL.SIZE);
     2843     9706
     2844     9707    3         CALL INSERT_TOKEN (REPLACE$ -> REPLACE_ITEM.TO_LIST$,

   9707 24 001001   200014 630500                    EPPR0   REP_BEG_COLUMN,,AUTO
        24 001002   200067 450500                    STP0    @COLUMN,,AUTO
        24 001003   200017 236100                    LDQ     CUMM_LINE_PTR$,,AUTO
        24 001004   000004 036003                    ADLQ    4,DU
        24 001005   200066 756100                    STQ     @LINE,,AUTO
        24 001006   200004 236100                    LDQ     REPLACE$,,AUTO
        24 001007   000002 036003                    ADLQ    2,DU
        24 001010   200065 756100                    STQ     @SYMBOL$,,AUTO
        24 001011   000567 701000 24                 TSX1    INSERT_TOKEN
        24 001012   000000 011000                    NOP     0

     2845     9708    3                            CUMM_LINE_PTR$ -> FILL_BUFFER.ISN,
     2846     9709    3                            REP_BEG_COLUMN);
     2847     9710
     2848     9711    3       END DO_STRAIGHT_IN_LINE_REPLACE;

   9711 24 001013   200062 221300                    LDX1  ! SHIFT_RIGHT+1,,AUTO
        24 001014   000001 702211                    TSX2  ! 1,X1

     2849     9712
     2850     9713        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:683  
     2851     9714            /* DO_REPLACE main body */
     2852     9715
     2853     9716            /* Save info from first token being deleted */
     2854     9717
     2855     9718    2       REP_BEG_LINE = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.LINE;

   9718 24 001015   000000 470400 11                 LDP0    LEX_SYMBOL_QUEUE$
        24 001016   000004 235100                    LDA     4,,PR0
        24 001017   200013 755100                    STA     REP_BEG_LINE,,AUTO

     2856     9719    2       REP_BEG_COLUMN = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.COLUMN;

   9719 24 001020   000005 235100                    LDA     5,,PR0
        24 001021   200014 755100                    STA     REP_BEG_COLUMN,,AUTO

     2857     9720    2       REP_DEBUG_LINE = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN;

   9720 24 001022   000002 236100                    LDQ     2,,PR0
        24 001023   000002 736000                    QLS     2
        24 001024   400000 376003                    ANQ     -131072,DU
        24 001025   200015 756100                    STQ     REP_DEBUG_LINE,,AUTO

     2858     9721
     2859     9722            /* Clear Scanner from RESTART_STATE */
     2860     9723    2       IF SCANNER_STATE ~= 0 THEN

   9723 24 001026   000000 235000 12                 LDA     SCANNER_STATE
        24 001027   001114 600000 24                 TZE     s:9768

     2861     9724    3         DO;

     2862     9725    3           LEX$ = LEX_SYMBOL_QUEUE$;

   9725 24 001030   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 001031   200012 756100                    STQ     LEX$,,AUTO

     2863     9726
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:684  
     2864     9727    4           DO WHILE LEX$ -> BASED_LEX_SYMBOL.NEXT$ ~= ADDR(NIL);

   9727 24 001032   001036 710000 24                 TRA     s:9730

     2865     9728
     2866     9729    4             LEX$ = LEX$ -> BASED_LEX_SYMBOL.NEXT$;

   9729 24 001033   200012 470500                    LDP0    LEX$,,AUTO
        24 001034   000000 236100                    LDQ     0,,PR0
        24 001035   200012 756100                    STQ     LEX$,,AUTO

     2867     9730    4           END;

   9730 24 001036   200012 470500                    LDP0    LEX$,,AUTO
        24 001037   000000 236100                    LDQ     0,,PR0
        24 001040   000000 116000 25                 CMPQ    0
        24 001041   001033 601000 24                 TNZ     s:9729

     2868     9731
     2869     9732    4           DO UNTIL SCANNER_STATE = 0;

     2870     9733
     2871     9734                  %GET_BRAND_NEW_TOKEN;

   9736 24 001042   000001 631400 25                 EPPR1   1
        24 001043   000000 701000 xent               TSX1    Z8ES$SCANNER
        24 001044   000000 011000                    NOP     0

   9737 24 001045   000001 235000 2                  LDA     LEX_SYMBOL+1
        24 001046   001057 601000 24                 TNZ     s:9747

   9738 24 001047   000001 631400 25                 EPPR1   1
        24 001050   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
        24 001051   000000 011000                    NOP     0

   9739 24 001052   000001 631400 25                 EPPR1   1
        24 001053   000000 701000 xent               TSX1    Z8ES$SCANNER
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:685  
        24 001054   000000 011000                    NOP     0

   9740 24 001055   000001 235000 2                  LDA     LEX_SYMBOL+1
        24 001056   001047 600000 24                 TZE     s:9738

     2872     9743
     2873     9744                  %COPY_TO_NEW_LEX_SYMBOL (FROM$ = "ADDR(LEX_SYMBOL)",
     2874     9745                                           TO$   = HEAP$);

   9747 24 001057   000010 236000 2                  LDQ     LEX_SYMBOL+8
        24 001060   000047 036007                    ADLQ    39,DL
        24 001061   000004 506007                    DIV     4,DL
        24 001062   200102 756100                    STQ     T$+2,,AUTO
        24 001063   200102 630500                    EPPR0   T$+2,,AUTO
        24 001064   200105 450500                    STP0    T$+5,,AUTO
        24 001065   000004 236000 25                 LDQ     4
        24 001066   200104 756100                    STQ     T$+4,,AUTO
        24 001067   200104 630500                    EPPR0   T$+4,,AUTO
        24 001070   000003 631400 25                 EPPR1   3
        24 001071   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 001072   000000 011000                    NOP     0

   9754 24 001073   000000 470400 1                  LDP0    HEAP$
        24 001074   000010 235000 2                  LDA     LEX_SYMBOL+8
        24 001075   000010 755100                    STA     8,,PR0

   9755 24 001076   000010 720100                    LXL0    8,,PR0
        24 001077   000044 621010                    EAX1    36,X0
        24 001100   000010 722000 2                  LXL2    LEX_SYMBOL+8
        24 001101   000044 623012                    EAX3    36,X2
        24 001102   000140 100440                    MLR     fill='000'O
        24 001103   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
        24 001104   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     2875     9760
     2876     9761    4             LEX$ -> BASED_LEX_SYMBOL.NEXT$ = HEAP$;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:686  
   9761 24 001105   000000 236000 1                  LDQ     HEAP$
        24 001106   200012 470500                    LDP0    LEX$,,AUTO
        24 001107   000000 756100                    STQ     0,,PR0

     2877     9762    4             LEX$ = HEAP$;

   9762 24 001110   000000 236000 1                  LDQ     HEAP$
        24 001111   200012 756100                    STQ     LEX$,,AUTO

     2878     9763    4           END;

   9763 24 001112   000000 235000 12                 LDA     SCANNER_STATE
        24 001113   001042 601000 24                 TNZ     s:9736

     2879     9764    3         END;

     2880     9765
     2881     9766
     2882     9767            /* Delete matched tokens */
     2883     9768    2       MATCH$ = REPLACE$ -> REPLACE_ITEM.FROM_LIST$;

   9768 24 001114   200004 470500                    LDP0    REPLACE$,,AUTO
        24 001115   000001 236100                    LDQ     1,,PR0
        24 001116   200011 756100                    STQ     MATCH$,,AUTO

     2884     9769
     2885     9770    3       DO UNTIL MATCH$ = ADDR(NIL);

     2886     9771
     2887     9772    3         LEX$ = LEX_SYMBOL_QUEUE$;

   9772 24 001117   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 001120   200012 756100                    STQ     LEX$,,AUTO

     2888     9773    3         REP_END_LINE = LEX$ -> BASED_LEX_SYMBOL.END_LINE;

   9773 24 001121   200012 470500                    LDP0    LEX$,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:687  
        24 001122   000006 235100                    LDA     6,,PR0
        24 001123   200020 755100                    STA     REP_END_LINE,,AUTO

     2889     9774    3         REP_END_COLUMN = LEX$ -> BASED_LEX_SYMBOL.END_COLUMN;

   9774 24 001124   000007 235100                    LDA     7,,PR0
        24 001125   200021 755100                    STA     REP_END_COLUMN,,AUTO

     2890     9775    3         LEX_SYMBOL_QUEUE$ = LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.NEXT$;

   9775 24 001126   000000 471400 11                 LDP1    LEX_SYMBOL_QUEUE$
        24 001127   100000 236100                    LDQ     0,,PR1
        24 001130   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     2891     9776
     2892     9777    3         CALL Z8ED$DISPOSE_HEAP(LEX$,

   9777 24 001131   000010 720100                    LXL0    8,,PR0
        24 001132   000044 621010                    EAX1    36,X0
        24 001133   000000 636011                    EAQ     0,X1
        24 001134   000022 732000                    QRS     18
        24 001135   000003 036007                    ADLQ    3,DL
        24 001136   000004 506007                    DIV     4,DL
        24 001137   200102 756100                    STQ     T$+2,,AUTO
        24 001140   200102 631500                    EPPR1   T$+2,,AUTO
        24 001141   200105 451500                    STP1    T$+5,,AUTO
        24 001142   200012 633500                    EPPR3   LEX$,,AUTO
        24 001143   200104 453500                    STP3    T$+4,,AUTO
        24 001144   200104 630500                    EPPR0   T$+4,,AUTO
        24 001145   000003 631400 25                 EPPR1   3
        24 001146   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        24 001147   000000 011000                    NOP     0

     2893     9778                                        %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX$);
     2894     9781    3                                  );
     2895     9782    3         MATCH$ = MATCH$ -> BASED_LEX_SYMBOL.NEXT$;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:688  
   9782 24 001150   200011 470500                    LDP0    MATCH$,,AUTO
        24 001151   000000 236100                    LDQ     0,,PR0
        24 001152   200011 756100                    STQ     MATCH$,,AUTO

     2896     9783
     2897     9784    3       END;

   9784 24 001153   000000 116000 25                 CMPQ    0
        24 001154   001117 601000 24                 TNZ     s:9772

     2898     9785
     2899     9786
     2900     9787            /* Delete  matched lines for listing */
     2901     9788
     2902     9789    2       CUMM_LINE_PTR$ = ADDR(NIL);

   9789 24 001155   000000 236000 25                 LDQ     0
        24 001156   200017 756100                    STQ     CUMM_LINE_PTR$,,AUTO

     2903     9790    2       CALL Z8EL$POSITION_LINE_LIST ( REP_BEG_LINE,

   9790 24 001157   000007 236000 25                 LDQ     7
        24 001160   200104 756100                    STQ     T$+4,,AUTO
        24 001161   200017 630500                    EPPR0   CUMM_LINE_PTR$,,AUTO
        24 001162   200103 450500                    STP0    T$+3,,AUTO
        24 001163   200013 631500                    EPPR1   REP_BEG_LINE,,AUTO
        24 001164   200102 451500                    STP1    T$+2,,AUTO
        24 001165   200102 630500                    EPPR0   T$+2,,AUTO
        24 001166   000005 631400 25                 EPPR1   5
        24 001167   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        24 001170   000000 011000                    NOP     0

     2904     9791    2                                      CUMM_LINE_PTR$,
     2905     9792    2                                      999999999);
     2906     9793    2       OLD_LINE$ = CUMM_LINE_PTR$;

   9793 24 001171   200017 236100                    LDQ     CUMM_LINE_PTR$,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:689  
        24 001172   200041 756100                    STQ     OLD_LINE$,,AUTO

     2907     9794
     2908     9795            /* Check for pseudo text in-line replacement --           */
     2909     9796            /* (1) TO is one token within pseudo text                 */
     2910     9797            /* (2) TO starting column is in area B (cc 12 - 72)       */
     2911     9798            /* (3) the new line will not go beyond cc 72              */
     2912     9799
     2913     9800    2       TO_LIST$ = REPLACE$ -> REPLACE_ITEM.TO_LIST$;

   9800 24 001173   200004 470500                    LDP0    REPLACE$,,AUTO
        24 001174   000002 236100                    LDQ     2,,PR0
        24 001175   200040 756100                    STQ     TO_LIST$,,AUTO

     2914     9801
     2915     9802    2       IF  (TO_LIST$ = ADDR (NIL)

   9802 24 001176   000000 116000 25                 CMPQ    0
        24 001177   001207 600000 24                 TZE     s:9802+9
        24 001200   200040 471500                    LDP1    TO_LIST$,,AUTO
        24 001201   100000 236100                    LDQ     0,,PR1
        24 001202   000000 116000 25                 CMPQ    0
        24 001203   002063 601000 24                 TNZ     s:10008
        24 001204   100005 235100                    LDA     5,,PR1
        24 001205   000014 115007                    CMPA    12,DL
        24 001206   002063 604000 24                 TMI     s:10008
        24 001207   000005 234100                    SZN     5,,PR0
        24 001210   002063 605000 24                 TPL     s:10008
        24 001211   000004 234100                    SZN     4,,PR0
        24 001212   002063 605000 24                 TPL     s:10008
        24 001213   200017 236100                    LDQ     CUMM_LINE_PTR$,,AUTO
        24 001214   000000 116000 25                 CMPQ    0
        24 001215   002063 600000 24                 TZE     s:10008
        24 001216   200013 236100                    LDQ     REP_BEG_LINE,,AUTO
        24 001217   200020 116100                    CMPQ    REP_END_LINE,,AUTO
        24 001220   002063 601000 24                 TNZ     s:10008

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:690  
     2916     9803    2            OR   TO_LIST$ -> BASED_LEX_SYMBOL.NEXT$ = ADDR (NIL)
     2917     9804    2            AND  TO_LIST$ -> BASED_LEX_SYMBOL.COLUMN >= 12)
     2918     9805    2       AND REPLACE$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT
     2919     9806    2       AND REPLACE$ -> REPLACE_ITEM.FROM_IS_PSEUDO_TEXT
     2920     9807    2       AND CUMM_LINE_PTR$ ~= ADDR(NIL)
     2921     9808    2       AND REP_BEG_LINE = REP_END_LINE THEN
     2922     9809    3         DO;

     2923     9810                /* Check item (3) above: new line <= 72 bytes */
     2924     9811
     2925     9812    3           CALL DUP_FOR_REP (CUMM_LINE_PTR$, CUMM_LINE_OFFSET);

   9812 24 001221   200016 631500                    EPPR1   CUMM_LINE_OFFSET,,AUTO
        24 001222   200072 451500                    STP1    @LINE$+1,,AUTO
        24 001223   200017 633500                    EPPR3   CUMM_LINE_PTR$,,AUTO
        24 001224   200071 453500                    STP3    LEX$+1,,AUTO
        24 001225   000473 701000 24                 TSX1    DUP_FOR_REP
        24 001226   000000 011000                    NOP     0

     2926     9813    3           REP_BEG_LINE = REP_BEG_LINE + CUMM_LINE_OFFSET;

   9813 24 001227   200013 236100                    LDQ     REP_BEG_LINE,,AUTO
        24 001230   200016 036100                    ADLQ    CUMM_LINE_OFFSET,,AUTO
        24 001231   200013 756100                    STQ     REP_BEG_LINE,,AUTO

     2927     9814    3           REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;

   9814 24 001232   200020 236100                    LDQ     REP_END_LINE,,AUTO
        24 001233   200016 036100                    ADLQ    CUMM_LINE_OFFSET,,AUTO
        24 001234   200020 756100                    STQ     REP_END_LINE,,AUTO

     2928     9815    3           REP_SIZE = REP_END_COLUMN - REP_BEG_COLUMN;

   9815 24 001235   200021 236100                    LDQ     REP_END_COLUMN,,AUTO
        24 001236   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
        24 001237   200036 756100                    STQ     REP_SIZE,,AUTO

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:691  
     2929     9816    3           SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,

   9816 24 001240   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 001241   000012 720100                    LXL0    10,,PR0
        24 001242   000000 621006                    EAX1    0,QL
        24 001243   200014 235100                    LDA     REP_BEG_COLUMN,,AUTO
        24 001244   040145 100400                    MLR     fill='040'O
        24 001245   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 001246   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1

     2930     9817    3                  REP_BEG_COLUMN,
     2931     9818    3                  REP_SIZE) = ' ';
     2932     9819
     2933     9820    3           CALL CALC_MAX_TOKEN_LENGTH;

   9820 24 001247   000677 701000 24                 TSX1    CALC_MAX_TOKEN_LENGTH
        24 001250   000000 011000                    NOP     0

     2934     9821
     2935     9822    3           IF TO_LIST$ ~= ADDR (NIL)

   9822 24 001251   200040 236100                    LDQ     TO_LIST$,,AUTO
        24 001252   000000 116000 25                 CMPQ    0
        24 001253   001264 600000 24                 TZE     s:9826
        24 001254   200040 470500                    LDP0    TO_LIST$,,AUTO
        24 001255   200036 236100                    LDQ     REP_SIZE,,AUTO
        24 001256   000010 116100                    CMPQ    8,,PR0
        24 001257   001264 600000 24                 TZE     s:9826

     2936     9823    3           AND REP_SIZE ~= TO_LIST$ -> BASED_LEX_SYMBOL.SIZE THEN
     2937     9824    3             SHIFT_RIGHT = TO_LIST$ -> BASED_LEX_SYMBOL.SIZE - REP_SIZE;

   9824 24 001260   000010 236100                    LDQ     8,,PR0
        24 001261   200036 136100                    SBLQ    REP_SIZE,,AUTO
        24 001262   200061 756100                    STQ     SHIFT_RIGHT,,AUTO
        24 001263   001265 710000 24                 TRA     s:9828

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:692  
     2938     9825    3           ELSE
     2939     9826    3             SHIFT_RIGHT = 0;

   9826 24 001264   200061 450100                    STZ     SHIFT_RIGHT,,AUTO

     2940     9827
     2941     9828    3           IF  CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH + SHIFT_RIGHT <= 72

   9828 24 001265   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 001266   000012 236100                    LDQ     10,,PR0
        24 001267   200061 036100                    ADLQ    SHIFT_RIGHT,,AUTO
        24 001270   000110 116007                    CMPQ    72,DL
        24 001271   002063 605400 24                 TPNZ    s:10008
        24 001272   200040 236100                    LDQ     TO_LIST$,,AUTO
        24 001273   000000 116000 25                 CMPQ    0
        24 001274   001300 601000 24                 TNZ     s:9828+11
        24 001275   000001 235000 17                 LDA     BUFFER+1
        24 001276   000042 115007                    CMPA    34,DL
        24 001277   001317 601000 24                 TNZ     s:9842
        24 001300   000000 116000 25                 CMPQ    0
        24 001301   002063 600000 24                 TZE     s:10008
        24 001302   200040 471500                    LDP1    TO_LIST$,,AUTO
        24 001303   100001 235100                    LDA     1,,PR1
        24 001304   000005 115007                    CMPA    5,DL
        24 001305   001317 600000 24                 TZE     s:9842
        24 001306   000025 115007                    CMPA    21,DL
        24 001307   001317 600000 24                 TZE     s:9842
        24 001310   000026 115007                    CMPA    22,DL
        24 001311   001317 600000 24                 TZE     s:9842
        24 001312   100010 720100                    LXL0    8,,PR1
        24 001313   100011 236100                    LDQ     9,,PR1
        24 001314   777000 376003                    ANQ     -512,DU
        24 001315   055000 116003                    CMPQ    23040,DU
        24 001316   002063 601000 24                 TNZ     s:10008

     2942     9829    3           AND ((TO_LIST$ = ADDR (NIL)
     2943     9830    3                 AND BUFFER.CLASS ~= %SPACE)
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:693  
     2944     9831    3              OR TO_LIST$ ~= ADDR (NIL)
     2945     9832    3                 AND (TO_LIST$ -> BASED_LEX_SYMBOL.TYPE = %USER_WORD
     2946     9833    3                      OR TO_LIST$ -> BASED_LEX_SYMBOL.TYPE = %NUMBER
     2947     9834    3                      OR TO_LIST$ -> BASED_LEX_SYMBOL.TYPE = %NUMERIC_LITERAL
     2948     9835    3                      OR SUBSTR (TO_LIST$ -> BASED_LEX_SYMBOL.SYMBOL, 0, 1) = '-' ))
              9835                               THEN
     2949     9836    4             DO;

     2950     9837
     2951     9838                    /* Check for combining tokens      */
     2952     9839                    /* e.g., (*)-FIELD1 ==> XYZ-FIELD1 */
     2953     9840                    /*       ---            ---        */
     2954     9841
     2955     9842    4               NEXT$ = LEX_SYMBOL_QUEUE$;

   9842 24 001317   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 001320   200034 756100                    STQ     NEXT$,,AUTO

     2956     9843
     2957     9844    4               IF NEXT$ = ADDR(NIL) THEN

   9844 24 001321   000000 116000 25                 CMPQ    0
        24 001322   001412 601000 24                 TNZ     s:9881

     2958     9845    5                 DO;

     2959     9846                        %GET_BRAND_NEW_TOKEN;

   9848 24 001323   000001 631400 25                 EPPR1   1
        24 001324   000000 701000 xent               TSX1    Z8ES$SCANNER
        24 001325   000000 011000                    NOP     0

   9849 24 001326   000001 235000 2                  LDA     LEX_SYMBOL+1
        24 001327   001340 601000 24                 TNZ     s:9855

   9850 24 001330   000001 631400 25                 EPPR1   1
        24 001331   000000 701000 xent               TSX1    Z8EL$GET_NEXT_SCANNER_LINE
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:694  
        24 001332   000000 011000                    NOP     0

   9851 24 001333   000001 631400 25                 EPPR1   1
        24 001334   000000 701000 xent               TSX1    Z8ES$SCANNER
        24 001335   000000 011000                    NOP     0

   9852 24 001336   000001 235000 2                  LDA     LEX_SYMBOL+1
        24 001337   001330 600000 24                 TZE     s:9850

     2960     9855    5                   IF  LEX_SYMBOL.SIZE = 4

   9855 24 001340   000010 236000 2                  LDQ     LEX_SYMBOL+8
        24 001341   000004 116007                    CMPQ    4,DL
        24 001342   001363 601000 24                 TNZ     s:9866
        24 001343   000011 236000 2                  LDQ     LEX_SYMBOL+9
        24 001344   000002 116000 23                 CMPQ    2
        24 001345   001363 601000 24                 TNZ     s:9866

     2961     9856    5                   AND SUBSTR (LEX_SYMBOL.SYMBOL, 0, 4) = 'COPY' THEN
     2962     9857    6                     DO;

     2963     9858    6                       IF TO_LIST$ ~= ADDR (NIL)

   9858 24 001346   200040 236100                    LDQ     TO_LIST$,,AUTO
        24 001347   000000 116000 25                 CMPQ    0
        24 001350   001356 600000 24                 TZE     s:9860

     2964     9859    6                         THEN CALL DO_STRAIGHT_IN_LINE_REPLACE (0);

   9859 24 001351   000016 236000 25                 LDQ     14
        24 001352   200063 756100                    STQ     SHIFT_RIGHT+2,,AUTO
        24 001353   000754 701000 24                 TSX1    DO_STRAIGHT_IN_LINE_REPLACE
        24 001354   000000 011000                    NOP     0
        24 001355   001361 710000 24                 TRA     s:9861

     2965     9860    6                         ELSE CALL Z8EL$PROCESS_COPY;

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:695  
   9860 24 001356   000001 631400 25                 EPPR1   1
        24 001357   000000 701000 xent               TSX1    Z8EL$PROCESS_COPY
        24 001360   000000 011000                    NOP     0

     2966     9861    6                       RETURN;

   9861 24 001361   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 001362   000001 702211                    TSX2  ! 1,X1

     2967     9862    6                     END;
     2968     9863                        %COPY_TO_NEW_LEX_SYMBOL(FROM$="ADDR(LEX_SYMBOL)",
     2969     9864                                                TO$ = NEXT$);

   9866 24 001363   000010 236000 2                  LDQ     LEX_SYMBOL+8
        24 001364   000047 036007                    ADLQ    39,DL
        24 001365   000004 506007                    DIV     4,DL
        24 001366   200102 756100                    STQ     T$+2,,AUTO
        24 001367   200102 630500                    EPPR0   T$+2,,AUTO
        24 001370   200105 450500                    STP0    T$+5,,AUTO
        24 001371   200034 631500                    EPPR1   NEXT$,,AUTO
        24 001372   200104 451500                    STP1    T$+4,,AUTO
        24 001373   200104 630500                    EPPR0   T$+4,,AUTO
        24 001374   000003 631400 25                 EPPR1   3
        24 001375   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 001376   000000 011000                    NOP     0

   9873 24 001377   200034 470500                    LDP0    NEXT$,,AUTO
        24 001400   000010 235000 2                  LDA     LEX_SYMBOL+8
        24 001401   000010 755100                    STA     8,,PR0

   9874 24 001402   200034 470500                    LDP0    NEXT$,,AUTO
        24 001403   000010 720100                    LXL0    8,,PR0
        24 001404   000044 621010                    EAX1    36,X0
        24 001405   000010 722000 2                  LXL2    LEX_SYMBOL+8
        24 001406   000044 623012                    EAX3    36,X2
        24 001407   000140 100440                    MLR     fill='000'O
        24 001410   000000 000013 2                  ADSC9   LEX_SYMBOL               cn=0,n=*X3
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:696  
        24 001411   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     2970     9879    5                 END; /* If NEXT$ = null */

     2971     9880
     2972     9881    4               IF SHIFT_RIGHT > 0 THEN

   9881 24 001412   200061 235100                    LDA     SHIFT_RIGHT,,AUTO
        24 001413   001464 604400 24                 TMOZ    s:9903

     2973     9882    5                 DO;

     2974     9883    5                   SUBSTR (TEMP_CHAR60, 0, SHIFT_RIGHT) = ' ';

   9883 24 001414   000000 620005                    EAX0    0,AL
        24 001415   040140 100400                    MLR     fill='040'O
        24 001416   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 001417   200042 000010                    ADSC9   TEMP_CHAR60,,AUTO        cn=0,n=*X0

     2975     9884    5                   SUBSTR (TEMP_CHAR60, SHIFT_RIGHT, 60 - SHIFT_RIGHT)

   9884 24 001420   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 001421   000012 720100                    LXL0    10,,PR0
        24 001422   200061 721100                    LXL1    SHIFT_RIGHT,,AUTO
        24 001423   777703 621011                    EAX1    -61,X1
        24 001424   777777 661003                    ERX1    -1,DU
        24 001425   200021 235100                    LDA     REP_END_COLUMN,,AUTO
        24 001426   200061 236100                    LDQ     SHIFT_RIGHT,,AUTO
        24 001427   040146 100505                    MLR     fill='040'O
        24 001430   000013 000074                    ADSC9   11,A,PR0                 cn=0,n=60
        24 001431   200042 000011                    ADSC9   TEMP_CHAR60,Q,AUTO       cn=0,n=*X1

     2976     9885    5                     = SUBSTR (CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,
              9885                              REP_END_COLUMN, 60) ;
     2977     9886    5                   SUBSTR (CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,

   9886 24 001432   777667 622005                    EAX2    -73,AL
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:697  
        24 001433   777777 662003                    ERX2    -1,DU
        24 001434   040145 100500                    MLR     fill='040'O
        24 001435   200042 000074                    ADSC9   TEMP_CHAR60,,AUTO        cn=0,n=60
        24 001436   000013 000012                    ADSC9   11,A,PR0                 cn=0,n=*X2

     2978     9887    5                           REP_END_COLUMN,
     2979     9888    5                           72 - REP_END_COLUMN)
     2980     9889    5                     = TEMP_CHAR60;
     2981     9890    5                   CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH =

   9890 24 001437   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 001440   000012 036100                    ADLQ    10,,PR0
        24 001441   000012 756100                    STQ     10,,PR0

     2982     9891    5                     CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_LENGTH + SHIFT_RIGHT;
     2983     9892
     2984     9893                        /* Update the Scanner's Buffer, Length & Column */
     2985     9894
     2986     9895    5                   SUBSTR (TEMP_CHAR60, SHIFT_RIGHT, 60 - SHIFT_RIGHT)

   9895 24 001442   000006 470400 17                 LDP0    BUFFER+6
        24 001443   000000 236000 17                 LDQ     BUFFER
        24 001444   200061 235100                    LDA     SHIFT_RIGHT,,AUTO
        24 001445   040145 100506                    MLR     fill='040'O
        24 001446   000000 000074                    ADSC9   0,Q,PR0                  cn=0,n=60
        24 001447   200042 000011                    ADSC9   TEMP_CHAR60,A,AUTO       cn=0,n=*X1

     2987     9896    5                     = SUBSTR (BUFFER_LINE, BUFFER.COLUMN, 60);
     2988     9897    5                   SUBSTR (BUFFER_LINE, BUFFER.COLUMN, 72 - BUFFER.COLUMN)

   9897 24 001450   777667 620006                    EAX0    -73,QL
        24 001451   777777 660003                    ERX0    -1,DU
        24 001452   040146 100500                    MLR     fill='040'O
        24 001453   200042 000074                    ADSC9   TEMP_CHAR60,,AUTO        cn=0,n=60
        24 001454   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0

     2989     9898    5                     = TEMP_CHAR60;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:698  
     2990     9899    5                   BUFFER.LINE_LENGTH = BUFFER.LINE_LENGTH

   9899 24 001455   000005 236000 17                 LDQ     BUFFER+5
        24 001456   200061 036100                    ADLQ    SHIFT_RIGHT,,AUTO
        24 001457   000005 756000 17                 STQ     BUFFER+5

     2991     9900    5                     + SHIFT_RIGHT;
     2992     9901    5                   BUFFER.COLUMN = BUFFER.COLUMN + SHIFT_RIGHT ;

   9901 24 001460   000000 236000 17                 LDQ     BUFFER
        24 001461   200061 036100                    ADLQ    SHIFT_RIGHT,,AUTO
        24 001462   000000 756000 17                 STQ     BUFFER

     2993     9902    5                 END; /* Shift_Right non-zero */

   9902 24 001463   001566 710000 24                 TRA     s:9920

     2994     9903    4               ELSE IF SHIFT_RIGHT < 0 THEN

   9903 24 001464   001566 605000 24                 TPL     s:9920

     2995     9904    5                 DO;

     2996     9905    5                   TEMP_CHAR1 = SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,

   9905 24 001465   000000 470400 13                 LDP0    CURRENT_BUFFER$
        24 001466   000012 720100                    LXL0    10,,PR0
        24 001467   200034 471500                    LDP1    NEXT$,,AUTO
        24 001470   100005 236100                    LDQ     5,,PR1
        24 001471   200036 136100                    SBLQ    REP_SIZE,,AUTO
        24 001472   040100 100506                    MLR     fill='040'O
        24 001473   000012 600001                    ADSC9   10,Q,PR0                 cn=3,n=1
        24 001474   200031 000001                    ADSC9   TEMP_SBIN,,AUTO          cn=0,n=1

     2997     9906    5                       NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE - 1, 1);
     2998     9907    5                   IF USERWORD_SCAN_TABLE.T (TEMP_SBIN) = %SCAN THEN

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:699  
   9907 24 001475   200031 236100                    LDQ     TEMP_SBIN,,AUTO
        24 001476   000033 732000                    QRS     27
        24 001477   000100 101406                    MRL     fill='000'O
        24 001500   000000 000001 xsym               ADSC9   USERWORD_SCAN_TABLE,Q    cn=0,n=1
        24 001501   200102 000004                    ADSC9   T$+2,,AUTO               cn=0,n=4
        24 001502   200102 236100                    LDQ     T$+2,,AUTO
        24 001503   000000 116003                    CMPQ    0,DU
        24 001504   001565 601000 24                 TNZ     s:9917

     2999     9908    6                     DO;

     3000     9909    6                       SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,

   9909 24 001505   000012 720100                    LXL0    10,,PR0
        24 001506   100005 236100                    LDQ     5,,PR1
        24 001507   200036 136100                    SBLQ    REP_SIZE,,AUTO
        24 001510   200102 756100                    STQ     T$+2,,AUTO
        24 001511   200103 756100                    STQ     T$+3,,AUTO
        24 001512   000000 636010                    EAQ     0,X0
        24 001513   000022 732000                    QRS     18
        24 001514   200102 136100                    SBLQ    T$+2,,AUTO
        24 001515   000012 720100                    LXL0    10,,PR0
        24 001516   200040 473500                    LDP3    TO_LIST$,,AUTO
        24 001517   200104 756100                    STQ     T$+4,,AUTO
        24 001520   100005 236100                    LDQ     5,,PR1
        24 001521   300010 136100                    SBLQ    8,,PR3
        24 001522   200105 756100                    STQ     T$+5,,AUTO
        24 001523   200106 756100                    STQ     T$+6,,AUTO
        24 001524   000000 636010                    EAQ     0,X0
        24 001525   000022 732000                    QRS     18
        24 001526   200105 136100                    SBLQ    T$+5,,AUTO
        24 001527   000000 620006                    EAX0    0,QL
        24 001530   200106 236100                    LDQ     T$+6,,AUTO
        24 001531   200104 721100                    LXL1    T$+4,,AUTO
        24 001532   200103 235100                    LDA     T$+3,,AUTO
        24 001533   040145 100546                    MLR     fill='040'O
        24 001534   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=*X0
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:700  
        24 001535   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1

     3001     9910    6                           NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE) =
     3002     9911    6                           SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     3003     9912    6                           NEXT$ -> BASED_LEX_SYMBOL.COLUMN - TO_LIST$ ->
              9912                                    BASED_LEX_SYMBOL.SIZE);
     3004     9913    6                      SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE
              9913                                ) =

   9913 24 001536   200034 470500                    LDP0    NEXT$,,AUTO
        24 001537   000005 236100                    LDQ     5,,PR0
        24 001540   200036 136100                    SBLQ    REP_SIZE,,AUTO
        24 001541   200102 756100                    STQ     T$+2,,AUTO
        24 001542   200103 756100                    STQ     T$+3,,AUTO
        24 001543   000005 236000 17                 LDQ     BUFFER+5
        24 001544   200102 136100                    SBLQ    T$+2,,AUTO
        24 001545   200104 756100                    STQ     T$+4,,AUTO
        24 001546   000005 236100                    LDQ     5,,PR0
        24 001547   300010 136100                    SBLQ    8,,PR3
        24 001550   200105 756100                    STQ     T$+5,,AUTO
        24 001551   200106 756100                    STQ     T$+6,,AUTO
        24 001552   000005 236000 17                 LDQ     BUFFER+5
        24 001553   200105 136100                    SBLQ    T$+5,,AUTO
        24 001554   000006 471400 17                 LDP1    BUFFER+6
        24 001555   000000 620006                    EAX0    0,QL
        24 001556   200106 235100                    LDA     T$+6,,AUTO
        24 001557   200104 721100                    LXL1    T$+4,,AUTO
        24 001560   200103 236100                    LDQ     T$+3,,AUTO
        24 001561   040146 100545                    MLR     fill='040'O
        24 001562   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
        24 001563   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1

     3005     9914    6                           SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN -
              9914                                    TO_LIST$ -> BASED_LEX_SYMBOL.SIZE);
     3006     9915    6                     END;

   9915 24 001564   001566 710000 24                 TRA     s:9920
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:701  

     3007     9916    5                   ELSE
     3008     9917    5                     SHIFT_RIGHT = 0;

   9917 24 001565   200061 450100                    STZ     SHIFT_RIGHT,,AUTO

     3009     9918    5                 END;

     3010     9919
     3011     9920    4               IF  REP_END_COLUMN

   9920 24 001566   200034 470500                    LDP0    NEXT$,,AUTO
        24 001567   200021 236100                    LDQ     REP_END_COLUMN,,AUTO
        24 001570   000005 116100                    CMPQ    5,,PR0
        24 001571   002050 601000 24                 TNZ     s:10000
        24 001572   200013 236100                    LDQ     REP_BEG_LINE,,AUTO
        24 001573   000004 116100                    CMPQ    4,,PR0
        24 001574   002050 601000 24                 TNZ     s:10000
        24 001575   000001 235100                    LDA     1,,PR0
        24 001576   000005 115007                    CMPA    5,DL
        24 001577   001611 600000 24                 TZE     s:9929
        24 001600   000025 115007                    CMPA    21,DL
        24 001601   001611 600000 24                 TZE     s:9929
        24 001602   000026 115007                    CMPA    22,DL
        24 001603   001611 600000 24                 TZE     s:9929
        24 001604   000010 720100                    LXL0    8,,PR0
        24 001605   000011 236100                    LDQ     9,,PR0
        24 001606   777000 376003                    ANQ     -512,DU
        24 001607   055000 116003                    CMPQ    23040,DU
        24 001610   002050 601000 24                 TNZ     s:10000

     3012     9921    4                   = NEXT$ -> BASED_LEX_SYMBOL.COLUMN
     3013     9922    4               AND REP_BEG_LINE = NEXT$ -> BASED_LEX_SYMBOL.LINE
     3014     9923    4               AND ( NEXT$ -> BASED_LEX_SYMBOL.TYPE = %USER_WORD
     3015     9924    4                  OR NEXT$ -> BASED_LEX_SYMBOL.TYPE = %NUMBER
     3016     9925    4                  OR NEXT$ -> BASED_LEX_SYMBOL.TYPE = %NUMERIC_LITERAL
     3017     9926    4                  OR SUBSTR (NEXT$ -> BASED_LEX_SYMBOL.SYMBOL, 0, 1) = '-' ) THEN
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:702  
     3018     9927    5                 DO;

     3019     9928
     3020     9929    5                   IF TO_LIST$ = ADDR (NIL) THEN

   9929 24 001611   200040 236100                    LDQ     TO_LIST$,,AUTO
        24 001612   000000 116000 25                 CMPQ    0
        24 001613   001705 601000 24                 TNZ     s:9947

     3021     9930    6                     DO;

     3022     9931    6                      TEMP_CHAR1 = SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,

   9931 24 001614   000000 471400 13                 LDP1    CURRENT_BUFFER$
        24 001615   100012 720100                    LXL0    10,,PR1
        24 001616   000005 236100                    LDQ     5,,PR0
        24 001617   200036 136100                    SBLQ    REP_SIZE,,AUTO
        24 001620   040100 100506                    MLR     fill='040'O
        24 001621   100012 600001                    ADSC9   10,Q,PR1                 cn=3,n=1
        24 001622   200031 000001                    ADSC9   TEMP_SBIN,,AUTO          cn=0,n=1

     3023     9932    6                                    NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE - 1, 1
              9932                                              );
     3024     9933    6                       IF USERWORD_SCAN_TABLE.T (TEMP_SBIN) = %SCAN THEN

   9933 24 001623   200031 236100                    LDQ     TEMP_SBIN,,AUTO
        24 001624   000033 732000                    QRS     27
        24 001625   000100 101406                    MRL     fill='000'O
        24 001626   000000 000001 xsym               ADSC9   USERWORD_SCAN_TABLE,Q    cn=0,n=1
        24 001627   200102 000004                    ADSC9   T$+2,,AUTO               cn=0,n=4
        24 001630   200102 236100                    LDQ     T$+2,,AUTO
        24 001631   000000 116003                    CMPQ    0,DU
        24 001632   001701 601000 24                 TNZ     s:9942

     3025     9934    7                         DO;

     3026     9935    7                           SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:703  

   9935 24 001633   100012 720100                    LXL0    10,,PR1
        24 001634   000005 236100                    LDQ     5,,PR0
        24 001635   200036 136100                    SBLQ    REP_SIZE,,AUTO
        24 001636   200102 756100                    STQ     T$+2,,AUTO
        24 001637   200103 756100                    STQ     T$+3,,AUTO
        24 001640   000000 636010                    EAQ     0,X0
        24 001641   000022 732000                    QRS     18
        24 001642   200102 136100                    SBLQ    T$+2,,AUTO
        24 001643   100012 720100                    LXL0    10,,PR1
        24 001644   200104 756100                    STQ     T$+4,,AUTO
        24 001645   000000 636010                    EAQ     0,X0
        24 001646   000022 732000                    QRS     18
        24 001647   000005 136100                    SBLQ    5,,PR0
        24 001650   000005 235100                    LDA     5,,PR0
        24 001651   000000 620006                    EAX0    0,QL
        24 001652   200104 721100                    LXL1    T$+4,,AUTO
        24 001653   200103 236100                    LDQ     T$+3,,AUTO
        24 001654   040146 100545                    MLR     fill='040'O
        24 001655   100013 000010                    ADSC9   11,A,PR1                 cn=0,n=*X0
        24 001656   100013 000011                    ADSC9   11,Q,PR1                 cn=0,n=*X1

     3027     9936    7                                   NEXT$ -> BASED_LEX_SYMBOL.COLUMN - REP_SIZE) =
     3028     9937    7                               SUBSTR (CURRENT_BUFFER$ -> FILL_BUFFER.SOURCE_LINE,
     3029     9938    7                                       NEXT$ -> BASED_LEX_SYMBOL.COLUMN);
     3030     9939    7                           SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN -
              9939                                    REP_SIZE) =

   9939 24 001657   200034 470500                    LDP0    NEXT$,,AUTO
        24 001660   000005 236100                    LDQ     5,,PR0
        24 001661   200036 136100                    SBLQ    REP_SIZE,,AUTO
        24 001662   200102 756100                    STQ     T$+2,,AUTO
        24 001663   200103 756100                    STQ     T$+3,,AUTO
        24 001664   000005 236000 17                 LDQ     BUFFER+5
        24 001665   200102 136100                    SBLQ    T$+2,,AUTO
        24 001666   200104 756100                    STQ     T$+4,,AUTO
        24 001667   000005 236000 17                 LDQ     BUFFER+5
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:704  
        24 001670   000005 136100                    SBLQ    5,,PR0
        24 001671   000005 235100                    LDA     5,,PR0
        24 001672   000006 471400 17                 LDP1    BUFFER+6
        24 001673   000000 620006                    EAX0    0,QL
        24 001674   200104 721100                    LXL1    T$+4,,AUTO
        24 001675   200103 236100                    LDQ     T$+3,,AUTO
        24 001676   040146 100545                    MLR     fill='040'O
        24 001677   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
        24 001700   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1

     3031     9940    7                               SUBSTR (BUFFER_LINE, NEXT$ -> BASED_LEX_SYMBOL.COLUMN);
     3032     9941    7                         END;

     3033     9942    6                       LEX_SYMBOL_QUEUE$ = NEXT$;

   9942 24 001701   200034 236100                    LDQ     NEXT$,,AUTO
        24 001702   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     3034     9943
     3035     9944    6                       RETURN;

   9944 24 001703   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 001704   000001 702211                    TSX2  ! 1,X1

     3036     9945
     3037     9946    6                     END;
     3038     9947    5                   BLANK_SPACE = REP_SIZE - TO_LIST$ -> BASED_LEX_SYMBOL.SIZE;

   9947 24 001705   200040 471500                    LDP1    TO_LIST$,,AUTO
        24 001706   200036 236100                    LDQ     REP_SIZE,,AUTO
        24 001707   100010 136100                    SBLQ    8,,PR1
        24 001710   200037 756100                    STQ     BLANK_SPACE,,AUTO

     3039     9948    5                   CALL DO_STRAIGHT_IN_LINE_REPLACE (BLANK_SPACE + SHIFT_RIGHT);

   9948 24 001711   200061 036100                    ADLQ    SHIFT_RIGHT,,AUTO
        24 001712   200107 756100                    STQ     T$+7,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:705  
        24 001713   200107 633500                    EPPR3   T$+7,,AUTO
        24 001714   200063 453500                    STP3    SHIFT_RIGHT+2,,AUTO
        24 001715   000754 701000 24                 TSX1    DO_STRAIGHT_IN_LINE_REPLACE
        24 001716   000000 011000                    NOP     0

     3040     9949    5                   LEX$ = LEX_SYMBOL_QUEUE$;

   9949 24 001717   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 001720   200012 756100                    STQ     LEX$,,AUTO

     3041     9950    5                   SAVE_SIZE = LEX$ -> BASED_LEX_SYMBOL.SIZE;

   9950 24 001721   200012 470500                    LDP0    LEX$,,AUTO
        24 001722   000010 235100                    LDA     8,,PR0
        24 001723   200033 755100                    STA     SAVE_SIZE,,AUTO

     3042     9951    5                   LEX$ -> BASED_LEX_SYMBOL.SIZE

   9951 24 001724   200034 471500                    LDP1    NEXT$,,AUTO
        24 001725   000010 236100                    LDQ     8,,PR0
        24 001726   100010 036100                    ADLQ    8,,PR1
        24 001727   000010 756100                    STQ     8,,PR0

     3043     9952    5                     = LEX$ -> BASED_LEX_SYMBOL.SIZE
     3044     9953    5                     + NEXT$ -> BASED_LEX_SYMBOL.SIZE ;
     3045     9954
     3046     9955                        %COPY_TO_NEW_LEX_SYMBOL (FROM$ = LEX$,
     3047     9956                                                 TO$   = NEW$);

   9958 24 001730   200012 470500                    LDP0    LEX$,,AUTO
        24 001731   000010 720100                    LXL0    8,,PR0
        24 001732   000044 621010                    EAX1    36,X0
        24 001733   000000 636011                    EAQ     0,X1
        24 001734   000022 732000                    QRS     18
        24 001735   000003 036007                    ADLQ    3,DL
        24 001736   000004 506007                    DIV     4,DL
        24 001737   200102 756100                    STQ     T$+2,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:706  
        24 001740   200102 631500                    EPPR1   T$+2,,AUTO
        24 001741   200105 451500                    STP1    T$+5,,AUTO
        24 001742   200035 633500                    EPPR3   NEW$,,AUTO
        24 001743   200104 453500                    STP3    T$+4,,AUTO
        24 001744   200104 630500                    EPPR0   T$+4,,AUTO
        24 001745   000003 631400 25                 EPPR1   3
        24 001746   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 001747   000000 011000                    NOP     0

   9965 24 001750   200012 470500                    LDP0    LEX$,,AUTO
        24 001751   200035 471500                    LDP1    NEW$,,AUTO
        24 001752   000010 235100                    LDA     8,,PR0
        24 001753   100010 755100                    STA     8,,PR1

   9966 24 001754   200035 470500                    LDP0    NEW$,,AUTO
        24 001755   000010 720100                    LXL0    8,,PR0
        24 001756   000044 621010                    EAX1    36,X0
        24 001757   200012 471500                    LDP1    LEX$,,AUTO
        24 001760   100010 722100                    LXL2    8,,PR1
        24 001761   000044 623012                    EAX3    36,X2
        24 001762   000140 100540                    MLR     fill='000'O
        24 001763   100000 000013                    ADSC9   0,,PR1                   cn=0,n=*X3
        24 001764   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     3048     9971
     3049     9972    5                   SUBSTR (NEW$ -> BASED_LEX_SYMBOL.SYMBOL,

   9972 24 001765   200035 470500                    LDP0    NEW$,,AUTO
        24 001766   000010 720100                    LXL0    8,,PR0
        24 001767   200034 471500                    LDP1    NEXT$,,AUTO
        24 001770   100010 721100                    LXL1    8,,PR1
        24 001771   100010 722100                    LXL2    8,,PR1
        24 001772   200033 235100                    LDA     SAVE_SIZE,,AUTO
        24 001773   040145 100540                    MLR     fill='040'O
        24 001774   100011 000012                    ADSC9   9,,PR1                   cn=0,n=*X2
        24 001775   000011 000011                    ADSC9   9,A,PR0                  cn=0,n=*X1

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:707  
     3050     9973    5                           SAVE_SIZE,
     3051     9974    5                           NEXT$ -> BASED_LEX_SYMBOL.SIZE)
     3052     9975    5                     = NEXT$ -> BASED_LEX_SYMBOL.SYMBOL;
     3053     9976
     3054     9977    5                   LEX$ -> BASED_LEX_SYMBOL.SIZE = SAVE_SIZE;

   9977 24 001776   200012 470500                    LDP0    LEX$,,AUTO
        24 001777   000010 755100                    STA     8,,PR0

     3055     9978    5                   LEX_SYMBOL_QUEUE$ = NEW$;

   9978 24 002000   200035 236100                    LDQ     NEW$,,AUTO
        24 002001   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     3056     9979    5                   NEW$ -> BASED_LEX_SYMBOL.NEXT$

   9979 24 002002   200034 470500                    LDP0    NEXT$,,AUTO
        24 002003   000000 236100                    LDQ     0,,PR0
        24 002004   200035 471500                    LDP1    NEW$,,AUTO
        24 002005   100000 756100                    STQ     0,,PR1

     3057     9980    5                     = NEXT$ -> BASED_LEX_SYMBOL.NEXT$;
     3058     9981
     3059     9982                        /* DISPOSE of LEX$ and NEXT$ tokens. */
     3060     9983
     3061     9984    5                   CALL Z8ED$DISPOSE_HEAP(LEX$,

   9984 24 002006   200012 470500                    LDP0    LEX$,,AUTO
        24 002007   000010 720100                    LXL0    8,,PR0
        24 002010   000044 621010                    EAX1    36,X0
        24 002011   000000 636011                    EAQ     0,X1
        24 002012   000022 732000                    QRS     18
        24 002013   000003 036007                    ADLQ    3,DL
        24 002014   000004 506007                    DIV     4,DL
        24 002015   200102 756100                    STQ     T$+2,,AUTO
        24 002016   200102 631500                    EPPR1   T$+2,,AUTO
        24 002017   200105 451500                    STP1    T$+5,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:708  
        24 002020   200012 633500                    EPPR3   LEX$,,AUTO
        24 002021   200104 453500                    STP3    T$+4,,AUTO
        24 002022   200104 630500                    EPPR0   T$+4,,AUTO
        24 002023   000003 631400 25                 EPPR1   3
        24 002024   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        24 002025   000000 011000                    NOP     0

     3062     9985                                %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=LEX$);
     3063     9988    5                          );
     3064     9989    5                   CALL Z8ED$DISPOSE_HEAP(NEXT$,

   9989 24 002026   200034 470500                    LDP0    NEXT$,,AUTO
        24 002027   000010 720100                    LXL0    8,,PR0
        24 002030   000044 621010                    EAX1    36,X0
        24 002031   000000 636011                    EAQ     0,X1
        24 002032   000022 732000                    QRS     18
        24 002033   000003 036007                    ADLQ    3,DL
        24 002034   000004 506007                    DIV     4,DL
        24 002035   200102 756100                    STQ     T$+2,,AUTO
        24 002036   200102 631500                    EPPR1   T$+2,,AUTO
        24 002037   200105 451500                    STP1    T$+5,,AUTO
        24 002040   200034 633500                    EPPR3   NEXT$,,AUTO
        24 002041   200104 453500                    STP3    T$+4,,AUTO
        24 002042   200104 630500                    EPPR0   T$+4,,AUTO
        24 002043   000003 631400 25                 EPPR1   3
        24 002044   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        24 002045   000000 011000                    NOP     0

     3065     9990                                %LEX_SYMBOL_ACTUAL_WORD_LEN(S$=NEXT$);
     3066     9993    5                          );
     3067     9994
     3068     9995    5                   RETURN;

   9995 24 002046   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 002047   000001 702211                    TSX2  ! 1,X1

     3069     9996
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:709  
     3070     9997    5                 END; /* If LEX$_end_column + 1 = NEXT$_column */
     3071     9998    4               ELSE
     3072     9999    5                 DO;

     3073    10000    5                   LEX_SYMBOL_QUEUE$ = NEXT$;

  10000 24 002050   200034 236100                    LDQ     NEXT$,,AUTO
        24 002051   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     3074    10001    5                   IF TO_LIST$ ~= ADDR (NIL) THEN

  10001 24 002052   200040 236100                    LDQ     TO_LIST$,,AUTO
        24 002053   000000 116000 25                 CMPQ    0
        24 002054   002061 600000 24                 TZE     s:10003

     3075    10002    5                     CALL DO_STRAIGHT_IN_LINE_REPLACE (0);

  10002 24 002055   000016 236000 25                 LDQ     14
        24 002056   200063 756100                    STQ     SHIFT_RIGHT+2,,AUTO
        24 002057   000754 701000 24                 TSX1    DO_STRAIGHT_IN_LINE_REPLACE
        24 002060   000000 011000                    NOP     0

     3076    10003    5                   RETURN;

  10003 24 002061   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 002062   000001 702211                    TSX2  ! 1,X1

     3077    10004    5                 END;
     3078    10005    4             END; /* If Max_Token_Length >= Replacement symbol size */
     3079    10006    3         END; /* If NEXT$ = null & "TO" is area B & ==from== BY ==to== */
     3080    10007
     3081    10008    2       IF CUMM_LINE_PTR$ ~= ADDR(NIL) THEN

  10008 24 002063   200017 236100                    LDQ     CUMM_LINE_PTR$,,AUTO
        24 002064   000000 116000 25                 CMPQ    0
        24 002065   002256 600000 24                 TZE     s:10070

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:710  
     3082    10009    3         DO;

     3083    10010    3           IF REP_BEG_LINE = REP_END_LINE THEN

  10010 24 002066   200013 236100                    LDQ     REP_BEG_LINE,,AUTO
        24 002067   200020 116100                    CMPQ    REP_END_LINE,,AUTO
        24 002070   002117 601000 24                 TNZ     s:10021

     3084    10011    4             DO;

     3085    10012    4               CALL DUP_FOR_REP (CUMM_LINE_PTR$, CUMM_LINE_OFFSET);

  10012 24 002071   200016 630500                    EPPR0   CUMM_LINE_OFFSET,,AUTO
        24 002072   200072 450500                    STP0    @LINE$+1,,AUTO
        24 002073   200017 631500                    EPPR1   CUMM_LINE_PTR$,,AUTO
        24 002074   200071 451500                    STP1    LEX$+1,,AUTO
        24 002075   000473 701000 24                 TSX1    DUP_FOR_REP
        24 002076   000000 011000                    NOP     0

     3086    10013    4               REP_BEG_LINE = REP_BEG_LINE + CUMM_LINE_OFFSET;

  10013 24 002077   200013 236100                    LDQ     REP_BEG_LINE,,AUTO
        24 002100   200016 036100                    ADLQ    CUMM_LINE_OFFSET,,AUTO
        24 002101   200013 756100                    STQ     REP_BEG_LINE,,AUTO

     3087    10014    4               REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;

  10014 24 002102   200020 236100                    LDQ     REP_END_LINE,,AUTO
        24 002103   200016 036100                    ADLQ    CUMM_LINE_OFFSET,,AUTO
        24 002104   200020 756100                    STQ     REP_END_LINE,,AUTO

     3088    10015    4               SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,

  10015 24 002105   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002106   000012 720100                    LXL0    10,,PR0
        24 002107   200021 236100                    LDQ     REP_END_COLUMN,,AUTO
        24 002110   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:711  
        24 002111   000000 621006                    EAX1    0,QL
        24 002112   200014 235100                    LDA     REP_BEG_COLUMN,,AUTO
        24 002113   040145 100400                    MLR     fill='040'O
        24 002114   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 002115   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1

     3089    10016    4                      REP_BEG_COLUMN,
     3090    10017    4                      REP_END_COLUMN - REP_BEG_COLUMN) = ' ';
     3091    10018    4             END;

  10018 24 002116   002256 710000 24                 TRA     s:10070

     3092    10019    3           ELSE
     3093    10020    4             DO;

     3094    10021    4               CALL DUP_FOR_REP (CUMM_LINE_PTR$, CUMM_LINE_OFFSET);

  10021 24 002117   200016 630500                    EPPR0   CUMM_LINE_OFFSET,,AUTO
        24 002120   200072 450500                    STP0    @LINE$+1,,AUTO
        24 002121   200017 631500                    EPPR1   CUMM_LINE_PTR$,,AUTO
        24 002122   200071 451500                    STP1    LEX$+1,,AUTO
        24 002123   000473 701000 24                 TSX1    DUP_FOR_REP
        24 002124   000000 011000                    NOP     0

     3095    10022    4               REP_BEG_LINE = REP_BEG_LINE + CUMM_LINE_OFFSET;

  10022 24 002125   200013 236100                    LDQ     REP_BEG_LINE,,AUTO
        24 002126   200016 036100                    ADLQ    CUMM_LINE_OFFSET,,AUTO
        24 002127   200013 756100                    STQ     REP_BEG_LINE,,AUTO

     3096    10023    4               REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;

  10023 24 002130   200020 236100                    LDQ     REP_END_LINE,,AUTO
        24 002131   200016 036100                    ADLQ    CUMM_LINE_OFFSET,,AUTO
        24 002132   200020 756100                    STQ     REP_END_LINE,,AUTO

     3097    10024
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:712  
     3098    10025
     3099    10026    4               SUBSTR(CUMM_LINE_PTR$ -> FILL_BUFFER.SOURCE_LINE,

  10026 24 002133   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002134   000012 720100                    LXL0    10,,PR0
        24 002135   000012 236100                    LDQ     10,,PR0
        24 002136   000123 116000 xsym               CMPQ    O1COM+83
        24 002137   002141 604400 24                 TMOZ    s:10026+6
        24 002140   000123 236000 xsym               LDQ     O1COM+83
        24 002141   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
        24 002142   000000 621006                    EAX1    0,QL
        24 002143   200014 235100                    LDA     REP_BEG_COLUMN,,AUTO
        24 002144   040145 100400                    MLR     fill='040'O
        24 002145   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 002146   000013 000011                    ADSC9   11,A,PR0                 cn=0,n=*X1

     3100    10027    4                      REP_BEG_COLUMN,
     3101    10028    4                      MINIMUM (O1COM.MARGIN_R, CUMM_LINE_PTR$ -> FILL_BUFFER.
             10028                               LINE_LENGTH)
     3102    10029    4                          - REP_BEG_COLUMN) = ' ';
     3103    10030
     3104    10031    4                L$ = CUMM_LINE_PTR$;

  10031 24 002147   200017 236100                    LDQ     CUMM_LINE_PTR$,,AUTO
        24 002150   200022 756100                    STQ     L$,,AUTO

     3105    10032
     3106    10033    5                DO WHILE L$ ~= ADDR(NIL)

  10033 24 002151   002204 710000 24                 TRA     s:10052

     3107    10034    5                     AND L$ -> FILL_BUFFER.NEXT$ ~= ADDR(NIL)
     3108    10035    5                     AND L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.ISN < REP_END_LINE;
     3109    10036
     3110    10037    5                 IF L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE THEN

  10037 24 002152   200022 470500                    LDP0    L$,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:713  
        24 002153   000002 471500                    LDP1    2,,PR0
        24 002154   100011 430100                    FSZN    9,,PR1
        24 002155   002174 605000 24                 TPL     s:10046

     3111    10038    6                    DO;

     3112    10039    6                      TL$ = L$ -> FILL_BUFFER.NEXT$;

  10039 24 002156   000002 236100                    LDQ     2,,PR0
        24 002157   200023 756100                    STQ     TL$,,AUTO

     3113    10040    6                      L$ -> FILL_BUFFER.NEXT$ = TL$ -> FILL_BUFFER.NEXT$;

  10040 24 002160   200023 471500                    LDP1    TL$,,AUTO
        24 002161   100002 236100                    LDQ     2,,PR1
        24 002162   000002 756100                    STQ     2,,PR0

     3114    10041    6                      CALL Z8ED$DISPOSE_HEAP (TL$,

  10041 24 002163   000012 236000 25                 LDQ     10
        24 002164   200103 756100                    STQ     T$+3,,AUTO
        24 002165   200023 630500                    EPPR0   TL$,,AUTO
        24 002166   200102 450500                    STP0    T$+2,,AUTO
        24 002167   200102 630500                    EPPR0   T$+2,,AUTO
        24 002170   000003 631400 25                 EPPR1   3
        24 002171   000000 701000 xent               TSX1    Z8ED$DISPOSE_HEAP
        24 002172   000000 011000                    NOP     0

     3115    10042    6                                              %MAX_INPUT_BUFFER_LEN);
     3116    10043    6                    END;

  10043 24 002173   002204 710000 24                 TRA     s:10052

     3117    10044    5                  ELSE
     3118    10045    6                    DO;

     3119    10046    6                      IF NOT L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:714  
             10046                               OLD_REP_LINE THEN

  10046 24 002174   100011 236100                    LDQ     9,,PR1
        24 002175   020000 316003                    CANQ    8192,DU
        24 002176   002201 601000 24                 TNZ     s:10049

     3120    10047    6                       L$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.OLD_REP_LINE =
             10047                                 TRUE;

  10047 24 002177   020000 236003                    LDQ     8192,DU
        24 002200   100011 256100                    ORSQ    9,,PR1

     3121    10048
     3122    10049    6                      L$ = L$ -> FILL_BUFFER.NEXT$;

  10049 24 002201   200022 470500                    LDP0    L$,,AUTO
        24 002202   000002 236100                    LDQ     2,,PR0
        24 002203   200022 756100                    STQ     L$,,AUTO

     3123    10050    6                    END;

     3124    10051
     3125    10052    5                END;  /* DO WHILE */

  10052 24 002204   200022 236100                    LDQ     L$,,AUTO
        24 002205   000000 116000 25                 CMPQ    0
        24 002206   002217 600000 24                 TZE     s:10054
        24 002207   200022 470500                    LDP0    L$,,AUTO
        24 002210   000002 236100                    LDQ     2,,PR0
        24 002211   000000 116000 25                 CMPQ    0
        24 002212   002217 600000 24                 TZE     s:10054
        24 002213   000002 471500                    LDP1    2,,PR0
        24 002214   100004 236100                    LDQ     4,,PR1
        24 002215   200020 116100                    CMPQ    REP_END_LINE,,AUTO
        24 002216   002152 604000 24                 TMI     s:10037

     3126    10053
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:715  
     3127    10054    4                CALL Z8EL$POSITION_LINE_LIST (REP_END_LINE,

  10054 24 002217   000007 236000 25                 LDQ     7
        24 002220   200104 756100                    STQ     T$+4,,AUTO
        24 002221   200022 630500                    EPPR0   L$,,AUTO
        24 002222   200103 450500                    STP0    T$+3,,AUTO
        24 002223   200020 631500                    EPPR1   REP_END_LINE,,AUTO
        24 002224   200102 451500                    STP1    T$+2,,AUTO
        24 002225   200102 630500                    EPPR0   T$+2,,AUTO
        24 002226   000005 631400 25                 EPPR1   5
        24 002227   000000 701000 xent               TSX1    Z8EL$POSITION_LINE_LIST
        24 002230   000000 011000                    NOP     0

     3128    10055    4                                              L$,
     3129    10056    4                                              999999999);
     3130    10057
     3131    10058    4                IF L$ ~= ADDR(NIL) THEN

  10058 24 002231   200022 236100                    LDQ     L$,,AUTO
        24 002232   000000 116000 25                 CMPQ    0
        24 002233   002256 600000 24                 TZE     s:10070

     3132    10059    5                  DO;

     3133    10060    5                    CALL DUP_FOR_REP (L$, CUMM_LINE_OFFSET);

  10060 24 002234   200016 630500                    EPPR0   CUMM_LINE_OFFSET,,AUTO
        24 002235   200072 450500                    STP0    @LINE$+1,,AUTO
        24 002236   200022 631500                    EPPR1   L$,,AUTO
        24 002237   200071 451500                    STP1    LEX$+1,,AUTO
        24 002240   000473 701000 24                 TSX1    DUP_FOR_REP
        24 002241   000000 011000                    NOP     0

     3134    10061    5                    REP_END_LINE = REP_END_LINE + CUMM_LINE_OFFSET;

  10061 24 002242   200020 236100                    LDQ     REP_END_LINE,,AUTO
        24 002243   200016 036100                    ADLQ    CUMM_LINE_OFFSET,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:716  
        24 002244   200020 756100                    STQ     REP_END_LINE,,AUTO

     3135    10062    5                    SUBSTR(L$ -> FILL_BUFFER.SOURCE_LINE,

  10062 24 002245   200022 470500                    LDP0    L$,,AUTO
        24 002246   000012 720100                    LXL0    10,,PR0
        24 002247   200021 236100                    LDQ     REP_END_COLUMN,,AUTO
        24 002250   000122 136000 xsym               SBLQ    O1COM+82
        24 002251   000001 621006                    EAX1    1,QL
        24 002252   000122 235000 xsym               LDA     O1COM+82
        24 002253   040145 100400                    MLR     fill='040'O
        24 002254   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 002255   000012 600011                    ADSC9   10,A,PR0                 cn=3,n=*X1

     3136    10063    5                           O1COM.AREA_A_COLUMN_START - 1,
     3137    10064    5                           REP_END_COLUMN - (O1COM.AREA_A_COLUMN_START - 1)) = ' ';
     3138    10065    5                  END;

     3139    10066    4              END;

     3140    10067    3         END;

     3141    10068
     3142    10069
     3143    10070    2       IF REPLACE$ -> REPLACE_ITEM.TO_IS_PSEUDO_TEXT THEN

  10070 24 002256   200004 470500                    LDP0    REPLACE$,,AUTO
        24 002257   000005 234100                    SZN     5,,PR0
        24 002260   002650 605000 24                 TPL     s:10206

     3144    10071    3         DO;

     3145    10072    3           IF REPLACE$ -> REPLACE_ITEM.TO_PSEUDO_TEXT_LINES$ ~= ADDR(NIL) THEN

  10072 24 002261   000006 236100                    LDQ     6,,PR0
        24 002262   000000 116000 25                 CMPQ    0
        24 002263   003043 600000 24                 TZE     s:10297
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:717  

     3146    10073    4             DO;

     3147    10074    4               CALL SPLIT_LINE (REP_BEG_LINE,

  10074 24 002264   200017 631500                    EPPR1   CUMM_LINE_PTR$,,AUTO
        24 002265   200065 451500                    STP1    @COLUMN+1,,AUTO
        24 002266   200014 633500                    EPPR3   REP_BEG_COLUMN,,AUTO
        24 002267   200064 453500                    STP3    @ADD_BLANKS+1,,AUTO
        24 002270   200013 634500                    EPPR4   REP_BEG_LINE,,AUTO
        24 002271   200063 454500                    STP4    SHIFT_RIGHT+2,,AUTO
        24 002272   000316 701000 24                 TSX1    SPLIT_LINE
        24 002273   000000 011000                    NOP     0

     3148    10075    4                                REP_BEG_COLUMN,
     3149    10076    4                                CUMM_LINE_PTR$);
     3150    10077    4               TISN = CUMM_LINE_PTR$ -> FILL_BUFFER.ISN;

  10077 24 002274   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002275   000004 235100                    LDA     4,,PR0
        24 002276   200024 755100                    STA     TISN,,AUTO

     3151    10078    4               ISN_INC = 0;

  10078 24 002277   200025 450100                    STZ     ISN_INC,,AUTO

     3152    10079    4               L$ = REPLACE$ -> REPLACE_ITEM.TO_PSEUDO_TEXT_LINES$;

  10079 24 002300   200004 471500                    LDP1    REPLACE$,,AUTO
        24 002301   100006 236100                    LDQ     6,,PR1
        24 002302   200022 756100                    STQ     L$,,AUTO

     3153    10080    4               ISN_BASE = L$ -> FILL_BUFFER.ISN;

  10080 24 002303   200022 473500                    LDP3    L$,,AUTO
        24 002304   300004 235100                    LDA     4,,PR3
        24 002305   200026 755100                    STA     ISN_BASE,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:718  

     3154    10081
     3155    10082    5               DO WHILE (L$ ~= ADDR(NIL)

  10082 24 002306   002420 710000 24                 TRA     s:10126

     3156    10083    5                         AND (L$ -> FILL_BUFFER.NEXT$ ~= ADDR(NIL)
     3157    10084    5                              OR SUBSTR (CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ ->
     3158    10085    5                                             FILL_BUFFER.SOURCE_LINE,
     3159    10086    5                                         O1COM.AREA_A_COLUMN_START,
     3160    10087    5                                         L$ -> FILL_BUFFER.LINE_LENGTH -
     3161    10088    5                                             O1COM.AREA_A_COLUMN_START) ~= ' '
     3162    10089    5                             OR NOT CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER
             10089                                       .LINE_TYPE.NEW_REP_LINE));
     3163    10090    5                 ISN_INC = ISN_INC + 1;

  10090 24 002307   200025 054100                    AOS     ISN_INC,,AUTO

     3164    10091
     3165    10092                      %NEW_HEAP (@POINTER = TL$,
     3166    10093                                 @SIZE = %MAX_INPUT_BUFFER_LEN);

  10095 24 002310   000012 236000 25                 LDQ     10
        24 002311   200103 756100                    STQ     T$+3,,AUTO
        24 002312   200023 630500                    EPPR0   TL$,,AUTO
        24 002313   200102 450500                    STP0    T$+2,,AUTO
        24 002314   200102 630500                    EPPR0   T$+2,,AUTO
        24 002315   000003 631400 25                 EPPR1   3
        24 002316   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 002317   000000 011000                    NOP     0

     3167    10098
     3168    10099    5                 TL$ -> FILL_BUFFER.LINE_LENGTH = L$ -> FILL_BUFFER.LINE_LENGTH;

  10099 24 002320   200022 470500                    LDP0    L$,,AUTO
        24 002321   200023 471500                    LDP1    TL$,,AUTO
        24 002322   000012 235100                    LDA     10,,PR0
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:719  
        24 002323   100012 755100                    STA     10,,PR1

     3169    10100    5                 TL$ -> FILL_BUFFER = L$ -> FILL_BUFFER;

  10100 24 002324   200023 470500                    LDP0    TL$,,AUTO
        24 002325   000012 720100                    LXL0    10,,PR0
        24 002326   000054 621010                    EAX1    44,X0
        24 002327   200022 471500                    LDP1    L$,,AUTO
        24 002330   100012 722100                    LXL2    10,,PR1
        24 002331   000054 623012                    EAX3    44,X2
        24 002332   000140 100540                    MLR     fill='000'O
        24 002333   100000 000013                    ADSC9   0,,PR1                   cn=0,n=*X3
        24 002334   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     3170    10101    5                 IF OLD_LINE$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE THEN

  10101 24 002335   200041 470500                    LDP0    OLD_LINE$,,AUTO
        24 002336   000011 236100                    LDQ     9,,PR0
        24 002337   010000 316003                    CANQ    4096,DU
        24 002340   002352 600000 24                 TZE     s:10109

     3171    10102    6                   DO;

     3172    10103    6                     TL$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;

  10103 24 002341   200023 471500                    LDP1    TL$,,AUTO
        24 002342   010000 236003                    LDQ     4096,DU
        24 002343   100011 256100                    ORSQ    9,,PR1

     3173    10104    6                     CALL INSERT (TL$ -> FILL_BUFFER.SOURCE_LINE,

  10104 24 002344   200023 471500                    LDP1    TL$,,AUTO
        24 002345   100012 720100                    LXL0    10,,PR1
        24 002346   000122 235000 xsym               LDA     O1COM+82
        24 002347   040105 100400                    MLR     fill='040'O
        24 002350   000015 000001 25                 ADSC9   13                       cn=0,n=1
        24 002351   100012 600001                    ADSC9   10,A,PR1                 cn=3,n=1
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:720  

     3174    10105    6                                  O1COM.AREA_A_COLUMN_START - 1,
     3175    10106    6                                  1,
     3176    10107    6                                  'D');
     3177    10108    6                   END;

     3178    10109    5                 TL$ -> FILL_BUFFER.LINE_TYPE.NEW_REP_LINE = TRUE;

  10109 24 002352   200023 471500                    LDP1    TL$,,AUTO
        24 002353   001000 236003                    LDQ     512,DU
        24 002354   100011 256100                    ORSQ    9,,PR1

     3179    10110    5                 TL$ -> FILL_BUFFER.LINE_TYPE.COPY_REPL_LINE = FALSE;

  10110 24 002355   200023 471500                    LDP1    TL$,,AUTO
        24 002356   000017 236000 25                 LDQ     15
        24 002357   100011 356100                    ANSQ    9,,PR1

     3180    10111    5                 TL$ -> FILL_BUFFER.ISN = TISN + ISN_INC;

  10111 24 002360   200024 236100                    LDQ     TISN,,AUTO
        24 002361   200025 036100                    ADLQ    ISN_INC,,AUTO
        24 002362   200023 471500                    LDP1    TL$,,AUTO
        24 002363   100004 756100                    STQ     4,,PR1

     3181    10112    5                 TL$ -> FILL_BUFFER.NEXT$ = CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$;

  10112 24 002364   200017 471500                    LDP1    CUMM_LINE_PTR$,,AUTO
        24 002365   100002 236100                    LDQ     2,,PR1
        24 002366   200023 473500                    LDP3    TL$,,AUTO
        24 002367   300002 756100                    STQ     2,,PR3

     3182    10113    5                 TL$ -> FILL_BUFFER.ESN = ' ';

  10113 24 002370   200023 471500                    LDP1    TL$,,AUTO
        24 002371   040100 100400                    MLR     fill='040'O
        24 002372   000010 000001 25                 ADSC9   8                        cn=0,n=1
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:721  
        24 002373   100005 000012                    ADSC9   5,,PR1                   cn=0,n=10

     3183    10114    5                 TL$ -> FILL_BUFFER.LEVEL = CUMM_LINE_PTR$ -> FILL_BUFFER.LEVEL;

  10114 24 002374   200017 471500                    LDP1    CUMM_LINE_PTR$,,AUTO
        24 002375   200023 473500                    LDP3    TL$,,AUTO
        24 002376   100001 235100                    LDA     1,,PR1
        24 002377   300001 755100                    STA     1,,PR3

     3184    10115    5                 CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ = TL$;

  10115 24 002400   200023 236100                    LDQ     TL$,,AUTO
        24 002401   200017 471500                    LDP1    CUMM_LINE_PTR$,,AUTO
        24 002402   100002 756100                    STQ     2,,PR1

     3185    10116
     3186    10117    5                 IF CUMM_LINE_PTR$ = CURRENT_BUFFER$ THEN

  10117 24 002403   200017 236100                    LDQ     CUMM_LINE_PTR$,,AUTO
        24 002404   000000 116000 13                 CMPQ    CURRENT_BUFFER$
        24 002405   002413 601000 24                 TNZ     s:10124

     3187    10118    6                   DO;

     3188    10119    6                     CURRENT_BUFFER$ = TL$;

  10119 24 002406   200023 236100                    LDQ     TL$,,AUTO
        24 002407   000000 756000 13                 STQ     CURRENT_BUFFER$

     3189    10120    6                     EXPANDED_ISN = EXPANDED_ISN + 1;

  10120 24 002410   000000 054000 19                 AOS     EXPANDED_ISN

     3190    10121    6                     BUFFER.ISN = EXPANDED_ISN;

  10121 24 002411   000000 235000 19                 LDA     EXPANDED_ISN
        24 002412   000002 755000 17                 STA     BUFFER+2
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:722  

     3191    10122    6                   END;

     3192    10123
     3193    10124    5                 CUMM_LINE_PTR$ = TL$;

  10124 24 002413   200023 236100                    LDQ     TL$,,AUTO
        24 002414   200017 756100                    STQ     CUMM_LINE_PTR$,,AUTO

     3194    10125    5                 L$ = L$ -> FILL_BUFFER.NEXT$;

  10125 24 002415   200022 471500                    LDP1    L$,,AUTO
        24 002416   100002 236100                    LDQ     2,,PR1
        24 002417   200022 756100                    STQ     L$,,AUTO

     3195    10126    5               END;

  10126 24 002420   000000 116000 25                 CMPQ    0
        24 002421   002443 600000 24                 TZE     s:10128
        24 002422   200022 470500                    LDP0    L$,,AUTO
        24 002423   000002 236100                    LDQ     2,,PR0
        24 002424   000000 116000 25                 CMPQ    0
        24 002425   002307 601000 24                 TNZ     s:10090
        24 002426   200017 471500                    LDP1    CUMM_LINE_PTR$,,AUTO
        24 002427   100002 473500                    LDP3    2,,PR1
        24 002430   300012 720100                    LXL0    10,,PR3
        24 002431   000012 236100                    LDQ     10,,PR0
        24 002432   000122 136000 xsym               SBLQ    O1COM+82
        24 002433   000000 621006                    EAX1    0,QL
        24 002434   000122 235000 xsym               LDA     O1COM+82
        24 002435   040000 106545                    CMPC    fill='040'O
        24 002436   300013 000011                    ADSC9   11,A,PR3                 cn=0,n=*X1
        24 002437   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 002440   002307 601000 24                 TNZ     s:10090
        24 002441   300011 430100                    FSZN    9,,PR3
        24 002442   002307 605000 24                 TPL     s:10090

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:723  
     3196    10127
     3197    10128    4               IF L$ ~= ADDR(NIL) THEN

  10128 24 002443   200022 236100                    LDQ     L$,,AUTO
        24 002444   000000 116000 25                 CMPQ    0
        24 002445   002515 600000 24                 TZE     s:10149

     3198    10129    5                 DO;

     3199    10130    5                   CALL INSERT (CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ ->

  10130 24 002446   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002447   000002 471500                    LDP1    2,,PR0
        24 002450   100012 720100                    LXL0    10,,PR1
        24 002451   200022 473500                    LDP3    L$,,AUTO
        24 002452   300012 721100                    LXL1    10,,PR3
        24 002453   200102 741100                    STX1    T$+2,,AUTO
        24 002454   200102 220100                    LDX0    T$+2,,AUTO
        24 002455   040140 100540                    MLR     fill='040'O
        24 002456   300013 000010                    ADSC9   11,,PR3                  cn=0,n=*X0
        24 002457   100013 000011                    ADSC9   11,,PR1                  cn=0,n=*X1

     3200    10131    5                                    FILL_BUFFER.SOURCE_LINE,
     3201    10132    5                                0,
     3202    10133    5                                L$ -> FILL_BUFFER.LINE_LENGTH,
     3203    10134    5                                L$ -> FILL_BUFFER.SOURCE_LINE);
     3204    10135    5                   IF CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.
             10135                            DEBUG_LINE THEN

  10135 24 002460   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002461   000002 471500                    LDP1    2,,PR0
        24 002462   100011 236100                    LDQ     9,,PR1
        24 002463   010000 316003                    CANQ    4096,DU
        24 002464   002472 600000 24                 TZE     s:10139

     3205    10136    5                     CALL INSERT (CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ ->

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:724  
  10136 24 002465   100012 720100                    LXL0    10,,PR1
        24 002466   000122 235000 xsym               LDA     O1COM+82
        24 002467   040105 100400                    MLR     fill='040'O
        24 002470   000015 000001 25                 ADSC9   13                       cn=0,n=1
        24 002471   100012 600001                    ADSC9   10,A,PR1                 cn=3,n=1

     3206    10137    5                                      FILL_BUFFER.SOURCE_LINE,
     3207    10138    5                                  O1COM.AREA_A_COLUMN_START - 1, 1, 'D');
     3208    10139    5                   CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.FLAGS =

  10139 24 002472   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002473   000002 471500                    LDP1    2,,PR0
        24 002474   200022 473500                    LDP3    L$,,AUTO
        24 002475   100011 236100                    LDQ     9,,PR1
        24 002476   300011 276100                    ORQ     9,,PR3
        24 002477   100011 756100                    STQ     9,,PR1

     3209    10140    5                       CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.FLAGS
     3210    10141    5                       | L$ -> FILL_BUFFER.FLAGS;
     3211    10142    5                   CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ -> FILL_BUFFER.LINE_TYPE.
             10142                            COPY_REPL_LINE = FALSE;

  10142 24 002500   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002501   000002 471500                    LDP1    2,,PR0
        24 002502   000017 236000 25                 LDQ     15
        24 002503   100011 356100                    ANSQ    9,,PR1

     3212    10143    5                   IF L$ -> FILL_BUFFER.LINE_TYPE.NULL_COMMENT_LINE OR

  10143 24 002504   200022 470500                    LDP0    L$,,AUTO
        24 002505   000011 236100                    LDQ     9,,PR0
        24 002506   004000 316003                    CANQ    2048,DU
        24 002507   002514 601000 24                 TNZ     s:10146
        24 002510   010000 316003                    CANQ    4096,DU
        24 002511   002515 600000 24                 TZE     s:10149
        24 002512   000026 234000 xsym               SZN     O1COM+22
        24 002513   002515 604000 24                 TMI     s:10149
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:725  

     3213    10144    5                       (L$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE AND
     3214    10145    5                        NOT O1COM.DEBUGGING_MODE) THEN
     3215    10146    5                     BUFFER.CLASS = %END_OF_LINE;

  10146 24 002514   000001 450000 17                 STZ     BUFFER+1

     3216    10147    5                 END;

     3217    10148
     3218    10149    4               CALL ADJUST_ISN (ISN_INC,

  10149 24 002515   200017 236100                    LDQ     CUMM_LINE_PTR$,,AUTO
        24 002516   000002 036003                    ADLQ    2,DU
        24 002517   200076 756100                    STQ     @ISN_INC+1,,AUTO
        24 002520   200025 630500                    EPPR0   ISN_INC,,AUTO
        24 002521   200075 450500                    STP0    L$+2,,AUTO
        24 002522   000242 701000 24                 TSX1    ADJUST_ISN
        24 002523   000000 011000                    NOP     0

     3219    10150    4                                CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$);
     3220    10151
     3221    10152                    /* Insert new tokens */
     3222    10153
     3223    10154    4               MATCH$ = REPLACE$ -> REPLACE_ITEM.TO_LIST$;

  10154 24 002524   200004 470500                    LDP0    REPLACE$,,AUTO
        24 002525   000002 236100                    LDQ     2,,PR0
        24 002526   200011 756100                    STQ     MATCH$,,AUTO

     3224    10155
     3225    10156    4               IF MATCH$ ~= ADDR(NIL) THEN

  10156 24 002527   000000 116000 25                 CMPQ    0
        24 002530   003043 600000 24                 TZE     s:10297

     3226    10157    5                 DO;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:726  

     3227    10158    5                   LEX$ = ADDR(LEX_SYMBOL);

  10158 24 002531   000020 236000 25                 LDQ     16
        24 002532   200012 756100                    STQ     LEX$,,AUTO

     3228    10159
     3229    10160    6                   DO UNTIL MATCH$ = ADDR(NIL);

     3230    10161
     3231    10162    6                     IF NOT MATCH$ -> BASED_LEX_SYMBOL.B.COMMENT_TOKEN AND

  10162 24 002533   200011 470500                    LDP0    MATCH$,,AUTO
        24 002534   000002 236100                    LDQ     2,,PR0
        24 002535   020000 316003                    CANQ    8192,DU
        24 002536   002636 601000 24                 TNZ     s:10193
        24 002537   000026 234000 xsym               SZN     O1COM+22
        24 002540   002543 604000 24                 TMI     s:10168
        24 002541   100000 316003                    CANQ    32768,DU
        24 002542   002636 601000 24                 TNZ     s:10193

     3232    10163    6                         (O1COM.DEBUGGING_MODE OR
     3233    10164    6                          NOT MATCH$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN) THEN
     3234    10165    7                       DO;

     3235    10166                              %COPY_TO_NEW_LEX_SYMBOL(FROM$=MATCH$, TO$=TL$);

  10168 24 002543   000010 720100                    LXL0    8,,PR0
        24 002544   000044 621010                    EAX1    36,X0
        24 002545   000000 636011                    EAQ     0,X1
        24 002546   000022 732000                    QRS     18
        24 002547   000003 036007                    ADLQ    3,DL
        24 002550   000004 506007                    DIV     4,DL
        24 002551   200102 756100                    STQ     T$+2,,AUTO
        24 002552   200102 631500                    EPPR1   T$+2,,AUTO
        24 002553   200105 451500                    STP1    T$+5,,AUTO
        24 002554   200023 633500                    EPPR3   TL$,,AUTO
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:727  
        24 002555   200104 453500                    STP3    T$+4,,AUTO
        24 002556   200104 630500                    EPPR0   T$+4,,AUTO
        24 002557   000003 631400 25                 EPPR1   3
        24 002560   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 002561   000000 011000                    NOP     0

  10175 24 002562   200011 470500                    LDP0    MATCH$,,AUTO
        24 002563   200023 471500                    LDP1    TL$,,AUTO
        24 002564   000010 235100                    LDA     8,,PR0
        24 002565   100010 755100                    STA     8,,PR1

  10176 24 002566   200023 471500                    LDP1    TL$,,AUTO
        24 002567   100010 720100                    LXL0    8,,PR1
        24 002570   000044 621010                    EAX1    36,X0
        24 002571   000010 722100                    LXL2    8,,PR0
        24 002572   000044 623012                    EAX3    36,X2
        24 002573   000140 100540                    MLR     fill='000'O
        24 002574   000000 000013                    ADSC9   0,,PR0                   cn=0,n=*X3
        24 002575   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     3236    10181    7                         LEX$ -> BASED_LEX_SYMBOL.NEXT$ = TL$;

  10181 24 002576   200023 236100                    LDQ     TL$,,AUTO
        24 002577   200012 471500                    LDP1    LEX$,,AUTO
        24 002600   100000 756100                    STQ     0,,PR1

     3237    10182    7                         IF CUMM_LINE_PTR$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE THEN

  10182 24 002601   200017 471500                    LDP1    CUMM_LINE_PTR$,,AUTO
        24 002602   100011 236100                    LDQ     9,,PR1
        24 002603   010000 316003                    CANQ    4096,DU
        24 002604   002610 600000 24                 TZE     s:10184

     3238    10183    7                           TL$ -> BASED_LEX_SYMBOL.B.DEBUG_TOKEN = TRUE;

  10183 24 002605   200023 473500                    LDP3    TL$,,AUTO
        24 002606   100000 236003                    LDQ     32768,DU
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:728  
        24 002607   300002 256100                    ORSQ    2,,PR3

     3239    10184    7                         TL$ -> BASED_LEX_SYMBOL.LEVEL

  10184 24 002610   200004 471500                    LDP1    REPLACE$,,AUTO
        24 002611   200023 473500                    LDP3    TL$,,AUTO
        24 002612   100003 235100                    LDA     3,,PR1
        24 002613   000001 135007                    SBLA    1,DL
        24 002614   300003 755100                    STA     3,,PR3

     3240    10185    7                              = REPLACE$ -> REPLACE_ITEM.LEVEL - 1;
     3241    10186    7                         TL$ -> BASED_LEX_SYMBOL.LINE =

  10186 24 002615   200023 473500                    LDP3    TL$,,AUTO
        24 002616   300004 236100                    LDQ     4,,PR3
        24 002617   200026 136100                    SBLQ    ISN_BASE,,AUTO
        24 002620   200024 036100                    ADLQ    TISN,,AUTO
        24 002621   000001 036007                    ADLQ    1,DL
        24 002622   300004 756100                    STQ     4,,PR3

     3242    10187    7                            (TL$ -> BASED_LEX_SYMBOL.LINE - ISN_BASE) + TISN + 1;
     3243    10188    7                         TL$ -> BASED_LEX_SYMBOL.END_LINE =

  10188 24 002623   200023 473500                    LDP3    TL$,,AUTO
        24 002624   300006 236100                    LDQ     6,,PR3
        24 002625   200026 136100                    SBLQ    ISN_BASE,,AUTO
        24 002626   200024 036100                    ADLQ    TISN,,AUTO
        24 002627   000001 036007                    ADLQ    1,DL
        24 002630   300006 756100                    STQ     6,,PR3

     3244    10189    7                            (TL$ -> BASED_LEX_SYMBOL.END_LINE - ISN_BASE) + TISN + 1;
     3245    10190    7                         TL$ -> BASED_LEX_SYMBOL.B.REPLACED_TOKEN = TRUE;

  10190 24 002631   200023 473500                    LDP3    TL$,,AUTO
        24 002632   200000 236003                    LDQ     65536,DU
        24 002633   300002 256100                    ORSQ    2,,PR3

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:729  
     3246    10191    7                         LEX$ = TL$;

  10191 24 002634   200023 236100                    LDQ     TL$,,AUTO
        24 002635   200012 756100                    STQ     LEX$,,AUTO

     3247    10192    7                       END;

     3248    10193    6                     MATCH$ = MATCH$ -> BASED_LEX_SYMBOL.NEXT$;

  10193 24 002636   000000 236100                    LDQ     0,,PR0
        24 002637   200011 756100                    STQ     MATCH$,,AUTO

     3249    10194
     3250    10195    6                   END;  /* DO UNTIL */

  10195 24 002640   000000 116000 25                 CMPQ    0
        24 002641   002533 601000 24                 TNZ     s:10162

     3251    10196
     3252    10197    5                   LEX$ -> BASED_LEX_SYMBOL.NEXT$ = LEX_SYMBOL_QUEUE$;

  10197 24 002642   000000 236000 11                 LDQ     LEX_SYMBOL_QUEUE$
        24 002643   200012 470500                    LDP0    LEX$,,AUTO
        24 002644   000000 756100                    STQ     0,,PR0

     3253    10198    5                   LEX_SYMBOL_QUEUE$ = LEX_SYMBOL.NEXT$;

  10198 24 002645   000000 236000 2                  LDQ     LEX_SYMBOL
        24 002646   000000 756000 11                 STQ     LEX_SYMBOL_QUEUE$

     3254    10199    5                 END;

     3255    10200    4             END;

     3256    10201    3         END;

  10201 24 002647   003043 710000 24                 TRA     s:10297
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:730  

     3257    10202    2       ELSE
     3258    10203    3         DO;

     3259    10204                /* Do a single token replace (non pseudo text) */
     3260    10205
     3261    10206    3           CALL CALC_MAX_TOKEN_LENGTH;

  10206 24 002650   000677 701000 24                 TSX1    CALC_MAX_TOKEN_LENGTH
        24 002651   000000 011000                    NOP     0

     3262    10207
     3263    10208    3          IF MAX_TOKEN_LENGTH < REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.
             10208                    SIZE THEN

  10208 24 002652   200004 470500                    LDP0    REPLACE$,,AUTO
        24 002653   000002 471500                    LDP1    2,,PR0
        24 002654   200032 236100                    LDQ     MAX_TOKEN_LENGTH,,AUTO
        24 002655   100010 116100                    CMPQ    8,,PR1
        24 002656   003037 605000 24                 TPL     s:10293

     3264    10209    4             DO; /* Too Big -- at least two lines. */

     3265    10210    4               CALL SPLIT_LINE (REP_BEG_LINE,

  10210 24 002657   200017 633500                    EPPR3   CUMM_LINE_PTR$,,AUTO
        24 002660   200065 453500                    STP3    @COLUMN+1,,AUTO
        24 002661   200014 631500                    EPPR1   REP_BEG_COLUMN,,AUTO
        24 002662   200064 451500                    STP1    @ADD_BLANKS+1,,AUTO
        24 002663   200013 634500                    EPPR4   REP_BEG_LINE,,AUTO
        24 002664   200063 454500                    STP4    SHIFT_RIGHT+2,,AUTO
        24 002665   000316 701000 24                 TSX1    SPLIT_LINE
        24 002666   000000 011000                    NOP     0

     3266    10211    4                                REP_BEG_COLUMN,
     3267    10212    4                                CUMM_LINE_PTR$);
     3268    10213
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:731  
     3269    10214                    %NEW_HEAP (@POINTER = TL$,
     3270    10215                               @SIZE = %MAX_INPUT_BUFFER_LEN);

  10217 24 002667   000012 236000 25                 LDQ     10
        24 002670   200103 756100                    STQ     T$+3,,AUTO
        24 002671   200023 630500                    EPPR0   TL$,,AUTO
        24 002672   200102 450500                    STP0    T$+2,,AUTO
        24 002673   200102 630500                    EPPR0   T$+2,,AUTO
        24 002674   000003 631400 25                 EPPR1   3
        24 002675   000000 701000 xent               TSX1    Z8ED$NEW_HEAP
        24 002676   000000 011000                    NOP     0

     3271    10220
     3272    10221                    %INIT_BUFFER (@POINTER = TL$,
     3273    10222                                  @ISN = "CUMM_LINE_PTR$ -> FILL_BUFFER.ISN + 1",
     3274    10223                                  @NEXT$ = "CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$",
     3275    10224                                  @LEVEL = "CUMM_LINE_PTR$ -> FILL_BUFFER.LEVEL",
     3276    10225                                  @NEW_REP_LINE = TRUE,
     3277    10226                                  @LINE_LENGTH = O1COM.MARGIN_R,
     3278    10227                                  @SOURCE_LINE = ' ');

  10229 24 002677   200023 470500                    LDP0    TL$,,AUTO
        24 002700   040100 100400                    MLR     fill='040'O
        24 002701   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 002702   000005 000012                    ADSC9   5,,PR0                   cn=0,n=10

  10230 24 002703   200023 470500                    LDP0    TL$,,AUTO
        24 002704   000000 450100                    STZ     0,,PR0

  10231 24 002705   200023 470500                    LDP0    TL$,,AUTO
        24 002706   000010 450100                    STZ     8,,PR0

  10232 24 002707   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002710   200023 471500                    LDP1    TL$,,AUTO
        24 002711   000004 235100                    LDA     4,,PR0
        24 002712   000001 035007                    ADLA    1,DL
        24 002713   100004 755100                    STA     4,,PR1
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:732  

  10233 24 002714   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002715   200023 471500                    LDP1    TL$,,AUTO
        24 002716   000001 235100                    LDA     1,,PR0
        24 002717   100001 755100                    STA     1,,PR1

  10234 24 002720   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002721   000002 236100                    LDQ     2,,PR0
        24 002722   200023 471500                    LDP1    TL$,,AUTO
        24 002723   100002 756100                    STQ     2,,PR1

  10235 24 002724   200023 470500                    LDP0    TL$,,AUTO
        24 002725   000011 450100                    STZ     9,,PR0

  10236 24 002726   200023 470500                    LDP0    TL$,,AUTO
        24 002727   000003 450100                    STZ     3,,PR0

  10237 24 002730   200023 470500                    LDP0    TL$,,AUTO
        24 002731   000123 235000 xsym               LDA     O1COM+83
        24 002732   000012 755100                    STA     10,,PR0

  10242 24 002733   200023 470500                    LDP0    TL$,,AUTO
        24 002734   001000 236003                    LDQ     512,DU
        24 002735   000011 256100                    ORSQ    9,,PR0

  10251 24 002736   200023 470500                    LDP0    TL$,,AUTO
        24 002737   000012 720100                    LXL0    10,,PR0
        24 002740   040140 100400                    MLR     fill='040'O
        24 002741   000010 000001 25                 ADSC9   8                        cn=0,n=1
        24 002742   000013 000010                    ADSC9   11,,PR0                  cn=0,n=*X0

     3279    10255
     3280    10256    4               IF REP_DEBUG_LINE THEN

  10256 24 002743   200015 234100                    SZN     REP_DEBUG_LINE,,AUTO
        24 002744   002756 605000 24                 TPL     s:10264

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:733  
     3281    10257    5                 DO;

     3282    10258    5                   TL$ -> FILL_BUFFER.LINE_TYPE.DEBUG_LINE = TRUE;

  10258 24 002745   200023 470500                    LDP0    TL$,,AUTO
        24 002746   010000 236003                    LDQ     4096,DU
        24 002747   000011 256100                    ORSQ    9,,PR0

     3283    10259    5                   SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,

  10259 24 002750   200023 470500                    LDP0    TL$,,AUTO
        24 002751   000012 720100                    LXL0    10,,PR0
        24 002752   000122 235000 xsym               LDA     O1COM+82
        24 002753   040105 100400                    MLR     fill='040'O
        24 002754   000015 000001 25                 ADSC9   13                       cn=0,n=1
        24 002755   000012 600001                    ADSC9   10,A,PR0                 cn=3,n=1

     3284    10260    5                          O1COM.AREA_A_COLUMN_START - 1,
     3285    10261    5                          1) = 'D';
     3286    10262    5                 END;

     3287    10263
     3288    10264    4               CUMM_LINE_PTR$ -> FILL_BUFFER.NEXT$ = TL$;

  10264 24 002756   200023 236100                    LDQ     TL$,,AUTO
        24 002757   200017 470500                    LDP0    CUMM_LINE_PTR$,,AUTO
        24 002760   000002 756100                    STQ     2,,PR0

     3289    10265
     3290    10266    4               SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,

  10266 24 002761   200023 470500                    LDP0    TL$,,AUTO
        24 002762   000012 720100                    LXL0    10,,PR0
        24 002763   000123 236000 xsym               LDQ     O1COM+83
        24 002764   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
        24 002765   200004 471500                    LDP1    REPLACE$,,AUTO
        24 002766   100002 473500                    LDP3    2,,PR1
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:734  
        24 002767   300010 721100                    LXL1    8,,PR3
        24 002770   000000 622006                    EAX2    0,QL
        24 002771   200014 235100                    LDA     REP_BEG_COLUMN,,AUTO
        24 002772   040145 100540                    MLR     fill='040'O
        24 002773   300011 000011                    ADSC9   9,,PR3                   cn=0,n=*X1
        24 002774   000013 000012                    ADSC9   11,A,PR0                 cn=0,n=*X2

     3291    10267    4                      REP_BEG_COLUMN,
     3292    10268    4                      O1COM.MARGIN_R - REP_BEG_COLUMN)
     3293    10269    4                 = REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SYMBOL;
     3294    10270
     3295    10271    4               IF  REPLACE$ -> REPLACE_ITEM.TO_LIST$ -> BASED_LEX_SYMBOL.SIZE

  10271 24 002775   100002 470500                    LDP0    2,,PR1
        24 002776   000123 236000 xsym               LDQ     O1COM+83
        24 002777   200014 136100                    SBLQ    REP_BEG_COLUMN,,AUTO
        24 003000   000010 116100                    CMPQ    8,,PR0
        24 003001   003015 605000 24                 TPL     s:10285
        24 003002   000030 234000 xsym               SZN     COMCOM+24
        24 003003   003015 604000 24                 TMI     s:10285

     3296    10272    4                     > O1COM.MARGIN_R - REP_BEG_COLUMN
     3297    10273    4               AND COMCOM.OB.FORMAT = FALSE THEN
     3298    10274    5                 DO;

     3299    10275                        /*N*
     3300    10276                           May want to expand this later to issue actual continuation
     3301    10277                           lines.
     3302    10278                        */
     3303    10279    5                   TL$ -> FILL_BUFFER.LINE_LENGTH = 75;

  10279 24 003004   000113 235007                    LDA     75,DL
        24 003005   200023 473500                    LDP3    TL$,,AUTO
        24 003006   300012 755100                    STA     10,,PR3

     3304    10280    5                   SUBSTR(TL$ -> FILL_BUFFER.SOURCE_LINE,

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:735  
  10280 24 003007   200023 470500                    LDP0    TL$,,AUTO
        24 003010   000012 720100                    LXL0    10,,PR0
        24 003011   000123 236000 xsym               LDQ     O1COM+83
        24 003012   040106 100400                    MLR     fill='040'O
        24 003013   000003 000003 23                 ADSC9   3                        cn=0,n=3
        24 003014   000013 000003                    ADSC9   11,Q,PR0                 cn=0,n=3

     3305    10281    5                          O1COM.MARGIN_R,
     3306    10282    5                          3) = '...';
     3307    10283    5                 END;

     3308    10284
     3309    10285    4               CALL ADJUST_ISN (1,

  10285 24 003015   200023 236100                    LDQ     TL$,,AUTO
        24 003016   000002 036003                    ADLQ    2,DU
        24 003017   200076 756100                    STQ     @ISN_INC+1,,AUTO
        24 003020   000014 236000 25                 LDQ     12
        24 003021   200075 756100                    STQ     L$+2,,AUTO
        24 003022   000242 701000 24                 TSX1    ADJUST_ISN
        24 003023   000000 011000                    NOP     0

     3310    10286    4                                TL$ -> FILL_BUFFER.NEXT$);
     3311    10287
     3312    10288    4               CALL INSERT_TOKEN (REPLACE$ -> REPLACE_ITEM.TO_LIST$,

  10288 24 003024   200014 630500                    EPPR0   REP_BEG_COLUMN,,AUTO
        24 003025   200067 450500                    STP0    @LINE+1,,AUTO
        24 003026   200023 236100                    LDQ     TL$,,AUTO
        24 003027   000004 036003                    ADLQ    4,DU
        24 003030   200066 756100                    STQ     @SYMBOL$+1,,AUTO
        24 003031   200004 236100                    LDQ     REPLACE$,,AUTO
        24 003032   000002 036003                    ADLQ    2,DU
        24 003033   200065 756100                    STQ     @COLUMN+1,,AUTO
        24 003034   000567 701000 24                 TSX1    INSERT_TOKEN
        24 003035   000000 011000                    NOP     0

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:736  
     3313    10289    4                                  TL$ -> FILL_BUFFER.ISN,
     3314    10290    4                                  REP_BEG_COLUMN);
     3315    10291    4             END;

  10291 24 003036   003043 710000 24                 TRA     s:10297

     3316    10292    3           ELSE /* One line -- do straight in-line replacement */
     3317    10293    3             CALL DO_STRAIGHT_IN_LINE_REPLACE (0);

  10293 24 003037   000016 236000 25                 LDQ     14
        24 003040   200063 756100                    STQ     SHIFT_RIGHT+2,,AUTO
        24 003041   000754 701000 24                 TSX1    DO_STRAIGHT_IN_LINE_REPLACE
        24 003042   000000 011000                    NOP     0

     3318    10294
     3319    10295    3         END;

     3320    10296
     3321    10297    2     END DO_REPLACE;

  10297 24 003043   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 003044   000001 702211                    TSX2  ! 1,X1

     3322    10298
     3323    10299        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:737  
     3324    10300    1   START_REPLACE_LEVEL : PROC ;

  10300 24 003045   200010 741300       START_REPLA* STX1  ! PICTURE_TOKEN+1,,AUTO

     3325    10301
     3326    10302
     3327    10303          /* Find a potential candidate for replacement */
     3328    10304
     3329    10305    2     REPLACE$ = REPLACE_LIST.LINK$;

  10305 24 003046   000000 236000 10                 LDQ     REPLACE_LIST
        24 003047   200004 756100                    STQ     REPLACE$,,AUTO

     3330    10306
     3331    10307    3     DO WHILE REPLACE$ ~= ADDR(NIL)

  10307 24 003050   003054 710000 24                 TRA     s:10315

     3332    10308    3                AND (REPLACE$ -> REPLACE_ITEM.LEVEL > LEX_SYMBOL_QUEUE$ ->
             10308                         BASED_LEX_SYMBOL.LEVEL
     3333    10309    3                        OR
     3334    10310    3                     REPLACE$ -> REPLACE_ITEM.FROM_LIST$ -> BASED_LEX_SYMBOL.SYMBOL
     3335    10311    3                        ~= LEX_SYMBOL_QUEUE$ -> BASED_LEX_SYMBOL.SYMBOL);
     3336    10312
     3337    10313    3       REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;

  10313 24 003051   200004 470500                    LDP0    REPLACE$,,AUTO
        24 003052   000000 236100                    LDQ     0,,PR0
        24 003053   200004 756100                    STQ     REPLACE$,,AUTO

     3338    10314
     3339    10315    3     END;  /* DO WHILE */

  10315 24 003054   000000 116000 25                 CMPQ    0
        24 003055   003072 600000 24                 TZE     s:10317
        24 003056   200004 470500                    LDP0    REPLACE$,,AUTO
        24 003057   000000 471400 11                 LDP1    LEX_SYMBOL_QUEUE$
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:738  
        24 003060   000003 236100                    LDQ     3,,PR0
        24 003061   100003 116100                    CMPQ    3,,PR1
        24 003062   003051 605400 24                 TPNZ    s:10313
        24 003063   000001 473500                    LDP3    1,,PR0
        24 003064   300010 720100                    LXL0    8,,PR3
        24 003065   100010 721100                    LXL1    8,,PR1
        24 003066   040140 106540                    CMPC    fill='040'O
        24 003067   300011 000010                    ADSC9   9,,PR3                   cn=0,n=*X0
        24 003070   100011 000011                    ADSC9   9,,PR1                   cn=0,n=*X1
        24 003071   003051 601000 24                 TNZ     s:10313

     3340    10316
     3341    10317    2   END START_REPLACE_LEVEL;

  10317 24 003072   200010 221300                    LDX1  ! PICTURE_TOKEN+1,,AUTO
        24 003073   000001 702211                    TSX2  ! 1,X1

     3342    10318
     3343    10319        %EJECT;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:739  
     3344    10320        /* Main body of POSSIBLE_REPLACE */
     3345    10321
     3346    10322    1   SAVE_INHIBIT_DUMP_LINES = INHIBIT_DUMP_LINES;

  10322 24 003074   000000 236000 21                 LDQ     INHIBIT_DUMP_LINES
        24 003075   400000 376003                    ANQ     -131072,DU
        24 003076   200006 756100                    STQ     SAVE_INHIBIT_DUMP_LINES,,AUTO

     3347    10323    1   INHIBIT_DUMP_LINES = TRUE;

  10323 24 003077   400000 236003                    LDQ     -131072,DU
        24 003100   000000 756000 21                 STQ     INHIBIT_DUMP_LINES

     3348    10324
     3349    10325    1   CALL START_REPLACE_LEVEL ;

  10325 24 003101   003045 701000 24                 TSX1    START_REPLACE_LEVEL
        24 003102   000000 011000                    NOP     0

     3350    10326
     3351    10327    1   IF REPLACE$ ~= ADDR(NIL) THEN

  10327 24 003103   200004 236100                    LDQ     REPLACE$,,AUTO
        24 003104   000000 116000 25                 CMPQ    0
        24 003105   003150 600000 24                 TZE     s:10359

     3352    10328    2     DO;

     3353    10329    2       REPLACEMENT_FOUND = FALSE;

  10329 24 003106   200005 450100                    STZ     REPLACEMENT_FOUND,,AUTO

     3354    10330
     3355    10331    3       DO WHILE NOT REPLACEMENT_FOUND

  10331 24 003107   003135 710000 24                 TRA     s:10350

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:740  
     3356    10332    3                     AND REPLACE$ ~= ADDR(NIL);
     3357    10333
     3358    10334    3         IF REPLACE$ -> REPLACE_ITEM.LEVEL >= LOWEST_LEVEL THEN

  10334 24 003110   200004 470500                    LDP0    REPLACE$,,AUTO
        24 003111   200003 471500                    LDP1    @LOWEST_LEVEL,,AUTO
        24 003112   000003 236100                    LDQ     3,,PR0
        24 003113   100000 116100                    CMPQ    0,,PR1
        24 003114   003133 604000 24                 TMI     s:10348

     3359    10335    3           CALL MATCH_LISTS

  10335 24 003115   000003 701000 24                 TSX1    MATCH_LISTS
        24 003116   003130 702000 24                 TSX2    s:10345

     3360    10336    3             WHENRETURN
     3361    10337    4               DO;

     3362    10338    4                 IF REPLACEMENT_FOUND THEN

  10338 24 003117   200005 234100                    SZN     REPLACEMENT_FOUND,,AUTO
        24 003120   003124 605000 24                 TPL     s:10341

     3363    10339    4                   CALL DO_REPLACE;

  10339 24 003121   000240 701000 24                 TSX1    DO_REPLACE
        24 003122   000000 011000                    NOP     0
        24 003123   003127 710000 24                 TRA     s:10342

     3364    10340    4                 ELSE
     3365    10341    4                   REPLACE$ = REPLACE$ -> REPLACE_ITEM.LINK$;

  10341 24 003124   200004 470500                    LDP0    REPLACE$,,AUTO
        24 003125   000000 236100                    LDQ     0,,PR0
        24 003126   200004 756100                    STQ     REPLACE$,,AUTO

     3366    10342    4               END;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:741  

  10342 24 003127   003132 710000 24                 TRA     s:10346

     3367    10343    3             WHENALTRETURN
     3368    10344    4               DO;

     3369    10345    4                 CALL START_REPLACE_LEVEL ;

  10345 24 003130   003045 701000 24                 TSX1    START_REPLACE_LEVEL
        24 003131   000000 011000                    NOP     0

     3370    10346    4               END;

  10346 24 003132   003135 710000 24                 TRA     s:10350

     3371    10347    3         ELSE
     3372    10348    3           REPLACE$ = ADDR(NIL);

  10348 24 003133   000000 236000 25                 LDQ     0
        24 003134   200004 756100                    STQ     REPLACE$,,AUTO

     3373    10349
     3374    10350    3       END;

  10350 24 003135   200005 234100                    SZN     REPLACEMENT_FOUND,,AUTO
        24 003136   003142 604000 24                 TMI     s:10352
        24 003137   200004 236100                    LDQ     REPLACE$,,AUTO
        24 003140   000000 116000 25                 CMPQ    0
        24 003141   003110 601000 24                 TNZ     s:10334

     3375    10351
     3376    10352    2       IF REPLACEMENT_FOUND THEN

  10352 24 003142   200005 234100                    SZN     REPLACEMENT_FOUND,,AUTO
        24 003143   003150 605000 24                 TPL     s:10359

     3377    10353    3         DO;
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:742  

     3378    10354    3           INHIBIT_DUMP_LINES = SAVE_INHIBIT_DUMP_LINES;

  10354 24 003144   200006 236100                    LDQ     SAVE_INHIBIT_DUMP_LINES,,AUTO
        24 003145   400000 376003                    ANQ     -131072,DU
        24 003146   000000 756000 21                 STQ     INHIBIT_DUMP_LINES

     3379    10355    3           RETURN;

  10355 24 003147   000000 702200 xent               TSX2  ! X66_ARET

     3380    10356    3         END;
     3381    10357    2     END;
     3382    10358
     3383    10359    1   INHIBIT_DUMP_LINES = SAVE_INHIBIT_DUMP_LINES;

  10359 24 003150   200006 236100                    LDQ     SAVE_INHIBIT_DUMP_LINES,,AUTO
        24 003151   400000 376003                    ANQ     -131072,DU
        24 003152   000000 756000 21                 STQ     INHIBIT_DUMP_LINES

     3384    10360    1   ALTRETURN;  /* No replace was done */

  10360 24 003153   000000 702200 xent               TSX2  ! X66_AALT
     3385    10361
     3386    10362    1   END Z8EL$POSSIBLE_REPLACE;
     3387    10363
     3388    10364

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:743  
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_TABLES.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_BUFFERS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8E_REPLACE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EL$POSSIBLE_REPLACE.
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:744  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAP$

  ****  Section 002 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 003 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 004 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:745  
  ****  Section 005 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 006 LblCom CURRENT_SYMBOL_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 CURRENT_SYMBOL_LEVEL

  ****  Section 007 LblCom REPLACE_ACTIVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 REPLACE_ACTIVE

  ****  Section 008 LblCom IGNORE_COPY_REPLACE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 IGNORE_COPY_REPLACE

  ****  Section 009 LblCom COPY_DEBUG_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 COPY_DEBUG_LEVEL

  ****  Section 010 LblCom REPLACE_LIST

PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:746  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 REPLACE_LIST

  ****  Section 011 LblCom LEX_SYMBOL_QUEUE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LEX_SYMBOL_QUEUE$

  ****  Section 012 LblCom SCANNER_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 SCANNER_STATE

  ****  Section 013 LblCom CURRENT_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_BUFFER$

  ****  Section 014 LblCom LOOKAHEAD_BUFFER$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 LOOKAHEAD_BUFFER$

  ****  Section 015 LblCom CURRENT_LINE_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:747  

     0-0-0/w SBIN              1 CURRENT_LINE_LEVEL

  ****  Section 016 LblCom LINE_LIST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LINE_LIST$

  ****  Section 017 LblCom BUFFER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 BUFFER

  ****  Section 018 LblCom ORIGINAL_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ORIGINAL_ISN

  ****  Section 019 LblCom EXPANDED_ISN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 EXPANDED_ISN

  ****  Section 020 LblCom ISN_FOR_EXP_SRC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ISN_FOR_EXP_SRC
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:748  

  ****  Section 021 LblCom INHIBIT_DUMP_LINES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 INHIBIT_DUMP_LINES

  ****  Section 022 LblCom LEX_STATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LEX_STATE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    63-0-0/w PTR         r     1 @ADD_BLANKS               64-0-0/w PTR         r     1 @COLUMN
    67-0-0/w PTR         r     1 @COLUMN                   75-0-0/w PTR         r     1 @ISN_INC
    72-0-0/w PTR         r     1 @ISN_INC                  63-0-0/w PTR         r     1 @LINE
    66-0-0/w PTR         r     1 @LINE                     76-0-0/w PTR         r     1 @LINE$
    65-0-0/w PTR         r     1 @LINE$                    71-0-0/w PTR         r     1 @LINE$
     3-0-0/w PTR         r     1 @LOWEST_LEVEL             65-0-0/w PTR         r     1 @SYMBOL$
    *0-0-0/w SBIN        r     1 ADD_BLANKS                37-0-0/w SBIN        r     1 BLANK_SPACE
    30-0-0/w SBIN        r     1 CHAR_CLASS                *0-0-0/w SBIN        r     1 COLUMN
    *0-0-0/w SBIN        r     1 COLUMN                    16-0-0/w SBIN        r     1 CUMM_LINE_OFFSET
    17-0-0/w PTR         r     1 CUMM_LINE_PTR$            26-0-0/w SBIN        r     1 ISN_BASE
    25-0-0/w SBIN        r     1 ISN_INC                   *0-0-0/w SBIN        r     1 ISN_INC
    *0-0-0/w SBIN        r     1 ISN_INC                   22-0-0/w PTR         r     1 L$
    77-0-0/w PTR         r     1 L$                        66-0-0/w PTR         r     1 L$
    73-0-0/w PTR         r     1 L$                        12-0-0/w PTR         r     1 LEX$
    12-0-0/w PTR         r     1 LEX$                      70-0-0/w PTR         r     1 LEX$
    *0-0-0/w SBIN        r     1 LINE                      *0-0-0/w SBIN        r     1 LINE
    *0-0-0/w PTR         r     1 LINE$                     *0-0-0/w PTR         r     1 LINE$
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:749  
    *0-0-0/w PTR         r     1 LINE$                     *0-0-0/w SBIN        r     1 LOWEST_LEVEL
    11-0-0/w PTR         r     1 MATCH$                    11-0-0/w PTR         r     1 MATCH$
    32-0-0/w SBIN        r     1 MAX_TOKEN_LENGTH          35-0-0/w PTR         r     1 NEW$
    34-0-0/w PTR         r     1 NEXT$                     27-0-0/w SBIN        r     1 NON_BLANK_COL
    41-0-0/w PTR         r     1 OLD_LINE$                  7-0-0/b BIT         r     1 PICTURE_TOKEN
     4-0-0/w PTR         r     1 REPLACE$                   5-0-0/b BIT         r     1 REPLACEMENT_FOUND
    14-0-0/w SBIN        r     1 REP_BEG_COLUMN            13-0-0/w SBIN        r     1 REP_BEG_LINE
    15-0-0/b BIT         r     1 REP_DEBUG_LINE            21-0-0/w SBIN        r     1 REP_END_COLUMN
    20-0-0/w SBIN        r     1 REP_END_LINE              36-0-0/w SBIN        r     1 REP_SIZE
    15-0-0/w PTR         r     1 SAVED_LEX_SYMBOL_QUEUE$
    15-0-0/w PTR         r     1 SAVED_LEX_SYMBOL_QUEUE$
     6-0-0/b BIT         r     1 SAVE_INHIBIT_DUMP_LINES
    33-0-0/w SBIN        r     1 SAVE_SIZE                 61-0-0/w SBIN        r     1 SHIFT_RIGHT
    *0-0-0/w PTR         r     1 SYMBOL$                  100-0-0/w PTR         r     1 T$
    31-0-0/c CHAR        r     1 TEMP_CHAR1                42-0-0/c CHAR(60)    r     1 TEMP_CHAR60
    31-0-0/c SBIN(9)     r     1 TEMP_SBIN                 24-0-0/w SBIN        r     1 TISN
    23-0-0/w PTR         r     1 TL$                       40-0-0/w PTR         r     1 TO_LIST$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(4608)        1 ANSI_USERWORD_SCAN_TABLE
     0-0-0/w STRC(4608)        1 ASCII_SEARCH_TABLE         0-0-0/w STRC(4608)  r     1 BLANK_SCAN_TABLE
     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/c CHAR              1 CURRENCY_SIGN_CHARS(0:511)
     0-0-0/w STRC(4608)        1 DBL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)        1 DIGIT_SCAN_TABLE
     0-0-0/w STRC(4608)        1 DOUBLE_QUOTE_SEARCH_TABLE
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w STRC(4608)        1 LETTER_SEARCH_TABLE
     0-0-0/c CHAR              1 LOWER_TO_UPPER_CASE(0:511)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR
     0-0-0/w STRC(4608)        1 SEPARATORS_TABLE
     0-0-0/w STRC(4608)        1 SINGLE_QUOTE_SEARCH_TABLE
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:750  
     0-0-0/w STRC(4608)        1 SNGL_QUOTE_PSEUDO_SEARCH_TABLE
     0-0-0/w STRC(4608)  r     1 USERWORD_SCAN_TABLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/c ACHR        r     1 BUFFER_LINE
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(288)         1 COMPUTE_STMT               0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER         0-0-0/w STRC(252)         1 DEFERED_ID_TREE
     0-0-0/w STRC(288)         1 DEFERED_QUAL_ID            0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w ASTR(396)   r     1 EXP_SRC_BUFF               0-0-0/w ASTR(396)   r     1 FILL_BUFFER
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(252)   r     1 REPLACE_ITEM               0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EL$POSSIBLE_REPLACE requires 1644 words for executable code.
   Procedure Z8EL$POSSIBLE_REPLACE requires 72 words of local(AUTO) storage.
PL6.E3A0      #018=Z8EL$POSSIBLE_REPLACE File=Z8EL.:Z8A6TSI                      SAT 08/09/97 12:20 Page:751  

    No errors detected in file Z8EL.:Z8A6TSI    .
