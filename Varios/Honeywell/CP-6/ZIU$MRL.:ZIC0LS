
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI                                                                   1    BMAP - B00     
                                         1  *M* ZIU$MRL   IDS II UTILITIES        GMAP MRL INSTR FOR DUMP/LOAD *
                                         2  *T***********************************************************
                                         3  *T*                                                         *
                                         4  *T* Copyright (c) Bull HN Information Systems Inc., 1997    *
                                         5  *T*                                                         *
                                         6  *T***********************************************************
                                         7         ENTDEF  SHIFT_ARRAY
                                         8         ENTDEF  INIT_TABLES
                                         9         ENTREF  X66_PREGS_3
                                        10        ENTDEF  GETSEGSIZ
                                        11         SYMREF  TYPE             HALF WORD TABLE(0:4000)
                                        12         SYMREF  HASHTBL          HALF WORD TABLE(0:808)
             000000000001               13  P1     EQU     1                 PARM1 IN PR1
             000000000003               14  P2     EQU     3                 PARM2 IN PR3
             000000000004               15  P3     EQU     4                 PARM3 IN PR4
             000000000001               16  PR     BOOL    1                 PR modification
             000000000001               17  RL     BOOL    1                 RL (register length) modification
             000000000001               18  X1     EQU     1
                                        19  *
                                        20  *  CALL SHIFT_ARRAY(FROMSTR,TOSTR,LEN);
                                        21  *  DCL FROMSTR BASED(FROMPTR$) CHAR(1000);
                                        22  *  DCL TOSTR   BASED(TOPTR$)   CHAR(1000);
                                        23  *  DCL LEN     UBIN WORD;
                                        24  *
 0 000000                               25  SHIFT_ARRAY NULL
   000000  X 000000 7000 00             26         TSX0    X66_PREGS_3
   000001    000000 000003              27         ZERO    0,3               3 PARAMETERS
   000002    4 00000 2361 00            28         LDQ     0,,P3             GET LEN
   000003    000 0 140 1015 40          29         MRL     (PR,RL),(PR,RL),0
   000004    1 00000 0 0 0 0006         30         ADSC9   0,0,Q,P1
   000005    3 00000 0 0 0 0006         31         ADSC9   0,0,Q,P2
   000006    000001 7100 11             32         TRA     1,X1              *** RETURN ***
                                        33  *
                                        34  *     INIT_TABLES  INITILIZES  TYPE AND HASHTBL TABLES TO -1
                                        35  *
   000007    777777777777               36  MINUS1 DEC    -1
                                        37  *
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI                                                                   2    BMAP - B00     
   000010                               38  INIT_TABLES NULL
   000010    017510 2230 03             39        LDX     X3,8008,DU          SIZE OF TYPE TABLE 4004 HALF WORDS
   000011    777 0 040 1004 00          40        MLR     ,(,1),777           LEN IN X3 AND FILL WITH '777'O
   000012 (0)000007 0 0 0 0001          41        ADSC9   MINUS1,,1
   000013  X 000000 0 0 0 0013          42        ADSC9   TYPE,,X3
   000014    777 0 000 1004 00          43        MLR     ,,777
   000015 (0)000007 0 0 0 0001          44        ADSC9   MINUS1,,1
   000016  X 000000 0 0 0 1750          45        ADSC9   HASHTBL,,1000       SIZE OF HASH TBL(0:499) HALF
   000017    000001 7100 11             46        TRA     1,X1

 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               3    BMAP - B00     
                                        47        TTL     B$CHKREC CALLED BY ZIU$CHECK
                                        48  *
                                        49  *     HARDWIRED TO THE STRUCTURES MSTR_REF.NEXT, MSTR_REF.GLOBAL
                                        50  *             AND SET_XREF.  BE CAREFUL WHEN CHANGED.
                                        51  *
                                        52        ENTDEF  B$CHKREC
                                        53        ENTDEF  B$CHKPAGE
                                        54
                                        55        SYMREF  REC$
                                        56        SYMREF  DATA$               ADDR OF DATA PAGE
                                        57        SYMREF  MSTR$
                                        58        SYMREF  SET_XREF$
                                        59
                                        60        SYMREF  SETCNT            COUNTERS
                                        61        SYMREF  CURR_DBK
                                        62        SYMREF  LOCAL_DBK
                                        63        SYMREF  NO_RECS
                                        64        SYMREF  GROUP$              SET TO REC$ IF REC IS A *PA_REC
                                        65        SYMREF  ENTRY$              SET TO THE 1ST ENTRY IN RECORD
                                        66        SYMREF  PTR_LEN             SET TO THE SIZE OF PTR WHEN RETURN
                                        67        SYMREF  KEY_LEN             SET TO THE KEY SIZE IN ENTRY
                                        68        SYMREF  X                   X = INDEX OF I_O_BUF(X)
                                        69        SYMREF  BUF_PTR
                                        70        SYMREF  I_O_BUF$
                                        71        SYMREF  CURR_OFFSET         WORD ALIGNED
                                        72        SYMREF  FIRST_LOWEST        SET TO 1 IF PA_FIL AND PA_LOWEST
                                        73        SYMREF  NO_ENT              NO OF ENTRIES IN PA_REC
                                        74        SYMREF  REC_HEADER          SBIN WORD CONTAINING RECORD HEADER WORD
                                        75        SYMREF  LPP                 LINE PER PAGE
                                        76        SYMREF  I                   LINE NUMBER + 1
                                        77        SYMREF  LOW_DBK             1ST DBK IN THE AREA
                                        78        SYMREF  MSTR_INDX
                                        79        SYMREF  SET_NUM
                                        80        SYMREF  PRIVAL
                                        81        SYMREF  NXTVAL
                                        82        SYMREF  SP_AVAIL            SPACE AVAIL FOR A PAGE
                                        83        SYMREF  OFST_AYSZ           OFFSET ARRAY SIZE
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               4    BMAP - B00     
             000000000003               84  PR3   EQU     3         SCRATCH POINTER REGISTER
             000000000005               85  PR5   EQU     5         FIX $PR5 = SET_XREF$
             000000000006               86  PR6   EQU     6         FIX $PR6 = MSTR$
             000000000007               87  PR7   EQU     7         FIX $PR7 = REC$
             000000000002               88  X2    EQU     2
             000000000003               89  X3    EQU     3
             000000000004               90  X4    EQU     4
             000000000005               91  X5    EQU     5
             000000000006               92  X6    EQU     6
             000000000007               93  X7    EQU     7
                                        94  *
                                        95  *     ENTDEF   B$CHKPAGE     INIT VALUES FOR A PAGE CALLED BY CHECK
                                        96  *
   000020                               97  B$CHKPAGE NULL
   000020  X 000000 2360 00             98        LDQ     X                   CHK IF THIS IS 1ST PAGE IN A BLOCK
   000021 (0)000024 6010 00             99        TNZ     *+3                 NO - NO NEED OF LOAD PR5 AND PR6
   000022  X 000000 4754 00            100        LDP     PR5,SET_XREF$       YES - HAVE TO RELOAD THEM
   000023  X 000000 4764 00            101        LDP     PR6,MSTR$           FOR IT JUST DID A SYS_FUNC_READ
   000024  X 000000 0360 00            102        ADLQ    BUF_PTR             ADD TO BEGINING BUF INDEX
   000025    000034 7360 00            103        QLS     28                  CONV TO WORD OFFSET AND PUT IN QU
   000026  X 000000 0360 00            104        ADLQ    I_O_BUF$            ADD TO THE BASE OF BUFFER
   000027  X 000000 7560 00            105        STQ     DATA$               AND MAKE OUT THE DATA$
   000030  X 000000 4774 00            106        LDP     PR7,DATA$           LOAD PAGE BUFFER ADDRESS
   000031    7 00004 2361 00           107        LDQ     4,,PR7              LOAD PAGE NUMBER
   000032    000001 1360 07            108        SBLQ    1,DL                SUBTRACT 1
   000033  X 000000 4020 00            109        MPY     LPP                 ($Q = (PAGE#-1)*LPP)
   000034 (2)000000 7560 00            110        STQ     PAGENO              SAVE IT THERE
   000035    7 00003 2361 00           111        LDQ     3,,PR7              LOAD DATA_PG.PG_SZ.SEC
   000036    777777 3760 07            112        ANQ     -1,DL               ISOLATE
   000037  X 000000 7560 00            113        STQ     SP_AVAIL            SPACE AVAIL IN THE PAGE
   000040    7 00005 2361 00           114        LDQ     5,,PR7              LOAD DATA_PG.OFF_LN.SEC
   000041    777777 3760 07            115        ANQ     -1,DL               ISOLATE
   000042    000001 0360 07            116        ADLQ    1,DL
   000043    000001 7360 00            117        QLS     1                  (CURR_HIGH_LINE+1)*2
   000044  X 000000 7560 00            118        STQ     OFST_AYSZ           OFFSET ARRAY SIZE
   000045    7 00006 2361 00           119        LDQ     6,,PR7              LOAD RECORD HEADER FOR 1ST RECORD
   000046  X 000000 7560 00            120        STQ     REC_HEADER
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               5    BMAP - B00     
   000047    7 00006 5005 00           121        A9BD    6,,PR7              REC$=PINCRC(DATA$,24)
   000050    000001 7100 11            122        TRA     1,X1                RETURN
                                       123  **
                                       124  **    EXPECTED STURCTURES
                                       125  **
                                       126  *     DCL 1 SETCNT(0:?) ALIGNED STATIC SYMDEF,
                                       127  *           2 PR  UBIN  ALIGNED,
                                       128  *           2 NXT UBIN  ALIGNED,
                                       129  *           2 DBK UBIN  ALIGNED;
                                       130  *
                                       131  *     DCL 1 SET_XREF(0:0) BASED(SET_XREF$) ALIGNED,
                                       132  *           2 MSTRINDX SBIN HALF HALIGNED,
                                       133  *           2 NEXT     SBIN HALF HALIGNED,
                                       134  *           2 PRIOR_EIS SBIN ALIGNED,
                                       135  *           2 OWNER_EIS SBIN ALIGNED,
                                       136  *           2 NEXT_EIS SBIN ALIGNED;
                                       137  *
                                       138  *     DCL 1 MSTR_REF(0:0) BASED(MSTR$) ALIGNED,
                                       139  *           2 TYPE SBIN HALF HALIGNED,
                                       140  *           2 NEXT SBIN HALF HALIGNED,
                                       141  *           2 * CHAR(32)     ALIGNED, /* NOT USED HERE */
                                       142  *           2 GLOBAL UBIN BYTE CALIGNED,
                                       143  *           2 *  UBIN(3) UNAL,  /* UNUSED */
                                       144  *           2 PAENT UBIN(24) UNAL; /* PA ENTRY SIZE IF *PA_REC */
                                       145  *           EACH ELEMENT OF MSTR_REF IS 10 WORDS LONG (HARDWIRED)
                                       146  *
   000051                              147  B$CHKREC  NULL
                                       148
   000051 (2)000000 2360 00            149        LDQ     PAGENO              LOAD (PAGE NUMBER-1)*LPP
   000052  X 000000 0360 00            150        ADLQ    I                   ADD LINE NUMBER+1
   000053  X 000000 7560 00            151        STQ     LOCAL_DBK           LOCAL_DBK=(PAGE#-1)*LPP+LINE#+1
   000054  X 000000 0360 00            152        ADLQ    LOW_DBK             ADD LOW DBK OF AREA
   000055    000001 1360 07            153        SBLQ    1,DL                GLOBAL_DBK=LOCAL_DBK+LOW_DBK-1
   000056  X 000000 7560 00            154        STQ     CURR_DBK
   000057    000012 2360 07            155        LDQ     =10,DL              CONVERT MSTR_INDX TO WORD INDEX
   000060  X 000000 4020 00            156        MPY     MSTR_INDX
   000061    000000 6260 06            157        EAX     X6,0,QL             FIX  X6=MSTR_INDX FOR THE RECORD
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               6    BMAP - B00     
   000062    6 00000 7221 06           158        LXL     X2,,QL,PR6          LOAD MSTR_REF.NEXT(MSTR_INDX)
   000063 (0)000125 6040 00            159        TMI     SETDONE             IF RECORD IN NO SET, READY TO RETURN
   000064                              160  NEXTRS NULL                       LOOP THRU SET_XREF.NEXT UNTIL -1
   000064    000000 6350 12            161        EAA     0,X2
   000065    000002 7350 00            162        ALS     2                   AU = SET_INDX (IN WORDS)
   000066    000000 6230 01            163        EAX     X3,0,AU            SAVE IN $X3
   000067    5 00000 2361 13           164        LDQ     0,X3,PR5            LOAD SET_XREF.MSTRINDX
   000070    000022 7720 00            165        QRL     18                  SHIFT TO LOWER HALF WORD
   000071  X 000000 7560 00            166        STQ     SET_NUM             SAVE FOR A WHILE
   000072 (1)000000 4020 00            167        MPY     =10                 CHANGE TO WORD INDX
   000073    000000 6270 06            168        EAX     X7,0,QL             SAVE  IN  $X7
   000074  X 000000 2360 00            169        LDQ     SET_NUM
   000075  X 000000 1360 00            170        SBLQ    NO_RECS             $Q = SET_NUM (INTO SETCNT TABLE)
   000076 (1)000001 4020 00            171        MPY     =3                  EACH ELEMENT IN SETCNT IS 3 WORDS
   000077    000000 6250 06            172        EAX     X5,0,QL             SAVE IN $X5
                                       173  *
                                       174  *     X3 = INDEX INTO SET_XREF TABLE BY WORDS
                                       175  *     X5 = INDEX INTO SETCNT TABLE BY WORDS
                                       176  *     X6 = INDX INTO MSTR_REF TABLE BY WORDS FOR THE RECORD
                                       177  *     X7 = INDEX INTO MSTR_REF TABLE BY WORDS FOR THE SET
                                       178  *
   000100    000 1 000 1015 20         179        MRL     (1,,1),,000,1       MOVE NEXT PTR
   000101    5 00003 0001 13           180        ARG     3,X3,PR5            EIS IN SET_XREF.NEXT
   000102  X 000000 0 0 0 0004         181        ADSC9   NXTVAL,0,4          FROM RIGHT TO LEFT WITH 0 FILLED
   000103  X 000000 2360 00            182        LDQ     NXTVAL
   000104  X 000001 0560 15            183        ASQ     SETCNT+1,X5         ADD TO SETCNT.NEXT
   000105    5 00001 2341 13           184        SZN     1,X3,PR5            CHECK SET_XREF.PRIOR
   000106 (0)000113 6000 00            185        TZE     ADDPRI              USE $Q TO ADD TO PRI ($Q NOT CHANGED)
                                       186  *     PRIOR POINTER EXISTS, LOAD IT (NON PA MEMBERS)
   000107    000 1 000 1015 20         187        MRL     (1,,1),,000,1       LOAD PRIOR POINTER
   000110    5 00001 0001 13           188        ARG     1,X3,PR5
   000111  X 000000 0 0 0 0004         189        ADSC9   PRIVAL,0,4
   000112  X 000000 2360 00            190        LDQ     PRIVAL
   000113                              191  ADDPRI  NULL
   000113  X 000000 0560 15            192        ASQ     SETCNT,X5           ADD TO SETCNT.PRIOR
                                       193  *     NOW UPDATE SETCNT.DBK COUNTER
   000114    6 00011 2361 17           194        LDQ     9,X7,PR6            LOAD MSTR_REF.GLOBAL
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               7    BMAP - B00     
   000115    000033 7720 00            195        QRL     27                  CHECK FIRST BYTE
   000116 (0)000121 6010 00            196        TNZ     GLOBAL              SET IS GLOBAL
   000117  X 000000 2360 00            197        LDQ     LOCAL_DBK
   000120 (0)000122 7100 00            198        TRA     ADDDBK              GOTO ADD SETCNT.DBK COUNTER
   000121                              199  GLOBAL NULL
   000121  X 000000 2360 00            200        LDQ     CURR_DBK            USE GLOBAL DBKEY
   000122                              201  ADDDBK NULL
   000122  X 000002 0560 15            202        ASQ     SETCNT+2,X5         ADD TO SETCNT.DBK
   000123    5 00000 7221 13           203        LXL     X2,0,X3,PR5         LOAD SET_XREF.NEXT
   000124 (0)000064 6050 00            204        TPL     NEXTRS              IF >= 0 GOTO PROCESS NEXT RS
                                       205  *     ALL SETS THRU THIS RECORD PROCESSED
   000125                              206  SETDONE NULL
   000125  X 000000 4500 00            207        STZ     KEY_LEN             SET RECORD NOT PA FLAG
   000126    6 00011 2351 16           208        LDA     9,X6,PR6            LOAD MSTR_REF.PAOFF
   000127    000033 7710 00            209        ARL     27                  ISOLATE
   000130 (0)000175 6000 00            210        TZE     NOTPA               PAOFF=0 -> NOT PA RECORD
   000131  X 000000 4574 00            211        STP     PR7,REC$            (SETUP FOR PROCESS PAREC)
   000132  X 000000 4734 00            212        LDP     PR3,REC$
   000133    3 00000 5005 05           213        A9BD    ,AL,PR3             $PR3 = ADDR OF 1ST ENTRY IN PA_REC
   000134  X 000000 4534 00            214        STP     PR3,ENTRY$          (SETUP FOR PROCESS PAREC)
   000135  X 000000 2350 00            215        LDA     SET_NUM
   000136  X 000000 1350 00            216        SBLA    NO_RECS
   000137  X 000000 7550 00            217        STA     SET_NUM             PL6 INDEX INTO SETCNT (SETUP FOR PA)
   000140    6 00011 2351 17           218        LDA     9,X7,PR6            LOAD MSTR_REF.GLOBAL
   000141    000033 7710 00            219        ARL     27                  ISOLATE
   000142 (0)000145 6010 00            220        TNZ     *+3                 IF SET IS LOCAL
   000143  X 000000 2350 00            221        LDA     LOCAL_DBK           USE LOCAL_DBK AS CURR_DBK
   000144  X 000000 7550 00            222        STA     CURR_DBK            (SETUP FOR PROCESS PAREC)
   000145    5 00003 2351 13           223        LDA     3,X3,PR5            LOAD EIS FROM SET_XREF.NEXT
   000146    000007 3750 07            224        ANA     =O7,DL              ISOLATE SIZE
   000147  X 000000 7550 00            225        STA     PTR_LEN             (SETUP FOR PROCESS PAREC)
   000150    6 00011 2351 16           226        LDA     9,X6,PR6            LOAD MSTR_REF.PAENT
   000151 (1)000002 3750 00            227        ANA     =O000077777777      ISOLATE
   000152    000002 1350 07            228        SBLA    2,DL                PAENT=2 BYTES FOR TYPE+PTR_LEN+KEY_LEN
   000153  X 000000 1350 00            229        SBLA    PTR_LEN
   000154  X 000000 7550 00            230        STA     KEY_LEN             (SETUP KEY_LEN FOR PA)
   000155    000 1 000 1015 20         231        MRL     (1,,1),,000,1       MOVE OWNER PTR TO
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               8    BMAP - B00     
   000156    5 00002 0001 13           232        ARG     2,X3,PR5
   000157  X 000000 0 0 0 0004         233        ADSC9   PRIVAL,0,4          PRIVAL (SETUP FOR PA)
   000160    000 1 000 1005 00         234        MLR     (1),,,1             MOVE PA FLAGS TO TEMP LOCATION
   000161    7 00001 0 0 0 0002        235        ADSC9   1,,2,PR7
   000162  X 000000 0 0 0 0002         236        ADSC9   FIRST_LOWEST,,2
   000163  X 000000 2350 00            237        LDA     FIRST_LOWEST
   000164    000036 7730 00            238        LRL     30                  $A HAS 6 BITS OF PA_REC FLAGS
   000165    000003 7710 00            239        ARL     3
   000166    000005 3750 07            240        ANA     =5,DL
   000167    000001 1150 07            241        CMPA    1,DL                IS PAFIL YES AND NOT_LOWEST NO?
   000170 (0)000172 6000 00            242        TZE     *+2                 YES
   000171    000000 2350 07            243        LDA     0,DL                NO - DONT SET FLAG
   000172  X 000000 7550 00            244        STA     FIRST_LOWEST        (SETUP FOR PA PROCESSING)
   000173    000030 7720 00            245        QRL     24                  $Q HAS THE NO OF ENTRIES IN *PA_REC
   000174  X 000000 7560 00            246        STQ     NO_ENT              (SETUP FOR PA PROCESSING)
   000175                              247  NOTPA NULL
   000175  X 000000 2360 00            248        LDQ     REC_HEADER
   000176    777777 3760 07            249        ANQ     -1,DL               GET REC_HEADER.LENGTH
   000177    7 00000 5005 06           250        A9BD    ,QL,PR7             REC$=PINCRC(REC$,REC.LEN)
   000200  X 000000 0560 00            251        ASQ     CURR_OFFSET         UPDATE NEW OFFSET
   000201    000 1 000 1005 00         252        MLR     (1),,,1             MOVE RECORD HEADER OF NEXT RECORD
   000202    7 00000 0 0 0 0004        253        ADSC9   0,,4,PR7            FROM PAGE BUFFER
   000203  X 000000 0 0 0 0004         254        ADSC9   REC_HEADER,,4       TO STATIC PROCESSING AREA
   000204    000001 7100 11            255        TRA     1,X1                RETURN
                                       256  *
                                       257  *     SUBR   GETSEGSIZ: RETURN SIZE OF SEGMENT IN BYTES
                                       258  *
                                       259  *     INPUT:  REC$ - BASE POINTER OF A SEGMENT
                                       260  *     OUTPUT: X - SIZE OF SEGMENT IN BYTES
                                       261  *
   000205                              262  GETSEGSIZ NULL
   000205  X 000000 4714 00            263        LDP     P1,REC$
   000206 (2)000000 0514 00            264        STD     P1,PAGENO
   000207 (2)000000 2350 00            265        LDA     PAGENO
   000210    000020 7310 00            266        ARS     16
   000211    000001 0350 07            267        ADLA    1,DL
   000212  X 000000 7550 00            268        STA     X
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               9    BMAP - B00     
   000213    000001 7100 11            269        TRA     1,X1
                                       270         ENTDEF  FLOAT
                                       271         ENTDEF  FIX
                                       272         ENTDEF  FLOAT_ADD
                                       273         ENTDEF  FLOAT_SUB
                                       274         ENTDEF  FLOAT_MPY
                                       275         ENTDEF  FLOAT_DIV
             000000000000              276  X0     EQU     0
                                       277  *
                                       278  *  CONSTANTS:
                                       279  *
                                       280           EVEN
   000214    024040000000              281  TWOTO36   OCT   024040000000,000000000000
   000215    000000000000
   000216    777777777777              282  MAXUBIN   OCT   777777777777
                                       283  *
                                       284  *  CALL FLOAT(INTARG,FLOATARG) NOALTRET
                                       285  *  INPUT:  INTARG - UBIN number
                                       286  *  OUTPUT: FLOATARG - real number
                                       287  *
   000217                              288  FLOAT  NULL
   000217  X 000000 7000 00            289         TSX0    X66_PREGS_3       SET UP PARAMETER PTR
   000220    000000 000002             290         ZERO    0,2               2 PARAMETERS
   000221    022100 4310 03            291         FLD     =O022100,DU       LOAD EXP
   000222    1 00000 2351 00           292         LDA     0,,P1             GET INTEGER TO A REGISTER
   000223    000001 7730 00            293         LRL     1                 LONG RIGHT LOGICAL
   000224    400000 4750 03            294         FAD     =O400000,DU       FLOAT NORMALIZED
   000225    3 00000 4701 00           295         FSTR    0,,P2             RESULT
   000226    000001 7100 11            296         TRA     1,X1              NORMAL RETURN
                                       297  *
                                       298  *  CALL FIX(FLOATARG1,INTARG1)
                                       299  *  INPUT:  FLOATARG1 - real number
                                       300  *  OUTPUT: INTARG1 - Integer number
                                       301  *
   000227                              302  FIX    NULL
   000227  X 000000 7000 00            303         TSX0   X66_PREGS_3        SET UP PARAMETERS PTR
   000230    000000 000002             304         ZERO   0,2                2 PARAMETERS
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               10   BMAP - B00     
   000231    1 00000 4311 00           305         FLD    0,,P1              CONVERT TO DOUBLE REAL
   000232    1 00000 4571 00           306         DFST   0,,P1
   000233                              307  REAL_UBIN     NULL
   000233    1 00000 2351 00           308         LDA    0,,P1              GET THE FIRST WORD
   000234 (0)000237 6054 00            309         TPNZ   CONT_UBIN          <=0 IMPLIES < .5
   000235    000000 2360 07            310         LDQ    0,DL               <.5 MEANS RESULT IS 0
   000236 (0)000247 7100 00            311         TRA    STR_U
   000237                              312  CONT_UBIN     NULL
   000237    1 00000 4331 00           313         DFLD   0,,P1              GET THE DOUBLE FLOATER
   000240 (0)000321 6040 00            314         TMI    LOST_SIGN          TRANSFER MINUS
   000241    400000 4750 03            315         FAD    =O400000,DU        MAKE SURE ITS NORMALIZED
   000242 (0)000214 5170 00            316         DFCMP  TWOTO36            MAKE SURE IT WILL FIT SBIN
   000243 (0)000251 6050 00            317         TPL    OV_FL              NOPE, OVERFLOW
   000244    042000 4350 03            318         UFA    =O042000,DU        UNNORMALIZED
   000245    000004 0360 07            319         ADLQ   4,DL               ROUND
   000246    000003 7320 00            320         QRS    3                  Q RIGHT SHIFT
   000247    3 00000 7561 00           321  STR_U  STQ    0,,P2              RESULT
   000250    000001 7100 11            322         TRA    1,X1               RETURN
   000251                              323  OV_FL  NULL
   000251 (0)000216 2360 00            324         LDQ    MAXUBIN            SET TO MAX
   000252    3 00000 7561 00           325         STQ    0,,P2
   000253 (0)000315 7100 00            326         TRA    OVERFLOW
                                       327  *
                                       328  *   CALL FLOAT_ADD(ADD1,ADD2,ADD_RSLT)
                                       329  *   INPUT:   ADD1,ADD2   (These are all real numbers)
                                       330  *   OUTPUT:  ADD_RSLT    (Real number)
                                       331  *
   000254                              332  FLOAT_ADD     NULL
   000254  X 000000 7000 00            333         TSX0   X66_PREGS_3        SET UP PARAMETER PTR
   000255    000000 000003             334         ZERO   0,3                3 PARAMETERS
   000256    1 00000 4311 00           335         FLD    0,,P1              LOAD ADD1
   000257    3 00000 4751 00           336         FAD    0,,P2              ADD ADD2 TO ADD1
   000260    4 00000 4551 00           337         FST    0,,P3              RESULT
   000261 (0)000315 6170 00            338         TOV    OVERFLOW           CHECK OVERFLOW
   000262 (0)000315 6140 00            339         TEO    OVERFLOW           TRANSFER ON EXPONENT OVERFLOW
   000263    000001 7100 11            340         TRA    1,X1
                                       341  *
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               11   BMAP - B00     
                                       342  *   CALL FLOAT_SUB (SUB1,SUB2,SUB_RSLT)
                                       343  *   INPUT:   SUB1,SUB2  (All real numbers)
                                       344  *   OUTPUT:  SUB_RSLT     (Real number)
                                       345  *
   000264                              346  FLOAT_SUB     NULL
   000264  X 000000 7000 00            347         TSX0   X66_PREGS_3        SET UP PARAMETER PTR
   000265    000000 000003             348         ZERO   0,3                3 PARAMETERS
   000266    1 00000 4311 00           349         FLD    0,,P1              LOAD SUB1
   000267    3 00000 5751 00           350         FSB    0,,P2              SUBTRACT SUB2
   000270    4 00000 4551 00           351         FST    0,,P3              RESULT
   000271 (0)000317 6150 00            352         TEU    UNDERFLOW          CHECK UNDERFLOW
   000272    000001 7100 11            353         TRA    1,X1               RETURN
                                       354  *
                                       355  *   CALL FLOAT_MPY (MPY1,MPY2,MPY_RSLT)
                                       356  *   INPUT:   MPY1,MPY2   (All real numbers)
                                       357  *   OUTPUT:  MPY_RSLT     (real number)
                                       358  *
   000273                              359  FLOAT_MPY     NULL
   000273  X 000000 7000 00            360         TSX0   X66_PREGS_3        SET UP PARAMETER PTR
   000274    000000 000003             361         ZERO   0,3                3 PARAMETERS
   000275    1 00000 4311 00           362         FLD    0,,P1              LOAD MPY1
   000276    3 00000 4611 00           363         FMP    0,,P2              MULTIPLY BY MPY2
   000277    4 00000 4551 00           364         FST    0,,P3              RESULT
   000300 (0)000315 6170 00            365         TOV    OVERFLOW           CHECK OVERFLOW
   000301 (0)000315 6140 00            366         TEO    OVERFLOW           TRANSFER ON EXPONENT OVERFLOW
   000302 (0)000317 6150 00            367         TEU    UNDERFLOW          CHECK UNDERFLOW
   000303    000001 7100 11            368         TRA    1,X1               RETURN
                                       369  *
                                       370  *   CALL FLOAT_DIV (DIV1,DIV2,DIV_RSLT)
                                       371  *   INPUT:   DIV1,DIV2      (All real numbers)
                                       372  *   OUTPUT:  DIV_RSLT       (real number)
                                       373  *
   000304                              374  FLOAT_DIV     NULL
   000304  X 000000 7000 00            375         TSX0   X66_PREGS_3        SET UP PARAMETER PTR
   000305    000000 000003             376         ZERO   0,3                3 PARAMETERS
   000306    1 00000 4311 00           377         FLD    0,,P1              LOAD DIV1
   000307    3 00000 5651 00           378         FDV    0,,P2              DIVIDE BY DIV2
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               12   BMAP - B00     
   000310    4 00000 4551 00           379         FST    0,,P3              RESULT
   000311 (0)000315 6170 00            380         TOV    OVERFLOW           CHECK OVERFLOW
   000312 (0)000315 6140 00            381         TEO    OVERFLOW           TRANSFER ON EXPONENT OVERFLOW
   000313 (0)000317 6150 00            382         TEU    UNDERFLOW          UNDERFLOW
   000314    000001 7100 11            383         TRA    1,X1               RETURN
                                       384  *
                                       385  *   ERRORS FROM NON LIBRARY ROUTINES
                                       386  *
   000315                              387  OVERFLOW      NULL
   000315    000001 2200 03            388         LDX0   1,DU               SET OVERFLOW CODE
   000316    000000 7100 11            389         TRA    0,X1               ALTRETURN
   000317                              390  UNDERFLOW     NULL
   000317    000002 2200 03            391         LDX0   2,DU               SET UNDERFLOW CODE
   000320    000000 7100 11            392         TRA    0,X1               ALTRETURN
   000321                              393  LOST_SIGN     NULL
   000321    000003 2200 03            394         LDX0   3,DU               SET LOST SIGN CODE
   000322    000001 7100 11            395         TRA    1,X1               RETURN
                                       396  *
                                       397  *    CALL SHIFT_NUMERIC_FDEC (FROMNUM, TONUM, LEN);
                                       398  *
                                       399  *
                                       400      ENTDEF SHIFT_NUMERIC_FDEC
                                       401  *
   000323                              402  SHIFT_NUMERIC_FDEC NULL
   000323  X 000000 7000 00            403      TSX0      X66_PREGS_3
   000324    000000 000003             404      ZERO      0,3
   000325    4 00000 2361 00           405      LDQ       0,,P3     Three arguments,... do setup
   000326    0 000 0 0 140 3005 40     406      MVN       (PR,RL,),(PR,RL),0  Move floating decimal
   000327    1 00000 0 1 0 00 06       407      NDSC4     0,0,Q,0,0,P1
   000330    3 00000 0 1 0 00 06       408      NDSC4     0,0,Q,0,0,P2
   000331    000001 7100 11            409      TRA       1,X1
                                       410
                                       411  *
                                       412  *    CALL SHIFT_NUMERIC_LSIGN (FROMNUM, TONUM, LEN);
                                       413  *
                                       414  *
                                       415      ENTDEF SHIFT_NUMERIC_LSIGN
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               13   BMAP - B00     
                                       416  *
   000332                              417  SHIFT_NUMERIC_LSIGN NULL
   000332  X 000000 7000 00            418      TSX0      X66_PREGS_3
   000333    000000 000003             419      ZERO      0,3
   000334    4 00000 2361 00           420      LDQ       0,,P3     Three arguments,... do setup
   000335    0 000 0 0 140 3005 40     421      MVN       (PR,RL,),(PR,RL),0  Move signed leading
   000336    1 00000 0 1 1 00 06       422      NDSC4     0,0,Q,1,0,P1
   000337    3 00000 0 1 1 00 06       423      NDSC4     0,0,Q,1,0,P2
   000340    000001 7100 11            424      TRA       1,X1
                                       425  *
                                       426  *    CALL SHIFT_NUMERIC_TSIGN (FROMNUM, TONUM, LEN);
                                       427  *
                                       428  *
                                       429      ENTDEF SHIFT_NUMERIC_TSIGN
                                       430  *
   000341                              431  SHIFT_NUMERIC_TSIGN NULL
   000341  X 000000 7000 00            432      TSX0      X66_PREGS_3
   000342    000000 000003             433      ZERO      0,3
   000343    4 00000 2361 00           434      LDQ       0,,P3     Three arguments,... do setup
   000344    0 000 0 0 140 3005 40     435      MVN       (PR,RL,),(PR,RL),0  Move signed trailing
   000345    1 00000 0 1 2 00 06       436      NDSC4     0,0,Q,2,0,P1
   000346    3 00000 0 1 2 00 06       437      NDSC4     0,0,Q,2,0,P2
   000347    000001 7100 11            438      TRA       1,X1
                                       439
                                       440  *
                                       441  *    CALL SHIFT_NUMERIC_NSIGN (FROMNUM, TONUM, LEN);
                                       442  *
                                       443  *
                                       444      ENTDEF SHIFT_NUMERIC_NSIGN
                                       445  *
   000350                              446  SHIFT_NUMERIC_NSIGN NULL
   000350  X 000000 7000 00            447      TSX0      X66_PREGS_3
   000351    000000 000003             448      ZERO      0,3
   000352    4 00000 2361 00           449      LDQ       0,,P3     Three arguments,... do setup
   000353    0 000 0 0 140 3005 40     450      MVN       (PR,RL,),(PR,RL),0  Move unsigned
   000354    1 00000 0 1 3 00 06       451      NDSC4     0,0,Q,3,0,P1
   000355    3 00000 0 1 3 00 06       452      NDSC4     0,0,Q,3,0,P2
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        B$CHKREC CALLED BY ZIU$CHECK                               14   BMAP - B00     
   000356    000001 7100 11            453      TRA       1,X1
                                       454
 2 000000                              455        USE     ZIU$MRL_DATA,0
                                       456        EVEN
   000000                              457  PAGENO BSS    2
                                       458         END
 1 000000    000000000012
   000001    000000000003
   000002    000077777777

  CONTROL SECTION TABLE

   0 CODE   EVEN  000357
   1 RODATA EVEN  000003 LITERALS
   2 DATA   EVEN  000002 ZIU$MRL_DATA

 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        SYMBOL TABLE                                               15   BMAP - B00     
 01101000 000000000122 ADDDBK         198      *201
 01101000 000000000113 ADDPRI         185      *191
 12101000 000000000020 B$CHKPAGE       53       *97
 12101000 000000000051 B$CHKREC        52      *147
 03301015 000000000000 BUF_PTR        *69       102
 01101000 000000000237 CONT_UBIN      309      *312
 03301007 000000000000 CURR_DBK       *61       154       200       222
 03301017 000000000000 CURR_OFFSET    *71       251
 03301003 000000000000 DATA$          *56       105       106
 03301011 000000000000 ENTRY$         *65       214
 03301018 000000000000 FIRST_LOWEST   *72       236       237       244
 12101000 000000000227 FIX            271      *302
 12101000 000000000217 FLOAT          270      *288
 12101000 000000000254 FLOAT_ADD      272      *332
 12101000 000000000304 FLOAT_DIV      275      *374
 12101000 000000000273 FLOAT_MPY      274      *359
 12101000 000000000264 FLOAT_SUB      273      *346
 12101000 000000000205 GETSEGSIZ       10      *262
 01101000 000000000121 GLOBAL         196      *199
 02301010 000000000000 GROUP$         *64
 03301001 000000000000 HASHTBL        *12        45
 03301022 000000000000 I              *76       150
 12101000 000000000010 INIT_TABLES      8       *38
 03301016 000000000000 I_O_BUF$       *70       104
 03301013 000000000000 KEY_LEN        *67       207       230
 03301008 000000000000 LOCAL_DBK      *62       151       197       221
 01101000 000000000321 LOST_SIGN      314      *393
 03301023 000000000000 LOW_DBK        *77       152
 03301021 000000000000 LPP            *75       109
 01101000 000000000216 MAXUBIN       *282       324
 01101000 000000000007 MINUS1         *36        41        44
 03301004 000000000000 MSTR$          *57       101
 03301024 000000000000 MSTR_INDX      *78       156
 01101000 000000000064 NEXTRS        *160       204
 01101000 000000000175 NOTPA          210      *247
 03301019 000000000000 NO_ENT         *73       246
 03301009 000000000000 NO_RECS        *63       170       216
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        SYMBOL TABLE                                               16   BMAP - B00     
 03301027 000000000000 NXTVAL         *81       181       182
 03301029 000000000000 OFST_AYSZ      *83       118
 01101000 000000000315 OVERFLOW       326       338       339       365       366       380       381
                                     *387
 01101000 000000000251 OV_FL          317      *323
 41000000 000000000001 P1             *13        30       263       264       292       305       306
                                      308       313       335       349       362       377       407
                                      422       436       451
 41000000 000000000003 P2             *14        31       295       321       325       336       350
                                      363       378       408       423       437       452
 41000000 000000000004 P3             *15        28       337       351       364       379       405
                                      420       434       449
 01101002 000000000000 PAGENO         110       149       264       265      *457
 41000000 000000000001 PR             *16        29       406       421       435       450
 41000000 000000000003 PR3            *84       212       213       214
 41000000 000000000005 PR5            *85       100       164       180       184       188       203
                                      223       232
 41000000 000000000006 PR6            *86       101       158       194       208       218       226
 41000000 000000000007 PR7            *87       106       107       111       114       119       121
                                      211       235       250       253
 03301026 000000000000 PRIVAL         *80       189       190       233
 03301012 000000000000 PTR_LEN        *66       225       229
 00101000 000000000233 REAL_UBIN     *307
 03301002 000000000000 REC$           *55       211       212       263
 03301020 000000000000 REC_HEADER     *74       120       248       254
 41000000 000000000001 RL             *17        29       406       421       435       450
 03301006 000000000000 SETCNT         *60       183       192       202
 01101000 000000000125 SETDONE        159      *206
 03301025 000000000000 SET_NUM        *79       166       169       215       217
 03301005 000000000000 SET_XREF$      *58       100
 12101000 000000000000 SHIFT_ARRAY      7       *25
 12101000 000000000323 SHIFT_NUMERIC_FDEC       400      *402
 12101000 000000000332 SHIFT_NUMERIC_LSIGN      415      *417
 12101000 000000000350 SHIFT_NUMERIC_NSIGN      444      *446
 12101000 000000000341 SHIFT_NUMERIC_TSIGN      429      *431
 03301028 000000000000 SP_AVAIL       *82       113
 01101000 000000000247 STR_U          311      *321
 13:18 09/05/97  FILE=ZIU$MRL.:ZIC0TSI        SYMBOL TABLE                                               17   BMAP - B00     
 01101000 000000000214 TWOTO36       *281       316
 03301000 000000000000 TYPE           *11        42
 01101000 000000000317 UNDERFLOW      352       367       382      *390
 03301014 000000000000 X              *68        98       268
 40000000 000000000000 X0            *276
 40000000 000000000001 X1             *18
 41000000 000000000002 X2             *88       158       203
 41000000 000000000003 X3              39       *89       163
 40000000 000000000004 X4             *90
 41000000 000000000005 X5             *91       172
 41000000 000000000006 X6             *92       157
 03201000 000000000000 X66_PREGS_3     *9        26       289       303       333       347       360
                                      375       403       418       432       447
 41000000 000000000007 X7             *93       168

      80 SYMBOLS

       0 MACROS

    SYMBOL SPACE USED  1152 WORDS
     MACRO SPACE USED     0 WORDS
   INPUT RECORDS READ   916
 STATEMENTS PROCESSED   386
         ELAPSED TIME  0:03.56
             CPU TIME     3.24 SEC.
        ASSEMBLY RATE  7148 STATEMENTS/CPU MIN.

      NO ERRORS

