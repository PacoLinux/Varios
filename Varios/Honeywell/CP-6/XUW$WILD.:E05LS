VERSION E05

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:1    
        1        1        /*M* X$WILDFMT - Wildcard match and format routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
        8        8        X$WILDFMT: PROC(FPT_WILDCARD) ALTRET;
        9        9
       10       10
       11       11        /*********************************************************************
       12       12        *                                                                    *
       13       13        *   X$WILDFMT may be used to compare a wildcarded pattern string     *
       14       14        *   with an input string;  if they match, an output string is formed *
       15       15        *   using the pattern and input strings and an output tamplate.  The *
       16       16        *   wildcard character is variable but defaults to '?'.              *
       17       17        *                                                                    *
       18       18        *   On input, sequences of ? characters are treated as a single ?    *
       19       19        *   character.  E.g., ?? is equivalent to ?.                         *
       20       20        *                                                                    *
       21       21        *   On output, sequences of ? characters are treated as multiple     *
       22       22        *   ? characters.  E.g., ?? contains two wildcard strings.           *
       23       23        *                                                                    *
       24       24        *   Calling sequence:                                                *
       25       25        *                                                                    *
       26       26        *       CALL X$WILDFMT(FPT_WILDCARD) ALTRET(NO_MATCH);               *
       27       27        *                                                                    *
       28       28        *   The format of XUW_WILDCARD is available in XUW_MACRO_C.          *
       29       29        *                                                                    *
       30       30        *   The above structure may be generated by %INCLUDing file          *
       31       31        *   XUW_MACRO_C and invoking %XUW_WILDCARD.  Keywords are            *
       32       32        *   FPTN=name, STCLASS=class, PATTERN=pattern, INPUT=input,          *
       33       33        *   TEMPLATE=template, and OUTPUT=output.                            *
       34       34        *   FPTN defaults to XUW_WILDCARD, STCLASS to STATIC, and PATTERN,   *
       35       35        *   INPUT, TEMPLATE, and OUTPUT default to NIL.  ERROR.ERR# is       *
       36       36        *   always set to E$XUW#WILD_OK.                                     *
       37       37        *                                                                    *
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:2    
       38       38        *   XUW_WILDCARD.ERROR.ERR# will contain the result of the string    *
       39       39        *   match/format operation:  (these values are in XU_PERR_C)         *
       40       40        *                                                                    *
       41       41        *       %E$XUW#WILD_OK  - Pattern matches, output made.              *
       42       42        *       %E$XUW#PATNIL   - Pattern is nil or length=0.                *
       43       43        *       %E$XUW#INPNIL   - Input is nil or length=0.                  *
       44       44        *       %E$XUW#TMPNIL   - Template is nil or length=0.               *
       45       45        *       %E$XUW#OUTNIL   - Output is nil or length=0.                 *
       46       46        *       %E$XUW#NOMATCH  - Pattern does not match input.              *
       47       47        *       %E$XUW#PATLTIMP - Pattern has fewer ? than template does.    *
       48       48        *       %E$XUW#TOOLONG  - Output string exceeds available space.     *
       49       49        *                                                                    *
       50       50        *   XUW_WILDCARD.WILD_CHAR# defaults to '?', a CP-6 convention.      *
       51       51        *   XUW_WILDCARD.PATTERN_, XUW_WILDCARD.INPUT_,                      *
       52       52        *   XUW_WILDCARD.TEMPLATE_, and XUW_WILDCARD.OUTPUT_                 *
       53       53        *   frame the pattern, input, template, and output areas,            *
       54       54        *   respectively.  They are all CALIGNED TEXT fields.                *
       55       55        *                                                                    *
       56       56        *   The length of the pattern, input, template, and output           *
       57       57        *   strings may not exceed 511 bytes each and may not be zero.       *
       58       58        *                                                                    *
       59       59        *   On normal return, XUW_WILDCARD.ERROR.ERR# will be set to         *
       60       60        *   E$XUW#WILD_OK.  If X$WILDCMP ALTRETs, XUW_WILDCARD.ERROR.ERR#    *
       61       61        *   will be set to another value as described above (and             *
       62       62        *   the contents of the output string are unpredictable).            *
       63       63        *                                                                    *
       64       64        *   The pattern, input, and templates are never altered.             *
       65       65        *                                                                    *
       66       66        *   The length of the generated output string is returned in         *
       67       67        *   XUW_WILDCARD.OUTPUT_LEN.                                         *
       68       68        *                                                                    *
       69       69        *   CAUTION:  If the developed output string is zero-length,         *
       70       70        *   X$WILDFMT does NOT ALTRET.  The user is responsible for checking *
       71       71        *   the length of the output string.  For example, PATTERN='XX?',    *
       72       72        *   INPUT='XX', TEMPLATE='?', OUTPUT=''.                             *
       73       73        *                                                                    *
       74       74        *********************************************************************/
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:3    
       75       75
       76       76        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:4    
       77       77
       78       78        %INCLUDE XUW_MACRO_C;
       79      213        %INCLUDE XU_PERR_C;
       80      404
       81      405        %XUW_WILDCARD(FPTN = FPT_WILDCARD,STCLASS = " ");
       82      501
       83      502        /*  "WILD" is the pattern string. */
       84      503
       85      504    1   DCL W$                             PTR;
       86      505    1   DCL WLEN                           SBIN;
       87      506    1   DCL W                              SBIN;
       88      507    1   DCL 1 NAME_WILD BASED(W$) CALIGNED,
       89      508    1         2 NAME# UNAL                 CHAR(WLEN);
       90      509
       91      510        /*  "INP" is the input string. */
       92      511
       93      512    1   DCL N$                             PTR;
       94      513    1   DCL NLEN                           SBIN;
       95      514    1   DCL N                              SBIN;
       96      515    1   DCL 1 NAME_INP BASED(N$) CALIGNED,
       97      516    1         2 NAME# UNAL                 CHAR(NLEN);
       98      517
       99      518        /*  "DEST" is the template string. */
      100      519
      101      520    1   DCL D$                             PTR;
      102      521    1   DCL DLEN                           SBIN;
      103      522    1   DCL D                              SBIN;
      104      523    1   DCL 1 NAME_DEST BASED(D$) CALIGNED,
      105      524    1         2 NAME# UNAL                 CHAR(DLEN);
      106      525
      107      526        /*  "OUT" is the output string. */
      108      527
      109      528    1   DCL U$                             PTR;
      110      529    1   DCL U                              SBIN;
      111      530    1   DCL 1 NAME_OUT BASED(U$) CALIGNED,
      112      531    1         2 NAME# UNAL                 CHAR(MAX);
      113      532
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:5    
      114      533        /*  Assorted stuff. */
      115      534
      116      535    1   DCL TEMP                           SBIN;
      117      536    1   DCL MAX                            SBIN;
      118      537    1   DCL I                              SBIN;
      119      538    1   DCL J                              SBIN;
      120      539    1   DCL L                              SBIN;
      121      540    1   DCL WILD                           CHAR(1);
      122      541    1   DCL NOMORE                         BIT(1);
      123      542
      124      543        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:6    
      125      544        /*  The following are the error messages generated by the wildcarded  */
      126      545
      127      546        /*E*     ERROR:    XUW-E$XUW#WILD_OK-0
      128      547                 MESSAGE:  All is OK with the wildcarder.
      129      548        */
      130      549        /*E*     ERROR:    XUW-E$XUW#PATNIL-0
      131      550                 MESSAGE:  The wildcard pattern is NIL or 0 length.
      132      551        */
      133      552        /*E*     ERROR:    XUW-E$XUW#INPNIL-0
      134      553                 MESSAGE:  The wildcard input is NIL or 0 length.
      135      554        */
      136      555        /*E*     ERROR:    XUW-E$XUW#TMPNIL-0
      137      556                 MESSAGE:  The wildcard template is NIL or 0 length.
      138      557        */
      139      558        /*E*     ERROR:    XUW-E$XUW#OUTNIL-0
      140      559                 MESSAGE:  The wildcard output is NIL.
      141      560        */
      142      561        /*E*     ERROR:    XUW-E$XUW#NOMATCH-0
      143      562                 MESSAGE:  Input does not match pattern.
      144      563        */
      145      564        /*E*     ERROR:    XUW-E$XUW#TOOLONG-0
      146      565                 MESSAGE:  Output string is too long.
      147      566        */
      148      567
      149      568        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:7    
      150      569        /*  Examine and verify the pattern string parameter. */
      151      570
      152      571    1       W$=FPT_WILDCARD.PATTERN_.PATTERN$;
      153      572    1       WLEN=FPT_WILDCARD.PATTERN_.BOUND+1;
      154      573    1       IF W$=ADDR(NIL) OR WLEN=0
      155      574    2       THEN DO;
      156      575    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#PATNIL;
      157      576    2           ALTRETURN;
      158      577    2       END;
      159      578
      160      579        /*  Examine and verify the input string parameter. */
      161      580
      162      581    1       N$=FPT_WILDCARD.INPUT_.INPUT$;
      163      582    1       NLEN=FPT_WILDCARD.INPUT_.BOUND+1;
      164      583    1       IF N$=ADDR(NIL) OR NLEN=0
      165      584    2       THEN DO;
      166      585    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#INPNIL;
      167      586    2           ALTRETURN;
      168      587    2       END;
      169      588
      170      589        /*  Examine and verify the template string parameter. */
      171      590
      172      591    1       D$=FPT_WILDCARD.TEMPLATE_.TEMPLATE$;
      173      592    1       DLEN=FPT_WILDCARD.TEMPLATE_.BOUND+1;
      174      593    1       IF D$=ADDR(NIL) OR DLEN=0
      175      594    2       THEN DO;
      176      595    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#TMPNIL;
      177      596    2           ALTRETURN;
      178      597    2       END;
      179      598
      180      599        /*  Examine and verify the output string parameter. */
      181      600
      182      601    1       U$=FPT_WILDCARD.OUTPUT_.OUTPUT$;
      183      602    2       IF U$=ADDR(NIL) THEN DO;
      184      603    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#OUTNIL;
      185      604    2           ALTRETURN;
      186      605    2       END;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:8    
      187      606    1       MAX=FPT_WILDCARD.OUTPUT_.BOUND+1;
      188      607    1       IF MAX=0 THEN
      189      608    1           MAX=511;
      190      609
      191      610    1       WILD=FPT_WILDCARD.WILD_CHAR#;
      192      611
      193      612    1       GOTO X$WILDCOM;
      194      613
      195      614        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:9    
      196      615    1   X$WILDCMP: ENTRY(FPT_WILDCARD) ALTRET;
      197      616
      198      617        /*M* X$WILDCMP - Wildcard match */
      199      618
      200      619        /*********************************************************************
      201      620        *                                                                    *
      202      621        *   X$WILDCMP may be used to compare a wildcarded pattern string     *
      203      622        *   with an input string.  The wildcard character defaults to '?'.   *
      204      623        *                                                                    *
      205      624        *   Sequences of ? characters are treated as a single ? character.   *
      206      625        *   E.g., ?? is equivalent to ?.                                     *
      207      626        *                                                                    *
      208      627        *   Calling sequence:                                                *
      209      628        *                                                                    *
      210      629        *       CALL X$WILDCMP(XUW_WILDCARD) ALTRET(NO_MATCH);               *
      211      630        *                                                                    *
      212      631        *   The format of XUW_WILDCARD is available in XUW_MACRO_C.          *
      213      632        *                                                                    *
      214      633        *   The above structure may be generated by %INCLUDing file          *
      215      634        *   XUW_MACRO_C and invoking %XUW_WILDCARD.  Keywords are            *
      216      635        *   FPTN=name, STCLASS=class, PATTERN=pattern, and INPUT=input.      *
      217      636        *   FPTN defaults to XUW_WILDCARD, STCLASS to STATIC, and PATTERN    *
      218      637        *   and INPUT default to NIL.  ERROR.ERR# is always set to           *
      219      638        *   %E$XUW#WILD_OK.                                                  *
      220      639        *                                                                    *
      221      640        *   XUW_WILDCARD.ERROR.ERR# will contain the result of the string    *
      222      641        *   match operation:  (these values are in XU_PERR_C)                *
      223      642        *                                                                    *
      224      643        *       %E$XUW#WILD_OK  - Pattern matches.                           *
      225      644        *       %E$XUW#PATNIL   - Pattern is nil or length=0.                *
      226      645        *       %E$XUW#INPNIL   - Input is nil or length=0.                  *
      227      646        *       %E$XUW#NOMATCH  - Pattern does not match input.              *
      228      647        *                                                                    *
      229      648        *   XUW_WILDCARD.WILD_CHAR# defaults to '?', a CP-6 convention.      *
      230      649        *   XUW_WILDCARD.PATTERN_ and XUW_WILDCARD.INPUT_                    *
      231      650        *   frame the pattern and input strings, respectively.  They are both*
      232      651        *   CALIGNED TEXT fields.                                            *
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:10   
      233      652        *                                                                    *
      234      653        *   The length of the pattern and input                              *
      235      654        *   strings may not exceed 511 bytes each and may not be zero.       *
      236      655        *                                                                    *
      237      656        *   On normal return, XUW_WILDCARD.ERROR.ERR# will be set to         *
      238      657        *   %E$XUW#WILD_OK.  If X$WILDCMP ALTRETs, XUW_WILDCARD.ERROR.ERR#   *
      239      658        *   will be set to another value as described above.                 *
      240      659        *                                                                    *
      241      660        *   The pattern and input pointers are never altered.                *
      242      661        *                                                                    *
      243      662        *********************************************************************/
      244      663
      245      664        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:11   
      246      665        /*  Examine and verify the pattern string. */
      247      666
      248      667    1       W$=FPT_WILDCARD.PATTERN_.PATTERN$;
      249      668    1       WLEN=FPT_WILDCARD.PATTERN_.BOUND+1;
      250      669    1       IF W$=ADDR(NIL) OR WLEN=0
      251      670    2       THEN DO;
      252      671    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#PATNIL;
      253      672    2           ALTRETURN;
      254      673    2       END;
      255      674
      256      675        /*  Examine and verify the input string. */
      257      676
      258      677    1       N$=FPT_WILDCARD.INPUT_.INPUT$;
      259      678    1       NLEN=FPT_WILDCARD.INPUT_.BOUND+1;
      260      679    1       IF N$=ADDR(NIL) OR NLEN=0
      261      680    2       THEN DO;
      262      681    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#INPNIL;
      263      682    2           ALTRETURN;
      264      683    2       END;
      265      684
      266      685    1       D$=ADDR(NIL);
      267      686    1       U$=ADDR(NIL);
      268      687    1       MAX=-1;
      269      688
      270      689    1       DLEN=0;
      271      690    1       WILD=FPT_WILDCARD.WILD_CHAR#;
      272      691
      273      692        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:12   
      274      693        /* Common compare/format code */
      275      694
      276      695    1   X$WILDCOM:
      277      696
      278      697        /*  Set up FPT_WILDCARD.ERROR for eventual exit.  */
      279      698
      280      699    1       FPT_WILDCARD.ERROR.FCG = '3025'O; /* XU */
      281      700    1       FPT_WILDCARD.ERROR.MID = '27'O; /* W */
      282      701    1       FPT_WILDCARD.ERROR.MON = '0'B;
      283      702    1       FPT_WILDCARD.ERROR.SEV = 0;
      284      703
      285      704    1       W=0;
      286      705    1       N=0;
      287      706    1       D=0;
      288      707    1       U=0;
      289      708    1       NOMORE='0'B;
      290      709
      291      710        /*  Move first part of template string to output area. */
      292      711
      293      712    1       IF MAX>0 THEN
      294      713    1           CALL DTOU ALTRET(X$TOOLONG);
      295      714
      296      715        /*  Check for a wild string in the first position of the pattern. */
      297      716
      298      717    1       IF SUBSTR(NAME_WILD.NAME#,0,1)=WILD THEN
      299      718    1           GOTO X$NEXTSEG;
      300      719
      301      720        /*  See if first non-wild segment matches. */
      302      721
      303      722    1       CALL INDEX(W,WILD,NAME_WILD.NAME#,0); /* W=LENGTH OF FIRST NON-WILD       */
      304      723    1       IF W>NLEN
      305      724    1       THEN                               /* NON-WILD COULDN'T FIT              */
      306      725    1           GOTO X$NOMATCH;
      307      726    1       CALL INDEX(TEMP,SUBSTR(NAME_WILD.NAME#,0,W),NAME_INP.NAME#); /* LOCATION  */
      308      727    1       IF TEMP >= NLEN
      309      728    1       THEN                            /* FIRST NON-WILD NOT THERE AT ALL    */
      310      729    1           GOTO X$NOMATCH;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:13   
      311      730    1       IF FPT_WILDCARD.CONTAINS#
      312      731    1       THEN
      313      732    1           IF W>=WLEN
      314      733    1           THEN                           /* ALL DONE IF NO WILDCARD */
      315      734    1               GOTO X$MATCH;
      316      735    1           ELSE                           /* FIRST NON-WILD CAN START AFTER 0   */
      317      736    1               N = W + TEMP;
      318      737    1       ELSE                                /* FIRST NON-WILD MUST START AT 0     */
      319      738    1           IF TEMP ~= 0
      320      739    1           THEN                            /* FIRST NON-WILD NOT AT ZERO         */
      321      740    1               GOTO X$NOMATCH;
      322      741    1           ELSE                            /* FIRST NON-WILD AT ZERO, AS REQUIRED*/
      323      742    1               N=W;
      324      743
      325      744        /*  Check for the degenerate case of no wildcarding at all. */
      326      745
      327      746    1       IF W>=WLEN THEN
      328      747    1           IF WLEN~=NLEN THEN
      329      748    1               GOTO X$NOMATCH;
      330      749    1           ELSE
      331      750    1               GOTO X$MATCH;
      332      751
      333      752    1   X$NEXTSEG:
      334      753
      335      754        /*  Skip over the wildcard character(s). */
      336      755
      337      756    2       DO WHILE(W<WLEN AND SUBSTR(NAME_WILD.NAME#,W,1)=WILD);
      338      757    2           W=W+1;
      339      758    2       END;
      340      759
      341      760        /*  If we fell off the end of the pattern, we're done. */
      342      761
      343      762    1       IF W>=WLEN THEN
      344      763    1           GOTO X$COPYREST;
      345      764
      346      765        /*  W points to the first non-wild character in the pattern.  N points
      347      766            to the starting position in the input string to start looking for
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:14   
      348      767            a match.  Remember W in I and N in J for use later, then look for
      349      768            a string match. */
      350      769
      351      770    1       I=W;
      352      771    1       J=N;
      353      772    1       CALL INDEX(W,WILD,NAME_WILD.NAME#,W);
      354      773    1       IF W>=WLEN                          /* NO TRAILING WILD-TOKEN             */
      355      774    1         AND NOT FPT_WILDCARD.CONTAINS#    /* AND IT MATTERS                     */
      356      775    1       THEN                               /* INPUT *MUST* END WITH NON-WILD PART*/
      357      776    1           N=MAXIMUM(N,NLEN-W+I);
      358      777
      359      778        /*  I points to the beginning of the non-wild string in the pattern;
      360      779            W points one past the end of the string.  Thus, W-I is the length
      361      780            of the string to find in the input string.  Now advance N by ones
      362      781            until either the remaining length of the string is shorter than
      363      782            W-I characters or a match is found. */
      364      783
      365      784    1       L=W-I;
      366      785    2       DO WHILE(L<=NLEN-N);
      367      786    2           IF SUBSTR(NAME_WILD.NAME#,I,L)=SUBSTR(NAME_INP.NAME#,N,L) THEN
      368      787    2               GOTO X$SEGMATCH;
      369      788    2           N=N+1;
      370      789    2       END;
      371      790
      372      791        /*  No match was found before the end of the string. */
      373      792
      374      793    1       GOTO X$NOMATCH;
      375      794
      376      795    1   X$SEGMATCH:
      377      796
      378      797        /*  At this point, N points to the beginning of a non-wild string in
      379      798            the input name which matches the non-wild string in the pattern.
      380      799            J points to the first non-matched character; thus N-J is the
      381      800            length of the input string which matches the wild part of the
      382      801            pattern (note that this may be zero characters).  If we are
      383      802            doing a format operation, move these N-J characters to the
      384      803            output string. */
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:15   
      385      804
      386      805    2       IF MAX>0 AND N>J THEN DO;
      387      806    2           L=N-J;
      388      807    2           IF L>MAX-U THEN
      389      808    2               GOTO X$TOOLONG;
      390      809    3           IF L>0 AND ~NOMORE THEN DO;
      391      810    3               CALL INSERT(NAME_OUT.NAME#,U,L,SUBSTR(NAME_INP.NAME#,J,L));
      392      811    3               U=U+L;
      393      812    3           END;
      394      813    2       END;
      395      814
      396      815        /*  Bump the input pointer past the end of the matched string.  Then
      397      816            move the next non-wild segment of the pattern to the output area,
      398      817            if we are formatting an output string. */
      399      818
      400      819    1       N=N+W-I;
      401      820    1       IF MAX>0 THEN
      402      821    1           CALL DTOU ALTRET(X$TOOLONG);
      403      822
      404      823        /*  If we have not completed scanning the pattern string, loop back
      405      824            to the next segment routine. */
      406      825
      407      826    1       IF W<WLEN THEN
      408      827    1           GOTO X$NEXTSEG;
      409      828
      410      829        /*  The pattern string is exhausted; if the name is not exhausted,
      411      830            too, the strings do not match.  The exception is 'CONTAINS'
      412      831            which allows the pattern to end early. */
      413      832
      414      833    1       IF N<NLEN                           /* IF PATTERN ENDS EARLY              */
      415      834    1         AND NOT FPT_WILDCARD.CONTAINS#    /* AND IT MATTERS                     */
      416      835    1       THEN
      417      836    1           GOTO X$NOMATCH;
      418      837
      419      838        /*  The input string matched the pattern.  We're mostly done! */
      420      839
      421      840    1       GOTO X$MATCH;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:16   
      422      841        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:17   
      423      842    1   X$COPYREST:
      424      843
      425      844        /*  The pattern ended in a wildcard; therefore, it matches the rest
      426      845            of the input string.  Move the rest of the name to the output
      427      846            area (if formatting). */
      428      847
      429      848    2       IF MAX>0 THEN DO;
      430      849    3           IF N<NLEN AND ~NOMORE THEN DO;
      431      850    3               L=NLEN-N;
      432      851    3               IF L>MAX-U THEN
      433      852    3                   GOTO X$TOOLONG;
      434      853    3               CALL INSERT(NAME_OUT.NAME#,U,L,SUBSTR(NAME_INP.NAME#,N,L));
      435      854    3               U=U+L;
      436      855    3           END;
      437      856    2       END;
      438      857
      439      858    1   X$MATCH:
      440      859        /*  We have a match!  Now move the rest of the template string (if any)
      441      860            to the output string (if formatting). */
      442      861    1       IF MAX>0 THEN
      443      862    2       DO;
      444      863    3           DO WHILE (NOT NOMORE);
      445      864    3               CALL DTOU ALTRET(X$TOOLONG);
      446      865    3           END;
      447      866    2           FPT_WILDCARD.OUTPUT_LEN=U;
      448      867    2       END;
      449      868    1       FPT_WILDCARD.ERROR.ERR#=%E$XUW#WILD_OK;
      450      869    1       RETURN;
      451      870
      452      871    1   X$NOMATCH:
      453      872    1       FPT_WILDCARD.ERROR.ERR#=%E$XUW#NOMATCH;
      454      873    1       ALTRETURN;
      455      874
      456      875    1   X$TOOLONG:
      457      876    1       FPT_WILDCARD.ERROR.ERR#=%E$XUW#TOOLONG;
      458      877    1       ALTRETURN;
      459      878
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:18   
      460      879        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:19   
      461      880    1   DTOU: PROC ALTRET;
      462      881
      463      882        /* *******************************************************************
      464      883        *                                                                    *
      465      884        *   Copy the template from the character at D up to, but not         *
      466      885        *   including the next wildcard string, to the output string.        *
      467      886        *   Check that this portion fits, ALTRET if it doesn't.  Bump        *
      468      887        *   the U and D pointers by the number of characters moved.          *
      469      888        *                                                                    *
      470      889        ******************************************************************* */
      471      890
      472      891    3       IF D<DLEN THEN DO;
      473      892    3           CALL INDEX(I,WILD,NAME_DEST.NAME#,D);
      474      893    3           IF I>=DLEN THEN
      475      894    3               NOMORE='1'B;
      476      895    3           L=I-D;
      477      896    3           IF L>MAX-U THEN
      478      897    3               ALTRETURN;
      479      898    3           IF L>0 THEN
      480      899    3               CALL INSERT(NAME_OUT.NAME#,U,L,SUBSTR(NAME_DEST.NAME#,D,L));
      481      900    3           U=U+L;
      482      901    3           D=I;
      483      902    3           IF D<DLEN THEN
      484      903    3               D=D+1;
      485      904    3       END;
      486      905    2       ELSE
      487      906    2           NOMORE='1'B;
      488      907    2       RETURN;
      489      908    2   END;
      490      909
      491      910    1   END;
      492      911        %EOD;

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:20   
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XUW_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure X$WILDFMT.

   Procedure X$WILDFMT requires 391 words for executable code.
   Procedure X$WILDFMT requires 26 words of local(AUTO) storage.

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:21   

 Object Unit name= X$WILDFMT                                  File name= XUW$WILD.:E05TOU
 UTS= JUL 30 '97 09:45:43.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   391    607  X$WILDFMT
    1  RoData even  none     4      4  X$WILDFMT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        1  X$WILDFMT
     0    110          yes     yes      Std        1  X$WILDCMP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_INDEX
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:22   


        1        1        /*M* X$WILDFMT - Wildcard match and format routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
        8        8        X$WILDFMT: PROC(FPT_WILDCARD) ALTRET;

      8  0 000000   000000 700200 xent  X$WILDFMT    TSX0  ! X66_AUTO_1
         0 000001   000032 000001                    ZERO    26,1

        9        9
       10       10
       11       11        /*********************************************************************
       12       12        *                                                                    *
       13       13        *   X$WILDFMT may be used to compare a wildcarded pattern string     *
       14       14        *   with an input string;  if they match, an output string is formed *
       15       15        *   using the pattern and input strings and an output tamplate.  The *
       16       16        *   wildcard character is variable but defaults to '?'.              *
       17       17        *                                                                    *
       18       18        *   On input, sequences of ? characters are treated as a single ?    *
       19       19        *   character.  E.g., ?? is equivalent to ?.                         *
       20       20        *                                                                    *
       21       21        *   On output, sequences of ? characters are treated as multiple     *
       22       22        *   ? characters.  E.g., ?? contains two wildcard strings.           *
       23       23        *                                                                    *
       24       24        *   Calling sequence:                                                *
       25       25        *                                                                    *
       26       26        *       CALL X$WILDFMT(FPT_WILDCARD) ALTRET(NO_MATCH);               *
       27       27        *                                                                    *
       28       28        *   The format of XUW_WILDCARD is available in XUW_MACRO_C.          *
       29       29        *                                                                    *
       30       30        *   The above structure may be generated by %INCLUDing file          *
       31       31        *   XUW_MACRO_C and invoking %XUW_WILDCARD.  Keywords are            *
       32       32        *   FPTN=name, STCLASS=class, PATTERN=pattern, INPUT=input,          *
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:23   
       33       33        *   TEMPLATE=template, and OUTPUT=output.                            *
       34       34        *   FPTN defaults to XUW_WILDCARD, STCLASS to STATIC, and PATTERN,   *
       35       35        *   INPUT, TEMPLATE, and OUTPUT default to NIL.  ERROR.ERR# is       *
       36       36        *   always set to E$XUW#WILD_OK.                                     *
       37       37        *                                                                    *
       38       38        *   XUW_WILDCARD.ERROR.ERR# will contain the result of the string    *
       39       39        *   match/format operation:  (these values are in XU_PERR_C)         *
       40       40        *                                                                    *
       41       41        *       %E$XUW#WILD_OK  - Pattern matches, output made.              *
       42       42        *       %E$XUW#PATNIL   - Pattern is nil or length=0.                *
       43       43        *       %E$XUW#INPNIL   - Input is nil or length=0.                  *
       44       44        *       %E$XUW#TMPNIL   - Template is nil or length=0.               *
       45       45        *       %E$XUW#OUTNIL   - Output is nil or length=0.                 *
       46       46        *       %E$XUW#NOMATCH  - Pattern does not match input.              *
       47       47        *       %E$XUW#PATLTIMP - Pattern has fewer ? than template does.    *
       48       48        *       %E$XUW#TOOLONG  - Output string exceeds available space.     *
       49       49        *                                                                    *
       50       50        *   XUW_WILDCARD.WILD_CHAR# defaults to '?', a CP-6 convention.      *
       51       51        *   XUW_WILDCARD.PATTERN_, XUW_WILDCARD.INPUT_,                      *
       52       52        *   XUW_WILDCARD.TEMPLATE_, and XUW_WILDCARD.OUTPUT_                 *
       53       53        *   frame the pattern, input, template, and output areas,            *
       54       54        *   respectively.  They are all CALIGNED TEXT fields.                *
       55       55        *                                                                    *
       56       56        *   The length of the pattern, input, template, and output           *
       57       57        *   strings may not exceed 511 bytes each and may not be zero.       *
       58       58        *                                                                    *
       59       59        *   On normal return, XUW_WILDCARD.ERROR.ERR# will be set to         *
       60       60        *   E$XUW#WILD_OK.  If X$WILDCMP ALTRETs, XUW_WILDCARD.ERROR.ERR#    *
       61       61        *   will be set to another value as described above (and             *
       62       62        *   the contents of the output string are unpredictable).            *
       63       63        *                                                                    *
       64       64        *   The pattern, input, and templates are never altered.             *
       65       65        *                                                                    *
       66       66        *   The length of the generated output string is returned in         *
       67       67        *   XUW_WILDCARD.OUTPUT_LEN.                                         *
       68       68        *                                                                    *
       69       69        *   CAUTION:  If the developed output string is zero-length,         *
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:24   
       70       70        *   X$WILDFMT does NOT ALTRET.  The user is responsible for checking *
       71       71        *   the length of the output string.  For example, PATTERN='XX?',    *
       72       72        *   INPUT='XX', TEMPLATE='?', OUTPUT=''.                             *
       73       73        *                                                                    *
       74       74        *********************************************************************/
       75       75
       76       76        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:25   
       77       77
       78       78        %INCLUDE XUW_MACRO_C;
       79      213        %INCLUDE XU_PERR_C;
       80      404
       81      405        %XUW_WILDCARD(FPTN = FPT_WILDCARD,STCLASS = " ");
       82      501
       83      502        /*  "WILD" is the pattern string. */
       84      503
       85      504    1   DCL W$                             PTR;
       86      505    1   DCL WLEN                           SBIN;
       87      506    1   DCL W                              SBIN;
       88      507    1   DCL 1 NAME_WILD BASED(W$) CALIGNED,
       89      508    1         2 NAME# UNAL                 CHAR(WLEN);
       90      509
       91      510        /*  "INP" is the input string. */
       92      511
       93      512    1   DCL N$                             PTR;
       94      513    1   DCL NLEN                           SBIN;
       95      514    1   DCL N                              SBIN;
       96      515    1   DCL 1 NAME_INP BASED(N$) CALIGNED,
       97      516    1         2 NAME# UNAL                 CHAR(NLEN);
       98      517
       99      518        /*  "DEST" is the template string. */
      100      519
      101      520    1   DCL D$                             PTR;
      102      521    1   DCL DLEN                           SBIN;
      103      522    1   DCL D                              SBIN;
      104      523    1   DCL 1 NAME_DEST BASED(D$) CALIGNED,
      105      524    1         2 NAME# UNAL                 CHAR(DLEN);
      106      525
      107      526        /*  "OUT" is the output string. */
      108      527
      109      528    1   DCL U$                             PTR;
      110      529    1   DCL U                              SBIN;
      111      530    1   DCL 1 NAME_OUT BASED(U$) CALIGNED,
      112      531    1         2 NAME# UNAL                 CHAR(MAX);
      113      532
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:26   
      114      533        /*  Assorted stuff. */
      115      534
      116      535    1   DCL TEMP                           SBIN;
      117      536    1   DCL MAX                            SBIN;
      118      537    1   DCL I                              SBIN;
      119      538    1   DCL J                              SBIN;
      120      539    1   DCL L                              SBIN;
      121      540    1   DCL WILD                           CHAR(1);
      122      541    1   DCL NOMORE                         BIT(1);
      123      542
      124      543        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:27   
      125      544        /*  The following are the error messages generated by the wildcarded  */
      126      545
      127      546        /*E*     ERROR:    XUW-E$XUW#WILD_OK-0
      128      547                 MESSAGE:  All is OK with the wildcarder.
      129      548        */
      130      549        /*E*     ERROR:    XUW-E$XUW#PATNIL-0
      131      550                 MESSAGE:  The wildcard pattern is NIL or 0 length.
      132      551        */
      133      552        /*E*     ERROR:    XUW-E$XUW#INPNIL-0
      134      553                 MESSAGE:  The wildcard input is NIL or 0 length.
      135      554        */
      136      555        /*E*     ERROR:    XUW-E$XUW#TMPNIL-0
      137      556                 MESSAGE:  The wildcard template is NIL or 0 length.
      138      557        */
      139      558        /*E*     ERROR:    XUW-E$XUW#OUTNIL-0
      140      559                 MESSAGE:  The wildcard output is NIL.
      141      560        */
      142      561        /*E*     ERROR:    XUW-E$XUW#NOMATCH-0
      143      562                 MESSAGE:  Input does not match pattern.
      144      563        */
      145      564        /*E*     ERROR:    XUW-E$XUW#TOOLONG-0
      146      565                 MESSAGE:  Output string is too long.
      147      566        */
      148      567
      149      568        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:28   
      150      569        /*  Examine and verify the pattern string parameter. */
      151      570
      152      571    1       W$=FPT_WILDCARD.PATTERN_.PATTERN$;

    571  0 000002   200003 470500                    LDP0    @FPT_WILDCARD,,AUTO
         0 000003   000001 236100                    LDQ     1,,PR0
         0 000004   200004 756100                    STQ     W$,,AUTO

      153      572    1       WLEN=FPT_WILDCARD.PATTERN_.BOUND+1;

    572  0 000005   000000 236100                    LDQ     0,,PR0
         0 000006   000020 732000                    QRS     16
         0 000007   000001 036007                    ADLQ    1,DL
         0 000010   200005 756100                    STQ     WLEN,,AUTO

      154      573    1       IF W$=ADDR(NIL) OR WLEN=0

    573  0 000011   200004 236100                    LDQ     W$,,AUTO
         0 000012   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000013   000016 600000 0                  TZE     s:575
         0 000014   200005 235100                    LDA     WLEN,,AUTO
         0 000015   000023 601000 0                  TNZ     s:581

      155      574    2       THEN DO;

      156      575    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#PATNIL;

    575  0 000016   000010 236100                    LDQ     8,,PR0
         0 000017   000000 376000 1                  ANQ     0
         0 000020   003730 276007                    ORQ     2008,DL
         0 000021   000010 756100                    STQ     8,,PR0

      157      576    2           ALTRETURN;

    576  0 000022   000000 702200 xent               TSX2  ! X66_AALT

      158      577    2       END;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:29   
      159      578
      160      579        /*  Examine and verify the input string parameter. */
      161      580
      162      581    1       N$=FPT_WILDCARD.INPUT_.INPUT$;

    581  0 000023   000003 236100                    LDQ     3,,PR0
         0 000024   200007 756100                    STQ     N$,,AUTO

      163      582    1       NLEN=FPT_WILDCARD.INPUT_.BOUND+1;

    582  0 000025   000002 236100                    LDQ     2,,PR0
         0 000026   000020 732000                    QRS     16
         0 000027   000001 036007                    ADLQ    1,DL
         0 000030   200010 756100                    STQ     NLEN,,AUTO

      164      583    1       IF N$=ADDR(NIL) OR NLEN=0

    583  0 000031   200007 236100                    LDQ     N$,,AUTO
         0 000032   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000033   000036 600000 0                  TZE     s:585
         0 000034   200010 235100                    LDA     NLEN,,AUTO
         0 000035   000043 601000 0                  TNZ     s:591

      165      584    2       THEN DO;

      166      585    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#INPNIL;

    585  0 000036   000010 236100                    LDQ     8,,PR0
         0 000037   000000 376000 1                  ANQ     0
         0 000040   003740 276007                    ORQ     2016,DL
         0 000041   000010 756100                    STQ     8,,PR0

      167      586    2           ALTRETURN;

    586  0 000042   000000 702200 xent               TSX2  ! X66_AALT

      168      587    2       END;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:30   
      169      588
      170      589        /*  Examine and verify the template string parameter. */
      171      590
      172      591    1       D$=FPT_WILDCARD.TEMPLATE_.TEMPLATE$;

    591  0 000043   000005 236100                    LDQ     5,,PR0
         0 000044   200012 756100                    STQ     D$,,AUTO

      173      592    1       DLEN=FPT_WILDCARD.TEMPLATE_.BOUND+1;

    592  0 000045   000004 236100                    LDQ     4,,PR0
         0 000046   000020 732000                    QRS     16
         0 000047   000001 036007                    ADLQ    1,DL
         0 000050   200013 756100                    STQ     DLEN,,AUTO

      174      593    1       IF D$=ADDR(NIL) OR DLEN=0

    593  0 000051   200012 236100                    LDQ     D$,,AUTO
         0 000052   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000053   000056 600000 0                  TZE     s:595
         0 000054   200013 235100                    LDA     DLEN,,AUTO
         0 000055   000063 601000 0                  TNZ     s:601

      175      594    2       THEN DO;

      176      595    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#TMPNIL;

    595  0 000056   000010 236100                    LDQ     8,,PR0
         0 000057   000000 376000 1                  ANQ     0
         0 000060   003750 276007                    ORQ     2024,DL
         0 000061   000010 756100                    STQ     8,,PR0

      177      596    2           ALTRETURN;

    596  0 000062   000000 702200 xent               TSX2  ! X66_AALT

      178      597    2       END;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:31   
      179      598
      180      599        /*  Examine and verify the output string parameter. */
      181      600
      182      601    1       U$=FPT_WILDCARD.OUTPUT_.OUTPUT$;

    601  0 000063   000007 236100                    LDQ     7,,PR0
         0 000064   200015 756100                    STQ     U$,,AUTO

      183      602    2       IF U$=ADDR(NIL) THEN DO;

    602  0 000065   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000066   000074 601000 0                  TNZ     s:606

      184      603    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#OUTNIL;

    603  0 000067   000010 236100                    LDQ     8,,PR0
         0 000070   000000 376000 1                  ANQ     0
         0 000071   003760 276007                    ORQ     2032,DL
         0 000072   000010 756100                    STQ     8,,PR0

      185      604    2           ALTRETURN;

    604  0 000073   000000 702200 xent               TSX2  ! X66_AALT

      186      605    2       END;
      187      606    1       MAX=FPT_WILDCARD.OUTPUT_.BOUND+1;

    606  0 000074   000006 236100                    LDQ     6,,PR0
         0 000075   000020 732000                    QRS     16
         0 000076   000001 036007                    ADLQ    1,DL
         0 000077   200020 756100                    STQ     MAX,,AUTO

      188      607    1       IF MAX=0 THEN

    607  0 000100   000103 601000 0                  TNZ     s:610

      189      608    1           MAX=511;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:32   

    608  0 000101   000777 235007                    LDA     511,DL
         0 000102   200020 755100                    STA     MAX,,AUTO

      190      609
      191      610    1       WILD=FPT_WILDCARD.WILD_CHAR#;

    610  0 000103   000011 236100                    LDQ     9,,PR0
         0 000104   777000 376003                    ANQ     -512,DU
         0 000105   000001 276000 1                  ORQ     1
         0 000106   200024 756100                    STQ     WILD,,AUTO

      192      611
      193      612    1       GOTO X$WILDCOM;

    612  0 000107   000165 710000 0                  TRA     X$WILDCOM

      194      613
      195      614        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:33   
      196      615    1   X$WILDCMP: ENTRY(FPT_WILDCARD) ALTRET;

    615  0 000110   000000 700200 xent  X$WILDCMP    TSX0  ! X66_AUTO_1
         0 000111   000032 000001                    ZERO    26,1

      197      616
      198      617        /*M* X$WILDCMP - Wildcard match */
      199      618
      200      619        /*********************************************************************
      201      620        *                                                                    *
      202      621        *   X$WILDCMP may be used to compare a wildcarded pattern string     *
      203      622        *   with an input string.  The wildcard character defaults to '?'.   *
      204      623        *                                                                    *
      205      624        *   Sequences of ? characters are treated as a single ? character.   *
      206      625        *   E.g., ?? is equivalent to ?.                                     *
      207      626        *                                                                    *
      208      627        *   Calling sequence:                                                *
      209      628        *                                                                    *
      210      629        *       CALL X$WILDCMP(XUW_WILDCARD) ALTRET(NO_MATCH);               *
      211      630        *                                                                    *
      212      631        *   The format of XUW_WILDCARD is available in XUW_MACRO_C.          *
      213      632        *                                                                    *
      214      633        *   The above structure may be generated by %INCLUDing file          *
      215      634        *   XUW_MACRO_C and invoking %XUW_WILDCARD.  Keywords are            *
      216      635        *   FPTN=name, STCLASS=class, PATTERN=pattern, and INPUT=input.      *
      217      636        *   FPTN defaults to XUW_WILDCARD, STCLASS to STATIC, and PATTERN    *
      218      637        *   and INPUT default to NIL.  ERROR.ERR# is always set to           *
      219      638        *   %E$XUW#WILD_OK.                                                  *
      220      639        *                                                                    *
      221      640        *   XUW_WILDCARD.ERROR.ERR# will contain the result of the string    *
      222      641        *   match operation:  (these values are in XU_PERR_C)                *
      223      642        *                                                                    *
      224      643        *       %E$XUW#WILD_OK  - Pattern matches.                           *
      225      644        *       %E$XUW#PATNIL   - Pattern is nil or length=0.                *
      226      645        *       %E$XUW#INPNIL   - Input is nil or length=0.                  *
      227      646        *       %E$XUW#NOMATCH  - Pattern does not match input.              *
      228      647        *                                                                    *
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:34   
      229      648        *   XUW_WILDCARD.WILD_CHAR# defaults to '?', a CP-6 convention.      *
      230      649        *   XUW_WILDCARD.PATTERN_ and XUW_WILDCARD.INPUT_                    *
      231      650        *   frame the pattern and input strings, respectively.  They are both*
      232      651        *   CALIGNED TEXT fields.                                            *
      233      652        *                                                                    *
      234      653        *   The length of the pattern and input                              *
      235      654        *   strings may not exceed 511 bytes each and may not be zero.       *
      236      655        *                                                                    *
      237      656        *   On normal return, XUW_WILDCARD.ERROR.ERR# will be set to         *
      238      657        *   %E$XUW#WILD_OK.  If X$WILDCMP ALTRETs, XUW_WILDCARD.ERROR.ERR#   *
      239      658        *   will be set to another value as described above.                 *
      240      659        *                                                                    *
      241      660        *   The pattern and input pointers are never altered.                *
      242      661        *                                                                    *
      243      662        *********************************************************************/
      244      663
      245      664        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:35   
      246      665        /*  Examine and verify the pattern string. */
      247      666
      248      667    1       W$=FPT_WILDCARD.PATTERN_.PATTERN$;

    667  0 000112   200003 470500                    LDP0    @FPT_WILDCARD,,AUTO
         0 000113   000001 236100                    LDQ     1,,PR0
         0 000114   200004 756100                    STQ     W$,,AUTO

      249      668    1       WLEN=FPT_WILDCARD.PATTERN_.BOUND+1;

    668  0 000115   000000 236100                    LDQ     0,,PR0
         0 000116   000020 732000                    QRS     16
         0 000117   000001 036007                    ADLQ    1,DL
         0 000120   200005 756100                    STQ     WLEN,,AUTO

      250      669    1       IF W$=ADDR(NIL) OR WLEN=0

    669  0 000121   200004 236100                    LDQ     W$,,AUTO
         0 000122   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000123   000126 600000 0                  TZE     s:671
         0 000124   200005 235100                    LDA     WLEN,,AUTO
         0 000125   000133 601000 0                  TNZ     s:677

      251      670    2       THEN DO;

      252      671    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#PATNIL;

    671  0 000126   000010 236100                    LDQ     8,,PR0
         0 000127   000000 376000 1                  ANQ     0
         0 000130   003730 276007                    ORQ     2008,DL
         0 000131   000010 756100                    STQ     8,,PR0

      253      672    2           ALTRETURN;

    672  0 000132   000000 702200 xent               TSX2  ! X66_AALT

      254      673    2       END;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:36   
      255      674
      256      675        /*  Examine and verify the input string. */
      257      676
      258      677    1       N$=FPT_WILDCARD.INPUT_.INPUT$;

    677  0 000133   000003 236100                    LDQ     3,,PR0
         0 000134   200007 756100                    STQ     N$,,AUTO

      259      678    1       NLEN=FPT_WILDCARD.INPUT_.BOUND+1;

    678  0 000135   000002 236100                    LDQ     2,,PR0
         0 000136   000020 732000                    QRS     16
         0 000137   000001 036007                    ADLQ    1,DL
         0 000140   200010 756100                    STQ     NLEN,,AUTO

      260      679    1       IF N$=ADDR(NIL) OR NLEN=0

    679  0 000141   200007 236100                    LDQ     N$,,AUTO
         0 000142   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000143   000146 600000 0                  TZE     s:681
         0 000144   200010 235100                    LDA     NLEN,,AUTO
         0 000145   000153 601000 0                  TNZ     s:685

      261      680    2       THEN DO;

      262      681    2           FPT_WILDCARD.ERROR.ERR#=%E$XUW#INPNIL;

    681  0 000146   000010 236100                    LDQ     8,,PR0
         0 000147   000000 376000 1                  ANQ     0
         0 000150   003740 276007                    ORQ     2016,DL
         0 000151   000010 756100                    STQ     8,,PR0

      263      682    2           ALTRETURN;

    682  0 000152   000000 702200 xent               TSX2  ! X66_AALT

      264      683    2       END;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:37   
      265      684
      266      685    1       D$=ADDR(NIL);

    685  0 000153   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000154   200012 756100                    STQ     D$,,AUTO

      267      686    1       U$=ADDR(NIL);

    686  0 000155   200015 756100                    STQ     U$,,AUTO

      268      687    1       MAX=-1;

    687  0 000156   000001 335007                    LCA     1,DL
         0 000157   200020 755100                    STA     MAX,,AUTO

      269      688
      270      689    1       DLEN=0;

    689  0 000160   200013 450100                    STZ     DLEN,,AUTO

      271      690    1       WILD=FPT_WILDCARD.WILD_CHAR#;

    690  0 000161   000011 236100                    LDQ     9,,PR0
         0 000162   777000 376003                    ANQ     -512,DU
         0 000163   000001 276000 1                  ORQ     1
         0 000164   200024 756100                    STQ     WILD,,AUTO

      272      691
      273      692        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:38   
      274      693        /* Common compare/format code */
      275      694
      276      695    1   X$WILDCOM:
      277      696
      278      697        /*  Set up FPT_WILDCARD.ERROR for eventual exit.  */
      279      698
      280      699    1       FPT_WILDCARD.ERROR.FCG = '3025'O; /* XU */

    699  0 000165   302500 236003       X$WILDCOM    LDQ     99648,DU
         0 000166   000010 752160                    STCQ    8,'60'O,PR0

      281      700    1       FPT_WILDCARD.ERROR.MID = '27'O; /* W */

    700  0 000167   000027 236003                    LDQ     23,DU
         0 000170   000010 752110                    STCQ    8,'10'O,PR0

      282      701    1       FPT_WILDCARD.ERROR.MON = '0'B;

    701  0 000171   000002 236000 1                  LDQ     2
         0 000172   000010 356100                    ANSQ    8,,PR0

      283      702    1       FPT_WILDCARD.ERROR.SEV = 0;

    702  0 000173   000003 236000 1                  LDQ     3
         0 000174   000010 356100                    ANSQ    8,,PR0

      284      703
      285      704    1       W=0;

    704  0 000175   200006 450100                    STZ     W,,AUTO

      286      705    1       N=0;

    705  0 000176   200011 450100                    STZ     N,,AUTO

      287      706    1       D=0;

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:39   
    706  0 000177   200014 450100                    STZ     D,,AUTO

      288      707    1       U=0;

    707  0 000200   200016 450100                    STZ     U,,AUTO

      289      708    1       NOMORE='0'B;

    708  0 000201   200025 450100                    STZ     NOMORE,,AUTO

      290      709
      291      710        /*  Move first part of template string to output area. */
      292      711
      293      712    1       IF MAX>0 THEN

    712  0 000202   200020 235100                    LDA     MAX,,AUTO
         0 000203   000206 604400 0                  TMOZ    s:717

      294      713    1           CALL DTOU ALTRET(X$TOOLONG);

    713  0 000204   000523 701000 0                  TSX1    DTOU
         0 000205   000515 702000 0                  TSX2    X$TOOLONG

      295      714
      296      715        /*  Check for a wild string in the first position of the pattern. */
      297      716
      298      717    1       IF SUBSTR(NAME_WILD.NAME#,0,1)=WILD THEN

    717  0 000206   200004 470500                    LDP0    W$,,AUTO
         0 000207   040100 106500                    CMPC    fill='040'O
         0 000210   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         0 000211   200024 000001                    ADSC9   WILD,,AUTO               cn=0,n=1
         0 000212   000263 600000 0                  TZE     X$NEXTSEG

      299      718    1           GOTO X$NEXTSEG;
      300      719
      301      720        /*  See if first non-wild segment matches. */
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:40   
      302      721
      303      722    1       CALL INDEX(W,WILD,NAME_WILD.NAME#,0); /* W=LENGTH OF FIRST NON-WILD       */

    722  0 000213   200005 720100                    LXL0    WLEN,,AUTO
         0 000214   000100 124540                    SCM     mask='000'O
         0 000215   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         0 000216   200024 000001                    ADSC9   WILD,,AUTO               cn=0,n=1
         0 000217   200006 000100                    ARG     W,,AUTO

      304      723    1       IF W>NLEN

    723  0 000220   200006 236100                    LDQ     W,,AUTO
         0 000221   200010 116100                    CMPQ    NLEN,,AUTO
         0 000222   000507 605400 0                  TPNZ    X$NOMATCH

      305      724    1       THEN                               /* NON-WILD COULDN'T FIT              */
      306      725    1           GOTO X$NOMATCH;
      307      726    1       CALL INDEX(TEMP,SUBSTR(NAME_WILD.NAME#,0,W),NAME_INP.NAME#); /* LOCATION  */

    726  0 000223   200017 631500                    EPPR1   TEMP,,AUTO
         0 000224   000000 633500                    EPPR3   0,,PR0
         0 000225   000000 623006                    EAX3    0,QL
         0 000226   200007 470500                    LDP0    N$,,AUTO
         0 000227   200010 720100                    LXL0    NLEN,,AUTO
         0 000230   000000 236003                    LDQ     0,DU
         0 000231   000000 701000 xent               TSX1    X66_INDEX
         0 000232   000000 011000                    NOP     0

      308      727    1       IF TEMP >= NLEN

    727  0 000233   200017 236100                    LDQ     TEMP,,AUTO
         0 000234   200010 116100                    CMPQ    NLEN,,AUTO
         0 000235   000507 605000 0                  TPL     X$NOMATCH

      309      728    1       THEN                            /* FIRST NON-WILD NOT THERE AT ALL    */
      310      729    1           GOTO X$NOMATCH;
      311      730    1       IF FPT_WILDCARD.CONTAINS#
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:41   

    730  0 000236   200003 471500                    LDP1    @FPT_WILDCARD,,AUTO
         0 000237   100011 236100                    LDQ     9,,PR1
         0 000240   000400 316003                    CANQ    256,DU
         0 000241   000250 600000 0                  TZE     s:738

      312      731    1       THEN
      313      732    1           IF W>=WLEN

    732  0 000242   200006 236100                    LDQ     W,,AUTO
         0 000243   200005 116100                    CMPQ    WLEN,,AUTO
         0 000244   000467 605000 0                  TPL     X$MATCH

      314      733    1           THEN                           /* ALL DONE IF NO WILDCARD */
      315      734    1               GOTO X$MATCH;
      316      735    1           ELSE                           /* FIRST NON-WILD CAN START AFTER 0   */
      317      736    1               N = W + TEMP;

    736  0 000245   200017 036100                    ADLQ    TEMP,,AUTO
         0 000246   200011 756100                    STQ     N,,AUTO
         0 000247   000254 710000 0                  TRA     s:746

      318      737    1       ELSE                                /* FIRST NON-WILD MUST START AT 0     */
      319      738    1           IF TEMP ~= 0

    738  0 000250   200017 235100                    LDA     TEMP,,AUTO
         0 000251   000507 601000 0                  TNZ     X$NOMATCH

      320      739    1           THEN                            /* FIRST NON-WILD NOT AT ZERO         */
      321      740    1               GOTO X$NOMATCH;
      322      741    1           ELSE                            /* FIRST NON-WILD AT ZERO, AS REQUIRED*/
      323      742    1               N=W;

    742  0 000252   200006 235100                    LDA     W,,AUTO
         0 000253   200011 755100                    STA     N,,AUTO

      324      743
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:42   
      325      744        /*  Check for the degenerate case of no wildcarding at all. */
      326      745
      327      746    1       IF W>=WLEN THEN

    746  0 000254   200006 236100                    LDQ     W,,AUTO
         0 000255   200005 116100                    CMPQ    WLEN,,AUTO
         0 000256   000263 604000 0                  TMI     X$NEXTSEG

      328      747    1           IF WLEN~=NLEN THEN

    747  0 000257   200005 236100                    LDQ     WLEN,,AUTO
         0 000260   200010 116100                    CMPQ    NLEN,,AUTO
         0 000261   000507 601000 0                  TNZ     X$NOMATCH

      329      748    1               GOTO X$NOMATCH;
      330      749    1           ELSE
      331      750    1               GOTO X$MATCH;

    750  0 000262   000467 710000 0                  TRA     X$MATCH

      332      751
      333      752    1   X$NEXTSEG:
      334      753
      335      754        /*  Skip over the wildcard character(s). */
      336      755
      337      756    2       DO WHILE(W<WLEN AND SUBSTR(NAME_WILD.NAME#,W,1)=WILD);

    756  0 000263   000265 710000 0     X$NEXTSEG    TRA     s:758

      338      757    2           W=W+1;

    757  0 000264   200006 054100                    AOS     W,,AUTO

      339      758    2       END;

    758  0 000265   200006 236100                    LDQ     W,,AUTO
         0 000266   200005 116100                    CMPQ    WLEN,,AUTO
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:43   
         0 000267   000275 605000 0                  TPL     s:762
         0 000270   200004 470500                    LDP0    W$,,AUTO
         0 000271   040100 106506                    CMPC    fill='040'O
         0 000272   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         0 000273   200024 000001                    ADSC9   WILD,,AUTO               cn=0,n=1
         0 000274   000264 600000 0                  TZE     s:757

      340      759
      341      760        /*  If we fell off the end of the pattern, we're done. */
      342      761
      343      762    1       IF W>=WLEN THEN

    762  0 000275   200005 116100                    CMPQ    WLEN,,AUTO
         0 000276   000434 605000 0                  TPL     X$COPYREST

      344      763    1           GOTO X$COPYREST;
      345      764
      346      765        /*  W points to the first non-wild character in the pattern.  N points
      347      766            to the starting position in the input string to start looking for
      348      767            a match.  Remember W in I and N in J for use later, then look for
      349      768            a string match. */
      350      769
      351      770    1       I=W;

    770  0 000277   200021 756100                    STQ     I,,AUTO

      352      771    1       J=N;

    771  0 000300   200011 235100                    LDA     N,,AUTO
         0 000301   200022 755100                    STA     J,,AUTO

      353      772    1       CALL INDEX(W,WILD,NAME_WILD.NAME#,W);

    772  0 000302   200005 236100                    LDQ     WLEN,,AUTO
         0 000303   200006 136100                    SBLQ    W,,AUTO
         0 000304   200030 756100                    STQ     NOMORE+3,,AUTO
         0 000305   200006 236100                    LDQ     W,,AUTO
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:44   
         0 000306   200004 470500                    LDP0    W$,,AUTO
         0 000307   200030 720100                    LXL0    NOMORE+3,,AUTO
         0 000310   200006 235100                    LDA     W,,AUTO
         0 000311   000100 124545                    SCM     mask='000'O
         0 000312   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         0 000313   200024 000001                    ADSC9   WILD,,AUTO               cn=0,n=1
         0 000314   200006 000100                    ARG     W,,AUTO
         0 000315   200006 056100                    ASQ     W,,AUTO

      354      773    1       IF W>=WLEN                          /* NO TRAILING WILD-TOKEN             */

    773  0 000316   200006 236100                    LDQ     W,,AUTO
         0 000317   200005 116100                    CMPQ    WLEN,,AUTO
         0 000320   000334 604000 0                  TMI     s:784
         0 000321   200003 471500                    LDP1    @FPT_WILDCARD,,AUTO
         0 000322   100011 236100                    LDQ     9,,PR1
         0 000323   000400 316003                    CANQ    256,DU
         0 000324   000334 601000 0                  TNZ     s:784

      355      774    1         AND NOT FPT_WILDCARD.CONTAINS#    /* AND IT MATTERS                     */
      356      775    1       THEN                               /* INPUT *MUST* END WITH NON-WILD PART*/
      357      776    1           N=MAXIMUM(N,NLEN-W+I);

    776  0 000325   200010 236100                    LDQ     NLEN,,AUTO
         0 000326   200006 136100                    SBLQ    W,,AUTO
         0 000327   200021 036100                    ADLQ    I,,AUTO
         0 000330   200011 116100                    CMPQ    N,,AUTO
         0 000331   000333 605000 0                  TPL     s:776+6
         0 000332   200011 236100                    LDQ     N,,AUTO
         0 000333   200011 756100                    STQ     N,,AUTO

      358      777
      359      778        /*  I points to the beginning of the non-wild string in the pattern;
      360      779            W points one past the end of the string.  Thus, W-I is the length
      361      780            of the string to find in the input string.  Now advance N by ones
      362      781            until either the remaining length of the string is shorter than
      363      782            W-I characters or a match is found. */
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:45   
      364      783
      365      784    1       L=W-I;

    784  0 000334   200006 236100                    LDQ     W,,AUTO
         0 000335   200021 136100                    SBLQ    I,,AUTO
         0 000336   200023 756100                    STQ     L,,AUTO

      366      785    2       DO WHILE(L<=NLEN-N);

    785  0 000337   000352 710000 0                  TRA     s:789

      367      786    2           IF SUBSTR(NAME_WILD.NAME#,I,L)=SUBSTR(NAME_INP.NAME#,N,L) THEN

    786  0 000340   200004 470500                    LDP0    W$,,AUTO
         0 000341   200023 720100                    LXL0    L,,AUTO
         0 000342   200021 235100                    LDA     I,,AUTO
         0 000343   200007 471500                    LDP1    N$,,AUTO
         0 000344   200011 236100                    LDQ     N,,AUTO
         0 000345   040146 106545                    CMPC    fill='040'O
         0 000346   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         0 000347   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
         0 000350   000357 600000 0                  TZE     X$SEGMATCH

      368      787    2               GOTO X$SEGMATCH;
      369      788    2           N=N+1;

    788  0 000351   200011 054100                    AOS     N,,AUTO

      370      789    2       END;

    789  0 000352   200010 236100                    LDQ     NLEN,,AUTO
         0 000353   200011 136100                    SBLQ    N,,AUTO
         0 000354   200023 116100                    CMPQ    L,,AUTO
         0 000355   000340 605000 0                  TPL     s:786

      371      790
      372      791        /*  No match was found before the end of the string. */
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:46   
      373      792
      374      793    1       GOTO X$NOMATCH;

    793  0 000356   000507 710000 0                  TRA     X$NOMATCH

      375      794
      376      795    1   X$SEGMATCH:
      377      796
      378      797        /*  At this point, N points to the beginning of a non-wild string in
      379      798            the input name which matches the non-wild string in the pattern.
      380      799            J points to the first non-matched character; thus N-J is the
      381      800            length of the input string which matches the wild part of the
      382      801            pattern (note that this may be zero characters).  If we are
      383      802            doing a format operation, move these N-J characters to the
      384      803            output string. */
      385      804
      386      805    2       IF MAX>0 AND N>J THEN DO;

    805  0 000357   200020 235100       X$SEGMATCH   LDA     MAX,,AUTO
         0 000360   000411 604400 0                  TMOZ    s:819
         0 000361   200022 116100                    CMPQ    J,,AUTO
         0 000362   000411 604400 0                  TMOZ    s:819

      387      806    2           L=N-J;

    806  0 000363   200022 136100                    SBLQ    J,,AUTO
         0 000364   200023 756100                    STQ     L,,AUTO

      388      807    2           IF L>MAX-U THEN

    807  0 000365   200020 236100                    LDQ     MAX,,AUTO
         0 000366   200016 136100                    SBLQ    U,,AUTO
         0 000367   200023 116100                    CMPQ    L,,AUTO
         0 000370   000515 604000 0                  TMI     X$TOOLONG

      389      808    2               GOTO X$TOOLONG;
      390      809    3           IF L>0 AND ~NOMORE THEN DO;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:47   

    809  0 000371   200023 236100                    LDQ     L,,AUTO
         0 000372   000411 604400 0                  TMOZ    s:819
         0 000373   200025 236100                    LDQ     NOMORE,,AUTO
         0 000374   400000 376003                    ANQ     -131072,DU
         0 000375   400000 676003                    ERQ     -131072,DU
         0 000376   000411 600000 0                  TZE     s:819

      391      810    3               CALL INSERT(NAME_OUT.NAME#,U,L,SUBSTR(NAME_INP.NAME#,J,L));

    810  0 000377   200023 720100                    LXL0    L,,AUTO
         0 000400   200022 236100                    LDQ     J,,AUTO
         0 000401   200015 473500                    LDP3    U$,,AUTO
         0 000402   200016 235100                    LDA     U,,AUTO
         0 000403   040145 100546                    MLR     fill='040'O
         0 000404   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
         0 000405   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0

      392      811    3               U=U+L;

    811  0 000406   200016 236100                    LDQ     U,,AUTO
         0 000407   200023 036100                    ADLQ    L,,AUTO
         0 000410   200016 756100                    STQ     U,,AUTO

      393      812    3           END;

      394      813    2       END;

      395      814
      396      815        /*  Bump the input pointer past the end of the matched string.  Then
      397      816            move the next non-wild segment of the pattern to the output area,
      398      817            if we are formatting an output string. */
      399      818
      400      819    1       N=N+W-I;

    819  0 000411   200011 236100                    LDQ     N,,AUTO
         0 000412   200006 036100                    ADLQ    W,,AUTO
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:48   
         0 000413   200021 136100                    SBLQ    I,,AUTO
         0 000414   200011 756100                    STQ     N,,AUTO

      401      820    1       IF MAX>0 THEN

    820  0 000415   200020 235100                    LDA     MAX,,AUTO
         0 000416   000421 604400 0                  TMOZ    s:826

      402      821    1           CALL DTOU ALTRET(X$TOOLONG);

    821  0 000417   000523 701000 0                  TSX1    DTOU
         0 000420   000515 702000 0                  TSX2    X$TOOLONG

      403      822
      404      823        /*  If we have not completed scanning the pattern string, loop back
      405      824            to the next segment routine. */
      406      825
      407      826    1       IF W<WLEN THEN

    826  0 000421   200006 236100                    LDQ     W,,AUTO
         0 000422   200005 116100                    CMPQ    WLEN,,AUTO
         0 000423   000263 604000 0                  TMI     X$NEXTSEG

      408      827    1           GOTO X$NEXTSEG;
      409      828
      410      829        /*  The pattern string is exhausted; if the name is not exhausted,
      411      830            too, the strings do not match.  The exception is 'CONTAINS'
      412      831            which allows the pattern to end early. */
      413      832
      414      833    1       IF N<NLEN                           /* IF PATTERN ENDS EARLY              */

    833  0 000424   200011 236100                    LDQ     N,,AUTO
         0 000425   200010 116100                    CMPQ    NLEN,,AUTO
         0 000426   000433 605000 0                  TPL     s:840
         0 000427   200003 470500                    LDP0    @FPT_WILDCARD,,AUTO
         0 000430   000011 236100                    LDQ     9,,PR0
         0 000431   000400 316003                    CANQ    256,DU
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:49   
         0 000432   000507 600000 0                  TZE     X$NOMATCH

      415      834    1         AND NOT FPT_WILDCARD.CONTAINS#    /* AND IT MATTERS                     */
      416      835    1       THEN
      417      836    1           GOTO X$NOMATCH;
      418      837
      419      838        /*  The input string matched the pattern.  We're mostly done! */
      420      839
      421      840    1       GOTO X$MATCH;

    840  0 000433   000467 710000 0                  TRA     X$MATCH

      422      841        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:50   
      423      842    1   X$COPYREST:
      424      843
      425      844        /*  The pattern ended in a wildcard; therefore, it matches the rest
      426      845            of the input string.  Move the rest of the name to the output
      427      846            area (if formatting). */
      428      847
      429      848    2       IF MAX>0 THEN DO;

    848  0 000434   200020 235100       X$COPYREST   LDA     MAX,,AUTO
         0 000435   000467 604400 0                  TMOZ    X$MATCH

      430      849    3           IF N<NLEN AND ~NOMORE THEN DO;

    849  0 000436   200011 236100                    LDQ     N,,AUTO
         0 000437   200010 116100                    CMPQ    NLEN,,AUTO
         0 000440   000467 605000 0                  TPL     X$MATCH
         0 000441   200025 236100                    LDQ     NOMORE,,AUTO
         0 000442   400000 376003                    ANQ     -131072,DU
         0 000443   400000 676003                    ERQ     -131072,DU
         0 000444   000467 600000 0                  TZE     X$MATCH

      431      850    3               L=NLEN-N;

    850  0 000445   200010 236100                    LDQ     NLEN,,AUTO
         0 000446   200011 136100                    SBLQ    N,,AUTO
         0 000447   200023 756100                    STQ     L,,AUTO

      432      851    3               IF L>MAX-U THEN

    851  0 000450   200020 236100                    LDQ     MAX,,AUTO
         0 000451   200016 136100                    SBLQ    U,,AUTO
         0 000452   200023 116100                    CMPQ    L,,AUTO
         0 000453   000515 604000 0                  TMI     X$TOOLONG

      433      852    3                   GOTO X$TOOLONG;
      434      853    3               CALL INSERT(NAME_OUT.NAME#,U,L,SUBSTR(NAME_INP.NAME#,N,L));

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:51   
    853  0 000454   200007 470500                    LDP0    N$,,AUTO
         0 000455   200023 720100                    LXL0    L,,AUTO
         0 000456   200011 236100                    LDQ     N,,AUTO
         0 000457   200015 471500                    LDP1    U$,,AUTO
         0 000460   200016 235100                    LDA     U,,AUTO
         0 000461   040145 100546                    MLR     fill='040'O
         0 000462   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
         0 000463   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0

      435      854    3               U=U+L;

    854  0 000464   200016 236100                    LDQ     U,,AUTO
         0 000465   200023 036100                    ADLQ    L,,AUTO
         0 000466   200016 756100                    STQ     U,,AUTO

      436      855    3           END;

      437      856    2       END;

      438      857
      439      858    1   X$MATCH:
      440      859        /*  We have a match!  Now move the rest of the template string (if any)
      441      860            to the output string (if formatting). */
      442      861    1       IF MAX>0 THEN

    861  0 000467   200020 235100       X$MATCH      LDA     MAX,,AUTO
         0 000470   000501 604400 0                  TMOZ    s:868

      443      862    2       DO;

      444      863    3           DO WHILE (NOT NOMORE);

    863  0 000471   000474 710000 0                  TRA     s:865

      445      864    3               CALL DTOU ALTRET(X$TOOLONG);

    864  0 000472   000523 701000 0                  TSX1    DTOU
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:52   
         0 000473   000515 702000 0                  TSX2    X$TOOLONG

      446      865    3           END;

    865  0 000474   200025 234100                    SZN     NOMORE,,AUTO
         0 000475   000472 605000 0                  TPL     s:864

      447      866    2           FPT_WILDCARD.OUTPUT_LEN=U;

    866  0 000476   200016 235100                    LDA     U,,AUTO
         0 000477   200003 470500                    LDP0    @FPT_WILDCARD,,AUTO
         0 000500   000012 755100                    STA     10,,PR0

      448      867    2       END;

      449      868    1       FPT_WILDCARD.ERROR.ERR#=%E$XUW#WILD_OK;

    868  0 000501   200003 470500                    LDP0    @FPT_WILDCARD,,AUTO
         0 000502   000010 236100                    LDQ     8,,PR0
         0 000503   000000 376000 1                  ANQ     0
         0 000504   003720 276007                    ORQ     2000,DL
         0 000505   000010 756100                    STQ     8,,PR0

      450      869    1       RETURN;

    869  0 000506   000000 702200 xent               TSX2  ! X66_ARET

      451      870
      452      871    1   X$NOMATCH:
      453      872    1       FPT_WILDCARD.ERROR.ERR#=%E$XUW#NOMATCH;

    872  0 000507   200003 470500       X$NOMATCH    LDP0    @FPT_WILDCARD,,AUTO
         0 000510   000010 236100                    LDQ     8,,PR0
         0 000511   000000 376000 1                  ANQ     0
         0 000512   004000 276007                    ORQ     2048,DL
         0 000513   000010 756100                    STQ     8,,PR0

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:53   
      454      873    1       ALTRETURN;

    873  0 000514   000000 702200 xent               TSX2  ! X66_AALT

      455      874
      456      875    1   X$TOOLONG:
      457      876    1       FPT_WILDCARD.ERROR.ERR#=%E$XUW#TOOLONG;

    876  0 000515   200003 470500       X$TOOLONG    LDP0    @FPT_WILDCARD,,AUTO
         0 000516   000010 236100                    LDQ     8,,PR0
         0 000517   000000 376000 1                  ANQ     0
         0 000520   004010 276007                    ORQ     2056,DL
         0 000521   000010 756100                    STQ     8,,PR0

      458      877    1       ALTRETURN;

    877  0 000522   000000 702200 xent               TSX2  ! X66_AALT

      459      878
      460      879        %EJECT;
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:54   
      461      880    1   DTOU: PROC ALTRET;

    880  0 000523   200026 741300       DTOU         STX1  ! NOMORE+1,,AUTO

      462      881
      463      882        /* *******************************************************************
      464      883        *                                                                    *
      465      884        *   Copy the template from the character at D up to, but not         *
      466      885        *   including the next wildcard string, to the output string.        *
      467      886        *   Check that this portion fits, ALTRET if it doesn't.  Bump        *
      468      887        *   the U and D pointers by the number of characters moved.          *
      469      888        *                                                                    *
      470      889        ******************************************************************* */
      471      890
      472      891    3       IF D<DLEN THEN DO;

    891  0 000524   200014 236100                    LDQ     D,,AUTO
         0 000525   200013 116100                    CMPQ    DLEN,,AUTO
         0 000526   000603 605000 0                  TPL     s:906

      473      892    3           CALL INDEX(I,WILD,NAME_DEST.NAME#,D);

    892  0 000527   200013 236100                    LDQ     DLEN,,AUTO
         0 000530   200014 136100                    SBLQ    D,,AUTO
         0 000531   200030 756100                    STQ     NOMORE+3,,AUTO
         0 000532   200014 236100                    LDQ     D,,AUTO
         0 000533   200012 470500                    LDP0    D$,,AUTO
         0 000534   200030 720100                    LXL0    NOMORE+3,,AUTO
         0 000535   200014 235100                    LDA     D,,AUTO
         0 000536   000100 124545                    SCM     mask='000'O
         0 000537   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         0 000540   200024 000001                    ADSC9   WILD,,AUTO               cn=0,n=1
         0 000541   200021 000100                    ARG     I,,AUTO
         0 000542   200021 056100                    ASQ     I,,AUTO

      474      893    3           IF I>=DLEN THEN

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:55   
    893  0 000543   200021 236100                    LDQ     I,,AUTO
         0 000544   200013 116100                    CMPQ    DLEN,,AUTO
         0 000545   000550 604000 0                  TMI     s:895

      475      894    3               NOMORE='1'B;

    894  0 000546   400000 236003                    LDQ     -131072,DU
         0 000547   200025 756100                    STQ     NOMORE,,AUTO

      476      895    3           L=I-D;

    895  0 000550   200021 236100                    LDQ     I,,AUTO
         0 000551   200014 136100                    SBLQ    D,,AUTO
         0 000552   200023 756100                    STQ     L,,AUTO

      477      896    3           IF L>MAX-U THEN

    896  0 000553   200020 236100                    LDQ     MAX,,AUTO
         0 000554   200016 136100                    SBLQ    U,,AUTO
         0 000555   200023 116100                    CMPQ    L,,AUTO
         0 000556   000560 605000 0                  TPL     s:898

      478      897    3               ALTRETURN;

    897  0 000557   000000 702211                    TSX2  ! 0,X1

      479      898    3           IF L>0 THEN

    898  0 000560   200023 236100                    LDQ     L,,AUTO
         0 000561   000571 604400 0                  TMOZ    s:900

      480      899    3               CALL INSERT(NAME_OUT.NAME#,U,L,SUBSTR(NAME_DEST.NAME#,D,L));

    899  0 000562   000000 620006                    EAX0    0,QL
         0 000563   200015 471500                    LDP1    U$,,AUTO
         0 000564   200023 722100                    LXL2    L,,AUTO
         0 000565   200016 236100                    LDQ     U,,AUTO
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:56   
         0 000566   040146 100545                    MLR     fill='040'O
         0 000567   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         0 000570   100000 000012                    ADSC9   0,Q,PR1                  cn=0,n=*X2

      481      900    3           U=U+L;

    900  0 000571   200016 236100                    LDQ     U,,AUTO
         0 000572   200023 036100                    ADLQ    L,,AUTO
         0 000573   200016 756100                    STQ     U,,AUTO

      482      901    3           D=I;

    901  0 000574   200021 235100                    LDA     I,,AUTO
         0 000575   200014 755100                    STA     D,,AUTO

      483      902    3           IF D<DLEN THEN

    902  0 000576   200014 236100                    LDQ     D,,AUTO
         0 000577   200013 116100                    CMPQ    DLEN,,AUTO
         0 000600   000605 605000 0                  TPL     s:907

      484      903    3               D=D+1;

    903  0 000601   200014 054100                    AOS     D,,AUTO

      485      904    3       END;

    904  0 000602   000605 710000 0                  TRA     s:907

      486      905    2       ELSE
      487      906    2           NOMORE='1'B;

    906  0 000603   400000 236003                    LDQ     -131072,DU
         0 000604   200025 756100                    STQ     NOMORE,,AUTO

      488      907    2       RETURN;

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:57   
    907  0 000605   200026 221300                    LDX1  ! NOMORE+1,,AUTO
         0 000606   000001 702211                    TSX2  ! 1,X1
      489      908    2   END;
      490      909
      491      910    1   END;
      492      911        %EOD;

PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:58   
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XUW_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure X$WILDFMT.
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:59   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPT_WILDCARD             14-0-0/w SBIN        r     1 D
    12-0-0/w PTR         r     1 D$                        13-0-0/w SBIN        r     1 DLEN
    *0-0-0/d STRC(432)   r     1 FPT_WILDCARD              21-0-0/w SBIN        r     1 I
    22-0-0/w SBIN        r     1 J                         23-0-0/w SBIN        r     1 L
    20-0-0/w SBIN        r     1 MAX                       11-0-0/w SBIN        r     1 N
     7-0-0/w PTR         r     1 N$                        10-0-0/w SBIN        r     1 NLEN
    25-0-0/b BIT         r     1 NOMORE                    17-0-0/w SBIN        r     1 TEMP
    16-0-0/w SBIN        r     1 U                         15-0-0/w PTR         r     1 U$
     6-0-0/w SBIN        r     1 W                          4-0-0/w PTR         r     1 W$
    24-0-0/c CHAR        r     1 WILD                       5-0-0/w SBIN        r     1 WLEN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(0)     r     1 NAME_DEST                  0-0-0/c ASTR(0)     r     1 NAME_INP
     0-0-0/c ASTR(0)     r     1 NAME_OUT                   0-0-0/c ASTR(0)     r     1 NAME_WILD


   Procedure X$WILDFMT requires 391 words for executable code.
   Procedure X$WILDFMT requires 26 words of local(AUTO) storage.
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:60   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:61   
          MINI XREF LISTING

D
       522**DCL       706<<ASSIGN    891>>IF        892>>CALLBLT   895>>ASSIGN    899>>CALLBLT   901<<ASSIGN
       902>>IF        903<<ASSIGN    903>>ASSIGN
D$
       520**DCL       523--IMP-PTR   591<<ASSIGN    593>>IF        685<<ASSIGN    892>>CALLBLT   899>>CALLBLT
DLEN
       521**DCL       524--IMP-SIZ   592<<ASSIGN    593>>IF        689<<ASSIGN    891>>IF        892>>CALLBLT
       893>>IF        899>>CALLBLT   902>>IF
DTOU
       880**PROC      713--CALL      821--CALL      864--CALL
FPT_WILDCARD
       467**DCL         8--PROC      615--ENTRY
FPT_WILDCARD.CONTAINS#
       495**DCL       730>>IF        773>>IF        833>>IF
FPT_WILDCARD.ERROR.ERR#
       492**DCL       575<<ASSIGN    585<<ASSIGN    595<<ASSIGN    603<<ASSIGN    671<<ASSIGN    681<<ASSIGN
       868<<ASSIGN    872<<ASSIGN    876<<ASSIGN
FPT_WILDCARD.ERROR.FCG
       489**DCL       699<<ASSIGN
FPT_WILDCARD.ERROR.MID
       490**DCL       700<<ASSIGN
FPT_WILDCARD.ERROR.MON
       491**DCL       701<<ASSIGN
FPT_WILDCARD.ERROR.SEV
       493**DCL       702<<ASSIGN
FPT_WILDCARD.INPUT_.BOUND
       474**DCL       582>>ASSIGN    678>>ASSIGN
FPT_WILDCARD.INPUT_.INPUT$
       477**DCL       581>>ASSIGN    677>>ASSIGN
FPT_WILDCARD.OUTPUT_.BOUND
       484**DCL       606>>ASSIGN
FPT_WILDCARD.OUTPUT_.OUTPUT$
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:62   
       487**DCL       601>>ASSIGN
FPT_WILDCARD.OUTPUT_LEN
       498**DCL       866<<ASSIGN
FPT_WILDCARD.PATTERN_.BOUND
       469**DCL       572>>ASSIGN    668>>ASSIGN
FPT_WILDCARD.PATTERN_.PATTERN$
       472**DCL       571>>ASSIGN    667>>ASSIGN
FPT_WILDCARD.TEMPLATE_.BOUND
       479**DCL       592>>ASSIGN
FPT_WILDCARD.TEMPLATE_.TEMPLATE$
       482**DCL       591>>ASSIGN
FPT_WILDCARD.WILD_CHAR#
       494**DCL       610>>ASSIGN    690>>ASSIGN
I
       537**DCL       770<<ASSIGN    776>>ASSIGN    784>>ASSIGN    786>>IF        819>>ASSIGN    892<<CALLBLT
       893>>IF        895>>ASSIGN    901>>ASSIGN
J
       538**DCL       771<<ASSIGN    805>>IF        806>>ASSIGN    810>>CALLBLT
L
       539**DCL       784<<ASSIGN    785>>DOWHILE   786>>IF        786>>IF        806<<ASSIGN    807>>IF
       809>>IF        810>>CALLBLT   810>>CALLBLT   811>>ASSIGN    850<<ASSIGN    851>>IF        853>>CALLBLT
       853>>CALLBLT   854>>ASSIGN    895<<ASSIGN    896>>IF        898>>IF        899>>CALLBLT   899>>CALLBLT
       900>>ASSIGN
MAX
       536**DCL       531--IMP-SIZ   606<<ASSIGN    607>>IF        608<<ASSIGN    687<<ASSIGN    712>>IF
       805>>IF        807>>IF        810>>CALLBLT   820>>IF        848>>IF        851>>IF        853>>CALLBLT
       861>>IF        896>>IF        899>>CALLBLT
N
       514**DCL       705<<ASSIGN    736<<ASSIGN    742<<ASSIGN    771>>ASSIGN    776<<ASSIGN    776>>ASSIGN
       785>>DOWHILE   786>>IF        788<<ASSIGN    788>>ASSIGN    805>>IF        806>>ASSIGN    819<<ASSIGN
       819>>ASSIGN    833>>IF        849>>IF        850>>ASSIGN    853>>CALLBLT
N$
       512**DCL       515--IMP-PTR   581<<ASSIGN    583>>IF        677<<ASSIGN    679>>IF        726>>CALLBLT
       786>>IF        810>>CALLBLT   853>>CALLBLT
NAME_DEST.NAME#
       524**DCL       892>>CALLBLT   899>>CALLBLT
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:63   
NAME_INP.NAME#
       516**DCL       726>>CALLBLT   786>>IF        810>>CALLBLT   853>>CALLBLT
NAME_OUT.NAME#
       531**DCL       810<<CALLBLT   853<<CALLBLT   899<<CALLBLT
NAME_WILD.NAME#
       508**DCL       717>>IF        722>>CALLBLT   726>>CALLBLT   756>>DOWHILE   772>>CALLBLT   786>>IF
NLEN
       513**DCL       516--IMP-SIZ   582<<ASSIGN    583>>IF        678<<ASSIGN    679>>IF        723>>IF
       726>>CALLBLT   727>>IF        747>>IF        776>>ASSIGN    785>>DOWHILE   786>>IF        810>>CALLBLT
       833>>IF        849>>IF        850>>ASSIGN    853>>CALLBLT
NOMORE
       541**DCL       708<<ASSIGN    809>>IF        849>>IF        863>>DOWHILE   894<<ASSIGN    906<<ASSIGN
TEMP
       535**DCL       726<<CALLBLT   727>>IF        736>>ASSIGN    738>>IF
U
       529**DCL       707<<ASSIGN    807>>IF        810>>CALLBLT   811<<ASSIGN    811>>ASSIGN    851>>IF
       853>>CALLBLT   854<<ASSIGN    854>>ASSIGN    866>>ASSIGN    896>>IF        899>>CALLBLT   900<<ASSIGN
       900>>ASSIGN
U$
       528**DCL       530--IMP-PTR   601<<ASSIGN    602>>IF        686<<ASSIGN    810>>CALLBLT   853>>CALLBLT
       899>>CALLBLT
W
       506**DCL       704<<ASSIGN    722<<CALLBLT   723>>IF        726>>CALLBLT   732>>IF        736>>ASSIGN
       742>>ASSIGN    746>>IF        756>>DOWHILE   756>>DOWHILE   757<<ASSIGN    757>>ASSIGN    762>>IF
       770>>ASSIGN    772<<CALLBLT   772>>CALLBLT   773>>IF        776>>ASSIGN    784>>ASSIGN    819>>ASSIGN
       826>>IF
W$
       504**DCL       507--IMP-PTR   571<<ASSIGN    573>>IF        667<<ASSIGN    669>>IF        717>>IF
       722>>CALLBLT   726>>CALLBLT   756>>DOWHILE   772>>CALLBLT   786>>IF
WILD
       540**DCL       610<<ASSIGN    690<<ASSIGN    717>>IF        722>>CALLBLT   756>>DOWHILE   772>>CALLBLT
       892>>CALLBLT
WLEN
       505**DCL       508--IMP-SIZ   572<<ASSIGN    573>>IF        668<<ASSIGN    669>>IF        717>>IF
       722>>CALLBLT   726>>CALLBLT   732>>IF        746>>IF        747>>IF        756>>DOWHILE   756>>DOWHILE
       762>>IF        772>>CALLBLT   773>>IF        786>>IF        826>>IF
PL6.E3A0      #001=X$WILDFMT File=XUW$WILD.:E05TSI                               WED 07/30/97 09:45 Page:64   
X$COPYREST
       848**LABEL     763--GOTO
X$MATCH
       861**LABEL     734--GOTO      750--GOTO      840--GOTO
X$NEXTSEG
       756**LABEL     718--GOTO      827--GOTO
X$NOMATCH
       872**LABEL     725--GOTO      729--GOTO      740--GOTO      748--GOTO      793--GOTO      836--GOTO
X$SEGMATCH
       805**LABEL     787--GOTO
X$TOOLONG
       876**LABEL     713--CALLALT   808--GOTO      821--CALLALT   852--GOTO      864--CALLALT
X$WILDCOM
       699**LABEL     612--GOTO

PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:65   
      493        1        /*T***********************************************************/
      494        2        /*T*                                                         */
      495        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      496        4        /*T*                                                         */
      497        5        /*T***********************************************************/
      498        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
      499        7        X$WILDTFMT: PROC(INPUT,PATTERN,TEMPLATE,OUTPUT,ERROR,CONTAINS) ALTRET;
      500        8
      501        9
      502       10        /*********************************************************************
      503       11        *                                                                    *
      504       12        *   X$WILDTFMT is a simplified interface to X$WILDFMT based on       *
      505       13        *   TEXT$C strings.                                                  *
      506       14        *                                                                    *
      507       15        **********************************************************************/
      508       16
      509       17        /**/
      510       18        /*  INCLUDES  */
      511       19        /**/
      512       20        %INCLUDE XUW_MACRO_C;
      513      155        /**/
      514      156        /*  PARAMETERS  */
      515      157        /**/
      516      158    1   DCL 1 INPUT CALIGNED,
      517      159    1         2 C UBIN BYTE CALIGNED,
      518      160    1         2 TEXT CHAR(INPUT.C) CALIGNED;
      519      161    1   DCL 1 PATTERN CALIGNED,
      520      162    1         2 C UBIN BYTE CALIGNED,
      521      163    1         2 TEXT CHAR(PATTERN.C) CALIGNED;
      522      164    1   DCL 1 TEMPLATE CALIGNED,
      523      165    1         2 C UBIN BYTE CALIGNED,
      524      166    1         2 TEXT CHAR(TEMPLATE.C) CALIGNED;
      525      167    1   DCL 1 OUTPUT CALIGNED,
      526      168    1         2 C UBIN BYTE CALIGNED,
      527      169    1         2 TEXT CHAR(OUTPUT.C) CALIGNED;
      528      170    1   DCL ERROR BIT(36) WALIGNED;
      529      171    1   DCL CONTAINS BIT(1) WALIGNED;
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:66   
      530      172        /**/
      531      173        /*  LOCAL AUTO  */
      532      174        /**/
      533      175        %XUW_WILDCARD (FPTN = FPT_WILDCARD,
      534      176                       STCLASS = AUTO);
      535      272        /**/
      536      273        /*  GLOBAL CONSTANT  */
      537      274        /**/
      538      275        %XUW_WILDCARD (FPTN = XUW_IFPT_WILDCARD,
      539      276                       STCLASS = CONSTANT);
      540      372        /**/
      541      373        /*  ENTRY DCLS  */
      542      374        /**/
      543      375        %XUW_ENTRIES (OMIT=X$WILDTFMT);
      544      387        %EJECT;
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:67   
      545      388    1       FPT_WILDCARD = XUW_IFPT_WILDCARD;
      546      389    1       FPT_WILDCARD.INPUT_ = VECTOR(INPUT.TEXT);
      547      390    1       FPT_WILDCARD.PATTERN_ = VECTOR(PATTERN.TEXT);
      548      391    1       FPT_WILDCARD.TEMPLATE_ = VECTOR(TEMPLATE.TEXT);
      549      392    1       FPT_WILDCARD.OUTPUT_ = VECTOR(OUTPUT.TEXT);
      550      393    1       IF ADDR(CONTAINS) = ADDR(NIL) THEN
      551      394    1           FPT_WILDCARD.CONTAINS# = '0'B;  /* DEFAULT                            */
      552      395    1       ELSE
      553      396    1           FPT_WILDCARD.CONTAINS# = CONTAINS; /* PASSED VALUE                     */
      554      397        /**/
      555      398    1       CALL X$WILDFMT (FPT_WILDCARD) ALTRET(OOPS);
      556      399        /**/
      557      400    1       ERROR = FPT_WILDCARD.ERROR;
      558      401    1       OUTPUT.C = FPT_WILDCARD.OUTPUT_LEN;
      559      402    1       RETURN;
      560      403        /**/
      561      404    1   OOPS: ;
      562      405    1       ERROR = FPT_WILDCARD.ERROR;
      563      406    1       ALTRETURN;
      564      407        /**/
      565      408    1   END X$WILDTFMT;
      566      409        %EOD;

PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:68   
--  Include file information  --

   XUW_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure X$WILDTFMT.

   Procedure X$WILDTFMT requires 79 words for executable code.
   Procedure X$WILDTFMT requires 24 words of local(AUTO) storage.

PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:69   

 Object Unit name= X$WILDTFMT                                 File name= XUW$WILD.:E05TOU
 UTS= JUL 30 '97 09:45:54.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     12     14  X$WILDTFMT
    1   Proc  even  none    79    117  X$WILDTFMT
    2  RoData even  none     1      1  X$WILDTFMT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        6  X$WILDTFMT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 X$WILDFMT
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:70   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:71   


      493        1        /*T***********************************************************/
      494        2        /*T*                                                         */
      495        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      496        4        /*T*                                                         */
      497        5        /*T***********************************************************/
      498        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
      499        7        X$WILDTFMT: PROC(INPUT,PATTERN,TEMPLATE,OUTPUT,ERROR,CONTAINS) ALTRET;

      7  1 000000   000000 700200 xent  X$WILDTFMT   TSX0  ! X66_AUTO_N
         1 000001   000030 000006                    ZERO    24,6

      500        8
      501        9
      502       10        /*********************************************************************
      503       11        *                                                                    *
      504       12        *   X$WILDTFMT is a simplified interface to X$WILDFMT based on       *
      505       13        *   TEXT$C strings.                                                  *
      506       14        *                                                                    *
      507       15        **********************************************************************/
      508       16
      509       17        /**/
      510       18        /*  INCLUDES  */
      511       19        /**/
      512       20        %INCLUDE XUW_MACRO_C;
      513      155        /**/
      514      156        /*  PARAMETERS  */
      515      157        /**/
      516      158    1   DCL 1 INPUT CALIGNED,
      517      159    1         2 C UBIN BYTE CALIGNED,
      518      160    1         2 TEXT CHAR(INPUT.C) CALIGNED;
      519      161    1   DCL 1 PATTERN CALIGNED,
      520      162    1         2 C UBIN BYTE CALIGNED,
      521      163    1         2 TEXT CHAR(PATTERN.C) CALIGNED;
      522      164    1   DCL 1 TEMPLATE CALIGNED,
      523      165    1         2 C UBIN BYTE CALIGNED,
      524      166    1         2 TEXT CHAR(TEMPLATE.C) CALIGNED;
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:72   
      525      167    1   DCL 1 OUTPUT CALIGNED,
      526      168    1         2 C UBIN BYTE CALIGNED,
      527      169    1         2 TEXT CHAR(OUTPUT.C) CALIGNED;
      528      170    1   DCL ERROR BIT(36) WALIGNED;
      529      171    1   DCL CONTAINS BIT(1) WALIGNED;
      530      172        /**/
      531      173        /*  LOCAL AUTO  */
      532      174        /**/
      533      175        %XUW_WILDCARD (FPTN = FPT_WILDCARD,
      534      176                       STCLASS = AUTO);
      535      272        /**/
      536      273        /*  GLOBAL CONSTANT  */
      537      274        /**/
      538      275        %XUW_WILDCARD (FPTN = XUW_IFPT_WILDCARD,
      539      276                       STCLASS = CONSTANT);
      540      372        /**/
      541      373        /*  ENTRY DCLS  */
      542      374        /**/
      543      375        %XUW_ENTRIES (OMIT=X$WILDTFMT);
      544      387        %EJECT;
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:73   
      545      388    1       FPT_WILDCARD = XUW_IFPT_WILDCARD;

    388  1 000002   000100 100400                    MLR     fill='000'O
         1 000003   000000 000060 0                  ADSC9   XUW_IFPT_WILDCARD        cn=0,n=48
         1 000004   200012 000060                    ADSC9   FPT_WILDCARD,,AUTO       cn=0,n=48

      546      389    1       FPT_WILDCARD.INPUT_ = VECTOR(INPUT.TEXT);

    389  1 000005   200003 470500                    LDP0    @INPUT,,AUTO
         1 000006   000100 101500                    MRL     fill='000'O
         1 000007   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000010   200026 000002                    ADSC9   FPT_WILDCARD+12,,AUTO    cn=0,n=2
         1 000011   200026 220100                    LDX0    FPT_WILDCARD+12,,AUTO
         1 000012   000000 635010                    EAA     0,X0
         1 000013   000002 771000                    ARL     2
         1 000014   000140 135007                    SBLA    96,DL
         1 000015   200003 236100                    LDQ     @INPUT,,AUTO
         1 000016   200000 036007                    ADLQ    65536,DL
         1 000017   200014 757100                    STAQ    FPT_WILDCARD+2,,AUTO

      547      390    1       FPT_WILDCARD.PATTERN_ = VECTOR(PATTERN.TEXT);

    390  1 000020   200004 471500                    LDP1    @PATTERN,,AUTO
         1 000021   000100 101500                    MRL     fill='000'O
         1 000022   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000023   200026 000002                    ADSC9   FPT_WILDCARD+12,,AUTO    cn=0,n=2
         1 000024   200026 220100                    LDX0    FPT_WILDCARD+12,,AUTO
         1 000025   000000 635010                    EAA     0,X0
         1 000026   000002 771000                    ARL     2
         1 000027   000140 135007                    SBLA    96,DL
         1 000030   200004 236100                    LDQ     @PATTERN,,AUTO
         1 000031   200000 036007                    ADLQ    65536,DL
         1 000032   200012 757100                    STAQ    FPT_WILDCARD,,AUTO

      548      391    1       FPT_WILDCARD.TEMPLATE_ = VECTOR(TEMPLATE.TEXT);

    391  1 000033   200005 473500                    LDP3    @TEMPLATE,,AUTO
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:74   
         1 000034   000100 101500                    MRL     fill='000'O
         1 000035   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000036   200026 000002                    ADSC9   FPT_WILDCARD+12,,AUTO    cn=0,n=2
         1 000037   200026 220100                    LDX0    FPT_WILDCARD+12,,AUTO
         1 000040   000000 635010                    EAA     0,X0
         1 000041   000002 771000                    ARL     2
         1 000042   000140 135007                    SBLA    96,DL
         1 000043   200005 236100                    LDQ     @TEMPLATE,,AUTO
         1 000044   200000 036007                    ADLQ    65536,DL
         1 000045   200016 757100                    STAQ    FPT_WILDCARD+4,,AUTO

      549      392    1       FPT_WILDCARD.OUTPUT_ = VECTOR(OUTPUT.TEXT);

    392  1 000046   200006 474500                    LDP4    @OUTPUT,,AUTO
         1 000047   000100 101500                    MRL     fill='000'O
         1 000050   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         1 000051   200026 000002                    ADSC9   FPT_WILDCARD+12,,AUTO    cn=0,n=2
         1 000052   200026 220100                    LDX0    FPT_WILDCARD+12,,AUTO
         1 000053   000000 635010                    EAA     0,X0
         1 000054   000002 771000                    ARL     2
         1 000055   000140 135007                    SBLA    96,DL
         1 000056   200006 236100                    LDQ     @OUTPUT,,AUTO
         1 000057   200000 036007                    ADLQ    65536,DL
         1 000060   200020 757100                    STAQ    FPT_WILDCARD+6,,AUTO

      550      393    1       IF ADDR(CONTAINS) = ADDR(NIL) THEN

    393  1 000061   200010 236100                    LDQ     @CONTAINS,,AUTO
         1 000062   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000063   000067 601000 1                  TNZ     s:396

      551      394    1           FPT_WILDCARD.CONTAINS# = '0'B;  /* DEFAULT                            */

    394  1 000064   000000 236000 2                  LDQ     0
         1 000065   200023 356100                    ANSQ    FPT_WILDCARD+9,,AUTO
         1 000066   000075 710000 1                  TRA     s:398

PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:75   
      552      395    1       ELSE
      553      396    1           FPT_WILDCARD.CONTAINS# = CONTAINS; /* PASSED VALUE                     */

    396  1 000067   200010 475500                    LDP5    @CONTAINS,,AUTO
         1 000070   500000 236100                    LDQ     0,,PR5
         1 000071   000011 772000                    QRL     9
         1 000072   200023 676100                    ERQ     FPT_WILDCARD+9,,AUTO
         1 000073   000400 376003                    ANQ     256,DU
         1 000074   200023 656100                    ERSQ    FPT_WILDCARD+9,,AUTO

      554      397        /**/
      555      398    1       CALL X$WILDFMT (FPT_WILDCARD) ALTRET(OOPS);

    398  1 000075   200012 635500                    EPPR5   FPT_WILDCARD,,AUTO
         1 000076   200026 455500                    STP5    FPT_WILDCARD+12,,AUTO
         1 000077   200026 630500                    EPPR0   FPT_WILDCARD+12,,AUTO
         1 000100   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000101   000000 701000 xent               TSX1    X$WILDFMT
         1 000102   000113 702000 1                  TSX2    OOPS

      556      399        /**/
      557      400    1       ERROR = FPT_WILDCARD.ERROR;

    400  1 000103   200022 236100                    LDQ     FPT_WILDCARD+8,,AUTO
         1 000104   200007 470500                    LDP0    @ERROR,,AUTO
         1 000105   000000 756100                    STQ     0,,PR0

      558      401    1       OUTPUT.C = FPT_WILDCARD.OUTPUT_LEN;

    401  1 000106   200006 471500                    LDP1    @OUTPUT,,AUTO
         1 000107   000100 101500                    MRL     fill='000'O
         1 000110   200024 000004                    ADSC9   FPT_WILDCARD+10,,AUTO    cn=0,n=4
         1 000111   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      559      402    1       RETURN;

    402  1 000112   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:76   

    401  1 000113                       OOPS         null
      560      403        /**/
      561      404    1   OOPS: ;
      562      405    1       ERROR = FPT_WILDCARD.ERROR;

    405  1 000113   200022 236100                    LDQ     FPT_WILDCARD+8,,AUTO
         1 000114   200007 470500                    LDP0    @ERROR,,AUTO
         1 000115   000000 756100                    STQ     0,,PR0

      563      406    1       ALTRETURN;

    406  1 000116   000000 702200 xent               TSX2  ! X66_AALT
      564      407        /**/
      565      408    1   END X$WILDTFMT;
      566      409        %EOD;

PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:77   
--  Include file information  --

   XUW_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure X$WILDTFMT.
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:78   

 **** Variables and constants ****

  ****  Section 000 RoData X$WILDTFMT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 XUW_IFPT_WILDCARD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w PTR         r     1 @CONTAINS                  7-0-0/w PTR         r     1 @ERROR
     3-0-0/w PTR         r     1 @INPUT                     6-0-0/w PTR         r     1 @OUTPUT
     4-0-0/w PTR         r     1 @PATTERN                   5-0-0/w PTR         r     1 @TEMPLATE
    *0-0-0/w BIT         r     1 CONTAINS                  *0-0-0/w BIT         r     1 ERROR
    12-0-0/d STRC(432)   r     1 FPT_WILDCARD              *0-0-0/c ASTR(9)     r     1 INPUT
    *0-0-0/c ASTR(9)     r     1 OUTPUT                    *0-0-0/c ASTR(9)     r     1 PATTERN
    *0-0-0/c ASTR(9)     r     1 TEMPLATE


   Procedure X$WILDTFMT requires 79 words for executable code.
   Procedure X$WILDTFMT requires 24 words of local(AUTO) storage.
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:79   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:80   
          MINI XREF LISTING

CONTAINS
       171**DCL         7--PROC      393--IF        396>>ASSIGN
ERROR
       170**DCL         7--PROC      400<<ASSIGN    405<<ASSIGN
FPT_WILDCARD
       238**DCL       388<<ASSIGN    398<>CALL
FPT_WILDCARD.CONTAINS#
       266**DCL       394<<ASSIGN    396<<ASSIGN
FPT_WILDCARD.ERROR
       259**DCL       400>>ASSIGN    405>>ASSIGN
FPT_WILDCARD.INPUT_
       244**DCL       389<<ASSIGN
FPT_WILDCARD.OUTPUT_
       254**DCL       392<<ASSIGN
FPT_WILDCARD.OUTPUT_LEN
       269**DCL       401>>ASSIGN
FPT_WILDCARD.PATTERN_
       239**DCL       390<<ASSIGN
FPT_WILDCARD.TEMPLATE_
       249**DCL       391<<ASSIGN
INPUT
       158**DCL         7--PROC
INPUT.C
       159**DCL       160--IMP-SIZ   389>>ASSIGN
INPUT.TEXT
       160**DCL       389--ASSIGN
OOPS
       401**LABEL     398--CALLALT
OUTPUT
       167**DCL         7--PROC
OUTPUT.C
       168**DCL       169--IMP-SIZ   392>>ASSIGN    401<<ASSIGN
PL6.E3A0      #002=X$WILDTFMT File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:81   
OUTPUT.TEXT
       169**DCL       392--ASSIGN
PATTERN
       161**DCL         7--PROC
PATTERN.C
       162**DCL       163--IMP-SIZ   390>>ASSIGN
PATTERN.TEXT
       163**DCL       390--ASSIGN
TEMPLATE
       164**DCL         7--PROC
TEMPLATE.C
       165**DCL       166--IMP-SIZ   391>>ASSIGN
TEMPLATE.TEXT
       166**DCL       391--ASSIGN
X$WILDFMT
       377**DCL-ENT   398--CALL
XUW_IFPT_WILDCARD
       338**DCL       388>>ASSIGN

PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:82   
      567        1        /*T***********************************************************/
      568        2        /*T*                                                         */
      569        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      570        4        /*T*                                                         */
      571        5        /*T***********************************************************/
      572        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
      573        7        X$WILDTCMP: PROC(INPUT,PATTERN,ERROR,CONTAINS) ALTRET;
      574        8
      575        9
      576       10        /*********************************************************************
      577       11        *                                                                    *
      578       12        *   X$WILDTCMP is a simplified interface to X$WILDCMP based on       *
      579       13        *   TEXT$C strings.                                                  *
      580       14        *                                                                    *
      581       15        **********************************************************************/
      582       16
      583       17        /**/
      584       18        /*  INCLUDES  */
      585       19        /**/
      586       20        %INCLUDE XUW_MACRO_C;
      587      155        /**/
      588      156        /*  PARAMETERS  */
      589      157        /**/
      590      158    1   DCL 1 INPUT CALIGNED,
      591      159    1         2 C UBIN BYTE CALIGNED,
      592      160    1         2 TEXT CHAR(INPUT.C) CALIGNED;
      593      161    1   DCL 1 PATTERN CALIGNED,
      594      162    1         2 C UBIN BYTE CALIGNED,
      595      163    1         2 TEXT CHAR(PATTERN.C) CALIGNED;
      596      164    1   DCL ERROR BIT(36) WALIGNED;
      597      165    1   DCL CONTAINS BIT(1) WALIGNED;
      598      166        /**/
      599      167        /*  LOCAL AUTO  */
      600      168        /**/
      601      169        %XUW_WILDCARD (FPTN = FPT_WILDCARD,
      602      170                       STCLASS = AUTO);
      603      266        /**/
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:83   
      604      267        /*  EXTERNAL CONSTANT  */
      605      268        /**/
      606      269        %XUW_WILDCARD (FPTN = XUW_IFPT_WILDCARD,
      607      270                       STCLASS = CONSTANT);
      608      366        /**/
      609      367        /*  ENTRY DCLS  */
      610      368        /**/
      611      369        %XUW_ENTRIES (OMIT=X$WILDTCMP);
      612      381        %EJECT;
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:84   
      613      382    1       FPT_WILDCARD = XUW_IFPT_WILDCARD;
      614      383    1       FPT_WILDCARD.INPUT_ = VECTOR(INPUT.TEXT);
      615      384    1       FPT_WILDCARD.PATTERN_ = VECTOR(PATTERN.TEXT);
      616      385    1       IF ADDR(CONTAINS) = ADDR(NIL) THEN
      617      386    1           FPT_WILDCARD.CONTAINS# = '0'B;  /* DEFAULT                            */
      618      387    1       ELSE
      619      388    1           FPT_WILDCARD.CONTAINS# = CONTAINS; /* PASSED VALUE                     */
      620      389        /**/
      621      390    1       CALL X$WILDCMP (FPT_WILDCARD) ALTRET(OOPS);
      622      391        /**/
      623      392    1       ERROR = FPT_WILDCARD.ERROR;
      624      393    1       RETURN;
      625      394        /**/
      626      395    1   OOPS: ;
      627      396    1       ERROR = FPT_WILDCARD.ERROR;
      628      397    1       ALTRETURN;
      629      398        /**/
      630      399    1   END X$WILDTCMP;

PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:85   
--  Include file information  --

   XUW_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure X$WILDTCMP.

   Procedure X$WILDTCMP requires 53 words for executable code.
   Procedure X$WILDTCMP requires 22 words of local(AUTO) storage.

    No errors detected in file XUW$WILD.:E05TSI    .

PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:86   

 Object Unit name= X$WILDTCMP                                 File name= XUW$WILD.:E05TOU
 UTS= JUL 30 '97 09:45:58.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     12     14  X$WILDTCMP
    1   Proc  even  none    53     65  X$WILDTCMP
    2  RoData even  none     1      1  X$WILDTCMP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        4  X$WILDTCMP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 X$WILDCMP
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:87   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:88   


      567        1        /*T***********************************************************/
      568        2        /*T*                                                         */
      569        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      570        4        /*T*                                                         */
      571        5        /*T***********************************************************/
      572        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
      573        7        X$WILDTCMP: PROC(INPUT,PATTERN,ERROR,CONTAINS) ALTRET;

      7  1 000000   000000 700200 xent  X$WILDTCMP   TSX0  ! X66_AUTO_4
         1 000001   000026 000004                    ZERO    22,4

      574        8
      575        9
      576       10        /*********************************************************************
      577       11        *                                                                    *
      578       12        *   X$WILDTCMP is a simplified interface to X$WILDCMP based on       *
      579       13        *   TEXT$C strings.                                                  *
      580       14        *                                                                    *
      581       15        **********************************************************************/
      582       16
      583       17        /**/
      584       18        /*  INCLUDES  */
      585       19        /**/
      586       20        %INCLUDE XUW_MACRO_C;
      587      155        /**/
      588      156        /*  PARAMETERS  */
      589      157        /**/
      590      158    1   DCL 1 INPUT CALIGNED,
      591      159    1         2 C UBIN BYTE CALIGNED,
      592      160    1         2 TEXT CHAR(INPUT.C) CALIGNED;
      593      161    1   DCL 1 PATTERN CALIGNED,
      594      162    1         2 C UBIN BYTE CALIGNED,
      595      163    1         2 TEXT CHAR(PATTERN.C) CALIGNED;
      596      164    1   DCL ERROR BIT(36) WALIGNED;
      597      165    1   DCL CONTAINS BIT(1) WALIGNED;
      598      166        /**/
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:89   
      599      167        /*  LOCAL AUTO  */
      600      168        /**/
      601      169        %XUW_WILDCARD (FPTN = FPT_WILDCARD,
      602      170                       STCLASS = AUTO);
      603      266        /**/
      604      267        /*  EXTERNAL CONSTANT  */
      605      268        /**/
      606      269        %XUW_WILDCARD (FPTN = XUW_IFPT_WILDCARD,
      607      270                       STCLASS = CONSTANT);
      608      366        /**/
      609      367        /*  ENTRY DCLS  */
      610      368        /**/
      611      369        %XUW_ENTRIES (OMIT=X$WILDTCMP);
      612      381        %EJECT;
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:90   
      613      382    1       FPT_WILDCARD = XUW_IFPT_WILDCARD;

    382  1 000002   000100 100400                    MLR     fill='000'O
         1 000003   000000 000060 0                  ADSC9   XUW_IFPT_WILDCARD        cn=0,n=48
         1 000004   200010 000060                    ADSC9   FPT_WILDCARD,,AUTO       cn=0,n=48

      614      383    1       FPT_WILDCARD.INPUT_ = VECTOR(INPUT.TEXT);

    383  1 000005   200003 470500                    LDP0    @INPUT,,AUTO
         1 000006   000100 101500                    MRL     fill='000'O
         1 000007   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000010   200024 000002                    ADSC9   FPT_WILDCARD+12,,AUTO    cn=0,n=2
         1 000011   200024 220100                    LDX0    FPT_WILDCARD+12,,AUTO
         1 000012   000000 635010                    EAA     0,X0
         1 000013   000002 771000                    ARL     2
         1 000014   000140 135007                    SBLA    96,DL
         1 000015   200003 236100                    LDQ     @INPUT,,AUTO
         1 000016   200000 036007                    ADLQ    65536,DL
         1 000017   200012 757100                    STAQ    FPT_WILDCARD+2,,AUTO

      615      384    1       FPT_WILDCARD.PATTERN_ = VECTOR(PATTERN.TEXT);

    384  1 000020   200004 471500                    LDP1    @PATTERN,,AUTO
         1 000021   000100 101500                    MRL     fill='000'O
         1 000022   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 000023   200024 000002                    ADSC9   FPT_WILDCARD+12,,AUTO    cn=0,n=2
         1 000024   200024 220100                    LDX0    FPT_WILDCARD+12,,AUTO
         1 000025   000000 635010                    EAA     0,X0
         1 000026   000002 771000                    ARL     2
         1 000027   000140 135007                    SBLA    96,DL
         1 000030   200004 236100                    LDQ     @PATTERN,,AUTO
         1 000031   200000 036007                    ADLQ    65536,DL
         1 000032   200010 757100                    STAQ    FPT_WILDCARD,,AUTO

      616      385    1       IF ADDR(CONTAINS) = ADDR(NIL) THEN

    385  1 000033   200006 236100                    LDQ     @CONTAINS,,AUTO
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:91   
         1 000034   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000035   000041 601000 1                  TNZ     s:388

      617      386    1           FPT_WILDCARD.CONTAINS# = '0'B;  /* DEFAULT                            */

    386  1 000036   000000 236000 2                  LDQ     0
         1 000037   200021 356100                    ANSQ    FPT_WILDCARD+9,,AUTO
         1 000040   000047 710000 1                  TRA     s:390

      618      387    1       ELSE
      619      388    1           FPT_WILDCARD.CONTAINS# = CONTAINS; /* PASSED VALUE                     */

    388  1 000041   200006 473500                    LDP3    @CONTAINS,,AUTO
         1 000042   300000 236100                    LDQ     0,,PR3
         1 000043   000011 772000                    QRL     9
         1 000044   200021 676100                    ERQ     FPT_WILDCARD+9,,AUTO
         1 000045   000400 376003                    ANQ     256,DU
         1 000046   200021 656100                    ERSQ    FPT_WILDCARD+9,,AUTO

      620      389        /**/
      621      390    1       CALL X$WILDCMP (FPT_WILDCARD) ALTRET(OOPS);

    390  1 000047   200010 633500                    EPPR3   FPT_WILDCARD,,AUTO
         1 000050   200024 453500                    STP3    FPT_WILDCARD+12,,AUTO
         1 000051   200024 630500                    EPPR0   FPT_WILDCARD+12,,AUTO
         1 000052   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000053   000000 701000 xent               TSX1    X$WILDCMP
         1 000054   000061 702000 1                  TSX2    OOPS

      622      391        /**/
      623      392    1       ERROR = FPT_WILDCARD.ERROR;

    392  1 000055   200020 236100                    LDQ     FPT_WILDCARD+8,,AUTO
         1 000056   200005 470500                    LDP0    @ERROR,,AUTO
         1 000057   000000 756100                    STQ     0,,PR0

      624      393    1       RETURN;
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:92   

    393  1 000060   000000 702200 xent               TSX2  ! X66_ARET

    392  1 000061                       OOPS         null
      625      394        /**/
      626      395    1   OOPS: ;
      627      396    1       ERROR = FPT_WILDCARD.ERROR;

    396  1 000061   200020 236100                    LDQ     FPT_WILDCARD+8,,AUTO
         1 000062   200005 470500                    LDP0    @ERROR,,AUTO
         1 000063   000000 756100                    STQ     0,,PR0

      628      397    1       ALTRETURN;

    397  1 000064   000000 702200 xent               TSX2  ! X66_AALT
      629      398        /**/
      630      399    1   END X$WILDTCMP;

PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:93   
--  Include file information  --

   XUW_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure X$WILDTCMP.
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:94   

 **** Variables and constants ****

  ****  Section 000 RoData X$WILDTCMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 XUW_IFPT_WILDCARD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @CONTAINS                  5-0-0/w PTR         r     1 @ERROR
     3-0-0/w PTR         r     1 @INPUT                     4-0-0/w PTR         r     1 @PATTERN
    *0-0-0/w BIT         r     1 CONTAINS                  *0-0-0/w BIT         r     1 ERROR
    10-0-0/d STRC(432)   r     1 FPT_WILDCARD              *0-0-0/c ASTR(9)     r     1 INPUT
    *0-0-0/c ASTR(9)     r     1 PATTERN


   Procedure X$WILDTCMP requires 53 words for executable code.
   Procedure X$WILDTCMP requires 22 words of local(AUTO) storage.

    No errors detected in file XUW$WILD.:E05TSI    .
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:95   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=X$WILDTCMP File=XUW$WILD.:E05TSI                              WED 07/30/97 09:45 Page:96   
          MINI XREF LISTING

CONTAINS
       165**DCL         7--PROC      385--IF        388>>ASSIGN
ERROR
       164**DCL         7--PROC      392<<ASSIGN    396<<ASSIGN
FPT_WILDCARD
       232**DCL       382<<ASSIGN    390<>CALL
FPT_WILDCARD.CONTAINS#
       260**DCL       386<<ASSIGN    388<<ASSIGN
FPT_WILDCARD.ERROR
       253**DCL       392>>ASSIGN    396>>ASSIGN
FPT_WILDCARD.INPUT_
       238**DCL       383<<ASSIGN
FPT_WILDCARD.PATTERN_
       233**DCL       384<<ASSIGN
INPUT
       158**DCL         7--PROC
INPUT.C
       159**DCL       160--IMP-SIZ   383>>ASSIGN
INPUT.TEXT
       160**DCL       383--ASSIGN
OOPS
       392**LABEL     390--CALLALT
PATTERN
       161**DCL         7--PROC
PATTERN.C
       162**DCL       163--IMP-SIZ   384>>ASSIGN
PATTERN.TEXT
       163**DCL       384--ASSIGN
X$WILDCMP
       372**DCL-ENT   390--CALL
XUW_IFPT_WILDCARD
       332**DCL       382>>ASSIGN
