VERSION E05

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:1    
        1        1        /*M* OCO$OUTPUT groups KEYINs output setup, formatting and printing */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9
       10       10        /*
       11       11          ###   ###   ###    #    ###  #   # ##### ####  #   # #####
       12       12         # # # #   # # # #  ###  # # # #   #   #   #   # #   #   #
       13       13         # # # #     # # # # #   # # # #   #   #   #   # #   #   #
       14       14         #  ## #     #  ##  ###  #  ## #   #   #   ####  #   #   #
       15       15         #   # #     #   #   # # #   # #   #   #   #     #   #   #
       16       16         #   # #   # #   #  ###  #   # #   #   #   #     #   #   #
       17       17          ###   ###   ###    #    ###   ###    #   #      ###    #
       18       18                                                                          */
       19       19
       20       20
       21       21
       22       22
       23       23        %EJECT;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:2    
       24       24        /*M* OCO$MESSHAND KEYINs routine to handle reads from CSCG */
       25       25        %SET LISTSUB='1'B;
       26       26        /*
       27       27         ###    ###    ###    #   #   #  #####   ###    ###   #   #   ###   #   #  ####
       28       28        #   #  #   #  #   #  ###  ## ##  #      #   #  #   #  #   #  #   #  #   #  #   #
       29       29        #   #  #      #   # # #   # # #  #      #      #      #   #  #   #  ##  #  #   #
       30       30        #   #  #      #   #  ###  #   #  ####    ###    ###   #####  #####  # # #  #   #
       31       31        #   #  #      #   #   # # #   #  #          #      #  #   #  #   #  #  ##  #   #
       32       32        #   #  #   #  #   #  ###  #   #  #      #   #  #   #  #   #  #   #  #   #  #   #
       33       33         ###    ###    ###    #   #   #  #####   ###    ###   #   #  #   #  #   #  ####
       34       34                                                                   */
       35       35        OCO$MESSHAND: PROC;                     /* process reads from CSCG */
       36       36                                                /**/
       37       37                                                /**/
       38       38        %INCLUDE CP_6;
       39      119             %B$NWIO (NAME=NWIO,PARONLY=1,STCLASS="BASED(NWIO$)");
       40      200        %INCLUDE NK_VFC_C;
       41      274        /* VFC BYTE DESCRIPTION */
       42      275        %NK$VFC (NAME=NK_VFC,STCLASS=,ALG=ALIGNED);
       43      293                                                /**/
       44      294        %INCLUDE OC_SUBS_C;
       45     1025        %INCLUDE OCI_SUBS_C;
       46     1123        %INCLUDE OCD_SUBS_C;
       47     1141        %INCLUDE JG_GHOSTS_C;
       48     1231        %INCLUDE OC_DAT_R;
       49     1392        %INCLUDE OCD_DATA_R;
       50     1405
       51     1406        %INCLUDE EL$TABLES;
       52     1729        %INCLUDE EL_SUBS_C;
       53     1813                                                /**/
       54     1814        %INCLUDE KV_PRMID_E;
       55     1988        %KV_PRMID_E;
       56     2144                                                /**/
       57     2145                                                /**/
       58     2146    1   DCL NWIO$ PTR;
       59     2147    1   DCL TEMP$ PTR;
       60     2148    1   DCL TEMP UBIN WORD;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:3    
       61     2149    1   DCL I SBIN;
       62     2150    1   DCL J SBIN;
       63     2151                                                /**/
       64     2152                                                /**/
       65     2153    1   DCL 1 SETPARMS BASED,
       66     2154    1            2 * UBIN HALF UNAL,
       67     2155    1            2 * BIT(1) UNAL,
       68     2156    1            2 FCN UBIN(8) UNAL,
       69     2157    1            2 * BIT(1) UNAL,
       70     2158    1            2 LENGTH UBIN(8) UNAL,
       71     2159    1            2 * BIT(1) UNAL,
       72     2160    1            2 PFB UBIN(8) UNAL,
       73     2161    1            2 DVBYTE UBIN(9) UNAL,
       74     2162    1            2 VFC CHAR(1) UNAL,
       75     2163    1            2 TEXT CHAR(TEMP) UNAL;
       76     2164                                                /**/
       77     2165    1   DCL STATION CHAR(8);
       78     2166    1   DCL 1 RESTA REDEF STATION,
       79     2167    1            2 * CHAR(4) UNAL,
       80     2168    1            2 SYSID UBIN(18) UNAL,
       81     2169    1            2 * BIT(1) UNAL,
       82     2170    1            2 CADDR UBIN(17) UNAL;
       83     2171
       84     2172    1   DCL MOVEI CHAR(I) BASED;
       85     2173    1   DCL BIT9 BIT(9) BASED ALIGNED;
       86     2174
       87     2175                                                /**/
       88     2176    1   DCL 1 OC$MESSAGE BASED,
       89     2177    1            2 MK_VECT UBIN BYTE UNAL,
       90     2178    1            2 KEYIN# UBIN BYTE UNAL,
       91     2179    1            2 CADDR BIT(18) UNAL,
       92     2180    1            2 TEXT CHAR(%(140 /* CSCG_MAXMC# */ - 4)) UNAL;
       93     2181                                                /**/
       94     2182    1   DCL 1 TEXT BASED,
       95     2183    1            2 CNT UBIN BYTE UNAL,
       96     2184    1            2 C CHAR (TEXT.CNT) UNAL;
       97     2185                                                /**/
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:4    
       98     2186    1   DCL 1 MONKEY_MSGB STATIC CALIGNED,
       99     2187    1            2 STATION CHAR(8) CALIGNED INIT (' '),
      100     2188    1            2 CODE UBIN BYTE UNAL INIT (0);
      101     2189                                                /**/
      102     2190    1   DCL 1 MONKEY_MSGC STATIC CALIGNED,
      103     2191    1            2 * UBIN BYTE UNAL INIT (8),
      104     2192    1            2 * UBIN BYTE UNAL INIT (1);
      105     2193                                                /**/
      106     2194    1   DCL 1 OC$TERMSEND BASED,
      107     2195    1            2 * UBIN WORD UNAL,
      108     2196    1            2 TERM CHAR(8) UNAL,
      109     2197    1            2 SIZE UBIN(9) UNAL,
      110     2198    1            2 MESSAGE CHAR(OC$TERMSEND.SIZE) UNAL;
      111     2199
      112     2200    1   DCL MSG# UBIN HALF STATIC UNAL;
      113     2201    1   DCL NP# UBIN BYTE STATIC UNAL;
      114     2202    1   DCL OCO_PARAM CHAR(140) STATIC CALIGNED INIT (' ');
      115     2203    1   DCL OCO_PARAM$ PTR;
      116     2204    1   DCL BASED_BUF BASED CHAR(140) CALIGNED;
      117     2205    1   DCL OC_GOOSE_STA CHAR(8) STATIC SYMDEF INIT('GOOS0000');
      118     2206                                                /**/
      119     2207    1   DCL M$CSCG DCB;
      120     2208                                                /**/
      121     2209             %EL$ZAP             (NAME=EL_ZAPBUF,
      122     2210                                 STCLASS=STATIC);
      123     2213                                                /**/
      124     2214                                                /**/
      125     2215                                                /**/
      126     2216                                                /**/
      127     2217             %FPT_CGCTL          (FPTN=CSCG_DONT_WAS,
      128     2218                                      STCLASS=CONSTANT,
      129     2219                                      DCB=M$CSCG,
      130     2220                                      CGCP=CSCG_CTL);
      131     2243                                                /**/
      132     2244                  %VLP_CGCP      (FPTN=CSCG_CTL,
      133     2245                                      STCLASS=CONSTANT,
      134     2246                                      MXACT=99999,
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:5    
      135     2247                                      CONMSG=YES,
      136     2248                                      TERMCONAU=NO,
      137     2249                                      DCBCONAU=YES,
      138     2250                                      TERMCONNAU=NO,
      139     2251                                      DCBCONNAU=YES,
      140     2252                                      AUCONTERM=DISCONNECT,
      141     2253                                      AUCONDCB=NC,
      142     2254                                      AUDCONTERM=DISCONNECT,
      143     2255                                      AUDCONDCB=NC,
      144     2256                                      XSTALGL=YES,
      145     2257                                      WAS=NO,
      146     2258                                      RAS=YES,
      147     2259                                      SMD=YES,
      148     2260                                      XTYPLGL=YES,
      149     2261                                      MAXMC=CSCG_MAXMC#,
      150     2262                                      DCBCONLGL=YES,
      151     2263                                      TERMCONLGL=NO,
      152     2264                                      INPUT=YES,
      153     2265                                      OUTPUT=YES,
      154     2266                                      SECURE=NO);
      155     2309                                                /**/
      156     2310             %FPT_WRITE          (FPTN=WR_STA,
      157     2311                                      DCB=M$CSCG,
      158     2312                                      STATION=STA,
      159     2313                                      BUF=OCO_PARAM,
      160     2314                                      BP=YES,
      161     2315                                      EVENT=OC_WRDN_O);
      162     2346                                                /**/
      163     2347                  %VLP_STATION   (FPTN=STA,
      164     2348                                      WAS=NO);
      165     2375                                                /**/
      166     2376             %FPT_TIME           (FPTN=ZAP_ENTRY,
      167     2377                                      TIME=OCD_ZAPTIME,
      168     2378                                      DEST=LOCAL,
      169     2379                                      SOURCE=CLOCK);
      170     2398                                                /**/
      171     2399             %FPT_WRSYSLOG       (FPTN=WR_ZAPERR,
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:6    
      172     2400                                      ENTRY=EL_ZAPBUF,
      173     2401                                      SIZE="SIZEW(EL_ZAPBUF)",
      174     2402                                      MMINHIB=NO,
      175     2403                                      FILENUM=ERRLOG,
      176     2404                                      TYPE=EL_ZAP);
      177     2419                                                /**/
      178     2420                                                /**/
      179     2421                                                /**/
      180     2422                                                /**/
      181     2423                                                /**/
      182     2424    1   DCL OCO$MESSAGE ENTRY(3);
      183     2425    1   DCL OCP$CSCG ENTRY;
      184     2426    1   DCL OCD$MARKEM ENTRY(1);
      185     2427    1   DCL OCD$REST ENTRY;
      186     2428    1   DCL OCD$DOPIG ENTRY;
      187     2429    1   DCL OCD$MONKEY ENTRY;
      188     2430    1   DCL OCD$SLUG ENTRY;
      189     2431    1   DCL OCD$ELF ENTRY;
      190     2432    1   DCL OCD$SHUTDN ENTRY;
      191     2433    1   DCL OCN$KEYIN ENTRY(3);
      192     2434    1   DCL OCL$START_EXCLU ENTRY;
      193     2435    1   DCL OCL$START_SHARED ENTRY;
      194     2436    1   DCL OCO$IWRITE ENTRY(8);
      195     2437                                                /**/
      196     2438                                                /**/
      197     2439        /*
      198     2440                   Begin  O C O $ M E S S H A N D  Main
      199     2441                                                     */
      200     2442                                                /**/
      201     2443                                                /**/
      202     2444    1        NWIO$=ADDR(OC_QUEUE.PARMS(OC_QHEAD));
      203     2445    1        IF NWIO.CGPARM.MSGTYP# = '*AUEV'
      204     2446    1        THEN
      205     2447    2        DO;
      206     2448    2             CALL OCP$CSCG;
      207     2449    2             RETURN;
      208     2450    2           END;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:7    
      209     2451    1        STATION = NWIO.CGPARM.STATION#;
      210     2452
      211     2453    1        IF NWIO.DVE.DVBYTE.VFC
      212     2454    1        THEN
      213     2455    2        DO;
      214     2456    2             NK_VFC = ADDR(OC_MSGBUFFER)->BIT9;
      215     2457    2             I = NWIO.ARS-1;
      216     2458    2             NWIO.ARS = I;
      217     2459    2             ADDR(OC_MSGBUFFER) -> MOVEI = PINCRC(ADDR(OC_MSGBUFFER),1) -> MOVEI;
      218     2460    2           END;
      219     2461                                                /**/
      220     2462                                                /**/
      221     2463    1        IF OC_MSGBUFFER.FCN = 11           /* OK TO ZAP */
      222     2464    1        THEN
      223     2465    2        DO;
      224     2466    2             IF OC_ZIP = '1'B
      225     2467    2             THEN
      226     2468    3             DO;
      227     2469    3                  RETURN;
      228     2470    3                END;
      229     2471                                                /**/
      230     2472    2             OCO_PARAM$ = ADDR (OCO_PARAM);
      231     2473    2             OCD_ZAPPHASE = 1 /* OCD_MONKEY_SLUG# */;
      232     2474    2             CALL M$TIME (ZAP_ENTRY) ALTRET (SO_WHAT);
      233     2475    2   SO_WHAT:  ;
      234     2476    2             EL_ZAPBUF.STATION = OCD_ZAP_SAVE.CONS_STA;
      235     2477    2             EL_ZAPBUF.OPER_TEXT=ADDR(ADDR(OCD_ZAP_SAVE.MESSAGE)
      236     2478    2                  -> OC$MESSAGE.TEXT) -> OC$TERMSEND.MESSAGE;
      237     2479                                                /**/
      238     2480    2             CALL M$WRSYSLOG (WR_ZAPERR) ALTRET (ANOTHER_ONE);
      239     2481    2   ANOTHER_ONE:;
      240     2482    2             OC_ZIP = '1'B;
      241     2483    2             CALL M$CGCTL (CSCG_DONT_WAS) ALTRET (NO_WAS_);
      242     2484    2   NO_WAS_:  ;
      243     2485    2             STA.STATION# = 'MONKEY';
      244     2486    2             OCO_PARAM$ -> OC$MESSAGE = OCD_ZAP_SAVE.MESSAGE;
      245     2487    2             OCO_PARAM$ -> OC$MESSAGE.MK_VECT = 6 /* MKV_OCA$KMISC# */;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:8    
      246     2488    2             OCO_PARAM$ -> OC$MESSAGE.KEYIN# = 9 /* KEY_MNKZAP1# */;
      247     2489    2             WR_STA.V.EVENT# = BITBIN (OCD_ZAP_SAVE.CSCG_EVID);
      248     2490    2             CALL M$WRITE (WR_STA) ALTRET (OH_OH);
      249     2491                                                /**/
      250     2492    3             DO WHILE ('0'B);
      251     2493    3   OH_OH:
      252     2494    3                  MSG# = 378 /* STATION_MSG# */;
      253     2495    3                  NP# = 3;
      254     2496    3                  MONKEY_MSGB.CODE = 0;
      255     2497    3                  MONKEY_MSGB.STATION = STA.STATION#;
      256     2498    3                  CALL OCO$IWRITE (OCD_ZAP_SAVE.CSCG_EVID.CADDR, MSG#, NP#,
      257     2499    3                       MONKEY_MSGC, MONKEY_MSGB, 0, ' ', 0);
      258     2500    3                END;
      259     2501    2             RETURN;
      260     2502    2           END;
      261     2503                                                /**/
      262     2504                                      /* Special checks are done here if
      263     2505                                           Zap-In-Progress (ZIP)          */
      264     2506                                                /**/
      265     2507    1        IF OC_ZIP
      266     2508    1        THEN
      267     2509    2        DO;                                /**/
      268     2510    2             IF OC_MSGBUFFER.MSG# = 1023 /* PREZAP_MSG# */
      269     2511    2             THEN
      270     2512    3             DO;
      271     2513    3                  IF (STATION = 'SLUG'
      272     2514    3                       OR
      273     2515    3                       STATION = 'MBS')
      274     2516    3                       AND
      275     2517    3                       OCD_ZAPPHASE = 1 /* OCD_MONKEY_SLUG# */
      276     2518    3                  THEN
      277     2519    3                       CALL OCD$DOPIG;
      278     2520    3                  IF STATION = 'PIG'
      279     2521    3                  THEN
      280     2522    3                       CALL OCD$MONKEY;
      281     2523    3                  IF STATION = 'MONKEY'
      282     2524    3                  THEN
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:9    
      283     2525    3                       CALL OCD$REST;
      284     2526    3                  RETURN;
      285     2527    3                END;                       /* DO IF PREZAP DONE MESS */
      286     2528                                                /**/
      287     2529                                                /**/
      288     2530    2             IF OC_MSGBUFFER.FCN = 7 /* zap complete indicator */
      289     2531    2             THEN
      290     2532    3             DO;
      291     2533    3                  IF STATION = 'ELF'
      292     2534    3                  THEN
      293     2535    4                  DO;
      294     2536    4                       CALL OCD$SLUG;
      295     2537    4                       RETURN;
      296     2538    4                     END;
      297     2539    3                  IF (STATION = 'SLUG'
      298     2540    3                       OR STATION = 'MBS')
      299     2541    3                       AND OCD_ZAPPHASE = 6 /* OCD_SLUG2# */
      300     2542    3                  THEN
      301     2543    4                  DO;
      302     2544    4                       CALL OCD$SHUTDN;
      303     2545    4                       RETURN;
      304     2546    4                     END;
      305     2547    3                  CALL OCD$MARKEM (STATION);
      306     2548    3                  RETURN;
      307     2549    3                END;                /* DO IF ZAP DONE FROM SOME
      308     2550                                                     GHOST */
      309     2551    2           END;                            /* DO IF ZAP IN PROGRESS */
      310     2552                                                /**/
      311     2553    1        IF NWIO.DVE.DVBYTE.VFC
      312     2554    1        THEN
      313     2555    2        DO CASE (NK_VFC.FCN);
      314     2556                                                /**/
      315     2557    2        CASE (%VFCF_RFU,
      316     2558    2             %VFCF_RSV);
      317     2559    2           RETURN;
      318     2560                                                /**/
      319     2561    2        CASE (%VFCF_SPC);
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:10   
      320     2562                                                /**/
      321     2563    3           DO CASE (NK_VFC.COUNT);
      322     2564                                                /**/
      323     2565    3           CASE (%VFCS_SPRM);
      324     2566                                           /* SPECIAL CASE: If this message
      325     2567                                                is a special terminal parameter
      326     2568                                                control buffer, take the
      327     2569                                                appropriate action for this
      328     2570                                                type of parameter, then
      329     2571                                                just return (dont format and/or
      330     2572                                                print anything */
      331     2573    3              TEMP$ = PINCRC(ADDR(OC_MSGBUFFER.MESS),OC_MSGBUFFER.NPARAMS);
      332     2574    3              IF TEMP$ -> SETPARMS.FCN = %KV_PRMID_PROMPT
      333     2575    3              THEN
      334     2576    4              DO;                          /* Handle the "Set Prompt" case */
      335     2577    5                   DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      336     2578    5                        IF OC_CONSOLE.CID(I) = RESTA.CADDR
      337     2579    5                        THEN
      338     2580    6                        DO;
      339     2581    6                             TEMP = TEMP$ -> SETPARMS.LENGTH - 3;
      340     2582    6                             J = TEMP$ -> SETPARMS.PFB;
      341     2583    6                             IF J > 0
      342     2584    6                             THEN
      343     2585    6                                  J = J - 1;
      344     2586    6                             IF J > 2
      345     2587    6                             THEN
      346     2588    6                                  J = 1;   /* User prompt */
      347     2589    6                             ADDR(OC_CONSOLE.PROMPTS(I)) ->
      348     2590    6                                  PROMPT_TABLE.COUNT_(J) = TEMP;
      349     2591    6                             ADDR(OC_CONSOLE.PROMPTS(I)) ->
      350     2592    6                                  PROMPT_TABLE.PROMPT(J) =
      351     2593    6                                  TEMP$ -> SETPARMS.TEXT;
      352     2594    6                             I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
      353     2595    6                           END;            /* DO IF SYSID = SYSID */
      354     2596    5                      END;                 /* DO I = 0 TO MAX_CONSOLES# */
      355     2597    4                 END;                      /* DO IF SET PROMPT CASE */
      356     2598    3              RETURN;                      /* after setting prompt */
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:11   
      357     2599                                                /**/
      358     2600    3           CASE (%VFCS_TRS0,
      359     2601    3                   %VFCS_TRS1);
      360     2602    3              ;                            /* let these trickle thru */
      361     2603                                                /**/
      362     2604    3           CASE (ELSE);
      363     2605    3              RETURN;
      364     2606    3           END;                            /* DO CASE NK$VFC.COUNT */
      365     2607                                                /**/
      366     2608    2        END;                               /* DO CASE NK$VFC.FCN */
      367     2609                                                /**/
      368     2610                                                /**/
      369     2611                                                /**/
      370     2612                                                /**/
      371     2613                                                /**/
      372     2614    1        IF OC_MSGBUFFER.FCN = 8 /* INTERNAL KEYIN */       /* CHECK OF KEYIN */
      373     2615    1        THEN
      374     2616    2        DO;
      375     2617    2             IF STATION = 'GOOSE' OR STATION = 'OGOOSE'
      376     2618    2             THEN
      377     2619    3             DO;
      378     2620    3                  TEMP = OC_MSGBUFFER2.SIZE; /* NEED AN ENTIRE WORD */
      379     2621    3                  IF TEMP < 140 /* CSCG_MAXMC# */    /* CHECK IF SIZE IS REASONABLE */
      380     2622    3                  THEN
      381     2623    3                       CALL OCN$KEYIN(OC_MSGBUFFER2.MESS,
      382     2624    3                            TEMP,OC_GOOSE_STA);
      383     2625    3                  RETURN;
      384     2626    3                END;
      385     2627    2             ELSE
      386     2628    2                  RETURN;
      387     2629    2           END;
      388     2630                                                /**/
      389     2631                                                /**/
      390     2632    1        IF OC_MSGBUFFER.FCN = 9 /* Open :OCHIST shared */
      391     2633    1        THEN
      392     2634    2        DO;
      393     2635    2             CALL OCL$START_SHARED;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:12   
      394     2636    2             RETURN;
      395     2637    2           END;
      396     2638                                                /**/
      397     2639                                                /**/
      398     2640    1        IF OC_MSGBUFFER.FCN = 10 /* Open :OCHIST exclusive */
      399     2641    1        THEN
      400     2642    2        DO;
      401     2643    2             CALL OCL$START_EXCLU;
      402     2644    2             RETURN;
      403     2645    2           END;
      404     2646                                                /**/
      405     2647                                                /**/
      406     2648    1        CALL OCO$MESSAGE (STATION,OC_MSGBUFFER,NWIO.ARS);
      407     2649                                                /**/
      408     2650    1        RETURN;
      409     2651                                                /**/
      410     2652    1   END OCO$MESSHAND;
      411     2653        %EOD;

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:13   
--  Include file information  --

   KV_PRMID_E.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   OCD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OCD_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCO$MESSHAND.

   Procedure OCO$MESSHAND requires 333 words for executable code.
   Procedure OCO$MESSHAND requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:14   

 Object Unit name= OCO$MESSHAND                               File name= OCO$OUTPUT.:E05TOU
 UTS= JUL 30 '97 04:03:18.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   120    170  OCO$MESSHAND
    2   DCB   even  none     0      0  M$CSCG
    3  RoData even  UTS     84    124  OCO$MESSHAND
    4   Proc  even  none   333    515  OCO$MESSHAND
    5  RoData even  none    14     16  OCO$MESSHAND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  OCO$MESSHAND

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     51  OC_GOOSE_STA
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 OCP$CSCG
         yes           Std       0 OCD$SLUG
         yes           Std       0 OCD$DOPIG
         yes           Std       0 OCD$MONKEY
         yes           Std       0 OCD$SHUTDN
         yes           Std       3 OCN$KEYIN
         yes           Std       0 OCL$START_SHARED
         yes           Std       8 OCO$IWRITE
         yes           Std       3 OCO$MESSAGE
         yes           Std       0 OCD$REST
         yes           Std       1 OCD$MARKEM
         yes           Std       0 OCL$START_EXCLU
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_QHEAD                              OC_QUEUE
     OC_PARAM                              OC_CONSOLE$                           OC_MAXCONSOLE
     OC_DIR                                OC_INTBIT                             OC_MASK
     OC_ZIP                                OCD_ZAPPHASE                          OCD_ZAPTIME
     OCD_ZAP_SAVE                          M$CSCG                                B_VECTNIL
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:16   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:17   


        1        1        /*M* OCO$OUTPUT groups KEYINs output setup, formatting and printing */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9
       10       10        /*
       11       11          ###   ###   ###    #    ###  #   # ##### ####  #   # #####
       12       12         # # # #   # # # #  ###  # # # #   #   #   #   # #   #   #
       13       13         # # # #     # # # # #   # # # #   #   #   #   # #   #   #
       14       14         #  ## #     #  ##  ###  #  ## #   #   #   ####  #   #   #
       15       15         #   # #     #   #   # # #   # #   #   #   #     #   #   #
       16       16         #   # #   # #   #  ###  #   # #   #   #   #     #   #   #
       17       17          ###   ###   ###    #    ###   ###    #   #      ###    #
       18       18                                                                          */
       19       19
       20       20
       21       21
       22       22
       23       23        %EJECT;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:18   
       24       24        /*M* OCO$MESSHAND KEYINs routine to handle reads from CSCG */
       25       25        %SET LISTSUB='1'B;
       26       26        /*
       27       27         ###    ###    ###    #   #   #  #####   ###    ###   #   #   ###   #   #  ####
       28       28        #   #  #   #  #   #  ###  ## ##  #      #   #  #   #  #   #  #   #  #   #  #   #
       29       29        #   #  #      #   # # #   # # #  #      #      #      #   #  #   #  ##  #  #   #
       30       30        #   #  #      #   #  ###  #   #  ####    ###    ###   #####  #####  # # #  #   #
       31       31        #   #  #      #   #   # # #   #  #          #      #  #   #  #   #  #  ##  #   #
       32       32        #   #  #   #  #   #  ###  #   #  #      #   #  #   #  #   #  #   #  #   #  #   #
       33       33         ###    ###    ###    #   #   #  #####   ###    ###   #   #  #   #  #   #  ####
       34       34                                                                   */
       35       35        OCO$MESSHAND: PROC;                     /* process reads from CSCG */

     35  4 000000   000000 700200 xent  OCO$MESSHAND TSX0  ! X66_AUTO_0
         4 000001   000020 000000                    ZERO    16,0

       36       36                                                /**/
       37       37                                                /**/
       38       38        %INCLUDE CP_6;
       39      119             %B$NWIO (NAME=NWIO,PARONLY=1,STCLASS="BASED(NWIO$)");
       40      200        %INCLUDE NK_VFC_C;
       41      274        /* VFC BYTE DESCRIPTION */
       42      275        %NK$VFC (NAME=NK_VFC,STCLASS=,ALG=ALIGNED);
       43      293                                                /**/
       44      294        %INCLUDE OC_SUBS_C;
       45     1025        %INCLUDE OCI_SUBS_C;
       46     1123        %INCLUDE OCD_SUBS_C;
       47     1141        %INCLUDE JG_GHOSTS_C;
       48     1231        %INCLUDE OC_DAT_R;
       49     1392        %INCLUDE OCD_DATA_R;
       50     1405
       51     1406        %INCLUDE EL$TABLES;
       52     1729        %INCLUDE EL_SUBS_C;
       53     1813                                                /**/
       54     1814        %INCLUDE KV_PRMID_E;
       55     1988        %KV_PRMID_E;
       56     2144                                                /**/
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:19   
       57     2145                                                /**/
       58     2146    1   DCL NWIO$ PTR;
       59     2147    1   DCL TEMP$ PTR;
       60     2148    1   DCL TEMP UBIN WORD;
       61     2149    1   DCL I SBIN;
       62     2150    1   DCL J SBIN;
       63     2151                                                /**/
       64     2152                                                /**/
       65     2153    1   DCL 1 SETPARMS BASED,
       66     2154    1            2 * UBIN HALF UNAL,
       67     2155    1            2 * BIT(1) UNAL,
       68     2156    1            2 FCN UBIN(8) UNAL,
       69     2157    1            2 * BIT(1) UNAL,
       70     2158    1            2 LENGTH UBIN(8) UNAL,
       71     2159    1            2 * BIT(1) UNAL,
       72     2160    1            2 PFB UBIN(8) UNAL,
       73     2161    1            2 DVBYTE UBIN(9) UNAL,
       74     2162    1            2 VFC CHAR(1) UNAL,
       75     2163    1            2 TEXT CHAR(TEMP) UNAL;
       76     2164                                                /**/
       77     2165    1   DCL STATION CHAR(8);
       78     2166    1   DCL 1 RESTA REDEF STATION,
       79     2167    1            2 * CHAR(4) UNAL,
       80     2168    1            2 SYSID UBIN(18) UNAL,
       81     2169    1            2 * BIT(1) UNAL,
       82     2170    1            2 CADDR UBIN(17) UNAL;
       83     2171
       84     2172    1   DCL MOVEI CHAR(I) BASED;
       85     2173    1   DCL BIT9 BIT(9) BASED ALIGNED;
       86     2174
       87     2175                                                /**/
       88     2176    1   DCL 1 OC$MESSAGE BASED,
       89     2177    1            2 MK_VECT UBIN BYTE UNAL,
       90     2178    1            2 KEYIN# UBIN BYTE UNAL,
       91     2179    1            2 CADDR BIT(18) UNAL,
       92     2180    1            2 TEXT CHAR(%(140 /* CSCG_MAXMC# */ - 4)) UNAL;
       93     2181                                                /**/
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:20   
       94     2182    1   DCL 1 TEXT BASED,
       95     2183    1            2 CNT UBIN BYTE UNAL,
       96     2184    1            2 C CHAR (TEXT.CNT) UNAL;
       97     2185                                                /**/
       98     2186    1   DCL 1 MONKEY_MSGB STATIC CALIGNED,
       99     2187    1            2 STATION CHAR(8) CALIGNED INIT (' '),
      100     2188    1            2 CODE UBIN BYTE UNAL INIT (0);
      101     2189                                                /**/
      102     2190    1   DCL 1 MONKEY_MSGC STATIC CALIGNED,
      103     2191    1            2 * UBIN BYTE UNAL INIT (8),
      104     2192    1            2 * UBIN BYTE UNAL INIT (1);
      105     2193                                                /**/
      106     2194    1   DCL 1 OC$TERMSEND BASED,
      107     2195    1            2 * UBIN WORD UNAL,
      108     2196    1            2 TERM CHAR(8) UNAL,
      109     2197    1            2 SIZE UBIN(9) UNAL,
      110     2198    1            2 MESSAGE CHAR(OC$TERMSEND.SIZE) UNAL;
      111     2199
      112     2200    1   DCL MSG# UBIN HALF STATIC UNAL;
      113     2201    1   DCL NP# UBIN BYTE STATIC UNAL;
      114     2202    1   DCL OCO_PARAM CHAR(140) STATIC CALIGNED INIT (' ');
      115     2203    1   DCL OCO_PARAM$ PTR;
      116     2204    1   DCL BASED_BUF BASED CHAR(140) CALIGNED;
      117     2205    1   DCL OC_GOOSE_STA CHAR(8) STATIC SYMDEF INIT('GOOS0000');
      118     2206                                                /**/
      119     2207    1   DCL M$CSCG DCB;
      120     2208                                                /**/
      121     2209             %EL$ZAP             (NAME=EL_ZAPBUF,
      122     2210                                 STCLASS=STATIC);
      123     2213                                                /**/
      124     2214                                                /**/
      125     2215                                                /**/
      126     2216                                                /**/
      127     2217             %FPT_CGCTL          (FPTN=CSCG_DONT_WAS,
      128     2218                                      STCLASS=CONSTANT,
      129     2219                                      DCB=M$CSCG,
      130     2220                                      CGCP=CSCG_CTL);
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:21   
      131     2243                                                /**/
      132     2244                  %VLP_CGCP      (FPTN=CSCG_CTL,
      133     2245                                      STCLASS=CONSTANT,
      134     2246                                      MXACT=99999,
      135     2247                                      CONMSG=YES,
      136     2248                                      TERMCONAU=NO,
      137     2249                                      DCBCONAU=YES,
      138     2250                                      TERMCONNAU=NO,
      139     2251                                      DCBCONNAU=YES,
      140     2252                                      AUCONTERM=DISCONNECT,
      141     2253                                      AUCONDCB=NC,
      142     2254                                      AUDCONTERM=DISCONNECT,
      143     2255                                      AUDCONDCB=NC,
      144     2256                                      XSTALGL=YES,
      145     2257                                      WAS=NO,
      146     2258                                      RAS=YES,
      147     2259                                      SMD=YES,
      148     2260                                      XTYPLGL=YES,
      149     2261                                      MAXMC=CSCG_MAXMC#,
      150     2262                                      DCBCONLGL=YES,
      151     2263                                      TERMCONLGL=NO,
      152     2264                                      INPUT=YES,
      153     2265                                      OUTPUT=YES,
      154     2266                                      SECURE=NO);
      155     2309                                                /**/
      156     2310             %FPT_WRITE          (FPTN=WR_STA,
      157     2311                                      DCB=M$CSCG,
      158     2312                                      STATION=STA,
      159     2313                                      BUF=OCO_PARAM,
      160     2314                                      BP=YES,
      161     2315                                      EVENT=OC_WRDN_O);
      162     2346                                                /**/
      163     2347                  %VLP_STATION   (FPTN=STA,
      164     2348                                      WAS=NO);
      165     2375                                                /**/
      166     2376             %FPT_TIME           (FPTN=ZAP_ENTRY,
      167     2377                                      TIME=OCD_ZAPTIME,
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:22   
      168     2378                                      DEST=LOCAL,
      169     2379                                      SOURCE=CLOCK);
      170     2398                                                /**/
      171     2399             %FPT_WRSYSLOG       (FPTN=WR_ZAPERR,
      172     2400                                      ENTRY=EL_ZAPBUF,
      173     2401                                      SIZE="SIZEW(EL_ZAPBUF)",
      174     2402                                      MMINHIB=NO,
      175     2403                                      FILENUM=ERRLOG,
      176     2404                                      TYPE=EL_ZAP);
      177     2419                                                /**/
      178     2420                                                /**/
      179     2421                                                /**/
      180     2422                                                /**/
      181     2423                                                /**/
      182     2424    1   DCL OCO$MESSAGE ENTRY(3);
      183     2425    1   DCL OCP$CSCG ENTRY;
      184     2426    1   DCL OCD$MARKEM ENTRY(1);
      185     2427    1   DCL OCD$REST ENTRY;
      186     2428    1   DCL OCD$DOPIG ENTRY;
      187     2429    1   DCL OCD$MONKEY ENTRY;
      188     2430    1   DCL OCD$SLUG ENTRY;
      189     2431    1   DCL OCD$ELF ENTRY;
      190     2432    1   DCL OCD$SHUTDN ENTRY;
      191     2433    1   DCL OCN$KEYIN ENTRY(3);
      192     2434    1   DCL OCL$START_EXCLU ENTRY;
      193     2435    1   DCL OCL$START_SHARED ENTRY;
      194     2436    1   DCL OCO$IWRITE ENTRY(8);
      195     2437                                                /**/
      196     2438                                                /**/
      197     2439        /*
      198     2440                   Begin  O C O $ M E S S H A N D  Main
      199     2441                                                     */
      200     2442                                                /**/
      201     2443                                                /**/
      202     2444    1        NWIO$=ADDR(OC_QUEUE.PARMS(OC_QHEAD));

   2444  4 000002   000000 236000 xsym               LDQ     OC_QHEAD
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:23   
         4 000003   000017 402003                    MPY     15,DU
         4 000004   000000 036000 5                  ADLQ    0
         4 000005   200004 756100                    STQ     NWIO$,,AUTO

      203     2445    1        IF NWIO.CGPARM.MSGTYP# = '*AUEV'

   2445  4 000006   200004 470500                    LDP0    NWIO$,,AUTO
         4 000007   040000 106500                    CMPC    fill='040'O
         4 000010   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         4 000011   000110 000005 3                  ADSC9   CSCG_CTL+20              cn=0,n=5
         4 000012   000017 601000 4                  TNZ     s:2451

      204     2446    1        THEN
      205     2447    2        DO;

      206     2448    2             CALL OCP$CSCG;

   2448  4 000013   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000014   000000 701000 xent               TSX1    OCP$CSCG
         4 000015   000000 011000                    NOP     0

      207     2449    2             RETURN;

   2449  4 000016   000000 702200 xent               TSX2  ! X66_ARET

      208     2450    2           END;
      209     2451    1        STATION = NWIO.CGPARM.STATION#;

   2451  4 000017   040100 100500                    MLR     fill='040'O
         4 000020   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         4 000021   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8

      210     2452
      211     2453    1        IF NWIO.DVE.DVBYTE.VFC

   2453  4 000022   000003 236100                    LDQ     3,,PR0
         4 000023   100000 316003                    CANQ    32768,DU
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:24   
         4 000024   000041 600000 4                  TZE     s:2463

      212     2454    1        THEN
      213     2455    2        DO;

      214     2456    2             NK_VFC = ADDR(OC_MSGBUFFER)->BIT9;

   2456  4 000025   000000 236000 xsym               LDQ     OC_MSGBUFFER
         4 000026   777000 376003                    ANQ     -512,DU
         4 000027   200003 756100                    STQ     NK_VFC,,AUTO

      215     2457    2             I = NWIO.ARS-1;

   2457  4 000030   000002 235100                    LDA     2,,PR0
         4 000031   000001 135007                    SBLA    1,DL
         4 000032   200007 755100                    STA     I,,AUTO

      216     2458    2             NWIO.ARS = I;

   2458  4 000033   000002 755100                    STA     2,,PR0

      217     2459    2             ADDR(OC_MSGBUFFER) -> MOVEI = PINCRC(ADDR(OC_MSGBUFFER),1) -> MOVEI;

   2459  4 000034   000000 620005                    EAX0    0,AL
         4 000035   200007 721100                    LXL1    I,,AUTO
         4 000036   040040 100440                    MLR     fill='040'O
         4 000037   000000 200010 xsym               ADSC9   OC_MSGBUFFER             cn=1,n=*X0
         4 000040   000000 000011 xsym               ADSC9   OC_MSGBUFFER             cn=0,n=*X1

      218     2460    2           END;

      219     2461                                                /**/
      220     2462                                                /**/
      221     2463    1        IF OC_MSGBUFFER.FCN = 11           /* OK TO ZAP */

   2463  4 000041   000001 236000 xsym               LDQ     OC_MSGBUFFER+1
         4 000042   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:25   
         4 000043   000013 116007                    CMPQ    11,DL
         4 000044   000145 601000 4                  TNZ     s:2507

      222     2464    1        THEN
      223     2465    2        DO;

      224     2466    2             IF OC_ZIP = '1'B

   2466  4 000045   000000 234000 xsym               SZN     OC_ZIP
         4 000046   000050 605000 4                  TPL     s:2472

      225     2467    2             THEN
      226     2468    3             DO;

      227     2469    3                  RETURN;

   2469  4 000047   000000 702200 xent               TSX2  ! X66_ARET

      228     2470    3                END;
      229     2471                                                /**/
      230     2472    2             OCO_PARAM$ = ADDR (OCO_PARAM);

   2472  4 000050   000001 236000 5                  LDQ     1
         4 000051   200013 756100                    STQ     OCO_PARAM$,,AUTO

      231     2473    2             OCD_ZAPPHASE = 1 /* OCD_MONKEY_SLUG# */;

   2473  4 000052   001000 236003                    LDQ     512,DU
         4 000053   000000 756000 xsym               STQ     OCD_ZAPPHASE

      232     2474    2             CALL M$TIME (ZAP_ENTRY) ALTRET (SO_WHAT);

   2474  4 000054   000144 630400 1                  EPPR0   ZAP_ENTRY
         4 000055   420004 713400                    CLIMB   alt,+8196
         4 000056   402000 401760                    pmme    nvectors=5
         4 000057   000060 702000 4                  TSX2    SO_WHAT

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:26   
   2473  4 000060                       SO_WHAT      null
      233     2475    2   SO_WHAT:  ;
      234     2476    2             EL_ZAPBUF.STATION = OCD_ZAP_SAVE.CONS_STA;

   2476  4 000060   040000 100400                    MLR     fill='040'O
         4 000061   000000 000010 xsym               ADSC9   OCD_ZAP_SAVE             cn=0,n=8
         4 000062   000053 000010 1                  ADSC9   EL_ZAPBUF                cn=0,n=8

      235     2477    2             EL_ZAPBUF.OPER_TEXT=ADDR(ADDR(OCD_ZAP_SAVE.MESSAGE)

   2477  4 000063   000006 220000 xsym               LDX0    OCD_ZAP_SAVE+6
         4 000064   000777 360003                    ANX0    511,DU
         4 000065   040000 100440                    MLR     fill='040'O
         4 000066   000006 400010 xsym               ADSC9   OCD_ZAP_SAVE+6           cn=2,n=*X0
         4 000067   000055 000214 1                  ADSC9   EL_ZAPBUF+2              cn=0,n=140

      236     2478    2                  -> OC$MESSAGE.TEXT) -> OC$TERMSEND.MESSAGE;
      237     2479                                                /**/
      238     2480    2             CALL M$WRSYSLOG (WR_ZAPERR) ALTRET (ANOTHER_ONE);

   2480  4 000070   000160 630400 1                  EPPR0   WR_ZAPERR
         4 000071   470001 713400                    CLIMB   alt,+28673
         4 000072   400400 401760                    pmme    nvectors=2
         4 000073   000074 702000 4                  TSX2    ANOTHER_ONE

   2477  4 000074                       ANOTHER_ONE  null
      239     2481    2   ANOTHER_ONE:;
      240     2482    2             OC_ZIP = '1'B;

   2482  4 000074   400000 236003                    LDQ     -131072,DU
         4 000075   000000 756000 xsym               STQ     OC_ZIP

      241     2483    2             CALL M$CGCTL (CSCG_DONT_WAS) ALTRET (NO_WAS_);

   2483  4 000076   000000 630400 3                  EPPR0   CSCG_DONT_WAS
         4 000077   500003 713400                    CLIMB   alt,+32771
         4 000100   411400 401760                    pmme    nvectors=20
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:27   
         4 000101   000102 702000 4                  TSX2    NO_WAS_

   2482  4 000102                       NO_WAS_      null
      242     2484    2   NO_WAS_:  ;
      243     2485    2             STA.STATION# = 'MONKEY';

   2485  4 000102   040000 100400                    MLR     fill='040'O
         4 000103   000112 000006 3                  ADSC9   CSCG_CTL+22              cn=0,n=6
         4 000104   000134 000010 1                  ADSC9   STA                      cn=0,n=8

      244     2486    2             OCO_PARAM$ -> OC$MESSAGE = OCD_ZAP_SAVE.MESSAGE;

   2486  4 000105   200013 470500                    LDP0    OCO_PARAM$,,AUTO
         4 000106   000100 100400                    MLR     fill='000'O
         4 000107   000002 200214 xsym               ADSC9   OCD_ZAP_SAVE+2           cn=1,n=140
         4 000110   000000 000214                    ADSC9   0,,PR0                   cn=0,n=140

      245     2487    2             OCO_PARAM$ -> OC$MESSAGE.MK_VECT = 6 /* MKV_OCA$KMISC# */;

   2487  4 000111   000100 101400                    MRL     fill='000'O
         4 000112   000010 000004 xsym               ADSC9   B_VECTNIL+8              cn=0,n=4
         4 000113   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      246     2488    2             OCO_PARAM$ -> OC$MESSAGE.KEYIN# = 9 /* KEY_MNKZAP1# */;

   2488  4 000114   000100 101400                    MRL     fill='000'O
         4 000115   000013 000004 xsym               ADSC9   B_VECTNIL+11             cn=0,n=4
         4 000116   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1

      247     2489    2             WR_STA.V.EVENT# = BITBIN (OCD_ZAP_SAVE.CSCG_EVID);

   2489  4 000117   000045 235000 xsym               LDA     OCD_ZAP_SAVE+37
         4 000120   000046 236000 xsym               LDQ     OCD_ZAP_SAVE+38
         4 000121   000033 773000                    LRL     27
         4 000122   000131 756000 1                  STQ     WR_STA+9

      248     2490    2             CALL M$WRITE (WR_STA) ALTRET (OH_OH);
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:28   

   2490  4 000123   000120 630400 1                  EPPR0   WR_STA
         4 000124   440001 713400                    CLIMB   alt,write
         4 000125   401400 401760                    pmme    nvectors=4
         4 000126   000130 702000 4                  TSX2    OH_OH

      249     2491                                                /**/
      250     2492    3             DO WHILE ('0'B);

   2492  4 000127   000144 710000 4                  TRA     s:2501

      251     2493    3   OH_OH:
      252     2494    3                  MSG# = 378 /* STATION_MSG# */;

   2494  4 000130   000572 220003       OH_OH        LDX0    378,DU
         4 000131   000004 740000 1                  STX0    MSG#

      253     2495    3                  NP# = 3;

   2495  4 000132   003000 236003                    LDQ     1536,DU
         4 000133   000005 756000 1                  STQ     NP#

      254     2496    3                  MONKEY_MSGB.CODE = 0;

   2496  4 000134   000000 236003                    LDQ     0,DU
         4 000135   000002 552040 1                  STBQ    MONKEY_MSGB+2,'40'O

      255     2497    3                  MONKEY_MSGB.STATION = STA.STATION#;

   2497  4 000136   000134 237000 1                  LDAQ    STA
         4 000137   000000 757000 1                  STAQ    MONKEY_MSGB

      256     2498    3                  CALL OCO$IWRITE (OCD_ZAP_SAVE.CSCG_EVID.CADDR, MSG#, NP#,

   2498  4 000140   000002 630400 5                  EPPR0   2
         4 000141   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000142   000000 701000 xent               TSX1    OCO$IWRITE
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:29   
         4 000143   000000 011000                    NOP     0

      257     2499    3                       MONKEY_MSGC, MONKEY_MSGB, 0, ' ', 0);
      258     2500    3                END;

      259     2501    2             RETURN;

   2501  4 000144   000000 702200 xent               TSX2  ! X66_ARET

      260     2502    2           END;
      261     2503                                                /**/
      262     2504                                      /* Special checks are done here if
      263     2505                                           Zap-In-Progress (ZIP)          */
      264     2506                                                /**/
      265     2507    1        IF OC_ZIP

   2507  4 000145   000000 234000 xsym               SZN     OC_ZIP
         4 000146   000251 605000 4                  TPL     s:2553

      266     2508    1        THEN
      267     2509    2        DO;                                /**/

      268     2510    2             IF OC_MSGBUFFER.MSG# = 1023 /* PREZAP_MSG# */

   2510  4 000147   000000 720000 xsym               LXL0    OC_MSGBUFFER
         4 000150   001777 100003                    CMPX0   1023,DU
         4 000151   000210 601000 4                  TNZ     s:2530

      269     2511    2             THEN
      270     2512    3             DO;

      271     2513    3                  IF (STATION = 'SLUG'

   2513  4 000152   040000 106500                    CMPC    fill='040'O
         4 000153   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000154   000114 000004 3                  ADSC9   CSCG_CTL+24              cn=0,n=4
         4 000155   000162 600000 4                  TZE     s:2513+8
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:30   
         4 000156   040000 106500                    CMPC    fill='040'O
         4 000157   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000160   000115 000003 3                  ADSC9   CSCG_CTL+25              cn=0,n=3
         4 000161   000171 601000 4                  TNZ     s:2520
         4 000162   000000 236000 xsym               LDQ     OCD_ZAPPHASE
         4 000163   777000 376003                    ANQ     -512,DU
         4 000164   001000 116003                    CMPQ    512,DU
         4 000165   000171 601000 4                  TNZ     s:2520

      272     2514    3                       OR
      273     2515    3                       STATION = 'MBS')
      274     2516    3                       AND
      275     2517    3                       OCD_ZAPPHASE = 1 /* OCD_MONKEY_SLUG# */
      276     2518    3                  THEN
      277     2519    3                       CALL OCD$DOPIG;

   2519  4 000166   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000167   000000 701000 xent               TSX1    OCD$DOPIG
         4 000170   000000 011000                    NOP     0

      278     2520    3                  IF STATION = 'PIG'

   2520  4 000171   040000 106500                    CMPC    fill='040'O
         4 000172   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000173   000116 000003 3                  ADSC9   CSCG_CTL+26              cn=0,n=3
         4 000174   000200 601000 4                  TNZ     s:2523

      279     2521    3                  THEN
      280     2522    3                       CALL OCD$MONKEY;

   2522  4 000175   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000176   000000 701000 xent               TSX1    OCD$MONKEY
         4 000177   000000 011000                    NOP     0

      281     2523    3                  IF STATION = 'MONKEY'

   2523  4 000200   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:31   
         4 000201   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000202   000112 000006 3                  ADSC9   CSCG_CTL+22              cn=0,n=6
         4 000203   000207 601000 4                  TNZ     s:2526

      282     2524    3                  THEN
      283     2525    3                       CALL OCD$REST;

   2525  4 000204   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000205   000000 701000 xent               TSX1    OCD$REST
         4 000206   000000 011000                    NOP     0

      284     2526    3                  RETURN;

   2526  4 000207   000000 702200 xent               TSX2  ! X66_ARET

      285     2527    3                END;                       /* DO IF PREZAP DONE MESS */
      286     2528                                                /**/
      287     2529                                                /**/
      288     2530    2             IF OC_MSGBUFFER.FCN = 7 /* zap complete indicator */

   2530  4 000210   000007 116007                    CMPQ    7,DL
         4 000211   000251 601000 4                  TNZ     s:2553

      289     2531    2             THEN
      290     2532    3             DO;

      291     2533    3                  IF STATION = 'ELF'

   2533  4 000212   040000 106500                    CMPC    fill='040'O
         4 000213   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000214   000117 000003 3                  ADSC9   CSCG_CTL+27              cn=0,n=3
         4 000215   000222 601000 4                  TNZ     s:2539

      292     2534    3                  THEN
      293     2535    4                  DO;

      294     2536    4                       CALL OCD$SLUG;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:32   

   2536  4 000216   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000217   000000 701000 xent               TSX1    OCD$SLUG
         4 000220   000000 011000                    NOP     0

      295     2537    4                       RETURN;

   2537  4 000221   000000 702200 xent               TSX2  ! X66_ARET

      296     2538    4                     END;
      297     2539    3                  IF (STATION = 'SLUG'

   2539  4 000222   040000 106500                    CMPC    fill='040'O
         4 000223   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000224   000114 000004 3                  ADSC9   CSCG_CTL+24              cn=0,n=4
         4 000225   000232 600000 4                  TZE     s:2539+8
         4 000226   040000 106500                    CMPC    fill='040'O
         4 000227   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000230   000115 000003 3                  ADSC9   CSCG_CTL+25              cn=0,n=3
         4 000231   000242 601000 4                  TNZ     s:2547
         4 000232   000000 236000 xsym               LDQ     OCD_ZAPPHASE
         4 000233   777000 376003                    ANQ     -512,DU
         4 000234   006000 116003                    CMPQ    3072,DU
         4 000235   000242 601000 4                  TNZ     s:2547

      298     2540    3                       OR STATION = 'MBS')
      299     2541    3                       AND OCD_ZAPPHASE = 6 /* OCD_SLUG2# */
      300     2542    3                  THEN
      301     2543    4                  DO;

      302     2544    4                       CALL OCD$SHUTDN;

   2544  4 000236   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000237   000000 701000 xent               TSX1    OCD$SHUTDN
         4 000240   000000 011000                    NOP     0

      303     2545    4                       RETURN;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:33   

   2545  4 000241   000000 702200 xent               TSX2  ! X66_ARET

      304     2546    4                     END;
      305     2547    3                  CALL OCD$MARKEM (STATION);

   2547  4 000242   200011 631500                    EPPR1   STATION,,AUTO
         4 000243   200014 451500                    STP1    OCO_PARAM$+1,,AUTO
         4 000244   200014 630500                    EPPR0   OCO_PARAM$+1,,AUTO
         4 000245   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000246   000000 701000 xent               TSX1    OCD$MARKEM
         4 000247   000000 011000                    NOP     0

      306     2548    3                  RETURN;

   2548  4 000250   000000 702200 xent               TSX2  ! X66_ARET

      307     2549    3                END;                /* DO IF ZAP DONE FROM SOME
      308     2550                                                     GHOST */
      309     2551    2           END;                            /* DO IF ZAP IN PROGRESS */
      310     2552                                                /**/
      311     2553    1        IF NWIO.DVE.DVBYTE.VFC

   2553  4 000251   000003 236100                    LDQ     3,,PR0
         4 000252   100000 316003                    CANQ    32768,DU
         4 000253   000430 600000 4                  TZE     s:2614

      312     2554    1        THEN
      313     2555    2        DO CASE (NK_VFC.FCN);

   2555  4 000254   200003 236100                    LDQ     NK_VFC,,AUTO
         4 000255   000037 772000                    QRL     31
         4 000256   000007 376007                    ANQ     7,DL
         4 000257   000003 116007                    CMPQ    3,DL
         4 000260   000262 602006 4                  TNC     s:2555+6,QL
         4 000261   000430 710000 4                  TRA     s:2614
         4 000262   000265 710000 4                  TRA     s:2559
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:34   
         4 000263   000266 710000 4                  TRA     s:2563
         4 000264   000265 710000 4                  TRA     s:2559

      314     2556                                                /**/
      315     2557    2        CASE (%VFCF_RFU,

      316     2558    2             %VFCF_RSV);
      317     2559    2           RETURN;

   2559  4 000265   000000 702200 xent               TSX2  ! X66_ARET

      318     2560                                                /**/
      319     2561    2        CASE (%VFCF_SPC);

      320     2562                                                /**/
      321     2563    3           DO CASE (NK_VFC.COUNT);

   2563  4 000266   200003 236100                    LDQ     NK_VFC,,AUTO
         4 000267   000033 772000                    QRL     27
         4 000270   000017 376007                    ANQ     15,DL
         4 000271   000004 136007                    SBLQ    4,DL
         4 000272   000014 116007                    CMPQ    12,DL
         4 000273   000275 602006 4                  TNC     s:2563+7,QL
         4 000274   000427 710000 4                  TRA     s:2605
         4 000275   000311 710000 4                  TRA     s:2573
         4 000276   000427 710000 4                  TRA     s:2605
         4 000277   000427 710000 4                  TRA     s:2605
         4 000300   000427 710000 4                  TRA     s:2605
         4 000301   000427 710000 4                  TRA     s:2605
         4 000302   000427 710000 4                  TRA     s:2605
         4 000303   000427 710000 4                  TRA     s:2605
         4 000304   000427 710000 4                  TRA     s:2605
         4 000305   000427 710000 4                  TRA     s:2605
         4 000306   000427 710000 4                  TRA     s:2605
         4 000307   000430 710000 4                  TRA     s:2614
         4 000310   000430 710000 4                  TRA     s:2614

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:35   
      322     2564                                                /**/
      323     2565    3           CASE (%VFCS_SPRM);

      324     2566                                           /* SPECIAL CASE: If this message
      325     2567                                                is a special terminal parameter
      326     2568                                                control buffer, take the
      327     2569                                                appropriate action for this
      328     2570                                                type of parameter, then
      329     2571                                                just return (dont format and/or
      330     2572                                                print anything */
      331     2573    3              TEMP$ = PINCRC(ADDR(OC_MSGBUFFER.MESS),OC_MSGBUFFER.NPARAMS);

   2573  4 000311   000001 236000 xsym               LDQ     OC_MSGBUFFER+1
         4 000312   000011 772000                    QRL     9
         4 000313   000777 376007                    ANQ     511,DL
         4 000314   000020 736000                    QLS     16
         4 000315   000012 036000 5                  ADLQ    10
         4 000316   200005 756100                    STQ     TEMP$,,AUTO

      332     2574    3              IF TEMP$ -> SETPARMS.FCN = %KV_PRMID_PROMPT

   2574  4 000317   200005 471500                    LDP1    TEMP$,,AUTO
         4 000320   003100 061500                    CSR     bolr='003'O
         4 000321   100000 410010                    BDSC    0,,PR1                   by=2,bit=1,n=8
         4 000322   200014 000044                    BDSC    OCO_PARAM$+1,,AUTO       by=0,bit=0,n=36
         4 000323   200014 236100                    LDQ     OCO_PARAM$+1,,AUTO
         4 000324   000005 116007                    CMPQ    5,DL
         4 000325   000426 601000 4                  TNZ     s:2598

      333     2575    3              THEN
      334     2576    4              DO;                          /* Handle the "Set Prompt" case */

      335     2577    5                   DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   2577  4 000326   200007 450100                    STZ     I,,AUTO
         4 000327   000422 710000 4                  TRA     s:2596+1

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:36   
      336     2578    5                        IF OC_CONSOLE.CID(I) = RESTA.CADDR

   2578  4 000330   200012 236100                    LDQ     STATION+1,,AUTO
         4 000331   377777 376007                    ANQ     131071,DL
         4 000332   200014 756100                    STQ     OCO_PARAM$+1,,AUTO
         4 000333   200007 236100                    LDQ     I,,AUTO
         4 000334   000076 402007                    MPY     62,DL
         4 000335   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000336   000012 236106                    LDQ     10,QL,PR0
         4 000337   000022 772000                    QRL     18
         4 000340   200014 116100                    CMPQ    OCO_PARAM$+1,,AUTO
         4 000341   000421 601000 4                  TNZ     s:2596

      337     2579    5                        THEN
      338     2580    6                        DO;

      339     2581    6                             TEMP = TEMP$ -> SETPARMS.LENGTH - 3;

   2581  4 000342   200005 471500                    LDP1    TEMP$,,AUTO
         4 000343   003100 061500                    CSR     bolr='003'O
         4 000344   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         4 000345   200014 000044                    BDSC    OCO_PARAM$+1,,AUTO       by=0,bit=0,n=36
         4 000346   200014 236100                    LDQ     OCO_PARAM$+1,,AUTO
         4 000347   000003 136007                    SBLQ    3,DL
         4 000350   200006 756100                    STQ     TEMP,,AUTO

      340     2582    6                             J = TEMP$ -> SETPARMS.PFB;

   2582  4 000351   003100 061500                    CSR     bolr='003'O
         4 000352   100001 010010                    BDSC    1,,PR1                   by=0,bit=1,n=8
         4 000353   200010 000044                    BDSC    J,,AUTO                  by=0,bit=0,n=36

      341     2583    6                             IF J > 0

   2583  4 000354   200010 235100                    LDA     J,,AUTO
         4 000355   000360 604400 4                  TMOZ    s:2586

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:37   
      342     2584    6                             THEN
      343     2585    6                                  J = J - 1;

   2585  4 000356   000001 336007                    LCQ     1,DL
         4 000357   200010 056100                    ASQ     J,,AUTO

      344     2586    6                             IF J > 2

   2586  4 000360   200010 235100                    LDA     J,,AUTO
         4 000361   000002 115007                    CMPA    2,DL
         4 000362   000365 604400 4                  TMOZ    s:2589

      345     2587    6                             THEN
      346     2588    6                                  J = 1;   /* User prompt */

   2588  4 000363   000001 236007                    LDQ     1,DL
         4 000364   200010 756100                    STQ     J,,AUTO

      347     2589    6                             ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2589  4 000365   200010 236100                    LDQ     J,,AUTO
         4 000366   000042 402007                    MPY     34,DL
         4 000367   200014 756100                    STQ     OCO_PARAM$+1,,AUTO
         4 000370   200007 236100                    LDQ     I,,AUTO
         4 000371   000370 402007                    MPY     248,DL
         4 000372   200014 036100                    ADLQ    OCO_PARAM$+1,,AUTO
         4 000373   000011 402007                    MPY     9,DL
         4 000374   000000 116003                    CMPQ    0,DU
         4 000375   000377 605000 4                  TPL     s:2589+10
         4 000376   000044 036003                    ADLQ    36,DU
         4 000377   003106 061500                    CSR     bolr='003'O
         4 000400   200006 000044                    BDSC    TEMP,,AUTO               by=0,bit=0,n=36
         4 000401   000022 010010                    BDSC    18,Q,PR0                 by=0,bit=1,n=8

      348     2590    6                                  PROMPT_TABLE.COUNT_(J) = TEMP;
      349     2591    6                             ADDR(OC_CONSOLE.PROMPTS(I)) ->

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:38   
   2591  4 000402   200010 236100                    LDQ     J,,AUTO
         4 000403   000042 402007                    MPY     34,DL
         4 000404   200014 756100                    STQ     OCO_PARAM$+1,,AUTO
         4 000405   200007 236100                    LDQ     I,,AUTO
         4 000406   000370 402007                    MPY     248,DL
         4 000407   200014 036100                    ADLQ    OCO_PARAM$+1,,AUTO
         4 000410   200006 720100                    LXL0    TEMP,,AUTO
         4 000411   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000412   040106 100540                    MLR     fill='040'O
         4 000413   100001 600010                    ADSC9   1,,PR1                   cn=3,n=*X0
         4 000414   000022 200037                    ADSC9   18,Q,PR0                 cn=1,n=31

      350     2592    6                                  PROMPT_TABLE.PROMPT(J) =
      351     2593    6                                  TEMP$ -> SETPARMS.TEXT;
      352     2594    6                             I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   2594  4 000415   000000 235000 xsym               LDA     OC_MAXCONSOLE
         4 000416   000022 771000                    ARL     18
         4 000417   000001 035007                    ADLA    1,DL
         4 000420   200007 755100                    STA     I,,AUTO

      353     2595    6                           END;            /* DO IF SYSID = SYSID */

      354     2596    5                      END;                 /* DO I = 0 TO MAX_CONSOLES# */

   2596  4 000421   200007 054100                    AOS     I,,AUTO
         4 000422   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000423   000022 772000                    QRL     18
         4 000424   200007 116100                    CMPQ    I,,AUTO
         4 000425   000330 605000 4                  TPL     s:2578

      355     2597    4                 END;                      /* DO IF SET PROMPT CASE */

      356     2598    3              RETURN;                      /* after setting prompt */

   2598  4 000426   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:39   
      357     2599                                                /**/
      358     2600    3           CASE (%VFCS_TRS0,

      359     2601    3                   %VFCS_TRS1);
      360     2602    3              ;                            /* let these trickle thru */
      361     2603                                                /**/
      362     2604    3           CASE (ELSE);

      363     2605    3              RETURN;

   2605  4 000427   000000 702200 xent               TSX2  ! X66_ARET

      364     2606    3           END;                            /* DO CASE NK$VFC.COUNT */

      365     2607                                                /**/
      366     2608    2        END;                               /* DO CASE NK$VFC.FCN */

      367     2609                                                /**/
      368     2610                                                /**/
      369     2611                                                /**/
      370     2612                                                /**/
      371     2613                                                /**/
      372     2614    1        IF OC_MSGBUFFER.FCN = 8 /* INTERNAL KEYIN */       /* CHECK OF KEYIN */

   2614  4 000430   000001 236000 xsym               LDQ     OC_MSGBUFFER+1
         4 000431   000777 376007                    ANQ     511,DL
         4 000432   000010 116007                    CMPQ    8,DL
         4 000433   000465 601000 4                  TNZ     s:2632

      373     2615    1        THEN
      374     2616    2        DO;

      375     2617    2             IF STATION = 'GOOSE' OR STATION = 'OGOOSE'

   2617  4 000434   040000 106500                    CMPC    fill='040'O
         4 000435   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000436   000120 000005 3                  ADSC9   CSCG_CTL+28              cn=0,n=5
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:40   
         4 000437   000444 600000 4                  TZE     s:2620
         4 000440   040000 106500                    CMPC    fill='040'O
         4 000441   200011 000010                    ADSC9   STATION,,AUTO            cn=0,n=8
         4 000442   000122 000006 3                  ADSC9   CSCG_CTL+30              cn=0,n=6
         4 000443   000464 601000 4                  TNZ     s:2628

      376     2618    2             THEN
      377     2619    3             DO;

      378     2620    3                  TEMP = OC_MSGBUFFER2.SIZE; /* NEED AN ENTIRE WORD */

   2620  4 000444   000005 236000 xsym               LDQ     OC_MSGBUFFER+5
         4 000445   000033 772000                    QRL     27
         4 000446   200006 756100                    STQ     TEMP,,AUTO

      379     2621    3                  IF TEMP < 140 /* CSCG_MAXMC# */    /* CHECK IF SIZE IS REASONABLE */

   2621  4 000447   000214 116007                    CMPQ    140,DL
         4 000450   000463 603000 4                  TRC     s:2625

      380     2622    3                  THEN
      381     2623    3                       CALL OCN$KEYIN(OC_MSGBUFFER2.MESS,

   2623  4 000451   000013 236000 5                  LDQ     11
         4 000452   200016 756100                    STQ     OCO_PARAM$+3,,AUTO
         4 000453   200006 631500                    EPPR1   TEMP,,AUTO
         4 000454   200015 451500                    STP1    OCO_PARAM$+2,,AUTO
         4 000455   000014 236000 5                  LDQ     12
         4 000456   200014 756100                    STQ     OCO_PARAM$+1,,AUTO
         4 000457   200014 630500                    EPPR0   OCO_PARAM$+1,,AUTO
         4 000460   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000461   000000 701000 xent               TSX1    OCN$KEYIN
         4 000462   000000 011000                    NOP     0

      382     2624    3                            TEMP,OC_GOOSE_STA);
      383     2625    3                  RETURN;

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:41   
   2625  4 000463   000000 702200 xent               TSX2  ! X66_ARET

      384     2626    3                END;
      385     2627    2             ELSE
      386     2628    2                  RETURN;

   2628  4 000464   000000 702200 xent               TSX2  ! X66_ARET

      387     2629    2           END;
      388     2630                                                /**/
      389     2631                                                /**/
      390     2632    1        IF OC_MSGBUFFER.FCN = 9 /* Open :OCHIST shared */

   2632  4 000465   000011 116007                    CMPQ    9,DL
         4 000466   000473 601000 4                  TNZ     s:2640

      391     2633    1        THEN
      392     2634    2        DO;

      393     2635    2             CALL OCL$START_SHARED;

   2635  4 000467   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000470   000000 701000 xent               TSX1    OCL$START_SHARED
         4 000471   000000 011000                    NOP     0

      394     2636    2             RETURN;

   2636  4 000472   000000 702200 xent               TSX2  ! X66_ARET

      395     2637    2           END;
      396     2638                                                /**/
      397     2639                                                /**/
      398     2640    1        IF OC_MSGBUFFER.FCN = 10 /* Open :OCHIST exclusive */

   2640  4 000473   000012 116007                    CMPQ    10,DL
         4 000474   000501 601000 4                  TNZ     s:2648

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:42   
      399     2641    1        THEN
      400     2642    2        DO;

      401     2643    2             CALL OCL$START_EXCLU;

   2643  4 000475   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000476   000000 701000 xent               TSX1    OCL$START_EXCLU
         4 000477   000000 011000                    NOP     0

      402     2644    2             RETURN;

   2644  4 000500   000000 702200 xent               TSX2  ! X66_ARET

      403     2645    2           END;
      404     2646                                                /**/
      405     2647                                                /**/
      406     2648    1        CALL OCO$MESSAGE (STATION,OC_MSGBUFFER,NWIO.ARS);

   2648  4 000501   200004 236100                    LDQ     NWIO$,,AUTO
         4 000502   000002 036003                    ADLQ    2,DU
         4 000503   200016 756100                    STQ     OCO_PARAM$+3,,AUTO
         4 000504   000015 236000 5                  LDQ     13
         4 000505   200015 756100                    STQ     OCO_PARAM$+2,,AUTO
         4 000506   200011 631500                    EPPR1   STATION,,AUTO
         4 000507   200014 451500                    STP1    OCO_PARAM$+1,,AUTO
         4 000510   200014 630500                    EPPR0   OCO_PARAM$+1,,AUTO
         4 000511   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000512   000000 701000 xent               TSX1    OCO$MESSAGE
         4 000513   000000 011000                    NOP     0

      407     2649                                                /**/
      408     2650    1        RETURN;

   2650  4 000514   000000 702200 xent               TSX2  ! X66_ARET
      409     2651                                                /**/
      410     2652    1   END OCO$MESSHAND;
      411     2653        %EOD;
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:43   

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:44   
--  Include file information  --

   KV_PRMID_E.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   OCD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OCD_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCO$MESSHAND.
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:45   

 **** Variables and constants ****

  ****  Section 001  Data  OCO$MESSHAND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    53-0-0/w STRC(1332)  r     1 EL_ZAPBUF                  0-0-0/c STRC(81)    r     1 MONKEY_MSGB
     3-0-0/c STRC(18)    r     1 MONKEY_MSGC                4-0-0/b UBIN(18)    r     1 MSG#
     5-0-0/b UBIN(9)     r     1 NP#                        6-0-0/c CHAR(140)   r     1 OCO_PARAM
    51-0-0/c CHAR(8)     r     1 OC_GOOSE_STA             134-0-0/w STRC(288)   r     1 STA
   120-0-0/d STRC(432)   r     1 WR_STA                   160-0-0/d STRC(288)   r     1 WR_ZAPERR
   144-0-0/d STRC(432)   r     1 ZAP_ENTRY

  ****  Section 003 RoData OCO$MESSHAND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    64-0-0/d STRC(720)   r     1 CSCG_CTL                   0-0-0/d STRC(1872)  r     1 CSCG_DONT_WAS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w SBIN        r     1 I                         10-0-0/w SBIN        r     1 J
     3-0-0/w STRC(9)     r     1 NK_VFC                     4-0-0/w PTR         r     1 NWIO$
    13-0-0/w PTR         r     1 OCO_PARAM$                11-0-0/c STRC(72)    r     1 RESTA
    11-0-0/c CHAR(8)     r     1 STATION                    6-0-0/w UBIN        r     1 TEMP
     5-0-0/w PTR         r     1 TEMP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:46   
     0-0-0/c UBIN(9)     r     1 OCD_ZAPPHASE               0-0-0/c CHAR(11)    r     1 OCD_ZAPTIME
     0-0-0/c STRC(1377)  r     1 OCD_ZAP_SAVE               0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE              0-0-0/c STRC(1800)  r     1 OC_MSGBUFFER
     0-0-0/c STRC(1800)  r     1 OC_MSGBUFFER2              0-0-0/w UBIN        r     1 OC_QHEAD
     0-0-0/w STRC(540)   r     1 OC_QUEUE(0:8191)           0-0-0/w BIT         r     1 OC_ZIP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT (9)     r     1 BIT9                       0-0-0N  NULL        r     1 M$CSCG
     0-0-0/c ACHR        r     1 MOVEI                      0-0-0/w STRC(468)   r     1 NWIO
     0-0-0/c STRC(1260)  r     1 OC$MESSAGE                 0-0-0/c ASTR(117)   r     1 OC$TERMSEND
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)
     0-0-0/c STRC(306)   r     1 PROMPT_TABLE(0:2)
     0-0-0/c ASTR(63)    r     1 SETPARMS                   0-0-0/c ASTR(9)     r     1 TEXT


   Procedure OCO$MESSHAND requires 333 words for executable code.
   Procedure OCO$MESSHAND requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:47   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:48   
          MINI XREF LISTING

ANOTHER_ONE
      2477**LABEL    2480--CALLALT
BIT9
      2173**DCL      2456>>ASSIGN
CSCG_CTL
      2278**DCL      2232--DCLINIT
CSCG_CTL.DVBYTE.REREAD#
      2292**DCL      2293--REDEF
CSCG_DONT_WAS
      2231**DCL      2483<>CALL
CSCG_DONT_WAS.V
      2236**DCL      2231--DCLINIT
EL_ZAPBUF
      2211**DCL      2415--DCLINIT  2417--DCLINIT
EL_ZAPBUF.OPER_TEXT
      2211**DCL      2477<<ASSIGN
EL_ZAPBUF.STATION
      2211**DCL      2476<<ASSIGN
I
      2149**DCL      2172--IMP-SIZ  2457<<ASSIGN   2458>>ASSIGN   2459>>ASSIGN   2459>>ASSIGN   2577<<DOINDEX
      2578>>IF       2589>>ASSIGN   2591>>ASSIGN   2594<<ASSIGN
J
      2150**DCL      2582<<ASSIGN   2583>>IF       2585<<ASSIGN   2585>>ASSIGN   2586>>IF       2588<<ASSIGN
      2589>>ASSIGN   2591>>ASSIGN
M$CGCTL
        68**DCL-ENT  2483--CALL
M$TIME
       114**DCL-ENT  2474--CALL
M$WRITE
        48**DCL-ENT  2490--CALL
M$WRSYSLOG
        96**DCL-ENT  2480--CALL
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:49   
MONKEY_MSGB
      2186**DCL      2498<>CALL
MONKEY_MSGB.CODE
      2188**DCL      2496<<ASSIGN
MONKEY_MSGB.STATION
      2187**DCL      2497<<ASSIGN
MONKEY_MSGC
      2190**DCL      2498<>CALL
MOVEI
      2172**DCL      2459<<ASSIGN   2459>>ASSIGN
MSG#
      2200**DCL      2494<<ASSIGN   2498<>CALL
NK_VFC
       286**DCL      2456<<ASSIGN
NK_VFC.COUNT
       290**DCL      2563>>DOCASE
NK_VFC.FCN
       290**DCL      2555>>DOCASE
NO_WAS_
      2482**LABEL    2483--CALLALT
NP#
      2201**DCL      2495<<ASSIGN   2498<>CALL
NWIO.ARS
       125**DCL      2457>>ASSIGN   2458<<ASSIGN   2648<>CALL
NWIO.CGPARM.MSGIDXT
       149**DCL       152--REDEF
NWIO.CGPARM.MSGTYP#
       143**DCL      2445>>IF
NWIO.CGPARM.STATION#
       143**DCL      2451>>ASSIGN
NWIO.DVE.DVBYTE.VFC
       125**DCL      2453>>IF       2553>>IF
NWIO$
      2146**DCL       123--IMP-PTR  2444<<ASSIGN   2445>>IF       2451>>ASSIGN   2453>>IF       2457>>ASSIGN
      2458>>ASSIGN   2553>>IF       2648>>CALL
OC$MESSAGE
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:50   
      2176**DCL      2486<<ASSIGN
OC$MESSAGE.KEYIN#
      2178**DCL      2488<<ASSIGN
OC$MESSAGE.MK_VECT
      2177**DCL      2487<<ASSIGN
OC$MESSAGE.TEXT
      2180**DCL      2477--ASSIGN   2477--ASSIGN
OC$TERMSEND.MESSAGE
      2198**DCL      2477>>ASSIGN
OC$TERMSEND.SIZE
      2197**DCL      2198--IMP-SIZ  2477>>ASSIGN
OCD$DOPIG
      2428**DCL-ENT  2519--CALL
OCD$MARKEM
      2426**DCL-ENT  2547--CALL
OCD$MONKEY
      2429**DCL-ENT  2522--CALL
OCD$REST
      2427**DCL-ENT  2525--CALL
OCD$SHUTDN
      2432**DCL-ENT  2544--CALL
OCD$SLUG
      2430**DCL-ENT  2536--CALL
OCD_ZAPPHASE
      1401**DCL      2473<<ASSIGN   2513>>IF       2539>>IF
OCD_ZAPTIME
      1401**DCL      2392--DCLINIT  2393--DCLINIT
OCD_ZAP_SAVE.CONS_STA
      1402**DCL      2476>>ASSIGN
OCD_ZAP_SAVE.CSCG_EVID
      1403**DCL      2489>>ASSIGN
OCD_ZAP_SAVE.CSCG_EVID.CADDR
      1403**DCL      2498<>CALL
OCD_ZAP_SAVE.MESSAGE
      1402**DCL      2477--ASSIGN   2477--ASSIGN   2486>>ASSIGN
OCL$START_EXCLU
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:51   
      2434**DCL-ENT  2643--CALL
OCL$START_SHARED
      2435**DCL-ENT  2635--CALL
OCN$KEYIN
      2433**DCL-ENT  2623--CALL
OCO$IWRITE
      2436**DCL-ENT  2498--CALL
OCO$MESSAGE
      2424**DCL-ENT  2648--CALL
OCO_PARAM
      2202**DCL      2333--DCLINIT  2334--DCLINIT  2472--ASSIGN
OCO_PARAM$
      2203**DCL      2472<<ASSIGN   2486>>ASSIGN   2487>>ASSIGN   2488>>ASSIGN
OCP$CSCG
      2425**DCL-ENT  2448--CALL
OC_CONSOLE.ATTR
      1345**DCL      1345--REDEF
OC_CONSOLE.ATTRO
      1346**DCL      1346--REDEF
OC_CONSOLE.CID
      1344**DCL      1345--REDEF    2578>>IF
OC_CONSOLE.PROMPTS
      1349**DCL      2589--ASSIGN   2591--ASSIGN
OC_CONSOLE.STATION
      1343**DCL      1343--REDEF
OC_CONSOLE$
      1342**DCL      1343--IMP-PTR  2578>>IF       2589>>ASSIGN   2591>>ASSIGN
OC_DIR
      1385**DCL      1385--REDEF
OC_GOOSE_STA
      2205**DCL      2623<>CALL
OC_INTBIT
      1385**DCL      1386--REDEF
OC_INTMSG
      1262**DCL      1275--REDEF
OC_INTMSG.FLAGS
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:52   
      1269**DCL      1270--REDEF
OC_INTMSG.MESS
      1275**DCL      1275--REDEF
OC_INTMSG.MSGID
      1265**DCL      1266--REDEF
OC_INTMSG.WSN
      1272**DCL      1273--REDEF
OC_MASK
      1386**DCL      1386--REDEF
OC_MAXCONSOLE
      1342**DCL      2577>>DOINDEX  2594>>ASSIGN
OC_MESSBUF
      1277**DCL      1292--REDEF    1306--REDEF
OC_MESSBUF.FLAGS
      1284**DCL      1285--REDEF
OC_MESSBUF.MESS
      1290**DCL      1290--REDEF
OC_MESSBUF.MSGID
      1280**DCL      1281--REDEF
OC_MESSBUF.WSN
      1287**DCL      1288--REDEF
OC_MESSBUF1.FLAGS
      1299**DCL      1300--REDEF
OC_MESSBUF1.LEN
      1305**DCL      1305--REDEF
OC_MESSBUF1.MSGID
      1295**DCL      1296--REDEF
OC_MESSBUF1.WSN
      1302**DCL      1303--REDEF
OC_MSGBUFFER
      1308**DCL      1323--REDEF    2456--ASSIGN   2459--ASSIGN   2459--ASSIGN   2648<>CALL
OC_MSGBUFFER.FCN
      1314**DCL      2463>>IF       2530>>IF       2614>>IF       2632>>IF       2640>>IF
OC_MSGBUFFER.FLAGS
      1315**DCL      1316--REDEF
OC_MSGBUFFER.MESS
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:53   
      1321**DCL      1321--REDEF    2573--ASSIGN
OC_MSGBUFFER.MSG#
      1310**DCL      2510>>IF
OC_MSGBUFFER.MSGID
      1311**DCL      1312--REDEF
OC_MSGBUFFER.NPARAMS
      1313**DCL      2573>>ASSIGN
OC_MSGBUFFER.WSN
      1318**DCL      1319--REDEF
OC_MSGBUFFER2.FLAGS
      1330**DCL      1331--REDEF
OC_MSGBUFFER2.MESS
      1336**DCL      2623<>CALL
OC_MSGBUFFER2.MSGID
      1326**DCL      1327--REDEF
OC_MSGBUFFER2.SIZE
      1336**DCL      2620>>ASSIGN
OC_MSGBUFFER2.WSN
      1333**DCL      1334--REDEF
OC_PARAM
      1341**DCL      1341--REDEF
OC_QHEAD
      1337**DCL      2444>>ASSIGN
OC_QUEUE.PARMC
      1340**DCL      1340--REDEF
OC_QUEUE.PARMS
      1340**DCL      2444--ASSIGN
OC_ZIP
      1387**DCL      2466>>IF       2482<<ASSIGN   2507>>IF
OH_OH
      2494**LABEL    2490--CALLALT
PROMPT_TABLE.COUNT_
      1383**DCL      2589<<ASSIGN
PROMPT_TABLE.PROMPT
      1383**DCL      2591<<ASSIGN
RESTA.CADDR
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:54   
      2170**DCL      2578>>IF
SETPARMS.FCN
      2156**DCL      2574>>IF
SETPARMS.LENGTH
      2158**DCL      2581>>ASSIGN
SETPARMS.PFB
      2160**DCL      2582>>ASSIGN
SETPARMS.TEXT
      2163**DCL      2591>>ASSIGN
SO_WHAT
      2473**LABEL    2474--CALLALT
STA
      2360**DCL      2334--DCLINIT
STA.MSGIDXT
      2370**DCL      2373--REDEF
STA.STATION#
      2364**DCL      2485<<ASSIGN   2497>>ASSIGN
STATION
      2165**DCL      2166--REDEF    2451<<ASSIGN   2513>>IF       2513>>IF       2520>>IF       2523>>IF
      2533>>IF       2539>>IF       2539>>IF       2547<>CALL     2617>>IF       2617>>IF       2648<>CALL
TEMP
      2148**DCL      2163--IMP-SIZ  2581<<ASSIGN   2589>>ASSIGN   2591>>ASSIGN   2620<<ASSIGN   2621>>IF
      2623<>CALL
TEMP$
      2147**DCL      2573<<ASSIGN   2574>>IF       2581>>ASSIGN   2582>>ASSIGN   2591>>ASSIGN
TEXT.CNT
      2183**DCL      2184--IMP-SIZ
WR_STA
      2332**DCL      2490<>CALL
WR_STA.STATION_
      2334**DCL      2334--REDEF
WR_STA.V
      2335**DCL      2332--DCLINIT
WR_STA.V.DVBYTE.VFC#
      2341**DCL      2341--REDEF
WR_STA.V.EVENT#
PL6.E3A0      #001=OCO$MESSHAND File=OCO$OUTPUT.:E05TSI                          WED 07/30/97 04:03 Page:55   
      2340**DCL      2489<<ASSIGN
WR_ZAPERR
      2415**DCL      2480<>CALL
WR_ZAPERR.V
      2415**DCL      2415--DCLINIT
ZAP_ENTRY
      2390**DCL      2474<>CALL
ZAP_ENTRY.V
      2394**DCL      2390--DCLINIT

PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:56   
      412        1        /*M* OCO$IWRITE KEYINs internal routine to write to consoles with
      413        2             templates */
      414        3        /*T***********************************************************/
      415        4        /*T*                                                         */
      416        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      417        6        /*T*                                                         */
      418        7        /*T***********************************************************/
      419        8        %SET LISTSUB='1'B;
      420        9                                                /**/
      421       10                                                /**/
      422       11        /*
      423       12         ###    ###    ###    #    ###   #   #  ####    ###   #####  #####
      424       13        #   #  #   #  #   #  ###    #    #   #  #   #    #      #    #
      425       14        #   #  #      #   # # #     #    #   #  #   #    #      #    #
      426       15        #   #  #      #   #  ###    #    # # #  ####     #      #    ####
      427       16        #   #  #      #   #   # #   #    # # #  # #      #      #    #
      428       17        #   #  #   #  #   #  ###    #    # # #  #  #     #      #    #
      429       18         ###    ###    ###    #    ###    # #   #   #   ###     #    #####
      430       19                                                                   */
      431       20                                                /**/
      432       21                                                /**/
      433       22        OCO$IWRITE: PROC (CADDR,MSG#,NPARAMS,LEN,TBL,SYSID,WSN,PFB);
      434       23                                                /**/
      435       24                                                /**/
      436       25    1   DCL OCO$MESSAGE ENTRY(3);
      437       26                                                /**/
      438       27        %INCLUDE OCI_SUBS_C;
      439      125        %INCLUDE CP_6;
      440      206        %INCLUDE OC_DAT_R;
      441      367                                                /**/
      442      368        %INCLUDE OC_SUBS_C;
      443     1099                                                /**/
      444     1100    1   DCL MSG# UBIN HALF CALIGNED;
      445     1101    1   DCL NPARAMS UBIN BYTE CALIGNED;
      446     1102    1   DCL CADDR BIT(18) CALIGNED;
      447     1103    1   DCL LEN(0:0) UBIN BYTE CALIGNED;
      448     1104    1   DCL TBL(0:0) UBIN BYTE CALIGNED;
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:57   
      449     1105    1   DCL SYSID UBIN HALF CALIGNED;
      450     1106    1   DCL PFB UBIN WORD;
      451     1107    1   DCL WSN CHAR(8) UNAL;
      452     1108                                                /**/
      453     1109                                                /**/
      454     1110                                                /**/
      455     1111    1   DCL STRING CHAR(I) BASED CALIGNED;
      456     1112    1   DCL TEMP UBIN WORD ALIGNED;
      457     1113    1   DCL TEMP$ PTR;
      458     1114    1   DCL I SBIN WORD ALIGNED;
      459     1115    1   DCL SIZE UBIN WORD ALIGNED;
      460     1116                                                /**/
      461     1117        %EJECT;
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:58   
      462     1118                                                /**/
      463     1119        /*
      464     1120                  Begin  O C O $ I W R I T E  main
      465     1121                                                          */
      466     1122                                                /**/
      467     1123                                                /**/
      468     1124    1        OC_INTMSG.FCN = 3 /* write */;
      469     1125    1        OC_INTMSG.SYSID = SYSID;
      470     1126    1        OC_INTMSG.CADDR = CADDR;
      471     1127    1        OC_INTMSG.MSG# = MSG#;
      472     1128                                                /**/
      473     1129    1        IF ADDR(WSN) ~= ADDR(NIL)
      474     1130    1        THEN
      475     1131    1             OC_INTMSG.WSN = WSN;
      476     1132    1        ELSE
      477     1133    1             OC_INTMSG.WSN = ' ';
      478     1134                                                /**/
      479     1135    1        IF ADDR(PFB) ~= ADDR(NIL)
      480     1136    1        THEN
      481     1137    1             OC_INTMSG.PFB = PFB;
      482     1138    1        ELSE
      483     1139    1             OC_INTMSG.PFB = 0;
      484     1140                                                /**/
      485     1141    1        SIZE = 0;
      486     1142    1        TEMP$ = ADDR(OC_INTMSG.MESS);
      487     1143    1        TEMP = NPARAMS;
      488     1144                                                /**/
      489     1145    2        DO I = 0 TO (NPARAMS-1);
      490     1146    2             SIZE = SIZE + LEN(I) + 1;
      491     1147    2             IF SIZE > SIZEC(OC_INTMSG.MESS)
      492     1148    2             THEN
      493     1149    3             DO;
      494     1150    3                  TEMP = I;
      495     1151    3                  SIZE = SIZE - LEN(I) - 1;
      496     1152    3                  I = NPARAMS;             /* TO EXIT */
      497     1153    3                END;                       /* DO IF size > mess */
      498     1154    2           END;                            /* DO I = 0 TO NPARMS-1 */
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:59   
      499     1155                                                /**/
      500     1156    1        SIZE = SIZE - TEMP;                /* SIZE OF DATA */
      501     1157                                                /**/
      502     1158    1        IF SIZE ~= 0
      503     1159    1        THEN
      504     1160    2        DO;
      505     1161    2             I = TEMP;
      506     1162    2             OC_INTMSG.NPARAMS = TEMP;
      507     1163    2             TEMP$ -> STRING = ADDR(LEN) -> STRING;
      508     1164    2             TEMP$ = PINCRC(TEMP$,TEMP);
      509     1165    2             I = SIZE;
      510     1166    2             TEMP$ -> STRING = ADDR(TBL) -> STRING;
      511     1167    2           END;                            /* DO IF SIZE ~= 0 */
      512     1168    1        ELSE
      513     1169    1             OC_INTMSG.NPARAMS = 0;
      514     1170                                                /**/
      515     1171    1        CALL OCO$MESSAGE ('KEYIN   ',OC_INTMSG,SIZE+TEMP+20);
      516     1172                                                /**/
      517     1173    1        RETURN;
      518     1174                                                /**/
      519     1175    1   END OCO$IWRITE;
      520     1176        %EOD;

PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:60   
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCO$IWRITE.

   Procedure OCO$IWRITE requires 124 words for executable code.
   Procedure OCO$IWRITE requires 20 words of local(AUTO) storage.

PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:61   

 Object Unit name= OCO$IWRITE                                 File name= OCO$OUTPUT.:E05TOU
 UTS= JUL 30 '97 04:04:08.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      2      2  OCO$IWRITE
    2   Proc  even  none   124    174  OCO$IWRITE
    3  RoData even  none     3      3  OCO$IWRITE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        8  OCO$IWRITE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 OCO$MESSAGE
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:62   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:63   


      412        1        /*M* OCO$IWRITE KEYINs internal routine to write to consoles with
      413        2             templates */
      414        3        /*T***********************************************************/
      415        4        /*T*                                                         */
      416        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      417        6        /*T*                                                         */
      418        7        /*T***********************************************************/
      419        8        %SET LISTSUB='1'B;
      420        9                                                /**/
      421       10                                                /**/
      422       11        /*
      423       12         ###    ###    ###    #    ###   #   #  ####    ###   #####  #####
      424       13        #   #  #   #  #   #  ###    #    #   #  #   #    #      #    #
      425       14        #   #  #      #   # # #     #    #   #  #   #    #      #    #
      426       15        #   #  #      #   #  ###    #    # # #  ####     #      #    ####
      427       16        #   #  #      #   #   # #   #    # # #  # #      #      #    #
      428       17        #   #  #   #  #   #  ###    #    # # #  #  #     #      #    #
      429       18         ###    ###    ###    #    ###    # #   #   #   ###     #    #####
      430       19                                                                   */
      431       20                                                /**/
      432       21                                                /**/
      433       22        OCO$IWRITE: PROC (CADDR,MSG#,NPARAMS,LEN,TBL,SYSID,WSN,PFB);

     22  2 000000   000000 700200 xent  OCO$IWRITE   TSX0  ! X66_AUTO_N
         2 000001   000024 000010                    ZERO    20,8

      434       23                                                /**/
      435       24                                                /**/
      436       25    1   DCL OCO$MESSAGE ENTRY(3);
      437       26                                                /**/
      438       27        %INCLUDE OCI_SUBS_C;
      439      125        %INCLUDE CP_6;
      440      206        %INCLUDE OC_DAT_R;
      441      367                                                /**/
      442      368        %INCLUDE OC_SUBS_C;
      443     1099                                                /**/
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:64   
      444     1100    1   DCL MSG# UBIN HALF CALIGNED;
      445     1101    1   DCL NPARAMS UBIN BYTE CALIGNED;
      446     1102    1   DCL CADDR BIT(18) CALIGNED;
      447     1103    1   DCL LEN(0:0) UBIN BYTE CALIGNED;
      448     1104    1   DCL TBL(0:0) UBIN BYTE CALIGNED;
      449     1105    1   DCL SYSID UBIN HALF CALIGNED;
      450     1106    1   DCL PFB UBIN WORD;
      451     1107    1   DCL WSN CHAR(8) UNAL;
      452     1108                                                /**/
      453     1109                                                /**/
      454     1110                                                /**/
      455     1111    1   DCL STRING CHAR(I) BASED CALIGNED;
      456     1112    1   DCL TEMP UBIN WORD ALIGNED;
      457     1113    1   DCL TEMP$ PTR;
      458     1114    1   DCL I SBIN WORD ALIGNED;
      459     1115    1   DCL SIZE UBIN WORD ALIGNED;
      460     1116                                                /**/
      461     1117        %EJECT;
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:65   
      462     1118                                                /**/
      463     1119        /*
      464     1120                  Begin  O C O $ I W R I T E  main
      465     1121                                                          */
      466     1122                                                /**/
      467     1123                                                /**/
      468     1124    1        OC_INTMSG.FCN = 3 /* write */;

   1124  2 000002   000003 236007                    LDQ     3,DL
         2 000003   000001 552004 xsym               STBQ    OC_INTMSG+1,'04'O

      469     1125    1        OC_INTMSG.SYSID = SYSID;

   1125  2 000004   200010 470500                    LDP0    @SYSID,,AUTO
         2 000005   000000 100500                    MLR     fill='000'O
         2 000006   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         2 000007   000001 000002 xsym               ADSC9   OC_INTMSG+1              cn=0,n=2

      470     1126    1        OC_INTMSG.CADDR = CADDR;

   1126  2 000010   200003 471500                    LDP1    @CADDR,,AUTO
         2 000011   000000 100500                    MLR     fill='000'O
         2 000012   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         2 000013   000000 000002 xsym               ADSC9   OC_INTMSG                cn=0,n=2

      471     1127    1        OC_INTMSG.MSG# = MSG#;

   1127  2 000014   200004 473500                    LDP3    @MSG#,,AUTO
         2 000015   000000 100500                    MLR     fill='000'O
         2 000016   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         2 000017   000000 400002 xsym               ADSC9   OC_INTMSG                cn=2,n=2

      472     1128                                                /**/
      473     1129    1        IF ADDR(WSN) ~= ADDR(NIL)

   1129  2 000020   200011 236100                    LDQ     @WSN,,AUTO
         2 000021   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:66   
         2 000022   000030 600000 2                  TZE     s:1133

      474     1130    1        THEN
      475     1131    1             OC_INTMSG.WSN = WSN;

   1131  2 000023   200011 474500                    LDP4    @WSN,,AUTO
         2 000024   040000 100500                    MLR     fill='040'O
         2 000025   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         2 000026   000003 000010 xsym               ADSC9   OC_INTMSG+3              cn=0,n=8
         2 000027   000034 710000 2                  TRA     s:1135

      476     1132    1        ELSE
      477     1133    1             OC_INTMSG.WSN = ' ';

   1133  2 000030   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000031   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000032   000003 755000 xsym               STA     OC_INTMSG+3
         2 000033   000004 756000 xsym               STQ     OC_INTMSG+4

      478     1134                                                /**/
      479     1135    1        IF ADDR(PFB) ~= ADDR(NIL)

   1135  2 000034   200012 236100                    LDQ     @PFB,,AUTO
         2 000035   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000036   000044 600000 2                  TZE     s:1139

      480     1136    1        THEN
      481     1137    1             OC_INTMSG.PFB = PFB;

   1137  2 000037   200012 474500                    LDP4    @PFB,,AUTO
         2 000040   400000 236100                    LDQ     0,,PR4
         2 000041   000033 736000                    QLS     27
         2 000042   000002 552040 xsym               STBQ    OC_INTMSG+2,'40'O
         2 000043   000046 710000 2                  TRA     s:1141

      482     1138    1        ELSE
      483     1139    1             OC_INTMSG.PFB = 0;
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:67   

   1139  2 000044   000000 236003                    LDQ     0,DU
         2 000045   000002 552040 xsym               STBQ    OC_INTMSG+2,'40'O

      484     1140                                                /**/
      485     1141    1        SIZE = 0;

   1141  2 000046   200016 450100                    STZ     SIZE,,AUTO

      486     1142    1        TEMP$ = ADDR(OC_INTMSG.MESS);

   1142  2 000047   000000 236000 3                  LDQ     0
         2 000050   200014 756100                    STQ     TEMP$,,AUTO

      487     1143    1        TEMP = NPARAMS;

   1143  2 000051   200005 474500                    LDP4    @NPARAMS,,AUTO
         2 000052   000100 101500                    MRL     fill='000'O
         2 000053   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 000054   200013 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4

      488     1144                                                /**/
      489     1145    2        DO I = 0 TO (NPARAMS-1);

   1145  2 000055   200015 450100                    STZ     I,,AUTO
         2 000056   000106 710000 2                  TRA     s:1154+1

      490     1146    2             SIZE = SIZE + LEN(I) + 1;

   1146  2 000057   200006 470500                    LDP0    @LEN,,AUTO
         2 000060   200015 235100                    LDA     I,,AUTO
         2 000061   000100 101505                    MRL     fill='000'O
         2 000062   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 000063   200020 000004                    ADSC9   SIZE+2,,AUTO             cn=0,n=4
         2 000064   200020 236100                    LDQ     SIZE+2,,AUTO
         2 000065   200016 036100                    ADLQ    SIZE,,AUTO
         2 000066   000001 036007                    ADLQ    1,DL
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:68   
         2 000067   200016 756100                    STQ     SIZE,,AUTO

      491     1147    2             IF SIZE > SIZEC(OC_INTMSG.MESS)

   1147  2 000070   000265 116007                    CMPQ    181,DL
         2 000071   000105 602000 2                  TNC     s:1154

      492     1148    2             THEN
      493     1149    3             DO;

      494     1150    3                  TEMP = I;

   1150  2 000072   200013 755100                    STA     TEMP,,AUTO

      495     1151    3                  SIZE = SIZE - LEN(I) - 1;

   1151  2 000073   000100 101505                    MRL     fill='000'O
         2 000074   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 000075   200020 000004                    ADSC9   SIZE+2,,AUTO             cn=0,n=4
         2 000076   200020 136100                    SBLQ    SIZE+2,,AUTO
         2 000077   000001 136007                    SBLQ    1,DL
         2 000100   200016 756100                    STQ     SIZE,,AUTO

      496     1152    3                  I = NPARAMS;             /* TO EXIT */

   1152  2 000101   200005 471500                    LDP1    @NPARAMS,,AUTO
         2 000102   000100 101500                    MRL     fill='000'O
         2 000103   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 000104   200015 000004                    ADSC9   I,,AUTO                  cn=0,n=4

      497     1153    3                END;                       /* DO IF size > mess */

      498     1154    2           END;                            /* DO I = 0 TO NPARMS-1 */

   1154  2 000105   200015 054100                    AOS     I,,AUTO
         2 000106   200005 470500                    LDP0    @NPARAMS,,AUTO
         2 000107   000100 101500                    MRL     fill='000'O
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:69   
         2 000110   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000111   200020 000004                    ADSC9   SIZE+2,,AUTO             cn=0,n=4
         2 000112   200020 236100                    LDQ     SIZE+2,,AUTO
         2 000113   200015 116100                    CMPQ    I,,AUTO
         2 000114   000057 605400 2                  TPNZ    s:1146

      499     1155                                                /**/
      500     1156    1        SIZE = SIZE - TEMP;                /* SIZE OF DATA */

   1156  2 000115   200016 236100                    LDQ     SIZE,,AUTO
         2 000116   200013 136100                    SBLQ    TEMP,,AUTO
         2 000117   200016 756100                    STQ     SIZE,,AUTO

      501     1157                                                /**/
      502     1158    1        IF SIZE ~= 0

   1158  2 000120   000153 600000 2                  TZE     s:1169

      503     1159    1        THEN
      504     1160    2        DO;

      505     1161    2             I = TEMP;

   1161  2 000121   200013 235100                    LDA     TEMP,,AUTO
         2 000122   200015 755100                    STA     I,,AUTO

      506     1162    2             OC_INTMSG.NPARAMS = TEMP;

   1162  2 000123   200013 236100                    LDQ     TEMP,,AUTO
         2 000124   000011 736000                    QLS     9
         2 000125   000001 552010 xsym               STBQ    OC_INTMSG+1,'10'O

      507     1163    2             TEMP$ -> STRING = ADDR(LEN) -> STRING;

   1163  2 000126   200006 471500                    LDP1    @LEN,,AUTO
         2 000127   000000 620005                    EAX0    0,AL
         2 000130   200014 473500                    LDP3    TEMP$,,AUTO
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:70   
         2 000131   200015 721100                    LXL1    I,,AUTO
         2 000132   040140 100540                    MLR     fill='040'O
         2 000133   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 000134   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

      508     1164    2             TEMP$ = PINCRC(TEMP$,TEMP);

   1164  2 000135   200013 236100                    LDQ     TEMP,,AUTO
         2 000136   000020 736000                    QLS     16
         2 000137   200014 036100                    ADLQ    TEMP$,,AUTO
         2 000140   200014 756100                    STQ     TEMP$,,AUTO

      509     1165    2             I = SIZE;

   1165  2 000141   200016 235100                    LDA     SIZE,,AUTO
         2 000142   200015 755100                    STA     I,,AUTO

      510     1166    2             TEMP$ -> STRING = ADDR(TBL) -> STRING;

   1166  2 000143   200007 473500                    LDP3    @TBL,,AUTO
         2 000144   000000 620005                    EAX0    0,AL
         2 000145   200014 474500                    LDP4    TEMP$,,AUTO
         2 000146   200015 721100                    LXL1    I,,AUTO
         2 000147   040140 100540                    MLR     fill='040'O
         2 000150   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 000151   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1

      511     1167    2           END;                            /* DO IF SIZE ~= 0 */

   1167  2 000152   000155 710000 2                  TRA     s:1171

      512     1168    1        ELSE
      513     1169    1             OC_INTMSG.NPARAMS = 0;

   1169  2 000153   000000 236003                    LDQ     0,DU
         2 000154   000001 552010 xsym               STBQ    OC_INTMSG+1,'10'O

PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:71   
      514     1170                                                /**/
      515     1171    1        CALL OCO$MESSAGE ('KEYIN   ',OC_INTMSG,SIZE+TEMP+20);

   1171  2 000155   200016 236100                    LDQ     SIZE,,AUTO
         2 000156   200013 036100                    ADLQ    TEMP,,AUTO
         2 000157   000024 036007                    ADLQ    20,DL
         2 000160   200020 756100                    STQ     SIZE+2,,AUTO
         2 000161   200020 631500                    EPPR1   SIZE+2,,AUTO
         2 000162   200023 451500                    STP1    SIZE+5,,AUTO
         2 000163   000001 236000 3                  LDQ     1
         2 000164   200022 756100                    STQ     SIZE+4,,AUTO
         2 000165   000002 236000 3                  LDQ     2
         2 000166   200021 756100                    STQ     SIZE+3,,AUTO
         2 000167   200021 630500                    EPPR0   SIZE+3,,AUTO
         2 000170   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000171   000000 701000 xent               TSX1    OCO$MESSAGE
         2 000172   000000 011000                    NOP     0

      516     1172                                                /**/
      517     1173    1        RETURN;

   1173  2 000173   000000 702200 xent               TSX2  ! X66_ARET
      518     1174                                                /**/
      519     1175    1   END OCO$IWRITE;
      520     1176        %EOD;

PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:72   
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCO$IWRITE.
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:73   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CADDR                     6-0-0/w PTR         r     1 @LEN
     4-0-0/w PTR         r     1 @MSG#                      5-0-0/w PTR         r     1 @NPARAMS
    12-0-0/w PTR         r     1 @PFB                      10-0-0/w PTR         r     1 @SYSID
     7-0-0/w PTR         r     1 @TBL                      11-0-0/w PTR         r     1 @WSN
    *0-0-0/c BIT (18)    r     1 CADDR                     15-0-0/w SBIN        r     1 I
    *0-0-0/c UBIN(9)     r     1 LEN(0:0)                  *0-0-0/c UBIN(18)    r     1 MSG#
    *0-0-0/c UBIN(9)     r     1 NPARAMS                   *0-0-0/w UBIN        r     1 PFB
    16-0-0/w UBIN        r     1 SIZE                      *0-0-0/c UBIN(18)    r     1 SYSID
    *0-0-0/c UBIN(9)     r     1 TBL(0:0)                  13-0-0/w UBIN        r     1 TEMP
    14-0-0/w PTR         r     1 TEMP$                     *0-0-0/c CHAR(8)     r     1 WSN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/c STRC(1800)  r     1 OC_INTMSG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 STRING


   Procedure OCO$IWRITE requires 124 words for executable code.
   Procedure OCO$IWRITE requires 20 words of local(AUTO) storage.
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:74   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:75   
          MINI XREF LISTING

CADDR
      1102**DCL        22--PROC     1126>>ASSIGN
I
      1114**DCL      1111--IMP-SIZ  1145<<DOINDEX  1146>>ASSIGN   1150>>ASSIGN   1151>>ASSIGN   1152<<ASSIGN
      1161<<ASSIGN   1163>>ASSIGN   1163>>ASSIGN   1165<<ASSIGN   1166>>ASSIGN   1166>>ASSIGN
LEN
      1103**DCL        22--PROC     1146>>ASSIGN   1151>>ASSIGN   1163--ASSIGN
MSG#
      1100**DCL        22--PROC     1127>>ASSIGN
NPARAMS
      1101**DCL        22--PROC     1143>>ASSIGN   1145>>DOINDEX  1152>>ASSIGN
OCO$MESSAGE
        25**DCL-ENT  1171--CALL
OC_CONSOLE.ATTR
       320**DCL       320--REDEF
OC_CONSOLE.ATTRO
       321**DCL       321--REDEF
OC_CONSOLE.CID
       319**DCL       320--REDEF
OC_CONSOLE.STATION
       318**DCL       318--REDEF
OC_CONSOLE$
       317**DCL       318--IMP-PTR
OC_DIR
       360**DCL       360--REDEF
OC_INTBIT
       360**DCL       361--REDEF
OC_INTMSG
       237**DCL       250--REDEF    1171<>CALL
OC_INTMSG.CADDR
       238**DCL      1126<<ASSIGN
OC_INTMSG.FCN
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:76   
       243**DCL      1124<<ASSIGN
OC_INTMSG.FLAGS
       244**DCL       245--REDEF
OC_INTMSG.MESS
       250**DCL       250--REDEF    1142--ASSIGN   1147--IF
OC_INTMSG.MSG#
       239**DCL      1127<<ASSIGN
OC_INTMSG.MSGID
       240**DCL       241--REDEF
OC_INTMSG.NPARAMS
       242**DCL      1162<<ASSIGN   1169<<ASSIGN
OC_INTMSG.PFB
       245**DCL      1137<<ASSIGN   1139<<ASSIGN
OC_INTMSG.SYSID
       241**DCL      1125<<ASSIGN
OC_INTMSG.WSN
       247**DCL       248--REDEF    1131<<ASSIGN   1133<<ASSIGN
OC_MASK
       361**DCL       361--REDEF
OC_MESSBUF
       252**DCL       267--REDEF     281--REDEF
OC_MESSBUF.FLAGS
       259**DCL       260--REDEF
OC_MESSBUF.MESS
       265**DCL       265--REDEF
OC_MESSBUF.MSGID
       255**DCL       256--REDEF
OC_MESSBUF.WSN
       262**DCL       263--REDEF
OC_MESSBUF1.FLAGS
       274**DCL       275--REDEF
OC_MESSBUF1.LEN
       280**DCL       280--REDEF
OC_MESSBUF1.MSGID
       270**DCL       271--REDEF
OC_MESSBUF1.WSN
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:77   
       277**DCL       278--REDEF
OC_MSGBUFFER
       283**DCL       298--REDEF
OC_MSGBUFFER.FLAGS
       290**DCL       291--REDEF
OC_MSGBUFFER.MESS
       296**DCL       296--REDEF
OC_MSGBUFFER.MSGID
       286**DCL       287--REDEF
OC_MSGBUFFER.WSN
       293**DCL       294--REDEF
OC_MSGBUFFER2.FLAGS
       305**DCL       306--REDEF
OC_MSGBUFFER2.MSGID
       301**DCL       302--REDEF
OC_MSGBUFFER2.WSN
       308**DCL       309--REDEF
OC_PARAM
       316**DCL       316--REDEF
OC_QUEUE.PARMC
       315**DCL       315--REDEF
PFB
      1106**DCL        22--PROC     1135--IF       1137>>ASSIGN
SIZE
      1115**DCL      1141<<ASSIGN   1146<<ASSIGN   1146>>ASSIGN   1147>>IF       1151<<ASSIGN   1151>>ASSIGN
      1156<<ASSIGN   1156>>ASSIGN   1158>>IF       1165>>ASSIGN   1171>>CALL
STRING
      1111**DCL      1163<<ASSIGN   1163>>ASSIGN   1166<<ASSIGN   1166>>ASSIGN
SYSID
      1105**DCL        22--PROC     1125>>ASSIGN
TBL
      1104**DCL        22--PROC     1166--ASSIGN
TEMP
      1112**DCL      1143<<ASSIGN   1150<<ASSIGN   1156>>ASSIGN   1161>>ASSIGN   1162>>ASSIGN   1164>>ASSIGN
      1171>>CALL
TEMP$
PL6.E3A0      #002=OCO$IWRITE File=OCO$OUTPUT.:E05TSI                            WED 07/30/97 04:04 Page:78   
      1113**DCL      1142<<ASSIGN   1163>>ASSIGN   1164<<ASSIGN   1164>>ASSIGN   1166>>ASSIGN
WSN
      1107**DCL        22--PROC     1129--IF       1131>>ASSIGN

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:79   
      521        1        /*M* OCO$MESSAGE KEYINs routine to template messages to be printed
      522        2                                 on consoles */
      523        3        /*T***********************************************************/
      524        4        /*T*                                                         */
      525        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      526        6        /*T*                                                         */
      527        7        /*T***********************************************************/
      528        8        %SET LISTSUB='1'B;
      529        9        /*
      530       10         ###    ###    ###    #   #   #  #####   ###    ###    ###    ###   #####
      531       11        #   #  #   #  #   #  ###  ## ##  #      #   #  #   #  #   #  #   #  #
      532       12        #   #  #      #   # # #   # # #  #      #      #      #   #  #      #
      533       13        #   #  #      #   #  ###  #   #  ####    ###    ###   #####  #      ####
      534       14        #   #  #      #   #   # # #   #  #          #      #  #   #  #  ##  #
      535       15        #   #  #   #  #   #  ###  #   #  #      #   #  #   #  #   #  #   #  #
      536       16         ###    ###    ###    #   #   #  #####   ###    ###   #   #   ###   #####
      537       17                                                                   */
      538       18                                                /**/
      539       19                                                /**/
      540       20        OCO$MESSAGE: PROC(STATION,MESSAGE_BUFFER,MESSAGE_SIZE);
      541       21                                                /**/
      542       22                                                /**/
      543       23        %SUB ZERO=48;                           /* ASCII zero */
      544       24                                                /**/
      545       25                                                /**/
      546       26    1   DCL M$LO DCB;
      547       27    1   DCL M$CSCG DCB;
      548       28                                                /**/
      549       29                                                /**/
      550       30    1   DCL OCM$TPSET ENTRY(2) ALTRET;
      551       31    1   DCL OCP$PENDRMV ENTRY(1);
      552       32    1   DCL OCP$FINDCX ENTRY(2);
      553       33    1   DCL OCM$DONE ENTRY;
      554       34    1   DCL OCW$WRITE ENTRY(5);
      555       35                                                /**/
      556       36                                                /**/
      557       37    1   DCL STATION CHAR(8) UNAL;               /* PASSED AS ARGUMENT */
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:80   
      558       38    1   DCL MESSAGE_BUFFER CHAR(140) UNAL;      /* PASSED AS ARGUMENT */
      559       39    1   DCL MESSAGE_SIZE UBIN WORD CALIGNED;    /*PASSED AS ARGUEMENT */
      560       40                                                /**/
      561       41                                                /**/
      562       42    1   DCL TEMP$ PTR STATIC;
      563       43    1   DCL PEND$ PTR STATIC;
      564       44    1   DCL FOUND BIT(1) STATIC ALIGNED;
      565       45    1   DCL IO BIT(1) STATIC UNAL;
      566       46    1   DCL MONKEY BIT(1) STATIC ALIGNED;
      567       47                                                /**/
      568       48                                                /**/
      569       49    1   DCL WRITE_FCN(0:4) BIT(1) STATIC UNAL INIT('0'B * 2, '1'B * 3);
      570       50    1   DCL READ_FCN(0:4) BIT(1) STATIC UNAL INIT('1'B, '0'B * 3, '1'B);
      571       51                                                /**/
      572       52    1   DCL 1 ERRCODE STATIC,
      573       53    1            2 B BIT(36) UNAL,
      574       54    1            2 U REDEF B UBIN WORD UNAL;
      575       55        %INCLUDE B_SEGIDS_C;
      576      594    1   DCL 1 DS3_VECT STATIC,
      577      595    1            2 * BIT(60) UNAL,
      578      596    1            2 * BIT(12) INIT(%DS3SID) UNAL;
      579      597                                                /**/
      580      598    1   DCL 1 DS3_PTR STATIC ALIGNED,
      581      599    1            2 * UBIN(24) UNAL INIT(0),
      582      600    1            2 * BIT(12) UNAL INIT(%DS3SID);
      583      601    1   DCL DS3$ REDEF DS3_PTR PTR;
      584      602                                                /**/
      585      603    1   DCL STA CHAR(8) STATIC UNAL;
      586      604    1   DCL 1 RESTA REDEF STA,
      587      605    1            2 * CHAR (4) UNAL,
      588      606    1            2 SYSID UBIN(18) UNAL,
      589      607    1            2 * BIT (1) UNAL,
      590      608    1            2 CADDR UBIN(17) UNAL;
      591      609    1   DCL GSTA(0:1) REDEF STA CHAR(4) UNAL;
      592      610    1   DCL CADDRESS UBIN(17) STATIC;
      593      611    1   DCL NOGO CHAR(0) STATIC INIT
      594      612    1        ('KEYIN cant find template #000000');
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:81   
      595      613                                                /**/
      596      614                                                /**/
      597      615                                                /**/
      598      616                                                /**/
      599      617                                                /**/
      600      618    1   DCL FREE UBIN WORD STATIC ALIGNED;
      601      619    1   DCL I SBIN WORD STATIC ALIGNED;
      602      620    1   DCL J SBIN WORD STATIC ALIGNED;
      603      621    1   DCL K SBIN WORD STATIC ALIGNED;
      604      622    1   DCL LIMIT SBIN WORD STATIC ALIGNED;
      605      623    1   DCL TEMP UBIN WORD STATIC ALIGNED;
      606      624    1   DCL TEMP1 UBIN WORD STATIC ALIGNED;
      607      625    1   DCL FCN UBIN BYTE UNAL STATIC;
      608      626    1   DCL DO_WRITE BIT(1) STATIC ALIGNED;
      609      627    1   DCL SIZENT UBIN WORD STATIC ALIGNED;
      610      628                                                /**/
      611      629                                                /**/
      612      630    1   DCL GHST BIT(1) STATIC ALIGNED;
      613      631                                                /**/
      614      632                                                /**/
      615      633    1   DCL ENGLISH CHAR(1) STATIC INIT (' ');
      616      634                                                /**/
      617      635                                                /**/
      618      636    1   DCL B$TCB$ PTR SYMREF;
      619      637        %INCLUDE OC$PEND;
      620      682             %OC$PEND_NOMSG;
      621      698        %INCLUDE OCI_SUBS_C;
      622      796                                                /**/
      623      797        %INCLUDE OCP_DATA_R;
      624      814        %INCLUDE OC_SUBS_C;
      625     1545        %INCLUDE OCM_SUBS_C;
      626     1562        %INCLUDE OUT_SUBS_C;
      627     1685        %INCLUDE OCM_DATA_R;
      628     1698        %INCLUDE CP_6_SUBS;
      629     2238        %INCLUDE CP_6;
      630     2319        %INCLUDE OC_DAT_R;
      631     2480                                                /**/
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:82   
      632     2481             %B$TCB;
      633     2484             %B$ALT;
      634     2492                                                /**/
      635     2493        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
      636     2494                                                /**/
      637     2495             %FPT_ACTIVATE  (FPTN=DEACT,
      638     2496                                 DCB=M$CSCG,
      639     2497                                 STATION=STA,
      640     2498                                 ABTREAD=%TYC_IOERR);
      641     2521                                                /**/
      642     2522             %FPT_GDS       (RESULTS=DS3_VECT,
      643     2523                                 SEGSIZE=1024);
      644     2539                                                /**/
      645     2540                                                /**/
      646     2541        %EJECT;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:83   
      647     2542    1   HASH: PROC;
      648     2543    2        TEMP = BITBIN (BINBIT (OC_MESSBUF.MSGID, 36) & '000000000377'O);
      649     2544    3        DO I = 1 TO 256;
      650     2545    3             IF (OCP_MSGBUF_LIST.LINK(TEMP) ~= 511)
      651     2546    3             THEN
      652     2547    3                  TEMP = BITBIN (BINBIT (TEMP + 1, 36) & '000000000377'O);
      653     2548    3           END;
      654     2549    2        RETURN;
      655     2550    2   END HASH;
      656     2551        /*          */
      657     2552        %EJECT;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:84   
      658     2553                                                /**/
      659     2554                                                /**/
      660     2555    1   NEXT_FREE: PROC;
      661     2556    2   DCL I UBIN WORD;
      662     2557    3        DO I = 0 TO 6;
      663     2558    3             IF OCP_MSGBUF_FREE.U(I)
      664     2559    3             THEN
      665     2560    4             DO;
      666     2561    4                  FREE = I * 36;
      667     2562    5                  DO WHILE (I <= 6);
      668     2563    5                       IF OCP_MSGBUF_FREE.B(FREE)
      669     2564    5                       THEN
      670     2565    6                       DO;
      671     2566                                                /* Indicate used buffer */
      672     2567    6                            OCP_MSGBUF_FREE.B(FREE) = '0'B /*FALSE#*/;
      673     2568    6                            I = 7;         /* to exit loops                      */
      674     2569    6                          END;
      675     2570    5                       ELSE
      676     2571    5                            FREE = FREE + 1;
      677     2572    5                     END;
      678     2573    4                END;
      679     2574    3           END;
      680     2575    2        RETURN;
      681     2576    2   END NEXT_FREE;
      682     2577        %EJECT;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:85   
      683     2578                                                /**/
      684     2579                                           /*********************************
      685     2580                                            *********************************
      686     2581             Begin  O C O $ M E S S A G E main program
      687     2582                                            *********************************
      688     2583                                            *********************************/
      689     2584                                                /**/
      690     2585    1        IF OC_NOACT                        /* IS KEYIN CLOSED DOWN? */
      691     2586    1        THEN
      692     2587    1             RETURN;
      693     2588                                           /* Begin by moving passed arguments
      694     2589                                                to static so that OCM$TEMPLATE
      695     2590                                                keeps its AUTO low */
      696     2591    1        STA = STATION;
      697     2592    1        OC_MESSBUF2 = MESSAGE_BUFFER;
      698     2593                                                /**/
      699     2594    1        IF STA = 'MONKEY'
      700     2595    1        THEN
      701     2596    1             MONKEY = '1'B /*TRUE#*/;
      702     2597    1        ELSE
      703     2598    1             MONKEY = '0'B /*FALSE#*/;
      704     2599                                                /**/
      705     2600    1        IF GSTA(0) = 'GHST'
      706     2601    1        THEN
      707     2602    1             GHST = '1'B /*TRUE#*/;
      708     2603    1        ELSE
      709     2604    1             GHST = '0'B /*FALSE#*/;
      710     2605                                                /**/
      711     2606    1        FCN = OC_MESSBUF.FCN;
      712     2607                                                /**/
      713     2608                                                /**/
      714     2609                                                /**/
      715     2610    1        IF FCN = 7 /* zap complete indicator */               /* Shouldnt get this far,
      716     2611                                                     but might as well check */
      717     2612    1        THEN
      718     2613    1             RETURN;
      719     2614                                           /* SPECIAL CASE: If function code is
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:86   
      720     2615                                                "couldn't start console ghost"
      721     2616                                                then change to normal console
      722     2617                                                write, and deactivate ghost
      723     2618                                                from internal tables.     */
      724     2619    1        IF  FCN = 6 /* reset ocg active */
      725     2620    1        THEN
      726     2621    2        DO;
      727     2622    2             FCN = 3 /* write */;
      728     2623    2             CADDRESS = BITBIN(OC_MESSBUF.CADDR);
      729     2624    3             DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      730     2625    3                  IF OC_CONSOLE.CID(I) = CADDRESS
      731     2626    3                  THEN
      732     2627    4                  DO;
      733     2628    4                       OC_CONSOLE.GHST(I) = '0'B /*FALSE#*/;
      734     2629    4                     END;
      735     2630    3                END;                       /* DO I = 0 TO MAX_CONSOLES# */
      736     2631    2           END;                            /* DO IF FCN IS RESET GHOST ACTIVE */
      737     2632                                                /**/
      738     2633    1        IF FCN = 5 /* cancel read */
      739     2634    1        THEN
      740     2635    2        DO;
      741     2636    2             FOUND = '0'B /*FALSE#*/;
      742     2637    2             PEND$ = OCP_USED_HEAD$;
      743     2638    3             DO WHILE (~FOUND AND (PEND$ ~= ADDR(NIL)));
      744     2639    3                  IF PEND$ -> OC$PEND.SYSID = OC_MESSBUF.SYSID
      745     2640    3                  THEN
      746     2641    3                       FOUND = '1'B /*TRUE#*/;
      747     2642    3                  ELSE
      748     2643    3                       PEND$ = PEND$ -> OC$PEND.LINK$;
      749     2644    3                END;                       /* DO WHILE */
      750     2645    2             IF FOUND
      751     2646    2             THEN
      752     2647    2                  CALL OCP$PENDRMV(PEND$);
      753     2648    2             FCN = 3 /* write */;
      754     2649    2           END;                            /* DO IF CANCEL READ */
      755     2650                                                /**/
      756     2651                                                /**/
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:87   
      757     2652                                                /**/
      758     2653    1        IO = '1'B /*TRUE#*/;
      759     2654    2        DO WHILE (IO);
      760     2655    2             IF (FCN = 1 /* stop timed write */)
      761     2656    2             THEN
      762     2657    3             DO;
      763     2658    3                  TEMP1 = BITBIN (BINBIT (OC_MESSBUF.MSGID, 36) & '000000000377'O);
      764     2659    4                  DO I = 1 TO 256;
      765     2660    4                       IF ((OCP_MSGBUF_LIST.LINK (TEMP1) ~= 511) AND
      766     2661    4                            (OCP_MSGBUF_LIST.MSGID (TEMP1) = OC_MESSBUF.MSGID))
      767     2662    5                       THEN DO;
      768     2663                                      /* here TEMP1 contains index to MSGID to remove */
      769     2664    5                            TEMP = OCP_MSGBUF_LIST.LINK (TEMP1);
      770     2665    5                            OCP_MSGBUF_LIST.LINK (TEMP1) = 511;
      771     2666    6                            DO WHILE (TEMP ~= 511);
      772     2667                                                /* Indicate free buffer */
      773     2668    6                                 OCP_MSGBUF_FREE.B (TEMP) = '1'B /*TRUE#*/;
      774     2669    6                                 TEMP$ = PINCRW (OCP_MSGBUF$, TEMP * 8);
      775     2670    6                                 TEMP = TEMP$ -> OCP$MSGBUF_UNIT.LINK;
      776     2671    6                               END;
      777     2672    5                          END;             /* DO */
      778     2673
      779     2674    4                       TEMP1 = BITBIN(BINBIT(TEMP1+1,36) &
      780     2675    4                            '000000000377'O);
      781     2676    4                     END;                  /* DO I */
      782     2677    3                  IO = '0'B /*FALSE#*/;
      783     2678    3                END;
      784     2679    2             ELSE
      785     2680    3             DO;
      786     2681    3                  IF WRITE_FCN (FCN)
      787     2682    3                  THEN
      788     2683    4                  DO;
      789     2684    4                       CALL OCM$TPSET(ENGLISH,OC_MESSBUF1) ALTRET(BAD_TEMP);
      790     2685    4                       DO_WRITE = '1'B /*TRUE#*/;
      791     2686    4                       IF FCN = 2 /* timed write */
      792     2687    4                       THEN
      793     2688    5                       DO;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:88   
      794     2689    5                            CALL NEXT_FREE; /* result to FREE  */
      795     2690    5                            CALL HASH;     /* result to TEMP */
      796     2691    5                            OCP_MSGBUF_LIST.MSGID(TEMP) = OC_MESSBUF.MSGID;
      797     2692    5                            OCP_MSGBUF_LIST.CADDR(TEMP) = OC_MESSBUF.CADDR;
      798     2693    5                            OCP_MSGBUF_LIST.WSN(TEMP) = OC_MESSBUF.WSN;
      799     2694    5                            OCP_MSGBUF_LIST.LINK(TEMP) = FREE;
      800     2695    5                            LIMIT = (MESSAGE_SIZE - 1) / 31;
      801     2696    5                            J = 0;
      802     2697    6                            DO I = 0 TO LIMIT;
      803     2698    6                                 TEMP$ = PINCRW (OCP_MSGBUF$, FREE * 8);
      804     2699    6                                 CALL INSERT (TEMP$->OCP$MSGBUF_UNIT.BUF,
      805     2700    6                                      0, 31,
      806     2701    6                                      SUBSTR (MESSAGE_BUFFER, J, MESSAGE_SIZE - J));
      807     2702    6                                 J = J + 31;
      808     2703    6                                 IF (I = LIMIT)
      809     2704    6                                 THEN
      810     2705    6                                      TEMP$ -> OCP$MSGBUF_UNIT.LINK = 511;
      811     2706    6                                 ELSE
      812     2707    7                                 DO;
      813     2708    7                                      CALL NEXT_FREE;
      814     2709    7                                      TEMP$ -> OCP$MSGBUF_UNIT.LINK = FREE;
      815     2710    7                                    END;
      816     2711    6                               END;
      817     2712                                           /* Don't write if <= 5  seconds till
      818     2713                                                next DOLIST call */
      819     2714    5                            IF OC_REMAIN <= 5
      820     2715    5                            THEN
      821     2716    5                                 DO_WRITE = '0'B /*FALSE#*/;
      822     2717                                                /**/
      823     2718    5                          END;
      824     2719    4                       IF DO_WRITE
      825     2720    4                       THEN
      826     2721    4                            CALL OCW$WRITE (OC_MESSBUF2, MESSAGE_SIZE,
      827     2722    4                                 OC_MESSBUF.CADDR,
      828     2723    4                                 OC_MESSBUF.WSN,
      829     2724    4                                 OC_MESSBUF.MSG#);
      830     2725    4                       IO = '0'B /*FALSE#*/;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:89   
      831     2726    4                     END;
      832     2727    3                  IF READ_FCN (FCN)
      833     2728    3                  THEN
      834     2729    4                  DO;
      835     2730                                           /* Only M$KEYIN or console ghost can
      836     2731                                                perform read */
      837     2732    4                       IF NOT (GHST OR SUBSTR (STA, 0, 2) = '&&')
      838     2733    4                       THEN
      839     2734    4                            RETURN;
      840     2735    4                       IF GHST
      841     2736    4                       THEN
      842     2737    5                       DO;
      843     2738    6                            DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      844     2739    6                                 IF OC_CONSOLE.SYSID(I) = RESTA.SYSID
      845     2740    6                                 THEN
      846     2741    7                                 DO;
      847     2742    7                                      OC_CONSOLE.GHSTRD(I) = '1'B /*TRUE#*/;
      848     2743    8                                      DO K = 0 TO 2;
      849     2744    8                                           ADDR(OC_CONSOLE.PROMPTS(I)) ->
      850     2745    8                                                PROMPT_TABLE.LAST_READ(K)
      851     2746    8                                                = '0'B /*FALSE#*/;
      852     2747    8                                         END; /* DO K = 0 TO 2 */
      853     2748    7                                      ADDR(OC_CONSOLE.PROMPTS(I)) ->
      854     2749    7                                           PROMPT_TABLE.LAST_READ(OC_MESSBUF.PFB-1)
      855     2750    7                                           = '1'B /*TRUE#*/;
      856     2751    7                                      ADDR(OC_CONSOLE.PROMPTS(I)) ->
      857     2752    7                                           PROMPT_TABLE.SIZER(OC_MESSBUF.PFB-1)
      858     2753    7                                           = OC_MESSBUF1.GRD.SZR;
      859     2754    7                                      I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
      860     2755    7                                    END;   /* IF SYSID MATCHES */
      861     2756    6                               END;        /* DO I = 0 TO MAX_CONSOLES# */
      862     2757    5                            IO = '0'B /*FALSE#*/;
      863     2758    5                          END;
      864     2759    4                       ELSE
      865     2760    5                       DO;
      866     2761                                                /* Need more space ? */
      867     2762    5                            SIZENT = SIZEW (OC$PEND_NOMSG) +
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:90   
      868     2763    5                                 ((MESSAGE_SIZE + (4 /* BYTESPERWD# */ - 1)) /
      869     2764    5                                 4 /* BYTESPERWD# */);
      870     2765    5                            IF (OCP_PEND_USED + SIZENT+1) > OCP_PEND_TOT
      871     2766    5                            THEN
      872     2767    6                            DO;
      873     2768    6                                 CALL M$GDS (FPT_GDS)
      874     2769    6                                      ALTRET (CANT_GET_PAGE);
      875     2770    6                                 OCP_PEND_TOT = OCP_PEND_TOT +
      876     2771    6                                      1024 /* WDSPERPAGE# */;
      877     2772    6                                 IF OCP_PEND_USED+SIZENT > OCP_PEND_TOT
      878     2773    6                                 THEN
      879     2774    6                                      GOTO CANT_GET_PAGE;
      880     2775    6                               END;
      881     2776                                                /**/
      882     2777                                           /* Move the relevant information
      883     2778                                                to the appropriate area of
      884     2779                                                memory */
      885     2780    5                            OCP_FREE_HEAD$ -> OC$PEND.STATION = STA;
      886     2781    5                            OCP_FREE_HEAD$ -> OC$PEND.ACCN = OC_MESSBUF1.ACCN;
      887     2782    5                            OCP_FREE_HEAD$ -> OC$PEND.SYSID = OC_MESSBUF1.SYSID;
      888     2783    5                            OCP_FREE_HEAD$ -> OC$PEND.READID = OCP_READID;
      889     2784    5                            OCP_FREE_HEAD$ -> OC$PEND.CADDR = OC_MESSBUF1.CADDR;
      890     2785    5                            OCP_FREE_HEAD$ -> OC$PEND.SIZER = OC_MESSBUF1.SZR;
      891     2786    5                            OCP_FREE_HEAD$ -> OC$PEND.WSN = OC_MESSBUF1.WSN;
      892     2787    5                            OCP_FREE_HEAD$ -> OC$PEND.SIZEB_MSG = MESSAGE_SIZE;
      893     2788    5                            OCP_FREE_HEAD$ -> OC$PEND.MESSAGE = OC_MESSBUF2;
      894     2789    5                            OCP_FREE_HEAD$ -> OC$PEND.SIZEW_ENTRY = SIZENT;
      895     2790                                                /**/
      896     2791                                           /* Adjust the controlled pointers
      897     2792                                                accordingly */
      898     2793    5                            IF OCP_USED_HEAD$ = ADDR(NIL)
      899     2794    5                            THEN
      900     2795    5                                 OCP_USED_HEAD$ = DS3$;
      901     2796    5                            OCP_USED_TAIL$ -> OC$PEND.LINK$ = OCP_FREE_HEAD$;
      902     2797    5                            OCP_USED_TAIL$ = OCP_FREE_HEAD$;
      903     2798    5                            OCP_FREE_HEAD$ = PINCRW (OCP_FREE_HEAD$, SIZENT);
      904     2799    5                            OCP_USED_TAIL$ -> OC$PEND.LINK$ = ADDR(NIL);
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:91   
      905     2800    5                            OCP_PEND_USED = OCP_PEND_USED + SIZENT;
      906     2801    5                            OCP_READID = OCP_READID + 1;
      907     2802    5                          END;
      908     2803        /*
      909     2804           CONVENTION: Read message numbers are one greater
      910     2805                       than write message numbers.
      911     2806                                                             */
      912     2807    4                       OC_MESSBUF1.MSG# = OC_MESSBUF1.MSG# + 1;
      913     2808    4                       FCN = 3 /* write */;
      914     2809    4                       IO = '1'B /*TRUE#*/;
      915     2810    4                     END;
      916     2811    3                END;
      917     2812    2           END;                            /* WHILE (IO)                         */
      918     2813    1        RETURN;
      919     2814    1   BAD_TEMP: RETURN;
      920     2815    1   CANT_GET_PAGE:
      921     2816    1        CALL M$DEACTIVATE (DEACT) ALTRET (IGNORE);
      922     2817    1   IGNORE:
      923     2818    1        RETURN;
      924     2819    1   END OCO$MESSAGE;

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:92   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OCM_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCO$MESSAGE.

   Procedure OCO$MESSAGE requires 490 words for executable code.
   Procedure OCO$MESSAGE requires 14 words of local(AUTO) storage.

    No errors detected in file OCO$OUTPUT.:E05TSI    .

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:93   

 Object Unit name= OCO$MESSAGE                                File name= OCO$OUTPUT.:E05TOU
 UTS= JUL 30 '97 04:04:30.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$CSCG
    2   Data  even  none    66    102  OCO$MESSAGE
    3   DCB   even  none     0      0  M$UC
    4  RoData even  UTS      5      5  OCO$MESSAGE
    5   Proc  even  none   490    752  OCO$MESSAGE
    6  RoData even  none     8     10  OCO$MESSAGE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        3  OCO$MESSAGE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 OCP$PENDRMV
 yes     yes           Std       2 OCM$TPSET
         yes           Std       5 OCW$WRITE
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:94   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$LO                                  M$CSCG                                OCP_PEND_TOT
     OCP_PEND_USED                         OCP_READID                            OCP_FREE_HEAD
     OCP_USED_HEAD                         OCP_USED_TAIL                    r    OCP_MSGBUF$
     OCP_MSGBUF_FREE                       OCP_MSGBUF_LIST                       M$UC
     OC_INTMSG                             OC_MESSBUF                            OC_MSGBUFFER
     OC_REMAIN                             OC_PARAM                              OC_CONSOLE$
     OC_MAXCONSOLE                         OC_DIR                                OC_INTBIT
     OC_MASK                               OC_NOACT                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:95   


      521        1        /*M* OCO$MESSAGE KEYINs routine to template messages to be printed
      522        2                                 on consoles */
      523        3        /*T***********************************************************/
      524        4        /*T*                                                         */
      525        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      526        6        /*T*                                                         */
      527        7        /*T***********************************************************/
      528        8        %SET LISTSUB='1'B;
      529        9        /*
      530       10         ###    ###    ###    #   #   #  #####   ###    ###    ###    ###   #####
      531       11        #   #  #   #  #   #  ###  ## ##  #      #   #  #   #  #   #  #   #  #
      532       12        #   #  #      #   # # #   # # #  #      #      #      #   #  #      #
      533       13        #   #  #      #   #  ###  #   #  ####    ###    ###   #####  #      ####
      534       14        #   #  #      #   #   # # #   #  #          #      #  #   #  #  ##  #
      535       15        #   #  #   #  #   #  ###  #   #  #      #   #  #   #  #   #  #   #  #
      536       16         ###    ###    ###    #   #   #  #####   ###    ###   #   #   ###   #####
      537       17                                                                   */
      538       18                                                /**/
      539       19                                                /**/
      540       20        OCO$MESSAGE: PROC(STATION,MESSAGE_BUFFER,MESSAGE_SIZE);

     20  5 000000   000000 700200 xent  OCO$MESSAGE  TSX0  ! X66_AUTO_3
         5 000001   000016 000003                    ZERO    14,3
         5 000002   000074 710000 5                  TRA     s:2585

      541       21                                                /**/
      542       22                                                /**/
      543       23        %SUB ZERO=48;                           /* ASCII zero */
      544       24                                                /**/
      545       25                                                /**/
      546       26    1   DCL M$LO DCB;
      547       27    1   DCL M$CSCG DCB;
      548       28                                                /**/
      549       29                                                /**/
      550       30    1   DCL OCM$TPSET ENTRY(2) ALTRET;
      551       31    1   DCL OCP$PENDRMV ENTRY(1);
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:96   
      552       32    1   DCL OCP$FINDCX ENTRY(2);
      553       33    1   DCL OCM$DONE ENTRY;
      554       34    1   DCL OCW$WRITE ENTRY(5);
      555       35                                                /**/
      556       36                                                /**/
      557       37    1   DCL STATION CHAR(8) UNAL;               /* PASSED AS ARGUMENT */
      558       38    1   DCL MESSAGE_BUFFER CHAR(140) UNAL;      /* PASSED AS ARGUMENT */
      559       39    1   DCL MESSAGE_SIZE UBIN WORD CALIGNED;    /*PASSED AS ARGUEMENT */
      560       40                                                /**/
      561       41                                                /**/
      562       42    1   DCL TEMP$ PTR STATIC;
      563       43    1   DCL PEND$ PTR STATIC;
      564       44    1   DCL FOUND BIT(1) STATIC ALIGNED;
      565       45    1   DCL IO BIT(1) STATIC UNAL;
      566       46    1   DCL MONKEY BIT(1) STATIC ALIGNED;
      567       47                                                /**/
      568       48                                                /**/
      569       49    1   DCL WRITE_FCN(0:4) BIT(1) STATIC UNAL INIT('0'B * 2, '1'B * 3);
      570       50    1   DCL READ_FCN(0:4) BIT(1) STATIC UNAL INIT('1'B, '0'B * 3, '1'B);
      571       51                                                /**/
      572       52    1   DCL 1 ERRCODE STATIC,
      573       53    1            2 B BIT(36) UNAL,
      574       54    1            2 U REDEF B UBIN WORD UNAL;
      575       55        %INCLUDE B_SEGIDS_C;
      576      594    1   DCL 1 DS3_VECT STATIC,
      577      595    1            2 * BIT(60) UNAL,
      578      596    1            2 * BIT(12) INIT(%DS3SID) UNAL;
      579      597                                                /**/
      580      598    1   DCL 1 DS3_PTR STATIC ALIGNED,
      581      599    1            2 * UBIN(24) UNAL INIT(0),
      582      600    1            2 * BIT(12) UNAL INIT(%DS3SID);
      583      601    1   DCL DS3$ REDEF DS3_PTR PTR;
      584      602                                                /**/
      585      603    1   DCL STA CHAR(8) STATIC UNAL;
      586      604    1   DCL 1 RESTA REDEF STA,
      587      605    1            2 * CHAR (4) UNAL,
      588      606    1            2 SYSID UBIN(18) UNAL,
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:97   
      589      607    1            2 * BIT (1) UNAL,
      590      608    1            2 CADDR UBIN(17) UNAL;
      591      609    1   DCL GSTA(0:1) REDEF STA CHAR(4) UNAL;
      592      610    1   DCL CADDRESS UBIN(17) STATIC;
      593      611    1   DCL NOGO CHAR(0) STATIC INIT
      594      612    1        ('KEYIN cant find template #000000');
      595      613                                                /**/
      596      614                                                /**/
      597      615                                                /**/
      598      616                                                /**/
      599      617                                                /**/
      600      618    1   DCL FREE UBIN WORD STATIC ALIGNED;
      601      619    1   DCL I SBIN WORD STATIC ALIGNED;
      602      620    1   DCL J SBIN WORD STATIC ALIGNED;
      603      621    1   DCL K SBIN WORD STATIC ALIGNED;
      604      622    1   DCL LIMIT SBIN WORD STATIC ALIGNED;
      605      623    1   DCL TEMP UBIN WORD STATIC ALIGNED;
      606      624    1   DCL TEMP1 UBIN WORD STATIC ALIGNED;
      607      625    1   DCL FCN UBIN BYTE UNAL STATIC;
      608      626    1   DCL DO_WRITE BIT(1) STATIC ALIGNED;
      609      627    1   DCL SIZENT UBIN WORD STATIC ALIGNED;
      610      628                                                /**/
      611      629                                                /**/
      612      630    1   DCL GHST BIT(1) STATIC ALIGNED;
      613      631                                                /**/
      614      632                                                /**/
      615      633    1   DCL ENGLISH CHAR(1) STATIC INIT (' ');
      616      634                                                /**/
      617      635                                                /**/
      618      636    1   DCL B$TCB$ PTR SYMREF;
      619      637        %INCLUDE OC$PEND;
      620      682             %OC$PEND_NOMSG;
      621      698        %INCLUDE OCI_SUBS_C;
      622      796                                                /**/
      623      797        %INCLUDE OCP_DATA_R;
      624      814        %INCLUDE OC_SUBS_C;
      625     1545        %INCLUDE OCM_SUBS_C;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:98   
      626     1562        %INCLUDE OUT_SUBS_C;
      627     1685        %INCLUDE OCM_DATA_R;
      628     1698        %INCLUDE CP_6_SUBS;
      629     2238        %INCLUDE CP_6;
      630     2319        %INCLUDE OC_DAT_R;
      631     2480                                                /**/
      632     2481             %B$TCB;
      633     2484             %B$ALT;
      634     2492                                                /**/
      635     2493        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
      636     2494                                                /**/
      637     2495             %FPT_ACTIVATE  (FPTN=DEACT,
      638     2496                                 DCB=M$CSCG,
      639     2497                                 STATION=STA,
      640     2498                                 ABTREAD=%TYC_IOERR);
      641     2521                                                /**/
      642     2522             %FPT_GDS       (RESULTS=DS3_VECT,
      643     2523                                 SEGSIZE=1024);
      644     2539                                                /**/
      645     2540                                                /**/
      646     2541        %EJECT;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:99   
      647     2542    1   HASH: PROC;

   2542  5 000003   200006 741300       HASH         STX1  ! @MESSAGE_SIZE+1,,AUTO

      648     2543    2        TEMP = BITBIN (BINBIT (OC_MESSBUF.MSGID, 36) & '000000000377'O);

   2543  5 000004   000001 236000 xsym               LDQ     OC_MESSBUF+1
         5 000005   000022 772000                    QRL     18
         5 000006   000000 376000 4                  ANQ     0
         5 000007   000033 756000 2                  STQ     TEMP

      649     2544    3        DO I = 1 TO 256;

   2544  5 000010   000001 235007                    LDA     1,DL
         5 000011   000027 755000 2                  STA     I

      650     2545    3             IF (OCP_MSGBUF_LIST.LINK(TEMP) ~= 511)

   2545  5 000012   000033 235000 2                  LDA     TEMP
         5 000013   000002 735000                    ALS     2
         5 000014   000001 236005 xsym               LDQ     OCP_MSGBUF_LIST+1,AL
         5 000015   777000 376003                    ANQ     -512,DU
         5 000016   777000 116003                    CMPQ    -512,DU
         5 000017   000024 600000 5                  TZE     s:2548

      651     2546    3             THEN
      652     2547    3                  TEMP = BITBIN (BINBIT (TEMP + 1, 36) & '000000000377'O);

   2547  5 000020   000033 236000 2                  LDQ     TEMP
         5 000021   000001 036007                    ADLQ    1,DL
         5 000022   000000 376000 4                  ANQ     0
         5 000023   000033 756000 2                  STQ     TEMP

      653     2548    3           END;

   2548  5 000024   000027 054000 2                  AOS     I
         5 000025   000027 235000 2                  LDA     I
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:100  
         5 000026   000400 115007                    CMPA    256,DL
         5 000027   000012 604400 5                  TMOZ    s:2545

      654     2549    2        RETURN;

   2549  5 000030   200006 221300                    LDX1  ! @MESSAGE_SIZE+1,,AUTO
         5 000031   000001 702211                    TSX2  ! 1,X1

      655     2550    2   END HASH;
      656     2551        /*          */
      657     2552        %EJECT;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:101  
      658     2553                                                /**/
      659     2554                                                /**/
      660     2555    1   NEXT_FREE: PROC;

   2555  5 000032   200006 741300       NEXT_FREE    STX1  ! @MESSAGE_SIZE+1,,AUTO

      661     2556    2   DCL I UBIN WORD;
      662     2557    3        DO I = 0 TO 6;

   2557  5 000033   200007 450100                    STZ     I,,AUTO

      663     2558    3             IF OCP_MSGBUF_FREE.U(I)

   2558  5 000034   200007 720100                    LXL0    I,,AUTO
         5 000035   000000 235010 xsym               LDA     OCP_MSGBUF_FREE,X0
         5 000036   000065 600000 5                  TZE     s:2574

      664     2559    3             THEN
      665     2560    4             DO;

      666     2561    4                  FREE = I * 36;

   2561  5 000037   200007 236100                    LDQ     I,,AUTO
         5 000040   000044 402007                    MPY     36,DL
         5 000041   000026 756000 2                  STQ     FREE

      667     2562    5                  DO WHILE (I <= 6);

   2562  5 000042   200007 235100                    LDA     I,,AUTO
         5 000043   000007 115007                    CMPA    7,DL
         5 000044   000065 603000 5                  TRC     s:2574

      668     2563    5                       IF OCP_MSGBUF_FREE.B(FREE)

   2563  5 000045   000026 235000 2                  LDA     FREE
         5 000046   000000 066405                    CMPB    filb='0'B
         5 000047   000000 000001 xsym               BDSC    OCP_MSGBUF_FREE,A        by=0,bit=0,n=1
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:102  
         5 000050   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000051   000060 600000 5                  TZE     s:2571

      669     2564    5                       THEN
      670     2565    6                       DO;

      671     2566                                                /* Indicate used buffer */
      672     2567    6                            OCP_MSGBUF_FREE.B(FREE) = '0'B /*FALSE#*/;

   2567  5 000052   003005 060400                    CSL     bolr='003'O
         5 000053   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 000054   000000 000001 xsym               BDSC    OCP_MSGBUF_FREE,A        by=0,bit=0,n=1

      673     2568    6                            I = 7;         /* to exit loops                      */

   2568  5 000055   000007 236007                    LDQ     7,DL
         5 000056   200007 756100                    STQ     I,,AUTO

      674     2569    6                          END;

   2569  5 000057   000062 710000 5                  TRA     s:2572

      675     2570    5                       ELSE
      676     2571    5                            FREE = FREE + 1;

   2571  5 000060   000001 035007                    ADLA    1,DL
         5 000061   000026 755000 2                  STA     FREE

      677     2572    5                     END;

   2572  5 000062   200007 236100                    LDQ     I,,AUTO
         5 000063   000007 116007                    CMPQ    7,DL
         5 000064   000045 602000 5                  TNC     s:2563

      678     2573    4                END;

      679     2574    3           END;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:103  

   2574  5 000065   200007 235100                    LDA     I,,AUTO
         5 000066   000001 035007                    ADLA    1,DL
         5 000067   200007 755100                    STA     I,,AUTO
         5 000070   000007 115007                    CMPA    7,DL
         5 000071   000034 602000 5                  TNC     s:2558

      680     2575    2        RETURN;

   2575  5 000072   200006 221300                    LDX1  ! @MESSAGE_SIZE+1,,AUTO
         5 000073   000001 702211                    TSX2  ! 1,X1

      681     2576    2   END NEXT_FREE;
      682     2577        %EJECT;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:104  
      683     2578                                                /**/
      684     2579                                           /*********************************
      685     2580                                            *********************************
      686     2581             Begin  O C O $ M E S S A G E main program
      687     2582                                            *********************************
      688     2583                                            *********************************/
      689     2584                                                /**/
      690     2585    1        IF OC_NOACT                        /* IS KEYIN CLOSED DOWN? */

   2585  5 000074   000000 234000 xsym               SZN     OC_NOACT
         5 000075   000077 605000 5                  TPL     s:2591

      691     2586    1        THEN
      692     2587    1             RETURN;

   2587  5 000076   000000 702200 xent               TSX2  ! X66_ARET

      693     2588                                           /* Begin by moving passed arguments
      694     2589                                                to static so that OCM$TEMPLATE
      695     2590                                                keeps its AUTO low */
      696     2591    1        STA = STATION;

   2591  5 000077   200003 470500                    LDP0    @STATION,,AUTO
         5 000100   040000 100500                    MLR     fill='040'O
         5 000101   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000102   000013 000010 2                  ADSC9   STA                      cn=0,n=8

      697     2592    1        OC_MESSBUF2 = MESSAGE_BUFFER;

   2592  5 000103   200004 471500                    LDP1    @MESSAGE_BUFFER,,AUTO
         5 000104   040000 100500                    MLR     fill='040'O
         5 000105   100000 000214                    ADSC9   0,,PR1                   cn=0,n=140
         5 000106   000000 000310 xsym               ADSC9   OC_MESSBUF               cn=0,n=200

      698     2593                                                /**/
      699     2594    1        IF STA = 'MONKEY'

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:105  
   2594  5 000107   040000 106400                    CMPC    fill='040'O
         5 000110   000013 000010 2                  ADSC9   STA                      cn=0,n=8
         5 000111   000001 000006 4                  ADSC9   1                        cn=0,n=6
         5 000112   000116 601000 5                  TNZ     s:2598

      700     2595    1        THEN
      701     2596    1             MONKEY = '1'B /*TRUE#*/;

   2596  5 000113   400000 236003                    LDQ     -131072,DU
         5 000114   000004 756000 2                  STQ     MONKEY
         5 000115   000117 710000 5                  TRA     s:2600

      702     2597    1        ELSE
      703     2598    1             MONKEY = '0'B /*FALSE#*/;

   2598  5 000116   000004 450000 2                  STZ     MONKEY

      704     2599                                                /**/
      705     2600    1        IF GSTA(0) = 'GHST'

   2600  5 000117   000013 236000 2                  LDQ     STA
         5 000120   000003 116000 4                  CMPQ    3
         5 000121   000125 601000 5                  TNZ     s:2604

      706     2601    1        THEN
      707     2602    1             GHST = '1'B /*TRUE#*/;

   2602  5 000122   400000 236003                    LDQ     -131072,DU
         5 000123   000040 756000 2                  STQ     GHST
         5 000124   000126 710000 5                  TRA     s:2606

      708     2603    1        ELSE
      709     2604    1             GHST = '0'B /*FALSE#*/;

   2604  5 000125   000040 450000 2                  STZ     GHST

      710     2605                                                /**/
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:106  
      711     2606    1        FCN = OC_MESSBUF.FCN;

   2606  5 000126   000001 236000 xsym               LDQ     OC_MESSBUF+1
         5 000127   000777 376007                    ANQ     511,DL
         5 000130   000033 736000                    QLS     27
         5 000131   000035 756000 2                  STQ     FCN

      712     2607                                                /**/
      713     2608                                                /**/
      714     2609                                                /**/
      715     2610    1        IF FCN = 7 /* zap complete indicator */              /* Shouldnt get this far,

   2610  5 000132   000035 236000 2                  LDQ     FCN
         5 000133   777000 376003                    ANQ     -512,DU
         5 000134   007000 116003                    CMPQ    3584,DU
         5 000135   000137 601000 5                  TNZ     s:2619

      716     2611                                                     but might as well check */
      717     2612    1        THEN
      718     2613    1             RETURN;

   2613  5 000136   000000 702200 xent               TSX2  ! X66_ARET

      719     2614                                           /* SPECIAL CASE: If function code is
      720     2615                                                "couldn't start console ghost"
      721     2616                                                then change to normal console
      722     2617                                                write, and deactivate ghost
      723     2618                                                from internal tables.     */
      724     2619    1        IF  FCN = 6 /* reset ocg active */

   2619  5 000137   006000 116003                    CMPQ    3072,DU
         5 000140   000175 601000 5                  TNZ     s:2633

      725     2620    1        THEN
      726     2621    2        DO;

      727     2622    2             FCN = 3 /* write */;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:107  

   2622  5 000141   003000 236003                    LDQ     1536,DU
         5 000142   000035 756000 2                  STQ     FCN

      728     2623    2             CADDRESS = BITBIN(OC_MESSBUF.CADDR);

   2623  5 000143   000000 236000 xsym               LDQ     OC_MESSBUF
         5 000144   000022 772000                    QRL     18
         5 000145   000023 736000                    QLS     19
         5 000146   000015 756000 2                  STQ     CADDRESS

      729     2624    3             DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   2624  5 000147   000027 450000 2                  STZ     I
         5 000150   000171 710000 5                  TRA     s:2630+1

      730     2625    3                  IF OC_CONSOLE.CID(I) = CADDRESS

   2625  5 000151   000015 236000 2                  LDQ     CADDRESS
         5 000152   000023 772000                    QRL     19
         5 000153   200010 756100                    STQ     I+1,,AUTO
         5 000154   000027 236000 2                  LDQ     I
         5 000155   000076 402007                    MPY     62,DL
         5 000156   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000157   000012 236106                    LDQ     10,QL,PR0
         5 000160   000022 772000                    QRL     18
         5 000161   200010 116100                    CMPQ    I+1,,AUTO
         5 000162   000170 601000 5                  TNZ     s:2630

      731     2626    3                  THEN
      732     2627    4                  DO;

      733     2628    4                       OC_CONSOLE.GHST(I) = '0'B /*FALSE#*/;

   2628  5 000163   000027 236000 2                  LDQ     I
         5 000164   000076 402007                    MPY     62,DL
         5 000165   000000 620006                    EAX0    0,QL
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:108  
         5 000166   000000 236000 6                  LDQ     0
         5 000167   000017 356110                    ANSQ    15,X0,PR0

      734     2629    4                     END;

      735     2630    3                END;                       /* DO I = 0 TO MAX_CONSOLES# */

   2630  5 000170   000027 054000 2                  AOS     I
         5 000171   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         5 000172   000022 772000                    QRL     18
         5 000173   000027 116000 2                  CMPQ    I
         5 000174   000151 605000 5                  TPL     s:2625

      736     2631    2           END;                            /* DO IF FCN IS RESET GHOST ACTIVE */

      737     2632                                                /**/
      738     2633    1        IF FCN = 5 /* cancel read */

   2633  5 000175   000035 236000 2                  LDQ     FCN
         5 000176   777000 376003                    ANQ     -512,DU
         5 000177   005000 116003                    CMPQ    2560,DU
         5 000200   000241 601000 5                  TNZ     s:2653

      739     2634    1        THEN
      740     2635    2        DO;

      741     2636    2             FOUND = '0'B /*FALSE#*/;

   2636  5 000201   000002 450000 2                  STZ     FOUND

      742     2637    2             PEND$ = OCP_USED_HEAD$;

   2637  5 000202   000000 236000 xsym               LDQ     OCP_USED_HEAD
         5 000203   000001 756000 2                  STQ     PEND$

      743     2638    3             DO WHILE (~FOUND AND (PEND$ ~= ADDR(NIL)));

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:109  
   2638  5 000204   000222 710000 5                  TRA     s:2644

      744     2639    3                  IF PEND$ -> OC$PEND.SYSID = OC_MESSBUF.SYSID

   2639  5 000205   000001 235000 xsym               LDA     OC_MESSBUF+1
         5 000206   000022 731000                    ARS     18
         5 000207   200010 755100                    STA     I+1,,AUTO
         5 000210   000001 470400 2                  LDP0    PEND$
         5 000211   000003 236100                    LDQ     3,,PR0
         5 000212   777777 376007                    ANQ     -1,DL
         5 000213   200010 116100                    CMPQ    I+1,,AUTO
         5 000214   000220 601000 5                  TNZ     s:2643

      745     2640    3                  THEN
      746     2641    3                       FOUND = '1'B /*TRUE#*/;

   2641  5 000215   400000 236003                    LDQ     -131072,DU
         5 000216   000002 756000 2                  STQ     FOUND
         5 000217   000222 710000 5                  TRA     s:2644

      747     2642    3                  ELSE
      748     2643    3                       PEND$ = PEND$ -> OC$PEND.LINK$;

   2643  5 000220   000000 236100                    LDQ     0,,PR0
         5 000221   000001 756000 2                  STQ     PEND$

      749     2644    3                END;                       /* DO WHILE */

   2644  5 000222   000002 236000 2                  LDQ     FOUND
         5 000223   400000 376003                    ANQ     -131072,DU
         5 000224   400000 676003                    ERQ     -131072,DU
         5 000225   000231 600000 5                  TZE     s:2645
         5 000226   000001 236000 2                  LDQ     PEND$
         5 000227   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000230   000205 601000 5                  TNZ     s:2639

      750     2645    2             IF FOUND
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:110  

   2645  5 000231   000002 234000 2                  SZN     FOUND
         5 000232   000237 605000 5                  TPL     s:2648

      751     2646    2             THEN
      752     2647    2                  CALL OCP$PENDRMV(PEND$);

   2647  5 000233   000001 630400 6                  EPPR0   1
         5 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000235   000000 701000 xent               TSX1    OCP$PENDRMV
         5 000236   000000 011000                    NOP     0

      753     2648    2             FCN = 3 /* write */;

   2648  5 000237   003000 236003                    LDQ     1536,DU
         5 000240   000035 756000 2                  STQ     FCN

      754     2649    2           END;                            /* DO IF CANCEL READ */

      755     2650                                                /**/
      756     2651                                                /**/
      757     2652                                                /**/
      758     2653    1        IO = '1'B /*TRUE#*/;

   2653  5 000241   400000 236003                    LDQ     -131072,DU
         5 000242   000003 756000 2                  STQ     IO

      759     2654    2        DO WHILE (IO);

   2654  5 000243   000003 234000 2                  SZN     IO
         5 000244   000743 605000 5                  TPL     s:2813

      760     2655    2             IF (FCN = 1 /* stop timed write */)

   2655  5 000245   000035 236000 2                  LDQ     FCN
         5 000246   777000 376003                    ANQ     -512,DU
         5 000247   001000 116003                    CMPQ    512,DU
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:111  
         5 000250   000331 601000 5                  TNZ     s:2681

      761     2656    2             THEN
      762     2657    3             DO;

      763     2658    3                  TEMP1 = BITBIN (BINBIT (OC_MESSBUF.MSGID, 36) & '000000000377'O);

   2658  5 000251   000001 236000 xsym               LDQ     OC_MESSBUF+1
         5 000252   000022 772000                    QRL     18
         5 000253   000000 376000 4                  ANQ     0
         5 000254   000034 756000 2                  STQ     TEMP1

      764     2659    4                  DO I = 1 TO 256;

   2659  5 000255   000001 235007                    LDA     1,DL
         5 000256   000027 755000 2                  STA     I

      765     2660    4                       IF ((OCP_MSGBUF_LIST.LINK (TEMP1) ~= 511) AND

   2660  5 000257   000034 235000 2                  LDA     TEMP1
         5 000260   000002 735000                    ALS     2
         5 000261   000001 236005 xsym               LDQ     OCP_MSGBUF_LIST+1,AL
         5 000262   777000 376003                    ANQ     -512,DU
         5 000263   777000 116003                    CMPQ    -512,DU
         5 000264   000317 600000 5                  TZE     s:2674
         5 000265   000000 220005 xsym               LDX0    OCP_MSGBUF_LIST,AL
         5 000266   000001 100000 xsym               CMPX0   OC_MESSBUF+1
         5 000267   000317 601000 5                  TNZ     s:2674

      766     2661    4                            (OCP_MSGBUF_LIST.MSGID (TEMP1) = OC_MESSBUF.MSGID))
      767     2662    5                       THEN DO;

      768     2663                                      /* here TEMP1 contains index to MSGID to remove */
      769     2664    5                            TEMP = OCP_MSGBUF_LIST.LINK (TEMP1);

   2664  5 000270   000001 236005 xsym               LDQ     OCP_MSGBUF_LIST+1,AL
         5 000271   000033 772000                    QRL     27
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:112  
         5 000272   000033 756000 2                  STQ     TEMP

      770     2665    5                            OCP_MSGBUF_LIST.LINK (TEMP1) = 511;

   2665  5 000273   777000 236003                    LDQ     -512,DU
         5 000274   000001 256005 xsym               ORSQ    OCP_MSGBUF_LIST+1,AL

      771     2666    6                            DO WHILE (TEMP ~= 511);

   2666  5 000275   000033 235000 2                  LDA     TEMP
         5 000276   000777 115007                    CMPA    511,DL
         5 000277   000317 600000 5                  TZE     s:2674

      772     2667                                                /* Indicate free buffer */
      773     2668    6                                 OCP_MSGBUF_FREE.B (TEMP) = '1'B /*TRUE#*/;

   2668  5 000300   000033 235000 2                  LDA     TEMP
         5 000301   003005 060400                    CSL     bolr='003'O
         5 000302   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000303   000000 000001 xsym               BDSC    OCP_MSGBUF_FREE,A        by=0,bit=0,n=1

      774     2669    6                                 TEMP$ = PINCRW (OCP_MSGBUF$, TEMP * 8);

   2669  5 000304   000033 236000 2                  LDQ     TEMP
         5 000305   000025 736000                    QLS     21
         5 000306   000000 036000 xsym               ADLQ    OCP_MSGBUF$
         5 000307   000000 756000 2                  STQ     TEMP$

      775     2670    6                                 TEMP = TEMP$ -> OCP$MSGBUF_UNIT.LINK;

   2670  5 000310   000000 470400 2                  LDP0    TEMP$
         5 000311   000000 101500                    MRL     fill='000'O
         5 000312   000007 600001                    ADSC9   7,,PR0                   cn=3,n=1
         5 000313   000033 000004 2                  ADSC9   TEMP                     cn=0,n=4

      776     2671    6                               END;

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:113  
   2671  5 000314   000033 235000 2                  LDA     TEMP
         5 000315   000777 115007                    CMPA    511,DL
         5 000316   000300 601000 5                  TNZ     s:2668

      777     2672    5                          END;             /* DO */

      778     2673
      779     2674    4                       TEMP1 = BITBIN(BINBIT(TEMP1+1,36) &

   2674  5 000317   000034 236000 2                  LDQ     TEMP1
         5 000320   000001 036007                    ADLQ    1,DL
         5 000321   000000 376000 4                  ANQ     0
         5 000322   000034 756000 2                  STQ     TEMP1

      780     2675    4                            '000000000377'O);
      781     2676    4                     END;                  /* DO I */

   2676  5 000323   000027 054000 2                  AOS     I
         5 000324   000027 235000 2                  LDA     I
         5 000325   000400 115007                    CMPA    256,DL
         5 000326   000257 604400 5                  TMOZ    s:2660

      782     2677    3                  IO = '0'B /*FALSE#*/;

   2677  5 000327   000003 450000 2                  STZ     IO

      783     2678    3                END;

   2678  5 000330   000741 710000 5                  TRA     s:2812

      784     2679    2             ELSE
      785     2680    3             DO;

      786     2681    3                  IF WRITE_FCN (FCN)

   2681  5 000331   000035 236000 2                  LDQ     FCN
         5 000332   000033 772000                    QRL     27
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:114  
         5 000333   000000 066406                    CMPB    filb='0'B
         5 000334   000005 000001 2                  BDSC    WRITE_FCN,Q              by=0,bit=0,n=1
         5 000335   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000336   000477 600000 5                  TZE     s:2727

      787     2682    3                  THEN
      788     2683    4                  DO;

      789     2684    4                       CALL OCM$TPSET(ENGLISH,OC_MESSBUF1) ALTRET(BAD_TEMP);

   2684  5 000337   000002 630400 6                  EPPR0   2
         5 000340   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000341   000000 701000 xent               TSX1    OCM$TPSET
         5 000342   000744 702000 5                  TSX2    BAD_TEMP

      790     2685    4                       DO_WRITE = '1'B /*TRUE#*/;

   2685  5 000343   400000 236003                    LDQ     -131072,DU
         5 000344   000036 756000 2                  STQ     DO_WRITE

      791     2686    4                       IF FCN = 2 /* timed write */

   2686  5 000345   000035 236000 2                  LDQ     FCN
         5 000346   777000 376003                    ANQ     -512,DU
         5 000347   002000 116003                    CMPQ    1024,DU
         5 000350   000461 601000 5                  TNZ     s:2719

      792     2687    4                       THEN
      793     2688    5                       DO;

      794     2689    5                            CALL NEXT_FREE; /* result to FREE  */

   2689  5 000351   000032 701000 5                  TSX1    NEXT_FREE
         5 000352   000000 011000                    NOP     0

      795     2690    5                            CALL HASH;     /* result to TEMP */

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:115  
   2690  5 000353   000003 701000 5                  TSX1    HASH
         5 000354   000000 011000                    NOP     0

      796     2691    5                            OCP_MSGBUF_LIST.MSGID(TEMP) = OC_MESSBUF.MSGID;

   2691  5 000355   000033 235000 2                  LDA     TEMP
         5 000356   000002 735000                    ALS     2
         5 000357   000001 220000 xsym               LDX0    OC_MESSBUF+1
         5 000360   000000 740005 xsym               STX0    OCP_MSGBUF_LIST,AL

      797     2692    5                            OCP_MSGBUF_LIST.CADDR(TEMP) = OC_MESSBUF.CADDR;

   2692  5 000361   000000 221000 xsym               LDX1    OC_MESSBUF
         5 000362   000000 441005 xsym               SXL1    OCP_MSGBUF_LIST,AL

      798     2693    5                            OCP_MSGBUF_LIST.WSN(TEMP) = OC_MESSBUF.WSN;

   2693  5 000363   000002 735000                    ALS     2
         5 000364   040005 100400                    MLR     fill='040'O
         5 000365   000003 000010 xsym               ADSC9   OC_MESSBUF+3             cn=0,n=8
         5 000366   000002 000010 xsym               ADSC9   OCP_MSGBUF_LIST+2,A      cn=0,n=8

      799     2694    5                            OCP_MSGBUF_LIST.LINK(TEMP) = FREE;

   2694  5 000367   000033 235000 2                  LDA     TEMP
         5 000370   000002 735000                    ALS     2
         5 000371   000026 236000 2                  LDQ     FREE
         5 000372   000033 736000                    QLS     27
         5 000373   000001 676005 xsym               ERQ     OCP_MSGBUF_LIST+1,AL
         5 000374   777000 376003                    ANQ     -512,DU
         5 000375   000001 656005 xsym               ERSQ    OCP_MSGBUF_LIST+1,AL

      800     2695    5                            LIMIT = (MESSAGE_SIZE - 1) / 31;

   2695  5 000376   200005 470500                    LDP0    @MESSAGE_SIZE,,AUTO
         5 000377   000100 100500                    MLR     fill='000'O
         5 000400   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:116  
         5 000401   200010 000004                    ADSC9   I+1,,AUTO                cn=0,n=4
         5 000402   200010 236100                    LDQ     I+1,,AUTO
         5 000403   000001 136007                    SBLQ    1,DL
         5 000404   000037 506007                    DIV     31,DL
         5 000405   000032 756000 2                  STQ     LIMIT

      801     2696    5                            J = 0;

   2696  5 000406   000030 450000 2                  STZ     J

      802     2697    6                            DO I = 0 TO LIMIT;

   2697  5 000407   000027 450000 2                  STZ     I
         5 000410   000452 710000 5                  TRA     s:2711+1

      803     2698    6                                 TEMP$ = PINCRW (OCP_MSGBUF$, FREE * 8);

   2698  5 000411   000026 236000 2                  LDQ     FREE
         5 000412   000025 736000                    QLS     21
         5 000413   000000 036000 xsym               ADLQ    OCP_MSGBUF$
         5 000414   000000 756000 2                  STQ     TEMP$

      804     2699    6                                 CALL INSERT (TEMP$->OCP$MSGBUF_UNIT.BUF,

   2699  5 000415   200005 470500                    LDP0    @MESSAGE_SIZE,,AUTO
         5 000416   000100 100500                    MLR     fill='000'O
         5 000417   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 000420   200010 000004                    ADSC9   I+1,,AUTO                cn=0,n=4
         5 000421   200010 236100                    LDQ     I+1,,AUTO
         5 000422   000030 136000 2                  SBLQ    J
         5 000423   200004 471500                    LDP1    @MESSAGE_BUFFER,,AUTO
         5 000424   000000 620006                    EAX0    0,QL
         5 000425   000030 235000 2                  LDA     J
         5 000426   000000 473400 2                  LDP3    TEMP$
         5 000427   040100 100545                    MLR     fill='040'O
         5 000430   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         5 000431   300000 000037                    ADSC9   0,,PR3                   cn=0,n=31
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:117  

      805     2700    6                                      0, 31,
      806     2701    6                                      SUBSTR (MESSAGE_BUFFER, J, MESSAGE_SIZE - J));
      807     2702    6                                 J = J + 31;

   2702  5 000432   000037 236007                    LDQ     31,DL
         5 000433   000030 056000 2                  ASQ     J

      808     2703    6                                 IF (I = LIMIT)

   2703  5 000434   000027 236000 2                  LDQ     I
         5 000435   000032 116000 2                  CMPQ    LIMIT
         5 000436   000443 601000 5                  TNZ     s:2708

      809     2704    6                                 THEN
      810     2705    6                                      TEMP$ -> OCP$MSGBUF_UNIT.LINK = 511;

   2705  5 000437   000100 101400                    MRL     fill='000'O
         5 000440   000004 000004 6                  ADSC9   4                        cn=0,n=4
         5 000441   300007 600001                    ADSC9   7,,PR3                   cn=3,n=1
         5 000442   000451 710000 5                  TRA     s:2711

      811     2706    6                                 ELSE
      812     2707    7                                 DO;

      813     2708    7                                      CALL NEXT_FREE;

   2708  5 000443   000032 701000 5                  TSX1    NEXT_FREE
         5 000444   000000 011000                    NOP     0

      814     2709    7                                      TEMP$ -> OCP$MSGBUF_UNIT.LINK = FREE;

   2709  5 000445   000000 470400 2                  LDP0    TEMP$
         5 000446   000100 101400                    MRL     fill='000'O
         5 000447   000026 000004 2                  ADSC9   FREE                     cn=0,n=4
         5 000450   000007 600001                    ADSC9   7,,PR0                   cn=3,n=1

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:118  
      815     2710    7                                    END;

      816     2711    6                               END;

   2711  5 000451   000027 054000 2                  AOS     I
         5 000452   000027 236000 2                  LDQ     I
         5 000453   000032 116000 2                  CMPQ    LIMIT
         5 000454   000411 604400 5                  TMOZ    s:2698

      817     2712                                           /* Don't write if <= 5  seconds till
      818     2713                                                next DOLIST call */
      819     2714    5                            IF OC_REMAIN <= 5

   2714  5 000455   000000 235000 xsym               LDA     OC_REMAIN
         5 000456   000006 115007                    CMPA    6,DL
         5 000457   000461 603000 5                  TRC     s:2719

      820     2715    5                            THEN
      821     2716    5                                 DO_WRITE = '0'B /*FALSE#*/;

   2716  5 000460   000036 450000 2                  STZ     DO_WRITE

      822     2717                                                /**/
      823     2718    5                          END;

      824     2719    4                       IF DO_WRITE

   2719  5 000461   000036 234000 2                  SZN     DO_WRITE
         5 000462   000476 605000 5                  TPL     s:2725

      825     2720    4                       THEN
      826     2721    4                            CALL OCW$WRITE (OC_MESSBUF2, MESSAGE_SIZE,

   2721  5 000463   000005 236000 6                  LDQ     5
         5 000464   200014 756100                    STQ     I+5,,AUTO
         5 000465   000006 237000 6                  LDAQ    6
         5 000466   200012 757100                    STAQ    I+3,,AUTO
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:119  
         5 000467   200005 236100                    LDQ     @MESSAGE_SIZE,,AUTO
         5 000470   000003 235000 6                  LDA     3
         5 000471   200010 757100                    STAQ    I+1,,AUTO
         5 000472   200010 630500                    EPPR0   I+1,,AUTO
         5 000473   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000474   000000 701000 xent               TSX1    OCW$WRITE
         5 000475   000000 011000                    NOP     0

      827     2722    4                                 OC_MESSBUF.CADDR,
      828     2723    4                                 OC_MESSBUF.WSN,
      829     2724    4                                 OC_MESSBUF.MSG#);
      830     2725    4                       IO = '0'B /*FALSE#*/;

   2725  5 000476   000003 450000 2                  STZ     IO

      831     2726    4                     END;

      832     2727    3                  IF READ_FCN (FCN)

   2727  5 000477   000035 236000 2                  LDQ     FCN
         5 000500   000033 772000                    QRL     27
         5 000501   000000 066406                    CMPB    filb='0'B
         5 000502   000006 000001 2                  BDSC    READ_FCN,Q               by=0,bit=0,n=1
         5 000503   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000504   000741 600000 5                  TZE     s:2812

      833     2728    3                  THEN
      834     2729    4                  DO;

      835     2730                                           /* Only M$KEYIN or console ghost can
      836     2731                                                perform read */
      837     2732    4                       IF NOT (GHST OR SUBSTR (STA, 0, 2) = '&&')

   2732  5 000505   000040 234000 2                  SZN     GHST
         5 000506   000513 604000 5                  TMI     s:2735
         5 000507   000013 220000 2                  LDX0    STA
         5 000510   000004 100000 4                  CMPX0   4
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:120  
         5 000511   000513 600000 5                  TZE     s:2735

      838     2733    4                       THEN
      839     2734    4                            RETURN;

   2734  5 000512   000000 702200 xent               TSX2  ! X66_ARET

      840     2735    4                       IF GHST

   2735  5 000513   000040 234000 2                  SZN     GHST
         5 000514   000620 605000 5                  TPL     s:2762

      841     2736    4                       THEN
      842     2737    5                       DO;

      843     2738    6                            DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   2738  5 000515   000027 450000 2                  STZ     I
         5 000516   000612 710000 5                  TRA     s:2756+1

      844     2739    6                                 IF OC_CONSOLE.SYSID(I) = RESTA.SYSID

   2739  5 000517   000027 236000 2                  LDQ     I
         5 000520   000076 402007                    MPY     62,DL
         5 000521   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000522   000012 720106                    LXL0    10,QL,PR0
         5 000523   000014 100000 2                  CMPX0   STA+1
         5 000524   000611 601000 5                  TNZ     s:2756

      845     2740    6                                 THEN
      846     2741    7                                 DO;

      847     2742    7                                      OC_CONSOLE.GHSTRD(I) = '1'B /*TRUE#*/;

   2742  5 000525   000000 621006                    EAX1    0,QL
         5 000526   200000 236007                    LDQ     65536,DL
         5 000527   000017 256111                    ORSQ    15,X1,PR0
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:121  

      848     2743    8                                      DO K = 0 TO 2;

   2743  5 000530   000031 450000 2                  STZ     K

      849     2744    8                                           ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2744  5 000531   000031 236000 2                  LDQ     K
         5 000532   000042 402007                    MPY     34,DL
         5 000533   200010 756100                    STQ     I+1,,AUTO
         5 000534   000027 236000 2                  LDQ     I
         5 000535   000370 402007                    MPY     248,DL
         5 000536   200010 036100                    ADLQ    I+1,,AUTO
         5 000537   000011 402007                    MPY     9,DL
         5 000540   000000 116003                    CMPQ    0,DU
         5 000541   000543 605000 5                  TPL     s:2744+10
         5 000542   000044 036003                    ADLQ    36,DU
         5 000543   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000544   003106 060400                    CSL     bolr='003'O
         5 000545   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 000546   000022 000001                    BDSC    18,Q,PR0                 by=0,bit=0,n=1

      850     2745    8                                                PROMPT_TABLE.LAST_READ(K)
      851     2746    8                                                = '0'B /*FALSE#*/;
      852     2747    8                                         END; /* DO K = 0 TO 2 */

   2747  5 000547   000031 054000 2                  AOS     K
         5 000550   000031 235000 2                  LDA     K
         5 000551   000002 115007                    CMPA    2,DL
         5 000552   000531 604400 5                  TMOZ    s:2744

      853     2748    7                                      ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2748  5 000553   000002 236000 xsym               LDQ     OC_MESSBUF+2
         5 000554   000033 772000                    QRL     27
         5 000555   000042 402007                    MPY     34,DL
         5 000556   200010 756100                    STQ     I+1,,AUTO
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:122  
         5 000557   000027 236000 2                  LDQ     I
         5 000560   000370 402007                    MPY     248,DL
         5 000561   200010 036100                    ADLQ    I+1,,AUTO
         5 000562   000011 402007                    MPY     9,DL
         5 000563   000000 116003                    CMPQ    0,DU
         5 000564   000566 605000 5                  TPL     s:2748+11
         5 000565   000044 036003                    ADLQ    36,DU
         5 000566   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000567   003106 060400                    CSL     bolr='003'O
         5 000570   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000571   000011 400001                    BDSC    9,Q,PR0                  by=2,bit=0,n=1

      854     2749    7                                           PROMPT_TABLE.LAST_READ(OC_MESSBUF.PFB-1)
      855     2750    7                                           = '1'B /*TRUE#*/;
      856     2751    7                                      ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2751  5 000572   000002 236000 xsym               LDQ     OC_MESSBUF+2
         5 000573   000033 772000                    QRL     27
         5 000574   000042 402007                    MPY     34,DL
         5 000575   200010 756100                    STQ     I+1,,AUTO
         5 000576   000027 236000 2                  LDQ     I
         5 000577   000370 402007                    MPY     248,DL
         5 000600   200010 036100                    ADLQ    I+1,,AUTO
         5 000601   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000602   000106 100400                    MLR     fill='000'O
         5 000603   000005 400002 xsym               ADSC9   OC_MESSBUF+5             cn=2,n=2
         5 000604   000021 400002                    ADSC9   17,Q,PR0                 cn=2,n=2

      857     2752    7                                           PROMPT_TABLE.SIZER(OC_MESSBUF.PFB-1)
      858     2753    7                                           = OC_MESSBUF1.GRD.SZR;
      859     2754    7                                      I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   2754  5 000605   000000 235000 xsym               LDA     OC_MAXCONSOLE
         5 000606   000022 771000                    ARL     18
         5 000607   000001 035007                    ADLA    1,DL
         5 000610   000027 755000 2                  STA     I

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:123  
      860     2755    7                                    END;   /* IF SYSID MATCHES */

      861     2756    6                               END;        /* DO I = 0 TO MAX_CONSOLES# */

   2756  5 000611   000027 054000 2                  AOS     I
         5 000612   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         5 000613   000022 772000                    QRL     18
         5 000614   000027 116000 2                  CMPQ    I
         5 000615   000517 605000 5                  TPL     s:2739

      862     2757    5                            IO = '0'B /*FALSE#*/;

   2757  5 000616   000003 450000 2                  STZ     IO

      863     2758    5                          END;

   2758  5 000617   000732 710000 5                  TRA     s:2807

      864     2759    4                       ELSE
      865     2760    5                       DO;

      866     2761                                                /* Need more space ? */
      867     2762    5                            SIZENT = SIZEW (OC$PEND_NOMSG) +

   2762  5 000620   200005 470500                    LDP0    @MESSAGE_SIZE,,AUTO
         5 000621   000100 100500                    MLR     fill='000'O
         5 000622   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         5 000623   200010 000004                    ADSC9   I+1,,AUTO                cn=0,n=4
         5 000624   200010 236100                    LDQ     I+1,,AUTO
         5 000625   000003 036007                    ADLQ    3,DL
         5 000626   000002 772000                    QRL     2
         5 000627   000012 036007                    ADLQ    10,DL
         5 000630   000037 756000 2                  STQ     SIZENT

      868     2763    5                                 ((MESSAGE_SIZE + (4 /* BYTESPERWD# */ - 1)) /
      869     2764    5                                 4 /* BYTESPERWD# */);
      870     2765    5                            IF (OCP_PEND_USED + SIZENT+1) > OCP_PEND_TOT
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:124  

   2765  5 000631   000000 036000 xsym               ADLQ    OCP_PEND_USED
         5 000632   000000 116000 xsym               CMPQ    OCP_PEND_TOT
         5 000633   000646 604000 5                  TMI     s:2780

      871     2766    5                            THEN
      872     2767    6                            DO;

      873     2768    6                                 CALL M$GDS (FPT_GDS)

   2768  5 000634   000074 630400 2                  EPPR0   FPT_GDS
         5 000635   430001 713400                    CLIMB   alt,gds
         5 000636   400400 401760                    pmme    nvectors=2
         5 000637   000745 702000 5                  TSX2    CANT_GET_PAGE

      874     2769    6                                      ALTRET (CANT_GET_PAGE);
      875     2770    6                                 OCP_PEND_TOT = OCP_PEND_TOT +

   2770  5 000640   002000 236007                    LDQ     1024,DL
         5 000641   000000 056000 xsym               ASQ     OCP_PEND_TOT

      876     2771    6                                      1024 /* WDSPERPAGE# */;
      877     2772    6                                 IF OCP_PEND_USED+SIZENT > OCP_PEND_TOT

   2772  5 000642   000000 236000 xsym               LDQ     OCP_PEND_USED
         5 000643   000037 036000 2                  ADLQ    SIZENT
         5 000644   000000 116000 xsym               CMPQ    OCP_PEND_TOT
         5 000645   000745 605400 5                  TPNZ    CANT_GET_PAGE

      878     2773    6                                 THEN
      879     2774    6                                      GOTO CANT_GET_PAGE;
      880     2775    6                               END;

      881     2776                                                /**/
      882     2777                                           /* Move the relevant information
      883     2778                                                to the appropriate area of
      884     2779                                                memory */
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:125  
      885     2780    5                            OCP_FREE_HEAD$ -> OC$PEND.STATION = STA;

   2780  5 000646   000000 470400 xsym               LDP0    OCP_FREE_HEAD
         5 000647   040100 100400                    MLR     fill='040'O
         5 000650   000013 000010 2                  ADSC9   STA                      cn=0,n=8
         5 000651   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

      886     2781    5                            OCP_FREE_HEAD$ -> OC$PEND.ACCN = OC_MESSBUF1.ACCN;

   2781  5 000652   040100 100400                    MLR     fill='040'O
         5 000653   000007 000010 xsym               ADSC9   OC_MESSBUF+7             cn=0,n=8
         5 000654   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8

      887     2782    5                            OCP_FREE_HEAD$ -> OC$PEND.SYSID = OC_MESSBUF1.SYSID;

   2782  5 000655   000001 220000 xsym               LDX0    OC_MESSBUF+1
         5 000656   000003 440100                    SXL0    3,,PR0

      888     2783    5                            OCP_FREE_HEAD$ -> OC$PEND.READID = OCP_READID;

   2783  5 000657   000000 221000 xsym               LDX1    OCP_READID
         5 000660   000003 741100                    STX1    3,,PR0

      889     2784    5                            OCP_FREE_HEAD$ -> OC$PEND.CADDR = OC_MESSBUF1.CADDR;

   2784  5 000661   000000 222000 xsym               LDX2    OC_MESSBUF
         5 000662   000002 742100                    STX2    2,,PR0

      890     2785    5                            OCP_FREE_HEAD$ -> OC$PEND.SIZER = OC_MESSBUF1.SZR;

   2785  5 000663   000006 723000 xsym               LXL3    OC_MESSBUF+6
         5 000664   000777 363003                    ANX3    511,DU
         5 000665   000002 443100                    SXL3    2,,PR0

      891     2786    5                            OCP_FREE_HEAD$ -> OC$PEND.WSN = OC_MESSBUF1.WSN;

   2786  5 000666   040100 100400                    MLR     fill='040'O
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:126  
         5 000667   000003 000010 xsym               ADSC9   OC_MESSBUF+3             cn=0,n=8
         5 000670   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8

      892     2787    5                            OCP_FREE_HEAD$ -> OC$PEND.SIZEB_MSG = MESSAGE_SIZE;

   2787  5 000671   200005 471500                    LDP1    @MESSAGE_SIZE,,AUTO
         5 000672   000100 101500                    MRL     fill='000'O
         5 000673   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         5 000674   000001 400002                    ADSC9   1,,PR0                   cn=2,n=2

      893     2788    5                            OCP_FREE_HEAD$ -> OC$PEND.MESSAGE = OC_MESSBUF2;

   2788  5 000675   000001 724100                    LXL4    1,,PR0
         5 000676   040140 100400                    MLR     fill='040'O
         5 000677   000000 000310 xsym               ADSC9   OC_MESSBUF               cn=0,n=200
         5 000700   000012 000014                    ADSC9   10,,PR0                  cn=0,n=*X4

      894     2789    5                            OCP_FREE_HEAD$ -> OC$PEND.SIZEW_ENTRY = SIZENT;

   2789  5 000701   000037 725000 2                  LXL5    SIZENT
         5 000702   000001 745100                    STX5    1,,PR0

      895     2790                                                /**/
      896     2791                                           /* Adjust the controlled pointers
      897     2792                                                accordingly */
      898     2793    5                            IF OCP_USED_HEAD$ = ADDR(NIL)

   2793  5 000703   000000 236000 xsym               LDQ     OCP_USED_HEAD
         5 000704   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 000705   000710 601000 5                  TNZ     s:2796

      899     2794    5                            THEN
      900     2795    5                                 OCP_USED_HEAD$ = DS3$;

   2795  5 000706   000012 236000 2                  LDQ     DS3_PTR
         5 000707   000000 756000 xsym               STQ     OCP_USED_HEAD

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:127  
      901     2796    5                            OCP_USED_TAIL$ -> OC$PEND.LINK$ = OCP_FREE_HEAD$;

   2796  5 000710   000000 236000 xsym               LDQ     OCP_FREE_HEAD
         5 000711   000000 473400 xsym               LDP3    OCP_USED_TAIL
         5 000712   300000 756100                    STQ     0,,PR3

      902     2797    5                            OCP_USED_TAIL$ = OCP_FREE_HEAD$;

   2797  5 000713   000000 236000 xsym               LDQ     OCP_FREE_HEAD
         5 000714   000000 756000 xsym               STQ     OCP_USED_TAIL

      903     2798    5                            OCP_FREE_HEAD$ = PINCRW (OCP_FREE_HEAD$, SIZENT);

   2798  5 000715   000037 236000 2                  LDQ     SIZENT
         5 000716   000022 736000                    QLS     18
         5 000717   000000 036000 xsym               ADLQ    OCP_FREE_HEAD
         5 000720   000000 756000 xsym               STQ     OCP_FREE_HEAD

      904     2799    5                            OCP_USED_TAIL$ -> OC$PEND.LINK$ = ADDR(NIL);

   2799  5 000721   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 000722   000000 470400 xsym               LDP0    OCP_USED_TAIL
         5 000723   000000 756100                    STQ     0,,PR0

      905     2800    5                            OCP_PEND_USED = OCP_PEND_USED + SIZENT;

   2800  5 000724   000000 236000 xsym               LDQ     OCP_PEND_USED
         5 000725   000037 036000 2                  ADLQ    SIZENT
         5 000726   000000 756000 xsym               STQ     OCP_PEND_USED

      906     2801    5                            OCP_READID = OCP_READID + 1;

   2801  5 000727   000000 220000 xsym               LDX0    OCP_READID
         5 000730   000001 621010                    EAX1    1,X0
         5 000731   000000 741000 xsym               STX1    OCP_READID

      907     2802    5                          END;
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:128  

      908     2803        /*
      909     2804           CONVENTION: Read message numbers are one greater
      910     2805                       than write message numbers.
      911     2806                                                             */
      912     2807    4                       OC_MESSBUF1.MSG# = OC_MESSBUF1.MSG# + 1;

   2807  5 000732   000000 720000 xsym               LXL0    OC_MESSBUF
         5 000733   000001 621010                    EAX1    1,X0
         5 000734   000000 441000 xsym               SXL1    OC_MESSBUF

      913     2808    4                       FCN = 3 /* write */;

   2808  5 000735   003000 236003                    LDQ     1536,DU
         5 000736   000035 756000 2                  STQ     FCN

      914     2809    4                       IO = '1'B /*TRUE#*/;

   2809  5 000737   400000 236003                    LDQ     -131072,DU
         5 000740   000003 756000 2                  STQ     IO

      915     2810    4                     END;

      916     2811    3                END;

      917     2812    2           END;                            /* WHILE (IO)                         */

   2812  5 000741   000003 234000 2                  SZN     IO
         5 000742   000245 604000 5                  TMI     s:2655

      918     2813    1        RETURN;

   2813  5 000743   000000 702200 xent               TSX2  ! X66_ARET

      919     2814    1   BAD_TEMP: RETURN;

   2814  5 000744   000000 702200 xent  BAD_TEMP     TSX2  ! X66_ARET
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:129  

      920     2815    1   CANT_GET_PAGE:
      921     2816    1        CALL M$DEACTIVATE (DEACT) ALTRET (IGNORE);

   2816  5 000745   000054 630400 2     CANT_GET_PA* EPPR0   DEACT
         5 000746   500001 713400                    CLIMB   alt,+32769
         5 000747   401400 401760                    pmme    nvectors=4
         5 000750   000751 702000 5                  TSX2    IGNORE

      922     2817    1   IGNORE:
      923     2818    1        RETURN;

   2818  5 000751   000000 702200 xent  IGNORE       TSX2  ! X66_ARET
      924     2819    1   END OCO$MESSAGE;

PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:130  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OCM_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCO$MESSAGE.
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:131  

 **** Variables and constants ****

  ****  Section 002  Data  OCO$MESSAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w UBIN(17)    r     1 CADDRESS                  54-0-0/d STRC(576)   r     1 DEACT
    36-0-0/w BIT         r     1 DO_WRITE                  12-0-0/w PTR         r     1 DS3$
    12-0-0/w STRC        r     1 DS3_PTR                   10-0-0/b STRC(72)    r     1 DS3_VECT
    41-0-0/c CHAR        r     1 ENGLISH                   35-0-0/b UBIN(9)     r     1 FCN
     2-0-0/w BIT         r     1 FOUND                     74-0-0/d STRC(216)   r     1 FPT_GDS
    26-0-0/w UBIN        r     1 FREE                      40-0-0/w BIT         r     1 GHST
    13-0-0/c CHAR(4)     r     1 GSTA(0:1)                 27-0-0/w SBIN        r     1 I
     3-0-0/b BIT         r     1 IO                        30-0-0/w SBIN        r     1 J
    31-0-0/w SBIN        r     1 K                         32-0-0/w SBIN        r     1 LIMIT
     4-0-0/w BIT         r     1 MONKEY                    42-0-0/w STRC(360)   r     1 OC$PEND_NOMSG
     1-0-0/w PTR         r     1 PEND$
     6-0-0/b BIT         r     1 READ_FCN(0:4)
    13-0-0/c STRC(72)    r     1 RESTA                     37-0-0/w UBIN        r     1 SIZENT
    13-0-0/c CHAR(8)     r     1 STA                       33-0-0/w UBIN        r     1 TEMP
     0-0-0/w PTR         r     1 TEMP$                     34-0-0/w UBIN        r     1 TEMP1
     5-0-0/b BIT         r     1 WRITE_FCN(0:4)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @MESSAGE_BUFFER            5-0-0/w PTR         r     1 @MESSAGE_SIZE
     3-0-0/w PTR         r     1 @STATION                   7-0-0/w UBIN        r     1 I
    *0-0-0/c CHAR(140)   r     1 MESSAGE_BUFFER            *0-0-0/c UBIN        r     1 MESSAGE_SIZE
    *0-0-0/c CHAR(8)     r     1 STATION

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:132  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 OCP_FREE_HEAD              0-0-0/w PTR         r     1 OCP_FREE_HEAD$
     0-0-0/w PTR         r     1 OCP_MSGBUF$                0-0-0/b STRC(252)   r     1 OCP_MSGBUF_FREE
     0-0-0/c STRC(144)   r     1 OCP_MSGBUF_LIST(0:255)
     0-0-0/w SBIN        r     1 OCP_PEND_TOT               0-0-0/w SBIN        r     1 OCP_PEND_USED
     0-0-0/w UBIN(18)    r     1 OCP_READID                 0-0-0/w STRC        r     1 OCP_USED_HEAD
     0-0-0/w PTR         r     1 OCP_USED_HEAD$             0-0-0/w STRC        r     1 OCP_USED_TAIL
     0-0-0/w PTR         r     1 OCP_USED_TAIL$             0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE              0-0-0/c STRC(1800)  r     1 OC_MESSBUF
     0-0-0/c STRC(1800)  r     1 OC_MESSBUF1                0-0-0/c CHAR(200)   r     1 OC_MESSBUF2
     0-0-0/w BIT         r     1 OC_NOACT                   0-0-0/w UBIN        r     1 OC_REMAIN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$CSCG                     0-0-0/w ASTR(360)   r     1 OC$PEND
     0-0-0/c STRC(288)   r     1 OCP$MSGBUF_UNIT
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)
     0-0-0/c STRC(306)   r     1 PROMPT_TABLE(0:2)


   Procedure OCO$MESSAGE requires 490 words for executable code.
   Procedure OCO$MESSAGE requires 14 words of local(AUTO) storage.

    No errors detected in file OCO$OUTPUT.:E05TSI    .
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:133  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:134  
          MINI XREF LISTING

B$ALT.CODE
      2486**DCL      2486--REDEF    2487--REDEF    2487--REDEF
B$ALT.ERR.ERR#
      2488**DCL      2488--REDEF
B$ALT.EVID
      2487**DCL      2487--REDEF    2487--REDEF
BAD_TEMP
      2814**LABEL    2684--CALLALT
CADDRESS
       610**DCL      2623<<ASSIGN   2625>>IF
CANT_GET_PAGE
      2816**LABEL    2768--CALLALT  2774--GOTO
DEACT
      2509**DCL      2816<>CALL
DEACT.V
      2510**DCL      2509--DCLINIT
DEACT.V.DVBYTE.REREAD#
      2512**DCL      2512--REDEF
DO_WRITE
       626**DCL      2685<<ASSIGN   2716<<ASSIGN   2719>>IF
DS3$
       601**DCL      2795>>ASSIGN
DS3_PTR
       598**DCL       601--REDEF
DS3_VECT
       594**DCL      2534--DCLINIT
ENGLISH
       633**DCL      2684<>CALL
ERRCODE.B
        53**DCL        54--REDEF
FCN
       625**DCL      2606<<ASSIGN   2610>>IF       2619>>IF       2622<<ASSIGN   2633>>IF       2648<<ASSIGN
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:135  
      2655>>IF       2681>>IF       2686>>IF       2727>>IF       2808<<ASSIGN
FOUND
        44**DCL      2636<<ASSIGN   2638>>DOWHILE  2641<<ASSIGN   2645>>IF
FPT_GDS
      2534**DCL      2768<>CALL
FPT_GDS.V
      2534**DCL      2534--DCLINIT
FREE
       618**DCL      2561<<ASSIGN   2563>>IF       2567>>ASSIGN   2571<<ASSIGN   2571>>ASSIGN   2694>>ASSIGN
      2698>>ASSIGN   2709>>ASSIGN
GHST
       630**DCL      2602<<ASSIGN   2604<<ASSIGN   2732>>IF       2735>>IF
GSTA
       609**DCL      2600>>IF
HASH
      2542**PROC     2690--CALL
I
       619**DCL      2544<<DOINDEX  2624<<DOINDEX  2625>>IF       2628>>ASSIGN   2659<<DOINDEX  2697<<DOINDEX
      2703>>IF       2738<<DOINDEX  2739>>IF       2742>>ASSIGN   2744>>ASSIGN   2748>>ASSIGN   2751>>ASSIGN
      2754<<ASSIGN
I IN PROCEDURE NEXT_FREE
      2556**DCL      2557<<DOINDEX  2558>>IF       2561>>ASSIGN   2562>>DOWHILE  2568<<ASSIGN
IGNORE
      2818**LABEL    2816--CALLALT
IO
        45**DCL      2653<<ASSIGN   2654>>DOWHILE  2677<<ASSIGN   2725<<ASSIGN   2757<<ASSIGN   2809<<ASSIGN
J
       620**DCL      2696<<ASSIGN   2699>>CALLBLT  2699>>CALLBLT  2702<<ASSIGN   2702>>ASSIGN
K
       621**DCL      2743<<DOINDEX  2744>>ASSIGN
LIMIT
       622**DCL      2695<<ASSIGN   2697>>DOINDEX  2703>>IF
M$DEACTIVATE
      2267**DCL-ENT  2816--CALL
M$GDS
      2282**DCL-ENT  2768--CALL
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:136  
MESSAGE_BUFFER
        38**DCL        20--PROC     2592>>ASSIGN   2699>>CALLBLT
MESSAGE_SIZE
        39**DCL        20--PROC     2695>>ASSIGN   2699>>CALLBLT  2721<>CALL     2762>>ASSIGN   2787>>ASSIGN
MONKEY
        46**DCL      2596<<ASSIGN   2598<<ASSIGN
NEXT_FREE
      2555**PROC     2689--CALL     2708--CALL
OC$PEND.ACCN
       658**DCL      2781<<ASSIGN
OC$PEND.CADDR
       649**DCL      2784<<ASSIGN
OC$PEND.LINK$
       646**DCL      2643>>ASSIGN   2796<<ASSIGN   2799<<ASSIGN
OC$PEND.MESSAGE
       659**DCL      2788<<ASSIGN
OC$PEND.READID
       651**DCL      2783<<ASSIGN
OC$PEND.SIZEB_MSG
       648**DCL       659--IMP-SIZ  2787<<ASSIGN   2788>>ASSIGN
OC$PEND.SIZER
       650**DCL      2785<<ASSIGN
OC$PEND.SIZEW_ENTRY
       647**DCL      2789<<ASSIGN
OC$PEND.STATION
       653**DCL      2780<<ASSIGN
OC$PEND.SYSID
       652**DCL      2639>>IF       2782<<ASSIGN
OC$PEND.WSN
       654**DCL       655--REDEF    2786<<ASSIGN
OC$PEND_NOMSG
       683**DCL      2762--ASSIGN
OC$PEND_NOMSG.WSN
       692**DCL       693--REDEF
OCM$TPSET
        30**DCL-ENT  2684--CALL
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:137  
OCP$MSGBUF_UNIT.BUF
       811**DCL      2699<<CALLBLT
OCP$MSGBUF_UNIT.LINK
       811**DCL      2670>>ASSIGN   2705<<ASSIGN   2709<<ASSIGN
OCP$PENDRMV
        31**DCL-ENT  2647--CALL
OCP_FREE_HEAD
       806**DCL       807--REDEF
OCP_FREE_HEAD$
       807**DCL      2780>>ASSIGN   2781>>ASSIGN   2782>>ASSIGN   2783>>ASSIGN   2784>>ASSIGN   2785>>ASSIGN
      2786>>ASSIGN   2787>>ASSIGN   2788>>ASSIGN   2788>>ASSIGN   2789>>ASSIGN   2796>>ASSIGN   2797>>ASSIGN
      2798<<ASSIGN   2798>>ASSIGN
OCP_MSGBUF$
       809**DCL      2669>>ASSIGN   2698>>ASSIGN
OCP_MSGBUF_FREE.B
       810**DCL       810--REDEF    2563>>IF       2567<<ASSIGN   2668<<ASSIGN
OCP_MSGBUF_FREE.U
       810**DCL      2558>>IF
OCP_MSGBUF_LIST.CADDR
       810**DCL      2692<<ASSIGN
OCP_MSGBUF_LIST.LINK
       811**DCL      2545>>IF       2660>>IF       2664>>ASSIGN   2665<<ASSIGN   2694<<ASSIGN
OCP_MSGBUF_LIST.MSGID
       810**DCL      2660>>IF       2691<<ASSIGN
OCP_MSGBUF_LIST.WSN
       811**DCL      2693<<ASSIGN
OCP_PEND_TOT
       806**DCL      2765>>IF       2770<<ASSIGN   2770>>ASSIGN   2772>>IF
OCP_PEND_USED
       806**DCL      2765>>IF       2772>>IF       2800<<ASSIGN   2800>>ASSIGN
OCP_READID
       806**DCL      2783>>ASSIGN   2801<<ASSIGN   2801>>ASSIGN
OCP_USED_HEAD
       807**DCL       808--REDEF
OCP_USED_HEAD$
       808**DCL      2637>>ASSIGN   2793>>IF       2795<<ASSIGN
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:138  
OCP_USED_TAIL
       808**DCL       808--REDEF
OCP_USED_TAIL$
       808**DCL      2796>>ASSIGN   2797<<ASSIGN   2799>>ASSIGN
OCW$WRITE
        34**DCL-ENT  2721--CALL
OC_CONSOLE.ATTR
      2433**DCL      2433--REDEF
OC_CONSOLE.ATTRO
      2434**DCL      2434--REDEF
OC_CONSOLE.CID
      2432**DCL      2433--REDEF    2625>>IF
OC_CONSOLE.GHST
      2436**DCL      2628<<ASSIGN
OC_CONSOLE.GHSTRD
      2436**DCL      2742<<ASSIGN
OC_CONSOLE.PROMPTS
      2437**DCL      2744--ASSIGN   2748--ASSIGN   2751--ASSIGN
OC_CONSOLE.STATION
      2431**DCL      2431--REDEF
OC_CONSOLE.SYSID
      2433**DCL      2739>>IF
OC_CONSOLE$
      2430**DCL      2431--IMP-PTR  2625>>IF       2628>>ASSIGN   2739>>IF       2742>>ASSIGN   2744>>ASSIGN
      2748>>ASSIGN   2751>>ASSIGN
OC_DIR
      2473**DCL      2473--REDEF
OC_INTBIT
      2473**DCL      2474--REDEF
OC_INTMSG
      2350**DCL      2363--REDEF
OC_INTMSG.FLAGS
      2357**DCL      2358--REDEF
OC_INTMSG.MESS
      2363**DCL      2363--REDEF
OC_INTMSG.MSGID
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:139  
      2353**DCL      2354--REDEF
OC_INTMSG.WSN
      2360**DCL      2361--REDEF
OC_MASK
      2474**DCL      2474--REDEF
OC_MAXCONSOLE
      2430**DCL      2624>>DOINDEX  2738>>DOINDEX  2754>>ASSIGN
OC_MESSBUF
      2365**DCL      2380--REDEF    2394--REDEF
OC_MESSBUF.CADDR
      2366**DCL      2623>>ASSIGN   2692>>ASSIGN   2721<>CALL
OC_MESSBUF.FCN
      2371**DCL      2606>>ASSIGN
OC_MESSBUF.FLAGS
      2372**DCL      2373--REDEF
OC_MESSBUF.MESS
      2378**DCL      2378--REDEF
OC_MESSBUF.MSG#
      2367**DCL      2721<>CALL
OC_MESSBUF.MSGID
      2368**DCL      2369--REDEF    2543>>ASSIGN   2658>>ASSIGN   2660>>IF       2691>>ASSIGN
OC_MESSBUF.PFB
      2373**DCL      2748>>ASSIGN   2751>>ASSIGN
OC_MESSBUF.SYSID
      2369**DCL      2639>>IF
OC_MESSBUF.WSN
      2375**DCL      2376--REDEF    2693>>ASSIGN   2721<>CALL
OC_MESSBUF1
      2380**DCL      2684<>CALL
OC_MESSBUF1.ACCN
      2394**DCL      2781>>ASSIGN
OC_MESSBUF1.CADDR
      2381**DCL      2784>>ASSIGN
OC_MESSBUF1.FLAGS
      2387**DCL      2388--REDEF
OC_MESSBUF1.GRD.SZR
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:140  
      2393**DCL      2751>>ASSIGN
OC_MESSBUF1.LEN
      2393**DCL      2393--REDEF
OC_MESSBUF1.MSG#
      2382**DCL      2807<<ASSIGN   2807>>ASSIGN
OC_MESSBUF1.MSGID
      2383**DCL      2384--REDEF
OC_MESSBUF1.SYSID
      2384**DCL      2782>>ASSIGN
OC_MESSBUF1.SZR
      2393**DCL      2785>>ASSIGN
OC_MESSBUF1.WSN
      2390**DCL      2391--REDEF    2786>>ASSIGN
OC_MESSBUF2
      2394**DCL      2592<<ASSIGN   2721<>CALL     2788>>ASSIGN
OC_MSGBUFFER
      2396**DCL      2411--REDEF
OC_MSGBUFFER.FLAGS
      2403**DCL      2404--REDEF
OC_MSGBUFFER.MESS
      2409**DCL      2409--REDEF
OC_MSGBUFFER.MSGID
      2399**DCL      2400--REDEF
OC_MSGBUFFER.WSN
      2406**DCL      2407--REDEF
OC_MSGBUFFER2.FLAGS
      2418**DCL      2419--REDEF
OC_MSGBUFFER2.MSGID
      2414**DCL      2415--REDEF
OC_MSGBUFFER2.WSN
      2421**DCL      2422--REDEF
OC_NOACT
      2475**DCL      2585>>IF
OC_PARAM
      2429**DCL      2429--REDEF
OC_QUEUE.PARMC
PL6.E3A0      #003=OCO$MESSAGE File=OCO$OUTPUT.:E05TSI                           WED 07/30/97 04:04 Page:141  
      2428**DCL      2428--REDEF
OC_REMAIN
      2425**DCL      2714>>IF
PEND$
        43**DCL      2637<<ASSIGN   2638>>DOWHILE  2639>>IF       2643<<ASSIGN   2643>>ASSIGN   2647<>CALL
PROMPT_TABLE.LAST_READ
      2470**DCL      2744<<ASSIGN   2748<<ASSIGN
PROMPT_TABLE.SIZER
      2471**DCL      2751<<ASSIGN
READ_FCN
        50**DCL      2727>>IF
RESTA.SYSID
       606**DCL      2739>>IF
SIZENT
       627**DCL      2762<<ASSIGN   2765>>IF       2772>>IF       2789>>ASSIGN   2798>>ASSIGN   2800>>ASSIGN
STA
       603**DCL       604--REDEF     609--REDEF    2509--DCLINIT  2591<<ASSIGN   2594>>IF       2732>>IF
      2780>>ASSIGN
STATION
        37**DCL        20--PROC     2591>>ASSIGN
TEMP
       623**DCL      2543<<ASSIGN   2545>>IF       2547<<ASSIGN   2547>>ASSIGN   2664<<ASSIGN   2666>>DOWHILE
      2668>>ASSIGN   2669>>ASSIGN   2670<<ASSIGN   2691>>ASSIGN   2692>>ASSIGN   2693>>ASSIGN   2694>>ASSIGN
TEMP$
        42**DCL      2669<<ASSIGN   2670>>ASSIGN   2698<<ASSIGN   2699>>CALLBLT  2705>>ASSIGN   2709>>ASSIGN
TEMP1
       624**DCL      2658<<ASSIGN   2660>>IF       2660>>IF       2664>>ASSIGN   2665>>ASSIGN   2674<<ASSIGN
      2674>>ASSIGN
WRITE_FCN
        49**DCL      2681>>IF
