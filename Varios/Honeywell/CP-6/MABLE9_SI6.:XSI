/*T***********************************************************/
/*T*                                                         */
/*T* Copyright (c) Bull HN Information Systems Inc., 1989    */
/*T*                                                         */
/*T***********************************************************/
MABLE9: PROC(NUM,SRC,SLEN,DST,DLEN) ALTRET;
/*
    MABLE9 builds 9-character block letters from a user CALL,
    one line at a time.  The user specifies the source string
    of ASCII characters and a destination area.  One blank is
    placed between each expanded letter, making the letters 10
    spaces wide.  The arguments are:
 
    NUM - Is the line number to build, range 0-8; UBIN WORD.
    SRC - Is the source string, a CHAR element.
    SLEN - Is the length of SRC in 9-bit characters, UBIN WORD.
    DST - Is the destination string, a CHAR element.
    DLEN - Is the returned length of DST, UBIN WORD.
 
    The user calls MABLE9 9 times, once per line of block letters.
    The returned string may be printed (by the user) or stowed for
    later printing.  MABLE9 isn't fussy what order the lines are
    called for in, so NUM may run from 0 to 8 or 8 to 0 or in any
    other pattern; changing the contents of the source string
    between MABLE9 calls is not recommended, unless you like scrap
    in the output area.
                                                                 */
    DCL NUM                            UBIN;
    DCL SLEN                           UBIN;
    DCL DLEN                           UBIN;
    DCL SRC                            CHAR(SLEN);
    DCL DST                            CHAR(DLEN);
    DCL NC                             UBIN(9) UNAL BASED;
    DCL AC                             CHAR(1) BASED;
    DCL B                              BIT(1) BASED;
    DCL IP                             PTR;
    DCL OP                             PTR;
    DCL TP                             PTR;
    DCL I                              UBIN;
    DCL J                              UBIN;
    DCL K                              UBIN;
/*
                           Letter Patterns
                                                              */
    DCL 1 VALUES UNAL CONSTANT,
        2 *(0:2) BIT(27) INIT('000000000'O,'000000000'O,'000000000'O), /*     */
        2 *(0:2) BIT(27) INIT('070070070'O,'070070070'O,'000070070'O), /*!*/
        2 *(0:2) BIT(27) INIT('306306306'O,'000000000'O,'000000000'O), /*"*/
        2 *(0:2) BIT(27) INIT('000050050'O,'376050376'O,'050050000'O), /*#*/
        2 *(0:2) BIT(27) INIT('050174252'O,'250174052'O,'252174050'O), /*$*/
        2 *(0:2) BIT(27) INIT('303447316'O,'034070160'O,'346711606'O), /*%*/
        2 *(0:2) BIT(27) INIT('160330330'O,'160161333'O,'616776363'O), /*&*/
        2 *(0:2) BIT(27) INIT('034070160'O,'000000000'O,'000000000'O), /*'*/
        2 *(0:2) BIT(27) INIT('030060140'O,'140140140'O,'140060030'O), /*(*/
        2 *(0:2) BIT(27) INIT('060030014'O,'014014014'O,'014030060'O), /*)*/
        2 *(0:2) BIT(27) INIT('000000124'O,'070376070'O,'124000000'O), /***/
        2 *(0:2) BIT(27) INIT('000000020'O,'020174020'O,'020000000'O), /*+*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000000000'O,'070160340'O), /*,*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000376000'O,'000000000'O), /*-*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000000000'O,'070070070'O), /*.*/
        2 *(0:2) BIT(27) INIT('003007016'O,'034070160'O,'340700600'O), /*/*/
        2 *(0:2) BIT(27) INIT('376777607'O,'613623643'O,'703777376'O), /*0*/
        2 *(0:2) BIT(27) INIT('070170370'O,'070070070'O,'070376376'O), /*1*/
        2 *(0:2) BIT(27) INIT('376777003'O,'003376600'O,'600777777'O), /*2*/
        2 *(0:2) BIT(27) INIT('376777003'O,'003076003'O,'003777376'O), /*3*/
        2 *(0:2) BIT(27) INIT('606606606'O,'606606777'O,'006006006'O), /*4*/
        2 *(0:2) BIT(27) INIT('777777600'O,'600776003'O,'003777376'O), /*5*/
        2 *(0:2) BIT(27) INIT('376777600'O,'600776603'O,'603777376'O), /*6*/
        2 *(0:2) BIT(27) INIT('777777003'O,'006014030'O,'030030030'O), /*7*/
        2 *(0:2) BIT(27) INIT('376777603'O,'603376603'O,'603777376'O), /*8*/
        2 *(0:2) BIT(27) INIT('376777603'O,'603377003'O,'003777376'O), /*9*/
        2 *(0:2) BIT(27) INIT('000070070'O,'070000070'O,'070070000'O), /*:*/
        2 *(0:2) BIT(27) INIT('000000070'O,'070070000'O,'070160340'O), /*;*/
        2 *(0:2) BIT(27) INIT('001007034'O,'160700160'O,'034007001'O), /*<*/
        2 *(0:2) BIT(27) INIT('000000000'O,'376000376'O,'000000000'O), /*=*/
        2 *(0:2) BIT(27) INIT('400700160'O,'034007034'O,'160700400'O), /*>*/
        2 *(0:2) BIT(27) INIT('376777003'O,'003036070'O,'000070070'O), /*?*/
        2 *(0:2) BIT(27) INIT('376777003'O,'003373773'O,'633777366'O), /*@*/
        2 *(0:2) BIT(27) INIT('174376603'O,'603777603'O,'603603603'O), /*A*/
        2 *(0:2) BIT(27) INIT('774776603'O,'606774606'O,'603776774'O), /*B*/
        2 *(0:2) BIT(27) INIT('174376603'O,'600600600'O,'603376174'O), /*C*/
        2 *(0:2) BIT(27) INIT('774776603'O,'603603603'O,'603776774'O), /*D*/
        2 *(0:2) BIT(27) INIT('777777600'O,'600760600'O,'600777777'O), /*E*/
        2 *(0:2) BIT(27) INIT('777777600'O,'600760600'O,'600600600'O), /*F*/
        2 *(0:2) BIT(27) INIT('174376603'O,'600637603'O,'603376174'O), /*G*/
        2 *(0:2) BIT(27) INIT('603603603'O,'603777603'O,'603603603'O), /*H*/
        2 *(0:2) BIT(27) INIT('376376070'O,'070070070'O,'070376376'O), /*I*/
        2 *(0:2) BIT(27) INIT('003003003'O,'003003603'O,'603376174'O), /*J*/
        2 *(0:2) BIT(27) INIT('603606614'O,'630760630'O,'614606603'O), /*K*/
        2 *(0:2) BIT(27) INIT('600600600'O,'600600600'O,'600777777'O), /*L*/
        2 *(0:2) BIT(27) INIT('603707757'O,'673623603'O,'603603603'O), /*M*/
        2 *(0:2) BIT(27) INIT('603703743'O,'663633617'O,'607603603'O), /*N*/
        2 *(0:2) BIT(27) INIT('174376603'O,'603603603'O,'603376174'O), /*O*/
        2 *(0:2) BIT(27) INIT('774776603'O,'603776774'O,'600600600'O), /*P*/
        2 *(0:2) BIT(27) INIT('174376603'O,'603623613'O,'607376175'O), /*Q*/
        2 *(0:2) BIT(27) INIT('774776603'O,'603776774'O,'606603603'O), /*R*/
        2 *(0:2) BIT(27) INIT('174376603'O,'300174006'O,'603376174'O), /*S*/
        2 *(0:2) BIT(27) INIT('777777070'O,'070070070'O,'070070070'O), /*T*/
        2 *(0:2) BIT(27) INIT('603603603'O,'603603603'O,'603376174'O), /*U*/
        2 *(0:2) BIT(27) INIT('603603603'O,'306306154'O,'154070020'O), /*V*/
        2 *(0:2) BIT(27) INIT('603603603'O,'603603623'O,'673757306'O), /*W*/
        2 *(0:2) BIT(27) INIT('603707356'O,'174070174'O,'356707603'O), /*X*/
        2 *(0:2) BIT(27) INIT('603603306'O,'154070070'O,'070070070'O), /*Y*/
        2 *(0:2) BIT(27) INIT('777777016'O,'034070160'O,'340777777'O), /*Z*/
        2 *(0:2) BIT(27) INIT('174174140'O,'140140140'O,'140174174'O), /*[*/
        2 *(0:2) BIT(27) INIT('600700340'O,'160070034'O,'016007003'O), /*\*/
        2 *(0:2) BIT(27) INIT('174174014'O,'014014014'O,'014174174'O), /*]*/
        2 *(0:2) BIT(27) INIT('020070154'O,'306000000'O,'000000000'O), /*^*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000000000'O,'000000777'O), /*_*/
        2 *(0:2) BIT(27) INIT('160070034'O,'000000000'O,'000000000'O), /*`*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000373607'O,'603607373'O), /*a*/
        2 *(0:2) BIT(27) INIT('000600600'O,'600676703'O,'603703676'O), /*b*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000376603'O,'600603376'O), /*c*/
        2 *(0:2) BIT(27) INIT('000003003'O,'003373607'O,'603607373'O), /*d*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000376603'O,'777600377'O), /*e*/
        2 *(0:2) BIT(27) INIT('000174306'O,'300760300'O,'300300300'O), /*f*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000373607'O,'373003776'O), /*g*/
        2 *(0:2) BIT(27) INIT('000600600'O,'600676703'O,'603603603'O), /*h*/
        2 *(0:2) BIT(27) INIT('000000030'O,'000070030'O,'030030074'O), /*i*/
        2 *(0:2) BIT(27) INIT('000000030'O,'000070030'O,'030630360'O), /*j*/
        2 *(0:2) BIT(27) INIT('000600600'O,'600606630'O,'740630606'O), /*k*/
        2 *(0:2) BIT(27) INIT('000070030'O,'030030030'O,'030030074'O), /*l*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000656723'O,'623623623'O), /*m*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000676703'O,'603603603'O), /*n*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000376603'O,'603603376'O), /*o*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000676703'O,'703676600'O), /*p*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000373607'O,'607373003'O), /*q*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000676703'O,'600600600'O), /*r*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000377600'O,'376003776'O), /*s*/
        2 *(0:2) BIT(27) INIT('000000140'O,'140770140'O,'140146074'O), /*t*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000603603'O,'603607373'O), /*u*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000603603'O,'306154070'O), /*v*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000603603'O,'623623356'O), /*w*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000306154'O,'070154306'O), /*x*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000603306'O,'154070360'O), /*y*/
        2 *(0:2) BIT(27) INIT('000000000'O,'000777016'O,'070340777'O), /*z*/
        2 *(0:2) BIT(27) INIT('034060060'O,'060140060'O,'060060034'O), /*{*/
        2 *(0:2) BIT(27) INIT('070070070'O,'070000070'O,'070070070'O), /*|*/
        2 *(0:2) BIT(27) INIT('160030030'O,'030014030'O,'030030160'O), /*}*/
        2 *(0:2) BIT(27) INIT('000000000'O,'340623016'O,'000000000'O), /*~*/
        2 *(0:2) BIT(27) INIT('777777777'O,'777777777'O,'777777777'O); /*     */
    DCL TABLE REDEF VALUES             CHAR(864);
    DLEN=10*SLEN;
    DST=' ';
    IF NUM>8 THEN
        ALTRETURN;
    IP=ADDR(SRC);
    OP=ADDR(DST);
    DO I=1 TO SLEN;
        K=MOD(IP->NC,128);
        IF K<32 THEN
            K=32;
        TP=ADDR(SUBSTR(TABLE,9*(K-32)+NUM,1));
        DO J=0 TO 8;
            IF TP->B='1'B THEN
                OP->AC=IP->AC;
            TP=PINCRB(TP,1);
            OP=PINCRC(OP,1);
        END;
        OP=PINCRC(OP,1);
        IP=PINCRC(IP,1);
    END;
    RETURN;
END;
