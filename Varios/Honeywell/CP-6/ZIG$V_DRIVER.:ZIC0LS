
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:1    
        1        1        /*M* ZIG$V_DRIVER     I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*
        8        8        ZZZZZ  III   GGG    $   V   V       DDDD  RRRR   III  V   V EEEEE RRRR
        9        9            Z   I   G   G  $$$  V   V       D   D R   R   I   V   V E     R   R
       10       10           Z    I   G     $ $   V   V       D   D R   R   I   V   V E     R   R
       11       11          Z     I   G      $$$  V   V       D   D RRRR    I   V   V EEEE  RRRR
       12       12         Z      I   G  GG   $ $ V   V       D   D R R     I   V   V E     R R
       13       13        Z       I   G   G  $$$   V V        D   D R  R    I    V V  E     R  R
       14       14        ZZZZZ  III   GGG    $     V         DDDD  R   R  III    V   EEEEE R   R
       15       15                                      _____
       16       16        */
       17       17        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:2    
       18       18        ZIG$V_DRIVER:
       19       19            PROC;
       20       20    1   DCL SCHEMA_NAME CHAR (30) EXT;
       21       21    1   DCL SUBSCHEMA_NAME CHAR (30) EXT;
       22       22    1   DCL NO_ERRORS BIT (1) EXT;
       23       23    1   DCL NUM_PROHIB UBIN WORD EXT;
       24       24    1   DCL NEED_TYPE_36_DESC BIT (1) STATIC;
       25       25    1   DCL LAST_AC UBIN (18) EXT;
       26       26    1   DCL LAST_SC UBIN (18) EXT;
       27       27    1   DCL LAST_RC UBIN (18) EXT;
       28       28    1   DCL LAST_FR UBIN (18) EXT;
       29       29    1   DCL EOFC CHAR (128) EXT INIT('/*/*/*/*/*/*');
       30       30    1   DCL RECORD_NUM UBIN (36) EXT;
       31       31    1   DCL CF_PTR$ PTR EXT;
       32       32    1   DCL HEAD_AREA_XREF CHAR (64) CONSTANT INIT ('SUBSCHEMA AREA NAMES.');
       33       33    1   DCL FIRST_AREA BIT (1);
       34       34    1   DCL HEAD_SET_XREF CHAR (64) CONSTANT INIT ('SUBSCHEMA SET NAMES.');
       35       35    1   DCL FIRST_SET BIT (1);
       36       36    1   DCL HEAD_DATA_PAR CHAR (64) CONSTANT INIT ('DATA BASE PARAMETER NAMES.');
       37       37    1   DCL FIRST_DATA_PAR BIT (1);
       38       38    1   DCL HEAD_RECORD_XREF CHAR (64) CONSTANT INIT (
       39       39    1    'RECORD CROSS-REFERENCE WITH UWA ALLOCATION (WORD, BYTE, NIBBLE)');
       40       40    1   DCL FIRST_RECORD BIT (1);
       41       41    1   DCL IN_GROUP BIT (1) EXT;
       42       42    1   DCL LAST_GROUP_LEVEL UBIN (36) EXT;
       43       43    1   DCL RECORD_FOUND BIT (1) EXT;
       44       44    1   DCL TEMP_WORD CHAR (30) STATIC;
       45       45    1   DCL LIST_STRING CHAR (128) EXT;
       46       46    1   DCL NO_MEMBERS_IN_SUBSCHEMA BIT (1);
       47       47    1   DCL ZIG$V_OA ENTRY;
       48       48    1   DCL ZIG$V_AREA ENTRY;
       49       49    1   DCL ZIG$V_SET ENTRY;
       50       50    1   DCL ZIG$V_RECORD ENTRY;
       51       51    1   DCL ZIG$V_AREA_REC ENTRY;
       52       52    1   DCL ZIG$V_FIELD ENTRY;
       53       53    1   DCL ZIG$V_DESC ENTRY;
       54       54    1   DCL ZIG$V_PROHIB ENTRY;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:3    
       55       55    1   DCL ZIG$V_PERMIT ENTRY;
       56       56    1   DCL ZIG$INIT_AS ENTRY;
       57       57    1   DCL ZIG$FIN_AS ENTRY;
       58       58    1   DCL ZIG$ZERO_ALT_TABLE ENTRY;
       59       59    1   DCL FLAG_OWNER ENTRY (1);
       60       60    1   DCL ZIG$HASH_IT ENTRY (8);
       61       61    1   DCL READSF ENTRY (2);
       62       62    1   DCL ERROR_READ64 UBIN (36) EXT;
       63       63    1   DCL WRITSF ENTRY (2);
       64       64    1   DCL WRIT64 ENTRY (2);
       65       65    1   DCL 1 FIELD1 EXT,
       66       66    1         2 COUNT1 UBIN (9) UNAL,
       67       67    1         2 TEXT1 CHAR (31) UNAL;
       68       68    1   DCL LAST_RECORD_REF_LINE UBIN (36) EXT;
       69       69        %EQU DS4 = 3;
       70       70    1   DCL TEMP_PTR$ PTR;
       71       71    1   DCL BASE_PTR(0:6) PTR EXT;
       72       72    1   DCL MEMORY_USED_SSS UBIN WORD EXT;
       73       73    1   DCL LARGEST_KEY UBIN (36) EXT;
       74       74    1   DCL SAVE_BUF CHAR (128) STATIC;
       75       75    1   DCL UNITS_PER_WORD(0:27) CONSTANT UBIN(36) INIT(
       76       76    1    4,4,4,8,8,8,4,4,4,4,
       77       77    1    4,4,4,4,6,4,8,4,6,36,
       78       78    1    4,4,6,6,4,4,4,4);
       79       79    1   DCL NUMERIC(0:27) CONSTANT BIT(1) INIT(
       80       80    1    '0'B*3,
       81       81    1    '1'B*8,
       82       82    1    '0'B*11,
       83       83    1    '1'B*4,
       84       84    1    '0'B*2);
       85       85    1   DCL SYNONYM_CTYPE(0:27) CONSTANT UBIN (36) INIT(
       86       86    1    0,1,2,3,4,5,6,7,8,9,
       87       87    1    10,11,12,17*15);
       88       88    1   DCL SYNONYM_FTYPE(0:27) CONSTANT UBIN (36) INIT(
       89       89    1    0,17,2,17*17,20,21,17*4,26,27);
       90       90    1   DCL SYNONYM_APL_TYPE(0:18) CONSTANT UBIN (36) INIT(
       91       91    1    17*3,14*2,17*6,14*2,17*4,14*2);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:4    
       92       92    1   DCL SYNONYM_BASIC_TYPE(0:18) CONSTANT UBIN (36) INIT(
       93       93    1    17*3,14*2,17*6,18,14,17*4,14*2);
       94       94    1   DCL SYNONYM_FORTRAN_TYPE(0:18) CONSTANT UBIN (36) INIT(
       95       95    1    17*3,13*2,17*6,13,14,17*4,13,14);
       96       96    1   DCL CUR_EXT_NAME_SEG UBIN (36) EXT;
       97       97    1   DCL AREA_REC_REL BIT (1) STATIC;
       98       98    1   DCL I UBIN (36) STATIC;
       99       99    1   DCL J UBIN (36) STATIC;
      100      100    1   DCL FR_DBK UBIN (36) STATIC;
      101      101    1   DCL STATUS UBIN (6) STATIC;
      102      102    1   DCL T5PTR$ PTR STATIC;
      103      103    1   DCL T6PTR$ PTR STATIC;
      104      104    1   DCL TPTR$ PTR STATIC;
      105      105    1   DCL T4PTR$ PTR STATIC;
      106      106    1   DCL ERROR_FLG UBIN (36) STATIC;
      107      107    1   DCL T2PTR$ PTR STATIC;
      108      108    1   DCL T1PTR$ PTR STATIC;
      109      109    1   DCL ALT_HASH_TABLE (0:808) PTR EXT;
      110      110    1   DCL BITS_52 BIT (52) BASED ALIGNED;
      111      111    1   DCL PV(0:13) CONSTANT ALIGNED BIT(52) INIT(
      112      112    1    '0100001001000000000100000001'B,
      113      113    1    '0100001001000000010000000100000001'B,
      114      114    1    '0100001001000000010000000100000001'B,
      115      115    1    '0100001001000000010000000000000000001'B,
      116      116    1    '0100001001000000010000000100000000001000000000000011'B,
      117      117    1    '0100001001000000010000000100000100000000000000000011'B,
      118      118    1    '01000010010000000100000000010000'B,
      119      119    1    '0100001001000000010000000101000000000000000000000100'B,
      120      120    1    '0100001001000000010000000101000000000000000000000011'B,
      121      121    1    '0100001001000000010000000101000000000000000000000010'B,
      122      122    1    '0100001001000000010000000101000000000000000000000001'B,
      123      123    1    '010000100100000001000000010001'B,
      124      124    1    '0100001001000000010000000100001'B,
      125      125    1    '0100001001000000000100000001'B);
      126      126    1   DCL SSCALE SBIN (6) STATIC;
      127      127    1   DCL FACTER(0:27) CONSTANT UBIN (36) INIT(
      128      128    1    2*3,1*3,2*22);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:5    
      129      129    1   DCL TN_S(0:27) CONSTANT BIT (3) UNAL INIT(
      130      130    1    '000'B*3,'111'B,'110'B*2,'011'B,'001'B,'010'B,'011'B*2,'000'B*17);
      131      131    1   DCL LAST_SC_SAVE UBIN (36) STATIC;
      132      132    1   DCL BASED_PTR$ PTR BASED;
      133      133    1   DCL WORD36 UBIN (36) BASED ALIGNED;
      134      134    1   DCL DBK UBIN (36) STATIC;
      135      135    1   DCL LAST_FILLER UBIN(36) STATIC;
      136      136    1   DCL LAST_SS UBIN (36) STATIC;
      137      137    1   DCL LAST_SMSO_SAVE UBIN (36) STATIC;
      138      138    1   DCL FOUND BIT (1) STATIC;
      139      139    1   DCL SET_ORDER(0:7) CHAR (28) CONSTANT INIT (
      140      140    1    'FIRST',
      141      141    1    'LAST',
      142      142    1    'NEXT',
      143      143    1    'PRIOR',
      144      144    1    'SORTED BY DEFINED KEYS',
      145      145    1    'BY RECORD-NAME',
      146      146    1    'SORTED WITHIN RECORD-NAME',
      147      147    1    'BY DATA-BASE-KEY');
      148      148    1   DCL DUP_TEXT(0:2) CHAR (12) CONSTANT INIT (
      149      149    1    'FIRST',
      150      150    1    'LAST',
      151      151    1    'NOT ALLOWED');
      152      152    1   DCL MODE_OF_SET(0:2) CHAR (13) CONSTANT INIT(
      153      153    1    'CHAIN',
      154      154    1    'RECORD ARRAY',
      155      155    1    'POINTER ARRAY');
      156      156    1   DCL MAN_OPT(0:3) CHAR (52) CONSTANT INIT (
      157      157    1    '               MANDATORY AUTOMATIC LINKED TO OWNER',
      158      158    1    '               MANDATORY MANUAL LINKED TO OWNER',
      159      159    1    '               OPTIONAL AUTOMATIC LINKED TO OWNER',
      160      160    1    '               OPTIONAL MANUAL LINKED TO OWNER');
      161      161    1   DCL T7PTR$ PTR STATIC;
      162      162    1   DCL T8PTR$ PTR STATIC;
      163      163    1   DCL T9PTR$ PTR STATIC;
      164      164    1   DCL K UBIN (36) STATIC;
      165      165    1   DCL FIELD_NAME CHAR (30) STATIC;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:6    
      166      166    1   DCL FIRST_FIELD BIT (1) EXT;
      167      167    1   DCL FIRST_SO BIT (1);
      168      168    1   DCL FIRST_SM BIT (1);
      169      169    1   DCL FIRST_KEY BIT (1);
      170      170    1   DCL HEADING_SET CHAR (25) STATIC;
      171      171    1   DCL DESCPTR PTR STATIC INIT (ADDR(BUFFER1));
      172      172    1   DCL BUFFER1 CHAR (128) STATIC;
      173      173    1   DCL BUFFER_TEMP CHAR (128) BASED (DESCPTR);
      174      174    1   DCL EOF UBIN (36) STATIC;
      175      175    1   DCL BUFFER_SIZE UBIN (36) STATIC;
      176      176    1   DCL SUBSCHEMA_NAME_4 CHAR(4) EXT;
      177      177    1   DCL RVA_NAME CHAR(8) STATIC;
      178      178    1   DCL SAVE_LAST_UWA UBIN (36) STATIC;
      179      179    1   DCL SAVE_LAST_RVA UBIN (36) STATIC;
      180      180    1   DCL SAVED_FR_NAMES BIT (1) STATIC;
      181      181    1   DCL DATA_TYPE_NAME(0:18) CHAR (20) CONSTANT INIT (
      182      182    1   'CHARACTER', /* 0 */
      183      183    1   'DBKEY', /* 1 */
      184      184    1   'INTEGER', /* 2 */
      185      185    1   'COMP-4', /* 3 */
      186      186    1   'COMP-4 SIGNED', /* 4 */
      187      187    1   'COMP-3 SIGNED', /* 5 */
      188      188    1   'DISPLAY NUMERIC', /* 6 */
      189      189    1   'DISPLAY NUMERIC', /* 7 */
      190      190    1   'DISPLAY NUMERIC', /* 8 */
      191      191    1   'DISPLAY NUMERIC', /* 9 */
      192      192    1   'DISPLAY NUMERIC', /*10 */
      193      193    1   'COMP-1', /*11 */
      194      194    1   'COMP-2', /*12 */
      195      195    1   'REAL', /*13 */
      196      196    1   'DOUBLE PRECISION',/*14 */
      197      197    1   'COMPLEX', /*15 */
      198      198    1   'DOUBLE COMPLEX', /*16 */
      199      199    1   'LOGICAL', /*17 */
      200      200    1    'SINGLE PRECISION' /*18 */);
      201      201    1   DCL PL6_SCREW_UP CHAR (6) CONSTANT INIT ('000000');
      202      202    1   DCL WORD_OFFSET CHAR (6) STATIC;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:7    
      203      203    1   DCL NIBLE_OFF CHAR (1) STATIC;
      204      204    1   DCL NUM_OFF CHAR (12) STATIC;
      205      205        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:8    
      206      206        %INCLUDE ZIG_DIR_STRUCS;
      207      336        %INCLUDE ZI_ERRORS_SUBS;
      208      856        %INCLUDE ZIG_GENERAL;
      209      964        %INCLUDE ZIG_DBA_INT;
      210     1012        %INCLUDE ZI_SUB4_CAN;
      211     1669        %RVA;
      212     1946        %UWA;
      213     2281        %INCLUDE ZI_SUB_LANG;
      214     3996        %DESC_TYPE_9(NAME_MAIN=TYPE_9);
      215     4173        %GENERAL;
      216     4297    1   DCL IO_BUF CHAR (128) EXT;
      217     4298        %TEXT_LINE(STCLASS="REDEF IO_BUF");
      218     4335        %DESC_TYPE_9(STCLASS="REDEF IO_BUF");
      219     4512        %DESC_TYPE_100(STCLASS="REDEF IO_BUF");
      220     4552        %DESC_TYPE_110(STCLASS="REDEF IO_BUF");
      221     4616        %DESC_TYPE_200(STCLASS="REDEF IO_BUF");
      222     4669        %DESC_TYPE_210(STCLASS="REDEF IO_BUF");
      223     4724        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
      224     4793        %DESC_TYPE_350(STCLASS="REDEF IO_BUF");
      225     4831        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
      226     4890        %DESC_TYPE_410(STCLASS="REDEF IO_BUF");
      227     4946        %DESC_TYPE_420(STCLASS="REDEF IO_BUF");
      228     4979        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
      229     5138        %CONTROL_BLOCK;
      230     5246        %DESC_TYPE_36;
      231     5285        %DESC_TYPE_37;
      232     5325        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:9    
      233     5326        /*
      234     5327              Now comes the sturctures for the schema subset.
      235     5328        */
      236     5329        %INCLUDE ZIG_SSS;
      237     5899        %SS_GENERAL(PSTCLASS=EXT);
      238     5920        %AC(PSTCLASS=EXT);
      239     6015        %AC1(PSTCLASS=EXT);
      240     6023        %FR(PSTCLASS=EXT);
      241     6069        %FR1(PSTCLASS=EXT);
      242     6077        %SC(PSTCLASS=EXT);
      243     6104        %SC1(PSTCLASS=EXT);
      244     6114        %RC(PSTCLASS=EXT);
      245     6147        %RC1(PSTCLASS=EXT);
      246     6157        %OA(PSTCLASS=EXT);
      247     6224        %OA1(PSTCLASS=EXT);
      248     6232        %RA(PSTCLASS=EXT);
      249     6252        %RS(PSTCLASS=EXT);
      250     6326        %SM1(PSTCLASS=EXT);
      251     6334        %SS(PSTCLASS=EXT);
      252     6348        %CD(PSTCLASS=EXT);
      253     6367        %DP(PSTCLASS=EXT);
      254     6381        %DP1(PSTCLASS=EXT);
      255     6389        %AG(PSTCLASS=EXT);
      256     6419        %AG1(PSTCLASS=EXT);
      257     6427        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:10   
      258     6428        /*
      259     6429        ZZZZZ  III   GGG    $   V   V        CCC  H   H EEEEE  CCC  K   K       FFFFF
      260     6430            Z   I   G   G  $$$  V   V       C   C H   H E     C   C K  K        F
      261     6431           Z    I   G     $ $   V   V       C     H   H E     C     K K         F
      262     6432          Z     I   G      $$$  V   V       C     HHHHH EEEE  C     KK          FFFF
      263     6433         Z      I   G  GG   $ $ V   V       C     H   H E     C     K K         F
      264     6434        Z       I   G   G  $$$   V V        C   C H   H E     C   C K  K        F
      265     6435        ZZZZZ  III   GGG    $     V          CCC  H   H EEEEE  CCC  K   K       F
      266     6436                                      _____                               _____
      267     6437        */
      268     6438    1   ZIG$V_CHECK_F:
      269     6439    1       PROC;
      270     6440    2   DCL I SBIN WORD;
      271     6441    2       SAVE_BUF = IO_BUF;
      272     6442    2       IF RC.RCRAN = 0
      273     6443    3       THEN DO;
      274     6444    3           CALL FCURR_R_6('RC  ') ALTRET(DBCS_ERR);
      275     6445    3           AREA_REC_REL = '0'B;
      276     6446    4           DO WHILE ('1'B);
      277     6447    4               CALL FETCHNS_6('RC-RA   ') ALTRET(DONE_RC_RA);
      278     6448    4               CALL FETCHOS_6('AC-RA   ') ALTRET(DBCS_ERR);
      279     6449    4               CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERR);
      280     6450    4               TYPE_420.SOUR_LINE = 0;
      281     6451    4               TYPE_420.AREA_NAME = UWA.SN.SENAME;
      282     6452    4               TYPE_420.SUB_AREA_NAME = UWA.SN.SENAME;
      283     6453    4               CALL ZIG$V_AREA_REC;
      284     6454    4               IF RECORD_FOUND AND ~ AREA_REC_REL
      285     6455    4               THEN AREA_REC_REL = '1'B;
      286     6456    4               END;
      287     6457    3   DONE_RC_RA:
      288     6458    3           IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;
      289     6459    3           IF ~AREA_REC_REL
      290     6460    4           THEN DO;
      291     6461    4               I = RC.DEF.RNL;
      292     6462    4               CALL SET_FIELDS(1,I,RC.RNAM);
      293     6463    4               IF (SUBSTR(RC.RNAM,0,1) ~= '*') AND (RC.DEF.SR = '0'B)
      294     6464    4               THEN CALL WARNING(%ZIG_REC_NOT_IN_AREA);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:11   
      295     6465    4               RC.DEF.RSTO = '1'B;
      296     6466    4               RC.DEF.RERS = '1'B;
      297     6467    4               RC.DEF.RERA = '1'B;
      298     6468        /*E*     ERROR:    ZIG-ZIG_REC_NOT_IN_AREA-C
      299     6469        MESSAGE: The record "%U1" is not in any area in the subschema.
      300     6470                 Therefore, the record cannot be used in any DML calls.
      301     6471        */
      302     6472    4               END;
      303     6473    3           END;
      304     6474    2       SAVED_FR_NAMES = VALIDS.FR_NAMES;
      305     6475    2       VALIDS.FR_NAMES = '1'B;
      306     6476        /*W*
      307     6477              All field names that are add to the subschema and not
      308     6478            pressent in the subschema must have a name with it or
      309     6479            I can't get the name from any where in some of the displaying
      310     6480            of the subschema.
      311     6481        */
      312     6482    3       DO I = 0 TO 808;
      313     6483    3           TPTR$ = ALT_HASH_TABLE(I);
      314     6484    4           DO WHILE(TPTR$ ~= ADDR(NIL));
      315     6485    4               IF TPTR$ -> FIELD_HASH.REF = 0
      316     6486    5               THEN DO;
      317     6487    5                   CALL FETCHD_6('FR  ',TPTR$ -> FIELD_HASH.DBK);
      318     6488    5                   TYPE_430.FIELD_NAME = TPTR$ -> FIELD_HASH.C_NAME;
      319     6489    5                   TYPE_430.SUB_FIELD_NAME = TYPE_430.FIELD_NAME;
      320     6490    5                   CALL CHANGE_TO_STR(TYPE_430.SUB_FIELD_NAME);
      321     6491    5                   TYPE_430.REF_LINE = 0;
      322     6492    5                   TYPE_430.OFFSET = 0;
      323     6493    5                   TYPE_430.ELEMENTARY = '1'B;
      324     6494    5                   CALL DEFAULT_DATA_TYPE;
      325     6495    5                   CALL ZIG$V_FIELD;
      326     6496    5                   FR.DEF.FSR = '1'B;
      327     6497    5                   IF FR.CDSN ~= 0 AND FR.CDRN ~= 0
      328     6498    6                   THEN DO;
      329     6499        /*
      330     6500              Control field not in record so can not be modifyed or
      331     6501            stored.
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:12   
      332     6502        */
      333     6503    6                       RC.DEF.RSTO = '1'B;
      334     6504    6                       END;
      335     6505    5                   END;
      336     6506    4               TPTR$ = TPTR$ -> FIELD_HASH.PTR$;
      337     6507    4               END;
      338     6508    3           END;
      339     6509    2       VALIDS.FR_NAMES = SAVED_FR_NAMES;
      340     6510    2       IF LAST_RECORD_REF_LINE ~= 0
      341     6511    3       THEN DO;
      342     6512    3           CALL READSF(LAST_RECORD_REF_LINE,IO_BUF);
      343     6513    3           TYPE_400.INFO = RC.DEF;
      344     6514    3           IF RC.DEF.PSTO = 1
      345     6515    4           THEN DO;
      346     6516    4               TPTR$ = PINCRW(SSS$,RC.RCRSN);
      347     6517    4               T1PTR$ = PINCRW(SSS$,TPTR$ -> RS.SCRSH);
      348     6518    5               DO WHILE (T1PTR$ -> SC.SNAM ~= '*CALC' AND TPTR$ ~= SSS$);
      349     6519    5                   TPTR$ = PINCRW(SSS$,TPTR$ -> RS.RCRSN);
      350     6520    5                   T1PTR$ = PINCRW(SSS$,TPTR$ -> RS.SCRSH);
      351     6521    5                   END;
      352     6522    4               IF T1PTR$ -> SC.SNAM ~= '*CALC'
      353     6523    4               THEN CALL ABORT;
      354     6524    4               I = 0;
      355     6525    4               T1PTR$ = PINCRW(SSS$,TPTR$ -> RS.RSCDN);
      356     6526    5               DO WHILE (T1PTR$ ~= SSS$);
      357     6527    5                   I = I + 1;
      358     6528    5                   T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RSCDN);
      359     6529    5                   END;
      360     6530    4               TYPE_400.PRIMARY_FIELD_NUM = I;
      361     6531    4               END;
      362     6532    4           ELSE DO;
      363     6533    4               TYPE_400.PRIMARY_FIELD_NUM = 0;
      364     6534    4               END;
      365     6535    3           CALL WRITSF(LAST_RECORD_REF_LINE,IO_BUF);
      366     6536    3           END;
      367     6537        /*
      368     6538              Check all the fields that should be in this schema subset
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:13   
      369     6539            to see if they all have be put in or not.
      370     6540            If any not in then add them to the record and set the bit
      371     6541            that says that field not in subschema.
      372     6542            If any of the fields that are added are a control field
      373     6543            mark the set to say that the record can not be inserted.
      374     6544        */
      375     6545    2       IF VALIDS.RECORD_XREF AND SUBSTR(RC.RNAM,0,1) ~= '*'
      376     6546    2          AND ~RC.DEF.SR
      377     6547    3       THEN DO;
      378     6548    3           T1PTR$ = PINCRW(SSS$,RC.RCRSN);
      379     6549    3           FIRST_SO = '1'B;
      380     6550    3           FIRST_SM = '1'B;
      381     6551    3           FIRST_KEY = '1'B;
      382     6552    4           DO WHILE (T1PTR$ ~= SSS$);
      383     6553    4               TPTR$ = PINCRW(SSS$, T1PTR$ -> RS.SCRSH);
      384     6554    4               IF TPTR$ -> SC.DEF.SETT = SECONDARY_KEY
      385     6555    5               THEN DO;
      386     6556    5                   IF FIRST_KEY
      387     6557    6                   THEN DO;
      388     6558    6                       HEADING_SET = '    ALTERNATE KEYS: ';
      389     6559    6                       FIRST_KEY = '0'B;
      390     6560    6                       END;
      391     6561    6                   ELSE DO;
      392     6562    6                       HEADING_SET = ' ';
      393     6563    6                       END;
      394     6564    5                   CALL CONCAT(LIST_STRING,HEADING_SET,TPTR$ -> SC.SNAM);
      395     6565    5                   CALL LIST(LIST_STRING);
      396     6566    5                   END;
      397     6567    4               T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RCRSN);
      398     6568    4               END;
      399     6569    3           T1PTR$ = PINCRW(SSS$,RC.RCRSN);
      400     6570    4           DO WHILE (T1PTR$ ~= SSS$);
      401     6571    4               TPTR$ = PINCRW(SSS$, T1PTR$ -> RS.SCRSH);
      402     6572    4               IF T1PTR$ -> RS.DEF.TYPE = '000001000000'B /* SO */
      403     6573    4                  AND TPTR$ -> SC.DEF.SETT = 0 /* USER-DEFINED SET */
      404     6574    5               THEN DO;
      405     6575    5                   IF FIRST_SO
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:14   
      406     6576    6                   THEN DO;
      407     6577    6                       HEADING_SET = '    OWNER OF SET: ';
      408     6578    6                       FIRST_SO = '0'B;
      409     6579    6                       END;
      410     6580    6                   ELSE DO;
      411     6581    6                       HEADING_SET = ' ';
      412     6582    6                       END;
      413     6583    5                   CALL CONCAT(LIST_STRING,HEADING_SET,TPTR$ -> SC.SNAM);
      414     6584    5                   CALL LIST(LIST_STRING);
      415     6585    5                   END;
      416     6586    4               T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RCRSN);
      417     6587    4               END;
      418     6588    3           T1PTR$ = PINCRW(SSS$,RC.RCRSN);
      419     6589    4           DO WHILE (T1PTR$ ~= SSS$);
      420     6590    4               TPTR$ = PINCRW(SSS$, T1PTR$ -> RS.SCRSH);
      421     6591    4               IF T1PTR$ -> RS.DEF.TYPE = '000000100000'B /* SM */
      422     6592    4                  AND SUBSTR(TPTR$ -> SC.SNAM,0,1) ~= '*'
      423     6593    4                  AND TPTR$ -> SC.DEF.SETT = 0 /* USER-DEFINED SET */
      424     6594    5               THEN DO;
      425     6595    5                   IF FIRST_SM
      426     6596    6                   THEN DO;
      427     6597    6                       HEADING_SET = '    MEMBER OF SET: ';
      428     6598    6                       FIRST_SM = '0'B;
      429     6599    6                       END;
      430     6600    6                   ELSE DO;
      431     6601    6                       HEADING_SET = ' ';
      432     6602    6                       END;
      433     6603    5                   CALL CONCAT(LIST_STRING,HEADING_SET,TPTR$ -> SC.SNAM);
      434     6604    5                   CALL LIST(LIST_STRING);
      435     6605    5                   END;
      436     6606    4               T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RCRSN);
      437     6607    4               END;
      438     6608    3           FIRST_AREA = '1'B;
      439     6609    3           T1PTR$ = PINCRW(SSS$,RC.RCRAN);
      440     6610    4           DO WHILE (T1PTR$ ~= SSS$);
      441     6611    4               T9PTR$ = PINCRW(SSS$,T1PTR$ -> RA.ACRAH);
      442     6612    4               IF FIRST_AREA
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:15   
      443     6613    5               THEN DO;
      444     6614    5                   HEADING_SET = '    LOCATED IN AREA: ';
      445     6615    5                   FIRST_AREA = '0'B;
      446     6616    5                   END;
      447     6617    5               ELSE DO;
      448     6618    5                   HEADING_SET = ' ';
      449     6619    5                   END;
      450     6620    4               CALL CONCAT(LIST_STRING,HEADING_SET,T9PTR$ -> AC.ANAM);
      451     6621    4               CALL LIST(LIST_STRING);
      452     6622    4               T1PTR$ = PINCRW(SSS$, T1PTR$ -> RA.RCRAN);
      453     6623    4               END;
      454     6624    3           END;
      455     6625    2       IO_BUF = SAVE_BUF;
      456     6626    2       RETURN;
      457     6627    2   DBCS_ERR:
      458     6628    2       CALL ABORT;
      459     6629    2   END ZIG$V_CHECK_F;
      460     6630        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:16   
      461     6631        /*
      462     6632         AAA  DDDD  DDDD         SSS  PPPP  EEEEE  CCC   AAA  L
      463     6633        A   A D   D D   D       S   S P   P E     C   C A   A L
      464     6634        A   A D   D D   D       S     P   P E     C     A   A L
      465     6635        AAAAA D   D D   D        SSS  PPPP  EEEE  C     AAAAA L
      466     6636        A   A D   D D   D           S P     E     C     A   A L
      467     6637        A   A D   D D   D       S   S P     E     C   C A   A L
      468     6638        A   A DDDD  DDDD         SSS  P     EEEEE  CCC  A   A LLLLL
      469     6639                          _____
      470     6640
      471     6641
      472     6642              RRRR  EEEEE  CCC
      473     6643              R   R E     C   C
      474     6644              R   R E     C
      475     6645              RRRR  EEEE  C
      476     6646              R R   E     C
      477     6647              R  R  E     C   C
      478     6648              R   R EEEEE  CCC
      479     6649        _____
      480     6650        */
      481     6651    1   ADD_SPECIAL_REC:
      482     6652    1       PROC;
      483     6653
      484     6654    2   DCL LEN_UBIN UBIN(36);
      485     6655
      486     6656    2       SAVE_BUF = IO_BUF;
      487     6657    2       SAVED_FR_NAMES = VALIDS.FR_NAMES;
      488     6658    2       VALIDS.FR_NAMES = '1'B;
      489     6659    2       TYPE_400.RECORD_NAME = '*CALC.RC';
      490     6660    2       TYPE_400.SUB_RECORD_NAME = '*CALC.RC';
      491     6661    2       TYPE_400.REF_LINE = 0;
      492     6662    2       TYPE_400.ID_NUM = 0;
      493     6663    2       CALL ZIG$V_RECORD;
      494     6664    2       IF RECORD_FOUND
      495     6665    3       THEN DO;
      496     6666    3           OA.CLCRC = POFFW(RC$,SSS$);
      497     6667    3           RC.DEF.SR = '1'B; /* Record not in subschema */
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:17   
      498     6668    3           END;
      499     6669    3       ELSE DO;
      500     6670    3           OA.CLCRC = 0;
      501     6671    3           END;
      502     6672    3       DO WHILE (RECORD_FOUND);
      503     6673    3           CALL FETCHNS_6('RC-FR   ') ALTRET(DONE_FR_CALC);
      504     6674    3           FR_DBK = UWA.DIRECT_REF;
      505     6675    3           CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);
      506     6676    3           UWA.DIRECT_REF = FR_DBK;
      507     6677    3           TYPE_430.FIELD_NAME = UWA.SN.SENAME;
      508     6678    3           TYPE_430.SUB_FIELD_NAME = UWA.SN.SENAME;
      509     6679    3           CALL CHANGE_TO_STR(TYPE_430.SUB_FIELD_NAME);
      510     6680    3           TYPE_430.TYPE = 430;
      511     6681    3           TYPE_430.OFFSET = 0;
      512     6682    3           TYPE_430.REF_LINE = 0;
      513     6683    3           TYPE_430.ELEMENTARY = '1'B;
      514     6684    3           CALL ZIG$V_FIELD;
      515     6685    3           FR.DEF.FSR = '1'B;
      516     6686    3           END;
      517     6687    2   DONE_FR_CALC:
      518     6688    2       IF UWA.DB_STATUS ~= '0502100' AND RECORD_FOUND THEN CALL ABORT;
      519     6689    2       TYPE_400.RECORD_NAME = '*DBPARAM';
      520     6690    2       TYPE_400.SUB_RECORD_NAME = '*DBPARAM';
      521     6691    2       TYPE_400.REF_LINE = 0;
      522     6692    2       TYPE_400.ID_NUM = 0;
      523     6693    2       IF MOD(OA.UWSZ,8) ~= 0
      524     6694    2       THEN OA.UWSZ = OA.UWSZ + 8 - MOD(OA.UWSZ,8);
      525     6695    2       CALL ZIG$V_RECORD;
      526     6696    2       RC.DEF.SR = '1'B; /* Record not in subschema */
      527     6697    2       IF RECORD_FOUND AND VALIDS.PARAM_XREF
      528     6698    3       THEN DO;
      529     6699    3           CALL SUBLST(HEAD_DATA_PAR);
      530     6700    3           END;
      531     6701    2       LAST_FILLER = CONTROL.LAST_FILLER_NUM;
      532     6702    2       IF RECORD_FOUND AND SUB_LANGUAGE = #FORTRAN AND CONTROL.LAST_FILLER_LEN ~= 0
      533     6703    3       THEN DO;
      534     6704    3           CALL SET_FIELD_NUM(1,LAST_FILLER);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:18   
      535     6705    3           CALL CONCAT(TEMP_WORD,'FILL',SUBSTR(FIELD1.TEXT1,0,4));
      536     6706    3           LAST_FILLER = LAST_FILLER + 1;
      537     6707    3           CALL CONCAT(LIST_STRING,'     +               ',
      538     6708    3              SUBSTR(TEMP_WORD,0,8),',');
      539     6709    3           CALL WRITE_UWA;
      540     6710    3           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;
      541     6711    3           UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;
      542     6712    3           CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(0),
      543     6713    3              SUBSTR(TEMP_WORD,0,8));
      544     6714    3           LEN_UBIN = CONTROL.LAST_FILLER_LEN;
      545     6715    3           CALL SET_FIELD_NUM(1,LEN_UBIN);
      546     6716    3           CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,'*',
      547     6717    3              SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      548     6718    3           CALL WRITE_UWA;
      549     6719    3           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;
      550     6720    3           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;
      551     6721    3           END;
      552     6722    3       DO WHILE (RECORD_FOUND);
      553     6723    3           CALL FETCHNS_6('RC-FR   ') ALTRET(DONE_FR_PARA);
      554     6724    3           FR_DBK = UWA.DIRECT_REF;
      555     6725    3           CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);
      556     6726    3           UWA.DIRECT_REF = FR_DBK;
      557     6727    3           TYPE_430.FIELD_NAME = UWA.SN.SENAME;
      558     6728    3           TYPE_430.SUB_FIELD_NAME = UWA.SN.SENAME;
      559     6729    3           CALL CHANGE_TO_STR(TYPE_430.SUB_FIELD_NAME);
      560     6730    3           TYPE_430.TYPE = 430;
      561     6731    3           TYPE_430.OFFSET = 0;
      562     6732    3           TYPE_430.REF_LINE = 0;
      563     6733    3           TYPE_430.LEVEL_FIELD = 2;
      564     6734    3           TYPE_430.ELEMENTARY = '1'B;
      565     6735    3           CALL ALLOCATE_PARAMETER;
      566     6736    3           TYPE_430.ELEMENTARY = '1'B;
      567     6737    3           CALL ZIG$V_FIELD;
      568     6738    3           CALL INIT_TYPE_9_DBPARAM;
      569     6739    3           CALL WRITSF(CUR_EXT_NAME_SEG,TYPE_9);
      570     6740    3           CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;
      571     6741        /*
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:19   
      572     6742              Write out the type 9 descriptor for the data base parameters
      573     6743            that are not part of a record into the extented name segment
      574     6744            of the subschema file.
      575     6745        */
      576     6746    3           CONTROL.NUM_DB_PARAM = CONTROL.NUM_DB_PARAM + 1;
      577     6747    3           FR.DEF.FSR = '1'B;
      578     6748    3           IF VALIDS.PARAM_XREF
      579     6749    4           THEN DO;
      580     6750    4               I = FR.UOFST.EIS.FRID/8;
      581     6751    4               CALL SET_FIELD_NUM(1,I);
      582     6752    4               WORD_OFFSET = ' ';
      583     6753    4               CALL INSERT(WORD_OFFSET,5-FIELD1.COUNT1,FIELD1.COUNT1,
      584     6754    4                  SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      585     6755    4               I = ( FR.UOFST.EIS.FRID - (I * 8)) / 2;
      586     6756    4               CALL SET_FIELD_NUM(1,I);
      587     6757    4               I = MOD( FR.UOFST.EIS.FRID, 2);
      588     6758    4               IF I = 1
      589     6759    5               THEN DO;
      590     6760    5                   NIBLE_OFF = '1';
      591     6761    5                   END;
      592     6762    5               ELSE DO;
      593     6763    5                   NIBLE_OFF = '0';
      594     6764    5                   END;
      595     6765    4               CALL CONCAT(NUM_OFF,WORD_OFFSET,' ',SUBSTR(FIELD1.TEXT1,0,1),
      596     6766    4                  ' ',NIBLE_OFF);
      597     6767    4               CALL CONCAT(LIST_STRING,'     ',NUM_OFF,TYPE_430.SUB_FIELD_NAME,
      598     6768    4                  '     ',DATA_TYPE_NAME(TYPE_430.DATA_TYPE));
      599     6769    4               CALL LIST(LIST_STRING);
      600     6770    4               END;
      601     6771    3           IF SUB_LANGUAGE = #FORTRAN
      602     6772    4           THEN DO;
      603     6773    4               CALL INDEX1(I,' ',TYPE_430.SUB_FIELD_NAME);
      604     6774    4               CALL CONCAT(LIST_STRING,'     +               ',
      605     6775    4                  SUBSTR(TYPE_430.SUB_FIELD_NAME,0,I+1),',');
      606     6776    4               CALL WRITE_UWA;
      607     6777    4               SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;
      608     6778    4               UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:20   
      609     6779    4               CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(
      610     6780    4                  TYPE_430.DATA_TYPE),TYPE_430.SUB_FIELD_NAME);
      611     6781    4               IF TYPE_430.DATA_TYPE = 0
      612     6782    5               THEN DO;
      613     6783    5                   CALL SET_FIELD_NUM(1,TYPE_430.LEN_FIELD);
      614     6784    5                   CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,
      615     6785    5                      '*',SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      616     6786    5                   END;
      617     6787    4               CALL WRITE_UWA;
      618     6788    4               NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;
      619     6789    4               UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;
      620     6790    4               CALL WRITE_RVA(3,FR.UOFST.EIS.FRID);
      621     6791    4               END;
      622     6792    3           END;
      623     6793    2   DONE_FR_PARA:
      624     6794    2       IF UWA.DB_STATUS ~= '0502100' AND RECORD_FOUND THEN CALL ABORT;
      625     6795    2       IO_BUF = SAVE_BUF;
      626     6796    2       VALIDS.FR_NAMES = SAVED_FR_NAMES;
      627     6797    2       RETURN;
      628     6798    2   DBCS_ERR:
      629     6799    2       CALL ABORT;
      630     6800    2   END ADD_SPECIAL_REC;
      631     6801        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:21   
      632     6802        /*
      633     6803         AAA  L     L      OOO   CCC   AAA  TTTTT EEEEE
      634     6804        A   A L     L     O O O C   C A   A   T   E
      635     6805        A   A L     L     O O O C     A   A   T   E
      636     6806        AAAAA L     L     O  OO C     AAAAA   T   EEEE
      637     6807        A   A L     L     O   O C     A   A   T   E
      638     6808        A   A L     L     O   O C   C A   A   T   E
      639     6809        A   A LLLLL LLLLL  OOO   CCC  A   A   T   EEEEE
      640     6810
      641     6811
      642     6812
      643     6813              PPPP   AAA  RRRR   AAA  M   M EEEEE TTTTT EEEEE RRRR
      644     6814              P   P A   A R   R A   A MM MM E       T   E     R   R
      645     6815              P   P A   A R   R A   A M M M E       T   E     R   R
      646     6816              PPPP  AAAAA RRRR  AAAAA M   M EEEE    T   EEEE  RRRR
      647     6817              P     A   A R R   A   A M   M E       T   E     R R
      648     6818              P     A   A R  R  A   A M   M E       T   E     R  R
      649     6819              P     A   A R   R A   A M   M EEEEE   T   EEEEE R   R
      650     6820        _____
      651     6821        */
      652     6822    1   ALLOCATE_PARAMETER:
      653     6823    1       PROC;
      654     6824        /*W*
      655     6825              The next few subroutines where converted strait from PL1
      656     6826            so if you have any problems with DATA BASE PARAMETERS then
      657     6827            look at the PL1 code and may GOD help you. Because, when
      658     6828            I converted these subroutines I didn't understand how they
      659     6829            work so good luck. (you will need it).
      660     6830        */
      661     6831    2   DCL BYTE_ALIGNMENT UBIN (36);
      662     6832    2   DCL ASSIGNED_FSS_ALIGNMENT(0:27) STATIC UBIN (36) INIT(
      663     6833    2    1,4*13,8*3,4);
      664     6834    2   DCL I SBIN (36);
      665     6835        /*     allocate a data base parameter
      666     6836                   the subschema characteristics have been
      667     6837                   decided on by the caller and the "TYPE_430"
      668     6838                   fields "DATA_TYPE", "LENGTH", and "SCALE"
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:22   
      669     6839                   have been set.
      670     6840        */
      671     6841    2       CALL DEFAULT_DATA_TYPE;
      672     6842        /*
      673     6843              Assign a uwa offset
      674     6844        */
      675     6845    2       IF SUB_LANGUAGE=#COBOL
      676     6846        /* Cobol parameters are all double word aligned */
      677     6847    2       THEN BYTE_ALIGNMENT=8;
      678     6848        /*Fortran parameters can be of different sizes  */
      679     6849    2       ELSE BYTE_ALIGNMENT=ASSIGNED_FSS_ALIGNMENT(TYPE_430.DATA_TYPE);
      680     6850    2       I=MOD(OA.UWSZ,BYTE_ALIGNMENT);
      681     6851    2       IF SUB_LANGUAGE = #FORTRAN AND I ~= 0
      682     6852    3       THEN DO;
      683     6853    3           CALL SET_FIELD_NUM(1,LAST_FILLER);
      684     6854    3           CALL CONCAT(TEMP_WORD,'FILL',SUBSTR(FIELD1.TEXT1,0,4));
      685     6855    3           LAST_FILLER = LAST_FILLER + 1;
      686     6856    3           CALL CONCAT(LIST_STRING,'     +               ',
      687     6857    3              SUBSTR(TEMP_WORD,0,8),',');
      688     6858    3           CALL WRITE_UWA;
      689     6859    3           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;
      690     6860    3           UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;
      691     6861    3           CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(0),
      692     6862    3              SUBSTR(TEMP_WORD,0,8));
      693     6863    3           CALL SET_FIELD_NUM(1,I);
      694     6864    3           CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,'*',
      695     6865    3              SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      696     6866    3           CALL WRITE_UWA;
      697     6867    3           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;
      698     6868    3           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;
      699     6869    3           END;
      700     6870    2       IF I~=0
      701     6871    2       THEN OA.UWSZ=OA.UWSZ+BYTE_ALIGNMENT-I;
      702     6872    2       I=UNITS_PER_WORD(TYPE_430.DATA_TYPE)/4;
      703     6873    2       TYPE_430.OFFSET=OA.UWSZ*I;
      704     6874    2       OA.UWSZ=OA.UWSZ + ( TYPE_430.LEN_FIELD + I-1 )/I;
      705     6875    2       CALL INIT_TYPE_9_DBPARAM;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:23   
      706     6876    2       TYPE_430.EIS.ADDER_C.REG = 1;
      707     6877    2       TYPE_430.EIS.NDSC.CN = MOD(TYPE_430.OFFSET*FACTER(TYPE_430.DATA_TYPE),8);
      708     6878    2       TYPE_430.EIS.ADDER_C.OFFSET = TYPE_430.OFFSET*FACTER(TYPE_430.DATA_TYPE)/8;
      709     6879    2       TYPE_430.EIS.EIS_TN_S.TN_S = TN_S(TYPE_430.DATA_TYPE);
      710     6880    2       IF TYPE_9.NUMERIC
      711     6881    3       THEN DO;
      712     6882    3           SSCALE = TYPE_430.SCALE_FIELD;
      713     6883    3           IF SSCALE ~= 0
      714     6884    3           THEN SSCALE = 64 - SSCALE;
      715     6885    3           TYPE_430.EIS.NDSC.SF = SSCALE;
      716     6886    3           TYPE_430.EIS.NDSC.N = TYPE_430.LEN_FIELD;
      717     6887    3           END;
      718     6888    3       ELSE DO;
      719     6889    3           TYPE_430.EIS.ADSC.N = TYPE_430.LEN_FIELD;
      720     6890    3           END;
      721     6891    2   END ALLOCATE_PARAMETER;
      722     6892        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:24   
      723     6893        /*
      724     6894        TTTTT Y   Y PPPP  EEEEE       4   4 33333  000         SSS   III  ZZZZZ EEEEE
      725     6895          T   Y   Y P   P E           4   4     3 0   0       S   S   I       Z E
      726     6896          T    Y Y  P   P E           4   4    3  0   0       S       I      Z  E
      727     6897          T     Y   PPPP  EEEE        44444   33  0   0        SSS    I     Z   EEEE
      728     6898          T     Y   P     E               4     3 0   0           S   I    Z    E
      729     6899          T     Y   P     E               4 3   3 0   0       S   S   I   Z     E
      730     6900          T     Y   P     EEEEE           4   33   000         SSS   III  ZZZZZ EEEEE
      731     6901                                _____                   _____
      732     6902
      733     6903
      734     6904              FFFFF RRRR   OOO  M   M       EEEEE  III   SSS
      735     6905              F     R   R O O O MM MM       E       I   S   S
      736     6906              F     R   R O O O M M M       E       I   S
      737     6907              FFFF  RRRR  O  OO M   M       EEEE    I    SSS
      738     6908              F     R R   O   O M   M       E       I       S
      739     6909              F     R  R  O   O M   M       E       I   S   S
      740     6910              F     R   R  OOO  M   M       EEEEE  III   SSS
      741     6911        _____                         _____
      742     6912        */
      743     6913    1   TYPE_430_SIZE_FROM_EIS:
      744     6914    1       PROC;
      745     6915    2   DCL 1 NEIS BASED ALIGNED,
      746     6916    2         2 * BIT (24) UNAL,
      747     6917    2         2 SCALE UBIN (6) UNAL,
      748     6918    2         2 LENGTH UBIN (6) UNAL;
      749     6919    2   DCL 1 AEIS BASED ALIGNED,
      750     6920    2         2 * BIT (24) UNAL,
      751     6921    2         2 LENGTH UBIN (12) UNAL;
      752     6922         /*
      753     6923            this procedure expects "DATA_TYPE" to contain the
      754     6924            global data type code (from 0 to 27).
      755     6925         */
      756     6926    2       IF NUMERIC(TYPE_430.DATA_TYPE)
      757     6927    3       THEN DO;
      758     6928    3           TYPE_430.LEN_FIELD= ADDR(UWA.FR.BUFFLOC) -> NEIS.LENGTH;
      759     6929    3           TYPE_430.SCALE_FIELD = ADDR(UWA.FR.BUFFLOC) -> NEIS.SCALE;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:25   
      760     6930    3           IF TYPE_430.SCALE_FIELD<32 THEN
      761     6931    3               TYPE_430.SCALE_FIELD=-TYPE_430.SCALE_FIELD;
      762     6932    3           ELSE
      763     6933    3               TYPE_430.SCALE_FIELD=64-TYPE_430.SCALE_FIELD;
      764     6934    3           END; /* Numeric eis descriptor */
      765     6935    3       ELSE DO;
      766     6936         /* Alphanumeric eis descriptor */
      767     6937    3           TYPE_430.LEN_FIELD = ADDR(UWA.FR.BUFFLOC) -> AEIS.LENGTH;
      768     6938    3           TYPE_430.SCALE_FIELD=0;
      769     6939    3           END; /* Not numeric */
      770     6940    2   END TYPE_430_SIZE_FROM_EIS;
      771     6941        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:26   
      772     6942        /*
      773     6943        DDDD  EEEEE FFFFF  AAA  U   U L     TTTTT
      774     6944        D   D E     F     A   A U   U L       T
      775     6945        D   D E     F     A   A U   U L       T
      776     6946        D   D EEEE  FFFF  AAAAA U   U L       T
      777     6947        D   D E     F     A   A U   U L       T
      778     6948        D   D E     F     A   A U   U L       T
      779     6949        DDDD  EEEEE F     A   A  UUU  LLLLL   T
      780     6950                                                  _____
      781     6951
      782     6952
      783     6953        DDDD   AAA  TTTTT  AAA        TTTTT Y   Y PPPP  EEEEE
      784     6954        D   D A   A   T   A   A         T   Y   Y P   P E
      785     6955        D   D A   A   T   A   A         T    Y Y  P   P E
      786     6956        D   D AAAAA   T   AAAAA         T     Y   PPPP  EEEE
      787     6957        D   D A   A   T   A   A         T     Y   P     E
      788     6958        D   D A   A   T   A   A         T     Y   P     E
      789     6959        DDDD  A   A   T   A   A         T     Y   P     EEEEE
      790     6960                                _____
      791     6961        */
      792     6962    1   DEFAULT_DATA_TYPE:
      793     6963    1       PROC;
      794     6964    2   DCL I SBIN (36);
      795     6965    2   DCL ASSIGNED_SS_TYPE(0:18) CONSTANT UBIN (36) INIT(
      796     6966    2    1,2,2,3,4,0,0,4,0,0,
      797     6967    2    0,4,4,0,0,6,8,4,4);
      798     6968    2   DCL ASSIGNED_SS_LENGTH(0:18) CONSTANT UBIN (36) INIT(
      799     6969    2    4,4,4,0,0,0,09,256,0,
      800     6970    2    256,8,20,256,0,0,0,0,0,0);
      801     6971    2   DCL ASSIGNED_SS_SCALE(0:18) CONSTANT UBIN (36) INIT(
      802     6972    2    0,0,0,0,0,0,0,0,0,0,
      803     6973    2    0,8,20,0,0,0,0,0,0);
      804     6974    2   DCL ASSIGNED_FSS_TYPE(0:18) CONSTANT UBIN (36) INIT(
      805     6975    2    2,2,2,13,13,0,0,2,0,0,
      806     6976    2    0,13,14,0,0,2,2,13,14);
      807     6977    2   DCL ASSIGNED_FSS_LENGTH(0:18) CONSTANT UBIN (36) INIT(
      808     6978    2    4,4,4,4,4,0,0,4,0,0,
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:27   
      809     6979    2    0,4,8,0,0,4,4,4,8);
      810     6980        /*
      811     6981           give an fr a subschema data type based
      812     6982           solely on the schema data characteristics.
      813     6983           this routine returns the characteristics
      814     6984           in the "TYPE_430" fields "DATA_TYPE", "LENGTH",
      815     6985           and "SCALE".  On exit, "DP" points to
      816     6986           the fr passed as the parameter.
      817     6987        */
      818     6988    2       I = UWA.FR.FTYPE;
      819     6989    2       IF SUB_LANGUAGE=#COBOL
      820     6990    2       THEN TYPE_430.DATA_TYPE=ASSIGNED_SS_TYPE(I);
      821     6991    2       ELSE TYPE_430.DATA_TYPE=ASSIGNED_FSS_TYPE(I);
      822     6992    2       IF SUB_LANGUAGE=#COBOL
      823     6993    2       THEN TYPE_430.DATA_TYPE=SYNONYM_CTYPE(TYPE_430.DATA_TYPE);
      824     6994    3       ELSE DO;
      825     6995    3           TYPE_430.DATA_TYPE=SYNONYM_FTYPE(TYPE_430.DATA_TYPE);
      826     6996    3           IF TYPE_430.DATA_TYPE = 17 /* LOGICAL */
      827     6997    4           THEN DO;
      828     6998    4               IF SUB_LANGUAGE = #APL THEN
      829     6999    4                   TYPE_430.DATA_TYPE=SYNONYM_APL_TYPE(UWA.FR.FTYPE);
      830     7000    5               ELSE DO;
      831     7001    5                   IF SUB_LANGUAGE = #BASIC THEN
      832     7002    5                       TYPE_430.DATA_TYPE=SYNONYM_BASIC_TYPE(UWA.FR.FTYPE);
      833     7003    5                   ELSE
      834     7004    5                       IF SUB_LANGUAGE = #FORTRAN
      835     7005    6                       THEN DO;
      836     7006    7                           DO CASE (UWA.FR.FTYPE);
      837     7007    7                           CASE (3, 4, 17);
      838     7008    7                               IF SSGEN.MAP = '0'B THEN
      839     7009    7                                   TYPE_430.DATA_TYPE = 13; /* REAL */
      840     7010    7                               IF SSGEN.MAP = '1'B THEN
      841     7011    7                                   TYPE_430.DATA_TYPE = 14; /* DOUBLE PRECISION */
      842     7012    7                           CASE (ELSE);
      843     7013    7                               TYPE_430.DATA_TYPE=SYNONYM_FORTRAN_TYPE(UWA.FR.FTYPE);
      844     7014    7                               END; /* CASE */
      845     7015    6                           END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:28   
      846     7016    5                   END;
      847     7017    4               END;
      848     7018    3           END;
      849     7019        /* A bad ftype will be picked up later
      850     7020           by the conversion routine */
      851     7021    2       IF ASSIGNED_SS_LENGTH(I)=0
      852     7022    2       THEN CALL TYPE_430_SIZE_FROM_EIS;
      853     7023    3       ELSE DO;
      854     7024    3           IF SUB_LANGUAGE=#COBOL
      855     7025    4           THEN DO;
      856     7026    4               TYPE_430.LEN_FIELD=ASSIGNED_SS_LENGTH(I);
      857     7027    4               TYPE_430.SCALE_FIELD=ASSIGNED_SS_SCALE(I);
      858     7028    4               END;
      859     7029    4           ELSE DO;
      860     7030    4               TYPE_430.LEN_FIELD=ASSIGNED_FSS_LENGTH(I);
      861     7031    4               TYPE_430.SCALE_FIELD=0;
      862     7032    4               END;
      863     7033    3           END;
      864     7034    2   END DEFAULT_DATA_TYPE;
      865     7035        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:29   
      866     7036        /*
      867     7037         III  N   N  III  TTTTT       TTTTT Y   Y PPPP  EEEEE        999
      868     7038          I   N   N   I     T           T   Y   Y P   P E           9   9
      869     7039          I   NN  N   I     T           T    Y Y  P   P E           9   9
      870     7040          I   N N N   I     T           T     Y   PPPP  EEEE         9999
      871     7041          I   N  NN   I     T           T     Y   P     E               9
      872     7042          I   N   N   I     T           T     Y   P     E           9   9
      873     7043         III  N   N  III    T           T     Y   P     EEEEE        999
      874     7044                                _____                         _____
      875     7045
      876     7046
      877     7047              DDDD  BBBB  PPPP   AAA  RRRR   AAA  M   M
      878     7048              D   D B   B P   P A   A R   R A   A MM MM
      879     7049              D   D B   B P   P A   A R   R A   A M M M
      880     7050              D   D BBBB  PPPP  AAAAA RRRR  AAAAA M   M
      881     7051              D   D B   B P     A   A R R   A   A M   M
      882     7052              D   D B   B P     A   A R  R  A   A M   M
      883     7053              DDDD  BBBB  P     A   A R   R A   A M   M
      884     7054        _____
      885     7055        */
      886     7056    1   INIT_TYPE_9_DBPARAM:
      887     7057    1       PROC;
      888     7058    2   DCL S SBIN (36) ALIGNED STATIC;
      889     7059    2   DCL RLTDP(0:13) CONSTANT UBIN (9) INIT (
      890     7060    2    0,11,11,0,0,0,0,0,0,0,0,5,10,0);
      891     7061    2       TYPE_9.TYPE = 9;
      892     7062    2       TYPE_9.FLD_NM = '1'B;
      893     7063    2       TYPE_9.BUWA = '1'B;
      894     7064    2       IF TYPE_430.DATA_TYPE = 1
      895     7065    3       THEN DO;
      896     7066    3           TYPE_9.SRF_DBK = '1'B;
      897     7067    3           TYPE_9.F_DBK = '1'B;
      898     7068    3           END;
      899     7069    3       ELSE DO;
      900     7070    3           TYPE_9.SRF_DBK = '0'B;
      901     7071    3           TYPE_9.F_DBK = '0'B;
      902     7072    3           END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:30   
      903     7073    2       TYPE_9.LEVEL = 77;
      904     7074    2       TYPE_9.LENGTH = TYPE_430.LEN_FIELD;
      905     7075    2       TYPE_9.LTDP=RLTDP(TYPE_430.DATA_TYPE);
      906     7076    2       IF TYPE_9.LTDP=0 THEN
      907     7077    2           TYPE_9.LTDP=TYPE_430.LEN_FIELD - TYPE_430.SCALE_FIELD;
      908     7078    2       TYPE_9.RTDP = TYPE_430.SCALE_FIELD;
      909     7079    2       TYPE_9.OFFSET = TYPE_430.OFFSET;
      910     7080    2       CALL INDEX1(S,' ',TYPE_430.FIELD_NAME);
      911     7081    2       TEMP_WORD = TYPE_430.FIELD_NAME;
      912     7082    2       CALL CHANGE_TO_STR(TEMP_WORD);
      913     7083    2       TYPE_9.NAME = TEMP_WORD;
      914     7084    2       TYPE_9.NAME_SIZE = S;
      915     7085    2       S=S+99;
      916     7086    2       IF MOD(S,4)~=0 THEN
      917     7087    2           S=S+4-MOD(S,4);
      918     7088    2       TYPE_9.SIZE=S;
      919     7089    2       IF FR.DEF.COMC>0 AND TYPE_430.SCALE_FIELD = 0
      920     7090    2       THEN TYPE_9.NUMERIC = '1'B;
      921     7091    2       ELSE TYPE_9.NUMERIC = '0'B;
      922     7092    2       TPTR$ = PINCRW(ADDR(TYPE_9.RTDP),1);
      923     7093    2       TPTR$ -> BITS_52 = PV(TYPE_430.DATA_TYPE);
      924     7094    2       IF TYPE_9.F_DBK OR TYPE_9.DB_KEY
      925     7095    2       THEN TYPE_9.INTEGER_TYPE = '1'B;
      926     7096    2       RETURN;
      927     7097    2   END INIT_TYPE_9_DBPARAM;
      928     7098        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:31   
      929     7099        /*
      930     7100            THIS SUBROUTINE CHANGES SCHEMA WORDS INTO COBOL WORDS '_' TO '-'.
      931     7101        */
      932     7102    1   CHANGE_TO_STR:
      933     7103    1       PROC (CHANGE_STR);
      934     7104    2   DCL CHANGE_STR CHAR (30);
      935     7105    2   DCL COUNT1 UBIN (36);
      936     7106    2   DCL ONE_CHANGE (0:4) CHAR (2) CONSTANT INIT ('  ',
      937     7107    2    '_-' /* COBOL */, '_$' /* FORTRAN */, '__' /* APL */, '__' /* BASIC */);
      938     7108    2       IF (SUB_LANGUAGE = #APL) OR (SUB_LANGUAGE = #BASIC) THEN RETURN;
      939     7109    2       CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);
      940     7110    3       DO WHILE (COUNT1~= 30);
      941     7111    3           CALL INSERT(CHANGE_STR,COUNT1,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1));
      942     7112    3           CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);
      943     7113    3           END;
      944     7114    2       RETURN;
      945     7115    2   END CHANGE_TO_STR;
      946     7116        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:32   
      947     7117    1   WRITE_UWA:
      948     7118    1       PROC;
      949     7119    2       UWA_KEY.NUMBER_OF = UWA_KEY.NUMBER_OF + 1;
      950     7120    2       SPECIAL_KEY = UWA_KEY;
      951     7121    2       CALL ZIG$SS_WVAR;
      952     7122    2       IF ERROR_IO ~= 0
      953     7123    2       THEN CALL ABORT;
      954     7124    2       RETURN;
      955     7125    2   END WRITE_UWA;
      956     7126        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:33   
      957     7127    1   WRITE_RVA:
      958     7128    1       PROC(TYPE,ID);
      959     7129    2   DCL TYPE UBIN (36);
      960     7130    2   DCL ID UBIN (18) UNAL;
      961     7131    2       CALL GET_OCTAL_NUM(18,TYPE);
      962     7132    2       CALL CONCAT(LIST_STRING,'     +           12O',SUBSTR(
      963     7133    2          FIELD1.TEXT1,0,6),'000000,');
      964     7134    2       I = ID;
      965     7135    2       CALL GET_OCTAL_NUM(18,I);
      966     7136    2       CALL INSERT(LIST_STRING,26,6,SUBSTR(FIELD1.TEXT1,0,6),',');
      967     7137    2   JUST_WRITE_RVA:
      968     7138    2       ENTRY;
      969     7139    2       RVA_KEY.NUMBER_OF = RVA_KEY.NUMBER_OF + 1;
      970     7140    2       SPECIAL_KEY = RVA_KEY;
      971     7141    2       CALL ZIG$SS_WVAR;
      972     7142    2       IF ERROR_IO ~= 0
      973     7143    2       THEN CALL ABORT;
      974     7144    2       RETURN;
      975     7145    2   END WRITE_RVA;
      976     7146        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:34   
      977     7147    1   GET_OCTAL_NUM:
      978     7148    1       PROC(LEN,ALI);
      979     7149    2   DCL LEN UBIN (36);
      980     7150    2   DCL 1 ALI HALIGNED,
      981     7151    2         2 NUM(0:0) UBIN (3) UNAL;
      982     7152    2   DCL I UBIN (36);
      983     7153    2   DCL CHAR_1 CHAR (1) STATIC;
      984     7154    3       DO I = 0 TO (LEN/3)-1;
      985     7155    3           CALL BINCHAR(CHAR_1,ALI.NUM(I+6));
      986     7156    3           CALL INSERT(FIELD1.TEXT1,I,1,CHAR_1);
      987     7157    3           END;
      988     7158    2       FIELD1.COUNT1 = LEN/3;
      989     7159    2       RETURN;
      990     7160    2   END GET_OCTAL_NUM;
      991     7161        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:35   
      992     7162        /*F*
      993     7163        NAME:    VALIDATER
      994     7164        PURPOSE:   To validate a translated subschema so IDS and the
      995     7165                 language that the subschema is for can read it.
      996     7166        DESCRIPTION:
      997     7167
      998     7168            The new validater:
      999     7169
     1000     7170              All validate modulals will start with the letters 'ZIG$V_'
     1001     7171            and written in pl6. The way things are done are described
     1002     7172            below.
     1003     7173
     1004     7174            WHEN TO PUT WHAT IN SCHEMA SUBSET:
     1005     7175
     1006     7176                 AC - place AC record in only if area is pressent in subschema
     1007     7177                      DDL.
     1008     7178
     1009     7179                 RC - if record is present in subschema then.
     1010     7180                      1 -  RC must be included in the schema subset.
     1011     7181
     1012     7182                      2 -  all SC and SO for the sets that the record is a
     1013     7183                                owner for.
     1014     7184
     1015     7185                      3 -  all SC and SM for all the sets that the record
     1016     7186                           is a member of.
     1017     7187
     1018     7188                      note1:
     1019     7189                           If any of 2 or 3 not present then put it in
     1020     7190                      and set these bits 'store not allowed' and
     1021     7191                      'erase not allowed'.
     1022     7192
     1023     7193                      note2:
     1024     7194                           if any of the SM records connected to this record
     1025     7195                      has the bit 'insert not allowed' on the the RC must
     1026     7196                      have the bit 'store not allowed' set.
     1027     7197
     1028     7198
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:36   
     1029     7199                      note3:
     1030     7200                           the RC for a record not present in the subschema
     1031     7201                      DDL might be present because of SC, SO, or SM
     1032     7202                      requirements but in these cases the 'not in subschema'
     1033     7203                      bit must be turned on in the RC record.
     1034     7204
     1035     7205
     1036     7206
     1037     7207
     1038     7208                 FR - All FR records in any record present in the subschema
     1039     7209                      DDL must be present.
     1040     7210
     1041     7211                      note1:
     1042     7212                           If an fr doesn't have a descriptor present for
     1043     7213                      the UWA location (not in suschema DDL) then the
     1044     7214                      'not in subschema' bit must be on.
     1045     7215
     1046     7216                      note2:
     1047     7217                           If an field is duplicated or is not actually in
     1048     7218                      the record (subschema DDL) whose RC it is linked to,
     1049     7219                      the 'synonym' bit must be on.
     1050     7220
     1051     7221                      note3:
     1052     7222                           If a field is a control field, but sufficient
     1053     7223                      information is not present to allow it to be processed
     1054     7224                      as a control field the 'field can't be mobified' bit
     1055     7225                      must be on.
     1056     7226
     1057     7227
     1058     7228                 RA - If a record is known by the subschema  to be in an
     1059     7229                      area known th the subschema, there must be an RA
     1060     7230                      relating the RC to the AC. This is the only way
     1061     7231                      for an RA to be in the schema subset.
     1062     7232
     1063     7233
     1064     7234                 SC - Set Class
     1065     7235                 SM - Set Member
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:37   
     1066     7236                 SO - Set Owner
     1067     7237
     1068     7238                      For calc set:
     1069     7239
     1070     7240                           1 -  An SM may be included in the schema subset
     1071     7241                                for a record for reasons listed under RC.
     1072     7242                                If the 'insert not allowed' bit is not on,
     1073     7243                                all SS records for the SM must be included.
     1074     7244                                See SS section.
     1075     7245
     1076     7246                           2 -  If any SM records for the calc set are
     1077     7247                                included in the schema subset, the SC and
     1078     7248                                SO records must also be included. Also
     1079     7249                                the RC for the calc header must also be
     1080     7250                                included!
     1081     7251
     1082     7252
     1083     7253                      For non-calc sets:
     1084     7254
     1085     7255                           If the set is present in the subschema:
     1086     7256
     1087     7257                           1 -  SC, SO, and all SM records for the set must
     1088     7258                                be included in the schema subset. The
     1089     7259                                corresponding RC must be included for the
     1090     7260                                SO and all SM records. If the record type
     1091     7261                                isn't in the subschema DDL then the
     1092     7262                                'not in subschema' bit in the RC must be on,
     1093     7263                                and there must be an SO or SM and RC for each
     1094     7264                                possible record type that may be encountered
     1095     7265                                in the set.
     1096     7266
     1097     7267                           2 -  If the 'insert not allowed' bit in an SM is
     1098     7268                                not on, the following must be present:
     1099     7269
     1100     7270                                     CD and FR for all sort and duplicate
     1101     7271                                     control fields for the set. These FR
     1102     7272                                     records must now have the bit
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:38   
     1103     7273                                     'field not in subschema' on.
     1104     7274
     1105     7275                                     All ss records for the SM.
     1106     7276
     1107     7277
     1108     7278                           If the set is not present in the subschema DDL:
     1109     7279
     1110     7280
     1111     7281                           1 -  SC and SO may be included for reasons
     1112     7282                                listed under RC records. If so the
     1113     7283                                'not in subschema' bit must be on in the SC.
     1114     7284
     1115     7285                           2 -  An SM must not be included for a set that
     1116     7286                                is not present in the subschema!
     1117     7287
     1118     7288
     1119     7289
     1120     7290                      SS - Set selection elements:
     1121     7291
     1122     7292                           If any SS records are included with an SM record.
     1123     7293                           All must be included and the following also:
     1124     7294
     1125     7295                                All CD and Fr records for each SS. The FR
     1126     7296                                records included because of this must have
     1127     7297                                'not in subschema' bit on.
     1128     7298
     1129     7299                                If the SS record is an entry type (calc
     1130     7300                                or current), the SO and RC records for the
     1131     7301                                record to be located by this SS record must
     1132     7302                                also be included. (also the SC record for
     1133     7303                                this SO record must be included.)
     1134     7304
     1135     7305                                If the SS record is a scan type SS, the SM
     1136     7306                                and RC records for the record to be located
     1137     7307                                by this SS must be included. The SC record
     1138     7308                                for this SM record must also be present.
     1139     7309
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:39   
     1140     7310
     1141     7311
     1142     7312                      DP - Database procedures:
     1143     7313
     1144     7314
     1145     7315                           A DP record must be included in the schema subset
     1146     7316                           for each database procedure that is to be called
     1147     7317                           by the DBCS.
     1148     7318
     1149     7319
     1150     7320
     1151     7321                      AG - Argument elements:
     1152     7322
     1153     7323
     1154     7324                           An AG record must be included in the schema
     1155     7325                           subset for each argument to every DP that is
     1156     7326                           present.
     1157     7327
     1158     7328                           If the AG record is for a field in a record, that
     1159     7329                           field must be present in the Sub Schema DDL.
     1160     7330
     1161     7331
     1162     7332
     1163     7333
     1164     7334            METHOD FOR BUILDING SCHEMA SUBSET:
     1165     7335
     1166     7336
     1167     7337                   Build a OA record for the schema subset and fill in things
     1168     7338                 from the schemas OA record.
     1169     7339
     1170     7340                   Start going through the AC descriptors (type 200)
     1171     7341                 in the descriptor segment of the subschema. Build a AC
     1172     7342                 record for the schema subset for each area in the subschema
     1173     7343                 ddl and fill it in with information from the AC record in
     1174     7344                 the schema.
     1175     7345
     1176     7346                   Go through the set and key descriptors (type 300, 350)
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:40   
     1177     7347                 Build all SC, SM, SO, CD, AND SS records for the
     1178     7348                 sets and keys in this section. (note: all generated RC
     1179     7349                 and FR record must then set the 'not in subschema' bit).
     1180     7350
     1181     7351                   Go through all record and field descriptors in the
     1182     7352                 subschema descriptor segment and build all the
     1183     7353                 RC and FR records required because it is given in the
     1184     7354                 subschema ddl. Put in any calc set or required set for any
     1185     7355                 record not allready present. (By what has to be added
     1186     7356                 one can tell most of the required information needed in
     1187     7357                 in the schema subset) Also put in all RA records that
     1188     7358                 connect the RC records with the AC records. Build the
     1189     7359                 information needed for the encoding and decoding of
     1190     7360                 fields in the record.
     1191     7361
     1192     7362                   Go through the schema file and put in all the database
     1193     7363                 parameters required.
     1194     7364
     1195     7365                   Then go throw the schema subset in memory and find all
     1196     7366                 the syn FR and find the real FR and update the syn FR to
     1197     7367                 reflex the real FR in the schema subset.
     1198     7368
     1199     7369                   Then go throw all the set and add any records that should
     1200     7370                 be added because of sets pressent in the schema subset.
     1201     7371                 These records are RC and FR records that are needed if the
     1202     7372                 ASL is to go throw this set and find any records. IDS needs
     1203     7373                 the records to be there even if the user can't find out
     1204     7374                 anything about this record.
     1205     7375
     1206     7376
     1207     7377                   Go through the schema file and put in all the database
     1208     7378                 procedure (DP) records along with the AG records.
     1209     7379
     1210     7380                   Then if Asked for prohibited or permitted statements
     1211     7381                 go through the build schema subset and find which statements
     1212     7382                 are allowed and with are not.
     1213     7383
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:41   
     1214     7384                   Write out extended descriptor segment.
     1215     7385
     1216     7386                   Write out schema subset.
     1217     7387
     1218     7388                   Put in AS record in schema and the dictionary part of
     1219     7389                 the subschema.
     1220     7390
     1221     7391
     1222     7392            TESTING NEW VALIDATER:
     1223     7393
     1224     7394                   Write a program to go throw all the descriptors in the
     1225     7395                 extended descriptor segment and the schema subset and
     1226     7396                 compare them to see what is different.
     1227     7397
     1228     7398
     1229     7399            DIFFERENCE FROM REST OF DBACS:
     1230     7400
     1231     7401
     1232     7402                 It will use a canned UWA so the updating of the comuncation
     1233     7403                 area will not have to use pointers.
     1234     7404
     1235     7405                   The main differences between the CP6 validator and GCOS
     1236     7406                 are:
     1237     7407                 first -     The schema subset is built just like IDS reads
     1238     7408                           from the subschema file not a internal form that
     1239     7409                           is only good for the DBACS use. Some side
     1240     7410                           beneficial are the that the permitted and
     1241     7411                           prohibited list should be able go be gotten
     1242     7412                           throw a display process.
     1243     7413
     1244     7414                 second -    Some of the internal descriptors are larger
     1245     7415                           then there GCOS descriptors. The type 430 now
     1246     7416                           also have the DEF part of that FR record that
     1247     7417                           are in the schema subset. They also now contain
     1248     7418                           the DBK of the FR record in the schema file for
     1249     7419                           quick access from the subschema file to the schema
     1250     7420                           file.
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:42   
     1251     7421
     1252     7422                 third -     The new validator seems to be faster then the
     1253     7423                           GCOS validator. (2 to 10 time faster).
     1254     7424
     1255     7425                 fourth -    The slow part of the new validater is conectting
     1256     7426                           up the CD records of the sets to the FR record.
     1257     7427                           So, if the subschema file has lots of set the
     1258     7428                           validation process is a little slower then maybe
     1259     7429                           it should.
     1260     7430
     1261     7431        */
     1262     7432        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:43   
     1263     7433        /*
     1264     7434              This is the start or ZIG$V_DRIVER main procedure.
     1265     7435
     1266     7436            Call BLD_NM to initial things for the search of area, set,
     1267     7437            key, and record names.
     1268     7438        */
     1269     7439    1       IF LANG_ALLOWED(CONTROL.LANGUAGE) = 0
     1270     7440    2       THEN DO;
     1271     7441    2           FIELD_NAME = LANG_TEXT(SUB_LANGUAGE);
     1272     7442    2           CALL SET_FIELDS(1,30,FIELD_NAME);
     1273     7443    2           CALL ERROR(%ZIG_INTERFACE_NO_$);
     1274     7444    2           RETURN;
     1275     7445    2           END;
     1276     7446    1       CALL BLD_NM;
     1277     7447    1       SUB_LANGUAGE = CONTROL.LANGUAGE;
     1278     7448        /*  ALLOCATE_END = 1 NORMAL ALLOCATION FOR VALIDATION DYNAMIC MEM. */
     1279     7449    1       CUR_EXT_NAME_SEG = CONTROL.FIRST_NFE_RECORD;
     1280     7450    1       CONTROL.NUM_REC_SET_REL = 0;
     1281     7451    1       CONTROL.NUM_FIELD_SET = 0;
     1282     7452    1       CONTROL.NUM_DB_PARAM = 0;
     1283     7453    1       CONTROL.NUM_LOCKS = 0;
     1284     7454    1       CONTROL.NUM_REC_AREA_REL = 0;
     1285     7455    1       CONTROL.BITS.ALL_FIELDS = '1'B;
     1286     7456    1       NO_ERRORS = '1'B;
     1287     7457    1       LARGEST_KEY = 0;
     1288     7458    1       NUM_ERROR_MSG = 0;
     1289     7459    1       IF CONTROL.FIRST_CU_RECORD ~= 0
     1290     7460    2       THEN DO;
     1291     7461    2           I = CONTROL.FIRST_CU_RECORD;
     1292     7462    2           IF CONTROL.FIRST_CU_RECORD < CONTROL.FIRST_NFE_RECORD THEN
     1293     7463    2               CUR_EXT_NAME_SEG = CONTROL.FIRST_CU_RECORD;
     1294     7464    2           ELSE
     1295     7465    2               CONTROL.FIRST_CU_RECORD = CUR_EXT_NAME_SEG;
     1296     7466    3           DO WHILE (I ~= 0);
     1297     7467    3               CALL READSF(I,IO_BUF);
     1298     7468    3               I = ADDR(IO_BUF) -> WORD36;
     1299     7469    3               IF ADDR(IO_BUF) -> WORD36 ~= 0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:44   
     1300     7470    3               THEN ADDR(IO_BUF) -> WORD36 = CUR_EXT_NAME_SEG + 1;
     1301     7471    3               CALL WRITSF(CUR_EXT_NAME_SEG,IO_BUF);
     1302     7472    3               CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;
     1303     7473    3               END;
     1304     7474    2           CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + MOD(CUR_EXT_NAME_SEG,2);
     1305     7475    2           CONTROL.FIRST_NFE_RECORD = CUR_EXT_NAME_SEG;
     1306     7476    2           END;
     1307     7477    1       CONTROL.UWA_SIZE = CONTROL.TRANS_UWA_SIZE;
     1308     7478    1       CONTROL.NEXT_UWA_LOC = CONTROL.TRANS_UWA_SIZE;
     1309     7479    1       IF SUB_LANGUAGE = #FORTRAN
     1310     7480    2       THEN DO;
     1311     7481    2           UWA_KEY.NUMBER_OF = 0;
     1312     7482    2           RVA_KEY.NUMBER_OF = 2;
     1313     7483    2           IA__KEY.NUMBER_OF = 0;
     1314     7484    2           SUBSCHEMA_NAME_4 = SUBSTR(CONTROL.SUBSCHEMA_NAME,0,4);
     1315     7485    2           BUFFER$ = ADDR(LIST_STRING);
     1316     7486    2           BUFFER_LEN = 72;
     1317     7487    2           CALL CONCAT(LIST_STRING,'       COMMON /U',SUBSCHEMA_NAME_4,
     1318     7488    2              '/ U',SUBSCHEMA_NAME_4,',');
     1319     7489    2           CALL WRITE_UWA;
     1320     7490    2           LIST_STRING='     +               DBSTATUS,';
     1321     7491    2           CALL WRITE_UWA;
     1322     7492    2           LIST_STRING='     +               FILLER0,';
     1323     7493    2           CALL WRITE_UWA;
     1324     7494    2           LIST_STRING='     +               DBAREA,';
     1325     7495    2           CALL WRITE_UWA;
     1326     7496    2           LIST_STRING='     +               FILLER1,';
     1327     7497    2           CALL WRITE_UWA;
     1328     7498    2           LIST_STRING='     +               DBSET,';
     1329     7499    2           CALL WRITE_UWA;
     1330     7500    2           LIST_STRING='     +               FILLER2,';
     1331     7501    2           CALL WRITE_UWA;
     1332     7502    2           LIST_STRING='     +               DBRECORD,';
     1333     7503    2           CALL WRITE_UWA;
     1334     7504    2           LIST_STRING='     +               FILLER3,';
     1335     7505    2           CALL WRITE_UWA;
     1336     7506    2           LIST_STRING='     +               DBPRIVACY,';
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:45   
     1337     7507    2           CALL WRITE_UWA;
     1338     7508    2           LIST_STRING='     +               DIRECTREFERENCE,';
     1339     7509    2           CALL WRITE_UWA;
     1340     7510    2           LIST_STRING='     +               DBDATANAME,';
     1341     7511    2           CALL WRITE_UWA;
     1342     7512    2           LIST_STRING='     +               FILLER4,';
     1343     7513    2           CALL WRITE_UWA;
     1344     7514    2           LIST_STRING='     +               DBKEYNAME,';
     1345     7515    2           CALL WRITE_UWA;
     1346     7516    2           LIST_STRING='     +               FILLER5,';
     1347     7517    2           CALL WRITE_UWA;
     1348     7518    2           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;
     1349     7519    2           UWA_KEY.NUMBER_OF = 10000;
     1350     7520    2           CALL CONCAT(LIST_STRING,'       INTEGER U',SUBSCHEMA_NAME_4,
     1351     7521    2              ',DIRECTREFERENCE');
     1352     7522    2           CALL WRITE_UWA;
     1353     7523    2           LIST_STRING='       CHARACTER*1    FILLER0';
     1354     7524    2           CALL WRITE_UWA;
     1355     7525    2           LIST_STRING='       CHARACTER*7    DBSTATUS';
     1356     7526    2           CALL WRITE_UWA;
     1357     7527    2           LIST_STRING='       CHARACTER*30 DBDATANAME,DBKEYNAME,DBAREA,DBSET,DBRECORD'
              7527                    ;
     1358     7528    2           CALL WRITE_UWA;
     1359     7529    2           LIST_STRING='       CHARACTER*12 DBPRIVACY';
     1360     7530    2           CALL WRITE_UWA;
     1361     7531    2           LIST_STRING='       CHARACTER*2  FILLER1,FILLER2,FILLER3,FILLER4';
     1362     7532    2           CALL WRITE_UWA;
     1363     7533    2           LIST_STRING='       CHARACTER*6  FILLER5';
     1364     7534    2           CALL WRITE_UWA;
     1365     7535    2           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;
     1366     7536    2           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;
     1367     7537    2           NEXT_RVA_SECOND_HALF = 10000;
     1368     7538    2           CALL CONCAT(RVA_NAME,',R',SUBSCHEMA_NAME_4,'(');
     1369     7539    2           END;
     1370     7540    1       CALL ZIG$V_OA;
     1371     7541    1       CALL ZIG$INIT_AS;
     1372     7542        /*
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:46   
     1373     7543              Iintialize the count of things that the validater put
     1374     7544            out to zero so we don't count too many.
     1375     7545        */
     1376     7546    1       FIRST_AREA = '1'B;
     1377     7547    1       FIRST_SET = '1'B;
     1378     7548    1       FIRST_DATA_PAR = '1'B;
     1379     7549    1       FIRST_RECORD = '1'B;
     1380     7550    1       RECORD_NUM = 4; /* Init the record number for the hash table. */
     1381     7551    1       ERROR_IO = 0;
     1382     7552    1       LAST_AC = 1; /* Point last AC to OA record */
     1383     7553    1       LAST_SC = 1;
     1384     7554    1       LAST_RC = 1;
     1385     7555    1       CF_PTR$ = ADDR(NIL);
     1386     7556    1       CALL UOPEN('5*',1);
     1387     7557        /*
     1388     7558              Open 5* file for the type 34, 35, and 36 descriptors that
     1389     7559            go in the name extenction segment but COBOL is just to
     1390     7560            screwed up to handle anything but it own descriptors there.
     1391     7561        */
     1392     7562    1       CURRENT_RECORD = CONTROL.FIRST_SDS_RECORD;
     1393     7563    1       CALL READSF(CURRENT_RECORD,IO_BUF);
     1394     7564    2       DO WHILE (SUBSTR(IO_BUF,0,12) ~= SUBSTR(EOFC,0,12) AND ERROR_READ64 = 0);
     1395     7565    3           DO CASE (TYPE_100.TYPE/10);
     1396     7566    3           CASE (10);
     1397     7567        /*
     1398     7568              Translation control status.
     1399     7569            Don't need to do any thing!
     1400     7570        */
     1401     7571    3           CASE (11,21,41);
     1402     7572        /*
     1403     7573              Subschema privacy locks.
     1404     7574        */
     1405     7575    3           CASE (20);
     1406     7576    3               IF FIRST_AREA AND VALIDS.AREA_XREF
     1407     7577    4               THEN DO;
     1408     7578    4                   CALL SUBLST(HEAD_AREA_XREF);
     1409     7579    4                   FIRST_AREA = '0'B;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:47   
     1410     7580    4                   END;
     1411     7581        /*
     1412     7582              Area that is declared in the subschema.
     1413     7583        */
     1414     7584    3               CALL ZIG$V_AREA;
     1415     7585    3               IF SUB_LANGUAGE = #FORTRAN
     1416     7586    4               THEN DO;
     1417     7587    4                   CALL WRITE_RVA(0,AC.ACID);
     1418     7588    4                   SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;
     1419     7589    4                   RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;
     1420     7590    4                   CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-2);
     1421     7591    4                   CALL CONCAT(LIST_STRING,'       EQUIVALENCE (',
     1422     7592    4                      AC.ANAM,RVA_NAME,SUBSTR(FIELD1.TEXT1,0,
     1423     7593    4                      FIELD1.COUNT1),'))');
     1424     7594    4                   CALL JUST_WRITE_RVA;
     1425     7595    4                   NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;
     1426     7596    4                   RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;
     1427     7597    4                   END;
     1428     7598    3           CASE (30,35); /* sets and keys */
     1429     7599        /*
     1430     7600              Set that is in the subschema.
     1431     7601        */
     1432     7602    3               CALL ZIG$V_SET;
     1433     7603    3               IF SUB_LANGUAGE = #FORTRAN
     1434     7604    4               THEN DO;
     1435     7605    4                   CALL WRITE_RVA(1,SC.SCID);
     1436     7606    4                   SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;
     1437     7607    4                   RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;
     1438     7608    4                   CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-2);
     1439     7609    4                   CALL CONCAT(LIST_STRING,'       EQUIVALENCE (',
     1440     7610    4                      SC.SNAM,RVA_NAME,SUBSTR(FIELD1.TEXT1,0,
     1441     7611    4                      FIELD1.COUNT1),'))');
     1442     7612    4                   CALL JUST_WRITE_RVA;
     1443     7613    4                   NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;
     1444     7614    4                   RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;
     1445     7615    4                   END;
     1446     7616    3           CASE (40);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:48   
     1447     7617        /*
     1448     7618              Record that is in the subschema.
     1449     7619        */
     1450     7620    3               IF LAST_RC ~= 1
     1451     7621    4               THEN DO;
     1452     7622        /*
     1453     7623              Now check the last record to see if all the item
     1454     7624            have been given and what can be done to this record.
     1455     7625        */
     1456     7626    4                   IF RECORD_FOUND
     1457     7627    4                   THEN CALL ZIG$V_CHECK_F;
     1458     7628    4                   END;
     1459     7629    3               IF FIRST_RECORD AND VALIDS.RECORD_XREF
     1460     7630    4               THEN DO;
     1461     7631    4                   CALL SUBLST(HEAD_RECORD_XREF);
     1462     7632    4                   FIRST_RECORD = '0'B;
     1463     7633    4                   END;
     1464     7634    3               IF VALIDS.RECORD_XREF
     1465     7635    4               THEN DO;
     1466     7636    4                   LIST_STRING = ' ';
     1467     7637    4                   CALL LIST(LIST_STRING);
     1468     7638    4                   END;
     1469     7639    3               CALL ZIG$ZERO_ALT_TABLE;
     1470     7640    3               IN_GROUP = '0'B;
     1471     7641    3               LAST_GROUP_LEVEL = 0;
     1472     7642    3               CALL ZIG$V_RECORD;
     1473     7643    3               IF VALIDS.RECORD_XREF
     1474     7644    4               THEN DO;
     1475     7645    4                   LIST_STRING = ' ';
     1476     7646    4                   CALL LIST(LIST_STRING);
     1477     7647    4                   IF TYPE_400.ALIASED
     1478     7648    5                   THEN DO;
     1479     7649    5                       CALL INDEX1(I,' ',TYPE_400.RECORD_NAME);
     1480     7650    5                       CALL CONCAT(LIST_STRING,'RECORD-NAME: ',
     1481     7651    5                          RC.RNAM,' ( NEE ',SUBSTR(TYPE_400.RECORD_NAME,0,I),' )');
     1482     7652    5                       END;
     1483     7653    5                   ELSE DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:49   
     1484     7654    5                       CALL CONCAT(LIST_STRING,'RECORD-NAME: ',
     1485     7655    5                          RC.RNAM);
     1486     7656    5                       END;
     1487     7657    4                   CALL LIST(LIST_STRING);
     1488     7658    4                   FIRST_FIELD = '1'B;
     1489     7659    4                   END;
     1490     7660    3               LAST_RECORD_REF_LINE = CURRENT_RECORD;
     1491     7661    3               IF SUB_LANGUAGE = #FORTRAN
     1492     7662    4               THEN DO;
     1493     7663    4                   CALL WRITE_RVA(2,RC.RCID);
     1494     7664    4                   SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;
     1495     7665    4                   RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;
     1496     7666    4                   CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-2);
     1497     7667    4                   CALL CONCAT(LIST_STRING,'       EQUIVALENCE (',
     1498     7668    4                      RC.RNAM,RVA_NAME,SUBSTR(FIELD1.TEXT1,0,
     1499     7669    4                      FIELD1.COUNT1),'))');
     1500     7670    4                   CALL JUST_WRITE_RVA;
     1501     7671    4                   NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;
     1502     7672    4                   RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;
     1503     7673    4                   IF TYPE_400.LAST_FILLER_LEN ~= 0
     1504     7674    5                   THEN DO;
     1505     7675    5                       CALL CONCAT(LIST_STRING,'     +               ',
     1506     7676    5                          TYPE_400.LAST_FILLER_TEXT,',');
     1507     7677    5                       CALL WRITE_UWA;
     1508     7678    5                       SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;
     1509     7679    5                       UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;
     1510     7680    5                       CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(
     1511     7681    5                          0),TYPE_400.LAST_FILLER_TEXT);
     1512     7682    5                       CALL SET_FIELD_NUM(1,TYPE_400.LAST_FILLER_LEN);
     1513     7683    5                       CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,
     1514     7684    5                          '*',SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
     1515     7685    5                       CALL WRITE_UWA;
     1516     7686    5                       NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;
     1517     7687    5                       UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;
     1518     7688    5                       END;
     1519     7689    4                   END;
     1520     7690    3           CASE (42);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:50   
     1521     7691        /*
     1522     7692              Area within clause in the subschema.
     1523     7693        */
     1524     7694    3               IF RECORD_FOUND
     1525     7695    3               THEN CALL ZIG$V_AREA_REC;
     1526     7696    3           CASE (43);
     1527     7697        /*
     1528     7698              Field that is under the current record in the schema.
     1529     7699        */
     1530     7700    3               IF RECORD_FOUND
     1531     7701    4               THEN DO;
     1532     7702    4                   CALL ZIG$V_FIELD;
     1533     7703    4                   IF SUB_LANGUAGE = #FORTRAN
     1534     7704    5                   THEN DO;
     1535     7705    5                       CALL INDEX1(I,' ',TYPE_430.SUB_FIELD_NAME);
     1536     7706    5                       CALL CONCAT(LIST_STRING,'     +               ',
     1537     7707    5                          SUBSTR(TYPE_430.SUB_FIELD_NAME,0,I+1),',');
     1538     7708    5                       CALL WRITE_UWA;
     1539     7709    5                       SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;
     1540     7710    5                       UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;
     1541     7711    5                       CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(
     1542     7712    5                          TYPE_430.DATA_TYPE),TYPE_430.SUB_FIELD_NAME);
     1543     7713    5                       IF TYPE_430.DATA_TYPE = 0
     1544     7714    6                       THEN DO;
     1545     7715    6                           CALL SET_FIELD_NUM(1,TYPE_430.LEN_FIELD);
     1546     7716    6                           CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,
     1547     7717    6                              '*',SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
     1548     7718    6                           END;
     1549     7719    5                       CALL WRITE_UWA;
     1550     7720    5                       NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;
     1551     7721    5                       UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;
     1552     7722    5                       IF TYPE_430.FLAGS.TYPE = '000000010000'B
     1553     7723    6                       THEN DO;
     1554     7724    6                           CALL WRITE_RVA(3,FR.UOFST.EIS.FRID);
     1555     7725    6                           END;
     1556     7726    5                       END;
     1557     7727    4                   END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:51   
     1558     7728    3               END;
     1559     7729    2           CURRENT_RECORD = CURRENT_RECORD + 1;
     1560     7730    2           CALL READSF(CURRENT_RECORD,IO_BUF);
     1561     7731    2           END;
     1562     7732    1       IF ERROR_READ64 = 1
     1563     7733    2       THEN DO;
     1564     7734    2           CALL ERROR(%ZIG_V_BAD_SUBSCHEMA_FILE);
     1565     7735        /*E*     ERROR:    ZIG-ZIG_V_BAD_SUBSCHEMA_FILE-C
     1566     7736        MESSAGE: The subschema file is not in the correct format.
     1567     7737                 One of the following must have happened:
     1568     7738                 1 -  The subschema translation aborted so rerun the subschema
     1569     7739                    translation.
     1570     7740                 2 -  The subschema was edited and some internal record(s) deleted
     1571     7741                    so retranslate the subschema and try again.
     1572     7742                 3 -  Internal error. The translator and the validator have
     1573     7743                    problems. Report via Starlog.
     1574     7744        */
     1575     7745    2           CALL ABORT;
     1576     7746    2           END;
     1577     7747    1       IF LAST_RC ~= 1 AND RECORD_FOUND
     1578     7748    2       THEN DO;
     1579     7749        /*
     1580     7750              Now check the last record to see if all the item
     1581     7751            have been given and what can be done to this record.
     1582     7752        */
     1583     7753    2           CALL ZIG$V_CHECK_F;
     1584     7754    2           END;
     1585     7755        /*
     1586     7756              Now put in the *SYSTEM record and the *DBPARAM record into
     1587     7757            the schema subset and write the things out to the UWA and RVA
     1588     7758            section if FORTRAN.
     1589     7759        */
     1590     7760    1       LAST_RECORD_REF_LINE = 0;
     1591     7761    1       CALL ZIG$ZERO_ALT_TABLE;
     1592     7762        /*W*
     1593     7763            VALIDS.RECORD_XREF is now set off because all the record
     1594     7764            information has been put out and if it isn't the ZIG$V_CHECK_F
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:52   
     1595     7765            will put out information that is useless.
     1596     7766        */
     1597     7767    1       VALIDS.RECORD_XREF = '0'B;
     1598     7768    1       CALL ADD_SPECIAL_REC;
     1599     7769
     1600     7770        /*
     1601     7771              Now go throw all the sets in the subschema and put in all
     1602     7772            the required records for that set. Also all the fields for that
     1603     7773            record must be added.
     1604     7774        */
     1605     7775    1       IF FIRST_SET AND VALIDS.SET_XREF
     1606     7776    2       THEN DO;
     1607     7777    2           CALL SUBLST(HEAD_SET_XREF);
     1608     7778    2           FIRST_SET = '0'B;
     1609     7779    2           END;
     1610     7780    1       LAST_SC_SAVE= OA.OASCN;
     1611     7781    2       DO WHILE (LAST_SC_SAVE ~= 0);
     1612     7782    2           SC$ = PINCRW(SSS$,LAST_SC_SAVE);
     1613     7783    2           SC1$ = PINCRW(SSS$,LAST_SC_SAVE - 2);
     1614     7784    2           IF VALIDS.SET_XREF AND ~SC.DEF.SNSS AND SC.DEF.SETT ~= 2 AND
     1615     7785    2              SC.DEF.SETT ~= 3
     1616     7786    3           THEN DO;
     1617     7787    3               RS$ = PINCRW(SSS$,SC.SCRSN);
     1618     7788    3               RS$ = PINCRW(SSS$,RS.SCRSN);
     1619     7789        /*
     1620     7790                   Get a set member.
     1621     7791        */
     1622     7792    3               LIST_STRING = ' ';
     1623     7793    3               CALL LIST(LIST_STRING);
     1624     7794    3               CALL CONCAT(LIST_STRING,'     SET NAME IS ',SC.SNAM);
     1625     7795    3               CALL LIST(LIST_STRING);
     1626     7796    3               LIST_STRING = '          SET IS PRIOR PROCESSABLE';
     1627     7797    3               CALL LIST(LIST_STRING);
     1628     7798    3               LIST_STRING = '          ORDER IS PERMANENT';
     1629     7799    3               CALL LIST(LIST_STRING);
     1630     7800    3               CALL CONCAT(LIST_STRING,'          IMPLEMENTATION MODE IS ',
     1631     7801    3                  MODE_OF_SET(SC.DEF.SETM));
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:53   
     1632     7802    3               CALL LIST(LIST_STRING);
     1633     7803    3               IF SC.DEF.SETO = 4
     1634     7804    4               THEN DO;
     1635     7805    4                   LIST_STRING='          INSERTION IS SORTED BY DEFINED KEYS';
     1636     7806    4                   CALL LIST(LIST_STRING);
     1637     7807    4                   CALL CONCAT(LIST_STRING,'               DUPLICATES ARE ',
     1638     7808    4                      DUP_TEXT(RS.DEF.DORD));
     1639     7809    4                   CALL LIST(LIST_STRING);
     1640     7810    4                   END;
     1641     7811    4               ELSE DO;
     1642     7812    4                   CALL CONCAT(LIST_STRING,'          INSERTION IS ',
     1643     7813    4                      SET_ORDER(SC.DEF.SETO));
     1644     7814    4                   CALL LIST(LIST_STRING);
     1645     7815    4                   END;
     1646     7816    3               T2PTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;
     1647     7817    3               T7PTR$ = PINCRW(SSS$,T2PTR$ -> SET_HASH.SO.OFFSET);
     1648     7818    3               T8PTR$ = PINCRW(SSS$,T7PTR$ -> RS.RCRSH);
     1649     7819    3               IF ~T8PTR$ -> RC.DEF.SR AND T8PTR$ ~= SSS$
     1650     7820    3               THEN CALL CONCAT(LIST_STRING,'          SET OWNER IS ',
     1651     7821    3                      T8PTR$ -> RC.RNAM);
     1652     7822    3               ELSE LIST_STRING = '          OWNER IS NOT PRESENT IN SUBSCHEMA';
     1653     7823    3               CALL LIST(LIST_STRING);
     1654     7824    3               NO_MEMBERS_IN_SUBSCHEMA = '1'B;
     1655     7825    4               DO I = 0 TO T2PTR$ -> SET_HASH.NUM_SM - 1;
     1656     7826    4                   T7PTR$ = PINCRW(SSS$,T2PTR$ -> SET_HASH.SM_LIST.OFFSET(I));
     1657     7827    4                   T8PTR$ = PINCRW(SSS$,T7PTR$ -> RS.RCRSH);
     1658     7828    4                   IF ~T8PTR$ -> RC.DEF.SR AND SSS$ ~= T8PTR$
     1659     7829    5                   THEN DO;
     1660     7830    5                       NO_MEMBERS_IN_SUBSCHEMA = '0'B;
     1661     7831    5                       CALL CONCAT(LIST_STRING,'          MEMBER IS ',
     1662     7832    5                          T8PTR$ -> RC.RNAM);
     1663     7833    5                       CALL LIST(LIST_STRING);
     1664     7834    5                       IF T7PTR$ -> RS.DEF.OSM
     1665     7835    5                       THEN K = 2;
     1666     7836    5                       ELSE K = 0;
     1667     7837    5                       IF T7PTR$ -> RS.DEF.MSM
     1668     7838    5                       THEN K = K + 1;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:54   
     1669     7839    5                       LIST_STRING = MAN_OPT(K);
     1670     7840    5                       CALL LIST(LIST_STRING);
     1671     7841    5                       IF SC.DEF.SETO = 4 OR SC.DEF.SETO = 6
     1672     7842    6                       THEN DO;
     1673     7843    6                           T8PTR$ = PINCRW(SSS$,T7PTR$ -> RS.RSCDN);
     1674     7844    7                           DO WHILE (T8PTR$ ~= SSS$);
     1675     7845    7                               T9PTR$ = PINCRW(SSS$,T8PTR$ -> CD.CDSH);
     1676     7846    7                               IF T9PTR$ ~= SSS$
     1677     7847    8                               THEN DO;
     1678     7848    8                                   IF T9PTR$ -> FR.FNL = 0
     1679     7849    9                                   THEN DO;
     1680     7850    9                                       T9PTR$ = PINCRW(T9PTR$,-1);
     1681     7851    9                                       K = T9PTR$ -> FR1.NLIND;
     1682     7852    9                                       CALL READSF(K,IO_BUF);
     1683     7853    9                                       FIELD_NAME = TYPE_430.SUB_FIELD_NAME;
     1684     7854    9                                       END;
     1685     7855    9                                   ELSE DO;
     1686     7856    9                                       FIELD_NAME = T9PTR$ -> FR.FNAM;
     1687     7857    9                                       END;
     1688     7858    8                                   IF T8PTR$ -> CD.DEF.CONT
     1689     7859    8                                   THEN
     1690     7860    8                                       CALL CONCAT(LIST_STRING,
              7860                                                '               KEY IS DESCENDING ',
     1691     7861    8                                          FIELD_NAME);
     1692     7862    8                                   ELSE CALL CONCAT(LIST_STRING,
     1693     7863    8                                          '               KEY IS ASCENDING ',FIELD_NAME
              7863                                                   );
     1694     7864    8                                   CALL LIST(LIST_STRING);
     1695     7865    8                                   END;
     1696     7866    7                               T8PTR$ = PINCRW(SSS$, T8PTR$ -> CD.RSCDN);
     1697     7867    7                               END;
     1698     7868    6                           END;
     1699     7869    5                       END;
     1700     7870    4                   END;
     1701     7871    3               IF NO_MEMBERS_IN_SUBSCHEMA
     1702     7872    4               THEN DO;
     1703     7873    4                   LIST_STRING =
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:55   
              7873                       '          THE USAGE OF THIS SET DOES NOT REQUIRE ANY MEMBER RECORDS'
              7873                            ;
     1704     7874    4                   CALL LIST(LIST_STRING);
     1705     7875    4                   END;
     1706     7876    3               END;
     1707     7877    2           T2PTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;
     1708     7878    2           IF T2PTR$ -> SET_HASH.SO.DBK > 0
     1709     7879    3           THEN DO;
     1710     7880    3               DBK = T2PTR$ -> SET_HASH.SO.DBK;
     1711     7881    3               CALL FINDD_6('SO  ',DBK) ALTRET (DBCS_ERR);
     1712     7882    3               CALL FETCHOS_6('RC-SOSM ') ALTRET (DBCS_ERR);
     1713     7883    3               CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);
     1714     7884    3               TYPE_400.TYPE = 400;
     1715     7885    3               TYPE_400.RECORD_NAME = UWA.SN.SENAME;
     1716     7886    3               TYPE_400.SUB_RECORD_NAME = UWA.SN.SENAME;
     1717     7887    3               CALL CHANGE_TO_STR(TYPE_400.SUB_RECORD_NAME);
     1718     7888    3               TYPE_400.REF_LINE = 0;
     1719     7889    3               TYPE_400.ID_NUM = 0;
     1720     7890    3               CALL ZIG$V_RECORD;
     1721     7891    3               IF SUBSTR(RC.RNAM,0,1) ~= '*'
     1722     7892    4               THEN DO;
     1723     7893    4                   RC.DEF.RERS = '1'B;
     1724     7894    4                   RC.DEF.RSTO = '1'B;
     1725     7895    4                   RC.DEF.RERA = '1'B;
     1726     7896    4                   RC.DEF.SR = '1'B;
     1727     7897    4                   END;
     1728     7898    3               IF SUBSTR(RC.RNAM,0,1) = '*'
     1729     7899    4               THEN DO;
     1730     7900    4                   RC.DEF.SR = '1'B;
     1731     7901    4                   END;
     1732     7902    3               CALL ZIG$V_CHECK_F;
     1733     7903    3               CALL ZIG$ZERO_ALT_TABLE;
     1734     7904    3               SC$ = PINCRW(SSS$,LAST_SC_SAVE);
     1735     7905    3               SC1$ = PINCRW(SSS$,LAST_SC_SAVE -2 );
     1736     7906    3               END;
     1737     7907    3           DO I = 0 TO T2PTR$ -> SET_HASH.NUM_SM - 1;
     1738     7908    3               IF T2PTR$ -> SET_HASH.SM_LIST.DBK(I) > 0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:56   
     1739     7909    4               THEN DO;
     1740     7910    4                   DBK = T2PTR$ -> SET_HASH.SM_LIST.DBK(I);
     1741     7911    4                   CALL FINDD_6('SM  ',DBK) ALTRET (DBCS_ERR);
     1742     7912    4                   CALL FETCHOS_6('RC-SOSM ') ALTRET (DBCS_ERR);
     1743     7913    4                   CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);
     1744     7914    4                   TYPE_400.TYPE = 400;
     1745     7915    4                   TYPE_400.RECORD_NAME = UWA.SN.SENAME;
     1746     7916    4                   TYPE_400.SUB_RECORD_NAME = UWA.SN.SENAME;
     1747     7917    4                   CALL CHANGE_TO_STR(TYPE_400.SUB_RECORD_NAME);
     1748     7918    4                   TYPE_400.REF_LINE = 0;
     1749     7919    4                   TYPE_400.ID_NUM = 0;
     1750     7920    4                   CALL ZIG$V_RECORD;
     1751     7921    4                   IF SUBSTR(RC.RNAM,0,1) ~= '*'
     1752     7922    5                   THEN DO;
     1753     7923    5                       RC.DEF.RERS = '1'B;
     1754     7924    5                       RC.DEF.RSTO = '1'B;
     1755     7925    5                       RC.DEF.RERA = '1'B;
     1756     7926    5                       RC.DEF.SR = '1'B;
     1757     7927    5                       RC.DEF.FLAG_OWNER = '1'B;
     1758     7928    5                       END;
     1759     7929    4                   IF SUBSTR(RC.RNAM,0,1) = '*'
     1760     7930    5                   THEN DO;
     1761     7931    5                       RC.DEF.SR = '1'B;
     1762     7932    5                       END;
     1763     7933    4                   CALL ZIG$V_CHECK_F;
     1764     7934    4                   CALL ZIG$ZERO_ALT_TABLE;
     1765     7935    4                   SC$ = PINCRW(SSS$,LAST_SC_SAVE);
     1766     7936    4                   SC1$ = PINCRW(SSS$,LAST_SC_SAVE -2 );
     1767     7937    4                   END;
     1768     7938    3               END;
     1769     7939    2           LAST_SC_SAVE = SC.OASCN;
     1770     7940    2           END;
     1771     7941        /*
     1772     7942            Call FLAG_OWNER routine only after all the records have been
     1773     7943            processed by ZIG$V_RECORD.  In the case of partial subschemas
     1774     7944            this means the implied records as well as those specifically
     1775     7945            used in the subschema.
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:57   
     1776     7946        */
     1777     7947    1       LAST_SC_SAVE = OA.OASCN;
     1778     7948    2       DO WHILE ( LAST_SC_SAVE ~= 0 );
     1779     7949    2           SC$ = PINCRW( SSS$, LAST_SC_SAVE );
     1780     7950    2           SC1$ = PINCRW( SSS$, LAST_SC_SAVE - 2 );
     1781     7951    2           T2PTR$ = ADDR( SC1.XXDPN )->BASED_PTR$;
     1782     7952
     1783     7953    3           DO I = 0 TO T2PTR$->SET_HASH.NUM_SM - 1;
     1784     7954    3               T9PTR$ = PINCRW( SSS$, T2PTR$->SET_HASH.SM_LIST.OFFSET( I ) );
     1785     7955    3               T9PTR$ = PINCRW( SSS$, T9PTR$->RS.RCRSH ); /* Ptr to RC */
     1786     7956    3               IF T9PTR$->RC.DEF.FLAG_OWNER
     1787     7957    4               THEN DO;
     1788     7958        /*
     1789     7959            Only want to process each record once so turn off the flag that
     1790     7960            was originally set to tell us to process this record.
     1791     7961        */
     1792     7962    4                   T9PTR$->RC.DEF.FLAG_OWNER = '0'B;
     1793     7963    4                   T9PTR$ = PINCRW( SSS$, T2PTR$->SET_HASH.SO.OFFSET );
     1794     7964    4                   CALL FLAG_OWNER( T9PTR$ );
     1795     7965    4                   END;
     1796     7966    3               END;
     1797     7967    2           LAST_SC_SAVE = SC.OASCN;
     1798     7968    2           END;
     1799     7969        /*
     1800     7970              Now put in the CF connections for the schema subset.
     1801     7971        */
     1802     7972    1       RC$ = PINCRW(SSS$, OA.OARCN);
     1803     7973    2       DO WHILE (RC$ ~= SSS$);
     1804     7974    2           RC.DEF.RSTO = '0'B;
     1805     7975    2           FR$ = PINCRW(SSS$,RC.RCFRN);
     1806     7976    3           DO WHILE (SSS$ ~= FR$ );
     1807     7977    3               IF FR.UOFST.EIS.REG = 0
     1808     7978    4               THEN DO;
     1809     7979    4                   CALL FETCHD_6('FR  ',FR.UOFST) ALTRET (DBCS_ERR);
     1810     7980    4                   FR_DBK = UWA.DIRECT_REF;
     1811     7981    4                   CALL FETCHOS_6('RC-FR   ') ALTRET (DBCS_ERR);
     1812     7982    4                   CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:58   
     1813     7983    4                   STATUS = #RECORD_DEF;
     1814     7984    4                   ALLOCATE_END = 1;
     1815     7985    4                   HASH_SCHEMA_NAME = '1'B;
     1816     7986    4                   CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,ERROR_FLG,
     1817     7987    4                      0,1,14,T5PTR$,STATUS);
     1818     7988    4                   ALLOCATE_END = 0;
     1819     7989    4                   IF ERROR_FLG = 0
     1820     7990    5                   THEN DO;
     1821     7991    5                       T5PTR$ = RC$;
     1822     7992    5                       T6PTR$ = FR$;
     1823     7993    5                       TYPE_400.TYPE = 400;
     1824     7994    5                       TYPE_400.RECORD_NAME = UWA.SN.SENAME;
     1825     7995    5                       TYPE_400.SUB_RECORD_NAME = UWA.SN.SENAME;
     1826     7996    5                       CALL CHANGE_TO_STR(TYPE_400.SUB_RECORD_NAME);
     1827     7997    5                       TYPE_400.REF_LINE = 0;
     1828     7998    5                       TYPE_400.ID_NUM = 0;
     1829     7999    5                       CALL ZIG$V_RECORD;
     1830     8000    5                       IF SUBSTR(RC.RNAM,0,1) ~= '*'
     1831     8001    6                       THEN DO;
     1832     8002    6                           RC.DEF.RERS = '1'B;
     1833     8003    6                           RC.DEF.RSTO = '1'B;
     1834     8004    6                           RC.DEF.RERA = '1'B;
     1835     8005    6                           RC.DEF.SR = '1'B;
     1836     8006    6                           END;
     1837     8007    5                       IF SUBSTR(RC.RNAM,0,1) = '*'
     1838     8008    6                       THEN DO;
     1839     8009    6                           RC.DEF.SR = '1'B;
     1840     8010    6                           END;
     1841     8011    5                       CALL ZIG$V_CHECK_F;
     1842     8012    5                       CALL ZIG$ZERO_ALT_TABLE;
     1843     8013    5                       RC.DEF.SR = '1'B;
     1844     8014    5                       TPTR$ = PINCRW(SSS$, RC.RCFRN);
     1845     8015    5                       RC$ = T5PTR$;
     1846     8016    5                       FR$ = T6PTR$;
     1847     8017    5                       CALL FETCHD_6('FR  ',FR_DBK);
     1848     8018    5                       END;
     1849     8019    5                   ELSE DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:59   
     1850     8020    5                       T5PTR$ = PINCRW(SSS$, T5PTR$ -> RECORD_HASH.SUB_OFF);
     1851     8021    5                       TPTR$ = PINCRW(SSS$,T5PTR$ -> RC.RCFRN);
     1852     8022    5                       END;
     1853     8023    4                   T5PTR$ = PINCRW(TPTR$, -1);
     1854     8024    5                   DO WHILE(TPTR$ ~= SSS$ AND T5PTR$ -> FR1.XXDPN
     1855     8025    5                      ~= FR_DBK );
     1856     8026    5                       TPTR$ = PINCRW(SSS$, TPTR$ -> FR.RCFRN);
     1857     8027    5                       T5PTR$ = PINCRW(TPTR$, -1);
     1858     8028    5                       END;
     1859     8029    4                   IF TPTR$ = SSS$ THEN CALL ABORT;
     1860     8030    4                   FR.UOFST = TPTR$ -> FR.UOFST;
     1861     8031    4                   FR.DEF.ENDX = TPTR$ -> FR.DEF.ENDX;
     1862     8032    4                   FR.DEF.DNDX = TPTR$ -> FR.DEF.DNDX;
     1863     8033    4                   IF FR.DEF.SYN
     1864     8034    4                   THEN FR.DEF.FSR = '1'B;
     1865     8035    4                   ELSE FR.DEF.FSR = TPTR$ -> FR.DEF.FSR;
     1866     8036    4                   FR.DEF.FVF = TPTR$ -> FR.DEF.FVF;
     1867     8037    4                   FR.DEF.COMC = TPTR$ -> FR.DEF.COMC;
     1868     8038    4                   FR.DEF.EBCL = TPTR$ -> FR.DEF.EBCL;
     1869     8039    4                   FR.DEF.EBCM = TPTR$ -> FR.DEF.EBCM;
     1870     8040    4                   IF FR.DEF.FUSE = 3 AND NOT RC.DEF.SR
     1871     8041    5                   THEN DO;
     1872     8042    5                       IF TPTR$ -> FR.FNL = 0
     1873     8043    6                       THEN DO;
     1874     8044    6                           T9PTR$ = PINCRW(TPTR$, -1);
     1875     8045    6                           K = T9PTR$ -> FR1.NLIND;
     1876     8046    6                           CALL READSF(K,IO_BUF);
     1877     8047    6                           TYPE_37.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;
     1878     8048    6                           END;
     1879     8049    6                       ELSE DO;
     1880     8050    6                           TYPE_37.SUB_FIELD_NM = TPTR$ -> FR.FNAM;
     1881     8051    6                           END;
     1882     8052    5                       TYPE_37.SUB_RECORD_ST_NM = RC.RNAM;
     1883     8053    5                       T9PTR$ = PINCRW(SSS$, TPTR$ -> FR.RCFRH);
     1884     8054    5                       TYPE_37.SUB_RECORD_NM = T9PTR$ -> RC.RNAM;
     1885     8055    5                       TYPE_37.RECORD_NAME = RC.RCID;
     1886     8056    5                       CALL UPUT('5*',ADDR(TYPE_37),32);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:60   
     1887     8057    5                       CONTROL.NUM_FIELD_SET = CONTROL.NUM_FIELD_SET + 1;
     1888     8058    5                       END;
     1889     8059    4                   END;
     1890     8060    3               FR$ = PINCRW(SSS$, FR.RCFRN);
     1891     8061    3               END;
     1892     8062    2           RC$ = PINCRW(SSS$, RC.OARCN);
     1893     8063    2           END;
     1894     8064        /*
     1895     8065              Now connect up the SS records for the then thru clause in
     1896     8066            in the schema DDL.
     1897     8067        */
     1898     8068    1       LAST_SC_SAVE = OA.OASCN;
     1899     8069    2       DO WHILE (LAST_SC_SAVE ~= 0);
     1900     8070    2           SC$ = PINCRW(SSS$, LAST_SC_SAVE);
     1901     8071    2           SC1$ = PINCRW(SC$ ,-2);
     1902     8072    2           TPTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;
     1903     8073    2           LAST_SMSO_SAVE = SC.SCRSN;
     1904     8074    3           DO WHILE (LAST_SMSO_SAVE ~= 0);
     1905     8075    3               RS$ = PINCRW(SSS$, LAST_SMSO_SAVE);
     1906     8076    3               IF RS.DEF.TYPE = '000000100000'B /* SM */
     1907     8077    4               THEN DO;
     1908     8078    4                   LAST_SS = RS.RSSSN;
     1909     8079    5                   DO WHILE (LAST_SS ~= 0);
     1910     8080    5                       SS$ = PINCRW(SSS$, LAST_SS);
     1911     8081    5                       I = SS.SSH;
     1912     8082    5                       CALL FINDD_6('****',I) ALTRET (DBCS_ERR);
     1913     8083    5                       CALL FINDOS_6('SC-SOSM ') ALTRET (DBCS_ERR);
     1914     8084    5                       IF TPTR$ -> SET_HASH.DBK = UWA.DIRECT_REF
     1915     8085    6                       THEN DO;
     1916     8086    6                           T5PTR$ = TPTR$;
     1917     8087    6                           NEED_TYPE_36_DESC = '0'B;
     1918     8088    6                           END;
     1919     8089    6                       ELSE DO;
     1920     8090    6                           CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);
     1921     8091    6                           STATUS = #SET_DEF;
     1922     8092    6                           ALLOCATE_END = 1;
     1923     8093    6                           HASH_SCHEMA_NAME = '1'B;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:61   
     1924     8094    6                           CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,
     1925     8095    6                              ERROR_FLG,0,1,12,T5PTR$,STATUS);
     1926     8096    6                           ALLOCATE_END = 0;
     1927     8097    6                           IF ERROR_FLG = 0 THEN CALL ABORT;
     1928     8098    6                           NEED_TYPE_36_DESC = '1'B;
     1929     8099    6                           END;
     1930     8100    5                       IF T5PTR$ -> SET_HASH.SO.DBK = -SS.SSH
     1931     8101    5                       THEN SS.SSH = T5PTR$ -> SET_HASH.SO.OFFSET;
     1932     8102    6                       ELSE DO;
     1933     8103    6                           FOUND = '0'B;
     1934     8104    7   SSH_LOOP:               DO I = 0 TO T5PTR$ -> SET_HASH.NUM_SM - 1;
     1935     8105    7                               IF T5PTR$ -> SET_HASH.SM_LIST.DBK(I) = -SS.SSH
     1936     8106    8                               THEN DO;
     1937     8107    8                                   FOUND = '1'B;
     1938     8108    8                                   SS.SSH = T5PTR$ -> SET_HASH.SM_LIST.OFFSET(I);
     1939     8109    8                                   EXIT SSH_LOOP;
     1940     8110    8                                   END;
     1941     8111    7                               END;
     1942     8112    6                           IF ~FOUND THEN CALL ABORT;
     1943     8113    6                           END;
     1944     8114    5                       IF NEED_TYPE_36_DESC
     1945     8115    6                       THEN DO;
     1946     8116    6                           T8PTR$ = PINCRW(SSS$, T5PTR$ -> SET_HASH.SUB_OFF);
     1947     8117    6                           TYPE_36.SET_OWNER_NAME = T8PTR$ -> SC.SCID;
     1948     8118    6                           TYPE_36.SET_NAME = SC.SCID;
     1949     8119    6                           TYPE_36.SUB_SET_OWNER_NM = T8PTR$ -> SC.SNAM;
     1950     8120    6                           TYPE_36.SUB_SET_NM = SC.SNAM;
     1951     8121    6                           T8PTR$ = PINCRW(SSS$, RS.RCRSH);
     1952     8122    6                           TYPE_36.MEM_RECORD_NM = T8PTR$ -> RC.RNAM;
     1953     8123    6                           CONTROL.NUM_SET_SET_DESC = CONTROL.NUM_SET_SET_DESC + 1;
     1954     8124    6                           CALL UPUT('5*',ADDR(TYPE_36),32);
     1955     8125    6                           END;
     1956     8126    5                       LAST_SS = SS.RSSSN;
     1957     8127    5                       END;
     1958     8128    4                   END;
     1959     8129    3               LAST_SMSO_SAVE = RS.SCRSN;
     1960     8130    3               END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:62   
     1961     8131    2           ADDR(SC1.XXDPN) -> WORD36 = 0;
     1962     8132    2           LAST_SC_SAVE = SC.OASCN;
     1963     8133    2           END;
     1964     8134        /*
     1965     8135              Zero out some temp things needed bye DBACS.
     1966     8136        */
     1967     8137        /*
     1968     8138              If fortran then close up the UWA and RVA part of the subschema
     1969     8139            and then in call ZIG$V_DESC to write out the UWA, RVA, and IA for
     1970     8140            the fortran subschema.
     1971     8141        */
     1972     8142    1       IF SUB_LANGUAGE = #FORTRAN
     1973     8143    2       THEN DO;
     1974     8144    2           SPECIAL_KEY = UWA_KEY;
     1975     8145    2           CALL ZIG$SS_RVAR;
     1976     8146    2           IF ERROR_IO ~= 0 THEN CALL ABORT;
     1977     8147    2           CALL INDEX1(I,',',LIST_STRING) ALTRET(NO_WRITE_AGAIN);
     1978     8148    2           CALL INSERT(LIST_STRING,I,1,' ');
     1979     8149    2           CALL ZIG$SS_WVAR;
     1980     8150    2           IF ERROR_IO ~= 0 THEN CALL ABORT;
     1981     8151    2   NO_WRITE_AGAIN:
     1982     8152    2           LIST_STRING = EOFC;
     1983     8153    2           CALL WRITE_UWA;
     1984     8154    2           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;
     1985     8155    2           UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;
     1986     8156    2           CALL WRITE_UWA;
     1987     8157    2           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;
     1988     8158    2           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;
     1989     8159    2           LIST_STRING = '     +            12O000004000000/';
     1990     8160    2           CALL JUST_WRITE_RVA;
     1991     8161    2           LIST_STRING = EOFC;
     1992     8162    2           CALL JUST_WRITE_RVA;
     1993     8163    2           SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;
     1994     8164    2           RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;
     1995     8165    2           CALL JUST_WRITE_RVA;
     1996     8166    2           NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;
     1997     8167    2           RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:63   
     1998     8168    2           CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-3);
     1999     8169    2           CALL INSERT(RVA_NAME,0,1,' ');
     2000     8170    2           CALL CONCAT(TEMP_WORD,RVA_NAME,'0:',SUBSTR(FIELD1.TEXT1,0,
     2001     8171    2              FIELD1.COUNT1),')');
     2002     8172    2           CALL CONCAT(LIST_STRING,'       COMMON /R',SUBSCHEMA_NAME_4,
     2003     8173    2              '/ ',TEMP_WORD);
     2004     8174    2           RVA_KEY.NUMBER_OF = 0;
     2005     8175    2           CALL JUST_WRITE_RVA;
     2006     8176    2           CALL GET_OCTAL_NUM(18,SAVE_LAST_RVA - 3);
     2007     8177    2           CALL CONCAT(TEMP_WORD,'/12O',SUBSTR(FIELD1.TEXT1,0,6),'000000,');
     2008     8178    2           CALL CONCAT(LIST_STRING,'      DATA R',SUBSCHEMA_NAME_4,
     2009     8179    2              TEMP_WORD);
     2010     8180    2           CALL JUST_WRITE_RVA;
     2011     8181    2           RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;
     2012     8182    2           LIST_STRING = EOFC;
     2013     8183    2           CALL JUST_WRITE_RVA;
     2014     8184    2           NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;
     2015     8185    2           RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;
     2016     8186        /*
     2017     8187              The RVA and UWA are now written out into the subschema file
     2018     8188            so now call the writer for the fortran include file.
     2019     8189        */
     2020     8190    2           END;
     2021     8191    1       NUM_PROHIB = 0;
     2022     8192    1       IF NO_ERRORS
     2023     8193    2       THEN DO;
     2024     8194    2           IF VALIDS.XLST
     2025     8195    2           THEN CALL ZIG$V_PROHIB;
     2026     8196    2           IF VALIDS.ICLST
     2027     8197    2           THEN CALL ZIG$V_PERMIT;
     2028     8198    2           END;
     2029     8199        /*
     2030     8200              Every thing is done.
     2031     8201            the schema subset is pointed to by the array of pointers
     2032     8202            SUBSET$ and all diagonistes have been written out.
     2033     8203        */
     2034     8204    1       CALL SET_FIELDS(1,30,CONTROL.SUBSCHEMA_NAME);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:64   
     2035     8205    1       CALL SET_FIELDS(2,30,CONTROL.SCHEMA_NAME);
     2036     8206    1       IF NO_ERRORS
     2037     8207    2       THEN DO;
     2038     8208    2           CONTROL.VALIDATION_STATUS = 30;
     2039     8209    2           CALL ZIG$FIN_AS;
     2040     8210    2           CALL INFO_ONLY(%VALIDATION_OK);
     2041     8211        /*E*     ERROR:    ZIG-VALIDATION_OK-C
     2042     8212        MESSAGE: Validation for the subschema %U1
     2043     8213                 ( schema %U2 ) had no errors.
     2044     8214        */
     2045     8215    2           END;
     2046     8216    2       ELSE DO;
     2047     8217    2           CALL SET_FIELD_NUM(3,NUM_ERROR_MSG);
     2048     8218    2           CALL ERROR(%VALIDATION_NOT_OK);
     2049     8219        /*E*     ERROR:    ZIG-VALIDATION_NOT_OK-C
     2050     8220        MESSAGE: Validation for the subschema %U1
     2051     8221                 ( schema %U2 ) had %U3 errors.
     2052     8222                 The subschema %U1 cannot be used in
     2053     8223                 any DATA BASE programs until the errors have
     2054     8224                 been corrected.
     2055     8225        */
     2056     8226    2           CONTROL.VALIDATION_STATUS = -1;
     2057     8227    2           END;
     2058     8228    1       IF NUM_WARN_MSG - NUM_PROHIB ~= 0
     2059     8229    2       THEN DO;
     2060     8230    2           CALL SET_FIELD_NUM(1,NUM_WARN_MSG - NUM_PROHIB);
     2061     8231    2           CALL INFO_ONLY(%VALIDATION_WARN_MSG);
     2062     8232        /*E*     ERROR:    ZIG-VALIDATION_WARN_MSG-C
     2063     8233        MESSAGE: %U1 Warning messages for this validation.
     2064     8234        */
     2065     8235    2           END;
     2066     8236    1       IF NUM_PROHIB ~= 0
     2067     8237    2       THEN DO;
     2068     8238    2           CALL SET_FIELD_NUM(1,NUM_PROHIB);
     2069     8239    2           CALL INFO_ONLY(%VALIDATION_PROHIB_MSG);
     2070     8240        /*E*     ERROR:    ZIG-VALIDATION_PROHIB_MSG-C
     2071     8241        MESSAGE: %U1 Prohibited messages for this validation.
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:65   
     2072     8242        */
     2073     8243    2           END;
     2074     8244    1       CALL WRITSF(CUR_EXT_NAME_SEG,EOFC);
     2075     8245    1       CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;
     2076     8246    1       CALL WRITSF(CUR_EXT_NAME_SEG,EOFC);
     2077     8247    1       CONTROL.NEXT_AVAILABLE_RECORD = CUR_EXT_NAME_SEG + 1;
     2078     8248    1       CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;
     2079     8249    1       CALL UCLOSE ('5*');
     2080     8250    1       CALL UOPEN ('5*',0);
     2081     8251    1       CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);
     2082     8252    2       DO WHILE (EOF = 0);
     2083     8253    2           CALL WRITSF(CUR_EXT_NAME_SEG,BUFFER_TEMP);
     2084     8254    2           CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;
     2085     8255    2           CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);
     2086     8256    2           END;
     2087     8257    1       CALL UCLOSE('5*');
     2088     8258        /*
     2089     8259              Write out the type 34, 35, and 36 descriptors that should be in
     2090     8260            the name ext segment but COBOL can't handle them there so we have
     2091     8261            to fool cobol and write out a dumn end of segment when the segment
     2092     8262            isn't ended yet.
     2093     8263        */
     2094     8264    1       CALL WRITSF(CUR_EXT_NAME_SEG,EOFC);
     2095     8265    1       CONTROL.NEXT_AVAILABLE_RECORD = CUR_EXT_NAME_SEG + 1;
     2096     8266        /*
     2097     8267              End the extened name segment and set the next available record
     2098     8268            to one past there.
     2099     8269        */
     2100     8270    1       CALL ZIG$G_DYN_MEM_6(0,TEMP_PTR$);
     2101     8271    1       OA.SZISS = MEMORY_USED_SSS;
     2102     8272    1       OA.UWSSZ = OA.SZISS;
     2103     8273    1       OA.KPASZ = (LARGEST_KEY+3)/4;
     2104     8274    1       OA.LRSZ = (OA.LRSZ+3)/4;
     2105     8275    1       OA.CIWSOF = OA.CSZ + %CUR_BASE_SIZE;
     2106     8276    1       OA.CSZ = OA.CSZ + OA.KPASZ + 1;
     2107     8277    1       IF MOD(OA.UWSZ,4) ~= 0
     2108     8278    1       THEN OA.UWSZ = (OA.UWSZ + 4 - MOD(OA.UWSZ,4))/4;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:66   
     2109     8279    1       ELSE OA.UWSZ = OA.UWSZ/4;
     2110     8280    1       SUBSCHEMA_KEY = ' SSS KEY';
     2111     8281    1       SPECIAL_KEY.COUNT = 7;
     2112     8282    1       BUFFER$ = SSS$;
     2113     8283    1       BUFFER_LEN = (OA.SZISS * 4) - 1;
     2114     8284    1       CALL ZIG$SS_WVAR;
     2115     8285    1       CONTROL.FIRST_ISS_BLOCK = OA.SZISS;
     2116     8286    1       CONTROL.UWA_SIZE = OA.UWSZ;
     2117     8287    1       CONTROL.NEXT_UWA_LOC = CONTROL.UWA_SIZE * 4;
     2118     8288    1       CALL WRIT64(0,ADDR(CONTROL));
     2119     8289    1       IF SUB_LANGUAGE = #FORTRAN
     2120     8290    2       THEN DO;
     2121     8291    2           CALL ZIG$V_DESC;
     2122     8292    2           END;
     2123     8293    1       RETURN;
     2124     8294    1   DBCS_ERR:
     2125     8295    1       CALL ABORT;
     2126     8296    1       RETURN;
     2127     8297
     2128     8298    1   END ZIG$V_DRIVER;
     2129     8299        %EOD;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:67   
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_DRIVER.

   Procedure ZIG$V_DRIVER requires 3697 words for executable code.
   Procedure ZIG$V_DRIVER requires 30 words of local(AUTO) storage.

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:68   

 Object Unit name= ZIG$V_DRIVER                               File name= ZIG$V_DRIVER.:ZIC0TOU
 UTS= SEP 05 '97 12:19:41.84 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     8     10  SCHEMA_NAME
    1  LblCom even  none     8     10  SUBSCHEMA_NAME
    2  LblCom even  none     1      1  NO_ERRORS
    3  LblCom even  none     1      1  NUM_PROHIB
    4   Data  even  none   155    233  ZIG$V_DRIVER
    5  LblCom even  none     1      1  LAST_AC
    6  LblCom even  none     1      1  LAST_SC
    7  LblCom even  none     1      1  LAST_RC
    8  LblCom even  none     1      1  LAST_FR
    9  LblCom even  none    32     40  EOFC
   10  LblCom even  none     1      1  RECORD_NUM
   11  LblCom even  none     1      1  CF_PTR$
   12  RoData even  UTS   1002   1752  ZIG$V_DRIVER
   13  LblCom even  none     1      1  IN_GROUP
   14  LblCom even  none     1      1  LAST_GROUP_LEVEL
   15  LblCom even  none     1      1  RECORD_FOUND
   16  LblCom even  none    32     40  LIST_STRING
   17  LblCom even  none     1      1  ERROR_READ64
   18  LblCom even  none     8     10  FIELD1
   19  LblCom even  none     1      1  LAST_RECORD_REF_LINE
   20  LblCom even  none     7      7  BASE_PTR
   21  LblCom even  none     1      1  MEMORY_USED_SSS
   22  LblCom even  none     1      1  LARGEST_KEY
   23  LblCom even  none     1      1  CUR_EXT_NAME_SEG
   24  LblCom even  none   809   1451  ALT_HASH_TABLE
   25  LblCom even  none     1      1  FIRST_FIELD
   26  LblCom even  none     1      1  SUBSCHEMA_NAME_4
   27  LblCom even  none    12     14  ANALS
   28  LblCom even  none    13     15  PURGE
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:69   
   29  LblCom even  none    19     23  DICTS
   30  LblCom even  none    23     27  DISPS
   31  LblCom even  none    22     26  VALIDS
   32  LblCom even  none    12     14  LOCKS
   33  LblCom even  none    10     12  STRAN
   34  LblCom even  none    12     14  DTRAN
   35  LblCom even  none    16     20  SSTRANS
   36  LblCom even  none    20     24  SSGEN
   37  LblCom even  none     1      1  NUM_ERROR_MSG
   38  LblCom even  none     1      1  NUM_WARN_MSG
   39  LblCom even  none     1      1  ALLOCATE_END
   40  LblCom even  none     2      2  SUBSCHEMA_KEY
   41  LblCom even  none     1      1  BUFFER$
   42  LblCom even  none     1      1  ERROR_IO
   43  LblCom even  none     1      1  BUFFER_LEN
   44  LblCom even  none     2      2  UWA_KEY
   45  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   46  LblCom even  none     2      2  RVA_KEY
   47  LblCom even  none     2      2  IA__KEY
   48  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   49  LblCom even  none    32     40  SEARCHR_NB
   50  LblCom even  none    32     40  SEM_COM
   51  LblCom even  none    32     40  DMCL_XLATE
   52  LblCom even  none    32     40  Q2_PERCENT
   53  LblCom even  none   106    152  RVA
   54  LblCom even  none   656   1220  UWA
   55  LblCom even  none    32     40  TYPE_9
   56  LblCom even  none     5      5  LANG_ALLOWED
   57  LblCom even  none     1      1  SUB_LANGUAGE
   58  LblCom even  none    16     20  HEADING_TEXT
   59  LblCom even  none    13     15  LANG_TEXT
   60  LblCom even  none     1      1  HASH_SCHEMA_NAME
   61  LblCom even  none     1      1  CURRENT_RECORD
   62  LblCom even  none    32     40  IO_BUF
   63  LblCom even  none    64    100  CONTROL
   64  LblCom even  none    32     40  TYPE_36
   65  LblCom even  none    32     40  TYPE_37
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:70   
   66  LblCom even  none     1      1  SSS$
   67  LblCom even  none     1      1  AC$
   68  LblCom even  none     1      1  AC1$
   69  LblCom even  none     1      1  FR$
   70  LblCom even  none     1      1  FR1$
   71  LblCom even  none     1      1  SC$
   72  LblCom even  none     1      1  SC1$
   73  LblCom even  none     1      1  RC$
   74  LblCom even  none     1      1  RC1$
   75  LblCom even  none     1      1  OA$
   76  LblCom even  none     1      1  OA1$
   77  LblCom even  none     1      1  RA$
   78  LblCom even  none     1      1  RS$
   79  LblCom even  none     1      1  SM1$
   80  LblCom even  none     1      1  SS$
   81  LblCom even  none     1      1  CD$
   82  LblCom even  none     1      1  DP$
   83  LblCom even  none     1      1  DP1$
   84  LblCom even  none     1      1  AG$
   85  LblCom even  none     1      1  AG1$
   86   Proc  even  none  3697   7161  ZIG$V_DRIVER
   87  RoData even  none   145    221  ZIG$V_DRIVER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    86      0   yes            yes      Std        0  ZIG$V_DRIVER
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:71   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 SET_FIELDS
         yes           Std       0 ZIG$V_OA
         yes           Std       0 ZIG$INIT_AS
         yes           Std       2 UOPEN
         yes           Std       0 ZIG$V_FIELD
 yes     yes           Std       1 FETCHOS_6
         yes           Std       4 UGET
 yes     yes           Std       2 FETCHD_6
         yes           Std       3 UPUT
         yes           Std       0 ZIG$V_PERMIT
         yes           Std       2 SET_FIELD_NUM
         yes           Std       0 ZIG$SS_WVAR
         yes           Std       0 ZIG$V_RECORD
         yes           Std       1 INFO_ONLY
 yes     yes           Std       2 FINDD_6
         yes           Std       1 LIST
         yes           Std       0 ZIG$V_PROHIB
         yes           Std       0 ZIG$V_DESC
         yes           Std       1 ERROR
         yes           Std       0 BLD_NM
         yes           Std       2 READSF
         yes           Std       8 ZIG$HASH_IT
         yes           Std       0 ZIG$V_SET
         yes           Std       2 WRITSF
 yes     yes           Std       1 FINDOS_6
         yes           Std       2 SUBLST
         yes           Std       0 ZIG$V_AREA
         yes           Std       0 ZIG$V_AREA_REC
         yes           Std       1 FLAG_OWNER
         yes           Std       0 ABORT
         yes           Std       1 UCLOSE
         yes           Std       2 ZIG$G_DYN_MEM_6
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:72   
         yes           Std       0 ZIG$SS_RVAR
         yes           Std       2 WRIT64
         yes           Std       0 ZIG$ZERO_ALT_TABLE
         yes           Std       0 ZIG$FIN_AS
 yes     yes           Std       1 FCURR_R_6
 yes     yes           Std       1 FETCHNS_6
         yes           Std       1 WARNING
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:73   


        1        1        /*M* ZIG$V_DRIVER     I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*
        8        8        ZZZZZ  III   GGG    $   V   V       DDDD  RRRR   III  V   V EEEEE RRRR
        9        9            Z   I   G   G  $$$  V   V       D   D R   R   I   V   V E     R   R
       10       10           Z    I   G     $ $   V   V       D   D R   R   I   V   V E     R   R
       11       11          Z     I   G      $$$  V   V       D   D RRRR    I   V   V EEEE  RRRR
       12       12         Z      I   G  GG   $ $ V   V       D   D R R     I   V   V E     R R
       13       13        Z       I   G   G  $$$   V V        D   D R  R    I    V V  E     R  R
       14       14        ZZZZZ  III   GGG    $     V         DDDD  R   R  III    V   EEEEE R   R
       15       15                                      _____
       16       16        */
       17       17        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:74   
       18       18        ZIG$V_DRIVER:
       19       19            PROC;

     19 86 000000   000000 700200 xent  ZIG$V_DRIVER TSX0  ! X66_AUTO_0
        86 000001   000036 000000                    ZERO    30,0
        86 000002   002621 710000 86                 TRA     s:7439

       20       20    1   DCL SCHEMA_NAME CHAR (30) EXT;
       21       21    1   DCL SUBSCHEMA_NAME CHAR (30) EXT;
       22       22    1   DCL NO_ERRORS BIT (1) EXT;
       23       23    1   DCL NUM_PROHIB UBIN WORD EXT;
       24       24    1   DCL NEED_TYPE_36_DESC BIT (1) STATIC;
       25       25    1   DCL LAST_AC UBIN (18) EXT;
       26       26    1   DCL LAST_SC UBIN (18) EXT;
       27       27    1   DCL LAST_RC UBIN (18) EXT;
       28       28    1   DCL LAST_FR UBIN (18) EXT;
       29       29    1   DCL EOFC CHAR (128) EXT INIT('/*/*/*/*/*/*');
       30       30    1   DCL RECORD_NUM UBIN (36) EXT;
       31       31    1   DCL CF_PTR$ PTR EXT;
       32       32    1   DCL HEAD_AREA_XREF CHAR (64) CONSTANT INIT ('SUBSCHEMA AREA NAMES.');
       33       33    1   DCL FIRST_AREA BIT (1);
       34       34    1   DCL HEAD_SET_XREF CHAR (64) CONSTANT INIT ('SUBSCHEMA SET NAMES.');
       35       35    1   DCL FIRST_SET BIT (1);
       36       36    1   DCL HEAD_DATA_PAR CHAR (64) CONSTANT INIT ('DATA BASE PARAMETER NAMES.');
       37       37    1   DCL FIRST_DATA_PAR BIT (1);
       38       38    1   DCL HEAD_RECORD_XREF CHAR (64) CONSTANT INIT (
       39       39    1    'RECORD CROSS-REFERENCE WITH UWA ALLOCATION (WORD, BYTE, NIBBLE)');
       40       40    1   DCL FIRST_RECORD BIT (1);
       41       41    1   DCL IN_GROUP BIT (1) EXT;
       42       42    1   DCL LAST_GROUP_LEVEL UBIN (36) EXT;
       43       43    1   DCL RECORD_FOUND BIT (1) EXT;
       44       44    1   DCL TEMP_WORD CHAR (30) STATIC;
       45       45    1   DCL LIST_STRING CHAR (128) EXT;
       46       46    1   DCL NO_MEMBERS_IN_SUBSCHEMA BIT (1);
       47       47    1   DCL ZIG$V_OA ENTRY;
       48       48    1   DCL ZIG$V_AREA ENTRY;
       49       49    1   DCL ZIG$V_SET ENTRY;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:75   
       50       50    1   DCL ZIG$V_RECORD ENTRY;
       51       51    1   DCL ZIG$V_AREA_REC ENTRY;
       52       52    1   DCL ZIG$V_FIELD ENTRY;
       53       53    1   DCL ZIG$V_DESC ENTRY;
       54       54    1   DCL ZIG$V_PROHIB ENTRY;
       55       55    1   DCL ZIG$V_PERMIT ENTRY;
       56       56    1   DCL ZIG$INIT_AS ENTRY;
       57       57    1   DCL ZIG$FIN_AS ENTRY;
       58       58    1   DCL ZIG$ZERO_ALT_TABLE ENTRY;
       59       59    1   DCL FLAG_OWNER ENTRY (1);
       60       60    1   DCL ZIG$HASH_IT ENTRY (8);
       61       61    1   DCL READSF ENTRY (2);
       62       62    1   DCL ERROR_READ64 UBIN (36) EXT;
       63       63    1   DCL WRITSF ENTRY (2);
       64       64    1   DCL WRIT64 ENTRY (2);
       65       65    1   DCL 1 FIELD1 EXT,
       66       66    1         2 COUNT1 UBIN (9) UNAL,
       67       67    1         2 TEXT1 CHAR (31) UNAL;
       68       68    1   DCL LAST_RECORD_REF_LINE UBIN (36) EXT;
       69       69        %EQU DS4 = 3;
       70       70    1   DCL TEMP_PTR$ PTR;
       71       71    1   DCL BASE_PTR(0:6) PTR EXT;
       72       72    1   DCL MEMORY_USED_SSS UBIN WORD EXT;
       73       73    1   DCL LARGEST_KEY UBIN (36) EXT;
       74       74    1   DCL SAVE_BUF CHAR (128) STATIC;
       75       75    1   DCL UNITS_PER_WORD(0:27) CONSTANT UBIN(36) INIT(
       76       76    1    4,4,4,8,8,8,4,4,4,4,
       77       77    1    4,4,4,4,6,4,8,4,6,36,
       78       78    1    4,4,6,6,4,4,4,4);
       79       79    1   DCL NUMERIC(0:27) CONSTANT BIT(1) INIT(
       80       80    1    '0'B*3,
       81       81    1    '1'B*8,
       82       82    1    '0'B*11,
       83       83    1    '1'B*4,
       84       84    1    '0'B*2);
       85       85    1   DCL SYNONYM_CTYPE(0:27) CONSTANT UBIN (36) INIT(
       86       86    1    0,1,2,3,4,5,6,7,8,9,
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:76   
       87       87    1    10,11,12,17*15);
       88       88    1   DCL SYNONYM_FTYPE(0:27) CONSTANT UBIN (36) INIT(
       89       89    1    0,17,2,17*17,20,21,17*4,26,27);
       90       90    1   DCL SYNONYM_APL_TYPE(0:18) CONSTANT UBIN (36) INIT(
       91       91    1    17*3,14*2,17*6,14*2,17*4,14*2);
       92       92    1   DCL SYNONYM_BASIC_TYPE(0:18) CONSTANT UBIN (36) INIT(
       93       93    1    17*3,14*2,17*6,18,14,17*4,14*2);
       94       94    1   DCL SYNONYM_FORTRAN_TYPE(0:18) CONSTANT UBIN (36) INIT(
       95       95    1    17*3,13*2,17*6,13,14,17*4,13,14);
       96       96    1   DCL CUR_EXT_NAME_SEG UBIN (36) EXT;
       97       97    1   DCL AREA_REC_REL BIT (1) STATIC;
       98       98    1   DCL I UBIN (36) STATIC;
       99       99    1   DCL J UBIN (36) STATIC;
      100      100    1   DCL FR_DBK UBIN (36) STATIC;
      101      101    1   DCL STATUS UBIN (6) STATIC;
      102      102    1   DCL T5PTR$ PTR STATIC;
      103      103    1   DCL T6PTR$ PTR STATIC;
      104      104    1   DCL TPTR$ PTR STATIC;
      105      105    1   DCL T4PTR$ PTR STATIC;
      106      106    1   DCL ERROR_FLG UBIN (36) STATIC;
      107      107    1   DCL T2PTR$ PTR STATIC;
      108      108    1   DCL T1PTR$ PTR STATIC;
      109      109    1   DCL ALT_HASH_TABLE (0:808) PTR EXT;
      110      110    1   DCL BITS_52 BIT (52) BASED ALIGNED;
      111      111    1   DCL PV(0:13) CONSTANT ALIGNED BIT(52) INIT(
      112      112    1    '0100001001000000000100000001'B,
      113      113    1    '0100001001000000010000000100000001'B,
      114      114    1    '0100001001000000010000000100000001'B,
      115      115    1    '0100001001000000010000000000000000001'B,
      116      116    1    '0100001001000000010000000100000000001000000000000011'B,
      117      117    1    '0100001001000000010000000100000100000000000000000011'B,
      118      118    1    '01000010010000000100000000010000'B,
      119      119    1    '0100001001000000010000000101000000000000000000000100'B,
      120      120    1    '0100001001000000010000000101000000000000000000000011'B,
      121      121    1    '0100001001000000010000000101000000000000000000000010'B,
      122      122    1    '0100001001000000010000000101000000000000000000000001'B,
      123      123    1    '010000100100000001000000010001'B,
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:77   
      124      124    1    '0100001001000000010000000100001'B,
      125      125    1    '0100001001000000000100000001'B);
      126      126    1   DCL SSCALE SBIN (6) STATIC;
      127      127    1   DCL FACTER(0:27) CONSTANT UBIN (36) INIT(
      128      128    1    2*3,1*3,2*22);
      129      129    1   DCL TN_S(0:27) CONSTANT BIT (3) UNAL INIT(
      130      130    1    '000'B*3,'111'B,'110'B*2,'011'B,'001'B,'010'B,'011'B*2,'000'B*17);
      131      131    1   DCL LAST_SC_SAVE UBIN (36) STATIC;
      132      132    1   DCL BASED_PTR$ PTR BASED;
      133      133    1   DCL WORD36 UBIN (36) BASED ALIGNED;
      134      134    1   DCL DBK UBIN (36) STATIC;
      135      135    1   DCL LAST_FILLER UBIN(36) STATIC;
      136      136    1   DCL LAST_SS UBIN (36) STATIC;
      137      137    1   DCL LAST_SMSO_SAVE UBIN (36) STATIC;
      138      138    1   DCL FOUND BIT (1) STATIC;
      139      139    1   DCL SET_ORDER(0:7) CHAR (28) CONSTANT INIT (
      140      140    1    'FIRST',
      141      141    1    'LAST',
      142      142    1    'NEXT',
      143      143    1    'PRIOR',
      144      144    1    'SORTED BY DEFINED KEYS',
      145      145    1    'BY RECORD-NAME',
      146      146    1    'SORTED WITHIN RECORD-NAME',
      147      147    1    'BY DATA-BASE-KEY');
      148      148    1   DCL DUP_TEXT(0:2) CHAR (12) CONSTANT INIT (
      149      149    1    'FIRST',
      150      150    1    'LAST',
      151      151    1    'NOT ALLOWED');
      152      152    1   DCL MODE_OF_SET(0:2) CHAR (13) CONSTANT INIT(
      153      153    1    'CHAIN',
      154      154    1    'RECORD ARRAY',
      155      155    1    'POINTER ARRAY');
      156      156    1   DCL MAN_OPT(0:3) CHAR (52) CONSTANT INIT (
      157      157    1    '               MANDATORY AUTOMATIC LINKED TO OWNER',
      158      158    1    '               MANDATORY MANUAL LINKED TO OWNER',
      159      159    1    '               OPTIONAL AUTOMATIC LINKED TO OWNER',
      160      160    1    '               OPTIONAL MANUAL LINKED TO OWNER');
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:78   
      161      161    1   DCL T7PTR$ PTR STATIC;
      162      162    1   DCL T8PTR$ PTR STATIC;
      163      163    1   DCL T9PTR$ PTR STATIC;
      164      164    1   DCL K UBIN (36) STATIC;
      165      165    1   DCL FIELD_NAME CHAR (30) STATIC;
      166      166    1   DCL FIRST_FIELD BIT (1) EXT;
      167      167    1   DCL FIRST_SO BIT (1);
      168      168    1   DCL FIRST_SM BIT (1);
      169      169    1   DCL FIRST_KEY BIT (1);
      170      170    1   DCL HEADING_SET CHAR (25) STATIC;
      171      171    1   DCL DESCPTR PTR STATIC INIT (ADDR(BUFFER1));
      172      172    1   DCL BUFFER1 CHAR (128) STATIC;
      173      173    1   DCL BUFFER_TEMP CHAR (128) BASED (DESCPTR);
      174      174    1   DCL EOF UBIN (36) STATIC;
      175      175    1   DCL BUFFER_SIZE UBIN (36) STATIC;
      176      176    1   DCL SUBSCHEMA_NAME_4 CHAR(4) EXT;
      177      177    1   DCL RVA_NAME CHAR(8) STATIC;
      178      178    1   DCL SAVE_LAST_UWA UBIN (36) STATIC;
      179      179    1   DCL SAVE_LAST_RVA UBIN (36) STATIC;
      180      180    1   DCL SAVED_FR_NAMES BIT (1) STATIC;
      181      181    1   DCL DATA_TYPE_NAME(0:18) CHAR (20) CONSTANT INIT (
      182      182    1   'CHARACTER', /* 0 */
      183      183    1   'DBKEY', /* 1 */
      184      184    1   'INTEGER', /* 2 */
      185      185    1   'COMP-4', /* 3 */
      186      186    1   'COMP-4 SIGNED', /* 4 */
      187      187    1   'COMP-3 SIGNED', /* 5 */
      188      188    1   'DISPLAY NUMERIC', /* 6 */
      189      189    1   'DISPLAY NUMERIC', /* 7 */
      190      190    1   'DISPLAY NUMERIC', /* 8 */
      191      191    1   'DISPLAY NUMERIC', /* 9 */
      192      192    1   'DISPLAY NUMERIC', /*10 */
      193      193    1   'COMP-1', /*11 */
      194      194    1   'COMP-2', /*12 */
      195      195    1   'REAL', /*13 */
      196      196    1   'DOUBLE PRECISION',/*14 */
      197      197    1   'COMPLEX', /*15 */
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:79   
      198      198    1   'DOUBLE COMPLEX', /*16 */
      199      199    1   'LOGICAL', /*17 */
      200      200    1    'SINGLE PRECISION' /*18 */);
      201      201    1   DCL PL6_SCREW_UP CHAR (6) CONSTANT INIT ('000000');
      202      202    1   DCL WORD_OFFSET CHAR (6) STATIC;
      203      203    1   DCL NIBLE_OFF CHAR (1) STATIC;
      204      204    1   DCL NUM_OFF CHAR (12) STATIC;
      205      205        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:80   
      206      206        %INCLUDE ZIG_DIR_STRUCS;
      207      336        %INCLUDE ZI_ERRORS_SUBS;
      208      856        %INCLUDE ZIG_GENERAL;
      209      964        %INCLUDE ZIG_DBA_INT;
      210     1012        %INCLUDE ZI_SUB4_CAN;
      211     1669        %RVA;
      212     1946        %UWA;
      213     2281        %INCLUDE ZI_SUB_LANG;
      214     3996        %DESC_TYPE_9(NAME_MAIN=TYPE_9);
      215     4173        %GENERAL;
      216     4297    1   DCL IO_BUF CHAR (128) EXT;
      217     4298        %TEXT_LINE(STCLASS="REDEF IO_BUF");
      218     4335        %DESC_TYPE_9(STCLASS="REDEF IO_BUF");
      219     4512        %DESC_TYPE_100(STCLASS="REDEF IO_BUF");
      220     4552        %DESC_TYPE_110(STCLASS="REDEF IO_BUF");
      221     4616        %DESC_TYPE_200(STCLASS="REDEF IO_BUF");
      222     4669        %DESC_TYPE_210(STCLASS="REDEF IO_BUF");
      223     4724        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
      224     4793        %DESC_TYPE_350(STCLASS="REDEF IO_BUF");
      225     4831        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
      226     4890        %DESC_TYPE_410(STCLASS="REDEF IO_BUF");
      227     4946        %DESC_TYPE_420(STCLASS="REDEF IO_BUF");
      228     4979        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
      229     5138        %CONTROL_BLOCK;
      230     5246        %DESC_TYPE_36;
      231     5285        %DESC_TYPE_37;
      232     5325        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:81   
      233     5326        /*
      234     5327              Now comes the sturctures for the schema subset.
      235     5328        */
      236     5329        %INCLUDE ZIG_SSS;
      237     5899        %SS_GENERAL(PSTCLASS=EXT);
      238     5920        %AC(PSTCLASS=EXT);
      239     6015        %AC1(PSTCLASS=EXT);
      240     6023        %FR(PSTCLASS=EXT);
      241     6069        %FR1(PSTCLASS=EXT);
      242     6077        %SC(PSTCLASS=EXT);
      243     6104        %SC1(PSTCLASS=EXT);
      244     6114        %RC(PSTCLASS=EXT);
      245     6147        %RC1(PSTCLASS=EXT);
      246     6157        %OA(PSTCLASS=EXT);
      247     6224        %OA1(PSTCLASS=EXT);
      248     6232        %RA(PSTCLASS=EXT);
      249     6252        %RS(PSTCLASS=EXT);
      250     6326        %SM1(PSTCLASS=EXT);
      251     6334        %SS(PSTCLASS=EXT);
      252     6348        %CD(PSTCLASS=EXT);
      253     6367        %DP(PSTCLASS=EXT);
      254     6381        %DP1(PSTCLASS=EXT);
      255     6389        %AG(PSTCLASS=EXT);
      256     6419        %AG1(PSTCLASS=EXT);
      257     6427        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:82   
      258     6428        /*
      259     6429        ZZZZZ  III   GGG    $   V   V        CCC  H   H EEEEE  CCC  K   K       FFFFF
      260     6430            Z   I   G   G  $$$  V   V       C   C H   H E     C   C K  K        F
      261     6431           Z    I   G     $ $   V   V       C     H   H E     C     K K         F
      262     6432          Z     I   G      $$$  V   V       C     HHHHH EEEE  C     KK          FFFF
      263     6433         Z      I   G  GG   $ $ V   V       C     H   H E     C     K K         F
      264     6434        Z       I   G   G  $$$   V V        C   C H   H E     C   C K  K        F
      265     6435        ZZZZZ  III   GGG    $     V          CCC  H   H EEEEE  CCC  K   K       F
      266     6436                                      _____                               _____
      267     6437        */
      268     6438    1   ZIG$V_CHECK_F:

   6438 86 000003   200014 741300       ZIG$V_CHECK* STX1  ! FIRST_KEY+1,,AUTO

      269     6439    1       PROC;
      270     6440    2   DCL I SBIN WORD;
      271     6441    2       SAVE_BUF = IO_BUF;

   6441 86 000004   040000 100400                    MLR     fill='040'O
        86 000005   000000 000200 62                 ADSC9   IO_BUF                   cn=0,n=128
        86 000006   000011 000200 4                  ADSC9   SAVE_BUF                 cn=0,n=128

      272     6442    2       IF RC.RCRAN = 0

   6442 86 000007   000000 470400 73                 LDP0    RC$
        86 000010   000001 220100                    LDX0    1,,PR0
        86 000011   000137 601000 86                 TNZ     s:6474

      273     6443    3       THEN DO;

      274     6444    3           CALL FCURR_R_6('RC  ') ALTRET(DBCS_ERR);

   6444 86 000012   000001 630400 87                 EPPR0   1
        86 000013   000000 631400 87                 EPPR1   0
        86 000014   000000 701000 xent               TSX1    FCURR_R_6
        86 000015   000704 702000 86                 TSX2    DBCS_ERR

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:83   
      275     6445    3           AREA_REC_REL = '0'B;

   6445 86 000016   000051 450000 4                  STZ     AREA_REC_REL

      276     6446    4           DO WHILE ('1'B);

      277     6447    4               CALL FETCHNS_6('RC-RA   ') ALTRET(DONE_RC_RA);

   6447 86 000017   000002 630400 87                 EPPR0   2
        86 000020   000000 631400 87                 EPPR1   0
        86 000021   000000 701000 xent               TSX1    FETCHNS_6
        86 000022   000056 702000 86                 TSX2    DONE_RC_RA

      278     6448    4               CALL FETCHOS_6('AC-RA   ') ALTRET(DBCS_ERR);

   6448 86 000023   000003 630400 87                 EPPR0   3
        86 000024   000000 631400 87                 EPPR1   0
        86 000025   000000 701000 xent               TSX1    FETCHOS_6
        86 000026   000704 702000 86                 TSX2    DBCS_ERR

      279     6449    4               CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERR);

   6449 86 000027   000004 630400 87                 EPPR0   4
        86 000030   000000 631400 87                 EPPR1   0
        86 000031   000000 701000 xent               TSX1    FETCHOS_6
        86 000032   000704 702000 86                 TSX2    DBCS_ERR

      280     6450    4               TYPE_420.SOUR_LINE = 0;

   6450 86 000033   000002 450000 62                 STZ     IO_BUF+2

      281     6451    4               TYPE_420.AREA_NAME = UWA.SN.SENAME;

   6451 86 000034   040000 100400                    MLR     fill='040'O
        86 000035   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 000036   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:84   
      282     6452    4               TYPE_420.SUB_AREA_NAME = UWA.SN.SENAME;

   6452 86 000037   040000 100400                    MLR     fill='040'O
        86 000040   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 000041   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

      283     6453    4               CALL ZIG$V_AREA_REC;

   6453 86 000042   000005 631400 87                 EPPR1   5
        86 000043   000000 701000 xent               TSX1    ZIG$V_AREA_REC
        86 000044   000000 011000                    NOP     0

      284     6454    4               IF RECORD_FOUND AND ~ AREA_REC_REL

   6454 86 000045   000000 234000 15                 SZN     RECORD_FOUND
        86 000046   000017 605000 86                 TPL     s:6447
        86 000047   000051 236000 4                  LDQ     AREA_REC_REL
        86 000050   400000 376003                    ANQ     -131072,DU
        86 000051   400000 676003                    ERQ     -131072,DU
        86 000052   000017 600000 86                 TZE     s:6447

      285     6455    4               THEN AREA_REC_REL = '1'B;

   6455 86 000053   400000 236003                    LDQ     -131072,DU
        86 000054   000051 756000 4                  STQ     AREA_REC_REL

      286     6456    4               END;

   6456 86 000055   000017 710000 86                 TRA     s:6447

      287     6457    3   DONE_RC_RA:
      288     6458    3           IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;

   6458 86 000056   040000 106400       DONE_RC_RA   CMPC    fill='040'O
        86 000057   000001 000007 54                 ADSC9   UWA+1                    cn=0,n=7
        86 000060   001140 000007 12                 ADSC9   ONE_CHANGE+10            cn=0,n=7
        86 000061   000065 600000 86                 TZE     s:6459
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:85   

   6458 86 000062   000005 631400 87                 EPPR1   5
        86 000063   000000 701000 xent               TSX1    ABORT
        86 000064   000000 011000                    NOP     0

      289     6459    3           IF ~AREA_REC_REL

   6459 86 000065   000051 236000 4                  LDQ     AREA_REC_REL
        86 000066   400000 376003                    ANQ     -131072,DU
        86 000067   400000 676003                    ERQ     -131072,DU
        86 000070   000137 600000 86                 TZE     s:6474

      290     6460    4           THEN DO;

      291     6461    4               I = RC.DEF.RNL;

   6461 86 000071   000000 470400 73                 LDP0    RC$
        86 000072   000000 236100                    LDQ     0,,PR0
        86 000073   000077 376007                    ANQ     63,DL
        86 000074   200015 756100                    STQ     I,,AUTO

      292     6462    4               CALL SET_FIELDS(1,I,RC.RNAM);

   6462 86 000075   000000 236000 73                 LDQ     RC$
        86 000076   000005 036003                    ADLQ    5,DU
        86 000077   200032 756100                    STQ     COUNT1+4,,AUTO
        86 000100   200015 631500                    EPPR1   I,,AUTO
        86 000101   200031 451500                    STP1    COUNT1+3,,AUTO
        86 000102   000010 236000 87                 LDQ     8
        86 000103   200030 756100                    STQ     COUNT1+2,,AUTO
        86 000104   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 000105   000006 631400 87                 EPPR1   6
        86 000106   000000 701000 xent               TSX1    SET_FIELDS
        86 000107   000000 011000                    NOP     0

      293     6463    4               IF (SUBSTR(RC.RNAM,0,1) ~= '*') AND (RC.DEF.SR = '0'B)

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:86   
   6463 86 000110   000000 470400 73                 LDP0    RC$
        86 000111   000000 720100                    LXL0    0,,PR0
        86 000112   000077 360003                    ANX0    63,DU
        86 000113   000005 236100                    LDQ     5,,PR0
        86 000114   777000 376003                    ANQ     -512,DU
        86 000115   052000 116003                    CMPQ    21504,DU
        86 000116   000126 600000 86                 TZE     s:6465
        86 000117   000000 236100                    LDQ     0,,PR0
        86 000120   100000 316007                    CANQ    32768,DL
        86 000121   000126 601000 86                 TNZ     s:6465

      294     6464    4               THEN CALL WARNING(%ZIG_REC_NOT_IN_AREA);

   6464 86 000122   000012 630400 87                 EPPR0   10
        86 000123   000000 631400 87                 EPPR1   0
        86 000124   000000 701000 xent               TSX1    WARNING
        86 000125   000000 011000                    NOP     0

      295     6465    4               RC.DEF.RSTO = '1'B;

   6465 86 000126   000000 470400 73                 LDP0    RC$
        86 000127   200000 236007                    LDQ     65536,DL
        86 000130   000000 256100                    ORSQ    0,,PR0

      296     6466    4               RC.DEF.RERS = '1'B;

   6466 86 000131   000000 470400 73                 LDP0    RC$
        86 000132   400000 236007                    LDQ     -131072,DL
        86 000133   000000 256100                    ORSQ    0,,PR0

      297     6467    4               RC.DEF.RERA = '1'B;

   6467 86 000134   000000 470400 73                 LDP0    RC$
        86 000135   004000 236007                    LDQ     2048,DL
        86 000136   000000 256100                    ORSQ    0,,PR0

      298     6468        /*E*     ERROR:    ZIG-ZIG_REC_NOT_IN_AREA-C
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:87   
      299     6469        MESSAGE: The record "%U1" is not in any area in the subschema.
      300     6470                 Therefore, the record cannot be used in any DML calls.
      301     6471        */
      302     6472    4               END;

      303     6473    3           END;

      304     6474    2       SAVED_FR_NAMES = VALIDS.FR_NAMES;

   6474 86 000137   000000 236000 31                 LDQ     VALIDS
        86 000140   000013 736000                    QLS     11
        86 000141   400000 376003                    ANQ     -131072,DU
        86 000142   000166 756000 4                  STQ     SAVED_FR_NAMES

      305     6475    2       VALIDS.FR_NAMES = '1'B;

   6475 86 000143   000100 236003                    LDQ     64,DU
        86 000144   000000 256000 31                 ORSQ    VALIDS

      306     6476        /*W*
      307     6477              All field names that are add to the subschema and not
      308     6478            pressent in the subschema must have a name with it or
      309     6479            I can't get the name from any where in some of the displaying
      310     6480            of the subschema.
      311     6481        */
      312     6482    3       DO I = 0 TO 808;

   6482 86 000145   200015 450100                    STZ     I,,AUTO

      313     6483    3           TPTR$ = ALT_HASH_TABLE(I);

   6483 86 000146   200015 720100                    LXL0    I,,AUTO
        86 000147   000000 236010 24                 LDQ     ALT_HASH_TABLE,X0
        86 000150   000060 756000 4                  STQ     TPTR$

      314     6484    4           DO WHILE(TPTR$ ~= ADDR(NIL));

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:88   
   6484 86 000151   000227 710000 86                 TRA     s:6507

      315     6485    4               IF TPTR$ -> FIELD_HASH.REF = 0

   6485 86 000152   000060 470400 4                  LDP0    TPTR$
        86 000153   000011 235100                    LDA     9,,PR0
        86 000154   000224 601000 86                 TNZ     s:6506

      316     6486    5               THEN DO;

      317     6487    5                   CALL FETCHD_6('FR  ',TPTR$ -> FIELD_HASH.DBK);

   6487 86 000155   000060 236000 4                  LDQ     TPTR$
        86 000156   000013 036003                    ADLQ    11,DU
        86 000157   000014 235000 87                 LDA     12
        86 000160   200030 757100                    STAQ    COUNT1+2,,AUTO
        86 000161   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 000162   000013 631400 87                 EPPR1   11
        86 000163   000000 701000 xent               TSX1    FETCHD_6
        86 000164   000000 011000                    NOP     0

      318     6488    5                   TYPE_430.FIELD_NAME = TPTR$ -> FIELD_HASH.C_NAME;

   6488 86 000165   000060 470400 4                  LDP0    TPTR$
        86 000166   040000 100500                    MLR     fill='040'O
        86 000167   000000 400036                    ADSC9   0,,PR0                   cn=2,n=30
        86 000170   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

      319     6489    5                   TYPE_430.SUB_FIELD_NAME = TYPE_430.FIELD_NAME;

   6489 86 000171   040000 100400                    MLR     fill='040'O
        86 000172   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30
        86 000173   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

      320     6490    5                   CALL CHANGE_TO_STR(TYPE_430.SUB_FIELD_NAME);

   6490 86 000174   000015 236000 87                 LDQ     13
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:89   
        86 000175   200025 756100                    STQ     @ALI+1,,AUTO
        86 000176   002414 701000 86                 TSX1    CHANGE_TO_STR
        86 000177   000000 011000                    NOP     0

      321     6491    5                   TYPE_430.REF_LINE = 0;

   6491 86 000200   000001 450000 62                 STZ     IO_BUF+1

      322     6492    5                   TYPE_430.OFFSET = 0;

   6492 86 000201   000023 450000 62                 STZ     IO_BUF+19

      323     6493    5                   TYPE_430.ELEMENTARY = '1'B;

   6493 86 000202   400000 236003                    LDQ     -131072,DU
        86 000203   000030 256000 62                 ORSQ    IO_BUF+24

      324     6494    5                   CALL DEFAULT_DATA_TYPE;

   6494 86 000204   002126 701000 86                 TSX1    DEFAULT_DATA_TYPE
        86 000205   000000 011000                    NOP     0

      325     6495    5                   CALL ZIG$V_FIELD;

   6495 86 000206   000005 631400 87                 EPPR1   5
        86 000207   000000 701000 xent               TSX1    ZIG$V_FIELD
        86 000210   000000 011000                    NOP     0

      326     6496    5                   FR.DEF.FSR = '1'B;

   6496 86 000211   000000 470400 69                 LDP0    FR$
        86 000212   000100 236007                    LDQ     64,DL
        86 000213   000000 256100                    ORSQ    0,,PR0

      327     6497    5                   IF FR.CDSN ~= 0 AND FR.CDRN ~= 0

   6497 86 000214   000000 470400 69                 LDP0    FR$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:90   
        86 000215   000003 220100                    LDX0    3,,PR0
        86 000216   000224 600000 86                 TZE     s:6506
        86 000217   000003 721100                    LXL1    3,,PR0
        86 000220   000224 600000 86                 TZE     s:6506

      328     6498    6                   THEN DO;

      329     6499        /*
      330     6500              Control field not in record so can not be modifyed or
      331     6501            stored.
      332     6502        */
      333     6503    6                       RC.DEF.RSTO = '1'B;

   6503 86 000221   000000 471400 73                 LDP1    RC$
        86 000222   200000 236007                    LDQ     65536,DL
        86 000223   100000 256100                    ORSQ    0,,PR1

      334     6504    6                       END;

      335     6505    5                   END;

      336     6506    4               TPTR$ = TPTR$ -> FIELD_HASH.PTR$;

   6506 86 000224   000060 470400 4                  LDP0    TPTR$
        86 000225   000010 236100                    LDQ     8,,PR0
        86 000226   000060 756000 4                  STQ     TPTR$

      337     6507    4               END;

   6507 86 000227   000016 116000 87                 CMPQ    14
        86 000230   000152 601000 86                 TNZ     s:6485

      338     6508    3           END;

   6508 86 000231   200015 054100                    AOS     I,,AUTO
        86 000232   200015 235100                    LDA     I,,AUTO
        86 000233   001450 115007                    CMPA    808,DL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:91   
        86 000234   000146 604400 86                 TMOZ    s:6483

      339     6509    2       VALIDS.FR_NAMES = SAVED_FR_NAMES;

   6509 86 000235   000166 236000 4                  LDQ     SAVED_FR_NAMES
        86 000236   000013 772000                    QRL     11
        86 000237   000000 676000 31                 ERQ     VALIDS
        86 000240   000100 376003                    ANQ     64,DU
        86 000241   000000 656000 31                 ERSQ    VALIDS

      340     6510    2       IF LAST_RECORD_REF_LINE ~= 0

   6510 86 000242   000000 236000 19                 LDQ     LAST_RECORD_REF_LINE
        86 000243   000354 600000 86                 TZE     s:6545

      341     6511    3       THEN DO;

      342     6512    3           CALL READSF(LAST_RECORD_REF_LINE,IO_BUF);

   6512 86 000244   000017 630400 87                 EPPR0   15
        86 000245   000013 631400 87                 EPPR1   11
        86 000246   000000 701000 xent               TSX1    READSF
        86 000247   000000 011000                    NOP     0

      343     6513    3           TYPE_400.INFO = RC.DEF;

   6513 86 000250   000000 470400 73                 LDP0    RC$
        86 000251   000000 236100                    LDQ     0,,PR0
        86 000252   000024 756000 62                 STQ     IO_BUF+20

      344     6514    3           IF RC.DEF.PSTO = 1

   6514 86 000253   000000 236100                    LDQ     0,,PR0
        86 000254   000007 376003                    ANQ     7,DU
        86 000255   000001 116003                    CMPQ    1,DU
        86 000256   000347 601000 86                 TNZ     s:6533

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:92   
      345     6515    4           THEN DO;

      346     6516    4               TPTR$ = PINCRW(SSS$,RC.RCRSN);

   6516 86 000257   000002 720100                    LXL0    2,,PR0
        86 000260   000000 636010                    EAQ     0,X0
        86 000261   000000 036000 66                 ADLQ    SSS$
        86 000262   000060 756000 4                  STQ     TPTR$

      347     6517    4               T1PTR$ = PINCRW(SSS$,TPTR$ -> RS.SCRSH);

   6517 86 000263   000060 471400 4                  LDP1    TPTR$
        86 000264   100003 721100                    LXL1    3,,PR1
        86 000265   000000 636011                    EAQ     0,X1
        86 000266   000000 036000 66                 ADLQ    SSS$
        86 000267   000064 756000 4                  STQ     T1PTR$

      348     6518    5               DO WHILE (T1PTR$ -> SC.SNAM ~= '*CALC' AND TPTR$ ~= SSS$);

   6518 86 000270   000303 710000 86                 TRA     s:6521

      349     6519    5                   TPTR$ = PINCRW(SSS$,TPTR$ -> RS.RCRSN);

   6519 86 000271   000060 470400 4                  LDP0    TPTR$
        86 000272   000002 720100                    LXL0    2,,PR0
        86 000273   000000 636010                    EAQ     0,X0
        86 000274   000000 036000 66                 ADLQ    SSS$
        86 000275   000060 756000 4                  STQ     TPTR$

      350     6520    5                   T1PTR$ = PINCRW(SSS$,TPTR$ -> RS.SCRSH);

   6520 86 000276   000060 470400 4                  LDP0    TPTR$
        86 000277   000003 720100                    LXL0    3,,PR0
        86 000300   000000 636010                    EAQ     0,X0
        86 000301   000000 036000 66                 ADLQ    SSS$
        86 000302   000064 756000 4                  STQ     T1PTR$

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:93   
      351     6521    5                   END;

   6521 86 000303   000064 470400 4                  LDP0    T1PTR$
        86 000304   000000 720100                    LXL0    0,,PR0
        86 000305   000077 360003                    ANX0    63,DU
        86 000306   040000 106540                    CMPC    fill='040'O
        86 000307   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        86 000310   001143 000005 12                 ADSC9   ONE_CHANGE+13            cn=0,n=5
        86 000311   000315 600000 86                 TZE     s:6522
        86 000312   000060 236000 4                  LDQ     TPTR$
        86 000313   000000 116000 66                 CMPQ    SSS$
        86 000314   000271 601000 86                 TNZ     s:6519

      352     6522    4               IF T1PTR$ -> SC.SNAM ~= '*CALC'

   6522 86 000315   040000 106540                    CMPC    fill='040'O
        86 000316   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        86 000317   001143 000005 12                 ADSC9   ONE_CHANGE+13            cn=0,n=5
        86 000320   000324 600000 86                 TZE     s:6524

      353     6523    4               THEN CALL ABORT;

   6523 86 000321   000005 631400 87                 EPPR1   5
        86 000322   000000 701000 xent               TSX1    ABORT
        86 000323   000000 011000                    NOP     0

      354     6524    4               I = 0;

   6524 86 000324   200015 450100                    STZ     I,,AUTO

      355     6525    4               T1PTR$ = PINCRW(SSS$,TPTR$ -> RS.RSCDN);

   6525 86 000325   000060 470400 4                  LDP0    TPTR$
        86 000326   000001 220100                    LDX0    1,,PR0
        86 000327   000000 636010                    EAQ     0,X0
        86 000330   000000 036000 66                 ADLQ    SSS$
        86 000331   000064 756000 4                  STQ     T1PTR$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:94   

      356     6526    5               DO WHILE (T1PTR$ ~= SSS$);

   6526 86 000332   000000 116000 66                 CMPQ    SSS$
        86 000333   000344 600000 86                 TZE     s:6530

      357     6527    5                   I = I + 1;

   6527 86 000334   200015 054100                    AOS     I,,AUTO

      358     6528    5                   T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RSCDN);

   6528 86 000335   000064 470400 4                  LDP0    T1PTR$
        86 000336   000001 220100                    LDX0    1,,PR0
        86 000337   000000 636010                    EAQ     0,X0
        86 000340   000000 036000 66                 ADLQ    SSS$
        86 000341   000064 756000 4                  STQ     T1PTR$

      359     6529    5                   END;

   6529 86 000342   000000 116000 66                 CMPQ    SSS$
        86 000343   000334 601000 86                 TNZ     s:6527

      360     6530    4               TYPE_400.PRIMARY_FIELD_NUM = I;

   6530 86 000344   200015 235100                    LDA     I,,AUTO
        86 000345   000026 755000 62                 STA     IO_BUF+22

      361     6531    4               END;

   6531 86 000346   000350 710000 86                 TRA     s:6535

      362     6532    4           ELSE DO;

      363     6533    4               TYPE_400.PRIMARY_FIELD_NUM = 0;

   6533 86 000347   000026 450000 62                 STZ     IO_BUF+22
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:95   

      364     6534    4               END;

      365     6535    3           CALL WRITSF(LAST_RECORD_REF_LINE,IO_BUF);

   6535 86 000350   000017 630400 87                 EPPR0   15
        86 000351   000013 631400 87                 EPPR1   11
        86 000352   000000 701000 xent               TSX1    WRITSF
        86 000353   000000 011000                    NOP     0

      366     6536    3           END;

      367     6537        /*
      368     6538              Check all the fields that should be in this schema subset
      369     6539            to see if they all have be put in or not.
      370     6540            If any not in then add them to the record and set the bit
      371     6541            that says that field not in subschema.
      372     6542            If any of the fields that are added are a control field
      373     6543            mark the set to say that the record can not be inserted.
      374     6544        */
      375     6545    2       IF VALIDS.RECORD_XREF AND SUBSTR(RC.RNAM,0,1) ~= '*'

   6545 86 000354   000000 236000 31                 LDQ     VALIDS
        86 000355   000020 316003                    CANQ    16,DU
        86 000356   000677 600000 86                 TZE     s:6625
        86 000357   000000 470400 73                 LDP0    RC$
        86 000360   000000 720100                    LXL0    0,,PR0
        86 000361   000077 360003                    ANX0    63,DU
        86 000362   000005 236100                    LDQ     5,,PR0
        86 000363   777000 376003                    ANQ     -512,DU
        86 000364   052000 116003                    CMPQ    21504,DU
        86 000365   000677 600000 86                 TZE     s:6625
        86 000366   000000 236100                    LDQ     0,,PR0
        86 000367   000024 736000                    QLS     20
        86 000370   400000 376003                    ANQ     -131072,DU
        86 000371   400000 676003                    ERQ     -131072,DU
        86 000372   000677 600000 86                 TZE     s:6625
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:96   

      376     6546    2          AND ~RC.DEF.SR
      377     6547    3       THEN DO;

      378     6548    3           T1PTR$ = PINCRW(SSS$,RC.RCRSN);

   6548 86 000373   000002 721100                    LXL1    2,,PR0
        86 000374   000000 636011                    EAQ     0,X1
        86 000375   000000 036000 66                 ADLQ    SSS$
        86 000376   000064 756000 4                  STQ     T1PTR$

      379     6549    3           FIRST_SO = '1'B;

   6549 86 000377   400000 236003                    LDQ     -131072,DU
        86 000400   200011 756100                    STQ     FIRST_SO,,AUTO

      380     6550    3           FIRST_SM = '1'B;

   6550 86 000401   200012 756100                    STQ     FIRST_SM,,AUTO

      381     6551    3           FIRST_KEY = '1'B;

   6551 86 000402   200013 756100                    STQ     FIRST_KEY,,AUTO

      382     6552    4           DO WHILE (T1PTR$ ~= SSS$);

   6552 86 000403   000064 236000 4                  LDQ     T1PTR$
        86 000404   000000 116000 66                 CMPQ    SSS$
        86 000405   000455 600000 86                 TZE     s:6569

      383     6553    4               TPTR$ = PINCRW(SSS$, T1PTR$ -> RS.SCRSH);

   6553 86 000406   000064 470400 4                  LDP0    T1PTR$
        86 000407   000003 720100                    LXL0    3,,PR0
        86 000410   000000 636010                    EAQ     0,X0
        86 000411   000000 036000 66                 ADLQ    SSS$
        86 000412   000060 756000 4                  STQ     TPTR$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:97   

      384     6554    4               IF TPTR$ -> SC.DEF.SETT = SECONDARY_KEY

   6554 86 000413   000060 471400 4                  LDP1    TPTR$
        86 000414   100000 236100                    LDQ     0,,PR1
        86 000415   000700 376007                    ANQ     448,DL
        86 000416   000300 116007                    CMPQ    192,DL
        86 000417   000446 601000 86                 TNZ     s:6567

      385     6555    5               THEN DO;

      386     6556    5                   IF FIRST_KEY

   6556 86 000420   200013 234100                    SZN     FIRST_KEY,,AUTO
        86 000421   000427 605000 86                 TPL     s:6562

      387     6557    6                   THEN DO;

      388     6558    6                       HEADING_SET = '    ALTERNATE KEYS: ';

   6558 86 000422   040000 100400                    MLR     fill='040'O
        86 000423   001145 000024 12                 ADSC9   ONE_CHANGE+15            cn=0,n=20
        86 000424   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

      389     6559    6                       FIRST_KEY = '0'B;

   6559 86 000425   200013 450100                    STZ     FIRST_KEY,,AUTO

      390     6560    6                       END;

   6560 86 000426   000432 710000 86                 TRA     s:6564

      391     6561    6                   ELSE DO;

      392     6562    6                       HEADING_SET = ' ';

   6562 86 000427   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:98   
        86 000430   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 000431   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

      393     6563    6                       END;

      394     6564    5                   CALL CONCAT(LIST_STRING,HEADING_SET,TPTR$ -> SC.SNAM);

   6564 86 000432   100000 721100                    LXL1    0,,PR1
        86 000433   000077 361003                    ANX1    63,DU
        86 000434   040000 100400                    MLR     fill='040'O
        86 000435   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25
        86 000436   000000 000031 16                 ADSC9   LIST_STRING              cn=0,n=25
        86 000437   040000 100540                    MLR     fill='040'O
        86 000440   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        86 000441   000006 200147 16                 ADSC9   LIST_STRING+6            cn=1,n=103

      395     6565    5                   CALL LIST(LIST_STRING);

   6565 86 000442   000022 630400 87                 EPPR0   18
        86 000443   000000 631400 87                 EPPR1   0
        86 000444   000000 701000 xent               TSX1    LIST
        86 000445   000000 011000                    NOP     0

      396     6566    5                   END;

      397     6567    4               T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RCRSN);

   6567 86 000446   000064 470400 4                  LDP0    T1PTR$
        86 000447   000002 720100                    LXL0    2,,PR0
        86 000450   000000 636010                    EAQ     0,X0
        86 000451   000000 036000 66                 ADLQ    SSS$
        86 000452   000064 756000 4                  STQ     T1PTR$

      398     6568    4               END;

   6568 86 000453   000000 116000 66                 CMPQ    SSS$
        86 000454   000406 601000 86                 TNZ     s:6553
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:99   

      399     6569    3           T1PTR$ = PINCRW(SSS$,RC.RCRSN);

   6569 86 000455   000000 470400 73                 LDP0    RC$
        86 000456   000002 720100                    LXL0    2,,PR0
        86 000457   000000 636010                    EAQ     0,X0
        86 000460   000000 036000 66                 ADLQ    SSS$
        86 000461   000064 756000 4                  STQ     T1PTR$

      400     6570    4           DO WHILE (T1PTR$ ~= SSS$);

   6570 86 000462   000000 116000 66                 CMPQ    SSS$
        86 000463   000536 600000 86                 TZE     s:6588

      401     6571    4               TPTR$ = PINCRW(SSS$, T1PTR$ -> RS.SCRSH);

   6571 86 000464   000064 470400 4                  LDP0    T1PTR$
        86 000465   000003 720100                    LXL0    3,,PR0
        86 000466   000000 636010                    EAQ     0,X0
        86 000467   000000 036000 66                 ADLQ    SSS$
        86 000470   000060 756000 4                  STQ     TPTR$

      402     6572    4               IF T1PTR$ -> RS.DEF.TYPE = '000001000000'B /* SO */

   6572 86 000471   000000 236100                    LDQ     0,,PR0
        86 000472   777700 376003                    ANQ     -64,DU
        86 000473   010000 116003                    CMPQ    4096,DU
        86 000474   000527 601000 86                 TNZ     s:6586
        86 000475   000060 471400 4                  LDP1    TPTR$
        86 000476   100000 236100                    LDQ     0,,PR1
        86 000477   000700 316007                    CANQ    448,DL
        86 000500   000527 601000 86                 TNZ     s:6586

      403     6573    4                  AND TPTR$ -> SC.DEF.SETT = 0 /* USER-DEFINED SET */
      404     6574    5               THEN DO;

      405     6575    5                   IF FIRST_SO
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:100  

   6575 86 000501   200011 234100                    SZN     FIRST_SO,,AUTO
        86 000502   000510 605000 86                 TPL     s:6581

      406     6576    6                   THEN DO;

      407     6577    6                       HEADING_SET = '    OWNER OF SET: ';

   6577 86 000503   040000 100400                    MLR     fill='040'O
        86 000504   001152 000022 12                 ADSC9   ONE_CHANGE+20            cn=0,n=18
        86 000505   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

      408     6578    6                       FIRST_SO = '0'B;

   6578 86 000506   200011 450100                    STZ     FIRST_SO,,AUTO

      409     6579    6                       END;

   6579 86 000507   000513 710000 86                 TRA     s:6583

      410     6580    6                   ELSE DO;

      411     6581    6                       HEADING_SET = ' ';

   6581 86 000510   040000 100400                    MLR     fill='040'O
        86 000511   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 000512   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

      412     6582    6                       END;

      413     6583    5                   CALL CONCAT(LIST_STRING,HEADING_SET,TPTR$ -> SC.SNAM);

   6583 86 000513   100000 721100                    LXL1    0,,PR1
        86 000514   000077 361003                    ANX1    63,DU
        86 000515   040000 100400                    MLR     fill='040'O
        86 000516   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25
        86 000517   000000 000031 16                 ADSC9   LIST_STRING              cn=0,n=25
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:101  
        86 000520   040000 100540                    MLR     fill='040'O
        86 000521   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        86 000522   000006 200147 16                 ADSC9   LIST_STRING+6            cn=1,n=103

      414     6584    5                   CALL LIST(LIST_STRING);

   6584 86 000523   000022 630400 87                 EPPR0   18
        86 000524   000000 631400 87                 EPPR1   0
        86 000525   000000 701000 xent               TSX1    LIST
        86 000526   000000 011000                    NOP     0

      415     6585    5                   END;

      416     6586    4               T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RCRSN);

   6586 86 000527   000064 470400 4                  LDP0    T1PTR$
        86 000530   000002 720100                    LXL0    2,,PR0
        86 000531   000000 636010                    EAQ     0,X0
        86 000532   000000 036000 66                 ADLQ    SSS$
        86 000533   000064 756000 4                  STQ     T1PTR$

      417     6587    4               END;

   6587 86 000534   000000 116000 66                 CMPQ    SSS$
        86 000535   000464 601000 86                 TNZ     s:6571

      418     6588    3           T1PTR$ = PINCRW(SSS$,RC.RCRSN);

   6588 86 000536   000000 470400 73                 LDP0    RC$
        86 000537   000002 720100                    LXL0    2,,PR0
        86 000540   000000 636010                    EAQ     0,X0
        86 000541   000000 036000 66                 ADLQ    SSS$
        86 000542   000064 756000 4                  STQ     T1PTR$

      419     6589    4           DO WHILE (T1PTR$ ~= SSS$);

   6589 86 000543   000000 116000 66                 CMPQ    SSS$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:102  
        86 000544   000623 600000 86                 TZE     s:6608

      420     6590    4               TPTR$ = PINCRW(SSS$, T1PTR$ -> RS.SCRSH);

   6590 86 000545   000064 470400 4                  LDP0    T1PTR$
        86 000546   000003 720100                    LXL0    3,,PR0
        86 000547   000000 636010                    EAQ     0,X0
        86 000550   000000 036000 66                 ADLQ    SSS$
        86 000551   000060 756000 4                  STQ     TPTR$

      421     6591    4               IF T1PTR$ -> RS.DEF.TYPE = '000000100000'B /* SM */

   6591 86 000552   000000 236100                    LDQ     0,,PR0
        86 000553   777700 376003                    ANQ     -64,DU
        86 000554   004000 116003                    CMPQ    2048,DU
        86 000555   000614 601000 86                 TNZ     s:6606
        86 000556   000060 471400 4                  LDP1    TPTR$
        86 000557   100000 721100                    LXL1    0,,PR1
        86 000560   000077 361003                    ANX1    63,DU
        86 000561   100003 236100                    LDQ     3,,PR1
        86 000562   777000 376003                    ANQ     -512,DU
        86 000563   052000 116003                    CMPQ    21504,DU
        86 000564   000614 600000 86                 TZE     s:6606
        86 000565   100000 236100                    LDQ     0,,PR1
        86 000566   000700 316007                    CANQ    448,DL
        86 000567   000614 601000 86                 TNZ     s:6606

      422     6592    4                  AND SUBSTR(TPTR$ -> SC.SNAM,0,1) ~= '*'
      423     6593    4                  AND TPTR$ -> SC.DEF.SETT = 0 /* USER-DEFINED SET */
      424     6594    5               THEN DO;

      425     6595    5                   IF FIRST_SM

   6595 86 000570   200012 234100                    SZN     FIRST_SM,,AUTO
        86 000571   000577 605000 86                 TPL     s:6601

      426     6596    6                   THEN DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:103  

      427     6597    6                       HEADING_SET = '    MEMBER OF SET: ';

   6597 86 000572   040000 100400                    MLR     fill='040'O
        86 000573   001157 000023 12                 ADSC9   ONE_CHANGE+25            cn=0,n=19
        86 000574   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

      428     6598    6                       FIRST_SM = '0'B;

   6598 86 000575   200012 450100                    STZ     FIRST_SM,,AUTO

      429     6599    6                       END;

   6599 86 000576   000602 710000 86                 TRA     s:6603

      430     6600    6                   ELSE DO;

      431     6601    6                       HEADING_SET = ' ';

   6601 86 000577   040000 100400                    MLR     fill='040'O
        86 000600   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 000601   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

      432     6602    6                       END;

      433     6603    5                   CALL CONCAT(LIST_STRING,HEADING_SET,TPTR$ -> SC.SNAM);

   6603 86 000602   040000 100400                    MLR     fill='040'O
        86 000603   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25
        86 000604   000000 000031 16                 ADSC9   LIST_STRING              cn=0,n=25
        86 000605   040000 100540                    MLR     fill='040'O
        86 000606   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        86 000607   000006 200147 16                 ADSC9   LIST_STRING+6            cn=1,n=103

      434     6604    5                   CALL LIST(LIST_STRING);

   6604 86 000610   000022 630400 87                 EPPR0   18
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:104  
        86 000611   000000 631400 87                 EPPR1   0
        86 000612   000000 701000 xent               TSX1    LIST
        86 000613   000000 011000                    NOP     0

      435     6605    5                   END;

      436     6606    4               T1PTR$ = PINCRW(SSS$,T1PTR$ -> RS.RCRSN);

   6606 86 000614   000064 470400 4                  LDP0    T1PTR$
        86 000615   000002 720100                    LXL0    2,,PR0
        86 000616   000000 636010                    EAQ     0,X0
        86 000617   000000 036000 66                 ADLQ    SSS$
        86 000620   000064 756000 4                  STQ     T1PTR$

      437     6607    4               END;

   6607 86 000621   000000 116000 66                 CMPQ    SSS$
        86 000622   000545 601000 86                 TNZ     s:6590

      438     6608    3           FIRST_AREA = '1'B;

   6608 86 000623   400000 236003                    LDQ     -131072,DU
        86 000624   200003 756100                    STQ     FIRST_AREA,,AUTO

      439     6609    3           T1PTR$ = PINCRW(SSS$,RC.RCRAN);

   6609 86 000625   000000 470400 73                 LDP0    RC$
        86 000626   000001 220100                    LDX0    1,,PR0
        86 000627   000000 636010                    EAQ     0,X0
        86 000630   000000 036000 66                 ADLQ    SSS$
        86 000631   000064 756000 4                  STQ     T1PTR$

      440     6610    4           DO WHILE (T1PTR$ ~= SSS$);

   6610 86 000632   000000 116000 66                 CMPQ    SSS$
        86 000633   000677 600000 86                 TZE     s:6625

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:105  
      441     6611    4               T9PTR$ = PINCRW(SSS$,T1PTR$ -> RA.ACRAH);

   6611 86 000634   000064 470400 4                  LDP0    T1PTR$
        86 000635   000002 720100                    LXL0    2,,PR0
        86 000636   000000 636010                    EAQ     0,X0
        86 000637   000000 036000 66                 ADLQ    SSS$
        86 000640   000076 756000 4                  STQ     T9PTR$

      442     6612    4               IF FIRST_AREA

   6612 86 000641   200003 234100                    SZN     FIRST_AREA,,AUTO
        86 000642   000650 605000 86                 TPL     s:6618

      443     6613    5               THEN DO;

      444     6614    5                   HEADING_SET = '    LOCATED IN AREA: ';

   6614 86 000643   040000 100400                    MLR     fill='040'O
        86 000644   001164 000025 12                 ADSC9   ONE_CHANGE+30            cn=0,n=21
        86 000645   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

      445     6615    5                   FIRST_AREA = '0'B;

   6615 86 000646   200003 450100                    STZ     FIRST_AREA,,AUTO

      446     6616    5                   END;

   6616 86 000647   000653 710000 86                 TRA     s:6620

      447     6617    5               ELSE DO;

      448     6618    5                   HEADING_SET = ' ';

   6618 86 000650   040000 100400                    MLR     fill='040'O
        86 000651   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 000652   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:106  
      449     6619    5                   END;

      450     6620    4               CALL CONCAT(LIST_STRING,HEADING_SET,T9PTR$ -> AC.ANAM);

   6620 86 000653   000076 471400 4                  LDP1    T9PTR$
        86 000654   100000 720100                    LXL0    0,,PR1
        86 000655   000077 360003                    ANX0    63,DU
        86 000656   040000 100400                    MLR     fill='040'O
        86 000657   000110 000031 4                  ADSC9   HEADING_SET              cn=0,n=25
        86 000660   000000 000031 16                 ADSC9   LIST_STRING              cn=0,n=25
        86 000661   040000 100540                    MLR     fill='040'O
        86 000662   100026 000010                    ADSC9   22,,PR1                  cn=0,n=*X0
        86 000663   000006 200147 16                 ADSC9   LIST_STRING+6            cn=1,n=103

      451     6621    4               CALL LIST(LIST_STRING);

   6621 86 000664   000022 630400 87                 EPPR0   18
        86 000665   000000 631400 87                 EPPR1   0
        86 000666   000000 701000 xent               TSX1    LIST
        86 000667   000000 011000                    NOP     0

      452     6622    4               T1PTR$ = PINCRW(SSS$, T1PTR$ -> RA.RCRAN);

   6622 86 000670   000064 470400 4                  LDP0    T1PTR$
        86 000671   000001 220100                    LDX0    1,,PR0
        86 000672   000000 636010                    EAQ     0,X0
        86 000673   000000 036000 66                 ADLQ    SSS$
        86 000674   000064 756000 4                  STQ     T1PTR$

      453     6623    4               END;

   6623 86 000675   000000 116000 66                 CMPQ    SSS$
        86 000676   000634 601000 86                 TNZ     s:6611

      454     6624    3           END;

      455     6625    2       IO_BUF = SAVE_BUF;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:107  

   6625 86 000677   040000 100400                    MLR     fill='040'O
        86 000700   000011 000200 4                  ADSC9   SAVE_BUF                 cn=0,n=128
        86 000701   000000 000200 62                 ADSC9   IO_BUF                   cn=0,n=128

      456     6626    2       RETURN;

   6626 86 000702   200014 221300                    LDX1  ! FIRST_KEY+1,,AUTO
        86 000703   000001 702211                    TSX2  ! 1,X1

      457     6627    2   DBCS_ERR:
      458     6628    2       CALL ABORT;

   6628 86 000704   000005 631400 87    DBCS_ERR     EPPR1   5
        86 000705   000000 701000 xent               TSX1    ABORT
        86 000706   000000 011000                    NOP     0

      459     6629    2   END ZIG$V_CHECK_F;

   6629 86 000707   200014 221300                    LDX1  ! FIRST_KEY+1,,AUTO
        86 000710   000001 702211                    TSX2  ! 1,X1

      460     6630        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:108  
      461     6631        /*
      462     6632         AAA  DDDD  DDDD         SSS  PPPP  EEEEE  CCC   AAA  L
      463     6633        A   A D   D D   D       S   S P   P E     C   C A   A L
      464     6634        A   A D   D D   D       S     P   P E     C     A   A L
      465     6635        AAAAA D   D D   D        SSS  PPPP  EEEE  C     AAAAA L
      466     6636        A   A D   D D   D           S P     E     C     A   A L
      467     6637        A   A D   D D   D       S   S P     E     C   C A   A L
      468     6638        A   A DDDD  DDDD         SSS  P     EEEEE  CCC  A   A LLLLL
      469     6639                          _____
      470     6640
      471     6641
      472     6642              RRRR  EEEEE  CCC
      473     6643              R   R E     C   C
      474     6644              R   R E     C
      475     6645              RRRR  EEEE  C
      476     6646              R R   E     C
      477     6647              R  R  E     C   C
      478     6648              R   R EEEEE  CCC
      479     6649        _____
      480     6650        */
      481     6651    1   ADD_SPECIAL_REC:

   6651 86 000711   200014 741300       ADD_SPECIAL* STX1  ! FIRST_KEY+1,,AUTO

      482     6652    1       PROC;
      483     6653
      484     6654    2   DCL LEN_UBIN UBIN(36);
      485     6655
      486     6656    2       SAVE_BUF = IO_BUF;

   6656 86 000712   040000 100400                    MLR     fill='040'O
        86 000713   000000 000200 62                 ADSC9   IO_BUF                   cn=0,n=128
        86 000714   000011 000200 4                  ADSC9   SAVE_BUF                 cn=0,n=128

      487     6657    2       SAVED_FR_NAMES = VALIDS.FR_NAMES;

   6657 86 000715   000000 236000 31                 LDQ     VALIDS
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:109  
        86 000716   000013 736000                    QLS     11
        86 000717   400000 376003                    ANQ     -131072,DU
        86 000720   000166 756000 4                  STQ     SAVED_FR_NAMES

      488     6658    2       VALIDS.FR_NAMES = '1'B;

   6658 86 000721   000100 236003                    LDQ     64,DU
        86 000722   000000 256000 31                 ORSQ    VALIDS

      489     6659    2       TYPE_400.RECORD_NAME = '*CALC.RC';

   6659 86 000723   040000 100400                    MLR     fill='040'O
        86 000724   001172 000010 12                 ADSC9   ONE_CHANGE+36            cn=0,n=8
        86 000725   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

      490     6660    2       TYPE_400.SUB_RECORD_NAME = '*CALC.RC';

   6660 86 000726   040000 100400                    MLR     fill='040'O
        86 000727   001172 000010 12                 ADSC9   ONE_CHANGE+36            cn=0,n=8
        86 000730   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

      491     6661    2       TYPE_400.REF_LINE = 0;

   6661 86 000731   000001 450000 62                 STZ     IO_BUF+1

      492     6662    2       TYPE_400.ID_NUM = 0;

   6662 86 000732   000023 450000 62                 STZ     IO_BUF+19

      493     6663    2       CALL ZIG$V_RECORD;

   6663 86 000733   000005 631400 87                 EPPR1   5
        86 000734   000000 701000 xent               TSX1    ZIG$V_RECORD
        86 000735   000000 011000                    NOP     0

      494     6664    2       IF RECORD_FOUND

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:110  
   6664 86 000736   000000 234000 15                 SZN     RECORD_FOUND
        86 000737   000755 605000 86                 TPL     s:6670

      495     6665    3       THEN DO;

      496     6666    3           OA.CLCRC = POFFW(RC$,SSS$);

   6666 86 000740   000000 235000 66                 LDA     SSS$
        86 000741   000022 771000                    ARL     18
        86 000742   200030 755100                    STA     COUNT1+2,,AUTO
        86 000743   000000 236000 73                 LDQ     RC$
        86 000744   000022 772000                    QRL     18
        86 000745   200030 136100                    SBLQ    COUNT1+2,,AUTO
        86 000746   000000 620006                    EAX0    0,QL
        86 000747   000000 470400 75                 LDP0    OA$
        86 000750   000003 440100                    SXL0    3,,PR0

      497     6667    3           RC.DEF.SR = '1'B; /* Record not in subschema */

   6667 86 000751   000000 471400 73                 LDP1    RC$
        86 000752   100000 236007                    LDQ     32768,DL
        86 000753   100000 256100                    ORSQ    0,,PR1

      498     6668    3           END;

   6668 86 000754   000760 710000 86                 TRA     s:6672

      499     6669    3       ELSE DO;

      500     6670    3           OA.CLCRC = 0;

   6670 86 000755   000000 220003                    LDX0    0,DU
        86 000756   000000 470400 75                 LDP0    OA$
        86 000757   000003 440100                    SXL0    3,,PR0

      501     6671    3           END;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:111  
      502     6672    3       DO WHILE (RECORD_FOUND);

   6672 86 000760   000000 234000 15                 SZN     RECORD_FOUND
        86 000761   001026 605000 86                 TPL     DONE_FR_CALC

      503     6673    3           CALL FETCHNS_6('RC-FR   ') ALTRET(DONE_FR_CALC);

   6673 86 000762   000023 630400 87                 EPPR0   19
        86 000763   000000 631400 87                 EPPR1   0
        86 000764   000000 701000 xent               TSX1    FETCHNS_6
        86 000765   001026 702000 86                 TSX2    DONE_FR_CALC

      504     6674    3           FR_DBK = UWA.DIRECT_REF;

   6674 86 000766   000036 235000 54                 LDA     UWA+30
        86 000767   000054 755000 4                  STA     FR_DBK

      505     6675    3           CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);

   6675 86 000770   000004 630400 87                 EPPR0   4
        86 000771   000000 631400 87                 EPPR1   0
        86 000772   000000 701000 xent               TSX1    FETCHOS_6
        86 000773   001607 702000 86                 TSX2    DBCS_ERR

      506     6676    3           UWA.DIRECT_REF = FR_DBK;

   6676 86 000774   000054 235000 4                  LDA     FR_DBK
        86 000775   000036 755000 54                 STA     UWA+30

      507     6677    3           TYPE_430.FIELD_NAME = UWA.SN.SENAME;

   6677 86 000776   040000 100400                    MLR     fill='040'O
        86 000777   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 001000   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

      508     6678    3           TYPE_430.SUB_FIELD_NAME = UWA.SN.SENAME;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:112  
   6678 86 001001   040000 100400                    MLR     fill='040'O
        86 001002   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 001003   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

      509     6679    3           CALL CHANGE_TO_STR(TYPE_430.SUB_FIELD_NAME);

   6679 86 001004   000015 236000 87                 LDQ     13
        86 001005   200025 756100                    STQ     @ALI+1,,AUTO
        86 001006   002414 701000 86                 TSX1    CHANGE_TO_STR
        86 001007   000000 011000                    NOP     0

      510     6680    3           TYPE_430.TYPE = 430;

   6680 86 001010   000656 235007                    LDA     430,DL
        86 001011   000000 755000 62                 STA     IO_BUF

      511     6681    3           TYPE_430.OFFSET = 0;

   6681 86 001012   000023 450000 62                 STZ     IO_BUF+19

      512     6682    3           TYPE_430.REF_LINE = 0;

   6682 86 001013   000001 450000 62                 STZ     IO_BUF+1

      513     6683    3           TYPE_430.ELEMENTARY = '1'B;

   6683 86 001014   400000 236003                    LDQ     -131072,DU
        86 001015   000030 256000 62                 ORSQ    IO_BUF+24

      514     6684    3           CALL ZIG$V_FIELD;

   6684 86 001016   000005 631400 87                 EPPR1   5
        86 001017   000000 701000 xent               TSX1    ZIG$V_FIELD
        86 001020   000000 011000                    NOP     0

      515     6685    3           FR.DEF.FSR = '1'B;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:113  
   6685 86 001021   000000 470400 69                 LDP0    FR$
        86 001022   000100 236007                    LDQ     64,DL
        86 001023   000000 256100                    ORSQ    0,,PR0

      516     6686    3           END;

   6686 86 001024   000000 234000 15                 SZN     RECORD_FOUND
        86 001025   000762 604000 86                 TMI     s:6673

      517     6687    2   DONE_FR_CALC:
      518     6688    2       IF UWA.DB_STATUS ~= '0502100' AND RECORD_FOUND THEN CALL ABORT;

   6688 86 001026   040000 106400       DONE_FR_CALC CMPC    fill='040'O
        86 001027   000001 000007 54                 ADSC9   UWA+1                    cn=0,n=7
        86 001030   001140 000007 12                 ADSC9   ONE_CHANGE+10            cn=0,n=7
        86 001031   001037 600000 86                 TZE     s:6689
        86 001032   000000 234000 15                 SZN     RECORD_FOUND
        86 001033   001037 605000 86                 TPL     s:6689

   6688 86 001034   000005 631400 87                 EPPR1   5
        86 001035   000000 701000 xent               TSX1    ABORT
        86 001036   000000 011000                    NOP     0

      519     6689    2       TYPE_400.RECORD_NAME = '*DBPARAM';

   6689 86 001037   040000 100400                    MLR     fill='040'O
        86 001040   001176 000010 12                 ADSC9   ONE_CHANGE+40            cn=0,n=8
        86 001041   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

      520     6690    2       TYPE_400.SUB_RECORD_NAME = '*DBPARAM';

   6690 86 001042   040000 100400                    MLR     fill='040'O
        86 001043   001176 000010 12                 ADSC9   ONE_CHANGE+40            cn=0,n=8
        86 001044   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

      521     6691    2       TYPE_400.REF_LINE = 0;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:114  
   6691 86 001045   000001 450000 62                 STZ     IO_BUF+1

      522     6692    2       TYPE_400.ID_NUM = 0;

   6692 86 001046   000023 450000 62                 STZ     IO_BUF+19

      523     6693    2       IF MOD(OA.UWSZ,8) ~= 0

   6693 86 001047   000000 470400 75                 LDP0    OA$
        86 001050   000020 236100                    LDQ     16,,PR0
        86 001051   000022 772000                    QRL     18
        86 001052   000007 376007                    ANQ     7,DL
        86 001053   001065 600000 86                 TZE     s:6695

      524     6694    2       THEN OA.UWSZ = OA.UWSZ + 8 - MOD(OA.UWSZ,8);

   6694 86 001054   000020 236100                    LDQ     16,,PR0
        86 001055   000022 772000                    QRL     18
        86 001056   000007 376007                    ANQ     7,DL
        86 001057   200030 756100                    STQ     COUNT1+2,,AUTO
        86 001060   000020 236100                    LDQ     16,,PR0
        86 001061   000022 772000                    QRL     18
        86 001062   200030 136100                    SBLQ    COUNT1+2,,AUTO
        86 001063   000010 620006                    EAX0    8,QL
        86 001064   000020 740100                    STX0    16,,PR0

      525     6695    2       CALL ZIG$V_RECORD;

   6695 86 001065   000005 631400 87                 EPPR1   5
        86 001066   000000 701000 xent               TSX1    ZIG$V_RECORD
        86 001067   000000 011000                    NOP     0

      526     6696    2       RC.DEF.SR = '1'B; /* Record not in subschema */

   6696 86 001070   000000 470400 73                 LDP0    RC$
        86 001071   100000 236007                    LDQ     32768,DL
        86 001072   000000 256100                    ORSQ    0,,PR0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:115  

      527     6697    2       IF RECORD_FOUND AND VALIDS.PARAM_XREF

   6697 86 001073   000000 234000 15                 SZN     RECORD_FOUND
        86 001074   001104 605000 86                 TPL     s:6701
        86 001075   000000 236000 31                 LDQ     VALIDS
        86 001076   000010 316003                    CANQ    8,DU
        86 001077   001104 600000 86                 TZE     s:6701

      528     6698    3       THEN DO;

      529     6699    3           CALL SUBLST(HEAD_DATA_PAR);

   6699 86 001100   000024 630400 87                 EPPR0   20
        86 001101   000000 631400 87                 EPPR1   0
        86 001102   000000 701000 xent               TSX1    SUBLST
        86 001103   000000 011000                    NOP     0

      530     6700    3           END;

      531     6701    2       LAST_FILLER = CONTROL.LAST_FILLER_NUM;

   6701 86 001104   000070 235000 63                 LDA     CONTROL+56
        86 001105   000022 771000                    ARL     18
        86 001106   000070 755000 4                  STA     LAST_FILLER

      532     6702    2       IF RECORD_FOUND AND SUB_LANGUAGE = #FORTRAN AND CONTROL.LAST_FILLER_LEN ~= 0

   6702 86 001107   000000 234000 15                 SZN     RECORD_FOUND
        86 001110   001224 605000 86                 TPL     s:6722
        86 001111   000000 236000 57                 LDQ     SUB_LANGUAGE
        86 001112   000002 116007                    CMPQ    2,DL
        86 001113   001224 601000 86                 TNZ     s:6722
        86 001114   000070 720000 63                 LXL0    CONTROL+56
        86 001115   001224 600000 86                 TZE     s:6722

      533     6703    3       THEN DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:116  

      534     6704    3           CALL SET_FIELD_NUM(1,LAST_FILLER);

   6704 86 001116   000025 630400 87                 EPPR0   21
        86 001117   000013 631400 87                 EPPR1   11
        86 001120   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 001121   000000 011000                    NOP     0

      535     6705    3           CALL CONCAT(TEMP_WORD,'FILL',SUBSTR(FIELD1.TEXT1,0,4));

   6705 86 001122   001200 236000 12                 LDQ     ONE_CHANGE+42
        86 001123   000001 756000 4                  STQ     TEMP_WORD
        86 001124   040000 100400                    MLR     fill='040'O
        86 001125   000000 200004 18                 ADSC9   FIELD1                   cn=1,n=4
        86 001126   000002 000032 4                  ADSC9   TEMP_WORD+1              cn=0,n=26

      536     6706    3           LAST_FILLER = LAST_FILLER + 1;

   6706 86 001127   000070 235000 4                  LDA     LAST_FILLER
        86 001130   000001 035007                    ADLA    1,DL
        86 001131   000070 755000 4                  STA     LAST_FILLER

      537     6707    3           CALL CONCAT(LIST_STRING,'     +               ',

   6707 86 001132   040000 100400                    MLR     fill='040'O
        86 001133   001201 000025 12                 ADSC9   ONE_CHANGE+43            cn=0,n=21
        86 001134   000000 000025 16                 ADSC9   LIST_STRING              cn=0,n=21
        86 001135   040000 100400                    MLR     fill='040'O
        86 001136   000001 000010 4                  ADSC9   TEMP_WORD                cn=0,n=8
        86 001137   000005 200010 16                 ADSC9   LIST_STRING+5            cn=1,n=8
        86 001140   040000 100400                    MLR     fill='040'O
        86 001141   000027 000001 87                 ADSC9   23                       cn=0,n=1
        86 001142   000007 200143 16                 ADSC9   LIST_STRING+7            cn=1,n=99

      538     6708    3              SUBSTR(TEMP_WORD,0,8),',');
      539     6709    3           CALL WRITE_UWA;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:117  
   6709 86 001143   002456 701000 86                 TSX1    WRITE_UWA
        86 001144   000000 011000                    NOP     0

      540     6710    3           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;

   6710 86 001145   000001 235000 44                 LDA     UWA_KEY+1
        86 001146   000164 755000 4                  STA     SAVE_LAST_UWA

      541     6711    3           UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;

   6711 86 001147   000000 236000 45                 LDQ     NEXT_UWA_SECOND_HALF
        86 001150   000001 756000 44                 STQ     UWA_KEY+1

      542     6712    3           CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(0),

   6712 86 001151   040000 100400                    MLR     fill='040'O
        86 001152   001203 000007 12                 ADSC9   ONE_CHANGE+45            cn=0,n=7
        86 001153   000000 000007 16                 ADSC9   LIST_STRING              cn=0,n=7
        86 001154   040000 100400                    MLR     fill='040'O
        86 001155   000610 000024 12                 ADSC9   DATA_TYPE_NAME           cn=0,n=20
        86 001156   000001 600024 16                 ADSC9   LIST_STRING+1            cn=3,n=20
        86 001157   040000 100400                    MLR     fill='040'O
        86 001160   000001 000010 4                  ADSC9   TEMP_WORD                cn=0,n=8
        86 001161   000006 600145 16                 ADSC9   LIST_STRING+6            cn=3,n=101

      543     6713    3              SUBSTR(TEMP_WORD,0,8));
      544     6714    3           LEN_UBIN = CONTROL.LAST_FILLER_LEN;

   6714 86 001162   000070 236000 63                 LDQ     CONTROL+56
        86 001163   777777 376007                    ANQ     -1,DL
        86 001164   200015 756100                    STQ     LEN_UBIN,,AUTO

      545     6715    3           CALL SET_FIELD_NUM(1,LEN_UBIN);

   6715 86 001165   200015 630500                    EPPR0   LEN_UBIN,,AUTO
        86 001166   200031 450500                    STP0    COUNT1+3,,AUTO
        86 001167   000010 236000 87                 LDQ     8
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:118  
        86 001170   200030 756100                    STQ     COUNT1+2,,AUTO
        86 001171   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 001172   000013 631400 87                 EPPR1   11
        86 001173   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 001174   000000 011000                    NOP     0

      546     6716    3           CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,'*',

   6716 86 001175   000000 236000 18                 LDQ     FIELD1
        86 001176   000033 772000                    QRL     27
        86 001177   000000 620006                    EAX0    0,QL
        86 001200   000000 236000 18                 LDQ     FIELD1
        86 001201   000033 772000                    QRL     27
        86 001202   000001 621006                    EAX1    1,QL
        86 001203   040040 100400                    MLR     fill='040'O
        86 001204   000030 000001 87                 ADSC9   24                       cn=0,n=1
        86 001205   000004 000011 16                 ADSC9   LIST_STRING+4            cn=0,n=*X1
        86 001206   000000 636011                    EAQ     0,X1
        86 001207   000022 772000                    QRL     18
        86 001210   000002 116007                    CMPQ    2,DL
        86 001211   001216 602000 86                 TNC     s:6718
        86 001212   777777 622011                    EAX2    -1,X1
        86 001213   040040 100440                    MLR     fill='040'O
        86 001214   000000 200010 18                 ADSC9   FIELD1                   cn=1,n=*X0
        86 001215   000004 200012 16                 ADSC9   LIST_STRING+4            cn=1,n=*X2

      547     6717    3              SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      548     6718    3           CALL WRITE_UWA;

   6718 86 001216   002456 701000 86                 TSX1    WRITE_UWA
        86 001217   000000 011000                    NOP     0

      549     6719    3           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;

   6719 86 001220   000001 235000 44                 LDA     UWA_KEY+1
        86 001221   000000 755000 45                 STA     NEXT_UWA_SECOND_HALF

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:119  
      550     6720    3           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;

   6720 86 001222   000164 236000 4                  LDQ     SAVE_LAST_UWA
        86 001223   000001 756000 44                 STQ     UWA_KEY+1

      551     6721    3           END;

      552     6722    3       DO WHILE (RECORD_FOUND);

   6722 86 001224   000000 234000 15                 SZN     RECORD_FOUND
        86 001225   001564 605000 86                 TPL     DONE_FR_PARA

      553     6723    3           CALL FETCHNS_6('RC-FR   ') ALTRET(DONE_FR_PARA);

   6723 86 001226   000023 630400 87                 EPPR0   19
        86 001227   000000 631400 87                 EPPR1   0
        86 001230   000000 701000 xent               TSX1    FETCHNS_6
        86 001231   001564 702000 86                 TSX2    DONE_FR_PARA

      554     6724    3           FR_DBK = UWA.DIRECT_REF;

   6724 86 001232   000036 235000 54                 LDA     UWA+30
        86 001233   000054 755000 4                  STA     FR_DBK

      555     6725    3           CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);

   6725 86 001234   000004 630400 87                 EPPR0   4
        86 001235   000000 631400 87                 EPPR1   0
        86 001236   000000 701000 xent               TSX1    FETCHOS_6
        86 001237   001607 702000 86                 TSX2    DBCS_ERR

      556     6726    3           UWA.DIRECT_REF = FR_DBK;

   6726 86 001240   000054 235000 4                  LDA     FR_DBK
        86 001241   000036 755000 54                 STA     UWA+30

      557     6727    3           TYPE_430.FIELD_NAME = UWA.SN.SENAME;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:120  

   6727 86 001242   040000 100400                    MLR     fill='040'O
        86 001243   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 001244   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

      558     6728    3           TYPE_430.SUB_FIELD_NAME = UWA.SN.SENAME;

   6728 86 001245   040000 100400                    MLR     fill='040'O
        86 001246   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 001247   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

      559     6729    3           CALL CHANGE_TO_STR(TYPE_430.SUB_FIELD_NAME);

   6729 86 001250   000015 236000 87                 LDQ     13
        86 001251   200025 756100                    STQ     @ALI+1,,AUTO
        86 001252   002414 701000 86                 TSX1    CHANGE_TO_STR
        86 001253   000000 011000                    NOP     0

      560     6730    3           TYPE_430.TYPE = 430;

   6730 86 001254   000656 235007                    LDA     430,DL
        86 001255   000000 755000 62                 STA     IO_BUF

      561     6731    3           TYPE_430.OFFSET = 0;

   6731 86 001256   000023 450000 62                 STZ     IO_BUF+19

      562     6732    3           TYPE_430.REF_LINE = 0;

   6732 86 001257   000001 450000 62                 STZ     IO_BUF+1

      563     6733    3           TYPE_430.LEVEL_FIELD = 2;

   6733 86 001260   000002 236007                    LDQ     2,DL
        86 001261   000027 756000 62                 STQ     IO_BUF+23

      564     6734    3           TYPE_430.ELEMENTARY = '1'B;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:121  

   6734 86 001262   400000 236003                    LDQ     -131072,DU
        86 001263   000030 256000 62                 ORSQ    IO_BUF+24

      565     6735    3           CALL ALLOCATE_PARAMETER;

   6735 86 001264   001614 701000 86                 TSX1    ALLOCATE_PARAMETER
        86 001265   000000 011000                    NOP     0

      566     6736    3           TYPE_430.ELEMENTARY = '1'B;

   6736 86 001266   400000 236003                    LDQ     -131072,DU
        86 001267   000030 256000 62                 ORSQ    IO_BUF+24

      567     6737    3           CALL ZIG$V_FIELD;

   6737 86 001270   000005 631400 87                 EPPR1   5
        86 001271   000000 701000 xent               TSX1    ZIG$V_FIELD
        86 001272   000000 011000                    NOP     0

      568     6738    3           CALL INIT_TYPE_9_DBPARAM;

   6738 86 001273   002254 701000 86                 TSX1    INIT_TYPE_9_DBPARAM
        86 001274   000000 011000                    NOP     0

      569     6739    3           CALL WRITSF(CUR_EXT_NAME_SEG,TYPE_9);

   6739 86 001275   000031 630400 87                 EPPR0   25
        86 001276   000013 631400 87                 EPPR1   11
        86 001277   000000 701000 xent               TSX1    WRITSF
        86 001300   000000 011000                    NOP     0

      570     6740    3           CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;

   6740 86 001301   000000 235000 23                 LDA     CUR_EXT_NAME_SEG
        86 001302   000001 035007                    ADLA    1,DL
        86 001303   000000 755000 23                 STA     CUR_EXT_NAME_SEG
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:122  

      571     6741        /*
      572     6742              Write out the type 9 descriptor for the data base parameters
      573     6743            that are not part of a record into the extented name segment
      574     6744            of the subschema file.
      575     6745        */
      576     6746    3           CONTROL.NUM_DB_PARAM = CONTROL.NUM_DB_PARAM + 1;

   6746 86 001304   000015 236000 63                 LDQ     CONTROL+13
        86 001305   000001 036007                    ADLQ    1,DL
        86 001306   000015 756000 63                 STQ     CONTROL+13

      577     6747    3           FR.DEF.FSR = '1'B;

   6747 86 001307   000000 470400 69                 LDP0    FR$
        86 001310   000100 236007                    LDQ     64,DL
        86 001311   000000 256100                    ORSQ    0,,PR0

      578     6748    3           IF VALIDS.PARAM_XREF

   6748 86 001312   000000 236000 31                 LDQ     VALIDS
        86 001313   000010 316003                    CANQ    8,DU
        86 001314   001446 600000 86                 TZE     s:6771

      579     6749    4           THEN DO;

      580     6750    4               I = FR.UOFST.EIS.FRID/8;

   6750 86 001315   000000 470400 69                 LDP0    FR$
        86 001316   000002 236100                    LDQ     2,,PR0
        86 001317   000017 772000                    QRL     15
        86 001320   777777 376007                    ANQ     -1,DL
        86 001321   000003 772000                    QRL     3
        86 001322   000052 756000 4                  STQ     I

      581     6751    4               CALL SET_FIELD_NUM(1,I);

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:123  
   6751 86 001323   000033 630400 87                 EPPR0   27
        86 001324   000013 631400 87                 EPPR1   11
        86 001325   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 001326   000000 011000                    NOP     0

      582     6752    4               WORD_OFFSET = ' ';

   6752 86 001327   040000 100400                    MLR     fill='040'O
        86 001330   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 001331   000167 000006 4                  ADSC9   WORD_OFFSET              cn=0,n=6

      583     6753    4               CALL INSERT(WORD_OFFSET,5-FIELD1.COUNT1,FIELD1.COUNT1,

   6753 86 001332   000000 236000 18                 LDQ     FIELD1
        86 001333   000033 772000                    QRL     27
        86 001334   000000 620006                    EAX0    0,QL
        86 001335   000000 236000 18                 LDQ     FIELD1
        86 001336   000033 772000                    QRL     27
        86 001337   200030 756100                    STQ     COUNT1+2,,AUTO
        86 001340   000000 235003                    LDA     0,DU
        86 001341   200030 135100                    SBLA    COUNT1+2,,AUTO
        86 001342   000000 621006                    EAX1    0,QL
        86 001343   040045 100440                    MLR     fill='040'O
        86 001344   000000 200010 18                 ADSC9   FIELD1                   cn=1,n=*X0
        86 001345   000170 200011 4                  ADSC9   WORD_OFFSET+1,A          cn=1,n=*X1

      584     6754    4                  SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      585     6755    4               I = ( FR.UOFST.EIS.FRID - (I * 8)) / 2;

   6755 86 001346   000000 470400 69                 LDP0    FR$
        86 001347   000002 236100                    LDQ     2,,PR0
        86 001350   000017 772000                    QRL     15
        86 001351   777777 376007                    ANQ     -1,DL
        86 001352   200030 756100                    STQ     COUNT1+2,,AUTO
        86 001353   000000 236003                    LDQ     0,DU
        86 001354   000052 136000 4                  SBLQ    I
        86 001355   000003 736000                    QLS     3
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:124  
        86 001356   200030 036100                    ADLQ    COUNT1+2,,AUTO
        86 001357   000002 506007                    DIV     2,DL
        86 001360   000052 756000 4                  STQ     I

      586     6756    4               CALL SET_FIELD_NUM(1,I);

   6756 86 001361   000033 630400 87                 EPPR0   27
        86 001362   000013 631400 87                 EPPR1   11
        86 001363   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 001364   000000 011000                    NOP     0

      587     6757    4               I = MOD( FR.UOFST.EIS.FRID, 2);

   6757 86 001365   000000 470400 69                 LDP0    FR$
        86 001366   000002 236100                    LDQ     2,,PR0
        86 001367   000017 772000                    QRL     15
        86 001370   777777 376007                    ANQ     -1,DL
        86 001371   000001 376007                    ANQ     1,DL
        86 001372   000052 756000 4                  STQ     I

      588     6758    4               IF I = 1

   6758 86 001373   000001 116007                    CMPQ    1,DL
        86 001374   001400 601000 86                 TNZ     s:6763

      589     6759    5               THEN DO;

      590     6760    5                   NIBLE_OFF = '1';

   6760 86 001375   061000 236003                    LDQ     25088,DU
        86 001376   000171 756000 4                  STQ     NIBLE_OFF

      591     6761    5                   END;

   6761 86 001377   001402 710000 86                 TRA     s:6765

      592     6762    5               ELSE DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:125  

      593     6763    5                   NIBLE_OFF = '0';

   6763 86 001400   060000 236003                    LDQ     24576,DU
        86 001401   000171 756000 4                  STQ     NIBLE_OFF

      594     6764    5                   END;

      595     6765    4               CALL CONCAT(NUM_OFF,WORD_OFFSET,' ',SUBSTR(FIELD1.TEXT1,0,1),

   6765 86 001402   040000 100400                    MLR     fill='040'O
        86 001403   000167 000006 4                  ADSC9   WORD_OFFSET              cn=0,n=6
        86 001404   000172 000006 4                  ADSC9   NUM_OFF                  cn=0,n=6
        86 001405   040000 236007                    LDQ     16384,DL
        86 001406   000173 552010 4                  STBQ    NUM_OFF+1,'10'O
        86 001407   000000 236000 18                 LDQ     FIELD1
        86 001410   000022 772000                    QRL     18
        86 001411   000173 552004 4                  STBQ    NUM_OFF+1,'04'O
        86 001412   040000 236003                    LDQ     16384,DU
        86 001413   000174 756000 4                  STQ     NUM_OFF+2
        86 001414   000171 236000 4                  LDQ     NIBLE_OFF
        86 001415   777000 376003                    ANQ     -512,DU
        86 001416   000035 276000 87                 ORQ     29
        86 001417   000011 772000                    QRL     9
        86 001420   000174 552034 4                  STBQ    NUM_OFF+2,'34'O

      596     6766    4                  ' ',NIBLE_OFF);
      597     6767    4               CALL CONCAT(LIST_STRING,'     ',NUM_OFF,TYPE_430.SUB_FIELD_NAME,

   6767 86 001421   040000 100400                    MLR     fill='040'O
        86 001422   001201 000005 12                 ADSC9   ONE_CHANGE+43            cn=0,n=5
        86 001423   000000 000005 16                 ADSC9   LIST_STRING              cn=0,n=5
        86 001424   040000 100400                    MLR     fill='040'O
        86 001425   000172 000014 4                  ADSC9   NUM_OFF                  cn=0,n=12
        86 001426   000001 200014 16                 ADSC9   LIST_STRING+1            cn=1,n=12
        86 001427   040000 100400                    MLR     fill='040'O
        86 001430   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:126  
        86 001431   000004 200036 16                 ADSC9   LIST_STRING+4            cn=1,n=30
        86 001432   040000 100400                    MLR     fill='040'O
        86 001433   001201 000005 12                 ADSC9   ONE_CHANGE+43            cn=0,n=5
        86 001434   000013 600005 16                 ADSC9   LIST_STRING+11           cn=3,n=5
        86 001435   000024 236000 62                 LDQ     IO_BUF+20
        86 001436   000024 402007                    MPY     20,DL
        86 001437   040000 100406                    MLR     fill='040'O
        86 001440   000610 000024 12                 ADSC9   DATA_TYPE_NAME,Q         cn=0,n=20
        86 001441   000015 000114 16                 ADSC9   LIST_STRING+13           cn=0,n=76

      598     6768    4                  '     ',DATA_TYPE_NAME(TYPE_430.DATA_TYPE));
      599     6769    4               CALL LIST(LIST_STRING);

   6769 86 001442   000022 630400 87                 EPPR0   18
        86 001443   000000 631400 87                 EPPR1   0
        86 001444   000000 701000 xent               TSX1    LIST
        86 001445   000000 011000                    NOP     0

      600     6770    4               END;

      601     6771    3           IF SUB_LANGUAGE = #FORTRAN

   6771 86 001446   000000 235000 57                 LDA     SUB_LANGUAGE
        86 001447   000002 115007                    CMPA    2,DL
        86 001450   001562 601000 86                 TNZ     s:6792

      602     6772    4           THEN DO;

      603     6773    4               CALL INDEX1(I,' ',TYPE_430.SUB_FIELD_NAME);

   6773 86 001451   000000 124400                    SCM     mask='000'O
        86 001452   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30
        86 001453   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 001454   000052 000000 4                  ARG     I

      604     6774    4               CALL CONCAT(LIST_STRING,'     +               ',

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:127  
   6774 86 001455   040000 100400                    MLR     fill='040'O
        86 001456   001201 000025 12                 ADSC9   ONE_CHANGE+43            cn=0,n=21
        86 001457   000000 000025 16                 ADSC9   LIST_STRING              cn=0,n=21
        86 001460   000052 720000 4                  LXL0    I
        86 001461   000001 621010                    EAX1    1,X0
        86 001462   040000 100440                    MLR     fill='040'O
        86 001463   000013 000011 62                 ADSC9   IO_BUF+11                cn=0,n=*X1
        86 001464   000005 200153 16                 ADSC9   LIST_STRING+5            cn=1,n=107
        86 001465   000052 236000 4                  LDQ     I
        86 001466   000152 116007                    CMPQ    106,DL
        86 001467   001475 603000 86                 TRC     s:6776
        86 001470   777625 622006                    EAX2    -107,QL
        86 001471   777777 662003                    ERX2    -1,DU
        86 001472   040046 100400                    MLR     fill='040'O
        86 001473   000027 000001 87                 ADSC9   23                       cn=0,n=1
        86 001474   000005 400012 16                 ADSC9   LIST_STRING+5,Q          cn=2,n=*X2

      605     6775    4                  SUBSTR(TYPE_430.SUB_FIELD_NAME,0,I+1),',');
      606     6776    4               CALL WRITE_UWA;

   6776 86 001475   002456 701000 86                 TSX1    WRITE_UWA
        86 001476   000000 011000                    NOP     0

      607     6777    4               SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;

   6777 86 001477   000001 235000 44                 LDA     UWA_KEY+1
        86 001500   000164 755000 4                  STA     SAVE_LAST_UWA

      608     6778    4               UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;

   6778 86 001501   000000 236000 45                 LDQ     NEXT_UWA_SECOND_HALF
        86 001502   000001 756000 44                 STQ     UWA_KEY+1

      609     6779    4               CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(

   6779 86 001503   040000 100400                    MLR     fill='040'O
        86 001504   001203 000007 12                 ADSC9   ONE_CHANGE+45            cn=0,n=7
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:128  
        86 001505   000000 000007 16                 ADSC9   LIST_STRING              cn=0,n=7
        86 001506   000024 236000 62                 LDQ     IO_BUF+20
        86 001507   000024 402007                    MPY     20,DL
        86 001510   040000 100406                    MLR     fill='040'O
        86 001511   000610 000024 12                 ADSC9   DATA_TYPE_NAME,Q         cn=0,n=20
        86 001512   000001 600024 16                 ADSC9   LIST_STRING+1            cn=3,n=20
        86 001513   040000 100400                    MLR     fill='040'O
        86 001514   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30
        86 001515   000006 600145 16                 ADSC9   LIST_STRING+6            cn=3,n=101

      610     6780    4                  TYPE_430.DATA_TYPE),TYPE_430.SUB_FIELD_NAME);
      611     6781    4               IF TYPE_430.DATA_TYPE = 0

   6781 86 001516   000024 235000 62                 LDA     IO_BUF+20
        86 001517   001545 601000 86                 TNZ     s:6787

      612     6782    5               THEN DO;

      613     6783    5                   CALL SET_FIELD_NUM(1,TYPE_430.LEN_FIELD);

   6783 86 001520   000036 630400 87                 EPPR0   30
        86 001521   000013 631400 87                 EPPR1   11
        86 001522   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 001523   000000 011000                    NOP     0

      614     6784    5                   CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,

   6784 86 001524   000000 236000 18                 LDQ     FIELD1
        86 001525   000033 772000                    QRL     27
        86 001526   000000 620006                    EAX0    0,QL
        86 001527   000000 236000 18                 LDQ     FIELD1
        86 001530   000033 772000                    QRL     27
        86 001531   000001 621006                    EAX1    1,QL
        86 001532   040040 100400                    MLR     fill='040'O
        86 001533   000030 000001 87                 ADSC9   24                       cn=0,n=1
        86 001534   000004 000011 16                 ADSC9   LIST_STRING+4            cn=0,n=*X1
        86 001535   000000 636011                    EAQ     0,X1
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:129  
        86 001536   000022 772000                    QRL     18
        86 001537   000002 116007                    CMPQ    2,DL
        86 001540   001545 602000 86                 TNC     s:6787
        86 001541   777777 622011                    EAX2    -1,X1
        86 001542   040040 100440                    MLR     fill='040'O
        86 001543   000000 200010 18                 ADSC9   FIELD1                   cn=1,n=*X0
        86 001544   000004 200012 16                 ADSC9   LIST_STRING+4            cn=1,n=*X2

      615     6785    5                      '*',SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      616     6786    5                   END;

      617     6787    4               CALL WRITE_UWA;

   6787 86 001545   002456 701000 86                 TSX1    WRITE_UWA
        86 001546   000000 011000                    NOP     0

      618     6788    4               NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;

   6788 86 001547   000001 235000 44                 LDA     UWA_KEY+1
        86 001550   000000 755000 45                 STA     NEXT_UWA_SECOND_HALF

      619     6789    4               UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;

   6789 86 001551   000164 236000 4                  LDQ     SAVE_LAST_UWA
        86 001552   000001 756000 44                 STQ     UWA_KEY+1

      620     6790    4               CALL WRITE_RVA(3,FR.UOFST.EIS.FRID);

   6790 86 001553   000000 236000 69                 LDQ     FR$
        86 001554   000041 036000 87                 ADLQ    33
        86 001555   200020 756100                    STQ     @TYPE+1,,AUTO
        86 001556   000042 236000 87                 LDQ     34
        86 001557   200017 756100                    STQ     LEN_UBIN+2,,AUTO
        86 001560   002476 701000 86                 TSX1    WRITE_RVA
        86 001561   000000 011000                    NOP     0

      621     6791    4               END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:130  

      622     6792    3           END;

   6792 86 001562   000000 234000 15                 SZN     RECORD_FOUND
        86 001563   001226 604000 86                 TMI     s:6723

      623     6793    2   DONE_FR_PARA:
      624     6794    2       IF UWA.DB_STATUS ~= '0502100' AND RECORD_FOUND THEN CALL ABORT;

   6794 86 001564   040000 106400       DONE_FR_PARA CMPC    fill='040'O
        86 001565   000001 000007 54                 ADSC9   UWA+1                    cn=0,n=7
        86 001566   001140 000007 12                 ADSC9   ONE_CHANGE+10            cn=0,n=7
        86 001567   001575 600000 86                 TZE     s:6795
        86 001570   000000 234000 15                 SZN     RECORD_FOUND
        86 001571   001575 605000 86                 TPL     s:6795

   6794 86 001572   000005 631400 87                 EPPR1   5
        86 001573   000000 701000 xent               TSX1    ABORT
        86 001574   000000 011000                    NOP     0

      625     6795    2       IO_BUF = SAVE_BUF;

   6795 86 001575   040000 100400                    MLR     fill='040'O
        86 001576   000011 000200 4                  ADSC9   SAVE_BUF                 cn=0,n=128
        86 001577   000000 000200 62                 ADSC9   IO_BUF                   cn=0,n=128

      626     6796    2       VALIDS.FR_NAMES = SAVED_FR_NAMES;

   6796 86 001600   000166 236000 4                  LDQ     SAVED_FR_NAMES
        86 001601   000013 772000                    QRL     11
        86 001602   000000 676000 31                 ERQ     VALIDS
        86 001603   000100 376003                    ANQ     64,DU
        86 001604   000000 656000 31                 ERSQ    VALIDS

      627     6797    2       RETURN;

   6797 86 001605   200014 221300                    LDX1  ! FIRST_KEY+1,,AUTO
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:131  
        86 001606   000001 702211                    TSX2  ! 1,X1

      628     6798    2   DBCS_ERR:
      629     6799    2       CALL ABORT;

   6799 86 001607   000005 631400 87    DBCS_ERR     EPPR1   5
        86 001610   000000 701000 xent               TSX1    ABORT
        86 001611   000000 011000                    NOP     0

      630     6800    2   END ADD_SPECIAL_REC;

   6800 86 001612   200014 221300                    LDX1  ! FIRST_KEY+1,,AUTO
        86 001613   000001 702211                    TSX2  ! 1,X1

      631     6801        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:132  
      632     6802        /*
      633     6803         AAA  L     L      OOO   CCC   AAA  TTTTT EEEEE
      634     6804        A   A L     L     O O O C   C A   A   T   E
      635     6805        A   A L     L     O O O C     A   A   T   E
      636     6806        AAAAA L     L     O  OO C     AAAAA   T   EEEE
      637     6807        A   A L     L     O   O C     A   A   T   E
      638     6808        A   A L     L     O   O C   C A   A   T   E
      639     6809        A   A LLLLL LLLLL  OOO   CCC  A   A   T   EEEEE
      640     6810
      641     6811
      642     6812
      643     6813              PPPP   AAA  RRRR   AAA  M   M EEEEE TTTTT EEEEE RRRR
      644     6814              P   P A   A R   R A   A MM MM E       T   E     R   R
      645     6815              P   P A   A R   R A   A M M M E       T   E     R   R
      646     6816              PPPP  AAAAA RRRR  AAAAA M   M EEEE    T   EEEE  RRRR
      647     6817              P     A   A R R   A   A M   M E       T   E     R R
      648     6818              P     A   A R  R  A   A M   M E       T   E     R  R
      649     6819              P     A   A R   R A   A M   M EEEEE   T   EEEEE R   R
      650     6820        _____
      651     6821        */
      652     6822    1   ALLOCATE_PARAMETER:

   6822 86 001614   200016 741300       ALLOCATE_PA* STX1  ! LEN_UBIN+1,,AUTO

      653     6823    1       PROC;
      654     6824        /*W*
      655     6825              The next few subroutines where converted strait from PL1
      656     6826            so if you have any problems with DATA BASE PARAMETERS then
      657     6827            look at the PL1 code and may GOD help you. Because, when
      658     6828            I converted these subroutines I didn't understand how they
      659     6829            work so good luck. (you will need it).
      660     6830        */
      661     6831    2   DCL BYTE_ALIGNMENT UBIN (36);
      662     6832    2   DCL ASSIGNED_FSS_ALIGNMENT(0:27) STATIC UBIN (36) INIT(
      663     6833    2    1,4*13,8*3,4);
      664     6834    2   DCL I SBIN (36);
      665     6835        /*     allocate a data base parameter
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:133  
      666     6836                   the subschema characteristics have been
      667     6837                   decided on by the caller and the "TYPE_430"
      668     6838                   fields "DATA_TYPE", "LENGTH", and "SCALE"
      669     6839                   have been set.
      670     6840        */
      671     6841    2       CALL DEFAULT_DATA_TYPE;

   6841 86 001615   002126 701000 86                 TSX1    DEFAULT_DATA_TYPE
        86 001616   000000 011000                    NOP     0

      672     6842        /*
      673     6843              Assign a uwa offset
      674     6844        */
      675     6845    2       IF SUB_LANGUAGE=#COBOL

   6845 86 001617   000000 235000 57                 LDA     SUB_LANGUAGE
        86 001620   000001 115007                    CMPA    1,DL
        86 001621   001625 601000 86                 TNZ     s:6849

      676     6846        /* Cobol parameters are all double word aligned */
      677     6847    2       THEN BYTE_ALIGNMENT=8;

   6847 86 001622   000010 236007                    LDQ     8,DL
        86 001623   200017 756100                    STQ     BYTE_ALIGNMENT,,AUTO
        86 001624   001630 710000 86                 TRA     s:6850

      678     6848        /*Fortran parameters can be of different sizes  */
      679     6849    2       ELSE BYTE_ALIGNMENT=ASSIGNED_FSS_ALIGNMENT(TYPE_430.DATA_TYPE);

   6849 86 001625   000024 720000 62                 LXL0    IO_BUF+20
        86 001626   000175 235010 4                  LDA     ASSIGNED_FSS_ALIGNMENT,X0
        86 001627   200017 755100                    STA     BYTE_ALIGNMENT,,AUTO

      680     6850    2       I=MOD(OA.UWSZ,BYTE_ALIGNMENT);

   6850 86 001630   000000 470400 75                 LDP0    OA$
        86 001631   000020 236100                    LDQ     16,,PR0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:134  
        86 001632   000022 772000                    QRL     18
        86 001633   200017 235100                    LDA     BYTE_ALIGNMENT,,AUTO
        86 001634   001637 605000 86                 TPL     s:6850+7
        86 001635   000044 737000                    LLS     36
        86 001636   001640 710000 86                 TRA     s:6850+8
        86 001637   200017 506100                    DIV     BYTE_ALIGNMENT,,AUTO
        86 001640   200020 755100                    STA     I,,AUTO

      681     6851    2       IF SUB_LANGUAGE = #FORTRAN AND I ~= 0

   6851 86 001641   000000 236000 57                 LDQ     SUB_LANGUAGE
        86 001642   000002 116007                    CMPQ    2,DL
        86 001643   001751 601000 86                 TNZ     s:6870
        86 001644   000000 115003                    CMPA    0,DU
        86 001645   001751 600000 86                 TZE     s:6870

      682     6852    3       THEN DO;

      683     6853    3           CALL SET_FIELD_NUM(1,LAST_FILLER);

   6853 86 001646   000025 630400 87                 EPPR0   21
        86 001647   000013 631400 87                 EPPR1   11
        86 001650   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 001651   000000 011000                    NOP     0

      684     6854    3           CALL CONCAT(TEMP_WORD,'FILL',SUBSTR(FIELD1.TEXT1,0,4));

   6854 86 001652   001200 236000 12                 LDQ     ONE_CHANGE+42
        86 001653   000001 756000 4                  STQ     TEMP_WORD
        86 001654   040000 100400                    MLR     fill='040'O
        86 001655   000000 200004 18                 ADSC9   FIELD1                   cn=1,n=4
        86 001656   000002 000032 4                  ADSC9   TEMP_WORD+1              cn=0,n=26

      685     6855    3           LAST_FILLER = LAST_FILLER + 1;

   6855 86 001657   000070 235000 4                  LDA     LAST_FILLER
        86 001660   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:135  
        86 001661   000070 755000 4                  STA     LAST_FILLER

      686     6856    3           CALL CONCAT(LIST_STRING,'     +               ',

   6856 86 001662   040000 100400                    MLR     fill='040'O
        86 001663   001201 000025 12                 ADSC9   ONE_CHANGE+43            cn=0,n=21
        86 001664   000000 000025 16                 ADSC9   LIST_STRING              cn=0,n=21
        86 001665   040000 100400                    MLR     fill='040'O
        86 001666   000001 000010 4                  ADSC9   TEMP_WORD                cn=0,n=8
        86 001667   000005 200010 16                 ADSC9   LIST_STRING+5            cn=1,n=8
        86 001670   040000 100400                    MLR     fill='040'O
        86 001671   000027 000001 87                 ADSC9   23                       cn=0,n=1
        86 001672   000007 200143 16                 ADSC9   LIST_STRING+7            cn=1,n=99

      687     6857    3              SUBSTR(TEMP_WORD,0,8),',');
      688     6858    3           CALL WRITE_UWA;

   6858 86 001673   002456 701000 86                 TSX1    WRITE_UWA
        86 001674   000000 011000                    NOP     0

      689     6859    3           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;

   6859 86 001675   000001 235000 44                 LDA     UWA_KEY+1
        86 001676   000164 755000 4                  STA     SAVE_LAST_UWA

      690     6860    3           UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;

   6860 86 001677   000000 236000 45                 LDQ     NEXT_UWA_SECOND_HALF
        86 001700   000001 756000 44                 STQ     UWA_KEY+1

      691     6861    3           CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(0),

   6861 86 001701   040000 100400                    MLR     fill='040'O
        86 001702   001203 000007 12                 ADSC9   ONE_CHANGE+45            cn=0,n=7
        86 001703   000000 000007 16                 ADSC9   LIST_STRING              cn=0,n=7
        86 001704   040000 100400                    MLR     fill='040'O
        86 001705   000610 000024 12                 ADSC9   DATA_TYPE_NAME           cn=0,n=20
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:136  
        86 001706   000001 600024 16                 ADSC9   LIST_STRING+1            cn=3,n=20
        86 001707   040000 100400                    MLR     fill='040'O
        86 001710   000001 000010 4                  ADSC9   TEMP_WORD                cn=0,n=8
        86 001711   000006 600145 16                 ADSC9   LIST_STRING+6            cn=3,n=101

      692     6862    3              SUBSTR(TEMP_WORD,0,8));
      693     6863    3           CALL SET_FIELD_NUM(1,I);

   6863 86 001712   200020 630500                    EPPR0   I,,AUTO
        86 001713   200031 450500                    STP0    COUNT1+3,,AUTO
        86 001714   000010 236000 87                 LDQ     8
        86 001715   200030 756100                    STQ     COUNT1+2,,AUTO
        86 001716   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 001717   000013 631400 87                 EPPR1   11
        86 001720   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 001721   000000 011000                    NOP     0

      694     6864    3           CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,'*',

   6864 86 001722   000000 236000 18                 LDQ     FIELD1
        86 001723   000033 772000                    QRL     27
        86 001724   000000 620006                    EAX0    0,QL
        86 001725   000000 236000 18                 LDQ     FIELD1
        86 001726   000033 772000                    QRL     27
        86 001727   000001 621006                    EAX1    1,QL
        86 001730   040040 100400                    MLR     fill='040'O
        86 001731   000030 000001 87                 ADSC9   24                       cn=0,n=1
        86 001732   000004 000011 16                 ADSC9   LIST_STRING+4            cn=0,n=*X1
        86 001733   000000 636011                    EAQ     0,X1
        86 001734   000022 772000                    QRL     18
        86 001735   000002 116007                    CMPQ    2,DL
        86 001736   001743 602000 86                 TNC     s:6866
        86 001737   777777 622011                    EAX2    -1,X1
        86 001740   040040 100440                    MLR     fill='040'O
        86 001741   000000 200010 18                 ADSC9   FIELD1                   cn=1,n=*X0
        86 001742   000004 200012 16                 ADSC9   LIST_STRING+4            cn=1,n=*X2

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:137  
      695     6865    3              SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      696     6866    3           CALL WRITE_UWA;

   6866 86 001743   002456 701000 86                 TSX1    WRITE_UWA
        86 001744   000000 011000                    NOP     0

      697     6867    3           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;

   6867 86 001745   000001 235000 44                 LDA     UWA_KEY+1
        86 001746   000000 755000 45                 STA     NEXT_UWA_SECOND_HALF

      698     6868    3           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;

   6868 86 001747   000164 236000 4                  LDQ     SAVE_LAST_UWA
        86 001750   000001 756000 44                 STQ     UWA_KEY+1

      699     6869    3           END;

      700     6870    2       IF I~=0

   6870 86 001751   200020 235100                    LDA     I,,AUTO
        86 001752   001762 600000 86                 TZE     s:6872

      701     6871    2       THEN OA.UWSZ=OA.UWSZ+BYTE_ALIGNMENT-I;

   6871 86 001753   000000 470400 75                 LDP0    OA$
        86 001754   000020 236100                    LDQ     16,,PR0
        86 001755   000022 772000                    QRL     18
        86 001756   200017 036100                    ADLQ    BYTE_ALIGNMENT,,AUTO
        86 001757   200020 136100                    SBLQ    I,,AUTO
        86 001760   000000 620006                    EAX0    0,QL
        86 001761   000020 740100                    STX0    16,,PR0

      702     6872    2       I=UNITS_PER_WORD(TYPE_430.DATA_TYPE)/4;

   6872 86 001762   000024 720000 62                 LXL0    IO_BUF+20
        86 001763   000100 236010 12                 LDQ     UNITS_PER_WORD,X0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:138  
        86 001764   000002 772000                    QRL     2
        86 001765   200020 756100                    STQ     I,,AUTO

      703     6873    2       TYPE_430.OFFSET=OA.UWSZ*I;

   6873 86 001766   000000 470400 75                 LDP0    OA$
        86 001767   000020 236100                    LDQ     16,,PR0
        86 001770   000022 772000                    QRL     18
        86 001771   200020 402100                    MPY     I,,AUTO
        86 001772   000023 756000 62                 STQ     IO_BUF+19

      704     6874    2       OA.UWSZ=OA.UWSZ + ( TYPE_430.LEN_FIELD + I-1 )/I;

   6874 86 001773   000025 236000 62                 LDQ     IO_BUF+21
        86 001774   200020 036100                    ADLQ    I,,AUTO
        86 001775   000001 136007                    SBLQ    1,DL
        86 001776   200020 506100                    DIV     I,,AUTO
        86 001777   200030 756100                    STQ     COUNT1+2,,AUTO
        86 002000   000020 236100                    LDQ     16,,PR0
        86 002001   000022 772000                    QRL     18
        86 002002   200031 756100                    STQ     COUNT1+3,,AUTO
        86 002003   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 002004   200031 036100                    ADLQ    COUNT1+3,,AUTO
        86 002005   000000 621006                    EAX1    0,QL
        86 002006   000020 741100                    STX1    16,,PR0

      705     6875    2       CALL INIT_TYPE_9_DBPARAM;

   6875 86 002007   002254 701000 86                 TSX1    INIT_TYPE_9_DBPARAM
        86 002010   000000 011000                    NOP     0

      706     6876    2       TYPE_430.EIS.ADDER_C.REG = 1;

   6876 86 002011   000031 236000 62                 LDQ     IO_BUF+25
        86 002012   000043 376000 87                 ANQ     35
        86 002013   100000 276003                    ORQ     32768,DU
        86 002014   000031 756000 62                 STQ     IO_BUF+25
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:139  

      707     6877    2       TYPE_430.EIS.NDSC.CN = MOD(TYPE_430.OFFSET*FACTER(TYPE_430.DATA_TYPE),8);

   6877 86 002015   000024 720000 62                 LXL0    IO_BUF+20
        86 002016   000023 236000 62                 LDQ     IO_BUF+19
        86 002017   000352 402010 12                 MPY     FACTER,X0
        86 002020   000007 376007                    ANQ     7,DL
        86 002021   000017 736000                    QLS     15
        86 002022   000031 676000 62                 ERQ     IO_BUF+25
        86 002023   700000 376007                    ANQ     -32768,DL
        86 002024   000031 656000 62                 ERSQ    IO_BUF+25

      708     6878    2       TYPE_430.EIS.ADDER_C.OFFSET = TYPE_430.OFFSET*FACTER(TYPE_430.DATA_TYPE)/8;

   6878 86 002025   000023 236000 62                 LDQ     IO_BUF+19
        86 002026   000352 402010 12                 MPY     FACTER,X0
        86 002027   000003 772000                    QRL     3
        86 002030   000022 736000                    QLS     18
        86 002031   000031 676000 62                 ERQ     IO_BUF+25
        86 002032   077777 376003                    ANQ     32767,DU
        86 002033   000031 656000 62                 ERSQ    IO_BUF+25

      709     6879    2       TYPE_430.EIS.EIS_TN_S.TN_S = TN_S(TYPE_430.DATA_TYPE);

   6879 86 002034   000024 236000 62                 LDQ     IO_BUF+20
        86 002035   000003 402007                    MPY     3,DL
        86 002036   003000 060406                    CSL     bolr='003'O
        86 002037   000406 000003 12                 BDSC    TN_S,Q                   by=0,bit=0,n=3
        86 002040   000031 430003 62                 BDSC    IO_BUF+25                by=2,bit=3,n=3

      710     6880    2       IF TYPE_9.NUMERIC

   6880 86 002041   000021 236000 55                 LDQ     TYPE_9+17
        86 002042   000001 316003                    CANQ    1,DU
        86 002043   002066 600000 86                 TZE     s:6889

      711     6881    3       THEN DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:140  

      712     6882    3           SSCALE = TYPE_430.SCALE_FIELD;

   6882 86 002044   000026 235000 62                 LDA     IO_BUF+22
        86 002045   000036 735000                    ALS     30
        86 002046   000065 755000 4                  STA     SSCALE

      713     6883    3           IF SSCALE ~= 0

   6883 86 002047   000065 236000 4                  LDQ     SSCALE
        86 002050   770000 316003                    CANQ    -4096,DU
        86 002051   002060 600000 86                 TZE     s:6885

      714     6884    3           THEN SSCALE = 64 - SSCALE;

   6884 86 002052   000065 236000 4                  LDQ     SSCALE
        86 002053   000036 732000                    QRS     30
        86 002054   000044 676000 87                 ERQ     36
        86 002055   000101 036007                    ADLQ    65,DL
        86 002056   000036 736000                    QLS     30
        86 002057   000065 756000 4                  STQ     SSCALE

      715     6885    3           TYPE_430.EIS.NDSC.SF = SSCALE;

   6885 86 002060   000065 236000 4                  LDQ     SSCALE
        86 002061   000030 772000                    QRL     24
        86 002062   000031 752002 62                 STCQ    IO_BUF+25,'02'O

      716     6886    3           TYPE_430.EIS.NDSC.N = TYPE_430.LEN_FIELD;

   6886 86 002063   000025 236000 62                 LDQ     IO_BUF+21
        86 002064   000031 752001 62                 STCQ    IO_BUF+25,'01'O

      717     6887    3           END;

   6887 86 002065   002070 710000 86                 TRA     s:6891

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:141  
      718     6888    3       ELSE DO;

      719     6889    3           TYPE_430.EIS.ADSC.N = TYPE_430.LEN_FIELD;

   6889 86 002066   000025 236000 62                 LDQ     IO_BUF+21
        86 002067   000031 752003 62                 STCQ    IO_BUF+25,'03'O

      720     6890    3           END;

      721     6891    2   END ALLOCATE_PARAMETER;

   6891 86 002070   200016 221300                    LDX1  ! LEN_UBIN+1,,AUTO
        86 002071   000001 702211                    TSX2  ! 1,X1

      722     6892        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:142  
      723     6893        /*
      724     6894        TTTTT Y   Y PPPP  EEEEE       4   4 33333  000         SSS   III  ZZZZZ EEEEE
      725     6895          T   Y   Y P   P E           4   4     3 0   0       S   S   I       Z E
      726     6896          T    Y Y  P   P E           4   4    3  0   0       S       I      Z  E
      727     6897          T     Y   PPPP  EEEE        44444   33  0   0        SSS    I     Z   EEEE
      728     6898          T     Y   P     E               4     3 0   0           S   I    Z    E
      729     6899          T     Y   P     E               4 3   3 0   0       S   S   I   Z     E
      730     6900          T     Y   P     EEEEE           4   33   000         SSS   III  ZZZZZ EEEEE
      731     6901                                _____                   _____
      732     6902
      733     6903
      734     6904              FFFFF RRRR   OOO  M   M       EEEEE  III   SSS
      735     6905              F     R   R O O O MM MM       E       I   S   S
      736     6906              F     R   R O O O M M M       E       I   S
      737     6907              FFFF  RRRR  O  OO M   M       EEEE    I    SSS
      738     6908              F     R R   O   O M   M       E       I       S
      739     6909              F     R  R  O   O M   M       E       I   S   S
      740     6910              F     R   R  OOO  M   M       EEEEE  III   SSS
      741     6911        _____                         _____
      742     6912        */
      743     6913    1   TYPE_430_SIZE_FROM_EIS:

   6913 86 002072   200024 741300       TYPE_430_SI* STX1  ! @LEN+1,,AUTO

      744     6914    1       PROC;
      745     6915    2   DCL 1 NEIS BASED ALIGNED,
      746     6916    2         2 * BIT (24) UNAL,
      747     6917    2         2 SCALE UBIN (6) UNAL,
      748     6918    2         2 LENGTH UBIN (6) UNAL;
      749     6919    2   DCL 1 AEIS BASED ALIGNED,
      750     6920    2         2 * BIT (24) UNAL,
      751     6921    2         2 LENGTH UBIN (12) UNAL;
      752     6922         /*
      753     6923            this procedure expects "DATA_TYPE" to contain the
      754     6924            global data type code (from 0 to 27).
      755     6925         */
      756     6926    2       IF NUMERIC(TYPE_430.DATA_TYPE)
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:143  

   6926 86 002073   000024 235000 62                 LDA     IO_BUF+20
        86 002074   000000 066405                    CMPB    filb='0'B
        86 002075   000134 000001 12                 BDSC    NUMERIC,A                by=0,bit=0,n=1
        86 002076   000005 000022 87                 BDSC    5                        by=0,bit=0,n=18
        86 002077   002121 600000 86                 TZE     s:6937

      757     6927    3       THEN DO;

      758     6928    3           TYPE_430.LEN_FIELD= ADDR(UWA.FR.BUFFLOC) -> NEIS.LENGTH;

   6928 86 002100   000351 236000 54                 LDQ     UWA+233
        86 002101   000077 376007                    ANQ     63,DL
        86 002102   000025 756000 62                 STQ     IO_BUF+21

      759     6929    3           TYPE_430.SCALE_FIELD = ADDR(UWA.FR.BUFFLOC) -> NEIS.SCALE;

   6929 86 002103   000351 236000 54                 LDQ     UWA+233
        86 002104   000006 772000                    QRL     6
        86 002105   000077 376007                    ANQ     63,DL
        86 002106   000026 756000 62                 STQ     IO_BUF+22

      760     6930    3           IF TYPE_430.SCALE_FIELD<32 THEN

   6930 86 002107   000040 116007                    CMPQ    32,DL
        86 002110   002115 603000 86                 TRC     s:6933

      761     6931    3               TYPE_430.SCALE_FIELD=-TYPE_430.SCALE_FIELD;

   6931 86 002111   000000 235003                    LDA     0,DU
        86 002112   000026 135000 62                 SBLA    IO_BUF+22
        86 002113   000026 755000 62                 STA     IO_BUF+22
        86 002114   002125 710000 86                 TRA     s:6940

      762     6932    3           ELSE
      763     6933    3               TYPE_430.SCALE_FIELD=64-TYPE_430.SCALE_FIELD;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:144  
   6933 86 002115   000100 235007                    LDA     64,DL
        86 002116   000026 135000 62                 SBLA    IO_BUF+22
        86 002117   000026 755000 62                 STA     IO_BUF+22

      764     6934    3           END; /* Numeric eis descriptor */

   6934 86 002120   002125 710000 86                 TRA     s:6940

      765     6935    3       ELSE DO;

      766     6936         /* Alphanumeric eis descriptor */
      767     6937    3           TYPE_430.LEN_FIELD = ADDR(UWA.FR.BUFFLOC) -> AEIS.LENGTH;

   6937 86 002121   000351 236000 54                 LDQ     UWA+233
        86 002122   007777 376007                    ANQ     4095,DL
        86 002123   000025 756000 62                 STQ     IO_BUF+21

      768     6938    3           TYPE_430.SCALE_FIELD=0;

   6938 86 002124   000026 450000 62                 STZ     IO_BUF+22

      769     6939    3           END; /* Not numeric */

      770     6940    2   END TYPE_430_SIZE_FROM_EIS;

   6940 86 002125   000001 702211                    TSX2  ! 1,X1

      771     6941        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:145  
      772     6942        /*
      773     6943        DDDD  EEEEE FFFFF  AAA  U   U L     TTTTT
      774     6944        D   D E     F     A   A U   U L       T
      775     6945        D   D E     F     A   A U   U L       T
      776     6946        D   D EEEE  FFFF  AAAAA U   U L       T
      777     6947        D   D E     F     A   A U   U L       T
      778     6948        D   D E     F     A   A U   U L       T
      779     6949        DDDD  EEEEE F     A   A  UUU  LLLLL   T
      780     6950                                                  _____
      781     6951
      782     6952
      783     6953        DDDD   AAA  TTTTT  AAA        TTTTT Y   Y PPPP  EEEEE
      784     6954        D   D A   A   T   A   A         T   Y   Y P   P E
      785     6955        D   D A   A   T   A   A         T    Y Y  P   P E
      786     6956        D   D AAAAA   T   AAAAA         T     Y   PPPP  EEEE
      787     6957        D   D A   A   T   A   A         T     Y   P     E
      788     6958        D   D A   A   T   A   A         T     Y   P     E
      789     6959        DDDD  A   A   T   A   A         T     Y   P     EEEEE
      790     6960                                _____
      791     6961        */
      792     6962    1   DEFAULT_DATA_TYPE:

   6962 86 002126   200022 741300       DEFAULT_DAT* STX1  ! @ID+2,,AUTO

      793     6963    1       PROC;
      794     6964    2   DCL I SBIN (36);
      795     6965    2   DCL ASSIGNED_SS_TYPE(0:18) CONSTANT UBIN (36) INIT(
      796     6966    2    1,2,2,3,4,0,0,4,0,0,
      797     6967    2    0,4,4,0,0,6,8,4,4);
      798     6968    2   DCL ASSIGNED_SS_LENGTH(0:18) CONSTANT UBIN (36) INIT(
      799     6969    2    4,4,4,0,0,0,09,256,0,
      800     6970    2    256,8,20,256,0,0,0,0,0,0);
      801     6971    2   DCL ASSIGNED_SS_SCALE(0:18) CONSTANT UBIN (36) INIT(
      802     6972    2    0,0,0,0,0,0,0,0,0,0,
      803     6973    2    0,8,20,0,0,0,0,0,0);
      804     6974    2   DCL ASSIGNED_FSS_TYPE(0:18) CONSTANT UBIN (36) INIT(
      805     6975    2    2,2,2,13,13,0,0,2,0,0,
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:146  
      806     6976    2    0,13,14,0,0,2,2,13,14);
      807     6977    2   DCL ASSIGNED_FSS_LENGTH(0:18) CONSTANT UBIN (36) INIT(
      808     6978    2    4,4,4,4,4,0,0,4,0,0,
      809     6979    2    0,4,8,0,0,4,4,4,8);
      810     6980        /*
      811     6981           give an fr a subschema data type based
      812     6982           solely on the schema data characteristics.
      813     6983           this routine returns the characteristics
      814     6984           in the "TYPE_430" fields "DATA_TYPE", "LENGTH",
      815     6985           and "SCALE".  On exit, "DP" points to
      816     6986           the fr passed as the parameter.
      817     6987        */
      818     6988    2       I = UWA.FR.FTYPE;

   6988 86 002127   000334 235000 54                 LDA     UWA+220
        86 002130   200023 755100                    STA     I,,AUTO

      819     6989    2       IF SUB_LANGUAGE=#COBOL

   6989 86 002131   000000 236000 57                 LDQ     SUB_LANGUAGE
        86 002132   000001 116007                    CMPQ    1,DL
        86 002133   002137 601000 86                 TNZ     s:6991

      820     6990    2       THEN TYPE_430.DATA_TYPE=ASSIGNED_SS_TYPE(I);

   6990 86 002134   000751 235005 12                 LDA     ASSIGNED_SS_TYPE,AL
        86 002135   000024 755000 62                 STA     IO_BUF+20
        86 002136   002141 710000 86                 TRA     s:6992

      821     6991    2       ELSE TYPE_430.DATA_TYPE=ASSIGNED_FSS_TYPE(I);

   6991 86 002137   001042 235005 12                 LDA     ASSIGNED_FSS_TYPE,AL
        86 002140   000024 755000 62                 STA     IO_BUF+20

      822     6992    2       IF SUB_LANGUAGE=#COBOL

   6992 86 002141   000001 116007                    CMPQ    1,DL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:147  
        86 002142   002146 601000 86                 TNZ     s:6995

      823     6993    2       THEN TYPE_430.DATA_TYPE=SYNONYM_CTYPE(TYPE_430.DATA_TYPE);

   6993 86 002143   000135 235005 12                 LDA     SYNONYM_CTYPE,AL
        86 002144   000024 755000 62                 STA     IO_BUF+20
        86 002145   002232 710000 86                 TRA     s:7021

      824     6994    3       ELSE DO;

      825     6995    3           TYPE_430.DATA_TYPE=SYNONYM_FTYPE(TYPE_430.DATA_TYPE);

   6995 86 002146   000171 235005 12                 LDA     SYNONYM_FTYPE,AL
        86 002147   000024 755000 62                 STA     IO_BUF+20

      826     6996    3           IF TYPE_430.DATA_TYPE = 17 /* LOGICAL */

   6996 86 002150   000021 115007                    CMPA    17,DL
        86 002151   002232 601000 86                 TNZ     s:7021

      827     6997    4           THEN DO;

      828     6998    4               IF SUB_LANGUAGE = #APL THEN

   6998 86 002152   000003 116007                    CMPQ    3,DL
        86 002153   002160 601000 86                 TNZ     s:7001

      829     6999    4                   TYPE_430.DATA_TYPE=SYNONYM_APL_TYPE(UWA.FR.FTYPE);

   6999 86 002154   000334 720000 54                 LXL0    UWA+220
        86 002155   000225 235010 12                 LDA     SYNONYM_APL_TYPE,X0
        86 002156   000024 755000 62                 STA     IO_BUF+20
        86 002157   002232 710000 86                 TRA     s:7021

      830     7000    5               ELSE DO;

      831     7001    5                   IF SUB_LANGUAGE = #BASIC THEN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:148  

   7001 86 002160   000004 116007                    CMPQ    4,DL
        86 002161   002166 601000 86                 TNZ     s:7004

      832     7002    5                       TYPE_430.DATA_TYPE=SYNONYM_BASIC_TYPE(UWA.FR.FTYPE);

   7002 86 002162   000334 720000 54                 LXL0    UWA+220
        86 002163   000250 235010 12                 LDA     SYNONYM_BASIC_TYPE,X0
        86 002164   000024 755000 62                 STA     IO_BUF+20
        86 002165   002232 710000 86                 TRA     s:7021

      833     7003    5                   ELSE
      834     7004    5                       IF SUB_LANGUAGE = #FORTRAN

   7004 86 002166   000002 116007                    CMPQ    2,DL
        86 002167   002232 601000 86                 TNZ     s:7021

      835     7005    6                       THEN DO;

      836     7006    7                           DO CASE (UWA.FR.FTYPE);

   7006 86 002170   000334 235000 54                 LDA     UWA+220
        86 002171   000022 115007                    CMPA    18,DL
        86 002172   002174 602005 86                 TNC     s:7006+4,AL
        86 002173   002230 710000 86                 TRA     s:7013
        86 002174   002230 710000 86                 TRA     s:7013
        86 002175   002230 710000 86                 TRA     s:7013
        86 002176   002230 710000 86                 TRA     s:7013
        86 002177   002216 710000 86                 TRA     s:7008
        86 002200   002216 710000 86                 TRA     s:7008
        86 002201   002230 710000 86                 TRA     s:7013
        86 002202   002230 710000 86                 TRA     s:7013
        86 002203   002230 710000 86                 TRA     s:7013
        86 002204   002230 710000 86                 TRA     s:7013
        86 002205   002230 710000 86                 TRA     s:7013
        86 002206   002230 710000 86                 TRA     s:7013
        86 002207   002230 710000 86                 TRA     s:7013
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:149  
        86 002210   002230 710000 86                 TRA     s:7013
        86 002211   002230 710000 86                 TRA     s:7013
        86 002212   002230 710000 86                 TRA     s:7013
        86 002213   002230 710000 86                 TRA     s:7013
        86 002214   002230 710000 86                 TRA     s:7013
        86 002215   002216 710000 86                 TRA     s:7008

      837     7007    7                           CASE (3, 4, 17);

      838     7008    7                               IF SSGEN.MAP = '0'B THEN

   7008 86 002216   000022 236000 36                 LDQ     SSGEN+18
        86 002217   000400 316007                    CANQ    256,DL
        86 002220   002223 601000 86                 TNZ     s:7010

      839     7009    7                                   TYPE_430.DATA_TYPE = 13; /* REAL */

   7009 86 002221   000015 235007                    LDA     13,DL
        86 002222   000024 755000 62                 STA     IO_BUF+20

      840     7010    7                               IF SSGEN.MAP = '1'B THEN

   7010 86 002223   000400 316007                    CANQ    256,DL
        86 002224   002232 600000 86                 TZE     s:7021

      841     7011    7                                   TYPE_430.DATA_TYPE = 14; /* DOUBLE PRECISION */

   7011 86 002225   000016 235007                    LDA     14,DL
        86 002226   000024 755000 62                 STA     IO_BUF+20
        86 002227   002232 710000 86                 TRA     s:7021

      842     7012    7                           CASE (ELSE);

      843     7013    7                               TYPE_430.DATA_TYPE=SYNONYM_FORTRAN_TYPE(UWA.FR.FTYPE);

   7013 86 002230   000273 235005 12                 LDA     SYNONYM_FORTRAN_TYPE,AL
        86 002231   000024 755000 62                 STA     IO_BUF+20
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:150  

      844     7014    7                               END; /* CASE */

      845     7015    6                           END;

      846     7016    5                   END;

      847     7017    4               END;

      848     7018    3           END;

      849     7019        /* A bad ftype will be picked up later
      850     7020           by the conversion routine */
      851     7021    2       IF ASSIGNED_SS_LENGTH(I)=0

   7021 86 002232   200023 720100                    LXL0    I,,AUTO
        86 002233   000774 235010 12                 LDA     ASSIGNED_SS_LENGTH,X0
        86 002234   002240 601000 86                 TNZ     s:7024

      852     7022    2       THEN CALL TYPE_430_SIZE_FROM_EIS;

   7022 86 002235   002072 701000 86                 TSX1    TYPE_430_SIZE_FROM_EIS
        86 002236   000000 011000                    NOP     0
        86 002237   002252 710000 86                 TRA     s:7034

      853     7023    3       ELSE DO;

      854     7024    3           IF SUB_LANGUAGE=#COBOL

   7024 86 002240   000000 236000 57                 LDQ     SUB_LANGUAGE
        86 002241   000001 116007                    CMPQ    1,DL
        86 002242   002247 601000 86                 TNZ     s:7030

      855     7025    4           THEN DO;

      856     7026    4               TYPE_430.LEN_FIELD=ASSIGNED_SS_LENGTH(I);

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:151  
   7026 86 002243   000025 755000 62                 STA     IO_BUF+21

      857     7027    4               TYPE_430.SCALE_FIELD=ASSIGNED_SS_SCALE(I);

   7027 86 002244   001017 235010 12                 LDA     ASSIGNED_SS_SCALE,X0
        86 002245   000026 755000 62                 STA     IO_BUF+22

      858     7028    4               END;

   7028 86 002246   002252 710000 86                 TRA     s:7034

      859     7029    4           ELSE DO;

      860     7030    4               TYPE_430.LEN_FIELD=ASSIGNED_FSS_LENGTH(I);

   7030 86 002247   001065 235010 12                 LDA     ASSIGNED_FSS_LENGTH,X0
        86 002250   000025 755000 62                 STA     IO_BUF+21

      861     7031    4               TYPE_430.SCALE_FIELD=0;

   7031 86 002251   000026 450000 62                 STZ     IO_BUF+22

      862     7032    4               END;

      863     7033    3           END;

      864     7034    2   END DEFAULT_DATA_TYPE;

   7034 86 002252   200022 221300                    LDX1  ! @ID+2,,AUTO
        86 002253   000001 702211                    TSX2  ! 1,X1

      865     7035        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:152  
      866     7036        /*
      867     7037         III  N   N  III  TTTTT       TTTTT Y   Y PPPP  EEEEE        999
      868     7038          I   N   N   I     T           T   Y   Y P   P E           9   9
      869     7039          I   NN  N   I     T           T    Y Y  P   P E           9   9
      870     7040          I   N N N   I     T           T     Y   PPPP  EEEE         9999
      871     7041          I   N  NN   I     T           T     Y   P     E               9
      872     7042          I   N   N   I     T           T     Y   P     E           9   9
      873     7043         III  N   N  III    T           T     Y   P     EEEEE        999
      874     7044                                _____                         _____
      875     7045
      876     7046
      877     7047              DDDD  BBBB  PPPP   AAA  RRRR   AAA  M   M
      878     7048              D   D B   B P   P A   A R   R A   A MM MM
      879     7049              D   D B   B P   P A   A R   R A   A M M M
      880     7050              D   D BBBB  PPPP  AAAAA RRRR  AAAAA M   M
      881     7051              D   D B   B P     A   A R R   A   A M   M
      882     7052              D   D B   B P     A   A R  R  A   A M   M
      883     7053              DDDD  BBBB  P     A   A R   R A   A M   M
      884     7054        _____
      885     7055        */
      886     7056    1   INIT_TYPE_9_DBPARAM:

   7056 86 002254   200022 741300       INIT_TYPE_9* STX1  ! @ID+2,,AUTO

      887     7057    1       PROC;
      888     7058    2   DCL S SBIN (36) ALIGNED STATIC;
      889     7059    2   DCL RLTDP(0:13) CONSTANT UBIN (9) INIT (
      890     7060    2    0,11,11,0,0,0,0,0,0,0,0,5,10,0);
      891     7061    2       TYPE_9.TYPE = 9;

   7061 86 002255   000011 235007                    LDA     9,DL
        86 002256   000003 755000 55                 STA     TYPE_9+3

      892     7062    2       TYPE_9.FLD_NM = '1'B;

   7062 86 002257   020000 236007                    LDQ     8192,DL
        86 002260   000010 256000 55                 ORSQ    TYPE_9+8
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:153  

      893     7063    2       TYPE_9.BUWA = '1'B;

   7063 86 002261   004000 236007                    LDQ     2048,DL
        86 002262   000010 256000 55                 ORSQ    TYPE_9+8

      894     7064    2       IF TYPE_430.DATA_TYPE = 1

   7064 86 002263   000024 235000 62                 LDA     IO_BUF+20
        86 002264   000001 115007                    CMPA    1,DL
        86 002265   002273 601000 86                 TNZ     s:7070

      895     7065    3       THEN DO;

      896     7066    3           TYPE_9.SRF_DBK = '1'B;

   7066 86 002266   400000 236007                    LDQ     -131072,DL
        86 002267   000010 256000 55                 ORSQ    TYPE_9+8

      897     7067    3           TYPE_9.F_DBK = '1'B;

   7067 86 002270   000400 236007                    LDQ     256,DL
        86 002271   000010 256000 55                 ORSQ    TYPE_9+8

      898     7068    3           END;

   7068 86 002272   002277 710000 86                 TRA     s:7073

      899     7069    3       ELSE DO;

      900     7070    3           TYPE_9.SRF_DBK = '0'B;

   7070 86 002273   000045 236000 87                 LDQ     37
        86 002274   000010 356000 55                 ANSQ    TYPE_9+8

      901     7071    3           TYPE_9.F_DBK = '0'B;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:154  
   7071 86 002275   000046 236000 87                 LDQ     38
        86 002276   000010 356000 55                 ANSQ    TYPE_9+8

      902     7072    3           END;

      903     7073    2       TYPE_9.LEVEL = 77;

   7073 86 002277   000115 236007                    LDQ     77,DL
        86 002300   000012 756000 55                 STQ     TYPE_9+10

      904     7074    2       TYPE_9.LENGTH = TYPE_430.LEN_FIELD;

   7074 86 002301   000025 235000 62                 LDA     IO_BUF+21
        86 002302   000016 755000 55                 STA     TYPE_9+14

      905     7075    2       TYPE_9.LTDP=RLTDP(TYPE_430.DATA_TYPE);

   7075 86 002303   000024 720000 62                 LXL0    IO_BUF+20
        86 002304   001110 236010 12                 LDQ     RLTDP,X0
        86 002305   000033 772000                    QRL     27
        86 002306   000017 756000 55                 STQ     TYPE_9+15

      906     7076    2       IF TYPE_9.LTDP=0 THEN

   7076 86 002307   002313 601000 86                 TNZ     s:7078

      907     7077    2           TYPE_9.LTDP=TYPE_430.LEN_FIELD - TYPE_430.SCALE_FIELD;

   7077 86 002310   000025 236000 62                 LDQ     IO_BUF+21
        86 002311   000026 136000 62                 SBLQ    IO_BUF+22
        86 002312   000017 756000 55                 STQ     TYPE_9+15

      908     7078    2       TYPE_9.RTDP = TYPE_430.SCALE_FIELD;

   7078 86 002313   000026 235000 62                 LDA     IO_BUF+22
        86 002314   000020 755000 55                 STA     TYPE_9+16

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:155  
      909     7079    2       TYPE_9.OFFSET = TYPE_430.OFFSET;

   7079 86 002315   000023 235000 62                 LDA     IO_BUF+19
        86 002316   000024 755000 55                 STA     TYPE_9+20

      910     7080    2       CALL INDEX1(S,' ',TYPE_430.FIELD_NAME);

   7080 86 002317   000000 124400                    SCM     mask='000'O
        86 002320   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30
        86 002321   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 002322   000231 000000 4                  ARG     S

      911     7081    2       TEMP_WORD = TYPE_430.FIELD_NAME;

   7081 86 002323   040000 100400                    MLR     fill='040'O
        86 002324   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30
        86 002325   000001 000036 4                  ADSC9   TEMP_WORD                cn=0,n=30

      912     7082    2       CALL CHANGE_TO_STR(TEMP_WORD);

   7082 86 002326   000047 236000 87                 LDQ     39
        86 002327   200025 756100                    STQ     @ALI+1,,AUTO
        86 002330   002414 701000 86                 TSX1    CHANGE_TO_STR
        86 002331   000000 011000                    NOP     0

      913     7083    2       TYPE_9.NAME = TEMP_WORD;

   7083 86 002332   040000 100400                    MLR     fill='040'O
        86 002333   000001 000036 4                  ADSC9   TEMP_WORD                cn=0,n=30
        86 002334   000030 000036 55                 ADSC9   TYPE_9+24                cn=0,n=30

      914     7084    2       TYPE_9.NAME_SIZE = S;

   7084 86 002335   000231 235000 4                  LDA     S
        86 002336   000027 755000 55                 STA     TYPE_9+23

      915     7085    2       S=S+99;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:156  

   7085 86 002337   000143 236007                    LDQ     99,DL
        86 002340   000231 056000 4                  ASQ     S

      916     7086    2       IF MOD(S,4)~=0 THEN

   7086 86 002341   000231 236000 4                  LDQ     S
        86 002342   000004 506007                    DIV     4,DL
        86 002343   000044 733000                    LRS     36
        86 002344   000000 116003                    CMPQ    0,DU
        86 002345   002355 600000 86                 TZE     s:7088

      917     7087    2           S=S+4-MOD(S,4);

   7087 86 002346   000231 236000 4                  LDQ     S
        86 002347   000004 506007                    DIV     4,DL
        86 002350   200030 755100                    STA     COUNT1+2,,AUTO
        86 002351   000231 236000 4                  LDQ     S
        86 002352   200030 136100                    SBLQ    COUNT1+2,,AUTO
        86 002353   000004 036007                    ADLQ    4,DL
        86 002354   000231 756000 4                  STQ     S

      918     7088    2       TYPE_9.SIZE=S;

   7088 86 002355   000231 235000 4                  LDA     S
        86 002356   000000 755000 55                 STA     TYPE_9

      919     7089    2       IF FR.DEF.COMC>0 AND TYPE_430.SCALE_FIELD = 0

   7089 86 002357   000000 470400 69                 LDP0    FR$
        86 002360   000000 236100                    LDQ     0,,PR0
        86 002361   160000 316007                    CANQ    57344,DL
        86 002362   002370 600000 86                 TZE     s:7091
        86 002363   000026 235000 62                 LDA     IO_BUF+22
        86 002364   002370 601000 86                 TNZ     s:7091

      920     7090    2       THEN TYPE_9.NUMERIC = '1'B;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:157  

   7090 86 002365   000001 236003                    LDQ     1,DU
        86 002366   000021 256000 55                 ORSQ    TYPE_9+17
        86 002367   002372 710000 86                 TRA     s:7092

      921     7091    2       ELSE TYPE_9.NUMERIC = '0'B;

   7091 86 002370   000050 236000 87                 LDQ     40
        86 002371   000021 356000 55                 ANSQ    TYPE_9+17

      922     7092    2       TPTR$ = PINCRW(ADDR(TYPE_9.RTDP),1);

   7092 86 002372   000051 236000 87                 LDQ     41
        86 002373   000060 756000 4                  STQ     TPTR$

      923     7093    2       TPTR$ -> BITS_52 = PV(TYPE_430.DATA_TYPE);

   7093 86 002374   000024 236000 62                 LDQ     IO_BUF+20
        86 002375   000110 402007                    MPY     72,DL
        86 002376   000060 471400 4                  LDP1    TPTR$
        86 002377   003100 060406                    CSL     bolr='003'O
        86 002400   000316 000064 12                 BDSC    PV,Q                     by=0,bit=0,n=52
        86 002401   100000 000064                    BDSC    0,,PR1                   by=0,bit=0,n=52

      924     7094    2       IF TYPE_9.F_DBK OR TYPE_9.DB_KEY

   7094 86 002402   000010 236000 55                 LDQ     TYPE_9+8
        86 002403   000400 316007                    CANQ    256,DL
        86 002404   002410 601000 86                 TNZ     s:7095
        86 002405   000021 236000 55                 LDQ     TYPE_9+17
        86 002406   000004 316007                    CANQ    4,DL
        86 002407   002412 600000 86                 TZE     s:7096

      925     7095    2       THEN TYPE_9.INTEGER_TYPE = '1'B;

   7095 86 002410   000002 236003                    LDQ     2,DU
        86 002411   000022 256000 55                 ORSQ    TYPE_9+18
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:158  

      926     7096    2       RETURN;

   7096 86 002412   200022 221300                    LDX1  ! @ID+2,,AUTO
        86 002413   000001 702211                    TSX2  ! 1,X1

      927     7097    2   END INIT_TYPE_9_DBPARAM;
      928     7098        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:159  
      929     7099        /*
      930     7100            THIS SUBROUTINE CHANGES SCHEMA WORDS INTO COBOL WORDS '_' TO '-'.
      931     7101        */
      932     7102    1   CHANGE_TO_STR:

   7102 86 002414   200024 741300       CHANGE_TO_S* STX1  ! @LEN+1,,AUTO

      933     7103    1       PROC (CHANGE_STR);
      934     7104    2   DCL CHANGE_STR CHAR (30);
      935     7105    2   DCL COUNT1 UBIN (36);
      936     7106    2   DCL ONE_CHANGE (0:4) CHAR (2) CONSTANT INIT ('  ',
      937     7107    2    '_-' /* COBOL */, '_$' /* FORTRAN */, '__' /* APL */, '__' /* BASIC */);
      938     7108    2       IF (SUB_LANGUAGE = #APL) OR (SUB_LANGUAGE = #BASIC) THEN RETURN;

   7108 86 002415   000000 235000 57                 LDA     SUB_LANGUAGE
        86 002416   000003 115007                    CMPA    3,DL
        86 002417   002422 600000 86                 TZE     s:7108+5
        86 002420   000004 115007                    CMPA    4,DL
        86 002421   002423 601000 86                 TNZ     s:7109

   7108 86 002422   000001 702211                    TSX2  ! 1,X1

      939     7109    2       CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);

   7109 86 002423   000001 735000                    ALS     1
        86 002424   200025 470500                    LDP0    @CHANGE_STR,,AUTO
        86 002425   000005 124500                    SCM     mask='000'O
        86 002426   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        86 002427   001126 000001 12                 ADSC9   ONE_CHANGE,A             cn=0,n=1
        86 002430   200026 000100                    ARG     COUNT1,,AUTO

      940     7110    3       DO WHILE (COUNT1~= 30);

   7110 86 002431   200026 236100                    LDQ     COUNT1,,AUTO
        86 002432   000036 116007                    CMPQ    30,DL
        86 002433   002454 600000 86                 TZE     s:7114

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:160  
      941     7111    3           CALL INSERT(CHANGE_STR,COUNT1,1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),1,1));

   7111 86 002434   000000 235000 57                 LDA     SUB_LANGUAGE
        86 002435   000001 735000                    ALS     1
        86 002436   200025 470500                    LDP0    @CHANGE_STR,,AUTO
        86 002437   200026 236100                    LDQ     COUNT1,,AUTO
        86 002440   040106 100405                    MLR     fill='040'O
        86 002441   001126 200001 12                 ADSC9   ONE_CHANGE,A             cn=1,n=1
        86 002442   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

      942     7112    3           CALL INDEX1(COUNT1,SUBSTR(ONE_CHANGE(SUB_LANGUAGE),0,1),CHANGE_STR);

   7112 86 002443   000000 235000 57                 LDA     SUB_LANGUAGE
        86 002444   000001 735000                    ALS     1
        86 002445   000005 124500                    SCM     mask='000'O
        86 002446   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        86 002447   001126 000001 12                 ADSC9   ONE_CHANGE,A             cn=0,n=1
        86 002450   200026 000100                    ARG     COUNT1,,AUTO

      943     7113    3           END;

   7113 86 002451   200026 236100                    LDQ     COUNT1,,AUTO
        86 002452   000036 116007                    CMPQ    30,DL
        86 002453   002434 601000 86                 TNZ     s:7111

      944     7114    2       RETURN;

   7114 86 002454   200024 221300                    LDX1  ! @LEN+1,,AUTO
        86 002455   000001 702211                    TSX2  ! 1,X1

      945     7115    2   END CHANGE_TO_STR;
      946     7116        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:161  
      947     7117    1   WRITE_UWA:

   7117 86 002456   200022 741300       WRITE_UWA    STX1  ! @ID+2,,AUTO

      948     7118    1       PROC;
      949     7119    2       UWA_KEY.NUMBER_OF = UWA_KEY.NUMBER_OF + 1;

   7119 86 002457   000001 235000 44                 LDA     UWA_KEY+1
        86 002460   000001 035007                    ADLA    1,DL
        86 002461   000001 755000 44                 STA     UWA_KEY+1

      950     7120    2       SPECIAL_KEY = UWA_KEY;

   7120 86 002462   000000 237000 44                 LDAQ    UWA_KEY
        86 002463   000000 757000 40                 STAQ    SUBSCHEMA_KEY

      951     7121    2       CALL ZIG$SS_WVAR;

   7121 86 002464   000005 631400 87                 EPPR1   5
        86 002465   000000 701000 xent               TSX1    ZIG$SS_WVAR
        86 002466   000000 011000                    NOP     0

      952     7122    2       IF ERROR_IO ~= 0

   7122 86 002467   000000 235000 42                 LDA     ERROR_IO
        86 002470   002474 600000 86                 TZE     s:7124

      953     7123    2       THEN CALL ABORT;

   7123 86 002471   000005 631400 87                 EPPR1   5
        86 002472   000000 701000 xent               TSX1    ABORT
        86 002473   000000 011000                    NOP     0

      954     7124    2       RETURN;

   7124 86 002474   200022 221300                    LDX1  ! @ID+2,,AUTO
        86 002475   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:162  

      955     7125    2   END WRITE_UWA;
      956     7126        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:163  
      957     7127    1   WRITE_RVA:

   7127 86 002476   200016 741300       WRITE_RVA    STX1  ! LEN_UBIN+1,,AUTO

      958     7128    1       PROC(TYPE,ID);
      959     7129    2   DCL TYPE UBIN (36);
      960     7130    2   DCL ID UBIN (18) UNAL;
      961     7131    2       CALL GET_OCTAL_NUM(18,TYPE);

   7131 86 002477   200017 236100                    LDQ     @TYPE,,AUTO
        86 002500   200024 756100                    STQ     @LEN+1,,AUTO
        86 002501   000053 236000 87                 LDQ     43
        86 002502   200023 756100                    STQ     I,,AUTO
        86 002503   002554 701000 86                 TSX1    GET_OCTAL_NUM
        86 002504   000000 011000                    NOP     0

      962     7132    2       CALL CONCAT(LIST_STRING,'     +           12O',SUBSTR(

   7132 86 002505   040000 100400                    MLR     fill='040'O
        86 002506   001207 000024 12                 ADSC9   ONE_CHANGE+49            cn=0,n=20
        86 002507   000000 000024 16                 ADSC9   LIST_STRING              cn=0,n=20
        86 002510   040000 100400                    MLR     fill='040'O
        86 002511   000000 200006 18                 ADSC9   FIELD1                   cn=1,n=6
        86 002512   000005 000006 16                 ADSC9   LIST_STRING+5            cn=0,n=6
        86 002513   040000 100400                    MLR     fill='040'O
        86 002514   001214 000007 12                 ADSC9   ONE_CHANGE+54            cn=0,n=7
        86 002515   000006 400146 16                 ADSC9   LIST_STRING+6            cn=2,n=102

      963     7133    2          FIELD1.TEXT1,0,6),'000000,');
      964     7134    2       I = ID;

   7134 86 002516   200020 470500                    LDP0    @ID,,AUTO
        86 002517   003000 061500                    CSR     bolr='003'O
        86 002520   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
        86 002521   000052 000044 4                  BDSC    I                        by=0,bit=0,n=36

      965     7135    2       CALL GET_OCTAL_NUM(18,I);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:164  

   7135 86 002522   000034 236000 87                 LDQ     28
        86 002523   200024 756100                    STQ     @LEN+1,,AUTO
        86 002524   000053 236000 87                 LDQ     43
        86 002525   200023 756100                    STQ     I,,AUTO
        86 002526   002554 701000 86                 TSX1    GET_OCTAL_NUM
        86 002527   000000 011000                    NOP     0

      966     7136    2       CALL INSERT(LIST_STRING,26,6,SUBSTR(FIELD1.TEXT1,0,6),',');

   7136 86 002530   040000 100400                    MLR     fill='040'O
        86 002531   000000 200006 18                 ADSC9   FIELD1                   cn=1,n=6
        86 002532   000006 400006 16                 ADSC9   LIST_STRING+6            cn=2,n=6
        86 002533   002535 710000 86                 TRA     s:7139

      967     7137    2   JUST_WRITE_RVA:
      968     7138    2       ENTRY;

   7138 86 002534   200016 741300       JUST_WRITE_* STX1  ! LEN_UBIN+1,,AUTO

      969     7139    2       RVA_KEY.NUMBER_OF = RVA_KEY.NUMBER_OF + 1;

   7139 86 002535   000001 235000 46                 LDA     RVA_KEY+1
        86 002536   000001 035007                    ADLA    1,DL
        86 002537   000001 755000 46                 STA     RVA_KEY+1

      970     7140    2       SPECIAL_KEY = RVA_KEY;

   7140 86 002540   000000 237000 46                 LDAQ    RVA_KEY
        86 002541   000000 757000 40                 STAQ    SUBSCHEMA_KEY

      971     7141    2       CALL ZIG$SS_WVAR;

   7141 86 002542   000005 631400 87                 EPPR1   5
        86 002543   000000 701000 xent               TSX1    ZIG$SS_WVAR
        86 002544   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:165  
      972     7142    2       IF ERROR_IO ~= 0

   7142 86 002545   000000 235000 42                 LDA     ERROR_IO
        86 002546   002552 600000 86                 TZE     s:7144

      973     7143    2       THEN CALL ABORT;

   7143 86 002547   000005 631400 87                 EPPR1   5
        86 002550   000000 701000 xent               TSX1    ABORT
        86 002551   000000 011000                    NOP     0

      974     7144    2       RETURN;

   7144 86 002552   200016 221300                    LDX1  ! LEN_UBIN+1,,AUTO
        86 002553   000001 702211                    TSX2  ! 1,X1

      975     7145    2   END WRITE_RVA;
      976     7146        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:166  
      977     7147    1   GET_OCTAL_NUM:

   7147 86 002554   200022 741300       GET_OCTAL_N* STX1  ! @ID+2,,AUTO

      978     7148    1       PROC(LEN,ALI);
      979     7149    2   DCL LEN UBIN (36);
      980     7150    2   DCL 1 ALI HALIGNED,
      981     7151    2         2 NUM(0:0) UBIN (3) UNAL;
      982     7152    2   DCL I UBIN (36);
      983     7153    2   DCL CHAR_1 CHAR (1) STATIC;
      984     7154    3       DO I = 0 TO (LEN/3)-1;

   7154 86 002555   200025 450100                    STZ     I,,AUTO
        86 002556   002601 710000 86                 TRA     s:7157+2

      985     7155    3           CALL BINCHAR(CHAR_1,ALI.NUM(I+6));

   7155 86 002557   200025 236100                    LDQ     I,,AUTO
        86 002560   000003 402007                    MPY     3,DL
        86 002561   200024 470500                    LDP0    @ALI,,AUTO
        86 002562   003100 061506                    CSR     bolr='003'O
        86 002563   000000 400003                    BDSC    0,Q,PR0                  by=2,bit=0,n=3
        86 002564   200030 000044                    BDSC    COUNT1+2,,AUTO           by=0,bit=0,n=36
        86 002565   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 002566   000000 235003                    LDA     0,DU
        86 002567   200032 757100                    STAQ    COUNT1+4,,AUTO
        86 002570   000000 301500                    BTD
        86 002571   200032 000010                    NDSC9   COUNT1+4,,AUTO           cn=0,s=lsgnf,sf=0,n=8
        86 002572   000232 030001 4                  NDSC9   CHAR_1                   cn=0,s=nosgn,sf=0,n=1

      986     7156    3           CALL INSERT(FIELD1.TEXT1,I,1,CHAR_1);

   7156 86 002573   200025 236100                    LDQ     I,,AUTO
        86 002574   040006 100400                    MLR     fill='040'O
        86 002575   000232 000001 4                  ADSC9   CHAR_1                   cn=0,n=1
        86 002576   000000 200001 18                 ADSC9   FIELD1,Q                 cn=1,n=1

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:167  
      987     7157    3           END;

   7157 86 002577   000001 036007                    ADLQ    1,DL
        86 002600   200025 756100                    STQ     I,,AUTO
        86 002601   200023 470500                    LDP0    @LEN,,AUTO
        86 002602   000000 235100                    LDA     0,,PR0
        86 002603   000043 773000                    LRL     35
        86 002604   000003 507007                    DVF     3,DL
        86 002605   000044 733000                    LRS     36
        86 002606   200025 116100                    CMPQ    I,,AUTO
        86 002607   002611 600000 86                 TZE     s:7158
        86 002610   002557 603000 86                 TRC     s:7155

      988     7158    2       FIELD1.COUNT1 = LEN/3;

   7158 86 002611   000000 235100                    LDA     0,,PR0
        86 002612   000043 773000                    LRL     35
        86 002613   000003 507007                    DVF     3,DL
        86 002614   000044 733000                    LRS     36
        86 002615   000033 736000                    QLS     27
        86 002616   000000 552040 18                 STBQ    FIELD1,'40'O

      989     7159    2       RETURN;

   7159 86 002617   200022 221300                    LDX1  ! @ID+2,,AUTO
        86 002620   000001 702211                    TSX2  ! 1,X1

      990     7160    2   END GET_OCTAL_NUM;
      991     7161        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:168  
      992     7162        /*F*
      993     7163        NAME:    VALIDATER
      994     7164        PURPOSE:   To validate a translated subschema so IDS and the
      995     7165                 language that the subschema is for can read it.
      996     7166        DESCRIPTION:
      997     7167
      998     7168            The new validater:
      999     7169
     1000     7170              All validate modulals will start with the letters 'ZIG$V_'
     1001     7171            and written in pl6. The way things are done are described
     1002     7172            below.
     1003     7173
     1004     7174            WHEN TO PUT WHAT IN SCHEMA SUBSET:
     1005     7175
     1006     7176                 AC - place AC record in only if area is pressent in subschema
     1007     7177                      DDL.
     1008     7178
     1009     7179                 RC - if record is present in subschema then.
     1010     7180                      1 -  RC must be included in the schema subset.
     1011     7181
     1012     7182                      2 -  all SC and SO for the sets that the record is a
     1013     7183                                owner for.
     1014     7184
     1015     7185                      3 -  all SC and SM for all the sets that the record
     1016     7186                           is a member of.
     1017     7187
     1018     7188                      note1:
     1019     7189                           If any of 2 or 3 not present then put it in
     1020     7190                      and set these bits 'store not allowed' and
     1021     7191                      'erase not allowed'.
     1022     7192
     1023     7193                      note2:
     1024     7194                           if any of the SM records connected to this record
     1025     7195                      has the bit 'insert not allowed' on the the RC must
     1026     7196                      have the bit 'store not allowed' set.
     1027     7197
     1028     7198
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:169  
     1029     7199                      note3:
     1030     7200                           the RC for a record not present in the subschema
     1031     7201                      DDL might be present because of SC, SO, or SM
     1032     7202                      requirements but in these cases the 'not in subschema'
     1033     7203                      bit must be turned on in the RC record.
     1034     7204
     1035     7205
     1036     7206
     1037     7207
     1038     7208                 FR - All FR records in any record present in the subschema
     1039     7209                      DDL must be present.
     1040     7210
     1041     7211                      note1:
     1042     7212                           If an fr doesn't have a descriptor present for
     1043     7213                      the UWA location (not in suschema DDL) then the
     1044     7214                      'not in subschema' bit must be on.
     1045     7215
     1046     7216                      note2:
     1047     7217                           If an field is duplicated or is not actually in
     1048     7218                      the record (subschema DDL) whose RC it is linked to,
     1049     7219                      the 'synonym' bit must be on.
     1050     7220
     1051     7221                      note3:
     1052     7222                           If a field is a control field, but sufficient
     1053     7223                      information is not present to allow it to be processed
     1054     7224                      as a control field the 'field can't be mobified' bit
     1055     7225                      must be on.
     1056     7226
     1057     7227
     1058     7228                 RA - If a record is known by the subschema  to be in an
     1059     7229                      area known th the subschema, there must be an RA
     1060     7230                      relating the RC to the AC. This is the only way
     1061     7231                      for an RA to be in the schema subset.
     1062     7232
     1063     7233
     1064     7234                 SC - Set Class
     1065     7235                 SM - Set Member
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:170  
     1066     7236                 SO - Set Owner
     1067     7237
     1068     7238                      For calc set:
     1069     7239
     1070     7240                           1 -  An SM may be included in the schema subset
     1071     7241                                for a record for reasons listed under RC.
     1072     7242                                If the 'insert not allowed' bit is not on,
     1073     7243                                all SS records for the SM must be included.
     1074     7244                                See SS section.
     1075     7245
     1076     7246                           2 -  If any SM records for the calc set are
     1077     7247                                included in the schema subset, the SC and
     1078     7248                                SO records must also be included. Also
     1079     7249                                the RC for the calc header must also be
     1080     7250                                included!
     1081     7251
     1082     7252
     1083     7253                      For non-calc sets:
     1084     7254
     1085     7255                           If the set is present in the subschema:
     1086     7256
     1087     7257                           1 -  SC, SO, and all SM records for the set must
     1088     7258                                be included in the schema subset. The
     1089     7259                                corresponding RC must be included for the
     1090     7260                                SO and all SM records. If the record type
     1091     7261                                isn't in the subschema DDL then the
     1092     7262                                'not in subschema' bit in the RC must be on,
     1093     7263                                and there must be an SO or SM and RC for each
     1094     7264                                possible record type that may be encountered
     1095     7265                                in the set.
     1096     7266
     1097     7267                           2 -  If the 'insert not allowed' bit in an SM is
     1098     7268                                not on, the following must be present:
     1099     7269
     1100     7270                                     CD and FR for all sort and duplicate
     1101     7271                                     control fields for the set. These FR
     1102     7272                                     records must now have the bit
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:171  
     1103     7273                                     'field not in subschema' on.
     1104     7274
     1105     7275                                     All ss records for the SM.
     1106     7276
     1107     7277
     1108     7278                           If the set is not present in the subschema DDL:
     1109     7279
     1110     7280
     1111     7281                           1 -  SC and SO may be included for reasons
     1112     7282                                listed under RC records. If so the
     1113     7283                                'not in subschema' bit must be on in the SC.
     1114     7284
     1115     7285                           2 -  An SM must not be included for a set that
     1116     7286                                is not present in the subschema!
     1117     7287
     1118     7288
     1119     7289
     1120     7290                      SS - Set selection elements:
     1121     7291
     1122     7292                           If any SS records are included with an SM record.
     1123     7293                           All must be included and the following also:
     1124     7294
     1125     7295                                All CD and Fr records for each SS. The FR
     1126     7296                                records included because of this must have
     1127     7297                                'not in subschema' bit on.
     1128     7298
     1129     7299                                If the SS record is an entry type (calc
     1130     7300                                or current), the SO and RC records for the
     1131     7301                                record to be located by this SS record must
     1132     7302                                also be included. (also the SC record for
     1133     7303                                this SO record must be included.)
     1134     7304
     1135     7305                                If the SS record is a scan type SS, the SM
     1136     7306                                and RC records for the record to be located
     1137     7307                                by this SS must be included. The SC record
     1138     7308                                for this SM record must also be present.
     1139     7309
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:172  
     1140     7310
     1141     7311
     1142     7312                      DP - Database procedures:
     1143     7313
     1144     7314
     1145     7315                           A DP record must be included in the schema subset
     1146     7316                           for each database procedure that is to be called
     1147     7317                           by the DBCS.
     1148     7318
     1149     7319
     1150     7320
     1151     7321                      AG - Argument elements:
     1152     7322
     1153     7323
     1154     7324                           An AG record must be included in the schema
     1155     7325                           subset for each argument to every DP that is
     1156     7326                           present.
     1157     7327
     1158     7328                           If the AG record is for a field in a record, that
     1159     7329                           field must be present in the Sub Schema DDL.
     1160     7330
     1161     7331
     1162     7332
     1163     7333
     1164     7334            METHOD FOR BUILDING SCHEMA SUBSET:
     1165     7335
     1166     7336
     1167     7337                   Build a OA record for the schema subset and fill in things
     1168     7338                 from the schemas OA record.
     1169     7339
     1170     7340                   Start going through the AC descriptors (type 200)
     1171     7341                 in the descriptor segment of the subschema. Build a AC
     1172     7342                 record for the schema subset for each area in the subschema
     1173     7343                 ddl and fill it in with information from the AC record in
     1174     7344                 the schema.
     1175     7345
     1176     7346                   Go through the set and key descriptors (type 300, 350)
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:173  
     1177     7347                 Build all SC, SM, SO, CD, AND SS records for the
     1178     7348                 sets and keys in this section. (note: all generated RC
     1179     7349                 and FR record must then set the 'not in subschema' bit).
     1180     7350
     1181     7351                   Go through all record and field descriptors in the
     1182     7352                 subschema descriptor segment and build all the
     1183     7353                 RC and FR records required because it is given in the
     1184     7354                 subschema ddl. Put in any calc set or required set for any
     1185     7355                 record not allready present. (By what has to be added
     1186     7356                 one can tell most of the required information needed in
     1187     7357                 in the schema subset) Also put in all RA records that
     1188     7358                 connect the RC records with the AC records. Build the
     1189     7359                 information needed for the encoding and decoding of
     1190     7360                 fields in the record.
     1191     7361
     1192     7362                   Go through the schema file and put in all the database
     1193     7363                 parameters required.
     1194     7364
     1195     7365                   Then go throw the schema subset in memory and find all
     1196     7366                 the syn FR and find the real FR and update the syn FR to
     1197     7367                 reflex the real FR in the schema subset.
     1198     7368
     1199     7369                   Then go throw all the set and add any records that should
     1200     7370                 be added because of sets pressent in the schema subset.
     1201     7371                 These records are RC and FR records that are needed if the
     1202     7372                 ASL is to go throw this set and find any records. IDS needs
     1203     7373                 the records to be there even if the user can't find out
     1204     7374                 anything about this record.
     1205     7375
     1206     7376
     1207     7377                   Go through the schema file and put in all the database
     1208     7378                 procedure (DP) records along with the AG records.
     1209     7379
     1210     7380                   Then if Asked for prohibited or permitted statements
     1211     7381                 go through the build schema subset and find which statements
     1212     7382                 are allowed and with are not.
     1213     7383
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:174  
     1214     7384                   Write out extended descriptor segment.
     1215     7385
     1216     7386                   Write out schema subset.
     1217     7387
     1218     7388                   Put in AS record in schema and the dictionary part of
     1219     7389                 the subschema.
     1220     7390
     1221     7391
     1222     7392            TESTING NEW VALIDATER:
     1223     7393
     1224     7394                   Write a program to go throw all the descriptors in the
     1225     7395                 extended descriptor segment and the schema subset and
     1226     7396                 compare them to see what is different.
     1227     7397
     1228     7398
     1229     7399            DIFFERENCE FROM REST OF DBACS:
     1230     7400
     1231     7401
     1232     7402                 It will use a canned UWA so the updating of the comuncation
     1233     7403                 area will not have to use pointers.
     1234     7404
     1235     7405                   The main differences between the CP6 validator and GCOS
     1236     7406                 are:
     1237     7407                 first -     The schema subset is built just like IDS reads
     1238     7408                           from the subschema file not a internal form that
     1239     7409                           is only good for the DBACS use. Some side
     1240     7410                           beneficial are the that the permitted and
     1241     7411                           prohibited list should be able go be gotten
     1242     7412                           throw a display process.
     1243     7413
     1244     7414                 second -    Some of the internal descriptors are larger
     1245     7415                           then there GCOS descriptors. The type 430 now
     1246     7416                           also have the DEF part of that FR record that
     1247     7417                           are in the schema subset. They also now contain
     1248     7418                           the DBK of the FR record in the schema file for
     1249     7419                           quick access from the subschema file to the schema
     1250     7420                           file.
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:175  
     1251     7421
     1252     7422                 third -     The new validator seems to be faster then the
     1253     7423                           GCOS validator. (2 to 10 time faster).
     1254     7424
     1255     7425                 fourth -    The slow part of the new validater is conectting
     1256     7426                           up the CD records of the sets to the FR record.
     1257     7427                           So, if the subschema file has lots of set the
     1258     7428                           validation process is a little slower then maybe
     1259     7429                           it should.
     1260     7430
     1261     7431        */
     1262     7432        %EJECT;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:176  
     1263     7433        /*
     1264     7434              This is the start or ZIG$V_DRIVER main procedure.
     1265     7435
     1266     7436            Call BLD_NM to initial things for the search of area, set,
     1267     7437            key, and record names.
     1268     7438        */
     1269     7439    1       IF LANG_ALLOWED(CONTROL.LANGUAGE) = 0

   7439 86 002621   000041 720000 63                 LXL0    CONTROL+33
        86 002622   000000 235010 56                 LDA     LANG_ALLOWED,X0
        86 002623   002642 601000 86                 TNZ     s:7446

     1270     7440    2       THEN DO;

     1271     7441    2           FIELD_NAME = LANG_TEXT(SUB_LANGUAGE);

   7441 86 002624   000000 236000 57                 LDQ     SUB_LANGUAGE
        86 002625   000012 402007                    MPY     10,DL
        86 002626   040000 100406                    MLR     fill='040'O
        86 002627   000000 000012 59                 ADSC9   LANG_TEXT,Q              cn=0,n=10
        86 002630   000100 000036 4                  ADSC9   FIELD_NAME               cn=0,n=30

     1272     7442    2           CALL SET_FIELDS(1,30,FIELD_NAME);

   7442 86 002631   000055 630400 87                 EPPR0   45
        86 002632   000006 631400 87                 EPPR1   6
        86 002633   000000 701000 xent               TSX1    SET_FIELDS
        86 002634   000000 011000                    NOP     0

     1273     7443    2           CALL ERROR(%ZIG_INTERFACE_NO_$);

   7443 86 002635   000061 630400 87                 EPPR0   49
        86 002636   000000 631400 87                 EPPR1   0
        86 002637   000000 701000 xent               TSX1    ERROR
        86 002640   000000 011000                    NOP     0

     1274     7444    2           RETURN;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:177  

   7444 86 002641   000000 702200 xent               TSX2  ! X66_ARET

     1275     7445    2           END;
     1276     7446    1       CALL BLD_NM;

   7446 86 002642   000005 631400 87                 EPPR1   5
        86 002643   000000 701000 xent               TSX1    BLD_NM
        86 002644   000000 011000                    NOP     0

     1277     7447    1       SUB_LANGUAGE = CONTROL.LANGUAGE;

   7447 86 002645   000041 235000 63                 LDA     CONTROL+33
        86 002646   000000 755000 57                 STA     SUB_LANGUAGE

     1278     7448        /*  ALLOCATE_END = 1 NORMAL ALLOCATION FOR VALIDATION DYNAMIC MEM. */
     1279     7449    1       CUR_EXT_NAME_SEG = CONTROL.FIRST_NFE_RECORD;

   7449 86 002647   000076 236000 63                 LDQ     CONTROL+62
        86 002650   000000 756000 23                 STQ     CUR_EXT_NAME_SEG

     1280     7450    1       CONTROL.NUM_REC_SET_REL = 0;

   7450 86 002651   000014 450000 63                 STZ     CONTROL+12

     1281     7451    1       CONTROL.NUM_FIELD_SET = 0;

   7451 86 002652   000002 450000 63                 STZ     CONTROL+2

     1282     7452    1       CONTROL.NUM_DB_PARAM = 0;

   7452 86 002653   000015 450000 63                 STZ     CONTROL+13

     1283     7453    1       CONTROL.NUM_LOCKS = 0;

   7453 86 002654   000016 450000 63                 STZ     CONTROL+14

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:178  
     1284     7454    1       CONTROL.NUM_REC_AREA_REL = 0;

   7454 86 002655   000017 450000 63                 STZ     CONTROL+15

     1285     7455    1       CONTROL.BITS.ALL_FIELDS = '1'B;

   7455 86 002656   400000 236003                    LDQ     -131072,DU
        86 002657   000071 256000 63                 ORSQ    CONTROL+57

     1286     7456    1       NO_ERRORS = '1'B;

   7456 86 002660   000000 756000 2                  STQ     NO_ERRORS

     1287     7457    1       LARGEST_KEY = 0;

   7457 86 002661   000000 450000 22                 STZ     LARGEST_KEY

     1288     7458    1       NUM_ERROR_MSG = 0;

   7458 86 002662   000000 450000 37                 STZ     NUM_ERROR_MSG

     1289     7459    1       IF CONTROL.FIRST_CU_RECORD ~= 0

   7459 86 002663   000073 235000 63                 LDA     CONTROL+59
        86 002664   002727 600000 86                 TZE     s:7477

     1290     7460    2       THEN DO;

     1291     7461    2           I = CONTROL.FIRST_CU_RECORD;

   7461 86 002665   000052 755000 4                  STA     I

     1292     7462    2           IF CONTROL.FIRST_CU_RECORD < CONTROL.FIRST_NFE_RECORD THEN

   7462 86 002666   000073 236000 63                 LDQ     CONTROL+59
        86 002667   000076 116000 63                 CMPQ    CONTROL+62
        86 002670   002673 603000 86                 TRC     s:7465
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:179  

     1293     7463    2               CUR_EXT_NAME_SEG = CONTROL.FIRST_CU_RECORD;

   7463 86 002671   000000 756000 23                 STQ     CUR_EXT_NAME_SEG
        86 002672   002675 710000 86                 TRA     s:7466

     1294     7464    2           ELSE
     1295     7465    2               CONTROL.FIRST_CU_RECORD = CUR_EXT_NAME_SEG;

   7465 86 002673   000000 235000 23                 LDA     CUR_EXT_NAME_SEG
        86 002674   000073 755000 63                 STA     CONTROL+59

     1296     7466    3           DO WHILE (I ~= 0);

   7466 86 002675   000052 236000 4                  LDQ     I
        86 002676   002722 600000 86                 TZE     s:7474

     1297     7467    3               CALL READSF(I,IO_BUF);

   7467 86 002677   000062 630400 87                 EPPR0   50
        86 002700   000013 631400 87                 EPPR1   11
        86 002701   000000 701000 xent               TSX1    READSF
        86 002702   000000 011000                    NOP     0

     1298     7468    3               I = ADDR(IO_BUF) -> WORD36;

   7468 86 002703   000000 235000 62                 LDA     IO_BUF
        86 002704   000052 755000 4                  STA     I

     1299     7469    3               IF ADDR(IO_BUF) -> WORD36 ~= 0

   7469 86 002705   002711 600000 86                 TZE     s:7471

     1300     7470    3               THEN ADDR(IO_BUF) -> WORD36 = CUR_EXT_NAME_SEG + 1;

   7470 86 002706   000000 236000 23                 LDQ     CUR_EXT_NAME_SEG
        86 002707   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:180  
        86 002710   000000 756000 62                 STQ     IO_BUF

     1301     7471    3               CALL WRITSF(CUR_EXT_NAME_SEG,IO_BUF);

   7471 86 002711   000064 630400 87                 EPPR0   52
        86 002712   000013 631400 87                 EPPR1   11
        86 002713   000000 701000 xent               TSX1    WRITSF
        86 002714   000000 011000                    NOP     0

     1302     7472    3               CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;

   7472 86 002715   000000 235000 23                 LDA     CUR_EXT_NAME_SEG
        86 002716   000001 035007                    ADLA    1,DL
        86 002717   000000 755000 23                 STA     CUR_EXT_NAME_SEG

     1303     7473    3               END;

   7473 86 002720   000052 236000 4                  LDQ     I
        86 002721   002677 601000 86                 TNZ     s:7467

     1304     7474    2           CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + MOD(CUR_EXT_NAME_SEG,2);

   7474 86 002722   000000 236000 23                 LDQ     CUR_EXT_NAME_SEG
        86 002723   000001 376007                    ANQ     1,DL
        86 002724   000000 036000 23                 ADLQ    CUR_EXT_NAME_SEG
        86 002725   000000 756000 23                 STQ     CUR_EXT_NAME_SEG

     1305     7475    2           CONTROL.FIRST_NFE_RECORD = CUR_EXT_NAME_SEG;

   7475 86 002726   000076 756000 63                 STQ     CONTROL+62

     1306     7476    2           END;

     1307     7477    1       CONTROL.UWA_SIZE = CONTROL.TRANS_UWA_SIZE;

   7477 86 002727   000056 235000 63                 LDA     CONTROL+46
        86 002730   000004 755000 63                 STA     CONTROL+4
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:181  

     1308     7478    1       CONTROL.NEXT_UWA_LOC = CONTROL.TRANS_UWA_SIZE;

   7478 86 002731   000051 755000 63                 STA     CONTROL+41

     1309     7479    1       IF SUB_LANGUAGE = #FORTRAN

   7479 86 002732   000000 236000 57                 LDQ     SUB_LANGUAGE
        86 002733   000002 116007                    CMPQ    2,DL
        86 002734   003167 601000 86                 TNZ     s:7540

     1310     7480    2       THEN DO;

     1311     7481    2           UWA_KEY.NUMBER_OF = 0;

   7481 86 002735   000001 450000 44                 STZ     UWA_KEY+1

     1312     7482    2           RVA_KEY.NUMBER_OF = 2;

   7482 86 002736   000002 235007                    LDA     2,DL
        86 002737   000001 755000 46                 STA     RVA_KEY+1

     1313     7483    2           IA__KEY.NUMBER_OF = 0;

   7483 86 002740   000001 450000 47                 STZ     IA__KEY+1

     1314     7484    2           SUBSCHEMA_NAME_4 = SUBSTR(CONTROL.SUBSCHEMA_NAME,0,4);

   7484 86 002741   000030 236000 63                 LDQ     CONTROL+24
        86 002742   000000 756000 26                 STQ     SUBSCHEMA_NAME_4

     1315     7485    2           BUFFER$ = ADDR(LIST_STRING);

   7485 86 002743   000022 236000 87                 LDQ     18
        86 002744   000000 756000 41                 STQ     BUFFER$

     1316     7486    2           BUFFER_LEN = 72;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:182  

   7486 86 002745   000110 235007                    LDA     72,DL
        86 002746   000000 755000 43                 STA     BUFFER_LEN

     1317     7487    2           CALL CONCAT(LIST_STRING,'       COMMON /U',SUBSCHEMA_NAME_4,

   7487 86 002747   040000 100400                    MLR     fill='040'O
        86 002750   001216 000020 12                 ADSC9   ONE_CHANGE+56            cn=0,n=16
        86 002751   000000 000020 16                 ADSC9   LIST_STRING              cn=0,n=16
        86 002752   000000 236000 26                 LDQ     SUBSCHEMA_NAME_4
        86 002753   000004 756000 16                 STQ     LIST_STRING+4
        86 002754   001222 236000 12                 LDQ     ONE_CHANGE+60
        86 002755   000066 376000 87                 ANQ     54
        86 002756   000040 276007                    ORQ     32,DL
        86 002757   000005 756000 16                 STQ     LIST_STRING+5
        86 002760   040000 100400                    MLR     fill='040'O
        86 002761   000000 000004 26                 ADSC9   SUBSCHEMA_NAME_4         cn=0,n=4
        86 002762   000005 600004 16                 ADSC9   LIST_STRING+5            cn=3,n=4
        86 002763   040000 100400                    MLR     fill='040'O
        86 002764   000027 000001 87                 ADSC9   23                       cn=0,n=1
        86 002765   000006 600145 16                 ADSC9   LIST_STRING+6            cn=3,n=101

     1318     7488    2              '/ U',SUBSCHEMA_NAME_4,',');
     1319     7489    2           CALL WRITE_UWA;

   7489 86 002766   002456 701000 86                 TSX1    WRITE_UWA
        86 002767   000000 011000                    NOP     0

     1320     7490    2           LIST_STRING='     +               DBSTATUS,';

   7490 86 002770   040000 100400                    MLR     fill='040'O
        86 002771   001223 000036 12                 ADSC9   ONE_CHANGE+61            cn=0,n=30
        86 002772   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1321     7491    2           CALL WRITE_UWA;

   7491 86 002773   002456 701000 86                 TSX1    WRITE_UWA
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:183  
        86 002774   000000 011000                    NOP     0

     1322     7492    2           LIST_STRING='     +               FILLER0,';

   7492 86 002775   040000 100400                    MLR     fill='040'O
        86 002776   001233 000035 12                 ADSC9   ONE_CHANGE+69            cn=0,n=29
        86 002777   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1323     7493    2           CALL WRITE_UWA;

   7493 86 003000   002456 701000 86                 TSX1    WRITE_UWA
        86 003001   000000 011000                    NOP     0

     1324     7494    2           LIST_STRING='     +               DBAREA,';

   7494 86 003002   040000 100400                    MLR     fill='040'O
        86 003003   001243 000034 12                 ADSC9   ONE_CHANGE+77            cn=0,n=28
        86 003004   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1325     7495    2           CALL WRITE_UWA;

   7495 86 003005   002456 701000 86                 TSX1    WRITE_UWA
        86 003006   000000 011000                    NOP     0

     1326     7496    2           LIST_STRING='     +               FILLER1,';

   7496 86 003007   040000 100400                    MLR     fill='040'O
        86 003010   001252 000035 12                 ADSC9   ONE_CHANGE+84            cn=0,n=29
        86 003011   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1327     7497    2           CALL WRITE_UWA;

   7497 86 003012   002456 701000 86                 TSX1    WRITE_UWA
        86 003013   000000 011000                    NOP     0

     1328     7498    2           LIST_STRING='     +               DBSET,';

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:184  
   7498 86 003014   040000 100400                    MLR     fill='040'O
        86 003015   001262 000033 12                 ADSC9   ONE_CHANGE+92            cn=0,n=27
        86 003016   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1329     7499    2           CALL WRITE_UWA;

   7499 86 003017   002456 701000 86                 TSX1    WRITE_UWA
        86 003020   000000 011000                    NOP     0

     1330     7500    2           LIST_STRING='     +               FILLER2,';

   7500 86 003021   040000 100400                    MLR     fill='040'O
        86 003022   001271 000035 12                 ADSC9   ONE_CHANGE+99            cn=0,n=29
        86 003023   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1331     7501    2           CALL WRITE_UWA;

   7501 86 003024   002456 701000 86                 TSX1    WRITE_UWA
        86 003025   000000 011000                    NOP     0

     1332     7502    2           LIST_STRING='     +               DBRECORD,';

   7502 86 003026   040000 100400                    MLR     fill='040'O
        86 003027   001301 000036 12                 ADSC9   ONE_CHANGE+107           cn=0,n=30
        86 003030   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1333     7503    2           CALL WRITE_UWA;

   7503 86 003031   002456 701000 86                 TSX1    WRITE_UWA
        86 003032   000000 011000                    NOP     0

     1334     7504    2           LIST_STRING='     +               FILLER3,';

   7504 86 003033   040000 100400                    MLR     fill='040'O
        86 003034   001311 000035 12                 ADSC9   ONE_CHANGE+115           cn=0,n=29
        86 003035   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:185  
     1335     7505    2           CALL WRITE_UWA;

   7505 86 003036   002456 701000 86                 TSX1    WRITE_UWA
        86 003037   000000 011000                    NOP     0

     1336     7506    2           LIST_STRING='     +               DBPRIVACY,';

   7506 86 003040   040000 100400                    MLR     fill='040'O
        86 003041   001321 000037 12                 ADSC9   ONE_CHANGE+123           cn=0,n=31
        86 003042   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1337     7507    2           CALL WRITE_UWA;

   7507 86 003043   002456 701000 86                 TSX1    WRITE_UWA
        86 003044   000000 011000                    NOP     0

     1338     7508    2           LIST_STRING='     +               DIRECTREFERENCE,';

   7508 86 003045   040000 100400                    MLR     fill='040'O
        86 003046   001331 000045 12                 ADSC9   ONE_CHANGE+131           cn=0,n=37
        86 003047   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1339     7509    2           CALL WRITE_UWA;

   7509 86 003050   002456 701000 86                 TSX1    WRITE_UWA
        86 003051   000000 011000                    NOP     0

     1340     7510    2           LIST_STRING='     +               DBDATANAME,';

   7510 86 003052   040000 100400                    MLR     fill='040'O
        86 003053   001343 000040 12                 ADSC9   ONE_CHANGE+141           cn=0,n=32
        86 003054   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1341     7511    2           CALL WRITE_UWA;

   7511 86 003055   002456 701000 86                 TSX1    WRITE_UWA
        86 003056   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:186  

     1342     7512    2           LIST_STRING='     +               FILLER4,';

   7512 86 003057   040000 100400                    MLR     fill='040'O
        86 003060   001353 000035 12                 ADSC9   ONE_CHANGE+149           cn=0,n=29
        86 003061   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1343     7513    2           CALL WRITE_UWA;

   7513 86 003062   002456 701000 86                 TSX1    WRITE_UWA
        86 003063   000000 011000                    NOP     0

     1344     7514    2           LIST_STRING='     +               DBKEYNAME,';

   7514 86 003064   040000 100400                    MLR     fill='040'O
        86 003065   001363 000037 12                 ADSC9   ONE_CHANGE+157           cn=0,n=31
        86 003066   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1345     7515    2           CALL WRITE_UWA;

   7515 86 003067   002456 701000 86                 TSX1    WRITE_UWA
        86 003070   000000 011000                    NOP     0

     1346     7516    2           LIST_STRING='     +               FILLER5,';

   7516 86 003071   040000 100400                    MLR     fill='040'O
        86 003072   001373 000035 12                 ADSC9   ONE_CHANGE+165           cn=0,n=29
        86 003073   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1347     7517    2           CALL WRITE_UWA;

   7517 86 003074   002456 701000 86                 TSX1    WRITE_UWA
        86 003075   000000 011000                    NOP     0

     1348     7518    2           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;

   7518 86 003076   000001 235000 44                 LDA     UWA_KEY+1
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:187  
        86 003077   000164 755000 4                  STA     SAVE_LAST_UWA

     1349     7519    2           UWA_KEY.NUMBER_OF = 10000;

   7519 86 003100   023420 236007                    LDQ     10000,DL
        86 003101   000001 756000 44                 STQ     UWA_KEY+1

     1350     7520    2           CALL CONCAT(LIST_STRING,'       INTEGER U',SUBSCHEMA_NAME_4,

   7520 86 003102   040000 100400                    MLR     fill='040'O
        86 003103   001403 000020 12                 ADSC9   ONE_CHANGE+173           cn=0,n=16
        86 003104   000000 000020 16                 ADSC9   LIST_STRING              cn=0,n=16
        86 003105   000000 236000 26                 LDQ     SUBSCHEMA_NAME_4
        86 003106   000004 756000 16                 STQ     LIST_STRING+4
        86 003107   040000 100400                    MLR     fill='040'O
        86 003110   001407 000020 12                 ADSC9   ONE_CHANGE+177           cn=0,n=16
        86 003111   000005 000154 16                 ADSC9   LIST_STRING+5            cn=0,n=108

     1351     7521    2              ',DIRECTREFERENCE');
     1352     7522    2           CALL WRITE_UWA;

   7522 86 003112   002456 701000 86                 TSX1    WRITE_UWA
        86 003113   000000 011000                    NOP     0

     1353     7523    2           LIST_STRING='       CHARACTER*1    FILLER0';

   7523 86 003114   040000 100400                    MLR     fill='040'O
        86 003115   001413 000035 12                 ADSC9   ONE_CHANGE+181           cn=0,n=29
        86 003116   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1354     7524    2           CALL WRITE_UWA;

   7524 86 003117   002456 701000 86                 TSX1    WRITE_UWA
        86 003120   000000 011000                    NOP     0

     1355     7525    2           LIST_STRING='       CHARACTER*7    DBSTATUS';

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:188  
   7525 86 003121   040000 100400                    MLR     fill='040'O
        86 003122   001423 000036 12                 ADSC9   ONE_CHANGE+189           cn=0,n=30
        86 003123   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1356     7526    2           CALL WRITE_UWA;

   7526 86 003124   002456 701000 86                 TSX1    WRITE_UWA
        86 003125   000000 011000                    NOP     0

     1357     7527    2           LIST_STRING='      CHARACTER*30 DBDATANAME,DBKEYNAME,DBAREA,DBSET,DBRECORD'
              7527                    ;

   7527 86 003126   040000 100400                    MLR     fill='040'O
        86 003127   001433 000076 12                 ADSC9   ONE_CHANGE+197           cn=0,n=62
        86 003130   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1358     7528    2           CALL WRITE_UWA;

   7528 86 003131   002456 701000 86                 TSX1    WRITE_UWA
        86 003132   000000 011000                    NOP     0

     1359     7529    2           LIST_STRING='       CHARACTER*12 DBPRIVACY';

   7529 86 003133   040000 100400                    MLR     fill='040'O
        86 003134   001453 000035 12                 ADSC9   ONE_CHANGE+213           cn=0,n=29
        86 003135   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1360     7530    2           CALL WRITE_UWA;

   7530 86 003136   002456 701000 86                 TSX1    WRITE_UWA
        86 003137   000000 011000                    NOP     0

     1361     7531    2           LIST_STRING='       CHARACTER*2  FILLER1,FILLER2,FILLER3,FILLER4';

   7531 86 003140   040000 100400                    MLR     fill='040'O
        86 003141   001463 000063 12                 ADSC9   ONE_CHANGE+221           cn=0,n=51
        86 003142   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:189  

     1362     7532    2           CALL WRITE_UWA;

   7532 86 003143   002456 701000 86                 TSX1    WRITE_UWA
        86 003144   000000 011000                    NOP     0

     1363     7533    2           LIST_STRING='       CHARACTER*6  FILLER5';

   7533 86 003145   040000 100400                    MLR     fill='040'O
        86 003146   001500 000033 12                 ADSC9   ONE_CHANGE+234           cn=0,n=27
        86 003147   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1364     7534    2           CALL WRITE_UWA;

   7534 86 003150   002456 701000 86                 TSX1    WRITE_UWA
        86 003151   000000 011000                    NOP     0

     1365     7535    2           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;

   7535 86 003152   000001 235000 44                 LDA     UWA_KEY+1
        86 003153   000000 755000 45                 STA     NEXT_UWA_SECOND_HALF

     1366     7536    2           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;

   7536 86 003154   000164 236000 4                  LDQ     SAVE_LAST_UWA
        86 003155   000001 756000 44                 STQ     UWA_KEY+1

     1367     7537    2           NEXT_RVA_SECOND_HALF = 10000;

   7537 86 003156   023420 235007                    LDA     10000,DL
        86 003157   000000 755000 48                 STA     NEXT_RVA_SECOND_HALF

     1368     7538    2           CALL CONCAT(RVA_NAME,',R',SUBSCHEMA_NAME_4,'(');

   7538 86 003160   001507 220000 12                 LDX0    ONE_CHANGE+241
        86 003161   000162 740000 4                  STX0    RVA_NAME
        86 003162   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:190  
        86 003163   000000 000004 26                 ADSC9   SUBSCHEMA_NAME_4         cn=0,n=4
        86 003164   000162 400004 4                  ADSC9   RVA_NAME                 cn=2,n=4
        86 003165   050040 221003                    LDX1    20512,DU
        86 003166   000163 441000 4                  SXL1    RVA_NAME+1

     1369     7539    2           END;

     1370     7540    1       CALL ZIG$V_OA;

   7540 86 003167   000005 631400 87                 EPPR1   5
        86 003170   000000 701000 xent               TSX1    ZIG$V_OA
        86 003171   000000 011000                    NOP     0

     1371     7541    1       CALL ZIG$INIT_AS;

   7541 86 003172   000005 631400 87                 EPPR1   5
        86 003173   000000 701000 xent               TSX1    ZIG$INIT_AS
        86 003174   000000 011000                    NOP     0

     1372     7542        /*
     1373     7543              Iintialize the count of things that the validater put
     1374     7544            out to zero so we don't count too many.
     1375     7545        */
     1376     7546    1       FIRST_AREA = '1'B;

   7546 86 003175   400000 236003                    LDQ     -131072,DU
        86 003176   200003 756100                    STQ     FIRST_AREA,,AUTO

     1377     7547    1       FIRST_SET = '1'B;

   7547 86 003177   200004 756100                    STQ     FIRST_SET,,AUTO

     1378     7548    1       FIRST_DATA_PAR = '1'B;

   7548 86 003200   200005 756100                    STQ     FIRST_DATA_PAR,,AUTO

     1379     7549    1       FIRST_RECORD = '1'B;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:191  

   7549 86 003201   200006 756100                    STQ     FIRST_RECORD,,AUTO

     1380     7550    1       RECORD_NUM = 4; /* Init the record number for the hash table. */

   7550 86 003202   000004 235007                    LDA     4,DL
        86 003203   000000 755000 10                 STA     RECORD_NUM

     1381     7551    1       ERROR_IO = 0;

   7551 86 003204   000000 450000 42                 STZ     ERROR_IO

     1382     7552    1       LAST_AC = 1; /* Point last AC to OA record */

   7552 86 003205   000001 220003                    LDX0    1,DU
        86 003206   000000 740000 5                  STX0    LAST_AC

     1383     7553    1       LAST_SC = 1;

   7553 86 003207   000000 740000 6                  STX0    LAST_SC

     1384     7554    1       LAST_RC = 1;

   7554 86 003210   000000 740000 7                  STX0    LAST_RC

     1385     7555    1       CF_PTR$ = ADDR(NIL);

   7555 86 003211   000016 236000 87                 LDQ     14
        86 003212   000000 756000 11                 STQ     CF_PTR$

     1386     7556    1       CALL UOPEN('5*',1);

   7556 86 003213   000067 630400 87                 EPPR0   55
        86 003214   000013 631400 87                 EPPR1   11
        86 003215   000000 701000 xent               TSX1    UOPEN
        86 003216   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:192  
     1387     7557        /*
     1388     7558              Open 5* file for the type 34, 35, and 36 descriptors that
     1389     7559            go in the name extenction segment but COBOL is just to
     1390     7560            screwed up to handle anything but it own descriptors there.
     1391     7561        */
     1392     7562    1       CURRENT_RECORD = CONTROL.FIRST_SDS_RECORD;

   7562 86 003217   000075 235000 63                 LDA     CONTROL+61
        86 003220   000000 755000 61                 STA     CURRENT_RECORD

     1393     7563    1       CALL READSF(CURRENT_RECORD,IO_BUF);

   7563 86 003221   000071 630400 87                 EPPR0   57
        86 003222   000013 631400 87                 EPPR1   11
        86 003223   000000 701000 xent               TSX1    READSF
        86 003224   000000 011000                    NOP     0

     1394     7564    2       DO WHILE (SUBSTR(IO_BUF,0,12) ~= SUBSTR(EOFC,0,12) AND ERROR_READ64 = 0);

   7564 86 003225   004306 710000 86                 TRA     s:7731

     1395     7565    3           DO CASE (TYPE_100.TYPE/10);

   7565 86 003226   000000 236000 62                 LDQ     IO_BUF
        86 003227   000001 772000                    QRL     1
        86 003230   000005 506007                    DIV     5,DL
        86 003231   000024 136007                    SBLQ    20,DL
        86 003232   000030 116007                    CMPQ    24,DL
        86 003233   003235 602006 86                 TNC     s:7565+7,QL
        86 003234   004277 710000 86                 TRA     s:7729
        86 003235   003265 710000 86                 TRA     s:7576
        86 003236   004277 710000 86                 TRA     s:7729
        86 003237   004277 710000 86                 TRA     s:7729
        86 003240   004277 710000 86                 TRA     s:7729
        86 003241   004277 710000 86                 TRA     s:7729
        86 003242   004277 710000 86                 TRA     s:7729
        86 003243   004277 710000 86                 TRA     s:7729
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:193  
        86 003244   004277 710000 86                 TRA     s:7729
        86 003245   004277 710000 86                 TRA     s:7729
        86 003246   004277 710000 86                 TRA     s:7729
        86 003247   003425 710000 86                 TRA     s:7602
        86 003250   004277 710000 86                 TRA     s:7729
        86 003251   004277 710000 86                 TRA     s:7729
        86 003252   004277 710000 86                 TRA     s:7729
        86 003253   004277 710000 86                 TRA     s:7729
        86 003254   003425 710000 86                 TRA     s:7602
        86 003255   004277 710000 86                 TRA     s:7729
        86 003256   004277 710000 86                 TRA     s:7729
        86 003257   004277 710000 86                 TRA     s:7729
        86 003260   004277 710000 86                 TRA     s:7729
        86 003261   003553 710000 86                 TRA     s:7620
        86 003262   004277 710000 86                 TRA     s:7729
        86 003263   004144 710000 86                 TRA     s:7694
        86 003264   004152 710000 86                 TRA     s:7700

     1396     7566    3           CASE (10);

     1397     7567        /*
     1398     7568              Translation control status.
     1399     7569            Don't need to do any thing!
     1400     7570        */
     1401     7571    3           CASE (11,21,41);

     1402     7572        /*
     1403     7573              Subschema privacy locks.
     1404     7574        */
     1405     7575    3           CASE (20);

     1406     7576    3               IF FIRST_AREA AND VALIDS.AREA_XREF

   7576 86 003265   200003 234100                    SZN     FIRST_AREA,,AUTO
        86 003266   003277 605000 86                 TPL     s:7584
        86 003267   000000 236000 31                 LDQ     VALIDS
        86 003270   000040 316003                    CANQ    32,DU
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:194  
        86 003271   003277 600000 86                 TZE     s:7584

     1407     7577    4               THEN DO;

     1408     7578    4                   CALL SUBLST(HEAD_AREA_XREF);

   7578 86 003272   000073 630400 87                 EPPR0   59
        86 003273   000000 631400 87                 EPPR1   0
        86 003274   000000 701000 xent               TSX1    SUBLST
        86 003275   000000 011000                    NOP     0

     1409     7579    4                   FIRST_AREA = '0'B;

   7579 86 003276   200003 450100                    STZ     FIRST_AREA,,AUTO

     1410     7580    4                   END;

     1411     7581        /*
     1412     7582              Area that is declared in the subschema.
     1413     7583        */
     1414     7584    3               CALL ZIG$V_AREA;

   7584 86 003277   000005 631400 87                 EPPR1   5
        86 003300   000000 701000 xent               TSX1    ZIG$V_AREA
        86 003301   000000 011000                    NOP     0

     1415     7585    3               IF SUB_LANGUAGE = #FORTRAN

   7585 86 003302   000000 235000 57                 LDA     SUB_LANGUAGE
        86 003303   000002 115007                    CMPA    2,DL
        86 003304   004277 601000 86                 TNZ     s:7729

     1416     7586    4               THEN DO;

     1417     7587    4                   CALL WRITE_RVA(0,AC.ACID);

   7587 86 003305   000000 236000 67                 LDQ     AC$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:195  
        86 003306   000074 036000 87                 ADLQ    60
        86 003307   200020 756100                    STQ     @TYPE+1,,AUTO
        86 003310   000075 236000 87                 LDQ     61
        86 003311   200017 756100                    STQ     LEN_UBIN+2,,AUTO
        86 003312   002476 701000 86                 TSX1    WRITE_RVA
        86 003313   000000 011000                    NOP     0

     1418     7588    4                   SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;

   7588 86 003314   000001 235000 46                 LDA     RVA_KEY+1
        86 003315   000165 755000 4                  STA     SAVE_LAST_RVA

     1419     7589    4                   RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;

   7589 86 003316   000000 236000 48                 LDQ     NEXT_RVA_SECOND_HALF
        86 003317   000001 756000 46                 STQ     RVA_KEY+1

     1420     7590    4                   CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-2);

   7590 86 003320   000002 135007                    SBLA    2,DL
        86 003321   200030 755100                    STA     COUNT1+2,,AUTO
        86 003322   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 003323   200033 450500                    STP0    COUNT1+5,,AUTO
        86 003324   000010 236000 87                 LDQ     8
        86 003325   200032 756100                    STQ     COUNT1+4,,AUTO
        86 003326   200032 630500                    EPPR0   COUNT1+4,,AUTO
        86 003327   000013 631400 87                 EPPR1   11
        86 003330   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 003331   000000 011000                    NOP     0

     1421     7591    4                   CALL CONCAT(LIST_STRING,'       EQUIVALENCE (',

   7591 86 003332   000000 470400 67                 LDP0    AC$
        86 003333   000000 720100                    LXL0    0,,PR0
        86 003334   000077 360003                    ANX0    63,DU
        86 003335   000000 236000 18                 LDQ     FIELD1
        86 003336   000033 772000                    QRL     27
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:196  
        86 003337   040000 100400                    MLR     fill='040'O
        86 003340   001511 000024 12                 ADSC9   ONE_CHANGE+243           cn=0,n=20
        86 003341   000000 000024 16                 ADSC9   LIST_STRING              cn=0,n=20
        86 003342   040000 100540                    MLR     fill='040'O
        86 003343   000026 000010                    ADSC9   22,,PR0                  cn=0,n=*X0
        86 003344   000005 000154 16                 ADSC9   LIST_STRING+5            cn=0,n=108
        86 003345   000000 621006                    EAX1    0,QL
        86 003346   000000 636010                    EAQ     0,X0
        86 003347   000022 772000                    QRL     18
        86 003350   000154 116007                    CMPQ    108,DL
        86 003351   003416 603000 86                 TRC     s:7594
        86 003352   200030 740100                    STX0    COUNT1+2,,AUTO
        86 003353   777623 620010                    EAX0    -109,X0
        86 003354   777777 660003                    ERX0    -1,DU
        86 003355   200030 235100                    LDA     COUNT1+2,,AUTO
        86 003356   000022 771000                    ARL     18
        86 003357   040045 100400                    MLR     fill='040'O
        86 003360   000162 000010 4                  ADSC9   RVA_NAME                 cn=0,n=8
        86 003361   000005 000010 16                 ADSC9   LIST_STRING+5,A          cn=0,n=*X0
        86 003362   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 003363   000022 772000                    QRL     18
        86 003364   000144 116007                    CMPQ    100,DL
        86 003365   003416 603000 86                 TRC     s:7594
        86 003366   777633 620006                    EAX0    -101,QL
        86 003367   777777 660003                    ERX0    -1,DU
        86 003370   040046 100440                    MLR     fill='040'O
        86 003371   000000 200011 18                 ADSC9   FIELD1                   cn=1,n=*X1
        86 003372   000007 000010 16                 ADSC9   LIST_STRING+7,Q          cn=0,n=*X0
        86 003373   000000 635011                    EAA     0,X1
        86 003374   000022 771000                    ARL     18
        86 003375   200031 755100                    STA     COUNT1+3,,AUTO
        86 003376   200031 036100                    ADLQ    COUNT1+3,,AUTO
        86 003377   000144 116007                    CMPQ    100,DL
        86 003400   003416 603000 86                 TRC     s:7594
        86 003401   000000 635011                    EAA     0,X1
        86 003402   000022 771000                    ARL     18
        86 003403   200032 755100                    STA     COUNT1+4,,AUTO
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:197  
        86 003404   200033 756100                    STQ     COUNT1+5,,AUTO
        86 003405   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 003406   000022 772000                    QRL     18
        86 003407   200032 036100                    ADLQ    COUNT1+4,,AUTO
        86 003410   200033 721100                    LXL1    COUNT1+5,,AUTO
        86 003411   777633 621011                    EAX1    -101,X1
        86 003412   777777 661003                    ERX1    -1,DU
        86 003413   040046 100400                    MLR     fill='040'O
        86 003414   001516 000002 12                 ADSC9   ONE_CHANGE+248           cn=0,n=2
        86 003415   000007 000011 16                 ADSC9   LIST_STRING+7,Q          cn=0,n=*X1

     1422     7592    4                      AC.ANAM,RVA_NAME,SUBSTR(FIELD1.TEXT1,0,
     1423     7593    4                      FIELD1.COUNT1),'))');
     1424     7594    4                   CALL JUST_WRITE_RVA;

   7594 86 003416   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 003417   000000 011000                    NOP     0

     1425     7595    4                   NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;

   7595 86 003420   000001 235000 46                 LDA     RVA_KEY+1
        86 003421   000000 755000 48                 STA     NEXT_RVA_SECOND_HALF

     1426     7596    4                   RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;

   7596 86 003422   000165 236000 4                  LDQ     SAVE_LAST_RVA
        86 003423   000001 756000 46                 STQ     RVA_KEY+1

     1427     7597    4                   END;

   7597 86 003424   004277 710000 86                 TRA     s:7729

     1428     7598    3           CASE (30,35); /* sets and keys */

     1429     7599        /*
     1430     7600              Set that is in the subschema.
     1431     7601        */
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:198  
     1432     7602    3               CALL ZIG$V_SET;

   7602 86 003425   000005 631400 87                 EPPR1   5
        86 003426   000000 701000 xent               TSX1    ZIG$V_SET
        86 003427   000000 011000                    NOP     0

     1433     7603    3               IF SUB_LANGUAGE = #FORTRAN

   7603 86 003430   000000 235000 57                 LDA     SUB_LANGUAGE
        86 003431   000002 115007                    CMPA    2,DL
        86 003432   004277 601000 86                 TNZ     s:7729

     1434     7604    4               THEN DO;

     1435     7605    4                   CALL WRITE_RVA(1,SC.SCID);

   7605 86 003433   000000 236000 71                 LDQ     SC$
        86 003434   000076 036000 87                 ADLQ    62
        86 003435   200020 756100                    STQ     @TYPE+1,,AUTO
        86 003436   000010 236000 87                 LDQ     8
        86 003437   200017 756100                    STQ     LEN_UBIN+2,,AUTO
        86 003440   002476 701000 86                 TSX1    WRITE_RVA
        86 003441   000000 011000                    NOP     0

     1436     7606    4                   SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;

   7606 86 003442   000001 235000 46                 LDA     RVA_KEY+1
        86 003443   000165 755000 4                  STA     SAVE_LAST_RVA

     1437     7607    4                   RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;

   7607 86 003444   000000 236000 48                 LDQ     NEXT_RVA_SECOND_HALF
        86 003445   000001 756000 46                 STQ     RVA_KEY+1

     1438     7608    4                   CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-2);

   7608 86 003446   000002 135007                    SBLA    2,DL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:199  
        86 003447   200030 755100                    STA     COUNT1+2,,AUTO
        86 003450   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 003451   200033 450500                    STP0    COUNT1+5,,AUTO
        86 003452   000010 236000 87                 LDQ     8
        86 003453   200032 756100                    STQ     COUNT1+4,,AUTO
        86 003454   200032 630500                    EPPR0   COUNT1+4,,AUTO
        86 003455   000013 631400 87                 EPPR1   11
        86 003456   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 003457   000000 011000                    NOP     0

     1439     7609    4                   CALL CONCAT(LIST_STRING,'       EQUIVALENCE (',

   7609 86 003460   000000 470400 71                 LDP0    SC$
        86 003461   000000 720100                    LXL0    0,,PR0
        86 003462   000077 360003                    ANX0    63,DU
        86 003463   000000 236000 18                 LDQ     FIELD1
        86 003464   000033 772000                    QRL     27
        86 003465   040000 100400                    MLR     fill='040'O
        86 003466   001511 000024 12                 ADSC9   ONE_CHANGE+243           cn=0,n=20
        86 003467   000000 000024 16                 ADSC9   LIST_STRING              cn=0,n=20
        86 003470   040000 100540                    MLR     fill='040'O
        86 003471   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        86 003472   000005 000154 16                 ADSC9   LIST_STRING+5            cn=0,n=108
        86 003473   000000 621006                    EAX1    0,QL
        86 003474   000000 636010                    EAQ     0,X0
        86 003475   000022 772000                    QRL     18
        86 003476   000154 116007                    CMPQ    108,DL
        86 003477   003544 603000 86                 TRC     s:7612
        86 003500   200030 740100                    STX0    COUNT1+2,,AUTO
        86 003501   777623 620010                    EAX0    -109,X0
        86 003502   777777 660003                    ERX0    -1,DU
        86 003503   200030 235100                    LDA     COUNT1+2,,AUTO
        86 003504   000022 771000                    ARL     18
        86 003505   040045 100400                    MLR     fill='040'O
        86 003506   000162 000010 4                  ADSC9   RVA_NAME                 cn=0,n=8
        86 003507   000005 000010 16                 ADSC9   LIST_STRING+5,A          cn=0,n=*X0
        86 003510   200030 236100                    LDQ     COUNT1+2,,AUTO
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:200  
        86 003511   000022 772000                    QRL     18
        86 003512   000144 116007                    CMPQ    100,DL
        86 003513   003544 603000 86                 TRC     s:7612
        86 003514   777633 620006                    EAX0    -101,QL
        86 003515   777777 660003                    ERX0    -1,DU
        86 003516   040046 100440                    MLR     fill='040'O
        86 003517   000000 200011 18                 ADSC9   FIELD1                   cn=1,n=*X1
        86 003520   000007 000010 16                 ADSC9   LIST_STRING+7,Q          cn=0,n=*X0
        86 003521   000000 635011                    EAA     0,X1
        86 003522   000022 771000                    ARL     18
        86 003523   200031 755100                    STA     COUNT1+3,,AUTO
        86 003524   200031 036100                    ADLQ    COUNT1+3,,AUTO
        86 003525   000144 116007                    CMPQ    100,DL
        86 003526   003544 603000 86                 TRC     s:7612
        86 003527   000000 635011                    EAA     0,X1
        86 003530   000022 771000                    ARL     18
        86 003531   200032 755100                    STA     COUNT1+4,,AUTO
        86 003532   200033 756100                    STQ     COUNT1+5,,AUTO
        86 003533   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 003534   000022 772000                    QRL     18
        86 003535   200032 036100                    ADLQ    COUNT1+4,,AUTO
        86 003536   200033 721100                    LXL1    COUNT1+5,,AUTO
        86 003537   777633 621011                    EAX1    -101,X1
        86 003540   777777 661003                    ERX1    -1,DU
        86 003541   040046 100400                    MLR     fill='040'O
        86 003542   001516 000002 12                 ADSC9   ONE_CHANGE+248           cn=0,n=2
        86 003543   000007 000011 16                 ADSC9   LIST_STRING+7,Q          cn=0,n=*X1

     1440     7610    4                      SC.SNAM,RVA_NAME,SUBSTR(FIELD1.TEXT1,0,
     1441     7611    4                      FIELD1.COUNT1),'))');
     1442     7612    4                   CALL JUST_WRITE_RVA;

   7612 86 003544   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 003545   000000 011000                    NOP     0

     1443     7613    4                   NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:201  
   7613 86 003546   000001 235000 46                 LDA     RVA_KEY+1
        86 003547   000000 755000 48                 STA     NEXT_RVA_SECOND_HALF

     1444     7614    4                   RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;

   7614 86 003550   000165 236000 4                  LDQ     SAVE_LAST_RVA
        86 003551   000001 756000 46                 STQ     RVA_KEY+1

     1445     7615    4                   END;

   7615 86 003552   004277 710000 86                 TRA     s:7729

     1446     7616    3           CASE (40);

     1447     7617        /*
     1448     7618              Record that is in the subschema.
     1449     7619        */
     1450     7620    3               IF LAST_RC ~= 1

   7620 86 003553   000000 220000 7                  LDX0    LAST_RC
        86 003554   000001 100003                    CMPX0   1,DU
        86 003555   003562 600000 86                 TZE     s:7629

     1451     7621    4               THEN DO;

     1452     7622        /*
     1453     7623              Now check the last record to see if all the item
     1454     7624            have been given and what can be done to this record.
     1455     7625        */
     1456     7626    4                   IF RECORD_FOUND

   7626 86 003556   000000 234000 15                 SZN     RECORD_FOUND
        86 003557   003562 605000 86                 TPL     s:7629

     1457     7627    4                   THEN CALL ZIG$V_CHECK_F;

   7627 86 003560   000003 701000 86                 TSX1    ZIG$V_CHECK_F
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:202  
        86 003561   000000 011000                    NOP     0

     1458     7628    4                   END;

     1459     7629    3               IF FIRST_RECORD AND VALIDS.RECORD_XREF

   7629 86 003562   200006 234100                    SZN     FIRST_RECORD,,AUTO
        86 003563   003574 605000 86                 TPL     s:7634
        86 003564   000000 236000 31                 LDQ     VALIDS
        86 003565   000020 316003                    CANQ    16,DU
        86 003566   003574 600000 86                 TZE     s:7634

     1460     7630    4               THEN DO;

     1461     7631    4                   CALL SUBLST(HEAD_RECORD_XREF);

   7631 86 003567   000077 630400 87                 EPPR0   63
        86 003570   000000 631400 87                 EPPR1   0
        86 003571   000000 701000 xent               TSX1    SUBLST
        86 003572   000000 011000                    NOP     0

     1462     7632    4                   FIRST_RECORD = '0'B;

   7632 86 003573   200006 450100                    STZ     FIRST_RECORD,,AUTO

     1463     7633    4                   END;

     1464     7634    3               IF VALIDS.RECORD_XREF

   7634 86 003574   000000 236000 31                 LDQ     VALIDS
        86 003575   000020 316003                    CANQ    16,DU
        86 003576   003606 600000 86                 TZE     s:7639

     1465     7635    4               THEN DO;

     1466     7636    4                   LIST_STRING = ' ';

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:203  
   7636 86 003577   040000 100400                    MLR     fill='040'O
        86 003600   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 003601   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1467     7637    4                   CALL LIST(LIST_STRING);

   7637 86 003602   000022 630400 87                 EPPR0   18
        86 003603   000000 631400 87                 EPPR1   0
        86 003604   000000 701000 xent               TSX1    LIST
        86 003605   000000 011000                    NOP     0

     1468     7638    4                   END;

     1469     7639    3               CALL ZIG$ZERO_ALT_TABLE;

   7639 86 003606   000005 631400 87                 EPPR1   5
        86 003607   000000 701000 xent               TSX1    ZIG$ZERO_ALT_TABLE
        86 003610   000000 011000                    NOP     0

     1470     7640    3               IN_GROUP = '0'B;

   7640 86 003611   000000 450000 13                 STZ     IN_GROUP

     1471     7641    3               LAST_GROUP_LEVEL = 0;

   7641 86 003612   000000 450000 14                 STZ     LAST_GROUP_LEVEL

     1472     7642    3               CALL ZIG$V_RECORD;

   7642 86 003613   000005 631400 87                 EPPR1   5
        86 003614   000000 701000 xent               TSX1    ZIG$V_RECORD
        86 003615   000000 011000                    NOP     0

     1473     7643    3               IF VALIDS.RECORD_XREF

   7643 86 003616   000000 236000 31                 LDQ     VALIDS
        86 003617   000020 316003                    CANQ    16,DU
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:204  
        86 003620   003732 600000 86                 TZE     s:7660

     1474     7644    4               THEN DO;

     1475     7645    4                   LIST_STRING = ' ';

   7645 86 003621   040000 100400                    MLR     fill='040'O
        86 003622   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 003623   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1476     7646    4                   CALL LIST(LIST_STRING);

   7646 86 003624   000022 630400 87                 EPPR0   18
        86 003625   000000 631400 87                 EPPR1   0
        86 003626   000000 701000 xent               TSX1    LIST
        86 003627   000000 011000                    NOP     0

     1477     7647    4                   IF TYPE_400.ALIASED

   7647 86 003630   000025 234000 62                 SZN     IO_BUF+21
        86 003631   003713 605000 86                 TPL     s:7654

     1478     7648    5                   THEN DO;

     1479     7649    5                       CALL INDEX1(I,' ',TYPE_400.RECORD_NAME);

   7649 86 003632   000000 124400                    SCM     mask='000'O
        86 003633   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30
        86 003634   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 003635   000052 000000 4                  ARG     I

     1480     7650    5                       CALL CONCAT(LIST_STRING,'RECORD-NAME: ',

   7650 86 003636   000000 470400 73                 LDP0    RC$
        86 003637   000000 720100                    LXL0    0,,PR0
        86 003640   000077 360003                    ANX0    63,DU
        86 003641   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:205  
        86 003642   001517 000015 12                 ADSC9   ONE_CHANGE+249           cn=0,n=13
        86 003643   000000 000015 16                 ADSC9   LIST_STRING              cn=0,n=13
        86 003644   040000 100540                    MLR     fill='040'O
        86 003645   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        86 003646   000003 200163 16                 ADSC9   LIST_STRING+3            cn=1,n=115
        86 003647   000000 636010                    EAQ     0,X0
        86 003650   000022 772000                    QRL     18
        86 003651   000163 116007                    CMPQ    115,DL
        86 003652   003712 603000 86                 TRC     s:7652
        86 003653   200030 740100                    STX0    COUNT1+2,,AUTO
        86 003654   777614 620010                    EAX0    -116,X0
        86 003655   777777 660003                    ERX0    -1,DU
        86 003656   200030 235100                    LDA     COUNT1+2,,AUTO
        86 003657   000022 771000                    ARL     18
        86 003660   040045 100400                    MLR     fill='040'O
        86 003661   001523 000007 12                 ADSC9   ONE_CHANGE+253           cn=0,n=7
        86 003662   000003 200010 16                 ADSC9   LIST_STRING+3,A          cn=1,n=*X0
        86 003663   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 003664   000022 772000                    QRL     18
        86 003665   000154 116007                    CMPQ    108,DL
        86 003666   003712 603000 86                 TRC     s:7652
        86 003667   777623 620006                    EAX0    -109,QL
        86 003670   777777 660003                    ERX0    -1,DU
        86 003671   000052 721000 4                  LXL1    I
        86 003672   040046 100440                    MLR     fill='040'O
        86 003673   000003 000011 62                 ADSC9   IO_BUF+3                 cn=0,n=*X1
        86 003674   000005 000010 16                 ADSC9   LIST_STRING+5,Q          cn=0,n=*X0
        86 003675   000052 036000 4                  ADLQ    I
        86 003676   000154 116007                    CMPQ    108,DL
        86 003677   003712 603000 86                 TRC     s:7652
        86 003700   200031 756100                    STQ     COUNT1+3,,AUTO
        86 003701   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 003702   000022 772000                    QRL     18
        86 003703   000052 036000 4                  ADLQ    I
        86 003704   200031 722100                    LXL2    COUNT1+3,,AUTO
        86 003705   777623 622012                    EAX2    -109,X2
        86 003706   777777 662003                    ERX2    -1,DU
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:206  
        86 003707   040046 100400                    MLR     fill='040'O
        86 003710   001525 000002 12                 ADSC9   ONE_CHANGE+255           cn=0,n=2
        86 003711   000005 000012 16                 ADSC9   LIST_STRING+5,Q          cn=0,n=*X2

     1481     7651    5                          RC.RNAM,' ( NEE ',SUBSTR(TYPE_400.RECORD_NAME,0,I),' )');
     1482     7652    5                       END;

   7652 86 003712   003724 710000 86                 TRA     s:7657

     1483     7653    5                   ELSE DO;

     1484     7654    5                       CALL CONCAT(LIST_STRING,'RECORD-NAME: ',

   7654 86 003713   000000 470400 73                 LDP0    RC$
        86 003714   000000 720100                    LXL0    0,,PR0
        86 003715   000077 360003                    ANX0    63,DU
        86 003716   040000 100400                    MLR     fill='040'O
        86 003717   001517 000015 12                 ADSC9   ONE_CHANGE+249           cn=0,n=13
        86 003720   000000 000015 16                 ADSC9   LIST_STRING              cn=0,n=13
        86 003721   040000 100540                    MLR     fill='040'O
        86 003722   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        86 003723   000003 200163 16                 ADSC9   LIST_STRING+3            cn=1,n=115

     1485     7655    5                          RC.RNAM);
     1486     7656    5                       END;

     1487     7657    4                   CALL LIST(LIST_STRING);

   7657 86 003724   000022 630400 87                 EPPR0   18
        86 003725   000000 631400 87                 EPPR1   0
        86 003726   000000 701000 xent               TSX1    LIST
        86 003727   000000 011000                    NOP     0

     1488     7658    4                   FIRST_FIELD = '1'B;

   7658 86 003730   400000 236003                    LDQ     -131072,DU
        86 003731   000000 756000 25                 STQ     FIRST_FIELD
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:207  

     1489     7659    4                   END;

     1490     7660    3               LAST_RECORD_REF_LINE = CURRENT_RECORD;

   7660 86 003732   000000 235000 61                 LDA     CURRENT_RECORD
        86 003733   000000 755000 19                 STA     LAST_RECORD_REF_LINE

     1491     7661    3               IF SUB_LANGUAGE = #FORTRAN

   7661 86 003734   000000 236000 57                 LDQ     SUB_LANGUAGE
        86 003735   000002 116007                    CMPQ    2,DL
        86 003736   004277 601000 86                 TNZ     s:7729

     1492     7662    4               THEN DO;

     1493     7663    4                   CALL WRITE_RVA(2,RC.RCID);

   7663 86 003737   000000 236000 73                 LDQ     RC$
        86 003740   000101 036000 87                 ADLQ    65
        86 003741   200020 756100                    STQ     @TYPE+1,,AUTO
        86 003742   000102 236000 87                 LDQ     66
        86 003743   200017 756100                    STQ     LEN_UBIN+2,,AUTO
        86 003744   002476 701000 86                 TSX1    WRITE_RVA
        86 003745   000000 011000                    NOP     0

     1494     7664    4                   SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;

   7664 86 003746   000001 235000 46                 LDA     RVA_KEY+1
        86 003747   000165 755000 4                  STA     SAVE_LAST_RVA

     1495     7665    4                   RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;

   7665 86 003750   000000 236000 48                 LDQ     NEXT_RVA_SECOND_HALF
        86 003751   000001 756000 46                 STQ     RVA_KEY+1

     1496     7666    4                   CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-2);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:208  

   7666 86 003752   000002 135007                    SBLA    2,DL
        86 003753   200030 755100                    STA     COUNT1+2,,AUTO
        86 003754   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 003755   200033 450500                    STP0    COUNT1+5,,AUTO
        86 003756   000010 236000 87                 LDQ     8
        86 003757   200032 756100                    STQ     COUNT1+4,,AUTO
        86 003760   200032 630500                    EPPR0   COUNT1+4,,AUTO
        86 003761   000013 631400 87                 EPPR1   11
        86 003762   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 003763   000000 011000                    NOP     0

     1497     7667    4                   CALL CONCAT(LIST_STRING,'       EQUIVALENCE (',

   7667 86 003764   000000 470400 73                 LDP0    RC$
        86 003765   000000 720100                    LXL0    0,,PR0
        86 003766   000077 360003                    ANX0    63,DU
        86 003767   000000 236000 18                 LDQ     FIELD1
        86 003770   000033 772000                    QRL     27
        86 003771   040000 100400                    MLR     fill='040'O
        86 003772   001511 000024 12                 ADSC9   ONE_CHANGE+243           cn=0,n=20
        86 003773   000000 000024 16                 ADSC9   LIST_STRING              cn=0,n=20
        86 003774   040000 100540                    MLR     fill='040'O
        86 003775   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        86 003776   000005 000154 16                 ADSC9   LIST_STRING+5            cn=0,n=108
        86 003777   000000 621006                    EAX1    0,QL
        86 004000   000000 636010                    EAQ     0,X0
        86 004001   000022 772000                    QRL     18
        86 004002   000154 116007                    CMPQ    108,DL
        86 004003   004050 603000 86                 TRC     s:7670
        86 004004   200030 740100                    STX0    COUNT1+2,,AUTO
        86 004005   777623 620010                    EAX0    -109,X0
        86 004006   777777 660003                    ERX0    -1,DU
        86 004007   200030 235100                    LDA     COUNT1+2,,AUTO
        86 004010   000022 771000                    ARL     18
        86 004011   040045 100400                    MLR     fill='040'O
        86 004012   000162 000010 4                  ADSC9   RVA_NAME                 cn=0,n=8
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:209  
        86 004013   000005 000010 16                 ADSC9   LIST_STRING+5,A          cn=0,n=*X0
        86 004014   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 004015   000022 772000                    QRL     18
        86 004016   000144 116007                    CMPQ    100,DL
        86 004017   004050 603000 86                 TRC     s:7670
        86 004020   777633 620006                    EAX0    -101,QL
        86 004021   777777 660003                    ERX0    -1,DU
        86 004022   040046 100440                    MLR     fill='040'O
        86 004023   000000 200011 18                 ADSC9   FIELD1                   cn=1,n=*X1
        86 004024   000007 000010 16                 ADSC9   LIST_STRING+7,Q          cn=0,n=*X0
        86 004025   000000 635011                    EAA     0,X1
        86 004026   000022 771000                    ARL     18
        86 004027   200031 755100                    STA     COUNT1+3,,AUTO
        86 004030   200031 036100                    ADLQ    COUNT1+3,,AUTO
        86 004031   000144 116007                    CMPQ    100,DL
        86 004032   004050 603000 86                 TRC     s:7670
        86 004033   000000 635011                    EAA     0,X1
        86 004034   000022 771000                    ARL     18
        86 004035   200032 755100                    STA     COUNT1+4,,AUTO
        86 004036   200033 756100                    STQ     COUNT1+5,,AUTO
        86 004037   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 004040   000022 772000                    QRL     18
        86 004041   200032 036100                    ADLQ    COUNT1+4,,AUTO
        86 004042   200033 721100                    LXL1    COUNT1+5,,AUTO
        86 004043   777633 621011                    EAX1    -101,X1
        86 004044   777777 661003                    ERX1    -1,DU
        86 004045   040046 100400                    MLR     fill='040'O
        86 004046   001516 000002 12                 ADSC9   ONE_CHANGE+248           cn=0,n=2
        86 004047   000007 000011 16                 ADSC9   LIST_STRING+7,Q          cn=0,n=*X1

     1498     7668    4                      RC.RNAM,RVA_NAME,SUBSTR(FIELD1.TEXT1,0,
     1499     7669    4                      FIELD1.COUNT1),'))');
     1500     7670    4                   CALL JUST_WRITE_RVA;

   7670 86 004050   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 004051   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:210  
     1501     7671    4                   NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;

   7671 86 004052   000001 235000 46                 LDA     RVA_KEY+1
        86 004053   000000 755000 48                 STA     NEXT_RVA_SECOND_HALF

     1502     7672    4                   RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;

   7672 86 004054   000165 236000 4                  LDQ     SAVE_LAST_RVA
        86 004055   000001 756000 46                 STQ     RVA_KEY+1

     1503     7673    4                   IF TYPE_400.LAST_FILLER_LEN ~= 0

   7673 86 004056   000031 235000 62                 LDA     IO_BUF+25
        86 004057   004277 600000 86                 TZE     s:7729

     1504     7674    5                   THEN DO;

     1505     7675    5                       CALL CONCAT(LIST_STRING,'     +               ',

   7675 86 004060   040000 100400                    MLR     fill='040'O
        86 004061   001526 000025 12                 ADSC9   ONE_CHANGE+256           cn=0,n=21
        86 004062   000000 000025 16                 ADSC9   LIST_STRING              cn=0,n=21
        86 004063   040000 100400                    MLR     fill='040'O
        86 004064   000027 000010 62                 ADSC9   IO_BUF+23                cn=0,n=8
        86 004065   000005 200010 16                 ADSC9   LIST_STRING+5            cn=1,n=8
        86 004066   040000 100400                    MLR     fill='040'O
        86 004067   000027 000001 87                 ADSC9   23                       cn=0,n=1
        86 004070   000007 200143 16                 ADSC9   LIST_STRING+7            cn=1,n=99

     1506     7676    5                          TYPE_400.LAST_FILLER_TEXT,',');
     1507     7677    5                       CALL WRITE_UWA;

   7677 86 004071   002456 701000 86                 TSX1    WRITE_UWA
        86 004072   000000 011000                    NOP     0

     1508     7678    5                       SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:211  
   7678 86 004073   000001 235000 44                 LDA     UWA_KEY+1
        86 004074   000164 755000 4                  STA     SAVE_LAST_UWA

     1509     7679    5                       UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;

   7679 86 004075   000000 236000 45                 LDQ     NEXT_UWA_SECOND_HALF
        86 004076   000001 756000 44                 STQ     UWA_KEY+1

     1510     7680    5                       CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(

   7680 86 004077   040000 100400                    MLR     fill='040'O
        86 004100   001433 000007 12                 ADSC9   ONE_CHANGE+197           cn=0,n=7
        86 004101   000000 000007 16                 ADSC9   LIST_STRING              cn=0,n=7
        86 004102   040000 100400                    MLR     fill='040'O
        86 004103   000610 000024 12                 ADSC9   DATA_TYPE_NAME           cn=0,n=20
        86 004104   000001 600024 16                 ADSC9   LIST_STRING+1            cn=3,n=20
        86 004105   040000 100400                    MLR     fill='040'O
        86 004106   000027 000010 62                 ADSC9   IO_BUF+23                cn=0,n=8
        86 004107   000006 600145 16                 ADSC9   LIST_STRING+6            cn=3,n=101

     1511     7681    5                          0),TYPE_400.LAST_FILLER_TEXT);
     1512     7682    5                       CALL SET_FIELD_NUM(1,TYPE_400.LAST_FILLER_LEN);

   7682 86 004110   000103 630400 87                 EPPR0   67
        86 004111   000013 631400 87                 EPPR1   11
        86 004112   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 004113   000000 011000                    NOP     0

     1513     7683    5                       CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,

   7683 86 004114   000000 236000 18                 LDQ     FIELD1
        86 004115   000033 772000                    QRL     27
        86 004116   000000 620006                    EAX0    0,QL
        86 004117   000000 236000 18                 LDQ     FIELD1
        86 004120   000033 772000                    QRL     27
        86 004121   000001 621006                    EAX1    1,QL
        86 004122   040040 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:212  
        86 004123   000030 000001 87                 ADSC9   24                       cn=0,n=1
        86 004124   000004 000011 16                 ADSC9   LIST_STRING+4            cn=0,n=*X1
        86 004125   000000 636011                    EAQ     0,X1
        86 004126   000022 772000                    QRL     18
        86 004127   000002 116007                    CMPQ    2,DL
        86 004130   004135 602000 86                 TNC     s:7685
        86 004131   777777 622011                    EAX2    -1,X1
        86 004132   040040 100440                    MLR     fill='040'O
        86 004133   000000 200010 18                 ADSC9   FIELD1                   cn=1,n=*X0
        86 004134   000004 200012 16                 ADSC9   LIST_STRING+4            cn=1,n=*X2

     1514     7684    5                          '*',SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
     1515     7685    5                       CALL WRITE_UWA;

   7685 86 004135   002456 701000 86                 TSX1    WRITE_UWA
        86 004136   000000 011000                    NOP     0

     1516     7686    5                       NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;

   7686 86 004137   000001 235000 44                 LDA     UWA_KEY+1
        86 004140   000000 755000 45                 STA     NEXT_UWA_SECOND_HALF

     1517     7687    5                       UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;

   7687 86 004141   000164 236000 4                  LDQ     SAVE_LAST_UWA
        86 004142   000001 756000 44                 STQ     UWA_KEY+1

     1518     7688    5                       END;

     1519     7689    4                   END;

   7689 86 004143   004277 710000 86                 TRA     s:7729

     1520     7690    3           CASE (42);

     1521     7691        /*
     1522     7692              Area within clause in the subschema.
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:213  
     1523     7693        */
     1524     7694    3               IF RECORD_FOUND

   7694 86 004144   000000 234000 15                 SZN     RECORD_FOUND
        86 004145   004277 605000 86                 TPL     s:7729

     1525     7695    3               THEN CALL ZIG$V_AREA_REC;

   7695 86 004146   000005 631400 87                 EPPR1   5
        86 004147   000000 701000 xent               TSX1    ZIG$V_AREA_REC
        86 004150   000000 011000                    NOP     0
        86 004151   004277 710000 86                 TRA     s:7729

     1526     7696    3           CASE (43);

     1527     7697        /*
     1528     7698              Field that is under the current record in the schema.
     1529     7699        */
     1530     7700    3               IF RECORD_FOUND

   7700 86 004152   000000 234000 15                 SZN     RECORD_FOUND
        86 004153   004277 605000 86                 TPL     s:7729

     1531     7701    4               THEN DO;

     1532     7702    4                   CALL ZIG$V_FIELD;

   7702 86 004154   000005 631400 87                 EPPR1   5
        86 004155   000000 701000 xent               TSX1    ZIG$V_FIELD
        86 004156   000000 011000                    NOP     0

     1533     7703    4                   IF SUB_LANGUAGE = #FORTRAN

   7703 86 004157   000000 235000 57                 LDA     SUB_LANGUAGE
        86 004160   000002 115007                    CMPA    2,DL
        86 004161   004277 601000 86                 TNZ     s:7729

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:214  
     1534     7704    5                   THEN DO;

     1535     7705    5                       CALL INDEX1(I,' ',TYPE_430.SUB_FIELD_NAME);

   7705 86 004162   000000 124400                    SCM     mask='000'O
        86 004163   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30
        86 004164   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 004165   000052 000000 4                  ARG     I

     1536     7706    5                       CALL CONCAT(LIST_STRING,'     +               ',

   7706 86 004166   040000 100400                    MLR     fill='040'O
        86 004167   001526 000025 12                 ADSC9   ONE_CHANGE+256           cn=0,n=21
        86 004170   000000 000025 16                 ADSC9   LIST_STRING              cn=0,n=21
        86 004171   000052 720000 4                  LXL0    I
        86 004172   000001 621010                    EAX1    1,X0
        86 004173   040000 100440                    MLR     fill='040'O
        86 004174   000013 000011 62                 ADSC9   IO_BUF+11                cn=0,n=*X1
        86 004175   000005 200153 16                 ADSC9   LIST_STRING+5            cn=1,n=107
        86 004176   000052 236000 4                  LDQ     I
        86 004177   000152 116007                    CMPQ    106,DL
        86 004200   004206 603000 86                 TRC     s:7708
        86 004201   777625 622006                    EAX2    -107,QL
        86 004202   777777 662003                    ERX2    -1,DU
        86 004203   040046 100400                    MLR     fill='040'O
        86 004204   000027 000001 87                 ADSC9   23                       cn=0,n=1
        86 004205   000005 400012 16                 ADSC9   LIST_STRING+5,Q          cn=2,n=*X2

     1537     7707    5                          SUBSTR(TYPE_430.SUB_FIELD_NAME,0,I+1),',');
     1538     7708    5                       CALL WRITE_UWA;

   7708 86 004206   002456 701000 86                 TSX1    WRITE_UWA
        86 004207   000000 011000                    NOP     0

     1539     7709    5                       SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;

   7709 86 004210   000001 235000 44                 LDA     UWA_KEY+1
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:215  
        86 004211   000164 755000 4                  STA     SAVE_LAST_UWA

     1540     7710    5                       UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;

   7710 86 004212   000000 236000 45                 LDQ     NEXT_UWA_SECOND_HALF
        86 004213   000001 756000 44                 STQ     UWA_KEY+1

     1541     7711    5                       CALL CONCAT(LIST_STRING,'       ',DATA_TYPE_NAME(

   7711 86 004214   040000 100400                    MLR     fill='040'O
        86 004215   001433 000007 12                 ADSC9   ONE_CHANGE+197           cn=0,n=7
        86 004216   000000 000007 16                 ADSC9   LIST_STRING              cn=0,n=7
        86 004217   000024 236000 62                 LDQ     IO_BUF+20
        86 004220   000024 402007                    MPY     20,DL
        86 004221   040000 100406                    MLR     fill='040'O
        86 004222   000610 000024 12                 ADSC9   DATA_TYPE_NAME,Q         cn=0,n=20
        86 004223   000001 600024 16                 ADSC9   LIST_STRING+1            cn=3,n=20
        86 004224   040000 100400                    MLR     fill='040'O
        86 004225   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30
        86 004226   000006 600145 16                 ADSC9   LIST_STRING+6            cn=3,n=101

     1542     7712    5                          TYPE_430.DATA_TYPE),TYPE_430.SUB_FIELD_NAME);
     1543     7713    5                       IF TYPE_430.DATA_TYPE = 0

   7713 86 004227   000024 235000 62                 LDA     IO_BUF+20
        86 004230   004256 601000 86                 TNZ     s:7719

     1544     7714    6                       THEN DO;

     1545     7715    6                           CALL SET_FIELD_NUM(1,TYPE_430.LEN_FIELD);

   7715 86 004231   000036 630400 87                 EPPR0   30
        86 004232   000013 631400 87                 EPPR1   11
        86 004233   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 004234   000000 011000                    NOP     0

     1546     7716    6                           CALL INSERT(LIST_STRING,16,1+FIELD1.COUNT1,
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:216  

   7716 86 004235   000000 236000 18                 LDQ     FIELD1
        86 004236   000033 772000                    QRL     27
        86 004237   000000 620006                    EAX0    0,QL
        86 004240   000000 236000 18                 LDQ     FIELD1
        86 004241   000033 772000                    QRL     27
        86 004242   000001 621006                    EAX1    1,QL
        86 004243   040040 100400                    MLR     fill='040'O
        86 004244   000030 000001 87                 ADSC9   24                       cn=0,n=1
        86 004245   000004 000011 16                 ADSC9   LIST_STRING+4            cn=0,n=*X1
        86 004246   000000 636011                    EAQ     0,X1
        86 004247   000022 772000                    QRL     18
        86 004250   000002 116007                    CMPQ    2,DL
        86 004251   004256 602000 86                 TNC     s:7719
        86 004252   777777 622011                    EAX2    -1,X1
        86 004253   040040 100440                    MLR     fill='040'O
        86 004254   000000 200010 18                 ADSC9   FIELD1                   cn=1,n=*X0
        86 004255   000004 200012 16                 ADSC9   LIST_STRING+4            cn=1,n=*X2

     1547     7717    6                              '*',SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
     1548     7718    6                           END;

     1549     7719    5                       CALL WRITE_UWA;

   7719 86 004256   002456 701000 86                 TSX1    WRITE_UWA
        86 004257   000000 011000                    NOP     0

     1550     7720    5                       NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;

   7720 86 004260   000001 235000 44                 LDA     UWA_KEY+1
        86 004261   000000 755000 45                 STA     NEXT_UWA_SECOND_HALF

     1551     7721    5                       UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;

   7721 86 004262   000164 236000 4                  LDQ     SAVE_LAST_UWA
        86 004263   000001 756000 44                 STQ     UWA_KEY+1

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:217  
     1552     7722    5                       IF TYPE_430.FLAGS.TYPE = '000000010000'B

   7722 86 004264   000032 236000 62                 LDQ     IO_BUF+26
        86 004265   777700 376003                    ANQ     -64,DU
        86 004266   002000 116003                    CMPQ    1024,DU
        86 004267   004277 601000 86                 TNZ     s:7729

     1553     7723    6                       THEN DO;

     1554     7724    6                           CALL WRITE_RVA(3,FR.UOFST.EIS.FRID);

   7724 86 004270   000000 236000 69                 LDQ     FR$
        86 004271   000041 036000 87                 ADLQ    33
        86 004272   200020 756100                    STQ     @TYPE+1,,AUTO
        86 004273   000042 236000 87                 LDQ     34
        86 004274   200017 756100                    STQ     LEN_UBIN+2,,AUTO
        86 004275   002476 701000 86                 TSX1    WRITE_RVA
        86 004276   000000 011000                    NOP     0

     1555     7725    6                           END;

     1556     7726    5                       END;

     1557     7727    4                   END;

     1558     7728    3               END;

     1559     7729    2           CURRENT_RECORD = CURRENT_RECORD + 1;

   7729 86 004277   000000 235000 61                 LDA     CURRENT_RECORD
        86 004300   000001 035007                    ADLA    1,DL
        86 004301   000000 755000 61                 STA     CURRENT_RECORD

     1560     7730    2           CALL READSF(CURRENT_RECORD,IO_BUF);

   7730 86 004302   000071 630400 87                 EPPR0   57
        86 004303   000013 631400 87                 EPPR1   11
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:218  
        86 004304   000000 701000 xent               TSX1    READSF
        86 004305   000000 011000                    NOP     0

     1561     7731    2           END;

   7731 86 004306   040000 106400                    CMPC    fill='040'O
        86 004307   000000 000014 62                 ADSC9   IO_BUF                   cn=0,n=12
        86 004310   000000 000014 9                  ADSC9   EOFC                     cn=0,n=12
        86 004311   004314 600000 86                 TZE     s:7732
        86 004312   000000 235000 17                 LDA     ERROR_READ64
        86 004313   003226 600000 86                 TZE     s:7565

     1562     7732    1       IF ERROR_READ64 = 1

   7732 86 004314   000000 235000 17                 LDA     ERROR_READ64
        86 004315   000001 115007                    CMPA    1,DL
        86 004316   004326 601000 86                 TNZ     s:7747

     1563     7733    2       THEN DO;

     1564     7734    2           CALL ERROR(%ZIG_V_BAD_SUBSCHEMA_FILE);

   7734 86 004317   000106 630400 87                 EPPR0   70
        86 004320   000000 631400 87                 EPPR1   0
        86 004321   000000 701000 xent               TSX1    ERROR
        86 004322   000000 011000                    NOP     0

     1565     7735        /*E*     ERROR:    ZIG-ZIG_V_BAD_SUBSCHEMA_FILE-C
     1566     7736        MESSAGE: The subschema file is not in the correct format.
     1567     7737                 One of the following must have happened:
     1568     7738                 1 -  The subschema translation aborted so rerun the subschema
     1569     7739                    translation.
     1570     7740                 2 -  The subschema was edited and some internal record(s) deleted
     1571     7741                    so retranslate the subschema and try again.
     1572     7742                 3 -  Internal error. The translator and the validator have
     1573     7743                    problems. Report via Starlog.
     1574     7744        */
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:219  
     1575     7745    2           CALL ABORT;

   7745 86 004323   000005 631400 87                 EPPR1   5
        86 004324   000000 701000 xent               TSX1    ABORT
        86 004325   000000 011000                    NOP     0

     1576     7746    2           END;

     1577     7747    1       IF LAST_RC ~= 1 AND RECORD_FOUND

   7747 86 004326   000000 220000 7                  LDX0    LAST_RC
        86 004327   000001 100003                    CMPX0   1,DU
        86 004330   004335 600000 86                 TZE     s:7760
        86 004331   000000 234000 15                 SZN     RECORD_FOUND
        86 004332   004335 605000 86                 TPL     s:7760

     1578     7748    2       THEN DO;

     1579     7749        /*
     1580     7750              Now check the last record to see if all the item
     1581     7751            have been given and what can be done to this record.
     1582     7752        */
     1583     7753    2           CALL ZIG$V_CHECK_F;

   7753 86 004333   000003 701000 86                 TSX1    ZIG$V_CHECK_F
        86 004334   000000 011000                    NOP     0

     1584     7754    2           END;

     1585     7755        /*
     1586     7756              Now put in the *SYSTEM record and the *DBPARAM record into
     1587     7757            the schema subset and write the things out to the UWA and RVA
     1588     7758            section if FORTRAN.
     1589     7759        */
     1590     7760    1       LAST_RECORD_REF_LINE = 0;

   7760 86 004335   000000 450000 19                 STZ     LAST_RECORD_REF_LINE
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:220  

     1591     7761    1       CALL ZIG$ZERO_ALT_TABLE;

   7761 86 004336   000005 631400 87                 EPPR1   5
        86 004337   000000 701000 xent               TSX1    ZIG$ZERO_ALT_TABLE
        86 004340   000000 011000                    NOP     0

     1592     7762        /*W*
     1593     7763            VALIDS.RECORD_XREF is now set off because all the record
     1594     7764            information has been put out and if it isn't the ZIG$V_CHECK_F
     1595     7765            will put out information that is useless.
     1596     7766        */
     1597     7767    1       VALIDS.RECORD_XREF = '0'B;

   7767 86 004341   000107 236000 87                 LDQ     71
        86 004342   000000 356000 31                 ANSQ    VALIDS

     1598     7768    1       CALL ADD_SPECIAL_REC;

   7768 86 004343   000711 701000 86                 TSX1    ADD_SPECIAL_REC
        86 004344   000000 011000                    NOP     0

     1599     7769
     1600     7770        /*
     1601     7771              Now go throw all the sets in the subschema and put in all
     1602     7772            the required records for that set. Also all the fields for that
     1603     7773            record must be added.
     1604     7774        */
     1605     7775    1       IF FIRST_SET AND VALIDS.SET_XREF

   7775 86 004345   200004 234100                    SZN     FIRST_SET,,AUTO
        86 004346   004357 605000 86                 TPL     s:7780
        86 004347   000000 236000 31                 LDQ     VALIDS
        86 004350   000004 316003                    CANQ    4,DU
        86 004351   004357 600000 86                 TZE     s:7780

     1606     7776    2       THEN DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:221  

     1607     7777    2           CALL SUBLST(HEAD_SET_XREF);

   7777 86 004352   000110 630400 87                 EPPR0   72
        86 004353   000000 631400 87                 EPPR1   0
        86 004354   000000 701000 xent               TSX1    SUBLST
        86 004355   000000 011000                    NOP     0

     1608     7778    2           FIRST_SET = '0'B;

   7778 86 004356   200004 450100                    STZ     FIRST_SET,,AUTO

     1609     7779    2           END;

     1610     7780    1       LAST_SC_SAVE= OA.OASCN;

   7780 86 004357   000000 470400 75                 LDP0    OA$
        86 004360   000001 236100                    LDQ     1,,PR0
        86 004361   777777 376007                    ANQ     -1,DL
        86 004362   000066 756000 4                  STQ     LAST_SC_SAVE

     1611     7781    2       DO WHILE (LAST_SC_SAVE ~= 0);

   7781 86 004363   005340 600000 86                 TZE     s:7947

     1612     7782    2           SC$ = PINCRW(SSS$,LAST_SC_SAVE);

   7782 86 004364   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 004365   000022 736000                    QLS     18
        86 004366   000000 036000 66                 ADLQ    SSS$
        86 004367   000000 756000 71                 STQ     SC$

     1613     7783    2           SC1$ = PINCRW(SSS$,LAST_SC_SAVE - 2);

   7783 86 004370   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 004371   000022 736000                    QLS     18
        86 004372   000002 136003                    SBLQ    2,DU
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:222  
        86 004373   000000 036000 66                 ADLQ    SSS$
        86 004374   000000 756000 72                 STQ     SC1$

     1614     7784    2           IF VALIDS.SET_XREF AND ~SC.DEF.SNSS AND SC.DEF.SETT ~= 2 AND

   7784 86 004375   000000 236000 31                 LDQ     VALIDS
        86 004376   000004 316003                    CANQ    4,DU
        86 004377   005057 600000 86                 TZE     s:7877
        86 004400   000000 470400 71                 LDP0    SC$
        86 004401   000000 236100                    LDQ     0,,PR0
        86 004402   000026 736000                    QLS     22
        86 004403   400000 376003                    ANQ     -131072,DU
        86 004404   400000 676003                    ERQ     -131072,DU
        86 004405   005057 600000 86                 TZE     s:7877
        86 004406   000000 236100                    LDQ     0,,PR0
        86 004407   000700 376007                    ANQ     448,DL
        86 004410   000200 116007                    CMPQ    128,DL
        86 004411   005057 600000 86                 TZE     s:7877
        86 004412   000300 116007                    CMPQ    192,DL
        86 004413   005057 600000 86                 TZE     s:7877

     1615     7785    2              SC.DEF.SETT ~= 3
     1616     7786    3           THEN DO;

     1617     7787    3               RS$ = PINCRW(SSS$,SC.SCRSN);

   7787 86 004414   000002 220100                    LDX0    2,,PR0
        86 004415   000000 636010                    EAQ     0,X0
        86 004416   000000 036000 66                 ADLQ    SSS$
        86 004417   000000 756000 78                 STQ     RS$

     1618     7788    3               RS$ = PINCRW(SSS$,RS.SCRSN);

   7788 86 004420   000000 471400 78                 LDP1    RS$
        86 004421   100002 221100                    LDX1    2,,PR1
        86 004422   000000 636011                    EAQ     0,X1
        86 004423   000000 036000 66                 ADLQ    SSS$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:223  
        86 004424   000000 756000 78                 STQ     RS$

     1619     7789        /*
     1620     7790                   Get a set member.
     1621     7791        */
     1622     7792    3               LIST_STRING = ' ';

   7792 86 004425   040000 100400                    MLR     fill='040'O
        86 004426   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 004427   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1623     7793    3               CALL LIST(LIST_STRING);

   7793 86 004430   000022 630400 87                 EPPR0   18
        86 004431   000000 631400 87                 EPPR1   0
        86 004432   000000 701000 xent               TSX1    LIST
        86 004433   000000 011000                    NOP     0

     1624     7794    3               CALL CONCAT(LIST_STRING,'     SET NAME IS ',SC.SNAM);

   7794 86 004434   000000 470400 71                 LDP0    SC$
        86 004435   000000 720100                    LXL0    0,,PR0
        86 004436   000077 360003                    ANX0    63,DU
        86 004437   040000 100400                    MLR     fill='040'O
        86 004440   001534 000021 12                 ADSC9   ONE_CHANGE+262           cn=0,n=17
        86 004441   000000 000021 16                 ADSC9   LIST_STRING              cn=0,n=17
        86 004442   040000 100540                    MLR     fill='040'O
        86 004443   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        86 004444   000004 200157 16                 ADSC9   LIST_STRING+4            cn=1,n=111

     1625     7795    3               CALL LIST(LIST_STRING);

   7795 86 004445   000022 630400 87                 EPPR0   18
        86 004446   000000 631400 87                 EPPR1   0
        86 004447   000000 701000 xent               TSX1    LIST
        86 004450   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:224  
     1626     7796    3               LIST_STRING = '          SET IS PRIOR PROCESSABLE';

   7796 86 004451   040000 100400                    MLR     fill='040'O
        86 004452   001541 000042 12                 ADSC9   ONE_CHANGE+267           cn=0,n=34
        86 004453   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1627     7797    3               CALL LIST(LIST_STRING);

   7797 86 004454   000022 630400 87                 EPPR0   18
        86 004455   000000 631400 87                 EPPR1   0
        86 004456   000000 701000 xent               TSX1    LIST
        86 004457   000000 011000                    NOP     0

     1628     7798    3               LIST_STRING = '          ORDER IS PERMANENT';

   7798 86 004460   040000 100400                    MLR     fill='040'O
        86 004461   001552 000034 12                 ADSC9   ONE_CHANGE+276           cn=0,n=28
        86 004462   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1629     7799    3               CALL LIST(LIST_STRING);

   7799 86 004463   000022 630400 87                 EPPR0   18
        86 004464   000000 631400 87                 EPPR1   0
        86 004465   000000 701000 xent               TSX1    LIST
        86 004466   000000 011000                    NOP     0

     1630     7800    3               CALL CONCAT(LIST_STRING,'          IMPLEMENTATION MODE IS ',

   7800 86 004467   000000 470400 71                 LDP0    SC$
        86 004470   000000 236100                    LDQ     0,,PR0
        86 004471   000025 772000                    QRL     21
        86 004472   000007 376007                    ANQ     7,DL
        86 004473   000015 402007                    MPY     13,DL
        86 004474   040000 100400                    MLR     fill='040'O
        86 004475   001561 000041 12                 ADSC9   ONE_CHANGE+283           cn=0,n=33
        86 004476   000000 000041 16                 ADSC9   LIST_STRING              cn=0,n=33
        86 004477   040000 100406                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:225  
        86 004500   000512 000015 12                 ADSC9   MODE_OF_SET,Q            cn=0,n=13
        86 004501   000010 200137 16                 ADSC9   LIST_STRING+8            cn=1,n=95

     1631     7801    3                  MODE_OF_SET(SC.DEF.SETM));
     1632     7802    3               CALL LIST(LIST_STRING);

   7802 86 004502   000022 630400 87                 EPPR0   18
        86 004503   000000 631400 87                 EPPR1   0
        86 004504   000000 701000 xent               TSX1    LIST
        86 004505   000000 011000                    NOP     0

     1633     7803    3               IF SC.DEF.SETO = 4

   7803 86 004506   000000 470400 71                 LDP0    SC$
        86 004507   000000 236100                    LDQ     0,,PR0
        86 004510   740000 376007                    ANQ     -16384,DL
        86 004511   200000 116007                    CMPQ    65536,DL
        86 004512   004543 601000 86                 TNZ     s:7812

     1634     7804    4               THEN DO;

     1635     7805    4                   LIST_STRING='          INSERTION IS SORTED BY DEFINED KEYS';

   7805 86 004513   040000 100400                    MLR     fill='040'O
        86 004514   001572 000055 12                 ADSC9   ONE_CHANGE+292           cn=0,n=45
        86 004515   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1636     7806    4                   CALL LIST(LIST_STRING);

   7806 86 004516   000022 630400 87                 EPPR0   18
        86 004517   000000 631400 87                 EPPR1   0
        86 004520   000000 701000 xent               TSX1    LIST
        86 004521   000000 011000                    NOP     0

     1637     7807    4                   CALL CONCAT(LIST_STRING,'               DUPLICATES ARE ',

   7807 86 004522   000000 470400 78                 LDP0    RS$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:226  
        86 004523   000000 236100                    LDQ     0,,PR0
        86 004524   000020 772000                    QRL     16
        86 004525   000003 376007                    ANQ     3,DL
        86 004526   000003 402007                    MPY     3,DL
        86 004527   040000 100400                    MLR     fill='040'O
        86 004530   001606 000036 12                 ADSC9   ONE_CHANGE+304           cn=0,n=30
        86 004531   000000 000036 16                 ADSC9   LIST_STRING              cn=0,n=30
        86 004532   000002 736000                    QLS     2
        86 004533   040000 100406                    MLR     fill='040'O
        86 004534   000501 000014 12                 ADSC9   DUP_TEXT,Q               cn=0,n=12
        86 004535   000007 400142 16                 ADSC9   LIST_STRING+7            cn=2,n=98

     1638     7808    4                      DUP_TEXT(RS.DEF.DORD));
     1639     7809    4                   CALL LIST(LIST_STRING);

   7809 86 004536   000022 630400 87                 EPPR0   18
        86 004537   000000 631400 87                 EPPR1   0
        86 004540   000000 701000 xent               TSX1    LIST
        86 004541   000000 011000                    NOP     0

     1640     7810    4                   END;

   7810 86 004542   004562 710000 86                 TRA     s:7816

     1641     7811    4               ELSE DO;

     1642     7812    4                   CALL CONCAT(LIST_STRING,'          INSERTION IS ',

   7812 86 004543   000000 236100                    LDQ     0,,PR0
        86 004544   000016 772000                    QRL     14
        86 004545   000017 376007                    ANQ     15,DL
        86 004546   000007 402007                    MPY     7,DL
        86 004547   040000 100400                    MLR     fill='040'O
        86 004550   001572 000027 12                 ADSC9   ONE_CHANGE+292           cn=0,n=23
        86 004551   000000 000027 16                 ADSC9   LIST_STRING              cn=0,n=23
        86 004552   000002 736000                    QLS     2
        86 004553   040000 100406                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:227  
        86 004554   000411 000034 12                 ADSC9   SET_ORDER,Q              cn=0,n=28
        86 004555   000005 600151 16                 ADSC9   LIST_STRING+5            cn=3,n=105

     1643     7813    4                      SET_ORDER(SC.DEF.SETO));
     1644     7814    4                   CALL LIST(LIST_STRING);

   7814 86 004556   000022 630400 87                 EPPR0   18
        86 004557   000000 631400 87                 EPPR1   0
        86 004560   000000 701000 xent               TSX1    LIST
        86 004561   000000 011000                    NOP     0

     1645     7815    4                   END;

     1646     7816    3               T2PTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;

   7816 86 004562   000000 470400 72                 LDP0    SC1$
        86 004563   000001 236100                    LDQ     1,,PR0
        86 004564   000063 756000 4                  STQ     T2PTR$

     1647     7817    3               T7PTR$ = PINCRW(SSS$,T2PTR$ -> SET_HASH.SO.OFFSET);

   7817 86 004565   000063 471400 4                  LDP1    T2PTR$
        86 004566   100014 720100                    LXL0    12,,PR1
        86 004567   377777 360003                    ANX0    131071,DU
        86 004570   000000 636010                    EAQ     0,X0
        86 004571   000000 036000 66                 ADLQ    SSS$
        86 004572   000074 756000 4                  STQ     T7PTR$

     1648     7818    3               T8PTR$ = PINCRW(SSS$,T7PTR$ -> RS.RCRSH);

   7818 86 004573   000074 473400 4                  LDP3    T7PTR$
        86 004574   300003 221100                    LDX1    3,,PR3
        86 004575   000000 636011                    EAQ     0,X1
        86 004576   000000 036000 66                 ADLQ    SSS$
        86 004577   000075 756000 4                  STQ     T8PTR$

     1649     7819    3               IF ~T8PTR$ -> RC.DEF.SR AND T8PTR$ ~= SSS$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:228  

   7819 86 004600   000075 474400 4                  LDP4    T8PTR$
        86 004601   400000 236100                    LDQ     0,,PR4
        86 004602   000024 736000                    QLS     20
        86 004603   400000 376003                    ANQ     -131072,DU
        86 004604   400000 676003                    ERQ     -131072,DU
        86 004605   004622 600000 86                 TZE     s:7822
        86 004606   000075 236000 4                  LDQ     T8PTR$
        86 004607   000000 116000 66                 CMPQ    SSS$
        86 004610   004622 600000 86                 TZE     s:7822

     1650     7820    3               THEN CALL CONCAT(LIST_STRING,'          SET OWNER IS ',

   7820 86 004611   400000 722100                    LXL2    0,,PR4
        86 004612   000077 362003                    ANX2    63,DU
        86 004613   040000 100400                    MLR     fill='040'O
        86 004614   001616 000027 12                 ADSC9   ONE_CHANGE+312           cn=0,n=23
        86 004615   000000 000027 16                 ADSC9   LIST_STRING              cn=0,n=23
        86 004616   040000 100540                    MLR     fill='040'O
        86 004617   400005 000012                    ADSC9   5,,PR4                   cn=0,n=*X2
        86 004620   000005 600151 16                 ADSC9   LIST_STRING+5            cn=3,n=105
        86 004621   004625 710000 86                 TRA     s:7823

     1651     7821    3                      T8PTR$ -> RC.RNAM);
     1652     7822    3               ELSE LIST_STRING = '          OWNER IS NOT PRESENT IN SUBSCHEMA';

   7822 86 004622   040000 100400                    MLR     fill='040'O
        86 004623   001624 000053 12                 ADSC9   ONE_CHANGE+318           cn=0,n=43
        86 004624   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1653     7823    3               CALL LIST(LIST_STRING);

   7823 86 004625   000022 630400 87                 EPPR0   18
        86 004626   000000 631400 87                 EPPR1   0
        86 004627   000000 701000 xent               TSX1    LIST
        86 004630   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:229  
     1654     7824    3               NO_MEMBERS_IN_SUBSCHEMA = '1'B;

   7824 86 004631   400000 236003                    LDQ     -131072,DU
        86 004632   200007 756100                    STQ     NO_MEMBERS_IN_SUBSCHEMA,,AUTO

     1655     7825    4               DO I = 0 TO T2PTR$ -> SET_HASH.NUM_SM - 1;

   7825 86 004633   000052 450000 4                  STZ     I
        86 004634   005042 710000 86                 TRA     s:7870+3

     1656     7826    4                   T7PTR$ = PINCRW(SSS$,T2PTR$ -> SET_HASH.SM_LIST.OFFSET(I));

   7826 86 004635   000063 470400 4                  LDP0    T2PTR$
        86 004636   000052 720000 4                  LXL0    I
        86 004637   000016 721110                    LXL1    14,X0,PR0
        86 004640   377777 361003                    ANX1    131071,DU
        86 004641   000000 636011                    EAQ     0,X1
        86 004642   000000 036000 66                 ADLQ    SSS$
        86 004643   000074 756000 4                  STQ     T7PTR$

     1657     7827    4                   T8PTR$ = PINCRW(SSS$,T7PTR$ -> RS.RCRSH);

   7827 86 004644   000074 471400 4                  LDP1    T7PTR$
        86 004645   100003 222100                    LDX2    3,,PR1
        86 004646   000000 636012                    EAQ     0,X2
        86 004647   000000 036000 66                 ADLQ    SSS$
        86 004650   000075 756000 4                  STQ     T8PTR$

     1658     7828    4                   IF ~T8PTR$ -> RC.DEF.SR AND SSS$ ~= T8PTR$

   7828 86 004651   000075 473400 4                  LDP3    T8PTR$
        86 004652   300000 236100                    LDQ     0,,PR3
        86 004653   000024 736000                    QLS     20
        86 004654   400000 376003                    ANQ     -131072,DU
        86 004655   400000 676003                    ERQ     -131072,DU
        86 004656   005037 600000 86                 TZE     s:7870
        86 004657   000000 236000 66                 LDQ     SSS$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:230  
        86 004660   000075 116000 4                  CMPQ    T8PTR$
        86 004661   005037 600000 86                 TZE     s:7870

     1659     7829    5                   THEN DO;

     1660     7830    5                       NO_MEMBERS_IN_SUBSCHEMA = '0'B;

   7830 86 004662   200007 450100                    STZ     NO_MEMBERS_IN_SUBSCHEMA,,AUTO

     1661     7831    5                       CALL CONCAT(LIST_STRING,'          MEMBER IS ',

   7831 86 004663   300000 723100                    LXL3    0,,PR3
        86 004664   000077 363003                    ANX3    63,DU
        86 004665   040000 100400                    MLR     fill='040'O
        86 004666   001637 000024 12                 ADSC9   ONE_CHANGE+329           cn=0,n=20
        86 004667   000000 000024 16                 ADSC9   LIST_STRING              cn=0,n=20
        86 004670   040000 100540                    MLR     fill='040'O
        86 004671   300005 000013                    ADSC9   5,,PR3                   cn=0,n=*X3
        86 004672   000005 000154 16                 ADSC9   LIST_STRING+5            cn=0,n=108

     1662     7832    5                          T8PTR$ -> RC.RNAM);
     1663     7833    5                       CALL LIST(LIST_STRING);

   7833 86 004673   000022 630400 87                 EPPR0   18
        86 004674   000000 631400 87                 EPPR1   0
        86 004675   000000 701000 xent               TSX1    LIST
        86 004676   000000 011000                    NOP     0

     1664     7834    5                       IF T7PTR$ -> RS.DEF.OSM

   7834 86 004677   000074 470400 4                  LDP0    T7PTR$
        86 004700   000000 236100                    LDQ     0,,PR0
        86 004701   100000 316007                    CANQ    32768,DL
        86 004702   004706 600000 86                 TZE     s:7836

     1665     7835    5                       THEN K = 2;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:231  
   7835 86 004703   000002 235007                    LDA     2,DL
        86 004704   000077 755000 4                  STA     K
        86 004705   004707 710000 86                 TRA     s:7837

     1666     7836    5                       ELSE K = 0;

   7836 86 004706   000077 450000 4                  STZ     K

     1667     7837    5                       IF T7PTR$ -> RS.DEF.MSM

   7837 86 004707   000000 236100                    LDQ     0,,PR0
        86 004710   040000 316007                    CANQ    16384,DL
        86 004711   004715 600000 86                 TZE     s:7839

     1668     7838    5                       THEN K = K + 1;

   7838 86 004712   000077 235000 4                  LDA     K
        86 004713   000001 035007                    ADLA    1,DL
        86 004714   000077 755000 4                  STA     K

     1669     7839    5                       LIST_STRING = MAN_OPT(K);

   7839 86 004715   000077 236000 4                  LDQ     K
        86 004716   000064 402007                    MPY     52,DL
        86 004717   040000 100406                    MLR     fill='040'O
        86 004720   000524 000064 12                 ADSC9   MAN_OPT,Q                cn=0,n=52
        86 004721   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1670     7840    5                       CALL LIST(LIST_STRING);

   7840 86 004722   000022 630400 87                 EPPR0   18
        86 004723   000000 631400 87                 EPPR1   0
        86 004724   000000 701000 xent               TSX1    LIST
        86 004725   000000 011000                    NOP     0

     1671     7841    5                       IF SC.DEF.SETO = 4 OR SC.DEF.SETO = 6

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:232  
   7841 86 004726   000000 470400 71                 LDP0    SC$
        86 004727   000000 236100                    LDQ     0,,PR0
        86 004730   740000 376007                    ANQ     -16384,DL
        86 004731   200000 116007                    CMPQ    65536,DL
        86 004732   004735 600000 86                 TZE     s:7843
        86 004733   300000 116007                    CMPQ    98304,DL
        86 004734   005037 601000 86                 TNZ     s:7870

     1672     7842    6                       THEN DO;

     1673     7843    6                           T8PTR$ = PINCRW(SSS$,T7PTR$ -> RS.RSCDN);

   7843 86 004735   000074 471400 4                  LDP1    T7PTR$
        86 004736   100001 220100                    LDX0    1,,PR1
        86 004737   000000 636010                    EAQ     0,X0
        86 004740   000000 036000 66                 ADLQ    SSS$
        86 004741   000075 756000 4                  STQ     T8PTR$

     1674     7844    7                           DO WHILE (T8PTR$ ~= SSS$);

   7844 86 004742   000000 116000 66                 CMPQ    SSS$
        86 004743   005037 600000 86                 TZE     s:7870

     1675     7845    7                               T9PTR$ = PINCRW(SSS$,T8PTR$ -> CD.CDSH);

   7845 86 004744   000075 470400 4                  LDP0    T8PTR$
        86 004745   000002 220100                    LDX0    2,,PR0
        86 004746   000000 636010                    EAQ     0,X0
        86 004747   000000 036000 66                 ADLQ    SSS$
        86 004750   000076 756000 4                  STQ     T9PTR$

     1676     7846    7                               IF T9PTR$ ~= SSS$

   7846 86 004751   000000 116000 66                 CMPQ    SSS$
        86 004752   005030 600000 86                 TZE     s:7866

     1677     7847    8                               THEN DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:233  

     1678     7848    8                                   IF T9PTR$ -> FR.FNL = 0

   7848 86 004753   000076 471400 4                  LDP1    T9PTR$
        86 004754   100004 236100                    LDQ     4,,PR1
        86 004755   000077 316003                    CANQ    63,DU
        86 004756   004776 601000 86                 TNZ     s:7856

     1679     7849    9                                   THEN DO;

     1680     7850    9                                       T9PTR$ = PINCRW(T9PTR$,-1);

   7850 86 004757   000076 236000 4                  LDQ     T9PTR$
        86 004760   777777 036003                    ADLQ    -1,DU
        86 004761   000076 756000 4                  STQ     T9PTR$

     1681     7851    9                                       K = T9PTR$ -> FR1.NLIND;

   7851 86 004762   000076 471400 4                  LDP1    T9PTR$
        86 004763   100000 236100                    LDQ     0,,PR1
        86 004764   777777 376007                    ANQ     -1,DL
        86 004765   000077 756000 4                  STQ     K

     1682     7852    9                                       CALL READSF(K,IO_BUF);

   7852 86 004766   000111 630400 87                 EPPR0   73
        86 004767   000013 631400 87                 EPPR1   11
        86 004770   000000 701000 xent               TSX1    READSF
        86 004771   000000 011000                    NOP     0

     1683     7853    9                                       FIELD_NAME = TYPE_430.SUB_FIELD_NAME;

   7853 86 004772   040000 100400                    MLR     fill='040'O
        86 004773   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30
        86 004774   000100 000036 4                  ADSC9   FIELD_NAME               cn=0,n=30

     1684     7854    9                                       END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:234  

   7854 86 004775   005003 710000 86                 TRA     s:7858

     1685     7855    9                                   ELSE DO;

     1686     7856    9                                       FIELD_NAME = T9PTR$ -> FR.FNAM;

   7856 86 004776   100004 220100                    LDX0    4,,PR1
        86 004777   000077 360003                    ANX0    63,DU
        86 005000   040000 100540                    MLR     fill='040'O
        86 005001   100006 000010                    ADSC9   6,,PR1                   cn=0,n=*X0
        86 005002   000100 000036 4                  ADSC9   FIELD_NAME               cn=0,n=30

     1687     7857    9                                       END;

     1688     7858    8                                   IF T8PTR$ -> CD.DEF.CONT

   7858 86 005003   000075 470400 4                  LDP0    T8PTR$
        86 005004   000000 236100                    LDQ     0,,PR0
        86 005005   000020 316003                    CANQ    16,DU
        86 005006   005016 600000 86                 TZE     s:7862

     1689     7859    8                                   THEN
     1690     7860    8                                       CALL CONCAT(LIST_STRING,
              7860                                                '               KEY IS DESCENDING ',

   7860 86 005007   040000 100400                    MLR     fill='040'O
        86 005010   001644 000041 12                 ADSC9   ONE_CHANGE+334           cn=0,n=33
        86 005011   000000 000041 16                 ADSC9   LIST_STRING              cn=0,n=33
        86 005012   040000 100400                    MLR     fill='040'O
        86 005013   000100 000036 4                  ADSC9   FIELD_NAME               cn=0,n=30
        86 005014   000010 200137 16                 ADSC9   LIST_STRING+8            cn=1,n=95
        86 005015   005024 710000 86                 TRA     s:7864

     1691     7861    8                                          FIELD_NAME);
     1692     7862    8                                   ELSE CALL CONCAT(LIST_STRING,

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:235  
   7862 86 005016   040000 100400                    MLR     fill='040'O
        86 005017   001655 000040 12                 ADSC9   ONE_CHANGE+343           cn=0,n=32
        86 005020   000000 000040 16                 ADSC9   LIST_STRING              cn=0,n=32
        86 005021   040000 100400                    MLR     fill='040'O
        86 005022   000100 000036 4                  ADSC9   FIELD_NAME               cn=0,n=30
        86 005023   000010 000140 16                 ADSC9   LIST_STRING+8            cn=0,n=96

     1693     7863    8                                          '              KEY IS ASCENDING ',FIELD_NAME
              7863                                                   );
     1694     7864    8                                   CALL LIST(LIST_STRING);

   7864 86 005024   000022 630400 87                 EPPR0   18
        86 005025   000000 631400 87                 EPPR1   0
        86 005026   000000 701000 xent               TSX1    LIST
        86 005027   000000 011000                    NOP     0

     1695     7865    8                                   END;

     1696     7866    7                               T8PTR$ = PINCRW(SSS$, T8PTR$ -> CD.RSCDN);

   7866 86 005030   000075 470400 4                  LDP0    T8PTR$
        86 005031   000001 220100                    LDX0    1,,PR0
        86 005032   000000 636010                    EAQ     0,X0
        86 005033   000000 036000 66                 ADLQ    SSS$
        86 005034   000075 756000 4                  STQ     T8PTR$

     1697     7867    7                               END;

   7867 86 005035   000000 116000 66                 CMPQ    SSS$
        86 005036   004744 601000 86                 TNZ     s:7845

     1698     7868    6                           END;

     1699     7869    5                       END;

     1700     7870    4                   END;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:236  
   7870 86 005037   000052 235000 4                  LDA     I
        86 005040   000001 035007                    ADLA    1,DL
        86 005041   000052 755000 4                  STA     I
        86 005042   000063 470400 4                  LDP0    T2PTR$
        86 005043   000052 236000 4                  LDQ     I
        86 005044   000015 116100                    CMPQ    13,,PR0
        86 005045   004635 602000 86                 TNC     s:7826

     1701     7871    3               IF NO_MEMBERS_IN_SUBSCHEMA

   7871 86 005046   200007 234100                    SZN     NO_MEMBERS_IN_SUBSCHEMA,,AUTO
        86 005047   005057 605000 86                 TPL     s:7877

     1702     7872    4               THEN DO;

     1703     7873    4                   LIST_STRING =
              7873                       '         THE USAGE OF THIS SET DOES NOT REQUIRE ANY MEMBER RECORDS'
              7873                            ;

   7873 86 005050   040000 100400                    MLR     fill='040'O
        86 005051   001665 000103 12                 ADSC9   ONE_CHANGE+351           cn=0,n=67
        86 005052   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1704     7874    4                   CALL LIST(LIST_STRING);

   7874 86 005053   000022 630400 87                 EPPR0   18
        86 005054   000000 631400 87                 EPPR1   0
        86 005055   000000 701000 xent               TSX1    LIST
        86 005056   000000 011000                    NOP     0

     1705     7875    4                   END;

     1706     7876    3               END;

     1707     7877    2           T2PTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;

   7877 86 005057   000000 470400 72                 LDP0    SC1$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:237  
        86 005060   000001 236100                    LDQ     1,,PR0
        86 005061   000063 756000 4                  STQ     T2PTR$

     1708     7878    2           IF T2PTR$ -> SET_HASH.SO.DBK > 0

   7878 86 005062   000063 471400 4                  LDP1    T2PTR$
        86 005063   100014 236100                    LDQ     12,,PR1
        86 005064   000113 376000 87                 ANQ     75
        86 005065   000000 116003                    CMPQ    0,DU
        86 005066   005200 604400 86                 TMOZ    s:7907

     1709     7879    3           THEN DO;

     1710     7880    3               DBK = T2PTR$ -> SET_HASH.SO.DBK;

   7880 86 005067   100014 236100                    LDQ     12,,PR1
        86 005070   000021 732000                    QRS     17
        86 005071   000067 756000 4                  STQ     DBK

     1711     7881    3               CALL FINDD_6('SO  ',DBK) ALTRET (DBCS_ERR);

   7881 86 005072   000114 630400 87                 EPPR0   76
        86 005073   000013 631400 87                 EPPR1   11
        86 005074   000000 701000 xent               TSX1    FINDD_6
        86 005075   007155 702000 86                 TSX2    DBCS_ERR

     1712     7882    3               CALL FETCHOS_6('RC-SOSM ') ALTRET (DBCS_ERR);

   7882 86 005076   000116 630400 87                 EPPR0   78
        86 005077   000000 631400 87                 EPPR1   0
        86 005100   000000 701000 xent               TSX1    FETCHOS_6
        86 005101   007155 702000 86                 TSX2    DBCS_ERR

     1713     7883    3               CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);

   7883 86 005102   000117 630400 87                 EPPR0   79
        86 005103   000000 631400 87                 EPPR1   0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:238  
        86 005104   000000 701000 xent               TSX1    FETCHOS_6
        86 005105   007155 702000 86                 TSX2    DBCS_ERR

     1714     7884    3               TYPE_400.TYPE = 400;

   7884 86 005106   000620 235007                    LDA     400,DL
        86 005107   000000 755000 62                 STA     IO_BUF

     1715     7885    3               TYPE_400.RECORD_NAME = UWA.SN.SENAME;

   7885 86 005110   040000 100400                    MLR     fill='040'O
        86 005111   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 005112   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

     1716     7886    3               TYPE_400.SUB_RECORD_NAME = UWA.SN.SENAME;

   7886 86 005113   040000 100400                    MLR     fill='040'O
        86 005114   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 005115   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

     1717     7887    3               CALL CHANGE_TO_STR(TYPE_400.SUB_RECORD_NAME);

   7887 86 005116   000015 236000 87                 LDQ     13
        86 005117   200025 756100                    STQ     @ALI+1,,AUTO
        86 005120   002414 701000 86                 TSX1    CHANGE_TO_STR
        86 005121   000000 011000                    NOP     0

     1718     7888    3               TYPE_400.REF_LINE = 0;

   7888 86 005122   000001 450000 62                 STZ     IO_BUF+1

     1719     7889    3               TYPE_400.ID_NUM = 0;

   7889 86 005123   000023 450000 62                 STZ     IO_BUF+19

     1720     7890    3               CALL ZIG$V_RECORD;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:239  
   7890 86 005124   000005 631400 87                 EPPR1   5
        86 005125   000000 701000 xent               TSX1    ZIG$V_RECORD
        86 005126   000000 011000                    NOP     0

     1721     7891    3               IF SUBSTR(RC.RNAM,0,1) ~= '*'

   7891 86 005127   000000 470400 73                 LDP0    RC$
        86 005130   000000 720100                    LXL0    0,,PR0
        86 005131   000077 360003                    ANX0    63,DU
        86 005132   000005 236100                    LDQ     5,,PR0
        86 005133   777000 376003                    ANQ     -512,DU
        86 005134   052000 116003                    CMPQ    21504,DU
        86 005135   005151 600000 86                 TZE     s:7898

     1722     7892    4               THEN DO;

     1723     7893    4                   RC.DEF.RERS = '1'B;

   7893 86 005136   400000 236007                    LDQ     -131072,DL
        86 005137   000000 256100                    ORSQ    0,,PR0

     1724     7894    4                   RC.DEF.RSTO = '1'B;

   7894 86 005140   000000 470400 73                 LDP0    RC$
        86 005141   200000 236007                    LDQ     65536,DL
        86 005142   000000 256100                    ORSQ    0,,PR0

     1725     7895    4                   RC.DEF.RERA = '1'B;

   7895 86 005143   000000 470400 73                 LDP0    RC$
        86 005144   004000 236007                    LDQ     2048,DL
        86 005145   000000 256100                    ORSQ    0,,PR0

     1726     7896    4                   RC.DEF.SR = '1'B;

   7896 86 005146   000000 470400 73                 LDP0    RC$
        86 005147   100000 236007                    LDQ     32768,DL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:240  
        86 005150   000000 256100                    ORSQ    0,,PR0

     1727     7897    4                   END;

     1728     7898    3               IF SUBSTR(RC.RNAM,0,1) = '*'

   7898 86 005151   000000 470400 73                 LDP0    RC$
        86 005152   000000 720100                    LXL0    0,,PR0
        86 005153   000077 360003                    ANX0    63,DU
        86 005154   000005 236100                    LDQ     5,,PR0
        86 005155   777000 376003                    ANQ     -512,DU
        86 005156   052000 116003                    CMPQ    21504,DU
        86 005157   005162 601000 86                 TNZ     s:7902

     1729     7899    4               THEN DO;

     1730     7900    4                   RC.DEF.SR = '1'B;

   7900 86 005160   100000 236007                    LDQ     32768,DL
        86 005161   000000 256100                    ORSQ    0,,PR0

     1731     7901    4                   END;

     1732     7902    3               CALL ZIG$V_CHECK_F;

   7902 86 005162   000003 701000 86                 TSX1    ZIG$V_CHECK_F
        86 005163   000000 011000                    NOP     0

     1733     7903    3               CALL ZIG$ZERO_ALT_TABLE;

   7903 86 005164   000005 631400 87                 EPPR1   5
        86 005165   000000 701000 xent               TSX1    ZIG$ZERO_ALT_TABLE
        86 005166   000000 011000                    NOP     0

     1734     7904    3               SC$ = PINCRW(SSS$,LAST_SC_SAVE);

   7904 86 005167   000066 236000 4                  LDQ     LAST_SC_SAVE
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:241  
        86 005170   000022 736000                    QLS     18
        86 005171   000000 036000 66                 ADLQ    SSS$
        86 005172   000000 756000 71                 STQ     SC$

     1735     7905    3               SC1$ = PINCRW(SSS$,LAST_SC_SAVE -2 );

   7905 86 005173   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 005174   000022 736000                    QLS     18
        86 005175   000002 136003                    SBLQ    2,DU
        86 005176   000000 036000 66                 ADLQ    SSS$
        86 005177   000000 756000 72                 STQ     SC1$

     1736     7906    3               END;

     1737     7907    3           DO I = 0 TO T2PTR$ -> SET_HASH.NUM_SM - 1;

   7907 86 005200   000052 450000 4                  STZ     I
        86 005201   005327 710000 86                 TRA     s:7938+3

     1738     7908    3               IF T2PTR$ -> SET_HASH.SM_LIST.DBK(I) > 0

   7908 86 005202   000063 470400 4                  LDP0    T2PTR$
        86 005203   000052 720000 4                  LXL0    I
        86 005204   000016 236110                    LDQ     14,X0,PR0
        86 005205   000113 376000 87                 ANQ     75
        86 005206   000000 116003                    CMPQ    0,DU
        86 005207   005324 604400 86                 TMOZ    s:7938

     1739     7909    4               THEN DO;

     1740     7910    4                   DBK = T2PTR$ -> SET_HASH.SM_LIST.DBK(I);

   7910 86 005210   000016 236110                    LDQ     14,X0,PR0
        86 005211   000021 732000                    QRS     17
        86 005212   000067 756000 4                  STQ     DBK

     1741     7911    4                   CALL FINDD_6('SM  ',DBK) ALTRET (DBCS_ERR);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:242  

   7911 86 005213   000120 630400 87                 EPPR0   80
        86 005214   000013 631400 87                 EPPR1   11
        86 005215   000000 701000 xent               TSX1    FINDD_6
        86 005216   007155 702000 86                 TSX2    DBCS_ERR

     1742     7912    4                   CALL FETCHOS_6('RC-SOSM ') ALTRET (DBCS_ERR);

   7912 86 005217   000116 630400 87                 EPPR0   78
        86 005220   000000 631400 87                 EPPR1   0
        86 005221   000000 701000 xent               TSX1    FETCHOS_6
        86 005222   007155 702000 86                 TSX2    DBCS_ERR

     1743     7913    4                   CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);

   7913 86 005223   000117 630400 87                 EPPR0   79
        86 005224   000000 631400 87                 EPPR1   0
        86 005225   000000 701000 xent               TSX1    FETCHOS_6
        86 005226   007155 702000 86                 TSX2    DBCS_ERR

     1744     7914    4                   TYPE_400.TYPE = 400;

   7914 86 005227   000620 235007                    LDA     400,DL
        86 005230   000000 755000 62                 STA     IO_BUF

     1745     7915    4                   TYPE_400.RECORD_NAME = UWA.SN.SENAME;

   7915 86 005231   040000 100400                    MLR     fill='040'O
        86 005232   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 005233   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

     1746     7916    4                   TYPE_400.SUB_RECORD_NAME = UWA.SN.SENAME;

   7916 86 005234   040000 100400                    MLR     fill='040'O
        86 005235   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 005236   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:243  
     1747     7917    4                   CALL CHANGE_TO_STR(TYPE_400.SUB_RECORD_NAME);

   7917 86 005237   000015 236000 87                 LDQ     13
        86 005240   200025 756100                    STQ     @ALI+1,,AUTO
        86 005241   002414 701000 86                 TSX1    CHANGE_TO_STR
        86 005242   000000 011000                    NOP     0

     1748     7918    4                   TYPE_400.REF_LINE = 0;

   7918 86 005243   000001 450000 62                 STZ     IO_BUF+1

     1749     7919    4                   TYPE_400.ID_NUM = 0;

   7919 86 005244   000023 450000 62                 STZ     IO_BUF+19

     1750     7920    4                   CALL ZIG$V_RECORD;

   7920 86 005245   000005 631400 87                 EPPR1   5
        86 005246   000000 701000 xent               TSX1    ZIG$V_RECORD
        86 005247   000000 011000                    NOP     0

     1751     7921    4                   IF SUBSTR(RC.RNAM,0,1) ~= '*'

   7921 86 005250   000000 470400 73                 LDP0    RC$
        86 005251   000000 720100                    LXL0    0,,PR0
        86 005252   000077 360003                    ANX0    63,DU
        86 005253   000005 236100                    LDQ     5,,PR0
        86 005254   777000 376003                    ANQ     -512,DU
        86 005255   052000 116003                    CMPQ    21504,DU
        86 005256   005275 600000 86                 TZE     s:7929

     1752     7922    5                   THEN DO;

     1753     7923    5                       RC.DEF.RERS = '1'B;

   7923 86 005257   400000 236007                    LDQ     -131072,DL
        86 005260   000000 256100                    ORSQ    0,,PR0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:244  

     1754     7924    5                       RC.DEF.RSTO = '1'B;

   7924 86 005261   000000 470400 73                 LDP0    RC$
        86 005262   200000 236007                    LDQ     65536,DL
        86 005263   000000 256100                    ORSQ    0,,PR0

     1755     7925    5                       RC.DEF.RERA = '1'B;

   7925 86 005264   000000 470400 73                 LDP0    RC$
        86 005265   004000 236007                    LDQ     2048,DL
        86 005266   000000 256100                    ORSQ    0,,PR0

     1756     7926    5                       RC.DEF.SR = '1'B;

   7926 86 005267   000000 470400 73                 LDP0    RC$
        86 005270   100000 236007                    LDQ     32768,DL
        86 005271   000000 256100                    ORSQ    0,,PR0

     1757     7927    5                       RC.DEF.FLAG_OWNER = '1'B;

   7927 86 005272   000000 470400 73                 LDP0    RC$
        86 005273   000400 236007                    LDQ     256,DL
        86 005274   000000 256100                    ORSQ    0,,PR0

     1758     7928    5                       END;

     1759     7929    4                   IF SUBSTR(RC.RNAM,0,1) = '*'

   7929 86 005275   000000 470400 73                 LDP0    RC$
        86 005276   000000 720100                    LXL0    0,,PR0
        86 005277   000077 360003                    ANX0    63,DU
        86 005300   000005 236100                    LDQ     5,,PR0
        86 005301   777000 376003                    ANQ     -512,DU
        86 005302   052000 116003                    CMPQ    21504,DU
        86 005303   005306 601000 86                 TNZ     s:7933

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:245  
     1760     7930    5                   THEN DO;

     1761     7931    5                       RC.DEF.SR = '1'B;

   7931 86 005304   100000 236007                    LDQ     32768,DL
        86 005305   000000 256100                    ORSQ    0,,PR0

     1762     7932    5                       END;

     1763     7933    4                   CALL ZIG$V_CHECK_F;

   7933 86 005306   000003 701000 86                 TSX1    ZIG$V_CHECK_F
        86 005307   000000 011000                    NOP     0

     1764     7934    4                   CALL ZIG$ZERO_ALT_TABLE;

   7934 86 005310   000005 631400 87                 EPPR1   5
        86 005311   000000 701000 xent               TSX1    ZIG$ZERO_ALT_TABLE
        86 005312   000000 011000                    NOP     0

     1765     7935    4                   SC$ = PINCRW(SSS$,LAST_SC_SAVE);

   7935 86 005313   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 005314   000022 736000                    QLS     18
        86 005315   000000 036000 66                 ADLQ    SSS$
        86 005316   000000 756000 71                 STQ     SC$

     1766     7936    4                   SC1$ = PINCRW(SSS$,LAST_SC_SAVE -2 );

   7936 86 005317   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 005320   000022 736000                    QLS     18
        86 005321   000002 136003                    SBLQ    2,DU
        86 005322   000000 036000 66                 ADLQ    SSS$
        86 005323   000000 756000 72                 STQ     SC1$

     1767     7937    4                   END;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:246  
     1768     7938    3               END;

   7938 86 005324   000052 235000 4                  LDA     I
        86 005325   000001 035007                    ADLA    1,DL
        86 005326   000052 755000 4                  STA     I
        86 005327   000063 470400 4                  LDP0    T2PTR$
        86 005330   000052 236000 4                  LDQ     I
        86 005331   000015 116100                    CMPQ    13,,PR0
        86 005332   005202 602000 86                 TNC     s:7908

     1769     7939    2           LAST_SC_SAVE = SC.OASCN;

   7939 86 005333   000000 471400 71                 LDP1    SC$
        86 005334   100001 236100                    LDQ     1,,PR1
        86 005335   777777 376007                    ANQ     -1,DL
        86 005336   000066 756000 4                  STQ     LAST_SC_SAVE

     1770     7940    2           END;

   7940 86 005337   004364 601000 86                 TNZ     s:7782

     1771     7941        /*
     1772     7942            Call FLAG_OWNER routine only after all the records have been
     1773     7943            processed by ZIG$V_RECORD.  In the case of partial subschemas
     1774     7944            this means the implied records as well as those specifically
     1775     7945            used in the subschema.
     1776     7946        */
     1777     7947    1       LAST_SC_SAVE = OA.OASCN;

   7947 86 005340   000000 470400 75                 LDP0    OA$
        86 005341   000001 236100                    LDQ     1,,PR0
        86 005342   777777 376007                    ANQ     -1,DL
        86 005343   000066 756000 4                  STQ     LAST_SC_SAVE

     1778     7948    2       DO WHILE ( LAST_SC_SAVE ~= 0 );

   7948 86 005344   005432 600000 86                 TZE     s:7972
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:247  

     1779     7949    2           SC$ = PINCRW( SSS$, LAST_SC_SAVE );

   7949 86 005345   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 005346   000022 736000                    QLS     18
        86 005347   000000 036000 66                 ADLQ    SSS$
        86 005350   000000 756000 71                 STQ     SC$

     1780     7950    2           SC1$ = PINCRW( SSS$, LAST_SC_SAVE - 2 );

   7950 86 005351   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 005352   000022 736000                    QLS     18
        86 005353   000002 136003                    SBLQ    2,DU
        86 005354   000000 036000 66                 ADLQ    SSS$
        86 005355   000000 756000 72                 STQ     SC1$

     1781     7951    2           T2PTR$ = ADDR( SC1.XXDPN )->BASED_PTR$;

   7951 86 005356   000000 470400 72                 LDP0    SC1$
        86 005357   000001 236100                    LDQ     1,,PR0
        86 005360   000063 756000 4                  STQ     T2PTR$

     1782     7952
     1783     7953    3           DO I = 0 TO T2PTR$->SET_HASH.NUM_SM - 1;

   7953 86 005361   000052 450000 4                  STZ     I
        86 005362   005421 710000 86                 TRA     s:7966+3

     1784     7954    3               T9PTR$ = PINCRW( SSS$, T2PTR$->SET_HASH.SM_LIST.OFFSET( I ) );

   7954 86 005363   000063 470400 4                  LDP0    T2PTR$
        86 005364   000052 720000 4                  LXL0    I
        86 005365   000016 721110                    LXL1    14,X0,PR0
        86 005366   377777 361003                    ANX1    131071,DU
        86 005367   000000 636011                    EAQ     0,X1
        86 005370   000000 036000 66                 ADLQ    SSS$
        86 005371   000076 756000 4                  STQ     T9PTR$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:248  

     1785     7955    3               T9PTR$ = PINCRW( SSS$, T9PTR$->RS.RCRSH ); /* Ptr to RC */

   7955 86 005372   000076 471400 4                  LDP1    T9PTR$
        86 005373   100003 221100                    LDX1    3,,PR1
        86 005374   000000 636011                    EAQ     0,X1
        86 005375   000000 036000 66                 ADLQ    SSS$
        86 005376   000076 756000 4                  STQ     T9PTR$

     1786     7956    3               IF T9PTR$->RC.DEF.FLAG_OWNER

   7956 86 005377   000076 471400 4                  LDP1    T9PTR$
        86 005400   100000 236100                    LDQ     0,,PR1
        86 005401   000400 316007                    CANQ    256,DL
        86 005402   005416 600000 86                 TZE     s:7966

     1787     7957    4               THEN DO;

     1788     7958        /*
     1789     7959            Only want to process each record once so turn off the flag that
     1790     7960            was originally set to tell us to process this record.
     1791     7961        */
     1792     7962    4                   T9PTR$->RC.DEF.FLAG_OWNER = '0'B;

   7962 86 005403   000046 236000 87                 LDQ     38
        86 005404   100000 356100                    ANSQ    0,,PR1

     1793     7963    4                   T9PTR$ = PINCRW( SSS$, T2PTR$->SET_HASH.SO.OFFSET );

   7963 86 005405   000014 720100                    LXL0    12,,PR0
        86 005406   377777 360003                    ANX0    131071,DU
        86 005407   000000 636010                    EAQ     0,X0
        86 005410   000000 036000 66                 ADLQ    SSS$
        86 005411   000076 756000 4                  STQ     T9PTR$

     1794     7964    4                   CALL FLAG_OWNER( T9PTR$ );

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:249  
   7964 86 005412   000122 630400 87                 EPPR0   82
        86 005413   000000 631400 87                 EPPR1   0
        86 005414   000000 701000 xent               TSX1    FLAG_OWNER
        86 005415   000000 011000                    NOP     0

     1795     7965    4                   END;

     1796     7966    3               END;

   7966 86 005416   000052 235000 4                  LDA     I
        86 005417   000001 035007                    ADLA    1,DL
        86 005420   000052 755000 4                  STA     I
        86 005421   000063 470400 4                  LDP0    T2PTR$
        86 005422   000052 236000 4                  LDQ     I
        86 005423   000015 116100                    CMPQ    13,,PR0
        86 005424   005363 602000 86                 TNC     s:7954

     1797     7967    2           LAST_SC_SAVE = SC.OASCN;

   7967 86 005425   000000 471400 71                 LDP1    SC$
        86 005426   100001 236100                    LDQ     1,,PR1
        86 005427   777777 376007                    ANQ     -1,DL
        86 005430   000066 756000 4                  STQ     LAST_SC_SAVE

     1798     7968    2           END;

   7968 86 005431   005345 601000 86                 TNZ     s:7949

     1799     7969        /*
     1800     7970              Now put in the CF connections for the schema subset.
     1801     7971        */
     1802     7972    1       RC$ = PINCRW(SSS$, OA.OARCN);

   7972 86 005432   000000 470400 75                 LDP0    OA$
        86 005433   000002 220100                    LDX0    2,,PR0
        86 005434   000000 636010                    EAQ     0,X0
        86 005435   000000 036000 66                 ADLQ    SSS$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:250  
        86 005436   000000 756000 73                 STQ     RC$

     1803     7973    2       DO WHILE (RC$ ~= SSS$);

   7973 86 005437   000000 116000 66                 CMPQ    SSS$
        86 005440   006060 600000 86                 TZE     s:8068

     1804     7974    2           RC.DEF.RSTO = '0'B;

   7974 86 005441   000000 470400 73                 LDP0    RC$
        86 005442   000123 236000 87                 LDQ     83
        86 005443   000000 356100                    ANSQ    0,,PR0

     1805     7975    2           FR$ = PINCRW(SSS$,RC.RCFRN);

   7975 86 005444   000000 470400 73                 LDP0    RC$
        86 005445   000004 720100                    LXL0    4,,PR0
        86 005446   000000 636010                    EAQ     0,X0
        86 005447   000000 036000 66                 ADLQ    SSS$
        86 005450   000000 756000 69                 STQ     FR$

     1806     7976    3           DO WHILE (SSS$ ~= FR$ );

   7976 86 005451   000000 116000 66                 CMPQ    SSS$
        86 005452   006051 600000 86                 TZE     s:8062

     1807     7977    3               IF FR.UOFST.EIS.REG = 0

   7977 86 005453   000000 470400 69                 LDP0    FR$
        86 005454   000002 236100                    LDQ     2,,PR0
        86 005455   700000 316003                    CANQ    -32768,DU
        86 005456   006042 601000 86                 TNZ     s:8060

     1808     7978    4               THEN DO;

     1809     7979    4                   CALL FETCHD_6('FR  ',FR.UOFST) ALTRET (DBCS_ERR);

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:251  
   7979 86 005457   000000 236000 69                 LDQ     FR$
        86 005460   000002 036003                    ADLQ    2,DU
        86 005461   000124 235000 87                 LDA     84
        86 005462   200030 757100                    STAQ    COUNT1+2,,AUTO
        86 005463   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 005464   000013 631400 87                 EPPR1   11
        86 005465   000000 701000 xent               TSX1    FETCHD_6
        86 005466   007155 702000 86                 TSX2    DBCS_ERR

     1810     7980    4                   FR_DBK = UWA.DIRECT_REF;

   7980 86 005467   000036 235000 54                 LDA     UWA+30
        86 005470   000054 755000 4                  STA     FR_DBK

     1811     7981    4                   CALL FETCHOS_6('RC-FR   ') ALTRET (DBCS_ERR);

   7981 86 005471   000125 630400 87                 EPPR0   85
        86 005472   000000 631400 87                 EPPR1   0
        86 005473   000000 701000 xent               TSX1    FETCHOS_6
        86 005474   007155 702000 86                 TSX2    DBCS_ERR

     1812     7982    4                   CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);

   7982 86 005475   000117 630400 87                 EPPR0   79
        86 005476   000000 631400 87                 EPPR1   0
        86 005477   000000 701000 xent               TSX1    FETCHOS_6
        86 005500   007155 702000 86                 TSX2    DBCS_ERR

     1813     7983    4                   STATUS = #RECORD_DEF;

   7983 86 005501   040000 236003                    LDQ     16384,DU
        86 005502   000055 756000 4                  STQ     STATUS

     1814     7984    4                   ALLOCATE_END = 1;

   7984 86 005503   000001 235007                    LDA     1,DL
        86 005504   000000 755000 39                 STA     ALLOCATE_END
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:252  

     1815     7985    4                   HASH_SCHEMA_NAME = '1'B;

   7985 86 005505   400000 236003                    LDQ     -131072,DU
        86 005506   000000 756000 60                 STQ     HASH_SCHEMA_NAME

     1816     7986    4                   CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,ERROR_FLG,

   7986 86 005507   000130 630400 87                 EPPR0   88
        86 005510   000126 631400 87                 EPPR1   86
        86 005511   000000 701000 xent               TSX1    ZIG$HASH_IT
        86 005512   000000 011000                    NOP     0

     1817     7987    4                      0,1,14,T5PTR$,STATUS);
     1818     7988    4                   ALLOCATE_END = 0;

   7988 86 005513   000000 450000 39                 STZ     ALLOCATE_END

     1819     7989    4                   IF ERROR_FLG = 0

   7989 86 005514   000062 235000 4                  LDA     ERROR_FLG
        86 005515   005624 601000 86                 TNZ     s:8020

     1820     7990    5                   THEN DO;

     1821     7991    5                       T5PTR$ = RC$;

   7991 86 005516   000000 236000 73                 LDQ     RC$
        86 005517   000056 756000 4                  STQ     T5PTR$

     1822     7992    5                       T6PTR$ = FR$;

   7992 86 005520   000000 236000 69                 LDQ     FR$
        86 005521   000057 756000 4                  STQ     T6PTR$

     1823     7993    5                       TYPE_400.TYPE = 400;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:253  
   7993 86 005522   000620 235007                    LDA     400,DL
        86 005523   000000 755000 62                 STA     IO_BUF

     1824     7994    5                       TYPE_400.RECORD_NAME = UWA.SN.SENAME;

   7994 86 005524   040000 100400                    MLR     fill='040'O
        86 005525   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 005526   000003 000036 62                 ADSC9   IO_BUF+3                 cn=0,n=30

     1825     7995    5                       TYPE_400.SUB_RECORD_NAME = UWA.SN.SENAME;

   7995 86 005527   040000 100400                    MLR     fill='040'O
        86 005530   000427 000036 54                 ADSC9   UWA+279                  cn=0,n=30
        86 005531   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30

     1826     7996    5                       CALL CHANGE_TO_STR(TYPE_400.SUB_RECORD_NAME);

   7996 86 005532   000015 236000 87                 LDQ     13
        86 005533   200025 756100                    STQ     @ALI+1,,AUTO
        86 005534   002414 701000 86                 TSX1    CHANGE_TO_STR
        86 005535   000000 011000                    NOP     0

     1827     7997    5                       TYPE_400.REF_LINE = 0;

   7997 86 005536   000001 450000 62                 STZ     IO_BUF+1

     1828     7998    5                       TYPE_400.ID_NUM = 0;

   7998 86 005537   000023 450000 62                 STZ     IO_BUF+19

     1829     7999    5                       CALL ZIG$V_RECORD;

   7999 86 005540   000005 631400 87                 EPPR1   5
        86 005541   000000 701000 xent               TSX1    ZIG$V_RECORD
        86 005542   000000 011000                    NOP     0

     1830     8000    5                       IF SUBSTR(RC.RNAM,0,1) ~= '*'
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:254  

   8000 86 005543   000000 470400 73                 LDP0    RC$
        86 005544   000000 720100                    LXL0    0,,PR0
        86 005545   000077 360003                    ANX0    63,DU
        86 005546   000005 236100                    LDQ     5,,PR0
        86 005547   777000 376003                    ANQ     -512,DU
        86 005550   052000 116003                    CMPQ    21504,DU
        86 005551   005565 600000 86                 TZE     s:8007

     1831     8001    6                       THEN DO;

     1832     8002    6                           RC.DEF.RERS = '1'B;

   8002 86 005552   400000 236007                    LDQ     -131072,DL
        86 005553   000000 256100                    ORSQ    0,,PR0

     1833     8003    6                           RC.DEF.RSTO = '1'B;

   8003 86 005554   000000 470400 73                 LDP0    RC$
        86 005555   200000 236007                    LDQ     65536,DL
        86 005556   000000 256100                    ORSQ    0,,PR0

     1834     8004    6                           RC.DEF.RERA = '1'B;

   8004 86 005557   000000 470400 73                 LDP0    RC$
        86 005560   004000 236007                    LDQ     2048,DL
        86 005561   000000 256100                    ORSQ    0,,PR0

     1835     8005    6                           RC.DEF.SR = '1'B;

   8005 86 005562   000000 470400 73                 LDP0    RC$
        86 005563   100000 236007                    LDQ     32768,DL
        86 005564   000000 256100                    ORSQ    0,,PR0

     1836     8006    6                           END;

     1837     8007    5                       IF SUBSTR(RC.RNAM,0,1) = '*'
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:255  

   8007 86 005565   000000 470400 73                 LDP0    RC$
        86 005566   000000 720100                    LXL0    0,,PR0
        86 005567   000077 360003                    ANX0    63,DU
        86 005570   000005 236100                    LDQ     5,,PR0
        86 005571   777000 376003                    ANQ     -512,DU
        86 005572   052000 116003                    CMPQ    21504,DU
        86 005573   005576 601000 86                 TNZ     s:8011

     1838     8008    6                       THEN DO;

     1839     8009    6                           RC.DEF.SR = '1'B;

   8009 86 005574   100000 236007                    LDQ     32768,DL
        86 005575   000000 256100                    ORSQ    0,,PR0

     1840     8010    6                           END;

     1841     8011    5                       CALL ZIG$V_CHECK_F;

   8011 86 005576   000003 701000 86                 TSX1    ZIG$V_CHECK_F
        86 005577   000000 011000                    NOP     0

     1842     8012    5                       CALL ZIG$ZERO_ALT_TABLE;

   8012 86 005600   000005 631400 87                 EPPR1   5
        86 005601   000000 701000 xent               TSX1    ZIG$ZERO_ALT_TABLE
        86 005602   000000 011000                    NOP     0

     1843     8013    5                       RC.DEF.SR = '1'B;

   8013 86 005603   000000 470400 73                 LDP0    RC$
        86 005604   100000 236007                    LDQ     32768,DL
        86 005605   000000 256100                    ORSQ    0,,PR0

     1844     8014    5                       TPTR$ = PINCRW(SSS$, RC.RCFRN);

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:256  
   8014 86 005606   000000 470400 73                 LDP0    RC$
        86 005607   000004 720100                    LXL0    4,,PR0
        86 005610   000000 636010                    EAQ     0,X0
        86 005611   000000 036000 66                 ADLQ    SSS$
        86 005612   000060 756000 4                  STQ     TPTR$

     1845     8015    5                       RC$ = T5PTR$;

   8015 86 005613   000056 236000 4                  LDQ     T5PTR$
        86 005614   000000 756000 73                 STQ     RC$

     1846     8016    5                       FR$ = T6PTR$;

   8016 86 005615   000057 236000 4                  LDQ     T6PTR$
        86 005616   000000 756000 69                 STQ     FR$

     1847     8017    5                       CALL FETCHD_6('FR  ',FR_DBK);

   8017 86 005617   000140 630400 87                 EPPR0   96
        86 005620   000013 631400 87                 EPPR1   11
        86 005621   000000 701000 xent               TSX1    FETCHD_6
        86 005622   000000 011000                    NOP     0

     1848     8018    5                       END;

   8018 86 005623   005636 710000 86                 TRA     s:8023

     1849     8019    5                   ELSE DO;

     1850     8020    5                       T5PTR$ = PINCRW(SSS$, T5PTR$ -> RECORD_HASH.SUB_OFF);

   8020 86 005624   000056 470400 4                  LDP0    T5PTR$
        86 005625   000012 720100                    LXL0    10,,PR0
        86 005626   000000 636010                    EAQ     0,X0
        86 005627   000000 036000 66                 ADLQ    SSS$
        86 005630   000056 756000 4                  STQ     T5PTR$

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:257  
     1851     8021    5                       TPTR$ = PINCRW(SSS$,T5PTR$ -> RC.RCFRN);

   8021 86 005631   000056 470400 4                  LDP0    T5PTR$
        86 005632   000004 720100                    LXL0    4,,PR0
        86 005633   000000 636010                    EAQ     0,X0
        86 005634   000000 036000 66                 ADLQ    SSS$
        86 005635   000060 756000 4                  STQ     TPTR$

     1852     8022    5                       END;

     1853     8023    4                   T5PTR$ = PINCRW(TPTR$, -1);

   8023 86 005636   000060 236000 4                  LDQ     TPTR$
        86 005637   777777 036003                    ADLQ    -1,DU
        86 005640   000056 756000 4                  STQ     T5PTR$

     1854     8024    5                   DO WHILE(TPTR$ ~= SSS$ AND T5PTR$ -> FR1.XXDPN

   8024 86 005641   005651 710000 86                 TRA     s:8028

     1855     8025    5                      ~= FR_DBK );
     1856     8026    5                       TPTR$ = PINCRW(SSS$, TPTR$ -> FR.RCFRN);

   8026 86 005642   000060 470400 4                  LDP0    TPTR$
        86 005643   000004 720100                    LXL0    4,,PR0
        86 005644   000000 636010                    EAQ     0,X0
        86 005645   000000 036000 66                 ADLQ    SSS$
        86 005646   000060 756000 4                  STQ     TPTR$

     1857     8027    5                       T5PTR$ = PINCRW(TPTR$, -1);

   8027 86 005647   777777 036003                    ADLQ    -1,DU
        86 005650   000056 756000 4                  STQ     T5PTR$

     1858     8028    5                       END;

   8028 86 005651   000060 236000 4                  LDQ     TPTR$
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:258  
        86 005652   000000 116000 66                 CMPQ    SSS$
        86 005653   005661 600000 86                 TZE     s:8029
        86 005654   000056 470400 4                  LDP0    T5PTR$
        86 005655   000000 236100                    LDQ     0,,PR0
        86 005656   000022 772000                    QRL     18
        86 005657   000054 116000 4                  CMPQ    FR_DBK
        86 005660   005642 601000 86                 TNZ     s:8026

     1859     8029    4                   IF TPTR$ = SSS$ THEN CALL ABORT;

   8029 86 005661   000060 236000 4                  LDQ     TPTR$
        86 005662   000000 116000 66                 CMPQ    SSS$
        86 005663   005667 601000 86                 TNZ     s:8030

   8029 86 005664   000005 631400 87                 EPPR1   5
        86 005665   000000 701000 xent               TSX1    ABORT
        86 005666   000000 011000                    NOP     0

     1860     8030    4                   FR.UOFST = TPTR$ -> FR.UOFST;

   8030 86 005667   000060 470400 4                  LDP0    TPTR$
        86 005670   000002 236100                    LDQ     2,,PR0
        86 005671   000000 471400 69                 LDP1    FR$
        86 005672   100002 756100                    STQ     2,,PR1

     1861     8031    4                   FR.DEF.ENDX = TPTR$ -> FR.DEF.ENDX;

   8031 86 005673   000000 236100                    LDQ     0,,PR0
        86 005674   100000 752110                    STCQ    0,'10'O,PR1

     1862     8032    4                   FR.DEF.DNDX = TPTR$ -> FR.DEF.DNDX;

   8032 86 005675   000000 471400 69                 LDP1    FR$
        86 005676   000000 236100                    LDQ     0,,PR0
        86 005677   100000 752101                    STCQ    0,'01'O,PR1

     1863     8033    4                   IF FR.DEF.SYN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:259  

   8033 86 005700   000000 471400 69                 LDP1    FR$
        86 005701   100000 236100                    LDQ     0,,PR1
        86 005702   004000 316007                    CANQ    2048,DL
        86 005703   005707 600000 86                 TZE     s:8035

     1864     8034    4                   THEN FR.DEF.FSR = '1'B;

   8034 86 005704   000100 236007                    LDQ     64,DL
        86 005705   100000 256100                    ORSQ    0,,PR1
        86 005706   005713 710000 86                 TRA     s:8036

     1865     8035    4                   ELSE FR.DEF.FSR = TPTR$ -> FR.DEF.FSR;

   8035 86 005707   000000 236100                    LDQ     0,,PR0
        86 005710   100000 676100                    ERQ     0,,PR1
        86 005711   000100 376007                    ANQ     64,DL
        86 005712   100000 656100                    ERSQ    0,,PR1

     1866     8036    4                   FR.DEF.FVF = TPTR$ -> FR.DEF.FVF;

   8036 86 005713   000000 471400 69                 LDP1    FR$
        86 005714   000000 236100                    LDQ     0,,PR0
        86 005715   100000 676100                    ERQ     0,,PR1
        86 005716   010000 376007                    ANQ     4096,DL
        86 005717   100000 656100                    ERSQ    0,,PR1

     1867     8037    4                   FR.DEF.COMC = TPTR$ -> FR.DEF.COMC;

   8037 86 005720   000000 471400 69                 LDP1    FR$
        86 005721   000000 236100                    LDQ     0,,PR0
        86 005722   100000 676100                    ERQ     0,,PR1
        86 005723   160000 376007                    ANQ     57344,DL
        86 005724   100000 656100                    ERSQ    0,,PR1

     1868     8038    4                   FR.DEF.EBCL = TPTR$ -> FR.DEF.EBCL;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:260  
   8038 86 005725   000000 471400 69                 LDP1    FR$
        86 005726   000000 236100                    LDQ     0,,PR0
        86 005727   100000 676100                    ERQ     0,,PR1
        86 005730   200000 376007                    ANQ     65536,DL
        86 005731   100000 656100                    ERSQ    0,,PR1

     1869     8039    4                   FR.DEF.EBCM = TPTR$ -> FR.DEF.EBCM;

   8039 86 005732   000000 471400 69                 LDP1    FR$
        86 005733   000000 236100                    LDQ     0,,PR0
        86 005734   100000 676100                    ERQ     0,,PR1
        86 005735   400000 376007                    ANQ     -131072,DL
        86 005736   100000 656100                    ERSQ    0,,PR1

     1870     8040    4                   IF FR.DEF.FUSE = 3 AND NOT RC.DEF.SR

   8040 86 005737   000000 471400 69                 LDP1    FR$
        86 005740   100000 236100                    LDQ     0,,PR1
        86 005741   003400 376007                    ANQ     1792,DL
        86 005742   001400 116007                    CMPQ    768,DL
        86 005743   006042 601000 86                 TNZ     s:8060
        86 005744   000000 473400 73                 LDP3    RC$
        86 005745   300000 236100                    LDQ     0,,PR3
        86 005746   100000 316007                    CANQ    32768,DL
        86 005747   006042 601000 86                 TNZ     s:8060

     1871     8041    5                   THEN DO;

     1872     8042    5                       IF TPTR$ -> FR.FNL = 0

   8042 86 005750   000004 236100                    LDQ     4,,PR0
        86 005751   000077 316003                    CANQ    63,DU
        86 005752   005772 601000 86                 TNZ     s:8050

     1873     8043    6                       THEN DO;

     1874     8044    6                           T9PTR$ = PINCRW(TPTR$, -1);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:261  

   8044 86 005753   000060 236000 4                  LDQ     TPTR$
        86 005754   777777 036003                    ADLQ    -1,DU
        86 005755   000076 756000 4                  STQ     T9PTR$

     1875     8045    6                           K = T9PTR$ -> FR1.NLIND;

   8045 86 005756   000076 474400 4                  LDP4    T9PTR$
        86 005757   400000 236100                    LDQ     0,,PR4
        86 005760   777777 376007                    ANQ     -1,DL
        86 005761   000077 756000 4                  STQ     K

     1876     8046    6                           CALL READSF(K,IO_BUF);

   8046 86 005762   000111 630400 87                 EPPR0   73
        86 005763   000013 631400 87                 EPPR1   11
        86 005764   000000 701000 xent               TSX1    READSF
        86 005765   000000 011000                    NOP     0

     1877     8047    6                           TYPE_37.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;

   8047 86 005766   040000 100400                    MLR     fill='040'O
        86 005767   000013 000036 62                 ADSC9   IO_BUF+11                cn=0,n=30
        86 005770   000005 000040 65                 ADSC9   TYPE_37+5                cn=0,n=32

     1878     8048    6                           END;

   8048 86 005771   005777 710000 86                 TRA     s:8052

     1879     8049    6                       ELSE DO;

     1880     8050    6                           TYPE_37.SUB_FIELD_NM = TPTR$ -> FR.FNAM;

   8050 86 005772   000004 220100                    LDX0    4,,PR0
        86 005773   000077 360003                    ANX0    63,DU
        86 005774   040000 100540                    MLR     fill='040'O
        86 005775   000006 000010                    ADSC9   6,,PR0                   cn=0,n=*X0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:262  
        86 005776   000005 000040 65                 ADSC9   TYPE_37+5                cn=0,n=32

     1881     8051    6                           END;

     1882     8052    5                       TYPE_37.SUB_RECORD_ST_NM = RC.RNAM;

   8052 86 005777   000000 470400 73                 LDP0    RC$
        86 006000   000000 720100                    LXL0    0,,PR0
        86 006001   000077 360003                    ANX0    63,DU
        86 006002   040000 100540                    MLR     fill='040'O
        86 006003   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        86 006004   000015 000040 65                 ADSC9   TYPE_37+13               cn=0,n=32

     1883     8053    5                       T9PTR$ = PINCRW(SSS$, TPTR$ -> FR.RCFRH);

   8053 86 006005   000060 471400 4                  LDP1    TPTR$
        86 006006   100005 220100                    LDX0    5,,PR1
        86 006007   000000 636010                    EAQ     0,X0
        86 006010   000000 036000 66                 ADLQ    SSS$
        86 006011   000076 756000 4                  STQ     T9PTR$

     1884     8054    5                       TYPE_37.SUB_RECORD_NM = T9PTR$ -> RC.RNAM;

   8054 86 006012   000076 473400 4                  LDP3    T9PTR$
        86 006013   300000 720100                    LXL0    0,,PR3
        86 006014   000077 360003                    ANX0    63,DU
        86 006015   040000 100540                    MLR     fill='040'O
        86 006016   300005 000010                    ADSC9   5,,PR3                   cn=0,n=*X0
        86 006017   000025 000040 65                 ADSC9   TYPE_37+21               cn=0,n=32

     1885     8055    5                       TYPE_37.RECORD_NAME = RC.RCID;

   8055 86 006020   000001 236100                    LDQ     1,,PR0
        86 006021   777777 376007                    ANQ     -1,DL
        86 006022   000001 756000 65                 STQ     TYPE_37+1

     1886     8056    5                       CALL UPUT('5*',ADDR(TYPE_37),32);
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:263  

   8056 86 006023   000142 236000 87                 LDQ     98
        86 006024   200030 756100                    STQ     COUNT1+2,,AUTO
        86 006025   000144 236000 87                 LDQ     100
        86 006026   200033 756100                    STQ     COUNT1+5,,AUTO
        86 006027   200030 634500                    EPPR4   COUNT1+2,,AUTO
        86 006030   200032 454500                    STP4    COUNT1+4,,AUTO
        86 006031   000067 236000 87                 LDQ     55
        86 006032   200031 756100                    STQ     COUNT1+3,,AUTO
        86 006033   200031 630500                    EPPR0   COUNT1+3,,AUTO
        86 006034   000006 631400 87                 EPPR1   6
        86 006035   000000 701000 xent               TSX1    UPUT
        86 006036   000000 011000                    NOP     0

     1887     8057    5                       CONTROL.NUM_FIELD_SET = CONTROL.NUM_FIELD_SET + 1;

   8057 86 006037   000002 235000 63                 LDA     CONTROL+2
        86 006040   000001 035007                    ADLA    1,DL
        86 006041   000002 755000 63                 STA     CONTROL+2

     1888     8058    5                       END;

     1889     8059    4                   END;

     1890     8060    3               FR$ = PINCRW(SSS$, FR.RCFRN);

   8060 86 006042   000000 470400 69                 LDP0    FR$
        86 006043   000004 720100                    LXL0    4,,PR0
        86 006044   000000 636010                    EAQ     0,X0
        86 006045   000000 036000 66                 ADLQ    SSS$
        86 006046   000000 756000 69                 STQ     FR$

     1891     8061    3               END;

   8061 86 006047   000000 116000 66                 CMPQ    SSS$
        86 006050   005453 601000 86                 TNZ     s:7977

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:264  
     1892     8062    2           RC$ = PINCRW(SSS$, RC.OARCN);

   8062 86 006051   000000 470400 73                 LDP0    RC$
        86 006052   000002 220100                    LDX0    2,,PR0
        86 006053   000000 636010                    EAQ     0,X0
        86 006054   000000 036000 66                 ADLQ    SSS$
        86 006055   000000 756000 73                 STQ     RC$

     1893     8063    2           END;

   8063 86 006056   000000 116000 66                 CMPQ    SSS$
        86 006057   005441 601000 86                 TNZ     s:7974

     1894     8064        /*
     1895     8065              Now connect up the SS records for the then thru clause in
     1896     8066            in the schema DDL.
     1897     8067        */
     1898     8068    1       LAST_SC_SAVE = OA.OASCN;

   8068 86 006060   000000 470400 75                 LDP0    OA$
        86 006061   000001 236100                    LDQ     1,,PR0
        86 006062   777777 376007                    ANQ     -1,DL
        86 006063   000066 756000 4                  STQ     LAST_SC_SAVE

     1899     8069    2       DO WHILE (LAST_SC_SAVE ~= 0);

   8069 86 006064   006363 600000 86                 TZE     s:8142

     1900     8070    2           SC$ = PINCRW(SSS$, LAST_SC_SAVE);

   8070 86 006065   000066 236000 4                  LDQ     LAST_SC_SAVE
        86 006066   000022 736000                    QLS     18
        86 006067   000000 036000 66                 ADLQ    SSS$
        86 006070   000000 756000 71                 STQ     SC$

     1901     8071    2           SC1$ = PINCRW(SC$ ,-2);

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:265  
   8071 86 006071   777776 036003                    ADLQ    -2,DU
        86 006072   000000 756000 72                 STQ     SC1$

     1902     8072    2           TPTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;

   8072 86 006073   000000 470400 72                 LDP0    SC1$
        86 006074   000001 236100                    LDQ     1,,PR0
        86 006075   000060 756000 4                  STQ     TPTR$

     1903     8073    2           LAST_SMSO_SAVE = SC.SCRSN;

   8073 86 006076   000000 471400 71                 LDP1    SC$
        86 006077   100002 236100                    LDQ     2,,PR1
        86 006100   000022 772000                    QRL     18
        86 006101   000072 756000 4                  STQ     LAST_SMSO_SAVE

     1904     8074    3           DO WHILE (LAST_SMSO_SAVE ~= 0);

   8074 86 006102   006354 600000 86                 TZE     s:8131

     1905     8075    3               RS$ = PINCRW(SSS$, LAST_SMSO_SAVE);

   8075 86 006103   000072 236000 4                  LDQ     LAST_SMSO_SAVE
        86 006104   000022 736000                    QLS     18
        86 006105   000000 036000 66                 ADLQ    SSS$
        86 006106   000000 756000 78                 STQ     RS$

     1906     8076    3               IF RS.DEF.TYPE = '000000100000'B /* SM */

   8076 86 006107   000000 470400 78                 LDP0    RS$
        86 006110   000000 236100                    LDQ     0,,PR0
        86 006111   777700 376003                    ANQ     -64,DU
        86 006112   004000 116003                    CMPQ    2048,DU
        86 006113   006347 601000 86                 TNZ     s:8129

     1907     8077    4               THEN DO;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:266  
     1908     8078    4                   LAST_SS = RS.RSSSN;

   8078 86 006114   000001 236100                    LDQ     1,,PR0
        86 006115   777777 376007                    ANQ     -1,DL
        86 006116   000071 756000 4                  STQ     LAST_SS

     1909     8079    5                   DO WHILE (LAST_SS ~= 0);

   8079 86 006117   006347 600000 86                 TZE     s:8129

     1910     8080    5                       SS$ = PINCRW(SSS$, LAST_SS);

   8080 86 006120   000071 236000 4                  LDQ     LAST_SS
        86 006121   000022 736000                    QLS     18
        86 006122   000000 036000 66                 ADLQ    SSS$
        86 006123   000000 756000 80                 STQ     SS$

     1911     8081    5                       I = SS.SSH;

   8081 86 006124   000000 470400 80                 LDP0    SS$
        86 006125   000002 236100                    LDQ     2,,PR0
        86 006126   000022 772000                    QRL     18
        86 006127   000052 756000 4                  STQ     I

     1912     8082    5                       CALL FINDD_6('****',I) ALTRET (DBCS_ERR);

   8082 86 006130   000145 630400 87                 EPPR0   101
        86 006131   000013 631400 87                 EPPR1   11
        86 006132   000000 701000 xent               TSX1    FINDD_6
        86 006133   007155 702000 86                 TSX2    DBCS_ERR

     1913     8083    5                       CALL FINDOS_6('SC-SOSM ') ALTRET (DBCS_ERR);

   8083 86 006134   000147 630400 87                 EPPR0   103
        86 006135   000000 631400 87                 EPPR1   0
        86 006136   000000 701000 xent               TSX1    FINDOS_6
        86 006137   007155 702000 86                 TSX2    DBCS_ERR
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:267  

     1914     8084    5                       IF TPTR$ -> SET_HASH.DBK = UWA.DIRECT_REF

   8084 86 006140   000060 470400 4                  LDP0    TPTR$
        86 006141   000013 236100                    LDQ     11,,PR0
        86 006142   000036 116000 54                 CMPQ    UWA+30
        86 006143   006150 601000 86                 TNZ     s:8090

     1915     8085    6                       THEN DO;

     1916     8086    6                           T5PTR$ = TPTR$;

   8086 86 006144   000060 236000 4                  LDQ     TPTR$
        86 006145   000056 756000 4                  STQ     T5PTR$

     1917     8087    6                           NEED_TYPE_36_DESC = '0'B;

   8087 86 006146   000000 450000 4                  STZ     NEED_TYPE_36_DESC

     1918     8088    6                           END;

   8088 86 006147   006176 710000 86                 TRA     s:8100

     1919     8089    6                       ELSE DO;

     1920     8090    6                           CALL FETCHOS_6('SN-SE   ') ALTRET (DBCS_ERR);

   8090 86 006150   000117 630400 87                 EPPR0   79
        86 006151   000000 631400 87                 EPPR1   0
        86 006152   000000 701000 xent               TSX1    FETCHOS_6
        86 006153   007155 702000 86                 TSX2    DBCS_ERR

     1921     8091    6                           STATUS = #SET_DEF;

   8091 86 006154   020000 236003                    LDQ     8192,DU
        86 006155   000055 756000 4                  STQ     STATUS

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:268  
     1922     8092    6                           ALLOCATE_END = 1;

   8092 86 006156   000001 235007                    LDA     1,DL
        86 006157   000000 755000 39                 STA     ALLOCATE_END

     1923     8093    6                           HASH_SCHEMA_NAME = '1'B;

   8093 86 006160   400000 236003                    LDQ     -131072,DU
        86 006161   000000 756000 60                 STQ     HASH_SCHEMA_NAME

     1924     8094    6                           CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,

   8094 86 006162   000151 630400 87                 EPPR0   105
        86 006163   000126 631400 87                 EPPR1   86
        86 006164   000000 701000 xent               TSX1    ZIG$HASH_IT
        86 006165   000000 011000                    NOP     0

     1925     8095    6                              ERROR_FLG,0,1,12,T5PTR$,STATUS);
     1926     8096    6                           ALLOCATE_END = 0;

   8096 86 006166   000000 450000 39                 STZ     ALLOCATE_END

     1927     8097    6                           IF ERROR_FLG = 0 THEN CALL ABORT;

   8097 86 006167   000062 235000 4                  LDA     ERROR_FLG
        86 006170   006174 601000 86                 TNZ     s:8098

   8097 86 006171   000005 631400 87                 EPPR1   5
        86 006172   000000 701000 xent               TSX1    ABORT
        86 006173   000000 011000                    NOP     0

     1928     8098    6                           NEED_TYPE_36_DESC = '1'B;

   8098 86 006174   400000 236003                    LDQ     -131072,DU
        86 006175   000000 756000 4                  STQ     NEED_TYPE_36_DESC

     1929     8099    6                           END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:269  

     1930     8100    5                       IF T5PTR$ -> SET_HASH.SO.DBK = -SS.SSH

   8100 86 006176   000000 470400 80                 LDP0    SS$
        86 006177   000002 236100                    LDQ     2,,PR0
        86 006200   000022 772000                    QRL     18
        86 006201   000044 676000 87                 ERQ     36
        86 006202   000001 036007                    ADLQ    1,DL
        86 006203   200030 756100                    STQ     COUNT1+2,,AUTO
        86 006204   000056 471400 4                  LDP1    T5PTR$
        86 006205   100014 236100                    LDQ     12,,PR1
        86 006206   000021 732000                    QRS     17
        86 006207   200030 116100                    CMPQ    COUNT1+2,,AUTO
        86 006210   006215 601000 86                 TNZ     s:8103

     1931     8101    5                       THEN SS.SSH = T5PTR$ -> SET_HASH.SO.OFFSET;

   8101 86 006211   100014 720100                    LXL0    12,,PR1
        86 006212   377777 360003                    ANX0    131071,DU
        86 006213   000002 740100                    STX0    2,,PR0
        86 006214   006257 710000 86                 TRA     s:8114

     1932     8102    6                       ELSE DO;

     1933     8103    6                           FOUND = '0'B;

   8103 86 006215   000073 450000 4                  STZ     FOUND

     1934     8104    7   SSH_LOOP:               DO I = 0 TO T5PTR$ -> SET_HASH.NUM_SM - 1;

   8104 86 006216   000052 450000 4     SSH_LOOP     STZ     I
        86 006217   006245 710000 86                 TRA     s:8111+3

     1935     8105    7                               IF T5PTR$ -> SET_HASH.SM_LIST.DBK(I) = -SS.SSH

   8105 86 006220   000000 470400 80                 LDP0    SS$
        86 006221   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:270  
        86 006222   000022 772000                    QRL     18
        86 006223   000044 676000 87                 ERQ     36
        86 006224   000001 036007                    ADLQ    1,DL
        86 006225   200030 756100                    STQ     COUNT1+2,,AUTO
        86 006226   000056 471400 4                  LDP1    T5PTR$
        86 006227   000052 720000 4                  LXL0    I
        86 006230   100016 236110                    LDQ     14,X0,PR1
        86 006231   000021 732000                    QRS     17
        86 006232   200030 116100                    CMPQ    COUNT1+2,,AUTO
        86 006233   006242 601000 86                 TNZ     s:8111

     1936     8106    8                               THEN DO;

     1937     8107    8                                   FOUND = '1'B;

   8107 86 006234   400000 236003                    LDQ     -131072,DU
        86 006235   000073 756000 4                  STQ     FOUND

     1938     8108    8                                   SS.SSH = T5PTR$ -> SET_HASH.SM_LIST.OFFSET(I);

   8108 86 006236   100016 721110                    LXL1    14,X0,PR1
        86 006237   377777 361003                    ANX1    131071,DU
        86 006240   000002 741100                    STX1    2,,PR0

     1939     8109    8                                   EXIT SSH_LOOP;

   8109 86 006241   006250 710000 86                 TRA     s:8112

     1940     8110    8                                   END;
     1941     8111    7                               END;

   8111 86 006242   000052 235000 4                  LDA     I
        86 006243   000001 035007                    ADLA    1,DL
        86 006244   000052 755000 4                  STA     I
        86 006245   000052 236000 4                  LDQ     I
        86 006246   100015 116100                    CMPQ    13,,PR1
        86 006247   006220 602000 86                 TNC     s:8105
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:271  

     1942     8112    6                           IF ~FOUND THEN CALL ABORT;

   8112 86 006250   000073 236000 4                  LDQ     FOUND
        86 006251   400000 376003                    ANQ     -131072,DU
        86 006252   400000 676003                    ERQ     -131072,DU
        86 006253   006257 600000 86                 TZE     s:8114

   8112 86 006254   000005 631400 87                 EPPR1   5
        86 006255   000000 701000 xent               TSX1    ABORT
        86 006256   000000 011000                    NOP     0

     1943     8113    6                           END;

     1944     8114    5                       IF NEED_TYPE_36_DESC

   8114 86 006257   000000 234000 4                  SZN     NEED_TYPE_36_DESC
        86 006260   006342 605000 86                 TPL     s:8126

     1945     8115    6                       THEN DO;

     1946     8116    6                           T8PTR$ = PINCRW(SSS$, T5PTR$ -> SET_HASH.SUB_OFF);

   8116 86 006261   000056 470400 4                  LDP0    T5PTR$
        86 006262   000012 720100                    LXL0    10,,PR0
        86 006263   000000 636010                    EAQ     0,X0
        86 006264   000000 036000 66                 ADLQ    SSS$
        86 006265   000075 756000 4                  STQ     T8PTR$

     1947     8117    6                           TYPE_36.SET_OWNER_NAME = T8PTR$ -> SC.SCID;

   8117 86 006266   000075 471400 4                  LDP1    T8PTR$
        86 006267   100002 236100                    LDQ     2,,PR1
        86 006270   777777 376007                    ANQ     -1,DL
        86 006271   000001 756000 64                 STQ     TYPE_36+1

     1948     8118    6                           TYPE_36.SET_NAME = SC.SCID;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:272  

   8118 86 006272   000000 473400 71                 LDP3    SC$
        86 006273   300002 236100                    LDQ     2,,PR3
        86 006274   777777 376007                    ANQ     -1,DL
        86 006275   000002 756000 64                 STQ     TYPE_36+2

     1949     8119    6                           TYPE_36.SUB_SET_OWNER_NM = T8PTR$ -> SC.SNAM;

   8119 86 006276   100000 721100                    LXL1    0,,PR1
        86 006277   000077 361003                    ANX1    63,DU
        86 006300   040000 100540                    MLR     fill='040'O
        86 006301   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        86 006302   000005 000040 64                 ADSC9   TYPE_36+5                cn=0,n=32

     1950     8120    6                           TYPE_36.SUB_SET_NM = SC.SNAM;

   8120 86 006303   300000 720100                    LXL0    0,,PR3
        86 006304   000077 360003                    ANX0    63,DU
        86 006305   040000 100540                    MLR     fill='040'O
        86 006306   300003 000010                    ADSC9   3,,PR3                   cn=0,n=*X0
        86 006307   000015 000040 64                 ADSC9   TYPE_36+13               cn=0,n=32

     1951     8121    6                           T8PTR$ = PINCRW(SSS$, RS.RCRSH);

   8121 86 006310   000000 474400 78                 LDP4    RS$
        86 006311   400003 220100                    LDX0    3,,PR4
        86 006312   000000 636010                    EAQ     0,X0
        86 006313   000000 036000 66                 ADLQ    SSS$
        86 006314   000075 756000 4                  STQ     T8PTR$

     1952     8122    6                           TYPE_36.MEM_RECORD_NM = T8PTR$ -> RC.RNAM;

   8122 86 006315   000075 471400 4                  LDP1    T8PTR$
        86 006316   100000 721100                    LXL1    0,,PR1
        86 006317   000077 361003                    ANX1    63,DU
        86 006320   040000 100540                    MLR     fill='040'O
        86 006321   100005 000011                    ADSC9   5,,PR1                   cn=0,n=*X1
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:273  
        86 006322   000025 000040 64                 ADSC9   TYPE_36+21               cn=0,n=32

     1953     8123    6                           CONTROL.NUM_SET_SET_DESC = CONTROL.NUM_SET_SET_DESC + 1;

   8123 86 006323   000057 235000 63                 LDA     CONTROL+47
        86 006324   000001 035007                    ADLA    1,DL
        86 006325   000057 755000 63                 STA     CONTROL+47

     1954     8124    6                           CALL UPUT('5*',ADDR(TYPE_36),32);

   8124 86 006326   000161 236000 87                 LDQ     113
        86 006327   200030 756100                    STQ     COUNT1+2,,AUTO
        86 006330   000144 236000 87                 LDQ     100
        86 006331   200033 756100                    STQ     COUNT1+5,,AUTO
        86 006332   200030 635500                    EPPR5   COUNT1+2,,AUTO
        86 006333   200032 455500                    STP5    COUNT1+4,,AUTO
        86 006334   000067 236000 87                 LDQ     55
        86 006335   200031 756100                    STQ     COUNT1+3,,AUTO
        86 006336   200031 630500                    EPPR0   COUNT1+3,,AUTO
        86 006337   000006 631400 87                 EPPR1   6
        86 006340   000000 701000 xent               TSX1    UPUT
        86 006341   000000 011000                    NOP     0

     1955     8125    6                           END;

     1956     8126    5                       LAST_SS = SS.RSSSN;

   8126 86 006342   000000 470400 80                 LDP0    SS$
        86 006343   000001 236100                    LDQ     1,,PR0
        86 006344   777777 376007                    ANQ     -1,DL
        86 006345   000071 756000 4                  STQ     LAST_SS

     1957     8127    5                       END;

   8127 86 006346   006120 601000 86                 TNZ     s:8080

     1958     8128    4                   END;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:274  

     1959     8129    3               LAST_SMSO_SAVE = RS.SCRSN;

   8129 86 006347   000000 470400 78                 LDP0    RS$
        86 006350   000002 236100                    LDQ     2,,PR0
        86 006351   000022 772000                    QRL     18
        86 006352   000072 756000 4                  STQ     LAST_SMSO_SAVE

     1960     8130    3               END;

   8130 86 006353   006103 601000 86                 TNZ     s:8075

     1961     8131    2           ADDR(SC1.XXDPN) -> WORD36 = 0;

   8131 86 006354   000000 470400 72                 LDP0    SC1$
        86 006355   000001 450100                    STZ     1,,PR0

     1962     8132    2           LAST_SC_SAVE = SC.OASCN;

   8132 86 006356   000000 471400 71                 LDP1    SC$
        86 006357   100001 236100                    LDQ     1,,PR1
        86 006360   777777 376007                    ANQ     -1,DL
        86 006361   000066 756000 4                  STQ     LAST_SC_SAVE

     1963     8133    2           END;

   8133 86 006362   006065 601000 86                 TNZ     s:8070

     1964     8134        /*
     1965     8135              Zero out some temp things needed bye DBACS.
     1966     8136        */
     1967     8137        /*
     1968     8138              If fortran then close up the UWA and RVA part of the subschema
     1969     8139            and then in call ZIG$V_DESC to write out the UWA, RVA, and IA for
     1970     8140            the fortran subschema.
     1971     8141        */
     1972     8142    1       IF SUB_LANGUAGE = #FORTRAN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:275  

   8142 86 006363   000000 235000 57                 LDA     SUB_LANGUAGE
        86 006364   000002 115007                    CMPA    2,DL
        86 006365   006612 601000 86                 TNZ     s:8191

     1973     8143    2       THEN DO;

     1974     8144    2           SPECIAL_KEY = UWA_KEY;

   8144 86 006366   000000 237000 44                 LDAQ    UWA_KEY
        86 006367   000000 757000 40                 STAQ    SUBSCHEMA_KEY

     1975     8145    2           CALL ZIG$SS_RVAR;

   8145 86 006370   000005 631400 87                 EPPR1   5
        86 006371   000000 701000 xent               TSX1    ZIG$SS_RVAR
        86 006372   000000 011000                    NOP     0

     1976     8146    2           IF ERROR_IO ~= 0 THEN CALL ABORT;

   8146 86 006373   000000 235000 42                 LDA     ERROR_IO
        86 006374   006400 600000 86                 TZE     s:8147

   8146 86 006375   000005 631400 87                 EPPR1   5
        86 006376   000000 701000 xent               TSX1    ABORT
        86 006377   000000 011000                    NOP     0

     1977     8147    2           CALL INDEX1(I,',',LIST_STRING) ALTRET(NO_WRITE_AGAIN);

   8147 86 006400   000000 124400                    SCM     mask='000'O
        86 006401   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128
        86 006402   000027 000001 87                 ADSC9   23                       cn=0,n=1
        86 006403   000052 000000 4                  ARG     I
        86 006404   006421 606400 86                 TTN     NO_WRITE_AGAIN

     1978     8148    2           CALL INSERT(LIST_STRING,I,1,' ');

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:276  
   8148 86 006405   000052 235000 4                  LDA     I
        86 006406   040005 100400                    MLR     fill='040'O
        86 006407   000021 000001 87                 ADSC9   17                       cn=0,n=1
        86 006410   000000 000001 16                 ADSC9   LIST_STRING,A            cn=0,n=1

     1979     8149    2           CALL ZIG$SS_WVAR;

   8149 86 006411   000005 631400 87                 EPPR1   5
        86 006412   000000 701000 xent               TSX1    ZIG$SS_WVAR
        86 006413   000000 011000                    NOP     0

     1980     8150    2           IF ERROR_IO ~= 0 THEN CALL ABORT;

   8150 86 006414   000000 235000 42                 LDA     ERROR_IO
        86 006415   006421 600000 86                 TZE     NO_WRITE_AGAIN

   8150 86 006416   000005 631400 87                 EPPR1   5
        86 006417   000000 701000 xent               TSX1    ABORT
        86 006420   000000 011000                    NOP     0

     1981     8151    2   NO_WRITE_AGAIN:
     1982     8152    2           LIST_STRING = EOFC;

   8152 86 006421   040000 100400       NO_WRITE_AG* MLR     fill='040'O
        86 006422   000000 000200 9                  ADSC9   EOFC                     cn=0,n=128
        86 006423   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1983     8153    2           CALL WRITE_UWA;

   8153 86 006424   002456 701000 86                 TSX1    WRITE_UWA
        86 006425   000000 011000                    NOP     0

     1984     8154    2           SAVE_LAST_UWA = UWA_KEY.NUMBER_OF;

   8154 86 006426   000001 235000 44                 LDA     UWA_KEY+1
        86 006427   000164 755000 4                  STA     SAVE_LAST_UWA

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:277  
     1985     8155    2           UWA_KEY.NUMBER_OF = NEXT_UWA_SECOND_HALF;

   8155 86 006430   000000 236000 45                 LDQ     NEXT_UWA_SECOND_HALF
        86 006431   000001 756000 44                 STQ     UWA_KEY+1

     1986     8156    2           CALL WRITE_UWA;

   8156 86 006432   002456 701000 86                 TSX1    WRITE_UWA
        86 006433   000000 011000                    NOP     0

     1987     8157    2           NEXT_UWA_SECOND_HALF = UWA_KEY.NUMBER_OF;

   8157 86 006434   000001 235000 44                 LDA     UWA_KEY+1
        86 006435   000000 755000 45                 STA     NEXT_UWA_SECOND_HALF

     1988     8158    2           UWA_KEY.NUMBER_OF = SAVE_LAST_UWA;

   8158 86 006436   000164 236000 4                  LDQ     SAVE_LAST_UWA
        86 006437   000001 756000 44                 STQ     UWA_KEY+1

     1989     8159    2           LIST_STRING = '     +            12O000004000000/';

   8159 86 006440   040000 100400                    MLR     fill='040'O
        86 006441   001722 000042 12                 ADSC9   ONE_CHANGE+380           cn=0,n=34
        86 006442   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

     1990     8160    2           CALL JUST_WRITE_RVA;

   8160 86 006443   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 006444   000000 011000                    NOP     0

     1991     8161    2           LIST_STRING = EOFC;

   8161 86 006445   040000 100400                    MLR     fill='040'O
        86 006446   000000 000200 9                  ADSC9   EOFC                     cn=0,n=128
        86 006447   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:278  
     1992     8162    2           CALL JUST_WRITE_RVA;

   8162 86 006450   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 006451   000000 011000                    NOP     0

     1993     8163    2           SAVE_LAST_RVA = RVA_KEY.NUMBER_OF;

   8163 86 006452   000001 235000 46                 LDA     RVA_KEY+1
        86 006453   000165 755000 4                  STA     SAVE_LAST_RVA

     1994     8164    2           RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;

   8164 86 006454   000000 236000 48                 LDQ     NEXT_RVA_SECOND_HALF
        86 006455   000001 756000 46                 STQ     RVA_KEY+1

     1995     8165    2           CALL JUST_WRITE_RVA;

   8165 86 006456   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 006457   000000 011000                    NOP     0

     1996     8166    2           NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;

   8166 86 006460   000001 235000 46                 LDA     RVA_KEY+1
        86 006461   000000 755000 48                 STA     NEXT_RVA_SECOND_HALF

     1997     8167    2           RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;

   8167 86 006462   000165 236000 4                  LDQ     SAVE_LAST_RVA
        86 006463   000001 756000 46                 STQ     RVA_KEY+1

     1998     8168    2           CALL SET_FIELD_NUM(1,SAVE_LAST_RVA-3);

   8168 86 006464   000003 136007                    SBLQ    3,DL
        86 006465   200030 756100                    STQ     COUNT1+2,,AUTO
        86 006466   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 006467   200033 450500                    STP0    COUNT1+5,,AUTO
        86 006470   000010 236000 87                 LDQ     8
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:279  
        86 006471   200032 756100                    STQ     COUNT1+4,,AUTO
        86 006472   200032 630500                    EPPR0   COUNT1+4,,AUTO
        86 006473   000013 631400 87                 EPPR1   11
        86 006474   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 006475   000000 011000                    NOP     0

     1999     8169    2           CALL INSERT(RVA_NAME,0,1,' ');

   8169 86 006476   040000 236003                    LDQ     16384,DU
        86 006477   000162 552040 4                  STBQ    RVA_NAME,'40'O

     2000     8170    2           CALL CONCAT(TEMP_WORD,RVA_NAME,'0:',SUBSTR(FIELD1.TEXT1,0,

   8170 86 006500   000000 236000 18                 LDQ     FIELD1
        86 006501   000033 772000                    QRL     27
        86 006502   000000 620006                    EAX0    0,QL
        86 006503   000162 237000 4                  LDAQ    RVA_NAME
        86 006504   000001 755000 4                  STA     TEMP_WORD
        86 006505   000002 756000 4                  STQ     TEMP_WORD+1
        86 006506   001733 221000 12                 LDX1    ONE_CHANGE+389
        86 006507   000003 741000 4                  STX1    TEMP_WORD+2
        86 006510   040000 100440                    MLR     fill='040'O
        86 006511   000000 200010 18                 ADSC9   FIELD1                   cn=1,n=*X0
        86 006512   000003 400024 4                  ADSC9   TEMP_WORD+2              cn=2,n=20
        86 006513   000000 636010                    EAQ     0,X0
        86 006514   000022 772000                    QRL     18
        86 006515   000024 116007                    CMPQ    20,DL
        86 006516   006527 603000 86                 TRC     s:8172
        86 006517   200030 740100                    STX0    COUNT1+2,,AUTO
        86 006520   777753 620010                    EAX0    -21,X0
        86 006521   777777 660003                    ERX0    -1,DU
        86 006522   200030 236100                    LDQ     COUNT1+2,,AUTO
        86 006523   000022 772000                    QRL     18
        86 006524   040046 100400                    MLR     fill='040'O
        86 006525   000162 000001 87                 ADSC9   114                      cn=0,n=1
        86 006526   000003 400010 4                  ADSC9   TEMP_WORD+2,Q            cn=2,n=*X0

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:280  
     2001     8171    2              FIELD1.COUNT1),')');
     2002     8172    2           CALL CONCAT(LIST_STRING,'       COMMON /R',SUBSCHEMA_NAME_4,

   8172 86 006527   040000 100400                    MLR     fill='040'O
        86 006530   001734 000020 12                 ADSC9   ONE_CHANGE+390           cn=0,n=16
        86 006531   000000 000020 16                 ADSC9   LIST_STRING              cn=0,n=16
        86 006532   000000 236000 26                 LDQ     SUBSCHEMA_NAME_4
        86 006533   000004 756000 16                 STQ     LIST_STRING+4
        86 006534   001740 220000 12                 LDX0    ONE_CHANGE+394
        86 006535   000005 740000 16                 STX0    LIST_STRING+5
        86 006536   040000 100400                    MLR     fill='040'O
        86 006537   000001 000036 4                  ADSC9   TEMP_WORD                cn=0,n=30
        86 006540   000005 400152 16                 ADSC9   LIST_STRING+5            cn=2,n=106

     2003     8173    2              '/ ',TEMP_WORD);
     2004     8174    2           RVA_KEY.NUMBER_OF = 0;

   8174 86 006541   000001 450000 46                 STZ     RVA_KEY+1

     2005     8175    2           CALL JUST_WRITE_RVA;

   8175 86 006542   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 006543   000000 011000                    NOP     0

     2006     8176    2           CALL GET_OCTAL_NUM(18,SAVE_LAST_RVA - 3);

   8176 86 006544   000165 235000 4                  LDA     SAVE_LAST_RVA
        86 006545   000003 135007                    SBLA    3,DL
        86 006546   200034 755100                    STA     COUNT1+6,,AUTO
        86 006547   200034 630500                    EPPR0   COUNT1+6,,AUTO
        86 006550   200024 450500                    STP0    @LEN+1,,AUTO
        86 006551   000053 236000 87                 LDQ     43
        86 006552   200023 756100                    STQ     @ID+3,,AUTO
        86 006553   002554 701000 86                 TSX1    GET_OCTAL_NUM
        86 006554   000000 011000                    NOP     0

     2007     8177    2           CALL CONCAT(TEMP_WORD,'/12O',SUBSTR(FIELD1.TEXT1,0,6),'000000,');
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:281  

   8177 86 006555   001741 236000 12                 LDQ     ONE_CHANGE+395
        86 006556   000001 756000 4                  STQ     TEMP_WORD
        86 006557   040000 100400                    MLR     fill='040'O
        86 006560   000000 200006 18                 ADSC9   FIELD1                   cn=1,n=6
        86 006561   000002 000006 4                  ADSC9   TEMP_WORD+1              cn=0,n=6
        86 006562   040000 100400                    MLR     fill='040'O
        86 006563   001742 000007 12                 ADSC9   ONE_CHANGE+396           cn=0,n=7
        86 006564   000003 400024 4                  ADSC9   TEMP_WORD+2              cn=2,n=20

     2008     8178    2           CALL CONCAT(LIST_STRING,'      DATA R',SUBSCHEMA_NAME_4,

   8178 86 006565   040000 100400                    MLR     fill='040'O
        86 006566   001744 000014 12                 ADSC9   ONE_CHANGE+398           cn=0,n=12
        86 006567   000000 000014 16                 ADSC9   LIST_STRING              cn=0,n=12
        86 006570   000000 236000 26                 LDQ     SUBSCHEMA_NAME_4
        86 006571   000003 756000 16                 STQ     LIST_STRING+3
        86 006572   040000 100400                    MLR     fill='040'O
        86 006573   000001 000036 4                  ADSC9   TEMP_WORD                cn=0,n=30
        86 006574   000004 000160 16                 ADSC9   LIST_STRING+4            cn=0,n=112

     2009     8179    2              TEMP_WORD);
     2010     8180    2           CALL JUST_WRITE_RVA;

   8180 86 006575   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 006576   000000 011000                    NOP     0

     2011     8181    2           RVA_KEY.NUMBER_OF = NEXT_RVA_SECOND_HALF;

   8181 86 006577   000000 235000 48                 LDA     NEXT_RVA_SECOND_HALF
        86 006600   000001 755000 46                 STA     RVA_KEY+1

     2012     8182    2           LIST_STRING = EOFC;

   8182 86 006601   040000 100400                    MLR     fill='040'O
        86 006602   000000 000200 9                  ADSC9   EOFC                     cn=0,n=128
        86 006603   000000 000200 16                 ADSC9   LIST_STRING              cn=0,n=128
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:282  

     2013     8183    2           CALL JUST_WRITE_RVA;

   8183 86 006604   002534 701000 86                 TSX1    JUST_WRITE_RVA
        86 006605   000000 011000                    NOP     0

     2014     8184    2           NEXT_RVA_SECOND_HALF = RVA_KEY.NUMBER_OF;

   8184 86 006606   000001 235000 46                 LDA     RVA_KEY+1
        86 006607   000000 755000 48                 STA     NEXT_RVA_SECOND_HALF

     2015     8185    2           RVA_KEY.NUMBER_OF = SAVE_LAST_RVA;

   8185 86 006610   000165 236000 4                  LDQ     SAVE_LAST_RVA
        86 006611   000001 756000 46                 STQ     RVA_KEY+1

     2016     8186        /*
     2017     8187              The RVA and UWA are now written out into the subschema file
     2018     8188            so now call the writer for the fortran include file.
     2019     8189        */
     2020     8190    2           END;

     2021     8191    1       NUM_PROHIB = 0;

   8191 86 006612   000000 450000 3                  STZ     NUM_PROHIB

     2022     8192    1       IF NO_ERRORS

   8192 86 006613   000000 234000 2                  SZN     NO_ERRORS
        86 006614   006631 605000 86                 TPL     s:8204

     2023     8193    2       THEN DO;

     2024     8194    2           IF VALIDS.XLST

   8194 86 006615   000000 236000 31                 LDQ     VALIDS
        86 006616   040000 316003                    CANQ    16384,DU
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:283  
        86 006617   006623 600000 86                 TZE     s:8196

     2025     8195    2           THEN CALL ZIG$V_PROHIB;

   8195 86 006620   000005 631400 87                 EPPR1   5
        86 006621   000000 701000 xent               TSX1    ZIG$V_PROHIB
        86 006622   000000 011000                    NOP     0

     2026     8196    2           IF VALIDS.ICLST

   8196 86 006623   000000 236000 31                 LDQ     VALIDS
        86 006624   020000 316003                    CANQ    8192,DU
        86 006625   006631 600000 86                 TZE     s:8204

     2027     8197    2           THEN CALL ZIG$V_PERMIT;

   8197 86 006626   000005 631400 87                 EPPR1   5
        86 006627   000000 701000 xent               TSX1    ZIG$V_PERMIT
        86 006630   000000 011000                    NOP     0

     2028     8198    2           END;

     2029     8199        /*
     2030     8200              Every thing is done.
     2031     8201            the schema subset is pointed to by the array of pointers
     2032     8202            SUBSET$ and all diagonistes have been written out.
     2033     8203        */
     2034     8204    1       CALL SET_FIELDS(1,30,CONTROL.SUBSCHEMA_NAME);

   8204 86 006631   000163 630400 87                 EPPR0   115
        86 006632   000006 631400 87                 EPPR1   6
        86 006633   000000 701000 xent               TSX1    SET_FIELDS
        86 006634   000000 011000                    NOP     0

     2035     8205    1       CALL SET_FIELDS(2,30,CONTROL.SCHEMA_NAME);

   8205 86 006635   000166 630400 87                 EPPR0   118
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:284  
        86 006636   000006 631400 87                 EPPR1   6
        86 006637   000000 701000 xent               TSX1    SET_FIELDS
        86 006640   000000 011000                    NOP     0

     2036     8206    1       IF NO_ERRORS

   8206 86 006641   000000 234000 2                  SZN     NO_ERRORS
        86 006642   006655 605000 86                 TPL     s:8217

     2037     8207    2       THEN DO;

     2038     8208    2           CONTROL.VALIDATION_STATUS = 30;

   8208 86 006643   000036 235007                    LDA     30,DL
        86 006644   000000 755000 63                 STA     CONTROL

     2039     8209    2           CALL ZIG$FIN_AS;

   8209 86 006645   000005 631400 87                 EPPR1   5
        86 006646   000000 701000 xent               TSX1    ZIG$FIN_AS
        86 006647   000000 011000                    NOP     0

     2040     8210    2           CALL INFO_ONLY(%VALIDATION_OK);

   8210 86 006650   000172 630400 87                 EPPR0   122
        86 006651   000000 631400 87                 EPPR1   0
        86 006652   000000 701000 xent               TSX1    INFO_ONLY
        86 006653   000000 011000                    NOP     0

     2041     8211        /*E*     ERROR:    ZIG-VALIDATION_OK-C
     2042     8212        MESSAGE: Validation for the subschema %U1
     2043     8213                 ( schema %U2 ) had no errors.
     2044     8214        */
     2045     8215    2           END;

   8215 86 006654   006667 710000 86                 TRA     s:8228

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:285  
     2046     8216    2       ELSE DO;

     2047     8217    2           CALL SET_FIELD_NUM(3,NUM_ERROR_MSG);

   8217 86 006655   000173 630400 87                 EPPR0   123
        86 006656   000013 631400 87                 EPPR1   11
        86 006657   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 006660   000000 011000                    NOP     0

     2048     8218    2           CALL ERROR(%VALIDATION_NOT_OK);

   8218 86 006661   000176 630400 87                 EPPR0   126
        86 006662   000000 631400 87                 EPPR1   0
        86 006663   000000 701000 xent               TSX1    ERROR
        86 006664   000000 011000                    NOP     0

     2049     8219        /*E*     ERROR:    ZIG-VALIDATION_NOT_OK-C
     2050     8220        MESSAGE: Validation for the subschema %U1
     2051     8221                 ( schema %U2 ) had %U3 errors.
     2052     8222                 The subschema %U1 cannot be used in
     2053     8223                 any DATA BASE programs until the errors have
     2054     8224                 been corrected.
     2055     8225        */
     2056     8226    2           CONTROL.VALIDATION_STATUS = -1;

   8226 86 006665   000001 335007                    LCA     1,DL
        86 006666   000000 755000 63                 STA     CONTROL

     2057     8227    2           END;

     2058     8228    1       IF NUM_WARN_MSG - NUM_PROHIB ~= 0

   8228 86 006667   000000 236000 38                 LDQ     NUM_WARN_MSG
        86 006670   000000 136000 3                  SBLQ    NUM_PROHIB
        86 006671   006711 600000 86                 TZE     s:8236

     2059     8229    2       THEN DO;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:286  

     2060     8230    2           CALL SET_FIELD_NUM(1,NUM_WARN_MSG - NUM_PROHIB);

   8230 86 006672   000000 236000 38                 LDQ     NUM_WARN_MSG
        86 006673   000000 136000 3                  SBLQ    NUM_PROHIB
        86 006674   200030 756100                    STQ     COUNT1+2,,AUTO
        86 006675   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 006676   200033 450500                    STP0    COUNT1+5,,AUTO
        86 006677   000010 236000 87                 LDQ     8
        86 006700   200032 756100                    STQ     COUNT1+4,,AUTO
        86 006701   200032 630500                    EPPR0   COUNT1+4,,AUTO
        86 006702   000013 631400 87                 EPPR1   11
        86 006703   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 006704   000000 011000                    NOP     0

     2061     8231    2           CALL INFO_ONLY(%VALIDATION_WARN_MSG);

   8231 86 006705   000200 630400 87                 EPPR0   128
        86 006706   000000 631400 87                 EPPR1   0
        86 006707   000000 701000 xent               TSX1    INFO_ONLY
        86 006710   000000 011000                    NOP     0

     2062     8232        /*E*     ERROR:    ZIG-VALIDATION_WARN_MSG-C
     2063     8233        MESSAGE: %U1 Warning messages for this validation.
     2064     8234        */
     2065     8235    2           END;

     2066     8236    1       IF NUM_PROHIB ~= 0

   8236 86 006711   000000 235000 3                  LDA     NUM_PROHIB
        86 006712   006723 600000 86                 TZE     s:8244

     2067     8237    2       THEN DO;

     2068     8238    2           CALL SET_FIELD_NUM(1,NUM_PROHIB);

   8238 86 006713   000201 630400 87                 EPPR0   129
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:287  
        86 006714   000013 631400 87                 EPPR1   11
        86 006715   000000 701000 xent               TSX1    SET_FIELD_NUM
        86 006716   000000 011000                    NOP     0

     2069     8239    2           CALL INFO_ONLY(%VALIDATION_PROHIB_MSG);

   8239 86 006717   000204 630400 87                 EPPR0   132
        86 006720   000000 631400 87                 EPPR1   0
        86 006721   000000 701000 xent               TSX1    INFO_ONLY
        86 006722   000000 011000                    NOP     0

     2070     8240        /*E*     ERROR:    ZIG-VALIDATION_PROHIB_MSG-C
     2071     8241        MESSAGE: %U1 Prohibited messages for this validation.
     2072     8242        */
     2073     8243    2           END;

     2074     8244    1       CALL WRITSF(CUR_EXT_NAME_SEG,EOFC);

   8244 86 006723   000205 630400 87                 EPPR0   133
        86 006724   000013 631400 87                 EPPR1   11
        86 006725   000000 701000 xent               TSX1    WRITSF
        86 006726   000000 011000                    NOP     0

     2075     8245    1       CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;

   8245 86 006727   000000 235000 23                 LDA     CUR_EXT_NAME_SEG
        86 006730   000001 035007                    ADLA    1,DL
        86 006731   000000 755000 23                 STA     CUR_EXT_NAME_SEG

     2076     8246    1       CALL WRITSF(CUR_EXT_NAME_SEG,EOFC);

   8246 86 006732   000205 630400 87                 EPPR0   133
        86 006733   000013 631400 87                 EPPR1   11
        86 006734   000000 701000 xent               TSX1    WRITSF
        86 006735   000000 011000                    NOP     0

     2077     8247    1       CONTROL.NEXT_AVAILABLE_RECORD = CUR_EXT_NAME_SEG + 1;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:288  

   8247 86 006736   000000 235000 23                 LDA     CUR_EXT_NAME_SEG
        86 006737   000001 035007                    ADLA    1,DL
        86 006740   000072 755000 63                 STA     CONTROL+58

     2078     8248    1       CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;

   8248 86 006741   000000 755000 23                 STA     CUR_EXT_NAME_SEG

     2079     8249    1       CALL UCLOSE ('5*');

   8249 86 006742   000207 630400 87                 EPPR0   135
        86 006743   000000 631400 87                 EPPR1   0
        86 006744   000000 701000 xent               TSX1    UCLOSE
        86 006745   000000 011000                    NOP     0

     2080     8250    1       CALL UOPEN ('5*',0);

   8250 86 006746   000210 630400 87                 EPPR0   136
        86 006747   000013 631400 87                 EPPR1   11
        86 006750   000000 701000 xent               TSX1    UOPEN
        86 006751   000000 011000                    NOP     0

     2081     8251    1       CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);

   8251 86 006752   000213 630400 87                 EPPR0   139
        86 006753   000212 631400 87                 EPPR1   138
        86 006754   000000 701000 xent               TSX1    UGET
        86 006755   000000 011000                    NOP     0

     2082     8252    2       DO WHILE (EOF = 0);

   8252 86 006756   000160 235000 4                  LDA     EOF
        86 006757   007000 601000 86                 TNZ     s:8257

     2083     8253    2           CALL WRITSF(CUR_EXT_NAME_SEG,BUFFER_TEMP);

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:289  
   8253 86 006760   000117 236000 4                  LDQ     DESCPTR
        86 006761   000031 235000 87                 LDA     25
        86 006762   200030 757100                    STAQ    COUNT1+2,,AUTO
        86 006763   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 006764   000013 631400 87                 EPPR1   11
        86 006765   000000 701000 xent               TSX1    WRITSF
        86 006766   000000 011000                    NOP     0

     2084     8254    2           CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;

   8254 86 006767   000000 235000 23                 LDA     CUR_EXT_NAME_SEG
        86 006770   000001 035007                    ADLA    1,DL
        86 006771   000000 755000 23                 STA     CUR_EXT_NAME_SEG

     2085     8255    2           CALL UGET('5*',DESCPTR,EOF,BUFFER_SIZE);

   8255 86 006772   000213 630400 87                 EPPR0   139
        86 006773   000212 631400 87                 EPPR1   138
        86 006774   000000 701000 xent               TSX1    UGET
        86 006775   000000 011000                    NOP     0

     2086     8256    2           END;

   8256 86 006776   000160 235000 4                  LDA     EOF
        86 006777   006760 600000 86                 TZE     s:8253

     2087     8257    1       CALL UCLOSE('5*');

   8257 86 007000   000207 630400 87                 EPPR0   135
        86 007001   000000 631400 87                 EPPR1   0
        86 007002   000000 701000 xent               TSX1    UCLOSE
        86 007003   000000 011000                    NOP     0

     2088     8258        /*
     2089     8259              Write out the type 34, 35, and 36 descriptors that should be in
     2090     8260            the name ext segment but COBOL can't handle them there so we have
     2091     8261            to fool cobol and write out a dumn end of segment when the segment
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:290  
     2092     8262            isn't ended yet.
     2093     8263        */
     2094     8264    1       CALL WRITSF(CUR_EXT_NAME_SEG,EOFC);

   8264 86 007004   000205 630400 87                 EPPR0   133
        86 007005   000013 631400 87                 EPPR1   11
        86 007006   000000 701000 xent               TSX1    WRITSF
        86 007007   000000 011000                    NOP     0

     2095     8265    1       CONTROL.NEXT_AVAILABLE_RECORD = CUR_EXT_NAME_SEG + 1;

   8265 86 007010   000000 235000 23                 LDA     CUR_EXT_NAME_SEG
        86 007011   000001 035007                    ADLA    1,DL
        86 007012   000072 755000 63                 STA     CONTROL+58

     2096     8266        /*
     2097     8267              End the extened name segment and set the next available record
     2098     8268            to one past there.
     2099     8269        */
     2100     8270    1       CALL ZIG$G_DYN_MEM_6(0,TEMP_PTR$);

   8270 86 007013   200010 630500                    EPPR0   TEMP_PTR$,,AUTO
        86 007014   200031 450500                    STP0    COUNT1+3,,AUTO
        86 007015   000075 236000 87                 LDQ     61
        86 007016   200030 756100                    STQ     COUNT1+2,,AUTO
        86 007017   200030 630500                    EPPR0   COUNT1+2,,AUTO
        86 007020   000013 631400 87                 EPPR1   11
        86 007021   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        86 007022   000000 011000                    NOP     0

     2101     8271    1       OA.SZISS = MEMORY_USED_SSS;

   8271 86 007023   000000 720000 21                 LXL0    MEMORY_USED_SSS
        86 007024   000000 470400 75                 LDP0    OA$
        86 007025   000000 440100                    SXL0    0,,PR0

     2102     8272    1       OA.UWSSZ = OA.SZISS;
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:291  

   8272 86 007026   000000 470400 75                 LDP0    OA$
        86 007027   000000 720100                    LXL0    0,,PR0
        86 007030   000002 440100                    SXL0    2,,PR0

     2103     8273    1       OA.KPASZ = (LARGEST_KEY+3)/4;

   8273 86 007031   000000 236000 22                 LDQ     LARGEST_KEY
        86 007032   000003 036007                    ADLQ    3,DL
        86 007033   000002 772000                    QRL     2
        86 007034   000000 621006                    EAX1    0,QL
        86 007035   000022 741100                    STX1    18,,PR0

     2104     8274    1       OA.LRSZ = (OA.LRSZ+3)/4;

   8274 86 007036   000017 236100                    LDQ     15,,PR0
        86 007037   777777 376007                    ANQ     -1,DL
        86 007040   000003 036007                    ADLQ    3,DL
        86 007041   000002 772000                    QRL     2
        86 007042   000000 622006                    EAX2    0,QL
        86 007043   000017 442100                    SXL2    15,,PR0

     2105     8275    1       OA.CIWSOF = OA.CSZ + %CUR_BASE_SIZE;

   8275 86 007044   000017 223100                    LDX3    15,,PR0
        86 007045   001223 624013                    EAX4    659,X3
        86 007046   000022 444100                    SXL4    18,,PR0

     2106     8276    1       OA.CSZ = OA.CSZ + OA.KPASZ + 1;

   8276 86 007047   000022 236100                    LDQ     18,,PR0
        86 007050   000022 772000                    QRL     18
        86 007051   200030 756100                    STQ     COUNT1+2,,AUTO
        86 007052   000017 236100                    LDQ     15,,PR0
        86 007053   000022 772000                    QRL     18
        86 007054   200030 036100                    ADLQ    COUNT1+2,,AUTO
        86 007055   000001 620006                    EAX0    1,QL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:292  
        86 007056   000017 740100                    STX0    15,,PR0

     2107     8277    1       IF MOD(OA.UWSZ,4) ~= 0

   8277 86 007057   000020 236100                    LDQ     16,,PR0
        86 007060   000022 772000                    QRL     18
        86 007061   000003 376007                    ANQ     3,DL
        86 007062   007077 600000 86                 TZE     s:8279

     2108     8278    1       THEN OA.UWSZ = (OA.UWSZ + 4 - MOD(OA.UWSZ,4))/4;

   8278 86 007063   000020 236100                    LDQ     16,,PR0
        86 007064   000022 772000                    QRL     18
        86 007065   000003 376007                    ANQ     3,DL
        86 007066   200030 756100                    STQ     COUNT1+2,,AUTO
        86 007067   000020 236100                    LDQ     16,,PR0
        86 007070   000022 772000                    QRL     18
        86 007071   200030 136100                    SBLQ    COUNT1+2,,AUTO
        86 007072   000004 036007                    ADLQ    4,DL
        86 007073   000004 506007                    DIV     4,DL
        86 007074   000000 620006                    EAX0    0,QL
        86 007075   000020 740100                    STX0    16,,PR0
        86 007076   007104 710000 86                 TRA     s:8280

     2109     8279    1       ELSE OA.UWSZ = OA.UWSZ/4;

   8279 86 007077   000020 236100                    LDQ     16,,PR0
        86 007100   000022 772000                    QRL     18
        86 007101   000002 772000                    QRL     2
        86 007102   000000 621006                    EAX1    0,QL
        86 007103   000020 741100                    STX1    16,,PR0

     2110     8280    1       SUBSCHEMA_KEY = ' SSS KEY';

   8280 86 007104   001750 237000 12                 LDAQ    ONE_CHANGE+402
        86 007105   000000 757000 40                 STAQ    SUBSCHEMA_KEY

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:293  
     2111     8281    1       SPECIAL_KEY.COUNT = 7;

   8281 86 007106   007000 236003                    LDQ     3584,DU
        86 007107   000000 552040 40                 STBQ    SUBSCHEMA_KEY,'40'O

     2112     8282    1       BUFFER$ = SSS$;

   8282 86 007110   000000 236000 66                 LDQ     SSS$
        86 007111   000000 756000 41                 STQ     BUFFER$

     2113     8283    1       BUFFER_LEN = (OA.SZISS * 4) - 1;

   8283 86 007112   000000 236100                    LDQ     0,,PR0
        86 007113   000002 736000                    QLS     2
        86 007114   000217 376000 87                 ANQ     143
        86 007115   000001 136007                    SBLQ    1,DL
        86 007116   000000 756000 43                 STQ     BUFFER_LEN

     2114     8284    1       CALL ZIG$SS_WVAR;

   8284 86 007117   000005 631400 87                 EPPR1   5
        86 007120   000000 701000 xent               TSX1    ZIG$SS_WVAR
        86 007121   000000 011000                    NOP     0

     2115     8285    1       CONTROL.FIRST_ISS_BLOCK = OA.SZISS;

   8285 86 007122   000000 470400 75                 LDP0    OA$
        86 007123   000000 236100                    LDQ     0,,PR0
        86 007124   777777 376007                    ANQ     -1,DL
        86 007125   000077 756000 63                 STQ     CONTROL+63

     2116     8286    1       CONTROL.UWA_SIZE = OA.UWSZ;

   8286 86 007126   000020 236100                    LDQ     16,,PR0
        86 007127   000022 772000                    QRL     18
        86 007130   000004 756000 63                 STQ     CONTROL+4

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:294  
     2117     8287    1       CONTROL.NEXT_UWA_LOC = CONTROL.UWA_SIZE * 4;

   8287 86 007131   000004 235000 63                 LDA     CONTROL+4
        86 007132   000002 735000                    ALS     2
        86 007133   000051 755000 63                 STA     CONTROL+41

     2118     8288    1       CALL WRIT64(0,ADDR(CONTROL));

   8288 86 007134   000220 236000 87                 LDQ     144
        86 007135   200030 756100                    STQ     COUNT1+2,,AUTO
        86 007136   200030 631500                    EPPR1   COUNT1+2,,AUTO
        86 007137   200033 451500                    STP1    COUNT1+5,,AUTO
        86 007140   000075 236000 87                 LDQ     61
        86 007141   200032 756100                    STQ     COUNT1+4,,AUTO
        86 007142   200032 630500                    EPPR0   COUNT1+4,,AUTO
        86 007143   000013 631400 87                 EPPR1   11
        86 007144   000000 701000 xent               TSX1    WRIT64
        86 007145   000000 011000                    NOP     0

     2119     8289    1       IF SUB_LANGUAGE = #FORTRAN

   8289 86 007146   000000 235000 57                 LDA     SUB_LANGUAGE
        86 007147   000002 115007                    CMPA    2,DL
        86 007150   007154 601000 86                 TNZ     s:8293

     2120     8290    2       THEN DO;

     2121     8291    2           CALL ZIG$V_DESC;

   8291 86 007151   000005 631400 87                 EPPR1   5
        86 007152   000000 701000 xent               TSX1    ZIG$V_DESC
        86 007153   000000 011000                    NOP     0

     2122     8292    2           END;

     2123     8293    1       RETURN;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:295  
   8293 86 007154   000000 702200 xent               TSX2  ! X66_ARET

     2124     8294    1   DBCS_ERR:
     2125     8295    1       CALL ABORT;

   8295 86 007155   000005 631400 87    DBCS_ERR     EPPR1   5
        86 007156   000000 701000 xent               TSX1    ABORT
        86 007157   000000 011000                    NOP     0

     2126     8296    1       RETURN;

   8296 86 007160   000000 702200 xent               TSX2  ! X66_ARET

SCHEMA_NAME
 Sect OctLoc
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SUBSCHEMA_NAME
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

TEMP_WORD
 Sect OctLoc
   4     001   ****** ******   ****** ******   ****** ******   ****** ******    ................

SAVE_BUF
 Sect OctLoc
   4     011   ****** ******   ****** ******   ****** ******   ****** ******    ................

FIELD_NAME
 Sect OctLoc
   4     100   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_SET
 Sect OctLoc
   4     110   ****** ******   ****** ******   ****** ******   ****** ******    ................

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:296  
DESCPTR
 Sect OctLoc
   4     117   000120 006000                                                    .P..

BUFFER1
 Sect OctLoc
   4     120   ****** ******   ****** ******   ****** ******   ****** ******    ................

ASSIGNED_FSS_ALIGNMENT
 Sect OctLoc
   4     175   000000 000001   000000 000004   000000 000004   000000 000004    ................
   4     201   000000 000004   000000 000004   000000 000004   000000 000004    ................
   4     211*  000000 000004   000000 000004   000000 000010   000000 000010    ................
   4     215   000000 000010   000000 000004   ****** ******   ****** ******    ................
   4     225*  ****** ******   ****** ******   ****** ******   ****** ******    ................

EOFC
 Sect OctLoc
   9     000   057052 057052   057052 057052   057052 057052   040040 040040    /*/*/*/*/*/*
   9     004   040040 040040   040040 040040   040040 040040   040040 040040
   9     034*  040040 040040   040040 040040   040040 040040   040040 040040

HEAD_AREA_XREF
 Sect OctLoc
  12     000   123125 102123   103110 105115   101040 101122   105101 040116    SUBSCHEMA AREA N
  12     004   101115 105123   056040 040040   040040 040040   040040 040040    AMES.
  12     010   040040 040040   040040 040040   040040 040040   040040 040040
  12     014   040040 040040   040040 040040   040040 040040   040040 040040

HEAD_SET_XREF
 Sect OctLoc
  12     020   123125 102123   103110 105115   101040 123105   124040 116101    SUBSCHEMA SET NA
  12     024   115105 123056   040040 040040   040040 040040   040040 040040    MES.
  12     030   040040 040040   040040 040040   040040 040040   040040 040040
  12     034   040040 040040   040040 040040   040040 040040   040040 040040

HEAD_DATA_PAR
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:297  
 Sect OctLoc
  12     040   104101 124101   040102 101123   105040 120101   122101 115105    DATA BASE PARAME
  12     044   124105 122040   116101 115105   123056 040040   040040 040040    TER NAMES.
  12     050   040040 040040   040040 040040   040040 040040   040040 040040
  12     054   040040 040040   040040 040040   040040 040040   040040 040040

HEAD_RECORD_XREF
 Sect OctLoc
  12     060   122105 103117   122104 040103   122117 123123   055122 105106    RECORD CROSS-REF
  12     064   105122 105116   103105 040127   111124 110040   125127 101040    ERENCE WITH UWA
  12     070   101114 114117   103101 124111   117116 040050   127117 122104    ALLOCATION (WORD
  12     074   054040 102131   124105 054040   116111 102102   114105 051040    , BYTE, NIBBLE)

UNITS_PER_WORD
 Sect OctLoc
  12     100   000000 000004   000000 000004   000000 000004   000000 000010    ................
  12     104   000000 000010   000000 000010   000000 000004   000000 000004    ................
  12     110   000000 000004   000000 000004   000000 000004   000000 000004    ................
  12     114   000000 000004   000000 000004   000000 000006   000000 000004    ................
  12     120   000000 000010   000000 000004   000000 000006   000000 000044    ...............$
  12     124   000000 000004   000000 000004   000000 000006   000000 000006    ................
  12     130   000000 000004   000000 000004   000000 000004   000000 000004    ................

NUMERIC
 Sect OctLoc
  12     134   077600 0360**                                                    ?...

SYNONYM_CTYPE
 Sect OctLoc
  12     135   000000 000000   000000 000001   000000 000002   000000 000003    ................
  12     141   000000 000004   000000 000005   000000 000006   000000 000007    ................
  12     145   000000 000010   000000 000011   000000 000012   000000 000013    ................
  12     151   000000 000014   000000 000021   000000 000021   000000 000021    ................
  12     155   000000 000021   000000 000021   000000 000021   000000 000021    ................
  12     165*  000000 000021   000000 000021   000000 000021   000000 000021    ................

SYNONYM_FTYPE
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:298  
 Sect OctLoc
  12     171   000000 000000   000000 000021   000000 000002   000000 000021    ................
  12     175   000000 000021   000000 000021   000000 000021   000000 000021    ................
  12     215*  000000 000024   000000 000025   000000 000021   000000 000021    ................
  12     221   000000 000021   000000 000021   000000 000032   000000 000033    ................

SYNONYM_APL_TYPE
 Sect OctLoc
  12     225   000000 000021   000000 000021   000000 000021   000000 000016    ................
  12     231   000000 000016   000000 000021   000000 000021   000000 000021    ................
  12     235   000000 000021   000000 000021   000000 000021   000000 000016    ................
  12     241   000000 000016   000000 000021   000000 000021   000000 000021    ................
  12     245   000000 000021   000000 000016   000000 000016                    ............

SYNONYM_BASIC_TYPE
 Sect OctLoc
  12     250   000000 000021   000000 000021   000000 000021   000000 000016    ................
  12     254   000000 000016   000000 000021   000000 000021   000000 000021    ................
  12     260   000000 000021   000000 000021   000000 000021   000000 000022    ................
  12     264   000000 000016   000000 000021   000000 000021   000000 000021    ................
  12     270   000000 000021   000000 000016   000000 000016                    ............

SYNONYM_FORTRAN_TYPE
 Sect OctLoc
  12     273   000000 000021   000000 000021   000000 000021   000000 000015    ................
  12     277   000000 000015   000000 000021   000000 000021   000000 000021    ................
  12     303   000000 000021   000000 000021   000000 000021   000000 000015    ................
  12     307   000000 000016   000000 000021   000000 000021   000000 000021    ................
  12     313   000000 000021   000000 000015   000000 000016                    ............

PV
 Sect OctLoc
  12     316   204400 200400   000000 000000   204401 002004   000000 000000    ................
  12     322   204401 002004   000000 000000   204401 000000   400000 000000    ................
  12     326   204401 002000   400014 000000   204401 002020   000014 000000    ................
  12     332   204401 000400   000000 000000   204401 002400   000020 000000    ................
  12     336   204401 002400   000014 000000   204401 002400   000010 000000    ................
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:299  
  12     342   204401 002400   000004 000000   204401 002100   000000 000000    ...........@....
  12     346   204401 002040   000000 000000   204400 200400   000000 000000    ... ............

FACTER
 Sect OctLoc
  12     352   000000 000002   000000 000002   000000 000002   000000 000001    ................
  12     356   000000 000001   000000 000001   000000 000002   000000 000002    ................
  12     362   000000 000002   000000 000002   000000 000002   000000 000002    ................
  12     402*  000000 000002   000000 000002   000000 000002   000000 000002    ................

TN_S
 Sect OctLoc
  12     406   000766 312330   000000 000000   0000** ******                    ............

SET_ORDER
 Sect OctLoc
  12     411   106111 122123   124040 040040   040040 040040   040040 040040    FIRST
  12     415   040040 040040   040040 040040   040040 040040   114101 123124                LAST
  12     421   040040 040040   040040 040040   040040 040040   040040 040040
  12     425   040040 040040   040040 040040   116105 130124   040040 040040            NEXT
  12     431   040040 040040   040040 040040   040040 040040   040040 040040
  12     435   040040 040040   120122 111117   122040 040040   040040 040040        PRIOR
  12     441   040040 040040   040040 040040   040040 040040   040040 040040
  12     445   123117 122124   105104 040102   131040 104105   106111 116105    SORTED BY DEFINE
  12     451   104040 113105   131123 040040   040040 040040   102131 040122    D KEYS      BY R
  12     455   105103 117122   104055 116101   115105 040040   040040 040040    ECORD-NAME
  12     461   040040 040040   040040 040040   123117 122124   105104 040127            SORTED W
  12     465   111124 110111   116040 122105   103117 122104   055116 101115    ITHIN RECORD-NAM
  12     471   105040 040040   102131 040104   101124 101055   102101 123105    E   BY DATA-BASE
  12     475   055113 105131   040040 040040   040040 040040   040040 040040    -KEY

DUP_TEXT
 Sect OctLoc
  12     501   106111 122123   124040 040040   040040 040040   114101 123124    FIRST       LAST
  12     505   040040 040040   040040 040040   116117 124040   101114 114117            NOT ALLO
  12     511   127105 104040                                                    WED

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:300  
MODE_OF_SET
 Sect OctLoc
  12     512   103110 101111   116040 040040   040040 040040   040122 105103    CHAIN        REC
  12     516   117122 104040   101122 122101   131040 120117   111116 124105    ORD ARRAY POINTE
  12     522   122040 101122   122101 131***                                    R ARRAY.

MAN_OPT
 Sect OctLoc
  12     524   040040 040040   040040 040040   040040 040040   040040 040115                   M
  12     530   101116 104101   124117 122131   040101 125124   117115 101124    ANDATORY AUTOMAT
  12     534   111103 040114   111116 113105   104040 124117   040117 127116    IC LINKED TO OWN
  12     540   105122 040040   040040 040040   040040 040040   040040 040040    ER
  12     544   040040 040115   101116 104101   124117 122131   040115 101116       MANDATORY MAN
  12     550   125101 114040   114111 116113   105104 040124   117040 117127    UAL LINKED TO OW
  12     554   116105 122040   040040 040040   040040 040040   040040 040040    NER
  12     560   040040 040040   040040 040117   120124 111117   116101 114040           OPTIONAL
  12     564   101125 124117   115101 124111   103040 114111   116113 105104    AUTOMATIC LINKED
  12     570   040124 117040   117127 116105   122040 040040   040040 040040     TO OWNER
  12     574   040040 040040   040040 040040   040040 040117   120124 111117               OPTIO
  12     600   116101 114040   115101 116125   101114 040114   111116 113105    NAL MANUAL LINKE
  12     604   104040 124117   040117 127116   105122 040040   040040 040040    D TO OWNER

DATA_TYPE_NAME
 Sect OctLoc
  12     610   103110 101122   101103 124105   122040 040040   040040 040040    CHARACTER
  12     614   040040 040040   104102 113105   131040 040040   040040 040040        DBKEY
  12     620   040040 040040   040040 040040   111116 124105   107105 122040            INTEGER
  12     624   040040 040040   040040 040040   040040 040040   103117 115120                COMP
  12     630   055064 040040   040040 040040   040040 040040   040040 040040    -4
  12     634   103117 115120   055064 040123   111107 116105   104040 040040    COMP-4 SIGNED
  12     640   040040 040040   103117 115120   055063 040123   111107 116105        COMP-3 SIGNE
  12     644   104040 040040   040040 040040   104111 123120   114101 131040    D       DISPLAY
  12     650   116125 115105   122111 103040   040040 040040   104111 123120    NUMERIC     DISP
  12     654   114101 131040   116125 115105   122111 103040   040040 040040    LAY NUMERIC
  12     660   104111 123120   114101 131040   116125 115105   122111 103040    DISPLAY NUMERIC
  12     664   040040 040040   104111 123120   114101 131040   116125 115105        DISPLAY NUME
  12     670   122111 103040   040040 040040   104111 123120   114101 131040    RIC     DISPLAY
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:301  
  12     674   116125 115105   122111 103040   040040 040040   103117 115120    NUMERIC     COMP
  12     700   055061 040040   040040 040040   040040 040040   040040 040040    -1
  12     704   103117 115120   055062 040040   040040 040040   040040 040040    COMP-2
  12     710   040040 040040   122105 101114   040040 040040   040040 040040        REAL
  12     714   040040 040040   040040 040040   104117 125102   114105 040120            DOUBLE P
  12     720   122105 103111   123111 117116   040040 040040   103117 115120    RECISION    COMP
  12     724   114105 130040   040040 040040   040040 040040   040040 040040    LEX
  12     730   104117 125102   114105 040103   117115 120114   105130 040040    DOUBLE COMPLEX
  12     734   040040 040040   114117 107111   103101 114040   040040 040040        LOGICAL
  12     740   040040 040040   040040 040040   123111 116107   114105 040120            SINGLE P
  12     744   122105 103111   123111 117116   040040 040040                    RECISION

PL6_SCREW_UP
 Sect OctLoc
  12     747   060060 060060   060060 ******                                    000000..

ASSIGNED_SS_TYPE
 Sect OctLoc
  12     751   000000 000001   000000 000002   000000 000002   000000 000003    ................
  12     755   000000 000004   000000 000000   000000 000000   000000 000004    ................
  12     761   000000 000000   000000 000000   000000 000000   000000 000004    ................
  12     765   000000 000004   000000 000000   000000 000000   000000 000006    ................
  12     771   000000 000010   000000 000004   000000 000004                    ............

ASSIGNED_SS_LENGTH
 Sect OctLoc
  12     774   000000 000004   000000 000004   000000 000004   000000 000000    ................
  12    1000   000000 000000   000000 000000   000000 000011   000000 000400    ................
  12    1004   000000 000000   000000 000400   000000 000010   000000 000024    ................
  12    1010   000000 000400   000000 000000   000000 000000   000000 000000    ................
  12    1014   000000 000000   000000 000000   000000 000000                    ............

ASSIGNED_SS_SCALE
 Sect OctLoc
  12    1017   000000 000000   000000 000000   000000 000000   000000 000000    ................
  12    1027*  000000 000000   000000 000000   000000 000000   000000 000010    ................
  12    1033   000000 000024   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:302  
  12    1037   000000 000000   000000 000000   000000 000000                    ............

ASSIGNED_FSS_TYPE
 Sect OctLoc
  12    1042   000000 000002   000000 000002   000000 000002   000000 000015    ................
  12    1046   000000 000015   000000 000000   000000 000000   000000 000002    ................
  12    1052   000000 000000   000000 000000   000000 000000   000000 000015    ................
  12    1056   000000 000016   000000 000000   000000 000000   000000 000002    ................
  12    1062   000000 000002   000000 000015   000000 000016                    ............

ASSIGNED_FSS_LENGTH
 Sect OctLoc
  12    1065   000000 000004   000000 000004   000000 000004   000000 000004    ................
  12    1071   000000 000004   000000 000000   000000 000000   000000 000004    ................
  12    1075   000000 000000   000000 000000   000000 000000   000000 000004    ................
  12    1101   000000 000010   000000 000000   000000 000000   000000 000004    ................
  12    1105   000000 000004   000000 000004   000000 000010                    ............

RLTDP
 Sect OctLoc
  12    1110   000*** ******   013*** ******   013*** ******   000*** ******    ................
  12    1114   000*** ******   000*** ******   000*** ******   000*** ******    ................
  12    1120   000*** ******   000*** ******   000*** ******   005*** ******    ................
  12    1124   012*** ******   000*** ******                                    ........

ONE_CHANGE
 Sect OctLoc
  12    1126   040040 137055   137044 137137   137137 ******                      _-_$____..

(unnamed)
 Sect OctLoc
  12    1131   122103 040040   122103 055122   101040 040040   101103 055122    RC  RC-RA   AC-R
  12    1135   101040 040040   123116 055123   105040 040040   060065 060062    A   SN-SE   0502
  12    1141   061060 060040   106122 040040   052103 101114   103040 040040    100 FR  *CALC
  12    1145   040040 040040   101114 124105   122116 101124   105040 113105        ALTERNATE KE
  12    1151   131123 072040   040040 040040   117127 116105   122040 117106    YS:     OWNER OF
  12    1155   040123 105124   072040 040040   040040 040040   115105 115102     SET:       MEMB
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:303  
  12    1161   105122 040117   106040 123105   124072 040040   040040 040040    ER OF SET:
  12    1165   114117 103101   124105 104040   111116 040101   122105 101072    LOCATED IN AREA:
  12    1171   040040 040040   052103 101114   103056 122103   122103 055106        *CALC.RCRC-F
  12    1175   122040 040040   052104 102120   101122 101115   106111 114114    R   *DBPARAMFILL
  12    1201   040040 040040   040053 040040   040040 040040   040040 040040         +
  12    1205   040040 040040   040040 040040   040040 040040   040053 040040                 +
  12    1211   040040 040040   040040 040040   040061 062117   060060 060060             12O0000
  12    1215   060060 054040   040040 040040   040040 040103   117115 115117    00,        COMMO
  12    1221   116040 057125   057040 125040   040040 040040   040053 040040    N /U/ U      +
  12    1225   040040 040040   040040 040040   040040 040040   040104 102123                 DBS
  12    1231   124101 124125   123054 040040   040040 040040   040053 040040    TATUS,       +
  12    1235   040040 040040   040040 040040   040040 040040   040106 111114                 FIL
  12    1241   114105 122060   054040 040040   040040 040040   040053 040040    LER0,        +
  12    1245   040040 040040   040040 040040   040040 040040   040104 102101                 DBA
  12    1251   122105 101054   040040 040040   040053 040040   040040 040040    REA,     +
  12    1255   040040 040040   040040 040040   040106 111114   114105 122061             FILLER1
  12    1261   054040 040040   040040 040040   040053 040040   040040 040040    ,        +
  12    1265   040040 040040   040040 040040   040104 102123   105124 054040             DBSET,
  12    1271   040040 040040   040053 040040   040040 040040   040040 040040         +
  12    1275   040040 040040   040106 111114   114105 122062   054040 040040         FILLER2,
  12    1301   040040 040040   040053 040040   040040 040040   040040 040040         +
  12    1305   040040 040040   040104 102122   105103 117122   104054 040040         DBRECORD,
  12    1311   040040 040040   040053 040040   040040 040040   040040 040040         +
  12    1315   040040 040040   040106 111114   114105 122063   054040 040040         FILLER3,
  12    1321   040040 040040   040053 040040   040040 040040   040040 040040         +
  12    1325   040040 040040   040104 102120   122111 126101   103131 054040         DBPRIVACY,
  12    1331   040040 040040   040053 040040   040040 040040   040040 040040         +
  12    1335   040040 040040   040104 111122   105103 124122   105106 105122         DIRECTREFER
  12    1341   105116 103105   054040 040040   040040 040040   040053 040040    ENCE,        +
  12    1345   040040 040040   040040 040040   040040 040040   040104 102104                 DBD
  12    1351   101124 101116   101115 105054   040040 040040   040053 040040    ATANAME,     +
  12    1355   040040 040040   040040 040040   040040 040040   040106 111114                 FIL
  12    1361   114105 122064   054040 040040   040040 040040   040053 040040    LER4,        +
  12    1365   040040 040040   040040 040040   040040 040040   040104 102113                 DBK
  12    1371   105131 116101   115105 054040   040040 040040   040053 040040    EYNAME,      +
  12    1375   040040 040040   040040 040040   040040 040040   040106 111114                 FIL
  12    1401   114105 122065   054040 040040   040040 040040   040040 040111    LER5,          I
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:304  
  12    1405   116124 105107   105122 040125   054104 111122   105103 124122    NTEGER U,DIRECTR
  12    1411   105106 105122   105116 103105   040040 040040   040040 040103    EFERENCE       C
  12    1415   110101 122101   103124 105122   052061 040040   040040 106111    HARACTER*1    FI
  12    1421   114114 105122   060040 040040   040040 040040   040040 040103    LLER0          C
  12    1425   110101 122101   103124 105122   052067 040040   040040 104102    HARACTER*7    DB
  12    1431   123124 101124   125123 040040   040040 040040   040040 040103    STATUS         C
  12    1435   110101 122101   103124 105122   052063 060040   104102 104101    HARACTER*30 DBDA
  12    1441   124101 116101   115105 054104   102113 105131   116101 115105    TANAME,DBKEYNAME
  12    1445   054104 102101   122105 101054   104102 123105   124054 104102    ,DBAREA,DBSET,DB
  12    1451   122105 103117   122104 040040   040040 040040   040040 040103    RECORD         C
  12    1455   110101 122101   103124 105122   052061 062040   104102 120122    HARACTER*12 DBPR
  12    1461   111126 101103   131040 040040   040040 040040   040040 040103    IVACY          C
  12    1465   110101 122101   103124 105122   052062 040040   106111 114114    HARACTER*2  FILL
  12    1471   105122 061054   106111 114114   105122 062054   106111 114114    ER1,FILLER2,FILL
  12    1475   105122 063054   106111 114114   105122 064040   040040 040040    ER3,FILLER4
  12    1501   040040 040103   110101 122101   103124 105122   052066 040040       CHARACTER*6
  12    1505   106111 114114   105122 065040   054122 040040   065052 040040    FILLER5 ,R  5*
  12    1511   040040 040040   040040 040105   121125 111126   101114 105116           EQUIVALEN
  12    1515   103105 040050   051051 040040   122105 103117   122104 055116    CE ())  RECORD-N
  12    1521   101115 105072   040040 040040   040050 040116   105105 040040    AME:     ( NEE
  12    1525   040051 040040   040040 040040   040053 040040   040040 040040     )       +
  12    1531   040040 040040   040040 040040   040040 040040   040040 040040
  12    1535   040123 105124   040116 101115   105040 111123   040040 040040     SET NAME IS
  12    1541   040040 040040   040040 040040   040040 123105   124040 111123              SET IS
  12    1545   040120 122111   117122 040120   122117 103105   123123 101102     PRIOR PROCESSAB
  12    1551   114105 040040   040040 040040   040040 040040   040040 117122    LE            OR
  12    1555   104105 122040   111123 040120   105122 115101   116105 116124    DER IS PERMANENT
  12    1561   040040 040040   040040 040040   040040 111115   120114 105115              IMPLEM
  12    1565   105116 124101   124111 117116   040115 117104   105040 111123    ENTATION MODE IS
  12    1571   040040 040040   040040 040040   040040 040040   040040 111116                  IN
  12    1575   123105 122124   111117 116040   111123 040123   117122 124105    SERTION IS SORTE
  12    1601   104040 102131   040104 105106   111116 105104   040113 105131    D BY DEFINED KEY
  12    1605   123040 040040   040040 040040   040040 040040   040040 040040    S
  12    1611   040040 040104   125120 114111   103101 124105   123040 101122       DUPLICATES AR
  12    1615   105040 040040   040040 040040   040040 040040   040040 123105    E             SE
  12    1621   124040 117127   116105 122040   111123 040040   040040 040040    T OWNER IS
  12    1625   040040 040040   040040 117127   116105 122040   111123 040116          OWNER IS N
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:305  
  12    1631   117124 040120   122105 123105   116124 040111   116040 123125    OT PRESENT IN SU
  12    1635   102123 103110   105115 101040   040040 040040   040040 040040    BSCHEMA
  12    1641   040040 115105   115102 105122   040111 123040   040040 040040      MEMBER IS
  12    1645   040040 040040   040040 040040   040040 040113   105131 040111               KEY I
  12    1651   123040 104105   123103 105116   104111 116107   040040 040040    S DESCENDING
  12    1655   040040 040040   040040 040040   040040 040040   040040 040113                   K
  12    1661   105131 040111   123040 101123   103105 116104   111116 107040    EY IS ASCENDING
  12    1665   040040 040040   040040 040040   040040 124110   105040 125123              THE US
  12    1671   101107 105040   117106 040124   110111 123040   123105 124040    AGE OF THIS SET
  12    1675   104117 105123   040116 117124   040122 105121   125111 122105    DOES NOT REQUIRE
  12    1701   040101 116131   040115 105115   102105 122040   122105 103117     ANY MEMBER RECO
  12    1705   122104 123040   123117 040040   122103 055123   117123 115040    RDS SO  RC-SOSM
  12    1711   123116 055123   105040 040040   123115 040040   106122 040040    SN-SE   SM  FR
  12    1715   122103 055106   122040 040040   052052 052052   123103 055123    RC-FR   ****SC-S
  12    1721   117123 115040   040040 040040   040053 040040   040040 040040    OSM      +
  12    1725   040040 040040   040040 061062   117060 060060   060060 064060          12O0000040
  12    1731   060060 060060   060057 040040   060072 040040   040040 040040    00000/  0:
  12    1735   040040 040103   117115 115117   116040 057122   057040 040040       COMMON /R/
  12    1741   057061 062117   060060 060060   060060 054040   040040 040040    /12O000000,
  12    1745   040040 104101   124101 040122   065052 040040   040123 123123      DATA R5*   SSS
  12    1751   040113 105131                                                     KEY

LIST_STRING
 Sect OctLoc
  16     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

FIELD1
 Sect OctLoc
  18     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

BASE_PTR
 Sect OctLoc
  20     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

ALT_HASH_TABLE
 Sect OctLoc
  24     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:306  

ANALS
 Sect OctLoc
  27     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
  28     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
  29     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
  30     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
  30     024*  ****** ******   ****** ******   ****** ******                    ............

VALIDS
 Sect OctLoc
  31     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
  32     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
  33     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
  34     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
  35     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:307  

SSGEN
 Sect OctLoc
  36     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  44     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  46     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  47     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  49     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  49     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  49     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  49     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  50     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  50     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  50     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  50     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  50     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  50     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  50     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  50     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:308  
  51     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  51     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  51     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  51     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  51     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  51     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  51     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  51     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  52     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  52     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  52     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  52     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  52     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  52     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  52     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  52     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

RVA
 Sect OctLoc
  53     000   000151 000000   000000 000001   000001 000002   000001 000003    .i..............
  53     004   000001 000004   000001 000005   000001 000006   000001 000007    ................
  53     010   000001 000010   000001 000011   000001 000012   000001 000013    ................
  53     014   000001 000014   000001 000015   000001 000016   000001 000017    ................
  53     020   000001 000020   000001 000021   000001 000022   000001 000023    ................
  53     024   000001 000024   000001 000025   000001 000026   000001 000027    ................
  53     030   000001 000030   000001 000031   000001 000032   000001 000033    ................
  53     034   000001 000034   000001 000035   000001 000036   000001 000037    ................
  53     040   000001 000040   000001 000041   000001 000042   000001 000043    ... ...!..."...#
  53     044   000001 000044   000001 000045   000001 000046   000001 000047    ...$...%...&...'
  53     050   000001 000050   000001 000051   000001 000052   000002 000600    ...(...)...*....
  53     054   000002 000660   000002 001040   000002 001260   000002 001460    ....... ........
  53     060   000002 001540   000002 001660   000002 001700   000002 002140    ...............`
  53     064   000002 002320   000002 002700   000002 003100   000002 003260    ...........@....
  53     070   000002 003320   000002 003540   000002 003600   000002 003740    ................
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:309  
  53     074   000002 004000   000002 004060   000002 004220   000002 004400    .......0........
  53     100   000002 004540   000002 004660   000002 004720   000002 004760    ................
  53     104   000002 005000   000002 005020   000002 005220   000002 005240    ................
  53     110   000002 005500   000002 005740   000002 005760   000002 006000    ................
  53     114   000002 006020   000002 006040   000002 006220   000002 006340    ....... ........
  53     120   000002 006640   000002 006760   000002 007120   000002 007240    ...........P....
  53     124   000002 007320   000002 007420   000002 007560   000002 007640    ................
  53     130   000002 007760   000002 010120   000002 010360   000002 010460    .......P........
  53     134   000002 010620   000002 010720   000002 011060   000002 011160    ...........0...p
  53     140   000002 011220   000002 011320   000002 011400   000002 011460    ................
  53     144   000002 011540   000002 011620   000002 011700   000002 011760    ................
  53     150   000002 012040   000004 000000                                    ... ....

UWA
 Sect OctLoc
  54     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  54     004   040040 040040   040040 040040   040040 040040   040040 040040
  54     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  54     014   040040 040040   040040 040040   040040 040040   040040 040040
  54     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  54     024   040040 040040   040040 040040   040040 040040   040040 040040
  54     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  54     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  54     040   040040 040040   040040 040040   040040 040040   040040 040040
  54     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  54     050   040040 040040   040040 040040   040040 040040   040040 040040
  54     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  54     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  54     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  54     070   040040 040040   040040 040040   040040 040040   040040 040040
  54     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  54     104   040040 040040   040040 040040   040040 040040   040040 040040
  54     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  54     130   040040 040040   040040 040040   040040 040040   040040 040040
  54     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  54     140   040040 040040   040040 040040   040040 040040   040040 040040
  54     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:310  
  54     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     154   040040 040040   040040 040040   040040 040040   040040 040040
  54     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  54     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  54     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  54     174   040040 040040   040040 040040   040040 040040   040040 040040
  54     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  54     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  54     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  54     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  54     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  54     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  54     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  54     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  54     430   040040 040040   040040 040040   040040 040040   040040 040040
  54     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  54     440   040040 040040   040040 040040   040040 040040   040040 040040
  54     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  54     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  54     460   040040 040040   040040 040040   040040 040040   040040 040040
  54     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  54     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  54     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  54     504   040040 040040   040040 040040   040040 040040   040040 040040
  54     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  54     524   040040 040040   040040 040040   040040 040040   040040 040040
  54     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  54     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  54     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:311  
  54     614   040040 040040   040040 040040   040040 040040   040040 040040
  54     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  54     624   040040 040040   040040 040040   040040 040040   040040 040040
  54     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  54     664   040040 040040   040040 040040   040040 040040   040040 040040
  54     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  54     700   040040 040040   040040 040040   040040 040040   040040 040040
  54     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  54     714   040040 040040   040040 040040   040040 040040   040040 040040
  54     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  54     724   040040 040040   040040 040040   040040 040040   040040 040040
  54     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  54     744   040040 040040   040040 040040   040040 040040   040040 040040
  54     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  54    1000   040040 040040   040040 040040   040040 040040   040040 040040
  54    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  54    1040   040040 040040   040040 040040   040040 040040   040040 040040
  54    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  54    1064   040040 040040   040040 040040   040040 040040   040040 040040
  54    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  54    1120   040040 040040   040040 040040   040040 040040   040040 040040
  54    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  54    1140   040040 040040   040040 040040   040040 040040   040040 040040
  54    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  54    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  54    1154   040040 040040   040040 040040   040040 040040   040040 040040
  54    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  54    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  54    1170   040040 040040   040040 040040   040040 040040   040040 040040
  54    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  54    1204   040040 040040   040040 040040   040040 040040   040040 040040
  54    1214*  040040 040040   040040 040040   040040 040040   040040 040040

TYPE_9
 Sect OctLoc
  55     000   000000 000160   000000 000000   000000 000000   000000 000011    ...p............
  55     004   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:312  
  55     020*  000000 000000   200000 000000   000000 000000   000000 000000    ................
  55     024   000000 000000   000000 000000   000000 000000   000000 000000    ................
  55     030   040040 040040   040040 040040   040040 040040   040040 040040
  55     034   040040 040040   040040 040040   040040 040040   040040 040040

LANG_ALLOWED
 Sect OctLoc
  56     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
  58     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
  59     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
  59     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
  59     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
  59     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
  60     000   0***** ******                                                    ....

IO_BUF
 Sect OctLoc
  62     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

CONTROL
 Sect OctLoc
  63     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
  63     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
  63     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
  63     020*  040040 040040   040040 040040   040040 040040   040040 040040
  63     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
  63     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
  63     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:313  
  63     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  63     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
  63     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
  63     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

TYPE_36
 Sect OctLoc
  64     000   000000 000044   000000 000000   000000 000000   000000 000044    ...$...........$
  64     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  64     010   040040 040040   040040 040040   040040 040040   040040 040040
  64     034*  040040 040040   000000 000000   000000 000000   000000 000000        ............

TYPE_37
 Sect OctLoc
  65     000   000000 000045   000000 000000   000000 000000   000000 000045    ...%...........%
  65     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  65     010   040040 040040   040040 040040   040040 040040   040040 040040
  65     034*  040040 040040   000000 000000   000000 000000   000000 000000        ............

(unnamed)
 Sect OctLoc
  87     000   000001 000000   001131 006000   001132 006000   001134 006000    .....Y...Z...\..
  87     004   001136 006000   000000 000000   000003 000000   000000 000001    .^..............
  87     010   000007 006000   000000 021475   000011 006000   000002 000000    ................
  87     014   001142 006000   000013 006000   000000 006014   000000 006000    .b..............
  87     020   000000 006000   040040 040040   000000 006000   001174 006000    ....    .....|..
  87     024   000040 006000   000007 006000   000070 006000   054040 040040    . .......8..,
  87     030   052040 040040   000000 006000   000000 006000   000007 006000    *   ............
  87     034   000052 006000   000040 040040   000007 006000   000025 006000    .*...   ........
  87     040   000000 000003   000002 030000   000040 006000   077777 777777    ......... ..?...
  87     044   777777 777777   777777 377777   777777 777377   000001 006000    ................
  87     050   777776 777777   000021 006000   000000 000022   000052 006000    .............*..
  87     054   000000 000036   000007 006000   000054 006000   000100 006000    .........,...@..
  87     060   000000 021543   000060 006000   000052 006000   000000 006000    .....0...*......
  87     064   000000 006000   000000 006000   777777 777000   001510 006000    ................
  87     070   000007 006000   000000 006000   000000 006000   000000 006000    ................
  87     074   000003 400000   000005 006000   000002 400000   000060 006000    .............0..
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:314  
  87     100   000000 000002   000001 400000   000100 006000   000007 006000    .........@......
  87     104   000031 006000   000000 021535   000105 006000   777757 777777    .........E......
  87     110   000020 006000   000077 006000   000000 006000   777777 400000    .....?..........
  87     114   001706 006000   000067 006000   001707 006000   001711 006000    .....7..........
  87     120   001713 006000   000067 006000   000076 006000   777777 577777    .....7...>......
  87     124   001714 006000   001715 006000   000010 000000   000000 000016    ................
  87     130   000427 006000   000007 006000   000062 006000   000005 006000    .........2......
  87     134   000007 006000   000127 006000   000056 006000   000055 006000    .....W.......-..
  87     140   001714 006000   000054 006000   000000 006000   000000 000040    .....,.........
  87     144   000143 006000   001717 006000   000052 006000   001720 006000    .c.......*......
  87     150   000000 000014   000427 006000   000007 006000   000062 006000    .............2..
  87     154   000005 006000   000007 006000   000150 006000   000056 006000    .........h......
  87     160   000055 006000   000000 006000   051040 040040   000007 006000    .-......)   ....
  87     164   000054 006000   000030 006000   000100 006000   000054 006000    .,.......@...,..
  87     170   000020 006000   000000 021502   000171 006000   000040 006000    .........y... ..
  87     174   000000 006000   000000 021503   000175 006000   000000 021504    .........}......
  87     200   000177 006000   000007 006000   000000 006000   000000 021513    ................
  87     204   000203 006000   000000 006000   000000 006000   001747 006000    ................
  87     210   001747 006000   000005 006000   000004 000000   001747 006000    ................
  87     214   000117 006000   000160 006000   000161 006000   000003 777774    .O...p...q......
  87     220   000000 006000                                                    ....
     2127     8297
     2128     8298    1   END ZIG$V_DRIVER;
     2129     8299        %EOD;

PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:315  
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_DRIVER.

   Procedure ZIG$V_DRIVER requires 3697 words for executable code.
   Procedure ZIG$V_DRIVER requires 30 words of local(AUTO) storage.
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:316  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:317  
          MINI XREF LISTING

ABORT
       877**DCL-ENT  6458--CALL     6523--CALL     6628--CALL     6688--CALL     6794--CALL     6799--CALL
      7123--CALL     7143--CALL     7745--CALL     8029--CALL     8097--CALL     8112--CALL     8146--CALL
      8150--CALL     8295--CALL
AC.ACID
      5945**DCL      7587<>CALL
AC.ANAM
      6011**DCL      6620>>CALLBLT  7591>>CALLBLT
AC.DEF.ANL
      5940**DCL      6011--IMP-SIZ  6620>>CALLBLT  7591>>CALLBLT
AC.DEF.FORG
      5927**DCL      5931--REDEF
AC$
      5923**DCL      5924--IMP-PTR  7587>>CALL     7591>>CALLBLT  7591>>CALLBLT
AC1$
      6017**DCL      6018--IMP-PTR
ADD_SPECIAL_REC
      6652**PROC     7768--CALL
AEIS.LENGTH IN PROCEDURE TYPE_430_SIZE_FROM_EIS
      6921**DCL      6937>>ASSIGN
AG$
      6391**DCL      6392--IMP-PTR
AG1$
      6421**DCL      6422--IMP-PTR
ALI IN PROCEDURE GET_OCTAL_NUM
      7150**DCL      7148--PROC
ALI.NUM IN PROCEDURE GET_OCTAL_NUM
      7151**DCL      7155>>CALLBLT
ALLOCATE_END
       880**DCL      7984<<ASSIGN   7988<<ASSIGN   8092<<ASSIGN   8096<<ASSIGN
ALLOCATE_PARAMETER
      6823**PROC     6735--CALL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:318  
ALT_HASH_TABLE
       109**DCL      6483>>ASSIGN
AREA_REC_REL
        97**DCL      6445<<ASSIGN   6454>>IF       6455<<ASSIGN   6459>>IF
ASSIGNED_FSS_ALIGNMENT IN PROCEDURE ALLOCATE_PARAMETER
      6832**DCL      6849>>ASSIGN
ASSIGNED_FSS_LENGTH IN PROCEDURE DEFAULT_DATA_TYPE
      6977**DCL      7030>>ASSIGN
ASSIGNED_FSS_TYPE IN PROCEDURE DEFAULT_DATA_TYPE
      6974**DCL      6991>>ASSIGN
ASSIGNED_SS_LENGTH IN PROCEDURE DEFAULT_DATA_TYPE
      6968**DCL      7021>>IF       7026>>ASSIGN
ASSIGNED_SS_SCALE IN PROCEDURE DEFAULT_DATA_TYPE
      6971**DCL      7027>>ASSIGN
ASSIGNED_SS_TYPE IN PROCEDURE DEFAULT_DATA_TYPE
      6965**DCL      6990>>ASSIGN
BASED_PTR$
       132**DCL      7816>>ASSIGN   7877>>ASSIGN   7951>>ASSIGN   8072>>ASSIGN
BITS_52
       110**DCL      7093<<ASSIGN
BLD_NM
       897**DCL-ENT  7446--CALL
BUFFER$
       909**DCL      7485<<ASSIGN   8282<<ASSIGN
BUFFER1
       172**DCL       171--DCLINIT
BUFFER_LEN
       911**DCL      7486<<ASSIGN   8283<<ASSIGN
BUFFER_SIZE
       175**DCL      8251<>CALL     8255<>CALL
BUFFER_TEMP
       173**DCL      8253<>CALL
BYTE_ALIGNMENT IN PROCEDURE ALLOCATE_PARAMETER
      6831**DCL      6847<<ASSIGN   6849<<ASSIGN   6850>>ASSIGN   6871>>ASSIGN
CD.CDSH
      6362**DCL      7845>>ASSIGN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:319  
CD.DEF.CONT
      6355**DCL      7858>>IF
CD.RSCDN
      6360**DCL      7866>>ASSIGN
CD$
      6350**DCL      6351--IMP-PTR
CF_PTR$
        31**DCL      7555<<ASSIGN
CHANGE_STR IN PROCEDURE CHANGE_TO_STR
      7104**DCL      7103--PROC     7109>>CALLBLT  7111<<CALLBLT  7112>>CALLBLT
CHANGE_TO_STR
      7103**PROC     6490--CALL     6679--CALL     6729--CALL     7082--CALL     7887--CALL     7917--CALL
      7996--CALL
CHAR_1 IN PROCEDURE GET_OCTAL_NUM
      7153**DCL      7155<<CALLBLT  7156>>CALLBLT
CONTROL
      5203**DCL      8288--CALL
CONTROL.BITS.ALL_FIELDS
      5237**DCL      7455<<ASSIGN
CONTROL.FIRST_CU_RECORD
      5240**DCL      7459>>IF       7461>>ASSIGN   7462>>IF       7463>>ASSIGN   7465<<ASSIGN
CONTROL.FIRST_ISS_BLOCK
      5244**DCL      8285<<ASSIGN
CONTROL.FIRST_NFE_RECORD
      5243**DCL      7449>>ASSIGN   7462>>IF       7475<<ASSIGN
CONTROL.FIRST_SDS_RECORD
      5242**DCL      7562>>ASSIGN
CONTROL.LANGUAGE
      5221**DCL      7439>>IF       7447>>ASSIGN
CONTROL.LAST_FILLER_LEN
      5235**DCL      6702>>IF       6714>>ASSIGN
CONTROL.LAST_FILLER_NUM
      5234**DCL      6701>>ASSIGN
CONTROL.NEXT_AVAILABLE_RECORD
      5239**DCL      8247<<ASSIGN   8265<<ASSIGN
CONTROL.NEXT_UWA_LOC
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:320  
      5225**DCL      7478<<ASSIGN   8287<<ASSIGN
CONTROL.NUM_DB_PARAM
      5215**DCL      6746<<ASSIGN   6746>>ASSIGN   7452<<ASSIGN
CONTROL.NUM_FIELD_SET
      5206**DCL      7451<<ASSIGN   8057<<ASSIGN   8057>>ASSIGN
CONTROL.NUM_LOCKS
      5216**DCL      7453<<ASSIGN
CONTROL.NUM_REC_AREA_REL
      5217**DCL      7454<<ASSIGN
CONTROL.NUM_REC_SET_REL
      5214**DCL      7450<<ASSIGN
CONTROL.NUM_SET_SET_DESC
      5231**DCL      8123<<ASSIGN   8123>>ASSIGN
CONTROL.SCHEMA_NAME
      5218**DCL      8205<>CALL
CONTROL.SUBSCHEMA_NAME
      5219**DCL      7484>>ASSIGN   8204<>CALL
CONTROL.TRANS_UWA_SIZE
      5230**DCL      7477>>ASSIGN   7478>>ASSIGN
CONTROL.UWA_SIZE
      5208**DCL      7477<<ASSIGN   8286<<ASSIGN   8287>>ASSIGN
CONTROL.VALIDATION_STATUS
      5204**DCL      8208<<ASSIGN   8226<<ASSIGN
COUNT1 IN PROCEDURE CHANGE_TO_STR
      7105**DCL      7109<<CALLBLT  7110>>DOWHILE  7111>>CALLBLT  7112<<CALLBLT
CURRENT_RECORD
      4283**DCL      7562<<ASSIGN   7563<>CALL     7660>>ASSIGN   7729<<ASSIGN   7729>>ASSIGN   7730<>CALL
CUR_EXT_NAME_SEG
        96**DCL      6739<>CALL     6740<<ASSIGN   6740>>ASSIGN   7449<<ASSIGN   7463<<ASSIGN   7465>>ASSIGN
      7470>>ASSIGN   7471<>CALL     7472<<ASSIGN   7472>>ASSIGN   7474<<ASSIGN   7474>>ASSIGN   7474>>ASSIGN
      7475>>ASSIGN   8244<>CALL     8245<<ASSIGN   8245>>ASSIGN   8246<>CALL     8247>>ASSIGN   8248<<ASSIGN
      8248>>ASSIGN   8253<>CALL     8254<<ASSIGN   8254>>ASSIGN   8264<>CALL     8265>>ASSIGN
DATA_TYPE_NAME
       181**DCL      6712>>CALLBLT  6767>>CALLBLT  6779>>CALLBLT  6861>>CALLBLT  7680>>CALLBLT  7711>>CALLBLT
DBCS_ERR
      8295**LABEL    7881--CALLALT  7882--CALLALT  7883--CALLALT  7911--CALLALT  7912--CALLALT  7913--CALLALT
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:321  
      7979--CALLALT  7981--CALLALT  7982--CALLALT  8082--CALLALT  8083--CALLALT  8090--CALLALT
DBCS_ERR IN PROCEDURE ADD_SPECIAL_REC
      6799**LABEL    6675--CALLALT  6725--CALLALT
DBCS_ERR IN PROCEDURE ZIG$V_CHECK_F
      6628**LABEL    6444--CALLALT  6448--CALLALT  6449--CALLALT
DBK
       134**DCL      7880<<ASSIGN   7881<>CALL     7910<<ASSIGN   7911<>CALL
DEFAULT_DATA_TYPE
      6963**PROC     6494--CALL     6841--CALL
DESCPTR
       171**DCL       173--IMP-PTR  8251<>CALL     8253>>CALL     8255<>CALL
DONE_FR_CALC IN PROCEDURE ADD_SPECIAL_REC
      6688**LABEL    6673--CALLALT
DONE_FR_PARA IN PROCEDURE ADD_SPECIAL_REC
      6794**LABEL    6723--CALLALT
DONE_RC_RA IN PROCEDURE ZIG$V_CHECK_F
      6458**LABEL    6447--CALLALT
DP$
      6369**DCL      6370--IMP-PTR
DP1$
      6383**DCL      6384--IMP-PTR
DUP_TEXT
       148**DCL      7807>>CALLBLT
EOF
       174**DCL      8251<>CALL     8252>>DOWHILE  8255<>CALL
EOFC
        29**DCL      7564>>DOWHILE  8152>>ASSIGN   8161>>ASSIGN   8182>>ASSIGN   8244<>CALL     8246<>CALL
      8264<>CALL
ERROR
       869**DCL-ENT  7443--CALL     7734--CALL     8218--CALL
ERROR_FLG
       106**DCL      7986<>CALL     7989>>IF       8094<>CALL     8097>>IF
ERROR_IO
       910**DCL      7122>>IF       7142>>IF       7551<<ASSIGN   8146>>IF       8150>>IF
ERROR_READ64
        62**DCL      7564>>DOWHILE  7732>>IF
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:322  
FACTER
       127**DCL      6877>>ASSIGN   6878>>ASSIGN
FCURR_R_6
       976**DCL-ENT  6444--CALL
FETCHD_6
       974**DCL-ENT  6487--CALL     7979--CALL     8017--CALL
FETCHNS_6
       979**DCL-ENT  6447--CALL     6673--CALL     6723--CALL
FETCHOS_6
       983**DCL-ENT  6448--CALL     6449--CALL     6675--CALL     6725--CALL     7882--CALL     7883--CALL
      7912--CALL     7913--CALL     7981--CALL     7982--CALL     8090--CALL
FIELD1.COUNT1
        66**DCL      6716>>CALLBLT  6716>>CALLBLT  6753>>CALLBLT  6753>>CALLBLT  6753>>CALLBLT  6784>>CALLBLT
      6784>>CALLBLT  6864>>CALLBLT  6864>>CALLBLT  7158<<ASSIGN   7591>>CALLBLT  7609>>CALLBLT  7667>>CALLBLT
      7683>>CALLBLT  7683>>CALLBLT  7716>>CALLBLT  7716>>CALLBLT  8170>>CALLBLT
FIELD1.TEXT1
        67**DCL      6705>>CALLBLT  6716>>CALLBLT  6753>>CALLBLT  6765>>CALLBLT  6784>>CALLBLT  6854>>CALLBLT
      6864>>CALLBLT  7132>>CALLBLT  7136>>CALLBLT  7156<<CALLBLT  7591>>CALLBLT  7609>>CALLBLT  7667>>CALLBLT
      7683>>CALLBLT  7716>>CALLBLT  8170>>CALLBLT  8177>>CALLBLT
FIELD_HASH.C_NAME
      4277**DCL      6488>>ASSIGN
FIELD_HASH.DBK
      4281**DCL      6487<>CALL
FIELD_HASH.PTR$
      4278**DCL      6506>>ASSIGN
FIELD_HASH.REF
      4279**DCL      6485>>IF
FIELD_NAME
       165**DCL      7441<<ASSIGN   7442<>CALL     7853<<ASSIGN   7856<<ASSIGN   7860>>CALLBLT  7862>>CALLBLT
FINDD_6
       975**DCL-ENT  7881--CALL     7911--CALL     8082--CALL
FINDOS_6
       982**DCL-ENT  8083--CALL
FIRST_AREA
        33**DCL      6608<<ASSIGN   6612>>IF       6615<<ASSIGN   7546<<ASSIGN   7576>>IF       7579<<ASSIGN
FIRST_DATA_PAR
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:323  
        37**DCL      7548<<ASSIGN
FIRST_FIELD
       166**DCL      7658<<ASSIGN
FIRST_KEY
       169**DCL      6551<<ASSIGN   6556>>IF       6559<<ASSIGN
FIRST_RECORD
        40**DCL      7549<<ASSIGN   7629>>IF       7632<<ASSIGN
FIRST_SET
        35**DCL      7547<<ASSIGN   7775>>IF       7778<<ASSIGN
FIRST_SM
       168**DCL      6550<<ASSIGN   6595>>IF       6598<<ASSIGN
FIRST_SO
       167**DCL      6549<<ASSIGN   6575>>IF       6578<<ASSIGN
FLAG_OWNER
        59**DCL-ENT  7964--CALL
FOUND
       138**DCL      8103<<ASSIGN   8107<<ASSIGN   8112>>IF
FR.CDRN
      6060**DCL      6497>>IF
FR.CDSN
      6059**DCL      6497>>IF
FR.DEF.COMC
      6033**DCL      7089>>IF       8037<<ASSIGN   8037>>ASSIGN
FR.DEF.DNDX
      6039**DCL      8032<<ASSIGN   8032>>ASSIGN
FR.DEF.EBCL
      6032**DCL      8038<<ASSIGN   8038>>ASSIGN
FR.DEF.EBCM
      6031**DCL      8039<<ASSIGN   8039>>ASSIGN
FR.DEF.ENDX
      6030**DCL      8031<<ASSIGN   8031>>ASSIGN
FR.DEF.FSR
      6038**DCL      6496<<ASSIGN   6685<<ASSIGN   6747<<ASSIGN   8034<<ASSIGN   8035<<ASSIGN   8035>>ASSIGN
FR.DEF.FUSE
      6036**DCL      8040>>IF
FR.DEF.FVF
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:324  
      6034**DCL      8036<<ASSIGN   8036>>ASSIGN
FR.DEF.SYN
      6035**DCL      8033>>IF
FR.FNAM
      6066**DCL      7856>>ASSIGN   8050>>ASSIGN
FR.FNL
      6062**DCL      6066--IMP-SIZ  7848>>IF       7856>>ASSIGN   8042>>IF       8050>>ASSIGN
FR.RCFRH
      6064**DCL      8053>>ASSIGN
FR.RCFRN
      6063**DCL      8026>>ASSIGN   8060>>ASSIGN
FR.UOFST
      6049**DCL      7979<>CALL     8030<<ASSIGN   8030>>ASSIGN
FR.UOFST.EIS.FRID
      6055**DCL      6750>>ASSIGN   6755>>ASSIGN   6757>>ASSIGN   6790<>CALL     7724<>CALL
FR.UOFST.EIS.OFFSET
      6052**DCL      6055--REDEF
FR.UOFST.EIS.REG
      6051**DCL      7977>>IF
FR$
      6026**DCL      6027--IMP-PTR  6496>>ASSIGN   6497>>IF       6497>>IF       6685>>ASSIGN   6747>>ASSIGN
      6750>>ASSIGN   6755>>ASSIGN   6757>>ASSIGN   6790>>CALL     7089>>IF       7724>>CALL     7975<<ASSIGN
      7976>>DOWHILE  7977>>IF       7979>>CALL     7992>>ASSIGN   8016<<ASSIGN   8030>>ASSIGN   8031>>ASSIGN
      8032>>ASSIGN   8033>>IF       8034>>ASSIGN   8035>>ASSIGN   8036>>ASSIGN   8037>>ASSIGN   8038>>ASSIGN
      8039>>ASSIGN   8040>>IF       8060<<ASSIGN   8060>>ASSIGN
FR1.NLIND
      6074**DCL      7851>>ASSIGN   8045>>ASSIGN
FR1.XXDPN
      6073**DCL      8024>>DOWHILE
FR1$
      6071**DCL      6072--IMP-PTR
FR_DBK
       100**DCL      6674<<ASSIGN   6676>>ASSIGN   6724<<ASSIGN   6726>>ASSIGN   7980<<ASSIGN   8017<>CALL
      8024>>DOWHILE
GET_OCTAL_NUM
      7148**PROC     7131--CALL     7135--CALL     8176--CALL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:325  
HASH_SCHEMA_NAME
      4225**DCL      7985<<ASSIGN   8093<<ASSIGN
HEADING_SET
       170**DCL      6558<<ASSIGN   6562<<ASSIGN   6564>>CALLBLT  6577<<ASSIGN   6581<<ASSIGN   6583>>CALLBLT
      6597<<ASSIGN   6601<<ASSIGN   6603>>CALLBLT  6614<<ASSIGN   6618<<ASSIGN   6620>>CALLBLT
HEAD_AREA_XREF
        32**DCL      7578<>CALL
HEAD_DATA_PAR
        36**DCL      6699<>CALL
HEAD_RECORD_XREF
        38**DCL      7631<>CALL
HEAD_SET_XREF
        34**DCL      7777<>CALL
I
        98**DCL      6750<<ASSIGN   6751<>CALL     6755<<ASSIGN   6755>>ASSIGN   6756<>CALL     6757<<ASSIGN
      6758>>IF       6773<<CALLBLT  6774>>CALLBLT  7134<<ASSIGN   7135<>CALL     7461<<ASSIGN   7466>>DOWHILE
      7467<>CALL     7468<<ASSIGN   7649<<CALLBLT  7650>>CALLBLT  7705<<CALLBLT  7706>>CALLBLT  7825<<DOINDEX
      7826>>ASSIGN   7907<<DOINDEX  7908>>IF       7910>>ASSIGN   7953<<DOINDEX  7954>>ASSIGN   8081<<ASSIGN
      8082<>CALL     8104<<DOINDEX  8105>>IF       8108>>ASSIGN   8147<<CALLBLT  8148>>CALLBLT
I IN PROCEDURE ALLOCATE_PARAMETER
      6834**DCL      6850<<ASSIGN   6851>>IF       6863<>CALL     6870>>IF       6871>>ASSIGN   6872<<ASSIGN
      6873>>ASSIGN   6874>>ASSIGN   6874>>ASSIGN
I IN PROCEDURE DEFAULT_DATA_TYPE
      6964**DCL      6988<<ASSIGN   6990>>ASSIGN   6991>>ASSIGN   7021>>IF       7026>>ASSIGN   7027>>ASSIGN
      7030>>ASSIGN
I IN PROCEDURE GET_OCTAL_NUM
      7152**DCL      7154<<DOINDEX  7155>>CALLBLT  7156>>CALLBLT
I IN PROCEDURE ZIG$V_CHECK_F
      6440**DCL      6461<<ASSIGN   6462<>CALL     6482<<DOINDEX  6483>>ASSIGN   6524<<ASSIGN   6527<<ASSIGN
      6527>>ASSIGN   6530>>ASSIGN
IA__KEY.NUMBER_OF
       924**DCL      7483<<ASSIGN
ID IN PROCEDURE WRITE_RVA
      7130**DCL      7128--PROC     7134>>ASSIGN
INFO_ONLY
       871**DCL-ENT  8210--CALL     8231--CALL     8239--CALL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:326  
INIT_TYPE_9_DBPARAM
      7057**PROC     6738--CALL     6875--CALL
IN_GROUP
        41**DCL      7640<<ASSIGN
IO_BUF
      4297**DCL      4323--REDEF    4438--REDEF    4541--REDEF    4590--REDEF    4649--REDEF    4698--REDEF
      4750--REDEF    4818--REDEF    4857--REDEF    4920--REDEF    4969--REDEF    5036--REDEF    6441>>ASSIGN
      6512<>CALL     6535<>CALL     6625<<ASSIGN   6656>>ASSIGN   6795<<ASSIGN   7467<>CALL     7468--ASSIGN
      7469--IF       7470--ASSIGN   7471<>CALL     7563<>CALL     7564>>DOWHILE  7730<>CALL     7852<>CALL
      8046<>CALL
JUST_WRITE_RVA IN PROCEDURE WRITE_RVA
      7138**ENTRY    7594--CALL     7612--CALL     7670--CALL     8160--CALL     8162--CALL     8165--CALL
      8175--CALL     8180--CALL     8183--CALL
K
       164**DCL      7835<<ASSIGN   7836<<ASSIGN   7838<<ASSIGN   7838>>ASSIGN   7839>>ASSIGN   7851<<ASSIGN
      7852<>CALL     8045<<ASSIGN   8046<>CALL
LANG_ALLOWED
      4180**DCL      7439>>IF
LANG_TEXT
      4195**DCL      7441>>ASSIGN
LARGEST_KEY
        73**DCL      7457<<ASSIGN   8273>>ASSIGN
LAST_AC
        25**DCL      7552<<ASSIGN
LAST_FILLER
       135**DCL      6701<<ASSIGN   6704<>CALL     6706<<ASSIGN   6706>>ASSIGN   6853<>CALL     6855<<ASSIGN
      6855>>ASSIGN
LAST_GROUP_LEVEL
        42**DCL      7641<<ASSIGN
LAST_RC
        27**DCL      7554<<ASSIGN   7620>>IF       7747>>IF
LAST_RECORD_REF_LINE
        68**DCL      6510>>IF       6512<>CALL     6535<>CALL     7660<<ASSIGN   7760<<ASSIGN
LAST_SC
        26**DCL      7553<<ASSIGN
LAST_SC_SAVE
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:327  
       131**DCL      7780<<ASSIGN   7781>>DOWHILE  7782>>ASSIGN   7783>>ASSIGN   7904>>ASSIGN   7905>>ASSIGN
      7935>>ASSIGN   7936>>ASSIGN   7939<<ASSIGN   7947<<ASSIGN   7948>>DOWHILE  7949>>ASSIGN   7950>>ASSIGN
      7967<<ASSIGN   8068<<ASSIGN   8069>>DOWHILE  8070>>ASSIGN   8132<<ASSIGN
LAST_SMSO_SAVE
       137**DCL      8073<<ASSIGN   8074>>DOWHILE  8075>>ASSIGN   8129<<ASSIGN
LAST_SS
       136**DCL      8078<<ASSIGN   8079>>DOWHILE  8080>>ASSIGN   8126<<ASSIGN
LEN IN PROCEDURE GET_OCTAL_NUM
      7149**DCL      7148--PROC     7154>>DOINDEX  7158>>ASSIGN
LEN_UBIN IN PROCEDURE ADD_SPECIAL_REC
      6654**DCL      6714<<ASSIGN   6715<>CALL
LIST
       884**DCL-ENT  6565--CALL     6584--CALL     6604--CALL     6621--CALL     6769--CALL     7637--CALL
      7646--CALL     7657--CALL     7793--CALL     7795--CALL     7797--CALL     7799--CALL     7802--CALL
      7806--CALL     7809--CALL     7814--CALL     7823--CALL     7833--CALL     7840--CALL     7864--CALL
      7874--CALL
LIST_STRING
        45**DCL      6564<<CALLBLT  6565<>CALL     6583<<CALLBLT  6584<>CALL     6603<<CALLBLT  6604<>CALL
      6620<<CALLBLT  6621<>CALL     6707<<CALLBLT  6712<<CALLBLT  6716<<CALLBLT  6767<<CALLBLT  6769<>CALL
      6774<<CALLBLT  6779<<CALLBLT  6784<<CALLBLT  6856<<CALLBLT  6861<<CALLBLT  6864<<CALLBLT  7132<<CALLBLT
      7136<<CALLBLT  7485--ASSIGN   7487<<CALLBLT  7490<<ASSIGN   7492<<ASSIGN   7494<<ASSIGN   7496<<ASSIGN
      7498<<ASSIGN   7500<<ASSIGN   7502<<ASSIGN   7504<<ASSIGN   7506<<ASSIGN   7508<<ASSIGN   7510<<ASSIGN
      7512<<ASSIGN   7514<<ASSIGN   7516<<ASSIGN   7520<<CALLBLT  7523<<ASSIGN   7525<<ASSIGN   7527<<ASSIGN
      7529<<ASSIGN   7531<<ASSIGN   7533<<ASSIGN   7591<<CALLBLT  7609<<CALLBLT  7636<<ASSIGN   7637<>CALL
      7645<<ASSIGN   7646<>CALL     7650<<CALLBLT  7654<<CALLBLT  7657<>CALL     7667<<CALLBLT  7675<<CALLBLT
      7680<<CALLBLT  7683<<CALLBLT  7706<<CALLBLT  7711<<CALLBLT  7716<<CALLBLT  7792<<ASSIGN   7793<>CALL
      7794<<CALLBLT  7795<>CALL     7796<<ASSIGN   7797<>CALL     7798<<ASSIGN   7799<>CALL     7800<<CALLBLT
      7802<>CALL     7805<<ASSIGN   7806<>CALL     7807<<CALLBLT  7809<>CALL     7812<<CALLBLT  7814<>CALL
      7820<<CALLBLT  7822<<ASSIGN   7823<>CALL     7831<<CALLBLT  7833<>CALL     7839<<ASSIGN   7840<>CALL
      7860<<CALLBLT  7862<<CALLBLT  7864<>CALL     7873<<ASSIGN   7874<>CALL     8147>>CALLBLT  8148<<CALLBLT
      8152<<ASSIGN   8159<<ASSIGN   8161<<ASSIGN   8172<<CALLBLT  8178<<CALLBLT  8182<<ASSIGN
MAN_OPT
       156**DCL      7839>>ASSIGN
MEMORY_USED_SSS
        72**DCL      8271>>ASSIGN
MODE_OF_SET
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:328  
       152**DCL      7800>>CALLBLT
NEED_TYPE_36_DESC
        24**DCL      8087<<ASSIGN   8098<<ASSIGN   8114>>IF
NEIS.LENGTH IN PROCEDURE TYPE_430_SIZE_FROM_EIS
      6918**DCL      6928>>ASSIGN
NEIS.SCALE IN PROCEDURE TYPE_430_SIZE_FROM_EIS
      6917**DCL      6929>>ASSIGN
NEXT_RVA_SECOND_HALF
       925**DCL      7537<<ASSIGN   7589>>ASSIGN   7595<<ASSIGN   7607>>ASSIGN   7613<<ASSIGN   7665>>ASSIGN
      7671<<ASSIGN   8164>>ASSIGN   8166<<ASSIGN   8181>>ASSIGN   8184<<ASSIGN
NEXT_UWA_SECOND_HALF
       916**DCL      6711>>ASSIGN   6719<<ASSIGN   6778>>ASSIGN   6788<<ASSIGN   6860>>ASSIGN   6867<<ASSIGN
      7535<<ASSIGN   7679>>ASSIGN   7686<<ASSIGN   7710>>ASSIGN   7720<<ASSIGN   8155>>ASSIGN   8157<<ASSIGN
NIBLE_OFF
       203**DCL      6760<<ASSIGN   6763<<ASSIGN   6765>>CALLBLT
NO_ERRORS
        22**DCL      7456<<ASSIGN   8192>>IF       8206>>IF
NO_MEMBERS_IN_SUBSCHEMA
        46**DCL      7824<<ASSIGN   7830<<ASSIGN   7871>>IF
NO_WRITE_AGAIN
      8152**LABEL    8147--CALLALT
NUMERIC
        79**DCL      6926>>IF
NUM_ERROR_MSG
       874**DCL      7458<<ASSIGN   8217<>CALL
NUM_OFF
       204**DCL      6765<<CALLBLT  6767>>CALLBLT
NUM_PROHIB
        23**DCL      8191<<ASSIGN   8228>>IF       8230>>CALL     8236>>IF       8238<>CALL
NUM_WARN_MSG
       875**DCL      8228>>IF       8230>>CALL
OA.CIWSOF
      6214**DCL      8275<<ASSIGN
OA.CLCRC
      6173**DCL      6666<<ASSIGN   6670<<ASSIGN
OA.CSZ
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:329  
      6207**DCL      8275>>ASSIGN   8276<<ASSIGN   8276>>ASSIGN
OA.KPASZ
      6213**DCL      8273<<ASSIGN   8276>>ASSIGN
OA.LRSZ
      6208**DCL      8274<<ASSIGN   8274>>ASSIGN
OA.OARCN
      6170**DCL      7972>>ASSIGN
OA.OASCN
      6169**DCL      7780>>ASSIGN   7947>>ASSIGN   8068>>ASSIGN
OA.SCNAM.EIS.COUNT
      6182**DCL      6219--IMP-SIZ
OA.SZISS
      6167**DCL      8271<<ASSIGN   8272>>ASSIGN   8283>>ASSIGN   8285>>ASSIGN
OA.UWSSZ
      6171**DCL      8272<<ASSIGN
OA.UWSZ
      6209**DCL      6693>>IF       6694<<ASSIGN   6694>>ASSIGN   6694>>ASSIGN   6850>>ASSIGN   6871<<ASSIGN
      6871>>ASSIGN   6873>>ASSIGN   6874<<ASSIGN   6874>>ASSIGN   8277>>IF       8278<<ASSIGN   8278>>ASSIGN
      8278>>ASSIGN   8279<<ASSIGN   8279>>ASSIGN   8286>>ASSIGN
OA$
      6160**DCL      6161--IMP-PTR  6666>>ASSIGN   6670>>ASSIGN   6693>>IF       6694>>ASSIGN   6694>>ASSIGN
      6694>>ASSIGN   6850>>ASSIGN   6871>>ASSIGN   6871>>ASSIGN   6873>>ASSIGN   6874>>ASSIGN   6874>>ASSIGN
      7780>>ASSIGN   7947>>ASSIGN   7972>>ASSIGN   8068>>ASSIGN   8271>>ASSIGN   8272>>ASSIGN   8272>>ASSIGN
      8273>>ASSIGN   8274>>ASSIGN   8274>>ASSIGN   8275>>ASSIGN   8275>>ASSIGN   8276>>ASSIGN   8276>>ASSIGN
      8276>>ASSIGN   8277>>IF       8278>>ASSIGN   8278>>ASSIGN   8278>>ASSIGN   8279>>ASSIGN   8279>>ASSIGN
      8283>>ASSIGN   8285>>ASSIGN   8286>>ASSIGN
OA1$
      6226**DCL      6227--IMP-PTR
ONE_CHANGE IN PROCEDURE CHANGE_TO_STR
      7106**DCL      7109>>CALLBLT  7111>>CALLBLT  7112>>CALLBLT
PV
       111**DCL      7093>>ASSIGN
RA.ACRAH
      6245**DCL      6611>>ASSIGN
RA.RCRAN
      6242**DCL      6622>>ASSIGN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:330  
RA$
      6234**DCL      6235--IMP-PTR
RC.DEF
      6119**DCL      6513>>ASSIGN
RC.DEF.FLAG_OWNER
      6132**DCL      7927<<ASSIGN   7956>>IF       7962<<ASSIGN
RC.DEF.PSTO
      6122**DCL      6514>>IF
RC.DEF.RERA
      6129**DCL      6467<<ASSIGN   7895<<ASSIGN   7925<<ASSIGN   8004<<ASSIGN
RC.DEF.RERS
      6123**DCL      6466<<ASSIGN   7893<<ASSIGN   7923<<ASSIGN   8002<<ASSIGN
RC.DEF.RNL
      6134**DCL      6144--IMP-SIZ  6461>>ASSIGN   6462>>CALL     6463>>IF       6545>>IF       7650>>CALLBLT
      7654>>CALLBLT  7667>>CALLBLT  7820>>CALLBLT  7831>>CALLBLT  7891>>IF       7898>>IF       7921>>IF
      7929>>IF       8000>>IF       8007>>IF       8052>>ASSIGN   8054>>ASSIGN   8122>>ASSIGN
RC.DEF.RSTO
      6124**DCL      6465<<ASSIGN   6503<<ASSIGN   7894<<ASSIGN   7924<<ASSIGN   7974<<ASSIGN   8003<<ASSIGN
RC.DEF.SR
      6125**DCL      6463>>IF       6545>>IF       6667<<ASSIGN   6696<<ASSIGN   7819>>IF       7828>>IF
      7896<<ASSIGN   7900<<ASSIGN   7926<<ASSIGN   7931<<ASSIGN   8005<<ASSIGN   8009<<ASSIGN   8013<<ASSIGN
      8040>>IF
RC.OARCN
      6137**DCL      8062>>ASSIGN
RC.RCFRN
      6143**DCL      7975>>ASSIGN   8014>>ASSIGN   8021>>ASSIGN
RC.RCID
      6136**DCL      7663<>CALL     8055>>ASSIGN
RC.RCRAN
      6135**DCL      6442>>IF       6609>>ASSIGN
RC.RCRSN
      6138**DCL      6516>>ASSIGN   6548>>ASSIGN   6569>>ASSIGN   6588>>ASSIGN
RC.RNAM
      6144**DCL      6462<>CALL     6463>>IF       6545>>IF       7650>>CALLBLT  7654>>CALLBLT  7667>>CALLBLT
      7820>>CALLBLT  7831>>CALLBLT  7891>>IF       7898>>IF       7921>>IF       7929>>IF       8000>>IF
      8007>>IF       8052>>ASSIGN   8054>>ASSIGN   8122>>ASSIGN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:331  
RC$
      6117**DCL      6118--IMP-PTR  6442>>IF       6461>>ASSIGN   6462>>CALL     6462>>CALL     6463>>IF
      6463>>IF       6463>>IF       6465>>ASSIGN   6466>>ASSIGN   6467>>ASSIGN   6503>>ASSIGN   6513>>ASSIGN
      6514>>IF       6516>>ASSIGN   6545>>IF       6545>>IF       6545>>IF       6548>>ASSIGN   6569>>ASSIGN
      6588>>ASSIGN   6609>>ASSIGN   6666>>ASSIGN   6667>>ASSIGN   6696>>ASSIGN   7650>>CALLBLT  7650>>CALLBLT
      7654>>CALLBLT  7654>>CALLBLT  7663>>CALL     7667>>CALLBLT  7667>>CALLBLT  7891>>IF       7891>>IF
      7893>>ASSIGN   7894>>ASSIGN   7895>>ASSIGN   7896>>ASSIGN   7898>>IF       7898>>IF       7900>>ASSIGN
      7921>>IF       7921>>IF       7923>>ASSIGN   7924>>ASSIGN   7925>>ASSIGN   7926>>ASSIGN   7927>>ASSIGN
      7929>>IF       7929>>IF       7931>>ASSIGN   7972<<ASSIGN   7973>>DOWHILE  7974>>ASSIGN   7975>>ASSIGN
      7991>>ASSIGN   8000>>IF       8000>>IF       8002>>ASSIGN   8003>>ASSIGN   8004>>ASSIGN   8005>>ASSIGN
      8007>>IF       8007>>IF       8009>>ASSIGN   8013>>ASSIGN   8014>>ASSIGN   8015<<ASSIGN   8040>>IF
      8052>>ASSIGN   8052>>ASSIGN   8055>>ASSIGN   8062<<ASSIGN   8062>>ASSIGN
RC1$
      6149**DCL      6150--IMP-PTR
READSF
        61**DCL-ENT  6512--CALL     7467--CALL     7563--CALL     7730--CALL     7852--CALL     8046--CALL
RECORD_FOUND
        43**DCL      6454>>IF       6664>>IF       6672>>DOWHILE  6688>>IF       6697>>IF       6702>>IF
      6722>>DOWHILE  6794>>IF       7626>>IF       7694>>IF       7700>>IF       7747>>IF
RECORD_HASH.SUB_OFF
      4271**DCL      8020>>ASSIGN
RECORD_NUM
        30**DCL      7550<<ASSIGN
RLTDP IN PROCEDURE INIT_TYPE_9_DBPARAM
      7059**DCL      7075>>ASSIGN
RS.DEF.DORD
      6266**DCL      7807>>CALLBLT
RS.DEF.MSM
      6268**DCL      7837>>IF
RS.DEF.OSM
      6267**DCL      7834>>IF
RS.DEF.TYPE
      6257**DCL      6572>>IF       6591>>IF       8076>>IF
RS.NPOS
      6280**DCL      6289--REDEF
RS.RCRSH
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:332  
      6278**DCL      7818>>ASSIGN   7827>>ASSIGN   7955>>ASSIGN   8121>>ASSIGN
RS.RCRSN
      6277**DCL      6519>>ASSIGN   6567>>ASSIGN   6586>>ASSIGN   6606>>ASSIGN
RS.RSCDN
      6274**DCL      6525>>ASSIGN   6528>>ASSIGN   7843>>ASSIGN
RS.RSSSN
      6275**DCL      8078>>ASSIGN
RS.SCRSH
      6279**DCL      6517>>ASSIGN   6520>>ASSIGN   6553>>ASSIGN   6571>>ASSIGN   6590>>ASSIGN
RS.SCRSN
      6276**DCL      7788>>ASSIGN   8129>>ASSIGN
RS$
      6254**DCL      6255--IMP-PTR  7787<<ASSIGN   7788<<ASSIGN   7788>>ASSIGN   7807>>CALLBLT  8075<<ASSIGN
      8076>>IF       8078>>ASSIGN   8121>>ASSIGN   8129>>ASSIGN
RVA_KEY
       917**DCL      7140>>ASSIGN
RVA_KEY.NUMBER_OF
       920**DCL      7139<<ASSIGN   7139>>ASSIGN   7482<<ASSIGN   7588>>ASSIGN   7589<<ASSIGN   7595>>ASSIGN
      7596<<ASSIGN   7606>>ASSIGN   7607<<ASSIGN   7613>>ASSIGN   7614<<ASSIGN   7664>>ASSIGN   7665<<ASSIGN
      7671>>ASSIGN   7672<<ASSIGN   8163>>ASSIGN   8164<<ASSIGN   8166>>ASSIGN   8167<<ASSIGN   8174<<ASSIGN
      8181<<ASSIGN   8184>>ASSIGN   8185<<ASSIGN
RVA_NAME
       177**DCL      7538<<CALLBLT  7591>>CALLBLT  7609>>CALLBLT  7667>>CALLBLT  8169<<CALLBLT  8170>>CALLBLT
S IN PROCEDURE INIT_TYPE_9_DBPARAM
      7058**DCL      7080<<CALLBLT  7084>>ASSIGN   7085<<ASSIGN   7085>>ASSIGN   7086>>IF       7087<<ASSIGN
      7087>>ASSIGN   7087>>ASSIGN   7088>>ASSIGN
SAVED_FR_NAMES
       180**DCL      6474<<ASSIGN   6509>>ASSIGN   6657<<ASSIGN   6796>>ASSIGN
SAVE_BUF
        74**DCL      6441<<ASSIGN   6625>>ASSIGN   6656<<ASSIGN   6795>>ASSIGN
SAVE_LAST_RVA
       179**DCL      7588<<ASSIGN   7590>>CALL     7596>>ASSIGN   7606<<ASSIGN   7608>>CALL     7614>>ASSIGN
      7664<<ASSIGN   7666>>CALL     7672>>ASSIGN   8163<<ASSIGN   8167>>ASSIGN   8168>>CALL     8176>>CALL
      8185>>ASSIGN
SAVE_LAST_UWA
       178**DCL      6710<<ASSIGN   6720>>ASSIGN   6777<<ASSIGN   6789>>ASSIGN   6859<<ASSIGN   6868>>ASSIGN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:333  
      7518<<ASSIGN   7536>>ASSIGN   7678<<ASSIGN   7687>>ASSIGN   7709<<ASSIGN   7721>>ASSIGN   8154<<ASSIGN
      8158>>ASSIGN
SC.DEF.SETM
      6084**DCL      7800>>CALLBLT
SC.DEF.SETO
      6086**DCL      7803>>IF       7812>>CALLBLT  7841>>IF       7841>>IF
SC.DEF.SETT
      6092**DCL      6554>>IF       6572>>IF       6591>>IF       7784>>IF       7784>>IF
SC.DEF.SNL
      6093**DCL      6098--IMP-SIZ  6518>>DOWHILE  6522>>IF       6564>>CALLBLT  6583>>CALLBLT  6591>>IF
      6603>>CALLBLT  7609>>CALLBLT  7794>>CALLBLT  8119>>ASSIGN   8120>>ASSIGN
SC.DEF.SNSS
      6087**DCL      7784>>IF
SC.OASCN
      6095**DCL      7939>>ASSIGN   7967>>ASSIGN   8132>>ASSIGN
SC.SCID
      6097**DCL      7605<>CALL     8117>>ASSIGN   8118>>ASSIGN
SC.SCRSN
      6096**DCL      7787>>ASSIGN   8073>>ASSIGN
SC.SNAM
      6098**DCL      6518>>DOWHILE  6522>>IF       6564>>CALLBLT  6583>>CALLBLT  6591>>IF       6603>>CALLBLT
      7609>>CALLBLT  7794>>CALLBLT  8119>>ASSIGN   8120>>ASSIGN
SC$
      6080**DCL      6081--IMP-PTR  7605>>CALL     7609>>CALLBLT  7609>>CALLBLT  7782<<ASSIGN   7784>>IF
      7784>>IF       7784>>IF       7787>>ASSIGN   7794>>CALLBLT  7794>>CALLBLT  7800>>CALLBLT  7803>>IF
      7812>>CALLBLT  7841>>IF       7841>>IF       7904<<ASSIGN   7935<<ASSIGN   7939>>ASSIGN   7949<<ASSIGN
      7967>>ASSIGN   8070<<ASSIGN   8071>>ASSIGN   8073>>ASSIGN   8118>>ASSIGN   8120>>ASSIGN   8120>>ASSIGN
      8132>>ASSIGN
SC1.XXDPN
      6110**DCL      7816--ASSIGN   7877--ASSIGN   7951--ASSIGN   8072--ASSIGN   8131--ASSIGN
SC1$
      6106**DCL      6107--IMP-PTR  7783<<ASSIGN   7816>>ASSIGN   7877>>ASSIGN   7905<<ASSIGN   7936<<ASSIGN
      7950<<ASSIGN   7951>>ASSIGN   8071<<ASSIGN   8072>>ASSIGN   8131>>ASSIGN
SET_FIELDS
       872**DCL-ENT  6462--CALL     7442--CALL     8204--CALL     8205--CALL
SET_FIELD_NUM
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:334  
       873**DCL-ENT  6704--CALL     6715--CALL     6751--CALL     6756--CALL     6783--CALL     6853--CALL
      6863--CALL     7590--CALL     7608--CALL     7666--CALL     7682--CALL     7715--CALL     8168--CALL
      8217--CALL     8230--CALL     8238--CALL
SET_HASH.DBK
      4256**DCL      8084>>IF
SET_HASH.NUM_SM
      4260**DCL      7825>>DOINDEX  7907>>DOINDEX  7953>>DOINDEX  8104>>DOINDEX
SET_HASH.SM_LIST.DBK
      4262**DCL      7908>>IF       7910>>ASSIGN   8105>>IF
SET_HASH.SM_LIST.OFFSET
      4263**DCL      7826>>ASSIGN   7954>>ASSIGN   8108>>ASSIGN
SET_HASH.SO.DBK
      4258**DCL      7878>>IF       7880>>ASSIGN   8100>>IF
SET_HASH.SO.OFFSET
      4259**DCL      7817>>ASSIGN   7963>>ASSIGN   8101>>ASSIGN
SET_HASH.SUB_OFF
      4255**DCL      8116>>ASSIGN
SET_ORDER
       139**DCL      7812>>CALLBLT
SM1$
      6328**DCL      6329--IMP-PTR
SPECIAL_KEY
       905**DCL      7120<<ASSIGN   7140<<ASSIGN   8144<<ASSIGN
SPECIAL_KEY.COUNT
       906**DCL      8281<<ASSIGN
SS.RSSSN
      6344**DCL      8126>>ASSIGN
SS.SSH
      6345**DCL      8081>>ASSIGN   8100>>IF       8101<<ASSIGN   8105>>IF       8108<<ASSIGN
SS$
      6336**DCL      6337--IMP-PTR  8080<<ASSIGN   8081>>ASSIGN   8100>>IF       8101>>ASSIGN   8105>>IF
      8108>>ASSIGN   8126>>ASSIGN
SSCALE
       126**DCL      6882<<ASSIGN   6883>>IF       6884<<ASSIGN   6884>>ASSIGN   6885>>ASSIGN
SSGEN.MAP
       334**DCL      7008>>IF       7010>>IF
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:335  
SSH_LOOP
      8104**LABEL    8109--EXIT
SSS$
      5918**DCL      6516>>ASSIGN   6517>>ASSIGN   6518>>DOWHILE  6519>>ASSIGN   6520>>ASSIGN   6525>>ASSIGN
      6526>>DOWHILE  6528>>ASSIGN   6548>>ASSIGN   6552>>DOWHILE  6553>>ASSIGN   6567>>ASSIGN   6569>>ASSIGN
      6570>>DOWHILE  6571>>ASSIGN   6586>>ASSIGN   6588>>ASSIGN   6589>>DOWHILE  6590>>ASSIGN   6606>>ASSIGN
      6609>>ASSIGN   6610>>DOWHILE  6611>>ASSIGN   6622>>ASSIGN   6666>>ASSIGN   7782>>ASSIGN   7783>>ASSIGN
      7787>>ASSIGN   7788>>ASSIGN   7817>>ASSIGN   7818>>ASSIGN   7819>>IF       7826>>ASSIGN   7827>>ASSIGN
      7828>>IF       7843>>ASSIGN   7844>>DOWHILE  7845>>ASSIGN   7846>>IF       7866>>ASSIGN   7904>>ASSIGN
      7905>>ASSIGN   7935>>ASSIGN   7936>>ASSIGN   7949>>ASSIGN   7950>>ASSIGN   7954>>ASSIGN   7955>>ASSIGN
      7963>>ASSIGN   7972>>ASSIGN   7973>>DOWHILE  7975>>ASSIGN   7976>>DOWHILE  8014>>ASSIGN   8020>>ASSIGN
      8021>>ASSIGN   8024>>DOWHILE  8026>>ASSIGN   8029>>IF       8053>>ASSIGN   8060>>ASSIGN   8062>>ASSIGN
      8070>>ASSIGN   8075>>ASSIGN   8080>>ASSIGN   8116>>ASSIGN   8121>>ASSIGN   8282>>ASSIGN
STATUS
       101**DCL      7983<<ASSIGN   7986<>CALL     8091<<ASSIGN   8094<>CALL
SUBLST
       886**DCL-ENT  6699--CALL     7578--CALL     7631--CALL     7777--CALL
SUBSCHEMA_KEY
       904**DCL       905--REDEF    8280<<ASSIGN
SUBSCHEMA_NAME_4
       176**DCL      7484<<ASSIGN   7487>>CALLBLT  7487>>CALLBLT  7520>>CALLBLT  7538>>CALLBLT  8172>>CALLBLT
      8178>>CALLBLT
SUB_LANGUAGE
      4181**DCL      6702>>IF       6771>>IF       6845>>IF       6851>>IF       6989>>IF       6992>>IF
      6998>>IF       7001>>IF       7004>>IF       7024>>IF       7108>>IF       7108>>IF       7109>>CALLBLT
      7111>>CALLBLT  7112>>CALLBLT  7441>>ASSIGN   7447<<ASSIGN   7479>>IF       7585>>IF       7603>>IF
      7661>>IF       7703>>IF       8142>>IF       8289>>IF
SYNONYM_APL_TYPE
        90**DCL      6999>>ASSIGN
SYNONYM_BASIC_TYPE
        92**DCL      7002>>ASSIGN
SYNONYM_CTYPE
        85**DCL      6993>>ASSIGN
SYNONYM_FORTRAN_TYPE
        94**DCL      7013>>ASSIGN
SYNONYM_FTYPE
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:336  
        88**DCL      6995>>ASSIGN
T1PTR$
       108**DCL      6517<<ASSIGN   6518>>DOWHILE  6518>>DOWHILE  6520<<ASSIGN   6522>>IF       6522>>IF
      6525<<ASSIGN   6526>>DOWHILE  6528<<ASSIGN   6528>>ASSIGN   6548<<ASSIGN   6552>>DOWHILE  6553>>ASSIGN
      6567<<ASSIGN   6567>>ASSIGN   6569<<ASSIGN   6570>>DOWHILE  6571>>ASSIGN   6572>>IF       6586<<ASSIGN
      6586>>ASSIGN   6588<<ASSIGN   6589>>DOWHILE  6590>>ASSIGN   6591>>IF       6606<<ASSIGN   6606>>ASSIGN
      6609<<ASSIGN   6610>>DOWHILE  6611>>ASSIGN   6622<<ASSIGN   6622>>ASSIGN
T2PTR$
       107**DCL      7816<<ASSIGN   7817>>ASSIGN   7825>>DOINDEX  7826>>ASSIGN   7877<<ASSIGN   7878>>IF
      7880>>ASSIGN   7907>>DOINDEX  7908>>IF       7910>>ASSIGN   7951<<ASSIGN   7953>>DOINDEX  7954>>ASSIGN
      7963>>ASSIGN
T5PTR$
       102**DCL      7986<>CALL     7991<<ASSIGN   8015>>ASSIGN   8020<<ASSIGN   8020>>ASSIGN   8021>>ASSIGN
      8023<<ASSIGN   8024>>DOWHILE  8027<<ASSIGN   8086<<ASSIGN   8094<>CALL     8100>>IF       8101>>ASSIGN
      8104>>DOINDEX  8105>>IF       8108>>ASSIGN   8116>>ASSIGN
T6PTR$
       103**DCL      7992<<ASSIGN   8016>>ASSIGN
T7PTR$
       161**DCL      7817<<ASSIGN   7818>>ASSIGN   7826<<ASSIGN   7827>>ASSIGN   7834>>IF       7837>>IF
      7843>>ASSIGN
T8PTR$
       162**DCL      7818<<ASSIGN   7819>>IF       7819>>IF       7820>>CALLBLT  7820>>CALLBLT  7827<<ASSIGN
      7828>>IF       7828>>IF       7831>>CALLBLT  7831>>CALLBLT  7843<<ASSIGN   7844>>DOWHILE  7845>>ASSIGN
      7858>>IF       7866<<ASSIGN   7866>>ASSIGN   8116<<ASSIGN   8117>>ASSIGN   8119>>ASSIGN   8119>>ASSIGN
      8121<<ASSIGN   8122>>ASSIGN   8122>>ASSIGN
T9PTR$
       163**DCL      6611<<ASSIGN   6620>>CALLBLT  6620>>CALLBLT  7845<<ASSIGN   7846>>IF       7848>>IF
      7850<<ASSIGN   7850>>ASSIGN   7851>>ASSIGN   7856>>ASSIGN   7856>>ASSIGN   7954<<ASSIGN   7955<<ASSIGN
      7955>>ASSIGN   7956>>IF       7962>>ASSIGN   7963<<ASSIGN   7964<>CALL     8044<<ASSIGN   8045>>ASSIGN
      8053<<ASSIGN   8054>>ASSIGN   8054>>ASSIGN
TEMP_PTR$
        70**DCL      8270<>CALL
TEMP_WORD
        44**DCL      6705<<CALLBLT  6707>>CALLBLT  6712>>CALLBLT  6854<<CALLBLT  6856>>CALLBLT  6861>>CALLBLT
      7081<<ASSIGN   7082<>CALL     7083>>ASSIGN   8170<<CALLBLT  8172>>CALLBLT  8177<<CALLBLT  8178>>CALLBLT
TN_S
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:337  
       129**DCL      6879>>ASSIGN
TPTR$
       104**DCL      6483<<ASSIGN   6484>>DOWHILE  6485>>IF       6487>>CALL     6488>>ASSIGN   6506<<ASSIGN
      6506>>ASSIGN   6516<<ASSIGN   6517>>ASSIGN   6518>>DOWHILE  6519<<ASSIGN   6519>>ASSIGN   6520>>ASSIGN
      6525>>ASSIGN   6553<<ASSIGN   6554>>IF       6564>>CALLBLT  6564>>CALLBLT  6571<<ASSIGN   6572>>IF
      6583>>CALLBLT  6583>>CALLBLT  6590<<ASSIGN   6591>>IF       6591>>IF       6591>>IF       6603>>CALLBLT
      6603>>CALLBLT  7092<<ASSIGN   7093>>ASSIGN   8014<<ASSIGN   8021<<ASSIGN   8023>>ASSIGN   8024>>DOWHILE
      8026<<ASSIGN   8026>>ASSIGN   8027>>ASSIGN   8029>>IF       8030>>ASSIGN   8031>>ASSIGN   8032>>ASSIGN
      8035>>ASSIGN   8036>>ASSIGN   8037>>ASSIGN   8038>>ASSIGN   8039>>ASSIGN   8042>>IF       8044>>ASSIGN
      8050>>ASSIGN   8050>>ASSIGN   8053>>ASSIGN   8072<<ASSIGN   8084>>IF       8086>>ASSIGN
TYPE IN PROCEDURE WRITE_RVA
      7129**DCL      7128--PROC     7131<>CALL
TYPE_100.TYPE
      4542**DCL      7565>>DOCASE
TYPE_300.INFO
      4759**DCL      4760--REDEF
TYPE_36
      5274**DCL      8124--CALL
TYPE_36.MEM_RECORD_NM
      5282**DCL      8122<<ASSIGN
TYPE_36.SET_NAME
      5277**DCL      8118<<ASSIGN
TYPE_36.SET_OWNER_NAME
      5276**DCL      8117<<ASSIGN
TYPE_36.SUB_SET_NM
      5281**DCL      8120<<ASSIGN
TYPE_36.SUB_SET_OWNER_NM
      5280**DCL      8119<<ASSIGN
TYPE_37
      5314**DCL      8056--CALL
TYPE_37.RECORD_NAME
      5316**DCL      8055<<ASSIGN
TYPE_37.SUB_FIELD_NM
      5320**DCL      8047<<ASSIGN   8050<<ASSIGN
TYPE_37.SUB_RECORD_NM
      5322**DCL      8054<<ASSIGN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:338  
TYPE_37.SUB_RECORD_ST_NM
      5321**DCL      8052<<ASSIGN
TYPE_400.ALIASED
      4883**DCL      7647>>IF
TYPE_400.ID_NUM
      4865**DCL      6662<<ASSIGN   6692<<ASSIGN   7889<<ASSIGN   7919<<ASSIGN   7998<<ASSIGN
TYPE_400.INFO
      4866**DCL      4867--REDEF    6513<<ASSIGN
TYPE_400.LAST_FILLER_LEN
      4887**DCL      7673>>IF       7682<>CALL
TYPE_400.LAST_FILLER_TEXT
      4886**DCL      7675>>CALLBLT  7680>>CALLBLT
TYPE_400.PRIMARY_FIELD_NUM
      4885**DCL      6530<<ASSIGN   6533<<ASSIGN
TYPE_400.RECORD_NAME
      4861**DCL      6659<<ASSIGN   6689<<ASSIGN   7649>>CALLBLT  7650>>CALLBLT  7885<<ASSIGN   7915<<ASSIGN
      7994<<ASSIGN
TYPE_400.REF_LINE
      4859**DCL      6661<<ASSIGN   6691<<ASSIGN   7888<<ASSIGN   7918<<ASSIGN   7997<<ASSIGN
TYPE_400.SUB_RECORD_NAME
      4863**DCL      6660<<ASSIGN   6690<<ASSIGN   7886<<ASSIGN   7887<>CALL     7916<<ASSIGN   7917<>CALL
      7995<<ASSIGN   7996<>CALL
TYPE_400.TYPE
      4858**DCL      7884<<ASSIGN   7914<<ASSIGN   7993<<ASSIGN
TYPE_420.AREA_NAME
      4973**DCL      6451<<ASSIGN
TYPE_420.SOUR_LINE
      4972**DCL      6450<<ASSIGN
TYPE_420.SUB_AREA_NAME
      4975**DCL      6452<<ASSIGN
TYPE_430.DATA_TYPE
      5045**DCL      6767>>CALLBLT  6779>>CALLBLT  6781>>IF       6849>>ASSIGN   6872>>ASSIGN   6877>>ASSIGN
      6878>>ASSIGN   6879>>ASSIGN   6926>>IF       6990<<ASSIGN   6991<<ASSIGN   6993<<ASSIGN   6993>>ASSIGN
      6995<<ASSIGN   6995>>ASSIGN   6996>>IF       6999<<ASSIGN   7002<<ASSIGN   7009<<ASSIGN   7011<<ASSIGN
      7013<<ASSIGN   7064>>IF       7075>>ASSIGN   7093>>ASSIGN   7711>>CALLBLT  7713>>IF
TYPE_430.EIS.ADDER
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:339  
      5055**DCL      5056--REDEF    5057--REDEF
TYPE_430.EIS.ADDER_C.OFFSET
      5059**DCL      6878<<ASSIGN
TYPE_430.EIS.ADDER_C.REG
      5058**DCL      6876<<ASSIGN
TYPE_430.EIS.ADSC.N
      5101**DCL      6889<<ASSIGN
TYPE_430.EIS.EIS_BITS
      5060**DCL      5061--REDEF    5065--REDEF    5093--REDEF
TYPE_430.EIS.EIS_TN_S.TN_S
      5063**DCL      6879<<ASSIGN
TYPE_430.EIS.NDSC.CN
      5066**DCL      6877<<ASSIGN
TYPE_430.EIS.NDSC.N
      5092**DCL      6886<<ASSIGN
TYPE_430.EIS.NDSC.SF
      5088**DCL      6885<<ASSIGN
TYPE_430.ELEMENTARY
      5049**DCL      6493<<ASSIGN   6683<<ASSIGN   6734<<ASSIGN   6736<<ASSIGN
TYPE_430.FIELD_NAME
      5040**DCL      6488<<ASSIGN   6489>>ASSIGN   6677<<ASSIGN   6727<<ASSIGN   7080>>CALLBLT  7081>>ASSIGN
TYPE_430.FLAGS.TYPE
      5104**DCL      7722>>IF
TYPE_430.INFO
      5102**DCL      5103--REDEF
TYPE_430.LEN_FIELD
      5046**DCL      6783<>CALL     6874>>ASSIGN   6886>>ASSIGN   6889>>ASSIGN   6928<<ASSIGN   6937<<ASSIGN
      7026<<ASSIGN   7030<<ASSIGN   7074>>ASSIGN   7077>>ASSIGN   7715<>CALL
TYPE_430.LEVEL_FIELD
      5048**DCL      6733<<ASSIGN
TYPE_430.OFFSET
      5044**DCL      6492<<ASSIGN   6681<<ASSIGN   6731<<ASSIGN   6873<<ASSIGN   6877>>ASSIGN   6878>>ASSIGN
      7079>>ASSIGN
TYPE_430.REF_LINE
      5038**DCL      6491<<ASSIGN   6682<<ASSIGN   6732<<ASSIGN
TYPE_430.SCALE_FIELD
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:340  
      5047**DCL      6882>>ASSIGN   6929<<ASSIGN   6930>>IF       6931<<ASSIGN   6931>>ASSIGN   6933<<ASSIGN
      6933>>ASSIGN   6938<<ASSIGN   7027<<ASSIGN   7031<<ASSIGN   7077>>ASSIGN   7078>>ASSIGN   7089>>IF
TYPE_430.SUB_FIELD_NAME
      5042**DCL      6489<<ASSIGN   6490<>CALL     6678<<ASSIGN   6679<>CALL     6728<<ASSIGN   6729<>CALL
      6767>>CALLBLT  6773>>CALLBLT  6774>>CALLBLT  6779>>CALLBLT  7705>>CALLBLT  7706>>CALLBLT  7711>>CALLBLT
      7853>>ASSIGN   8047>>ASSIGN
TYPE_430.TYPE
      5037**DCL      6680<<ASSIGN   6730<<ASSIGN
TYPE_430_SIZE_FROM_EIS
      6914**PROC     7022--CALL
TYPE_9
      4099**DCL      6739<>CALL
TYPE_9.BUWA
      4112**DCL      7063<<ASSIGN
TYPE_9.DB_KEY
      4151**DCL      7094>>IF
TYPE_9.FLD_NM
      4110**DCL      7062<<ASSIGN
TYPE_9.F_DBK
      4115**DCL      7067<<ASSIGN   7071<<ASSIGN   7094>>IF
TYPE_9.INTEGER_TYPE
      4160**DCL      7095<<ASSIGN
TYPE_9.LENGTH
      4125**DCL      7074<<ASSIGN
TYPE_9.LEVEL
      4123**DCL      7073<<ASSIGN
TYPE_9.LTDP
      4126**DCL      7075<<ASSIGN   7076>>IF       7077<<ASSIGN
TYPE_9.NAME
      4170**DCL      7083<<ASSIGN
TYPE_9.NAME_SIZE
      4169**DCL      7084<<ASSIGN
TYPE_9.NUMERIC
      4135**DCL      6880>>IF       7090<<ASSIGN   7091<<ASSIGN
TYPE_9.OFFSET
      4167**DCL      7079<<ASSIGN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:341  
TYPE_9.RTDP
      4127**DCL      7078<<ASSIGN   7092--ASSIGN
TYPE_9.SIZE
      4100**DCL      7088<<ASSIGN
TYPE_9.SRF_DBK
      4106**DCL      7066<<ASSIGN   7070<<ASSIGN
TYPE_9.TYPE
      4103**DCL      7061<<ASSIGN
UCLOSE
       893**DCL-ENT  8249--CALL     8257--CALL
UGET
       891**DCL-ENT  8251--CALL     8255--CALL
UNITS_PER_WORD
        75**DCL      6872>>ASSIGN
UOPEN
       890**DCL-ENT  7556--CALL     8250--CALL
UPUT
       892**DCL-ENT  8056--CALL     8124--CALL
UWA.AC.CALC_NEXT
      2057**DCL      2058--REDEF
UWA.AC.CALC_PRIOR
      2066**DCL      2067--REDEF
UWA.AC.DEFAULTS
      2018**DCL      2019--REDEF
UWA.AC.FILE_CODE
      2023**DCL      2024--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      2020**DCL      2021--REDEF
UWA.DB_STATUS
      1949**DCL      6458>>IF       6688>>IF       6794>>IF
UWA.DIRECT_REF
      1958**DCL      6674>>ASSIGN   6676<<ASSIGN   6724>>ASSIGN   6726<<ASSIGN   7980>>ASSIGN   8084>>IF
UWA.FR.BUFFLOC
      2127**DCL      6928--ASSIGN   6929--ASSIGN   6937--ASSIGN
UWA.FR.FTYPE
      2114**DCL      6988>>ASSIGN   6999>>ASSIGN   7002>>ASSIGN   7006>>DOCASE   7013>>ASSIGN
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:342  
UWA.SN.SENAME
      2176**DCL      6451>>ASSIGN   6452>>ASSIGN   6677>>ASSIGN   6678>>ASSIGN   6727>>ASSIGN   6728>>ASSIGN
      7885>>ASSIGN   7886>>ASSIGN   7915>>ASSIGN   7916>>ASSIGN   7986<>CALL     7994>>ASSIGN   7995>>ASSIGN
      8094<>CALL
UWA_KEY
       912**DCL      7120>>ASSIGN   8144>>ASSIGN
UWA_KEY.NUMBER_OF
       915**DCL      6710>>ASSIGN   6711<<ASSIGN   6719>>ASSIGN   6720<<ASSIGN   6777>>ASSIGN   6778<<ASSIGN
      6788>>ASSIGN   6789<<ASSIGN   6859>>ASSIGN   6860<<ASSIGN   6867>>ASSIGN   6868<<ASSIGN   7119<<ASSIGN
      7119>>ASSIGN   7481<<ASSIGN   7518>>ASSIGN   7519<<ASSIGN   7535>>ASSIGN   7536<<ASSIGN   7678>>ASSIGN
      7679<<ASSIGN   7686>>ASSIGN   7687<<ASSIGN   7709>>ASSIGN   7710<<ASSIGN   7720>>ASSIGN   7721<<ASSIGN
      8154>>ASSIGN   8155<<ASSIGN   8157>>ASSIGN   8158<<ASSIGN
VALIDS.AREA_XREF
       288**DCL      7576>>IF
VALIDS.FR_NAMES
       287**DCL      6474>>ASSIGN   6475<<ASSIGN   6509<<ASSIGN   6657>>ASSIGN   6658<<ASSIGN   6796<<ASSIGN
VALIDS.ICLST
       283**DCL      8196>>IF
VALIDS.PARAM_XREF
       290**DCL      6697>>IF       6748>>IF
VALIDS.RECORD_XREF
       289**DCL      6545>>IF       7629>>IF       7634>>IF       7643>>IF       7767<<ASSIGN
VALIDS.SET_XREF
       291**DCL      7775>>IF       7784>>IF
VALIDS.XLST
       282**DCL      8194>>IF
WARNING
       870**DCL-ENT  6464--CALL
WORD36
       133**DCL      7468>>ASSIGN   7469>>IF       7470<<ASSIGN   8131<<ASSIGN
WORD_OFFSET
       202**DCL      6752<<ASSIGN   6753<<CALLBLT  6765>>CALLBLT
WRIT64
        64**DCL-ENT  8288--CALL
WRITE_RVA
      7128**PROC     6790--CALL     7587--CALL     7605--CALL     7663--CALL     7724--CALL
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:343  
WRITE_UWA
      7118**PROC     6709--CALL     6718--CALL     6776--CALL     6787--CALL     6858--CALL     6866--CALL
      7489--CALL     7491--CALL     7493--CALL     7495--CALL     7497--CALL     7499--CALL     7501--CALL
      7503--CALL     7505--CALL     7507--CALL     7509--CALL     7511--CALL     7513--CALL     7515--CALL
      7517--CALL     7522--CALL     7524--CALL     7526--CALL     7528--CALL     7530--CALL     7532--CALL
      7534--CALL     7677--CALL     7685--CALL     7708--CALL     7719--CALL     8153--CALL     8156--CALL
WRITSF
        63**DCL-ENT  6535--CALL     6739--CALL     7471--CALL     8244--CALL     8246--CALL     8253--CALL
      8264--CALL
ZIG$FIN_AS
        57**DCL-ENT  8209--CALL
ZIG$G_DYN_MEM_6
       879**DCL-ENT  8270--CALL
ZIG$HASH_IT
        60**DCL-ENT  7986--CALL     8094--CALL
ZIG$INIT_AS
        56**DCL-ENT  7541--CALL
ZIG$SS_RVAR
       902**DCL-ENT  8145--CALL
ZIG$SS_WVAR
       903**DCL-ENT  7121--CALL     7141--CALL     8149--CALL     8284--CALL
ZIG$V_AREA
        48**DCL-ENT  7584--CALL
ZIG$V_AREA_REC
        51**DCL-ENT  6453--CALL     7695--CALL
ZIG$V_CHECK_F
      6439**PROC     7627--CALL     7753--CALL     7902--CALL     7933--CALL     8011--CALL
ZIG$V_DESC
        53**DCL-ENT  8291--CALL
ZIG$V_FIELD
        52**DCL-ENT  6495--CALL     6684--CALL     6737--CALL     7702--CALL
ZIG$V_OA
        47**DCL-ENT  7540--CALL
ZIG$V_PERMIT
        55**DCL-ENT  8197--CALL
ZIG$V_PROHIB
PL6.E3A0      #001=ZIG$V_DRIVER File=ZIG$V_DRIVER.:ZIC0TSI                       FRI 09/05/97 12:19 Page:344  
        54**DCL-ENT  8195--CALL
ZIG$V_RECORD
        50**DCL-ENT  6663--CALL     6695--CALL     7642--CALL     7890--CALL     7920--CALL     7999--CALL
ZIG$V_SET
        49**DCL-ENT  7602--CALL
ZIG$ZERO_ALT_TABLE
        58**DCL-ENT  7639--CALL     7761--CALL     7903--CALL     7934--CALL     8012--CALL

PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:345  
     2130        1        /*T***********************************************************/
     2131        2        /*T*                                                         */
     2132        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2133        4        /*T*                                                         */
     2134        5        /*T***********************************************************/
     2135        6        FLAG_OWNER:
     2136        7            PROC (RC_PTR$);
     2137        8    1   DCL RC_PTR$ PTR;
     2138        9    1   DCL PT1PTR$ PTR AUTO;
     2139       10    1   DCL PT2PTR$ PTR AUTO;
     2140       11        %INCLUDE ZIG_SSS;
     2141      581        %SS_GENERAL(PSTCLASS=EXT);
     2142      602        %RC(PSTCLASS=EXT);
     2143      635        %SC(PSTCLASS=EXT);
     2144      662        %RS(PSTCLASS=EXT);
     2145      736    1       RC_PTR$ -> RC.DEF.RERA = '1'B;
     2146      737    1       PT1PTR$ = PINCRW(SSS$, RC_PTR$ -> RC.RCRSN);
     2147      738    2       DO WHILE (PT1PTR$ ~= SSS$);
     2148      739    2           IF PT1PTR$ -> RS.DEF.TYPE = '000000100000'B
     2149      740    3           THEN DO;
     2150      741    3               PT2PTR$ = PINCRW(SSS$, PT1PTR$ -> RS.SCRSH);
     2151      742    3               PT2PTR$ = PINCRW(SSS$, PT2PTR$ -> SC.SCRSN);
     2152      743        /*
     2153      744              Got the SC record.
     2154      745        */
     2155      746    3               PT2PTR$ = PINCRW(SSS$, PT2PTR$ -> RS.RCRSH);
     2156      747    3               CALL FLAG_OWNER(PT2PTR$);
     2157      748    3               END;
     2158      749    2           PT1PTR$ = PINCRW(SSS$, PT1PTR$ -> RS.RCRSN);
     2159      750    2           END;
     2160      751    1       RETURN;
     2161      752    1   END FLAG_OWNER;

PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:346  
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure FLAG_OWNER.

   Procedure FLAG_OWNER requires 46 words for executable code.
   Procedure FLAG_OWNER requires 8 words of local(AUTO) storage.

    No errors detected in file ZIG$V_DRIVER.:ZIC0TSI    .

PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:347  

 Object Unit name= FLAG_OWNER                                 File name= ZIG$V_DRIVER.:ZIC0TOU
 UTS= SEP 05 '97 12:21:49.04 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  SSS$
    1  LblCom even  none     1      1  RC$
    2  LblCom even  none     1      1  SC$
    3  LblCom even  none     1      1  RS$
    4   Proc  even  none    46     56  FLAG_OWNER
    5  RoData even  none     1      1  FLAG_OWNER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  FLAG_OWNER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:348  


     2130        1        /*T***********************************************************/
     2131        2        /*T*                                                         */
     2132        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2133        4        /*T*                                                         */
     2134        5        /*T***********************************************************/
     2135        6        FLAG_OWNER:
     2136        7            PROC (RC_PTR$);

      7  4 000000   000000 700200 xent  FLAG_OWNER   TSX0  ! X66_AUTO_1
         4 000001   000010 000001                    ZERO    8,1

     2137        8    1   DCL RC_PTR$ PTR;
     2138        9    1   DCL PT1PTR$ PTR AUTO;
     2139       10    1   DCL PT2PTR$ PTR AUTO;
     2140       11        %INCLUDE ZIG_SSS;
     2141      581        %SS_GENERAL(PSTCLASS=EXT);
     2142      602        %RC(PSTCLASS=EXT);
     2143      635        %SC(PSTCLASS=EXT);
     2144      662        %RS(PSTCLASS=EXT);
     2145      736    1       RC_PTR$ -> RC.DEF.RERA = '1'B;

    736  4 000002   200003 470500                    LDP0    @RC_PTR$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   004000 236007                    LDQ     2048,DL
         4 000005   100000 256100                    ORSQ    0,,PR1

     2146      737    1       PT1PTR$ = PINCRW(SSS$, RC_PTR$ -> RC.RCRSN);

    737  4 000006   000000 471500                    LDP1    0,,PR0
         4 000007   100002 720100                    LXL0    2,,PR1
         4 000010   000000 636010                    EAQ     0,X0
         4 000011   000000 036000 0                  ADLQ    SSS$
         4 000012   200004 756100                    STQ     PT1PTR$,,AUTO

     2147      738    2       DO WHILE (PT1PTR$ ~= SSS$);

PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:349  
    738  4 000013   000000 116000 0                  CMPQ    SSS$
         4 000014   000055 600000 4                  TZE     s:751

     2148      739    2           IF PT1PTR$ -> RS.DEF.TYPE = '000000100000'B

    739  4 000015   200004 470500                    LDP0    PT1PTR$,,AUTO
         4 000016   000000 236100                    LDQ     0,,PR0
         4 000017   777700 376003                    ANQ     -64,DU
         4 000020   004000 116003                    CMPQ    2048,DU
         4 000021   000046 601000 4                  TNZ     s:749

     2149      740    3           THEN DO;

     2150      741    3               PT2PTR$ = PINCRW(SSS$, PT1PTR$ -> RS.SCRSH);

    741  4 000022   000003 720100                    LXL0    3,,PR0
         4 000023   000000 636010                    EAQ     0,X0
         4 000024   000000 036000 0                  ADLQ    SSS$
         4 000025   200005 756100                    STQ     PT2PTR$,,AUTO

     2151      742    3               PT2PTR$ = PINCRW(SSS$, PT2PTR$ -> SC.SCRSN);

    742  4 000026   200005 471500                    LDP1    PT2PTR$,,AUTO
         4 000027   100002 220100                    LDX0    2,,PR1
         4 000030   000000 636010                    EAQ     0,X0
         4 000031   000000 036000 0                  ADLQ    SSS$
         4 000032   200005 756100                    STQ     PT2PTR$,,AUTO

     2152      743        /*
     2153      744              Got the SC record.
     2154      745        */
     2155      746    3               PT2PTR$ = PINCRW(SSS$, PT2PTR$ -> RS.RCRSH);

    746  4 000033   200005 471500                    LDP1    PT2PTR$,,AUTO
         4 000034   100003 220100                    LDX0    3,,PR1
         4 000035   000000 636010                    EAQ     0,X0
         4 000036   000000 036000 0                  ADLQ    SSS$
PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:350  
         4 000037   200005 756100                    STQ     PT2PTR$,,AUTO

     2156      747    3               CALL FLAG_OWNER(PT2PTR$);

    747  4 000040   200005 631500                    EPPR1   PT2PTR$,,AUTO
         4 000041   200006 451500                    STP1    PT2PTR$+1,,AUTO
         4 000042   200006 630500                    EPPR0   PT2PTR$+1,,AUTO
         4 000043   000000 631400 5                  EPPR1   0
         4 000044   000000 701000 4                  TSX1    s:7
         4 000045   000000 011000                    NOP     0

     2157      748    3               END;

     2158      749    2           PT1PTR$ = PINCRW(SSS$, PT1PTR$ -> RS.RCRSN);

    749  4 000046   200004 470500                    LDP0    PT1PTR$,,AUTO
         4 000047   000002 720100                    LXL0    2,,PR0
         4 000050   000000 636010                    EAQ     0,X0
         4 000051   000000 036000 0                  ADLQ    SSS$
         4 000052   200004 756100                    STQ     PT1PTR$,,AUTO

     2159      750    2           END;

    750  4 000053   000000 116000 0                  CMPQ    SSS$
         4 000054   000015 601000 4                  TNZ     s:739

     2160      751    1       RETURN;

    751  4 000055   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   5     000   000001 000000                                                    ....
     2161      752    1   END FLAG_OWNER;

PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:351  
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure FLAG_OWNER.

   Procedure FLAG_OWNER requires 46 words for executable code.
   Procedure FLAG_OWNER requires 8 words of local(AUTO) storage.

    No errors detected in file ZIG$V_DRIVER.:ZIC0TSI    .
PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:352  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:353  
          MINI XREF LISTING

FLAG_OWNER
         6**PROC      747--CALL
PT1PTR$
         9**DCL       737<<ASSIGN    738>>DOWHILE   739>>IF        741>>ASSIGN    749<<ASSIGN    749>>ASSIGN
PT2PTR$
        10**DCL       741<<ASSIGN    742<<ASSIGN    742>>ASSIGN    746<<ASSIGN    746>>ASSIGN    747<>CALL
RC.DEF.RERA
       617**DCL       736<<ASSIGN
RC.DEF.RNL
       622**DCL       632--IMP-SIZ
RC.RCRSN
       626**DCL       737>>ASSIGN
RC$
       605**DCL       606--IMP-PTR
RC_PTR$
         8**DCL         6--PROC      736>>ASSIGN    737>>ASSIGN
RS.DEF.TYPE
       667**DCL       739>>IF
RS.NPOS
       690**DCL       699--REDEF
RS.RCRSH
       688**DCL       746>>ASSIGN
RS.RCRSN
       687**DCL       749>>ASSIGN
RS.SCRSH
       689**DCL       741>>ASSIGN
RS$
       664**DCL       665--IMP-PTR
SC.DEF.SNL
       651**DCL       656--IMP-SIZ
SC.SCRSN
       654**DCL       742>>ASSIGN
PL6.E3A0      #002=FLAG_OWNER File=ZIG$V_DRIVER.:ZIC0TSI                         FRI 09/05/97 12:21 Page:354  
SC$
       638**DCL       639--IMP-PTR
SSS$
       600**DCL       737>>ASSIGN    738>>DOWHILE   741>>ASSIGN    742>>ASSIGN    746>>ASSIGN    749>>ASSIGN
