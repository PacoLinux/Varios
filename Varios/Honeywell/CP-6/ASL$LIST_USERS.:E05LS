VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:1    
        1        1        /*M* ASL$LIST_ALL_USERS: Routine to list users.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_USERS: PROC ;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_USERS
       13       13             CALL:     CALL ASL$LIST_ALL_USERS
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_USERS is a subroutine to handle
       17       17                           the LIST/DISPLAY USER command for SUPER.
       18       18                           ASL$LIST_ALL_USERS will parse the LIST/DISPLAY
       19       19                           command and then cause the appropriate user
       20       20                           record(s) to be input into memory where the
       21       21                           other routines that deal with users
       22       22                           records will work with it.  Those routines are:
       23       23                                 ASL$LIST_OUT
       24       24                                 ASL$LIST_OPTS
       25       25                           These routines reside in the ASL$EXT module.
       26       26        */
       27       27        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:2    
       28       28        /********************************************************************/
       29       29        /*   Include files   include files   include files   include files  */
       30       30        /********************************************************************/
       31       31        %INCLUDE AS_PERR_C;
       32      633        %INCLUDE AS_SUPER_C;
       33     1068        %INCLUDE AS_SUBS_C;
       34     2482        %INCLUDE AS_ENTRIES_M;
       35     3532        %INCLUDE OCI_SUBS_C;
       36     3630        %INCLUDE AS_SSUBS_C;
       37     3722        %INCLUDE AS_MAC_C;
       38     3802        %INCLUDE CP_6_SUBS;
       39     4342        %INCLUDE KL_SUPER_C;
       40     7244        %INCLUDE XU_MACRO_C;
       41    10350        %INCLUDE XU_FORMAT_C;
       42    10512        %INCLUDE AS_SUPER_R;
       43    13528        /********************************************************************/
       44    13529        /*   Parameters      parameters      parameters      parameters     */
       45    13530        /********************************************************************/
       46    13531        /********************************************************************/
       47    13532        /*   Static data     static data     static data     static data    */
       48    13533        /********************************************************************/
       49    13534        /********************************************************************/
       50    13535        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       51    13536        /********************************************************************/
       52    13537        %ASB$KEYMAKER ;
       53    13540        %ASB$GET ;
       54    13543        %ASB$INIT_GET_NEXT ;
       55    13546        %ASB$GET_NEXT ;
       56    13549        %ASB$READ_USERS ;
       57    13552        %ASB$WRITE_LO ;
       58    13555        %ASH$INFO ;
       59    13558        %ASL$LIST_OUT ;
       60    13561        %ASL$LIST_OPTS ;
       61    13564    1   DCL X$FORMAT ENTRY(1);
       62    13565        /********************************************************************/
       63    13566        /*   Local based     local based     local based     local based    */
       64    13567        /********************************************************************/
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:3    
       65    13568        %PARSE$OUT( NAME=P$B, STCLASS="BASED(NODE$)",
       66    13569                    NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       67    13614        %AS_USERS ( STR_NAME = USERS_PROJ, STCLASS = "BASED (DSEG2$) " );
       68    13792        /********************************************************************/
       69    13793        /*   Auto data       auto data       auto data       auto data      */
       70    13794        /********************************************************************/
       71    13795    1   DCL CODE2                         UBIN;
       72    13796    1   DCL COUNT                         UBIN WORD ;
       73    13797    1   DCL DISP                          BIT(1);
       74    13798    1   DCL I                             UBIN;
       75    13799    1   DCL JCL                           BIT(1);
       76    13800    1   DCL MACCT                         CHAR(21);
       77    13801
       78    13802    1   DCL DO_FLAG(0:143) BIT(1);
       79    13803    1   DCL 1 DOFLAG REDEF DO_FLAG,
       80    13804    1          2 MODE(0:4) BIT(1) UNAL,
       81    13805    1          2 OPTS1(0:98) BIT(1) UNAL ,
       82    13806    1          2 FE_MODE(0:3) BIT(1) UNAL,
       83    13807    1          2 OPTS2(0:35) BIT(1) UNAL;
       84    13808    1   DCL 1 DOFLAGBITS REDEF DO_FLAG,
       85    13809    1          2 USER BIT(72),
       86    13810    1          2 FE_MODE BIT(36),
       87    13811    1          2 *  BIT(36);
       88    13812        /********************************************************************/
       89    13813        /*   Constant data   constant data   constant data   constant data  */
       90    13814        /********************************************************************/
       91    13815    1   DCL MAKEME_STR  CHAR(0) CONSTANT INIT ('MAKEME ');
       92    13816    1   DCL RESET_STR  CHAR(0) CONSTANT INIT ('RESET');
       93    13817    1   DCL USERS_STR CHAR(0) CONSTANT INIT ('users');
       94    13818    1   DCL ZERO_FLAGS (0:143)  BIT(1) CONSTANT INIT ('0'B*0);
       95    13819
       96    13820        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:4    
       97    13821        /********************************************************************/
       98    13822        /*   Procedure       procedure       procedure       procedure      */
       99    13823        /********************************************************************/
      100    13824    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      101    13825    1   JCL = %NO#;
      102    13826    2   DO SELECT (CODE);
      103    13827
      104    13828    2      SELECT (%LIST_ALL_VAL);
      105    13829
      106    13830    2      DISP = %NO#;
      107    13831    2      JCL = %NO#;
      108    13832    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 0 THEN
      109    13833    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;
      110    13834    2      ELSE
      111    13835    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) ;
      112    13836
      113    13837    2      SELECT (%DISPLAY_ALL_VAL);
      114    13838
      115    13839    2      DISP = %YES#;
      116    13840    2      NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;
      117    13841    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;
      118    13842    3         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) ;
      119    13843    3         IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN
      120    13844    3            JCL = %YES#;
      121    13845    4         ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;
      122    13846    4               IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN
      123    13847    4                  JCL = %YES#;
      124    13848    4               END; /*  Nsublks = 2  */
      125    13849    3         END; /*  Nsublks > 0  */
      126    13850
      127    13851    2      SELECT (%LIST_USER_VAL);
      128    13852
      129    13853    2      DISP = %NO#;
      130    13854    2      JCL = %NO#;
      131    13855    2      IF P_PCB.OUT$ -> P$B.NSUBLKS = 1 THEN
      132    13856    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;
      133    13857    2      ELSE
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:5    
      134    13858    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(1) ;
      135    13859
      136    13860    2      SELECT (%DISPLAY_USER_VAL);
      137    13861
      138    13862    2      DISP = %YES#;
      139    13863    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      140    13864    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      141    13865
      142    13866    4         DO SELECT (CODE2);
      143    13867
      144    13868    4            SELECT (%JCL_VAL);
      145    13869
      146    13870    4            JCL = %YES#;
      147    13871
      148    13872    4            END;  /* Do case (CODE2) */
      149    13873
      150    13874    3         END;  /*  Do i  */
      151    13875
      152    13876    2      IF P_PCB.OUT$ -> P$B.NSUBLKS = 1 THEN  /* Disp user  */
      153    13877    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0);
      154    13878    3      ELSE DO;                               /* Disp user ? */
      155    13879    3         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(1);
      156    13880    3         IF NODE$ -> P$B.NSUBLKS = 1 THEN    /*  Disp user acct  */
      157    13881                                                     /*  Or disp user (jcl) */
      158    13882    3            IF NODE$ -> P$B.SUBLK$(0) -> P$B.CODE = %JCL_VAL THEN
      159    13883    3               NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0);
      160    13884    4            ELSE DO; END;
      161    13885    3         ELSE IF NODE$ -> P$B.NSUBLKS > 1 THEN  /* Disp user acct,name  */
      162    13886                                                      /*  Or disp user acct (jcl) */
      163    13887    3               IF NODE$ -> P$B.SUBLK$(1) -> P$B.CODE = %JCL_VAL THEN
      164    13888    3                  NODE$ -> P$B.NSUBLKS = 1;
      165    13889    3         END;  /*  Nsublks > 1  */
      166    13890
      167    13891    2      END;  /*  Do case (code)  */
      168    13892
      169    13893    1   FDS.NVECS# = 0;
      170    13894    2   IF JCL THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:6    
      171    13895    2      CALL CONCAT (FMT_BUF, '%1/"', USERS_STR, '%1/');
      172    13896    2      FDS.FMT_.BOUND = LENGTHC (USERS_STR) + 6;
      173    13897    2      END;  /*  Jcl  */
      174    13898    2   ELSE DO;
      175    13899    2      CALL CONCAT (FMT_BUF, '%1/', USERS_STR, '%1/');
      176    13900    2      FDS.FMT_.BOUND = LENGTHC (USERS_STR) + 5;
      177    13901    2      END;  /*  Not jcl  */
      178    13902    1   FDS.TABDFLT# = 10;
      179    13903    1   CALL X$FORMAT (FDS);
      180    13904
      181    13905    1   CALL ASB$KEYMAKER( USERS_KEY, P$B, %YES#, %LIST_USER_VAL) ALTRET(JUSTRET);
      182    13906    2   IF DISP THEN DO;
      183    13907    3      IF JCL THEN DO;
      184    13908    3         DOFLAGBITS.USER = DOFLAGBITS.USER | '763777777777777777777777'O;
      185    13909    3         DOFLAGBITS.FE_MODE = DOFLAGBITS.FE_MODE | '777777777777'O;
      186    13910    3         DO_FLAG(L_JCL) = %YES#;
      187    13911    3         END;  /*  Jcl  */
      188    13912    2      ELSE
      189    13913    2         CALL ASL$LIST_OPTS(DO_FLAG);
      190    13914    2      END;  /*  Disp  */
      191    13915    2   ELSE DO;  /*  Not disp  */
      192    13916    2      DO_FLAG = ZERO_FLAGS;
      193    13917    2      END;  /*  Not disp  */
      194    13918    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );            /* A blank line            */
      195    13919    1   FDS.NVECS# = 0 ;
      196    13920    1   IF NOT AS_WILD_USER
      197    13921    2   THEN DO ;
      198    13922    2      CALL ASB$GET( %NO#, %LIST_USER_VAL, AS_USERS, KL_DREC$ ) ALTRET(JUSTRET);
      199    13923    3      IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;
      200    13924    3         MACCT = AS_BLANK;
      201    13925    3         CALL INDEX ( I, ' ', AS_USERS.BUDGET.MACCT.ACCT);
      202    13926    3         CALL CONCAT (MACCT,SUBSTR(AS_USERS.BUDGET.MACCT.ACCT,0,I),
      203    13927    3              ',',AS_USERS.BUDGET.MACCT.NAME);
      204    13928    3         CALL CONCAT (OUT_BUF, MAKEME_STR, MACCT);
      205    13929    3         CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(MACCT) );
      206    13930    3         END;   /*  Jcl and BUDGET.MACCT_ ~= blank  */
      207    13931    2      CALL ASL$LIST_OUT( DO_FLAG );
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:7    
      208    13932    3      IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;
      209    13933    3         CALL CONCAT (OUT_BUF, MAKEME_STR, RESET_STR);
      210    13934    3         CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(RESET_STR) );
      211    13935    3         END;   /*  Jcl and BUDGET.MACCT_ ~= blank  */
      212    13936    2      COUNT = 1 ;
      213    13937    2      END ;
      214    13938    2   ELSE DO ;
      215    13939    2      COUNT = 0 ;
      216    13940    2      CALL ASB$INIT_GET_NEXT( %NO#, %LIST_USER_VAL ) ;
      217    13941    3      DO FOREVER;
      218    13942    3         CALL ASB$GET_NEXT ALTRET( FINISHED ) ;
      219    13943    4         IF JCL THEN DO;
      220    13944    4            IF USERS_KEY.COUNT < 9 THEN GOTO SKIP_THIS_ONE;
      221    13945    4            USERS_KEY.COUNT = 21;
      222    13946    4            USERS_KEY.UKEY.S = 'S';
      223    13947    4            CALL ASB$READ_USERS ( USERS_PROJ )
      224    13948    5            WHENRETURN DO;
      225    13949    5               GOTO SKIP_THIS_ONE;      /*  This is a project, not a user  */
      226    13950    5               END;   /*  Whenreturn from ASB$READ_USERS  */
      227    13951    4            END;  /*  If jcl  */
      228    13952    4         IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;
      229    13953    4            MACCT = AS_BLANK;
      230    13954    4            CALL INDEX ( I, ' ', AS_USERS.BUDGET.MACCT.ACCT);
      231    13955    4            CALL CONCAT (MACCT,SUBSTR(AS_USERS.BUDGET.MACCT.ACCT,0,I),
      232    13956    4                 ',',AS_USERS.BUDGET.MACCT.NAME);
      233    13957    4            CALL CONCAT (OUT_BUF, MAKEME_STR, MACCT);
      234    13958    4            CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(MACCT) );
      235    13959    4            END; /*  Jcl and BUDGET.MACCT_ ~= blank  */
      236    13960    3         CALL ASL$LIST_OUT( DO_FLAG ) ;
      237    13961    4         IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;
      238    13962    4            CALL CONCAT (OUT_BUF, MAKEME_STR, RESET_STR);
      239    13963    4            CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(RESET_STR) );
      240    13964    4            END; /*  Jcl and BUDGET.MACCT_ ~= blank  */
      241    13965    3         COUNT = COUNT + 1 ;
      242    13966    3   SKIP_THIS_ONE:
      243    13967    3         END;
      244    13968    2      END ;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:8    
      245    13969    1   FINISHED:
      246    13970    1   IF DOFLAG.OPTS1 = '0'B AND  DOFLAG.OPTS2 = '0'B AND  FDS.NVECS#  ~= 0
      247    13971    2   THEN DO ;
      248    13972    2      CALL X$FORMAT( FDS ) ;
      249    13973    2      FDS.NVECS# = 0;   /* reset vectors after format/print of users */
      250    13974    2      CALL ASB$WRITE_LO( AS_BLANK, 1 ) ;
      251    13975    2      LIST_ACCT_FLG = '0'B ;
      252    13976    2      END ;
      253    13977    2   IF NOT JCL THEN DO;
      254    13978    3      IF COUNT = 0 THEN DO ;
      255    13979        /*E* ERROR:   ASL-E$NOTHING_TO_LIST-C
      256    13980             MESSAGE: Nothing to list or display.
      257    13981        */
      258    13982              %SCREAM( ERR#=E$NOTHING_TO_LIST, LEVEL=INFO, MID='L' ) ;
      259    13997    3         END ;
      260    13998    3      ELSE DO ;
      261    13999              %NUMBER( NUM1=COUNT ) ;
             14007    3         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, COUNT );
      262    14029    4         IF DISP THEN DO;
      263    14030        /*E* ERROR:   ASL-E$DISP_MESS-C
      264    14031             MESSAGE:.. %U1 users displayed.
      265    14032        */
      266    14033                 %SCREAM( ERR#=E$DISP_MESS, MID='L', LEVEL=INFO ) ;
      267    14048    4            END ;
      268    14049    4         ELSE DO;
      269    14050        /*E* ERROR:   ASL-E$LISTED_MESS-C
      270    14051             MESSAGE:.. %U1 users listed.
      271    14052        */
      272    14053                 %SCREAM( ERR#=E$LISTED_MESS, MID='L', LEVEL=INFO ) ;
      273    14068    4            END ;
      274    14069    3         END; /*  Count > 0  */
      275    14070    2      END; /*  Not jcl  */
      276    14071    1   JUSTRET: ;
      277    14072    1   RETURN ;
      278    14073
      279    14074    1   END ASL$LIST_ALL_USERS;

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:9    
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_USERS.

   Procedure ASL$LIST_ALL_USERS requires 404 words for executable code.
   Procedure ASL$LIST_ALL_USERS requires 22 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_USERS.:E05TSI    .

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:10   

 Object Unit name= ASL$LIST_ALL_USERS                         File name= ASL$LIST_USERS.:E05TOU
 UTS= JUL 29 '97 10:24:12.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     17     21  ASL$LIST_ALL_USERS
    2   Proc  even  none   404    624  ASL$LIST_ALL_USERS
    3  RoData even  none    26     32  ASL$LIST_ALL_USERS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_USERS
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:11   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 ASL$LIST_OPTS
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       1 ASB$READ_USERS
         yes           Std       4 ASB$BINCHAR
         yes           Std       1 X$FORMAT
 yes     yes           Std       4 ASB$KEYMAKER
 yes     yes           Std       6 ASB$GET
         yes           Std       1 ASL$LIST_OUT
 yes     yes           Std       2 ASB$INIT_GET_NEXT
         yes           Std       2 ASH$INFO
 yes     yes           Std       0 ASB$GET_NEXT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_NONE                          r    AS_MODE
r    AS_FE_MODE                       r    KL_DREC$                              M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     OUT_BUF                               NODE$                                 CODE
     LIST_ACCT_FLG                         ERR_CODE                              AS_FIELD1
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG2$                                AS_WILD_USER                          P_PCB
     AS_USERS                              B_VECTNIL
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:12   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:13   


        1        1        /*M* ASL$LIST_ALL_USERS: Routine to list users.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_USERS: PROC ;

      9  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000026 000000                    ZERO    22,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_USERS
       13       13             CALL:     CALL ASL$LIST_ALL_USERS
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_USERS is a subroutine to handle
       17       17                           the LIST/DISPLAY USER command for SUPER.
       18       18                           ASL$LIST_ALL_USERS will parse the LIST/DISPLAY
       19       19                           command and then cause the appropriate user
       20       20                           record(s) to be input into memory where the
       21       21                           other routines that deal with users
       22       22                           records will work with it.  Those routines are:
       23       23                                 ASL$LIST_OUT
       24       24                                 ASL$LIST_OPTS
       25       25                           These routines reside in the ASL$EXT module.
       26       26        */
       27       27        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:14   
       28       28        /********************************************************************/
       29       29        /*   Include files   include files   include files   include files  */
       30       30        /********************************************************************/
       31       31        %INCLUDE AS_PERR_C;
       32      633        %INCLUDE AS_SUPER_C;
       33     1068        %INCLUDE AS_SUBS_C;
       34     2482        %INCLUDE AS_ENTRIES_M;
       35     3532        %INCLUDE OCI_SUBS_C;
       36     3630        %INCLUDE AS_SSUBS_C;
       37     3722        %INCLUDE AS_MAC_C;
       38     3802        %INCLUDE CP_6_SUBS;
       39     4342        %INCLUDE KL_SUPER_C;
       40     7244        %INCLUDE XU_MACRO_C;
       41    10350        %INCLUDE XU_FORMAT_C;
       42    10512        %INCLUDE AS_SUPER_R;
       43    13528        /********************************************************************/
       44    13529        /*   Parameters      parameters      parameters      parameters     */
       45    13530        /********************************************************************/
       46    13531        /********************************************************************/
       47    13532        /*   Static data     static data     static data     static data    */
       48    13533        /********************************************************************/
       49    13534        /********************************************************************/
       50    13535        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       51    13536        /********************************************************************/
       52    13537        %ASB$KEYMAKER ;
       53    13540        %ASB$GET ;
       54    13543        %ASB$INIT_GET_NEXT ;
       55    13546        %ASB$GET_NEXT ;
       56    13549        %ASB$READ_USERS ;
       57    13552        %ASB$WRITE_LO ;
       58    13555        %ASH$INFO ;
       59    13558        %ASL$LIST_OUT ;
       60    13561        %ASL$LIST_OPTS ;
       61    13564    1   DCL X$FORMAT ENTRY(1);
       62    13565        /********************************************************************/
       63    13566        /*   Local based     local based     local based     local based    */
       64    13567        /********************************************************************/
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:15   
       65    13568        %PARSE$OUT( NAME=P$B, STCLASS="BASED(NODE$)",
       66    13569                    NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       67    13614        %AS_USERS ( STR_NAME = USERS_PROJ, STCLASS = "BASED (DSEG2$) " );
       68    13792        /********************************************************************/
       69    13793        /*   Auto data       auto data       auto data       auto data      */
       70    13794        /********************************************************************/
       71    13795    1   DCL CODE2                         UBIN;
       72    13796    1   DCL COUNT                         UBIN WORD ;
       73    13797    1   DCL DISP                          BIT(1);
       74    13798    1   DCL I                             UBIN;
       75    13799    1   DCL JCL                           BIT(1);
       76    13800    1   DCL MACCT                         CHAR(21);
       77    13801
       78    13802    1   DCL DO_FLAG(0:143) BIT(1);
       79    13803    1   DCL 1 DOFLAG REDEF DO_FLAG,
       80    13804    1          2 MODE(0:4) BIT(1) UNAL,
       81    13805    1          2 OPTS1(0:98) BIT(1) UNAL ,
       82    13806    1          2 FE_MODE(0:3) BIT(1) UNAL,
       83    13807    1          2 OPTS2(0:35) BIT(1) UNAL;
       84    13808    1   DCL 1 DOFLAGBITS REDEF DO_FLAG,
       85    13809    1          2 USER BIT(72),
       86    13810    1          2 FE_MODE BIT(36),
       87    13811    1          2 *  BIT(36);
       88    13812        /********************************************************************/
       89    13813        /*   Constant data   constant data   constant data   constant data  */
       90    13814        /********************************************************************/
       91    13815    1   DCL MAKEME_STR  CHAR(0) CONSTANT INIT ('MAKEME ');
       92    13816    1   DCL RESET_STR  CHAR(0) CONSTANT INIT ('RESET');
       93    13817    1   DCL USERS_STR CHAR(0) CONSTANT INIT ('users');
       94    13818    1   DCL ZERO_FLAGS (0:143)  BIT(1) CONSTANT INIT ('0'B*0);
       95    13819
       96    13820        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:16   
       97    13821        /********************************************************************/
       98    13822        /*   Procedure       procedure       procedure       procedure      */
       99    13823        /********************************************************************/
      100    13824    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  13824  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      101    13825    1   JCL = %NO#;

  13825  2 000007   200007 450100                    STZ     JCL,,AUTO

      102    13826    2   DO SELECT (CODE);

  13826  2 000010   000022 116007                    CMPQ    18,DL
         2 000011   000022 602000 2                  TNC     s:13826+10
         2 000012   000025 600000 2                  TZE     s:13830
         2 000013   000144 116007                    CMPQ    100,DL
         2 000014   000017 602000 2                  TNC     s:13826+7
         2 000015   000037 600000 2                  TZE     s:13839
         2 000016   000166 710000 2                  TRA     s:13893
         2 000017   000141 116007                    CMPQ    97,DL
         2 000020   000166 601000 2                  TNZ     s:13893
         2 000021   000102 710000 2                  TRA     s:13862
         2 000022   000007 116007                    CMPQ    7,DL
         2 000023   000166 601000 2                  TNZ     s:13893
         2 000024   000067 710000 2                  TRA     s:13853

      103    13827
      104    13828    2      SELECT (%LIST_ALL_VAL);

      105    13829
      106    13830    2      DISP = %NO#;

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:17   
  13830  2 000025   200005 450100                    STZ     DISP,,AUTO

      107    13831    2      JCL = %NO#;

  13831  2 000026   200007 450100                    STZ     JCL,,AUTO

      108    13832    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 0 THEN

  13832  2 000027   100001 220100                    LDX0    1,,PR1
         2 000030   000034 601000 2                  TNZ     s:13835

      109    13833    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;

  13833  2 000031   000003 236100                    LDQ     3,,PR0
         2 000032   000000 756000 xsym               STQ     NODE$
         2 000033   000166 710000 2                  TRA     s:13893

      110    13834    2      ELSE
      111    13835    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) ;

  13835  2 000034   100003 236100                    LDQ     3,,PR1
         2 000035   000000 756000 xsym               STQ     NODE$
         2 000036   000166 710000 2                  TRA     s:13893

      112    13836
      113    13837    2      SELECT (%DISPLAY_ALL_VAL);

      114    13838
      115    13839    2      DISP = %YES#;

  13839  2 000037   400000 236003                    LDQ     -131072,DU
         2 000040   200005 756100                    STQ     DISP,,AUTO

      116    13840    2      NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;

  13840  2 000041   000003 236100                    LDQ     3,,PR0
         2 000042   000000 756000 xsym               STQ     NODE$
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:18   

      117    13841    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;

  13841  2 000043   100001 220100                    LDX0    1,,PR1
         2 000044   000166 600000 2                  TZE     s:13893

      118    13842    3         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0) ;

  13842  2 000045   100003 236100                    LDQ     3,,PR1
         2 000046   000000 756000 xsym               STQ     NODE$

      119    13843    3         IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN

  13843  2 000047   100003 473500                    LDP3    3,,PR1
         2 000050   300000 721100                    LXL1    0,,PR3
         2 000051   000001 101003                    CMPX1   1,DU
         2 000052   000056 601000 2                  TNZ     s:13845

      120    13844    3            JCL = %YES#;

  13844  2 000053   400000 236003                    LDQ     -131072,DU
         2 000054   200007 756100                    STQ     JCL,,AUTO
         2 000055   000166 710000 2                  TRA     s:13893

      121    13845    4         ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;

  13845  2 000056   000002 100003                    CMPX0   2,DU
         2 000057   000166 601000 2                  TNZ     s:13893

      122    13846    4               IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN

  13846  2 000060   100004 474500                    LDP4    4,,PR1
         2 000061   400000 722100                    LXL2    0,,PR4
         2 000062   000001 102003                    CMPX2   1,DU
         2 000063   000166 601000 2                  TNZ     s:13893

      123    13847    4                  JCL = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:19   

  13847  2 000064   400000 236003                    LDQ     -131072,DU
         2 000065   200007 756100                    STQ     JCL,,AUTO

      124    13848    4               END; /*  Nsublks = 2  */

      125    13849    3         END; /*  Nsublks > 0  */

  13849  2 000066   000166 710000 2                  TRA     s:13893

      126    13850
      127    13851    2      SELECT (%LIST_USER_VAL);

      128    13852
      129    13853    2      DISP = %NO#;

  13853  2 000067   200005 450100                    STZ     DISP,,AUTO

      130    13854    2      JCL = %NO#;

  13854  2 000070   200007 450100                    STZ     JCL,,AUTO

      131    13855    2      IF P_PCB.OUT$ -> P$B.NSUBLKS = 1 THEN

  13855  2 000071   000001 220100                    LDX0    1,,PR0
         2 000072   000001 100003                    CMPX0   1,DU
         2 000073   000077 601000 2                  TNZ     s:13858

      132    13856    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;

  13856  2 000074   000003 236100                    LDQ     3,,PR0
         2 000075   000000 756000 xsym               STQ     NODE$
         2 000076   000166 710000 2                  TRA     s:13893

      133    13857    2      ELSE
      134    13858    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(1) ;

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:20   
  13858  2 000077   000004 236100                    LDQ     4,,PR0
         2 000100   000000 756000 xsym               STQ     NODE$
         2 000101   000166 710000 2                  TRA     s:13893

      135    13859
      136    13860    2      SELECT (%DISPLAY_USER_VAL);

      137    13861
      138    13862    2      DISP = %YES#;

  13862  2 000102   400000 236003                    LDQ     -131072,DU
         2 000103   200005 756100                    STQ     DISP,,AUTO

      139    13863    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  13863  2 000104   000001 235007                    LDA     1,DL
         2 000105   200006 755100                    STA     I,,AUTO
         2 000106   000125 710000 2                  TRA     s:13874+3

      140    13864    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  13864  2 000107   000003 470400 xsym               LDP0    P_PCB+3
         2 000110   200006 720100                    LXL0    I,,AUTO
         2 000111   000003 471510                    LDP1    3,X0,PR0
         2 000112   100000 236100                    LDQ     0,,PR1
         2 000113   777777 376007                    ANQ     -1,DL
         2 000114   200003 756100                    STQ     CODE2,,AUTO

      141    13865
      142    13866    4         DO SELECT (CODE2);

  13866  2 000115   000001 116007                    CMPQ    1,DL
         2 000116   000122 601000 2                  TNZ     s:13874
         2 000117   000120 710000 2                  TRA     s:13870

      143    13867
      144    13868    4            SELECT (%JCL_VAL);
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:21   

      145    13869
      146    13870    4            JCL = %YES#;

  13870  2 000120   400000 236003                    LDQ     -131072,DU
         2 000121   200007 756100                    STQ     JCL,,AUTO

      147    13871
      148    13872    4            END;  /* Do case (CODE2) */

      149    13873
      150    13874    3         END;  /*  Do i  */

  13874  2 000122   200006 235100                    LDA     I,,AUTO
         2 000123   000001 035007                    ADLA    1,DL
         2 000124   200006 755100                    STA     I,,AUTO
         2 000125   000001 236100                    LDQ     1,,PR0
         2 000126   000022 772000                    QRL     18
         2 000127   200006 116100                    CMPQ    I,,AUTO
         2 000130   000132 600000 2                  TZE     s:13876
         2 000131   000107 603000 2                  TRC     s:13864

      151    13875
      152    13876    2      IF P_PCB.OUT$ -> P$B.NSUBLKS = 1 THEN  /* Disp user  */

  13876  2 000132   000001 220100                    LDX0    1,,PR0
         2 000133   000001 100003                    CMPX0   1,DU
         2 000134   000140 601000 2                  TNZ     s:13879

      153    13877    2         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0);

  13877  2 000135   000003 236100                    LDQ     3,,PR0
         2 000136   000000 756000 xsym               STQ     NODE$
         2 000137   000166 710000 2                  TRA     s:13893

      154    13878    3      ELSE DO;                               /* Disp user ? */

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:22   
      155    13879    3         NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(1);

  13879  2 000140   000004 236100                    LDQ     4,,PR0
         2 000141   000000 756000 xsym               STQ     NODE$

      156    13880    3         IF NODE$ -> P$B.NSUBLKS = 1 THEN    /*  Disp user acct  */

  13880  2 000142   000000 471400 xsym               LDP1    NODE$
         2 000143   100001 221100                    LDX1    1,,PR1
         2 000144   000001 101003                    CMPX1   1,DU
         2 000145   000156 601000 2                  TNZ     s:13885

      157    13881                                                     /*  Or disp user (jcl) */
      158    13882    3            IF NODE$ -> P$B.SUBLK$(0) -> P$B.CODE = %JCL_VAL THEN

  13882  2 000146   100003 473500                    LDP3    3,,PR1
         2 000147   300000 722100                    LXL2    0,,PR3
         2 000150   000001 102003                    CMPX2   1,DU
         2 000151   000155 601000 2                  TNZ     s:13884

      159    13883    3               NODE$ = P_PCB.OUT$ -> P$B.SUBLK$(0);

  13883  2 000152   000003 236100                    LDQ     3,,PR0
         2 000153   000000 756000 xsym               STQ     NODE$
         2 000154   000166 710000 2                  TRA     s:13893

      160    13884    4            ELSE DO; END;

  13884  2 000155   000166 710000 2                  TRA     s:13893

      161    13885    3         ELSE IF NODE$ -> P$B.NSUBLKS > 1 THEN  /* Disp user acct,name  */

  13885  2 000156   000002 101003                    CMPX1   2,DU
         2 000157   000166 602000 2                  TNC     s:13893

      162    13886                                                      /*  Or disp user acct (jcl) */
      163    13887    3               IF NODE$ -> P$B.SUBLK$(1) -> P$B.CODE = %JCL_VAL THEN
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:23   

  13887  2 000160   100004 473500                    LDP3    4,,PR1
         2 000161   300000 722100                    LXL2    0,,PR3
         2 000162   000001 102003                    CMPX2   1,DU
         2 000163   000166 601000 2                  TNZ     s:13893

      164    13888    3                  NODE$ -> P$B.NSUBLKS = 1;

  13888  2 000164   000001 223003                    LDX3    1,DU
         2 000165   100001 743100                    STX3    1,,PR1

      165    13889    3         END;  /*  Nsublks > 1  */

      166    13890
      167    13891    2      END;  /*  Do case (code)  */

      168    13892
      169    13893    1   FDS.NVECS# = 0;

  13893  2 000166   000011 450000 xsym               STZ     FDS+9

      170    13894    2   IF JCL THEN DO;

  13894  2 000167   200007 234100                    SZN     JCL,,AUTO
         2 000170   000206 605000 2                  TPL     s:13899

      171    13895    2      CALL CONCAT (FMT_BUF, '%1/"', USERS_STR, '%1/');

  13895  2 000171   000012 236000 1                  LDQ     ZERO_FLAGS+4
         2 000172   000000 756000 xsym               STQ     FMT_BUF
         2 000173   040000 100400                    MLR     fill='040'O
         2 000174   000004 000005 1                  ADSC9   USERS_STR                cn=0,n=5
         2 000175   000001 000005 xsym               ADSC9   FMT_BUF+1                cn=0,n=5
         2 000176   040000 100400                    MLR     fill='040'O
         2 000177   000012 000003 1                  ADSC9   ZERO_FLAGS+4             cn=0,n=3
         2 000200   000002 200366 xsym               ADSC9   FMT_BUF+2                cn=1,n=246

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:24   
      172    13896    2      FDS.FMT_.BOUND = LENGTHC (USERS_STR) + 6;

  13896  2 000201   000000 236000 xsym               LDQ     FDS
         2 000202   177777 376007                    ANQ     65535,DL
         2 000203   000000 276000 3                  ORQ     0
         2 000204   000000 756000 xsym               STQ     FDS

      173    13897    2      END;  /*  Jcl  */

  13897  2 000205   000224 710000 2                  TRA     s:13902

      174    13898    2   ELSE DO;

      175    13899    2      CALL CONCAT (FMT_BUF, '%1/', USERS_STR, '%1/');

  13899  2 000206   000012 236000 1                  LDQ     ZERO_FLAGS+4
         2 000207   000001 376000 3                  ANQ     1
         2 000210   000040 276007                    ORQ     32,DL
         2 000211   000000 756000 xsym               STQ     FMT_BUF
         2 000212   040000 100400                    MLR     fill='040'O
         2 000213   000004 000005 1                  ADSC9   USERS_STR                cn=0,n=5
         2 000214   000000 600005 xsym               ADSC9   FMT_BUF                  cn=3,n=5
         2 000215   040000 100400                    MLR     fill='040'O
         2 000216   000012 000003 1                  ADSC9   ZERO_FLAGS+4             cn=0,n=3
         2 000217   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      176    13900    2      FDS.FMT_.BOUND = LENGTHC (USERS_STR) + 5;

  13900  2 000220   000000 236000 xsym               LDQ     FDS
         2 000221   177777 376007                    ANQ     65535,DL
         2 000222   000002 276000 3                  ORQ     2
         2 000223   000000 756000 xsym               STQ     FDS

      177    13901    2      END;  /*  Not jcl  */

      178    13902    1   FDS.TABDFLT# = 10;

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:25   
  13902  2 000224   000012 235007                    LDA     10,DL
         2 000225   000017 755000 xsym               STA     FDS+15

      179    13903    1   CALL X$FORMAT (FDS);

  13903  2 000226   000003 630400 3                  EPPR0   3
         2 000227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000230   000000 701000 xent               TSX1    X$FORMAT
         2 000231   000000 011000                    NOP     0

      180    13904
      181    13905    1   CALL ASB$KEYMAKER( USERS_KEY, P$B, %YES#, %LIST_USER_VAL) ALTRET(JUSTRET);

  13905  2 000232   000004 237000 3                  LDAQ    4
         2 000233   200024 757100                    STAQ    DO_FLAG+6,,AUTO
         2 000234   000000 236000 xsym               LDQ     NODE$
         2 000235   000006 235000 3                  LDA     6
         2 000236   200022 757100                    STAQ    DO_FLAG+4,,AUTO
         2 000237   200022 630500                    EPPR0   DO_FLAG+4,,AUTO
         2 000240   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000241   000000 701000 xent               TSX1    ASB$KEYMAKER
         2 000242   000623 702000 2                  TSX2    JUSTRET

      182    13906    2   IF DISP THEN DO;

  13906  2 000243   200005 234100                    SZN     DISP,,AUTO
         2 000244   000267 605000 2                  TPL     s:13916

      183    13907    3      IF JCL THEN DO;

  13907  2 000245   200007 234100                    SZN     JCL,,AUTO
         2 000246   000260 605000 2                  TPL     s:13913

      184    13908    3         DOFLAGBITS.USER = DOFLAGBITS.USER | '763777777777777777777777'O;

  13908  2 000247   200016 237100                    LDAQ    DO_FLAG,,AUTO
         2 000250   000014 277000 1                  ORAQ    ZERO_FLAGS+6
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:26   
         2 000251   200016 757100                    STAQ    DO_FLAG,,AUTO

      185    13909    3         DOFLAGBITS.FE_MODE = DOFLAGBITS.FE_MODE | '777777777777'O;

  13909  2 000252   200020 236100                    LDQ     DO_FLAG+2,,AUTO
         2 000253   000027 276000 xsym               ORQ     B_VECTNIL+23
         2 000254   200020 756100                    STQ     DO_FLAG+2,,AUTO

      186    13910    3         DO_FLAG(L_JCL) = %YES#;

  13910  2 000255   000002 236007                    LDQ     2,DL
         2 000256   200021 256100                    ORSQ    DO_FLAG+3,,AUTO

      187    13911    3         END;  /*  Jcl  */

  13911  2 000257   000272 710000 2                  TRA     s:13918

      188    13912    2      ELSE
      189    13913    2         CALL ASL$LIST_OPTS(DO_FLAG);

  13913  2 000260   200016 630500                    EPPR0   DO_FLAG,,AUTO
         2 000261   200022 450500                    STP0    DO_FLAG+4,,AUTO
         2 000262   200022 630500                    EPPR0   DO_FLAG+4,,AUTO
         2 000263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000264   000000 701000 xent               TSX1    ASL$LIST_OPTS
         2 000265   000000 011000                    NOP     0

      190    13914    2      END;  /*  Disp  */

  13914  2 000266   000272 710000 2                  TRA     s:13918

      191    13915    2   ELSE DO;  /*  Not disp  */

      192    13916    2      DO_FLAG = ZERO_FLAGS;

  13916  2 000267   000100 100400                    MLR     fill='000'O
         2 000270   000006 000020 1                  ADSC9   ZERO_FLAGS               cn=0,n=16
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:27   
         2 000271   200016 000020                    ADSC9   DO_FLAG,,AUTO            cn=0,n=16

      193    13917    2      END;  /*  Not disp  */

      194    13918    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );            /* A blank line            */

  13918  2 000272   000007 630400 3                  EPPR0   7
         2 000273   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000274   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000275   000000 011000                    NOP     0

      195    13919    1   FDS.NVECS# = 0 ;

  13919  2 000276   000011 450000 xsym               STZ     FDS+9

      196    13920    1   IF NOT AS_WILD_USER

  13920  2 000277   000000 234000 xsym               SZN     AS_WILD_USER
         2 000300   000410 604000 2                  TMI     s:13939

      197    13921    2   THEN DO ;

      198    13922    2      CALL ASB$GET( %NO#, %LIST_USER_VAL, AS_USERS, KL_DREC$ ) ALTRET(JUSTRET);

  13922  2 000301   000011 630400 3                  EPPR0   9
         2 000302   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000303   000000 701000 xent               TSX1    ASB$GET
         2 000304   000623 702000 2                  TSX2    JUSTRET

      199    13923    3      IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;

  13923  2 000305   000000 106400                    CMPC    fill='000'O
         2 000306   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         2 000307   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         2 000310   000357 600000 2                  TZE     s:13931
         2 000311   200007 234100                    SZN     JCL,,AUTO
         2 000312   000357 605000 2                  TPL     s:13931
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:28   

      200    13924    3         MACCT = AS_BLANK;

  13924  2 000313   040100 100400                    MLR     fill='040'O
         2 000314   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000315   200010 000025                    ADSC9   MACCT,,AUTO              cn=0,n=21

      201    13925    3         CALL INDEX ( I, ' ', AS_USERS.BUDGET.MACCT.ACCT);

  13925  2 000316   000000 124400                    SCM     mask='000'O
         2 000317   000012 200010 xsym               ADSC9   AS_USERS+10              cn=1,n=8
         2 000320   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000321   200006 000100                    ARG     I,,AUTO

      202    13926    3         CALL CONCAT (MACCT,SUBSTR(AS_USERS.BUDGET.MACCT.ACCT,0,I),

  13926  2 000322   200006 720100                    LXL0    I,,AUTO
         2 000323   040100 100440                    MLR     fill='040'O
         2 000324   000012 200010 xsym               ADSC9   AS_USERS+10              cn=1,n=*X0
         2 000325   200010 000025                    ADSC9   MACCT,,AUTO              cn=0,n=21
         2 000326   200006 236100                    LDQ     I,,AUTO
         2 000327   000025 116007                    CMPQ    21,DL
         2 000330   000345 603000 2                  TRC     s:13928
         2 000331   777752 621006                    EAX1    -22,QL
         2 000332   777777 661003                    ERX1    -1,DU
         2 000333   040146 100400                    MLR     fill='040'O
         2 000334   000015 000001 3                  ADSC9   13                       cn=0,n=1
         2 000335   200010 000011                    ADSC9   MACCT,Q,AUTO             cn=0,n=*X1
         2 000336   000024 116007                    CMPQ    20,DL
         2 000337   000345 603000 2                  TRC     s:13928
         2 000340   777753 622006                    EAX2    -21,QL
         2 000341   777777 662003                    ERX2    -1,DU
         2 000342   040146 100400                    MLR     fill='040'O
         2 000343   000014 200014 xsym               ADSC9   AS_USERS+12              cn=1,n=12
         2 000344   200010 200012                    ADSC9   MACCT,Q,AUTO             cn=1,n=*X2

      203    13927    3              ',',AS_USERS.BUDGET.MACCT.NAME);
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:29   
      204    13928    3         CALL CONCAT (OUT_BUF, MAKEME_STR, MACCT);

  13928  2 000345   040000 100400                    MLR     fill='040'O
         2 000346   000000 000007 1                  ADSC9   MAKEME_STR               cn=0,n=7
         2 000347   000000 000007 xsym               ADSC9   OUT_BUF                  cn=0,n=7
         2 000350   040000 100500                    MLR     fill='040'O
         2 000351   200010 000025                    ADSC9   MACCT,,AUTO              cn=0,n=21
         2 000352   000001 600205 xsym               ADSC9   OUT_BUF+1                cn=3,n=133

      205    13929    3         CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(MACCT) );

  13929  2 000353   000017 630400 3                  EPPR0   15
         2 000354   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000355   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000356   000000 011000                    NOP     0

      206    13930    3         END;   /*  Jcl and BUDGET.MACCT_ ~= blank  */

      207    13931    2      CALL ASL$LIST_OUT( DO_FLAG );

  13931  2 000357   200016 630500                    EPPR0   DO_FLAG,,AUTO
         2 000360   200022 450500                    STP0    DO_FLAG+4,,AUTO
         2 000361   200022 630500                    EPPR0   DO_FLAG+4,,AUTO
         2 000362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000363   000000 701000 xent               TSX1    ASL$LIST_OUT
         2 000364   000000 011000                    NOP     0

      208    13932    3      IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;

  13932  2 000365   000000 106400                    CMPC    fill='000'O
         2 000366   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         2 000367   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         2 000370   000405 600000 2                  TZE     s:13936
         2 000371   200007 234100                    SZN     JCL,,AUTO
         2 000372   000405 605000 2                  TPL     s:13936

      209    13933    3         CALL CONCAT (OUT_BUF, MAKEME_STR, RESET_STR);
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:30   

  13933  2 000373   040000 100400                    MLR     fill='040'O
         2 000374   000000 000007 1                  ADSC9   MAKEME_STR               cn=0,n=7
         2 000375   000000 000007 xsym               ADSC9   OUT_BUF                  cn=0,n=7
         2 000376   040000 100400                    MLR     fill='040'O
         2 000377   000002 000005 1                  ADSC9   RESET_STR                cn=0,n=5
         2 000400   000001 600205 xsym               ADSC9   OUT_BUF+1                cn=3,n=133

      210    13934    3         CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(RESET_STR) );

  13934  2 000401   000022 630400 3                  EPPR0   18
         2 000402   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000403   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000404   000000 011000                    NOP     0

      211    13935    3         END;   /*  Jcl and BUDGET.MACCT_ ~= blank  */

      212    13936    2      COUNT = 1 ;

  13936  2 000405   000001 235007                    LDA     1,DL
         2 000406   200004 755100                    STA     COUNT,,AUTO

      213    13937    2      END ;

  13937  2 000407   000543 710000 2                  TRA     FINISHED

      214    13938    2   ELSE DO ;

      215    13939    2      COUNT = 0 ;

  13939  2 000410   200004 450100                    STZ     COUNT,,AUTO

      216    13940    2      CALL ASB$INIT_GET_NEXT( %NO#, %LIST_USER_VAL ) ;

  13940  2 000411   000011 630400 3                  EPPR0   9
         2 000412   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000413   000000 701000 xent               TSX1    ASB$INIT_GET_NEXT
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:31   
         2 000414   000000 011000                    NOP     0

      217    13941    3      DO FOREVER;

      218    13942    3         CALL ASB$GET_NEXT ALTRET( FINISHED ) ;

  13942  2 000415   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000416   000000 701000 xent               TSX1    ASB$GET_NEXT
         2 000417   000543 702000 2                  TSX2    FINISHED

      219    13943    4         IF JCL THEN DO;

  13943  2 000420   200007 234100                    SZN     JCL,,AUTO
         2 000421   000437 605000 2                  TPL     s:13952

      220    13944    4            IF USERS_KEY.COUNT < 9 THEN GOTO SKIP_THIS_ONE;

  13944  2 000422   000000 236000 xsym               LDQ     USERS_KEY
         2 000423   777000 376003                    ANQ     -512,DU
         2 000424   011000 116003                    CMPQ    4608,DU
         2 000425   000542 602000 2                  TNC     SKIP_THIS_ONE

      221    13945    4            USERS_KEY.COUNT = 21;

  13945  2 000426   025000 236003                    LDQ     10752,DU
         2 000427   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      222    13946    4            USERS_KEY.UKEY.S = 'S';

  13946  2 000430   000123 236003                    LDQ     83,DU
         2 000431   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

      223    13947    4            CALL ASB$READ_USERS ( USERS_PROJ )

  13947  2 000432   000000 630400 xsym               EPPR0   DSEG2$
         2 000433   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000434   000000 701000 xent               TSX1    ASB$READ_USERS
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:32   
         2 000435   000437 702000 2                  TSX2    s:13952

      224    13948    5            WHENRETURN DO;

      225    13949    5               GOTO SKIP_THIS_ONE;      /*  This is a project, not a user  */

  13949  2 000436   000542 710000 2                  TRA     SKIP_THIS_ONE

      226    13950    5               END;   /*  Whenreturn from ASB$READ_USERS  */
      227    13951    4            END;  /*  If jcl  */

      228    13952    4         IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;

  13952  2 000437   000000 106400                    CMPC    fill='000'O
         2 000440   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         2 000441   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         2 000442   000511 600000 2                  TZE     s:13960
         2 000443   200007 234100                    SZN     JCL,,AUTO
         2 000444   000511 605000 2                  TPL     s:13960

      229    13953    4            MACCT = AS_BLANK;

  13953  2 000445   040100 100400                    MLR     fill='040'O
         2 000446   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000447   200010 000025                    ADSC9   MACCT,,AUTO              cn=0,n=21

      230    13954    4            CALL INDEX ( I, ' ', AS_USERS.BUDGET.MACCT.ACCT);

  13954  2 000450   000000 124400                    SCM     mask='000'O
         2 000451   000012 200010 xsym               ADSC9   AS_USERS+10              cn=1,n=8
         2 000452   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000453   200006 000100                    ARG     I,,AUTO

      231    13955    4            CALL CONCAT (MACCT,SUBSTR(AS_USERS.BUDGET.MACCT.ACCT,0,I),

  13955  2 000454   200006 720100                    LXL0    I,,AUTO
         2 000455   040100 100440                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:33   
         2 000456   000012 200010 xsym               ADSC9   AS_USERS+10              cn=1,n=*X0
         2 000457   200010 000025                    ADSC9   MACCT,,AUTO              cn=0,n=21
         2 000460   200006 236100                    LDQ     I,,AUTO
         2 000461   000025 116007                    CMPQ    21,DL
         2 000462   000477 603000 2                  TRC     s:13957
         2 000463   777752 621006                    EAX1    -22,QL
         2 000464   777777 661003                    ERX1    -1,DU
         2 000465   040146 100400                    MLR     fill='040'O
         2 000466   000015 000001 3                  ADSC9   13                       cn=0,n=1
         2 000467   200010 000011                    ADSC9   MACCT,Q,AUTO             cn=0,n=*X1
         2 000470   000024 116007                    CMPQ    20,DL
         2 000471   000477 603000 2                  TRC     s:13957
         2 000472   777753 622006                    EAX2    -21,QL
         2 000473   777777 662003                    ERX2    -1,DU
         2 000474   040146 100400                    MLR     fill='040'O
         2 000475   000014 200014 xsym               ADSC9   AS_USERS+12              cn=1,n=12
         2 000476   200010 200012                    ADSC9   MACCT,Q,AUTO             cn=1,n=*X2

      232    13956    4                 ',',AS_USERS.BUDGET.MACCT.NAME);
      233    13957    4            CALL CONCAT (OUT_BUF, MAKEME_STR, MACCT);

  13957  2 000477   040000 100400                    MLR     fill='040'O
         2 000500   000000 000007 1                  ADSC9   MAKEME_STR               cn=0,n=7
         2 000501   000000 000007 xsym               ADSC9   OUT_BUF                  cn=0,n=7
         2 000502   040000 100500                    MLR     fill='040'O
         2 000503   200010 000025                    ADSC9   MACCT,,AUTO              cn=0,n=21
         2 000504   000001 600205 xsym               ADSC9   OUT_BUF+1                cn=3,n=133

      234    13958    4            CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(MACCT) );

  13958  2 000505   000017 630400 3                  EPPR0   15
         2 000506   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000507   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000510   000000 011000                    NOP     0

      235    13959    4            END; /*  Jcl and BUDGET.MACCT_ ~= blank  */

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:34   
      236    13960    3         CALL ASL$LIST_OUT( DO_FLAG ) ;

  13960  2 000511   200016 630500                    EPPR0   DO_FLAG,,AUTO
         2 000512   200022 450500                    STP0    DO_FLAG+4,,AUTO
         2 000513   200022 630500                    EPPR0   DO_FLAG+4,,AUTO
         2 000514   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000515   000000 701000 xent               TSX1    ASL$LIST_OUT
         2 000516   000000 011000                    NOP     0

      237    13961    4         IF AS_USERS.BUDGET.MACCT_ ~= AS_NONE AND JCL THEN DO;

  13961  2 000517   000000 106400                    CMPC    fill='000'O
         2 000520   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         2 000521   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         2 000522   000537 600000 2                  TZE     s:13965
         2 000523   200007 234100                    SZN     JCL,,AUTO
         2 000524   000537 605000 2                  TPL     s:13965

      238    13962    4            CALL CONCAT (OUT_BUF, MAKEME_STR, RESET_STR);

  13962  2 000525   040000 100400                    MLR     fill='040'O
         2 000526   000000 000007 1                  ADSC9   MAKEME_STR               cn=0,n=7
         2 000527   000000 000007 xsym               ADSC9   OUT_BUF                  cn=0,n=7
         2 000530   040000 100400                    MLR     fill='040'O
         2 000531   000002 000005 1                  ADSC9   RESET_STR                cn=0,n=5
         2 000532   000001 600205 xsym               ADSC9   OUT_BUF+1                cn=3,n=133

      239    13963    4            CALL ASB$WRITE_LO (OUT_BUF, SIZEC(MAKEME_STR)+SIZEC(RESET_STR) );

  13963  2 000533   000022 630400 3                  EPPR0   18
         2 000534   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000535   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000536   000000 011000                    NOP     0

      240    13964    4            END; /*  Jcl and BUDGET.MACCT_ ~= blank  */

      241    13965    3         COUNT = COUNT + 1 ;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:35   

  13965  2 000537   200004 235100                    LDA     COUNT,,AUTO
         2 000540   000001 035007                    ADLA    1,DL
         2 000541   200004 755100                    STA     COUNT,,AUTO

      242    13966    3   SKIP_THIS_ONE:
      243    13967    3         END;

  13967  2 000542   000415 710000 2     SKIP_THIS_O* TRA     s:13942

      244    13968    2      END ;
      245    13969    1   FINISHED:
      246    13970    1   IF DOFLAG.OPTS1 = '0'B AND  DOFLAG.OPTS2 = '0'B AND  FDS.NVECS#  ~= 0

  13970  2 000543   000000 066500       FINISHED     CMPB    filb='0'B
         2 000544   200016 050143                    BDSC    DO_FLAG,,AUTO            by=0,bit=5,n=99
         2 000545   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000546   000565 601000 2                  TNZ     s:13977
         2 000547   200021 235100                    LDA     DO_FLAG+3,,AUTO
         2 000550   000565 601000 2                  TNZ     s:13977
         2 000551   000011 236000 xsym               LDQ     FDS+9
         2 000552   000565 600000 2                  TZE     s:13977

      247    13971    2   THEN DO ;

      248    13972    2      CALL X$FORMAT( FDS ) ;

  13972  2 000553   000003 630400 3                  EPPR0   3
         2 000554   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000555   000000 701000 xent               TSX1    X$FORMAT
         2 000556   000000 011000                    NOP     0

      249    13973    2      FDS.NVECS# = 0;   /* reset vectors after format/print of users */

  13973  2 000557   000011 450000 xsym               STZ     FDS+9

      250    13974    2      CALL ASB$WRITE_LO( AS_BLANK, 1 ) ;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:36   

  13974  2 000560   000007 630400 3                  EPPR0   7
         2 000561   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000562   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000563   000000 011000                    NOP     0

      251    13975    2      LIST_ACCT_FLG = '0'B ;

  13975  2 000564   000000 450000 xsym               STZ     LIST_ACCT_FLG

      252    13976    2      END ;

      253    13977    2   IF NOT JCL THEN DO;

  13977  2 000565   200007 234100                    SZN     JCL,,AUTO
         2 000566   000623 604000 2                  TMI     JUSTRET

      254    13978    3      IF COUNT = 0 THEN DO ;

  13978  2 000567   200004 235100                    LDA     COUNT,,AUTO
         2 000570   000576 601000 2                  TNZ     s:14007

      255    13979        /*E* ERROR:   ASL-E$NOTHING_TO_LIST-C
      256    13980             MESSAGE: Nothing to list or display.
      257    13981        */
      258    13982              %SCREAM( ERR#=E$NOTHING_TO_LIST, LEVEL=INFO, MID='L' ) ;

  13990  2 000571   000024 630400 3                  EPPR0   20
         2 000572   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000573   000000 701000 xent               TSX1    ASH$INFO
         2 000574   000000 011000                    NOP     0

      259    13997    3         END ;

  13997  2 000575   000623 710000 2                  TRA     JUSTRET

      260    13998    3      ELSE DO ;
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:37   

      261    13999              %NUMBER( NUM1=COUNT ) ;
             14007    3         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, COUNT );

  14007  2 000576   200004 630500                    EPPR0   COUNT,,AUTO
         2 000577   200025 450500                    STP0    DO_FLAG+7,,AUTO
         2 000600   000025 236000 3                  LDQ     21
         2 000601   200024 756100                    STQ     DO_FLAG+6,,AUTO
         2 000602   000026 237000 3                  LDAQ    22
         2 000603   200022 757100                    STAQ    DO_FLAG+4,,AUTO
         2 000604   200022 630500                    EPPR0   DO_FLAG+4,,AUTO
         2 000605   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000606   000000 701000 xent               TSX1    ASB$BINCHAR
         2 000607   000000 011000                    NOP     0

      262    14029    4         IF DISP THEN DO;

  14029  2 000610   200005 234100                    SZN     DISP,,AUTO
         2 000611   000617 605000 2                  TPL     s:14061

      263    14030        /*E* ERROR:   ASL-E$DISP_MESS-C
      264    14031             MESSAGE:.. %U1 users displayed.
      265    14032        */
      266    14033                 %SCREAM( ERR#=E$DISP_MESS, MID='L', LEVEL=INFO ) ;

  14041  2 000612   000030 630400 3                  EPPR0   24
         2 000613   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000614   000000 701000 xent               TSX1    ASH$INFO
         2 000615   000000 011000                    NOP     0

      267    14048    4            END ;

  14048  2 000616   000623 710000 2                  TRA     JUSTRET

      268    14049    4         ELSE DO;

      269    14050        /*E* ERROR:   ASL-E$LISTED_MESS-C
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:38   
      270    14051             MESSAGE:.. %U1 users listed.
      271    14052        */
      272    14053                 %SCREAM( ERR#=E$LISTED_MESS, MID='L', LEVEL=INFO ) ;

  14061  2 000617   000031 630400 3                  EPPR0   25
         2 000620   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000621   000000 701000 xent               TSX1    ASH$INFO
         2 000622   000000 011000                    NOP     0

      273    14068    4            END ;

      274    14069    3         END; /*  Count > 0  */

      275    14070    2      END; /*  Not jcl  */

  14049  2 000623                       JUSTRET      null
      276    14071    1   JUSTRET: ;
      277    14072    1   RETURN ;

  14072  2 000623   000000 702200 xent               TSX2  ! X66_ARET
      278    14073
      279    14074    1   END ASL$LIST_ALL_USERS;

PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:39   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_USERS.
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:40   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_USERS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(7)     r     1 MAKEME_STR                 2-0-0/c CHAR(5)     r     1 RESET_STR
     4-0-0/c CHAR(5)     r     1 USERS_STR
     6-0-0/b BIT         r     1 ZERO_FLAGS(0:143)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 CODE2                      4-0-0/w UBIN        r     1 COUNT
     5-0-0/b BIT         r     1 DISP                      16-0-0/b STRC(144)   r     1 DOFLAG
    16-0-0/b STRC(144)   r     1 DOFLAGBITS                16-0-0/b BIT         r     1 DO_FLAG(0:143)
     6-0-0/w UBIN        r     1 I                          7-0-0/b BIT         r     1 JCL
    10-0-0/c CHAR(21)    r     1 MACCT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/c STRC(189)   r     1 AS_NONE                    0-0-0/w STRC(18576) r     1 AS_USERS
     0-0-0/b BIT         r     1 AS_WILD_USER               0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w PTR         r     1 KL_DREC$
     0-0-0/b BIT         r     1 LIST_ACCT_FLG              0-0-0/w PTR         r     1 NODE$
     0-0-0/c CHAR(140)   r     1 OUT_BUF                    0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:41   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w STRC(18576) r     1 USERS_PROJ


   Procedure ASL$LIST_ALL_USERS requires 404 words for executable code.
   Procedure ASL$LIST_ALL_USERS requires 22 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_USERS.:E05TSI    .
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:42   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:43   
          MINI XREF LISTING

ASA_BRKS_LOC
     10676**DCL     10676--REDEF
ASB$BINCHAR
      3800**DCL-ENT 14007--CALL
ASB$GET
     13541**DCL-ENT 13922--CALL
ASB$GET_NEXT
     13547**DCL-ENT 13942--CALL
ASB$INIT_GET_NEXT
     13544**DCL-ENT 13940--CALL
ASB$KEYMAKER
     13538**DCL-ENT 13905--CALL
ASB$READ_USERS
     13550**DCL-ENT 13947--CALL
ASB$WRITE_LO
     13553**DCL-ENT 13918--CALL    13929--CALL    13934--CALL    13958--CALL    13963--CALL    13974--CALL
ASH$INFO
     13556**DCL-ENT 13990--CALL    14041--CALL    14061--CALL
ASL$LIST_OPTS
     13562**DCL-ENT 13913--CALL
ASL$LIST_OUT
     13559**DCL-ENT 13931--CALL    13960--CALL
AS_BLANK
     10536**DCL     13918<>CALL    13924>>ASSIGN  13953>>ASSIGN  13974<>CALL
AS_DEFAULT.BANNER_PERM
     11369**DCL     11370--REDEF
AS_DEFAULT.BUDGET.MACCT
     11274**DCL     11278--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11287**DCL     11290--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11270**DCL     11272--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:44   
AS_DEFAULT.BUDGET.PMAXC
     11265**DCL     11267--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11385**DCL     11386--REDEF   11387--REDEF
AS_DEFAULT_DREC.PASSWORD
     12639**DCL     12643--REDEF
AS_DEFAULT_DREC.RENAME
     12662**DCL     12663--REDEF
AS_DFLT.BANNER_PERM
     11191**DCL     11192--REDEF
AS_DFLT.BUDGET.MACCT
     11096**DCL     11100--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11109**DCL     11112--REDEF
AS_DFLT.BUDGET.PACCUM
     11092**DCL     11094--REDEF
AS_DFLT.BUDGET.PMAXC
     11087**DCL     11089--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11207**DCL     11208--REDEF   11209--REDEF
AS_FE_MODE
     10542**DCL     10543--REDEF
AS_FIELD1.TEXT
     10673**DCL     14007<>CALL
AS_MODE
     10539**DCL     10541--REDEF
AS_MOD_USER.ACCESS
     13404**DCL     13405--REDEF
AS_MOD_USER.BANNER
     13391**DCL     13392--REDEF
AS_MOD_USER.BANNER_PERM
     13393**DCL     13394--REDEF
AS_MOD_USER.BILL
     13399**DCL     13400--REDEF
AS_MOD_USER.CPROC
     13395**DCL     13396--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:45   
AS_MOD_USER.FEBILL
     13475**DCL     13476--REDEF
AS_MOD_USER.FECXTMEM
     13492**DCL     13493--REDEF
AS_MOD_USER.FEMINTS
     13477**DCL     13478--REDEF
AS_MOD_USER.FEMMEM
     13488**DCL     13489--REDEF
AS_MOD_USER.FEMTIME
     13486**DCL     13487--REDEF
AS_MOD_USER.FEPPRIV
     13483**DCL     13485--REDEF
AS_MOD_USER.FEPRIV
     13480**DCL     13482--REDEF
AS_MOD_USER.FORCE_BIT
     13389**DCL     13390--REDEF
AS_MOD_USER.KEY
     13471**DCL     13473--REDEF
AS_MOD_USER.LASTCPROC
     13397**DCL     13398--REDEF
AS_MOD_USER.LIMITS.DO_
     13445**DCL     13446--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13461**DCL     13462--REDEF
AS_MOD_USER.LIMITS.LO
     13441**DCL     13442--REDEF
AS_MOD_USER.LIMITS.MEM
     13437**DCL     13438--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13465**DCL     13466--REDEF
AS_MOD_USER.LIMITS.PDIS
     13453**DCL     13454--REDEF
AS_MOD_USER.LIMITS.PO
     13449**DCL     13450--REDEF
AS_MOD_USER.LIMITS.TDIS
     13457**DCL     13458--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:46   
AS_MOD_USER.LIMITS.TIME
     13433**DCL     13434--REDEF
AS_MOD_USER.MAXENQ
     13414**DCL     13415--REDEF
AS_MOD_USER.PERM_BIT
     13387**DCL     13388--REDEF
AS_MOD_USER.PPRIV
     13409**DCL     13411--REDEF
AS_MOD_USER.PRIOB
     13416**DCL     13417--REDEF
AS_MOD_USER.PRIV
     13406**DCL     13408--REDEF
AS_MOD_USER.QUAN
     13412**DCL     13413--REDEF
AS_MOD_USER.SETUP
     13385**DCL     13386--REDEF
AS_NONE
     10537**DCL     13923>>IF      13932>>IF      13952>>IF      13961>>IF
AS_PROJECT.BANNER_PERM
     11725**DCL     11726--REDEF
AS_PROJECT.BUDGET.MACCT
     11630**DCL     11634--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11643**DCL     11646--REDEF
AS_PROJECT.BUDGET.PACCUM
     11626**DCL     11628--REDEF
AS_PROJECT.BUDGET.PMAXC
     11621**DCL     11623--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11741**DCL     11742--REDEF   11743--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11903**DCL     11904--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11808**DCL     11812--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11821**DCL     11824--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:47   
AS_PROJECT_DFLT.BUDGET.PACCUM
     11804**DCL     11806--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11799**DCL     11801--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11919**DCL     11920--REDEF   11921--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13125**DCL     13129--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13148**DCL     13149--REDEF
AS_PROJECT_DREC.PASSWORD
     12963**DCL     12967--REDEF
AS_PROJECT_DREC.RENAME
     12986**DCL     12987--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     11547**DCL     11548--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11452**DCL     11456--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11465**DCL     11468--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11448**DCL     11450--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11443**DCL     11445--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11563**DCL     11564--REDEF   11565--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12801**DCL     12805--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12824**DCL     12825--REDEF
AS_USERS
     10898**DCL     13922<>CALL
AS_USERS.BANNER_PERM
     11013**DCL     11014--REDEF
AS_USERS.BUDGET.MACCT
     10918**DCL     10922--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:48   
AS_USERS.BUDGET.MACCT.ACCT
     10920**DCL     13925>>CALLBLT 13926>>CALLBLT 13954>>CALLBLT 13955>>CALLBLT
AS_USERS.BUDGET.MACCT.NAME
     10921**DCL     13926>>CALLBLT 13955>>CALLBLT
AS_USERS.BUDGET.MACCT_
     10922**DCL     13923>>IF      13932>>IF      13952>>IF      13961>>IF
AS_USERS.BUDGET.MAX_PROJECTS
     10931**DCL     10934--REDEF
AS_USERS.BUDGET.PACCUM
     10914**DCL     10916--REDEF
AS_USERS.BUDGET.PMAXC
     10909**DCL     10911--REDEF
AS_USERS.SETUP_CHRA.TXT
     11029**DCL     11030--REDEF   11031--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12081**DCL     12082--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11986**DCL     11990--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11999**DCL     12002--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11982**DCL     11984--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11977**DCL     11979--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12097**DCL     12098--REDEF   12099--REDEF
AS_WILD_USER
     10681**DCL     13920>>IF
CODE
     10669**DCL     13824<<ASSIGN  13826>>DOSELCT
CODE2
     13795**DCL     13864<<ASSIGN  13866>>DOSELCT
COUNT
     13796**DCL     13936<<ASSIGN  13939<<ASSIGN  13965<<ASSIGN  13965>>ASSIGN  13978>>IF      14007<>CALL
DISP
     13797**DCL     13830<<ASSIGN  13839<<ASSIGN  13853<<ASSIGN  13862<<ASSIGN  13906>>IF      14029>>IF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:49   
DOFLAG.OPTS1
     13805**DCL     13970>>IF
DOFLAG.OPTS2
     13807**DCL     13970>>IF
DOFLAGBITS.FE_MODE
     13810**DCL     13909<<ASSIGN  13909>>ASSIGN
DOFLAGBITS.USER
     13809**DCL     13908<<ASSIGN  13908>>ASSIGN
DO_FLAG
     13802**DCL     13803--REDEF   13808--REDEF   13910<<ASSIGN  13913<>CALL    13916<<ASSIGN  13931<>CALL
     13960<>CALL
DSEG2$
     10678**DCL     13627--IMP-PTR 13947>>CALL
ERR_CODE
     10671**DCL     10672--REDEF
FDS
     10568**DCL     13903<>CALL    13972<>CALL
FDS.FMT_.BOUND
     10573**DCL     13896<<ASSIGN  13900<<ASSIGN
FDS.NVECS#
     10596**DCL     13893<<ASSIGN  13919<<ASSIGN  13970>>IF      13973<<ASSIGN
FDS.TABDFLT#
     10634**DCL     13902<<ASSIGN
FINISHED
     13970**LABEL   13942--CALLALT
FMT_BUF
     10667**DCL     13895<<CALLBLT 13899<<CALLBLT
I
     13798**DCL     13863<<DOINDEX 13864>>ASSIGN  13925<<CALLBLT 13926>>CALLBLT 13954<<CALLBLT 13955>>CALLBLT
JCL
     13799**DCL     13825<<ASSIGN  13831<<ASSIGN  13844<<ASSIGN  13847<<ASSIGN  13854<<ASSIGN  13870<<ASSIGN
     13894>>IF      13907>>IF      13923>>IF      13932>>IF      13943>>IF      13952>>IF      13961>>IF
     13977>>IF
JUSTRET
     14049**LABEL   13905--CALLALT 13922--CALLALT
KL_DEFAULT.PASSWORD
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:50   
     13287**DCL     13291--REDEF
KL_DEFAULT.RENAME
     13310**DCL     13311--REDEF
KL_DFLT.PASSWORD
     12477**DCL     12481--REDEF
KL_DFLT.RENAME
     12500**DCL     12501--REDEF
KL_DREC.PASSWORD
     12315**DCL     12319--REDEF
KL_DREC.RENAME
     12338**DCL     12339--REDEF
KL_DREC$
     10544**DCL     13922<>CALL
KL_DREC_CNT.PASSWORD
     12202**DCL     12206--REDEF
KL_DREC_CNT.RENAME
     12225**DCL     12226--REDEF
LIST_ACCT_FLG
     10669**DCL     13975<<ASSIGN
MACCT
     13800**DCL     13924<<ASSIGN  13926<<CALLBLT 13928>>CALLBLT 13929--CALL    13953<<ASSIGN  13955<<CALLBLT
     13957>>CALLBLT 13958--CALL
MAKEME_STR
     13815**DCL     13928>>CALLBLT 13929--CALL    13933>>CALLBLT 13934--CALL    13957>>CALLBLT 13958--CALL
     13962>>CALLBLT 13963--CALL
NODE$
     10669**DCL     13575--IMP-PTR 13833<<ASSIGN  13835<<ASSIGN  13840<<ASSIGN  13842<<ASSIGN  13856<<ASSIGN
     13858<<ASSIGN  13877<<ASSIGN  13879<<ASSIGN  13880>>IF      13882>>IF      13883<<ASSIGN  13885>>IF
     13887>>IF      13888>>ASSIGN  13905>>CALL
OUT_BUF
     10668**DCL     13928<<CALLBLT 13929<>CALL    13933<<CALLBLT 13934<>CALL    13957<<CALLBLT 13958<>CALL
     13962<<CALLBLT 13963<>CALL
P$B
     13575**DCL     13905<>CALL
P$B.CODE
     13583**DCL     13824>>ASSIGN  13843>>IF      13846>>IF      13864>>ASSIGN  13882>>IF      13887>>IF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:51   
P$B.NSUBLKS
     13587**DCL     13832>>IF      13841>>IF      13845>>IF      13855>>IF      13863>>DOINDEX 13876>>IF
     13880>>IF      13885>>IF      13888<<ASSIGN
P$B.SUBLK$
     13608**DCL     13824>>ASSIGN  13832>>IF      13833>>ASSIGN  13835>>ASSIGN  13835>>ASSIGN  13840>>ASSIGN
     13841>>IF      13842>>ASSIGN  13842>>ASSIGN  13843>>IF      13843>>IF      13845>>IF      13846>>IF
     13846>>IF      13856>>ASSIGN  13858>>ASSIGN  13864>>ASSIGN  13877>>ASSIGN  13879>>ASSIGN  13882>>IF
     13883>>ASSIGN  13887>>IF
PROJ_KEY.TEXT
     10549**DCL     10549--REDEF
PROJ_KEY.TXT.PROJECT
     10549**DCL     10549--REDEF
P_PCB.OUT$
     10717**DCL     13824>>ASSIGN  13832>>IF      13833>>ASSIGN  13835>>ASSIGN  13840>>ASSIGN  13841>>IF
     13842>>ASSIGN  13843>>IF      13845>>IF      13846>>IF      13855>>IF      13856>>ASSIGN  13858>>ASSIGN
     13863>>DOINDEX 13864>>ASSIGN  13876>>IF      13877>>ASSIGN  13879>>ASSIGN  13883>>ASSIGN
REMEM_VAR
     10675**DCL     10675--REDEF
REM_FCMD
     10675**DCL     10676--REDEF
RESET_STR
     13816**DCL     13933>>CALLBLT 13934--CALL    13962>>CALLBLT 13963--CALL
SKIP_THIS_ONE
     13967**LABEL   13944--GOTO    13949--GOTO
USERS_KEY
     10546**DCL     13905<>CALL
USERS_KEY.COUNT
     10546**DCL     13944>>IF      13945<<ASSIGN
USERS_KEY.TEXT
     10546**DCL     10547--REDEF   10547--REDEF   10547--REDEF   10548--REDEF
USERS_KEY.UKEY.S
     10548**DCL     13946<<ASSIGN
USERS_PROJ
     13627**DCL     13947<>CALL
USERS_PROJ.BANNER_PERM
     13742**DCL     13743--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_USERS File=ASL$LIST_USERS.:E05TSI                TUE 07/29/97 10:24 Page:52   
USERS_PROJ.BUDGET.MACCT
     13647**DCL     13651--REDEF
USERS_PROJ.BUDGET.MAX_PROJECTS
     13660**DCL     13663--REDEF
USERS_PROJ.BUDGET.PACCUM
     13643**DCL     13645--REDEF
USERS_PROJ.BUDGET.PMAXC
     13638**DCL     13640--REDEF
USERS_PROJ.SETUP_CHRA.TXT
     13758**DCL     13759--REDEF   13760--REDEF
USERS_STR
     13817**DCL     13895>>CALLBLT 13896--ASSIGN  13899>>CALLBLT 13900--ASSIGN
X$FORMAT
     13564**DCL-ENT 13903--CALL    13972--CALL
ZERO_FLAGS
     13818**DCL     13916>>ASSIGN
