VERSION E05

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:1    
        1        1        /*M*     PCC$CONTROL - MAIN MODULE FOR CONTROL             */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        PCC$CONTROL: PROC MAIN;
        8        8        /**/
        9        9        /*********************************************************************/
       10       10        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       11       11        /*********************************************************************/
       12       12        %INCLUDE PC_SUBS_C;
       13      344        %INCLUDE PC_PERR_C;
       14      377        %INCLUDE XU_MACRO_C;
       15     3483        %INCLUDE CP_6;
       16     3564        %INCLUDE CP_6_SUBS;
       17     4104        %INCLUDE B_SEGIDS_C;
       18     4643        %INCLUDE B_STRINGS_C;
       19     4772        %INCLUDE B$JIT;
       20     5062        %INCLUDE JM$STRUCT;
       21     5807        %INCLUDE PC_MACRO_C;
       22     5833        %INCLUDE B_ERRORS_C;
       23     6960        %INCLUDE XU_SUBS_C;
       24     7052        %INCLUDE B$OBJECT_C;
       25    10482        %INCLUDE XU_FORMAT_C;
       26    10644        %INCLUDE QQ_MACROS_C;
       27    11069        %INCLUDE XUF_ENTRY;
       28    11077        %INCLUDE FM_CACHE_C;
       29    11143        %INCLUDE UD_EQU_E;
       30    11532        %INCLUDE XUD_UTS_M;
       31    11614        /**/
       32    11615        %EQU PSURES_OFFSET = 4;
       33    11616        %EQU MMINDX=0;
       34    11617        %XUD_UTS_EQU;
       35    11628        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:2    
       36    11629        /***************************************************************************/
       37    11630        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       38    11631        /***************************************************************************/
       39    11632        /**/
       40    11633    1   DCL CAT$ PTR STATIC SYMDEF INIT(ADDR(CATAGORY_TBL));
       41    11634    1   DCL SYSTEM$ PTR STATIC SYMDEF INIT(ADDR(SYSTEM_TBL));
       42    11635    1   DCL PART$ PTR STATIC SYMDEF INIT(ADDR(PARTITION_TBL));
       43    11636    1   DCL RES$ PTR STATIC SYMDEF INIT(ADDR(RESOURCE_TBL));
       44    11637    1   DCL EX$ PTR STATIC SYMDEF INIT(ADDR(EXCEPTION_TBL));
       45    11638    1   DCL TP$ PTR STATIC SYMDEF INIT(ADDR(TP_TBL));
       46    11639    1   DCL PC_REASON UBIN STATIC SYMDEF;
       47    11640        /**/
       48    11641    1   DCL 1 PC$JITPTR STATIC,
       49    11642    1         2 * BIT(24) UNAL INIT('0'B),
       50    11643    1         2 SEGID BIT(12) UNAL INIT(%JITSID); /* JIT PTR                           */
       51    11644        /**/
       52    11645    1   DCL PC$JIT$ REDEF PC$JITPTR PTR;
       53    11646        /**/
       54    11647    1   DCL MONPTR$ PTR STATIC SYMDEF;
       55    11648    1   DCL 1 MONPTR REDEF MONPTR$,
       56    11649    1         2 ADDRESS UBIN(24) UNAL,
       57    11650    1         2 SEGID UBIN(12) UNAL;
       58    11651        /**/
       59    11652    1   DCL MONPART$ PTR STATIC SYMDEF INIT(ADDR(JM_PT));
       60    11653    1   DCL 1 MONPARTPTR REDEF MONPART$,
       61    11654    1         2 ADDRESS UBIN(24) UNAL,
       62    11655    1         2 SEGID UBIN(12) UNAL;
       63    11656        /**/
       64    11657    1   DCL NUM_PSURES UBIN WORD STATIC SYMDEF;
       65    11658    1   DCL LAST_CMD UBIN WORD STATIC SYMDEF INIT(0);
       66    11659        /**/
       67    11660    1   DCL TEMP$ PTR STATIC;
       68    11661    1   DCL 1 TEMPPTR REDEF TEMP$,
       69    11662    1         2 ADDRESS UBIN(24) UNAL,
       70    11663    1         2 SEGID UBIN(12) UNAL;
       71    11664    1   DCL TEMP1$ PTR;
       72    11665    1   DCL FIRST_BIT UBIN WORD;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:3    
       73    11666    1   DCL LAST_BIT UBIN WORD;
       74    11667    1   DCL FLAGVAL UBIN WORD;
       75    11668    1   DCL BLK$ PTR STATIC;
       76    11669    1   DCL PART#$ PTR STATIC;
       77    11670    1   DCL PARAM$ PTR STATIC;
       78    11671    1   DCL INDEX$ PTR STATIC;
       79    11672    1   DCL M$SI$ PTR STATIC;
       80    11673    1   DCL HDR$ PTR STATIC;
       81    11674        /**/
       82    11675    1   DCL TEMP1 SBIN STATIC;
       83    11676    1   DCL TEMP2 SBIN STATIC;
       84    11677    1   DCL I SBIN STATIC;
       85    11678    1   DCL J SBIN STATIC;
       86    11679    1   DCL K SBIN STATIC;
       87    11680    1   DCL L SBIN STATIC;
       88    11681    1   DCL CURINSTANCES SBIN WORD STATIC SYMDEF INIT(0);
       89    11682    1   DCL TBLINSTANCES SBIN WORD STATIC SYMDEF INIT(0);
       90    11683        /**/
       91    11684    1   DCL BITVAL BIT(1) STATIC;               /* USED BY ADD/DROP                   */
       92    11685        /**/
       93    11686    1   DCL TPSYS BIT(1) STATIC SYMDEF INIT(YES); /* TP SYSTEM FLAG                   */
       94    11687    1   DCL SETAUTH BIT(1) STATIC INIT(YES);
       95    11688        /**/
       96    11689    1   DCL REMEM_CMD_READ REMEMBER STATIC SYMDEF;
       97    11690        /**/
       98    11691    1   DCL RES_TEXT(0:3) CHAR(2) STATIC SYMDEF INIT('MM',
       99    11692    1                                                    'DP',
      100    11693    1                                                    'MT',
      101    11694    1                                                    'OP');
      102    11695    1   DCL PSURES_TEXT(0:7) CHAR(8) STATIC SYMDEF;
      103    11696    1   DCL RES_INDX SBIN WORD STATIC;
      104    11697        /**/
      105    11698    1   DCL CMD_BUF CHAR(256) STATIC SYMDEF;
      106    11699        /**/
      107    11700    1   DCL MAX_CLMN SBIN WORD STATIC SYMDEF;
      108    11701    1   DCL CUR_CLMN SBIN WORD STATIC SYMDEF;
      109    11702    1   DCL PRINT_BUF CHAR(132) STATIC SYMDEF INIT(' ');
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:4    
      110    11703        /**/
      111    11704    1   DCL 1 INDEX_FLGS STATIC SYMDEF,
      112    11705    1         2 MODE (0:%PC_MAXMODE) BIT(1) UNAL INIT(YES*0),
      113    11706    1         2 PART# (0:15) BIT(1) UNAL INIT(YES*0),
      114    11707    1         2 DOMAINE (0:%PC_MAXDOMAIN) BIT(1) UNAL INIT(YES*0);
      115    11708        /**/
      116    11709    1   DCL PART#_FLGS(0:15) BIT(1) STATIC SYMDEF;
      117    11710        /**/
      118    11711    1   DCL 1 DISP_TBL STATIC,
      119    11712    1         2 INDX UBIN WORD,
      120    11713    1         2 PARM(0:99) ALIGNED,
      121    11714    1           3 CAT UBIN(9) UNAL,
      122    11715    1           3 PARM UBIN(9) UNAL,
      123    11716    1           3 INDEXLO UBIN(9) UNAL,
      124    11717    1           3 INDEXHI UBIN(9) UNAL,
      125    11718    1           3 RESINDX SBIN HALF UNAL;
      126    11719    1   DCL 1 DISP_CAT(0:%PC_MAXCATAGORY) BIT(1) UNAL STATIC INIT (NO*0);
      127    11720        /**/
      128    11721    1   DCL PDT(0:303/*SIZEW(JM$PT)*15-1*/) UBIN WORD STATIC INIT(0*0);
      129    11722    1   DCL PDTFLAGS(0:303/*SIZEW(JM$PT)*15-1*/) UBIN WORD STATIC INIT(0*0);
      130    11723        /**/
      131    11724    1   DCL PDT$ PTR STATIC SYMDEF INIT (ADDR(PDT));
      132    11725    1   DCL PDTFLAG$ PTR STATIC SYMDEF INIT (ADDR(PDTFLAGS));
      133    11726        /**/
      134    11727    1   DCL SET_PDT$ PTR STATIC;
      135    11728    1   DCL SET_PDTFLAG$ PTR STATIC;
      136    11729        /**/
      137    11730    1   DCL DUMMY$ PTR;
      138    11731    1   DCL ERRCODE REDEF DUMMY$ BIT(36);
      139    11732    1   DCL CODE SBIN;
      140    11733    1   DCL SET_CAT SBIN WORD STATIC;
      141    11734    1   DCL SET_PARAM SBIN WORD STATIC;
      142    11735    1   DCL SET_INDEXLO SBIN WORD STATIC;
      143    11736    1   DCL SET_INDEXHI SBIN WORD STATIC;
      144    11737    1   DCL VALUE SBIN WORD STATIC;
      145    11738    1   DCL MASK_VALUE REDEF VALUE BIT(36);
      146    11739    1   DCL MONSER_VALUE(0:%MAX_FCG#) BIT(36) STATIC ALIGNED;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:5    
      147    11740    1   DCL PMME UBIN HALF HALIGNED;
      148    11741    1   DCL 1 PMME_REDEF REDEF PMME,
      149    11742    1         2 FCG  UBIN(6)  UNAL,
      150    11743    1         2 CODE UBIN(12) UNAL;
      151    11744    1   DCL PC$ PTR;
      152    11745    1   DCL VAL$ PTR;
      153    11746    1   DCL MASKVALHI UBIN;
      154    11747        %EQU PRIV_VAL_HI   = %PC_PRIVHI-1;
      155    11748    1   DCL PC_CODE(0:0) UBIN BYTE UNAL BASED;
      156    11749    1   DCL VAL_CODE(0:0) BIT(36) ALIGNED BASED;
      157    11750    1   DCL 1 PRIV_VALS CONSTANT ALIGNED,
      158    11751    1         2 PC_CODE(0:%PRIV_VAL_HI) UBIN BYTE UNAL INIT(
      159    11752    1                             %PC_ALL,
      160    11753    1                             %PC_NONE,
      161    11754    1                             %PC_SPCLMM,
      162    11755    1                             %PC_EXMM,
      163    11756    1                             %PC_MAXMEM,
      164    11757    1                             %PC_MSYS,
      165    11758    1                             %PC_JIT,
      166    11759    1                             %PC_TND,
      167    11760    1                             %PC_PM,
      168    11761    1                             %PC_EXPM,
      169    11762    1                             %PC_IOQ,
      170    11763    1                             %PC_IOQW,
      171    11764    1                             %PC_INTCON,
      172    11765    1                             %PC_CQ,
      173    11766    1                             %PC_CFEP,
      174    11767    1                             %PC_MFEP,
      175    11768    1                             %PC_SYSLOG,
      176    11769    1                             %PC_GPP,
      177    11770    1                             %PC_ASAVE,
      178    11771    1                             %PC_SYSCON,
      179    11772    1                             %PC_DISPJOB,
      180    11773    1                             %PC_SCREECH,
      181    11774    1                             %PC_SNAP,
      182    11775    1                             %PC_FMREAD,
      183    11776    1                             %PC_FMDIAG,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:6    
      184    11777    1                             %PC_FMSEC,
      185    11778    1                             %PC_FMBLK,
      186    11779    1                             %PC_FMEFT),
      187    11780    1         2 VAL_CODE(0:%PRIV_VAL_HI) BIT(36) ALIGNED INIT(
      188    11781    1                             '777777777777'O,
      189    11782    1                             '0'B,
      190    11783    1                             %PR_SPCLMM#,
      191    11784    1                             %PR_EXMM#,
      192    11785    1                             %PR_MAXMEM#,
      193    11786    1                             %PR_MSYS#,
      194    11787    1                             %PR_JIT#,
      195    11788    1                             %PR_TND#,
      196    11789    1                             %PR_PM#,
      197    11790    1                             %PR_EXPM#,
      198    11791    1                             %PR_IOQ#,
      199    11792    1                             %PR_IOQW#,
      200    11793    1                             %PR_INTCON#,
      201    11794    1                             %PR_CQ#,
      202    11795    1                             %PR_CFEP#,
      203    11796    1                             %PR_MFEP#,
      204    11797    1                             %PR_SYSLOG#,
      205    11798    1                             %PR_GPP#,
      206    11799    1                             %PR_ASAVE#,
      207    11800    1                             %PR_SYSCON#,
      208    11801    1                             %PR_DISPJOB#,
      209    11802    1                             %PR_SCREECH#,
      210    11803    1                             %PR_SNAP#,
      211    11804    1                             %PR_FMREAD#,
      212    11805    1                             %PR_FMDIAG#,
      213    11806    1                             %PR_FMSEC#,
      214    11807    1                             %PR_FMBLK#,
      215    11808    1                             %PR_FMEFT#);
      216    11809    1   DCL SUBLK$ PTR;
      217    11810    1   DCL LIT$ PTR;
      218    11811    1   DCL WORDS_AVAIL SBIN WORD STATIC;
      219    11812    1   DCL INSTANCE_NAME CHAR(8);
      220    11813    1   DCL PSEUDO_NAME CHAR(8);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:7    
      221    11814        %EQU WORDS_PER_GRAN = 1024;
      222    11815        %EQU DEFAULT_MAXTPU = 49;
      223    11816    1   DCL CURUTS UBIN WORD STATIC;
      224    11817    1   DCL FIRST_INDX SBIN WORD;
      225    11818    1   DCL LAST_INDX SBIN WORD;
      226    11819    1   DCL FOUND BIT(1);
      227    11820    1   DCL CUR_SIZE_OF_FILE SBIN WORD;
      228    11821    1   DCL CUR_SIZE_OF_DATA SBIN WORD;
      229    11822    1   DCL TABLE$ PTR;
      230    11823    1   DCL INSTANCE$ PTR;
      231    11824    1   DCL PTR$ PTR;
      232    11825    1   DCL PARMTYPE UBIN WORD;
      233    11826    1   DCL PARMX SBIN WORD;
      234    11827    1   DCL ERR# SBIN WORD;
      235    11828    1   DCL DELINDX SBIN WORD;
      236    11829    1   DCL TBLINDX SBIN WORD;
      237    11830    1   DCL MAXTPU_BUF CHAR(16) STATIC INIT('MAXTPU(');
      238    11831    1   DCL RU_PARAMS(0:35) BIT(1) STATIC INIT('0'B*0);
      239    11832    1   DCL RU_FMT CHAR(0) CONSTANT INIT('%A:%10P');
      240    11833    1   DCL 1 RUBUF STATIC ALIGNED,
      241    11834    1         2 COUNT UBIN BYTE UNAL,
      242    11835    1         2 TEXT CHAR(132) UNAL;
      243    11836    1   DCL TEMPBUF CHAR(32);
      244    11837    1   DCL TEMPNAME CHAR(8);
      245    11838    1   DCL PARAM_FMT CHAR(0) CONSTANT INIT('%A%10P');
      246    11839    1   DCL 1 RUPARAM_TBL (0:%PC_NUMRUFLAGS) STATIC ALIGNED,
      247    11840    1         2 COUNT UBIN BYTE UNAL INIT(0,10,10,8,11,6,7,4,6),
      248    11841    1         2 TEXT CHAR(12) UNAL INIT(' ',
      249    11842    1                                   'NOCHGPMEM=',
      250    11843    1                                   'SHAREABLE=',
      251    11844    1                                   'PROCACC=',
      252    11845    1                                   'PROCSURCHG=',
      253    11846    1                                   'STATS=',
      254    11847    1                                   'PSEUDO=',
      255    11848    1                                   'NUM=',
      256    11849    1                                   ' LOCK=');
      257    11850    1   DCL DCB_WIDTH SBIN WORD;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:8    
      258    11851    1   DCL TEMPLEN SBIN WORD;
      259    11852    1   DCL DUMP_FMT CHAR(0) CONSTANT INIT('%T%10P');
      260    11853    1   DCL DUMP_BUF BIT(72) STATIC INIT(VECTOR(DUMP_FMT));
      261    11854    1   DCL DUMP_LOCK_FMT CHAR(0) CONSTANT INIT('%T%2P%12ZO %12ZO%10P');
      262    11855    1   DCL DUMP_LOCK BIT(72) STATIC INIT(VECTOR(DUMP_LOCK_FMT));
      263    11856    1   DCL OUTBUF CHAR(132) STATIC;
      264    11857    1   DCL P_PCB$ PTR STATIC INIT(ADDR(NIL));
      265    11858        %XUR_INIT (SYNTAX=YES,GOODCMD=YES,COMMANDS=YES);
      266    11957        %XUG_INIT (COMMANDS=NO,GOODCMD=YES,WSEG=6);
      267    12370        %XUG_GETCMD (NODES=XST_TIMEZONE);
      268    12708        %F_FDS (NAME=FDS,BUF=OUTBUF,DCB=M$LO);
      269    12821        %PC$HDR (STCLASS="BASED(B$DS5$)");
      270    12825        %PC$INSTANCE (STCLASS="BASED(INSTANCE$)");
      271    12875        %B$HEAD (STCLASS=STATIC);
      272    13075        %B$RUHEADKEY (NAME=HEADKEY,STCLASS=STATIC);
      273    13082    1   DCL 1 CNTRL_KEY STATIC,
      274    13083    1         2 COUNT UBIN(9) UNAL INIT(3),
      275    13084    1         2 ONE UBIN(27) UNAL INIT(1000);
      276    13085        /**/
      277    13086    1   DCL 1 TEXTC_MODEX(0:%PC_MAXMODE) STATIC,
      278    13087    1         2 COUNT UBIN(9) UNAL INIT(0,1,1,1,2),
      279    13088    1         2 TEXT CHAR(3) UNAL INIT(' ','B','G','O','TP');
      280    13089    1   DCL 1 TEXTC_PART#X(0:15) STATIC SYMDEF,
      281    13090    1         2 COUNT UBIN(9) UNAL INIT(1*9,2*7),
      282    13091    1         2 TEXT CHAR(3) UNAL INIT('1','2','3','4','5','6','7','8',
      283    13092    1           '9','10','11','12','13','14','15','16');
      284    13093    1   DCL 1 TEXTC_DOMAINX(0:%PC_MAXDOMAIN) STATIC,
      285    13094    1         2 COUNT UBIN(9) UNAL INIT(2,2,3,1),
      286    13095    1         2 TEXT CHAR(3) UNAL INIT('CP','DB','ASL','U');
      287    13096        /**/
      288    13097    1   DCL 1 TEXTC_CAT(0:%PC_MAXCATAGORY) STATIC SYMDEF,
      289    13098    1         2 COUNT UBIN(9) UNAL INIT(0,6,8,9,5,9),
      290    13099    1         2 TEXT CHAR(12) UNAL INIT(' ',
      291    13100    1           'SYSTEM',
      292    13101    1           'RESOURCE',
      293    13102    1           'PARTITION',
      294    13103    1           'TPCAT',
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:9    
      295    13104    1           'EXCEPTION');
      296    13105        /**/
      297    13106    1   DCL 1 TEXTC_MODE(0:%PC_MAXMODE) STATIC SYMDEF,
      298    13107    1         2 COUNT UBIN(9) UNAL INIT(0,5,5,6,2),
      299    13108    1         2 TEXT CHAR(11) UNAL INIT(' ',
      300    13109    1           'BATCH',
      301    13110    1           'GHOST',
      302    13111    1           'ONLINE',
      303    13112    1           'TP');
      304    13113        /**/
      305    13114    1   DCL 1 TEXTC_DOMAIN(0:%PC_MAXDOMAIN) STATIC SYMDEF,
      306    13115    1         2 COUNT UBIN(9) UNAL INIT(2,2,3,4),
      307    13116    1         2 TEXT CHAR(7) UNAL INIT('CP',
      308    13117    1           'DB',
      309    13118    1           'ASL',
      310    13119    1           'USER');
      311    13120        /**/
      312    13121    1   DCL 1 TEXT_C STATIC SYMDEF,
      313    13122    1         2 COUNT UBIN(9) UNAL,
      314    13123    1         2 TEXT CHAR(16) UNAL;
      315    13124        /**/
      316    13125    1   DCL 1 RESTEXT_C STATIC SYMDEF,
      317    13126    1         2 COUNT UBIN(9) UNAL,
      318    13127    1         2 TEXT CHAR(12) UNAL;
      319    13128        /**/
      320    13129    1   DCL TEXT_CONTROLHERE CHAR(19) STATIC INIT(' ');
      321    13130    1   DCL B_VERSION CHAR(1) SYMREF;
      322    13131    1   DCL 1 B$VERSIONB BASED,
      323    13132    1        2 C_ UBIN BYTE CALIGNED,
      324    13133    1        2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      325    13134    1   DCL DASH CHAR(1) STATIC INIT('-');
      326    13135        /**/
      327    13136        %VLP_VECTOR ( FPTN = DS_RESULTS );
      328    13151        /**/
      329    13152        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:10   
      330    13153        /*       ADDING PARAMETERS
      331    13154
      332    13155                 To add a parameter to CONTROL it is necessary to do the
      333    13156                 following things:
      334    13157
      335    13158                 1) Change PCN$NODES to recognize new parameter
      336    13159
      337    13160                 2) Add a %EQU to PC_SUBS_C for the new parameter
      338    13161
      339    13162                 3) Add a %PARM macro invocation describing the new parameter
      340    13163                    to the list that follows - note that this %PARM list
      341    13164                    must be in the same order as the %EQUs.
      342    13165
      343    13166                 4) Update HELP messages to document new parameter
      344    13167
      345    13168                 5) Possibly add some code to handle new parameter - should
      346    13169                    only be necessary in the case of PARTITION parameters for
      347    13170                    which a CASE statement must be added to a DO CASE in
      348    13171                    a few places.
      349    13172        */
      350    13173        /**/
      351    13174        /* DATA MACROS */
      352    13175        /**/
      353    13176        %MACRO PARM (NAME = NAME,
      354    13177                    DISP = NO,
      355    13178                    INDEXED = YES,
      356    13179                    RESTYPE = NO,
      357    13180                      MAXCONSTANT = YES,
      358    13181                      MINCONSTANT = YES,
      359    13182                      VALUETEXT=NO,
      360    13183                      VALUETEXTLIST=NO,
      361    13184                      INTINDEXED=NO,
      362    13185                      VALUECODE=0,
      363    13186                      PRINTFLG=YES,
      364    13187                      MULTIPLIER = 1,
      365    13188                      MAXVALUE = 1,
      366    13189                      MINVALUE = 0,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:11   
      367    13190                    RESFLGTBL = NIL,
      368    13191                    TEXTNAME = 'NAME',
      369    13192                    TABLE = NIL,
      370    13193                        PSUTABLE = NIL,
      371    13194                    LAST =",",
      372    13195                    YES = '1'B,NO = '0'B);
      373    13196        /**/
      374    13197              2 NAME ALIGNED,
      375    13198                3 FLAGS,
      376    13199                  4 PRINT BIT(1) UNAL INIT(PRINTFLG),
      377    13200                  4 DISPONLY BIT(1) UNAL INIT(DISP),
      378    13201                  4 INDX BIT(1) UNAL INIT(INDEXED),
      379    13202                  4 RES BIT(1) UNAL INIT(RESTYPE),
      380    13203                  4 MAXCONST BIT(1) UNAL INIT(MAXCONSTANT),
      381    13204                  4 MINCONST BIT(1) UNAL INIT(MINCONSTANT),
      382    13205                  4 VALTEXT BIT(1) UNAL INIT(VALUETEXT),
      383    13206                  4 VALTEXTLIST BIT(1) UNAL INIT(VALUETEXTLIST),
      384    13207                  4 INTINDX BIT(1) UNAL INIT(INTINDEXED),
      385    13208                    /* Internally indexed. I.e., indexed for our convenience,
      386    13209                       but the user doesn't want to know.                */
      387    13210                  4 * BIT(9) UNAL INIT('0'B),
      388    13211                3 VALCODE UBIN(18) UNAL INIT(VALUECODE),
      389    13212                3 RESPTR$ PTR ALIGNED INIT(ADDR(RESFLGTBL)),
      390    13213                3 TEXT ALIGNED,
      391    13214                  4 COUNT UBIN(9) UNAL INIT(SIZEC(TEXTNAME)),
      392    13215                  4 TEXT CHAR(19) UNAL INIT(TEXTNAME),
      393    13216                3 PTR$ PTR INIT(ADDR(TABLE)),
      394    13217                3 PSUPTR$ PTR INIT(ADDR(PSUTABLE)),
      395    13218                3 MAX SBIN WORD INIT(MAXVALUE),
      396    13219                3 MIN SBIN WORD INIT(MINVALUE),
      397    13220                3 MULT UBIN WORD UNAL INIT(MULTIPLIER) LAST
      398    13221        %MEND;
      399    13222        /**/
      400    13223        %MACRO CATAGORY (NAME = NAME,
      401    13224                       PRINTFLG = YES,
      402    13225                       PARAM_MAX = 1,
      403    13226                       PARAM_TBL = NIL,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:12   
      404    13227                       LAST =",",
      405    13228                       YES = '1'B,NO = '0'B);
      406    13229        /**/
      407    13230              2 NAME ALIGNED,
      408    13231                3 FLAGS,
      409    13232                  4 PRINT BIT(1) UNAL INIT(PRINTFLG),
      410    13233                  4 * BIT(17) UNAL INIT(NO),
      411    13234                3 MAXPARAM UBIN(18) UNAL INIT(PARAM_MAX),
      412    13235                3 PARAM$ PTR INIT(ADDR(PARAM_TBL)) LAST
      413    13236        %MEND;
      414    13237        /**/
      415    13238        %MACRO RESFLGTBL (NAME = NAME);
      416    13239        /**/
      417    13240        DCL NAME(0:15) BIT(1) STATIC INIT('1'B*0);
      418    13241        %MEND;
      419    13242        /**/
      420    13243        /* SYSTEM PARAMETERS */
      421    13244        /**/
      422    13245    1   DCL 1 SYSTEM_TBL STATIC ALIGNED,
      423    13246        %PARM (TABLE = TEXTC_MODEX);
      424    13273        %PARM (NAME=UM,TEXTNAME='UM',TABLE=S_MUIS,MAXCONSTANT=NO,MAXVALUE=%PC_MAXU);
      425    13300        %PARM (NAME=UC,TEXTNAME='UC',DISP=YES,TABLE=S_CUIS);
      426    13327        %PARM (NAME=TOTU,TEXTNAME='TOTU',DISP=YES,INDEXED=NO,TABLE=S_CTUIS);
      427    13354        %PARM (NAME=LIMITU,TEXTNAME='LIMITU',INDEXED=NO,MAXCONSTANT=NO,
      428    13355                MAXVALUE=%PC_MAXU,TABLE=S_TUIS);
      429    13382        %PARM (NAME=MAXU,TEXTNAME='MAXU',DISP=YES,INDEXED=NO,TABLE=B_MUAIS);
      430    13409        %PARM (NAME=QMIN,TEXTNAME='QMIN',TABLE=SL_QMIN,
      431    13410               MULTIPLIER=1000,MINVALUE=20,MAXVALUE="BITBIN('000203044672'O)");
      432    13437        %PARM (NAME=QUAN,TEXTNAME='QUAN',INDEXED=NO,TABLE=SL_QUAN,
      433    13438               MULTIPLIER=1000,MINVALUE=20,MAXVALUE="BITBIN('000203044672'O)");
      434    13465        %PARM (NAME=PRIOB,TEXTNAME='PRIOB',TABLE=S_PRIOB,INDEXED=YES,
      435    13466                MINVALUE=1,MAXVALUE=511);
      436    13493        %PARM (NAME=IOTA,TEXTNAME='IOTA',TABLE=SL_IOTA,
      437    13494                MULTIPLIER=1000,MAXVALUE="BITBIN('000203044672'O)");
      438    13521        %PARM (NAME=MFBLK,TEXTNAME='MFBLK',TABLE=SL_MF,MINCONSTANT=NO,
      439    13522                MINVALUE=%PC_MFUBL,MAXVALUE=511);
      440    13549        %PARM (NAME=MFUBL,TEXTNAME='MFUBL',TABLE=SL_MFU,MAXCONSTANT=NO,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:13   
      441    13550                MAXVALUE=%PC_MFBLK);
      442    13577        %PARM (NAME=PI,TEXTNAME='PI',INDEXED=NO,TABLE=JM_PI,MAXVALUE=511);
      443    13604        %PARM (NAME=RETIM,TEXTNAME='RETIM',INDEXED=NO,TABLE=JZ_RETIM,MAXVALUE=
             13604            "BITBIN('377777777777'O)");
      444    13631        %PARM (NAME=NPART,TEXTNAME='NPART',INDEXED=NO,TABLE=JM_NPART,
      445    13632                MAXVALUE=16);
      446    13659        %PARM (NAME=ANSPROT,TEXTNAME='ANSPROT',INDEXED=NO,TABLE=FT_PROT,
      447    13660                MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,VALUECODE=%PC_ANSPROTVAL);
      448    13687        %PARM (NAME=MAXENQ,TEXTNAME='MAXENQ',INDEXED=NO,TABLE=UQ_MAXENQ,
      449    13688                MINVALUE = 2,MAXVALUE = "BITBIN('777777'O)");
      450    13715        %PARM (NAME=MAXACCT,TEXTNAME='MAXACCT',INDEXED=NO,TABLE=JM_MAX1ACCT,
      451    13716                MINVALUE=1,MAXVALUE=511);
      452    13743        %PARM (NAME=AUTOSHARE,TEXTNAME='AUTOSHARE',INDEXED=NO,TABLE=JS_SHARE_ALL,
      453    13744                MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,VALUECODE=%PC_AUTOSHAREVAL);
      454    13771        %PARM (NAME=GRANSCHED,TEXTNAME='GRANSCHED',INDEXED=NO,TABLE=FO_SYMBINFO,VALUETEXT=
             13771            YES,VALUECODE=%PC_FLAGVAL);
      455    13798        %PARM (NAME=JOBSTATSAGE,TEXTNAME='JOBSTATSAGE',INDEXED=NO,TABLE=FO_JOBSTATSAGE,
             13798            MINVALUE=1,
      456    13799                MAXVALUE=511);
      457    13826        %PARM (NAME=WATCH,TEXTNAME='WATCH',INDEXED=NO,TABLE="FO_SYMBINFO.WATCH#",
      458    13827                MINVALUE=0,MAXVALUE=1,VALUETEXT=YES,VALUECODE=%PC_FLAGVAL);
      459    13854        %PARM (NAME=HOLDEXPIRE,TEXTNAME='HOLDEXPIRE',INDEXED=NO,TABLE=
             13854            "FO_SYMBINFO.HOLDEXPIRE#",
      460    13855                MINVALUE=0,MAXVALUE=511);
      461    13882        %PARM (NAME=FREETHRESH,TEXTNAME='FREETHRESH',TABLE=MM_FREETHRESH,INDEXED=NO,
      462    13883                MAXVALUE=1000);
      463    13910        %PARM (NAME=NOUSTHRESH,TEXTNAME='NOUSTHRESH',TABLE=MM_NOUSTHRESH,INDEXED=NO,
      464    13911                MAXVALUE=1000);
      465    13938        %PARM (NAME=EXPTIME_MAD,TEXTNAME="'EXPTIME(MAD)'",INDEXED=NO,TABLE=
             13938            "FMC_LIMITS.EXPIRE(%CTYP_MAD)",
      466    13939        MAXVALUE="BITBIN('377777777777'O)");
      467    13966        %PARM (NAME=EXPTIME_PAD,TEXTNAME="'EXPTIME(PAD)'",INDEXED=NO,TABLE=
             13966            "FMC_LIMITS.EXPIRE(%CTYP_PAD)",
      468    13967        MAXVALUE="BITBIN('377777777777'O)");
      469    13994        %PARM (NAME=EXPTIME_GP,TEXTNAME="'EXPTIME(GP)'",INDEXED=NO,TABLE=
             13994            "FMC_LIMITS.EXPIRE(%CTYP_GP)",
      470    13995        MAXVALUE="BITBIN('377777777777'O)");
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:14   
      471    14022        %PARM (NAME=EXPTIME_FD,TEXTNAME="'EXPTIME(FD)'",INDEXED=NO,TABLE=
             14022            "FMC_LIMITS.EXPIRE(%CTYP_FD)",
      472    14023        MAXVALUE="BITBIN('377777777777'O)");
      473    14050        %PARM (NAME=EXPTIME_FIT,TEXTNAME="'EXPTIME(FIT)'",INDEXED=NO,TABLE=
             14050            "FMC_LIMITS.EXPIRE(%CTYP_FIT)",
      474    14051        MAXVALUE="BITBIN('377777777777'O)");
      475    14078        %PARM (NAME=EXPTIME_UL,TEXTNAME="'EXPTIME(UL)'",INDEXED=NO,TABLE=
             14078            "FMC_LIMITS.EXPIRE(%CTYP_UL)",
      476    14079        MAXVALUE="BITBIN('377777777777'O)");
      477    14106        %PARM (NAME=EXPTIME_INDEX,TEXTNAME="'EXPTIME(INDEX)'",INDEXED=NO,TABLE=
             14106            "FMC_LIMITS.EXPIRE(%CTYP_INDEX)",
      478    14107        MAXVALUE="BITBIN('377777777777'O)");
      479    14134        %PARM (NAME=EXPTIME_DATA,TEXTNAME="'EXPTIME(DATA)'",INDEXED=NO,TABLE=
             14134            "FMC_LIMITS.EXPIRE(%CTYP_DATA)",
      480    14135        MAXVALUE="BITBIN('377777777777'O)");
      481    14162        %PARM (NAME=EXPTIME_REL,TEXTNAME="'EXPTIME(REL)'",INDEXED=NO,TABLE=
             14162            "FMC_LIMITS.EXPIRE(%CTYP_REL)",
      482    14163        MAXVALUE="BITBIN('377777777777'O)");
      483    14190        %PARM (NAME=EXPTIME_CONSEC,TEXTNAME="'EXPTIME(CONSEC)'",INDEXED=NO,TABLE=
             14190            "FMC_LIMITS.EXPIRE(%CTYP_CONSEC)",
      484    14191        MAXVALUE="BITBIN('377777777777'O)");
      485    14218        %PARM (NAME=UPDLIMIT_INDEX,TEXTNAME="'UPDLIMIT(INDEX)'",INDEXED=NO,TABLE=
             14218            "FMC_LIMITS.UPLIMIT(%CTYP_INDEX)",
      486    14219        MAXVALUE="BITBIN('377777777777'O)");
      487    14246        %PARM (NAME=UPDLIMIT_DATA,TEXTNAME="'UPDLIMIT(DATA)'",INDEXED=NO,TABLE=
             14246            "FMC_LIMITS.UPLIMIT(%CTYP_DATA)",
      488    14247        MAXVALUE="BITBIN('377777777777'O)");
      489    14274        %PARM (NAME=UPDLIMIT_REL,TEXTNAME="'UPDLIMIT(REL)'",INDEXED=NO,TABLE=
             14274            "FMC_LIMITS.UPLIMIT(%CTYP_REL)",
      490    14275        MAXVALUE="BITBIN('377777777777'O)");
      491    14302        %PARM (NAME=AUTO_PRIO,TEXTNAME='AUTO_PRIO',INDEXED=NO,TABLE=MM_AUTO_PRIO,
      492    14303             MAXVALUE=100,MINVALUE=1);
      493    14330        %PARM (NAME=CACHE_PRIO,TEXTNAME='CACHE_PRIO',INDEXED=NO,TABLE=MM_CACHE_PRIO,
      494    14331             MAXVALUE=100,MINVALUE=1);
      495    14358        %PARM (NAME=CG_PRIO,TEXTNAME='CG_PRIO',INDEXED=NO,TABLE=MM_CG_PRIO,
      496    14359             MAXVALUE=100,MINVALUE=1);
      497    14386        %PARM (NAME=LOGFILEGRANT,TEXTNAME='LOGFILEGRANT',INDEXED=NO,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:15   
      498    14387               TABLE=ES_LOGFILEGRANT,MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,
      499    14388               VALUECODE=%PC_LOGFILEVAL);
      500    14415        %PARM (NAME=LOGFILEDENY,TEXTNAME='LOGFILEDENY',INDEXED=NO,
      501    14416               TABLE=ES_LOGFILEDENY,MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,
      502    14417               VALUECODE=%PC_LOGFILEVAL);
      503    14444              /* BIT(36) items, like priv masks or pmmes, have max and min
      504    14445                 codes set to the largest and smallest SBIN numbers possible
      505    14446                 so they can't get 2BIG or 2SMALL errors by mistake.      */
      506    14447        %PARM (NAME=PRIVMASK,TEXTNAME='PRIVMASK',INDEXED=NO,TABLE=ES_PRIVMASK,
      507    14448               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      508    14449               VALUETEXTLIST=YES,VALUECODE=%PC_PRIVVAL);
      509    14476        %PARM (NAME=STEPPRIVMASK,TEXTNAME='STEPPRIVMASK',INDEXED=NO,TABLE=ES_STEPPRIVMASK,
      510    14477               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      511    14478               VALUETEXTLIST=YES,VALUECODE=%PC_PRIVVAL);
      512    14505        %PARM (NAME=LOGPRIVCHNG,TEXTNAME='LOGPRIVCHNG',INDEXED=NO,TABLE=ES_LOGPRIVCHNG,
      513    14506               MINVALUE=0,MAXVALUE=3,VALUETEXT=YES,VALUECODE=%PC_LOGLISTVAL);
      514    14533        %PARM (NAME=PRIVCHNGMASK,TEXTNAME='PRIVCHNGMASK',INDEXED=NO,TABLE=ES_PRIVCHNGMASK,
      515    14534               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      516    14535               VALUETEXTLIST=YES,VALUECODE=%PC_PRIVVAL);
      517    14562        %PARM (NAME=LOGSYSACCESS,TEXTNAME='LOGSYSACCESS',INDEXED=NO,
      518    14563               TABLE=ES_LOGSYSACC,MINVALUE=0,MAXVALUE=4,VALUETEXT=YES,
      519    14564               VALUECODE=%PC_LOGACCVAL);
      520    14591        %PARM (NAME=LOGSYSEXIT,TEXTNAME='LOGSYSEXIT',INDEXED=NO,
      521    14592               TABLE=ES_LOGSYSEXIT,MINVALUE=0,MAXVALUE=1,VALUETEXT=YES,
      522    14593               VALUECODE=%PC_LOGEXVAL);
      523    14620        %PARM (NAME=LOGMONSER,TEXTNAME='LOGMONSER',INDEXED=NO,TABLE=ES_LOGMONSER,
      524    14621               MINVALUE=0,MAXVALUE=3,VALUETEXT=YES,VALUECODE=%PC_LOGLISTVAL);
      525    14648        %PARM (NAME=MONSERTBL,TEXTNAME='MONSERTBL',INDEXED=NO,TABLE=ES_MONSERTBL,
      526    14649               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      527    14650               VALUETEXTLIST=YES,INTINDEXED=YES,VALUECODE=%PC_MONSERVAL);
      528    14677        %PARM (NAME=CLEARMEM,TEXTNAME='CLEARMEM',INDEXED=NO,TABLE=ES_CLEARMEM,
      529    14678               MINVALUE=0,MAXVALUE=1,VALUETEXT=YES,VALUECODE=%PC_FLAGVAL);
      530    14705        %PARM (NAME=PROTECTSECLOG,TEXTNAME='PROTECTSECLOG',INDEXED=NO,
      531    14706               TABLE=ES_PROTECTSECLOG,MINVALUE=1,MAXVALUE=3650,
      532    14707               MULTIPLIER="%(24*60*60*100)");
      533    14734        %PARM (NAME=SECLOGSIZE,TEXTNAME='SECLOGSIZE',INDEXED=NO,TABLE=EL_SECLOGSIZE,
      534    14735               MINVALUE=10,MAXVALUE=262143);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:16   
      535    14762        %PARM (NAME=IOLEAPERS,TEXTNAME='IOLEAPERS',INDEXED=NO,TABLE=NI_IOLEAPERS,
      536    14763               MINVALUE=0,MAXVALUE=262143);
      537    14790        %PARM (NAME=TIMEZONE,TEXTNAME='TIMEZONE',INDEXED=NO,MINVALUE=0,
      538    14791                MAXVALUE="BITBIN('377777777777'O)",TABLE=UMT_TIMEZONE);
      539    14818        %PARM (NAME=UTC_OFFSET,TEXTNAME='UTC_OFFSET',INDEXED=NO,MINVALUE=
             14818            "BITBIN('400000000000'O)",
      540    14819                MAXVALUE="BITBIN('377777777777'O)",DISP=YES,TABLE=UMT_UTC_OFFSET,
      541    14820                LAST=";");
      542    14847        /**/
      543    14848        /* RESOURCE PARAMETERS */
      544    14849        /**/
      545    14850    1   DCL 1 RESOURCE_TBL STATIC ALIGNED,
      546    14851        %PARM (TABLE = TEXTC_MODEX);
      547    14878        %PARM (NAME=MAX,TEXTNAME='MAX',RESTYPE=YES,RESFLGTBL=MAXRFLGS,
      548    14879                TABLE=FR_PRM$,PSUTABLE=FR_SUM$);
      549    14906        %PARM (NAME=CUR,TEXTNAME='CUR',RESTYPE=YES,RESFLGTBL=CURRFLGS,DISP=YES,
      550    14907                TABLE=FR_PRC$,PSUTABLE=FR_SUC$);
      551    14934        %PARM (NAME=TOT,TEXTNAME='TOT',RESTYPE=YES,RESFLGTBL=TOTRFLGS,INDEXED=NO,
      552    14935                TABLE=FR_PRM$,PSUTABLE=FR_SUM$,DISP=YES,LAST=";");
      553    14962        /**/
      554    14963        /* PARTITION PARAMETERS */
      555    14964        /**/
      556    14965    1   DCL 1 PARTITION_TBL STATIC ALIGNED,
      557    14966        %PARM (TABLE = TEXTC_PART#X);
      558    14993        %PARM (NAME=PMINTI,TEXTNAME='PMINTI',TABLE=JM_PT,MULTIPLIER=6000);
      559    15020        %PARM (NAME=PMAXTI,TEXTNAME='PMAXTI',TABLE=JM_PT,MULTIPLIER=6000,MAXVALUE=59999400);
      560    15047        %PARM (NAME=PMIN,TEXTNAME='PMIN',RESTYPE=YES,RESFLGTBL=PMINRFLGS,TABLE=JM_PT);
      561    15074        %PARM (NAME=PMAX,TEXTNAME='PMAX',RESTYPE=YES,RESFLGTBL=PMAXRFLGS,TABLE=JM_PT);
      562    15101        %PARM (NAME=PLOCK,TEXTNAME='PLOCK',TABLE=JM_PT,MAXVALUE=1,VALUETEXT=YES,VALUECODE=
             15101            %PC_FLAGVAL);
      563    15128        %PARM (NAME=PQUAN,TEXTNAME='PQUAN',TABLE=JM_PT,MULTIPLIER=1000,
      564    15129                MINVALUE=20,MAXVALUE="BITBIN('000203044672'O)");
      565    15156        %PARM (NAME=PPRIO,TEXTNAME='PPRIO',TABLE=JM_PT,MINVALUE=1,
      566    15157                MAXVALUE=511);
      567    15184        %PARM (NAME=PMAXACCT,TEXTNAME='PMAXACCT',TABLE=JM_PT,MINVALUE=1,MAXVALUE=511);
      568    15211        %PARM (NAME=PJMAX,TEXTNAME='PJMAX',TABLE=JM_PT,MAXVALUE=511);
      569    15238        %PARM (NAME=PJCUR,TEXTNAME='PJCUR',TABLE=JM_PT);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:17   
      570    15265        %PARM (NAME=PJCTOT,TEXTNAME='PJCTOT',TABLE=JM_PT);
      571    15292        %PARM (NAME=PJTOT,TEXTNAME='PJTOT',TABLE=JM_PT,LAST=";");
      572    15319        /**/
      573    15320        /* EXCEPTION PARAMETERS */
      574    15321        /**/
      575    15322    1   DCL 1 EXCEPTION_TBL STATIC ALIGNED,
      576    15323        %PARM (TABLE = TEXTC_DOMAINX);
      577    15350        %PARM (NAME=ETIME,TEXTNAME='ETIME',MAXVALUE="BITBIN('000203044672'O)",TABLE=JS_TIME,
             15350            MULTIPLIER=100);
      578    15377        %PARM (NAME=EPDISK,TEXTNAME='EPDISK',MAXVALUE="BITBIN('377777777777'O)",TABLE=
             15377            JS_PRDPRM);
      579    15404        %PARM (NAME=ETDISK,TEXTNAME='ETDISK',MAXVALUE="BITBIN('377777777777'O)",TABLE=
             15404            JS_TMDPRM);
      580    15431        %PARM (NAME=EDO,TEXTNAME='EDO',MAXVALUE="BITBIN('377777'O)",TABLE=JS_REMDO);
      581    15458        %PARM (NAME=EPO,TEXTNAME='EPO',MAXVALUE="BITBIN('377777'O)",TABLE=JS_REMLO);
      582    15485        %PARM (NAME=ECPO,TEXTNAME='ECPO',MAXVALUE="BITBIN('377777'O)",TABLE=JS_REMCPO,LAST=
             15485            ";");
      583    15512        /**/
      584    15513        /* TP PARAMS */
      585    15514        /**/
      586    15515    1   DCL 1 TP_TBL STATIC ALIGNED,
      587    15516        %PARM (TABLE=TEXTC_MODEX);
      588    15543        %PARM (NAME=TPI,TEXTNAME='TPINSTANCE',PRINTFLG=NO);
      589    15570        %PARM (NAME=TPHDR,TEXTNAME='TPHDR',TABLE=TPHDR_TBL,MAXVALUE=0,PRINTFLG=NO);
      590    15597        %PARM (NAME=MAXTPU,TEXTNAME='MAXTPU',TABLE=MAXTPU_TBL,MAXVALUE=0,PRINTFLG=NO,LAST=
             15597            ";");
      591    15624        /**/
      592    15625        /**/
      593    15626    1   DCL 1 CATAGORY_TBL STATIC ALIGNED,
      594    15627        %CATAGORY;
      595    15636        %CATAGORY (NAME=SYSTEM,PARAM_MAX=%PC_SYSTEMHI,PARAM_TBL=SYSTEM_TBL);
      596    15645        %CATAGORY (NAME=RESOURCE,PARAM_MAX=%PC_RESOURCEHI,PARAM_TBL=RESOURCE_TBL);
      597    15654        %CATAGORY (NAME=PARTITION,PARAM_MAX=%PC_PARTITIONHI,PARAM_TBL=PARTITION_TBL);
      598    15663        %CATAGORY (NAME=TP,PARAM_MAX=%PC_TPHI,PARAM_TBL=TP_TBL,PRINTFLG=NO);
      599    15672        %CATAGORY (NAME=EXCEPTION,PARAM_MAX=%PC_EXCEPTIONHI,PARAM_TBL=EXCEPTION_TBL,LAST=";"
             15672            );
      600    15681        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:18   
      601    15682        %RESFLGTBL (NAME=MAXRFLGS);
      602    15686        %RESFLGTBL (NAME=CURRFLGS);
      603    15690        %RESFLGTBL (NAME=TOTRFLGS);
      604    15694        %RESFLGTBL (NAME=PMINRFLGS);
      605    15698        %RESFLGTBL (NAME=PMAXRFLGS);
      606    15702        /**/
      607    15703    1   DCL 1 MAXTPU_TBL(0:71) STATIC SYMDEF ALIGNED,
      608    15704    1         2 NAME CHAR(8) UNAL INIT(' '*0),
      609    15705    1         2 MAXTPU UBIN WORD UNAL INIT(0*0),
      610    15706    1         2 COUNT UBIN(18) UNAL INIT(0*0),
      611    15707    1         2 FLAGS UNAL,
      612    15708    1           3 PRINT BIT(1) UNAL INIT('0'B*0),
      613    15709    1           3 DELETED BIT(1) UNAL INIT('0'B*0),
      614    15710    1           3 * BIT(16) UNAL;
      615    15711        /**/
      616    15712    1   DCL 1 TPHDR_TBL(0:71) STATIC SYMDEF ALIGNED,
      617    15713    1    2 HDR,
      618    15714    1           3 CNT UBIN BYTE UNAL INIT(0*0),
      619    15715    1           3 MSG CHAR(80) UNAL INIT (' '*0),
      620    15716    1    2 FLAGS UNAL,
      621    15717    1           3 PRINT BIT(1) UNAL INIT('0'B*0),
      622    15718    1           3 PRESENT BIT(1) UNAL INIT('0'B*0),
      623    15719    1           3 * BIT(16) UNAL;
      624    15720        /**/
      625    15721        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:19   
      626    15722        /**/
      627    15723        /**********************************************************************/
      628    15724        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      629    15725        /**********************************************************************/
      630    15726        /**/
      631    15727        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
      632    15782        %F$DCB;
      633    15839        %PARSE$SYM;
      634    15877        %PARSE$OUT (NAME=O$BLK);
      635    15922        %B$TCB;
      636    15925        %B$ALT;
      637    15933        /**/
      638    15934    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
      639    15935    1         2 FLAGS,
      640    15936    1           3 PRINT BIT(1) UNAL,
      641    15937    1           3 DISPONLY BIT(1) UNAL,
      642    15938    1           3 INDX BIT(1) UNAL,
      643    15939    1           3 RES BIT(1) UNAL,
      644    15940    1           3 MAXCONST BIT(1) UNAL,
      645    15941    1           3 MINCONST BIT(1) UNAL,
      646    15942    1           3 VALTEXT BIT(1) UNAL,
      647    15943    1           3 VALTEXTLIST BIT(1) UNAL,
      648    15944    1           3 INTINDX BIT(1) UNAL,
      649    15945    1           3 * BIT(9) UNAL,
      650    15946    1         2 VALCODE UBIN(18) UNAL,
      651    15947    1         2 RESPTR$ PTR ALIGNED,
      652    15948    1         2 TEXT ALIGNED,
      653    15949    1           3 COUNT UBIN(9) UNAL,
      654    15950    1           3 TEXT CHAR(19) UNAL,
      655    15951    1         2 PTR$ PTR,
      656    15952    1         2 REPTR$ REDEF PTR$,
      657    15953    1           3 ADDRESS UBIN(24) UNAL,
      658    15954    1           3 SEGID UBIN(12) UNAL,
      659    15955    1         2 PSUPTR$ PTR,
      660    15956    1         2 REPSUPTR$ REDEF PSUPTR$,
      661    15957    1           3 ADDRESS UBIN(24) UNAL,
      662    15958    1           3 SEGID UBIN(12) UNAL,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:20   
      663    15959    1         2 MAX SBIN WORD UNAL,
      664    15960    1         2 MIN SBIN WORD UNAL,
      665    15961    1         2 MULT UBIN WORD UNAL;
      666    15962        /**/
      667    15963    1   DCL 1 CAT$TBL(0:0) BASED ALIGNED,
      668    15964    1         2 FLAGS,
      669    15965    1           3 PRINT BIT(1) UNAL,
      670    15966    1           3 * BIT(17) UNAL,
      671    15967    1         2 MAXPARAM UBIN(18) UNAL,
      672    15968    1         2 PARAM$ PTR;
      673    15969        /**/
      674    15970    1   DCL RES$FLGS(0:15) BIT(1) BASED UNAL;
      675    15971    1   DCL PSURES$TEXT(0:7) CHAR(8) BASED;
      676    15972        /**/
      677    15973    1   DCL 1 TEXTC$INDX(0:0) BASED ALIGNED,
      678    15974    1         2 COUNT UBIN(9) UNAL,
      679    15975    1         2 TEXT CHAR(3) UNAL;
      680    15976        /**/
      681    15977    1   DCL B$TABLE(0:0) UBIN WORD BASED ALIGNED;
      682    15978    1   DCL B$BITS(0:0) BIT(1) UNAL BASED;
      683    15979    1   DCL 1 B$PTR(0:0) BASED ALIGNED,
      684    15980    1         2 ADDRESS UBIN(24) UNAL,
      685    15981    1         2 SEGID UBIN(12) UNAL;
      686    15982        /**/
      687    15983        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:21   
      688    15984        /***********************************************************************/
      689    15985        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      690    15986        /**********************************************************************/
      691    15987        /**/
      692    15988    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
      693    15989    1   DCL XUR$INIT ENTRY(3) ALTRET;
      694    15990    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      695    15991        /**/
      696    15992    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      697    15993    1   DCL PCW$WRITE ENTRY(2) ALTRET;
      698    15994    1   DCL PCP$PDISP ENTRY(1) ALTRET;
      699    15995    1   DCL PCR$RESTEXT ENTRY(2);
      700    15996    1   DCL PCB$BREAK ENTRY ASYNC;
      701    15997    1   DCL PCB$BREAKSET ENTRY ASYNC;
      702    15998    1   DCL PCB$TRAP ENTRY ASYNC;
      703    15999        /**/
      704    16000    1   DCL PCT$SYSTEM ENTRY(1) ALTRET;
      705    16001    1   DCL PCT$RESOURCE ENTRY(1) ALTRET;
      706    16002    1   DCL PCT$PARTITION ENTRY(1) ALTRET;
      707    16003    1   DCL PCT$EXCEPTION ENTRY(1) ALTRET;
      708    16004    1   DCL PCT$TPCAT ENTRY(2) ALTRET;
      709    16005        /**/
      710    16006    1   DCL JMN$LOCK ENTRY(1) ALTRET;
      711    16007    1   DCL JMN$UNLOCK ENTRY(1);
      712    16008        /**/
      713    16009    1   DCL XST$TIMEZONE ENTRY(3) ALTRET;
      714    16010    1   DCL XST_NODES ENTRY CONV(5);
      715    16011    1   DCL XST_TIMEZONE SBIN SYMREF;
      716    16012    1   DCL XUG$GETCMD ENTRY(1) ALTRET;
      717    16013    1   DCL XUG$INIT ENTRY(2) ALTRET;
      718    16014        /********************************************************************/
      719    16015        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      720    16016        /********************************************************************/
      721    16017        /**/
      722    16018    1   DCL M$SI DCB;                           /* USER INPUT                         */
      723    16019    1   DCL M$LO DCB;                           /* ALL OUTPUT                         */
      724    16020    1   DCL M$DO DCB;                           /* DIAGNOSTICS                        */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:22   
      725    16021    1   DCL M$CNTRL DCB;                        /* :CNTRL FILE DCB                    */
      726    16022    1   DCL M$TP DCB;                           /* TP_CNTRL_D FILE DCB                */
      727    16023    1   DCL M$HEAD DCB;                         /* USED TO READ HEAD RECORD FOR RU PARAMS */
      728    16024        /**/
      729    16025        /*****************************************************************/
      730    16026        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      731    16027        /*****************************************************************/
      732    16028        /**/
      733    16029    1   DCL PCN_CMDS UBIN WORD SYMREF;
      734    16030        %P$PCB (NAME=P_PCB,STCLASS="BASED(P_PCB$)");
      735    16231    1   DCL B$JIT$ PTR SYMREF;
      736    16232    1   DCL B$DS5$ PTR SYMREF;
      737    16233    1   DCL B$TCB$ PTR SYMREF;
      738    16234    1   DCL 1 SUB_BUF_1 SYMREF,
      739    16235    1         2 COUNT UBIN(9) UNAL,
      740    16236    1         2 TEXT CHAR(31) UNAL;
      741    16237    1   DCL 1 SUB_BUF_2 SYMREF,
      742    16238    1         2 COUNT UBIN(9) UNAL,
      743    16239    1         2 TEXT CHAR(31) UNAL;
      744    16240    1   DCL 1 SUB_BUF_3 SYMREF,
      745    16241    1         2 COUNT UBIN(9) UNAL,
      746    16242    1         2 TEXT CHAR(31) UNAL;
      747    16243    1   DCL 1 ERR_CODE SYMREF,
      748    16244    1         2 FCG_MID BIT(18) UNAL,
      749    16245    1         2 MON BIT(1) UNAL,
      750    16246    1         2 ERR# UBIN(14) UNAL,
      751    16247    1         2 SEV UBIN(3) UNAL;
      752    16248        /**/
      753    16249        /*****************************************************************************/
      754    16250        /*   MONITOR SYMREFS   MONITOR SYMREFS   MONITOR SYMREFS   MONITOR SYMREFS   */
      755    16251        /*****************************************************************************/
      756    16252        /**/
      757    16253        %INCLUDE JM_CNTRLD_R;
      758    16262        %INCLUDE SS_CNTRLD_R;
      759    16271        /**/
      760    16272        %INCLUDE SS_CNTRL_R;
      761    16282        %INCLUDE FM_CNTRL_R;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:23   
      762    16291        %INCLUDE FR_CNTRL_R;                    /* CONTAINS FR_CNTRLD_D REFS ALSO     */
      763    16302        %INCLUDE FR_CNTRLD_R;
      764    16314        %INCLUDE FT_CNTRL_R;
      765    16403        %INCLUDE JS_CNTRL_R;
      766    16437        %INCLUDE FO_CNTRL_R;
      767    16462        %INCLUDE ES_CNTRL_R;
      768    16474        /**/
      769    16475        %INCLUDE JM_CNTRL_R;
      770    17364        %INCLUDE JZ_CNTRL_R;
      771    17373        %INCLUDE MM_CNTRL_R;
      772    17383        %INCLUDE B$TABLES_C;
      773    17491        /**/
      774    17492        %INCLUDE UMT_CNTRL_R;
      775    17501        /**/
      776    17502        %INCLUDE UQ_CNTRL_R;
      777    17511        /**/
      778    17512        %INCLUDE IG_CNTRLNR_R;
      779    17521    1   DCL B_MUAIS UBIN WORD SYMREF;           /* MAXU                               */
      780    17522    1   DCL B_CNTRL_HIGH UBIN WORD SYMREF;      /* BUFFER LIMITS                      */
      781    17523    1   DCL B_CNTRL_LOW UBIN WORD SYMREF;
      782    17524        /**/
      783    17525        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:24   
      784    17526        /********************************************************************/
      785    17527        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
      786    17528        /********************************************************************/
      787    17529        /**/
      788    17530        %B$XL_UPPER;
      789    17534        %FPT_TIME (FPTN=CUR_UTS,
      790    17535                SOURCE=CLOCK,
      791    17536                TSTAMP=CURUTS,
      792    17537                DEST=UTS);
      793    17556        /**/
      794    17557        %FPT_READ ( FPTN = READ_CMD_FPT,
      795    17558                    BUF = CMD_BUF,
      796    17559                    DCB = M$SI);
      797    17598        /**/
      798    17599        %FPT_WRITE    (FPTN = ECHO_FPT,
      799    17600                       BUF = CMD_BUF,
      800    17601                       DCB = M$LO);
      801    17632        /**/
      802    17633        %FPT_GDS ( FPTN = GDS_FPT,
      803    17634                   RESULTS = DS_RESULTS,
      804    17635                   SEGSIZE = 2048);
      805    17651        /**/
      806    17652        %FPT_SAD    (FPTN = ACCESS_FPT,
      807    17653                     USERSID = %SPCL1SID,
      808    17654                     MONSID = %ISSID);
      809    17669        /**/
      810    17670        %FPT_INT (FPTN = BREAK_FPT,
      811    17671                  UENTRY = PCB$BREAK);
      812    17685        /**/
      813    17686        %FPT_INT (FPTN = BREAKSET_FPT,
      814    17687                  UENTRY = PCB$BREAKSET);
      815    17701        /**/
      816    17702        %FPT_PRIV  (FPTN=PRIV_FPT,
      817    17703                    PRIV = %PPR_CNTRLC#,
      818    17704                    PPRIV = YES);
      819    17719        /**/
      820    17720        %FPT_WAIT (UNITS=1);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:25   
      821    17734        /**/
      822    17735        %FPT_OPEN     (FPTN=OPEN_CNTRL_FPT,
      823    17736                       DCB = M$CNTRL,
      824    17737                       NAME = CNTRL_FILE,
      825    17738                       ACCT = SYSACCT,
      826    17739                       ASN = FILE,
      827    17740                       FUN = UPDATE,
      828    17741                       DISP=NAMED);
      829    17850        /**/
      830    17851        %FPT_OPEN  (FPTN = OPEN_CONTROL_S,
      831    17852                    DCB = M$SI,
      832    17853                    NAME = CNTRLCMD_FILE,
      833    17854                    ACCT = SYSACCT,
      834    17855                    ASN = FILE,
      835    17856                    FUN = IN);
      836    17965        %FPT_OPEN (FPTN=OPEN_TP_CNTRL,
      837    17966                   DCB=M$TP,
      838    17967                   FUN=UPDATE,
      839    17968                   ORG=RANDOM,
      840    17969                   ACS=DS5,
      841    17970                   ASN=FILE,
      842    17971                   EXIST=OLDFILE,
      843    17972                   SHARE=ALL,
      844    17973                   CTG=YES,
      845    17974                   ACCESS=ACSLIST,
      846    17975                   ACSVEH=VEHLIST,
      847    17976                   ACCT=SYSACCT,
      848    17977                   NAME=TP_CNTRL_D);
      849    18086        %VLP_NAME (FPTN=TP_CNTRL_D,
      850    18087                   NAME='TP_CNTRL_D');
      851    18114        %VLP_ATTR (FPTN=ACSLIST);
      852    18128        %VLP_ACCESS (EXEC=YES,ACCT='?',LAST=";");
      853    18145        %VLP_ATTR (FPTN=VEHLIST);
      854    18159        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='CONTROL');
      855    18176        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='TPA');
      856    18193        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='TPCP');
      857    18210        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='SLUG');
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:26   
      858    18227        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='STATS',LAST=";");
      859    18244        %FPT_CLOSE (FPTN=CLOSE_TP_FILE,
      860    18245                    DCB=M$TP,
      861    18246                    DISP=SAVE);
      862    18288        %FPT_EXTEND (FPTN=EXTEND_TP_FILE,
      863    18289                     DCB=M$TP,
      864    18290                     SIZ=1);
      865    18304        /**/
      866    18305        %FPT_WRITE    (FPTN = WRITE_CNTRL_FPT,
      867    18306                       DCB = M$CNTRL,
      868    18307                       KEY = CNTRL_KEY);
      869    18338        /**/
      870    18339        %FPT_CLOSE    (FPTN = CLOSE_CNTRL_FPT,
      871    18340                       DCB = M$CNTRL,
      872    18341                       DISP = SAVE);
      873    18383        /**/
      874    18384        %FPT_CLOSE    (FPTN = CLOSE_LO_FPT,
      875    18385                       DCB = M$LO,
      876    18386                       DISP = SAVE);
      877    18428        /**/
      878    18429        %VLP_NAME     (FPTN = CNTRL_FILE,
      879    18430                       NAME = ':CNTRL',
      880    18431                       LEN = 6);
      881    18458        /**/
      882    18459        %VLP_NAME  (FPTN = CNTRLCMD_FILE,
      883    18460                    NAME = 'CONTROL_S',
      884    18461                    LEN = 9);
      885    18488        %VLP_ACCT     (FPTN = SYSACCT,
      886    18489                       ACCT = ':SYS');
      887    18502        %FPT_FID (FPTN=HEAD_FID,
      888    18503                  ACCT=FID_ACCT,
      889    18504                  ASN=OPEN_RU.V.ASN#,
      890    18505                  NAME=FID_NAME,
      891    18506                  PASS=FID_PASS,
      892    18507                  RES=OPEN_RU.V.RES#,
      893    18508                  SN=FID_SN,
      894    18509                  RESULTS=FID_RESULTS,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:27   
      895    18510                  WSN=FID_WSN);
      896    18533        %FPT_OPEN (FPTN=OPEN_RU,
      897    18534                   DCB=M$HEAD,
      898    18535                   FUN=UPDATE,
      899    18536                   SHARE=ALL,
      900    18537                   ORG=KEYED,
      901    18538                   ACCT=FID_ACCT,
      902    18539                   NAME=FID_NAME,
      903    18540                   PASS=FID_PASS,
      904    18541                   SN=FID_SN,
      905    18542                   WSN=FID_WSN);
      906    18651        %VLR_FID (FPTN=FID_RESULTS);
      907    18670        %VLP_NAME (FPTN=FID_NAME,LEN=31);
      908    18697        %VLP_ACCT (FPTN=FID_ACCT);
      909    18710        %VLP_PASS (FPTN=FID_PASS);
      910    18723        %VLP_WSN (FPTN=FID_WSN);
      911    18736        %VLP_SN (FPTN=FID_SN);
      912    18749        %FPT_READ (FPTN=READ_HEAD,
      913    18750                   DCB=M$HEAD,
      914    18751                   BUF=B$HEAD,
      915    18752                   KEYS=YES,
      916    18753                   KEY=HEADKEY);
      917    18792        %FPT_WRITE (FPTN=WRITE_HEAD,
      918    18793                    DCB=M$HEAD,
      919    18794                    BUF=B$HEAD,
      920    18795                    KEY=HEADKEY);
      921    18826        %FPT_TRAP (ERRORS=PCB$TRAP,MEMORY=TRAP,MISSING_PAGE=TRAP,SECURITY_1=TRAP,SECURITY_2=
             18826            TRAP,
      922    18827              MISSING_SEG=TRAP,LOCKUP=TRAP,COMMAND=TRAP,IPR=TRAP,HARDWARE=ABORT);
      923    18850        %FPT_CLOSE (FPTN=CLOSE_RU,
      924    18851                    DCB=M$HEAD,
      925    18852                    DISP=SAVE);
      926    18894        %FPT_PRIV (FPTN=FMS_PRIV,
      927    18895                   PRIV=%PR_FMSEC#);
      928    18910        %FPT_MONINFO (SITEINFO=VLR_SITEINFO);
      929    18925        %VLR_SITEINFO;
      930    18944        %FPT_EXIT(  FPTN=BYE_BYE, STCLASS="STATIC SYMDEF");
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:28   
      931    18959        /**/
      932    18960        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:29   
      933    18961        /*****************************************************************************/
      934    18962        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      935    18963        /*****************************************************************************/
      936    18964        /**/
      937    18965    1           PC_REASON=0;
      938    18966    2           IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;
      939    18967    2              CALL M$RPRIV(FMS_PRIV) ALTRET(NEXT);
      940    18968    2        NEXT:;
      941    18969    2              END;  /* IF */
      942    18970    1           M$SI$ = DCBADDR(DCBNUM(M$SI));
      943    18971        /**/
      944    18972    1           IF (PC$JIT$ -> B$JIT.MODE = %M_GHOST#)AND
      945    18973    1              (PC$JIT$ -> B$JIT.CCBUF = 'CONTROL CONTROL_S') /* SYSTEM GHOST     */
      946    18974    1              THEN
      947    18975    1              CALL M$OPEN(OPEN_CONTROL_S) ALTRET (CONTROL_S_ERR);
      948    18976        /**/
      949    18977    1           CALL M$SPRIV(PRIV_FPT) ALTRET(TRY_DISP);
      950    18978    1           IF (NO) THEN
      951    18979    2   TRY_DISP: DO;
      952    18980    2              PRIV_FPT.V.PRIV# = %PPR_CNTRLD#;
      953    18981    2              CALL M$SPRIV(PRIV_FPT)
      954    18982    3                  WHENALTRETURN DO;
      955    18983    3                     IF NOT (B$JIT.PRIV.AUTH & %(PR_SPCLMM#|PR_EXMM#)) THEN GOTO
             18983                              NO_ACCESS;
      956    18984    3                     END;
      957    18985    2              SETAUTH = NO;
      958    18986    2              END;
      959    18987    1           CALL INDEX(I,'XXX',TEXT_CONTROLHERE);
      960    18988    1            CALL CONCAT(TEXT_CONTROLHERE,'CONTROL ',SUBSTR(ADDR(B_VERSION)->B$VERSIONB.
             18988                     T_,
      961    18989    1                        0,ADDR(B_VERSION)->B$VERSIONB.C_),' here');
      962    18990    1           CALL PCW$WRITE(TEXT_CONTROLHERE,SIZEC(TEXT_CONTROLHERE));
      963    18991        /**/
      964    18992    1           CALL M$INT(BREAK_FPT);
      965    18993    1           CALL M$TRAP (FPT_TRAP);
      966    18994    1           REMEMBER CMD_READ IN REMEM_CMD_READ;
      967    18995        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:30   
      968    18996    1           MONPART$ = ADDR(JM_PT);
      969    18997    1           MONPARTPTR.SEGID = BITBIN(%SPCL1SID); /* PTR TO PART TABLES            */
      970    18998        /**/
      971    18999    1           CALL M$SAD (ACCESS_FPT) ALTRET (NO_ACCESS);
      972    19000        /**/
      973    19001    1           MONPTR$ = ADDR(B_CNTRL_LOW);
      974    19002    1           MONPTR.SEGID = BITBIN(%SPCL1SID);
      975    19003    1           WRITE_CNTRL_FPT.BUF_.BUF$ = MONPTR$; /* SET BUFFER ADDRESS AND SIZE   */
      976    19004    1           MONPTR$ = ADDR(B_CNTRL_HIGH);
      977    19005    1           MONPTR.SEGID = BITBIN(%SPCL1SID);
      978    19006    1           WRITE_CNTRL_FPT.BUF_.BOUND = POFFC(MONPTR$,WRITE_CNTRL_FPT.BUF_.BUF$)-1;
      979    19007        /**/
      980    19008    1           MONPTR$ = ADDR(FR_SUMX);
      981    19009    1           MONPTR.SEGID = BITBIN(%SPCL1SID);
      982    19010    1           NUM_PSURES = MONPTR$ -> B$TABLE(0) + 1; /* NUMBER OF PSEUDO RESOURCES */
      983    19011        /**/
      984    19012    1           MONPTR$ = ADDR(FR_SUNM);
      985    19013    1           MONPTR.SEGID = BITBIN(%SPCL1SID);
      986    19014    2           IF (NUM_PSURES ~= 0) THEN DO I = 0 TO NUM_PSURES-1;
      987    19015    2              PSURES_TEXT(I) = MONPTR$ -> PSURES$TEXT(I);
      988    19016    2              END;
      989    19017        /**/
      990    19018    1           P_PCB$ = ADDR(NIL);
      991    19019    1           CALL XUR$INIT(XUR_INIT,P_PCB$);
      992    19020    1           DS_RESULTS = NO;
      993    19021    1           CALL M$GDS(GDS_FPT) ALTRET (GDS_ERR);
      994    19022    1           P_PCB.WORK$ = DS_RESULTS.PTR$;
      995    19023    1           CALL XUG$INIT(XUG_GETCMD,XUG_INIT);
      996    19024        /**/
      997    19025        /* For fast machines, we need to update max,min values some  */
      998    19026    1         CALL M$MONINFO (FPT_MONINFO) ALTRET (SKIP_IT);
      999    19027    1         IF VLR_SITEINFO.CPU_TYPE# = %DPS90 OR
     1000    19028    1            VLR_SITEINFO.CPU_TYPE# = %DPS90XA
     1001    19029    2         THEN DO;
     1002    19030    2            SYSTEM_TBL.QMIN.MIN = 2;
     1003    19031    2            SYSTEM_TBL.QUAN.MIN = 2;
     1004    19032    2            END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:31   
     1005    19033    1         IF VLR_SITEINFO.CPU_TYPE# = %DPS8000
     1006    19034    2         THEN DO;
     1007    19035    2            SYSTEM_TBL.QMIN.MIN = 10;
     1008    19036    2            SYSTEM_TBL.QUAN.MIN = 10;
     1009    19037    2            END;
     1010    19038    1           PC_REASON=%PC_TP_CNTRL_D;
     1011    19039    1           MAXTPU_TBL = '0'B;
     1012    19040    1           CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(CMD_READ);
     1013    19041    1           HDR$ = B$DS5$;
     1014    19042    1           TBLINSTANCES = PC$HDR.CURINSTANCES;
     1015    19043    1           CUR_SIZE_OF_DATA = SIZEW(PC$HDR) + TBLINSTANCES * SIZEW(PC$INSTANCE);
     1016    19044    1           CUR_SIZE_OF_FILE = DCBADDR(DCBNUM(M$TP))->F$DCB.NRECS# * %WORDS_PER_GRAN;
     1017    19045    1           WORDS_AVAIL = CUR_SIZE_OF_FILE - CUR_SIZE_OF_DATA;
     1018    19046    1           CURINSTANCES = 0;
     1019    19047    1           INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     1020    19048    2           DO I = 0 TO TBLINSTANCES - 1;
     1021    19049    2              MAXTPU_TBL.NAME(I) = PC$INSTANCE.INSTANCE_NAME;
     1022    19050    2              K = 0;
     1023    19051    3              DO WHILE(SUBSTR(MAXTPU_TBL.NAME(I),K,1) ~= ' ' AND K < 8);
     1024    19052    3                 K = K + 1;
     1025    19053    3                 END;  /* DO K */
     1026    19054    2              MAXTPU_TBL.FLAGS.DELETED(I) = PC$INSTANCE.FLAGS.DELETED;
     1027    19055    2              IF NOT PC$INSTANCE.FLAGS.DELETED
     1028    19056    2                 THEN CURINSTANCES = CURINSTANCES + 1;
     1029    19057    2              MAXTPU_TBL.COUNT(I) = K;
     1030    19058    2              MAXTPU_TBL.MAXTPU(I) = PC$INSTANCE.MAXTPU;
     1031    19059    2              TPHDR_TBL.FLAGS.PRESENT(I) =  PC$INSTANCE.FLAGS.HEADER;
     1032    19060    2              IF (TPHDR_TBL.FLAGS.PRESENT(I)) THEN
     1033    19061    2                 TPHDR_TBL.HDR(I) = PC$INSTANCE.HDR;
     1034    19062    2              INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     1035    19063    2              END;  /* DO I */
     1036    19064    1           CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(CMD_READ);
     1037    19065    1           PC_REASON=0;
     1038    19066    1   SKIP_IT:;
     1039    19067        /**/
     1040    19068    1   CMD_READ:
     1041    19069    1           CALL XUR$GETCMD(PCN_CMDS,P_PCB.OUT$,VECTOR(DASH)) ALTRET(PARSE_ERR);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:32   
     1042    19070        /**/
     1043    19071    2           DO CASE (P_PCB.OUT$ -> O$BLK.CODE);
     1044    19072    2            CASE (%PC_ADD);
     1045    19073    2              CALL EXEC_ADD ALTRET(CMD_READ);
     1046    19074    2            CASE (%PC_DROP);
     1047    19075    2              CALL EXEC_DROP ALTRET(CMD_READ);
     1048    19076    2            CASE (%PC_LIST);
     1049    19077    2              CALL EXEC_LIST ALTRET(CMD_READ);
     1050    19078    2            CASE (%PC_DISPLAY);
     1051    19079    2              CALL EXEC_DISPLAY ALTRET(CMD_READ);
     1052    19080    2            CASE (%PC_SET);
     1053    19081    2              CALL EXEC_SET ALTRET(CMD_READ);
     1054    19082    2            CASE (%PC_DELETE);
     1055    19083    2              CALL EXEC_DELETE;
     1056    19084    2            CASE (%PC_STORE);
     1057    19085    2              CALL EXEC_STORE ALTRET(CMD_READ);
     1058    19086    2            CASE (%PC_CLEAR);
     1059    19087    2              CALL EXEC_CLEAR ALTRET(CMD_READ);
     1060    19088    2            CASE (%PC_END);
     1061    19089    2   END_LBL:   CALL M$CLOSE (CLOSE_LO_FPT);
     1062    19090    2              CALL M$EXIT( BYE_BYE);
     1063    19091    2            CASE (%PC_NULL);
     1064    19092                      /* DO NOTHING */
     1065    19093    2            END;
     1066    19094    1           GOTO CMD_READ;
     1067    19095        /**/
     1068    19096    1   GDS_ERR:
     1069    19097    1           CALL PCE$ERROR (%E$P_NOMEMORY,3);
     1070    19098    1           CALL M$EXIT( BYE_BYE);
     1071    19099        /**/
     1072    19100        /*E*     ERROR:    PCC-E$P_NOMEMORY-0
     1073    19101                 MESSAGE: Unable to get memory for parse work area - CONTROL exitting
     1074    19102                 DESCRIPTION: CANT GET X$PARSE WORK AREA DATA SEGMENT - GIVE UP */
     1075    19103        /**/
     1076    19104    1   PARSE_ERR:
     1077    19105    1           CALL XUR$ERRMSG (P_PCB.OUT$);
     1078    19106    1           CALL M$EXIT( BYE_BYE);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:33   
     1079    19107        /**/
     1080    19108        /*E*     ERROR:    PCC-E$P_PARSEERR-0
     1081    19109                 MESSAGE:  Syntax error
     1082    19110                 DESCRIPTION: SYNTAX ERROR               */
     1083    19111        /**/
     1084    19112    1   NO_ACCESS:
     1085    19113    1           CALL PCE$ERROR(%E$P_NOACCESS,4);
     1086    19114    1           CALL M$EXIT( BYE_BYE);
     1087    19115        /**/
     1088    19116        /*E*     ERROR:    PCC-E$P_NOACCESS-0
     1089    19117                 MESSAGE:  You dont have the privilege necessary to use CONTROL
     1090    19118                 DESCRIPTION: UNDERPRIVILEGED USER - GIVE UP       */
     1091    19119    1   CONTROL_S_ERR:
     1092    19120    1           CALL PCE$ERROR(%E$P_NOCMDFILE,4);
     1093    19121    1           CALL M$EXIT( BYE_BYE);
     1094    19122        /**/
     1095    19123        /*E*    ERROR:  PCC-E$P_NOCMDFILE-0
     1096    19124                MESSAGE: Cannot open CONTROL command file - CONTROL_S.:SYS
     1097    19125                DESCRIPTION: NO COMMAND FILE    */
     1098    19126        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:34   
     1099    19127        /**/
     1100    19128    1   READ_CMD: PROC ALTRET;
     1101    19129        /**/
     1102    19130    2   REREAD:
     1103    19131        /**/
     1104    19132    2           CMD_BUF = ' ';
     1105    19133    2           CALL M$READ (READ_CMD_FPT) ALTRET (READ_ERR);
     1106    19134        /**/
     1107    19135    2           P_PCB.NCHARS = M$SI$ -> F$DCB.ARS#;
     1108    19136        /**/
     1109    19137    2           IF (CMD_BUF = ' ') THEN GOTO REREAD;
     1110    19138        /**/
     1111    19139    2           IF ((PC$JIT$ -> B$JIT.MODE = %M_BATCH#)OR
     1112    19140    2             ((PC$JIT$ -> B$JIT.CPFLAGS1 & %CP_ECHO#)AND
     1113    19141    2             (M$SI$ -> F$DCB.DDEV.XEQ#))OR
     1114    19142    2             ((PC$JIT$ -> B$JIT.MODE = %M_GHOST#)AND
     1115    19143    3             (DCBADDR(DCBNUM(M$UC)) -> F$DCB.ASN# = %DEVICE#))) THEN DO;
     1116    19144    3              ECHO_FPT.BUF_.BOUND = P_PCB.NCHARS-1;
     1117    19145    3              CALL M$WRITE(ECHO_FPT);
     1118    19146    3              END;
     1119    19147    2           RETURN;
     1120    19148        /**/
     1121    19149    2   READ_ERR:
     1122    19150    2           CALL PCE$ERROR(0,3);
     1123    19151    2           CALL M$EXIT( BYE_BYE);
     1124    19152    2   END;
     1125    19153        /**/
     1126    19154        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:35   
     1127    19155        /**/
     1128    19156    1   EXEC_ADD: PROC ALTRET;
     1129    19157        /**/
     1130    19158    2           BITVAL = YES;
     1131    19159    2           GOTO START_CMD;
     1132    19160        /**/
     1133    19161    2   EXEC_DROP: ENTRY ALTRET;
     1134    19162        /**/
     1135    19163    2           BITVAL = NO;
     1136    19164        /**/
     1137    19165    2   START_CMD:
     1138    19166    3           IF (P_PCB.OUT$ -> O$BLK.NSUBLKS = 1) THEN DO; /* ALL BY DEFAULT       */
     1139    19167    3              P_PCB.OUT$ -> O$BLK.NSUBLKS = 2;
     1140    19168    3              P_PCB.OUT$ -> O$BLK.SUBLK$(1) = PINCRW(P_PCB.OUT$,10);
     1141    19169    3              P_PCB.OUT$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE = %PC_ALL;
     1142    19170    3              END;
     1143    19171        /**/
     1144    19172    3           DO I = 1 TO P_PCB.OUT$ -> O$BLK.NSUBLKS - 1;
     1145    19173    3              BLK$ = P_PCB.OUT$ -> O$BLK.SUBLK$(I);
     1146    19174        /**/
     1147    19175    4              DO CASE (BLK$ -> O$BLK.CODE);
     1148    19176        /**/
     1149    19177    4               CASE (%PC_ALL);
     1150    19178    5                 DO J = 1 TO %PC_MAXMODE;
     1151    19179    5                    INDEX_FLGS.MODE(J) = BITVAL;
     1152    19180    5                    END;
     1153    19181        /**/
     1154    19182    5                 DO J = 0 TO 15;
     1155    19183    5                    INDEX_FLGS.PART#(J) = BITVAL;
     1156    19184    5                    END;
     1157    19185        /**/
     1158    19186    5                 DO J = 0 TO %PC_MAXDOMAIN;
     1159    19187    5                    INDEX_FLGS.DOMAINE(J) = BITVAL;
     1160    19188    5                    END;
     1161    19189        /**/
     1162    19190    5                 DO J = 1 TO %PC_MAXCATAGORY;
     1163    19191    5                    IF J = %PC_TP AND BITVAL = YES /* DONT SET TP CAT ON ADD ALL */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:36   
     1164    19192    5                       THEN J = J + 1;
     1165    19193    5                    CAT$ -> CAT$TBL.FLAGS.PRINT(J) = BITVAL;
     1166    19194    6                    DO K = 1 TO CAT$ -> CAT$TBL.MAXPARAM(J);
     1167    19195    6                       IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.FLAGS.RES(K))
     1168    19196    7                       THEN DO RES_INDX = 0 TO NUM_PSURES + %PSURES_OFFSET-1;
     1169    19197    7                          CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.RESPTR$(K) ->
     1170    19198    7                            RES$FLGS(RES_INDX) = BITVAL;
     1171    19199    7                          END;
     1172    19200        /**/
     1173    19201    6                       ELSE CAT$ -> CAT$TBL.PARAM$(J) ->
     1174    19202    6                            P$TBL.FLAGS.PRINT(K) = BITVAL;
     1175    19203    6                       END;
     1176    19204    6                    IF J = %PC_TP THEN DO;
     1177    19205    6                       IF BITVAL = YES
     1178    19206    6                          THEN TP_TBL.MAXTPU.MAX = CURINSTANCES;
     1179    19207    6                          ELSE TP_TBL.MAXTPU.MAX = 0;
     1180    19208    7                       DO K = 0 TO CURINSTANCES - 1;
     1181    19209    7                          MAXTPU_TBL.FLAGS.PRINT(K) = BITVAL;
     1182    19210    7                          END;  /* DO K */
     1183    19211    6                       END;  /* IF J = %PC_TP */
     1184    19212    5                    END;
     1185    19213        /**/
     1186    19214    4               CASE (%PC_MODE);
     1187    19215    4                 INDEX_FLGS.MODE(BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE)
     1188    19216    4                   = BITVAL;
     1189    19217        /**/
     1190    19218    4               CASE (%PC_PART#);
     1191    19219    4                 TEMP$ = BLK$ -> O$BLK.SUBLK$(0);
     1192    19220    5                 DO J = 0 TO TEMP$ -> O$BLK.NSUBLKS - 1;
     1193    19221    5                    PART#$ = TEMP$ -> O$BLK.SUBLK$(J);
     1194    19222        /**/
     1195    19223    6                    IF (PART#$ -> O$BLK.CODE = %PC_ALLOPT) THEN DO;
     1196    19224    6                       TEMP1 = 0;
     1197    19225    6                       TEMP2 = 15;
     1198    19226    6                       END;
     1199    19227        /**/
     1200    19228    6                    ELSE DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:37   
     1201    19229    6                       TEMP1 = PART#$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1202    19230        /**/
     1203    19231    6                       IF (PART#$ -> O$BLK.NSUBLKS = 1) THEN TEMP2 = TEMP1;
     1204    19232    7                       ELSE DO;
     1205    19233        /**/
     1206    19234    7                          TEMP2 = PART#$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;
     1207    19235        /**/
     1208    19236    8                          IF (TEMP1 > TEMP2) THEN DO;
     1209    19237    8                             CALL PCE$ERROR (%E$P_P#RANGE,2);
     1210    19238    8                             ALTRETURN;
     1211    19239    8                             END;
     1212    19240        /**/
     1213    19241        /*E*     ERROR:    PCC-E$P_P#RANGE-0
     1214    19242                 MESSAGE:  Illegal partition number range lo>hi
     1215    19243                 DESCRIPTION: BAD PART# RANGE - LO > HI  */
     1216    19244        /**/
     1217    19245    7                          END;
     1218    19246    6                       END;
     1219    19247        /**/
     1220    19248    6                    DO K = TEMP1 TO TEMP2;
     1221    19249    6                       INDEX_FLGS.PART#(K) = BITVAL;
     1222    19250    6                       END;
     1223    19251    5                    END;
     1224    19252        /**/
     1225    19253    4               CASE (%PC_DOMAIN);
     1226    19254    4                 INDEX_FLGS.DOMAINE(BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE)
     1227    19255    4                   = BITVAL;
     1228    19256        /**/
     1229    19257    4               CASE (%PC_CATAGORY);
     1230    19258    4                 J = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1231    19259    4                 CAT$ -> CAT$TBL.FLAGS.PRINT(J) = BITVAL;
     1232    19260    5                 DO K = 1 TO CAT$ -> CAT$TBL.MAXPARAM(J);
     1233    19261    5                    IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.FLAGS.RES(K))
     1234    19262    6                    THEN DO RES_INDX = 0 TO NUM_PSURES + %PSURES_OFFSET-1;
     1235    19263    6                       CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.RESPTR$(K) ->
     1236    19264    6                         RES$FLGS(RES_INDX) = BITVAL;
     1237    19265    6                       END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:38   
     1238    19266        /**/
     1239    19267    5                    ELSE CAT$ -> CAT$TBL.PARAM$(J) ->
     1240    19268    5                         P$TBL.FLAGS.PRINT(K) = BITVAL;
     1241    19269    5                    END;
     1242    19270    5                 IF J = %PC_TP THEN DO;
     1243    19271    5                    IF BITVAL = YES
     1244    19272    5                       THEN TP_TBL.MAXTPU.MAX = CURINSTANCES;
     1245    19273    5                       ELSE TP_TBL.MAXTPU.MAX = 0;
     1246    19274    6                    DO K = 0 TO CURINSTANCES - 1;
     1247    19275    6                       MAXTPU_TBL.FLAGS.PRINT(K) = BITVAL;
     1248    19276    6                       END;  /* DO K */
     1249    19277    5                    IF BITVAL = YES
     1250    19278    5                       THEN TP_TBL.TPHDR.MAX = CURINSTANCES;
     1251    19279    5                       ELSE TP_TBL.TPHDR.MAX = 0;
     1252    19280    6                    DO K = 0 TO CURINSTANCES - 1;
     1253    19281    6                       TPHDR_TBL.FLAGS.PRINT(K) = BITVAL;
     1254    19282    6                       END;  /* DO K */
     1255    19283    5                    END;  /* IF J = %PC_TP */
     1256    19284        /**/
     1257    19285    4               CASE (%PC_PARAM);
     1258    19286    4                 TEMP1 = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE; /* CATAGORY TYPE   */
     1259    19287    4                 TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);
     1260    19288    5                 IF TEMP1 = %PC_TP AND TEMP$->O$BLK.CODE = %PC_MAXTPU THEN DO;
     1261    19289    6                    IF TEMP$->O$BLK.NSUBLKS = 0 THEN DO;  /* NO INSTANCE SPEC */
     1262    19290    6                       TP_TBL.MAXTPU.FLAGS.PRINT = BITVAL;
     1263    19291    7                       DO J = 0 TO TBLINSTANCES - 1;
     1264    19292    7                          MAXTPU_TBL.FLAGS.PRINT(J) = BITVAL;
     1265    19293    7                          END;  /* DO J */
     1266    19294    6                       IF BITVAL = YES
     1267    19295    6                          THEN TP_TBL.MAXTPU.MAX = CURINSTANCES;
     1268    19296    6                          ELSE TP_TBL.MAXTPU.MAX = 0;
     1269    19297    6                       END;  /* IF NO INSTANCE */
     1270    19298    6                    ELSE DO;   /* INSTANCE NAME(S) SPECIFIED */
     1271    19299    6                       TEMP1$ = TEMP$->O$BLK.SUBLK$(0);
     1272    19300    7                       DO J = 0 TO TEMP1$->O$BLK.NSUBLKS - 1;
     1273    19301    7                          INSTANCE_NAME = TEMP1$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;
     1274    19302    7                          FOUND = NO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:39   
     1275    19303    8                          DO K = 0 TO TBLINSTANCES - 1;
     1276    19304    8                             IF INSTANCE_NAME = MAXTPU_TBL.NAME(K) AND
     1277    19305    9                                NOT MAXTPU_TBL.FLAGS.DELETED(K) THEN DO;
     1278    19306    9                                MAXTPU_TBL.FLAGS.PRINT(K) = BITVAL;
     1279    19307    9                                FOUND = YES;
     1280    19308   10                                IF BITVAL = NO THEN DO;
     1281    19309   10                                   TP_TBL.MAXTPU.FLAGS.PRINT = NO;
     1282    19310   10                                   IF TP_TBL.MAXTPU.MAX ~= 0
     1283    19311   10                                      THEN TP_TBL.MAXTPU.MAX = TP_TBL.MAXTPU.MAX - 1;
     1284    19312   10                                   END;  /* IF BITVAL = NO */
     1285    19313   10                                ELSE DO;
     1286    19314   10                                   IF TP_TBL.MAXTPU.MAX ~= CURINSTANCES
     1287    19315   10                                      THEN TP_TBL.MAXTPU.MAX = TP_TBL.MAXTPU.MAX + 1;
     1288    19316   10                                   IF TP_TBL.MAXTPU.MAX = CURINSTANCES
     1289    19317   10                                      THEN TP_TBL.MAXTPU.FLAGS.PRINT = YES;
     1290    19318   10                                   END;  /* ELSE */
     1291    19319    9                                END;  /* IF FOUND */
     1292    19320    8                             END;  /* DO K */
     1293    19321    8                          IF NOT FOUND THEN DO;
     1294    19322    8                             K = 0;
     1295    19323    9                             DO WHILE(SUBSTR(INSTANCE_NAME,K,1) ~= ' ' AND K < 8);
     1296    19324    9                                K = K + 1;
     1297    19325    9                                END;  /* DO WHILE */
     1298    19326    8                             SUB_BUF_1.COUNT = K;
     1299    19327    8                             SUB_BUF_1.TEXT = INSTANCE_NAME;
     1300    19328    8                             CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
     1301    19329    8                             END;  /* IF NOT FOUND */
     1302    19330    7                          END;  /* DO J */
     1303    19331    6                       END;  /* ELSE */
     1304    19332    5                    IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#
     1305    19333    5                       THEN CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(ALT);
     1306    19334    5                    END;  /* IF PC_TP AND PC_MAXTPU */
     1307    19335    5                 ELSE IF TEMP1 = %PC_TP AND TEMP$->O$BLK.CODE = %PC_TPHDR THEN DO;
     1308    19336    6                    IF TEMP$->O$BLK.NSUBLKS = 0 THEN DO;  /* NO INSTANCE SPEC */
     1309    19337    6                       TP_TBL.TPHDR.FLAGS.PRINT = BITVAL;
     1310    19338    7                       DO J = 0 TO TBLINSTANCES - 1;
     1311    19339    7                          TPHDR_TBL.FLAGS.PRINT(J) = BITVAL;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:40   
     1312    19340    7                          END;  /* DO J */
     1313    19341    6                       IF BITVAL = YES
     1314    19342    6                          THEN TP_TBL.TPHDR.MAX = CURINSTANCES;
     1315    19343    6                          ELSE TP_TBL.TPHDR.MAX = 0;
     1316    19344    6                       END;  /* IF NO INSTANCE */
     1317    19345    6                    ELSE DO;   /* INSTANCE NAME(S) SPECIFIED */
     1318    19346    6                       TEMP1$ = TEMP$->O$BLK.SUBLK$(0);
     1319    19347    7                       DO J = 0 TO TEMP1$->O$BLK.NSUBLKS - 1;
     1320    19348    7                          INSTANCE_NAME = TEMP1$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;
     1321    19349    7                          FOUND = NO;
     1322    19350    8                          DO K = 0 TO TBLINSTANCES - 1;
     1323    19351    8                             IF INSTANCE_NAME = MAXTPU_TBL.NAME(K) AND
     1324    19352    9                                NOT MAXTPU_TBL.FLAGS.DELETED(K) THEN DO;
     1325    19353    9                                TPHDR_TBL.FLAGS.PRINT(K) = BITVAL;
     1326    19354    9                                FOUND = YES;
     1327    19355   10                                IF BITVAL = NO THEN DO;
     1328    19356   10                                   TP_TBL.TPHDR.FLAGS.PRINT = NO;
     1329    19357   10                                   IF TP_TBL.TPHDR.MAX ~= 0
     1330    19358   10                                      THEN TP_TBL.TPHDR.MAX = TP_TBL.TPHDR.MAX - 1;
     1331    19359   10                                   END;  /* IF BITVAL = NO */
     1332    19360   10                                ELSE DO;
     1333    19361   10                                   IF TP_TBL.TPHDR.MAX ~= CURINSTANCES
     1334    19362   10                                      THEN TP_TBL.TPHDR.MAX = TP_TBL.TPHDR.MAX + 1;
     1335    19363   10                                   IF TP_TBL.TPHDR.MAX = CURINSTANCES
     1336    19364   10                                      THEN TP_TBL.TPHDR.FLAGS.PRINT = YES;
     1337    19365   10                                   END;  /* ELSE */
     1338    19366    9                                END;  /* IF FOUND */
     1339    19367    8                             END;  /* DO K */
     1340    19368    8                          IF NOT FOUND THEN DO;
     1341    19369    8                             K = 0;
     1342    19370    9                             DO WHILE(SUBSTR(INSTANCE_NAME,K,1) ~= ' ' AND K < 8);
     1343    19371    9                                K = K + 1;
     1344    19372    9                                END;  /* DO WHILE */
     1345    19373    8                             SUB_BUF_1.COUNT = K;
     1346    19374    8                             SUB_BUF_1.TEXT = INSTANCE_NAME;
     1347    19375    8                             CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
     1348    19376    8                             END;  /* IF NOT FOUND */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:41   
     1349    19377    7                          END;  /* DO J */
     1350    19378    6                       END;  /* ELSE */
     1351    19379    5                    IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#
     1352    19380    5                       THEN CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(ALT);
     1353    19381    5                    END;  /* IF PC_TP AND PC_TPHDR */
     1354    19382    5                 ELSE DO;
     1355    19383    5                    TEMP2 = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1356    19384           /**/
     1357    19385    5                    IF (CAT$ -> CAT$TBL.PARAM$(TEMP1) ->
     1358    19386    6                      P$TBL.FLAGS.RES(TEMP2)) THEN DO;
     1359    19387    6                       CALL GET_RES (RES_INDX,BLK$ -> O$BLK.SUBLK$(0) ->
     1360    19388    6                         O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0) -> OUT$SYM)
     1361    19389    6                         ALTRET (BAD_RES);
     1362    19390           /**/
     1363    19391    6                       CAT$ -> CAT$TBL.PARAM$(TEMP1) -> P$TBL.RESPTR$(TEMP2) ->
     1364    19392    6                         RES$FLGS(RES_INDX) = BITVAL;
     1365    19393    6                       END;
     1366    19394           /**/
     1367    19395    5                    ELSE CAT$ -> CAT$TBL.PARAM$(TEMP1) ->
     1368    19396    5                         P$TBL.FLAGS.PRINT(TEMP2) = BITVAL;
     1369    19397    5                    END;  /* ELSE */
     1370    19398    4               END;   /* DO CASE BLK$->O$BLK.CODE */
     1371    19399    3              END;  /* DO I */
     1372    19400    2           RETURN;
     1373    19401        /**/
     1374    19402    2   BAD_RES:
     1375    19403    2           CALL PCE$ERROR(%E$P_BADRES,3);
     1376    19404    2   ALT:
     1377    19405    2           ALTRETURN;
     1378    19406        /**/
     1379    19407        /*E*     ERROR:    PCC-E$P_BADRES-0
     1380    19408                 MESSAGE:  Unknown resource
     1381    19409                 MESSAGE1: The specified resource type doesnt exist
     1382    19410                 DESCRIPTION: THE USER ASKED FOR A RESOURCE THAT DOESNT EXIST */
     1383    19411    2   END EXEC_ADD;
     1384    19412        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:42   
     1385    19413        /**/
     1386    19414    1   EXEC_DISPLAY: PROC ALTRET;
     1387    19415        /**/
     1388    19416    2    DCL CODE  SBIN;
     1389    19417        /**/
     1390    19418    2           IF (P_PCB.OUT$ -> O$BLK.NSUBLKS = 1)AND
     1391    19419    3             (P_PCB.OUT$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %PC_DISPLAY) THEN DO;
     1392    19420    3              CALL PCT$SYSTEM(%PC_PCTFLAGS) ALTRET (DISPLAY_ERR);
     1393    19421    3              CALL PCT$RESOURCE(%PC_PCTFLAGS) ALTRET (DISPLAY_ERR);
     1394    19422    3              CALL PCT$PARTITION(%PC_PCTFLAGS) ALTRET(DISPLAY_ERR);
     1395    19423    3              CALL PCT$EXCEPTION(%PC_PCTFLAGS) ALTRET(DISPLAY_ERR);
     1396    19424    3              CALL PCT$TPCAT(%PC_PCTFLAGS) ALTRET(DISPLAY_ERR);
     1397    19425    3              RETURN;
     1398    19426    3              END;
     1399    19427        /**/
     1400    19428    2           DISP_TBL = NO;                  /* DISPLAY SPECIFIED ITEMS            */
     1401    19429    2           DISP_CAT = NO;
     1402    19430    2           J = 0;                          /* DISP_TBL INDEX                     */
     1403    19431        /**/
     1404    19432    2           IF (P_PCB.OUT$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %PC_DISPLAY) THEN
     1405    19433    2              I = 1;
     1406    19434    2           ELSE I = 0;
     1407    19435    3           DO I = I TO P_PCB.OUT$ -> O$BLK.NSUBLKS - 1;
     1408    19436    3              BLK$ = P_PCB.OUT$ -> O$BLK.SUBLK$(I);
     1409    19437    3              DISP_TBL.PARM.RESINDX(J) = -1; /* INIT NOT THERE                  */
     1410    19438    4              DO CASE (BLK$ -> O$BLK.CODE);
     1411    19439        /**/
     1412    19440    4               CASE (%PC_ALL);              /* DISP ALL ITEMS                     */
     1413    19441    4                 CALL PCT$SYSTEM(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1414    19442    4                 CALL PCT$RESOURCE(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1415    19443    4                 CALL PCT$PARTITION(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1416    19444    4                 CALL PCT$EXCEPTION(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1417    19445    4                 RETURN;
     1418    19446        /**/
     1419    19447    4               CASE (%PC_PART#);
     1420    19448    4                 PART#_FLGS = NO;
     1421    19449        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:43   
     1422    19450    4                 TEMP$ = BLK$ -> O$BLK.SUBLK$(0);
     1423    19451    5                 DO K = 0 TO TEMP$ -> O$BLK.NSUBLKS - 1;
     1424    19452    5                    PART#$ = TEMP$ -> O$BLK.SUBLK$(K);
     1425    19453        /**/
     1426    19454    6                    IF (PART#$ -> O$BLK.CODE = %PC_ALLOPT) THEN DO;
     1427    19455    6                       TEMP1 = 0;
     1428    19456    6                       TEMP2 = 15;
     1429    19457    6                       END;
     1430    19458        /**/
     1431    19459    6                    ELSE DO;
     1432    19460    6                       TEMP1 = PART#$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1433    19461        /**/
     1434    19462    6                       IF (PART#$ -> O$BLK.NSUBLKS = 1) THEN TEMP2 = TEMP1;
     1435    19463    7                       ELSE DO;
     1436    19464        /**/
     1437    19465    7                          TEMP2 = PART#$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;
     1438    19466        /**/
     1439    19467    8                          IF (TEMP1 > TEMP2) THEN DO;
     1440    19468    8                             CALL PCE$ERROR (%E$P_P#RANGE,2);
     1441    19469    8                             ALTRETURN;
     1442    19470    8                             END;
     1443    19471        /**/
     1444    19472    7                          END;
     1445    19473    6                       END;
     1446    19474        /**/
     1447    19475    6                    DO L = TEMP1 TO TEMP2;
     1448    19476    6                       PART#_FLGS(L) = YES;
     1449    19477    6                       END;  /* DO L */
     1450    19478    5                    END;  /* DO J */
     1451    19479        /**/
     1452    19480    4                 CALL PCT$PARTITION (%PC_PCTPART#) ALTRET(DISPLAY_ERR);
     1453    19481        /**/
     1454    19482    4               CASE (%PC_CATAGORY);
     1455    19483    4                 DISP_CAT(BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE) = YES;
     1456    19484    4                 IF BLK$->O$BLK.SUBLK$(0)->O$BLK.CODE = %PC_TP
     1457    19485    4                    THEN CALL PCT$TPCAT(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1458    19486    4              CASE(%PC_TP);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:44   
     1459    19487    5                 DO CASE(BLK$->O$BLK.SUBLK$(0)->O$BLK.CODE);
     1460    19488    5                    CASE(%PC_TPINSTANCE);
     1461    19489    5                       CALL PCT$TPCAT(%PC_DITPI);
     1462    19490    5                    CASE(%PC_MAXTPU);
     1463    19491    5                       IF BLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS = 0
     1464    19492    5                          THEN CALL PCT$TPCAT(%PC_DIMAXTPU);
     1465    19493    6                          ELSE DO;
     1466    19494    6                             TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);
     1467    19495    7                             DO J = 0 TO TEMP$->O$BLK.NSUBLKS - 1;
     1468    19496    7                                TEMPNAME = SUBSTR(TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT,
             19496                                         0,
     1469    19497    7                                           TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.COUNT);
     1470    19498    7                                CALL PCT$TPCAT(%PC_DIMAXTPU,TEMPNAME);
     1471    19499    7                                END;  /* DO J */
     1472    19500    6                             END;  /* ELSE */
     1473    19501    5                    CASE(%PC_TPHDR);
     1474    19502    5                       IF BLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS = 0
     1475    19503    5                          THEN CALL PCT$TPCAT(%PC_DITPHDR);
     1476    19504    6                          ELSE DO;
     1477    19505    6                             TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);
     1478    19506    7                             DO J = 0 TO TEMP$->O$BLK.NSUBLKS - 1;
     1479    19507    7                                TEMPNAME = SUBSTR(TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT,
             19507                                         0,
     1480    19508    7                                           TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.COUNT);
     1481    19509    7                                CALL PCT$TPCAT(%PC_DITPHDR,TEMPNAME);
     1482    19510    7                                END;  /* DO J */
     1483    19511    6                             END;  /* ELSE */
     1484    19512    5                    END;  /* DO CASE CODE */
     1485    19513        /**/
     1486    19514    4               CASE (%PC_PARAM);
     1487    19515    4                 DISP_TBL.PARM.CAT(J) = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1488    19516        /**/
     1489    19517    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);
     1490    19518        /**/
     1491    19519    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND
     1492    19520    5                    (PARAM$ -> O$BLK.CODE = %PC_EXPTIME_ALL)  THEN DO;
     1493    19521    6                    DO CODE = %PC_EXPTIME_LO TO %PC_EXPTIME_HI;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:45   
     1494    19522    6                      DISP_TBL.PARM.PARM(J) = CODE;
     1495    19523    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;
     1496    19524    6                      DISP_TBL.PARM.RESINDX(J) = -1;
     1497    19525    6                      J = J + 1;
     1498    19526    6                    END;  /*do CODE*/
     1499    19527    5                    DISP_TBL.INDX = J;
     1500    19528    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);
     1501    19529    5                    J = -1;   /* re-adjust for incr below */
     1502    19530    5                 END;  /*if*/
     1503    19531    4                 ELSE
     1504    19532    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND
     1505    19533    5                    (PARAM$ -> O$BLK.CODE = %PC_UPDLIMIT_ALL)  THEN DO;
     1506    19534    6                    DO CODE = %PC_UPDLIMIT_LO TO %PC_UPDLIMIT_HI;
     1507    19535    6                      DISP_TBL.PARM.PARM(J) = CODE;
     1508    19536    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;
     1509    19537    6                      DISP_TBL.PARM.RESINDX(J) = -1;
     1510    19538    6                      J = J + 1;
     1511    19539    6                    END;  /*do CODE*/
     1512    19540    5                    DISP_TBL.INDX = J;
     1513    19541    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);
     1514    19542    5                    J = -1;   /* re-adjust for incr below */
     1515    19543    5                 END;  /*if*/
     1516    19544    4                 ELSE
     1517    19545    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND
     1518    19546    5                    (PARAM$ -> O$BLK.CODE = %PC_IOCACHE_ALL)  THEN DO;
     1519    19547    6                    DO CODE = %PC_EXPTIME_LO TO %PC_UPDLIMIT_HI;
     1520    19548    6                      DISP_TBL.PARM.PARM(J) = CODE;
     1521    19549    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;
     1522    19550    6                      DISP_TBL.PARM.RESINDX(J) = -1;
     1523    19551    6                      J = J + 1;
     1524    19552    6                    END;  /*do CODE*/
     1525    19553    5                    DISP_TBL.INDX = J;
     1526    19554    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);
     1527    19555    5                    J = -1;   /* re-adjust for incr below */
     1528    19556    5                 END;  /*if*/
     1529    19557    4                 ELSE
     1530    19558    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:46   
     1531    19559    5                    (PARAM$ -> O$BLK.CODE = %PC_SECURITY_ALL)  THEN DO;
     1532    19560    6                    DO CODE = %PC_SECURITY_LO TO %PC_SECURITY_HI;
     1533    19561    6                      DISP_TBL.PARM.PARM(J) = CODE;
     1534    19562    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;
     1535    19563    6                      DISP_TBL.PARM.RESINDX(J) = -1;
     1536    19564    6                      J = J + 1;
     1537    19565    6                    END;  /*do CODE*/
     1538    19566    5                    DISP_TBL.INDX = J;
     1539    19567    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);
     1540    19568    5                    J = -1;   /* re-adjust for incr below */
     1541    19569    5                 END;  /*if*/
     1542    19570    4                 ELSE
     1543    19571    4                    DISP_TBL.PARM.PARM(J) = PARAM$ -> O$BLK.CODE;
     1544    19572    4                 DISP_TBL.PARM.PARM(J) = PARAM$ -> O$BLK.CODE;
     1545    19573        /**/
     1546    19574    4                 IF (PARAM$ -> O$BLK.NSUBLKS ~= 0)  AND     /* RESOURCE SPECIFIED */
     1547    19575    4                    (PARAM$ -> O$BLK.CODE ~= %PC_EXPTIME_ALL)   AND
     1548    19576    5                    (PARAM$ -> O$BLK.CODE ~= %PC_UPDLIMIT_ALL)  THEN DO;
     1549    19577    5                    CALL GET_RES (RES_INDX,PARAM$ -> O$BLK.SUBLK$(0) -> OUT$SYM)
     1550    19578    5                      ALTRET (BAD_RES);
     1551    19579    5                    DISP_TBL.PARM.RESINDX(J) = RES_INDX;
     1552    19580    5                    END;
     1553    19581        /**/
     1554    19582    4                 IF (BLK$ -> O$BLK.NSUBLKS = 1) THEN /* NOT INDEXED              */
     1555    19583    4                    DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT;
     1556    19584        /**/
     1557    19585    5                 ELSE DO;                  /* INDEX SPECIFIED                    */
     1558    19586    5                    IF ~(CAT$ -> CAT$TBL.PARAM$(DISP_TBL.PARM.CAT(J)) ->
     1559    19587    6                      P$TBL.FLAGS.INDX(DISP_TBL.PARM.PARM(J))) THEN DO;
     1560    19588    6                       CALL PCE$ERROR(%E$P_NOTINDEX,2);
     1561    19589    6                       ALTRETURN;
     1562    19590    6                       END;
     1563    19591        /**/
     1564    19592        /*E*     ERROR:    PCC-E$P_NOTINDEX-0
     1565    19593                 MESSAGE:  Dont try to index an unindexed parameter
     1566    19594                 DESCRIPTION:   USER SPECIFIED AN INDEX ON A PARAMETER WHICH
     1567    19595                                DOESNT HAVE ONE          */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:47   
     1568    19596        /**/
     1569    19597    5                    INDEX$ = BLK$ -> O$BLK.SUBLK$(1);
     1570    19598    6                    DO K = 0 TO INDEX$ -> O$BLK.NSUBLKS - 1; /* DO ALL INDEXES   */
     1571    19599    7                       IF (K ~= 0) THEN DO;
     1572    19600    7                          DISP_TBL.PARM(J+1) = DISP_TBL.PARM(J);
     1573    19601    7                          J = J+1;
     1574    19602    7                          END;
     1575    19603        /**/
     1576    19604    6                       TEMP$ = INDEX$ -> O$BLK.SUBLK$(K);
     1577    19605        /**/
     1578    19606    6                       DISP_TBL.PARM.INDEXLO(J) = TEMP$ -> O$BLK.SUBLK$(0) -> O$BLK.
             19606                                CODE;
     1579    19607    6                       DISP_TBL.PARM.INDEXHI(J) = DISP_TBL.PARM.INDEXLO(J);
     1580    19608        /**/
     1581    19609    7                       IF (TEMP$ -> O$BLK.NSUBLKS ~= 1) THEN DO; /* RANGE SPECIFIED */
     1582    19610    7                          DISP_TBL.PARM.INDEXHI(J) = TEMP$ ->
     1583    19611    7                            O$BLK.SUBLK$(1) -> O$BLK.CODE;
     1584    19612    7                          IF (DISP_TBL.PARM.INDEXHI(J) <
     1585    19613    8                            DISP_TBL.PARM.INDEXLO(J)) THEN DO;
     1586    19614    8                             CALL PCE$ERROR (%E$P_P#RANGE,2);
     1587    19615    8                             RETURN;
     1588    19616    8                             END;
     1589    19617    7                          END;
     1590    19618    6                       END;
     1591    19619    5                    END;
     1592    19620    4                 J = J+1;                  /* NEXT SLOT                          */
     1593    19621    4               CASE(%PC_RU);
     1594    19622    4                 RU_PARAMS = '0'B;
     1595    19623    4                 HEAD_FID.TEXTFID_ = VECTOR(BLK$->O$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1596    19624    4                 CALL M$FID(HEAD_FID) ALTRET(BAD_FID);
     1597    19625    4                 OPEN_RU.V.FUN# = %INPUT#;
     1598    19626    4                 CALL M$OPEN(OPEN_RU) ALTRET(BAD_FILE);
     1599    19627    4                 CALL M$READ(READ_HEAD) ALTRET(BAD_FILE);
     1600    19628    5                 DO J = 1 TO BLK$->O$BLK.NSUBLKS - 1;
     1601    19629    6                    DO CASE(BLK$->O$BLK.SUBLK$(J)->O$BLK.SUBLK$(0)->O$BLK.CODE);
     1602    19630    6                       CASE(%PC_ALLOPT);
     1603    19631    6                          RU_PARAMS = '777777777777'O;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:48   
     1604    19632    6                       CASE(%PC_PSEUD);
     1605    19633    6                          RU_PARAMS(%PC_PSEUD) = YES;
     1606    19634    6                          RU_PARAMS(%PC_PSEUDO_NUM) = YES;
     1607    19635    6                       CASE(ELSE);
     1608    19636    6                          RU_PARAMS(BLK$->O$BLK.SUBLK$(J)->O$BLK.SUBLK$(0)->O$BLK.CODE)
             19636                                   = YES;
     1609    19637    6                       END;  /* CASE */
     1610    19638    5                    END;  /* DO J */
     1611    19639    4                 CALL X$WRITE(FDS,VECTOR(RU_FMT),HEAD_FID.TEXTFID_);
     1612    19640    4                 DCB_WIDTH = DCBADDR(DCBNUM(M$LO))->F$DCB.WIDTH#;
     1613    19641    4                 IF DCB_WIDTH = 0 THEN DCB_WIDTH = 80;
     1614    19642    4                 RUBUF.COUNT = 0;
     1615    19643    4                 RUBUF.TEXT = ' ';
     1616    19644    5                 DO J = 1 TO %PC_NUMRUFLAGS;
     1617    19645    5                    TEMPLEN = 0;
     1618    19646    5                    TEMPBUF = ' ';
     1619    19647    6                    IF RU_PARAMS(J) THEN DO;
     1620    19648    6                       TEMPLEN = TEMPLEN + RUPARAM_TBL.COUNT(J);
     1621    19649    6                       CALL INSERT(TEMPBUF,0,TEMPLEN,RUPARAM_TBL.TEXT(J));
     1622    19650    7                       DO CASE(J);
     1623    19651    7                          CASE(%PC_NOCHGPMEM);
     1624    19652    8                             IF B$HEAD.NOCHGPMEM THEN DO;
     1625    19653    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');
     1626    19654    8                                TEMPLEN = TEMPLEN + 3;
     1627    19655    8                                END;
     1628    19656    8                             ELSE DO;
     1629    19657    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');
     1630    19658    8                                TEMPLEN = TEMPLEN + 2;
     1631    19659    8                                END;
     1632    19660    7                          CASE(%PC_SHARE);
     1633    19661    8                             IF B$HEAD.S THEN DO;
     1634    19662    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');
     1635    19663    8                                TEMPLEN = TEMPLEN + 3;
     1636    19664    8                                END;
     1637    19665    8                             ELSE DO;
     1638    19666    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');
     1639    19667    8                                TEMPLEN = TEMPLEN + 2;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:49   
     1640    19668    8                                END;
     1641    19669    7                          CASE(%PC_PROCACC);
     1642    19670    8                             IF B$HEAD.PROCACC THEN DO;
     1643    19671    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');
     1644    19672    8                                TEMPLEN = TEMPLEN + 3;
     1645    19673    8                                END;
     1646    19674    8                             ELSE DO;
     1647    19675    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');
     1648    19676    8                                TEMPLEN = TEMPLEN + 2;
     1649    19677    8                                END;
     1650    19678    7                          CASE(%PC_PROCSURCHG);
     1651    19679    8                             IF B$HEAD.PROCSURCHG THEN DO;
     1652    19680    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');
     1653    19681    8                                TEMPLEN = TEMPLEN + 3;
     1654    19682    8                                END;
     1655    19683    8                             ELSE DO;
     1656    19684    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');
     1657    19685    8                                TEMPLEN = TEMPLEN + 2;
     1658    19686    8                                END;
     1659    19687    7                          CASE(%PC_STATS);
     1660    19688    8                             IF B$HEAD.STATS THEN DO;
     1661    19689    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');
     1662    19690    8                                TEMPLEN = TEMPLEN + 3;
     1663    19691    8                                END;
     1664    19692    8                             ELSE DO;
     1665    19693    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');
     1666    19694    8                                TEMPLEN = TEMPLEN + 2;
     1667    19695    8                                END;
     1668    19696    7                          CASE(%PC_LOCK);
     1669    19697    7                             IF B$HEAD.STRONG_LOCK
     1670    19698    7                                THEN CALL INSERT(TEMPBUF,0,1,'S');
     1671    19699    7                                ELSE CALL INSERT(TEMPBUF,0,1,'W');
     1672    19700    7                             TEMPLEN = TEMPLEN + 25;
     1673    19701    7                          CASE(%PC_PSEUD);
     1674    19702    8                             IF B$HEAD.PSEUDO_COUNT > 0 THEN DO;
     1675    19703    8                                CALL INSERT(TEMPBUF,TEMPLEN,8,B$HEAD.PSEUDO_TEXT);
     1676    19704    8                                TEMPLEN = TEMPLEN + 8;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:50   
     1677    19705    8                                END;  /* IF PSEUDO_COUNT > 0 */
     1678    19706    8                             ELSE DO;
     1679    19707    8                                CALL INSERT(TEMPBUF,TEMPLEN,SIZEC('None defined'),
             19707                                         'None defined');
     1680    19708    8                                TEMPLEN = TEMPLEN + SIZEC('None defined');
     1681    19709    8                                RU_PARAMS(%PC_PSEUDO_NUM) = NO;
     1682    19710    8                                END;  /* ELSE */
     1683    19711    7                          CASE(%PC_PSEUDO_NUM);
     1684    19712    7                             CALL BINCHAR(TEMPNAME,B$HEAD.PSEUDO_COUNT);
     1685    19713    7                             K = 0;
     1686    19714    8                             DO WHILE(SUBSTR(TEMPNAME,K,1) = '0' AND K < 8);
     1687    19715    8                                K = K + 1;
     1688    19716    8                                END;  /* DO WHILE */
     1689    19717    7                             CALL INSERT(TEMPBUF,TEMPLEN,8-K,SUBSTR(TEMPNAME,K));
     1690    19718    7                             TEMPLEN = TEMPLEN + 8 - K;
     1691    19719    7                          END;  /* DO CASE(J) */
     1692    19720    7                       IF TEMPLEN + RUBUF.COUNT > DCB_WIDTH THEN DO;
     1693    19721    7                          CALL X$WRITE(FDS,DUMP_BUF,VECTOR(RUBUF));
     1694    19722    7                          RUBUF.TEXT = ' ';
     1695    19723    7                          RUBUF.COUNT = 0;
     1696    19724    7                          END;  /* IF */
     1697    19725    6                       IF J = %PC_LOCK THEN TEMPLEN = TEMPLEN - 25;
     1698    19726    6                       CALL INSERT(RUBUF.TEXT,RUBUF.COUNT,TEMPLEN,TEMPBUF);
     1699    19727    6                       RUBUF.COUNT = RUBUF.COUNT + TEMPLEN + 1;
     1700    19728    6                       END;  /* IF RU_PARAMS(J) */
     1701    19729    6                    IF J = %PC_NUMRUFLAGS THEN DO;
     1702    19730    6                       IF RU_PARAMS(%PC_LOCK)
     1703    19731    6                          THEN CALL X$WRITE(FDS,DUMP_LOCK,VECTOR(RUBUF),VECTOR(B$HEAD.
             19731                                   LOCK));
     1704    19732    6                          ELSE CALL X$WRITE(FDS,DUMP_BUF,VECTOR(RUBUF));
     1705    19733    6                       END;  /* IF J = %PC_LOCK */
     1706    19734    5                    END;  /* DO J */
     1707    19735    5                 DO WHILE('0'B);  /* DO NEVER */
     1708    19736    5        BAD_FID:    CALL PCE$ERROR(0,3);
     1709    19737    5                    END;  /* DO NEVER */
     1710    19738    5                 DO WHILE('0'B);  /* DO NEVER */
     1711    19739    5        BAD_FILE:   CALL PCE$ERROR(0,3);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:51   
     1712    19740    5                    CALL PCE$ERROR(%E$P_CANTDIRU,3);
     1713    19741    5                    END;  /* DO NEVER */
     1714    19742        /*E* ERROR: PCC-E$P_CANTDIRU-0
     1715    19743             MESSAGE: Unable to display rununit parameters requested.
     1716    19744             DESCRIPTION: CANT GET AT THE FILE TO DISPLAY THE FLAGS */
     1717    19745    4                 IF DCBADDR(DCBNUM(M$HEAD))->F$DCB.FCD#
     1718    19746    4                    THEN CALL M$CLOSE(CLOSE_RU) ALTRET(BAD_CLOSE);
     1719    19747    5                 DO WHILE('0'B);  /* DO NEVER */
     1720    19748    5        BAD_CLOSE:  CALL PCE$ERROR(0,3);
     1721    19749    5                    END;  /* DO NEVER */
     1722    19750    4               CASE(%PC_PDT);
     1723    19751    4                 TEMP1 = 0;                /* DISP_TBL INDEX                     */
     1724    19752    5                 DO K = 1 TO %PC_PARTITIONHI; /* DO ALL PARAMETERS                */
     1725    19753    6                    DO TEMP2 = 0 TO 15;    /* DO ALL PARTITIONS                  */
     1726    19754    6                       DISP_TBL.PARM(TEMP1) = NO;
     1727    19755    6                       DISP_TBL.PARM.RESINDX(TEMP1) = -1;
     1728    19756    6                       SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*TEMP2);
     1729    19757    7                       DO CASE(K);
     1730    19758        /**/
     1731    19759    7                        CASE (%PC_PMINTI);
     1732    19760    7                          IF (SET_PDTFLAG$ -> JM$PT.TL ~= 0) THEN
     1733    19761    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PMINTI;
     1734    19762        /**/
     1735    19763    7                        CASE (%PC_PMAXTI);
     1736    19764    7                          IF (SET_PDTFLAG$ -> JM$PT.TU ~= 0) THEN
     1737    19765    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PMAXTI;
     1738    19766        /**/
     1739    19767    7                        CASE (%PC_PMINRES);
     1740    19768    8                          DO VALUE = 0 TO NUM_PSURES + %PSURES_OFFSET - 1;
     1741    19769    8                             BITVAL = YES;
     1742    19770    9                             IF (SET_PDTFLAG$ -> JM$PT.RMIN(VALUE) ~= 0) THEN DO;
     1743    19771   10                                IF (~BITVAL) THEN DO;
     1744    19772   10                                   DISP_TBL.PARM(TEMP1+1) = DISP_TBL.PARM(TEMP1);
     1745    19773   10                                   DISP_TBL.PARM.CAT(TEMP1) = %PC_PDTCAT;
     1746    19774   10                                   DISP_TBL.PARM.INDEXLO(TEMP1) = TEMP2;
     1747    19775   10                                   DISP_TBL.PARM.INDEXHI(TEMP1) = TEMP2;
     1748    19776   10                                   TEMP1 = TEMP1 + 1;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:52   
     1749    19777   10                                   END;
     1750    19778    9                                BITVAL = NO;
     1751    19779    9                                DISP_TBL.PARM.PARM(TEMP1) = %PC_PMINRES;
     1752    19780    9                                DISP_TBL.PARM.RESINDX(TEMP1) = VALUE;
     1753    19781    9                                END;
     1754    19782    8                             END;
     1755    19783        /**/
     1756    19784    7                        CASE (%PC_PMAXRES);
     1757    19785    8                          DO VALUE = 0 TO NUM_PSURES + %PSURES_OFFSET - 1;
     1758    19786    8                             BITVAL = YES;
     1759    19787    9                             IF (SET_PDTFLAG$ -> JM$PT.RMAX(VALUE) ~= 0) THEN DO;
     1760    19788   10                                IF (~BITVAL) THEN DO;
     1761    19789   10                                   DISP_TBL.PARM(TEMP1+1) = DISP_TBL.PARM(TEMP1);
     1762    19790   10                                   DISP_TBL.PARM.CAT(TEMP1) = %PC_PDTCAT;
     1763    19791   10                                   DISP_TBL.PARM.INDEXLO(TEMP1) = TEMP2;
     1764    19792   10                                   DISP_TBL.PARM.INDEXHI(TEMP1) = TEMP2;
     1765    19793   10                                   TEMP1 = TEMP1 + 1;
     1766    19794   10                                   END;
     1767    19795    9                                BITVAL = NO;
     1768    19796    9                                DISP_TBL.PARM.PARM(TEMP1) = %PC_PMAXRES;
     1769    19797    9                                DISP_TBL.PARM.RESINDX(TEMP1) = VALUE;
     1770    19798    9                                END;
     1771    19799    8                             END;
     1772    19800        /**/
     1773    19801    7                        CASE (%PC_PLOCK);
     1774    19802    7                          IF (SET_PDTFLAG$ -> JM$PT.FLG.LOCK ~= '0'B) THEN
     1775    19803    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PLOCK;
     1776    19804        /**/
     1777    19805    7                        CASE (%PC_PQUAN);
     1778    19806    7                          IF (SET_PDTFLAG$ -> JM$PT.QUAN ~= 0) THEN
     1779    19807    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PQUAN;
     1780    19808        /**/
     1781    19809    7                        CASE (%PC_PPRIO);
     1782    19810    7                          IF (SET_PDTFLAG$ -> JM$PT.XPRIO ~= 0) THEN
     1783    19811    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PPRIO;
     1784    19812        /**/
     1785    19813    7                        CASE (%PC_PMAXACCT);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:53   
     1786    19814    7                          IF (SET_PDTFLAG$ -> JM$PT.MAX1ACCT ~= 0) THEN
     1787    19815    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PMAXACCT;
     1788    19816        /**/
     1789    19817    7                        CASE (%PC_PJMAX);
     1790    19818    7                          IF (SET_PDTFLAG$ -> JM$PT.MAX ~= 0) THEN
     1791    19819    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PJMAX;
     1792    19820    7                        END;               /* END DO CASE                        */
     1793    19821        /**/
     1794    19822    7                       IF (DISP_TBL.PARM.PARM(TEMP1) ~= 0) THEN DO;
     1795    19823    7                          DISP_TBL.PARM.CAT(TEMP1) = %PC_PDTCAT;
     1796    19824    7                          DISP_TBL.PARM.INDEXLO(TEMP1) = TEMP2;
     1797    19825    7                          DISP_TBL.PARM.INDEXHI(TEMP1) = TEMP2;
     1798    19826    7                          TEMP1 = TEMP1 + 1;
     1799    19827    7                          END;
     1800    19828        /**/
     1801    19829    6                       END;                /* END PARTITION LOOP                 */
     1802    19830    5                    END;                   /* END PARAM LOOP                     */
     1803    19831    5                 IF (TEMP1 ~= 0) THEN DO;
     1804    19832    5                    DISP_TBL.INDX = TEMP1 - 1;
     1805    19833    5                    CALL PCP$PDISP(DISP_TBL) ALTRET(DISPLAY_ERR);
     1806    19834    5                    END;
     1807    19835    4               END;                        /* END DO CASE                        */
     1808    19836        /**/
     1809    19837    3              END;
     1810    19838        /**/
     1811    19839    2           IF (DISP_CAT(%PC_SYSTEM)) THEN
     1812    19840    2              CALL PCT$SYSTEM(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1813    19841    2           IF (DISP_CAT(%PC_RESOURCE)) THEN
     1814    19842    2              CALL PCT$RESOURCE(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1815    19843    3           IF (DISP_CAT(%PC_PARTITION)) THEN DO;
     1816    19844    3              PART#_FLGS = NO;
     1817    19845    3              MONPTR$ = CAT$ -> CAT$TBL.PARAM$(%PC_SYSTEM) -> P$TBL.PTR$(%PC_NPART);
     1818    19846    3              MONPTR.SEGID = BITBIN(%SPCL1SID);
     1819    19847    4              DO K = 0 TO MONPTR$ -> B$TABLE(0) - 1;
     1820    19848    4                 PART#_FLGS(K) = YES;
     1821    19849    4                 END;
     1822    19850    3              CALL PCT$PARTITION(%PC_PCTPART#) ALTRET(DISPLAY_ERR);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:54   
     1823    19851    3              END;
     1824    19852    2           IF (DISP_CAT(%PC_EXCEPTION)) THEN
     1825    19853    2              CALL PCT$EXCEPTION(%PC_PCTALL) ALTRET(DISPLAY_ERR);
     1826    19854        /**/
     1827    19855    3           IF (J ~= 0) THEN DO;            /* SOME PARAMETERS                    */
     1828    19856    3              DISP_TBL.INDX = J-1;
     1829    19857    3              CALL PCP$PDISP(DISP_TBL) ALTRET(DISPLAY_ERR);
     1830    19858    3              END;
     1831    19859        /**/
     1832    19860    2           RETURN;
     1833    19861        /**/
     1834    19862    2   BAD_RES:
     1835    19863    2           CALL PCE$ERROR(%E$P_BADRES,3);
     1836    19864        /**/
     1837    19865    2   DISPLAY_ERR:
     1838    19866    2           ALTRETURN;
     1839    19867    2   END EXEC_DISPLAY;
     1840    19868        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:55   
     1841    19869        /**/
     1842    19870    1   GET_RES: PROC(RES_INDEX,OUT_SYM) ALTRET;
     1843    19871        /**/
     1844    19872    2   DCL RES_INDEX SBIN WORD;
     1845    19873        %PARSE$SYM (NAME=OUT_SYM,STCLASS="");
     1846    19911        /**/
     1847    19912    2   DCL INDX SBIN WORD AUTO;
     1848    19913        /**/
     1849    19914    3           IF (OUT_SYM.COUNT = 2) THEN DO INDX = 0 TO %PSURES_OFFSET-1;
     1850    19915    4              IF (SUBSTR(OUT_SYM.TEXT,0,2) = RES_TEXT(INDX)) THEN DO;
     1851    19916    4                 RES_INDX = INDX;
     1852    19917    4                 RETURN;
     1853    19918    4                 END;
     1854    19919    3              END;
     1855    19920        /**/
     1856    19921    3           DO INDX = 0 TO NUM_PSURES;
     1857    19922    4              IF (SUBSTR(OUT_SYM.TEXT,0,OUT_SYM.COUNT) = PSURES_TEXT(INDX)) THEN DO;
     1858    19923    4                 RES_INDX = INDX + %PSURES_OFFSET;
     1859    19924    4                 RETURN;
     1860    19925    4                 END;
     1861    19926    3              END;
     1862    19927        /**/
     1863    19928    2           ALTRETURN;
     1864    19929    2   END GET_RES;
     1865    19930        /**/
     1866    19931        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:56   
     1867    19932        /**/
     1868    19933    1   EXEC_SET: PROC ALTRET;
     1869    19934        /**/
     1870    19935    2           CALL M$INT(BREAKSET_FPT);       /* CHANGE BREAK CONTROL               */
     1871    19936        /**/
     1872    19937    3           DO I = 1 TO P_PCB.OUT$ -> O$BLK.NSUBLKS-1;
     1873    19938    3              BLK$ = P_PCB.OUT$ -> O$BLK.SUBLK$(I); /* ALL PARAMS                  */
     1874    19939    4              IF NOT(SETAUTH) AND BLK$->O$BLK.SUBLK$(0)->O$BLK.CODE ~= %PC_RUPARAM THEN
             19939                       DO;
     1875    19940    4                 CALL PCE$ERROR(%E$P_CANTSET,3);
     1876    19941    4                 GOTO ENDLOOP;
     1877    19942    4                 END;
     1878    19943        /**/
     1879    19944        /*E*     ERROR: PCC-E$P_CANTSET-0
     1880    19945                 MESSAGE:  You are not allowed to SET values - command ignored.
     1881    19946                 MESSAGE1: You dont have the privilege required to SET values
     1882    19947                 DESCRIPTION:   SOMEONES TRYING TO CHEAT - FORGET IT */
     1883    19948    4              DO CASE (BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE); /* DO CASE(CATAGORY) */
     1884    19949        /**/
     1885    19950    4               CASE(%PC_SYSTEM,%PC_EXCEPTION,%PC_SECURITY);
     1886    19951        /**/
     1887    19952    4                 SET_CAT = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1888    19953    4                 IF SET_CAT = %PC_SECURITY THEN
     1889    19954    4                    SET_CAT = %PC_SYSTEM;
     1890    19955    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);
     1891    19956    4                 SET_PARAM = PARAM$ -> O$BLK.CODE;
     1892    19957        /**/
     1893    19958    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->
     1894    19959    5                   P$TBL.FLAGS.DISPONLY(SET_PARAM)) THEN DO;
     1895    19960    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);
     1896    19961    5                    ALTRETURN;
     1897    19962    5                    END;
     1898    19963        /**/
     1899    19964        /*E*     ERROR:    PCC-E$P_DISPONLY-0
     1900    19965                 MESSAGE:  Dont try to set a display only parameter
     1901    19966                 DESCRIPTION: USER TRIED TO ASSIGN A NEW VALUE TO A DISPLAY
     1902    19967                                ONLY CONTROL PARAMETER   */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:57   
     1903    19968        /**/
     1904    19969    5                 IF CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXTLIST(SET_PARAM)
             19969                          THEN DO;
     1905    19970                          /* Value is a list of privs or mon services  */
     1906    19971    5                    IF CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM)
     1907    19972    5                       ~= BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE
     1908    19973    6                       THEN DO;
     1909    19974    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);
     1910    19975    6                          GOTO RESET_BREAK;
     1911    19976    6                          END; /* IF error */
     1912    19977    5                    SUBLK$=BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1);
     1913    19978    6                    IF CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.INTINDX(SET_PARAM)
             19978                             THEN DO;
     1914    19979                         /* This better be a list of monitor services for now. */
     1915    19980    6                       MONSER_VALUE='0'B;
     1916    19981    6                       IF SUBLK$->O$BLK.SUBLK$(0)->OUT$SYM.CODE=%PC_NONE THEN;
     1917    19982    6                       ELSE IF SUBLK$->O$BLK.SUBLK$(0)->OUT$SYM.CODE=%PC_ALL THEN
     1918    19983    7                       DO K = 0 TO %MAX_FCG#;
     1919    19984    7                          MONSER_VALUE(K)='777777777777'O;
     1920    19985    7                          END;
     1921    19986    6                       ELSE  /* List of individual pmme names. */
     1922    19987    7                       DO K = 0 TO SUBLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS-1;
     1923    19988    7                          LIT$=SUBLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(K);
     1924    19989    7                          PMME=LIT$->OUT$SYM.CODE;
     1925    19990    7                          VAL$=ADDR(MONSER_VALUE(PMME_REDEF.FCG));
     1926    19991    7                          VAL$->B$BITS(PMME_REDEF.CODE)='1'B;
     1927    19992    7                          END;
     1928    19993    6                       END;
     1929    19994    6                    ELSE DO; /* Some kind of priv mask. */
     1930    19995                            /* Maybe add pprivs some day? */
     1931    19996    6                       MASK_VALUE='0'B;
     1932    19997    6                       MASKVALHI = %PRIV_VAL_HI;
     1933    19998    6                       PC$ = ADDR(PRIV_VALS.PC_CODE);
     1934    19999    6                       VAL$ = ADDR(PRIV_VALS.VAL_CODE);
     1935    20000                            /* ALL, NONE, or a list of privs */
     1936    20001    7                       DO K = 0 TO SUBLK$->O$BLK.NSUBLKS-1;
     1937    20002    7                          LIT$=SUBLK$->O$BLK.SUBLK$(K);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:58   
     1938    20003    8      MASK:               DO L = 0 TO MASKVALHI;
     1939    20004    9                             IF LIT$->OUT$SYM.CODE=PC$->PC_CODE(L) THEN DO;
     1940    20005    9                                MASK_VALUE=MASK_VALUE|VAL$->VAL_CODE(L);
     1941    20006    9                                EXIT MASK;
     1942    20007    9                                END;
     1943    20008    8                             END;
     1944    20009    7                          END;
     1945    20010    6                       IF PARAM$->O$BLK.CODE=%PC_STEPPRIVMASK OR
     1946    20011    6                          PARAM$->O$BLK.CODE=%PC_PRIVMASK
     1947    20012    6                       THEN MASK_VALUE=~MASK_VALUE;
     1948    20013    6                       END;
     1949    20014    5                    END;
     1950    20015    5                 ELSE IF SET_CAT = %PC_SYSTEM AND SET_PARAM = %PC_TIMEZONE THEN DO;
     1951    20016    6                    IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %
             20016                             PC_TZVAL THEN DO;
     1952    20017    6   BAD_TIMEZONE:
     1953    20018    6                       CALL PCE$ERROR(%E$P_PARSEERR,3);
     1954    20019    6                       GOTO RESET_BREAK;
     1955    20020    6                       END;
     1956    20021    5                    CALL SET_TIMEZONE ALTRET( BAD_TIMEZONE);
     1957    20022    5                    GOTO ENDLOOP;
     1958    20023    5                    END;
     1959    20024    5                 ELSE IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %
             20024                          PC_DECVAL THEN DO;
     1960    20025    5                    IF (NOT CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXT(
             20025                             SET_PARAM)) OR
     1961    20026    5                       (CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM) ~= BLK$
             20026                                ->
     1962    20027    5                          O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE)
     1963    20028    6                       THEN DO;
     1964    20029    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);
     1965    20030    6                          GOTO RESET_BREAK;
     1966    20031    6                          END;  /* IF ERROR */
     1967    20032    5                    VALUE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.SUBLK$(0)
             20032                             ->OUT$SYM.CODE;
     1968    20033    5                    CODE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE;
     1969    20034    5                    IF CODE=%PC_FLAGVAL OR CODE=%PC_LOGFILEVAL OR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:59   
     1970    20035    5                          CODE=%PC_LOGACCVAL OR CODE=%PC_LOGEXVAL OR
     1971    20036    5                          CODE=%PC_LOGLISTVAL
     1972    20037    5                       THEN VALUE = VALUE - 1;
     1973    20038    5                    END;  /* IF CODE ~= %PC_DECVAL */
     1974    20039    4                    ELSE CALL CHARBIN(VALUE,BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->
             20039                             OUT$SYM.TEXT);
     1975    20040        /**/
     1976    20041        /**/
     1977    20042    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->
     1978    20043    5                   P$TBL.FLAGS.INDX(SET_PARAM)) THEN DO; /* INDEXED              */
     1979    20044    5                    IF (BLK$ -> O$BLK.NSUBLKS = 2)OR /* NO OR 'ALL' INDEX        */
     1980    20045    5                      (BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %
             20045                               PC_ALLOPT)
     1981    20046    6                    THEN DO;
     1982    20047    7                       IF (SET_CAT = %PC_SYSTEM) THEN DO;
     1983    20048    7                          SET_INDEXLO = 1;
     1984    20049    7                          SET_INDEXHI = %PC_MAXMODE;
     1985    20050    7                          END;
     1986    20051    7                       ELSE DO;
     1987    20052    7                          SET_INDEXLO = 0;
     1988    20053    7                          SET_INDEXHI = %PC_MAXDOMAIN;
     1989    20054    7                          END;
     1990    20055    6                       CALL SET_VALUE;
     1991    20056    6                       END;
     1992    20057        /**/
     1993    20058    6                    ELSE DO K = 0 TO BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.NSUBLKS-1;
     1994    20059    6                       SET_INDEXLO = BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(K) ->
     1995    20060    6                         O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1996    20061    6                       SET_INDEXHI = SET_INDEXLO;
     1997    20062    6                       CALL SET_VALUE;
     1998    20063    6                       END;
     1999    20064    5                    END;
     2000    20065        /**/
     2001    20066    4                 ELSE IF (CAT$->CAT$TBL.PARAM$(SET_CAT)->
     2002    20067    5                   P$TBL.FLAGS.INTINDX(SET_PARAM)) THEN DO; /* Internally indexed */
     2003    20068    5                    IF CAT$->CAT$TBL.PARAM$(SET_CAT)->
     2004    20069    5                      P$TBL.VALCODE(SET_PARAM) = %PC_MONSERVAL THEN
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:60   
     2005    20070    6                       DO K=0 TO %MAX_FCG#;
     2006    20071    6                          MASK_VALUE=MONSER_VALUE(K);
     2007    20072    6                          SET_INDEXLO = K;
     2008    20073    6                          SET_INDEXHI = K;
     2009    20074    6                          CALL SET_VALUE;
     2010    20075    6                          END;
     2011    20076    5                    END;
     2012    20077    5                 ELSE DO;
     2013    20078    6                    IF (BLK$ -> O$BLK.NSUBLKS ~= 2) THEN DO; /* ILLEGAL INDEX    */
     2014    20079    6                       CALL PCE$ERROR(%E$P_NOTINDEX,2);
     2015    20080    6                       ALTRETURN;
     2016    20081    6                       END;
     2017    20082        /**/
     2018    20083    5                    SET_INDEXLO = 0;
     2019    20084    5                    SET_INDEXHI = 0;       /* NOT INDEXED                        */
     2020    20085    5                    CALL SET_VALUE;
     2021    20086    5                    END;
     2022    20087        /**/
     2023    20088    4               CASE(%PC_RESOURCE);
     2024    20089    4                 SET_CAT = %PC_RESOURCE;
     2025    20090    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);
     2026    20091    4                 SET_PARAM = PARAM$ -> O$BLK.CODE;
     2027    20092        /**/
     2028    20093    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->
     2029    20094    5                   P$TBL.FLAGS.DISPONLY(SET_PARAM)) THEN DO;
     2030    20095    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);
     2031    20096    5                    ALTRETURN;
     2032    20097    5                    END;
     2033    20098        /**/
     2034    20099    5                 IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %PC_DECVAL
             20099                          THEN DO;
     2035    20100    5                    IF (NOT CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXT(
             20100                             SET_PARAM)) OR
     2036    20101    5                       (CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM) ~= BLK$
             20101                                ->
     2037    20102    5                          O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE)
     2038    20103    6                       THEN DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:61   
     2039    20104    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);
     2040    20105    6                          GOTO RESET_BREAK;
     2041    20106    6                          END;  /* IF ERROR */
     2042    20107    5                    VALUE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.SUBLK$(0)
             20107                             ->OUT$SYM.CODE;
     2043    20108    5                    IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE = %
             20108                             PC_FLAGVAL
     2044    20109    5                       THEN VALUE = VALUE - 1;
     2045    20110    5                    END;  /* IF CODE ~= %PC_DECVAL */
     2046    20111    4                    ELSE CALL CHARBIN(VALUE,BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->
             20111                             OUT$SYM.TEXT);
     2047    20112        /**/
     2048    20113        /**/
     2049    20114    4                 CALL GET_RES(RES_INDX,PARAM$ -> O$BLK.SUBLK$(0) -> OUT$SYM)
     2050    20115    4                   ALTRET(BAD_RES);
     2051    20116    4                 IF SET_PARAM = %PC_TOTRES AND
     2052    20117    5                    RES_INDX < %PSURES_OFFSET THEN DO;  /* ILLEGAL */
     2053    20118    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);
     2054    20119    5                    ALTRETURN;
     2055    20120    5                    END;  /* IF */
     2056    20121        /**/
     2057    20122    5                 IF (RES$ -> P$TBL.FLAGS.INDX(SET_PARAM)) THEN DO;
     2058    20123    5                    IF (BLK$ -> O$BLK.NSUBLKS = 2)OR /* NO OR 'ALL' INDEX        */
     2059    20124    5                      (BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %
             20124                               PC_ALLOPT)
     2060    20125    6                    THEN DO;
     2061    20126    6                       SET_INDEXLO = 1;
     2062    20127    6                       SET_INDEXHI = %PC_MAXMODE;
     2063    20128    6                       CALL SET_VALUE;
     2064    20129    6                       END;
     2065    20130        /**/
     2066    20131    6                    ELSE DO K = 0 TO BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.NSUBLKS-1;
     2067    20132    6                       SET_INDEXLO = BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(K) ->
     2068    20133    6                         O$BLK.SUBLK$(0) -> O$BLK.CODE;
     2069    20134    6                       SET_INDEXHI = SET_INDEXLO;
     2070    20135    6                       CALL SET_VALUE;
     2071    20136    6                       END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:62   
     2072    20137    5                    END;
     2073    20138        /**/
     2074    20139    5                 ELSE DO;
     2075    20140    6                    IF (BLK$ -> O$BLK.NSUBLKS ~= 2) THEN DO; /* ILLEGAL INDEX    */
     2076    20141    6                       CALL PCE$ERROR(%E$P_NOTINDEX,2);
     2077    20142    6                       ALTRETURN;
     2078    20143    6                       END;
     2079    20144        /**/
     2080    20145    5                    SET_INDEXLO = 0;
     2081    20146    5                    SET_INDEXHI = 0;       /* NOT INDEXED                        */
     2082    20147    5                    CALL SET_VALUE;
     2083    20148    5                    END;
     2084    20149        /**/
     2085    20150    4               CASE (%PC_PARTITION);
     2086    20151        /**/
     2087    20152    4                 SET_CAT = %PC_PARTITION;
     2088    20153    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);
     2089    20154    4                 SET_PARAM = PARAM$ -> O$BLK.CODE;
     2090    20155        /**/
     2091    20156    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->
     2092    20157    5                   P$TBL.FLAGS.DISPONLY(SET_PARAM)) THEN DO;
     2093    20158    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);
     2094    20159    5                    ALTRETURN;
     2095    20160    5                    END;
     2096    20161        /**/
     2097    20162    5                 IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %PC_DECVAL
             20162                          THEN DO;
     2098    20163    5                    IF (NOT CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXT(
             20163                             SET_PARAM)) OR
     2099    20164    5                       (CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM) ~= BLK$
             20164                                ->
     2100    20165    5                          O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE)
     2101    20166    6                       THEN DO;
     2102    20167    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);
     2103    20168    6                          GOTO RESET_BREAK;
     2104    20169    6                          END;  /* IF ERROR */
     2105    20170    5                    VALUE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.SUBLK$(0)
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:63   
             20170                             ->OUT$SYM.CODE;
     2106    20171    5                    IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE = %
             20171                             PC_FLAGVAL
     2107    20172    5                       THEN VALUE = VALUE - 1;
     2108    20173    5                    END;  /* IF CODE ~= %PC_DECVAL */
     2109    20174    4                    ELSE CALL CHARBIN(VALUE,BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->
             20174                             OUT$SYM.TEXT);
     2110    20175        /**/
     2111    20176        /**/
     2112    20177    5                 IF (PARAM$ -> O$BLK.NSUBLKS ~= 0) THEN DO; /* RESOURCE          */
     2113    20178    5                    CALL GET_RES(RES_INDX,PARAM$ -> O$BLK.SUBLK$(0) -> OUT$SYM)
     2114    20179    5                      ALTRET(BAD_RES);
     2115    20180    5                    END;
     2116    20181    4                 ELSE RES_INDX = -1;
     2117    20182        /**/
     2118    20183    4                 IF (BLK$ -> O$BLK.NSUBLKS = 2)OR /* NO OR 'ALL' INDEX           */
     2119    20184    4                   (BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %
             20184                            PC_ALLOPT)
     2120    20185    5                 THEN DO;
     2121    20186    5                    SET_INDEXLO = 0;
     2122    20187    5                    SET_INDEXHI = 15;
     2123    20188    5                    CALL SET_VALUE;
     2124    20189    5                    END;
     2125    20190        /**/
     2126    20191    5                 ELSE DO K = 0 TO BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.NSUBLKS-1;
     2127    20192    5                    INDEX$ = BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(K);
     2128    20193    5                    SET_INDEXLO = INDEX$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;
     2129    20194        /**/
     2130    20195    5                    IF (INDEX$ -> O$BLK.NSUBLKS = 1) THEN
     2131    20196    5                       SET_INDEXHI = SET_INDEXLO;
     2132    20197    6                    ELSE DO;
     2133    20198    6                       SET_INDEXHI = INDEX$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;
     2134    20199        /**/
     2135    20200    7                       IF (SET_INDEXHI < SET_INDEXLO) THEN DO;
     2136    20201    7                          CALL PCE$ERROR(%E$P_P#RANGE,2);
     2137    20202    7                          RETURN;
     2138    20203    7                          END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:64   
     2139    20204    6                       END;
     2140    20205    5                    CALL SET_VALUE;
     2141    20206    5                    END;
     2142    20207    4               CASE(%PC_RUPARAM);
     2143    20208    4                 TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);
     2144    20209    4                 HEAD_FID.TEXTFID_ = VECTOR(TEMP$->OUT$SYM.TEXT);
     2145    20210    4                 CALL M$FID(HEAD_FID) ALTRET(BAD_FID);
     2146    20211    4                 OPEN_RU.V.FUN# = %UPDATE#;
     2147    20212    4                 CALL M$OPEN(OPEN_RU) ALTRET(BAD_FILE);
     2148    20213    4                 CALL M$READ(READ_HEAD) ALTRET(BAD_FILE);
     2149    20214    5                 DO J = 1 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS - 1;
     2150    20215    5                    TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J);
     2151    20216    5                    CODE = TEMP$->O$BLK.SUBLK$(0)->O$BLK.CODE;
     2152    20217    5                    TEMPNAME = TEMP$->O$BLK.SUBLK$(1)->OUT$SYM.TEXT;
     2153    20218    5                    TEMPLEN = TEMP$->O$BLK.SUBLK$(1)->OUT$SYM.COUNT;
     2154    20219    6                    IF CODE ~= %PC_PSEUD THEN DO;
     2155    20220    7                       IF CODE = %PC_PSEUDO_NUM THEN DO;
     2156    20221    8                          DO K = 0 TO TEMPLEN - 1;
     2157    20222    8                             IF SUBSTR(TEMPNAME,K,1) < '0' OR
     2158    20223    9                                SUBSTR(TEMPNAME,K,1) > '9' THEN DO;
     2159    20224    9                                CALL PCE$ERROR(%E$P_PARSEERR,2);
     2160    20225    9                                GOTO CLOSERU;
     2161    20226    9                                END;  /* IF NON DIGIT */
     2162    20227    8                             END;  /* DO K */
     2163    20228    7                          CALL CHARBIN(VALUE,SUBSTR(TEMPNAME,0,TEMPLEN));
     2164    20229    7                          END;  /* IF CODE = %PC_PSEUDO_NUM */
     2165    20230    7                       ELSE DO;
     2166    20231    7                        CALL XLATE (TEMPNAME, B$XL_UPPER, TEMPNAME);
     2167    20232    7                          IF TEMPNAME = 'YES' OR
     2168    20233    7                             TEMPNAME = 'YE' OR
     2169    20234    7                             TEMPNAME = 'Y' OR
     2170    20235    7                             TEMPNAME = '1'
     2171    20236    7                             THEN VALUE = 1;
     2172    20237    7                             ELSE
     2173    20238    7                          IF TEMPNAME = 'NO' OR
     2174    20239    7                             TEMPNAME = 'N' OR
     2175    20240    7                             TEMPNAME = '0'
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:65   
     2176    20241    7                             THEN VALUE = 0;
     2177    20242    8                          ELSE DO;  /* ERROR */
     2178    20243    8                             CALL PCE$ERROR(%E$P_PARSEERR,2);
     2179    20244    8                             GOTO CLOSERU;
     2180    20245    8                             END;  /* ELSE ERROR */
     2181    20246    7                          END;  /* ELSE */
     2182    20247    6                       END;  /* IF CODE ~= %PC_PSEUD */
     2183    20248    6                    DO CASE(CODE);
     2184    20249    6                       CASE(%PC_NOCHGPMEM);
     2185    20250    6                          B$HEAD.NOCHGPMEM = BINBIT(VALUE,1);
     2186    20251    6                       CASE(%PC_SHARE);
     2187    20252    6                          B$HEAD.S = BINBIT(VALUE,1);
     2188    20253    6                       CASE(%PC_PROCACC);
     2189    20254    6                          B$HEAD.PROCACC = BINBIT(VALUE,1);
     2190    20255    6                       CASE(%PC_PROCSURCHG);
     2191    20256    6                          B$HEAD.PROCSURCHG = BINBIT(VALUE,1);
     2192    20257    6                       CASE(%PC_STATS);
     2193    20258    6                          B$HEAD.STATS = BINBIT(VALUE,1);
     2194    20259    6                       CASE(%PC_PSEUD);
     2195    20260    6                          B$HEAD.PSEUDO_TEXT = TEMPNAME;
     2196    20261    6                          B$HEAD.PSEUDO_COUNT = 1;
     2197    20262    6                       CASE(%PC_PSEUDO_NUM);
     2198    20263    6                          B$HEAD.PSEUDO_COUNT = VALUE;
     2199    20264    6                          IF VALUE = 0
     2200    20265    6                             THEN B$HEAD.PSEUDO_TEXT = ' ';
     2201    20266    6                       CASE(%PC_LOCK);
     2202    20267    6                          TEMP1$ = TEMP$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);
     2203    20268    6                          B$HEAD.STRONG_LOCK = BINBIT(TEMP1$->O$BLK.CODE,1);
     2204    20269    7                          DO K = 0 TO TEMP1$->O$BLK.NSUBLKS - 1;
     2205    20270    8                             DO CASE(TEMP1$->O$BLK.SUBLK$(K)->O$BLK.CODE);
     2206    20271    8                                CASE(%PC_SING);
     2207    20272    8                                   CALL CHARBIN(FIRST_BIT,TEMP1$->O$BLK.SUBLK$(K)->
             20272                                            O$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     2208    20273    8                                   LAST_BIT = FIRST_BIT;
     2209    20274    8                                CASE(%PC_RANGE);
     2210    20275    8                                   CALL CHARBIN(FIRST_BIT,TEMP1$->O$BLK.SUBLK$(K)->
             20275                                            O$BLK.SUBLK$(0)->OUT$SYM.TEXT);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:66   
     2211    20276    8                                   CALL CHARBIN(LAST_BIT,TEMP1$->O$BLK.SUBLK$(K)->O$BLK
             20276                                            .SUBLK$(1)->OUT$SYM.TEXT);
     2212    20277    8                                END;  /* DO CASE CODE */
     2213    20278    8                             IF (LAST_BIT > 72) OR (FIRST_BIT < 1) THEN DO;
     2214    20279    8                                CALL PCE$ERROR(%E$P_BADLOCKBIT,3);
     2215    20280    8                                GOTO CLOSERU;
     2216    20281    8                                END;  /* IF LAST_BIT > 72 */
     2217    20282    8                             DO L = FIRST_BIT TO LAST_BIT;
     2218    20283    8                                B$HEAD.LOCK(L-1) = BINBIT(VALUE,1);
     2219    20284    8                                END;  /* DO L */
     2220    20285    7                             END;  /* DO K */
     2221    20286    6                          B$HEAD.RESTPROC = (B$HEAD.LOCK ~= '0'B);
     2222    20287    6                       END;  /* DO CASE RUPARAM CODE */
     2223    20288    5                    END;  /* DO J */
     2224    20289    4                 CALL M$WRITE(WRITE_HEAD) ALTRET(BAD_FILE);
     2225    20290    5                 DO WHILE('0'B);  /* DO NEVER */
     2226    20291    5           BAD_FID: CALL PCE$ERROR(0,3);
     2227    20292    5                    END;  /* DO NEVER */
     2228    20293    5                 DO WHILE('0'B);  /* DO NEVER */
     2229    20294    5        BAD_FILE:   CALL PCE$ERROR(0,3);
     2230    20295    5                    CALL PCE$ERROR(%E$P_BADRU,3);
     2231    20296    5                    END;  /* DO NEVER */
     2232    20297    4   CLOSERU:      IF DCBADDR(DCBNUM(M$HEAD))->F$DCB.FCD#
     2233    20298    4                    THEN CALL M$CLOSE(CLOSE_RU) ALTRET(BAD_CLOSE);
     2234    20299    5                 DO WHILE('0'B);  /* DO NEVER */
     2235    20300    5        BAD_CLOSE:  CALL PCE$ERROR(0,3);
     2236    20301    5                    END;  /* DO NEVER */
     2237    20302        /*E* ERROR: PCC-E$P_BADLOCKBIT-0
     2238    20303             MESSAGE:  Bad lockbit value - must be from 1 to 72.
     2239    20304             DESCRIPTION: See message                  */
     2240    20305        /*E* ERROR: PCC-E$P_BADRU-0
     2241    20306             MESSAGE:  Unable to set bits in HEAD record of specified rununit.
     2242    20307             DESCRIPTION:  Cant get at the HEAD record to make changes requested */
     2243    20308        /**/
     2244    20309        /**/
     2245    20310    4               CASE(%PC_TP);
     2246    20311    4                 CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(NO_TP_FILE);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:67   
     2247    20312    4                 TABLE$ = B$DS5$;
     2248    20313    4                 CUR_SIZE_OF_DATA = SIZEW(PC$HDR) + PC$HDR.CURINSTANCES * SIZEW(
             20313                          PC$INSTANCE);
     2249    20314    4                 TABLE$ = PINCRW(TABLE$,CUR_SIZE_OF_DATA);
     2250    20315    5                 DO WHILE('0'B);           /* DO NEVER                           */
     2251    20316    5       NO_TP_FILE:  IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE
     2252    20317    5                       THEN                /* CREATE THE FILE                    */
     2253    20318    6                       DO;
     2254    20319    7                          IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;
     2255    20320    7                             CALL M$SPRIV(FMS_PRIV) ALTRET(NEXT1);
     2256    20321    7                       NEXT1:;
     2257    20322    7                             END;  /* IF */
     2258    20323    6                          OPEN_TP_CNTRL.V.FUN# = %CREATE#;
     2259    20324    6                          CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(BAD_TP);
     2260    20325    7                          DO WHILE('0'B);  /* DO NEVER */
     2261    20326    8           BAD_TP:           IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;
     2262    20327    8                                CALL M$RPRIV(FMS_PRIV) ALTRET(NEXT2);
     2263    20328    8                          NEXT2:;
     2264    20329    8                                END;  /* IF */
     2265    20330    7                             CALL PCE$ERROR(%E$P_BADTPFILE,3);
     2266    20331    7                             GOTO CLEANUP;
     2267    20332    7                             END;  /* DO NEVER */
     2268    20333    6                          OPEN_TP_CNTRL.V.FUN# = %UPDATE#;
     2269    20334    6                          TABLE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2270    20335    6                          PC$HDR.CURINSTANCES = 0;
     2271    20336    6                          WORDS_AVAIL = %WORDS_PER_GRAN - SIZEW(PC$HDR);
     2272    20337    6                          CURINSTANCES = 0;
     2273    20338    6                          TBLINSTANCES = 0;
     2274    20339    6                       END;
     2275    20340    5                       ELSE
     2276    20341    6                       DO;
     2277    20342    6                          CALL PCE$ERROR(%E$P_BADTPFILE,3);
     2278    20343    6                          GOTO CLEANUP;
     2279    20344    6                       END;                /* ELSE                               */
     2280    20345    5                 END;                      /* DO NEVER                           */
     2281    20346    5                 DO CASE(BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.CODE);
     2282    20347    5                    CASE(%PC_TPINSTANCE);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:68   
     2283    20348    6                       DO J = 0 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1)->O$BLK.
             20348                                NSUBLKS - 1;
     2284    20349    6                          INSTANCE_NAME = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1)->O$BLK
             20349                                   .SUBLK$(J)->OUT$SYM.TEXT;
     2285    20350    6                          INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2286    20351    7                          DO K = 0 TO PC$HDR.CURINSTANCES - 1;
     2287    20352    7                             IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND
     2288    20353    7                                NOT PC$INSTANCE.FLAGS.DELETED
     2289    20354    7                                THEN          /* DUPLICATE INSTANCE NAME            */
     2290    20355    8                                DO;
     2291    20356    8                                   SUB_BUF_1.COUNT = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20356                                            SUBLK$(1)->O$BLK.SUBLK$(J)->OUT$SYM.COUNT;
     2292    20357    8                                   SUB_BUF_1.TEXT = INSTANCE_NAME;
     2293    20358    8                                   CALL PCE$ERROR(%E$P_DUP_INSTANCE,3);
     2294    20359    8                                   GOTO L1;
     2295    20360    8                                END;          /* IF                                 */
     2296    20361    7                             INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2297    20362    7                          END;                /* DO K                               */
     2298    20363
     2299    20364                               /* Now check for any available space already in the
     2300    20365                                  file.  If there is none, then call GBLK to get some */
     2301    20366    6                          INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2302    20367    6                          TBLINDX = 0;
     2303    20368    7                          DO K = 0 TO TBLINSTANCES - 1;
     2304    20369    7                             IF PC$INSTANCE.FLAGS.DELETED
     2305    20370    7                                THEN GOTO ADD_INSTANCE;
     2306    20371    7                             TBLINDX = TBLINDX + 1;
     2307    20372    7                             INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2308    20373    7                             END;  /* DO K */
     2309    20374    6                          CALL GBLK(INSTANCE$,SIZEW(PC$INSTANCE)) ALTRET(NO_MEM);
     2310    20375    6                          PC$HDR.CURINSTANCES = PC$HDR.CURINSTANCES + 1;
     2311    20376    6                          TBLINSTANCES = TBLINSTANCES + 1;
     2312    20377    6           ADD_INSTANCE:  PC$INSTANCE = '0'B;
     2313    20378    6                          PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME;
     2314    20379    6                          PC$INSTANCE.MAXTPU = %DEFAULT_MAXTPU;
     2315    20380    6                          PC$INSTANCE.STATS  = '0'B;
     2316    20381    6                          MAXTPU_TBL.FLAGS.DELETED(TBLINDX) = '0'B;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:69   
     2317    20382    6                          MAXTPU_TBL.NAME(TBLINDX) = INSTANCE_NAME;
     2318    20383    6                          MAXTPU_TBL.COUNT(TBLINDX) = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20383                                   SUBLK$(1)->
     2319    20384    6                             O$BLK.SUBLK$(J)->OUT$SYM.COUNT;
     2320    20385    6                          MAXTPU_TBL.MAXTPU(TBLINDX) = %DEFAULT_MAXTPU;
     2321    20386    6                          MAXTPU_TBL.FLAGS.PRINT(TBLINDX) = TP_TBL.MAXTPU.FLAGS.PRINT;
     2322    20387    6                          IF TP_TBL.MAXTPU.FLAGS.PRINT
     2323    20388    6                             THEN TP_TBL.MAXTPU.MAX = TP_TBL.MAXTPU.MAX + 1;
     2324    20389    6                          CURINSTANCES = CURINSTANCES + 1;
     2325    20390    6                 L1:
     2326    20391    6                          END;  /* DO J */
     2327    20392    5                    CASE(%PC_MAXTPU);
     2328    20393    5                       TEMP1 = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS;
     2329    20394    5                       TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1);
     2330    20395    5                       CALL CHARBIN(VALUE,TEMP$->OUT$SYM.TEXT);
     2331    20396    5                       IF TEMP1 = 1
     2332    20397    5                          THEN        /* Determine indx of this instance name    */
     2333    20398    6                          DO J = 0 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.
             20398                                   SUBLK$(0)->O$BLK.NSUBLKS - 1;
     2334    20399    6                             INSTANCE_NAME = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->
             20399                                      O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;
     2335    20400    6                             FOUND = '0'B;
     2336    20401    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2337    20402    7                             DO K = 0 TO PC$HDR.CURINSTANCES - 1;
     2338    20403    7                                IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND
     2339    20404    7                                   NOT PC$INSTANCE.FLAGS.DELETED
     2340    20405    7                                   THEN    /* FOUND IT                           */
     2341    20406    8                                   DO;
     2342    20407    8                                      FOUND = '1'B;
     2343    20408    8                                      PC$INSTANCE.MAXTPU = VALUE;
     2344    20409    8                                      MAXTPU_TBL.MAXTPU(K) = VALUE;
     2345    20410    8                                   END;    /* IF FOUND                           */
     2346    20411    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2347    20412    7                             END;          /* DO K                              */
     2348    20413    6                             IF NOT FOUND
     2349    20414    6                                THEN       /* BAD INSTANCE NAME                  */
     2350    20415    7                                DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:70   
     2351    20416    7                                   SUB_BUF_1.COUNT = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20416                                            SUBLK$(0)->
     2352    20417    7                                                     O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->
             20417                                                              OUT$SYM.COUNT;
     2353    20418    7                                   SUB_BUF_1.TEXT = INSTANCE_NAME;
     2354    20419    7                                   CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
     2355    20420    7                                END;       /* IF NOT FOUND                       */
     2356    20421    6                          END;  /* DO J */
     2357    20422    5                          ELSE             /* ALL                                */
     2358    20423    6                          DO;
     2359    20424    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2360    20425    7                             DO J = 0 TO PC$HDR.CURINSTANCES - 1;
     2361    20426    8                                IF NOT PC$INSTANCE.FLAGS.DELETED THEN DO;
     2362    20427    8                                   PC$INSTANCE.MAXTPU = VALUE;
     2363    20428    8                                   MAXTPU_TBL.MAXTPU(J) = VALUE;
     2364    20429    8                                   END;  /* IF NOT DELETED */
     2365    20430    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2366    20431    7                                END;  /* DO J */
     2367    20432    6                             END;  /* ELSE */
     2368    20433    5                    CASE(%PC_TPHDR);
     2369    20434    5                       TEMP1 = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS;
     2370    20435    5                       TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1);
     2371    20436    5                       IF TEMP1 = 1
     2372    20437    5                          THEN        /* Determine indx of this instance name    */
     2373    20438    6                          DO J = 0 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.
             20438                                   SUBLK$(0)->O$BLK.NSUBLKS - 1;
     2374    20439    6                             INSTANCE_NAME = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->
             20439                                      O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;
     2375    20440    6                             FOUND = '0'B;
     2376    20441    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2377    20442    7                             DO K = 0 TO PC$HDR.CURINSTANCES - 1;
     2378    20443    7                                IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND
     2379    20444    7                                   NOT PC$INSTANCE.FLAGS.DELETED
     2380    20445    7                                   THEN    /* FOUND IT                           */
     2381    20446    8                                   DO;
     2382    20447    8                                      FOUND = '1'B;
     2383    20448    8                                      PC$INSTANCE.HDR.CNT = TEMP$->OUT$SYM.COUNT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:71   
     2384    20449    8                                      PC$INSTANCE.HDR.MSG = TEMP$->OUT$SYM.TEXT;
     2385    20450    8                                      PC$INSTANCE.FLAGS.HEADER =  (TEMP$->OUT$SYM.COUNT
             20450                                               > 0);
     2386    20451    8                                      TPHDR_TBL.HDR.CNT(K) = TEMP$->OUT$SYM.COUNT;
     2387    20452    8                                      TPHDR_TBL.HDR.MSG(K) = TEMP$->OUT$SYM.TEXT;
     2388    20453    8                                      TPHDR_TBL.FLAGS.PRESENT(K) =  (TEMP$->OUT$SYM.
             20453                                               COUNT > 0);
     2389    20454    8                                   END;    /* IF FOUND                           */
     2390    20455    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2391    20456    7                             END;          /* DO K                              */
     2392    20457    6                             IF NOT FOUND
     2393    20458    6                                THEN       /* BAD INSTANCE NAME                  */
     2394    20459    7                                DO;
     2395    20460    7                                   SUB_BUF_1.COUNT = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20460                                            SUBLK$(0)->
     2396    20461    7                                                     O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->
             20461                                                              OUT$SYM.COUNT;
     2397    20462    7                                   SUB_BUF_1.TEXT = INSTANCE_NAME;
     2398    20463    7                                   CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
     2399    20464    7                                END;       /* IF NOT FOUND                       */
     2400    20465    6                          END;  /* DO J */
     2401    20466    5                          ELSE             /* ALL                                */
     2402    20467    6                          DO;
     2403    20468    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2404    20469    7                             DO J = 0 TO PC$HDR.CURINSTANCES - 1;
     2405    20470    8                                IF NOT PC$INSTANCE.FLAGS.DELETED THEN DO;
     2406    20471    8                                   PC$INSTANCE.HDR.CNT = TEMP$->OUT$SYM.COUNT;
     2407    20472    8                                   PC$INSTANCE.HDR.MSG = TEMP$->OUT$SYM.TEXT;
     2408    20473    8                                   PC$INSTANCE.FLAGS.HEADER =  (TEMP$->OUT$SYM.COUNT >
             20473                                            0);
     2409    20474    8                                   TPHDR_TBL.HDR.CNT(J) = TEMP$->OUT$SYM.COUNT;
     2410    20475    8                                   TPHDR_TBL.HDR.MSG(J) = TEMP$->OUT$SYM.TEXT;
     2411    20476    8                                   TPHDR_TBL.FLAGS.PRESENT(J) =  (TEMP$->OUT$SYM.COUNT
             20476                                            > 0);
     2412    20477    8                                   END;  /* IF NOT DELETED */
     2413    20478    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2414    20479    7                                END;  /* DO J */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:72   
     2415    20480    6                             END;  /* ELSE */
     2416    20481    5                 END;                      /* DO CASE TP_PARAM                   */
     2417    20482    4   CLEANUP:      IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#
     2418    20483    4                    THEN CALL M$CLOSE(CLOSE_TP_FILE);
     2419    20484    5                 IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;
     2420    20485    5                    CALL M$RPRIV(FMS_PRIV) ALTRET(NEXT3);
     2421    20486    5              NEXT3:;
     2422    20487    5                    END;  /* IF */
     2423    20488    4               END;  /* DO CASE CODE */
     2424    20489    3   ENDLOOP:
     2425    20490    3              END;  /* DO I */
     2426    20491        /**/
     2427    20492    2   RESET_BREAK:
     2428    20493    2           CALL M$INT (BREAK_FPT);
     2429    20494    2           RETURN;
     2430    20495        /**/
     2431    20496    2   BAD_RES:
     2432    20497    2           CALL PCE$ERROR(%E$P_BADRES,3);
     2433    20498        /**/
     2434    20499    2   SET_ERR:
     2435    20500    2           ALTRETURN;
     2436    20501    2   NO_MEM:
     2437    20502    2           CALL PCE$ERROR(%E$P_BADTPFILE,3);
     2438    20503    2           ALTRETURN;
     2439    20504        /*E* ERROR: PCC-E$P_BADTPFILE-0
     2440    20505             MESSAGE: Unable to access TP control file.
     2441    20506             DESCRIPTION: See messages                   */
     2442    20507        /*E* ERROR: PCC-E$P_DUP_INSTANCE-0
     2443    20508             MESSAGE: Instance name %U1 is already defined.
     2444    20509             DESCRIPTION:  Duplicate instances not allowed.     */
     2445    20510        /*E* ERROR: PCC-E$P_BAD_INSTANCE_NAME-0
     2446    20511             MESSAGE: Instance name %U1 is not currently defined.
     2447    20512             MESSAGE1:Instance name needs to be defined using the SET command.
     2448    20513             DESCRIPTION: See messages                   */
     2449    20514        /**/
     2450    20515        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:73   
     2451    20516    2   SET_TIMEZONE: PROC ALTRET;
     2452    20517        /**/
     2453    20518    3           DCL OFFSET SBIN;
     2454    20519    3           DCL ACRONYM CHAR(4);
     2455    20520    3           DCL INBUF CHAR(8);
     2456    20521    3           DCL N$ PTR;
     2457    20522    3           DCL B$UBIN UBIN BASED;
     2458    20523        /**/
     2459    20524    3           SET_INDEXLO = 0;
     2460    20525    3           SET_INDEXHI = 0;
     2461    20526    3           N$ = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1);
     2462    20527    3           IF N$->O$BLK.NSUBLKS = 1 THEN
     2463    20528    3               INBUF = N$->O$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2464    20529    3           ELSE
     2465    20530    3               CALL CONCAT( INBUF,
     2466    20531    3                       N$->O$BLK.SUBLK$(0)->OUT$SYM.TEXT,
     2467    20532    3                       N$->O$BLK.SUBLK$(1)->OUT$SYM.TEXT);
     2468    20533    3           XUG_GETCMD.TEXT_ = VECTOR( INBUF);
     2469    20534    3           CALL XUG$GETCMD( XUG_GETCMD) ALTRET( OOPS);
     2470    20535    3           N$ = XUG_GETCMD.OUT$->O$BLK.SUBLK$(0);
     2471    20536    3           ACRONYM = '    ';
     2472    20537    3           CALL XST$TIMEZONE( N$, OFFSET, ACRONYM) ALTRET( OOPS);
     2473    20538    4           IF ACRONYM = '    ' THEN DO;
     2474    20539                    /* allow site-defined acronym if valid offset given */
     2475    20540    4               N$ = BLK$->O$BLK.SUBLK$(1);
     2476    20541    4               IF N$->O$BLK.NSUBLKS = 3 THEN
     2477    20542    4                   ACRONYM = N$->O$BLK.SUBLK$(2)->OUT$SYM.TEXT;
     2478    20543    4               END;
     2479    20544    3           VALUE = ADDR( ACRONYM)->B$UBIN;
     2480    20545    3           SET_PARAM = %PC_TIMEZONE;
     2481    20546    3           CALL SET_VALUE;
     2482    20547    3           VALUE = OFFSET;
     2483    20548    3           SET_PARAM = %PC_UTC_OFFSET;
     2484    20549    3           CALL SET_VALUE;
     2485    20550    3           RETURN;
     2486    20551    3   OOPS:
     2487    20552    3           ALTRETURN;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:74   
     2488    20553        /**/
     2489    20554    3           END SET_TIMEZONE;
     2490    20555        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:75   
     2491    20556    2   SET_VALUE: PROC;
     2492    20557        /**/
     2493    20558    3           VALUE = VALUE * (CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));
     2494    20559        /**/
     2495    20560    3           MONPTR$ = CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.PTR$(SET_PARAM);
     2496    20561    3           MONPTR.SEGID = BITBIN(%SPCL1SID);
     2497    20562    3           TEMPPTR.SEGID = BITBIN(%SPCL1SID);
     2498    20563        /**/
     2499    20564    3           PARAM$ = CAT$ -> CAT$TBL.PARAM$(SET_CAT);
     2500    20565        /**/
     2501    20566    4           DO CASE(SET_CAT);
     2502    20567
     2503    20568        /**/
     2504    20569    4            CASE(%PC_SYSTEM,%PC_EXCEPTION);
     2505    20570    5              DO J = SET_INDEXLO TO SET_INDEXHI;
     2506    20571    6                 IF (PARAM$ -> P$TBL.FLAGS.MINCONST(SET_PARAM)) THEN DO;
     2507    20572    6                    IF (VALUE < (PARAM$ -> P$TBL.MIN(SET_PARAM))*(PARAM$ ->
     2508    20573    7                      P$TBL.MULT(SET_PARAM))) THEN DO; /* VALUE TOO SMALL        */
     2509    20574    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PARAM$ -> P$TBL.MIN(SET_PARAM)
             20574                                );
     2510    20575    7                       GOTO SKIPSET;
     2511    20576    7                       END;
     2512    20577    6                    END;
     2513    20578    6                 ELSE DO;
     2514    20579    6                    TEMP$ = PARAM$ -> P$TBL.PTR$(PARAM$ -> P$TBL.MIN(SET_PARAM));
     2515    20580    6                    TEMPPTR.SEGID = BITBIN(%SPCL1SID);
     2516    20581    6                    IF (PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MIN(SET_PARAM)))AND
     2517    20582    7                      (VALUE < TEMP$ -> B$TABLE(J)) THEN DO;
     2518    20583    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,
     2519    20584    7                         (TEMP$ -> B$TABLE(J))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
     2520    20585    7                       GOTO SKIPSET;
     2521    20586    7                       END;
     2522    20587    6                    IF (NOT(PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MIN(SET_PARAM)))
             20587                             )AND
     2523    20588    7                      (VALUE < TEMP$ -> B$TABLE(0)) THEN DO;
     2524    20589    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,
     2525    20590    7                         (TEMP$ -> B$TABLE(0))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:76   
     2526    20591    7                       GOTO SKIPSET;
     2527    20592    7                       END;
     2528    20593    6                    END;
     2529    20594        /**/
     2530    20595    6                 IF (PARAM$ -> P$TBL.FLAGS.MAXCONST(SET_PARAM)) THEN DO;
     2531    20596    6                    IF (VALUE > (PARAM$ -> P$TBL.MAX(SET_PARAM))*(PARAM$ ->
     2532    20597    7                      P$TBL.MULT(SET_PARAM))) THEN DO; /* VALUE TOO BIG          */
     2533    20598    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PARAM$ -> P$TBL.MAX(SET_PARAM));
     2534    20599    7                       GOTO SKIPSET;
     2535    20600    7                       END;
     2536    20601    6                    END;
     2537    20602    6                 ELSE DO;
     2538    20603    6                    TEMP$ = PARAM$ -> P$TBL.PTR$(PARAM$ -> P$TBL.MAX(SET_PARAM));
     2539    20604    6                    TEMPPTR.SEGID = BITBIN(%SPCL1SID);
     2540    20605    6                    IF (PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MAX(SET_PARAM)))AND
     2541    20606    7                      (VALUE > TEMP$ -> B$TABLE(J)) THEN DO;
     2542    20607    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2543    20608    7                         (TEMP$ -> B$TABLE(J))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
     2544    20609    7                       GOTO SKIPSET;
     2545    20610    7                       END;
     2546    20611    6                    IF (NOT(PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MAX(SET_PARAM)))
             20611                             )AND
     2547    20612    7                      (VALUE > TEMP$ -> B$TABLE(0)) THEN DO;
     2548    20613    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2549    20614    7                         (TEMP$ -> B$TABLE(0))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
     2550    20615    7                       GOTO SKIPSET;
     2551    20616    7                       END;
     2552    20617    6                    END;
     2553    20618        /**/
     2554    20619    5                 CALL M$TIME (CUR_UTS);
     2555    20620    5                 IF (SET_CAT = %PC_SYSTEM) AND
     2556    20621    5                   (CURUTS >= %UTS_CUSP#) AND
     2557    20622    5                   (((SET_PARAM >= %PC_EXPTIME_LO) AND
     2558    20623    5                   (SET_PARAM <= %PC_EXPTIME_HI)) OR
     2559    20624    5                   (SET_PARAM = %PC_PROTECTSECLOG)) THEN /* 1/100 -> 1/25 */
     2560    20625    5                    MONPTR$ -> B$TABLE(J) = VALUE / 4;
     2561    20626    5                 ELSE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:77   
     2562    20627    5                   MONPTR$ -> B$TABLE(J) = VALUE;
     2563    20628        /**/
     2564    20629    5                 IF (SET_CAT = %PC_SYSTEM)AND
     2565    20630    6                   (SET_PARAM = %PC_NPART) THEN DO; /* SET JM_CHNG IF NPART*/
     2566    20631    6                    TEMP$ = ADDR(JM_CHNG);
     2567    20632    6                    TEMPPTR.SEGID = BITBIN(%SPCL1SID);
     2568    20633    7                    DO TEMP1 = 0 TO VALUE-1;
     2569    20634    7                       TEMP$ -> B$BITS(TEMP1) = YES;
     2570    20635    7                       END;
     2571    20636    6                    END;
     2572    20637        /**/
     2573    20638    5                 CALL M$OPEN(OPEN_CNTRL_FPT) ALTRET(CNTRL_ERR); /* UPDATE FILE   */
     2574    20639    5                 CALL M$WRITE(WRITE_CNTRL_FPT) ALTRET(CNTRL_ERR);
     2575    20640    5                 CALL M$CLOSE (CLOSE_CNTRL_FPT) ALTRET(CNTRL_ERR);
     2576    20641    5   SKIPSET:
     2577    20642    5                 END;
     2578    20643        /**/
     2579    20644    4            CASE(%PC_RESOURCE);
     2580    20645    5              DO J = SET_INDEXLO TO SET_INDEXHI;
     2581    20646    6                 IF (RES_INDX = %MMINDX) THEN DO; /* MEMORY IS SPECIAL            */
     2582    20647    6                    MONPTR$ = ADDR(FR_MEMM);
     2583    20648    6                    MONPTR.SEGID = BITBIN(%SPCL1SID);
     2584    20649    7                    IF (VALUE > MONPTR$ -> B$TABLE(0) AND J ~= 0) THEN DO;
     2585    20650    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2586    20651    7                         MONPTR$ -> B$TABLE(0));
     2587    20652    7                       GOTO RESSKIPSET;
     2588    20653    7                       END;
     2589    20654    6                    MONPTR$ -> B$TABLE(J) = VALUE;
     2590    20655    6                    END;
     2591    20656        /**/
     2592    20657    6                 ELSE IF (RES_INDX < %PSURES_OFFSET) THEN DO;
     2593    20658    6                       MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(SET_PARAM);
     2594    20659    6                       TEMPPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);
     2595    20660    6                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);
     2596    20661    7                       IF (VALUE > TEMP$ -> B$TABLE(RES_INDX-1)) THEN DO;
     2597    20662    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2598    20663    7                             TEMP$ -> B$TABLE(RES_INDX-1));
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:78   
     2599    20664    7                          GOTO RESSKIPSET;
     2600    20665    7                          END;
     2601    20666    6                       MONPTR$ -> B$TABLE(RES_INDX-1) = VALUE;
     2602    20667    6                       END;
     2603    20668        /**/
     2604    20669    6                    ELSE DO;
     2605    20670    6                       MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(SET_PARAM);
     2606    20671    6                       TEMPPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);
     2607    20672    6                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);
     2608    20673    7                       IF (VALUE > TEMP$ -> B$TABLE(RES_INDX - %PSURES_OFFSET)) THEN DO
             20673                                ;
     2609    20674    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2610    20675    7                            TEMP$ -> B$TABLE(RES_INDX-%PSURES_OFFSET));
     2611    20676    7                          GOTO RESSKIPSET;
     2612    20677    7                          END;
     2613    20678    6                       MONPTR$ -> B$TABLE(RES_INDX - %PSURES_OFFSET) = VALUE;
     2614    20679    6                       END;
     2615    20680        /**/
     2616    20681    5                 CALL M$OPEN(OPEN_CNTRL_FPT) ALTRET(CNTRL_ERR); /* UPDATE FILE   */
     2617    20682    5                 CALL M$WRITE(WRITE_CNTRL_FPT) ALTRET(CNTRL_ERR);
     2618    20683    5                 CALL M$CLOSE (CLOSE_CNTRL_FPT) ALTRET(CNTRL_ERR);
     2619    20684    5   RESSKIPSET:
     2620    20685    5                 END;
     2621    20686    4            CASE (%PC_PARTITION);
     2622    20687    5              DO J = SET_INDEXLO TO SET_INDEXHI;
     2623    20688    5                 SET_PDT$ = PINCRW(PDT$,SIZEW(JM$PT)*J);
     2624    20689    5                 SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*J);
     2625    20690    5                 MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*J);
     2626    20691        /**/
     2627    20692    6                 DO CASE(SET_PARAM);
     2628    20693        /**/
     2629    20694    6                  CASE (%PC_PMINTI);
     2630    20695    7                    IF (SET_PDTFLAG$ -> JM$PT.TU ~= 0) THEN DO;
     2631    20696    8                       IF (VALUE > SET_PDT$ -> JM$PT.TU) THEN DO;
     2632    20697    8                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2633    20698    8                            (SET_PDT$ -> JM$PT.TU)/PART$ -> P$TBL.MULT(%PC_PMINTI));
     2634    20699    8                          GOTO PARTSKIPSET;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:79   
     2635    20700    8                          END;
     2636    20701    7                       ELSE;
     2637    20702    7                       END;
     2638    20703    7                    ELSE IF (VALUE > MONPTR$ -> JM$PT.TU) THEN DO;
     2639    20704    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2640    20705    7                            (MONPTR$ -> JM$PT.TU)/PART$ -> P$TBL.MULT(%PC_PMINTI));
     2641    20706    7                          GOTO PARTSKIPSET;
     2642    20707    7                          END;
     2643    20708    6                    SET_PDT$ -> JM$PT.TL = VALUE;
     2644    20709    6                    SET_PDTFLAG$ -> JM$PT.TL = 1;
     2645    20710        /**/
     2646    20711    6                  CASE (%PC_PMAXTI);
     2647    20712    7                    IF (SET_PDTFLAG$ -> JM$PT.TL ~= 0) THEN DO;
     2648    20713    8                       IF (VALUE < SET_PDT$ -> JM$PT.TL) THEN DO;
     2649    20714    8                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,
     2650    20715    8                            (SET_PDT$ -> JM$PT.TL)/PART$ -> P$TBL.MULT(%PC_PMAXTI));
     2651    20716    8                          GOTO PARTSKIPSET;
     2652    20717    8                          END;
     2653    20718    7                       ELSE;
     2654    20719    7                       END;
     2655    20720    7                    ELSE IF (VALUE < MONPTR$ -> JM$PT.TL) THEN DO;
     2656    20721    7                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,
     2657    20722    7                            (MONPTR$ -> JM$PT.TL)/PART$ -> P$TBL.MULT(%PC_PMAXTI));
     2658    20723    7                          GOTO PARTSKIPSET;
     2659    20724    7                          END;
     2660    20725    6                    IF (VALUE > (PART$ -> P$TBL.MAX(%PC_PMAXTI))*
     2661    20726    7                      (PART$ -> P$TBL.MULT(%PC_PMAXTI))) THEN DO;
     2662    20727    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PMINTI));
     2663    20728    7                       GOTO PARTSKIPSET;
     2664    20729    7                       END;
     2665    20730    6                    SET_PDT$ -> JM$PT.TU = VALUE;
     2666    20731    6                    SET_PDTFLAG$ -> JM$PT.TU = 1;
     2667    20732        /**/
     2668    20733    6                  CASE (%PC_PMINRES);
     2669    20734    7                    IF (SET_PDTFLAG$ -> JM$PT.RMAX(RES_INDX) ~= 0) THEN DO;
     2670    20735    8                       IF (VALUE > SET_PDT$ -> JM$PT.RMAX(RES_INDX)) THEN DO;
     2671    20736    8                          TEMP1 = SET_PDT$ -> JM$PT.RMAX(RES_INDX);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:80   
     2672    20737    8                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,TEMP1);
     2673    20738    8                          GOTO PARTSKIPSET;
     2674    20739    8                          END;
     2675    20740    7                       ELSE;
     2676    20741    7                       END;
     2677    20742    7                    ELSE IF (VALUE > MONPTR$ -> JM$PT.RMAX(RES_INDX)) THEN DO;
     2678    20743    7                          TEMP1 = MONPTR$ -> JM$PT.RMAX(RES_INDX);
     2679    20744    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,TEMP1);
     2680    20745    7                          GOTO PARTSKIPSET;
     2681    20746    7                          END;
     2682    20747    6                    SET_PDT$ -> JM$PT.RMIN(RES_INDX) = VALUE;
     2683    20748    6                    SET_PDTFLAG$ -> JM$PT.RMIN(RES_INDX) = 1;
     2684    20749        /**/
     2685    20750    6                  CASE (%PC_PMAXRES);
     2686    20751    7                    IF (SET_PDTFLAG$ -> JM$PT.RMIN(RES_INDX) ~= 0) THEN DO;
     2687    20752    8                       IF (VALUE < SET_PDT$ -> JM$PT.RMIN(RES_INDX)) THEN DO;
     2688    20753    8                          TEMP1 = SET_PDT$ -> JM$PT.RMIN(RES_INDX);
     2689    20754    8                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,TEMP1);
     2690    20755    8                          GOTO PARTSKIPSET;
     2691    20756    8                          END;
     2692    20757    7                       ELSE;
     2693    20758    7                       END;
     2694    20759    7                    ELSE IF (VALUE < MONPTR$ -> JM$PT.RMIN(RES_INDX)) THEN DO;
     2695    20760    7                          TEMP1 = MONPTR$ -> JM$PT.RMIN(RES_INDX);
     2696    20761    7                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,TEMP1);
     2697    20762    7                          GOTO PARTSKIPSET;
     2698    20763    7                          END;
     2699    20764    7                    IF (RES_INDX = %MMINDX) THEN DO;
     2700    20765    8                       IF (VALUE > %PARTMMMAX) THEN DO;
     2701    20766    8                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,%PARTMMMAX);
     2702    20767    8                          GOTO PARTSKIPSET;
     2703    20768    8                          END;
     2704    20769    7                       END;
     2705    20770    7                    ELSE IF (RES_INDX < %PSURES_OFFSET) THEN DO;
     2706    20771    7                          MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(%PC_TOTRES);
     2707    20772    7                          MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);
     2708    20773    8                          IF (VALUE > MONPTR$ -> B$TABLE(RES_INDX -1)) THEN DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:81   
     2709    20774    8                             CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2710    20775    8                               MONPTR$ -> B$TABLE(RES_INDX-1));
     2711    20776    8                             GOTO PARTSKIPSET;
     2712    20777    8                             END;
     2713    20778    7                          ELSE;
     2714    20779    7                          END;
     2715    20780    7                       ELSE DO;
     2716    20781    7                          MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(%PC_TOTRES);
     2717    20782    7                          MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);
     2718    20783    8                          IF (VALUE > MONPTR$ -> B$TABLE(RES_INDX - %PSURES_OFFSET))
             20783                                   THEN DO;
     2719    20784    8                             CALL VAL_ERROR(%E$P_VALUE2BIG,J,
     2720    20785    8                               MONPTR$ -> B$TABLE(RES_INDX - %PSURES_OFFSET));
     2721    20786    8                             GOTO PARTSKIPSET;
     2722    20787    8                             END;
     2723    20788    7                          END;
     2724    20789    6                    SET_PDT$ -> JM$PT.RMAX(RES_INDX) = VALUE;
     2725    20790    6                    SET_PDTFLAG$ -> JM$PT.RMAX(RES_INDX) = 1;
     2726    20791    6                  CASE (%PC_PLOCK);
     2727    20792    7                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PLOCK))) THEN DO;
     2728    20793    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%PC_PLOCK))
             20793                                ;
     2729    20794    7                       GOTO PARTSKIPSET;
     2730    20795    7                       END;
     2731    20796    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PLOCK)) THEN DO;
     2732    20797    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PLOCK));
     2733    20798    7                       GOTO PARTSKIPSET;
     2734    20799    7                       END;
     2735    20800    6                    IF (VALUE = 0) THEN
     2736    20801    6                       SET_PDT$ -> JM$PT.FLG.LOCK = '0'B;
     2737    20802    6                    ELSE SET_PDT$ -> JM$PT.FLG.LOCK = '1'B;
     2738    20803    6                    SET_PDTFLAG$ -> JM$PT.FLG.LOCK = '1'B;
     2739    20804    6                  CASE (%PC_PQUAN);
     2740    20805    6                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PQUAN))*
     2741    20806    7                      (PART$ -> P$TBL.MULT(%PC_PQUAN))) THEN DO;
     2742    20807    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%PC_PQUAN))
             20807                                ;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:82   
     2743    20808    7                       GOTO PARTSKIPSET;
     2744    20809    7                       END;
     2745    20810    6                    IF (VALUE > (PART$ -> P$TBL.MAX(%PC_PQUAN))*
     2746    20811    7                      (PART$ -> P$TBL.MULT(%PC_PQUAN))) THEN DO;
     2747    20812    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PQUAN));
     2748    20813    7                       GOTO PARTSKIPSET;
     2749    20814    7                       END;
     2750    20815    6                    SET_PDT$ -> JM$PT.QUAN = VALUE;
     2751    20816    6                    SET_PDTFLAG$ -> JM$PT.QUAN = 1;
     2752    20817    6                  CASE (%PC_PPRIO);
     2753    20818    7                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PPRIO))) THEN DO;
     2754    20819    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%PC_PPRIO))
             20819                                ;
     2755    20820    7                       GOTO PARTSKIPSET;
     2756    20821    7                       END;
     2757    20822    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PPRIO)) THEN DO;
     2758    20823    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PPRIO));
     2759    20824    7                       GOTO PARTSKIPSET;
     2760    20825    7                       END;
     2761    20826    6                    SET_PDT$ -> JM$PT.XPRIO = VALUE;
     2762    20827    6                    SET_PDTFLAG$ -> JM$PT.XPRIO = 1;
     2763    20828    6                  CASE (%PC_PMAXACCT);
     2764    20829    7                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PMAXACCT))) THEN DO;
     2765    20830    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%
             20830                                PC_PMAXACCT));
     2766    20831    7                       GOTO PARTSKIPSET;
     2767    20832    7                       END;
     2768    20833    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PMAXACCT)) THEN DO;
     2769    20834    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PMAXACCT)
             20834                                );
     2770    20835    7                       GOTO PARTSKIPSET;
     2771    20836    7                       END;
     2772    20837    6                    SET_PDT$ -> JM$PT.MAX1ACCT = VALUE;
     2773    20838    6                    SET_PDTFLAG$ -> JM$PT.MAX1ACCT = 1;
     2774    20839    6                  CASE (%PC_PJMAX);
     2775    20840    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PJMAX)) THEN DO;
     2776    20841    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PJMAX));
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:83   
     2777    20842    7                       GOTO PARTSKIPSET;
     2778    20843    7                       END;
     2779    20844    6                    SET_PDT$ -> JM$PT.MAX = VALUE;
     2780    20845    6                    SET_PDTFLAG$ -> JM$PT.MAX = 1;
     2781    20846        /**/
     2782    20847    6   PARTSKIPSET:
     2783    20848    6                  END;
     2784    20849    5                 END;
     2785    20850    4              VALUE = VALUE/(CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));
     2786    20851    4              RETURN;
     2787    20852        /**/
     2788    20853    4   CNTRL_ERR:
     2789    20854    4              CALL PCE$ERROR(0,3);
     2790    20855    4              CALL PCE$ERROR(%E$P_CNTRLERR,3);
     2791    20856    4              VALUE = VALUE/(CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));
     2792    20857    4              RETURN;
     2793    20858        /**/
     2794    20859        /*E*     ERROR:    PCC-E$P_CNTRLERR-0
     2795    20860                 MESSAGE:  Error updating :CNTRL file - table changes not saved
     2796    20861                 MESSAGE1: CONTROL received an error while trying to update the
     2797    20862                           :CNTRL file - the last chages made via SET and STORE
     2798    20863                           will not be saved accross a recovery.
     2799    20864                 DESCRIPTION: ERRORS ON :CNTRL - TABLES NOT SAVED */
     2800    20865    4            END;
     2801    20866    3            VALUE = VALUE/(CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));
     2802    20867        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:84   
     2803    20868        /**/
     2804    20869    3   VAL_ERROR: PROC(ERR#,INDX,LIMIT);
     2805    20870        /**/
     2806    20871    4   DCL ERR# SBIN WORD;
     2807    20872    4   DCL INDX SBIN WORD;
     2808    20873    4   DCL LIMIT SBIN WORD;
     2809    20874        /**/
     2810    20875    4   DCL TEMPTEXT CHAR(12) AUTO;
     2811    20876    4   DCL TEMPTEXT_ARRAY(0:11) REDEF TEMPTEXT CHAR(1);
     2812    20877        /**/
     2813    20878    4           SUB_BUF_1.COUNT = PARAM$ -> P$TBL.TEXT.COUNT(SET_PARAM);
             20878                    /* SET SUB_BUF_1 PARAM NAME */
     2814    20879    4           CALL INSERT(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT,PARAM$ -> P$TBL.TEXT.TEXT(
             20879                    SET_PARAM));
     2815    20880        /**/
     2816    20881    5           IF (PARAM$ -> P$TBL.FLAGS.RES(SET_PARAM)) THEN DO; /* ADD RESOURCE    */
     2817    20882    5              CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);
     2818    20883    5              CALL INSERT(SUB_BUF_1.TEXT,SUB_BUF_1.COUNT,RESTEXT_C.COUNT,
     2819    20884    5                RESTEXT_C.TEXT);
     2820    20885    5              SUB_BUF_1.COUNT = SUB_BUF_1.COUNT + RESTEXT_C.COUNT;
     2821    20886    5              END;
     2822    20887        /**/
     2823    20888    5           IF (PARAM$ -> P$TBL.FLAGS.INDX(SET_PARAM)) THEN DO; /* ADD INDEX TEXT */
     2824    20889    5              CALL INSERT(SUB_BUF_1.TEXT,SUB_BUF_1.COUNT,,'(',
     2825    20890    5                SUBSTR(PARAM$ -> P$TBL.PTR$(0) -> TEXTC$INDX.TEXT(INDX),0,
     2826    20891    5                PARAM$ -> P$TBL.PTR$(0) -> TEXTC$INDX.COUNT(INDX)),')');
     2827    20892    5              SUB_BUF_1.COUNT = SUB_BUF_1.COUNT + PARAM$ -> P$TBL.PTR$(0) ->
     2828    20893    5                TEXTC$INDX.COUNT(INDX) + 2;
     2829    20894    5              END;
     2830    20895        /**/
     2831    20896    4           CALL BINCHAR(TEMPTEXT,LIMIT);   /* SET SUB_BUF_2 WITH LIMIT TEXT      */
     2832    20897        /**/
     2833    20898    4           K = 0;
     2834    20899    5           DO WHILE ((K < SIZEC(TEMPTEXT)-1)AND(TEMPTEXT_ARRAY(K) = '0'));
     2835    20900    5              K = K+1;
     2836    20901    5              END;
     2837    20902    4           SUB_BUF_2.COUNT = SIZEC(TEMPTEXT)-K;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:85   
     2838    20903    4           SUB_BUF_2.TEXT = SUBSTR(TEMPTEXT,K,SIZEC(TEMPTEXT)-K+1);
     2839    20904        /**/
     2840    20905    4           CALL PCE$ERROR(ERR#,3);         /* PRINT MESSAGE                      */
     2841    20906    4           RETURN;
     2842    20907        /**/
     2843    20908        /*E*     ERROR:    PCC-E$P_VALUE2SMALL-0
     2844    20909                 MESSAGE:  Value for %U1 is too small - %U2 is the minimum
     2845    20910                 DESCRIPTION: VALUE SPECIFIED IS BELOW LEGAL MINIMUM */
     2846    20911        /**/
     2847    20912        /*E*     ERROR:    PCC-E$P_VALUE2BIG-0
     2848    20913                 MESSAGE:  Value for %U1 is too big - %U2 is maximum
     2849    20914                 DESCRIPTION: VALUE LARGER THAN LEGAL MAXIMUM SPECIFIED */
     2850    20915    4   END VAL_ERROR;
     2851    20916    3   END SET_VALUE;
     2852    20917        /**/
     2853    20918    2   END EXEC_SET;
     2854    20919        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:86   
     2855    20920    1   GBLK: PROC(BLK$,SIZE) ALTRET;
     2856    20921    2   DCL BLK$ PTR;
     2857    20922    2   DCL SIZE SBIN WORD;
     2858    20923        /**/
     2859    20924    3           DO WHILE(WORDS_AVAIL < SIZE);
     2860    20925    3              CALL M$EXTEND(EXTEND_TP_FILE) ALTRET(NO_MEM);
     2861    20926    3              WORDS_AVAIL = WORDS_AVAIL + %WORDS_PER_GRAN;
     2862    20927    3           END;                            /* DO WHILE                           */
     2863    20928    2           BLK$ = TABLE$;
     2864    20929    2           TABLE$ = PINCRW(TABLE$,SIZE);
     2865    20930    2           WORDS_AVAIL = WORDS_AVAIL - SIZE;
     2866    20931    2           RETURN;
     2867    20932    2   NO_MEM: ALTRETURN;
     2868    20933    2   END GBLK;
     2869    20934        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:87   
     2870    20935    1   EXEC_DELETE: PROC;
     2871    20936        /**/
     2872    20937    3        DO SELECT(P_PCB.OUT$->O$BLK.SUBLK$(0)->O$BLK.CODE);
     2873    20938    3           SELECT(%PC_TPINSTANCE);
     2874    20939    3              CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(CANT_OPEN);
     2875    20940    3              PTR$ = P_PCB.OUT$->O$BLK.SUBLK$(1);
     2876    20941    4              DO I = 0 TO PTR$->O$BLK.NSUBLKS - 1;
     2877    20942    4                 INSTANCE_NAME = PTR$->O$BLK.SUBLK$(I)->OUT$SYM.TEXT;
     2878    20943    4                 SUB_BUF_1.COUNT = PTR$->O$BLK.SUBLK$(I)->OUT$SYM.COUNT;
     2879    20944    4                 SUB_BUF_1.TEXT = INSTANCE_NAME;
     2880    20945    4                 INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));
     2881    20946    4                 FOUND = NO;
     2882    20947    5                 DO J = 0 TO PC$HDR.CURINSTANCES - 1;
     2883    20948    5                    IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND
     2884    20949    6                       NOT PC$INSTANCE.FLAGS.DELETED THEN DO;
     2885    20950    6                       FOUND = YES;
     2886    20951    6                       DELINDX = J;
     2887    20952    6                       END;  /* IF INSTANCE_NAME = INSTANCE_NAME */
     2888    20953    5                    INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2889    20954    5                    END;  /* DO J */
     2890    20955    5                 IF NOT FOUND THEN DO;
     2891    20956    5                    CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
     2892    20957    5                    GOTO END_I_LOOP;
     2893    20958    5                    END;  /* IF NOT FOUND */
     2894    20959    4                 INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR) + (DELINDX * SIZEW(PC$INSTANCE
             20959                          )));
     2895    20960    5                 IF PC$INSTANCE.FLAGS.ACTIVE THEN DO;
     2896    20961    5                    CALL PCE$ERROR(%E$P_ACTIVE_TPI,3);
     2897    20962    5                    END;  /* IF ACTIVE */
     2898    20963    5                 ELSE DO;
     2899    20964    5                    PC$INSTANCE.FLAGS.DELETED = '1'B;
     2900    20965    5                    MAXTPU_TBL.FLAGS.DELETED(DELINDX) = '1'B;
     2901    20966    5                    TPHDR_TBL.FLAGS.PRESENT(DELINDX) = '0'B;
     2902    20967    5                    PC$INSTANCE.FLAGS.HEADER = '0'B;
     2903    20968    5                    CALL PCE$ERROR(%E$P_TPI_DELETED,1);
     2904    20969    5                    CURINSTANCES = CURINSTANCES - 1;
     2905    20970    5                    END;  /* ELSE */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:88   
     2906    20971
     2907    20972                      /*E* ERROR: PCC-E$P_ACTIVE_TPI-0
     2908    20973                           MESSAGE: Instance name %U1 is active - cannot delete.
     2909    20974                           MESSAGE1: An active instance of TP cannot be deleted.
     2910    20975                           DESCRIPTION: See messages            */
     2911    20976                      /*E* ERROR: PCC-E$P_TPI_DELETED-0
     2912    20977                           MESSAGE: Instance name %U1 deleted.
     2913    20978                            DESCRIPTION: TP instance successfully deleted. */
     2914    20979    4         END_I_LOOP:;
     2915    20980    4                 END;  /* DO I */
     2916    20981    3              IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#
     2917    20982    3                 THEN CALL M$CLOSE(CLOSE_TP_FILE);
     2918    20983    3              RETURN;
     2919    20984    3         CANT_OPEN:;
     2920    20985    3              IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE
     2921    20986    3                 THEN CALL PCE$ERROR(%E$P_NOTPI,0);
     2922    20987    3                 ELSE CALL PCE$ERROR(%E$P_BADTPFILE,3);
     2923    20988                   /*E* ERROR: PCC-E$P_NOTPI-0
     2924    20989                        MESSAGE: No TP instances currently defined.
     2925    20990                        DESCRIPTION: See message.     */
     2926    20991    3              IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#
     2927    20992    3                 THEN CALL M$CLOSE(CLOSE_TP_FILE);
     2928    20993    3           END;  /* DO SELECT */
     2929    20994    2        RETURN;
     2930    20995    2   END EXEC_DELETE;
     2931    20996        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:89   
     2932    20997        /**/
     2933    20998    1   EXEC_LIST: PROC ALTRET;
     2934    20999        /**/
     2935    21000    2           TEMP$ = DCBADDR(DCBNUM(M$LO));
     2936    21001    2           IF (TEMP$ -> F$DCB.ASN# = %DEVICE#) THEN I = TEMP$ -> F$DCB.WIDTH#;
     2937    21002    2           ELSE I = 80;
     2938    21003        /**/
     2939    21004    2           MAX_CLMN = (I/%CLMN_WIDTH) - 1;
     2940    21005        /**/
     2941    21006    3           IF (MAX_CLMN < 0) THEN DO;
     2942    21007    3              CALL PCE$ERROR (%E$P_PLATEN2SMALL,2);
     2943    21008    3              ALTRETURN;
     2944    21009    3              END;
     2945    21010        /**/
     2946    21011        /*E*     ERROR:    PCC-E$P_PLATEN2SMALL-0
     2947    21012                 MESSAGE:  Your platen setting is too small
     2948    21013                 DESCRIPTION: USER HAS SET PLATEN SO SMALL THAT EVEN ONE COLUMN
     2949    21014                                WONT FIT.                          */
     2950    21015        /**/
     2951    21016    2           CUR_CLMN = 0;
     2952    21017        /**/
     2953    21018    3           DO J = 1 TO %PC_MAXCATAGORY;
     2954    21019    3              IF (CAT$ -> CAT$TBL.FLAGS.PRINT(J)) THEN
     2955    21020    3                 CALL LIST_PRINT(%PC_ADDTEXT,TEXTC_CAT(J)) ALTRET (LIST_ERR);
     2956    21021    3              END;
     2957    21022        /**/
     2958    21023    2           CALL LIST_PRINT(%PC_FLUSH) ALTRET (LIST_ERR);
     2959    21024        /**/
     2960    21025    3           DO J = 1 TO %PC_MAXMODE;
     2961    21026    3              IF (INDEX_FLGS.MODE(J)) THEN
     2962    21027    3                 CALL LIST_PRINT(%PC_ADDTEXT,TEXTC_MODE(J)) ALTRET (LIST_ERR);
     2963    21028    3              END;
     2964    21029        /**/
     2965    21030    2           CALL LIST_PRINT(%PC_FLUSH) ALTRET (LIST_ERR);
     2966    21031        /**/
     2967    21032    3           IF (INDEX_FLGS.PART#) THEN DO;
     2968    21033    3              PRINT_BUF = 'PART#(';
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:90   
     2969    21034    3              I = 6;
     2970    21035    4              DO J = 0 TO 15;
     2971    21036    5                 IF (INDEX_FLGS.PART#(J)) THEN DO;
     2972    21037    6                    IF (I ~= 6) THEN DO;
     2973    21038    6                       CALL INSERT(PRINT_BUF,I,1,',');
     2974    21039    6                       I = I+1;
     2975    21040    6                       END;
     2976    21041    5                    CALL INSERT(PRINT_BUF,I,TEXTC_PART#X.COUNT(J),
     2977    21042    5                      TEXTC_PART#X.TEXT(J));
     2978    21043    5                    I = I + TEXTC_PART#X.COUNT(J);
     2979    21044    5                    END;
     2980    21045    4                 END;
     2981    21046    3              CALL INSERT(PRINT_BUF,I,1,')');
     2982    21047    3              I = I + 1;
     2983    21048    3              CALL PCW$WRITE(PRINT_BUF,I) ALTRET(LIST_ERR);
     2984    21049    3              PRINT_BUF = ' ';
     2985    21050    3              END;
     2986    21051        /**/
     2987    21052    3           DO J = 1 TO %PC_MAXDOMAIN;
     2988    21053    3              IF (INDEX_FLGS.DOMAINE(J)) THEN
     2989    21054    3                 CALL LIST_PRINT(%PC_ADDTEXT,TEXTC_DOMAIN(J)) ALTRET(LIST_ERR);
     2990    21055    3              END;
     2991    21056        /**/
     2992    21057    2           CALL LIST_PRINT(%PC_FLUSH) ALTRET (LIST_ERR);
     2993    21058        /**/
     2994    21059    3           DO J = 1 TO %PC_MAXCATAGORY;     /* CHECK INDIVIDUAL PARAMETERS        */
     2995    21060    4              DO K = 1 TO CAT$ -> CAT$TBL.MAXPARAM(J);
     2996    21061        /**/
     2997    21062    4                 IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.FLAGS.RES(K)) THEN
     2998    21063    5                 DO RES_INDX = 0 TO NUM_PSURES + %PSURES_OFFSET-1;
     2999    21064        /**/
     3000    21065    5                    IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.RESPTR$(K)
     3001    21066    6                      -> RES$FLGS(RES_INDX)) THEN DO;
     3002    21067    6                       TEXT_C = CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.TEXT(K);
     3003    21068    6                       CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);
     3004    21069    6                       CALL INSERT(TEXT_C.TEXT,TEXT_C.COUNT,
     3005    21070    6                         RESTEXT_C.COUNT,RESTEXT_C.TEXT);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:91   
     3006    21071    6                       TEXT_C.COUNT = TEXT_C.COUNT + RESTEXT_C.COUNT;
     3007    21072        /**/
     3008    21073    6                       CALL LIST_PRINT(%PC_ADDTEXT,TEXT_C) ALTRET (LIST_ERR);
     3009    21074        /**/
     3010    21075    6                       END;
     3011    21076    5                    END;
     3012    21077    5                 ELSE DO;
     3013    21078    5                    IF (J = %PC_TP AND K = %PC_MAXTPU AND CAT$->CAT$TBL.PARAM$(J)->
             21078                             P$TBL.MAX(K) ~= 0
     3014    21079    5                       AND NOT TP_TBL.MAXTPU.FLAGS.PRINT)
     3015    21080    6                       THEN DO L = 0 TO 71;
     3016    21081    7                          IF MAXTPU_TBL.FLAGS.PRINT(L) THEN DO;
     3017    21082    7                             TEXT_C.COUNT = MAXTPU_TBL.COUNT(L) + 8;
     3018    21083    7                             CALL INSERT(MAXTPU_BUF,7,MAXTPU_TBL.COUNT(L)+1,
     3019    21084    7                                      SUBSTR(MAXTPU_TBL.NAME(L),0,MAXTPU_TBL.COUNT(L)),
             21084                                               ')');
     3020    21085    7                             TEXT_C.TEXT = MAXTPU_BUF;
     3021    21086    7                             CALL LIST_PRINT(%PC_ADDTEXT,TEXT_C) ALTRET(LIST_ERR);
     3022    21087    7                             END;  /* IF PRINT */
     3023    21088    6                          END;  /* DO L */
     3024    21089    6                       ELSE DO;
     3025    21090    6                          IF (CAT$->CAT$TBL.PARAM$(J)->P$TBL.FLAGS.PRINT(K))
     3026    21091    6                             THEN CALL LIST_PRINT(%PC_ADDTEXT,CAT$->CAT$TBL.PARAM$(J)->
             21091                                      P$TBL.TEXT(K)) ALTRET(LIST_ERR);
     3027    21092    6                          END;  /* ELSE */
     3028    21093    5                       END;  /* ELSE */
     3029    21094    4                 END;
     3030    21095    3              END;
     3031    21096        /**/
     3032    21097    2           CALL LIST_PRINT(%PC_FLUSH);
     3033    21098        /**/
     3034    21099    2           RETURN;
     3035    21100        /**/
     3036    21101    2   LIST_ERR:
     3037    21102    2           ALTRETURN;
     3038    21103        /**/
     3039    21104        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:92   
     3040    21105        /**/
     3041    21106    2   LIST_PRINT: PROC (PRINT_FLAG,TEXT_C) ALTRET;
     3042    21107        /**/
     3043    21108    3   DCL PRINT_FLAG UBIN WORD;
     3044    21109    3   DCL 1 TEXT_C,
     3045    21110    3         2 COUNT UBIN(9) UNAL,
     3046    21111    3         2 TEXT CHAR(19) UNAL;
     3047    21112        /**/
     3048    21113    4           IF (ADDR(TEXT_C) ~= ADDR(NIL)) THEN DO; /* SOMETHING TO PRINT         */
     3049    21114    5              IF (CUR_CLMN + TEXT_C.COUNT/%CLMN_WIDTH) > MAX_CLMN THEN DO;
     3050    21115    5                 CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH)
     3051    21116    5                   ALTRET (PRINT_ERR);
     3052    21117    5                 CUR_CLMN = 0;
     3053    21118    5                 PRINT_BUF = ' ';
     3054    21119    5                 END;
     3055    21120        /**/
     3056    21121    4              CALL INSERT(PRINT_BUF,CUR_CLMN*%CLMN_WIDTH,TEXT_C.COUNT,TEXT_C.TEXT);
     3057    21122        /**/
     3058    21123    4              CUR_CLMN = CUR_CLMN + ((TEXT_C.COUNT/%CLMN_WIDTH)+1);
     3059    21124    4              END;
     3060    21125        /**/
     3061    21126    4           IF (PRINT_FLAG = %PC_FLUSH)AND(CUR_CLMN ~= 0) THEN DO;
     3062    21127    4              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET(PRINT_ERR);
     3063    21128    4              CUR_CLMN = 0;
     3064    21129    4              PRINT_BUF = ' ';
     3065    21130    4              END;
     3066    21131        /**/
     3067    21132    3           RETURN;
     3068    21133        /**/
     3069    21134    3   PRINT_ERR:
     3070    21135    3           ALTRETURN;
     3071    21136    3   END LIST_PRINT;
     3072    21137    2   END EXEC_LIST;
     3073    21138        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:93   
     3074    21139        /**/
     3075    21140    1   EXEC_STORE: PROC ALTRET;
     3076    21141        /**/
     3077    21142    3           IF NOT(PC$JIT$ -> B$JIT.PRIV.ACTIVE & %PR_EXMM#) THEN DO;
     3078    21143    3              CALL PCE$ERROR(%E$P_CANTSTORE,3);
     3079    21144    3              ALTRETURN;
     3080    21145    3              END;
     3081    21146        /**/
     3082    21147        /*E*     ERROR:    PCC-E$P_CANTSTORE-0
     3083    21148                 MESSAGE:  You are not allowed to STORE values
     3084    21149                 DESCRIPTION: INSUFFICIENT PRIVILEGE    */
     3085    21150        /**/
     3086    21151    2           CALL M$INT(BREAKSET_FPT);
     3087    21152        /**/
     3088    21153    2           MONPTR$ = ADDR(JM_LOCK);        /* LOCK TABLES                        */
     3089    21154    2           MONPTR.SEGID = BITBIN(%SPCL1SID);
     3090    21155    3           DO WHILE('0'B);  /* DO NEVER */
     3091    21156    3   WAIT:      CALL M$WAIT(FPT_WAIT);
     3092    21157    3              END;  /* DO NEVER */
     3093    21158    2           CALL JMN$LOCK(MONPTR$ -> B$TABLE(0)) ALTRET(WAIT);
     3094    21159        /**/
     3095    21160    2           TEMP$ = ADDR(JM_CHNG);
     3096    21161    2           TEMPPTR.SEGID = BITBIN(%SPCL1SID);
     3097    21162        /**/
     3098    21163    3           DO I = 0 TO 15;
     3099    21164    3              MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*I);
     3100    21165    3              SET_PDT$ = PINCRW(PDT$,SIZEW(JM$PT)*I);
     3101    21166    3              SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*I);
     3102    21167        /**/
     3103    21168    4              IF (SET_PDTFLAG$ -> JM$PT ~= NO) THEN DO; /* SOMETHING TO STORE    */
     3104    21169    4                 TEMP$ -> B$BITS(I) = YES; /* SET JM_CHNG                        */
     3105    21170        /**/
     3106    21171    5                 IF (SET_PDTFLAG$ -> JM$PT.TL ~= 0) THEN DO;
     3107    21172    5                    MONPTR$ -> JM$PT.TL = SET_PDT$ -> JM$PT.TL;
     3108    21173    5                    END;
     3109    21174        /**/
     3110    21175    5                 IF (SET_PDTFLAG$ -> JM$PT.TU ~= 0) THEN DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:94   
     3111    21176    5                    MONPTR$ -> JM$PT.TU = SET_PDT$ -> JM$PT.TU;
     3112    21177    5                    END;
     3113    21178        /**/
     3114    21179    5                 DO J = 0 TO NUM_PSURES + %PSURES_OFFSET-1;
     3115    21180    6                    IF (SET_PDTFLAG$ -> JM$PT.RMIN(J) ~= 0) THEN DO;
     3116    21181    6                       MONPTR$ -> JM$PT.RMIN(J) = SET_PDT$ -> JM$PT.RMIN(J);
     3117    21182    6                       END;
     3118    21183        /**/
     3119    21184    6                    IF (SET_PDTFLAG$ -> JM$PT.RMAX(J) ~= 0) THEN DO;
     3120    21185    6                       MONPTR$ -> JM$PT.RMAX(J) = SET_PDT$ -> JM$PT.RMAX(J);
     3121    21186    6                       END;
     3122    21187    5                    END;
     3123    21188        /**/
     3124    21189    5                 IF (SET_PDTFLAG$ -> JM$PT.FLG.LOCK ~= '0'B) THEN DO;
     3125    21190    5                    MONPTR$ -> JM$PT.FLG.LOCK = SET_PDT$ -> JM$PT.FLG.LOCK;
     3126    21191    5                    END;
     3127    21192    5                 IF (SET_PDTFLAG$ -> JM$PT.QUAN ~= 0) THEN DO;
     3128    21193    5                    MONPTR$ -> JM$PT.QUAN = SET_PDT$ -> JM$PT.QUAN;
     3129    21194    5                    END;
     3130    21195        /**/
     3131    21196    5                 IF (SET_PDTFLAG$ -> JM$PT.XPRIO ~= 0) THEN DO;
     3132    21197    5                    MONPTR$ -> JM$PT.XPRIO = SET_PDT$ -> JM$PT.XPRIO;
     3133    21198    5                    END;
     3134    21199        /**/
     3135    21200    5                 IF (SET_PDTFLAG$ -> JM$PT.MAX1ACCT ~= 0) THEN DO;
     3136    21201    5                    MONPTR$ -> JM$PT.MAX1ACCT = SET_PDT$ -> JM$PT.MAX1ACCT;
     3137    21202    5                    END;
     3138    21203        /**/
     3139    21204    5                 IF (SET_PDTFLAG$ -> JM$PT.MAX ~= 0) THEN DO;
     3140    21205    5                    MONPTR$ -> JM$PT.MAX = SET_PDT$ -> JM$PT.MAX;
     3141    21206    5                    END;
     3142    21207    4                 END;
     3143    21208    3              END;
     3144    21209        /**/
     3145    21210    2           MONPTR$ = ADDR(JM_LOCK);        /* UNLOCK TABLES                      */
     3146    21211    2           MONPTR.SEGID = BITBIN(%SPCL1SID);
     3147    21212    2           CALL JMN$UNLOCK(MONPTR$ -> B$TABLE(0));
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:95   
     3148    21213        /**/
     3149    21214    2           CALL M$OPEN(OPEN_CNTRL_FPT) ALTRET(CNTRL_ERR); /* UPDATE FILE         */
     3150    21215    2           CALL M$WRITE(WRITE_CNTRL_FPT) ALTRET(CNTRL_ERR);
     3151    21216    2           CALL M$CLOSE (CLOSE_CNTRL_FPT) ALTRET(CNTRL_ERR);
     3152    21217        /**/
     3153    21218    2   CLEANUP:
     3154    21219    2           CALL M$INT(BREAK_FPT);
     3155    21220        /**/
     3156    21221    2   EXEC_CLEAR: ENTRY ALTRET;
     3157    21222        /**/
     3158    21223    3           DO I = 0 TO 15;
     3159    21224    3              SET_PDT$ = PINCRW(PDT$,SIZEW(JM$PT)*I);
     3160    21225    3              SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*I);
     3161    21226        /**/
     3162    21227    3              SET_PDT$ -> JM$PT = NO;
     3163    21228    3              SET_PDTFLAG$ -> JM$PT = NO;
     3164    21229    3              END;
     3165    21230        /**/
     3166    21231    2           RETURN;
     3167    21232        /**/
     3168    21233    2   CNTRL_ERR:
     3169    21234    2           CALL M$CLOSE (CLOSE_CNTRL_FPT);
     3170    21235    2           CALL PCE$ERROR(0,3);
     3171    21236    2           CALL PCE$ERROR(%E$P_CNTRLERR,3);
     3172    21237    2           GOTO CLEANUP;
     3173    21238        /**/
     3174    21239    2   END EXEC_STORE;
     3175    21240        /**/
     3176    21241        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:96   
     3177    21242        /**/
     3178    21243        /**/
     3179    21244    1   END PCC$CONTROL;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:97   
--  Include file information  --

   IG_CNTRLNR_R.:E05TOU  cannot be made into a system file and is referenced.
   UQ_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   UMT_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   MM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JZ_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   ES_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FO_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FT_SUBS.:E05TOU  is referenced.
   FT_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   JM_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   FM_CACHE_C.:E05TOU  is referenced.
   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:98   
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCC$CONTROL.

   Procedure PCC$CONTROL requires 6038 words for executable code.
   Procedure PCC$CONTROL requires 74 words of local(AUTO) storage.

    No errors detected in file PCC$CONTROL.:E05TSI    .

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:99   

 Object Unit name= PCC$CONTROL                                File name= PCC$CONTROL.:E05TOU
 UTS= JUL 30 '97 04:19:22.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none  4848  11360  PCC$CONTROL
    2  RoData even  UTS     64    100  PCC$CONTROL
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$DO
    6   DCB   even  none     0      0  M$CNTRL
    7   DCB   even  none     0      0  M$TP
    8   DCB   even  none     0      0  M$HEAD
    9   Proc  even  none  6038  13626  PCC$CONTROL
   10  RoData even  none   160    240  PCC$CONTROL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Main       0  PCC$CONTROL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:100  

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  CAT$                               1      1  SYSTEM$
    1      2  PART$                              1      3  RES$
    1      4  EX$                                1      5  TP$
    1      6  PC_REASON                          1     10  MONPTR$
    1     11  MONPART$                           1     12  NUM_PSURES
    1     13  LAST_CMD                           1     31  CURINSTANCES
    1     32  TBLINSTANCES                       1     34  TPSYS
    1     36  REMEM_CMD_READ                     1     40  RES_TEXT
    1     42  PSURES_TEXT                        1     63  CMD_BUF
    1    163  MAX_CLMN                           1    164  CUR_CLMN
    1    165  PRINT_BUF                          1    226  INDEX_FLGS
    1    227  PART#_FLGS                         1   1702  PDT$
    1   1703  PDTFLAG$                           1   2422  TEXTC_PART#X
    1   2446  TEXTC_CAT                          1   2472  TEXTC_MODE
    1   2511  TEXTC_DOMAIN                       1   2521  TEXT_C
    1   2526  RESTEXT_C                          1   4557  MAXTPU_TBL
    1   5217  TPHDR_TBL                          1  11352  BYE_BYE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:101  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XTX$ADAPT
         yes          ~proc      0 B_POINTER
 yes     yes           Std       2 PCW$WRITE
 yes     yes           Std       6 XUR$GETCMD
 yes     yes           Std       2 PCE$ERROR
         yes          ~proc      0 XST_NODES
         yes          Async      0 PCB$BREAK
         yes          Async      0 PCB$BREAKSET
         yes          Async      0 PCB$TRAP
 yes     yes           Std       3 XUR$INIT
 yes     yes           Std       2 XUG$INIT
 yes     yes           Std       7 XUR$ERRMSG
 yes     yes           Std       1 PCT$SYSTEM
 yes     yes           Std       1 PCT$EXCEPTION
 yes     yes           Std       1 PCT$RESOURCE
 yes     yes           Std       1 PCT$PARTITION
 yes     yes           Std       2 PCT$TPCAT
 yes     yes           Std       1 PCP$PDISP
         yes           Std      22 X$WRITE
 yes     yes           Std       1 XUG$GETCMD
 yes     yes           Std       3 XST$TIMEZONE
         yes           Std       2 PCR$RESTEXT
         yes           Std       1 JMN$UNLOCK
 yes     yes           Std       1 JMN$LOCK
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MAUTO
                       nStd      0 X66_INDEX
                       nStd      0 X66_MARET
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:102  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VERSION                             XST_TIMEZONE
     M$SI                                  M$LO                                  M$DO
     M$CNTRL                               M$TP                                  M$HEAD
     PCN_CMDS                              B$JIT$                                B$DS5$
     B$TCB$                                SUB_BUF_1                             SUB_BUF_2
     JM_LOCK                               JM_CHNG                               S_CUIS
     S_MUIS                                S_CTUIS                               S_TUIS
     S_PRIOB                               SL_MF                                 SL_MFU
     SL_IOTA                               SL_QUAN                               SL_QMIN
     FMC_LIMITS                            NI_IOLEAPERS                          FR_MEMM
     FR_PRC$                               FR_PRM$                               FR_SUC$
     FR_SUM$                               FR_SUMX                               FR_SUNM
     FT_PROT                               JS_TIME                               JS_TMDPRM
     JS_PRDPRM                             JS_REMCPO                             JS_REMLO
     JS_REMDO                              JS_SHARE_ALL                          FO_SYMBINFO
     FO_JOBSTATSAGE                        ES_LOGFILEGRANT                       ES_LOGFILEDENY
     ES_PRIVMASK                           ES_STEPPRIVMASK                       ES_LOGPRIVCHNG
     ES_PRIVCHNGMASK                       ES_LOGMONSER                          ES_MONSERTBL
     ES_LOGSYSACC                          ES_LOGSYSEXIT                         ES_CLEARMEM
     ES_PROTECTSECLOG                      EL_SECLOGSIZE                         JM_NPART
     JM_PI                                 JM_MAX1ACCT                           JM_PT
     JZ_RETIM                              MM_FREETHRESH                         MM_NOUSTHRESH
     MM_AUTO_PRIO                          MM_CACHE_PRIO                         MM_CG_PRIO
     UMT_TIMEZONE                          UMT_UTC_OFFSET                        UQ_MAXENQ
     B_MUAIS                               B_CNTRL_HIGH                          B_CNTRL_LOW
r    B$XL_UPPER$                           B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:103  


        1        1        /*M*     PCC$CONTROL - MAIN MODULE FOR CONTROL             */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        PCC$CONTROL: PROC MAIN;

      7  9 000000   000000 700200 xent  PCC$CONTROL  TSX0  ! X66_MAUTO
         9 000001   000112 000000                    ZERO    74,0

        8        8        /**/
        9        9        /*********************************************************************/
       10       10        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       11       11        /*********************************************************************/
       12       12        %INCLUDE PC_SUBS_C;
       13      344        %INCLUDE PC_PERR_C;
       14      377        %INCLUDE XU_MACRO_C;
       15     3483        %INCLUDE CP_6;
       16     3564        %INCLUDE CP_6_SUBS;
       17     4104        %INCLUDE B_SEGIDS_C;
       18     4643        %INCLUDE B_STRINGS_C;
       19     4772        %INCLUDE B$JIT;
       20     5062        %INCLUDE JM$STRUCT;
       21     5807        %INCLUDE PC_MACRO_C;
       22     5833        %INCLUDE B_ERRORS_C;
       23     6960        %INCLUDE XU_SUBS_C;
       24     7052        %INCLUDE B$OBJECT_C;
       25    10482        %INCLUDE XU_FORMAT_C;
       26    10644        %INCLUDE QQ_MACROS_C;
       27    11069        %INCLUDE XUF_ENTRY;
       28    11077        %INCLUDE FM_CACHE_C;
       29    11143        %INCLUDE UD_EQU_E;
       30    11532        %INCLUDE XUD_UTS_M;
       31    11614        /**/
       32    11615        %EQU PSURES_OFFSET = 4;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:104  
       33    11616        %EQU MMINDX=0;
       34    11617        %XUD_UTS_EQU;
       35    11628        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:105  
       36    11629        /***************************************************************************/
       37    11630        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       38    11631        /***************************************************************************/
       39    11632        /**/
       40    11633    1   DCL CAT$ PTR STATIC SYMDEF INIT(ADDR(CATAGORY_TBL));
       41    11634    1   DCL SYSTEM$ PTR STATIC SYMDEF INIT(ADDR(SYSTEM_TBL));
       42    11635    1   DCL PART$ PTR STATIC SYMDEF INIT(ADDR(PARTITION_TBL));
       43    11636    1   DCL RES$ PTR STATIC SYMDEF INIT(ADDR(RESOURCE_TBL));
       44    11637    1   DCL EX$ PTR STATIC SYMDEF INIT(ADDR(EXCEPTION_TBL));
       45    11638    1   DCL TP$ PTR STATIC SYMDEF INIT(ADDR(TP_TBL));
       46    11639    1   DCL PC_REASON UBIN STATIC SYMDEF;
       47    11640        /**/
       48    11641    1   DCL 1 PC$JITPTR STATIC,
       49    11642    1         2 * BIT(24) UNAL INIT('0'B),
       50    11643    1         2 SEGID BIT(12) UNAL INIT(%JITSID); /* JIT PTR                           */
       51    11644        /**/
       52    11645    1   DCL PC$JIT$ REDEF PC$JITPTR PTR;
       53    11646        /**/
       54    11647    1   DCL MONPTR$ PTR STATIC SYMDEF;
       55    11648    1   DCL 1 MONPTR REDEF MONPTR$,
       56    11649    1         2 ADDRESS UBIN(24) UNAL,
       57    11650    1         2 SEGID UBIN(12) UNAL;
       58    11651        /**/
       59    11652    1   DCL MONPART$ PTR STATIC SYMDEF INIT(ADDR(JM_PT));
       60    11653    1   DCL 1 MONPARTPTR REDEF MONPART$,
       61    11654    1         2 ADDRESS UBIN(24) UNAL,
       62    11655    1         2 SEGID UBIN(12) UNAL;
       63    11656        /**/
       64    11657    1   DCL NUM_PSURES UBIN WORD STATIC SYMDEF;
       65    11658    1   DCL LAST_CMD UBIN WORD STATIC SYMDEF INIT(0);
       66    11659        /**/
       67    11660    1   DCL TEMP$ PTR STATIC;
       68    11661    1   DCL 1 TEMPPTR REDEF TEMP$,
       69    11662    1         2 ADDRESS UBIN(24) UNAL,
       70    11663    1         2 SEGID UBIN(12) UNAL;
       71    11664    1   DCL TEMP1$ PTR;
       72    11665    1   DCL FIRST_BIT UBIN WORD;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:106  
       73    11666    1   DCL LAST_BIT UBIN WORD;
       74    11667    1   DCL FLAGVAL UBIN WORD;
       75    11668    1   DCL BLK$ PTR STATIC;
       76    11669    1   DCL PART#$ PTR STATIC;
       77    11670    1   DCL PARAM$ PTR STATIC;
       78    11671    1   DCL INDEX$ PTR STATIC;
       79    11672    1   DCL M$SI$ PTR STATIC;
       80    11673    1   DCL HDR$ PTR STATIC;
       81    11674        /**/
       82    11675    1   DCL TEMP1 SBIN STATIC;
       83    11676    1   DCL TEMP2 SBIN STATIC;
       84    11677    1   DCL I SBIN STATIC;
       85    11678    1   DCL J SBIN STATIC;
       86    11679    1   DCL K SBIN STATIC;
       87    11680    1   DCL L SBIN STATIC;
       88    11681    1   DCL CURINSTANCES SBIN WORD STATIC SYMDEF INIT(0);
       89    11682    1   DCL TBLINSTANCES SBIN WORD STATIC SYMDEF INIT(0);
       90    11683        /**/
       91    11684    1   DCL BITVAL BIT(1) STATIC;               /* USED BY ADD/DROP                   */
       92    11685        /**/
       93    11686    1   DCL TPSYS BIT(1) STATIC SYMDEF INIT(YES); /* TP SYSTEM FLAG                   */
       94    11687    1   DCL SETAUTH BIT(1) STATIC INIT(YES);
       95    11688        /**/
       96    11689    1   DCL REMEM_CMD_READ REMEMBER STATIC SYMDEF;
       97    11690        /**/
       98    11691    1   DCL RES_TEXT(0:3) CHAR(2) STATIC SYMDEF INIT('MM',
       99    11692    1                                                    'DP',
      100    11693    1                                                    'MT',
      101    11694    1                                                    'OP');
      102    11695    1   DCL PSURES_TEXT(0:7) CHAR(8) STATIC SYMDEF;
      103    11696    1   DCL RES_INDX SBIN WORD STATIC;
      104    11697        /**/
      105    11698    1   DCL CMD_BUF CHAR(256) STATIC SYMDEF;
      106    11699        /**/
      107    11700    1   DCL MAX_CLMN SBIN WORD STATIC SYMDEF;
      108    11701    1   DCL CUR_CLMN SBIN WORD STATIC SYMDEF;
      109    11702    1   DCL PRINT_BUF CHAR(132) STATIC SYMDEF INIT(' ');
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:107  
      110    11703        /**/
      111    11704    1   DCL 1 INDEX_FLGS STATIC SYMDEF,
      112    11705    1         2 MODE (0:%PC_MAXMODE) BIT(1) UNAL INIT(YES*0),
      113    11706    1         2 PART# (0:15) BIT(1) UNAL INIT(YES*0),
      114    11707    1         2 DOMAINE (0:%PC_MAXDOMAIN) BIT(1) UNAL INIT(YES*0);
      115    11708        /**/
      116    11709    1   DCL PART#_FLGS(0:15) BIT(1) STATIC SYMDEF;
      117    11710        /**/
      118    11711    1   DCL 1 DISP_TBL STATIC,
      119    11712    1         2 INDX UBIN WORD,
      120    11713    1         2 PARM(0:99) ALIGNED,
      121    11714    1           3 CAT UBIN(9) UNAL,
      122    11715    1           3 PARM UBIN(9) UNAL,
      123    11716    1           3 INDEXLO UBIN(9) UNAL,
      124    11717    1           3 INDEXHI UBIN(9) UNAL,
      125    11718    1           3 RESINDX SBIN HALF UNAL;
      126    11719    1   DCL 1 DISP_CAT(0:%PC_MAXCATAGORY) BIT(1) UNAL STATIC INIT (NO*0);
      127    11720        /**/
      128    11721    1   DCL PDT(0:303/*SIZEW(JM$PT)*15-1*/) UBIN WORD STATIC INIT(0*0);
      129    11722    1   DCL PDTFLAGS(0:303/*SIZEW(JM$PT)*15-1*/) UBIN WORD STATIC INIT(0*0);
      130    11723        /**/
      131    11724    1   DCL PDT$ PTR STATIC SYMDEF INIT (ADDR(PDT));
      132    11725    1   DCL PDTFLAG$ PTR STATIC SYMDEF INIT (ADDR(PDTFLAGS));
      133    11726        /**/
      134    11727    1   DCL SET_PDT$ PTR STATIC;
      135    11728    1   DCL SET_PDTFLAG$ PTR STATIC;
      136    11729        /**/
      137    11730    1   DCL DUMMY$ PTR;
      138    11731    1   DCL ERRCODE REDEF DUMMY$ BIT(36);
      139    11732    1   DCL CODE SBIN;
      140    11733    1   DCL SET_CAT SBIN WORD STATIC;
      141    11734    1   DCL SET_PARAM SBIN WORD STATIC;
      142    11735    1   DCL SET_INDEXLO SBIN WORD STATIC;
      143    11736    1   DCL SET_INDEXHI SBIN WORD STATIC;
      144    11737    1   DCL VALUE SBIN WORD STATIC;
      145    11738    1   DCL MASK_VALUE REDEF VALUE BIT(36);
      146    11739    1   DCL MONSER_VALUE(0:%MAX_FCG#) BIT(36) STATIC ALIGNED;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:108  
      147    11740    1   DCL PMME UBIN HALF HALIGNED;
      148    11741    1   DCL 1 PMME_REDEF REDEF PMME,
      149    11742    1         2 FCG  UBIN(6)  UNAL,
      150    11743    1         2 CODE UBIN(12) UNAL;
      151    11744    1   DCL PC$ PTR;
      152    11745    1   DCL VAL$ PTR;
      153    11746    1   DCL MASKVALHI UBIN;
      154    11747        %EQU PRIV_VAL_HI   = %PC_PRIVHI-1;
      155    11748    1   DCL PC_CODE(0:0) UBIN BYTE UNAL BASED;
      156    11749    1   DCL VAL_CODE(0:0) BIT(36) ALIGNED BASED;
      157    11750    1   DCL 1 PRIV_VALS CONSTANT ALIGNED,
      158    11751    1         2 PC_CODE(0:%PRIV_VAL_HI) UBIN BYTE UNAL INIT(
      159    11752    1                             %PC_ALL,
      160    11753    1                             %PC_NONE,
      161    11754    1                             %PC_SPCLMM,
      162    11755    1                             %PC_EXMM,
      163    11756    1                             %PC_MAXMEM,
      164    11757    1                             %PC_MSYS,
      165    11758    1                             %PC_JIT,
      166    11759    1                             %PC_TND,
      167    11760    1                             %PC_PM,
      168    11761    1                             %PC_EXPM,
      169    11762    1                             %PC_IOQ,
      170    11763    1                             %PC_IOQW,
      171    11764    1                             %PC_INTCON,
      172    11765    1                             %PC_CQ,
      173    11766    1                             %PC_CFEP,
      174    11767    1                             %PC_MFEP,
      175    11768    1                             %PC_SYSLOG,
      176    11769    1                             %PC_GPP,
      177    11770    1                             %PC_ASAVE,
      178    11771    1                             %PC_SYSCON,
      179    11772    1                             %PC_DISPJOB,
      180    11773    1                             %PC_SCREECH,
      181    11774    1                             %PC_SNAP,
      182    11775    1                             %PC_FMREAD,
      183    11776    1                             %PC_FMDIAG,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:109  
      184    11777    1                             %PC_FMSEC,
      185    11778    1                             %PC_FMBLK,
      186    11779    1                             %PC_FMEFT),
      187    11780    1         2 VAL_CODE(0:%PRIV_VAL_HI) BIT(36) ALIGNED INIT(
      188    11781    1                             '777777777777'O,
      189    11782    1                             '0'B,
      190    11783    1                             %PR_SPCLMM#,
      191    11784    1                             %PR_EXMM#,
      192    11785    1                             %PR_MAXMEM#,
      193    11786    1                             %PR_MSYS#,
      194    11787    1                             %PR_JIT#,
      195    11788    1                             %PR_TND#,
      196    11789    1                             %PR_PM#,
      197    11790    1                             %PR_EXPM#,
      198    11791    1                             %PR_IOQ#,
      199    11792    1                             %PR_IOQW#,
      200    11793    1                             %PR_INTCON#,
      201    11794    1                             %PR_CQ#,
      202    11795    1                             %PR_CFEP#,
      203    11796    1                             %PR_MFEP#,
      204    11797    1                             %PR_SYSLOG#,
      205    11798    1                             %PR_GPP#,
      206    11799    1                             %PR_ASAVE#,
      207    11800    1                             %PR_SYSCON#,
      208    11801    1                             %PR_DISPJOB#,
      209    11802    1                             %PR_SCREECH#,
      210    11803    1                             %PR_SNAP#,
      211    11804    1                             %PR_FMREAD#,
      212    11805    1                             %PR_FMDIAG#,
      213    11806    1                             %PR_FMSEC#,
      214    11807    1                             %PR_FMBLK#,
      215    11808    1                             %PR_FMEFT#);
      216    11809    1   DCL SUBLK$ PTR;
      217    11810    1   DCL LIT$ PTR;
      218    11811    1   DCL WORDS_AVAIL SBIN WORD STATIC;
      219    11812    1   DCL INSTANCE_NAME CHAR(8);
      220    11813    1   DCL PSEUDO_NAME CHAR(8);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:110  
      221    11814        %EQU WORDS_PER_GRAN = 1024;
      222    11815        %EQU DEFAULT_MAXTPU = 49;
      223    11816    1   DCL CURUTS UBIN WORD STATIC;
      224    11817    1   DCL FIRST_INDX SBIN WORD;
      225    11818    1   DCL LAST_INDX SBIN WORD;
      226    11819    1   DCL FOUND BIT(1);
      227    11820    1   DCL CUR_SIZE_OF_FILE SBIN WORD;
      228    11821    1   DCL CUR_SIZE_OF_DATA SBIN WORD;
      229    11822    1   DCL TABLE$ PTR;
      230    11823    1   DCL INSTANCE$ PTR;
      231    11824    1   DCL PTR$ PTR;
      232    11825    1   DCL PARMTYPE UBIN WORD;
      233    11826    1   DCL PARMX SBIN WORD;
      234    11827    1   DCL ERR# SBIN WORD;
      235    11828    1   DCL DELINDX SBIN WORD;
      236    11829    1   DCL TBLINDX SBIN WORD;
      237    11830    1   DCL MAXTPU_BUF CHAR(16) STATIC INIT('MAXTPU(');
      238    11831    1   DCL RU_PARAMS(0:35) BIT(1) STATIC INIT('0'B*0);
      239    11832    1   DCL RU_FMT CHAR(0) CONSTANT INIT('%A:%10P');
      240    11833    1   DCL 1 RUBUF STATIC ALIGNED,
      241    11834    1         2 COUNT UBIN BYTE UNAL,
      242    11835    1         2 TEXT CHAR(132) UNAL;
      243    11836    1   DCL TEMPBUF CHAR(32);
      244    11837    1   DCL TEMPNAME CHAR(8);
      245    11838    1   DCL PARAM_FMT CHAR(0) CONSTANT INIT('%A%10P');
      246    11839    1   DCL 1 RUPARAM_TBL (0:%PC_NUMRUFLAGS) STATIC ALIGNED,
      247    11840    1         2 COUNT UBIN BYTE UNAL INIT(0,10,10,8,11,6,7,4,6),
      248    11841    1         2 TEXT CHAR(12) UNAL INIT(' ',
      249    11842    1                                   'NOCHGPMEM=',
      250    11843    1                                   'SHAREABLE=',
      251    11844    1                                   'PROCACC=',
      252    11845    1                                   'PROCSURCHG=',
      253    11846    1                                   'STATS=',
      254    11847    1                                   'PSEUDO=',
      255    11848    1                                   'NUM=',
      256    11849    1                                   ' LOCK=');
      257    11850    1   DCL DCB_WIDTH SBIN WORD;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:111  
      258    11851    1   DCL TEMPLEN SBIN WORD;
      259    11852    1   DCL DUMP_FMT CHAR(0) CONSTANT INIT('%T%10P');
      260    11853    1   DCL DUMP_BUF BIT(72) STATIC INIT(VECTOR(DUMP_FMT));
      261    11854    1   DCL DUMP_LOCK_FMT CHAR(0) CONSTANT INIT('%T%2P%12ZO %12ZO%10P');
      262    11855    1   DCL DUMP_LOCK BIT(72) STATIC INIT(VECTOR(DUMP_LOCK_FMT));
      263    11856    1   DCL OUTBUF CHAR(132) STATIC;
      264    11857    1   DCL P_PCB$ PTR STATIC INIT(ADDR(NIL));
      265    11858        %XUR_INIT (SYNTAX=YES,GOODCMD=YES,COMMANDS=YES);
      266    11957        %XUG_INIT (COMMANDS=NO,GOODCMD=YES,WSEG=6);
      267    12370        %XUG_GETCMD (NODES=XST_TIMEZONE);
      268    12708        %F_FDS (NAME=FDS,BUF=OUTBUF,DCB=M$LO);
      269    12821        %PC$HDR (STCLASS="BASED(B$DS5$)");
      270    12825        %PC$INSTANCE (STCLASS="BASED(INSTANCE$)");
      271    12875        %B$HEAD (STCLASS=STATIC);
      272    13075        %B$RUHEADKEY (NAME=HEADKEY,STCLASS=STATIC);
      273    13082    1   DCL 1 CNTRL_KEY STATIC,
      274    13083    1         2 COUNT UBIN(9) UNAL INIT(3),
      275    13084    1         2 ONE UBIN(27) UNAL INIT(1000);
      276    13085        /**/
      277    13086    1   DCL 1 TEXTC_MODEX(0:%PC_MAXMODE) STATIC,
      278    13087    1         2 COUNT UBIN(9) UNAL INIT(0,1,1,1,2),
      279    13088    1         2 TEXT CHAR(3) UNAL INIT(' ','B','G','O','TP');
      280    13089    1   DCL 1 TEXTC_PART#X(0:15) STATIC SYMDEF,
      281    13090    1         2 COUNT UBIN(9) UNAL INIT(1*9,2*7),
      282    13091    1         2 TEXT CHAR(3) UNAL INIT('1','2','3','4','5','6','7','8',
      283    13092    1           '9','10','11','12','13','14','15','16');
      284    13093    1   DCL 1 TEXTC_DOMAINX(0:%PC_MAXDOMAIN) STATIC,
      285    13094    1         2 COUNT UBIN(9) UNAL INIT(2,2,3,1),
      286    13095    1         2 TEXT CHAR(3) UNAL INIT('CP','DB','ASL','U');
      287    13096        /**/
      288    13097    1   DCL 1 TEXTC_CAT(0:%PC_MAXCATAGORY) STATIC SYMDEF,
      289    13098    1         2 COUNT UBIN(9) UNAL INIT(0,6,8,9,5,9),
      290    13099    1         2 TEXT CHAR(12) UNAL INIT(' ',
      291    13100    1           'SYSTEM',
      292    13101    1           'RESOURCE',
      293    13102    1           'PARTITION',
      294    13103    1           'TPCAT',
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:112  
      295    13104    1           'EXCEPTION');
      296    13105        /**/
      297    13106    1   DCL 1 TEXTC_MODE(0:%PC_MAXMODE) STATIC SYMDEF,
      298    13107    1         2 COUNT UBIN(9) UNAL INIT(0,5,5,6,2),
      299    13108    1         2 TEXT CHAR(11) UNAL INIT(' ',
      300    13109    1           'BATCH',
      301    13110    1           'GHOST',
      302    13111    1           'ONLINE',
      303    13112    1           'TP');
      304    13113        /**/
      305    13114    1   DCL 1 TEXTC_DOMAIN(0:%PC_MAXDOMAIN) STATIC SYMDEF,
      306    13115    1         2 COUNT UBIN(9) UNAL INIT(2,2,3,4),
      307    13116    1         2 TEXT CHAR(7) UNAL INIT('CP',
      308    13117    1           'DB',
      309    13118    1           'ASL',
      310    13119    1           'USER');
      311    13120        /**/
      312    13121    1   DCL 1 TEXT_C STATIC SYMDEF,
      313    13122    1         2 COUNT UBIN(9) UNAL,
      314    13123    1         2 TEXT CHAR(16) UNAL;
      315    13124        /**/
      316    13125    1   DCL 1 RESTEXT_C STATIC SYMDEF,
      317    13126    1         2 COUNT UBIN(9) UNAL,
      318    13127    1         2 TEXT CHAR(12) UNAL;
      319    13128        /**/
      320    13129    1   DCL TEXT_CONTROLHERE CHAR(19) STATIC INIT(' ');
      321    13130    1   DCL B_VERSION CHAR(1) SYMREF;
      322    13131    1   DCL 1 B$VERSIONB BASED,
      323    13132    1        2 C_ UBIN BYTE CALIGNED,
      324    13133    1        2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      325    13134    1   DCL DASH CHAR(1) STATIC INIT('-');
      326    13135        /**/
      327    13136        %VLP_VECTOR ( FPTN = DS_RESULTS );
      328    13151        /**/
      329    13152        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:113  
      330    13153        /*       ADDING PARAMETERS
      331    13154
      332    13155                 To add a parameter to CONTROL it is necessary to do the
      333    13156                 following things:
      334    13157
      335    13158                 1) Change PCN$NODES to recognize new parameter
      336    13159
      337    13160                 2) Add a %EQU to PC_SUBS_C for the new parameter
      338    13161
      339    13162                 3) Add a %PARM macro invocation describing the new parameter
      340    13163                    to the list that follows - note that this %PARM list
      341    13164                    must be in the same order as the %EQUs.
      342    13165
      343    13166                 4) Update HELP messages to document new parameter
      344    13167
      345    13168                 5) Possibly add some code to handle new parameter - should
      346    13169                    only be necessary in the case of PARTITION parameters for
      347    13170                    which a CASE statement must be added to a DO CASE in
      348    13171                    a few places.
      349    13172        */
      350    13173        /**/
      351    13174        /* DATA MACROS */
      352    13175        /**/
      353    13176        %MACRO PARM (NAME = NAME,
      354    13177                    DISP = NO,
      355    13178                    INDEXED = YES,
      356    13179                    RESTYPE = NO,
      357    13180                      MAXCONSTANT = YES,
      358    13181                      MINCONSTANT = YES,
      359    13182                      VALUETEXT=NO,
      360    13183                      VALUETEXTLIST=NO,
      361    13184                      INTINDEXED=NO,
      362    13185                      VALUECODE=0,
      363    13186                      PRINTFLG=YES,
      364    13187                      MULTIPLIER = 1,
      365    13188                      MAXVALUE = 1,
      366    13189                      MINVALUE = 0,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:114  
      367    13190                    RESFLGTBL = NIL,
      368    13191                    TEXTNAME = 'NAME',
      369    13192                    TABLE = NIL,
      370    13193                        PSUTABLE = NIL,
      371    13194                    LAST =",",
      372    13195                    YES = '1'B,NO = '0'B);
      373    13196        /**/
      374    13197              2 NAME ALIGNED,
      375    13198                3 FLAGS,
      376    13199                  4 PRINT BIT(1) UNAL INIT(PRINTFLG),
      377    13200                  4 DISPONLY BIT(1) UNAL INIT(DISP),
      378    13201                  4 INDX BIT(1) UNAL INIT(INDEXED),
      379    13202                  4 RES BIT(1) UNAL INIT(RESTYPE),
      380    13203                  4 MAXCONST BIT(1) UNAL INIT(MAXCONSTANT),
      381    13204                  4 MINCONST BIT(1) UNAL INIT(MINCONSTANT),
      382    13205                  4 VALTEXT BIT(1) UNAL INIT(VALUETEXT),
      383    13206                  4 VALTEXTLIST BIT(1) UNAL INIT(VALUETEXTLIST),
      384    13207                  4 INTINDX BIT(1) UNAL INIT(INTINDEXED),
      385    13208                    /* Internally indexed. I.e., indexed for our convenience,
      386    13209                       but the user doesn't want to know.                */
      387    13210                  4 * BIT(9) UNAL INIT('0'B),
      388    13211                3 VALCODE UBIN(18) UNAL INIT(VALUECODE),
      389    13212                3 RESPTR$ PTR ALIGNED INIT(ADDR(RESFLGTBL)),
      390    13213                3 TEXT ALIGNED,
      391    13214                  4 COUNT UBIN(9) UNAL INIT(SIZEC(TEXTNAME)),
      392    13215                  4 TEXT CHAR(19) UNAL INIT(TEXTNAME),
      393    13216                3 PTR$ PTR INIT(ADDR(TABLE)),
      394    13217                3 PSUPTR$ PTR INIT(ADDR(PSUTABLE)),
      395    13218                3 MAX SBIN WORD INIT(MAXVALUE),
      396    13219                3 MIN SBIN WORD INIT(MINVALUE),
      397    13220                3 MULT UBIN WORD UNAL INIT(MULTIPLIER) LAST
      398    13221        %MEND;
      399    13222        /**/
      400    13223        %MACRO CATAGORY (NAME = NAME,
      401    13224                       PRINTFLG = YES,
      402    13225                       PARAM_MAX = 1,
      403    13226                       PARAM_TBL = NIL,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:115  
      404    13227                       LAST =",",
      405    13228                       YES = '1'B,NO = '0'B);
      406    13229        /**/
      407    13230              2 NAME ALIGNED,
      408    13231                3 FLAGS,
      409    13232                  4 PRINT BIT(1) UNAL INIT(PRINTFLG),
      410    13233                  4 * BIT(17) UNAL INIT(NO),
      411    13234                3 MAXPARAM UBIN(18) UNAL INIT(PARAM_MAX),
      412    13235                3 PARAM$ PTR INIT(ADDR(PARAM_TBL)) LAST
      413    13236        %MEND;
      414    13237        /**/
      415    13238        %MACRO RESFLGTBL (NAME = NAME);
      416    13239        /**/
      417    13240        DCL NAME(0:15) BIT(1) STATIC INIT('1'B*0);
      418    13241        %MEND;
      419    13242        /**/
      420    13243        /* SYSTEM PARAMETERS */
      421    13244        /**/
      422    13245    1   DCL 1 SYSTEM_TBL STATIC ALIGNED,
      423    13246        %PARM (TABLE = TEXTC_MODEX);
      424    13273        %PARM (NAME=UM,TEXTNAME='UM',TABLE=S_MUIS,MAXCONSTANT=NO,MAXVALUE=%PC_MAXU);
      425    13300        %PARM (NAME=UC,TEXTNAME='UC',DISP=YES,TABLE=S_CUIS);
      426    13327        %PARM (NAME=TOTU,TEXTNAME='TOTU',DISP=YES,INDEXED=NO,TABLE=S_CTUIS);
      427    13354        %PARM (NAME=LIMITU,TEXTNAME='LIMITU',INDEXED=NO,MAXCONSTANT=NO,
      428    13355                MAXVALUE=%PC_MAXU,TABLE=S_TUIS);
      429    13382        %PARM (NAME=MAXU,TEXTNAME='MAXU',DISP=YES,INDEXED=NO,TABLE=B_MUAIS);
      430    13409        %PARM (NAME=QMIN,TEXTNAME='QMIN',TABLE=SL_QMIN,
      431    13410               MULTIPLIER=1000,MINVALUE=20,MAXVALUE="BITBIN('000203044672'O)");
      432    13437        %PARM (NAME=QUAN,TEXTNAME='QUAN',INDEXED=NO,TABLE=SL_QUAN,
      433    13438               MULTIPLIER=1000,MINVALUE=20,MAXVALUE="BITBIN('000203044672'O)");
      434    13465        %PARM (NAME=PRIOB,TEXTNAME='PRIOB',TABLE=S_PRIOB,INDEXED=YES,
      435    13466                MINVALUE=1,MAXVALUE=511);
      436    13493        %PARM (NAME=IOTA,TEXTNAME='IOTA',TABLE=SL_IOTA,
      437    13494                MULTIPLIER=1000,MAXVALUE="BITBIN('000203044672'O)");
      438    13521        %PARM (NAME=MFBLK,TEXTNAME='MFBLK',TABLE=SL_MF,MINCONSTANT=NO,
      439    13522                MINVALUE=%PC_MFUBL,MAXVALUE=511);
      440    13549        %PARM (NAME=MFUBL,TEXTNAME='MFUBL',TABLE=SL_MFU,MAXCONSTANT=NO,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:116  
      441    13550                MAXVALUE=%PC_MFBLK);
      442    13577        %PARM (NAME=PI,TEXTNAME='PI',INDEXED=NO,TABLE=JM_PI,MAXVALUE=511);
      443    13604        %PARM (NAME=RETIM,TEXTNAME='RETIM',INDEXED=NO,TABLE=JZ_RETIM,MAXVALUE=
             13604            "BITBIN('377777777777'O)");
      444    13631        %PARM (NAME=NPART,TEXTNAME='NPART',INDEXED=NO,TABLE=JM_NPART,
      445    13632                MAXVALUE=16);
      446    13659        %PARM (NAME=ANSPROT,TEXTNAME='ANSPROT',INDEXED=NO,TABLE=FT_PROT,
      447    13660                MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,VALUECODE=%PC_ANSPROTVAL);
      448    13687        %PARM (NAME=MAXENQ,TEXTNAME='MAXENQ',INDEXED=NO,TABLE=UQ_MAXENQ,
      449    13688                MINVALUE = 2,MAXVALUE = "BITBIN('777777'O)");
      450    13715        %PARM (NAME=MAXACCT,TEXTNAME='MAXACCT',INDEXED=NO,TABLE=JM_MAX1ACCT,
      451    13716                MINVALUE=1,MAXVALUE=511);
      452    13743        %PARM (NAME=AUTOSHARE,TEXTNAME='AUTOSHARE',INDEXED=NO,TABLE=JS_SHARE_ALL,
      453    13744                MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,VALUECODE=%PC_AUTOSHAREVAL);
      454    13771        %PARM (NAME=GRANSCHED,TEXTNAME='GRANSCHED',INDEXED=NO,TABLE=FO_SYMBINFO,VALUETEXT=
             13771            YES,VALUECODE=%PC_FLAGVAL);
      455    13798        %PARM (NAME=JOBSTATSAGE,TEXTNAME='JOBSTATSAGE',INDEXED=NO,TABLE=FO_JOBSTATSAGE,
             13798            MINVALUE=1,
      456    13799                MAXVALUE=511);
      457    13826        %PARM (NAME=WATCH,TEXTNAME='WATCH',INDEXED=NO,TABLE="FO_SYMBINFO.WATCH#",
      458    13827                MINVALUE=0,MAXVALUE=1,VALUETEXT=YES,VALUECODE=%PC_FLAGVAL);
      459    13854        %PARM (NAME=HOLDEXPIRE,TEXTNAME='HOLDEXPIRE',INDEXED=NO,TABLE=
             13854            "FO_SYMBINFO.HOLDEXPIRE#",
      460    13855                MINVALUE=0,MAXVALUE=511);
      461    13882        %PARM (NAME=FREETHRESH,TEXTNAME='FREETHRESH',TABLE=MM_FREETHRESH,INDEXED=NO,
      462    13883                MAXVALUE=1000);
      463    13910        %PARM (NAME=NOUSTHRESH,TEXTNAME='NOUSTHRESH',TABLE=MM_NOUSTHRESH,INDEXED=NO,
      464    13911                MAXVALUE=1000);
      465    13938        %PARM (NAME=EXPTIME_MAD,TEXTNAME="'EXPTIME(MAD)'",INDEXED=NO,TABLE=
             13938            "FMC_LIMITS.EXPIRE(%CTYP_MAD)",
      466    13939        MAXVALUE="BITBIN('377777777777'O)");
      467    13966        %PARM (NAME=EXPTIME_PAD,TEXTNAME="'EXPTIME(PAD)'",INDEXED=NO,TABLE=
             13966            "FMC_LIMITS.EXPIRE(%CTYP_PAD)",
      468    13967        MAXVALUE="BITBIN('377777777777'O)");
      469    13994        %PARM (NAME=EXPTIME_GP,TEXTNAME="'EXPTIME(GP)'",INDEXED=NO,TABLE=
             13994            "FMC_LIMITS.EXPIRE(%CTYP_GP)",
      470    13995        MAXVALUE="BITBIN('377777777777'O)");
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:117  
      471    14022        %PARM (NAME=EXPTIME_FD,TEXTNAME="'EXPTIME(FD)'",INDEXED=NO,TABLE=
             14022            "FMC_LIMITS.EXPIRE(%CTYP_FD)",
      472    14023        MAXVALUE="BITBIN('377777777777'O)");
      473    14050        %PARM (NAME=EXPTIME_FIT,TEXTNAME="'EXPTIME(FIT)'",INDEXED=NO,TABLE=
             14050            "FMC_LIMITS.EXPIRE(%CTYP_FIT)",
      474    14051        MAXVALUE="BITBIN('377777777777'O)");
      475    14078        %PARM (NAME=EXPTIME_UL,TEXTNAME="'EXPTIME(UL)'",INDEXED=NO,TABLE=
             14078            "FMC_LIMITS.EXPIRE(%CTYP_UL)",
      476    14079        MAXVALUE="BITBIN('377777777777'O)");
      477    14106        %PARM (NAME=EXPTIME_INDEX,TEXTNAME="'EXPTIME(INDEX)'",INDEXED=NO,TABLE=
             14106            "FMC_LIMITS.EXPIRE(%CTYP_INDEX)",
      478    14107        MAXVALUE="BITBIN('377777777777'O)");
      479    14134        %PARM (NAME=EXPTIME_DATA,TEXTNAME="'EXPTIME(DATA)'",INDEXED=NO,TABLE=
             14134            "FMC_LIMITS.EXPIRE(%CTYP_DATA)",
      480    14135        MAXVALUE="BITBIN('377777777777'O)");
      481    14162        %PARM (NAME=EXPTIME_REL,TEXTNAME="'EXPTIME(REL)'",INDEXED=NO,TABLE=
             14162            "FMC_LIMITS.EXPIRE(%CTYP_REL)",
      482    14163        MAXVALUE="BITBIN('377777777777'O)");
      483    14190        %PARM (NAME=EXPTIME_CONSEC,TEXTNAME="'EXPTIME(CONSEC)'",INDEXED=NO,TABLE=
             14190            "FMC_LIMITS.EXPIRE(%CTYP_CONSEC)",
      484    14191        MAXVALUE="BITBIN('377777777777'O)");
      485    14218        %PARM (NAME=UPDLIMIT_INDEX,TEXTNAME="'UPDLIMIT(INDEX)'",INDEXED=NO,TABLE=
             14218            "FMC_LIMITS.UPLIMIT(%CTYP_INDEX)",
      486    14219        MAXVALUE="BITBIN('377777777777'O)");
      487    14246        %PARM (NAME=UPDLIMIT_DATA,TEXTNAME="'UPDLIMIT(DATA)'",INDEXED=NO,TABLE=
             14246            "FMC_LIMITS.UPLIMIT(%CTYP_DATA)",
      488    14247        MAXVALUE="BITBIN('377777777777'O)");
      489    14274        %PARM (NAME=UPDLIMIT_REL,TEXTNAME="'UPDLIMIT(REL)'",INDEXED=NO,TABLE=
             14274            "FMC_LIMITS.UPLIMIT(%CTYP_REL)",
      490    14275        MAXVALUE="BITBIN('377777777777'O)");
      491    14302        %PARM (NAME=AUTO_PRIO,TEXTNAME='AUTO_PRIO',INDEXED=NO,TABLE=MM_AUTO_PRIO,
      492    14303             MAXVALUE=100,MINVALUE=1);
      493    14330        %PARM (NAME=CACHE_PRIO,TEXTNAME='CACHE_PRIO',INDEXED=NO,TABLE=MM_CACHE_PRIO,
      494    14331             MAXVALUE=100,MINVALUE=1);
      495    14358        %PARM (NAME=CG_PRIO,TEXTNAME='CG_PRIO',INDEXED=NO,TABLE=MM_CG_PRIO,
      496    14359             MAXVALUE=100,MINVALUE=1);
      497    14386        %PARM (NAME=LOGFILEGRANT,TEXTNAME='LOGFILEGRANT',INDEXED=NO,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:118  
      498    14387               TABLE=ES_LOGFILEGRANT,MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,
      499    14388               VALUECODE=%PC_LOGFILEVAL);
      500    14415        %PARM (NAME=LOGFILEDENY,TEXTNAME='LOGFILEDENY',INDEXED=NO,
      501    14416               TABLE=ES_LOGFILEDENY,MINVALUE=0,MAXVALUE=2,VALUETEXT=YES,
      502    14417               VALUECODE=%PC_LOGFILEVAL);
      503    14444              /* BIT(36) items, like priv masks or pmmes, have max and min
      504    14445                 codes set to the largest and smallest SBIN numbers possible
      505    14446                 so they can't get 2BIG or 2SMALL errors by mistake.      */
      506    14447        %PARM (NAME=PRIVMASK,TEXTNAME='PRIVMASK',INDEXED=NO,TABLE=ES_PRIVMASK,
      507    14448               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      508    14449               VALUETEXTLIST=YES,VALUECODE=%PC_PRIVVAL);
      509    14476        %PARM (NAME=STEPPRIVMASK,TEXTNAME='STEPPRIVMASK',INDEXED=NO,TABLE=ES_STEPPRIVMASK,
      510    14477               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      511    14478               VALUETEXTLIST=YES,VALUECODE=%PC_PRIVVAL);
      512    14505        %PARM (NAME=LOGPRIVCHNG,TEXTNAME='LOGPRIVCHNG',INDEXED=NO,TABLE=ES_LOGPRIVCHNG,
      513    14506               MINVALUE=0,MAXVALUE=3,VALUETEXT=YES,VALUECODE=%PC_LOGLISTVAL);
      514    14533        %PARM (NAME=PRIVCHNGMASK,TEXTNAME='PRIVCHNGMASK',INDEXED=NO,TABLE=ES_PRIVCHNGMASK,
      515    14534               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      516    14535               VALUETEXTLIST=YES,VALUECODE=%PC_PRIVVAL);
      517    14562        %PARM (NAME=LOGSYSACCESS,TEXTNAME='LOGSYSACCESS',INDEXED=NO,
      518    14563               TABLE=ES_LOGSYSACC,MINVALUE=0,MAXVALUE=4,VALUETEXT=YES,
      519    14564               VALUECODE=%PC_LOGACCVAL);
      520    14591        %PARM (NAME=LOGSYSEXIT,TEXTNAME='LOGSYSEXIT',INDEXED=NO,
      521    14592               TABLE=ES_LOGSYSEXIT,MINVALUE=0,MAXVALUE=1,VALUETEXT=YES,
      522    14593               VALUECODE=%PC_LOGEXVAL);
      523    14620        %PARM (NAME=LOGMONSER,TEXTNAME='LOGMONSER',INDEXED=NO,TABLE=ES_LOGMONSER,
      524    14621               MINVALUE=0,MAXVALUE=3,VALUETEXT=YES,VALUECODE=%PC_LOGLISTVAL);
      525    14648        %PARM (NAME=MONSERTBL,TEXTNAME='MONSERTBL',INDEXED=NO,TABLE=ES_MONSERTBL,
      526    14649               MINVALUE="BITBIN('400000000000'O)",MAXVALUE="BITBIN('377777777777'O)",
      527    14650               VALUETEXTLIST=YES,INTINDEXED=YES,VALUECODE=%PC_MONSERVAL);
      528    14677        %PARM (NAME=CLEARMEM,TEXTNAME='CLEARMEM',INDEXED=NO,TABLE=ES_CLEARMEM,
      529    14678               MINVALUE=0,MAXVALUE=1,VALUETEXT=YES,VALUECODE=%PC_FLAGVAL);
      530    14705        %PARM (NAME=PROTECTSECLOG,TEXTNAME='PROTECTSECLOG',INDEXED=NO,
      531    14706               TABLE=ES_PROTECTSECLOG,MINVALUE=1,MAXVALUE=3650,
      532    14707               MULTIPLIER="%(24*60*60*100)");
      533    14734        %PARM (NAME=SECLOGSIZE,TEXTNAME='SECLOGSIZE',INDEXED=NO,TABLE=EL_SECLOGSIZE,
      534    14735               MINVALUE=10,MAXVALUE=262143);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:119  
      535    14762        %PARM (NAME=IOLEAPERS,TEXTNAME='IOLEAPERS',INDEXED=NO,TABLE=NI_IOLEAPERS,
      536    14763               MINVALUE=0,MAXVALUE=262143);
      537    14790        %PARM (NAME=TIMEZONE,TEXTNAME='TIMEZONE',INDEXED=NO,MINVALUE=0,
      538    14791                MAXVALUE="BITBIN('377777777777'O)",TABLE=UMT_TIMEZONE);
      539    14818        %PARM (NAME=UTC_OFFSET,TEXTNAME='UTC_OFFSET',INDEXED=NO,MINVALUE=
             14818            "BITBIN('400000000000'O)",
      540    14819                MAXVALUE="BITBIN('377777777777'O)",DISP=YES,TABLE=UMT_UTC_OFFSET,
      541    14820                LAST=";");
      542    14847        /**/
      543    14848        /* RESOURCE PARAMETERS */
      544    14849        /**/
      545    14850    1   DCL 1 RESOURCE_TBL STATIC ALIGNED,
      546    14851        %PARM (TABLE = TEXTC_MODEX);
      547    14878        %PARM (NAME=MAX,TEXTNAME='MAX',RESTYPE=YES,RESFLGTBL=MAXRFLGS,
      548    14879                TABLE=FR_PRM$,PSUTABLE=FR_SUM$);
      549    14906        %PARM (NAME=CUR,TEXTNAME='CUR',RESTYPE=YES,RESFLGTBL=CURRFLGS,DISP=YES,
      550    14907                TABLE=FR_PRC$,PSUTABLE=FR_SUC$);
      551    14934        %PARM (NAME=TOT,TEXTNAME='TOT',RESTYPE=YES,RESFLGTBL=TOTRFLGS,INDEXED=NO,
      552    14935                TABLE=FR_PRM$,PSUTABLE=FR_SUM$,DISP=YES,LAST=";");
      553    14962        /**/
      554    14963        /* PARTITION PARAMETERS */
      555    14964        /**/
      556    14965    1   DCL 1 PARTITION_TBL STATIC ALIGNED,
      557    14966        %PARM (TABLE = TEXTC_PART#X);
      558    14993        %PARM (NAME=PMINTI,TEXTNAME='PMINTI',TABLE=JM_PT,MULTIPLIER=6000);
      559    15020       %PARM (NAME=PMAXTI,TEXTNAME='PMAXTI',TABLE=JM_PT,MULTIPLIER=6000,MAXVALUE=59999400);
      560    15047        %PARM (NAME=PMIN,TEXTNAME='PMIN',RESTYPE=YES,RESFLGTBL=PMINRFLGS,TABLE=JM_PT);
      561    15074        %PARM (NAME=PMAX,TEXTNAME='PMAX',RESTYPE=YES,RESFLGTBL=PMAXRFLGS,TABLE=JM_PT);
      562    15101        %PARM (NAME=PLOCK,TEXTNAME='PLOCK',TABLE=JM_PT,MAXVALUE=1,VALUETEXT=YES,VALUECODE=
             15101            %PC_FLAGVAL);
      563    15128        %PARM (NAME=PQUAN,TEXTNAME='PQUAN',TABLE=JM_PT,MULTIPLIER=1000,
      564    15129                MINVALUE=20,MAXVALUE="BITBIN('000203044672'O)");
      565    15156        %PARM (NAME=PPRIO,TEXTNAME='PPRIO',TABLE=JM_PT,MINVALUE=1,
      566    15157                MAXVALUE=511);
      567    15184        %PARM (NAME=PMAXACCT,TEXTNAME='PMAXACCT',TABLE=JM_PT,MINVALUE=1,MAXVALUE=511);
      568    15211        %PARM (NAME=PJMAX,TEXTNAME='PJMAX',TABLE=JM_PT,MAXVALUE=511);
      569    15238        %PARM (NAME=PJCUR,TEXTNAME='PJCUR',TABLE=JM_PT);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:120  
      570    15265        %PARM (NAME=PJCTOT,TEXTNAME='PJCTOT',TABLE=JM_PT);
      571    15292        %PARM (NAME=PJTOT,TEXTNAME='PJTOT',TABLE=JM_PT,LAST=";");
      572    15319        /**/
      573    15320        /* EXCEPTION PARAMETERS */
      574    15321        /**/
      575    15322    1   DCL 1 EXCEPTION_TBL STATIC ALIGNED,
      576    15323        %PARM (TABLE = TEXTC_DOMAINX);
      577    15350       %PARM (NAME=ETIME,TEXTNAME='ETIME',MAXVALUE="BITBIN('000203044672'O)",TABLE=JS_TIME,
             15350            MULTIPLIER=100);
      578    15377        %PARM (NAME=EPDISK,TEXTNAME='EPDISK',MAXVALUE="BITBIN('377777777777'O)",TABLE=
             15377            JS_PRDPRM);
      579    15404        %PARM (NAME=ETDISK,TEXTNAME='ETDISK',MAXVALUE="BITBIN('377777777777'O)",TABLE=
             15404            JS_TMDPRM);
      580    15431        %PARM (NAME=EDO,TEXTNAME='EDO',MAXVALUE="BITBIN('377777'O)",TABLE=JS_REMDO);
      581    15458        %PARM (NAME=EPO,TEXTNAME='EPO',MAXVALUE="BITBIN('377777'O)",TABLE=JS_REMLO);
      582    15485        %PARM (NAME=ECPO,TEXTNAME='ECPO',MAXVALUE="BITBIN('377777'O)",TABLE=JS_REMCPO,LAST=
             15485            ";");
      583    15512        /**/
      584    15513        /* TP PARAMS */
      585    15514        /**/
      586    15515    1   DCL 1 TP_TBL STATIC ALIGNED,
      587    15516        %PARM (TABLE=TEXTC_MODEX);
      588    15543        %PARM (NAME=TPI,TEXTNAME='TPINSTANCE',PRINTFLG=NO);
      589    15570        %PARM (NAME=TPHDR,TEXTNAME='TPHDR',TABLE=TPHDR_TBL,MAXVALUE=0,PRINTFLG=NO);
      590    15597        %PARM (NAME=MAXTPU,TEXTNAME='MAXTPU',TABLE=MAXTPU_TBL,MAXVALUE=0,PRINTFLG=NO,LAST=
             15597            ";");
      591    15624        /**/
      592    15625        /**/
      593    15626    1   DCL 1 CATAGORY_TBL STATIC ALIGNED,
      594    15627        %CATAGORY;
      595    15636        %CATAGORY (NAME=SYSTEM,PARAM_MAX=%PC_SYSTEMHI,PARAM_TBL=SYSTEM_TBL);
      596    15645        %CATAGORY (NAME=RESOURCE,PARAM_MAX=%PC_RESOURCEHI,PARAM_TBL=RESOURCE_TBL);
      597    15654        %CATAGORY (NAME=PARTITION,PARAM_MAX=%PC_PARTITIONHI,PARAM_TBL=PARTITION_TBL);
      598    15663        %CATAGORY (NAME=TP,PARAM_MAX=%PC_TPHI,PARAM_TBL=TP_TBL,PRINTFLG=NO);
      599    15672       %CATAGORY (NAME=EXCEPTION,PARAM_MAX=%PC_EXCEPTIONHI,PARAM_TBL=EXCEPTION_TBL,LAST=";"
             15672            );
      600    15681        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:121  
      601    15682        %RESFLGTBL (NAME=MAXRFLGS);
      602    15686        %RESFLGTBL (NAME=CURRFLGS);
      603    15690        %RESFLGTBL (NAME=TOTRFLGS);
      604    15694        %RESFLGTBL (NAME=PMINRFLGS);
      605    15698        %RESFLGTBL (NAME=PMAXRFLGS);
      606    15702        /**/
      607    15703    1   DCL 1 MAXTPU_TBL(0:71) STATIC SYMDEF ALIGNED,
      608    15704    1         2 NAME CHAR(8) UNAL INIT(' '*0),
      609    15705    1         2 MAXTPU UBIN WORD UNAL INIT(0*0),
      610    15706    1         2 COUNT UBIN(18) UNAL INIT(0*0),
      611    15707    1         2 FLAGS UNAL,
      612    15708    1           3 PRINT BIT(1) UNAL INIT('0'B*0),
      613    15709    1           3 DELETED BIT(1) UNAL INIT('0'B*0),
      614    15710    1           3 * BIT(16) UNAL;
      615    15711        /**/
      616    15712    1   DCL 1 TPHDR_TBL(0:71) STATIC SYMDEF ALIGNED,
      617    15713    1    2 HDR,
      618    15714    1           3 CNT UBIN BYTE UNAL INIT(0*0),
      619    15715    1           3 MSG CHAR(80) UNAL INIT (' '*0),
      620    15716    1    2 FLAGS UNAL,
      621    15717    1           3 PRINT BIT(1) UNAL INIT('0'B*0),
      622    15718    1           3 PRESENT BIT(1) UNAL INIT('0'B*0),
      623    15719    1           3 * BIT(16) UNAL;
      624    15720        /**/
      625    15721        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:122  
      626    15722        /**/
      627    15723        /**********************************************************************/
      628    15724        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      629    15725        /**********************************************************************/
      630    15726        /**/
      631    15727        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
      632    15782        %F$DCB;
      633    15839        %PARSE$SYM;
      634    15877        %PARSE$OUT (NAME=O$BLK);
      635    15922        %B$TCB;
      636    15925        %B$ALT;
      637    15933        /**/
      638    15934    1   DCL 1 P$TBL(0:0) BASED ALIGNED,
      639    15935    1         2 FLAGS,
      640    15936    1           3 PRINT BIT(1) UNAL,
      641    15937    1           3 DISPONLY BIT(1) UNAL,
      642    15938    1           3 INDX BIT(1) UNAL,
      643    15939    1           3 RES BIT(1) UNAL,
      644    15940    1           3 MAXCONST BIT(1) UNAL,
      645    15941    1           3 MINCONST BIT(1) UNAL,
      646    15942    1           3 VALTEXT BIT(1) UNAL,
      647    15943    1           3 VALTEXTLIST BIT(1) UNAL,
      648    15944    1           3 INTINDX BIT(1) UNAL,
      649    15945    1           3 * BIT(9) UNAL,
      650    15946    1         2 VALCODE UBIN(18) UNAL,
      651    15947    1         2 RESPTR$ PTR ALIGNED,
      652    15948    1         2 TEXT ALIGNED,
      653    15949    1           3 COUNT UBIN(9) UNAL,
      654    15950    1           3 TEXT CHAR(19) UNAL,
      655    15951    1         2 PTR$ PTR,
      656    15952    1         2 REPTR$ REDEF PTR$,
      657    15953    1           3 ADDRESS UBIN(24) UNAL,
      658    15954    1           3 SEGID UBIN(12) UNAL,
      659    15955    1         2 PSUPTR$ PTR,
      660    15956    1         2 REPSUPTR$ REDEF PSUPTR$,
      661    15957    1           3 ADDRESS UBIN(24) UNAL,
      662    15958    1           3 SEGID UBIN(12) UNAL,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:123  
      663    15959    1         2 MAX SBIN WORD UNAL,
      664    15960    1         2 MIN SBIN WORD UNAL,
      665    15961    1         2 MULT UBIN WORD UNAL;
      666    15962        /**/
      667    15963    1   DCL 1 CAT$TBL(0:0) BASED ALIGNED,
      668    15964    1         2 FLAGS,
      669    15965    1           3 PRINT BIT(1) UNAL,
      670    15966    1           3 * BIT(17) UNAL,
      671    15967    1         2 MAXPARAM UBIN(18) UNAL,
      672    15968    1         2 PARAM$ PTR;
      673    15969        /**/
      674    15970    1   DCL RES$FLGS(0:15) BIT(1) BASED UNAL;
      675    15971    1   DCL PSURES$TEXT(0:7) CHAR(8) BASED;
      676    15972        /**/
      677    15973    1   DCL 1 TEXTC$INDX(0:0) BASED ALIGNED,
      678    15974    1         2 COUNT UBIN(9) UNAL,
      679    15975    1         2 TEXT CHAR(3) UNAL;
      680    15976        /**/
      681    15977    1   DCL B$TABLE(0:0) UBIN WORD BASED ALIGNED;
      682    15978    1   DCL B$BITS(0:0) BIT(1) UNAL BASED;
      683    15979    1   DCL 1 B$PTR(0:0) BASED ALIGNED,
      684    15980    1         2 ADDRESS UBIN(24) UNAL,
      685    15981    1         2 SEGID UBIN(12) UNAL;
      686    15982        /**/
      687    15983        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:124  
      688    15984        /***********************************************************************/
      689    15985        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      690    15986        /**********************************************************************/
      691    15987        /**/
      692    15988    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
      693    15989    1   DCL XUR$INIT ENTRY(3) ALTRET;
      694    15990    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      695    15991        /**/
      696    15992    1   DCL PCE$ERROR ENTRY(2) ALTRET;
      697    15993    1   DCL PCW$WRITE ENTRY(2) ALTRET;
      698    15994    1   DCL PCP$PDISP ENTRY(1) ALTRET;
      699    15995    1   DCL PCR$RESTEXT ENTRY(2);
      700    15996    1   DCL PCB$BREAK ENTRY ASYNC;
      701    15997    1   DCL PCB$BREAKSET ENTRY ASYNC;
      702    15998    1   DCL PCB$TRAP ENTRY ASYNC;
      703    15999        /**/
      704    16000    1   DCL PCT$SYSTEM ENTRY(1) ALTRET;
      705    16001    1   DCL PCT$RESOURCE ENTRY(1) ALTRET;
      706    16002    1   DCL PCT$PARTITION ENTRY(1) ALTRET;
      707    16003    1   DCL PCT$EXCEPTION ENTRY(1) ALTRET;
      708    16004    1   DCL PCT$TPCAT ENTRY(2) ALTRET;
      709    16005        /**/
      710    16006    1   DCL JMN$LOCK ENTRY(1) ALTRET;
      711    16007    1   DCL JMN$UNLOCK ENTRY(1);
      712    16008        /**/
      713    16009    1   DCL XST$TIMEZONE ENTRY(3) ALTRET;
      714    16010    1   DCL XST_NODES ENTRY CONV(5);
      715    16011    1   DCL XST_TIMEZONE SBIN SYMREF;
      716    16012    1   DCL XUG$GETCMD ENTRY(1) ALTRET;
      717    16013    1   DCL XUG$INIT ENTRY(2) ALTRET;
      718    16014        /********************************************************************/
      719    16015        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      720    16016        /********************************************************************/
      721    16017        /**/
      722    16018    1   DCL M$SI DCB;                           /* USER INPUT                         */
      723    16019    1   DCL M$LO DCB;                           /* ALL OUTPUT                         */
      724    16020    1   DCL M$DO DCB;                           /* DIAGNOSTICS                        */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:125  
      725    16021    1   DCL M$CNTRL DCB;                        /* :CNTRL FILE DCB                    */
      726    16022    1   DCL M$TP DCB;                           /* TP_CNTRL_D FILE DCB                */
      727    16023    1   DCL M$HEAD DCB;                        /* USED TO READ HEAD RECORD FOR RU PARAMS */
      728    16024        /**/
      729    16025        /*****************************************************************/
      730    16026        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      731    16027        /*****************************************************************/
      732    16028        /**/
      733    16029    1   DCL PCN_CMDS UBIN WORD SYMREF;
      734    16030        %P$PCB (NAME=P_PCB,STCLASS="BASED(P_PCB$)");
      735    16231    1   DCL B$JIT$ PTR SYMREF;
      736    16232    1   DCL B$DS5$ PTR SYMREF;
      737    16233    1   DCL B$TCB$ PTR SYMREF;
      738    16234    1   DCL 1 SUB_BUF_1 SYMREF,
      739    16235    1         2 COUNT UBIN(9) UNAL,
      740    16236    1         2 TEXT CHAR(31) UNAL;
      741    16237    1   DCL 1 SUB_BUF_2 SYMREF,
      742    16238    1         2 COUNT UBIN(9) UNAL,
      743    16239    1         2 TEXT CHAR(31) UNAL;
      744    16240    1   DCL 1 SUB_BUF_3 SYMREF,
      745    16241    1         2 COUNT UBIN(9) UNAL,
      746    16242    1         2 TEXT CHAR(31) UNAL;
      747    16243    1   DCL 1 ERR_CODE SYMREF,
      748    16244    1         2 FCG_MID BIT(18) UNAL,
      749    16245    1         2 MON BIT(1) UNAL,
      750    16246    1         2 ERR# UBIN(14) UNAL,
      751    16247    1         2 SEV UBIN(3) UNAL;
      752    16248        /**/
      753    16249        /*****************************************************************************/
      754    16250        /*   MONITOR SYMREFS   MONITOR SYMREFS   MONITOR SYMREFS   MONITOR SYMREFS   */
      755    16251        /*****************************************************************************/
      756    16252        /**/
      757    16253        %INCLUDE JM_CNTRLD_R;
      758    16262        %INCLUDE SS_CNTRLD_R;
      759    16271        /**/
      760    16272        %INCLUDE SS_CNTRL_R;
      761    16282        %INCLUDE FM_CNTRL_R;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:126  
      762    16291        %INCLUDE FR_CNTRL_R;                    /* CONTAINS FR_CNTRLD_D REFS ALSO     */
      763    16302        %INCLUDE FR_CNTRLD_R;
      764    16314        %INCLUDE FT_CNTRL_R;
      765    16403        %INCLUDE JS_CNTRL_R;
      766    16437        %INCLUDE FO_CNTRL_R;
      767    16462        %INCLUDE ES_CNTRL_R;
      768    16474        /**/
      769    16475        %INCLUDE JM_CNTRL_R;
      770    17364        %INCLUDE JZ_CNTRL_R;
      771    17373        %INCLUDE MM_CNTRL_R;
      772    17383        %INCLUDE B$TABLES_C;
      773    17491        /**/
      774    17492        %INCLUDE UMT_CNTRL_R;
      775    17501        /**/
      776    17502        %INCLUDE UQ_CNTRL_R;
      777    17511        /**/
      778    17512        %INCLUDE IG_CNTRLNR_R;
      779    17521    1   DCL B_MUAIS UBIN WORD SYMREF;           /* MAXU                               */
      780    17522    1   DCL B_CNTRL_HIGH UBIN WORD SYMREF;      /* BUFFER LIMITS                      */
      781    17523    1   DCL B_CNTRL_LOW UBIN WORD SYMREF;
      782    17524        /**/
      783    17525        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:127  
      784    17526        /********************************************************************/
      785    17527        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
      786    17528        /********************************************************************/
      787    17529        /**/
      788    17530        %B$XL_UPPER;
      789    17534        %FPT_TIME (FPTN=CUR_UTS,
      790    17535                SOURCE=CLOCK,
      791    17536                TSTAMP=CURUTS,
      792    17537                DEST=UTS);
      793    17556        /**/
      794    17557        %FPT_READ ( FPTN = READ_CMD_FPT,
      795    17558                    BUF = CMD_BUF,
      796    17559                    DCB = M$SI);
      797    17598        /**/
      798    17599        %FPT_WRITE    (FPTN = ECHO_FPT,
      799    17600                       BUF = CMD_BUF,
      800    17601                       DCB = M$LO);
      801    17632        /**/
      802    17633        %FPT_GDS ( FPTN = GDS_FPT,
      803    17634                   RESULTS = DS_RESULTS,
      804    17635                   SEGSIZE = 2048);
      805    17651        /**/
      806    17652        %FPT_SAD    (FPTN = ACCESS_FPT,
      807    17653                     USERSID = %SPCL1SID,
      808    17654                     MONSID = %ISSID);
      809    17669        /**/
      810    17670        %FPT_INT (FPTN = BREAK_FPT,
      811    17671                  UENTRY = PCB$BREAK);
      812    17685        /**/
      813    17686        %FPT_INT (FPTN = BREAKSET_FPT,
      814    17687                  UENTRY = PCB$BREAKSET);
      815    17701        /**/
      816    17702        %FPT_PRIV  (FPTN=PRIV_FPT,
      817    17703                    PRIV = %PPR_CNTRLC#,
      818    17704                    PPRIV = YES);
      819    17719        /**/
      820    17720        %FPT_WAIT (UNITS=1);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:128  
      821    17734        /**/
      822    17735        %FPT_OPEN     (FPTN=OPEN_CNTRL_FPT,
      823    17736                       DCB = M$CNTRL,
      824    17737                       NAME = CNTRL_FILE,
      825    17738                       ACCT = SYSACCT,
      826    17739                       ASN = FILE,
      827    17740                       FUN = UPDATE,
      828    17741                       DISP=NAMED);
      829    17850        /**/
      830    17851        %FPT_OPEN  (FPTN = OPEN_CONTROL_S,
      831    17852                    DCB = M$SI,
      832    17853                    NAME = CNTRLCMD_FILE,
      833    17854                    ACCT = SYSACCT,
      834    17855                    ASN = FILE,
      835    17856                    FUN = IN);
      836    17965        %FPT_OPEN (FPTN=OPEN_TP_CNTRL,
      837    17966                   DCB=M$TP,
      838    17967                   FUN=UPDATE,
      839    17968                   ORG=RANDOM,
      840    17969                   ACS=DS5,
      841    17970                   ASN=FILE,
      842    17971                   EXIST=OLDFILE,
      843    17972                   SHARE=ALL,
      844    17973                   CTG=YES,
      845    17974                   ACCESS=ACSLIST,
      846    17975                   ACSVEH=VEHLIST,
      847    17976                   ACCT=SYSACCT,
      848    17977                   NAME=TP_CNTRL_D);
      849    18086        %VLP_NAME (FPTN=TP_CNTRL_D,
      850    18087                   NAME='TP_CNTRL_D');
      851    18114        %VLP_ATTR (FPTN=ACSLIST);
      852    18128        %VLP_ACCESS (EXEC=YES,ACCT='?',LAST=";");
      853    18145        %VLP_ATTR (FPTN=VEHLIST);
      854    18159        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='CONTROL');
      855    18176        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='TPA');
      856    18193        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='TPCP');
      857    18210        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='SLUG');
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:129  
      858    18227        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,VEHICLE='STATS',LAST=";");
      859    18244        %FPT_CLOSE (FPTN=CLOSE_TP_FILE,
      860    18245                    DCB=M$TP,
      861    18246                    DISP=SAVE);
      862    18288        %FPT_EXTEND (FPTN=EXTEND_TP_FILE,
      863    18289                     DCB=M$TP,
      864    18290                     SIZ=1);
      865    18304        /**/
      866    18305        %FPT_WRITE    (FPTN = WRITE_CNTRL_FPT,
      867    18306                       DCB = M$CNTRL,
      868    18307                       KEY = CNTRL_KEY);
      869    18338        /**/
      870    18339        %FPT_CLOSE    (FPTN = CLOSE_CNTRL_FPT,
      871    18340                       DCB = M$CNTRL,
      872    18341                       DISP = SAVE);
      873    18383        /**/
      874    18384        %FPT_CLOSE    (FPTN = CLOSE_LO_FPT,
      875    18385                       DCB = M$LO,
      876    18386                       DISP = SAVE);
      877    18428        /**/
      878    18429        %VLP_NAME     (FPTN = CNTRL_FILE,
      879    18430                       NAME = ':CNTRL',
      880    18431                       LEN = 6);
      881    18458        /**/
      882    18459        %VLP_NAME  (FPTN = CNTRLCMD_FILE,
      883    18460                    NAME = 'CONTROL_S',
      884    18461                    LEN = 9);
      885    18488        %VLP_ACCT     (FPTN = SYSACCT,
      886    18489                       ACCT = ':SYS');
      887    18502        %FPT_FID (FPTN=HEAD_FID,
      888    18503                  ACCT=FID_ACCT,
      889    18504                  ASN=OPEN_RU.V.ASN#,
      890    18505                  NAME=FID_NAME,
      891    18506                  PASS=FID_PASS,
      892    18507                  RES=OPEN_RU.V.RES#,
      893    18508                  SN=FID_SN,
      894    18509                  RESULTS=FID_RESULTS,
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:130  
      895    18510                  WSN=FID_WSN);
      896    18533        %FPT_OPEN (FPTN=OPEN_RU,
      897    18534                   DCB=M$HEAD,
      898    18535                   FUN=UPDATE,
      899    18536                   SHARE=ALL,
      900    18537                   ORG=KEYED,
      901    18538                   ACCT=FID_ACCT,
      902    18539                   NAME=FID_NAME,
      903    18540                   PASS=FID_PASS,
      904    18541                   SN=FID_SN,
      905    18542                   WSN=FID_WSN);
      906    18651        %VLR_FID (FPTN=FID_RESULTS);
      907    18670        %VLP_NAME (FPTN=FID_NAME,LEN=31);
      908    18697        %VLP_ACCT (FPTN=FID_ACCT);
      909    18710        %VLP_PASS (FPTN=FID_PASS);
      910    18723        %VLP_WSN (FPTN=FID_WSN);
      911    18736        %VLP_SN (FPTN=FID_SN);
      912    18749        %FPT_READ (FPTN=READ_HEAD,
      913    18750                   DCB=M$HEAD,
      914    18751                   BUF=B$HEAD,
      915    18752                   KEYS=YES,
      916    18753                   KEY=HEADKEY);
      917    18792        %FPT_WRITE (FPTN=WRITE_HEAD,
      918    18793                    DCB=M$HEAD,
      919    18794                    BUF=B$HEAD,
      920    18795                    KEY=HEADKEY);
      921    18826       %FPT_TRAP (ERRORS=PCB$TRAP,MEMORY=TRAP,MISSING_PAGE=TRAP,SECURITY_1=TRAP,SECURITY_2=
             18826            TRAP,
      922    18827              MISSING_SEG=TRAP,LOCKUP=TRAP,COMMAND=TRAP,IPR=TRAP,HARDWARE=ABORT);
      923    18850        %FPT_CLOSE (FPTN=CLOSE_RU,
      924    18851                    DCB=M$HEAD,
      925    18852                    DISP=SAVE);
      926    18894        %FPT_PRIV (FPTN=FMS_PRIV,
      927    18895                   PRIV=%PR_FMSEC#);
      928    18910        %FPT_MONINFO (SITEINFO=VLR_SITEINFO);
      929    18925        %VLR_SITEINFO;
      930    18944        %FPT_EXIT(  FPTN=BYE_BYE, STCLASS="STATIC SYMDEF");
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:131  
      931    18959        /**/
      932    18960        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:132  
      933    18961        /*****************************************************************************/
      934    18962        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      935    18963        /*****************************************************************************/
      936    18964        /**/
      937    18965    1           PC_REASON=0;

  18965  9 000002   000006 450000 1                  STZ     PC_REASON

      938    18966    2           IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;

  18966  9 000003   000000 470400 xsym               LDP0    B$JIT$
         9 000004   000015 236100                    LDQ     13,,PR0
         9 000005   000056 376000 2                  ANQ     DUMP_LOCK_FMT+5
         9 000006   000013 601000 9                  TNZ     NEXT

      939    18967    2              CALL M$RPRIV(FMS_PRIV) ALTRET(NEXT);

  18967  9 000007   011234 630400 1                  EPPR0   FMS_PRIV
         9 000010   420013 713400                    CLIMB   alt,+8203
         9 000011   400000 401760                    pmme    nvectors=1
         9 000012   000013 702000 9                  TSX2    NEXT

  18967  9 000013                       NEXT         null
      940    18968    2        NEXT:;
      941    18969    2              END;  /* IF */

      942    18970    1           M$SI$ = DCBADDR(DCBNUM(M$SI));

  18970  9 000013   000000 236007 xsym               LDQ     M$SI,DL
         9 000014   000000 470400 10                 LDP0    0
         9 000015   000000 471500                    LDP1    0,,PR0
         9 000016   100000 236106                    LDQ     0,QL,PR1
         9 000017   000021 756000 1                  STQ     M$SI$

      943    18971        /**/
      944    18972    1           IF (PC$JIT$ -> B$JIT.MODE = %M_GHOST#)AND

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:133  
  18972  9 000020   000007 473400 1                  LDP3    PC$JITPTR
         9 000021   300000 236100                    LDQ     0,,PR3
         9 000022   740000 376003                    ANQ     -16384,DU
         9 000023   100000 116003                    CMPQ    32768,DU
         9 000024   000035 601000 9                  TNZ     s:18977
         9 000025   040000 106500                    CMPC    fill='040'O
         9 000026   300033 000400                    ADSC9   27,,PR3                  cn=0,n=256
         9 000027   000057 000021 2                  ADSC9   DUMP_LOCK_FMT+6          cn=0,n=17
         9 000030   000035 601000 9                  TNZ     s:18977

      945    18973    1              (PC$JIT$ -> B$JIT.CCBUF = 'CONTROL CONTROL_S') /* SYSTEM GHOST     */
      946    18974    1              THEN
      947    18975    1              CALL M$OPEN(OPEN_CONTROL_S) ALTRET (CONTROL_S_ERR);

  18975  9 000031   010364 630400 1                  EPPR0   OPEN_CONTROL_S
         9 000032   450000 713400                    CLIMB   alt,open
         9 000033   410400 401760                    pmme    nvectors=18
         9 000034   000563 702000 9                  TSX2    CONTROL_S_ERR

      948    18976        /**/
      949    18977    1           CALL M$SPRIV(PRIV_FPT) ALTRET(TRY_DISP);

  18977  9 000035   010260 630400 1                  EPPR0   PRIV_FPT
         9 000036   420012 713400                    CLIMB   alt,+8202
         9 000037   400000 401760                    pmme    nvectors=1
         9 000040   000042 702000 9                  TSX2    TRY_DISP

      950    18978    1           IF (NO) THEN

  18978  9 000041   000056 710000 9                  TRA     s:18987

      951    18979    2   TRY_DISP: DO;

  18979  9 000042                       TRY_DISP     null
      952    18980    2              PRIV_FPT.V.PRIV# = %PPR_CNTRLD#;

  18980  9 000042   000030 236000 xsym               LDQ     B_VECTNIL+24
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:134  
         9 000043   010262 756000 1                  STQ     PRIV_FPT+2

      953    18981    2              CALL M$SPRIV(PRIV_FPT)

  18981  9 000044   010260 630400 1                  EPPR0   PRIV_FPT
         9 000045   420012 713400                    CLIMB   alt,+8202
         9 000046   400000 401760                    pmme    nvectors=1
         9 000047   000051 702000 9                  TSX2    s:18983
         9 000050   000055 710000 9                  TRA     s:18985

      954    18982    3                  WHENALTRETURN DO;

      955    18983    3                     IF NOT (B$JIT.PRIV.AUTH & %(PR_SPCLMM#|PR_EXMM#)) THEN GOTO
             18983                              NO_ACCESS;

  18983  9 000051   000000 470400 xsym               LDP0    B$JIT$
         9 000052   000014 236100                    LDQ     12,,PR0
         9 000053   000005 376000 xsym               ANQ     B_VECTNIL+5
         9 000054   000554 600000 9                  TZE     NO_ACCESS

      956    18984    3                     END;

      957    18985    2              SETAUTH = NO;

  18985  9 000055   000035 450000 1                  STZ     SETAUTH

      958    18986    2              END;

      959    18987    1           CALL INDEX(I,'XXX',TEXT_CONTROLHERE);

  18987  9 000056   000025 631400 1                  EPPR1   I
         9 000057   000064 633400 2                  EPPR3   DUMP_LOCK_FMT+11
         9 000060   000003 223003                    LDX3    3,DU
         9 000061   002532 630400 1                  EPPR0   TEXT_CONTROLHERE
         9 000062   000023 220003                    LDX0    19,DU
         9 000063   000000 236003                    LDQ     0,DU
         9 000064   000000 701000 xent               TSX1    X66_INDEX
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:135  
         9 000065   000000 011000                    NOP     0

      960    18988    1           CALL CONCAT(TEXT_CONTROLHERE,'CONTROL ',SUBSTR(ADDR(B_VERSION)->B$VERSIONB.
             18988                     T_,

  18988  9 000066   000000 236000 xsym               LDQ     B_VERSION
         9 000067   000033 772000                    QRL     27
         9 000070   040000 100400                    MLR     fill='040'O
         9 000071   000057 000010 2                  ADSC9   DUMP_LOCK_FMT+6          cn=0,n=8
         9 000072   002532 000010 1                  ADSC9   TEXT_CONTROLHERE         cn=0,n=8
         9 000073   000000 621006                    EAX1    0,QL
         9 000074   040000 100440                    MLR     fill='040'O
         9 000075   000000 200011 xsym               ADSC9   B_VERSION                cn=1,n=*X1
         9 000076   002534 000013 1                  ADSC9   TEXT_CONTROLHERE+2       cn=0,n=11
         9 000077   000013 116007                    CMPQ    11,DL
         9 000100   000106 603000 9                  TRC     s:18990
         9 000101   777764 621006                    EAX1    -12,QL
         9 000102   777777 661003                    ERX1    -1,DU
         9 000103   040046 100400                    MLR     fill='040'O
         9 000104   000065 000005 2                  ADSC9   DUMP_LOCK_FMT+12         cn=0,n=5
         9 000105   002534 000011 1                  ADSC9   TEXT_CONTROLHERE+2,Q     cn=0,n=*X1

      961    18989    1                        0,ADDR(B_VERSION)->B$VERSIONB.C_),' here');
      962    18990    1           CALL PCW$WRITE(TEXT_CONTROLHERE,SIZEC(TEXT_CONTROLHERE));

  18990  9 000106   000002 630400 10                 EPPR0   2
         9 000107   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000110   000000 701000 xent               TSX1    PCW$WRITE
         9 000111   000000 011000                    NOP     0

      963    18991        /**/
      964    18992    1           CALL M$INT(BREAK_FPT);

  18992  9 000112   010250 630400 1                  EPPR0   BREAK_FPT
         9 000113   010002 713400                    CLIMB   4098
         9 000114   400000 401760                    pmme    nvectors=1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:136  
      965    18993    1           CALL M$TRAP (FPT_TRAP);

  18993  9 000115   011164 630400 1                  EPPR0   FPT_TRAP
         9 000116   010004 713400                    CLIMB   4100
         9 000117   400400 401760                    pmme    nvectors=2

      966    18994    1           REMEMBER CMD_READ IN REMEM_CMD_READ;

  18994  9 000120   000435 635000 9                  EAA     SKIP_IT
         9 000121   000036 452400 1                  STP2    REMEM_CMD_READ
         9 000122   000037 755000 1                  STA     REMEM_CMD_READ+1

      967    18995        /**/
      968    18996    1           MONPART$ = ADDR(JM_PT);

  18996  9 000123   000004 236000 10                 LDQ     4
         9 000124   000011 756000 1                  STQ     MONPART$

      969    18997    1           MONPARTPTR.SEGID = BITBIN(%SPCL1SID); /* PTR TO PART TABLES            */

  18997  9 000125   006021 236007                    LDQ     3089,DL
         9 000126   000011 752003 1                  STCQ    MONPART$,'03'O

      970    18998        /**/
      971    18999    1           CALL M$SAD (ACCESS_FPT) ALTRET (NO_ACCESS);

  18999  9 000127   010244 630400 1                  EPPR0   ACCESS_FPT
         9 000130   430015 713400                    CLIMB   alt,+12301
         9 000131   400000 401760                    pmme    nvectors=1
         9 000132   000554 702000 9                  TSX2    NO_ACCESS

      972    19000        /**/
      973    19001    1           MONPTR$ = ADDR(B_CNTRL_LOW);

  19001  9 000133   000005 236000 10                 LDQ     5
         9 000134   000010 756000 1                  STQ     MONPTR$

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:137  
      974    19002    1           MONPTR.SEGID = BITBIN(%SPCL1SID);

  19002  9 000135   006021 236007                    LDQ     3089,DL
         9 000136   000010 752003 1                  STCQ    MONPTR$,'03'O

      975    19003    1           WRITE_CNTRL_FPT.BUF_.BUF$ = MONPTR$; /* SET BUFFER ADDRESS AND SIZE   */

  19003  9 000137   000010 236000 1                  LDQ     MONPTR$
         9 000140   010641 756000 1                  STQ     WRITE_CNTRL_FPT+5

      976    19004    1           MONPTR$ = ADDR(B_CNTRL_HIGH);

  19004  9 000141   000006 236000 10                 LDQ     6
         9 000142   000010 756000 1                  STQ     MONPTR$

      977    19005    1           MONPTR.SEGID = BITBIN(%SPCL1SID);

  19005  9 000143   006021 236007                    LDQ     3089,DL
         9 000144   000010 752003 1                  STCQ    MONPTR$,'03'O

      978    19006    1           WRITE_CNTRL_FPT.BUF_.BOUND = POFFC(MONPTR$,WRITE_CNTRL_FPT.BUF_.BUF$)-1;

  19006  9 000145   010641 236000 1                  LDQ     WRITE_CNTRL_FPT+5
         9 000146   000020 772000                    QRL     16
         9 000147   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 000150   000010 236000 1                  LDQ     MONPTR$
         9 000151   000020 772000                    QRL     16
         9 000152   200076 136100                    SBLQ    TEMPTEXT+4,,AUTO
         9 000153   000001 136007                    SBLQ    1,DL
         9 000154   000020 736000                    QLS     16
         9 000155   010640 676000 1                  ERQ     WRITE_CNTRL_FPT+4
         9 000156   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000157   010640 656000 1                  ERSQ    WRITE_CNTRL_FPT+4

      979    19007        /**/
      980    19008    1           MONPTR$ = ADDR(FR_SUMX);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:138  
  19008  9 000160   000007 236000 10                 LDQ     7
         9 000161   000010 756000 1                  STQ     MONPTR$

      981    19009    1           MONPTR.SEGID = BITBIN(%SPCL1SID);

  19009  9 000162   006021 236007                    LDQ     3089,DL
         9 000163   000010 752003 1                  STCQ    MONPTR$,'03'O

      982    19010    1           NUM_PSURES = MONPTR$ -> B$TABLE(0) + 1; /* NUMBER OF PSEUDO RESOURCES */

  19010  9 000164   000010 470400 1                  LDP0    MONPTR$
         9 000165   000000 235100                    LDA     0,,PR0
         9 000166   000001 035007                    ADLA    1,DL
         9 000167   000012 755000 1                  STA     NUM_PSURES

      983    19011        /**/
      984    19012    1           MONPTR$ = ADDR(FR_SUNM);

  19012  9 000170   000010 236000 10                 LDQ     8
         9 000171   000010 756000 1                  STQ     MONPTR$

      985    19013    1           MONPTR.SEGID = BITBIN(%SPCL1SID);

  19013  9 000172   006021 236007                    LDQ     3089,DL
         9 000173   000010 752003 1                  STCQ    MONPTR$,'03'O

      986    19014    2           IF (NUM_PSURES ~= 0) THEN DO I = 0 TO NUM_PSURES-1;

  19014  9 000174   000000 115003                    CMPA    0,DU
         9 000175   000216 600000 9                  TZE     s:19018

  19014  9 000176   000025 450000 1                  STZ     I
         9 000177   000212 710000 9                  TRA     s:19016+1

      987    19015    2              PSURES_TEXT(I) = MONPTR$ -> PSURES$TEXT(I);

  19015  9 000200   000025 235000 1                  LDA     I
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:139  
         9 000201   000001 735000                    ALS     1
         9 000202   000025 236000 1                  LDQ     I
         9 000203   000003 736000                    QLS     3
         9 000204   000002 735000                    ALS     2
         9 000205   000010 470400 1                  LDP0    MONPTR$
         9 000206   040005 100506                    MLR     fill='040'O
         9 000207   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         9 000210   000042 000010 1                  ADSC9   PSURES_TEXT,A            cn=0,n=8

      988    19016    2              END;

  19016  9 000211   000025 054000 1                  AOS     I
         9 000212   000025 236000 1                  LDQ     I
         9 000213   000200 604000 9                  TMI     s:19015
         9 000214   000012 116000 1                  CMPQ    NUM_PSURES
         9 000215   000200 602000 9                  TNC     s:19015

      989    19017        /**/
      990    19018    1           P_PCB$ = ADDR(NIL);

  19018  9 000216   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000217   002115 756000 1                  STQ     P_PCB$

      991    19019    1           CALL XUR$INIT(XUR_INIT,P_PCB$);

  19019  9 000220   000011 630400 10                 EPPR0   9
         9 000221   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000222   000000 701000 xent               TSX1    XUR$INIT
         9 000223   000000 011000                    NOP     0

      992    19020    1           DS_RESULTS = NO;

  19020  9 000224   000000 235003                    LDA     0,DU
         9 000225   000000 236003                    LDQ     0,DU
         9 000226   002540 757000 1                  STAQ    DS_RESULTS

      993    19021    1           CALL M$GDS(GDS_FPT) ALTRET (GDS_ERR);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:140  

  19021  9 000227   010236 630400 1                  EPPR0   GDS_FPT
         9 000230   430001 713400                    CLIMB   alt,gds
         9 000231   400400 401760                    pmme    nvectors=2
         9 000232   000533 702000 9                  TSX2    GDS_ERR

      994    19022    1           P_PCB.WORK$ = DS_RESULTS.PTR$;

  19022  9 000233   002541 236000 1                  LDQ     DS_RESULTS+1
         9 000234   002115 470400 1                  LDP0    P_PCB$
         9 000235   000002 756100                    STQ     2,,PR0

      995    19023    1           CALL XUG$INIT(XUG_GETCMD,XUG_INIT);

  19023  9 000236   000013 630400 10                 EPPR0   11
         9 000237   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000240   000000 701000 xent               TSX1    XUG$INIT
         9 000241   000000 011000                    NOP     0

      996    19024        /**/
      997    19025        /* For fast machines, we need to update max,min values some  */
      998    19026    1         CALL M$MONINFO (FPT_MONINFO) ALTRET (SKIP_IT);

  19026  9 000242   011240 630400 1                  EPPR0   FPT_MONINFO
         9 000243   420023 713400                    CLIMB   alt,+8211
         9 000244   402400 401760                    pmme    nvectors=6
         9 000245   000435 702000 9                  TSX2    SKIP_IT

      999    19027    1         IF VLR_SITEINFO.CPU_TYPE# = %DPS90 OR

  19027  9 000246   011343 236000 1                  LDQ     VLR_SITEINFO+55
         9 000247   777000 376007                    ANQ     -512,DL
         9 000250   004000 116007                    CMPQ    2048,DL
         9 000251   000254 600000 9                  TZE     s:19030
         9 000252   005000 116007                    CMPQ    2560,DL
         9 000253   000257 601000 9                  TNZ     s:19033

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:141  
     1000    19028    1            VLR_SITEINFO.CPU_TYPE# = %DPS90XA
     1001    19029    2         THEN DO;

     1002    19030    2            SYSTEM_TBL.QMIN.MIN = 2;

  19030  9 000254   000002 235007                    LDA     2,DL
         9 000255   002664 755000 1                  STA     SYSTEM_TBL+82

     1003    19031    2            SYSTEM_TBL.QUAN.MIN = 2;

  19031  9 000256   002700 755000 1                  STA     SYSTEM_TBL+94

     1004    19032    2            END;

     1005    19033    1         IF VLR_SITEINFO.CPU_TYPE# = %DPS8000

  19033  9 000257   006000 116007                    CMPQ    3072,DL
         9 000260   000264 601000 9                  TNZ     s:19038

     1006    19034    2         THEN DO;

     1007    19035    2            SYSTEM_TBL.QMIN.MIN = 10;

  19035  9 000261   000012 235007                    LDA     10,DL
         9 000262   002664 755000 1                  STA     SYSTEM_TBL+82

     1008    19036    2            SYSTEM_TBL.QUAN.MIN = 10;

  19036  9 000263   002700 755000 1                  STA     SYSTEM_TBL+94

     1009    19037    2            END;

     1010    19038    1           PC_REASON=%PC_TP_CNTRL_D;

  19038  9 000264   000001 235007                    LDA     1,DL
         9 000265   000006 755000 1                  STA     PC_REASON

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:142  
     1011    19039    1           MAXTPU_TBL = '0'B;

  19039  9 000266   000000 100400                    MLR     fill='000'O
         9 000267   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 000270   004557 002200 1                  ADSC9   MAXTPU_TBL               cn=0,n=1152

     1012    19040    1           CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(CMD_READ);

  19040  9 000271   010456 630400 1                  EPPR0   OPEN_TP_CNTRL
         9 000272   450000 713400                    CLIMB   alt,open
         9 000273   410400 401760                    pmme    nvectors=18
         9 000274   000435 702000 9                  TSX2    SKIP_IT

     1013    19041    1           HDR$ = B$DS5$;

  19041  9 000275   000000 236000 xsym               LDQ     B$DS5$
         9 000276   000022 756000 1                  STQ     HDR$

     1014    19042    1           TBLINSTANCES = PC$HDR.CURINSTANCES;

  19042  9 000277   000000 470400 xsym               LDP0    B$DS5$
         9 000300   000000 235100                    LDA     0,,PR0
         9 000301   000032 755000 1                  STA     TBLINSTANCES

     1015    19043    1           CUR_SIZE_OF_DATA = SIZEW(PC$HDR) + TBLINSTANCES * SIZEW(PC$INSTANCE);

  19043  9 000302   000032 236000 1                  LDQ     TBLINSTANCES
         9 000303   000113 402007                    MPY     75,DL
         9 000304   000001 036007                    ADLQ    1,DL
         9 000305   200027 756100                    STQ     CUR_SIZE_OF_DATA,,AUTO

     1016    19044    1           CUR_SIZE_OF_FILE = DCBADDR(DCBNUM(M$TP))->F$DCB.NRECS# * %WORDS_PER_GRAN;

  19044  9 000306   000000 236007 xsym               LDQ     M$TP,DL
         9 000307   000000 471400 10                 LDP1    0
         9 000310   100000 473500                    LDP3    0,,PR1
         9 000311   300000 474506                    LDP4    0,QL,PR3
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:143  
         9 000312   400042 235100                    LDA     34,,PR4
         9 000313   000012 735000                    ALS     10
         9 000314   200026 755100                    STA     CUR_SIZE_OF_FILE,,AUTO

     1017    19045    1           WORDS_AVAIL = CUR_SIZE_OF_FILE - CUR_SIZE_OF_DATA;

  19045  9 000315   200026 236100                    LDQ     CUR_SIZE_OF_FILE,,AUTO
         9 000316   200027 136100                    SBLQ    CUR_SIZE_OF_DATA,,AUTO
         9 000317   001733 756000 1                  STQ     WORDS_AVAIL

     1018    19046    1           CURINSTANCES = 0;

  19046  9 000320   000031 450000 1                  STZ     CURINSTANCES

     1019    19047    1           INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  19047  9 000321   000000 236000 xsym               LDQ     B$DS5$
         9 000322   000001 036003                    ADLQ    1,DU
         9 000323   200031 756100                    STQ     INSTANCE$,,AUTO

     1020    19048    2           DO I = 0 TO TBLINSTANCES - 1;

  19048  9 000324   000025 450000 1                  STZ     I
         9 000325   000425 710000 9                  TRA     s:19063+1

     1021    19049    2              MAXTPU_TBL.NAME(I) = PC$INSTANCE.INSTANCE_NAME;

  19049  9 000326   000025 235000 1                  LDA     I
         9 000327   000002 735000                    ALS     2
         9 000330   000002 735000                    ALS     2
         9 000331   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 000332   040005 100500                    MLR     fill='040'O
         9 000333   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         9 000334   004557 000010 1                  ADSC9   MAXTPU_TBL,A             cn=0,n=8

     1022    19050    2              K = 0;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:144  
  19050  9 000335   000027 450000 1                  STZ     K

     1023    19051    3              DO WHILE(SUBSTR(MAXTPU_TBL.NAME(I),K,1) ~= ' ' AND K < 8);

  19051  9 000336   000340 710000 9                  TRA     s:19053

     1024    19052    3                 K = K + 1;

  19052  9 000337   000027 054000 1                  AOS     K

     1025    19053    3                 END;  /* DO K */

  19053  9 000340   000025 236000 1                  LDQ     I
         9 000341   000004 736000                    QLS     4
         9 000342   000027 036000 1                  ADLQ    K
         9 000343   040000 106406                    CMPC    fill='040'O
         9 000344   004557 000001 1                  ADSC9   MAXTPU_TBL,Q             cn=0,n=1
         9 000345   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000346   000352 600000 9                  TZE     s:19054
         9 000347   000027 235000 1                  LDA     K
         9 000350   000010 115007                    CMPA    8,DL
         9 000351   000337 604000 9                  TMI     s:19052

     1026    19054    2              MAXTPU_TBL.FLAGS.DELETED(I) = PC$INSTANCE.FLAGS.DELETED;

  19054  9 000352   000025 235000 1                  LDA     I
         9 000353   000002 735000                    ALS     2
         9 000354   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 000355   000003 236100                    LDQ     3,,PR0
         9 000356   000022 772000                    QRL     18
         9 000357   004562 676005 1                  ERQ     MAXTPU_TBL+3,AL
         9 000360   200000 376007                    ANQ     65536,DL
         9 000361   004562 656005 1                  ERSQ    MAXTPU_TBL+3,AL

     1027    19055    2              IF NOT PC$INSTANCE.FLAGS.DELETED

  19055  9 000362   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:145  
         9 000363   200000 316003                    CANQ    65536,DU
         9 000364   000366 601000 9                  TNZ     s:19057

     1028    19056    2                 THEN CURINSTANCES = CURINSTANCES + 1;

  19056  9 000365   000031 054000 1                  AOS     CURINSTANCES

     1029    19057    2              MAXTPU_TBL.COUNT(I) = K;

  19057  9 000366   000025 235000 1                  LDA     I
         9 000367   000002 735000                    ALS     2
         9 000370   000027 720000 1                  LXL0    K
         9 000371   004562 740005 1                  STX0    MAXTPU_TBL+3,AL

     1030    19058    2              MAXTPU_TBL.MAXTPU(I) = PC$INSTANCE.MAXTPU;

  19058  9 000372   000025 235000 1                  LDA     I
         9 000373   000002 735000                    ALS     2
         9 000374   000000 621005                    EAX1    0,AL
         9 000375   000002 235100                    LDA     2,,PR0
         9 000376   004561 755011 1                  STA     MAXTPU_TBL+2,X1

     1031    19059    2              TPHDR_TBL.FLAGS.PRESENT(I) =  PC$INSTANCE.FLAGS.HEADER;

  19059  9 000377   000025 236000 1                  LDQ     I
         9 000400   000025 402007                    MPY     21,DL
         9 000401   000000 621006                    EAX1    0,QL
         9 000402   000003 236100                    LDQ     3,,PR0
         9 000403   000010 772000                    QRL     8
         9 000404   005243 676011 1                  ERQ     TPHDR_TBL+20,X1
         9 000405   000200 376003                    ANQ     128,DU
         9 000406   005243 656011 1                  ERSQ    TPHDR_TBL+20,X1

     1032    19060    2              IF (TPHDR_TBL.FLAGS.PRESENT(I)) THEN

  19060  9 000407   000025 236000 1                  LDQ     I
         9 000410   000025 402007                    MPY     21,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:146  
         9 000411   005243 236006 1                  LDQ     TPHDR_TBL+20,QL
         9 000412   000200 316003                    CANQ    128,DU
         9 000413   000421 600000 9                  TZE     s:19062

     1033    19061    2                 TPHDR_TBL.HDR(I) = PC$INSTANCE.HDR;

  19061  9 000414   000025 236000 1                  LDQ     I
         9 000415   000124 402007                    MPY     84,DL
         9 000416   000006 100500                    MLR     fill='000'O
         9 000417   000004 000121                    ADSC9   4,,PR0                   cn=0,n=81
         9 000420   005217 000121 1                  ADSC9   TPHDR_TBL,Q              cn=0,n=81

     1034    19062    2              INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

  19062  9 000421   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 000422   000113 036003                    ADLQ    75,DU
         9 000423   200031 756100                    STQ     INSTANCE$,,AUTO

     1035    19063    2              END;  /* DO I */

  19063  9 000424   000025 054000 1                  AOS     I
         9 000425   000025 236000 1                  LDQ     I
         9 000426   000032 116000 1                  CMPQ    TBLINSTANCES
         9 000427   000326 604000 9                  TMI     s:19049

     1036    19064    1           CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(CMD_READ);

  19064  9 000430   010572 630400 1                  EPPR0   CLOSE_TP_FILE
         9 000431   450001 713400                    CLIMB   alt,close
         9 000432   406000 401760                    pmme    nvectors=13
         9 000433   000435 702000 9                  TSX2    SKIP_IT

     1037    19065    1           PC_REASON=0;

  19065  9 000434   000006 450000 1                  STZ     PC_REASON

  19065  9 000435                       SKIP_IT      null
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:147  
     1038    19066    1   SKIP_IT:;
     1039    19067        /**/
     1040    19068    1   CMD_READ:
     1041    19069    1           CALL XUR$GETCMD(PCN_CMDS,P_PCB.OUT$,VECTOR(DASH)) ALTRET(PARSE_ERR);

  19069  9 000435   000020 236000 10    CMD_READ     LDQ     16
         9 000436   200100 756100                    STQ     TEMPTEXT+6,,AUTO
         9 000437   002115 236000 1                  LDQ     P_PCB$
         9 000440   000003 036003                    ADLQ    3,DU
         9 000441   000021 235000 10                 LDA     17
         9 000442   200076 757100                    STAQ    TEMPTEXT+4,,AUTO
         9 000443   200076 630500                    EPPR0   TEMPTEXT+4,,AUTO
         9 000444   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000445   000000 701000 xent               TSX1    XUR$GETCMD
         9 000446   000542 702000 9                  TSX2    PARSE_ERR

     1042    19070        /**/
     1043    19071    2           DO CASE (P_PCB.OUT$ -> O$BLK.CODE);

  19071  9 000447   002115 470400 1                  LDP0    P_PCB$
         9 000450   000003 471500                    LDP1    3,,PR0
         9 000451   100000 720100                    LXL0    0,,PR1
         9 000452   000016 100003                    CMPX0   14,DU
         9 000453   000455 602010 9                  TNC     s:19071+6,X0
         9 000454   000532 710000 9                  TRA     s:19094
         9 000455   000532 710000 9                  TRA     s:19094
         9 000456   000473 710000 9                  TRA     s:19073
         9 000457   000476 710000 9                  TRA     s:19075
         9 000460   000501 710000 9                  TRA     s:19077
         9 000461   000507 710000 9                  TRA     s:19081
         9 000462   000515 710000 9                  TRA     s:19085
         9 000463   000504 710000 9                  TRA     s:19079
         9 000464   000520 710000 9                  TRA     s:19087
         9 000465   000523 710000 9                  TRA     END_LBL
         9 000466   000532 710000 9                  TRA     s:19094
         9 000467   000532 710000 9                  TRA     s:19094
         9 000470   000532 710000 9                  TRA     s:19094
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:148  
         9 000471   000532 710000 9                  TRA     s:19094
         9 000472   000512 710000 9                  TRA     s:19083

     1044    19072    2            CASE (%PC_ADD);

     1045    19073    2              CALL EXEC_ADD ALTRET(CMD_READ);

  19073  9 000473   000667 701000 9                  TSX1    EXEC_ADD
         9 000474   000435 702000 9                  TSX2    SKIP_IT
         9 000475   000532 710000 9                  TRA     s:19094

     1046    19074    2            CASE (%PC_DROP);

     1047    19075    2              CALL EXEC_DROP ALTRET(CMD_READ);

  19075  9 000476   000673 701000 9                  TSX1    EXEC_DROP
         9 000477   000435 702000 9                  TSX2    SKIP_IT
         9 000500   000532 710000 9                  TRA     s:19094

     1048    19076    2            CASE (%PC_LIST);

     1049    19077    2              CALL EXEC_LIST ALTRET(CMD_READ);

  19077  9 000501   012471 701000 9                  TSX1    EXEC_LIST
         9 000502   000435 702000 9                  TSX2    SKIP_IT
         9 000503   000532 710000 9                  TRA     s:19094

     1050    19078    2            CASE (%PC_DISPLAY);

     1051    19079    2              CALL EXEC_DISPLAY ALTRET(CMD_READ);

  19079  9 000504   002132 701000 9                  TSX1    EXEC_DISPLAY
         9 000505   000435 702000 9                  TSX2    SKIP_IT
         9 000506   000532 710000 9                  TRA     s:19094

     1052    19080    2            CASE (%PC_SET);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:149  
     1053    19081    2              CALL EXEC_SET ALTRET(CMD_READ);

  19081  9 000507   004666 701000 9                  TSX1    EXEC_SET
         9 000510   000435 702000 9                  TSX2    SKIP_IT
         9 000511   000532 710000 9                  TRA     s:19094

     1054    19082    2            CASE (%PC_DELETE);

     1055    19083    2              CALL EXEC_DELETE;

  19083  9 000512   012251 701000 9                  TSX1    EXEC_DELETE
         9 000513   000000 011000                    NOP     0
         9 000514   000532 710000 9                  TRA     s:19094

     1056    19084    2            CASE (%PC_STORE);

     1057    19085    2              CALL EXEC_STORE ALTRET(CMD_READ);

  19085  9 000515   013313 701000 9                  TSX1    EXEC_STORE
         9 000516   000435 702000 9                  TSX2    SKIP_IT
         9 000517   000532 710000 9                  TRA     s:19094

     1058    19086    2            CASE (%PC_CLEAR);

     1059    19087    2              CALL EXEC_CLEAR ALTRET(CMD_READ);

  19087  9 000520   013561 701000 9                  TSX1    EXEC_CLEAR
         9 000521   000435 702000 9                  TSX2    SKIP_IT
         9 000522   000532 710000 9                  TRA     s:19094

     1060    19088    2            CASE (%PC_END);

     1061    19089    2   END_LBL:   CALL M$CLOSE (CLOSE_LO_FPT);

  19089  9 000523   010706 630400 1     END_LBL      EPPR0   CLOSE_LO_FPT
         9 000524   050001 713400                    CLIMB   close
         9 000525   406000 401760                    pmme    nvectors=13
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:150  

     1062    19090    2              CALL M$EXIT( BYE_BYE);

  19090  9 000526   011352 630400 1                  EPPR0   BYE_BYE
         9 000527   000001 713400                    CLIMB   exit
         9 000530   400400 401760                    pmme    nvectors=2
         9 000531   000532 710000 9                  TRA     s:19094

     1063    19091    2            CASE (%PC_NULL);

     1064    19092                      /* DO NOTHING */
     1065    19093    2            END;

     1066    19094    1           GOTO CMD_READ;

  19094  9 000532   000435 710000 9                  TRA     SKIP_IT

     1067    19095        /**/
     1068    19096    1   GDS_ERR:
     1069    19097    1           CALL PCE$ERROR (%E$P_NOMEMORY,3);

  19097  9 000533   000023 630400 10    GDS_ERR      EPPR0   19
         9 000534   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000535   000000 701000 xent               TSX1    PCE$ERROR
         9 000536   000000 011000                    NOP     0

     1070    19098    1           CALL M$EXIT( BYE_BYE);

  19098  9 000537   011352 630400 1                  EPPR0   BYE_BYE
         9 000540   000001 713400                    CLIMB   exit
         9 000541   400400 401760                    pmme    nvectors=2

     1071    19099        /**/
     1072    19100        /*E*     ERROR:    PCC-E$P_NOMEMORY-0
     1073    19101                 MESSAGE: Unable to get memory for parse work area - CONTROL exitting
     1074    19102                 DESCRIPTION: CANT GET X$PARSE WORK AREA DATA SEGMENT - GIVE UP */
     1075    19103        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:151  
     1076    19104    1   PARSE_ERR:
     1077    19105    1           CALL XUR$ERRMSG (P_PCB.OUT$);

  19105  9 000542   002115 236000 1     PARSE_ERR    LDQ     P_PCB$
         9 000543   000003 036003                    ADLQ    3,DU
         9 000544   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 000545   200076 630500                    EPPR0   TEMPTEXT+4,,AUTO
         9 000546   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000547   000000 701000 xent               TSX1    XUR$ERRMSG
         9 000550   000000 011000                    NOP     0

     1078    19106    1           CALL M$EXIT( BYE_BYE);

  19106  9 000551   011352 630400 1                  EPPR0   BYE_BYE
         9 000552   000001 713400                    CLIMB   exit
         9 000553   400400 401760                    pmme    nvectors=2

     1079    19107        /**/
     1080    19108        /*E*     ERROR:    PCC-E$P_PARSEERR-0
     1081    19109                 MESSAGE:  Syntax error
     1082    19110                 DESCRIPTION: SYNTAX ERROR               */
     1083    19111        /**/
     1084    19112    1   NO_ACCESS:
     1085    19113    1           CALL PCE$ERROR(%E$P_NOACCESS,4);

  19113  9 000554   000026 630400 10    NO_ACCESS    EPPR0   22
         9 000555   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000556   000000 701000 xent               TSX1    PCE$ERROR
         9 000557   000000 011000                    NOP     0

     1086    19114    1           CALL M$EXIT( BYE_BYE);

  19114  9 000560   011352 630400 1                  EPPR0   BYE_BYE
         9 000561   000001 713400                    CLIMB   exit
         9 000562   400400 401760                    pmme    nvectors=2

     1087    19115        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:152  
     1088    19116        /*E*     ERROR:    PCC-E$P_NOACCESS-0
     1089    19117                 MESSAGE:  You dont have the privilege necessary to use CONTROL
     1090    19118                 DESCRIPTION: UNDERPRIVILEGED USER - GIVE UP       */
     1091    19119    1   CONTROL_S_ERR:
     1092    19120    1           CALL PCE$ERROR(%E$P_NOCMDFILE,4);

  19120  9 000563   000031 630400 10    CONTROL_S_E* EPPR0   25
         9 000564   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000565   000000 701000 xent               TSX1    PCE$ERROR
         9 000566   000000 011000                    NOP     0

     1093    19121    1           CALL M$EXIT( BYE_BYE);

  19121  9 000567   011352 630400 1                  EPPR0   BYE_BYE
         9 000570   000001 713400                    CLIMB   exit
         9 000571   400400 401760                    pmme    nvectors=2
         9 000572   013625 710000 9                  TRA     s:21244

     1094    19122        /**/
     1095    19123        /*E*    ERROR:  PCC-E$P_NOCMDFILE-0
     1096    19124                MESSAGE: Cannot open CONTROL command file - CONTROL_S.:SYS
     1097    19125                DESCRIPTION: NO COMMAND FILE    */
     1098    19126        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:153  
     1099    19127        /**/
     1100    19128    1   READ_CMD: PROC ALTRET;

  19128  9 000573   200054 741300       READ_CMD     STX1  ! TEMPLEN+1,,AUTO

     1101    19129        /**/
     1102    19130    2   REREAD:
     1103    19131        /**/
     1104    19132    2           CMD_BUF = ' ';

  19132  9 000574   040000 100400       REREAD       MLR     fill='040'O
         9 000575   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000576   000063 000400 1                  ADSC9   CMD_BUF                  cn=0,n=256

     1105    19133    2           CALL M$READ (READ_CMD_FPT) ALTRET (READ_ERR);

  19133  9 000577   010204 630400 1                  EPPR0   READ_CMD_FPT
         9 000600   440000 713400                    CLIMB   alt,read
         9 000601   401400 401760                    pmme    nvectors=4
         9 000602   000656 702000 9                  TSX2    READ_ERR

     1106    19134        /**/
     1107    19135    2           P_PCB.NCHARS = M$SI$ -> F$DCB.ARS#;

  19135  9 000603   000021 470400 1                  LDP0    M$SI$
         9 000604   000000 235100                    LDA     0,,PR0
         9 000605   002115 471400 1                  LDP1    P_PCB$
         9 000606   100011 755100                    STA     9,,PR1

     1108    19136        /**/
     1109    19137    2           IF (CMD_BUF = ' ') THEN GOTO REREAD;

  19137  9 000607   040000 106400                    CMPC    fill='040'O
         9 000610   000063 000400 1                  ADSC9   CMD_BUF                  cn=0,n=256
         9 000611   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000612   000574 600000 9                  TZE     REREAD

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:154  
     1110    19138        /**/
     1111    19139    2           IF ((PC$JIT$ -> B$JIT.MODE = %M_BATCH#)OR

  19139  9 000613   000007 471400 1                  LDP1    PC$JITPTR
         9 000614   100000 236100                    LDQ     0,,PR1
         9 000615   740000 376003                    ANQ     -16384,DU
         9 000616   040000 116003                    CMPQ    16384,DU
         9 000617   000642 600000 9                  TZE     s:19144
         9 000620   100143 236100                    LDQ     99,,PR1
         9 000621   000012 376000 xsym               ANQ     B_VECTNIL+10
         9 000622   000626 600000 9                  TZE     s:19139+11
         9 000623   000004 236100                    LDQ     4,,PR0
         9 000624   040000 316007                    CANQ    16384,DL
         9 000625   000642 601000 9                  TNZ     s:19144
         9 000626   100000 236100                    LDQ     0,,PR1
         9 000627   740000 376003                    ANQ     -16384,DU
         9 000630   100000 116003                    CMPQ    32768,DU
         9 000631   000654 601000 9                  TNZ     s:19147
         9 000632   000000 236007 xsym               LDQ     M$UC,DL
         9 000633   000000 473400 10                 LDP3    0
         9 000634   300000 474500                    LDP4    0,,PR3
         9 000635   400000 475506                    LDP5    0,QL,PR4
         9 000636   500032 236100                    LDQ     26,,PR5
         9 000637   777000 376007                    ANQ     -512,DL
         9 000640   003000 116007                    CMPQ    1536,DL
         9 000641   000654 601000 9                  TNZ     s:19147

     1112    19140    2             ((PC$JIT$ -> B$JIT.CPFLAGS1 & %CP_ECHO#)AND
     1113    19141    2             (M$SI$ -> F$DCB.DDEV.XEQ#))OR
     1114    19142    2             ((PC$JIT$ -> B$JIT.MODE = %M_GHOST#)AND
     1115    19143    3             (DCBADDR(DCBNUM(M$UC)) -> F$DCB.ASN# = %DEVICE#))) THEN DO;

     1116    19144    3              ECHO_FPT.BUF_.BOUND = P_PCB.NCHARS-1;

  19144  9 000642   002115 473400 1                  LDP3    P_PCB$
         9 000643   300011 236100                    LDQ     9,,PR3
         9 000644   000001 136007                    SBLQ    1,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:155  
         9 000645   000020 736000                    QLS     16
         9 000646   010226 676000 1                  ERQ     ECHO_FPT+4
         9 000647   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000650   010226 656000 1                  ERSQ    ECHO_FPT+4

     1117    19145    3              CALL M$WRITE(ECHO_FPT);

  19145  9 000651   010222 630400 1                  EPPR0   ECHO_FPT
         9 000652   040001 713400                    CLIMB   write
         9 000653   401400 401760                    pmme    nvectors=4

     1118    19146    3              END;

     1119    19147    2           RETURN;

  19147  9 000654   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 000655   000001 702211                    TSX2  ! 1,X1

     1120    19148        /**/
     1121    19149    2   READ_ERR:
     1122    19150    2           CALL PCE$ERROR(0,3);

  19150  9 000656   000033 630400 10    READ_ERR     EPPR0   27
         9 000657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000660   000000 701000 xent               TSX1    PCE$ERROR
         9 000661   000000 011000                    NOP     0

     1123    19151    2           CALL M$EXIT( BYE_BYE);

  19151  9 000662   011352 630400 1                  EPPR0   BYE_BYE
         9 000663   000001 713400                    CLIMB   exit
         9 000664   400400 401760                    pmme    nvectors=2

     1124    19152    2   END;

  19152  9 000665   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 000666   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:156  

     1125    19153        /**/
     1126    19154        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:157  
     1127    19155        /**/
     1128    19156    1   EXEC_ADD: PROC ALTRET;

  19156  9 000667   200054 741300       EXEC_ADD     STX1  ! TEMPLEN+1,,AUTO

     1129    19157        /**/
     1130    19158    2           BITVAL = YES;

  19158  9 000670   400000 236003                    LDQ     -131072,DU
         9 000671   000033 756000 1                  STQ     BITVAL

     1131    19159    2           GOTO START_CMD;

  19159  9 000672   000675 710000 9                  TRA     START_CMD

     1132    19160        /**/
     1133    19161    2   EXEC_DROP: ENTRY ALTRET;

  19161  9 000673   200054 741300       EXEC_DROP    STX1  ! TEMPLEN+1,,AUTO

     1134    19162        /**/
     1135    19163    2           BITVAL = NO;

  19163  9 000674   000033 450000 1                  STZ     BITVAL

     1136    19164        /**/
     1137    19165    2   START_CMD:
     1138    19166    3           IF (P_PCB.OUT$ -> O$BLK.NSUBLKS = 1) THEN DO; /* ALL BY DEFAULT       */

  19166  9 000675   002115 470400 1     START_CMD    LDP0    P_PCB$
         9 000676   000003 471500                    LDP1    3,,PR0
         9 000677   100001 220100                    LDX0    1,,PR1
         9 000700   000001 100003                    CMPX0   1,DU
         9 000701   000716 601000 9                  TNZ     s:19172

     1139    19167    3              P_PCB.OUT$ -> O$BLK.NSUBLKS = 2;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:158  
  19167  9 000702   000002 222003                    LDX2    2,DU
         9 000703   100001 742100                    STX2    1,,PR1

     1140    19168    3              P_PCB.OUT$ -> O$BLK.SUBLK$(1) = PINCRW(P_PCB.OUT$,10);

  19168  9 000704   002115 470400 1                  LDP0    P_PCB$
         9 000705   000003 471500                    LDP1    3,,PR0
         9 000706   000003 236100                    LDQ     3,,PR0
         9 000707   000012 036003                    ADLQ    10,DU
         9 000710   100004 756100                    STQ     4,,PR1

     1141    19169    3              P_PCB.OUT$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE = %PC_ALL;

  19169  9 000711   002115 470400 1                  LDP0    P_PCB$
         9 000712   000003 471500                    LDP1    3,,PR0
         9 000713   100004 473500                    LDP3    4,,PR1
         9 000714   000001 220003                    LDX0    1,DU
         9 000715   300000 440100                    SXL0    0,,PR3

     1142    19170    3              END;

     1143    19171        /**/
     1144    19172    3           DO I = 1 TO P_PCB.OUT$ -> O$BLK.NSUBLKS - 1;

  19172  9 000716   000001 235007                    LDA     1,DL
         9 000717   000025 755000 1                  STA     I
         9 000720   002114 710000 9                  TRA     s:19399+1

     1145    19173    3              BLK$ = P_PCB.OUT$ -> O$BLK.SUBLK$(I);

  19173  9 000721   002115 470400 1                  LDP0    P_PCB$
         9 000722   000003 471500                    LDP1    3,,PR0
         9 000723   000025 720000 1                  LXL0    I
         9 000724   100003 236110                    LDQ     3,X0,PR1
         9 000725   000015 756000 1                  STQ     BLK$

     1146    19174        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:159  
     1147    19175    4              DO CASE (BLK$ -> O$BLK.CODE);

  19175  9 000726   000015 473400 1                  LDP3    BLK$
         9 000727   300000 721100                    LXL1    0,,PR3
         9 000730   000007 101003                    CMPX1   7,DU
         9 000731   000733 602011 9                  TNC     s:19175+5,X1
         9 000732   002113 710000 9                  TRA     s:19399
         9 000733   002113 710000 9                  TRA     s:19399
         9 000734   000742 710000 9                  TRA     s:19178
         9 000735   001142 710000 9                  TRA     s:19215
         9 000736   001151 710000 9                  TRA     s:19219
         9 000737   001242 710000 9                  TRA     s:19254
         9 000740   001251 710000 9                  TRA     s:19258
         9 000741   001423 710000 9                  TRA     s:19286

     1148    19176        /**/
     1149    19177    4               CASE (%PC_ALL);

     1150    19178    5                 DO J = 1 TO %PC_MAXMODE;

  19178  9 000742   000001 235007                    LDA     1,DL
         9 000743   000026 755000 1                  STA     J

     1151    19179    5                    INDEX_FLGS.MODE(J) = BITVAL;

  19179  9 000744   000026 235000 1                  LDA     J
         9 000745   000747 605000 9                  TPL     s:19179+3
         9 000746   000044 035003                    ADLA    36,DU
         9 000747   003005 060400                    CSL     bolr='003'O
         9 000750   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 000751   000226 000001 1                  BDSC    INDEX_FLGS,A             by=0,bit=0,n=1

     1152    19180    5                    END;

  19180  9 000752   000026 054000 1                  AOS     J
         9 000753   000026 235000 1                  LDA     J
         9 000754   000004 115007                    CMPA    4,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:160  
         9 000755   000744 604400 9                  TMOZ    s:19179

     1153    19181        /**/
     1154    19182    5                 DO J = 0 TO 15;

  19182  9 000756   000026 450000 1                  STZ     J

     1155    19183    5                    INDEX_FLGS.PART#(J) = BITVAL;

  19183  9 000757   000026 235000 1                  LDA     J
         9 000760   000762 605000 9                  TPL     s:19183+3
         9 000761   000044 035003                    ADLA    36,DU
         9 000762   003005 060400                    CSL     bolr='003'O
         9 000763   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 000764   000226 050001 1                  BDSC    INDEX_FLGS,A             by=0,bit=5,n=1

     1156    19184    5                    END;

  19184  9 000765   000026 054000 1                  AOS     J
         9 000766   000026 235000 1                  LDA     J
         9 000767   000017 115007                    CMPA    15,DL
         9 000770   000757 604400 9                  TMOZ    s:19183

     1157    19185        /**/
     1158    19186    5                 DO J = 0 TO %PC_MAXDOMAIN;

  19186  9 000771   000026 450000 1                  STZ     J

     1159    19187    5                    INDEX_FLGS.DOMAINE(J) = BITVAL;

  19187  9 000772   000026 235000 1                  LDA     J
         9 000773   000775 605000 9                  TPL     s:19187+3
         9 000774   000044 035003                    ADLA    36,DU
         9 000775   003005 060400                    CSL     bolr='003'O
         9 000776   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 000777   000226 430001 1                  BDSC    INDEX_FLGS,A             by=2,bit=3,n=1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:161  
     1160    19188    5                    END;

  19188  9 001000   000026 054000 1                  AOS     J
         9 001001   000026 235000 1                  LDA     J
         9 001002   000003 115007                    CMPA    3,DL
         9 001003   000772 604400 9                  TMOZ    s:19187

     1161    19189        /**/
     1162    19190    5                 DO J = 1 TO %PC_MAXCATAGORY;

  19190  9 001004   000001 236007                    LDQ     1,DL
         9 001005   000026 756000 1                  STQ     J

     1163    19191    5                    IF J = %PC_TP AND BITVAL = YES /* DONT SET TP CAT ON ADD ALL */

  19191  9 001006   000026 235000 1                  LDA     J
         9 001007   000004 115007                    CMPA    4,DL
         9 001010   001014 601000 9                  TNZ     s:19193
         9 001011   000033 234000 1                  SZN     BITVAL
         9 001012   001014 605000 9                  TPL     s:19193

     1164    19192    5                       THEN J = J + 1;

  19192  9 001013   000026 054000 1                  AOS     J

     1165    19193    5                    CAT$ -> CAT$TBL.FLAGS.PRINT(J) = BITVAL;

  19193  9 001014   000026 235000 1                  LDA     J
         9 001015   000001 735000                    ALS     1
         9 001016   000000 470400 1                  LDP0    CAT$
         9 001017   000033 236000 1                  LDQ     BITVAL
         9 001020   000000 676105                    ERQ     0,AL,PR0
         9 001021   400000 376003                    ANQ     -131072,DU
         9 001022   000000 656105                    ERSQ    0,AL,PR0

     1166    19194    6                    DO K = 1 TO CAT$ -> CAT$TBL.MAXPARAM(J);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:162  
  19194  9 001023   000001 235007                    LDA     1,DL
         9 001024   000027 755000 1                  STA     K
         9 001025   001100 710000 9                  TRA     s:19203+1

     1167    19195    6                       IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.FLAGS.RES(K))

  19195  9 001026   000026 235000 1                  LDA     J
         9 001027   000001 735000                    ALS     1
         9 001030   000000 470400 1                  LDP0    CAT$
         9 001031   000001 471505                    LDP1    1,AL,PR0
         9 001032   000027 236000 1                  LDQ     K
         9 001033   000014 402007                    MPY     12,DL
         9 001034   100000 236106                    LDQ     0,QL,PR1
         9 001035   040000 316003                    CANQ    16384,DU
         9 001036   001065 600000 9                  TZE     s:19201

     1168    19196    7                       THEN DO RES_INDX = 0 TO NUM_PSURES + %PSURES_OFFSET-1;

  19196  9 001037   000062 450000 1                  STZ     RES_INDX
         9 001040   001057 710000 9                  TRA     s:19199+1

     1169    19197    7                          CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.RESPTR$(K) ->

  19197  9 001041   000026 235000 1                  LDA     J
         9 001042   000001 735000                    ALS     1
         9 001043   000000 470400 1                  LDP0    CAT$
         9 001044   000001 471505                    LDP1    1,AL,PR0
         9 001045   000027 236000 1                  LDQ     K
         9 001046   000014 402007                    MPY     12,DL
         9 001047   100001 473506                    LDP3    1,QL,PR1
         9 001050   000062 235000 1                  LDA     RES_INDX
         9 001051   001053 605000 9                  TPL     s:19197+10
         9 001052   000044 035003                    ADLA    36,DU
         9 001053   003105 060400                    CSL     bolr='003'O
         9 001054   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 001055   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:163  
     1170    19198    7                            RES$FLGS(RES_INDX) = BITVAL;
     1171    19199    7                          END;

  19199  9 001056   000062 054000 1                  AOS     RES_INDX
         9 001057   000012 236000 1                  LDQ     NUM_PSURES
         9 001060   000003 036007                    ADLQ    3,DL
         9 001061   001041 604000 9                  TMI     s:19197
         9 001062   000062 116000 1                  CMPQ    RES_INDX
         9 001063   001041 605000 9                  TPL     s:19197
         9 001064   001077 710000 9                  TRA     s:19203

     1172    19200        /**/
     1173    19201    6                       ELSE CAT$ -> CAT$TBL.PARAM$(J) ->

  19201  9 001065   000026 235000 1                  LDA     J
         9 001066   000001 735000                    ALS     1
         9 001067   000001 471505                    LDP1    1,AL,PR0
         9 001070   000027 236000 1                  LDQ     K
         9 001071   000014 402007                    MPY     12,DL
         9 001072   000000 620006                    EAX0    0,QL
         9 001073   000033 236000 1                  LDQ     BITVAL
         9 001074   100000 676110                    ERQ     0,X0,PR1
         9 001075   400000 376003                    ANQ     -131072,DU
         9 001076   100000 656110                    ERSQ    0,X0,PR1

     1174    19202    6                            P$TBL.FLAGS.PRINT(K) = BITVAL;
     1175    19203    6                       END;

  19203  9 001077   000027 054000 1                  AOS     K
         9 001100   000026 235000 1                  LDA     J
         9 001101   000001 735000                    ALS     1
         9 001102   000000 470400 1                  LDP0    CAT$
         9 001103   000000 236105                    LDQ     0,AL,PR0
         9 001104   777777 376007                    ANQ     -1,DL
         9 001105   000027 116000 1                  CMPQ    K
         9 001106   001026 605000 9                  TPL     s:19195

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:164  
     1176    19204    6                    IF J = %PC_TP THEN DO;

  19204  9 001107   000026 235000 1                  LDA     J
         9 001110   000004 115007                    CMPA    4,DL
         9 001111   001135 601000 9                  TNZ     s:19212

     1177    19205    6                       IF BITVAL = YES

  19205  9 001112   000033 234000 1                  SZN     BITVAL
         9 001113   001117 605000 9                  TPL     s:19207

     1178    19206    6                          THEN TP_TBL.MAXTPU.MAX = CURINSTANCES;

  19206  9 001114   000031 236000 1                  LDQ     CURINSTANCES
         9 001115   004533 756000 1                  STQ     TP_TBL+45
         9 001116   001120 710000 9                  TRA     s:19208

     1179    19207    6                          ELSE TP_TBL.MAXTPU.MAX = 0;

  19207  9 001117   004533 450000 1                  STZ     TP_TBL+45

     1180    19208    7                       DO K = 0 TO CURINSTANCES - 1;

  19208  9 001120   000027 450000 1                  STZ     K
         9 001121   001132 710000 9                  TRA     s:19210+1

     1181    19209    7                          MAXTPU_TBL.FLAGS.PRINT(K) = BITVAL;

  19209  9 001122   000027 235000 1                  LDA     K
         9 001123   000002 735000                    ALS     2
         9 001124   000033 236000 1                  LDQ     BITVAL
         9 001125   000022 772000                    QRL     18
         9 001126   004562 676005 1                  ERQ     MAXTPU_TBL+3,AL
         9 001127   400000 376007                    ANQ     -131072,DL
         9 001130   004562 656005 1                  ERSQ    MAXTPU_TBL+3,AL

     1182    19210    7                          END;  /* DO K */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:165  

  19210  9 001131   000027 054000 1                  AOS     K
         9 001132   000027 236000 1                  LDQ     K
         9 001133   000031 116000 1                  CMPQ    CURINSTANCES
         9 001134   001122 604000 9                  TMI     s:19209

     1183    19211    6                       END;  /* IF J = %PC_TP */

     1184    19212    5                    END;

  19212  9 001135   000026 054000 1                  AOS     J
         9 001136   000026 235000 1                  LDA     J
         9 001137   000005 115007                    CMPA    5,DL
         9 001140   001006 604400 9                  TMOZ    s:19191
         9 001141   002113 710000 9                  TRA     s:19399

     1185    19213        /**/
     1186    19214    4               CASE (%PC_MODE);

     1187    19215    4                 INDEX_FLGS.MODE(BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE)

  19215  9 001142   300003 474500                    LDP4    3,,PR3
         9 001143   400000 236100                    LDQ     0,,PR4
         9 001144   777777 376007                    ANQ     -1,DL
         9 001145   003006 060400                    CSL     bolr='003'O
         9 001146   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 001147   000226 000001 1                  BDSC    INDEX_FLGS,Q             by=0,bit=0,n=1
         9 001150   002113 710000 9                  TRA     s:19399

     1188    19216    4                   = BITVAL;
     1189    19217        /**/
     1190    19218    4               CASE (%PC_PART#);

     1191    19219    4                 TEMP$ = BLK$ -> O$BLK.SUBLK$(0);

  19219  9 001151   300003 236100                    LDQ     3,,PR3
         9 001152   000014 756000 1                  STQ     TEMP$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:166  

     1192    19220    5                 DO J = 0 TO TEMP$ -> O$BLK.NSUBLKS - 1;

  19220  9 001153   000026 450000 1                  STZ     J
         9 001154   001234 710000 9                  TRA     s:19251+1

     1193    19221    5                    PART#$ = TEMP$ -> O$BLK.SUBLK$(J);

  19221  9 001155   000014 470400 1                  LDP0    TEMP$
         9 001156   000026 720000 1                  LXL0    J
         9 001157   000003 236110                    LDQ     3,X0,PR0
         9 001160   000016 756000 1                  STQ     PART#$

     1194    19222        /**/
     1195    19223    6                    IF (PART#$ -> O$BLK.CODE = %PC_ALLOPT) THEN DO;

  19223  9 001161   000016 471400 1                  LDP1    PART#$
         9 001162   100000 721100                    LXL1    0,,PR1
         9 001163   000145 101003                    CMPX1   101,DU
         9 001164   001171 601000 9                  TNZ     s:19229

     1196    19224    6                       TEMP1 = 0;

  19224  9 001165   000023 450000 1                  STZ     TEMP1

     1197    19225    6                       TEMP2 = 15;

  19225  9 001166   000017 235007                    LDA     15,DL
         9 001167   000024 755000 1                  STA     TEMP2

     1198    19226    6                       END;

  19226  9 001170   001216 710000 9                  TRA     s:19248

     1199    19227        /**/
     1200    19228    6                    ELSE DO;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:167  
     1201    19229    6                       TEMP1 = PART#$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;

  19229  9 001171   100003 473500                    LDP3    3,,PR1
         9 001172   300000 236100                    LDQ     0,,PR3
         9 001173   777777 376007                    ANQ     -1,DL
         9 001174   000023 756000 1                  STQ     TEMP1

     1202    19230        /**/
     1203    19231    6                       IF (PART#$ -> O$BLK.NSUBLKS = 1) THEN TEMP2 = TEMP1;

  19231  9 001175   100001 221100                    LDX1    1,,PR1
         9 001176   000001 101003                    CMPX1   1,DU
         9 001177   001202 601000 9                  TNZ     s:19234

  19231  9 001200   000024 756000 1                  STQ     TEMP2
         9 001201   001216 710000 9                  TRA     s:19248

     1204    19232    7                       ELSE DO;

     1205    19233        /**/
     1206    19234    7                          TEMP2 = PART#$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;

  19234  9 001202   100004 473500                    LDP3    4,,PR1
         9 001203   300000 236100                    LDQ     0,,PR3
         9 001204   777777 376007                    ANQ     -1,DL
         9 001205   000024 756000 1                  STQ     TEMP2

     1207    19235        /**/
     1208    19236    8                          IF (TEMP1 > TEMP2) THEN DO;

  19236  9 001206   000023 116000 1                  CMPQ    TEMP1
         9 001207   001216 605000 9                  TPL     s:19248

     1209    19237    8                             CALL PCE$ERROR (%E$P_P#RANGE,2);

  19237  9 001210   000036 630400 10                 EPPR0   30
         9 001211   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:168  
         9 001212   000000 701000 xent               TSX1    PCE$ERROR
         9 001213   000000 011000                    NOP     0

     1210    19238    8                             ALTRETURN;

  19238  9 001214   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 001215   000000 702211                    TSX2  ! 0,X1

     1211    19239    8                             END;
     1212    19240        /**/
     1213    19241        /*E*     ERROR:    PCC-E$P_P#RANGE-0
     1214    19242                 MESSAGE:  Illegal partition number range lo>hi
     1215    19243                 DESCRIPTION: BAD PART# RANGE - LO > HI  */
     1216    19244        /**/
     1217    19245    7                          END;
     1218    19246    6                       END;
     1219    19247        /**/
     1220    19248    6                    DO K = TEMP1 TO TEMP2;

  19248  9 001216   000023 235000 1                  LDA     TEMP1
         9 001217   000027 755000 1                  STA     K
         9 001220   001230 710000 9                  TRA     s:19250+1

     1221    19249    6                       INDEX_FLGS.PART#(K) = BITVAL;

  19249  9 001221   000027 235000 1                  LDA     K
         9 001222   001224 605000 9                  TPL     s:19249+3
         9 001223   000044 035003                    ADLA    36,DU
         9 001224   003005 060400                    CSL     bolr='003'O
         9 001225   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 001226   000226 050001 1                  BDSC    INDEX_FLGS,A             by=0,bit=5,n=1

     1222    19250    6                       END;

  19250  9 001227   000027 054000 1                  AOS     K
         9 001230   000027 236000 1                  LDQ     K
         9 001231   000024 116000 1                  CMPQ    TEMP2
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:169  
         9 001232   001221 604400 9                  TMOZ    s:19249

     1223    19251    5                    END;

  19251  9 001233   000026 054000 1                  AOS     J
         9 001234   000014 470400 1                  LDP0    TEMP$
         9 001235   000001 236100                    LDQ     1,,PR0
         9 001236   000022 772000                    QRL     18
         9 001237   000026 116000 1                  CMPQ    J
         9 001240   001155 605400 9                  TPNZ    s:19221
         9 001241   002113 710000 9                  TRA     s:19399

     1224    19252        /**/
     1225    19253    4               CASE (%PC_DOMAIN);

     1226    19254    4                 INDEX_FLGS.DOMAINE(BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE)

  19254  9 001242   300003 474500                    LDP4    3,,PR3
         9 001243   400000 236100                    LDQ     0,,PR4
         9 001244   777777 376007                    ANQ     -1,DL
         9 001245   003006 060400                    CSL     bolr='003'O
         9 001246   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 001247   000226 430001 1                  BDSC    INDEX_FLGS,Q             by=2,bit=3,n=1
         9 001250   002113 710000 9                  TRA     s:19399

     1227    19255    4                   = BITVAL;
     1228    19256        /**/
     1229    19257    4               CASE (%PC_CATAGORY);

     1230    19258    4                 J = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;

  19258  9 001251   300003 474500                    LDP4    3,,PR3
         9 001252   400000 236100                    LDQ     0,,PR4
         9 001253   777777 376007                    ANQ     -1,DL
         9 001254   000026 756000 1                  STQ     J

     1231    19259    4                 CAT$ -> CAT$TBL.FLAGS.PRINT(J) = BITVAL;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:170  

  19259  9 001255   000026 235000 1                  LDA     J
         9 001256   000001 735000                    ALS     1
         9 001257   000000 471400 1                  LDP1    CAT$
         9 001260   000033 236000 1                  LDQ     BITVAL
         9 001261   100000 676105                    ERQ     0,AL,PR1
         9 001262   400000 376003                    ANQ     -131072,DU
         9 001263   100000 656105                    ERSQ    0,AL,PR1

     1232    19260    5                 DO K = 1 TO CAT$ -> CAT$TBL.MAXPARAM(J);

  19260  9 001264   000001 235007                    LDA     1,DL
         9 001265   000027 755000 1                  STA     K
         9 001266   001341 710000 9                  TRA     s:19269+1

     1233    19261    5                    IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.FLAGS.RES(K))

  19261  9 001267   000026 235000 1                  LDA     J
         9 001270   000001 735000                    ALS     1
         9 001271   000000 470400 1                  LDP0    CAT$
         9 001272   000001 471505                    LDP1    1,AL,PR0
         9 001273   000027 236000 1                  LDQ     K
         9 001274   000014 402007                    MPY     12,DL
         9 001275   100000 236106                    LDQ     0,QL,PR1
         9 001276   040000 316003                    CANQ    16384,DU
         9 001277   001326 600000 9                  TZE     s:19267

     1234    19262    6                    THEN DO RES_INDX = 0 TO NUM_PSURES + %PSURES_OFFSET-1;

  19262  9 001300   000062 450000 1                  STZ     RES_INDX
         9 001301   001320 710000 9                  TRA     s:19265+1

     1235    19263    6                       CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.RESPTR$(K) ->

  19263  9 001302   000026 235000 1                  LDA     J
         9 001303   000001 735000                    ALS     1
         9 001304   000000 470400 1                  LDP0    CAT$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:171  
         9 001305   000001 471505                    LDP1    1,AL,PR0
         9 001306   000027 236000 1                  LDQ     K
         9 001307   000014 402007                    MPY     12,DL
         9 001310   100001 473506                    LDP3    1,QL,PR1
         9 001311   000062 235000 1                  LDA     RES_INDX
         9 001312   001314 605000 9                  TPL     s:19263+10
         9 001313   000044 035003                    ADLA    36,DU
         9 001314   003105 060400                    CSL     bolr='003'O
         9 001315   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 001316   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1

     1236    19264    6                         RES$FLGS(RES_INDX) = BITVAL;
     1237    19265    6                       END;

  19265  9 001317   000062 054000 1                  AOS     RES_INDX
         9 001320   000012 236000 1                  LDQ     NUM_PSURES
         9 001321   000003 036007                    ADLQ    3,DL
         9 001322   001302 604000 9                  TMI     s:19263
         9 001323   000062 116000 1                  CMPQ    RES_INDX
         9 001324   001302 605000 9                  TPL     s:19263
         9 001325   001340 710000 9                  TRA     s:19269

     1238    19266        /**/
     1239    19267    5                    ELSE CAT$ -> CAT$TBL.PARAM$(J) ->

  19267  9 001326   000026 235000 1                  LDA     J
         9 001327   000001 735000                    ALS     1
         9 001330   000001 471505                    LDP1    1,AL,PR0
         9 001331   000027 236000 1                  LDQ     K
         9 001332   000014 402007                    MPY     12,DL
         9 001333   000000 620006                    EAX0    0,QL
         9 001334   000033 236000 1                  LDQ     BITVAL
         9 001335   100000 676110                    ERQ     0,X0,PR1
         9 001336   400000 376003                    ANQ     -131072,DU
         9 001337   100000 656110                    ERSQ    0,X0,PR1

     1240    19268    5                         P$TBL.FLAGS.PRINT(K) = BITVAL;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:172  
     1241    19269    5                    END;

  19269  9 001340   000027 054000 1                  AOS     K
         9 001341   000026 235000 1                  LDA     J
         9 001342   000001 735000                    ALS     1
         9 001343   000000 470400 1                  LDP0    CAT$
         9 001344   000000 236105                    LDQ     0,AL,PR0
         9 001345   777777 376007                    ANQ     -1,DL
         9 001346   000027 116000 1                  CMPQ    K
         9 001347   001267 605000 9                  TPL     s:19261

     1242    19270    5                 IF J = %PC_TP THEN DO;

  19270  9 001350   000026 235000 1                  LDA     J
         9 001351   000004 115007                    CMPA    4,DL
         9 001352   002113 601000 9                  TNZ     s:19399

     1243    19271    5                    IF BITVAL = YES

  19271  9 001353   000033 234000 1                  SZN     BITVAL
         9 001354   001360 605000 9                  TPL     s:19273

     1244    19272    5                       THEN TP_TBL.MAXTPU.MAX = CURINSTANCES;

  19272  9 001355   000031 236000 1                  LDQ     CURINSTANCES
         9 001356   004533 756000 1                  STQ     TP_TBL+45
         9 001357   001361 710000 9                  TRA     s:19274

     1245    19273    5                       ELSE TP_TBL.MAXTPU.MAX = 0;

  19273  9 001360   004533 450000 1                  STZ     TP_TBL+45

     1246    19274    6                    DO K = 0 TO CURINSTANCES - 1;

  19274  9 001361   000027 450000 1                  STZ     K
         9 001362   001373 710000 9                  TRA     s:19276+1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:173  
     1247    19275    6                       MAXTPU_TBL.FLAGS.PRINT(K) = BITVAL;

  19275  9 001363   000027 235000 1                  LDA     K
         9 001364   000002 735000                    ALS     2
         9 001365   000033 236000 1                  LDQ     BITVAL
         9 001366   000022 772000                    QRL     18
         9 001367   004562 676005 1                  ERQ     MAXTPU_TBL+3,AL
         9 001370   400000 376007                    ANQ     -131072,DL
         9 001371   004562 656005 1                  ERSQ    MAXTPU_TBL+3,AL

     1248    19276    6                       END;  /* DO K */

  19276  9 001372   000027 054000 1                  AOS     K
         9 001373   000027 236000 1                  LDQ     K
         9 001374   000031 116000 1                  CMPQ    CURINSTANCES
         9 001375   001363 604000 9                  TMI     s:19275

     1249    19277    5                    IF BITVAL = YES

  19277  9 001376   000033 234000 1                  SZN     BITVAL
         9 001377   001403 605000 9                  TPL     s:19279

     1250    19278    5                       THEN TP_TBL.TPHDR.MAX = CURINSTANCES;

  19278  9 001400   000031 235000 1                  LDA     CURINSTANCES
         9 001401   004517 755000 1                  STA     TP_TBL+33
         9 001402   001404 710000 9                  TRA     s:19280

     1251    19279    5                       ELSE TP_TBL.TPHDR.MAX = 0;

  19279  9 001403   004517 450000 1                  STZ     TP_TBL+33

     1252    19280    6                    DO K = 0 TO CURINSTANCES - 1;

  19280  9 001404   000027 450000 1                  STZ     K
         9 001405   001417 710000 9                  TRA     s:19282+1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:174  
     1253    19281    6                       TPHDR_TBL.FLAGS.PRINT(K) = BITVAL;

  19281  9 001406   000027 236000 1                  LDQ     K
         9 001407   000025 402007                    MPY     21,DL
         9 001410   000000 620006                    EAX0    0,QL
         9 001411   000033 236000 1                  LDQ     BITVAL
         9 001412   000011 772000                    QRL     9
         9 001413   005243 676010 1                  ERQ     TPHDR_TBL+20,X0
         9 001414   000400 376003                    ANQ     256,DU
         9 001415   005243 656010 1                  ERSQ    TPHDR_TBL+20,X0

     1254    19282    6                       END;  /* DO K */

  19282  9 001416   000027 054000 1                  AOS     K
         9 001417   000027 236000 1                  LDQ     K
         9 001420   000031 116000 1                  CMPQ    CURINSTANCES
         9 001421   001406 604000 9                  TMI     s:19281

     1255    19283    5                    END;  /* IF J = %PC_TP */

  19283  9 001422   002113 710000 9                  TRA     s:19399

     1256    19284        /**/
     1257    19285    4               CASE (%PC_PARAM);

     1258    19286    4                 TEMP1 = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE; /* CATAGORY TYPE   */

  19286  9 001423   300003 474500                    LDP4    3,,PR3
         9 001424   400000 236100                    LDQ     0,,PR4
         9 001425   777777 376007                    ANQ     -1,DL
         9 001426   000023 756000 1                  STQ     TEMP1

     1259    19287    4                 TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);

  19287  9 001427   300003 471500                    LDP1    3,,PR3
         9 001430   100003 236100                    LDQ     3,,PR1
         9 001431   000014 756000 1                  STQ     TEMP$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:175  

     1260    19288    5                 IF TEMP1 = %PC_TP AND TEMP$->O$BLK.CODE = %PC_MAXTPU THEN DO;

  19288  9 001432   000023 235000 1                  LDA     TEMP1
         9 001433   000004 115007                    CMPA    4,DL
         9 001434   001636 601000 9                  TNZ     s:19335
         9 001435   000014 474400 1                  LDP4    TEMP$
         9 001436   400000 721100                    LXL1    0,,PR4
         9 001437   000003 101003                    CMPX1   3,DU
         9 001440   001636 601000 9                  TNZ     s:19335

     1261    19289    6                    IF TEMP$->O$BLK.NSUBLKS = 0 THEN DO;  /* NO INSTANCE SPEC */

  19289  9 001441   400001 222100                    LDX2    1,,PR4
         9 001442   001473 601000 9                  TNZ     s:19299

     1262    19290    6                       TP_TBL.MAXTPU.FLAGS.PRINT = BITVAL;

  19290  9 001443   000033 236000 1                  LDQ     BITVAL
         9 001444   004522 676000 1                  ERQ     TP_TBL+36
         9 001445   400000 376003                    ANQ     -131072,DU
         9 001446   004522 656000 1                  ERSQ    TP_TBL+36

     1263    19291    7                       DO J = 0 TO TBLINSTANCES - 1;

  19291  9 001447   000026 450000 1                  STZ     J
         9 001450   001461 710000 9                  TRA     s:19293+1

     1264    19292    7                          MAXTPU_TBL.FLAGS.PRINT(J) = BITVAL;

  19292  9 001451   000026 235000 1                  LDA     J
         9 001452   000002 735000                    ALS     2
         9 001453   000033 236000 1                  LDQ     BITVAL
         9 001454   000022 772000                    QRL     18
         9 001455   004562 676005 1                  ERQ     MAXTPU_TBL+3,AL
         9 001456   400000 376007                    ANQ     -131072,DL
         9 001457   004562 656005 1                  ERSQ    MAXTPU_TBL+3,AL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:176  

     1265    19293    7                          END;  /* DO J */

  19293  9 001460   000026 054000 1                  AOS     J
         9 001461   000026 236000 1                  LDQ     J
         9 001462   000032 116000 1                  CMPQ    TBLINSTANCES
         9 001463   001451 604000 9                  TMI     s:19292

     1266    19294    6                       IF BITVAL = YES

  19294  9 001464   000033 234000 1                  SZN     BITVAL
         9 001465   001471 605000 9                  TPL     s:19296

     1267    19295    6                          THEN TP_TBL.MAXTPU.MAX = CURINSTANCES;

  19295  9 001466   000031 235000 1                  LDA     CURINSTANCES
         9 001467   004533 755000 1                  STA     TP_TBL+45
         9 001470   001622 710000 9                  TRA     s:19332

     1268    19296    6                          ELSE TP_TBL.MAXTPU.MAX = 0;

  19296  9 001471   004533 450000 1                  STZ     TP_TBL+45

     1269    19297    6                       END;  /* IF NO INSTANCE */

  19297  9 001472   001622 710000 9                  TRA     s:19332

     1270    19298    6                    ELSE DO;   /* INSTANCE NAME(S) SPECIFIED */

     1271    19299    6                       TEMP1$ = TEMP$->O$BLK.SUBLK$(0);

  19299  9 001473   400003 236100                    LDQ     3,,PR4
         9 001474   200003 756100                    STQ     TEMP1$,,AUTO

     1272    19300    7                       DO J = 0 TO TEMP1$->O$BLK.NSUBLKS - 1;

  19300  9 001475   000026 450000 1                  STZ     J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:177  
         9 001476   001615 710000 9                  TRA     s:19330+1

     1273    19301    7                          INSTANCE_NAME = TEMP1$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;

  19301  9 001477   200003 470500                    LDP0    TEMP1$,,AUTO
         9 001500   000026 720000 1                  LXL0    J
         9 001501   000003 471510                    LDP1    3,X0,PR0
         9 001502   100004 236100                    LDQ     4,,PR1
         9 001503   000033 772000                    QRL     27
         9 001504   000000 621006                    EAX1    0,QL
         9 001505   040100 100540                    MLR     fill='040'O
         9 001506   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         9 001507   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8

     1274    19302    7                          FOUND = NO;

  19302  9 001510   200025 450100                    STZ     FOUND,,AUTO

     1275    19303    8                          DO K = 0 TO TBLINSTANCES - 1;

  19303  9 001511   000027 450000 1                  STZ     K
         9 001512   001563 710000 9                  TRA     s:19320+1

     1276    19304    8                             IF INSTANCE_NAME = MAXTPU_TBL.NAME(K) AND

  19304  9 001513   000027 235000 1                  LDA     K
         9 001514   000004 735000                    ALS     4
         9 001515   040005 106500                    CMPC    fill='040'O
         9 001516   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 001517   004557 000010 1                  ADSC9   MAXTPU_TBL,A             cn=0,n=8
         9 001520   001562 601000 9                  TNZ     s:19320
         9 001521   000027 236000 1                  LDQ     K
         9 001522   000002 736000                    QLS     2
         9 001523   004562 236006 1                  LDQ     MAXTPU_TBL+3,QL
         9 001524   200000 316007                    CANQ    65536,DL
         9 001525   001562 601000 9                  TNZ     s:19320

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:178  
     1277    19305    9                                NOT MAXTPU_TBL.FLAGS.DELETED(K) THEN DO;

     1278    19306    9                                MAXTPU_TBL.FLAGS.PRINT(K) = BITVAL;

  19306  9 001526   000027 236000 1                  LDQ     K
         9 001527   000002 736000                    QLS     2
         9 001530   000000 620006                    EAX0    0,QL
         9 001531   000033 236000 1                  LDQ     BITVAL
         9 001532   000022 772000                    QRL     18
         9 001533   004562 676010 1                  ERQ     MAXTPU_TBL+3,X0
         9 001534   400000 376007                    ANQ     -131072,DL
         9 001535   004562 656010 1                  ERSQ    MAXTPU_TBL+3,X0

     1279    19307    9                                FOUND = YES;

  19307  9 001536   400000 236003                    LDQ     -131072,DU
         9 001537   200025 756100                    STQ     FOUND,,AUTO

     1280    19308   10                                IF BITVAL = NO THEN DO;

  19308  9 001540   000033 234000 1                  SZN     BITVAL
         9 001541   001551 604000 9                  TMI     s:19314

     1281    19309   10                                   TP_TBL.MAXTPU.FLAGS.PRINT = NO;

  19309  9 001542   000031 236000 xsym               LDQ     B_VECTNIL+25
         9 001543   004522 356000 1                  ANSQ    TP_TBL+36

     1282    19310   10                                   IF TP_TBL.MAXTPU.MAX ~= 0

  19310  9 001544   004533 235000 1                  LDA     TP_TBL+45
         9 001545   001562 600000 9                  TZE     s:19320

     1283    19311   10                                      THEN TP_TBL.MAXTPU.MAX = TP_TBL.MAXTPU.MAX - 1;

  19311  9 001546   000001 336007                    LCQ     1,DL
         9 001547   004533 056000 1                  ASQ     TP_TBL+45
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:179  

     1284    19312   10                                   END;  /* IF BITVAL = NO */

  19312  9 001550   001562 710000 9                  TRA     s:19320

     1285    19313   10                                ELSE DO;

     1286    19314   10                                   IF TP_TBL.MAXTPU.MAX ~= CURINSTANCES

  19314  9 001551   004533 236000 1                  LDQ     TP_TBL+45
         9 001552   000031 116000 1                  CMPQ    CURINSTANCES
         9 001553   001555 600000 9                  TZE     s:19316

     1287    19315   10                                      THEN TP_TBL.MAXTPU.MAX = TP_TBL.MAXTPU.MAX + 1;

  19315  9 001554   004533 054000 1                  AOS     TP_TBL+45

     1288    19316   10                                   IF TP_TBL.MAXTPU.MAX = CURINSTANCES

  19316  9 001555   004533 236000 1                  LDQ     TP_TBL+45
         9 001556   000031 116000 1                  CMPQ    CURINSTANCES
         9 001557   001562 601000 9                  TNZ     s:19320

     1289    19317   10                                      THEN TP_TBL.MAXTPU.FLAGS.PRINT = YES;

  19317  9 001560   400000 236003                    LDQ     -131072,DU
         9 001561   004522 256000 1                  ORSQ    TP_TBL+36

     1290    19318   10                                   END;  /* ELSE */

     1291    19319    9                                END;  /* IF FOUND */

     1292    19320    8                             END;  /* DO K */

  19320  9 001562   000027 054000 1                  AOS     K
         9 001563   000027 236000 1                  LDQ     K
         9 001564   000032 116000 1                  CMPQ    TBLINSTANCES
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:180  
         9 001565   001513 604000 9                  TMI     s:19304

     1293    19321    8                          IF NOT FOUND THEN DO;

  19321  9 001566   200025 234100                    SZN     FOUND,,AUTO
         9 001567   001614 604000 9                  TMI     s:19330

     1294    19322    8                             K = 0;

  19322  9 001570   000027 450000 1                  STZ     K

     1295    19323    9                             DO WHILE(SUBSTR(INSTANCE_NAME,K,1) ~= ' ' AND K < 8);

  19323  9 001571   001573 710000 9                  TRA     s:19325

     1296    19324    9                                K = K + 1;

  19324  9 001572   000027 054000 1                  AOS     K

     1297    19325    9                                END;  /* DO WHILE */

  19325  9 001573   000027 235000 1                  LDA     K
         9 001574   040000 106505                    CMPC    fill='040'O
         9 001575   200017 000001                    ADSC9   INSTANCE_NAME,A,AUTO     cn=0,n=1
         9 001576   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 001577   001602 600000 9                  TZE     s:19326
         9 001600   000010 115007                    CMPA    8,DL
         9 001601   001572 604000 9                  TMI     s:19324

     1298    19326    8                             SUB_BUF_1.COUNT = K;

  19326  9 001602   000027 236000 1                  LDQ     K
         9 001603   000033 736000                    QLS     27
         9 001604   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     1299    19327    8                             SUB_BUF_1.TEXT = INSTANCE_NAME;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:181  
  19327  9 001605   040000 100500                    MLR     fill='040'O
         9 001606   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 001607   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

     1300    19328    8                             CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);

  19328  9 001610   000041 630400 10                 EPPR0   33
         9 001611   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001612   000000 701000 xent               TSX1    PCE$ERROR
         9 001613   000000 011000                    NOP     0

     1301    19329    8                             END;  /* IF NOT FOUND */

     1302    19330    7                          END;  /* DO J */

  19330  9 001614   000026 054000 1                  AOS     J
         9 001615   200003 470500                    LDP0    TEMP1$,,AUTO
         9 001616   000001 236100                    LDQ     1,,PR0
         9 001617   000022 772000                    QRL     18
         9 001620   000026 116000 1                  CMPQ    J
         9 001621   001477 605400 9                  TPNZ    s:19301

     1303    19331    6                       END;  /* ELSE */

     1304    19332    5                    IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#

  19332  9 001622   000000 236007 xsym               LDQ     M$TP,DL
         9 001623   000000 470400 10                 LDP0    0
         9 001624   000000 471500                    LDP1    0,,PR0
         9 001625   100000 473506                    LDP3    0,QL,PR1
         9 001626   300031 236100                    LDQ     25,,PR3
         9 001627   020000 316007                    CANQ    8192,DL
         9 001630   002113 600000 9                  TZE     s:19399

     1305    19333    5                       THEN CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(ALT);

  19333  9 001631   010572 630400 1                  EPPR0   CLOSE_TP_FILE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:182  
         9 001632   450001 713400                    CLIMB   alt,close
         9 001633   406000 401760                    pmme    nvectors=13
         9 001634   002130 702000 9                  TSX2    ALT

     1306    19334    5                    END;  /* IF PC_TP AND PC_MAXTPU */

  19334  9 001635   002113 710000 9                  TRA     s:19399

     1307    19335    5                 ELSE IF TEMP1 = %PC_TP AND TEMP$->O$BLK.CODE = %PC_TPHDR THEN DO;

  19335  9 001636   000004 115007                    CMPA    4,DL
         9 001637   002042 601000 9                  TNZ     s:19383
         9 001640   000014 474400 1                  LDP4    TEMP$
         9 001641   400000 721100                    LXL1    0,,PR4
         9 001642   000002 101003                    CMPX1   2,DU
         9 001643   002042 601000 9                  TNZ     s:19383

     1308    19336    6                    IF TEMP$->O$BLK.NSUBLKS = 0 THEN DO;  /* NO INSTANCE SPEC */

  19336  9 001644   400001 222100                    LDX2    1,,PR4
         9 001645   001677 601000 9                  TNZ     s:19346

     1309    19337    6                       TP_TBL.TPHDR.FLAGS.PRINT = BITVAL;

  19337  9 001646   000033 236000 1                  LDQ     BITVAL
         9 001647   004506 676000 1                  ERQ     TP_TBL+24
         9 001650   400000 376003                    ANQ     -131072,DU
         9 001651   004506 656000 1                  ERSQ    TP_TBL+24

     1310    19338    7                       DO J = 0 TO TBLINSTANCES - 1;

  19338  9 001652   000026 450000 1                  STZ     J
         9 001653   001665 710000 9                  TRA     s:19340+1

     1311    19339    7                          TPHDR_TBL.FLAGS.PRINT(J) = BITVAL;

  19339  9 001654   000026 236000 1                  LDQ     J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:183  
         9 001655   000025 402007                    MPY     21,DL
         9 001656   000000 620006                    EAX0    0,QL
         9 001657   000033 236000 1                  LDQ     BITVAL
         9 001660   000011 772000                    QRL     9
         9 001661   005243 676010 1                  ERQ     TPHDR_TBL+20,X0
         9 001662   000400 376003                    ANQ     256,DU
         9 001663   005243 656010 1                  ERSQ    TPHDR_TBL+20,X0

     1312    19340    7                          END;  /* DO J */

  19340  9 001664   000026 054000 1                  AOS     J
         9 001665   000026 236000 1                  LDQ     J
         9 001666   000032 116000 1                  CMPQ    TBLINSTANCES
         9 001667   001654 604000 9                  TMI     s:19339

     1313    19341    6                       IF BITVAL = YES

  19341  9 001670   000033 234000 1                  SZN     BITVAL
         9 001671   001675 605000 9                  TPL     s:19343

     1314    19342    6                          THEN TP_TBL.TPHDR.MAX = CURINSTANCES;

  19342  9 001672   000031 235000 1                  LDA     CURINSTANCES
         9 001673   004517 755000 1                  STA     TP_TBL+33
         9 001674   002026 710000 9                  TRA     s:19379

     1315    19343    6                          ELSE TP_TBL.TPHDR.MAX = 0;

  19343  9 001675   004517 450000 1                  STZ     TP_TBL+33

     1316    19344    6                       END;  /* IF NO INSTANCE */

  19344  9 001676   002026 710000 9                  TRA     s:19379

     1317    19345    6                    ELSE DO;   /* INSTANCE NAME(S) SPECIFIED */

     1318    19346    6                       TEMP1$ = TEMP$->O$BLK.SUBLK$(0);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:184  

  19346  9 001677   400003 236100                    LDQ     3,,PR4
         9 001700   200003 756100                    STQ     TEMP1$,,AUTO

     1319    19347    7                       DO J = 0 TO TEMP1$->O$BLK.NSUBLKS - 1;

  19347  9 001701   000026 450000 1                  STZ     J
         9 001702   002021 710000 9                  TRA     s:19377+1

     1320    19348    7                          INSTANCE_NAME = TEMP1$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;

  19348  9 001703   200003 470500                    LDP0    TEMP1$,,AUTO
         9 001704   000026 720000 1                  LXL0    J
         9 001705   000003 471510                    LDP1    3,X0,PR0
         9 001706   100004 236100                    LDQ     4,,PR1
         9 001707   000033 772000                    QRL     27
         9 001710   000000 621006                    EAX1    0,QL
         9 001711   040100 100540                    MLR     fill='040'O
         9 001712   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         9 001713   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8

     1321    19349    7                          FOUND = NO;

  19349  9 001714   200025 450100                    STZ     FOUND,,AUTO

     1322    19350    8                          DO K = 0 TO TBLINSTANCES - 1;

  19350  9 001715   000027 450000 1                  STZ     K
         9 001716   001767 710000 9                  TRA     s:19367+1

     1323    19351    8                             IF INSTANCE_NAME = MAXTPU_TBL.NAME(K) AND

  19351  9 001717   000027 235000 1                  LDA     K
         9 001720   000004 735000                    ALS     4
         9 001721   040005 106500                    CMPC    fill='040'O
         9 001722   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 001723   004557 000010 1                  ADSC9   MAXTPU_TBL,A             cn=0,n=8
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:185  
         9 001724   001766 601000 9                  TNZ     s:19367
         9 001725   000027 236000 1                  LDQ     K
         9 001726   000002 736000                    QLS     2
         9 001727   004562 236006 1                  LDQ     MAXTPU_TBL+3,QL
         9 001730   200000 316007                    CANQ    65536,DL
         9 001731   001766 601000 9                  TNZ     s:19367

     1324    19352    9                                NOT MAXTPU_TBL.FLAGS.DELETED(K) THEN DO;

     1325    19353    9                                TPHDR_TBL.FLAGS.PRINT(K) = BITVAL;

  19353  9 001732   000027 236000 1                  LDQ     K
         9 001733   000025 402007                    MPY     21,DL
         9 001734   000000 620006                    EAX0    0,QL
         9 001735   000033 236000 1                  LDQ     BITVAL
         9 001736   000011 772000                    QRL     9
         9 001737   005243 676010 1                  ERQ     TPHDR_TBL+20,X0
         9 001740   000400 376003                    ANQ     256,DU
         9 001741   005243 656010 1                  ERSQ    TPHDR_TBL+20,X0

     1326    19354    9                                FOUND = YES;

  19354  9 001742   400000 236003                    LDQ     -131072,DU
         9 001743   200025 756100                    STQ     FOUND,,AUTO

     1327    19355   10                                IF BITVAL = NO THEN DO;

  19355  9 001744   000033 234000 1                  SZN     BITVAL
         9 001745   001755 604000 9                  TMI     s:19361

     1328    19356   10                                   TP_TBL.TPHDR.FLAGS.PRINT = NO;

  19356  9 001746   000031 236000 xsym               LDQ     B_VECTNIL+25
         9 001747   004506 356000 1                  ANSQ    TP_TBL+24

     1329    19357   10                                   IF TP_TBL.TPHDR.MAX ~= 0

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:186  
  19357  9 001750   004517 235000 1                  LDA     TP_TBL+33
         9 001751   001766 600000 9                  TZE     s:19367

     1330    19358   10                                      THEN TP_TBL.TPHDR.MAX = TP_TBL.TPHDR.MAX - 1;

  19358  9 001752   000001 336007                    LCQ     1,DL
         9 001753   004517 056000 1                  ASQ     TP_TBL+33

     1331    19359   10                                   END;  /* IF BITVAL = NO */

  19359  9 001754   001766 710000 9                  TRA     s:19367

     1332    19360   10                                ELSE DO;

     1333    19361   10                                   IF TP_TBL.TPHDR.MAX ~= CURINSTANCES

  19361  9 001755   004517 236000 1                  LDQ     TP_TBL+33
         9 001756   000031 116000 1                  CMPQ    CURINSTANCES
         9 001757   001761 600000 9                  TZE     s:19363

     1334    19362   10                                      THEN TP_TBL.TPHDR.MAX = TP_TBL.TPHDR.MAX + 1;

  19362  9 001760   004517 054000 1                  AOS     TP_TBL+33

     1335    19363   10                                   IF TP_TBL.TPHDR.MAX = CURINSTANCES

  19363  9 001761   004517 236000 1                  LDQ     TP_TBL+33
         9 001762   000031 116000 1                  CMPQ    CURINSTANCES
         9 001763   001766 601000 9                  TNZ     s:19367

     1336    19364   10                                      THEN TP_TBL.TPHDR.FLAGS.PRINT = YES;

  19364  9 001764   400000 236003                    LDQ     -131072,DU
         9 001765   004506 256000 1                  ORSQ    TP_TBL+24

     1337    19365   10                                   END;  /* ELSE */

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:187  
     1338    19366    9                                END;  /* IF FOUND */

     1339    19367    8                             END;  /* DO K */

  19367  9 001766   000027 054000 1                  AOS     K
         9 001767   000027 236000 1                  LDQ     K
         9 001770   000032 116000 1                  CMPQ    TBLINSTANCES
         9 001771   001717 604000 9                  TMI     s:19351

     1340    19368    8                          IF NOT FOUND THEN DO;

  19368  9 001772   200025 234100                    SZN     FOUND,,AUTO
         9 001773   002020 604000 9                  TMI     s:19377

     1341    19369    8                             K = 0;

  19369  9 001774   000027 450000 1                  STZ     K

     1342    19370    9                             DO WHILE(SUBSTR(INSTANCE_NAME,K,1) ~= ' ' AND K < 8);

  19370  9 001775   001777 710000 9                  TRA     s:19372

     1343    19371    9                                K = K + 1;

  19371  9 001776   000027 054000 1                  AOS     K

     1344    19372    9                                END;  /* DO WHILE */

  19372  9 001777   000027 235000 1                  LDA     K
         9 002000   040000 106505                    CMPC    fill='040'O
         9 002001   200017 000001                    ADSC9   INSTANCE_NAME,A,AUTO     cn=0,n=1
         9 002002   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 002003   002006 600000 9                  TZE     s:19373
         9 002004   000010 115007                    CMPA    8,DL
         9 002005   001776 604000 9                  TMI     s:19371

     1345    19373    8                             SUB_BUF_1.COUNT = K;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:188  

  19373  9 002006   000027 236000 1                  LDQ     K
         9 002007   000033 736000                    QLS     27
         9 002010   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     1346    19374    8                             SUB_BUF_1.TEXT = INSTANCE_NAME;

  19374  9 002011   040000 100500                    MLR     fill='040'O
         9 002012   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 002013   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

     1347    19375    8                             CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);

  19375  9 002014   000041 630400 10                 EPPR0   33
         9 002015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002016   000000 701000 xent               TSX1    PCE$ERROR
         9 002017   000000 011000                    NOP     0

     1348    19376    8                             END;  /* IF NOT FOUND */

     1349    19377    7                          END;  /* DO J */

  19377  9 002020   000026 054000 1                  AOS     J
         9 002021   200003 470500                    LDP0    TEMP1$,,AUTO
         9 002022   000001 236100                    LDQ     1,,PR0
         9 002023   000022 772000                    QRL     18
         9 002024   000026 116000 1                  CMPQ    J
         9 002025   001703 605400 9                  TPNZ    s:19348

     1350    19378    6                       END;  /* ELSE */

     1351    19379    5                    IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#

  19379  9 002026   000000 236007 xsym               LDQ     M$TP,DL
         9 002027   000000 470400 10                 LDP0    0
         9 002030   000000 471500                    LDP1    0,,PR0
         9 002031   100000 473506                    LDP3    0,QL,PR1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:189  
         9 002032   300031 236100                    LDQ     25,,PR3
         9 002033   020000 316007                    CANQ    8192,DL
         9 002034   002113 600000 9                  TZE     s:19399

     1352    19380    5                       THEN CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(ALT);

  19380  9 002035   010572 630400 1                  EPPR0   CLOSE_TP_FILE
         9 002036   450001 713400                    CLIMB   alt,close
         9 002037   406000 401760                    pmme    nvectors=13
         9 002040   002130 702000 9                  TSX2    ALT

     1353    19381    5                    END;  /* IF PC_TP AND PC_TPHDR */

  19381  9 002041   002113 710000 9                  TRA     s:19399

     1354    19382    5                 ELSE DO;

     1355    19383    5                    TEMP2 = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0) -> O$BLK.CODE;

  19383  9 002042   100003 474500                    LDP4    3,,PR1
         9 002043   400000 236100                    LDQ     0,,PR4
         9 002044   777777 376007                    ANQ     -1,DL
         9 002045   000024 756000 1                  STQ     TEMP2

     1356    19384           /**/
     1357    19385    5                    IF (CAT$ -> CAT$TBL.PARAM$(TEMP1) ->

  19385  9 002046   000001 735000                    ALS     1
         9 002047   000000 475400 1                  LDP5    CAT$
         9 002050   500001 476505                    LDP6    1,AL,PR5
         9 002051   000014 402007                    MPY     12,DL
         9 002052   600000 236106                    LDQ     0,QL,PR6
         9 002053   040000 316003                    CANQ    16384,DU
         9 002054   002101 600000 9                  TZE     s:19395

     1358    19386    6                      P$TBL.FLAGS.RES(TEMP2)) THEN DO;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:190  
     1359    19387    6                       CALL GET_RES (RES_INDX,BLK$ -> O$BLK.SUBLK$(0) ->

  19387  9 002055   400003 476500                    LDP6    3,,PR4
         9 002056   200060 456500                    STP6    @PRINT_FLAG+1,,AUTO
         9 002057   000043 236000 10                 LDQ     35
         9 002060   200057 756100                    STQ     CODE+2,,AUTO
         9 002061   004605 701000 9                  TSX1    GET_RES
         9 002062   002124 702000 9                  TSX2    BAD_RES

     1360    19388    6                         O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0) -> OUT$SYM)
     1361    19389    6                         ALTRET (BAD_RES);
     1362    19390           /**/
     1363    19391    6                       CAT$ -> CAT$TBL.PARAM$(TEMP1) -> P$TBL.RESPTR$(TEMP2) ->

  19391  9 002063   000023 235000 1                  LDA     TEMP1
         9 002064   000001 735000                    ALS     1
         9 002065   000000 470400 1                  LDP0    CAT$
         9 002066   000001 471505                    LDP1    1,AL,PR0
         9 002067   000024 236000 1                  LDQ     TEMP2
         9 002070   000014 402007                    MPY     12,DL
         9 002071   100001 473506                    LDP3    1,QL,PR1
         9 002072   000062 235000 1                  LDA     RES_INDX
         9 002073   002075 605000 9                  TPL     s:19391+10
         9 002074   000044 035003                    ADLA    36,DU
         9 002075   003105 060400                    CSL     bolr='003'O
         9 002076   000033 000001 1                  BDSC    BITVAL                   by=0,bit=0,n=1
         9 002077   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1

     1364    19392    6                         RES$FLGS(RES_INDX) = BITVAL;
     1365    19393    6                       END;

  19393  9 002100   002113 710000 9                  TRA     s:19399

     1366    19394           /**/
     1367    19395    5                    ELSE CAT$ -> CAT$TBL.PARAM$(TEMP1) ->

  19395  9 002101   000023 235000 1                  LDA     TEMP1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:191  
         9 002102   000001 735000                    ALS     1
         9 002103   500001 476505                    LDP6    1,AL,PR5
         9 002104   000024 236000 1                  LDQ     TEMP2
         9 002105   000014 402007                    MPY     12,DL
         9 002106   000000 621006                    EAX1    0,QL
         9 002107   000033 236000 1                  LDQ     BITVAL
         9 002110   600000 676111                    ERQ     0,X1,PR6
         9 002111   400000 376003                    ANQ     -131072,DU
         9 002112   600000 656111                    ERSQ    0,X1,PR6

     1368    19396    5                         P$TBL.FLAGS.PRINT(TEMP2) = BITVAL;
     1369    19397    5                    END;  /* ELSE */

     1370    19398    4               END;   /* DO CASE BLK$->O$BLK.CODE */

     1371    19399    3              END;  /* DO I */

  19399  9 002113   000025 054000 1                  AOS     I
         9 002114   002115 470400 1                  LDP0    P_PCB$
         9 002115   000003 471500                    LDP1    3,,PR0
         9 002116   100001 236100                    LDQ     1,,PR1
         9 002117   000022 772000                    QRL     18
         9 002120   000025 116000 1                  CMPQ    I
         9 002121   000721 605400 9                  TPNZ    s:19173

     1372    19400    2           RETURN;

  19400  9 002122   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 002123   000001 702211                    TSX2  ! 1,X1

     1373    19401        /**/
     1374    19402    2   BAD_RES:
     1375    19403    2           CALL PCE$ERROR(%E$P_BADRES,3);

  19403  9 002124   000045 630400 10    BAD_RES      EPPR0   37
         9 002125   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002126   000000 701000 xent               TSX1    PCE$ERROR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:192  
         9 002127   000000 011000                    NOP     0

     1376    19404    2   ALT:
     1377    19405    2           ALTRETURN;

  19405  9 002130   200054 221300       ALT          LDX1  ! TEMPLEN+1,,AUTO
         9 002131   000000 702211                    TSX2  ! 0,X1

     1378    19406        /**/
     1379    19407        /*E*     ERROR:    PCC-E$P_BADRES-0
     1380    19408                 MESSAGE:  Unknown resource
     1381    19409                 MESSAGE1: The specified resource type doesnt exist
     1382    19410                 DESCRIPTION: THE USER ASKED FOR A RESOURCE THAT DOESNT EXIST */
     1383    19411    2   END EXEC_ADD;
     1384    19412        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:193  
     1385    19413        /**/
     1386    19414    1   EXEC_DISPLAY: PROC ALTRET;

  19414  9 002132   200054 741300       EXEC_DISPLAY STX1  ! TEMPLEN+1,,AUTO

     1387    19415        /**/
     1388    19416    2    DCL CODE  SBIN;
     1389    19417        /**/
     1390    19418    2           IF (P_PCB.OUT$ -> O$BLK.NSUBLKS = 1)AND

  19418  9 002133   002115 470400 1                  LDP0    P_PCB$
         9 002134   000003 471500                    LDP1    3,,PR0
         9 002135   100001 220100                    LDX0    1,,PR1
         9 002136   000001 100003                    CMPX0   1,DU
         9 002137   002172 601000 9                  TNZ     s:19428
         9 002140   100003 473500                    LDP3    3,,PR1
         9 002141   300000 722100                    LXL2    0,,PR3
         9 002142   000006 102003                    CMPX2   6,DU
         9 002143   002172 601000 9                  TNZ     s:19428

     1391    19419    3             (P_PCB.OUT$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %PC_DISPLAY) THEN DO;

     1392    19420    3              CALL PCT$SYSTEM(%PC_PCTFLAGS) ALTRET (DISPLAY_ERR);

  19420  9 002144   000037 630400 10                 EPPR0   31
         9 002145   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002146   000000 701000 xent               TSX1    PCT$SYSTEM
         9 002147   004603 702000 9                  TSX2    DISPLAY_ERR

     1393    19421    3              CALL PCT$RESOURCE(%PC_PCTFLAGS) ALTRET (DISPLAY_ERR);

  19421  9 002150   000037 630400 10                 EPPR0   31
         9 002151   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002152   000000 701000 xent               TSX1    PCT$RESOURCE
         9 002153   004603 702000 9                  TSX2    DISPLAY_ERR

     1394    19422    3              CALL PCT$PARTITION(%PC_PCTFLAGS) ALTRET(DISPLAY_ERR);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:194  

  19422  9 002154   000037 630400 10                 EPPR0   31
         9 002155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002156   000000 701000 xent               TSX1    PCT$PARTITION
         9 002157   004603 702000 9                  TSX2    DISPLAY_ERR

     1395    19423    3              CALL PCT$EXCEPTION(%PC_PCTFLAGS) ALTRET(DISPLAY_ERR);

  19423  9 002160   000037 630400 10                 EPPR0   31
         9 002161   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002162   000000 701000 xent               TSX1    PCT$EXCEPTION
         9 002163   004603 702000 9                  TSX2    DISPLAY_ERR

     1396    19424    3              CALL PCT$TPCAT(%PC_PCTFLAGS) ALTRET(DISPLAY_ERR);

  19424  9 002164   000037 630400 10                 EPPR0   31
         9 002165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002166   000000 701000 xent               TSX1    PCT$TPCAT
         9 002167   004603 702000 9                  TSX2    DISPLAY_ERR

     1397    19425    3              RETURN;

  19425  9 002170   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 002171   000001 702211                    TSX2  ! 1,X1

     1398    19426    3              END;
     1399    19427        /**/
     1400    19428    2           DISP_TBL = NO;                  /* DISPLAY SPECIFIED ITEMS            */

  19428  9 002172   000000 100400                    MLR     fill='000'O
         9 002173   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 002174   000230 001444 1                  ADSC9   DISP_TBL                 cn=0,n=804

     1401    19429    2           DISP_CAT = NO;

  19429  9 002175   000000 236003                    LDQ     0,DU
         9 002176   000541 752040 1                  STCQ    DISP_CAT,'40'O
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:195  

     1402    19430    2           J = 0;                          /* DISP_TBL INDEX                     */

  19430  9 002177   000026 450000 1                  STZ     J

     1403    19431        /**/
     1404    19432    2           IF (P_PCB.OUT$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %PC_DISPLAY) THEN

  19432  9 002200   000003 471500                    LDP1    3,,PR0
         9 002201   100003 473500                    LDP3    3,,PR1
         9 002202   300000 720100                    LXL0    0,,PR3
         9 002203   000006 100003                    CMPX0   6,DU
         9 002204   002210 601000 9                  TNZ     s:19434

     1405    19433    2              I = 1;

  19433  9 002205   000001 235007                    LDA     1,DL
         9 002206   000025 755000 1                  STA     I
         9 002207   002211 710000 9                  TRA     s:19435

     1406    19434    2           ELSE I = 0;

  19434  9 002210   000025 450000 1                  STZ     I

     1407    19435    3           DO I = I TO P_PCB.OUT$ -> O$BLK.NSUBLKS - 1;

  19435  9 002211   004475 710000 9                  TRA     s:19837+1

     1408    19436    3              BLK$ = P_PCB.OUT$ -> O$BLK.SUBLK$(I);

  19436  9 002212   002115 470400 1                  LDP0    P_PCB$
         9 002213   000003 471500                    LDP1    3,,PR0
         9 002214   000025 720000 1                  LXL0    I
         9 002215   100003 236110                    LDQ     3,X0,PR1
         9 002216   000015 756000 1                  STQ     BLK$

     1409    19437    3              DISP_TBL.PARM.RESINDX(J) = -1; /* INIT NOT THERE                  */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:196  

  19437  9 002217   000026 235000 1                  LDA     J
         9 002220   000001 735000                    ALS     1
         9 002221   777777 221003                    LDX1    -1,DU
         9 002222   000232 741005 1                  STX1    DISP_TBL+2,AL

     1410    19438    4              DO CASE (BLK$ -> O$BLK.CODE);

  19438  9 002223   000015 470400 1                  LDP0    BLK$
         9 002224   000000 720100                    LXL0    0,,PR0
         9 002225   000010 100003                    CMPX0   8,DU
         9 002226   002230 602010 9                  TNC     s:19438+5,X0
         9 002227   004474 710000 9                  TRA     s:19837
         9 002230   003203 710000 9                  TRA     s:19622
         9 002231   002240 710000 9                  TRA     s:19441
         9 002232   004474 710000 9                  TRA     s:19837
         9 002233   002262 710000 9                  TRA     s:19448
         9 002234   002377 710000 9                  TRA     s:19487
         9 002235   002361 710000 9                  TRA     s:19483
         9 002236   002523 710000 9                  TRA     s:19515
         9 002237   004061 710000 9                  TRA     s:19751

     1411    19439        /**/
     1412    19440    4               CASE (%PC_ALL);              /* DISP ALL ITEMS                     */

     1413    19441    4                 CALL PCT$SYSTEM(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19441  9 002240   000047 630400 10                 EPPR0   39
         9 002241   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002242   000000 701000 xent               TSX1    PCT$SYSTEM
         9 002243   004603 702000 9                  TSX2    DISPLAY_ERR

     1414    19442    4                 CALL PCT$RESOURCE(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19442  9 002244   000047 630400 10                 EPPR0   39
         9 002245   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002246   000000 701000 xent               TSX1    PCT$RESOURCE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:197  
         9 002247   004603 702000 9                  TSX2    DISPLAY_ERR

     1415    19443    4                 CALL PCT$PARTITION(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19443  9 002250   000047 630400 10                 EPPR0   39
         9 002251   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002252   000000 701000 xent               TSX1    PCT$PARTITION
         9 002253   004603 702000 9                  TSX2    DISPLAY_ERR

     1416    19444    4                 CALL PCT$EXCEPTION(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19444  9 002254   000047 630400 10                 EPPR0   39
         9 002255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002256   000000 701000 xent               TSX1    PCT$EXCEPTION
         9 002257   004603 702000 9                  TSX2    DISPLAY_ERR

     1417    19445    4                 RETURN;

  19445  9 002260   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 002261   000001 702211                    TSX2  ! 1,X1

     1418    19446        /**/
     1419    19447    4               CASE (%PC_PART#);

     1420    19448    4                 PART#_FLGS = NO;

  19448  9 002262   000050 236000 10                 LDQ     40
         9 002263   000227 356000 1                  ANSQ    PART#_FLGS

     1421    19449        /**/
     1422    19450    4                 TEMP$ = BLK$ -> O$BLK.SUBLK$(0);

  19450  9 002264   000003 236100                    LDQ     3,,PR0
         9 002265   000014 756000 1                  STQ     TEMP$

     1423    19451    5                 DO K = 0 TO TEMP$ -> O$BLK.NSUBLKS - 1;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:198  
  19451  9 002266   000027 450000 1                  STZ     K
         9 002267   002347 710000 9                  TRA     s:19478+1

     1424    19452    5                    PART#$ = TEMP$ -> O$BLK.SUBLK$(K);

  19452  9 002270   000014 470400 1                  LDP0    TEMP$
         9 002271   000027 720000 1                  LXL0    K
         9 002272   000003 236110                    LDQ     3,X0,PR0
         9 002273   000016 756000 1                  STQ     PART#$

     1425    19453        /**/
     1426    19454    6                    IF (PART#$ -> O$BLK.CODE = %PC_ALLOPT) THEN DO;

  19454  9 002274   000016 471400 1                  LDP1    PART#$
         9 002275   100000 721100                    LXL1    0,,PR1
         9 002276   000145 101003                    CMPX1   101,DU
         9 002277   002304 601000 9                  TNZ     s:19460

     1427    19455    6                       TEMP1 = 0;

  19455  9 002300   000023 450000 1                  STZ     TEMP1

     1428    19456    6                       TEMP2 = 15;

  19456  9 002301   000017 235007                    LDA     15,DL
         9 002302   000024 755000 1                  STA     TEMP2

     1429    19457    6                       END;

  19457  9 002303   002331 710000 9                  TRA     s:19475

     1430    19458        /**/
     1431    19459    6                    ELSE DO;

     1432    19460    6                       TEMP1 = PART#$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;

  19460  9 002304   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:199  
         9 002305   300000 236100                    LDQ     0,,PR3
         9 002306   777777 376007                    ANQ     -1,DL
         9 002307   000023 756000 1                  STQ     TEMP1

     1433    19461        /**/
     1434    19462    6                       IF (PART#$ -> O$BLK.NSUBLKS = 1) THEN TEMP2 = TEMP1;

  19462  9 002310   100001 221100                    LDX1    1,,PR1
         9 002311   000001 101003                    CMPX1   1,DU
         9 002312   002315 601000 9                  TNZ     s:19465

  19462  9 002313   000024 756000 1                  STQ     TEMP2
         9 002314   002331 710000 9                  TRA     s:19475

     1435    19463    7                       ELSE DO;

     1436    19464        /**/
     1437    19465    7                          TEMP2 = PART#$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;

  19465  9 002315   100004 473500                    LDP3    4,,PR1
         9 002316   300000 236100                    LDQ     0,,PR3
         9 002317   777777 376007                    ANQ     -1,DL
         9 002320   000024 756000 1                  STQ     TEMP2

     1438    19466        /**/
     1439    19467    8                          IF (TEMP1 > TEMP2) THEN DO;

  19467  9 002321   000023 116000 1                  CMPQ    TEMP1
         9 002322   002331 605000 9                  TPL     s:19475

     1440    19468    8                             CALL PCE$ERROR (%E$P_P#RANGE,2);

  19468  9 002323   000036 630400 10                 EPPR0   30
         9 002324   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002325   000000 701000 xent               TSX1    PCE$ERROR
         9 002326   000000 011000                    NOP     0

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:200  
     1441    19469    8                             ALTRETURN;

  19469  9 002327   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 002330   000000 702211                    TSX2  ! 0,X1

     1442    19470    8                             END;
     1443    19471        /**/
     1444    19472    7                          END;
     1445    19473    6                       END;
     1446    19474        /**/
     1447    19475    6                    DO L = TEMP1 TO TEMP2;

  19475  9 002331   000023 235000 1                  LDA     TEMP1
         9 002332   000030 755000 1                  STA     L
         9 002333   002343 710000 9                  TRA     s:19477+1

     1448    19476    6                       PART#_FLGS(L) = YES;

  19476  9 002334   000030 235000 1                  LDA     L
         9 002335   002337 605000 9                  TPL     s:19476+3
         9 002336   000044 035003                    ADLA    36,DU
         9 002337   003005 060400                    CSL     bolr='003'O
         9 002340   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 002341   000227 000001 1                  BDSC    PART#_FLGS,A             by=0,bit=0,n=1

     1449    19477    6                       END;  /* DO L */

  19477  9 002342   000030 054000 1                  AOS     L
         9 002343   000030 236000 1                  LDQ     L
         9 002344   000024 116000 1                  CMPQ    TEMP2
         9 002345   002334 604400 9                  TMOZ    s:19476

     1450    19478    5                    END;  /* DO J */

  19478  9 002346   000027 054000 1                  AOS     K
         9 002347   000014 470400 1                  LDP0    TEMP$
         9 002350   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:201  
         9 002351   000022 772000                    QRL     18
         9 002352   000027 116000 1                  CMPQ    K
         9 002353   002270 605400 9                  TPNZ    s:19452

     1451    19479        /**/
     1452    19480    4                 CALL PCT$PARTITION (%PC_PCTPART#) ALTRET(DISPLAY_ERR);

  19480  9 002354   000024 630400 10                 EPPR0   20
         9 002355   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002356   000000 701000 xent               TSX1    PCT$PARTITION
         9 002357   004603 702000 9                  TSX2    DISPLAY_ERR
         9 002360   004474 710000 9                  TRA     s:19837

     1453    19481        /**/
     1454    19482    4               CASE (%PC_CATAGORY);

     1455    19483    4                 DISP_CAT(BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE) = YES;

  19483  9 002361   000003 471500                    LDP1    3,,PR0
         9 002362   100000 236100                    LDQ     0,,PR1
         9 002363   777777 376007                    ANQ     -1,DL
         9 002364   003006 060400                    CSL     bolr='003'O
         9 002365   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 002366   000541 000001 1                  BDSC    DISP_CAT,Q               by=0,bit=0,n=1

     1456    19484    4                 IF BLK$->O$BLK.SUBLK$(0)->O$BLK.CODE = %PC_TP

  19484  9 002367   100000 722100                    LXL2    0,,PR1
         9 002370   000004 102003                    CMPX2   4,DU
         9 002371   004474 601000 9                  TNZ     s:19837

     1457    19485    4                    THEN CALL PCT$TPCAT(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19485  9 002372   000047 630400 10                 EPPR0   39
         9 002373   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002374   000000 701000 xent               TSX1    PCT$TPCAT
         9 002375   004603 702000 9                  TSX2    DISPLAY_ERR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:202  
         9 002376   004474 710000 9                  TRA     s:19837

     1458    19486    4              CASE(%PC_TP);

     1459    19487    5                 DO CASE(BLK$->O$BLK.SUBLK$(0)->O$BLK.CODE);

  19487  9 002377   000003 471500                    LDP1    3,,PR0
         9 002400   100000 722100                    LXL2    0,,PR1
         9 002401   000004 102003                    CMPX2   4,DU
         9 002402   002404 602012 9                  TNC     s:19487+5,X2
         9 002403   004474 710000 9                  TRA     s:19837
         9 002404   002522 710000 9                  TRA     s:19512
         9 002405   002410 710000 9                  TRA     s:19489
         9 002406   002460 710000 9                  TRA     s:19502
         9 002407   002415 710000 9                  TRA     s:19491

     1460    19488    5                    CASE(%PC_TPINSTANCE);

     1461    19489    5                       CALL PCT$TPCAT(%PC_DITPI);

  19489  9 002410   000027 630400 10                 EPPR0   23
         9 002411   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002412   000000 701000 xent               TSX1    PCT$TPCAT
         9 002413   000000 011000                    NOP     0
         9 002414   004474 710000 9                  TRA     s:19837

     1462    19490    5                    CASE(%PC_MAXTPU);

     1463    19491    5                       IF BLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS = 0

  19491  9 002415   100001 223100                    LDX3    1,,PR1
         9 002416   002424 601000 9                  TNZ     s:19494

     1464    19492    5                          THEN CALL PCT$TPCAT(%PC_DIMAXTPU);

  19492  9 002417   000051 630400 10                 EPPR0   41
         9 002420   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:203  
         9 002421   000000 701000 xent               TSX1    PCT$TPCAT
         9 002422   000000 011000                    NOP     0
         9 002423   004474 710000 9                  TRA     s:19837

     1465    19493    6                          ELSE DO;

     1466    19494    6                             TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);

  19494  9 002424   100003 236100                    LDQ     3,,PR1
         9 002425   000014 756000 1                  STQ     TEMP$

     1467    19495    7                             DO J = 0 TO TEMP$->O$BLK.NSUBLKS - 1;

  19495  9 002426   000026 450000 1                  STZ     J
         9 002427   002452 710000 9                  TRA     s:19499+1

     1468    19496    7                               TEMPNAME = SUBSTR(TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT,
             19496                                         0,

  19496  9 002430   000014 470400 1                  LDP0    TEMP$
         9 002431   000026 720000 1                  LXL0    J
         9 002432   000003 471510                    LDP1    3,X0,PR0
         9 002433   100004 236100                    LDQ     4,,PR1
         9 002434   000033 772000                    QRL     27
         9 002435   000000 621006                    EAX1    0,QL
         9 002436   040100 100540                    MLR     fill='040'O
         9 002437   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         9 002440   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8

     1469    19497    7                                           TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.COUNT);
     1470    19498    7                                CALL PCT$TPCAT(%PC_DIMAXTPU,TEMPNAME);

  19498  9 002441   200050 631500                    EPPR1   TEMPNAME,,AUTO
         9 002442   200077 451500                    STP1    TEMPTEXT+5,,AUTO
         9 002443   000051 236000 10                 LDQ     41
         9 002444   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 002445   200076 630500                    EPPR0   TEMPTEXT+4,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:204  
         9 002446   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002447   000000 701000 xent               TSX1    PCT$TPCAT
         9 002450   000000 011000                    NOP     0

     1471    19499    7                                END;  /* DO J */

  19499  9 002451   000026 054000 1                  AOS     J
         9 002452   000014 470400 1                  LDP0    TEMP$
         9 002453   000001 236100                    LDQ     1,,PR0
         9 002454   000022 772000                    QRL     18
         9 002455   000026 116000 1                  CMPQ    J
         9 002456   002430 605400 9                  TPNZ    s:19496

     1472    19500    6                             END;  /* ELSE */

  19500  9 002457   004474 710000 9                  TRA     s:19837

     1473    19501    5                    CASE(%PC_TPHDR);

     1474    19502    5                       IF BLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS = 0

  19502  9 002460   100001 223100                    LDX3    1,,PR1
         9 002461   002467 601000 9                  TNZ     s:19505

     1475    19503    5                          THEN CALL PCT$TPCAT(%PC_DITPHDR);

  19503  9 002462   000052 630400 10                 EPPR0   42
         9 002463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002464   000000 701000 xent               TSX1    PCT$TPCAT
         9 002465   000000 011000                    NOP     0
         9 002466   004474 710000 9                  TRA     s:19837

     1476    19504    6                          ELSE DO;

     1477    19505    6                             TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);

  19505  9 002467   100003 236100                    LDQ     3,,PR1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:205  
         9 002470   000014 756000 1                  STQ     TEMP$

     1478    19506    7                             DO J = 0 TO TEMP$->O$BLK.NSUBLKS - 1;

  19506  9 002471   000026 450000 1                  STZ     J
         9 002472   002515 710000 9                  TRA     s:19510+1

     1479    19507    7                               TEMPNAME = SUBSTR(TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.TEXT,
             19507                                         0,

  19507  9 002473   000014 470400 1                  LDP0    TEMP$
         9 002474   000026 720000 1                  LXL0    J
         9 002475   000003 471510                    LDP1    3,X0,PR0
         9 002476   100004 236100                    LDQ     4,,PR1
         9 002477   000033 772000                    QRL     27
         9 002500   000000 621006                    EAX1    0,QL
         9 002501   040100 100540                    MLR     fill='040'O
         9 002502   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         9 002503   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8

     1480    19508    7                                           TEMP$->O$BLK.SUBLK$(J)->OUT$SYM.COUNT);
     1481    19509    7                                CALL PCT$TPCAT(%PC_DITPHDR,TEMPNAME);

  19509  9 002504   200050 631500                    EPPR1   TEMPNAME,,AUTO
         9 002505   200077 451500                    STP1    TEMPTEXT+5,,AUTO
         9 002506   000052 236000 10                 LDQ     42
         9 002507   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 002510   200076 630500                    EPPR0   TEMPTEXT+4,,AUTO
         9 002511   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002512   000000 701000 xent               TSX1    PCT$TPCAT
         9 002513   000000 011000                    NOP     0

     1482    19510    7                                END;  /* DO J */

  19510  9 002514   000026 054000 1                  AOS     J
         9 002515   000014 470400 1                  LDP0    TEMP$
         9 002516   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:206  
         9 002517   000022 772000                    QRL     18
         9 002520   000026 116000 1                  CMPQ    J
         9 002521   002473 605400 9                  TPNZ    s:19507

     1483    19511    6                             END;  /* ELSE */

     1484    19512    5                    END;  /* DO CASE CODE */

  19512  9 002522   004474 710000 9                  TRA     s:19837

     1485    19513        /**/
     1486    19514    4               CASE (%PC_PARAM);

     1487    19515    4                 DISP_TBL.PARM.CAT(J) = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;

  19515  9 002523   000026 235000 1                  LDA     J
         9 002524   000001 735000                    ALS     1
         9 002525   000003 471500                    LDP1    3,,PR0
         9 002526   100000 236100                    LDQ     0,,PR1
         9 002527   000033 736000                    QLS     27
         9 002530   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 002531   777000 376003                    ANQ     -512,DU
         9 002532   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1488    19516        /**/
     1489    19517    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);

  19517  9 002533   000003 471500                    LDP1    3,,PR0
         9 002534   100003 236100                    LDQ     3,,PR1
         9 002535   000017 756000 1                  STQ     PARAM$

     1490    19518        /**/
     1491    19519    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND

  19519  9 002536   000026 235000 1                  LDA     J
         9 002537   000001 735000                    ALS     1
         9 002540   000231 236005 1                  LDQ     DISP_TBL+1,AL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:207  
         9 002541   777000 376003                    ANQ     -512,DU
         9 002542   001000 116003                    CMPQ    512,DU
         9 002543   002611 601000 9                  TNZ     s:19532
         9 002544   000017 473400 1                  LDP3    PARAM$
         9 002545   300000 720100                    LXL0    0,,PR3
         9 002546   000071 100003                    CMPX0   57,DU
         9 002547   002611 601000 9                  TNZ     s:19532

     1492    19520    5                    (PARAM$ -> O$BLK.CODE = %PC_EXPTIME_ALL)  THEN DO;

     1493    19521    6                    DO CODE = %PC_EXPTIME_LO TO %PC_EXPTIME_HI;

  19521  9 002550   000031 235007                    LDA     25,DL
         9 002551   200055 755100                    STA     CODE,,AUTO

     1494    19522    6                      DISP_TBL.PARM.PARM(J) = CODE;

  19522  9 002552   000026 235000 1                  LDA     J
         9 002553   000001 735000                    ALS     1
         9 002554   200055 236100                    LDQ     CODE,,AUTO
         9 002555   000022 736000                    QLS     18
         9 002556   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 002557   000777 376003                    ANQ     511,DU
         9 002560   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1495    19523    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;

  19523  9 002561   000026 235000 1                  LDA     J
         9 002562   000001 735000                    ALS     1
         9 002563   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 002564   000032 376000 xsym               ANQ     B_VECTNIL+26
         9 002565   001000 276003                    ORQ     512,DU
         9 002566   000231 756005 1                  STQ     DISP_TBL+1,AL

     1496    19524    6                      DISP_TBL.PARM.RESINDX(J) = -1;

  19524  9 002567   000026 235000 1                  LDA     J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:208  
         9 002570   000001 735000                    ALS     1
         9 002571   777777 220003                    LDX0    -1,DU
         9 002572   000232 740005 1                  STX0    DISP_TBL+2,AL

     1497    19525    6                      J = J + 1;

  19525  9 002573   000026 054000 1                  AOS     J

     1498    19526    6                    END;  /*do CODE*/

  19526  9 002574   200055 054100                    AOS     CODE,,AUTO
         9 002575   200055 235100                    LDA     CODE,,AUTO
         9 002576   000042 115007                    CMPA    34,DL
         9 002577   002552 604400 9                  TMOZ    s:19522

     1499    19527    5                    DISP_TBL.INDX = J;

  19527  9 002600   000026 236000 1                  LDQ     J
         9 002601   000230 756000 1                  STQ     DISP_TBL

     1500    19528    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);

  19528  9 002602   000053 630400 10                 EPPR0   43
         9 002603   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002604   000000 701000 xent               TSX1    PCP$PDISP
         9 002605   004603 702000 9                  TSX2    DISPLAY_ERR

     1501    19529    5                    J = -1;   /* re-adjust for incr below */

  19529  9 002606   000001 335007                    LCA     1,DL
         9 002607   000026 755000 1                  STA     J

     1502    19530    5                 END;  /*if*/

  19530  9 002610   003004 710000 9                  TRA     s:19572

     1503    19531    4                 ELSE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:209  
     1504    19532    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND

  19532  9 002611   001000 116003                    CMPQ    512,DU
         9 002612   002660 601000 9                  TNZ     s:19545
         9 002613   000017 473400 1                  LDP3    PARAM$
         9 002614   300000 720100                    LXL0    0,,PR3
         9 002615   000072 100003                    CMPX0   58,DU
         9 002616   002660 601000 9                  TNZ     s:19545

     1505    19533    5                    (PARAM$ -> O$BLK.CODE = %PC_UPDLIMIT_ALL)  THEN DO;

     1506    19534    6                    DO CODE = %PC_UPDLIMIT_LO TO %PC_UPDLIMIT_HI;

  19534  9 002617   000043 235007                    LDA     35,DL
         9 002620   200055 755100                    STA     CODE,,AUTO

     1507    19535    6                      DISP_TBL.PARM.PARM(J) = CODE;

  19535  9 002621   000026 235000 1                  LDA     J
         9 002622   000001 735000                    ALS     1
         9 002623   200055 236100                    LDQ     CODE,,AUTO
         9 002624   000022 736000                    QLS     18
         9 002625   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 002626   000777 376003                    ANQ     511,DU
         9 002627   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1508    19536    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;

  19536  9 002630   000026 235000 1                  LDA     J
         9 002631   000001 735000                    ALS     1
         9 002632   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 002633   000032 376000 xsym               ANQ     B_VECTNIL+26
         9 002634   001000 276003                    ORQ     512,DU
         9 002635   000231 756005 1                  STQ     DISP_TBL+1,AL

     1509    19537    6                      DISP_TBL.PARM.RESINDX(J) = -1;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:210  
  19537  9 002636   000026 235000 1                  LDA     J
         9 002637   000001 735000                    ALS     1
         9 002640   777777 220003                    LDX0    -1,DU
         9 002641   000232 740005 1                  STX0    DISP_TBL+2,AL

     1510    19538    6                      J = J + 1;

  19538  9 002642   000026 054000 1                  AOS     J

     1511    19539    6                    END;  /*do CODE*/

  19539  9 002643   200055 054100                    AOS     CODE,,AUTO
         9 002644   200055 235100                    LDA     CODE,,AUTO
         9 002645   000045 115007                    CMPA    37,DL
         9 002646   002621 604400 9                  TMOZ    s:19535

     1512    19540    5                    DISP_TBL.INDX = J;

  19540  9 002647   000026 236000 1                  LDQ     J
         9 002650   000230 756000 1                  STQ     DISP_TBL

     1513    19541    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);

  19541  9 002651   000053 630400 10                 EPPR0   43
         9 002652   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002653   000000 701000 xent               TSX1    PCP$PDISP
         9 002654   004603 702000 9                  TSX2    DISPLAY_ERR

     1514    19542    5                    J = -1;   /* re-adjust for incr below */

  19542  9 002655   000001 335007                    LCA     1,DL
         9 002656   000026 755000 1                  STA     J

     1515    19543    5                 END;  /*if*/

  19543  9 002657   003004 710000 9                  TRA     s:19572

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:211  
     1516    19544    4                 ELSE
     1517    19545    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND

  19545  9 002660   001000 116003                    CMPQ    512,DU
         9 002661   002727 601000 9                  TNZ     s:19558
         9 002662   000017 473400 1                  LDP3    PARAM$
         9 002663   300000 720100                    LXL0    0,,PR3
         9 002664   000074 100003                    CMPX0   60,DU
         9 002665   002727 601000 9                  TNZ     s:19558

     1518    19546    5                    (PARAM$ -> O$BLK.CODE = %PC_IOCACHE_ALL)  THEN DO;

     1519    19547    6                    DO CODE = %PC_EXPTIME_LO TO %PC_UPDLIMIT_HI;

  19547  9 002666   000031 235007                    LDA     25,DL
         9 002667   200055 755100                    STA     CODE,,AUTO

     1520    19548    6                      DISP_TBL.PARM.PARM(J) = CODE;

  19548  9 002670   000026 235000 1                  LDA     J
         9 002671   000001 735000                    ALS     1
         9 002672   200055 236100                    LDQ     CODE,,AUTO
         9 002673   000022 736000                    QLS     18
         9 002674   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 002675   000777 376003                    ANQ     511,DU
         9 002676   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1521    19549    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;

  19549  9 002677   000026 235000 1                  LDA     J
         9 002700   000001 735000                    ALS     1
         9 002701   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 002702   000032 376000 xsym               ANQ     B_VECTNIL+26
         9 002703   001000 276003                    ORQ     512,DU
         9 002704   000231 756005 1                  STQ     DISP_TBL+1,AL

     1522    19550    6                      DISP_TBL.PARM.RESINDX(J) = -1;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:212  

  19550  9 002705   000026 235000 1                  LDA     J
         9 002706   000001 735000                    ALS     1
         9 002707   777777 220003                    LDX0    -1,DU
         9 002710   000232 740005 1                  STX0    DISP_TBL+2,AL

     1523    19551    6                      J = J + 1;

  19551  9 002711   000026 054000 1                  AOS     J

     1524    19552    6                    END;  /*do CODE*/

  19552  9 002712   200055 054100                    AOS     CODE,,AUTO
         9 002713   200055 235100                    LDA     CODE,,AUTO
         9 002714   000045 115007                    CMPA    37,DL
         9 002715   002670 604400 9                  TMOZ    s:19548

     1525    19553    5                    DISP_TBL.INDX = J;

  19553  9 002716   000026 236000 1                  LDQ     J
         9 002717   000230 756000 1                  STQ     DISP_TBL

     1526    19554    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);

  19554  9 002720   000053 630400 10                 EPPR0   43
         9 002721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002722   000000 701000 xent               TSX1    PCP$PDISP
         9 002723   004603 702000 9                  TSX2    DISPLAY_ERR

     1527    19555    5                    J = -1;   /* re-adjust for incr below */

  19555  9 002724   000001 335007                    LCA     1,DL
         9 002725   000026 755000 1                  STA     J

     1528    19556    5                 END;  /*if*/

  19556  9 002726   003004 710000 9                  TRA     s:19572
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:213  

     1529    19557    4                 ELSE
     1530    19558    4                 IF (DISP_TBL.PARM.CAT(J) = %PC_SYSTEM) AND

  19558  9 002727   001000 116003                    CMPQ    512,DU
         9 002730   002776 601000 9                  TNZ     s:19571
         9 002731   000017 473400 1                  LDP3    PARAM$
         9 002732   300000 720100                    LXL0    0,,PR3
         9 002733   000073 100003                    CMPX0   59,DU
         9 002734   002776 601000 9                  TNZ     s:19571

     1531    19559    5                    (PARAM$ -> O$BLK.CODE = %PC_SECURITY_ALL)  THEN DO;

     1532    19560    6                    DO CODE = %PC_SECURITY_LO TO %PC_SECURITY_HI;

  19560  9 002735   000051 235007                    LDA     41,DL
         9 002736   200055 755100                    STA     CODE,,AUTO

     1533    19561    6                      DISP_TBL.PARM.PARM(J) = CODE;

  19561  9 002737   000026 235000 1                  LDA     J
         9 002740   000001 735000                    ALS     1
         9 002741   200055 236100                    LDQ     CODE,,AUTO
         9 002742   000022 736000                    QLS     18
         9 002743   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 002744   000777 376003                    ANQ     511,DU
         9 002745   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1534    19562    6                      DISP_TBL.PARM.CAT(J) = %PC_SYSTEM;

  19562  9 002746   000026 235000 1                  LDA     J
         9 002747   000001 735000                    ALS     1
         9 002750   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 002751   000032 376000 xsym               ANQ     B_VECTNIL+26
         9 002752   001000 276003                    ORQ     512,DU
         9 002753   000231 756005 1                  STQ     DISP_TBL+1,AL

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:214  
     1535    19563    6                      DISP_TBL.PARM.RESINDX(J) = -1;

  19563  9 002754   000026 235000 1                  LDA     J
         9 002755   000001 735000                    ALS     1
         9 002756   777777 220003                    LDX0    -1,DU
         9 002757   000232 740005 1                  STX0    DISP_TBL+2,AL

     1536    19564    6                      J = J + 1;

  19564  9 002760   000026 054000 1                  AOS     J

     1537    19565    6                    END;  /*do CODE*/

  19565  9 002761   200055 054100                    AOS     CODE,,AUTO
         9 002762   200055 235100                    LDA     CODE,,AUTO
         9 002763   000064 115007                    CMPA    52,DL
         9 002764   002737 604400 9                  TMOZ    s:19561

     1538    19566    5                    DISP_TBL.INDX = J;

  19566  9 002765   000026 236000 1                  LDQ     J
         9 002766   000230 756000 1                  STQ     DISP_TBL

     1539    19567    5                    CALL PCP$PDISP( DISP_TBL) ALTRET( DISPLAY_ERR);

  19567  9 002767   000053 630400 10                 EPPR0   43
         9 002770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002771   000000 701000 xent               TSX1    PCP$PDISP
         9 002772   004603 702000 9                  TSX2    DISPLAY_ERR

     1540    19568    5                    J = -1;   /* re-adjust for incr below */

  19568  9 002773   000001 335007                    LCA     1,DL
         9 002774   000026 755000 1                  STA     J

     1541    19569    5                 END;  /*if*/

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:215  
  19569  9 002775   003004 710000 9                  TRA     s:19572

     1542    19570    4                 ELSE
     1543    19571    4                    DISP_TBL.PARM.PARM(J) = PARAM$ -> O$BLK.CODE;

  19571  9 002776   000017 473400 1                  LDP3    PARAM$
         9 002777   300000 236100                    LDQ     0,,PR3
         9 003000   000022 736000                    QLS     18
         9 003001   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 003002   000777 376003                    ANQ     511,DU
         9 003003   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1544    19572    4                 DISP_TBL.PARM.PARM(J) = PARAM$ -> O$BLK.CODE;

  19572  9 003004   000026 235000 1                  LDA     J
         9 003005   000001 735000                    ALS     1
         9 003006   000017 470400 1                  LDP0    PARAM$
         9 003007   000000 236100                    LDQ     0,,PR0
         9 003010   000022 736000                    QLS     18
         9 003011   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 003012   000777 376003                    ANQ     511,DU
         9 003013   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1545    19573        /**/
     1546    19574    4                 IF (PARAM$ -> O$BLK.NSUBLKS ~= 0)  AND     /* RESOURCE SPECIFIED */

  19574  9 003014   000001 220100                    LDX0    1,,PR0
         9 003015   003035 600000 9                  TZE     s:19582
         9 003016   000000 721100                    LXL1    0,,PR0
         9 003017   000071 101003                    CMPX1   57,DU
         9 003020   003035 600000 9                  TZE     s:19582
         9 003021   000072 101003                    CMPX1   58,DU
         9 003022   003035 600000 9                  TZE     s:19582

     1547    19575    4                    (PARAM$ -> O$BLK.CODE ~= %PC_EXPTIME_ALL)   AND
     1548    19576    5                    (PARAM$ -> O$BLK.CODE ~= %PC_UPDLIMIT_ALL)  THEN DO;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:216  
     1549    19577    5                    CALL GET_RES (RES_INDX,PARAM$ -> O$BLK.SUBLK$(0) -> OUT$SYM)

  19577  9 003023   000003 471500                    LDP1    3,,PR0
         9 003024   200060 451500                    STP1    @PRINT_FLAG+1,,AUTO
         9 003025   000043 236000 10                 LDQ     35
         9 003026   200057 756100                    STQ     CODE+2,,AUTO
         9 003027   004605 701000 9                  TSX1    GET_RES
         9 003030   004577 702000 9                  TSX2    BAD_RES

     1550    19578    5                      ALTRET (BAD_RES);
     1551    19579    5                    DISP_TBL.PARM.RESINDX(J) = RES_INDX;

  19579  9 003031   000026 235000 1                  LDA     J
         9 003032   000001 735000                    ALS     1
         9 003033   000062 720000 1                  LXL0    RES_INDX
         9 003034   000232 740005 1                  STX0    DISP_TBL+2,AL

     1552    19580    5                    END;

     1553    19581        /**/
     1554    19582    4                 IF (BLK$ -> O$BLK.NSUBLKS = 1) THEN /* NOT INDEXED              */

  19582  9 003035   000015 470400 1                  LDP0    BLK$
         9 003036   000001 220100                    LDX0    1,,PR0
         9 003037   000001 100003                    CMPX0   1,DU
         9 003040   003050 601000 9                  TNZ     s:19586

     1555    19583    4                    DISP_TBL.PARM.INDEXLO(J) = %PC_ALLOPT;

  19583  9 003041   000026 235000 1                  LDA     J
         9 003042   000001 735000                    ALS     1
         9 003043   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 003044   000054 376000 10                 ANQ     44
         9 003045   145000 276007                    ORQ     51712,DL
         9 003046   000231 756005 1                  STQ     DISP_TBL+1,AL
         9 003047   003201 710000 9                  TRA     s:19620

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:217  
     1556    19584        /**/
     1557    19585    5                 ELSE DO;                  /* INDEX SPECIFIED                    */

     1558    19586    5                    IF ~(CAT$ -> CAT$TBL.PARAM$(DISP_TBL.PARM.CAT(J)) ->

  19586  9 003050   000026 235000 1                  LDA     J
         9 003051   000001 735000                    ALS     1
         9 003052   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 003053   000032 772000                    QRL     26
         9 003054   001776 376007                    ANQ     1022,DL
         9 003055   000000 471400 1                  LDP1    CAT$
         9 003056   100001 473506                    LDP3    1,QL,PR1
         9 003057   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 003060   000022 772000                    QRL     18
         9 003061   000777 376007                    ANQ     511,DL
         9 003062   000014 402007                    MPY     12,DL
         9 003063   300000 236106                    LDQ     0,QL,PR3
         9 003064   000002 736000                    QLS     2
         9 003065   400000 376003                    ANQ     -131072,DU
         9 003066   400000 676003                    ERQ     -131072,DU
         9 003067   003076 600000 9                  TZE     s:19597

     1559    19587    6                      P$TBL.FLAGS.INDX(DISP_TBL.PARM.PARM(J))) THEN DO;

     1560    19588    6                       CALL PCE$ERROR(%E$P_NOTINDEX,2);

  19588  9 003070   000056 630400 10                 EPPR0   46
         9 003071   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003072   000000 701000 xent               TSX1    PCE$ERROR
         9 003073   000000 011000                    NOP     0

     1561    19589    6                       ALTRETURN;

  19589  9 003074   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 003075   000000 702211                    TSX2  ! 0,X1

     1562    19590    6                       END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:218  
     1563    19591        /**/
     1564    19592        /*E*     ERROR:    PCC-E$P_NOTINDEX-0
     1565    19593                 MESSAGE:  Dont try to index an unindexed parameter
     1566    19594                 DESCRIPTION:   USER SPECIFIED AN INDEX ON A PARAMETER WHICH
     1567    19595                                DOESNT HAVE ONE          */
     1568    19596        /**/
     1569    19597    5                    INDEX$ = BLK$ -> O$BLK.SUBLK$(1);

  19597  9 003076   000004 236100                    LDQ     4,,PR0
         9 003077   000020 756000 1                  STQ     INDEX$

     1570    19598    6                    DO K = 0 TO INDEX$ -> O$BLK.NSUBLKS - 1; /* DO ALL INDEXES   */

  19598  9 003100   000027 450000 1                  STZ     K
         9 003101   003174 710000 9                  TRA     s:19618+1

     1571    19599    7                       IF (K ~= 0) THEN DO;

  19599  9 003102   000027 235000 1                  LDA     K
         9 003103   003115 600000 9                  TZE     s:19604

     1572    19600    7                          DISP_TBL.PARM(J+1) = DISP_TBL.PARM(J);

  19600  9 003104   000026 236000 1                  LDQ     J
         9 003105   000001 736000                    QLS     1
         9 003106   000026 235000 1                  LDA     J
         9 003107   000003 735000                    ALS     3
         9 003110   000002 736000                    QLS     2
         9 003111   000006 100405                    MLR     fill='000'O
         9 003112   000231 000006 1                  ADSC9   DISP_TBL+1,A             cn=0,n=6
         9 003113   000233 000006 1                  ADSC9   DISP_TBL+3,Q             cn=0,n=6

     1573    19601    7                          J = J+1;

  19601  9 003114   000026 054000 1                  AOS     J

     1574    19602    7                          END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:219  

     1575    19603        /**/
     1576    19604    6                       TEMP$ = INDEX$ -> O$BLK.SUBLK$(K);

  19604  9 003115   000020 470400 1                  LDP0    INDEX$
         9 003116   000027 720000 1                  LXL0    K
         9 003117   000003 236110                    LDQ     3,X0,PR0
         9 003120   000014 756000 1                  STQ     TEMP$

     1577    19605        /**/
     1578    19606    6                       DISP_TBL.PARM.INDEXLO(J) = TEMP$ -> O$BLK.SUBLK$(0) -> O$BLK.
             19606                                CODE;

  19606  9 003121   000026 235000 1                  LDA     J
         9 003122   000001 735000                    ALS     1
         9 003123   000014 471400 1                  LDP1    TEMP$
         9 003124   100003 473500                    LDP3    3,,PR1
         9 003125   300000 236100                    LDQ     0,,PR3
         9 003126   000011 736000                    QLS     9
         9 003127   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 003130   777000 376007                    ANQ     -512,DL
         9 003131   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1579    19607    6                       DISP_TBL.PARM.INDEXHI(J) = DISP_TBL.PARM.INDEXLO(J);

  19607  9 003132   000026 235000 1                  LDA     J
         9 003133   000001 735000                    ALS     1
         9 003134   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 003135   000011 772000                    QRL     9
         9 003136   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 003137   000777 376007                    ANQ     511,DL
         9 003140   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1580    19608        /**/
     1581    19609    7                       IF (TEMP$ -> O$BLK.NSUBLKS ~= 1) THEN DO; /* RANGE SPECIFIED */

  19609  9 003141   100001 221100                    LDX1    1,,PR1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:220  
         9 003142   000001 101003                    CMPX1   1,DU
         9 003143   003173 600000 9                  TZE     s:19618

     1582    19610    7                          DISP_TBL.PARM.INDEXHI(J) = TEMP$ ->

  19610  9 003144   000026 235000 1                  LDA     J
         9 003145   000001 735000                    ALS     1
         9 003146   100004 473500                    LDP3    4,,PR1
         9 003147   300000 236100                    LDQ     0,,PR3
         9 003150   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 003151   000777 376007                    ANQ     511,DL
         9 003152   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1583    19611    7                            O$BLK.SUBLK$(1) -> O$BLK.CODE;
     1584    19612    7                          IF (DISP_TBL.PARM.INDEXHI(J) <

  19612  9 003153   000026 235000 1                  LDA     J
         9 003154   000001 735000                    ALS     1
         9 003155   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 003156   000011 772000                    QRL     9
         9 003157   000777 376007                    ANQ     511,DL
         9 003160   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 003161   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 003162   000777 376007                    ANQ     511,DL
         9 003163   200076 116100                    CMPQ    TEMPTEXT+4,,AUTO
         9 003164   003173 605000 9                  TPL     s:19618

     1585    19613    8                            DISP_TBL.PARM.INDEXLO(J)) THEN DO;

     1586    19614    8                             CALL PCE$ERROR (%E$P_P#RANGE,2);

  19614  9 003165   000036 630400 10                 EPPR0   30
         9 003166   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 003167   000000 701000 xent               TSX1    PCE$ERROR
         9 003170   000000 011000                    NOP     0

     1587    19615    8                             RETURN;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:221  

  19615  9 003171   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 003172   000001 702211                    TSX2  ! 1,X1

     1588    19616    8                             END;
     1589    19617    7                          END;
     1590    19618    6                       END;

  19618  9 003173   000027 054000 1                  AOS     K
         9 003174   000020 470400 1                  LDP0    INDEX$
         9 003175   000001 236100                    LDQ     1,,PR0
         9 003176   000022 772000                    QRL     18
         9 003177   000027 116000 1                  CMPQ    K
         9 003200   003102 605400 9                  TPNZ    s:19599

     1591    19619    5                    END;

     1592    19620    4                 J = J+1;                  /* NEXT SLOT                          */

  19620  9 003201   000026 054000 1                  AOS     J
         9 003202   004474 710000 9                  TRA     s:19837

     1593    19621    4               CASE(%PC_RU);

     1594    19622    4                 RU_PARAMS = '0'B;

  19622  9 003203   001741 450000 1                  STZ     RU_PARAMS

     1595    19623    4                 HEAD_FID.TEXTFID_ = VECTOR(BLK$->O$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  19623  9 003204   000003 471500                    LDP1    3,,PR0
         9 003205   100004 236100                    LDQ     4,,PR1
         9 003206   000033 772000                    QRL     27
         9 003207   000064 737000                    LLS     52
         9 003210   000140 135007                    SBLA    96,DL
         9 003211   200076 451500                    STP1    TEMPTEXT+4,,AUTO
         9 003212   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:222  
         9 003213   000060 036000 10                 ADLQ    48
         9 003214   010756 757000 1                  STAQ    HEAD_FID+2

     1596    19624    4                 CALL M$FID(HEAD_FID) ALTRET(BAD_FID);

  19624  9 003215   010754 630400 1                  EPPR0   HEAD_FID
         9 003216   420001 713400                    CLIMB   alt,+8193
         9 003217   404400 401760                    pmme    nvectors=10
         9 003220   004023 702000 9                  TSX2    BAD_FID

     1597    19625    4                 OPEN_RU.V.FUN# = %INPUT#;

  19625  9 003221   004000 236007                    LDQ     2048,DL
         9 003222   011051 552010 1                  STBQ    OPEN_RU+37,'10'O

     1598    19626    4                 CALL M$OPEN(OPEN_RU) ALTRET(BAD_FILE);

  19626  9 003223   011004 630400 1                  EPPR0   OPEN_RU
         9 003224   450000 713400                    CLIMB   alt,open
         9 003225   410400 401760                    pmme    nvectors=18
         9 003226   004030 702000 9                  TSX2    BAD_FILE

     1599    19627    4                 CALL M$READ(READ_HEAD) ALTRET(BAD_FILE);

  19627  9 003227   011132 630400 1                  EPPR0   READ_HEAD
         9 003230   440000 713400                    CLIMB   alt,read
         9 003231   401400 401760                    pmme    nvectors=4
         9 003232   004030 702000 9                  TSX2    BAD_FILE

     1600    19628    5                 DO J = 1 TO BLK$->O$BLK.NSUBLKS - 1;

  19628  9 003233   000001 235007                    LDA     1,DL
         9 003234   000026 755000 1                  STA     J
         9 003235   003426 710000 9                  TRA     s:19638+1

     1601    19629    6                    DO CASE(BLK$->O$BLK.SUBLK$(J)->O$BLK.SUBLK$(0)->O$BLK.CODE);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:223  
  19629  9 003236   000015 470400 1                  LDP0    BLK$
         9 003237   000026 720000 1                  LXL0    J
         9 003240   000003 471510                    LDP1    3,X0,PR0
         9 003241   100003 473500                    LDP3    3,,PR1
         9 003242   300000 236100                    LDQ     0,,PR3
         9 003243   777777 376007                    ANQ     -1,DL
         9 003244   000006 136007                    SBLQ    6,DL
         9 003245   000140 116007                    CMPQ    96,DL
         9 003246   003250 602006 9                  TNC     s:19629+10,QL
         9 003247   003420 710000 9                  TRA     s:19636
         9 003250   003413 710000 9                  TRA     s:19633
         9 003251   003420 710000 9                  TRA     s:19636
         9 003252   003420 710000 9                  TRA     s:19636
         9 003253   003420 710000 9                  TRA     s:19636
         9 003254   003420 710000 9                  TRA     s:19636
         9 003255   003420 710000 9                  TRA     s:19636
         9 003256   003420 710000 9                  TRA     s:19636
         9 003257   003420 710000 9                  TRA     s:19636
         9 003260   003420 710000 9                  TRA     s:19636
         9 003261   003420 710000 9                  TRA     s:19636
         9 003262   003420 710000 9                  TRA     s:19636
         9 003263   003420 710000 9                  TRA     s:19636
         9 003264   003420 710000 9                  TRA     s:19636
         9 003265   003420 710000 9                  TRA     s:19636
         9 003266   003420 710000 9                  TRA     s:19636
         9 003267   003420 710000 9                  TRA     s:19636
         9 003270   003420 710000 9                  TRA     s:19636
         9 003271   003420 710000 9                  TRA     s:19636
         9 003272   003420 710000 9                  TRA     s:19636
         9 003273   003420 710000 9                  TRA     s:19636
         9 003274   003420 710000 9                  TRA     s:19636
         9 003275   003420 710000 9                  TRA     s:19636
         9 003276   003420 710000 9                  TRA     s:19636
         9 003277   003420 710000 9                  TRA     s:19636
         9 003300   003420 710000 9                  TRA     s:19636
         9 003301   003420 710000 9                  TRA     s:19636
         9 003302   003420 710000 9                  TRA     s:19636
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:224  
         9 003303   003420 710000 9                  TRA     s:19636
         9 003304   003420 710000 9                  TRA     s:19636
         9 003305   003420 710000 9                  TRA     s:19636
         9 003306   003420 710000 9                  TRA     s:19636
         9 003307   003420 710000 9                  TRA     s:19636
         9 003310   003420 710000 9                  TRA     s:19636
         9 003311   003420 710000 9                  TRA     s:19636
         9 003312   003420 710000 9                  TRA     s:19636
         9 003313   003420 710000 9                  TRA     s:19636
         9 003314   003420 710000 9                  TRA     s:19636
         9 003315   003420 710000 9                  TRA     s:19636
         9 003316   003420 710000 9                  TRA     s:19636
         9 003317   003420 710000 9                  TRA     s:19636
         9 003320   003420 710000 9                  TRA     s:19636
         9 003321   003420 710000 9                  TRA     s:19636
         9 003322   003420 710000 9                  TRA     s:19636
         9 003323   003420 710000 9                  TRA     s:19636
         9 003324   003420 710000 9                  TRA     s:19636
         9 003325   003420 710000 9                  TRA     s:19636
         9 003326   003420 710000 9                  TRA     s:19636
         9 003327   003420 710000 9                  TRA     s:19636
         9 003330   003420 710000 9                  TRA     s:19636
         9 003331   003420 710000 9                  TRA     s:19636
         9 003332   003420 710000 9                  TRA     s:19636
         9 003333   003420 710000 9                  TRA     s:19636
         9 003334   003420 710000 9                  TRA     s:19636
         9 003335   003420 710000 9                  TRA     s:19636
         9 003336   003420 710000 9                  TRA     s:19636
         9 003337   003420 710000 9                  TRA     s:19636
         9 003340   003420 710000 9                  TRA     s:19636
         9 003341   003420 710000 9                  TRA     s:19636
         9 003342   003420 710000 9                  TRA     s:19636
         9 003343   003420 710000 9                  TRA     s:19636
         9 003344   003420 710000 9                  TRA     s:19636
         9 003345   003420 710000 9                  TRA     s:19636
         9 003346   003420 710000 9                  TRA     s:19636
         9 003347   003420 710000 9                  TRA     s:19636
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:225  
         9 003350   003420 710000 9                  TRA     s:19636
         9 003351   003420 710000 9                  TRA     s:19636
         9 003352   003420 710000 9                  TRA     s:19636
         9 003353   003420 710000 9                  TRA     s:19636
         9 003354   003420 710000 9                  TRA     s:19636
         9 003355   003420 710000 9                  TRA     s:19636
         9 003356   003420 710000 9                  TRA     s:19636
         9 003357   003420 710000 9                  TRA     s:19636
         9 003360   003420 710000 9                  TRA     s:19636
         9 003361   003420 710000 9                  TRA     s:19636
         9 003362   003420 710000 9                  TRA     s:19636
         9 003363   003420 710000 9                  TRA     s:19636
         9 003364   003420 710000 9                  TRA     s:19636
         9 003365   003420 710000 9                  TRA     s:19636
         9 003366   003420 710000 9                  TRA     s:19636
         9 003367   003420 710000 9                  TRA     s:19636
         9 003370   003420 710000 9                  TRA     s:19636
         9 003371   003420 710000 9                  TRA     s:19636
         9 003372   003420 710000 9                  TRA     s:19636
         9 003373   003420 710000 9                  TRA     s:19636
         9 003374   003420 710000 9                  TRA     s:19636
         9 003375   003420 710000 9                  TRA     s:19636
         9 003376   003420 710000 9                  TRA     s:19636
         9 003377   003420 710000 9                  TRA     s:19636
         9 003400   003420 710000 9                  TRA     s:19636
         9 003401   003420 710000 9                  TRA     s:19636
         9 003402   003420 710000 9                  TRA     s:19636
         9 003403   003420 710000 9                  TRA     s:19636
         9 003404   003420 710000 9                  TRA     s:19636
         9 003405   003420 710000 9                  TRA     s:19636
         9 003406   003420 710000 9                  TRA     s:19636
         9 003407   003410 710000 9                  TRA     s:19631

     1602    19630    6                       CASE(%PC_ALLOPT);

     1603    19631    6                          RU_PARAMS = '777777777777'O;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:226  
  19631  9 003410   000027 236000 xsym               LDQ     B_VECTNIL+23
         9 003411   001741 756000 1                  STQ     RU_PARAMS
         9 003412   003425 710000 9                  TRA     s:19638

     1604    19632    6                       CASE(%PC_PSEUD);

     1605    19633    6                          RU_PARAMS(%PC_PSEUD) = YES;

  19633  9 003413   004000 236003                    LDQ     2048,DU
         9 003414   001741 256000 1                  ORSQ    RU_PARAMS

     1606    19634    6                          RU_PARAMS(%PC_PSEUDO_NUM) = YES;

  19634  9 003415   002000 236003                    LDQ     1024,DU
         9 003416   001741 256000 1                  ORSQ    RU_PARAMS
         9 003417   003425 710000 9                  TRA     s:19638

     1607    19635    6                       CASE(ELSE);

     1608    19636    6                         RU_PARAMS(BLK$->O$BLK.SUBLK$(J)->O$BLK.SUBLK$(0)->O$BLK.CODE)
             19636                                   = YES;

  19636  9 003420   300000 236100                    LDQ     0,,PR3
         9 003421   777777 376007                    ANQ     -1,DL
         9 003422   003006 060400                    CSL     bolr='003'O
         9 003423   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 003424   001741 000001 1                  BDSC    RU_PARAMS,Q              by=0,bit=0,n=1

     1609    19637    6                       END;  /* CASE */

     1610    19638    5                    END;  /* DO J */

  19638  9 003425   000026 054000 1                  AOS     J
         9 003426   000015 470400 1                  LDP0    BLK$
         9 003427   000001 236100                    LDQ     1,,PR0
         9 003430   000022 772000                    QRL     18
         9 003431   000026 116000 1                  CMPQ    J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:227  
         9 003432   003236 605400 9                  TPNZ    s:19629

     1611    19639    4                 CALL X$WRITE(FDS,VECTOR(RU_FMT),HEAD_FID.TEXTFID_);

  19639  9 003433   000064 630400 10                 EPPR0   52
         9 003434   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003435   000000 701000 xent               TSX1    X$WRITE
         9 003436   000000 011000                    NOP     0

     1612    19640    4                 DCB_WIDTH = DCBADDR(DCBNUM(M$LO))->F$DCB.WIDTH#;

  19640  9 003437   000000 236007 xsym               LDQ     M$LO,DL
         9 003440   000000 470400 10                 LDP0    0
         9 003441   000000 471500                    LDP1    0,,PR0
         9 003442   100000 473506                    LDP3    0,QL,PR1
         9 003443   300004 236100                    LDQ     4,,PR3
         9 003444   000777 376007                    ANQ     511,DL
         9 003445   200052 756100                    STQ     DCB_WIDTH,,AUTO

     1613    19641    4                 IF DCB_WIDTH = 0 THEN DCB_WIDTH = 80;

  19641  9 003446   003451 601000 9                  TNZ     s:19642

  19641  9 003447   000120 235007                    LDA     80,DL
         9 003450   200052 755100                    STA     DCB_WIDTH,,AUTO

     1614    19642    4                 RUBUF.COUNT = 0;

  19642  9 003451   000000 236003                    LDQ     0,DU
         9 003452   001742 552040 1                  STBQ    RUBUF,'40'O

     1615    19643    4                 RUBUF.TEXT = ' ';

  19643  9 003453   040000 100400                    MLR     fill='040'O
         9 003454   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003455   001742 200204 1                  ADSC9   RUBUF                    cn=1,n=132

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:228  
     1616    19644    5                 DO J = 1 TO %PC_NUMRUFLAGS;

  19644  9 003456   000001 235007                    LDA     1,DL
         9 003457   000026 755000 1                  STA     J

     1617    19645    5                    TEMPLEN = 0;

  19645  9 003460   200053 450100                    STZ     TEMPLEN,,AUTO

     1618    19646    5                    TEMPBUF = ' ';

  19646  9 003461   040100 100400                    MLR     fill='040'O
         9 003462   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003463   200040 000040                    ADSC9   TEMPBUF,,AUTO            cn=0,n=32

     1619    19647    6                    IF RU_PARAMS(J) THEN DO;

  19647  9 003464   000026 235000 1                  LDA     J
         9 003465   003467 605000 9                  TPL     s:19647+3
         9 003466   000044 035003                    ADLA    36,DU
         9 003467   000000 066405                    CMPB    filb='1'B
         9 003470   001741 000001 1                  BDSC    RU_PARAMS,A              by=0,bit=0,n=1
         9 003471   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 003472   004000 600000 9                  TZE     s:19729

     1620    19648    6                       TEMPLEN = TEMPLEN + RUPARAM_TBL.COUNT(J);

  19648  9 003473   000026 235000 1                  LDA     J
         9 003474   000002 735000                    ALS     2
         9 003475   002004 236005 1                  LDQ     RUPARAM_TBL,AL
         9 003476   000033 772000                    QRL     27
         9 003477   200053 036100                    ADLQ    TEMPLEN,,AUTO
         9 003500   200053 756100                    STQ     TEMPLEN,,AUTO

     1621    19649    6                       CALL INSERT(TEMPBUF,0,TEMPLEN,RUPARAM_TBL.TEXT(J));

  19649  9 003501   000026 235000 1                  LDA     J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:229  
         9 003502   000004 735000                    ALS     4
         9 003503   000000 620006                    EAX0    0,QL
         9 003504   040140 100405                    MLR     fill='040'O
         9 003505   002004 200014 1                  ADSC9   RUPARAM_TBL,A            cn=1,n=12
         9 003506   200040 000010                    ADSC9   TEMPBUF,,AUTO            cn=0,n=*X0

     1622    19650    7                       DO CASE(J);

  19650  9 003507   000026 236000 1                  LDQ     J
         9 003510   000011 116007                    CMPQ    9,DL
         9 003511   003513 602006 9                  TNC     s:19650+4,QL
         9 003512   003741 710000 9                  TRA     s:19720
         9 003513   003741 710000 9                  TRA     s:19720
         9 003514   003524 710000 9                  TRA     s:19652
         9 003515   003545 710000 9                  TRA     s:19661
         9 003516   003566 710000 9                  TRA     s:19670
         9 003517   003607 710000 9                  TRA     s:19679
         9 003520   003630 710000 9                  TRA     s:19688
         9 003521   003664 710000 9                  TRA     s:19702
         9 003522   003707 710000 9                  TRA     s:19712
         9 003523   003651 710000 9                  TRA     s:19697

     1623    19651    7                          CASE(%PC_NOCHGPMEM);

     1624    19652    8                             IF B$HEAD.NOCHGPMEM THEN DO;

  19652  9 003524   002364 236000 1                  LDQ     B$HEAD+18
         9 003525   000002 316003                    CANQ    2,DU
         9 003526   003536 600000 9                  TZE     s:19657

     1625    19653    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');

  19653  9 003527   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003530   040105 100400                    MLR     fill='040'O
         9 003531   000067 000003 2                  ADSC9   DUMP_LOCK_FMT+14         cn=0,n=3
         9 003532   200040 000003                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=3

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:230  
     1626    19654    8                                TEMPLEN = TEMPLEN + 3;

  19654  9 003533   000003 236007                    LDQ     3,DL
         9 003534   200053 056100                    ASQ     TEMPLEN,,AUTO

     1627    19655    8                                END;

  19655  9 003535   003741 710000 9                  TRA     s:19720

     1628    19656    8                             ELSE DO;

     1629    19657    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');

  19657  9 003536   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003537   040105 100400                    MLR     fill='040'O
         9 003540   000070 000002 2                  ADSC9   DUMP_LOCK_FMT+15         cn=0,n=2
         9 003541   200040 000002                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=2

     1630    19658    8                                TEMPLEN = TEMPLEN + 2;

  19658  9 003542   000002 236007                    LDQ     2,DL
         9 003543   200053 056100                    ASQ     TEMPLEN,,AUTO

     1631    19659    8                                END;

  19659  9 003544   003741 710000 9                  TRA     s:19720

     1632    19660    7                          CASE(%PC_SHARE);

     1633    19661    8                             IF B$HEAD.S THEN DO;

  19661  9 003545   002364 236000 1                  LDQ     B$HEAD+18
         9 003546   000400 316003                    CANQ    256,DU
         9 003547   003557 600000 9                  TZE     s:19666

     1634    19662    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:231  
  19662  9 003550   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003551   040105 100400                    MLR     fill='040'O
         9 003552   000067 000003 2                  ADSC9   DUMP_LOCK_FMT+14         cn=0,n=3
         9 003553   200040 000003                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=3

     1635    19663    8                                TEMPLEN = TEMPLEN + 3;

  19663  9 003554   000003 236007                    LDQ     3,DL
         9 003555   200053 056100                    ASQ     TEMPLEN,,AUTO

     1636    19664    8                                END;

  19664  9 003556   003741 710000 9                  TRA     s:19720

     1637    19665    8                             ELSE DO;

     1638    19666    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');

  19666  9 003557   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003560   040105 100400                    MLR     fill='040'O
         9 003561   000070 000002 2                  ADSC9   DUMP_LOCK_FMT+15         cn=0,n=2
         9 003562   200040 000002                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=2

     1639    19667    8                                TEMPLEN = TEMPLEN + 2;

  19667  9 003563   000002 236007                    LDQ     2,DL
         9 003564   200053 056100                    ASQ     TEMPLEN,,AUTO

     1640    19668    8                                END;

  19668  9 003565   003741 710000 9                  TRA     s:19720

     1641    19669    7                          CASE(%PC_PROCACC);

     1642    19670    8                             IF B$HEAD.PROCACC THEN DO;

  19670  9 003566   002364 236000 1                  LDQ     B$HEAD+18
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:232  
         9 003567   000004 316003                    CANQ    4,DU
         9 003570   003600 600000 9                  TZE     s:19675

     1643    19671    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');

  19671  9 003571   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003572   040105 100400                    MLR     fill='040'O
         9 003573   000067 000003 2                  ADSC9   DUMP_LOCK_FMT+14         cn=0,n=3
         9 003574   200040 000003                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=3

     1644    19672    8                                TEMPLEN = TEMPLEN + 3;

  19672  9 003575   000003 236007                    LDQ     3,DL
         9 003576   200053 056100                    ASQ     TEMPLEN,,AUTO

     1645    19673    8                                END;

  19673  9 003577   003741 710000 9                  TRA     s:19720

     1646    19674    8                             ELSE DO;

     1647    19675    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');

  19675  9 003600   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003601   040105 100400                    MLR     fill='040'O
         9 003602   000070 000002 2                  ADSC9   DUMP_LOCK_FMT+15         cn=0,n=2
         9 003603   200040 000002                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=2

     1648    19676    8                                TEMPLEN = TEMPLEN + 2;

  19676  9 003604   000002 236007                    LDQ     2,DL
         9 003605   200053 056100                    ASQ     TEMPLEN,,AUTO

     1649    19677    8                                END;

  19677  9 003606   003741 710000 9                  TRA     s:19720

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:233  
     1650    19678    7                          CASE(%PC_PROCSURCHG);

     1651    19679    8                             IF B$HEAD.PROCSURCHG THEN DO;

  19679  9 003607   002364 236000 1                  LDQ     B$HEAD+18
         9 003610   000001 316003                    CANQ    1,DU
         9 003611   003621 600000 9                  TZE     s:19684

     1652    19680    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');

  19680  9 003612   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003613   040105 100400                    MLR     fill='040'O
         9 003614   000067 000003 2                  ADSC9   DUMP_LOCK_FMT+14         cn=0,n=3
         9 003615   200040 000003                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=3

     1653    19681    8                                TEMPLEN = TEMPLEN + 3;

  19681  9 003616   000003 236007                    LDQ     3,DL
         9 003617   200053 056100                    ASQ     TEMPLEN,,AUTO

     1654    19682    8                                END;

  19682  9 003620   003741 710000 9                  TRA     s:19720

     1655    19683    8                             ELSE DO;

     1656    19684    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');

  19684  9 003621   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003622   040105 100400                    MLR     fill='040'O
         9 003623   000070 000002 2                  ADSC9   DUMP_LOCK_FMT+15         cn=0,n=2
         9 003624   200040 000002                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=2

     1657    19685    8                                TEMPLEN = TEMPLEN + 2;

  19685  9 003625   000002 236007                    LDQ     2,DL
         9 003626   200053 056100                    ASQ     TEMPLEN,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:234  

     1658    19686    8                                END;

  19686  9 003627   003741 710000 9                  TRA     s:19720

     1659    19687    7                          CASE(%PC_STATS);

     1660    19688    8                             IF B$HEAD.STATS THEN DO;

  19688  9 003630   002353 236000 1                  LDQ     B$HEAD+9
         9 003631   000010 316007                    CANQ    8,DL
         9 003632   003642 600000 9                  TZE     s:19693

     1661    19689    8                                CALL INSERT(TEMPBUF,TEMPLEN,3,'YES');

  19689  9 003633   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003634   040105 100400                    MLR     fill='040'O
         9 003635   000067 000003 2                  ADSC9   DUMP_LOCK_FMT+14         cn=0,n=3
         9 003636   200040 000003                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=3

     1662    19690    8                                TEMPLEN = TEMPLEN + 3;

  19690  9 003637   000003 236007                    LDQ     3,DL
         9 003640   200053 056100                    ASQ     TEMPLEN,,AUTO

     1663    19691    8                                END;

  19691  9 003641   003741 710000 9                  TRA     s:19720

     1664    19692    8                             ELSE DO;

     1665    19693    8                                CALL INSERT(TEMPBUF,TEMPLEN,2,'NO');

  19693  9 003642   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003643   040105 100400                    MLR     fill='040'O
         9 003644   000070 000002 2                  ADSC9   DUMP_LOCK_FMT+15         cn=0,n=2
         9 003645   200040 000002                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=2
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:235  

     1666    19694    8                                TEMPLEN = TEMPLEN + 2;

  19694  9 003646   000002 236007                    LDQ     2,DL
         9 003647   200053 056100                    ASQ     TEMPLEN,,AUTO

     1667    19695    8                                END;

  19695  9 003650   003741 710000 9                  TRA     s:19720

     1668    19696    7                          CASE(%PC_LOCK);

     1669    19697    7                             IF B$HEAD.STRONG_LOCK

  19697  9 003651   002364 236000 1                  LDQ     B$HEAD+18
         9 003652   200000 316007                    CANQ    65536,DL
         9 003653   003657 600000 9                  TZE     s:19699

     1670    19698    7                                THEN CALL INSERT(TEMPBUF,0,1,'S');

  19698  9 003654   123000 236003                    LDQ     42496,DU
         9 003655   200040 552140                    STBQ    TEMPBUF,'40'O,AUTO
         9 003656   003661 710000 9                  TRA     s:19700

     1671    19699    7                                ELSE CALL INSERT(TEMPBUF,0,1,'W');

  19699  9 003657   127000 236003                    LDQ     44544,DU
         9 003660   200040 552140                    STBQ    TEMPBUF,'40'O,AUTO

     1672    19700    7                             TEMPLEN = TEMPLEN + 25;

  19700  9 003661   000031 236007                    LDQ     25,DL
         9 003662   200053 056100                    ASQ     TEMPLEN,,AUTO
         9 003663   003741 710000 9                  TRA     s:19720

     1673    19701    7                          CASE(%PC_PSEUD);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:236  
     1674    19702    8                             IF B$HEAD.PSEUDO_COUNT > 0 THEN DO;

  19702  9 003664   002365 236000 1                  LDQ     B$HEAD+19
         9 003665   777000 316003                    CANQ    -512,DU
         9 003666   003676 600000 9                  TZE     s:19707

     1675    19703    8                                CALL INSERT(TEMPBUF,TEMPLEN,8,B$HEAD.PSEUDO_TEXT);

  19703  9 003667   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003670   040105 100400                    MLR     fill='040'O
         9 003671   002366 000010 1                  ADSC9   B$HEAD+20                cn=0,n=8
         9 003672   200040 000010                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=8

     1676    19704    8                                TEMPLEN = TEMPLEN + 8;

  19704  9 003673   000010 236007                    LDQ     8,DL
         9 003674   200053 056100                    ASQ     TEMPLEN,,AUTO

     1677    19705    8                                END;  /* IF PSEUDO_COUNT > 0 */

  19705  9 003675   003741 710000 9                  TRA     s:19720

     1678    19706    8                             ELSE DO;

     1679    19707    8                                CALL INSERT(TEMPBUF,TEMPLEN,SIZEC('None defined'),
             19707                                         'None defined');

  19707  9 003676   200053 235100                    LDA     TEMPLEN,,AUTO
         9 003677   040105 100400                    MLR     fill='040'O
         9 003700   000071 000014 2                  ADSC9   DUMP_LOCK_FMT+16         cn=0,n=12
         9 003701   200040 000014                    ADSC9   TEMPBUF,A,AUTO           cn=0,n=12

     1680    19708    8                                TEMPLEN = TEMPLEN + SIZEC('None defined');

  19708  9 003702   000014 236007                    LDQ     12,DL
         9 003703   200053 056100                    ASQ     TEMPLEN,,AUTO

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:237  
     1681    19709    8                                RU_PARAMS(%PC_PSEUDO_NUM) = NO;

  19709  9 003704   000061 236000 10                 LDQ     49
         9 003705   001741 356000 1                  ANSQ    RU_PARAMS

     1682    19710    8                                END;  /* ELSE */

  19710  9 003706   003741 710000 9                  TRA     s:19720

     1683    19711    7                          CASE(%PC_PSEUDO_NUM);

     1684    19712    7                             CALL BINCHAR(TEMPNAME,B$HEAD.PSEUDO_COUNT);

  19712  9 003707   002365 236000 1                  LDQ     B$HEAD+19
         9 003710   000033 772000                    QRL     27
         9 003711   000000 235003                    LDA     0,DU
         9 003712   200076 757100                    STAQ    TEMPTEXT+4,,AUTO
         9 003713   000100 301500                    BTD
         9 003714   200076 000010                    NDSC9   TEMPTEXT+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 003715   200050 030010                    NDSC9   TEMPNAME,,AUTO           cn=0,s=nosgn,sf=0,n=8

     1685    19713    7                             K = 0;

  19713  9 003716   000027 450000 1                  STZ     K

     1686    19714    8                             DO WHILE(SUBSTR(TEMPNAME,K,1) = '0' AND K < 8);

  19714  9 003717   003721 710000 9                  TRA     s:19716

     1687    19715    8                                K = K + 1;

  19715  9 003720   000027 054000 1                  AOS     K

     1688    19716    8                                END;  /* DO WHILE */

  19716  9 003721   000027 235000 1                  LDA     K
         9 003722   040000 106505                    CMPC    fill='040'O
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:238  
         9 003723   200050 000001                    ADSC9   TEMPNAME,A,AUTO          cn=0,n=1
         9 003724   000067 000001 10                 ADSC9   55                       cn=0,n=1
         9 003725   003730 601000 9                  TNZ     s:19717
         9 003726   000010 115007                    CMPA    8,DL
         9 003727   003720 604000 9                  TMI     s:19715

     1689    19717    7                             CALL INSERT(TEMPBUF,TEMPLEN,8-K,SUBSTR(TEMPNAME,K));

  19717  9 003730   777767 620005                    EAX0    -9,AL
         9 003731   777777 660003                    ERX0    -1,DU
         9 003732   200053 236100                    LDQ     TEMPLEN,,AUTO
         9 003733   040146 100545                    MLR     fill='040'O
         9 003734   200050 000010                    ADSC9   TEMPNAME,A,AUTO          cn=0,n=*X0
         9 003735   200040 000010                    ADSC9   TEMPBUF,Q,AUTO           cn=0,n=*X0

     1690    19718    7                             TEMPLEN = TEMPLEN + 8 - K;

  19718  9 003736   000027 136000 1                  SBLQ    K
         9 003737   000010 036007                    ADLQ    8,DL
         9 003740   200053 756100                    STQ     TEMPLEN,,AUTO

     1691    19719    7                          END;  /* DO CASE(J) */

     1692    19720    7                       IF TEMPLEN + RUBUF.COUNT > DCB_WIDTH THEN DO;

  19720  9 003741   001742 236000 1                  LDQ     RUBUF
         9 003742   000033 772000                    QRL     27
         9 003743   200053 036100                    ADLQ    TEMPLEN,,AUTO
         9 003744   200052 116100                    CMPQ    DCB_WIDTH,,AUTO
         9 003745   003757 604400 9                  TMOZ    s:19725

     1693    19721    7                          CALL X$WRITE(FDS,DUMP_BUF,VECTOR(RUBUF));

  19721  9 003746   000072 630400 10                 EPPR0   58
         9 003747   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 003750   000000 701000 xent               TSX1    X$WRITE
         9 003751   000000 011000                    NOP     0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:239  

     1694    19722    7                          RUBUF.TEXT = ' ';

  19722  9 003752   040000 100400                    MLR     fill='040'O
         9 003753   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 003754   001742 200204 1                  ADSC9   RUBUF                    cn=1,n=132

     1695    19723    7                          RUBUF.COUNT = 0;

  19723  9 003755   000000 236003                    LDQ     0,DU
         9 003756   001742 552040 1                  STBQ    RUBUF,'40'O

     1696    19724    7                          END;  /* IF */

     1697    19725    6                       IF J = %PC_LOCK THEN TEMPLEN = TEMPLEN - 25;

  19725  9 003757   000026 235000 1                  LDA     J
         9 003760   000010 115007                    CMPA    8,DL
         9 003761   003764 601000 9                  TNZ     s:19726

  19725  9 003762   000031 336007                    LCQ     25,DL
         9 003763   200053 056100                    ASQ     TEMPLEN,,AUTO

     1698    19726    6                       CALL INSERT(RUBUF.TEXT,RUBUF.COUNT,TEMPLEN,TEMPBUF);

  19726  9 003764   001742 236000 1                  LDQ     RUBUF
         9 003765   000033 772000                    QRL     27
         9 003766   200053 720100                    LXL0    TEMPLEN,,AUTO
         9 003767   040046 100500                    MLR     fill='040'O
         9 003770   200040 000040                    ADSC9   TEMPBUF,,AUTO            cn=0,n=32
         9 003771   001742 200010 1                  ADSC9   RUBUF,Q                  cn=1,n=*X0

     1699    19727    6                       RUBUF.COUNT = RUBUF.COUNT + TEMPLEN + 1;

  19727  9 003772   001742 236000 1                  LDQ     RUBUF
         9 003773   000033 772000                    QRL     27
         9 003774   200053 036100                    ADLQ    TEMPLEN,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:240  
         9 003775   000001 036007                    ADLQ    1,DL
         9 003776   000033 736000                    QLS     27
         9 003777   001742 552040 1                  STBQ    RUBUF,'40'O

     1700    19728    6                       END;  /* IF RU_PARAMS(J) */

     1701    19729    6                    IF J = %PC_NUMRUFLAGS THEN DO;

  19729  9 004000   000026 235000 1                  LDA     J
         9 004001   000010 115007                    CMPA    8,DL
         9 004002   004016 601000 9                  TNZ     s:19734

     1702    19730    6                       IF RU_PARAMS(%PC_LOCK)

  19730  9 004003   001741 430000 1                  FSZN    RU_PARAMS
         9 004004   004012 605000 9                  TPL     s:19732

     1703    19731    6                          THEN CALL X$WRITE(FDS,DUMP_LOCK,VECTOR(RUBUF),VECTOR(B$HEAD.
             19731                                   LOCK));

  19731  9 004005   000100 630400 10                 EPPR0   64
         9 004006   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 004007   000000 701000 xent               TSX1    X$WRITE
         9 004010   000000 011000                    NOP     0
         9 004011   004016 710000 9                  TRA     s:19734

     1704    19732    6                          ELSE CALL X$WRITE(FDS,DUMP_BUF,VECTOR(RUBUF));

  19732  9 004012   000072 630400 10                 EPPR0   58
         9 004013   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 004014   000000 701000 xent               TSX1    X$WRITE
         9 004015   000000 011000                    NOP     0

     1705    19733    6                       END;  /* IF J = %PC_LOCK */

     1706    19734    5                    END;  /* DO J */

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:241  
  19734  9 004016   000026 054000 1                  AOS     J
         9 004017   000026 235000 1                  LDA     J
         9 004020   000010 115007                    CMPA    8,DL
         9 004021   003460 604400 9                  TMOZ    s:19645

     1707    19735    5                 DO WHILE('0'B);  /* DO NEVER */

  19735  9 004022   004027 710000 9                  TRA     s:19738

     1708    19736    5        BAD_FID:    CALL PCE$ERROR(0,3);

  19736  9 004023   000033 630400 10    BAD_FID      EPPR0   27
         9 004024   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004025   000000 701000 xent               TSX1    PCE$ERROR
         9 004026   000000 011000                    NOP     0

     1709    19737    5                    END;  /* DO NEVER */

     1710    19738    5                 DO WHILE('0'B);  /* DO NEVER */

  19738  9 004027   004040 710000 9                  TRA     s:19745

     1711    19739    5        BAD_FILE:   CALL PCE$ERROR(0,3);

  19739  9 004030   000033 630400 10    BAD_FILE     EPPR0   27
         9 004031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004032   000000 701000 xent               TSX1    PCE$ERROR
         9 004033   000000 011000                    NOP     0

     1712    19740    5                    CALL PCE$ERROR(%E$P_CANTDIRU,3);

  19740  9 004034   000105 630400 10                 EPPR0   69
         9 004035   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004036   000000 701000 xent               TSX1    PCE$ERROR
         9 004037   000000 011000                    NOP     0

     1713    19741    5                    END;  /* DO NEVER */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:242  

     1714    19742        /*E* ERROR: PCC-E$P_CANTDIRU-0
     1715    19743             MESSAGE: Unable to display rununit parameters requested.
     1716    19744             DESCRIPTION: CANT GET AT THE FILE TO DISPLAY THE FLAGS */
     1717    19745    4                 IF DCBADDR(DCBNUM(M$HEAD))->F$DCB.FCD#

  19745  9 004040   000000 236007 xsym               LDQ     M$HEAD,DL
         9 004041   000000 470400 10                 LDP0    0
         9 004042   000000 471500                    LDP1    0,,PR0
         9 004043   100000 473506                    LDP3    0,QL,PR1
         9 004044   300031 236100                    LDQ     25,,PR3
         9 004045   020000 316007                    CANQ    8192,DL
         9 004046   004053 600000 9                  TZE     s:19747

     1718    19746    4                    THEN CALL M$CLOSE(CLOSE_RU) ALTRET(BAD_CLOSE);

  19746  9 004047   011176 630400 1                  EPPR0   CLOSE_RU
         9 004050   450001 713400                    CLIMB   alt,close
         9 004051   406000 401760                    pmme    nvectors=13
         9 004052   004054 702000 9                  TSX2    BAD_CLOSE

     1719    19747    5                 DO WHILE('0'B);  /* DO NEVER */

  19747  9 004053   004474 710000 9                  TRA     s:19837

     1720    19748    5        BAD_CLOSE:  CALL PCE$ERROR(0,3);

  19748  9 004054   000033 630400 10    BAD_CLOSE    EPPR0   27
         9 004055   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004056   000000 701000 xent               TSX1    PCE$ERROR
         9 004057   000000 011000                    NOP     0

     1721    19749    5                    END;  /* DO NEVER */

  19749  9 004060   004474 710000 9                  TRA     s:19837

     1722    19750    4               CASE(%PC_PDT);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:243  

     1723    19751    4                 TEMP1 = 0;                /* DISP_TBL INDEX                     */

  19751  9 004061   000023 450000 1                  STZ     TEMP1

     1724    19752    5                 DO K = 1 TO %PC_PARTITIONHI; /* DO ALL PARAMETERS                */

  19752  9 004062   000001 235007                    LDA     1,DL
         9 004063   000027 755000 1                  STA     K

     1725    19753    6                    DO TEMP2 = 0 TO 15;    /* DO ALL PARTITIONS                  */

  19753  9 004064   000024 450000 1                  STZ     TEMP2

     1726    19754    6                       DISP_TBL.PARM(TEMP1) = NO;

  19754  9 004065   000023 235000 1                  LDA     TEMP1
         9 004066   000001 735000                    ALS     1
         9 004067   000231 450005 1                  STZ     DISP_TBL+1,AL
         9 004070   000232 450005 1                  STZ     DISP_TBL+2,AL

     1727    19755    6                       DISP_TBL.PARM.RESINDX(TEMP1) = -1;

  19755  9 004071   000023 235000 1                  LDA     TEMP1
         9 004072   000001 735000                    ALS     1
         9 004073   777777 220003                    LDX0    -1,DU
         9 004074   000232 740005 1                  STX0    DISP_TBL+2,AL

     1728    19756    6                       SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*TEMP2);

  19756  9 004075   000024 236000 1                  LDQ     TEMP2
         9 004076   000023 402003                    MPY     19,DU
         9 004077   001703 036000 1                  ADLQ    PDTFLAG$
         9 004100   001705 756000 1                  STQ     SET_PDTFLAG$

     1729    19757    7                       DO CASE(K);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:244  
  19757  9 004101   000027 235000 1                  LDA     K
         9 004102   000012 115007                    CMPA    10,DL
         9 004103   004105 602005 9                  TNC     s:19757+4,AL
         9 004104   004426 710000 9                  TRA     s:19822
         9 004105   004426 710000 9                  TRA     s:19822
         9 004106   004117 710000 9                  TRA     s:19760
         9 004107   004131 710000 9                  TRA     s:19764
         9 004110   004143 710000 9                  TRA     s:19768
         9 004111   004242 710000 9                  TRA     s:19785
         9 004112   004341 710000 9                  TRA     s:19802
         9 004113   004354 710000 9                  TRA     s:19806
         9 004114   004366 710000 9                  TRA     s:19810
         9 004115   004401 710000 9                  TRA     s:19814
         9 004116   004414 710000 9                  TRA     s:19818

     1730    19758        /**/
     1731    19759    7                        CASE (%PC_PMINTI);

     1732    19760    7                          IF (SET_PDTFLAG$ -> JM$PT.TL ~= 0) THEN

  19760  9 004117   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004120   000000 235100                    LDA     0,,PR0
         9 004121   004426 600000 9                  TZE     s:19822

     1733    19761    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PMINTI;

  19761  9 004122   000023 235000 1                  LDA     TEMP1
         9 004123   000001 735000                    ALS     1
         9 004124   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004125   000107 376000 10                 ANQ     71
         9 004126   000001 276003                    ORQ     1,DU
         9 004127   000231 756005 1                  STQ     DISP_TBL+1,AL
         9 004130   004426 710000 9                  TRA     s:19822

     1734    19762        /**/
     1735    19763    7                        CASE (%PC_PMAXTI);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:245  
     1736    19764    7                          IF (SET_PDTFLAG$ -> JM$PT.TU ~= 0) THEN

  19764  9 004131   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004132   000001 235100                    LDA     1,,PR0
         9 004133   004426 600000 9                  TZE     s:19822

     1737    19765    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PMAXTI;

  19765  9 004134   000023 235000 1                  LDA     TEMP1
         9 004135   000001 735000                    ALS     1
         9 004136   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004137   000107 376000 10                 ANQ     71
         9 004140   000002 276003                    ORQ     2,DU
         9 004141   000231 756005 1                  STQ     DISP_TBL+1,AL
         9 004142   004426 710000 9                  TRA     s:19822

     1738    19766        /**/
     1739    19767    7                        CASE (%PC_PMINRES);

     1740    19768    8                          DO VALUE = 0 TO NUM_PSURES + %PSURES_OFFSET - 1;

  19768  9 004143   001712 450000 1                  STZ     VALUE
         9 004144   004234 710000 9                  TRA     s:19782+1

     1741    19769    8                             BITVAL = YES;

  19769  9 004145   400000 236003                    LDQ     -131072,DU
         9 004146   000033 756000 1                  STQ     BITVAL

     1742    19770    9                             IF (SET_PDTFLAG$ -> JM$PT.RMIN(VALUE) ~= 0) THEN DO;

  19770  9 004147   001712 235000 1                  LDA     VALUE
         9 004150   000001 735000                    ALS     1
         9 004151   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004152   000100 101505                    MRL     fill='000'O
         9 004153   000015 000002                    ADSC9   13,A,PR0                 cn=0,n=2
         9 004154   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:246  
         9 004155   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 004156   000000 116003                    CMPQ    0,DU
         9 004157   004233 600000 9                  TZE     s:19782

     1743    19771   10                                IF (~BITVAL) THEN DO;

  19771  9 004160   000033 236000 1                  LDQ     BITVAL
         9 004161   400000 376003                    ANQ     -131072,DU
         9 004162   400000 676003                    ERQ     -131072,DU
         9 004163   004220 600000 9                  TZE     s:19778

     1744    19772   10                                   DISP_TBL.PARM(TEMP1+1) = DISP_TBL.PARM(TEMP1);

  19772  9 004164   000023 236000 1                  LDQ     TEMP1
         9 004165   000001 736000                    QLS     1
         9 004166   000023 235000 1                  LDA     TEMP1
         9 004167   000003 735000                    ALS     3
         9 004170   000002 736000                    QLS     2
         9 004171   000006 100405                    MLR     fill='000'O
         9 004172   000231 000006 1                  ADSC9   DISP_TBL+1,A             cn=0,n=6
         9 004173   000233 000006 1                  ADSC9   DISP_TBL+3,Q             cn=0,n=6

     1745    19773   10                                   DISP_TBL.PARM.CAT(TEMP1) = %PC_PDTCAT;

  19773  9 004174   000023 235000 1                  LDA     TEMP1
         9 004175   000001 735000                    ALS     1
         9 004176   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004177   000032 376000 xsym               ANQ     B_VECTNIL+26
         9 004200   007000 276003                    ORQ     3584,DU
         9 004201   000231 756005 1                  STQ     DISP_TBL+1,AL

     1746    19774   10                                   DISP_TBL.PARM.INDEXLO(TEMP1) = TEMP2;

  19774  9 004202   000023 235000 1                  LDA     TEMP1
         9 004203   000001 735000                    ALS     1
         9 004204   000024 236000 1                  LDQ     TEMP2
         9 004205   000011 736000                    QLS     9
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:247  
         9 004206   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 004207   777000 376007                    ANQ     -512,DL
         9 004210   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1747    19775   10                                   DISP_TBL.PARM.INDEXHI(TEMP1) = TEMP2;

  19775  9 004211   000023 235000 1                  LDA     TEMP1
         9 004212   000001 735000                    ALS     1
         9 004213   000024 236000 1                  LDQ     TEMP2
         9 004214   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 004215   000777 376007                    ANQ     511,DL
         9 004216   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1748    19776   10                                   TEMP1 = TEMP1 + 1;

  19776  9 004217   000023 054000 1                  AOS     TEMP1

     1749    19777   10                                   END;

     1750    19778    9                                BITVAL = NO;

  19778  9 004220   000033 450000 1                  STZ     BITVAL

     1751    19779    9                                DISP_TBL.PARM.PARM(TEMP1) = %PC_PMINRES;

  19779  9 004221   000023 235000 1                  LDA     TEMP1
         9 004222   000001 735000                    ALS     1
         9 004223   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004224   000107 376000 10                 ANQ     71
         9 004225   000003 276003                    ORQ     3,DU
         9 004226   000231 756005 1                  STQ     DISP_TBL+1,AL

     1752    19780    9                                DISP_TBL.PARM.RESINDX(TEMP1) = VALUE;

  19780  9 004227   000023 235000 1                  LDA     TEMP1
         9 004230   000001 735000                    ALS     1
         9 004231   001712 720000 1                  LXL0    VALUE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:248  
         9 004232   000232 740005 1                  STX0    DISP_TBL+2,AL

     1753    19781    9                                END;

     1754    19782    8                             END;

  19782  9 004233   001712 054000 1                  AOS     VALUE
         9 004234   000012 236000 1                  LDQ     NUM_PSURES
         9 004235   000003 036007                    ADLQ    3,DL
         9 004236   004145 604000 9                  TMI     s:19769
         9 004237   001712 116000 1                  CMPQ    VALUE
         9 004240   004145 605000 9                  TPL     s:19769
         9 004241   004426 710000 9                  TRA     s:19822

     1755    19783        /**/
     1756    19784    7                        CASE (%PC_PMAXRES);

     1757    19785    8                          DO VALUE = 0 TO NUM_PSURES + %PSURES_OFFSET - 1;

  19785  9 004242   001712 450000 1                  STZ     VALUE
         9 004243   004333 710000 9                  TRA     s:19799+1

     1758    19786    8                             BITVAL = YES;

  19786  9 004244   400000 236003                    LDQ     -131072,DU
         9 004245   000033 756000 1                  STQ     BITVAL

     1759    19787    9                             IF (SET_PDTFLAG$ -> JM$PT.RMAX(VALUE) ~= 0) THEN DO;

  19787  9 004246   001712 235000 1                  LDA     VALUE
         9 004247   000001 735000                    ALS     1
         9 004250   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004251   000100 101505                    MRL     fill='000'O
         9 004252   000007 000002                    ADSC9   7,A,PR0                  cn=0,n=2
         9 004253   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 004254   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 004255   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:249  
         9 004256   004332 600000 9                  TZE     s:19799

     1760    19788   10                                IF (~BITVAL) THEN DO;

  19788  9 004257   000033 236000 1                  LDQ     BITVAL
         9 004260   400000 376003                    ANQ     -131072,DU
         9 004261   400000 676003                    ERQ     -131072,DU
         9 004262   004317 600000 9                  TZE     s:19795

     1761    19789   10                                   DISP_TBL.PARM(TEMP1+1) = DISP_TBL.PARM(TEMP1);

  19789  9 004263   000023 236000 1                  LDQ     TEMP1
         9 004264   000001 736000                    QLS     1
         9 004265   000023 235000 1                  LDA     TEMP1
         9 004266   000003 735000                    ALS     3
         9 004267   000002 736000                    QLS     2
         9 004270   000006 100405                    MLR     fill='000'O
         9 004271   000231 000006 1                  ADSC9   DISP_TBL+1,A             cn=0,n=6
         9 004272   000233 000006 1                  ADSC9   DISP_TBL+3,Q             cn=0,n=6

     1762    19790   10                                   DISP_TBL.PARM.CAT(TEMP1) = %PC_PDTCAT;

  19790  9 004273   000023 235000 1                  LDA     TEMP1
         9 004274   000001 735000                    ALS     1
         9 004275   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004276   000032 376000 xsym               ANQ     B_VECTNIL+26
         9 004277   007000 276003                    ORQ     3584,DU
         9 004300   000231 756005 1                  STQ     DISP_TBL+1,AL

     1763    19791   10                                   DISP_TBL.PARM.INDEXLO(TEMP1) = TEMP2;

  19791  9 004301   000023 235000 1                  LDA     TEMP1
         9 004302   000001 735000                    ALS     1
         9 004303   000024 236000 1                  LDQ     TEMP2
         9 004304   000011 736000                    QLS     9
         9 004305   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 004306   777000 376007                    ANQ     -512,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:250  
         9 004307   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1764    19792   10                                   DISP_TBL.PARM.INDEXHI(TEMP1) = TEMP2;

  19792  9 004310   000023 235000 1                  LDA     TEMP1
         9 004311   000001 735000                    ALS     1
         9 004312   000024 236000 1                  LDQ     TEMP2
         9 004313   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 004314   000777 376007                    ANQ     511,DL
         9 004315   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1765    19793   10                                   TEMP1 = TEMP1 + 1;

  19793  9 004316   000023 054000 1                  AOS     TEMP1

     1766    19794   10                                   END;

     1767    19795    9                                BITVAL = NO;

  19795  9 004317   000033 450000 1                  STZ     BITVAL

     1768    19796    9                                DISP_TBL.PARM.PARM(TEMP1) = %PC_PMAXRES;

  19796  9 004320   000023 235000 1                  LDA     TEMP1
         9 004321   000001 735000                    ALS     1
         9 004322   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004323   000107 376000 10                 ANQ     71
         9 004324   000004 276003                    ORQ     4,DU
         9 004325   000231 756005 1                  STQ     DISP_TBL+1,AL

     1769    19797    9                                DISP_TBL.PARM.RESINDX(TEMP1) = VALUE;

  19797  9 004326   000023 235000 1                  LDA     TEMP1
         9 004327   000001 735000                    ALS     1
         9 004330   001712 720000 1                  LXL0    VALUE
         9 004331   000232 740005 1                  STX0    DISP_TBL+2,AL

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:251  
     1770    19798    9                                END;

     1771    19799    8                             END;

  19799  9 004332   001712 054000 1                  AOS     VALUE
         9 004333   000012 236000 1                  LDQ     NUM_PSURES
         9 004334   000003 036007                    ADLQ    3,DL
         9 004335   004244 604000 9                  TMI     s:19786
         9 004336   001712 116000 1                  CMPQ    VALUE
         9 004337   004244 605000 9                  TPL     s:19786
         9 004340   004426 710000 9                  TRA     s:19822

     1772    19800        /**/
     1773    19801    7                        CASE (%PC_PLOCK);

     1774    19802    7                          IF (SET_PDTFLAG$ -> JM$PT.FLG.LOCK ~= '0'B) THEN

  19802  9 004341   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004342   000004 236100                    LDQ     4,,PR0
         9 004343   000001 316007                    CANQ    1,DL
         9 004344   004426 600000 9                  TZE     s:19822

     1775    19803    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PLOCK;

  19803  9 004345   000023 235000 1                  LDA     TEMP1
         9 004346   000001 735000                    ALS     1
         9 004347   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004350   000107 376000 10                 ANQ     71
         9 004351   000005 276003                    ORQ     5,DU
         9 004352   000231 756005 1                  STQ     DISP_TBL+1,AL
         9 004353   004426 710000 9                  TRA     s:19822

     1776    19804        /**/
     1777    19805    7                        CASE (%PC_PQUAN);

     1778    19806    7                          IF (SET_PDTFLAG$ -> JM$PT.QUAN ~= 0) THEN

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:252  
  19806  9 004354   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004355   000002 235100                    LDA     2,,PR0
         9 004356   004426 600000 9                  TZE     s:19822

     1779    19807    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PQUAN;

  19807  9 004357   000023 235000 1                  LDA     TEMP1
         9 004360   000001 735000                    ALS     1
         9 004361   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004362   000107 376000 10                 ANQ     71
         9 004363   000006 276003                    ORQ     6,DU
         9 004364   000231 756005 1                  STQ     DISP_TBL+1,AL
         9 004365   004426 710000 9                  TRA     s:19822

     1780    19808        /**/
     1781    19809    7                        CASE (%PC_PPRIO);

     1782    19810    7                          IF (SET_PDTFLAG$ -> JM$PT.XPRIO ~= 0) THEN

  19810  9 004366   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004367   000004 236100                    LDQ     4,,PR0
         9 004370   777000 316007                    CANQ    -512,DL
         9 004371   004426 600000 9                  TZE     s:19822

     1783    19811    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PPRIO;

  19811  9 004372   000023 235000 1                  LDA     TEMP1
         9 004373   000001 735000                    ALS     1
         9 004374   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004375   000107 376000 10                 ANQ     71
         9 004376   000007 276003                    ORQ     7,DU
         9 004377   000231 756005 1                  STQ     DISP_TBL+1,AL
         9 004400   004426 710000 9                  TRA     s:19822

     1784    19812        /**/
     1785    19813    7                        CASE (%PC_PMAXACCT);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:253  
     1786    19814    7                          IF (SET_PDTFLAG$ -> JM$PT.MAX1ACCT ~= 0) THEN

  19814  9 004401   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004402   000005 236100                    LDQ     5,,PR0
         9 004403   000777 316007                    CANQ    511,DL
         9 004404   004426 600000 9                  TZE     s:19822

     1787    19815    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PMAXACCT;

  19815  9 004405   000023 235000 1                  LDA     TEMP1
         9 004406   000001 735000                    ALS     1
         9 004407   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004410   000107 376000 10                 ANQ     71
         9 004411   000010 276003                    ORQ     8,DU
         9 004412   000231 756005 1                  STQ     DISP_TBL+1,AL
         9 004413   004426 710000 9                  TRA     s:19822

     1788    19816        /**/
     1789    19817    7                        CASE (%PC_PJMAX);

     1790    19818    7                          IF (SET_PDTFLAG$ -> JM$PT.MAX ~= 0) THEN

  19818  9 004414   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 004415   000003 236100                    LDQ     3,,PR0
         9 004416   777000 316003                    CANQ    -512,DU
         9 004417   004426 600000 9                  TZE     s:19822

     1791    19819    7                             DISP_TBL.PARM.PARM(TEMP1) = %PC_PJMAX;

  19819  9 004420   000023 235000 1                  LDA     TEMP1
         9 004421   000001 735000                    ALS     1
         9 004422   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004423   000107 376000 10                 ANQ     71
         9 004424   000011 276003                    ORQ     9,DU
         9 004425   000231 756005 1                  STQ     DISP_TBL+1,AL

     1792    19820    7                        END;               /* END DO CASE                        */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:254  

     1793    19821        /**/
     1794    19822    7                       IF (DISP_TBL.PARM.PARM(TEMP1) ~= 0) THEN DO;

  19822  9 004426   000023 235000 1                  LDA     TEMP1
         9 004427   000001 735000                    ALS     1
         9 004430   000231 236005 1                  LDQ     DISP_TBL+1,AL
         9 004431   000777 316003                    CANQ    511,DU
         9 004432   004454 600000 9                  TZE     s:19829

     1795    19823    7                          DISP_TBL.PARM.CAT(TEMP1) = %PC_PDTCAT;

  19823  9 004433   000032 376000 xsym               ANQ     B_VECTNIL+26
         9 004434   007000 276003                    ORQ     3584,DU
         9 004435   000231 756005 1                  STQ     DISP_TBL+1,AL

     1796    19824    7                          DISP_TBL.PARM.INDEXLO(TEMP1) = TEMP2;

  19824  9 004436   000023 235000 1                  LDA     TEMP1
         9 004437   000001 735000                    ALS     1
         9 004440   000024 236000 1                  LDQ     TEMP2
         9 004441   000011 736000                    QLS     9
         9 004442   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 004443   777000 376007                    ANQ     -512,DL
         9 004444   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1797    19825    7                          DISP_TBL.PARM.INDEXHI(TEMP1) = TEMP2;

  19825  9 004445   000023 235000 1                  LDA     TEMP1
         9 004446   000001 735000                    ALS     1
         9 004447   000024 236000 1                  LDQ     TEMP2
         9 004450   000231 676005 1                  ERQ     DISP_TBL+1,AL
         9 004451   000777 376007                    ANQ     511,DL
         9 004452   000231 656005 1                  ERSQ    DISP_TBL+1,AL

     1798    19826    7                          TEMP1 = TEMP1 + 1;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:255  
  19826  9 004453   000023 054000 1                  AOS     TEMP1

     1799    19827    7                          END;

     1800    19828        /**/
     1801    19829    6                       END;                /* END PARTITION LOOP                 */

  19829  9 004454   000024 054000 1                  AOS     TEMP2
         9 004455   000024 235000 1                  LDA     TEMP2
         9 004456   000017 115007                    CMPA    15,DL
         9 004457   004065 604400 9                  TMOZ    s:19754

     1802    19830    5                    END;                   /* END PARAM LOOP                     */

  19830  9 004460   000027 054000 1                  AOS     K
         9 004461   000027 236000 1                  LDQ     K
         9 004462   000014 116007                    CMPQ    12,DL
         9 004463   004064 604400 9                  TMOZ    s:19753

     1803    19831    5                 IF (TEMP1 ~= 0) THEN DO;

  19831  9 004464   000023 235000 1                  LDA     TEMP1
         9 004465   004474 600000 9                  TZE     s:19837

     1804    19832    5                    DISP_TBL.INDX = TEMP1 - 1;

  19832  9 004466   000001 135007                    SBLA    1,DL
         9 004467   000230 755000 1                  STA     DISP_TBL

     1805    19833    5                    CALL PCP$PDISP(DISP_TBL) ALTRET(DISPLAY_ERR);

  19833  9 004470   000053 630400 10                 EPPR0   43
         9 004471   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 004472   000000 701000 xent               TSX1    PCP$PDISP
         9 004473   004603 702000 9                  TSX2    DISPLAY_ERR

     1806    19834    5                    END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:256  

     1807    19835    4               END;                        /* END DO CASE                        */

     1808    19836        /**/
     1809    19837    3              END;

  19837  9 004474   000025 054000 1                  AOS     I
         9 004475   002115 470400 1                  LDP0    P_PCB$
         9 004476   000003 471500                    LDP1    3,,PR0
         9 004477   100001 236100                    LDQ     1,,PR1
         9 004500   000022 772000                    QRL     18
         9 004501   000025 116000 1                  CMPQ    I
         9 004502   002212 605400 9                  TPNZ    s:19436

     1810    19838        /**/
     1811    19839    2           IF (DISP_CAT(%PC_SYSTEM)) THEN

  19839  9 004503   000541 236000 1                  LDQ     DISP_CAT
         9 004504   200000 316003                    CANQ    65536,DU
         9 004505   004512 600000 9                  TZE     s:19841

     1812    19840    2              CALL PCT$SYSTEM(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19840  9 004506   000047 630400 10                 EPPR0   39
         9 004507   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 004510   000000 701000 xent               TSX1    PCT$SYSTEM
         9 004511   004603 702000 9                  TSX2    DISPLAY_ERR

     1813    19841    2           IF (DISP_CAT(%PC_RESOURCE)) THEN

  19841  9 004512   000541 236000 1                  LDQ     DISP_CAT
         9 004513   100000 316003                    CANQ    32768,DU
         9 004514   004521 600000 9                  TZE     s:19843

     1814    19842    2              CALL PCT$RESOURCE(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19842  9 004515   000047 630400 10                 EPPR0   39
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:257  
         9 004516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 004517   000000 701000 xent               TSX1    PCT$RESOURCE
         9 004520   004603 702000 9                  TSX2    DISPLAY_ERR

     1815    19843    3           IF (DISP_CAT(%PC_PARTITION)) THEN DO;

  19843  9 004521   000541 236000 1                  LDQ     DISP_CAT
         9 004522   040000 316003                    CANQ    16384,DU
         9 004523   004556 600000 9                  TZE     s:19852

     1816    19844    3              PART#_FLGS = NO;

  19844  9 004524   000050 236000 10                 LDQ     40
         9 004525   000227 356000 1                  ANSQ    PART#_FLGS

     1817    19845    3              MONPTR$ = CAT$ -> CAT$TBL.PARAM$(%PC_SYSTEM) -> P$TBL.PTR$(%PC_NPART);

  19845  9 004526   000000 470400 1                  LDP0    CAT$
         9 004527   000003 471500                    LDP1    3,,PR0
         9 004530   100257 236100                    LDQ     175,,PR1
         9 004531   000010 756000 1                  STQ     MONPTR$

     1818    19846    3              MONPTR.SEGID = BITBIN(%SPCL1SID);

  19846  9 004532   006021 236007                    LDQ     3089,DL
         9 004533   000010 752003 1                  STCQ    MONPTR$,'03'O

     1819    19847    4              DO K = 0 TO MONPTR$ -> B$TABLE(0) - 1;

  19847  9 004534   000027 450000 1                  STZ     K
         9 004535   004545 710000 9                  TRA     s:19849+1

     1820    19848    4                 PART#_FLGS(K) = YES;

  19848  9 004536   000027 235000 1                  LDA     K
         9 004537   004541 605000 9                  TPL     s:19848+3
         9 004540   000044 035003                    ADLA    36,DU
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:258  
         9 004541   003005 060400                    CSL     bolr='003'O
         9 004542   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 004543   000227 000001 1                  BDSC    PART#_FLGS,A             by=0,bit=0,n=1

     1821    19849    4                 END;

  19849  9 004544   000027 054000 1                  AOS     K
         9 004545   000010 470400 1                  LDP0    MONPTR$
         9 004546   000027 236000 1                  LDQ     K
         9 004547   004536 604000 9                  TMI     s:19848
         9 004550   000000 116100                    CMPQ    0,,PR0
         9 004551   004536 602000 9                  TNC     s:19848

     1822    19850    3              CALL PCT$PARTITION(%PC_PCTPART#) ALTRET(DISPLAY_ERR);

  19850  9 004552   000024 630400 10                 EPPR0   20
         9 004553   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 004554   000000 701000 xent               TSX1    PCT$PARTITION
         9 004555   004603 702000 9                  TSX2    DISPLAY_ERR

     1823    19851    3              END;

     1824    19852    2           IF (DISP_CAT(%PC_EXCEPTION)) THEN

  19852  9 004556   000541 236000 1                  LDQ     DISP_CAT
         9 004557   010000 316003                    CANQ    4096,DU
         9 004560   004565 600000 9                  TZE     s:19855

     1825    19853    2              CALL PCT$EXCEPTION(%PC_PCTALL) ALTRET(DISPLAY_ERR);

  19853  9 004561   000047 630400 10                 EPPR0   39
         9 004562   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 004563   000000 701000 xent               TSX1    PCT$EXCEPTION
         9 004564   004603 702000 9                  TSX2    DISPLAY_ERR

     1826    19854        /**/
     1827    19855    3           IF (J ~= 0) THEN DO;            /* SOME PARAMETERS                    */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:259  

  19855  9 004565   000026 235000 1                  LDA     J
         9 004566   004575 600000 9                  TZE     s:19860

     1828    19856    3              DISP_TBL.INDX = J-1;

  19856  9 004567   000001 135007                    SBLA    1,DL
         9 004570   000230 755000 1                  STA     DISP_TBL

     1829    19857    3              CALL PCP$PDISP(DISP_TBL) ALTRET(DISPLAY_ERR);

  19857  9 004571   000053 630400 10                 EPPR0   43
         9 004572   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 004573   000000 701000 xent               TSX1    PCP$PDISP
         9 004574   004603 702000 9                  TSX2    DISPLAY_ERR

     1830    19858    3              END;

     1831    19859        /**/
     1832    19860    2           RETURN;

  19860  9 004575   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 004576   000001 702211                    TSX2  ! 1,X1

     1833    19861        /**/
     1834    19862    2   BAD_RES:
     1835    19863    2           CALL PCE$ERROR(%E$P_BADRES,3);

  19863  9 004577   000045 630400 10    BAD_RES      EPPR0   37
         9 004600   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004601   000000 701000 xent               TSX1    PCE$ERROR
         9 004602   000000 011000                    NOP     0

     1836    19864        /**/
     1837    19865    2   DISPLAY_ERR:
     1838    19866    2           ALTRETURN;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:260  
  19866  9 004603   200054 221300       DISPLAY_ERR  LDX1  ! TEMPLEN+1,,AUTO
         9 004604   000000 702211                    TSX2  ! 0,X1

     1839    19867    2   END EXEC_DISPLAY;
     1840    19868        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:261  
     1841    19869        /**/
     1842    19870    1   GET_RES: PROC(RES_INDEX,OUT_SYM) ALTRET;

  19870  9 004605   200056 741300       GET_RES      STX1  ! CODE+1,,AUTO

     1843    19871        /**/
     1844    19872    2   DCL RES_INDEX SBIN WORD;
     1845    19873        %PARSE$SYM (NAME=OUT_SYM,STCLASS="");
     1846    19911        /**/
     1847    19912    2   DCL INDX SBIN WORD AUTO;
     1848    19913        /**/
     1849    19914    3           IF (OUT_SYM.COUNT = 2) THEN DO INDX = 0 TO %PSURES_OFFSET-1;

  19914  9 004606   200060 470500                    LDP0    @OUT_SYM,,AUTO
         9 004607   000004 236100                    LDQ     4,,PR0
         9 004610   777000 376003                    ANQ     -512,DU
         9 004611   002000 116003                    CMPQ    1024,DU
         9 004612   004636 601000 9                  TNZ     s:19921

  19914  9 004613   200061 450100                    STZ     INDX,,AUTO
         9 004614   004633 710000 9                  TRA     s:19919+1

     1850    19915    4              IF (SUBSTR(OUT_SYM.TEXT,0,2) = RES_TEXT(INDX)) THEN DO;

  19915  9 004615   200060 470500                    LDP0    @OUT_SYM,,AUTO
         9 004616   000004 236100                    LDQ     4,,PR0
         9 004617   000033 772000                    QRL     27
         9 004620   200061 235100                    LDA     INDX,,AUTO
         9 004621   000001 735000                    ALS     1
         9 004622   040005 106500                    CMPC    fill='040'O
         9 004623   000004 200002                    ADSC9   4,,PR0                   cn=1,n=2
         9 004624   000040 000002 1                  ADSC9   RES_TEXT,A               cn=0,n=2
         9 004625   004632 601000 9                  TNZ     s:19919

     1851    19916    4                 RES_INDX = INDX;

  19916  9 004626   200061 235100                    LDA     INDX,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:262  
         9 004627   000062 755000 1                  STA     RES_INDX

     1852    19917    4                 RETURN;

  19917  9 004630   200056 221300                    LDX1  ! CODE+1,,AUTO
         9 004631   000001 702211                    TSX2  ! 1,X1

     1853    19918    4                 END;
     1854    19919    3              END;

  19919  9 004632   200061 054100                    AOS     INDX,,AUTO
         9 004633   200061 235100                    LDA     INDX,,AUTO
         9 004634   000003 115007                    CMPA    3,DL
         9 004635   004615 604400 9                  TMOZ    s:19915

     1855    19920        /**/
     1856    19921    3           DO INDX = 0 TO NUM_PSURES;

  19921  9 004636   200061 450100                    STZ     INDX,,AUTO
         9 004637   004660 710000 9                  TRA     s:19926+1

     1857    19922    4              IF (SUBSTR(OUT_SYM.TEXT,0,OUT_SYM.COUNT) = PSURES_TEXT(INDX)) THEN DO;

  19922  9 004640   200060 470500                    LDP0    @OUT_SYM,,AUTO
         9 004641   000004 236100                    LDQ     4,,PR0
         9 004642   000033 772000                    QRL     27
         9 004643   200061 235100                    LDA     INDX,,AUTO
         9 004644   000003 735000                    ALS     3
         9 004645   000000 620006                    EAX0    0,QL
         9 004646   040005 106540                    CMPC    fill='040'O
         9 004647   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         9 004650   000042 000010 1                  ADSC9   PSURES_TEXT,A            cn=0,n=8
         9 004651   004657 601000 9                  TNZ     s:19926

     1858    19923    4                 RES_INDX = INDX + %PSURES_OFFSET;

  19923  9 004652   200061 236100                    LDQ     INDX,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:263  
         9 004653   000004 036007                    ADLQ    4,DL
         9 004654   000062 756000 1                  STQ     RES_INDX

     1859    19924    4                 RETURN;

  19924  9 004655   200056 221300                    LDX1  ! CODE+1,,AUTO
         9 004656   000001 702211                    TSX2  ! 1,X1

     1860    19925    4                 END;
     1861    19926    3              END;

  19926  9 004657   200061 054100                    AOS     INDX,,AUTO
         9 004660   000012 236000 1                  LDQ     NUM_PSURES
         9 004661   004640 604000 9                  TMI     s:19922
         9 004662   200061 116100                    CMPQ    INDX,,AUTO
         9 004663   004640 605000 9                  TPL     s:19922

     1862    19927        /**/
     1863    19928    2           ALTRETURN;

  19928  9 004664   200056 221300                    LDX1  ! CODE+1,,AUTO
         9 004665   000000 702211                    TSX2  ! 0,X1

     1864    19929    2   END GET_RES;
     1865    19930        /**/
     1866    19931        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:264  
     1867    19932        /**/
     1868    19933    1   EXEC_SET: PROC ALTRET;

  19933  9 004666   200054 741300       EXEC_SET     STX1  ! TEMPLEN+1,,AUTO

     1869    19934        /**/
     1870    19935    2           CALL M$INT(BREAKSET_FPT);       /* CHANGE BREAK CONTROL               */

  19935  9 004667   010254 630400 1                  EPPR0   BREAKSET_FPT
         9 004670   010002 713400                    CLIMB   4098
         9 004671   400000 401760                    pmme    nvectors=1

     1871    19936        /**/
     1872    19937    3           DO I = 1 TO P_PCB.OUT$ -> O$BLK.NSUBLKS-1;

  19937  9 004672   000001 235007                    LDA     1,DL
         9 004673   000025 755000 1                  STA     I
         9 004674   007575 710000 9                  TRA     NEXT3+1

     1873    19938    3              BLK$ = P_PCB.OUT$ -> O$BLK.SUBLK$(I); /* ALL PARAMS                  */

  19938  9 004675   002115 470400 1                  LDP0    P_PCB$
         9 004676   000003 471500                    LDP1    3,,PR0
         9 004677   000025 720000 1                  LXL0    I
         9 004700   100003 236110                    LDQ     3,X0,PR1
         9 004701   000015 756000 1                  STQ     BLK$

     1874    19939    4             IF NOT(SETAUTH) AND BLK$->O$BLK.SUBLK$(0)->O$BLK.CODE ~= %PC_RUPARAM THEN
             19939                       DO;

  19939  9 004702   000035 234000 1                  SZN     SETAUTH
         9 004703   004716 604000 9                  TMI     s:19948
         9 004704   000015 473400 1                  LDP3    BLK$
         9 004705   300003 474500                    LDP4    3,,PR3
         9 004706   400000 721100                    LXL1    0,,PR4
         9 004707   000010 101003                    CMPX1   8,DU
         9 004710   004716 600000 9                  TZE     s:19948
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:265  

     1875    19940    4                 CALL PCE$ERROR(%E$P_CANTSET,3);

  19940  9 004711   000111 630400 10                 EPPR0   73
         9 004712   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004713   000000 701000 xent               TSX1    PCE$ERROR
         9 004714   000000 011000                    NOP     0

     1876    19941    4                 GOTO ENDLOOP;

  19941  9 004715   007574 710000 9                  TRA     NEXT3

     1877    19942    4                 END;
     1878    19943        /**/
     1879    19944        /*E*     ERROR: PCC-E$P_CANTSET-0
     1880    19945                 MESSAGE:  You are not allowed to SET values - command ignored.
     1881    19946                 MESSAGE1: You dont have the privilege required to SET values
     1882    19947                 DESCRIPTION:   SOMEONES TRYING TO CHEAT - FORGET IT */
     1883    19948    4              DO CASE (BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE); /* DO CASE(CATAGORY) */

  19948  9 004716   000015 473400 1                  LDP3    BLK$
         9 004717   300003 474500                    LDP4    3,,PR3
         9 004720   400000 721100                    LXL1    0,,PR4
         9 004721   000011 101003                    CMPX1   9,DU
         9 004722   004724 602011 9                  TNC     s:19948+6,X1
         9 004723   007574 710000 9                  TRA     NEXT3
         9 004724   007574 710000 9                  TRA     NEXT3
         9 004725   004735 710000 9                  TRA     s:19952
         9 004726   005444 710000 9                  TRA     s:20089
         9 004727   005657 710000 9                  TRA     s:20152
         9 004730   006554 710000 9                  TRA     s:20311
         9 004731   004735 710000 9                  TRA     s:19952
         9 004732   004735 710000 9                  TRA     s:19952
         9 004733   007574 710000 9                  TRA     NEXT3
         9 004734   006057 710000 9                  TRA     s:20208

     1884    19949        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:266  
     1885    19950    4               CASE(%PC_SYSTEM,%PC_EXCEPTION,%PC_SECURITY);

     1886    19951        /**/
     1887    19952    4                 SET_CAT = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;

  19952  9 004735   400000 236100                    LDQ     0,,PR4
         9 004736   777777 376007                    ANQ     -1,DL
         9 004737   001706 756000 1                  STQ     SET_CAT

     1888    19953    4                 IF SET_CAT = %PC_SECURITY THEN

  19953  9 004740   000006 116007                    CMPQ    6,DL
         9 004741   004744 601000 9                  TNZ     s:19955

     1889    19954    4                    SET_CAT = %PC_SYSTEM;

  19954  9 004742   000001 235007                    LDA     1,DL
         9 004743   001706 755000 1                  STA     SET_CAT

     1890    19955    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);

  19955  9 004744   400003 236100                    LDQ     3,,PR4
         9 004745   000017 756000 1                  STQ     PARAM$

     1891    19956    4                 SET_PARAM = PARAM$ -> O$BLK.CODE;

  19956  9 004746   000017 475400 1                  LDP5    PARAM$
         9 004747   500000 236100                    LDQ     0,,PR5
         9 004750   777777 376007                    ANQ     -1,DL
         9 004751   001707 756000 1                  STQ     SET_PARAM

     1892    19957        /**/
     1893    19958    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->

  19958  9 004752   001706 235000 1                  LDA     SET_CAT
         9 004753   000001 735000                    ALS     1
         9 004754   000000 476400 1                  LDP6    CAT$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:267  
         9 004755   600001 477505                    LDP7    1,AL,PR6
         9 004756   000014 402007                    MPY     12,DL
         9 004757   700000 236106                    LDQ     0,QL,PR7
         9 004760   200000 316003                    CANQ    65536,DU
         9 004761   004770 600000 9                  TZE     s:19969

     1894    19959    5                   P$TBL.FLAGS.DISPONLY(SET_PARAM)) THEN DO;

     1895    19960    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);

  19960  9 004762   000114 630400 10                 EPPR0   76
         9 004763   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 004764   000000 701000 xent               TSX1    PCE$ERROR
         9 004765   000000 011000                    NOP     0

     1896    19961    5                    ALTRETURN;

  19961  9 004766   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 004767   000000 702211                    TSX2  ! 0,X1

     1897    19962    5                    END;
     1898    19963        /**/
     1899    19964        /*E*     ERROR:    PCC-E$P_DISPONLY-0
     1900    19965                 MESSAGE:  Dont try to set a display only parameter
     1901    19966                 DESCRIPTION: USER TRIED TO ASSIGN A NEW VALUE TO A DISPLAY
     1902    19967                                ONLY CONTROL PARAMETER   */
     1903    19968        /**/
     1904    19969    5                 IF CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXTLIST(SET_PARAM)
             19969                          THEN DO;

  19969  9 004770   001706 235000 1                  LDA     SET_CAT
         9 004771   000001 735000                    ALS     1
         9 004772   600001 477505                    LDP7    1,AL,PR6
         9 004773   001707 236000 1                  LDQ     SET_PARAM
         9 004774   000014 402007                    MPY     12,DL
         9 004775   700000 236106                    LDQ     0,QL,PR7
         9 004776   002000 316003                    CANQ    1024,DU
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:268  
         9 004777   005177 600000 9                  TZE     s:20015

     1905    19970                          /* Value is a list of privs or mon services  */
     1906    19971    5                    IF CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM)

  19971  9 005000   001706 235000 1                  LDA     SET_CAT
         9 005001   000001 735000                    ALS     1
         9 005002   600001 477505                    LDP7    1,AL,PR6
         9 005003   300001 222100                    LDX2    1,,PR3
         9 005004   300002 470512                    LDP0    2,X2,PR3
         9 005005   001707 236000 1                  LDQ     SET_PARAM
         9 005006   000014 402007                    MPY     12,DL
         9 005007   700000 236106                    LDQ     0,QL,PR7
         9 005010   000000 676100                    ERQ     0,,PR0
         9 005011   777777 376007                    ANQ     -1,DL
         9 005012   005020 600000 9                  TZE     s:19977

     1907    19972    5                       ~= BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE
     1908    19973    6                       THEN DO;

     1909    19974    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);

  19974  9 005013   000117 630400 10                 EPPR0   79
         9 005014   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005015   000000 701000 xent               TSX1    PCE$ERROR
         9 005016   000000 011000                    NOP     0

     1910    19975    6                          GOTO RESET_BREAK;

  19975  9 005017   007603 710000 9                  TRA     RESET_BREAK

     1911    19976    6                          END; /* IF error */
     1912    19977    5                    SUBLK$=BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1);

  19977  9 005020   300002 236112                    LDQ     2,X2,PR3
         9 005021   200015 756100                    STQ     SUBLK$,,AUTO

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:269  
     1913    19978    6                    IF CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.INTINDX(SET_PARAM)
             19978                             THEN DO;

  19978  9 005022   001706 235000 1                  LDA     SET_CAT
         9 005023   000001 735000                    ALS     1
         9 005024   600001 471505                    LDP1    1,AL,PR6
         9 005025   001707 236000 1                  LDQ     SET_PARAM
         9 005026   000014 402007                    MPY     12,DL
         9 005027   100000 430106                    FSZN    0,QL,PR1
         9 005030   005107 605000 9                  TPL     s:19996

     1914    19979                         /* This better be a list of monitor services for now. */
     1915    19980    6                       MONSER_VALUE='0'B;

  19980  9 005031   000000 100400                    MLR     fill='000'O
         9 005032   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 005033   001713 000100 1                  ADSC9   MONSER_VALUE             cn=0,n=64

     1916    19981    6                       IF SUBLK$->O$BLK.SUBLK$(0)->OUT$SYM.CODE=%PC_NONE THEN;

  19981  9 005034   200015 470500                    LDP0    SUBLK$,,AUTO
         9 005035   000003 471500                    LDP1    3,,PR0
         9 005036   100000 721100                    LXL1    0,,PR1
         9 005037   000002 101003                    CMPX1   2,DU
         9 005040   005305 600000 9                  TZE     s:20042

     1917    19982    6                       ELSE IF SUBLK$->O$BLK.SUBLK$(0)->OUT$SYM.CODE=%PC_ALL THEN

  19982  9 005041   000001 101003                    CMPX1   1,DU
         9 005042   005054 601000 9                  TNZ     s:19987

     1918    19983    7                       DO K = 0 TO %MAX_FCG#;

  19983  9 005043   000027 450000 1                  STZ     K

     1919    19984    7                          MONSER_VALUE(K)='777777777777'O;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:270  
  19984  9 005044   000027 236000 xsym               LDQ     B_VECTNIL+23
         9 005045   000027 720000 1                  LXL0    K
         9 005046   001713 756010 1                  STQ     MONSER_VALUE,X0

     1920    19985    7                          END;

  19985  9 005047   000027 054000 1                  AOS     K
         9 005050   000027 235000 1                  LDA     K
         9 005051   000017 115007                    CMPA    15,DL
         9 005052   005044 604400 9                  TMOZ    s:19984
         9 005053   005305 710000 9                  TRA     s:20042

     1921    19986    6                       ELSE  /* List of individual pmme names. */
     1922    19987    7                       DO K = 0 TO SUBLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS-1;

  19987  9 005054   000027 450000 1                  STZ     K
         9 005055   005101 710000 9                  TRA     s:19992+1

     1923    19988    7                          LIT$=SUBLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(K);

  19988  9 005056   200015 470500                    LDP0    SUBLK$,,AUTO
         9 005057   000003 471500                    LDP1    3,,PR0
         9 005060   000027 720000 1                  LXL0    K
         9 005061   100003 236110                    LDQ     3,X0,PR1
         9 005062   200016 756100                    STQ     LIT$,,AUTO

     1924    19989    7                          PMME=LIT$->OUT$SYM.CODE;

  19989  9 005063   200016 473500                    LDP3    LIT$,,AUTO
         9 005064   300000 721100                    LXL1    0,,PR3
         9 005065   200011 741100                    STX1    PMME,,AUTO

     1925    19990    7                          VAL$=ADDR(MONSER_VALUE(PMME_REDEF.FCG));

  19990  9 005066   200011 236100                    LDQ     PMME,,AUTO
         9 005067   000036 772000                    QRL     30
         9 005070   001713 634406 1                  EPPR4   MONSER_VALUE,QL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:271  
         9 005071   200013 454500                    STP4    VAL$,,AUTO

     1926    19991    7                          VAL$->B$BITS(PMME_REDEF.CODE)='1'B;

  19991  9 005072   200011 236100                    LDQ     PMME,,AUTO
         9 005073   000022 772000                    QRL     18
         9 005074   007777 376007                    ANQ     4095,DL
         9 005075   003106 060400                    CSL     bolr='003'O
         9 005076   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 005077   400000 000001                    BDSC    0,Q,PR4                  by=0,bit=0,n=1

     1927    19992    7                          END;

  19992  9 005100   000027 054000 1                  AOS     K
         9 005101   000003 471500                    LDP1    3,,PR0
         9 005102   100001 236100                    LDQ     1,,PR1
         9 005103   000022 772000                    QRL     18
         9 005104   000027 116000 1                  CMPQ    K
         9 005105   005056 605400 9                  TPNZ    s:19988

     1928    19993    6                       END;

  19993  9 005106   005305 710000 9                  TRA     s:20042

     1929    19994    6                    ELSE DO; /* Some kind of priv mask. */

     1930    19995                            /* Maybe add pprivs some day? */
     1931    19996    6                       MASK_VALUE='0'B;

  19996  9 005107   001712 450000 1                  STZ     VALUE

     1932    19997    6                       MASKVALHI = %PRIV_VAL_HI;

  19997  9 005110   000033 235007                    LDA     27,DL
         9 005111   200014 755100                    STA     MASKVALHI,,AUTO

     1933    19998    6                       PC$ = ADDR(PRIV_VALS.PC_CODE);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:272  

  19998  9 005112   000121 236000 10                 LDQ     81
         9 005113   200012 756100                    STQ     PC$,,AUTO

     1934    19999    6                       VAL$ = ADDR(PRIV_VALS.VAL_CODE);

  19999  9 005114   000122 236000 10                 LDQ     82
         9 005115   200013 756100                    STQ     VAL$,,AUTO

     1935    20000                            /* ALL, NONE, or a list of privs */
     1936    20001    7                       DO K = 0 TO SUBLK$->O$BLK.NSUBLKS-1;

  20001  9 005116   000027 450000 1                  STZ     K
         9 005117   005160 710000 9                  TRA     s:20009+1

     1937    20002    7                          LIT$=SUBLK$->O$BLK.SUBLK$(K);

  20002  9 005120   200015 470500                    LDP0    SUBLK$,,AUTO
         9 005121   000027 720000 1                  LXL0    K
         9 005122   000003 236110                    LDQ     3,X0,PR0
         9 005123   200016 756100                    STQ     LIT$,,AUTO

     1938    20003    8      MASK:               DO L = 0 TO MASKVALHI;

  20003  9 005124   000030 450000 1     MASK         STZ     L
         9 005125   005153 710000 9                  TRA     s:20008+1

     1939    20004    9                             IF LIT$->OUT$SYM.CODE=PC$->PC_CODE(L) THEN DO;

  20004  9 005126   000030 236000 1                  LDQ     L
         9 005127   000011 402007                    MPY     9,DL
         9 005130   000000 116003                    CMPQ    0,DU
         9 005131   005133 605000 9                  TPL     s:20004+5
         9 005132   000044 036003                    ADLQ    36,DU
         9 005133   200012 470500                    LDP0    PC$,,AUTO
         9 005134   003100 061506                    CSR     bolr='003'O
         9 005135   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:273  
         9 005136   200076 000044                    BDSC    TEMPTEXT+4,,AUTO         by=0,bit=0,n=36
         9 005137   200016 471500                    LDP1    LIT$,,AUTO
         9 005140   100000 236100                    LDQ     0,,PR1
         9 005141   777777 376007                    ANQ     -1,DL
         9 005142   200076 116100                    CMPQ    TEMPTEXT+4,,AUTO
         9 005143   005152 601000 9                  TNZ     s:20008

     1940    20005    9                                MASK_VALUE=MASK_VALUE|VAL$->VAL_CODE(L);

  20005  9 005144   200013 473500                    LDP3    VAL$,,AUTO
         9 005145   000030 720000 1                  LXL0    L
         9 005146   001712 236000 1                  LDQ     VALUE
         9 005147   300000 276110                    ORQ     0,X0,PR3
         9 005150   001712 756000 1                  STQ     VALUE

     1941    20006    9                                EXIT MASK;

  20006  9 005151   005157 710000 9                  TRA     s:20009

     1942    20007    9                                END;
     1943    20008    8                             END;

  20008  9 005152   000030 054000 1                  AOS     L
         9 005153   200014 236100                    LDQ     MASKVALHI,,AUTO
         9 005154   005126 604000 9                  TMI     s:20004
         9 005155   000030 116000 1                  CMPQ    L
         9 005156   005126 605000 9                  TPL     s:20004

     1944    20009    7                          END;

  20009  9 005157   000027 054000 1                  AOS     K
         9 005160   200015 470500                    LDP0    SUBLK$,,AUTO
         9 005161   000001 236100                    LDQ     1,,PR0
         9 005162   000022 772000                    QRL     18
         9 005163   000027 116000 1                  CMPQ    K
         9 005164   005120 605400 9                  TPNZ    s:20002

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:274  
     1945    20010    6                       IF PARAM$->O$BLK.CODE=%PC_STEPPRIVMASK OR

  20010  9 005165   000017 471400 1                  LDP1    PARAM$
         9 005166   100000 720100                    LXL0    0,,PR1
         9 005167   000054 100003                    CMPX0   44,DU
         9 005170   005173 600000 9                  TZE     s:20012
         9 005171   000053 100003                    CMPX0   43,DU
         9 005172   005305 601000 9                  TNZ     s:20042

     1946    20011    6                          PARAM$->O$BLK.CODE=%PC_PRIVMASK
     1947    20012    6                       THEN MASK_VALUE=~MASK_VALUE;

  20012  9 005173   001712 236000 1                  LDQ     VALUE
         9 005174   000027 676000 xsym               ERQ     B_VECTNIL+23
         9 005175   001712 756000 1                  STQ     VALUE

     1948    20013    6                       END;

     1949    20014    5                    END;

  20014  9 005176   005305 710000 9                  TRA     s:20042

     1950    20015    5                 ELSE IF SET_CAT = %PC_SYSTEM AND SET_PARAM = %PC_TIMEZONE THEN DO;

  20015  9 005177   001706 235000 1                  LDA     SET_CAT
         9 005200   000001 115007                    CMPA    1,DL
         9 005201   005222 601000 9                  TNZ     s:20024
         9 005202   001707 236000 1                  LDQ     SET_PARAM
         9 005203   000067 116007                    CMPQ    55,DL
         9 005204   005222 601000 9                  TNZ     s:20024

     1951    20016    6                    IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %
             20016                             PC_TZVAL THEN DO;

  20016  9 005205   300001 222100                    LDX2    1,,PR3
         9 005206   300002 477512                    LDP7    2,X2,PR3
         9 005207   700000 723100                    LXL3    0,,PR7
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:275  
         9 005210   000013 103003                    CMPX3   11,DU
         9 005211   005217 600000 9                  TZE     s:20021

     1952    20017    6   BAD_TIMEZONE:
     1953    20018    6                       CALL PCE$ERROR(%E$P_PARSEERR,3);

  20018  9 005212   000117 630400 10    BAD_TIMEZONE EPPR0   79
         9 005213   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005214   000000 701000 xent               TSX1    PCE$ERROR
         9 005215   000000 011000                    NOP     0

     1954    20019    6                       GOTO RESET_BREAK;

  20019  9 005216   007603 710000 9                  TRA     RESET_BREAK

     1955    20020    6                       END;
     1956    20021    5                    CALL SET_TIMEZONE ALTRET( BAD_TIMEZONE);

  20021  9 005217   007624 701000 9                  TSX1    SET_TIMEZONE
         9 005220   005212 702000 9                  TSX2    BAD_TIMEZONE

     1957    20022    5                    GOTO ENDLOOP;

  20022  9 005221   007574 710000 9                  TRA     NEXT3

     1958    20023    5                    END;
     1959    20024    5                 ELSE IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %
             20024                          PC_DECVAL THEN DO;

  20024  9 005222   300001 222100                    LDX2    1,,PR3
         9 005223   300002 477512                    LDP7    2,X2,PR3
         9 005224   700000 723100                    LXL3    0,,PR7
         9 005225   000012 103003                    CMPX3   10,DU
         9 005226   005277 600000 9                  TZE     s:20039

     1960    20025    5                    IF (NOT CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXT(
             20025                             SET_PARAM)) OR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:276  

  20025  9 005227   000001 735000                    ALS     1
         9 005230   600001 470505                    LDP0    1,AL,PR6
         9 005231   001707 236000 1                  LDQ     SET_PARAM
         9 005232   000014 402007                    MPY     12,DL
         9 005233   000000 236106                    LDQ     0,QL,PR0
         9 005234   004000 316003                    CANQ    2048,DU
         9 005235   005247 600000 9                  TZE     s:20029
         9 005236   001706 235000 1                  LDA     SET_CAT
         9 005237   000001 735000                    ALS     1
         9 005240   600001 470505                    LDP0    1,AL,PR6
         9 005241   001707 236000 1                  LDQ     SET_PARAM
         9 005242   000014 402007                    MPY     12,DL
         9 005243   000000 236106                    LDQ     0,QL,PR0
         9 005244   700000 676100                    ERQ     0,,PR7
         9 005245   777777 376007                    ANQ     -1,DL
         9 005246   005254 600000 9                  TZE     s:20032

     1961    20026    5                      (CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM) ~= BLK$
             20026                                ->
     1962    20027    5                          O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE)
     1963    20028    6                       THEN DO;

     1964    20029    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);

  20029  9 005247   000117 630400 10                 EPPR0   79
         9 005250   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005251   000000 701000 xent               TSX1    PCE$ERROR
         9 005252   000000 011000                    NOP     0

     1965    20030    6                          GOTO RESET_BREAK;

  20030  9 005253   007603 710000 9                  TRA     RESET_BREAK

     1966    20031    6                          END;  /* IF ERROR */
     1967    20032    5                    VALUE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.SUBLK$(0)
             20032                             ->OUT$SYM.CODE;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:277  

  20032  9 005254   700003 470500                    LDP0    3,,PR7
         9 005255   000000 236100                    LDQ     0,,PR0
         9 005256   777777 376007                    ANQ     -1,DL
         9 005257   001712 756000 1                  STQ     VALUE

     1968    20033    5                    CODE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE;

  20033  9 005260   700000 236100                    LDQ     0,,PR7
         9 005261   777777 376007                    ANQ     -1,DL
         9 005262   200010 756100                    STQ     CODE,,AUTO

     1969    20034    5                    IF CODE=%PC_FLAGVAL OR CODE=%PC_LOGFILEVAL OR

  20034  9 005263   005274 600000 9                  TZE     s:20037
         9 005264   000003 116007                    CMPQ    3,DL
         9 005265   005274 600000 9                  TZE     s:20037
         9 005266   000004 116007                    CMPQ    4,DL
         9 005267   005274 600000 9                  TZE     s:20037
         9 005270   000005 116007                    CMPQ    5,DL
         9 005271   005274 600000 9                  TZE     s:20037
         9 005272   000007 116007                    CMPQ    7,DL
         9 005273   005305 601000 9                  TNZ     s:20042

     1970    20035    5                          CODE=%PC_LOGACCVAL OR CODE=%PC_LOGEXVAL OR
     1971    20036    5                          CODE=%PC_LOGLISTVAL
     1972    20037    5                       THEN VALUE = VALUE - 1;

  20037  9 005274   000001 336007                    LCQ     1,DL
         9 005275   001712 056000 1                  ASQ     VALUE

     1973    20038    5                    END;  /* IF CODE ~= %PC_DECVAL */

  20038  9 005276   005305 710000 9                  TRA     s:20042

     1974    20039    4                   ELSE CALL CHARBIN(VALUE,BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->
             20039                             OUT$SYM.TEXT);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:278  

  20039  9 005277   700004 236100                    LDQ     4,,PR7
         9 005300   000033 772000                    QRL     27
         9 005301   000000 624006                    EAX4    0,QL
         9 005302   000000 305540                    DTB
         9 005303   700004 230014                    NDSC9   4,,PR7                   cn=1,s=nosgn,sf=0,n=*X4
         9 005304   001712 000004 1                  NDSC9   VALUE                    cn=0,s=lsgnf,sf=0,n=4

     1975    20040        /**/
     1976    20041        /**/
     1977    20042    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->

  20042  9 005305   001706 235000 1                  LDA     SET_CAT
         9 005306   000001 735000                    ALS     1
         9 005307   000000 470400 1                  LDP0    CAT$
         9 005310   000001 471505                    LDP1    1,AL,PR0
         9 005311   001707 236000 1                  LDQ     SET_PARAM
         9 005312   000014 402007                    MPY     12,DL
         9 005313   100000 236106                    LDQ     0,QL,PR1
         9 005314   100000 316003                    CANQ    32768,DU
         9 005315   005372 600000 9                  TZE     s:20066

     1978    20043    5                   P$TBL.FLAGS.INDX(SET_PARAM)) THEN DO; /* INDEXED              */

     1979    20044    5                    IF (BLK$ -> O$BLK.NSUBLKS = 2)OR /* NO OR 'ALL' INDEX        */

  20044  9 005316   000015 471400 1                  LDP1    BLK$
         9 005317   100001 220100                    LDX0    1,,PR1
         9 005320   000002 100003                    CMPX0   2,DU
         9 005321   005327 600000 9                  TZE     s:20047
         9 005322   100004 473500                    LDP3    4,,PR1
         9 005323   300003 474500                    LDP4    3,,PR3
         9 005324   400000 721100                    LXL1    0,,PR4
         9 005325   000145 101003                    CMPX1   101,DU
         9 005326   005345 601000 9                  TNZ     s:20058

     1980    20045    5                      (BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:279  
             20045                               PC_ALLOPT)
     1981    20046    6                    THEN DO;

     1982    20047    7                       IF (SET_CAT = %PC_SYSTEM) THEN DO;

  20047  9 005327   001706 235000 1                  LDA     SET_CAT
         9 005330   000001 115007                    CMPA    1,DL
         9 005331   005337 601000 9                  TNZ     s:20052

     1983    20048    7                          SET_INDEXLO = 1;

  20048  9 005332   000001 236007                    LDQ     1,DL
         9 005333   001710 756000 1                  STQ     SET_INDEXLO

     1984    20049    7                          SET_INDEXHI = %PC_MAXMODE;

  20049  9 005334   000004 235007                    LDA     4,DL
         9 005335   001711 755000 1                  STA     SET_INDEXHI

     1985    20050    7                          END;

  20050  9 005336   005342 710000 9                  TRA     s:20055

     1986    20051    7                       ELSE DO;

     1987    20052    7                          SET_INDEXLO = 0;

  20052  9 005337   001710 450000 1                  STZ     SET_INDEXLO

     1988    20053    7                          SET_INDEXHI = %PC_MAXDOMAIN;

  20053  9 005340   000003 236007                    LDQ     3,DL
         9 005341   001711 756000 1                  STQ     SET_INDEXHI

     1989    20054    7                          END;

     1990    20055    6                       CALL SET_VALUE;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:280  

  20055  9 005342   007767 701000 9                  TSX1    SET_VALUE
         9 005343   000000 011000                    NOP     0

     1991    20056    6                       END;

  20056  9 005344   007574 710000 9                  TRA     NEXT3

     1992    20057        /**/
     1993    20058    6                    ELSE DO K = 0 TO BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.NSUBLKS-1;

  20058  9 005345   000027 450000 1                  STZ     K
         9 005346   005363 710000 9                  TRA     s:20063+1

     1994    20059    6                       SET_INDEXLO = BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(K) ->

  20059  9 005347   000015 470400 1                  LDP0    BLK$
         9 005350   000004 471500                    LDP1    4,,PR0
         9 005351   000027 720000 1                  LXL0    K
         9 005352   100003 473510                    LDP3    3,X0,PR1
         9 005353   300003 474500                    LDP4    3,,PR3
         9 005354   400000 236100                    LDQ     0,,PR4
         9 005355   777777 376007                    ANQ     -1,DL
         9 005356   001710 756000 1                  STQ     SET_INDEXLO

     1995    20060    6                         O$BLK.SUBLK$(0) -> O$BLK.CODE;
     1996    20061    6                       SET_INDEXHI = SET_INDEXLO;

  20061  9 005357   001711 756000 1                  STQ     SET_INDEXHI

     1997    20062    6                       CALL SET_VALUE;

  20062  9 005360   007767 701000 9                  TSX1    SET_VALUE
         9 005361   000000 011000                    NOP     0

     1998    20063    6                       END;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:281  
  20063  9 005362   000027 054000 1                  AOS     K
         9 005363   000015 470400 1                  LDP0    BLK$
         9 005364   000004 471500                    LDP1    4,,PR0
         9 005365   100001 236100                    LDQ     1,,PR1
         9 005366   000022 772000                    QRL     18
         9 005367   000027 116000 1                  CMPQ    K
         9 005370   005347 605400 9                  TPNZ    s:20059

     1999    20064    5                    END;

  20064  9 005371   007574 710000 9                  TRA     NEXT3

     2000    20065        /**/
     2001    20066    4                 ELSE IF (CAT$->CAT$TBL.PARAM$(SET_CAT)->

  20066  9 005372   001706 235000 1                  LDA     SET_CAT
         9 005373   000001 735000                    ALS     1
         9 005374   000001 471505                    LDP1    1,AL,PR0
         9 005375   001707 236000 1                  LDQ     SET_PARAM
         9 005376   000014 402007                    MPY     12,DL
         9 005377   100000 430106                    FSZN    0,QL,PR1
         9 005400   005425 605000 9                  TPL     s:20078

     2002    20067    5                   P$TBL.FLAGS.INTINDX(SET_PARAM)) THEN DO; /* Internally indexed */

     2003    20068    5                    IF CAT$->CAT$TBL.PARAM$(SET_CAT)->

  20068  9 005401   001706 235000 1                  LDA     SET_CAT
         9 005402   000001 735000                    ALS     1
         9 005403   000001 471505                    LDP1    1,AL,PR0
         9 005404   100000 720106                    LXL0    0,QL,PR1
         9 005405   000010 100003                    CMPX0   8,DU
         9 005406   007574 601000 9                  TNZ     NEXT3

     2004    20069    5                      P$TBL.VALCODE(SET_PARAM) = %PC_MONSERVAL THEN
     2005    20070    6                       DO K=0 TO %MAX_FCG#;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:282  
  20070  9 005407   000027 450000 1                  STZ     K

     2006    20071    6                          MASK_VALUE=MONSER_VALUE(K);

  20071  9 005410   000027 720000 1                  LXL0    K
         9 005411   001713 236010 1                  LDQ     MONSER_VALUE,X0
         9 005412   001712 756000 1                  STQ     VALUE

     2007    20072    6                          SET_INDEXLO = K;

  20072  9 005413   000027 235000 1                  LDA     K
         9 005414   001710 755000 1                  STA     SET_INDEXLO

     2008    20073    6                          SET_INDEXHI = K;

  20073  9 005415   001711 755000 1                  STA     SET_INDEXHI

     2009    20074    6                          CALL SET_VALUE;

  20074  9 005416   007767 701000 9                  TSX1    SET_VALUE
         9 005417   000000 011000                    NOP     0

     2010    20075    6                          END;

  20075  9 005420   000027 054000 1                  AOS     K
         9 005421   000027 235000 1                  LDA     K
         9 005422   000017 115007                    CMPA    15,DL
         9 005423   005410 604400 9                  TMOZ    s:20071

     2011    20076    5                    END;

  20076  9 005424   007574 710000 9                  TRA     NEXT3

     2012    20077    5                 ELSE DO;

     2013    20078    6                    IF (BLK$ -> O$BLK.NSUBLKS ~= 2) THEN DO; /* ILLEGAL INDEX    */

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:283  
  20078  9 005425   000015 471400 1                  LDP1    BLK$
         9 005426   100001 220100                    LDX0    1,,PR1
         9 005427   000002 100003                    CMPX0   2,DU
         9 005430   005437 600000 9                  TZE     s:20083

     2014    20079    6                       CALL PCE$ERROR(%E$P_NOTINDEX,2);

  20079  9 005431   000056 630400 10                 EPPR0   46
         9 005432   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005433   000000 701000 xent               TSX1    PCE$ERROR
         9 005434   000000 011000                    NOP     0

     2015    20080    6                       ALTRETURN;

  20080  9 005435   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 005436   000000 702211                    TSX2  ! 0,X1

     2016    20081    6                       END;
     2017    20082        /**/
     2018    20083    5                    SET_INDEXLO = 0;

  20083  9 005437   001710 450000 1                  STZ     SET_INDEXLO

     2019    20084    5                    SET_INDEXHI = 0;       /* NOT INDEXED                        */

  20084  9 005440   001711 450000 1                  STZ     SET_INDEXHI

     2020    20085    5                    CALL SET_VALUE;

  20085  9 005441   007767 701000 9                  TSX1    SET_VALUE
         9 005442   000000 011000                    NOP     0

     2021    20086    5                    END;

  20086  9 005443   007574 710000 9                  TRA     NEXT3

     2022    20087        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:284  
     2023    20088    4               CASE(%PC_RESOURCE);

     2024    20089    4                 SET_CAT = %PC_RESOURCE;

  20089  9 005444   000002 235007                    LDA     2,DL
         9 005445   001706 755000 1                  STA     SET_CAT

     2025    20090    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);

  20090  9 005446   400003 236100                    LDQ     3,,PR4
         9 005447   000017 756000 1                  STQ     PARAM$

     2026    20091    4                 SET_PARAM = PARAM$ -> O$BLK.CODE;

  20091  9 005450   000017 475400 1                  LDP5    PARAM$
         9 005451   500000 236100                    LDQ     0,,PR5
         9 005452   777777 376007                    ANQ     -1,DL
         9 005453   001707 756000 1                  STQ     SET_PARAM

     2027    20092        /**/
     2028    20093    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->

  20093  9 005454   000001 735000                    ALS     1
         9 005455   000000 476400 1                  LDP6    CAT$
         9 005456   600001 477505                    LDP7    1,AL,PR6
         9 005457   000014 402007                    MPY     12,DL
         9 005460   700000 236106                    LDQ     0,QL,PR7
         9 005461   200000 316003                    CANQ    65536,DU
         9 005462   005471 600000 9                  TZE     s:20099

     2029    20094    5                   P$TBL.FLAGS.DISPONLY(SET_PARAM)) THEN DO;

     2030    20095    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);

  20095  9 005463   000114 630400 10                 EPPR0   76
         9 005464   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005465   000000 701000 xent               TSX1    PCE$ERROR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:285  
         9 005466   000000 011000                    NOP     0

     2031    20096    5                    ALTRETURN;

  20096  9 005467   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 005470   000000 702211                    TSX2  ! 0,X1

     2032    20097    5                    END;
     2033    20098        /**/
     2034    20099    5                IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %PC_DECVAL
             20099                          THEN DO;

  20099  9 005471   300001 222100                    LDX2    1,,PR3
         9 005472   300002 477512                    LDP7    2,X2,PR3
         9 005473   700000 723100                    LXL3    0,,PR7
         9 005474   000012 103003                    CMPX3   10,DU
         9 005475   005535 600000 9                  TZE     s:20111

     2035    20100    5                    IF (NOT CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXT(
             20100                             SET_PARAM)) OR

  20100  9 005476   001706 235000 1                  LDA     SET_CAT
         9 005477   000001 735000                    ALS     1
         9 005500   600001 470505                    LDP0    1,AL,PR6
         9 005501   001707 236000 1                  LDQ     SET_PARAM
         9 005502   000014 402007                    MPY     12,DL
         9 005503   000000 236106                    LDQ     0,QL,PR0
         9 005504   004000 316003                    CANQ    2048,DU
         9 005505   005517 600000 9                  TZE     s:20104
         9 005506   001706 235000 1                  LDA     SET_CAT
         9 005507   000001 735000                    ALS     1
         9 005510   600001 470505                    LDP0    1,AL,PR6
         9 005511   001707 236000 1                  LDQ     SET_PARAM
         9 005512   000014 402007                    MPY     12,DL
         9 005513   000000 236106                    LDQ     0,QL,PR0
         9 005514   700000 676100                    ERQ     0,,PR7
         9 005515   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:286  
         9 005516   005524 600000 9                  TZE     s:20107

     2036    20101    5                      (CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM) ~= BLK$
             20101                                ->
     2037    20102    5                          O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE)
     2038    20103    6                       THEN DO;

     2039    20104    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);

  20104  9 005517   000117 630400 10                 EPPR0   79
         9 005520   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005521   000000 701000 xent               TSX1    PCE$ERROR
         9 005522   000000 011000                    NOP     0

     2040    20105    6                          GOTO RESET_BREAK;

  20105  9 005523   007603 710000 9                  TRA     RESET_BREAK

     2041    20106    6                          END;  /* IF ERROR */
     2042    20107    5                    VALUE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.SUBLK$(0)
             20107                             ->OUT$SYM.CODE;

  20107  9 005524   700003 470500                    LDP0    3,,PR7
         9 005525   000000 236100                    LDQ     0,,PR0
         9 005526   777777 376007                    ANQ     -1,DL
         9 005527   001712 756000 1                  STQ     VALUE

     2043    20108    5                    IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE = %
             20108                             PC_FLAGVAL

  20108  9 005530   000000 103003                    CMPX3   0,DU
         9 005531   005543 601000 9                  TNZ     s:20114

     2044    20109    5                       THEN VALUE = VALUE - 1;

  20109  9 005532   000001 336007                    LCQ     1,DL
         9 005533   001712 056000 1                  ASQ     VALUE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:287  

     2045    20110    5                    END;  /* IF CODE ~= %PC_DECVAL */

  20110  9 005534   005543 710000 9                  TRA     s:20114

     2046    20111    4                   ELSE CALL CHARBIN(VALUE,BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->
             20111                             OUT$SYM.TEXT);

  20111  9 005535   700004 236100                    LDQ     4,,PR7
         9 005536   000033 772000                    QRL     27
         9 005537   000000 624006                    EAX4    0,QL
         9 005540   000000 305540                    DTB
         9 005541   700004 230014                    NDSC9   4,,PR7                   cn=1,s=nosgn,sf=0,n=*X4
         9 005542   001712 000004 1                  NDSC9   VALUE                    cn=0,s=lsgnf,sf=0,n=4

     2047    20112        /**/
     2048    20113        /**/
     2049    20114    4                 CALL GET_RES(RES_INDX,PARAM$ -> O$BLK.SUBLK$(0) -> OUT$SYM)

  20114  9 005543   500003 470500                    LDP0    3,,PR5
         9 005544   200060 450500                    STP0    @OUT_SYM,,AUTO
         9 005545   000043 236000 10                 LDQ     35
         9 005546   200057 756100                    STQ     @RES_INDEX,,AUTO
         9 005547   004605 701000 9                  TSX1    GET_RES
         9 005550   007610 702000 9                  TSX2    BAD_RES

     2050    20115    4                   ALTRET(BAD_RES);
     2051    20116    4                 IF SET_PARAM = %PC_TOTRES AND

  20116  9 005551   001707 235000 1                  LDA     SET_PARAM
         9 005552   000003 115007                    CMPA    3,DL
         9 005553   005565 601000 9                  TNZ     s:20122
         9 005554   000062 236000 1                  LDQ     RES_INDX
         9 005555   000004 116007                    CMPQ    4,DL
         9 005556   005565 605000 9                  TPL     s:20122

     2052    20117    5                    RES_INDX < %PSURES_OFFSET THEN DO;  /* ILLEGAL */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:288  

     2053    20118    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);

  20118  9 005557   000114 630400 10                 EPPR0   76
         9 005560   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005561   000000 701000 xent               TSX1    PCE$ERROR
         9 005562   000000 011000                    NOP     0

     2054    20119    5                    ALTRETURN;

  20119  9 005563   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 005564   000000 702211                    TSX2  ! 0,X1

     2055    20120    5                    END;  /* IF */
     2056    20121        /**/
     2057    20122    5                 IF (RES$ -> P$TBL.FLAGS.INDX(SET_PARAM)) THEN DO;

  20122  9 005565   001707 236000 1                  LDQ     SET_PARAM
         9 005566   000014 402007                    MPY     12,DL
         9 005567   000003 470400 1                  LDP0    RES$
         9 005570   000000 236106                    LDQ     0,QL,PR0
         9 005571   100000 316003                    CANQ    32768,DU
         9 005572   005640 600000 9                  TZE     s:20140

     2058    20123    5                    IF (BLK$ -> O$BLK.NSUBLKS = 2)OR /* NO OR 'ALL' INDEX        */

  20123  9 005573   000015 471400 1                  LDP1    BLK$
         9 005574   100001 220100                    LDX0    1,,PR1
         9 005575   000002 100003                    CMPX0   2,DU
         9 005576   005604 600000 9                  TZE     s:20126
         9 005577   100004 473500                    LDP3    4,,PR1
         9 005600   300003 474500                    LDP4    3,,PR3
         9 005601   400000 721100                    LXL1    0,,PR4
         9 005602   000145 101003                    CMPX1   101,DU
         9 005603   005613 601000 9                  TNZ     s:20131

     2059    20124    5                      (BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:289  
             20124                               PC_ALLOPT)
     2060    20125    6                    THEN DO;

     2061    20126    6                       SET_INDEXLO = 1;

  20126  9 005604   000001 235007                    LDA     1,DL
         9 005605   001710 755000 1                  STA     SET_INDEXLO

     2062    20127    6                       SET_INDEXHI = %PC_MAXMODE;

  20127  9 005606   000004 236007                    LDQ     4,DL
         9 005607   001711 756000 1                  STQ     SET_INDEXHI

     2063    20128    6                       CALL SET_VALUE;

  20128  9 005610   007767 701000 9                  TSX1    SET_VALUE
         9 005611   000000 011000                    NOP     0

     2064    20129    6                       END;

  20129  9 005612   007574 710000 9                  TRA     NEXT3

     2065    20130        /**/
     2066    20131    6                    ELSE DO K = 0 TO BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.NSUBLKS-1;

  20131  9 005613   000027 450000 1                  STZ     K
         9 005614   005631 710000 9                  TRA     s:20136+1

     2067    20132    6                       SET_INDEXLO = BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(K) ->

  20132  9 005615   000015 470400 1                  LDP0    BLK$
         9 005616   000004 471500                    LDP1    4,,PR0
         9 005617   000027 720000 1                  LXL0    K
         9 005620   100003 473510                    LDP3    3,X0,PR1
         9 005621   300003 474500                    LDP4    3,,PR3
         9 005622   400000 236100                    LDQ     0,,PR4
         9 005623   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:290  
         9 005624   001710 756000 1                  STQ     SET_INDEXLO

     2068    20133    6                         O$BLK.SUBLK$(0) -> O$BLK.CODE;
     2069    20134    6                       SET_INDEXHI = SET_INDEXLO;

  20134  9 005625   001711 756000 1                  STQ     SET_INDEXHI

     2070    20135    6                       CALL SET_VALUE;

  20135  9 005626   007767 701000 9                  TSX1    SET_VALUE
         9 005627   000000 011000                    NOP     0

     2071    20136    6                       END;

  20136  9 005630   000027 054000 1                  AOS     K
         9 005631   000015 470400 1                  LDP0    BLK$
         9 005632   000004 471500                    LDP1    4,,PR0
         9 005633   100001 236100                    LDQ     1,,PR1
         9 005634   000022 772000                    QRL     18
         9 005635   000027 116000 1                  CMPQ    K
         9 005636   005615 605400 9                  TPNZ    s:20132

     2072    20137    5                    END;

  20137  9 005637   007574 710000 9                  TRA     NEXT3

     2073    20138        /**/
     2074    20139    5                 ELSE DO;

     2075    20140    6                    IF (BLK$ -> O$BLK.NSUBLKS ~= 2) THEN DO; /* ILLEGAL INDEX    */

  20140  9 005640   000015 471400 1                  LDP1    BLK$
         9 005641   100001 220100                    LDX0    1,,PR1
         9 005642   000002 100003                    CMPX0   2,DU
         9 005643   005652 600000 9                  TZE     s:20145

     2076    20141    6                       CALL PCE$ERROR(%E$P_NOTINDEX,2);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:291  

  20141  9 005644   000056 630400 10                 EPPR0   46
         9 005645   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005646   000000 701000 xent               TSX1    PCE$ERROR
         9 005647   000000 011000                    NOP     0

     2077    20142    6                       ALTRETURN;

  20142  9 005650   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 005651   000000 702211                    TSX2  ! 0,X1

     2078    20143    6                       END;
     2079    20144        /**/
     2080    20145    5                    SET_INDEXLO = 0;

  20145  9 005652   001710 450000 1                  STZ     SET_INDEXLO

     2081    20146    5                    SET_INDEXHI = 0;       /* NOT INDEXED                        */

  20146  9 005653   001711 450000 1                  STZ     SET_INDEXHI

     2082    20147    5                    CALL SET_VALUE;

  20147  9 005654   007767 701000 9                  TSX1    SET_VALUE
         9 005655   000000 011000                    NOP     0

     2083    20148    5                    END;

  20148  9 005656   007574 710000 9                  TRA     NEXT3

     2084    20149        /**/
     2085    20150    4               CASE (%PC_PARTITION);

     2086    20151        /**/
     2087    20152    4                 SET_CAT = %PC_PARTITION;

  20152  9 005657   000003 235007                    LDA     3,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:292  
         9 005660   001706 755000 1                  STA     SET_CAT

     2088    20153    4                 PARAM$ = BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.SUBLK$(0);

  20153  9 005661   400003 236100                    LDQ     3,,PR4
         9 005662   000017 756000 1                  STQ     PARAM$

     2089    20154    4                 SET_PARAM = PARAM$ -> O$BLK.CODE;

  20154  9 005663   000017 475400 1                  LDP5    PARAM$
         9 005664   500000 236100                    LDQ     0,,PR5
         9 005665   777777 376007                    ANQ     -1,DL
         9 005666   001707 756000 1                  STQ     SET_PARAM

     2090    20155        /**/
     2091    20156    4                 IF (CAT$ -> CAT$TBL.PARAM$(SET_CAT) ->

  20156  9 005667   000001 735000                    ALS     1
         9 005670   000000 476400 1                  LDP6    CAT$
         9 005671   600001 477505                    LDP7    1,AL,PR6
         9 005672   000014 402007                    MPY     12,DL
         9 005673   700000 236106                    LDQ     0,QL,PR7
         9 005674   200000 316003                    CANQ    65536,DU
         9 005675   005704 600000 9                  TZE     s:20162

     2092    20157    5                   P$TBL.FLAGS.DISPONLY(SET_PARAM)) THEN DO;

     2093    20158    5                    CALL PCE$ERROR(%E$P_DISPONLY,2);

  20158  9 005676   000114 630400 10                 EPPR0   76
         9 005677   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005700   000000 701000 xent               TSX1    PCE$ERROR
         9 005701   000000 011000                    NOP     0

     2094    20159    5                    ALTRETURN;

  20159  9 005702   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:293  
         9 005703   000000 702211                    TSX2  ! 0,X1

     2095    20160    5                    END;
     2096    20161        /**/
     2097    20162    5                IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE ~= %PC_DECVAL
             20162                          THEN DO;

  20162  9 005704   300001 222100                    LDX2    1,,PR3
         9 005705   300002 477512                    LDP7    2,X2,PR3
         9 005706   700000 723100                    LXL3    0,,PR7
         9 005707   000012 103003                    CMPX3   10,DU
         9 005710   005750 600000 9                  TZE     s:20174

     2098    20163    5                    IF (NOT CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.FLAGS.VALTEXT(
             20163                             SET_PARAM)) OR

  20163  9 005711   001706 235000 1                  LDA     SET_CAT
         9 005712   000001 735000                    ALS     1
         9 005713   600001 470505                    LDP0    1,AL,PR6
         9 005714   001707 236000 1                  LDQ     SET_PARAM
         9 005715   000014 402007                    MPY     12,DL
         9 005716   000000 236106                    LDQ     0,QL,PR0
         9 005717   004000 316003                    CANQ    2048,DU
         9 005720   005732 600000 9                  TZE     s:20167
         9 005721   001706 235000 1                  LDA     SET_CAT
         9 005722   000001 735000                    ALS     1
         9 005723   600001 470505                    LDP0    1,AL,PR6
         9 005724   001707 236000 1                  LDQ     SET_PARAM
         9 005725   000014 402007                    MPY     12,DL
         9 005726   000000 236106                    LDQ     0,QL,PR0
         9 005727   700000 676100                    ERQ     0,,PR7
         9 005730   777777 376007                    ANQ     -1,DL
         9 005731   005737 600000 9                  TZE     s:20170

     2099    20164    5                      (CAT$->CAT$TBL.PARAM$(SET_CAT)->P$TBL.VALCODE(SET_PARAM) ~= BLK$
             20164                                ->
     2100    20165    5                          O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE)
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:294  
     2101    20166    6                       THEN DO;

     2102    20167    6                          CALL PCE$ERROR(%E$P_PARSEERR,3);

  20167  9 005732   000117 630400 10                 EPPR0   79
         9 005733   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 005734   000000 701000 xent               TSX1    PCE$ERROR
         9 005735   000000 011000                    NOP     0

     2103    20168    6                          GOTO RESET_BREAK;

  20168  9 005736   007603 710000 9                  TRA     RESET_BREAK

     2104    20169    6                          END;  /* IF ERROR */
     2105    20170    5                    VALUE = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.SUBLK$(0)
             20170                             ->OUT$SYM.CODE;

  20170  9 005737   700003 470500                    LDP0    3,,PR7
         9 005740   000000 236100                    LDQ     0,,PR0
         9 005741   777777 376007                    ANQ     -1,DL
         9 005742   001712 756000 1                  STQ     VALUE

     2106    20171    5                    IF BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->O$BLK.CODE = %
             20171                             PC_FLAGVAL

  20171  9 005743   000000 103003                    CMPX3   0,DU
         9 005744   005756 601000 9                  TNZ     s:20177

     2107    20172    5                       THEN VALUE = VALUE - 1;

  20172  9 005745   000001 336007                    LCQ     1,DL
         9 005746   001712 056000 1                  ASQ     VALUE

     2108    20173    5                    END;  /* IF CODE ~= %PC_DECVAL */

  20173  9 005747   005756 710000 9                  TRA     s:20177

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:295  
     2109    20174    4                   ELSE CALL CHARBIN(VALUE,BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1)->
             20174                             OUT$SYM.TEXT);

  20174  9 005750   700004 236100                    LDQ     4,,PR7
         9 005751   000033 772000                    QRL     27
         9 005752   000000 624006                    EAX4    0,QL
         9 005753   000000 305540                    DTB
         9 005754   700004 230014                    NDSC9   4,,PR7                   cn=1,s=nosgn,sf=0,n=*X4
         9 005755   001712 000004 1                  NDSC9   VALUE                    cn=0,s=lsgnf,sf=0,n=4

     2110    20175        /**/
     2111    20176        /**/
     2112    20177    5                 IF (PARAM$ -> O$BLK.NSUBLKS ~= 0) THEN DO; /* RESOURCE          */

  20177  9 005756   500001 224100                    LDX4    1,,PR5
         9 005757   005767 600000 9                  TZE     s:20181

     2113    20178    5                    CALL GET_RES(RES_INDX,PARAM$ -> O$BLK.SUBLK$(0) -> OUT$SYM)

  20178  9 005760   500003 470500                    LDP0    3,,PR5
         9 005761   200060 450500                    STP0    @OUT_SYM,,AUTO
         9 005762   000043 236000 10                 LDQ     35
         9 005763   200057 756100                    STQ     @RES_INDEX,,AUTO
         9 005764   004605 701000 9                  TSX1    GET_RES
         9 005765   007610 702000 9                  TSX2    BAD_RES

     2114    20179    5                      ALTRET(BAD_RES);
     2115    20180    5                    END;

  20180  9 005766   005771 710000 9                  TRA     s:20183

     2116    20181    4                 ELSE RES_INDX = -1;

  20181  9 005767   000001 335007                    LCA     1,DL
         9 005770   000062 755000 1                  STA     RES_INDX

     2117    20182        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:296  
     2118    20183    4                 IF (BLK$ -> O$BLK.NSUBLKS = 2)OR /* NO OR 'ALL' INDEX           */

  20183  9 005771   000015 470400 1                  LDP0    BLK$
         9 005772   000001 220100                    LDX0    1,,PR0
         9 005773   000002 100003                    CMPX0   2,DU
         9 005774   006002 600000 9                  TZE     s:20186
         9 005775   000004 471500                    LDP1    4,,PR0
         9 005776   100003 473500                    LDP3    3,,PR1
         9 005777   300000 721100                    LXL1    0,,PR3
         9 006000   000145 101003                    CMPX1   101,DU
         9 006001   006010 601000 9                  TNZ     s:20191

     2119    20184    4                   (BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(0) -> O$BLK.CODE = %
             20184                            PC_ALLOPT)
     2120    20185    5                 THEN DO;

     2121    20186    5                    SET_INDEXLO = 0;

  20186  9 006002   001710 450000 1                  STZ     SET_INDEXLO

     2122    20187    5                    SET_INDEXHI = 15;

  20187  9 006003   000017 235007                    LDA     15,DL
         9 006004   001711 755000 1                  STA     SET_INDEXHI

     2123    20188    5                    CALL SET_VALUE;

  20188  9 006005   007767 701000 9                  TSX1    SET_VALUE
         9 006006   000000 011000                    NOP     0

     2124    20189    5                    END;

  20189  9 006007   007574 710000 9                  TRA     NEXT3

     2125    20190        /**/
     2126    20191    5                 ELSE DO K = 0 TO BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.NSUBLKS-1;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:297  
  20191  9 006010   000027 450000 1                  STZ     K
         9 006011   006050 710000 9                  TRA     s:20206+1

     2127    20192    5                    INDEX$ = BLK$ -> O$BLK.SUBLK$(1) -> O$BLK.SUBLK$(K);

  20192  9 006012   000015 470400 1                  LDP0    BLK$
         9 006013   000004 471500                    LDP1    4,,PR0
         9 006014   000027 720000 1                  LXL0    K
         9 006015   100003 236110                    LDQ     3,X0,PR1
         9 006016   000020 756000 1                  STQ     INDEX$

     2128    20193    5                    SET_INDEXLO = INDEX$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE;

  20193  9 006017   000020 473400 1                  LDP3    INDEX$
         9 006020   300003 474500                    LDP4    3,,PR3
         9 006021   400000 236100                    LDQ     0,,PR4
         9 006022   777777 376007                    ANQ     -1,DL
         9 006023   001710 756000 1                  STQ     SET_INDEXLO

     2129    20194        /**/
     2130    20195    5                    IF (INDEX$ -> O$BLK.NSUBLKS = 1) THEN

  20195  9 006024   300001 221100                    LDX1    1,,PR3
         9 006025   000001 101003                    CMPX1   1,DU
         9 006026   006031 601000 9                  TNZ     s:20198

     2131    20196    5                       SET_INDEXHI = SET_INDEXLO;

  20196  9 006027   001711 756000 1                  STQ     SET_INDEXHI
         9 006030   006045 710000 9                  TRA     s:20205

     2132    20197    6                    ELSE DO;

     2133    20198    6                       SET_INDEXHI = INDEX$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;

  20198  9 006031   300004 475500                    LDP5    4,,PR3
         9 006032   500000 236100                    LDQ     0,,PR5
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:298  
         9 006033   777777 376007                    ANQ     -1,DL
         9 006034   001711 756000 1                  STQ     SET_INDEXHI

     2134    20199        /**/
     2135    20200    7                       IF (SET_INDEXHI < SET_INDEXLO) THEN DO;

  20200  9 006035   001710 116000 1                  CMPQ    SET_INDEXLO
         9 006036   006045 605000 9                  TPL     s:20205

     2136    20201    7                          CALL PCE$ERROR(%E$P_P#RANGE,2);

  20201  9 006037   000036 630400 10                 EPPR0   30
         9 006040   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006041   000000 701000 xent               TSX1    PCE$ERROR
         9 006042   000000 011000                    NOP     0

     2137    20202    7                          RETURN;

  20202  9 006043   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 006044   000001 702211                    TSX2  ! 1,X1

     2138    20203    7                          END;
     2139    20204    6                       END;
     2140    20205    5                    CALL SET_VALUE;

  20205  9 006045   007767 701000 9                  TSX1    SET_VALUE
         9 006046   000000 011000                    NOP     0

     2141    20206    5                    END;

  20206  9 006047   000027 054000 1                  AOS     K
         9 006050   000015 470400 1                  LDP0    BLK$
         9 006051   000004 471500                    LDP1    4,,PR0
         9 006052   100001 236100                    LDQ     1,,PR1
         9 006053   000022 772000                    QRL     18
         9 006054   000027 116000 1                  CMPQ    K
         9 006055   006012 605400 9                  TPNZ    s:20192
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:299  
         9 006056   007574 710000 9                  TRA     NEXT3

     2142    20207    4               CASE(%PC_RUPARAM);

     2143    20208    4                 TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);

  20208  9 006057   400003 236100                    LDQ     3,,PR4
         9 006060   000014 756000 1                  STQ     TEMP$

     2144    20209    4                 HEAD_FID.TEXTFID_ = VECTOR(TEMP$->OUT$SYM.TEXT);

  20209  9 006061   000014 475400 1                  LDP5    TEMP$
         9 006062   500004 236100                    LDQ     4,,PR5
         9 006063   000033 772000                    QRL     27
         9 006064   000064 737000                    LLS     52
         9 006065   000140 135007                    SBLA    96,DL
         9 006066   000014 236000 1                  LDQ     TEMP$
         9 006067   000060 036000 10                 ADLQ    48
         9 006070   010756 757000 1                  STAQ    HEAD_FID+2

     2145    20210    4                 CALL M$FID(HEAD_FID) ALTRET(BAD_FID);

  20210  9 006071   010754 630400 1                  EPPR0   HEAD_FID
         9 006072   420001 713400                    CLIMB   alt,+8193
         9 006073   404400 401760                    pmme    nvectors=10
         9 006074   006516 702000 9                  TSX2    BAD_FID

     2146    20211    4                 OPEN_RU.V.FUN# = %UPDATE#;

  20211  9 006075   001000 236007                    LDQ     512,DL
         9 006076   011051 552010 1                  STBQ    OPEN_RU+37,'10'O

     2147    20212    4                 CALL M$OPEN(OPEN_RU) ALTRET(BAD_FILE);

  20212  9 006077   011004 630400 1                  EPPR0   OPEN_RU
         9 006100   450000 713400                    CLIMB   alt,open
         9 006101   410400 401760                    pmme    nvectors=18
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:300  
         9 006102   006523 702000 9                  TSX2    BAD_FILE

     2148    20213    4                 CALL M$READ(READ_HEAD) ALTRET(BAD_FILE);

  20213  9 006103   011132 630400 1                  EPPR0   READ_HEAD
         9 006104   440000 713400                    CLIMB   alt,read
         9 006105   401400 401760                    pmme    nvectors=4
         9 006106   006523 702000 9                  TSX2    BAD_FILE

     2149    20214    5                 DO J = 1 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS - 1;

  20214  9 006107   000001 235007                    LDA     1,DL
         9 006110   000026 755000 1                  STA     J
         9 006111   006503 710000 9                  TRA     s:20288+1

     2150    20215    5                    TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J);

  20215  9 006112   000015 470400 1                  LDP0    BLK$
         9 006113   000003 471500                    LDP1    3,,PR0
         9 006114   000026 720000 1                  LXL0    J
         9 006115   100003 236110                    LDQ     3,X0,PR1
         9 006116   000014 756000 1                  STQ     TEMP$

     2151    20216    5                    CODE = TEMP$->O$BLK.SUBLK$(0)->O$BLK.CODE;

  20216  9 006117   000014 473400 1                  LDP3    TEMP$
         9 006120   300003 474500                    LDP4    3,,PR3
         9 006121   400000 236100                    LDQ     0,,PR4
         9 006122   777777 376007                    ANQ     -1,DL
         9 006123   200010 756100                    STQ     CODE,,AUTO

     2152    20217    5                    TEMPNAME = TEMP$->O$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  20217  9 006124   300004 475500                    LDP5    4,,PR3
         9 006125   500004 236100                    LDQ     4,,PR5
         9 006126   000033 772000                    QRL     27
         9 006127   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:301  
         9 006130   040100 100540                    MLR     fill='040'O
         9 006131   500004 200011                    ADSC9   4,,PR5                   cn=1,n=*X1
         9 006132   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8

     2153    20218    5                    TEMPLEN = TEMP$->O$BLK.SUBLK$(1)->OUT$SYM.COUNT;

  20218  9 006133   300004 471500                    LDP1    4,,PR3
         9 006134   100004 236100                    LDQ     4,,PR1
         9 006135   000033 772000                    QRL     27
         9 006136   200053 756100                    STQ     TEMPLEN,,AUTO

     2154    20219    6                    IF CODE ~= %PC_PSEUD THEN DO;

  20219  9 006137   200010 235100                    LDA     CODE,,AUTO
         9 006140   000006 115007                    CMPA    6,DL
         9 006141   006244 600000 9                  TZE     s:20248

     2155    20220    7                       IF CODE = %PC_PSEUDO_NUM THEN DO;

  20220  9 006142   000007 115007                    CMPA    7,DL
         9 006143   006175 601000 9                  TNZ     s:20231

     2156    20221    8                          DO K = 0 TO TEMPLEN - 1;

  20221  9 006144   000027 450000 1                  STZ     K
         9 006145   006165 710000 9                  TRA     s:20227+1

     2157    20222    8                             IF SUBSTR(TEMPNAME,K,1) < '0' OR

  20222  9 006146   000027 235000 1                  LDA     K
         9 006147   040000 106505                    CMPC    fill='040'O
         9 006150   200050 000001                    ADSC9   TEMPNAME,A,AUTO          cn=0,n=1
         9 006151   000067 000001 10                 ADSC9   55                       cn=0,n=1
         9 006152   006157 602000 9                  TNC     s:20224
         9 006153   040105 106400                    CMPC    fill='040'O
         9 006154   000123 000001 10                 ADSC9   83                       cn=0,n=1
         9 006155   200050 000001                    ADSC9   TEMPNAME,A,AUTO          cn=0,n=1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:302  
         9 006156   006164 603000 9                  TRC     s:20227

     2158    20223    9                                SUBSTR(TEMPNAME,K,1) > '9' THEN DO;

     2159    20224    9                                CALL PCE$ERROR(%E$P_PARSEERR,2);

  20224  9 006157   000124 630400 10                 EPPR0   84
         9 006160   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006161   000000 701000 xent               TSX1    PCE$ERROR
         9 006162   000000 011000                    NOP     0

     2160    20225    9                                GOTO CLOSERU;

  20225  9 006163   006533 710000 9                  TRA     CLOSERU

     2161    20226    9                                END;  /* IF NON DIGIT */
     2162    20227    8                             END;  /* DO K */

  20227  9 006164   000027 054000 1                  AOS     K
         9 006165   000027 236000 1                  LDQ     K
         9 006166   200053 116100                    CMPQ    TEMPLEN,,AUTO
         9 006167   006146 604000 9                  TMI     s:20222

     2163    20228    7                          CALL CHARBIN(VALUE,SUBSTR(TEMPNAME,0,TEMPLEN));

  20228  9 006170   200053 720100                    LXL0    TEMPLEN,,AUTO
         9 006171   000000 305540                    DTB
         9 006172   200050 030010                    NDSC9   TEMPNAME,,AUTO           cn=0,s=nosgn,sf=0,n=*X0
         9 006173   001712 000004 1                  NDSC9   VALUE                    cn=0,s=lsgnf,sf=0,n=4

     2164    20229    7                          END;  /* IF CODE = %PC_PSEUDO_NUM */

  20229  9 006174   006244 710000 9                  TRA     s:20248

     2165    20230    7                       ELSE DO;

     2166    20231    7                        CALL XLATE (TEMPNAME, B$XL_UPPER, TEMPNAME);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:303  

  20231  9 006175   000000 474400 xsym               LDP4    B$XL_UPPER$
         9 006176   040100 160500                    MVT     fill='040'O
         9 006177   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8
         9 006200   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8
         9 006201   400000 000100                    ARG     0,,PR4

     2167    20232    7                          IF TEMPNAME = 'YES' OR

  20232  9 006202   040000 106500                    CMPC    fill='040'O
         9 006203   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8
         9 006204   000067 000003 2                  ADSC9   DUMP_LOCK_FMT+14         cn=0,n=3
         9 006205   006220 600000 9                  TZE     s:20236
         9 006206   040000 106500                    CMPC    fill='040'O
         9 006207   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8
         9 006210   000067 000002 2                  ADSC9   DUMP_LOCK_FMT+14         cn=0,n=2
         9 006211   006220 600000 9                  TZE     s:20236
         9 006212   200050 237100                    LDAQ    TEMPNAME,,AUTO
         9 006213   000126 117000 10                 CMPAQ   86
         9 006214   006220 600000 9                  TZE     s:20236
         9 006215   200050 237100                    LDAQ    TEMPNAME,,AUTO
         9 006216   000130 117000 10                 CMPAQ   88
         9 006217   006223 601000 9                  TNZ     s:20238

     2168    20233    7                             TEMPNAME = 'YE' OR
     2169    20234    7                             TEMPNAME = 'Y' OR
     2170    20235    7                             TEMPNAME = '1'
     2171    20236    7                             THEN VALUE = 1;

  20236  9 006220   000001 235007                    LDA     1,DL
         9 006221   001712 755000 1                  STA     VALUE
         9 006222   006244 710000 9                  TRA     s:20248

     2172    20237    7                             ELSE
     2173    20238    7                          IF TEMPNAME = 'NO' OR

  20238  9 006223   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:304  
         9 006224   200050 000010                    ADSC9   TEMPNAME,,AUTO           cn=0,n=8
         9 006225   000070 000002 2                  ADSC9   DUMP_LOCK_FMT+15         cn=0,n=2
         9 006226   006235 600000 9                  TZE     s:20241
         9 006227   200050 237100                    LDAQ    TEMPNAME,,AUTO
         9 006230   000132 117000 10                 CMPAQ   90
         9 006231   006235 600000 9                  TZE     s:20241
         9 006232   200050 237100                    LDAQ    TEMPNAME,,AUTO
         9 006233   000134 117000 10                 CMPAQ   92
         9 006234   006237 601000 9                  TNZ     s:20243

     2174    20239    7                             TEMPNAME = 'N' OR
     2175    20240    7                             TEMPNAME = '0'
     2176    20241    7                             THEN VALUE = 0;

  20241  9 006235   001712 450000 1                  STZ     VALUE
         9 006236   006244 710000 9                  TRA     s:20248

     2177    20242    8                          ELSE DO;  /* ERROR */

     2178    20243    8                             CALL PCE$ERROR(%E$P_PARSEERR,2);

  20243  9 006237   000124 630400 10                 EPPR0   84
         9 006240   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006241   000000 701000 xent               TSX1    PCE$ERROR
         9 006242   000000 011000                    NOP     0

     2179    20244    8                             GOTO CLOSERU;

  20244  9 006243   006533 710000 9                  TRA     CLOSERU

     2180    20245    8                             END;  /* ELSE ERROR */
     2181    20246    7                          END;  /* ELSE */
     2182    20247    6                       END;  /* IF CODE ~= %PC_PSEUD */
     2183    20248    6                    DO CASE(CODE);

  20248  9 006244   200010 235100                    LDA     CODE,,AUTO
         9 006245   000011 115007                    CMPA    9,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:305  
         9 006246   006250 602005 9                  TNC     s:20248+4,AL
         9 006247   006502 710000 9                  TRA     s:20288
         9 006250   006502 710000 9                  TRA     s:20288
         9 006251   006261 710000 9                  TRA     s:20250
         9 006252   006270 710000 9                  TRA     s:20252
         9 006253   006277 710000 9                  TRA     s:20254
         9 006254   006306 710000 9                  TRA     s:20256
         9 006255   006315 710000 9                  TRA     s:20258
         9 006256   006324 710000 9                  TRA     s:20260
         9 006257   006331 710000 9                  TRA     s:20263
         9 006260   006342 710000 9                  TRA     s:20267

     2184    20249    6                       CASE(%PC_NOCHGPMEM);

     2185    20250    6                          B$HEAD.NOCHGPMEM = BINBIT(VALUE,1);

  20250  9 006261   001712 236000 1                  LDQ     VALUE
         9 006262   000043 736000                    QLS     35
         9 006263   000020 772000                    QRL     16
         9 006264   002364 676000 1                  ERQ     B$HEAD+18
         9 006265   000002 376003                    ANQ     2,DU
         9 006266   002364 656000 1                  ERSQ    B$HEAD+18
         9 006267   006502 710000 9                  TRA     s:20288

     2186    20251    6                       CASE(%PC_SHARE);

     2187    20252    6                          B$HEAD.S = BINBIT(VALUE,1);

  20252  9 006270   001712 236000 1                  LDQ     VALUE
         9 006271   000043 736000                    QLS     35
         9 006272   000011 772000                    QRL     9
         9 006273   002364 676000 1                  ERQ     B$HEAD+18
         9 006274   000400 376003                    ANQ     256,DU
         9 006275   002364 656000 1                  ERSQ    B$HEAD+18
         9 006276   006502 710000 9                  TRA     s:20288

     2188    20253    6                       CASE(%PC_PROCACC);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:306  

     2189    20254    6                          B$HEAD.PROCACC = BINBIT(VALUE,1);

  20254  9 006277   001712 236000 1                  LDQ     VALUE
         9 006300   000043 736000                    QLS     35
         9 006301   000017 772000                    QRL     15
         9 006302   002364 676000 1                  ERQ     B$HEAD+18
         9 006303   000004 376003                    ANQ     4,DU
         9 006304   002364 656000 1                  ERSQ    B$HEAD+18
         9 006305   006502 710000 9                  TRA     s:20288

     2190    20255    6                       CASE(%PC_PROCSURCHG);

     2191    20256    6                          B$HEAD.PROCSURCHG = BINBIT(VALUE,1);

  20256  9 006306   001712 236000 1                  LDQ     VALUE
         9 006307   000043 736000                    QLS     35
         9 006310   000021 772000                    QRL     17
         9 006311   002364 676000 1                  ERQ     B$HEAD+18
         9 006312   000001 376003                    ANQ     1,DU
         9 006313   002364 656000 1                  ERSQ    B$HEAD+18
         9 006314   006502 710000 9                  TRA     s:20288

     2192    20257    6                       CASE(%PC_STATS);

     2193    20258    6                          B$HEAD.STATS = BINBIT(VALUE,1);

  20258  9 006315   001712 236000 1                  LDQ     VALUE
         9 006316   000043 736000                    QLS     35
         9 006317   000040 772000                    QRL     32
         9 006320   002353 676000 1                  ERQ     B$HEAD+9
         9 006321   000010 376007                    ANQ     8,DL
         9 006322   002353 656000 1                  ERSQ    B$HEAD+9
         9 006323   006502 710000 9                  TRA     s:20288

     2194    20259    6                       CASE(%PC_PSEUD);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:307  
     2195    20260    6                          B$HEAD.PSEUDO_TEXT = TEMPNAME;

  20260  9 006324   200050 237100                    LDAQ    TEMPNAME,,AUTO
         9 006325   002366 757000 1                  STAQ    B$HEAD+20

     2196    20261    6                          B$HEAD.PSEUDO_COUNT = 1;

  20261  9 006326   001000 236003                    LDQ     512,DU
         9 006327   002365 552040 1                  STBQ    B$HEAD+19,'40'O
         9 006330   006502 710000 9                  TRA     s:20288

     2197    20262    6                       CASE(%PC_PSEUDO_NUM);

     2198    20263    6                          B$HEAD.PSEUDO_COUNT = VALUE;

  20263  9 006331   001712 236000 1                  LDQ     VALUE
         9 006332   000033 736000                    QLS     27
         9 006333   002365 552040 1                  STBQ    B$HEAD+19,'40'O

     2199    20264    6                          IF VALUE = 0

  20264  9 006334   001712 236000 1                  LDQ     VALUE
         9 006335   006502 601000 9                  TNZ     s:20288

     2200    20265    6                             THEN B$HEAD.PSEUDO_TEXT = ' ';

  20265  9 006336   000035 235000 xsym               LDA     B_VECTNIL+29
         9 006337   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 006340   002366 757000 1                  STAQ    B$HEAD+20
         9 006341   006502 710000 9                  TRA     s:20288

     2201    20266    6                       CASE(%PC_LOCK);

     2202    20267    6                          TEMP1$ = TEMP$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0);

  20267  9 006342   000014 470400 1                  LDP0    TEMP$
         9 006343   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:308  
         9 006344   100003 236100                    LDQ     3,,PR1
         9 006345   200003 756100                    STQ     TEMP1$,,AUTO

     2203    20268    6                          B$HEAD.STRONG_LOCK = BINBIT(TEMP1$->O$BLK.CODE,1);

  20268  9 006346   200003 473500                    LDP3    TEMP1$,,AUTO
         9 006347   300000 236100                    LDQ     0,,PR3
         9 006350   777777 376007                    ANQ     -1,DL
         9 006351   000043 736000                    QLS     35
         9 006352   000023 772000                    QRL     19
         9 006353   002364 676000 1                  ERQ     B$HEAD+18
         9 006354   200000 376007                    ANQ     65536,DL
         9 006355   002364 656000 1                  ERSQ    B$HEAD+18

     2204    20269    7                          DO K = 0 TO TEMP1$->O$BLK.NSUBLKS - 1;

  20269  9 006356   000027 450000 1                  STZ     K
         9 006357   006463 710000 9                  TRA     s:20285+1

     2205    20270    8                             DO CASE(TEMP1$->O$BLK.SUBLK$(K)->O$BLK.CODE);

  20270  9 006360   200003 470500                    LDP0    TEMP1$,,AUTO
         9 006361   000027 720000 1                  LXL0    K
         9 006362   000003 471510                    LDP1    3,X0,PR0
         9 006363   100000 721100                    LXL1    0,,PR1
         9 006364   000003 101003                    CMPX1   3,DU
         9 006365   006367 602011 9                  TNC     s:20270+7,X1
         9 006366   006430 710000 9                  TRA     s:20278
         9 006367   006430 710000 9                  TRA     s:20278
         9 006370   006372 710000 9                  TRA     s:20272
         9 006371   006405 710000 9                  TRA     s:20275

     2206    20271    8                                CASE(%PC_SING);

     2207    20272    8                                   CALL CHARBIN(FIRST_BIT,TEMP1$->O$BLK.SUBLK$(K)->
             20272                                            O$BLK.SUBLK$(0)->OUT$SYM.TEXT);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:309  
  20272  9 006372   100003 473500                    LDP3    3,,PR1
         9 006373   300004 236100                    LDQ     4,,PR3
         9 006374   000033 772000                    QRL     27
         9 006375   000000 622006                    EAX2    0,QL
         9 006376   000100 305540                    DTB
         9 006377   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         9 006400   200076 000010                    NDSC9   TEMPTEXT+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 006401   200077 235100                    LDA     TEMPTEXT+5,,AUTO
         9 006402   200004 755100                    STA     FIRST_BIT,,AUTO

     2208    20273    8                                   LAST_BIT = FIRST_BIT;

  20273  9 006403   200005 755100                    STA     LAST_BIT,,AUTO
         9 006404   006430 710000 9                  TRA     s:20278

     2209    20274    8                                CASE(%PC_RANGE);

     2210    20275    8                                   CALL CHARBIN(FIRST_BIT,TEMP1$->O$BLK.SUBLK$(K)->
             20275                                            O$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  20275  9 006405   100003 473500                    LDP3    3,,PR1
         9 006406   300004 236100                    LDQ     4,,PR3
         9 006407   000033 772000                    QRL     27
         9 006410   000000 622006                    EAX2    0,QL
         9 006411   000100 305540                    DTB
         9 006412   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         9 006413   200076 000010                    NDSC9   TEMPTEXT+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 006414   200077 235100                    LDA     TEMPTEXT+5,,AUTO
         9 006415   200004 755100                    STA     FIRST_BIT,,AUTO

     2211    20276    8                                  CALL CHARBIN(LAST_BIT,TEMP1$->O$BLK.SUBLK$(K)->O$BLK
             20276                                            .SUBLK$(1)->OUT$SYM.TEXT);

  20276  9 006416   000003 471510                    LDP1    3,X0,PR0
         9 006417   100004 473500                    LDP3    4,,PR1
         9 006420   300004 236100                    LDQ     4,,PR3
         9 006421   000033 772000                    QRL     27
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:310  
         9 006422   000000 621006                    EAX1    0,QL
         9 006423   000100 305540                    DTB
         9 006424   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         9 006425   200076 000010                    NDSC9   TEMPTEXT+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 006426   200077 236100                    LDQ     TEMPTEXT+5,,AUTO
         9 006427   200005 756100                    STQ     LAST_BIT,,AUTO

     2212    20277    8                                END;  /* DO CASE CODE */

     2213    20278    8                             IF (LAST_BIT > 72) OR (FIRST_BIT < 1) THEN DO;

  20278  9 006430   200005 235100                    LDA     LAST_BIT,,AUTO
         9 006431   000111 115007                    CMPA    73,DL
         9 006432   006435 603000 9                  TRC     s:20279
         9 006433   200004 236100                    LDQ     FIRST_BIT,,AUTO
         9 006434   006442 601000 9                  TNZ     s:20282

     2214    20279    8                                CALL PCE$ERROR(%E$P_BADLOCKBIT,3);

  20279  9 006435   000137 630400 10                 EPPR0   95
         9 006436   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006437   000000 701000 xent               TSX1    PCE$ERROR
         9 006440   000000 011000                    NOP     0

     2215    20280    8                                GOTO CLOSERU;

  20280  9 006441   006533 710000 9                  TRA     CLOSERU

     2216    20281    8                                END;  /* IF LAST_BIT > 72 */
     2217    20282    8                             DO L = FIRST_BIT TO LAST_BIT;

  20282  9 006442   000030 756000 1                  STQ     L
         9 006443   006456 710000 9                  TRA     s:20284+1

     2218    20283    8                                B$HEAD.LOCK(L-1) = BINBIT(VALUE,1);

  20283  9 006444   001712 236000 1                  LDQ     VALUE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:311  
         9 006445   000043 736000                    QLS     35
         9 006446   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 006447   000030 235000 1                  LDA     L
         9 006450   006452 605000 9                  TPL     s:20283+6
         9 006451   000044 035003                    ADLA    36,DU
         9 006452   003005 060500                    CSL     bolr='003'O
         9 006453   200076 000044                    BDSC    TEMPTEXT+4,,AUTO         by=0,bit=0,n=36
         9 006454   002361 700001 1                  BDSC    B$HEAD+15,A              by=3,bit=8,n=1

     2219    20284    8                                END;  /* DO L */

  20284  9 006455   000030 054000 1                  AOS     L
         9 006456   200005 236100                    LDQ     LAST_BIT,,AUTO
         9 006457   006444 604000 9                  TMI     s:20283
         9 006460   000030 116000 1                  CMPQ    L
         9 006461   006444 605000 9                  TPL     s:20283

     2220    20285    7                             END;  /* DO K */

  20285  9 006462   000027 054000 1                  AOS     K
         9 006463   200003 470500                    LDP0    TEMP1$,,AUTO
         9 006464   000001 236100                    LDQ     1,,PR0
         9 006465   000022 772000                    QRL     18
         9 006466   000027 116000 1                  CMPQ    K
         9 006467   006360 605400 9                  TPNZ    s:20270

     2221    20286    6                          B$HEAD.RESTPROC = (B$HEAD.LOCK ~= '0'B);

  20286  9 006470   400000 220003                    LDX0    -131072,DU
         9 006471   002362 237000 1                  LDAQ    B$HEAD+16
         9 006472   000142 117000 10                 CMPAQ   98
         9 006473   006475 601000 9                  TNZ     s:20286+5
         9 006474   000000 220003                    LDX0    0,DU
         9 006475   000000 636010                    EAQ     0,X0
         9 006476   000022 772000                    QRL     18
         9 006477   002364 676000 1                  ERQ     B$HEAD+18
         9 006500   400000 376007                    ANQ     -131072,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:312  
         9 006501   002364 656000 1                  ERSQ    B$HEAD+18

     2222    20287    6                       END;  /* DO CASE RUPARAM CODE */

     2223    20288    5                    END;  /* DO J */

  20288  9 006502   000026 054000 1                  AOS     J
         9 006503   000015 470400 1                  LDP0    BLK$
         9 006504   000003 471500                    LDP1    3,,PR0
         9 006505   100001 236100                    LDQ     1,,PR1
         9 006506   000022 772000                    QRL     18
         9 006507   000026 116000 1                  CMPQ    J
         9 006510   006112 605400 9                  TPNZ    s:20215

     2224    20289    4                 CALL M$WRITE(WRITE_HEAD) ALTRET(BAD_FILE);

  20289  9 006511   011150 630400 1                  EPPR0   WRITE_HEAD
         9 006512   440001 713400                    CLIMB   alt,write
         9 006513   401400 401760                    pmme    nvectors=4
         9 006514   006523 702000 9                  TSX2    BAD_FILE

     2225    20290    5                 DO WHILE('0'B);  /* DO NEVER */

  20290  9 006515   006522 710000 9                  TRA     s:20293

     2226    20291    5           BAD_FID: CALL PCE$ERROR(0,3);

  20291  9 006516   000033 630400 10    BAD_FID      EPPR0   27
         9 006517   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006520   000000 701000 xent               TSX1    PCE$ERROR
         9 006521   000000 011000                    NOP     0

     2227    20292    5                    END;  /* DO NEVER */

     2228    20293    5                 DO WHILE('0'B);  /* DO NEVER */

  20293  9 006522   006533 710000 9                  TRA     CLOSERU
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:313  

     2229    20294    5        BAD_FILE:   CALL PCE$ERROR(0,3);

  20294  9 006523   000033 630400 10    BAD_FILE     EPPR0   27
         9 006524   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006525   000000 701000 xent               TSX1    PCE$ERROR
         9 006526   000000 011000                    NOP     0

     2230    20295    5                    CALL PCE$ERROR(%E$P_BADRU,3);

  20295  9 006527   000145 630400 10                 EPPR0   101
         9 006530   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006531   000000 701000 xent               TSX1    PCE$ERROR
         9 006532   000000 011000                    NOP     0

     2231    20296    5                    END;  /* DO NEVER */

     2232    20297    4   CLOSERU:      IF DCBADDR(DCBNUM(M$HEAD))->F$DCB.FCD#

  20297  9 006533   000000 236007 xsym  CLOSERU      LDQ     M$HEAD,DL
         9 006534   000000 470400 10                 LDP0    0
         9 006535   000000 471500                    LDP1    0,,PR0
         9 006536   100000 473506                    LDP3    0,QL,PR1
         9 006537   300031 236100                    LDQ     25,,PR3
         9 006540   020000 316007                    CANQ    8192,DL
         9 006541   006546 600000 9                  TZE     s:20299

     2233    20298    4                    THEN CALL M$CLOSE(CLOSE_RU) ALTRET(BAD_CLOSE);

  20298  9 006542   011176 630400 1                  EPPR0   CLOSE_RU
         9 006543   450001 713400                    CLIMB   alt,close
         9 006544   406000 401760                    pmme    nvectors=13
         9 006545   006547 702000 9                  TSX2    BAD_CLOSE

     2234    20299    5                 DO WHILE('0'B);  /* DO NEVER */

  20299  9 006546   007574 710000 9                  TRA     NEXT3
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:314  

     2235    20300    5        BAD_CLOSE:  CALL PCE$ERROR(0,3);

  20300  9 006547   000033 630400 10    BAD_CLOSE    EPPR0   27
         9 006550   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006551   000000 701000 xent               TSX1    PCE$ERROR
         9 006552   000000 011000                    NOP     0

     2236    20301    5                    END;  /* DO NEVER */

  20301  9 006553   007574 710000 9                  TRA     NEXT3

     2237    20302        /*E* ERROR: PCC-E$P_BADLOCKBIT-0
     2238    20303             MESSAGE:  Bad lockbit value - must be from 1 to 72.
     2239    20304             DESCRIPTION: See message                  */
     2240    20305        /*E* ERROR: PCC-E$P_BADRU-0
     2241    20306             MESSAGE:  Unable to set bits in HEAD record of specified rununit.
     2242    20307             DESCRIPTION:  Cant get at the HEAD record to make changes requested */
     2243    20308        /**/
     2244    20309        /**/
     2245    20310    4               CASE(%PC_TP);

     2246    20311    4                 CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(NO_TP_FILE);

  20311  9 006554   010456 630400 1                  EPPR0   OPEN_TP_CNTRL
         9 006555   450000 713400                    CLIMB   alt,open
         9 006556   410400 401760                    pmme    nvectors=18
         9 006557   006573 702000 9                  TSX2    NO_TP_FILE

     2247    20312    4                 TABLE$ = B$DS5$;

  20312  9 006560   000000 236000 xsym               LDQ     B$DS5$
         9 006561   200030 756100                    STQ     TABLE$,,AUTO

     2248    20313    4                 CUR_SIZE_OF_DATA = SIZEW(PC$HDR) + PC$HDR.CURINSTANCES * SIZEW(
             20313                          PC$INSTANCE);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:315  
  20313  9 006562   000000 470400 xsym               LDP0    B$DS5$
         9 006563   000000 236100                    LDQ     0,,PR0
         9 006564   000113 402007                    MPY     75,DL
         9 006565   000001 036007                    ADLQ    1,DL
         9 006566   200027 756100                    STQ     CUR_SIZE_OF_DATA,,AUTO

     2249    20314    4                 TABLE$ = PINCRW(TABLE$,CUR_SIZE_OF_DATA);

  20314  9 006567   000022 736000                    QLS     18
         9 006570   200030 036100                    ADLQ    TABLE$,,AUTO
         9 006571   200030 756100                    STQ     TABLE$,,AUTO

     2250    20315    5                 DO WHILE('0'B);           /* DO NEVER                           */

  20315  9 006572   006656 710000 9                  TRA     s:20346

     2251    20316    5       NO_TP_FILE:  IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE

  20316  9 006573   000000 470400 xsym  NO_TP_FILE   LDP0    B$TCB$
         9 006574   000000 471500                    LDP1    0,,PR0
         9 006575   100102 236100                    LDQ     66,,PR1
         9 006576   377770 376007                    ANQ     131064,DL
         9 006577   001610 116007                    CMPQ    904,DL
         9 006600   006651 601000 9                  TNZ     s:20342

     2252    20317    5                       THEN                /* CREATE THE FILE                    */
     2253    20318    6                       DO;

     2254    20319    7                          IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;

  20319  9 006601   000000 473400 xsym               LDP3    B$JIT$
         9 006602   300015 236100                    LDQ     13,,PR3
         9 006603   000056 376000 2                  ANQ     DUMP_LOCK_FMT+5
         9 006604   006611 601000 9                  TNZ     NEXT1

     2255    20320    7                             CALL M$SPRIV(FMS_PRIV) ALTRET(NEXT1);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:316  
  20320  9 006605   011234 630400 1                  EPPR0   FMS_PRIV
         9 006606   420012 713400                    CLIMB   alt,+8202
         9 006607   400000 401760                    pmme    nvectors=1
         9 006610   006611 702000 9                  TSX2    NEXT1

  20320  9 006611                       NEXT1        null
     2256    20321    7                       NEXT1:;
     2257    20322    7                             END;  /* IF */

     2258    20323    6                          OPEN_TP_CNTRL.V.FUN# = %CREATE#;

  20323  9 006611   003000 236007                    LDQ     1536,DL
         9 006612   010523 552010 1                  STBQ    OPEN_TP_CNTRL+37,'10'O

     2259    20324    6                          CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(BAD_TP);

  20324  9 006613   010456 630400 1                  EPPR0   OPEN_TP_CNTRL
         9 006614   450000 713400                    CLIMB   alt,open
         9 006615   410400 401760                    pmme    nvectors=18
         9 006616   006620 702000 9                  TSX2    BAD_TP

     2260    20325    7                          DO WHILE('0'B);  /* DO NEVER */

  20325  9 006617   006635 710000 9                  TRA     s:20333

     2261    20326    8           BAD_TP:           IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;

  20326  9 006620   000000 470400 xsym  BAD_TP       LDP0    B$JIT$
         9 006621   000015 236100                    LDQ     13,,PR0
         9 006622   000056 376000 2                  ANQ     DUMP_LOCK_FMT+5
         9 006623   006630 601000 9                  TNZ     NEXT2

     2262    20327    8                                CALL M$RPRIV(FMS_PRIV) ALTRET(NEXT2);

  20327  9 006624   011234 630400 1                  EPPR0   FMS_PRIV
         9 006625   420013 713400                    CLIMB   alt,+8203
         9 006626   400000 401760                    pmme    nvectors=1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:317  
         9 006627   006630 702000 9                  TSX2    NEXT2

  20327  9 006630                       NEXT2        null
     2263    20328    8                          NEXT2:;
     2264    20329    8                                END;  /* IF */

     2265    20330    7                             CALL PCE$ERROR(%E$P_BADTPFILE,3);

  20330  9 006630   000150 630400 10                 EPPR0   104
         9 006631   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006632   000000 701000 xent               TSX1    PCE$ERROR
         9 006633   000000 011000                    NOP     0

     2266    20331    7                             GOTO CLEANUP;

  20331  9 006634   007552 710000 9                  TRA     CLEANUP

     2267    20332    7                             END;  /* DO NEVER */

     2268    20333    6                          OPEN_TP_CNTRL.V.FUN# = %UPDATE#;

  20333  9 006635   001000 236007                    LDQ     512,DL
         9 006636   010523 552010 1                  STBQ    OPEN_TP_CNTRL+37,'10'O

     2269    20334    6                          TABLE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20334  9 006637   000000 236000 xsym               LDQ     B$DS5$
         9 006640   000001 036003                    ADLQ    1,DU
         9 006641   200030 756100                    STQ     TABLE$,,AUTO

     2270    20335    6                          PC$HDR.CURINSTANCES = 0;

  20335  9 006642   000000 470400 xsym               LDP0    B$DS5$
         9 006643   000000 450100                    STZ     0,,PR0

     2271    20336    6                          WORDS_AVAIL = %WORDS_PER_GRAN - SIZEW(PC$HDR);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:318  
  20336  9 006644   001777 235007                    LDA     1023,DL
         9 006645   001733 755000 1                  STA     WORDS_AVAIL

     2272    20337    6                          CURINSTANCES = 0;

  20337  9 006646   000031 450000 1                  STZ     CURINSTANCES

     2273    20338    6                          TBLINSTANCES = 0;

  20338  9 006647   000032 450000 1                  STZ     TBLINSTANCES

     2274    20339    6                       END;

  20339  9 006650   006656 710000 9                  TRA     s:20346

     2275    20340    5                       ELSE
     2276    20341    6                       DO;

     2277    20342    6                          CALL PCE$ERROR(%E$P_BADTPFILE,3);

  20342  9 006651   000150 630400 10                 EPPR0   104
         9 006652   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006653   000000 701000 xent               TSX1    PCE$ERROR
         9 006654   000000 011000                    NOP     0

     2278    20343    6                          GOTO CLEANUP;

  20343  9 006655   007552 710000 9                  TRA     CLEANUP

     2279    20344    6                       END;                /* ELSE                               */
     2280    20345    5                 END;                      /* DO NEVER                           */

     2281    20346    5                 DO CASE(BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.CODE);

  20346  9 006656   000015 470400 1                  LDP0    BLK$
         9 006657   000003 471500                    LDP1    3,,PR0
         9 006660   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:319  
         9 006661   300000 720100                    LXL0    0,,PR3
         9 006662   000004 100003                    CMPX0   4,DU
         9 006663   006665 602010 9                  TNC     s:20346+7,X0
         9 006664   007552 710000 9                  TRA     CLEANUP
         9 006665   007552 710000 9                  TRA     CLEANUP
         9 006666   006671 710000 9                  TRA     s:20348
         9 006667   007256 710000 9                  TRA     s:20434
         9 006670   007076 710000 9                  TRA     s:20393

     2282    20347    5                    CASE(%PC_TPINSTANCE);

     2283    20348    6                       DO J = 0 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1)->O$BLK.
             20348                                NSUBLKS - 1;

  20348  9 006671   000026 450000 1                  STZ     J
         9 006672   007066 710000 9                  TRA     L1+1

     2284    20349    6                         INSTANCE_NAME = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1)->O$BLK
             20349                                   .SUBLK$(J)->OUT$SYM.TEXT;

  20349  9 006673   000015 470400 1                  LDP0    BLK$
         9 006674   000003 471500                    LDP1    3,,PR0
         9 006675   100004 473500                    LDP3    4,,PR1
         9 006676   000026 720000 1                  LXL0    J
         9 006677   300003 474510                    LDP4    3,X0,PR3
         9 006700   400004 236100                    LDQ     4,,PR4
         9 006701   000033 772000                    QRL     27
         9 006702   000000 621006                    EAX1    0,QL
         9 006703   040100 100540                    MLR     fill='040'O
         9 006704   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         9 006705   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8

     2285    20350    6                          INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20350  9 006706   000000 236000 xsym               LDQ     B$DS5$
         9 006707   000001 036003                    ADLQ    1,DU
         9 006710   200031 756100                    STQ     INSTANCE$,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:320  

     2286    20351    7                          DO K = 0 TO PC$HDR.CURINSTANCES - 1;

  20351  9 006711   000027 450000 1                  STZ     K
         9 006712   006746 710000 9                  TRA     s:20362+1

     2287    20352    7                             IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND

  20352  9 006713   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 006714   040100 106500                    CMPC    fill='040'O
         9 006715   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         9 006716   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 006717   006742 601000 9                  TNZ     s:20361
         9 006720   000003 236100                    LDQ     3,,PR0
         9 006721   200000 316003                    CANQ    65536,DU
         9 006722   006742 601000 9                  TNZ     s:20361

     2288    20353    7                                NOT PC$INSTANCE.FLAGS.DELETED
     2289    20354    7                                THEN          /* DUPLICATE INSTANCE NAME            */
     2290    20355    8                                DO;

     2291    20356    8                                   SUB_BUF_1.COUNT = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20356                                            SUBLK$(1)->O$BLK.SUBLK$(J)->OUT$SYM.COUNT;

  20356  9 006723   000015 471400 1                  LDP1    BLK$
         9 006724   100003 473500                    LDP3    3,,PR1
         9 006725   300004 474500                    LDP4    4,,PR3
         9 006726   000026 720000 1                  LXL0    J
         9 006727   400003 475510                    LDP5    3,X0,PR4
         9 006730   500004 236100                    LDQ     4,,PR5
         9 006731   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     2292    20357    8                                   SUB_BUF_1.TEXT = INSTANCE_NAME;

  20357  9 006732   040000 100500                    MLR     fill='040'O
         9 006733   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 006734   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:321  

     2293    20358    8                                   CALL PCE$ERROR(%E$P_DUP_INSTANCE,3);

  20358  9 006735   000153 630400 10                 EPPR0   107
         9 006736   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 006737   000000 701000 xent               TSX1    PCE$ERROR
         9 006740   000000 011000                    NOP     0

     2294    20359    8                                   GOTO L1;

  20359  9 006741   007065 710000 9                  TRA     L1

     2295    20360    8                                END;          /* IF                                 */
     2296    20361    7                             INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

  20361  9 006742   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 006743   000113 036003                    ADLQ    75,DU
         9 006744   200031 756100                    STQ     INSTANCE$,,AUTO

     2297    20362    7                          END;                /* DO K                               */

  20362  9 006745   000027 054000 1                  AOS     K
         9 006746   000000 470400 xsym               LDP0    B$DS5$
         9 006747   000027 236000 1                  LDQ     K
         9 006750   006713 604000 9                  TMI     s:20352
         9 006751   000000 116100                    CMPQ    0,,PR0
         9 006752   006713 602000 9                  TNC     s:20352

     2298    20363
     2299    20364                               /* Now check for any available space already in the
     2300    20365                                  file.  If there is none, then call GBLK to get some */
     2301    20366    6                          INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20366  9 006753   000000 236000 xsym               LDQ     B$DS5$
         9 006754   000001 036003                    ADLQ    1,DU
         9 006755   200031 756100                    STQ     INSTANCE$,,AUTO

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:322  
     2302    20367    6                          TBLINDX = 0;

  20367  9 006756   200037 450100                    STZ     TBLINDX,,AUTO

     2303    20368    7                          DO K = 0 TO TBLINSTANCES - 1;

  20368  9 006757   000027 450000 1                  STZ     K
         9 006760   006772 710000 9                  TRA     s:20373+1

     2304    20369    7                             IF PC$INSTANCE.FLAGS.DELETED

  20369  9 006761   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 006762   000003 236100                    LDQ     3,,PR0
         9 006763   200000 316003                    CANQ    65536,DU
         9 006764   007010 601000 9                  TNZ     ADD_INSTANCE

     2305    20370    7                                THEN GOTO ADD_INSTANCE;
     2306    20371    7                             TBLINDX = TBLINDX + 1;

  20371  9 006765   200037 054100                    AOS     TBLINDX,,AUTO

     2307    20372    7                             INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

  20372  9 006766   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 006767   000113 036003                    ADLQ    75,DU
         9 006770   200031 756100                    STQ     INSTANCE$,,AUTO

     2308    20373    7                             END;  /* DO K */

  20373  9 006771   000027 054000 1                  AOS     K
         9 006772   000027 236000 1                  LDQ     K
         9 006773   000032 116000 1                  CMPQ    TBLINSTANCES
         9 006774   006761 604000 9                  TMI     s:20369

     2309    20374    6                          CALL GBLK(INSTANCE$,SIZEW(PC$INSTANCE)) ALTRET(NO_MEM);

  20374  9 006775   000156 236000 10                 LDQ     110
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:323  
         9 006776   200060 756100                    STQ     @OUT_SYM,,AUTO
         9 006777   200031 630500                    EPPR0   INSTANCE$,,AUTO
         9 007000   200057 450500                    STP0    @RES_INDEX,,AUTO
         9 007001   012214 701000 9                  TSX1    GBLK
         9 007002   007616 702000 9                  TSX2    NO_MEM

     2310    20375    6                          PC$HDR.CURINSTANCES = PC$HDR.CURINSTANCES + 1;

  20375  9 007003   000000 470400 xsym               LDP0    B$DS5$
         9 007004   000000 235100                    LDA     0,,PR0
         9 007005   000001 035007                    ADLA    1,DL
         9 007006   000000 755100                    STA     0,,PR0

     2311    20376    6                          TBLINSTANCES = TBLINSTANCES + 1;

  20376  9 007007   000032 054000 1                  AOS     TBLINSTANCES

     2312    20377    6           ADD_INSTANCE:  PC$INSTANCE = '0'B;

  20377  9 007010   200031 470500       ADD_INSTANCE LDP0    INSTANCE$,,AUTO
         9 007011   000100 100400                    MLR     fill='000'O
         9 007012   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 007013   000000 000454                    ADSC9   0,,PR0                   cn=0,n=300

     2313    20378    6                          PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME;

  20378  9 007014   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007015   040100 100500                    MLR     fill='040'O
         9 007016   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 007017   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     2314    20379    6                          PC$INSTANCE.MAXTPU = %DEFAULT_MAXTPU;

  20379  9 007020   000061 235007                    LDA     49,DL
         9 007021   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007022   000002 755100                    STA     2,,PR0

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:324  
     2315    20380    6                          PC$INSTANCE.STATS  = '0'B;

  20380  9 007023   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007024   000100 100400                    MLR     fill='000'O
         9 007025   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 007026   000031 000310                    ADSC9   25,,PR0                  cn=0,n=200

     2316    20381    6                          MAXTPU_TBL.FLAGS.DELETED(TBLINDX) = '0'B;

  20381  9 007027   200037 236100                    LDQ     TBLINDX,,AUTO
         9 007030   000002 736000                    QLS     2
         9 007031   000000 620006                    EAX0    0,QL
         9 007032   000157 236000 10                 LDQ     111
         9 007033   004562 356010 1                  ANSQ    MAXTPU_TBL+3,X0

     2317    20382    6                          MAXTPU_TBL.NAME(TBLINDX) = INSTANCE_NAME;

  20382  9 007034   000000 635010                    EAA     0,X0
         9 007035   000020 731000                    ARS     16
         9 007036   040005 100500                    MLR     fill='040'O
         9 007037   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 007040   004557 000010 1                  ADSC9   MAXTPU_TBL,A             cn=0,n=8

     2318    20383    6                          MAXTPU_TBL.COUNT(TBLINDX) = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20383                                   SUBLK$(1)->

  20383  9 007041   000015 470400 1                  LDP0    BLK$
         9 007042   000003 471500                    LDP1    3,,PR0
         9 007043   100004 473500                    LDP3    4,,PR1
         9 007044   000026 721000 1                  LXL1    J
         9 007045   300003 474511                    LDP4    3,X1,PR3
         9 007046   400004 236100                    LDQ     4,,PR4
         9 007047   000033 772000                    QRL     27
         9 007050   000000 622006                    EAX2    0,QL
         9 007051   004562 742010 1                  STX2    MAXTPU_TBL+3,X0

     2319    20384    6                             O$BLK.SUBLK$(J)->OUT$SYM.COUNT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:325  
     2320    20385    6                          MAXTPU_TBL.MAXTPU(TBLINDX) = %DEFAULT_MAXTPU;

  20385  9 007052   000061 235007                    LDA     49,DL
         9 007053   004561 755010 1                  STA     MAXTPU_TBL+2,X0

     2321    20386    6                          MAXTPU_TBL.FLAGS.PRINT(TBLINDX) = TP_TBL.MAXTPU.FLAGS.PRINT;

  20386  9 007054   004522 236000 1                  LDQ     TP_TBL+36
         9 007055   000022 772000                    QRL     18
         9 007056   004562 676010 1                  ERQ     MAXTPU_TBL+3,X0
         9 007057   400000 376007                    ANQ     -131072,DL
         9 007060   004562 656010 1                  ERSQ    MAXTPU_TBL+3,X0

     2322    20387    6                          IF TP_TBL.MAXTPU.FLAGS.PRINT

  20387  9 007061   004522 234000 1                  SZN     TP_TBL+36
         9 007062   007064 605000 9                  TPL     s:20389

     2323    20388    6                             THEN TP_TBL.MAXTPU.MAX = TP_TBL.MAXTPU.MAX + 1;

  20388  9 007063   004533 054000 1                  AOS     TP_TBL+45

     2324    20389    6                          CURINSTANCES = CURINSTANCES + 1;

  20389  9 007064   000031 054000 1                  AOS     CURINSTANCES

     2325    20390    6                 L1:
     2326    20391    6                          END;  /* DO J */

  20391  9 007065   000026 054000 1     L1           AOS     J
         9 007066   000015 470400 1                  LDP0    BLK$
         9 007067   000003 471500                    LDP1    3,,PR0
         9 007070   100004 473500                    LDP3    4,,PR1
         9 007071   300001 236100                    LDQ     1,,PR3
         9 007072   000022 772000                    QRL     18
         9 007073   000026 116000 1                  CMPQ    J
         9 007074   006673 605400 9                  TPNZ    s:20349
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:326  
         9 007075   007552 710000 9                  TRA     CLEANUP

     2327    20392    5                    CASE(%PC_MAXTPU);

     2328    20393    5                       TEMP1 = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS;

  20393  9 007076   300001 236100                    LDQ     1,,PR3
         9 007077   000022 772000                    QRL     18
         9 007100   000023 756000 1                  STQ     TEMP1

     2329    20394    5                       TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1);

  20394  9 007101   000003 471500                    LDP1    3,,PR0
         9 007102   100004 236100                    LDQ     4,,PR1
         9 007103   000014 756000 1                  STQ     TEMP$

     2330    20395    5                       CALL CHARBIN(VALUE,TEMP$->OUT$SYM.TEXT);

  20395  9 007104   000014 473400 1                  LDP3    TEMP$
         9 007105   300004 236100                    LDQ     4,,PR3
         9 007106   000033 772000                    QRL     27
         9 007107   000000 620006                    EAX0    0,QL
         9 007110   000000 305540                    DTB
         9 007111   300004 230010                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         9 007112   001712 000004 1                  NDSC9   VALUE                    cn=0,s=lsgnf,sf=0,n=4

     2331    20396    5                       IF TEMP1 = 1

  20396  9 007113   000023 235000 1                  LDA     TEMP1
         9 007114   000001 115007                    CMPA    1,DL
         9 007115   007226 601000 9                  TNZ     s:20424

     2332    20397    5                          THEN        /* Determine indx of this instance name    */
     2333    20398    6                          DO J = 0 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.
             20398                                   SUBLK$(0)->O$BLK.NSUBLKS - 1;

  20398  9 007116   000026 450000 1                  STZ     J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:327  
         9 007117   007215 710000 9                  TRA     s:20421+1

     2334    20399    6                             INSTANCE_NAME = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->
             20399                                      O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;

  20399  9 007120   000015 470400 1                  LDP0    BLK$
         9 007121   000003 471500                    LDP1    3,,PR0
         9 007122   100003 473500                    LDP3    3,,PR1
         9 007123   300003 474500                    LDP4    3,,PR3
         9 007124   000026 720000 1                  LXL0    J
         9 007125   400003 475510                    LDP5    3,X0,PR4
         9 007126   500004 236100                    LDQ     4,,PR5
         9 007127   000033 772000                    QRL     27
         9 007130   000000 621006                    EAX1    0,QL
         9 007131   040100 100540                    MLR     fill='040'O
         9 007132   500004 200011                    ADSC9   4,,PR5                   cn=1,n=*X1
         9 007133   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8

     2335    20400    6                             FOUND = '0'B;

  20400  9 007134   200025 450100                    STZ     FOUND,,AUTO

     2336    20401    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20401  9 007135   000000 236000 xsym               LDQ     B$DS5$
         9 007136   000001 036003                    ADLQ    1,DU
         9 007137   200031 756100                    STQ     INSTANCE$,,AUTO

     2337    20402    7                             DO K = 0 TO PC$HDR.CURINSTANCES - 1;

  20402  9 007140   000027 450000 1                  STZ     K
         9 007141   007166 710000 9                  TRA     s:20412+1

     2338    20403    7                                IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND

  20403  9 007142   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007143   040100 106500                    CMPC    fill='040'O
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:328  
         9 007144   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         9 007145   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 007146   007162 601000 9                  TNZ     s:20411
         9 007147   000003 236100                    LDQ     3,,PR0
         9 007150   200000 316003                    CANQ    65536,DU
         9 007151   007162 601000 9                  TNZ     s:20411

     2339    20404    7                                   NOT PC$INSTANCE.FLAGS.DELETED
     2340    20405    7                                   THEN    /* FOUND IT                           */
     2341    20406    8                                   DO;

     2342    20407    8                                      FOUND = '1'B;

  20407  9 007152   400000 236003                    LDQ     -131072,DU
         9 007153   200025 756100                    STQ     FOUND,,AUTO

     2343    20408    8                                      PC$INSTANCE.MAXTPU = VALUE;

  20408  9 007154   001712 235000 1                  LDA     VALUE
         9 007155   000002 755100                    STA     2,,PR0

     2344    20409    8                                      MAXTPU_TBL.MAXTPU(K) = VALUE;

  20409  9 007156   000027 235000 1                  LDA     K
         9 007157   000002 735000                    ALS     2
         9 007160   001712 236000 1                  LDQ     VALUE
         9 007161   004561 756005 1                  STQ     MAXTPU_TBL+2,AL

     2345    20410    8                                   END;    /* IF FOUND                           */

     2346    20411    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

  20411  9 007162   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 007163   000113 036003                    ADLQ    75,DU
         9 007164   200031 756100                    STQ     INSTANCE$,,AUTO

     2347    20412    7                             END;          /* DO K                              */
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:329  

  20412  9 007165   000027 054000 1                  AOS     K
         9 007166   000000 470400 xsym               LDP0    B$DS5$
         9 007167   000027 236000 1                  LDQ     K
         9 007170   007142 604000 9                  TMI     s:20403
         9 007171   000000 116100                    CMPQ    0,,PR0
         9 007172   007142 602000 9                  TNC     s:20403

     2348    20413    6                             IF NOT FOUND

  20413  9 007173   200025 234100                    SZN     FOUND,,AUTO
         9 007174   007214 604000 9                  TMI     s:20421

     2349    20414    6                                THEN       /* BAD INSTANCE NAME                  */
     2350    20415    7                                DO;

     2351    20416    7                                   SUB_BUF_1.COUNT = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20416                                            SUBLK$(0)->

  20416  9 007175   000015 471400 1                  LDP1    BLK$
         9 007176   100003 473500                    LDP3    3,,PR1
         9 007177   300003 474500                    LDP4    3,,PR3
         9 007200   400003 475500                    LDP5    3,,PR4
         9 007201   000026 720000 1                  LXL0    J
         9 007202   500003 476510                    LDP6    3,X0,PR5
         9 007203   600004 236100                    LDQ     4,,PR6
         9 007204   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     2352    20417    7                                                    O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->
             20417                                                              OUT$SYM.COUNT;
     2353    20418    7                                   SUB_BUF_1.TEXT = INSTANCE_NAME;

  20418  9 007205   040000 100500                    MLR     fill='040'O
         9 007206   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 007207   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

     2354    20419    7                                   CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:330  

  20419  9 007210   000041 630400 10                 EPPR0   33
         9 007211   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007212   000000 701000 xent               TSX1    PCE$ERROR
         9 007213   000000 011000                    NOP     0

     2355    20420    7                                END;       /* IF NOT FOUND                       */

     2356    20421    6                          END;  /* DO J */

  20421  9 007214   000026 054000 1                  AOS     J
         9 007215   000015 470400 1                  LDP0    BLK$
         9 007216   000003 471500                    LDP1    3,,PR0
         9 007217   100003 473500                    LDP3    3,,PR1
         9 007220   300003 474500                    LDP4    3,,PR3
         9 007221   400001 236100                    LDQ     1,,PR4
         9 007222   000022 772000                    QRL     18
         9 007223   000026 116000 1                  CMPQ    J
         9 007224   007120 605400 9                  TPNZ    s:20399
         9 007225   007552 710000 9                  TRA     CLEANUP

     2357    20422    5                          ELSE             /* ALL                                */
     2358    20423    6                          DO;

     2359    20424    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20424  9 007226   000000 236000 xsym               LDQ     B$DS5$
         9 007227   000001 036003                    ADLQ    1,DU
         9 007230   200031 756100                    STQ     INSTANCE$,,AUTO

     2360    20425    7                             DO J = 0 TO PC$HDR.CURINSTANCES - 1;

  20425  9 007231   000026 450000 1                  STZ     J
         9 007232   007250 710000 9                  TRA     s:20431+1

     2361    20426    8                                IF NOT PC$INSTANCE.FLAGS.DELETED THEN DO;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:331  
  20426  9 007233   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007234   000003 236100                    LDQ     3,,PR0
         9 007235   200000 316003                    CANQ    65536,DU
         9 007236   007244 601000 9                  TNZ     s:20430

     2362    20427    8                                   PC$INSTANCE.MAXTPU = VALUE;

  20427  9 007237   001712 235000 1                  LDA     VALUE
         9 007240   000002 755100                    STA     2,,PR0

     2363    20428    8                                   MAXTPU_TBL.MAXTPU(J) = VALUE;

  20428  9 007241   000026 236000 1                  LDQ     J
         9 007242   000002 736000                    QLS     2
         9 007243   004561 755006 1                  STA     MAXTPU_TBL+2,QL

     2364    20429    8                                   END;  /* IF NOT DELETED */

     2365    20430    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

  20430  9 007244   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 007245   000113 036003                    ADLQ    75,DU
         9 007246   200031 756100                    STQ     INSTANCE$,,AUTO

     2366    20431    7                                END;  /* DO J */

  20431  9 007247   000026 054000 1                  AOS     J
         9 007250   000000 470400 xsym               LDP0    B$DS5$
         9 007251   000026 236000 1                  LDQ     J
         9 007252   007233 604000 9                  TMI     s:20426
         9 007253   000000 116100                    CMPQ    0,,PR0
         9 007254   007233 602000 9                  TNC     s:20426

     2367    20432    6                             END;  /* ELSE */

  20432  9 007255   007552 710000 9                  TRA     CLEANUP

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:332  
     2368    20433    5                    CASE(%PC_TPHDR);

     2369    20434    5                       TEMP1 = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.NSUBLKS;

  20434  9 007256   300001 236100                    LDQ     1,,PR3
         9 007257   000022 772000                    QRL     18
         9 007260   000023 756000 1                  STQ     TEMP1

     2370    20435    5                       TEMP$ = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1);

  20435  9 007261   000003 471500                    LDP1    3,,PR0
         9 007262   100004 236100                    LDQ     4,,PR1
         9 007263   000014 756000 1                  STQ     TEMP$

     2371    20436    5                       IF TEMP1 = 1

  20436  9 007264   000023 235000 1                  LDA     TEMP1
         9 007265   000001 115007                    CMPA    1,DL
         9 007266   007447 601000 9                  TNZ     s:20468

     2372    20437    5                          THEN        /* Determine indx of this instance name    */
     2373    20438    6                          DO J = 0 TO BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.
             20438                                   SUBLK$(0)->O$BLK.NSUBLKS - 1;

  20438  9 007267   000026 450000 1                  STZ     J
         9 007270   007436 710000 9                  TRA     s:20465+1

     2374    20439    6                             INSTANCE_NAME = BLK$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->
             20439                                      O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->OUT$SYM.TEXT;

  20439  9 007271   000015 470400 1                  LDP0    BLK$
         9 007272   000003 471500                    LDP1    3,,PR0
         9 007273   100003 473500                    LDP3    3,,PR1
         9 007274   300003 474500                    LDP4    3,,PR3
         9 007275   000026 720000 1                  LXL0    J
         9 007276   400003 475510                    LDP5    3,X0,PR4
         9 007277   500004 236100                    LDQ     4,,PR5
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:333  
         9 007300   000033 772000                    QRL     27
         9 007301   000000 621006                    EAX1    0,QL
         9 007302   040100 100540                    MLR     fill='040'O
         9 007303   500004 200011                    ADSC9   4,,PR5                   cn=1,n=*X1
         9 007304   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8

     2375    20440    6                             FOUND = '0'B;

  20440  9 007305   200025 450100                    STZ     FOUND,,AUTO

     2376    20441    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20441  9 007306   000000 236000 xsym               LDQ     B$DS5$
         9 007307   000001 036003                    ADLQ    1,DU
         9 007310   200031 756100                    STQ     INSTANCE$,,AUTO

     2377    20442    7                             DO K = 0 TO PC$HDR.CURINSTANCES - 1;

  20442  9 007311   000027 450000 1                  STZ     K
         9 007312   007407 710000 9                  TRA     s:20456+1

     2378    20443    7                                IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND

  20443  9 007313   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007314   040100 106500                    CMPC    fill='040'O
         9 007315   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         9 007316   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 007317   007403 601000 9                  TNZ     s:20455
         9 007320   000003 236100                    LDQ     3,,PR0
         9 007321   200000 316003                    CANQ    65536,DU
         9 007322   007403 601000 9                  TNZ     s:20455

     2379    20444    7                                   NOT PC$INSTANCE.FLAGS.DELETED
     2380    20445    7                                   THEN    /* FOUND IT                           */
     2381    20446    8                                   DO;

     2382    20447    8                                      FOUND = '1'B;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:334  

  20447  9 007323   400000 236003                    LDQ     -131072,DU
         9 007324   200025 756100                    STQ     FOUND,,AUTO

     2383    20448    8                                      PC$INSTANCE.HDR.CNT = TEMP$->OUT$SYM.COUNT;

  20448  9 007325   000014 471400 1                  LDP1    TEMP$
         9 007326   100004 236100                    LDQ     4,,PR1
         9 007327   000004 552140                    STBQ    4,'40'O,PR0

     2384    20449    8                                      PC$INSTANCE.HDR.MSG = TEMP$->OUT$SYM.TEXT;

  20449  9 007330   100004 236100                    LDQ     4,,PR1
         9 007331   000033 772000                    QRL     27
         9 007332   000000 620006                    EAX0    0,QL
         9 007333   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007334   040100 100540                    MLR     fill='040'O
         9 007335   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         9 007336   000004 200120                    ADSC9   4,,PR0                   cn=1,n=80

     2385    20450    8                                      PC$INSTANCE.FLAGS.HEADER = (TEMP$->OUT$SYM.COUNT
             20450                                               > 0);

  20450  9 007337   400000 220003                    LDX0    -131072,DU
         9 007340   100004 236100                    LDQ     4,,PR1
         9 007341   777000 316003                    CANQ    -512,DU
         9 007342   007344 601000 9                  TNZ     s:20450+5
         9 007343   000000 220003                    LDX0    0,DU
         9 007344   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007345   000000 636010                    EAQ     0,X0
         9 007346   000002 772000                    QRL     2
         9 007347   000003 676100                    ERQ     3,,PR0
         9 007350   100000 376003                    ANQ     32768,DU
         9 007351   000003 656100                    ERSQ    3,,PR0

     2386    20451    8                                      TPHDR_TBL.HDR.CNT(K) = TEMP$->OUT$SYM.COUNT;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:335  
  20451  9 007352   000027 236000 1                  LDQ     K
         9 007353   000025 402007                    MPY     21,DL
         9 007354   000000 620006                    EAX0    0,QL
         9 007355   100004 236100                    LDQ     4,,PR1
         9 007356   005217 676010 1                  ERQ     TPHDR_TBL,X0
         9 007357   777000 376003                    ANQ     -512,DU
         9 007360   005217 656010 1                  ERSQ    TPHDR_TBL,X0

     2387    20452    8                                      TPHDR_TBL.HDR.MSG(K) = TEMP$->OUT$SYM.TEXT;

  20452  9 007361   100004 236100                    LDQ     4,,PR1
         9 007362   000033 772000                    QRL     27
         9 007363   000000 621006                    EAX1    0,QL
         9 007364   000027 236000 1                  LDQ     K
         9 007365   000124 402007                    MPY     84,DL
         9 007366   040006 100540                    MLR     fill='040'O
         9 007367   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         9 007370   005217 200120 1                  ADSC9   TPHDR_TBL,Q              cn=1,n=80

     2388    20453    8                                      TPHDR_TBL.FLAGS.PRESENT(K) =  (TEMP$->OUT$SYM.
             20453                                               COUNT > 0);

  20453  9 007371   400000 221003                    LDX1    -131072,DU
         9 007372   100004 236100                    LDQ     4,,PR1
         9 007373   777000 316003                    CANQ    -512,DU
         9 007374   007376 601000 9                  TNZ     s:20453+5
         9 007375   000000 221003                    LDX1    0,DU
         9 007376   000000 636011                    EAQ     0,X1
         9 007377   000012 772000                    QRL     10
         9 007400   005243 676010 1                  ERQ     TPHDR_TBL+20,X0
         9 007401   000200 376003                    ANQ     128,DU
         9 007402   005243 656010 1                  ERSQ    TPHDR_TBL+20,X0

     2389    20454    8                                   END;    /* IF FOUND                           */

     2390    20455    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:336  
  20455  9 007403   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 007404   000113 036003                    ADLQ    75,DU
         9 007405   200031 756100                    STQ     INSTANCE$,,AUTO

     2391    20456    7                             END;          /* DO K                              */

  20456  9 007406   000027 054000 1                  AOS     K
         9 007407   000000 470400 xsym               LDP0    B$DS5$
         9 007410   000027 236000 1                  LDQ     K
         9 007411   007313 604000 9                  TMI     s:20443
         9 007412   000000 116100                    CMPQ    0,,PR0
         9 007413   007313 602000 9                  TNC     s:20443

     2392    20457    6                             IF NOT FOUND

  20457  9 007414   200025 234100                    SZN     FOUND,,AUTO
         9 007415   007435 604000 9                  TMI     s:20465

     2393    20458    6                                THEN       /* BAD INSTANCE NAME                  */
     2394    20459    7                                DO;

     2395    20460    7                                   SUB_BUF_1.COUNT = BLK$->O$BLK.SUBLK$(0)->O$BLK.
             20460                                            SUBLK$(0)->

  20460  9 007416   000015 471400 1                  LDP1    BLK$
         9 007417   100003 473500                    LDP3    3,,PR1
         9 007420   300003 474500                    LDP4    3,,PR3
         9 007421   400003 475500                    LDP5    3,,PR4
         9 007422   000026 720000 1                  LXL0    J
         9 007423   500003 476510                    LDP6    3,X0,PR5
         9 007424   600004 236100                    LDQ     4,,PR6
         9 007425   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     2396    20461    7                                                    O$BLK.SUBLK$(0)->O$BLK.SUBLK$(J)->
             20461                                                              OUT$SYM.COUNT;
     2397    20462    7                                   SUB_BUF_1.TEXT = INSTANCE_NAME;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:337  
  20462  9 007426   040000 100500                    MLR     fill='040'O
         9 007427   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 007430   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

     2398    20463    7                                   CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);

  20463  9 007431   000041 630400 10                 EPPR0   33
         9 007432   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007433   000000 701000 xent               TSX1    PCE$ERROR
         9 007434   000000 011000                    NOP     0

     2399    20464    7                                END;       /* IF NOT FOUND                       */

     2400    20465    6                          END;  /* DO J */

  20465  9 007435   000026 054000 1                  AOS     J
         9 007436   000015 470400 1                  LDP0    BLK$
         9 007437   000003 471500                    LDP1    3,,PR0
         9 007440   100003 473500                    LDP3    3,,PR1
         9 007441   300003 474500                    LDP4    3,,PR3
         9 007442   400001 236100                    LDQ     1,,PR4
         9 007443   000022 772000                    QRL     18
         9 007444   000026 116000 1                  CMPQ    J
         9 007445   007271 605400 9                  TPNZ    s:20439
         9 007446   007552 710000 9                  TRA     CLEANUP

     2401    20466    5                          ELSE             /* ALL                                */
     2402    20467    6                          DO;

     2403    20468    6                             INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20468  9 007447   000000 236000 xsym               LDQ     B$DS5$
         9 007450   000001 036003                    ADLQ    1,DU
         9 007451   200031 756100                    STQ     INSTANCE$,,AUTO

     2404    20469    7                             DO J = 0 TO PC$HDR.CURINSTANCES - 1;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:338  
  20469  9 007452   000026 450000 1                  STZ     J
         9 007453   007545 710000 9                  TRA     s:20479+1

     2405    20470    8                                IF NOT PC$INSTANCE.FLAGS.DELETED THEN DO;

  20470  9 007454   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007455   000003 236100                    LDQ     3,,PR0
         9 007456   200000 316003                    CANQ    65536,DU
         9 007457   007541 601000 9                  TNZ     s:20478

     2406    20471    8                                   PC$INSTANCE.HDR.CNT = TEMP$->OUT$SYM.COUNT;

  20471  9 007460   000014 471400 1                  LDP1    TEMP$
         9 007461   100004 236100                    LDQ     4,,PR1
         9 007462   000004 552140                    STBQ    4,'40'O,PR0

     2407    20472    8                                   PC$INSTANCE.HDR.MSG = TEMP$->OUT$SYM.TEXT;

  20472  9 007463   100004 236100                    LDQ     4,,PR1
         9 007464   000033 772000                    QRL     27
         9 007465   000000 620006                    EAX0    0,QL
         9 007466   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007467   040100 100540                    MLR     fill='040'O
         9 007470   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         9 007471   000004 200120                    ADSC9   4,,PR0                   cn=1,n=80

     2408    20473    8                                   PC$INSTANCE.FLAGS.HEADER =  (TEMP$->OUT$SYM.COUNT >
             20473                                            0);

  20473  9 007472   400000 220003                    LDX0    -131072,DU
         9 007473   100004 236100                    LDQ     4,,PR1
         9 007474   777000 316003                    CANQ    -512,DU
         9 007475   007477 601000 9                  TNZ     s:20473+5
         9 007476   000000 220003                    LDX0    0,DU
         9 007477   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 007500   000000 636010                    EAQ     0,X0
         9 007501   000002 772000                    QRL     2
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:339  
         9 007502   000003 676100                    ERQ     3,,PR0
         9 007503   100000 376003                    ANQ     32768,DU
         9 007504   000003 656100                    ERSQ    3,,PR0

     2409    20474    8                                   TPHDR_TBL.HDR.CNT(J) = TEMP$->OUT$SYM.COUNT;

  20474  9 007505   000026 236000 1                  LDQ     J
         9 007506   000025 402007                    MPY     21,DL
         9 007507   000000 620006                    EAX0    0,QL
         9 007510   100004 236100                    LDQ     4,,PR1
         9 007511   005217 676010 1                  ERQ     TPHDR_TBL,X0
         9 007512   777000 376003                    ANQ     -512,DU
         9 007513   005217 656010 1                  ERSQ    TPHDR_TBL,X0

     2410    20475    8                                   TPHDR_TBL.HDR.MSG(J) = TEMP$->OUT$SYM.TEXT;

  20475  9 007514   100004 236100                    LDQ     4,,PR1
         9 007515   000033 772000                    QRL     27
         9 007516   000000 620006                    EAX0    0,QL
         9 007517   000026 236000 1                  LDQ     J
         9 007520   000124 402007                    MPY     84,DL
         9 007521   040006 100540                    MLR     fill='040'O
         9 007522   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         9 007523   005217 200120 1                  ADSC9   TPHDR_TBL,Q              cn=1,n=80

     2411    20476    8                                   TPHDR_TBL.FLAGS.PRESENT(J) =  (TEMP$->OUT$SYM.COUNT
             20476                                            > 0);

  20476  9 007524   000026 236000 1                  LDQ     J
         9 007525   000025 402007                    MPY     21,DL
         9 007526   400000 220003                    LDX0    -131072,DU
         9 007527   000000 621006                    EAX1    0,QL
         9 007530   100004 236100                    LDQ     4,,PR1
         9 007531   777000 316003                    CANQ    -512,DU
         9 007532   007534 601000 9                  TNZ     s:20476+8
         9 007533   000000 220003                    LDX0    0,DU
         9 007534   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:340  
         9 007535   000012 772000                    QRL     10
         9 007536   005243 676011 1                  ERQ     TPHDR_TBL+20,X1
         9 007537   000200 376003                    ANQ     128,DU
         9 007540   005243 656011 1                  ERSQ    TPHDR_TBL+20,X1

     2412    20477    8                                   END;  /* IF NOT DELETED */

     2413    20478    7                                INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

  20478  9 007541   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 007542   000113 036003                    ADLQ    75,DU
         9 007543   200031 756100                    STQ     INSTANCE$,,AUTO

     2414    20479    7                                END;  /* DO J */

  20479  9 007544   000026 054000 1                  AOS     J
         9 007545   000000 470400 xsym               LDP0    B$DS5$
         9 007546   000026 236000 1                  LDQ     J
         9 007547   007454 604000 9                  TMI     s:20470
         9 007550   000000 116100                    CMPQ    0,,PR0
         9 007551   007454 602000 9                  TNC     s:20470

     2415    20480    6                             END;  /* ELSE */

     2416    20481    5                 END;                      /* DO CASE TP_PARAM                   */

     2417    20482    4   CLEANUP:      IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#

  20482  9 007552   000000 236007 xsym  CLEANUP      LDQ     M$TP,DL
         9 007553   000000 470400 10                 LDP0    0
         9 007554   000000 471500                    LDP1    0,,PR0
         9 007555   100000 473506                    LDP3    0,QL,PR1
         9 007556   300031 236100                    LDQ     25,,PR3
         9 007557   020000 316007                    CANQ    8192,DL
         9 007560   007564 600000 9                  TZE     s:20484

     2418    20483    4                    THEN CALL M$CLOSE(CLOSE_TP_FILE);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:341  

  20483  9 007561   010572 630400 1                  EPPR0   CLOSE_TP_FILE
         9 007562   050001 713400                    CLIMB   close
         9 007563   406000 401760                    pmme    nvectors=13

     2419    20484    5                 IF NOT (B$JIT.PRIV.JOB & %PR_FMSEC#) THEN DO;

  20484  9 007564   000000 470400 xsym               LDP0    B$JIT$
         9 007565   000015 236100                    LDQ     13,,PR0
         9 007566   000056 376000 2                  ANQ     DUMP_LOCK_FMT+5
         9 007567   007574 601000 9                  TNZ     NEXT3

     2420    20485    5                    CALL M$RPRIV(FMS_PRIV) ALTRET(NEXT3);

  20485  9 007570   011234 630400 1                  EPPR0   FMS_PRIV
         9 007571   420013 713400                    CLIMB   alt,+8203
         9 007572   400000 401760                    pmme    nvectors=1
         9 007573   007574 702000 9                  TSX2    NEXT3

  20485  9 007574                       NEXT3        null
     2421    20486    5              NEXT3:;
     2422    20487    5                    END;  /* IF */

     2423    20488    4               END;  /* DO CASE CODE */

     2424    20489    3   ENDLOOP:
     2425    20490    3              END;  /* DO I */

  20490  9 007574   000025 054000 1     ENDLOOP      AOS     I
         9 007575   002115 470400 1                  LDP0    P_PCB$
         9 007576   000003 471500                    LDP1    3,,PR0
         9 007577   100001 236100                    LDQ     1,,PR1
         9 007600   000022 772000                    QRL     18
         9 007601   000025 116000 1                  CMPQ    I
         9 007602   004675 605400 9                  TPNZ    s:19938

     2426    20491        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:342  
     2427    20492    2   RESET_BREAK:
     2428    20493    2           CALL M$INT (BREAK_FPT);

  20493  9 007603   010250 630400 1     RESET_BREAK  EPPR0   BREAK_FPT
         9 007604   010002 713400                    CLIMB   4098
         9 007605   400000 401760                    pmme    nvectors=1

     2429    20494    2           RETURN;

  20494  9 007606   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 007607   000001 702211                    TSX2  ! 1,X1

     2430    20495        /**/
     2431    20496    2   BAD_RES:
     2432    20497    2           CALL PCE$ERROR(%E$P_BADRES,3);

  20497  9 007610   000045 630400 10    BAD_RES      EPPR0   37
         9 007611   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007612   000000 701000 xent               TSX1    PCE$ERROR
         9 007613   000000 011000                    NOP     0

     2433    20498        /**/
     2434    20499    2   SET_ERR:
     2435    20500    2           ALTRETURN;

  20500  9 007614   200054 221300       SET_ERR      LDX1  ! TEMPLEN+1,,AUTO
         9 007615   000000 702211                    TSX2  ! 0,X1

     2436    20501    2   NO_MEM:
     2437    20502    2           CALL PCE$ERROR(%E$P_BADTPFILE,3);

  20502  9 007616   000150 630400 10    NO_MEM       EPPR0   104
         9 007617   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 007620   000000 701000 xent               TSX1    PCE$ERROR
         9 007621   000000 011000                    NOP     0

     2438    20503    2           ALTRETURN;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:343  

  20503  9 007622   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 007623   000000 702211                    TSX2  ! 0,X1

     2439    20504        /*E* ERROR: PCC-E$P_BADTPFILE-0
     2440    20505             MESSAGE: Unable to access TP control file.
     2441    20506             DESCRIPTION: See messages                   */
     2442    20507        /*E* ERROR: PCC-E$P_DUP_INSTANCE-0
     2443    20508             MESSAGE: Instance name %U1 is already defined.
     2444    20509             DESCRIPTION:  Duplicate instances not allowed.     */
     2445    20510        /*E* ERROR: PCC-E$P_BAD_INSTANCE_NAME-0
     2446    20511             MESSAGE: Instance name %U1 is not currently defined.
     2447    20512             MESSAGE1:Instance name needs to be defined using the SET command.
     2448    20513             DESCRIPTION: See messages                   */
     2449    20514        /**/
     2450    20515        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:344  
     2451    20516    2   SET_TIMEZONE: PROC ALTRET;

  20516  9 007624   200056 741300       SET_TIMEZONE STX1  ! CODE+1,,AUTO

     2452    20517        /**/
     2453    20518    3           DCL OFFSET SBIN;
     2454    20519    3           DCL ACRONYM CHAR(4);
     2455    20520    3           DCL INBUF CHAR(8);
     2456    20521    3           DCL N$ PTR;
     2457    20522    3           DCL B$UBIN UBIN BASED;
     2458    20523        /**/
     2459    20524    3           SET_INDEXLO = 0;

  20524  9 007625   001710 450000 1                  STZ     SET_INDEXLO

     2460    20525    3           SET_INDEXHI = 0;

  20525  9 007626   001711 450000 1                  STZ     SET_INDEXHI

     2461    20526    3           N$ = BLK$->O$BLK.SUBLK$(BLK$->O$BLK.NSUBLKS-1);

  20526  9 007627   000015 470400 1                  LDP0    BLK$
         9 007630   000001 220100                    LDX0    1,,PR0
         9 007631   000002 236110                    LDQ     2,X0,PR0
         9 007632   200063 756100                    STQ     N$,,AUTO

     2462    20527    3           IF N$->O$BLK.NSUBLKS = 1 THEN

  20527  9 007633   200063 471500                    LDP1    N$,,AUTO
         9 007634   100001 220100                    LDX0    1,,PR1
         9 007635   000001 100003                    CMPX0   1,DU
         9 007636   007647 601000 9                  TNZ     s:20530

     2463    20528    3               INBUF = N$->O$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  20528  9 007637   100003 473500                    LDP3    3,,PR1
         9 007640   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:345  
         9 007641   000033 772000                    QRL     27
         9 007642   000000 622006                    EAX2    0,QL
         9 007643   040100 100540                    MLR     fill='040'O
         9 007644   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 007645   200061 000010                    ADSC9   INBUF,,AUTO              cn=0,n=8
         9 007646   007676 710000 9                  TRA     s:20533

     2464    20529    3           ELSE
     2465    20530    3               CALL CONCAT( INBUF,

  20530  9 007647   100003 473500                    LDP3    3,,PR1
         9 007650   300004 236100                    LDQ     4,,PR3
         9 007651   000033 772000                    QRL     27
         9 007652   100004 474500                    LDP4    4,,PR1
         9 007653   000000 622006                    EAX2    0,QL
         9 007654   400004 236100                    LDQ     4,,PR4
         9 007655   000033 772000                    QRL     27
         9 007656   040100 100540                    MLR     fill='040'O
         9 007657   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         9 007660   200061 000010                    ADSC9   INBUF,,AUTO              cn=0,n=8
         9 007661   000000 620006                    EAX0    0,QL
         9 007662   000000 636012                    EAQ     0,X2
         9 007663   000022 772000                    QRL     18
         9 007664   000010 116007                    CMPQ    8,DL
         9 007665   007676 603000 9                  TRC     s:20533
         9 007666   200076 742100                    STX2    TEMPTEXT+4,,AUTO
         9 007667   777767 622012                    EAX2    -9,X2
         9 007670   777777 662003                    ERX2    -1,DU
         9 007671   200076 235100                    LDA     TEMPTEXT+4,,AUTO
         9 007672   000022 771000                    ARL     18
         9 007673   040145 100540                    MLR     fill='040'O
         9 007674   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         9 007675   200061 000012                    ADSC9   INBUF,A,AUTO             cn=0,n=*X2

     2466    20531    3                       N$->O$BLK.SUBLK$(0)->OUT$SYM.TEXT,
     2467    20532    3                       N$->O$BLK.SUBLK$(1)->OUT$SYM.TEXT);
     2468    20533    3           XUG_GETCMD.TEXT_ = VECTOR( INBUF);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:346  

  20533  9 007676   000076 235000 10                 LDA     62
         9 007677   200076 452500                    STP2    TEMPTEXT+4,,AUTO
         9 007700   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 007701   000061 036003                    ADLQ    49,DU
         9 007702   002266 757000 1                  STAQ    XUG_GETCMD+28

     2469    20534    3           CALL XUG$GETCMD( XUG_GETCMD) ALTRET( OOPS);

  20534  9 007703   000013 630400 10                 EPPR0   11
         9 007704   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 007705   000000 701000 xent               TSX1    XUG$GETCMD
         9 007706   007765 702000 9                  TSX2    OOPS

     2470    20535    3           N$ = XUG_GETCMD.OUT$->O$BLK.SUBLK$(0);

  20535  9 007707   002233 470400 1                  LDP0    XUG_GETCMD+1
         9 007710   000003 236100                    LDQ     3,,PR0
         9 007711   200063 756100                    STQ     N$,,AUTO

     2471    20536    3           ACRONYM = '    ';

  20536  9 007712   000074 236000 2                  LDQ     DUMP_LOCK_FMT+19
         9 007713   200060 756100                    STQ     ACRONYM,,AUTO

     2472    20537    3           CALL XST$TIMEZONE( N$, OFFSET, ACRONYM) ALTRET( OOPS);

  20537  9 007714   200060 631500                    EPPR1   ACRONYM,,AUTO
         9 007715   200100 451500                    STP1    TEMPTEXT+6,,AUTO
         9 007716   200057 633500                    EPPR3   OFFSET,,AUTO
         9 007717   200077 453500                    STP3    TEMPTEXT+5,,AUTO
         9 007720   200063 634500                    EPPR4   N$,,AUTO
         9 007721   200076 454500                    STP4    TEMPTEXT+4,,AUTO
         9 007722   200076 630500                    EPPR0   TEMPTEXT+4,,AUTO
         9 007723   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 007724   000000 701000 xent               TSX1    XST$TIMEZONE
         9 007725   007765 702000 9                  TSX2    OOPS
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:347  

     2473    20538    4           IF ACRONYM = '    ' THEN DO;

  20538  9 007726   200060 236100                    LDQ     ACRONYM,,AUTO
         9 007727   000074 116000 2                  CMPQ    DUMP_LOCK_FMT+19
         9 007730   007747 601000 9                  TNZ     s:20544

     2474    20539                    /* allow site-defined acronym if valid offset given */
     2475    20540    4               N$ = BLK$->O$BLK.SUBLK$(1);

  20540  9 007731   000015 470400 1                  LDP0    BLK$
         9 007732   000004 236100                    LDQ     4,,PR0
         9 007733   200063 756100                    STQ     N$,,AUTO

     2476    20541    4               IF N$->O$BLK.NSUBLKS = 3 THEN

  20541  9 007734   200063 471500                    LDP1    N$,,AUTO
         9 007735   100001 220100                    LDX0    1,,PR1
         9 007736   000003 100003                    CMPX0   3,DU
         9 007737   007747 601000 9                  TNZ     s:20544

     2477    20542    4                   ACRONYM = N$->O$BLK.SUBLK$(2)->OUT$SYM.TEXT;

  20542  9 007740   100005 473500                    LDP3    5,,PR1
         9 007741   300004 236100                    LDQ     4,,PR3
         9 007742   000033 772000                    QRL     27
         9 007743   000000 621006                    EAX1    0,QL
         9 007744   040100 100540                    MLR     fill='040'O
         9 007745   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         9 007746   200060 000004                    ADSC9   ACRONYM,,AUTO            cn=0,n=4

     2478    20543    4               END;

     2479    20544    3           VALUE = ADDR( ACRONYM)->B$UBIN;

  20544  9 007747   200060 235100                    LDA     ACRONYM,,AUTO
         9 007750   001712 755000 1                  STA     VALUE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:348  

     2480    20545    3           SET_PARAM = %PC_TIMEZONE;

  20545  9 007751   000067 236007                    LDQ     55,DL
         9 007752   001707 756000 1                  STQ     SET_PARAM

     2481    20546    3           CALL SET_VALUE;

  20546  9 007753   007767 701000 9                  TSX1    SET_VALUE
         9 007754   000000 011000                    NOP     0

     2482    20547    3           VALUE = OFFSET;

  20547  9 007755   200057 235100                    LDA     OFFSET,,AUTO
         9 007756   001712 755000 1                  STA     VALUE

     2483    20548    3           SET_PARAM = %PC_UTC_OFFSET;

  20548  9 007757   000070 236007                    LDQ     56,DL
         9 007760   001707 756000 1                  STQ     SET_PARAM

     2484    20549    3           CALL SET_VALUE;

  20549  9 007761   007767 701000 9                  TSX1    SET_VALUE
         9 007762   000000 011000                    NOP     0

     2485    20550    3           RETURN;

  20550  9 007763   200056 221300                    LDX1  ! CODE+1,,AUTO
         9 007764   000001 702211                    TSX2  ! 1,X1

     2486    20551    3   OOPS:
     2487    20552    3           ALTRETURN;

  20552  9 007765   200056 221300       OOPS         LDX1  ! CODE+1,,AUTO
         9 007766   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:349  
     2488    20553        /**/
     2489    20554    3           END SET_TIMEZONE;
     2490    20555        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:350  
     2491    20556    2   SET_VALUE: PROC;

  20556  9 007767   200064 741300       SET_VALUE    STX1  ! N$+1,,AUTO

     2492    20557        /**/
     2493    20558    3           VALUE = VALUE * (CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));

  20558  9 007770   001706 235000 1                  LDA     SET_CAT
         9 007771   000001 735000                    ALS     1
         9 007772   000000 470400 1                  LDP0    CAT$
         9 007773   000001 471505                    LDP1    1,AL,PR0
         9 007774   001707 236000 1                  LDQ     SET_PARAM
         9 007775   000014 402007                    MPY     12,DL
         9 007776   100013 236106                    LDQ     11,QL,PR1
         9 007777   001712 402000 1                  MPY     VALUE
         9 010000   001712 756000 1                  STQ     VALUE

     2494    20559        /**/
     2495    20560    3           MONPTR$ = CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.PTR$(SET_PARAM);

  20560  9 010001   001706 235000 1                  LDA     SET_CAT
         9 010002   000001 735000                    ALS     1
         9 010003   000001 471505                    LDP1    1,AL,PR0
         9 010004   001707 236000 1                  LDQ     SET_PARAM
         9 010005   000014 402007                    MPY     12,DL
         9 010006   100007 236106                    LDQ     7,QL,PR1
         9 010007   000010 756000 1                  STQ     MONPTR$

     2496    20561    3           MONPTR.SEGID = BITBIN(%SPCL1SID);

  20561  9 010010   006021 236007                    LDQ     3089,DL
         9 010011   000010 752003 1                  STCQ    MONPTR$,'03'O

     2497    20562    3           TEMPPTR.SEGID = BITBIN(%SPCL1SID);

  20562  9 010012   000014 752003 1                  STCQ    TEMP$,'03'O

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:351  
     2498    20563        /**/
     2499    20564    3           PARAM$ = CAT$ -> CAT$TBL.PARAM$(SET_CAT);

  20564  9 010013   001706 235000 1                  LDA     SET_CAT
         9 010014   000001 735000                    ALS     1
         9 010015   000001 236105                    LDQ     1,AL,PR0
         9 010016   000017 756000 1                  STQ     PARAM$

     2500    20565        /**/
     2501    20566    4           DO CASE(SET_CAT);

  20566  9 010017   001706 235000 1                  LDA     SET_CAT
         9 010020   000006 115007                    CMPA    6,DL
         9 010021   010023 602005 9                  TNC     s:20566+4,AL
         9 010022   011767 710000 9                  TRA     s:20866
         9 010023   011767 710000 9                  TRA     s:20866
         9 010024   010031 710000 9                  TRA     s:20570
         9 010025   010523 710000 9                  TRA     s:20645
         9 010026   010701 710000 9                  TRA     s:20687
         9 010027   011767 710000 9                  TRA     s:20866
         9 010030   010031 710000 9                  TRA     s:20570

     2502    20567
     2503    20568        /**/
     2504    20569    4            CASE(%PC_SYSTEM,%PC_EXCEPTION);

     2505    20570    5              DO J = SET_INDEXLO TO SET_INDEXHI;

  20570  9 010031   001710 235000 1                  LDA     SET_INDEXLO
         9 010032   000026 755000 1                  STA     J
         9 010033   010517 710000 9                  TRA     SKIPSET+1

     2506    20571    6                 IF (PARAM$ -> P$TBL.FLAGS.MINCONST(SET_PARAM)) THEN DO;

  20571  9 010034   001707 236000 1                  LDQ     SET_PARAM
         9 010035   000014 402007                    MPY     12,DL
         9 010036   000017 470400 1                  LDP0    PARAM$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:352  
         9 010037   000000 236106                    LDQ     0,QL,PR0
         9 010040   010000 316003                    CANQ    4096,DU
         9 010041   010064 600000 9                  TZE     s:20579

     2507    20572    6                    IF (VALUE < (PARAM$ -> P$TBL.MIN(SET_PARAM))*(PARAM$ ->

  20572  9 010042   001707 236000 1                  LDQ     SET_PARAM
         9 010043   000014 402007                    MPY     12,DL
         9 010044   000000 620006                    EAX0    0,QL
         9 010045   000012 236110                    LDQ     10,X0,PR0
         9 010046   000013 402110                    MPY     11,X0,PR0
         9 010047   001712 116000 1                  CMPQ    VALUE
         9 010050   010227 604400 9                  TMOZ    s:20595

     2508    20573    7                      P$TBL.MULT(SET_PARAM))) THEN DO; /* VALUE TOO SMALL        */

     2509    20574    7                      CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PARAM$ -> P$TBL.MIN(SET_PARAM)
             20574                                );

  20574  9 010051   001707 236000 1                  LDQ     SET_PARAM
         9 010052   000014 402003                    MPY     12,DU
         9 010053   000012 036003                    ADLQ    10,DU
         9 010054   000017 036000 1                  ADLQ    PARAM$
         9 010055   000161 235000 10                 LDA     113
         9 010056   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 010057   000162 236000 10                 LDQ     114
         9 010060   200067 756100                    STQ     N$+4,,AUTO
         9 010061   012006 701000 9                  TSX1    VAL_ERROR
         9 010062   000000 011000                    NOP     0

     2510    20575    7                       GOTO SKIPSET;

  20575  9 010063   010516 710000 9                  TRA     SKIPSET

     2511    20576    7                       END;
     2512    20577    6                    END;
     2513    20578    6                 ELSE DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:353  

     2514    20579    6                    TEMP$ = PARAM$ -> P$TBL.PTR$(PARAM$ -> P$TBL.MIN(SET_PARAM));

  20579  9 010064   001707 236000 1                  LDQ     SET_PARAM
         9 010065   000014 402007                    MPY     12,DL
         9 010066   000012 236106                    LDQ     10,QL,PR0
         9 010067   000014 402007                    MPY     12,DL
         9 010070   000007 236106                    LDQ     7,QL,PR0
         9 010071   000014 756000 1                  STQ     TEMP$

     2515    20580    6                    TEMPPTR.SEGID = BITBIN(%SPCL1SID);

  20580  9 010072   006021 236007                    LDQ     3089,DL
         9 010073   000014 752003 1                  STCQ    TEMP$,'03'O

     2516    20581    6                    IF (PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MIN(SET_PARAM)))AND

  20581  9 010074   001707 236000 1                  LDQ     SET_PARAM
         9 010075   000014 402007                    MPY     12,DL
         9 010076   000012 236106                    LDQ     10,QL,PR0
         9 010077   000014 402007                    MPY     12,DL
         9 010100   000000 236106                    LDQ     0,QL,PR0
         9 010101   100000 316003                    CANQ    32768,DU
         9 010102   010152 600000 9                  TZE     s:20587
         9 010103   000014 471400 1                  LDP1    TEMP$
         9 010104   000026 720000 1                  LXL0    J
         9 010105   001712 236000 1                  LDQ     VALUE
         9 010106   010111 604000 9                  TMI     s:20583
         9 010107   100000 116110                    CMPQ    0,X0,PR1
         9 010110   010152 603000 9                  TRC     s:20587

     2517    20582    7                      (VALUE < TEMP$ -> B$TABLE(J)) THEN DO;

     2518    20583    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,

  20583  9 010111   001707 236000 1                  LDQ     SET_PARAM
         9 010112   000014 402007                    MPY     12,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:354  
         9 010113   000000 621006                    EAX1    0,QL
         9 010114   100000 236110                    LDQ     0,X0,PR1
         9 010115   010133 605000 9                  TPL     s:20583+18
         9 010116   000013 235111                    LDA     11,X1,PR0
         9 010117   010127 604000 9                  TMI     s:20583+14
         9 010120   000001 115007                    CMPA    1,DL
         9 010121   010140 600000 9                  TZE     s:20583+23
         9 010122   000000 235003                    LDA     0,DU
         9 010123   000001 737000                    LLS     1
         9 010124   000013 507111                    DVF     11,X1,PR0
         9 010125   000044 733000                    LRS     36
         9 010126   010140 710000 9                  TRA     s:20583+23
         9 010127   000013 116111                    CMPQ    11,X1,PR0
         9 010130   010135 602000 9                  TNC     s:20583+20
         9 010131   000001 236007                    LDQ     1,DL
         9 010132   010140 710000 9                  TRA     s:20583+23
         9 010133   000013 235111                    LDA     11,X1,PR0
         9 010134   010137 605000 9                  TPL     s:20583+22
         9 010135   000000 236003                    LDQ     0,DU
         9 010136   010140 710000 9                  TRA     s:20583+23
         9 010137   000013 506111                    DIV     11,X1,PR0
         9 010140   200102 756100                    STQ     TEMPTEXT+8,,AUTO
         9 010141   200102 633500                    EPPR3   TEMPTEXT+8,,AUTO
         9 010142   200071 453500                    STP3    @INDX+1,,AUTO
         9 010143   000161 236000 10                 LDQ     113
         9 010144   200070 756100                    STQ     @ERR#+1,,AUTO
         9 010145   000162 236000 10                 LDQ     114
         9 010146   200067 756100                    STQ     N$+4,,AUTO
         9 010147   012006 701000 9                  TSX1    VAL_ERROR
         9 010150   000000 011000                    NOP     0

     2519    20584    7                         (TEMP$ -> B$TABLE(J))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
     2520    20585    7                       GOTO SKIPSET;

  20585  9 010151   010516 710000 9                  TRA     SKIPSET

     2521    20586    7                       END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:355  
     2522    20587    6                   IF (NOT(PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MIN(SET_PARAM)))
             20587                             )AND

  20587  9 010152   001707 236000 1                  LDQ     SET_PARAM
         9 010153   000014 402007                    MPY     12,DL
         9 010154   000012 236106                    LDQ     10,QL,PR0
         9 010155   000014 402007                    MPY     12,DL
         9 010156   000000 236106                    LDQ     0,QL,PR0
         9 010157   100000 316003                    CANQ    32768,DU
         9 010160   010227 601000 9                  TNZ     s:20595
         9 010161   000014 471400 1                  LDP1    TEMP$
         9 010162   001712 236000 1                  LDQ     VALUE
         9 010163   010166 604000 9                  TMI     s:20589
         9 010164   100000 116100                    CMPQ    0,,PR1
         9 010165   010227 603000 9                  TRC     s:20595

     2523    20588    7                      (VALUE < TEMP$ -> B$TABLE(0)) THEN DO;

     2524    20589    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,

  20589  9 010166   001707 236000 1                  LDQ     SET_PARAM
         9 010167   000014 402007                    MPY     12,DL
         9 010170   000000 620006                    EAX0    0,QL
         9 010171   100000 236100                    LDQ     0,,PR1
         9 010172   010210 605000 9                  TPL     s:20589+18
         9 010173   000013 235110                    LDA     11,X0,PR0
         9 010174   010204 604000 9                  TMI     s:20589+14
         9 010175   000001 115007                    CMPA    1,DL
         9 010176   010215 600000 9                  TZE     s:20589+23
         9 010177   000000 235003                    LDA     0,DU
         9 010200   000001 737000                    LLS     1
         9 010201   000013 507110                    DVF     11,X0,PR0
         9 010202   000044 733000                    LRS     36
         9 010203   010215 710000 9                  TRA     s:20589+23
         9 010204   000013 116110                    CMPQ    11,X0,PR0
         9 010205   010212 602000 9                  TNC     s:20589+20
         9 010206   000001 236007                    LDQ     1,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:356  
         9 010207   010215 710000 9                  TRA     s:20589+23
         9 010210   000013 235110                    LDA     11,X0,PR0
         9 010211   010214 605000 9                  TPL     s:20589+22
         9 010212   000000 236003                    LDQ     0,DU
         9 010213   010215 710000 9                  TRA     s:20589+23
         9 010214   000013 506110                    DIV     11,X0,PR0
         9 010215   200103 756100                    STQ     TEMPTEXT+9,,AUTO
         9 010216   200103 633500                    EPPR3   TEMPTEXT+9,,AUTO
         9 010217   200071 453500                    STP3    @INDX+1,,AUTO
         9 010220   000161 236000 10                 LDQ     113
         9 010221   200070 756100                    STQ     @ERR#+1,,AUTO
         9 010222   000162 236000 10                 LDQ     114
         9 010223   200067 756100                    STQ     N$+4,,AUTO
         9 010224   012006 701000 9                  TSX1    VAL_ERROR
         9 010225   000000 011000                    NOP     0

     2525    20590    7                         (TEMP$ -> B$TABLE(0))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
     2526    20591    7                       GOTO SKIPSET;

  20591  9 010226   010516 710000 9                  TRA     SKIPSET

     2527    20592    7                       END;
     2528    20593    6                    END;
     2529    20594        /**/
     2530    20595    6                 IF (PARAM$ -> P$TBL.FLAGS.MAXCONST(SET_PARAM)) THEN DO;

  20595  9 010227   001707 236000 1                  LDQ     SET_PARAM
         9 010230   000014 402007                    MPY     12,DL
         9 010231   000000 236106                    LDQ     0,QL,PR0
         9 010232   020000 316003                    CANQ    8192,DU
         9 010233   010256 600000 9                  TZE     s:20603

     2531    20596    6                    IF (VALUE > (PARAM$ -> P$TBL.MAX(SET_PARAM))*(PARAM$ ->

  20596  9 010234   001707 236000 1                  LDQ     SET_PARAM
         9 010235   000014 402007                    MPY     12,DL
         9 010236   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:357  
         9 010237   000011 236110                    LDQ     9,X0,PR0
         9 010240   000013 402110                    MPY     11,X0,PR0
         9 010241   001712 116000 1                  CMPQ    VALUE
         9 010242   010421 605000 9                  TPL     s:20619

     2532    20597    7                      P$TBL.MULT(SET_PARAM))) THEN DO; /* VALUE TOO BIG          */

     2533    20598    7                      CALL VAL_ERROR(%E$P_VALUE2BIG,J,PARAM$ -> P$TBL.MAX(SET_PARAM));

  20598  9 010243   001707 236000 1                  LDQ     SET_PARAM
         9 010244   000014 402003                    MPY     12,DU
         9 010245   000011 036003                    ADLQ    9,DU
         9 010246   000017 036000 1                  ADLQ    PARAM$
         9 010247   000161 235000 10                 LDA     113
         9 010250   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 010251   000164 236000 10                 LDQ     116
         9 010252   200067 756100                    STQ     N$+4,,AUTO
         9 010253   012006 701000 9                  TSX1    VAL_ERROR
         9 010254   000000 011000                    NOP     0

     2534    20599    7                       GOTO SKIPSET;

  20599  9 010255   010516 710000 9                  TRA     SKIPSET

     2535    20600    7                       END;
     2536    20601    6                    END;
     2537    20602    6                 ELSE DO;

     2538    20603    6                    TEMP$ = PARAM$ -> P$TBL.PTR$(PARAM$ -> P$TBL.MAX(SET_PARAM));

  20603  9 010256   001707 236000 1                  LDQ     SET_PARAM
         9 010257   000014 402007                    MPY     12,DL
         9 010260   000011 236106                    LDQ     9,QL,PR0
         9 010261   000014 402007                    MPY     12,DL
         9 010262   000007 236106                    LDQ     7,QL,PR0
         9 010263   000014 756000 1                  STQ     TEMP$

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:358  
     2539    20604    6                    TEMPPTR.SEGID = BITBIN(%SPCL1SID);

  20604  9 010264   006021 236007                    LDQ     3089,DL
         9 010265   000014 752003 1                  STCQ    TEMP$,'03'O

     2540    20605    6                    IF (PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MAX(SET_PARAM)))AND

  20605  9 010266   001707 236000 1                  LDQ     SET_PARAM
         9 010267   000014 402007                    MPY     12,DL
         9 010270   000011 236106                    LDQ     9,QL,PR0
         9 010271   000014 402007                    MPY     12,DL
         9 010272   000000 236106                    LDQ     0,QL,PR0
         9 010273   100000 316003                    CANQ    32768,DU
         9 010274   010344 600000 9                  TZE     s:20611
         9 010275   000014 471400 1                  LDP1    TEMP$
         9 010276   000026 720000 1                  LXL0    J
         9 010277   100000 236110                    LDQ     0,X0,PR1
         9 010300   010344 604000 9                  TMI     s:20611
         9 010301   001712 116000 1                  CMPQ    VALUE
         9 010302   010344 605000 9                  TPL     s:20611

     2541    20606    7                      (VALUE > TEMP$ -> B$TABLE(J)) THEN DO;

     2542    20607    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20607  9 010303   001707 236000 1                  LDQ     SET_PARAM
         9 010304   000014 402007                    MPY     12,DL
         9 010305   000000 621006                    EAX1    0,QL
         9 010306   100000 236110                    LDQ     0,X0,PR1
         9 010307   010325 605000 9                  TPL     s:20607+18
         9 010310   000013 235111                    LDA     11,X1,PR0
         9 010311   010321 604000 9                  TMI     s:20607+14
         9 010312   000001 115007                    CMPA    1,DL
         9 010313   010332 600000 9                  TZE     s:20607+23
         9 010314   000000 235003                    LDA     0,DU
         9 010315   000001 737000                    LLS     1
         9 010316   000013 507111                    DVF     11,X1,PR0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:359  
         9 010317   000044 733000                    LRS     36
         9 010320   010332 710000 9                  TRA     s:20607+23
         9 010321   000013 116111                    CMPQ    11,X1,PR0
         9 010322   010327 602000 9                  TNC     s:20607+20
         9 010323   000001 236007                    LDQ     1,DL
         9 010324   010332 710000 9                  TRA     s:20607+23
         9 010325   000013 235111                    LDA     11,X1,PR0
         9 010326   010331 605000 9                  TPL     s:20607+22
         9 010327   000000 236003                    LDQ     0,DU
         9 010330   010332 710000 9                  TRA     s:20607+23
         9 010331   000013 506111                    DIV     11,X1,PR0
         9 010332   200104 756100                    STQ     TEMPTEXT+10,,AUTO
         9 010333   200104 633500                    EPPR3   TEMPTEXT+10,,AUTO
         9 010334   200071 453500                    STP3    @INDX+1,,AUTO
         9 010335   000161 236000 10                 LDQ     113
         9 010336   200070 756100                    STQ     @ERR#+1,,AUTO
         9 010337   000164 236000 10                 LDQ     116
         9 010340   200067 756100                    STQ     N$+4,,AUTO
         9 010341   012006 701000 9                  TSX1    VAL_ERROR
         9 010342   000000 011000                    NOP     0

     2543    20608    7                         (TEMP$ -> B$TABLE(J))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
     2544    20609    7                       GOTO SKIPSET;

  20609  9 010343   010516 710000 9                  TRA     SKIPSET

     2545    20610    7                       END;
     2546    20611    6                   IF (NOT(PARAM$ -> P$TBL.FLAGS.INDX(PARAM$ -> P$TBL.MAX(SET_PARAM)))
             20611                             )AND

  20611  9 010344   001707 236000 1                  LDQ     SET_PARAM
         9 010345   000014 402007                    MPY     12,DL
         9 010346   000011 236106                    LDQ     9,QL,PR0
         9 010347   000014 402007                    MPY     12,DL
         9 010350   000000 236106                    LDQ     0,QL,PR0
         9 010351   100000 316003                    CANQ    32768,DU
         9 010352   010421 601000 9                  TNZ     s:20619
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:360  
         9 010353   000014 471400 1                  LDP1    TEMP$
         9 010354   100000 236100                    LDQ     0,,PR1
         9 010355   010421 604000 9                  TMI     s:20619
         9 010356   001712 116000 1                  CMPQ    VALUE
         9 010357   010421 605000 9                  TPL     s:20619

     2547    20612    7                      (VALUE > TEMP$ -> B$TABLE(0)) THEN DO;

     2548    20613    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20613  9 010360   001707 236000 1                  LDQ     SET_PARAM
         9 010361   000014 402007                    MPY     12,DL
         9 010362   000000 620006                    EAX0    0,QL
         9 010363   100000 236100                    LDQ     0,,PR1
         9 010364   010402 605000 9                  TPL     s:20613+18
         9 010365   000013 235110                    LDA     11,X0,PR0
         9 010366   010376 604000 9                  TMI     s:20613+14
         9 010367   000001 115007                    CMPA    1,DL
         9 010370   010407 600000 9                  TZE     s:20613+23
         9 010371   000000 235003                    LDA     0,DU
         9 010372   000001 737000                    LLS     1
         9 010373   000013 507110                    DVF     11,X0,PR0
         9 010374   000044 733000                    LRS     36
         9 010375   010407 710000 9                  TRA     s:20613+23
         9 010376   000013 116110                    CMPQ    11,X0,PR0
         9 010377   010404 602000 9                  TNC     s:20613+20
         9 010400   000001 236007                    LDQ     1,DL
         9 010401   010407 710000 9                  TRA     s:20613+23
         9 010402   000013 235110                    LDA     11,X0,PR0
         9 010403   010406 605000 9                  TPL     s:20613+22
         9 010404   000000 236003                    LDQ     0,DU
         9 010405   010407 710000 9                  TRA     s:20613+23
         9 010406   000013 506110                    DIV     11,X0,PR0
         9 010407   200105 756100                    STQ     TEMPTEXT+11,,AUTO
         9 010410   200105 633500                    EPPR3   TEMPTEXT+11,,AUTO
         9 010411   200071 453500                    STP3    @INDX+1,,AUTO
         9 010412   000161 236000 10                 LDQ     113
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:361  
         9 010413   200070 756100                    STQ     @ERR#+1,,AUTO
         9 010414   000164 236000 10                 LDQ     116
         9 010415   200067 756100                    STQ     N$+4,,AUTO
         9 010416   012006 701000 9                  TSX1    VAL_ERROR
         9 010417   000000 011000                    NOP     0

     2549    20614    7                         (TEMP$ -> B$TABLE(0))/(PARAM$ -> P$TBL.MULT(SET_PARAM)));
     2550    20615    7                       GOTO SKIPSET;

  20615  9 010420   010516 710000 9                  TRA     SKIPSET

     2551    20616    7                       END;
     2552    20617    6                    END;
     2553    20618        /**/
     2554    20619    5                 CALL M$TIME (CUR_UTS);

  20619  9 010421   010170 630400 1                  EPPR0   CUR_UTS
         9 010422   020004 713400                    CLIMB   8196
         9 010423   402000 401760                    pmme    nvectors=5

     2555    20620    5                 IF (SET_CAT = %PC_SYSTEM) AND

  20620  9 010424   001706 235000 1                  LDA     SET_CAT
         9 010425   000001 115007                    CMPA    1,DL
         9 010426   010447 601000 9                  TNZ     s:20627
         9 010427   001734 236000 1                  LDQ     CURUTS
         9 010430   000075 116000 2                  CMPQ    DUMP_LOCK_FMT+20
         9 010431   010447 602000 9                  TNC     s:20627
         9 010432   001707 235000 1                  LDA     SET_PARAM
         9 010433   000031 115007                    CMPA    25,DL
         9 010434   010437 604000 9                  TMI     s:20620+11
         9 010435   000042 115007                    CMPA    34,DL
         9 010436   010441 604400 9                  TMOZ    s:20625
         9 010437   000064 115007                    CMPA    52,DL
         9 010440   010447 601000 9                  TNZ     s:20627

     2556    20621    5                   (CURUTS >= %UTS_CUSP#) AND
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:362  
     2557    20622    5                   (((SET_PARAM >= %PC_EXPTIME_LO) AND
     2558    20623    5                   (SET_PARAM <= %PC_EXPTIME_HI)) OR
     2559    20624    5                   (SET_PARAM = %PC_PROTECTSECLOG)) THEN /* 1/100 -> 1/25 */
     2560    20625    5                    MONPTR$ -> B$TABLE(J) = VALUE / 4;

  20625  9 010441   001712 236000 1                  LDQ     VALUE
         9 010442   000004 506007                    DIV     4,DL
         9 010443   000010 470400 1                  LDP0    MONPTR$
         9 010444   000026 720000 1                  LXL0    J
         9 010445   000000 756110                    STQ     0,X0,PR0
         9 010446   010453 710000 9                  TRA     s:20629

     2561    20626    5                 ELSE
     2562    20627    5                   MONPTR$ -> B$TABLE(J) = VALUE;

  20627  9 010447   001712 235000 1                  LDA     VALUE
         9 010450   000010 470400 1                  LDP0    MONPTR$
         9 010451   000026 720000 1                  LXL0    J
         9 010452   000000 755110                    STA     0,X0,PR0

     2563    20628        /**/
     2564    20629    5                 IF (SET_CAT = %PC_SYSTEM)AND

  20629  9 010453   001706 235000 1                  LDA     SET_CAT
         9 010454   000001 115007                    CMPA    1,DL
         9 010455   010502 601000 9                  TNZ     s:20638
         9 010456   001707 236000 1                  LDQ     SET_PARAM
         9 010457   000016 116007                    CMPQ    14,DL
         9 010460   010502 601000 9                  TNZ     s:20638

     2565    20630    6                   (SET_PARAM = %PC_NPART) THEN DO; /* SET JM_CHNG IF NPART*/

     2566    20631    6                    TEMP$ = ADDR(JM_CHNG);

  20631  9 010461   000165 236000 10                 LDQ     117
         9 010462   000014 756000 1                  STQ     TEMP$

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:363  
     2567    20632    6                    TEMPPTR.SEGID = BITBIN(%SPCL1SID);

  20632  9 010463   006021 236007                    LDQ     3089,DL
         9 010464   000014 752003 1                  STCQ    TEMP$,'03'O

     2568    20633    7                    DO TEMP1 = 0 TO VALUE-1;

  20633  9 010465   000023 450000 1                  STZ     TEMP1
         9 010466   010477 710000 9                  TRA     s:20635+1

     2569    20634    7                       TEMP$ -> B$BITS(TEMP1) = YES;

  20634  9 010467   000023 235000 1                  LDA     TEMP1
         9 010470   010472 605000 9                  TPL     s:20634+3
         9 010471   000044 035003                    ADLA    36,DU
         9 010472   000014 470400 1                  LDP0    TEMP$
         9 010473   003105 060400                    CSL     bolr='003'O
         9 010474   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 010475   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1

     2570    20635    7                       END;

  20635  9 010476   000023 054000 1                  AOS     TEMP1
         9 010477   000023 236000 1                  LDQ     TEMP1
         9 010500   001712 116000 1                  CMPQ    VALUE
         9 010501   010467 604000 9                  TMI     s:20634

     2571    20636    6                    END;

     2572    20637        /**/
     2573    20638    5                 CALL M$OPEN(OPEN_CNTRL_FPT) ALTRET(CNTRL_ERR); /* UPDATE FILE   */

  20638  9 010502   010272 630400 1                  EPPR0   OPEN_CNTRL_FPT
         9 010503   450000 713400                    CLIMB   alt,open
         9 010504   410400 401760                    pmme    nvectors=18
         9 010505   011737 702000 9                  TSX2    CNTRL_ERR

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:364  
     2574    20639    5                 CALL M$WRITE(WRITE_CNTRL_FPT) ALTRET(CNTRL_ERR);

  20639  9 010506   010634 630400 1                  EPPR0   WRITE_CNTRL_FPT
         9 010507   440001 713400                    CLIMB   alt,write
         9 010510   401400 401760                    pmme    nvectors=4
         9 010511   011737 702000 9                  TSX2    CNTRL_ERR

     2575    20640    5                 CALL M$CLOSE (CLOSE_CNTRL_FPT) ALTRET(CNTRL_ERR);

  20640  9 010512   010650 630400 1                  EPPR0   CLOSE_CNTRL_FPT
         9 010513   450001 713400                    CLIMB   alt,close
         9 010514   406000 401760                    pmme    nvectors=13
         9 010515   011737 702000 9                  TSX2    CNTRL_ERR

     2576    20641    5   SKIPSET:
     2577    20642    5                 END;

  20642  9 010516   000026 054000 1     SKIPSET      AOS     J
         9 010517   000026 236000 1                  LDQ     J
         9 010520   001711 116000 1                  CMPQ    SET_INDEXHI
         9 010521   010034 604400 9                  TMOZ    s:20571
         9 010522   011767 710000 9                  TRA     s:20866

     2578    20643        /**/
     2579    20644    4            CASE(%PC_RESOURCE);

     2580    20645    5              DO J = SET_INDEXLO TO SET_INDEXHI;

  20645  9 010523   001710 235000 1                  LDA     SET_INDEXLO
         9 010524   000026 755000 1                  STA     J
         9 010525   010675 710000 9                  TRA     RESSKIPSET+1

     2581    20646    6                 IF (RES_INDX = %MMINDX) THEN DO; /* MEMORY IS SPECIAL            */

  20646  9 010526   000062 235000 1                  LDA     RES_INDX
         9 010527   010557 601000 9                  TNZ     s:20657

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:365  
     2582    20647    6                    MONPTR$ = ADDR(FR_MEMM);

  20647  9 010530   000166 236000 10                 LDQ     118
         9 010531   000010 756000 1                  STQ     MONPTR$

     2583    20648    6                    MONPTR.SEGID = BITBIN(%SPCL1SID);

  20648  9 010532   006021 236007                    LDQ     3089,DL
         9 010533   000010 752003 1                  STCQ    MONPTR$,'03'O

     2584    20649    7                    IF (VALUE > MONPTR$ -> B$TABLE(0) AND J ~= 0) THEN DO;

  20649  9 010534   000010 470400 1                  LDP0    MONPTR$
         9 010535   000000 236100                    LDQ     0,,PR0
         9 010536   010553 604000 9                  TMI     s:20654
         9 010537   001712 116000 1                  CMPQ    VALUE
         9 010540   010553 605000 9                  TPL     s:20654
         9 010541   000026 235000 1                  LDA     J
         9 010542   010553 600000 9                  TZE     s:20654

     2585    20650    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20650  9 010543   000010 236000 1                  LDQ     MONPTR$
         9 010544   000161 235000 10                 LDA     113
         9 010545   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 010546   000164 236000 10                 LDQ     116
         9 010547   200067 756100                    STQ     N$+4,,AUTO
         9 010550   012006 701000 9                  TSX1    VAL_ERROR
         9 010551   000000 011000                    NOP     0

     2586    20651    7                         MONPTR$ -> B$TABLE(0));
     2587    20652    7                       GOTO RESSKIPSET;

  20652  9 010552   010674 710000 9                  TRA     RESSKIPSET

     2588    20653    7                       END;
     2589    20654    6                    MONPTR$ -> B$TABLE(J) = VALUE;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:366  

  20654  9 010553   001712 235000 1                  LDA     VALUE
         9 010554   000026 720000 1                  LXL0    J
         9 010555   000000 755110                    STA     0,X0,PR0

     2590    20655    6                    END;

  20655  9 010556   010660 710000 9                  TRA     s:20681

     2591    20656        /**/
     2592    20657    6                 ELSE IF (RES_INDX < %PSURES_OFFSET) THEN DO;

  20657  9 010557   000004 115007                    CMPA    4,DL
         9 010560   010621 605000 9                  TPL     s:20670

     2593    20658    6                       MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(SET_PARAM);

  20658  9 010561   001707 236000 1                  LDQ     SET_PARAM
         9 010562   000014 402007                    MPY     12,DL
         9 010563   000003 470400 1                  LDP0    RES$
         9 010564   000007 236106                    LDQ     7,QL,PR0
         9 010565   000010 752074 1                  STCQ    MONPTR$,'74'O

     2594    20659    6                       TEMPPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);

  20659  9 010566   000010 471400 1                  LDP1    MONPTR$
         9 010567   100000 236100                    LDQ     0,,PR1
         9 010570   000014 752074 1                  STCQ    TEMP$,'74'O

     2595    20660    6                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);

  20660  9 010571   000026 720000 1                  LXL0    J
         9 010572   100000 236110                    LDQ     0,X0,PR1
         9 010573   000010 752074 1                  STCQ    MONPTR$,'74'O

     2596    20661    7                       IF (VALUE > TEMP$ -> B$TABLE(RES_INDX-1)) THEN DO;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:367  
  20661  9 010574   000014 471400 1                  LDP1    TEMP$
         9 010575   000062 721000 1                  LXL1    RES_INDX
         9 010576   177777 236111                    LDQ     -1,X1,PR1
         9 010577   010615 604000 9                  TMI     s:20666
         9 010600   001712 116000 1                  CMPQ    VALUE
         9 010601   010615 605000 9                  TPL     s:20666

     2597    20662    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20662  9 010602   000062 236000 1                  LDQ     RES_INDX
         9 010603   000022 736000                    QLS     18
         9 010604   000001 136003                    SBLQ    1,DU
         9 010605   000014 036000 1                  ADLQ    TEMP$
         9 010606   000161 235000 10                 LDA     113
         9 010607   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 010610   000164 236000 10                 LDQ     116
         9 010611   200067 756100                    STQ     N$+4,,AUTO
         9 010612   012006 701000 9                  TSX1    VAL_ERROR
         9 010613   000000 011000                    NOP     0

     2598    20663    7                             TEMP$ -> B$TABLE(RES_INDX-1));
     2599    20664    7                          GOTO RESSKIPSET;

  20664  9 010614   010674 710000 9                  TRA     RESSKIPSET

     2600    20665    7                          END;
     2601    20666    6                       MONPTR$ -> B$TABLE(RES_INDX-1) = VALUE;

  20666  9 010615   001712 235000 1                  LDA     VALUE
         9 010616   000010 473400 1                  LDP3    MONPTR$
         9 010617   377777 755111                    STA     -1,X1,PR3

     2602    20667    6                       END;

  20667  9 010620   010660 710000 9                  TRA     s:20681

     2603    20668        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:368  
     2604    20669    6                    ELSE DO;

     2605    20670    6                       MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(SET_PARAM);

  20670  9 010621   001707 236000 1                  LDQ     SET_PARAM
         9 010622   000014 402007                    MPY     12,DL
         9 010623   000003 470400 1                  LDP0    RES$
         9 010624   000010 236106                    LDQ     8,QL,PR0
         9 010625   000010 752074 1                  STCQ    MONPTR$,'74'O

     2606    20671    6                       TEMPPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);

  20671  9 010626   000010 471400 1                  LDP1    MONPTR$
         9 010627   100000 236100                    LDQ     0,,PR1
         9 010630   000014 752074 1                  STCQ    TEMP$,'74'O

     2607    20672    6                       MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(J);

  20672  9 010631   000026 720000 1                  LXL0    J
         9 010632   100000 236110                    LDQ     0,X0,PR1
         9 010633   000010 752074 1                  STCQ    MONPTR$,'74'O

     2608    20673    7                      IF (VALUE > TEMP$ -> B$TABLE(RES_INDX - %PSURES_OFFSET)) THEN DO
             20673                                ;

  20673  9 010634   000014 471400 1                  LDP1    TEMP$
         9 010635   000062 721000 1                  LXL1    RES_INDX
         9 010636   177774 236111                    LDQ     -4,X1,PR1
         9 010637   010655 604000 9                  TMI     s:20678
         9 010640   001712 116000 1                  CMPQ    VALUE
         9 010641   010655 605000 9                  TPL     s:20678

     2609    20674    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20674  9 010642   000062 236000 1                  LDQ     RES_INDX
         9 010643   000022 736000                    QLS     18
         9 010644   000004 136003                    SBLQ    4,DU
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:369  
         9 010645   000014 036000 1                  ADLQ    TEMP$
         9 010646   000161 235000 10                 LDA     113
         9 010647   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 010650   000164 236000 10                 LDQ     116
         9 010651   200067 756100                    STQ     N$+4,,AUTO
         9 010652   012006 701000 9                  TSX1    VAL_ERROR
         9 010653   000000 011000                    NOP     0

     2610    20675    7                            TEMP$ -> B$TABLE(RES_INDX-%PSURES_OFFSET));
     2611    20676    7                          GOTO RESSKIPSET;

  20676  9 010654   010674 710000 9                  TRA     RESSKIPSET

     2612    20677    7                          END;
     2613    20678    6                       MONPTR$ -> B$TABLE(RES_INDX - %PSURES_OFFSET) = VALUE;

  20678  9 010655   001712 235000 1                  LDA     VALUE
         9 010656   000010 473400 1                  LDP3    MONPTR$
         9 010657   377774 755111                    STA     -4,X1,PR3

     2614    20679    6                       END;

     2615    20680        /**/
     2616    20681    5                 CALL M$OPEN(OPEN_CNTRL_FPT) ALTRET(CNTRL_ERR); /* UPDATE FILE   */

  20681  9 010660   010272 630400 1                  EPPR0   OPEN_CNTRL_FPT
         9 010661   450000 713400                    CLIMB   alt,open
         9 010662   410400 401760                    pmme    nvectors=18
         9 010663   011737 702000 9                  TSX2    CNTRL_ERR

     2617    20682    5                 CALL M$WRITE(WRITE_CNTRL_FPT) ALTRET(CNTRL_ERR);

  20682  9 010664   010634 630400 1                  EPPR0   WRITE_CNTRL_FPT
         9 010665   440001 713400                    CLIMB   alt,write
         9 010666   401400 401760                    pmme    nvectors=4
         9 010667   011737 702000 9                  TSX2    CNTRL_ERR

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:370  
     2618    20683    5                 CALL M$CLOSE (CLOSE_CNTRL_FPT) ALTRET(CNTRL_ERR);

  20683  9 010670   010650 630400 1                  EPPR0   CLOSE_CNTRL_FPT
         9 010671   450001 713400                    CLIMB   alt,close
         9 010672   406000 401760                    pmme    nvectors=13
         9 010673   011737 702000 9                  TSX2    CNTRL_ERR

     2619    20684    5   RESSKIPSET:
     2620    20685    5                 END;

  20685  9 010674   000026 054000 1     RESSKIPSET   AOS     J
         9 010675   000026 236000 1                  LDQ     J
         9 010676   001711 116000 1                  CMPQ    SET_INDEXHI
         9 010677   010526 604400 9                  TMOZ    s:20646
         9 010700   011767 710000 9                  TRA     s:20866

     2621    20686    4            CASE (%PC_PARTITION);

     2622    20687    5              DO J = SET_INDEXLO TO SET_INDEXHI;

  20687  9 010701   001710 235000 1                  LDA     SET_INDEXLO
         9 010702   000026 755000 1                  STA     J
         9 010703   011714 710000 9                  TRA     PARTSKIPSET+1

     2623    20688    5                 SET_PDT$ = PINCRW(PDT$,SIZEW(JM$PT)*J);

  20688  9 010704   000026 236000 1                  LDQ     J
         9 010705   000023 402003                    MPY     19,DU
         9 010706   001702 036000 1                  ADLQ    PDT$
         9 010707   001704 756000 1                  STQ     SET_PDT$

     2624    20689    5                 SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*J);

  20689  9 010710   000026 236000 1                  LDQ     J
         9 010711   000023 402003                    MPY     19,DU
         9 010712   001703 036000 1                  ADLQ    PDTFLAG$
         9 010713   001705 756000 1                  STQ     SET_PDTFLAG$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:371  

     2625    20690    5                 MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*J);

  20690  9 010714   000026 236000 1                  LDQ     J
         9 010715   000023 402003                    MPY     19,DU
         9 010716   000011 036000 1                  ADLQ    MONPART$
         9 010717   000010 756000 1                  STQ     MONPTR$

     2626    20691        /**/
     2627    20692    6                 DO CASE(SET_PARAM);

  20692  9 010720   001707 235000 1                  LDA     SET_PARAM
         9 010721   000012 115007                    CMPA    10,DL
         9 010722   010724 602005 9                  TNC     s:20692+4,AL
         9 010723   011713 710000 9                  TRA     PARTSKIPSET
         9 010724   011713 710000 9                  TRA     PARTSKIPSET
         9 010725   010736 710000 9                  TRA     s:20695
         9 010726   011057 710000 9                  TRA     s:20712
         9 010727   011216 710000 9                  TRA     s:20734
         9 010730   011303 710000 9                  TRA     s:20751
         9 010731   011464 710000 9                  TRA     s:20792
         9 010732   011531 710000 9                  TRA     s:20805
         9 010733   011573 710000 9                  TRA     s:20818
         9 010734   011632 710000 9                  TRA     s:20829
         9 010735   011670 710000 9                  TRA     s:20840

     2628    20693        /**/
     2629    20694    6                  CASE (%PC_PMINTI);

     2630    20695    7                    IF (SET_PDTFLAG$ -> JM$PT.TU ~= 0) THEN DO;

  20695  9 010736   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 010737   000001 235100                    LDA     1,,PR0
         9 010740   011005 600000 9                  TZE     s:20703

     2631    20696    8                       IF (VALUE > SET_PDT$ -> JM$PT.TU) THEN DO;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:372  
  20696  9 010741   001704 471400 1                  LDP1    SET_PDT$
         9 010742   100001 236100                    LDQ     1,,PR1
         9 010743   011051 604000 9                  TMI     s:20708
         9 010744   001712 116000 1                  CMPQ    VALUE
         9 010745   011051 605000 9                  TPL     s:20708

     2632    20697    8                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20697  9 010746   000002 473400 1                  LDP3    PART$
         9 010747   000000 116003                    CMPQ    0,DU
         9 010750   010766 605000 9                  TPL     s:20697+16
         9 010751   300027 235100                    LDA     23,,PR3
         9 010752   010762 604000 9                  TMI     s:20697+12
         9 010753   000001 115007                    CMPA    1,DL
         9 010754   010773 600000 9                  TZE     s:20697+21
         9 010755   000000 235003                    LDA     0,DU
         9 010756   000001 737000                    LLS     1
         9 010757   300027 507100                    DVF     23,,PR3
         9 010760   000044 733000                    LRS     36
         9 010761   010773 710000 9                  TRA     s:20697+21
         9 010762   300027 116100                    CMPQ    23,,PR3
         9 010763   010770 602000 9                  TNC     s:20697+18
         9 010764   000001 236007                    LDQ     1,DL
         9 010765   010773 710000 9                  TRA     s:20697+21
         9 010766   300027 235100                    LDA     23,,PR3
         9 010767   010772 605000 9                  TPL     s:20697+20
         9 010770   000000 236003                    LDQ     0,DU
         9 010771   010773 710000 9                  TRA     s:20697+21
         9 010772   300027 506100                    DIV     23,,PR3
         9 010773   200106 756100                    STQ     TEMPTEXT+12,,AUTO
         9 010774   200106 634500                    EPPR4   TEMPTEXT+12,,AUTO
         9 010775   200071 454500                    STP4    @INDX+1,,AUTO
         9 010776   000161 236000 10                 LDQ     113
         9 010777   200070 756100                    STQ     @ERR#+1,,AUTO
         9 011000   000164 236000 10                 LDQ     116
         9 011001   200067 756100                    STQ     N$+4,,AUTO
         9 011002   012006 701000 9                  TSX1    VAL_ERROR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:373  
         9 011003   000000 011000                    NOP     0

     2633    20698    8                            (SET_PDT$ -> JM$PT.TU)/PART$ -> P$TBL.MULT(%PC_PMINTI));
     2634    20699    8                          GOTO PARTSKIPSET;

  20699  9 011004   011713 710000 9                  TRA     PARTSKIPSET

     2635    20700    8                          END;
     2636    20701    7                       ELSE;
     2637    20702    7                       END;
     2638    20703    7                    ELSE IF (VALUE > MONPTR$ -> JM$PT.TU) THEN DO;

  20703  9 011005   000010 471400 1                  LDP1    MONPTR$
         9 011006   100001 236100                    LDQ     1,,PR1
         9 011007   011051 604000 9                  TMI     s:20708
         9 011010   001712 116000 1                  CMPQ    VALUE
         9 011011   011051 605000 9                  TPL     s:20708

     2639    20704    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20704  9 011012   000002 473400 1                  LDP3    PART$
         9 011013   000000 116003                    CMPQ    0,DU
         9 011014   011032 605000 9                  TPL     s:20704+16
         9 011015   300027 235100                    LDA     23,,PR3
         9 011016   011026 604000 9                  TMI     s:20704+12
         9 011017   000001 115007                    CMPA    1,DL
         9 011020   011037 600000 9                  TZE     s:20704+21
         9 011021   000000 235003                    LDA     0,DU
         9 011022   000001 737000                    LLS     1
         9 011023   300027 507100                    DVF     23,,PR3
         9 011024   000044 733000                    LRS     36
         9 011025   011037 710000 9                  TRA     s:20704+21
         9 011026   300027 116100                    CMPQ    23,,PR3
         9 011027   011034 602000 9                  TNC     s:20704+18
         9 011030   000001 236007                    LDQ     1,DL
         9 011031   011037 710000 9                  TRA     s:20704+21
         9 011032   300027 235100                    LDA     23,,PR3
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:374  
         9 011033   011036 605000 9                  TPL     s:20704+20
         9 011034   000000 236003                    LDQ     0,DU
         9 011035   011037 710000 9                  TRA     s:20704+21
         9 011036   300027 506100                    DIV     23,,PR3
         9 011037   200107 756100                    STQ     TEMPTEXT+13,,AUTO
         9 011040   200107 634500                    EPPR4   TEMPTEXT+13,,AUTO
         9 011041   200071 454500                    STP4    @INDX+1,,AUTO
         9 011042   000161 236000 10                 LDQ     113
         9 011043   200070 756100                    STQ     @ERR#+1,,AUTO
         9 011044   000164 236000 10                 LDQ     116
         9 011045   200067 756100                    STQ     N$+4,,AUTO
         9 011046   012006 701000 9                  TSX1    VAL_ERROR
         9 011047   000000 011000                    NOP     0

     2640    20705    7                            (MONPTR$ -> JM$PT.TU)/PART$ -> P$TBL.MULT(%PC_PMINTI));
     2641    20706    7                          GOTO PARTSKIPSET;

  20706  9 011050   011713 710000 9                  TRA     PARTSKIPSET

     2642    20707    7                          END;
     2643    20708    6                    SET_PDT$ -> JM$PT.TL = VALUE;

  20708  9 011051   001712 236000 1                  LDQ     VALUE
         9 011052   001704 471400 1                  LDP1    SET_PDT$
         9 011053   100000 756100                    STQ     0,,PR1

     2644    20709    6                    SET_PDTFLAG$ -> JM$PT.TL = 1;

  20709  9 011054   000001 235007                    LDA     1,DL
         9 011055   000000 755100                    STA     0,,PR0
         9 011056   011713 710000 9                  TRA     PARTSKIPSET

     2645    20710        /**/
     2646    20711    6                  CASE (%PC_PMAXTI);

     2647    20712    7                    IF (SET_PDTFLAG$ -> JM$PT.TL ~= 0) THEN DO;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:375  
  20712  9 011057   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 011060   000000 235100                    LDA     0,,PR0
         9 011061   011126 600000 9                  TZE     s:20720

     2648    20713    8                       IF (VALUE < SET_PDT$ -> JM$PT.TL) THEN DO;

  20713  9 011062   001704 471400 1                  LDP1    SET_PDT$
         9 011063   001712 236000 1                  LDQ     VALUE
         9 011064   011067 604000 9                  TMI     s:20714
         9 011065   100000 116100                    CMPQ    0,,PR1
         9 011066   011172 603000 9                  TRC     s:20725

     2649    20714    8                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,

  20714  9 011067   000002 473400 1                  LDP3    PART$
         9 011070   100000 236100                    LDQ     0,,PR1
         9 011071   011107 605000 9                  TPL     s:20714+16
         9 011072   300043 235100                    LDA     35,,PR3
         9 011073   011103 604000 9                  TMI     s:20714+12
         9 011074   000001 115007                    CMPA    1,DL
         9 011075   011114 600000 9                  TZE     s:20714+21
         9 011076   000000 235003                    LDA     0,DU
         9 011077   000001 737000                    LLS     1
         9 011100   300043 507100                    DVF     35,,PR3
         9 011101   000044 733000                    LRS     36
         9 011102   011114 710000 9                  TRA     s:20714+21
         9 011103   300043 116100                    CMPQ    35,,PR3
         9 011104   011111 602000 9                  TNC     s:20714+18
         9 011105   000001 236007                    LDQ     1,DL
         9 011106   011114 710000 9                  TRA     s:20714+21
         9 011107   300043 235100                    LDA     35,,PR3
         9 011110   011113 605000 9                  TPL     s:20714+20
         9 011111   000000 236003                    LDQ     0,DU
         9 011112   011114 710000 9                  TRA     s:20714+21
         9 011113   300043 506100                    DIV     35,,PR3
         9 011114   200110 756100                    STQ     TEMPTEXT+14,,AUTO
         9 011115   200110 634500                    EPPR4   TEMPTEXT+14,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:376  
         9 011116   200071 454500                    STP4    @INDX+1,,AUTO
         9 011117   000161 236000 10                 LDQ     113
         9 011120   200070 756100                    STQ     @ERR#+1,,AUTO
         9 011121   000162 236000 10                 LDQ     114
         9 011122   200067 756100                    STQ     N$+4,,AUTO
         9 011123   012006 701000 9                  TSX1    VAL_ERROR
         9 011124   000000 011000                    NOP     0

     2650    20715    8                            (SET_PDT$ -> JM$PT.TL)/PART$ -> P$TBL.MULT(%PC_PMAXTI));
     2651    20716    8                          GOTO PARTSKIPSET;

  20716  9 011125   011713 710000 9                  TRA     PARTSKIPSET

     2652    20717    8                          END;
     2653    20718    7                       ELSE;
     2654    20719    7                       END;
     2655    20720    7                    ELSE IF (VALUE < MONPTR$ -> JM$PT.TL) THEN DO;

  20720  9 011126   000010 471400 1                  LDP1    MONPTR$
         9 011127   001712 236000 1                  LDQ     VALUE
         9 011130   011133 604000 9                  TMI     s:20721
         9 011131   100000 116100                    CMPQ    0,,PR1
         9 011132   011172 603000 9                  TRC     s:20725

     2656    20721    7                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,

  20721  9 011133   000002 473400 1                  LDP3    PART$
         9 011134   100000 236100                    LDQ     0,,PR1
         9 011135   011153 605000 9                  TPL     s:20721+16
         9 011136   300043 235100                    LDA     35,,PR3
         9 011137   011147 604000 9                  TMI     s:20721+12
         9 011140   000001 115007                    CMPA    1,DL
         9 011141   011160 600000 9                  TZE     s:20721+21
         9 011142   000000 235003                    LDA     0,DU
         9 011143   000001 737000                    LLS     1
         9 011144   300043 507100                    DVF     35,,PR3
         9 011145   000044 733000                    LRS     36
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:377  
         9 011146   011160 710000 9                  TRA     s:20721+21
         9 011147   300043 116100                    CMPQ    35,,PR3
         9 011150   011155 602000 9                  TNC     s:20721+18
         9 011151   000001 236007                    LDQ     1,DL
         9 011152   011160 710000 9                  TRA     s:20721+21
         9 011153   300043 235100                    LDA     35,,PR3
         9 011154   011157 605000 9                  TPL     s:20721+20
         9 011155   000000 236003                    LDQ     0,DU
         9 011156   011160 710000 9                  TRA     s:20721+21
         9 011157   300043 506100                    DIV     35,,PR3
         9 011160   200111 756100                    STQ     TEMPTEXT+15,,AUTO
         9 011161   200111 634500                    EPPR4   TEMPTEXT+15,,AUTO
         9 011162   200071 454500                    STP4    @INDX+1,,AUTO
         9 011163   000161 236000 10                 LDQ     113
         9 011164   200070 756100                    STQ     @ERR#+1,,AUTO
         9 011165   000162 236000 10                 LDQ     114
         9 011166   200067 756100                    STQ     N$+4,,AUTO
         9 011167   012006 701000 9                  TSX1    VAL_ERROR
         9 011170   000000 011000                    NOP     0

     2657    20722    7                            (MONPTR$ -> JM$PT.TL)/PART$ -> P$TBL.MULT(%PC_PMAXTI));
     2658    20723    7                          GOTO PARTSKIPSET;

  20723  9 011171   011713 710000 9                  TRA     PARTSKIPSET

     2659    20724    7                          END;
     2660    20725    6                    IF (VALUE > (PART$ -> P$TBL.MAX(%PC_PMAXTI))*

  20725  9 011172   000002 471400 1                  LDP1    PART$
         9 011173   100041 236100                    LDQ     33,,PR1
         9 011174   100043 402100                    MPY     35,,PR1
         9 011175   001712 116000 1                  CMPQ    VALUE
         9 011176   011210 605000 9                  TPL     s:20730

     2661    20726    7                      (PART$ -> P$TBL.MULT(%PC_PMAXTI))) THEN DO;

     2662    20727    7                      CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PMINTI));
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:378  

  20727  9 011177   000002 236000 1                  LDQ     PART$
         9 011200   000025 036003                    ADLQ    21,DU
         9 011201   000161 235000 10                 LDA     113
         9 011202   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011203   000164 236000 10                 LDQ     116
         9 011204   200067 756100                    STQ     N$+4,,AUTO
         9 011205   012006 701000 9                  TSX1    VAL_ERROR
         9 011206   000000 011000                    NOP     0

     2663    20728    7                       GOTO PARTSKIPSET;

  20728  9 011207   011713 710000 9                  TRA     PARTSKIPSET

     2664    20729    7                       END;
     2665    20730    6                    SET_PDT$ -> JM$PT.TU = VALUE;

  20730  9 011210   001712 235000 1                  LDA     VALUE
         9 011211   001704 473400 1                  LDP3    SET_PDT$
         9 011212   300001 755100                    STA     1,,PR3

     2666    20731    6                    SET_PDTFLAG$ -> JM$PT.TU = 1;

  20731  9 011213   000001 236007                    LDQ     1,DL
         9 011214   000001 756100                    STQ     1,,PR0
         9 011215   011713 710000 9                  TRA     PARTSKIPSET

     2667    20732        /**/
     2668    20733    6                  CASE (%PC_PMINRES);

     2669    20734    7                    IF (SET_PDTFLAG$ -> JM$PT.RMAX(RES_INDX) ~= 0) THEN DO;

  20734  9 011216   000062 235000 1                  LDA     RES_INDX
         9 011217   000001 735000                    ALS     1
         9 011220   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 011221   000100 101505                    MRL     fill='000'O
         9 011222   000007 000002                    ADSC9   7,A,PR0                  cn=0,n=2
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:379  
         9 011223   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 011224   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 011225   000000 116003                    CMPQ    0,DU
         9 011226   011250 600000 9                  TZE     s:20742

     2670    20735    8                       IF (VALUE > SET_PDT$ -> JM$PT.RMAX(RES_INDX)) THEN DO;

  20735  9 011227   001704 471400 1                  LDP1    SET_PDT$
         9 011230   000100 101505                    MRL     fill='000'O
         9 011231   100007 000002                    ADSC9   7,A,PR1                  cn=0,n=2
         9 011232   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 011233   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 011234   001712 116000 1                  CMPQ    VALUE
         9 011235   011271 605000 9                  TPL     s:20747

     2671    20736    8                          TEMP1 = SET_PDT$ -> JM$PT.RMAX(RES_INDX);

  20736  9 011236   000000 101505                    MRL     fill='000'O
         9 011237   100007 000002                    ADSC9   7,A,PR1                  cn=0,n=2
         9 011240   000023 000004 1                  ADSC9   TEMP1                    cn=0,n=4

     2672    20737    8                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,TEMP1);

  20737  9 011241   000170 237000 10                 LDAQ    120
         9 011242   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011243   000164 236000 10                 LDQ     116
         9 011244   200067 756100                    STQ     N$+4,,AUTO
         9 011245   012006 701000 9                  TSX1    VAL_ERROR
         9 011246   000000 011000                    NOP     0

     2673    20738    8                          GOTO PARTSKIPSET;

  20738  9 011247   011713 710000 9                  TRA     PARTSKIPSET

     2674    20739    8                          END;
     2675    20740    7                       ELSE;
     2676    20741    7                       END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:380  
     2677    20742    7                    ELSE IF (VALUE > MONPTR$ -> JM$PT.RMAX(RES_INDX)) THEN DO;

  20742  9 011250   000010 471400 1                  LDP1    MONPTR$
         9 011251   000100 101505                    MRL     fill='000'O
         9 011252   100007 000002                    ADSC9   7,A,PR1                  cn=0,n=2
         9 011253   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 011254   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 011255   001712 116000 1                  CMPQ    VALUE
         9 011256   011271 605000 9                  TPL     s:20747

     2678    20743    7                          TEMP1 = MONPTR$ -> JM$PT.RMAX(RES_INDX);

  20743  9 011257   000000 101505                    MRL     fill='000'O
         9 011260   100007 000002                    ADSC9   7,A,PR1                  cn=0,n=2
         9 011261   000023 000004 1                  ADSC9   TEMP1                    cn=0,n=4

     2679    20744    7                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,TEMP1);

  20744  9 011262   000170 237000 10                 LDAQ    120
         9 011263   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011264   000164 236000 10                 LDQ     116
         9 011265   200067 756100                    STQ     N$+4,,AUTO
         9 011266   012006 701000 9                  TSX1    VAL_ERROR
         9 011267   000000 011000                    NOP     0

     2680    20745    7                          GOTO PARTSKIPSET;

  20745  9 011270   011713 710000 9                  TRA     PARTSKIPSET

     2681    20746    7                          END;
     2682    20747    6                    SET_PDT$ -> JM$PT.RMIN(RES_INDX) = VALUE;

  20747  9 011271   001704 471400 1                  LDP1    SET_PDT$
         9 011272   000105 101400                    MRL     fill='000'O
         9 011273   001712 000004 1                  ADSC9   VALUE                    cn=0,n=4
         9 011274   100015 000002                    ADSC9   13,A,PR1                 cn=0,n=2

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:381  
     2683    20748    6                    SET_PDTFLAG$ -> JM$PT.RMIN(RES_INDX) = 1;

  20748  9 011275   000062 235000 1                  LDA     RES_INDX
         9 011276   000001 735000                    ALS     1
         9 011277   000105 101400                    MRL     fill='000'O
         9 011300   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         9 011301   000015 000002                    ADSC9   13,A,PR0                 cn=0,n=2
         9 011302   011713 710000 9                  TRA     PARTSKIPSET

     2684    20749        /**/
     2685    20750    6                  CASE (%PC_PMAXRES);

     2686    20751    7                    IF (SET_PDTFLAG$ -> JM$PT.RMIN(RES_INDX) ~= 0) THEN DO;

  20751  9 011303   000062 235000 1                  LDA     RES_INDX
         9 011304   000001 735000                    ALS     1
         9 011305   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 011306   000100 101505                    MRL     fill='000'O
         9 011307   000015 000002                    ADSC9   13,A,PR0                 cn=0,n=2
         9 011310   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 011311   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 011312   000000 116003                    CMPQ    0,DU
         9 011313   011335 600000 9                  TZE     s:20759

     2687    20752    8                       IF (VALUE < SET_PDT$ -> JM$PT.RMIN(RES_INDX)) THEN DO;

  20752  9 011314   001704 471400 1                  LDP1    SET_PDT$
         9 011315   000100 101505                    MRL     fill='000'O
         9 011316   100015 000002                    ADSC9   13,A,PR1                 cn=0,n=2
         9 011317   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 011320   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 011321   001712 116000 1                  CMPQ    VALUE
         9 011322   011356 604400 9                  TMOZ    s:20764

     2688    20753    8                          TEMP1 = SET_PDT$ -> JM$PT.RMIN(RES_INDX);

  20753  9 011323   000000 101505                    MRL     fill='000'O
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:382  
         9 011324   100015 000002                    ADSC9   13,A,PR1                 cn=0,n=2
         9 011325   000023 000004 1                  ADSC9   TEMP1                    cn=0,n=4

     2689    20754    8                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,TEMP1);

  20754  9 011326   000170 237000 10                 LDAQ    120
         9 011327   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011330   000162 236000 10                 LDQ     114
         9 011331   200067 756100                    STQ     N$+4,,AUTO
         9 011332   012006 701000 9                  TSX1    VAL_ERROR
         9 011333   000000 011000                    NOP     0

     2690    20755    8                          GOTO PARTSKIPSET;

  20755  9 011334   011713 710000 9                  TRA     PARTSKIPSET

     2691    20756    8                          END;
     2692    20757    7                       ELSE;
     2693    20758    7                       END;
     2694    20759    7                    ELSE IF (VALUE < MONPTR$ -> JM$PT.RMIN(RES_INDX)) THEN DO;

  20759  9 011335   000010 471400 1                  LDP1    MONPTR$
         9 011336   000100 101505                    MRL     fill='000'O
         9 011337   100015 000002                    ADSC9   13,A,PR1                 cn=0,n=2
         9 011340   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 011341   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 011342   001712 116000 1                  CMPQ    VALUE
         9 011343   011356 604400 9                  TMOZ    s:20764

     2695    20760    7                          TEMP1 = MONPTR$ -> JM$PT.RMIN(RES_INDX);

  20760  9 011344   000000 101505                    MRL     fill='000'O
         9 011345   100015 000002                    ADSC9   13,A,PR1                 cn=0,n=2
         9 011346   000023 000004 1                  ADSC9   TEMP1                    cn=0,n=4

     2696    20761    7                          CALL VAL_ERROR(%E$P_VALUE2SMALL,J,TEMP1);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:383  
  20761  9 011347   000170 237000 10                 LDAQ    120
         9 011350   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011351   000162 236000 10                 LDQ     114
         9 011352   200067 756100                    STQ     N$+4,,AUTO
         9 011353   012006 701000 9                  TSX1    VAL_ERROR
         9 011354   000000 011000                    NOP     0

     2697    20762    7                          GOTO PARTSKIPSET;

  20762  9 011355   011713 710000 9                  TRA     PARTSKIPSET

     2698    20763    7                          END;
     2699    20764    7                    IF (RES_INDX = %MMINDX) THEN DO;

  20764  9 011356   000062 235000 1                  LDA     RES_INDX
         9 011357   011372 601000 9                  TNZ     s:20770

     2700    20765    8                       IF (VALUE > %PARTMMMAX) THEN DO;

  20765  9 011360   001712 235000 1                  LDA     VALUE
         9 011361   777777 115007                    CMPA    -1,DL
         9 011362   011450 604400 9                  TMOZ    s:20789

     2701    20766    8                          CALL VAL_ERROR(%E$P_VALUE2BIG,J,%PARTMMMAX);

  20766  9 011363   000174 237000 10                 LDAQ    124
         9 011364   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011365   000164 236000 10                 LDQ     116
         9 011366   200067 756100                    STQ     N$+4,,AUTO
         9 011367   012006 701000 9                  TSX1    VAL_ERROR
         9 011370   000000 011000                    NOP     0

     2702    20767    8                          GOTO PARTSKIPSET;

  20767  9 011371   011713 710000 9                  TRA     PARTSKIPSET

     2703    20768    8                          END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:384  
     2704    20769    7                       END;
     2705    20770    7                    ELSE IF (RES_INDX < %PSURES_OFFSET) THEN DO;

  20770  9 011372   000004 115007                    CMPA    4,DL
         9 011373   011422 605000 9                  TPL     s:20781

     2706    20771    7                          MONPTR.ADDRESS = RES$ -> P$TBL.REPTR$.ADDRESS(%PC_TOTRES);

  20771  9 011374   000003 471400 1                  LDP1    RES$
         9 011375   100053 236100                    LDQ     43,,PR1
         9 011376   000010 752074 1                  STCQ    MONPTR$,'74'O

     2707    20772    7                          MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);

  20772  9 011377   000010 473400 1                  LDP3    MONPTR$
         9 011400   300000 236100                    LDQ     0,,PR3
         9 011401   000010 752074 1                  STCQ    MONPTR$,'74'O

     2708    20773    8                          IF (VALUE > MONPTR$ -> B$TABLE(RES_INDX -1)) THEN DO;

  20773  9 011402   000010 473400 1                  LDP3    MONPTR$
         9 011403   377777 236105                    LDQ     -1,AL,PR3
         9 011404   011450 604000 9                  TMI     s:20789
         9 011405   001712 116000 1                  CMPQ    VALUE
         9 011406   011450 605000 9                  TPL     s:20789

     2709    20774    8                             CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20774  9 011407   000062 236000 1                  LDQ     RES_INDX
         9 011410   000022 736000                    QLS     18
         9 011411   000001 136003                    SBLQ    1,DU
         9 011412   000010 036000 1                  ADLQ    MONPTR$
         9 011413   000161 235000 10                 LDA     113
         9 011414   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011415   000164 236000 10                 LDQ     116
         9 011416   200067 756100                    STQ     N$+4,,AUTO
         9 011417   012006 701000 9                  TSX1    VAL_ERROR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:385  
         9 011420   000000 011000                    NOP     0

     2710    20775    8                               MONPTR$ -> B$TABLE(RES_INDX-1));
     2711    20776    8                             GOTO PARTSKIPSET;

  20776  9 011421   011713 710000 9                  TRA     PARTSKIPSET

     2712    20777    8                             END;
     2713    20778    7                          ELSE;
     2714    20779    7                          END;
     2715    20780    7                       ELSE DO;

     2716    20781    7                         MONPTR.ADDRESS = RES$ -> P$TBL.REPSUPTR$.ADDRESS(%PC_TOTRES);

  20781  9 011422   000003 471400 1                  LDP1    RES$
         9 011423   100054 236100                    LDQ     44,,PR1
         9 011424   000010 752074 1                  STCQ    MONPTR$,'74'O

     2717    20782    7                          MONPTR.ADDRESS = MONPTR$ -> B$PTR.ADDRESS(0);

  20782  9 011425   000010 473400 1                  LDP3    MONPTR$
         9 011426   300000 236100                    LDQ     0,,PR3
         9 011427   000010 752074 1                  STCQ    MONPTR$,'74'O

     2718    20783    8                          IF (VALUE > MONPTR$ -> B$TABLE(RES_INDX - %PSURES_OFFSET))
             20783                                   THEN DO;

  20783  9 011430   000010 473400 1                  LDP3    MONPTR$
         9 011431   377774 236105                    LDQ     -4,AL,PR3
         9 011432   011450 604000 9                  TMI     s:20789
         9 011433   001712 116000 1                  CMPQ    VALUE
         9 011434   011450 605000 9                  TPL     s:20789

     2719    20784    8                             CALL VAL_ERROR(%E$P_VALUE2BIG,J,

  20784  9 011435   000062 236000 1                  LDQ     RES_INDX
         9 011436   000022 736000                    QLS     18
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:386  
         9 011437   000004 136003                    SBLQ    4,DU
         9 011440   000010 036000 1                  ADLQ    MONPTR$
         9 011441   000161 235000 10                 LDA     113
         9 011442   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011443   000164 236000 10                 LDQ     116
         9 011444   200067 756100                    STQ     N$+4,,AUTO
         9 011445   012006 701000 9                  TSX1    VAL_ERROR
         9 011446   000000 011000                    NOP     0

     2720    20785    8                               MONPTR$ -> B$TABLE(RES_INDX - %PSURES_OFFSET));
     2721    20786    8                             GOTO PARTSKIPSET;

  20786  9 011447   011713 710000 9                  TRA     PARTSKIPSET

     2722    20787    8                             END;
     2723    20788    7                          END;
     2724    20789    6                    SET_PDT$ -> JM$PT.RMAX(RES_INDX) = VALUE;

  20789  9 011450   000062 235000 1                  LDA     RES_INDX
         9 011451   000001 735000                    ALS     1
         9 011452   001704 471400 1                  LDP1    SET_PDT$
         9 011453   000105 101400                    MRL     fill='000'O
         9 011454   001712 000004 1                  ADSC9   VALUE                    cn=0,n=4
         9 011455   100007 000002                    ADSC9   7,A,PR1                  cn=0,n=2

     2725    20790    6                    SET_PDTFLAG$ -> JM$PT.RMAX(RES_INDX) = 1;

  20790  9 011456   000062 235000 1                  LDA     RES_INDX
         9 011457   000001 735000                    ALS     1
         9 011460   000105 101400                    MRL     fill='000'O
         9 011461   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         9 011462   000007 000002                    ADSC9   7,A,PR0                  cn=0,n=2
         9 011463   011713 710000 9                  TRA     PARTSKIPSET

     2726    20791    6                  CASE (%PC_PLOCK);

     2727    20792    7                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PLOCK))) THEN DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:387  

  20792  9 011464   000002 470400 1                  LDP0    PART$
         9 011465   001712 236000 1                  LDQ     VALUE
         9 011466   000106 116100                    CMPQ    70,,PR0
         9 011467   011501 605000 9                  TPL     s:20796

     2728    20793    7                      CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%PC_PLOCK))
             20793                                ;

  20793  9 011470   000002 236000 1                  LDQ     PART$
         9 011471   000106 036003                    ADLQ    70,DU
         9 011472   000161 235000 10                 LDA     113
         9 011473   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011474   000162 236000 10                 LDQ     114
         9 011475   200067 756100                    STQ     N$+4,,AUTO
         9 011476   012006 701000 9                  TSX1    VAL_ERROR
         9 011477   000000 011000                    NOP     0

     2729    20794    7                       GOTO PARTSKIPSET;

  20794  9 011500   011713 710000 9                  TRA     PARTSKIPSET

     2730    20795    7                       END;
     2731    20796    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PLOCK)) THEN DO;

  20796  9 011501   000105 116100                    CMPQ    69,,PR0
         9 011502   011514 604400 9                  TMOZ    s:20800

     2732    20797    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PLOCK));

  20797  9 011503   000002 236000 1                  LDQ     PART$
         9 011504   000105 036003                    ADLQ    69,DU
         9 011505   000161 235000 10                 LDA     113
         9 011506   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011507   000164 236000 10                 LDQ     116
         9 011510   200067 756100                    STQ     N$+4,,AUTO
         9 011511   012006 701000 9                  TSX1    VAL_ERROR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:388  
         9 011512   000000 011000                    NOP     0

     2733    20798    7                       GOTO PARTSKIPSET;

  20798  9 011513   011713 710000 9                  TRA     PARTSKIPSET

     2734    20799    7                       END;
     2735    20800    6                    IF (VALUE = 0) THEN

  20800  9 011514   000000 116003                    CMPQ    0,DU
         9 011515   011522 601000 9                  TNZ     s:20802

     2736    20801    6                       SET_PDT$ -> JM$PT.FLG.LOCK = '0'B;

  20801  9 011516   001704 471400 1                  LDP1    SET_PDT$
         9 011517   000173 236000 10                 LDQ     123
         9 011520   100004 356100                    ANSQ    4,,PR1
         9 011521   011525 710000 9                  TRA     s:20803

     2737    20802    6                    ELSE SET_PDT$ -> JM$PT.FLG.LOCK = '1'B;

  20802  9 011522   001704 471400 1                  LDP1    SET_PDT$
         9 011523   000001 236007                    LDQ     1,DL
         9 011524   100004 256100                    ORSQ    4,,PR1

     2738    20803    6                    SET_PDTFLAG$ -> JM$PT.FLG.LOCK = '1'B;

  20803  9 011525   001705 473400 1                  LDP3    SET_PDTFLAG$
         9 011526   000001 236007                    LDQ     1,DL
         9 011527   300004 256100                    ORSQ    4,,PR3
         9 011530   011713 710000 9                  TRA     PARTSKIPSET

     2739    20804    6                  CASE (%PC_PQUAN);

     2740    20805    6                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PQUAN))*

  20805  9 011531   000002 470400 1                  LDP0    PART$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:389  
         9 011532   000122 236100                    LDQ     82,,PR0
         9 011533   000123 402100                    MPY     83,,PR0
         9 011534   001712 116000 1                  CMPQ    VALUE
         9 011535   011547 604400 9                  TMOZ    s:20810

     2741    20806    7                      (PART$ -> P$TBL.MULT(%PC_PQUAN))) THEN DO;

     2742    20807    7                      CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%PC_PQUAN))
             20807                                ;

  20807  9 011536   000002 236000 1                  LDQ     PART$
         9 011537   000122 036003                    ADLQ    82,DU
         9 011540   000161 235000 10                 LDA     113
         9 011541   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011542   000162 236000 10                 LDQ     114
         9 011543   200067 756100                    STQ     N$+4,,AUTO
         9 011544   012006 701000 9                  TSX1    VAL_ERROR
         9 011545   000000 011000                    NOP     0

     2743    20808    7                       GOTO PARTSKIPSET;

  20808  9 011546   011713 710000 9                  TRA     PARTSKIPSET

     2744    20809    7                       END;
     2745    20810    6                    IF (VALUE > (PART$ -> P$TBL.MAX(%PC_PQUAN))*

  20810  9 011547   000121 236100                    LDQ     81,,PR0
         9 011550   000123 402100                    MPY     83,,PR0
         9 011551   001712 116000 1                  CMPQ    VALUE
         9 011552   011564 605000 9                  TPL     s:20815

     2746    20811    7                      (PART$ -> P$TBL.MULT(%PC_PQUAN))) THEN DO;

     2747    20812    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PQUAN));

  20812  9 011553   000002 236000 1                  LDQ     PART$
         9 011554   000121 036003                    ADLQ    81,DU
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:390  
         9 011555   000161 235000 10                 LDA     113
         9 011556   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011557   000164 236000 10                 LDQ     116
         9 011560   200067 756100                    STQ     N$+4,,AUTO
         9 011561   012006 701000 9                  TSX1    VAL_ERROR
         9 011562   000000 011000                    NOP     0

     2748    20813    7                       GOTO PARTSKIPSET;

  20813  9 011563   011713 710000 9                  TRA     PARTSKIPSET

     2749    20814    7                       END;
     2750    20815    6                    SET_PDT$ -> JM$PT.QUAN = VALUE;

  20815  9 011564   001712 235000 1                  LDA     VALUE
         9 011565   001704 471400 1                  LDP1    SET_PDT$
         9 011566   100002 755100                    STA     2,,PR1

     2751    20816    6                    SET_PDTFLAG$ -> JM$PT.QUAN = 1;

  20816  9 011567   000001 236007                    LDQ     1,DL
         9 011570   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 011571   000002 756100                    STQ     2,,PR0
         9 011572   011713 710000 9                  TRA     PARTSKIPSET

     2752    20817    6                  CASE (%PC_PPRIO);

     2753    20818    7                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PPRIO))) THEN DO;

  20818  9 011573   000002 470400 1                  LDP0    PART$
         9 011574   001712 236000 1                  LDQ     VALUE
         9 011575   000136 116100                    CMPQ    94,,PR0
         9 011576   011610 605000 9                  TPL     s:20822

     2754    20819    7                      CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%PC_PPRIO))
             20819                                ;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:391  
  20819  9 011577   000002 236000 1                  LDQ     PART$
         9 011600   000136 036003                    ADLQ    94,DU
         9 011601   000161 235000 10                 LDA     113
         9 011602   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011603   000162 236000 10                 LDQ     114
         9 011604   200067 756100                    STQ     N$+4,,AUTO
         9 011605   012006 701000 9                  TSX1    VAL_ERROR
         9 011606   000000 011000                    NOP     0

     2755    20820    7                       GOTO PARTSKIPSET;

  20820  9 011607   011713 710000 9                  TRA     PARTSKIPSET

     2756    20821    7                       END;
     2757    20822    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PPRIO)) THEN DO;

  20822  9 011610   000135 116100                    CMPQ    93,,PR0
         9 011611   011623 604400 9                  TMOZ    s:20826

     2758    20823    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PPRIO));

  20823  9 011612   000002 236000 1                  LDQ     PART$
         9 011613   000135 036003                    ADLQ    93,DU
         9 011614   000161 235000 10                 LDA     113
         9 011615   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011616   000164 236000 10                 LDQ     116
         9 011617   200067 756100                    STQ     N$+4,,AUTO
         9 011620   012006 701000 9                  TSX1    VAL_ERROR
         9 011621   000000 011000                    NOP     0

     2759    20824    7                       GOTO PARTSKIPSET;

  20824  9 011622   011713 710000 9                  TRA     PARTSKIPSET

     2760    20825    7                       END;
     2761    20826    6                    SET_PDT$ -> JM$PT.XPRIO = VALUE;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:392  
  20826  9 011623   001704 471400 1                  LDP1    SET_PDT$
         9 011624   000011 736000                    QLS     9
         9 011625   100004 552110                    STBQ    4,'10'O,PR1

     2762    20827    6                    SET_PDTFLAG$ -> JM$PT.XPRIO = 1;

  20827  9 011626   001705 473400 1                  LDP3    SET_PDTFLAG$
         9 011627   001000 236007                    LDQ     512,DL
         9 011630   300004 552110                    STBQ    4,'10'O,PR3
         9 011631   011713 710000 9                  TRA     PARTSKIPSET

     2763    20828    6                  CASE (%PC_PMAXACCT);

     2764    20829    7                    IF (VALUE < (PART$ -> P$TBL.MIN(%PC_PMAXACCT))) THEN DO;

  20829  9 011632   000002 470400 1                  LDP0    PART$
         9 011633   001712 236000 1                  LDQ     VALUE
         9 011634   000152 116100                    CMPQ    106,,PR0
         9 011635   011647 605000 9                  TPL     s:20833

     2765    20830    7                       CALL VAL_ERROR(%E$P_VALUE2SMALL,J,PART$ -> P$TBL.MIN(%
             20830                                PC_PMAXACCT));

  20830  9 011636   000002 236000 1                  LDQ     PART$
         9 011637   000152 036003                    ADLQ    106,DU
         9 011640   000161 235000 10                 LDA     113
         9 011641   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011642   000162 236000 10                 LDQ     114
         9 011643   200067 756100                    STQ     N$+4,,AUTO
         9 011644   012006 701000 9                  TSX1    VAL_ERROR
         9 011645   000000 011000                    NOP     0

     2766    20831    7                       GOTO PARTSKIPSET;

  20831  9 011646   011713 710000 9                  TRA     PARTSKIPSET

     2767    20832    7                       END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:393  
     2768    20833    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PMAXACCT)) THEN DO;

  20833  9 011647   000151 116100                    CMPQ    105,,PR0
         9 011650   011662 604400 9                  TMOZ    s:20837

     2769    20834    7                      CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PMAXACCT)
             20834                                );

  20834  9 011651   000002 236000 1                  LDQ     PART$
         9 011652   000151 036003                    ADLQ    105,DU
         9 011653   000161 235000 10                 LDA     113
         9 011654   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011655   000164 236000 10                 LDQ     116
         9 011656   200067 756100                    STQ     N$+4,,AUTO
         9 011657   012006 701000 9                  TSX1    VAL_ERROR
         9 011660   000000 011000                    NOP     0

     2770    20835    7                       GOTO PARTSKIPSET;

  20835  9 011661   011713 710000 9                  TRA     PARTSKIPSET

     2771    20836    7                       END;
     2772    20837    6                    SET_PDT$ -> JM$PT.MAX1ACCT = VALUE;

  20837  9 011662   001704 471400 1                  LDP1    SET_PDT$
         9 011663   100005 552104                    STBQ    5,'04'O,PR1

     2773    20838    6                    SET_PDTFLAG$ -> JM$PT.MAX1ACCT = 1;

  20838  9 011664   001705 473400 1                  LDP3    SET_PDTFLAG$
         9 011665   000001 236007                    LDQ     1,DL
         9 011666   300005 552104                    STBQ    5,'04'O,PR3
         9 011667   011713 710000 9                  TRA     PARTSKIPSET

     2774    20839    6                  CASE (%PC_PJMAX);

     2775    20840    7                    IF (VALUE > PART$ -> P$TBL.MAX(%PC_PJMAX)) THEN DO;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:394  

  20840  9 011670   000002 470400 1                  LDP0    PART$
         9 011671   001712 236000 1                  LDQ     VALUE
         9 011672   000165 116100                    CMPQ    117,,PR0
         9 011673   011705 604400 9                  TMOZ    s:20844

     2776    20841    7                       CALL VAL_ERROR(%E$P_VALUE2BIG,J,PART$ -> P$TBL.MAX(%PC_PJMAX));

  20841  9 011674   000002 236000 1                  LDQ     PART$
         9 011675   000165 036003                    ADLQ    117,DU
         9 011676   000161 235000 10                 LDA     113
         9 011677   200070 757100                    STAQ    @ERR#+1,,AUTO
         9 011700   000164 236000 10                 LDQ     116
         9 011701   200067 756100                    STQ     N$+4,,AUTO
         9 011702   012006 701000 9                  TSX1    VAL_ERROR
         9 011703   000000 011000                    NOP     0

     2777    20842    7                       GOTO PARTSKIPSET;

  20842  9 011704   011713 710000 9                  TRA     PARTSKIPSET

     2778    20843    7                       END;
     2779    20844    6                    SET_PDT$ -> JM$PT.MAX = VALUE;

  20844  9 011705   001704 471400 1                  LDP1    SET_PDT$
         9 011706   000033 736000                    QLS     27
         9 011707   100003 552140                    STBQ    3,'40'O,PR1

     2780    20845    6                    SET_PDTFLAG$ -> JM$PT.MAX = 1;

  20845  9 011710   001705 473400 1                  LDP3    SET_PDTFLAG$
         9 011711   001000 236003                    LDQ     512,DU
         9 011712   300003 552140                    STBQ    3,'40'O,PR3

     2781    20846        /**/
     2782    20847    6   PARTSKIPSET:
     2783    20848    6                  END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:395  

  20848  9 011713                       PARTSKIPSET  null
     2784    20849    5                 END;

  20849  9 011713   000026 054000 1                  AOS     J
         9 011714   000026 236000 1                  LDQ     J
         9 011715   001711 116000 1                  CMPQ    SET_INDEXHI
         9 011716   010704 604400 9                  TMOZ    s:20688

     2785    20850    4             VALUE = VALUE/(CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));

  20850  9 011717   001706 235000 1                  LDA     SET_CAT
         9 011720   000001 735000                    ALS     1
         9 011721   000000 470400 1                  LDP0    CAT$
         9 011722   000001 471505                    LDP1    1,AL,PR0
         9 011723   001707 236000 1                  LDQ     SET_PARAM
         9 011724   000014 402007                    MPY     12,DL
         9 011725   000000 620006                    EAX0    0,QL
         9 011726   001712 236000 1                  LDQ     VALUE
         9 011727   100013 235110                    LDA     11,X0,PR1
         9 011730   011733 605000 9                  TPL     s:20850+12
         9 011731   000000 236003                    LDQ     0,DU
         9 011732   011734 710000 9                  TRA     s:20850+13
         9 011733   100013 506110                    DIV     11,X0,PR1
         9 011734   001712 756000 1                  STQ     VALUE

     2786    20851    4              RETURN;

  20851  9 011735   200064 221300                    LDX1  ! N$+1,,AUTO
         9 011736   000001 702211                    TSX2  ! 1,X1

     2787    20852        /**/
     2788    20853    4   CNTRL_ERR:
     2789    20854    4              CALL PCE$ERROR(0,3);

  20854  9 011737   000033 630400 10    CNTRL_ERR    EPPR0   27
         9 011740   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:396  
         9 011741   000000 701000 xent               TSX1    PCE$ERROR
         9 011742   000000 011000                    NOP     0

     2790    20855    4              CALL PCE$ERROR(%E$P_CNTRLERR,3);

  20855  9 011743   000177 630400 10                 EPPR0   127
         9 011744   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 011745   000000 701000 xent               TSX1    PCE$ERROR
         9 011746   000000 011000                    NOP     0

     2791    20856    4             VALUE = VALUE/(CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));

  20856  9 011747   001706 235000 1                  LDA     SET_CAT
         9 011750   000001 735000                    ALS     1
         9 011751   000000 470400 1                  LDP0    CAT$
         9 011752   000001 471505                    LDP1    1,AL,PR0
         9 011753   001707 236000 1                  LDQ     SET_PARAM
         9 011754   000014 402007                    MPY     12,DL
         9 011755   000000 620006                    EAX0    0,QL
         9 011756   001712 236000 1                  LDQ     VALUE
         9 011757   100013 235110                    LDA     11,X0,PR1
         9 011760   011763 605000 9                  TPL     s:20856+12
         9 011761   000000 236003                    LDQ     0,DU
         9 011762   011764 710000 9                  TRA     s:20856+13
         9 011763   100013 506110                    DIV     11,X0,PR1
         9 011764   001712 756000 1                  STQ     VALUE

     2792    20857    4              RETURN;

  20857  9 011765   200064 221300                    LDX1  ! N$+1,,AUTO
         9 011766   000001 702211                    TSX2  ! 1,X1

     2793    20858        /**/
     2794    20859        /*E*     ERROR:    PCC-E$P_CNTRLERR-0
     2795    20860                 MESSAGE:  Error updating :CNTRL file - table changes not saved
     2796    20861                 MESSAGE1: CONTROL received an error while trying to update the
     2797    20862                           :CNTRL file - the last chages made via SET and STORE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:397  
     2798    20863                           will not be saved accross a recovery.
     2799    20864                 DESCRIPTION: ERRORS ON :CNTRL - TABLES NOT SAVED */
     2800    20865    4            END;

     2801    20866    3            VALUE = VALUE/(CAT$ -> CAT$TBL.PARAM$(SET_CAT) -> P$TBL.MULT(SET_PARAM));

  20866  9 011767   001706 235000 1                  LDA     SET_CAT
         9 011770   000001 735000                    ALS     1
         9 011771   000000 470400 1                  LDP0    CAT$
         9 011772   000001 471505                    LDP1    1,AL,PR0
         9 011773   001707 236000 1                  LDQ     SET_PARAM
         9 011774   000014 402007                    MPY     12,DL
         9 011775   000000 620006                    EAX0    0,QL
         9 011776   001712 236000 1                  LDQ     VALUE
         9 011777   100013 235110                    LDA     11,X0,PR1
         9 012000   012003 605000 9                  TPL     s:20866+12
         9 012001   000000 236003                    LDQ     0,DU
         9 012002   012004 710000 9                  TRA     s:20866+13
         9 012003   100013 506110                    DIV     11,X0,PR1
         9 012004   001712 756000 1                  STQ     VALUE
         9 012005   012212 710000 9                  TRA     s:20916

     2802    20867        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:398  
     2803    20868        /**/
     2804    20869    3   VAL_ERROR: PROC(ERR#,INDX,LIMIT);

  20869  9 012006   200066 741300       VAL_ERROR    STX1  ! N$+3,,AUTO

     2805    20870        /**/
     2806    20871    4   DCL ERR# SBIN WORD;
     2807    20872    4   DCL INDX SBIN WORD;
     2808    20873    4   DCL LIMIT SBIN WORD;
     2809    20874        /**/
     2810    20875    4   DCL TEMPTEXT CHAR(12) AUTO;
     2811    20876    4   DCL TEMPTEXT_ARRAY(0:11) REDEF TEMPTEXT CHAR(1);
     2812    20877        /**/
     2813    20878    4           SUB_BUF_1.COUNT = PARAM$ -> P$TBL.TEXT.COUNT(SET_PARAM);
             20878                    /* SET SUB_BUF_1 PARAM NAME */

  20878  9 012007   001707 236000 1                  LDQ     SET_PARAM
         9 012010   000014 402007                    MPY     12,DL
         9 012011   000017 470400 1                  LDP0    PARAM$
         9 012012   000002 236106                    LDQ     2,QL,PR0
         9 012013   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     2814    20879    4           CALL INSERT(SUB_BUF_1.TEXT,0,SUB_BUF_1.COUNT,PARAM$ -> P$TBL.TEXT.TEXT(
             20879                    SET_PARAM));

  20879  9 012014   000000 236000 xsym               LDQ     SUB_BUF_1
         9 012015   000033 772000                    QRL     27
         9 012016   000000 620006                    EAX0    0,QL
         9 012017   001707 236000 1                  LDQ     SET_PARAM
         9 012020   000060 402007                    MPY     48,DL
         9 012021   040040 100506                    MLR     fill='040'O
         9 012022   000002 200023                    ADSC9   2,Q,PR0                  cn=1,n=19
         9 012023   000000 200010 xsym               ADSC9   SUB_BUF_1                cn=1,n=*X0

     2815    20880        /**/
     2816    20881    5           IF (PARAM$ -> P$TBL.FLAGS.RES(SET_PARAM)) THEN DO; /* ADD RESOURCE    */

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:399  
  20881  9 012024   001707 236000 1                  LDQ     SET_PARAM
         9 012025   000014 402007                    MPY     12,DL
         9 012026   000000 236106                    LDQ     0,QL,PR0
         9 012027   040000 316003                    CANQ    16384,DU
         9 012030   012057 600000 9                  TZE     s:20888

     2817    20882    5              CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);

  20882  9 012031   000201 630400 10                 EPPR0   129
         9 012032   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012033   000000 701000 xent               TSX1    PCR$RESTEXT
         9 012034   000000 011000                    NOP     0

     2818    20883    5              CALL INSERT(SUB_BUF_1.TEXT,SUB_BUF_1.COUNT,RESTEXT_C.COUNT,

  20883  9 012035   000000 236000 xsym               LDQ     SUB_BUF_1
         9 012036   000033 772000                    QRL     27
         9 012037   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 012040   002526 236000 1                  LDQ     RESTEXT_C
         9 012041   000033 772000                    QRL     27
         9 012042   000000 620006                    EAX0    0,QL
         9 012043   200076 235100                    LDA     TEMPTEXT+4,,AUTO
         9 012044   040045 100400                    MLR     fill='040'O
         9 012045   002526 200014 1                  ADSC9   RESTEXT_C                cn=1,n=12
         9 012046   000000 200010 xsym               ADSC9   SUB_BUF_1,A              cn=1,n=*X0

     2819    20884    5                RESTEXT_C.TEXT);
     2820    20885    5              SUB_BUF_1.COUNT = SUB_BUF_1.COUNT + RESTEXT_C.COUNT;

  20885  9 012047   002526 236000 1                  LDQ     RESTEXT_C
         9 012050   000033 772000                    QRL     27
         9 012051   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 012052   000000 236000 xsym               LDQ     SUB_BUF_1
         9 012053   000033 772000                    QRL     27
         9 012054   200076 036100                    ADLQ    TEMPTEXT+4,,AUTO
         9 012055   000033 736000                    QLS     27
         9 012056   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:400  

     2821    20886    5              END;

     2822    20887        /**/
     2823    20888    5           IF (PARAM$ -> P$TBL.FLAGS.INDX(SET_PARAM)) THEN DO; /* ADD INDEX TEXT */

  20888  9 012057   001707 236000 1                  LDQ     SET_PARAM
         9 012060   000014 402007                    MPY     12,DL
         9 012061   000017 470400 1                  LDP0    PARAM$
         9 012062   000000 236106                    LDQ     0,QL,PR0
         9 012063   100000 316003                    CANQ    32768,DU
         9 012064   012152 600000 9                  TZE     s:20896

     2824    20889    5              CALL INSERT(SUB_BUF_1.TEXT,SUB_BUF_1.COUNT,,'(',

  20889  9 012065   000007 471500                    LDP1    7,,PR0
         9 012066   200070 473500                    LDP3    @INDX,,AUTO
         9 012067   300000 235100                    LDA     0,,PR3
         9 012070   300000 720100                    LXL0    0,,PR3
         9 012071   100000 236110                    LDQ     0,X0,PR1
         9 012072   000033 772000                    QRL     27
         9 012073   000000 620006                    EAX0    0,QL
         9 012074   000000 236000 xsym               LDQ     SUB_BUF_1
         9 012075   000033 772000                    QRL     27
         9 012076   777740 621006                    EAX1    -32,QL
         9 012077   777777 661003                    ERX1    -1,DU
         9 012100   040046 100400                    MLR     fill='040'O
         9 012101   000203 000001 10                 ADSC9   131                      cn=0,n=1
         9 012102   000000 200011 xsym               ADSC9   SUB_BUF_1,Q              cn=1,n=*X1
         9 012103   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 012104   000000 636011                    EAQ     0,X1
         9 012105   000022 772000                    QRL     18
         9 012106   000002 116007                    CMPQ    2,DL
         9 012107   012137 602000 9                  TNC     s:20892
         9 012110   000002 735000                    ALS     2
         9 012111   777777 622011                    EAX2    -1,X1
         9 012112   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:401  
         9 012113   040046 100545                    MLR     fill='040'O
         9 012114   100000 200010                    ADSC9   0,A,PR1                  cn=1,n=*X0
         9 012115   000000 400012 xsym               ADSC9   SUB_BUF_1,Q              cn=2,n=*X2
         9 012116   000000 635010                    EAA     0,X0
         9 012117   000022 771000                    ARL     18
         9 012120   200077 755100                    STA     TEMPTEXT+5,,AUTO
         9 012121   000000 636011                    EAQ     0,X1
         9 012122   000022 772000                    QRL     18
         9 012123   200077 136100                    SBLQ    TEMPTEXT+5,,AUTO
         9 012124   000001 116007                    CMPQ    1,DL
         9 012125   012137 604400 9                  TMOZ    s:20892
         9 012126   200100 756100                    STQ     TEMPTEXT+6,,AUTO
         9 012127   000000 636010                    EAQ     0,X0
         9 012130   000022 772000                    QRL     18
         9 012131   200076 036100                    ADLQ    TEMPTEXT+4,,AUTO
         9 012132   200100 720100                    LXL0    TEMPTEXT+6,,AUTO
         9 012133   777777 621010                    EAX1    -1,X0
         9 012134   040046 100400                    MLR     fill='040'O
         9 012135   000204 000001 10                 ADSC9   132                      cn=0,n=1
         9 012136   000000 400011 xsym               ADSC9   SUB_BUF_1,Q              cn=2,n=*X1

     2825    20890    5                SUBSTR(PARAM$ -> P$TBL.PTR$(0) -> TEXTC$INDX.TEXT(INDX),0,
     2826    20891    5                PARAM$ -> P$TBL.PTR$(0) -> TEXTC$INDX.COUNT(INDX)),')');
     2827    20892    5              SUB_BUF_1.COUNT = SUB_BUF_1.COUNT + PARAM$ -> P$TBL.PTR$(0) ->

  20892  9 012137   000007 471500                    LDP1    7,,PR0
         9 012140   300000 720100                    LXL0    0,,PR3
         9 012141   100000 236110                    LDQ     0,X0,PR1
         9 012142   000033 772000                    QRL     27
         9 012143   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 012144   000000 236000 xsym               LDQ     SUB_BUF_1
         9 012145   000033 772000                    QRL     27
         9 012146   200076 036100                    ADLQ    TEMPTEXT+4,,AUTO
         9 012147   000002 036007                    ADLQ    2,DL
         9 012150   000033 736000                    QLS     27
         9 012151   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:402  
     2828    20893    5                TEXTC$INDX.COUNT(INDX) + 2;
     2829    20894    5              END;

     2830    20895        /**/
     2831    20896    4           CALL BINCHAR(TEMPTEXT,LIMIT);   /* SET SUB_BUF_2 WITH LIMIT TEXT      */

  20896  9 012152   200071 471500                    LDP1    @LIMIT,,AUTO
         9 012153   000100 301500                    BTD
         9 012154   100000 000004                    NDSC9   0,,PR1                   cn=0,s=lsgnf,sf=0,n=4
         9 012155   200072 030014                    NDSC9   TEMPTEXT,,AUTO           cn=0,s=nosgn,sf=0,n=12

     2832    20897        /**/
     2833    20898    4           K = 0;

  20898  9 012156   000027 450000 1                  STZ     K

     2834    20899    5           DO WHILE ((K < SIZEC(TEMPTEXT)-1)AND(TEMPTEXT_ARRAY(K) = '0'));

  20899  9 012157   012161 710000 9                  TRA     s:20901

     2835    20900    5              K = K+1;

  20900  9 012160   000027 054000 1                  AOS     K

     2836    20901    5              END;

  20901  9 012161   000027 235000 1                  LDA     K
         9 012162   000013 115007                    CMPA    11,DL
         9 012163   012170 605000 9                  TPL     s:20902
         9 012164   040000 106505                    CMPC    fill='040'O
         9 012165   200072 000001                    ADSC9   TEMPTEXT,A,AUTO          cn=0,n=1
         9 012166   000067 000001 10                 ADSC9   55                       cn=0,n=1
         9 012167   012160 600000 9                  TZE     s:20900

     2837    20902    4           SUB_BUF_2.COUNT = SIZEC(TEMPTEXT)-K;

  20902  9 012170   000014 236007                    LDQ     12,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:403  
         9 012171   000027 136000 1                  SBLQ    K
         9 012172   000033 736000                    QLS     27
         9 012173   000000 552040 xsym               STBQ    SUB_BUF_2,'40'O

     2838    20903    4           SUB_BUF_2.TEXT = SUBSTR(TEMPTEXT,K,SIZEC(TEMPTEXT)-K+1);

  20903  9 012174   777762 620005                    EAX0    -14,AL
         9 012175   777777 660003                    ERX0    -1,DU
         9 012176   040000 100545                    MLR     fill='040'O
         9 012177   200072 000010                    ADSC9   TEMPTEXT,A,AUTO          cn=0,n=*X0
         9 012200   000000 200037 xsym               ADSC9   SUB_BUF_2                cn=1,n=31

     2839    20904        /**/
     2840    20905    4           CALL PCE$ERROR(ERR#,3);         /* PRINT MESSAGE                      */

  20905  9 012201   000024 236000 10                 LDQ     20
         9 012202   200067 235100                    LDA     @ERR#,,AUTO
         9 012203   200076 757100                    STAQ    TEMPTEXT+4,,AUTO
         9 012204   200076 630500                    EPPR0   TEMPTEXT+4,,AUTO
         9 012205   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012206   000000 701000 xent               TSX1    PCE$ERROR
         9 012207   000000 011000                    NOP     0

     2841    20906    4           RETURN;

  20906  9 012210   200066 221300                    LDX1  ! N$+3,,AUTO
         9 012211   000001 702211                    TSX2  ! 1,X1

     2842    20907        /**/
     2843    20908        /*E*     ERROR:    PCC-E$P_VALUE2SMALL-0
     2844    20909                 MESSAGE:  Value for %U1 is too small - %U2 is the minimum
     2845    20910                 DESCRIPTION: VALUE SPECIFIED IS BELOW LEGAL MINIMUM */
     2846    20911        /**/
     2847    20912        /*E*     ERROR:    PCC-E$P_VALUE2BIG-0
     2848    20913                 MESSAGE:  Value for %U1 is too big - %U2 is maximum
     2849    20914                 DESCRIPTION: VALUE LARGER THAN LEGAL MAXIMUM SPECIFIED */
     2850    20915    4   END VAL_ERROR;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:404  
     2851    20916    3   END SET_VALUE;

  20916  9 012212   200064 221300                    LDX1  ! N$+1,,AUTO
         9 012213   000001 702211                    TSX2  ! 1,X1

     2852    20917        /**/
     2853    20918    2   END EXEC_SET;
     2854    20919        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:405  
     2855    20920    1   GBLK: PROC(BLK$,SIZE) ALTRET;

  20920  9 012214   200056 741300       GBLK         STX1  ! CODE+1,,AUTO

     2856    20921    2   DCL BLK$ PTR;
     2857    20922    2   DCL SIZE SBIN WORD;
     2858    20923        /**/
     2859    20924    3           DO WHILE(WORDS_AVAIL < SIZE);

  20924  9 012215   200060 470500                    LDP0    @SIZE,,AUTO
         9 012216   001733 236000 1                  LDQ     WORDS_AVAIL
         9 012217   000000 116100                    CMPQ    0,,PR0
         9 012220   012233 605000 9                  TPL     s:20928

     2860    20925    3              CALL M$EXTEND(EXTEND_TP_FILE) ALTRET(NO_MEM);

  20925  9 012221   010630 630400 1                  EPPR0   EXTEND_TP_FILE
         9 012222   440005 713400                    CLIMB   alt,+16389
         9 012223   400000 401760                    pmme    nvectors=1
         9 012224   012247 702000 9                  TSX2    NO_MEM

     2861    20926    3              WORDS_AVAIL = WORDS_AVAIL + %WORDS_PER_GRAN;

  20926  9 012225   002000 236007                    LDQ     1024,DL
         9 012226   001733 056000 1                  ASQ     WORDS_AVAIL

     2862    20927    3           END;                            /* DO WHILE                           */

  20927  9 012227   200060 470500                    LDP0    @SIZE,,AUTO
         9 012230   001733 236000 1                  LDQ     WORDS_AVAIL
         9 012231   000000 116100                    CMPQ    0,,PR0
         9 012232   012221 604000 9                  TMI     s:20925

     2863    20928    2           BLK$ = TABLE$;

  20928  9 012233   200030 236100                    LDQ     TABLE$,,AUTO
         9 012234   200057 471500                    LDP1    @BLK$,,AUTO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:406  
         9 012235   100000 756100                    STQ     0,,PR1

     2864    20929    2           TABLE$ = PINCRW(TABLE$,SIZE);

  20929  9 012236   000000 236100                    LDQ     0,,PR0
         9 012237   000022 736000                    QLS     18
         9 012240   200030 036100                    ADLQ    TABLE$,,AUTO
         9 012241   200030 756100                    STQ     TABLE$,,AUTO

     2865    20930    2           WORDS_AVAIL = WORDS_AVAIL - SIZE;

  20930  9 012242   001733 236000 1                  LDQ     WORDS_AVAIL
         9 012243   000000 136100                    SBLQ    0,,PR0
         9 012244   001733 756000 1                  STQ     WORDS_AVAIL

     2866    20931    2           RETURN;

  20931  9 012245   200056 221300                    LDX1  ! CODE+1,,AUTO
         9 012246   000001 702211                    TSX2  ! 1,X1

     2867    20932    2   NO_MEM: ALTRETURN;

  20932  9 012247   200056 221300       NO_MEM       LDX1  ! CODE+1,,AUTO
         9 012250   000000 702211                    TSX2  ! 0,X1

     2868    20933    2   END GBLK;
     2869    20934        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:407  
     2870    20935    1   EXEC_DELETE: PROC;

  20935  9 012251   200054 741300       EXEC_DELETE  STX1  ! TEMPLEN+1,,AUTO

     2871    20936        /**/
     2872    20937    3        DO SELECT(P_PCB.OUT$->O$BLK.SUBLK$(0)->O$BLK.CODE);

  20937  9 012252   002115 470400 1                  LDP0    P_PCB$
         9 012253   000003 471500                    LDP1    3,,PR0
         9 012254   100003 473500                    LDP3    3,,PR1
         9 012255   300000 720100                    LXL0    0,,PR3
         9 012256   000001 100003                    CMPX0   1,DU
         9 012257   012467 601000 9                  TNZ     s:20994
         9 012260   012261 710000 9                  TRA     s:20939

     2873    20938    3           SELECT(%PC_TPINSTANCE);

     2874    20939    3              CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(CANT_OPEN);

  20939  9 012261   010456 630400 1                  EPPR0   OPEN_TP_CNTRL
         9 012262   450000 713400                    CLIMB   alt,open
         9 012263   410400 401760                    pmme    nvectors=18
         9 012264   012436 702000 9                  TSX2    CANT_OPEN

     2875    20940    3              PTR$ = P_PCB.OUT$->O$BLK.SUBLK$(1);

  20940  9 012265   002115 470400 1                  LDP0    P_PCB$
         9 012266   000003 471500                    LDP1    3,,PR0
         9 012267   100004 236100                    LDQ     4,,PR1
         9 012270   200032 756100                    STQ     PTR$,,AUTO

     2876    20941    4              DO I = 0 TO PTR$->O$BLK.NSUBLKS - 1;

  20941  9 012271   000025 450000 1                  STZ     I
         9 012272   012415 710000 9                  TRA     END_I_LOOP+1

     2877    20942    4                 INSTANCE_NAME = PTR$->O$BLK.SUBLK$(I)->OUT$SYM.TEXT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:408  

  20942  9 012273   200032 470500                    LDP0    PTR$,,AUTO
         9 012274   000025 720000 1                  LXL0    I
         9 012275   000003 471510                    LDP1    3,X0,PR0
         9 012276   100004 236100                    LDQ     4,,PR1
         9 012277   000033 772000                    QRL     27
         9 012300   000000 621006                    EAX1    0,QL
         9 012301   040100 100540                    MLR     fill='040'O
         9 012302   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         9 012303   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8

     2878    20943    4                 SUB_BUF_1.COUNT = PTR$->O$BLK.SUBLK$(I)->OUT$SYM.COUNT;

  20943  9 012304   100004 236100                    LDQ     4,,PR1
         9 012305   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

     2879    20944    4                 SUB_BUF_1.TEXT = INSTANCE_NAME;

  20944  9 012306   040000 100500                    MLR     fill='040'O
         9 012307   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 012310   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

     2880    20945    4                 INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR));

  20945  9 012311   000000 236000 xsym               LDQ     B$DS5$
         9 012312   000001 036003                    ADLQ    1,DU
         9 012313   200031 756100                    STQ     INSTANCE$,,AUTO

     2881    20946    4                 FOUND = NO;

  20946  9 012314   200025 450100                    STZ     FOUND,,AUTO

     2882    20947    5                 DO J = 0 TO PC$HDR.CURINSTANCES - 1;

  20947  9 012315   000026 450000 1                  STZ     J
         9 012316   012337 710000 9                  TRA     s:20954+1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:409  
     2883    20948    5                    IF PC$INSTANCE.INSTANCE_NAME = INSTANCE_NAME AND

  20948  9 012317   200031 470500                    LDP0    INSTANCE$,,AUTO
         9 012320   040100 106500                    CMPC    fill='040'O
         9 012321   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         9 012322   200017 000010                    ADSC9   INSTANCE_NAME,,AUTO      cn=0,n=8
         9 012323   012333 601000 9                  TNZ     s:20953
         9 012324   000003 236100                    LDQ     3,,PR0
         9 012325   200000 316003                    CANQ    65536,DU
         9 012326   012333 601000 9                  TNZ     s:20953

     2884    20949    6                       NOT PC$INSTANCE.FLAGS.DELETED THEN DO;

     2885    20950    6                       FOUND = YES;

  20950  9 012327   400000 236003                    LDQ     -131072,DU
         9 012330   200025 756100                    STQ     FOUND,,AUTO

     2886    20951    6                       DELINDX = J;

  20951  9 012331   000026 235000 1                  LDA     J
         9 012332   200036 755100                    STA     DELINDX,,AUTO

     2887    20952    6                       END;  /* IF INSTANCE_NAME = INSTANCE_NAME */

     2888    20953    5                    INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

  20953  9 012333   200031 236100                    LDQ     INSTANCE$,,AUTO
         9 012334   000113 036003                    ADLQ    75,DU
         9 012335   200031 756100                    STQ     INSTANCE$,,AUTO

     2889    20954    5                    END;  /* DO J */

  20954  9 012336   000026 054000 1                  AOS     J
         9 012337   000000 470400 xsym               LDP0    B$DS5$
         9 012340   000026 236000 1                  LDQ     J
         9 012341   012317 604000 9                  TMI     s:20948
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:410  
         9 012342   000000 116100                    CMPQ    0,,PR0
         9 012343   012317 602000 9                  TNC     s:20948

     2890    20955    5                 IF NOT FOUND THEN DO;

  20955  9 012344   200025 234100                    SZN     FOUND,,AUTO
         9 012345   012353 604000 9                  TMI     s:20959

     2891    20956    5                    CALL PCE$ERROR(%E$P_BAD_INSTANCE_NAME,3);

  20956  9 012346   000041 630400 10                 EPPR0   33
         9 012347   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012350   000000 701000 xent               TSX1    PCE$ERROR
         9 012351   000000 011000                    NOP     0

     2892    20957    5                    GOTO END_I_LOOP;

  20957  9 012352   012414 710000 9                  TRA     END_I_LOOP

     2893    20958    5                    END;  /* IF NOT FOUND */
     2894    20959    4                INSTANCE$ = PINCRW(B$DS5$,SIZEW(PC$HDR) + (DELINDX * SIZEW(PC$INSTANCE
             20959                          )));

  20959  9 012353   200036 236100                    LDQ     DELINDX,,AUTO
         9 012354   000113 402003                    MPY     75,DU
         9 012355   000001 036003                    ADLQ    1,DU
         9 012356   000000 036000 xsym               ADLQ    B$DS5$
         9 012357   200031 756100                    STQ     INSTANCE$,,AUTO

     2895    20960    5                 IF PC$INSTANCE.FLAGS.ACTIVE THEN DO;

  20960  9 012360   200031 471500                    LDP1    INSTANCE$,,AUTO
         9 012361   100003 234100                    SZN     3,,PR1
         9 012362   012370 605000 9                  TPL     s:20964

     2896    20961    5                    CALL PCE$ERROR(%E$P_ACTIVE_TPI,3);

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:411  
  20961  9 012363   000206 630400 10                 EPPR0   134
         9 012364   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012365   000000 701000 xent               TSX1    PCE$ERROR
         9 012366   000000 011000                    NOP     0

     2897    20962    5                    END;  /* IF ACTIVE */

  20962  9 012367   012414 710000 9                  TRA     END_I_LOOP

     2898    20963    5                 ELSE DO;

     2899    20964    5                    PC$INSTANCE.FLAGS.DELETED = '1'B;

  20964  9 012370   200000 236003                    LDQ     65536,DU
         9 012371   100003 256100                    ORSQ    3,,PR1

     2900    20965    5                    MAXTPU_TBL.FLAGS.DELETED(DELINDX) = '1'B;

  20965  9 012372   200036 235100                    LDA     DELINDX,,AUTO
         9 012373   000002 735000                    ALS     2
         9 012374   200000 236007                    LDQ     65536,DL
         9 012375   004562 256005 1                  ORSQ    MAXTPU_TBL+3,AL

     2901    20966    5                    TPHDR_TBL.FLAGS.PRESENT(DELINDX) = '0'B;

  20966  9 012376   200036 236100                    LDQ     DELINDX,,AUTO
         9 012377   000025 402007                    MPY     21,DL
         9 012400   000000 620006                    EAX0    0,QL
         9 012401   000210 236000 10                 LDQ     136
         9 012402   005243 356010 1                  ANSQ    TPHDR_TBL+20,X0

     2902    20967    5                    PC$INSTANCE.FLAGS.HEADER = '0'B;

  20967  9 012403   200031 471500                    LDP1    INSTANCE$,,AUTO
         9 012404   000211 236000 10                 LDQ     137
         9 012405   100003 356100                    ANSQ    3,,PR1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:412  
     2903    20968    5                    CALL PCE$ERROR(%E$P_TPI_DELETED,1);

  20968  9 012406   000213 630400 10                 EPPR0   139
         9 012407   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012410   000000 701000 xent               TSX1    PCE$ERROR
         9 012411   000000 011000                    NOP     0

     2904    20969    5                    CURINSTANCES = CURINSTANCES - 1;

  20969  9 012412   000001 336007                    LCQ     1,DL
         9 012413   000031 056000 1                  ASQ     CURINSTANCES

     2905    20970    5                    END;  /* ELSE */

  20967  9 012414                       END_I_LOOP   null
     2906    20971
     2907    20972                      /*E* ERROR: PCC-E$P_ACTIVE_TPI-0
     2908    20973                           MESSAGE: Instance name %U1 is active - cannot delete.
     2909    20974                           MESSAGE1: An active instance of TP cannot be deleted.
     2910    20975                           DESCRIPTION: See messages            */
     2911    20976                      /*E* ERROR: PCC-E$P_TPI_DELETED-0
     2912    20977                           MESSAGE: Instance name %U1 deleted.
     2913    20978                            DESCRIPTION: TP instance successfully deleted. */
     2914    20979    4         END_I_LOOP:;
     2915    20980    4                 END;  /* DO I */

  20980  9 012414   000025 054000 1                  AOS     I
         9 012415   200032 470500                    LDP0    PTR$,,AUTO
         9 012416   000001 236100                    LDQ     1,,PR0
         9 012417   000022 772000                    QRL     18
         9 012420   000025 116000 1                  CMPQ    I
         9 012421   012273 605400 9                  TPNZ    s:20942

     2916    20981    3              IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#

  20981  9 012422   000000 236007 xsym               LDQ     M$TP,DL
         9 012423   000000 471400 10                 LDP1    0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:413  
         9 012424   100000 473500                    LDP3    0,,PR1
         9 012425   300000 474506                    LDP4    0,QL,PR3
         9 012426   400031 236100                    LDQ     25,,PR4
         9 012427   020000 316007                    CANQ    8192,DL
         9 012430   012434 600000 9                  TZE     s:20983

     2917    20982    3                 THEN CALL M$CLOSE(CLOSE_TP_FILE);

  20982  9 012431   010572 630400 1                  EPPR0   CLOSE_TP_FILE
         9 012432   050001 713400                    CLIMB   close
         9 012433   406000 401760                    pmme    nvectors=13

     2918    20983    3              RETURN;

  20983  9 012434   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 012435   000001 702211                    TSX2  ! 1,X1

  20981  9 012436                       CANT_OPEN    null
     2919    20984    3         CANT_OPEN:;
     2920    20985    3              IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOFILE

  20985  9 012436   000000 470400 xsym               LDP0    B$TCB$
         9 012437   000000 471500                    LDP1    0,,PR0
         9 012440   100102 236100                    LDQ     66,,PR1
         9 012441   377770 376007                    ANQ     131064,DL
         9 012442   001610 116007                    CMPQ    904,DL
         9 012443   012451 601000 9                  TNZ     s:20987

     2921    20986    3                 THEN CALL PCE$ERROR(%E$P_NOTPI,0);

  20986  9 012444   000216 630400 10                 EPPR0   142
         9 012445   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012446   000000 701000 xent               TSX1    PCE$ERROR
         9 012447   000000 011000                    NOP     0
         9 012450   012455 710000 9                  TRA     s:20991

     2922    20987    3                 ELSE CALL PCE$ERROR(%E$P_BADTPFILE,3);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:414  

  20987  9 012451   000150 630400 10                 EPPR0   104
         9 012452   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012453   000000 701000 xent               TSX1    PCE$ERROR
         9 012454   000000 011000                    NOP     0

     2923    20988                   /*E* ERROR: PCC-E$P_NOTPI-0
     2924    20989                        MESSAGE: No TP instances currently defined.
     2925    20990                        DESCRIPTION: See message.     */
     2926    20991    3              IF DCBADDR(DCBNUM(M$TP))->F$DCB.FCD#

  20991  9 012455   000000 236007 xsym               LDQ     M$TP,DL
         9 012456   000000 470400 10                 LDP0    0
         9 012457   000000 471500                    LDP1    0,,PR0
         9 012460   100000 473506                    LDP3    0,QL,PR1
         9 012461   300031 236100                    LDQ     25,,PR3
         9 012462   020000 316007                    CANQ    8192,DL
         9 012463   012467 600000 9                  TZE     s:20994

     2927    20992    3                 THEN CALL M$CLOSE(CLOSE_TP_FILE);

  20992  9 012464   010572 630400 1                  EPPR0   CLOSE_TP_FILE
         9 012465   050001 713400                    CLIMB   close
         9 012466   406000 401760                    pmme    nvectors=13

     2928    20993    3           END;  /* DO SELECT */

     2929    20994    2        RETURN;

  20994  9 012467   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 012470   000001 702211                    TSX2  ! 1,X1

     2930    20995    2   END EXEC_DELETE;
     2931    20996        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:415  
     2932    20997        /**/
     2933    20998    1   EXEC_LIST: PROC ALTRET;

  20998  9 012471   200054 741300       EXEC_LIST    STX1  ! TEMPLEN+1,,AUTO

     2934    20999        /**/
     2935    21000    2           TEMP$ = DCBADDR(DCBNUM(M$LO));

  21000  9 012472   000000 236007 xsym               LDQ     M$LO,DL
         9 012473   000000 470400 10                 LDP0    0
         9 012474   000000 471500                    LDP1    0,,PR0
         9 012475   100000 236106                    LDQ     0,QL,PR1
         9 012476   000014 756000 1                  STQ     TEMP$

     2936    21001    2           IF (TEMP$ -> F$DCB.ASN# = %DEVICE#) THEN I = TEMP$ -> F$DCB.WIDTH#;

  21001  9 012477   000014 473400 1                  LDP3    TEMP$
         9 012500   300032 236100                    LDQ     26,,PR3
         9 012501   777000 376007                    ANQ     -512,DL
         9 012502   003000 116007                    CMPQ    1536,DL
         9 012503   012510 601000 9                  TNZ     s:21002

  21001  9 012504   300004 236100                    LDQ     4,,PR3
         9 012505   000777 376007                    ANQ     511,DL
         9 012506   000025 756000 1                  STQ     I
         9 012507   012512 710000 9                  TRA     s:21004

     2937    21002    2           ELSE I = 80;

  21002  9 012510   000120 235007                    LDA     80,DL
         9 012511   000025 755000 1                  STA     I

     2938    21003        /**/
     2939    21004    2           MAX_CLMN = (I/%CLMN_WIDTH) - 1;

  21004  9 012512   000025 236000 1                  LDQ     I
         9 012513   000014 506007                    DIV     12,DL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:416  
         9 012514   000001 136007                    SBLQ    1,DL
         9 012515   000163 756000 1                  STQ     MAX_CLMN

     2940    21005        /**/
     2941    21006    3           IF (MAX_CLMN < 0) THEN DO;

  21006  9 012516   012525 605000 9                  TPL     s:21016

     2942    21007    3              CALL PCE$ERROR (%E$P_PLATEN2SMALL,2);

  21007  9 012517   000221 630400 10                 EPPR0   145
         9 012520   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012521   000000 701000 xent               TSX1    PCE$ERROR
         9 012522   000000 011000                    NOP     0

     2943    21008    3              ALTRETURN;

  21008  9 012523   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 012524   000000 702211                    TSX2  ! 0,X1

     2944    21009    3              END;
     2945    21010        /**/
     2946    21011        /*E*     ERROR:    PCC-E$P_PLATEN2SMALL-0
     2947    21012                 MESSAGE:  Your platen setting is too small
     2948    21013                 DESCRIPTION: USER HAS SET PLATEN SO SMALL THAT EVEN ONE COLUMN
     2949    21014                                WONT FIT.                          */
     2950    21015        /**/
     2951    21016    2           CUR_CLMN = 0;

  21016  9 012525   000164 450000 1                  STZ     CUR_CLMN

     2952    21017        /**/
     2953    21018    3           DO J = 1 TO %PC_MAXCATAGORY;

  21018  9 012526   000001 235007                    LDA     1,DL
         9 012527   000026 755000 1                  STA     J

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:417  
     2954    21019    3              IF (CAT$ -> CAT$TBL.FLAGS.PRINT(J)) THEN

  21019  9 012530   000026 235000 1                  LDA     J
         9 012531   000001 735000                    ALS     1
         9 012532   000000 470400 1                  LDP0    CAT$
         9 012533   000000 234105                    SZN     0,AL,PR0
         9 012534   012545 605000 9                  TPL     s:21021

     2955    21020    3                 CALL LIST_PRINT(%PC_ADDTEXT,TEXTC_CAT(J)) ALTRET (LIST_ERR);

  21020  9 012535   000026 236000 1                  LDQ     J
         9 012536   000224 402000 10                 MPY     148
         9 012537   000223 036000 10                 ADLQ    147
         9 012540   200060 756100                    STQ     @SIZE,,AUTO
         9 012541   000047 236000 10                 LDQ     39
         9 012542   200057 756100                    STQ     @BLK$,,AUTO
         9 012543   013205 701000 9                  TSX1    LIST_PRINT
         9 012544   013203 702000 9                  TSX2    LIST_ERR

     2956    21021    3              END;

  21021  9 012545   000026 054000 1                  AOS     J
         9 012546   000026 235000 1                  LDA     J
         9 012547   000005 115007                    CMPA    5,DL
         9 012550   012530 604400 9                  TMOZ    s:21019

     2957    21022        /**/
     2958    21023    2           CALL LIST_PRINT(%PC_FLUSH) ALTRET (LIST_ERR);

  21023  9 012551   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 012552   200060 756100                    STQ     @SIZE,,AUTO
         9 012553   000037 236000 10                 LDQ     31
         9 012554   200057 756100                    STQ     @BLK$,,AUTO
         9 012555   013205 701000 9                  TSX1    LIST_PRINT
         9 012556   013203 702000 9                  TSX2    LIST_ERR

     2959    21024        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:418  
     2960    21025    3           DO J = 1 TO %PC_MAXMODE;

  21025  9 012557   000001 235007                    LDA     1,DL
         9 012560   000026 755000 1                  STA     J

     2961    21026    3              IF (INDEX_FLGS.MODE(J)) THEN

  21026  9 012561   000026 235000 1                  LDA     J
         9 012562   012564 605000 9                  TPL     s:21026+3
         9 012563   000044 035003                    ADLA    36,DU
         9 012564   000000 066405                    CMPB    filb='1'B
         9 012565   000226 000001 1                  BDSC    INDEX_FLGS,A             by=0,bit=0,n=1
         9 012566   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 012567   012600 600000 9                  TZE     s:21028

     2962    21027    3                 CALL LIST_PRINT(%PC_ADDTEXT,TEXTC_MODE(J)) ALTRET (LIST_ERR);

  21027  9 012570   000026 236000 1                  LDQ     J
         9 012571   000003 402003                    MPY     3,DU
         9 012572   000225 036000 10                 ADLQ    149
         9 012573   200060 756100                    STQ     @SIZE,,AUTO
         9 012574   000047 236000 10                 LDQ     39
         9 012575   200057 756100                    STQ     @BLK$,,AUTO
         9 012576   013205 701000 9                  TSX1    LIST_PRINT
         9 012577   013203 702000 9                  TSX2    LIST_ERR

     2963    21028    3              END;

  21028  9 012600   000026 054000 1                  AOS     J
         9 012601   000026 235000 1                  LDA     J
         9 012602   000004 115007                    CMPA    4,DL
         9 012603   012561 604400 9                  TMOZ    s:21026

     2964    21029        /**/
     2965    21030    2           CALL LIST_PRINT(%PC_FLUSH) ALTRET (LIST_ERR);

  21030  9 012604   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:419  
         9 012605   200060 756100                    STQ     @SIZE,,AUTO
         9 012606   000037 236000 10                 LDQ     31
         9 012607   200057 756100                    STQ     @BLK$,,AUTO
         9 012610   013205 701000 9                  TSX1    LIST_PRINT
         9 012611   013203 702000 9                  TSX2    LIST_ERR

     2966    21031        /**/
     2967    21032    3           IF (INDEX_FLGS.PART#) THEN DO;

  21032  9 012612   000226 236000 1                  LDQ     INDEX_FLGS
         9 012613   000226 316000 10                 CANQ    150
         9 012614   012700 600000 9                  TZE     s:21052

     2968    21033    3              PRINT_BUF = 'PART#(';

  21033  9 012615   040000 100400                    MLR     fill='040'O
         9 012616   000076 000006 2                  ADSC9   DUMP_LOCK_FMT+21         cn=0,n=6
         9 012617   000165 000204 1                  ADSC9   PRINT_BUF                cn=0,n=132

     2969    21034    3              I = 6;

  21034  9 012620   000006 235007                    LDA     6,DL
         9 012621   000025 755000 1                  STA     I

     2970    21035    4              DO J = 0 TO 15;

  21035  9 012622   000026 450000 1                  STZ     J

     2971    21036    5                 IF (INDEX_FLGS.PART#(J)) THEN DO;

  21036  9 012623   000026 235000 1                  LDA     J
         9 012624   012626 605000 9                  TPL     s:21036+3
         9 012625   000044 035003                    ADLA    36,DU
         9 012626   000000 066405                    CMPB    filb='0'B
         9 012627   000226 050001 1                  BDSC    INDEX_FLGS,A             by=0,bit=5,n=1
         9 012630   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 012631   012660 600000 9                  TZE     s:21045
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:420  

     2972    21037    6                    IF (I ~= 6) THEN DO;

  21037  9 012632   000025 235000 1                  LDA     I
         9 012633   000006 115007                    CMPA    6,DL
         9 012634   012641 600000 9                  TZE     s:21041

     2973    21038    6                       CALL INSERT(PRINT_BUF,I,1,',');

  21038  9 012635   040005 100400                    MLR     fill='040'O
         9 012636   000227 000001 10                 ADSC9   151                      cn=0,n=1
         9 012637   000165 000001 1                  ADSC9   PRINT_BUF,A              cn=0,n=1

     2974    21039    6                       I = I+1;

  21039  9 012640   000025 054000 1                  AOS     I

     2975    21040    6                       END;

     2976    21041    5                    CALL INSERT(PRINT_BUF,I,TEXTC_PART#X.COUNT(J),

  21041  9 012641   000026 720000 1                  LXL0    J
         9 012642   002422 236010 1                  LDQ     TEXTC_PART#X,X0
         9 012643   000033 772000                    QRL     27
         9 012644   000026 235000 1                  LDA     J
         9 012645   000002 735000                    ALS     2
         9 012646   000000 621006                    EAX1    0,QL
         9 012647   000025 236000 1                  LDQ     I
         9 012650   040046 100405                    MLR     fill='040'O
         9 012651   002422 200003 1                  ADSC9   TEXTC_PART#X,A           cn=1,n=3
         9 012652   000165 000011 1                  ADSC9   PRINT_BUF,Q              cn=0,n=*X1

     2977    21042    5                      TEXTC_PART#X.TEXT(J));
     2978    21043    5                    I = I + TEXTC_PART#X.COUNT(J);

  21043  9 012653   000026 720000 1                  LXL0    J
         9 012654   002422 236010 1                  LDQ     TEXTC_PART#X,X0
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:421  
         9 012655   000033 772000                    QRL     27
         9 012656   000025 036000 1                  ADLQ    I
         9 012657   000025 756000 1                  STQ     I

     2979    21044    5                    END;

     2980    21045    4                 END;

  21045  9 012660   000026 054000 1                  AOS     J
         9 012661   000026 235000 1                  LDA     J
         9 012662   000017 115007                    CMPA    15,DL
         9 012663   012623 604400 9                  TMOZ    s:21036

     2981    21046    3              CALL INSERT(PRINT_BUF,I,1,')');

  21046  9 012664   000025 236000 1                  LDQ     I
         9 012665   040006 100400                    MLR     fill='040'O
         9 012666   000204 000001 10                 ADSC9   132                      cn=0,n=1
         9 012667   000165 000001 1                  ADSC9   PRINT_BUF,Q              cn=0,n=1

     2982    21047    3              I = I + 1;

  21047  9 012670   000025 054000 1                  AOS     I

     2983    21048    3              CALL PCW$WRITE(PRINT_BUF,I) ALTRET(LIST_ERR);

  21048  9 012671   000230 630400 10                 EPPR0   152
         9 012672   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 012673   000000 701000 xent               TSX1    PCW$WRITE
         9 012674   013203 702000 9                  TSX2    LIST_ERR

     2984    21049    3              PRINT_BUF = ' ';

  21049  9 012675   040000 100400                    MLR     fill='040'O
         9 012676   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 012677   000165 000204 1                  ADSC9   PRINT_BUF                cn=0,n=132

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:422  
     2985    21050    3              END;

     2986    21051        /**/
     2987    21052    3           DO J = 1 TO %PC_MAXDOMAIN;

  21052  9 012700   000001 235007                    LDA     1,DL
         9 012701   000026 755000 1                  STA     J

     2988    21053    3              IF (INDEX_FLGS.DOMAINE(J)) THEN

  21053  9 012702   000026 235000 1                  LDA     J
         9 012703   012705 605000 9                  TPL     s:21053+3
         9 012704   000044 035003                    ADLA    36,DU
         9 012705   000000 066405                    CMPB    filb='1'B
         9 012706   000226 430001 1                  BDSC    INDEX_FLGS,A             by=2,bit=3,n=1
         9 012707   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 012710   012721 600000 9                  TZE     s:21055

     2989    21054    3                 CALL LIST_PRINT(%PC_ADDTEXT,TEXTC_DOMAIN(J)) ALTRET(LIST_ERR);

  21054  9 012711   000026 236000 1                  LDQ     J
         9 012712   000023 736000                    QLS     19
         9 012713   000232 036000 10                 ADLQ    154
         9 012714   200060 756100                    STQ     @SIZE,,AUTO
         9 012715   000047 236000 10                 LDQ     39
         9 012716   200057 756100                    STQ     @BLK$,,AUTO
         9 012717   013205 701000 9                  TSX1    LIST_PRINT
         9 012720   013203 702000 9                  TSX2    LIST_ERR

     2990    21055    3              END;

  21055  9 012721   000026 054000 1                  AOS     J
         9 012722   000026 235000 1                  LDA     J
         9 012723   000003 115007                    CMPA    3,DL
         9 012724   012702 604400 9                  TMOZ    s:21053

     2991    21056        /**/
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:423  
     2992    21057    2           CALL LIST_PRINT(%PC_FLUSH) ALTRET (LIST_ERR);

  21057  9 012725   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 012726   200060 756100                    STQ     @SIZE,,AUTO
         9 012727   000037 236000 10                 LDQ     31
         9 012730   200057 756100                    STQ     @BLK$,,AUTO
         9 012731   013205 701000 9                  TSX1    LIST_PRINT
         9 012732   013203 702000 9                  TSX2    LIST_ERR

     2993    21058        /**/
     2994    21059    3           DO J = 1 TO %PC_MAXCATAGORY;     /* CHECK INDIVIDUAL PARAMETERS        */

  21059  9 012733   000001 235007                    LDA     1,DL
         9 012734   000026 755000 1                  STA     J

     2995    21060    4              DO K = 1 TO CAT$ -> CAT$TBL.MAXPARAM(J);

  21060  9 012735   000001 235007                    LDA     1,DL
         9 012736   000027 755000 1                  STA     K
         9 012737   013160 710000 9                  TRA     s:21094+1

     2996    21061        /**/
     2997    21062    4                 IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.FLAGS.RES(K)) THEN

  21062  9 012740   000026 235000 1                  LDA     J
         9 012741   000001 735000                    ALS     1
         9 012742   000000 470400 1                  LDP0    CAT$
         9 012743   000001 471505                    LDP1    1,AL,PR0
         9 012744   000027 236000 1                  LDQ     K
         9 012745   000014 402007                    MPY     12,DL
         9 012746   100000 236106                    LDQ     0,QL,PR1
         9 012747   040000 316003                    CANQ    16384,DU
         9 012750   013044 600000 9                  TZE     s:21078

     2998    21063    5                 DO RES_INDX = 0 TO NUM_PSURES + %PSURES_OFFSET-1;

  21063  9 012751   000062 450000 1                  STZ     RES_INDX
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:424  
         9 012752   013036 710000 9                  TRA     s:21076+1

     2999    21064        /**/
     3000    21065    5                    IF (CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.RESPTR$(K)

  21065  9 012753   000026 235000 1                  LDA     J
         9 012754   000001 735000                    ALS     1
         9 012755   000000 470400 1                  LDP0    CAT$
         9 012756   000001 471505                    LDP1    1,AL,PR0
         9 012757   000027 236000 1                  LDQ     K
         9 012760   000014 402007                    MPY     12,DL
         9 012761   100001 473506                    LDP3    1,QL,PR1
         9 012762   000062 235000 1                  LDA     RES_INDX
         9 012763   012765 605000 9                  TPL     s:21065+10
         9 012764   000044 035003                    ADLA    36,DU
         9 012765   000000 066505                    CMPB    filb='1'B
         9 012766   300000 000001                    BDSC    0,A,PR3                  by=0,bit=0,n=1
         9 012767   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 012770   013035 600000 9                  TZE     s:21076

     3001    21066    6                      -> RES$FLGS(RES_INDX)) THEN DO;

     3002    21067    6                       TEXT_C = CAT$ -> CAT$TBL.PARAM$(J) -> P$TBL.TEXT(K);

  21067  9 012771   000026 235000 1                  LDA     J
         9 012772   000001 735000                    ALS     1
         9 012773   000001 471505                    LDP1    1,AL,PR0
         9 012774   000027 236000 1                  LDQ     K
         9 012775   000060 402007                    MPY     48,DL
         9 012776   000000 100506                    MLR     fill='000'O
         9 012777   100002 000021                    ADSC9   2,Q,PR1                  cn=0,n=17
         9 013000   002521 000021 1                  ADSC9   TEXT_C                   cn=0,n=17

     3003    21068    6                       CALL PCR$RESTEXT(RES_INDX,RESTEXT_C);

  21068  9 013001   000201 630400 10                 EPPR0   129
         9 013002   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:425  
         9 013003   000000 701000 xent               TSX1    PCR$RESTEXT
         9 013004   000000 011000                    NOP     0

     3004    21069    6                       CALL INSERT(TEXT_C.TEXT,TEXT_C.COUNT,

  21069  9 013005   002521 236000 1                  LDQ     TEXT_C
         9 013006   000033 772000                    QRL     27
         9 013007   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 013010   002526 236000 1                  LDQ     RESTEXT_C
         9 013011   000033 772000                    QRL     27
         9 013012   000000 620006                    EAX0    0,QL
         9 013013   200076 235100                    LDA     TEMPTEXT+4,,AUTO
         9 013014   040045 100400                    MLR     fill='040'O
         9 013015   002526 200014 1                  ADSC9   RESTEXT_C                cn=1,n=12
         9 013016   002521 200010 1                  ADSC9   TEXT_C,A                 cn=1,n=*X0

     3005    21070    6                         RESTEXT_C.COUNT,RESTEXT_C.TEXT);
     3006    21071    6                       TEXT_C.COUNT = TEXT_C.COUNT + RESTEXT_C.COUNT;

  21071  9 013017   002526 236000 1                  LDQ     RESTEXT_C
         9 013020   000033 772000                    QRL     27
         9 013021   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 013022   002521 236000 1                  LDQ     TEXT_C
         9 013023   000033 772000                    QRL     27
         9 013024   200076 036100                    ADLQ    TEMPTEXT+4,,AUTO
         9 013025   000033 736000                    QLS     27
         9 013026   002521 552040 1                  STBQ    TEXT_C,'40'O

     3007    21072        /**/
     3008    21073    6                       CALL LIST_PRINT(%PC_ADDTEXT,TEXT_C) ALTRET (LIST_ERR);

  21073  9 013027   000233 236000 10                 LDQ     155
         9 013030   200060 756100                    STQ     @SIZE,,AUTO
         9 013031   000047 236000 10                 LDQ     39
         9 013032   200057 756100                    STQ     @BLK$,,AUTO
         9 013033   013205 701000 9                  TSX1    LIST_PRINT
         9 013034   013203 702000 9                  TSX2    LIST_ERR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:426  

     3009    21074        /**/
     3010    21075    6                       END;

     3011    21076    5                    END;

  21076  9 013035   000062 054000 1                  AOS     RES_INDX
         9 013036   000012 236000 1                  LDQ     NUM_PSURES
         9 013037   000003 036007                    ADLQ    3,DL
         9 013040   012753 604000 9                  TMI     s:21065
         9 013041   000062 116000 1                  CMPQ    RES_INDX
         9 013042   012753 605000 9                  TPL     s:21065
         9 013043   013157 710000 9                  TRA     s:21094

     3012    21077    5                 ELSE DO;

     3013    21078    5                    IF (J = %PC_TP AND K = %PC_MAXTPU AND CAT$->CAT$TBL.PARAM$(J)->
             21078                             P$TBL.MAX(K) ~= 0

  21078  9 013044   000026 235000 1                  LDA     J
         9 013045   000004 115007                    CMPA    4,DL
         9 013046   013137 601000 9                  TNZ     s:21090
         9 013047   000027 236000 1                  LDQ     K
         9 013050   000003 116007                    CMPQ    3,DL
         9 013051   013137 601000 9                  TNZ     s:21090
         9 013052   000001 735000                    ALS     1
         9 013053   000001 471505                    LDP1    1,AL,PR0
         9 013054   000014 402007                    MPY     12,DL
         9 013055   100011 235106                    LDA     9,QL,PR1
         9 013056   013137 600000 9                  TZE     s:21090
         9 013057   004522 234000 1                  SZN     TP_TBL+36
         9 013060   013137 604000 9                  TMI     s:21090

     3014    21079    5                       AND NOT TP_TBL.MAXTPU.FLAGS.PRINT)
     3015    21080    6                       THEN DO L = 0 TO 71;

  21080  9 013061   000030 450000 1                  STZ     L
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:427  

     3016    21081    7                          IF MAXTPU_TBL.FLAGS.PRINT(L) THEN DO;

  21081  9 013062   000030 235000 1                  LDA     L
         9 013063   000002 735000                    ALS     2
         9 013064   004562 236005 1                  LDQ     MAXTPU_TBL+3,AL
         9 013065   400000 316007                    CANQ    -131072,DL
         9 013066   013132 600000 9                  TZE     s:21088

     3017    21082    7                             TEXT_C.COUNT = MAXTPU_TBL.COUNT(L) + 8;

  21082  9 013067   004562 236005 1                  LDQ     MAXTPU_TBL+3,AL
         9 013070   000022 772000                    QRL     18
         9 013071   000010 036007                    ADLQ    8,DL
         9 013072   000033 736000                    QLS     27
         9 013073   002521 552040 1                  STBQ    TEXT_C,'40'O

     3018    21083    7                             CALL INSERT(MAXTPU_BUF,7,MAXTPU_TBL.COUNT(L)+1,

  21083  9 013074   004562 220005 1                  LDX0    MAXTPU_TBL+3,AL
         9 013075   004562 221005 1                  LDX1    MAXTPU_TBL+3,AL
         9 013076   000001 622011                    EAX2    1,X1
         9 013077   000030 236000 1                  LDQ     L
         9 013100   000004 736000                    QLS     4
         9 013101   040040 100446                    MLR     fill='040'O
         9 013102   004557 000010 1                  ADSC9   MAXTPU_TBL,Q             cn=0,n=*X0
         9 013103   001736 600012 1                  ADSC9   MAXTPU_BUF+1             cn=3,n=*X2
         9 013104   000000 635010                    EAA     0,X0
         9 013105   000022 771000                    ARL     18
         9 013106   200076 755100                    STA     TEMPTEXT+4,,AUTO
         9 013107   000000 636012                    EAQ     0,X2
         9 013110   000022 772000                    QRL     18
         9 013111   200076 136100                    SBLQ    TEMPTEXT+4,,AUTO
         9 013112   013121 604400 9                  TMOZ    s:21085
         9 013113   000000 621006                    EAX1    0,QL
         9 013114   000000 636010                    EAQ     0,X0
         9 013115   000022 772000                    QRL     18
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:428  
         9 013116   040046 100400                    MLR     fill='040'O
         9 013117   000204 000001 10                 ADSC9   132                      cn=0,n=1
         9 013120   001736 600011 1                  ADSC9   MAXTPU_BUF+1,Q           cn=3,n=*X1

     3019    21084    7                                     SUBSTR(MAXTPU_TBL.NAME(L),0,MAXTPU_TBL.COUNT(L)),
             21084                                               ')');
     3020    21085    7                             TEXT_C.TEXT = MAXTPU_BUF;

  21085  9 013121   040000 100400                    MLR     fill='040'O
         9 013122   001735 000020 1                  ADSC9   MAXTPU_BUF               cn=0,n=16
         9 013123   002521 200020 1                  ADSC9   TEXT_C                   cn=1,n=16

     3021    21086    7                             CALL LIST_PRINT(%PC_ADDTEXT,TEXT_C) ALTRET(LIST_ERR);

  21086  9 013124   000233 236000 10                 LDQ     155
         9 013125   200060 756100                    STQ     @SIZE,,AUTO
         9 013126   000047 236000 10                 LDQ     39
         9 013127   200057 756100                    STQ     @BLK$,,AUTO
         9 013130   013205 701000 9                  TSX1    LIST_PRINT
         9 013131   013203 702000 9                  TSX2    LIST_ERR

     3022    21087    7                             END;  /* IF PRINT */

     3023    21088    6                          END;  /* DO L */

  21088  9 013132   000030 054000 1                  AOS     L
         9 013133   000030 235000 1                  LDA     L
         9 013134   000107 115007                    CMPA    71,DL
         9 013135   013062 604400 9                  TMOZ    s:21081
         9 013136   013157 710000 9                  TRA     s:21094

     3024    21089    6                       ELSE DO;

     3025    21090    6                          IF (CAT$->CAT$TBL.PARAM$(J)->P$TBL.FLAGS.PRINT(K))

  21090  9 013137   000026 235000 1                  LDA     J
         9 013140   000001 735000                    ALS     1
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:429  
         9 013141   000001 471505                    LDP1    1,AL,PR0
         9 013142   000027 236000 1                  LDQ     K
         9 013143   000014 402007                    MPY     12,DL
         9 013144   100000 234106                    SZN     0,QL,PR1
         9 013145   013157 605000 9                  TPL     s:21094

     3026    21091    6                            THEN CALL LIST_PRINT(%PC_ADDTEXT,CAT$->CAT$TBL.PARAM$(J)->
             21091                                      P$TBL.TEXT(K)) ALTRET(LIST_ERR);

  21091  9 013146   000026 235000 1                  LDA     J
         9 013147   000001 735000                    ALS     1
         9 013150   000001 471505                    LDP1    1,AL,PR0
         9 013151   100002 633506                    EPPR3   2,QL,PR1
         9 013152   200060 453500                    STP3    @SIZE,,AUTO
         9 013153   000047 236000 10                 LDQ     39
         9 013154   200057 756100                    STQ     @BLK$,,AUTO
         9 013155   013205 701000 9                  TSX1    LIST_PRINT
         9 013156   013203 702000 9                  TSX2    LIST_ERR

     3027    21092    6                          END;  /* ELSE */

     3028    21093    5                       END;  /* ELSE */

     3029    21094    4                 END;

  21094  9 013157   000027 054000 1                  AOS     K
         9 013160   000026 235000 1                  LDA     J
         9 013161   000001 735000                    ALS     1
         9 013162   000000 470400 1                  LDP0    CAT$
         9 013163   000000 236105                    LDQ     0,AL,PR0
         9 013164   777777 376007                    ANQ     -1,DL
         9 013165   000027 116000 1                  CMPQ    K
         9 013166   012740 605000 9                  TPL     s:21062

     3030    21095    3              END;

  21095  9 013167   000026 054000 1                  AOS     J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:430  
         9 013170   000026 235000 1                  LDA     J
         9 013171   000005 115007                    CMPA    5,DL
         9 013172   012735 604400 9                  TMOZ    s:21060

     3031    21096        /**/
     3032    21097    2           CALL LIST_PRINT(%PC_FLUSH);

  21097  9 013173   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 013174   200060 756100                    STQ     @SIZE,,AUTO
         9 013175   000037 236000 10                 LDQ     31
         9 013176   200057 756100                    STQ     @BLK$,,AUTO
         9 013177   013205 701000 9                  TSX1    LIST_PRINT
         9 013200   000000 011000                    NOP     0

     3033    21098        /**/
     3034    21099    2           RETURN;

  21099  9 013201   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 013202   000001 702211                    TSX2  ! 1,X1

     3035    21100        /**/
     3036    21101    2   LIST_ERR:
     3037    21102    2           ALTRETURN;

  21102  9 013203   200054 221300       LIST_ERR     LDX1  ! TEMPLEN+1,,AUTO
         9 013204   000000 702211                    TSX2  ! 0,X1

     3038    21103        /**/
     3039    21104        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:431  
     3040    21105        /**/
     3041    21106    2   LIST_PRINT: PROC (PRINT_FLAG,TEXT_C) ALTRET;

  21106  9 013205   200056 741300       LIST_PRINT   STX1  ! CODE+1,,AUTO

     3042    21107        /**/
     3043    21108    3   DCL PRINT_FLAG UBIN WORD;
     3044    21109    3   DCL 1 TEXT_C,
     3045    21110    3         2 COUNT UBIN(9) UNAL,
     3046    21111    3         2 TEXT CHAR(19) UNAL;
     3047    21112        /**/
     3048    21113    4           IF (ADDR(TEXT_C) ~= ADDR(NIL)) THEN DO; /* SOMETHING TO PRINT         */

  21113  9 013206   200060 236100                    LDQ     @TEXT_C,,AUTO
         9 013207   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 013210   013263 600000 9                  TZE     s:21126

     3049    21114    5              IF (CUR_CLMN + TEXT_C.COUNT/%CLMN_WIDTH) > MAX_CLMN THEN DO;

  21114  9 013211   200060 470500                    LDP0    @TEXT_C,,AUTO
         9 013212   000100 101500                    MRL     fill='000'O
         9 013213   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         9 013214   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 013215   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 013216   000014 506007                    DIV     12,DL
         9 013217   000164 036000 1                  ADLQ    CUR_CLMN
         9 013220   000163 116000 1                  CMPQ    MAX_CLMN
         9 013221   013241 604400 9                  TMOZ    s:21121

     3050    21115    5                 CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH)

  21115  9 013222   000164 236000 1                  LDQ     CUR_CLMN
         9 013223   000014 402007                    MPY     12,DL
         9 013224   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 013225   200076 631500                    EPPR1   TEMPTEXT+4,,AUTO
         9 013226   200101 451500                    STP1    TEMPTEXT+7,,AUTO
         9 013227   000230 236000 10                 LDQ     152
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:432  
         9 013230   200100 756100                    STQ     TEMPTEXT+6,,AUTO
         9 013231   200100 630500                    EPPR0   TEMPTEXT+6,,AUTO
         9 013232   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 013233   000000 701000 xent               TSX1    PCW$WRITE
         9 013234   013311 702000 9                  TSX2    PRINT_ERR

     3051    21116    5                   ALTRET (PRINT_ERR);
     3052    21117    5                 CUR_CLMN = 0;

  21117  9 013235   000164 450000 1                  STZ     CUR_CLMN

     3053    21118    5                 PRINT_BUF = ' ';

  21118  9 013236   040000 100400                    MLR     fill='040'O
         9 013237   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 013240   000165 000204 1                  ADSC9   PRINT_BUF                cn=0,n=132

     3054    21119    5                 END;

     3055    21120        /**/
     3056    21121    4              CALL INSERT(PRINT_BUF,CUR_CLMN*%CLMN_WIDTH,TEXT_C.COUNT,TEXT_C.TEXT);

  21121  9 013241   200060 470500                    LDP0    @TEXT_C,,AUTO
         9 013242   000100 101500                    MRL     fill='000'O
         9 013243   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         9 013244   200076 000002                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=2
         9 013245   200076 220100                    LDX0    TEMPTEXT+4,,AUTO
         9 013246   000164 236000 1                  LDQ     CUR_CLMN
         9 013247   000014 402007                    MPY     12,DL
         9 013250   040046 100500                    MLR     fill='040'O
         9 013251   000000 200023                    ADSC9   0,,PR0                   cn=1,n=19
         9 013252   000165 000010 1                  ADSC9   PRINT_BUF,Q              cn=0,n=*X0

     3057    21122        /**/
     3058    21123    4              CUR_CLMN = CUR_CLMN + ((TEXT_C.COUNT/%CLMN_WIDTH)+1);

  21123  9 013253   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:433  
         9 013254   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         9 013255   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 013256   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 013257   000014 506007                    DIV     12,DL
         9 013260   000164 036000 1                  ADLQ    CUR_CLMN
         9 013261   000001 036007                    ADLQ    1,DL
         9 013262   000164 756000 1                  STQ     CUR_CLMN

     3059    21124    4              END;

     3060    21125        /**/
     3061    21126    4           IF (PRINT_FLAG = %PC_FLUSH)AND(CUR_CLMN ~= 0) THEN DO;

  21126  9 013263   200057 470500                    LDP0    @PRINT_FLAG,,AUTO
         9 013264   000000 235100                    LDA     0,,PR0
         9 013265   000002 115007                    CMPA    2,DL
         9 013266   013307 601000 9                  TNZ     s:21132
         9 013267   000164 236000 1                  LDQ     CUR_CLMN
         9 013270   013307 600000 9                  TZE     s:21132

     3062    21127    4              CALL PCW$WRITE(PRINT_BUF,(CUR_CLMN)*%CLMN_WIDTH) ALTRET(PRINT_ERR);

  21127  9 013271   000014 402007                    MPY     12,DL
         9 013272   200076 756100                    STQ     TEMPTEXT+4,,AUTO
         9 013273   200076 631500                    EPPR1   TEMPTEXT+4,,AUTO
         9 013274   200101 451500                    STP1    TEMPTEXT+7,,AUTO
         9 013275   000230 236000 10                 LDQ     152
         9 013276   200100 756100                    STQ     TEMPTEXT+6,,AUTO
         9 013277   200100 630500                    EPPR0   TEMPTEXT+6,,AUTO
         9 013300   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 013301   000000 701000 xent               TSX1    PCW$WRITE
         9 013302   013311 702000 9                  TSX2    PRINT_ERR

     3063    21128    4              CUR_CLMN = 0;

  21128  9 013303   000164 450000 1                  STZ     CUR_CLMN

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:434  
     3064    21129    4              PRINT_BUF = ' ';

  21129  9 013304   040000 100400                    MLR     fill='040'O
         9 013305   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 013306   000165 000204 1                  ADSC9   PRINT_BUF                cn=0,n=132

     3065    21130    4              END;

     3066    21131        /**/
     3067    21132    3           RETURN;

  21132  9 013307   200056 221300                    LDX1  ! CODE+1,,AUTO
         9 013310   000001 702211                    TSX2  ! 1,X1

     3068    21133        /**/
     3069    21134    3   PRINT_ERR:
     3070    21135    3           ALTRETURN;

  21135  9 013311   200056 221300       PRINT_ERR    LDX1  ! CODE+1,,AUTO
         9 013312   000000 702211                    TSX2  ! 0,X1

     3071    21136    3   END LIST_PRINT;
     3072    21137    2   END EXEC_LIST;
     3073    21138        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:435  
     3074    21139        /**/
     3075    21140    1   EXEC_STORE: PROC ALTRET;

  21140  9 013313   200054 741300       EXEC_STORE   STX1  ! TEMPLEN+1,,AUTO

     3076    21141        /**/
     3077    21142    3           IF NOT(PC$JIT$ -> B$JIT.PRIV.ACTIVE & %PR_EXMM#) THEN DO;

  21142  9 013314   000007 470400 1                  LDP0    PC$JITPTR
         9 013315   000013 236100                    LDQ     11,,PR0
         9 013316   000004 376000 xsym               ANQ     B_VECTNIL+4
         9 013317   013326 601000 9                  TNZ     s:21151

     3078    21143    3              CALL PCE$ERROR(%E$P_CANTSTORE,3);

  21143  9 013320   000235 630400 10                 EPPR0   157
         9 013321   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 013322   000000 701000 xent               TSX1    PCE$ERROR
         9 013323   000000 011000                    NOP     0

     3079    21144    3              ALTRETURN;

  21144  9 013324   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 013325   000000 702211                    TSX2  ! 0,X1

     3080    21145    3              END;
     3081    21146        /**/
     3082    21147        /*E*     ERROR:    PCC-E$P_CANTSTORE-0
     3083    21148                 MESSAGE:  You are not allowed to STORE values
     3084    21149                 DESCRIPTION: INSUFFICIENT PRIVILEGE    */
     3085    21150        /**/
     3086    21151    2           CALL M$INT(BREAKSET_FPT);

  21151  9 013326   010254 630400 1                  EPPR0   BREAKSET_FPT
         9 013327   010002 713400                    CLIMB   4098
         9 013330   400000 401760                    pmme    nvectors=1

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:436  
     3087    21152        /**/
     3088    21153    2           MONPTR$ = ADDR(JM_LOCK);        /* LOCK TABLES                        */

  21153  9 013331   000237 236000 10                 LDQ     159
         9 013332   000010 756000 1                  STQ     MONPTR$

     3089    21154    2           MONPTR.SEGID = BITBIN(%SPCL1SID);

  21154  9 013333   006021 236007                    LDQ     3089,DL
         9 013334   000010 752003 1                  STCQ    MONPTR$,'03'O

     3090    21155    3           DO WHILE('0'B);  /* DO NEVER */

  21155  9 013335   013341 710000 9                  TRA     s:21158

     3091    21156    3   WAIT:      CALL M$WAIT(FPT_WAIT);

  21156  9 013336   010264 630400 1     WAIT         EPPR0   FPT_WAIT
         9 013337   020006 713400                    CLIMB   8198
         9 013340   400400 401760                    pmme    nvectors=2

     3092    21157    3              END;  /* DO NEVER */

     3093    21158    2           CALL JMN$LOCK(MONPTR$ -> B$TABLE(0)) ALTRET(WAIT);

  21158  9 013341   000010 630400 1                  EPPR0   MONPTR$
         9 013342   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 013343   000000 701000 xent               TSX1    JMN$LOCK
         9 013344   013336 702000 9                  TSX2    WAIT

     3094    21159        /**/
     3095    21160    2           TEMP$ = ADDR(JM_CHNG);

  21160  9 013345   000165 236000 10                 LDQ     117
         9 013346   000014 756000 1                  STQ     TEMP$

     3096    21161    2           TEMPPTR.SEGID = BITBIN(%SPCL1SID);
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:437  

  21161  9 013347   006021 236007                    LDQ     3089,DL
         9 013350   000014 752003 1                  STCQ    TEMP$,'03'O

     3097    21162        /**/
     3098    21163    3           DO I = 0 TO 15;

  21163  9 013351   000025 450000 1                  STZ     I

     3099    21164    3              MONPTR$ = PINCRW(MONPART$,SIZEW(JM$PT)*I);

  21164  9 013352   000025 236000 1                  LDQ     I
         9 013353   000023 402003                    MPY     19,DU
         9 013354   000011 036000 1                  ADLQ    MONPART$
         9 013355   000010 756000 1                  STQ     MONPTR$

     3100    21165    3              SET_PDT$ = PINCRW(PDT$,SIZEW(JM$PT)*I);

  21165  9 013356   000025 236000 1                  LDQ     I
         9 013357   000023 402003                    MPY     19,DU
         9 013360   001702 036000 1                  ADLQ    PDT$
         9 013361   001704 756000 1                  STQ     SET_PDT$

     3101    21166    3              SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*I);

  21166  9 013362   000025 236000 1                  LDQ     I
         9 013363   000023 402003                    MPY     19,DU
         9 013364   001703 036000 1                  ADLQ    PDTFLAG$
         9 013365   001705 756000 1                  STQ     SET_PDTFLAG$

     3102    21167        /**/
     3103    21168    4              IF (SET_PDTFLAG$ -> JM$PT ~= NO) THEN DO; /* SOMETHING TO STORE    */

  21168  9 013366   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 013367   000000 106500                    CMPC    fill='000'O
         9 013370   000000 000114                    ADSC9   0,,PR0                   cn=0,n=76
         9 013371   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:438  
         9 013372   013525 600000 9                  TZE     s:21208

     3104    21169    4                 TEMP$ -> B$BITS(I) = YES; /* SET JM_CHNG                        */

  21169  9 013373   000025 235000 1                  LDA     I
         9 013374   013376 605000 9                  TPL     s:21169+3
         9 013375   000044 035003                    ADLA    36,DU
         9 013376   000014 471400 1                  LDP1    TEMP$
         9 013377   003105 060400                    CSL     bolr='003'O
         9 013400   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 013401   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

     3105    21170        /**/
     3106    21171    5                 IF (SET_PDTFLAG$ -> JM$PT.TL ~= 0) THEN DO;

  21171  9 013402   000000 235100                    LDA     0,,PR0
         9 013403   013410 600000 9                  TZE     s:21175

     3107    21172    5                    MONPTR$ -> JM$PT.TL = SET_PDT$ -> JM$PT.TL;

  21172  9 013404   001704 473400 1                  LDP3    SET_PDT$
         9 013405   000010 474400 1                  LDP4    MONPTR$
         9 013406   300000 235100                    LDA     0,,PR3
         9 013407   400000 755100                    STA     0,,PR4

     3108    21173    5                    END;

     3109    21174        /**/
     3110    21175    5                 IF (SET_PDTFLAG$ -> JM$PT.TU ~= 0) THEN DO;

  21175  9 013410   000001 235100                    LDA     1,,PR0
         9 013411   013416 600000 9                  TZE     s:21179

     3111    21176    5                    MONPTR$ -> JM$PT.TU = SET_PDT$ -> JM$PT.TU;

  21176  9 013412   001704 473400 1                  LDP3    SET_PDT$
         9 013413   000010 474400 1                  LDP4    MONPTR$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:439  
         9 013414   300001 235100                    LDA     1,,PR3
         9 013415   400001 755100                    STA     1,,PR4

     3112    21177    5                    END;

     3113    21178        /**/
     3114    21179    5                 DO J = 0 TO NUM_PSURES + %PSURES_OFFSET-1;

  21179  9 013416   000026 450000 1                  STZ     J
         9 013417   013454 710000 9                  TRA     s:21187+1

     3115    21180    6                    IF (SET_PDTFLAG$ -> JM$PT.RMIN(J) ~= 0) THEN DO;

  21180  9 013420   000026 235000 1                  LDA     J
         9 013421   000001 735000                    ALS     1
         9 013422   001705 470400 1                  LDP0    SET_PDTFLAG$
         9 013423   000100 101505                    MRL     fill='000'O
         9 013424   000015 000002                    ADSC9   13,A,PR0                 cn=0,n=2
         9 013425   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 013426   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 013427   000000 116003                    CMPQ    0,DU
         9 013430   013436 600000 9                  TZE     s:21184

     3116    21181    6                       MONPTR$ -> JM$PT.RMIN(J) = SET_PDT$ -> JM$PT.RMIN(J);

  21181  9 013431   001704 471400 1                  LDP1    SET_PDT$
         9 013432   000010 473400 1                  LDP3    MONPTR$
         9 013433   000105 100505                    MLR     fill='000'O
         9 013434   100015 000002                    ADSC9   13,A,PR1                 cn=0,n=2
         9 013435   300015 000002                    ADSC9   13,A,PR3                 cn=0,n=2

     3117    21182    6                       END;

     3118    21183        /**/
     3119    21184    6                    IF (SET_PDTFLAG$ -> JM$PT.RMAX(J) ~= 0) THEN DO;

  21184  9 013436   000026 235000 1                  LDA     J
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:440  
         9 013437   000001 735000                    ALS     1
         9 013440   000100 101505                    MRL     fill='000'O
         9 013441   000007 000002                    ADSC9   7,A,PR0                  cn=0,n=2
         9 013442   200076 000004                    ADSC9   TEMPTEXT+4,,AUTO         cn=0,n=4
         9 013443   200076 236100                    LDQ     TEMPTEXT+4,,AUTO
         9 013444   000000 116003                    CMPQ    0,DU
         9 013445   013453 600000 9                  TZE     s:21187

     3120    21185    6                       MONPTR$ -> JM$PT.RMAX(J) = SET_PDT$ -> JM$PT.RMAX(J);

  21185  9 013446   001704 471400 1                  LDP1    SET_PDT$
         9 013447   000010 473400 1                  LDP3    MONPTR$
         9 013450   000105 100505                    MLR     fill='000'O
         9 013451   100007 000002                    ADSC9   7,A,PR1                  cn=0,n=2
         9 013452   300007 000002                    ADSC9   7,A,PR3                  cn=0,n=2

     3121    21186    6                       END;

     3122    21187    5                    END;

  21187  9 013453   000026 054000 1                  AOS     J
         9 013454   000012 236000 1                  LDQ     NUM_PSURES
         9 013455   000003 036007                    ADLQ    3,DL
         9 013456   013420 604000 9                  TMI     s:21180
         9 013457   000026 116000 1                  CMPQ    J
         9 013460   013420 605000 9                  TPL     s:21180

     3123    21188        /**/
     3124    21189    5                 IF (SET_PDTFLAG$ -> JM$PT.FLG.LOCK ~= '0'B) THEN DO;

  21189  9 013461   000004 236100                    LDQ     4,,PR0
         9 013462   000001 316007                    CANQ    1,DL
         9 013463   013472 600000 9                  TZE     s:21192

     3125    21190    5                    MONPTR$ -> JM$PT.FLG.LOCK = SET_PDT$ -> JM$PT.FLG.LOCK;

  21190  9 013464   000010 471400 1                  LDP1    MONPTR$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:441  
         9 013465   001704 473400 1                  LDP3    SET_PDT$
         9 013466   300004 236100                    LDQ     4,,PR3
         9 013467   100004 676100                    ERQ     4,,PR1
         9 013470   000001 376007                    ANQ     1,DL
         9 013471   100004 656100                    ERSQ    4,,PR1

     3126    21191    5                    END;

     3127    21192    5                 IF (SET_PDTFLAG$ -> JM$PT.QUAN ~= 0) THEN DO;

  21192  9 013472   000002 235100                    LDA     2,,PR0
         9 013473   013500 600000 9                  TZE     s:21196

     3128    21193    5                    MONPTR$ -> JM$PT.QUAN = SET_PDT$ -> JM$PT.QUAN;

  21193  9 013474   001704 471400 1                  LDP1    SET_PDT$
         9 013475   000010 473400 1                  LDP3    MONPTR$
         9 013476   100002 235100                    LDA     2,,PR1
         9 013477   300002 755100                    STA     2,,PR3

     3129    21194    5                    END;

     3130    21195        /**/
     3131    21196    5                 IF (SET_PDTFLAG$ -> JM$PT.XPRIO ~= 0) THEN DO;

  21196  9 013500   000004 236100                    LDQ     4,,PR0
         9 013501   777000 316007                    CANQ    -512,DL
         9 013502   013507 600000 9                  TZE     s:21200

     3132    21197    5                    MONPTR$ -> JM$PT.XPRIO = SET_PDT$ -> JM$PT.XPRIO;

  21197  9 013503   001704 471400 1                  LDP1    SET_PDT$
         9 013504   000010 473400 1                  LDP3    MONPTR$
         9 013505   100004 236100                    LDQ     4,,PR1
         9 013506   300004 552110                    STBQ    4,'10'O,PR3

     3133    21198    5                    END;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:442  

     3134    21199        /**/
     3135    21200    5                 IF (SET_PDTFLAG$ -> JM$PT.MAX1ACCT ~= 0) THEN DO;

  21200  9 013507   000005 236100                    LDQ     5,,PR0
         9 013510   000777 316007                    CANQ    511,DL
         9 013511   013516 600000 9                  TZE     s:21204

     3136    21201    5                    MONPTR$ -> JM$PT.MAX1ACCT = SET_PDT$ -> JM$PT.MAX1ACCT;

  21201  9 013512   001704 471400 1                  LDP1    SET_PDT$
         9 013513   000010 473400 1                  LDP3    MONPTR$
         9 013514   100005 236100                    LDQ     5,,PR1
         9 013515   300005 552104                    STBQ    5,'04'O,PR3

     3137    21202    5                    END;

     3138    21203        /**/
     3139    21204    5                 IF (SET_PDTFLAG$ -> JM$PT.MAX ~= 0) THEN DO;

  21204  9 013516   000003 236100                    LDQ     3,,PR0
         9 013517   777000 316003                    CANQ    -512,DU
         9 013520   013525 600000 9                  TZE     s:21208

     3140    21205    5                    MONPTR$ -> JM$PT.MAX = SET_PDT$ -> JM$PT.MAX;

  21205  9 013521   001704 471400 1                  LDP1    SET_PDT$
         9 013522   000010 473400 1                  LDP3    MONPTR$
         9 013523   100003 236100                    LDQ     3,,PR1
         9 013524   300003 552140                    STBQ    3,'40'O,PR3

     3141    21206    5                    END;

     3142    21207    4                 END;

     3143    21208    3              END;

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:443  
  21208  9 013525   000025 054000 1                  AOS     I
         9 013526   000025 235000 1                  LDA     I
         9 013527   000017 115007                    CMPA    15,DL
         9 013530   013352 604400 9                  TMOZ    s:21164

     3144    21209        /**/
     3145    21210    2           MONPTR$ = ADDR(JM_LOCK);        /* UNLOCK TABLES                      */

  21210  9 013531   000237 236000 10                 LDQ     159
         9 013532   000010 756000 1                  STQ     MONPTR$

     3146    21211    2           MONPTR.SEGID = BITBIN(%SPCL1SID);

  21211  9 013533   006021 236007                    LDQ     3089,DL
         9 013534   000010 752003 1                  STCQ    MONPTR$,'03'O

     3147    21212    2           CALL JMN$UNLOCK(MONPTR$ -> B$TABLE(0));

  21212  9 013535   000010 630400 1                  EPPR0   MONPTR$
         9 013536   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 013537   000000 701000 xent               TSX1    JMN$UNLOCK
         9 013540   000000 011000                    NOP     0

     3148    21213        /**/
     3149    21214    2           CALL M$OPEN(OPEN_CNTRL_FPT) ALTRET(CNTRL_ERR); /* UPDATE FILE         */

  21214  9 013541   010272 630400 1                  EPPR0   OPEN_CNTRL_FPT
         9 013542   450000 713400                    CLIMB   alt,open
         9 013543   410400 401760                    pmme    nvectors=18
         9 013544   013611 702000 9                  TSX2    CNTRL_ERR

     3150    21215    2           CALL M$WRITE(WRITE_CNTRL_FPT) ALTRET(CNTRL_ERR);

  21215  9 013545   010634 630400 1                  EPPR0   WRITE_CNTRL_FPT
         9 013546   440001 713400                    CLIMB   alt,write
         9 013547   401400 401760                    pmme    nvectors=4
         9 013550   013611 702000 9                  TSX2    CNTRL_ERR
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:444  

     3151    21216    2           CALL M$CLOSE (CLOSE_CNTRL_FPT) ALTRET(CNTRL_ERR);

  21216  9 013551   010650 630400 1                  EPPR0   CLOSE_CNTRL_FPT
         9 013552   450001 713400                    CLIMB   alt,close
         9 013553   406000 401760                    pmme    nvectors=13
         9 013554   013611 702000 9                  TSX2    CNTRL_ERR

     3152    21217        /**/
     3153    21218    2   CLEANUP:
     3154    21219    2           CALL M$INT(BREAK_FPT);

  21219  9 013555   010250 630400 1     CLEANUP      EPPR0   BREAK_FPT
         9 013556   010002 713400                    CLIMB   4098
         9 013557   400000 401760                    pmme    nvectors=1
         9 013560   013562 710000 9                  TRA     s:21223

     3155    21220        /**/
     3156    21221    2   EXEC_CLEAR: ENTRY ALTRET;

  21221  9 013561   200054 741300       EXEC_CLEAR   STX1  ! TEMPLEN+1,,AUTO

     3157    21222        /**/
     3158    21223    3           DO I = 0 TO 15;

  21223  9 013562   000025 450000 1                  STZ     I

     3159    21224    3              SET_PDT$ = PINCRW(PDT$,SIZEW(JM$PT)*I);

  21224  9 013563   000025 236000 1                  LDQ     I
         9 013564   000023 402003                    MPY     19,DU
         9 013565   001702 036000 1                  ADLQ    PDT$
         9 013566   001704 756000 1                  STQ     SET_PDT$

     3160    21225    3              SET_PDTFLAG$ = PINCRW(PDTFLAG$,SIZEW(JM$PT)*I);

  21225  9 013567   000025 236000 1                  LDQ     I
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:445  
         9 013570   000023 402003                    MPY     19,DU
         9 013571   001703 036000 1                  ADLQ    PDTFLAG$
         9 013572   001705 756000 1                  STQ     SET_PDTFLAG$

     3161    21226        /**/
     3162    21227    3              SET_PDT$ -> JM$PT = NO;

  21227  9 013573   001704 470400 1                  LDP0    SET_PDT$
         9 013574   000100 100400                    MLR     fill='000'O
         9 013575   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 013576   000000 000114                    ADSC9   0,,PR0                   cn=0,n=76

     3163    21228    3              SET_PDTFLAG$ -> JM$PT = NO;

  21228  9 013577   001705 471400 1                  LDP1    SET_PDTFLAG$
         9 013600   000100 100400                    MLR     fill='000'O
         9 013601   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 013602   100000 000114                    ADSC9   0,,PR1                   cn=0,n=76

     3164    21229    3              END;

  21229  9 013603   000025 054000 1                  AOS     I
         9 013604   000025 235000 1                  LDA     I
         9 013605   000017 115007                    CMPA    15,DL
         9 013606   013563 604400 9                  TMOZ    s:21224

     3165    21230        /**/
     3166    21231    2           RETURN;

  21231  9 013607   200054 221300                    LDX1  ! TEMPLEN+1,,AUTO
         9 013610   000001 702211                    TSX2  ! 1,X1

     3167    21232        /**/
     3168    21233    2   CNTRL_ERR:
     3169    21234    2           CALL M$CLOSE (CLOSE_CNTRL_FPT);

  21234  9 013611   010650 630400 1     CNTRL_ERR    EPPR0   CLOSE_CNTRL_FPT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:446  
         9 013612   050001 713400                    CLIMB   close
         9 013613   406000 401760                    pmme    nvectors=13

     3170    21235    2           CALL PCE$ERROR(0,3);

  21235  9 013614   000033 630400 10                 EPPR0   27
         9 013615   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 013616   000000 701000 xent               TSX1    PCE$ERROR
         9 013617   000000 011000                    NOP     0

     3171    21236    2           CALL PCE$ERROR(%E$P_CNTRLERR,3);

  21236  9 013620   000177 630400 10                 EPPR0   127
         9 013621   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 013622   000000 701000 xent               TSX1    PCE$ERROR
         9 013623   000000 011000                    NOP     0

     3172    21237    2           GOTO CLEANUP;

  21237  9 013624   013555 710000 9                  TRA     CLEANUP

     3173    21238        /**/
     3174    21239    2   END EXEC_STORE;
     3175    21240        /**/
     3176    21241        %EJECT;
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:447  
     3177    21242        /**/
     3178    21243        /**/
     3179    21244    1   END PCC$CONTROL;

  21244  9 013625   000000 702200 xent               TSX2  ! X66_MARET

PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:448  
--  Include file information  --

   IG_CNTRLNR_R.:E05TOU  cannot be made into a system file and is referenced.
   UQ_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   UMT_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   MM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JZ_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   ES_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FO_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FT_SUBS.:E05TOU  is referenced.
   FT_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   FM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   JM_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   FM_CACHE_C.:E05TOU  is referenced.
   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:449  
   PC_PERR_C.:E05TOU  is referenced.
   PC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure PCC$CONTROL.
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:450  

 **** Variables and constants ****

  ****  Section 001  Data  PCC$CONTROL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

 10244-0-0/d STRC(144)   r     1 ACCESS_FPT             10553-0-0/w STRC(126)   r     1 ACSLIST
  2342-0-0/w STRC(1440)  r     1 B$HEAD                    33-0-0/b BIT         r     1 BITVAL
    15-0-0/w PTR         r     1 BLK$                   10254-0-0/d STRC(144)   r     1 BREAKSET_FPT
 10250-0-0/d STRC(144)   r     1 BREAK_FPT              11352-0-0/d STRC(216)   r     1 BYE_BYE
     0-0-0/w PTR         r     1 CAT$                    4536-0-0/w STRC(432)   r     1 CATAGORY_TBL
 10650-0-0/d STRC(1080)  r     1 CLOSE_CNTRL_FPT        10706-0-0/d STRC(1080)  r     1 CLOSE_LO_FPT
 11176-0-0/d STRC(1080)  r     1 CLOSE_RU               10572-0-0/d STRC(1080)  r     1 CLOSE_TP_FILE
    63-0-0/c CHAR(256)   r     1 CMD_BUF                10746-0-0/c STRC(90)    r     1 CNTRLCMD_FILE
 10744-0-0/c STRC(63)    r     1 CNTRL_FILE              2414-0-0/b STRC        r     1 CNTRL_KEY
    31-0-0/w SBIN        r     1 CURINSTANCES
  4553-0-0/b BIT         r     1 CURRFLGS(0:15)
  1734-0-0/w UBIN        r     1 CURUTS                   164-0-0/w SBIN        r     1 CUR_CLMN
 10170-0-0/d STRC(432)   r     1 CUR_UTS                 2537-0-0/c CHAR        r     1 DASH
   541-0-0/b BIT         r     1 DISP_CAT(0:5)
   230-0-0/w STRC(7236)  r     1 DISP_TBL                2540-0-0/d STRC(72)    r     1 DS_RESULTS
  2050-0-0/b BIT (72)    r     1 DUMP_BUF                2052-0-0/b BIT (72)    r     1 DUMP_LOCK
 10222-0-0/d STRC(432)   r     1 ECHO_FPT                4332-0-0/w STRC(3024)  r     1 EXCEPTION_TBL
 10630-0-0/d STRC(144)   r     1 EXTEND_TP_FILE          2304-0-0/w STRC(1080)  r     1 FDS
 11120-0-0/c STRC(72)    r     1 FID_ACCT               11110-0-0/c STRC(288)   r     1 FID_NAME
 11122-0-0/c STRC(72)    r     1 FID_PASS               11076-0-0/d STRC(324)   r     1 FID_RESULTS
 11126-0-0/d STRC(90)    r     1 FID_SN                 11124-0-0/c STRC(72)    r     1 FID_WSN
 11234-0-0/d STRC(144)   r     1 FMS_PRIV               11240-0-0/d STRC(432)   r     1 FPT_MONINFO
 11164-0-0/d STRC(360)   r     1 FPT_TRAP               10264-0-0/d STRC(216)   r     1 FPT_WAIT
 10236-0-0/d STRC(216)   r     1 GDS_FPT                   22-0-0/w PTR         r     1 HDR$
  2412-0-0/w STRC(45)    r     1 HEADKEY                10754-0-0/d STRC(864)   r     1 HEAD_FID
    25-0-0/w SBIN        r     1 I                         20-0-0/w PTR         r     1 INDEX$
   226-0-0/b STRC(25)    r     1 INDEX_FLGS                26-0-0/w SBIN        r     1 J
    27-0-0/w SBIN        r     1 K                         30-0-0/w SBIN        r     1 L
    21-0-0/w PTR         r     1 M$SI$                   1712-0-0/w BIT         r     1 MASK_VALUE
  4552-0-0/b BIT         r     1 MAXRFLGS(0:15)
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:451  
  1735-0-0/c CHAR(16)    r     1 MAXTPU_BUF
  4557-0-0/w STRC(144)   r     1 MAXTPU_TBL(0:71)
   163-0-0/w SBIN        r     1 MAX_CLMN                  11-0-0/w PTR         r     1 MONPART$
    11-0-0/w STRC        r     1 MONPARTPTR                10-0-0/w STRC        r     1 MONPTR
    10-0-0/w PTR         r     1 MONPTR$
  1713-0-0/w BIT         r     1 MONSER_VALUE(0:15)
    12-0-0/w UBIN        r     1 NUM_PSURES             10272-0-0/d STRC(2088)  r     1 OPEN_CNTRL_FPT
 10364-0-0/d STRC(2088)  r     1 OPEN_CONTROL_S         11004-0-0/d STRC(2088)  r     1 OPEN_RU
 10456-0-0/d STRC(2088)  r     1 OPEN_TP_CNTRL           2054-0-0/c CHAR(132)   r     1 OUTBUF
    17-0-0/w PTR         r     1 PARAM$                    16-0-0/w PTR         r     1 PART#$
   227-0-0/b BIT         r     1 PART#_FLGS(0:15)
     2-0-0/w PTR         r     1 PART$                   4076-0-0/w STRC(5616)  r     1 PARTITION_TBL
     7-0-0/w PTR         r     1 PC$JIT$                    7-0-0/b STRC        r     1 PC$JITPTR
     6-0-0/w UBIN        r     1 PC_REASON                542-0-0/w UBIN        r     1 PDT(0:303)
  1702-0-0/w PTR         r     1 PDT$                    1703-0-0/w PTR         r     1 PDTFLAG$
  1222-0-0/w UBIN        r     1 PDTFLAGS(0:303)
  4556-0-0/b BIT         r     1 PMAXRFLGS(0:15)
  4555-0-0/b BIT         r     1 PMINRFLGS(0:15)
   165-0-0/c CHAR(132)   r     1 PRINT_BUF              10260-0-0/d STRC(144)   r     1 PRIV_FPT
    42-0-0/c CHAR(8)     r     1 PSURES_TEXT(0:7)
  2115-0-0/w PTR         r     1 P_PCB$                 10204-0-0/d STRC(504)   r     1 READ_CMD_FPT
 11132-0-0/d STRC(504)   r     1 READ_HEAD                 36-0-0/d REMB        r     1 REMEM_CMD_READ
     3-0-0/w PTR         r     1 RES$                    4016-0-0/w STRC(1728)  r     1 RESOURCE_TBL
  2526-0-0/c STRC(117)   r     1 RESTEXT_C                 62-0-0/w SBIN        r     1 RES_INDX
    40-0-0/c CHAR(2)     r     1 RES_TEXT(0:3)
  1742-0-0/w STRC(1197)  r     1 RUBUF
  2004-0-0/w STRC(117)   r     1 RUPARAM_TBL(0:8)
  1741-0-0/b BIT         r     1 RU_PARAMS(0:35)
    35-0-0/b BIT         r     1 SETAUTH                 1706-0-0/w SBIN        r     1 SET_CAT
  1711-0-0/w SBIN        r     1 SET_INDEXHI             1710-0-0/w SBIN        r     1 SET_INDEXLO
  1707-0-0/w SBIN        r     1 SET_PARAM               1704-0-0/w PTR         r     1 SET_PDT$
  1705-0-0/w PTR         r     1 SET_PDTFLAG$           10751-0-0/c STRC(72)    r     1 SYSACCT
  2542-0-0/w STRC(24624) r     1 SYSTEM_TBL                32-0-0/w SBIN        r     1 TBLINSTANCES
    14-0-0/w PTR         r     1 TEMP$                     23-0-0/w SBIN        r     1 TEMP1
    24-0-0/w SBIN        r     1 TEMP2                     14-0-0/w STRC        r     1 TEMPPTR
  2446-0-0/c STRC(117)   r     1 TEXTC_CAT(0:5)
  2511-0-0/c STRC(72)    r     1 TEXTC_DOMAIN(0:3)
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:452  
  2442-0-0/c STRC        r     1 TEXTC_DOMAINX(0:3)
  2472-0-0/c STRC(108)   r     1 TEXTC_MODE(0:4)
  2415-0-0/c STRC        r     1 TEXTC_MODEX(0:4)
  2422-0-0/c STRC        r     1 TEXTC_PART#X(0:15)
  2521-0-0/c STRC(153)   r     1 TEXT_C                  2532-0-0/c CHAR(19)    r     1 TEXT_CONTROLHERE
  4554-0-0/b BIT         r     1 TOTRFLGS(0:15)
  5217-0-0/w STRC(747)   r     1 TPHDR_TBL(0:71)
 10550-0-0/c STRC(99)    r     1 TP_CNTRL_D              4456-0-0/w STRC(1728)  r     1 TP_TBL
  1712-0-0/w SBIN        r     1 VALUE                  10557-0-0/w STRC(378)   r     1 VEHLIST
 11254-0-0/d STRC(2232)  r     1 VLR_SITEINFO            1733-0-0/w SBIN        r     1 WORDS_AVAIL
 10634-0-0/d STRC(432)   r     1 WRITE_CNTRL_FPT        11150-0-0/d STRC(432)   r     1 WRITE_HEAD
  2232-0-0/d STRC(1512)  r     1 XUG_GETCMD              2166-0-0/d STRC(1296)  r     1 XUG_INIT
  2116-0-0/d STRC(1404)  r     1 XUR_INIT

  ****  Section 002 RoData PCC$CONTROL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    47-0-0/c CHAR(6)     r     1 DUMP_FMT                  51-0-0/c CHAR(20)    r     1 DUMP_LOCK_FMT
     0-0-0/w STRC(1260)  r     1 PRIV_VALS                 43-0-0/c CHAR(7)     r     1 RU_FMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    57-0-0/w PTR         r     1 @BLK$                     67-0-0/w PTR         r     1 @ERR#
    70-0-0/w PTR         r     1 @INDX                     71-0-0/w PTR         r     1 @LIMIT
    60-0-0/w PTR         r     1 @OUT_SYM                  57-0-0/w PTR         r     1 @PRINT_FLAG
    57-0-0/w PTR         r     1 @RES_INDEX                60-0-0/w PTR         r     1 @SIZE
    60-0-0/w PTR         r     1 @TEXT_C                   60-0-0/c CHAR(4)     r     1 ACRONYM
    *0-0-0/w PTR         r     1 BLK$                      10-0-0/w SBIN        r     1 CODE
    55-0-0/w SBIN        r     1 CODE                      27-0-0/w SBIN        r     1 CUR_SIZE_OF_DATA
    26-0-0/w SBIN        r     1 CUR_SIZE_OF_FILE          52-0-0/w SBIN        r     1 DCB_WIDTH
    36-0-0/w SBIN        r     1 DELINDX                   *0-0-0/w SBIN        r     1 ERR#
     4-0-0/w UBIN        r     1 FIRST_BIT                 25-0-0/b BIT         r     1 FOUND
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:453  
    61-0-0/c CHAR(8)     r     1 INBUF                     61-0-0/w SBIN        r     1 INDX
    *0-0-0/w SBIN        r     1 INDX                      31-0-0/w PTR         r     1 INSTANCE$
    17-0-0/c CHAR(8)     r     1 INSTANCE_NAME              5-0-0/w UBIN        r     1 LAST_BIT
    *0-0-0/w SBIN        r     1 LIMIT                     16-0-0/w PTR         r     1 LIT$
    14-0-0/w UBIN        r     1 MASKVALHI                 63-0-0/w PTR         r     1 N$
    57-0-0/w SBIN        r     1 OFFSET                    *0-0-0/w ASTR(153)   r     1 OUT_SYM
    12-0-0/w PTR         r     1 PC$                       11-0-0/h UBIN(18)    r     1 PMME
    11-0-0/h STRC(18)    r     1 PMME_REDEF                *0-0-0/w UBIN        r     1 PRINT_FLAG
    32-0-0/w PTR         r     1 PTR$                      *0-0-0/w SBIN        r     1 RES_INDEX
    *0-0-0/w SBIN        r     1 SIZE                      15-0-0/w PTR         r     1 SUBLK$
    30-0-0/w PTR         r     1 TABLE$                    37-0-0/w SBIN        r     1 TBLINDX
     3-0-0/w PTR         r     1 TEMP1$                    40-0-0/c CHAR(32)    r     1 TEMPBUF
    53-0-0/w SBIN        r     1 TEMPLEN                   50-0-0/c CHAR(8)     r     1 TEMPNAME
    72-0-0/c CHAR(12)    r     1 TEMPTEXT
    72-0-0/c CHAR        r     1 TEMPTEXT_ARRAY(0:11)
    *0-0-0/c STRC(180)   r     1 TEXT_C                    13-0-0/w PTR         r     1 VAL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS5$                     0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 B$XL_UPPER$
     0-0-0/w UBIN        r     1 B_CNTRL_HIGH               0-0-0/w UBIN        r     1 B_CNTRL_LOW
     0-0-0/w UBIN        r     1 B_MUAIS                    0-0-0/c CHAR        r     1 B_VERSION
     0-0-0/w UBIN        r     1 EL_SECLOGSIZE              0-0-0/w UBIN        r     1 ES_CLEARMEM
     0-0-0/w UBIN        r     1 ES_LOGFILEDENY             0-0-0/w UBIN        r     1 ES_LOGFILEGRANT
     0-0-0/w UBIN        r     1 ES_LOGMONSER               0-0-0/w UBIN        r     1 ES_LOGPRIVCHNG
     0-0-0/w UBIN        r     1 ES_LOGSYSACC               0-0-0/w UBIN        r     1 ES_LOGSYSEXIT
     0-0-0/b BIT         r     1 ES_MONSERTBL(0:8191)
     0-0-0/b BIT         r     1 ES_PRIVCHNGMASK            0-0-0/b BIT         r     1 ES_PRIVMASK
     0-0-0/w UBIN        r     1 ES_PROTECTSECLOG           0-0-0/b BIT         r     1 ES_STEPPRIVMASK
     0-0-0/w STRC(72)    r     1 FMC_LIMITS(0:8191)
     0-0-0/w UBIN        r     1 FO_JOBSTATSAGE             0-0-0/w STRC(1152)  r     1 FO_SYMBINFO
     0-0-0/w SBIN        r     1 FR_MEMM(0:4)
     0-0-0/w PTR         r     1 FR_PRC$(0:4)
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:454  
     0-0-0/w PTR         r     1 FR_PRM$(0:4)
     0-0-0/w PTR         r     1 FR_SUC$(0:4)
     0-0-0/w PTR         r     1 FR_SUM$(0:4)
     0-0-0/w SBIN        r     1 FR_SUMX
     0-0-0/c CHAR(8)     r     1 FR_SUNM(0:7)
     0-0-0/w SBIN        r     1 FT_PROT                    0-0-0/b BIT (16)    r     1 JM_CHNG
     0-0-0/w SBIN        r     1 JM_LOCK                    0-0-0/w UBIN        r     1 JM_MAX1ACCT
     0-0-0/w UBIN        r     1 JM_NPART                   0-0-0/w SBIN        r     1 JM_PI
     0-0-0/w STRC(10944) r     1 JM_PT
     0-0-0/w SBIN        r     1 JS_PRDPRM(0:3)
     0-0-0/w SBIN        r     1 JS_REMCPO(0:3)
     0-0-0/w SBIN        r     1 JS_REMDO(0:3)
     0-0-0/w SBIN        r     1 JS_REMLO(0:3)
     0-0-0/w SBIN        r     1 JS_SHARE_ALL
     0-0-0/w SBIN        r     1 JS_TIME(0:3)
     0-0-0/w SBIN        r     1 JS_TMDPRM(0:3)
     0-0-0/w UBIN        r     1 JZ_RETIM                   0-0-0/w UBIN        r     1 MM_AUTO_PRIO
     0-0-0/w UBIN        r     1 MM_CACHE_PRIO              0-0-0/w UBIN        r     1 MM_CG_PRIO
     0-0-0/w UBIN        r     1 MM_FREETHRESH              0-0-0/w UBIN        r     1 MM_NOUSTHRESH
     0-0-0/w UBIN        r     1 NI_IOLEAPERS               0-0-0/w UBIN        r     1 PCN_CMDS
     0-0-0/w SBIN        r     1 SL_IOTA(0:4)
     0-0-0/w SBIN        r     1 SL_MF(0:4)                 0-0-0/w SBIN        r     1 SL_MFU(0:4)
     0-0-0/w SBIN        r     1 SL_QMIN(0:4)
     0-0-0/w SBIN        r     1 SL_QUAN                    0-0-0/c STRC(288)   r     1 SUB_BUF_1
     0-0-0/c STRC(288)   r     1 SUB_BUF_2                  0-0-0/w SBIN        r     1 S_CTUIS
     0-0-0/w SBIN        r     1 S_CUIS(0:4)                0-0-0/w SBIN        r     1 S_MUIS(0:4)
     0-0-0/w SBIN        r     1 S_PRIOB(0:4)
     0-0-0/w SBIN        r     1 S_TUIS                     0-0-0/c CHAR(4)     r     1 UMT_TIMEZONE
     0-0-0/w SBIN        r     1 UMT_UTC_OFFSET             0-0-0/w UBIN        r     1 UQ_MAXENQ
     0-0-0/w SBIN        r     1 XST_TIMEZONE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/b BIT         r     1 B$BITS(0:0)
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:455  
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC        r     1 B$PTR(0:0)
     0-0-0/w UBIN        r     1 B$TABLE(0:0)
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w UBIN        r     1 B$UBIN
     0-0-0/c ASTR(9)     r     1 B$VERSIONB                 0-0-0/d STRC(4608)  r     1 B$XL_UPPER
     0-0-0/w STRC(72)    r     1 CAT$TBL(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(684)   r     1 JM$PT
     0-0-0N  NULL        r     1 M$CNTRL                    0-0-0N  NULL        r     1 M$HEAD
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$TP                       0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(144)   r     1 O$BLK                      0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(432)   r     1 P$TBL(0:0)                 0-0-0/w STRC        r     1 PC$HDR
     0-0-0/w STRC(2700)  r     1 PC$INSTANCE
     0-0-0/b UBIN(9)     r     1 PC_CODE(0:0)
     0-0-0/c CHAR(8)     r     1 PSURES$TEXT(0:7)
     0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/b BIT         r     1 RES$FLGS(0:15)
     0-0-0/w STRC        r     1 TEXTC$INDX(0:0)
     0-0-0/w BIT         r     1 VAL_CODE(0:0)


   Procedure PCC$CONTROL requires 6038 words for executable code.
   Procedure PCC$CONTROL requires 74 words of local(AUTO) storage.

    No errors detected in file PCC$CONTROL.:E05TSI    .
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:456  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:457  
          MINI XREF LISTING

ACCESS_FPT
     17665**DCL     18999<>CALL
ACCESS_FPT.V
     17665**DCL     17665--DCLINIT
ACRONYM IN PROCEDURE SET_TIMEZONE
     20519**DCL     20536<<ASSIGN  20537<>CALL    20538>>IF      20542<<ASSIGN  20544--ASSIGN
ACSLIST
     18125**DCL     18044--DCLINIT
ACSLIST.Q
     18126**DCL     18125--DCLINIT
ADD_INSTANCE IN PROCEDURE EXEC_SET
     20377**LABEL   20370--GOTO
ALT IN PROCEDURE EXEC_ADD
     19405**LABEL   19333--CALLALT 19380--CALLALT
B$ALT.CODE
     15927**DCL     15927--REDEF   15928--REDEF   15928--REDEF
B$ALT.ERR.CODE
     15929**DCL     20316>>IF      20985>>IF
B$ALT.ERR.ERR#
     15929**DCL     15929--REDEF
B$ALT.EVID
     15928**DCL     15928--REDEF   15928--REDEF
B$BITS
     15978**DCL     19991<<ASSIGN  20634<<ASSIGN  21169<<ASSIGN
B$DS5$
     16232**DCL     12822--IMP-PTR 19041>>ASSIGN  19042>>ASSIGN  19047>>ASSIGN  20312>>ASSIGN  20313>>ASSIGN
     20334>>ASSIGN  20335>>ASSIGN  20350>>ASSIGN  20351>>DOINDEX 20366>>ASSIGN  20375>>ASSIGN  20375>>ASSIGN
     20401>>ASSIGN  20402>>DOINDEX 20424>>ASSIGN  20425>>DOINDEX 20441>>ASSIGN  20442>>DOINDEX 20468>>ASSIGN
     20469>>DOINDEX 20945>>ASSIGN  20947>>DOINDEX 20959>>ASSIGN
B$HEAD
     12876**DCL     18772--DCLINIT 18773--DCLINIT 18813--DCLINIT 18814--DCLINIT
B$HEAD.LOCK
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:458  
     12999**DCL     19731--CALL    20283<<ASSIGN  20286>>ASSIGN
B$HEAD.NOCHGPMEM
     13020**DCL     19652>>IF      20250<<ASSIGN
B$HEAD.PROCACC
     13017**DCL     19670>>IF      20254<<ASSIGN
B$HEAD.PROCSURCHG
     13023**DCL     19679>>IF      20256<<ASSIGN
B$HEAD.PSEUDO_COUNT
     13035**DCL     19702>>IF      19712>>CALLBLT 20261<<ASSIGN  20263<<ASSIGN
B$HEAD.PSEUDO_TEXT
     13043**DCL     19703>>CALLBLT 20260<<ASSIGN  20265<<ASSIGN
B$HEAD.RESTPROC
     13026**DCL     20286<<ASSIGN
B$HEAD.S
     13004**DCL     19661>>IF      20252<<ASSIGN
B$HEAD.STATS
     12982**DCL     19688>>IF      20258<<ASSIGN
B$HEAD.STRONG_LOCK
     13029**DCL     19697>>IF      20268<<ASSIGN
B$JIT.CCBUF
      4874**DCL     18972>>IF
B$JIT.CPFLAGS1
      4875**DCL     19139>>IF
B$JIT.CPFLAGS1.SLEAZE
      4880**DCL      4880--REDEF
B$JIT.ERR.MID
      4787**DCL      4787--REDEF
B$JIT.JRESPEAK
      4948**DCL      4949--REDEF
B$JIT.MODE
      4781**DCL     18972>>IF      19139>>IF      19139>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      5057**DCL      5057--REDEF    5058--REDEF
B$JIT.PNR
      4961**DCL      4961--REDEF
B$JIT.PRIV.ACTIVE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:459  
      4787**DCL     21142>>IF
B$JIT.PRIV.AUTH
      4827**DCL     18983>>IF
B$JIT.PRIV.JOB
      4830**DCL     18966>>IF      20319>>IF      20326>>IF      20484>>IF
B$JIT.TSLINE
      5055**DCL      5056--REDEF
B$JIT$
     16231**DCL      4781--IMP-PTR 18966>>IF      18983>>IF      20319>>IF      20326>>IF      20484>>IF
B$PTR.ADDRESS
     15980**DCL     20659>>ASSIGN  20660>>ASSIGN  20671>>ASSIGN  20672>>ASSIGN  20772>>ASSIGN  20782>>ASSIGN
B$TABLE
     15977**DCL     19010>>ASSIGN  19847>>DOINDEX 20581>>IF      20583>>CALL    20587>>IF      20589>>CALL
     20605>>IF      20607>>CALL    20611>>IF      20613>>CALL    20625<<ASSIGN  20627<<ASSIGN  20649>>IF
     20650<>CALL    20654<<ASSIGN  20661>>IF      20662<>CALL    20666<<ASSIGN  20673>>IF      20674<>CALL
     20678<<ASSIGN  20773>>IF      20774<>CALL    20783>>IF      20784<>CALL    21158<>CALL    21212<>CALL
B$TCB.ALT$
     15923**DCL     20316>>IF      20985>>IF
B$TCB$
     16233**DCL     20316>>IF      20985>>IF
B$UBIN IN PROCEDURE SET_TIMEZONE
     20522**DCL     20544>>ASSIGN
B$VERSIONB.C_
     13132**DCL     13133--IMP-SIZ 18988>>CALLBLT 18988>>CALLBLT
B$VERSIONB.T_
     13133**DCL     18988>>CALLBLT
B$XL_UPPER
     17532**DCL     20231>>CALLBLT
B$XL_UPPER$
     17531**DCL     17532--IMP-PTR 20231>>CALLBLT
BAD_CLOSE IN PROCEDURE EXEC_DISPLAY
     19748**LABEL   19746--CALLALT
BAD_CLOSE IN PROCEDURE EXEC_SET
     20300**LABEL   20298--CALLALT
BAD_FID IN PROCEDURE EXEC_DISPLAY
     19736**LABEL   19624--CALLALT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:460  
BAD_FID IN PROCEDURE EXEC_SET
     20291**LABEL   20210--CALLALT
BAD_FILE IN PROCEDURE EXEC_DISPLAY
     19739**LABEL   19626--CALLALT 19627--CALLALT
BAD_FILE IN PROCEDURE EXEC_SET
     20294**LABEL   20212--CALLALT 20213--CALLALT 20289--CALLALT
BAD_RES IN PROCEDURE EXEC_ADD
     19403**LABEL   19387--CALLALT
BAD_RES IN PROCEDURE EXEC_DISPLAY
     19863**LABEL   19577--CALLALT
BAD_RES IN PROCEDURE EXEC_SET
     20497**LABEL   20114--CALLALT 20178--CALLALT
BAD_TIMEZONE IN PROCEDURE EXEC_SET
     20018**LABEL   20021--CALLALT
BAD_TP IN PROCEDURE EXEC_SET
     20326**LABEL   20324--CALLALT
BITVAL
     11684**DCL     19158<<ASSIGN  19163<<ASSIGN  19179>>ASSIGN  19183>>ASSIGN  19187>>ASSIGN  19191>>IF
     19193>>ASSIGN  19197>>ASSIGN  19201>>ASSIGN  19205>>IF      19209>>ASSIGN  19215>>ASSIGN  19249>>ASSIGN
     19254>>ASSIGN  19259>>ASSIGN  19263>>ASSIGN  19267>>ASSIGN  19271>>IF      19275>>ASSIGN  19277>>IF
     19281>>ASSIGN  19290>>ASSIGN  19292>>ASSIGN  19294>>IF      19306>>ASSIGN  19308>>IF      19337>>ASSIGN
     19339>>ASSIGN  19341>>IF      19353>>ASSIGN  19355>>IF      19391>>ASSIGN  19395>>ASSIGN  19769<<ASSIGN
     19771>>IF      19778<<ASSIGN  19786<<ASSIGN  19788>>IF      19795<<ASSIGN
BLK$
     11668**DCL     15846--IMP-PTR 15883--IMP-PTR 19173<<ASSIGN  19175>>DOCASE  19215>>ASSIGN  19219>>ASSIGN
     19254>>ASSIGN  19258>>ASSIGN  19286>>ASSIGN  19287>>ASSIGN  19383>>ASSIGN  19387>>CALL    19387>>CALL
     19436<<ASSIGN  19438>>DOCASE  19450>>ASSIGN  19483>>ASSIGN  19484>>IF      19487>>DOCASE  19491>>IF
     19494>>ASSIGN  19502>>IF      19505>>ASSIGN  19515>>ASSIGN  19517>>ASSIGN  19582>>IF      19597>>ASSIGN
     19623>>ASSIGN  19623>>ASSIGN  19628>>DOINDEX 19629>>DOCASE  19636>>ASSIGN  19938<<ASSIGN  19939>>IF
     19948>>DOCASE  19952>>ASSIGN  19955>>ASSIGN  19971>>IF      19971>>IF      19977>>ASSIGN  19977>>ASSIGN
     20016>>IF      20016>>IF      20024>>IF      20024>>IF      20025>>IF      20025>>IF      20032>>ASSIGN
     20032>>ASSIGN  20033>>ASSIGN  20033>>ASSIGN  20039>>CALLBLT 20039>>CALLBLT 20039>>CALLBLT 20039>>CALLBLT
     20044>>IF      20044>>IF      20058>>DOINDEX 20059>>ASSIGN  20078>>IF      20090>>ASSIGN  20099>>IF
     20099>>IF      20100>>IF      20100>>IF      20107>>ASSIGN  20107>>ASSIGN  20108>>IF      20108>>IF
     20111>>CALLBLT 20111>>CALLBLT 20111>>CALLBLT 20111>>CALLBLT 20123>>IF      20123>>IF      20131>>DOINDEX
     20132>>ASSIGN  20140>>IF      20153>>ASSIGN  20162>>IF      20162>>IF      20163>>IF      20163>>IF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:461  
     20170>>ASSIGN  20170>>ASSIGN  20171>>IF      20171>>IF      20174>>CALLBLT 20174>>CALLBLT 20174>>CALLBLT
     20174>>CALLBLT 20183>>IF      20183>>IF      20191>>DOINDEX 20192>>ASSIGN  20208>>ASSIGN  20214>>DOINDEX
     20215>>ASSIGN  20346>>DOCASE  20348>>DOINDEX 20349>>ASSIGN  20349>>ASSIGN  20356>>ASSIGN  20383>>ASSIGN
     20393>>ASSIGN  20394>>ASSIGN  20398>>DOINDEX 20399>>ASSIGN  20399>>ASSIGN  20416>>ASSIGN  20434>>ASSIGN
     20435>>ASSIGN  20438>>DOINDEX 20439>>ASSIGN  20439>>ASSIGN  20460>>ASSIGN  20526>>ASSIGN  20526>>ASSIGN
     20540>>ASSIGN
BLK$ IN PROCEDURE GBLK
     20921**DCL     20920--PROC    20928<<ASSIGN
BREAKSET_FPT
     17698**DCL     19935<>CALL    21151<>CALL
BREAKSET_FPT.V
     17698**DCL     17698--DCLINIT
BREAK_FPT
     17682**DCL     18992<>CALL    20493<>CALL    21219<>CALL
BREAK_FPT.V
     17682**DCL     17682--DCLINIT
BYE_BYE
     18955**DCL     19090<>CALL    19098<>CALL    19106<>CALL    19114<>CALL    19121<>CALL    19151<>CALL
BYE_BYE.V
     18955**DCL     18955--DCLINIT
BYE_BYE.V.STEPCC#
     18956**DCL     18956--REDEF
B_CNTRL_HIGH
     17522**DCL     19004--ASSIGN
B_CNTRL_LOW
     17523**DCL     19001--ASSIGN
B_MUAIS
     17521**DCL     13403--DCLINIT
B_VERSION
     13130**DCL     18988--CALLBLT 18988--CALLBLT 18988--CALLBLT
CANT_OPEN IN PROCEDURE EXEC_DELETE
     20981**LABEL   20939--CALLALT
CAT$
     11633**DCL     19193>>ASSIGN  19194>>DOINDEX 19195>>IF      19197>>ASSIGN  19201>>ASSIGN  19259>>ASSIGN
     19260>>DOINDEX 19261>>IF      19263>>ASSIGN  19267>>ASSIGN  19385>>IF      19391>>ASSIGN  19395>>ASSIGN
     19586>>IF      19845>>ASSIGN  19958>>IF      19969>>IF      19971>>IF      19978>>IF      20025>>IF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:462  
     20025>>IF      20042>>IF      20066>>IF      20068>>IF      20093>>IF      20100>>IF      20100>>IF
     20156>>IF      20163>>IF      20163>>IF      20558>>ASSIGN  20560>>ASSIGN  20564>>ASSIGN  20850>>ASSIGN
     20856>>ASSIGN  20866>>ASSIGN  21019>>IF      21060>>DOINDEX 21062>>IF      21065>>IF      21067>>ASSIGN
     21078>>IF      21090>>IF      21091>>CALL
CAT$TBL.FLAGS.PRINT
     15965**DCL     19193<<ASSIGN  19259<<ASSIGN  21019>>IF
CAT$TBL.MAXPARAM
     15967**DCL     19194>>DOINDEX 19260>>DOINDEX 21060>>DOINDEX
CAT$TBL.PARAM$
     15968**DCL     19195>>IF      19197>>ASSIGN  19201>>ASSIGN  19261>>IF      19263>>ASSIGN  19267>>ASSIGN
     19385>>IF      19391>>ASSIGN  19395>>ASSIGN  19586>>IF      19845>>ASSIGN  19958>>IF      19969>>IF
     19971>>IF      19978>>IF      20025>>IF      20025>>IF      20042>>IF      20066>>IF      20068>>IF
     20093>>IF      20100>>IF      20100>>IF      20156>>IF      20163>>IF      20163>>IF      20558>>ASSIGN
     20560>>ASSIGN  20564>>ASSIGN  20850>>ASSIGN  20856>>ASSIGN  20866>>ASSIGN  21062>>IF      21065>>IF
     21067>>ASSIGN  21078>>IF      21090>>IF      21091>>CALL
CATAGORY_TBL
     15626**DCL     11633--DCLINIT
CLEANUP IN PROCEDURE EXEC_SET
     20482**LABEL   20331--GOTO    20343--GOTO
CLEANUP IN PROCEDURE EXEC_STORE
     21219**LABEL   21237--GOTO
CLOSERU IN PROCEDURE EXEC_SET
     20297**LABEL   20225--GOTO    20244--GOTO    20280--GOTO
CLOSE_CNTRL_FPT
     18364**DCL     20640<>CALL    20683<>CALL    21216<>CALL    21234<>CALL
CLOSE_CNTRL_FPT.SN_
     18364**DCL     18364--REDEF
CLOSE_CNTRL_FPT.UTL_
     18365**DCL     18365--REDEF
CLOSE_CNTRL_FPT.V
     18369**DCL     18364--DCLINIT
CLOSE_CNTRL_FPT.V.EXPIRE#
     18379**DCL     18379--REDEF
CLOSE_CNTRL_FPT.V.TYPE#
     18377**DCL     18377--REDEF
CLOSE_CNTRL_FPT.V.XTNSIZE#
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:463  
     18374**DCL     18374--REDEF   18376--REDEF
CLOSE_LO_FPT
     18409**DCL     19089<>CALL
CLOSE_LO_FPT.SN_
     18409**DCL     18409--REDEF
CLOSE_LO_FPT.UTL_
     18410**DCL     18410--REDEF
CLOSE_LO_FPT.V
     18414**DCL     18409--DCLINIT
CLOSE_LO_FPT.V.EXPIRE#
     18424**DCL     18424--REDEF
CLOSE_LO_FPT.V.TYPE#
     18422**DCL     18422--REDEF
CLOSE_LO_FPT.V.XTNSIZE#
     18419**DCL     18419--REDEF   18421--REDEF
CLOSE_RU
     18875**DCL     19746<>CALL    20298<>CALL
CLOSE_RU.SN_
     18875**DCL     18875--REDEF
CLOSE_RU.UTL_
     18876**DCL     18876--REDEF
CLOSE_RU.V
     18880**DCL     18875--DCLINIT
CLOSE_RU.V.EXPIRE#
     18890**DCL     18890--REDEF
CLOSE_RU.V.TYPE#
     18888**DCL     18888--REDEF
CLOSE_RU.V.XTNSIZE#
     18885**DCL     18885--REDEF   18887--REDEF
CLOSE_TP_FILE
     18269**DCL     19064<>CALL    19333<>CALL    19380<>CALL    20483<>CALL    20982<>CALL    20992<>CALL
CLOSE_TP_FILE.SN_
     18269**DCL     18269--REDEF
CLOSE_TP_FILE.UTL_
     18270**DCL     18270--REDEF
CLOSE_TP_FILE.V
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:464  
     18274**DCL     18269--DCLINIT
CLOSE_TP_FILE.V.EXPIRE#
     18284**DCL     18284--REDEF
CLOSE_TP_FILE.V.TYPE#
     18282**DCL     18282--REDEF
CLOSE_TP_FILE.V.XTNSIZE#
     18279**DCL     18279--REDEF   18281--REDEF
CMD_BUF
     11698**DCL     17578--DCLINIT 17579--DCLINIT 17619--DCLINIT 17620--DCLINIT 19132<<ASSIGN  19137>>IF
CMD_READ
     19069**LABEL   18994--REMEMBR 19040--CALLALT 19064--CALLALT 19073--CALLALT 19075--CALLALT 19077--CALLALT
     19079--CALLALT 19081--CALLALT 19085--CALLALT 19087--CALLALT 19094--GOTO
CNTRLCMD_FILE
     18486**DCL     17922--DCLINIT
CNTRL_ERR IN PROCEDURE EXEC_STORE
     21234**LABEL   21214--CALLALT 21215--CALLALT 21216--CALLALT
CNTRL_ERR IN PROCEDURE SET_VALUE
     20854**LABEL   20638--CALLALT 20639--CALLALT 20640--CALLALT 20681--CALLALT 20682--CALLALT 20683--CALLALT
CNTRL_FILE
     18456**DCL     17807--DCLINIT
CNTRL_KEY
     13082**DCL     18324--DCLINIT
CODE
     11732**DCL     20033<<ASSIGN  20034>>IF      20034>>IF      20034>>IF      20034>>IF      20034>>IF
     20216<<ASSIGN  20219>>IF      20220>>IF      20248>>DOCASE
CODE IN PROCEDURE EXEC_DISPLAY
     19416**DCL     19521<<DOINDEX 19522>>ASSIGN  19534<<DOINDEX 19535>>ASSIGN  19547<<DOINDEX 19548>>ASSIGN
     19560<<DOINDEX 19561>>ASSIGN
CONTROL_S_ERR
     19120**LABEL   18975--CALLALT
CURINSTANCES
     11681**DCL     19046<<ASSIGN  19056<<ASSIGN  19056>>ASSIGN  19206>>ASSIGN  19208>>DOINDEX 19272>>ASSIGN
     19274>>DOINDEX 19278>>ASSIGN  19280>>DOINDEX 19295>>ASSIGN  19314>>IF      19316>>IF      19342>>ASSIGN
     19361>>IF      19363>>IF      20337<<ASSIGN  20389<<ASSIGN  20389>>ASSIGN  20969<<ASSIGN  20969>>ASSIGN
CURRFLGS
     15688**DCL     14924--DCLINIT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:465  
CURUTS
     11816**DCL     17552--DCLINIT 20620>>IF
CUR_CLMN
     11701**DCL     21016<<ASSIGN  21114>>IF      21115>>CALL    21117<<ASSIGN  21121>>CALLBLT 21123<<ASSIGN
     21123>>ASSIGN  21126>>IF      21127>>CALL    21128<<ASSIGN
CUR_SIZE_OF_DATA
     11821**DCL     19043<<ASSIGN  19045>>ASSIGN  20313<<ASSIGN  20314>>ASSIGN
CUR_SIZE_OF_FILE
     11820**DCL     19044<<ASSIGN  19045>>ASSIGN
CUR_UTS
     17548**DCL     20619<>CALL
CUR_UTS.V
     17552**DCL     17548--DCLINIT
DASH
     13134**DCL     19069--CALL
DCB_WIDTH
     11850**DCL     19640<<ASSIGN  19641>>IF      19641<<ASSIGN  19720>>IF
DELINDX
     11828**DCL     20951<<ASSIGN  20959>>ASSIGN  20965>>ASSIGN  20966>>ASSIGN
DISPLAY_ERR IN PROCEDURE EXEC_DISPLAY
     19866**LABEL   19420--CALLALT 19421--CALLALT 19422--CALLALT 19423--CALLALT 19424--CALLALT 19441--CALLALT
     19442--CALLALT 19443--CALLALT 19444--CALLALT 19480--CALLALT 19485--CALLALT 19528--CALLALT 19541--CALLALT
     19554--CALLALT 19567--CALLALT 19833--CALLALT 19840--CALLALT 19842--CALLALT 19850--CALLALT 19853--CALLALT
     19857--CALLALT
DISP_CAT
     11719**DCL     19429<<ASSIGN  19483<<ASSIGN  19839>>IF      19841>>IF      19843>>IF      19852>>IF
DISP_TBL
     11711**DCL     19428<<ASSIGN  19528<>CALL    19541<>CALL    19554<>CALL    19567<>CALL    19833<>CALL
     19857<>CALL
DISP_TBL.INDX
     11712**DCL     19527<<ASSIGN  19540<<ASSIGN  19553<<ASSIGN  19566<<ASSIGN  19832<<ASSIGN  19856<<ASSIGN
DISP_TBL.PARM
     11713**DCL     19600<<ASSIGN  19600>>ASSIGN  19754<<ASSIGN  19772<<ASSIGN  19772>>ASSIGN  19789<<ASSIGN
     19789>>ASSIGN
DISP_TBL.PARM.CAT
     11714**DCL     19515<<ASSIGN  19519>>IF      19523<<ASSIGN  19532>>IF      19536<<ASSIGN  19545>>IF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:466  
     19549<<ASSIGN  19558>>IF      19562<<ASSIGN  19586>>IF      19773<<ASSIGN  19790<<ASSIGN  19823<<ASSIGN
DISP_TBL.PARM.INDEXHI
     11717**DCL     19607<<ASSIGN  19610<<ASSIGN  19612>>IF      19775<<ASSIGN  19792<<ASSIGN  19825<<ASSIGN
DISP_TBL.PARM.INDEXLO
     11716**DCL     19583<<ASSIGN  19606<<ASSIGN  19607>>ASSIGN  19612>>IF      19774<<ASSIGN  19791<<ASSIGN
     19824<<ASSIGN
DISP_TBL.PARM.PARM
     11715**DCL     19522<<ASSIGN  19535<<ASSIGN  19548<<ASSIGN  19561<<ASSIGN  19571<<ASSIGN  19572<<ASSIGN
     19586>>IF      19761<<ASSIGN  19765<<ASSIGN  19779<<ASSIGN  19796<<ASSIGN  19803<<ASSIGN  19807<<ASSIGN
     19811<<ASSIGN  19815<<ASSIGN  19819<<ASSIGN  19822>>IF
DISP_TBL.PARM.RESINDX
     11718**DCL     19437<<ASSIGN  19524<<ASSIGN  19537<<ASSIGN  19550<<ASSIGN  19563<<ASSIGN  19579<<ASSIGN
     19755<<ASSIGN  19780<<ASSIGN  19797<<ASSIGN
DS_RESULTS
     13147**DCL     17646--DCLINIT 19020<<ASSIGN
DS_RESULTS.PTR$
     13149**DCL     19022>>ASSIGN
DS_RESULTS.W2
     13148**DCL     13149--REDEF
DUMMY$
     11730**DCL     11731--REDEF
DUMP_BUF
     11853**DCL     19721<>CALL    19732<>CALL
DUMP_FMT
     11852**DCL     11853--DCLINIT
DUMP_LOCK
     11855**DCL     19731<>CALL
DUMP_LOCK_FMT
     11854**DCL     11855--DCLINIT
ECHO_FPT
     17618**DCL     19145<>CALL
ECHO_FPT.BUF_.BOUND
     17618**DCL     19144<<ASSIGN
ECHO_FPT.STATION_
     17620**DCL     17620--REDEF
ECHO_FPT.V
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:467  
     17621**DCL     17618--DCLINIT
ECHO_FPT.V.DVBYTE.VFC#
     17627**DCL     17627--REDEF
EL_SECLOGSIZE
     16473**DCL     14756--DCLINIT
ENDLOOP IN PROCEDURE EXEC_SET
     20490**LABEL   19941--GOTO    20022--GOTO
END_I_LOOP IN PROCEDURE EXEC_DELETE
     20967**LABEL   20957--GOTO
ERR# IN PROCEDURE VAL_ERROR
     20871**DCL     20869--PROC    20905<>CALL
ES_CLEARMEM
     16472**DCL     14699--DCLINIT
ES_LOGFILEDENY
     16470**DCL     14438--DCLINIT
ES_LOGFILEGRANT
     16470**DCL     14409--DCLINIT
ES_LOGMONSER
     16471**DCL     14642--DCLINIT
ES_LOGPRIVCHNG
     16471**DCL     14527--DCLINIT
ES_LOGSYSACC
     16472**DCL     14585--DCLINIT
ES_LOGSYSEXIT
     16472**DCL     14614--DCLINIT
ES_MONSERTBL
     16471**DCL     14671--DCLINIT
ES_PRIVCHNGMASK
     16471**DCL     14556--DCLINIT
ES_PRIVMASK
     16470**DCL     14470--DCLINIT
ES_PROTECTSECLOG
     16472**DCL     14728--DCLINIT
ES_STEPPRIVMASK
     16470**DCL     14499--DCLINIT
EXCEPTION_TBL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:468  
     15322**DCL     11637--DCLINIT 15679--DCLINIT
EXEC_ADD
     19156**PROC    19073--CALL
EXEC_CLEAR IN PROCEDURE EXEC_STORE
     21221**ENTRY   19087--CALL
EXEC_DELETE
     20935**PROC    19083--CALL
EXEC_DISPLAY
     19414**PROC    19079--CALL
EXEC_DROP IN PROCEDURE EXEC_ADD
     19161**ENTRY   19075--CALL
EXEC_LIST
     20998**PROC    19077--CALL
EXEC_SET
     19933**PROC    19081--CALL
EXEC_STORE
     21140**PROC    19085--CALL
EXTEND_TP_FILE
     18301**DCL     20925<>CALL
EXTEND_TP_FILE.V
     18301**DCL     18301--DCLINIT
F$DCB.ACTPOS
     15815**DCL     15815--REDEF
F$DCB.ARS#
     15789**DCL     15789--REDEF   19135>>ASSIGN
F$DCB.ASN#
     15804**DCL     19139>>IF      21001>>IF
F$DCB.ATTR
     15808**DCL     15809--REDEF
F$DCB.BORROW
     15823**DCL     15823--REDEF   15823--REDEF   15823--REDEF
F$DCB.DCBNAME.L
     15837**DCL     15837--IMP-SIZ
F$DCB.DDEV.XEQ#
     15796**DCL     19139>>IF
F$DCB.EOMCHAR#
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:469  
     15793**DCL     15793--REDEF
F$DCB.FCD#
     15802**DCL     19332>>IF      19379>>IF      19745>>IF      20297>>IF      20482>>IF      20981>>IF
     20991>>IF
F$DCB.FLDID
     15818**DCL     15818--REDEF
F$DCB.FORM$
     15812**DCL     15812--REDEF
F$DCB.FSECT
     15828**DCL     15828--REDEF
F$DCB.FSN#
     15805**DCL     15805--REDEF   15805--REDEF   15806--REDEF
F$DCB.HEADER$
     15811**DCL     15811--REDEF
F$DCB.IXTNSIZE#
     15809**DCL     15809--REDEF
F$DCB.LASTSTA$
     15798**DCL     15798--REDEF
F$DCB.LVL
     15824**DCL     15824--REDEF
F$DCB.NAME#.C
     15799**DCL     15799--REDEF
F$DCB.NOEOF
     15821**DCL     15821--REDEF
F$DCB.NRECS#
     15810**DCL     15810--REDEF   19044>>ASSIGN
F$DCB.NRECX
     15829**DCL     15829--REDEF
F$DCB.OHDR
     15821**DCL     15821--REDEF
F$DCB.ORG#
     15804**DCL     15804--REDEF
F$DCB.PRECNO
     15827**DCL     15827--REDEF
F$DCB.RCSZ
     15833**DCL     15833--REDEF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:470  
F$DCB.RES#
     15800**DCL     15800--REDEF
F$DCB.SETX
     15812**DCL     15812--REDEF
F$DCB.TAB$
     15812**DCL     15812--REDEF
F$DCB.TDA
     15826**DCL     15827--REDEF
F$DCB.WIDTH#
     15796**DCL     19640>>ASSIGN  21001>>ASSIGN
F$DCB.WSN#
     15800**DCL     15800--REDEF
FDS
     12722**DCL     19639<>CALL    19721<>CALL    19731<>CALL    19732<>CALL
FID_ACCT
     18708**DCL     18522--DCLINIT 18612--DCLINIT
FID_NAME
     18695**DCL     18522--DCLINIT 18608--DCLINIT
FID_PASS
     18721**DCL     18523--DCLINIT 18609--DCLINIT
FID_RESULTS
     18662**DCL     18525--DCLINIT
FID_SN
     18747**DCL     18523--DCLINIT 18607--DCLINIT
FID_WSN
     18734**DCL     18523--DCLINIT 18613--DCLINIT
FIRST_BIT
     11665**DCL     20272<<CALLBLT 20273>>ASSIGN  20275<<CALLBLT 20278>>IF      20282>>DOINDEX
FMC_LIMITS.EXPIRE
     16290**DCL     13960--DCLINIT 13988--DCLINIT 14016--DCLINIT 14044--DCLINIT 14072--DCLINIT 14100--DCLINIT
     14128--DCLINIT 14156--DCLINIT 14184--DCLINIT 14212--DCLINIT
FMC_LIMITS.UPLIMIT
     16290**DCL     14240--DCLINIT 14268--DCLINIT 14296--DCLINIT
FMS_PRIV
     18906**DCL     18967<>CALL    20320<>CALL    20327<>CALL    20485<>CALL
FMS_PRIV.V
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:471  
     18906**DCL     18906--DCLINIT
FOUND
     11819**DCL     19302<<ASSIGN  19307<<ASSIGN  19321>>IF      19349<<ASSIGN  19354<<ASSIGN  19368>>IF
     20400<<ASSIGN  20407<<ASSIGN  20413>>IF      20440<<ASSIGN  20447<<ASSIGN  20457>>IF      20946<<ASSIGN
     20950<<ASSIGN  20955>>IF
FO_JOBSTATSAGE
     16461**DCL     13820--DCLINIT
FO_SYMBINFO
     16456**DCL     13792--DCLINIT
FO_SYMBINFO.HOLDEXPIRE#
     16458**DCL     13876--DCLINIT
FO_SYMBINFO.WATCH#
     16458**DCL     13848--DCLINIT
FPT_MONINFO
     18921**DCL     19026<>CALL
FPT_TRAP
     18838**DCL     18993<>CALL
FPT_TRAP.V
     18838**DCL     18838--DCLINIT
FPT_WAIT
     17731**DCL     21156<>CALL
FPT_WAIT.V
     17732**DCL     17731--DCLINIT
FR_MEMM
     16299**DCL     20647--ASSIGN
FR_PRC$
     16310**DCL     14928--DCLINIT
FR_PRM$
     16310**DCL     14900--DCLINIT 14956--DCLINIT
FR_SUC$
     16310**DCL     14929--DCLINIT
FR_SUM$
     16310**DCL     14901--DCLINIT 14957--DCLINIT
FR_SUMX
     16311**DCL     19008--ASSIGN
FR_SUNM
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:472  
     16311**DCL     19012--ASSIGN
FT_PROT
     16402**DCL     13681--DCLINIT
GBLK
     20920**PROC    20374--CALL
GDS_ERR
     19097**LABEL   19021--CALLALT
GDS_FPT
     17646**DCL     19021<>CALL
GDS_FPT.V
     17646**DCL     17646--DCLINIT
GET_RES
     19870**PROC    19387--CALL    19577--CALL    20114--CALL    20178--CALL
HDR$
     11673**DCL     19041<<ASSIGN
HEADKEY
     13076**DCL     18770--DCLINIT 18771--DCLINIT 18812--DCLINIT
HEAD_FID
     18521**DCL     19624<>CALL    20210<>CALL
HEAD_FID.TEXTFID_
     18521**DCL     19623<<ASSIGN  19639<>CALL    20209<<ASSIGN
HEAD_FID.V
     18525**DCL     18521--DCLINIT
I
     11677**DCL     18987<<CALLBLT 19014<<DOINDEX 19015>>ASSIGN  19015>>ASSIGN  19048<<DOINDEX 19049>>ASSIGN
     19051>>DOWHILE 19054>>ASSIGN  19057>>ASSIGN  19058>>ASSIGN  19059>>ASSIGN  19060>>IF      19061>>ASSIGN
     19172<<DOINDEX 19173>>ASSIGN  19433<<ASSIGN  19434<<ASSIGN  19435<<DOINDEX 19435>>DOINDEX 19436>>ASSIGN
     19937<<DOINDEX 19938>>ASSIGN  20941<<DOINDEX 20942>>ASSIGN  20942>>ASSIGN  20943>>ASSIGN  21001<<ASSIGN
     21002<<ASSIGN  21004>>ASSIGN  21034<<ASSIGN  21037>>IF      21038>>CALLBLT 21039<<ASSIGN  21039>>ASSIGN
     21041>>CALLBLT 21043<<ASSIGN  21043>>ASSIGN  21046>>CALLBLT 21047<<ASSIGN  21047>>ASSIGN  21048<>CALL
     21163<<DOINDEX 21164>>ASSIGN  21165>>ASSIGN  21166>>ASSIGN  21169>>ASSIGN  21223<<DOINDEX 21224>>ASSIGN
     21225>>ASSIGN
INBUF IN PROCEDURE SET_TIMEZONE
     20520**DCL     20528<<ASSIGN  20530<<CALLBLT 20533--ASSIGN
INDEX$
     11671**DCL     19597<<ASSIGN  19598>>DOINDEX 19604>>ASSIGN  20192<<ASSIGN  20193>>ASSIGN  20195>>IF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:473  
     20198>>ASSIGN
INDEX_FLGS.DOMAINE
     11707**DCL     19187<<ASSIGN  19254<<ASSIGN  21053>>IF
INDEX_FLGS.MODE
     11705**DCL     19179<<ASSIGN  19215<<ASSIGN  21026>>IF
INDEX_FLGS.PART#
     11706**DCL     19183<<ASSIGN  19249<<ASSIGN  21032>>IF      21036>>IF
INDX IN PROCEDURE GET_RES
     19912**DCL     19914<<DOINDEX 19915>>IF      19916>>ASSIGN  19921<<DOINDEX 19922>>IF      19923>>ASSIGN
INDX IN PROCEDURE VAL_ERROR
     20872**DCL     20869--PROC    20889>>CALLBLT 20889>>CALLBLT 20892>>ASSIGN
INSTANCE$
     11823**DCL     12826--IMP-PTR 19047<<ASSIGN  19049>>ASSIGN  19054>>ASSIGN  19055>>IF      19058>>ASSIGN
     19059>>ASSIGN  19061>>ASSIGN  19062<<ASSIGN  19062>>ASSIGN  20350<<ASSIGN  20352>>IF      20352>>IF
     20361<<ASSIGN  20361>>ASSIGN  20366<<ASSIGN  20369>>IF      20372<<ASSIGN  20372>>ASSIGN  20374<>CALL
     20377>>ASSIGN  20378>>ASSIGN  20379>>ASSIGN  20380>>ASSIGN  20401<<ASSIGN  20403>>IF      20403>>IF
     20408>>ASSIGN  20411<<ASSIGN  20411>>ASSIGN  20424<<ASSIGN  20426>>IF      20427>>ASSIGN  20430<<ASSIGN
     20430>>ASSIGN  20441<<ASSIGN  20443>>IF      20443>>IF      20448>>ASSIGN  20449>>ASSIGN  20450>>ASSIGN
     20455<<ASSIGN  20455>>ASSIGN  20468<<ASSIGN  20470>>IF      20471>>ASSIGN  20472>>ASSIGN  20473>>ASSIGN
     20478<<ASSIGN  20478>>ASSIGN  20945<<ASSIGN  20948>>IF      20948>>IF      20953<<ASSIGN  20953>>ASSIGN
     20959<<ASSIGN  20960>>IF      20964>>ASSIGN  20967>>ASSIGN
INSTANCE_NAME
     11812**DCL     19301<<ASSIGN  19304>>IF      19323>>DOWHILE 19327>>ASSIGN  19348<<ASSIGN  19351>>IF
     19370>>DOWHILE 19374>>ASSIGN  20349<<ASSIGN  20352>>IF      20357>>ASSIGN  20378>>ASSIGN  20382>>ASSIGN
     20399<<ASSIGN  20403>>IF      20418>>ASSIGN  20439<<ASSIGN  20443>>IF      20462>>ASSIGN  20942<<ASSIGN
     20944>>ASSIGN  20948>>IF
J
     11678**DCL     19178<<DOINDEX 19179>>ASSIGN  19182<<DOINDEX 19183>>ASSIGN  19186<<DOINDEX 19187>>ASSIGN
     19190<<DOINDEX 19191>>IF      19192<<ASSIGN  19192>>ASSIGN  19193>>ASSIGN  19194>>DOINDEX 19195>>IF
     19197>>ASSIGN  19201>>ASSIGN  19204>>IF      19220<<DOINDEX 19221>>ASSIGN  19258<<ASSIGN  19259>>ASSIGN
     19260>>DOINDEX 19261>>IF      19263>>ASSIGN  19267>>ASSIGN  19270>>IF      19291<<DOINDEX 19292>>ASSIGN
     19300<<DOINDEX 19301>>ASSIGN  19301>>ASSIGN  19338<<DOINDEX 19339>>ASSIGN  19347<<DOINDEX 19348>>ASSIGN
     19348>>ASSIGN  19430<<ASSIGN  19437>>ASSIGN  19495<<DOINDEX 19496>>ASSIGN  19496>>ASSIGN  19496>>ASSIGN
     19506<<DOINDEX 19507>>ASSIGN  19507>>ASSIGN  19507>>ASSIGN  19515>>ASSIGN  19519>>IF      19522>>ASSIGN
     19523>>ASSIGN  19524>>ASSIGN  19525<<ASSIGN  19525>>ASSIGN  19527>>ASSIGN  19529<<ASSIGN  19532>>IF
     19535>>ASSIGN  19536>>ASSIGN  19537>>ASSIGN  19538<<ASSIGN  19538>>ASSIGN  19540>>ASSIGN  19542<<ASSIGN
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:474  
     19545>>IF      19548>>ASSIGN  19549>>ASSIGN  19550>>ASSIGN  19551<<ASSIGN  19551>>ASSIGN  19553>>ASSIGN
     19555<<ASSIGN  19558>>IF      19561>>ASSIGN  19562>>ASSIGN  19563>>ASSIGN  19564<<ASSIGN  19564>>ASSIGN
     19566>>ASSIGN  19568<<ASSIGN  19571>>ASSIGN  19572>>ASSIGN  19579>>ASSIGN  19583>>ASSIGN  19586>>IF
     19586>>IF      19600>>ASSIGN  19600>>ASSIGN  19601<<ASSIGN  19601>>ASSIGN  19606>>ASSIGN  19607>>ASSIGN
     19607>>ASSIGN  19610>>ASSIGN  19612>>IF      19612>>IF      19620<<ASSIGN  19620>>ASSIGN  19628<<DOINDEX
     19629>>DOCASE  19636>>ASSIGN  19644<<DOINDEX 19647>>IF      19648>>ASSIGN  19649>>CALLBLT 19650>>DOCASE
     19725>>IF      19729>>IF      19855>>IF      19856>>ASSIGN  20214<<DOINDEX 20215>>ASSIGN  20348<<DOINDEX
     20349>>ASSIGN  20349>>ASSIGN  20356>>ASSIGN  20383>>ASSIGN  20398<<DOINDEX 20399>>ASSIGN  20399>>ASSIGN
     20416>>ASSIGN  20425<<DOINDEX 20428>>ASSIGN  20438<<DOINDEX 20439>>ASSIGN  20439>>ASSIGN  20460>>ASSIGN
     20469<<DOINDEX 20474>>ASSIGN  20475>>ASSIGN  20476>>ASSIGN  20570<<DOINDEX 20574<>CALL    20581>>IF
     20583<>CALL    20583>>CALL    20589<>CALL    20598<>CALL    20605>>IF      20607<>CALL    20607>>CALL
     20613<>CALL    20625>>ASSIGN  20627>>ASSIGN  20645<<DOINDEX 20649>>IF      20650<>CALL    20654>>ASSIGN
     20660>>ASSIGN  20662<>CALL    20672>>ASSIGN  20674<>CALL    20687<<DOINDEX 20688>>ASSIGN  20689>>ASSIGN
     20690>>ASSIGN  20697<>CALL    20704<>CALL    20714<>CALL    20721<>CALL    20727<>CALL    20737<>CALL
     20744<>CALL    20754<>CALL    20761<>CALL    20766<>CALL    20774<>CALL    20784<>CALL    20793<>CALL
     20797<>CALL    20807<>CALL    20812<>CALL    20819<>CALL    20823<>CALL    20830<>CALL    20834<>CALL
     20841<>CALL    20947<<DOINDEX 20951>>ASSIGN  21018<<DOINDEX 21019>>IF      21020>>CALL    21025<<DOINDEX
     21026>>IF      21027>>CALL    21035<<DOINDEX 21036>>IF      21041>>CALLBLT 21041>>CALLBLT 21043>>ASSIGN
     21052<<DOINDEX 21053>>IF      21054>>CALL    21059<<DOINDEX 21060>>DOINDEX 21062>>IF      21065>>IF
     21067>>ASSIGN  21078>>IF      21078>>IF      21090>>IF      21091>>CALL    21179<<DOINDEX 21180>>IF
     21181>>ASSIGN  21181>>ASSIGN  21184>>IF      21185>>ASSIGN  21185>>ASSIGN
JM$PT
     15742**DCL     19756--ASSIGN  20688--ASSIGN  20689--ASSIGN  20690--ASSIGN  21164--ASSIGN  21165--ASSIGN
     21166--ASSIGN  21168>>IF      21224--ASSIGN  21225--ASSIGN  21227<<ASSIGN  21228<<ASSIGN
JM$PT.FLG.LOCK
     15767**DCL     19802>>IF      20801<<ASSIGN  20802<<ASSIGN  20803<<ASSIGN  21189>>IF      21190<<ASSIGN
     21190>>ASSIGN
JM$PT.MAX
     15753**DCL     19818>>IF      20844<<ASSIGN  20845<<ASSIGN  21204>>IF      21205<<ASSIGN  21205>>ASSIGN
JM$PT.MAX1ACCT
     15770**DCL     19814>>IF      20837<<ASSIGN  20838<<ASSIGN  21200>>IF      21201<<ASSIGN  21201>>ASSIGN
JM$PT.QUAN
     15751**DCL     19806>>IF      20815<<ASSIGN  20816<<ASSIGN  21192>>IF      21193<<ASSIGN  21193>>ASSIGN
JM$PT.RMAX
     15776**DCL     19787>>IF      20734>>IF      20735>>IF      20736>>ASSIGN  20742>>IF      20743>>ASSIGN
     20789<<ASSIGN  20790<<ASSIGN  21184>>IF      21185<<ASSIGN  21185>>ASSIGN
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:475  
JM$PT.RMIN
     15779**DCL     19770>>IF      20747<<ASSIGN  20748<<ASSIGN  20751>>IF      20752>>IF      20753>>ASSIGN
     20759>>IF      20760>>ASSIGN  21180>>IF      21181<<ASSIGN  21181>>ASSIGN
JM$PT.TL
     15747**DCL     19760>>IF      20708<<ASSIGN  20709<<ASSIGN  20712>>IF      20713>>IF      20714>>CALL
     20720>>IF      20721>>CALL    21171>>IF      21172<<ASSIGN  21172>>ASSIGN
JM$PT.TU
     15749**DCL     19764>>IF      20695>>IF      20696>>IF      20697>>CALL    20703>>IF      20704>>CALL
     20730<<ASSIGN  20731<<ASSIGN  21175>>IF      21176<<ASSIGN  21176>>ASSIGN
JM$PT.XPRIO
     15762**DCL     19810>>IF      20826<<ASSIGN  20827<<ASSIGN  21196>>IF      21197<<ASSIGN  21197>>ASSIGN
JMN$LOCK
     16006**DCL-ENT 21158--CALL
JMN$UNLOCK
     16007**DCL-ENT 21212--CALL
JM_CHNG
     16261**DCL     20631--ASSIGN  21160--ASSIGN
JM_LOCK
     16261**DCL     21153--ASSIGN  21210--ASSIGN
JM_MAX1ACCT
     16483**DCL     13737--DCLINIT
JM_NPART
     16483**DCL     13653--DCLINIT
JM_PI
     16483**DCL     13598--DCLINIT
JM_PT
     16483**DCL     11652--DCLINIT 15014--DCLINIT 15041--DCLINIT 15068--DCLINIT 15095--DCLINIT 15122--DCLINIT
     15150--DCLINIT 15178--DCLINIT 15205--DCLINIT 15232--DCLINIT 15259--DCLINIT 15286--DCLINIT 15313--DCLINIT
     18996--ASSIGN
JS_PRDPRM
     16435**DCL     15398--DCLINIT
JS_REMCPO
     16435**DCL     15506--DCLINIT
JS_REMDO
     16436**DCL     15452--DCLINIT
JS_REMLO
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:476  
     16435**DCL     15479--DCLINIT
JS_SHARE_ALL
     16436**DCL     13765--DCLINIT
JS_TIME
     16435**DCL     15371--DCLINIT
JS_TMDPRM
     16435**DCL     15425--DCLINIT
JZ_RETIM
     17372**DCL     13625--DCLINIT
K
     11679**DCL     19050<<ASSIGN  19051>>DOWHILE 19051>>DOWHILE 19052<<ASSIGN  19052>>ASSIGN  19057>>ASSIGN
     19194<<DOINDEX 19195>>IF      19197>>ASSIGN  19201>>ASSIGN  19208<<DOINDEX 19209>>ASSIGN  19248<<DOINDEX
     19249>>ASSIGN  19260<<DOINDEX 19261>>IF      19263>>ASSIGN  19267>>ASSIGN  19274<<DOINDEX 19275>>ASSIGN
     19280<<DOINDEX 19281>>ASSIGN  19303<<DOINDEX 19304>>IF      19304>>IF      19306>>ASSIGN  19322<<ASSIGN
     19323>>DOWHILE 19323>>DOWHILE 19324<<ASSIGN  19324>>ASSIGN  19326>>ASSIGN  19350<<DOINDEX 19351>>IF
     19351>>IF      19353>>ASSIGN  19369<<ASSIGN  19370>>DOWHILE 19370>>DOWHILE 19371<<ASSIGN  19371>>ASSIGN
     19373>>ASSIGN  19451<<DOINDEX 19452>>ASSIGN  19598<<DOINDEX 19599>>IF      19604>>ASSIGN  19713<<ASSIGN
     19714>>DOWHILE 19714>>DOWHILE 19715<<ASSIGN  19715>>ASSIGN  19717>>CALLBLT 19717>>CALLBLT 19718>>ASSIGN
     19752<<DOINDEX 19757>>DOCASE  19847<<DOINDEX 19848>>ASSIGN  19983<<DOINDEX 19984>>ASSIGN  19987<<DOINDEX
     19988>>ASSIGN  20001<<DOINDEX 20002>>ASSIGN  20058<<DOINDEX 20059>>ASSIGN  20070<<DOINDEX 20071>>ASSIGN
     20072>>ASSIGN  20073>>ASSIGN  20131<<DOINDEX 20132>>ASSIGN  20191<<DOINDEX 20192>>ASSIGN  20221<<DOINDEX
     20222>>IF      20222>>IF      20269<<DOINDEX 20270>>DOCASE  20272>>CALLBLT 20272>>CALLBLT 20275>>CALLBLT
     20275>>CALLBLT 20276>>CALLBLT 20276>>CALLBLT 20351<<DOINDEX 20368<<DOINDEX 20402<<DOINDEX 20409>>ASSIGN
     20442<<DOINDEX 20451>>ASSIGN  20452>>ASSIGN  20453>>ASSIGN  20898<<ASSIGN  20899>>DOWHILE 20899>>DOWHILE
     20900<<ASSIGN  20900>>ASSIGN  20902>>ASSIGN  20903>>ASSIGN  20903>>ASSIGN  21060<<DOINDEX 21062>>IF
     21065>>IF      21067>>ASSIGN  21078>>IF      21078>>IF      21090>>IF      21091>>CALL
L
     11680**DCL     19475<<DOINDEX 19476>>ASSIGN  20003<<DOINDEX 20004>>IF      20005>>ASSIGN  20282<<DOINDEX
     20283>>ASSIGN  21080<<DOINDEX 21081>>IF      21082>>ASSIGN  21083>>CALLBLT 21083>>CALLBLT 21083>>CALLBLT
L1 IN PROCEDURE EXEC_SET
     20391**LABEL   20359--GOTO
LAST_BIT
     11666**DCL     20273<<ASSIGN  20276<<CALLBLT 20278>>IF      20282>>DOINDEX
LIMIT IN PROCEDURE VAL_ERROR
     20873**DCL     20869--PROC    20896>>CALLBLT
LIST_ERR IN PROCEDURE EXEC_LIST
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:477  
     21102**LABEL   21020--CALLALT 21023--CALLALT 21027--CALLALT 21030--CALLALT 21048--CALLALT 21054--CALLALT
     21057--CALLALT 21073--CALLALT 21086--CALLALT 21091--CALLALT
LIST_PRINT IN PROCEDURE EXEC_LIST
     21106**PROC    21020--CALL    21023--CALL    21027--CALL    21030--CALL    21054--CALL    21057--CALL
     21073--CALL    21086--CALL    21091--CALL    21097--CALL
LIT$
     11810**DCL     19988<<ASSIGN  19989>>ASSIGN  20002<<ASSIGN  20004>>IF
M$CLOSE
      3492**DCL-ENT 19064--CALL    19089--CALL    19333--CALL    19380--CALL    19746--CALL    20298--CALL
     20483--CALL    20640--CALL    20683--CALL    20982--CALL    20992--CALL    21216--CALL    21234--CALL
M$EXIT
      3504**DCL-ENT 19090--CALL    19098--CALL    19106--CALL    19114--CALL    19121--CALL    19151--CALL
M$EXTEND
      3496**DCL-ENT 20925--CALL
M$FID
      3555**DCL-ENT 19624--CALL    20210--CALL
M$GDS
      3527**DCL-ENT 19021--CALL
M$HEAD
     16023**DCL     19745--IF      20297--IF
M$INT
      3547**DCL-ENT 18992--CALL    19935--CALL    20493--CALL    21151--CALL    21219--CALL
M$LO
     16019**DCL     19640--ASSIGN  21000--ASSIGN
M$MONINFO
      3560**DCL-ENT 19026--CALL
M$OPEN
      3492**DCL-ENT 18975--CALL    19040--CALL    19626--CALL    20212--CALL    20311--CALL    20324--CALL
     20638--CALL    20681--CALL    20939--CALL    21214--CALL
M$READ
      3493**DCL-ENT 19133--CALL    19627--CALL    20213--CALL
M$RPRIV
      3551**DCL-ENT 18967--CALL    20327--CALL    20485--CALL
M$SAD
      3531**DCL-ENT 18999--CALL
M$SI
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:478  
     16018**DCL     18970--ASSIGN
M$SI$
     11672**DCL     18970<<ASSIGN  19135>>ASSIGN  19139>>IF
M$SPRIV
      3551**DCL-ENT 18977--CALL    18981--CALL    20320--CALL
M$TIME
      3559**DCL-ENT 20619--CALL
M$TP
     16022**DCL     19044--ASSIGN  19332--IF      19379--IF      20482--IF      20981--IF      20991--IF
M$TRAP
      3546**DCL-ENT 18993--CALL
M$UC
      3516**DCL     19139--IF
M$WAIT
      3550**DCL-ENT 21156--CALL
M$WRITE
      3493**DCL-ENT 19145--CALL    20289--CALL    20639--CALL    20682--CALL    21215--CALL
MASK IN PROCEDURE EXEC_SET
     20003**LABEL   20006--EXIT
MASKVALHI
     11746**DCL     19997<<ASSIGN  20003>>DOINDEX
MASK_VALUE
     11738**DCL     19996<<ASSIGN  20005<<ASSIGN  20005>>ASSIGN  20012<<ASSIGN  20012>>ASSIGN  20071<<ASSIGN
MAXRFLGS
     15684**DCL     14896--DCLINIT
MAXTPU_BUF
     11830**DCL     21083<<CALLBLT 21085>>ASSIGN
MAXTPU_TBL
     15703**DCL     15618--DCLINIT 19039<<ASSIGN
MAXTPU_TBL.COUNT
     15706**DCL     19057<<ASSIGN  20383<<ASSIGN  21082>>ASSIGN  21083>>CALLBLT 21083>>CALLBLT
MAXTPU_TBL.FLAGS.DELETED
     15709**DCL     19054<<ASSIGN  19304>>IF      19351>>IF      20381<<ASSIGN  20965<<ASSIGN
MAXTPU_TBL.FLAGS.PRINT
     15708**DCL     19209<<ASSIGN  19275<<ASSIGN  19292<<ASSIGN  19306<<ASSIGN  20386<<ASSIGN  21081>>IF
MAXTPU_TBL.MAXTPU
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:479  
     15705**DCL     19058<<ASSIGN  20385<<ASSIGN  20409<<ASSIGN  20428<<ASSIGN
MAXTPU_TBL.NAME
     15704**DCL     19049<<ASSIGN  19051>>DOWHILE 19304>>IF      19351>>IF      20382<<ASSIGN  21083>>CALLBLT
MAX_CLMN
     11700**DCL     21004<<ASSIGN  21006>>IF      21114>>IF
MM_AUTO_PRIO
     17381**DCL     14324--DCLINIT
MM_CACHE_PRIO
     17381**DCL     14352--DCLINIT
MM_CG_PRIO
     17381**DCL     14380--DCLINIT
MM_FREETHRESH
     17381**DCL     13904--DCLINIT
MM_NOUSTHRESH
     17381**DCL     13932--DCLINIT
MONPART$
     11652**DCL     11653--REDEF   18996<<ASSIGN  20690>>ASSIGN  21164>>ASSIGN
MONPARTPTR.SEGID
     11655**DCL     18997<<ASSIGN
MONPTR.ADDRESS
     11649**DCL     20658<<ASSIGN  20660<<ASSIGN  20670<<ASSIGN  20672<<ASSIGN  20771<<ASSIGN  20772<<ASSIGN
     20781<<ASSIGN  20782<<ASSIGN
MONPTR.SEGID
     11650**DCL     19002<<ASSIGN  19005<<ASSIGN  19009<<ASSIGN  19013<<ASSIGN  19846<<ASSIGN  20561<<ASSIGN
     20648<<ASSIGN  21154<<ASSIGN  21211<<ASSIGN
MONPTR$
     11647**DCL     11648--REDEF   19001<<ASSIGN  19003>>ASSIGN  19004<<ASSIGN  19006>>ASSIGN  19008<<ASSIGN
     19010>>ASSIGN  19012<<ASSIGN  19015>>ASSIGN  19845<<ASSIGN  19847>>DOINDEX 20560<<ASSIGN  20625>>ASSIGN
     20627>>ASSIGN  20647<<ASSIGN  20649>>IF      20650>>CALL    20654>>ASSIGN  20659>>ASSIGN  20660>>ASSIGN
     20666>>ASSIGN  20671>>ASSIGN  20672>>ASSIGN  20678>>ASSIGN  20690<<ASSIGN  20703>>IF      20704>>CALL
     20720>>IF      20721>>CALL    20742>>IF      20743>>ASSIGN  20759>>IF      20760>>ASSIGN  20772>>ASSIGN
     20773>>IF      20774>>CALL    20782>>ASSIGN  20783>>IF      20784>>CALL    21153<<ASSIGN  21158>>CALL
     21164<<ASSIGN  21172>>ASSIGN  21176>>ASSIGN  21181>>ASSIGN  21185>>ASSIGN  21190>>ASSIGN  21193>>ASSIGN
     21197>>ASSIGN  21201>>ASSIGN  21205>>ASSIGN  21210<<ASSIGN  21212>>CALL
MONSER_VALUE
     11739**DCL     19980<<ASSIGN  19984<<ASSIGN  19990--ASSIGN  20071>>ASSIGN
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:480  
N$ IN PROCEDURE SET_TIMEZONE
     20521**DCL     20526<<ASSIGN  20527>>IF      20528>>ASSIGN  20528>>ASSIGN  20530>>CALLBLT 20530>>CALLBLT
     20530>>CALLBLT 20530>>CALLBLT 20535<<ASSIGN  20537<>CALL    20540<<ASSIGN  20541>>IF      20542>>ASSIGN
     20542>>ASSIGN
NEXT
     18967**LABEL   18967--CALLALT
NEXT1 IN PROCEDURE EXEC_SET
     20320**LABEL   20320--CALLALT
NEXT2 IN PROCEDURE EXEC_SET
     20327**LABEL   20327--CALLALT
NEXT3 IN PROCEDURE EXEC_SET
     20485**LABEL   20485--CALLALT
NI_IOLEAPERS
     16290**DCL     14784--DCLINIT
NO_ACCESS
     19113**LABEL   18983--GOTO    18999--CALLALT
NO_MEM IN PROCEDURE EXEC_SET
     20502**LABEL   20374--CALLALT
NO_MEM IN PROCEDURE GBLK
     20932**LABEL   20925--CALLALT
NO_TP_FILE IN PROCEDURE EXEC_SET
     20316**LABEL   20311--CALLALT
NUM_PSURES
     11657**DCL     19010<<ASSIGN  19014>>IF      19014>>DOINDEX 19196>>DOINDEX 19262>>DOINDEX 19768>>DOINDEX
     19785>>DOINDEX 19921>>DOINDEX 21063>>DOINDEX 21179>>DOINDEX
O$BLK.CODE
     15891**DCL     19071>>DOCASE  19169<<ASSIGN  19175>>DOCASE  19215>>ASSIGN  19223>>IF      19229>>ASSIGN
     19234>>ASSIGN  19254>>ASSIGN  19258>>ASSIGN  19286>>ASSIGN  19288>>IF      19335>>IF      19383>>ASSIGN
     19418>>IF      19432>>IF      19438>>DOCASE  19454>>IF      19460>>ASSIGN  19465>>ASSIGN  19483>>ASSIGN
     19484>>IF      19487>>DOCASE  19515>>ASSIGN  19519>>IF      19532>>IF      19545>>IF      19558>>IF
     19571>>ASSIGN  19572>>ASSIGN  19574>>IF      19574>>IF      19606>>ASSIGN  19610>>ASSIGN  19629>>DOCASE
     19636>>ASSIGN  19939>>IF      19948>>DOCASE  19952>>ASSIGN  19956>>ASSIGN  19971>>IF      20010>>IF
     20010>>IF      20016>>IF      20024>>IF      20025>>IF      20033>>ASSIGN  20044>>IF      20059>>ASSIGN
     20091>>ASSIGN  20099>>IF      20100>>IF      20108>>IF      20123>>IF      20132>>ASSIGN  20154>>ASSIGN
     20162>>IF      20163>>IF      20171>>IF      20183>>IF      20193>>ASSIGN  20198>>ASSIGN  20216>>ASSIGN
     20268>>ASSIGN  20270>>DOCASE  20346>>DOCASE  20937>>DOSELCT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:481  
O$BLK.NSUBLKS
     15895**DCL     19166>>IF      19167<<ASSIGN  19172>>DOINDEX 19220>>DOINDEX 19231>>IF      19289>>IF
     19300>>DOINDEX 19336>>IF      19347>>DOINDEX 19418>>IF      19435>>DOINDEX 19451>>DOINDEX 19462>>IF
     19491>>IF      19495>>DOINDEX 19502>>IF      19506>>DOINDEX 19574>>IF      19582>>IF      19598>>DOINDEX
     19609>>IF      19628>>DOINDEX 19937>>DOINDEX 19971>>IF      19977>>ASSIGN  19987>>DOINDEX 20001>>DOINDEX
     20016>>IF      20024>>IF      20025>>IF      20032>>ASSIGN  20033>>ASSIGN  20039>>CALLBLT 20039>>CALLBLT
     20044>>IF      20058>>DOINDEX 20078>>IF      20099>>IF      20100>>IF      20107>>ASSIGN  20108>>IF
     20111>>CALLBLT 20111>>CALLBLT 20123>>IF      20131>>DOINDEX 20140>>IF      20162>>IF      20163>>IF
     20170>>ASSIGN  20171>>IF      20174>>CALLBLT 20174>>CALLBLT 20177>>IF      20183>>IF      20191>>DOINDEX
     20195>>IF      20214>>DOINDEX 20269>>DOINDEX 20348>>DOINDEX 20393>>ASSIGN  20398>>DOINDEX 20434>>ASSIGN
     20438>>DOINDEX 20526>>ASSIGN  20527>>IF      20541>>IF      20941>>DOINDEX
O$BLK.SUBLK$
     15916**DCL     19168<<ASSIGN  19169>>ASSIGN  19173>>ASSIGN  19215>>ASSIGN  19219>>ASSIGN  19221>>ASSIGN
     19229>>ASSIGN  19234>>ASSIGN  19254>>ASSIGN  19258>>ASSIGN  19286>>ASSIGN  19287>>ASSIGN  19287>>ASSIGN
     19299>>ASSIGN  19301>>ASSIGN  19301>>ASSIGN  19346>>ASSIGN  19348>>ASSIGN  19348>>ASSIGN  19383>>ASSIGN
     19383>>ASSIGN  19387>>CALL    19387>>CALL    19387>>CALL    19387>>CALL    19387>>CALL    19387>>CALL
     19418>>IF      19432>>IF      19436>>ASSIGN  19450>>ASSIGN  19452>>ASSIGN  19460>>ASSIGN  19465>>ASSIGN
     19483>>ASSIGN  19484>>IF      19487>>DOCASE  19491>>IF      19494>>ASSIGN  19494>>ASSIGN  19496>>ASSIGN
     19496>>ASSIGN  19496>>ASSIGN  19502>>IF      19505>>ASSIGN  19505>>ASSIGN  19507>>ASSIGN  19507>>ASSIGN
     19507>>ASSIGN  19515>>ASSIGN  19517>>ASSIGN  19517>>ASSIGN  19577>>CALL    19577>>CALL    19597>>ASSIGN
     19604>>ASSIGN  19606>>ASSIGN  19610>>ASSIGN  19623>>ASSIGN  19623>>ASSIGN  19629>>DOCASE  19629>>DOCASE
     19636>>ASSIGN  19636>>ASSIGN  19938>>ASSIGN  19939>>IF      19948>>DOCASE  19952>>ASSIGN  19955>>ASSIGN
     19955>>ASSIGN  19971>>IF      19977>>ASSIGN  19981>>IF      19982>>IF      19987>>DOINDEX 19988>>ASSIGN
     19988>>ASSIGN  20002>>ASSIGN  20016>>IF      20024>>IF      20025>>IF      20032>>ASSIGN  20032>>ASSIGN
     20033>>ASSIGN  20039>>CALLBLT 20039>>CALLBLT 20044>>IF      20044>>IF      20058>>DOINDEX 20059>>ASSIGN
     20059>>ASSIGN  20059>>ASSIGN  20090>>ASSIGN  20090>>ASSIGN  20099>>IF      20100>>IF      20107>>ASSIGN
     20107>>ASSIGN  20108>>IF      20111>>CALLBLT 20111>>CALLBLT 20114>>CALL    20114>>CALL    20123>>IF
     20123>>IF      20131>>DOINDEX 20132>>ASSIGN  20132>>ASSIGN  20132>>ASSIGN  20153>>ASSIGN  20153>>ASSIGN
     20162>>IF      20163>>IF      20170>>ASSIGN  20170>>ASSIGN  20171>>IF      20174>>CALLBLT 20174>>CALLBLT
     20178>>CALL    20178>>CALL    20183>>IF      20183>>IF      20191>>DOINDEX 20192>>ASSIGN  20192>>ASSIGN
     20193>>ASSIGN  20198>>ASSIGN  20208>>ASSIGN  20208>>ASSIGN  20214>>DOINDEX 20215>>ASSIGN  20215>>ASSIGN
     20216>>ASSIGN  20217>>ASSIGN  20217>>ASSIGN  20218>>ASSIGN  20267>>ASSIGN  20267>>ASSIGN  20270>>DOCASE
     20272>>CALLBLT 20272>>CALLBLT 20272>>CALLBLT 20272>>CALLBLT 20275>>CALLBLT 20275>>CALLBLT 20275>>CALLBLT
     20275>>CALLBLT 20276>>CALLBLT 20276>>CALLBLT 20276>>CALLBLT 20276>>CALLBLT 20346>>DOCASE  20346>>DOCASE
     20348>>DOINDEX 20348>>DOINDEX 20349>>ASSIGN  20349>>ASSIGN  20349>>ASSIGN  20349>>ASSIGN  20349>>ASSIGN
     20349>>ASSIGN  20356>>ASSIGN  20356>>ASSIGN  20356>>ASSIGN  20383>>ASSIGN  20383>>ASSIGN  20383>>ASSIGN
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:482  
     20393>>ASSIGN  20393>>ASSIGN  20394>>ASSIGN  20394>>ASSIGN  20398>>DOINDEX 20398>>DOINDEX 20398>>DOINDEX
     20399>>ASSIGN  20399>>ASSIGN  20399>>ASSIGN  20399>>ASSIGN  20399>>ASSIGN  20399>>ASSIGN  20399>>ASSIGN
     20399>>ASSIGN  20416>>ASSIGN  20416>>ASSIGN  20416>>ASSIGN  20416>>ASSIGN  20434>>ASSIGN  20434>>ASSIGN
     20435>>ASSIGN  20435>>ASSIGN  20438>>DOINDEX 20438>>DOINDEX 20438>>DOINDEX 20439>>ASSIGN  20439>>ASSIGN
     20439>>ASSIGN  20439>>ASSIGN  20439>>ASSIGN  20439>>ASSIGN  20439>>ASSIGN  20439>>ASSIGN  20460>>ASSIGN
     20460>>ASSIGN  20460>>ASSIGN  20460>>ASSIGN  20526>>ASSIGN  20528>>ASSIGN  20528>>ASSIGN  20530>>CALLBLT
     20530>>CALLBLT 20530>>CALLBLT 20530>>CALLBLT 20535>>ASSIGN  20540>>ASSIGN  20542>>ASSIGN  20542>>ASSIGN
     20937>>DOSELCT 20940>>ASSIGN  20942>>ASSIGN  20942>>ASSIGN  20943>>ASSIGN
OFFSET IN PROCEDURE SET_TIMEZONE
     20518**DCL     20537<>CALL    20547>>ASSIGN
OOPS IN PROCEDURE SET_TIMEZONE
     20552**LABEL   20534--CALLALT 20537--CALLALT
OPEN_CNTRL_FPT
     17806**DCL     20638<>CALL    20681<>CALL    21214<>CALL
OPEN_CNTRL_FPT.ACSVEH_
     17808**DCL     17809--REDEF
OPEN_CNTRL_FPT.ALTKEYS_
     17814**DCL     17815--REDEF   17815--REDEF
OPEN_CNTRL_FPT.HDR_
     17813**DCL     17814--REDEF
OPEN_CNTRL_FPT.TAB_
     17812**DCL     17813--REDEF
OPEN_CNTRL_FPT.UHL_
     17806**DCL     17807--REDEF   17807--REDEF
OPEN_CNTRL_FPT.V
     17815**DCL     17806--DCLINIT
OPEN_CNTRL_FPT.V.FSN#
     17846**DCL     17846--REDEF   17846--REDEF
OPEN_CNTRL_FPT.WSN_
     17812**DCL     17812--REDEF
OPEN_CONTROL_S
     17921**DCL     18975<>CALL
OPEN_CONTROL_S.ACSVEH_
     17923**DCL     17924--REDEF
OPEN_CONTROL_S.ALTKEYS_
     17929**DCL     17930--REDEF   17930--REDEF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:483  
OPEN_CONTROL_S.HDR_
     17928**DCL     17929--REDEF
OPEN_CONTROL_S.TAB_
     17927**DCL     17928--REDEF
OPEN_CONTROL_S.UHL_
     17921**DCL     17922--REDEF   17922--REDEF
OPEN_CONTROL_S.V
     17930**DCL     17921--DCLINIT
OPEN_CONTROL_S.V.FSN#
     17961**DCL     17961--REDEF   17961--REDEF
OPEN_CONTROL_S.WSN_
     17927**DCL     17927--REDEF
OPEN_RU
     18607**DCL     19626<>CALL    20212<>CALL
OPEN_RU.ACSVEH_
     18609**DCL     18610--REDEF
OPEN_RU.ALTKEYS_
     18615**DCL     18616--REDEF   18616--REDEF
OPEN_RU.HDR_
     18614**DCL     18615--REDEF
OPEN_RU.TAB_
     18613**DCL     18614--REDEF
OPEN_RU.UHL_
     18607**DCL     18608--REDEF   18608--REDEF
OPEN_RU.V
     18616**DCL     18607--DCLINIT
OPEN_RU.V.ASN#
     18626**DCL     18524--DCLINIT
OPEN_RU.V.FSN#
     18647**DCL     18647--REDEF   18647--REDEF
OPEN_RU.V.FUN#
     18626**DCL     19625<<ASSIGN  20211<<ASSIGN
OPEN_RU.V.RES#
     18631**DCL     18524--DCLINIT
OPEN_RU.WSN_
     18613**DCL     18613--REDEF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:484  
OPEN_TP_CNTRL
     18042**DCL     19040<>CALL    20311<>CALL    20324<>CALL    20939<>CALL
OPEN_TP_CNTRL.ACSVEH_
     18044**DCL     18045--REDEF
OPEN_TP_CNTRL.ALTKEYS_
     18050**DCL     18051--REDEF   18051--REDEF
OPEN_TP_CNTRL.HDR_
     18049**DCL     18050--REDEF
OPEN_TP_CNTRL.TAB_
     18048**DCL     18049--REDEF
OPEN_TP_CNTRL.UHL_
     18042**DCL     18043--REDEF   18043--REDEF
OPEN_TP_CNTRL.V
     18051**DCL     18042--DCLINIT
OPEN_TP_CNTRL.V.FSN#
     18082**DCL     18082--REDEF   18082--REDEF
OPEN_TP_CNTRL.V.FUN#
     18061**DCL     20323<<ASSIGN  20333<<ASSIGN
OPEN_TP_CNTRL.WSN_
     18048**DCL     18048--REDEF
OUT$SYM
     15846**DCL     19387<>CALL    19577<>CALL    20114<>CALL    20178<>CALL
OUT$SYM.CODE
     15852**DCL     19981>>IF      19982>>IF      19989>>ASSIGN  20004>>IF      20032>>ASSIGN  20107>>ASSIGN
     20170>>ASSIGN
OUT$SYM.COUNT
     15869**DCL     15872--IMP-SIZ 19301>>ASSIGN  19348>>ASSIGN  19387>>CALL    19496>>ASSIGN  19496>>ASSIGN
     19507>>ASSIGN  19507>>ASSIGN  19577>>CALL    19623>>ASSIGN  20039>>CALLBLT 20111>>CALLBLT 20114>>CALL
     20174>>CALLBLT 20178>>CALL    20209>>ASSIGN  20217>>ASSIGN  20218>>ASSIGN  20272>>CALLBLT 20275>>CALLBLT
     20276>>CALLBLT 20349>>ASSIGN  20356>>ASSIGN  20383>>ASSIGN  20395>>CALLBLT 20399>>ASSIGN  20416>>ASSIGN
     20439>>ASSIGN  20448>>ASSIGN  20449>>ASSIGN  20450>>ASSIGN  20451>>ASSIGN  20452>>ASSIGN  20453>>ASSIGN
     20460>>ASSIGN  20471>>ASSIGN  20472>>ASSIGN  20473>>ASSIGN  20474>>ASSIGN  20475>>ASSIGN  20476>>ASSIGN
     20528>>ASSIGN  20530>>CALLBLT 20530>>CALLBLT 20542>>ASSIGN  20942>>ASSIGN  20943>>ASSIGN
OUT$SYM.TEXT
     15872**DCL     19301>>ASSIGN  19348>>ASSIGN  19496>>ASSIGN  19507>>ASSIGN  19623--ASSIGN  20039>>CALLBLT
     20111>>CALLBLT 20174>>CALLBLT 20209--ASSIGN  20217>>ASSIGN  20272>>CALLBLT 20275>>CALLBLT 20276>>CALLBLT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:485  
     20349>>ASSIGN  20395>>CALLBLT 20399>>ASSIGN  20439>>ASSIGN  20449>>ASSIGN  20452>>ASSIGN  20472>>ASSIGN
     20475>>ASSIGN  20528>>ASSIGN  20530>>CALLBLT 20530>>CALLBLT 20542>>ASSIGN  20942>>ASSIGN
OUTBUF
     11856**DCL     12740--DCLINIT 12742--DCLINIT
OUT_SYM IN PROCEDURE GET_RES
     19880**DCL     19870--PROC
OUT_SYM.COUNT IN PROCEDURE GET_RES
     19903**DCL     19906--IMP-SIZ 19914>>IF      19915>>IF      19922>>IF      19922>>IF
OUT_SYM.TEXT IN PROCEDURE GET_RES
     19906**DCL     19915>>IF      19922>>IF
P$TBL.FLAGS.DISPONLY
     15937**DCL     19958>>IF      20093>>IF      20156>>IF
P$TBL.FLAGS.INDX
     15938**DCL     19586>>IF      20042>>IF      20122>>IF      20581>>IF      20587>>IF      20605>>IF
     20611>>IF      20888>>IF
P$TBL.FLAGS.INTINDX
     15944**DCL     19978>>IF      20066>>IF
P$TBL.FLAGS.MAXCONST
     15940**DCL     20595>>IF
P$TBL.FLAGS.MINCONST
     15941**DCL     20571>>IF
P$TBL.FLAGS.PRINT
     15936**DCL     19201<<ASSIGN  19267<<ASSIGN  19395<<ASSIGN  21090>>IF
P$TBL.FLAGS.RES
     15939**DCL     19195>>IF      19261>>IF      19385>>IF      20881>>IF      21062>>IF
P$TBL.FLAGS.VALTEXT
     15942**DCL     20025>>IF      20100>>IF      20163>>IF
P$TBL.FLAGS.VALTEXTLIST
     15943**DCL     19969>>IF
P$TBL.MAX
     15959**DCL     20596>>IF      20598<>CALL    20603>>ASSIGN  20605>>IF      20611>>IF      20725>>IF
     20727<>CALL    20796>>IF      20797<>CALL    20810>>IF      20812<>CALL    20822>>IF      20823<>CALL
     20833>>IF      20834<>CALL    20840>>IF      20841<>CALL    21078>>IF
P$TBL.MIN
     15960**DCL     20572>>IF      20574<>CALL    20579>>ASSIGN  20581>>IF      20587>>IF      20792>>IF
     20793<>CALL    20805>>IF      20807<>CALL    20818>>IF      20819<>CALL    20829>>IF      20830<>CALL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:486  
P$TBL.MULT
     15961**DCL     20558>>ASSIGN  20572>>IF      20583>>CALL    20589>>CALL    20596>>IF      20607>>CALL
     20613>>CALL    20697>>CALL    20704>>CALL    20714>>CALL    20721>>CALL    20725>>IF      20805>>IF
     20810>>IF      20850>>ASSIGN  20856>>ASSIGN  20866>>ASSIGN
P$TBL.PSUPTR$
     15955**DCL     15956--REDEF
P$TBL.PTR$
     15951**DCL     15952--REDEF   19845>>ASSIGN  20560>>ASSIGN  20579>>ASSIGN  20603>>ASSIGN  20889>>CALLBLT
     20889>>CALLBLT 20892>>ASSIGN
P$TBL.REPSUPTR$.ADDRESS
     15957**DCL     20670>>ASSIGN  20781>>ASSIGN
P$TBL.REPTR$.ADDRESS
     15953**DCL     20658>>ASSIGN  20771>>ASSIGN
P$TBL.RESPTR$
     15947**DCL     19197>>ASSIGN  19263>>ASSIGN  19391>>ASSIGN  21065>>IF
P$TBL.TEXT
     15948**DCL     21067>>ASSIGN  21091<>CALL
P$TBL.TEXT.COUNT
     15949**DCL     20878>>ASSIGN
P$TBL.TEXT.TEXT
     15950**DCL     20879>>CALLBLT
P$TBL.VALCODE
     15946**DCL     19971>>IF      20025>>IF      20068>>IF      20100>>IF      20163>>IF
PARAM$
     11670**DCL     19517<<ASSIGN  19519>>IF      19532>>IF      19545>>IF      19558>>IF      19571>>ASSIGN
     19572>>ASSIGN  19574>>IF      19574>>IF      19574>>IF      19577>>CALL    19577>>CALL    19955<<ASSIGN
     19956>>ASSIGN  20010>>IF      20010>>IF      20090<<ASSIGN  20091>>ASSIGN  20114>>CALL    20114>>CALL
     20153<<ASSIGN  20154>>ASSIGN  20177>>IF      20178>>CALL    20178>>CALL    20564<<ASSIGN  20571>>IF
     20572>>IF      20572>>IF      20574>>CALL    20579>>ASSIGN  20579>>ASSIGN  20581>>IF      20581>>IF
     20583>>CALL    20587>>IF      20587>>IF      20589>>CALL    20595>>IF      20596>>IF      20596>>IF
     20598>>CALL    20603>>ASSIGN  20603>>ASSIGN  20605>>IF      20605>>IF      20607>>CALL    20611>>IF
     20611>>IF      20613>>CALL    20878>>ASSIGN  20879>>CALLBLT 20881>>IF      20888>>IF      20889>>CALLBLT
     20889>>CALLBLT 20892>>ASSIGN
PARSE_ERR
     19105**LABEL   19069--CALLALT
PART#$
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:487  
     11669**DCL     19221<<ASSIGN  19223>>IF      19229>>ASSIGN  19231>>IF      19234>>ASSIGN  19452<<ASSIGN
     19454>>IF      19460>>ASSIGN  19462>>IF      19465>>ASSIGN
PART#_FLGS
     11709**DCL     19448<<ASSIGN  19476<<ASSIGN  19844<<ASSIGN  19848<<ASSIGN
PART$
     11635**DCL     20697>>CALL    20704>>CALL    20714>>CALL    20721>>CALL    20725>>IF      20725>>IF
     20727>>CALL    20792>>IF      20793>>CALL    20796>>IF      20797>>CALL    20805>>IF      20805>>IF
     20807>>CALL    20810>>IF      20810>>IF      20812>>CALL    20818>>IF      20819>>CALL    20822>>IF
     20823>>CALL    20829>>IF      20830>>CALL    20833>>IF      20834>>CALL    20840>>IF      20841>>CALL
PARTITION_TBL
     14965**DCL     11635--DCLINIT 15661--DCLINIT
PARTSKIPSET IN PROCEDURE SET_VALUE
     20848**LABEL   20699--GOTO    20706--GOTO    20716--GOTO    20723--GOTO    20728--GOTO    20738--GOTO
     20745--GOTO    20755--GOTO    20762--GOTO    20767--GOTO    20776--GOTO    20786--GOTO    20794--GOTO
     20798--GOTO    20808--GOTO    20813--GOTO    20820--GOTO    20824--GOTO    20831--GOTO    20835--GOTO
     20842--GOTO
PC$
     11744**DCL     19998<<ASSIGN  20004>>IF
PC$HDR
     12822**DCL     19043--ASSIGN  19047--ASSIGN  20313--ASSIGN  20334--ASSIGN  20336--ASSIGN  20350--ASSIGN
     20366--ASSIGN  20401--ASSIGN  20424--ASSIGN  20441--ASSIGN  20468--ASSIGN  20945--ASSIGN  20959--ASSIGN
PC$HDR.CURINSTANCES
     12823**DCL     19042>>ASSIGN  20313>>ASSIGN  20335<<ASSIGN  20351>>DOINDEX 20375<<ASSIGN  20375>>ASSIGN
     20402>>DOINDEX 20425>>DOINDEX 20442>>DOINDEX 20469>>DOINDEX 20947>>DOINDEX
PC$INSTANCE
     12826**DCL     19043--ASSIGN  19062--ASSIGN  20313--ASSIGN  20361--ASSIGN  20372--ASSIGN  20374--CALL
     20377<<ASSIGN  20411--ASSIGN  20430--ASSIGN  20455--ASSIGN  20478--ASSIGN  20953--ASSIGN  20959--ASSIGN
PC$INSTANCE.FLAGS.ACTIVE
     12830**DCL     20960>>IF
PC$INSTANCE.FLAGS.DELETED
     12831**DCL     19054>>ASSIGN  19055>>IF      20352>>IF      20369>>IF      20403>>IF      20426>>IF
     20443>>IF      20470>>IF      20948>>IF      20964<<ASSIGN
PC$INSTANCE.FLAGS.HEADER
     12832**DCL     19059>>ASSIGN  20450<<ASSIGN  20473<<ASSIGN  20967<<ASSIGN
PC$INSTANCE.HDR
     12834**DCL     19061>>ASSIGN
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:488  
PC$INSTANCE.HDR.CNT
     12835**DCL     20448<<ASSIGN  20471<<ASSIGN
PC$INSTANCE.HDR.MSG
     12836**DCL     20449<<ASSIGN  20472<<ASSIGN
PC$INSTANCE.INSTANCE_NAME
     12827**DCL     19049>>ASSIGN  20352>>IF      20378<<ASSIGN  20403>>IF      20443>>IF      20948>>IF
PC$INSTANCE.MAXTPU
     12828**DCL     19058>>ASSIGN  20379<<ASSIGN  20408<<ASSIGN  20427<<ASSIGN
PC$INSTANCE.STATS
     12852**DCL     20380<<ASSIGN
PC$JIT$
     11645**DCL     18972>>IF      18972>>IF      19139>>IF      19139>>IF      19139>>IF      21142>>IF
PC$JITPTR
     11641**DCL     11645--REDEF
PCB$BREAK
     15996**DCL-ENT 17682--DCLINIT
PCB$BREAKSET
     15997**DCL-ENT 17698--DCLINIT
PCB$TRAP
     15998**DCL-ENT 18840--DCLINIT
PCE$ERROR
     15992**DCL-ENT 19097--CALL    19113--CALL    19120--CALL    19150--CALL    19237--CALL    19328--CALL
     19375--CALL    19403--CALL    19468--CALL    19588--CALL    19614--CALL    19736--CALL    19739--CALL
     19740--CALL    19748--CALL    19863--CALL    19940--CALL    19960--CALL    19974--CALL    20018--CALL
     20029--CALL    20079--CALL    20095--CALL    20104--CALL    20118--CALL    20141--CALL    20158--CALL
     20167--CALL    20201--CALL    20224--CALL    20243--CALL    20279--CALL    20291--CALL    20294--CALL
     20295--CALL    20300--CALL    20330--CALL    20342--CALL    20358--CALL    20419--CALL    20463--CALL
     20497--CALL    20502--CALL    20854--CALL    20855--CALL    20905--CALL    20956--CALL    20961--CALL
     20968--CALL    20986--CALL    20987--CALL    21007--CALL    21143--CALL    21235--CALL    21236--CALL
PCN_CMDS
     16029**DCL     19069<>CALL
PCP$PDISP
     15994**DCL-ENT 19528--CALL    19541--CALL    19554--CALL    19567--CALL    19833--CALL    19857--CALL
PCR$RESTEXT
     15995**DCL-ENT 20882--CALL    21068--CALL
PCT$EXCEPTION
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:489  
     16003**DCL-ENT 19423--CALL    19444--CALL    19853--CALL
PCT$PARTITION
     16002**DCL-ENT 19422--CALL    19443--CALL    19480--CALL    19850--CALL
PCT$RESOURCE
     16001**DCL-ENT 19421--CALL    19442--CALL    19842--CALL
PCT$SYSTEM
     16000**DCL-ENT 19420--CALL    19441--CALL    19840--CALL
PCT$TPCAT
     16004**DCL-ENT 19424--CALL    19485--CALL    19489--CALL    19492--CALL    19498--CALL    19503--CALL
     19509--CALL
PCW$WRITE
     15993**DCL-ENT 18990--CALL    21048--CALL    21115--CALL    21127--CALL
PC_CODE
     11748**DCL     20004>>IF
PC_REASON
     11639**DCL     18965<<ASSIGN  19038<<ASSIGN  19065<<ASSIGN
PDT
     11721**DCL     11724--DCLINIT
PDT$
     11724**DCL     20688>>ASSIGN  21165>>ASSIGN  21224>>ASSIGN
PDTFLAG$
     11725**DCL     19756>>ASSIGN  20689>>ASSIGN  21166>>ASSIGN  21225>>ASSIGN
PDTFLAGS
     11722**DCL     11725--DCLINIT
PMAXRFLGS
     15700**DCL     15091--DCLINIT
PMINRFLGS
     15696**DCL     15064--DCLINIT
PMME
     11740**DCL     11741--REDEF   19989<<ASSIGN
PMME_REDEF.CODE
     11743**DCL     19991>>ASSIGN
PMME_REDEF.FCG
     11742**DCL     19990>>ASSIGN
PRINT_BUF
     11702**DCL     21033<<ASSIGN  21038<<CALLBLT 21041<<CALLBLT 21046<<CALLBLT 21048<>CALL    21049<<ASSIGN
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:490  
     21115<>CALL    21118<<ASSIGN  21121<<CALLBLT 21127<>CALL    21129<<ASSIGN
PRINT_ERR IN PROCEDURE LIST_PRINT
     21135**LABEL   21115--CALLALT 21127--CALLALT
PRINT_FLAG IN PROCEDURE LIST_PRINT
     21108**DCL     21106--PROC    21126>>IF
PRIV_FPT
     17715**DCL     18977<>CALL    18981<>CALL
PRIV_FPT.V
     17715**DCL     17715--DCLINIT
PRIV_FPT.V.PRIV#
     17715**DCL     18980<<ASSIGN
PRIV_VALS.PC_CODE
     11751**DCL     19998--ASSIGN
PRIV_VALS.VAL_CODE
     11780**DCL     19999--ASSIGN
PSURES$TEXT
     15971**DCL     19015>>ASSIGN
PSURES_TEXT
     11695**DCL     19015<<ASSIGN  19922>>IF
PTR$
     11824**DCL     20940<<ASSIGN  20941>>DOINDEX 20942>>ASSIGN  20942>>ASSIGN  20943>>ASSIGN
P_PCB.NCHARS
     16196**DCL     19135<<ASSIGN  19144>>ASSIGN
P_PCB.OUT$
     16062**DCL     19069<>CALL    19071>>DOCASE  19105<>CALL    19166>>IF      19167>>ASSIGN  19168>>ASSIGN
     19168>>ASSIGN  19169>>ASSIGN  19172>>DOINDEX 19173>>ASSIGN  19418>>IF      19418>>IF      19432>>IF
     19435>>DOINDEX 19436>>ASSIGN  19937>>DOINDEX 19938>>ASSIGN  20937>>DOSELCT 20940>>ASSIGN
P_PCB.WORK$
     16058**DCL     19022<<ASSIGN
P_PCB$
     11857**DCL     16049--IMP-PTR 19018<<ASSIGN  19019<>CALL    19022>>ASSIGN  19069>>CALL    19071>>DOCASE
     19105>>CALL    19135>>ASSIGN  19144>>ASSIGN  19166>>IF      19167>>ASSIGN  19168>>ASSIGN  19168>>ASSIGN
     19169>>ASSIGN  19172>>DOINDEX 19173>>ASSIGN  19418>>IF      19418>>IF      19432>>IF      19435>>DOINDEX
     19436>>ASSIGN  19937>>DOINDEX 19938>>ASSIGN  20937>>DOSELCT 20940>>ASSIGN
READ_CMD_FPT
     17576**DCL     19133<>CALL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:491  
READ_CMD_FPT.STATION_
     17579**DCL     17580--REDEF
READ_CMD_FPT.V
     17580**DCL     17576--DCLINIT
READ_CMD_FPT.V.DVBYTE.REREAD#
     17591**DCL     17591--REDEF
READ_CMD_FPT.V.INDX#
     17589**DCL     17589--REDEF
READ_ERR IN PROCEDURE READ_CMD
     19150**LABEL   19133--CALLALT
READ_HEAD
     18770**DCL     19627<>CALL    20213<>CALL
READ_HEAD.STATION_
     18773**DCL     18774--REDEF
READ_HEAD.V
     18774**DCL     18770--DCLINIT
READ_HEAD.V.DVBYTE.REREAD#
     18785**DCL     18785--REDEF
READ_HEAD.V.INDX#
     18783**DCL     18783--REDEF
REMEM_CMD_READ
     11689**DCL     18994<<REMEMBR
REREAD IN PROCEDURE READ_CMD
     19132**LABEL   19137--GOTO
RES$
     11636**DCL     20122>>IF      20658>>ASSIGN  20670>>ASSIGN  20771>>ASSIGN  20781>>ASSIGN
RES$FLGS
     15970**DCL     19197<<ASSIGN  19263<<ASSIGN  19391<<ASSIGN  21065>>IF
RESET_BREAK IN PROCEDURE EXEC_SET
     20493**LABEL   19975--GOTO    20019--GOTO    20030--GOTO    20105--GOTO    20168--GOTO
RESOURCE_TBL
     14850**DCL     11636--DCLINIT 15652--DCLINIT
RESSKIPSET IN PROCEDURE SET_VALUE
     20685**LABEL   20652--GOTO    20664--GOTO    20676--GOTO
RESTEXT_C
     13125**DCL     20882<>CALL    21068<>CALL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:492  
RESTEXT_C.COUNT
     13126**DCL     20883>>CALLBLT 20885>>ASSIGN  21069>>CALLBLT 21071>>ASSIGN
RESTEXT_C.TEXT
     13127**DCL     20883>>CALLBLT 21069>>CALLBLT
RES_INDEX IN PROCEDURE GET_RES
     19872**DCL     19870--PROC
RES_INDX
     11696**DCL     19196<<DOINDEX 19197>>ASSIGN  19262<<DOINDEX 19263>>ASSIGN  19387<>CALL    19391>>ASSIGN
     19577<>CALL    19579>>ASSIGN  19916<<ASSIGN  19923<<ASSIGN  20114<>CALL    20116>>IF      20178<>CALL
     20181<<ASSIGN  20646>>IF      20657>>IF      20661>>IF      20662>>CALL    20666>>ASSIGN  20673>>IF
     20674>>CALL    20678>>ASSIGN  20734>>IF      20735>>IF      20736>>ASSIGN  20742>>IF      20743>>ASSIGN
     20747>>ASSIGN  20748>>ASSIGN  20751>>IF      20752>>IF      20753>>ASSIGN  20759>>IF      20760>>ASSIGN
     20764>>IF      20770>>IF      20773>>IF      20774>>CALL    20783>>IF      20784>>CALL    20789>>ASSIGN
     20790>>ASSIGN  20882<>CALL    21063<<DOINDEX 21065>>IF      21068<>CALL
RES_TEXT
     11691**DCL     19915>>IF
RUBUF
     11833**DCL     19721--CALL    19731--CALL    19732--CALL
RUBUF.COUNT
     11834**DCL     19642<<ASSIGN  19720>>IF      19723<<ASSIGN  19726>>CALLBLT 19727<<ASSIGN  19727>>ASSIGN
RUBUF.TEXT
     11835**DCL     19643<<ASSIGN  19722<<ASSIGN  19726<<CALLBLT
RUPARAM_TBL.COUNT
     11840**DCL     19648>>ASSIGN
RUPARAM_TBL.TEXT
     11841**DCL     19649>>CALLBLT
RU_FMT
     11832**DCL     19639--CALL
RU_PARAMS
     11831**DCL     19622<<ASSIGN  19631<<ASSIGN  19633<<ASSIGN  19634<<ASSIGN  19636<<ASSIGN  19647>>IF
     19709<<ASSIGN  19730>>IF
SETAUTH
     11687**DCL     18985<<ASSIGN  19939>>IF
SET_CAT
     11733**DCL     19952<<ASSIGN  19953>>IF      19954<<ASSIGN  19958>>IF      19969>>IF      19971>>IF
     19978>>IF      20015>>IF      20025>>IF      20025>>IF      20042>>IF      20047>>IF      20066>>IF
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:493  
     20068>>IF      20089<<ASSIGN  20093>>IF      20100>>IF      20100>>IF      20152<<ASSIGN  20156>>IF
     20163>>IF      20163>>IF      20558>>ASSIGN  20560>>ASSIGN  20564>>ASSIGN  20566>>DOCASE  20620>>IF
     20629>>IF      20850>>ASSIGN  20856>>ASSIGN  20866>>ASSIGN
SET_INDEXHI
     11736**DCL     20049<<ASSIGN  20053<<ASSIGN  20061<<ASSIGN  20073<<ASSIGN  20084<<ASSIGN  20127<<ASSIGN
     20134<<ASSIGN  20146<<ASSIGN  20187<<ASSIGN  20196<<ASSIGN  20198<<ASSIGN  20200>>IF      20525<<ASSIGN
     20570>>DOINDEX 20645>>DOINDEX 20687>>DOINDEX
SET_INDEXLO
     11735**DCL     20048<<ASSIGN  20052<<ASSIGN  20059<<ASSIGN  20061>>ASSIGN  20072<<ASSIGN  20083<<ASSIGN
     20126<<ASSIGN  20132<<ASSIGN  20134>>ASSIGN  20145<<ASSIGN  20186<<ASSIGN  20193<<ASSIGN  20196>>ASSIGN
     20200>>IF      20524<<ASSIGN  20570>>DOINDEX 20645>>DOINDEX 20687>>DOINDEX
SET_PARAM
     11734**DCL     19956<<ASSIGN  19958>>IF      19969>>IF      19971>>IF      19978>>IF      20015>>IF
     20025>>IF      20025>>IF      20042>>IF      20066>>IF      20068>>IF      20091<<ASSIGN  20093>>IF
     20100>>IF      20100>>IF      20116>>IF      20122>>IF      20154<<ASSIGN  20156>>IF      20163>>IF
     20163>>IF      20545<<ASSIGN  20548<<ASSIGN  20558>>ASSIGN  20560>>ASSIGN  20571>>IF      20572>>IF
     20572>>IF      20574>>CALL    20579>>ASSIGN  20581>>IF      20583>>CALL    20587>>IF      20589>>CALL
     20595>>IF      20596>>IF      20596>>IF      20598>>CALL    20603>>ASSIGN  20605>>IF      20607>>CALL
     20611>>IF      20613>>CALL    20620>>IF      20620>>IF      20620>>IF      20629>>IF      20658>>ASSIGN
     20670>>ASSIGN  20692>>DOCASE  20850>>ASSIGN  20856>>ASSIGN  20866>>ASSIGN  20878>>ASSIGN  20879>>CALLBLT
     20881>>IF      20888>>IF
SET_PDT$
     11727**DCL     20688<<ASSIGN  20696>>IF      20697>>CALL    20708>>ASSIGN  20713>>IF      20714>>CALL
     20730>>ASSIGN  20735>>IF      20736>>ASSIGN  20747>>ASSIGN  20752>>IF      20753>>ASSIGN  20789>>ASSIGN
     20801>>ASSIGN  20802>>ASSIGN  20815>>ASSIGN  20826>>ASSIGN  20837>>ASSIGN  20844>>ASSIGN  21165<<ASSIGN
     21172>>ASSIGN  21176>>ASSIGN  21181>>ASSIGN  21185>>ASSIGN  21190>>ASSIGN  21193>>ASSIGN  21197>>ASSIGN
     21201>>ASSIGN  21205>>ASSIGN  21224<<ASSIGN  21227>>ASSIGN
SET_PDTFLAG$
     11728**DCL     19756<<ASSIGN  19760>>IF      19764>>IF      19770>>IF      19787>>IF      19802>>IF
     19806>>IF      19810>>IF      19814>>IF      19818>>IF      20689<<ASSIGN  20695>>IF      20709>>ASSIGN
     20712>>IF      20731>>ASSIGN  20734>>IF      20748>>ASSIGN  20751>>IF      20790>>ASSIGN  20803>>ASSIGN
     20816>>ASSIGN  20827>>ASSIGN  20838>>ASSIGN  20845>>ASSIGN  21166<<ASSIGN  21168>>IF      21171>>IF
     21175>>IF      21180>>IF      21184>>IF      21189>>IF      21192>>IF      21196>>IF      21200>>IF
     21204>>IF      21225<<ASSIGN  21228>>ASSIGN
SET_TIMEZONE IN PROCEDURE EXEC_SET
     20516**PROC    20021--CALL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:494  
SET_VALUE IN PROCEDURE EXEC_SET
     20556**PROC    20055--CALL    20062--CALL    20074--CALL    20085--CALL    20128--CALL    20135--CALL
     20147--CALL    20188--CALL    20205--CALL    20546--CALL    20549--CALL
SIZE IN PROCEDURE GBLK
     20922**DCL     20920--PROC    20924>>DOWHILE 20929>>ASSIGN  20930>>ASSIGN
SKIPSET IN PROCEDURE SET_VALUE
     20642**LABEL   20575--GOTO    20585--GOTO    20591--GOTO    20599--GOTO    20609--GOTO    20615--GOTO
SKIP_IT
     19065**LABEL   19026--CALLALT
SL_IOTA
     16280**DCL     13515--DCLINIT
SL_MF
     16280**DCL     13543--DCLINIT
SL_MFU
     16280**DCL     13571--DCLINIT
SL_QMIN
     16281**DCL     13431--DCLINIT
SL_QUAN
     16280**DCL     13459--DCLINIT
START_CMD IN PROCEDURE EXEC_ADD
     19166**LABEL   19159--GOTO
SUBLK$
     11809**DCL     19977<<ASSIGN  19981>>IF      19982>>IF      19987>>DOINDEX 19988>>ASSIGN  20001>>DOINDEX
     20002>>ASSIGN
SUB_BUF_1.COUNT
     16235**DCL     19326<<ASSIGN  19373<<ASSIGN  20356<<ASSIGN  20416<<ASSIGN  20460<<ASSIGN  20878<<ASSIGN
     20879>>CALLBLT 20883>>CALLBLT 20885<<ASSIGN  20885>>ASSIGN  20889>>CALLBLT 20892<<ASSIGN  20892>>ASSIGN
     20943<<ASSIGN
SUB_BUF_1.TEXT
     16236**DCL     19327<<ASSIGN  19374<<ASSIGN  20357<<ASSIGN  20418<<ASSIGN  20462<<ASSIGN  20879<<CALLBLT
     20883<<CALLBLT 20889<<CALLBLT 20944<<ASSIGN
SUB_BUF_2.COUNT
     16238**DCL     20902<<ASSIGN
SUB_BUF_2.TEXT
     16239**DCL     20903<<ASSIGN
SYSACCT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:495  
     18500**DCL     17811--DCLINIT 17926--DCLINIT 18047--DCLINIT
SYSTEM_TBL
     13245**DCL     11634--DCLINIT 15643--DCLINIT
SYSTEM_TBL.QMIN.MIN
     13434**DCL     19030<<ASSIGN  19035<<ASSIGN
SYSTEM_TBL.QUAN.MIN
     13462**DCL     19031<<ASSIGN  19036<<ASSIGN
S_CTUIS
     16270**DCL     13348--DCLINIT
S_CUIS
     16270**DCL     13321--DCLINIT
S_MUIS
     16270**DCL     13294--DCLINIT
S_PRIOB
     16280**DCL     13487--DCLINIT
S_TUIS
     16270**DCL     13376--DCLINIT
TABLE$
     11822**DCL     20312<<ASSIGN  20314<<ASSIGN  20314>>ASSIGN  20334<<ASSIGN  20928>>ASSIGN  20929<<ASSIGN
     20929>>ASSIGN
TBLINDX
     11829**DCL     20367<<ASSIGN  20371<<ASSIGN  20371>>ASSIGN  20381>>ASSIGN  20382>>ASSIGN  20383>>ASSIGN
     20385>>ASSIGN  20386>>ASSIGN
TBLINSTANCES
     11682**DCL     19042<<ASSIGN  19043>>ASSIGN  19048>>DOINDEX 19291>>DOINDEX 19303>>DOINDEX 19338>>DOINDEX
     19350>>DOINDEX 20338<<ASSIGN  20368>>DOINDEX 20376<<ASSIGN  20376>>ASSIGN
TEMP$
     11660**DCL     11661--REDEF   19219<<ASSIGN  19220>>DOINDEX 19221>>ASSIGN  19287<<ASSIGN  19288>>IF
     19289>>IF      19299>>ASSIGN  19335>>IF      19336>>IF      19346>>ASSIGN  19450<<ASSIGN  19451>>DOINDEX
     19452>>ASSIGN  19494<<ASSIGN  19495>>DOINDEX 19496>>ASSIGN  19496>>ASSIGN  19496>>ASSIGN  19505<<ASSIGN
     19506>>DOINDEX 19507>>ASSIGN  19507>>ASSIGN  19507>>ASSIGN  19604<<ASSIGN  19606>>ASSIGN  19609>>IF
     19610>>ASSIGN  20208<<ASSIGN  20209>>ASSIGN  20209>>ASSIGN  20215<<ASSIGN  20216>>ASSIGN  20217>>ASSIGN
     20217>>ASSIGN  20218>>ASSIGN  20267>>ASSIGN  20394<<ASSIGN  20395>>CALLBLT 20395>>CALLBLT 20435<<ASSIGN
     20448>>ASSIGN  20449>>ASSIGN  20449>>ASSIGN  20450>>ASSIGN  20451>>ASSIGN  20452>>ASSIGN  20452>>ASSIGN
     20453>>ASSIGN  20471>>ASSIGN  20472>>ASSIGN  20472>>ASSIGN  20473>>ASSIGN  20474>>ASSIGN  20475>>ASSIGN
     20475>>ASSIGN  20476>>ASSIGN  20579<<ASSIGN  20581>>IF      20583>>CALL    20587>>IF      20589>>CALL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:496  
     20603<<ASSIGN  20605>>IF      20607>>CALL    20611>>IF      20613>>CALL    20631<<ASSIGN  20634>>ASSIGN
     20661>>IF      20662>>CALL    20673>>IF      20674>>CALL    21000<<ASSIGN  21001>>IF      21001>>ASSIGN
     21160<<ASSIGN  21169>>ASSIGN
TEMP1
     11675**DCL     19224<<ASSIGN  19229<<ASSIGN  19231>>ASSIGN  19236>>IF      19248>>DOINDEX 19286<<ASSIGN
     19288>>IF      19335>>IF      19385>>IF      19391>>ASSIGN  19395>>ASSIGN  19455<<ASSIGN  19460<<ASSIGN
     19462>>ASSIGN  19467>>IF      19475>>DOINDEX 19751<<ASSIGN  19754>>ASSIGN  19755>>ASSIGN  19761>>ASSIGN
     19765>>ASSIGN  19772>>ASSIGN  19772>>ASSIGN  19773>>ASSIGN  19774>>ASSIGN  19775>>ASSIGN  19776<<ASSIGN
     19776>>ASSIGN  19779>>ASSIGN  19780>>ASSIGN  19789>>ASSIGN  19789>>ASSIGN  19790>>ASSIGN  19791>>ASSIGN
     19792>>ASSIGN  19793<<ASSIGN  19793>>ASSIGN  19796>>ASSIGN  19797>>ASSIGN  19803>>ASSIGN  19807>>ASSIGN
     19811>>ASSIGN  19815>>ASSIGN  19819>>ASSIGN  19822>>IF      19823>>ASSIGN  19824>>ASSIGN  19825>>ASSIGN
     19826<<ASSIGN  19826>>ASSIGN  19831>>IF      19832>>ASSIGN  20393<<ASSIGN  20396>>IF      20434<<ASSIGN
     20436>>IF      20633<<DOINDEX 20634>>ASSIGN  20736<<ASSIGN  20737<>CALL    20743<<ASSIGN  20744<>CALL
     20753<<ASSIGN  20754<>CALL    20760<<ASSIGN  20761<>CALL
TEMP1$
     11664**DCL     19299<<ASSIGN  19300>>DOINDEX 19301>>ASSIGN  19301>>ASSIGN  19346<<ASSIGN  19347>>DOINDEX
     19348>>ASSIGN  19348>>ASSIGN  20267<<ASSIGN  20268>>ASSIGN  20269>>DOINDEX 20270>>DOCASE  20272>>CALLBLT
     20272>>CALLBLT 20275>>CALLBLT 20275>>CALLBLT 20276>>CALLBLT 20276>>CALLBLT
TEMP2
     11676**DCL     19225<<ASSIGN  19231<<ASSIGN  19234<<ASSIGN  19236>>IF      19248>>DOINDEX 19383<<ASSIGN
     19385>>IF      19391>>ASSIGN  19395>>ASSIGN  19456<<ASSIGN  19462<<ASSIGN  19465<<ASSIGN  19467>>IF
     19475>>DOINDEX 19753<<DOINDEX 19756>>ASSIGN  19774>>ASSIGN  19775>>ASSIGN  19791>>ASSIGN  19792>>ASSIGN
     19824>>ASSIGN  19825>>ASSIGN
TEMPBUF
     11836**DCL     19646<<ASSIGN  19649<<CALLBLT 19653<<CALLBLT 19657<<CALLBLT 19662<<CALLBLT 19666<<CALLBLT
     19671<<CALLBLT 19675<<CALLBLT 19680<<CALLBLT 19684<<CALLBLT 19689<<CALLBLT 19693<<CALLBLT 19698<<CALLBLT
     19699<<CALLBLT 19703<<CALLBLT 19707<<CALLBLT 19717<<CALLBLT 19726>>CALLBLT
TEMPLEN
     11851**DCL     19645<<ASSIGN  19648<<ASSIGN  19648>>ASSIGN  19649>>CALLBLT 19653>>CALLBLT 19654<<ASSIGN
     19654>>ASSIGN  19657>>CALLBLT 19658<<ASSIGN  19658>>ASSIGN  19662>>CALLBLT 19663<<ASSIGN  19663>>ASSIGN
     19666>>CALLBLT 19667<<ASSIGN  19667>>ASSIGN  19671>>CALLBLT 19672<<ASSIGN  19672>>ASSIGN  19675>>CALLBLT
     19676<<ASSIGN  19676>>ASSIGN  19680>>CALLBLT 19681<<ASSIGN  19681>>ASSIGN  19684>>CALLBLT 19685<<ASSIGN
     19685>>ASSIGN  19689>>CALLBLT 19690<<ASSIGN  19690>>ASSIGN  19693>>CALLBLT 19694<<ASSIGN  19694>>ASSIGN
     19700<<ASSIGN  19700>>ASSIGN  19703>>CALLBLT 19704<<ASSIGN  19704>>ASSIGN  19707>>CALLBLT 19708<<ASSIGN
     19708>>ASSIGN  19717>>CALLBLT 19718<<ASSIGN  19718>>ASSIGN  19720>>IF      19725<<ASSIGN  19725>>ASSIGN
     19726>>CALLBLT 19727>>ASSIGN  20218<<ASSIGN  20221>>DOINDEX 20228>>CALLBLT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:497  
TEMPNAME
     11837**DCL     19496<<ASSIGN  19498<>CALL    19507<<ASSIGN  19509<>CALL    19712<<CALLBLT 19714>>DOWHILE
     19717>>CALLBLT 20217<<ASSIGN  20222>>IF      20222>>IF      20228>>CALLBLT 20231<<CALLBLT 20231>>CALLBLT
     20232>>IF      20232>>IF      20232>>IF      20232>>IF      20238>>IF      20238>>IF      20238>>IF
     20260>>ASSIGN
TEMPPTR.ADDRESS
     11662**DCL     20659<<ASSIGN  20671<<ASSIGN
TEMPPTR.SEGID
     11663**DCL     20562<<ASSIGN  20580<<ASSIGN  20604<<ASSIGN  20632<<ASSIGN  21161<<ASSIGN
TEMPTEXT IN PROCEDURE VAL_ERROR
     20875**DCL     20876--REDEF   20896<<CALLBLT 20899--DOWHILE 20902--ASSIGN  20903>>ASSIGN  20903--ASSIGN
TEMPTEXT_ARRAY IN PROCEDURE VAL_ERROR
     20876**DCL     20899>>DOWHILE
TEXTC$INDX.COUNT
     15974**DCL     20889>>CALLBLT 20892>>ASSIGN
TEXTC$INDX.TEXT
     15975**DCL     20889>>CALLBLT
TEXTC_CAT
     13097**DCL     21020<>CALL
TEXTC_DOMAIN
     13114**DCL     21054<>CALL
TEXTC_DOMAINX
     13093**DCL     15344--DCLINIT
TEXTC_MODE
     13106**DCL     21027<>CALL
TEXTC_MODEX
     13086**DCL     13267--DCLINIT 14872--DCLINIT 15537--DCLINIT
TEXTC_PART#X
     13089**DCL     14987--DCLINIT
TEXTC_PART#X.COUNT
     13090**DCL     21041>>CALLBLT 21043>>ASSIGN
TEXTC_PART#X.TEXT
     13091**DCL     21041>>CALLBLT
TEXT_C
     13121**DCL     21067<<ASSIGN  21073<>CALL    21086<>CALL
TEXT_C.COUNT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:498  
     13122**DCL     21069>>CALLBLT 21071<<ASSIGN  21071>>ASSIGN  21082<<ASSIGN
TEXT_C.TEXT
     13123**DCL     21069<<CALLBLT 21085<<ASSIGN
TEXT_C IN PROCEDURE LIST_PRINT
     21109**DCL     21106--PROC    21113--IF
TEXT_C.COUNT IN PROCEDURE LIST_PRINT
     21110**DCL     21114>>IF      21121>>CALLBLT 21123>>ASSIGN
TEXT_C.TEXT IN PROCEDURE LIST_PRINT
     21111**DCL     21121>>CALLBLT
TEXT_CONTROLHERE
     13129**DCL     18987>>CALLBLT 18988<<CALLBLT 18990<>CALL    18990--CALL
TOTRFLGS
     15692**DCL     14952--DCLINIT
TPHDR_TBL
     15712**DCL     15591--DCLINIT
TPHDR_TBL.FLAGS.PRESENT
     15718**DCL     19059<<ASSIGN  19060>>IF      20453<<ASSIGN  20476<<ASSIGN  20966<<ASSIGN
TPHDR_TBL.FLAGS.PRINT
     15717**DCL     19281<<ASSIGN  19339<<ASSIGN  19353<<ASSIGN
TPHDR_TBL.HDR
     15713**DCL     19061<<ASSIGN
TPHDR_TBL.HDR.CNT
     15714**DCL     20451<<ASSIGN  20474<<ASSIGN
TPHDR_TBL.HDR.MSG
     15715**DCL     20452<<ASSIGN  20475<<ASSIGN
TP_CNTRL_D
     18112**DCL     18043--DCLINIT
TP_TBL
     15515**DCL     11638--DCLINIT 15670--DCLINIT
TP_TBL.MAXTPU.FLAGS.PRINT
     15601**DCL     19290<<ASSIGN  19309<<ASSIGN  19317<<ASSIGN  20386>>ASSIGN  20387>>IF      21078>>IF
TP_TBL.MAXTPU.MAX
     15620**DCL     19206<<ASSIGN  19207<<ASSIGN  19272<<ASSIGN  19273<<ASSIGN  19295<<ASSIGN  19296<<ASSIGN
     19310>>IF      19311<<ASSIGN  19311>>ASSIGN  19314>>IF      19315<<ASSIGN  19315>>ASSIGN  19316>>IF
     20388<<ASSIGN  20388>>ASSIGN
TP_TBL.TPHDR.FLAGS.PRINT
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:499  
     15574**DCL     19337<<ASSIGN  19356<<ASSIGN  19364<<ASSIGN
TP_TBL.TPHDR.MAX
     15593**DCL     19278<<ASSIGN  19279<<ASSIGN  19342<<ASSIGN  19343<<ASSIGN  19357>>IF      19358<<ASSIGN
     19358>>ASSIGN  19361>>IF      19362<<ASSIGN  19362>>ASSIGN  19363>>IF
TRY_DISP
     18979**LABEL   18977--CALLALT
UMT_TIMEZONE
     17500**DCL     14812--DCLINIT
UMT_UTC_OFFSET
     17500**DCL     14841--DCLINIT
UQ_MAXENQ
     17510**DCL     13709--DCLINIT
VAL$
     11745**DCL     19990<<ASSIGN  19991>>ASSIGN  19999<<ASSIGN  20005>>ASSIGN
VALUE
     11737**DCL     11738--REDEF   19768<<DOINDEX 19770>>IF      19780>>ASSIGN  19785<<DOINDEX 19787>>IF
     19797>>ASSIGN  20032<<ASSIGN  20037<<ASSIGN  20037>>ASSIGN  20039<<CALLBLT 20107<<ASSIGN  20109<<ASSIGN
     20109>>ASSIGN  20111<<CALLBLT 20170<<ASSIGN  20172<<ASSIGN  20172>>ASSIGN  20174<<CALLBLT 20228<<CALLBLT
     20236<<ASSIGN  20241<<ASSIGN  20250>>ASSIGN  20252>>ASSIGN  20254>>ASSIGN  20256>>ASSIGN  20258>>ASSIGN
     20263>>ASSIGN  20264>>IF      20283>>ASSIGN  20395<<CALLBLT 20408>>ASSIGN  20409>>ASSIGN  20427>>ASSIGN
     20428>>ASSIGN  20544<<ASSIGN  20547<<ASSIGN  20558<<ASSIGN  20558>>ASSIGN  20572>>IF      20581>>IF
     20587>>IF      20596>>IF      20605>>IF      20611>>IF      20625>>ASSIGN  20627>>ASSIGN  20633>>DOINDEX
     20649>>IF      20654>>ASSIGN  20661>>IF      20666>>ASSIGN  20673>>IF      20678>>ASSIGN  20696>>IF
     20703>>IF      20708>>ASSIGN  20713>>IF      20720>>IF      20725>>IF      20730>>ASSIGN  20735>>IF
     20742>>IF      20747>>ASSIGN  20752>>IF      20759>>IF      20765>>IF      20773>>IF      20783>>IF
     20789>>ASSIGN  20792>>IF      20796>>IF      20800>>IF      20805>>IF      20810>>IF      20815>>ASSIGN
     20818>>IF      20822>>IF      20826>>ASSIGN  20829>>IF      20833>>IF      20837>>ASSIGN  20840>>IF
     20844>>ASSIGN  20850<<ASSIGN  20850>>ASSIGN  20856<<ASSIGN  20856>>ASSIGN  20866<<ASSIGN  20866>>ASSIGN
VAL_CODE
     11749**DCL     20005>>ASSIGN
VAL_ERROR IN PROCEDURE SET_VALUE
     20869**PROC    20574--CALL    20583--CALL    20589--CALL    20598--CALL    20607--CALL    20613--CALL
     20650--CALL    20662--CALL    20674--CALL    20697--CALL    20704--CALL    20714--CALL    20721--CALL
     20727--CALL    20737--CALL    20744--CALL    20754--CALL    20761--CALL    20766--CALL    20774--CALL
     20784--CALL    20793--CALL    20797--CALL    20807--CALL    20812--CALL    20819--CALL    20823--CALL
     20830--CALL    20834--CALL    20841--CALL
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:500  
VEHLIST
     18156**DCL     18045--DCLINIT
VEHLIST.Q
     18157**DCL     18156--DCLINIT
VLR_SITEINFO
     18936**DCL     18921--DCLINIT
VLR_SITEINFO.CPU_TYPE#
     18940**DCL     19027>>IF      19027>>IF      19033>>IF
WAIT IN PROCEDURE EXEC_STORE
     21156**LABEL   21158--CALLALT
WORDS_AVAIL
     11811**DCL     19045<<ASSIGN  20336<<ASSIGN  20924>>DOWHILE 20926<<ASSIGN  20926>>ASSIGN  20930<<ASSIGN
     20930>>ASSIGN
WRITE_CNTRL_FPT
     18324**DCL     20639<>CALL    20682<>CALL    21215<>CALL
WRITE_CNTRL_FPT.BUF_.BOUND
     18324**DCL     19006<<ASSIGN
WRITE_CNTRL_FPT.BUF_.BUF$
     18326**DCL     19003<<ASSIGN  19006>>ASSIGN
WRITE_CNTRL_FPT.STATION_
     18326**DCL     18326--REDEF
WRITE_CNTRL_FPT.V
     18327**DCL     18324--DCLINIT
WRITE_CNTRL_FPT.V.DVBYTE.VFC#
     18333**DCL     18333--REDEF
WRITE_HEAD
     18812**DCL     20289<>CALL
WRITE_HEAD.STATION_
     18814**DCL     18814--REDEF
WRITE_HEAD.V
     18815**DCL     18812--DCLINIT
WRITE_HEAD.V.DVBYTE.VFC#
     18821**DCL     18821--REDEF
X$WRITE
     11075**DCL-ENT 19639--CALL    19721--CALL    19731--CALL    19732--CALL
XST$TIMEZONE
PL6.E3A0      #001=PCC$CONTROL File=PCC$CONTROL.:E05TSI                          WED 07/30/97 04:19 Page:501  
     16009**DCL-ENT 20537--CALL
XST_TIMEZONE
     16011**DCL     12384--DCLINIT
XTX$ADAPT
     11875**DCL-ENT 11954--DCLINIT 12290--DCLINIT
XUG$GETCMD
     16012**DCL-ENT 20534--CALL
XUG$INIT
     16013**DCL-ENT 19023--CALL
XUG_GETCMD
     12383**DCL     19023<>CALL    20534<>CALL
XUG_GETCMD.OUT$
     12388**DCL     12394--REDEF   20535>>ASSIGN
XUG_GETCMD.TEXT_
     12646**DCL     20533<<ASSIGN
XUG_INIT
     11979**DCL     19023<>CALL
XUR$ERRMSG
     15990**DCL-ENT 19105--CALL
XUR$GETCMD
     15988**DCL-ENT 19069--CALL
XUR$INIT
     15989**DCL-ENT 19019--CALL
XUR_INIT
     11880**DCL     19019<>CALL
XUR_INIT.WORKR_
     11894**DCL     11895--REDEF
