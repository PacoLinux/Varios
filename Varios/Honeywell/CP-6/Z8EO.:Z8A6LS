VERSION A06

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:1    
        1        1        /*M* Z8EO -- Procedure Division Utility Routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*===============*/
       10       10          Z8EO$NEW_SYMREF : PROC (NAME, LENGTH, RETURN_ST$);
       11       11        /*===============*/
       12       12
       13       13             /*I*
       14       14               NAME : Z8EO$NEW_SYMREF
       15       15               CALL : CALL Z8EO$NEW_SYMREF (SYMREF_NAME,
       16       16                                            SYMREF_NAME_LENGTH,
       17       17                                            RETURN_SYMREF_ST$);
       18       18               PURPOSE : To create a symref for a passed in name.
       19       19               DESCRIPTION : This procedure first searches for the DNT
       20       20                             entry for the symref.  This is done thru
       21       21                             Z8AH$NEW_DNT.  A dnt$ is returned.  Then
       22       22                             a search of the symrefs is done.  If one is
       23       23                             found it is returned.  If not, a new symref is
       24       24                             created and linked in the symref chain.
       25       25               INTERFACE : Z8AH$NEW_DNT
       26       26               INPUTS : NAME -- the symref name.
       27       27                        LENGTH -- the symref name length.
       28       28               OUTPUTS : RETURN_ST$ -- pointer to the symref we created.
       29       29             */
       30       30
       31       31             %EQU PHASE = 1;
       32       32
       33       33             %INCLUDE Z8A_DEFC;
       34      101             %INCLUDE Z8A_SUPP_MAC;
       35     2501             %INCLUDE Z8A_COMCOM;
       36     3151             %INCLUDE Z8A_DNT;
       37     3372             %INCLUDE Z8A_ST;
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:2    
       38     7031             %INCLUDE Z8A_TYPES;
       39     7205             %INCLUDE Z8A_LTS;
       40     9282
       41     9283             %INCLUDE Z8E_STACKS;
       42    11549             %INCLUDE Z8E_O1COM;
       43    12310
       44    12311    1        DCL Z8AH$NEW_DNT  ENTRY (3);
       45    12312
       46    12313    1        DCL NAME          CHAR (LENGTH); /* IN -- name of symref */
       47    12314    1        DCL LENGTH        SBIN;          /* IN -- length of name */
       48    12315    1        DCL RETURN_ST$    PTR;           /* OUT -- ptr to symref */
       49    12316
       50    12317             /* Local data */
       51    12318    1        DCL DNT$$         PTR;
       52    12319
       53    12320
       54    12321
       55    12322    1        CALL Z8AH$NEW_DNT (NAME, LENGTH, DNT$$);
       56    12323
       57    12324    1        RETURN_ST$ = COMCOM.SYMREF$;
       58    12325
       59    12326    2        DO WHILE (RETURN_ST$ ~= ADDR(NIL));
       60    12327    2          IF RETURN_ST$ -> ST.ID = %SYMREF_
       61    12328    2          AND RETURN_ST$ -> SYMREF_.DNT$ = DNT$$ THEN
       62    12329    2            RETURN;
       63    12330
       64    12331    2          RETURN_ST$ = RETURN_ST$ -> SYMREF_.NEXT;
       65    12332    2        END; /* While */
       66    12333
       67    12334             %NEW_SYMREF_ (@ST$  = RETURN_ST$,
       68    12335                           @R    = %EXT_PROGRAM,
       69    12336                           @DNT$ = DNT$$);
       70    12401
       71    12402    1        O1COM.LAST_SYMREF$ -> ST.NEXT = RETURN_ST$;
       72    12403    1        O1COM.LAST_SYMREF$ = RETURN_ST$;
       73    12404
       74    12405    1   END Z8EO$NEW_SYMREF;
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:3    
       75    12406        %EOD;

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:4    
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EO$NEW_SYMREF.

   Procedure Z8EO$NEW_SYMREF requires 110 words for executable code.
   Procedure Z8EO$NEW_SYMREF requires 12 words of local(AUTO) storage.

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:5    

 Object Unit name= Z8EO$NEW_SYMREF                            File name= Z8EO.:Z8A6TOU
 UTS= AUG 09 '97 12:24:05.24 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  DNT$
    2  LblCom even  none     5      5  DNT_
    3  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    4  LblCom even  none     1      1  DNT_OF_1$
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none     1      1  LTS$
    8  LblCom even  none     5      5  LTS_
    9  LblCom even  none    90    132  LEX_SYMBOL
   10  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   11  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   12  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   13   Proc  even  none   110    156  Z8EO$NEW_SYMREF
   14  RoData even  none     4      4  Z8EO$NEW_SYMREF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        3  Z8EO$NEW_SYMREF
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:6    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 Z8AH$NEW_DNT
         yes           Std       1 Z8AR$RESERVER
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                              O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:7    


        1        1        /*M* Z8EO -- Procedure Division Utility Routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8
        9        9        /*===============*/
       10       10          Z8EO$NEW_SYMREF : PROC (NAME, LENGTH, RETURN_ST$);

     10 13 000000   000000 700200 xent  Z8EO$NEW_SY* TSX0  ! X66_AUTO_3
        13 000001   000014 000003                    ZERO    12,3

       11       11        /*===============*/
       12       12
       13       13             /*I*
       14       14               NAME : Z8EO$NEW_SYMREF
       15       15               CALL : CALL Z8EO$NEW_SYMREF (SYMREF_NAME,
       16       16                                            SYMREF_NAME_LENGTH,
       17       17                                            RETURN_SYMREF_ST$);
       18       18               PURPOSE : To create a symref for a passed in name.
       19       19               DESCRIPTION : This procedure first searches for the DNT
       20       20                             entry for the symref.  This is done thru
       21       21                             Z8AH$NEW_DNT.  A dnt$ is returned.  Then
       22       22                             a search of the symrefs is done.  If one is
       23       23                             found it is returned.  If not, a new symref is
       24       24                             created and linked in the symref chain.
       25       25               INTERFACE : Z8AH$NEW_DNT
       26       26               INPUTS : NAME -- the symref name.
       27       27                        LENGTH -- the symref name length.
       28       28               OUTPUTS : RETURN_ST$ -- pointer to the symref we created.
       29       29             */
       30       30
       31       31             %EQU PHASE = 1;
       32       32
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:8    
       33       33             %INCLUDE Z8A_DEFC;
       34      101             %INCLUDE Z8A_SUPP_MAC;
       35     2501             %INCLUDE Z8A_COMCOM;
       36     3151             %INCLUDE Z8A_DNT;
       37     3372             %INCLUDE Z8A_ST;
       38     7031             %INCLUDE Z8A_TYPES;
       39     7205             %INCLUDE Z8A_LTS;
       40     9282
       41     9283             %INCLUDE Z8E_STACKS;
       42    11549             %INCLUDE Z8E_O1COM;
       43    12310
       44    12311    1        DCL Z8AH$NEW_DNT  ENTRY (3);
       45    12312
       46    12313    1        DCL NAME          CHAR (LENGTH); /* IN -- name of symref */
       47    12314    1        DCL LENGTH        SBIN;          /* IN -- length of name */
       48    12315    1        DCL RETURN_ST$    PTR;           /* OUT -- ptr to symref */
       49    12316
       50    12317             /* Local data */
       51    12318    1        DCL DNT$$         PTR;
       52    12319
       53    12320
       54    12321
       55    12322    1        CALL Z8AH$NEW_DNT (NAME, LENGTH, DNT$$);

  12322 13 000002   200006 630500                    EPPR0   DNT$$,,AUTO
        13 000003   200012 450500                    STP0    DNT$$+4,,AUTO
        13 000004   200004 236100                    LDQ     @LENGTH,,AUTO
        13 000005   200003 235100                    LDA     @NAME,,AUTO
        13 000006   200010 757100                    STAQ    DNT$$+2,,AUTO
        13 000007   200010 630500                    EPPR0   DNT$$+2,,AUTO
        13 000010   000000 631400 14                 EPPR1   0
        13 000011   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        13 000012   000000 011000                    NOP     0

       56    12323
       57    12324    1        RETURN_ST$ = COMCOM.SYMREF$;

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:9    
  12324 13 000013   000436 236000 xsym               LDQ     COMCOM+286
        13 000014   200005 470500                    LDP0    @RETURN_ST$,,AUTO
        13 000015   000000 756100                    STQ     0,,PR0

       58    12325
       59    12326    2        DO WHILE (RETURN_ST$ ~= ADDR(NIL));

  12326 13 000016   000032 710000 13                 TRA     s:12332

       60    12327    2          IF RETURN_ST$ -> ST.ID = %SYMREF_

  12327 13 000017   200005 470500                    LDP0    @RETURN_ST$,,AUTO
        13 000020   000000 471500                    LDP1    0,,PR0
        13 000021   100000 220100                    LDX0    0,,PR1
        13 000022   000772 100003                    CMPX0   506,DU
        13 000023   000030 601000 13                 TNZ     s:12331
        13 000024   100006 236100                    LDQ     6,,PR1
        13 000025   200006 116100                    CMPQ    DNT$$,,AUTO
        13 000026   000030 601000 13                 TNZ     s:12331

       61    12328    2          AND RETURN_ST$ -> SYMREF_.DNT$ = DNT$$ THEN
       62    12329    2            RETURN;

  12329 13 000027   000000 702200 xent               TSX2  ! X66_ARET

       63    12330
       64    12331    2          RETURN_ST$ = RETURN_ST$ -> SYMREF_.NEXT;

  12331 13 000030   100004 236100                    LDQ     4,,PR1
        13 000031   000000 756100                    STQ     0,,PR0

       65    12332    2        END; /* While */

  12332 13 000032   000001 116000 14                 CMPQ    1
        13 000033   000017 601000 13                 TNZ     s:12327

       66    12333
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:10   
       67    12334             %NEW_SYMREF_ (@ST$  = RETURN_ST$,
       68    12335                           @R    = %EXT_PROGRAM,
       69    12336                           @DNT$ = DNT$$);

  12340 13 000034   000002 236000 6                  LDQ     ST_+2
        13 000035   000013 036007                    ADLQ    11,DL
        13 000036   000003 116000 6                  CMPQ    ST_+3
        13 000037   000050 604000 13                 TMI     s:12342

  12341 13 000040   000003 236000 14                 LDQ     3
        13 000041   200010 756100                    STQ     DNT$$+2,,AUTO
        13 000042   200010 631500                    EPPR1   DNT$$+2,,AUTO
        13 000043   200011 451500                    STP1    DNT$$+3,,AUTO
        13 000044   200011 630500                    EPPR0   DNT$$+3,,AUTO
        13 000045   000002 631400 14                 EPPR1   2
        13 000046   000000 701000 xent               TSX1    Z8AR$RESERVER
        13 000047   000000 011000                    NOP     0

  12342 13 000050   000002 236000 6                  LDQ     ST_+2
        13 000051   000022 736000                    QLS     18
        13 000052   000001 036000 6                  ADLQ    ST_+1
        13 000053   200005 470500                    LDP0    @RETURN_ST$,,AUTO
        13 000054   000000 756100                    STQ     0,,PR0

  12343 13 000055   000013 236007                    LDQ     11,DL
        13 000056   000002 056000 6                  ASQ     ST_+2

  12346 13 000057   000000 471500                    LDP1    0,,PR0
        13 000060   000772 220003                    LDX0    506,DU
        13 000061   100000 740100                    STX0    0,,PR1

  12347 13 000062   000000 471500                    LDP1    0,,PR0
        13 000063   002000 236007                    LDQ     1024,DL
        13 000064   100000 552110                    STBQ    0,'10'O,PR1

  12348 13 000065   000000 471500                    LDP1    0,,PR0
        13 000066   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:11   
        13 000067   100000 552104                    STBQ    0,'04'O,PR1

  12349 13 000070   000000 471500                    LDP1    0,,PR0
        13 000071   000001 235007                    LDA     1,DL
        13 000072   100010 755100                    STA     8,,PR1

  12350 13 000073   000000 471500                    LDP1    0,,PR0
        13 000074   000020 221003                    LDX1    16,DU
        13 000075   100002 741100                    STX1    2,,PR1

  12351 13 000076   000000 471500                    LDP1    0,,PR0
        13 000077   000133 722000 xsym               LXL2    COMCOM+91
        13 000100   100002 442100                    SXL2    2,,PR1

  12352 13 000101   000000 471500                    LDP1    0,,PR0
        13 000102   000001 236000 14                 LDQ     1
        13 000103   100004 756100                    STQ     4,,PR1

  12353 13 000104   000000 471500                    LDP1    0,,PR0
        13 000105   100003 450100                    STZ     3,,PR1

  12355 13 000106   000000 471500                    LDP1    0,,PR0
        13 000107   000001 236007                    LDQ     1,DL
        13 000110   100003 256100                    ORSQ    3,,PR1

  12357 13 000111   000000 471500                    LDP1    0,,PR0
        13 000112   200006 236100                    LDQ     DNT$$,,AUTO
        13 000113   100006 756100                    STQ     6,,PR1

  12361 13 000114   000000 471500                    LDP1    0,,PR0
        13 000115   000001 236000 14                 LDQ     1
        13 000116   100012 756100                    STQ     10,,PR1

  12364 13 000117   000000 471500                    LDP1    0,,PR0
        13 000120   000057 236000 xsym               LDQ     O1COM+47
        13 000121   100011 756100                    STQ     9,,PR1

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:12   
  12365 13 000122   000057 236000 xsym               LDQ     O1COM+47
        13 000123   000001 116000 14                 CMPQ    1
        13 000124   000150 600000 13                 TZE     s:12402

  12369 13 000125   000057 471400 xsym               LDP1    O1COM+47
        13 000126   100001 473500                    LDP3    1,,PR1
        13 000127   300012 236100                    LDQ     10,,PR3
        13 000130   000001 116000 14                 CMPQ    1
        13 000131   000141 601000 13                 TNZ     s:12376

  12371 13 000132   000000 236100                    LDQ     0,,PR0
        13 000133   300011 756100                    STQ     9,,PR3

  12372 13 000134   000057 471400 xsym               LDP1    O1COM+47
        13 000135   100001 473500                    LDP3    1,,PR1
        13 000136   000000 236100                    LDQ     0,,PR0
        13 000137   300012 756100                    STQ     10,,PR3

  12373 13 000140   000150 710000 13                 TRA     s:12402

  12376 13 000141   300012 474500                    LDP4    10,,PR3
        13 000142   000000 236100                    LDQ     0,,PR0
        13 000143   400012 756100                    STQ     10,,PR4

  12377 13 000144   000057 471400 xsym               LDP1    O1COM+47
        13 000145   100001 473500                    LDP3    1,,PR1
        13 000146   000000 236100                    LDQ     0,,PR0
        13 000147   300012 756100                    STQ     10,,PR3

       70    12401
       71    12402    1        O1COM.LAST_SYMREF$ -> ST.NEXT = RETURN_ST$;

  12402 13 000150   000000 236100                    LDQ     0,,PR0
        13 000151   000052 471400 xsym               LDP1    O1COM+42
        13 000152   100004 756100                    STQ     4,,PR1

       72    12403    1        O1COM.LAST_SYMREF$ = RETURN_ST$;
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:13   

  12403 13 000153   000000 236100                    LDQ     0,,PR0
        13 000154   000052 756000 xsym               STQ     O1COM+42

       73    12404
       74    12405    1   END Z8EO$NEW_SYMREF;

  12405 13 000155   000000 702200 xent               TSX2  ! X66_ARET
       75    12406        %EOD;

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:14   
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EO$NEW_SYMREF.
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:15   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 002 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 003 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 004 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:16   
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

  ****  Section 007 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 008 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 009 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 010 LblCom CURRENT_LEX_SYMBOL$

PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:17   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 011 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 012 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @LENGTH                    3-0-0/w PTR         r     1 @NAME
     5-0-0/w PTR         r     1 @RETURN_ST$                6-0-0/w PTR         r     1 DNT$$
    *0-0-0/w SBIN        r     1 LENGTH                    *0-0-0/c ACHR        r     1 NAME
    *0-0-0/w PTR         r     1 RETURN_ST$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:18   
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)         1 ADD_STMT                   0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864)       1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(288)         1 BINARY_OP
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)        1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(288)         1 DELETE_STMT                0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(288)         1 DIVIDE_STMT
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w ASTR(180)   r     1 DNT                        0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
PL6.E3A0      #001=Z8EO$NEW_SYMREF File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:24 Page:19   
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC              1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)   r     1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(900)   r     1 PROC_SUPP
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)         1 SCALAR                     0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)   r     1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EO$NEW_SYMREF requires 110 words for executable code.
   Procedure Z8EO$NEW_SYMREF requires 12 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:20   
       76        1        /*T***********************************************************/
       77        2        /*T*                                                         */
       78        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       79        4        /*T*                                                         */
       80        5        /*T***********************************************************/
       81        6        /*===========*/
       82        7          Z8EO$USE:     PROC (TYPE, PTR$, USE_SECT$, LINE, COLUMN) ;
       83        8        /*===========*/
       84        9
       85       10        /*I*   NAME: Z8EO$USE
       86       11               CALL: CALL Z8EO$USE (%USE_TYPE_FILE, FILE_LTS$, USE_SECT$, KEY_WORD$) ;
       87       12            PURPOSE: Create the USE LTS item.
       88       13        DESCRIPTION: Keeps track of which USE procedures are valid for a
       89       14                     given procedure and type.  For example, a USE in program
       90       15                     "A" (which contains program "B") is not usable by "B"
       91       16                     unless the GLOBAL clause is used.
       92       17        */
       93       18
       94       19        %EQU PHASE = 1 ;
       95       20        %INCLUDE Z8A_DEFC;
       96       88        %INCLUDE Z8A_SUPP_MAC;
       97     2488        %INCLUDE Z8A_COMCOM;
       98     3138        %INCLUDE Z8A_ERR_NUMS;
       99     3902        %INCLUDE Z8E_STACKS;
      100     6168        %INCLUDE Z8E_O1COM;
      101     6929        %INCLUDE Z8A_ST;
      102    10588        %INCLUDE Z8A_LTS;
      103    12665        %INCLUDE Z8A_ETT;
      104    12966        %INCLUDE Z8A_ILL;
      105    13659        %INCLUDE Z8A_DNT;
      106    13880        %INCLUDE Z8A_TYPES;
      107    14054        %INCLUDE X9A_FAB;
      108    14241        %INCLUDE Z8E_MACROS ;
      109    14916        %INCLUDE Z8E_ILS_LIST ;
      110    15000        %INCLUDE Z8A_ILS ;
      111    15109
      112    15110    1   DCL  TYPE      UBIN WORD ; /* Arg #1 -- %USE_TYPE_FILE or ... */
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:21   
      113    15111    1   DCL  PTR$      PTR ;       /* Arg #2 -- FILE_LTS$ or whatever */
      114    15112    1   DCL  USE_SECT$ PTR ;       /* Arg #3 -- USE Section name */
      115    15113    1   DCL  LINE      UBIN;       /* Arg #4 -- Token USE line number */
      116    15114    1   DCL  COLUMN    UBIN;       /* Arg #5 -- Token USE column number */
      117    15115
      118    15116    1   DCL  CURRENT_USE$       PTR ;
      119    15117    1   DCL  CURRENT_USE_CHAIN$ PTR ;
      120    15118    1   DCL  FILE_LTS$          PTR ;
      121    15119    1   DCL  PROC_SUPP$         PTR ;      /* Proc Supp LTS item for current PROC */
      122    15120    1   DCL  PROC$              PTR ;
      123    15121    1   DCL  PTR_ETT$           PTR ;      /* triad for address of USE label */
      124    15122    1   DCL  SECTION$           PTR ;
      125    15123    1   DCL  TEMP$              PTR ;      /* BASE triad */
      126    15124    1   DCL  USE$               PTR ;
      127    15125    1   DCL  USE_LTS$           PTR ;      /* USE LTS item */
      128    15126    1   DCL  DNT$$              PTR ;
      129    15127    1   DCL  CURRENT_FAB$       PTR ;
      130    15128    1   DCL  CURRENT_TYPE       UBIN ;
      131    15129    1   DCL  FAB$               PTR ;
      132    15130    1   DCL  CONTAINING_PROC$   PTR ;
      133    15131    1   DCL  CONTAINING_FAB$    PTR ;
      134    15132    1   DCL  CONTAINING_USE_TYPE UBIN ;
      135    15133    1   DCL  CONTAINING_USE$    PTR ;
      136    15134    1   DCL  USE_CHAIN$         PTR ;
      137    15135    1   DCL  GLOB_INPUT_USE$    PTR STATIC ;
      138    15136    1   DCL  GLOB_IO_USE$       PTR STATIC ;
      139    15137    1   DCL  GLOB_OUTPUT_USE$   PTR STATIC ;
      140    15138    1   DCL  GLOB_EXTEND_USE$   PTR STATIC ;
      141    15139    1   DCL  GLOBAL_USE_SUPP_CHAIN$ PTR STATIC INIT(ADDR(NIL)) ;
      142    15140    1   DCL  PREV_USE_SUPP$     PTR ;
      143    15141    1   DCL  NIL_EPTR           EPTR CONSTANT INIT (ENTADDR (NIL)) ;
      144    15142    1   DCL  NIL_EPTR$          REDEF NIL_EPTR PTR ;
      145    15143    1   DCL  USE_SUPPS_MADE     BOOLEAN STATIC INIT (FALSE);
      146    15144
      147    15145         %DCL_AUTO_LX_ITEM (@NAME = SAVED_ILS_LIST) ;
      148    15149
      149    15150    1   DCL  Z8AE$ERROR                ENTRY (12) ;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:22   
      150    15151    1   DCL  Z8AF$NEW_BASE             ENTRY (3) ;
      151    15152    1   DCL  Z8AF$NEW_OFF              ENTRY (3) ;
      152    15153    1   DCL  Z8AH$SEARCH_              ENTRY ;
      153    15154    1   DCL  Z8AT$CREATE_TEMPORARY     ENTRY (2) ;
      154    15155    1   DCL  Z8CU$BUILD_AND_LINK       ENTRY (6) ;
      155    15156
      156    15157        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:23   
      157    15158         /* Start of Z8EO$USE */
      158    15159
      159    15160    1    PROC_SUPP$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ;
      160    15161         %NEW_USE_LTS (@POINTER     = USE_LTS$,
      161    15162                       @TYPE        = TYPE,
      162    15163                       @PROC_CHAIN$ = COMCOM.USE_PROC_CHAIN$,
      163    15164                       @LINE        = LINE,
      164    15165                       @COLUMN      = COLUMN,
      165    15166                       @LINK$       = "PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$",
      166    15167                       @PROC_LABEL$ = USE_SECT$) ;
      167    15273
      168    15274    1    COMCOM.USE_PROC_CHAIN$ = USE_LTS$ ;
      169    15275
      170    15276    2    DO CASE (TYPE) ;
      171    15277
      172    15278    2      CASE (%USE_TYPE_FILE) ;
      173    15279
      174    15280             /* Generate Moves to be used at ENTRY time */
      175    15281    2        CALL Z8AF$NEW_BASE (PTR$ -> FILE_LTS.FAB$,      /* LOP */
      176    15282    2                            ADDR(NIL),                  /* ROP */
      177    15283    2                            ETT$) ;                  /* Result */
      178    15284    2        CALL Z8AF$NEW_OFF (ETT$,                        /* LOP */
      179    15285    2                           %USE_PROC_OFFSET,         /* ROPCON */
      180    15286    2                           ETT$) ;                   /* Result */
      181    15287    2        ETT$ -> ETT.OFFSET.TYPE = %WORD_;
      182    15288    2        USE_LTS$ -> USE.TO$ = ETT$ ;
      183    15289
      184    15290    2        IF O1COM.CURRENT_PROC$ -> PROC_.FATHER = ADDR(NIL) AND
      185    15291    2          ((NOT COMCOM.OB.SUB AND
      186    15292    2            (O1COM.CURRENT_PROC$ -> PROC_.PROC_DEF$ -> PROC_DEF.ARGLIST$ = ADDR (NIL)
             15292                     OR
      187    15293    2             COMCOM.OB.MAIN_PROG)) OR
      188    15294    3           (NOT PTR$ -> FILE_LTS.B.EXTERNAL AND NOT PTR$ -> FILE_LTS.B.BLOCK)) THEN DO;
      189    15295    3          PTR$ -> FILE_LTS.USE_PROC_LABEL$ = USE_SECT$ ;
      190    15296    3          CALL CREATE_AND_PRESET_A_PTR (USE_SECT$,  /* in:  USE Section */
      191    15297    3                                        PTR_ETT$) ; /* out: ETT item */
      192    15298
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:24   
      193    15299    3          USE_LTS$ -> USE.INIT_LABEL_BASE$ = PTR_ETT$ ;
      194    15300    3        END;
      195    15301    3        ELSE DO ; /* Current proc is an internal procedure */
      196    15302    3          CALL SAVE_AND_MOVE_LABEL (ETT$, USE_SECT$) ;
      197    15303    3        END ; /* Internal procedure */
      198    15304    2      CASE (%USE_TYPE_INPUT, %USE_TYPE_OUTPUT, %USE_TYPE_IO, %USE_TYPE_EXTEND) ;
      199    15305
      200    15306    2        CALL MAKE_OFF (TYPE, ETT$);
      201    15307
      202    15308    2        USE_LTS$ -> USE.TO$ = ETT$ ;
      203    15309    3        IF O1COM.CURRENT_PROC$ -> PROC_.FATHER = ADDR(NIL) THEN DO;
      204    15310    3          CALL CREATE_AND_PRESET_A_PTR (USE_SECT$,  /* in:  USE Section */
      205    15311    3                                        PTR_ETT$) ; /* out: ETT item */
      206    15312
      207    15313    3          USE_LTS$ -> USE.INIT_LABEL_BASE$ = PTR_ETT$ ;
      208    15314    3        END;
      209    15315    2        ELSE
      210    15316    2          CALL SAVE_AND_MOVE_LABEL (ETT$, USE_SECT$) ;
      211    15317    3        DO CASE (TYPE);
      212    15318    3          CASE (%USE_TYPE_INPUT);
      213    15319    3            PROC_SUPP$ -> PROC_SUPP.USE_INPUT_LABEL$ = USE_SECT$;
      214    15320    3          CASE (%USE_TYPE_OUTPUT);
      215    15321    3            PROC_SUPP$ -> PROC_SUPP.USE_OUTPUT_LABEL$ = USE_SECT$;
      216    15322    3          CASE (%USE_TYPE_IO);
      217    15323    3            PROC_SUPP$ -> PROC_SUPP.USE_IO_LABEL$ = USE_SECT$;
      218    15324    3          CASE (%USE_TYPE_EXTEND);
      219    15325    3            PROC_SUPP$ -> PROC_SUPP.USE_EXTEND_LABEL$ = USE_SECT$;
      220    15326    3        END;
      221    15327
      222    15328    2    END ; /* Case of USE TYPE */
      223    15329    1    PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ = USE_LTS$ ;
      224    15330
      225    15331    1    RETURN ;
      226    15332
      227    15333        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:25   
      228    15334        /*========*/
      229    15335    1     MAKE_OFF: PROC (TYPE, ETT$);
      230    15336        /*========*/
      231    15337        /*   NAME: MAKE_OFF
      232    15338             CALL: CALL MAKE_OFF (TYPE, ETT$);
      233    15339            INPUT: TYPE -- USE procedure type.
      234    15340           OUTPUT: ETT$ -- Pointer to BASE or OFF triad for pointer to USE proc
      235    15341                           for this I/O mode.
      236    15342          PURPOSE: Generate a tree such that it can be used for references that
      237    15343                   are needed to save/restore pointers to USE procedure for I/O
      238    15344                   nodes such as EXTEND.
      239    15345        */
      240    15346    2   DCL TYPE UBIN;
      241    15347    2   DCL ETT$ PTR;
      242    15348    2        IF COMCOM.USE_BLOCK_ST$ = ADDR(NIL) THEN
      243    15349    3          DO;
      244    15350    3            LEX_SYMBOL.SIZE = 4;
      245    15351    3            LEX_SYMBOL.SYMBOL = 'FILE';
      246    15352    3            CALL Z8AH$SEARCH_;
      247    15353    3            DNT$$ = DNT$;
      248    15354    3            CALL Z8CU$BUILD_AND_LINK (DNT$$, 1, %TYA, 'USE_BLOCK', 9, COMCOM.
             15354                     USE_BLOCK_ST$);
      249    15355    3            COMCOM.USE_BLOCK_ST$ -> SCALAR.ADSC.N = 16;
      250    15356
      251    15357    3          END;
      252    15358    2        CALL Z8AF$NEW_BASE (COMCOM.USE_BLOCK_ST$,
      253    15359    2                            ADDR(NIL),
      254    15360    2                            ETT$);
      255    15361    3        DO CASE (TYPE) ;
      256    15362    3          CASE (%USE_TYPE_OUTPUT) ;
      257    15363    3            CALL Z8AF$NEW_OFF (ETT$, 4, ETT$) ;
      258    15364    3          CASE (%USE_TYPE_IO) ;
      259    15365    3            CALL Z8AF$NEW_OFF (ETT$, 8, ETT$) ;
      260    15366    3          CASE (%USE_TYPE_EXTEND) ;
      261    15367    3            CALL Z8AF$NEW_OFF (ETT$, 12, ETT$) ;
      262    15368    3        END ; /* CASE */
      263    15369    2   END MAKE_OFF;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:26   
      264    15370        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:27   
      265    15371        /*===================*/
      266    15372    1     SAVE_AND_MOVE_LABEL: PROC (TO$, USE_SECT$) ;
      267    15373        /*===================*/
      268    15374
      269    15375        /*I*   NAME: SAVE_AND_MOVE_LABEL
      270    15376               CALL: CALL SAVE_AND_MOVE_LABEL (FAB+n or RW.USE$ or ..., USE_SECT$);
      271    15377            PURPOSE: Generate -- MOVE FAB+n TO Temp
      272    15378                                 MOVE Use_Section TO FAB+n
      273    15379        */
      274    15380
      275    15381    2    DCL  TO$       PTR ;   /* Input arg -- OFF or BASE triad    */
      276    15382    2    DCL  USE_SECT$ PTR ;   /* Input arg -- SECTION or ADDR(NIL) */
      277    15383
      278    15384    2    ADDR (SAVED_ILS_LIST) -> ILS_LIST = O1COM.ILS_LIST ; /* Save ILS_LIST */
      279    15385
      280    15386         %INIT_ILS_LIST (@POINTER = "ADDR(O1COM.ILS_LIST)") ;
      281    15394
      282    15395    2    CALL MOVE_LABEL (TO$, USE_SECT$, USE_LTS$) ;
      283    15396
      284    15397    2    USE_LTS$ -> USE.ILS_LIST = O1COM.ILS_LIST ;
      285    15398    2    O1COM.ILS_LIST = ADDR(SAVED_ILS_LIST) -> ILS_LIST ;
      286    15399
      287    15400    2    RETURN ;
      288    15401
      289    15402    2   END SAVE_AND_MOVE_LABEL ;
      290    15403
      291    15404        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:28   
      292    15405        /*===================*/
      293    15406    1        MOVE_LABEL      : PROC (TO$, USE_SECT$, USE_LTS$) ;
      294    15407        /*===================*/
      295    15408
      296    15409        /*I*   NAME: MOVE_LABEL
      297    15410               CALL: CALL MOVE_LABEL (FAB+n or RW.USE$ or ..., USE_SECT$, USE_LTS$);
      298    15411            PURPOSE: Generate -- MOVE FAB+n TO Temp
      299    15412                                 MOVE Use_Section TO FAB+n
      300    15413        */
      301    15414
      302    15415    2    DCL  TO$       PTR ;   /* Input arg -- OFF or BASE triad    */
      303    15416    2    DCL  USE_SECT$ PTR ;   /* Input arg -- SECTION or ADDR(NIL) */
      304    15417    2    DCL  USE_LTS$  PTR ;   /* Input arg -- Pointer to USE LTS item */
      305    15418
      306    15419    2    CALL Z8AT$CREATE_TEMPORARY (%SCALAR, TEMP$) ;
      307    15420    2    CALL Z8AF$NEW_BASE (TEMP$, ADDR(NIL), TEMP$) ;
      308    15421
      309    15422         %NEW_ILL (@ID  = %MVII,              /* Move current ptr to a temp */
      310    15423                   @LOP = TEMP$,
      311    15424                   @ROP = TO$) ;              /* current ptr (FAB+n, ... ) */
      312    15803
      313    15804    3    IF USE_LTS$ -> USE.INIT_LABEL_BASE$ = ADDR(NIL) THEN DO ;
      314    15805    3      CALL CREATE_AND_PRESET_A_PTR (USE_SECT$,  /* in:  USE Section */
      315    15806    3                                    PTR_ETT$) ; /* out: ETT item */
      316    15807
      317    15808    3      USE_LTS$ -> USE.INIT_LABEL_BASE$ = PTR_ETT$ ;
      318    15809    3    END ;
      319    15810
      320    15811         %NEW_ILL (@ID  = %MVII,     /* Move in a new current ptr */
      321    15812                   @LOP = TO$,       /* FAB+n, REPORT.USE$, ...   */
      322    15813                   @ROP = USE_LTS$ -> USE.INIT_LABEL_BASE$) ;
      323    16192
      324    16193    2    PROC_SUPP$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ;
      325    16194         %NEW_IO_RESTORE_CHAIN (@POINTER = LTS$,
      326    16195                                @RESTORE = TEMP$,
      327    16196                                @TO      = TO$,
      328    16197                                @BASE    = USE_LTS$ -> USE.INIT_LABEL_BASE$,
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:29   
      329    16198                                @NEXT    = "PROC_SUPP$ -> PROC_SUPP.IO_RESTORE_CHAIN$") ;
      330    16293    2    PROC_SUPP$ -> PROC_SUPP.IO_RESTORE_CHAIN$ = LTS$ ;
      331    16294    2    RETURN ;
      332    16295
      333    16296    2   END MOVE_LABEL ;
      334    16297
      335    16298        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:30   
      336    16299        /*===============*/
      337    16300    1     MOVE_MODE_LABEL: PROC (USE$);
      338    16301        /*===============*/
      339    16302        /*I*   NAME: MOVE_MODE_LABEL
      340    16303               CALL: CALL MOVE_MODE_LABEL (USE$);
      341    16304              INPUT: USE$ -- Pointer to USE proc for an I/O mode.
      342    16305            PURPOSE: If USE$ is not nil and the USE proc it points to is not in the
      343    16306                     current program then generate the needed moves to activate it.
      344    16307        */
      345    16308    2   DCL USE$ PTR;
      346    16309          /**/
      347    16310    2     IF USE$ ~= ADDR(NIL) THEN
      348    16311    2       IF USE$ -> USE.PROC_LABEL$ -> SECTION.PROC$ ~= O1COM.CURRENT_PROC$ THEN
      349    16312    2         CALL MOVE_LABEL (USE$ -> USE.TO$, USE$ -> USE.PROC_LABEL$, USE$);
      350    16313    2   END MOVE_MODE_LABEL;
      351    16314        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:31   
      352    16315        /*=======================*/
      353    16316    1     CREATE_AND_PRESET_A_PTR: PROC (ST$$, ETT$$) ;
      354    16317        /*=======================*/
      355    16318
      356    16319    2    DCL  ST$$     PTR ; /* in:  an ST item (SECTION or NIL)  */
      357    16320    2    DCL  ETT$$    PTR ; /* out: an ETT item (BASE?)          */
      358    16321
      359    16322    2    CALL Z8AT$CREATE_TEMPORARY (%SCALAR, ETT$$) ;
      360    16323
      361    16324         %NEW_ILL (@ID     = %PTR_SET,
      362    16325                   @LOP    = ETT$$,
      363    16326                   @ROP    = ST$$,
      364    16327                   @OFFSET = 0) ;
      365    16706
      366    16707    2    CALL Z8AF$NEW_BASE (ETT$$, ADDR(NIL), ETT$$) ;
      367    16708
      368    16709    2    RETURN ;
      369    16710
      370    16711    2   END CREATE_AND_PRESET_A_PTR ;
      371    16712
      372    16713        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:32   
      373    16714        /*===========*/
      374    16715    1     IO_MODE_USE: PROC (USE$, USE_TYPE, DO_MOVE);
      375    16716        /*===========*/
      376    16717        /*I*   NAME: IO_MODE_USE
      377    16718               CALL: CALL IO_MODE_USE (USE$, USE_TYPE, DO_MOVE);
      378    16719              INPUT: USE$ -- Pointer to locally defined USE proc if any, else
      379    16720                             GLOBAL one, for I/O mode.
      380    16721                     USE_TYPE -- Identifier for mode, e.g., %USE_TYPE_IO.
      381    16722                     DO_MOVE -- TRUE if need to generate code to set USE pointer.
      382    16723            PURPOSE: Set up local USE LTS item for GLOBAL USE proc for an I/O mode.
      383    16724        */
      384    16725    2   DCL USE$ PTR;
      385    16726    2   DCL USE_TYPE UBIN;
      386    16727    2   DCL DO_MOVE BIT(1) ALIGNED;
      387    16728    3     IF USE$ = ADDR(NIL) THEN DO;
      388    16729    3       CALL MAKE_OFF (USE_TYPE, ETT$);
      389    16730            %NEW_USE_LTS (@POINTER = USE_LTS$,
      390    16731                          @TYPE = %USE_TYPE_NIL,
      391    16732                          @TO$ = ETT$,
      392    16733                          @LINK$ =
             16733                             O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             16733                              );
      393    16839    3       CALL CREATE_AND_PRESET_A_PTR (ENTADDR(NIL), USE_LTS$ -> USE.INIT_LABEL_BASE$);
      394    16840    3     END;
      395    16841    2     ELSE IF USE$ -> USE.PROC_LABEL$ -> SECTION.PROC$ = O1COM.CURRENT_PROC$
      396    16842    2       THEN RETURN;
      397    16843    3     ELSE DO;
      398    16844            %NEW_USE_LTS (@POINTER = USE_LTS$,
      399    16845                          @TYPE = USE_TYPE,
      400    16846                          @PROC_CHAIN$ = COMCOM.USE_PROC_CHAIN$,
      401    16847                          @LINK$ =
             16847                             O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             16847                              ,
      402    16848                          @INIT_LABEL_BASE$ = USE$ -> USE.INIT_LABEL_BASE$,
      403    16849                          @TO$ = USE$ -> USE.TO$,
      404    16850                          @PROC_LABEL$ = USE$ -> USE.PROC_LABEL$);
      405    16956    3       COMCOM.USE_PROC_CHAIN$ = USE_LTS$;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:33   
      406    16957    3       IF DO_MOVE THEN
      407    16958    3         CALL MOVE_LABEL (USE$ -> USE.TO$, USE$ -> USE.PROC_LABEL$, USE_LTS$);
      408    16959    3     END;
      409    16960    2     O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ = USE_LTS$;
      410    16961    2   END IO_MODE_USE;
      411    16962        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:34   
      412    16963        /*==============*/
      413    16964    1     MAKE_USE_SUPPS: PROC(IN_PTR$, OUT_PTR$, IO_PTR$, EXT_PTR$);
      414    16965        /*==============*/
      415    16966        /*I*   NAME: MAKE_USE_SUPPS
      416    16967               CALL: CALL MAKE_USE_SUPPS (IN_PTR$, OUT_PTR$, IO_PTR$, EXT_PTR$);
      417    16968             OUTPUT: IN_PTR$ -- Pointer to entry label for USE proc for INPUT, if the
      418    16969                                current program contains one or if there is a GLOBAL
      419    16970                                USE proc that has this program in its scope.
      420    16971                     OUT_PTR$ -- Same for OUTPUT.
      421    16972                     IO_PTR$ -- Same for IO.
      422    16973                     EXT_PTR$ -- Same for EXTEND.
      423    16974            PURPOSE: Build chain of USE_SUPP items for all GLOBAL files for which the
      424    16975                     current program does not contain any USE proc. Make sure that for
      425    16976                     each GLOBAL USE proc that has the current program in its range,
      426    16977                     the current program has an entry in its USE chain; if there is none
      427    16978                     for a particular file, then insert a null USE LTS item. Set
      428    16979                     IN_PTR$, etc., as appropriate.
      429    16980        */
      430    16981    2   DCL IN_PTR$ PTR;
      431    16982    2   DCL OUT_PTR$ PTR;
      432    16983    2   DCL IO_PTR$ PTR;
      433    16984    2   DCL EXT_PTR$ PTR;
      434    16985    2     IN_PTR$ = ADDR(NIL);
      435    16986    2     IO_PTR$ = ADDR(NIL);
      436    16987    2     OUT_PTR$ = ADDR(NIL);
      437    16988    2     EXT_PTR$ = ADDR(NIL);
      438    16989    2     GLOBAL_USE_SUPP_CHAIN$ = ADDR(NIL);
      439    16990    2     FILE_LTS$ = COMCOM.FILE_LTS_CHAIN$;
      440    16991    3     DO WHILE FILE_LTS$ ~= ADDR(NIL);
      441    16992    3       IF FILE_LTS$ -> FILE_LTS.B.GLOBAL THEN
      442    16993    4   CHECK_GLOBAL_FILE: DO;
      443    16994    4           PROC$ = FILE_LTS$ -> FILE_LTS.ST$ -> FD.PROC$;
      444    16995    4           CONTAINING_PROC$ = O1COM.CURRENT_PROC$ -> PROC_.FATHER;
      445    16996    5   ACCESSIBLE_HERE: DO;
      446    16997    6             DO WHILE CONTAINING_PROC$ ~= ADDR(NIL);
      447    16998    6               IF CONTAINING_PROC$ = PROC$ THEN EXIT ACCESSIBLE_HERE;
      448    16999    6               CONTAINING_PROC$ = CONTAINING_PROC$ -> PROC_.FATHER;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:35   
      449    17000    6             END;
      450    17001    5             EXIT CHECK_GLOBAL_FILE;
      451    17002    5           END; /* ACCESSIBLE_HERE */
      452    17003                %NEW_USE_SUPP (@POINTER = TEMP$,
      453    17004                               @LINK$ = GLOBAL_USE_SUPP_CHAIN$,
      454    17005                               @FILE_LTS$ = FILE_LTS$);
      455    17105    4           GLOBAL_USE_SUPP_CHAIN$ = TEMP$;
      456    17106    4         END; /* CHECK_GLOBAL_FILE */
      457    17107    3       FILE_LTS$ = FILE_LTS$ -> FILE_LTS.FILE_LTS_CHAIN$;
      458    17108    3     END; /* WHILE */
      459    17109          /* Chain of GLOBAL files complete */
      460    17110
      461    17111    2     USE$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;
      462    17112    3     DO WHILE USE$ ~= ADDR(NIL);
      463    17113    4       DO CASE (USE$ -> USE.TYPE);
      464    17114    4         CASE (%USE_TYPE_FILE);
      465    17115                %FISH (TRIAD = USE$ -> USE.TO$, RTN = FAB$);
      466    17123    4           PREV_USE_SUPP$ = ADDR(NIL);
      467    17124    4           TEMP$ = GLOBAL_USE_SUPP_CHAIN$;
      468    17125    5           DO WHILE TEMP$ ~= ADDR(NIL);
      469    17126    6             IF FAB$ = TEMP$ -> USE_SUPP.FILE_LTS$ -> FILE_LTS.FAB$ THEN DO;
      470    17127    6               IF PREV_USE_SUPP$ = ADDR(NIL)
      471    17128    6                 THEN GLOBAL_USE_SUPP_CHAIN$ = TEMP$ -> USE_SUPP.LINK$;
      472    17129    6                 ELSE PREV_USE_SUPP$ -> USE_SUPP.LINK$ = TEMP$ -> USE_SUPP.LINK$;
      473    17130    6               TEMP$ = ADDR(NIL); /* Local USE proc - delink file from chain */
      474    17131    6             END;
      475    17132    6             ELSE DO;
      476    17133    6               PREV_USE_SUPP$ = TEMP$;
      477    17134    6               TEMP$ = TEMP$ -> USE_SUPP.LINK$;
      478    17135    6             END;
      479    17136    5           END; /* WHILE */
      480    17137    4         CASE (%USE_TYPE_INPUT);
      481    17138    4           IN_PTR$ = USE$;
      482    17139    4         CASE (%USE_TYPE_IO);
      483    17140    4           IO_PTR$ = USE$;
      484    17141    4         CASE (%USE_TYPE_OUTPUT);
      485    17142    4           OUT_PTR$ = USE$;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:36   
      486    17143    4         CASE (%USE_TYPE_EXTEND);
      487    17144    4           EXT_PTR$ = USE$;
      488    17145    4       END; /* CASE */
      489    17146    3       USE$ = USE$ -> USE.LINK$;
      490    17147    3     END; /* WHILE */
      491    17148
      492    17149    2     CONTAINING_PROC$ = O1COM.CURRENT_PROC$ -> PROC_.FATHER;
      493    17150    3     DO WHILE CONTAINING_PROC$ ~= ADDR(NIL);
      494    17151    3       USE$ = CONTAINING_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;
      495    17152    4       DO WHILE USE$ ~= ADDR(NIL);
      496    17153    4         IF USE$ -> USE.TYPE ~= %USE_TYPE_NIL AND
      497    17154    4             USE$ -> USE.PROC_LABEL$ -> SECTION.B.USE_GLOBAL THEN
      498    17155    5           DO CASE (USE$ -> USE.TYPE);
      499    17156    5             CASE (%USE_TYPE_FILE);
      500    17157                    %FISH (TRIAD = USE$ -> USE.TO$, RTN =FAB$);
      501    17165    5               TEMP$ = GLOBAL_USE_SUPP_CHAIN$;
      502    17166    6               DO WHILE TEMP$ ~= ADDR(NIL);
      503    17167    6                 IF TEMP$ -> USE_SUPP.PROC_LABEL_EPTR = ENTADDR(NIL) AND
      504    17168    6                     TEMP$ -> USE_SUPP.FILE_LTS$ -> FILE_LTS.FAB$ = FAB$ THEN
      505    17169    7                   DO;
      506    17170    7                     TEMP$ -> USE_SUPP.PROC_LABEL$ = USE$ -> USE.PROC_LABEL$;
      507    17171    7                     TEMP$ -> USE_SUPP.TO$ = USE$ -> USE.TO$;
      508    17172    7                     TEMP$ -> USE_SUPP.INIT_LABEL_BASE$ = USE$ -> USE.INIT_LABEL_BASE$;
      509    17173    7                     TEMP$ = ADDR(NIL);
      510    17174    7                   END;
      511    17175    6                 ELSE TEMP$ = TEMP$ -> USE_SUPP.LINK$;
      512    17176    6               END;
      513    17177    5             CASE (%USE_TYPE_INPUT);
      514    17178    5               IF IN_PTR$ = ADDR(NIL) THEN
      515    17179    5                 IN_PTR$ = USE$;
      516    17180    5             CASE (%USE_TYPE_IO);
      517    17181    5               IF IO_PTR$ = ADDR(NIL) THEN
      518    17182    5                 IO_PTR$ = USE$;
      519    17183    5             CASE (%USE_TYPE_OUTPUT);
      520    17184    5               IF OUT_PTR$ = ADDR(NIL) THEN
      521    17185    5                 OUT_PTR$ = USE$;
      522    17186    5             CASE (%USE_TYPE_EXTEND);
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:37   
      523    17187    5               IF EXT_PTR$ = ADDR(NIL) THEN
      524    17188    5                 EXT_PTR$ = USE$;
      525    17189    5           END; /* CASE */
      526    17190    4         USE$ = USE$ -> USE.LINK$;
      527    17191    4       END; /* WHILE */
      528    17192
      529    17193    3       CONTAINING_PROC$ = CONTAINING_PROC$ -> PROC_.FATHER;
      530    17194    3     END; /* WHILE */
      531    17195
      532    17196    2     TEMP$ = GLOBAL_USE_SUPP_CHAIN$;
      533    17197    3     DO WHILE TEMP$ ~= ADDR(NIL);
      534    17198    4       IF TEMP$ -> USE_SUPP.PROC_LABEL_EPTR = ENTADDR(NIL) THEN DO;
      535    17199    4         USE_CHAIN$ = ADDR(NIL);
      536    17200    4         CONTAINING_USE_TYPE = %USE_TYPE_NIL;
      537    17201    4         CALL Z8AF$NEW_BASE (TEMP$ -> USE_SUPP.FILE_LTS$
      538    17202    4                             -> FILE_LTS.FAB$,           /* LOP */
      539    17203    4                             ADDR(NIL),                  /* ROP */
      540    17204    4                             ETT$) ;                  /* Result */
      541    17205    4         CALL Z8AF$NEW_OFF (ETT$,                        /* LOP */
      542    17206    4                            %USE_PROC_OFFSET,         /* ROPCON */
      543    17207    4                            ETT$) ;                   /* Result */
      544    17208    4         ETT$ -> ETT.OFFSET.TYPE = %WORD_;
      545    17209    4         TEMP$ -> USE_SUPP.TO$ = ETT$;
      546    17210    4         CALL CREATE_AND_PRESET_A_PTR (ENTADDR(NIL), PTR_ETT$);
      547    17211    4       END;
      548    17212    4       ELSE DO; /* GLOBAL USE found. Reenable it. */
      549    17213    4         USE_CHAIN$ = COMCOM.USE_PROC_CHAIN$;
      550    17214    4         PTR_ETT$ = TEMP$ -> USE_SUPP.INIT_LABEL_BASE$;
      551    17215    4         CONTAINING_USE_TYPE = %USE_TYPE_FILE;
      552    17216    4       END;
      553    17217            %NEW_USE_LTS (@POINTER = USE_LTS$,
      554    17218                          @TYPE = CONTAINING_USE_TYPE,
      555    17219                          @PROC_CHAIN$ = USE_CHAIN$,
      556    17220                          @LINK$ =
             17220                             O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             17220                              ,
      557    17221                          @TO$ = TEMP$ -> USE_SUPP.TO$,
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:38   
      558    17222                          @INIT_LABEL_BASE$ = PTR_ETT$,
      559    17223                          @PROC_LABEL$ = TEMP$ -> USE_SUPP.PROC_LABEL$);
      560    17329    3       O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ = USE_LTS$;
      561    17330    3       IF USE_CHAIN$ ~= ADDR(NIL) THEN
      562    17331    3         COMCOM.USE_PROC_CHAIN$ = USE_LTS$;
      563    17332    3       TEMP$ -> USE_SUPP.USE$ = USE_LTS$;
      564    17333    3       TEMP$ = TEMP$ -> USE_SUPP.LINK$;
      565    17334    3     END; /* WHILE */
      566    17335    2     USE_SUPPS_MADE = TRUE;
      567    17336    2   END MAKE_USE_SUPPS;
      568    17337        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:39   
      569    17338        /*=============*/
      570    17339    1     Z8EO$USE_SUPP: ENTRY;
      571    17340        /*=============*/
      572    17341    1     CALL MAKE_USE_SUPPS (GLOB_INPUT_USE$, GLOB_OUTPUT_USE$, GLOB_IO_USE$,
             17341              GLOB_EXTEND_USE$);
      573    17342    1     CALL IO_MODE_USE (GLOB_INPUT_USE$, %USE_TYPE_INPUT, FALSE);
      574    17343    1     CALL IO_MODE_USE (GLOB_IO_USE$, %USE_TYPE_IO, FALSE);
      575    17344    1     CALL IO_MODE_USE (GLOB_OUTPUT_USE$, %USE_TYPE_OUTPUT, FALSE);
      576    17345    1     CALL IO_MODE_USE (GLOB_EXTEND_USE$, %USE_TYPE_EXTEND, FALSE);
      577    17346    1     RETURN;
      578    17347
      579    17348        /*=======================*/
      580    17349    1     Z8EO$END_DECLARATIVES:   ENTRY ;
      581    17350        /*=======================*/
      582    17351
      583    17352    1     CURRENT_USE_CHAIN$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$
      584    17353    1                          -> PROC_SUPP.USE_CHAIN$ ;
      585    17354
      586    17355          /* Link thru USE items and append ILS pieces to O1COM.ILS_LIST */
      587    17356
      588    17357    1     CURRENT_USE$ = CURRENT_USE_CHAIN$ ;
      589    17358
      590    17359    2     DO WHILE (CURRENT_USE$ ~= ADDR(NIL)) ;
      591    17360
      592    17361    3       IF ADDR (CURRENT_USE$ -> USE.ILS_LIST) -> ILS_LIST.HEAD$ ~= ADDR(NIL) THEN DO ;
      593    17362              %APPEND_ILS_LIST (@FROM$ = "ADDR(CURRENT_USE$ -> USE.ILS_LIST)",
      594    17363                                @TO$   = "ADDR(O1COM.ILS_LIST)") ;
      595    17380    3       END ; /* A USE ILS_LIST exists */
      596    17381    2       CURRENT_USE$ = CURRENT_USE$ -> USE.LINK$ ;
      597    17382
      598    17383    2     END ; /* Do while linking thru the USE chain */
      599    17384
      600    17385    1     GOTO NO_DECLARATIVES_START ;
      601    17386
      602    17387        /*====================*/
      603    17388    1     Z8EO$NO_DECLARATIVES: ENTRY ;
      604    17389        /*====================*/
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:40   
      605    17390
      606    17391    1     CURRENT_USE_CHAIN$ = ADDR(NIL) ;
      607    17392
      608    17393    1   NO_DECLARATIVES_START:
      609    17394    2     IF O1COM.CURRENT_PROC$ -> PROC_.B.COMMON THEN DO;
      610    17395          /* For a COMMON program there is in general no way to discern who the caller
      611    17396             will be. Therefore each GLOBAL file and each I/O mode for which the current
      612    17397             program does not have any USE procedure, needs to have the USE procedure
      613    17398             pointer set to point to the GLOBAL USE procedure if one exists or nil
      614    17399             otherwise. */
      615    17400    3       IF NOT USE_SUPPS_MADE THEN DO;
      616    17401    3         CALL MAKE_USE_SUPPS (GLOB_INPUT_USE$, GLOB_OUTPUT_USE$, GLOB_IO_USE$,
             17401                  GLOB_EXTEND_USE$);
      617    17402    3         CALL IO_MODE_USE (GLOB_INPUT_USE$, %USE_TYPE_INPUT, TRUE);
      618    17403    3         CALL IO_MODE_USE (GLOB_IO_USE$, %USE_TYPE_IO, TRUE);
      619    17404    3         CALL IO_MODE_USE (GLOB_OUTPUT_USE$, %USE_TYPE_OUTPUT, TRUE);
      620    17405    3         CALL IO_MODE_USE (GLOB_EXTEND_USE$, %USE_TYPE_EXTEND, TRUE);
      621    17406    3       END;
      622    17407    3       ELSE DO;
      623    17408    3         CALL MOVE_MODE_LABEL (GLOB_INPUT_USE$);
      624    17409    3         CALL MOVE_MODE_LABEL (GLOB_OUTPUT_USE$);
      625    17410    3         CALL MOVE_MODE_LABEL (GLOB_IO_USE$);
      626    17411    3         CALL MOVE_MODE_LABEL (GLOB_EXTEND_USE$);
      627    17412    3       END;
      628    17413    3       DO WHILE GLOBAL_USE_SUPP_CHAIN$ ~= ADDR(NIL);
      629    17414    3         CALL MOVE_LABEL (GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.TO$,
      630    17415    3                          GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.PROC_LABEL$,
      631    17416    3                          GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.USE$);
      632    17417    3         GLOBAL_USE_SUPP_CHAIN$ = GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.LINK$;
      633    17418    3       END; /* WHILE */
      634    17419    2     END; /* Common program */
      635    17420    2     ELSE DO; /* Not COMMON program */
      636    17421          /* If the current program is an internal program nested within another
      637    17422             program, and the containing program has any local USE procedures for
      638    17423             a file or an I/O mode, such that the current program does not have one to
      639    17424             match, then the containing program's USE procedure needs to be disabled
      640    17425             temporarily. Replace it with a nil USE procedure, unless somewhere
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:41   
      641    17426             farther out there is a corresponding USE procedure that is GLOBAL; in
      642    17427             this case, reactivate it. */
      643    17428
      644    17429    2       CONTAINING_PROC$ = O1COM.CURRENT_PROC$ -> PROC_.FATHER;
      645    17430    3       IF CONTAINING_PROC$ ~= ADDR(NIL) THEN DO;
      646    17431              /* Containing program's USE procedures not valid here */
      647    17432    3         CONTAINING_USE$ = CONTAINING_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             17432                  ;
      648    17433    4         DO WHILE CONTAINING_USE$ ~= ADDR(NIL);
      649    17434    4           SECTION$ = CONTAINING_USE$ -> USE.PROC_LABEL$;
      650    17435    4           IF SECTION$ ~= NIL_EPTR$ AND NOT SECTION$ -> SECTION.B.USE_GLOBAL THEN
      651    17436    4   CHECK_GLOBAL_USE:
      652    17437    5             DO;
      653    17438    5               CONTAINING_USE_TYPE = CONTAINING_USE$ -> USE.TYPE;
      654    17439    5               IF CONTAINING_USE_TYPE = %USE_TYPE_FILE THEN
      655    17440                      %FISH (TRIAD = CONTAINING_USE$ -> USE.TO$, RTN = CONTAINING_FAB$);
      656    17448    5               CURRENT_USE$ = CURRENT_USE_CHAIN$;
      657    17449    6               DO WHILE CURRENT_USE$ ~= ADDR(NIL);
      658    17450    7                 IF CURRENT_USE$ -> USE.TYPE = CONTAINING_USE_TYPE THEN DO;
      659    17451    7                   IF CONTAINING_USE_TYPE ~= %USE_TYPE_FILE THEN
      660    17452    7                     EXIT CHECK_GLOBAL_USE;
      661    17453                          /* Local USE proc exists */
      662    17454                        %FISH (TRIAD = CURRENT_USE$ -> USE.TO$, RTN = CURRENT_FAB$);
      663    17462    7                   IF CURRENT_FAB$ = CONTAINING_FAB$ THEN EXIT CHECK_GLOBAL_USE;
      664    17463                          /* Local USE proc exists */
      665    17464    7                 END;
      666    17465    6                 CURRENT_USE$ = CURRENT_USE$ -> USE.LINK$;
      667    17466    6               END; /* WHILE */
      668    17467    5               PROC$ = CONTAINING_PROC$ -> PROC_.FATHER;
      669    17468    5               USE_CHAIN$ = COMCOM.USE_PROC_CHAIN$;
      670    17469    6   CHECK_ONE_USE: DO;
      671    17470    7                 DO WHILE PROC$ ~= ADDR(NIL);
      672    17471    7                   USE$ = PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;
      673    17472    8                   DO WHILE USE$ ~= ADDR(NIL);
      674    17473    8                     SECTION$ = USE$ -> USE.PROC_LABEL$;
      675    17474    8                     IF SECTION$ ~= NIL_EPTR$ AND SECTION$ -> SECTION.B.USE_GLOBAL THEN
      676    17475    9   NEXT_USE:           DO; /* This USE procedure by nature cannot be nil. */
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:42   
      677    17476   10                         IF USE$ -> USE.TYPE = CONTAINING_USE_TYPE THEN DO;
      678    17477   11                           IF CONTAINING_USE_TYPE = %USE_TYPE_FILE THEN DO;
      679    17478                                  %FISH (TRIAD = USE$ -> USE.TO$, RTN = FAB$);
      680    17486   11                             IF FAB$ ~= CONTAINING_FAB$ THEN EXIT NEXT_USE;
      681    17487                                                             /* Wrong file */
      682    17488   11                           END;
      683    17489   10                           PTR_ETT$ = USE$ -> USE.INIT_LABEL_BASE$;
      684    17490   10                           EXIT CHECK_ONE_USE;
      685    17491                                /* GLOBAL USE procedure found. Reactivate it. */
      686    17492   10                         END; /* IF TYPE = CONTAINING_USE_TYPE */
      687    17493    9                       END; /* NEXT_USE */
      688    17494    8                     USE$ = USE$ -> USE.LINK$;
      689    17495    8                   END; /* WHILE USE$ ~= ADDR(NIL) */
      690    17496    7                   PROC$ = PROC$ -> PROC_.FATHER;
      691    17497    7                 END; /* WHILE PROC$ ~= ADDR(NIL) */
      692    17498    6                 CONTAINING_USE_TYPE = %USE_TYPE_NIL;
      693    17499    6                 SECTION$ = NIL_EPTR$; /* No GLOBAL USE */
      694    17500    6                 USE_CHAIN$ = ADDR(NIL); /* Deactivate USE procedure. */
      695    17501    6                 CALL CREATE_AND_PRESET_A_PTR (ENTADDR(NIL), PTR_ETT$);
      696    17502    6               END; /* CHECK_ONE_USE */
      697    17503                    %NEW_USE_LTS (@POINTER = USE_LTS$,
      698    17504                                  @TYPE = CONTAINING_USE_TYPE,
      699    17505                                  @PROC_CHAIN$ = USE_CHAIN$,
      700    17506                                  @TO$ = CONTAINING_USE$ -> USE.TO$,
      701    17507                                  @INIT_LABEL_BASE$ = PTR_ETT$,
      702    17508                                  @LINK$ =
             17508                             O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             17508                                      ,
      703    17509                                  @PROC_LABEL$ = SECTION$);
      704    17615    5               O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ =
             17615                        USE_LTS$;
      705    17616    5               IF CONTAINING_USE_TYPE ~= %USE_TYPE_NIL THEN
      706    17617    5                 COMCOM.USE_PROC_CHAIN$ = USE_LTS$;
      707    17618    5               CALL MOVE_LABEL (CONTAINING_USE$ -> USE.TO$, SECTION$, USE_LTS$);
      708    17619    5             END; /* CHECK_GLOBAL_USE */
      709    17620    4             CONTAINING_USE$ = CONTAINING_USE$ -> USE.LINK$;
      710    17621    4         END; /* WHILE CONTAINING_USE$ ~= ADDR(NIL) */
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:43   
      711    17622    3       END; /* WHILE CONTAINING_PROC$ ~= ADDR(NIL) */
      712    17623    2     END; /* Non-common program */
      713    17624    1     GLOBAL_USE_SUPP_CHAIN$ = ADDR(NIL);
      714    17625    1     USE_SUPPS_MADE = FALSE;
      715    17626
      716    17627    1     RETURN ;
      717    17628
      718    17629    1   END Z8EO$USE ;
      719    17630        %EOD;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:44   
--  Include file information  --

   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EO$USE.

   Procedure Z8EO$USE requires 1399 words for executable code.
   Procedure Z8EO$USE requires 54 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:45   

 Object Unit name= Z8EO$USE                                   File name= Z8EO.:Z8A6TOU
 UTS= AUG 09 '97 12:25:53.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none    90    132  LEX_SYMBOL
    2  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    3  LblCom even  none    90    132  TEMP_LEX_SYMBOL
    4  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none     1      1  LTS$
    8  LblCom even  none     5      5  LTS_
    9  LblCom even  none     1      1  ETT$
   10  LblCom even  none     1      1  HEAD_ETT$
   11  LblCom even  none   512   1000  ETT_BUCKETS
   12  LblCom even  none     5      5  ETT_
   13  LblCom even  none     1      1  ILL$
   14  LblCom even  none     5      5  ILL_
   15  LblCom even  none     1      1  DNT$
   16  LblCom even  none     5      5  DNT_
   17  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   18  LblCom even  none     1      1  DNT_OF_1$
   19  LblCom even  none     1      1  ILS$
   20  LblCom even  none     5      5  ILS_
   21   Data  even  none     6      6  Z8EO$USE
   22  RoData even  UTS      5      5  Z8EO$USE
   23   Proc  even  none  1399   2567  Z8EO$USE
   24  RoData even  none    62     76  Z8EO$USE
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:46   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    23      0   yes            yes      Std        5  Z8EO$USE
    23   2020                  yes      Std        0  Z8EO$USE_SUPP
    23   2063                  yes      Std        0  Z8EO$END_DECLARATIVES
    23   2120                  yes      Std        0  Z8EO$NO_DECLARATIVES

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AR$RESERVER
         yes           Std       3 Z8AF$NEW_OFF
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       0 Z8AH$SEARCH_
         yes           Std       6 Z8CU$BUILD_AND_LINK
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       5 Z8AN$NEW_ILL1
         yes           Std       4 Z8AN$NEW_ILL
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                                O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK                          r    LTS_STEP                         r    ILL_STEP
r    ILS_STEP_TABLE
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:47   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:48   


       76        1        /*T***********************************************************/
       77        2        /*T*                                                         */
       78        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       79        4        /*T*                                                         */
       80        5        /*T***********************************************************/
       81        6        /*===========*/
       82        7          Z8EO$USE:     PROC (TYPE, PTR$, USE_SECT$, LINE, COLUMN) ;

      7 23 000000   000000 700200 xent  Z8EO$USE     TSX0  ! X66_AUTO_5
        23 000001   000066 000005                    ZERO    54,5

       83        8        /*===========*/
       84        9
       85       10        /*I*   NAME: Z8EO$USE
       86       11               CALL: CALL Z8EO$USE (%USE_TYPE_FILE, FILE_LTS$, USE_SECT$, KEY_WORD$) ;
       87       12            PURPOSE: Create the USE LTS item.
       88       13        DESCRIPTION: Keeps track of which USE procedures are valid for a
       89       14                     given procedure and type.  For example, a USE in program
       90       15                     "A" (which contains program "B") is not usable by "B"
       91       16                     unless the GLOBAL clause is used.
       92       17        */
       93       18
       94       19        %EQU PHASE = 1 ;
       95       20        %INCLUDE Z8A_DEFC;
       96       88        %INCLUDE Z8A_SUPP_MAC;
       97     2488        %INCLUDE Z8A_COMCOM;
       98     3138        %INCLUDE Z8A_ERR_NUMS;
       99     3902        %INCLUDE Z8E_STACKS;
      100     6168        %INCLUDE Z8E_O1COM;
      101     6929        %INCLUDE Z8A_ST;
      102    10588        %INCLUDE Z8A_LTS;
      103    12665        %INCLUDE Z8A_ETT;
      104    12966        %INCLUDE Z8A_ILL;
      105    13659        %INCLUDE Z8A_DNT;
      106    13880        %INCLUDE Z8A_TYPES;
      107    14054        %INCLUDE X9A_FAB;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:49   
      108    14241        %INCLUDE Z8E_MACROS ;
      109    14916        %INCLUDE Z8E_ILS_LIST ;
      110    15000        %INCLUDE Z8A_ILS ;
      111    15109
      112    15110    1   DCL  TYPE      UBIN WORD ; /* Arg #1 -- %USE_TYPE_FILE or ... */
      113    15111    1   DCL  PTR$      PTR ;       /* Arg #2 -- FILE_LTS$ or whatever */
      114    15112    1   DCL  USE_SECT$ PTR ;       /* Arg #3 -- USE Section name */
      115    15113    1   DCL  LINE      UBIN;       /* Arg #4 -- Token USE line number */
      116    15114    1   DCL  COLUMN    UBIN;       /* Arg #5 -- Token USE column number */
      117    15115
      118    15116    1   DCL  CURRENT_USE$       PTR ;
      119    15117    1   DCL  CURRENT_USE_CHAIN$ PTR ;
      120    15118    1   DCL  FILE_LTS$          PTR ;
      121    15119    1   DCL  PROC_SUPP$         PTR ;      /* Proc Supp LTS item for current PROC */
      122    15120    1   DCL  PROC$              PTR ;
      123    15121    1   DCL  PTR_ETT$           PTR ;      /* triad for address of USE label */
      124    15122    1   DCL  SECTION$           PTR ;
      125    15123    1   DCL  TEMP$              PTR ;      /* BASE triad */
      126    15124    1   DCL  USE$               PTR ;
      127    15125    1   DCL  USE_LTS$           PTR ;      /* USE LTS item */
      128    15126    1   DCL  DNT$$              PTR ;
      129    15127    1   DCL  CURRENT_FAB$       PTR ;
      130    15128    1   DCL  CURRENT_TYPE       UBIN ;
      131    15129    1   DCL  FAB$               PTR ;
      132    15130    1   DCL  CONTAINING_PROC$   PTR ;
      133    15131    1   DCL  CONTAINING_FAB$    PTR ;
      134    15132    1   DCL  CONTAINING_USE_TYPE UBIN ;
      135    15133    1   DCL  CONTAINING_USE$    PTR ;
      136    15134    1   DCL  USE_CHAIN$         PTR ;
      137    15135    1   DCL  GLOB_INPUT_USE$    PTR STATIC ;
      138    15136    1   DCL  GLOB_IO_USE$       PTR STATIC ;
      139    15137    1   DCL  GLOB_OUTPUT_USE$   PTR STATIC ;
      140    15138    1   DCL  GLOB_EXTEND_USE$   PTR STATIC ;
      141    15139    1   DCL  GLOBAL_USE_SUPP_CHAIN$ PTR STATIC INIT(ADDR(NIL)) ;
      142    15140    1   DCL  PREV_USE_SUPP$     PTR ;
      143    15141    1   DCL  NIL_EPTR           EPTR CONSTANT INIT (ENTADDR (NIL)) ;
      144    15142    1   DCL  NIL_EPTR$          REDEF NIL_EPTR PTR ;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:50   
      145    15143    1   DCL  USE_SUPPS_MADE     BOOLEAN STATIC INIT (FALSE);
      146    15144
      147    15145         %DCL_AUTO_LX_ITEM (@NAME = SAVED_ILS_LIST) ;
      148    15149
      149    15150    1   DCL  Z8AE$ERROR                ENTRY (12) ;
      150    15151    1   DCL  Z8AF$NEW_BASE             ENTRY (3) ;
      151    15152    1   DCL  Z8AF$NEW_OFF              ENTRY (3) ;
      152    15153    1   DCL  Z8AH$SEARCH_              ENTRY ;
      153    15154    1   DCL  Z8AT$CREATE_TEMPORARY     ENTRY (2) ;
      154    15155    1   DCL  Z8CU$BUILD_AND_LINK       ENTRY (6) ;
      155    15156
      156    15157        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:51   
      157    15158         /* Start of Z8EO$USE */
      158    15159
      159    15160    1    PROC_SUPP$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ;

  15160 23 000002   000057 470400 xsym               LDP0    O1COM+47
        23 000003   000001 236100                    LDQ     1,,PR0
        23 000004   200013 756100                    STQ     PROC_SUPP$,,AUTO

      160    15161         %NEW_USE_LTS (@POINTER     = USE_LTS$,
      161    15162                       @TYPE        = TYPE,
      162    15163                       @PROC_CHAIN$ = COMCOM.USE_PROC_CHAIN$,
      163    15164                       @LINE        = LINE,
      164    15165                       @COLUMN      = COLUMN,
      165    15166                       @LINK$       = "PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$",
      166    15167                       @PROC_LABEL$ = USE_SECT$) ;

  15245 23 000005   000002 236000 8                  LDQ     LTS_+2
        23 000006   000022 036007                    ADLQ    18,DL
        23 000007   000003 116000 8                  CMPQ    LTS_+3
        23 000010   000021 604000 23                 TMI     s:15247

  15246 23 000011   000002 236000 24                 LDQ     2
        23 000012   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000013   200060 631500                    EPPR1   @ETT$$+2,,AUTO
        23 000014   200061 451500                    STP1    @ETT$$+3,,AUTO
        23 000015   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000016   000001 631400 24                 EPPR1   1
        23 000017   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 000020   000000 011000                    NOP     0

  15247 23 000021   000002 236000 8                  LDQ     LTS_+2
        23 000022   000022 736000                    QLS     18
        23 000023   000001 036000 8                  ADLQ    LTS_+1
        23 000024   200021 756100                    STQ     USE_LTS$,,AUTO

  15248 23 000025   000022 236007                    LDQ     18,DL
        23 000026   000002 056000 8                  ASQ     LTS_+2
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:52   

  15249 23 000027   001100 220003                    LDX0    576,DU
        23 000030   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 000031   000000 740100                    STX0    0,,PR0

  15255 23 000032   000476 236000 xsym               LDQ     COMCOM+318
        23 000033   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 000034   000001 756100                    STQ     1,,PR0

  15259 23 000035   200005 470500                    LDP0    @USE_SECT$,,AUTO
        23 000036   000000 236100                    LDQ     0,,PR0
        23 000037   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 000040   100002 756100                    STQ     2,,PR1

  15261 23 000041   200013 471500                    LDP1    PROC_SUPP$,,AUTO
        23 000042   100022 236100                    LDQ     18,,PR1
        23 000043   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 000044   300003 756100                    STQ     3,,PR3

  15262 23 000045   000000 236000 24                 LDQ     0
        23 000046   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 000047   300004 756100                    STQ     4,,PR3

  15263 23 000050   200003 473500                    LDP3    @TYPE,,AUTO
        23 000051   300000 721100                    LXL1    0,,PR3
        23 000052   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 000053   400000 441100                    SXL1    0,,PR4

  15264 23 000054   000000 236000 24                 LDQ     0
        23 000055   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 000056   400007 756100                    STQ     7,,PR4

  15265 23 000057   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 000060   400010 756100                    STQ     8,,PR4

  15266 23 000061   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 000062   400015 756100                    STQ     13,,PR4
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:53   

  15267 23 000063   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 000064   400017 756100                    STQ     15,,PR4

  15268 23 000065   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 000066   400016 756100                    STQ     14,,PR4

  15269 23 000067   200006 474500                    LDP4    @LINE,,AUTO
        23 000070   400000 721100                    LXL1    0,,PR4
        23 000071   200021 475500                    LDP5    USE_LTS$,,AUTO
        23 000072   500020 741100                    STX1    16,,PR5

  15270 23 000073   200007 475500                    LDP5    @COLUMN,,AUTO
        23 000074   500000 721100                    LXL1    0,,PR5
        23 000075   200021 476500                    LDP6    USE_LTS$,,AUTO
        23 000076   600020 441100                    SXL1    16,,PR6

      167    15273
      168    15274    1    COMCOM.USE_PROC_CHAIN$ = USE_LTS$ ;

  15274 23 000077   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 000100   000476 756000 xsym               STQ     COMCOM+318

      169    15275
      170    15276    2    DO CASE (TYPE) ;

  15276 23 000101   300000 235100                    LDA     0,,PR3
        23 000102   000006 115007                    CMPA    6,DL
        23 000103   000105 602005 23                 TNC     s:15276+4,AL
        23 000104   000306 710000 23                 TRA     s:15329
        23 000105   000306 710000 23                 TRA     s:15329
        23 000106   000214 710000 23                 TRA     s:15306
        23 000107   000214 710000 23                 TRA     s:15306
        23 000110   000214 710000 23                 TRA     s:15306
        23 000111   000214 710000 23                 TRA     s:15306
        23 000112   000113 710000 23                 TRA     s:15281

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:54   
      171    15277
      172    15278    2      CASE (%USE_TYPE_FILE) ;

      173    15279
      174    15280             /* Generate Moves to be used at ENTRY time */
      175    15281    2        CALL Z8AF$NEW_BASE (PTR$ -> FILE_LTS.FAB$,      /* LOP */

  15281 23 000113   200004 476500                    LDP6    @PTR$,,AUTO
        23 000114   600000 477500                    LDP7    0,,PR6
        23 000115   000000 236000 24                 LDQ     0
        23 000116   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000117   000004 236000 24                 LDQ     4
        23 000120   200063 756100                    STQ     @ETT$$+5,,AUTO
        23 000121   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000122   200062 450500                    STP0    @ETT$$+4,,AUTO
        23 000123   700002 630500                    EPPR0   2,,PR7
        23 000124   200061 450500                    STP0    @ETT$$+3,,AUTO
        23 000125   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000126   000003 631400 24                 EPPR1   3
        23 000127   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        23 000130   000000 011000                    NOP     0

      176    15282    2                            ADDR(NIL),                  /* ROP */
      177    15283    2                            ETT$) ;                  /* Result */
      178    15284    2        CALL Z8AF$NEW_OFF (ETT$,                        /* LOP */

  15284 23 000131   000006 630400 24                 EPPR0   6
        23 000132   000003 631400 24                 EPPR1   3
        23 000133   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 000134   000000 011000                    NOP     0

      179    15285    2                           %USE_PROC_OFFSET,         /* ROPCON */
      180    15286    2                           ETT$) ;                   /* Result */
      181    15287    2        ETT$ -> ETT.OFFSET.TYPE = %WORD_;

  15287 23 000135   000006 220003                    LDX0    6,DU
        23 000136   000000 470400 9                  LDP0    ETT$
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:55   
        23 000137   000002 440100                    SXL0    2,,PR0

      182    15288    2        USE_LTS$ -> USE.TO$ = ETT$ ;

  15288 23 000140   000000 236000 9                  LDQ     ETT$
        23 000141   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 000142   100004 756100                    STQ     4,,PR1

      183    15289
      184    15290    2        IF O1COM.CURRENT_PROC$ -> PROC_.FATHER = ADDR(NIL) AND

  15290 23 000143   000057 471400 xsym               LDP1    O1COM+47
        23 000144   100011 236100                    LDQ     9,,PR1
        23 000145   000000 116000 24                 CMPQ    0
        23 000146   000205 601000 23                 TNZ     s:15302
        23 000147   000062 234000 xsym               SZN     COMCOM+50
        23 000150   000157 604000 23                 TMI     s:15290+12
        23 000151   100006 473500                    LDP3    6,,PR1
        23 000152   300005 236100                    LDQ     5,,PR3
        23 000153   000000 116000 24                 CMPQ    0
        23 000154   000166 600000 23                 TZE     s:15295
        23 000155   000045 234000 xsym               SZN     COMCOM+37
        23 000156   000166 604000 23                 TMI     s:15295
        23 000157   200004 473500                    LDP3    @PTR$,,AUTO
        23 000160   300000 474500                    LDP4    0,,PR3
        23 000161   400017 236100                    LDQ     15,,PR4
        23 000162   000400 316003                    CANQ    256,DU
        23 000163   000205 601000 23                 TNZ     s:15302
        23 000164   000010 316007                    CANQ    8,DL
        23 000165   000205 601000 23                 TNZ     s:15302

      185    15291    2          ((NOT COMCOM.OB.SUB AND
      186    15292    2            (O1COM.CURRENT_PROC$ -> PROC_.PROC_DEF$ -> PROC_DEF.ARGLIST$ = ADDR (NIL)
             15292                     OR
      187    15293    2             COMCOM.OB.MAIN_PROG)) OR
      188    15294    3          (NOT PTR$ -> FILE_LTS.B.EXTERNAL AND NOT PTR$ -> FILE_LTS.B.BLOCK)) THEN DO;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:56   
      189    15295    3          PTR$ -> FILE_LTS.USE_PROC_LABEL$ = USE_SECT$ ;

  15295 23 000166   200004 473500                    LDP3    @PTR$,,AUTO
        23 000167   300000 474500                    LDP4    0,,PR3
        23 000170   200005 475500                    LDP5    @USE_SECT$,,AUTO
        23 000171   500000 236100                    LDQ     0,,PR5
        23 000172   400052 756100                    STQ     42,,PR4

      190    15296    3          CALL CREATE_AND_PRESET_A_PTR (USE_SECT$,  /* in:  USE Section */

  15296 23 000173   200015 631500                    EPPR1   PTR_ETT$,,AUTO
        23 000174   200056 451500                    STP1    @ST$$+1,,AUTO
        23 000175   200005 236100                    LDQ     @USE_SECT$,,AUTO
        23 000176   200055 756100                    STQ     @USE_LTS$+2,,AUTO
        23 000177   000702 701000 23                 TSX1    CREATE_AND_PRESET_A_PTR
        23 000200   000000 011000                    NOP     0

      191    15297    3                                        PTR_ETT$) ; /* out: ETT item */
      192    15298
      193    15299    3          USE_LTS$ -> USE.INIT_LABEL_BASE$ = PTR_ETT$ ;

  15299 23 000201   200015 236100                    LDQ     PTR_ETT$,,AUTO
        23 000202   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 000203   000016 756100                    STQ     14,,PR0

      194    15300    3        END;

  15300 23 000204   000306 710000 23                 TRA     s:15329

      195    15301    3        ELSE DO ; /* Current proc is an internal procedure */

      196    15302    3          CALL SAVE_AND_MOVE_LABEL (ETT$, USE_SECT$) ;

  15302 23 000205   200005 236100                    LDQ     @USE_SECT$,,AUTO
        23 000206   200046 756100                    STQ     @IN_PTR$+1,,AUTO
        23 000207   000004 236000 24                 LDQ     4
        23 000210   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:57   
        23 000211   000434 701000 23                 TSX1    SAVE_AND_MOVE_LABEL
        23 000212   000000 011000                    NOP     0

      197    15303    3        END ; /* Internal procedure */

  15303 23 000213   000306 710000 23                 TRA     s:15329

      198    15304    2      CASE (%USE_TYPE_INPUT, %USE_TYPE_OUTPUT, %USE_TYPE_IO, %USE_TYPE_EXTEND) ;

      199    15305
      200    15306    2        CALL MAKE_OFF (TYPE, ETT$);

  15306 23 000214   000004 236000 24                 LDQ     4
        23 000215   200052 756100                    STQ     @TO$+1,,AUTO
        23 000216   200003 236100                    LDQ     @TYPE,,AUTO
        23 000217   200051 756100                    STQ     @EXT_PTR$+1,,AUTO
        23 000220   000312 701000 23                 TSX1    MAKE_OFF
        23 000221   000000 011000                    NOP     0

      201    15307
      202    15308    2        USE_LTS$ -> USE.TO$ = ETT$ ;

  15308 23 000222   000000 236000 9                  LDQ     ETT$
        23 000223   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 000224   000004 756100                    STQ     4,,PR0

      203    15309    3        IF O1COM.CURRENT_PROC$ -> PROC_.FATHER = ADDR(NIL) THEN DO;

  15309 23 000225   000057 470400 xsym               LDP0    O1COM+47
        23 000226   000011 236100                    LDQ     9,,PR0
        23 000227   000000 116000 24                 CMPQ    0
        23 000230   000243 601000 23                 TNZ     s:15316

      204    15310    3          CALL CREATE_AND_PRESET_A_PTR (USE_SECT$,  /* in:  USE Section */

  15310 23 000231   200015 631500                    EPPR1   PTR_ETT$,,AUTO
        23 000232   200056 451500                    STP1    @ST$$+1,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:58   
        23 000233   200005 236100                    LDQ     @USE_SECT$,,AUTO
        23 000234   200055 756100                    STQ     @USE_LTS$+2,,AUTO
        23 000235   000702 701000 23                 TSX1    CREATE_AND_PRESET_A_PTR
        23 000236   000000 011000                    NOP     0

      205    15311    3                                        PTR_ETT$) ; /* out: ETT item */
      206    15312
      207    15313    3          USE_LTS$ -> USE.INIT_LABEL_BASE$ = PTR_ETT$ ;

  15313 23 000237   200015 236100                    LDQ     PTR_ETT$,,AUTO
        23 000240   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 000241   000016 756100                    STQ     14,,PR0

      208    15314    3        END;

  15314 23 000242   000251 710000 23                 TRA     s:15317

      209    15315    2        ELSE
      210    15316    2          CALL SAVE_AND_MOVE_LABEL (ETT$, USE_SECT$) ;

  15316 23 000243   200005 236100                    LDQ     @USE_SECT$,,AUTO
        23 000244   200046 756100                    STQ     @IN_PTR$+1,,AUTO
        23 000245   000004 236000 24                 LDQ     4
        23 000246   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 000247   000434 701000 23                 TSX1    SAVE_AND_MOVE_LABEL
        23 000250   000000 011000                    NOP     0

      211    15317    3        DO CASE (TYPE);

  15317 23 000251   200003 470500                    LDP0    @TYPE,,AUTO
        23 000252   000000 235100                    LDA     0,,PR0
        23 000253   000005 115007                    CMPA    5,DL
        23 000254   000256 602005 23                 TNC     s:15317+5,AL
        23 000255   000306 710000 23                 TRA     s:15329
        23 000256   000306 710000 23                 TRA     s:15329
        23 000257   000263 710000 23                 TRA     s:15319
        23 000260   000270 710000 23                 TRA     s:15321
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:59   
        23 000261   000302 710000 23                 TRA     s:15325
        23 000262   000275 710000 23                 TRA     s:15323

      212    15318    3          CASE (%USE_TYPE_INPUT);

      213    15319    3            PROC_SUPP$ -> PROC_SUPP.USE_INPUT_LABEL$ = USE_SECT$;

  15319 23 000263   200005 471500                    LDP1    @USE_SECT$,,AUTO
        23 000264   100000 236100                    LDQ     0,,PR1
        23 000265   200013 473500                    LDP3    PROC_SUPP$,,AUTO
        23 000266   300025 756100                    STQ     21,,PR3
        23 000267   000306 710000 23                 TRA     s:15329

      214    15320    3          CASE (%USE_TYPE_OUTPUT);

      215    15321    3            PROC_SUPP$ -> PROC_SUPP.USE_OUTPUT_LABEL$ = USE_SECT$;

  15321 23 000270   200005 471500                    LDP1    @USE_SECT$,,AUTO
        23 000271   100000 236100                    LDQ     0,,PR1
        23 000272   200013 473500                    LDP3    PROC_SUPP$,,AUTO
        23 000273   300026 756100                    STQ     22,,PR3
        23 000274   000306 710000 23                 TRA     s:15329

      216    15322    3          CASE (%USE_TYPE_IO);

      217    15323    3            PROC_SUPP$ -> PROC_SUPP.USE_IO_LABEL$ = USE_SECT$;

  15323 23 000275   200005 471500                    LDP1    @USE_SECT$,,AUTO
        23 000276   100000 236100                    LDQ     0,,PR1
        23 000277   200013 473500                    LDP3    PROC_SUPP$,,AUTO
        23 000300   300027 756100                    STQ     23,,PR3
        23 000301   000306 710000 23                 TRA     s:15329

      218    15324    3          CASE (%USE_TYPE_EXTEND);

      219    15325    3            PROC_SUPP$ -> PROC_SUPP.USE_EXTEND_LABEL$ = USE_SECT$;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:60   
  15325 23 000302   200005 471500                    LDP1    @USE_SECT$,,AUTO
        23 000303   100000 236100                    LDQ     0,,PR1
        23 000304   200013 473500                    LDP3    PROC_SUPP$,,AUTO
        23 000305   300030 756100                    STQ     24,,PR3

      220    15326    3        END;

      221    15327
      222    15328    2    END ; /* Case of USE TYPE */

      223    15329    1    PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ = USE_LTS$ ;

  15329 23 000306   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 000307   200013 470500                    LDP0    PROC_SUPP$,,AUTO
        23 000310   000022 756100                    STQ     18,,PR0

      224    15330
      225    15331    1    RETURN ;

  15331 23 000311   000000 702200 xent               TSX2  ! X66_ARET

      226    15332
      227    15333        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:61   
      228    15334        /*========*/
      229    15335    1     MAKE_OFF: PROC (TYPE, ETT$);

  15335 23 000312   200050 741300       MAKE_OFF     STX1  ! @IO_PTR$+1,,AUTO

      230    15336        /*========*/
      231    15337        /*   NAME: MAKE_OFF
      232    15338             CALL: CALL MAKE_OFF (TYPE, ETT$);
      233    15339            INPUT: TYPE -- USE procedure type.
      234    15340           OUTPUT: ETT$ -- Pointer to BASE or OFF triad for pointer to USE proc
      235    15341                           for this I/O mode.
      236    15342          PURPOSE: Generate a tree such that it can be used for references that
      237    15343                   are needed to save/restore pointers to USE procedure for I/O
      238    15344                   nodes such as EXTEND.
      239    15345        */
      240    15346    2   DCL TYPE UBIN;
      241    15347    2   DCL ETT$ PTR;
      242    15348    2        IF COMCOM.USE_BLOCK_ST$ = ADDR(NIL) THEN

  15348 23 000313   000443 236000 xsym               LDQ     COMCOM+291
        23 000314   000000 116000 24                 CMPQ    0
        23 000315   000347 601000 23                 TNZ     s:15358

      243    15349    3          DO;

      244    15350    3            LEX_SYMBOL.SIZE = 4;

  15350 23 000316   000004 235007                    LDA     4,DL
        23 000317   000010 755000 1                  STA     LEX_SYMBOL+8

      245    15351    3            LEX_SYMBOL.SYMBOL = 'FILE';

  15351 23 000320   040000 100400                    MLR     fill='040'O
        23 000321   000001 000004 22                 ADSC9   NIL_EPTR+1               cn=0,n=4
        23 000322   000011 000504 1                  ADSC9   LEX_SYMBOL+9             cn=0,n=324

      246    15352    3            CALL Z8AH$SEARCH_;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:62   

  15352 23 000323   000011 631400 24                 EPPR1   9
        23 000324   000000 701000 xent               TSX1    Z8AH$SEARCH_
        23 000325   000000 011000                    NOP     0

      247    15353    3            DNT$$ = DNT$;

  15353 23 000326   000000 236000 15                 LDQ     DNT$
        23 000327   200022 756100                    STQ     DNT$$,,AUTO

      248    15354    3            CALL Z8CU$BUILD_AND_LINK (DNT$$, 1, %TYA, 'USE_BLOCK', 9, COMCOM.
             15354                     USE_BLOCK_ST$);

  15354 23 000330   000016 237000 24                 LDAQ    14
        23 000331   200064 757100                    STAQ    @ETT$$+6,,AUTO
        23 000332   000020 237000 24                 LDAQ    16
        23 000333   200062 757100                    STAQ    @ETT$$+4,,AUTO
        23 000334   000022 236000 24                 LDQ     18
        23 000335   200061 756100                    STQ     @ETT$$+3,,AUTO
        23 000336   200022 630500                    EPPR0   DNT$$,,AUTO
        23 000337   200060 450500                    STP0    @ETT$$+2,,AUTO
        23 000340   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000341   000012 631400 24                 EPPR1   10
        23 000342   000000 701000 xent               TSX1    Z8CU$BUILD_AND_LINK
        23 000343   000000 011000                    NOP     0

      249    15355    3            COMCOM.USE_BLOCK_ST$ -> SCALAR.ADSC.N = 16;

  15355 23 000344   000443 470400 xsym               LDP0    COMCOM+291
        23 000345   000020 236007                    LDQ     16,DL
        23 000346   000001 752103                    STCQ    1,'03'O,PR0

      250    15356
      251    15357    3          END;

      252    15358    2        CALL Z8AF$NEW_BASE (COMCOM.USE_BLOCK_ST$,

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:63   
  15358 23 000347   000000 236000 24                 LDQ     0
        23 000350   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000351   200052 236100                    LDQ     @ETT$,,AUTO
        23 000352   200063 756100                    STQ     @ETT$$+5,,AUTO
        23 000353   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000354   200062 450500                    STP0    @ETT$$+4,,AUTO
        23 000355   000017 236000 24                 LDQ     15
        23 000356   200061 756100                    STQ     @ETT$$+3,,AUTO
        23 000357   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000360   000003 631400 24                 EPPR1   3
        23 000361   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        23 000362   000000 011000                    NOP     0

      253    15359    2                            ADDR(NIL),
      254    15360    2                            ETT$);
      255    15361    3        DO CASE (TYPE) ;

  15361 23 000363   200051 470500                    LDP0    @TYPE,,AUTO
        23 000364   000000 235100                    LDA     0,,PR0
        23 000365   000005 115007                    CMPA    5,DL
        23 000366   000370 602005 23                 TNC     s:15361+5,AL
        23 000367   000432 710000 23                 TRA     s:15369
        23 000370   000432 710000 23                 TRA     s:15369
        23 000371   000432 710000 23                 TRA     s:15369
        23 000372   000375 710000 23                 TRA     s:15363
        23 000373   000421 710000 23                 TRA     s:15367
        23 000374   000407 710000 23                 TRA     s:15365

      256    15362    3          CASE (%USE_TYPE_OUTPUT) ;

      257    15363    3            CALL Z8AF$NEW_OFF (ETT$, 4, ETT$) ;

  15363 23 000375   200052 236100                    LDQ     @ETT$,,AUTO
        23 000376   200062 756100                    STQ     @ETT$$+4,,AUTO
        23 000377   000024 236000 24                 LDQ     20
        23 000400   200052 235100                    LDA     @ETT$,,AUTO
        23 000401   200060 757100                    STAQ    @ETT$$+2,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:64   
        23 000402   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000403   000003 631400 24                 EPPR1   3
        23 000404   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 000405   000000 011000                    NOP     0
        23 000406   000432 710000 23                 TRA     s:15369

      258    15364    3          CASE (%USE_TYPE_IO) ;

      259    15365    3            CALL Z8AF$NEW_OFF (ETT$, 8, ETT$) ;

  15365 23 000407   200052 236100                    LDQ     @ETT$,,AUTO
        23 000410   200062 756100                    STQ     @ETT$$+4,,AUTO
        23 000411   000020 236000 24                 LDQ     16
        23 000412   200052 235100                    LDA     @ETT$,,AUTO
        23 000413   200060 757100                    STAQ    @ETT$$+2,,AUTO
        23 000414   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000415   000003 631400 24                 EPPR1   3
        23 000416   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 000417   000000 011000                    NOP     0
        23 000420   000432 710000 23                 TRA     s:15369

      260    15366    3          CASE (%USE_TYPE_EXTEND) ;

      261    15367    3            CALL Z8AF$NEW_OFF (ETT$, 12, ETT$) ;

  15367 23 000421   200052 236100                    LDQ     @ETT$,,AUTO
        23 000422   200062 756100                    STQ     @ETT$$+4,,AUTO
        23 000423   000026 236000 24                 LDQ     22
        23 000424   200052 235100                    LDA     @ETT$,,AUTO
        23 000425   200060 757100                    STAQ    @ETT$$+2,,AUTO
        23 000426   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000427   000003 631400 24                 EPPR1   3
        23 000430   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 000431   000000 011000                    NOP     0

      262    15368    3        END ; /* CASE */

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:65   
      263    15369    2   END MAKE_OFF;

  15369 23 000432   200050 221300                    LDX1  ! @IO_PTR$+1,,AUTO
        23 000433   000001 702211                    TSX2  ! 1,X1

      264    15370        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:66   
      265    15371        /*===================*/
      266    15372    1     SAVE_AND_MOVE_LABEL: PROC (TO$, USE_SECT$) ;

  15372 23 000434   200044 741300       SAVE_AND_MO* STX1  ! SAVED_ILS_LIST+8,,AUTO

      267    15373        /*===================*/
      268    15374
      269    15375        /*I*   NAME: SAVE_AND_MOVE_LABEL
      270    15376               CALL: CALL SAVE_AND_MOVE_LABEL (FAB+n or RW.USE$ or ..., USE_SECT$);
      271    15377            PURPOSE: Generate -- MOVE FAB+n TO Temp
      272    15378                                 MOVE Use_Section TO FAB+n
      273    15379        */
      274    15380
      275    15381    2    DCL  TO$       PTR ;   /* Input arg -- OFF or BASE triad    */
      276    15382    2    DCL  USE_SECT$ PTR ;   /* Input arg -- SECTION or ADDR(NIL) */
      277    15383
      278    15384    2    ADDR (SAVED_ILS_LIST) -> ILS_LIST = O1COM.ILS_LIST ; /* Save ILS_LIST */

  15384 23 000435   000100 100400                    MLR     fill='000'O
        23 000436   000016 000040 xsym               ADSC9   O1COM+14                 cn=0,n=32
        23 000437   200034 000040                    ADSC9   SAVED_ILS_LIST,,AUTO     cn=0,n=32

      279    15385
      280    15386         %INIT_ILS_LIST (@POINTER = "ADDR(O1COM.ILS_LIST)") ;

  15388 23 000440   000007 220003                    LDX0    7,DU
        23 000441   000016 740000 xsym               STX0    O1COM+14

  15389 23 000442   000000 236000 24                 LDQ     0
        23 000443   000017 756000 xsym               STQ     O1COM+15

  15390 23 000444   000020 756000 xsym               STQ     O1COM+16

  15391 23 000445   000025 756000 xsym               STQ     O1COM+21

      281    15394
      282    15395    2    CALL MOVE_LABEL (TO$, USE_SECT$, USE_LTS$) ;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:67   

  15395 23 000446   200021 630500                    EPPR0   USE_LTS$,,AUTO
        23 000447   200053 450500                    STP0    @USE_SECT$+1,,AUTO
        23 000450   200046 236100                    LDQ     @USE_SECT$,,AUTO
        23 000451   200052 756100                    STQ     @ETT$,,AUTO
        23 000452   200045 236100                    LDQ     @TO$,,AUTO
        23 000453   200051 756100                    STQ     @TYPE,,AUTO
        23 000454   000467 701000 23                 TSX1    MOVE_LABEL
        23 000455   000000 011000                    NOP     0

      283    15396
      284    15397    2    USE_LTS$ -> USE.ILS_LIST = O1COM.ILS_LIST ;

  15397 23 000456   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 000457   000100 100400                    MLR     fill='000'O
        23 000460   000016 000040 xsym               ADSC9   O1COM+14                 cn=0,n=32
        23 000461   000006 000040                    ADSC9   6,,PR0                   cn=0,n=32

      285    15398    2    O1COM.ILS_LIST = ADDR(SAVED_ILS_LIST) -> ILS_LIST ;

  15398 23 000462   000000 100500                    MLR     fill='000'O
        23 000463   200034 000040                    ADSC9   SAVED_ILS_LIST,,AUTO     cn=0,n=32
        23 000464   000016 000040 xsym               ADSC9   O1COM+14                 cn=0,n=32

      286    15399
      287    15400    2    RETURN ;

  15400 23 000465   200044 221300                    LDX1  ! SAVED_ILS_LIST+8,,AUTO
        23 000466   000001 702211                    TSX2  ! 1,X1

      288    15401
      289    15402    2   END SAVE_AND_MOVE_LABEL ;
      290    15403
      291    15404        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:68   
      292    15405        /*===================*/
      293    15406    1        MOVE_LABEL      : PROC (TO$, USE_SECT$, USE_LTS$) ;

  15406 23 000467   200050 741300       MOVE_LABEL   STX1  ! @IO_PTR$+1,,AUTO

      294    15407        /*===================*/
      295    15408
      296    15409        /*I*   NAME: MOVE_LABEL
      297    15410               CALL: CALL MOVE_LABEL (FAB+n or RW.USE$ or ..., USE_SECT$, USE_LTS$);
      298    15411            PURPOSE: Generate -- MOVE FAB+n TO Temp
      299    15412                                 MOVE Use_Section TO FAB+n
      300    15413        */
      301    15414
      302    15415    2    DCL  TO$       PTR ;   /* Input arg -- OFF or BASE triad    */
      303    15416    2    DCL  USE_SECT$ PTR ;   /* Input arg -- SECTION or ADDR(NIL) */
      304    15417    2    DCL  USE_LTS$  PTR ;   /* Input arg -- Pointer to USE LTS item */
      305    15418
      306    15419    2    CALL Z8AT$CREATE_TEMPORARY (%SCALAR, TEMP$) ;

  15419 23 000470   200017 630500                    EPPR0   TEMP$,,AUTO
        23 000471   200061 450500                    STP0    @ETT$$+3,,AUTO
        23 000472   000031 236000 24                 LDQ     25
        23 000473   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000474   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000475   000027 631400 24                 EPPR1   23
        23 000476   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        23 000477   000000 011000                    NOP     0

      307    15420    2    CALL Z8AF$NEW_BASE (TEMP$, ADDR(NIL), TEMP$) ;

  15420 23 000500   000000 236000 24                 LDQ     0
        23 000501   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000502   200017 630500                    EPPR0   TEMP$,,AUTO
        23 000503   200063 450500                    STP0    @ETT$$+5,,AUTO
        23 000504   200060 631500                    EPPR1   @ETT$$+2,,AUTO
        23 000505   200062 451500                    STP1    @ETT$$+4,,AUTO
        23 000506   200017 633500                    EPPR3   TEMP$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:69   
        23 000507   200061 453500                    STP3    @ETT$$+3,,AUTO
        23 000510   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000511   000003 631400 24                 EPPR1   3
        23 000512   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        23 000513   000000 011000                    NOP     0

      308    15421
      309    15422         %NEW_ILL (@ID  = %MVII,              /* Move current ptr to a temp */
      310    15423                   @LOP = TEMP$,
      311    15424                   @ROP = TO$) ;              /* current ptr (FAB+n, ... ) */

  15737 23 000514   000034 236000 24                 LDQ     28
        23 000515   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000516   200017 630500                    EPPR0   TEMP$,,AUTO
        23 000517   200065 450500                    STP0    @ETT$$+7,,AUTO
        23 000520   200060 631500                    EPPR1   @ETT$$+2,,AUTO
        23 000521   200064 451500                    STP1    @ETT$$+6,,AUTO
        23 000522   000036 237000 24                 LDAQ    30
        23 000523   200062 757100                    STAQ    @ETT$$+4,,AUTO
        23 000524   000022 236000 24                 LDQ     18
        23 000525   200061 756100                    STQ     @ETT$$+3,,AUTO
        23 000526   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000527   000032 631400 24                 EPPR1   26
        23 000530   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        23 000531   000000 011000                    NOP     0

  15740 23 000532   200017 236100                    LDQ     TEMP$,,AUTO
        23 000533   000000 470400 13                 LDP0    ILL$
        23 000534   000001 756100                    STQ     1,,PR0

  15741 23 000535   200051 471500                    LDP1    @TO$,,AUTO
        23 000536   100000 236100                    LDQ     0,,PR1
        23 000537   000002 756100                    STQ     2,,PR0

      312    15803
      313    15804    3    IF USE_LTS$ -> USE.INIT_LABEL_BASE$ = ADDR(NIL) THEN DO ;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:70   
  15804 23 000540   200053 473500                    LDP3    @USE_LTS$,,AUTO
        23 000541   300000 474500                    LDP4    0,,PR3
        23 000542   400016 236100                    LDQ     14,,PR4
        23 000543   000000 116000 24                 CMPQ    0
        23 000544   000557 601000 23                 TNZ     s:16126

      314    15805    3      CALL CREATE_AND_PRESET_A_PTR (USE_SECT$,  /* in:  USE Section */

  15805 23 000545   200015 635500                    EPPR5   PTR_ETT$,,AUTO
        23 000546   200056 455500                    STP5    @ST$$+1,,AUTO
        23 000547   200052 236100                    LDQ     @USE_SECT$,,AUTO
        23 000550   200055 756100                    STQ     @USE_LTS$+2,,AUTO
        23 000551   000702 701000 23                 TSX1    CREATE_AND_PRESET_A_PTR
        23 000552   000000 011000                    NOP     0

      315    15806    3                                    PTR_ETT$) ; /* out: ETT item */
      316    15807
      317    15808    3      USE_LTS$ -> USE.INIT_LABEL_BASE$ = PTR_ETT$ ;

  15808 23 000553   200053 470500                    LDP0    @USE_LTS$,,AUTO
        23 000554   000000 471500                    LDP1    0,,PR0
        23 000555   200015 236100                    LDQ     PTR_ETT$,,AUTO
        23 000556   100016 756100                    STQ     14,,PR1

      318    15809    3    END ;

      319    15810
      320    15811         %NEW_ILL (@ID  = %MVII,     /* Move in a new current ptr */
      321    15812                   @LOP = TO$,       /* FAB+n, REPORT.USE$, ...   */
      322    15813                   @ROP = USE_LTS$ -> USE.INIT_LABEL_BASE$) ;

  16126 23 000557   000034 236000 24                 LDQ     28
        23 000560   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000561   200051 236100                    LDQ     @TO$,,AUTO
        23 000562   200065 756100                    STQ     @ETT$$+7,,AUTO
        23 000563   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000564   200064 450500                    STP0    @ETT$$+6,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:71   
        23 000565   000036 237000 24                 LDAQ    30
        23 000566   200062 757100                    STAQ    @ETT$$+4,,AUTO
        23 000567   000022 236000 24                 LDQ     18
        23 000570   200061 756100                    STQ     @ETT$$+3,,AUTO
        23 000571   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000572   000032 631400 24                 EPPR1   26
        23 000573   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        23 000574   000000 011000                    NOP     0

  16129 23 000575   200051 470500                    LDP0    @TO$,,AUTO
        23 000576   000000 236100                    LDQ     0,,PR0
        23 000577   000000 471400 13                 LDP1    ILL$
        23 000600   100001 756100                    STQ     1,,PR1

  16130 23 000601   200053 473500                    LDP3    @USE_LTS$,,AUTO
        23 000602   300000 474500                    LDP4    0,,PR3
        23 000603   400016 236100                    LDQ     14,,PR4
        23 000604   100002 756100                    STQ     2,,PR1

      323    16192
      324    16193    2    PROC_SUPP$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ ;

  16193 23 000605   000057 474400 xsym               LDP4    O1COM+47
        23 000606   400001 236100                    LDQ     1,,PR4
        23 000607   200013 756100                    STQ     PROC_SUPP$,,AUTO

      325    16194         %NEW_IO_RESTORE_CHAIN (@POINTER = LTS$,
      326    16195                                @RESTORE = TEMP$,
      327    16196                                @TO      = TO$,
      328    16197                                @BASE    = USE_LTS$ -> USE.INIT_LABEL_BASE$,
      329    16198                                @NEXT    = "PROC_SUPP$ -> PROC_SUPP.IO_RESTORE_CHAIN$") ;

  16277 23 000610   000002 236000 8                  LDQ     LTS_+2
        23 000611   000005 036007                    ADLQ    5,DL
        23 000612   000003 116000 8                  CMPQ    LTS_+3
        23 000613   000624 604000 23                 TMI     s:16279

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:72   
  16278 23 000614   000002 236000 24                 LDQ     2
        23 000615   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000616   200060 635500                    EPPR5   @ETT$$+2,,AUTO
        23 000617   200061 455500                    STP5    @ETT$$+3,,AUTO
        23 000620   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000621   000001 631400 24                 EPPR1   1
        23 000622   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 000623   000000 011000                    NOP     0

  16279 23 000624   000002 236000 8                  LDQ     LTS_+2
        23 000625   000022 736000                    QLS     18
        23 000626   000001 036000 8                  ADLQ    LTS_+1
        23 000627   000000 756000 7                  STQ     LTS$

  16280 23 000630   000005 236007                    LDQ     5,DL
        23 000631   000002 056000 8                  ASQ     LTS_+2

  16281 23 000632   001067 220003                    LDX0    567,DU
        23 000633   000000 470400 7                  LDP0    LTS$
        23 000634   000000 740100                    STX0    0,,PR0

  16287 23 000635   200013 470500                    LDP0    PROC_SUPP$,,AUTO
        23 000636   000021 236100                    LDQ     17,,PR0
        23 000637   000000 471400 7                  LDP1    LTS$
        23 000640   100004 756100                    STQ     4,,PR1

  16288 23 000641   200017 236100                    LDQ     TEMP$,,AUTO
        23 000642   100001 756100                    STQ     1,,PR1

  16289 23 000643   200051 473500                    LDP3    @TO$,,AUTO
        23 000644   300000 236100                    LDQ     0,,PR3
        23 000645   100002 756100                    STQ     2,,PR1

  16290 23 000646   200053 474500                    LDP4    @USE_LTS$,,AUTO
        23 000647   400000 475500                    LDP5    0,,PR4
        23 000650   500016 236100                    LDQ     14,,PR5
        23 000651   100003 756100                    STQ     3,,PR1
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:73   

      330    16293    2    PROC_SUPP$ -> PROC_SUPP.IO_RESTORE_CHAIN$ = LTS$ ;

  16293 23 000652   000000 236000 7                  LDQ     LTS$
        23 000653   000021 756100                    STQ     17,,PR0

      331    16294    2    RETURN ;

  16294 23 000654   200050 221300                    LDX1  ! @IO_PTR$+1,,AUTO
        23 000655   000001 702211                    TSX2  ! 1,X1

      332    16295
      333    16296    2   END MOVE_LABEL ;
      334    16297
      335    16298        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:74   
      336    16299        /*===============*/
      337    16300    1     MOVE_MODE_LABEL: PROC (USE$);

  16300 23 000656   200044 741300       MOVE_MODE_L* STX1  ! SAVED_ILS_LIST+8,,AUTO

      338    16301        /*===============*/
      339    16302        /*I*   NAME: MOVE_MODE_LABEL
      340    16303               CALL: CALL MOVE_MODE_LABEL (USE$);
      341    16304              INPUT: USE$ -- Pointer to USE proc for an I/O mode.
      342    16305            PURPOSE: If USE$ is not nil and the USE proc it points to is not in the
      343    16306                     current program then generate the needed moves to activate it.
      344    16307        */
      345    16308    2   DCL USE$ PTR;
      346    16309          /**/
      347    16310    2     IF USE$ ~= ADDR(NIL) THEN

  16310 23 000657   200045 470500                    LDP0    @USE$,,AUTO
        23 000660   000000 236100                    LDQ     0,,PR0
        23 000661   000000 116000 24                 CMPQ    0
        23 000662   000700 600000 23                 TZE     s:16313

      348    16311    2       IF USE$ -> USE.PROC_LABEL$ -> SECTION.PROC$ ~= O1COM.CURRENT_PROC$ THEN

  16311 23 000663   000000 471500                    LDP1    0,,PR0
        23 000664   100002 473500                    LDP3    2,,PR1
        23 000665   300011 236100                    LDQ     9,,PR3
        23 000666   000057 116000 xsym               CMPQ    O1COM+47
        23 000667   000700 600000 23                 TZE     s:16313

      349    16312    2         CALL MOVE_LABEL (USE$ -> USE.TO$, USE$ -> USE.PROC_LABEL$, USE$);

  16312 23 000670   200045 236100                    LDQ     @USE$,,AUTO
        23 000671   200053 756100                    STQ     @USE_LTS$,,AUTO
        23 000672   100002 633500                    EPPR3   2,,PR1
        23 000673   200052 453500                    STP3    @USE_SECT$,,AUTO
        23 000674   100004 634500                    EPPR4   4,,PR1
        23 000675   200051 454500                    STP4    @TO$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:75   
        23 000676   000467 701000 23                 TSX1    MOVE_LABEL
        23 000677   000000 011000                    NOP     0

      350    16313    2   END MOVE_MODE_LABEL;

  16313 23 000700   200044 221300                    LDX1  ! SAVED_ILS_LIST+8,,AUTO
        23 000701   000001 702211                    TSX2  ! 1,X1

      351    16314        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:76   
      352    16315        /*=======================*/
      353    16316    1     CREATE_AND_PRESET_A_PTR: PROC (ST$$, ETT$$) ;

  16316 23 000702   200054 741300       CREATE_AND_* STX1  ! @USE_LTS$+1,,AUTO

      354    16317        /*=======================*/
      355    16318
      356    16319    2    DCL  ST$$     PTR ; /* in:  an ST item (SECTION or NIL)  */
      357    16320    2    DCL  ETT$$    PTR ; /* out: an ETT item (BASE?)          */
      358    16321
      359    16322    2    CALL Z8AT$CREATE_TEMPORARY (%SCALAR, ETT$$) ;

  16322 23 000703   200056 236100                    LDQ     @ETT$$,,AUTO
        23 000704   000031 235000 24                 LDA     25
        23 000705   200060 757100                    STAQ    @ETT$$+2,,AUTO
        23 000706   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000707   000027 631400 24                 EPPR1   23
        23 000710   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        23 000711   000000 011000                    NOP     0

      360    16323
      361    16324         %NEW_ILL (@ID     = %PTR_SET,
      362    16325                   @LOP    = ETT$$,
      363    16326                   @ROP    = ST$$,
      364    16327                   @OFFSET = 0) ;

  16547 23 000712   000034 236000 24                 LDQ     28
        23 000713   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000714   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000715   200065 450500                    STP0    @ETT$$+7,,AUTO
        23 000716   000037 236000 24                 LDQ     31
        23 000717   200064 756100                    STQ     @ETT$$+6,,AUTO
        23 000720   000042 237000 24                 LDAQ    34
        23 000721   200062 757100                    STAQ    @ETT$$+4,,AUTO
        23 000722   200062 630500                    EPPR0   @ETT$$+4,,AUTO
        23 000723   000040 631400 24                 EPPR1   32
        23 000724   000000 701000 xent               TSX1    Z8AN$NEW_ILL
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:77   
        23 000725   000000 011000                    NOP     0

  16551 23 000726   000000 220003                    LDX0    0,DU
        23 000727   000000 470400 13                 LDP0    ILL$
        23 000730   000000 440100                    SXL0    0,,PR0

  16553 23 000731   200056 470500                    LDP0    @ETT$$,,AUTO
        23 000732   000000 236100                    LDQ     0,,PR0
        23 000733   000000 471400 13                 LDP1    ILL$
        23 000734   100001 756100                    STQ     1,,PR1

  16554 23 000735   200055 473500                    LDP3    @ST$$,,AUTO
        23 000736   300000 236100                    LDQ     0,,PR3
        23 000737   100002 756100                    STQ     2,,PR1

      365    16706
      366    16707    2    CALL Z8AF$NEW_BASE (ETT$$, ADDR(NIL), ETT$$) ;

  16707 23 000740   000000 236000 24                 LDQ     0
        23 000741   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000742   200056 236100                    LDQ     @ETT$$,,AUTO
        23 000743   200063 756100                    STQ     @ETT$$+5,,AUTO
        23 000744   200060 634500                    EPPR4   @ETT$$+2,,AUTO
        23 000745   200062 454500                    STP4    @ETT$$+4,,AUTO
        23 000746   200061 756100                    STQ     @ETT$$+3,,AUTO
        23 000747   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 000750   000003 631400 24                 EPPR1   3
        23 000751   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        23 000752   000000 011000                    NOP     0

      367    16708
      368    16709    2    RETURN ;

  16709 23 000753   200054 221300                    LDX1  ! @USE_LTS$+1,,AUTO
        23 000754   000001 702211                    TSX2  ! 1,X1

      369    16710
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:78   
      370    16711    2   END CREATE_AND_PRESET_A_PTR ;
      371    16712
      372    16713        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:79   
      373    16714        /*===========*/
      374    16715    1     IO_MODE_USE: PROC (USE$, USE_TYPE, DO_MOVE);

  16715 23 000755   200044 741300       IO_MODE_USE  STX1  ! SAVED_ILS_LIST+8,,AUTO

      375    16716        /*===========*/
      376    16717        /*I*   NAME: IO_MODE_USE
      377    16718               CALL: CALL IO_MODE_USE (USE$, USE_TYPE, DO_MOVE);
      378    16719              INPUT: USE$ -- Pointer to locally defined USE proc if any, else
      379    16720                             GLOBAL one, for I/O mode.
      380    16721                     USE_TYPE -- Identifier for mode, e.g., %USE_TYPE_IO.
      381    16722                     DO_MOVE -- TRUE if need to generate code to set USE pointer.
      382    16723            PURPOSE: Set up local USE LTS item for GLOBAL USE proc for an I/O mode.
      383    16724        */
      384    16725    2   DCL USE$ PTR;
      385    16726    2   DCL USE_TYPE UBIN;
      386    16727    2   DCL DO_MOVE BIT(1) ALIGNED;
      387    16728    3     IF USE$ = ADDR(NIL) THEN DO;

  16728 23 000756   200045 470500                    LDP0    @USE$,,AUTO
        23 000757   000000 236100                    LDQ     0,,PR0
        23 000760   000000 116000 24                 CMPQ    0
        23 000761   001066 601000 23                 TNZ     s:16841

      388    16729    3       CALL MAKE_OFF (USE_TYPE, ETT$);

  16729 23 000762   000004 236000 24                 LDQ     4
        23 000763   200052 756100                    STQ     @USE_SECT$,,AUTO
        23 000764   200046 236100                    LDQ     @USE_TYPE,,AUTO
        23 000765   200051 756100                    STQ     @TO$,,AUTO
        23 000766   000312 701000 23                 TSX1    MAKE_OFF
        23 000767   000000 011000                    NOP     0

      389    16730            %NEW_USE_LTS (@POINTER = USE_LTS$,
      390    16731                          @TYPE = %USE_TYPE_NIL,
      391    16732                          @TO$ = ETT$,
      392    16733                          @LINK$ =
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:80   
             16733                            O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             16733                              );

  16811 23 000770   000002 236000 8                  LDQ     LTS_+2
        23 000771   000022 036007                    ADLQ    18,DL
        23 000772   000003 116000 8                  CMPQ    LTS_+3
        23 000773   001004 604000 23                 TMI     s:16813

  16812 23 000774   000002 236000 24                 LDQ     2
        23 000775   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 000776   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 000777   200061 450500                    STP0    @ETT$$+3,,AUTO
        23 001000   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 001001   000001 631400 24                 EPPR1   1
        23 001002   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 001003   000000 011000                    NOP     0

  16813 23 001004   000002 236000 8                  LDQ     LTS_+2
        23 001005   000022 736000                    QLS     18
        23 001006   000001 036000 8                  ADLQ    LTS_+1
        23 001007   200021 756100                    STQ     USE_LTS$,,AUTO

  16814 23 001010   000022 236007                    LDQ     18,DL
        23 001011   000002 056000 8                  ASQ     LTS_+2

  16815 23 001012   001100 220003                    LDX0    576,DU
        23 001013   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001014   000000 740100                    STX0    0,,PR0

  16821 23 001015   000000 236000 24                 LDQ     0
        23 001016   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001017   000001 756100                    STQ     1,,PR0

  16823 23 001020   000011 236000 24                 LDQ     9
        23 001021   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001022   000002 756100                    STQ     2,,PR0

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:81   
  16827 23 001023   000057 470400 xsym               LDP0    O1COM+47
        23 001024   000001 471500                    LDP1    1,,PR0
        23 001025   100022 236100                    LDQ     18,,PR1
        23 001026   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001027   300003 756100                    STQ     3,,PR3

  16828 23 001030   000000 236000 9                  LDQ     ETT$
        23 001031   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001032   000004 756100                    STQ     4,,PR0

  16829 23 001033   000010 221003                    LDX1    8,DU
        23 001034   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001035   000000 441100                    SXL1    0,,PR0

  16830 23 001036   000000 236000 24                 LDQ     0
        23 001037   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001040   000007 756100                    STQ     7,,PR0

  16831 23 001041   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001042   000010 756100                    STQ     8,,PR0

  16832 23 001043   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001044   000015 756100                    STQ     13,,PR0

  16833 23 001045   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001046   000017 756100                    STQ     15,,PR0

  16834 23 001047   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001050   000016 756100                    STQ     14,,PR0

  16835 23 001051   000000 222003                    LDX2    0,DU
        23 001052   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001053   000020 742100                    STX2    16,,PR0

  16836 23 001054   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001055   000020 442100                    SXL2    16,,PR0

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:82   
      393    16839    3       CALL CREATE_AND_PRESET_A_PTR (ENTADDR(NIL), USE_LTS$ -> USE.INIT_LABEL_BASE$);

  16839 23 001056   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 001057   000016 036003                    ADLQ    14,DU
        23 001060   200056 756100                    STQ     @ETT$$,,AUTO
        23 001061   000042 236000 24                 LDQ     34
        23 001062   200055 756100                    STQ     @ST$$,,AUTO
        23 001063   000702 701000 23                 TSX1    CREATE_AND_PRESET_A_PTR
        23 001064   000000 011000                    NOP     0

      394    16840    3     END;

  16840 23 001065   001206 710000 23                 TRA     s:16960

      395    16841    2     ELSE IF USE$ -> USE.PROC_LABEL$ -> SECTION.PROC$ = O1COM.CURRENT_PROC$

  16841 23 001066   000000 471500                    LDP1    0,,PR0
        23 001067   100002 473500                    LDP3    2,,PR1
        23 001070   300011 236100                    LDQ     9,,PR3
        23 001071   000057 116000 xsym               CMPQ    O1COM+47
        23 001072   001074 601000 23                 TNZ     s:16928

      396    16842    2       THEN RETURN;

  16842 23 001073   000001 702211                    TSX2  ! 1,X1

      397    16843    3     ELSE DO;

      398    16844            %NEW_USE_LTS (@POINTER = USE_LTS$,
      399    16845                          @TYPE = USE_TYPE,
      400    16846                          @PROC_CHAIN$ = COMCOM.USE_PROC_CHAIN$,
      401    16847                          @LINK$ =
             16847                            O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             16847                              ,
      402    16848                          @INIT_LABEL_BASE$ = USE$ -> USE.INIT_LABEL_BASE$,
      403    16849                          @TO$ = USE$ -> USE.TO$,
      404    16850                          @PROC_LABEL$ = USE$ -> USE.PROC_LABEL$);
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:83   

  16928 23 001074   000002 236000 8                  LDQ     LTS_+2
        23 001075   000022 036007                    ADLQ    18,DL
        23 001076   000003 116000 8                  CMPQ    LTS_+3
        23 001077   001110 604000 23                 TMI     s:16930

  16929 23 001100   000002 236000 24                 LDQ     2
        23 001101   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 001102   200060 631500                    EPPR1   @ETT$$+2,,AUTO
        23 001103   200061 451500                    STP1    @ETT$$+3,,AUTO
        23 001104   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 001105   000001 631400 24                 EPPR1   1
        23 001106   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 001107   000000 011000                    NOP     0

  16930 23 001110   000002 236000 8                  LDQ     LTS_+2
        23 001111   000022 736000                    QLS     18
        23 001112   000001 036000 8                  ADLQ    LTS_+1
        23 001113   200021 756100                    STQ     USE_LTS$,,AUTO

  16931 23 001114   000022 236007                    LDQ     18,DL
        23 001115   000002 056000 8                  ASQ     LTS_+2

  16932 23 001116   001100 220003                    LDX0    576,DU
        23 001117   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001120   000000 740100                    STX0    0,,PR0

  16938 23 001121   000476 236000 xsym               LDQ     COMCOM+318
        23 001122   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001123   000001 756100                    STQ     1,,PR0

  16942 23 001124   200045 470500                    LDP0    @USE$,,AUTO
        23 001125   000000 471500                    LDP1    0,,PR0
        23 001126   100002 236100                    LDQ     2,,PR1
        23 001127   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001130   300002 756100                    STQ     2,,PR3

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:84   
  16944 23 001131   000057 471400 xsym               LDP1    O1COM+47
        23 001132   100001 473500                    LDP3    1,,PR1
        23 001133   300022 236100                    LDQ     18,,PR3
        23 001134   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 001135   400003 756100                    STQ     3,,PR4

  16945 23 001136   000000 471500                    LDP1    0,,PR0
        23 001137   100004 236100                    LDQ     4,,PR1
        23 001140   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001141   300004 756100                    STQ     4,,PR3

  16946 23 001142   200046 471500                    LDP1    @USE_TYPE,,AUTO
        23 001143   100000 721100                    LXL1    0,,PR1
        23 001144   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001145   300000 441100                    SXL1    0,,PR3

  16947 23 001146   000000 236000 24                 LDQ     0
        23 001147   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001150   300007 756100                    STQ     7,,PR3

  16948 23 001151   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001152   300010 756100                    STQ     8,,PR3

  16949 23 001153   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001154   300015 756100                    STQ     13,,PR3

  16950 23 001155   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001156   300017 756100                    STQ     15,,PR3

  16951 23 001157   000000 473500                    LDP3    0,,PR0
        23 001160   300016 236100                    LDQ     14,,PR3
        23 001161   200021 474500                    LDP4    USE_LTS$,,AUTO
        23 001162   400016 756100                    STQ     14,,PR4

  16952 23 001163   000000 221003                    LDX1    0,DU
        23 001164   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001165   300020 741100                    STX1    16,,PR3
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:85   

  16953 23 001166   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001167   300020 441100                    SXL1    16,,PR3

      405    16956    3       COMCOM.USE_PROC_CHAIN$ = USE_LTS$;

  16956 23 001170   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 001171   000476 756000 xsym               STQ     COMCOM+318

      406    16957    3       IF DO_MOVE THEN

  16957 23 001172   200047 473500                    LDP3    @DO_MOVE,,AUTO
        23 001173   300000 234100                    SZN     0,,PR3
        23 001174   001206 605000 23                 TPL     s:16960

      407    16958    3         CALL MOVE_LABEL (USE$ -> USE.TO$, USE$ -> USE.PROC_LABEL$, USE_LTS$);

  16958 23 001175   000000 474500                    LDP4    0,,PR0
        23 001176   200021 635500                    EPPR5   USE_LTS$,,AUTO
        23 001177   200053 455500                    STP5    @USE_LTS$,,AUTO
        23 001200   400002 636500                    EPPR6   2,,PR4
        23 001201   200052 456500                    STP6    @USE_SECT$,,AUTO
        23 001202   400004 637500                    EPPR7   4,,PR4
        23 001203   200051 457500                    STP7    @TO$,,AUTO
        23 001204   000467 701000 23                 TSX1    MOVE_LABEL
        23 001205   000000 011000                    NOP     0

      408    16959    3     END;

      409    16960    2     O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ = USE_LTS$;

  16960 23 001206   000057 470400 xsym               LDP0    O1COM+47
        23 001207   000001 471500                    LDP1    1,,PR0
        23 001210   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 001211   100022 756100                    STQ     18,,PR1

      410    16961    2   END IO_MODE_USE;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:86   

  16961 23 001212   200044 221300                    LDX1  ! SAVED_ILS_LIST+8,,AUTO
        23 001213   000001 702211                    TSX2  ! 1,X1

      411    16962        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:87   
      412    16963        /*==============*/
      413    16964    1     MAKE_USE_SUPPS: PROC(IN_PTR$, OUT_PTR$, IO_PTR$, EXT_PTR$);

  16964 23 001214   200044 741300       MAKE_USE_SU* STX1  ! SAVED_ILS_LIST+8,,AUTO

      414    16965        /*==============*/
      415    16966        /*I*   NAME: MAKE_USE_SUPPS
      416    16967               CALL: CALL MAKE_USE_SUPPS (IN_PTR$, OUT_PTR$, IO_PTR$, EXT_PTR$);
      417    16968             OUTPUT: IN_PTR$ -- Pointer to entry label for USE proc for INPUT, if the
      418    16969                                current program contains one or if there is a GLOBAL
      419    16970                                USE proc that has this program in its scope.
      420    16971                     OUT_PTR$ -- Same for OUTPUT.
      421    16972                     IO_PTR$ -- Same for IO.
      422    16973                     EXT_PTR$ -- Same for EXTEND.
      423    16974            PURPOSE: Build chain of USE_SUPP items for all GLOBAL files for which the
      424    16975                     current program does not contain any USE proc. Make sure that for
      425    16976                     each GLOBAL USE proc that has the current program in its range,
      426    16977                     the current program has an entry in its USE chain; if there is none
      427    16978                     for a particular file, then insert a null USE LTS item. Set
      428    16979                     IN_PTR$, etc., as appropriate.
      429    16980        */
      430    16981    2   DCL IN_PTR$ PTR;
      431    16982    2   DCL OUT_PTR$ PTR;
      432    16983    2   DCL IO_PTR$ PTR;
      433    16984    2   DCL EXT_PTR$ PTR;
      434    16985    2     IN_PTR$ = ADDR(NIL);

  16985 23 001215   000000 236000 24                 LDQ     0
        23 001216   200045 470500                    LDP0    @IN_PTR$,,AUTO
        23 001217   000000 756100                    STQ     0,,PR0

      435    16986    2     IO_PTR$ = ADDR(NIL);

  16986 23 001220   000000 236000 24                 LDQ     0
        23 001221   200047 471500                    LDP1    @IO_PTR$,,AUTO
        23 001222   100000 756100                    STQ     0,,PR1

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:88   
      436    16987    2     OUT_PTR$ = ADDR(NIL);

  16987 23 001223   000000 236000 24                 LDQ     0
        23 001224   200046 473500                    LDP3    @OUT_PTR$,,AUTO
        23 001225   300000 756100                    STQ     0,,PR3

      437    16988    2     EXT_PTR$ = ADDR(NIL);

  16988 23 001226   000000 236000 24                 LDQ     0
        23 001227   200050 474500                    LDP4    @EXT_PTR$,,AUTO
        23 001230   400000 756100                    STQ     0,,PR4

      438    16989    2     GLOBAL_USE_SUPP_CHAIN$ = ADDR(NIL);

  16989 23 001231   000000 236000 24                 LDQ     0
        23 001232   000004 756000 21                 STQ     GLOBAL_USE_SUPP_CHAIN$

      439    16990    2     FILE_LTS$ = COMCOM.FILE_LTS_CHAIN$;

  16990 23 001233   000434 236000 xsym               LDQ     COMCOM+284
        23 001234   200012 756100                    STQ     FILE_LTS$,,AUTO

      440    16991    3     DO WHILE FILE_LTS$ ~= ADDR(NIL);

  16991 23 001235   001334 710000 23                 TRA     s:17108

      441    16992    3       IF FILE_LTS$ -> FILE_LTS.B.GLOBAL THEN

  16992 23 001236   200012 470500                    LDP0    FILE_LTS$,,AUTO
        23 001237   000017 236100                    LDQ     15,,PR0
        23 001240   000200 316003                    CANQ    128,DU
        23 001241   001331 600000 23                 TZE     s:17107

      442    16993    4   CHECK_GLOBAL_FILE: DO;

  16993 23 001242                       CHECK_GLOBA* null
      443    16994    4           PROC$ = FILE_LTS$ -> FILE_LTS.ST$ -> FD.PROC$;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:89   

  16994 23 001242   000001 471500                    LDP1    1,,PR0
        23 001243   100011 236100                    LDQ     9,,PR1
        23 001244   200014 756100                    STQ     PROC$,,AUTO

      444    16995    4           CONTAINING_PROC$ = O1COM.CURRENT_PROC$ -> PROC_.FATHER;

  16995 23 001245   000057 473400 xsym               LDP3    O1COM+47
        23 001246   300011 236100                    LDQ     9,,PR3
        23 001247   200026 756100                    STQ     CONTAINING_PROC$,,AUTO

      445    16996    5   ACCESSIBLE_HERE: DO;

  16996 23 001250                       ACCESSIBLE_* null
      446    16997    6             DO WHILE CONTAINING_PROC$ ~= ADDR(NIL);

  16997 23 001250   001257 710000 23                 TRA     s:17000

      447    16998    6               IF CONTAINING_PROC$ = PROC$ THEN EXIT ACCESSIBLE_HERE;

  16998 23 001251   200026 236100                    LDQ     CONTAINING_PROC$,,AUTO
        23 001252   200014 116100                    CMPQ    PROC$,,AUTO
        23 001253   001262 600000 23                 TZE     s:17083

      448    16999    6               CONTAINING_PROC$ = CONTAINING_PROC$ -> PROC_.FATHER;

  16999 23 001254   200026 470500                    LDP0    CONTAINING_PROC$,,AUTO
        23 001255   000011 236100                    LDQ     9,,PR0
        23 001256   200026 756100                    STQ     CONTAINING_PROC$,,AUTO

      449    17000    6             END;

  17000 23 001257   000000 116000 24                 CMPQ    0
        23 001260   001251 601000 23                 TNZ     s:16998

      450    17001    5             EXIT CHECK_GLOBAL_FILE;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:90   
  17001 23 001261   001331 710000 23                 TRA     s:17107

      451    17002    5           END; /* ACCESSIBLE_HERE */
      452    17003                %NEW_USE_SUPP (@POINTER = TEMP$,
      453    17004                               @LINK$ = GLOBAL_USE_SUPP_CHAIN$,
      454    17005                               @FILE_LTS$ = FILE_LTS$);

  17083 23 001262   000002 236000 8                  LDQ     LTS_+2
        23 001263   000007 036007                    ADLQ    7,DL
        23 001264   000003 116000 8                  CMPQ    LTS_+3
        23 001265   001276 604000 23                 TMI     s:17085

  17084 23 001266   000002 236000 24                 LDQ     2
        23 001267   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 001270   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 001271   200061 450500                    STP0    @ETT$$+3,,AUTO
        23 001272   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 001273   000001 631400 24                 EPPR1   1
        23 001274   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 001275   000000 011000                    NOP     0

  17085 23 001276   000002 236000 8                  LDQ     LTS_+2
        23 001277   000022 736000                    QLS     18
        23 001300   000001 036000 8                  ADLQ    LTS_+1
        23 001301   200017 756100                    STQ     TEMP$,,AUTO

  17086 23 001302   000007 236007                    LDQ     7,DL
        23 001303   000002 056000 8                  ASQ     LTS_+2

  17087 23 001304   001064 220003                    LDX0    564,DU
        23 001305   200017 470500                    LDP0    TEMP$,,AUTO
        23 001306   000000 740100                    STX0    0,,PR0

  17093 23 001307   200012 236100                    LDQ     FILE_LTS$,,AUTO
        23 001310   200017 470500                    LDP0    TEMP$,,AUTO
        23 001311   000001 756100                    STQ     1,,PR0

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:91   
  17095 23 001312   000011 236000 24                 LDQ     9
        23 001313   200017 470500                    LDP0    TEMP$,,AUTO
        23 001314   000002 756100                    STQ     2,,PR0

  17099 23 001315   000000 236000 24                 LDQ     0
        23 001316   200017 470500                    LDP0    TEMP$,,AUTO
        23 001317   000003 756100                    STQ     3,,PR0

  17100 23 001320   200017 470500                    LDP0    TEMP$,,AUTO
        23 001321   000004 756100                    STQ     4,,PR0

  17101 23 001322   200017 470500                    LDP0    TEMP$,,AUTO
        23 001323   000005 756100                    STQ     5,,PR0

  17102 23 001324   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 001325   200017 470500                    LDP0    TEMP$,,AUTO
        23 001326   000006 756100                    STQ     6,,PR0

      455    17105    4           GLOBAL_USE_SUPP_CHAIN$ = TEMP$;

  17105 23 001327   200017 236100                    LDQ     TEMP$,,AUTO
        23 001330   000004 756000 21                 STQ     GLOBAL_USE_SUPP_CHAIN$

      456    17106    4         END; /* CHECK_GLOBAL_FILE */

      457    17107    3       FILE_LTS$ = FILE_LTS$ -> FILE_LTS.FILE_LTS_CHAIN$;

  17107 23 001331   200012 470500                    LDP0    FILE_LTS$,,AUTO
        23 001332   000003 236100                    LDQ     3,,PR0
        23 001333   200012 756100                    STQ     FILE_LTS$,,AUTO

      458    17108    3     END; /* WHILE */

  17108 23 001334   000000 116000 24                 CMPQ    0
        23 001335   001236 601000 23                 TNZ     s:16992

      459    17109          /* Chain of GLOBAL files complete */
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:92   
      460    17110
      461    17111    2     USE$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;

  17111 23 001336   000057 470400 xsym               LDP0    O1COM+47
        23 001337   000001 471500                    LDP1    1,,PR0
        23 001340   100022 236100                    LDQ     18,,PR1
        23 001341   200020 756100                    STQ     USE$,,AUTO

      462    17112    3     DO WHILE USE$ ~= ADDR(NIL);

  17112 23 001342   001452 710000 23                 TRA     s:17147

      463    17113    4       DO CASE (USE$ -> USE.TYPE);

  17113 23 001343   200020 470500                    LDP0    USE$,,AUTO
        23 001344   000000 720100                    LXL0    0,,PR0
        23 001345   000006 100003                    CMPX0   6,DU
        23 001346   001350 602010 23                 TNC     s:17113+5,X0
        23 001347   001447 710000 23                 TRA     s:17146
        23 001350   001447 710000 23                 TRA     s:17146
        23 001351   001430 710000 23                 TRA     s:17138
        23 001352   001440 710000 23                 TRA     s:17142
        23 001353   001444 710000 23                 TRA     s:17144
        23 001354   001434 710000 23                 TRA     s:17140
        23 001355   001356 710000 23                 TRA     s:17117

      464    17114    4         CASE (%USE_TYPE_FILE);

      465    17115                %FISH (TRIAD = USE$ -> USE.TO$, RTN = FAB$);

  17117 23 001356   000004 236100                    LDQ     4,,PR0
        23 001357   200025 756100                    STQ     FAB$,,AUTO

  17118 23 001360   200025 471500                    LDP1    FAB$,,AUTO
        23 001361   100000 221100                    LDX1    0,,PR1
        23 001362   000751 101003                    CMPX1   489,DU
        23 001363   001373 603000 23                 TRC     s:17123
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:93   

  17119 23 001364   200025 470500                    LDP0    FAB$,,AUTO
        23 001365   000001 236100                    LDQ     1,,PR0
        23 001366   200025 756100                    STQ     FAB$,,AUTO

  17120 23 001367   200025 470500                    LDP0    FAB$,,AUTO
        23 001370   000000 220100                    LDX0    0,,PR0
        23 001371   000751 100003                    CMPX0   489,DU
        23 001372   001364 602000 23                 TNC     s:17119

      466    17123    4           PREV_USE_SUPP$ = ADDR(NIL);

  17123 23 001373   000000 236000 24                 LDQ     0
        23 001374   200033 756100                    STQ     PREV_USE_SUPP$,,AUTO

      467    17124    4           TEMP$ = GLOBAL_USE_SUPP_CHAIN$;

  17124 23 001375   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 001376   200017 756100                    STQ     TEMP$,,AUTO

      468    17125    5           DO WHILE TEMP$ ~= ADDR(NIL);

  17125 23 001377   001425 710000 23                 TRA     s:17136

      469    17126    6             IF FAB$ = TEMP$ -> USE_SUPP.FILE_LTS$ -> FILE_LTS.FAB$ THEN DO;

  17126 23 001400   200017 470500                    LDP0    TEMP$,,AUTO
        23 001401   000001 471500                    LDP1    1,,PR0
        23 001402   200025 236100                    LDQ     FAB$,,AUTO
        23 001403   100002 116100                    CMPQ    2,,PR1
        23 001404   001421 601000 23                 TNZ     s:17133

      470    17127    6               IF PREV_USE_SUPP$ = ADDR(NIL)

  17127 23 001405   200033 236100                    LDQ     PREV_USE_SUPP$,,AUTO
        23 001406   000000 116000 24                 CMPQ    0
        23 001407   001413 601000 23                 TNZ     s:17129
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:94   

      471    17128    6                 THEN GLOBAL_USE_SUPP_CHAIN$ = TEMP$ -> USE_SUPP.LINK$;

  17128 23 001410   000006 236100                    LDQ     6,,PR0
        23 001411   000004 756000 21                 STQ     GLOBAL_USE_SUPP_CHAIN$
        23 001412   001416 710000 23                 TRA     s:17130

      472    17129    6                 ELSE PREV_USE_SUPP$ -> USE_SUPP.LINK$ = TEMP$ -> USE_SUPP.LINK$;

  17129 23 001413   000006 236100                    LDQ     6,,PR0
        23 001414   200033 473500                    LDP3    PREV_USE_SUPP$,,AUTO
        23 001415   300006 756100                    STQ     6,,PR3

      473    17130    6               TEMP$ = ADDR(NIL); /* Local USE proc - delink file from chain */

  17130 23 001416   000000 236000 24                 LDQ     0
        23 001417   200017 756100                    STQ     TEMP$,,AUTO

      474    17131    6             END;

  17131 23 001420   001425 710000 23                 TRA     s:17136

      475    17132    6             ELSE DO;

      476    17133    6               PREV_USE_SUPP$ = TEMP$;

  17133 23 001421   200017 236100                    LDQ     TEMP$,,AUTO
        23 001422   200033 756100                    STQ     PREV_USE_SUPP$,,AUTO

      477    17134    6               TEMP$ = TEMP$ -> USE_SUPP.LINK$;

  17134 23 001423   000006 236100                    LDQ     6,,PR0
        23 001424   200017 756100                    STQ     TEMP$,,AUTO

      478    17135    6             END;

      479    17136    5           END; /* WHILE */
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:95   

  17136 23 001425   000000 116000 24                 CMPQ    0
        23 001426   001400 601000 23                 TNZ     s:17126
        23 001427   001447 710000 23                 TRA     s:17146

      480    17137    4         CASE (%USE_TYPE_INPUT);

      481    17138    4           IN_PTR$ = USE$;

  17138 23 001430   200020 236100                    LDQ     USE$,,AUTO
        23 001431   200045 471500                    LDP1    @IN_PTR$,,AUTO
        23 001432   100000 756100                    STQ     0,,PR1
        23 001433   001447 710000 23                 TRA     s:17146

      482    17139    4         CASE (%USE_TYPE_IO);

      483    17140    4           IO_PTR$ = USE$;

  17140 23 001434   200020 236100                    LDQ     USE$,,AUTO
        23 001435   200047 471500                    LDP1    @IO_PTR$,,AUTO
        23 001436   100000 756100                    STQ     0,,PR1
        23 001437   001447 710000 23                 TRA     s:17146

      484    17141    4         CASE (%USE_TYPE_OUTPUT);

      485    17142    4           OUT_PTR$ = USE$;

  17142 23 001440   200020 236100                    LDQ     USE$,,AUTO
        23 001441   200046 471500                    LDP1    @OUT_PTR$,,AUTO
        23 001442   100000 756100                    STQ     0,,PR1
        23 001443   001447 710000 23                 TRA     s:17146

      486    17143    4         CASE (%USE_TYPE_EXTEND);

      487    17144    4           EXT_PTR$ = USE$;

  17144 23 001444   200020 236100                    LDQ     USE$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:96   
        23 001445   200050 471500                    LDP1    @EXT_PTR$,,AUTO
        23 001446   100000 756100                    STQ     0,,PR1

      488    17145    4       END; /* CASE */

      489    17146    3       USE$ = USE$ -> USE.LINK$;

  17146 23 001447   200020 470500                    LDP0    USE$,,AUTO
        23 001450   000003 236100                    LDQ     3,,PR0
        23 001451   200020 756100                    STQ     USE$,,AUTO

      490    17147    3     END; /* WHILE */

  17147 23 001452   000000 116000 24                 CMPQ    0
        23 001453   001343 601000 23                 TNZ     s:17113

      491    17148
      492    17149    2     CONTAINING_PROC$ = O1COM.CURRENT_PROC$ -> PROC_.FATHER;

  17149 23 001454   000057 470400 xsym               LDP0    O1COM+47
        23 001455   000011 236100                    LDQ     9,,PR0
        23 001456   200026 756100                    STQ     CONTAINING_PROC$,,AUTO

      493    17150    3     DO WHILE CONTAINING_PROC$ ~= ADDR(NIL);

  17150 23 001457   001622 710000 23                 TRA     s:17194

      494    17151    3       USE$ = CONTAINING_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;

  17151 23 001460   200026 470500                    LDP0    CONTAINING_PROC$,,AUTO
        23 001461   000001 471500                    LDP1    1,,PR0
        23 001462   100022 236100                    LDQ     18,,PR1
        23 001463   200020 756100                    STQ     USE$,,AUTO

      495    17152    4       DO WHILE USE$ ~= ADDR(NIL);

  17152 23 001464   001615 710000 23                 TRA     s:17191
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:97   

      496    17153    4         IF USE$ -> USE.TYPE ~= %USE_TYPE_NIL AND

  17153 23 001465   200020 470500                    LDP0    USE$,,AUTO
        23 001466   000000 720100                    LXL0    0,,PR0
        23 001467   000010 100003                    CMPX0   8,DU
        23 001470   001612 600000 23                 TZE     s:17190
        23 001471   000002 471500                    LDP1    2,,PR0
        23 001472   100003 236100                    LDQ     3,,PR1
        23 001473   004000 316007                    CANQ    2048,DL
        23 001474   001612 600000 23                 TZE     s:17190

      497    17154    4             USE$ -> USE.PROC_LABEL$ -> SECTION.B.USE_GLOBAL THEN
      498    17155    5           DO CASE (USE$ -> USE.TYPE);

  17155 23 001475   000006 100003                    CMPX0   6,DU
        23 001476   001500 602010 23                 TNC     s:17155+3,X0
        23 001477   001612 710000 23                 TRA     s:17190
        23 001500   001612 710000 23                 TRA     s:17190
        23 001501   001557 710000 23                 TRA     s:17178
        23 001502   001575 710000 23                 TRA     s:17184
        23 001503   001604 710000 23                 TRA     s:17187
        23 001504   001566 710000 23                 TRA     s:17181
        23 001505   001506 710000 23                 TRA     s:17159

      499    17156    5             CASE (%USE_TYPE_FILE);

      500    17157                    %FISH (TRIAD = USE$ -> USE.TO$, RTN =FAB$);

  17159 23 001506   000004 236100                    LDQ     4,,PR0
        23 001507   200025 756100                    STQ     FAB$,,AUTO

  17160 23 001510   200025 473500                    LDP3    FAB$,,AUTO
        23 001511   300000 221100                    LDX1    0,,PR3
        23 001512   000751 101003                    CMPX1   489,DU
        23 001513   001523 603000 23                 TRC     s:17165

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:98   
  17161 23 001514   200025 470500                    LDP0    FAB$,,AUTO
        23 001515   000001 236100                    LDQ     1,,PR0
        23 001516   200025 756100                    STQ     FAB$,,AUTO

  17162 23 001517   200025 470500                    LDP0    FAB$,,AUTO
        23 001520   000000 220100                    LDX0    0,,PR0
        23 001521   000751 100003                    CMPX0   489,DU
        23 001522   001514 602000 23                 TNC     s:17161

      501    17165    5               TEMP$ = GLOBAL_USE_SUPP_CHAIN$;

  17165 23 001523   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 001524   200017 756100                    STQ     TEMP$,,AUTO

      502    17166    6               DO WHILE TEMP$ ~= ADDR(NIL);

  17166 23 001525   001554 710000 23                 TRA     s:17176

      503    17167    6                 IF TEMP$ -> USE_SUPP.PROC_LABEL_EPTR = ENTADDR(NIL) AND

  17167 23 001526   200017 470500                    LDP0    TEMP$,,AUTO
        23 001527   000002 236100                    LDQ     2,,PR0
        23 001530   000011 116000 24                 CMPQ    9
        23 001531   001552 601000 23                 TNZ     s:17175
        23 001532   000001 471500                    LDP1    1,,PR0
        23 001533   100002 236100                    LDQ     2,,PR1
        23 001534   200025 116100                    CMPQ    FAB$,,AUTO
        23 001535   001552 601000 23                 TNZ     s:17175

      504    17168    6                     TEMP$ -> USE_SUPP.FILE_LTS$ -> FILE_LTS.FAB$ = FAB$ THEN
      505    17169    7                   DO;

      506    17170    7                     TEMP$ -> USE_SUPP.PROC_LABEL$ = USE$ -> USE.PROC_LABEL$;

  17170 23 001536   200020 473500                    LDP3    USE$,,AUTO
        23 001537   300002 236100                    LDQ     2,,PR3
        23 001540   000002 756100                    STQ     2,,PR0
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:99   

      507    17171    7                     TEMP$ -> USE_SUPP.TO$ = USE$ -> USE.TO$;

  17171 23 001541   300004 236100                    LDQ     4,,PR3
        23 001542   200017 470500                    LDP0    TEMP$,,AUTO
        23 001543   000003 756100                    STQ     3,,PR0

      508    17172    7                    TEMP$ -> USE_SUPP.INIT_LABEL_BASE$ = USE$ -> USE.INIT_LABEL_BASE$;

  17172 23 001544   300016 236100                    LDQ     14,,PR3
        23 001545   200017 470500                    LDP0    TEMP$,,AUTO
        23 001546   000005 756100                    STQ     5,,PR0

      509    17173    7                     TEMP$ = ADDR(NIL);

  17173 23 001547   000000 236000 24                 LDQ     0
        23 001550   200017 756100                    STQ     TEMP$,,AUTO

      510    17174    7                   END;

  17174 23 001551   001554 710000 23                 TRA     s:17176

      511    17175    6                 ELSE TEMP$ = TEMP$ -> USE_SUPP.LINK$;

  17175 23 001552   000006 236100                    LDQ     6,,PR0
        23 001553   200017 756100                    STQ     TEMP$,,AUTO

      512    17176    6               END;

  17176 23 001554   000000 116000 24                 CMPQ    0
        23 001555   001526 601000 23                 TNZ     s:17167
        23 001556   001612 710000 23                 TRA     s:17190

      513    17177    5             CASE (%USE_TYPE_INPUT);

      514    17178    5               IF IN_PTR$ = ADDR(NIL) THEN

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:100  
  17178 23 001557   200045 473500                    LDP3    @IN_PTR$,,AUTO
        23 001560   300000 236100                    LDQ     0,,PR3
        23 001561   000000 116000 24                 CMPQ    0
        23 001562   001612 601000 23                 TNZ     s:17190

      515    17179    5                 IN_PTR$ = USE$;

  17179 23 001563   200020 236100                    LDQ     USE$,,AUTO
        23 001564   300000 756100                    STQ     0,,PR3
        23 001565   001612 710000 23                 TRA     s:17190

      516    17180    5             CASE (%USE_TYPE_IO);

      517    17181    5               IF IO_PTR$ = ADDR(NIL) THEN

  17181 23 001566   200047 473500                    LDP3    @IO_PTR$,,AUTO
        23 001567   300000 236100                    LDQ     0,,PR3
        23 001570   000000 116000 24                 CMPQ    0
        23 001571   001612 601000 23                 TNZ     s:17190

      518    17182    5                 IO_PTR$ = USE$;

  17182 23 001572   200020 236100                    LDQ     USE$,,AUTO
        23 001573   300000 756100                    STQ     0,,PR3
        23 001574   001612 710000 23                 TRA     s:17190

      519    17183    5             CASE (%USE_TYPE_OUTPUT);

      520    17184    5               IF OUT_PTR$ = ADDR(NIL) THEN

  17184 23 001575   200046 473500                    LDP3    @OUT_PTR$,,AUTO
        23 001576   300000 236100                    LDQ     0,,PR3
        23 001577   000000 116000 24                 CMPQ    0
        23 001600   001612 601000 23                 TNZ     s:17190

      521    17185    5                 OUT_PTR$ = USE$;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:101  
  17185 23 001601   200020 236100                    LDQ     USE$,,AUTO
        23 001602   300000 756100                    STQ     0,,PR3
        23 001603   001612 710000 23                 TRA     s:17190

      522    17186    5             CASE (%USE_TYPE_EXTEND);

      523    17187    5               IF EXT_PTR$ = ADDR(NIL) THEN

  17187 23 001604   200050 473500                    LDP3    @EXT_PTR$,,AUTO
        23 001605   300000 236100                    LDQ     0,,PR3
        23 001606   000000 116000 24                 CMPQ    0
        23 001607   001612 601000 23                 TNZ     s:17190

      524    17188    5                 EXT_PTR$ = USE$;

  17188 23 001610   200020 236100                    LDQ     USE$,,AUTO
        23 001611   300000 756100                    STQ     0,,PR3

      525    17189    5           END; /* CASE */

      526    17190    4         USE$ = USE$ -> USE.LINK$;

  17190 23 001612   200020 470500                    LDP0    USE$,,AUTO
        23 001613   000003 236100                    LDQ     3,,PR0
        23 001614   200020 756100                    STQ     USE$,,AUTO

      527    17191    4       END; /* WHILE */

  17191 23 001615   000000 116000 24                 CMPQ    0
        23 001616   001465 601000 23                 TNZ     s:17153

      528    17192
      529    17193    3       CONTAINING_PROC$ = CONTAINING_PROC$ -> PROC_.FATHER;

  17193 23 001617   200026 470500                    LDP0    CONTAINING_PROC$,,AUTO
        23 001620   000011 236100                    LDQ     9,,PR0
        23 001621   200026 756100                    STQ     CONTAINING_PROC$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:102  

      530    17194    3     END; /* WHILE */

  17194 23 001622   000000 116000 24                 CMPQ    0
        23 001623   001460 601000 23                 TNZ     s:17151

      531    17195
      532    17196    2     TEMP$ = GLOBAL_USE_SUPP_CHAIN$;

  17196 23 001624   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 001625   200017 756100                    STQ     TEMP$,,AUTO

      533    17197    3     DO WHILE TEMP$ ~= ADDR(NIL);

  17197 23 001626   002012 710000 23                 TRA     s:17334

      534    17198    4       IF TEMP$ -> USE_SUPP.PROC_LABEL_EPTR = ENTADDR(NIL) THEN DO;

  17198 23 001627   200017 470500                    LDP0    TEMP$,,AUTO
        23 001630   000002 236100                    LDQ     2,,PR0
        23 001631   000011 116000 24                 CMPQ    9
        23 001632   001674 601000 23                 TNZ     s:17213

      535    17199    4         USE_CHAIN$ = ADDR(NIL);

  17199 23 001633   000000 236000 24                 LDQ     0
        23 001634   200032 756100                    STQ     USE_CHAIN$,,AUTO

      536    17200    4         CONTAINING_USE_TYPE = %USE_TYPE_NIL;

  17200 23 001635   000010 235007                    LDA     8,DL
        23 001636   200030 755100                    STA     CONTAINING_USE_TYPE,,AUTO

      537    17201    4         CALL Z8AF$NEW_BASE (TEMP$ -> USE_SUPP.FILE_LTS$

  17201 23 001637   000001 471500                    LDP1    1,,PR0
        23 001640   200060 756100                    STQ     @ETT$$+2,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:103  
        23 001641   000004 236000 24                 LDQ     4
        23 001642   200063 756100                    STQ     @ETT$$+5,,AUTO
        23 001643   200060 633500                    EPPR3   @ETT$$+2,,AUTO
        23 001644   200062 453500                    STP3    @ETT$$+4,,AUTO
        23 001645   100002 634500                    EPPR4   2,,PR1
        23 001646   200061 454500                    STP4    @ETT$$+3,,AUTO
        23 001647   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 001650   000003 631400 24                 EPPR1   3
        23 001651   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        23 001652   000000 011000                    NOP     0

      538    17202    4                             -> FILE_LTS.FAB$,           /* LOP */
      539    17203    4                             ADDR(NIL),                  /* ROP */
      540    17204    4                             ETT$) ;                  /* Result */
      541    17205    4         CALL Z8AF$NEW_OFF (ETT$,                        /* LOP */

  17205 23 001653   000006 630400 24                 EPPR0   6
        23 001654   000003 631400 24                 EPPR1   3
        23 001655   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 001656   000000 011000                    NOP     0

      542    17206    4                            %USE_PROC_OFFSET,         /* ROPCON */
      543    17207    4                            ETT$) ;                   /* Result */
      544    17208    4         ETT$ -> ETT.OFFSET.TYPE = %WORD_;

  17208 23 001657   000006 220003                    LDX0    6,DU
        23 001660   000000 470400 9                  LDP0    ETT$
        23 001661   000002 440100                    SXL0    2,,PR0

      545    17209    4         TEMP$ -> USE_SUPP.TO$ = ETT$;

  17209 23 001662   000000 236000 9                  LDQ     ETT$
        23 001663   200017 471500                    LDP1    TEMP$,,AUTO
        23 001664   100003 756100                    STQ     3,,PR1

      546    17210    4         CALL CREATE_AND_PRESET_A_PTR (ENTADDR(NIL), PTR_ETT$);

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:104  
  17210 23 001665   200015 631500                    EPPR1   PTR_ETT$,,AUTO
        23 001666   200056 451500                    STP1    @ETT$$,,AUTO
        23 001667   000042 236000 24                 LDQ     34
        23 001670   200055 756100                    STQ     @ST$$,,AUTO
        23 001671   000702 701000 23                 TSX1    CREATE_AND_PRESET_A_PTR
        23 001672   000000 011000                    NOP     0

      547    17211    4       END;

  17211 23 001673   001702 710000 23                 TRA     s:17301

      548    17212    4       ELSE DO; /* GLOBAL USE found. Reenable it. */

      549    17213    4         USE_CHAIN$ = COMCOM.USE_PROC_CHAIN$;

  17213 23 001674   000476 236000 xsym               LDQ     COMCOM+318
        23 001675   200032 756100                    STQ     USE_CHAIN$,,AUTO

      550    17214    4         PTR_ETT$ = TEMP$ -> USE_SUPP.INIT_LABEL_BASE$;

  17214 23 001676   000005 236100                    LDQ     5,,PR0
        23 001677   200015 756100                    STQ     PTR_ETT$,,AUTO

      551    17215    4         CONTAINING_USE_TYPE = %USE_TYPE_FILE;

  17215 23 001700   000005 235007                    LDA     5,DL
        23 001701   200030 755100                    STA     CONTAINING_USE_TYPE,,AUTO

      552    17216    4       END;

      553    17217            %NEW_USE_LTS (@POINTER = USE_LTS$,
      554    17218                          @TYPE = CONTAINING_USE_TYPE,
      555    17219                          @PROC_CHAIN$ = USE_CHAIN$,
      556    17220                          @LINK$ =
             17220                            O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             17220                              ,
      557    17221                          @TO$ = TEMP$ -> USE_SUPP.TO$,
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:105  
      558    17222                          @INIT_LABEL_BASE$ = PTR_ETT$,
      559    17223                          @PROC_LABEL$ = TEMP$ -> USE_SUPP.PROC_LABEL$);

  17301 23 001702   000002 236000 8                  LDQ     LTS_+2
        23 001703   000022 036007                    ADLQ    18,DL
        23 001704   000003 116000 8                  CMPQ    LTS_+3
        23 001705   001716 604000 23                 TMI     s:17303

  17302 23 001706   000002 236000 24                 LDQ     2
        23 001707   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 001710   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 001711   200061 450500                    STP0    @ETT$$+3,,AUTO
        23 001712   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 001713   000001 631400 24                 EPPR1   1
        23 001714   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 001715   000000 011000                    NOP     0

  17303 23 001716   000002 236000 8                  LDQ     LTS_+2
        23 001717   000022 736000                    QLS     18
        23 001720   000001 036000 8                  ADLQ    LTS_+1
        23 001721   200021 756100                    STQ     USE_LTS$,,AUTO

  17304 23 001722   000022 236007                    LDQ     18,DL
        23 001723   000002 056000 8                  ASQ     LTS_+2

  17305 23 001724   001100 220003                    LDX0    576,DU
        23 001725   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001726   000000 740100                    STX0    0,,PR0

  17311 23 001727   200032 236100                    LDQ     USE_CHAIN$,,AUTO
        23 001730   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001731   000001 756100                    STQ     1,,PR0

  17315 23 001732   200017 470500                    LDP0    TEMP$,,AUTO
        23 001733   000002 236100                    LDQ     2,,PR0
        23 001734   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 001735   100002 756100                    STQ     2,,PR1
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:106  

  17317 23 001736   000057 470400 xsym               LDP0    O1COM+47
        23 001737   000001 471500                    LDP1    1,,PR0
        23 001740   100022 236100                    LDQ     18,,PR1
        23 001741   200021 473500                    LDP3    USE_LTS$,,AUTO
        23 001742   300003 756100                    STQ     3,,PR3

  17318 23 001743   200017 470500                    LDP0    TEMP$,,AUTO
        23 001744   000003 236100                    LDQ     3,,PR0
        23 001745   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 001746   100004 756100                    STQ     4,,PR1

  17319 23 001747   200030 721100                    LXL1    CONTAINING_USE_TYPE,,AUTO
        23 001750   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001751   000000 441100                    SXL1    0,,PR0

  17320 23 001752   000000 236000 24                 LDQ     0
        23 001753   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001754   000007 756100                    STQ     7,,PR0

  17321 23 001755   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001756   000010 756100                    STQ     8,,PR0

  17322 23 001757   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001760   000015 756100                    STQ     13,,PR0

  17323 23 001761   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001762   000017 756100                    STQ     15,,PR0

  17324 23 001763   200015 236100                    LDQ     PTR_ETT$,,AUTO
        23 001764   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001765   000016 756100                    STQ     14,,PR0

  17325 23 001766   000000 222003                    LDX2    0,DU
        23 001767   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001770   000020 742100                    STX2    16,,PR0

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:107  
  17326 23 001771   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 001772   000020 442100                    SXL2    16,,PR0

      560    17329    3       O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ = USE_LTS$;

  17329 23 001773   000057 470400 xsym               LDP0    O1COM+47
        23 001774   000001 471500                    LDP1    1,,PR0
        23 001775   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 001776   100022 756100                    STQ     18,,PR1

      561    17330    3       IF USE_CHAIN$ ~= ADDR(NIL) THEN

  17330 23 001777   200032 236100                    LDQ     USE_CHAIN$,,AUTO
        23 002000   000000 116000 24                 CMPQ    0
        23 002001   002004 600000 23                 TZE     s:17332

      562    17331    3         COMCOM.USE_PROC_CHAIN$ = USE_LTS$;

  17331 23 002002   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 002003   000476 756000 xsym               STQ     COMCOM+318

      563    17332    3       TEMP$ -> USE_SUPP.USE$ = USE_LTS$;

  17332 23 002004   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 002005   200017 470500                    LDP0    TEMP$,,AUTO
        23 002006   000004 756100                    STQ     4,,PR0

      564    17333    3       TEMP$ = TEMP$ -> USE_SUPP.LINK$;

  17333 23 002007   200017 470500                    LDP0    TEMP$,,AUTO
        23 002010   000006 236100                    LDQ     6,,PR0
        23 002011   200017 756100                    STQ     TEMP$,,AUTO

      565    17334    3     END; /* WHILE */

  17334 23 002012   000000 116000 24                 CMPQ    0
        23 002013   001627 601000 23                 TNZ     s:17198
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:108  

      566    17335    2     USE_SUPPS_MADE = TRUE;

  17335 23 002014   400000 236003                    LDQ     -131072,DU
        23 002015   000005 756000 21                 STQ     USE_SUPPS_MADE

      567    17336    2   END MAKE_USE_SUPPS;

  17336 23 002016   200044 221300                    LDX1  ! SAVED_ILS_LIST+8,,AUTO
        23 002017   000001 702211                    TSX2  ! 1,X1

      568    17337        %EJECT;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:109  
      569    17338        /*=============*/
      570    17339    1     Z8EO$USE_SUPP: ENTRY;

  17339 23 002020   000000 700200 xent  Z8EO$USE_SU* TSX0  ! X66_AUTO_5
        23 002021   000066 000005                    ZERO    54,5

      571    17340        /*=============*/
      572    17341    1     CALL MAKE_USE_SUPPS (GLOB_INPUT_USE$, GLOB_OUTPUT_USE$, GLOB_IO_USE$,
             17341              GLOB_EXTEND_USE$);

  17341 23 002022   000044 236000 24                 LDQ     36
        23 002023   200050 756100                    STQ     @IO_PTR$+1,,AUTO
        23 002024   000046 237000 24                 LDAQ    38
        23 002025   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002026   000050 236000 24                 LDQ     40
        23 002027   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002030   001214 701000 23                 TSX1    MAKE_USE_SUPPS
        23 002031   000000 011000                    NOP     0

      573    17342    1     CALL IO_MODE_USE (GLOB_INPUT_USE$, %USE_TYPE_INPUT, FALSE);

  17342 23 002032   000052 237000 24                 LDAQ    42
        23 002033   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002034   000050 236000 24                 LDQ     40
        23 002035   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002036   000755 701000 23                 TSX1    IO_MODE_USE
        23 002037   000000 011000                    NOP     0

      574    17343    1     CALL IO_MODE_USE (GLOB_IO_USE$, %USE_TYPE_IO, FALSE);

  17343 23 002040   000054 237000 24                 LDAQ    44
        23 002041   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002042   000047 236000 24                 LDQ     39
        23 002043   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002044   000755 701000 23                 TSX1    IO_MODE_USE
        23 002045   000000 011000                    NOP     0

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:110  
      575    17344    1     CALL IO_MODE_USE (GLOB_OUTPUT_USE$, %USE_TYPE_OUTPUT, FALSE);

  17344 23 002046   000060 237000 24                 LDAQ    48
        23 002047   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002050   000046 236000 24                 LDQ     38
        23 002051   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002052   000755 701000 23                 TSX1    IO_MODE_USE
        23 002053   000000 011000                    NOP     0

      576    17345    1     CALL IO_MODE_USE (GLOB_EXTEND_USE$, %USE_TYPE_EXTEND, FALSE);

  17345 23 002054   000062 237000 24                 LDAQ    50
        23 002055   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002056   000044 236000 24                 LDQ     36
        23 002057   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002060   000755 701000 23                 TSX1    IO_MODE_USE
        23 002061   000000 011000                    NOP     0

      577    17346    1     RETURN;

  17346 23 002062   000000 702200 xent               TSX2  ! X66_ARET

      578    17347
      579    17348        /*=======================*/
      580    17349    1     Z8EO$END_DECLARATIVES:   ENTRY ;

  17349 23 002063   000000 700200 xent  Z8EO$END_DE* TSX0  ! X66_AUTO_5
        23 002064   000066 000005                    ZERO    54,5

      581    17350        /*=======================*/
      582    17351
      583    17352    1     CURRENT_USE_CHAIN$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$

  17352 23 002065   000057 470400 xsym               LDP0    O1COM+47
        23 002066   000001 471500                    LDP1    1,,PR0
        23 002067   100022 236100                    LDQ     18,,PR1
        23 002070   200011 756100                    STQ     CURRENT_USE_CHAIN$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:111  

      584    17353    1                          -> PROC_SUPP.USE_CHAIN$ ;
      585    17354
      586    17355          /* Link thru USE items and append ILS pieces to O1COM.ILS_LIST */
      587    17356
      588    17357    1     CURRENT_USE$ = CURRENT_USE_CHAIN$ ;

  17357 23 002071   200010 756100                    STQ     CURRENT_USE$,,AUTO

      589    17358
      590    17359    2     DO WHILE (CURRENT_USE$ ~= ADDR(NIL)) ;

  17359 23 002072   002115 710000 23                 TRA     s:17383

      591    17360
      592    17361    3       IF ADDR (CURRENT_USE$ -> USE.ILS_LIST) -> ILS_LIST.HEAD$ ~= ADDR(NIL) THEN DO ;

  17361 23 002073   200010 470500                    LDP0    CURRENT_USE$,,AUTO
        23 002074   000007 236100                    LDQ     7,,PR0
        23 002075   000000 116000 24                 CMPQ    0
        23 002076   002113 600000 23                 TZE     s:17381

      593    17362              %APPEND_ILS_LIST (@FROM$ = "ADDR(CURRENT_USE$ -> USE.ILS_LIST)",
      594    17363                                @TO$   = "ADDR(O1COM.ILS_LIST)") ;

  17369 23 002077   002113 600000 23                 TZE     s:17381

  17370 23 002100   000017 236000 xsym               LDQ     O1COM+15
        23 002101   000000 116000 24                 CMPQ    0
        23 002102   002106 601000 23                 TNZ     s:17374

  17371 23 002103   000007 236100                    LDQ     7,,PR0
        23 002104   000017 756000 xsym               STQ     O1COM+15

  17372 23 002105   002111 710000 23                 TRA     s:17376

  17374 23 002106   000007 236100                    LDQ     7,,PR0
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:112  
        23 002107   000020 471400 xsym               LDP1    O1COM+16
        23 002110   100002 756100                    STQ     2,,PR1

  17376 23 002111   000010 236100                    LDQ     8,,PR0
        23 002112   000020 756000 xsym               STQ     O1COM+16

      595    17380    3       END ; /* A USE ILS_LIST exists */

      596    17381    2       CURRENT_USE$ = CURRENT_USE$ -> USE.LINK$ ;

  17381 23 002113   000003 236100                    LDQ     3,,PR0
        23 002114   200010 756100                    STQ     CURRENT_USE$,,AUTO

      597    17382
      598    17383    2     END ; /* Do while linking thru the USE chain */

  17383 23 002115   000000 116000 24                 CMPQ    0
        23 002116   002073 601000 23                 TNZ     s:17361

      599    17384
      600    17385    1     GOTO NO_DECLARATIVES_START ;

  17385 23 002117   002124 710000 23                 TRA     NO_DECLARATIVES_START

      601    17386
      602    17387        /*====================*/
      603    17388    1     Z8EO$NO_DECLARATIVES: ENTRY ;

  17388 23 002120   000000 700200 xent  Z8EO$NO_DEC* TSX0  ! X66_AUTO_5
        23 002121   000066 000005                    ZERO    54,5

      604    17389        /*====================*/
      605    17390
      606    17391    1     CURRENT_USE_CHAIN$ = ADDR(NIL) ;

  17391 23 002122   000000 236000 24                 LDQ     0
        23 002123   200011 756100                    STQ     CURRENT_USE_CHAIN$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:113  

      607    17392
      608    17393    1   NO_DECLARATIVES_START:
      609    17394    2     IF O1COM.CURRENT_PROC$ -> PROC_.B.COMMON THEN DO;

  17394 23 002124   000057 470400 xsym  NO_DECLARAT* LDP0    O1COM+47
        23 002125   000003 234100                    SZN     3,,PR0
        23 002126   002235 605000 23                 TPL     s:17429

      610    17395          /* For a COMMON program there is in general no way to discern who the caller
      611    17396             will be. Therefore each GLOBAL file and each I/O mode for which the current
      612    17397             program does not have any USE procedure, needs to have the USE procedure
      613    17398             pointer set to point to the GLOBAL USE procedure if one exists or nil
      614    17399             otherwise. */
      615    17400    3       IF NOT USE_SUPPS_MADE THEN DO;

  17400 23 002127   000005 234000 21                 SZN     USE_SUPPS_MADE
        23 002130   002172 604000 23                 TMI     s:17408

      616    17401    3         CALL MAKE_USE_SUPPS (GLOB_INPUT_USE$, GLOB_OUTPUT_USE$, GLOB_IO_USE$,
             17401                  GLOB_EXTEND_USE$);

  17401 23 002131   000044 236000 24                 LDQ     36
        23 002132   200050 756100                    STQ     @IO_PTR$+1,,AUTO
        23 002133   000046 237000 24                 LDAQ    38
        23 002134   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002135   000050 236000 24                 LDQ     40
        23 002136   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002137   001214 701000 23                 TSX1    MAKE_USE_SUPPS
        23 002140   000000 011000                    NOP     0

      617    17402    3         CALL IO_MODE_USE (GLOB_INPUT_USE$, %USE_TYPE_INPUT, TRUE);

  17402 23 002141   000066 237000 24                 LDAQ    54
        23 002142   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002143   000050 236000 24                 LDQ     40
        23 002144   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:114  
        23 002145   000755 701000 23                 TSX1    IO_MODE_USE
        23 002146   000000 011000                    NOP     0

      618    17403    3         CALL IO_MODE_USE (GLOB_IO_USE$, %USE_TYPE_IO, TRUE);

  17403 23 002147   000070 237000 24                 LDAQ    56
        23 002150   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002151   000047 236000 24                 LDQ     39
        23 002152   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002153   000755 701000 23                 TSX1    IO_MODE_USE
        23 002154   000000 011000                    NOP     0

      619    17404    3         CALL IO_MODE_USE (GLOB_OUTPUT_USE$, %USE_TYPE_OUTPUT, TRUE);

  17404 23 002155   000072 237000 24                 LDAQ    58
        23 002156   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002157   000046 236000 24                 LDQ     38
        23 002160   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002161   000755 701000 23                 TSX1    IO_MODE_USE
        23 002162   000000 011000                    NOP     0

      620    17405    3         CALL IO_MODE_USE (GLOB_EXTEND_USE$, %USE_TYPE_EXTEND, TRUE);

  17405 23 002163   000074 237000 24                 LDAQ    60
        23 002164   200046 757100                    STAQ    @IN_PTR$+1,,AUTO
        23 002165   000044 236000 24                 LDQ     36
        23 002166   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002167   000755 701000 23                 TSX1    IO_MODE_USE
        23 002170   000000 011000                    NOP     0

      621    17406    3       END;

  17406 23 002171   002212 710000 23                 TRA     s:17413

      622    17407    3       ELSE DO;

      623    17408    3         CALL MOVE_MODE_LABEL (GLOB_INPUT_USE$);
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:115  

  17408 23 002172   000050 236000 24                 LDQ     40
        23 002173   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002174   000656 701000 23                 TSX1    MOVE_MODE_LABEL
        23 002175   000000 011000                    NOP     0

      624    17409    3         CALL MOVE_MODE_LABEL (GLOB_OUTPUT_USE$);

  17409 23 002176   000046 236000 24                 LDQ     38
        23 002177   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002200   000656 701000 23                 TSX1    MOVE_MODE_LABEL
        23 002201   000000 011000                    NOP     0

      625    17410    3         CALL MOVE_MODE_LABEL (GLOB_IO_USE$);

  17410 23 002202   000047 236000 24                 LDQ     39
        23 002203   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002204   000656 701000 23                 TSX1    MOVE_MODE_LABEL
        23 002205   000000 011000                    NOP     0

      626    17411    3         CALL MOVE_MODE_LABEL (GLOB_EXTEND_USE$);

  17411 23 002206   000044 236000 24                 LDQ     36
        23 002207   200045 756100                    STQ     SAVED_ILS_LIST+9,,AUTO
        23 002210   000656 701000 23                 TSX1    MOVE_MODE_LABEL
        23 002211   000000 011000                    NOP     0

      627    17412    3       END;

      628    17413    3       DO WHILE GLOBAL_USE_SUPP_CHAIN$ ~= ADDR(NIL);

  17413 23 002212   002231 710000 23                 TRA     s:17418

      629    17414    3         CALL MOVE_LABEL (GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.TO$,

  17414 23 002213   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 002214   000004 036003                    ADLQ    4,DU
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:116  
        23 002215   200053 756100                    STQ     @USE_SECT$+1,,AUTO
        23 002216   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 002217   000002 036003                    ADLQ    2,DU
        23 002220   200052 756100                    STQ     @TO$+1,,AUTO
        23 002221   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 002222   000003 036003                    ADLQ    3,DU
        23 002223   200051 756100                    STQ     @EXT_PTR$+1,,AUTO
        23 002224   000467 701000 23                 TSX1    MOVE_LABEL
        23 002225   000000 011000                    NOP     0

      630    17415    3                          GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.PROC_LABEL$,
      631    17416    3                          GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.USE$);
      632    17417    3         GLOBAL_USE_SUPP_CHAIN$ = GLOBAL_USE_SUPP_CHAIN$ -> USE_SUPP.LINK$;

  17417 23 002226   000004 470400 21                 LDP0    GLOBAL_USE_SUPP_CHAIN$
        23 002227   000006 236100                    LDQ     6,,PR0
        23 002230   000004 756000 21                 STQ     GLOBAL_USE_SUPP_CHAIN$

      633    17418    3       END; /* WHILE */

  17418 23 002231   000004 236000 21                 LDQ     GLOBAL_USE_SUPP_CHAIN$
        23 002232   000000 116000 24                 CMPQ    0
        23 002233   002213 601000 23                 TNZ     s:17414

      634    17419    2     END; /* Common program */

  17419 23 002234   002563 710000 23                 TRA     s:17624

      635    17420    2     ELSE DO; /* Not COMMON program */

      636    17421          /* If the current program is an internal program nested within another
      637    17422             program, and the containing program has any local USE procedures for
      638    17423             a file or an I/O mode, such that the current program does not have one to
      639    17424             match, then the containing program's USE procedure needs to be disabled
      640    17425             temporarily. Replace it with a nil USE procedure, unless somewhere
      641    17426             farther out there is a corresponding USE procedure that is GLOBAL; in
      642    17427             this case, reactivate it. */
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:117  
      643    17428
      644    17429    2       CONTAINING_PROC$ = O1COM.CURRENT_PROC$ -> PROC_.FATHER;

  17429 23 002235   000011 236100                    LDQ     9,,PR0
        23 002236   200026 756100                    STQ     CONTAINING_PROC$,,AUTO

      645    17430    3       IF CONTAINING_PROC$ ~= ADDR(NIL) THEN DO;

  17430 23 002237   000000 116000 24                 CMPQ    0
        23 002240   002563 600000 23                 TZE     s:17624

      646    17431              /* Containing program's USE procedures not valid here */
      647    17432    3        CONTAINING_USE$ = CONTAINING_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             17432                  ;

  17432 23 002241   200026 471500                    LDP1    CONTAINING_PROC$,,AUTO
        23 002242   100001 473500                    LDP3    1,,PR1
        23 002243   300022 236100                    LDQ     18,,PR3
        23 002244   200031 756100                    STQ     CONTAINING_USE$,,AUTO

      648    17433    4         DO WHILE CONTAINING_USE$ ~= ADDR(NIL);

  17433 23 002245   002561 710000 23                 TRA     s:17621

      649    17434    4           SECTION$ = CONTAINING_USE$ -> USE.PROC_LABEL$;

  17434 23 002246   200031 470500                    LDP0    CONTAINING_USE$,,AUTO
        23 002247   000002 236100                    LDQ     2,,PR0
        23 002250   200016 756100                    STQ     SECTION$,,AUTO

      650    17435    4           IF SECTION$ ~= NIL_EPTR$ AND NOT SECTION$ -> SECTION.B.USE_GLOBAL THEN

  17435 23 002251   000000 116000 22                 CMPQ    NIL_EPTR
        23 002252   002556 600000 23                 TZE     s:17620
        23 002253   200016 471500                    LDP1    SECTION$,,AUTO
        23 002254   100003 236100                    LDQ     3,,PR1
        23 002255   004000 316007                    CANQ    2048,DL
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:118  
        23 002256   002556 601000 23                 TNZ     s:17620

      651    17436    4   CHECK_GLOBAL_USE:
      652    17437    5             DO;

  17437 23 002257                       CHECK_GLOBA* null
      653    17438    5               CONTAINING_USE_TYPE = CONTAINING_USE$ -> USE.TYPE;

  17438 23 002257   000000 236100                    LDQ     0,,PR0
        23 002260   777777 376007                    ANQ     -1,DL
        23 002261   200030 756100                    STQ     CONTAINING_USE_TYPE,,AUTO

      654    17439    5               IF CONTAINING_USE_TYPE = %USE_TYPE_FILE THEN

  17439 23 002262   000005 116007                    CMPQ    5,DL
        23 002263   002301 601000 23                 TNZ     s:17448

      655    17440                      %FISH (TRIAD = CONTAINING_USE$ -> USE.TO$, RTN = CONTAINING_FAB$);

  17442 23 002264   000004 236100                    LDQ     4,,PR0
        23 002265   200027 756100                    STQ     CONTAINING_FAB$,,AUTO

  17443 23 002266   200027 473500                    LDP3    CONTAINING_FAB$,,AUTO
        23 002267   300000 220100                    LDX0    0,,PR3
        23 002270   000751 100003                    CMPX0   489,DU
        23 002271   002301 603000 23                 TRC     s:17448

  17444 23 002272   200027 470500                    LDP0    CONTAINING_FAB$,,AUTO
        23 002273   000001 236100                    LDQ     1,,PR0
        23 002274   200027 756100                    STQ     CONTAINING_FAB$,,AUTO

  17445 23 002275   200027 470500                    LDP0    CONTAINING_FAB$,,AUTO
        23 002276   000000 220100                    LDX0    0,,PR0
        23 002277   000751 100003                    CMPX0   489,DU
        23 002300   002272 602000 23                 TNC     s:17444

      656    17448    5               CURRENT_USE$ = CURRENT_USE_CHAIN$;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:119  

  17448 23 002301   200011 236100                    LDQ     CURRENT_USE_CHAIN$,,AUTO
        23 002302   200010 756100                    STQ     CURRENT_USE$,,AUTO

      657    17449    6               DO WHILE CURRENT_USE$ ~= ADDR(NIL);

  17449 23 002303   002336 710000 23                 TRA     s:17466

      658    17450    7                 IF CURRENT_USE$ -> USE.TYPE = CONTAINING_USE_TYPE THEN DO;

  17450 23 002304   200010 470500                    LDP0    CURRENT_USE$,,AUTO
        23 002305   000000 236100                    LDQ     0,,PR0
        23 002306   777777 376007                    ANQ     -1,DL
        23 002307   200030 116100                    CMPQ    CONTAINING_USE_TYPE,,AUTO
        23 002310   002333 601000 23                 TNZ     s:17465

      659    17451    7                   IF CONTAINING_USE_TYPE ~= %USE_TYPE_FILE THEN

  17451 23 002311   200030 235100                    LDA     CONTAINING_USE_TYPE,,AUTO
        23 002312   000005 115007                    CMPA    5,DL
        23 002313   002556 601000 23                 TNZ     s:17620

      660    17452    7                     EXIT CHECK_GLOBAL_USE;
      661    17453                          /* Local USE proc exists */
      662    17454                        %FISH (TRIAD = CURRENT_USE$ -> USE.TO$, RTN = CURRENT_FAB$);

  17456 23 002314   000004 236100                    LDQ     4,,PR0
        23 002315   200023 756100                    STQ     CURRENT_FAB$,,AUTO

  17457 23 002316   200023 471500                    LDP1    CURRENT_FAB$,,AUTO
        23 002317   100000 220100                    LDX0    0,,PR1
        23 002320   000751 100003                    CMPX0   489,DU
        23 002321   002331 603000 23                 TRC     s:17462

  17458 23 002322   200023 470500                    LDP0    CURRENT_FAB$,,AUTO
        23 002323   000001 236100                    LDQ     1,,PR0
        23 002324   200023 756100                    STQ     CURRENT_FAB$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:120  

  17459 23 002325   200023 470500                    LDP0    CURRENT_FAB$,,AUTO
        23 002326   000000 220100                    LDX0    0,,PR0
        23 002327   000751 100003                    CMPX0   489,DU
        23 002330   002322 602000 23                 TNC     s:17458

      663    17462    7                   IF CURRENT_FAB$ = CONTAINING_FAB$ THEN EXIT CHECK_GLOBAL_USE;

  17462 23 002331   200027 116100                    CMPQ    CONTAINING_FAB$,,AUTO
        23 002332   002556 600000 23                 TZE     s:17620

      664    17463                          /* Local USE proc exists */
      665    17464    7                 END;

      666    17465    6                 CURRENT_USE$ = CURRENT_USE$ -> USE.LINK$;

  17465 23 002333   200010 470500                    LDP0    CURRENT_USE$,,AUTO
        23 002334   000003 236100                    LDQ     3,,PR0
        23 002335   200010 756100                    STQ     CURRENT_USE$,,AUTO

      667    17466    6               END; /* WHILE */

  17466 23 002336   000000 116000 24                 CMPQ    0
        23 002337   002304 601000 23                 TNZ     s:17450

      668    17467    5               PROC$ = CONTAINING_PROC$ -> PROC_.FATHER;

  17467 23 002340   200026 470500                    LDP0    CONTAINING_PROC$,,AUTO
        23 002341   000011 236100                    LDQ     9,,PR0
        23 002342   200014 756100                    STQ     PROC$,,AUTO

      669    17468    5               USE_CHAIN$ = COMCOM.USE_PROC_CHAIN$;

  17468 23 002343   000476 236000 xsym               LDQ     COMCOM+318
        23 002344   200032 756100                    STQ     USE_CHAIN$,,AUTO

      670    17469    6   CHECK_ONE_USE: DO;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:121  

  17469 23 002345                       CHECK_ONE_U* null
      671    17470    7                 DO WHILE PROC$ ~= ADDR(NIL);

  17470 23 002345   002426 710000 23                 TRA     s:17497

      672    17471    7                   USE$ = PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;

  17471 23 002346   200014 470500                    LDP0    PROC$,,AUTO
        23 002347   000001 471500                    LDP1    1,,PR0
        23 002350   100022 236100                    LDQ     18,,PR1
        23 002351   200020 756100                    STQ     USE$,,AUTO

      673    17472    8                   DO WHILE USE$ ~= ADDR(NIL);

  17472 23 002352   002421 710000 23                 TRA     s:17495

      674    17473    8                     SECTION$ = USE$ -> USE.PROC_LABEL$;

  17473 23 002353   200020 470500                    LDP0    USE$,,AUTO
        23 002354   000002 236100                    LDQ     2,,PR0
        23 002355   200016 756100                    STQ     SECTION$,,AUTO

      675    17474    8                    IF SECTION$ ~= NIL_EPTR$ AND SECTION$ -> SECTION.B.USE_GLOBAL THEN

  17474 23 002356   000000 116000 22                 CMPQ    NIL_EPTR
        23 002357   002416 600000 23                 TZE     s:17494
        23 002360   200016 471500                    LDP1    SECTION$,,AUTO
        23 002361   100003 236100                    LDQ     3,,PR1
        23 002362   004000 316007                    CANQ    2048,DL
        23 002363   002416 600000 23                 TZE     s:17494

      676    17475    9   NEXT_USE:           DO; /* This USE procedure by nature cannot be nil. */

  17475 23 002364                       NEXT_USE     null
      677    17476   10                         IF USE$ -> USE.TYPE = CONTAINING_USE_TYPE THEN DO;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:122  
  17476 23 002364   000000 236100                    LDQ     0,,PR0
        23 002365   777777 376007                    ANQ     -1,DL
        23 002366   200030 116100                    CMPQ    CONTAINING_USE_TYPE,,AUTO
        23 002367   002416 601000 23                 TNZ     s:17494

      678    17477   11                           IF CONTAINING_USE_TYPE = %USE_TYPE_FILE THEN DO;

  17477 23 002370   200030 235100                    LDA     CONTAINING_USE_TYPE,,AUTO
        23 002371   000005 115007                    CMPA    5,DL
        23 002372   002412 601000 23                 TNZ     s:17489

      679    17478                                  %FISH (TRIAD = USE$ -> USE.TO$, RTN = FAB$);

  17480 23 002373   000004 236100                    LDQ     4,,PR0
        23 002374   200025 756100                    STQ     FAB$,,AUTO

  17481 23 002375   200025 473500                    LDP3    FAB$,,AUTO
        23 002376   300000 220100                    LDX0    0,,PR3
        23 002377   000751 100003                    CMPX0   489,DU
        23 002400   002410 603000 23                 TRC     s:17486

  17482 23 002401   200025 470500                    LDP0    FAB$,,AUTO
        23 002402   000001 236100                    LDQ     1,,PR0
        23 002403   200025 756100                    STQ     FAB$,,AUTO

  17483 23 002404   200025 470500                    LDP0    FAB$,,AUTO
        23 002405   000000 220100                    LDX0    0,,PR0
        23 002406   000751 100003                    CMPX0   489,DU
        23 002407   002401 602000 23                 TNC     s:17482

      680    17486   11                             IF FAB$ ~= CONTAINING_FAB$ THEN EXIT NEXT_USE;

  17486 23 002410   200027 116100                    CMPQ    CONTAINING_FAB$,,AUTO
        23 002411   002416 601000 23                 TNZ     s:17494

      681    17487                                                             /* Wrong file */
      682    17488   11                           END;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:123  

      683    17489   10                           PTR_ETT$ = USE$ -> USE.INIT_LABEL_BASE$;

  17489 23 002412   200020 470500                    LDP0    USE$,,AUTO
        23 002413   000016 236100                    LDQ     14,,PR0
        23 002414   200015 756100                    STQ     PTR_ETT$,,AUTO

      684    17490   10                           EXIT CHECK_ONE_USE;

  17490 23 002415   002445 710000 23                 TRA     s:17587

      685    17491                                /* GLOBAL USE procedure found. Reactivate it. */
      686    17492   10                         END; /* IF TYPE = CONTAINING_USE_TYPE */
      687    17493    9                       END; /* NEXT_USE */
      688    17494    8                     USE$ = USE$ -> USE.LINK$;

  17494 23 002416   200020 470500                    LDP0    USE$,,AUTO
        23 002417   000003 236100                    LDQ     3,,PR0
        23 002420   200020 756100                    STQ     USE$,,AUTO

      689    17495    8                   END; /* WHILE USE$ ~= ADDR(NIL) */

  17495 23 002421   000000 116000 24                 CMPQ    0
        23 002422   002353 601000 23                 TNZ     s:17473

      690    17496    7                   PROC$ = PROC$ -> PROC_.FATHER;

  17496 23 002423   200014 470500                    LDP0    PROC$,,AUTO
        23 002424   000011 236100                    LDQ     9,,PR0
        23 002425   200014 756100                    STQ     PROC$,,AUTO

      691    17497    7                 END; /* WHILE PROC$ ~= ADDR(NIL) */

  17497 23 002426   200014 236100                    LDQ     PROC$,,AUTO
        23 002427   000000 116000 24                 CMPQ    0
        23 002430   002346 601000 23                 TNZ     s:17471

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:124  
      692    17498    6                 CONTAINING_USE_TYPE = %USE_TYPE_NIL;

  17498 23 002431   000010 235007                    LDA     8,DL
        23 002432   200030 755100                    STA     CONTAINING_USE_TYPE,,AUTO

      693    17499    6                 SECTION$ = NIL_EPTR$; /* No GLOBAL USE */

  17499 23 002433   000000 236000 22                 LDQ     NIL_EPTR
        23 002434   200016 756100                    STQ     SECTION$,,AUTO

      694    17500    6                 USE_CHAIN$ = ADDR(NIL); /* Deactivate USE procedure. */

  17500 23 002435   000000 236000 24                 LDQ     0
        23 002436   200032 756100                    STQ     USE_CHAIN$,,AUTO

      695    17501    6                 CALL CREATE_AND_PRESET_A_PTR (ENTADDR(NIL), PTR_ETT$);

  17501 23 002437   200015 630500                    EPPR0   PTR_ETT$,,AUTO
        23 002440   200056 450500                    STP0    @ST$$+1,,AUTO
        23 002441   000042 236000 24                 LDQ     34
        23 002442   200055 756100                    STQ     @USE_LTS$+2,,AUTO
        23 002443   000702 701000 23                 TSX1    CREATE_AND_PRESET_A_PTR
        23 002444   000000 011000                    NOP     0

      696    17502    6               END; /* CHECK_ONE_USE */

      697    17503                    %NEW_USE_LTS (@POINTER = USE_LTS$,
      698    17504                                  @TYPE = CONTAINING_USE_TYPE,
      699    17505                                  @PROC_CHAIN$ = USE_CHAIN$,
      700    17506                                  @TO$ = CONTAINING_USE$ -> USE.TO$,
      701    17507                                  @INIT_LABEL_BASE$ = PTR_ETT$,
      702    17508                                  @LINK$ =
             17508                            O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$
             17508                                      ,
      703    17509                                  @PROC_LABEL$ = SECTION$);

  17587 23 002445   000002 236000 8                  LDQ     LTS_+2
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:125  
        23 002446   000022 036007                    ADLQ    18,DL
        23 002447   000003 116000 8                  CMPQ    LTS_+3
        23 002450   002461 604000 23                 TMI     s:17589

  17588 23 002451   000002 236000 24                 LDQ     2
        23 002452   200060 756100                    STQ     @ETT$$+2,,AUTO
        23 002453   200060 630500                    EPPR0   @ETT$$+2,,AUTO
        23 002454   200061 450500                    STP0    @ETT$$+3,,AUTO
        23 002455   200061 630500                    EPPR0   @ETT$$+3,,AUTO
        23 002456   000001 631400 24                 EPPR1   1
        23 002457   000000 701000 xent               TSX1    Z8AR$RESERVER
        23 002460   000000 011000                    NOP     0

  17589 23 002461   000002 236000 8                  LDQ     LTS_+2
        23 002462   000022 736000                    QLS     18
        23 002463   000001 036000 8                  ADLQ    LTS_+1
        23 002464   200021 756100                    STQ     USE_LTS$,,AUTO

  17590 23 002465   000022 236007                    LDQ     18,DL
        23 002466   000002 056000 8                  ASQ     LTS_+2

  17591 23 002467   001100 220003                    LDX0    576,DU
        23 002470   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 002471   000000 740100                    STX0    0,,PR0

  17597 23 002472   200032 236100                    LDQ     USE_CHAIN$,,AUTO
        23 002473   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 002474   000001 756100                    STQ     1,,PR0

  17601 23 002475   200016 236100                    LDQ     SECTION$,,AUTO
        23 002476   200021 470500                    LDP0    USE_LTS$,,AUTO
        23 002477   000002 756100                    STQ     2,,PR0

  17603 23 002500   000057 470400 xsym               LDP0    O1COM+47
        23 002501   000001 471500                    LDP1    1,,PR0
        23 002502   100022 236100                    LDQ     18,,PR1
        23 002503   200021 473500                    LDP3    USE_LTS$,,AUTO
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:126  
        23 002504   300003 756100                    STQ     3,,PR3

  17604 23 002505   200031 470500                    LDP0    CONTAINING_USE$,,AUTO
        23 002506   000004 236100                    LDQ     4,,PR0
        23 002507   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002510   100004 756100                    STQ     4,,PR1

  17605 23 002511   200030 721100                    LXL1    CONTAINING_USE_TYPE,,AUTO
        23 002512   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002513   100000 441100                    SXL1    0,,PR1

  17606 23 002514   000000 236000 24                 LDQ     0
        23 002515   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002516   100007 756100                    STQ     7,,PR1

  17607 23 002517   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002520   100010 756100                    STQ     8,,PR1

  17608 23 002521   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002522   100015 756100                    STQ     13,,PR1

  17609 23 002523   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002524   100017 756100                    STQ     15,,PR1

  17610 23 002525   200015 236100                    LDQ     PTR_ETT$,,AUTO
        23 002526   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002527   100016 756100                    STQ     14,,PR1

  17611 23 002530   000000 222003                    LDX2    0,DU
        23 002531   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002532   100020 742100                    STX2    16,,PR1

  17612 23 002533   200021 471500                    LDP1    USE_LTS$,,AUTO
        23 002534   100020 442100                    SXL2    16,,PR1

      704    17615    5               O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$ =
             17615                        USE_LTS$;
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:127  

  17615 23 002535   000057 471400 xsym               LDP1    O1COM+47
        23 002536   100001 473500                    LDP3    1,,PR1
        23 002537   200021 236100                    LDQ     USE_LTS$,,AUTO
        23 002540   300022 756100                    STQ     18,,PR3

      705    17616    5               IF CONTAINING_USE_TYPE ~= %USE_TYPE_NIL THEN

  17616 23 002541   200030 235100                    LDA     CONTAINING_USE_TYPE,,AUTO
        23 002542   000010 115007                    CMPA    8,DL
        23 002543   002545 600000 23                 TZE     s:17618

      706    17617    5                 COMCOM.USE_PROC_CHAIN$ = USE_LTS$;

  17617 23 002544   000476 756000 xsym               STQ     COMCOM+318

      707    17618    5               CALL MOVE_LABEL (CONTAINING_USE$ -> USE.TO$, SECTION$, USE_LTS$);

  17618 23 002545   200021 631500                    EPPR1   USE_LTS$,,AUTO
        23 002546   200053 451500                    STP1    @USE_SECT$+1,,AUTO
        23 002547   200016 633500                    EPPR3   SECTION$,,AUTO
        23 002550   200052 453500                    STP3    @TO$+1,,AUTO
        23 002551   200031 236100                    LDQ     CONTAINING_USE$,,AUTO
        23 002552   000004 036003                    ADLQ    4,DU
        23 002553   200051 756100                    STQ     @EXT_PTR$+1,,AUTO
        23 002554   000467 701000 23                 TSX1    MOVE_LABEL
        23 002555   000000 011000                    NOP     0

      708    17619    5             END; /* CHECK_GLOBAL_USE */

      709    17620    4             CONTAINING_USE$ = CONTAINING_USE$ -> USE.LINK$;

  17620 23 002556   200031 470500                    LDP0    CONTAINING_USE$,,AUTO
        23 002557   000003 236100                    LDQ     3,,PR0
        23 002560   200031 756100                    STQ     CONTAINING_USE$,,AUTO

      710    17621    4         END; /* WHILE CONTAINING_USE$ ~= ADDR(NIL) */
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:128  

  17621 23 002561   000000 116000 24                 CMPQ    0
        23 002562   002246 601000 23                 TNZ     s:17434

      711    17622    3       END; /* WHILE CONTAINING_PROC$ ~= ADDR(NIL) */

      712    17623    2     END; /* Non-common program */

      713    17624    1     GLOBAL_USE_SUPP_CHAIN$ = ADDR(NIL);

  17624 23 002563   000000 236000 24                 LDQ     0
        23 002564   000004 756000 21                 STQ     GLOBAL_USE_SUPP_CHAIN$

      714    17625    1     USE_SUPPS_MADE = FALSE;

  17625 23 002565   000005 450000 21                 STZ     USE_SUPPS_MADE

      715    17626
      716    17627    1     RETURN ;

  17627 23 002566   000000 702200 xent               TSX2  ! X66_ARET
      717    17628
      718    17629    1   END Z8EO$USE ;
      719    17630        %EOD;

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:129  
--  Include file information  --

   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ILS_LIST.:Z8A6TOU  is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EO$USE.
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:130  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 002 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 003 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 004 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:131  
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 007 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 008 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 009 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 010 LblCom HEAD_ETT$

PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:132  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 011 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 012 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 013 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 014 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 015 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:133  

     0-0-0/w PTR         r     1 DNT$

  ****  Section 016 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 017 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 018 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 019 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 020 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:134  

  ****  Section 021  Data  Z8EO$USE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 GLOBAL_USE_SUPP_CHAIN$
     3-0-0/w PTR         r     1 GLOB_EXTEND_USE$           0-0-0/w PTR         r     1 GLOB_INPUT_USE$
     1-0-0/w PTR         r     1 GLOB_IO_USE$               2-0-0/w PTR         r     1 GLOB_OUTPUT_USE$
     5-0-0/b BIT         r     1 USE_SUPPS_MADE

  ****  Section 022 RoData Z8EO$USE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 NIL_EPTR                   0-0-0/w PTR         r     1 NIL_EPTR$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @COLUMN                   47-0-0/w PTR         r     1 @DO_MOVE
    52-0-0/w PTR         r     1 @ETT$                     56-0-0/w PTR         r     1 @ETT$$
    50-0-0/w PTR         r     1 @EXT_PTR$                 45-0-0/w PTR         r     1 @IN_PTR$
    47-0-0/w PTR         r     1 @IO_PTR$                   6-0-0/w PTR         r     1 @LINE
    46-0-0/w PTR         r     1 @OUT_PTR$                  4-0-0/w PTR         r     1 @PTR$
    55-0-0/w PTR         r     1 @ST$$                     45-0-0/w PTR         r     1 @TO$
    51-0-0/w PTR         r     1 @TO$                       3-0-0/w PTR         r     1 @TYPE
    51-0-0/w PTR         r     1 @TYPE                     45-0-0/w PTR         r     1 @USE$
    45-0-0/w PTR         r     1 @USE$                     53-0-0/w PTR         r     1 @USE_LTS$
     5-0-0/w PTR         r     1 @USE_SECT$                46-0-0/w PTR         r     1 @USE_SECT$
    52-0-0/w PTR         r     1 @USE_SECT$                46-0-0/w PTR         r     1 @USE_TYPE
    *0-0-0/w UBIN        r     1 COLUMN                    27-0-0/w PTR         r     1 CONTAINING_FAB$
    26-0-0/w PTR         r     1 CONTAINING_PROC$          31-0-0/w PTR         r     1 CONTAINING_USE$
    30-0-0/w UBIN        r     1 CONTAINING_USE_TYPE       23-0-0/w PTR         r     1 CURRENT_FAB$
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:135  
    24-0-0/w UBIN              1 CURRENT_TYPE              10-0-0/w PTR         r     1 CURRENT_USE$
    11-0-0/w PTR         r     1 CURRENT_USE_CHAIN$        22-0-0/w PTR         r     1 DNT$$
    *0-0-0/w BIT         r     1 DO_MOVE                   *0-0-0/w PTR         r     1 ETT$
    *0-0-0/w PTR         r     1 ETT$$                     *0-0-0/w PTR         r     1 EXT_PTR$
    25-0-0/w PTR         r     1 FAB$                      12-0-0/w PTR         r     1 FILE_LTS$
    *0-0-0/w PTR         r     1 IN_PTR$                   *0-0-0/w PTR         r     1 IO_PTR$
    *0-0-0/w UBIN        r     1 LINE                      *0-0-0/w PTR         r     1 OUT_PTR$
    33-0-0/w PTR         r     1 PREV_USE_SUPP$            14-0-0/w PTR         r     1 PROC$
    13-0-0/w PTR         r     1 PROC_SUPP$                *0-0-0/w PTR         r     1 PTR$
    15-0-0/w PTR         r     1 PTR_ETT$                  34-0-0/d STRC(288)   r     1 SAVED_ILS_LIST
    16-0-0/w PTR         r     1 SECTION$                  *0-0-0/w PTR         r     1 ST$$
    17-0-0/w PTR         r     1 TEMP$                     *0-0-0/w PTR         r     1 TO$
    *0-0-0/w PTR         r     1 TO$                       *0-0-0/w UBIN        r     1 TYPE
    *0-0-0/w UBIN        r     1 TYPE                      20-0-0/w PTR         r     1 USE$
    *0-0-0/w PTR         r     1 USE$                      *0-0-0/w PTR         r     1 USE$
    32-0-0/w PTR         r     1 USE_CHAIN$                21-0-0/w PTR         r     1 USE_LTS$
    *0-0-0/w PTR         r     1 USE_LTS$                  *0-0-0/w PTR         r     1 USE_SECT$
    *0-0-0/w PTR         r     1 USE_SECT$                 *0-0-0/w PTR         r     1 USE_SECT$
    *0-0-0/w UBIN        r     1 USE_TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:136  

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)   r     1 BINARY_ILL
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)   r     1 FD
     0-0-0/w STRC(1692)  r     1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)   r     1 ILS                        0-0-0/w STRC(288)   r     1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)   r     1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:137  
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(108)         1 LINOI
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC        r     1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)         1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(144)         1 OPN
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)   r     1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)   r     1 PROC_DEF
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)   r     1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/d STRC(612)   r     1 USE                        0-0-0/w STRC(216)         1 USER_CALL
PL6.E3A0      #002=Z8EO$USE File=Z8EO.:Z8A6TSI                                   SAT 08/09/97 12:25 Page:138  
     0-0-0/w STRC(252)   r     1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EO$USE requires 1399 words for executable code.
   Procedure Z8EO$USE requires 54 words of local(AUTO) storage.

PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:139  
      720        1        /*T***********************************************************/
      721        2        /*T*                                                         */
      722        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      723        4        /*T*                                                         */
      724        5        /*T***********************************************************/
      725        6        /*===============*/
      726        7          Z8EO$GLOBAL_USE: PROC (USE_SAVE_LABEL$, USE_RESTORE_LABEL$);
      727        8        /*===============*/
      728        9        /*D*   NAME: Z8EO$GLOBAL_USE
      729       10               CALL: CALL Z8EO$GLOBAL_USE (USE_SAVE_LABEL$, USE_RESTORE_LABEL$);
      730       11              INPUT: USE_SAVE_LABEL$ -- If null, there are no GLOBAL USE procedures in
      731       12                                        the current program and this module will not be
      732       13                                        called. Otherwise, it points to a PARA item
      733       14                                        PERFORMed on entry into any GLOBAL USE proc in
      734       15                                        the current program.
      735       16                     USE_RESTORE_LABEL$ -- Points to a PARA item PERFORMed on exit from
      736       17                                           any GLOBAL USE proc in the current program.
      737       18            PURPOSE: Create the DEFLB items to go with the PARA items. Create the
      738       19                     paragraphs needed so that in the USE proc, all pointers to other
      739       20                     USE procs will have the same value as in the current program
      740       21                     proper.
      741       22        */
      742       23        %SET PHASE = 1;
      743       24        %INCLUDE Z8A_DEFC;
      744       92        %INCLUDE Z8A_SUPP_MAC;
      745     2492        %INCLUDE Z8A_ILL;
      746     3185        %INCLUDE Z8A_LTS;
      747     5262        %INCLUDE Z8A_ST;
      748     8921        %INCLUDE Z8E_STACKS;
      749    11187        %INCLUDE Z8E_O1COM;
      750    11948        %INCLUDE Z8E_MACROS;
      751    12623    1   DCL USE_SAVE_LABEL$ PTR;
      752    12624    1   DCL USE_RESTORE_LABEL$ PTR;
      753    12625    1   DCL USE_LTS$ PTR;
      754    12626    1   DCL TEMP$ PTR;
      755    12627    1   DCL Z8AF$NEW_BASE ENTRY(3);
      756    12628    1   DCL Z8AT$CREATE_TEMPORARY ENTRY(2);
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:140  
      757    12629    1   DCL Z8EO$USE_SUPP ENTRY;
      758    12630        %EJECT;
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:141  
      759    12631          /* First make sure there are USE items on chain for all USE procedures
      760    12632             that should be in effect at this level. */
      761    12633
      762    12634    1     CALL Z8EO$USE_SUPP;
      763    12635
      764    12636          /* For a GLOBAL USE EXCEPTION procedure, it could be executed on behalf
      765    12637             of an I/O statement in a subordinate procedure. That being the case, it
      766    12638             is possible that there may be a different set of USE procedures in effect
      767    12639             while this USE procedure is in execution from what is in effect when the
      768    12640             I/O statement is executed. If, where the current USE procedure is, it is
      769    12641             the only USE procedure in effect, this does not hold true, but in any
      770    12642             other case, code is needed to make sure all USE procedure pointers are
      771    12643             set correctly. This code will be located at the end of DECLARATIVES,
      772    12644             because of which a section label is also needed, so that a PERFORM of
      773    12645             the USE procedure proper will not also PERFORM this code. */
      774    12646    1     USE_LTS$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;
      775    12647    1     CALL Z8AT$CREATE_TEMPORARY (%SECTION, TEMP$);
      776    12648          %NEW_ILL (@ID = %DEFLB, @LABEL$ = TEMP$);
      777    13027          /* The above SECTION label delimits the last USE proc from the USE
      778    13028             pointer save/load paragraph. */
      779    13029          %NEW_ILL (@ID = %DEFLB, @LABEL$ = USE_SAVE_LABEL$);
      780    13408    2     IF USE_LTS$ -> USE.LINK$ ~= ADDR(NIL) THEN DO;
      781    13409    3       DO UNTIL USE_LTS$ = ADDR(NIL);
      782    13410    3         CALL Z8AT$CREATE_TEMPORARY (%SCALAR, TEMP$);
      783    13411    3         CALL Z8AF$NEW_BASE (TEMP$, ADDR(NIL), TEMP$);
      784    13412              %NEW_ILL (@ID = %MVII,
      785    13413                        @LOP = TEMP$,
      786    13414                        @ROP = USE_LTS$ -> USE.TO$);
      787    13793    3         USE_LTS$ -> USE.TO1$ = TEMP$;
      788    13794              %NEW_ILL (@ID = %MVII,
      789    13795                        @LOP = USE_LTS$ -> USE.TO$,
      790    13796                        @ROP = USE_LTS$ -> USE.INIT_LABEL_BASE$);
      791    14175    3         USE_LTS$ = USE_LTS$ -> USE.LINK$;
      792    14176    3       END; /* UNTIL */
      793    14177    2       CALL Z8AT$CREATE_TEMPORARY (%SECTION, TEMP$);
      794    14178            %NEW_ILL (@ID = %DEFLB, @LABEL$ = TEMP$);
      795    14557            /* SECTION label to separate save/load paragraph from restore paragraph. */
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:142  
      796    14558    2     END;
      797    14559    1     USE_LTS$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;
      798    14560          %NEW_ILL (@ID = %DEFLB, @LABEL$ = USE_RESTORE_LABEL$);
      799    14939    1     IF USE_LTS$ -> USE.LINK$ ~= ADDR(NIL) THEN
      800    14940    2       DO UNTIL USE_LTS$ = ADDR(NIL);
      801    14941              %NEW_ILL (@ID = %MVII,
      802    14942                        @LOP = USE_LTS$ -> USE.TO$,
      803    14943                        @ROP = USE_LTS$ -> USE.TO1$);
      804    15322    2         USE_LTS$ = USE_LTS$ -> USE.LINK$;
      805    15323    2       END; /* UNTIL */
      806    15324    1     USE_SAVE_LABEL$ = ADDR(NIL);
      807    15325    1     USE_RESTORE_LABEL$ = ADDR(NIL);
      808    15326    1   END Z8EO$GLOBAL_USE;

PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:143  
--  Include file information  --

   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EO$GLOBAL_USE.

   Procedure Z8EO$GLOBAL_USE requires 198 words for executable code.
   Procedure Z8EO$GLOBAL_USE requires 14 words of local(AUTO) storage.

    No errors detected in file Z8EO.:Z8A6TSI    .

PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:144  

 Object Unit name= Z8EO$GLOBAL_USE                            File name= Z8EO.:Z8A6TOU
 UTS= AUG 09 '97 12:29:28.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ILL$
    2  LblCom even  none     5      5  ILL_
    3  LblCom even  none     1      1  LTS$
    4  LblCom even  none     5      5  LTS_
    5  LblCom even  none     1      1  ST$
    6  LblCom even  none     5      5  ST_
    7  LblCom even  none    90    132  LEX_SYMBOL
    8  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
    9  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   10  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   11   Proc  even  none   198    306  Z8EO$GLOBAL_USE
   12  RoData even  none    22     26  Z8EO$GLOBAL_USE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        2  Z8EO$GLOBAL_USE
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:145  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z8EO$USE_SUPP
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       5 Z8AN$NEW_ILL1
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILL_STEP                         r    LTS_STEP                              O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:146  


      720        1        /*T***********************************************************/
      721        2        /*T*                                                         */
      722        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      723        4        /*T*                                                         */
      724        5        /*T***********************************************************/
      725        6        /*===============*/
      726        7          Z8EO$GLOBAL_USE: PROC (USE_SAVE_LABEL$, USE_RESTORE_LABEL$);

      7 11 000000   000000 700200 xent  Z8EO$GLOBAL* TSX0  ! X66_AUTO_2
        11 000001   000016 000002                    ZERO    14,2

      727        8        /*===============*/
      728        9        /*D*   NAME: Z8EO$GLOBAL_USE
      729       10               CALL: CALL Z8EO$GLOBAL_USE (USE_SAVE_LABEL$, USE_RESTORE_LABEL$);
      730       11              INPUT: USE_SAVE_LABEL$ -- If null, there are no GLOBAL USE procedures in
      731       12                                        the current program and this module will not be
      732       13                                        called. Otherwise, it points to a PARA item
      733       14                                        PERFORMed on entry into any GLOBAL USE proc in
      734       15                                        the current program.
      735       16                     USE_RESTORE_LABEL$ -- Points to a PARA item PERFORMed on exit from
      736       17                                           any GLOBAL USE proc in the current program.
      737       18            PURPOSE: Create the DEFLB items to go with the PARA items. Create the
      738       19                     paragraphs needed so that in the USE proc, all pointers to other
      739       20                     USE procs will have the same value as in the current program
      740       21                     proper.
      741       22        */
      742       23        %SET PHASE = 1;
      743       24        %INCLUDE Z8A_DEFC;
      744       92        %INCLUDE Z8A_SUPP_MAC;
      745     2492        %INCLUDE Z8A_ILL;
      746     3185        %INCLUDE Z8A_LTS;
      747     5262        %INCLUDE Z8A_ST;
      748     8921        %INCLUDE Z8E_STACKS;
      749    11187        %INCLUDE Z8E_O1COM;
      750    11948        %INCLUDE Z8E_MACROS;
      751    12623    1   DCL USE_SAVE_LABEL$ PTR;
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:147  
      752    12624    1   DCL USE_RESTORE_LABEL$ PTR;
      753    12625    1   DCL USE_LTS$ PTR;
      754    12626    1   DCL TEMP$ PTR;
      755    12627    1   DCL Z8AF$NEW_BASE ENTRY(3);
      756    12628    1   DCL Z8AT$CREATE_TEMPORARY ENTRY(2);
      757    12629    1   DCL Z8EO$USE_SUPP ENTRY;
      758    12630        %EJECT;
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:148  
      759    12631          /* First make sure there are USE items on chain for all USE procedures
      760    12632             that should be in effect at this level. */
      761    12633
      762    12634    1     CALL Z8EO$USE_SUPP;

  12634 11 000002   000000 631400 12                 EPPR1   0
        11 000003   000000 701000 xent               TSX1    Z8EO$USE_SUPP
        11 000004   000000 011000                    NOP     0

      763    12635
      764    12636          /* For a GLOBAL USE EXCEPTION procedure, it could be executed on behalf
      765    12637             of an I/O statement in a subordinate procedure. That being the case, it
      766    12638             is possible that there may be a different set of USE procedures in effect
      767    12639             while this USE procedure is in execution from what is in effect when the
      768    12640             I/O statement is executed. If, where the current USE procedure is, it is
      769    12641             the only USE procedure in effect, this does not hold true, but in any
      770    12642             other case, code is needed to make sure all USE procedure pointers are
      771    12643             set correctly. This code will be located at the end of DECLARATIVES,
      772    12644             because of which a section label is also needed, so that a PERFORM of
      773    12645             the USE procedure proper will not also PERFORM this code. */
      774    12646    1     USE_LTS$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;

  12646 11 000005   000057 470400 xsym               LDP0    O1COM+47
        11 000006   000001 471500                    LDP1    1,,PR0
        11 000007   100022 236100                    LDQ     18,,PR1
        11 000010   200005 756100                    STQ     USE_LTS$,,AUTO

      775    12647    1     CALL Z8AT$CREATE_TEMPORARY (%SECTION, TEMP$);

  12647 11 000011   200006 633500                    EPPR3   TEMP$,,AUTO
        11 000012   200011 453500                    STP3    TEMP$+3,,AUTO
        11 000013   000003 236000 12                 LDQ     3
        11 000014   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000015   200010 630500                    EPPR0   TEMP$+2,,AUTO
        11 000016   000001 631400 12                 EPPR1   1
        11 000017   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        11 000020   000000 011000                    NOP     0
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:149  

      776    12648          %NEW_ILL (@ID = %DEFLB, @LABEL$ = TEMP$);

  12980 11 000021   000007 236000 12                 LDQ     7
        11 000022   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000023   200010 630500                    EPPR0   TEMP$+2,,AUTO
        11 000024   200015 450500                    STP0    TEMP$+7,,AUTO
        11 000025   000010 236000 12                 LDQ     8
        11 000026   200014 756100                    STQ     TEMP$+6,,AUTO
        11 000027   000012 237000 12                 LDAQ    10
        11 000030   200012 757100                    STAQ    TEMP$+4,,AUTO
        11 000031   200012 630500                    EPPR0   TEMP$+4,,AUTO
        11 000032   000004 631400 12                 EPPR1   4
        11 000033   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        11 000034   000000 011000                    NOP     0

  12981 11 000035   200006 236100                    LDQ     TEMP$,,AUTO
        11 000036   000000 470400 1                  LDP0    ILL$
        11 000037   000001 756100                    STQ     1,,PR0

      777    13027          /* The above SECTION label delimits the last USE proc from the USE
      778    13028             pointer save/load paragraph. */
      779    13029          %NEW_ILL (@ID = %DEFLB, @LABEL$ = USE_SAVE_LABEL$);

  13361 11 000040   000007 236000 12                 LDQ     7
        11 000041   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000042   200010 631500                    EPPR1   TEMP$+2,,AUTO
        11 000043   200015 451500                    STP1    TEMP$+7,,AUTO
        11 000044   000010 236000 12                 LDQ     8
        11 000045   200014 756100                    STQ     TEMP$+6,,AUTO
        11 000046   000012 237000 12                 LDAQ    10
        11 000047   200012 757100                    STAQ    TEMP$+4,,AUTO
        11 000050   200012 630500                    EPPR0   TEMP$+4,,AUTO
        11 000051   000004 631400 12                 EPPR1   4
        11 000052   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        11 000053   000000 011000                    NOP     0

PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:150  
  13362 11 000054   200003 470500                    LDP0    @USE_SAVE_LABEL$,,AUTO
        11 000055   000000 236100                    LDQ     0,,PR0
        11 000056   000000 471400 1                  LDP1    ILL$
        11 000057   100001 756100                    STQ     1,,PR1

      780    13408    2     IF USE_LTS$ -> USE.LINK$ ~= ADDR(NIL) THEN DO;

  13408 11 000060   200005 473500                    LDP3    USE_LTS$,,AUTO
        11 000061   300003 236100                    LDQ     3,,PR3
        11 000062   000014 116000 12                 CMPQ    12
        11 000063   000216 600000 11                 TZE     s:14559

      781    13409    3       DO UNTIL USE_LTS$ = ADDR(NIL);

      782    13410    3         CALL Z8AT$CREATE_TEMPORARY (%SCALAR, TEMP$);

  13410 11 000064   200006 630500                    EPPR0   TEMP$,,AUTO
        11 000065   200011 450500                    STP0    TEMP$+3,,AUTO
        11 000066   000016 236000 12                 LDQ     14
        11 000067   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000070   200010 630500                    EPPR0   TEMP$+2,,AUTO
        11 000071   000001 631400 12                 EPPR1   1
        11 000072   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        11 000073   000000 011000                    NOP     0

      783    13411    3         CALL Z8AF$NEW_BASE (TEMP$, ADDR(NIL), TEMP$);

  13411 11 000074   000014 236000 12                 LDQ     12
        11 000075   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000076   200006 630500                    EPPR0   TEMP$,,AUTO
        11 000077   200013 450500                    STP0    TEMP$+5,,AUTO
        11 000100   200010 631500                    EPPR1   TEMP$+2,,AUTO
        11 000101   200012 451500                    STP1    TEMP$+4,,AUTO
        11 000102   200006 633500                    EPPR3   TEMP$,,AUTO
        11 000103   200011 453500                    STP3    TEMP$+3,,AUTO
        11 000104   200011 630500                    EPPR0   TEMP$+3,,AUTO
        11 000105   000017 631400 12                 EPPR1   15
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:151  
        11 000106   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        11 000107   000000 011000                    NOP     0

      784    13412              %NEW_ILL (@ID = %MVII,
      785    13413                        @LOP = TEMP$,
      786    13414                        @ROP = USE_LTS$ -> USE.TO$);

  13727 11 000110   000007 236000 12                 LDQ     7
        11 000111   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000112   200006 630500                    EPPR0   TEMP$,,AUTO
        11 000113   200015 450500                    STP0    TEMP$+7,,AUTO
        11 000114   200010 631500                    EPPR1   TEMP$+2,,AUTO
        11 000115   200014 451500                    STP1    TEMP$+6,,AUTO
        11 000116   000024 237000 12                 LDAQ    20
        11 000117   200012 757100                    STAQ    TEMP$+4,,AUTO
        11 000120   000023 236000 12                 LDQ     19
        11 000121   200011 756100                    STQ     TEMP$+3,,AUTO
        11 000122   200011 630500                    EPPR0   TEMP$+3,,AUTO
        11 000123   000020 631400 12                 EPPR1   16
        11 000124   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        11 000125   000000 011000                    NOP     0

  13730 11 000126   200006 236100                    LDQ     TEMP$,,AUTO
        11 000127   000000 470400 1                  LDP0    ILL$
        11 000130   000001 756100                    STQ     1,,PR0

  13731 11 000131   200005 471500                    LDP1    USE_LTS$,,AUTO
        11 000132   100004 236100                    LDQ     4,,PR1
        11 000133   000002 756100                    STQ     2,,PR0

      787    13793    3         USE_LTS$ -> USE.TO1$ = TEMP$;

  13793 11 000134   200006 236100                    LDQ     TEMP$,,AUTO
        11 000135   100017 756100                    STQ     15,,PR1

      788    13794              %NEW_ILL (@ID = %MVII,
      789    13795                        @LOP = USE_LTS$ -> USE.TO$,
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:152  
      790    13796                        @ROP = USE_LTS$ -> USE.INIT_LABEL_BASE$);

  14109 11 000136   000007 236000 12                 LDQ     7
        11 000137   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000140   200005 236100                    LDQ     USE_LTS$,,AUTO
        11 000141   000004 036003                    ADLQ    4,DU
        11 000142   200015 756100                    STQ     TEMP$+7,,AUTO
        11 000143   200010 633500                    EPPR3   TEMP$+2,,AUTO
        11 000144   200014 453500                    STP3    TEMP$+6,,AUTO
        11 000145   000024 237000 12                 LDAQ    20
        11 000146   200012 757100                    STAQ    TEMP$+4,,AUTO
        11 000147   000023 236000 12                 LDQ     19
        11 000150   200011 756100                    STQ     TEMP$+3,,AUTO
        11 000151   200011 630500                    EPPR0   TEMP$+3,,AUTO
        11 000152   000020 631400 12                 EPPR1   16
        11 000153   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        11 000154   000000 011000                    NOP     0

  14112 11 000155   200005 470500                    LDP0    USE_LTS$,,AUTO
        11 000156   000004 236100                    LDQ     4,,PR0
        11 000157   000000 471400 1                  LDP1    ILL$
        11 000160   100001 756100                    STQ     1,,PR1

  14113 11 000161   000016 236100                    LDQ     14,,PR0
        11 000162   100002 756100                    STQ     2,,PR1

      791    14175    3         USE_LTS$ = USE_LTS$ -> USE.LINK$;

  14175 11 000163   000003 236100                    LDQ     3,,PR0
        11 000164   200005 756100                    STQ     USE_LTS$,,AUTO

      792    14176    3       END; /* UNTIL */

  14176 11 000165   000014 116000 12                 CMPQ    12
        11 000166   000064 601000 11                 TNZ     s:13410

      793    14177    2       CALL Z8AT$CREATE_TEMPORARY (%SECTION, TEMP$);
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:153  

  14177 11 000167   200006 630500                    EPPR0   TEMP$,,AUTO
        11 000170   200011 450500                    STP0    TEMP$+3,,AUTO
        11 000171   000003 236000 12                 LDQ     3
        11 000172   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000173   200010 630500                    EPPR0   TEMP$+2,,AUTO
        11 000174   000001 631400 12                 EPPR1   1
        11 000175   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        11 000176   000000 011000                    NOP     0

      794    14178            %NEW_ILL (@ID = %DEFLB, @LABEL$ = TEMP$);

  14510 11 000177   000007 236000 12                 LDQ     7
        11 000200   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000201   200010 630500                    EPPR0   TEMP$+2,,AUTO
        11 000202   200015 450500                    STP0    TEMP$+7,,AUTO
        11 000203   000010 236000 12                 LDQ     8
        11 000204   200014 756100                    STQ     TEMP$+6,,AUTO
        11 000205   000012 237000 12                 LDAQ    10
        11 000206   200012 757100                    STAQ    TEMP$+4,,AUTO
        11 000207   200012 630500                    EPPR0   TEMP$+4,,AUTO
        11 000210   000004 631400 12                 EPPR1   4
        11 000211   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        11 000212   000000 011000                    NOP     0

  14511 11 000213   200006 236100                    LDQ     TEMP$,,AUTO
        11 000214   000000 470400 1                  LDP0    ILL$
        11 000215   000001 756100                    STQ     1,,PR0

      795    14557            /* SECTION label to separate save/load paragraph from restore paragraph. */
      796    14558    2     END;

      797    14559    1     USE_LTS$ = O1COM.CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.USE_CHAIN$;

  14559 11 000216   000057 470400 xsym               LDP0    O1COM+47
        11 000217   000001 471500                    LDP1    1,,PR0
        11 000220   100022 236100                    LDQ     18,,PR1
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:154  
        11 000221   200005 756100                    STQ     USE_LTS$,,AUTO

      798    14560          %NEW_ILL (@ID = %DEFLB, @LABEL$ = USE_RESTORE_LABEL$);

  14892 11 000222   000007 236000 12                 LDQ     7
        11 000223   200010 756100                    STQ     TEMP$+2,,AUTO
        11 000224   200010 631500                    EPPR1   TEMP$+2,,AUTO
        11 000225   200015 451500                    STP1    TEMP$+7,,AUTO
        11 000226   000010 236000 12                 LDQ     8
        11 000227   200014 756100                    STQ     TEMP$+6,,AUTO
        11 000230   000012 237000 12                 LDAQ    10
        11 000231   200012 757100                    STAQ    TEMP$+4,,AUTO
        11 000232   200012 630500                    EPPR0   TEMP$+4,,AUTO
        11 000233   000004 631400 12                 EPPR1   4
        11 000234   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        11 000235   000000 011000                    NOP     0

  14893 11 000236   200004 470500                    LDP0    @USE_RESTORE_LABEL$,,AUTO
        11 000237   000000 236100                    LDQ     0,,PR0
        11 000240   000000 471400 1                  LDP1    ILL$
        11 000241   100001 756100                    STQ     1,,PR1

      799    14939    1     IF USE_LTS$ -> USE.LINK$ ~= ADDR(NIL) THEN

  14939 11 000242   200005 473500                    LDP3    USE_LTS$,,AUTO
        11 000243   300003 236100                    LDQ     3,,PR3
        11 000244   000014 116000 12                 CMPQ    12
        11 000245   000277 600000 11                 TZE     s:15324

      800    14940    2       DO UNTIL USE_LTS$ = ADDR(NIL);

      801    14941              %NEW_ILL (@ID = %MVII,
      802    14942                        @LOP = USE_LTS$ -> USE.TO$,
      803    14943                        @ROP = USE_LTS$ -> USE.TO1$);

  15256 11 000246   000007 236000 12                 LDQ     7
        11 000247   200010 756100                    STQ     TEMP$+2,,AUTO
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:155  
        11 000250   200005 236100                    LDQ     USE_LTS$,,AUTO
        11 000251   000004 036003                    ADLQ    4,DU
        11 000252   200015 756100                    STQ     TEMP$+7,,AUTO
        11 000253   200010 630500                    EPPR0   TEMP$+2,,AUTO
        11 000254   200014 450500                    STP0    TEMP$+6,,AUTO
        11 000255   000024 237000 12                 LDAQ    20
        11 000256   200012 757100                    STAQ    TEMP$+4,,AUTO
        11 000257   000023 236000 12                 LDQ     19
        11 000260   200011 756100                    STQ     TEMP$+3,,AUTO
        11 000261   200011 630500                    EPPR0   TEMP$+3,,AUTO
        11 000262   000020 631400 12                 EPPR1   16
        11 000263   000000 701000 xent               TSX1    Z8AN$NEW_ILL1
        11 000264   000000 011000                    NOP     0

  15259 11 000265   200005 470500                    LDP0    USE_LTS$,,AUTO
        11 000266   000004 236100                    LDQ     4,,PR0
        11 000267   000000 471400 1                  LDP1    ILL$
        11 000270   100001 756100                    STQ     1,,PR1

  15260 11 000271   000017 236100                    LDQ     15,,PR0
        11 000272   100002 756100                    STQ     2,,PR1

      804    15322    2         USE_LTS$ = USE_LTS$ -> USE.LINK$;

  15322 11 000273   000003 236100                    LDQ     3,,PR0
        11 000274   200005 756100                    STQ     USE_LTS$,,AUTO

      805    15323    2       END; /* UNTIL */

  15323 11 000275   000014 116000 12                 CMPQ    12
        11 000276   000246 601000 11                 TNZ     s:15256

      806    15324    1     USE_SAVE_LABEL$ = ADDR(NIL);

  15324 11 000277   000014 236000 12                 LDQ     12
        11 000300   200003 470500                    LDP0    @USE_SAVE_LABEL$,,AUTO
        11 000301   000000 756100                    STQ     0,,PR0
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:156  

      807    15325    1     USE_RESTORE_LABEL$ = ADDR(NIL);

  15325 11 000302   000014 236000 12                 LDQ     12
        11 000303   200004 471500                    LDP1    @USE_RESTORE_LABEL$,,AUTO
        11 000304   100000 756100                    STQ     0,,PR1

      808    15326    1   END Z8EO$GLOBAL_USE;

  15326 11 000305   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:157  
--  Include file information  --

   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EO$GLOBAL_USE.
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:158  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 002 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 003 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 004 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:159  
  ****  Section 005 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 006 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 007 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 008 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 009 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 010 LblCom TEMP_LEX_SYMBOL2

PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:160  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @USE_RESTORE_LABEL$        3-0-0/w PTR         r     1 @USE_SAVE_LABEL$
     6-0-0/w PTR         r     1 TEMP$                      5-0-0/w PTR         r     1 USE_LTS$
    *0-0-0/w PTR         r     1 USE_RESTORE_LABEL$        *0-0-0/w PTR         r     1 USE_SAVE_LABEL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)   r     1 BINARY_ILL
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:161  
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)   r     1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w STRC(144)         1 DOEND
     0-0-0/w STRC(396)         1 DO_N                       0-0-0/w STRC(180)         1 DV4I
     0-0-0/w STRC(180)         1 ENTRY_ILL                  0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC              1 LTS                        0-0-0/w STRC(360)         1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:162  
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)         1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/d STRC(612)   r     1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EO$GLOBAL_USE requires 198 words for executable code.
   Procedure Z8EO$GLOBAL_USE requires 14 words of local(AUTO) storage.
PL6.E3A0      #003=Z8EO$GLOBAL_USE File=Z8EO.:Z8A6TSI                            SAT 08/09/97 12:29 Page:163  

    No errors detected in file Z8EO.:Z8A6TSI    .
