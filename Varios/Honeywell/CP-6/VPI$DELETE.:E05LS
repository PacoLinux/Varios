VERSION E05

PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:1    
        1        1        /*M* VPI$DELETE  This module contains routines needed for the DELETE commands.
        2        2        */
        3        3        /*T***********************************************************/
        4        4        /*T*                                                         */
        5        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        6        6        /*T*                                                         */
        7        7        /*T***********************************************************/
        8        8        /*X* DTI=1,THI=1 */
        9        9        /* Next available error code = 40 (by 10's) */
       10       10        /* ALSO AVAILABLE = 20 */
       11       11        VPI$DELETE: PROC;
       12       12        /*D* NAME: VPI$DELETE
       13       13             CALL: CALL VPI$DELETE;
       14       14             DESCRIPTION: This procedure drives the deletion process.
       15       15        */
       16       16        %INCLUDE VP_DATA_R;
       17     7003        %INCLUDE F$DCB;
       18     7052        %B$TCB;
       19     7055        %B$ALT;
       20     7063        %INCLUDE B_ERRORS_C;
       21     8190        /**/
       22     8191        /*  BASED  DATA  */
       23     8192        /**/
       24     8193        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
       25     8238        /**/
       26     8239        /*  LOCAL AUTO  */
       27     8240        /**/
       28     8241    1   DCL NEXT_SPEC_RET_VAL SBIN WORD;
       29     8242    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
       30     8243    1   DCL IDX SBIN WORD;
       31     8244    1   DCL SOURCELIST$ PTR;
       32     8245    1   DCL PTR$ PTR;
       33     8246        /**/
       34     8247        /*  ENTRY DCLS  */
       35     8248        /**/
       36     8249    1   DCL X$PARSE ENTRY(1) ALTRET;
       37     8250        %VP_ENTRIES (OMIT=VPI$DELETE);
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:2    
       38     8458        /**/
       39     8459    1   VPI$DELETESTD: ENTRY;
       40     8460    1           REMEMBER DELETE_ABORT IN ABORT_CMD;
       41     8461    1           SOURCELIST$ = ADDR(NIL);
       42     8462    2           DO IDX=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;
       43     8463    2              PTR$ = PCB.OUT$->OUT$BLK.SUBLK$(IDX);
       44     8464    3              DO CASE(PTR$->OUT$BLK.CODE);
       45     8465    3               CASE(1);                    /* SOURCELIST                         */
       46     8466    3                 SOURCELIST$ = PTR$;
       47     8467    3               CASE(3);                    /* FROM 'FID'                         */
       48     8468    3                 CALL VPF$SET_FROM_INFO(PTR$->OUT$BLK.SUBLK$(0));
       49     8469    3               CASE(4);                    /* DELETESTD 'FID'                    */
       50     8470    3                 CALL VPD$INIT_STD_FILE(PTR$);
       51     8471    3               END;                        /* END CASE                           */
       52     8472    2              END;
       53     8473    1           IF CMD_MASK(7)                  /* IF DELETESTD                       */
       54     8474    1            THEN
       55     8475    2            DO;
       56     8476    2   DELETESTD_L:
       57     8477    2               CALL M$READ(FPT_READ_STD) ALTRET(STD_READ_ALT);
       58     8478    2               PCB.NCHARS = M$STD1$->F$DCB.ARS;
       59     8479    2               CALL X$PARSE(PCB) ALTRET(STD_PARSE_ALT);
       60     8480    2               SOURCELIST$ = PCB.OUT$;
       61     8481    2               END;
       62     8482    1           CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,SOURCELIST$);
       63     8483    2           DO WHILE(NEXT_SPEC_RET_VAL~=1);
       64     8484    2              IF NEXT_SPEC_RET_VAL=0
       65     8485    2               THEN
       66     8486    2                 CALL VPI$DELETE_SPEC;
       67     8487    2   NEXT_SPEC:
       68     8488    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);
       69     8489    2              END;
       70     8490    1           IF CMD_MASK(7)                  /* IF DELETESTD                       */
       71     8491    1            THEN
       72     8492    1              GOTO DELETESTD_L;
       73     8493    1   DELETE_ABORT:
       74     8494    1           CALL VPD$FINISH_NLIST;          /* Finish dangling name list          */
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:3    
       75     8495    1           CALL VPD$COUNTER_PRINT(1);
       76     8496    1           IF M$STD1$->F$DCB.FCD
       77     8497    1            THEN
       78     8498    1              CALL M$CLOSE(FPT_CLOSE_STD);
       79     8499    1           RETURN;
       80     8500    1   STD_READ_ALT:
       81     8501    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF
       82     8502    1            THEN
       83     8503    1              GOTO DELETE_ABORT;
       84     8504    1            ELSE
       85     8505    1              CALL VPL$ERR_PROC(3,0);
       86     8506    1   STD_PARSE_ALT:
       87     8507    1           CALL VPL$ERR_PROC(0,0,,PCB.ERROR);
       88     8508    1           CALL VPL$ERR_PROC(3,10,'11'O);
       89     8509        /*E*   ERROR: VPI-00010
       90     8510             MESSAGE: in DELETE's STD file.  DELETE aborts.
       91     8511            MESSAGE1: A record in the STD file has a bad source or option.
       92     8512        */
       93     8513    1   END VPI$DELETE;
       94     8514        %EOD;

PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:4    
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPI$DELETE.

   Procedure VPI$DELETE requires 130 words for executable code.
   Procedure VPI$DELETE requires 12 words of local(AUTO) storage.

PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:5    

 Object Unit name= VPI$DELETE                                 File name= VPI$DELETE.:E05TOU
 UTS= JUL 30 '97 07:46:04.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Proc  even  none   130    202  VPI$DELETE
   11  RoData even  none    12     14  VPI$DELETE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes            yes      Std        0  VPI$DELETE
    10      3                  yes      Std        0  VPI$DELETESTD
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:6    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 VPF$SET_FROM_INFO
         yes           Std       1 VPD$INIT_STD_FILE
         yes           Std       0 VPI$DELETE_SPEC
         yes           Std       8 VPL$ERR_PROC
         yes           Std       2 VPD$FINISH_NLIST
         yes           Std       2 VPF$GET_NEXT_SPEC
         yes           Std       1 VPD$COUNTER_PRINT
 yes     yes           Std       1 X$PARSE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PCB                                   ABORT_CMD
     BREAK_LOC                             BREAK_MESSAGE_REPORTER                CMD_MASK
     SPEC_BUF                              IN_RES                                M$EI
     M$EO                                  M$EO1                                 M$ME
     M$SI                                  M$READFILE                            M$DO
     M$STD1                                M$STD1$                               M$SORT1
     B$TCB$                           r    FPT_READ_STD                     r    FPT_CLOSE_STD
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:7    


        1        1        /*M* VPI$DELETE  This module contains routines needed for the DELETE commands.
        2        2        */
        3        3        /*T***********************************************************/
        4        4        /*T*                                                         */
        5        5        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        6        6        /*T*                                                         */
        7        7        /*T***********************************************************/
        8        8        /*X* DTI=1,THI=1 */
        9        9        /* Next available error code = 40 (by 10's) */
       10       10        /* ALSO AVAILABLE = 20 */
       11       11        VPI$DELETE: PROC;

     11 10 000000   000000 700200 xent  VPI$DELETE   TSX0  ! X66_AUTO_0
        10 000001   000014 000000                    ZERO    12,0
        10 000002   000005 710000 10                 TRA     s:8460

       12       12        /*D* NAME: VPI$DELETE
       13       13             CALL: CALL VPI$DELETE;
       14       14             DESCRIPTION: This procedure drives the deletion process.
       15       15        */
       16       16        %INCLUDE VP_DATA_R;
       17     7003        %INCLUDE F$DCB;
       18     7052        %B$TCB;
       19     7055        %B$ALT;
       20     7063        %INCLUDE B_ERRORS_C;
       21     8190        /**/
       22     8191        /*  BASED  DATA  */
       23     8192        /**/
       24     8193        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
       25     8238        /**/
       26     8239        /*  LOCAL AUTO  */
       27     8240        /**/
       28     8241    1   DCL NEXT_SPEC_RET_VAL SBIN WORD;
       29     8242    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
       30     8243    1   DCL IDX SBIN WORD;
       31     8244    1   DCL SOURCELIST$ PTR;
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:8    
       32     8245    1   DCL PTR$ PTR;
       33     8246        /**/
       34     8247        /*  ENTRY DCLS  */
       35     8248        /**/
       36     8249    1   DCL X$PARSE ENTRY(1) ALTRET;
       37     8250        %VP_ENTRIES (OMIT=VPI$DELETE);
       38     8458        /**/
       39     8459    1   VPI$DELETESTD: ENTRY;

   8459 10 000003   000000 700200 xent  VPI$DELETES* TSX0  ! X66_AUTO_0
        10 000004   000014 000000                    ZERO    12,0

       40     8460    1           REMEMBER DELETE_ABORT IN ABORT_CMD;

   8460 10 000005   000133 635000 10                 EAA     DELETE_ABORT
        10 000006   000000 452400 xsym               STP2    ABORT_CMD
        10 000007   000001 755000 xsym               STA     ABORT_CMD+1

       41     8461    1           SOURCELIST$ = ADDR(NIL);

   8461 10 000010   000001 236000 xsym               LDQ     B_VECTNIL+1
        10 000011   200006 756100                    STQ     SOURCELIST$,,AUTO

       42     8462    2           DO IDX=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;

   8462 10 000012   200005 450100                    STZ     IDX,,AUTO
        10 000013   000052 710000 10                 TRA     s:8472+1

       43     8463    2              PTR$ = PCB.OUT$->OUT$BLK.SUBLK$(IDX);

   8463 10 000014   000003 470400 xsym               LDP0    PCB+3
        10 000015   200005 720100                    LXL0    IDX,,AUTO
        10 000016   000003 236110                    LDQ     3,X0,PR0
        10 000017   200007 756100                    STQ     PTR$,,AUTO

       44     8464    3              DO CASE(PTR$->OUT$BLK.CODE);

PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:9    
   8464 10 000020   200007 471500                    LDP1    PTR$,,AUTO
        10 000021   100000 721100                    LXL1    0,,PR1
        10 000022   000005 101003                    CMPX1   5,DU
        10 000023   000025 602011 10                 TNC     s:8464+5,X1
        10 000024   000051 710000 10                 TRA     s:8472
        10 000025   000051 710000 10                 TRA     s:8472
        10 000026   000032 710000 10                 TRA     s:8466
        10 000027   000051 710000 10                 TRA     s:8472
        10 000030   000034 710000 10                 TRA     s:8468
        10 000031   000043 710000 10                 TRA     s:8470

       45     8465    3               CASE(1);                    /* SOURCELIST                         */

       46     8466    3                 SOURCELIST$ = PTR$;

   8466 10 000032   200006 756100                    STQ     SOURCELIST$,,AUTO
        10 000033   000051 710000 10                 TRA     s:8472

       47     8467    3               CASE(3);                    /* FROM 'FID'                         */

       48     8468    3                 CALL VPF$SET_FROM_INFO(PTR$->OUT$BLK.SUBLK$(0));

   8468 10 000034   000003 036003                    ADLQ    3,DU
        10 000035   200010 756100                    STQ     PTR$+1,,AUTO
        10 000036   200010 630500                    EPPR0   PTR$+1,,AUTO
        10 000037   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 000040   000000 701000 xent               TSX1    VPF$SET_FROM_INFO
        10 000041   000000 011000                    NOP     0
        10 000042   000051 710000 10                 TRA     s:8472

       49     8469    3               CASE(4);                    /* DELETESTD 'FID'                    */

       50     8470    3                 CALL VPD$INIT_STD_FILE(PTR$);

   8470 10 000043   200007 633500                    EPPR3   PTR$,,AUTO
        10 000044   200010 453500                    STP3    PTR$+1,,AUTO
        10 000045   200010 630500                    EPPR0   PTR$+1,,AUTO
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:10   
        10 000046   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 000047   000000 701000 xent               TSX1    VPD$INIT_STD_FILE
        10 000050   000000 011000                    NOP     0

       51     8471    3               END;                        /* END CASE                           */

       52     8472    2              END;

   8472 10 000051   200005 054100                    AOS     IDX,,AUTO
        10 000052   000003 470400 xsym               LDP0    PCB+3
        10 000053   000001 236100                    LDQ     1,,PR0
        10 000054   000022 772000                    QRL     18
        10 000055   200005 116100                    CMPQ    IDX,,AUTO
        10 000056   000014 605400 10                 TPNZ    s:8463

       53     8473    1           IF CMD_MASK(7)                  /* IF DELETESTD                       */

   8473 10 000057   000000 236000 xsym               LDQ     CMD_MASK
        10 000060   002000 316003                    CANQ    1024,DU
        10 000061   000077 600000 10                 TZE     s:8482

       54     8474    1            THEN
       55     8475    2            DO;

       56     8476    2   DELETESTD_L:
       57     8477    2               CALL M$READ(FPT_READ_STD) ALTRET(STD_READ_ALT);

   8477 10 000062   000000 630400 xsym  DELETESTD_L  EPPR0   FPT_READ_STD
        10 000063   440000 713400                    CLIMB   alt,read
        10 000064   401400 401760                    pmme    nvectors=4
        10 000065   000152 702000 10                 TSX2    STD_READ_ALT

       58     8478    2               PCB.NCHARS = M$STD1$->F$DCB.ARS;

   8478 10 000066   000000 470400 xsym               LDP0    M$STD1$
        10 000067   000000 235100                    LDA     0,,PR0
        10 000070   000011 755000 xsym               STA     PCB+9
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:11   

       59     8479    2               CALL X$PARSE(PCB) ALTRET(STD_PARSE_ALT);

   8479 10 000071   000000 630400 11                 EPPR0   0
        10 000072   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 000073   000000 701000 xent               TSX1    X$PARSE
        10 000074   000164 702000 10                 TSX2    STD_PARSE_ALT

       60     8480    2               SOURCELIST$ = PCB.OUT$;

   8480 10 000075   000003 236000 xsym               LDQ     PCB+3
        10 000076   200006 756100                    STQ     SOURCELIST$,,AUTO

       61     8481    2               END;

       62     8482    1           CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,SOURCELIST$);

   8482 10 000077   200006 630500                    EPPR0   SOURCELIST$,,AUTO
        10 000100   200011 450500                    STP0    PTR$+2,,AUTO
        10 000101   200003 631500                    EPPR1   NEXT_SPEC_RET_VAL,,AUTO
        10 000102   200010 451500                    STP1    PTR$+1,,AUTO
        10 000103   200010 630500                    EPPR0   PTR$+1,,AUTO
        10 000104   000020 631400 xsym               EPPR1   B_VECTNIL+16
        10 000105   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        10 000106   000000 011000                    NOP     0

       63     8483    2           DO WHILE(NEXT_SPEC_RET_VAL~=1);

   8483 10 000107   200003 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        10 000110   000001 115007                    CMPA    1,DL
        10 000111   000130 600000 10                 TZE     s:8490

       64     8484    2              IF NEXT_SPEC_RET_VAL=0

   8484 10 000112   200003 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        10 000113   000117 601000 10                 TNZ     NEXT_SPEC

PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:12   
       65     8485    2               THEN
       66     8486    2                 CALL VPI$DELETE_SPEC;

   8486 10 000114   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000115   000000 701000 xent               TSX1    VPI$DELETE_SPEC
        10 000116   000000 011000                    NOP     0

       67     8487    2   NEXT_SPEC:
       68     8488    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);

   8488 10 000117   200003 630500       NEXT_SPEC    EPPR0   NEXT_SPEC_RET_VAL,,AUTO
        10 000120   200010 450500                    STP0    PTR$+1,,AUTO
        10 000121   200010 630500                    EPPR0   PTR$+1,,AUTO
        10 000122   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 000123   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        10 000124   000000 011000                    NOP     0

       69     8489    2              END;

   8489 10 000125   200003 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        10 000126   000001 115007                    CMPA    1,DL
        10 000127   000112 601000 10                 TNZ     s:8484

       70     8490    1           IF CMD_MASK(7)                  /* IF DELETESTD                       */

   8490 10 000130   000000 236000 xsym               LDQ     CMD_MASK
        10 000131   002000 316003                    CANQ    1024,DU
        10 000132   000062 601000 10                 TNZ     DELETESTD_L

       71     8491    1            THEN
       72     8492    1              GOTO DELETESTD_L;
       73     8493    1   DELETE_ABORT:
       74     8494    1           CALL VPD$FINISH_NLIST;          /* Finish dangling name list          */

   8494 10 000133   000002 631400 xsym  DELETE_ABORT EPPR1   B_VECTNIL+2
        10 000134   000000 701000 xent               TSX1    VPD$FINISH_NLIST
        10 000135   000000 011000                    NOP     0
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:13   

       75     8495    1           CALL VPD$COUNTER_PRINT(1);

   8495 10 000136   000001 630400 11                 EPPR0   1
        10 000137   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 000140   000000 701000 xent               TSX1    VPD$COUNTER_PRINT
        10 000141   000000 011000                    NOP     0

       76     8496    1           IF M$STD1$->F$DCB.FCD

   8496 10 000142   000000 470400 xsym               LDP0    M$STD1$
        10 000143   000031 236100                    LDQ     25,,PR0
        10 000144   020000 316007                    CANQ    8192,DL
        10 000145   000151 600000 10                 TZE     s:8499

       77     8497    1            THEN
       78     8498    1              CALL M$CLOSE(FPT_CLOSE_STD);

   8498 10 000146   000000 630400 xsym               EPPR0   FPT_CLOSE_STD
        10 000147   050001 713400                    CLIMB   close
        10 000150   406000 401760                    pmme    nvectors=13

       79     8499    1           RETURN;

   8499 10 000151   000000 702200 xent               TSX2  ! X66_ARET

       80     8500    1   STD_READ_ALT:
       81     8501    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF

   8501 10 000152   000000 470400 xsym  STD_READ_ALT LDP0    B$TCB$
        10 000153   000000 471500                    LDP1    0,,PR0
        10 000154   100102 236100                    LDQ     66,,PR1
        10 000155   377770 376007                    ANQ     131064,DL
        10 000156   000060 116007                    CMPQ    48,DL
        10 000157   000133 600000 10                 TZE     DELETE_ABORT

       82     8502    1            THEN
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:14   
       83     8503    1              GOTO DELETE_ABORT;
       84     8504    1            ELSE
       85     8505    1              CALL VPL$ERR_PROC(3,0);

   8505 10 000160   000002 630400 11                 EPPR0   2
        10 000161   000020 631400 xsym               EPPR1   B_VECTNIL+16
        10 000162   000000 701000 xent               TSX1    VPL$ERR_PROC
        10 000163   000000 011000                    NOP     0

       86     8506    1   STD_PARSE_ALT:
       87     8507    1           CALL VPL$ERR_PROC(0,0,,PCB.ERROR);

   8507 10 000164   000004 236000 11    STD_PARSE_A* LDQ     4
        10 000165   000001 235000 xsym               LDA     B_VECTNIL+1
        10 000166   200012 757100                    STAQ    PTR$+3,,AUTO
        10 000167   000006 237000 11                 LDAQ    6
        10 000170   200010 757100                    STAQ    PTR$+1,,AUTO
        10 000171   200010 630500                    EPPR0   PTR$+1,,AUTO
        10 000172   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000173   000000 701000 xent               TSX1    VPL$ERR_PROC
        10 000174   000000 011000                    NOP     0

       88     8508    1           CALL VPL$ERR_PROC(3,10,'11'O);

   8508 10 000175   000011 630400 11                 EPPR0   9
        10 000176   000021 631400 xsym               EPPR1   B_VECTNIL+17
        10 000177   000000 701000 xent               TSX1    VPL$ERR_PROC
        10 000200   000000 011000                    NOP     0

       89     8509        /*E*   ERROR: VPI-00010
       90     8510             MESSAGE: in DELETE's STD file.  DELETE aborts.
       91     8511            MESSAGE1: A record in the STD file has a bad source or option.
       92     8512        */
       93     8513    1   END VPI$DELETE;

   8513 10 000201   000000 702200 xent               TSX2  ! X66_ARET
       94     8514        %EOD;
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:15   

PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:16   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPI$DELETE.
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:17   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w SBIN        r     1 IDX                        3-0-0/w SBIN        r     1 NEXT_SPEC_RET_VAL
     7-0-0/w PTR         r     1 PTR$                       6-0-0/w PTR         r     1 SOURCELIST$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ABORT_CMD                  0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/b BIT         r     1 CMD_MASK(0:71)
     0-0-0/d STRC(1080)  r     1 FPT_CLOSE_STD              0-0-0/d STRC(504)   r     1 FPT_READ_STD
     0-0-0/w PTR         r     1 M$STD1$                    0-0-0/w STRC(504)   r     1 PCB

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(144)   r     1 OUT$BLK


   Procedure VPI$DELETE requires 130 words for executable code.
   Procedure VPI$DELETE requires 12 words of local(AUTO) storage.
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:18   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:19   
          MINI XREF LISTING

ABORT_CMD
      5188**DCL      8460<<REMEMBR
B$ALT.CODE
      7057**DCL      7057--REDEF    7058--REDEF    7058--REDEF
B$ALT.ERR.CODE
      7059**DCL      8501>>IF
B$ALT.ERR.ERR#
      7059**DCL      7059--REDEF
B$ALT.EVID
      7058**DCL      7058--REDEF    7058--REDEF
B$TCB.ALT$
      7053**DCL      8501>>IF
B$TCB$
      5988**DCL      8501>>IF
BREAK_LOC
      5223**DCL      5223--REDEF
CMD_MASK
      5225**DCL      8473>>IF       8490>>IF
DEF_ICB.FID.STRING
      5821**DCL      5822--REDEF
DELETESTD_L
      8477**LABEL    8492--GOTO
DELETE_ABORT
      8494**LABEL    8460--REMEMBR  8503--GOTO
DEV_ICB.FID.STRING
      5707**DCL      5708--REDEF
EI_KEY.KEY
      5919**DCL      5919--REDEF    5919--REDEF    5919--REDEF
EO_OCB.TYPE
      5419**DCL      5420--REDEF
F$DCB.ACTPOS
      7029**DCL      7029--REDEF
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:20   
F$DCB.ARS
      7004**DCL      7004--REDEF    8478>>ASSIGN
F$DCB.ATTR
      7022**DCL      7023--REDEF
F$DCB.BORROW
      7037**DCL      7037--REDEF    7037--REDEF    7037--REDEF
F$DCB.DCBNAME.L
      7051**DCL      7051--IMP-SIZ
F$DCB.EOMCHAR
      7008**DCL      7008--REDEF
F$DCB.FCD
      7017**DCL      8496>>IF
F$DCB.FLDID
      7032**DCL      7032--REDEF
F$DCB.FORM$
      7026**DCL      7026--REDEF
F$DCB.FSECT
      7042**DCL      7042--REDEF
F$DCB.FSN
      7019**DCL      7019--REDEF    7019--REDEF    7020--REDEF
F$DCB.HEADER$
      7025**DCL      7025--REDEF
F$DCB.IXTNSIZE
      7023**DCL      7023--REDEF
F$DCB.LASTSTA$
      7013**DCL      7013--REDEF
F$DCB.LVL
      7038**DCL      7038--REDEF
F$DCB.NAME.C
      7013**DCL      7013--REDEF
F$DCB.NOEOF
      7034**DCL      7034--REDEF
F$DCB.NRECS
      7024**DCL      7024--REDEF
F$DCB.NRECX
      7043**DCL      7043--REDEF
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:21   
F$DCB.OHDR
      7035**DCL      7035--REDEF
F$DCB.ORG
      7018**DCL      7018--REDEF
F$DCB.PRECNO
      7041**DCL      7041--REDEF
F$DCB.RCSZ
      7046**DCL      7046--REDEF
F$DCB.RES
      7014**DCL      7014--REDEF
F$DCB.SETX
      7026**DCL      7026--REDEF
F$DCB.TAB$
      7025**DCL      7026--REDEF
F$DCB.TDA
      7040**DCL      7040--REDEF
F$DCB.WSN
      7015**DCL      7015--REDEF
FPT_CLOSE_EI.SN_
      6760**DCL      6760--REDEF
FPT_CLOSE_EI.UTL_
      6761**DCL      6761--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6775**DCL      6775--REDEF
FPT_CLOSE_EI.V.TYPE#
      6773**DCL      6773--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6770**DCL      6770--REDEF    6772--REDEF
FPT_CLOSE_PTL.SN_
      6886**DCL      6886--REDEF
FPT_CLOSE_PTL.UTL_
      6887**DCL      6887--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6901**DCL      6901--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6899**DCL      6899--REDEF
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:22   
FPT_CLOSE_PTL.V.XTNSIZE#
      6896**DCL      6896--REDEF    6898--REDEF
FPT_CLOSE_READ.SN_
      6802**DCL      6802--REDEF
FPT_CLOSE_READ.UTL_
      6803**DCL      6803--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6817**DCL      6817--REDEF
FPT_CLOSE_READ.V.TYPE#
      6815**DCL      6815--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6812**DCL      6812--REDEF    6814--REDEF
FPT_CLOSE_SI.SN_
      6970**DCL      6970--REDEF
FPT_CLOSE_SI.UTL_
      6971**DCL      6971--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6985**DCL      6985--REDEF
FPT_CLOSE_SI.V.TYPE#
      6983**DCL      6983--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6980**DCL      6980--REDEF    6982--REDEF
FPT_CLOSE_STD
      6928**DCL      8498<>CALL
FPT_CLOSE_STD.SN_
      6928**DCL      6928--REDEF
FPT_CLOSE_STD.UTL_
      6929**DCL      6929--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6943**DCL      6943--REDEF
FPT_CLOSE_STD.V.TYPE#
      6941**DCL      6941--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6938**DCL      6938--REDEF    6940--REDEF
FPT_CLSEI_FT.SN_
      6844**DCL      6844--REDEF
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:23   
FPT_CLSEI_FT.UTL_
      6845**DCL      6845--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6859**DCL      6859--REDEF
FPT_CLSEI_FT.V.TYPE#
      6857**DCL      6857--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6854**DCL      6854--REDEF    6856--REDEF
FPT_OPEN_EI.ACSVEH_
      6415**DCL      6416--REDEF
FPT_OPEN_EI.ALTKEYS_
      6421**DCL      6422--REDEF    6422--REDEF
FPT_OPEN_EI.HDR_
      6420**DCL      6421--REDEF
FPT_OPEN_EI.TAB_
      6419**DCL      6420--REDEF
FPT_OPEN_EI.UHL_
      6413**DCL      6414--REDEF    6414--REDEF
FPT_OPEN_EI.V.FSN#
      6453**DCL      6453--REDEF    6453--REDEF
FPT_OPEN_EI.WSN_
      6419**DCL      6419--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6524**DCL      6525--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6530**DCL      6531--REDEF    6531--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6529**DCL      6530--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6528**DCL      6529--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6522**DCL      6523--REDEF    6523--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6562**DCL      6562--REDEF    6562--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6528**DCL      6528--REDEF
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:24   
FPT_OPEN_OUT.ACSVEH_
      6306**DCL      6307--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6312**DCL      6313--REDEF    6313--REDEF
FPT_OPEN_OUT.HDR_
      6311**DCL      6312--REDEF
FPT_OPEN_OUT.TAB_
      6310**DCL      6311--REDEF
FPT_OPEN_OUT.UHL_
      6304**DCL      6305--REDEF    6305--REDEF
FPT_OPEN_OUT.V.FSN#
      6344**DCL      6344--REDEF    6344--REDEF
FPT_OPEN_OUT.WSN_
      6310**DCL      6310--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6197**DCL      6198--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6203**DCL      6204--REDEF    6204--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6202**DCL      6203--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6201**DCL      6202--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6195**DCL      6196--REDEF    6196--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6235**DCL      6235--REDEF    6235--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6201**DCL      6201--REDEF
FPT_READ_STD
      6622**DCL      8477<>CALL
FPT_READ_STD.STATION_
      6625**DCL      6626--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6637**DCL      6637--REDEF
FPT_READ_STD.V.INDX#
      6635**DCL      6635--REDEF
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:25   
FPT_READ_UC.STATION_
      6586**DCL      6587--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6598**DCL      6598--REDEF
FPT_READ_UC.V.INDX#
      6596**DCL      6596--REDEF
FPT_WRITE_ME.STATION_
      6694**DCL      6694--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6701**DCL      6701--REDEF
FPT_WRITE_OUT.STATION_
      6725**DCL      6725--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6732**DCL      6732--REDEF
FPT_WRITE_UC.STATION_
      6663**DCL      6663--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6670**DCL      6670--REDEF
FROM_SN.SN
      5569**DCL      5570--REDEF
GETCMD.OUT$
      4776**DCL      4782--REDEF
ICB.FID.STRING
      5593**DCL      5594--REDEF
IDX
      8243**DCL      8462<<DOINDEX  8463>>ASSIGN
IFSFA_PARAM.EOMCHAR#
      5948**DCL      5949--REDEF
IFSFA_PARAM.SIG1
      5942**DCL      5942--REDEF
IFSFA_PARAM.SIG2
      5942**DCL      5943--REDEF
IN_RES
      5515**DCL      5515--REDEF
IN_SN.SN
      5531**DCL      5532--REDEF
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:26   
M$CLOSE
        33**DCL-ENT  8498--CALL
M$READ
        34**DCL-ENT  8477--CALL
M$STD1$
      5987**DCL      8478>>ASSIGN   8496>>IF
NEXT_SPEC_RET_VAL
      8241**DCL      8482<>CALL     8483>>DOWHILE  8484>>IF       8488<>CALL
OCB.TYPE
      5277**DCL      5278--REDEF
OFSFA_PARAM.EOMCHAR#
      5978**DCL      5979--REDEF
OFSFA_PARAM.SIG1
      5972**DCL      5972--REDEF
OFSFA_PARAM.SIG2
      5972**DCL      5973--REDEF
OUT$BLK.CODE
      8207**DCL      8464>>DOCASE
OUT$BLK.NSUBLKS
      8211**DCL      8462>>DOINDEX
OUT$BLK.SUBLK$
      8232**DCL      8463>>ASSIGN   8468<>CALL
OUT_SN.SN
      5549**DCL      5550--REDEF
PCB
      4577**DCL      8479<>CALL
PCB.ERROR
      4681**DCL      8507<>CALL
PCB.NCHARS
      4724**DCL      8478<<ASSIGN
PCB.OUT$
      4590**DCL      8462>>DOINDEX  8463>>ASSIGN   8480>>ASSIGN
PTR$
      8245**DCL      8463<<ASSIGN   8464>>DOCASE   8466>>ASSIGN   8468>>CALL     8470<>CALL
SOURCELIST$
      8244**DCL      8461<<ASSIGN   8466<<ASSIGN   8480<<ASSIGN   8482<>CALL
PL6.E3A0      #001=VPI$DELETE File=VPI$DELETE.:E05TSI                            WED 07/30/97 07:46 Page:27   
SPEC_BUF
      5227**DCL      5227--REDEF
STD_PARSE_ALT
      8507**LABEL    8479--CALLALT
STD_READ_ALT
      8501**LABEL    8477--CALLALT
VPD$COUNTER_PRINT
      8282**DCL-ENT  8495--CALL
VPD$FINISH_NLIST
      8293**DCL-ENT  8494--CALL
VPD$INIT_STD_FILE
      8319**DCL-ENT  8470--CALL
VPF$GET_NEXT_SPEC
      8361**DCL-ENT  8482--CALL     8488--CALL
VPF$SET_FROM_INFO
      8370**DCL-ENT  8468--CALL
VPI$DELETE_SPEC
      8392**DCL-ENT  8486--CALL
VPL$ERR_PROC
      8432**DCL-ENT  8505--CALL     8507--CALL     8508--CALL
X$PARSE
      8249**DCL-ENT  8479--CALL

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:28   
       95        1        /*T***********************************************************/
       96        2        /*T*                                                         */
       97        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       98        4        /*T*                                                         */
       99        5        /*T***********************************************************/
      100        6        VPI$DELETE_SPEC: PROC;
      101        7        /*I* NAME: VPI$DELETE_SPEC
      102        8             PURPOSE: To delete the files specified by the current input spec.
      103        9             CALL: CALL VPI$DELETE_SPEC;
      104       10             DESCRIPTION: This routine is used by DELETE to
      105       11                          delete the files in the current input spec.
      106       12        */
      107       13        %INCLUDE VP_DATA_R;
      108     7000        %INCLUDE F$DCB;
      109     7049        /**/
      110     7050        /*  LOCAL AUTO  */
      111     7051        /**/
      112     7052    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
      113     7053    1   DCL RET_VAL SBIN WORD;
      114     7054    1   DCL CHECK_RANGE BIT(1) STATIC;
      115     7055    1   DCL SAVE_TEST BIT(1) STATIC;
      116     7056        /**/
      117     7057        /*  ENTRY DCLS  */
      118     7058        /**/
      119     7059        %VP_ENTRIES (OMIT=VPI$DELETE_SPEC);
      120     7267        /**/
      121     7268    1           CHECK_RANGE = '1'B;             /* We have to check range (later)     */
      122     7269    1           REMEMBER NEXT_FILE IN ABORT_STEP;
      123     7270    1           CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,2);
      124     7271    2           DO WHILE(OPEN_NEXT_RET_VAL~=%VPOC_EXHAUSTED#);
      125     7272    2              IF BREAKS>0
      126     7273    2               THEN
      127     7274    2                 UNWIND TO ABORT_CMD;
      128     7275    2              IF CHECK_RANGE
      129     7276    2               THEN                        /* It's time to check the range       */
      130     7277    3               DO;
      131     7278    3                  CALL RANGE_OK(RET_VAL);
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:29   
      132     7279    3                  IF RET_VAL=0
      133     7280    3                   THEN                    /* He changed his mind                */
      134     7281    4                   DO;
      135     7282    4                      ERR_FLG = '1'B;
      136     7283    4                      GOTO DEL_DONE;
      137     7284    4                      END;
      138     7285    3                  CHECK_RANGE = '0'B;      /* Don't check range again            */
      139     7286    3                  END;
      140     7287    2              SAVE_TEST = FPT_OPEN_EI.V.OPER.TEST#;
      141     7288    2              FPT_OPEN_EI = FPT_OPEN_EI_SAVE;
      142     7289    2              FPT_OPEN_EI.V.OPER.TEST# = %NO#;
      143     7290    2              FPT_OPEN_EI.V.DELETE# = %YES#;
      144     7291    2              FPT_OPEN_EI.FPARAM_ = VECTOR(FPARAM_BUF);
      145     7292    2              CALL M$OPEN(FPT_OPEN_EI) ALTRET(DEL_ALTRET);
      146     7293    2              FPT_OPEN_EI.V.OPER.TEST# = SAVE_TEST;
      147     7294    2              CALL VPD$OUT_NAMES(DIN_NAME,0);
      148     7295    2              CALL VPD$COUNTER_BUMP(1);
      149     7296    2              THIS_STD_FILE = '0'B;
      150     7297    2   NEXT_FILE: CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);
      151     7298    2              END;
      152     7299    1           IF CHECK_RANGE                  /* IF we haven't asked for confirm    */
      153     7300    1             AND ICB.SPEC_TYPE > 1 AND ICB.SPEC_TYPE < 7 /* And multi file spec  */
      154     7301    1            THEN                           /* The spec was empty                 */
      155     7302    2            DO;
      156     7303    2               ERR_FLG = '1'B;
      157     7304    2               CALL VPD$GET_SPEC_BUF(0,0);
      158     7305    2               CALL VPL$ERR_PROC(1,30,'11'O,,VECTOR(SPEC_BUF));
      159     7306        /*E*   ERROR: VPI-00030
      160     7307             MESSAGE: There were no files to DELete in %U1
      161     7308        */
      162     7309    2               END;
      163     7310
      164     7311    1   DEL_DONE: RETURN;
      165     7312
      166     7313    1   DEL_ALTRET: FPT_OPEN_EI.V.OPER.TEST# = SAVE_TEST;
      167     7314    1           CALL VPL$ERR_PROC(2,0);         /* Report and abort step              */
      168     7315        %EJECT;
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:30   
      169     7316    1   RANGE_OK: PROC(RET_VAL);
      170     7317        /*I* NAME: RANGE_OK
      171     7318             PURPOSE: To verify that the online user wants to delete a specified range.
      172     7319             CALL: CALL RANGE_OK(RET_VAL);
      173     7320             DESCRIPTION: This procedure returns RET_VAL=0 meaning don't delete specified
      174     7321                          range only if 1) the request came from a terminal (IC)
      175     7322                                        2) a range was specified,
      176     7323                                    and 3) the user did not reply YES$ to the confirmation
      177     7324                                           message.
      178     7325        */
      179     7326        /**/
      180     7327        /*  PARAMETERS  */
      181     7328        /**/
      182     7329    2   DCL RET_VAL SBIN WORD;
      183     7330        /**/
      184     7331        /*  INCLUDE FILES  */
      185     7332        /**/
      186     7333 S      %INCLUDE B$JIT_C;
      187     7334        %B$JIT0;
      188     7423        %U$JIT1;
      189     7497    2         2 * BIT(1);
      190     7498        /**/
      191     7499        /*  LOCAL AUTO  */
      192     7500        /**/
      193     7501    2   DCL BUF_SIZE SBIN WORD;
      194     7502    2   DCL PTR$ PTR;
      195     7503    2   DCL I SBIN WORD;
      196     7504    2   DCL WRITE_ME_BUF CHAR(140);
      197     7505        /**/
      198     7506        /*  BASED DATA  */
      199     7507        /**/
      200     7508    2   DCL 1 TYPE$BUF BASED,
      201     7509    2         2 COMMA CHAR(1),
      202     7510    2         2 STRING CHAR(4);
      203     7511    2   DCL CHAR$12 CHAR(12) BASED;
      204     7512        /**/
      205     7513        /*  CONSTANT  */
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:31   
      206     7514        /**/
      207     7515    2   DCL 1 DATE_TYPE (0:6) CHAR(8) CONSTANT INIT( 'error',
      208     7516    2   'created','accessed','modified','expired', /* Types of file sel. dates        */
      209     7517    2   'backup','stowed');
      210     7518    2   DCL 1 DATE_REL (0:6) CHAR(2) CONSTANT INIT('XX',
      211     7519    2         '<','=','>','<=','~=','>=');      /* File selection relations           */
      212     7520    2   DCL 1 ORG_TEXTC_TBL(0:19) CONSTANT,
      213     7521    2         2 LEN UBIN BYTE UNAL INIT(0,
      214     7522    2           12,6,7,12,9,
      215     7523    2           8,4,9,8,5,
      216     7524    2           9,5*3,6,
      217     7525    2           9,10,9,5),
      218     7526    2         2 STRING CHAR(12) INIT(' ',
      219     7527    2           'consecutive,','keyed,','random,','unit record,','relative,',
      220     7528    2           'indexed,','IDS,','terminal,','symbiont,','FPRG,',
      221     7529    2           'comgroup,','BUG!,'*3,'fixed,',
      222     7530    2           'variable,','undefined,','restrict,','free,');
      223     7531        /**/
      224     7532    2           RET_VAL = 1;
      225     7533    2           IF (ICB.SPEC_TYPE>1 AND ICB.SPEC_TYPE<7) /* RANGE or WILD spec        */
      226     7534    2             AND NOT CMD_MASK(7)           /* AND NOT DELETESTD                  */
      227     7535    2             AND (M$SI$->F$DCB.DDEV.IC     /* INPUT FROM TERMINAL                */
      228     7536    2             OR (ONE_TIME=1 AND B$JIT.MODE=%M_INT# /* OR INTERACTIVE ONE-SHOT    */
      229     7537    2             AND NOT (B$JIT.CPFLAGS1 & %CP_CFREAD#))) /* not from CMD FILE       */
      230     7538    2            THEN                           /* We have to get confirmation        */
      231     7539    3            DO;
      232     7540    3               CALL VPD$GET_SPEC_BUF(0,0);
      233     7541    3               FPT_WRITE_UC.V.DVBYTE.VFC# = %YES#;
      234     7542    3               FPT_WRITE_UC.BUF_ = VECTOR(WRITE_ME_BUF);
      235     7543    3               CALL VPD$FINISH_NLIST;      /* Finish dangling name list          */
      236     7544    3               CALL CONCAT(WRITE_ME_BUF,
      237     7545    3                 '@Delete ',
      238     7546    3                 SPEC_BUF.STRING);
      239     7547    3               FPT_WRITE_UC.BUF_.BOUND = SPEC_BUF.LEN+7;
      240     7548    3               CALL M$WRITE(FPT_WRITE_UC);
      241     7549    3               IF ICB.TYPE.COUNT>0
      242     7550    3                THEN
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:32   
      243     7551    4                DO;                        /* FORMAT TYPE MESSAGE                */
      244     7552    4                   CALL CONCAT(WRITE_ME_BUF,
      245     7553    4                     'aof TYPE = ','''',
      246     7554    4                     ICB.TYPE.STRING(0),'''');
      247     7555    4                   BUF_SIZE = 15;
      248     7556    5                   DO I=1 TO ICB.TYPE.COUNT-1;
      249     7557    5                      PTR$ = PINCRC(ADDR(WRITE_ME_BUF),BUF_SIZE);
      250     7558    5                      PTR$->TYPE$BUF.COMMA = ',';
      251     7559    5                      CALL CONCAT(PTR$->TYPE$BUF.STRING,'''',ICB.TYPE.STRING(I),'''');
      252     7560    5                      BUF_SIZE = BUF_SIZE+5;
      253     7561    5                      END;
      254     7562    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE-1;
      255     7563    4                   CALL M$WRITE(FPT_WRITE_UC);
      256     7564    4                   END;
      257     7565    3               IF ICB.DATE.RELATION~=0
      258     7566    3                THEN
      259     7567    4                DO;                        /* Format DATE message                */
      260     7568    4                   IF ICB.TYPE.COUNT=0
      261     7569    4                    THEN
      262     7570    5                    DO;
      263     7571    5                       WRITE_ME_BUF = 'aof ';
      264     7572    5                       BUF_SIZE = 4;
      265     7573    5                       END;
      266     7574    4                    ELSE
      267     7575    5                    DO;
      268     7576    5                       WRITE_ME_BUF = 'aand of ';
      269     7577    5                       BUF_SIZE = 8;
      270     7578    5                       END;
      271     7579    4                   CALL INSERT(WRITE_ME_BUF,BUF_SIZE,,
      272     7580    4                     DATE_TYPE(ICB.DATE.TYPE),
      273     7581    4                     ' DATE ',
      274     7582    4                     DATE_REL(ICB.DATE.RELATION),
      275     7583    4                     ' ',ICB.DATE.TEXT);
      276     7584    4                   BUF_SIZE = BUF_SIZE +27;
      277     7585    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE -1;
      278     7586    4                   CALL M$WRITE(FPT_WRITE_UC);
      279     7587    4                   END;
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:33   
      280     7588    3               IF ICB.CREATOR_SEL ~= 0
      281     7589    3                THEN
      282     7590    4                DO;                        /* Format CREATOR message             */
      283     7591    4                   CALL CONCAT(WRITE_ME_BUF,'acreated by ',
      284     7592    4                     ICB.CREATOR.TEXT);
      285     7593    4                   BUF_SIZE = 12 + ICB.CREATOR.C;
      286     7594    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE -1;
      287     7595    4                   CALL M$WRITE(FPT_WRITE_UC);
      288     7596    4                   END;
      289     7597    3               IF ICB.ORG~='0'B
      290     7598    3                THEN
      291     7599    4                DO;                        /* FORMAT ORG MESSAGE                 */
      292     7600    4                   IF ICB.TYPE.COUNT=0 AND ICB.DATE.RELATION=0
      293     7601    4                    THEN
      294     7602    5                    DO;
      295     7603    5                       WRITE_ME_BUF = 'aof ORGANIZATION = ';
      296     7604    5                       BUF_SIZE = 19;
      297     7605    5                       END;
      298     7606    4                    ELSE
      299     7607    5                    DO;
      300     7608    5                       WRITE_ME_BUF = 'aand of ORGANIZATION = ';
      301     7609    5                       BUF_SIZE = 23;
      302     7610    5                       END;
      303     7611    5                   DO I=0 TO 19;
      304     7612    5                      IF ICB.ORG(I)
      305     7613    5                       THEN
      306     7614    6                       DO;
      307     7615    6                          PTR$ = PINCRC(ADDR(WRITE_ME_BUF),BUF_SIZE);
      308     7616    6                          PTR$->CHAR$12 = ORG_TEXTC_TBL.STRING(I);
      309     7617    6                          BUF_SIZE = BUF_SIZE+ORG_TEXTC_TBL.LEN(I);
      310     7618    6                          END;
      311     7619    5                      END;
      312     7620    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE-2;
      313     7621    4                   CALL M$WRITE(FPT_WRITE_UC);
      314     7622    4                   END;
      315     7623    3               FPT_READ_UC.BUF_ = VECTOR(PARSE_IN_BUF);
      316     7624    3               PARSE_IN_BUF = ' ';
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:34   
      317     7625    3               CALL M$READ(FPT_READ_UC) ALTRET(IGNORE);
      318     7626    3   IGNORE:
      319     7627    3               IF PARSE_IN_BUF ~= 'YES$' AND PARSE_IN_BUF ~= 'yes$' AND PARSE_IN_BUF ~=
              7627                        'Yes$'
      320     7628    3                THEN
      321     7629    4                DO;
      322     7630    4                   RET_VAL = 0;
      323     7631    4                   CALL CONCAT(WRITE_ME_BUF,'ADeletion of ',
      324     7632    4                     SUBSTR(SPEC_BUF.STRING,0,SPEC_BUF.LEN),' canceled.');
      325     7633    4                   FPT_WRITE_UC.BUF_.BOUND = SPEC_BUF.LEN + 22;
      326     7634    4                   CALL M$WRITE(FPT_WRITE_UC);
      327     7635    4                   END;
      328     7636    3               FPT_WRITE_UC.V.DVBYTE.VFC# = %NO#;
      329     7637    3               END;
      330     7638    2   END RANGE_OK;
      331     7639    1   END VPI$DELETE_SPEC;

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:35   
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPI$DELETE_SPEC.

   Procedure VPI$DELETE_SPEC requires 417 words for executable code.
   Procedure VPI$DELETE_SPEC requires 52 words of local(AUTO) storage.

    No errors detected in file VPI$DELETE.:E05TSI    .

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:36   

 Object Unit name= VPI$DELETE_SPEC                            File name= VPI$DELETE.:E05TOU
 UTS= JUL 30 '97 07:48:08.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none     2      2  VPI$DELETE_SPEC
   11  RoData even  UTS    117    165  VPI$DELETE_SPEC
   12   Proc  even  none   417    641  VPI$DELETE_SPEC
   13  RoData even  none    25     31  VPI$DELETE_SPEC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        0  VPI$DELETE_SPEC
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:37   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 VPF$OPEN_NEXT
         yes           Std       1 VPD$COUNTER_BUMP
         yes           Std       8 VPL$ERR_PROC
         yes           Std       2 VPD$OUT_NAMES
         yes           Std       2 VPD$GET_SPEC_BUF
         yes           Std       2 VPD$FINISH_NLIST
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PARSE_IN_BUF                          ERR_FLG
     ABORT_STEP                            ABORT_CMD                             THIS_STD_FILE
     BREAK_LOC                             BREAKS                                BREAK_MESSAGE_REPORTER
     FPARAM_BUF                            CMD_MASK                              SPEC_BUF
     ONE_TIME                              DIN_NAME                              IN_RES
     ICB                                   M$EI                                  M$EO
     M$EO1                                 M$ME                                  M$SI
     M$SI$                                 M$READFILE                            M$DO
     M$STD1                                M$SORT1                               B$JIT$
     FPT_OPEN_EI                           FPT_OPEN_EI_SAVE                      FPT_READ_UC
     FPT_WRITE_UC                          B_VECTNIL
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:38   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:39   


       95        1        /*T***********************************************************/
       96        2        /*T*                                                         */
       97        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       98        4        /*T*                                                         */
       99        5        /*T***********************************************************/
      100        6        VPI$DELETE_SPEC: PROC;

      6 12 000000   000000 700200 xent  VPI$DELETE_* TSX0  ! X66_AUTO_0
        12 000001   000064 000000                    ZERO    52,0

      101        7        /*I* NAME: VPI$DELETE_SPEC
      102        8             PURPOSE: To delete the files specified by the current input spec.
      103        9             CALL: CALL VPI$DELETE_SPEC;
      104       10             DESCRIPTION: This routine is used by DELETE to
      105       11                          delete the files in the current input spec.
      106       12        */
      107       13        %INCLUDE VP_DATA_R;
      108     7000        %INCLUDE F$DCB;
      109     7049        /**/
      110     7050        /*  LOCAL AUTO  */
      111     7051        /**/
      112     7052    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
      113     7053    1   DCL RET_VAL SBIN WORD;
      114     7054    1   DCL CHECK_RANGE BIT(1) STATIC;
      115     7055    1   DCL SAVE_TEST BIT(1) STATIC;
      116     7056        /**/
      117     7057        /*  ENTRY DCLS  */
      118     7058        /**/
      119     7059        %VP_ENTRIES (OMIT=VPI$DELETE_SPEC);
      120     7267        /**/
      121     7268    1           CHECK_RANGE = '1'B;             /* We have to check range (later)     */

   7268 12 000002   400000 236003                    LDQ     -131072,DU
        12 000003   000000 756000 10                 STQ     CHECK_RANGE

      122     7269    1           REMEMBER NEXT_FILE IN ABORT_STEP;
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:40   

   7269 12 000004   000102 635000 12                 EAA     NEXT_FILE
        12 000005   000000 452400 xsym               STP2    ABORT_STEP
        12 000006   000001 755000 xsym               STA     ABORT_STEP+1

      123     7270    1           CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,2);

   7270 12 000007   000000 236000 13                 LDQ     0
        12 000010   200057 756100                    STQ     WRITE_ME_BUF+36,,AUTO
        12 000011   200003 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        12 000012   200056 450500                    STP0    WRITE_ME_BUF+35,,AUTO
        12 000013   200056 630500                    EPPR0   WRITE_ME_BUF+35,,AUTO
        12 000014   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000015   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        12 000016   000000 011000                    NOP     0

      124     7271    2           DO WHILE(OPEN_NEXT_RET_VAL~=%VPOC_EXHAUSTED#);

   7271 12 000017   200003 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        12 000020   000001 115007                    CMPA    1,DL
        12 000021   000115 600000 12                 TZE     s:7299

      125     7272    2              IF BREAKS>0

   7272 12 000022   000000 235000 xsym               LDA     BREAKS
        12 000023   000027 604400 12                 TMOZ    s:7275

      126     7273    2               THEN
      127     7274    2                 UNWIND TO ABORT_CMD;

   7274 12 000024   000000 237200 xsym               LDAQ  ! ABORT_CMD
        12 000025   000000 700200 xent               TSX0  ! X66_AUNWIND
        12 000026   000000 000200                    ZERO    0,128

      128     7275    2              IF CHECK_RANGE

   7275 12 000027   000000 234000 10                 SZN     CHECK_RANGE
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:41   
        12 000030   000043 605000 12                 TPL     s:7287

      129     7276    2               THEN                        /* It's time to check the range       */
      130     7277    3               DO;

      131     7278    3                  CALL RANGE_OK(RET_VAL);

   7278 12 000031   200004 630500                    EPPR0   RET_VAL,,AUTO
        12 000032   200007 450500                    STP0    RET_VAL+3,,AUTO
        12 000033   000160 701000 12                 TSX1    RANGE_OK
        12 000034   000000 011000                    NOP     0

      132     7279    3                  IF RET_VAL=0

   7279 12 000035   200004 235100                    LDA     RET_VAL,,AUTO
        12 000036   000042 601000 12                 TNZ     s:7285

      133     7280    3                   THEN                    /* He changed his mind                */
      134     7281    4                   DO;

      135     7282    4                      ERR_FLG = '1'B;

   7282 12 000037   400000 236003                    LDQ     -131072,DU
        12 000040   000000 756000 xsym               STQ     ERR_FLG

      136     7283    4                      GOTO DEL_DONE;

   7283 12 000041   000145 710000 12                 TRA     DEL_DONE

      137     7284    4                      END;
      138     7285    3                  CHECK_RANGE = '0'B;      /* Don't check range again            */

   7285 12 000042   000000 450000 10                 STZ     CHECK_RANGE

      139     7286    3                  END;

      140     7287    2              SAVE_TEST = FPT_OPEN_EI.V.OPER.TEST#;
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:42   

   7287 12 000043   000044 236000 xsym               LDQ     FPT_OPEN_EI+36
        12 000044   000026 736000                    QLS     22
        12 000045   400000 376003                    ANQ     -131072,DU
        12 000046   000001 756000 10                 STQ     SAVE_TEST

      141     7288    2              FPT_OPEN_EI = FPT_OPEN_EI_SAVE;

   7288 12 000047   000000 100400                    MLR     fill='000'O
        12 000050   000000 000350 xsym               ADSC9   FPT_OPEN_EI_SAVE         cn=0,n=232
        12 000051   000000 000350 xsym               ADSC9   FPT_OPEN_EI              cn=0,n=232

      142     7289    2              FPT_OPEN_EI.V.OPER.TEST# = %NO#;

   7289 12 000052   000001 236000 13                 LDQ     1
        12 000053   000044 356000 xsym               ANSQ    FPT_OPEN_EI+36

      143     7290    2              FPT_OPEN_EI.V.DELETE# = %YES#;

   7290 12 000054   040000 236007                    LDQ     16384,DL
        12 000055   000044 256000 xsym               ORSQ    FPT_OPEN_EI+36

      144     7291    2              FPT_OPEN_EI.FPARAM_ = VECTOR(FPARAM_BUF);

   7291 12 000056   000002 237000 13                 LDAQ    2
        12 000057   000030 757000 xsym               STAQ    FPT_OPEN_EI+24

      145     7292    2              CALL M$OPEN(FPT_OPEN_EI) ALTRET(DEL_ALTRET);

   7292 12 000060   000000 630400 xsym               EPPR0   FPT_OPEN_EI
        12 000061   450000 713400                    CLIMB   alt,open
        12 000062   410400 401760                    pmme    nvectors=18
        12 000063   000146 702000 12                 TSX2    DEL_ALTRET

      146     7293    2              FPT_OPEN_EI.V.OPER.TEST# = SAVE_TEST;

   7293 12 000064   000001 236000 10                 LDQ     SAVE_TEST
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:43   
        12 000065   000026 772000                    QRL     22
        12 000066   000044 676000 xsym               ERQ     FPT_OPEN_EI+36
        12 000067   020000 376007                    ANQ     8192,DL
        12 000070   000044 656000 xsym               ERSQ    FPT_OPEN_EI+36

      147     7294    2              CALL VPD$OUT_NAMES(DIN_NAME,0);

   7294 12 000071   000004 630400 13                 EPPR0   4
        12 000072   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000073   000000 701000 xent               TSX1    VPD$OUT_NAMES
        12 000074   000000 011000                    NOP     0

      148     7295    2              CALL VPD$COUNTER_BUMP(1);

   7295 12 000075   000006 630400 13                 EPPR0   6
        12 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000077   000000 701000 xent               TSX1    VPD$COUNTER_BUMP
        12 000100   000000 011000                    NOP     0

      149     7296    2              THIS_STD_FILE = '0'B;

   7296 12 000101   000000 450000 xsym               STZ     THIS_STD_FILE

      150     7297    2   NEXT_FILE: CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);

   7297 12 000102   000006 236000 13    NEXT_FILE    LDQ     6
        12 000103   200057 756100                    STQ     WRITE_ME_BUF+36,,AUTO
        12 000104   200003 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        12 000105   200056 450500                    STP0    WRITE_ME_BUF+35,,AUTO
        12 000106   200056 630500                    EPPR0   WRITE_ME_BUF+35,,AUTO
        12 000107   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000110   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        12 000111   000000 011000                    NOP     0

      151     7298    2              END;

   7298 12 000112   200003 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:44   
        12 000113   000001 115007                    CMPA    1,DL
        12 000114   000022 601000 12                 TNZ     s:7272

      152     7299    1           IF CHECK_RANGE                  /* IF we haven't asked for confirm    */

   7299 12 000115   000000 234000 10                 SZN     CHECK_RANGE
        12 000116   000145 605000 12                 TPL     DEL_DONE
        12 000117   000017 236000 xsym               LDQ     ICB+15
        12 000120   000001 116007                    CMPQ    1,DL
        12 000121   000145 604400 12                 TMOZ    DEL_DONE
        12 000122   000007 116007                    CMPQ    7,DL
        12 000123   000145 605000 12                 TPL     DEL_DONE

      153     7300    1             AND ICB.SPEC_TYPE > 1 AND ICB.SPEC_TYPE < 7 /* And multi file spec  */
      154     7301    1            THEN                           /* The spec was empty                 */
      155     7302    2            DO;

      156     7303    2               ERR_FLG = '1'B;

   7303 12 000124   400000 236003                    LDQ     -131072,DU
        12 000125   000000 756000 xsym               STQ     ERR_FLG

      157     7304    2               CALL VPD$GET_SPEC_BUF(0,0);

   7304 12 000126   000007 630400 13                 EPPR0   7
        12 000127   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000130   000000 701000 xent               TSX1    VPD$GET_SPEC_BUF
        12 000131   000000 011000                    NOP     0

      158     7305    2               CALL VPL$ERR_PROC(1,30,'11'O,,VECTOR(SPEC_BUF));

   7305 12 000132   000016 236000 13                 LDQ     14
        12 000133   200062 756100                    STQ     WRITE_ME_BUF+39,,AUTO
        12 000134   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 000135   000017 235000 13                 LDA     15
        12 000136   200060 757100                    STAQ    WRITE_ME_BUF+37,,AUTO
        12 000137   000020 237000 13                 LDAQ    16
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:45   
        12 000140   200056 757100                    STAQ    WRITE_ME_BUF+35,,AUTO
        12 000141   200056 630500                    EPPR0   WRITE_ME_BUF+35,,AUTO
        12 000142   000023 631400 xsym               EPPR1   B_VECTNIL+19
        12 000143   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000144   000000 011000                    NOP     0

      159     7306        /*E*   ERROR: VPI-00030
      160     7307             MESSAGE: There were no files to DELete in %U1
      161     7308        */
      162     7309    2               END;

      163     7310
      164     7311    1   DEL_DONE: RETURN;

   7311 12 000145   000000 702200 xent  DEL_DONE     TSX2  ! X66_ARET

      165     7312
      166     7313    1   DEL_ALTRET: FPT_OPEN_EI.V.OPER.TEST# = SAVE_TEST;

   7313 12 000146   000001 236000 10    DEL_ALTRET   LDQ     SAVE_TEST
        12 000147   000026 772000                    QRL     22
        12 000150   000044 676000 xsym               ERQ     FPT_OPEN_EI+36
        12 000151   020000 376007                    ANQ     8192,DL
        12 000152   000044 656000 xsym               ERSQ    FPT_OPEN_EI+36

      167     7314    1           CALL VPL$ERR_PROC(2,0);         /* Report and abort step              */

   7314 12 000153   000022 630400 13                 EPPR0   18
        12 000154   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000155   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000156   000000 011000                    NOP     0
        12 000157   000640 710000 12                 TRA     s:7639

      168     7315        %EJECT;
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:46   
      169     7316    1   RANGE_OK: PROC(RET_VAL);

   7316 12 000160   200006 741300       RANGE_OK     STX1  ! RET_VAL+2,,AUTO

      170     7317        /*I* NAME: RANGE_OK
      171     7318             PURPOSE: To verify that the online user wants to delete a specified range.
      172     7319             CALL: CALL RANGE_OK(RET_VAL);
      173     7320             DESCRIPTION: This procedure returns RET_VAL=0 meaning don't delete specified
      174     7321                          range only if 1) the request came from a terminal (IC)
      175     7322                                        2) a range was specified,
      176     7323                                    and 3) the user did not reply YES$ to the confirmation
      177     7324                                           message.
      178     7325        */
      179     7326        /**/
      180     7327        /*  PARAMETERS  */
      181     7328        /**/
      182     7329    2   DCL RET_VAL SBIN WORD;
      183     7330        /**/
      184     7331        /*  INCLUDE FILES  */
      185     7332        /**/
      186     7333 S      %INCLUDE B$JIT_C;
      187     7334        %B$JIT0;
      188     7423        %U$JIT1;
      189     7497    2         2 * BIT(1);
      190     7498        /**/
      191     7499        /*  LOCAL AUTO  */
      192     7500        /**/
      193     7501    2   DCL BUF_SIZE SBIN WORD;
      194     7502    2   DCL PTR$ PTR;
      195     7503    2   DCL I SBIN WORD;
      196     7504    2   DCL WRITE_ME_BUF CHAR(140);
      197     7505        /**/
      198     7506        /*  BASED DATA  */
      199     7507        /**/
      200     7508    2   DCL 1 TYPE$BUF BASED,
      201     7509    2         2 COMMA CHAR(1),
      202     7510    2         2 STRING CHAR(4);
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:47   
      203     7511    2   DCL CHAR$12 CHAR(12) BASED;
      204     7512        /**/
      205     7513        /*  CONSTANT  */
      206     7514        /**/
      207     7515    2   DCL 1 DATE_TYPE (0:6) CHAR(8) CONSTANT INIT( 'error',
      208     7516    2   'created','accessed','modified','expired', /* Types of file sel. dates        */
      209     7517    2   'backup','stowed');
      210     7518    2   DCL 1 DATE_REL (0:6) CHAR(2) CONSTANT INIT('XX',
      211     7519    2         '<','=','>','<=','~=','>=');      /* File selection relations           */
      212     7520    2   DCL 1 ORG_TEXTC_TBL(0:19) CONSTANT,
      213     7521    2         2 LEN UBIN BYTE UNAL INIT(0,
      214     7522    2           12,6,7,12,9,
      215     7523    2           8,4,9,8,5,
      216     7524    2           9,5*3,6,
      217     7525    2           9,10,9,5),
      218     7526    2         2 STRING CHAR(12) INIT(' ',
      219     7527    2           'consecutive,','keyed,','random,','unit record,','relative,',
      220     7528    2           'indexed,','IDS,','terminal,','symbiont,','FPRG,',
      221     7529    2           'comgroup,','BUG!,'*3,'fixed,',
      222     7530    2           'variable,','undefined,','restrict,','free,');
      223     7531        /**/
      224     7532    2           RET_VAL = 1;

   7532 12 000161   000001 235007                    LDA     1,DL
        12 000162   200007 470500                    LDP0    @RET_VAL,,AUTO
        12 000163   000000 755100                    STA     0,,PR0

      225     7533    2           IF (ICB.SPEC_TYPE>1 AND ICB.SPEC_TYPE<7) /* RANGE or WILD spec        */

   7533 12 000164   000017 236000 xsym               LDQ     ICB+15
        12 000165   000001 116007                    CMPQ    1,DL
        12 000166   000636 604400 12                 TMOZ    s:7638
        12 000167   000007 116007                    CMPQ    7,DL
        12 000170   000636 605000 12                 TPL     s:7638
        12 000171   000000 236000 xsym               LDQ     CMD_MASK
        12 000172   002000 316003                    CANQ    1024,DU
        12 000173   000636 601000 12                 TNZ     s:7638
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:48   
        12 000174   000000 471400 xsym               LDP1    M$SI$
        12 000175   100004 236100                    LDQ     4,,PR1
        12 000176   100000 316007                    CANQ    32768,DL
        12 000177   000213 601000 12                 TNZ     s:7540
        12 000200   000000 235000 xsym               LDA     ONE_TIME
        12 000201   000001 115007                    CMPA    1,DL
        12 000202   000636 601000 12                 TNZ     s:7638
        12 000203   000000 473400 xsym               LDP3    B$JIT$
        12 000204   300000 236100                    LDQ     0,,PR3
        12 000205   740000 376003                    ANQ     -16384,DU
        12 000206   140000 116003                    CMPQ    49152,DU
        12 000207   000636 601000 12                 TNZ     s:7638
        12 000210   300143 236100                    LDQ     99,,PR3
        12 000211   000123 376000 11                 ANQ     ORG_TEXTC_TBL+65
        12 000212   000636 601000 12                 TNZ     s:7638

      226     7534    2             AND NOT CMD_MASK(7)           /* AND NOT DELETESTD                  */
      227     7535    2             AND (M$SI$->F$DCB.DDEV.IC     /* INPUT FROM TERMINAL                */
      228     7536    2             OR (ONE_TIME=1 AND B$JIT.MODE=%M_INT# /* OR INTERACTIVE ONE-SHOT    */
      229     7537    2             AND NOT (B$JIT.CPFLAGS1 & %CP_CFREAD#))) /* not from CMD FILE       */
      230     7538    2            THEN                           /* We have to get confirmation        */
      231     7539    3            DO;

      232     7540    3               CALL VPD$GET_SPEC_BUF(0,0);

   7540 12 000213   000007 630400 13                 EPPR0   7
        12 000214   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000215   000000 701000 xent               TSX1    VPD$GET_SPEC_BUF
        12 000216   000000 011000                    NOP     0

      233     7541    3               FPT_WRITE_UC.V.DVBYTE.VFC# = %YES#;

   7541 12 000217   100000 236003                    LDQ     32768,DU
        12 000220   000013 256000 xsym               ORSQ    FPT_WRITE_UC+11

      234     7542    3               FPT_WRITE_UC.BUF_ = VECTOR(WRITE_ME_BUF);

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:49   
   7542 12 000221   000012 235000 13                 LDA     10
        12 000222   200056 452500                    STP2    WRITE_ME_BUF+35,,AUTO
        12 000223   200056 236100                    LDQ     WRITE_ME_BUF+35,,AUTO
        12 000224   000013 036003                    ADLQ    11,DU
        12 000225   000004 757000 xsym               STAQ    FPT_WRITE_UC+4

      235     7543    3               CALL VPD$FINISH_NLIST;      /* Finish dangling name list          */

   7543 12 000226   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 000227   000000 701000 xent               TSX1    VPD$FINISH_NLIST
        12 000230   000000 011000                    NOP     0

      236     7544    3               CALL CONCAT(WRITE_ME_BUF,

   7544 12 000231   000124 237000 11                 LDAQ    ORG_TEXTC_TBL+66
        12 000232   200013 755100                    STA     WRITE_ME_BUF,,AUTO
        12 000233   200014 756100                    STQ     WRITE_ME_BUF+1,,AUTO
        12 000234   040100 100400                    MLR     fill='040'O
        12 000235   000000 200204 xsym               ADSC9   SPEC_BUF                 cn=1,n=132
        12 000236   200015 000204                    ADSC9   WRITE_ME_BUF+2,,AUTO     cn=0,n=132

      237     7545    3                 '@Delete ',
      238     7546    3                 SPEC_BUF.STRING);
      239     7547    3               FPT_WRITE_UC.BUF_.BOUND = SPEC_BUF.LEN+7;

   7547 12 000237   000000 236000 xsym               LDQ     SPEC_BUF
        12 000240   000033 772000                    QRL     27
        12 000241   000007 036007                    ADLQ    7,DL
        12 000242   000020 736000                    QLS     16
        12 000243   000004 676000 xsym               ERQ     FPT_WRITE_UC+4
        12 000244   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 000245   000004 656000 xsym               ERSQ    FPT_WRITE_UC+4

      240     7548    3               CALL M$WRITE(FPT_WRITE_UC);

   7548 12 000246   000000 630400 xsym               EPPR0   FPT_WRITE_UC
        12 000247   040001 713400                    CLIMB   write
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:50   
        12 000250   401400 401760                    pmme    nvectors=4

      241     7549    3               IF ICB.TYPE.COUNT>0

   7549 12 000251   000150 235000 xsym               LDA     ICB+104
        12 000252   000336 604400 12                 TMOZ    s:7565

      242     7550    3                THEN
      243     7551    4                DO;                        /* FORMAT TYPE MESSAGE                */

      244     7552    4                   CALL CONCAT(WRITE_ME_BUF,

   7552 12 000253   040100 100400                    MLR     fill='040'O
        12 000254   000126 000013 11                 ADSC9   ORG_TEXTC_TBL+68         cn=0,n=11
        12 000255   200013 000013                    ADSC9   WRITE_ME_BUF,,AUTO       cn=0,n=11
        12 000256   000047 236007                    LDQ     39,DL
        12 000257   200015 552104                    STBQ    WRITE_ME_BUF+2,'04'O,AUTO
        12 000260   000152 220000 xsym               LDX0    ICB+106
        12 000261   200016 740100                    STX0    WRITE_ME_BUF+3,,AUTO
        12 000262   040100 100400                    MLR     fill='040'O
        12 000263   000024 000001 13                 ADSC9   20                       cn=0,n=1
        12 000264   200016 400176                    ADSC9   WRITE_ME_BUF+3,,AUTO     cn=2,n=126

      245     7553    4                     'aof TYPE = ','''',
      246     7554    4                     ICB.TYPE.STRING(0),'''');
      247     7555    4                   BUF_SIZE = 15;

   7555 12 000265   000017 235007                    LDA     15,DL
        12 000266   200010 755100                    STA     BUF_SIZE,,AUTO

      248     7556    5                   DO I=1 TO ICB.TYPE.COUNT-1;

   7556 12 000267   000001 236007                    LDQ     1,DL
        12 000270   200012 756100                    STQ     I,,AUTO
        12 000271   000322 710000 12                 TRA     s:7561+1

      249     7557    5                      PTR$ = PINCRC(ADDR(WRITE_ME_BUF),BUF_SIZE);
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:51   

   7557 12 000272   200056 452500                    STP2    WRITE_ME_BUF+35,,AUTO
        12 000273   200010 236100                    LDQ     BUF_SIZE,,AUTO
        12 000274   000020 736000                    QLS     16
        12 000275   000013 036003                    ADLQ    11,DU
        12 000276   200056 036100                    ADLQ    WRITE_ME_BUF+35,,AUTO
        12 000277   200011 756100                    STQ     PTR$,,AUTO

      250     7558    5                      PTR$->TYPE$BUF.COMMA = ',';

   7558 12 000300   200011 470500                    LDP0    PTR$,,AUTO
        12 000301   040100 100400                    MLR     fill='040'O
        12 000302   000025 000001 13                 ADSC9   21                       cn=0,n=1
        12 000303   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      251     7559    5                      CALL CONCAT(PTR$->TYPE$BUF.STRING,'''',ICB.TYPE.STRING(I),'''');

   7559 12 000304   040100 100400                    MLR     fill='040'O
        12 000305   000024 000001 13                 ADSC9   20                       cn=0,n=1
        12 000306   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
        12 000307   200012 235100                    LDA     I,,AUTO
        12 000310   000001 735000                    ALS     1
        12 000311   040100 100405                    MLR     fill='040'O
        12 000312   000152 000002 xsym               ADSC9   ICB+106,A                cn=0,n=2
        12 000313   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
        12 000314   040100 100400                    MLR     fill='040'O
        12 000315   000024 000001 13                 ADSC9   20                       cn=0,n=1
        12 000316   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1

      252     7560    5                      BUF_SIZE = BUF_SIZE+5;

   7560 12 000317   000005 236007                    LDQ     5,DL
        12 000320   200010 056100                    ASQ     BUF_SIZE,,AUTO

      253     7561    5                      END;

   7561 12 000321   200012 054100                    AOS     I,,AUTO
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:52   
        12 000322   200012 236100                    LDQ     I,,AUTO
        12 000323   000150 116000 xsym               CMPQ    ICB+104
        12 000324   000272 604000 12                 TMI     s:7557

      254     7562    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE-1;

   7562 12 000325   200010 236100                    LDQ     BUF_SIZE,,AUTO
        12 000326   000001 136007                    SBLQ    1,DL
        12 000327   000020 736000                    QLS     16
        12 000330   000004 676000 xsym               ERQ     FPT_WRITE_UC+4
        12 000331   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 000332   000004 656000 xsym               ERSQ    FPT_WRITE_UC+4

      255     7563    4                   CALL M$WRITE(FPT_WRITE_UC);

   7563 12 000333   000000 630400 xsym               EPPR0   FPT_WRITE_UC
        12 000334   040001 713400                    CLIMB   write
        12 000335   401400 401760                    pmme    nvectors=4

      256     7564    4                   END;

      257     7565    3               IF ICB.DATE.RELATION~=0

   7565 12 000336   000162 235000 xsym               LDA     ICB+114
        12 000337   000437 600000 12                 TZE     s:7588

      258     7566    3                THEN
      259     7567    4                DO;                        /* Format DATE message                */

      260     7568    4                   IF ICB.TYPE.COUNT=0

   7568 12 000340   000150 236000 xsym               LDQ     ICB+104
        12 000341   000350 601000 12                 TNZ     s:7576

      261     7569    4                    THEN
      262     7570    5                    DO;

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:53   
      263     7571    5                       WRITE_ME_BUF = 'aof ';

   7571 12 000342   040100 100400                    MLR     fill='040'O
        12 000343   000126 000004 11                 ADSC9   ORG_TEXTC_TBL+68         cn=0,n=4
        12 000344   200013 000214                    ADSC9   WRITE_ME_BUF,,AUTO       cn=0,n=140

      264     7572    5                       BUF_SIZE = 4;

   7572 12 000345   000004 235007                    LDA     4,DL
        12 000346   200010 755100                    STA     BUF_SIZE,,AUTO

      265     7573    5                       END;

   7573 12 000347   000355 710000 12                 TRA     s:7579

      266     7574    4                    ELSE
      267     7575    5                    DO;

      268     7576    5                       WRITE_ME_BUF = 'aand of ';

   7576 12 000350   040100 100400                    MLR     fill='040'O
        12 000351   000131 000010 11                 ADSC9   ORG_TEXTC_TBL+71         cn=0,n=8
        12 000352   200013 000214                    ADSC9   WRITE_ME_BUF,,AUTO       cn=0,n=140

      269     7577    5                       BUF_SIZE = 8;

   7577 12 000353   000010 235007                    LDA     8,DL
        12 000354   200010 755100                    STA     BUF_SIZE,,AUTO

      270     7578    5                       END;

      271     7579    4                   CALL INSERT(WRITE_ME_BUF,BUF_SIZE,,

   7579 12 000355   000160 235000 xsym               LDA     ICB+112
        12 000356   000003 735000                    ALS     3
        12 000357   200010 720100                    LXL0    BUF_SIZE,,AUTO
        12 000360   777563 620010                    EAX0    -141,X0
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:54   
        12 000361   777777 660003                    ERX0    -1,DU
        12 000362   200010 236100                    LDQ     BUF_SIZE,,AUTO
        12 000363   040146 100405                    MLR     fill='040'O
        12 000364   000000 000010 11                 ADSC9   DATE_TYPE,A              cn=0,n=8
        12 000365   200013 000010                    ADSC9   WRITE_ME_BUF,Q,AUTO      cn=0,n=*X0
        12 000366   000204 116007                    CMPQ    132,DL
        12 000367   000424 605000 12                 TPL     s:7584
        12 000370   777573 621006                    EAX1    -133,QL
        12 000371   777777 661003                    ERX1    -1,DU
        12 000372   040146 100400                    MLR     fill='040'O
        12 000373   000133 000006 11                 ADSC9   ORG_TEXTC_TBL+73         cn=0,n=6
        12 000374   200015 000011                    ADSC9   WRITE_ME_BUF+2,Q,AUTO    cn=0,n=*X1
        12 000375   000176 116007                    CMPQ    126,DL
        12 000376   000424 605000 12                 TPL     s:7584
        12 000377   000162 235000 xsym               LDA     ICB+114
        12 000400   000001 735000                    ALS     1
        12 000401   777601 622006                    EAX2    -127,QL
        12 000402   777777 662003                    ERX2    -1,DU
        12 000403   040146 100405                    MLR     fill='040'O
        12 000404   000016 000002 11                 ADSC9   DATE_REL,A               cn=0,n=2
        12 000405   200016 400012                    ADSC9   WRITE_ME_BUF+3,Q,AUTO    cn=2,n=*X2
        12 000406   000174 116007                    CMPQ    124,DL
        12 000407   000424 605000 12                 TPL     s:7584
        12 000410   777603 623006                    EAX3    -125,QL
        12 000411   777777 663003                    ERX3    -1,DU
        12 000412   040146 100400                    MLR     fill='040'O
        12 000413   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 000414   200017 000013                    ADSC9   WRITE_ME_BUF+4,Q,AUTO    cn=0,n=*X3
        12 000415   000173 116007                    CMPQ    123,DL
        12 000416   000424 605000 12                 TPL     s:7584
        12 000417   777604 624006                    EAX4    -124,QL
        12 000420   777777 664003                    ERX4    -1,DU
        12 000421   040146 100400                    MLR     fill='040'O
        12 000422   000164 000012 xsym               ADSC9   ICB+116                  cn=0,n=10
        12 000423   200017 200014                    ADSC9   WRITE_ME_BUF+4,Q,AUTO    cn=1,n=*X4

      272     7580    4                     DATE_TYPE(ICB.DATE.TYPE),
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:55   
      273     7581    4                     ' DATE ',
      274     7582    4                     DATE_REL(ICB.DATE.RELATION),
      275     7583    4                     ' ',ICB.DATE.TEXT);
      276     7584    4                   BUF_SIZE = BUF_SIZE +27;

   7584 12 000424   000033 236007                    LDQ     27,DL
        12 000425   200010 056100                    ASQ     BUF_SIZE,,AUTO

      277     7585    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE -1;

   7585 12 000426   200010 236100                    LDQ     BUF_SIZE,,AUTO
        12 000427   000001 136007                    SBLQ    1,DL
        12 000430   000020 736000                    QLS     16
        12 000431   000004 676000 xsym               ERQ     FPT_WRITE_UC+4
        12 000432   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 000433   000004 656000 xsym               ERSQ    FPT_WRITE_UC+4

      278     7586    4                   CALL M$WRITE(FPT_WRITE_UC);

   7586 12 000434   000000 630400 xsym               EPPR0   FPT_WRITE_UC
        12 000435   040001 713400                    CLIMB   write
        12 000436   401400 401760                    pmme    nvectors=4

      279     7587    4                   END;

      280     7588    3               IF ICB.CREATOR_SEL ~= 0

   7588 12 000437   000173 235000 xsym               LDA     ICB+123
        12 000440   000463 600000 12                 TZE     s:7597

      281     7589    3                THEN
      282     7590    4                DO;                        /* Format CREATOR message             */

      283     7591    4                   CALL CONCAT(WRITE_ME_BUF,'acreated by ',

   7591 12 000441   040100 100400                    MLR     fill='040'O
        12 000442   000135 000014 11                 ADSC9   ORG_TEXTC_TBL+75         cn=0,n=12
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:56   
        12 000443   200013 000014                    ADSC9   WRITE_ME_BUF,,AUTO       cn=0,n=12
        12 000444   040100 100400                    MLR     fill='040'O
        12 000445   000175 200025 xsym               ADSC9   ICB+125                  cn=1,n=21
        12 000446   200016 000200                    ADSC9   WRITE_ME_BUF+3,,AUTO     cn=0,n=128

      284     7592    4                     ICB.CREATOR.TEXT);
      285     7593    4                   BUF_SIZE = 12 + ICB.CREATOR.C;

   7593 12 000447   000175 236000 xsym               LDQ     ICB+125
        12 000450   000033 772000                    QRL     27
        12 000451   000014 036007                    ADLQ    12,DL
        12 000452   200010 756100                    STQ     BUF_SIZE,,AUTO

      286     7594    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE -1;

   7594 12 000453   000001 136007                    SBLQ    1,DL
        12 000454   000020 736000                    QLS     16
        12 000455   000004 676000 xsym               ERQ     FPT_WRITE_UC+4
        12 000456   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 000457   000004 656000 xsym               ERSQ    FPT_WRITE_UC+4

      287     7595    4                   CALL M$WRITE(FPT_WRITE_UC);

   7595 12 000460   000000 630400 xsym               EPPR0   FPT_WRITE_UC
        12 000461   040001 713400                    CLIMB   write
        12 000462   401400 401760                    pmme    nvectors=4

      288     7596    4                   END;

      289     7597    3               IF ICB.ORG~='0'B

   7597 12 000463   000135 235000 xsym               LDA     ICB+93
        12 000464   000553 600000 12                 TZE     s:7623

      290     7598    3                THEN
      291     7599    4                DO;                        /* FORMAT ORG MESSAGE                 */

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:57   
      292     7600    4                   IF ICB.TYPE.COUNT=0 AND ICB.DATE.RELATION=0

   7600 12 000465   000150 236000 xsym               LDQ     ICB+104
        12 000466   000477 601000 12                 TNZ     s:7608
        12 000467   000162 235000 xsym               LDA     ICB+114
        12 000470   000477 601000 12                 TNZ     s:7608

      293     7601    4                    THEN
      294     7602    5                    DO;

      295     7603    5                       WRITE_ME_BUF = 'aof ORGANIZATION = ';

   7603 12 000471   040100 100400                    MLR     fill='040'O
        12 000472   000140 000023 11                 ADSC9   ORG_TEXTC_TBL+78         cn=0,n=19
        12 000473   200013 000214                    ADSC9   WRITE_ME_BUF,,AUTO       cn=0,n=140

      296     7604    5                       BUF_SIZE = 19;

   7604 12 000474   000023 235007                    LDA     19,DL
        12 000475   200010 755100                    STA     BUF_SIZE,,AUTO

      297     7605    5                       END;

   7605 12 000476   000504 710000 12                 TRA     s:7611

      298     7606    4                    ELSE
      299     7607    5                    DO;

      300     7608    5                       WRITE_ME_BUF = 'aand of ORGANIZATION = ';

   7608 12 000477   040100 100400                    MLR     fill='040'O
        12 000500   000145 000027 11                 ADSC9   ORG_TEXTC_TBL+83         cn=0,n=23
        12 000501   200013 000214                    ADSC9   WRITE_ME_BUF,,AUTO       cn=0,n=140

      301     7609    5                       BUF_SIZE = 23;

   7609 12 000502   000027 235007                    LDA     23,DL
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:58   
        12 000503   200010 755100                    STA     BUF_SIZE,,AUTO

      302     7610    5                       END;

      303     7611    5                   DO I=0 TO 19;

   7611 12 000504   200012 450100                    STZ     I,,AUTO

      304     7612    5                      IF ICB.ORG(I)

   7612 12 000505   200012 235100                    LDA     I,,AUTO
        12 000506   000510 605000 12                 TPL     s:7612+3
        12 000507   000044 035003                    ADLA    36,DU
        12 000510   000000 066405                    CMPB    filb='0'B
        12 000511   000135 000001 xsym               BDSC    ICB+93,A                 by=0,bit=0,n=1
        12 000512   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        12 000513   000536 600000 12                 TZE     s:7619

      305     7613    5                       THEN
      306     7614    6                       DO;

      307     7615    6                          PTR$ = PINCRC(ADDR(WRITE_ME_BUF),BUF_SIZE);

   7615 12 000514   200056 452500                    STP2    WRITE_ME_BUF+35,,AUTO
        12 000515   200010 236100                    LDQ     BUF_SIZE,,AUTO
        12 000516   000020 736000                    QLS     16
        12 000517   000013 036003                    ADLQ    11,DU
        12 000520   200056 036100                    ADLQ    WRITE_ME_BUF+35,,AUTO
        12 000521   200011 756100                    STQ     PTR$,,AUTO

      308     7616    6                          PTR$->CHAR$12 = ORG_TEXTC_TBL.STRING(I);

   7616 12 000522   200012 236100                    LDQ     I,,AUTO
        12 000523   000015 402007                    MPY     13,DL
        12 000524   200011 470500                    LDP0    PTR$,,AUTO
        12 000525   040100 100406                    MLR     fill='040'O
        12 000526   000022 200014 11                 ADSC9   ORG_TEXTC_TBL,Q          cn=1,n=12
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:59   
        12 000527   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      309     7617    6                          BUF_SIZE = BUF_SIZE+ORG_TEXTC_TBL.LEN(I);

   7617 12 000530   000100 101406                    MRL     fill='000'O
        12 000531   000022 000001 11                 ADSC9   ORG_TEXTC_TBL,Q          cn=0,n=1
        12 000532   200056 000004                    ADSC9   WRITE_ME_BUF+35,,AUTO    cn=0,n=4
        12 000533   200056 236100                    LDQ     WRITE_ME_BUF+35,,AUTO
        12 000534   200010 036100                    ADLQ    BUF_SIZE,,AUTO
        12 000535   200010 756100                    STQ     BUF_SIZE,,AUTO

      310     7618    6                          END;

      311     7619    5                      END;

   7619 12 000536   200012 054100                    AOS     I,,AUTO
        12 000537   200012 235100                    LDA     I,,AUTO
        12 000540   000023 115007                    CMPA    19,DL
        12 000541   000505 604400 12                 TMOZ    s:7612

      312     7620    4                   FPT_WRITE_UC.BUF_.BOUND = BUF_SIZE-2;

   7620 12 000542   200010 236100                    LDQ     BUF_SIZE,,AUTO
        12 000543   000002 136007                    SBLQ    2,DL
        12 000544   000020 736000                    QLS     16
        12 000545   000004 676000 xsym               ERQ     FPT_WRITE_UC+4
        12 000546   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 000547   000004 656000 xsym               ERSQ    FPT_WRITE_UC+4

      313     7621    4                   CALL M$WRITE(FPT_WRITE_UC);

   7621 12 000550   000000 630400 xsym               EPPR0   FPT_WRITE_UC
        12 000551   040001 713400                    CLIMB   write
        12 000552   401400 401760                    pmme    nvectors=4

      314     7622    4                   END;

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:60   
      315     7623    3               FPT_READ_UC.BUF_ = VECTOR(PARSE_IN_BUF);

   7623 12 000553   000026 237000 13                 LDAQ    22
        12 000554   000004 757000 xsym               STAQ    FPT_READ_UC+4

      316     7624    3               PARSE_IN_BUF = ' ';

   7624 12 000555   040000 100400                    MLR     fill='040'O
        12 000556   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 000557   000000 002000 xsym               ADSC9   PARSE_IN_BUF             cn=0,n=1024

      317     7625    3               CALL M$READ(FPT_READ_UC) ALTRET(IGNORE);

   7625 12 000560   000000 630400 xsym               EPPR0   FPT_READ_UC
        12 000561   440000 713400                    CLIMB   alt,read
        12 000562   401400 401760                    pmme    nvectors=4
        12 000563   000564 702000 12                 TSX2    IGNORE

      318     7626    3   IGNORE:
      319     7627    3              IF PARSE_IN_BUF ~= 'YES$' AND PARSE_IN_BUF ~= 'yes$' AND PARSE_IN_BUF ~=
              7627                        'Yes$'

   7627 12 000564   040000 106400       IGNORE       CMPC    fill='040'O
        12 000565   000000 002000 xsym               ADSC9   PARSE_IN_BUF             cn=0,n=1024
        12 000566   000153 000004 11                 ADSC9   ORG_TEXTC_TBL+89         cn=0,n=4
        12 000567   000634 600000 12                 TZE     s:7636
        12 000570   040000 106400                    CMPC    fill='040'O
        12 000571   000000 002000 xsym               ADSC9   PARSE_IN_BUF             cn=0,n=1024
        12 000572   000154 000004 11                 ADSC9   ORG_TEXTC_TBL+90         cn=0,n=4
        12 000573   000634 600000 12                 TZE     s:7636
        12 000574   040000 106400                    CMPC    fill='040'O
        12 000575   000000 002000 xsym               ADSC9   PARSE_IN_BUF             cn=0,n=1024
        12 000576   000155 000004 11                 ADSC9   ORG_TEXTC_TBL+91         cn=0,n=4
        12 000577   000634 600000 12                 TZE     s:7636

      320     7628    3                THEN
      321     7629    4                DO;
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:61   

      322     7630    4                   RET_VAL = 0;

   7630 12 000600   200007 470500                    LDP0    @RET_VAL,,AUTO
        12 000601   000000 450100                    STZ     0,,PR0

      323     7631    4                   CALL CONCAT(WRITE_ME_BUF,'ADeletion of ',

   7631 12 000602   000000 236000 xsym               LDQ     SPEC_BUF
        12 000603   000033 772000                    QRL     27
        12 000604   040100 100400                    MLR     fill='040'O
        12 000605   000156 000015 11                 ADSC9   ORG_TEXTC_TBL+92         cn=0,n=13
        12 000606   200013 000015                    ADSC9   WRITE_ME_BUF,,AUTO       cn=0,n=13
        12 000607   000000 620006                    EAX0    0,QL
        12 000610   040100 100440                    MLR     fill='040'O
        12 000611   000000 200010 xsym               ADSC9   SPEC_BUF                 cn=1,n=*X0
        12 000612   200016 200177                    ADSC9   WRITE_ME_BUF+3,,AUTO     cn=1,n=127
        12 000613   000177 116007                    CMPQ    127,DL
        12 000614   000622 603000 12                 TRC     s:7633
        12 000615   777600 620006                    EAX0    -128,QL
        12 000616   777777 660003                    ERX0    -1,DU
        12 000617   040146 100400                    MLR     fill='040'O
        12 000620   000162 000012 11                 ADSC9   ORG_TEXTC_TBL+96         cn=0,n=10
        12 000621   200016 200010                    ADSC9   WRITE_ME_BUF+3,Q,AUTO    cn=1,n=*X0

      324     7632    4                     SUBSTR(SPEC_BUF.STRING,0,SPEC_BUF.LEN),' canceled.');
      325     7633    4                   FPT_WRITE_UC.BUF_.BOUND = SPEC_BUF.LEN + 22;

   7633 12 000622   000000 236000 xsym               LDQ     SPEC_BUF
        12 000623   000033 772000                    QRL     27
        12 000624   000026 036007                    ADLQ    22,DL
        12 000625   000020 736000                    QLS     16
        12 000626   000004 676000 xsym               ERQ     FPT_WRITE_UC+4
        12 000627   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 000630   000004 656000 xsym               ERSQ    FPT_WRITE_UC+4

      326     7634    4                   CALL M$WRITE(FPT_WRITE_UC);
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:62   

   7634 12 000631   000000 630400 xsym               EPPR0   FPT_WRITE_UC
        12 000632   040001 713400                    CLIMB   write
        12 000633   401400 401760                    pmme    nvectors=4

      327     7635    4                   END;

      328     7636    3               FPT_WRITE_UC.V.DVBYTE.VFC# = %NO#;

   7636 12 000634   000030 236000 13                 LDQ     24
        12 000635   000013 356000 xsym               ANSQ    FPT_WRITE_UC+11

      329     7637    3               END;

      330     7638    2   END RANGE_OK;

   7638 12 000636   200006 221300                    LDX1  ! RET_VAL+2,,AUTO
        12 000637   000001 702211                    TSX2  ! 1,X1

      331     7639    1   END VPI$DELETE_SPEC;

   7639 12 000640   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:63   
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPI$DELETE_SPEC.
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:64   

 **** Variables and constants ****

  ****  Section 010  Data  VPI$DELETE_SPEC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 CHECK_RANGE                1-0-0/b BIT         r     1 SAVE_TEST

  ****  Section 011 RoData VPI$DELETE_SPEC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/c CHAR(2)     r     1 DATE_REL(0:6)
     0-0-0/c CHAR(8)     r     1 DATE_TYPE(0:6)
    22-0-0/c STRC(117)   r     1 ORG_TEXTC_TBL(0:19)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @RET_VAL                  10-0-0/w SBIN        r     1 BUF_SIZE
    12-0-0/w SBIN        r     1 I                          3-0-0/w SBIN        r     1 OPEN_NEXT_RET_VAL
    11-0-0/w PTR         r     1 PTR$                       4-0-0/w SBIN        r     1 RET_VAL
    *0-0-0/w SBIN        r     1 RET_VAL                   13-0-0/c CHAR(140)   r     1 WRITE_ME_BUF

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ABORT_CMD                  0-0-0/d REMB        r     1 ABORT_STEP
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w SBIN        r     1 BREAKS
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/b BIT         r     1 CMD_MASK(0:71)
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:65   
     0-0-0/c STRC(288)   r     1 DIN_NAME                   0-0-0/w BIT         r     1 ERR_FLG
     0-0-0/d SBIN        r     1 FPARAM_BUF(0:1023)
     0-0-0/d STRC(2088)  r     1 FPT_OPEN_EI                0-0-0/d STRC(2088)  r     1 FPT_OPEN_EI_SAVE
     0-0-0/d STRC(504)   r     1 FPT_READ_UC                0-0-0/d STRC(432)   r     1 FPT_WRITE_UC
     0-0-0/d STRC(5868)  r     1 ICB                        0-0-0/w PTR         r     1 M$SI$
     0-0-0/w SBIN        r     1 ONE_TIME                   0-0-0/c CHAR(1024)  r     1 PARSE_IN_BUF
     0-0-0/c STRC(1260)  r     1 SPEC_BUF                   0-0-0/b BIT         r     1 THIS_STD_FILE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4537)  r     1 B$JIT                      0-0-0/c CHAR(12)    r     1 CHAR$12
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/c STRC(45)    r     1 TYPE$BUF


   Procedure VPI$DELETE_SPEC requires 417 words for executable code.
   Procedure VPI$DELETE_SPEC requires 52 words of local(AUTO) storage.

    No errors detected in file VPI$DELETE.:E05TSI    .
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:66   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:67   
          MINI XREF LISTING

ABORT_CMD
      5185**DCL      7274>>UNWIND
ABORT_STEP
      5184**DCL      7269<<REMEMBR
B$JIT.CPFLAGS1 IN PROCEDURE RANGE_OK
      7429**DCL      7533>>IF
B$JIT.CPFLAGS1.SLEAZE IN PROCEDURE RANGE_OK
      7434**DCL      7434--REDEF
B$JIT.ERR.MID IN PROCEDURE RANGE_OK
      7341**DCL      7341--REDEF
B$JIT.MODE IN PROCEDURE RANGE_OK
      7335**DCL      7533>>IF
B$JIT$
      5985**DCL      7335--IMP-PTR  7533>>IF       7533>>IF
BREAKS
      5220**DCL      7272>>IF
BREAK_LOC
      5220**DCL      5220--REDEF
BUF_SIZE IN PROCEDURE RANGE_OK
      7501**DCL      7555<<ASSIGN   7557>>ASSIGN   7560<<ASSIGN   7560>>ASSIGN   7562>>ASSIGN   7572<<ASSIGN
      7577<<ASSIGN   7579>>CALLBLT  7584<<ASSIGN   7584>>ASSIGN   7585>>ASSIGN   7593<<ASSIGN   7594>>ASSIGN
      7604<<ASSIGN   7609<<ASSIGN   7615>>ASSIGN   7617<<ASSIGN   7617>>ASSIGN   7620>>ASSIGN
CHAR$12 IN PROCEDURE RANGE_OK
      7511**DCL      7616<<ASSIGN
CHECK_RANGE
      7054**DCL      7268<<ASSIGN   7275>>IF       7285<<ASSIGN   7299>>IF
CMD_MASK
      5222**DCL      7533>>IF
DATE_REL IN PROCEDURE RANGE_OK
      7518**DCL      7579>>CALLBLT
DATE_TYPE IN PROCEDURE RANGE_OK
      7515**DCL      7579>>CALLBLT
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:68   
DEF_ICB.FID.STRING
      5818**DCL      5819--REDEF
DEL_ALTRET
      7313**LABEL    7292--CALLALT
DEL_DONE
      7311**LABEL    7283--GOTO
DEV_ICB.FID.STRING
      5704**DCL      5705--REDEF
DIN_NAME
      5511**DCL      7294<>CALL
EI_KEY.KEY
      5916**DCL      5916--REDEF    5916--REDEF    5916--REDEF
EO_OCB.TYPE
      5416**DCL      5417--REDEF
ERR_FLG
      5183**DCL      7282<<ASSIGN   7303<<ASSIGN
F$DCB.ACTPOS
      7026**DCL      7026--REDEF
F$DCB.ARS
      7001**DCL      7001--REDEF
F$DCB.ATTR
      7019**DCL      7020--REDEF
F$DCB.BORROW
      7034**DCL      7034--REDEF    7034--REDEF    7034--REDEF
F$DCB.DCBNAME.L
      7048**DCL      7048--IMP-SIZ
F$DCB.DDEV.IC
      7007**DCL      7533>>IF
F$DCB.EOMCHAR
      7005**DCL      7005--REDEF
F$DCB.FLDID
      7029**DCL      7029--REDEF
F$DCB.FORM$
      7023**DCL      7023--REDEF
F$DCB.FSECT
      7039**DCL      7039--REDEF
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:69   
F$DCB.FSN
      7016**DCL      7016--REDEF    7016--REDEF    7017--REDEF
F$DCB.HEADER$
      7022**DCL      7022--REDEF
F$DCB.IXTNSIZE
      7020**DCL      7020--REDEF
F$DCB.LASTSTA$
      7010**DCL      7010--REDEF
F$DCB.LVL
      7035**DCL      7035--REDEF
F$DCB.NAME.C
      7010**DCL      7010--REDEF
F$DCB.NOEOF
      7031**DCL      7031--REDEF
F$DCB.NRECS
      7021**DCL      7021--REDEF
F$DCB.NRECX
      7040**DCL      7040--REDEF
F$DCB.OHDR
      7032**DCL      7032--REDEF
F$DCB.ORG
      7015**DCL      7015--REDEF
F$DCB.PRECNO
      7038**DCL      7038--REDEF
F$DCB.RCSZ
      7043**DCL      7043--REDEF
F$DCB.RES
      7011**DCL      7011--REDEF
F$DCB.SETX
      7023**DCL      7023--REDEF
F$DCB.TAB$
      7022**DCL      7023--REDEF
F$DCB.TDA
      7037**DCL      7037--REDEF
F$DCB.WSN
      7012**DCL      7012--REDEF
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:70   
FPARAM_BUF
      5221**DCL      7291--ASSIGN
FPT_CLOSE_EI.SN_
      6757**DCL      6757--REDEF
FPT_CLOSE_EI.UTL_
      6758**DCL      6758--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6772**DCL      6772--REDEF
FPT_CLOSE_EI.V.TYPE#
      6770**DCL      6770--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6767**DCL      6767--REDEF    6769--REDEF
FPT_CLOSE_PTL.SN_
      6883**DCL      6883--REDEF
FPT_CLOSE_PTL.UTL_
      6884**DCL      6884--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6898**DCL      6898--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6896**DCL      6896--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6893**DCL      6893--REDEF    6895--REDEF
FPT_CLOSE_READ.SN_
      6799**DCL      6799--REDEF
FPT_CLOSE_READ.UTL_
      6800**DCL      6800--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6814**DCL      6814--REDEF
FPT_CLOSE_READ.V.TYPE#
      6812**DCL      6812--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6809**DCL      6809--REDEF    6811--REDEF
FPT_CLOSE_SI.SN_
      6967**DCL      6967--REDEF
FPT_CLOSE_SI.UTL_
      6968**DCL      6968--REDEF
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:71   
FPT_CLOSE_SI.V.EXPIRE#
      6982**DCL      6982--REDEF
FPT_CLOSE_SI.V.TYPE#
      6980**DCL      6980--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6977**DCL      6977--REDEF    6979--REDEF
FPT_CLOSE_STD.SN_
      6925**DCL      6925--REDEF
FPT_CLOSE_STD.UTL_
      6926**DCL      6926--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6940**DCL      6940--REDEF
FPT_CLOSE_STD.V.TYPE#
      6938**DCL      6938--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6935**DCL      6935--REDEF    6937--REDEF
FPT_CLSEI_FT.SN_
      6841**DCL      6841--REDEF
FPT_CLSEI_FT.UTL_
      6842**DCL      6842--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6856**DCL      6856--REDEF
FPT_CLSEI_FT.V.TYPE#
      6854**DCL      6854--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6851**DCL      6851--REDEF    6853--REDEF
FPT_OPEN_EI
      6410**DCL      7288<<ASSIGN   7292<>CALL
FPT_OPEN_EI.ACSVEH_
      6412**DCL      6413--REDEF
FPT_OPEN_EI.ALTKEYS_
      6418**DCL      6419--REDEF    6419--REDEF
FPT_OPEN_EI.FPARAM_
      6415**DCL      7291<<ASSIGN
FPT_OPEN_EI.HDR_
      6417**DCL      6418--REDEF
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:72   
FPT_OPEN_EI.TAB_
      6416**DCL      6417--REDEF
FPT_OPEN_EI.UHL_
      6410**DCL      6411--REDEF    6411--REDEF
FPT_OPEN_EI.V.DELETE#
      6421**DCL      7290<<ASSIGN
FPT_OPEN_EI.V.FSN#
      6450**DCL      6450--REDEF    6450--REDEF
FPT_OPEN_EI.V.OPER.TEST#
      6421**DCL      7287>>ASSIGN   7289<<ASSIGN   7293<<ASSIGN   7313<<ASSIGN
FPT_OPEN_EI.WSN_
      6416**DCL      6416--REDEF
FPT_OPEN_EI_SAVE
      6519**DCL      7288>>ASSIGN
FPT_OPEN_EI_SAVE.ACSVEH_
      6521**DCL      6522--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6527**DCL      6528--REDEF    6528--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6526**DCL      6527--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6525**DCL      6526--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6519**DCL      6520--REDEF    6520--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6559**DCL      6559--REDEF    6559--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6525**DCL      6525--REDEF
FPT_OPEN_OUT.ACSVEH_
      6303**DCL      6304--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6309**DCL      6310--REDEF    6310--REDEF
FPT_OPEN_OUT.HDR_
      6308**DCL      6309--REDEF
FPT_OPEN_OUT.TAB_
      6307**DCL      6308--REDEF
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:73   
FPT_OPEN_OUT.UHL_
      6301**DCL      6302--REDEF    6302--REDEF
FPT_OPEN_OUT.V.FSN#
      6341**DCL      6341--REDEF    6341--REDEF
FPT_OPEN_OUT.WSN_
      6307**DCL      6307--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6194**DCL      6195--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6200**DCL      6201--REDEF    6201--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6199**DCL      6200--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6198**DCL      6199--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6192**DCL      6193--REDEF    6193--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6232**DCL      6232--REDEF    6232--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6198**DCL      6198--REDEF
FPT_READ_STD.STATION_
      6622**DCL      6623--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6634**DCL      6634--REDEF
FPT_READ_STD.V.INDX#
      6632**DCL      6632--REDEF
FPT_READ_UC
      6580**DCL      7625<>CALL
FPT_READ_UC.BUF_
      6582**DCL      7623<<ASSIGN
FPT_READ_UC.STATION_
      6583**DCL      6584--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6595**DCL      6595--REDEF
FPT_READ_UC.V.INDX#
      6593**DCL      6593--REDEF
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:74   
FPT_WRITE_ME.STATION_
      6691**DCL      6691--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6698**DCL      6698--REDEF
FPT_WRITE_OUT.STATION_
      6722**DCL      6722--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6729**DCL      6729--REDEF
FPT_WRITE_UC
      6658**DCL      7548<>CALL     7563<>CALL     7586<>CALL     7595<>CALL     7621<>CALL     7634<>CALL
FPT_WRITE_UC.BUF_
      6658**DCL      7542<<ASSIGN
FPT_WRITE_UC.BUF_.BOUND
      6658**DCL      7547<<ASSIGN   7562<<ASSIGN   7585<<ASSIGN   7594<<ASSIGN   7620<<ASSIGN   7633<<ASSIGN
FPT_WRITE_UC.STATION_
      6660**DCL      6660--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6667**DCL      6667--REDEF    7541<<ASSIGN   7636<<ASSIGN
FROM_SN.SN
      5566**DCL      5567--REDEF
GETCMD.OUT$
      4773**DCL      4779--REDEF
I IN PROCEDURE RANGE_OK
      7503**DCL      7556<<DOINDEX  7559>>CALLBLT  7611<<DOINDEX  7612>>IF       7616>>ASSIGN   7617>>ASSIGN
ICB.CREATOR.C
      5663**DCL      7593>>ASSIGN
ICB.CREATOR.TEXT
      5664**DCL      7591>>CALLBLT
ICB.CREATOR_SEL
      5660**DCL      7588>>IF
ICB.DATE.RELATION
      5623**DCL      7565>>IF       7579>>CALLBLT  7600>>IF
ICB.DATE.TEXT
      5625**DCL      7579>>CALLBLT
ICB.DATE.TYPE
      5621**DCL      7579>>CALLBLT
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:75   
ICB.FID.STRING
      5590**DCL      5591--REDEF
ICB.ORG
      5610**DCL      7597>>IF       7612>>IF
ICB.SPEC_TYPE
      5587**DCL      7299>>IF       7299>>IF       7533>>IF       7533>>IF
ICB.TYPE.COUNT
      5615**DCL      7549>>IF       7556>>DOINDEX  7568>>IF       7600>>IF
ICB.TYPE.STRING
      5617**DCL      7552>>CALLBLT  7559>>CALLBLT
IFSFA_PARAM.EOMCHAR#
      5945**DCL      5946--REDEF
IFSFA_PARAM.SIG1
      5939**DCL      5939--REDEF
IFSFA_PARAM.SIG2
      5939**DCL      5940--REDEF
IGNORE IN PROCEDURE RANGE_OK
      7627**LABEL    7625--CALLALT
IN_RES
      5512**DCL      5512--REDEF
IN_SN.SN
      5528**DCL      5529--REDEF
M$OPEN
        30**DCL-ENT  7292--CALL
M$READ
        31**DCL-ENT  7625--CALL
M$SI$
      5982**DCL      7533>>IF
M$WRITE
        31**DCL-ENT  7548--CALL     7563--CALL     7586--CALL     7595--CALL     7621--CALL     7634--CALL
NEXT_FILE
      7297**LABEL    7269--REMEMBR
OCB.TYPE
      5274**DCL      5275--REDEF
OFSFA_PARAM.EOMCHAR#
      5975**DCL      5976--REDEF
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:76   
OFSFA_PARAM.SIG1
      5969**DCL      5969--REDEF
OFSFA_PARAM.SIG2
      5969**DCL      5970--REDEF
ONE_TIME
      5225**DCL      7533>>IF
OPEN_NEXT_RET_VAL
      7052**DCL      7270<>CALL     7271>>DOWHILE  7297<>CALL
ORG_TEXTC_TBL.LEN IN PROCEDURE RANGE_OK
      7521**DCL      7617>>ASSIGN
ORG_TEXTC_TBL.STRING IN PROCEDURE RANGE_OK
      7526**DCL      7616>>ASSIGN
OUT_SN.SN
      5546**DCL      5547--REDEF
PARSE_IN_BUF
      4554**DCL      7623--ASSIGN   7624<<ASSIGN   7627>>IF       7627>>IF       7627>>IF
PTR$ IN PROCEDURE RANGE_OK
      7502**DCL      7557<<ASSIGN   7558>>ASSIGN   7559>>CALLBLT  7615<<ASSIGN   7616>>ASSIGN
RANGE_OK
      7316**PROC     7278--CALL
RET_VAL
      7053**DCL      7278<>CALL     7279>>IF
RET_VAL IN PROCEDURE RANGE_OK
      7329**DCL      7316--PROC     7532<<ASSIGN   7630<<ASSIGN
SAVE_TEST
      7055**DCL      7287<<ASSIGN   7293>>ASSIGN   7313>>ASSIGN
SPEC_BUF
      5224**DCL      5224--REDEF    7305--CALL
SPEC_BUF.LEN
      5224**DCL      7547>>ASSIGN   7631>>CALLBLT  7633>>ASSIGN
SPEC_BUF.STRING
      5224**DCL      7544>>CALLBLT  7631>>CALLBLT
THIS_STD_FILE
      5218**DCL      7296<<ASSIGN
TYPE$BUF.COMMA IN PROCEDURE RANGE_OK
      7509**DCL      7558<<ASSIGN
PL6.E3A0      #002=VPI$DELETE_SPEC File=VPI$DELETE.:E05TSI                       WED 07/30/97 07:48 Page:77   
TYPE$BUF.STRING IN PROCEDURE RANGE_OK
      7510**DCL      7559<<CALLBLT
VPD$COUNTER_BUMP
      7090**DCL-ENT  7295--CALL
VPD$FINISH_NLIST
      7102**DCL-ENT  7543--CALL
VPD$GET_SPEC_BUF
      7122**DCL-ENT  7304--CALL     7540--CALL
VPD$OUT_NAMES
      7103**DCL-ENT  7294--CALL
VPF$OPEN_NEXT
      7173**DCL-ENT  7270--CALL     7297--CALL
VPL$ERR_PROC
      7241**DCL-ENT  7305--CALL     7314--CALL
WRITE_ME_BUF IN PROCEDURE RANGE_OK
      7504**DCL      7542--ASSIGN   7544<<CALLBLT  7552<<CALLBLT  7557--ASSIGN   7571<<ASSIGN   7576<<ASSIGN
      7579<<CALLBLT  7591<<CALLBLT  7603<<ASSIGN   7608<<ASSIGN   7615--ASSIGN   7631<<CALLBLT
