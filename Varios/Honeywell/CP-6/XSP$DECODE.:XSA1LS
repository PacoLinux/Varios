VERSION A01

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:1    
        1        1        /*M*    XSP$DECODE      Routines for receiving and decoding a PPDU      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSP$DECODE
        9        9                DESCRIPTION:
       10       10                    This routine handles the decoding of a Presentation PDU that
       11       11                    has been received from the other endpoint.  This is done using
       12       12                    the macros defined in XSP_ASN1_M.  Any User Data supplied in
       13       13                    the PPDU is also decoded with the same macros, according to the
       14       14                    syntax the user supplied.
       15       15        */
       16       16        XSP$DECODE: PROC( VBLK, SFPT$) ALTRET;
       17       17        %INCLUDE XSS_SESSION_E;
       18      582        %INCLUDE XSS_SESSION_M;
       19     3225            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       20     6604        %INCLUDE XSP_INTERNAL_E;
       21     6878        %INCLUDE XSP_INTERNAL_M;
       22     7539            %XSP$CTXTMAP( NAME=CMAP, STCLASS="BASED( CMAP$)");
       23     7580            %ENCDECMACS;
       24     7759        %INCLUDE XSP_PRESENTATION_E;
       25     7858        %INCLUDE XSP_PRESENTATION_M;
       26     9344            %XSP$PCTX( NAME=PCTX, STCLASS="BASED( VBLK.CTX$)");
       27     9500            %XSP$PSAP( FPTN=PSAP, STCLASS="BASED( PSAP$)");
       28     9536            %XSP$VBLK( NAME=VBLK, STCLASS="");
       29     9682            %XSP$PRIMITIVES( STCLASS="BASED( VBLK.FPT$)");
       30    11381            %XSP_PRIMITIVES( STCLASS=SYMREF);
       31    13080            %XSP$CTXTLIST( NAME=CLST, STCLASS="BASED( XSP_TMPCTXT$)");
       32    13107            %XSP$CTXTNAME( NAME=CTXT, STCLASS=BASED);
       33    13149            %XSP$CTXTNAME( NAME=ABSNAME, STCLASS=STATIC, CTXT='....................');
       34    13191            %XSP$CTXTNAME( NAME=TFRNAME, STCLASS=STATIC, CTXT='....................');
       35    13233        %INCLUDE K_ADDRESS_M;
       36    13736        %INCLUDE XSC_COMMON_M;
       37    14389            %XSC$ADDRESS;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:2    
       38    14672        %EQU ITEMMAX = 31;
       39    14673        %EQU MAXDEPTH = 7;
       40    14674        /* in the following TAGxx equates, 32 is added if constructed */
       41    14675        %EQU TAGC0 = (128+32);
       42    14676        %EQU TAGC1 = (129+32);
       43    14677        %EQU TAGA0 = (64);
       44    14678        %EQU TAGA1 = (65+32);
       45    14679        %EQU TAGSEQ = (%XSP_TYP_SEQ+32);
       46    14680        %EQU TAGSET = (%XSP_TYP_SET+32);
       47    14681
       48    14682    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
       49    14683
       50    14684    1       DCL XSP_DATANUM SBIN SYMREF;
       51    14685    1       DCL XSP_DATABUF$(0:%XSP_MAX_DATANUM) PTR SYMREF;
       52    14686    1       DCL XSP_DATACTXT(0:%XSP_MAX_DATANUM) UBIN BYTE SYMREF CALIGNED;
       53    14687    1       DCL XSP_DATASIZE(0:%XSP_MAX_DATANUM) SBIN SYMREF;
       54    14688    1       DCL XSP_ITEMCNT SBIN SYMREF;
       55    14689    1       DCL XSP_ITEMMAX SBIN SYMREF;
       56    14690    1       DCL XSP_DSTADDR$ PTR SYMREF;
       57    14691    1       DCL XSP_SRCADDR$ PTR SYMREF;
       58    14692    1       DCL XSP_TMPCTXT$ PTR SYMREF;
       59    14693    1       DCL 1 XSP_ABSLIST SYMREF,
       60    14694    1            2 CTXT$(0:0) PTR,
       61    14695    1            2 COUNT(0:0) REDEF CTXT$ SBIN;
       62    14696    1       DCL 1 XSP_TFRLIST SYMREF,
       63    14697    1            2 CTXT$(0:0) PTR,
       64    14698    1            2 COUNT(0:0) REDEF CTXT$ SBIN;
       65    14699
       66    14700            %ITEM( NAME=SCANITEM, STCLASS=AUTO);              /* THESE TWO LINES... */
       67    14725            %ITEM( NAME="ITEMLIST(0:%ITEMMAX)", STCLASS=AUTO);/* MUST BE CONTIGUOUS */
       68    14750    1       DCL ABS$ PTR;
       69    14751    1       DCL TFR$ PTR;
       70    14752    1       DCL SRC$ PTR CALIGNED;
       71    14753    1       DCL BSRC$ PTR UNAL;
       72    14754    1       DCL SRCLEN SBIN;
       73    14755    1       DCL SRCBYTES CHAR( SRCLEN) BASED CALIGNED;
       74    14756    1       DCL DST$ PTR CALIGNED;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:3    
       75    14757    1       DCL BDST$ PTR UNAL;
       76    14758    1       DCL DSTLEN SBIN;
       77    14759    1       DCL DSTBYTES CHAR( DSTLEN) BASED CALIGNED;
       78    14760    1       DCL BIT1 BIT(1) BASED UNAL;
       79    14761    1       DCL BIT8 BIT(8) BASED UNAL;
       80    14762    1       DCL BTMP BIT(36);
       81    14763    1       DCL CMAP$ PTR;
       82    14764    1       DCL DATALVL SBIN;
       83    14765    1       DCL DEPTH SBIN;
       84    14766    1       DCL I SBIN;
       85    14767    1       DCL ITEMCUR SBIN;
       86    14768    1       DCL ITEMNUM SBIN;
       87    14769    1       DCL J SBIN;
       88    14770    1       DCL LEN SBIN;
       89    14771    1       DCL PDU$ PTR CALIGNED;
       90    14772    1       DCL PDU CHAR(16384) BASED( PDU$) CALIGNED;
       91    14773    1       DCL PDUIDX SBIN;
       92    14774    1       DCL PSAP$ PTR;
       93    14775    1       DCL SFPT$ PTR;
       94    14776    1       DCL TAG SBIN;
       95    14777    1       DCL 1 TAGX REDEF TAG,
       96    14778    1            2 * BIT(28) UNAL,
       97    14779    1            2 CLASS UBIN(2) UNAL,
       98    14780    1            2 CONSTRUCTED BIT(1) UNAL,
       99    14781    1            2 VALUE UBIN(5) UNAL;
      100    14782    1       DCL TEMP SBIN;
      101    14783    1       DCL TMP$ PTR;
      102    14784    1       DCL UTMP UBIN;
      103    14785    1       DCL 1 TWOZEROES CONSTANT,
      104    14786    1            2 X(0:1) UBIN(9) INIT( 0, 0) CALIGNED,
      105    14787    1            2 C REDEF X CHAR(2) CALIGNED;
      106    14788    1       DCL CURRLEN(0:%MAXDEPTH) SBIN;
      107    14789    1       DCL INITLEN(0:%MAXDEPTH) SBIN;
      108    14790
      109    14791    1       ITEMLIST = '0'B;
      110    14792    1       TEMP = VBLK.DATA.SIZE;
      111    14793    1       INITLEN = '0'B;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:4    
      112    14794    1       INITLEN(0) = TEMP;
      113    14795    1       INITLEN(1) = TEMP;
      114    14796    1       CURRLEN = '0'B;
      115    14797    1       CURRLEN(0) = TEMP;
      116    14798    1       CURRLEN(1) = TEMP;
      117    14799    1       PDU$ = VBLK.DATA.PTR$;
      118    14800    1       PDUIDX = 0;
      119    14801    1       ITEMLIST.Z(0) = 32*512 + TEMP*262144;  /* set up CON and LEN */
      120    14802    1       ITEMLIST.P(0) = PDU$;
      121    14803    1       ITEMNUM = 1;
      122    14804    1       DEPTH = 1;
      123    14805    1       GOTO NEXTBYTE;
      124    14806    1   NEXTLEVEL:
      125    14807    1       DEPTH = DEPTH + 1;
      126    14808    1       IF DEPTH > %MAXDEPTH THEN
      127    14809    1           ALTRETURN;
      128    14810    1       CURRLEN( DEPTH) = TEMP;
      129    14811    1       IF TEMP >= 0 THEN
      130    14812    1           INITLEN( DEPTH) = TEMP;
      131    14813    1       ELSE
      132    14814    1           INITLEN( DEPTH) = -( ITEMNUM - 1);  /* LEN will be fixed at ENDITEM */
      133    14815    1   NEXTBYTE:
      134    14816    2       IF CURRLEN( DEPTH) > 0 THEN DO;
      135    14817    2           IF SUBSTR( PDU, PDUIDX, 2) = TWOZEROES.C THEN
      136    14818    2               GOTO ENDITEM;
      137    14819    2           TAG = ASCBIN( SUBSTR( PDU, PDUIDX, 1));
      138    14820    2           PDUIDX = PDUIDX + 1;
      139    14821    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - 1;
      140    14822    2           CALL GETLEN;  /* parse length of item into TEMP */
      141    14823    2           IF TEMP >= 0 THEN
      142    14824    2               ITEMLIST.Z( ITEMNUM) = DEPTH + TAG*512 + TEMP*262144;
      143    14825    2           ELSE
      144    14826    2               ITEMLIST.Z( ITEMNUM) = DEPTH + TAG*512;  /* LEN fixed later */
      145    14827    2           ITEMLIST.P( ITEMNUM) = PINCRC( PDU$, PDUIDX);
      146    14828    2           ITEMNUM = ITEMNUM + 1;
      147    14829    2           IF TAGX.CONSTRUCTED THEN
      148    14830    2               GOTO NEXTLEVEL;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:5    
      149    14831    2           IF TEMP < 0 THEN
      150    14832    2               ALTRETURN;  /* indefinite form illegal for primitive */
      151    14833    2           PDUIDX = PDUIDX + TEMP;
      152    14834    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - TEMP;
      153    14835    2           IF VBLK.DATA.SIZE > PDUIDX THEN
      154    14836    2               GOTO NEXTBYTE;
      155    14837    2           END;
      156    14838    1   ENDITEM:
      157    14839    2       IF INITLEN( DEPTH) < 0 THEN DO;
      158    14840                /* have to fix up length of an indefinite-length item */
      159    14841    2           TEMP = -INITLEN( DEPTH);
      160    14842    2           ITEMLIST.X.LEN( TEMP) = PDUIDX - POFFC( ITEMLIST.P( TEMP), PDU$);
      161    14843    2           PDUIDX = PDUIDX + 2;
      162    14844    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - 2;
      163    14845    2           INITLEN( DEPTH) = - ( CURRLEN( DEPTH) + 1);
      164    14846    2           END;
      165    14847    1       TEMP = DEPTH;
      166    14848    1       DEPTH = DEPTH - 1;
      167    14849    2       IF DEPTH >= 0 THEN DO;
      168    14850    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - INITLEN( TEMP);
      169    14851    2           INITLEN( TEMP) = 0;
      170    14852    2           GOTO NEXTBYTE;
      171    14853    2           END;
      172    14854            /* done scanning the PPDU.. now try to decode it item by item */
      173    14855    1       ABS$ = ADDR( ABSNAME);
      174    14856    1       TFR$ = ADDR( TFRNAME);
      175    14857    1       XSP_ITEMCNT = -1;  /* make SCAN/LOAD load into SCANITEM, not ITEMLIST */
      176    14858    1       ITEMCUR = 0;
      177    14859    1       DATALVL = 0;
      178    14860    1       CALL XSS$BUFPTR( PCTX.CTXTMAPX, CMAP$);
      179    14861            %SCAN( LVL=0, TYP=NONE, CON=Y, LEN="VBLK.DATA.SIZE");
      180    14958    1   SFNCCASE:
      181    14959    2       DO CASE( XSS$GENERIC.FNC);
      182    14960        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:6    
      183    14961        /*****************************************************************************
      184    14962        *
      185    14963        *       SCADIND --> TC
      186    14964        *
      187    14965        *****************************************************************************/
      188    14966    2           CASE( %XSS_FNC_SCADIND#);  /* should be a TC PPDU */
      189    14967    2               XSP$CAPABILITY_DATA = XSP_CAPABILITY_DATA;
      190    14968    2               XSP$CAPABILITY_DATA.FNC = %XSP_FNC_PCADIND#;
      191    14969    2               DATALVL = 1;
      192    14970        /*****************************************************************************
      193    14971        *
      194    14972        *       SCADCNF --> TCC
      195    14973        *
      196    14974        *****************************************************************************/
      197    14975    2           CASE( %XSS_FNC_SCADCNF#);  /* should be a TCC PPDU */
      198    14976    2               XSP$CAPABILITY_DATA = XSP_CAPABILITY_DATA;
      199    14977    2               XSP$CAPABILITY_DATA.FNC = %XSP_FNC_PCADCNF#;
      200    14978    2               DATALVL = 1;
      201    14979        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:7    
      202    14980        /*****************************************************************************
      203    14981        *
      204    14982        *       SCONIND --> CP
      205    14983        *
      206    14984        *****************************************************************************/
      207    14985    2           CASE( %XSS_FNC_SCONIND#);  /* should be a CP PPDU */
      208    14986    2               XSP$CONNECT = XSP_CONNECT;
      209    14987    2               XSP$CONNECT.FNC = %XSP_FNC_PCONIND#;
      210    14988    2               XSP$CONNECT.CALLING$ = XSP_SRCADDR$;
      211    14989    2               XSP$CONNECT.CALLED$ = XSP_DSTADDR$;
      212    14990    2               XSP$CONNECT.CTXT$ = XSP_TMPCTXT$;
      213    14991                    %SCAN( LVL=1, TYP=SET);  /* CPType */
      214    15088                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SET);  /* ModeSelector */
      215    15185    2               UTMP = 0;
      216    15186                    %SCAN( LVL=3, TAG=C0, TYP=INTG,
      217    15187                            LEN=1, VAL=UTMP);
      218    15284    2               IF UTMP ~= 1 THEN
      219    15285    2                   ALTRETURN;
      220    15286                    %SCAN( LVL=2, TAG=C2, IMP=Y, TYP=SEQ, OPT=Y);
      221    15383    2               BTMP = '000000000000'O;
      222    15384                    %SCAN( LVL=3, TAG=C0, IMP=Y, TYP=BITSTR, OPT=Y,
      223    15385                            LEN=1, VAL=BTMP);  /* ProtocolVersion */
      224    15482    2               IF BTMP ~= '1'B THEN
      225    15483    2                   ALTRETURN;
      226    15484    2               PSAP$ = ADDR( XSP$CONNECT.CALLING$->XSC$ADDRESS.PSAP);
      227    15485                    %SCAN( LVL=3, TAG=C1, IMP=Y, TYP=OCTETSTR, OPT=Y,
      228    15486                            LEN=224, VAL="PSAP.TXT");  /* CallingPresSelector */
      229    15583    2               PSAP$ = ADDR( XSP$CONNECT.CALLED$->XSC$ADDRESS.PSAP);
      230    15584                    %SCAN( LVL=3, TAG=C2, IMP=Y, TYP=OCTETSTR, OPT=Y,
      231    15585                            LEN=224, VAL="PSAP.TXT");  /* CalledPresSelector */
      232    15682                    %SCAN( LVL=3, TAG=C4, IMP=Y, TYP=SEQOF, OPT=Y);/*PresCtxtDefList*/
      233    15779    2               I = 0;
      234    15780    2               CLST.COUNT(0) = I;
      235    15781    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 3);
      236    15782                        %SCAN( LVL=4, TYP=SEQ);
      237    15879    3                   UTMP = 0;
      238    15880                        %SCAN( LVL=5, TYP=INTG,
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:8    
      239    15881                                LEN=4, VAL=UTMP);  /* PresCtxtIdent */
      240    15978                        %SCAN( LVL=5, TYP=OBJID,
      241    15979                                LEN=20, VAL=ABS$);  /* AbsSynName */
      242    16076                        %SCAN( LVL=5, TYP=SEQOF);
      243    16173                        /*N* we only support one transfer syntax at a time */
      244    16174                        %SCAN( LVL=6, TYP=OBJID,
      245    16175                                LEN=20, VAL=TFR$);  /* TfrSynName */
      246    16272    3                   I = I + 1;
      247    16273    3                   CLST.COUNT(0) = I;
      248    16274    3                   CMAP.ABSCTXTID( I) = 0;
      249    16275    3                   CMAP.TFRCTXTID( I) = 0;
      250    16276                        /* validate this PresCtxt definition */
      251    16277    3   CP_CTXT_ABS:
      252    16278    4                   DO J = 1 TO XSP_ABSLIST.COUNT(0);
      253    16279    4                       TMP$ = XSP_ABSLIST.CTXT$( J);
      254    16280    4                       IF TMP$ ~= ADDR( NIL) AND
      255    16281    4                               ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      256    16282    5                               ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      257    16283    5                           CMAP.ABSCTXTID( I) = J;
      258    16284    5                           EXIT CP_CTXT_ABS;
      259    16285    5                           END;
      260    16286    4                       END;
      261    16287    3   CP_CTXT_TFR:
      262    16288    4                   DO J = 1 TO XSP_TFRLIST.COUNT(0);
      263    16289    4                       TMP$ = XSP_TFRLIST.CTXT$( J);
      264    16290    4                       IF TMP$ ~= ADDR( NIL) AND
      265    16291    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      266    16292    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      267    16293    5                           CMAP.TFRCTXTID( I) = J;
      268    16294    5                           EXIT CP_CTXT_TFR;
      269    16295    5                           END;
      270    16296    4                       END;
      271    16297    3                   IF CMAP.ABSCTXTID( I) = 0 OR CMAP.TFRCTXTID( I) = 0 THEN
      272    16298    3                       CMAP.RESULT( I) = %XSP_RSLT_PREJECT;
      273    16299    3                   ELSE
      274    16300    3                       CMAP.RESULT( I) = %XSP_RSLT_ACCEPT;
      275    16301    3                   CMAP.STATE( I) = %XSP_CMAP_RMTDEF;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:9    
      276    16302    3                   CMAP.PEERCTXTID( I) = UTMP;
      277    16303    3                   CLST.RESULT( I) = CMAP.RESULT( I);
      278    16304    3                   VBLK.DEFBITS( I) = %TRUE;
      279    16305    3                   END;
      280    16306    2               PCTX.DFLCTXTID = 1;  /*N* hardwired bogus CP-6 context */
      281    16307                    %SCAN( LVL=3, TAG=C6, IMP=Y, TYP=SEQ, OPT=Y);/* DefaultCtxtName */
      282    16404    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 3);
      283    16405                        %SCAN( LVL=4, TAG=C0, IMP=Y, TYP=OBJID,
      284    16406                                LEN=20, VAL=ABS$);  /* AbsSynName */
      285    16503                        %SCAN( LVL=4, TAG=C1, IMP=Y, TYP=OBJID,
      286    16504                                LEN=20, VAL=TFR$);  /* TfrSynName */
      287    16601    3                   CMAP.ABSCTXTID(0) = 0;
      288    16602    3                   CMAP.TFRCTXTID(0) = 0;
      289    16603    3   CP_DFLT_ABS:
      290    16604    4                   DO J = 1 TO XSP_ABSLIST.COUNT(0);
      291    16605    4                       TMP$ = XSP_ABSLIST.CTXT$( J);
      292    16606    4                       IF TMP$ ~= ADDR( NIL) AND
      293    16607    4                               ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      294    16608    5                               ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      295    16609    5                           CMAP.ABSCTXTID(0) = J;
      296    16610    5                           PCTX.DFLCTXTID = J;
      297    16611    5                           EXIT CP_DFLT_ABS;
      298    16612    5                           END;
      299    16613    4                       END;
      300    16614    3   CP_DFLT_TFR:
      301    16615    4                   DO J = 1 TO XSP_TFRLIST.COUNT(0);
      302    16616    4                       TMP$ = XSP_TFRLIST.CTXT$( J);
      303    16617    4                       IF TMP$ ~= ADDR( NIL) AND
      304    16618    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      305    16619    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      306    16620    5                           CMAP.TFRCTXTID(0) = J;
      307    16621    5                           EXIT CP_DFLT_TFR;
      308    16622    5                           END;
      309    16623    4                       END;
      310    16624    3                   IF CMAP.ABSCTXTID(0) = 0 OR CMAP.TFRCTXTID(0) = 0 THEN
      311    16625    3                       CMAP.RESULT(0) = %XSP_RSLT_PREJECT;
      312    16626    3                   ELSE
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:10   
      313    16627    3                       CMAP.RESULT(0) = %XSP_RSLT_ACCEPT;
      314    16628    3                   CMAP.STATE(0) = %XSP_CMAP_RMTDEF;
      315    16629    3                   CMAP.PEERCTXTID(0) = 0;
      316    16630    3                   XSP$CONNECT.DFLTRSLT = CMAP.RESULT(0);
      317    16631    3                   VBLK.DEFBITS(0) = %TRUE;
      318    16632    3                   END;
      319    16633    2               BTMP = '000000000000'O;
      320    16634                    %SCAN( LVL=3, TAG=C8, IMP=Y, TYP=BITSTR, OPT=Y,
      321    16635                            LEN=2, VAL=BTMP);  /* PresRequirements */
      322    16732    2               XSP$CONNECT.PFU = BTMP;
      323    16733    2               BTMP = '000000000000'O;
      324    16734                    %SCAN( LVL=3, TAG=C9, IMP=Y, TYP=BITSTR, OPT=Y,
      325    16735                            LEN=11, VAL=BTMP); /* UserSessionRequirements */
      326    16832    2               XSP$CONNECT.SFU = BTMP;
      327    16833    2               DATALVL = 3;
      328    16834        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:11   
      329    16835        /*****************************************************************************
      330    16836        *
      331    16837        *       SCONCNF --> CPA or CPR
      332    16838        *
      333    16839        *****************************************************************************/
      334    16840    2           CASE( %XSS_FNC_SCONCNF#);  /* should be a CPA or CPR PPDU */
      335    16841    2               XSP$CONNECT = XSS$CONNECT;
      336    16842    2               XSP$CONNECT.FNC = %XSP_FNC_PCONCNF#;
      337    16843    2               XSP$CONNECT.CALLING$ = XSP_SRCADDR$;
      338    16844    2               XSP$CONNECT.RESPONDING$ = XSP_DSTADDR$;
      339    16845    2               XSP$CONNECT.CTXT$ = XSP_TMPCTXT$;
      340    16846    3               IF ITEMLIST.X.TAG(1) = %TAGSET THEN DO;
      341    16847    3                   VBLK.EVENT = %XSP_PEV_CPA;
      342    16848                        %SCAN( LVL=1, TYP=SET);  /* CPA */
      343    16945                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SET);  /* ModeSelector */
      344    17042    3                   UTMP = 0;
      345    17043                        %SCAN( LVL=3, TAG=C0, TYP=INTG,
      346    17044                                LEN=1, VAL=UTMP);
      347    17141    3                   IF UTMP ~= 1 THEN
      348    17142    3                       ALTRETURN;
      349    17143                        %SCAN( LVL=2, TAG=C2, IMP=Y, TYP=SEQ, OPT=Y);
      350    17240    3                   BTMP = '000000000000'O;
      351    17241                        %SCAN( LVL=3, TAG=C0, IMP=Y, TYP=BITSTR, OPT=Y,
      352    17242                                LEN=1, VAL=BTMP);  /* ProtocolVersion */
      353    17339    3                   IF BTMP ~= '1'B THEN
      354    17340    3                       ALTRETURN;
      355    17341    3                   PSAP$ = ADDR( XSP$CONNECT.RESPONDING$->XSC$ADDRESS.PSAP);
      356    17342                        %SCAN( LVL=3, TAG=C3, IMP=Y, TYP=OCTETSTR, OPT=Y,
      357    17343                                LEN=224, VAL="PSAP.TXT"); /* RespondingPresSelector */
      358    17440                        %SCAN( LVL=3, TAG=C5, IMP=Y, TYP=SEQOF, OPT=Y);
             17440                            /* PresCtxtDefResultList */
      359    17537    3                   I = 1;
      360    17538    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 3);
      361    17539                            %SCAN( LVL=4, TYP=SEQ);
      362    17636    4                       TEMP = 0;
      363    17637                            %SCAN( LVL=5, TAG=C0, IMP=Y, TYP=INTG,
      364    17638                                    LEN=4, VAL=TEMP);  /* Result */
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:12   
      365    17735                            %SCAN( LVL=5, TAG=C1, IMP=Y, TYP=OBJID,
      366    17736                                    LEN=20, VAL=TFR$);  /* TfrSynName */
      367    17833    4                       UTMP = 0;
      368    17834                            %SCAN( LVL=5, TAG=C2, IMP=Y, TYP=INTG,
      369    17835                                    LEN=4, VAL=UTMP);  /* ProviderReason */
      370    17932    4   CPA_CTXT_TFR:
      371    17933    5                       DO J = 1 TO XSP_TFRLIST.COUNT(0);
      372    17934    5                           TMP$ = XSP_TFRLIST.CTXT$( J);
      373    17935    5                           IF TMP$ ~= ADDR( NIL) AND
      374    17936    5                                   TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      375    17937    6                                   TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      376    17938    7                               DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEF);
      377    17939    7                                   I = I + 1;
      378    17940    7                                   IF I > %XSP_MAX_CTXTID THEN
      379    17941    7                                       GOTO SCANERR;
      380    17942    7                                   END;
      381    17943    6                               IF CMAP.TFRCTXTID( I) ~= J THEN
      382    17944    6                                   GOTO SCANERR;
      383    17945    6                               CMAP.RESULT( I) = TEMP;
      384    17946    6                               CMAP.REASON( I) = UTMP;
      385    17947    6                               EXIT CPA_CTXT_TFR;
      386    17948    6                               END;
      387    17949    5                           END;
      388    17950    4                       END;
      389    17951    3                   BTMP = '000000000000'O;
      390    17952                        %SCAN( LVL=3, TAG=C8, IMP=Y, TYP=BITSTR, OPT=Y,
      391    17953                                LEN=2, VAL=BTMP);  /* PresRequirements */
      392    18050    3                   XSP$CONNECT.PFU = BTMP;
      393    18051    3                   BTMP = '000000000000'O;
      394    18052                        %SCAN( LVL=3, TAG=C9, IMP=Y, TYP=BITSTR, OPT=Y,
      395    18053                                LEN=11, VAL=BTMP);  /* UserSessionRequirements */
      396    18150    3                   XSP$CONNECT.SFU = BTMP;
      397    18151    3                   DATALVL = 3;
      398    18152    3                   EXIT SFNCCASE;
      399    18153    3                   END;
      400    18154    3               IF ITEMLIST.X.TAG(1) = %TAGSEQ THEN DO;
      401    18155    3                   VBLK.EVENT = %XSP_PEV_CPR;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:13   
      402    18156                        %SCAN( LVL=1, TYP=SEQ);  /* CPR */
      403    18253    3                   BTMP = '000000000000'O;
      404    18254                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=BITSTR, OPT=Y,
      405    18255                                LEN=1, VAL=BTMP);  /* ProtocolVersion */
      406    18352    3                   IF BTMP ~= '1'B THEN
      407    18353    3                       ALTRETURN;
      408    18354    3                   PSAP$ = ADDR( XSP$CONNECT.RESPONDING$->XSC$ADDRESS.PSAP);
      409    18355                        %SCAN( LVL=2, TAG=C3, IMP=Y, TYP=OCTETSTR, OPT=Y,
      410    18356                                LEN=224, VAL="PSAP.TXT"); /* RespondingPresSelector */
      411    18453                        %SCAN( LVL=2, TAG=C5, IMP=Y, TYP=SEQOF, OPT=Y);
             18453                            /* PresCtxtDefResultList */
      412    18550    3                   I = 1;
      413    18551    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      414    18552                            %SCAN( LVL=3, TYP=SEQ);
      415    18649    4                       TEMP = 0;
      416    18650                            %SCAN( LVL=4, TAG=C0, IMP=Y, TYP=INTG,
      417    18651                                    LEN=4, VAL=TEMP);  /* Result */
      418    18748                            %SCAN( LVL=4, TAG=C1, IMP=Y, TYP=OBJID,
      419    18749                                    LEN=20, VAL=TFR$);  /* TfrSynName */
      420    18846    4                       UTMP = 0;
      421    18847                            %SCAN( LVL=4, TAG=C2, IMP=Y, TYP=INTG,
      422    18848                                    LEN=4, VAL=UTMP);  /* ProviderReason */
      423    18945    4   CPR_CTXT_TFR:
      424    18946    5                       DO J = 1 TO XSP_TFRLIST.COUNT(0);
      425    18947    5                           TMP$ = XSP_TFRLIST.CTXT$( J);
      426    18948    5                           IF TMP$ ~= ADDR( NIL) AND
      427    18949    5                                   TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      428    18950    6                                   TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      429    18951    7                               DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEF);
      430    18952    7                                   I = I + 1;
      431    18953    7                                   IF I > %XSP_MAX_CTXTID THEN
      432    18954    7                                       GOTO SCANERR;
      433    18955    7                                   END;
      434    18956    6                               IF CMAP.TFRCTXTID( I) ~= J THEN
      435    18957    6                                   GOTO SCANERR;
      436    18958    6                               CMAP.RESULT( I) = TEMP;
      437    18959    6                               CMAP.REASON( I) = UTMP;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:14   
      438    18960    6                               EXIT CPR_CTXT_TFR;
      439    18961    6                               END;
      440    18962    5                           END;
      441    18963    4                       END;
      442    18964    3                   UTMP = 0;
      443    18965                        %SCAN( LVL=2, TAG=C10, IMP=Y, TYP=INTG, OPT=Y,
      444    18966                                LEN=4, VAL=UTMP);  /* ProviderReason */
      445    19063    3                   XSP$CONNECT.REASON = UTMP;
      446    19064    3                   DATALVL = 2;
      447    19065    3                   EXIT SFNCCASE;
      448    19066    3                   END;
      449    19067    2               GOTO SCANERR;
      450    19068        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:15   
      451    19069        /*****************************************************************************
      452    19070        *
      453    19071        *       SDATIND --> TD
      454    19072        *
      455    19073        *****************************************************************************/
      456    19074    2           CASE( %XSS_FNC_SDATIND#);  /* should be a TD PPDU */
      457    19075    2               XSP$DATA = XSP_DATA;
      458    19076    2               XSP$DATA.FNC = %XSP_FNC_PDATIND#;
      459    19077    2               DATALVL = 1;
      460    19078        /*****************************************************************************
      461    19079        *
      462    19080        *       SEXPIND --> TE
      463    19081        *
      464    19082        *****************************************************************************/
      465    19083    2           CASE( %XSS_FNC_SEXPIND#);  /* should be a TE PPDU */
      466    19084    2               XSP$EXPEDITED_DATA = XSP_EXPEDITED_DATA;
      467    19085    2               XSP$EXPEDITED_DATA.FNC = %XSP_FNC_PEXPIND#;
      468    19086    2               DATALVL = 1;
      469    19087        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:16   
      470    19088        /*****************************************************************************
      471    19089        *
      472    19090        *       SRSXIND --> RS
      473    19091        *
      474    19092        *****************************************************************************/
      475    19093    2           CASE( %XSS_FNC_SRSXIND#);  /* should be an RS PPDU */
      476    19094    2               XSP$RESYNCHRONIZE = XSP_RESYNCHRONIZE;
      477    19095    2               XSP$RESYNCHRONIZE.FNC = %XSP_FNC_PRSXIND#;
      478    19096                    %SCAN( LVL=1, TYP=SEQ);  /* RS */
      479    19193                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);  /* PresCtxtIdentList */
      480    19290    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      481    19291                        %SCAN( LVL=3, TYP=SEQ);
      482    19388    3                   UTMP = 0;
      483    19389                        %SCAN( LVL=4, TYP=INTG,
      484    19390                                LEN=4, VAL=UTMP);  /* PresCtxtIdent */
      485    19487                        %SCAN( LVL=4, TYP=OBJID,
      486    19488                                LEN=20, VAL=TFR$);  /* TfrSynName */
      487    19585    3   RS_CTXT_TFR:
      488    19586    4                   DO I = 1 TO %XSP_MAX_CTXTID;
      489    19587    4                       TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));
      490    19588    4                       IF CMAP.PEERCTXTID( I) = UTMP AND
      491    19589    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      492    19590    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      493    19591    5                           VBLK.DEFBITS( I) = %TRUE;
      494    19592    5                           EXIT RS_CTXT_TFR;
      495    19593    5                           END;
      496    19594    4                       END;
      497    19595    3                   END;
      498    19596    2               DATALVL = 2;
      499    19597        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:17   
      500    19598        /*****************************************************************************
      501    19599        *
      502    19600        *       SRSXCNF --> RSA
      503    19601        *
      504    19602        *****************************************************************************/
      505    19603    2           CASE( %XSS_FNC_SRSXCNF#);  /* should be an RSA PPDU */
      506    19604    2               XSP$RESYNCHRONIZE = XSP_RESYNCHRONIZE;
      507    19605    2               XSP$RESYNCHRONIZE.FNC = %XSP_FNC_PRSXCNF#;
      508    19606                    %SCAN( LVL=1, TYP=SEQ);  /* RSA */
      509    19703                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);  /* PresCtxtIdentList */
      510    19800    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      511    19801                        %SCAN( LVL=3, TYP=SEQ);
      512    19898    3                   UTMP = 0;
      513    19899                        %SCAN( LVL=4, TYP=INTG,
      514    19900                                LEN=4, VAL=UTMP);  /* PresCtxtIdent */
      515    19997                        %SCAN( LVL=4, TYP=OBJID,
      516    19998                                LEN=20, VAL=TFR$);  /* TfrSynName */
      517    20095    3   RSA_CTXT_TFR:
      518    20096    4                   DO I = 1 TO %XSP_MAX_CTXTID;
      519    20097    4                       TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));
      520    20098    4                       IF CMAP.PEERCTXTID( I) = UTMP AND
      521    20099    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      522    20100    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      523    20101    5                           VBLK.DEFBITS( I) = %TRUE;
      524    20102    5                           EXIT RSA_CTXT_TFR;
      525    20103    5                           END;
      526    20104    4                       END;
      527    20105    3                   END;
      528    20106    2               DATALVL = 2;
      529    20107        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:18   
      530    20108        /*****************************************************************************
      531    20109        *
      532    20110        *       STYDIND --> AC, ACA, or TTD
      533    20111        *
      534    20112        *****************************************************************************/
      535    20113    2           CASE( %XSS_FNC_STYDIND#);  /* should be an AC, ACA, or TTD PPDU */
      536    20114    3               IF ITEMLIST.X.TAG(1) = %TAGC0 THEN DO;
      537    20115    3                   XSP$ALTER_CONTEXT = XSP_ALTER_CONTEXT;
      538    20116    3                   XSP$ALTER_CONTEXT.FNC = %XSP_FNC_PALTIND#;
      539    20117    3                   XSP$ALTER_CONTEXT.CTXT$ = XSP_TMPCTXT$;
      540    20118    3                   VBLK.EVENT = %XSP_PEV_AC;
      541    20119                        %SCAN( LVL=1, TAG=C0, IMP=Y, TYP=SEQ);  /* AC */
      542    20216                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);
             20216                            /* PresCtxtAddList */
      543    20313    3                   I = 0;
      544    20314    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      545    20315                            %SCAN( LVL=3, TYP=SEQ);
      546    20412    4                       UTMP = 0;
      547    20413                            %SCAN( LVL=4, TYP=INTG,
      548    20414                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */
      549    20511                            %SCAN( LVL=4, TYP=OBJID,
      550    20512                                    LEN=20, VAL=ABS$);  /* AbsSynName */
      551    20609                            %SCAN( LVL=4, TYP=SEQOF);
      552    20706                            /*N* we only support one transfer syntax at a time */
      553    20707                            %SCAN( LVL=5, TYP=OBJID,
      554    20708                                    LEN=20, VAL=TFR$);  /* TfrSynName */
      555    20805    4                       I = I + 1;
      556    20806    4                       CLST.COUNT(0) = I;
      557    20807    4                       CMAP.ABSCTXTID( I) = 0;
      558    20808    4                       CMAP.TFRCTXTID( I) = 0;
      559    20809    4   AC_CTXT_ABS:
      560    20810    5                       DO J = 1 TO XSP_ABSLIST.COUNT(0);
      561    20811    5                           TMP$ = XSP_ABSLIST.CTXT$( J);
      562    20812    5                           IF TMP$ ~= ADDR( NIL) AND
      563    20813    5                                   ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      564    20814    6                                   ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      565    20815    6                               CMAP.ABSCTXTID( I) = J;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:19   
      566    20816    6                               EXIT AC_CTXT_ABS;
      567    20817    6                               END;
      568    20818    5                           END;
      569    20819    4   AC_CTXT_TFR:
      570    20820    5                       DO J = 1 TO XSP_TFRLIST.COUNT(0);
      571    20821    5                           TMP$ = XSP_TFRLIST.CTXT$( J);
      572    20822    5                           IF TMP$ ~= ADDR( NIL) AND
      573    20823    5                                   ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      574    20824    6                                   ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      575    20825    6                               CMAP.TFRCTXTID( I) = J;
      576    20826    6                               EXIT AC_CTXT_TFR;
      577    20827    6                               END;
      578    20828    5                           END;
      579    20829    4                       IF CMAP.ABSCTXTID( I) = 0 OR CMAP.TFRCTXTID( I) = 0 THEN
      580    20830    4                           CMAP.RESULT( I) = %XSP_RSLT_PREJECT;
      581    20831    4                       ELSE
      582    20832    4                           CMAP.RESULT( I) = %XSP_RSLT_ACCEPT;
      583    20833    4                       CMAP.STATE( I) = %XSP_CMAP_RMTDEF;
      584    20834    4                       CMAP.PEERCTXTID( I) = UTMP;
      585    20835    4                       CLST.RESULT( I) = CMAP.RESULT( I);
      586    20836    4                       VBLK.DEFBITS( I) = %TRUE;
      587    20837    4                       END;
      588    20838                        %SCAN( LVL=2, TAG=C1, IMP=Y, TYP=SEQOF, OPT=Y);
             20838                            /* PresCtxtDelList */
      589    20935    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      590    20936    4                       UTMP = 0;
      591    20937                            %SCAN( LVL=3, TYP=INTG,
      592    20938                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */
      593    21035    4   AC_CTXT_DEL:
      594    21036    5                       DO I = 1 TO %XSP_MAX_CTXTID;
      595    21037    6                           IF CMAP.PEERCTXTID( I) = UTMP THEN DO;
      596    21038    6                               CMAP.STATE( I) = %XSP_CMAP_RMTDEL;
      597    21039    6                               VBLK.DELBITS( I) = %TRUE;
      598    21040    6                               EXIT AC_CTXT_DEL;
      599    21041    6                               END;
      600    21042    5                           END;
      601    21043    4                       END;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:20   
      602    21044    3                   DATALVL = 2;
      603    21045    3                   EXIT SFNCCASE;
      604    21046    3                   END;
      605    21047    3               IF ITEMLIST.X.TAG(1) = %TAGC1 THEN DO;
      606    21048    3                   XSP$ALTER_CONTEXT = XSP_ALTER_CONTEXT;
      607    21049    3                   XSP$ALTER_CONTEXT.FNC = %XSP_FNC_PALTCNF#;
      608    21050    3                   XSP$ALTER_CONTEXT.CTXT$ = XSP_TMPCTXT$;
      609    21051    3                   VBLK.EVENT = %XSP_PEV_ACA;
      610    21052                        %SCAN( LVL=1, TAG=C1, IMP=Y, TYP=SEQ);  /* ACA */
      611    21149                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);
             21149                            /* PresCtxtAddResultList */
      612    21246    3                   I = 1;
      613    21247    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      614    21248                            %SCAN( LVL=3, TYP=SEQ);
      615    21345    4                       TEMP = 0;
      616    21346                            %SCAN( LVL=4, TAG=C0, IMP=Y, TYP=INTG,
      617    21347                                    LEN=4, VAL=TEMP);  /* Result */
      618    21444                            %SCAN( LVL=4, TAG=C1, IMP=Y, TYP=OBJID,
      619    21445                                    LEN=20, VAL=TFR$);  /* TfrSynName */
      620    21542    4                       UTMP = 0;
      621    21543                            %SCAN( LVL=4, TAG=C2, IMP=Y, TYP=INTG,
      622    21544                                    LEN=4, VAL=UTMP);  /* ProviderReason */
      623    21641    5                       DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEF);
      624    21642    5                           I = I + 1;
      625    21643    5                           IF I > %XSP_MAX_CTXTID THEN
      626    21644    5                               GOTO SCANERR;
      627    21645    5                           END;
      628    21646    4                       TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));
      629    21647    4                       IF TMP$ ~= ADDR( NIL) AND
      630    21648    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      631    21649    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      632    21650    5                           CMAP.RESULT( I) = TEMP;
      633    21651    5                           CMAP.REASON( I) = UTMP;
      634    21652    5                           END;
      635    21653    4                       ELSE
      636    21654    4                           GOTO SCANERR;
      637    21655    4                       END;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:21   
      638    21656                        %SCAN( LVL=2, TAG=C1, IMP=Y, TYP=SEQOF, OPT=Y);
             21656                            /* PresCtxtDelResultList */
      639    21753    3                   I = 1;
      640    21754    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      641    21755    4                       UTMP = 0;
      642    21756                            %SCAN( LVL=3, TYP=INTG,
      643    21757                                    LEN=4, VAL=UTMP);  /* Result */
      644    21854    5                       DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEL);
      645    21855    5                           I = I + 1;
      646    21856    5                           IF I > %XSP_MAX_CTXTID THEN
      647    21857    5                               GOTO SCANERR;
      648    21858    5                           END;
      649    21859    4                       CMAP.RESULT( I) = UTMP;
      650    21860    4                       END;
      651    21861    3                   DATALVL = 2;
      652    21862    3                   EXIT SFNCCASE;
      653    21863    3                   END;
      654    21864                    /* otherwise, this should be a TTD PPDU */
      655    21865    2               XSP$TYPED_DATA = XSS$TYPED_DATA;
      656    21866    2               XSP$TYPED_DATA.FNC = %XSP_FNC_PTYDIND#;
      657    21867    2               VBLK.EVENT = %XSP_PEV_TTD;
      658    21868    2               DATALVL = 1;
      659    21869        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:22   
      660    21870        /*****************************************************************************
      661    21871        *
      662    21872        *       SUABIND --> ARP or ARU
      663    21873        *
      664    21874        *****************************************************************************/
      665    21875    2           CASE( %XSS_FNC_SUABIND#);  /* should be an ARP or ARU PPDU */
      666    21876    3               IF ITEMLIST.X.TAG(1) = %TAGC0 THEN DO;
      667    21877    3                   XSP$U_ABORT = XSS$U_ABORT;
      668    21878    3                   XSP$U_ABORT.FNC = %XSP_FNC_PUABIND#;
      669    21879    3                   VBLK.EVENT = %XSP_PEV_ARU;
      670    21880                        %SCAN( LVL=1, TAG=C0, IMP=Y, TYP=SEQ);  /* ARU */
      671    21977                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);
             21977                            /* PresCtxtIdentList */
      672    22074    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);
      673    22075                            %SCAN( LVL=3, TYP=SEQ);
      674    22172    4                       UTMP = 0;
      675    22173                            %SCAN( LVL=4, TYP=INTG,
      676    22174                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */
      677    22271                            %SCAN( LVL=4, TYP=OBJID,
      678    22272                                    LEN=20, VAL=TFR$);  /* TfrSynName */
      679    22369    4   ARU_CTXT_TFR:
      680    22370    5                       DO I = 1 TO %XSP_MAX_CTXTID;
      681    22371    5                           TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));
      682    22372    5                           IF CMAP.PEERCTXTID( I) = UTMP AND
      683    22373    5                                   TMP$ ~= ADDR( NIL) AND
      684    22374    5                                   TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      685    22375    6                                   TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;
      686    22376    6                               VBLK.DEFBITS( I) = %TRUE;
      687    22377    6                               EXIT ARU_CTXT_TFR;
      688    22378    6                               END;
      689    22379    5                           END;
      690    22380    4                       END;
      691    22381    3                   DATALVL = 2;
      692    22382    3                   EXIT SFNCCASE;
      693    22383    3                   END;
      694    22384                    /* otherwise, this should be an ARP PPDU */
      695    22385    2               XSP$P_ABORT = XSS$P_ABORT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:23   
      696    22386    2               XSP$P_ABORT.FNC = %XSP_FNC_PPABIND#;
      697    22387    2               VBLK.EVENT = %XSP_PEV_ARP;
      698    22388                    %SCAN( LVL=1, TYP=SEQ);  /* ARP */
      699    22485    2               UTMP = 0;
      700    22486                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=INTG, OPT=Y,
      701    22487                            LEN=4, VAL=UTMP);  /* AbortReason */
      702    22584    2               XSP$P_ABORT.REASON = UTMP;
      703    22585    2               UTMP = 0;
      704    22586                    %SCAN( LVL=2, TAG=C1, IMP=Y, TYP=INTG, OPT=Y,
      705    22587                            LEN=4, VAL=UTMP);  /* EventIdent */
      706    22684    2               ;  /*N* what to do with EventIdent ? */
      707    22685        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:24   
      708    22686        /*****************************************************************************
      709    22687        *
      710    22688        *       Illegal Session function --> error
      711    22689        *
      712    22690        *****************************************************************************/
      713    22691    2           CASE( ELSE);
      714    22692                    /* this Session function doesn't have a PPDU for UserData */
      715    22693    2               GOTO SCANERR;
      716    22694    2           END;
      717    22695    2       IF DATALVL > 0 AND ITEMCUR < ITEMNUM THEN DO;
      718    22696    2           XSP_DATANUM = 0;
      719    22697    3           IF ITEMLIST.X.TAG( ITEMCUR) = %TAGA0 THEN DO;
      720    22698                    %SCAN( LVL=DATALVL, TAG=A0, IMP=Y, TYP=OCTETSTR, OPT=Y,
      721    22699                            LEN=262143, VAL=NIL);  /*N* SimplyEncodedData */
      722    22796    3               XSP_DATABUF$( XSP_DATANUM) = SCANITEM.P;
      723    22797    3               XSP_DATASIZE( XSP_DATANUM) = SCANITEM.X.LEN;
      724    22798    3               XSP_DATACTXT( XSP_DATANUM) = PCTX.DFLCTXTID;
      725    22799    3               VBLK.DATBITS( PCTX.DFLCTXTID) = %TRUE;
      726    22800    3               XSP_DATANUM = XSP_DATANUM + 1;
      727    22801    3               END;
      728    22802    2           ELSE
      729    22803    3               IF ITEMLIST.X.TAG( ITEMCUR) = %TAGA1 THEN DO;
      730    22804                        %SCAN( LVL=DATALVL, TAG=A1, IMP=Y, TYP=SEQOF, OPT=Y);
             22804                            /* FullyEncodedData */
      731    22901    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > DATALVL);
      732    22902    4                       DATALVL = DATALVL + 1;
      733    22903                            %SCAN( LVL=DATALVL, TYP=OBJID, OPT=Y,
      734    22904                                    LEN=20, VAL=TFR$);  /* TfrSynName */
      735    23001    4                       UTMP = 0;
      736    23002                            %SCAN( LVL=DATALVL, TYP=INTG,
      737    23003                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */
      738    23100                            /*N* for now, assume OCTETSTRING */
      739    23101                            %SCAN( LVL=DATALVL, TAG=C1, IMP=Y, TYP=OCTETSTR,
      740    23102                                    LEN=262143, VAL=NIL);  /*N* the data */
      741    23199    4                       XSP_DATABUF$( XSP_DATANUM) = SCANITEM.P;
      742    23200    4                       XSP_DATASIZE( XSP_DATANUM) = SCANITEM.X.LEN;
      743    23201    4                       XSP_DATACTXT( XSP_DATANUM) = 0;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:25   
      744    23202    5                       DO I = 1 TO %XSP_MAX_CTXTID;
      745    23203    5                           IF CMAP.STATE( I) = %XSP_CMAP_ACTIVE AND
      746    23204    6                                   UTMP = CMAP.PEERCTXTID( I) THEN DO;
      747    23205    6                               XSP_DATACTXT( XSP_DATANUM) = I;
      748    23206    6                               VBLK.DATBITS( I) = %TRUE;
      749    23207    6                               EXIT;
      750    23208    6                               END;
      751    23209    5                           END;
      752    23210    4                       XSP_DATANUM = XSP_DATANUM + 1;
      753    23211    4                       DATALVL = DATALVL - 1;
      754    23212    4                       END;
      755    23213    3                   END;
      756    23214    2               ELSE
      757    23215    2                   GOTO SCANERR;
      758    23216    2           END;
      759    23217    1       RETURN;
      760    23218    1   SCANERR:
      761    23219            /* An error occurred while decoding the PPDU */
      762    23220    1       ALTRETURN;
      763    23221        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:26   
      764    23222        /*I*    NAME:   SCAN
      765    23223
      766    23224                SCAN is called for each item of the PPDU expected to be seen.  The
      767    23225                contents of SCANITEM are compared with the current item.  If they
      768    23226                match, the associated value is moved from the current item to the
      769    23227                VAL field indicated in SCANITEM.  Otherwise, heuristics are used to
      770    23228                figure out if the PPDU is in error or we need to skip over optional
      771    23229                items not supplied in the PPDU.
      772    23230        */
      773    23231    1   SCAN: PROC ALTRET;
      774    23232
      775    23233    2       IF ITEMCUR > ITEMNUM THEN
      776    23234                /* fell off the end of the PPDU */
      777    23235    2           ALTRETURN;
      778    23236            /* compare LVLs */
      779    23237    2       IF ITEMLIST.X.LVL( ITEMCUR) < SCANITEM.X.LVL THEN
      780    23238    2           RETURN;  /* skip ahead in order to resynchronize levels */
      781    23239    3       IF ITEMLIST.X.LVL( ITEMCUR) = SCANITEM.X.LVL THEN DO;
      782    23240                /* compare TAGs */
      783    23241    4           IF ITEMLIST.X.TAG( ITEMCUR) = SCANITEM.X.TAG THEN DO;
      784    23242                    /* O.K. We have a match!  Now we move the value part of the
      785    23243                       matched tag-length-value item to the given buffer. */
      786    23244    5               DO CASE( SCANITEM.X.TYP);
      787    23245    5                   CASE( %XSP_TYP_NONE,
      788    23246    5                         %XSP_TYP_NULL,
      789    23247    5                         %XSP_TYP_EXTRN,
      790    23248    5                         %XSP_TYP_SEQ,
      791    23249    5                         %XSP_TYP_SET,
      792    23250    5                         %XSP_TYP_SEQOF,
      793    23251    5                         %XSP_TYP_SETOF);
      794    23252    5                       ;  /* no need to do anything for these types */
      795    23253    5                   CASE( %XSP_TYP_BOOL);
      796    23254    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);
      797    23255    5                       DSTLEN = SCANITEM.X.LEN;
      798    23256    5                       IF SRCLEN > DSTLEN THEN
      799    23257    5                           ALTRETURN;  /* source is too long for buffer */
      800    23258    5                       SRC$ = ITEMLIST.P( ITEMCUR);
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:27   
      801    23259    5                       BDST$ = SCANITEM.P;
      802    23260    5                       TEMP = ASCBIN( SUBSTR( SRC$->SRCBYTES, 0, 1));
      803    23261    5                       IF TEMP = 0 THEN
      804    23262    5                           BDST$->BIT1 = '0'B;
      805    23263    5                       ELSE
      806    23264    5                           BDST$->BIT1 = '1'B;
      807    23265    5                   CASE( %XSP_TYP_INTG);
      808    23266    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);
      809    23267    5                       DSTLEN = SCANITEM.X.LEN;
      810    23268    5                       IF SRCLEN > DSTLEN THEN
      811    23269    5                           ALTRETURN;  /* source is too long for buffer */
      812    23270    5                       BSRC$ = ITEMLIST.P( ITEMCUR);
      813    23271    5                       BDST$ = PINCRB( SCANITEM.P, 4 + 8*(4-SRCLEN));
      814    23272    6                       DO I = 1 TO SRCLEN;
      815    23273    6                           BDST$->BIT8 = PINCRB( BSRC$, 1)->BIT8;
      816    23274    6                           BDST$ = PINCRB( BDST$, 8);
      817    23275    6                           BSRC$ = PINCRC( BSRC$, 1);
      818    23276    6                           END;
      819    23277    5                   CASE( %XSP_TYP_BITSTR);
      820    23278    5                       SRC$ = ITEMLIST.P( ITEMCUR);
      821    23279    5                       TEMP = ASCBIN( SUBSTR( SRC$->SRCBYTES, 0, 1)); /* slack */
      822    23280    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);  /* byte-length */
      823    23281    5                       SRCLEN = ( 8-TEMP) + ( SRCLEN-2)*8;  /* bit-length */
      824    23282    5                       DSTLEN = SCANITEM.X.LEN;
      825    23283                            /* NOTE: SRCLEN AND DSTLEN CONTAIN LENGTHS IN *BITS* */
      826    23284    5                       IF SRCLEN > DSTLEN THEN
      827    23285    5                           ALTRETURN;  /* source is too long for buffer */
      828    23286                            /* move octets from source to destination */
      829    23287    5                       BSRC$ = SRC$;
      830    23288    5                       BDST$ = SCANITEM.P;
      831    23289    5                       TEMP = ( DSTLEN + 8) / 9;
      832    23290    6                       DO I = 1 TO TEMP;
      833    23291    6                           BSRC$ = PINCRC( BSRC$, 1);
      834    23292    6                           BDST$->BIT8 = PINCRB( BSRC$, 1)->BIT8;
      835    23293    6                           BDST$ = PINCRB( BDST$, 8);
      836    23294    6                           END;
      837    23295    5                   CASE( %XSP_TYP_OCTETSTR,
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:28   
      838    23296    5                         %XSP_TYP_NUMSTR,
      839    23297    5                         %XSP_TYP_PRNTSTR,
      840    23298    5                         %XSP_TYP_TELSTR,
      841    23299    5                         %XSP_TYP_VIDSTR,
      842    23300    5                         %XSP_TYP_IA5STR,
      843    23301    5                         %XSP_TYP_GRFSTR,
      844    23302    5                         %XSP_TYP_VISSTR /* == %XSP_TYP_ISO646STR */,
      845    23303    5                         %XSP_TYP_GENSTR);
      846    23304    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);
      847    23305    5                       DSTLEN = SCANITEM.X.LEN;
      848    23306    5                       IF SRCLEN > DSTLEN THEN
      849    23307    5                           ALTRETURN;  /* source is too long for buffer */
      850    23308    5                       DSTLEN = MINIMUM( DSTLEN, SRCLEN);
      851    23309    6                       IF SCANITEM.P = ADDR( NIL) THEN DO;
      852    23310                                /* don't copy data; just point at it in the PPDU */
      853    23311    6                           SCANITEM.P = ITEMLIST.P( ITEMCUR);
      854    23312    6                           SCANITEM.X.LEN = DSTLEN;
      855    23313    6                           END;
      856    23314    5                       ELSE
      857    23315    5                           SCANITEM.P->DSTBYTES = ITEMLIST.P( ITEMCUR)->SRCBYTES;
      858    23316    5                   CASE( %XSP_TYP_OBJID,
      859    23317    5                         %XSP_TYP_OBJDSCR);
      860    23318                            /*N* convert encoding to num-num-num form */
      861    23319    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);
      862    23320    5                       SCANITEM.P = PINCRC( SCANITEM.P, -2);
      863    23321    5                       SCANITEM.P->CTXT.LEN = SRCLEN;
      864    23322    5                       SCANITEM.P->CTXT.TXT = ITEMLIST.P( ITEMCUR)->SRCBYTES;
      865    23323    5                   CASE( %XSP_TYP_UTCTIM,
      866    23324    5                         %XSP_TYP_GENTIM);
      867    23325                            /*N* convert encoding to UTS value, someday */
      868    23326    5                   CASE( ELSE);
      869    23327                            /* bad SCANITEM.TYP */
      870    23328    5                       ALTRETURN;
      871    23329    5                   END;
      872    23330    4               GOTO RET;
      873    23331    4               END;
      874    23332    3           IF SCANITEM.X.OPT = 1 THEN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:29   
      875    23333                    /* looks like this optional item is not present */
      876    23334    3               RETURN;
      877    23335                /* this required item is not present */
      878    23336    3           ALTRETURN;
      879    23337    3           END;
      880    23338            /*N* something's wrong.. don't know what to do yet...... */
      881    23339    2       ALTRETURN;
      882    23340    2   RET:
      883    23341    2       ITEMCUR = ITEMCUR + 1;
      884    23342    2       RETURN;
      885    23343
      886    23344    2       END SCAN;
      887    23345        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:30   
      888    23346        /*I*    NAME:   GETLEN
      889    23347
      890    23348                GETLEN is called to extract the length of the next item of the PDU.
      891    23349                It handles both forms of definite length as well as indefinite length.
      892    23350                The various PDU scan pointers are updated.  The length is stored in
      893    23351                TEMP for use by the main code.
      894    23352        */
      895    23353    1   GETLEN: PROC;
      896    23354
      897    23355    2       TEMP = ASCBIN( SUBSTR( PDU, PDUIDX, 1));
      898    23356    2       PDUIDX = PDUIDX + 1;
      899    23357    2       CURRLEN( DEPTH) = CURRLEN( DEPTH) - 1;
      900    23358    3       IF TEMP = 128 THEN DO;
      901    23359                /* indefinite form */
      902    23360    3           TEMP = -1;
      903    23361    3           RETURN;
      904    23362    3           END;
      905    23363    3       IF TEMP > 128 THEN DO;
      906    23364                /* long form */
      907    23365    3           I = TEMP - 128;
      908    23366    3           CURRLEN( DEPTH) = CURRLEN( DEPTH) - I;
      909    23367    3           TEMP = 0;
      910    23368    4           DO WHILE( I > 0);
      911    23369    4               TEMP = TEMP*256 + ASCBIN( SUBSTR( PDU, PDUIDX, 1));
      912    23370    4               PDUIDX = PDUIDX + 1;
      913    23371    4               I = I - 1;
      914    23372    4               END;
      915    23373    3           END;
      916    23374    2       RETURN;
      917    23375
      918    23376    2       END GETLEN;
      919    23377
      920    23378    1       END XSP$DECODE;
      921    23379        %EOD;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:31   
--  Include file information  --

   XSC_COMMON_M.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   XSP_PRESENTATION_M.:XSA1TOU  is referenced.
   XSP_PRESENTATION_E.:XSA1TOU  is referenced.
   XSP_INTERNAL_M.:XSA1TOU  is referenced.
   XSP_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$DECODE.

   Procedure XSP$DECODE requires 2291 words for executable code.
   Procedure XSP$DECODE requires 118 words of local(AUTO) storage.

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:32   

 Object Unit name= XSP$DECODE                                 File name= XSP$DECODE.:XSA1TOU
 UTS= OCT 01 '97 12:00:12.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    12     14  XSP$DECODE
    1  RoData even  UTS      2      2  XSP$DECODE
    2   Proc  even  none  2291   4363  XSP$DECODE
    3  RoData even  none    33     41  XSP$DECODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  XSP$DECODE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XSS$BUFPTR
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:33   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     XSP_ALTER_CONTEXT                     XSP_CAPABILITY_DATA                   XSP_CONNECT
     XSP_DATA                              XSP_EXPEDITED_DATA                    XSP_RESYNCHRONIZE
     XSP_DATANUM                           XSP_DATABUF$                          XSP_DATACTXT
     XSP_DATASIZE                          XSP_ITEMCNT                           XSP_DSTADDR$
     XSP_SRCADDR$                          XSP_TMPCTXT$                          XSP_ABSLIST
     XSP_TFRLIST

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:34   


        1        1        /*M*    XSP$DECODE      Routines for receiving and decoding a PPDU      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSP$DECODE
        9        9                DESCRIPTION:
       10       10                    This routine handles the decoding of a Presentation PDU that
       11       11                    has been received from the other endpoint.  This is done using
       12       12                    the macros defined in XSP_ASN1_M.  Any User Data supplied in
       13       13                    the PPDU is also decoded with the same macros, according to the
       14       14                    syntax the user supplied.
       15       15        */
       16       16        XSP$DECODE: PROC( VBLK, SFPT$) ALTRET;

     16  2 000000   000000 700200 xent  XSP$DECODE   TSX0  ! X66_AUTO_2
         2 000001   000166 000002                    ZERO    118,2

       17       17        %INCLUDE XSS_SESSION_E;
       18      582        %INCLUDE XSS_SESSION_M;
       19     3225            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       20     6604        %INCLUDE XSP_INTERNAL_E;
       21     6878        %INCLUDE XSP_INTERNAL_M;
       22     7539            %XSP$CTXTMAP( NAME=CMAP, STCLASS="BASED( CMAP$)");
       23     7580            %ENCDECMACS;
       24     7759        %INCLUDE XSP_PRESENTATION_E;
       25     7858        %INCLUDE XSP_PRESENTATION_M;
       26     9344            %XSP$PCTX( NAME=PCTX, STCLASS="BASED( VBLK.CTX$)");
       27     9500            %XSP$PSAP( FPTN=PSAP, STCLASS="BASED( PSAP$)");
       28     9536            %XSP$VBLK( NAME=VBLK, STCLASS="");
       29     9682            %XSP$PRIMITIVES( STCLASS="BASED( VBLK.FPT$)");
       30    11381            %XSP_PRIMITIVES( STCLASS=SYMREF);
       31    13080            %XSP$CTXTLIST( NAME=CLST, STCLASS="BASED( XSP_TMPCTXT$)");
       32    13107            %XSP$CTXTNAME( NAME=CTXT, STCLASS=BASED);
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:35   
       33    13149            %XSP$CTXTNAME( NAME=ABSNAME, STCLASS=STATIC, CTXT='....................');
       34    13191            %XSP$CTXTNAME( NAME=TFRNAME, STCLASS=STATIC, CTXT='....................');
       35    13233        %INCLUDE K_ADDRESS_M;
       36    13736        %INCLUDE XSC_COMMON_M;
       37    14389            %XSC$ADDRESS;
       38    14672        %EQU ITEMMAX = 31;
       39    14673        %EQU MAXDEPTH = 7;
       40    14674        /* in the following TAGxx equates, 32 is added if constructed */
       41    14675        %EQU TAGC0 = (128+32);
       42    14676        %EQU TAGC1 = (129+32);
       43    14677        %EQU TAGA0 = (64);
       44    14678        %EQU TAGA1 = (65+32);
       45    14679        %EQU TAGSEQ = (%XSP_TYP_SEQ+32);
       46    14680        %EQU TAGSET = (%XSP_TYP_SET+32);
       47    14681
       48    14682    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
       49    14683
       50    14684    1       DCL XSP_DATANUM SBIN SYMREF;
       51    14685    1       DCL XSP_DATABUF$(0:%XSP_MAX_DATANUM) PTR SYMREF;
       52    14686    1       DCL XSP_DATACTXT(0:%XSP_MAX_DATANUM) UBIN BYTE SYMREF CALIGNED;
       53    14687    1       DCL XSP_DATASIZE(0:%XSP_MAX_DATANUM) SBIN SYMREF;
       54    14688    1       DCL XSP_ITEMCNT SBIN SYMREF;
       55    14689    1       DCL XSP_ITEMMAX SBIN SYMREF;
       56    14690    1       DCL XSP_DSTADDR$ PTR SYMREF;
       57    14691    1       DCL XSP_SRCADDR$ PTR SYMREF;
       58    14692    1       DCL XSP_TMPCTXT$ PTR SYMREF;
       59    14693    1       DCL 1 XSP_ABSLIST SYMREF,
       60    14694    1            2 CTXT$(0:0) PTR,
       61    14695    1            2 COUNT(0:0) REDEF CTXT$ SBIN;
       62    14696    1       DCL 1 XSP_TFRLIST SYMREF,
       63    14697    1            2 CTXT$(0:0) PTR,
       64    14698    1            2 COUNT(0:0) REDEF CTXT$ SBIN;
       65    14699
       66    14700            %ITEM( NAME=SCANITEM, STCLASS=AUTO);              /* THESE TWO LINES... */
       67    14725            %ITEM( NAME="ITEMLIST(0:%ITEMMAX)", STCLASS=AUTO);/* MUST BE CONTIGUOUS */
       68    14750    1       DCL ABS$ PTR;
       69    14751    1       DCL TFR$ PTR;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:36   
       70    14752    1       DCL SRC$ PTR CALIGNED;
       71    14753    1       DCL BSRC$ PTR UNAL;
       72    14754    1       DCL SRCLEN SBIN;
       73    14755    1       DCL SRCBYTES CHAR( SRCLEN) BASED CALIGNED;
       74    14756    1       DCL DST$ PTR CALIGNED;
       75    14757    1       DCL BDST$ PTR UNAL;
       76    14758    1       DCL DSTLEN SBIN;
       77    14759    1       DCL DSTBYTES CHAR( DSTLEN) BASED CALIGNED;
       78    14760    1       DCL BIT1 BIT(1) BASED UNAL;
       79    14761    1       DCL BIT8 BIT(8) BASED UNAL;
       80    14762    1       DCL BTMP BIT(36);
       81    14763    1       DCL CMAP$ PTR;
       82    14764    1       DCL DATALVL SBIN;
       83    14765    1       DCL DEPTH SBIN;
       84    14766    1       DCL I SBIN;
       85    14767    1       DCL ITEMCUR SBIN;
       86    14768    1       DCL ITEMNUM SBIN;
       87    14769    1       DCL J SBIN;
       88    14770    1       DCL LEN SBIN;
       89    14771    1       DCL PDU$ PTR CALIGNED;
       90    14772    1       DCL PDU CHAR(16384) BASED( PDU$) CALIGNED;
       91    14773    1       DCL PDUIDX SBIN;
       92    14774    1       DCL PSAP$ PTR;
       93    14775    1       DCL SFPT$ PTR;
       94    14776    1       DCL TAG SBIN;
       95    14777    1       DCL 1 TAGX REDEF TAG,
       96    14778    1            2 * BIT(28) UNAL,
       97    14779    1            2 CLASS UBIN(2) UNAL,
       98    14780    1            2 CONSTRUCTED BIT(1) UNAL,
       99    14781    1            2 VALUE UBIN(5) UNAL;
      100    14782    1       DCL TEMP SBIN;
      101    14783    1       DCL TMP$ PTR;
      102    14784    1       DCL UTMP UBIN;
      103    14785    1       DCL 1 TWOZEROES CONSTANT,
      104    14786    1            2 X(0:1) UBIN(9) INIT( 0, 0) CALIGNED,
      105    14787    1            2 C REDEF X CHAR(2) CALIGNED;
      106    14788    1       DCL CURRLEN(0:%MAXDEPTH) SBIN;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:37   
      107    14789    1       DCL INITLEN(0:%MAXDEPTH) SBIN;
      108    14790
      109    14791    1       ITEMLIST = '0'B;

  14791  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000004   200007 000400                    ADSC9   ITEMLIST,,AUTO           cn=0,n=256

      110    14792    1       TEMP = VBLK.DATA.SIZE;

  14792  2 000005   200003 470500                    LDP0    @VBLK,,AUTO
         2 000006   000005 235100                    LDA     5,,PR0
         2 000007   200134 755100                    STA     TEMP,,AUTO

      111    14793    1       INITLEN = '0'B;

  14793  2 000010   000100 100400                    MLR     fill='000'O
         2 000011   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000012   200147 000040                    ADSC9   INITLEN,,AUTO            cn=0,n=32

      112    14794    1       INITLEN(0) = TEMP;

  14794  2 000013   200147 755100                    STA     INITLEN,,AUTO

      113    14795    1       INITLEN(1) = TEMP;

  14795  2 000014   200150 755100                    STA     INITLEN+1,,AUTO

      114    14796    1       CURRLEN = '0'B;

  14796  2 000015   000100 100400                    MLR     fill='000'O
         2 000016   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000017   200137 000040                    ADSC9   CURRLEN,,AUTO            cn=0,n=32

      115    14797    1       CURRLEN(0) = TEMP;

  14797  2 000020   200137 755100                    STA     CURRLEN,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:38   

      116    14798    1       CURRLEN(1) = TEMP;

  14798  2 000021   200140 755100                    STA     CURRLEN+1,,AUTO

      117    14799    1       PDU$ = VBLK.DATA.PTR$;

  14799  2 000022   000004 236100                    LDQ     4,,PR0
         2 000023   200130 756100                    STQ     PDU$,,AUTO

      118    14800    1       PDUIDX = 0;

  14800  2 000024   200131 450100                    STZ     PDUIDX,,AUTO

      119    14801    1       ITEMLIST.Z(0) = 32*512 + TEMP*262144;  /* set up CON and LEN */

  14801  2 000025   000022 735000                    ALS     18
         2 000026   040000 035007                    ADLA    16384,DL
         2 000027   200007 755100                    STA     ITEMLIST,,AUTO

      120    14802    1       ITEMLIST.P(0) = PDU$;

  14802  2 000030   200010 756100                    STQ     ITEMLIST+1,,AUTO

      121    14803    1       ITEMNUM = 1;

  14803  2 000031   000001 235007                    LDA     1,DL
         2 000032   200125 755100                    STA     ITEMNUM,,AUTO

      122    14804    1       DEPTH = 1;

  14804  2 000033   200122 755100                    STA     DEPTH,,AUTO

      123    14805    1       GOTO NEXTBYTE;

  14805  2 000034   000054 710000 2                  TRA     NEXTBYTE

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:39   
      124    14806    1   NEXTLEVEL:
      125    14807    1       DEPTH = DEPTH + 1;

  14807  2 000035   200122 054100       NEXTLEVEL    AOS     DEPTH,,AUTO

      126    14808    1       IF DEPTH > %MAXDEPTH THEN

  14808  2 000036   200122 235100                    LDA     DEPTH,,AUTO
         2 000037   000007 115007                    CMPA    7,DL
         2 000040   000042 604400 2                  TMOZ    s:14810

      127    14809    1           ALTRETURN;

  14809  2 000041   000000 702200 xent               TSX2  ! X66_AALT

      128    14810    1       CURRLEN( DEPTH) = TEMP;

  14810  2 000042   200134 236100                    LDQ     TEMP,,AUTO
         2 000043   200137 756105                    STQ     CURRLEN,AL,AUTO

      129    14811    1       IF TEMP >= 0 THEN

  14811  2 000044   000050 604000 2                  TMI     s:14814

      130    14812    1           INITLEN( DEPTH) = TEMP;

  14812  2 000045   200122 720100                    LXL0    DEPTH,,AUTO
         2 000046   200147 756110                    STQ     INITLEN,X0,AUTO
         2 000047   000054 710000 2                  TRA     NEXTBYTE

      131    14813    1       ELSE
      132    14814    1           INITLEN( DEPTH) = -( ITEMNUM - 1);  /* LEN will be fixed at ENDITEM */

  14814  2 000050   200122 720100                    LXL0    DEPTH,,AUTO
         2 000051   000001 235007                    LDA     1,DL
         2 000052   200125 135100                    SBLA    ITEMNUM,,AUTO
         2 000053   200147 755110                    STA     INITLEN,X0,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:40   

      133    14815    1   NEXTBYTE:
      134    14816    2       IF CURRLEN( DEPTH) > 0 THEN DO;

  14816  2 000054   200122 720100       NEXTBYTE     LXL0    DEPTH,,AUTO
         2 000055   200137 235110                    LDA     CURRLEN,X0,AUTO
         2 000056   000152 604400 2                  TMOZ    ENDITEM

      135    14817    2           IF SUBSTR( PDU, PDUIDX, 2) = TWOZEROES.C THEN

  14817  2 000057   200130 470500                    LDP0    PDU$,,AUTO
         2 000060   200131 236100                    LDQ     PDUIDX,,AUTO
         2 000061   040000 106506                    CMPC    fill='040'O
         2 000062   000000 000002                    ADSC9   0,Q,PR0                  cn=0,n=2
         2 000063   000000 000002 1                  ADSC9   TWOZEROES                cn=0,n=2
         2 000064   000152 600000 2                  TZE     ENDITEM

      136    14818    2               GOTO ENDITEM;
      137    14819    2           TAG = ASCBIN( SUBSTR( PDU, PDUIDX, 1));

  14819  2 000065   000100 101506                    MRL     fill='000'O
         2 000066   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         2 000067   200162 000004                    ADSC9   INITLEN+11,,AUTO         cn=0,n=4
         2 000070   200162 236100                    LDQ     INITLEN+11,,AUTO
         2 000071   200133 756100                    STQ     TAG,,AUTO

      138    14820    2           PDUIDX = PDUIDX + 1;

  14820  2 000072   200131 054100                    AOS     PDUIDX,,AUTO

      139    14821    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - 1;

  14821  2 000073   000001 336007                    LCQ     1,DL
         2 000074   200137 056110                    ASQ     CURRLEN,X0,AUTO

      140    14822    2           CALL GETLEN;  /* parse length of item into TEMP */

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:41   
  14822  2 000075   004310 701000 2                  TSX1    GETLEN
         2 000076   000000 011000                    NOP     0

      141    14823    2           IF TEMP >= 0 THEN

  14823  2 000077   200134 235100                    LDA     TEMP,,AUTO
         2 000100   000115 604000 2                  TMI     s:14826

      142    14824    2               ITEMLIST.Z( ITEMNUM) = DEPTH + TAG*512 + TEMP*262144;

  14824  2 000101   200125 236100                    LDQ     ITEMNUM,,AUTO
         2 000102   000001 736000                    QLS     1
         2 000103   000000 620006                    EAX0    0,QL
         2 000104   200133 236100                    LDQ     TAG,,AUTO
         2 000105   000011 736000                    QLS     9
         2 000106   200122 036100                    ADLQ    DEPTH,,AUTO
         2 000107   200162 756100                    STQ     INITLEN+11,,AUTO
         2 000110   200134 236100                    LDQ     TEMP,,AUTO
         2 000111   000022 736000                    QLS     18
         2 000112   200162 036100                    ADLQ    INITLEN+11,,AUTO
         2 000113   200007 756110                    STQ     ITEMLIST,X0,AUTO
         2 000114   000124 710000 2                  TRA     s:14827

      143    14825    2           ELSE
      144    14826    2               ITEMLIST.Z( ITEMNUM) = DEPTH + TAG*512;  /* LEN fixed later */

  14826  2 000115   200125 236100                    LDQ     ITEMNUM,,AUTO
         2 000116   000001 736000                    QLS     1
         2 000117   000000 620006                    EAX0    0,QL
         2 000120   200133 236100                    LDQ     TAG,,AUTO
         2 000121   000011 736000                    QLS     9
         2 000122   200122 036100                    ADLQ    DEPTH,,AUTO
         2 000123   200007 756110                    STQ     ITEMLIST,X0,AUTO

      145    14827    2           ITEMLIST.P( ITEMNUM) = PINCRC( PDU$, PDUIDX);

  14827  2 000124   200131 236100                    LDQ     PDUIDX,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:42   
         2 000125   000020 736000                    QLS     16
         2 000126   200130 036100                    ADLQ    PDU$,,AUTO
         2 000127   200010 756110                    STQ     ITEMLIST+1,X0,AUTO

      146    14828    2           ITEMNUM = ITEMNUM + 1;

  14828  2 000130   200125 054100                    AOS     ITEMNUM,,AUTO

      147    14829    2           IF TAGX.CONSTRUCTED THEN

  14829  2 000131   200133 236100                    LDQ     TAG,,AUTO
         2 000132   000040 316007                    CANQ    32,DL
         2 000133   000035 601000 2                  TNZ     NEXTLEVEL

      148    14830    2               GOTO NEXTLEVEL;
      149    14831    2           IF TEMP < 0 THEN

  14831  2 000134   000000 115003                    CMPA    0,DU
         2 000135   000137 605000 2                  TPL     s:14833

      150    14832    2               ALTRETURN;  /* indefinite form illegal for primitive */

  14832  2 000136   000000 702200 xent               TSX2  ! X66_AALT

      151    14833    2           PDUIDX = PDUIDX + TEMP;

  14833  2 000137   200131 236100                    LDQ     PDUIDX,,AUTO
         2 000140   200134 036100                    ADLQ    TEMP,,AUTO
         2 000141   200131 756100                    STQ     PDUIDX,,AUTO

      152    14834    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - TEMP;

  14834  2 000142   200122 720100                    LXL0    DEPTH,,AUTO
         2 000143   200137 236110                    LDQ     CURRLEN,X0,AUTO
         2 000144   200134 136100                    SBLQ    TEMP,,AUTO
         2 000145   200137 756110                    STQ     CURRLEN,X0,AUTO

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:43   
      153    14835    2           IF VBLK.DATA.SIZE > PDUIDX THEN

  14835  2 000146   200003 470500                    LDP0    @VBLK,,AUTO
         2 000147   000005 236100                    LDQ     5,,PR0
         2 000150   200131 116100                    CMPQ    PDUIDX,,AUTO
         2 000151   000054 605400 2                  TPNZ    NEXTBYTE

      154    14836    2               GOTO NEXTBYTE;
      155    14837    2           END;

      156    14838    1   ENDITEM:
      157    14839    2       IF INITLEN( DEPTH) < 0 THEN DO;

  14839  2 000152   200147 235110       ENDITEM      LDA     INITLEN,X0,AUTO
         2 000153   000202 605000 2                  TPL     s:14847

      158    14840                /* have to fix up length of an indefinite-length item */
      159    14841    2           TEMP = -INITLEN( DEPTH);

  14841  2 000154   200147 235110                    LDA     INITLEN,X0,AUTO
         2 000155   000000 531000                    NEG     0
         2 000156   200134 755100                    STA     TEMP,,AUTO

      160    14842    2           ITEMLIST.X.LEN( TEMP) = PDUIDX - POFFC( ITEMLIST.P( TEMP), PDU$);

  14842  2 000157   000001 735000                    ALS     1
         2 000160   200130 236100                    LDQ     PDU$,,AUTO
         2 000161   000020 772000                    QRL     16
         2 000162   200162 756100                    STQ     INITLEN+11,,AUTO
         2 000163   200010 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 000164   000020 772000                    QRL     16
         2 000165   200162 136100                    SBLQ    INITLEN+11,,AUTO
         2 000166   200163 756100                    STQ     INITLEN+12,,AUTO
         2 000167   200131 236100                    LDQ     PDUIDX,,AUTO
         2 000170   200163 136100                    SBLQ    INITLEN+12,,AUTO
         2 000171   000000 621006                    EAX1    0,QL
         2 000172   200007 741105                    STX1    ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:44   

      161    14843    2           PDUIDX = PDUIDX + 2;

  14843  2 000173   000002 236007                    LDQ     2,DL
         2 000174   200131 056100                    ASQ     PDUIDX,,AUTO

      162    14844    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - 2;

  14844  2 000175   000002 336007                    LCQ     2,DL
         2 000176   200137 056110                    ASQ     CURRLEN,X0,AUTO

      163    14845    2           INITLEN( DEPTH) = - ( CURRLEN( DEPTH) + 1);

  14845  2 000177   200137 235110                    LDA     CURRLEN,X0,AUTO
         2 000200   000001 675000 3                  ERA     1
         2 000201   200147 755110                    STA     INITLEN,X0,AUTO

      164    14846    2           END;

      165    14847    1       TEMP = DEPTH;

  14847  2 000202   200122 236100                    LDQ     DEPTH,,AUTO
         2 000203   200134 756100                    STQ     TEMP,,AUTO

      166    14848    1       DEPTH = DEPTH - 1;

  14848  2 000204   000001 336007                    LCQ     1,DL
         2 000205   200122 056100                    ASQ     DEPTH,,AUTO

      167    14849    2       IF DEPTH >= 0 THEN DO;

  14849  2 000206   000216 604000 2                  TMI     s:14855

      168    14850    2           CURRLEN( DEPTH) = CURRLEN( DEPTH) - INITLEN( TEMP);

  14850  2 000207   200134 720100                    LXL0    TEMP,,AUTO
         2 000210   200122 721100                    LXL1    DEPTH,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:45   
         2 000211   200137 236111                    LDQ     CURRLEN,X1,AUTO
         2 000212   200147 136110                    SBLQ    INITLEN,X0,AUTO
         2 000213   200137 756111                    STQ     CURRLEN,X1,AUTO

      169    14851    2           INITLEN( TEMP) = 0;

  14851  2 000214   200147 450110                    STZ     INITLEN,X0,AUTO

      170    14852    2           GOTO NEXTBYTE;

  14852  2 000215   000054 710000 2                  TRA     NEXTBYTE

      171    14853    2           END;
      172    14854            /* done scanning the PPDU.. now try to decode it item by item */
      173    14855    1       ABS$ = ADDR( ABSNAME);

  14855  2 000216   000002 236000 3                  LDQ     2
         2 000217   200107 756100                    STQ     ABS$,,AUTO

      174    14856    1       TFR$ = ADDR( TFRNAME);

  14856  2 000220   000003 236000 3                  LDQ     3
         2 000221   200110 756100                    STQ     TFR$,,AUTO

      175    14857    1       XSP_ITEMCNT = -1;  /* make SCAN/LOAD load into SCANITEM, not ITEMLIST */

  14857  2 000222   000001 335007                    LCA     1,DL
         2 000223   000000 755000 xsym               STA     XSP_ITEMCNT

      176    14858    1       ITEMCUR = 0;

  14858  2 000224   200124 450100                    STZ     ITEMCUR,,AUTO

      177    14859    1       DATALVL = 0;

  14859  2 000225   200121 450100                    STZ     DATALVL,,AUTO

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:46   
      178    14860    1       CALL XSS$BUFPTR( PCTX.CTXTMAPX, CMAP$);

  14860  2 000226   200003 470500                    LDP0    @VBLK,,AUTO
         2 000227   000000 471500                    LDP1    0,,PR0
         2 000230   200120 633500                    EPPR3   CMAP$,,AUTO
         2 000231   200163 453500                    STP3    INITLEN+12,,AUTO
         2 000232   200164 451500                    STP1    INITLEN+13,,AUTO
         2 000233   200164 236100                    LDQ     INITLEN+13,,AUTO
         2 000234   000005 036000 3                  ADLQ    5
         2 000235   200162 756100                    STQ     INITLEN+11,,AUTO
         2 000236   200162 630500                    EPPR0   INITLEN+11,,AUTO
         2 000237   000004 631400 3                  EPPR1   4
         2 000240   000000 701000 xent               TSX1    XSS$BUFPTR
         2 000241   000000 011000                    NOP     0

      179    14861            %SCAN( LVL=0, TYP=NONE, CON=Y, LEN="VBLK.DATA.SIZE");

  14948  2 000242   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000243   000001 735000                    ALS     1
         2 000244   200003 470500                    LDP0    @VBLK,,AUTO
         2 000245   000000 620005                    EAX0    0,AL
         2 000246   000005 235100                    LDA     5,,PR0
         2 000247   000022 735000                    ALS     18
         2 000250   040000 035007                    ADLA    16384,DL
         2 000251   200007 755110                    STA     ITEMLIST,X0,AUTO

  14955  2 000252   003732 701000 2                  TSX1    SCAN
         2 000253   003731 702000 2                  TSX2    SCANERR

      180    14958    1   SFNCCASE:
      181    14959    2       DO CASE( XSS$GENERIC.FNC);

  14959  2 000254   200004 470500       SFNCCASE     LDP0    @SFPT$,,AUTO
         2 000255   000000 471500                    LDP1    0,,PR0
         2 000256   100000 236100                    LDQ     0,,PR1
         2 000257   000033 772000                    QRL     27
         2 000260   000022 136007                    SBLQ    18,DL
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:47   
         2 000261   000045 116007                    CMPQ    37,DL
         2 000262   000264 602006 2                  TNC     SFNCCASE+8,QL
         2 000263   003507 710000 2                  TRA     s:22693
         2 000264   000331 710000 2                  TRA     s:14967
         2 000265   003507 710000 2                  TRA     s:22693
         2 000266   000344 710000 2                  TRA     s:14976
         2 000267   003507 710000 2                  TRA     s:22693
         2 000270   000357 710000 2                  TRA     s:14986
         2 000271   003507 710000 2                  TRA     s:22693
         2 000272   001237 710000 2                  TRA     s:16841
         2 000273   003507 710000 2                  TRA     s:22693
         2 000274   003507 710000 2                  TRA     s:22693
         2 000275   003507 710000 2                  TRA     s:22693
         2 000276   002051 710000 2                  TRA     s:19075
         2 000277   003507 710000 2                  TRA     s:22693
         2 000300   002064 710000 2                  TRA     s:19084
         2 000301   003507 710000 2                  TRA     s:22693
         2 000302   003507 710000 2                  TRA     s:22693
         2 000303   003507 710000 2                  TRA     s:22693
         2 000304   003507 710000 2                  TRA     s:22693
         2 000305   003507 710000 2                  TRA     s:22693
         2 000306   002077 710000 2                  TRA     s:19094
         2 000307   003507 710000 2                  TRA     s:22693
         2 000310   002237 710000 2                  TRA     s:19604
         2 000311   003507 710000 2                  TRA     s:22693
         2 000312   003507 710000 2                  TRA     s:22693
         2 000313   003507 710000 2                  TRA     s:22693
         2 000314   003507 710000 2                  TRA     s:22693
         2 000315   003507 710000 2                  TRA     s:22693
         2 000316   003507 710000 2                  TRA     s:22693
         2 000317   003507 710000 2                  TRA     s:22693
         2 000320   003507 710000 2                  TRA     s:22693
         2 000321   003507 710000 2                  TRA     s:22693
         2 000322   003507 710000 2                  TRA     s:22693
         2 000323   003507 710000 2                  TRA     s:22693
         2 000324   003507 710000 2                  TRA     s:22693
         2 000325   003507 710000 2                  TRA     s:22693
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:48   
         2 000326   002377 710000 2                  TRA     s:20114
         2 000327   003507 710000 2                  TRA     s:22693
         2 000330   003266 710000 2                  TRA     s:21876

      182    14960        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:49   
      183    14961        /*****************************************************************************
      184    14962        *
      185    14963        *       SCADIND --> TC
      186    14964        *
      187    14965        *****************************************************************************/
      188    14966    2           CASE( %XSS_FNC_SCADIND#);  /* should be a TC PPDU */

      189    14967    2               XSP$CAPABILITY_DATA = XSP_CAPABILITY_DATA;

  14967  2 000331   200003 473500                    LDP3    @VBLK,,AUTO
         2 000332   300001 474500                    LDP4    1,,PR3
         2 000333   000100 100400                    MLR     fill='000'O
         2 000334   000000 000014 xsym               ADSC9   XSP_CAPABILITY_DATA      cn=0,n=12
         2 000335   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      190    14968    2               XSP$CAPABILITY_DATA.FNC = %XSP_FNC_PCADIND#;

  14968  2 000336   300001 471500                    LDP1    1,,PR3
         2 000337   026000 236003                    LDQ     11264,DU
         2 000340   100000 552140                    STBQ    0,'40'O,PR1

      191    14969    2               DATALVL = 1;

  14969  2 000341   000001 235007                    LDA     1,DL
         2 000342   200121 755100                    STA     DATALVL,,AUTO
         2 000343   003510 710000 2                  TRA     s:22695

      192    14970        /*****************************************************************************
      193    14971        *
      194    14972        *       SCADCNF --> TCC
      195    14973        *
      196    14974        *****************************************************************************/
      197    14975    2           CASE( %XSS_FNC_SCADCNF#);  /* should be a TCC PPDU */

      198    14976    2               XSP$CAPABILITY_DATA = XSP_CAPABILITY_DATA;

  14976  2 000344   200003 473500                    LDP3    @VBLK,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:50   
         2 000345   300001 474500                    LDP4    1,,PR3
         2 000346   000100 100400                    MLR     fill='000'O
         2 000347   000000 000014 xsym               ADSC9   XSP_CAPABILITY_DATA      cn=0,n=12
         2 000350   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      199    14977    2               XSP$CAPABILITY_DATA.FNC = %XSP_FNC_PCADCNF#;

  14977  2 000351   300001 471500                    LDP1    1,,PR3
         2 000352   030000 236003                    LDQ     12288,DU
         2 000353   100000 552140                    STBQ    0,'40'O,PR1

      200    14978    2               DATALVL = 1;

  14978  2 000354   000001 235007                    LDA     1,DL
         2 000355   200121 755100                    STA     DATALVL,,AUTO
         2 000356   003510 710000 2                  TRA     s:22695

      201    14979        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:51   
      202    14980        /*****************************************************************************
      203    14981        *
      204    14982        *       SCONIND --> CP
      205    14983        *
      206    14984        *****************************************************************************/
      207    14985    2           CASE( %XSS_FNC_SCONIND#);  /* should be a CP PPDU */

      208    14986    2               XSP$CONNECT = XSP_CONNECT;

  14986  2 000357   200003 473500                    LDP3    @VBLK,,AUTO
         2 000360   300001 474500                    LDP4    1,,PR3
         2 000361   003100 060400                    CSL     bolr='003'O
         2 000362   000000 000616 xsym               BDSC    XSP_CONNECT              by=0,bit=0,n=398
         2 000363   400000 000616                    BDSC    0,,PR4                   by=0,bit=0,n=398

      209    14987    2               XSP$CONNECT.FNC = %XSP_FNC_PCONIND#;

  14987  2 000364   300001 471500                    LDP1    1,,PR3
         2 000365   032000 236003                    LDQ     13312,DU
         2 000366   100000 552140                    STBQ    0,'40'O,PR1

      210    14988    2               XSP$CONNECT.CALLING$ = XSP_SRCADDR$;

  14988  2 000367   300001 471500                    LDP1    1,,PR3
         2 000370   000000 236000 xsym               LDQ     XSP_SRCADDR$
         2 000371   100006 756100                    STQ     6,,PR1

      211    14989    2               XSP$CONNECT.CALLED$ = XSP_DSTADDR$;

  14989  2 000372   300001 471500                    LDP1    1,,PR3
         2 000373   000000 236000 xsym               LDQ     XSP_DSTADDR$
         2 000374   100007 756100                    STQ     7,,PR1

      212    14990    2               XSP$CONNECT.CTXT$ = XSP_TMPCTXT$;

  14990  2 000375   300001 471500                    LDP1    1,,PR3
         2 000376   000000 236000 xsym               LDQ     XSP_TMPCTXT$
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:52   
         2 000377   100005 756100                    STQ     5,,PR1

      213    14991                    %SCAN( LVL=1, TYP=SET);  /* CPType */

  15078  2 000400   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000401   000001 735000                    ALS     1
         2 000402   061211 236007                    LDQ     25225,DL
         2 000403   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15085  2 000404   003732 701000 2                  TSX1    SCAN
         2 000405   003731 702000 2                  TSX2    SCANERR

      214    15088                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SET);  /* ModeSelector */

  15175  2 000406   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000407   000001 735000                    ALS     1
         2 000410   240612 236007                    LDQ     82314,DL
         2 000411   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15182  2 000412   003732 701000 2                  TSX1    SCAN
         2 000413   003731 702000 2                  TSX2    SCANERR

      215    15185    2               UTMP = 0;

  15185  2 000414   200136 450100                    STZ     UTMP,,AUTO

      216    15186                    %SCAN( LVL=3, TAG=C0, TYP=INTG,
      217    15187                            LEN=1, VAL=UTMP);

  15240  2 000415   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000416   000001 735000                    ALS     1
         2 000417   200136 630500                    EPPR0   UTMP,,AUTO
         2 000420   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  15274  2 000421   000006 236000 3                  LDQ     6
         2 000422   200007 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:53   
  15281  2 000423   003732 701000 2                  TSX1    SCAN
         2 000424   003731 702000 2                  TSX2    SCANERR

      218    15284    2               IF UTMP ~= 1 THEN

  15284  2 000425   200136 235100                    LDA     UTMP,,AUTO
         2 000426   000001 115007                    CMPA    1,DL
         2 000427   000431 600000 2                  TZE     s:15373

      219    15285    2                   ALTRETURN;

  15285  2 000430   000000 702200 xent               TSX2  ! X66_AALT

      220    15286                    %SCAN( LVL=2, TAG=C2, IMP=Y, TYP=SEQ, OPT=Y);

  15373  2 000431   000000 236000 xsym               LDQ     XSP_ITEMCNT
         2 000432   000001 736000                    QLS     1
         2 000433   642602 235007                    LDA     -47742,DL
         2 000434   200007 755106                    STA     ITEMLIST,QL,AUTO

  15380  2 000435   003732 701000 2                  TSX1    SCAN
         2 000436   003731 702000 2                  TSX2    SCANERR

      221    15383    2               BTMP = '000000000000'O;

  15383  2 000437   000001 236000 1                  LDQ     TWOZEROES+1
         2 000440   200117 756100                    STQ     BTMP,,AUTO

      222    15384                    %SCAN( LVL=3, TAG=C0, IMP=Y, TYP=BITSTR, OPT=Y,
      223    15385                            LEN=1, VAL=BTMP);  /* ProtocolVersion */

  15444  2 000441   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000442   000001 735000                    ALS     1
         2 000443   200117 630500                    EPPR0   BTMP,,AUTO
         2 000444   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  15472  2 000445   000007 236000 3                  LDQ     7
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:54   
         2 000446   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15479  2 000447   003732 701000 2                  TSX1    SCAN
         2 000450   003731 702000 2                  TSX2    SCANERR

      224    15482    2               IF BTMP ~= '1'B THEN

  15482  2 000451   200117 236100                    LDQ     BTMP,,AUTO
         2 000452   400000 116003                    CMPQ    -131072,DU
         2 000453   000455 600000 2                  TZE     s:15484

      225    15483    2                   ALTRETURN;

  15483  2 000454   000000 702200 xent               TSX2  ! X66_AALT

      226    15484    2               PSAP$ = ADDR( XSP$CONNECT.CALLING$->XSC$ADDRESS.PSAP);

  15484  2 000455   200003 470500                    LDP0    @VBLK,,AUTO
         2 000456   000001 471500                    LDP1    1,,PR0
         2 000457   100006 473500                    LDP3    6,,PR1
         2 000460   200132 453500                    STP3    PSAP$,,AUTO

      227    15485                    %SCAN( LVL=3, TAG=C1, IMP=Y, TYP=OCTETSTR, OPT=Y,
      228    15486                            LEN=224, VAL="PSAP.TXT");  /* CallingPresSelector */

  15570  2 000461   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000462   000001 735000                    ALS     1
         2 000463   200132 236100                    LDQ     PSAP$,,AUTO
         2 000464   200000 036007                    ADLQ    65536,DL
         2 000465   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  15573  2 000466   000010 236000 3                  LDQ     8
         2 000467   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15580  2 000470   003732 701000 2                  TSX1    SCAN
         2 000471   003731 702000 2                  TSX2    SCANERR

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:55   
      229    15583    2               PSAP$ = ADDR( XSP$CONNECT.CALLED$->XSC$ADDRESS.PSAP);

  15583  2 000472   200003 470500                    LDP0    @VBLK,,AUTO
         2 000473   000001 471500                    LDP1    1,,PR0
         2 000474   100007 473500                    LDP3    7,,PR1
         2 000475   200132 453500                    STP3    PSAP$,,AUTO

      230    15584                    %SCAN( LVL=3, TAG=C2, IMP=Y, TYP=OCTETSTR, OPT=Y,
      231    15585                            LEN=224, VAL="PSAP.TXT");  /* CalledPresSelector */

  15669  2 000476   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000477   000001 735000                    ALS     1
         2 000500   200132 236100                    LDQ     PSAP$,,AUTO
         2 000501   200000 036007                    ADLQ    65536,DL
         2 000502   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  15672  2 000503   000011 236000 3                  LDQ     9
         2 000504   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15679  2 000505   003732 701000 2                  TSX1    SCAN
         2 000506   003731 702000 2                  TSX2    SCANERR

      232    15682                    %SCAN( LVL=3, TAG=C4, IMP=Y, TYP=SEQOF, OPT=Y);/*PresCtxtDefList*/

  15769  2 000507   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000510   000001 735000                    ALS     1
         2 000511   644563 236007                    LDQ     -46733,DL
         2 000512   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15776  2 000513   003732 701000 2                  TSX1    SCAN
         2 000514   003731 702000 2                  TSX2    SCANERR

      233    15779    2               I = 0;

  15779  2 000515   200123 450100                    STZ     I,,AUTO

      234    15780    2               CLST.COUNT(0) = I;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:56   

  15780  2 000516   000000 470400 xsym               LDP0    XSP_TMPCTXT$
         2 000517   200123 235100                    LDA     I,,AUTO
         2 000520   000000 755100                    STA     0,,PR0

      235    15781    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 3);

  15781  2 000521   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 000522   000001 736000                    QLS     1
         2 000523   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 000524   000007 376007                    ANQ     7,DL
         2 000525   000004 116007                    CMPQ    4,DL
         2 000526   000767 602000 2                  TNC     s:16306

      236    15782                        %SCAN( LVL=4, TYP=SEQ);

  15869  2 000527   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000530   000001 735000                    ALS     1
         2 000531   060204 236007                    LDQ     24708,DL
         2 000532   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15876  2 000533   003732 701000 2                  TSX1    SCAN
         2 000534   003731 702000 2                  TSX2    SCANERR

      237    15879    3                   UTMP = 0;

  15879  2 000535   200136 450100                    STZ     UTMP,,AUTO

      238    15880                        %SCAN( LVL=5, TYP=INTG,
      239    15881                                LEN=4, VAL=UTMP);  /* PresCtxtIdent */

  15934  2 000536   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000537   000001 735000                    ALS     1
         2 000540   200136 630500                    EPPR0   UTMP,,AUTO
         2 000541   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  15968  2 000542   000012 236000 3                  LDQ     10
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:57   
         2 000543   200007 756105                    STQ     ITEMLIST,AL,AUTO

  15975  2 000544   003732 701000 2                  TSX1    SCAN
         2 000545   003731 702000 2                  TSX2    SCANERR

      240    15978                        %SCAN( LVL=5, TYP=OBJID,
      241    15979                                LEN=20, VAL=ABS$);  /* AbsSynName */

  16053  2 000546   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000547   000001 735000                    ALS     1
         2 000550   200107 236100                    LDQ     ABS$,,AUTO
         2 000551   400000 036007                    ADLQ    -131072,DL
         2 000552   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  16066  2 000553   200107 470500                    LDP0    ABS$,,AUTO
         2 000554   000000 236100                    LDQ     0,,PR0
         2 000555   777777 376003                    ANQ     -1,DU
         2 000556   006065 036007                    ADLQ    3125,DL
         2 000557   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16073  2 000560   003732 701000 2                  TSX1    SCAN
         2 000561   003731 702000 2                  TSX2    SCANERR

      242    16076                        %SCAN( LVL=5, TYP=SEQOF);

  16163  2 000562   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000563   000001 735000                    ALS     1
         2 000564   120165 236007                    LDQ     41077,DL
         2 000565   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16170  2 000566   003732 701000 2                  TSX1    SCAN
         2 000567   003731 702000 2                  TSX2    SCANERR

      243    16173                        /*N* we only support one transfer syntax at a time */
      244    16174                        %SCAN( LVL=6, TYP=OBJID,
      245    16175                                LEN=20, VAL=TFR$);  /* TfrSynName */

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:58   
  16249  2 000570   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000571   000001 735000                    ALS     1
         2 000572   200110 236100                    LDQ     TFR$,,AUTO
         2 000573   400000 036007                    ADLQ    -131072,DL
         2 000574   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  16262  2 000575   200110 470500                    LDP0    TFR$,,AUTO
         2 000576   000000 236100                    LDQ     0,,PR0
         2 000577   777777 376003                    ANQ     -1,DU
         2 000600   006066 036007                    ADLQ    3126,DL
         2 000601   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16269  2 000602   003732 701000 2                  TSX1    SCAN
         2 000603   003731 702000 2                  TSX2    SCANERR

      246    16272    3                   I = I + 1;

  16272  2 000604   200123 054100                    AOS     I,,AUTO

      247    16273    3                   CLST.COUNT(0) = I;

  16273  2 000605   000000 470400 xsym               LDP0    XSP_TMPCTXT$
         2 000606   200123 235100                    LDA     I,,AUTO
         2 000607   000000 755100                    STA     0,,PR0

      248    16274    3                   CMAP.ABSCTXTID( I) = 0;

  16274  2 000610   000001 735000                    ALS     1
         2 000611   200120 470500                    LDP0    CMAP$,,AUTO
         2 000612   000013 236000 3                  LDQ     11
         2 000613   000001 356105                    ANSQ    1,AL,PR0

      249    16275    3                   CMAP.TFRCTXTID( I) = 0;

  16275  2 000614   200120 470500                    LDP0    CMAP$,,AUTO
         2 000615   000014 236000 3                  LDQ     12
         2 000616   000001 356105                    ANSQ    1,AL,PR0
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:59   

      250    16276                        /* validate this PresCtxt definition */
      251    16277    3   CP_CTXT_ABS:
      252    16278    4                   DO J = 1 TO XSP_ABSLIST.COUNT(0);

  16278  2 000617   000001 235007       CP_CTXT_ABS  LDA     1,DL
         2 000620   200126 755100                    STA     J,,AUTO
         2 000621   000653 710000 2                  TRA     s:16286+1

      253    16279    4                       TMP$ = XSP_ABSLIST.CTXT$( J);

  16279  2 000622   200126 720100                    LXL0    J,,AUTO
         2 000623   000000 236010 xsym               LDQ     XSP_ABSLIST,X0
         2 000624   200135 756100                    STQ     TMP$,,AUTO

      254    16280    4                       IF TMP$ ~= ADDR( NIL) AND

  16280  2 000625   000015 116000 3                  CMPQ    13
         2 000626   000652 600000 2                  TZE     s:16286
         2 000627   200107 470500                    LDP0    ABS$,,AUTO
         2 000630   000000 221100                    LDX1    0,,PR0
         2 000631   200135 471500                    LDP1    TMP$,,AUTO
         2 000632   100000 101100                    CMPX1   0,,PR1
         2 000633   000652 601000 2                  TNZ     s:16286
         2 000634   100000 222100                    LDX2    0,,PR1
         2 000635   040140 106540                    CMPC    fill='040'O
         2 000636   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         2 000637   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 000640   000652 601000 2                  TNZ     s:16286

      255    16281    4                               ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      256    16282    5                               ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      257    16283    5                           CMAP.ABSCTXTID( I) = J;

  16283  2 000641   200123 235100                    LDA     I,,AUTO
         2 000642   000001 735000                    ALS     1
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:60   
         2 000643   200120 473500                    LDP3    CMAP$,,AUTO
         2 000644   200126 236100                    LDQ     J,,AUTO
         2 000645   000033 736000                    QLS     27
         2 000646   300001 676105                    ERQ     1,AL,PR3
         2 000647   777000 376003                    ANQ     -512,DU
         2 000650   300001 656105                    ERSQ    1,AL,PR3

      258    16284    5                           EXIT CP_CTXT_ABS;

  16284  2 000651   000656 710000 2                  TRA     CP_CTXT_TFR

      259    16285    5                           END;
      260    16286    4                       END;

  16286  2 000652   200126 054100                    AOS     J,,AUTO
         2 000653   200126 236100                    LDQ     J,,AUTO
         2 000654   000000 116000 xsym               CMPQ    XSP_ABSLIST
         2 000655   000622 604400 2                  TMOZ    s:16279

      261    16287    3   CP_CTXT_TFR:
      262    16288    4                   DO J = 1 TO XSP_TFRLIST.COUNT(0);

  16288  2 000656   000001 235007       CP_CTXT_TFR  LDA     1,DL
         2 000657   200126 755100                    STA     J,,AUTO
         2 000660   000712 710000 2                  TRA     s:16296+1

      263    16289    4                       TMP$ = XSP_TFRLIST.CTXT$( J);

  16289  2 000661   200126 720100                    LXL0    J,,AUTO
         2 000662   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 000663   200135 756100                    STQ     TMP$,,AUTO

      264    16290    4                       IF TMP$ ~= ADDR( NIL) AND

  16290  2 000664   000015 116000 3                  CMPQ    13
         2 000665   000711 600000 2                  TZE     s:16296
         2 000666   200110 470500                    LDP0    TFR$,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:61   
         2 000667   000000 221100                    LDX1    0,,PR0
         2 000670   200135 471500                    LDP1    TMP$,,AUTO
         2 000671   100000 101100                    CMPX1   0,,PR1
         2 000672   000711 601000 2                  TNZ     s:16296
         2 000673   100000 222100                    LDX2    0,,PR1
         2 000674   040140 106540                    CMPC    fill='040'O
         2 000675   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         2 000676   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 000677   000711 601000 2                  TNZ     s:16296

      265    16291    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      266    16292    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      267    16293    5                           CMAP.TFRCTXTID( I) = J;

  16293  2 000700   200123 235100                    LDA     I,,AUTO
         2 000701   000001 735000                    ALS     1
         2 000702   200120 473500                    LDP3    CMAP$,,AUTO
         2 000703   200126 236100                    LDQ     J,,AUTO
         2 000704   000022 736000                    QLS     18
         2 000705   300001 676105                    ERQ     1,AL,PR3
         2 000706   000777 376003                    ANQ     511,DU
         2 000707   300001 656105                    ERSQ    1,AL,PR3

      268    16294    5                           EXIT CP_CTXT_TFR;

  16294  2 000710   000715 710000 2                  TRA     s:16297

      269    16295    5                           END;
      270    16296    4                       END;

  16296  2 000711   200126 054100                    AOS     J,,AUTO
         2 000712   200126 236100                    LDQ     J,,AUTO
         2 000713   000000 116000 xsym               CMPQ    XSP_TFRLIST
         2 000714   000661 604400 2                  TMOZ    s:16289

      271    16297    3                   IF CMAP.ABSCTXTID( I) = 0 OR CMAP.TFRCTXTID( I) = 0 THEN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:62   

  16297  2 000715   200123 235100                    LDA     I,,AUTO
         2 000716   000001 735000                    ALS     1
         2 000717   200120 470500                    LDP0    CMAP$,,AUTO
         2 000720   000001 236105                    LDQ     1,AL,PR0
         2 000721   777000 316003                    CANQ    -512,DU
         2 000722   000725 600000 2                  TZE     s:16298
         2 000723   000777 316003                    CANQ    511,DU
         2 000724   000731 601000 2                  TNZ     s:16300

      272    16298    3                       CMAP.RESULT( I) = %XSP_RSLT_PREJECT;

  16298  2 000725   000016 376000 3                  ANQ     14
         2 000726   002000 276007                    ORQ     1024,DL
         2 000727   000001 756105                    STQ     1,AL,PR0
         2 000730   000733 710000 2                  TRA     s:16301

      273    16299    3                   ELSE
      274    16300    3                       CMAP.RESULT( I) = %XSP_RSLT_ACCEPT;

  16300  2 000731   000016 236000 3                  LDQ     14
         2 000732   000001 356105                    ANSQ    1,AL,PR0

      275    16301    3                   CMAP.STATE( I) = %XSP_CMAP_RMTDEF;

  16301  2 000733   200120 470500                    LDP0    CMAP$,,AUTO
         2 000734   000001 236105                    LDQ     1,AL,PR0
         2 000735   000017 376000 3                  ANQ     15
         2 000736   000003 276007                    ORQ     3,DL
         2 000737   000001 756105                    STQ     1,AL,PR0

      276    16302    3                   CMAP.PEERCTXTID( I) = UTMP;

  16302  2 000740   200120 470500                    LDP0    CMAP$,,AUTO
         2 000741   200136 236100                    LDQ     UTMP,,AUTO
         2 000742   000000 756105                    STQ     0,AL,PR0

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:63   
      277    16303    3                   CLST.RESULT( I) = CMAP.RESULT( I);

  16303  2 000743   200120 470500                    LDP0    CMAP$,,AUTO
         2 000744   000001 236105                    LDQ     1,AL,PR0
         2 000745   000011 772000                    QRL     9
         2 000746   000017 376007                    ANQ     15,DL
         2 000747   000000 471400 xsym               LDP1    XSP_TMPCTXT$
         2 000750   200123 720100                    LXL0    I,,AUTO
         2 000751   100000 756110                    STQ     0,X0,PR1

      278    16304    3                   VBLK.DEFBITS( I) = %TRUE;

  16304  2 000752   200123 236100                    LDQ     I,,AUTO
         2 000753   000755 605000 2                  TPL     s:16304+3
         2 000754   000044 036003                    ADLQ    36,DU
         2 000755   200003 470500                    LDP0    @VBLK,,AUTO
         2 000756   003106 060400                    CSL     bolr='003'O
         2 000757   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 000760   000007 000001                    BDSC    7,Q,PR0                  by=0,bit=0,n=1

      279    16305    3                   END;

  16305  2 000761   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 000762   000001 736000                    QLS     1
         2 000763   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 000764   000007 376007                    ANQ     7,DL
         2 000765   000004 116007                    CMPQ    4,DL
         2 000766   000527 603000 2                  TRC     s:15869

      280    16306    2               PCTX.DFLCTXTID = 1;  /*N* hardwired bogus CP-6 context */

  16306  2 000767   200003 470500                    LDP0    @VBLK,,AUTO
         2 000770   000000 471500                    LDP1    0,,PR0
         2 000771   001000 236007                    LDQ     512,DL
         2 000772   100001 552110                    STBQ    1,'10'O,PR1

      281    16307                    %SCAN( LVL=3, TAG=C6, IMP=Y, TYP=SEQ, OPT=Y);/* DefaultCtxtName */
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:64   

  16394  2 000773   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 000774   000001 735000                    ALS     1
         2 000775   646603 236007                    LDQ     -45693,DL
         2 000776   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16401  2 000777   003732 701000 2                  TSX1    SCAN
         2 001000   003731 702000 2                  TSX2    SCANERR

      282    16404    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 3);

  16404  2 001001   200124 235100                    LDA     ITEMCUR,,AUTO
         2 001002   000001 735000                    ALS     1
         2 001003   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 001004   000007 376007                    ANQ     7,DL
         2 001005   000004 116007                    CMPQ    4,DL
         2 001006   001177 602000 2                  TNC     s:16633

      283    16405                        %SCAN( LVL=4, TAG=C0, IMP=Y, TYP=OBJID,
      284    16406                                LEN=20, VAL=ABS$);  /* AbsSynName */

  16480  2 001007   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001010   000001 735000                    ALS     1
         2 001011   200107 236100                    LDQ     ABS$,,AUTO
         2 001012   400000 036007                    ADLQ    -131072,DL
         2 001013   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  16493  2 001014   200107 470500                    LDP0    ABS$,,AUTO
         2 001015   000000 236100                    LDQ     0,,PR0
         2 001016   777777 376003                    ANQ     -1,DU
         2 001017   200464 036007                    ADLQ    65844,DL
         2 001020   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16500  2 001021   003732 701000 2                  TSX1    SCAN
         2 001022   003731 702000 2                  TSX2    SCANERR

      285    16503                        %SCAN( LVL=4, TAG=C1, IMP=Y, TYP=OBJID,
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:65   
      286    16504                                LEN=20, VAL=TFR$);  /* TfrSynName */

  16578  2 001023   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001024   000001 735000                    ALS     1
         2 001025   200110 236100                    LDQ     TFR$,,AUTO
         2 001026   400000 036007                    ADLQ    -131072,DL
         2 001027   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  16591  2 001030   200110 470500                    LDP0    TFR$,,AUTO
         2 001031   000000 236100                    LDQ     0,,PR0
         2 001032   777777 376003                    ANQ     -1,DU
         2 001033   201464 036007                    ADLQ    66356,DL
         2 001034   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16598  2 001035   003732 701000 2                  TSX1    SCAN
         2 001036   003731 702000 2                  TSX2    SCANERR

      287    16601    3                   CMAP.ABSCTXTID(0) = 0;

  16601  2 001037   200120 470500                    LDP0    CMAP$,,AUTO
         2 001040   000000 236003                    LDQ     0,DU
         2 001041   000001 552140                    STBQ    1,'40'O,PR0

      288    16602    3                   CMAP.TFRCTXTID(0) = 0;

  16602  2 001042   200120 470500                    LDP0    CMAP$,,AUTO
         2 001043   000001 552120                    STBQ    1,'20'O,PR0

      289    16603    3   CP_DFLT_ABS:
      290    16604    4                   DO J = 1 TO XSP_ABSLIST.COUNT(0);

  16604  2 001044   000001 235007       CP_DFLT_ABS  LDA     1,DL
         2 001045   200126 755100                    STA     J,,AUTO
         2 001046   001101 710000 2                  TRA     s:16613+1

      291    16605    4                       TMP$ = XSP_ABSLIST.CTXT$( J);

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:66   
  16605  2 001047   200126 720100                    LXL0    J,,AUTO
         2 001050   000000 236010 xsym               LDQ     XSP_ABSLIST,X0
         2 001051   200135 756100                    STQ     TMP$,,AUTO

      292    16606    4                       IF TMP$ ~= ADDR( NIL) AND

  16606  2 001052   000015 116000 3                  CMPQ    13
         2 001053   001100 600000 2                  TZE     s:16613
         2 001054   200107 470500                    LDP0    ABS$,,AUTO
         2 001055   000000 221100                    LDX1    0,,PR0
         2 001056   200135 471500                    LDP1    TMP$,,AUTO
         2 001057   100000 101100                    CMPX1   0,,PR1
         2 001060   001100 601000 2                  TNZ     s:16613
         2 001061   100000 222100                    LDX2    0,,PR1
         2 001062   040140 106540                    CMPC    fill='040'O
         2 001063   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         2 001064   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 001065   001100 601000 2                  TNZ     s:16613

      293    16607    4                               ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      294    16608    5                               ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      295    16609    5                           CMAP.ABSCTXTID(0) = J;

  16609  2 001066   200120 473500                    LDP3    CMAP$,,AUTO
         2 001067   200126 236100                    LDQ     J,,AUTO
         2 001070   000033 736000                    QLS     27
         2 001071   300001 552140                    STBQ    1,'40'O,PR3

      296    16610    5                           PCTX.DFLCTXTID = J;

  16610  2 001072   200003 473500                    LDP3    @VBLK,,AUTO
         2 001073   300000 474500                    LDP4    0,,PR3
         2 001074   200126 236100                    LDQ     J,,AUTO
         2 001075   000011 736000                    QLS     9
         2 001076   400001 552110                    STBQ    1,'10'O,PR4

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:67   
      297    16611    5                           EXIT CP_DFLT_ABS;

  16611  2 001077   001104 710000 2                  TRA     CP_DFLT_TFR

      298    16612    5                           END;
      299    16613    4                       END;

  16613  2 001100   200126 054100                    AOS     J,,AUTO
         2 001101   200126 236100                    LDQ     J,,AUTO
         2 001102   000000 116000 xsym               CMPQ    XSP_ABSLIST
         2 001103   001047 604400 2                  TMOZ    s:16605

      300    16614    3   CP_DFLT_TFR:
      301    16615    4                   DO J = 1 TO XSP_TFRLIST.COUNT(0);

  16615  2 001104   000001 235007       CP_DFLT_TFR  LDA     1,DL
         2 001105   200126 755100                    STA     J,,AUTO
         2 001106   001134 710000 2                  TRA     s:16623+1

      302    16616    4                       TMP$ = XSP_TFRLIST.CTXT$( J);

  16616  2 001107   200126 720100                    LXL0    J,,AUTO
         2 001110   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 001111   200135 756100                    STQ     TMP$,,AUTO

      303    16617    4                       IF TMP$ ~= ADDR( NIL) AND

  16617  2 001112   000015 116000 3                  CMPQ    13
         2 001113   001133 600000 2                  TZE     s:16623
         2 001114   200110 470500                    LDP0    TFR$,,AUTO
         2 001115   000000 221100                    LDX1    0,,PR0
         2 001116   200135 471500                    LDP1    TMP$,,AUTO
         2 001117   100000 101100                    CMPX1   0,,PR1
         2 001120   001133 601000 2                  TNZ     s:16623
         2 001121   100000 222100                    LDX2    0,,PR1
         2 001122   040140 106540                    CMPC    fill='040'O
         2 001123   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:68   
         2 001124   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 001125   001133 601000 2                  TNZ     s:16623

      304    16618    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      305    16619    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      306    16620    5                           CMAP.TFRCTXTID(0) = J;

  16620  2 001126   200120 473500                    LDP3    CMAP$,,AUTO
         2 001127   200126 236100                    LDQ     J,,AUTO
         2 001130   000022 736000                    QLS     18
         2 001131   300001 552120                    STBQ    1,'20'O,PR3

      307    16621    5                           EXIT CP_DFLT_TFR;

  16621  2 001132   001137 710000 2                  TRA     s:16624

      308    16622    5                           END;
      309    16623    4                       END;

  16623  2 001133   200126 054100                    AOS     J,,AUTO
         2 001134   200126 236100                    LDQ     J,,AUTO
         2 001135   000000 116000 xsym               CMPQ    XSP_TFRLIST
         2 001136   001107 604400 2                  TMOZ    s:16616

      310    16624    3                   IF CMAP.ABSCTXTID(0) = 0 OR CMAP.TFRCTXTID(0) = 0 THEN

  16624  2 001137   200120 470500                    LDP0    CMAP$,,AUTO
         2 001140   000001 236100                    LDQ     1,,PR0
         2 001141   777000 316003                    CANQ    -512,DU
         2 001142   001145 600000 2                  TZE     s:16625
         2 001143   000777 316003                    CANQ    511,DU
         2 001144   001151 601000 2                  TNZ     s:16627

      311    16625    3                       CMAP.RESULT(0) = %XSP_RSLT_PREJECT;

  16625  2 001145   000016 376000 3                  ANQ     14
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:69   
         2 001146   002000 276007                    ORQ     1024,DL
         2 001147   000001 756100                    STQ     1,,PR0
         2 001150   001153 710000 2                  TRA     s:16628

      312    16626    3                   ELSE
      313    16627    3                       CMAP.RESULT(0) = %XSP_RSLT_ACCEPT;

  16627  2 001151   000016 236000 3                  LDQ     14
         2 001152   000001 356100                    ANSQ    1,,PR0

      314    16628    3                   CMAP.STATE(0) = %XSP_CMAP_RMTDEF;

  16628  2 001153   200120 470500                    LDP0    CMAP$,,AUTO
         2 001154   000003 236007                    LDQ     3,DL
         2 001155   000001 552104                    STBQ    1,'04'O,PR0

      315    16629    3                   CMAP.PEERCTXTID(0) = 0;

  16629  2 001156   200120 470500                    LDP0    CMAP$,,AUTO
         2 001157   000000 450100                    STZ     0,,PR0

      316    16630    3                   XSP$CONNECT.DFLTRSLT = CMAP.RESULT(0);

  16630  2 001160   200003 470500                    LDP0    @VBLK,,AUTO
         2 001161   000001 471500                    LDP1    1,,PR0
         2 001162   200120 473500                    LDP3    CMAP$,,AUTO
         2 001163   300001 236100                    LDQ     1,,PR3
         2 001164   000011 772000                    QRL     9
         2 001165   000017 376007                    ANQ     15,DL
         2 001166   100003 756100                    STQ     3,,PR1

      317    16631    3                   VBLK.DEFBITS(0) = %TRUE;

  16631  2 001167   400000 236003                    LDQ     -131072,DU
         2 001170   000007 256100                    ORSQ    7,,PR0

      318    16632    3                   END;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:70   

  16632  2 001171   200124 235100                    LDA     ITEMCUR,,AUTO
         2 001172   000001 735000                    ALS     1
         2 001173   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 001174   000007 376007                    ANQ     7,DL
         2 001175   000004 116007                    CMPQ    4,DL
         2 001176   001007 603000 2                  TRC     s:16480

      319    16633    2               BTMP = '000000000000'O;

  16633  2 001177   000001 236000 1                  LDQ     TWOZEROES+1
         2 001200   200117 756100                    STQ     BTMP,,AUTO

      320    16634                    %SCAN( LVL=3, TAG=C8, IMP=Y, TYP=BITSTR, OPT=Y,
      321    16635                            LEN=2, VAL=BTMP);  /* PresRequirements */

  16694  2 001201   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001202   000001 735000                    ALS     1
         2 001203   200117 630500                    EPPR0   BTMP,,AUTO
         2 001204   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  16722  2 001205   000021 236000 3                  LDQ     17
         2 001206   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16729  2 001207   003732 701000 2                  TSX1    SCAN
         2 001210   003731 702000 2                  TSX2    SCANERR

      322    16732    2               XSP$CONNECT.PFU = BTMP;

  16732  2 001211   200003 470500                    LDP0    @VBLK,,AUTO
         2 001212   000001 471500                    LDP1    1,,PR0
         2 001213   200117 236100                    LDQ     BTMP,,AUTO
         2 001214   600000 376003                    ANQ     -65536,DU
         2 001215   100013 756100                    STQ     11,,PR1

      323    16733    2               BTMP = '000000000000'O;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:71   
  16733  2 001216   000001 236000 1                  LDQ     TWOZEROES+1
         2 001217   200117 756100                    STQ     BTMP,,AUTO

      324    16734                    %SCAN( LVL=3, TAG=C9, IMP=Y, TYP=BITSTR, OPT=Y,
      325    16735                            LEN=11, VAL=BTMP); /* UserSessionRequirements */

  16794  2 001220   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001221   000001 735000                    ALS     1
         2 001222   200117 631500                    EPPR1   BTMP,,AUTO
         2 001223   200010 451505                    STP1    ITEMLIST+1,AL,AUTO

  16822  2 001224   000022 236000 3                  LDQ     18
         2 001225   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16829  2 001226   003732 701000 2                  TSX1    SCAN
         2 001227   003731 702000 2                  TSX2    SCANERR

      326    16832    2               XSP$CONNECT.SFU = BTMP;

  16832  2 001230   200003 470500                    LDP0    @VBLK,,AUTO
         2 001231   000001 471500                    LDP1    1,,PR0
         2 001232   200117 220100                    LDX0    BTMP,,AUTO
         2 001233   100010 440100                    SXL0    8,,PR1

      327    16833    2               DATALVL = 3;

  16833  2 001234   000003 235007                    LDA     3,DL
         2 001235   200121 755100                    STA     DATALVL,,AUTO
         2 001236   003510 710000 2                  TRA     s:22695

      328    16834        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:72   
      329    16835        /*****************************************************************************
      330    16836        *
      331    16837        *       SCONCNF --> CPA or CPR
      332    16838        *
      333    16839        *****************************************************************************/
      334    16840    2           CASE( %XSS_FNC_SCONCNF#);  /* should be a CPA or CPR PPDU */

      335    16841    2               XSP$CONNECT = XSS$CONNECT;

  16841  2 001237   200003 473500                    LDP3    @VBLK,,AUTO
         2 001240   300001 474500                    LDP4    1,,PR3
         2 001241   003100 060500                    CSL     bolr='003'O
         2 001242   100000 000614                    BDSC    0,,PR1                   by=0,bit=0,n=396
         2 001243   400000 000616                    BDSC    0,,PR4                   by=0,bit=0,n=398

      336    16842    2               XSP$CONNECT.FNC = %XSP_FNC_PCONCNF#;

  16842  2 001244   300001 471500                    LDP1    1,,PR3
         2 001245   034000 236003                    LDQ     14336,DU
         2 001246   100000 552140                    STBQ    0,'40'O,PR1

      337    16843    2               XSP$CONNECT.CALLING$ = XSP_SRCADDR$;

  16843  2 001247   300001 471500                    LDP1    1,,PR3
         2 001250   000000 236000 xsym               LDQ     XSP_SRCADDR$
         2 001251   100006 756100                    STQ     6,,PR1

      338    16844    2               XSP$CONNECT.RESPONDING$ = XSP_DSTADDR$;

  16844  2 001252   300001 471500                    LDP1    1,,PR3
         2 001253   000000 236000 xsym               LDQ     XSP_DSTADDR$
         2 001254   100007 756100                    STQ     7,,PR1

      339    16845    2               XSP$CONNECT.CTXT$ = XSP_TMPCTXT$;

  16845  2 001255   300001 471500                    LDP1    1,,PR3
         2 001256   000000 236000 xsym               LDQ     XSP_TMPCTXT$
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:73   
         2 001257   100005 756100                    STQ     5,,PR1

      340    16846    3               IF ITEMLIST.X.TAG(1) = %TAGSET THEN DO;

  16846  2 001260   200011 236100                    LDQ     ITEMLIST+2,,AUTO
         2 001261   377000 376007                    ANQ     130560,DL
         2 001262   061000 116007                    CMPQ    25088,DL
         2 001263   001601 601000 2                  TNZ     s:18154

      341    16847    3                   VBLK.EVENT = %XSP_PEV_CPA;

  16847  2 001264   000006 236007                    LDQ     6,DL
         2 001265   300006 552104                    STBQ    6,'04'O,PR3

      342    16848                        %SCAN( LVL=1, TYP=SET);  /* CPA */

  16935  2 001266   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001267   000001 735000                    ALS     1
         2 001270   061211 236007                    LDQ     25225,DL
         2 001271   200007 756105                    STQ     ITEMLIST,AL,AUTO

  16942  2 001272   003732 701000 2                  TSX1    SCAN
         2 001273   003731 702000 2                  TSX2    SCANERR

      343    16945                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SET);  /* ModeSelector */

  17032  2 001274   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001275   000001 735000                    ALS     1
         2 001276   240612 236007                    LDQ     82314,DL
         2 001277   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17039  2 001300   003732 701000 2                  TSX1    SCAN
         2 001301   003731 702000 2                  TSX2    SCANERR

      344    17042    3                   UTMP = 0;

  17042  2 001302   200136 450100                    STZ     UTMP,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:74   

      345    17043                        %SCAN( LVL=3, TAG=C0, TYP=INTG,
      346    17044                                LEN=1, VAL=UTMP);

  17097  2 001303   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001304   000001 735000                    ALS     1
         2 001305   200136 630500                    EPPR0   UTMP,,AUTO
         2 001306   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  17131  2 001307   000006 236000 3                  LDQ     6
         2 001310   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17138  2 001311   003732 701000 2                  TSX1    SCAN
         2 001312   003731 702000 2                  TSX2    SCANERR

      347    17141    3                   IF UTMP ~= 1 THEN

  17141  2 001313   200136 235100                    LDA     UTMP,,AUTO
         2 001314   000001 115007                    CMPA    1,DL
         2 001315   001317 600000 2                  TZE     s:17230

      348    17142    3                       ALTRETURN;

  17142  2 001316   000000 702200 xent               TSX2  ! X66_AALT

      349    17143                        %SCAN( LVL=2, TAG=C2, IMP=Y, TYP=SEQ, OPT=Y);

  17230  2 001317   000000 236000 xsym               LDQ     XSP_ITEMCNT
         2 001320   000001 736000                    QLS     1
         2 001321   642602 235007                    LDA     -47742,DL
         2 001322   200007 755106                    STA     ITEMLIST,QL,AUTO

  17237  2 001323   003732 701000 2                  TSX1    SCAN
         2 001324   003731 702000 2                  TSX2    SCANERR

      350    17240    3                   BTMP = '000000000000'O;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:75   
  17240  2 001325   000001 236000 1                  LDQ     TWOZEROES+1
         2 001326   200117 756100                    STQ     BTMP,,AUTO

      351    17241                        %SCAN( LVL=3, TAG=C0, IMP=Y, TYP=BITSTR, OPT=Y,
      352    17242                                LEN=1, VAL=BTMP);  /* ProtocolVersion */

  17301  2 001327   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001330   000001 735000                    ALS     1
         2 001331   200117 630500                    EPPR0   BTMP,,AUTO
         2 001332   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  17329  2 001333   000007 236000 3                  LDQ     7
         2 001334   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17336  2 001335   003732 701000 2                  TSX1    SCAN
         2 001336   003731 702000 2                  TSX2    SCANERR

      353    17339    3                   IF BTMP ~= '1'B THEN

  17339  2 001337   200117 236100                    LDQ     BTMP,,AUTO
         2 001340   400000 116003                    CMPQ    -131072,DU
         2 001341   001343 600000 2                  TZE     s:17341

      354    17340    3                       ALTRETURN;

  17340  2 001342   000000 702200 xent               TSX2  ! X66_AALT

      355    17341    3                   PSAP$ = ADDR( XSP$CONNECT.RESPONDING$->XSC$ADDRESS.PSAP);

  17341  2 001343   200003 470500                    LDP0    @VBLK,,AUTO
         2 001344   000001 471500                    LDP1    1,,PR0
         2 001345   100007 473500                    LDP3    7,,PR1
         2 001346   200132 453500                    STP3    PSAP$,,AUTO

      356    17342                        %SCAN( LVL=3, TAG=C3, IMP=Y, TYP=OCTETSTR, OPT=Y,
      357    17343                                LEN=224, VAL="PSAP.TXT"); /* RespondingPresSelector */

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:76   
  17427  2 001347   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001350   000001 735000                    ALS     1
         2 001351   200132 236100                    LDQ     PSAP$,,AUTO
         2 001352   200000 036007                    ADLQ    65536,DL
         2 001353   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  17430  2 001354   000023 236000 3                  LDQ     19
         2 001355   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17437  2 001356   003732 701000 2                  TSX1    SCAN
         2 001357   003731 702000 2                  TSX2    SCANERR

      358    17440                        %SCAN( LVL=3, TAG=C5, IMP=Y, TYP=SEQOF, OPT=Y);
             17440                            /* PresCtxtDefResultList */

  17527  2 001360   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001361   000001 735000                    ALS     1
         2 001362   645563 236007                    LDQ     -46221,DL
         2 001363   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17534  2 001364   003732 701000 2                  TSX1    SCAN
         2 001365   003731 702000 2                  TSX2    SCANERR

      359    17537    3                   I = 1;

  17537  2 001366   000001 235007                    LDA     1,DL
         2 001367   200123 755100                    STA     I,,AUTO

      360    17538    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 3);

  17538  2 001370   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 001371   000001 736000                    QLS     1
         2 001372   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 001373   000007 376007                    ANQ     7,DL
         2 001374   000004 116007                    CMPQ    4,DL
         2 001375   001541 602000 2                  TNC     s:17951

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:77   
      361    17539                            %SCAN( LVL=4, TYP=SEQ);

  17626  2 001376   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001377   000001 735000                    ALS     1
         2 001400   060204 236007                    LDQ     24708,DL
         2 001401   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17633  2 001402   003732 701000 2                  TSX1    SCAN
         2 001403   003731 702000 2                  TSX2    SCANERR

      362    17636    4                       TEMP = 0;

  17636  2 001404   200134 450100                    STZ     TEMP,,AUTO

      363    17637                            %SCAN( LVL=5, TAG=C0, IMP=Y, TYP=INTG,
      364    17638                                    LEN=4, VAL=TEMP);  /* Result */

  17691  2 001405   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001406   000001 735000                    ALS     1
         2 001407   200134 630500                    EPPR0   TEMP,,AUTO
         2 001410   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  17725  2 001411   000024 236000 3                  LDQ     20
         2 001412   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17732  2 001413   003732 701000 2                  TSX1    SCAN
         2 001414   003731 702000 2                  TSX2    SCANERR

      365    17735                            %SCAN( LVL=5, TAG=C1, IMP=Y, TYP=OBJID,
      366    17736                                    LEN=20, VAL=TFR$);  /* TfrSynName */

  17810  2 001415   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001416   000001 735000                    ALS     1
         2 001417   200110 236100                    LDQ     TFR$,,AUTO
         2 001420   400000 036007                    ADLQ    -131072,DL
         2 001421   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:78   
  17823  2 001422   200110 470500                    LDP0    TFR$,,AUTO
         2 001423   000000 236100                    LDQ     0,,PR0
         2 001424   777777 376003                    ANQ     -1,DU
         2 001425   201465 036007                    ADLQ    66357,DL
         2 001426   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17830  2 001427   003732 701000 2                  TSX1    SCAN
         2 001430   003731 702000 2                  TSX2    SCANERR

      367    17833    4                       UTMP = 0;

  17833  2 001431   200136 450100                    STZ     UTMP,,AUTO

      368    17834                            %SCAN( LVL=5, TAG=C2, IMP=Y, TYP=INTG,
      369    17835                                    LEN=4, VAL=UTMP);  /* ProviderReason */

  17888  2 001432   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001433   000001 735000                    ALS     1
         2 001434   200136 630500                    EPPR0   UTMP,,AUTO
         2 001435   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  17922  2 001436   000025 236000 3                  LDQ     21
         2 001437   200007 756105                    STQ     ITEMLIST,AL,AUTO

  17929  2 001440   003732 701000 2                  TSX1    SCAN
         2 001441   003731 702000 2                  TSX2    SCANERR

      370    17932    4   CPA_CTXT_TFR:
      371    17933    5                       DO J = 1 TO XSP_TFRLIST.COUNT(0);

  17933  2 001442   000001 235007       CPA_CTXT_TFR LDA     1,DL
         2 001443   200126 755100                    STA     J,,AUTO
         2 001444   001530 710000 2                  TRA     s:17949+1

      372    17934    5                           TMP$ = XSP_TFRLIST.CTXT$( J);

  17934  2 001445   200126 720100                    LXL0    J,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:79   
         2 001446   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 001447   200135 756100                    STQ     TMP$,,AUTO

      373    17935    5                           IF TMP$ ~= ADDR( NIL) AND

  17935  2 001450   000015 116000 3                  CMPQ    13
         2 001451   001527 600000 2                  TZE     s:17949
         2 001452   200110 470500                    LDP0    TFR$,,AUTO
         2 001453   000000 221100                    LDX1    0,,PR0
         2 001454   200135 471500                    LDP1    TMP$,,AUTO
         2 001455   100000 101100                    CMPX1   0,,PR1
         2 001456   001527 601000 2                  TNZ     s:17949
         2 001457   100000 222100                    LDX2    0,,PR1
         2 001460   040140 106540                    CMPC    fill='040'O
         2 001461   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         2 001462   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 001463   001527 601000 2                  TNZ     s:17949

      374    17936    5                                   TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      375    17937    6                                   TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      376    17938    7                               DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEF);

  17938  2 001464   200123 235100                    LDA     I,,AUTO
         2 001465   000001 735000                    ALS     1
         2 001466   200120 473500                    LDP3    CMAP$,,AUTO
         2 001467   300001 236105                    LDQ     1,AL,PR3
         2 001470   000777 376007                    ANQ     511,DL
         2 001471   000001 116007                    CMPQ    1,DL
         2 001472   001505 600000 2                  TZE     s:17943

      377    17939    7                                   I = I + 1;

  17939  2 001473   200123 054100                    AOS     I,,AUTO

      378    17940    7                                   IF I > %XSP_MAX_CTXTID THEN

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:80   
  17940  2 001474   200123 235100                    LDA     I,,AUTO
         2 001475   000022 115007                    CMPA    18,DL
         2 001476   003731 605400 2                  TPNZ    SCANERR

      379    17941    7                                       GOTO SCANERR;
      380    17942    7                                   END;

  17942  2 001477   000001 735000                    ALS     1
         2 001500   200120 470500                    LDP0    CMAP$,,AUTO
         2 001501   000001 236105                    LDQ     1,AL,PR0
         2 001502   000777 376007                    ANQ     511,DL
         2 001503   000001 116007                    CMPQ    1,DL
         2 001504   001473 601000 2                  TNZ     s:17939

      381    17943    6                               IF CMAP.TFRCTXTID( I) ~= J THEN

  17943  2 001505   200120 470500                    LDP0    CMAP$,,AUTO
         2 001506   000001 236105                    LDQ     1,AL,PR0
         2 001507   000022 772000                    QRL     18
         2 001510   000777 376007                    ANQ     511,DL
         2 001511   200126 116100                    CMPQ    J,,AUTO
         2 001512   003731 601000 2                  TNZ     SCANERR

      382    17944    6                                   GOTO SCANERR;
      383    17945    6                               CMAP.RESULT( I) = TEMP;

  17945  2 001513   200134 236100                    LDQ     TEMP,,AUTO
         2 001514   000011 736000                    QLS     9
         2 001515   000001 676105                    ERQ     1,AL,PR0
         2 001516   017000 376007                    ANQ     7680,DL
         2 001517   000001 656105                    ERSQ    1,AL,PR0

      384    17946    6                               CMAP.REASON( I) = UTMP;

  17946  2 001520   200120 470500                    LDP0    CMAP$,,AUTO
         2 001521   200136 236100                    LDQ     UTMP,,AUTO
         2 001522   000015 736000                    QLS     13
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:81   
         2 001523   000001 676105                    ERQ     1,AL,PR0
         2 001524   360000 376007                    ANQ     122880,DL
         2 001525   000001 656105                    ERSQ    1,AL,PR0

      385    17947    6                               EXIT CPA_CTXT_TFR;

  17947  2 001526   001533 710000 2                  TRA     s:17950

      386    17948    6                               END;
      387    17949    5                           END;

  17949  2 001527   200126 054100                    AOS     J,,AUTO
         2 001530   200126 236100                    LDQ     J,,AUTO
         2 001531   000000 116000 xsym               CMPQ    XSP_TFRLIST
         2 001532   001445 604400 2                  TMOZ    s:17934

      388    17950    4                       END;

  17950  2 001533   200124 235100                    LDA     ITEMCUR,,AUTO
         2 001534   000001 735000                    ALS     1
         2 001535   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 001536   000007 376007                    ANQ     7,DL
         2 001537   000004 116007                    CMPQ    4,DL
         2 001540   001376 603000 2                  TRC     s:17626

      389    17951    3                   BTMP = '000000000000'O;

  17951  2 001541   000001 236000 1                  LDQ     TWOZEROES+1
         2 001542   200117 756100                    STQ     BTMP,,AUTO

      390    17952                        %SCAN( LVL=3, TAG=C8, IMP=Y, TYP=BITSTR, OPT=Y,
      391    17953                                LEN=2, VAL=BTMP);  /* PresRequirements */

  18012  2 001543   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001544   000001 735000                    ALS     1
         2 001545   200117 630500                    EPPR0   BTMP,,AUTO
         2 001546   200010 450505                    STP0    ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:82   

  18040  2 001547   000021 236000 3                  LDQ     17
         2 001550   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18047  2 001551   003732 701000 2                  TSX1    SCAN
         2 001552   003731 702000 2                  TSX2    SCANERR

      392    18050    3                   XSP$CONNECT.PFU = BTMP;

  18050  2 001553   200003 470500                    LDP0    @VBLK,,AUTO
         2 001554   000001 471500                    LDP1    1,,PR0
         2 001555   200117 236100                    LDQ     BTMP,,AUTO
         2 001556   600000 376003                    ANQ     -65536,DU
         2 001557   100013 756100                    STQ     11,,PR1

      393    18051    3                   BTMP = '000000000000'O;

  18051  2 001560   000001 236000 1                  LDQ     TWOZEROES+1
         2 001561   200117 756100                    STQ     BTMP,,AUTO

      394    18052                        %SCAN( LVL=3, TAG=C9, IMP=Y, TYP=BITSTR, OPT=Y,
      395    18053                                LEN=11, VAL=BTMP);  /* UserSessionRequirements */

  18112  2 001562   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001563   000001 735000                    ALS     1
         2 001564   200117 631500                    EPPR1   BTMP,,AUTO
         2 001565   200010 451505                    STP1    ITEMLIST+1,AL,AUTO

  18140  2 001566   000022 236000 3                  LDQ     18
         2 001567   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18147  2 001570   003732 701000 2                  TSX1    SCAN
         2 001571   003731 702000 2                  TSX2    SCANERR

      396    18150    3                   XSP$CONNECT.SFU = BTMP;

  18150  2 001572   200003 470500                    LDP0    @VBLK,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:83   
         2 001573   000001 471500                    LDP1    1,,PR0
         2 001574   200117 220100                    LDX0    BTMP,,AUTO
         2 001575   100010 440100                    SXL0    8,,PR1

      397    18151    3                   DATALVL = 3;

  18151  2 001576   000003 235007                    LDA     3,DL
         2 001577   200121 755100                    STA     DATALVL,,AUTO

      398    18152    3                   EXIT SFNCCASE;

  18152  2 001600   003510 710000 2                  TRA     s:22695

      399    18153    3                   END;
      400    18154    3               IF ITEMLIST.X.TAG(1) = %TAGSEQ THEN DO;

  18154  2 001601   060000 116007                    CMPQ    24576,DL
         2 001602   002050 601000 2                  TNZ     s:19067

      401    18155    3                   VBLK.EVENT = %XSP_PEV_CPR;

  18155  2 001603   000007 236007                    LDQ     7,DL
         2 001604   300006 552104                    STBQ    6,'04'O,PR3

      402    18156                        %SCAN( LVL=1, TYP=SEQ);  /* CPR */

  18243  2 001605   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001606   000001 735000                    ALS     1
         2 001607   060201 236007                    LDQ     24705,DL
         2 001610   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18250  2 001611   003732 701000 2                  TSX1    SCAN
         2 001612   003731 702000 2                  TSX2    SCANERR

      403    18253    3                   BTMP = '000000000000'O;

  18253  2 001613   000001 236000 1                  LDQ     TWOZEROES+1
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:84   
         2 001614   200117 756100                    STQ     BTMP,,AUTO

      404    18254                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=BITSTR, OPT=Y,
      405    18255                                LEN=1, VAL=BTMP);  /* ProtocolVersion */

  18314  2 001615   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001616   000001 735000                    ALS     1
         2 001617   200117 630500                    EPPR0   BTMP,,AUTO
         2 001620   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  18342  2 001621   000026 236000 3                  LDQ     22
         2 001622   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18349  2 001623   003732 701000 2                  TSX1    SCAN
         2 001624   003731 702000 2                  TSX2    SCANERR

      406    18352    3                   IF BTMP ~= '1'B THEN

  18352  2 001625   200117 236100                    LDQ     BTMP,,AUTO
         2 001626   400000 116003                    CMPQ    -131072,DU
         2 001627   001631 600000 2                  TZE     s:18354

      407    18353    3                       ALTRETURN;

  18353  2 001630   000000 702200 xent               TSX2  ! X66_AALT

      408    18354    3                   PSAP$ = ADDR( XSP$CONNECT.RESPONDING$->XSC$ADDRESS.PSAP);

  18354  2 001631   200003 470500                    LDP0    @VBLK,,AUTO
         2 001632   000001 471500                    LDP1    1,,PR0
         2 001633   100007 473500                    LDP3    7,,PR1
         2 001634   200132 453500                    STP3    PSAP$,,AUTO

      409    18355                        %SCAN( LVL=2, TAG=C3, IMP=Y, TYP=OCTETSTR, OPT=Y,
      410    18356                                LEN=224, VAL="PSAP.TXT"); /* RespondingPresSelector */

  18440  2 001635   000000 235000 xsym               LDA     XSP_ITEMCNT
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:85   
         2 001636   000001 735000                    ALS     1
         2 001637   200132 236100                    LDQ     PSAP$,,AUTO
         2 001640   200000 036007                    ADLQ    65536,DL
         2 001641   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  18443  2 001642   000027 236000 3                  LDQ     23
         2 001643   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18450  2 001644   003732 701000 2                  TSX1    SCAN
         2 001645   003731 702000 2                  TSX2    SCANERR

      411    18453                        %SCAN( LVL=2, TAG=C5, IMP=Y, TYP=SEQOF, OPT=Y);
             18453                            /* PresCtxtDefResultList */

  18540  2 001646   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001647   000001 735000                    ALS     1
         2 001650   645562 236007                    LDQ     -46222,DL
         2 001651   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18547  2 001652   003732 701000 2                  TSX1    SCAN
         2 001653   003731 702000 2                  TSX2    SCANERR

      412    18550    3                   I = 1;

  18550  2 001654   000001 235007                    LDA     1,DL
         2 001655   200123 755100                    STA     I,,AUTO

      413    18551    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  18551  2 001656   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 001657   000001 736000                    QLS     1
         2 001660   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 001661   000007 376007                    ANQ     7,DL
         2 001662   000003 116007                    CMPQ    3,DL
         2 001663   002027 602000 2                  TNC     s:18964

      414    18552                            %SCAN( LVL=3, TYP=SEQ);
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:86   

  18639  2 001664   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001665   000001 735000                    ALS     1
         2 001666   060203 236007                    LDQ     24707,DL
         2 001667   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18646  2 001670   003732 701000 2                  TSX1    SCAN
         2 001671   003731 702000 2                  TSX2    SCANERR

      415    18649    4                       TEMP = 0;

  18649  2 001672   200134 450100                    STZ     TEMP,,AUTO

      416    18650                            %SCAN( LVL=4, TAG=C0, IMP=Y, TYP=INTG,
      417    18651                                    LEN=4, VAL=TEMP);  /* Result */

  18704  2 001673   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001674   000001 735000                    ALS     1
         2 001675   200134 630500                    EPPR0   TEMP,,AUTO
         2 001676   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  18738  2 001677   000030 236000 3                  LDQ     24
         2 001700   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18745  2 001701   003732 701000 2                  TSX1    SCAN
         2 001702   003731 702000 2                  TSX2    SCANERR

      418    18748                            %SCAN( LVL=4, TAG=C1, IMP=Y, TYP=OBJID,
      419    18749                                    LEN=20, VAL=TFR$);  /* TfrSynName */

  18823  2 001703   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001704   000001 735000                    ALS     1
         2 001705   200110 236100                    LDQ     TFR$,,AUTO
         2 001706   400000 036007                    ADLQ    -131072,DL
         2 001707   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  18836  2 001710   200110 470500                    LDP0    TFR$,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:87   
         2 001711   000000 236100                    LDQ     0,,PR0
         2 001712   777777 376003                    ANQ     -1,DU
         2 001713   201464 036007                    ADLQ    66356,DL
         2 001714   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18843  2 001715   003732 701000 2                  TSX1    SCAN
         2 001716   003731 702000 2                  TSX2    SCANERR

      420    18846    4                       UTMP = 0;

  18846  2 001717   200136 450100                    STZ     UTMP,,AUTO

      421    18847                            %SCAN( LVL=4, TAG=C2, IMP=Y, TYP=INTG,
      422    18848                                    LEN=4, VAL=UTMP);  /* ProviderReason */

  18901  2 001720   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 001721   000001 735000                    ALS     1
         2 001722   200136 630500                    EPPR0   UTMP,,AUTO
         2 001723   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  18935  2 001724   000031 236000 3                  LDQ     25
         2 001725   200007 756105                    STQ     ITEMLIST,AL,AUTO

  18942  2 001726   003732 701000 2                  TSX1    SCAN
         2 001727   003731 702000 2                  TSX2    SCANERR

      423    18945    4   CPR_CTXT_TFR:
      424    18946    5                       DO J = 1 TO XSP_TFRLIST.COUNT(0);

  18946  2 001730   000001 235007       CPR_CTXT_TFR LDA     1,DL
         2 001731   200126 755100                    STA     J,,AUTO
         2 001732   002016 710000 2                  TRA     s:18962+1

      425    18947    5                           TMP$ = XSP_TFRLIST.CTXT$( J);

  18947  2 001733   200126 720100                    LXL0    J,,AUTO
         2 001734   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:88   
         2 001735   200135 756100                    STQ     TMP$,,AUTO

      426    18948    5                           IF TMP$ ~= ADDR( NIL) AND

  18948  2 001736   000015 116000 3                  CMPQ    13
         2 001737   002015 600000 2                  TZE     s:18962
         2 001740   200110 470500                    LDP0    TFR$,,AUTO
         2 001741   000000 221100                    LDX1    0,,PR0
         2 001742   200135 471500                    LDP1    TMP$,,AUTO
         2 001743   100000 101100                    CMPX1   0,,PR1
         2 001744   002015 601000 2                  TNZ     s:18962
         2 001745   100000 222100                    LDX2    0,,PR1
         2 001746   040140 106540                    CMPC    fill='040'O
         2 001747   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         2 001750   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 001751   002015 601000 2                  TNZ     s:18962

      427    18949    5                                   TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      428    18950    6                                   TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      429    18951    7                               DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEF);

  18951  2 001752   200123 235100                    LDA     I,,AUTO
         2 001753   000001 735000                    ALS     1
         2 001754   200120 473500                    LDP3    CMAP$,,AUTO
         2 001755   300001 236105                    LDQ     1,AL,PR3
         2 001756   000777 376007                    ANQ     511,DL
         2 001757   000001 116007                    CMPQ    1,DL
         2 001760   001773 600000 2                  TZE     s:18956

      430    18952    7                                   I = I + 1;

  18952  2 001761   200123 054100                    AOS     I,,AUTO

      431    18953    7                                   IF I > %XSP_MAX_CTXTID THEN

  18953  2 001762   200123 235100                    LDA     I,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:89   
         2 001763   000022 115007                    CMPA    18,DL
         2 001764   003731 605400 2                  TPNZ    SCANERR

      432    18954    7                                       GOTO SCANERR;
      433    18955    7                                   END;

  18955  2 001765   000001 735000                    ALS     1
         2 001766   200120 470500                    LDP0    CMAP$,,AUTO
         2 001767   000001 236105                    LDQ     1,AL,PR0
         2 001770   000777 376007                    ANQ     511,DL
         2 001771   000001 116007                    CMPQ    1,DL
         2 001772   001761 601000 2                  TNZ     s:18952

      434    18956    6                               IF CMAP.TFRCTXTID( I) ~= J THEN

  18956  2 001773   200120 470500                    LDP0    CMAP$,,AUTO
         2 001774   000001 236105                    LDQ     1,AL,PR0
         2 001775   000022 772000                    QRL     18
         2 001776   000777 376007                    ANQ     511,DL
         2 001777   200126 116100                    CMPQ    J,,AUTO
         2 002000   003731 601000 2                  TNZ     SCANERR

      435    18957    6                                   GOTO SCANERR;
      436    18958    6                               CMAP.RESULT( I) = TEMP;

  18958  2 002001   200134 236100                    LDQ     TEMP,,AUTO
         2 002002   000011 736000                    QLS     9
         2 002003   000001 676105                    ERQ     1,AL,PR0
         2 002004   017000 376007                    ANQ     7680,DL
         2 002005   000001 656105                    ERSQ    1,AL,PR0

      437    18959    6                               CMAP.REASON( I) = UTMP;

  18959  2 002006   200120 470500                    LDP0    CMAP$,,AUTO
         2 002007   200136 236100                    LDQ     UTMP,,AUTO
         2 002010   000015 736000                    QLS     13
         2 002011   000001 676105                    ERQ     1,AL,PR0
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:90   
         2 002012   360000 376007                    ANQ     122880,DL
         2 002013   000001 656105                    ERSQ    1,AL,PR0

      438    18960    6                               EXIT CPR_CTXT_TFR;

  18960  2 002014   002021 710000 2                  TRA     s:18963

      439    18961    6                               END;
      440    18962    5                           END;

  18962  2 002015   200126 054100                    AOS     J,,AUTO
         2 002016   200126 236100                    LDQ     J,,AUTO
         2 002017   000000 116000 xsym               CMPQ    XSP_TFRLIST
         2 002020   001733 604400 2                  TMOZ    s:18947

      441    18963    4                       END;

  18963  2 002021   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002022   000001 735000                    ALS     1
         2 002023   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002024   000007 376007                    ANQ     7,DL
         2 002025   000003 116007                    CMPQ    3,DL
         2 002026   001664 603000 2                  TRC     s:18639

      442    18964    3                   UTMP = 0;

  18964  2 002027   200136 450100                    STZ     UTMP,,AUTO

      443    18965                        %SCAN( LVL=2, TAG=C10, IMP=Y, TYP=INTG, OPT=Y,
      444    18966                                LEN=4, VAL=UTMP);  /* ProviderReason */

  19019  2 002030   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002031   000001 735000                    ALS     1
         2 002032   200136 630500                    EPPR0   UTMP,,AUTO
         2 002033   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  19053  2 002034   000032 236000 3                  LDQ     26
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:91   
         2 002035   200007 756105                    STQ     ITEMLIST,AL,AUTO

  19060  2 002036   003732 701000 2                  TSX1    SCAN
         2 002037   003731 702000 2                  TSX2    SCANERR

      445    19063    3                   XSP$CONNECT.REASON = UTMP;

  19063  2 002040   200003 470500                    LDP0    @VBLK,,AUTO
         2 002041   000001 471500                    LDP1    1,,PR0
         2 002042   200136 236100                    LDQ     UTMP,,AUTO
         2 002043   000011 736000                    QLS     9
         2 002044   100000 552110                    STBQ    0,'10'O,PR1

      446    19064    3                   DATALVL = 2;

  19064  2 002045   000002 235007                    LDA     2,DL
         2 002046   200121 755100                    STA     DATALVL,,AUTO

      447    19065    3                   EXIT SFNCCASE;

  19065  2 002047   003510 710000 2                  TRA     s:22695

      448    19066    3                   END;
      449    19067    2               GOTO SCANERR;

  19067  2 002050   003731 710000 2                  TRA     SCANERR

      450    19068        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:92   
      451    19069        /*****************************************************************************
      452    19070        *
      453    19071        *       SDATIND --> TD
      454    19072        *
      455    19073        *****************************************************************************/
      456    19074    2           CASE( %XSS_FNC_SDATIND#);  /* should be a TD PPDU */

      457    19075    2               XSP$DATA = XSP_DATA;

  19075  2 002051   200003 473500                    LDP3    @VBLK,,AUTO
         2 002052   300001 474500                    LDP4    1,,PR3
         2 002053   000100 100400                    MLR     fill='000'O
         2 002054   000000 000014 xsym               ADSC9   XSP_DATA                 cn=0,n=12
         2 002055   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      458    19076    2               XSP$DATA.FNC = %XSP_FNC_PDATIND#;

  19076  2 002056   300001 471500                    LDP1    1,,PR3
         2 002057   040000 236003                    LDQ     16384,DU
         2 002060   100000 552140                    STBQ    0,'40'O,PR1

      459    19077    2               DATALVL = 1;

  19077  2 002061   000001 235007                    LDA     1,DL
         2 002062   200121 755100                    STA     DATALVL,,AUTO
         2 002063   003510 710000 2                  TRA     s:22695

      460    19078        /*****************************************************************************
      461    19079        *
      462    19080        *       SEXPIND --> TE
      463    19081        *
      464    19082        *****************************************************************************/
      465    19083    2           CASE( %XSS_FNC_SEXPIND#);  /* should be a TE PPDU */

      466    19084    2               XSP$EXPEDITED_DATA = XSP_EXPEDITED_DATA;

  19084  2 002064   200003 473500                    LDP3    @VBLK,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:93   
         2 002065   300001 474500                    LDP4    1,,PR3
         2 002066   000100 100400                    MLR     fill='000'O
         2 002067   000000 000014 xsym               ADSC9   XSP_EXPEDITED_DATA       cn=0,n=12
         2 002070   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      467    19085    2               XSP$EXPEDITED_DATA.FNC = %XSP_FNC_PEXPIND#;

  19085  2 002071   300001 471500                    LDP1    1,,PR3
         2 002072   042000 236003                    LDQ     17408,DU
         2 002073   100000 552140                    STBQ    0,'40'O,PR1

      468    19086    2               DATALVL = 1;

  19086  2 002074   000001 235007                    LDA     1,DL
         2 002075   200121 755100                    STA     DATALVL,,AUTO
         2 002076   003510 710000 2                  TRA     s:22695

      469    19087        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:94   
      470    19088        /*****************************************************************************
      471    19089        *
      472    19090        *       SRSXIND --> RS
      473    19091        *
      474    19092        *****************************************************************************/
      475    19093    2           CASE( %XSS_FNC_SRSXIND#);  /* should be an RS PPDU */

      476    19094    2               XSP$RESYNCHRONIZE = XSP_RESYNCHRONIZE;

  19094  2 002077   200003 473500                    LDP3    @VBLK,,AUTO
         2 002100   300001 474500                    LDP4    1,,PR3
         2 002101   000100 100400                    MLR     fill='000'O
         2 002102   000000 000030 xsym               ADSC9   XSP_RESYNCHRONIZE        cn=0,n=24
         2 002103   400000 000030                    ADSC9   0,,PR4                   cn=0,n=24

      477    19095    2               XSP$RESYNCHRONIZE.FNC = %XSP_FNC_PRSXIND#;

  19095  2 002104   300001 471500                    LDP1    1,,PR3
         2 002105   050000 236003                    LDQ     20480,DU
         2 002106   100000 552140                    STBQ    0,'40'O,PR1

      478    19096                    %SCAN( LVL=1, TYP=SEQ);  /* RS */

  19183  2 002107   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002110   000001 735000                    ALS     1
         2 002111   060201 236007                    LDQ     24705,DL
         2 002112   200007 756105                    STQ     ITEMLIST,AL,AUTO

  19190  2 002113   003732 701000 2                  TSX1    SCAN
         2 002114   003731 702000 2                  TSX2    SCANERR

      479    19193                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y); /* PresCtxtIdentList */

  19280  2 002115   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002116   000001 735000                    ALS     1
         2 002117   640562 236007                    LDQ     -48782,DL
         2 002120   200007 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:95   

  19287  2 002121   003732 701000 2                  TSX1    SCAN
         2 002122   003731 702000 2                  TSX2    SCANERR

      480    19290    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  19290  2 002123   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002124   000001 735000                    ALS     1
         2 002125   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002126   000007 376007                    ANQ     7,DL
         2 002127   000003 116007                    CMPQ    3,DL
         2 002130   002234 602000 2                  TNC     s:19596

      481    19291                        %SCAN( LVL=3, TYP=SEQ);

  19378  2 002131   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002132   000001 735000                    ALS     1
         2 002133   060203 236007                    LDQ     24707,DL
         2 002134   200007 756105                    STQ     ITEMLIST,AL,AUTO

  19385  2 002135   003732 701000 2                  TSX1    SCAN
         2 002136   003731 702000 2                  TSX2    SCANERR

      482    19388    3                   UTMP = 0;

  19388  2 002137   200136 450100                    STZ     UTMP,,AUTO

      483    19389                        %SCAN( LVL=4, TYP=INTG,
      484    19390                                LEN=4, VAL=UTMP);  /* PresCtxtIdent */

  19443  2 002140   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002141   000001 735000                    ALS     1
         2 002142   200136 630500                    EPPR0   UTMP,,AUTO
         2 002143   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  19477  2 002144   000033 236000 3                  LDQ     27
         2 002145   200007 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:96   

  19484  2 002146   003732 701000 2                  TSX1    SCAN
         2 002147   003731 702000 2                  TSX2    SCANERR

      485    19487                        %SCAN( LVL=4, TYP=OBJID,
      486    19488                                LEN=20, VAL=TFR$);  /* TfrSynName */

  19562  2 002150   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002151   000001 735000                    ALS     1
         2 002152   200110 236100                    LDQ     TFR$,,AUTO
         2 002153   400000 036007                    ADLQ    -131072,DL
         2 002154   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  19575  2 002155   200110 470500                    LDP0    TFR$,,AUTO
         2 002156   000000 236100                    LDQ     0,,PR0
         2 002157   777777 376003                    ANQ     -1,DU
         2 002160   006064 036007                    ADLQ    3124,DL
         2 002161   200007 756105                    STQ     ITEMLIST,AL,AUTO

  19582  2 002162   003732 701000 2                  TSX1    SCAN
         2 002163   003731 702000 2                  TSX2    SCANERR

      487    19585    3   RS_CTXT_TFR:
      488    19586    4                   DO I = 1 TO %XSP_MAX_CTXTID;

  19586  2 002164   000001 235007       RS_CTXT_TFR  LDA     1,DL
         2 002165   200123 755100                    STA     I,,AUTO

      489    19587    4                       TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));

  19587  2 002166   200123 235100                    LDA     I,,AUTO
         2 002167   000001 735000                    ALS     1
         2 002170   200120 470500                    LDP0    CMAP$,,AUTO
         2 002171   000001 220105                    LDX0    1,AL,PR0
         2 002172   000777 360003                    ANX0    511,DU
         2 002173   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 002174   200135 756100                    STQ     TMP$,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:97   

      490    19588    4                       IF CMAP.PEERCTXTID( I) = UTMP AND

  19588  2 002175   000000 236105                    LDQ     0,AL,PR0
         2 002176   200136 116100                    CMPQ    UTMP,,AUTO
         2 002177   002222 601000 2                  TNZ     s:19594
         2 002200   200110 471500                    LDP1    TFR$,,AUTO
         2 002201   100000 221100                    LDX1    0,,PR1
         2 002202   200135 473500                    LDP3    TMP$,,AUTO
         2 002203   300000 101100                    CMPX1   0,,PR3
         2 002204   002222 601000 2                  TNZ     s:19594
         2 002205   300000 222100                    LDX2    0,,PR3
         2 002206   040140 106540                    CMPC    fill='040'O
         2 002207   100000 400011                    ADSC9   0,,PR1                   cn=2,n=*X1
         2 002210   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         2 002211   002222 601000 2                  TNZ     s:19594

      491    19589    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      492    19590    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      493    19591    5                           VBLK.DEFBITS( I) = %TRUE;

  19591  2 002212   200123 235100                    LDA     I,,AUTO
         2 002213   002215 605000 2                  TPL     s:19591+3
         2 002214   000044 035003                    ADLA    36,DU
         2 002215   200003 474500                    LDP4    @VBLK,,AUTO
         2 002216   003105 060400                    CSL     bolr='003'O
         2 002217   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 002220   400007 000001                    BDSC    7,A,PR4                  by=0,bit=0,n=1

      494    19592    5                           EXIT RS_CTXT_TFR;

  19592  2 002221   002226 710000 2                  TRA     s:19595

      495    19593    5                           END;
      496    19594    4                       END;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:98   
  19594  2 002222   200123 054100                    AOS     I,,AUTO
         2 002223   200123 235100                    LDA     I,,AUTO
         2 002224   000022 115007                    CMPA    18,DL
         2 002225   002166 604400 2                  TMOZ    s:19587

      497    19595    3                   END;

  19595  2 002226   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002227   000001 735000                    ALS     1
         2 002230   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002231   000007 376007                    ANQ     7,DL
         2 002232   000003 116007                    CMPQ    3,DL
         2 002233   002131 603000 2                  TRC     s:19378

      498    19596    2               DATALVL = 2;

  19596  2 002234   000002 235007                    LDA     2,DL
         2 002235   200121 755100                    STA     DATALVL,,AUTO
         2 002236   003510 710000 2                  TRA     s:22695

      499    19597        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:99   
      500    19598        /*****************************************************************************
      501    19599        *
      502    19600        *       SRSXCNF --> RSA
      503    19601        *
      504    19602        *****************************************************************************/
      505    19603    2           CASE( %XSS_FNC_SRSXCNF#);  /* should be an RSA PPDU */

      506    19604    2               XSP$RESYNCHRONIZE = XSP_RESYNCHRONIZE;

  19604  2 002237   200003 473500                    LDP3    @VBLK,,AUTO
         2 002240   300001 474500                    LDP4    1,,PR3
         2 002241   000100 100400                    MLR     fill='000'O
         2 002242   000000 000030 xsym               ADSC9   XSP_RESYNCHRONIZE        cn=0,n=24
         2 002243   400000 000030                    ADSC9   0,,PR4                   cn=0,n=24

      507    19605    2               XSP$RESYNCHRONIZE.FNC = %XSP_FNC_PRSXCNF#;

  19605  2 002244   300001 471500                    LDP1    1,,PR3
         2 002245   052000 236003                    LDQ     21504,DU
         2 002246   100000 552140                    STBQ    0,'40'O,PR1

      508    19606                    %SCAN( LVL=1, TYP=SEQ);  /* RSA */

  19693  2 002247   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002250   000001 735000                    ALS     1
         2 002251   060201 236007                    LDQ     24705,DL
         2 002252   200007 756105                    STQ     ITEMLIST,AL,AUTO

  19700  2 002253   003732 701000 2                  TSX1    SCAN
         2 002254   003731 702000 2                  TSX2    SCANERR

      509    19703                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y); /* PresCtxtIdentList */

  19790  2 002255   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002256   000001 735000                    ALS     1
         2 002257   640562 236007                    LDQ     -48782,DL
         2 002260   200007 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:100  

  19797  2 002261   003732 701000 2                  TSX1    SCAN
         2 002262   003731 702000 2                  TSX2    SCANERR

      510    19800    3               DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  19800  2 002263   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002264   000001 735000                    ALS     1
         2 002265   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002266   000007 376007                    ANQ     7,DL
         2 002267   000003 116007                    CMPQ    3,DL
         2 002270   002374 602000 2                  TNC     s:20106

      511    19801                        %SCAN( LVL=3, TYP=SEQ);

  19888  2 002271   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002272   000001 735000                    ALS     1
         2 002273   060203 236007                    LDQ     24707,DL
         2 002274   200007 756105                    STQ     ITEMLIST,AL,AUTO

  19895  2 002275   003732 701000 2                  TSX1    SCAN
         2 002276   003731 702000 2                  TSX2    SCANERR

      512    19898    3                   UTMP = 0;

  19898  2 002277   200136 450100                    STZ     UTMP,,AUTO

      513    19899                        %SCAN( LVL=4, TYP=INTG,
      514    19900                                LEN=4, VAL=UTMP);  /* PresCtxtIdent */

  19953  2 002300   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002301   000001 735000                    ALS     1
         2 002302   200136 630500                    EPPR0   UTMP,,AUTO
         2 002303   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  19987  2 002304   000033 236000 3                  LDQ     27
         2 002305   200007 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:101  

  19994  2 002306   003732 701000 2                  TSX1    SCAN
         2 002307   003731 702000 2                  TSX2    SCANERR

      515    19997                        %SCAN( LVL=4, TYP=OBJID,
      516    19998                                LEN=20, VAL=TFR$);  /* TfrSynName */

  20072  2 002310   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002311   000001 735000                    ALS     1
         2 002312   200110 236100                    LDQ     TFR$,,AUTO
         2 002313   400000 036007                    ADLQ    -131072,DL
         2 002314   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  20085  2 002315   200110 470500                    LDP0    TFR$,,AUTO
         2 002316   000000 236100                    LDQ     0,,PR0
         2 002317   777777 376003                    ANQ     -1,DU
         2 002320   006064 036007                    ADLQ    3124,DL
         2 002321   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20092  2 002322   003732 701000 2                  TSX1    SCAN
         2 002323   003731 702000 2                  TSX2    SCANERR

      517    20095    3   RSA_CTXT_TFR:
      518    20096    4                   DO I = 1 TO %XSP_MAX_CTXTID;

  20096  2 002324   000001 235007       RSA_CTXT_TFR LDA     1,DL
         2 002325   200123 755100                    STA     I,,AUTO

      519    20097    4                       TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));

  20097  2 002326   200123 235100                    LDA     I,,AUTO
         2 002327   000001 735000                    ALS     1
         2 002330   200120 470500                    LDP0    CMAP$,,AUTO
         2 002331   000001 220105                    LDX0    1,AL,PR0
         2 002332   000777 360003                    ANX0    511,DU
         2 002333   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 002334   200135 756100                    STQ     TMP$,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:102  

      520    20098    4                       IF CMAP.PEERCTXTID( I) = UTMP AND

  20098  2 002335   000000 236105                    LDQ     0,AL,PR0
         2 002336   200136 116100                    CMPQ    UTMP,,AUTO
         2 002337   002362 601000 2                  TNZ     s:20104
         2 002340   200110 471500                    LDP1    TFR$,,AUTO
         2 002341   100000 221100                    LDX1    0,,PR1
         2 002342   200135 473500                    LDP3    TMP$,,AUTO
         2 002343   300000 101100                    CMPX1   0,,PR3
         2 002344   002362 601000 2                  TNZ     s:20104
         2 002345   300000 222100                    LDX2    0,,PR3
         2 002346   040140 106540                    CMPC    fill='040'O
         2 002347   100000 400011                    ADSC9   0,,PR1                   cn=2,n=*X1
         2 002350   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         2 002351   002362 601000 2                  TNZ     s:20104

      521    20099    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      522    20100    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      523    20101    5                           VBLK.DEFBITS( I) = %TRUE;

  20101  2 002352   200123 235100                    LDA     I,,AUTO
         2 002353   002355 605000 2                  TPL     s:20101+3
         2 002354   000044 035003                    ADLA    36,DU
         2 002355   200003 474500                    LDP4    @VBLK,,AUTO
         2 002356   003105 060400                    CSL     bolr='003'O
         2 002357   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 002360   400007 000001                    BDSC    7,A,PR4                  by=0,bit=0,n=1

      524    20102    5                           EXIT RSA_CTXT_TFR;

  20102  2 002361   002366 710000 2                  TRA     s:20105

      525    20103    5                           END;
      526    20104    4                       END;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:103  
  20104  2 002362   200123 054100                    AOS     I,,AUTO
         2 002363   200123 235100                    LDA     I,,AUTO
         2 002364   000022 115007                    CMPA    18,DL
         2 002365   002326 604400 2                  TMOZ    s:20097

      527    20105    3                   END;

  20105  2 002366   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002367   000001 735000                    ALS     1
         2 002370   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002371   000007 376007                    ANQ     7,DL
         2 002372   000003 116007                    CMPQ    3,DL
         2 002373   002271 603000 2                  TRC     s:19888

      528    20106    2               DATALVL = 2;

  20106  2 002374   000002 235007                    LDA     2,DL
         2 002375   200121 755100                    STA     DATALVL,,AUTO
         2 002376   003510 710000 2                  TRA     s:22695

      529    20107        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:104  
      530    20108        /*****************************************************************************
      531    20109        *
      532    20110        *       STYDIND --> AC, ACA, or TTD
      533    20111        *
      534    20112        *****************************************************************************/
      535    20113    2           CASE( %XSS_FNC_STYDIND#);  /* should be an AC, ACA, or TTD PPDU */

      536    20114    3               IF ITEMLIST.X.TAG(1) = %TAGC0 THEN DO;

  20114  2 002377   200011 236100                    LDQ     ITEMLIST+2,,AUTO
         2 002400   377000 376007                    ANQ     130560,DL
         2 002401   240000 116007                    CMPQ    81920,DL
         2 002402   002771 601000 2                  TNZ     s:21047

      537    20115    3                   XSP$ALTER_CONTEXT = XSP_ALTER_CONTEXT;

  20115  2 002403   200003 473500                    LDP3    @VBLK,,AUTO
         2 002404   300001 474500                    LDP4    1,,PR3
         2 002405   000100 100400                    MLR     fill='000'O
         2 002406   000000 000030 xsym               ADSC9   XSP_ALTER_CONTEXT        cn=0,n=24
         2 002407   400000 000030                    ADSC9   0,,PR4                   cn=0,n=24

      538    20116    3                   XSP$ALTER_CONTEXT.FNC = %XSP_FNC_PALTIND#;

  20116  2 002410   300001 471500                    LDP1    1,,PR3
         2 002411   022000 236003                    LDQ     9216,DU
         2 002412   100000 552140                    STBQ    0,'40'O,PR1

      539    20117    3                   XSP$ALTER_CONTEXT.CTXT$ = XSP_TMPCTXT$;

  20117  2 002413   300001 471500                    LDP1    1,,PR3
         2 002414   000000 236000 xsym               LDQ     XSP_TMPCTXT$
         2 002415   100005 756100                    STQ     5,,PR1

      540    20118    3                   VBLK.EVENT = %XSP_PEV_AC;

  20118  2 002416   000001 236007                    LDQ     1,DL
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:105  
         2 002417   300006 552104                    STBQ    6,'04'O,PR3

      541    20119                        %SCAN( LVL=1, TAG=C0, IMP=Y, TYP=SEQ);  /* AC */

  20206  2 002420   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002421   000001 735000                    ALS     1
         2 002422   240601 236007                    LDQ     82305,DL
         2 002423   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20213  2 002424   003732 701000 2                  TSX1    SCAN
         2 002425   003731 702000 2                  TSX2    SCANERR

      542    20216                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);
             20216                            /* PresCtxtAddList */

  20303  2 002426   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002427   000001 735000                    ALS     1
         2 002430   640562 236007                    LDQ     -48782,DL
         2 002431   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20310  2 002432   003732 701000 2                  TSX1    SCAN
         2 002433   003731 702000 2                  TSX2    SCANERR

      543    20313    3                   I = 0;

  20313  2 002434   200123 450100                    STZ     I,,AUTO

      544    20314    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  20314  2 002435   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002436   000001 735000                    ALS     1
         2 002437   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002440   000007 376007                    ANQ     7,DL
         2 002441   000003 116007                    CMPQ    3,DL
         2 002442   002703 602000 2                  TNC     s:20925

      545    20315                            %SCAN( LVL=3, TYP=SEQ);
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:106  

  20402  2 002443   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002444   000001 735000                    ALS     1
         2 002445   060203 236007                    LDQ     24707,DL
         2 002446   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20409  2 002447   003732 701000 2                  TSX1    SCAN
         2 002450   003731 702000 2                  TSX2    SCANERR

      546    20412    4                       UTMP = 0;

  20412  2 002451   200136 450100                    STZ     UTMP,,AUTO

      547    20413                            %SCAN( LVL=4, TYP=INTG,
      548    20414                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */

  20467  2 002452   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002453   000001 735000                    ALS     1
         2 002454   200136 630500                    EPPR0   UTMP,,AUTO
         2 002455   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  20501  2 002456   000033 236000 3                  LDQ     27
         2 002457   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20508  2 002460   003732 701000 2                  TSX1    SCAN
         2 002461   003731 702000 2                  TSX2    SCANERR

      549    20511                            %SCAN( LVL=4, TYP=OBJID,
      550    20512                                    LEN=20, VAL=ABS$);  /* AbsSynName */

  20586  2 002462   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002463   000001 735000                    ALS     1
         2 002464   200107 236100                    LDQ     ABS$,,AUTO
         2 002465   400000 036007                    ADLQ    -131072,DL
         2 002466   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  20599  2 002467   200107 470500                    LDP0    ABS$,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:107  
         2 002470   000000 236100                    LDQ     0,,PR0
         2 002471   777777 376003                    ANQ     -1,DU
         2 002472   006064 036007                    ADLQ    3124,DL
         2 002473   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20606  2 002474   003732 701000 2                  TSX1    SCAN
         2 002475   003731 702000 2                  TSX2    SCANERR

      551    20609                            %SCAN( LVL=4, TYP=SEQOF);

  20696  2 002476   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002477   000001 735000                    ALS     1
         2 002500   120164 236007                    LDQ     41076,DL
         2 002501   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20703  2 002502   003732 701000 2                  TSX1    SCAN
         2 002503   003731 702000 2                  TSX2    SCANERR

      552    20706                            /*N* we only support one transfer syntax at a time */
      553    20707                            %SCAN( LVL=5, TYP=OBJID,
      554    20708                                    LEN=20, VAL=TFR$);  /* TfrSynName */

  20782  2 002504   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002505   000001 735000                    ALS     1
         2 002506   200110 236100                    LDQ     TFR$,,AUTO
         2 002507   400000 036007                    ADLQ    -131072,DL
         2 002510   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  20795  2 002511   200110 470500                    LDP0    TFR$,,AUTO
         2 002512   000000 236100                    LDQ     0,,PR0
         2 002513   777777 376003                    ANQ     -1,DU
         2 002514   006065 036007                    ADLQ    3125,DL
         2 002515   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20802  2 002516   003732 701000 2                  TSX1    SCAN
         2 002517   003731 702000 2                  TSX2    SCANERR

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:108  
      555    20805    4                       I = I + 1;

  20805  2 002520   200123 054100                    AOS     I,,AUTO

      556    20806    4                       CLST.COUNT(0) = I;

  20806  2 002521   000000 470400 xsym               LDP0    XSP_TMPCTXT$
         2 002522   200123 235100                    LDA     I,,AUTO
         2 002523   000000 755100                    STA     0,,PR0

      557    20807    4                       CMAP.ABSCTXTID( I) = 0;

  20807  2 002524   000001 735000                    ALS     1
         2 002525   200120 470500                    LDP0    CMAP$,,AUTO
         2 002526   000013 236000 3                  LDQ     11
         2 002527   000001 356105                    ANSQ    1,AL,PR0

      558    20808    4                       CMAP.TFRCTXTID( I) = 0;

  20808  2 002530   200120 470500                    LDP0    CMAP$,,AUTO
         2 002531   000014 236000 3                  LDQ     12
         2 002532   000001 356105                    ANSQ    1,AL,PR0

      559    20809    4   AC_CTXT_ABS:
      560    20810    5                       DO J = 1 TO XSP_ABSLIST.COUNT(0);

  20810  2 002533   000001 235007       AC_CTXT_ABS  LDA     1,DL
         2 002534   200126 755100                    STA     J,,AUTO
         2 002535   002567 710000 2                  TRA     s:20818+1

      561    20811    5                           TMP$ = XSP_ABSLIST.CTXT$( J);

  20811  2 002536   200126 720100                    LXL0    J,,AUTO
         2 002537   000000 236010 xsym               LDQ     XSP_ABSLIST,X0
         2 002540   200135 756100                    STQ     TMP$,,AUTO

      562    20812    5                           IF TMP$ ~= ADDR( NIL) AND
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:109  

  20812  2 002541   000015 116000 3                  CMPQ    13
         2 002542   002566 600000 2                  TZE     s:20818
         2 002543   200107 470500                    LDP0    ABS$,,AUTO
         2 002544   000000 221100                    LDX1    0,,PR0
         2 002545   200135 471500                    LDP1    TMP$,,AUTO
         2 002546   100000 101100                    CMPX1   0,,PR1
         2 002547   002566 601000 2                  TNZ     s:20818
         2 002550   100000 222100                    LDX2    0,,PR1
         2 002551   040140 106540                    CMPC    fill='040'O
         2 002552   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         2 002553   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 002554   002566 601000 2                  TNZ     s:20818

      563    20813    5                                   ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      564    20814    6                                   ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      565    20815    6                               CMAP.ABSCTXTID( I) = J;

  20815  2 002555   200123 235100                    LDA     I,,AUTO
         2 002556   000001 735000                    ALS     1
         2 002557   200120 473500                    LDP3    CMAP$,,AUTO
         2 002560   200126 236100                    LDQ     J,,AUTO
         2 002561   000033 736000                    QLS     27
         2 002562   300001 676105                    ERQ     1,AL,PR3
         2 002563   777000 376003                    ANQ     -512,DU
         2 002564   300001 656105                    ERSQ    1,AL,PR3

      566    20816    6                               EXIT AC_CTXT_ABS;

  20816  2 002565   002572 710000 2                  TRA     AC_CTXT_TFR

      567    20817    6                               END;
      568    20818    5                           END;

  20818  2 002566   200126 054100                    AOS     J,,AUTO
         2 002567   200126 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:110  
         2 002570   000000 116000 xsym               CMPQ    XSP_ABSLIST
         2 002571   002536 604400 2                  TMOZ    s:20811

      569    20819    4   AC_CTXT_TFR:
      570    20820    5                       DO J = 1 TO XSP_TFRLIST.COUNT(0);

  20820  2 002572   000001 235007       AC_CTXT_TFR  LDA     1,DL
         2 002573   200126 755100                    STA     J,,AUTO
         2 002574   002626 710000 2                  TRA     s:20828+1

      571    20821    5                           TMP$ = XSP_TFRLIST.CTXT$( J);

  20821  2 002575   200126 720100                    LXL0    J,,AUTO
         2 002576   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 002577   200135 756100                    STQ     TMP$,,AUTO

      572    20822    5                           IF TMP$ ~= ADDR( NIL) AND

  20822  2 002600   000015 116000 3                  CMPQ    13
         2 002601   002625 600000 2                  TZE     s:20828
         2 002602   200107 470500                    LDP0    ABS$,,AUTO
         2 002603   000000 221100                    LDX1    0,,PR0
         2 002604   200135 471500                    LDP1    TMP$,,AUTO
         2 002605   100000 101100                    CMPX1   0,,PR1
         2 002606   002625 601000 2                  TNZ     s:20828
         2 002607   100000 222100                    LDX2    0,,PR1
         2 002610   040140 106540                    CMPC    fill='040'O
         2 002611   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1
         2 002612   100000 400012                    ADSC9   0,,PR1                   cn=2,n=*X2
         2 002613   002625 601000 2                  TNZ     s:20828

      573    20823    5                                   ABS$->CTXT.LEN = TMP$->CTXT.LEN AND
      574    20824    6                                   ABS$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      575    20825    6                               CMAP.TFRCTXTID( I) = J;

  20825  2 002614   200123 235100                    LDA     I,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:111  
         2 002615   000001 735000                    ALS     1
         2 002616   200120 473500                    LDP3    CMAP$,,AUTO
         2 002617   200126 236100                    LDQ     J,,AUTO
         2 002620   000022 736000                    QLS     18
         2 002621   300001 676105                    ERQ     1,AL,PR3
         2 002622   000777 376003                    ANQ     511,DU
         2 002623   300001 656105                    ERSQ    1,AL,PR3

      576    20826    6                               EXIT AC_CTXT_TFR;

  20826  2 002624   002631 710000 2                  TRA     s:20829

      577    20827    6                               END;
      578    20828    5                           END;

  20828  2 002625   200126 054100                    AOS     J,,AUTO
         2 002626   200126 236100                    LDQ     J,,AUTO
         2 002627   000000 116000 xsym               CMPQ    XSP_TFRLIST
         2 002630   002575 604400 2                  TMOZ    s:20821

      579    20829    4                       IF CMAP.ABSCTXTID( I) = 0 OR CMAP.TFRCTXTID( I) = 0 THEN

  20829  2 002631   200123 235100                    LDA     I,,AUTO
         2 002632   000001 735000                    ALS     1
         2 002633   200120 470500                    LDP0    CMAP$,,AUTO
         2 002634   000001 236105                    LDQ     1,AL,PR0
         2 002635   777000 316003                    CANQ    -512,DU
         2 002636   002641 600000 2                  TZE     s:20830
         2 002637   000777 316003                    CANQ    511,DU
         2 002640   002645 601000 2                  TNZ     s:20832

      580    20830    4                           CMAP.RESULT( I) = %XSP_RSLT_PREJECT;

  20830  2 002641   000016 376000 3                  ANQ     14
         2 002642   002000 276007                    ORQ     1024,DL
         2 002643   000001 756105                    STQ     1,AL,PR0
         2 002644   002647 710000 2                  TRA     s:20833
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:112  

      581    20831    4                       ELSE
      582    20832    4                           CMAP.RESULT( I) = %XSP_RSLT_ACCEPT;

  20832  2 002645   000016 236000 3                  LDQ     14
         2 002646   000001 356105                    ANSQ    1,AL,PR0

      583    20833    4                       CMAP.STATE( I) = %XSP_CMAP_RMTDEF;

  20833  2 002647   200120 470500                    LDP0    CMAP$,,AUTO
         2 002650   000001 236105                    LDQ     1,AL,PR0
         2 002651   000017 376000 3                  ANQ     15
         2 002652   000003 276007                    ORQ     3,DL
         2 002653   000001 756105                    STQ     1,AL,PR0

      584    20834    4                       CMAP.PEERCTXTID( I) = UTMP;

  20834  2 002654   200120 470500                    LDP0    CMAP$,,AUTO
         2 002655   200136 236100                    LDQ     UTMP,,AUTO
         2 002656   000000 756105                    STQ     0,AL,PR0

      585    20835    4                       CLST.RESULT( I) = CMAP.RESULT( I);

  20835  2 002657   200120 470500                    LDP0    CMAP$,,AUTO
         2 002660   000001 236105                    LDQ     1,AL,PR0
         2 002661   000011 772000                    QRL     9
         2 002662   000017 376007                    ANQ     15,DL
         2 002663   000000 471400 xsym               LDP1    XSP_TMPCTXT$
         2 002664   200123 720100                    LXL0    I,,AUTO
         2 002665   100000 756110                    STQ     0,X0,PR1

      586    20836    4                       VBLK.DEFBITS( I) = %TRUE;

  20836  2 002666   200123 236100                    LDQ     I,,AUTO
         2 002667   002671 605000 2                  TPL     s:20836+3
         2 002670   000044 036003                    ADLQ    36,DU
         2 002671   200003 470500                    LDP0    @VBLK,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:113  
         2 002672   003106 060400                    CSL     bolr='003'O
         2 002673   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 002674   000007 000001                    BDSC    7,Q,PR0                  by=0,bit=0,n=1

      587    20837    4                       END;

  20837  2 002675   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 002676   000001 736000                    QLS     1
         2 002677   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 002700   000007 376007                    ANQ     7,DL
         2 002701   000003 116007                    CMPQ    3,DL
         2 002702   002443 603000 2                  TRC     s:20402

      588    20838                        %SCAN( LVL=2, TAG=C1, IMP=Y, TYP=SEQOF, OPT=Y);
             20838                            /* PresCtxtDelList */

  20925  2 002703   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002704   000001 735000                    ALS     1
         2 002705   641562 236007                    LDQ     -48270,DL
         2 002706   200007 756105                    STQ     ITEMLIST,AL,AUTO

  20932  2 002707   003732 701000 2                  TSX1    SCAN
         2 002710   003731 702000 2                  TSX2    SCANERR

      589    20935    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  20935  2 002711   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002712   000001 735000                    ALS     1
         2 002713   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002714   000007 376007                    ANQ     7,DL
         2 002715   000003 116007                    CMPQ    3,DL
         2 002716   002766 602000 2                  TNC     s:21044

      590    20936    4                       UTMP = 0;

  20936  2 002717   200136 450100                    STZ     UTMP,,AUTO

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:114  
      591    20937                            %SCAN( LVL=3, TYP=INTG,
      592    20938                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */

  20991  2 002720   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 002721   000001 735000                    ALS     1
         2 002722   200136 630500                    EPPR0   UTMP,,AUTO
         2 002723   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  21025  2 002724   000034 236000 3                  LDQ     28
         2 002725   200007 756105                    STQ     ITEMLIST,AL,AUTO

  21032  2 002726   003732 701000 2                  TSX1    SCAN
         2 002727   003731 702000 2                  TSX2    SCANERR

      593    21035    4   AC_CTXT_DEL:
      594    21036    5                       DO I = 1 TO %XSP_MAX_CTXTID;

  21036  2 002730   000001 235007       AC_CTXT_DEL  LDA     1,DL
         2 002731   200123 755100                    STA     I,,AUTO

      595    21037    6                           IF CMAP.PEERCTXTID( I) = UTMP THEN DO;

  21037  2 002732   200123 235100                    LDA     I,,AUTO
         2 002733   000001 735000                    ALS     1
         2 002734   200120 470500                    LDP0    CMAP$,,AUTO
         2 002735   000000 236105                    LDQ     0,AL,PR0
         2 002736   200136 116100                    CMPQ    UTMP,,AUTO
         2 002737   002754 601000 2                  TNZ     s:21042

      596    21038    6                               CMAP.STATE( I) = %XSP_CMAP_RMTDEL;

  21038  2 002740   000001 236105                    LDQ     1,AL,PR0
         2 002741   000017 376000 3                  ANQ     15
         2 002742   000004 276007                    ORQ     4,DL
         2 002743   000001 756105                    STQ     1,AL,PR0

      597    21039    6                               VBLK.DELBITS( I) = %TRUE;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:115  

  21039  2 002744   200123 236100                    LDQ     I,,AUTO
         2 002745   002747 605000 2                  TPL     s:21039+3
         2 002746   000044 036003                    ADLQ    36,DU
         2 002747   200003 470500                    LDP0    @VBLK,,AUTO
         2 002750   003106 060400                    CSL     bolr='003'O
         2 002751   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 002752   000010 000001                    BDSC    8,Q,PR0                  by=0,bit=0,n=1

      598    21040    6                               EXIT AC_CTXT_DEL;

  21040  2 002753   002760 710000 2                  TRA     s:21043

      599    21041    6                               END;
      600    21042    5                           END;

  21042  2 002754   200123 054100                    AOS     I,,AUTO
         2 002755   200123 235100                    LDA     I,,AUTO
         2 002756   000022 115007                    CMPA    18,DL
         2 002757   002732 604400 2                  TMOZ    s:21037

      601    21043    4                       END;

  21043  2 002760   200124 235100                    LDA     ITEMCUR,,AUTO
         2 002761   000001 735000                    ALS     1
         2 002762   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002763   000007 376007                    ANQ     7,DL
         2 002764   000003 116007                    CMPQ    3,DL
         2 002765   002717 603000 2                  TRC     s:20936

      602    21044    3                   DATALVL = 2;

  21044  2 002766   000002 235007                    LDA     2,DL
         2 002767   200121 755100                    STA     DATALVL,,AUTO

      603    21045    3                   EXIT SFNCCASE;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:116  
  21045  2 002770   003510 710000 2                  TRA     s:22695

      604    21046    3                   END;
      605    21047    3               IF ITEMLIST.X.TAG(1) = %TAGC1 THEN DO;

  21047  2 002771   241000 116007                    CMPQ    82432,DL
         2 002772   003251 601000 2                  TNZ     s:21865

      606    21048    3                   XSP$ALTER_CONTEXT = XSP_ALTER_CONTEXT;

  21048  2 002773   200003 473500                    LDP3    @VBLK,,AUTO
         2 002774   300001 474500                    LDP4    1,,PR3
         2 002775   000100 100400                    MLR     fill='000'O
         2 002776   000000 000030 xsym               ADSC9   XSP_ALTER_CONTEXT        cn=0,n=24
         2 002777   400000 000030                    ADSC9   0,,PR4                   cn=0,n=24

      607    21049    3                   XSP$ALTER_CONTEXT.FNC = %XSP_FNC_PALTCNF#;

  21049  2 003000   300001 471500                    LDP1    1,,PR3
         2 003001   024000 236003                    LDQ     10240,DU
         2 003002   100000 552140                    STBQ    0,'40'O,PR1

      608    21050    3                   XSP$ALTER_CONTEXT.CTXT$ = XSP_TMPCTXT$;

  21050  2 003003   300001 471500                    LDP1    1,,PR3
         2 003004   000000 236000 xsym               LDQ     XSP_TMPCTXT$
         2 003005   100005 756100                    STQ     5,,PR1

      609    21051    3                   VBLK.EVENT = %XSP_PEV_ACA;

  21051  2 003006   000002 236007                    LDQ     2,DL
         2 003007   300006 552104                    STBQ    6,'04'O,PR3

      610    21052                        %SCAN( LVL=1, TAG=C1, IMP=Y, TYP=SEQ);  /* ACA */

  21139  2 003010   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003011   000001 735000                    ALS     1
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:117  
         2 003012   241601 236007                    LDQ     82817,DL
         2 003013   200007 756105                    STQ     ITEMLIST,AL,AUTO

  21146  2 003014   003732 701000 2                  TSX1    SCAN
         2 003015   003731 702000 2                  TSX2    SCANERR

      611    21149                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);
             21149                            /* PresCtxtAddResultList */

  21236  2 003016   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003017   000001 735000                    ALS     1
         2 003020   640562 236007                    LDQ     -48782,DL
         2 003021   200007 756105                    STQ     ITEMLIST,AL,AUTO

  21243  2 003022   003732 701000 2                  TSX1    SCAN
         2 003023   003731 702000 2                  TSX2    SCANERR

      612    21246    3                   I = 1;

  21246  2 003024   000001 235007                    LDA     1,DL
         2 003025   200123 755100                    STA     I,,AUTO

      613    21247    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  21247  2 003026   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 003027   000001 736000                    QLS     1
         2 003030   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 003031   000007 376007                    ANQ     7,DL
         2 003032   000003 116007                    CMPQ    3,DL
         2 003033   003163 602000 2                  TNC     s:21743

      614    21248                            %SCAN( LVL=3, TYP=SEQ);

  21335  2 003034   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003035   000001 735000                    ALS     1
         2 003036   060203 236007                    LDQ     24707,DL
         2 003037   200007 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:118  

  21342  2 003040   003732 701000 2                  TSX1    SCAN
         2 003041   003731 702000 2                  TSX2    SCANERR

      615    21345    4                       TEMP = 0;

  21345  2 003042   200134 450100                    STZ     TEMP,,AUTO

      616    21346                            %SCAN( LVL=4, TAG=C0, IMP=Y, TYP=INTG,
      617    21347                                    LEN=4, VAL=TEMP);  /* Result */

  21400  2 003043   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003044   000001 735000                    ALS     1
         2 003045   200134 630500                    EPPR0   TEMP,,AUTO
         2 003046   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  21434  2 003047   000030 236000 3                  LDQ     24
         2 003050   200007 756105                    STQ     ITEMLIST,AL,AUTO

  21441  2 003051   003732 701000 2                  TSX1    SCAN
         2 003052   003731 702000 2                  TSX2    SCANERR

      618    21444                            %SCAN( LVL=4, TAG=C1, IMP=Y, TYP=OBJID,
      619    21445                                    LEN=20, VAL=TFR$);  /* TfrSynName */

  21519  2 003053   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003054   000001 735000                    ALS     1
         2 003055   200110 236100                    LDQ     TFR$,,AUTO
         2 003056   400000 036007                    ADLQ    -131072,DL
         2 003057   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  21532  2 003060   200110 470500                    LDP0    TFR$,,AUTO
         2 003061   000000 236100                    LDQ     0,,PR0
         2 003062   777777 376003                    ANQ     -1,DU
         2 003063   201464 036007                    ADLQ    66356,DL
         2 003064   200007 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:119  
  21539  2 003065   003732 701000 2                  TSX1    SCAN
         2 003066   003731 702000 2                  TSX2    SCANERR

      620    21542    4                       UTMP = 0;

  21542  2 003067   200136 450100                    STZ     UTMP,,AUTO

      621    21543                            %SCAN( LVL=4, TAG=C2, IMP=Y, TYP=INTG,
      622    21544                                    LEN=4, VAL=UTMP);  /* ProviderReason */

  21597  2 003070   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003071   000001 735000                    ALS     1
         2 003072   200136 630500                    EPPR0   UTMP,,AUTO
         2 003073   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  21631  2 003074   000031 236000 3                  LDQ     25
         2 003075   200007 756105                    STQ     ITEMLIST,AL,AUTO

  21638  2 003076   003732 701000 2                  TSX1    SCAN
         2 003077   003731 702000 2                  TSX2    SCANERR

      623    21641    5                       DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEF);

  21641  2 003100   200123 235100                    LDA     I,,AUTO
         2 003101   000001 735000                    ALS     1
         2 003102   200120 470500                    LDP0    CMAP$,,AUTO
         2 003103   000001 236105                    LDQ     1,AL,PR0
         2 003104   000777 376007                    ANQ     511,DL
         2 003105   000001 116007                    CMPQ    1,DL
         2 003106   003121 600000 2                  TZE     s:21646

      624    21642    5                           I = I + 1;

  21642  2 003107   200123 054100                    AOS     I,,AUTO

      625    21643    5                           IF I > %XSP_MAX_CTXTID THEN

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:120  
  21643  2 003110   200123 235100                    LDA     I,,AUTO
         2 003111   000022 115007                    CMPA    18,DL
         2 003112   003731 605400 2                  TPNZ    SCANERR

      626    21644    5                               GOTO SCANERR;
      627    21645    5                           END;

  21645  2 003113   000001 735000                    ALS     1
         2 003114   200120 470500                    LDP0    CMAP$,,AUTO
         2 003115   000001 236105                    LDQ     1,AL,PR0
         2 003116   000777 376007                    ANQ     511,DL
         2 003117   000001 116007                    CMPQ    1,DL
         2 003120   003107 601000 2                  TNZ     s:21642

      628    21646    4                       TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));

  21646  2 003121   000001 220105                    LDX0    1,AL,PR0
         2 003122   000777 360003                    ANX0    511,DU
         2 003123   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 003124   200135 756100                    STQ     TMP$,,AUTO

      629    21647    4                       IF TMP$ ~= ADDR( NIL) AND

  21647  2 003125   000015 116000 3                  CMPQ    13
         2 003126   003731 600000 2                  TZE     SCANERR
         2 003127   200110 471500                    LDP1    TFR$,,AUTO
         2 003130   100000 221100                    LDX1    0,,PR1
         2 003131   200135 473500                    LDP3    TMP$,,AUTO
         2 003132   300000 101100                    CMPX1   0,,PR3
         2 003133   003731 601000 2                  TNZ     SCANERR
         2 003134   300000 222100                    LDX2    0,,PR3
         2 003135   040140 106540                    CMPC    fill='040'O
         2 003136   100000 400011                    ADSC9   0,,PR1                   cn=2,n=*X1
         2 003137   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         2 003140   003731 601000 2                  TNZ     SCANERR

      630    21648    4                               TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:121  
      631    21649    5                               TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

      632    21650    5                           CMAP.RESULT( I) = TEMP;

  21650  2 003141   200134 236100                    LDQ     TEMP,,AUTO
         2 003142   000011 736000                    QLS     9
         2 003143   000001 676105                    ERQ     1,AL,PR0
         2 003144   017000 376007                    ANQ     7680,DL
         2 003145   000001 656105                    ERSQ    1,AL,PR0

      633    21651    5                           CMAP.REASON( I) = UTMP;

  21651  2 003146   200120 470500                    LDP0    CMAP$,,AUTO
         2 003147   200136 236100                    LDQ     UTMP,,AUTO
         2 003150   000015 736000                    QLS     13
         2 003151   000001 676105                    ERQ     1,AL,PR0
         2 003152   360000 376007                    ANQ     122880,DL
         2 003153   000001 656105                    ERSQ    1,AL,PR0

      634    21652    5                           END;

  21652  2 003154   003155 710000 2                  TRA     s:21655

      635    21653    4                       ELSE
      636    21654    4                           GOTO SCANERR;
      637    21655    4                       END;

  21655  2 003155   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 003156   000001 736000                    QLS     1
         2 003157   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 003160   000007 376007                    ANQ     7,DL
         2 003161   000003 116007                    CMPQ    3,DL
         2 003162   003034 603000 2                  TRC     s:21335

      638    21656                        %SCAN( LVL=2, TAG=C1, IMP=Y, TYP=SEQOF, OPT=Y);
             21656                            /* PresCtxtDelResultList */

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:122  
  21743  2 003163   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003164   000001 735000                    ALS     1
         2 003165   641562 236007                    LDQ     -48270,DL
         2 003166   200007 756105                    STQ     ITEMLIST,AL,AUTO

  21750  2 003167   003732 701000 2                  TSX1    SCAN
         2 003170   003731 702000 2                  TSX2    SCANERR

      639    21753    3                   I = 1;

  21753  2 003171   000001 235007                    LDA     1,DL
         2 003172   200123 755100                    STA     I,,AUTO

      640    21754    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  21754  2 003173   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 003174   000001 736000                    QLS     1
         2 003175   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 003176   000007 376007                    ANQ     7,DL
         2 003177   000003 116007                    CMPQ    3,DL
         2 003200   003246 602000 2                  TNC     s:21861

      641    21755    4                       UTMP = 0;

  21755  2 003201   200136 450100                    STZ     UTMP,,AUTO

      642    21756                            %SCAN( LVL=3, TYP=INTG,
      643    21757                                    LEN=4, VAL=UTMP);  /* Result */

  21810  2 003202   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003203   000001 735000                    ALS     1
         2 003204   200136 630500                    EPPR0   UTMP,,AUTO
         2 003205   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  21844  2 003206   000034 236000 3                  LDQ     28
         2 003207   200007 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:123  
  21851  2 003210   003732 701000 2                  TSX1    SCAN
         2 003211   003731 702000 2                  TSX2    SCANERR

      644    21854    5                       DO WHILE( CMAP.STATE( I) ~= %XSP_CMAP_LCLDEL);

  21854  2 003212   200123 235100                    LDA     I,,AUTO
         2 003213   000001 735000                    ALS     1
         2 003214   200120 470500                    LDP0    CMAP$,,AUTO
         2 003215   000001 236105                    LDQ     1,AL,PR0
         2 003216   000777 376007                    ANQ     511,DL
         2 003217   000002 116007                    CMPQ    2,DL
         2 003220   003233 600000 2                  TZE     s:21859

      645    21855    5                           I = I + 1;

  21855  2 003221   200123 054100                    AOS     I,,AUTO

      646    21856    5                           IF I > %XSP_MAX_CTXTID THEN

  21856  2 003222   200123 235100                    LDA     I,,AUTO
         2 003223   000022 115007                    CMPA    18,DL
         2 003224   003731 605400 2                  TPNZ    SCANERR

      647    21857    5                               GOTO SCANERR;
      648    21858    5                           END;

  21858  2 003225   000001 735000                    ALS     1
         2 003226   200120 470500                    LDP0    CMAP$,,AUTO
         2 003227   000001 236105                    LDQ     1,AL,PR0
         2 003230   000777 376007                    ANQ     511,DL
         2 003231   000002 116007                    CMPQ    2,DL
         2 003232   003221 601000 2                  TNZ     s:21855

      649    21859    4                       CMAP.RESULT( I) = UTMP;

  21859  2 003233   200136 236100                    LDQ     UTMP,,AUTO
         2 003234   000011 736000                    QLS     9
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:124  
         2 003235   000001 676105                    ERQ     1,AL,PR0
         2 003236   017000 376007                    ANQ     7680,DL
         2 003237   000001 656105                    ERSQ    1,AL,PR0

      650    21860    4                       END;

  21860  2 003240   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 003241   000001 736000                    QLS     1
         2 003242   200007 236106                    LDQ     ITEMLIST,QL,AUTO
         2 003243   000007 376007                    ANQ     7,DL
         2 003244   000003 116007                    CMPQ    3,DL
         2 003245   003201 603000 2                  TRC     s:21755

      651    21861    3                   DATALVL = 2;

  21861  2 003246   000002 235007                    LDA     2,DL
         2 003247   200121 755100                    STA     DATALVL,,AUTO

      652    21862    3                   EXIT SFNCCASE;

  21862  2 003250   003510 710000 2                  TRA     s:22695

      653    21863    3                   END;
      654    21864                    /* otherwise, this should be a TTD PPDU */
      655    21865    2               XSP$TYPED_DATA = XSS$TYPED_DATA;

  21865  2 003251   200003 473500                    LDP3    @VBLK,,AUTO
         2 003252   300001 474500                    LDP4    1,,PR3
         2 003253   000100 100500                    MLR     fill='000'O
         2 003254   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
         2 003255   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      656    21866    2               XSP$TYPED_DATA.FNC = %XSP_FNC_PTYDIND#;

  21866  2 003256   300001 471500                    LDP1    1,,PR3
         2 003257   070000 236003                    LDQ     28672,DU
         2 003260   100000 552140                    STBQ    0,'40'O,PR1
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:125  

      657    21867    2               VBLK.EVENT = %XSP_PEV_TTD;

  21867  2 003261   000016 236007                    LDQ     14,DL
         2 003262   300006 552104                    STBQ    6,'04'O,PR3

      658    21868    2               DATALVL = 1;

  21868  2 003263   000001 235007                    LDA     1,DL
         2 003264   200121 755100                    STA     DATALVL,,AUTO
         2 003265   003510 710000 2                  TRA     s:22695

      659    21869        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:126  
      660    21870        /*****************************************************************************
      661    21871        *
      662    21872        *       SUABIND --> ARP or ARU
      663    21873        *
      664    21874        *****************************************************************************/
      665    21875    2           CASE( %XSS_FNC_SUABIND#);  /* should be an ARP or ARU PPDU */

      666    21876    3               IF ITEMLIST.X.TAG(1) = %TAGC0 THEN DO;

  21876  2 003266   200011 236100                    LDQ     ITEMLIST+2,,AUTO
         2 003267   377000 376007                    ANQ     130560,DL
         2 003270   240000 116007                    CMPQ    81920,DL
         2 003271   003437 601000 2                  TNZ     s:22385

      667    21877    3                   XSP$U_ABORT = XSS$U_ABORT;

  21877  2 003272   200003 473500                    LDP3    @VBLK,,AUTO
         2 003273   300001 474500                    LDP4    1,,PR3
         2 003274   000100 100500                    MLR     fill='000'O
         2 003275   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
         2 003276   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      668    21878    3                   XSP$U_ABORT.FNC = %XSP_FNC_PUABIND#;

  21878  2 003277   300001 471500                    LDP1    1,,PR3
         2 003300   072000 236003                    LDQ     29696,DU
         2 003301   100000 552140                    STBQ    0,'40'O,PR1

      669    21879    3                   VBLK.EVENT = %XSP_PEV_ARU;

  21879  2 003302   000004 236007                    LDQ     4,DL
         2 003303   300006 552104                    STBQ    6,'04'O,PR3

      670    21880                        %SCAN( LVL=1, TAG=C0, IMP=Y, TYP=SEQ);  /* ARU */

  21967  2 003304   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003305   000001 735000                    ALS     1
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:127  
         2 003306   240601 236007                    LDQ     82305,DL
         2 003307   200007 756105                    STQ     ITEMLIST,AL,AUTO

  21974  2 003310   003732 701000 2                  TSX1    SCAN
         2 003311   003731 702000 2                  TSX2    SCANERR

      671    21977                        %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=SEQOF, OPT=Y);
             21977                            /* PresCtxtIdentList */

  22064  2 003312   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003313   000001 735000                    ALS     1
         2 003314   640562 236007                    LDQ     -48782,DL
         2 003315   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22071  2 003316   003732 701000 2                  TSX1    SCAN
         2 003317   003731 702000 2                  TSX2    SCANERR

      672    22074    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > 2);

  22074  2 003320   200124 235100                    LDA     ITEMCUR,,AUTO
         2 003321   000001 735000                    ALS     1
         2 003322   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003323   000007 376007                    ANQ     7,DL
         2 003324   000003 116007                    CMPQ    3,DL
         2 003325   003434 602000 2                  TNC     s:22381

      673    22075                            %SCAN( LVL=3, TYP=SEQ);

  22162  2 003326   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003327   000001 735000                    ALS     1
         2 003330   060203 236007                    LDQ     24707,DL
         2 003331   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22169  2 003332   003732 701000 2                  TSX1    SCAN
         2 003333   003731 702000 2                  TSX2    SCANERR

      674    22172    4                       UTMP = 0;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:128  

  22172  2 003334   200136 450100                    STZ     UTMP,,AUTO

      675    22173                            %SCAN( LVL=4, TYP=INTG,
      676    22174                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */

  22227  2 003335   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003336   000001 735000                    ALS     1
         2 003337   200136 630500                    EPPR0   UTMP,,AUTO
         2 003340   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  22261  2 003341   000033 236000 3                  LDQ     27
         2 003342   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22268  2 003343   003732 701000 2                  TSX1    SCAN
         2 003344   003731 702000 2                  TSX2    SCANERR

      677    22271                            %SCAN( LVL=4, TYP=OBJID,
      678    22272                                    LEN=20, VAL=TFR$);  /* TfrSynName */

  22346  2 003345   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003346   000001 735000                    ALS     1
         2 003347   200110 236100                    LDQ     TFR$,,AUTO
         2 003350   400000 036007                    ADLQ    -131072,DL
         2 003351   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  22359  2 003352   200110 470500                    LDP0    TFR$,,AUTO
         2 003353   000000 236100                    LDQ     0,,PR0
         2 003354   777777 376003                    ANQ     -1,DU
         2 003355   006064 036007                    ADLQ    3124,DL
         2 003356   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22366  2 003357   003732 701000 2                  TSX1    SCAN
         2 003360   003731 702000 2                  TSX2    SCANERR

      679    22369    4   ARU_CTXT_TFR:
      680    22370    5                       DO I = 1 TO %XSP_MAX_CTXTID;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:129  

  22370  2 003361   000001 235007       ARU_CTXT_TFR LDA     1,DL
         2 003362   200123 755100                    STA     I,,AUTO

      681    22371    5                           TMP$ = XSP_TFRLIST.CTXT$( CMAP.TFRCTXTID( I));

  22371  2 003363   200123 235100                    LDA     I,,AUTO
         2 003364   000001 735000                    ALS     1
         2 003365   200120 470500                    LDP0    CMAP$,,AUTO
         2 003366   000001 220105                    LDX0    1,AL,PR0
         2 003367   000777 360003                    ANX0    511,DU
         2 003370   000000 236010 xsym               LDQ     XSP_TFRLIST,X0
         2 003371   200135 756100                    STQ     TMP$,,AUTO

      682    22372    5                           IF CMAP.PEERCTXTID( I) = UTMP AND

  22372  2 003372   000000 236105                    LDQ     0,AL,PR0
         2 003373   200136 116100                    CMPQ    UTMP,,AUTO
         2 003374   003422 601000 2                  TNZ     s:22379
         2 003375   200135 236100                    LDQ     TMP$,,AUTO
         2 003376   000015 116000 3                  CMPQ    13
         2 003377   003422 600000 2                  TZE     s:22379
         2 003400   200110 471500                    LDP1    TFR$,,AUTO
         2 003401   100000 221100                    LDX1    0,,PR1
         2 003402   200135 473500                    LDP3    TMP$,,AUTO
         2 003403   300000 101100                    CMPX1   0,,PR3
         2 003404   003422 601000 2                  TNZ     s:22379
         2 003405   300000 222100                    LDX2    0,,PR3
         2 003406   040140 106540                    CMPC    fill='040'O
         2 003407   100000 400011                    ADSC9   0,,PR1                   cn=2,n=*X1
         2 003410   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         2 003411   003422 601000 2                  TNZ     s:22379

      683    22373    5                                   TMP$ ~= ADDR( NIL) AND
      684    22374    5                                   TFR$->CTXT.LEN = TMP$->CTXT.LEN AND
      685    22375    6                                   TFR$->CTXT.TXT = TMP$->CTXT.TXT THEN DO;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:130  
      686    22376    6                               VBLK.DEFBITS( I) = %TRUE;

  22376  2 003412   200123 235100                    LDA     I,,AUTO
         2 003413   003415 605000 2                  TPL     s:22376+3
         2 003414   000044 035003                    ADLA    36,DU
         2 003415   200003 474500                    LDP4    @VBLK,,AUTO
         2 003416   003105 060400                    CSL     bolr='003'O
         2 003417   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 003420   400007 000001                    BDSC    7,A,PR4                  by=0,bit=0,n=1

      687    22377    6                               EXIT ARU_CTXT_TFR;

  22377  2 003421   003426 710000 2                  TRA     s:22380

      688    22378    6                               END;
      689    22379    5                           END;

  22379  2 003422   200123 054100                    AOS     I,,AUTO
         2 003423   200123 235100                    LDA     I,,AUTO
         2 003424   000022 115007                    CMPA    18,DL
         2 003425   003363 604400 2                  TMOZ    s:22371

      690    22380    4                       END;

  22380  2 003426   200124 235100                    LDA     ITEMCUR,,AUTO
         2 003427   000001 735000                    ALS     1
         2 003430   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003431   000007 376007                    ANQ     7,DL
         2 003432   000003 116007                    CMPQ    3,DL
         2 003433   003326 603000 2                  TRC     s:22162

      691    22381    3                   DATALVL = 2;

  22381  2 003434   000002 235007                    LDA     2,DL
         2 003435   200121 755100                    STA     DATALVL,,AUTO

      692    22382    3                   EXIT SFNCCASE;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:131  

  22382  2 003436   003510 710000 2                  TRA     s:22695

      693    22383    3                   END;
      694    22384                    /* otherwise, this should be an ARP PPDU */
      695    22385    2               XSP$P_ABORT = XSS$P_ABORT;

  22385  2 003437   200003 473500                    LDP3    @VBLK,,AUTO
         2 003440   300001 474500                    LDP4    1,,PR3
         2 003441   000100 100500                    MLR     fill='000'O
         2 003442   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         2 003443   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8

      696    22386    2               XSP$P_ABORT.FNC = %XSP_FNC_PPABIND#;

  22386  2 003444   300001 471500                    LDP1    1,,PR3
         2 003445   075000 236003                    LDQ     31232,DU
         2 003446   100000 552140                    STBQ    0,'40'O,PR1

      697    22387    2               VBLK.EVENT = %XSP_PEV_ARP;

  22387  2 003447   000003 236007                    LDQ     3,DL
         2 003450   300006 552104                    STBQ    6,'04'O,PR3

      698    22388                    %SCAN( LVL=1, TYP=SEQ);  /* ARP */

  22475  2 003451   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003452   000001 735000                    ALS     1
         2 003453   060201 236007                    LDQ     24705,DL
         2 003454   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22482  2 003455   003732 701000 2                  TSX1    SCAN
         2 003456   003731 702000 2                  TSX2    SCANERR

      699    22485    2               UTMP = 0;

  22485  2 003457   200136 450100                    STZ     UTMP,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:132  

      700    22486                    %SCAN( LVL=2, TAG=C0, IMP=Y, TYP=INTG, OPT=Y,
      701    22487                            LEN=4, VAL=UTMP);  /* AbortReason */

  22540  2 003460   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003461   000001 735000                    ALS     1
         2 003462   200136 630500                    EPPR0   UTMP,,AUTO
         2 003463   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  22574  2 003464   000035 236000 3                  LDQ     29
         2 003465   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22581  2 003466   003732 701000 2                  TSX1    SCAN
         2 003467   003731 702000 2                  TSX2    SCANERR

      702    22584    2               XSP$P_ABORT.REASON = UTMP;

  22584  2 003470   200003 470500                    LDP0    @VBLK,,AUTO
         2 003471   000001 471500                    LDP1    1,,PR0
         2 003472   200136 236100                    LDQ     UTMP,,AUTO
         2 003473   000011 736000                    QLS     9
         2 003474   100000 552110                    STBQ    0,'10'O,PR1

      703    22585    2               UTMP = 0;

  22585  2 003475   200136 450100                    STZ     UTMP,,AUTO

      704    22586                    %SCAN( LVL=2, TAG=C1, IMP=Y, TYP=INTG, OPT=Y,
      705    22587                            LEN=4, VAL=UTMP);  /* EventIdent */

  22640  2 003476   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003477   000001 735000                    ALS     1
         2 003500   200136 631500                    EPPR1   UTMP,,AUTO
         2 003501   200010 451505                    STP1    ITEMLIST+1,AL,AUTO

  22674  2 003502   000036 236000 3                  LDQ     30
         2 003503   200007 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:133  

  22681  2 003504   003732 701000 2                  TSX1    SCAN
         2 003505   003731 702000 2                  TSX2    SCANERR

  22681  2 003506   003510 710000 2                  TRA     s:22695

      706    22684    2               ;  /*N* what to do with EventIdent ? */
      707    22685        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:134  
      708    22686        /*****************************************************************************
      709    22687        *
      710    22688        *       Illegal Session function --> error
      711    22689        *
      712    22690        *****************************************************************************/
      713    22691    2           CASE( ELSE);

      714    22692                    /* this Session function doesn't have a PPDU for UserData */
      715    22693    2               GOTO SCANERR;

  22693  2 003507   003731 710000 2                  TRA     SCANERR

      716    22694    2           END;

      717    22695    2       IF DATALVL > 0 AND ITEMCUR < ITEMNUM THEN DO;

  22695  2 003510   200121 235100                    LDA     DATALVL,,AUTO
         2 003511   003730 604400 2                  TMOZ    s:23217
         2 003512   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 003513   200125 116100                    CMPQ    ITEMNUM,,AUTO
         2 003514   003730 605000 2                  TPL     s:23217

      718    22696    2           XSP_DATANUM = 0;

  22696  2 003515   000000 450000 xsym               STZ     XSP_DATANUM

      719    22697    3           IF ITEMLIST.X.TAG( ITEMCUR) = %TAGA0 THEN DO;

  22697  2 003516   200124 235100                    LDA     ITEMCUR,,AUTO
         2 003517   000001 735000                    ALS     1
         2 003520   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003521   377000 376007                    ANQ     130560,DL
         2 003522   100000 116007                    CMPQ    32768,DL
         2 003523   003565 601000 2                  TNZ     s:22803

      720    22698                    %SCAN( LVL=DATALVL, TAG=A0, IMP=Y, TYP=OCTETSTR, OPT=Y,
      721    22699                            LEN=262143, VAL=NIL);  /*N* SimplyEncodedData */
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:135  

  22783  2 003524   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003525   000001 735000                    ALS     1
         2 003526   000015 236000 3                  LDQ     13
         2 003527   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  22786  2 003530   777777 236007                    LDQ     -1,DL
         2 003531   000000 620005                    EAX0    0,AL
         2 003532   000001 402003                    MPY     1,DU
         2 003533   200121 036100                    ADLQ    DATALVL,,AUTO
         2 003534   500440 036007                    ADLQ    -98016,DL
         2 003535   200007 756110                    STQ     ITEMLIST,X0,AUTO

  22793  2 003536   003732 701000 2                  TSX1    SCAN
         2 003537   003731 702000 2                  TSX2    SCANERR

      722    22796    3               XSP_DATABUF$( XSP_DATANUM) = SCANITEM.P;

  22796  2 003540   200006 236100                    LDQ     SCANITEM+1,,AUTO
         2 003541   000000 720000 xsym               LXL0    XSP_DATANUM
         2 003542   000000 756010 xsym               STQ     XSP_DATABUF$,X0

      723    22797    3               XSP_DATASIZE( XSP_DATANUM) = SCANITEM.X.LEN;

  22797  2 003543   200005 235100                    LDA     SCANITEM,,AUTO
         2 003544   000022 771000                    ARL     18
         2 003545   000000 755010 xsym               STA     XSP_DATASIZE,X0

      724    22798    3               XSP_DATACTXT( XSP_DATANUM) = PCTX.DFLCTXTID;

  22798  2 003546   200003 470500                    LDP0    @VBLK,,AUTO
         2 003547   000000 471500                    LDP1    0,,PR0
         2 003550   000000 235000 xsym               LDA     XSP_DATANUM
         2 003551   000005 100500                    MLR     fill='000'O
         2 003552   100001 400001                    ADSC9   1,,PR1                   cn=2,n=1
         2 003553   000000 000001 xsym               ADSC9   XSP_DATACTXT,A           cn=0,n=1

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:136  
      725    22799    3               VBLK.DATBITS( PCTX.DFLCTXTID) = %TRUE;

  22799  2 003554   000000 471500                    LDP1    0,,PR0
         2 003555   100001 236100                    LDQ     1,,PR1
         2 003556   000011 772000                    QRL     9
         2 003557   000777 376007                    ANQ     511,DL
         2 003560   003106 060400                    CSL     bolr='003'O
         2 003561   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 003562   000011 000001                    BDSC    9,Q,PR0                  by=0,bit=0,n=1

      726    22800    3               XSP_DATANUM = XSP_DATANUM + 1;

  22800  2 003563   000000 054000 xsym               AOS     XSP_DATANUM

      727    22801    3               END;

  22801  2 003564   003730 710000 2                  TRA     s:23217

      728    22802    2           ELSE
      729    22803    3               IF ITEMLIST.X.TAG( ITEMCUR) = %TAGA1 THEN DO;

  22803  2 003565   141000 116007                    CMPQ    49664,DL
         2 003566   003731 601000 2                  TNZ     SCANERR

      730    22804                        %SCAN( LVL=DATALVL, TAG=A1, IMP=Y, TYP=SEQOF, OPT=Y);
             22804                            /* FullyEncodedData */

  22891  2 003567   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003570   000001 735000                    ALS     1
         2 003571   200121 236100                    LDQ     DATALVL,,AUTO
         2 003572   541560 036007                    ADLQ    -81040,DL
         2 003573   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22898  2 003574   003732 701000 2                  TSX1    SCAN
         2 003575   003731 702000 2                  TSX2    SCANERR

      731    22901    4                   DO WHILE( ITEMLIST.X.LVL( ITEMCUR) > DATALVL);
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:137  

  22901  2 003576   200124 235100                    LDA     ITEMCUR,,AUTO
         2 003577   000001 735000                    ALS     1
         2 003600   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003601   000007 376007                    ANQ     7,DL
         2 003602   200121 116100                    CMPQ    DATALVL,,AUTO
         2 003603   003730 604400 2                  TMOZ    s:23217

      732    22902    4                       DATALVL = DATALVL + 1;

  22902  2 003604   200121 054100                    AOS     DATALVL,,AUTO

      733    22903                            %SCAN( LVL=DATALVL, TYP=OBJID, OPT=Y,
      734    22904                                    LEN=20, VAL=TFR$);  /* TfrSynName */

  22978  2 003605   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003606   000001 735000                    ALS     1
         2 003607   200110 236100                    LDQ     TFR$,,AUTO
         2 003610   400000 036007                    ADLQ    -131072,DL
         2 003611   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  22991  2 003612   200110 470500                    LDP0    TFR$,,AUTO
         2 003613   000000 236100                    LDQ     0,,PR0
         2 003614   777777 376003                    ANQ     -1,DU
         2 003615   200121 036100                    ADLQ    DATALVL,,AUTO
         2 003616   406060 036007                    ADLQ    -127952,DL
         2 003617   200007 756105                    STQ     ITEMLIST,AL,AUTO

  22998  2 003620   003732 701000 2                  TSX1    SCAN
         2 003621   003731 702000 2                  TSX2    SCANERR

      735    23001    4                       UTMP = 0;

  23001  2 003622   200136 450100                    STZ     UTMP,,AUTO

      736    23002                            %SCAN( LVL=DATALVL, TYP=INTG,
      737    23003                                    LEN=4, VAL=UTMP);  /* PresCtxtIdent */
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:138  

  23056  2 003623   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003624   000001 735000                    ALS     1
         2 003625   200136 630500                    EPPR0   UTMP,,AUTO
         2 003626   200010 450505                    STP0    ITEMLIST+1,AL,AUTO

  23090  2 003627   200121 236100                    LDQ     DATALVL,,AUTO
         2 003630   000037 036000 3                  ADLQ    31
         2 003631   200007 756105                    STQ     ITEMLIST,AL,AUTO

  23097  2 003632   003732 701000 2                  TSX1    SCAN
         2 003633   003731 702000 2                  TSX2    SCANERR

      738    23100                            /*N* for now, assume OCTETSTRING */
      739    23101                            %SCAN( LVL=DATALVL, TAG=C1, IMP=Y, TYP=OCTETSTR,
      740    23102                                    LEN=262143, VAL=NIL);  /*N* the data */

  23186  2 003634   000000 235000 xsym               LDA     XSP_ITEMCNT
         2 003635   000001 735000                    ALS     1
         2 003636   000015 236000 3                  LDQ     13
         2 003637   200010 756105                    STQ     ITEMLIST+1,AL,AUTO

  23189  2 003640   777777 236007                    LDQ     -1,DL
         2 003641   000000 620005                    EAX0    0,AL
         2 003642   000001 402003                    MPY     1,DU
         2 003643   200121 036100                    ADLQ    DATALVL,,AUTO
         2 003644   201440 036007                    ADLQ    66336,DL
         2 003645   200007 756110                    STQ     ITEMLIST,X0,AUTO

  23196  2 003646   003732 701000 2                  TSX1    SCAN
         2 003647   003731 702000 2                  TSX2    SCANERR

      741    23199    4                       XSP_DATABUF$( XSP_DATANUM) = SCANITEM.P;

  23199  2 003650   200006 236100                    LDQ     SCANITEM+1,,AUTO
         2 003651   000000 720000 xsym               LXL0    XSP_DATANUM
         2 003652   000000 756010 xsym               STQ     XSP_DATABUF$,X0
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:139  

      742    23200    4                       XSP_DATASIZE( XSP_DATANUM) = SCANITEM.X.LEN;

  23200  2 003653   200005 235100                    LDA     SCANITEM,,AUTO
         2 003654   000022 771000                    ARL     18
         2 003655   000000 755010 xsym               STA     XSP_DATASIZE,X0

      743    23201    4                       XSP_DATACTXT( XSP_DATANUM) = 0;

  23201  2 003656   000000 235000 xsym               LDA     XSP_DATANUM
         2 003657   000005 101400                    MRL     fill='000'O
         2 003660   000000 000004 3                  ADSC9   0                        cn=0,n=4
         2 003661   000000 000001 xsym               ADSC9   XSP_DATACTXT,A           cn=0,n=1

      744    23202    5                       DO I = 1 TO %XSP_MAX_CTXTID;

  23202  2 003662   000001 235007                    LDA     1,DL
         2 003663   200123 755100                    STA     I,,AUTO

      745    23203    5                           IF CMAP.STATE( I) = %XSP_CMAP_ACTIVE AND

  23203  2 003664   200123 235100                    LDA     I,,AUTO
         2 003665   000001 735000                    ALS     1
         2 003666   200120 470500                    LDP0    CMAP$,,AUTO
         2 003667   000001 236105                    LDQ     1,AL,PR0
         2 003670   000777 376007                    ANQ     511,DL
         2 003671   000005 116007                    CMPQ    5,DL
         2 003672   003712 601000 2                  TNZ     s:23209
         2 003673   200136 236100                    LDQ     UTMP,,AUTO
         2 003674   000000 116105                    CMPQ    0,AL,PR0
         2 003675   003712 601000 2                  TNZ     s:23209

      746    23204    6                                   UTMP = CMAP.PEERCTXTID( I) THEN DO;

      747    23205    6                               XSP_DATACTXT( XSP_DATANUM) = I;

  23205  2 003676   000000 235000 xsym               LDA     XSP_DATANUM
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:140  
         2 003677   000005 101500                    MRL     fill='000'O
         2 003700   200123 000004                    ADSC9   I,,AUTO                  cn=0,n=4
         2 003701   000000 000001 xsym               ADSC9   XSP_DATACTXT,A           cn=0,n=1

      748    23206    6                               VBLK.DATBITS( I) = %TRUE;

  23206  2 003702   200123 235100                    LDA     I,,AUTO
         2 003703   003705 605000 2                  TPL     s:23206+3
         2 003704   000044 035003                    ADLA    36,DU
         2 003705   200003 471500                    LDP1    @VBLK,,AUTO
         2 003706   003105 060400                    CSL     bolr='003'O
         2 003707   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 003710   100011 000001                    BDSC    9,A,PR1                  by=0,bit=0,n=1

      749    23207    6                               EXIT;

  23207  2 003711   003712 710000 2                  TRA     s:23209

      750    23208    6                               END;
      751    23209    5                           END;

  23209  2 003712   200123 054100                    AOS     I,,AUTO
         2 003713   200123 235100                    LDA     I,,AUTO
         2 003714   000022 115007                    CMPA    18,DL
         2 003715   003664 604400 2                  TMOZ    s:23203

      752    23210    4                       XSP_DATANUM = XSP_DATANUM + 1;

  23210  2 003716   000000 054000 xsym               AOS     XSP_DATANUM

      753    23211    4                       DATALVL = DATALVL - 1;

  23211  2 003717   000001 336007                    LCQ     1,DL
         2 003720   200121 056100                    ASQ     DATALVL,,AUTO

      754    23212    4                       END;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:141  
  23212  2 003721   200124 235100                    LDA     ITEMCUR,,AUTO
         2 003722   000001 735000                    ALS     1
         2 003723   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003724   000007 376007                    ANQ     7,DL
         2 003725   200121 116100                    CMPQ    DATALVL,,AUTO
         2 003726   003604 605400 2                  TPNZ    s:22902

      755    23213    3                   END;

  23213  2 003727   003730 710000 2                  TRA     s:23217

      756    23214    2               ELSE
      757    23215    2                   GOTO SCANERR;
      758    23216    2           END;
      759    23217    1       RETURN;

  23217  2 003730   000000 702200 xent               TSX2  ! X66_ARET

      760    23218    1   SCANERR:
      761    23219            /* An error occurred while decoding the PPDU */
      762    23220    1       ALTRETURN;

  23220  2 003731   000000 702200 xent  SCANERR      TSX2  ! X66_AALT

      763    23221        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:142  
      764    23222        /*I*    NAME:   SCAN
      765    23223
      766    23224                SCAN is called for each item of the PPDU expected to be seen.  The
      767    23225                contents of SCANITEM are compared with the current item.  If they
      768    23226                match, the associated value is moved from the current item to the
      769    23227                VAL field indicated in SCANITEM.  Otherwise, heuristics are used to
      770    23228                figure out if the PPDU is in error or we need to skip over optional
      771    23229                items not supplied in the PPDU.
      772    23230        */
      773    23231    1   SCAN: PROC ALTRET;

  23231  2 003732   200160 741300       SCAN         STX1  ! INITLEN+9,,AUTO

      774    23232
      775    23233    2       IF ITEMCUR > ITEMNUM THEN

  23233  2 003733   200124 236100                    LDQ     ITEMCUR,,AUTO
         2 003734   200125 116100                    CMPQ    ITEMNUM,,AUTO
         2 003735   003737 604400 2                  TMOZ    s:23237

      776    23234                /* fell off the end of the PPDU */
      777    23235    2           ALTRETURN;

  23235  2 003736   000000 702211                    TSX2  ! 0,X1

      778    23236            /* compare LVLs */
      779    23237    2       IF ITEMLIST.X.LVL( ITEMCUR) < SCANITEM.X.LVL THEN

  23237  2 003737   200005 236100                    LDQ     SCANITEM,,AUTO
         2 003740   000007 376007                    ANQ     7,DL
         2 003741   200162 756100                    STQ     INITLEN+11,,AUTO
         2 003742   200124 235100                    LDA     ITEMCUR,,AUTO
         2 003743   000001 735000                    ALS     1
         2 003744   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003745   000007 376007                    ANQ     7,DL
         2 003746   200162 116100                    CMPQ    INITLEN+11,,AUTO
         2 003747   003751 605000 2                  TPL     s:23239
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:143  

      780    23238    2           RETURN;  /* skip ahead in order to resynchronize levels */

  23238  2 003750   000001 702211                    TSX2  ! 1,X1

      781    23239    3       IF ITEMLIST.X.LVL( ITEMCUR) = SCANITEM.X.LVL THEN DO;

  23239  2 003751   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003752   200005 676100                    ERQ     SCANITEM,,AUTO
         2 003753   000007 376007                    ANQ     7,DL
         2 003754   004304 601000 2                  TNZ     s:23339

      782    23240                /* compare TAGs */
      783    23241    4           IF ITEMLIST.X.TAG( ITEMCUR) = SCANITEM.X.TAG THEN DO;

  23241  2 003755   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003756   200005 676100                    ERQ     SCANITEM,,AUTO
         2 003757   377000 376007                    ANQ     130560,DL
         2 003760   004276 601000 2                  TNZ     s:23332

      784    23242                    /* O.K. We have a match!  Now we move the value part of the
      785    23243                       matched tag-length-value item to the given buffer. */
      786    23244    5               DO CASE( SCANITEM.X.TYP);

  23244  2 003761   200005 236100                    LDQ     SCANITEM,,AUTO
         2 003762   000003 772000                    QRL     3
         2 003763   000037 376007                    ANQ     31,DL
         2 003764   000034 116007                    CMPQ    28,DL
         2 003765   003767 602006 2                  TNC     s:23244+6,QL
         2 003766   004274 710000 2                  TRA     s:23328
         2 003767   004275 710000 2                  TRA     s:23330
         2 003770   004023 710000 2                  TRA     s:23254
         2 003771   004063 710000 2                  TRA     s:23266
         2 003772   004132 710000 2                  TRA     s:23278
         2 003773   004215 710000 2                  TRA     s:23304
         2 003774   004275 710000 2                  TRA     s:23330
         2 003775   004255 710000 2                  TRA     s:23319
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:144  
         2 003776   004255 710000 2                  TRA     s:23319
         2 003777   004275 710000 2                  TRA     s:23330
         2 004000   004274 710000 2                  TRA     s:23328
         2 004001   004274 710000 2                  TRA     s:23328
         2 004002   004274 710000 2                  TRA     s:23328
         2 004003   004274 710000 2                  TRA     s:23328
         2 004004   004274 710000 2                  TRA     s:23328
         2 004005   004275 710000 2                  TRA     s:23330
         2 004006   004275 710000 2                  TRA     s:23330
         2 004007   004275 710000 2                  TRA     s:23330
         2 004010   004275 710000 2                  TRA     s:23330
         2 004011   004215 710000 2                  TRA     s:23304
         2 004012   004215 710000 2                  TRA     s:23304
         2 004013   004215 710000 2                  TRA     s:23304
         2 004014   004215 710000 2                  TRA     s:23304
         2 004015   004215 710000 2                  TRA     s:23304
         2 004016   004275 710000 2                  TRA     s:23330
         2 004017   004275 710000 2                  TRA     s:23330
         2 004020   004215 710000 2                  TRA     s:23304
         2 004021   004215 710000 2                  TRA     s:23304
         2 004022   004215 710000 2                  TRA     s:23304

      787    23245    5                   CASE( %XSP_TYP_NONE,

      788    23246    5                         %XSP_TYP_NULL,
      789    23247    5                         %XSP_TYP_EXTRN,
      790    23248    5                         %XSP_TYP_SEQ,
      791    23249    5                         %XSP_TYP_SET,
      792    23250    5                         %XSP_TYP_SEQOF,
      793    23251    5                         %XSP_TYP_SETOF);
      794    23252    5                       ;  /* no need to do anything for these types */
      795    23253    5                   CASE( %XSP_TYP_BOOL);

      796    23254    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);

  23254  2 004023   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 004024   000022 772000                    QRL     18
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:145  
         2 004025   200113 756100                    STQ     SRCLEN,,AUTO

      797    23255    5                       DSTLEN = SCANITEM.X.LEN;

  23255  2 004026   200005 235100                    LDA     SCANITEM,,AUTO
         2 004027   000022 771000                    ARL     18
         2 004030   200116 755100                    STA     DSTLEN,,AUTO

      798    23256    5                       IF SRCLEN > DSTLEN THEN

  23256  2 004031   200116 116100                    CMPQ    DSTLEN,,AUTO
         2 004032   004034 604400 2                  TMOZ    s:23258

      799    23257    5                           ALTRETURN;  /* source is too long for buffer */

  23257  2 004033   000000 702211                    TSX2  ! 0,X1

      800    23258    5                       SRC$ = ITEMLIST.P( ITEMCUR);

  23258  2 004034   200124 235100                    LDA     ITEMCUR,,AUTO
         2 004035   000001 735000                    ALS     1
         2 004036   200010 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 004037   200111 756100                    STQ     SRC$,,AUTO

      801    23259    5                       BDST$ = SCANITEM.P;

  23259  2 004040   200006 236100                    LDQ     SCANITEM+1,,AUTO
         2 004041   200115 756100                    STQ     BDST$,,AUTO

      802    23260    5                       TEMP = ASCBIN( SUBSTR( SRC$->SRCBYTES, 0, 1));

  23260  2 004042   200111 470500                    LDP0    SRC$,,AUTO
         2 004043   000100 101500                    MRL     fill='000'O
         2 004044   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 004045   200162 000004                    ADSC9   INITLEN+11,,AUTO         cn=0,n=4
         2 004046   200162 236100                    LDQ     INITLEN+11,,AUTO
         2 004047   200134 756100                    STQ     TEMP,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:146  

      803    23261    5                       IF TEMP = 0 THEN

  23261  2 004050   004056 601000 2                  TNZ     s:23264

      804    23262    5                           BDST$->BIT1 = '0'B;

  23262  2 004051   200115 471500                    LDP1    BDST$,,AUTO
         2 004052   003100 060400                    CSL     bolr='003'O
         2 004053   000000 000001 3                  BDSC    0                        by=0,bit=0,n=1
         2 004054   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         2 004055   004275 710000 2                  TRA     s:23330

      805    23263    5                       ELSE
      806    23264    5                           BDST$->BIT1 = '1'B;

  23264  2 004056   200115 471500                    LDP1    BDST$,,AUTO
         2 004057   003100 060400                    CSL     bolr='003'O
         2 004060   000020 000001 3                  BDSC    16                       by=0,bit=0,n=1
         2 004061   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         2 004062   004275 710000 2                  TRA     s:23330

      807    23265    5                   CASE( %XSP_TYP_INTG);

      808    23266    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);

  23266  2 004063   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 004064   000022 772000                    QRL     18
         2 004065   200113 756100                    STQ     SRCLEN,,AUTO

      809    23267    5                       DSTLEN = SCANITEM.X.LEN;

  23267  2 004066   200005 235100                    LDA     SCANITEM,,AUTO
         2 004067   000022 771000                    ARL     18
         2 004070   200116 755100                    STA     DSTLEN,,AUTO

      810    23268    5                       IF SRCLEN > DSTLEN THEN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:147  

  23268  2 004071   200116 116100                    CMPQ    DSTLEN,,AUTO
         2 004072   004074 604400 2                  TMOZ    s:23270

      811    23269    5                           ALTRETURN;  /* source is too long for buffer */

  23269  2 004073   000000 702211                    TSX2  ! 0,X1

      812    23270    5                       BSRC$ = ITEMLIST.P( ITEMCUR);

  23270  2 004074   200124 235100                    LDA     ITEMCUR,,AUTO
         2 004075   000001 735000                    ALS     1
         2 004076   200010 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 004077   200112 756100                    STQ     BSRC$,,AUTO

      813    23271    5                       BDST$ = PINCRB( SCANITEM.P, 4 + 8*(4-SRCLEN));

  23271  2 004100   200006 470500                    LDP0    SCANITEM+1,,AUTO
         2 004101   200113 335100                    LCA     SRCLEN,,AUTO
         2 004102   000003 735000                    ALS     3
         2 004103   004105 605000 2                  TPL     s:23271+5
         2 004104   000044 035003                    ADLA    36,DU
         2 004105   000001 503505                    ABD     1,AL,PR0
         2 004106   200115 450500                    STP0    BDST$,,AUTO

      814    23272    6                       DO I = 1 TO SRCLEN;

  23272  2 004107   000001 235007                    LDA     1,DL
         2 004110   200123 755100                    STA     I,,AUTO
         2 004111   004126 710000 2                  TRA     s:23276+1

      815    23273    6                           BDST$->BIT8 = PINCRB( BSRC$, 1)->BIT8;

  23273  2 004112   200112 470500                    LDP0    BSRC$,,AUTO
         2 004113   200115 471500                    LDP1    BDST$,,AUTO
         2 004114   003100 060500                    CSL     bolr='003'O
         2 004115   000000 010010                    BDSC    0,,PR0                   by=0,bit=1,n=8
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:148  
         2 004116   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=8

      816    23274    6                           BDST$ = PINCRB( BDST$, 8);

  23274  2 004117   000010 220003                    LDX0    8,DU
         2 004120   100000 503510                    ABD     0,X0,PR1
         2 004121   200115 451500                    STP1    BDST$,,AUTO

      817    23275    6                           BSRC$ = PINCRC( BSRC$, 1);

  23275  2 004122   200112 236100                    LDQ     BSRC$,,AUTO
         2 004123   200000 036007                    ADLQ    65536,DL
         2 004124   200112 756100                    STQ     BSRC$,,AUTO

      818    23276    6                           END;

  23276  2 004125   200123 054100                    AOS     I,,AUTO
         2 004126   200123 236100                    LDQ     I,,AUTO
         2 004127   200113 116100                    CMPQ    SRCLEN,,AUTO
         2 004130   004112 604400 2                  TMOZ    s:23273
         2 004131   004275 710000 2                  TRA     s:23330

      819    23277    5                   CASE( %XSP_TYP_BITSTR);

      820    23278    5                       SRC$ = ITEMLIST.P( ITEMCUR);

  23278  2 004132   200010 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 004133   200111 756100                    STQ     SRC$,,AUTO

      821    23279    5                       TEMP = ASCBIN( SUBSTR( SRC$->SRCBYTES, 0, 1)); /* slack */

  23279  2 004134   200111 470500                    LDP0    SRC$,,AUTO
         2 004135   000100 101500                    MRL     fill='000'O
         2 004136   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 004137   200162 000004                    ADSC9   INITLEN+11,,AUTO         cn=0,n=4
         2 004140   200162 236100                    LDQ     INITLEN+11,,AUTO
         2 004141   200134 756100                    STQ     TEMP,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:149  

      822    23280    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);  /* byte-length */

  23280  2 004142   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 004143   000022 772000                    QRL     18
         2 004144   200113 756100                    STQ     SRCLEN,,AUTO

      823    23281    5                       SRCLEN = ( 8-TEMP) + ( SRCLEN-2)*8;  /* bit-length */

  23281  2 004145   000003 736000                    QLS     3
         2 004146   000001 676000 3                  ERQ     1
         2 004147   000001 036007                    ADLQ    1,DL
         2 004150   200134 036100                    ADLQ    TEMP,,AUTO
         2 004151   000001 676000 3                  ERQ     1
         2 004152   000007 136007                    SBLQ    7,DL
         2 004153   200113 756100                    STQ     SRCLEN,,AUTO

      824    23282    5                       DSTLEN = SCANITEM.X.LEN;

  23282  2 004154   200005 235100                    LDA     SCANITEM,,AUTO
         2 004155   000022 771000                    ARL     18
         2 004156   200116 755100                    STA     DSTLEN,,AUTO

      825    23283                            /* NOTE: SRCLEN AND DSTLEN CONTAIN LENGTHS IN *BITS* */
      826    23284    5                       IF SRCLEN > DSTLEN THEN

  23284  2 004157   200116 116100                    CMPQ    DSTLEN,,AUTO
         2 004160   004162 604400 2                  TMOZ    s:23287

      827    23285    5                           ALTRETURN;  /* source is too long for buffer */

  23285  2 004161   000000 702211                    TSX2  ! 0,X1

      828    23286                            /* move octets from source to destination */
      829    23287    5                       BSRC$ = SRC$;

  23287  2 004162   200111 236100                    LDQ     SRC$,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:150  
         2 004163   200112 756100                    STQ     BSRC$,,AUTO

      830    23288    5                       BDST$ = SCANITEM.P;

  23288  2 004164   200006 236100                    LDQ     SCANITEM+1,,AUTO
         2 004165   200115 756100                    STQ     BDST$,,AUTO

      831    23289    5                       TEMP = ( DSTLEN + 8) / 9;

  23289  2 004166   200116 236100                    LDQ     DSTLEN,,AUTO
         2 004167   000010 036007                    ADLQ    8,DL
         2 004170   000011 506007                    DIV     9,DL
         2 004171   200134 756100                    STQ     TEMP,,AUTO

      832    23290    6                       DO I = 1 TO TEMP;

  23290  2 004172   000001 235007                    LDA     1,DL
         2 004173   200123 755100                    STA     I,,AUTO
         2 004174   004211 710000 2                  TRA     s:23294+1

      833    23291    6                           BSRC$ = PINCRC( BSRC$, 1);

  23291  2 004175   200112 236100                    LDQ     BSRC$,,AUTO
         2 004176   200000 036007                    ADLQ    65536,DL
         2 004177   200112 756100                    STQ     BSRC$,,AUTO

      834    23292    6                           BDST$->BIT8 = PINCRB( BSRC$, 1)->BIT8;

  23292  2 004200   200112 470500                    LDP0    BSRC$,,AUTO
         2 004201   200115 471500                    LDP1    BDST$,,AUTO
         2 004202   003100 060500                    CSL     bolr='003'O
         2 004203   000000 010010                    BDSC    0,,PR0                   by=0,bit=1,n=8
         2 004204   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=8

      835    23293    6                           BDST$ = PINCRB( BDST$, 8);

  23293  2 004205   000010 220003                    LDX0    8,DU
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:151  
         2 004206   100000 503510                    ABD     0,X0,PR1
         2 004207   200115 451500                    STP1    BDST$,,AUTO

      836    23294    6                           END;

  23294  2 004210   200123 054100                    AOS     I,,AUTO
         2 004211   200123 236100                    LDQ     I,,AUTO
         2 004212   200134 116100                    CMPQ    TEMP,,AUTO
         2 004213   004175 604400 2                  TMOZ    s:23291
         2 004214   004275 710000 2                  TRA     s:23330

      837    23295    5                   CASE( %XSP_TYP_OCTETSTR,

      838    23296    5                         %XSP_TYP_NUMSTR,
      839    23297    5                         %XSP_TYP_PRNTSTR,
      840    23298    5                         %XSP_TYP_TELSTR,
      841    23299    5                         %XSP_TYP_VIDSTR,
      842    23300    5                         %XSP_TYP_IA5STR,
      843    23301    5                         %XSP_TYP_GRFSTR,
      844    23302    5                         %XSP_TYP_VISSTR /* == %XSP_TYP_ISO646STR */,
      845    23303    5                         %XSP_TYP_GENSTR);
      846    23304    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);

  23304  2 004215   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 004216   000022 772000                    QRL     18
         2 004217   200113 756100                    STQ     SRCLEN,,AUTO

      847    23305    5                       DSTLEN = SCANITEM.X.LEN;

  23305  2 004220   200005 235100                    LDA     SCANITEM,,AUTO
         2 004221   000022 771000                    ARL     18
         2 004222   200116 755100                    STA     DSTLEN,,AUTO

      848    23306    5                       IF SRCLEN > DSTLEN THEN

  23306  2 004223   200116 116100                    CMPQ    DSTLEN,,AUTO
         2 004224   004226 604400 2                  TMOZ    s:23308
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:152  

      849    23307    5                           ALTRETURN;  /* source is too long for buffer */

  23307  2 004225   000000 702211                    TSX2  ! 0,X1

      850    23308    5                       DSTLEN = MINIMUM( DSTLEN, SRCLEN);

  23308  2 004226   004230 604400 2                  TMOZ    s:23308+2
         2 004227   200116 236100                    LDQ     DSTLEN,,AUTO
         2 004230   200116 756100                    STQ     DSTLEN,,AUTO

      851    23309    6                       IF SCANITEM.P = ADDR( NIL) THEN DO;

  23309  2 004231   200006 236100                    LDQ     SCANITEM+1,,AUTO
         2 004232   000015 116000 3                  CMPQ    13
         2 004233   004243 601000 2                  TNZ     s:23315

      852    23310                                /* don't copy data; just point at it in the PPDU */
      853    23311    6                           SCANITEM.P = ITEMLIST.P( ITEMCUR);

  23311  2 004234   200124 235100                    LDA     ITEMCUR,,AUTO
         2 004235   000001 735000                    ALS     1
         2 004236   200010 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 004237   200006 756100                    STQ     SCANITEM+1,,AUTO

      854    23312    6                           SCANITEM.X.LEN = DSTLEN;

  23312  2 004240   200116 720100                    LXL0    DSTLEN,,AUTO
         2 004241   200005 740100                    STX0    SCANITEM,,AUTO

      855    23313    6                           END;

  23313  2 004242   004275 710000 2                  TRA     s:23330

      856    23314    5                       ELSE
      857    23315    5                           SCANITEM.P->DSTBYTES = ITEMLIST.P( ITEMCUR)->SRCBYTES;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:153  
  23315  2 004243   200124 235100                    LDA     ITEMCUR,,AUTO
         2 004244   000001 735000                    ALS     1
         2 004245   200010 470505                    LDP0    ITEMLIST+1,AL,AUTO
         2 004246   200113 720100                    LXL0    SRCLEN,,AUTO
         2 004247   200006 471500                    LDP1    SCANITEM+1,,AUTO
         2 004250   200116 722100                    LXL2    DSTLEN,,AUTO
         2 004251   040140 100540                    MLR     fill='040'O
         2 004252   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 004253   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
         2 004254   004275 710000 2                  TRA     s:23330

      858    23316    5                   CASE( %XSP_TYP_OBJID,

      859    23317    5                         %XSP_TYP_OBJDSCR);
      860    23318                            /*N* convert encoding to num-num-num form */
      861    23319    5                       SRCLEN = ITEMLIST.X.LEN( ITEMCUR);

  23319  2 004255   200007 236105                    LDQ     ITEMLIST,AL,AUTO
         2 004256   000022 772000                    QRL     18
         2 004257   200113 756100                    STQ     SRCLEN,,AUTO

      862    23320    5                       SCANITEM.P = PINCRC( SCANITEM.P, -2);

  23320  2 004260   200006 236100                    LDQ     SCANITEM+1,,AUTO
         2 004261   000040 036000 3                  ADLQ    32
         2 004262   200006 756100                    STQ     SCANITEM+1,,AUTO

      863    23321    5                       SCANITEM.P->CTXT.LEN = SRCLEN;

  23321  2 004263   200113 720100                    LXL0    SRCLEN,,AUTO
         2 004264   200006 470500                    LDP0    SCANITEM+1,,AUTO
         2 004265   000000 740100                    STX0    0,,PR0

      864    23322    5                       SCANITEM.P->CTXT.TXT = ITEMLIST.P( ITEMCUR)->SRCBYTES;

  23322  2 004266   200010 471505                    LDP1    ITEMLIST+1,AL,AUTO
         2 004267   200113 721100                    LXL1    SRCLEN,,AUTO
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:154  
         2 004270   040140 100540                    MLR     fill='040'O
         2 004271   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         2 004272   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         2 004273   004275 710000 2                  TRA     s:23330

      865    23323    5                   CASE( %XSP_TYP_UTCTIM,

      866    23324    5                         %XSP_TYP_GENTIM);
      867    23325                            /*N* convert encoding to UTS value, someday */
      868    23326    5                   CASE( ELSE);

      869    23327                            /* bad SCANITEM.TYP */
      870    23328    5                       ALTRETURN;

  23328  2 004274   000000 702211                    TSX2  ! 0,X1

      871    23329    5                   END;

      872    23330    4               GOTO RET;

  23330  2 004275   004305 710000 2                  TRA     RET

      873    23331    4               END;
      874    23332    3           IF SCANITEM.X.OPT = 1 THEN

  23332  2 004276   200005 236100                    LDQ     SCANITEM,,AUTO
         2 004277   400000 376007                    ANQ     -131072,DL
         2 004300   400000 116007                    CMPQ    -131072,DL
         2 004301   004303 601000 2                  TNZ     s:23336

      875    23333                    /* looks like this optional item is not present */
      876    23334    3               RETURN;

  23334  2 004302   000001 702211                    TSX2  ! 1,X1

      877    23335                /* this required item is not present */
      878    23336    3           ALTRETURN;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:155  

  23336  2 004303   000000 702211                    TSX2  ! 0,X1

      879    23337    3           END;
      880    23338            /*N* something's wrong.. don't know what to do yet...... */
      881    23339    2       ALTRETURN;

  23339  2 004304   000000 702211                    TSX2  ! 0,X1

      882    23340    2   RET:
      883    23341    2       ITEMCUR = ITEMCUR + 1;

  23341  2 004305   200124 054100       RET          AOS     ITEMCUR,,AUTO

      884    23342    2       RETURN;

  23342  2 004306   200160 221300                    LDX1  ! INITLEN+9,,AUTO
         2 004307   000001 702211                    TSX2  ! 1,X1

      885    23343
      886    23344    2       END SCAN;
      887    23345        %EJECT;
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:156  
      888    23346        /*I*    NAME:   GETLEN
      889    23347
      890    23348                GETLEN is called to extract the length of the next item of the PDU.
      891    23349                It handles both forms of definite length as well as indefinite length.
      892    23350                The various PDU scan pointers are updated.  The length is stored in
      893    23351                TEMP for use by the main code.
      894    23352        */
      895    23353    1   GETLEN: PROC;

  23353  2 004310   200160 741300       GETLEN       STX1  ! INITLEN+9,,AUTO

      896    23354
      897    23355    2       TEMP = ASCBIN( SUBSTR( PDU, PDUIDX, 1));

  23355  2 004311   200130 470500                    LDP0    PDU$,,AUTO
         2 004312   200131 235100                    LDA     PDUIDX,,AUTO
         2 004313   000100 101505                    MRL     fill='000'O
         2 004314   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 004315   200162 000004                    ADSC9   INITLEN+11,,AUTO         cn=0,n=4
         2 004316   200162 236100                    LDQ     INITLEN+11,,AUTO
         2 004317   200134 756100                    STQ     TEMP,,AUTO

      898    23356    2       PDUIDX = PDUIDX + 1;

  23356  2 004320   200131 054100                    AOS     PDUIDX,,AUTO

      899    23357    2       CURRLEN( DEPTH) = CURRLEN( DEPTH) - 1;

  23357  2 004321   200122 720100                    LXL0    DEPTH,,AUTO
         2 004322   000001 336007                    LCQ     1,DL
         2 004323   200137 056110                    ASQ     CURRLEN,X0,AUTO

      900    23358    3       IF TEMP = 128 THEN DO;

  23358  2 004324   200134 235100                    LDA     TEMP,,AUTO
         2 004325   000200 115007                    CMPA    128,DL
         2 004326   004331 601000 2                  TNZ     s:23363
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:157  

      901    23359                /* indefinite form */
      902    23360    3           TEMP = -1;

  23360  2 004327   200134 756100                    STQ     TEMP,,AUTO

      903    23361    3           RETURN;

  23361  2 004330   000001 702211                    TSX2  ! 1,X1

      904    23362    3           END;
      905    23363    3       IF TEMP > 128 THEN DO;

  23363  2 004331   004361 604400 2                  TMOZ    s:23374

      906    23364                /* long form */
      907    23365    3           I = TEMP - 128;

  23365  2 004332   000200 135007                    SBLA    128,DL
         2 004333   200123 755100                    STA     I,,AUTO

      908    23366    3           CURRLEN( DEPTH) = CURRLEN( DEPTH) - I;

  23366  2 004334   200137 236110                    LDQ     CURRLEN,X0,AUTO
         2 004335   200123 136100                    SBLQ    I,,AUTO
         2 004336   200137 756110                    STQ     CURRLEN,X0,AUTO

      909    23367    3           TEMP = 0;

  23367  2 004337   200134 450100                    STZ     TEMP,,AUTO

      910    23368    4           DO WHILE( I > 0);

  23368  2 004340   000000 115003                    CMPA    0,DU
         2 004341   004361 604400 2                  TMOZ    s:23374

      911    23369    4               TEMP = TEMP*256 + ASCBIN( SUBSTR( PDU, PDUIDX, 1));
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:158  

  23369  2 004342   200130 470500                    LDP0    PDU$,,AUTO
         2 004343   200131 235100                    LDA     PDUIDX,,AUTO
         2 004344   000100 101505                    MRL     fill='000'O
         2 004345   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 004346   200162 000004                    ADSC9   INITLEN+11,,AUTO         cn=0,n=4
         2 004347   200162 236100                    LDQ     INITLEN+11,,AUTO
         2 004350   200163 756100                    STQ     INITLEN+12,,AUTO
         2 004351   200134 236100                    LDQ     TEMP,,AUTO
         2 004352   000010 736000                    QLS     8
         2 004353   200163 036100                    ADLQ    INITLEN+12,,AUTO
         2 004354   200134 756100                    STQ     TEMP,,AUTO

      912    23370    4               PDUIDX = PDUIDX + 1;

  23370  2 004355   200131 054100                    AOS     PDUIDX,,AUTO

      913    23371    4               I = I - 1;

  23371  2 004356   000001 336007                    LCQ     1,DL
         2 004357   200123 056100                    ASQ     I,,AUTO

      914    23372    4               END;

  23372  2 004360   004342 605400 2                  TPNZ    s:23369

      915    23373    3           END;

      916    23374    2       RETURN;

  23374  2 004361   200160 221300                    LDX1  ! INITLEN+9,,AUTO
         2 004362   000001 702211                    TSX2  ! 1,X1

ABSNAME
 Sect OctLoc
   0     000   000026 047056   056056 056056   056056 056056   056056 056056    ..'.............
   0     004   056056 056056   056056 056047                                    .......'
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:159  

TFRNAME
 Sect OctLoc
   0     006   000026 047056   056056 056056   056056 056056   056056 056056    ..'.............
   0     012   056056 056056   056056 056047                                    .......'

TWOZEROES
 Sect OctLoc
   1     000   000000 ******                                                    ....

(unnamed)
 Sect OctLoc
   1     001   000000 000000                                                    ....

(unnamed)
 Sect OctLoc
   3     000   000000 000000   777777 777777   000000 006000   000006 006000    ................
   3     004   000002 000000   000014 400000   000001 200023   000001 600433    ................
   3     010   000340 601443   000340 602443   000004 002025   000777 777777    ................
   3     014   777000 777777   000000 006014   777777 760777   777777 777000    ................
   3     020   400000 000000   000002 610433   000013 611433   000340 603443    ................
   3     024   000004 200425   000004 202425   000001 600432   000340 603442    ................
   3     030   000004 200424   000004 202424   000004 612422   000004 002024    ................
   3     034   000004 002023   000004 600422   000004 601422   000004 002020    ................
   3     040   777777 400000                                                    ....
      917    23375
      918    23376    2       END GETLEN;
      919    23377
      920    23378    1       END XSP$DECODE;
      921    23379        %EOD;

PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:160  
--  Include file information  --

   XSC_COMMON_M.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   XSP_PRESENTATION_M.:XSA1TOU  is referenced.
   XSP_PRESENTATION_E.:XSA1TOU  is referenced.
   XSP_INTERNAL_M.:XSA1TOU  is referenced.
   XSP_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$DECODE.
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:161  

 **** Variables and constants ****

  ****  Section 000  Data  XSP$DECODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(216)   r     1 ABSNAME                    6-0-0/w STRC(216)   r     1 TFRNAME

  ****  Section 001 RoData XSP$DECODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(18)    r     1 TWOZEROES

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @SFPT$                     3-0-0/w PTR         r     1 @VBLK
   107-0-0/w PTR         r     1 ABS$                     115-0-0/b PTR         r     1 BDST$
   112-0-0/b PTR         r     1 BSRC$                    117-0-0/b BIT         r     1 BTMP
   120-0-0/w PTR         r     1 CMAP$
   137-0-0/w SBIN        r     1 CURRLEN(0:7)
   121-0-0/w SBIN        r     1 DATALVL                  122-0-0/w SBIN        r     1 DEPTH
   116-0-0/w SBIN        r     1 DSTLEN                   123-0-0/w SBIN        r     1 I
   147-0-0/w SBIN        r     1 INITLEN(0:7)
   124-0-0/w SBIN        r     1 ITEMCUR
     7-0-0/w STRC(72)    r     1 ITEMLIST(0:31)
   125-0-0/w SBIN        r     1 ITEMNUM                  126-0-0/w SBIN        r     1 J
   130-0-0/c PTR         r     1 PDU$                     131-0-0/w SBIN        r     1 PDUIDX
   132-0-0/w PTR         r     1 PSAP$                      5-0-0/w STRC(72)    r     1 SCANITEM
    *0-0-0/w PTR         r     1 SFPT$                    111-0-0/c PTR         r     1 SRC$
   113-0-0/w SBIN        r     1 SRCLEN                   133-0-0/w SBIN        r     1 TAG
   133-0-0/w STRC        r     1 TAGX                     134-0-0/w SBIN        r     1 TEMP
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:162  
   110-0-0/w PTR         r     1 TFR$                     135-0-0/w PTR         r     1 TMP$
   136-0-0/w UBIN        r     1 UTMP                      *0-0-0/d STRC(396)   r     1 VBLK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 XSP_ABSLIST                0-0-0/w STRC(216)   r     1 XSP_ALTER_CONTEXT
     0-0-0/w STRC(108)   r     1 XSP_CAPABILITY_DATA        0-0-0/w STRC(398)   r     1 XSP_CONNECT
     0-0-0/w STRC(108)   r     1 XSP_DATA
     0-0-0/w PTR         r     1 XSP_DATABUF$(0:7)
     0-0-0/c UBIN(9)     r     1 XSP_DATACTXT(0:7)
     0-0-0/w SBIN        r     1 XSP_DATANUM
     0-0-0/w SBIN        r     1 XSP_DATASIZE(0:7)
     0-0-0/w PTR         r     1 XSP_DSTADDR$               0-0-0/w STRC(108)   r     1 XSP_EXPEDITED_DATA
     0-0-0/w SBIN        r     1 XSP_ITEMCNT                0-0-0/w STRC(216)   r     1 XSP_RESYNCHRONIZE
     0-0-0/w PTR         r     1 XSP_SRCADDR$               0-0-0/w STRC        r     1 XSP_TFRLIST
     0-0-0/w PTR         r     1 XSP_TMPCTXT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 BIT1                       0-0-0/b BIT (8)     r     1 BIT8
     0-0-0/d STRC        r     1 CLST                       0-0-0/w STRC(72)    r     1 CMAP(0:0)
     0-0-0/w ASTR(18)    r     1 CTXT                       0-0-0/c ACHR        r     1 DSTBYTES
     0-0-0/w STRC(468)   r     1 PCTX                       0-0-0/c CHAR(16384) r     1 PDU
     0-0-0/c ASTR(9)     r     1 PSAP                       0-0-0/c ACHR        r     1 SRCBYTES
     0-0-0/w STRC(2718)  r     1 XSC$ADDRESS                0-0-0/w STRC(216)   r     1 XSP$ALTER_CONTEXT
     0-0-0/w STRC(108)   r     1 XSP$CAPABILITY_DATA        0-0-0/w STRC(398)   r     1 XSP$CONNECT
     0-0-0/w STRC(108)   r     1 XSP$DATA                   0-0-0/w STRC(108)   r     1 XSP$EXPEDITED_DATA
     0-0-0/w STRC(72)    r     1 XSP$P_ABORT                0-0-0/w STRC(216)   r     1 XSP$RESYNCHRONIZE
     0-0-0/w STRC(108)   r     1 XSP$TYPED_DATA             0-0-0/w STRC(108)   r     1 XSP$U_ABORT
     0-0-0/d STRC(396)   r     1 XSS$CONNECT                0-0-0/d STRC(504)   r     1 XSS$GENERIC
     0-0-0/w STRC(72)    r     1 XSS$P_ABORT                0-0-0/d STRC(144)   r     1 XSS$TYPED_DATA
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:163  
     0-0-0/d STRC(144)   r     1 XSS$U_ABORT


   Procedure XSP$DECODE requires 2291 words for executable code.
   Procedure XSP$DECODE requires 118 words of local(AUTO) storage.
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:164  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:165  
          MINI XREF LISTING

ABS$
     14750**DCL     14855<<ASSIGN  16053>>ASSIGN  16066>>ASSIGN  16280>>IF      16280>>IF      16280>>IF
     16480>>ASSIGN  16493>>ASSIGN  16606>>IF      16606>>IF      16606>>IF      20586>>ASSIGN  20599>>ASSIGN
     20812>>IF      20812>>IF      20812>>IF      20822>>IF      20822>>IF      20822>>IF
ABSNAME
     13168**DCL     14855--ASSIGN
AC_CTXT_ABS
     20810**LABEL   20816--EXIT
AC_CTXT_DEL
     21036**LABEL   21040--EXIT
AC_CTXT_TFR
     20820**LABEL   20826--EXIT
ARU_CTXT_TFR
     22370**LABEL   22377--EXIT
BDST$
     14757**DCL     23259<<ASSIGN  23262>>ASSIGN  23264>>ASSIGN  23271<<ASSIGN  23273>>ASSIGN  23274<<ASSIGN
     23274>>ASSIGN  23288<<ASSIGN  23292>>ASSIGN  23293<<ASSIGN  23293>>ASSIGN
BIT1
     14760**DCL     23262<<ASSIGN  23264<<ASSIGN
BIT8
     14761**DCL     23273<<ASSIGN  23273>>ASSIGN  23292<<ASSIGN  23292>>ASSIGN
BSRC$
     14753**DCL     23270<<ASSIGN  23273>>ASSIGN  23275<<ASSIGN  23275>>ASSIGN  23287<<ASSIGN  23291<<ASSIGN
     23291>>ASSIGN  23292>>ASSIGN
BTMP
     14762**DCL     15383<<ASSIGN  15444--ASSIGN  15482>>IF      16633<<ASSIGN  16694--ASSIGN  16732>>ASSIGN
     16733<<ASSIGN  16794--ASSIGN  16832>>ASSIGN  17240<<ASSIGN  17301--ASSIGN  17339>>IF      17951<<ASSIGN
     18012--ASSIGN  18050>>ASSIGN  18051<<ASSIGN  18112--ASSIGN  18150>>ASSIGN  18253<<ASSIGN  18314--ASSIGN
     18352>>IF
CLST.COUNT
     13105**DCL     15780<<ASSIGN  16273<<ASSIGN  20806<<ASSIGN
CLST.CTXT$
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:166  
     13103**DCL     13104--REDEF   13105--REDEF
CLST.RESULT
     13104**DCL     16303<<ASSIGN  20835<<ASSIGN
CMAP.ABSCTXTID
      7571**DCL     16274<<ASSIGN  16283<<ASSIGN  16297>>IF      16601<<ASSIGN  16609<<ASSIGN  16624>>IF
     20807<<ASSIGN  20815<<ASSIGN  20829>>IF
CMAP.PEERCTXTID
      7570**DCL     16302<<ASSIGN  16629<<ASSIGN  19588>>IF      20098>>IF      20834<<ASSIGN  21037>>IF
     22372>>IF      23203>>IF
CMAP.REASON
      7576**DCL     17946<<ASSIGN  18959<<ASSIGN  21651<<ASSIGN
CMAP.RESULT
      7577**DCL     16298<<ASSIGN  16300<<ASSIGN  16303>>ASSIGN  16625<<ASSIGN  16627<<ASSIGN  16630>>ASSIGN
     17945<<ASSIGN  18958<<ASSIGN  20830<<ASSIGN  20832<<ASSIGN  20835>>ASSIGN  21650<<ASSIGN  21859<<ASSIGN
CMAP.STATE
      7578**DCL     16301<<ASSIGN  16628<<ASSIGN  17938>>DOWHILE 18951>>DOWHILE 20833<<ASSIGN  21038<<ASSIGN
     21641>>DOWHILE 21854>>DOWHILE 23203>>IF
CMAP.TFRCTXTID
      7572**DCL     16275<<ASSIGN  16293<<ASSIGN  16297>>IF      16602<<ASSIGN  16620<<ASSIGN  16624>>IF
     17943>>IF      18956>>IF      19587>>ASSIGN  20097>>ASSIGN  20808<<ASSIGN  20825<<ASSIGN  20829>>IF
     21646>>ASSIGN  22371>>ASSIGN
CMAP$
     14763**DCL      7556--IMP-PTR 14860<>CALL    16274>>ASSIGN  16275>>ASSIGN  16283>>ASSIGN  16293>>ASSIGN
     16297>>IF      16297>>IF      16298>>ASSIGN  16300>>ASSIGN  16301>>ASSIGN  16302>>ASSIGN  16303>>ASSIGN
     16601>>ASSIGN  16602>>ASSIGN  16609>>ASSIGN  16620>>ASSIGN  16624>>IF      16624>>IF      16625>>ASSIGN
     16627>>ASSIGN  16628>>ASSIGN  16629>>ASSIGN  16630>>ASSIGN  17938>>DOWHILE 17943>>IF      17945>>ASSIGN
     17946>>ASSIGN  18951>>DOWHILE 18956>>IF      18958>>ASSIGN  18959>>ASSIGN  19587>>ASSIGN  19588>>IF
     20097>>ASSIGN  20098>>IF      20807>>ASSIGN  20808>>ASSIGN  20815>>ASSIGN  20825>>ASSIGN  20829>>IF
     20829>>IF      20830>>ASSIGN  20832>>ASSIGN  20833>>ASSIGN  20834>>ASSIGN  20835>>ASSIGN  21037>>IF
     21038>>ASSIGN  21641>>DOWHILE 21646>>ASSIGN  21650>>ASSIGN  21651>>ASSIGN  21854>>DOWHILE 21859>>ASSIGN
     22371>>ASSIGN  22372>>IF      23203>>IF      23203>>IF
CPA_CTXT_TFR
     17933**LABEL   17947--EXIT
CPR_CTXT_TFR
     18946**LABEL   18960--EXIT
CP_CTXT_ABS
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:167  
     16278**LABEL   16284--EXIT
CP_CTXT_TFR
     16288**LABEL   16294--EXIT
CP_DFLT_ABS
     16604**LABEL   16611--EXIT
CP_DFLT_TFR
     16615**LABEL   16621--EXIT
CTXT.LEN
     13145**DCL     13146--IMP-SIZ 16066>>ASSIGN  16262>>ASSIGN  16280>>IF      16280>>IF      16280>>IF
     16280>>IF      16290>>IF      16290>>IF      16290>>IF      16290>>IF      16493>>ASSIGN  16591>>ASSIGN
     16606>>IF      16606>>IF      16606>>IF      16606>>IF      16617>>IF      16617>>IF      16617>>IF
     16617>>IF      17823>>ASSIGN  17935>>IF      17935>>IF      17935>>IF      17935>>IF      18836>>ASSIGN
     18948>>IF      18948>>IF      18948>>IF      18948>>IF      19575>>ASSIGN  19588>>IF      19588>>IF
     19588>>IF      19588>>IF      20085>>ASSIGN  20098>>IF      20098>>IF      20098>>IF      20098>>IF
     20599>>ASSIGN  20795>>ASSIGN  20812>>IF      20812>>IF      20812>>IF      20812>>IF      20822>>IF
     20822>>IF      20822>>IF      20822>>IF      21532>>ASSIGN  21647>>IF      21647>>IF      21647>>IF
     21647>>IF      22359>>ASSIGN  22372>>IF      22372>>IF      22372>>IF      22372>>IF      22991>>ASSIGN
     23321<<ASSIGN  23322>>ASSIGN
CTXT.TXT
     13146**DCL     16053--ASSIGN  16249--ASSIGN  16280>>IF      16280>>IF      16290>>IF      16290>>IF
     16480--ASSIGN  16578--ASSIGN  16606>>IF      16606>>IF      16617>>IF      16617>>IF      17810--ASSIGN
     17935>>IF      17935>>IF      18823--ASSIGN  18948>>IF      18948>>IF      19562--ASSIGN  19588>>IF
     19588>>IF      20072--ASSIGN  20098>>IF      20098>>IF      20586--ASSIGN  20782--ASSIGN  20812>>IF
     20812>>IF      20822>>IF      20822>>IF      21519--ASSIGN  21647>>IF      21647>>IF      22346--ASSIGN
     22372>>IF      22372>>IF      22978--ASSIGN  23322<<ASSIGN
CURRLEN
     14788**DCL     14796<<ASSIGN  14797<<ASSIGN  14798<<ASSIGN  14810<<ASSIGN  14816>>IF      14821<<ASSIGN
     14821>>ASSIGN  14834<<ASSIGN  14834>>ASSIGN  14844<<ASSIGN  14844>>ASSIGN  14845>>ASSIGN  14850<<ASSIGN
     14850>>ASSIGN  23357<<ASSIGN  23357>>ASSIGN  23366<<ASSIGN  23366>>ASSIGN
DATALVL
     14764**DCL     14859<<ASSIGN  14969<<ASSIGN  14978<<ASSIGN  16833<<ASSIGN  18151<<ASSIGN  19064<<ASSIGN
     19077<<ASSIGN  19086<<ASSIGN  19596<<ASSIGN  20106<<ASSIGN  21044<<ASSIGN  21861<<ASSIGN  21868<<ASSIGN
     22381<<ASSIGN  22695>>IF      22786>>ASSIGN  22891>>ASSIGN  22901>>DOWHILE 22902<<ASSIGN  22902>>ASSIGN
     22991>>ASSIGN  23090>>ASSIGN  23189>>ASSIGN  23211<<ASSIGN  23211>>ASSIGN
DEPTH
     14765**DCL     14804<<ASSIGN  14807<<ASSIGN  14807>>ASSIGN  14808>>IF      14810>>ASSIGN  14812>>ASSIGN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:168  
     14814>>ASSIGN  14816>>IF      14821>>ASSIGN  14821>>ASSIGN  14824>>ASSIGN  14826>>ASSIGN  14834>>ASSIGN
     14834>>ASSIGN  14839>>IF      14841>>ASSIGN  14844>>ASSIGN  14844>>ASSIGN  14845>>ASSIGN  14845>>ASSIGN
     14847>>ASSIGN  14848<<ASSIGN  14848>>ASSIGN  14849>>IF      14850>>ASSIGN  14850>>ASSIGN  23357>>ASSIGN
     23357>>ASSIGN  23366>>ASSIGN  23366>>ASSIGN
DSTBYTES
     14759**DCL     23315<<ASSIGN
DSTLEN
     14758**DCL     14759--IMP-SIZ 23255<<ASSIGN  23256>>IF      23267<<ASSIGN  23268>>IF      23282<<ASSIGN
     23284>>IF      23289>>ASSIGN  23305<<ASSIGN  23306>>IF      23308<<ASSIGN  23308>>ASSIGN  23312>>ASSIGN
     23315>>ASSIGN
ENDITEM
     14839**LABEL   14818--GOTO
GETLEN
     23353**PROC    14822--CALL
I
     14766**DCL     15779<<ASSIGN  15780>>ASSIGN  16272<<ASSIGN  16272>>ASSIGN  16273>>ASSIGN  16274>>ASSIGN
     16275>>ASSIGN  16283>>ASSIGN  16293>>ASSIGN  16297>>IF      16297>>IF      16298>>ASSIGN  16300>>ASSIGN
     16301>>ASSIGN  16302>>ASSIGN  16303>>ASSIGN  16303>>ASSIGN  16304>>ASSIGN  17537<<ASSIGN  17938>>DOWHILE
     17939<<ASSIGN  17939>>ASSIGN  17940>>IF      17943>>IF      17945>>ASSIGN  17946>>ASSIGN  18550<<ASSIGN
     18951>>DOWHILE 18952<<ASSIGN  18952>>ASSIGN  18953>>IF      18956>>IF      18958>>ASSIGN  18959>>ASSIGN
     19586<<DOINDEX 19587>>ASSIGN  19588>>IF      19591>>ASSIGN  20096<<DOINDEX 20097>>ASSIGN  20098>>IF
     20101>>ASSIGN  20313<<ASSIGN  20805<<ASSIGN  20805>>ASSIGN  20806>>ASSIGN  20807>>ASSIGN  20808>>ASSIGN
     20815>>ASSIGN  20825>>ASSIGN  20829>>IF      20829>>IF      20830>>ASSIGN  20832>>ASSIGN  20833>>ASSIGN
     20834>>ASSIGN  20835>>ASSIGN  20835>>ASSIGN  20836>>ASSIGN  21036<<DOINDEX 21037>>IF      21038>>ASSIGN
     21039>>ASSIGN  21246<<ASSIGN  21641>>DOWHILE 21642<<ASSIGN  21642>>ASSIGN  21643>>IF      21646>>ASSIGN
     21650>>ASSIGN  21651>>ASSIGN  21753<<ASSIGN  21854>>DOWHILE 21855<<ASSIGN  21855>>ASSIGN  21856>>IF
     21859>>ASSIGN  22370<<DOINDEX 22371>>ASSIGN  22372>>IF      22376>>ASSIGN  23202<<DOINDEX 23203>>IF
     23203>>IF      23205>>ASSIGN  23206>>ASSIGN  23272<<DOINDEX 23290<<DOINDEX 23365<<ASSIGN  23366>>ASSIGN
     23368>>DOWHILE 23371<<ASSIGN  23371>>ASSIGN
INITLEN
     14789**DCL     14793<<ASSIGN  14794<<ASSIGN  14795<<ASSIGN  14812<<ASSIGN  14814<<ASSIGN  14839>>IF
     14841>>ASSIGN  14845<<ASSIGN  14850>>ASSIGN  14851<<ASSIGN
ITEMCUR
     14767**DCL     14858<<ASSIGN  15781>>DOWHILE 16404>>DOWHILE 17538>>DOWHILE 18551>>DOWHILE 19290>>DOWHILE
     19800>>DOWHILE 20314>>DOWHILE 20935>>DOWHILE 21247>>DOWHILE 21754>>DOWHILE 22074>>DOWHILE 22695>>IF
     22697>>IF      22803>>IF      22901>>DOWHILE 23233>>IF      23237>>IF      23239>>IF      23241>>IF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:169  
     23254>>ASSIGN  23258>>ASSIGN  23266>>ASSIGN  23270>>ASSIGN  23278>>ASSIGN  23280>>ASSIGN  23304>>ASSIGN
     23311>>ASSIGN  23315>>ASSIGN  23319>>ASSIGN  23322>>ASSIGN  23341<<ASSIGN  23341>>ASSIGN
ITEMLIST
     14730**DCL     14791<<ASSIGN
ITEMLIST.P
     14747**DCL     14802<<ASSIGN  14827<<ASSIGN  14842>>ASSIGN  15240<<ASSIGN  15444<<ASSIGN  15570<<ASSIGN
     15669<<ASSIGN  15934<<ASSIGN  16053<<ASSIGN  16249<<ASSIGN  16480<<ASSIGN  16578<<ASSIGN  16694<<ASSIGN
     16794<<ASSIGN  17097<<ASSIGN  17301<<ASSIGN  17427<<ASSIGN  17691<<ASSIGN  17810<<ASSIGN  17888<<ASSIGN
     18012<<ASSIGN  18112<<ASSIGN  18314<<ASSIGN  18440<<ASSIGN  18704<<ASSIGN  18823<<ASSIGN  18901<<ASSIGN
     19019<<ASSIGN  19443<<ASSIGN  19562<<ASSIGN  19953<<ASSIGN  20072<<ASSIGN  20467<<ASSIGN  20586<<ASSIGN
     20782<<ASSIGN  20991<<ASSIGN  21400<<ASSIGN  21519<<ASSIGN  21597<<ASSIGN  21810<<ASSIGN  22227<<ASSIGN
     22346<<ASSIGN  22540<<ASSIGN  22640<<ASSIGN  22783<<ASSIGN  22978<<ASSIGN  23056<<ASSIGN  23186<<ASSIGN
     23258>>ASSIGN  23270>>ASSIGN  23278>>ASSIGN  23311>>ASSIGN  23315>>ASSIGN  23322>>ASSIGN
ITEMLIST.U
     14745**DCL     14746--REDEF   14747--REDEF   14748--REDEF
ITEMLIST.X.LEN
     14739**DCL     14842<<ASSIGN  23254>>ASSIGN  23266>>ASSIGN  23280>>ASSIGN  23304>>ASSIGN  23319>>ASSIGN
ITEMLIST.X.LVL
     14744**DCL     15781>>DOWHILE 16404>>DOWHILE 17538>>DOWHILE 18551>>DOWHILE 19290>>DOWHILE 19800>>DOWHILE
     20314>>DOWHILE 20935>>DOWHILE 21247>>DOWHILE 21754>>DOWHILE 22074>>DOWHILE 22901>>DOWHILE 23237>>IF
     23239>>IF
ITEMLIST.X.TAG
     14741**DCL     16846>>IF      18154>>IF      20114>>IF      21047>>IF      21876>>IF      22697>>IF
     22803>>IF      23241>>IF
ITEMLIST.Z
     14737**DCL     14738--REDEF   14801<<ASSIGN  14824<<ASSIGN  14826<<ASSIGN  14948<<ASSIGN  15078<<ASSIGN
     15175<<ASSIGN  15274<<ASSIGN  15373<<ASSIGN  15472<<ASSIGN  15573<<ASSIGN  15672<<ASSIGN  15769<<ASSIGN
     15869<<ASSIGN  15968<<ASSIGN  16066<<ASSIGN  16163<<ASSIGN  16262<<ASSIGN  16394<<ASSIGN  16493<<ASSIGN
     16591<<ASSIGN  16722<<ASSIGN  16822<<ASSIGN  16935<<ASSIGN  17032<<ASSIGN  17131<<ASSIGN  17230<<ASSIGN
     17329<<ASSIGN  17430<<ASSIGN  17527<<ASSIGN  17626<<ASSIGN  17725<<ASSIGN  17823<<ASSIGN  17922<<ASSIGN
     18040<<ASSIGN  18140<<ASSIGN  18243<<ASSIGN  18342<<ASSIGN  18443<<ASSIGN  18540<<ASSIGN  18639<<ASSIGN
     18738<<ASSIGN  18836<<ASSIGN  18935<<ASSIGN  19053<<ASSIGN  19183<<ASSIGN  19280<<ASSIGN  19378<<ASSIGN
     19477<<ASSIGN  19575<<ASSIGN  19693<<ASSIGN  19790<<ASSIGN  19888<<ASSIGN  19987<<ASSIGN  20085<<ASSIGN
     20206<<ASSIGN  20303<<ASSIGN  20402<<ASSIGN  20501<<ASSIGN  20599<<ASSIGN  20696<<ASSIGN  20795<<ASSIGN
     20925<<ASSIGN  21025<<ASSIGN  21139<<ASSIGN  21236<<ASSIGN  21335<<ASSIGN  21434<<ASSIGN  21532<<ASSIGN
     21631<<ASSIGN  21743<<ASSIGN  21844<<ASSIGN  21967<<ASSIGN  22064<<ASSIGN  22162<<ASSIGN  22261<<ASSIGN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:170  
     22359<<ASSIGN  22475<<ASSIGN  22574<<ASSIGN  22674<<ASSIGN  22786<<ASSIGN  22891<<ASSIGN  22991<<ASSIGN
     23090<<ASSIGN  23189<<ASSIGN
ITEMNUM
     14768**DCL     14803<<ASSIGN  14814>>ASSIGN  14824>>ASSIGN  14826>>ASSIGN  14827>>ASSIGN  14828<<ASSIGN
     14828>>ASSIGN  22695>>IF      23233>>IF
J
     14769**DCL     16278<<DOINDEX 16279>>ASSIGN  16283>>ASSIGN  16288<<DOINDEX 16289>>ASSIGN  16293>>ASSIGN
     16604<<DOINDEX 16605>>ASSIGN  16609>>ASSIGN  16610>>ASSIGN  16615<<DOINDEX 16616>>ASSIGN  16620>>ASSIGN
     17933<<DOINDEX 17934>>ASSIGN  17943>>IF      18946<<DOINDEX 18947>>ASSIGN  18956>>IF      20810<<DOINDEX
     20811>>ASSIGN  20815>>ASSIGN  20820<<DOINDEX 20821>>ASSIGN  20825>>ASSIGN
NEXTBYTE
     14816**LABEL   14805--GOTO    14836--GOTO    14852--GOTO
NEXTLEVEL
     14807**LABEL   14830--GOTO
PCTX.ACTDCSMASK
      9448**DCL      9451--REDEF
PCTX.CTXTMAPX
      9498**DCL     14860<>CALL
PCTX.CURDCSMASK
      9433**DCL      9436--REDEF
PCTX.DFLCTXTID
      9424**DCL     16306<<ASSIGN  16610<<ASSIGN  22798>>ASSIGN  22799>>ASSIGN
PCTX.HISTZ
      9491**DCL      9492--REDEF
PCTX.INIDCSMASK
      9441**DCL      9444--REDEF
PDU
     14772**DCL     14817>>IF      14819>>ASSIGN  23355>>ASSIGN  23369>>ASSIGN
PDU$
     14771**DCL     14772--IMP-PTR 14799<<ASSIGN  14802>>ASSIGN  14817>>IF      14819>>ASSIGN  14827>>ASSIGN
     14842>>ASSIGN  23355>>ASSIGN  23369>>ASSIGN
PDUIDX
     14773**DCL     14800<<ASSIGN  14817>>IF      14819>>ASSIGN  14820<<ASSIGN  14820>>ASSIGN  14827>>ASSIGN
     14833<<ASSIGN  14833>>ASSIGN  14835>>IF      14842>>ASSIGN  14843<<ASSIGN  14843>>ASSIGN  23355>>ASSIGN
     23356<<ASSIGN  23356>>ASSIGN  23369>>ASSIGN  23370<<ASSIGN  23370>>ASSIGN
PSAP.LEN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:171  
      9532**DCL      9533--IMP-SIZ
PSAP.TXT
      9533**DCL     15570--ASSIGN  15669--ASSIGN  17427--ASSIGN  18440--ASSIGN
PSAP$
     14774**DCL      9520--IMP-PTR 15484<<ASSIGN  15570>>ASSIGN  15583<<ASSIGN  15669>>ASSIGN  17341<<ASSIGN
     17427>>ASSIGN  18354<<ASSIGN  18440>>ASSIGN
RET IN PROCEDURE SCAN
     23341**LABEL   23330--GOTO
RSA_CTXT_TFR
     20096**LABEL   20102--EXIT
RS_CTXT_TFR
     19586**LABEL   19592--EXIT
SCAN
     23231**PROC    14955--CALL    15085--CALL    15182--CALL    15281--CALL    15380--CALL    15479--CALL
     15580--CALL    15679--CALL    15776--CALL    15876--CALL    15975--CALL    16073--CALL    16170--CALL
     16269--CALL    16401--CALL    16500--CALL    16598--CALL    16729--CALL    16829--CALL    16942--CALL
     17039--CALL    17138--CALL    17237--CALL    17336--CALL    17437--CALL    17534--CALL    17633--CALL
     17732--CALL    17830--CALL    17929--CALL    18047--CALL    18147--CALL    18250--CALL    18349--CALL
     18450--CALL    18547--CALL    18646--CALL    18745--CALL    18843--CALL    18942--CALL    19060--CALL
     19190--CALL    19287--CALL    19385--CALL    19484--CALL    19582--CALL    19700--CALL    19797--CALL
     19895--CALL    19994--CALL    20092--CALL    20213--CALL    20310--CALL    20409--CALL    20508--CALL
     20606--CALL    20703--CALL    20802--CALL    20932--CALL    21032--CALL    21146--CALL    21243--CALL
     21342--CALL    21441--CALL    21539--CALL    21638--CALL    21750--CALL    21851--CALL    21974--CALL
     22071--CALL    22169--CALL    22268--CALL    22366--CALL    22482--CALL    22581--CALL    22681--CALL
     22793--CALL    22898--CALL    22998--CALL    23097--CALL    23196--CALL
SCANERR
     23220**LABEL   14955--CALLALT 15085--CALLALT 15182--CALLALT 15281--CALLALT 15380--CALLALT 15479--CALLALT
     15580--CALLALT 15679--CALLALT 15776--CALLALT 15876--CALLALT 15975--CALLALT 16073--CALLALT 16170--CALLALT
     16269--CALLALT 16401--CALLALT 16500--CALLALT 16598--CALLALT 16729--CALLALT 16829--CALLALT 16942--CALLALT
     17039--CALLALT 17138--CALLALT 17237--CALLALT 17336--CALLALT 17437--CALLALT 17534--CALLALT 17633--CALLALT
     17732--CALLALT 17830--CALLALT 17929--CALLALT 17941--GOTO    17944--GOTO    18047--CALLALT 18147--CALLALT
     18250--CALLALT 18349--CALLALT 18450--CALLALT 18547--CALLALT 18646--CALLALT 18745--CALLALT 18843--CALLALT
     18942--CALLALT 18954--GOTO    18957--GOTO    19060--CALLALT 19067--GOTO    19190--CALLALT 19287--CALLALT
     19385--CALLALT 19484--CALLALT 19582--CALLALT 19700--CALLALT 19797--CALLALT 19895--CALLALT 19994--CALLALT
     20092--CALLALT 20213--CALLALT 20310--CALLALT 20409--CALLALT 20508--CALLALT 20606--CALLALT 20703--CALLALT
     20802--CALLALT 20932--CALLALT 21032--CALLALT 21146--CALLALT 21243--CALLALT 21342--CALLALT 21441--CALLALT
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:172  
     21539--CALLALT 21638--CALLALT 21644--GOTO    21654--GOTO    21750--CALLALT 21851--CALLALT 21857--GOTO
     21974--CALLALT 22071--CALLALT 22169--CALLALT 22268--CALLALT 22366--CALLALT 22482--CALLALT 22581--CALLALT
     22681--CALLALT 22693--GOTO    22793--CALLALT 22898--CALLALT 22998--CALLALT 23097--CALLALT 23196--CALLALT
     23215--GOTO
SCANITEM.P
     14722**DCL     22796>>ASSIGN  23199>>ASSIGN  23259>>ASSIGN  23271>>ASSIGN  23288>>ASSIGN  23309>>IF
     23311<<ASSIGN  23315>>ASSIGN  23320<<ASSIGN  23320>>ASSIGN  23321>>ASSIGN  23322>>ASSIGN  23322>>ASSIGN
SCANITEM.U
     14720**DCL     14721--REDEF   14722--REDEF   14723--REDEF
SCANITEM.X.LEN
     14714**DCL     22797>>ASSIGN  23200>>ASSIGN  23255>>ASSIGN  23267>>ASSIGN  23282>>ASSIGN  23305>>ASSIGN
     23312<<ASSIGN
SCANITEM.X.LVL
     14719**DCL     23237>>IF      23239>>IF
SCANITEM.X.OPT
     14715**DCL     23332>>IF
SCANITEM.X.TAG
     14716**DCL     23241>>IF
SCANITEM.X.TYP
     14718**DCL     23244>>DOCASE
SCANITEM.Z
     14712**DCL     14713--REDEF
SFNCCASE
     14959**LABEL   18152--EXIT    19065--EXIT    21045--EXIT    21862--EXIT    22382--EXIT
SFPT$
     14775**DCL        16--PROC     3243--IMP-PTR  3389--IMP-PTR  3487--IMP-PTR  3638--IMP-PTR  3736--IMP-PTR
      3962--IMP-PTR  4125--IMP-PTR  4271--IMP-PTR  4594--IMP-PTR  4718--IMP-PTR  4862--IMP-PTR  5006--IMP-PTR
      5092--IMP-PTR  5178--IMP-PTR  5330--IMP-PTR  5543--IMP-PTR  5702--IMP-PTR  5861--IMP-PTR  5991--IMP-PTR
      6183--IMP-PTR  6327--IMP-PTR  6471--IMP-PTR 14959>>DOCASE  16841>>ASSIGN  21865>>ASSIGN  21877>>ASSIGN
     22385>>ASSIGN
SRC$
     14752**DCL     23258<<ASSIGN  23260>>ASSIGN  23278<<ASSIGN  23279>>ASSIGN  23287>>ASSIGN
SRCBYTES
     14755**DCL     23260>>ASSIGN  23279>>ASSIGN  23315>>ASSIGN  23322>>ASSIGN
SRCLEN
     14754**DCL     14755--IMP-SIZ 23254<<ASSIGN  23256>>IF      23260>>ASSIGN  23266<<ASSIGN  23268>>IF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:173  
     23271>>ASSIGN  23272>>DOINDEX 23279>>ASSIGN  23280<<ASSIGN  23281<<ASSIGN  23281>>ASSIGN  23284>>IF
     23304<<ASSIGN  23306>>IF      23308>>ASSIGN  23315>>ASSIGN  23319<<ASSIGN  23321>>ASSIGN  23322>>ASSIGN
TAG
     14776**DCL     14777--REDEF   14819<<ASSIGN  14824>>ASSIGN  14826>>ASSIGN
TAGX.CONSTRUCTED
     14780**DCL     14829>>IF
TEMP
     14782**DCL     14792<<ASSIGN  14794>>ASSIGN  14795>>ASSIGN  14797>>ASSIGN  14798>>ASSIGN  14801>>ASSIGN
     14810>>ASSIGN  14811>>IF      14812>>ASSIGN  14823>>IF      14824>>ASSIGN  14831>>IF      14833>>ASSIGN
     14834>>ASSIGN  14841<<ASSIGN  14842>>ASSIGN  14842>>ASSIGN  14847<<ASSIGN  14850>>ASSIGN  14851>>ASSIGN
     17636<<ASSIGN  17691--ASSIGN  17945>>ASSIGN  18649<<ASSIGN  18704--ASSIGN  18958>>ASSIGN  21345<<ASSIGN
     21400--ASSIGN  21650>>ASSIGN  23260<<ASSIGN  23261>>IF      23279<<ASSIGN  23281>>ASSIGN  23289<<ASSIGN
     23290>>DOINDEX 23355<<ASSIGN  23358>>IF      23360<<ASSIGN  23363>>IF      23365>>ASSIGN  23367<<ASSIGN
     23369<<ASSIGN  23369>>ASSIGN
TFR$
     14751**DCL     14856<<ASSIGN  16249>>ASSIGN  16262>>ASSIGN  16290>>IF      16290>>IF      16290>>IF
     16578>>ASSIGN  16591>>ASSIGN  16617>>IF      16617>>IF      16617>>IF      17810>>ASSIGN  17823>>ASSIGN
     17935>>IF      17935>>IF      17935>>IF      18823>>ASSIGN  18836>>ASSIGN  18948>>IF      18948>>IF
     18948>>IF      19562>>ASSIGN  19575>>ASSIGN  19588>>IF      19588>>IF      19588>>IF      20072>>ASSIGN
     20085>>ASSIGN  20098>>IF      20098>>IF      20098>>IF      20782>>ASSIGN  20795>>ASSIGN  21519>>ASSIGN
     21532>>ASSIGN  21647>>IF      21647>>IF      21647>>IF      22346>>ASSIGN  22359>>ASSIGN  22372>>IF
     22372>>IF      22372>>IF      22978>>ASSIGN  22991>>ASSIGN
TFRNAME
     13210**DCL     14856--ASSIGN
TMP$
     14783**DCL     16279<<ASSIGN  16280>>IF      16280>>IF      16280>>IF      16280>>IF      16289<<ASSIGN
     16290>>IF      16290>>IF      16290>>IF      16290>>IF      16605<<ASSIGN  16606>>IF      16606>>IF
     16606>>IF      16606>>IF      16616<<ASSIGN  16617>>IF      16617>>IF      16617>>IF      16617>>IF
     17934<<ASSIGN  17935>>IF      17935>>IF      17935>>IF      17935>>IF      18947<<ASSIGN  18948>>IF
     18948>>IF      18948>>IF      18948>>IF      19587<<ASSIGN  19588>>IF      19588>>IF      19588>>IF
     20097<<ASSIGN  20098>>IF      20098>>IF      20098>>IF      20811<<ASSIGN  20812>>IF      20812>>IF
     20812>>IF      20812>>IF      20821<<ASSIGN  20822>>IF      20822>>IF      20822>>IF      20822>>IF
     21646<<ASSIGN  21647>>IF      21647>>IF      21647>>IF      21647>>IF      22371<<ASSIGN  22372>>IF
     22372>>IF      22372>>IF      22372>>IF
TWOZEROES.C
     14787**DCL     14817>>IF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:174  
TWOZEROES.X
     14786**DCL     14787--REDEF
UTMP
     14784**DCL     15185<<ASSIGN  15240--ASSIGN  15284>>IF      15879<<ASSIGN  15934--ASSIGN  16302>>ASSIGN
     17042<<ASSIGN  17097--ASSIGN  17141>>IF      17833<<ASSIGN  17888--ASSIGN  17946>>ASSIGN  18846<<ASSIGN
     18901--ASSIGN  18959>>ASSIGN  18964<<ASSIGN  19019--ASSIGN  19063>>ASSIGN  19388<<ASSIGN  19443--ASSIGN
     19588>>IF      19898<<ASSIGN  19953--ASSIGN  20098>>IF      20412<<ASSIGN  20467--ASSIGN  20834>>ASSIGN
     20936<<ASSIGN  20991--ASSIGN  21037>>IF      21542<<ASSIGN  21597--ASSIGN  21651>>ASSIGN  21755<<ASSIGN
     21810--ASSIGN  21859>>ASSIGN  22172<<ASSIGN  22227--ASSIGN  22372>>IF      22485<<ASSIGN  22540--ASSIGN
     22584>>ASSIGN  22585<<ASSIGN  22640--ASSIGN  23001<<ASSIGN  23056--ASSIGN  23203>>IF
VBLK
      9553**DCL        16--PROC
VBLK.CTX$
      9563**DCL      9362--IMP-PTR 14860>>CALL    16306>>ASSIGN  16610>>ASSIGN  22798>>ASSIGN  22799>>ASSIGN
VBLK.DATA.PTR$
      9639**DCL     14799>>ASSIGN
VBLK.DATA.SIZE
      9640**DCL     14792>>ASSIGN  14835>>IF      14948>>ASSIGN
VBLK.DATBITS
      9672**DCL     22799<<ASSIGN  23206<<ASSIGN
VBLK.DATMASK
      9669**DCL      9672--REDEF
VBLK.DEFBITS
      9656**DCL     16304<<ASSIGN  16631<<ASSIGN  19591<<ASSIGN  20101<<ASSIGN  20836<<ASSIGN  22376<<ASSIGN
VBLK.DEFMASK
      9653**DCL      9656--REDEF
VBLK.DELBITS
      9664**DCL     21039<<ASSIGN
VBLK.DELMASK
      9661**DCL      9664--REDEF
VBLK.EVENT
      9648**DCL     16847<<ASSIGN  18155<<ASSIGN  20118<<ASSIGN  21051<<ASSIGN  21867<<ASSIGN  21879<<ASSIGN
     22387<<ASSIGN
VBLK.FPT$
      9567**DCL      9700--IMP-PTR  9796--IMP-PTR  9854--IMP-PTR  9919--IMP-PTR  9977--IMP-PTR 10068--IMP-PTR
     10143--IMP-PTR 10204--IMP-PTR 10262--IMP-PTR 10407--IMP-PTR 10501--IMP-PTR 10559--IMP-PTR 10617--IMP-PTR
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:175  
     10675--IMP-PTR 10733--IMP-PTR 10792--IMP-PTR 10897--IMP-PTR 10963--IMP-PTR 11029--IMP-PTR 11125--IMP-PTR
     11222--IMP-PTR 11280--IMP-PTR 11338--IMP-PTR 14967>>ASSIGN  14968>>ASSIGN  14976>>ASSIGN  14977>>ASSIGN
     14986>>ASSIGN  14987>>ASSIGN  14988>>ASSIGN  14989>>ASSIGN  14990>>ASSIGN  15484>>ASSIGN  15583>>ASSIGN
     16630>>ASSIGN  16732>>ASSIGN  16832>>ASSIGN  16841>>ASSIGN  16842>>ASSIGN  16843>>ASSIGN  16844>>ASSIGN
     16845>>ASSIGN  17341>>ASSIGN  18050>>ASSIGN  18150>>ASSIGN  18354>>ASSIGN  19063>>ASSIGN  19075>>ASSIGN
     19076>>ASSIGN  19084>>ASSIGN  19085>>ASSIGN  19094>>ASSIGN  19095>>ASSIGN  19604>>ASSIGN  19605>>ASSIGN
     20115>>ASSIGN  20116>>ASSIGN  20117>>ASSIGN  21048>>ASSIGN  21049>>ASSIGN  21050>>ASSIGN  21865>>ASSIGN
     21866>>ASSIGN  21877>>ASSIGN  21878>>ASSIGN  22385>>ASSIGN  22386>>ASSIGN  22584>>ASSIGN
VBLK.SPIMASK
      9677**DCL      9680--REDEF
XSC$ADDRESS.NSAP.ADDRESS_N
     14667**DCL     14668--REDEF
XSC$ADDRESS.PSAP
     14443**DCL     15484--ASSIGN  15583--ASSIGN  17341--ASSIGN  18354--ASSIGN
XSP$ACTIVITY_DISCARD.ERRDEF
      9806**DCL      9826--REDEF
XSP$ACTIVITY_END.ERRDEF
      9868**DCL      9888--REDEF
XSP$ACTIVITY_INTERRUPT.ERRDEF
      9929**DCL      9949--REDEF
XSP$ACTIVITY_RESUME.ERRDEF
      9993**DCL     10013--REDEF
XSP$ACTIVITY_START.ERRDEF
     10083**DCL     10103--REDEF
XSP$ALTER_CONTEXT
     10143**DCL     20115<<ASSIGN  21048<<ASSIGN
XSP$ALTER_CONTEXT.CTXT$
     10185**DCL     20117<<ASSIGN  21050<<ASSIGN
XSP$ALTER_CONTEXT.ERRDEF
     10152**DCL     10172--REDEF
XSP$ALTER_CONTEXT.FNC
     10149**DCL     20116<<ASSIGN  21049<<ASSIGN
XSP$CAPABILITY_DATA
     10204**DCL     14967<<ASSIGN  14976<<ASSIGN
XSP$CAPABILITY_DATA.ERRDEF
     10213**DCL     10233--REDEF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:176  
XSP$CAPABILITY_DATA.FNC
     10210**DCL     14968<<ASSIGN  14977<<ASSIGN
XSP$CONNECT
     10262**DCL     14986<<ASSIGN  16841<<ASSIGN
XSP$CONNECT.CALLED$
     10357**DCL     10358--REDEF   14989<<ASSIGN  15583>>ASSIGN
XSP$CONNECT.CALLING$
     10351**DCL     14988<<ASSIGN  15484>>ASSIGN  16843<<ASSIGN
XSP$CONNECT.CTXT$
     10350**DCL     14990<<ASSIGN  16845<<ASSIGN
XSP$CONNECT.DFLT$
     10347**DCL     10348--REDEF
XSP$CONNECT.DFLTRSLT
     10348**DCL     16630<<ASSIGN
XSP$CONNECT.ERRDEF
     10316**DCL     10336--REDEF
XSP$CONNECT.FNC
     10276**DCL     14987<<ASSIGN  16842<<ASSIGN
XSP$CONNECT.PFU
     10386**DCL     16732<<ASSIGN  18050<<ASSIGN
XSP$CONNECT.REASON
     10278**DCL     19063<<ASSIGN
XSP$CONNECT.RESPONDING$
     10358**DCL     16844<<ASSIGN  17341>>ASSIGN  18354>>ASSIGN
XSP$CONNECT.SFU
     10368**DCL     16832<<ASSIGN  18150<<ASSIGN
XSP$CONTROL_GIVE.ERRDEF
     10453**DCL     10473--REDEF
XSP$DATA
     10501**DCL     19075<<ASSIGN
XSP$DATA.ERRDEF
     10510**DCL     10530--REDEF
XSP$DATA.FNC
     10507**DCL     19076<<ASSIGN
XSP$EXPEDITED_DATA
     10559**DCL     19084<<ASSIGN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:177  
XSP$EXPEDITED_DATA.ERRDEF
     10568**DCL     10588--REDEF
XSP$EXPEDITED_DATA.FNC
     10565**DCL     19085<<ASSIGN
XSP$GENERIC.ERRDEF
      9746**DCL      9766--REDEF
XSP$P_ABORT
     10617**DCL     22385<<ASSIGN
XSP$P_ABORT.ERRDEF
     10627**DCL     10647--REDEF
XSP$P_ABORT.FNC
     10623**DCL     22386<<ASSIGN
XSP$P_ABORT.REASON
     10625**DCL     22584<<ASSIGN
XSP$P_EXCEPTION_REPORT.ERRDEF
     10685**DCL     10705--REDEF
XSP$RELEASE.ERRDEF
     10743**DCL     10763--REDEF
XSP$RESYNCHRONIZE
     10792**DCL     19094<<ASSIGN  19604<<ASSIGN
XSP$RESYNCHRONIZE.ERRDEF
     10845**DCL     10865--REDEF
XSP$RESYNCHRONIZE.FNC
     10804**DCL     19095<<ASSIGN  19605<<ASSIGN
XSP$SYNC_MAJOR.ERRDEF
     10912**DCL     10932--REDEF
XSP$SYNC_MINOR.ERRDEF
     10978**DCL     10998--REDEF
XSP$TOKEN_GIVE.ERRDEF
     11077**DCL     11097--REDEF
XSP$TOKEN_PLEASE.ERRDEF
     11173**DCL     11193--REDEF
XSP$TYPED_DATA
     11222**DCL     21865<<ASSIGN
XSP$TYPED_DATA.ERRDEF
     11231**DCL     11251--REDEF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:178  
XSP$TYPED_DATA.FNC
     11228**DCL     21866<<ASSIGN
XSP$U_ABORT
     11280**DCL     21877<<ASSIGN
XSP$U_ABORT.ERRDEF
     11289**DCL     11309--REDEF
XSP$U_ABORT.FNC
     11286**DCL     21878<<ASSIGN
XSP$U_EXCEPTION_REPORT.ERRDEF
     11348**DCL     11368--REDEF
XSP_ABSLIST.COUNT
     14695**DCL     16278>>DOINDEX 16604>>DOINDEX 20810>>DOINDEX
XSP_ABSLIST.CTXT$
     14694**DCL     14695--REDEF   16279>>ASSIGN  16605>>ASSIGN  20811>>ASSIGN
XSP_ACTIVITY_DISCARD.ERRDEF
     11505**DCL     11525--REDEF
XSP_ACTIVITY_END.ERRDEF
     11567**DCL     11587--REDEF
XSP_ACTIVITY_INTERRUPT.ERRDEF
     11628**DCL     11648--REDEF
XSP_ACTIVITY_RESUME.ERRDEF
     11692**DCL     11712--REDEF
XSP_ACTIVITY_START.ERRDEF
     11782**DCL     11802--REDEF
XSP_ALTER_CONTEXT
     11842**DCL     20115>>ASSIGN  21048>>ASSIGN
XSP_ALTER_CONTEXT.ERRDEF
     11851**DCL     11871--REDEF
XSP_CAPABILITY_DATA
     11903**DCL     14967>>ASSIGN  14976>>ASSIGN
XSP_CAPABILITY_DATA.ERRDEF
     11912**DCL     11932--REDEF
XSP_CONNECT
     11961**DCL     14986>>ASSIGN
XSP_CONNECT.CALLED$
     12056**DCL     12057--REDEF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:179  
XSP_CONNECT.DFLT$
     12046**DCL     12047--REDEF
XSP_CONNECT.ERRDEF
     12015**DCL     12035--REDEF
XSP_CONTROL_GIVE.ERRDEF
     12152**DCL     12172--REDEF
XSP_DATA
     12200**DCL     19075>>ASSIGN
XSP_DATA.ERRDEF
     12209**DCL     12229--REDEF
XSP_DATABUF$
     14685**DCL     22796<<ASSIGN  23199<<ASSIGN
XSP_DATACTXT
     14686**DCL     22798<<ASSIGN  23201<<ASSIGN  23205<<ASSIGN
XSP_DATANUM
     14684**DCL     22696<<ASSIGN  22796>>ASSIGN  22797>>ASSIGN  22798>>ASSIGN  22800<<ASSIGN  22800>>ASSIGN
     23199>>ASSIGN  23200>>ASSIGN  23201>>ASSIGN  23205>>ASSIGN  23210<<ASSIGN  23210>>ASSIGN
XSP_DATASIZE
     14687**DCL     22797<<ASSIGN  23200<<ASSIGN
XSP_DSTADDR$
     14690**DCL     14989>>ASSIGN  16844>>ASSIGN
XSP_EXPEDITED_DATA
     12258**DCL     19084>>ASSIGN
XSP_EXPEDITED_DATA.ERRDEF
     12267**DCL     12287--REDEF
XSP_GENERIC.ERRDEF
     11445**DCL     11465--REDEF
XSP_ITEMCNT
     14688**DCL     14857<<ASSIGN  14948>>ASSIGN  15078>>ASSIGN  15175>>ASSIGN  15240>>ASSIGN  15274>>ASSIGN
     15373>>ASSIGN  15444>>ASSIGN  15472>>ASSIGN  15570>>ASSIGN  15573>>ASSIGN  15669>>ASSIGN  15672>>ASSIGN
     15769>>ASSIGN  15869>>ASSIGN  15934>>ASSIGN  15968>>ASSIGN  16053>>ASSIGN  16066>>ASSIGN  16163>>ASSIGN
     16249>>ASSIGN  16262>>ASSIGN  16394>>ASSIGN  16480>>ASSIGN  16493>>ASSIGN  16578>>ASSIGN  16591>>ASSIGN
     16694>>ASSIGN  16722>>ASSIGN  16794>>ASSIGN  16822>>ASSIGN  16935>>ASSIGN  17032>>ASSIGN  17097>>ASSIGN
     17131>>ASSIGN  17230>>ASSIGN  17301>>ASSIGN  17329>>ASSIGN  17427>>ASSIGN  17430>>ASSIGN  17527>>ASSIGN
     17626>>ASSIGN  17691>>ASSIGN  17725>>ASSIGN  17810>>ASSIGN  17823>>ASSIGN  17888>>ASSIGN  17922>>ASSIGN
     18012>>ASSIGN  18040>>ASSIGN  18112>>ASSIGN  18140>>ASSIGN  18243>>ASSIGN  18314>>ASSIGN  18342>>ASSIGN
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:180  
     18440>>ASSIGN  18443>>ASSIGN  18540>>ASSIGN  18639>>ASSIGN  18704>>ASSIGN  18738>>ASSIGN  18823>>ASSIGN
     18836>>ASSIGN  18901>>ASSIGN  18935>>ASSIGN  19019>>ASSIGN  19053>>ASSIGN  19183>>ASSIGN  19280>>ASSIGN
     19378>>ASSIGN  19443>>ASSIGN  19477>>ASSIGN  19562>>ASSIGN  19575>>ASSIGN  19693>>ASSIGN  19790>>ASSIGN
     19888>>ASSIGN  19953>>ASSIGN  19987>>ASSIGN  20072>>ASSIGN  20085>>ASSIGN  20206>>ASSIGN  20303>>ASSIGN
     20402>>ASSIGN  20467>>ASSIGN  20501>>ASSIGN  20586>>ASSIGN  20599>>ASSIGN  20696>>ASSIGN  20782>>ASSIGN
     20795>>ASSIGN  20925>>ASSIGN  20991>>ASSIGN  21025>>ASSIGN  21139>>ASSIGN  21236>>ASSIGN  21335>>ASSIGN
     21400>>ASSIGN  21434>>ASSIGN  21519>>ASSIGN  21532>>ASSIGN  21597>>ASSIGN  21631>>ASSIGN  21743>>ASSIGN
     21810>>ASSIGN  21844>>ASSIGN  21967>>ASSIGN  22064>>ASSIGN  22162>>ASSIGN  22227>>ASSIGN  22261>>ASSIGN
     22346>>ASSIGN  22359>>ASSIGN  22475>>ASSIGN  22540>>ASSIGN  22574>>ASSIGN  22640>>ASSIGN  22674>>ASSIGN
     22783>>ASSIGN  22786>>ASSIGN  22891>>ASSIGN  22978>>ASSIGN  22991>>ASSIGN  23056>>ASSIGN  23090>>ASSIGN
     23186>>ASSIGN  23189>>ASSIGN
XSP_P_ABORT.ERRDEF
     12326**DCL     12346--REDEF
XSP_P_EXCEPTION_REPORT.ERRDEF
     12384**DCL     12404--REDEF
XSP_RELEASE.ERRDEF
     12442**DCL     12462--REDEF
XSP_RESYNCHRONIZE
     12491**DCL     19094>>ASSIGN  19604>>ASSIGN
XSP_RESYNCHRONIZE.ERRDEF
     12544**DCL     12564--REDEF
XSP_SRCADDR$
     14691**DCL     14988>>ASSIGN  16843>>ASSIGN
XSP_SYNC_MAJOR.ERRDEF
     12611**DCL     12631--REDEF
XSP_SYNC_MINOR.ERRDEF
     12677**DCL     12697--REDEF
XSP_TFRLIST.COUNT
     14698**DCL     16288>>DOINDEX 16615>>DOINDEX 17933>>DOINDEX 18946>>DOINDEX 20820>>DOINDEX
XSP_TFRLIST.CTXT$
     14697**DCL     14698--REDEF   16289>>ASSIGN  16616>>ASSIGN  17934>>ASSIGN  18947>>ASSIGN  19587>>ASSIGN
     20097>>ASSIGN  20821>>ASSIGN  21646>>ASSIGN  22371>>ASSIGN
XSP_TMPCTXT$
     14692**DCL     13097--IMP-PTR 14990>>ASSIGN  15780>>ASSIGN  16273>>ASSIGN  16303>>ASSIGN  16845>>ASSIGN
     20117>>ASSIGN  20806>>ASSIGN  20835>>ASSIGN  21050>>ASSIGN
XSP_TOKEN_GIVE.ERRDEF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:181  
     12776**DCL     12796--REDEF
XSP_TOKEN_PLEASE.ERRDEF
     12872**DCL     12892--REDEF
XSP_TYPED_DATA.ERRDEF
     12930**DCL     12950--REDEF
XSP_U_ABORT.ERRDEF
     12988**DCL     13008--REDEF
XSP_U_EXCEPTION_REPORT.ERRDEF
     13047**DCL     13067--REDEF
XSS$ACTIVITY_DISCARD.ERRDEF
      3433**DCL      3459--REDEF
XSS$ACTIVITY_END.ERRDEF
      3523**DCL      3543--REDEF
XSS$ACTIVITY_INTERRUPT.ERRDEF
      3688**DCL      3708--REDEF
XSS$ACTIVITY_RESUME.ERRDEF
      3775**DCL      3795--REDEF
XSS$ACTIVITY_START.ERRDEF
      3996**DCL      4016--REDEF
XSS$BUFPTR
     14682**DCL-ENT 14860--CALL
XSS$CAPABILITY_DATA.ERRDEF
      4161**DCL      4181--REDEF
XSS$CONNECT
      4271**DCL     16841>>ASSIGN
XSS$CONNECT.CALLED$
      4497**DCL      4498--REDEF
XSS$CONNECT.ERRDEF
      4365**DCL      4385--REDEF
XSS$CONTROL_GIVE.ERRDEF
      4670**DCL      4690--REDEF
XSS$DATA.ERRDEF
      4752**DCL      4772--REDEF
XSS$EXPEDITED_DATA.ERRDEF
      4896**DCL      4916--REDEF
XSS$GENERIC.ERRDEF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:182  
      3297**DCL      3317--REDEF
XSS$GENERIC.FNC
      3257**DCL     14959>>DOCASE
XSS$P_ABORT
      5006**DCL     22385>>ASSIGN
XSS$P_ABORT.ERRDEF
      5044**DCL      5064--REDEF
XSS$P_EXCEPTION_REPORT.ERRDEF
      5130**DCL      5150--REDEF
XSS$RELEASE.ERRDEF
      5220**DCL      5240--REDEF
XSS$RESYNCHRONIZE.ERRDEF
      5428**DCL      5448--REDEF
XSS$SYNC_MAJOR.ERRDEF
      5587**DCL      5607--REDEF
XSS$SYNC_MINOR.ERRDEF
      5746**DCL      5766--REDEF
XSS$TOKEN_GIVE.ERRDEF
      5943**DCL      5963--REDEF
XSS$TOKEN_PLEASE.ERRDEF
      6073**DCL      6093--REDEF
XSS$TYPED_DATA
      6183**DCL     21865>>ASSIGN
XSS$TYPED_DATA.ERRDEF
      6217**DCL      6237--REDEF
XSS$U_ABORT
      6327**DCL     21877>>ASSIGN
XSS$U_ABORT.ERRDEF
      6361**DCL      6381--REDEF
XSS$U_EXCEPTION_REPORT.ERRDEF
      6510**DCL      6530--REDEF
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:183  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSP$DECODE File=XSP$DECODE.:XSA1TSI                           WED 10/01/97 12:00 Page:184  
              MINI UREF LISTING

DST$   14756**DCL
LEN   14770**DCL
XSP$DECODE      16**PROC
XSP_ITEMMAX   14689**DCL

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:185  
      922        1        /*T***********************************************************/
      923        2        /*T*                                                         */
      924        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      925        4        /*T*                                                         */
      926        5        /*T***********************************************************/
      927        6        /*F*    NAME:   XSP$SRECV
      928        7                DESCRIPTION:
      929        8                    This is the interface routine for messages traveling up the
      930        9                    comm layers from Session to Presentation.
      931       10
      932       11                    If this is a connection attempt, we allocate a new connection
      933       12                    context.  In any case we initialize a VBLK, decode the PPDU and
      934       13                    any enclosed User Data, and enter the state machine.
      935       14        */
      936       15        XSP$SRECV: PROC( SFPT) ALTRET;
      937       16        %INCLUDE XSS_SESSION_E;
      938      581        %INCLUDE XSS_SESSION_M;
      939     3224            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
      940     6603            %XSS$GENERIC( FPTN=SFPT, STCLASS="");
      941     6749        %INCLUDE XSP_PRESENTATION_E;
      942     6848        %INCLUDE XSP_PRESENTATION_M;
      943     8334            %XSP$GENERIC( FPTN=PFPT, STCLASS=AUTO);
      944     8430            %XSP$PRIMITIVES( STCLASS="BASED( PFPT$)");
      945    10129            %XSP_PRIMITIVES( STCLASS=SYMREF);
      946    11828        %INCLUDE XSP_INTERNAL_E;
      947    12102        %INCLUDE XSP_INTERNAL_M;
      948    12763            %XSP$PCTX( NAME=PCTX, STCLASS="BASED( CTX$)");
      949    12919            %XSP$VBLK( NAME=VBLK, STCLASS=AUTO);
      950    13065            %XSP$VBLK( NAME=XSP_VBLK, STCLASS=SYMREF);
      951    13211        %INCLUDE K_ADDRESS_M;
      952    13714        %INCLUDE XSC_COMMON_M;
      953    14367            %XSC$ADDRESS( NAME=SRCADDR, STCLASS=AUTO);
      954    14650            %XSC$ADDRESS( NAME=DSTADDR, STCLASS=AUTO);
      955    14933            %XSC$CCB;
      956    15230        %INCLUDE XSP_ASN1_M;
      957    15576            %XSP_ASN1_FPT( STCLASS=CONSTANT);
      958    15596            %XSP_ASN1_FPT( FPTN=AFPT, STCLASS="BASED( AFPT$)");
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:186  
      959    15616        %INCLUDE UM_CP6;
      960    16468        %MACRO FATALDEF( NAME=XSP_FATAL, STCLASS="CONSTANT SYMDEF", LVL=1, LAST=";",
      961    16469                         ERR#=0, SEV=7);
      962    16470            %VLP_ERRCODE( FPTN=NAME, STCLASS=STCLASS, FCG='XS', MID='P',
      963    16471                          MON='0'B, ERR#=ERR#, SEV=SEV);
      964    16472        %MEND;
      965    16473        %INCLUDE XSC_PERR_C;
      966    16550            %FATALDEF( NAME=XSP_F$NOSCID, ERR#=%F$NOSCID);
      967    16598            /*E*  ERROR:  XSP-F$NOSCID-7
      968    16599                MESSAGE:  Session didn't supply a SCID.
      969    16600            */
      970    16601
      971    16602    1       DCL XSP$CTXPTR ENTRY(2) ALTRET;
      972    16603    1       DCL XSP$DECODE ENTRY(2) ALTRET;
      973    16604    1       DCL XSP$GETCTX ENTRY(2) ALTRET;
      974    16605    1       DCL XSP$MACHINE ENTRY(1) ALTRET;
      975    16606    1       DCL XSS$GETMEM ENTRY(3) ALTRET;
      976    16607    1       DCL XSS$RELMEM ENTRY(1) ALTRET;
      977    16608    1       DCL XSS$SCREECH ENTRY(1);
      978    16609
      979    16610    1       DCL XSS_CCB$$ PTR SYMREF;
      980    16611
      981    16612    1       DCL ABORTING BIT(1);
      982    16613    1       DCL AFPT$ PTR;
      983    16614    1       DCL BLKX UBIN HALF HALIGNED;
      984    16615    1       DCL CCB$(0:0) PTR BASED( XSS_CCB$$) ALIGNED;
      985    16616    1       DCL CTX$ PTR;
      986    16617    1       DCL I SBIN;
      987    16618    1       DCL PCID SBIN;
      988    16619    1       DCL PFPT$ PTR;
      989    16620    1       DCL SFPT$ PTR;
      990    16621    1       DCL TMPCTXT(0:%XSP_MAX_DATANUM) SBIN AUTO;
      991    16622    1       DCL XSP_DATANUM SBIN STATIC SYMDEF;
      992    16623    1       DCL XSP_DATABUF$(0:%XSP_MAX_DATANUM) PTR STATIC SYMDEF;
      993    16624    1       DCL XSP_DATACTXT(0:%XSP_MAX_DATANUM) UBIN BYTE STATIC SYMDEF CALIGNED;
      994    16625    1       DCL XSP_DATASIZE(0:%XSP_MAX_DATANUM) SBIN STATIC SYMDEF;
      995    16626    1       DCL XSP_DSTADDR$ PTR STATIC SYMDEF;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:187  
      996    16627    1       DCL XSP_SRCADDR$ PTR STATIC SYMDEF;
      997    16628    1       DCL XSP_TMPCTXT$ PTR STATIC SYMDEF;
      998    16629
      999    16630    1       SFPT$ = ADDR( SFPT);
     1000    16631    2       IF XSS$GENERIC.SCID ~= 0 THEN DO;
     1001    16632    2           PCID = XSS$GENERIC.SCID;
     1002    16633    2           CALL XSP$CTXPTR( PCID, CTX$)
     1003    16634    3           WHENALTRETURN DO;
     1004    16635                    /* This appears to be an incoming connection attempt */
     1005    16636    3               CALL XSP$GETCTX( CTX$, PCID)
     1006    16637    4               WHENALTRETURN DO;
     1007    16638    4                   ALTRETURN;  /* reject connect attempt */
     1008    16639    4                   END;
     1009    16640    3               PCTX.ENTRY$ = CCB$( PCID)->XSC$CCB.PRES$;  /* inherit entry */
     1010    16641    3               END;
     1011    16642    2           END;
     1012    16643    1       ELSE
     1013    16644                /* SCID not filled in.  Session blew it. */
     1014    16645    1           CALL XSS$SCREECH( XSP_F$NOSCID);
     1015    16646    1       PFPT$ = ADDR( PFPT);
     1016    16647    1       VBLK = XSP_VBLK;
     1017    16648    1       VBLK.CTX$ = CTX$;
     1018    16649    1       VBLK.FPT$ = PFPT$;
     1019    16650    1       VBLK.DATA = XSS$GENERIC.DATA;
     1020    16651    1       XSP_DATANUM = 0;
     1021    16652            /* set up the corresponding event and Presentation FPT */
     1022    16653    2       DO CASE( XSS$GENERIC.FNC);
     1023    16654    2           CASE( %XSS_FNC_SACDIND#);
     1024    16655    2               XSP$ACTIVITY_DISCARD = XSP_ACTIVITY_DISCARD;
     1025    16656    2               XSP$ACTIVITY_DISCARD.FNC = %XSP_FNC_PACDIND#;
     1026    16657    2               XSP$ACTIVITY_DISCARD.REASON = XSS$ACTIVITY_DISCARD.REASON;
     1027    16658    2               VBLK.EVENT = %XSP_PEV_SACDIND;
     1028    16659    2           CASE( %XSS_FNC_SACDCNF#);
     1029    16660    2               XSP$ACTIVITY_DISCARD = XSP_ACTIVITY_DISCARD;
     1030    16661    2               XSP$ACTIVITY_DISCARD.FNC = %XSP_FNC_PACDCNF#;
     1031    16662    2               XSP$ACTIVITY_DISCARD.REASON = XSS$ACTIVITY_DISCARD.REASON;
     1032    16663    2               VBLK.EVENT = %XSP_PEV_SACDCNF;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:188  
     1033    16664    2           CASE( %XSS_FNC_SACEIND#);
     1034    16665    2               XSP$ACTIVITY_END = XSP_ACTIVITY_END;
     1035    16666    2               XSP$ACTIVITY_END.FNC = %XSP_FNC_PACEIND#;
     1036    16667    2               XSP$ACTIVITY_END.DATA$ = XSS$ACTIVITY_END.DATA.PTR$;  /*N*/
     1037    16668    2               XSP$ACTIVITY_END.SERNUM = XSS$ACTIVITY_END.SERNUM;
     1038    16669    2               VBLK.EVENT = %XSP_PEV_SACEIND;
     1039    16670    2           CASE( %XSS_FNC_SACECNF#);
     1040    16671    2               XSP$ACTIVITY_END = XSP_ACTIVITY_END;
     1041    16672    2               XSP$ACTIVITY_END.FNC = %XSP_FNC_PACECNF#;
     1042    16673    2               XSP$ACTIVITY_END.DATA$ = XSS$ACTIVITY_END.DATA.PTR$;  /*N*/
     1043    16674    2               XSP$ACTIVITY_END.SERNUM = XSS$ACTIVITY_END.SERNUM;
     1044    16675    2               VBLK.EVENT = %XSP_PEV_SACECNF;
     1045    16676    2           CASE( %XSS_FNC_SACIIND#);
     1046    16677    2               XSP$ACTIVITY_INTERRUPT = XSP_ACTIVITY_INTERRUPT;
     1047    16678    2               XSP$ACTIVITY_INTERRUPT.FNC = %XSP_FNC_PACIIND#;
     1048    16679    2               XSP$ACTIVITY_INTERRUPT.REASON = XSS$ACTIVITY_INTERRUPT.REASON;
     1049    16680    2               VBLK.EVENT = %XSP_PEV_SACIIND;
     1050    16681    2           CASE( %XSS_FNC_SACICNF#);
     1051    16682    2               XSP$ACTIVITY_INTERRUPT = XSP_ACTIVITY_INTERRUPT;
     1052    16683    2               XSP$ACTIVITY_INTERRUPT.FNC = %XSP_FNC_PACICNF#;
     1053    16684    2               XSP$ACTIVITY_INTERRUPT.REASON = XSS$ACTIVITY_INTERRUPT.REASON;
     1054    16685    2               VBLK.EVENT = %XSP_PEV_SACICNF;
     1055    16686    2           CASE( %XSS_FNC_SACRIND#);
     1056    16687    2               XSP$ACTIVITY_RESUME = XSP_ACTIVITY_RESUME;
     1057    16688    2               XSP$ACTIVITY_RESUME.FNC = %XSP_FNC_PACRIND#;
     1058    16689    2               XSP$ACTIVITY_RESUME.DATA$ = XSS$ACTIVITY_RESUME.DATA.PTR$;  /*N*/
     1059    16690    2               XSP$ACTIVITY_RESUME.SERNUM = XSS$ACTIVITY_RESUME.SERNUM;
     1060    16691    2               XSP$ACTIVITY_RESUME.ACTID = XSS$ACTIVITY_RESUME.ACTID;
     1061    16692    2               XSP$ACTIVITY_RESUME.OACTID = XSS$ACTIVITY_RESUME.OACTID;
     1062    16693    2               VBLK.EVENT = %XSP_PEV_SACRIND;
     1063    16694    2           CASE( %XSS_FNC_SACSIND#);
     1064    16695    2               XSP$ACTIVITY_START = XSP_ACTIVITY_START;
     1065    16696    2               XSP$ACTIVITY_START.FNC = %XSP_FNC_PACSIND#;
     1066    16697    2               XSP$ACTIVITY_START.DATA$ = XSS$ACTIVITY_START.DATA.PTR$;  /*N*/
     1067    16698    2               XSP$ACTIVITY_START.ACTID = XSS$ACTIVITY_START.ACTID;
     1068    16699    2               VBLK.EVENT = %XSP_PEV_SACSIND;
     1069    16700    2           CASE( %XSS_FNC_SCADIND#);
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:189  
     1070    16701                    /* should be a TC PPDU from Presentation-peer */
     1071    16702    2               CALL XSP$DECODE( VBLK, SFPT$)
     1072    16703    3               WHENALTRETURN DO;
     1073    16704    3                   VBLK.PPDUERR = 1;
     1074    16705    3                   END;
     1075    16706    2               VBLK.EVENT = %XSP_PEV_TC;
     1076    16707    2           CASE( %XSS_FNC_SCADCNF#);
     1077    16708                    /* should be a TCC PPDU from Presentation-peer */
     1078    16709    2               CALL XSP$DECODE( VBLK, SFPT$)
     1079    16710    3               WHENALTRETURN DO;
     1080    16711    3                   VBLK.PPDUERR = 1;
     1081    16712    3                   END;
     1082    16713    2               VBLK.EVENT = %XSP_PEV_TCC;
     1083    16714    2           CASE( %XSS_FNC_SCONIND#);
     1084    16715                    /* should be a CP PPDU from Presentation-peer */
     1085    16716    2               XSP_SRCADDR$ = ADDR( SRCADDR);
     1086    16717    2               XSP_DSTADDR$ = ADDR( DSTADDR);
     1087    16718    2               XSP_TMPCTXT$ = ADDR( TMPCTXT);
     1088    16719    2               TMPCTXT(0) = 0;
     1089    16720    2               CALL XSP$DECODE( VBLK, SFPT$)
     1090    16721    3               WHENALTRETURN DO;
     1091    16722    3                   VBLK.PPDUERR = 1;
     1092    16723    3                   END;
     1093    16724    2               VBLK.EVENT = %XSP_PEV_CP;
     1094    16725    2           CASE( %XSS_FNC_SCONCNF#);
     1095    16726                    /* should be a CPA or CPR PPDU from Presentation-peer */
     1096    16727    2               XSP_SRCADDR$ = ADDR( SRCADDR);
     1097    16728    2               XSP_DSTADDR$ = ADDR( DSTADDR);
     1098    16729    2               XSP_TMPCTXT$ = ADDR( TMPCTXT);
     1099    16730    2               TMPCTXT(0) = 0;
     1100    16731    2               CALL XSP$DECODE( VBLK, SFPT$)
     1101    16732    3               WHENALTRETURN DO;
     1102    16733    3                   VBLK.PPDUERR = 1;
     1103    16734    3                   END;
     1104    16735                    /* VBLK.EVENT filled in by XSP$DECODE */
     1105    16736    2           CASE( %XSS_FNC_SCTGIND#);
     1106    16737    2               XSP$CONTROL_GIVE = XSP_CONTROL_GIVE;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:190  
     1107    16738    2               XSP$CONTROL_GIVE.FNC = %XSP_FNC_PCTGIND#;
     1108    16739    2               VBLK.EVENT = %XSP_PEV_SCTGIND;
     1109    16740    2           CASE( %XSS_FNC_SDATIND#);
     1110    16741                    /* should be a TD PPDU from Presentation-peer */
     1111    16742    2               CALL XSP$DECODE( VBLK, SFPT$)
     1112    16743    3               WHENALTRETURN DO;
     1113    16744    3                   VBLK.PPDUERR = 1;
     1114    16745    3                   END;
     1115    16746    2               VBLK.EVENT = %XSP_PEV_TD;
     1116    16747    2           CASE( %XSS_FNC_SEXPIND#);
     1117    16748                    /* should be a TE PPDU from Presentation-peer */
     1118    16749    2               CALL XSP$DECODE( VBLK, SFPT$)
     1119    16750    3               WHENALTRETURN DO;
     1120    16751    3                   VBLK.PPDUERR = 1;
     1121    16752    3                   END;
     1122    16753    2               VBLK.EVENT = %XSP_PEV_TE;
     1123    16754    2           CASE( %XSS_FNC_SPABIND#);
     1124    16755                    /* Session-provider abort */
     1125    16756    2               XSP$P_ABORT = XSP_P_ABORT;
     1126    16757    2               XSP$P_ABORT.FNC = %XSP_FNC_PPABIND#;
     1127    16758    2               XSP$P_ABORT.REASON = XSS$P_ABORT.REASON;
     1128    16759    2               VBLK.EVENT = %XSP_PEV_SPABIND;
     1129    16760    2           CASE( %XSS_FNC_SPERIND#);
     1130    16761                    /* Session-provider exception report */
     1131    16762    2               XSP$P_EXCEPTION_REPORT = XSP_P_EXCEPTION_REPORT;
     1132    16763    2               XSP$P_EXCEPTION_REPORT.FNC = %XSP_FNC_PPERIND#;
     1133    16764    2               XSP$P_EXCEPTION_REPORT.REASON = XSS$P_EXCEPTION_REPORT.REASON;
     1134    16765    2               VBLK.EVENT = %XSP_PEV_SPERIND;
     1135    16766    2           CASE( %XSS_FNC_SRELIND#);
     1136    16767    2               XSP$RELEASE = XSP_RELEASE;
     1137    16768    2               XSP$RELEASE.FNC = %XSP_FNC_PRELIND#;
     1138    16769    2               XSP$RELEASE.DATA$ = XSS$RELEASE.DATA.PTR$;  /*N*/
     1139    16770    2               VBLK.EVENT = %XSP_PEV_SRELIND;
     1140    16771    2           CASE( %XSS_FNC_SRELCNF#);
     1141    16772    2               XSP$RELEASE = XSP_RELEASE;
     1142    16773    2               XSP$RELEASE.FNC = %XSP_FNC_PRELCNF#;
     1143    16774    2               XSP$RELEASE.RESULT = XSS$RELEASE.RESULT;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:191  
     1144    16775    2               XSP$RELEASE.DATA$ = XSS$RELEASE.DATA.PTR$;  /*N*/
     1145    16776    2               IF XSS$RELEASE.RESULT = 0 THEN
     1146    16777                        /* release accepted */
     1147    16778    2                   VBLK.EVENT = %XSP_PEV_SRELCFP;
     1148    16779    2               ELSE
     1149    16780                        /* release rejected by Session-peer or Presentation-peer */
     1150    16781    2                   VBLK.EVENT = %XSP_PEV_SRELCFN;
     1151    16782    2           CASE( %XSS_FNC_SRSXIND#);
     1152    16783                    /* should be an RS PPDU from Presentation-peer */
     1153    16784    2               CALL XSP$DECODE( VBLK, SFPT$)
     1154    16785    3               WHENALTRETURN DO;
     1155    16786    3                   VBLK.PPDUERR = 1;
     1156    16787    3                   END;
     1157    16788    2               VBLK.EVENT = %XSP_PEV_RS;
     1158    16789    2           CASE( %XSS_FNC_SRSXCNF#);
     1159    16790                    /* should be an RSA PPDU from Presentation-peer */
     1160    16791    2               CALL XSP$DECODE( VBLK, SFPT$)
     1161    16792    3               WHENALTRETURN DO;
     1162    16793    3                   VBLK.PPDUERR = 1;
     1163    16794    3                   END;
     1164    16795    2               VBLK.EVENT = %XSP_PEV_RSA;
     1165    16796    2           CASE( %XSS_FNC_SSMAIND#);
     1166    16797    2               XSP$SYNC_MAJOR = XSP_SYNC_MAJOR;
     1167    16798    2               XSP$SYNC_MAJOR.FNC = %XSP_FNC_PSMAIND#;
     1168    16799    2               XSP$SYNC_MAJOR.DATA$ = XSS$SYNC_MAJOR.DATA.PTR$;  /*N*/
     1169    16800    2               XSP$SYNC_MAJOR.SERNUM = XSS$SYNC_MAJOR.SERNUM;
     1170    16801    2               VBLK.EVENT = %XSP_PEV_SSMAIND;
     1171    16802    2           CASE( %XSS_FNC_SSMACNF#);
     1172    16803    2               XSP$SYNC_MAJOR = XSP_SYNC_MAJOR;
     1173    16804    2               XSP$SYNC_MAJOR.FNC = %XSP_FNC_PSMACNF#;
     1174    16805    2               XSP$SYNC_MAJOR.DATA$ = XSS$SYNC_MAJOR.DATA.PTR$;  /*N*/
     1175    16806    2               XSP$SYNC_MAJOR.SERNUM = XSS$SYNC_MAJOR.SERNUM;
     1176    16807    2               VBLK.EVENT = %XSP_PEV_SSMACNF;
     1177    16808    2           CASE( %XSS_FNC_SSMIIND#);
     1178    16809    2               XSP$SYNC_MINOR = XSP_SYNC_MINOR;
     1179    16810    2               XSP$SYNC_MINOR.FNC = %XSP_FNC_PSMIIND#;
     1180    16811    2               XSP$SYNC_MINOR.TYPE = XSS$SYNC_MINOR.TYPE;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:192  
     1181    16812    2               XSP$SYNC_MINOR.DATA$ = XSS$SYNC_MINOR.DATA.PTR$;  /*N*/
     1182    16813    2               XSP$SYNC_MINOR.SERNUM = XSS$SYNC_MINOR.SERNUM;
     1183    16814    2               VBLK.EVENT = %XSP_PEV_SSMIIND;
     1184    16815    2           CASE( %XSS_FNC_SSMICNF#);
     1185    16816    2               XSP$SYNC_MINOR = XSP_SYNC_MINOR;
     1186    16817    2               XSP$SYNC_MINOR.FNC = %XSP_FNC_PSMICNF#;
     1187    16818    2               XSP$SYNC_MINOR.TYPE = XSS$SYNC_MINOR.TYPE;
     1188    16819    2               XSP$SYNC_MINOR.DATA$ = XSS$SYNC_MINOR.DATA.PTR$;  /*N*/
     1189    16820    2               XSP$SYNC_MINOR.SERNUM = XSS$SYNC_MINOR.SERNUM;
     1190    16821    2               VBLK.EVENT = %XSP_PEV_SSMICNF;
     1191    16822    2           CASE( %XSS_FNC_STKGIND#);
     1192    16823    2               XSP$TOKEN_GIVE = XSP_TOKEN_GIVE;
     1193    16824    2               XSP$TOKEN_GIVE.FNC = %XSP_FNC_PTKGIND#;
     1194    16825    2               XSP$TOKEN_GIVE.TOKENS = XSS$TOKEN_GIVE.TOKENS;
     1195    16826    2               VBLK.EVENT = %XSP_PEV_STKGIND;
     1196    16827    2           CASE( %XSS_FNC_STKPIND#);
     1197    16828    2               XSP$TOKEN_PLEASE = XSP_TOKEN_PLEASE;
     1198    16829    2               XSP$TOKEN_PLEASE.FNC = %XSP_FNC_PTKPIND#;
     1199    16830    2               XSP$TOKEN_PLEASE.TOKENS = XSS$TOKEN_PLEASE.TOKENS;
     1200    16831    2               XSP$TOKEN_PLEASE.DATA$ = XSS$TOKEN_PLEASE.DATA.PTR$;  /*N*/
     1201    16832    2               VBLK.EVENT = %XSP_PEV_STKPIND;
     1202    16833    2           CASE( %XSS_FNC_STYDIND#);
     1203    16834                    /* should be one of AC, ACA, or TTD PPDU from Presentation-peer */
     1204    16835    2               XSP_TMPCTXT$ = ADDR( TMPCTXT);
     1205    16836    2               TMPCTXT(0) = 0;
     1206    16837    2               CALL XSP$DECODE( VBLK, SFPT$)
     1207    16838    3               WHENALTRETURN DO;
     1208    16839    3                   VBLK.PPDUERR = 1;
     1209    16840    3                   END;
     1210    16841                    /* VBLK.EVENT filled in by XSP$DECODE */
     1211    16842    2           CASE( %XSS_FNC_SUABIND#);
     1212    16843                    /* should be ARP or ARU PPDU from Presentation-peer */
     1213    16844    2               CALL XSP$DECODE( VBLK, SFPT$)
     1214    16845    3               WHENALTRETURN DO;
     1215    16846    3                   VBLK.PPDUERR = 1;
     1216    16847    3                   END;
     1217    16848                    /* VBLK.EVENT filled in by XSP$DECODE */
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:193  
     1218    16849    2           CASE( %XSS_FNC_SUERIND#);
     1219    16850                    /* Session-peer reporting an exception */
     1220    16851    2               XSP$U_EXCEPTION_REPORT = XSP_U_EXCEPTION_REPORT;
     1221    16852    2               XSP$U_EXCEPTION_REPORT.FNC = %XSP_FNC_PUERIND#;
     1222    16853    2               XSP$U_EXCEPTION_REPORT.REASON = XSS$U_EXCEPTION_REPORT.REASON;
     1223    16854    2               XSP$U_EXCEPTION_REPORT.DATA$ = XSS$U_EXCEPTION_REPORT.DATA.PTR$;  /*N*/
     1224    16855    2               VBLK.EVENT = %XSP_PEV_SUERIND;
     1225    16856    2           END;
     1226    16857    1       XSP$GENERIC.PCID = XSS$GENERIC.SCID;
     1227    16858    2       IF XSP_DATANUM > 0 THEN DO;
     1228    16859    2           CALL XSS$GETMEM( BLKX, AFPT$, XSP_DATANUM * SIZEC( XSP_ASN1_FPT));
     1229    16860    2           XSP$GENERIC.DATA$ = AFPT$;
     1230    16861    3           DO I = 1 TO XSP_DATANUM;
     1231    16862    3               AFPT = XSP_ASN1_FPT;
     1232    16863    3               AFPT.BUF$ = XSP_DATABUF$( I-1);
     1233    16864    3               AFPT.NXTX = XSP_DATASIZE( I-1);
     1234    16865    3               AFPT.CTXTID = XSP_DATACTXT( I-1);
     1235    16866    3               IF I < XSP_DATANUM THEN
     1236    16867    3                   AFPT.LINK$ = PINCRC( AFPT$, SIZEC( XSP_ASN1_FPT));
     1237    16868    3               AFPT$ = AFPT.LINK$;
     1238    16869    3               END;
     1239    16870    2           END;
     1240    16871    1       ABORTING = %FALSE;
     1241    16872    1       CALL XSP$MACHINE( VBLK)
     1242    16873    2       WHENALTRETURN DO;
     1243    16874    2           ABORTING = %TRUE;  /* connection died or protocol error */
     1244    16875    2           END;
     1245    16876    1       IF XSP_DATANUM > 0 THEN
     1246    16877    1           CALL XSS$RELMEM( BLKX);
     1247    16878    1       IF ABORTING THEN
     1248    16879    1           ALTRETURN;
     1249    16880    1       RETURN;
     1250    16881
     1251    16882    1       END XSP$SRECV;

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:194  
--  Include file information  --

   XSC_PERR_C.:XSA1TOU  is referenced.
   UM_CP6.:E05OU  is referenced.
   XSP_ASN1_M.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   XSP_INTERNAL_M.:XSA1TOU  is referenced.
   XSP_INTERNAL_E.:XSA1TOU  is referenced.
   XSP_PRESENTATION_M.:XSA1TOU  is referenced.
   XSP_PRESENTATION_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$SRECV.

   Procedure XSP$SRECV requires 618 words for executable code.
   Procedure XSP$SRECV requires 202 words of local(AUTO) storage.

    No errors detected in file XSP$DECODE.:XSA1TSI    .

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:195  

 Object Unit name= XSP$SRECV                                  File name= XSP$DECODE.:XSA1TOU
 UTS= OCT 01 '97 12:01:32.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     15     17  XSP$SRECV
    1   Data  even  none    22     26  XSP$SRECV
    2   Proc  even  none   618   1152  XSP$SRECV
    3  RoData even  none     4      4  XSP$SRECV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  XSP$SRECV

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0     16  XSP_F$NOSCID                       1      0  XSP_DATANUM
    1      1  XSP_DATABUF$                       1     11  XSP_DATACTXT
    1     13  XSP_DATASIZE                       1     23  XSP_DSTADDR$
    1     24  XSP_SRCADDR$                       1     25  XSP_TMPCTXT$
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:196  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XSP$CTXPTR
 yes     yes           Std       2 XSP$GETCTX
         yes           Std       1 XSS$SCREECH
 yes     yes           Std       3 XSS$GETMEM
 yes     yes           Std       2 XSP$DECODE
 yes     yes           Std       1 XSP$MACHINE
 yes     yes           Std       1 XSS$RELMEM
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     XSP_ACTIVITY_DISCARD                  XSP_ACTIVITY_END                      XSP_ACTIVITY_INTERRUPT
     XSP_ACTIVITY_RESUME                   XSP_ACTIVITY_START                    XSP_CONTROL_GIVE
     XSP_P_ABORT                           XSP_P_EXCEPTION_REPORT                XSP_RELEASE
     XSP_SYNC_MAJOR                        XSP_SYNC_MINOR                        XSP_TOKEN_GIVE
     XSP_TOKEN_PLEASE                      XSP_U_EXCEPTION_REPORT                XSP_VBLK
     XSS_CCB$$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:197  


      922        1        /*T***********************************************************/
      923        2        /*T*                                                         */
      924        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      925        4        /*T*                                                         */
      926        5        /*T***********************************************************/
      927        6        /*F*    NAME:   XSP$SRECV
      928        7                DESCRIPTION:
      929        8                    This is the interface routine for messages traveling up the
      930        9                    comm layers from Session to Presentation.
      931       10
      932       11                    If this is a connection attempt, we allocate a new connection
      933       12                    context.  In any case we initialize a VBLK, decode the PPDU and
      934       13                    any enclosed User Data, and enter the state machine.
      935       14        */
      936       15        XSP$SRECV: PROC( SFPT) ALTRET;

     15  2 000000   000000 700200 xent  XSP$SRECV    TSX0  ! X66_AUTO_1
         2 000001   000312 000001                    ZERO    202,1

      937       16        %INCLUDE XSS_SESSION_E;
      938      581        %INCLUDE XSS_SESSION_M;
      939     3224            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
      940     6603            %XSS$GENERIC( FPTN=SFPT, STCLASS="");
      941     6749        %INCLUDE XSP_PRESENTATION_E;
      942     6848        %INCLUDE XSP_PRESENTATION_M;
      943     8334            %XSP$GENERIC( FPTN=PFPT, STCLASS=AUTO);
      944     8430            %XSP$PRIMITIVES( STCLASS="BASED( PFPT$)");
      945    10129            %XSP_PRIMITIVES( STCLASS=SYMREF);
      946    11828        %INCLUDE XSP_INTERNAL_E;
      947    12102        %INCLUDE XSP_INTERNAL_M;
      948    12763            %XSP$PCTX( NAME=PCTX, STCLASS="BASED( CTX$)");
      949    12919            %XSP$VBLK( NAME=VBLK, STCLASS=AUTO);
      950    13065            %XSP$VBLK( NAME=XSP_VBLK, STCLASS=SYMREF);
      951    13211        %INCLUDE K_ADDRESS_M;
      952    13714        %INCLUDE XSC_COMMON_M;
      953    14367            %XSC$ADDRESS( NAME=SRCADDR, STCLASS=AUTO);
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:198  
      954    14650            %XSC$ADDRESS( NAME=DSTADDR, STCLASS=AUTO);
      955    14933            %XSC$CCB;
      956    15230        %INCLUDE XSP_ASN1_M;
      957    15576            %XSP_ASN1_FPT( STCLASS=CONSTANT);
      958    15596            %XSP_ASN1_FPT( FPTN=AFPT, STCLASS="BASED( AFPT$)");
      959    15616        %INCLUDE UM_CP6;
      960    16468        %MACRO FATALDEF( NAME=XSP_FATAL, STCLASS="CONSTANT SYMDEF", LVL=1, LAST=";",
      961    16469                         ERR#=0, SEV=7);
      962    16470            %VLP_ERRCODE( FPTN=NAME, STCLASS=STCLASS, FCG='XS', MID='P',
      963    16471                          MON='0'B, ERR#=ERR#, SEV=SEV);
      964    16472        %MEND;
      965    16473        %INCLUDE XSC_PERR_C;
      966    16550            %FATALDEF( NAME=XSP_F$NOSCID, ERR#=%F$NOSCID);
      967    16598            /*E*  ERROR:  XSP-F$NOSCID-7
      968    16599                MESSAGE:  Session didn't supply a SCID.
      969    16600            */
      970    16601
      971    16602    1       DCL XSP$CTXPTR ENTRY(2) ALTRET;
      972    16603    1       DCL XSP$DECODE ENTRY(2) ALTRET;
      973    16604    1       DCL XSP$GETCTX ENTRY(2) ALTRET;
      974    16605    1       DCL XSP$MACHINE ENTRY(1) ALTRET;
      975    16606    1       DCL XSS$GETMEM ENTRY(3) ALTRET;
      976    16607    1       DCL XSS$RELMEM ENTRY(1) ALTRET;
      977    16608    1       DCL XSS$SCREECH ENTRY(1);
      978    16609
      979    16610    1       DCL XSS_CCB$$ PTR SYMREF;
      980    16611
      981    16612    1       DCL ABORTING BIT(1);
      982    16613    1       DCL AFPT$ PTR;
      983    16614    1       DCL BLKX UBIN HALF HALIGNED;
      984    16615    1       DCL CCB$(0:0) PTR BASED( XSS_CCB$$) ALIGNED;
      985    16616    1       DCL CTX$ PTR;
      986    16617    1       DCL I SBIN;
      987    16618    1       DCL PCID SBIN;
      988    16619    1       DCL PFPT$ PTR;
      989    16620    1       DCL SFPT$ PTR;
      990    16621    1       DCL TMPCTXT(0:%XSP_MAX_DATANUM) SBIN AUTO;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:199  
      991    16622    1       DCL XSP_DATANUM SBIN STATIC SYMDEF;
      992    16623    1       DCL XSP_DATABUF$(0:%XSP_MAX_DATANUM) PTR STATIC SYMDEF;
      993    16624    1       DCL XSP_DATACTXT(0:%XSP_MAX_DATANUM) UBIN BYTE STATIC SYMDEF CALIGNED;
      994    16625    1       DCL XSP_DATASIZE(0:%XSP_MAX_DATANUM) SBIN STATIC SYMDEF;
      995    16626    1       DCL XSP_DSTADDR$ PTR STATIC SYMDEF;
      996    16627    1       DCL XSP_SRCADDR$ PTR STATIC SYMDEF;
      997    16628    1       DCL XSP_TMPCTXT$ PTR STATIC SYMDEF;
      998    16629
      999    16630    1       SFPT$ = ADDR( SFPT);

  16630  2 000002   200003 236100                    LDQ     @SFPT,,AUTO
         2 000003   200275 756100                    STQ     SFPT$,,AUTO

     1000    16631    2       IF XSS$GENERIC.SCID ~= 0 THEN DO;

  16631  2 000004   200275 470500                    LDP0    SFPT$,,AUTO
         2 000005   000000 236100                    LDQ     0,,PR0
         2 000006   000777 316003                    CANQ    511,DU
         2 000007   000046 600000 2                  TZE     s:16645

     1001    16632    2           PCID = XSS$GENERIC.SCID;

  16632  2 000010   000000 236100                    LDQ     0,,PR0
         2 000011   000022 772000                    QRL     18
         2 000012   000777 376007                    ANQ     511,DL
         2 000013   200273 756100                    STQ     PCID,,AUTO

     1002    16633    2           CALL XSP$CTXPTR( PCID, CTX$)

  16633  2 000014   200271 631500                    EPPR1   CTX$,,AUTO
         2 000015   200307 451500                    STP1    TMPCTXT+9,,AUTO
         2 000016   200273 633500                    EPPR3   PCID,,AUTO
         2 000017   200306 453500                    STP3    TMPCTXT+8,,AUTO
         2 000020   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000021   000000 631400 3                  EPPR1   0
         2 000022   000000 701000 xent               TSX1    XSP$CTXPTR
         2 000023   000025 702000 2                  TSX2    s:16636
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:200  
         2 000024   000045 710000 2                  TRA     s:16642

     1003    16634    3           WHENALTRETURN DO;

     1004    16635                    /* This appears to be an incoming connection attempt */
     1005    16636    3               CALL XSP$GETCTX( CTX$, PCID)

  16636  2 000025   200273 630500                    EPPR0   PCID,,AUTO
         2 000026   200307 450500                    STP0    TMPCTXT+9,,AUTO
         2 000027   200271 631500                    EPPR1   CTX$,,AUTO
         2 000030   200306 451500                    STP1    TMPCTXT+8,,AUTO
         2 000031   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000032   000000 631400 3                  EPPR1   0
         2 000033   000000 701000 xent               TSX1    XSP$GETCTX
         2 000034   000036 702000 2                  TSX2    s:16638
         2 000035   000037 710000 2                  TRA     s:16640

     1006    16637    4               WHENALTRETURN DO;

     1007    16638    4                   ALTRETURN;  /* reject connect attempt */

  16638  2 000036   000000 702200 xent               TSX2  ! X66_AALT

     1008    16639    4                   END;
     1009    16640    3               PCTX.ENTRY$ = CCB$( PCID)->XSC$CCB.PRES$;  /* inherit entry */

  16640  2 000037   000000 470400 xsym               LDP0    XSS_CCB$$
         2 000040   200273 720100                    LXL0    PCID,,AUTO
         2 000041   000000 471510                    LDP1    0,X0,PR0
         2 000042   100011 236100                    LDQ     9,,PR1
         2 000043   200271 473500                    LDP3    CTX$,,AUTO
         2 000044   300007 756100                    STQ     7,,PR3

     1010    16641    3               END;

     1011    16642    2           END;

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:201  
  16642  2 000045   000052 710000 2                  TRA     s:16646

     1012    16643    1       ELSE
     1013    16644                /* SCID not filled in.  Session blew it. */
     1014    16645    1           CALL XSS$SCREECH( XSP_F$NOSCID);

  16645  2 000046   000002 630400 3                  EPPR0   2
         2 000047   000001 631400 3                  EPPR1   1
         2 000050   000000 701000 xent               TSX1    XSS$SCREECH
         2 000051   000000 011000                    NOP     0

     1015    16646    1       PFPT$ = ADDR( PFPT);

  16646  2 000052   200004 630500                    EPPR0   PFPT,,AUTO
         2 000053   200274 450500                    STP0    PFPT$,,AUTO

     1016    16647    1       VBLK = XSP_VBLK;

  16647  2 000054   000100 100400                    MLR     fill='000'O
         2 000055   000000 000054 xsym               ADSC9   XSP_VBLK                 cn=0,n=44
         2 000056   200022 000054                    ADSC9   VBLK,,AUTO               cn=0,n=44

     1017    16648    1       VBLK.CTX$ = CTX$;

  16648  2 000057   200271 236100                    LDQ     CTX$,,AUTO
         2 000060   200022 756100                    STQ     VBLK,,AUTO

     1018    16649    1       VBLK.FPT$ = PFPT$;

  16649  2 000061   200274 236100                    LDQ     PFPT$,,AUTO
         2 000062   200023 756100                    STQ     VBLK+1,,AUTO

     1019    16650    1       VBLK.DATA = XSS$GENERIC.DATA;

  16650  2 000063   200275 471500                    LDP1    SFPT$,,AUTO
         2 000064   100002 237100                    LDAQ    2,,PR1
         2 000065   200026 757100                    STAQ    VBLK+4,,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:202  

     1020    16651    1       XSP_DATANUM = 0;

  16651  2 000066   000000 450000 1                  STZ     XSP_DATANUM

     1021    16652            /* set up the corresponding event and Presentation FPT */
     1022    16653    2       DO CASE( XSS$GENERIC.FNC);

  16653  2 000067   100000 236100                    LDQ     0,,PR1
         2 000070   000033 772000                    QRL     27
         2 000071   000073 116007                    CMPQ    59,DL
         2 000072   000074 602006 2                  TNC     s:16653+5,QL
         2 000073   001035 710000 2                  TRA     s:16857
         2 000074   001035 710000 2                  TRA     s:16857
         2 000075   001035 710000 2                  TRA     s:16857
         2 000076   000167 710000 2                  TRA     s:16655
         2 000077   001035 710000 2                  TRA     s:16857
         2 000100   000202 710000 2                  TRA     s:16660
         2 000101   001035 710000 2                  TRA     s:16857
         2 000102   000215 710000 2                  TRA     s:16665
         2 000103   001035 710000 2                  TRA     s:16857
         2 000104   000233 710000 2                  TRA     s:16671
         2 000105   001035 710000 2                  TRA     s:16857
         2 000106   000251 710000 2                  TRA     s:16677
         2 000107   001035 710000 2                  TRA     s:16857
         2 000110   000264 710000 2                  TRA     s:16682
         2 000111   001035 710000 2                  TRA     s:16857
         2 000112   000277 710000 2                  TRA     s:16687
         2 000113   001035 710000 2                  TRA     s:16857
         2 000114   000325 710000 2                  TRA     s:16695
         2 000115   001035 710000 2                  TRA     s:16857
         2 000116   000344 710000 2                  TRA     s:16702
         2 000117   001035 710000 2                  TRA     s:16857
         2 000120   000362 710000 2                  TRA     s:16709
         2 000121   001035 710000 2                  TRA     s:16857
         2 000122   000400 710000 2                  TRA     s:16716
         2 000123   001035 710000 2                  TRA     s:16857
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:203  
         2 000124   000425 710000 2                  TRA     s:16727
         2 000125   001035 710000 2                  TRA     s:16857
         2 000126   000450 710000 2                  TRA     s:16737
         2 000127   001035 710000 2                  TRA     s:16857
         2 000130   000460 710000 2                  TRA     s:16742
         2 000131   001035 710000 2                  TRA     s:16857
         2 000132   000476 710000 2                  TRA     s:16749
         2 000133   001035 710000 2                  TRA     s:16857
         2 000134   000542 710000 2                  TRA     s:16767
         2 000135   001035 710000 2                  TRA     s:16857
         2 000136   000555 710000 2                  TRA     s:16772
         2 000137   001035 710000 2                  TRA     s:16857
         2 000140   000602 710000 2                  TRA     s:16784
         2 000141   001035 710000 2                  TRA     s:16857
         2 000142   000620 710000 2                  TRA     s:16791
         2 000143   001035 710000 2                  TRA     s:16857
         2 000144   000636 710000 2                  TRA     s:16797
         2 000145   001035 710000 2                  TRA     s:16857
         2 000146   000654 710000 2                  TRA     s:16803
         2 000147   001035 710000 2                  TRA     s:16857
         2 000150   000672 710000 2                  TRA     s:16809
         2 000151   001035 710000 2                  TRA     s:16857
         2 000152   000713 710000 2                  TRA     s:16816
         2 000153   001035 710000 2                  TRA     s:16857
         2 000154   000734 710000 2                  TRA     s:16823
         2 000155   001035 710000 2                  TRA     s:16857
         2 000156   000747 710000 2                  TRA     s:16828
         2 000157   001035 710000 2                  TRA     s:16857
         2 000160   000765 710000 2                  TRA     s:16835
         2 000161   001035 710000 2                  TRA     s:16857
         2 000162   001004 710000 2                  TRA     s:16844
         2 000163   001035 710000 2                  TRA     s:16857
         2 000164   001020 710000 2                  TRA     s:16851
         2 000165   000514 710000 2                  TRA     s:16756
         2 000166   000527 710000 2                  TRA     s:16762

     1023    16654    2           CASE( %XSS_FNC_SACDIND#);
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:204  

     1024    16655    2               XSP$ACTIVITY_DISCARD = XSP_ACTIVITY_DISCARD;

  16655  2 000167   000100 100400                    MLR     fill='000'O
         2 000170   000000 000010 xsym               ADSC9   XSP_ACTIVITY_DISCARD     cn=0,n=8
         2 000171   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1025    16656    2               XSP$ACTIVITY_DISCARD.FNC = %XSP_FNC_PACDIND#;

  16656  2 000172   002000 236003                    LDQ     1024,DU
         2 000173   000000 552140                    STBQ    0,'40'O,PR0

     1026    16657    2               XSP$ACTIVITY_DISCARD.REASON = XSS$ACTIVITY_DISCARD.REASON;

  16657  2 000174   200275 471500                    LDP1    SFPT$,,AUTO
         2 000175   100000 236100                    LDQ     0,,PR1
         2 000176   000000 552110                    STBQ    0,'10'O,PR0

     1027    16658    2               VBLK.EVENT = %XSP_PEV_SACDIND;

  16658  2 000177   000021 236007                    LDQ     17,DL
         2 000200   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000201   001035 710000 2                  TRA     s:16857

     1028    16659    2           CASE( %XSS_FNC_SACDCNF#);

     1029    16660    2               XSP$ACTIVITY_DISCARD = XSP_ACTIVITY_DISCARD;

  16660  2 000202   000100 100400                    MLR     fill='000'O
         2 000203   000000 000010 xsym               ADSC9   XSP_ACTIVITY_DISCARD     cn=0,n=8
         2 000204   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1030    16661    2               XSP$ACTIVITY_DISCARD.FNC = %XSP_FNC_PACDCNF#;

  16661  2 000205   004000 236003                    LDQ     2048,DU
         2 000206   000000 552140                    STBQ    0,'40'O,PR0

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:205  
     1031    16662    2               XSP$ACTIVITY_DISCARD.REASON = XSS$ACTIVITY_DISCARD.REASON;

  16662  2 000207   200275 471500                    LDP1    SFPT$,,AUTO
         2 000210   100000 236100                    LDQ     0,,PR1
         2 000211   000000 552110                    STBQ    0,'10'O,PR0

     1032    16663    2               VBLK.EVENT = %XSP_PEV_SACDCNF;

  16663  2 000212   000023 236007                    LDQ     19,DL
         2 000213   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000214   001035 710000 2                  TRA     s:16857

     1033    16664    2           CASE( %XSS_FNC_SACEIND#);

     1034    16665    2               XSP$ACTIVITY_END = XSP_ACTIVITY_END;

  16665  2 000215   000100 100400                    MLR     fill='000'O
         2 000216   000000 000024 xsym               ADSC9   XSP_ACTIVITY_END         cn=0,n=20
         2 000217   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1035    16666    2               XSP$ACTIVITY_END.FNC = %XSP_FNC_PACEIND#;

  16666  2 000220   006000 236003                    LDQ     3072,DU
         2 000221   000000 552140                    STBQ    0,'40'O,PR0

     1036    16667    2               XSP$ACTIVITY_END.DATA$ = XSS$ACTIVITY_END.DATA.PTR$;  /*N*/

  16667  2 000222   200275 471500                    LDP1    SFPT$,,AUTO
         2 000223   100002 236100                    LDQ     2,,PR1
         2 000224   000002 756100                    STQ     2,,PR0

     1037    16668    2               XSP$ACTIVITY_END.SERNUM = XSS$ACTIVITY_END.SERNUM;

  16668  2 000225   200275 471500                    LDP1    SFPT$,,AUTO
         2 000226   100004 235100                    LDA     4,,PR1
         2 000227   000004 755100                    STA     4,,PR0

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:206  
     1038    16669    2               VBLK.EVENT = %XSP_PEV_SACEIND;

  16669  2 000230   000025 236007                    LDQ     21,DL
         2 000231   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000232   001035 710000 2                  TRA     s:16857

     1039    16670    2           CASE( %XSS_FNC_SACECNF#);

     1040    16671    2               XSP$ACTIVITY_END = XSP_ACTIVITY_END;

  16671  2 000233   000100 100400                    MLR     fill='000'O
         2 000234   000000 000024 xsym               ADSC9   XSP_ACTIVITY_END         cn=0,n=20
         2 000235   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1041    16672    2               XSP$ACTIVITY_END.FNC = %XSP_FNC_PACECNF#;

  16672  2 000236   010000 236003                    LDQ     4096,DU
         2 000237   000000 552140                    STBQ    0,'40'O,PR0

     1042    16673    2               XSP$ACTIVITY_END.DATA$ = XSS$ACTIVITY_END.DATA.PTR$;  /*N*/

  16673  2 000240   200275 471500                    LDP1    SFPT$,,AUTO
         2 000241   100002 236100                    LDQ     2,,PR1
         2 000242   000002 756100                    STQ     2,,PR0

     1043    16674    2               XSP$ACTIVITY_END.SERNUM = XSS$ACTIVITY_END.SERNUM;

  16674  2 000243   200275 471500                    LDP1    SFPT$,,AUTO
         2 000244   100004 235100                    LDA     4,,PR1
         2 000245   000004 755100                    STA     4,,PR0

     1044    16675    2               VBLK.EVENT = %XSP_PEV_SACECNF;

  16675  2 000246   000027 236007                    LDQ     23,DL
         2 000247   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000250   001035 710000 2                  TRA     s:16857

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:207  
     1045    16676    2           CASE( %XSS_FNC_SACIIND#);

     1046    16677    2               XSP$ACTIVITY_INTERRUPT = XSP_ACTIVITY_INTERRUPT;

  16677  2 000251   000100 100400                    MLR     fill='000'O
         2 000252   000000 000010 xsym               ADSC9   XSP_ACTIVITY_INTERRUPT   cn=0,n=8
         2 000253   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1047    16678    2               XSP$ACTIVITY_INTERRUPT.FNC = %XSP_FNC_PACIIND#;

  16678  2 000254   012000 236003                    LDQ     5120,DU
         2 000255   000000 552140                    STBQ    0,'40'O,PR0

     1048    16679    2               XSP$ACTIVITY_INTERRUPT.REASON = XSS$ACTIVITY_INTERRUPT.REASON;

  16679  2 000256   200275 471500                    LDP1    SFPT$,,AUTO
         2 000257   100000 236100                    LDQ     0,,PR1
         2 000260   000000 552110                    STBQ    0,'10'O,PR0

     1049    16680    2               VBLK.EVENT = %XSP_PEV_SACIIND;

  16680  2 000261   000031 236007                    LDQ     25,DL
         2 000262   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000263   001035 710000 2                  TRA     s:16857

     1050    16681    2           CASE( %XSS_FNC_SACICNF#);

     1051    16682    2               XSP$ACTIVITY_INTERRUPT = XSP_ACTIVITY_INTERRUPT;

  16682  2 000264   000100 100400                    MLR     fill='000'O
         2 000265   000000 000010 xsym               ADSC9   XSP_ACTIVITY_INTERRUPT   cn=0,n=8
         2 000266   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1052    16683    2               XSP$ACTIVITY_INTERRUPT.FNC = %XSP_FNC_PACICNF#;

  16683  2 000267   014000 236003                    LDQ     6144,DU
         2 000270   000000 552140                    STBQ    0,'40'O,PR0
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:208  

     1053    16684    2               XSP$ACTIVITY_INTERRUPT.REASON = XSS$ACTIVITY_INTERRUPT.REASON;

  16684  2 000271   200275 471500                    LDP1    SFPT$,,AUTO
         2 000272   100000 236100                    LDQ     0,,PR1
         2 000273   000000 552110                    STBQ    0,'10'O,PR0

     1054    16685    2               VBLK.EVENT = %XSP_PEV_SACICNF;

  16685  2 000274   000033 236007                    LDQ     27,DL
         2 000275   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000276   001035 710000 2                  TRA     s:16857

     1055    16686    2           CASE( %XSS_FNC_SACRIND#);

     1056    16687    2               XSP$ACTIVITY_RESUME = XSP_ACTIVITY_RESUME;

  16687  2 000277   000100 100400                    MLR     fill='000'O
         2 000300   000000 000064 xsym               ADSC9   XSP_ACTIVITY_RESUME      cn=0,n=52
         2 000301   000000 000064                    ADSC9   0,,PR0                   cn=0,n=52

     1057    16688    2               XSP$ACTIVITY_RESUME.FNC = %XSP_FNC_PACRIND#;

  16688  2 000302   016000 236003                    LDQ     7168,DU
         2 000303   000000 552140                    STBQ    0,'40'O,PR0

     1058    16689    2               XSP$ACTIVITY_RESUME.DATA$ = XSS$ACTIVITY_RESUME.DATA.PTR$;  /*N*/

  16689  2 000304   200275 471500                    LDP1    SFPT$,,AUTO
         2 000305   100002 236100                    LDQ     2,,PR1
         2 000306   000002 756100                    STQ     2,,PR0

     1059    16690    2               XSP$ACTIVITY_RESUME.SERNUM = XSS$ACTIVITY_RESUME.SERNUM;

  16690  2 000307   200275 471500                    LDP1    SFPT$,,AUTO
         2 000310   100004 235100                    LDA     4,,PR1
         2 000311   000004 755100                    STA     4,,PR0
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:209  

     1060    16691    2               XSP$ACTIVITY_RESUME.ACTID = XSS$ACTIVITY_RESUME.ACTID;

  16691  2 000312   200275 471500                    LDP1    SFPT$,,AUTO
         2 000313   000100 100500                    MLR     fill='000'O
         2 000314   100010 000007                    ADSC9   8,,PR1                   cn=0,n=7
         2 000315   000010 000007                    ADSC9   8,,PR0                   cn=0,n=7

     1061    16692    2               XSP$ACTIVITY_RESUME.OACTID = XSS$ACTIVITY_RESUME.OACTID;

  16692  2 000316   200275 471500                    LDP1    SFPT$,,AUTO
         2 000317   000100 100500                    MLR     fill='000'O
         2 000320   100012 000007                    ADSC9   10,,PR1                  cn=0,n=7
         2 000321   000012 000007                    ADSC9   10,,PR0                  cn=0,n=7

     1062    16693    2               VBLK.EVENT = %XSP_PEV_SACRIND;

  16693  2 000322   000035 236007                    LDQ     29,DL
         2 000323   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000324   001035 710000 2                  TRA     s:16857

     1063    16694    2           CASE( %XSS_FNC_SACSIND#);

     1064    16695    2               XSP$ACTIVITY_START = XSP_ACTIVITY_START;

  16695  2 000325   000100 100400                    MLR     fill='000'O
         2 000326   000000 000030 xsym               ADSC9   XSP_ACTIVITY_START       cn=0,n=24
         2 000327   000000 000030                    ADSC9   0,,PR0                   cn=0,n=24

     1065    16696    2               XSP$ACTIVITY_START.FNC = %XSP_FNC_PACSIND#;

  16696  2 000330   020000 236003                    LDQ     8192,DU
         2 000331   000000 552140                    STBQ    0,'40'O,PR0

     1066    16697    2               XSP$ACTIVITY_START.DATA$ = XSS$ACTIVITY_START.DATA.PTR$;  /*N*/

  16697  2 000332   200275 471500                    LDP1    SFPT$,,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:210  
         2 000333   100002 236100                    LDQ     2,,PR1
         2 000334   000002 756100                    STQ     2,,PR0

     1067    16698    2               XSP$ACTIVITY_START.ACTID = XSS$ACTIVITY_START.ACTID;

  16698  2 000335   200275 471500                    LDP1    SFPT$,,AUTO
         2 000336   000100 100500                    MLR     fill='000'O
         2 000337   100004 000007                    ADSC9   4,,PR1                   cn=0,n=7
         2 000340   000004 000007                    ADSC9   4,,PR0                   cn=0,n=7

     1068    16699    2               VBLK.EVENT = %XSP_PEV_SACSIND;

  16699  2 000341   000037 236007                    LDQ     31,DL
         2 000342   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000343   001035 710000 2                  TRA     s:16857

     1069    16700    2           CASE( %XSS_FNC_SCADIND#);

     1070    16701                    /* should be a TC PPDU from Presentation-peer */
     1071    16702    2               CALL XSP$DECODE( VBLK, SFPT$)

  16702  2 000344   200275 633500                    EPPR3   SFPT$,,AUTO
         2 000345   200307 453500                    STP3    TMPCTXT+9,,AUTO
         2 000346   200022 634500                    EPPR4   VBLK,,AUTO
         2 000347   200306 454500                    STP4    TMPCTXT+8,,AUTO
         2 000350   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000351   000000 631400 3                  EPPR1   0
         2 000352   000000 701000 xent               TSX1    XSP$DECODE
         2 000353   000355 702000 2                  TSX2    s:16704
         2 000354   000357 710000 2                  TRA     s:16706

     1072    16703    3               WHENALTRETURN DO;

     1073    16704    3                   VBLK.PPDUERR = 1;

  16704  2 000355   001000 236007                    LDQ     512,DL
         2 000356   200030 552110                    STBQ    VBLK+6,'10'O,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:211  

     1074    16705    3                   END;

     1075    16706    2               VBLK.EVENT = %XSP_PEV_TC;

  16706  2 000357   000012 236007                    LDQ     10,DL
         2 000360   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000361   001035 710000 2                  TRA     s:16857

     1076    16707    2           CASE( %XSS_FNC_SCADCNF#);

     1077    16708                    /* should be a TCC PPDU from Presentation-peer */
     1078    16709    2               CALL XSP$DECODE( VBLK, SFPT$)

  16709  2 000362   200275 633500                    EPPR3   SFPT$,,AUTO
         2 000363   200307 453500                    STP3    TMPCTXT+9,,AUTO
         2 000364   200022 634500                    EPPR4   VBLK,,AUTO
         2 000365   200306 454500                    STP4    TMPCTXT+8,,AUTO
         2 000366   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000367   000000 631400 3                  EPPR1   0
         2 000370   000000 701000 xent               TSX1    XSP$DECODE
         2 000371   000373 702000 2                  TSX2    s:16711
         2 000372   000375 710000 2                  TRA     s:16713

     1079    16710    3               WHENALTRETURN DO;

     1080    16711    3                   VBLK.PPDUERR = 1;

  16711  2 000373   001000 236007                    LDQ     512,DL
         2 000374   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1081    16712    3                   END;

     1082    16713    2               VBLK.EVENT = %XSP_PEV_TCC;

  16713  2 000375   000013 236007                    LDQ     11,DL
         2 000376   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:212  
         2 000377   001035 710000 2                  TRA     s:16857

     1083    16714    2           CASE( %XSS_FNC_SCONIND#);

     1084    16715                    /* should be a CP PPDU from Presentation-peer */
     1085    16716    2               XSP_SRCADDR$ = ADDR( SRCADDR);

  16716  2 000400   200036 633500                    EPPR3   SRCADDR,,AUTO
         2 000401   000024 453400 1                  STP3    XSP_SRCADDR$

     1086    16717    2               XSP_DSTADDR$ = ADDR( DSTADDR);

  16717  2 000402   200152 634500                    EPPR4   DSTADDR,,AUTO
         2 000403   000023 454400 1                  STP4    XSP_DSTADDR$

     1087    16718    2               XSP_TMPCTXT$ = ADDR( TMPCTXT);

  16718  2 000404   200276 635500                    EPPR5   TMPCTXT,,AUTO
         2 000405   000025 455400 1                  STP5    XSP_TMPCTXT$

     1088    16719    2               TMPCTXT(0) = 0;

  16719  2 000406   200276 450100                    STZ     TMPCTXT,,AUTO

     1089    16720    2               CALL XSP$DECODE( VBLK, SFPT$)

  16720  2 000407   200275 636500                    EPPR6   SFPT$,,AUTO
         2 000410   200307 456500                    STP6    TMPCTXT+9,,AUTO
         2 000411   200022 637500                    EPPR7   VBLK,,AUTO
         2 000412   200306 457500                    STP7    TMPCTXT+8,,AUTO
         2 000413   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000414   000000 631400 3                  EPPR1   0
         2 000415   000000 701000 xent               TSX1    XSP$DECODE
         2 000416   000420 702000 2                  TSX2    s:16722
         2 000417   000422 710000 2                  TRA     s:16724

     1090    16721    3               WHENALTRETURN DO;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:213  

     1091    16722    3                   VBLK.PPDUERR = 1;

  16722  2 000420   001000 236007                    LDQ     512,DL
         2 000421   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1092    16723    3                   END;

     1093    16724    2               VBLK.EVENT = %XSP_PEV_CP;

  16724  2 000422   000005 236007                    LDQ     5,DL
         2 000423   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000424   001035 710000 2                  TRA     s:16857

     1094    16725    2           CASE( %XSS_FNC_SCONCNF#);

     1095    16726                    /* should be a CPA or CPR PPDU from Presentation-peer */
     1096    16727    2               XSP_SRCADDR$ = ADDR( SRCADDR);

  16727  2 000425   200036 633500                    EPPR3   SRCADDR,,AUTO
         2 000426   000024 453400 1                  STP3    XSP_SRCADDR$

     1097    16728    2               XSP_DSTADDR$ = ADDR( DSTADDR);

  16728  2 000427   200152 634500                    EPPR4   DSTADDR,,AUTO
         2 000430   000023 454400 1                  STP4    XSP_DSTADDR$

     1098    16729    2               XSP_TMPCTXT$ = ADDR( TMPCTXT);

  16729  2 000431   200276 635500                    EPPR5   TMPCTXT,,AUTO
         2 000432   000025 455400 1                  STP5    XSP_TMPCTXT$

     1099    16730    2               TMPCTXT(0) = 0;

  16730  2 000433   200276 450100                    STZ     TMPCTXT,,AUTO

     1100    16731    2               CALL XSP$DECODE( VBLK, SFPT$)
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:214  

  16731  2 000434   200275 636500                    EPPR6   SFPT$,,AUTO
         2 000435   200307 456500                    STP6    TMPCTXT+9,,AUTO
         2 000436   200022 637500                    EPPR7   VBLK,,AUTO
         2 000437   200306 457500                    STP7    TMPCTXT+8,,AUTO
         2 000440   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000441   000000 631400 3                  EPPR1   0
         2 000442   000000 701000 xent               TSX1    XSP$DECODE
         2 000443   000445 702000 2                  TSX2    s:16733
         2 000444   000447 710000 2                  TRA     s:16734

     1101    16732    3               WHENALTRETURN DO;

     1102    16733    3                   VBLK.PPDUERR = 1;

  16733  2 000445   001000 236007                    LDQ     512,DL
         2 000446   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1103    16734    3                   END;

  16734  2 000447   001035 710000 2                  TRA     s:16857

     1104    16735                    /* VBLK.EVENT filled in by XSP$DECODE */
     1105    16736    2           CASE( %XSS_FNC_SCTGIND#);

     1106    16737    2               XSP$CONTROL_GIVE = XSP_CONTROL_GIVE;

  16737  2 000450   000100 100400                    MLR     fill='000'O
         2 000451   000000 000010 xsym               ADSC9   XSP_CONTROL_GIVE         cn=0,n=8
         2 000452   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1107    16738    2               XSP$CONTROL_GIVE.FNC = %XSP_FNC_PCTGIND#;

  16738  2 000453   036000 236003                    LDQ     15360,DU
         2 000454   000000 552140                    STBQ    0,'40'O,PR0

     1108    16739    2               VBLK.EVENT = %XSP_PEV_SCTGIND;
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:215  

  16739  2 000455   000041 236007                    LDQ     33,DL
         2 000456   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000457   001035 710000 2                  TRA     s:16857

     1109    16740    2           CASE( %XSS_FNC_SDATIND#);

     1110    16741                    /* should be a TD PPDU from Presentation-peer */
     1111    16742    2               CALL XSP$DECODE( VBLK, SFPT$)

  16742  2 000460   200275 633500                    EPPR3   SFPT$,,AUTO
         2 000461   200307 453500                    STP3    TMPCTXT+9,,AUTO
         2 000462   200022 634500                    EPPR4   VBLK,,AUTO
         2 000463   200306 454500                    STP4    TMPCTXT+8,,AUTO
         2 000464   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000465   000000 631400 3                  EPPR1   0
         2 000466   000000 701000 xent               TSX1    XSP$DECODE
         2 000467   000471 702000 2                  TSX2    s:16744
         2 000470   000473 710000 2                  TRA     s:16746

     1112    16743    3               WHENALTRETURN DO;

     1113    16744    3                   VBLK.PPDUERR = 1;

  16744  2 000471   001000 236007                    LDQ     512,DL
         2 000472   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1114    16745    3                   END;

     1115    16746    2               VBLK.EVENT = %XSP_PEV_TD;

  16746  2 000473   000014 236007                    LDQ     12,DL
         2 000474   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000475   001035 710000 2                  TRA     s:16857

     1116    16747    2           CASE( %XSS_FNC_SEXPIND#);

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:216  
     1117    16748                    /* should be a TE PPDU from Presentation-peer */
     1118    16749    2               CALL XSP$DECODE( VBLK, SFPT$)

  16749  2 000476   200275 633500                    EPPR3   SFPT$,,AUTO
         2 000477   200307 453500                    STP3    TMPCTXT+9,,AUTO
         2 000500   200022 634500                    EPPR4   VBLK,,AUTO
         2 000501   200306 454500                    STP4    TMPCTXT+8,,AUTO
         2 000502   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000503   000000 631400 3                  EPPR1   0
         2 000504   000000 701000 xent               TSX1    XSP$DECODE
         2 000505   000507 702000 2                  TSX2    s:16751
         2 000506   000511 710000 2                  TRA     s:16753

     1119    16750    3               WHENALTRETURN DO;

     1120    16751    3                   VBLK.PPDUERR = 1;

  16751  2 000507   001000 236007                    LDQ     512,DL
         2 000510   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1121    16752    3                   END;

     1122    16753    2               VBLK.EVENT = %XSP_PEV_TE;

  16753  2 000511   000015 236007                    LDQ     13,DL
         2 000512   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000513   001035 710000 2                  TRA     s:16857

     1123    16754    2           CASE( %XSS_FNC_SPABIND#);

     1124    16755                    /* Session-provider abort */
     1125    16756    2               XSP$P_ABORT = XSP_P_ABORT;

  16756  2 000514   000100 100400                    MLR     fill='000'O
         2 000515   000000 000010 xsym               ADSC9   XSP_P_ABORT              cn=0,n=8
         2 000516   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:217  
     1126    16757    2               XSP$P_ABORT.FNC = %XSP_FNC_PPABIND#;

  16757  2 000517   075000 236003                    LDQ     31232,DU
         2 000520   000000 552140                    STBQ    0,'40'O,PR0

     1127    16758    2               XSP$P_ABORT.REASON = XSS$P_ABORT.REASON;

  16758  2 000521   200275 471500                    LDP1    SFPT$,,AUTO
         2 000522   100000 236100                    LDQ     0,,PR1
         2 000523   000000 552110                    STBQ    0,'10'O,PR0

     1128    16759    2               VBLK.EVENT = %XSP_PEV_SPABIND;

  16759  2 000524   000073 236007                    LDQ     59,DL
         2 000525   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000526   001035 710000 2                  TRA     s:16857

     1129    16760    2           CASE( %XSS_FNC_SPERIND#);

     1130    16761                    /* Session-provider exception report */
     1131    16762    2               XSP$P_EXCEPTION_REPORT = XSP_P_EXCEPTION_REPORT;

  16762  2 000527   000100 100400                    MLR     fill='000'O
         2 000530   000000 000010 xsym               ADSC9   XSP_P_EXCEPTION_REPORT   cn=0,n=8
         2 000531   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1132    16763    2               XSP$P_EXCEPTION_REPORT.FNC = %XSP_FNC_PPERIND#;

  16763  2 000532   076000 236003                    LDQ     31744,DU
         2 000533   000000 552140                    STBQ    0,'40'O,PR0

     1133    16764    2               XSP$P_EXCEPTION_REPORT.REASON = XSS$P_EXCEPTION_REPORT.REASON;

  16764  2 000534   200275 471500                    LDP1    SFPT$,,AUTO
         2 000535   100000 236100                    LDQ     0,,PR1
         2 000536   000000 552110                    STBQ    0,'10'O,PR0

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:218  
     1134    16765    2               VBLK.EVENT = %XSP_PEV_SPERIND;

  16765  2 000537   000075 236007                    LDQ     61,DL
         2 000540   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000541   001035 710000 2                  TRA     s:16857

     1135    16766    2           CASE( %XSS_FNC_SRELIND#);

     1136    16767    2               XSP$RELEASE = XSP_RELEASE;

  16767  2 000542   000100 100400                    MLR     fill='000'O
         2 000543   000000 000014 xsym               ADSC9   XSP_RELEASE              cn=0,n=12
         2 000544   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

     1137    16768    2               XSP$RELEASE.FNC = %XSP_FNC_PRELIND#;

  16768  2 000545   044000 236003                    LDQ     18432,DU
         2 000546   000000 552140                    STBQ    0,'40'O,PR0

     1138    16769    2               XSP$RELEASE.DATA$ = XSS$RELEASE.DATA.PTR$;  /*N*/

  16769  2 000547   200275 471500                    LDP1    SFPT$,,AUTO
         2 000550   100002 236100                    LDQ     2,,PR1
         2 000551   000002 756100                    STQ     2,,PR0

     1139    16770    2               VBLK.EVENT = %XSP_PEV_SRELIND;

  16770  2 000552   000047 236007                    LDQ     39,DL
         2 000553   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000554   001035 710000 2                  TRA     s:16857

     1140    16771    2           CASE( %XSS_FNC_SRELCNF#);

     1141    16772    2               XSP$RELEASE = XSP_RELEASE;

  16772  2 000555   000100 100400                    MLR     fill='000'O
         2 000556   000000 000014 xsym               ADSC9   XSP_RELEASE              cn=0,n=12
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:219  
         2 000557   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

     1142    16773    2               XSP$RELEASE.FNC = %XSP_FNC_PRELCNF#;

  16773  2 000560   046000 236003                    LDQ     19456,DU
         2 000561   000000 552140                    STBQ    0,'40'O,PR0

     1143    16774    2               XSP$RELEASE.RESULT = XSS$RELEASE.RESULT;

  16774  2 000562   200275 471500                    LDP1    SFPT$,,AUTO
         2 000563   100000 236100                    LDQ     0,,PR1
         2 000564   000000 552104                    STBQ    0,'04'O,PR0

     1144    16775    2               XSP$RELEASE.DATA$ = XSS$RELEASE.DATA.PTR$;  /*N*/

  16775  2 000565   200275 471500                    LDP1    SFPT$,,AUTO
         2 000566   100002 236100                    LDQ     2,,PR1
         2 000567   000002 756100                    STQ     2,,PR0

     1145    16776    2               IF XSS$RELEASE.RESULT = 0 THEN

  16776  2 000570   200275 471500                    LDP1    SFPT$,,AUTO
         2 000571   100000 236100                    LDQ     0,,PR1
         2 000572   000777 316007                    CANQ    511,DL
         2 000573   000577 601000 2                  TNZ     s:16781

     1146    16777                        /* release accepted */
     1147    16778    2                   VBLK.EVENT = %XSP_PEV_SRELCFP;

  16778  2 000574   000051 236007                    LDQ     41,DL
         2 000575   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000576   001035 710000 2                  TRA     s:16857

     1148    16779    2               ELSE
     1149    16780                        /* release rejected by Session-peer or Presentation-peer */
     1150    16781    2                   VBLK.EVENT = %XSP_PEV_SRELCFN;

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:220  
  16781  2 000577   000053 236007                    LDQ     43,DL
         2 000600   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000601   001035 710000 2                  TRA     s:16857

     1151    16782    2           CASE( %XSS_FNC_SRSXIND#);

     1152    16783                    /* should be an RS PPDU from Presentation-peer */
     1153    16784    2               CALL XSP$DECODE( VBLK, SFPT$)

  16784  2 000602   200275 633500                    EPPR3   SFPT$,,AUTO
         2 000603   200307 453500                    STP3    TMPCTXT+9,,AUTO
         2 000604   200022 634500                    EPPR4   VBLK,,AUTO
         2 000605   200306 454500                    STP4    TMPCTXT+8,,AUTO
         2 000606   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000607   000000 631400 3                  EPPR1   0
         2 000610   000000 701000 xent               TSX1    XSP$DECODE
         2 000611   000613 702000 2                  TSX2    s:16786
         2 000612   000615 710000 2                  TRA     s:16788

     1154    16785    3               WHENALTRETURN DO;

     1155    16786    3                   VBLK.PPDUERR = 1;

  16786  2 000613   001000 236007                    LDQ     512,DL
         2 000614   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1156    16787    3                   END;

     1157    16788    2               VBLK.EVENT = %XSP_PEV_RS;

  16788  2 000615   000010 236007                    LDQ     8,DL
         2 000616   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000617   001035 710000 2                  TRA     s:16857

     1158    16789    2           CASE( %XSS_FNC_SRSXCNF#);

     1159    16790                    /* should be an RSA PPDU from Presentation-peer */
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:221  
     1160    16791    2               CALL XSP$DECODE( VBLK, SFPT$)

  16791  2 000620   200275 633500                    EPPR3   SFPT$,,AUTO
         2 000621   200307 453500                    STP3    TMPCTXT+9,,AUTO
         2 000622   200022 634500                    EPPR4   VBLK,,AUTO
         2 000623   200306 454500                    STP4    TMPCTXT+8,,AUTO
         2 000624   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000625   000000 631400 3                  EPPR1   0
         2 000626   000000 701000 xent               TSX1    XSP$DECODE
         2 000627   000631 702000 2                  TSX2    s:16793
         2 000630   000633 710000 2                  TRA     s:16795

     1161    16792    3               WHENALTRETURN DO;

     1162    16793    3                   VBLK.PPDUERR = 1;

  16793  2 000631   001000 236007                    LDQ     512,DL
         2 000632   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1163    16794    3                   END;

     1164    16795    2               VBLK.EVENT = %XSP_PEV_RSA;

  16795  2 000633   000011 236007                    LDQ     9,DL
         2 000634   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000635   001035 710000 2                  TRA     s:16857

     1165    16796    2           CASE( %XSS_FNC_SSMAIND#);

     1166    16797    2               XSP$SYNC_MAJOR = XSP_SYNC_MAJOR;

  16797  2 000636   000100 100400                    MLR     fill='000'O
         2 000637   000000 000024 xsym               ADSC9   XSP_SYNC_MAJOR           cn=0,n=20
         2 000640   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1167    16798    2               XSP$SYNC_MAJOR.FNC = %XSP_FNC_PSMAIND#;

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:222  
  16798  2 000641   054000 236003                    LDQ     22528,DU
         2 000642   000000 552140                    STBQ    0,'40'O,PR0

     1168    16799    2               XSP$SYNC_MAJOR.DATA$ = XSS$SYNC_MAJOR.DATA.PTR$;  /*N*/

  16799  2 000643   200275 471500                    LDP1    SFPT$,,AUTO
         2 000644   100002 236100                    LDQ     2,,PR1
         2 000645   000002 756100                    STQ     2,,PR0

     1169    16800    2               XSP$SYNC_MAJOR.SERNUM = XSS$SYNC_MAJOR.SERNUM;

  16800  2 000646   200275 471500                    LDP1    SFPT$,,AUTO
         2 000647   100004 235100                    LDA     4,,PR1
         2 000650   000004 755100                    STA     4,,PR0

     1170    16801    2               VBLK.EVENT = %XSP_PEV_SSMAIND;

  16801  2 000651   000061 236007                    LDQ     49,DL
         2 000652   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000653   001035 710000 2                  TRA     s:16857

     1171    16802    2           CASE( %XSS_FNC_SSMACNF#);

     1172    16803    2               XSP$SYNC_MAJOR = XSP_SYNC_MAJOR;

  16803  2 000654   000100 100400                    MLR     fill='000'O
         2 000655   000000 000024 xsym               ADSC9   XSP_SYNC_MAJOR           cn=0,n=20
         2 000656   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1173    16804    2               XSP$SYNC_MAJOR.FNC = %XSP_FNC_PSMACNF#;

  16804  2 000657   056000 236003                    LDQ     23552,DU
         2 000660   000000 552140                    STBQ    0,'40'O,PR0

     1174    16805    2               XSP$SYNC_MAJOR.DATA$ = XSS$SYNC_MAJOR.DATA.PTR$;  /*N*/

  16805  2 000661   200275 471500                    LDP1    SFPT$,,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:223  
         2 000662   100002 236100                    LDQ     2,,PR1
         2 000663   000002 756100                    STQ     2,,PR0

     1175    16806    2               XSP$SYNC_MAJOR.SERNUM = XSS$SYNC_MAJOR.SERNUM;

  16806  2 000664   200275 471500                    LDP1    SFPT$,,AUTO
         2 000665   100004 235100                    LDA     4,,PR1
         2 000666   000004 755100                    STA     4,,PR0

     1176    16807    2               VBLK.EVENT = %XSP_PEV_SSMACNF;

  16807  2 000667   000063 236007                    LDQ     51,DL
         2 000670   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000671   001035 710000 2                  TRA     s:16857

     1177    16808    2           CASE( %XSS_FNC_SSMIIND#);

     1178    16809    2               XSP$SYNC_MINOR = XSP_SYNC_MINOR;

  16809  2 000672   000100 100400                    MLR     fill='000'O
         2 000673   000000 000024 xsym               ADSC9   XSP_SYNC_MINOR           cn=0,n=20
         2 000674   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1179    16810    2               XSP$SYNC_MINOR.FNC = %XSP_FNC_PSMIIND#;

  16810  2 000675   060000 236003                    LDQ     24576,DU
         2 000676   000000 552140                    STBQ    0,'40'O,PR0

     1180    16811    2               XSP$SYNC_MINOR.TYPE = XSS$SYNC_MINOR.TYPE;

  16811  2 000677   200275 471500                    LDP1    SFPT$,,AUTO
         2 000700   100000 236100                    LDQ     0,,PR1
         2 000701   000000 552110                    STBQ    0,'10'O,PR0

     1181    16812    2               XSP$SYNC_MINOR.DATA$ = XSS$SYNC_MINOR.DATA.PTR$;  /*N*/

  16812  2 000702   200275 471500                    LDP1    SFPT$,,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:224  
         2 000703   100002 236100                    LDQ     2,,PR1
         2 000704   000002 756100                    STQ     2,,PR0

     1182    16813    2               XSP$SYNC_MINOR.SERNUM = XSS$SYNC_MINOR.SERNUM;

  16813  2 000705   200275 471500                    LDP1    SFPT$,,AUTO
         2 000706   100004 235100                    LDA     4,,PR1
         2 000707   000004 755100                    STA     4,,PR0

     1183    16814    2               VBLK.EVENT = %XSP_PEV_SSMIIND;

  16814  2 000710   000065 236007                    LDQ     53,DL
         2 000711   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000712   001035 710000 2                  TRA     s:16857

     1184    16815    2           CASE( %XSS_FNC_SSMICNF#);

     1185    16816    2               XSP$SYNC_MINOR = XSP_SYNC_MINOR;

  16816  2 000713   000100 100400                    MLR     fill='000'O
         2 000714   000000 000024 xsym               ADSC9   XSP_SYNC_MINOR           cn=0,n=20
         2 000715   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1186    16817    2               XSP$SYNC_MINOR.FNC = %XSP_FNC_PSMICNF#;

  16817  2 000716   062000 236003                    LDQ     25600,DU
         2 000717   000000 552140                    STBQ    0,'40'O,PR0

     1187    16818    2               XSP$SYNC_MINOR.TYPE = XSS$SYNC_MINOR.TYPE;

  16818  2 000720   200275 471500                    LDP1    SFPT$,,AUTO
         2 000721   100000 236100                    LDQ     0,,PR1
         2 000722   000000 552110                    STBQ    0,'10'O,PR0

     1188    16819    2               XSP$SYNC_MINOR.DATA$ = XSS$SYNC_MINOR.DATA.PTR$;  /*N*/

  16819  2 000723   200275 471500                    LDP1    SFPT$,,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:225  
         2 000724   100002 236100                    LDQ     2,,PR1
         2 000725   000002 756100                    STQ     2,,PR0

     1189    16820    2               XSP$SYNC_MINOR.SERNUM = XSS$SYNC_MINOR.SERNUM;

  16820  2 000726   200275 471500                    LDP1    SFPT$,,AUTO
         2 000727   100004 235100                    LDA     4,,PR1
         2 000730   000004 755100                    STA     4,,PR0

     1190    16821    2               VBLK.EVENT = %XSP_PEV_SSMICNF;

  16821  2 000731   000067 236007                    LDQ     55,DL
         2 000732   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000733   001035 710000 2                  TRA     s:16857

     1191    16822    2           CASE( %XSS_FNC_STKGIND#);

     1192    16823    2               XSP$TOKEN_GIVE = XSP_TOKEN_GIVE;

  16823  2 000734   000100 100400                    MLR     fill='000'O
         2 000735   000000 000010 xsym               ADSC9   XSP_TOKEN_GIVE           cn=0,n=8
         2 000736   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

     1193    16824    2               XSP$TOKEN_GIVE.FNC = %XSP_FNC_PTKGIND#;

  16824  2 000737   064000 236003                    LDQ     26624,DU
         2 000740   000000 552140                    STBQ    0,'40'O,PR0

     1194    16825    2               XSP$TOKEN_GIVE.TOKENS = XSS$TOKEN_GIVE.TOKENS;

  16825  2 000741   200275 471500                    LDP1    SFPT$,,AUTO
         2 000742   100000 236100                    LDQ     0,,PR1
         2 000743   000000 552104                    STBQ    0,'04'O,PR0

     1195    16826    2               VBLK.EVENT = %XSP_PEV_STKGIND;

  16826  2 000744   000043 236007                    LDQ     35,DL
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:226  
         2 000745   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000746   001035 710000 2                  TRA     s:16857

     1196    16827    2           CASE( %XSS_FNC_STKPIND#);

     1197    16828    2               XSP$TOKEN_PLEASE = XSP_TOKEN_PLEASE;

  16828  2 000747   000100 100400                    MLR     fill='000'O
         2 000750   000000 000014 xsym               ADSC9   XSP_TOKEN_PLEASE         cn=0,n=12
         2 000751   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

     1198    16829    2               XSP$TOKEN_PLEASE.FNC = %XSP_FNC_PTKPIND#;

  16829  2 000752   066000 236003                    LDQ     27648,DU
         2 000753   000000 552140                    STBQ    0,'40'O,PR0

     1199    16830    2               XSP$TOKEN_PLEASE.TOKENS = XSS$TOKEN_PLEASE.TOKENS;

  16830  2 000754   200275 471500                    LDP1    SFPT$,,AUTO
         2 000755   100000 236100                    LDQ     0,,PR1
         2 000756   000000 552104                    STBQ    0,'04'O,PR0

     1200    16831    2               XSP$TOKEN_PLEASE.DATA$ = XSS$TOKEN_PLEASE.DATA.PTR$;  /*N*/

  16831  2 000757   200275 471500                    LDP1    SFPT$,,AUTO
         2 000760   100002 236100                    LDQ     2,,PR1
         2 000761   000002 756100                    STQ     2,,PR0

     1201    16832    2               VBLK.EVENT = %XSP_PEV_STKPIND;

  16832  2 000762   000045 236007                    LDQ     37,DL
         2 000763   200030 552104                    STBQ    VBLK+6,'04'O,AUTO
         2 000764   001035 710000 2                  TRA     s:16857

     1202    16833    2           CASE( %XSS_FNC_STYDIND#);

     1203    16834                    /* should be one of AC, ACA, or TTD PPDU from Presentation-peer */
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:227  
     1204    16835    2               XSP_TMPCTXT$ = ADDR( TMPCTXT);

  16835  2 000765   200276 633500                    EPPR3   TMPCTXT,,AUTO
         2 000766   000025 453400 1                  STP3    XSP_TMPCTXT$

     1205    16836    2               TMPCTXT(0) = 0;

  16836  2 000767   200276 450100                    STZ     TMPCTXT,,AUTO

     1206    16837    2               CALL XSP$DECODE( VBLK, SFPT$)

  16837  2 000770   200275 634500                    EPPR4   SFPT$,,AUTO
         2 000771   200307 454500                    STP4    TMPCTXT+9,,AUTO
         2 000772   200022 635500                    EPPR5   VBLK,,AUTO
         2 000773   200306 455500                    STP5    TMPCTXT+8,,AUTO
         2 000774   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 000775   000000 631400 3                  EPPR1   0
         2 000776   000000 701000 xent               TSX1    XSP$DECODE
         2 000777   001001 702000 2                  TSX2    s:16839
         2 001000   001003 710000 2                  TRA     s:16840

     1207    16838    3               WHENALTRETURN DO;

     1208    16839    3                   VBLK.PPDUERR = 1;

  16839  2 001001   001000 236007                    LDQ     512,DL
         2 001002   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1209    16840    3                   END;

  16840  2 001003   001035 710000 2                  TRA     s:16857

     1210    16841                    /* VBLK.EVENT filled in by XSP$DECODE */
     1211    16842    2           CASE( %XSS_FNC_SUABIND#);

     1212    16843                    /* should be ARP or ARU PPDU from Presentation-peer */
     1213    16844    2               CALL XSP$DECODE( VBLK, SFPT$)
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:228  

  16844  2 001004   200275 633500                    EPPR3   SFPT$,,AUTO
         2 001005   200307 453500                    STP3    TMPCTXT+9,,AUTO
         2 001006   200022 634500                    EPPR4   VBLK,,AUTO
         2 001007   200306 454500                    STP4    TMPCTXT+8,,AUTO
         2 001010   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 001011   000000 631400 3                  EPPR1   0
         2 001012   000000 701000 xent               TSX1    XSP$DECODE
         2 001013   001015 702000 2                  TSX2    s:16846
         2 001014   001017 710000 2                  TRA     s:16847

     1214    16845    3               WHENALTRETURN DO;

     1215    16846    3                   VBLK.PPDUERR = 1;

  16846  2 001015   001000 236007                    LDQ     512,DL
         2 001016   200030 552110                    STBQ    VBLK+6,'10'O,AUTO

     1216    16847    3                   END;

  16847  2 001017   001035 710000 2                  TRA     s:16857

     1217    16848                    /* VBLK.EVENT filled in by XSP$DECODE */
     1218    16849    2           CASE( %XSS_FNC_SUERIND#);

     1219    16850                    /* Session-peer reporting an exception */
     1220    16851    2               XSP$U_EXCEPTION_REPORT = XSP_U_EXCEPTION_REPORT;

  16851  2 001020   000100 100400                    MLR     fill='000'O
         2 001021   000000 000014 xsym               ADSC9   XSP_U_EXCEPTION_REPORT   cn=0,n=12
         2 001022   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

     1221    16852    2               XSP$U_EXCEPTION_REPORT.FNC = %XSP_FNC_PUERIND#;

  16852  2 001023   074000 236003                    LDQ     30720,DU
         2 001024   000000 552140                    STBQ    0,'40'O,PR0

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:229  
     1222    16853    2               XSP$U_EXCEPTION_REPORT.REASON = XSS$U_EXCEPTION_REPORT.REASON;

  16853  2 001025   200275 471500                    LDP1    SFPT$,,AUTO
         2 001026   100000 236100                    LDQ     0,,PR1
         2 001027   000000 552110                    STBQ    0,'10'O,PR0

     1223    16854    2               XSP$U_EXCEPTION_REPORT.DATA$ = XSS$U_EXCEPTION_REPORT.DATA.PTR$;  /*N*/

  16854  2 001030   200275 471500                    LDP1    SFPT$,,AUTO
         2 001031   100002 236100                    LDQ     2,,PR1
         2 001032   000002 756100                    STQ     2,,PR0

     1224    16855    2               VBLK.EVENT = %XSP_PEV_SUERIND;

  16855  2 001033   000071 236007                    LDQ     57,DL
         2 001034   200030 552104                    STBQ    VBLK+6,'04'O,AUTO

     1225    16856    2           END;

     1226    16857    1       XSP$GENERIC.PCID = XSS$GENERIC.SCID;

  16857  2 001035   200275 470500                    LDP0    SFPT$,,AUTO
         2 001036   200274 471500                    LDP1    PFPT$,,AUTO
         2 001037   000000 236100                    LDQ     0,,PR0
         2 001040   100000 552120                    STBQ    0,'20'O,PR1

     1227    16858    2       IF XSP_DATANUM > 0 THEN DO;

  16858  2 001041   000000 235000 1                  LDA     XSP_DATANUM
         2 001042   001124 604400 2                  TMOZ    s:16871

     1228    16859    2           CALL XSS$GETMEM( BLKX, AFPT$, XSP_DATANUM * SIZEC( XSP_ASN1_FPT));

  16859  2 001043   000000 236000 1                  LDQ     XSP_DATANUM
         2 001044   000070 402007                    MPY     56,DL
         2 001045   200306 756100                    STQ     TMPCTXT+8,,AUTO
         2 001046   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:230  
         2 001047   200311 450500                    STP0    TMPCTXT+11,,AUTO
         2 001050   200267 633500                    EPPR3   AFPT$,,AUTO
         2 001051   200310 453500                    STP3    TMPCTXT+10,,AUTO
         2 001052   200270 634500                    EPPR4   BLKX,,AUTO
         2 001053   200307 454500                    STP4    TMPCTXT+9,,AUTO
         2 001054   200307 630500                    EPPR0   TMPCTXT+9,,AUTO
         2 001055   000003 631400 3                  EPPR1   3
         2 001056   000000 701000 xent               TSX1    XSS$GETMEM
         2 001057   000000 011000                    NOP     0

     1229    16860    2           XSP$GENERIC.DATA$ = AFPT$;

  16860  2 001060   200267 236100                    LDQ     AFPT$,,AUTO
         2 001061   200274 470500                    LDP0    PFPT$,,AUTO
         2 001062   000002 756100                    STQ     2,,PR0

     1230    16861    3           DO I = 1 TO XSP_DATANUM;

  16861  2 001063   000001 235007                    LDA     1,DL
         2 001064   200272 755100                    STA     I,,AUTO
         2 001065   001121 710000 2                  TRA     s:16869+1

     1231    16862    3               AFPT = XSP_ASN1_FPT;

  16862  2 001066   200267 470500                    LDP0    AFPT$,,AUTO
         2 001067   000100 100400                    MLR     fill='000'O
         2 001070   000000 000070 0                  ADSC9   XSP_ASN1_FPT             cn=0,n=56
         2 001071   000000 000070                    ADSC9   0,,PR0                   cn=0,n=56

     1232    16863    3               AFPT.BUF$ = XSP_DATABUF$( I-1);

  16863  2 001072   200272 720100                    LXL0    I,,AUTO
         2 001073   000000 236010 1                  LDQ     XSP_DATANUM,X0
         2 001074   200267 470500                    LDP0    AFPT$,,AUTO
         2 001075   000001 756100                    STQ     1,,PR0

     1233    16864    3               AFPT.NXTX = XSP_DATASIZE( I-1);
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:231  

  16864  2 001076   200267 470500                    LDP0    AFPT$,,AUTO
         2 001077   000012 235010 1                  LDA     XSP_DATACTXT+1,X0
         2 001100   000014 755100                    STA     12,,PR0

     1234    16865    3               AFPT.CTXTID = XSP_DATACTXT( I-1);

  16865  2 001101   200272 235100                    LDA     I,,AUTO
         2 001102   200267 470500                    LDP0    AFPT$,,AUTO
         2 001103   000100 101405                    MRL     fill='000'O
         2 001104   000010 600001 1                  ADSC9   XSP_DATABUF$+7,A         cn=3,n=1
         2 001105   000005 000004                    ADSC9   5,,PR0                   cn=0,n=4

     1235    16866    3               IF I < XSP_DATANUM THEN

  16866  2 001106   200272 236100                    LDQ     I,,AUTO
         2 001107   000000 116000 1                  CMPQ    XSP_DATANUM
         2 001110   001115 605000 2                  TPL     s:16868

     1236    16867    3                   AFPT.LINK$ = PINCRC( AFPT$, SIZEC( XSP_ASN1_FPT));

  16867  2 001111   200267 236100                    LDQ     AFPT$,,AUTO
         2 001112   000016 036003                    ADLQ    14,DU
         2 001113   200267 470500                    LDP0    AFPT$,,AUTO
         2 001114   000004 756100                    STQ     4,,PR0

     1237    16868    3               AFPT$ = AFPT.LINK$;

  16868  2 001115   200267 470500                    LDP0    AFPT$,,AUTO
         2 001116   000004 236100                    LDQ     4,,PR0
         2 001117   200267 756100                    STQ     AFPT$,,AUTO

     1238    16869    3               END;

  16869  2 001120   200272 054100                    AOS     I,,AUTO
         2 001121   200272 236100                    LDQ     I,,AUTO
         2 001122   000000 116000 1                  CMPQ    XSP_DATANUM
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:232  
         2 001123   001066 604400 2                  TMOZ    s:16862

     1239    16870    2           END;

     1240    16871    1       ABORTING = %FALSE;

  16871  2 001124   200266 450100                    STZ     ABORTING,,AUTO

     1241    16872    1       CALL XSP$MACHINE( VBLK)

  16872  2 001125   200022 630500                    EPPR0   VBLK,,AUTO
         2 001126   200306 450500                    STP0    TMPCTXT+8,,AUTO
         2 001127   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
         2 001130   000001 631400 3                  EPPR1   1
         2 001131   000000 701000 xent               TSX1    XSP$MACHINE
         2 001132   001134 702000 2                  TSX2    s:16874
         2 001133   001136 710000 2                  TRA     s:16876

     1242    16873    2       WHENALTRETURN DO;

     1243    16874    2           ABORTING = %TRUE;  /* connection died or protocol error */

  16874  2 001134   400000 236003                    LDQ     -131072,DU
         2 001135   200266 756100                    STQ     ABORTING,,AUTO

     1244    16875    2           END;

     1245    16876    1       IF XSP_DATANUM > 0 THEN

  16876  2 001136   000000 235000 1                  LDA     XSP_DATANUM
         2 001137   001146 604400 2                  TMOZ    s:16878

     1246    16877    1           CALL XSS$RELMEM( BLKX);

  16877  2 001140   200270 630500                    EPPR0   BLKX,,AUTO
         2 001141   200306 450500                    STP0    TMPCTXT+8,,AUTO
         2 001142   200306 630500                    EPPR0   TMPCTXT+8,,AUTO
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:233  
         2 001143   000001 631400 3                  EPPR1   1
         2 001144   000000 701000 xent               TSX1    XSS$RELMEM
         2 001145   000000 011000                    NOP     0

     1247    16878    1       IF ABORTING THEN

  16878  2 001146   200266 234100                    SZN     ABORTING,,AUTO
         2 001147   001151 605000 2                  TPL     s:16880

     1248    16879    1           ALTRETURN;

  16879  2 001150   000000 702200 xent               TSX2  ! X66_AALT

     1249    16880    1       RETURN;

  16880  2 001151   000000 702200 xent               TSX2  ! X66_ARET

XSP_ASN1_FPT
 Sect OctLoc
   0     000   000000 006014   000000 006014   000000 000000   000000 000000    ................
   0     004   000000 006014   000000 000000   000000 000000   000000 000000    ................
   0     010   400000 000000   000000 000000   000000 000000   000000 000000    ................
   0     014   000000 000000   000000 006014                                    ........

XSP_F$NOSCID
 Sect OctLoc
   0     016   302320 001427                                                    ....

XSP_DATABUF$
 Sect OctLoc
   1     001   ****** ******   ****** ******   ****** ******   ****** ******    ................

XSP_DATASIZE
 Sect OctLoc
   1     013   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:234  
 Sect OctLoc
   3     000   000002 000000   000001 000000   000016 006000   000003 000000    ................
     1250    16881
     1251    16882    1       END XSP$SRECV;

PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:235  
--  Include file information  --

   XSC_PERR_C.:XSA1TOU  is referenced.
   UM_CP6.:E05OU  is referenced.
   XSP_ASN1_M.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   XSP_INTERNAL_M.:XSA1TOU  is referenced.
   XSP_INTERNAL_E.:XSA1TOU  is referenced.
   XSP_PRESENTATION_M.:XSA1TOU  is referenced.
   XSP_PRESENTATION_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
      No diagnostics issued in procedure XSP$SRECV.
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:236  

 **** Variables and constants ****

  ****  Section 000 RoData XSP$SRECV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(504)   r     1 XSP_ASN1_FPT              16-0-0/w STRC        r     1 XSP_F$NOSCID

  ****  Section 001  Data  XSP$SRECV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w PTR         r     1 XSP_DATABUF$(0:7)
    11-0-0/c UBIN(9)     r     1 XSP_DATACTXT(0:7)
     0-0-0/w SBIN        r     1 XSP_DATANUM
    13-0-0/w SBIN        r     1 XSP_DATASIZE(0:7)
    23-0-0/w PTR         r     1 XSP_DSTADDR$              24-0-0/w PTR         r     1 XSP_SRCADDR$
    25-0-0/w PTR         r     1 XSP_TMPCTXT$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @SFPT                    266-0-0/b BIT         r     1 ABORTING
   267-0-0/w PTR         r     1 AFPT$                    270-0-0/h UBIN(18)    r     1 BLKX
   271-0-0/w PTR         r     1 CTX$                     152-0-0/w STRC(2718)  r     1 DSTADDR
   272-0-0/w SBIN        r     1 I                        273-0-0/w SBIN        r     1 PCID
     4-0-0/w STRC(504)   r     1 PFPT                     274-0-0/w PTR         r     1 PFPT$
    *0-0-0/d STRC(504)   r     1 SFPT                     275-0-0/w PTR         r     1 SFPT$
    36-0-0/w STRC(2718)  r     1 SRCADDR
   276-0-0/w SBIN        r     1 TMPCTXT(0:7)
    22-0-0/d STRC(396)   r     1 VBLK

  ****  SYMREF variables  ****
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:237  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 XSP_ACTIVITY_DISCARD       0-0-0/w STRC(180)   r     1 XSP_ACTIVITY_END
     0-0-0/w STRC(72)    r     1 XSP_ACTIVITY_INTERRUPT
     0-0-0/w STRC(468)   r     1 XSP_ACTIVITY_RESUME        0-0-0/w STRC(216)   r     1 XSP_ACTIVITY_START
     0-0-0/w STRC(72)    r     1 XSP_CONTROL_GIVE           0-0-0/w STRC(72)    r     1 XSP_P_ABORT
     0-0-0/w STRC(72)    r     1 XSP_P_EXCEPTION_REPORT
     0-0-0/w STRC(108)   r     1 XSP_RELEASE                0-0-0/w STRC(180)   r     1 XSP_SYNC_MAJOR
     0-0-0/w STRC(180)   r     1 XSP_SYNC_MINOR             0-0-0/w STRC(72)    r     1 XSP_TOKEN_GIVE
     0-0-0/w STRC(108)   r     1 XSP_TOKEN_PLEASE
     0-0-0/w STRC(108)   r     1 XSP_U_EXCEPTION_REPORT
     0-0-0/d STRC(396)   r     1 XSP_VBLK                   0-0-0/w PTR         r     1 XSS_CCB$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(504)   r     1 AFPT                       0-0-0/w PTR         r     1 CCB$(0:0)
     0-0-0/w STRC(468)   r     1 PCTX                       0-0-0/w STRC(504)   r     1 XSC$CCB
     0-0-0/w STRC(72)    r     1 XSP$ACTIVITY_DISCARD       0-0-0/w STRC(180)   r     1 XSP$ACTIVITY_END
     0-0-0/w STRC(72)    r     1 XSP$ACTIVITY_INTERRUPT
     0-0-0/w STRC(468)   r     1 XSP$ACTIVITY_RESUME        0-0-0/w STRC(216)   r     1 XSP$ACTIVITY_START
     0-0-0/w STRC(72)    r     1 XSP$CONTROL_GIVE           0-0-0/w STRC(504)   r     1 XSP$GENERIC
     0-0-0/w STRC(72)    r     1 XSP$P_ABORT
     0-0-0/w STRC(72)    r     1 XSP$P_EXCEPTION_REPORT
     0-0-0/w STRC(108)   r     1 XSP$RELEASE                0-0-0/w STRC(180)   r     1 XSP$SYNC_MAJOR
     0-0-0/w STRC(180)   r     1 XSP$SYNC_MINOR             0-0-0/w STRC(72)    r     1 XSP$TOKEN_GIVE
     0-0-0/w STRC(108)   r     1 XSP$TOKEN_PLEASE
     0-0-0/w STRC(108)   r     1 XSP$U_EXCEPTION_REPORT
     0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_DISCARD       0-0-0/d STRC(180)   r     1 XSS$ACTIVITY_END
     0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_INTERRUPT
     0-0-0/d STRC(468)   r     1 XSS$ACTIVITY_RESUME        0-0-0/d STRC(216)   r     1 XSS$ACTIVITY_START
     0-0-0/d STRC(504)   r     1 XSS$GENERIC                0-0-0/w STRC(72)    r     1 XSS$P_ABORT
     0-0-0/w STRC(72)    r     1 XSS$P_EXCEPTION_REPORT
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:238  
     0-0-0/d STRC(144)   r     1 XSS$RELEASE                0-0-0/d STRC(180)   r     1 XSS$SYNC_MAJOR
     0-0-0/d STRC(180)   r     1 XSS$SYNC_MINOR             0-0-0/w STRC(72)    r     1 XSS$TOKEN_GIVE
     0-0-0/d STRC(144)   r     1 XSS$TOKEN_PLEASE
     0-0-0/d STRC(144)   r     1 XSS$U_EXCEPTION_REPORT


   Procedure XSP$SRECV requires 618 words for executable code.
   Procedure XSP$SRECV requires 202 words of local(AUTO) storage.

    No errors detected in file XSP$DECODE.:XSA1TSI    .
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:239  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:240  
          MINI XREF LISTING

ABORTING
     16612**DCL     16871<<ASSIGN  16874<<ASSIGN  16878>>IF
AFPT
     15606**DCL     16862<<ASSIGN
AFPT.BUF$
     15610**DCL     16863<<ASSIGN
AFPT.C0
     15612**DCL     15612--REDEF
AFPT.CTXTID
     15611**DCL     16865<<ASSIGN
AFPT.DAT$
     15614**DCL     15614--REDEF
AFPT.LINK$
     15611**DCL     16867<<ASSIGN  16868>>ASSIGN
AFPT.N0
     15613**DCL     15613--REDEF
AFPT.NXTX
     15613**DCL     16864<<ASSIGN
AFPT.R0
     15611**DCL     15612--REDEF
AFPT$
     16613**DCL     15606--IMP-PTR 16859<>CALL    16860>>ASSIGN  16862>>ASSIGN  16863>>ASSIGN  16864>>ASSIGN
     16865>>ASSIGN  16867>>ASSIGN  16867>>ASSIGN  16868<<ASSIGN  16868>>ASSIGN
BLKX
     16614**DCL     16859<>CALL    16877<>CALL
CCB$
     16615**DCL     16640>>ASSIGN
CTX$
     16616**DCL     12781--IMP-PTR 16633<>CALL    16636<>CALL    16640>>ASSIGN  16648>>ASSIGN
DSTADDR
     14667**DCL     16717--ASSIGN  16728--ASSIGN
DSTADDR.NSAP.ADDRESS_N
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:241  
     14928**DCL     14929--REDEF
I
     16617**DCL     16861<<DOINDEX 16863>>ASSIGN  16864>>ASSIGN  16865>>ASSIGN  16866>>IF
PCID
     16618**DCL     16632<<ASSIGN  16633<>CALL    16636<>CALL    16640>>ASSIGN
PCTX.ACTDCSMASK
     12867**DCL     12870--REDEF
PCTX.CURDCSMASK
     12852**DCL     12855--REDEF
PCTX.ENTRY$
     12886**DCL     16640<<ASSIGN
PCTX.HISTZ
     12910**DCL     12911--REDEF
PCTX.INIDCSMASK
     12860**DCL     12863--REDEF
PFPT
      8351**DCL     16646--ASSIGN
PFPT.ERRDEF
      8397**DCL      8417--REDEF
PFPT$
     16619**DCL      8448--IMP-PTR  8544--IMP-PTR  8602--IMP-PTR  8667--IMP-PTR  8725--IMP-PTR  8816--IMP-PTR
      8891--IMP-PTR  8952--IMP-PTR  9010--IMP-PTR  9155--IMP-PTR  9249--IMP-PTR  9307--IMP-PTR  9365--IMP-PTR
      9423--IMP-PTR  9481--IMP-PTR  9540--IMP-PTR  9645--IMP-PTR  9711--IMP-PTR  9777--IMP-PTR  9873--IMP-PTR
      9970--IMP-PTR 10028--IMP-PTR 10086--IMP-PTR 16646<<ASSIGN  16649>>ASSIGN  16655>>ASSIGN  16656>>ASSIGN
     16657>>ASSIGN  16660>>ASSIGN  16661>>ASSIGN  16662>>ASSIGN  16665>>ASSIGN  16666>>ASSIGN  16667>>ASSIGN
     16668>>ASSIGN  16671>>ASSIGN  16672>>ASSIGN  16673>>ASSIGN  16674>>ASSIGN  16677>>ASSIGN  16678>>ASSIGN
     16679>>ASSIGN  16682>>ASSIGN  16683>>ASSIGN  16684>>ASSIGN  16687>>ASSIGN  16688>>ASSIGN  16689>>ASSIGN
     16690>>ASSIGN  16691>>ASSIGN  16692>>ASSIGN  16695>>ASSIGN  16696>>ASSIGN  16697>>ASSIGN  16698>>ASSIGN
     16737>>ASSIGN  16738>>ASSIGN  16756>>ASSIGN  16757>>ASSIGN  16758>>ASSIGN  16762>>ASSIGN  16763>>ASSIGN
     16764>>ASSIGN  16767>>ASSIGN  16768>>ASSIGN  16769>>ASSIGN  16772>>ASSIGN  16773>>ASSIGN  16774>>ASSIGN
     16775>>ASSIGN  16797>>ASSIGN  16798>>ASSIGN  16799>>ASSIGN  16800>>ASSIGN  16803>>ASSIGN  16804>>ASSIGN
     16805>>ASSIGN  16806>>ASSIGN  16809>>ASSIGN  16810>>ASSIGN  16811>>ASSIGN  16812>>ASSIGN  16813>>ASSIGN
     16816>>ASSIGN  16817>>ASSIGN  16818>>ASSIGN  16819>>ASSIGN  16820>>ASSIGN  16823>>ASSIGN  16824>>ASSIGN
     16825>>ASSIGN  16828>>ASSIGN  16829>>ASSIGN  16830>>ASSIGN  16831>>ASSIGN  16851>>ASSIGN  16852>>ASSIGN
     16853>>ASSIGN  16854>>ASSIGN  16857>>ASSIGN  16860>>ASSIGN
SFPT
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:242  
      6620**DCL        15--PROC    16630--ASSIGN
SFPT.ERRDEF
      6674**DCL      6694--REDEF
SFPT$
     16620**DCL      3242--IMP-PTR  3388--IMP-PTR  3486--IMP-PTR  3637--IMP-PTR  3735--IMP-PTR  3961--IMP-PTR
      4124--IMP-PTR  4270--IMP-PTR  4593--IMP-PTR  4717--IMP-PTR  4861--IMP-PTR  5005--IMP-PTR  5091--IMP-PTR
      5177--IMP-PTR  5329--IMP-PTR  5542--IMP-PTR  5701--IMP-PTR  5860--IMP-PTR  5990--IMP-PTR  6182--IMP-PTR
      6326--IMP-PTR  6470--IMP-PTR 16630<<ASSIGN  16631>>IF      16632>>ASSIGN  16650>>ASSIGN  16653>>DOCASE
     16657>>ASSIGN  16662>>ASSIGN  16667>>ASSIGN  16668>>ASSIGN  16673>>ASSIGN  16674>>ASSIGN  16679>>ASSIGN
     16684>>ASSIGN  16689>>ASSIGN  16690>>ASSIGN  16691>>ASSIGN  16692>>ASSIGN  16697>>ASSIGN  16698>>ASSIGN
     16702<>CALL    16709<>CALL    16720<>CALL    16731<>CALL    16742<>CALL    16749<>CALL    16758>>ASSIGN
     16764>>ASSIGN  16769>>ASSIGN  16774>>ASSIGN  16775>>ASSIGN  16776>>IF      16784<>CALL    16791<>CALL
     16799>>ASSIGN  16800>>ASSIGN  16805>>ASSIGN  16806>>ASSIGN  16811>>ASSIGN  16812>>ASSIGN  16813>>ASSIGN
     16818>>ASSIGN  16819>>ASSIGN  16820>>ASSIGN  16825>>ASSIGN  16830>>ASSIGN  16831>>ASSIGN  16837<>CALL
     16844<>CALL    16853>>ASSIGN  16854>>ASSIGN  16857>>ASSIGN
SRCADDR
     14384**DCL     16716--ASSIGN  16727--ASSIGN
SRCADDR.NSAP.ADDRESS_N
     14645**DCL     14646--REDEF
TMPCTXT
     16621**DCL     16718--ASSIGN  16719<<ASSIGN  16729--ASSIGN  16730<<ASSIGN  16835--ASSIGN  16836<<ASSIGN
VBLK
     12936**DCL     16647<<ASSIGN  16702<>CALL    16709<>CALL    16720<>CALL    16731<>CALL    16742<>CALL
     16749<>CALL    16784<>CALL    16791<>CALL    16837<>CALL    16844<>CALL    16872<>CALL
VBLK.CTX$
     12946**DCL     16648<<ASSIGN
VBLK.DATA
     13010**DCL     16650<<ASSIGN
VBLK.DATMASK
     13052**DCL     13055--REDEF
VBLK.DEFMASK
     13036**DCL     13039--REDEF
VBLK.DELMASK
     13044**DCL     13047--REDEF
VBLK.EVENT
     13031**DCL     16658<<ASSIGN  16663<<ASSIGN  16669<<ASSIGN  16675<<ASSIGN  16680<<ASSIGN  16685<<ASSIGN
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:243  
     16693<<ASSIGN  16699<<ASSIGN  16706<<ASSIGN  16713<<ASSIGN  16724<<ASSIGN  16739<<ASSIGN  16746<<ASSIGN
     16753<<ASSIGN  16759<<ASSIGN  16765<<ASSIGN  16770<<ASSIGN  16778<<ASSIGN  16781<<ASSIGN  16788<<ASSIGN
     16795<<ASSIGN  16801<<ASSIGN  16807<<ASSIGN  16814<<ASSIGN  16821<<ASSIGN  16826<<ASSIGN  16832<<ASSIGN
     16855<<ASSIGN
VBLK.FPT$
     12950**DCL     16649<<ASSIGN
VBLK.PPDUERR
     13028**DCL     16704<<ASSIGN  16711<<ASSIGN  16722<<ASSIGN  16733<<ASSIGN  16744<<ASSIGN  16751<<ASSIGN
     16786<<ASSIGN  16793<<ASSIGN  16839<<ASSIGN  16846<<ASSIGN
VBLK.SPIMASK
     13060**DCL     13063--REDEF
XSC$CCB.ERRDEF
     15057**DCL     15077--REDEF
XSC$CCB.PRES$
     15200**DCL     16640>>ASSIGN
XSP$ACTIVITY_DISCARD
      8544**DCL     16655<<ASSIGN  16660<<ASSIGN
XSP$ACTIVITY_DISCARD.ERRDEF
      8554**DCL      8574--REDEF
XSP$ACTIVITY_DISCARD.FNC
      8550**DCL     16656<<ASSIGN  16661<<ASSIGN
XSP$ACTIVITY_DISCARD.REASON
      8552**DCL     16657<<ASSIGN  16662<<ASSIGN
XSP$ACTIVITY_END
      8602**DCL     16665<<ASSIGN  16671<<ASSIGN
XSP$ACTIVITY_END.DATA$
      8646**DCL     16667<<ASSIGN  16673<<ASSIGN
XSP$ACTIVITY_END.ERRDEF
      8616**DCL      8636--REDEF
XSP$ACTIVITY_END.FNC
      8613**DCL     16666<<ASSIGN  16672<<ASSIGN
XSP$ACTIVITY_END.SERNUM
      8648**DCL     16668<<ASSIGN  16674<<ASSIGN
XSP$ACTIVITY_INTERRUPT
      8667**DCL     16677<<ASSIGN  16682<<ASSIGN
XSP$ACTIVITY_INTERRUPT.ERRDEF
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:244  
      8677**DCL      8697--REDEF
XSP$ACTIVITY_INTERRUPT.FNC
      8673**DCL     16678<<ASSIGN  16683<<ASSIGN
XSP$ACTIVITY_INTERRUPT.REASON
      8675**DCL     16679<<ASSIGN  16684<<ASSIGN
XSP$ACTIVITY_RESUME
      8725**DCL     16687<<ASSIGN
XSP$ACTIVITY_RESUME.ACTID
      8784**DCL     16691<<ASSIGN
XSP$ACTIVITY_RESUME.DATA$
      8771**DCL     16689<<ASSIGN
XSP$ACTIVITY_RESUME.ERRDEF
      8741**DCL      8761--REDEF
XSP$ACTIVITY_RESUME.FNC
      8737**DCL     16688<<ASSIGN
XSP$ACTIVITY_RESUME.OACTID
      8794**DCL     16692<<ASSIGN
XSP$ACTIVITY_RESUME.SERNUM
      8773**DCL     16690<<ASSIGN
XSP$ACTIVITY_START
      8816**DCL     16695<<ASSIGN
XSP$ACTIVITY_START.ACTID
      8870**DCL     16698<<ASSIGN
XSP$ACTIVITY_START.DATA$
      8861**DCL     16697<<ASSIGN
XSP$ACTIVITY_START.ERRDEF
      8831**DCL      8851--REDEF
XSP$ACTIVITY_START.FNC
      8828**DCL     16696<<ASSIGN
XSP$ALTER_CONTEXT.ERRDEF
      8900**DCL      8920--REDEF
XSP$CAPABILITY_DATA.ERRDEF
      8961**DCL      8981--REDEF
XSP$CONNECT.CALLED$
      9105**DCL      9106--REDEF
XSP$CONNECT.DFLT$
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:245  
      9095**DCL      9096--REDEF
XSP$CONNECT.ERRDEF
      9064**DCL      9084--REDEF
XSP$CONTROL_GIVE
      9155**DCL     16737<<ASSIGN
XSP$CONTROL_GIVE.ERRDEF
      9201**DCL      9221--REDEF
XSP$CONTROL_GIVE.FNC
      9161**DCL     16738<<ASSIGN
XSP$CTXPTR
     16602**DCL-ENT 16633--CALL
XSP$DATA.ERRDEF
      9258**DCL      9278--REDEF
XSP$DECODE
     16603**DCL-ENT 16702--CALL    16709--CALL    16720--CALL    16731--CALL    16742--CALL    16749--CALL
     16784--CALL    16791--CALL    16837--CALL    16844--CALL
XSP$EXPEDITED_DATA.ERRDEF
      9316**DCL      9336--REDEF
XSP$GENERIC.DATA$
      8524**DCL     16860<<ASSIGN
XSP$GENERIC.ERRDEF
      8494**DCL      8514--REDEF
XSP$GENERIC.PCID
      8455**DCL     16857<<ASSIGN
XSP$GETCTX
     16604**DCL-ENT 16636--CALL
XSP$MACHINE
     16605**DCL-ENT 16872--CALL
XSP$P_ABORT
      9365**DCL     16756<<ASSIGN
XSP$P_ABORT.ERRDEF
      9375**DCL      9395--REDEF
XSP$P_ABORT.FNC
      9371**DCL     16757<<ASSIGN
XSP$P_ABORT.REASON
      9373**DCL     16758<<ASSIGN
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:246  
XSP$P_EXCEPTION_REPORT
      9423**DCL     16762<<ASSIGN
XSP$P_EXCEPTION_REPORT.ERRDEF
      9433**DCL      9453--REDEF
XSP$P_EXCEPTION_REPORT.FNC
      9429**DCL     16763<<ASSIGN
XSP$P_EXCEPTION_REPORT.REASON
      9431**DCL     16764<<ASSIGN
XSP$RELEASE
      9481**DCL     16767<<ASSIGN  16772<<ASSIGN
XSP$RELEASE.DATA$
      9521**DCL     16769<<ASSIGN  16775<<ASSIGN
XSP$RELEASE.ERRDEF
      9491**DCL      9511--REDEF
XSP$RELEASE.FNC
      9487**DCL     16768<<ASSIGN  16773<<ASSIGN
XSP$RELEASE.RESULT
      9490**DCL     16774<<ASSIGN
XSP$RESYNCHRONIZE.ERRDEF
      9593**DCL      9613--REDEF
XSP$SYNC_MAJOR
      9645**DCL     16797<<ASSIGN  16803<<ASSIGN
XSP$SYNC_MAJOR.DATA$
      9690**DCL     16799<<ASSIGN  16805<<ASSIGN
XSP$SYNC_MAJOR.ERRDEF
      9660**DCL      9680--REDEF
XSP$SYNC_MAJOR.FNC
      9656**DCL     16798<<ASSIGN  16804<<ASSIGN
XSP$SYNC_MAJOR.SERNUM
      9692**DCL     16800<<ASSIGN  16806<<ASSIGN
XSP$SYNC_MINOR
      9711**DCL     16809<<ASSIGN  16816<<ASSIGN
XSP$SYNC_MINOR.DATA$
      9756**DCL     16812<<ASSIGN  16819<<ASSIGN
XSP$SYNC_MINOR.ERRDEF
      9726**DCL      9746--REDEF
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:247  
XSP$SYNC_MINOR.FNC
      9722**DCL     16810<<ASSIGN  16817<<ASSIGN
XSP$SYNC_MINOR.SERNUM
      9758**DCL     16813<<ASSIGN  16820<<ASSIGN
XSP$SYNC_MINOR.TYPE
      9724**DCL     16811<<ASSIGN  16818<<ASSIGN
XSP$TOKEN_GIVE
      9777**DCL     16823<<ASSIGN
XSP$TOKEN_GIVE.ERRDEF
      9825**DCL      9845--REDEF
XSP$TOKEN_GIVE.FNC
      9784**DCL     16824<<ASSIGN
XSP$TOKEN_GIVE.TOKENS
      9807**DCL     16825<<ASSIGN
XSP$TOKEN_PLEASE
      9873**DCL     16828<<ASSIGN
XSP$TOKEN_PLEASE.DATA$
      9951**DCL     16831<<ASSIGN
XSP$TOKEN_PLEASE.ERRDEF
      9921**DCL      9941--REDEF
XSP$TOKEN_PLEASE.FNC
      9880**DCL     16829<<ASSIGN
XSP$TOKEN_PLEASE.TOKENS
      9903**DCL     16830<<ASSIGN
XSP$TYPED_DATA.ERRDEF
      9979**DCL      9999--REDEF
XSP$U_ABORT.ERRDEF
     10037**DCL     10057--REDEF
XSP$U_EXCEPTION_REPORT
     10086**DCL     16851<<ASSIGN
XSP$U_EXCEPTION_REPORT.DATA$
     10126**DCL     16854<<ASSIGN
XSP$U_EXCEPTION_REPORT.ERRDEF
     10096**DCL     10116--REDEF
XSP$U_EXCEPTION_REPORT.FNC
     10092**DCL     16852<<ASSIGN
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:248  
XSP$U_EXCEPTION_REPORT.REASON
     10094**DCL     16853<<ASSIGN
XSP_ACTIVITY_DISCARD
     10243**DCL     16655>>ASSIGN  16660>>ASSIGN
XSP_ACTIVITY_DISCARD.ERRDEF
     10253**DCL     10273--REDEF
XSP_ACTIVITY_END
     10301**DCL     16665>>ASSIGN  16671>>ASSIGN
XSP_ACTIVITY_END.ERRDEF
     10315**DCL     10335--REDEF
XSP_ACTIVITY_INTERRUPT
     10366**DCL     16677>>ASSIGN  16682>>ASSIGN
XSP_ACTIVITY_INTERRUPT.ERRDEF
     10376**DCL     10396--REDEF
XSP_ACTIVITY_RESUME
     10424**DCL     16687>>ASSIGN
XSP_ACTIVITY_RESUME.ERRDEF
     10440**DCL     10460--REDEF
XSP_ACTIVITY_START
     10515**DCL     16695>>ASSIGN
XSP_ACTIVITY_START.ERRDEF
     10530**DCL     10550--REDEF
XSP_ALTER_CONTEXT.ERRDEF
     10599**DCL     10619--REDEF
XSP_ASN1_FPT
     15586**DCL     16859--CALL    16862>>ASSIGN  16867--ASSIGN
XSP_ASN1_FPT.C0
     15592**DCL     15592--REDEF
XSP_ASN1_FPT.DAT$
     15594**DCL     15594--REDEF
XSP_ASN1_FPT.N0
     15593**DCL     15593--REDEF
XSP_ASN1_FPT.R0
     15591**DCL     15592--REDEF
XSP_CAPABILITY_DATA.ERRDEF
     10660**DCL     10680--REDEF
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:249  
XSP_CONNECT.CALLED$
     10804**DCL     10805--REDEF
XSP_CONNECT.DFLT$
     10794**DCL     10795--REDEF
XSP_CONNECT.ERRDEF
     10763**DCL     10783--REDEF
XSP_CONTROL_GIVE
     10854**DCL     16737>>ASSIGN
XSP_CONTROL_GIVE.ERRDEF
     10900**DCL     10920--REDEF
XSP_DATA.ERRDEF
     10957**DCL     10977--REDEF
XSP_DATABUF$
     16623**DCL     16863>>ASSIGN
XSP_DATACTXT
     16624**DCL     16865>>ASSIGN
XSP_DATANUM
     16622**DCL     16651<<ASSIGN  16858>>IF      16859>>CALL    16861>>DOINDEX 16866>>IF      16876>>IF
XSP_DATASIZE
     16625**DCL     16864>>ASSIGN
XSP_DSTADDR$
     16626**DCL     16717<<ASSIGN  16728<<ASSIGN
XSP_EXPEDITED_DATA.ERRDEF
     11015**DCL     11035--REDEF
XSP_F$NOSCID
     16564**DCL     16645<>CALL
XSP_GENERIC.ERRDEF
     10193**DCL     10213--REDEF
XSP_P_ABORT
     11064**DCL     16756>>ASSIGN
XSP_P_ABORT.ERRDEF
     11074**DCL     11094--REDEF
XSP_P_EXCEPTION_REPORT
     11122**DCL     16762>>ASSIGN
XSP_P_EXCEPTION_REPORT.ERRDEF
     11132**DCL     11152--REDEF
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:250  
XSP_RELEASE
     11180**DCL     16767>>ASSIGN  16772>>ASSIGN
XSP_RELEASE.ERRDEF
     11190**DCL     11210--REDEF
XSP_RESYNCHRONIZE.ERRDEF
     11292**DCL     11312--REDEF
XSP_SRCADDR$
     16627**DCL     16716<<ASSIGN  16727<<ASSIGN
XSP_SYNC_MAJOR
     11344**DCL     16797>>ASSIGN  16803>>ASSIGN
XSP_SYNC_MAJOR.ERRDEF
     11359**DCL     11379--REDEF
XSP_SYNC_MINOR
     11410**DCL     16809>>ASSIGN  16816>>ASSIGN
XSP_SYNC_MINOR.ERRDEF
     11425**DCL     11445--REDEF
XSP_TMPCTXT$
     16628**DCL     16718<<ASSIGN  16729<<ASSIGN  16835<<ASSIGN
XSP_TOKEN_GIVE
     11476**DCL     16823>>ASSIGN
XSP_TOKEN_GIVE.ERRDEF
     11524**DCL     11544--REDEF
XSP_TOKEN_PLEASE
     11572**DCL     16828>>ASSIGN
XSP_TOKEN_PLEASE.ERRDEF
     11620**DCL     11640--REDEF
XSP_TYPED_DATA.ERRDEF
     11678**DCL     11698--REDEF
XSP_U_ABORT.ERRDEF
     11736**DCL     11756--REDEF
XSP_U_EXCEPTION_REPORT
     11785**DCL     16851>>ASSIGN
XSP_U_EXCEPTION_REPORT.ERRDEF
     11795**DCL     11815--REDEF
XSP_VBLK
     13082**DCL     16647>>ASSIGN
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:251  
XSP_VBLK.DATMASK
     13198**DCL     13201--REDEF
XSP_VBLK.DEFMASK
     13182**DCL     13185--REDEF
XSP_VBLK.DELMASK
     13190**DCL     13193--REDEF
XSP_VBLK.SPIMASK
     13206**DCL     13209--REDEF
XSS$ACTIVITY_DISCARD.ERRDEF
      3432**DCL      3458--REDEF
XSS$ACTIVITY_DISCARD.REASON
      3430**DCL     16657>>ASSIGN  16662>>ASSIGN
XSS$ACTIVITY_END.DATA.PTR$
      3600**DCL     16667>>ASSIGN  16673>>ASSIGN
XSS$ACTIVITY_END.ERRDEF
      3522**DCL      3542--REDEF
XSS$ACTIVITY_END.SERNUM
      3618**DCL     16668>>ASSIGN  16674>>ASSIGN
XSS$ACTIVITY_INTERRUPT.ERRDEF
      3687**DCL      3707--REDEF
XSS$ACTIVITY_INTERRUPT.REASON
      3679**DCL     16679>>ASSIGN  16684>>ASSIGN
XSS$ACTIVITY_RESUME.ACTID
      3924**DCL     16691>>ASSIGN
XSS$ACTIVITY_RESUME.DATA.PTR$
      3852**DCL     16689>>ASSIGN
XSS$ACTIVITY_RESUME.ERRDEF
      3774**DCL      3794--REDEF
XSS$ACTIVITY_RESUME.OACTID
      3934**DCL     16692>>ASSIGN
XSS$ACTIVITY_RESUME.SERNUM
      3870**DCL     16690>>ASSIGN
XSS$ACTIVITY_START.ACTID
      4103**DCL     16698>>ASSIGN
XSS$ACTIVITY_START.DATA.PTR$
      4073**DCL     16697>>ASSIGN
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:252  
XSS$ACTIVITY_START.ERRDEF
      3995**DCL      4015--REDEF
XSS$CAPABILITY_DATA.ERRDEF
      4160**DCL      4180--REDEF
XSS$CONNECT.CALLED$
      4496**DCL      4497--REDEF
XSS$CONNECT.ERRDEF
      4364**DCL      4384--REDEF
XSS$CONTROL_GIVE.ERRDEF
      4669**DCL      4689--REDEF
XSS$DATA.ERRDEF
      4751**DCL      4771--REDEF
XSS$EXPEDITED_DATA.ERRDEF
      4895**DCL      4915--REDEF
XSS$GENERIC.DATA
      3345**DCL     16650>>ASSIGN
XSS$GENERIC.ERRDEF
      3296**DCL      3316--REDEF
XSS$GENERIC.FNC
      3256**DCL     16653>>DOCASE
XSS$GENERIC.SCID
      3257**DCL     16631>>IF      16632>>ASSIGN  16857>>ASSIGN
XSS$GETMEM
     16606**DCL-ENT 16859--CALL
XSS$P_ABORT.ERRDEF
      5043**DCL      5063--REDEF
XSS$P_ABORT.REASON
      5035**DCL     16758>>ASSIGN
XSS$P_EXCEPTION_REPORT.ERRDEF
      5129**DCL      5149--REDEF
XSS$P_EXCEPTION_REPORT.REASON
      5121**DCL     16764>>ASSIGN
XSS$RELEASE.DATA.PTR$
      5297**DCL     16769>>ASSIGN  16775>>ASSIGN
XSS$RELEASE.ERRDEF
      5219**DCL      5239--REDEF
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:253  
XSS$RELEASE.RESULT
      5212**DCL     16774>>ASSIGN  16776>>IF
XSS$RELMEM
     16607**DCL-ENT 16877--CALL
XSS$RESYNCHRONIZE.ERRDEF
      5427**DCL      5447--REDEF
XSS$SCREECH
     16608**DCL-ENT 16645--CALL
XSS$SYNC_MAJOR.DATA.PTR$
      5664**DCL     16799>>ASSIGN  16805>>ASSIGN
XSS$SYNC_MAJOR.ERRDEF
      5586**DCL      5606--REDEF
XSS$SYNC_MAJOR.SERNUM
      5682**DCL     16800>>ASSIGN  16806>>ASSIGN
XSS$SYNC_MINOR.DATA.PTR$
      5823**DCL     16812>>ASSIGN  16819>>ASSIGN
XSS$SYNC_MINOR.ERRDEF
      5745**DCL      5765--REDEF
XSS$SYNC_MINOR.SERNUM
      5841**DCL     16813>>ASSIGN  16820>>ASSIGN
XSS$SYNC_MINOR.TYPE
      5737**DCL     16811>>ASSIGN  16818>>ASSIGN
XSS$TOKEN_GIVE.ERRDEF
      5942**DCL      5962--REDEF
XSS$TOKEN_GIVE.TOKENS
      5918**DCL     16825>>ASSIGN
XSS$TOKEN_PLEASE.DATA.PTR$
      6150**DCL     16831>>ASSIGN
XSS$TOKEN_PLEASE.ERRDEF
      6072**DCL      6092--REDEF
XSS$TOKEN_PLEASE.TOKENS
      6048**DCL     16830>>ASSIGN
XSS$TYPED_DATA.ERRDEF
      6216**DCL      6236--REDEF
XSS$U_ABORT.ERRDEF
      6360**DCL      6380--REDEF
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:254  
XSS$U_EXCEPTION_REPORT.DATA.PTR$
      6587**DCL     16854>>ASSIGN
XSS$U_EXCEPTION_REPORT.ERRDEF
      6509**DCL      6529--REDEF
XSS$U_EXCEPTION_REPORT.REASON
      6501**DCL     16853>>ASSIGN
XSS_CCB$$
     16610**DCL     16615--IMP-PTR 16640>>ASSIGN
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:255  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=XSP$SRECV File=XSP$DECODE.:XSA1TSI                            WED 10/01/97 12:01 Page:256  
              MINI UREF LISTING

XSP$SRECV      15**PROC
