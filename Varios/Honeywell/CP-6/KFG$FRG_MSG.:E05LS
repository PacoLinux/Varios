VERSION E05

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:1    
        1        1        /*M*      KFG$FRG_MSG - handle msgs for frog from fecg  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCE CRM 70 IND 5 ECU 10 THI 0 DCI 10 CSU 5 ENU 5 */
        8        8        /*P*      NAME:     KFG$FRG_MSG
        9        9                  PURPOSE:  KFG$FRG_MSG handles all msgs  from users
       10       10                            connected to the fecg sent to frog.
       11       11        */
       12       12        /*D*      NAME:     KFG$FRG_MSG
       13       13                  CALL:     Call KFG$FRG_MSG
       14       14                  INPUT:    None
       15       15                  OUTPUT:   None
       16       16                  INTERFACE: Calls an internal routine to
       17       17                            process requests for lists of loggoed-on
       18       18                            l6 programs.  All other calls are to external
       19       19                            routines. these routines are:
       20       20                             KFS$TRACE - handle trace msgs from th l6s
       21       21                            KFS$ERLOG - handle erlog msgs from the l6s.
       22       22                            KFG$LST - list various users connects to frog
       23       23                            KFH$STRTMSGBUF - start msg buffering
       24       24                            KFH$STPMSGBUF - stop msg buffering
       25       25                            KFH$KILMSGBUF - stop msg buffering
       26       26                            KFH$MSGBUFCONT - continue msg buffering
       27       27                            KFH$CONFIGRQS - hnadle conf reques from fep
       28       28                            KFC$KEYINRSP -fepl - handle fec msgs that originated by keyins.
       29       29                             KFH$KILLSNP - stop snap processing
       30       30                  DESCRIPTION:  The msg id is extracted from the input buffer
       31       31                            and used to call these subroutines.
       32       32                  Two msgs are handled here in this routine.  Start msg logging and stop msg
       33       33                            logging are handled by either opening a file or closing a file.
       34       34                            The file name is: Froglog.
       35       35                          If the msg is not recognized, a msg is sent to the user that says:
       36       36                            Badcode
       37       37        */
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:2    
       38       38        KFG$FRG_MSG: PROC;
       39       39        /**/
       40       40        /*        PLACE ALL INCLUDE FILES HERE       */
       41       41        %INCLUDE CP_6;
       42      122        %INCLUDE KF$SUBS;
       43      189        %INCLUDE KF$MSG_SUBS;
       44      235        /**/
       45      236        %INCLUDE KF$MSG_C;
       46      303        %INCLUDE KF_DAT_R;
       47      322        /**/
       48      323        /*        INSERT ALL MSG MACRO CALLS HERE         */
       49      324        /**/
       50      325        %F$DCB;
       51      382        %KF$MSG;
       52      387        %KF$MSG_LSTRQS;
       53      393        %KF$MSG_LSTRSP;
       54      400        %KF$MSG_EXCLDCB;
       55      406    1   DCL M$LOG DCB;
       56      407        /**/
       57      408        %FPT_OPEN (FPTN=OPNLOGFPT,DCB=M$LOG,
       58      409                 NAME=Y_LOGFILENAME,EXIST=NEWFILE,
       59      410                 CTG=YES,ASN=FILE,
       60      411                 ORG=CONSEC,RECL=160,
       61      412                 FUN=CREATE,SHARE=IN);
       62      521        %VLP_NAME (FPTN=Y_LOGFILENAME,NAME=':FROGLOG');
       63      548        %FPT_CLOSE (FPTN=CLSLOGFPT,DCB=M$LOG,DISP=SAVE);
       64      590        %FPT_ACTIVATE(FPTN=AC_DEAC,DCB=M$FE,STATION=CGMA.ORIGIN#,STCLASS=CONSTANT,
       65      591                      TRANS=YES);
       66      614        %FPT_FWCG(DCB=M$FE,DELETE=YES,CRITERIA=CGMA,STCLASS=CONSTANT,SCA=SCGMA);
       67      633        %VLP_CGMA(FPTN=CGMA);
       68      660        %VLP_SCGMA(FPTN=SCGMA,ORIGIN=YES,DEST=YES,STCLASS=CONSTANT);
       69      677        /**/
       70      678        /*        INSERT ALL LOCAL VARIABLES HERE         */
       71      679        /**/
       72      680    1   DCL Y$ARS UBIN WORD;
       73      681    1   DCL Y$INDEX UBIN WORD;
       74      682    1   DCL Y$INDEX2 UBIN WORD;
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:3    
       75      683    1   DCL Y$FNDFLG UBIN WORD;
       76      684    1   DCL Y$COUNT UBIN WORD;
       77      685    1   DCL Y$STA CHAR(8);
       78      686    1   DCL Y$MSG_ID UBIN WORD;
       79      687    1   DCL Y$BUF$ PTR;
       80      688    1   DCL Y$L$ PTR;
       81      689    1   DCL Y$DUMY UBIN WORD;
       82      690        /**/
       83      691        /*        INSERT ALL ENTRY DCLS HERE              */
       84      692        /**/
       85      693    1   DCL KFW$WRT_MSG ENTRY(3);
       86      694    1   DCL KFE$ERRTXT ENTRY(1);
       87      695    1   DCL KFS$TRACE ENTRY;
       88      696    1   DCL KFS$ERLOG ENTRY;
       89      697    1   DCL KFJ$CONFIGRQS ENTRY;
       90      698    1   DCL KFC$KEYINRSP_FEPC ENTRY;
       91      699    1   DCL KFB$FIFS ENTRY(3);
       92      700        /**/
       93      701        %EJECT;
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:4    
       94      702        /**/
       95      703    1           Y$L$ = ADDR(KF_FECGBUF);
       96      704        /**/
       97      705    1           Y$MSG_ID  = Y$L$->KF$MSG.MSG_ID;
       98      706        /**/
       99      707    2           DO   CASE   (Y$MSG_ID);
      100      708    2                CASE (%KF_MSGC_LSTNM#);
      101      709    2                     CALL KFG$LST(Y$L$->KF$MSG_LSTRQS.NAME);
      102      710    2                CASE (%KF_MSGC_EXCLDCB#);
      103      711    2                     Y$STA = Y$L$ -> KF$MSG_EXCLDCB.STATION;
      104      712    2                     Y$BUF$ = ADDR(KF_FECG_OUTBUF);
      105      713    2                     Y$BUF$->KF$MSG.MSG_ID = %KF_MSGC_EXCLRSP#;
      106      714    2                     CALL KFB$FIFS(Y$STA,%KF_UTBLST_ACTIVE#,Y$INDEX);
      107      715    2                     IF Y$INDEX = 0
      108      716    2                     THEN Y$BUF$->KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOSTA#;
      109      717    3                     ELSE DO;
      110      718    3                          IF KF_UTBL.FLAGS.EXCLDCB(Y$INDEX)
      111      719    3                          THEN Y$BUF$->KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOTOK#;
      112      720    4                          ELSE DO;
      113      721    4                               Y$BUF$->KF$MSG.MSG_SUBC = %KF_EXCLRSP_OK#;
      114      722    4                               KF_UTBL.FLAGS.EXCLDCB(Y$INDEX) = '1'B;
      115      723    4                               KF_UTBL.DCBSTATION(Y$INDEX) = KF_FECG_STA;
      116      724    4                               CGMA.ORIGIN# = Y$STA;
      117      725    4                               CGMA.DEST# = Y$STA;
      118      726    4                               CALL M$DEACTIVATE(AC_DEAC) ALTRET(EHWHAT);
      119      727    4                               CALL M$ACTIVATE(AC_DEAC) ALTRET(EHWHAT);
      120      728    4                               CALL M$FWCG(FPT_FWCG) ALTRET(EHWHAT);
      121      729    4   EHWHAT:                     ;
      122      730    4                          END;
      123      731    3                     END;                  /* ELSE                     */
      124      732    2                     CALL KFW$WRT_MSG(4,KF_FECG_STA,KF_FECG_OUTBUF);
      125      733    2                CASE (ELSE);
      126      734        /*
      127      735                                      UNKNOWN CODE --
      128      736                                 Write an error msg back to user
      129      737        */
      130      738    2                     Y$BUF$ = ADDR(KF_FECG_OUTBUF);
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:5    
      131      739    2                     Y$BUF$->KF$MSG.MSG_ID = %KF_MSGC_BDCD#;
      132      740    2                     Y$BUF$->KF$MSG.MSG_SUBC = Y$MSG_ID;
      133      741    2                     Y$ARS=4;
      134      742    2                     Y$STA = KF_FECG_STA;
      135      743    2                     CALL KFW$WRT_MSG(Y$ARS,Y$STA,KF_FECG_OUTBUF);
      136      744    2           END;
      137      745    1           RETURN;
      138      746        %EJECT;
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:6    
      139      747        /*F* NAME:          KFG$LST
      140      748             PURPOSE:       Return a list of stations connected to frog
      141      749        */
      142      750        /*D* NAME:          KFG$LST
      143      751             CALL:          Call KFG$LST (P$TYPE)
      144      752             INPUT:         P$TYPE - type of user to be listed.
      145      753             OUTPUT:        none - a msg is written thru kfw back to the user.
      146      754             INTERFACE:          KFW$WRT_MSG- write a msg to requestor.
      147      755         DESCRIPTION:        This routine searchs the usertable for matchs in the frgtyp fie
               755        ld.  The
      148      756               mode and station name are moved into a msg that can hold up to 12 user names.
      149      757                            This msg is then sent to the person who sent the msg.
      150      758             STRUCTURES:    see KF$MSG_LIST in KF$MSG_C
      151      759        */
      152      760        /**/
      153      761    1   KFG$LST: PROC (Y$TYPE);
      154      762        /**/
      155      763    2   DCL Y$TYPE CHAR(4);
      156      764        /**/
      157      765        /**/
      158      766    2           Y$INDEX = 0;                    /* intialize all indexs     */
      159      767    2           Y$INDEX2 = 0;
      160      768    2           Y$COUNT=0;
      161      769    2           Y$BUF$ = ADDR(KF_FECG_OUTBUF);
      162      770        /**/
      163      771        /*        SET UP RESPONSE HEADER        */
      164      772        /**/
      165      773    2           KF_FECG_OUTBUF = ' ';
      166      774    2           Y$BUF$->KF$MSG_LSTRSP.MSG_ID = %KF_MSGC_LSTR#;
      167      775    2           Y$BUF$->KF$MSG_LSTRSP.MSG_SUBC = Y$L$->KF$MSG_LSTRQS.MSG_SUBC;
      168      776        /**/
      169      777        /*
      170      778                       NOW SEARCH USER TABLE FOR ACTIVE USERS WHO
      171      779                       MATCH THE TYPE PASSEDTO US BY THE CALLER
      172      780        */
      173      781        /**/
      174      782    3           DO     Y$INDEX = 1 TO %KF_UTBL_MAX## ;
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:7    
      175      783    3                IF KF_UTBL.STATE(Y$INDEX) = %KF_UTBLST_ACTIVE# THEN
      176      784    4                DO;
      177      785    4                     IF KF_UTBL.STA.ID(Y$INDEX) = Y$TYPE OR
      178      786    4                       Y$TYPE = '    ' THEN
      179      787    5                     DO;
      180      788    5                          Y$BUF$->KF$MSG_LSTRSP.STATION(Y$INDEX2) = KF_UTBL.STATION(
               788                                   Y$INDEX);
      181      789    5                          Y$COUNT = Y$COUNT+1;
      182      790    5                          Y$INDEX2 = Y$INDEX2 +1;
      183      791    5                     END;
      184      792    4                END;
      185      793    3           END;                            /* END OF DO LOOP           */
      186      794        /**/
      187      795    2           Y$BUF$->KF$MSG_LSTRSP.COUNT = Y$COUNT;
      188      796    2           IF Y$COUNT = 0 THEN Y$ARS = 8;
      189      797    2           ELSE Y$ARS = 8 +(Y$COUNT*8);
      190      798    2           Y$STA = KF_FECG_STA;
      191      799    2           CALL KFW$WRT_MSG(Y$ARS,Y$STA,KF_FECG_OUTBUF);
      192      800    2           RETURN;
      193      801    2   END KFG$LST;
      194      802    1   END KFG$FRG_MSG;

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:8    
--  Include file information  --

   KF_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   KF$MSG_C.:E05TOU  is referenced.
   KF$MSG_SUBS.:E05TOU  is referenced.
   KF$SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KFG$FRG_MSG.

   Procedure KFG$FRG_MSG requires 192 words for executable code.
   Procedure KFG$FRG_MSG requires 20 words of local(AUTO) storage.

    No errors detected in file KFG$FRG_MSG.:E05TSI    .

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:9    

 Object Unit name= KFG$FRG_MSG                                File name= KFG$FRG_MSG.:E05TOU
 UTS= JUL 30 '97 00:22:43.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$FE
    2   DCB   even  none     0      0  M$CS
    3   DCB   even  none     0      0  M$HLPF
    4   DCB   even  none     0      0  M$PROF
    5   DCB   even  none     0      0  M$NETCON
    6   DCB   even  none     0      0  M$LOG
    7   Data  even  none   108    154  KFG$FRG_MSG
    8  RoData even  UTS     61     75  KFG$FRG_MSG
    9   Proc  even  none   192    300  KFG$FRG_MSG
   10  RoData even  none     6      6  KFG$FRG_MSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Std        0  KFG$FRG_MSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 KFW$WRT_MSG
         yes           Std       3 KFB$FIFS
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:10   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KF_FECGBUF                            KF_FECG_OUTBUF
     KF_FECG_STA                           M$FE                                  M$CS
     M$HLPF                                M$PROF                                M$NETCON
     KF_UTBL                               M$LOG                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:11   


        1        1        /*M*      KFG$FRG_MSG - handle msgs for frog from fecg  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCE CRM 70 IND 5 ECU 10 THI 0 DCI 10 CSU 5 ENU 5 */
        8        8        /*P*      NAME:     KFG$FRG_MSG
        9        9                  PURPOSE:  KFG$FRG_MSG handles all msgs  from users
       10       10                            connected to the fecg sent to frog.
       11       11        */
       12       12        /*D*      NAME:     KFG$FRG_MSG
       13       13                  CALL:     Call KFG$FRG_MSG
       14       14                  INPUT:    None
       15       15                  OUTPUT:   None
       16       16                  INTERFACE: Calls an internal routine to
       17       17                            process requests for lists of loggoed-on
       18       18                            l6 programs.  All other calls are to external
       19       19                            routines. these routines are:
       20       20                             KFS$TRACE - handle trace msgs from th l6s
       21       21                            KFS$ERLOG - handle erlog msgs from the l6s.
       22       22                            KFG$LST - list various users connects to frog
       23       23                            KFH$STRTMSGBUF - start msg buffering
       24       24                            KFH$STPMSGBUF - stop msg buffering
       25       25                            KFH$KILMSGBUF - stop msg buffering
       26       26                            KFH$MSGBUFCONT - continue msg buffering
       27       27                            KFH$CONFIGRQS - hnadle conf reques from fep
       28       28                            KFC$KEYINRSP -fepl - handle fec msgs that originated by keyins.
       29       29                             KFH$KILLSNP - stop snap processing
       30       30                  DESCRIPTION:  The msg id is extracted from the input buffer
       31       31                            and used to call these subroutines.
       32       32                  Two msgs are handled here in this routine. Start msg logging and stop msg
       33       33                            logging are handled by either opening a file or closing a file.
       34       34                            The file name is: Froglog.
       35       35                         If the msg is not recognized, a msg is sent to the user that says:
       36       36                            Badcode
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:12   
       37       37        */
       38       38        KFG$FRG_MSG: PROC;

     38  9 000000   000000 700200 xent  KFG$FRG_MSG  TSX0  ! X66_AUTO_0
         9 000001   000024 000000                    ZERO    20,0

       39       39        /**/
       40       40        /*        PLACE ALL INCLUDE FILES HERE       */
       41       41        %INCLUDE CP_6;
       42      122        %INCLUDE KF$SUBS;
       43      189        %INCLUDE KF$MSG_SUBS;
       44      235        /**/
       45      236        %INCLUDE KF$MSG_C;
       46      303        %INCLUDE KF_DAT_R;
       47      322        /**/
       48      323        /*        INSERT ALL MSG MACRO CALLS HERE         */
       49      324        /**/
       50      325        %F$DCB;
       51      382        %KF$MSG;
       52      387        %KF$MSG_LSTRQS;
       53      393        %KF$MSG_LSTRSP;
       54      400        %KF$MSG_EXCLDCB;
       55      406    1   DCL M$LOG DCB;
       56      407        /**/
       57      408        %FPT_OPEN (FPTN=OPNLOGFPT,DCB=M$LOG,
       58      409                 NAME=Y_LOGFILENAME,EXIST=NEWFILE,
       59      410                 CTG=YES,ASN=FILE,
       60      411                 ORG=CONSEC,RECL=160,
       61      412                 FUN=CREATE,SHARE=IN);
       62      521        %VLP_NAME (FPTN=Y_LOGFILENAME,NAME=':FROGLOG');
       63      548        %FPT_CLOSE (FPTN=CLSLOGFPT,DCB=M$LOG,DISP=SAVE);
       64      590        %FPT_ACTIVATE(FPTN=AC_DEAC,DCB=M$FE,STATION=CGMA.ORIGIN#,STCLASS=CONSTANT,
       65      591                      TRANS=YES);
       66      614        %FPT_FWCG(DCB=M$FE,DELETE=YES,CRITERIA=CGMA,STCLASS=CONSTANT,SCA=SCGMA);
       67      633        %VLP_CGMA(FPTN=CGMA);
       68      660        %VLP_SCGMA(FPTN=SCGMA,ORIGIN=YES,DEST=YES,STCLASS=CONSTANT);
       69      677        /**/
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:13   
       70      678        /*        INSERT ALL LOCAL VARIABLES HERE         */
       71      679        /**/
       72      680    1   DCL Y$ARS UBIN WORD;
       73      681    1   DCL Y$INDEX UBIN WORD;
       74      682    1   DCL Y$INDEX2 UBIN WORD;
       75      683    1   DCL Y$FNDFLG UBIN WORD;
       76      684    1   DCL Y$COUNT UBIN WORD;
       77      685    1   DCL Y$STA CHAR(8);
       78      686    1   DCL Y$MSG_ID UBIN WORD;
       79      687    1   DCL Y$BUF$ PTR;
       80      688    1   DCL Y$L$ PTR;
       81      689    1   DCL Y$DUMY UBIN WORD;
       82      690        /**/
       83      691        /*        INSERT ALL ENTRY DCLS HERE              */
       84      692        /**/
       85      693    1   DCL KFW$WRT_MSG ENTRY(3);
       86      694    1   DCL KFE$ERRTXT ENTRY(1);
       87      695    1   DCL KFS$TRACE ENTRY;
       88      696    1   DCL KFS$ERLOG ENTRY;
       89      697    1   DCL KFJ$CONFIGRQS ENTRY;
       90      698    1   DCL KFC$KEYINRSP_FEPC ENTRY;
       91      699    1   DCL KFB$FIFS ENTRY(3);
       92      700        /**/
       93      701        %EJECT;
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:14   
       94      702        /**/
       95      703    1           Y$L$ = ADDR(KF_FECGBUF);

    703  9 000002   000000 236000 10                 LDQ     0
         9 000003   200014 756100                    STQ     Y$L$,,AUTO

       96      704        /**/
       97      705    1           Y$MSG_ID  = Y$L$->KF$MSG.MSG_ID;

    705  9 000004   200014 470500                    LDP0    Y$L$,,AUTO
         9 000005   000000 236100                    LDQ     0,,PR0
         9 000006   000033 772000                    QRL     27
         9 000007   200012 756100                    STQ     Y$MSG_ID,,AUTO

       98      706        /**/
       99      707    2           DO   CASE   (Y$MSG_ID);

    707  9 000010   000005 136007                    SBLQ    5,DL
         9 000011   000005 116007                    CMPQ    5,DL
         9 000012   000014 602006 9                  TNC     s:707+4,QL
         9 000013   000133 710000 9                  TRA     s:738
         9 000014   000021 710000 9                  TRA     s:709
         9 000015   000133 710000 9                  TRA     s:738
         9 000016   000133 710000 9                  TRA     s:738
         9 000017   000133 710000 9                  TRA     s:738
         9 000020   000027 710000 9                  TRA     s:711

      100      708    2                CASE (%KF_MSGC_LSTNM#);

      101      709    2                     CALL KFG$LST(Y$L$->KF$MSG_LSTRQS.NAME);

    709  9 000021   200014 236100                    LDQ     Y$L$,,AUTO
         9 000022   400000 036007                    ADLQ    -131072,DL
         9 000023   200017 756100                    STQ     Y$L$+3,,AUTO
         9 000024   000163 701000 9                  TSX1    KFG$LST
         9 000025   000000 011000                    NOP     0
         9 000026   000162 710000 9                  TRA     s:745
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:15   

      102      710    2                CASE (%KF_MSGC_EXCLDCB#);

      103      711    2                     Y$STA = Y$L$ -> KF$MSG_EXCLDCB.STATION;

    711  9 000027   040100 100500                    MLR     fill='040'O
         9 000030   000000 400010                    ADSC9   0,,PR0                   cn=2,n=8
         9 000031   200010 000010                    ADSC9   Y$STA,,AUTO              cn=0,n=8

      104      712    2                     Y$BUF$ = ADDR(KF_FECG_OUTBUF);

    712  9 000032   000001 236000 10                 LDQ     1
         9 000033   200013 756100                    STQ     Y$BUF$,,AUTO

      105      713    2                     Y$BUF$->KF$MSG.MSG_ID = %KF_MSGC_EXCLRSP#;

    713  9 000034   200013 471500                    LDP1    Y$BUF$,,AUTO
         9 000035   012000 236003                    LDQ     5120,DU
         9 000036   100000 552140                    STBQ    0,'40'O,PR1

      106      714    2                     CALL KFB$FIFS(Y$STA,%KF_UTBLST_ACTIVE#,Y$INDEX);

    714  9 000037   200004 633500                    EPPR3   Y$INDEX,,AUTO
         9 000040   200022 453500                    STP3    @Y$TYPE+3,,AUTO
         9 000041   000002 236000 10                 LDQ     2
         9 000042   200021 756100                    STQ     @Y$TYPE+2,,AUTO
         9 000043   200010 634500                    EPPR4   Y$STA,,AUTO
         9 000044   200020 454500                    STP4    @Y$TYPE+1,,AUTO
         9 000045   200020 630500                    EPPR0   @Y$TYPE+1,,AUTO
         9 000046   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000047   000000 701000 xent               TSX1    KFB$FIFS
         9 000050   000000 011000                    NOP     0

      107      715    2                     IF Y$INDEX = 0

    715  9 000051   200004 235100                    LDA     Y$INDEX,,AUTO
         9 000052   000057 601000 9                  TNZ     s:718
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:16   

      108      716    2                     THEN Y$BUF$->KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOSTA#;

    716  9 000053   200013 470500                    LDP0    Y$BUF$,,AUTO
         9 000054   000002 236003                    LDQ     2,DU
         9 000055   000000 552120                    STBQ    0,'20'O,PR0
         9 000056   000126 710000 9                  TRA     EHWHAT

      109      717    3                     ELSE DO;

      110      718    3                          IF KF_UTBL.FLAGS.EXCLDCB(Y$INDEX)

    718  9 000057   200004 236100                    LDQ     Y$INDEX,,AUTO
         9 000060   000011 402007                    MPY     9,DL
         9 000061   000002 236006 xsym               LDQ     KF_UTBL+2,QL
         9 000062   100000 316007                    CANQ    32768,DL
         9 000063   000070 600000 9                  TZE     s:721

      111      719    3                          THEN Y$BUF$->KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOTOK#;

    719  9 000064   200013 470500                    LDP0    Y$BUF$,,AUTO
         9 000065   000000 236003                    LDQ     0,DU
         9 000066   000000 552120                    STBQ    0,'20'O,PR0
         9 000067   000126 710000 9                  TRA     EHWHAT

      112      720    4                          ELSE DO;

      113      721    4                               Y$BUF$->KF$MSG.MSG_SUBC = %KF_EXCLRSP_OK#;

    721  9 000070   200013 470500                    LDP0    Y$BUF$,,AUTO
         9 000071   000001 236003                    LDQ     1,DU
         9 000072   000000 552120                    STBQ    0,'20'O,PR0

      114      722    4                               KF_UTBL.FLAGS.EXCLDCB(Y$INDEX) = '1'B;

    722  9 000073   200004 236100                    LDQ     Y$INDEX,,AUTO
         9 000074   000011 402007                    MPY     9,DL
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:17   
         9 000075   000000 620006                    EAX0    0,QL
         9 000076   100000 236007                    LDQ     32768,DL
         9 000077   000002 256010 xsym               ORSQ    KF_UTBL+2,X0

      115      723    4                               KF_UTBL.DCBSTATION(Y$INDEX) = KF_FECG_STA;

    723  9 000100   000000 635010                    EAA     0,X0
         9 000101   000020 771000                    ARL     16
         9 000102   040005 100400                    MLR     fill='040'O
         9 000103   000000 000010 xsym               ADSC9   KF_FECG_STA              cn=0,n=8
         9 000104   000006 400010 xsym               ADSC9   KF_UTBL+6,A              cn=2,n=8

      116      724    4                               CGMA.ORIGIN# = Y$STA;

    724  9 000105   200010 237100                    LDAQ    Y$STA,,AUTO
         9 000106   000140 757000 7                  STAQ    CGMA+4

      117      725    4                               CGMA.DEST# = Y$STA;

    725  9 000107   200010 237100                    LDAQ    Y$STA,,AUTO
         9 000110   000145 755000 7                  STA     CGMA+9
         9 000111   000146 756000 7                  STQ     CGMA+10

      118      726    4                               CALL M$DEACTIVATE(AC_DEAC) ALTRET(EHWHAT);

    726  9 000112   000000 630400 8                  EPPR0   AC_DEAC
         9 000113   500001 713400                    CLIMB   alt,+32769
         9 000114   401400 401760                    pmme    nvectors=4
         9 000115   000126 702000 9                  TSX2    EHWHAT

      119      727    4                               CALL M$ACTIVATE(AC_DEAC) ALTRET(EHWHAT);

    727  9 000116   000000 630400 8                  EPPR0   AC_DEAC
         9 000117   500000 713400                    CLIMB   alt,+32768
         9 000120   401400 401760                    pmme    nvectors=4
         9 000121   000126 702000 9                  TSX2    EHWHAT

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:18   
      120      728    4                               CALL M$FWCG(FPT_FWCG) ALTRET(EHWHAT);

    728  9 000122   000020 630400 8                  EPPR0   FPT_FWCG
         9 000123   500005 713400                    CLIMB   alt,+32773
         9 000124   406400 401760                    pmme    nvectors=14
         9 000125   000126 702000 9                  TSX2    EHWHAT

    725  9 000126                       EHWHAT       null
      121      729    4   EHWHAT:                     ;
      122      730    4                          END;

      123      731    3                     END;                  /* ELSE                     */

      124      732    2                     CALL KFW$WRT_MSG(4,KF_FECG_STA,KF_FECG_OUTBUF);

    732  9 000126   000003 630400 10                 EPPR0   3
         9 000127   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000130   000000 701000 xent               TSX1    KFW$WRT_MSG
         9 000131   000000 011000                    NOP     0
         9 000132   000162 710000 9                  TRA     s:745

      125      733    2                CASE (ELSE);

      126      734        /*
      127      735                                      UNKNOWN CODE --
      128      736                                 Write an error msg back to user
      129      737        */
      130      738    2                     Y$BUF$ = ADDR(KF_FECG_OUTBUF);

    738  9 000133   000001 236000 10                 LDQ     1
         9 000134   200013 756100                    STQ     Y$BUF$,,AUTO

      131      739    2                     Y$BUF$->KF$MSG.MSG_ID = %KF_MSGC_BDCD#;

    739  9 000135   200013 471500                    LDP1    Y$BUF$,,AUTO
         9 000136   007000 236003                    LDQ     3584,DU
         9 000137   100000 552140                    STBQ    0,'40'O,PR1
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:19   

      132      740    2                     Y$BUF$->KF$MSG.MSG_SUBC = Y$MSG_ID;

    740  9 000140   200012 236100                    LDQ     Y$MSG_ID,,AUTO
         9 000141   000022 736000                    QLS     18
         9 000142   100000 552120                    STBQ    0,'20'O,PR1

      133      741    2                     Y$ARS=4;

    741  9 000143   000004 235007                    LDA     4,DL
         9 000144   200003 755100                    STA     Y$ARS,,AUTO

      134      742    2                     Y$STA = KF_FECG_STA;

    742  9 000145   040100 100400                    MLR     fill='040'O
         9 000146   000000 000010 xsym               ADSC9   KF_FECG_STA              cn=0,n=8
         9 000147   200010 000010                    ADSC9   Y$STA,,AUTO              cn=0,n=8

      135      743    2                     CALL KFW$WRT_MSG(Y$ARS,Y$STA,KF_FECG_OUTBUF);

    743  9 000150   000001 236000 10                 LDQ     1
         9 000151   200022 756100                    STQ     @Y$TYPE+3,,AUTO
         9 000152   200010 633500                    EPPR3   Y$STA,,AUTO
         9 000153   200021 453500                    STP3    @Y$TYPE+2,,AUTO
         9 000154   200003 634500                    EPPR4   Y$ARS,,AUTO
         9 000155   200020 454500                    STP4    @Y$TYPE+1,,AUTO
         9 000156   200020 630500                    EPPR0   @Y$TYPE+1,,AUTO
         9 000157   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000160   000000 701000 xent               TSX1    KFW$WRT_MSG
         9 000161   000000 011000                    NOP     0

      136      744    2           END;

      137      745    1           RETURN;

    745  9 000162   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:20   
      138      746        %EJECT;
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:21   
      139      747        /*F* NAME:          KFG$LST
      140      748             PURPOSE:       Return a list of stations connected to frog
      141      749        */
      142      750        /*D* NAME:          KFG$LST
      143      751             CALL:          Call KFG$LST (P$TYPE)
      144      752             INPUT:         P$TYPE - type of user to be listed.
      145      753             OUTPUT:        none - a msg is written thru kfw back to the user.
      146      754             INTERFACE:          KFW$WRT_MSG- write a msg to requestor.
      147      755         DESCRIPTION:       This routine searchs the usertable for matchs in the frgtyp fie
               755        ld.  The
      148      756              mode and station name are moved into a msg that can hold up to 12 user names.
      149      757                            This msg is then sent to the person who sent the msg.
      150      758             STRUCTURES:    see KF$MSG_LIST in KF$MSG_C
      151      759        */
      152      760        /**/
      153      761    1   KFG$LST: PROC (Y$TYPE);

    761  9 000163   200016 741300       KFG$LST      STX1  ! Y$L$+2,,AUTO

      154      762        /**/
      155      763    2   DCL Y$TYPE CHAR(4);
      156      764        /**/
      157      765        /**/
      158      766    2           Y$INDEX = 0;                    /* intialize all indexs     */

    766  9 000164   200004 450100                    STZ     Y$INDEX,,AUTO

      159      767    2           Y$INDEX2 = 0;

    767  9 000165   200005 450100                    STZ     Y$INDEX2,,AUTO

      160      768    2           Y$COUNT=0;

    768  9 000166   200007 450100                    STZ     Y$COUNT,,AUTO

      161      769    2           Y$BUF$ = ADDR(KF_FECG_OUTBUF);

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:22   
    769  9 000167   000001 236000 10                 LDQ     1
         9 000170   200013 756100                    STQ     Y$BUF$,,AUTO

      162      770        /**/
      163      771        /*        SET UP RESPONSE HEADER        */
      164      772        /**/
      165      773    2           KF_FECG_OUTBUF = ' ';

    773  9 000171   040000 100400                    MLR     fill='040'O
         9 000172   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000173   000000 001130 xsym               ADSC9   KF_FECG_OUTBUF           cn=0,n=600

      166      774    2           Y$BUF$->KF$MSG_LSTRSP.MSG_ID = %KF_MSGC_LSTR#;

    774  9 000174   200013 470500                    LDP0    Y$BUF$,,AUTO
         9 000175   004000 236003                    LDQ     2048,DU
         9 000176   000000 552140                    STBQ    0,'40'O,PR0

      167      775    2           Y$BUF$->KF$MSG_LSTRSP.MSG_SUBC = Y$L$->KF$MSG_LSTRQS.MSG_SUBC;

    775  9 000177   200014 471500                    LDP1    Y$L$,,AUTO
         9 000200   100000 236100                    LDQ     0,,PR1
         9 000201   000000 552120                    STBQ    0,'20'O,PR0

      168      776        /**/
      169      777        /*
      170      778                       NOW SEARCH USER TABLE FOR ACTIVE USERS WHO
      171      779                       MATCH THE TYPE PASSEDTO US BY THE CALLER
      172      780        */
      173      781        /**/
      174      782    3           DO     Y$INDEX = 1 TO %KF_UTBL_MAX## ;

    782  9 000202   000001 235007                    LDA     1,DL
         9 000203   200004 755100                    STA     Y$INDEX,,AUTO

      175      783    3                IF KF_UTBL.STATE(Y$INDEX) = %KF_UTBLST_ACTIVE# THEN

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:23   
    783  9 000204   200004 236100                    LDQ     Y$INDEX,,AUTO
         9 000205   000011 402007                    MPY     9,DL
         9 000206   000002 220006 xsym               LDX0    KF_UTBL+2,QL
         9 000207   000001 100003                    CMPX0   1,DU
         9 000210   000241 601000 9                  TNZ     s:793

      176      784    4                DO;

      177      785    4                     IF KF_UTBL.STA.ID(Y$INDEX) = Y$TYPE OR

    785  9 000211   200004 236100                    LDQ     Y$INDEX,,AUTO
         9 000212   000044 402007                    MPY     36,DL
         9 000213   200017 470500                    LDP0    @Y$TYPE,,AUTO
         9 000214   040100 106406                    CMPC    fill='040'O
         9 000215   000000 000004 xsym               ADSC9   KF_UTBL,Q                cn=0,n=4
         9 000216   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         9 000217   000224 600000 9                  TZE     s:788
         9 000220   040000 106500                    CMPC    fill='040'O
         9 000221   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         9 000222   000074 000004 8                  ADSC9   SCGMA+2                  cn=0,n=4
         9 000223   000241 601000 9                  TNZ     s:793

      178      786    4                       Y$TYPE = '    ' THEN
      179      787    5                     DO;

      180      788    5                          Y$BUF$->KF$MSG_LSTRSP.STATION(Y$INDEX2) = KF_UTBL.STATION(
               788                                   Y$INDEX);

    788  9 000224   200005 235100                    LDA     Y$INDEX2,,AUTO
         9 000225   000001 735000                    ALS     1
         9 000226   000002 735000                    ALS     2
         9 000227   200013 471500                    LDP1    Y$BUF$,,AUTO
         9 000230   040105 100406                    MLR     fill='040'O
         9 000231   000000 000010 xsym               ADSC9   KF_UTBL,Q                cn=0,n=8
         9 000232   100001 000010                    ADSC9   1,A,PR1                  cn=0,n=8

      181      789    5                          Y$COUNT = Y$COUNT+1;
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:24   

    789  9 000233   200007 235100                    LDA     Y$COUNT,,AUTO
         9 000234   000001 035007                    ADLA    1,DL
         9 000235   200007 755100                    STA     Y$COUNT,,AUTO

      182      790    5                          Y$INDEX2 = Y$INDEX2 +1;

    790  9 000236   200005 236100                    LDQ     Y$INDEX2,,AUTO
         9 000237   000001 036007                    ADLQ    1,DL
         9 000240   200005 756100                    STQ     Y$INDEX2,,AUTO

      183      791    5                     END;

      184      792    4                END;

      185      793    3           END;                            /* END OF DO LOOP           */

    793  9 000241   200004 235100                    LDA     Y$INDEX,,AUTO
         9 000242   000001 035007                    ADLA    1,DL
         9 000243   200004 755100                    STA     Y$INDEX,,AUTO
         9 000244   000025 115007                    CMPA    21,DL
         9 000245   000204 602000 9                  TNC     s:783

      186      794        /**/
      187      795    2           Y$BUF$->KF$MSG_LSTRSP.COUNT = Y$COUNT;

    795  9 000246   200007 720100                    LXL0    Y$COUNT,,AUTO
         9 000247   200013 470500                    LDP0    Y$BUF$,,AUTO
         9 000250   000000 440100                    SXL0    0,,PR0

      188      796    2           IF Y$COUNT = 0 THEN Y$ARS = 8;

    796  9 000251   200007 235100                    LDA     Y$COUNT,,AUTO
         9 000252   000256 601000 9                  TNZ     s:797

    796  9 000253   000010 236007                    LDQ     8,DL
         9 000254   200003 756100                    STQ     Y$ARS,,AUTO
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:25   
         9 000255   000261 710000 9                  TRA     s:798

      189      797    2           ELSE Y$ARS = 8 +(Y$COUNT*8);

    797  9 000256   000003 735000                    ALS     3
         9 000257   000010 035007                    ADLA    8,DL
         9 000260   200003 755100                    STA     Y$ARS,,AUTO

      190      798    2           Y$STA = KF_FECG_STA;

    798  9 000261   040100 100400                    MLR     fill='040'O
         9 000262   000000 000010 xsym               ADSC9   KF_FECG_STA              cn=0,n=8
         9 000263   200010 000010                    ADSC9   Y$STA,,AUTO              cn=0,n=8

      191      799    2           CALL KFW$WRT_MSG(Y$ARS,Y$STA,KF_FECG_OUTBUF);

    799  9 000264   000001 236000 10                 LDQ     1
         9 000265   200022 756100                    STQ     @Y$TYPE+3,,AUTO
         9 000266   200010 631500                    EPPR1   Y$STA,,AUTO
         9 000267   200021 451500                    STP1    @Y$TYPE+2,,AUTO
         9 000270   200003 633500                    EPPR3   Y$ARS,,AUTO
         9 000271   200020 453500                    STP3    @Y$TYPE+1,,AUTO
         9 000272   200020 630500                    EPPR0   @Y$TYPE+1,,AUTO
         9 000273   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000274   000000 701000 xent               TSX1    KFW$WRT_MSG
         9 000275   000000 011000                    NOP     0

      192      800    2           RETURN;

    800  9 000276   200016 221300                    LDX1  ! Y$L$+2,,AUTO
         9 000277   000001 702211                    TSX2  ! 1,X1
      193      801    2   END KFG$LST;
      194      802    1   END KFG$FRG_MSG;

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:26   
--  Include file information  --

   KF_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   KF$MSG_C.:E05TOU  is referenced.
   KF$MSG_SUBS.:E05TOU  is referenced.
   KF$SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KFG$FRG_MSG.
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:27   

 **** Variables and constants ****

  ****  Section 007  Data  KFG$FRG_MSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   134-0-0/w STRC(576)   r     1 CGMA                      76-0-0/d STRC(1080)  r     1 CLSLOGFPT
     0-0-0/d STRC(2088)  r     1 OPNLOGFPT                 72-0-0/c STRC(81)    r     1 Y_LOGFILENAME

  ****  Section 008 RoData KFG$FRG_MSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(576)   r     1 AC_DEAC                   20-0-0/d STRC(1512)  r     1 FPT_FWCG
    72-0-0/d STRC(72)    r     1 SCGMA

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    17-0-0/w PTR         r     1 @Y$TYPE                    3-0-0/w UBIN        r     1 Y$ARS
    13-0-0/w PTR         r     1 Y$BUF$                     7-0-0/w UBIN        r     1 Y$COUNT
     4-0-0/w UBIN        r     1 Y$INDEX                    5-0-0/w UBIN        r     1 Y$INDEX2
    14-0-0/w PTR         r     1 Y$L$                      12-0-0/w UBIN        r     1 Y$MSG_ID
    10-0-0/c CHAR(8)     r     1 Y$STA                     *0-0-0/c CHAR(4)     r     1 Y$TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(600)   r     1 KF_FECGBUF                 0-0-0/c CHAR(600)   r     1 KF_FECG_OUTBUF
     0-0-0/c CHAR(8)     r     1 KF_FECG_STA                0-0-0/w STRC(306)   r     1 KF_UTBL(0:20)

PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:28   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(18)    r     1 KF$MSG
     0-0-0/w STRC(90)    r     1 KF$MSG_EXCLDCB             0-0-0/w STRC(54)    r     1 KF$MSG_LSTRQS
     0-0-0/w STRC(7236)  r     1 KF$MSG_LSTRSP              0-0-0N  NULL        r     1 M$FE
     0-0-0N  NULL        r     1 M$LOG


   Procedure KFG$FRG_MSG requires 192 words for executable code.
   Procedure KFG$FRG_MSG requires 20 words of local(AUTO) storage.

    No errors detected in file KFG$FRG_MSG.:E05TSI    .
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:29   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:30   
          MINI XREF LISTING

AC_DEAC
       602**DCL       726<>CALL      727<>CALL
AC_DEAC.V
       603**DCL       602--DCLINIT
AC_DEAC.V.DVBYTE.REREAD#
       605**DCL       605--REDEF
CGMA
       645**DCL       625--DCLINIT
CGMA.DEST#
       653**DCL       725<<ASSIGN
CGMA.MSGIDXT
       654**DCL       657--REDEF
CGMA.ORIGIN#
       650**DCL       602--DCLINIT   724<<ASSIGN
CLSLOGFPT.SN_
       571**DCL       571--REDEF
CLSLOGFPT.UTL_
       572**DCL       572--REDEF
CLSLOGFPT.V
       576**DCL       571--DCLINIT
CLSLOGFPT.V.EXPIRE#
       586**DCL       586--REDEF
CLSLOGFPT.V.TYPE#
       584**DCL       584--REDEF
CLSLOGFPT.V.XTNSIZE#
       581**DCL       581--REDEF     583--REDEF
EHWHAT
       725**LABEL     726--CALLALT   727--CALLALT   728--CALLALT
F$DCB.ACTPOS
       358**DCL       358--REDEF
F$DCB.ARS#
       332**DCL       332--REDEF
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:31   
F$DCB.ATTR
       351**DCL       352--REDEF
F$DCB.BORROW
       366**DCL       366--REDEF     366--REDEF     366--REDEF
F$DCB.DCBNAME.L
       380**DCL       380--IMP-SIZ
F$DCB.EOMCHAR#
       336**DCL       336--REDEF
F$DCB.FLDID
       361**DCL       361--REDEF
F$DCB.FORM$
       355**DCL       355--REDEF
F$DCB.FSECT
       371**DCL       371--REDEF
F$DCB.FSN#
       348**DCL       348--REDEF     348--REDEF     349--REDEF
F$DCB.HEADER$
       354**DCL       354--REDEF
F$DCB.IXTNSIZE#
       352**DCL       352--REDEF
F$DCB.LASTSTA$
       341**DCL       341--REDEF
F$DCB.LVL
       367**DCL       367--REDEF
F$DCB.NAME#.C
       342**DCL       342--REDEF
F$DCB.NOEOF
       364**DCL       364--REDEF
F$DCB.NRECS#
       353**DCL       353--REDEF
F$DCB.NRECX
       372**DCL       372--REDEF
F$DCB.OHDR
       364**DCL       364--REDEF
F$DCB.ORG#
       347**DCL       347--REDEF
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:32   
F$DCB.PRECNO
       370**DCL       370--REDEF
F$DCB.RCSZ
       376**DCL       376--REDEF
F$DCB.RES#
       343**DCL       343--REDEF
F$DCB.SETX
       355**DCL       355--REDEF
F$DCB.TAB$
       355**DCL       355--REDEF
F$DCB.TDA
       369**DCL       370--REDEF
F$DCB.WSN#
       343**DCL       343--REDEF
FPT_FWCG
       625**DCL       728<>CALL
FPT_FWCG.V
       628**DCL       625--DCLINIT
KF$MSG.MSG_ID
       384**DCL       705>>ASSIGN    713<<ASSIGN    739<<ASSIGN
KF$MSG.MSG_SUBC
       385**DCL       716<<ASSIGN    719<<ASSIGN    721<<ASSIGN    740<<ASSIGN
KF$MSG_EXCLDCB.STATION
       404**DCL       711>>ASSIGN
KF$MSG_LSTRQS.MSG_SUBC
       390**DCL       775>>ASSIGN
KF$MSG_LSTRQS.NAME
       391**DCL       709<>CALL
KF$MSG_LSTRSP.COUNT
       397**DCL       795<<ASSIGN
KF$MSG_LSTRSP.MSG_ID
       395**DCL       774<<ASSIGN
KF$MSG_LSTRSP.MSG_SUBC
       396**DCL       775<<ASSIGN
KF$MSG_LSTRSP.STATION
       398**DCL       788<<ASSIGN
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:33   
KFB$FIFS
       699**DCL-ENT   714--CALL
KFG$LST
       761**PROC      709--CALL
KFW$WRT_MSG
       693**DCL-ENT   732--CALL      743--CALL      799--CALL
KF_FECGBUF
       313**DCL       703--ASSIGN
KF_FECG_OUTBUF
       313**DCL       712--ASSIGN    732<>CALL      738--ASSIGN    743<>CALL      769--ASSIGN    773<<ASSIGN
       799<>CALL
KF_FECG_STA
       313**DCL       723>>ASSIGN    732<>CALL      742>>ASSIGN    798>>ASSIGN
KF_UTBL.DCBSTATION
       318**DCL       723<<ASSIGN
KF_UTBL.FLAGS.EXCLDCB
       317**DCL       718>>IF        722<<ASSIGN
KF_UTBL.STA.ID
       316**DCL       785>>IF
KF_UTBL.STATE
       316**DCL       783>>IF
KF_UTBL.STATION
       316**DCL       316--REDEF     788>>ASSIGN
M$ACTIVATE
        70**DCL-ENT   727--CALL
M$DEACTIVATE
        70**DCL-ENT   726--CALL
M$FWCG
        71**DCL-ENT   728--CALL
OPNLOGFPT.ACSVEH_
       479**DCL       480--REDEF
OPNLOGFPT.ALTKEYS_
       485**DCL       486--REDEF     486--REDEF
OPNLOGFPT.HDR_
       484**DCL       485--REDEF
OPNLOGFPT.TAB_
PL6.E3A0      #001=KFG$FRG_MSG File=KFG$FRG_MSG.:E05TSI                          WED 07/30/97 00:22 Page:34   
       483**DCL       484--REDEF
OPNLOGFPT.UHL_
       477**DCL       478--REDEF     478--REDEF
OPNLOGFPT.V
       486**DCL       477--DCLINIT
OPNLOGFPT.V.FSN#
       517**DCL       517--REDEF     517--REDEF
OPNLOGFPT.WSN_
       483**DCL       483--REDEF
SCGMA
       671**DCL       626--DCLINIT
Y$ARS
       680**DCL       741<<ASSIGN    743<>CALL      796<<ASSIGN    797<<ASSIGN    799<>CALL
Y$BUF$
       687**DCL       712<<ASSIGN    713>>ASSIGN    716>>ASSIGN    719>>ASSIGN    721>>ASSIGN    738<<ASSIGN
       739>>ASSIGN    740>>ASSIGN    769<<ASSIGN    774>>ASSIGN    775>>ASSIGN    788>>ASSIGN    795>>ASSIGN
Y$COUNT
       684**DCL       768<<ASSIGN    789<<ASSIGN    789>>ASSIGN    795>>ASSIGN    796>>IF        797>>ASSIGN
Y$INDEX
       681**DCL       714<>CALL      715>>IF        718>>IF        722>>ASSIGN    723>>ASSIGN    766<<ASSIGN
       782<<DOINDEX   783>>IF        785>>IF        788>>ASSIGN
Y$INDEX2
       682**DCL       767<<ASSIGN    788>>ASSIGN    790<<ASSIGN    790>>ASSIGN
Y$L$
       688**DCL       703<<ASSIGN    705>>ASSIGN    709>>CALL      711>>ASSIGN    775>>ASSIGN
Y$MSG_ID
       686**DCL       705<<ASSIGN    707>>DOCASE    740>>ASSIGN
Y$STA
       685**DCL       711<<ASSIGN    714<>CALL      724>>ASSIGN    725>>ASSIGN    742<<ASSIGN    743<>CALL
       798<<ASSIGN    799<>CALL
Y$TYPE IN PROCEDURE KFG$LST
       763**DCL       761--PROC      785>>IF        785>>IF
Y_LOGFILENAME
       546**DCL       478--DCLINIT
