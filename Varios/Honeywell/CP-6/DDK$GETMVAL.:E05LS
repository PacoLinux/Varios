VERSION E05

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:1    
        1        1        /*M*  DDK$GETMVAL - fetch / retreive data from an evaluated address */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        DDK$GETMVAL: PROC(VALUE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET;
       10       10          /* Parms */
       11       11    1   DCL VALUE UBIN;
       12       12    1   DCL ADDRESS UBIN;
       13       13    1   DCL SEG UBIN;
       14       14    1   DCL DESC# UBIN;
       15       15    1   DCL NOT_IS BIT(1) ALIGNED;
       16       16          /* Locals */
       17       17    1   DCL 1 POINTER,
       18       18    1         2 TYPE UBIN(6) UNAL,
       19       19    1         2 ID UBIN(9) UNAL,
       20       20    1         2 DISP UBIN(9) UNAL,
       21       21    1         2 SEGID UBIN(12) UNAL;
       22       22    1   DCL PNTR REDEF POINTER UBIN;
       23       23        %INCLUDE DD_DESC_R;
       24       73    1   DCL SPSEG(0:10) UBIN CONSTANT INIT(
       25       74    1        %REAL_DESC,                        /* 0 - REAL_DESC */
       26       75    1        %VIRT_DESC,                        /* 1 - VIRT_DESC */
       27       76    1        %IOBUF_DESC,                       /* 2 - IOBUF_DESC */
       28       77    1        %PSR_DESC,                         /* 3 - PSR_DESC */
       29       78    1        %ASR_DESC,                         /* 4 - ASR_DESC */
       30       79    1        %LSR_DESC,                         /* 5 - LSR_DESC */
       31       80    1        %SSR_DESC,                         /* 6 - SSR_DESC */
       32       81    1        %JIT_DESC,                         /* 7 - JIT_DESC */
       33       82    1        %HJIT_DESC,                        /* 8 - HJIT_DESC */
       34       83    1        %TCB_DESC,                         /* 9 - TCB_DESC */
       35       84    1        %SAD_DESC);                        /*10 - SAD_DESC */
       36       85    1   DCL 1 ITEM,
       37       86    1         2 * BIT(9),
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:2    
       38       87    1         2 FLAGS BIT(9),
       39       88    1         2 ADDR_TYPE UBIN BYTE UNAL,
       40       89    1         2 TYPE_CODE UBIN BYTE UNAL,
       41       90    1         2 ADR,
       42       91    1           3 W UBIN(24) UNAL,
       43       92    1           3 C UBIN(6) UNAL,
       44       93    1           3 B UBIN(6) UNAL,
       45       94    1         2 VALUE REDEF ADR UBIN WORD UNAL;
       46       95    1   DCL PUT_FLAG BIT(1);
       47       96    1   DCL DSIZE UBIN;
       48       97    1   DCL RSIZE UBIN;
       49       98    1   DCL EXPR_OP UBIN;
       50       99    1   DCL ADDR_TYPE UBIN;
       51      100    1   DCL ARRAY_FLAG BIT(1);
       52      101    1   DCL TRUNC_FLAG BIT(1);
       53      102    1   DCL ID UBIN;
       54      103    1   DCL SZ UBIN;
       55      104    1   DCL 1 SITEM_VAL,
       56      105    1         2 * BIT(18),
       57      106    1         2 ADDR_TYPE UBIN BYTE UNAL,
       58      107    1         2 * BIT(9),
       59      108    1         2 ID UBIN(9) UNAL,
       60      109    1         2 SZ UBIN(9) UNAL,
       61      110    1         2 * UBIN(18) UNAL;
       62      111    1   DCL 1 SDITEM_VAL REDEF SITEM_VAL,
       63      112    1         2 * BIT(36),
       64      113    1         2 TYPE UBIN(6) UNAL,
       65      114    1         2 ID UBIN(9) UNAL,
       66      115    1         2 DISP UBIN(9) UNAL,
       67      116    1         2 * UBIN(12) UNAL;
       68      117    1   DCL UBIN36 UBIN BASED;
       69      118        %INCLUDE DD$DITEM;
       12+     221             %LIST;
       13+     222    1        DCL SDD$ PTR;
       14+     223    1        DCL ZITEM$ PTR;
       15+     224    1        DCL SDD_L6$ PTR;
       16+     225    1        DCL ZITEM_L6$ PTR;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:3    
       70      799    1   DCL 1 BASED_ITEM CONSTANT,
       71      800    1         2 * UBIN(18) UNAL INIT(0),
       72      801    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BASED_ACODE),
       73      802    1         2 * UBIN(9) UNAL INIT(0),
       74      803    1         2 * BIT(36) INIT('0'B);
       75      804    1   DCL 1 BIGBASED_ITEM CONSTANT,
       76      805    1         2 * UBIN(18) UNAL INIT(0),
       77      806    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BIGBASED_ACODE),
       78      807    1         2 * UBIN(9) UNAL INIT(0),
       79      808    1         2 * BIT(36) INIT('0'B);
       80      809    1   DCL 1 STATIC_ITEM CONSTANT,
       81      810    1         2 * UBIN(18) UNAL INIT(0),
       82      811    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%STATIC_ACODE),
       83      812    1         2 * UBIN(9) UNAL INIT(0),
       84      813    1         2 * BIT(36) INIT('0'B);
       85      814    1   DCL 1 BIGSTATIC_ITEM CONSTANT,
       86      815    1         2 * UBIN(18) UNAL INIT(0),
       87      816    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BIGSTATIC_ACODE),
       88      817    1         2 * UBIN(9) UNAL INIT(0),
       89      818    1         2 * BIT(36) INIT('0'B);
       90      819          /* External routines */
       91      820    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
       92      821    1   DCL DDK$PUTVAL ENTRY(13) ALTRET;
       93      822    1   DCL DDK$PUTSPEC ENTRY(2);
       94      823    1   DCL DDE$ERROR ENTRY;
       95      824          /* Misc */
       96      825    1   DCL USE$ PTR SYMREF;
       97      826    1   DCL WSR(0:7) UBIN(9) UNAL SYMREF;
       98      827    1   DCL MIS$ PTR SYMREF;
       99      828    1   DCL D_XDELTA BIT(1) ALIGNED SYMREF;
      100      829        %INCLUDE DD$BASED;
      101     2132        %U$SE;
      102     2140        %HOST_REG$VALUES;
      103     2153        %INCLUDE DD_SUBS_C;
      104     2424        %INCLUDE DD_ERR_C;
      105     2821        %INCLUDE DD_EIS_C;
      106     2847        %INCLUDE XUH_MACRO_C;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:4    
      107     2931        %INCLUDE DD_SD_M;
      108     4267        %S_D;
      109     5585        %INCLUDE B$SS;
      110     5764        %INCLUDE CP_6;
      111     5845        %FPT_DRTN(FPTN=FPT$DRTN,STCLASS=BASED);
      112     5869                                                /**/
      113     5870    1        PUT_FLAG = '0'B;                   /* Indicates get entry */
      114     5871    1        GOTO GETPUT;                       /* Merge with put routine */
      115     5872                                                /**/
      116     5873    1   DDK$PUTMVAL: ENTRY(VALUE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET;
      117     5874                                                /**/
      118     5875    1        PUT_FLAG = '1'B;                   /* Indicates put entry */
      119     5876                                                /**/
      120     5877    1   GETPUT:
      121     5878    1        IF NOT_IS
      122     5879    2        THEN DO;
      123     5880    3             DO CASE( SEG );
      124     5881    3               CASE( 6 );                  /* Host Encoded special symbols */
      125     5882    3                  GOTO GOTSPEC;
      126     5883    3               CASE( 0 );                  /* $PSn */
      127     5884    3                  POINTER = DESC.ITEM(%PS_DESC);
      128     5885    3                  POINTER.DISP = DESC# * 2;
      129     5886    3               CASE( 2 );                  /* $ASn */
      130     5887    3                  POINTER = DESC.ITEM(%AS_DESC);
      131     5888    3                  POINTER.DISP = DESC# * 2;
      132     5889    3               CASE( 3 );                  /* $LSn */
      133     5890    3                  POINTER = DESC.ITEM(%LS_DESC);
      134     5891    3                  POINTER.DISP = DESC# * 2;
      135     5892    3               CASE( 1 );                  /* $REAL, $VIRT, $IOBUF, $PSR, ... */
      136     5893    3                  IF DESC# > 10
      137     5894    4                  THEN DO;
      138     5895    4                       S_D.ERROR = 182; /* E@NOTANLZ_FILE */
      139     5896    4                       ALTRETURN;
      140     5897    4                     END;
      141     5898    3                  POINTER = DESC.ITEM(SPSEG(DESC#));
      142     5899    3               CASE( 5 );                  /* $DCBn */
      143     5900    3                  POINTER = DESC.ITEM( %DCB_DESC );
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:5    
      144     5901    3                  POINTER.DISP = DESC#;
      145     5902    3               CASE( 7 ) ;                 /* $SA, $PRIV */
      146     5903    3                  S_D.ERROR = 202;   /* E@RUMONLY */
      147     5904    3                  ALTRETURN;
      148     5905    3               CASE( 9 );                  /* L6 Encoded special symbols */
      149     5906    3                  IF S_D.RUM
      150     5907    3                  THEN S_D.ERROR = 232; /* E@NOSSRUM */
      151     5908    3                  ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */
      152     5909    3                  ALTRETURN;
      153     5910    3               CASE( 13 ) ;                /* $RES */
      154     5911    3                  POINTER = DESC.ITEM(%RES_DESC); /* RES_DESC */
      155     5912    3               END;                        /* DO CASE(SEG) */
      156     5913    2             IF ADDRESS < BITBIN('1000000'O)
      157     5914    3             THEN DO;
      158     5915    3                  ITEM = BASED_ITEM;
      159     5916    3                  ITEM.ADR.W = ADDRESS;
      160     5917    3                END;
      161     5918    3             ELSE DO;
      162     5919    3                  IF NOT(SEG = 3 AND (DESC# > 25 OR DESC# < 29)) AND
      163     5920    3                    (SEG ~= 1 OR DESC# > 1)
      164     5921    4                  THEN DO;                 /* Not $REAL, $VIRT -> error */
      165     5922    4                       S_D.ERROR = 40; /* E@ADDREXPG256K */
      166     5923    4                       ALTRETURN;
      167     5924    4                     END;
      168     5925    3                  ITEM = BIGBASED_ITEM;
      169     5926    3                  ITEM.VALUE = ADDRESS;
      170     5927    3                END;
      171     5928    2             POINTER = POINTER & '777777770000'O | '000000002000'O;
      172     5929    2           END;                            /* DO ( NOT_IS ) */
      173     5930    2        ELSE DO;                           /* Instruction segment */
      174     5931    2             IF ADDRESS < BITBIN('1000000'O)
      175     5932    3             THEN DO;
      176     5933    3                  ITEM = STATIC_ITEM;
      177     5934    3                  ITEM.ADR.W = ADDRESS;
      178     5935    3                END;
      179     5936    3             ELSE DO;
      180     5937    3                  IF U$SE.TYPE ~= 1 /* USE_REAL */
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:6    
      181     5938    3                    AND U$SE.TYPE ~= 2 /* USE_PT */
      182     5939    4                  THEN DO;
      183     5940    4                       S_D.ERROR = 83; /* E@BADADDR */
      184     5941    4                       ALTRETURN;
      185     5942    4                     END;
      186     5943    3                  ITEM = BIGSTATIC_ITEM;
      187     5944    3                  ITEM.VALUE = ADDRESS;
      188     5945    3                END;
      189     5946    2           END;                            /* DO ( instruction segment ) */
      190     5947    1        DSIZE = 36;
      191     5948    1        RSIZE = 36;
      192     5949    1        EXPR_OP = 0;
      193     5950    1        ADDR_TYPE = ITEM.ADDR_TYPE;
      194     5951    1        ARRAY_FLAG = '0'B;
      195     5952    1        TRUNC_FLAG = '1'B;
      196     5953                                                /**/
      197     5954    1        IF PUT_FLAG
      198     5955    1        THEN CALL DDK$PUTVAL(ADDR(VALUE), ITEM, 0, DSIZE, RSIZE, 0,
      199     5956    1               POINTER, 0, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      200     5957    1               TRUNC_FLAG, BITBIN('400000000003'O)) ALTRET(ARET);
      201     5958    1        ELSE CALL DDK$GETVAL(ADDR(VALUE), ITEM, 0, DSIZE, RSIZE, 0,
      202     5959    1               POINTER, 0, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      203     5960    1               TRUNC_FLAG) ALTRET(ARET);
      204     5961                                                /**/
      205     5962    1        RETURN;
      206     5963    1   ARET:
      207     5964    1        ALTRETURN;
      208     5965    1   GOTSPEC:                 /* Come here if address is encoded special symbol */
      209     5966    1        IF PUT_FLAG
      210     5967    2        THEN DO;
      211     5968    2             SZ = 0;
      212     5969    3             DO CASE( DESC# );
      213     5970    3               CASE( 0 );                  /* $E, $A, $Q, $Xn, $IND, $IC */
      214     5971    4                  DO CASE( ADDRESS );
      215     5972    4                    CASE( 0 );
      216     5973    4                       ID = %E_RTN;
      217     5974    4                    CASE( 1 );
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:7    
      218     5975    4                       ID = %A_RTN;
      219     5976    4                    CASE( 2 );
      220     5977    4                       ID = %Q_RTN;
      221     5978    4                    CASE( 3, 4, 5, 6, 7, 8, 9, 10 );
      222     5979    4                       ID = %X_RTN;
      223     5980    4                       SZ = ADDRESS - 3;
      224     5981    4                    CASE( 11 );
      225     5982    4                       ID = %IND_RTN;
      226     5983    4                    CASE( 12 );
      227     5984    4                       ID = %IC_RTN;
      228     5985    4                    END;                   /* DO CASE( ADDRESS ) */
      229     5986    3               CASE( 1 );                  /* $ARn */
      230     5987    3                  ID = %AR_RTN;
      231     5988    3                  SZ = ADDRESS;
      232     5989    3               CASE( 2 );                  /* $PRn */
      233     5990    3                  SITEM_VAL = DESC(%PR_DESC);
      234     5991    3                  SDITEM_VAL.DISP = ADDRESS * 2 + 24;
      235     5992    3                  SITEM_VAL.ADDR_TYPE = %DESC_ACODE;
      236     5993    3                  GOTO PUTSPEC;
      237     5994    3               CASE( 3 );                  /* $AU, $AL, $QU, $QL */
      238     5995    4                  DO CASE( ADDRESS );
      239     5996    4                    CASE( 0 );
      240     5997    4                       ID = %AU_RTN;
      241     5998    4                    CASE( 1 );
      242     5999    4                       ID = %AL_RTN;
      243     6000    4                    CASE( 2 );
      244     6001    4                       ID = %QU_RTN;
      245     6002    4                    CASE( 3 );
      246     6003    4                       ID = %QL_RTN;
      247     6004    4                    END;                   /* DO CASE( ADDRESS ) */
      248     6005    3               CASE( 4 );                  /* $IOBUFSZ */
      249     6006    4                  DO CASE( ADDRESS );
      250     6007    4                    CASE( 0 );
      251     6008    4                       ID = %IOBUFSZ_RTN;
      252     6009    4                    END;                   /* DO CASE( ADDRESS ) */
      253     6010    3               CASE( 5 );                  /* $WSRn */
      254     6011    3                  ID = %WSR_RTN;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:8    
      255     6012    3                  SZ = ADDRESS;
      256     6013    3               CASE( 6 );                  /* $WSQn */
      257     6014    3                  ID = %WSQ_RTN;
      258     6015    3                  SZ = ADDRESS;
      259     6016    3               CASE( 7 );                  /* $FMASK, $FRANGE */
      260     6017    3                  IF ADDRESS = 0
      261     6018    3                  THEN ID = %FMASK_RTN;
      262     6019    3                  ELSE ID = %FRANGE_RTN;
      263     6020    3               END;                        /* DO CASE( DESC# ) */
      264     6021    2             SITEM_VAL = '0'B;
      265     6022    2             SITEM_VAL.ID = ID;
      266     6023    2             SITEM_VAL.SZ = SZ;
      267     6024    2   PUTSPEC:  ;
      268     6025    2             CALL DDK$PUTSPEC(SITEM_VAL, VALUE);
      269     6026    2             RETURN;
      270     6027    2           END;
      271     6028        /* Must be GETMVAL, need to fetch value */
      272     6029    2        DO CASE( DESC# );
      273     6030    2          CASE( 0 );                       /* $E, $A, $Q, $Xn, $IND, $IC */
      274     6031    3             DO CASE( ADDRESS );
      275     6032    3               CASE( 0 );
      276     6033    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.E;
      277     6034    3               CASE( 1 );
      278     6035    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.A;
      279     6036    3               CASE( 2 );
      280     6037    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.Q;
      281     6038    3               CASE( 3, 4, 5, 6, 7, 8, 9, 10 );
      282     6039    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.X( ADDRESS - 3 );
      283     6040    3               CASE( 11 );
      284     6041    3                  IF D_XDELTA
      285     6042    3                  THEN VALUE = BITBIN(S_D.USS$ -> B$SS.IR);
      286     6043    3                  ELSE VALUE = BITBIN(S_D.DRTN$ -> FPT$DRTN.V.IR#);
      287     6044    3               CASE( 12 );
      288     6045    3                  VALUE = S_D.SAVEIC;
      289     6046    3               CASE( ELSE );
      290     6047    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */
      291     6048    3                  ALTRETURN;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:9    
      292     6049    3               END;                        /* DO CASE( ADDRESS ) */
      293     6050    2          CASE( 1 );                       /* $ARn */
      294     6051    2             IF ADDRESS > 7
      295     6052    3             THEN DO;
      296     6053    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */
      297     6054    3                  ALTRETURN;
      298     6055    3                END;
      299     6056    2             VALUE = PINCRW(S_D.USS$, 16 + ADDRESS) -> UBIN36;
      300     6057    2          CASE( 2 );                       /* $PRn */
      301     6058    2             IF ADDRESS > 7
      302     6059    3             THEN DO;
      303     6060    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */
      304     6061    3                  ALTRETURN;
      305     6062    3                END;
      306     6063    2             VALUE = PINCRW(S_D.USS$, 16 + ADDRESS) -> UBIN36;
      307     6064    2          CASE( 3 );                       /* $AU, $AL, $QU, $QL */
      308     6065    3             DO CASE( ADDRESS );
      309     6066    3               CASE( 0 );
      310     6067    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HA.AU;
      311     6068    3               CASE( 1 );
      312     6069    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HA.AL;
      313     6070    3               CASE( 2 );
      314     6071    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HQ.QU;
      315     6072    3               CASE( 3 );
      316     6073    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HQ.QL;
      317     6074    3               CASE( ELSE );
      318     6075    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */
      319     6076    3                  ALTRETURN;
      320     6077    3               END;                        /* DO CASE( ADDRESS ) */
      321     6078    2          CASE( 4 );                       /* $IOBUFSZ */
      322     6079    2             VALUE = S_D.SV.IOBUFSZ;
      323     6080    2          CASE( 5 );                       /* $WSRn */
      324     6081    2             VALUE = WSR( ADDRESS );
      325     6082    2          CASE( 6 );                       /* $WSQn */
      326     6083    2             VALUE = PINCRW(MIS$, ADDRESS) -> UBIN36;
      327     6084    2          CASE( 7 );                       /* $FMASK, $FRANGE  */
      328     6085    2             IF ADDRESS > 2
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:10   
      329     6086    3             THEN DO;
      330     6087    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */
      331     6088    3                  ALTRETURN;
      332     6089    3                END;
      333     6090    2             IF ADDRESS = 0
      334     6091    2             THEN VALUE = S_D.FIND.MASK_F;
      335     6092    2             ELSE VALUE = S_D.FIND.NUM;
      336     6093    2          END;                             /* DO CASE( DESC# ) */
      337     6094    1        RETURN;
      338     6095    1   END DDK$GETMVAL;
      339     6096        %EOD;

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:11   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_EIS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDK$GETMVAL.

   Procedure DDK$GETMVAL requires 579 words for executable code.
   Procedure DDK$GETMVAL requires 40 words of local(AUTO) storage.

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:12   

 Object Unit name= DDK$GETMVAL                                File name= DDK$GETMVAL.:E05TOU
 UTS= JUL 29 '97 14:02:29.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     23     27  DDK$GETMVAL
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   579   1103  DDK$GETMVAL
    3  RoData even  none     5      5  DDK$GETMVAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        5  DDK$GETMVAL
     2      4          yes     yes      Std        5  DDK$PUTMVAL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std      13 DDK$PUTVAL
 yes     yes           Std      13 DDK$GETVAL
         yes           Std       2 DDK$PUTSPEC
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DESC                                  USE$                                  WSR
     MIS$                                  D_XDELTA                         r    S_D$
     M$UC                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:14   


        1        1        /*M*  DDK$GETMVAL - fetch / retreive data from an evaluated address */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        DDK$GETMVAL: PROC(VALUE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET;

      9  2 000000   000000 700200 xent  DDK$GETMVAL  TSX0  ! X66_AUTO_5
         2 000001   000050 000005                    ZERO    40,5

       10       10          /* Parms */
       11       11    1   DCL VALUE UBIN;
       12       12    1   DCL ADDRESS UBIN;
       13       13    1   DCL SEG UBIN;
       14       14    1   DCL DESC# UBIN;
       15       15    1   DCL NOT_IS BIT(1) ALIGNED;
       16       16          /* Locals */
       17       17    1   DCL 1 POINTER,
       18       18    1         2 TYPE UBIN(6) UNAL,
       19       19    1         2 ID UBIN(9) UNAL,
       20       20    1         2 DISP UBIN(9) UNAL,
       21       21    1         2 SEGID UBIN(12) UNAL;
       22       22    1   DCL PNTR REDEF POINTER UBIN;
       23       23        %INCLUDE DD_DESC_R;
       24       73    1   DCL SPSEG(0:10) UBIN CONSTANT INIT(
       25       74    1        %REAL_DESC,                        /* 0 - REAL_DESC */
       26       75    1        %VIRT_DESC,                        /* 1 - VIRT_DESC */
       27       76    1        %IOBUF_DESC,                       /* 2 - IOBUF_DESC */
       28       77    1        %PSR_DESC,                         /* 3 - PSR_DESC */
       29       78    1        %ASR_DESC,                         /* 4 - ASR_DESC */
       30       79    1        %LSR_DESC,                         /* 5 - LSR_DESC */
       31       80    1        %SSR_DESC,                         /* 6 - SSR_DESC */
       32       81    1        %JIT_DESC,                         /* 7 - JIT_DESC */
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:15   
       33       82    1        %HJIT_DESC,                        /* 8 - HJIT_DESC */
       34       83    1        %TCB_DESC,                         /* 9 - TCB_DESC */
       35       84    1        %SAD_DESC);                        /*10 - SAD_DESC */
       36       85    1   DCL 1 ITEM,
       37       86    1         2 * BIT(9),
       38       87    1         2 FLAGS BIT(9),
       39       88    1         2 ADDR_TYPE UBIN BYTE UNAL,
       40       89    1         2 TYPE_CODE UBIN BYTE UNAL,
       41       90    1         2 ADR,
       42       91    1           3 W UBIN(24) UNAL,
       43       92    1           3 C UBIN(6) UNAL,
       44       93    1           3 B UBIN(6) UNAL,
       45       94    1         2 VALUE REDEF ADR UBIN WORD UNAL;
       46       95    1   DCL PUT_FLAG BIT(1);
       47       96    1   DCL DSIZE UBIN;
       48       97    1   DCL RSIZE UBIN;
       49       98    1   DCL EXPR_OP UBIN;
       50       99    1   DCL ADDR_TYPE UBIN;
       51      100    1   DCL ARRAY_FLAG BIT(1);
       52      101    1   DCL TRUNC_FLAG BIT(1);
       53      102    1   DCL ID UBIN;
       54      103    1   DCL SZ UBIN;
       55      104    1   DCL 1 SITEM_VAL,
       56      105    1         2 * BIT(18),
       57      106    1         2 ADDR_TYPE UBIN BYTE UNAL,
       58      107    1         2 * BIT(9),
       59      108    1         2 ID UBIN(9) UNAL,
       60      109    1         2 SZ UBIN(9) UNAL,
       61      110    1         2 * UBIN(18) UNAL;
       62      111    1   DCL 1 SDITEM_VAL REDEF SITEM_VAL,
       63      112    1         2 * BIT(36),
       64      113    1         2 TYPE UBIN(6) UNAL,
       65      114    1         2 ID UBIN(9) UNAL,
       66      115    1         2 DISP UBIN(9) UNAL,
       67      116    1         2 * UBIN(12) UNAL;
       68      117    1   DCL UBIN36 UBIN BASED;
       69      118        %INCLUDE DD$DITEM;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:16   
       12+     221             %LIST;
       13+     222    1        DCL SDD$ PTR;
       14+     223    1        DCL ZITEM$ PTR;
       15+     224    1        DCL SDD_L6$ PTR;
       16+     225    1        DCL ZITEM_L6$ PTR;
       70      799    1   DCL 1 BASED_ITEM CONSTANT,
       71      800    1         2 * UBIN(18) UNAL INIT(0),
       72      801    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BASED_ACODE),
       73      802    1         2 * UBIN(9) UNAL INIT(0),
       74      803    1         2 * BIT(36) INIT('0'B);
       75      804    1   DCL 1 BIGBASED_ITEM CONSTANT,
       76      805    1         2 * UBIN(18) UNAL INIT(0),
       77      806    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BIGBASED_ACODE),
       78      807    1         2 * UBIN(9) UNAL INIT(0),
       79      808    1         2 * BIT(36) INIT('0'B);
       80      809    1   DCL 1 STATIC_ITEM CONSTANT,
       81      810    1         2 * UBIN(18) UNAL INIT(0),
       82      811    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%STATIC_ACODE),
       83      812    1         2 * UBIN(9) UNAL INIT(0),
       84      813    1         2 * BIT(36) INIT('0'B);
       85      814    1   DCL 1 BIGSTATIC_ITEM CONSTANT,
       86      815    1         2 * UBIN(18) UNAL INIT(0),
       87      816    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BIGSTATIC_ACODE),
       88      817    1         2 * UBIN(9) UNAL INIT(0),
       89      818    1         2 * BIT(36) INIT('0'B);
       90      819          /* External routines */
       91      820    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
       92      821    1   DCL DDK$PUTVAL ENTRY(13) ALTRET;
       93      822    1   DCL DDK$PUTSPEC ENTRY(2);
       94      823    1   DCL DDE$ERROR ENTRY;
       95      824          /* Misc */
       96      825    1   DCL USE$ PTR SYMREF;
       97      826    1   DCL WSR(0:7) UBIN(9) UNAL SYMREF;
       98      827    1   DCL MIS$ PTR SYMREF;
       99      828    1   DCL D_XDELTA BIT(1) ALIGNED SYMREF;
      100      829        %INCLUDE DD$BASED;
      101     2132        %U$SE;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:17   
      102     2140        %HOST_REG$VALUES;
      103     2153        %INCLUDE DD_SUBS_C;
      104     2424        %INCLUDE DD_ERR_C;
      105     2821        %INCLUDE DD_EIS_C;
      106     2847        %INCLUDE XUH_MACRO_C;
      107     2931        %INCLUDE DD_SD_M;
      108     4267        %S_D;
      109     5585        %INCLUDE B$SS;
      110     5764        %INCLUDE CP_6;
      111     5845        %FPT_DRTN(FPTN=FPT$DRTN,STCLASS=BASED);
      112     5869                                                /**/
      113     5870    1        PUT_FLAG = '0'B;                   /* Indicates get entry */

   5870  2 000002   200013 450100                    STZ     PUT_FLAG,,AUTO

      114     5871    1        GOTO GETPUT;                       /* Merge with put routine */

   5871  2 000003   000010 710000 2                  TRA     GETPUT

      115     5872                                                /**/
      116     5873    1   DDK$PUTMVAL: ENTRY(VALUE, ADDRESS, SEG, DESC#, NOT_IS) ALTRET;

   5873  2 000004   000000 700200 xent  DDK$PUTMVAL  TSX0  ! X66_AUTO_5
         2 000005   000050 000005                    ZERO    40,5

      117     5874                                                /**/
      118     5875    1        PUT_FLAG = '1'B;                   /* Indicates put entry */

   5875  2 000006   400000 236003                    LDQ     -131072,DU
         2 000007   200013 756100                    STQ     PUT_FLAG,,AUTO

      119     5876                                                /**/
      120     5877    1   GETPUT:
      121     5878    1        IF NOT_IS

   5878  2 000010   200007 470500       GETPUT       LDP0    @NOT_IS,,AUTO
         2 000011   000000 234100                    SZN     0,,PR0
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:18   
         2 000012   000216 605000 2                  TPL     s:5931

      122     5879    2        THEN DO;

      123     5880    3             DO CASE( SEG );

   5880  2 000013   200005 471500                    LDP1    @SEG,,AUTO
         2 000014   100000 235100                    LDA     0,,PR1
         2 000015   000016 115007                    CMPA    14,DL
         2 000016   000020 602005 2                  TNC     s:5880+5,AL
         2 000017   000143 710000 2                  TRA     s:5913
         2 000020   000037 710000 2                  TRA     s:5884
         2 000021   000075 710000 2                  TRA     s:5893
         2 000022   000051 710000 2                  TRA     s:5887
         2 000023   000063 710000 2                  TRA     s:5890
         2 000024   000143 710000 2                  TRA     s:5913
         2 000025   000113 710000 2                  TRA     s:5900
         2 000026   000036 710000 2                  TRA     s:5882
         2 000027   000124 710000 2                  TRA     s:5903
         2 000030   000143 710000 2                  TRA     s:5913
         2 000031   000130 710000 2                  TRA     s:5906
         2 000032   000143 710000 2                  TRA     s:5913
         2 000033   000143 710000 2                  TRA     s:5913
         2 000034   000143 710000 2                  TRA     s:5913
         2 000035   000141 710000 2                  TRA     s:5911

      124     5881    3               CASE( 6 );                  /* Host Encoded special symbols */

      125     5882    3                  GOTO GOTSPEC;

   5882  2 000036   000364 710000 2                  TRA     GOTSPEC

      126     5883    3               CASE( 0 );                  /* $PSn */

      127     5884    3                  POINTER = DESC.ITEM(%PS_DESC);

   5884  2 000037   000057 236000 xsym               LDQ     DESC+47
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:19   
         2 000040   200010 756100                    STQ     POINTER,,AUTO

      128     5885    3                  POINTER.DISP = DESC# * 2;

   5885  2 000041   200006 473500                    LDP3    @DESC#,,AUTO
         2 000042   300000 236100                    LDQ     0,,PR3
         2 000043   000001 736000                    QLS     1
         2 000044   000014 736000                    QLS     12
         2 000045   200010 676100                    ERQ     POINTER,,AUTO
         2 000046   000000 376000 3                  ANQ     0
         2 000047   200010 656100                    ERSQ    POINTER,,AUTO
         2 000050   000143 710000 2                  TRA     s:5913

      129     5886    3               CASE( 2 );                  /* $ASn */

      130     5887    3                  POINTER = DESC.ITEM(%AS_DESC);

   5887  2 000051   000055 236000 xsym               LDQ     DESC+45
         2 000052   200010 756100                    STQ     POINTER,,AUTO

      131     5888    3                  POINTER.DISP = DESC# * 2;

   5888  2 000053   200006 473500                    LDP3    @DESC#,,AUTO
         2 000054   300000 236100                    LDQ     0,,PR3
         2 000055   000001 736000                    QLS     1
         2 000056   000014 736000                    QLS     12
         2 000057   200010 676100                    ERQ     POINTER,,AUTO
         2 000060   000000 376000 3                  ANQ     0
         2 000061   200010 656100                    ERSQ    POINTER,,AUTO
         2 000062   000143 710000 2                  TRA     s:5913

      132     5889    3               CASE( 3 );                  /* $LSn */

      133     5890    3                  POINTER = DESC.ITEM(%LS_DESC);

   5890  2 000063   000053 236000 xsym               LDQ     DESC+43
         2 000064   200010 756100                    STQ     POINTER,,AUTO
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:20   

      134     5891    3                  POINTER.DISP = DESC# * 2;

   5891  2 000065   200006 473500                    LDP3    @DESC#,,AUTO
         2 000066   300000 236100                    LDQ     0,,PR3
         2 000067   000001 736000                    QLS     1
         2 000070   000014 736000                    QLS     12
         2 000071   200010 676100                    ERQ     POINTER,,AUTO
         2 000072   000000 376000 3                  ANQ     0
         2 000073   200010 656100                    ERSQ    POINTER,,AUTO
         2 000074   000143 710000 2                  TRA     s:5913

      135     5892    3               CASE( 1 );                  /* $REAL, $VIRT, $IOBUF, $PSR, ... */

      136     5893    3                  IF DESC# > 10

   5893  2 000075   200006 473500                    LDP3    @DESC#,,AUTO
         2 000076   300000 235100                    LDA     0,,PR3
         2 000077   000013 115007                    CMPA    11,DL
         2 000100   000105 602000 2                  TNC     s:5898

      137     5894    4                  THEN DO;

      138     5895    4                       S_D.ERROR = 182; /* E@NOTANLZ_FILE */

   5895  2 000101   000266 236007                    LDQ     182,DL
         2 000102   000000 474400 xsym               LDP4    S_D$
         2 000103   400013 756100                    STQ     11,,PR4

      139     5896    4                       ALTRETURN;

   5896  2 000104   000000 702200 xent               TSX2  ! X66_AALT

      140     5897    4                     END;
      141     5898    3                  POINTER = DESC.ITEM(SPSEG(DESC#));

   5898  2 000105   300000 720100                    LXL0    0,,PR3
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:21   
         2 000106   000000 235010 0                  LDA     SPSEG,X0
         2 000107   000001 735000                    ALS     1
         2 000110   000001 236005 xsym               LDQ     DESC+1,AL
         2 000111   200010 756100                    STQ     POINTER,,AUTO
         2 000112   000143 710000 2                  TRA     s:5913

      142     5899    3               CASE( 5 );                  /* $DCBn */

      143     5900    3                  POINTER = DESC.ITEM( %DCB_DESC );

   5900  2 000113   000071 236000 xsym               LDQ     DESC+57
         2 000114   200010 756100                    STQ     POINTER,,AUTO

      144     5901    3                  POINTER.DISP = DESC#;

   5901  2 000115   200006 473500                    LDP3    @DESC#,,AUTO
         2 000116   300000 236100                    LDQ     0,,PR3
         2 000117   000014 736000                    QLS     12
         2 000120   200010 676100                    ERQ     POINTER,,AUTO
         2 000121   000000 376000 3                  ANQ     0
         2 000122   200010 656100                    ERSQ    POINTER,,AUTO
         2 000123   000143 710000 2                  TRA     s:5913

      145     5902    3               CASE( 7 ) ;                 /* $SA, $PRIV */

      146     5903    3                  S_D.ERROR = 202;   /* E@RUMONLY */

   5903  2 000124   000312 236007                    LDQ     202,DL
         2 000125   000000 473400 xsym               LDP3    S_D$
         2 000126   300013 756100                    STQ     11,,PR3

      147     5904    3                  ALTRETURN;

   5904  2 000127   000000 702200 xent               TSX2  ! X66_AALT

      148     5905    3               CASE( 9 );                  /* L6 Encoded special symbols */

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:22   
      149     5906    3                  IF S_D.RUM

   5906  2 000130   000000 473400 xsym               LDP3    S_D$
         2 000131   304755 234100                    SZN     2541,,PR3
         2 000132   000136 605000 2                  TPL     s:5908

      150     5907    3                  THEN S_D.ERROR = 232; /* E@NOSSRUM */

   5907  2 000133   000350 236007                    LDQ     232,DL
         2 000134   300013 756100                    STQ     11,,PR3
         2 000135   000140 710000 2                  TRA     s:5909

      151     5908    3                  ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */

   5908  2 000136   000460 236007                    LDQ     304,DL
         2 000137   300013 756100                    STQ     11,,PR3

      152     5909    3                  ALTRETURN;

   5909  2 000140   000000 702200 xent               TSX2  ! X66_AALT

      153     5910    3               CASE( 13 ) ;                /* $RES */

      154     5911    3                  POINTER = DESC.ITEM(%RES_DESC); /* RES_DESC */

   5911  2 000141   000051 236000 xsym               LDQ     DESC+41
         2 000142   200010 756100                    STQ     POINTER,,AUTO

      155     5912    3               END;                        /* DO CASE(SEG) */

      156     5913    2             IF ADDRESS < BITBIN('1000000'O)

   5913  2 000143   000023 236000 0                  LDQ     BIGSTATIC_ITEM+2
         2 000144   000017 772000                    QRL     15
         2 000145   200004 473500                    LDP3    @ADDRESS,,AUTO
         2 000146   300000 116100                    CMPQ    0,,PR3
         2 000147   000160 602000 2                  TNC     s:5919
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:23   
         2 000150   000160 600000 2                  TZE     s:5919

      157     5914    3             THEN DO;

      158     5915    3                  ITEM = BASED_ITEM;

   5915  2 000151   000100 100400                    MLR     fill='000'O
         2 000152   000013 000010 0                  ADSC9   BASED_ITEM               cn=0,n=8
         2 000153   200011 000010                    ADSC9   ITEM,,AUTO               cn=0,n=8

      159     5916    3                  ITEM.ADR.W = ADDRESS;

   5916  2 000154   300000 236100                    LDQ     0,,PR3
         2 000155   000014 736000                    QLS     12
         2 000156   200012 752174                    STCQ    ITEM+1,'74'O,AUTO

      160     5917    3                END;

   5917  2 000157   000211 710000 2                  TRA     s:5928

      161     5918    3             ELSE DO;

      162     5919    3                  IF NOT(SEG = 3 AND (DESC# > 25 OR DESC# < 29)) AND

   5919  2 000160   100000 235100                    LDA     0,,PR1
         2 000161   000003 115007                    CMPA    3,DL
         2 000162   000171 601000 2                  TNZ     s:5919+9
         2 000163   200006 474500                    LDP4    @DESC#,,AUTO
         2 000164   400000 235100                    LDA     0,,PR4
         2 000165   000032 115007                    CMPA    26,DL
         2 000166   000204 603000 2                  TRC     s:5925
         2 000167   000035 115007                    CMPA    29,DL
         2 000170   000204 602000 2                  TNC     s:5925
         2 000171   100000 235100                    LDA     0,,PR1
         2 000172   000001 115007                    CMPA    1,DL
         2 000173   000200 601000 2                  TNZ     s:5922
         2 000174   200006 474500                    LDP4    @DESC#,,AUTO
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:24   
         2 000175   400000 235100                    LDA     0,,PR4
         2 000176   000002 115007                    CMPA    2,DL
         2 000177   000204 602000 2                  TNC     s:5925

      163     5920    3                    (SEG ~= 1 OR DESC# > 1)
      164     5921    4                  THEN DO;                 /* Not $REAL, $VIRT -> error */

      165     5922    4                       S_D.ERROR = 40; /* E@ADDREXPG256K */

   5922  2 000200   000050 235007                    LDA     40,DL
         2 000201   000000 474400 xsym               LDP4    S_D$
         2 000202   400013 755100                    STA     11,,PR4

      166     5923    4                       ALTRETURN;

   5923  2 000203   000000 702200 xent               TSX2  ! X66_AALT

      167     5924    4                     END;
      168     5925    3                  ITEM = BIGBASED_ITEM;

   5925  2 000204   000100 100400                    MLR     fill='000'O
         2 000205   000015 000010 0                  ADSC9   BIGBASED_ITEM            cn=0,n=8
         2 000206   200011 000010                    ADSC9   ITEM,,AUTO               cn=0,n=8

      169     5926    3                  ITEM.VALUE = ADDRESS;

   5926  2 000207   300000 235100                    LDA     0,,PR3
         2 000210   200012 755100                    STA     ITEM+1,,AUTO

      170     5927    3                END;

      171     5928    2             POINTER = POINTER & '777777770000'O | '000000002000'O;

   5928  2 000211   200010 236100                    LDQ     POINTER,,AUTO
         2 000212   000024 376000 0                  ANQ     BIGSTATIC_ITEM+3
         2 000213   000025 276000 0                  ORQ     BIGSTATIC_ITEM+4
         2 000214   200010 756100                    STQ     POINTER,,AUTO
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:25   

      172     5929    2           END;                            /* DO ( NOT_IS ) */

   5929  2 000215   000252 710000 2                  TRA     s:5947

      173     5930    2        ELSE DO;                           /* Instruction segment */

      174     5931    2             IF ADDRESS < BITBIN('1000000'O)

   5931  2 000216   000023 236000 0                  LDQ     BIGSTATIC_ITEM+2
         2 000217   000017 772000                    QRL     15
         2 000220   200004 471500                    LDP1    @ADDRESS,,AUTO
         2 000221   100000 116100                    CMPQ    0,,PR1
         2 000222   000233 602000 2                  TNC     s:5937
         2 000223   000233 600000 2                  TZE     s:5937

      175     5932    3             THEN DO;

      176     5933    3                  ITEM = STATIC_ITEM;

   5933  2 000224   000100 100400                    MLR     fill='000'O
         2 000225   000017 000010 0                  ADSC9   STATIC_ITEM              cn=0,n=8
         2 000226   200011 000010                    ADSC9   ITEM,,AUTO               cn=0,n=8

      177     5934    3                  ITEM.ADR.W = ADDRESS;

   5934  2 000227   100000 236100                    LDQ     0,,PR1
         2 000230   000014 736000                    QLS     12
         2 000231   200012 752174                    STCQ    ITEM+1,'74'O,AUTO

      178     5935    3                END;

   5935  2 000232   000252 710000 2                  TRA     s:5947

      179     5936    3             ELSE DO;

      180     5937    3                  IF U$SE.TYPE ~= 1 /* USE_REAL */
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:26   

   5937  2 000233   000000 473400 xsym               LDP3    USE$
         2 000234   300001 235100                    LDA     1,,PR3
         2 000235   000001 115007                    CMPA    1,DL
         2 000236   000245 600000 2                  TZE     s:5943
         2 000237   000002 115007                    CMPA    2,DL
         2 000240   000245 600000 2                  TZE     s:5943

      181     5938    3                    AND U$SE.TYPE ~= 2 /* USE_PT */
      182     5939    4                  THEN DO;

      183     5940    4                       S_D.ERROR = 83; /* E@BADADDR */

   5940  2 000241   000123 235007                    LDA     83,DL
         2 000242   000000 474400 xsym               LDP4    S_D$
         2 000243   400013 755100                    STA     11,,PR4

      184     5941    4                       ALTRETURN;

   5941  2 000244   000000 702200 xent               TSX2  ! X66_AALT

      185     5942    4                     END;
      186     5943    3                  ITEM = BIGSTATIC_ITEM;

   5943  2 000245   000100 100400                    MLR     fill='000'O
         2 000246   000021 000010 0                  ADSC9   BIGSTATIC_ITEM           cn=0,n=8
         2 000247   200011 000010                    ADSC9   ITEM,,AUTO               cn=0,n=8

      187     5944    3                  ITEM.VALUE = ADDRESS;

   5944  2 000250   100000 235100                    LDA     0,,PR1
         2 000251   200012 755100                    STA     ITEM+1,,AUTO

      188     5945    3                END;

      189     5946    2           END;                            /* DO ( instruction segment ) */

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:27   
      190     5947    1        DSIZE = 36;

   5947  2 000252   000044 235007                    LDA     36,DL
         2 000253   200014 755100                    STA     DSIZE,,AUTO

      191     5948    1        RSIZE = 36;

   5948  2 000254   200015 755100                    STA     RSIZE,,AUTO

      192     5949    1        EXPR_OP = 0;

   5949  2 000255   200016 450100                    STZ     EXPR_OP,,AUTO

      193     5950    1        ADDR_TYPE = ITEM.ADDR_TYPE;

   5950  2 000256   200011 236100                    LDQ     ITEM,,AUTO
         2 000257   000011 772000                    QRL     9
         2 000260   000777 376007                    ANQ     511,DL
         2 000261   200017 756100                    STQ     ADDR_TYPE,,AUTO

      194     5951    1        ARRAY_FLAG = '0'B;

   5951  2 000262   200020 450100                    STZ     ARRAY_FLAG,,AUTO

      195     5952    1        TRUNC_FLAG = '1'B;

   5952  2 000263   400000 236003                    LDQ     -131072,DU
         2 000264   200021 756100                    STQ     TRUNC_FLAG,,AUTO

      196     5953                                                /**/
      197     5954    1        IF PUT_FLAG

   5954  2 000265   200013 234100                    SZN     PUT_FLAG,,AUTO
         2 000266   000326 605000 2                  TPL     s:5958

      198     5955    1        THEN CALL DDK$PUTVAL(ADDR(VALUE), ITEM, 0, DSIZE, RSIZE, 0,

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:28   
   5955  2 000267   200003 236100                    LDQ     @VALUE,,AUTO
         2 000270   200032 756100                    STQ     SITEM_VAL+6,,AUTO
         2 000271   000002 236000 3                  LDQ     2
         2 000272   200047 756100                    STQ     SITEM_VAL+19,,AUTO
         2 000273   200021 631500                    EPPR1   TRUNC_FLAG,,AUTO
         2 000274   200046 451500                    STP1    SITEM_VAL+18,,AUTO
         2 000275   200020 633500                    EPPR3   ARRAY_FLAG,,AUTO
         2 000276   200045 453500                    STP3    SITEM_VAL+17,,AUTO
         2 000277   200017 634500                    EPPR4   ADDR_TYPE,,AUTO
         2 000300   200044 454500                    STP4    SITEM_VAL+16,,AUTO
         2 000301   200016 635500                    EPPR5   EXPR_OP,,AUTO
         2 000302   200043 455500                    STP5    SITEM_VAL+15,,AUTO
         2 000303   000003 236000 3                  LDQ     3
         2 000304   200042 756100                    STQ     SITEM_VAL+14,,AUTO
         2 000305   200010 636500                    EPPR6   POINTER,,AUTO
         2 000306   200041 456500                    STP6    SITEM_VAL+13,,AUTO
         2 000307   200040 756100                    STQ     SITEM_VAL+12,,AUTO
         2 000310   200015 637500                    EPPR7   RSIZE,,AUTO
         2 000311   200037 457500                    STP7    SITEM_VAL+11,,AUTO
         2 000312   200014 630500                    EPPR0   DSIZE,,AUTO
         2 000313   200036 450500                    STP0    SITEM_VAL+10,,AUTO
         2 000314   200035 756100                    STQ     SITEM_VAL+9,,AUTO
         2 000315   200011 630500                    EPPR0   ITEM,,AUTO
         2 000316   200034 450500                    STP0    SITEM_VAL+8,,AUTO
         2 000317   200032 630500                    EPPR0   SITEM_VAL+6,,AUTO
         2 000320   200033 450500                    STP0    SITEM_VAL+7,,AUTO
         2 000321   200033 630500                    EPPR0   SITEM_VAL+7,,AUTO
         2 000322   000001 631400 3                  EPPR1   1
         2 000323   000000 701000 xent               TSX1    DDK$PUTVAL
         2 000324   000363 702000 2                  TSX2    ARET
         2 000325   000362 710000 2                  TRA     s:5962

      199     5956    1               POINTER, 0, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      200     5957    1               TRUNC_FLAG, BITBIN('400000000003'O)) ALTRET(ARET);
      201     5958    1        ELSE CALL DDK$GETVAL(ADDR(VALUE), ITEM, 0, DSIZE, RSIZE, 0,

   5958  2 000326   200003 236100                    LDQ     @VALUE,,AUTO
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:29   
         2 000327   200032 756100                    STQ     SITEM_VAL+6,,AUTO
         2 000330   200021 631500                    EPPR1   TRUNC_FLAG,,AUTO
         2 000331   200047 451500                    STP1    SITEM_VAL+19,,AUTO
         2 000332   200020 633500                    EPPR3   ARRAY_FLAG,,AUTO
         2 000333   200046 453500                    STP3    SITEM_VAL+18,,AUTO
         2 000334   200017 634500                    EPPR4   ADDR_TYPE,,AUTO
         2 000335   200045 454500                    STP4    SITEM_VAL+17,,AUTO
         2 000336   200016 635500                    EPPR5   EXPR_OP,,AUTO
         2 000337   200044 455500                    STP5    SITEM_VAL+16,,AUTO
         2 000340   000003 236000 3                  LDQ     3
         2 000341   200043 756100                    STQ     SITEM_VAL+15,,AUTO
         2 000342   200010 636500                    EPPR6   POINTER,,AUTO
         2 000343   200042 456500                    STP6    SITEM_VAL+14,,AUTO
         2 000344   200041 756100                    STQ     SITEM_VAL+13,,AUTO
         2 000345   200015 637500                    EPPR7   RSIZE,,AUTO
         2 000346   200040 457500                    STP7    SITEM_VAL+12,,AUTO
         2 000347   200014 630500                    EPPR0   DSIZE,,AUTO
         2 000350   200037 450500                    STP0    SITEM_VAL+11,,AUTO
         2 000351   200036 756100                    STQ     SITEM_VAL+10,,AUTO
         2 000352   200011 630500                    EPPR0   ITEM,,AUTO
         2 000353   200035 450500                    STP0    SITEM_VAL+9,,AUTO
         2 000354   200032 630500                    EPPR0   SITEM_VAL+6,,AUTO
         2 000355   200034 450500                    STP0    SITEM_VAL+8,,AUTO
         2 000356   200034 630500                    EPPR0   SITEM_VAL+8,,AUTO
         2 000357   000004 631400 3                  EPPR1   4
         2 000360   000000 701000 xent               TSX1    DDK$GETVAL
         2 000361   000363 702000 2                  TSX2    ARET

      202     5959    1               POINTER, 0, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      203     5960    1               TRUNC_FLAG) ALTRET(ARET);
      204     5961                                                /**/
      205     5962    1        RETURN;

   5962  2 000362   000000 702200 xent               TSX2  ! X66_ARET

      206     5963    1   ARET:
      207     5964    1        ALTRETURN;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:30   

   5964  2 000363   000000 702200 xent  ARET         TSX2  ! X66_AALT

      208     5965    1   GOTSPEC:                 /* Come here if address is encoded special symbol */
      209     5966    1        IF PUT_FLAG

   5966  2 000364   200013 234100       GOTSPEC      SZN     PUT_FLAG,,AUTO
         2 000365   000602 605000 2                  TPL     s:6029

      210     5967    2        THEN DO;

      211     5968    2             SZ = 0;

   5968  2 000366   200023 450100                    STZ     SZ,,AUTO

      212     5969    3             DO CASE( DESC# );

   5969  2 000367   200006 473500                    LDP3    @DESC#,,AUTO
         2 000370   300000 235100                    LDA     0,,PR3
         2 000371   000010 115007                    CMPA    8,DL
         2 000372   000374 602005 2                  TNC     s:5969+5,AL
         2 000373   000560 710000 2                  TRA     s:6021
         2 000374   000404 710000 2                  TRA     s:5971
         2 000375   000452 710000 2                  TRA     s:5987
         2 000376   000460 710000 2                  TRA     s:5990
         2 000377   000476 710000 2                  TRA     s:5995
         2 000400   000523 710000 2                  TRA     s:6006
         2 000401   000534 710000 2                  TRA     s:6011
         2 000402   000542 710000 2                  TRA     s:6014
         2 000403   000550 710000 2                  TRA     s:6017

      213     5970    3               CASE( 0 );                  /* $E, $A, $Q, $Xn, $IND, $IC */

      214     5971    4                  DO CASE( ADDRESS );

   5971  2 000404   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000405   400000 235100                    LDA     0,,PR4
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:31   
         2 000406   000015 115007                    CMPA    13,DL
         2 000407   000411 602005 2                  TNC     s:5971+5,AL
         2 000410   000560 710000 2                  TRA     s:6021
         2 000411   000426 710000 2                  TRA     s:5973
         2 000412   000431 710000 2                  TRA     s:5975
         2 000413   000434 710000 2                  TRA     s:5977
         2 000414   000437 710000 2                  TRA     s:5979
         2 000415   000437 710000 2                  TRA     s:5979
         2 000416   000437 710000 2                  TRA     s:5979
         2 000417   000437 710000 2                  TRA     s:5979
         2 000420   000437 710000 2                  TRA     s:5979
         2 000421   000437 710000 2                  TRA     s:5979
         2 000422   000437 710000 2                  TRA     s:5979
         2 000423   000437 710000 2                  TRA     s:5979
         2 000424   000444 710000 2                  TRA     s:5982
         2 000425   000447 710000 2                  TRA     s:5984

      215     5972    4                    CASE( 0 );

      216     5973    4                       ID = %E_RTN;

   5973  2 000426   000017 236007                    LDQ     15,DL
         2 000427   200022 756100                    STQ     ID,,AUTO
         2 000430   000560 710000 2                  TRA     s:6021

      217     5974    4                    CASE( 1 );

      218     5975    4                       ID = %A_RTN;

   5975  2 000431   000020 236007                    LDQ     16,DL
         2 000432   200022 756100                    STQ     ID,,AUTO
         2 000433   000560 710000 2                  TRA     s:6021

      219     5976    4                    CASE( 2 );

      220     5977    4                       ID = %Q_RTN;

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:32   
   5977  2 000434   000021 236007                    LDQ     17,DL
         2 000435   200022 756100                    STQ     ID,,AUTO
         2 000436   000560 710000 2                  TRA     s:6021

      221     5978    4                    CASE( 3, 4, 5, 6, 7, 8, 9, 10 );

      222     5979    4                       ID = %X_RTN;

   5979  2 000437   000031 236007                    LDQ     25,DL
         2 000440   200022 756100                    STQ     ID,,AUTO

      223     5980    4                       SZ = ADDRESS - 3;

   5980  2 000441   000003 135007                    SBLA    3,DL
         2 000442   200023 755100                    STA     SZ,,AUTO
         2 000443   000560 710000 2                  TRA     s:6021

      224     5981    4                    CASE( 11 );

      225     5982    4                       ID = %IND_RTN;

   5982  2 000444   000005 236007                    LDQ     5,DL
         2 000445   200022 756100                    STQ     ID,,AUTO
         2 000446   000560 710000 2                  TRA     s:6021

      226     5983    4                    CASE( 12 );

      227     5984    4                       ID = %IC_RTN;

   5984  2 000447   000016 236007                    LDQ     14,DL
         2 000450   200022 756100                    STQ     ID,,AUTO

      228     5985    4                    END;                   /* DO CASE( ADDRESS ) */

   5985  2 000451   000560 710000 2                  TRA     s:6021

      229     5986    3               CASE( 1 );                  /* $ARn */
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:33   

      230     5987    3                  ID = %AR_RTN;

   5987  2 000452   000035 236007                    LDQ     29,DL
         2 000453   200022 756100                    STQ     ID,,AUTO

      231     5988    3                  SZ = ADDRESS;

   5988  2 000454   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000455   400000 235100                    LDA     0,,PR4
         2 000456   200023 755100                    STA     SZ,,AUTO
         2 000457   000560 710000 2                  TRA     s:6021

      232     5989    3               CASE( 2 );                  /* $PRn */

      233     5990    3                  SITEM_VAL = DESC(%PR_DESC);

   5990  2 000460   000100 100400                    MLR     fill='000'O
         2 000461   000064 000010 xsym               ADSC9   DESC+52                  cn=0,n=8
         2 000462   200024 000010                    ADSC9   SITEM_VAL,,AUTO          cn=0,n=8

      234     5991    3                  SDITEM_VAL.DISP = ADDRESS * 2 + 24;

   5991  2 000463   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000464   400000 236100                    LDQ     0,,PR4
         2 000465   000001 736000                    QLS     1
         2 000466   000030 036007                    ADLQ    24,DL
         2 000467   000014 736000                    QLS     12
         2 000470   200025 676100                    ERQ     SITEM_VAL+1,,AUTO
         2 000471   000000 376000 3                  ANQ     0
         2 000472   200025 656100                    ERSQ    SITEM_VAL+1,,AUTO

      235     5992    3                  SITEM_VAL.ADDR_TYPE = %DESC_ACODE;

   5992  2 000473   100000 236007                    LDQ     32768,DL
         2 000474   200024 552110                    STBQ    SITEM_VAL,'10'O,AUTO

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:34   
      236     5993    3                  GOTO PUTSPEC;

   5993  2 000475   000571 710000 2                  TRA     PUTSPEC

      237     5994    3               CASE( 3 );                  /* $AU, $AL, $QU, $QL */

      238     5995    4                  DO CASE( ADDRESS );

   5995  2 000476   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000477   400000 235100                    LDA     0,,PR4
         2 000500   000004 115007                    CMPA    4,DL
         2 000501   000503 602005 2                  TNC     s:5995+5,AL
         2 000502   000560 710000 2                  TRA     s:6021
         2 000503   000507 710000 2                  TRA     s:5997
         2 000504   000512 710000 2                  TRA     s:5999
         2 000505   000515 710000 2                  TRA     s:6001
         2 000506   000520 710000 2                  TRA     s:6003

      239     5996    4                    CASE( 0 );

      240     5997    4                       ID = %AU_RTN;

   5997  2 000507   000022 236007                    LDQ     18,DL
         2 000510   200022 756100                    STQ     ID,,AUTO
         2 000511   000560 710000 2                  TRA     s:6021

      241     5998    4                    CASE( 1 );

      242     5999    4                       ID = %AL_RTN;

   5999  2 000512   000023 236007                    LDQ     19,DL
         2 000513   200022 756100                    STQ     ID,,AUTO
         2 000514   000560 710000 2                  TRA     s:6021

      243     6000    4                    CASE( 2 );

      244     6001    4                       ID = %QU_RTN;
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:35   

   6001  2 000515   000024 236007                    LDQ     20,DL
         2 000516   200022 756100                    STQ     ID,,AUTO
         2 000517   000560 710000 2                  TRA     s:6021

      245     6002    4                    CASE( 3 );

      246     6003    4                       ID = %QL_RTN;

   6003  2 000520   000025 236007                    LDQ     21,DL
         2 000521   200022 756100                    STQ     ID,,AUTO

      247     6004    4                    END;                   /* DO CASE( ADDRESS ) */

   6004  2 000522   000560 710000 2                  TRA     s:6021

      248     6005    3               CASE( 4 );                  /* $IOBUFSZ */

      249     6006    4                  DO CASE( ADDRESS );

   6006  2 000523   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000524   400000 235100                    LDA     0,,PR4
         2 000525   000001 115007                    CMPA    1,DL
         2 000526   000530 602005 2                  TNC     s:6006+5,AL
         2 000527   000560 710000 2                  TRA     s:6021
         2 000530   000531 710000 2                  TRA     s:6008

      250     6007    4                    CASE( 0 );

      251     6008    4                       ID = %IOBUFSZ_RTN;

   6008  2 000531   000004 236007                    LDQ     4,DL
         2 000532   200022 756100                    STQ     ID,,AUTO

      252     6009    4                    END;                   /* DO CASE( ADDRESS ) */

   6009  2 000533   000560 710000 2                  TRA     s:6021
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:36   

      253     6010    3               CASE( 5 );                  /* $WSRn */

      254     6011    3                  ID = %WSR_RTN;

   6011  2 000534   000032 236007                    LDQ     26,DL
         2 000535   200022 756100                    STQ     ID,,AUTO

      255     6012    3                  SZ = ADDRESS;

   6012  2 000536   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000537   400000 235100                    LDA     0,,PR4
         2 000540   200023 755100                    STA     SZ,,AUTO
         2 000541   000560 710000 2                  TRA     s:6021

      256     6013    3               CASE( 6 );                  /* $WSQn */

      257     6014    3                  ID = %WSQ_RTN;

   6014  2 000542   000033 236007                    LDQ     27,DL
         2 000543   200022 756100                    STQ     ID,,AUTO

      258     6015    3                  SZ = ADDRESS;

   6015  2 000544   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000545   400000 235100                    LDA     0,,PR4
         2 000546   200023 755100                    STA     SZ,,AUTO
         2 000547   000560 710000 2                  TRA     s:6021

      259     6016    3               CASE( 7 );                  /* $FMASK, $FRANGE */

      260     6017    3                  IF ADDRESS = 0

   6017  2 000550   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000551   400000 235100                    LDA     0,,PR4
         2 000552   000556 601000 2                  TNZ     s:6019

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:37   
      261     6018    3                  THEN ID = %FMASK_RTN;

   6018  2 000553   000030 236007                    LDQ     24,DL
         2 000554   200022 756100                    STQ     ID,,AUTO
         2 000555   000560 710000 2                  TRA     s:6021

      262     6019    3                  ELSE ID = %FRANGE_RTN;

   6019  2 000556   000027 236007                    LDQ     23,DL
         2 000557   200022 756100                    STQ     ID,,AUTO

      263     6020    3               END;                        /* DO CASE( DESC# ) */

      264     6021    2             SITEM_VAL = '0'B;

   6021  2 000560   000000 235003                    LDA     0,DU
         2 000561   000000 236003                    LDQ     0,DU
         2 000562   200024 757100                    STAQ    SITEM_VAL,,AUTO

      265     6022    2             SITEM_VAL.ID = ID;

   6022  2 000563   200022 236100                    LDQ     ID,,AUTO
         2 000564   000033 736000                    QLS     27
         2 000565   200025 552140                    STBQ    SITEM_VAL+1,'40'O,AUTO

      266     6023    2             SITEM_VAL.SZ = SZ;

   6023  2 000566   200023 236100                    LDQ     SZ,,AUTO
         2 000567   000022 736000                    QLS     18
         2 000570   200025 552120                    STBQ    SITEM_VAL+1,'20'O,AUTO

   6023  2 000571                       PUTSPEC      null
      267     6024    2   PUTSPEC:  ;
      268     6025    2             CALL DDK$PUTSPEC(SITEM_VAL, VALUE);

   6025  2 000571   200003 236100                    LDQ     @VALUE,,AUTO
         2 000572   200033 756100                    STQ     SITEM_VAL+7,,AUTO
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:38   
         2 000573   200024 634500                    EPPR4   SITEM_VAL,,AUTO
         2 000574   200032 454500                    STP4    SITEM_VAL+6,,AUTO
         2 000575   200032 630500                    EPPR0   SITEM_VAL+6,,AUTO
         2 000576   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000577   000000 701000 xent               TSX1    DDK$PUTSPEC
         2 000600   000000 011000                    NOP     0

      269     6026    2             RETURN;

   6026  2 000601   000000 702200 xent               TSX2  ! X66_ARET

      270     6027    2           END;
      271     6028        /* Must be GETMVAL, need to fetch value */
      272     6029    2        DO CASE( DESC# );

   6029  2 000602   200006 473500                    LDP3    @DESC#,,AUTO
         2 000603   300000 235100                    LDA     0,,PR3
         2 000604   000010 115007                    CMPA    8,DL
         2 000605   000607 602005 2                  TNC     s:6029+5,AL
         2 000606   001102 710000 2                  TRA     s:6094
         2 000607   000617 710000 2                  TRA     s:6031
         2 000610   000725 710000 2                  TRA     s:6051
         2 000611   000744 710000 2                  TRA     s:6058
         2 000612   000763 710000 2                  TRA     s:6065
         2 000613   001034 710000 2                  TRA     s:6079
         2 000614   001041 710000 2                  TRA     s:6081
         2 000615   001050 710000 2                  TRA     s:6083
         2 000616   001057 710000 2                  TRA     s:6085

      273     6030    2          CASE( 0 );                       /* $E, $A, $Q, $Xn, $IND, $IC */

      274     6031    3             DO CASE( ADDRESS );

   6031  2 000617   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000620   400000 235100                    LDA     0,,PR4
         2 000621   000015 115007                    CMPA    13,DL
         2 000622   000624 602005 2                  TNC     s:6031+5,AL
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:39   
         2 000623   000721 710000 2                  TRA     s:6047
         2 000624   000641 710000 2                  TRA     s:6033
         2 000625   000650 710000 2                  TRA     s:6035
         2 000626   000656 710000 2                  TRA     s:6037
         2 000627   000664 710000 2                  TRA     s:6039
         2 000630   000664 710000 2                  TRA     s:6039
         2 000631   000664 710000 2                  TRA     s:6039
         2 000632   000664 710000 2                  TRA     s:6039
         2 000633   000664 710000 2                  TRA     s:6039
         2 000634   000664 710000 2                  TRA     s:6039
         2 000635   000664 710000 2                  TRA     s:6039
         2 000636   000664 710000 2                  TRA     s:6039
         2 000637   000674 710000 2                  TRA     s:6041
         2 000640   000714 710000 2                  TRA     s:6045

      275     6032    3               CASE( 0 );

      276     6033    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.E;

   6033  2 000641   000000 475400 xsym               LDP5    S_D$
         2 000642   500045 476500                    LDP6    37,,PR5
         2 000643   200003 477500                    LDP7    @VALUE,,AUTO
         2 000644   600006 236100                    LDQ     6,,PR6
         2 000645   000034 772000                    QRL     28
         2 000646   700000 756100                    STQ     0,,PR7
         2 000647   001102 710000 2                  TRA     s:6094

      277     6034    3               CASE( 1 );

      278     6035    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.A;

   6035  2 000650   000000 475400 xsym               LDP5    S_D$
         2 000651   500045 476500                    LDP6    37,,PR5
         2 000652   600004 235100                    LDA     4,,PR6
         2 000653   200003 477500                    LDP7    @VALUE,,AUTO
         2 000654   700000 755100                    STA     0,,PR7
         2 000655   001102 710000 2                  TRA     s:6094
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:40   

      279     6036    3               CASE( 2 );

      280     6037    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.Q;

   6037  2 000656   000000 475400 xsym               LDP5    S_D$
         2 000657   500045 476500                    LDP6    37,,PR5
         2 000660   600005 235100                    LDA     5,,PR6
         2 000661   200003 477500                    LDP7    @VALUE,,AUTO
         2 000662   700000 755100                    STA     0,,PR7
         2 000663   001102 710000 2                  TRA     s:6094

      281     6038    3               CASE( 3, 4, 5, 6, 7, 8, 9, 10 );

      282     6039    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.X( ADDRESS - 3 );

   6039  2 000664   000000 475400 xsym               LDP5    S_D$
         2 000665   500045 476500                    LDP6    37,,PR5
         2 000666   000001 735000                    ALS     1
         2 000667   200003 477500                    LDP7    @VALUE,,AUTO
         2 000670   000100 101505                    MRL     fill='000'O
         2 000671   677776 400002                    ADSC9   -2,A,PR6                 cn=2,n=2
         2 000672   700000 000004                    ADSC9   0,,PR7                   cn=0,n=4
         2 000673   001102 710000 2                  TRA     s:6094

      283     6040    3               CASE( 11 );

      284     6041    3                  IF D_XDELTA

   6041  2 000674   000000 234000 xsym               SZN     D_XDELTA
         2 000675   000705 605000 2                  TPL     s:6043

      285     6042    3                  THEN VALUE = BITBIN(S_D.USS$ -> B$SS.IR);

   6042  2 000676   000000 475400 xsym               LDP5    S_D$
         2 000677   500005 476500                    LDP6    5,,PR5
         2 000700   600004 236100                    LDQ     4,,PR6
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:41   
         2 000701   777777 376007                    ANQ     -1,DL
         2 000702   200003 477500                    LDP7    @VALUE,,AUTO
         2 000703   700000 756100                    STQ     0,,PR7
         2 000704   001102 710000 2                  TRA     s:6094

      286     6043    3                  ELSE VALUE = BITBIN(S_D.DRTN$ -> FPT$DRTN.V.IR#);

   6043  2 000705   000000 475400 xsym               LDP5    S_D$
         2 000706   504704 476500                    LDP6    2500,,PR5
         2 000707   600012 236100                    LDQ     10,,PR6
         2 000710   777777 376007                    ANQ     -1,DL
         2 000711   200003 477500                    LDP7    @VALUE,,AUTO
         2 000712   700000 756100                    STQ     0,,PR7
         2 000713   001102 710000 2                  TRA     s:6094

      287     6044    3               CASE( 12 );

      288     6045    3                  VALUE = S_D.SAVEIC;

   6045  2 000714   000000 475400 xsym               LDP5    S_D$
         2 000715   200003 476500                    LDP6    @VALUE,,AUTO
         2 000716   500002 235100                    LDA     2,,PR5
         2 000717   600000 755100                    STA     0,,PR6
         2 000720   001102 710000 2                  TRA     s:6094

      289     6046    3               CASE( ELSE );

      290     6047    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */

   6047  2 000721   000104 236007                    LDQ     68,DL
         2 000722   000000 475400 xsym               LDP5    S_D$
         2 000723   500013 756100                    STQ     11,,PR5

      291     6048    3                  ALTRETURN;

   6048  2 000724   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:42   
      292     6049    3               END;                        /* DO CASE( ADDRESS ) */

      293     6050    2          CASE( 1 );                       /* $ARn */

      294     6051    2             IF ADDRESS > 7

   6051  2 000725   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000726   400000 235100                    LDA     0,,PR4
         2 000727   000010 115007                    CMPA    8,DL
         2 000730   000735 602000 2                  TNC     s:6056

      295     6052    3             THEN DO;

      296     6053    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */

   6053  2 000731   000104 236007                    LDQ     68,DL
         2 000732   000000 475400 xsym               LDP5    S_D$
         2 000733   500013 756100                    STQ     11,,PR5

      297     6054    3                  ALTRETURN;

   6054  2 000734   000000 702200 xent               TSX2  ! X66_AALT

      298     6055    3                END;
      299     6056    2             VALUE = PINCRW(S_D.USS$, 16 + ADDRESS) -> UBIN36;

   6056  2 000735   400000 720100                    LXL0    0,,PR4
         2 000736   000000 475400 xsym               LDP5    S_D$
         2 000737   500005 476500                    LDP6    5,,PR5
         2 000740   200003 477500                    LDP7    @VALUE,,AUTO
         2 000741   600020 235110                    LDA     16,X0,PR6
         2 000742   700000 755100                    STA     0,,PR7
         2 000743   001102 710000 2                  TRA     s:6094

      300     6057    2          CASE( 2 );                       /* $PRn */

      301     6058    2             IF ADDRESS > 7
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:43   

   6058  2 000744   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000745   400000 235100                    LDA     0,,PR4
         2 000746   000010 115007                    CMPA    8,DL
         2 000747   000754 602000 2                  TNC     s:6063

      302     6059    3             THEN DO;

      303     6060    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */

   6060  2 000750   000104 236007                    LDQ     68,DL
         2 000751   000000 475400 xsym               LDP5    S_D$
         2 000752   500013 756100                    STQ     11,,PR5

      304     6061    3                  ALTRETURN;

   6061  2 000753   000000 702200 xent               TSX2  ! X66_AALT

      305     6062    3                END;
      306     6063    2             VALUE = PINCRW(S_D.USS$, 16 + ADDRESS) -> UBIN36;

   6063  2 000754   400000 720100                    LXL0    0,,PR4
         2 000755   000000 475400 xsym               LDP5    S_D$
         2 000756   500005 476500                    LDP6    5,,PR5
         2 000757   200003 477500                    LDP7    @VALUE,,AUTO
         2 000760   600020 235110                    LDA     16,X0,PR6
         2 000761   700000 755100                    STA     0,,PR7
         2 000762   001102 710000 2                  TRA     s:6094

      307     6064    2          CASE( 3 );                       /* $AU, $AL, $QU, $QL */

      308     6065    3             DO CASE( ADDRESS );

   6065  2 000763   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 000764   400000 235100                    LDA     0,,PR4
         2 000765   000004 115007                    CMPA    4,DL
         2 000766   000770 602005 2                  TNC     s:6065+5,AL
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:44   
         2 000767   001030 710000 2                  TRA     s:6075
         2 000770   000774 710000 2                  TRA     s:6067
         2 000771   001003 710000 2                  TRA     s:6069
         2 000772   001012 710000 2                  TRA     s:6071
         2 000773   001021 710000 2                  TRA     s:6073

      309     6066    3               CASE( 0 );

      310     6067    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HA.AU;

   6067  2 000774   000000 475400 xsym               LDP5    S_D$
         2 000775   500045 476500                    LDP6    37,,PR5
         2 000776   600004 236100                    LDQ     4,,PR6
         2 000777   000022 772000                    QRL     18
         2 001000   200003 477500                    LDP7    @VALUE,,AUTO
         2 001001   700000 756100                    STQ     0,,PR7
         2 001002   001102 710000 2                  TRA     s:6094

      311     6068    3               CASE( 1 );

      312     6069    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HA.AL;

   6069  2 001003   000000 475400 xsym               LDP5    S_D$
         2 001004   500045 476500                    LDP6    37,,PR5
         2 001005   600004 236100                    LDQ     4,,PR6
         2 001006   777777 376007                    ANQ     -1,DL
         2 001007   200003 477500                    LDP7    @VALUE,,AUTO
         2 001010   700000 756100                    STQ     0,,PR7
         2 001011   001102 710000 2                  TRA     s:6094

      313     6070    3               CASE( 2 );

      314     6071    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HQ.QU;

   6071  2 001012   000000 475400 xsym               LDP5    S_D$
         2 001013   500045 476500                    LDP6    37,,PR5
         2 001014   600005 236100                    LDQ     5,,PR6
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:45   
         2 001015   000022 772000                    QRL     18
         2 001016   200003 477500                    LDP7    @VALUE,,AUTO
         2 001017   700000 756100                    STQ     0,,PR7
         2 001020   001102 710000 2                  TRA     s:6094

      315     6072    3               CASE( 3 );

      316     6073    3                  VALUE = S_D.UREG$ -> HOST_REG$VALUES.HQ.QL;

   6073  2 001021   000000 475400 xsym               LDP5    S_D$
         2 001022   500045 476500                    LDP6    37,,PR5
         2 001023   600005 236100                    LDQ     5,,PR6
         2 001024   777777 376007                    ANQ     -1,DL
         2 001025   200003 477500                    LDP7    @VALUE,,AUTO
         2 001026   700000 756100                    STQ     0,,PR7
         2 001027   001102 710000 2                  TRA     s:6094

      317     6074    3               CASE( ELSE );

      318     6075    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */

   6075  2 001030   000104 236007                    LDQ     68,DL
         2 001031   000000 475400 xsym               LDP5    S_D$
         2 001032   500013 756100                    STQ     11,,PR5

      319     6076    3                  ALTRETURN;

   6076  2 001033   000000 702200 xent               TSX2  ! X66_AALT

      320     6077    3               END;                        /* DO CASE( ADDRESS ) */

      321     6078    2          CASE( 4 );                       /* $IOBUFSZ */

      322     6079    2             VALUE = S_D.SV.IOBUFSZ;

   6079  2 001034   000000 474400 xsym               LDP4    S_D$
         2 001035   400040 235100                    LDA     32,,PR4
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:46   
         2 001036   200003 475500                    LDP5    @VALUE,,AUTO
         2 001037   500000 755100                    STA     0,,PR5
         2 001040   001102 710000 2                  TRA     s:6094

      323     6080    2          CASE( 5 );                       /* $WSRn */

      324     6081    2             VALUE = WSR( ADDRESS );

   6081  2 001041   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 001042   400000 235100                    LDA     0,,PR4
         2 001043   200003 475500                    LDP5    @VALUE,,AUTO
         2 001044   000100 101405                    MRL     fill='000'O
         2 001045   000000 000001 xsym               ADSC9   WSR,A                    cn=0,n=1
         2 001046   500000 000004                    ADSC9   0,,PR5                   cn=0,n=4
         2 001047   001102 710000 2                  TRA     s:6094

      325     6082    2          CASE( 6 );                       /* $WSQn */

      326     6083    2             VALUE = PINCRW(MIS$, ADDRESS) -> UBIN36;

   6083  2 001050   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 001051   400000 720100                    LXL0    0,,PR4
         2 001052   000000 475400 xsym               LDP5    MIS$
         2 001053   200003 476500                    LDP6    @VALUE,,AUTO
         2 001054   500000 235110                    LDA     0,X0,PR5
         2 001055   600000 755100                    STA     0,,PR6
         2 001056   001102 710000 2                  TRA     s:6094

      327     6084    2          CASE( 7 );                       /* $FMASK, $FRANGE  */

      328     6085    2             IF ADDRESS > 2

   6085  2 001057   200004 474500                    LDP4    @ADDRESS,,AUTO
         2 001060   400000 235100                    LDA     0,,PR4
         2 001061   000003 115007                    CMPA    3,DL
         2 001062   001067 602000 2                  TNC     s:6090

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:47   
      329     6086    3             THEN DO;

      330     6087    3                  S_D.ERROR = 68;  /* E@OUTOFSEG */

   6087  2 001063   000104 236007                    LDQ     68,DL
         2 001064   000000 475400 xsym               LDP5    S_D$
         2 001065   500013 756100                    STQ     11,,PR5

      331     6088    3                  ALTRETURN;

   6088  2 001066   000000 702200 xent               TSX2  ! X66_AALT

      332     6089    3                END;
      333     6090    2             IF ADDRESS = 0

   6090  2 001067   000000 115003                    CMPA    0,DU
         2 001070   001076 601000 2                  TNZ     s:6092

      334     6091    2             THEN VALUE = S_D.FIND.MASK_F;

   6091  2 001071   000000 475400 xsym               LDP5    S_D$
         2 001072   505211 235100                    LDA     2697,,PR5
         2 001073   200003 476500                    LDP6    @VALUE,,AUTO
         2 001074   600000 755100                    STA     0,,PR6
         2 001075   001102 710000 2                  TRA     s:6094

      335     6092    2             ELSE VALUE = S_D.FIND.NUM;

   6092  2 001076   000000 475400 xsym               LDP5    S_D$
         2 001077   200003 476500                    LDP6    @VALUE,,AUTO
         2 001100   505207 235100                    LDA     2695,,PR5
         2 001101   600000 755100                    STA     0,,PR6

      336     6093    2          END;                             /* DO CASE( DESC# ) */

      337     6094    1        RETURN;

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:48   
   6094  2 001102   000000 702200 xent               TSX2  ! X66_ARET

SPSEG
 Sect OctLoc
   0     000   000000 000010   000000 000011   000000 000012   000000 000006    ................
   0     004   000000 000004   000000 000005   000000 000000   000000 000001    ................
   0     010   000000 000002   000000 000013   000000 000014                    ............

BASED_ITEM
 Sect OctLoc
   0     013   000000 002000   000000 000000                                    ........

BIGBASED_ITEM
 Sect OctLoc
   0     015   000000 103000   000000 000000                                    ..C.....

STATIC_ITEM
 Sect OctLoc
   0     017   000000 000000   000000 000000                                    ........

BIGSTATIC_ITEM
 Sect OctLoc
   0     021   000000 104000   000000 000000                                    ..D.....

(unnamed)
 Sect OctLoc
   0     023   100000 000000   777777 770000   000000 002000   400000 000003    @...............

(unnamed)
 Sect OctLoc
   3     000   000007 770000   000015 000000   000026 006000   000002 006000    ................
   3     004   000014 000000                                                    ....
      338     6095    1   END DDK$GETMVAL;
      339     6096        %EOD;

PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:49   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_EIS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDK$GETMVAL.

   Procedure DDK$GETMVAL requires 579 words for executable code.
   Procedure DDK$GETMVAL requires 40 words of local(AUTO) storage.
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:50   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:51   
          MINI XREF LISTING

ADDRESS
        12**DCL         9--PROC     5873--ENTRY    5913>>IF       5916>>ASSIGN   5926>>ASSIGN   5931>>IF
      5934>>ASSIGN   5944>>ASSIGN   5971>>DOCASE   5980>>ASSIGN   5988>>ASSIGN   5991>>ASSIGN   5995>>DOCASE
      6006>>DOCASE   6012>>ASSIGN   6015>>ASSIGN   6017>>IF       6031>>DOCASE   6039>>ASSIGN   6051>>IF
      6056>>ASSIGN   6058>>IF       6063>>ASSIGN   6065>>DOCASE   6081>>ASSIGN   6083>>ASSIGN   6085>>IF
      6090>>IF
ADDR_TYPE
        99**DCL      5950<<ASSIGN   5955<>CALL     5958<>CALL
ARET
      5964**LABEL    5955--CALLALT  5958--CALLALT
ARRAY_FLAG
       100**DCL      5951<<ASSIGN   5955<>CALL     5958<>CALL
B$SS.IR
      5605**DCL      6042>>ASSIGN
B$SS.RVA
      5637**DCL      5638--REDEF
BASED_ITEM
       799**DCL      5915>>ASSIGN
BIGBASED_ITEM
       804**DCL      5925>>ASSIGN
BIGSTATIC_ITEM
       814**DCL      5943>>ASSIGN
DDK$GETVAL
       820**DCL-ENT  5958--CALL
DDK$PUTSPEC
       822**DCL-ENT  6025--CALL
DDK$PUTVAL
       821**DCL-ENT  5955--CALL
DESC
        70**DCL      5990>>ASSIGN
DESC.ITEM
        72**DCL      5884>>ASSIGN   5887>>ASSIGN   5890>>ASSIGN   5898>>ASSIGN   5900>>ASSIGN   5911>>ASSIGN
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:52   
DESC#
        14**DCL         9--PROC     5873--ENTRY    5885>>ASSIGN   5888>>ASSIGN   5891>>ASSIGN   5893>>IF
      5898>>ASSIGN   5901>>ASSIGN   5919>>IF       5919>>IF       5919>>IF       5969>>DOCASE   6029>>DOCASE
DSIZE
        96**DCL      5947<<ASSIGN   5955<>CALL     5958<>CALL
D_XDELTA
       828**DCL      6041>>IF
EXPR_OP
        98**DCL      5949<<ASSIGN   5955<>CALL     5958<>CALL
FPT$DRTN.V.IR#
      5858**DCL      5858--REDEF    6043>>ASSIGN
GETPUT
      5878**LABEL    5871--GOTO
GOTSPEC
      5966**LABEL    5882--GOTO
HOST_REG$VALUES.A
      2143**DCL      2144--REDEF    6035>>ASSIGN
HOST_REG$VALUES.E
      2151**DCL      6033>>ASSIGN
HOST_REG$VALUES.HA.AL
      2146**DCL      6069>>ASSIGN
HOST_REG$VALUES.HA.AU
      2145**DCL      6067>>ASSIGN
HOST_REG$VALUES.HQ.QL
      2150**DCL      6073>>ASSIGN
HOST_REG$VALUES.HQ.QU
      2149**DCL      6071>>ASSIGN
HOST_REG$VALUES.Q
      2147**DCL      2148--REDEF    6037>>ASSIGN
HOST_REG$VALUES.X
      2142**DCL      6039>>ASSIGN
ID
       102**DCL      5973<<ASSIGN   5975<<ASSIGN   5977<<ASSIGN   5979<<ASSIGN   5982<<ASSIGN   5984<<ASSIGN
      5987<<ASSIGN   5997<<ASSIGN   5999<<ASSIGN   6001<<ASSIGN   6003<<ASSIGN   6008<<ASSIGN   6011<<ASSIGN
      6014<<ASSIGN   6018<<ASSIGN   6019<<ASSIGN   6022>>ASSIGN
ITEM
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:53   
        85**DCL      5915<<ASSIGN   5925<<ASSIGN   5933<<ASSIGN   5943<<ASSIGN   5955<>CALL     5958<>CALL
ITEM.ADDR_TYPE
        88**DCL      5950>>ASSIGN
ITEM.ADR
        90**DCL        94--REDEF
ITEM.ADR.W
        91**DCL      5916<<ASSIGN   5934<<ASSIGN
ITEM.VALUE
        94**DCL      5926<<ASSIGN   5944<<ASSIGN
MIS$
       827**DCL      6083>>ASSIGN
NOT_IS
        15**DCL         9--PROC     5873--ENTRY    5878>>IF
POINTER
        17**DCL        22--REDEF    5884<<ASSIGN   5887<<ASSIGN   5890<<ASSIGN   5898<<ASSIGN   5900<<ASSIGN
      5911<<ASSIGN   5928<<ASSIGN   5928>>ASSIGN   5955<>CALL     5958<>CALL
POINTER.DISP
        20**DCL      5885<<ASSIGN   5888<<ASSIGN   5891<<ASSIGN   5901<<ASSIGN
PUTSPEC
      6023**LABEL    5993--GOTO
PUT_FLAG
        95**DCL      5870<<ASSIGN   5875<<ASSIGN   5954>>IF       5966>>IF
RSIZE
        97**DCL      5948<<ASSIGN   5955<>CALL     5958<>CALL
SDITEM_VAL.DISP
       115**DCL      5991<<ASSIGN
SEG
        13**DCL         9--PROC     5873--ENTRY    5880>>DOCASE   5919>>IF       5919>>IF
SITEM_VAL
       104**DCL       111--REDEF    5990<<ASSIGN   6021<<ASSIGN   6025<>CALL
SITEM_VAL.ADDR_TYPE
       106**DCL      5992<<ASSIGN
SITEM_VAL.ID
       108**DCL      6022<<ASSIGN
SITEM_VAL.SZ
       109**DCL      6023<<ASSIGN
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:54   
SPSEG
        73**DCL      5898>>ASSIGN
STATIC_ITEM
       809**DCL      5933>>ASSIGN
SZ
       103**DCL      5968<<ASSIGN   5980<<ASSIGN   5988<<ASSIGN   6012<<ASSIGN   6015<<ASSIGN   6023>>ASSIGN
S_D.CURRENT_CHANNEL
      5219**DCL      5221--REDEF
S_D.DEBUGA
      4371**DCL      4373--REDEF
S_D.DRTN$
      4824**DCL      6043>>ASSIGN
S_D.EIS
      5329**DCL      5358--REDEF
S_D.ERROR
      4300**DCL      5895<<ASSIGN   5903<<ASSIGN   5907<<ASSIGN   5908<<ASSIGN   5922<<ASSIGN   5940<<ASSIGN
      6047<<ASSIGN   6053<<ASSIGN   6060<<ASSIGN   6075<<ASSIGN   6087<<ASSIGN
S_D.FIND.MASK_F
      5082**DCL      6091>>ASSIGN
S_D.FIND.NUM
      5080**DCL      6092>>ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      5262**DCL      5263--REDEF    5277--REDEF
S_D.JDE
      4876**DCL      4877--REDEF
S_D.L$.VALUE
      4429**DCL      4435--REDEF    4443--REDEF    4446--REDEF    4449--REDEF    4452--REDEF
S_D.L$.VALUE.L
      4430**DCL      4431--REDEF    4432--REDEF
S_D.L6_MESSAGE_BUF
      5283**DCL      5285--REDEF
S_D.OUTPUT
      5249**DCL      5251--REDEF
S_D.REMOTE_MSG.FNCC
      5268**DCL      5269--REDEF
S_D.REMOTE_MSG.STXC
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:55   
      5264**DCL      5265--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5272**DCL      5273--REDEF
S_D.RUM
      4917**DCL      5906>>IF
S_D.SAVEIC
      4282**DCL      6045>>ASSIGN
S_D.SV
      4328**DCL      4349--REDEF
S_D.SV.IOBUFSZ
      4347**DCL      6079>>ASSIGN
S_D.UREG$
      4359**DCL      6033>>ASSIGN   6035>>ASSIGN   6037>>ASSIGN   6039>>ASSIGN   6067>>ASSIGN   6069>>ASSIGN
      6071>>ASSIGN   6073>>ASSIGN
S_D.USS$
      4288**DCL      6042>>ASSIGN   6056>>ASSIGN   6063>>ASSIGN
S_D$
      5580**DCL      4276--IMP-PTR  5895>>ASSIGN   5903>>ASSIGN   5906>>IF       5907>>ASSIGN   5908>>ASSIGN
      5922>>ASSIGN   5940>>ASSIGN   6033>>ASSIGN   6035>>ASSIGN   6037>>ASSIGN   6039>>ASSIGN   6042>>ASSIGN
      6043>>ASSIGN   6045>>ASSIGN   6047>>ASSIGN   6053>>ASSIGN   6056>>ASSIGN   6060>>ASSIGN   6063>>ASSIGN
      6067>>ASSIGN   6069>>ASSIGN   6071>>ASSIGN   6073>>ASSIGN   6075>>ASSIGN   6079>>ASSIGN   6087>>ASSIGN
      6091>>ASSIGN   6092>>ASSIGN
TRUNC_FLAG
       101**DCL      5952<<ASSIGN   5955<>CALL     5958<>CALL
U$SE.TYPE
      2135**DCL      5937>>IF       5937>>IF
UBIN36
       117**DCL      6056>>ASSIGN   6063>>ASSIGN   6083>>ASSIGN
USE$
       825**DCL      2133--IMP-PTR  5937>>IF       5937>>IF
VALUE
        11**DCL         9--PROC     5873--ENTRY    5955--CALL     5958--CALL     6025<>CALL     6033<<ASSIGN
      6035<<ASSIGN   6037<<ASSIGN   6039<<ASSIGN   6042<<ASSIGN   6043<<ASSIGN   6045<<ASSIGN   6056<<ASSIGN
      6063<<ASSIGN   6067<<ASSIGN   6069<<ASSIGN   6071<<ASSIGN   6073<<ASSIGN   6079<<ASSIGN   6081<<ASSIGN
      6083<<ASSIGN   6091<<ASSIGN   6092<<ASSIGN
WSR
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:56   
       826**DCL      6081>>ASSIGN
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:57   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:58   
              MINI UREF LISTING

DDE$ERROR     823**DCL-ENT
DDK$GETMVAL       9**PROC
DDK$PUTMVAL    5873**ENTRY
M$ACCT    5790**DCL-ENT
M$ACTIVATE    5793**DCL-ENT
M$ALIB    5786**DCL-ENT
M$ASUSER    5788**DCL-ENT
M$ATTACH    5795**DCL-ENT
M$BADPP    5813**DCL-ENT
M$CGCTL    5794**DCL-ENT
M$CGINFO    5794**DCL-ENT
M$CHECK    5775**DCL-ENT
M$CHGUNIT    5833**DCL-ENT
M$CLOSE    5773**DCL-ENT
M$CLRSTK    5831**DCL-ENT
M$CMDVAR    5842**DCL-ENT
M$CONFIG    5803**DCL-ENT
M$CORRES    5778**DCL-ENT
M$CPEXIT    5787**DCL-ENT
M$CVM    5811**DCL-ENT
M$CVOL    5776**DCL-ENT
M$DCLFLD    5803**DCL-ENT
M$DEACTIVATE    5793**DCL-ENT
M$DELREC    5775**DCL-ENT
M$DEQ    5840**DCL-ENT
M$DETACH    5795**DCL-ENT
M$DEVICE    5777**DCL-ENT
M$DISPLAY    5840**DCL-ENT
M$DISPRES    5780**DCL-ENT
M$DLIB    5786**DCL-ENT
M$DRIBBLE    5803**DCL-ENT
M$DRTN    5831**DCL-ENT
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:59   
M$DSUSER    5788**DCL-ENT
M$ENQ    5839**DCL-ENT
M$EOM    5798**DCL-ENT
M$ERASE    5804**DCL-ENT
M$ERR    5785**DCL-ENT
M$ERRMSG    5836**DCL-ENT
M$EVENT    5828**DCL-ENT
M$EXHUME    5837**DCL-ENT
M$EXIT    5785**DCL-ENT
M$EXTEND    5777**DCL-ENT
M$FDP    5809**DCL-ENT
M$FDS    5808**DCL-ENT
M$FEBOOT    5801**DCL-ENT
M$FECTL    5802**DCL-ENT
M$FEDUMP    5801**DCL-ENT
M$FID    5836**DCL-ENT
M$FINDPROC    5790**DCL-ENT
M$FSUSER    5788**DCL-ENT
M$FVP    5810**DCL-ENT
M$FWCG    5794**DCL-ENT
M$GBPL    5814**DCL-ENT
M$GDDL    5810**DCL-ENT
M$GDP    5809**DCL-ENT
M$GDS    5808**DCL-ENT
M$GETDCB    5779**DCL-ENT
M$GETMOUSE    5819**DCL-ENT
M$GETPM    5820**DCL-ENT
M$GJOB    5838**DCL-ENT
M$GLINEATTR    5798**DCL-ENT
M$GOODPP    5813**DCL-ENT
M$GPLATEN    5806**DCL-ENT
M$GPROMPT    5805**DCL-ENT
M$GTRMATTR    5799**DCL-ENT
M$GTRMCTL    5797**DCL-ENT
M$GTRMTAB    5800**DCL-ENT
M$GVP    5809**DCL-ENT
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:60   
M$HELP    5836**DCL-ENT
M$INT    5828**DCL-ENT
M$INTRTN    5789**DCL-ENT
M$IOQ    5824**DCL-ENT
M$JOBSTATS    5838**DCL-ENT
M$KEYIN    5778**DCL-ENT
M$LDEV    5773**DCL-ENT
M$LDTRC    5786**DCL-ENT
M$LIMIT    5779**DCL-ENT
M$LINES    5778**DCL-ENT
M$LINK    5785**DCL-ENT
M$MADMUCK    5781**DCL-ENT
M$MAKUSER    5812**DCL-ENT
M$MBS    5780**DCL-ENT
M$MDFFLD    5804**DCL-ENT
M$MERC    5829**DCL-ENT
M$MERCS    5830**DCL-ENT
M$MIRROR    5824**DCL-ENT
M$MONINFO    5841**DCL-ENT
M$MPL    5814**DCL-ENT
M$NODEINFO    5805**DCL-ENT
M$NXTUSR    5839**DCL-ENT
M$OCMSG    5837**DCL-ENT
M$OLAY    5785**DCL-ENT
M$OPEN    5773**DCL-ENT
M$PAS    5814**DCL-ENT
M$PATHCON    5837**DCL-ENT
M$PDS    5808**DCL-ENT
M$PFIL    5775**DCL-ENT
M$PLATEN    5799**DCL-ENT
M$PRECORD    5777**DCL-ENT
M$PROCNAME    5790**DCL-ENT
M$PROFILE    5801**DCL-ENT
M$PROMPT    5797**DCL-ENT
M$RACST    5781**DCL-ENT
M$RDSYSLOG    5822**DCL-ENT
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:61   
M$READ    5774**DCL-ENT
M$RELDCB    5779**DCL-ENT
M$RELRES    5780**DCL-ENT
M$RELSTARF    5782**DCL-ENT
M$REM    5782**DCL-ENT
M$RENV    5829**DCL-ENT
M$REQUIRE    5781**DCL-ENT
M$RETRY    5830**DCL-ENT
M$RETRYS    5830**DCL-ENT
M$REW    5776**DCL-ENT
M$RLSFLD    5804**DCL-ENT
M$RPRIV    5832**DCL-ENT
M$RSPP    5811**DCL-ENT
M$RSWITCH    5833**DCL-ENT
M$RUE    5839**DCL-ENT
M$SAD    5812**DCL-ENT
M$SAVE    5788**DCL-ENT
M$SCON    5789**DCL-ENT
M$SCREECH    5787**DCL-ENT
M$SENV    5829**DCL-ENT
M$SETFMA    5773**DCL-ENT
M$SETFP    5802**DCL-ENT
M$SINPUT    5800**DCL-ENT
M$SLCFLD    5805**DCL-ENT
M$SMOUSE    5819**DCL-ENT
M$SMPRT    5811**DCL-ENT
M$SPRIV    5832**DCL-ENT
M$SSC    5812**DCL-ENT
M$SSWITCH    5832**DCL-ENT
M$STATE    5841**DCL-ENT
M$STD    5813**DCL-ENT
M$STIMER    5827**DCL-ENT
M$STLPP    5810**DCL-ENT
M$STRAP    5827**DCL-ENT
M$STRMATTR    5799**DCL-ENT
M$STRMCTL    5797**DCL-ENT
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:62   
M$STRMTAB    5800**DCL-ENT
M$SYMBIO    5838**DCL-ENT
M$SYSCON    5824**DCL-ENT
M$SYSID    5842**DCL-ENT
M$TDCLOSE    5823**DCL-ENT
M$TDIO    5823**DCL-ENT
M$TDOPEN    5822**DCL-ENT
M$TDREQCPU    5823**DCL-ENT
M$TEMPWROC    5817**DCL-ENT
M$TIME    5840**DCL-ENT
M$TRAP    5827**DCL-ENT
M$TRMISC    5802**DCL-ENT
M$TRMPRG    5798**DCL-ENT
M$TRTN    5831**DCL-ENT
M$TRUNC    5774**DCL-ENT
M$TTIMER    5827**DCL-ENT
M$UC    5797**DCL
M$UMPL    5814**DCL-ENT
M$UNFID    5836**DCL-ENT
M$UNLATCH    5793**DCL-ENT
M$UNSHARE    5790**DCL-ENT
M$USRFIELD    5833**DCL-ENT
M$VIRTUAL    5808**DCL-ENT
M$WAIT    5831**DCL-ENT
M$WEOF    5776**DCL-ENT
M$WRITE    5774**DCL-ENT
M$WRSYSLOG    5822**DCL-ENT
M$XCON    5828**DCL-ENT
M$XCONRTN    5789**DCL-ENT
M$XEQTIME    5841**DCL-ENT
M$XFLUSH    5782**DCL-ENT
M$XMOUSE    5819**DCL-ENT
M$XXX    5785**DCL-ENT
M$YC    5787**DCL-ENT
PNTR      22**DCL
SDD$     222**DCL
PL6.E3A0      #001=DDK$GETMVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:63   
SDD_L6$     224**DCL
ZITEM$     223**DCL
ZITEM_L6$     225**DCL

PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:64   
      340        1        /*M*  DDK$GETWVAL - fetch / retreive data from an evaluated address for WHEN */
      341        2        /*T***********************************************************/
      342        3        /*T*                                                         */
      343        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      344        5        /*T*                                                         */
      345        6        /*T***********************************************************/
      346        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
      347        8        %SET LISTSUB='1'B;
      348        9        DDK$GETWVAL: PROC(VALUE$, ADDRESS, BITOFF, BITSIZE, DESC#, NOT_IS) ALTRET;
      349       10          /* Parms */
      350       11    1   DCL VALUE$ PTR;
      351       12    1   DCL ADDRESS UBIN;
      352       13    1   DCL BITOFF SBIN;
      353       14    1   DCL BITSIZE UBIN;
      354       15    1   DCL DESC# UBIN;
      355       16    1   DCL NOT_IS BIT(1) ALIGNED;
      356       17          /* Locals */
      357       18    1   DCL 1 POINTER,
      358       19    1         2 TYPE UBIN(6) UNAL,
      359       20    1         2 ID UBIN(9) UNAL,
      360       21    1         2 DISP UBIN(9) UNAL,
      361       22    1         2 SEGID UBIN(12) UNAL;
      362       23    1   DCL PNTR REDEF POINTER UBIN;
      363       24        %INCLUDE DD_DESC_R;
      364       74    1   DCL 1 ITEM,
      365       75    1         2 * BIT(9),
      366       76    1         2 FLAGS BIT(9),
      367       77    1         2 ADDR_TYPE UBIN BYTE UNAL,
      368       78    1         2 TYPE_CODE UBIN BYTE UNAL,
      369       79    1         2 ADR,
      370       80    1           3 W UBIN(24) UNAL,
      371       81    1           3 C UBIN(6) UNAL,
      372       82    1           3 B UBIN(6) UNAL,
      373       83    1         2 VALUE REDEF ADR UBIN WORD UNAL;
      374       84    1   DCL DSIZE UBIN;
      375       85    1   DCL RSIZE UBIN;
      376       86    1   DCL EXPR_OP UBIN;
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:65   
      377       87    1   DCL ADDR_TYPE UBIN;
      378       88    1   DCL ARRAY_FLAG BIT(1);
      379       89    1   DCL TRUNC_FLAG BIT(1);
      380       90    1   DCL UBIN36 UBIN BASED;
      381       91        %INCLUDE DD$DITEM;
       12+     194             %LIST;
       13+     195    1        DCL SDD$ PTR;
       14+     196    1        DCL ZITEM$ PTR;
       15+     197    1        DCL SDD_L6$ PTR;
       16+     198    1        DCL ZITEM_L6$ PTR;
      382      772    1   DCL 1 BASED_ITEM CONSTANT,
      383      773    1         2 * UBIN(18) UNAL INIT(0),
      384      774    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BASED_ACODE),
      385      775    1         2 * UBIN(9) UNAL INIT(0),
      386      776    1         2 * BIT(36) INIT('0'B);
      387      777    1   DCL 1 STATIC_ITEM CONSTANT,
      388      778    1         2 * UBIN(18) UNAL INIT(0),
      389      779    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%STATIC_ACODE),
      390      780    1         2 * UBIN(9) UNAL INIT(0),
      391      781    1         2 * BIT(36) INIT('0'B);
      392      782          /* External routines */
      393      783    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
      394      784    1        IF NOT_IS
      395      785    2        THEN DO;
      396      786    2             POINTER = DESC.ITEM(%LS_DESC);
      397      787    2             POINTER.DISP = DESC# * 2;
      398      788    2             ITEM = BASED_ITEM;
      399      789    2             ITEM.ADR.W = ADDRESS;
      400      790    2             ITEM.ADR.C = BITOFF / 9;
      401      791    2             ITEM.ADR.B = MOD(BITOFF,9);
      402      792    2             POINTER = POINTER & '777777770000'O | '000000002000'O;
      403      793    2           END;                            /* DO ( NOT_IS ) */
      404      794    2        ELSE DO;                           /* Instruction segment */
      405      795    2             ITEM = STATIC_ITEM;
      406      796    2             ITEM.ADR.W = ADDRESS;
      407      797    2             ITEM.ADR.C = BITOFF / 9;
      408      798    2             ITEM.ADR.B = MOD(BITOFF,9);
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:66   
      409      799    2           END;                            /* DO ( instruction segment ) */
      410      800    1        DSIZE = BITSIZE;
      411      801    1        RSIZE = BITSIZE;
      412      802    1        EXPR_OP = 0;
      413      803    1        ADDR_TYPE = ITEM.ADDR_TYPE;
      414      804    1        ARRAY_FLAG = '0'B;
      415      805    1        TRUNC_FLAG = '0'B;
      416      806                                                /**/
      417      807    1        CALL DDK$GETVAL(VALUE$, ITEM, 0, DSIZE, RSIZE, 0,
      418      808    1          POINTER, 0, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      419      809    1          TRUNC_FLAG) ALTRET(ARET);
      420      810                                                /**/
      421      811    1        RETURN;
      422      812    1   ARET:
      423      813    1        ALTRETURN;
      424      814    1   END DDK$GETWVAL;

PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:67   
--  Include file information  --

   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$GETWVAL.

   Procedure DDK$GETWVAL requires 89 words for executable code.
   Procedure DDK$GETWVAL requires 34 words of local(AUTO) storage.

    No errors detected in file DDK$GETMVAL.:E05TSI    .

PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:68   

 Object Unit name= DDK$GETWVAL                                File name= DDK$GETMVAL.:E05TOU
 UTS= JUL 29 '97 14:02:48.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      6      6  DDK$GETWVAL
    1   Proc  even  none    89    131  DDK$GETWVAL
    2  RoData even  none     3      3  DDK$GETWVAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        6  DDK$GETWVAL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std      13 DDK$GETVAL
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DESC                                  B_VECTNIL
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:69   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:70   


      340        1        /*M*  DDK$GETWVAL - fetch / retreive data from an evaluated address for WHEN */
      341        2        /*T***********************************************************/
      342        3        /*T*                                                         */
      343        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      344        5        /*T*                                                         */
      345        6        /*T***********************************************************/
      346        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
      347        8        %SET LISTSUB='1'B;
      348        9        DDK$GETWVAL: PROC(VALUE$, ADDRESS, BITOFF, BITSIZE, DESC#, NOT_IS) ALTRET;

      9  1 000000   000000 700200 xent  DDK$GETWVAL  TSX0  ! X66_AUTO_N
         1 000001   000042 000006                    ZERO    34,6

      349       10          /* Parms */
      350       11    1   DCL VALUE$ PTR;
      351       12    1   DCL ADDRESS UBIN;
      352       13    1   DCL BITOFF SBIN;
      353       14    1   DCL BITSIZE UBIN;
      354       15    1   DCL DESC# UBIN;
      355       16    1   DCL NOT_IS BIT(1) ALIGNED;
      356       17          /* Locals */
      357       18    1   DCL 1 POINTER,
      358       19    1         2 TYPE UBIN(6) UNAL,
      359       20    1         2 ID UBIN(9) UNAL,
      360       21    1         2 DISP UBIN(9) UNAL,
      361       22    1         2 SEGID UBIN(12) UNAL;
      362       23    1   DCL PNTR REDEF POINTER UBIN;
      363       24        %INCLUDE DD_DESC_R;
      364       74    1   DCL 1 ITEM,
      365       75    1         2 * BIT(9),
      366       76    1         2 FLAGS BIT(9),
      367       77    1         2 ADDR_TYPE UBIN BYTE UNAL,
      368       78    1         2 TYPE_CODE UBIN BYTE UNAL,
      369       79    1         2 ADR,
      370       80    1           3 W UBIN(24) UNAL,
      371       81    1           3 C UBIN(6) UNAL,
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:71   
      372       82    1           3 B UBIN(6) UNAL,
      373       83    1         2 VALUE REDEF ADR UBIN WORD UNAL;
      374       84    1   DCL DSIZE UBIN;
      375       85    1   DCL RSIZE UBIN;
      376       86    1   DCL EXPR_OP UBIN;
      377       87    1   DCL ADDR_TYPE UBIN;
      378       88    1   DCL ARRAY_FLAG BIT(1);
      379       89    1   DCL TRUNC_FLAG BIT(1);
      380       90    1   DCL UBIN36 UBIN BASED;
      381       91        %INCLUDE DD$DITEM;
       12+     194             %LIST;
       13+     195    1        DCL SDD$ PTR;
       14+     196    1        DCL ZITEM$ PTR;
       15+     197    1        DCL SDD_L6$ PTR;
       16+     198    1        DCL ZITEM_L6$ PTR;
      382      772    1   DCL 1 BASED_ITEM CONSTANT,
      383      773    1         2 * UBIN(18) UNAL INIT(0),
      384      774    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%BASED_ACODE),
      385      775    1         2 * UBIN(9) UNAL INIT(0),
      386      776    1         2 * BIT(36) INIT('0'B);
      387      777    1   DCL 1 STATIC_ITEM CONSTANT,
      388      778    1         2 * UBIN(18) UNAL INIT(0),
      389      779    1         2 ADDR_TYPE UBIN BYTE UNAL INIT(%STATIC_ACODE),
      390      780    1         2 * UBIN(9) UNAL INIT(0),
      391      781    1         2 * BIT(36) INIT('0'B);
      392      782          /* External routines */
      393      783    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
      394      784    1        IF NOT_IS

    784  1 000002   200010 470500                    LDP0    @NOT_IS,,AUTO
         1 000003   000000 234100                    SZN     0,,PR0
         1 000004   000042 605000 1                  TPL     s:795

      395      785    2        THEN DO;

      396      786    2             POINTER = DESC.ITEM(%LS_DESC);

PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:72   
    786  1 000005   000053 236000 xsym               LDQ     DESC+43
         1 000006   200011 756100                    STQ     POINTER,,AUTO

      397      787    2             POINTER.DISP = DESC# * 2;

    787  1 000007   200007 471500                    LDP1    @DESC#,,AUTO
         1 000010   100000 236100                    LDQ     0,,PR1
         1 000011   000001 736000                    QLS     1
         1 000012   000014 736000                    QLS     12
         1 000013   200011 676100                    ERQ     POINTER,,AUTO
         1 000014   000000 376000 2                  ANQ     0
         1 000015   200011 656100                    ERSQ    POINTER,,AUTO

      398      788    2             ITEM = BASED_ITEM;

    788  1 000016   000000 237000 0                  LDAQ    BASED_ITEM
         1 000017   200012 757100                    STAQ    ITEM,,AUTO

      399      789    2             ITEM.ADR.W = ADDRESS;

    789  1 000020   200004 473500                    LDP3    @ADDRESS,,AUTO
         1 000021   300000 236100                    LDQ     0,,PR3
         1 000022   000014 736000                    QLS     12
         1 000023   200013 752174                    STCQ    ITEM+1,'74'O,AUTO

      400      790    2             ITEM.ADR.C = BITOFF / 9;

    790  1 000024   200005 474500                    LDP4    @BITOFF,,AUTO
         1 000025   400000 236100                    LDQ     0,,PR4
         1 000026   000011 506007                    DIV     9,DL
         1 000027   000006 736000                    QLS     6
         1 000030   200013 752102                    STCQ    ITEM+1,'02'O,AUTO

      401      791    2             ITEM.ADR.B = MOD(BITOFF,9);

    791  1 000031   400000 236100                    LDQ     0,,PR4
         1 000032   000011 506007                    DIV     9,DL
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:73   
         1 000033   000044 733000                    LRS     36
         1 000034   200013 752101                    STCQ    ITEM+1,'01'O,AUTO

      402      792    2             POINTER = POINTER & '777777770000'O | '000000002000'O;

    792  1 000035   200011 236100                    LDQ     POINTER,,AUTO
         1 000036   000004 376000 0                  ANQ     STATIC_ITEM+2
         1 000037   000005 276000 0                  ORQ     STATIC_ITEM+3
         1 000040   200011 756100                    STQ     POINTER,,AUTO

      403      793    2           END;                            /* DO ( NOT_IS ) */

    793  1 000041   000061 710000 1                  TRA     s:800

      404      794    2        ELSE DO;                           /* Instruction segment */

      405      795    2             ITEM = STATIC_ITEM;

    795  1 000042   000002 237000 0                  LDAQ    STATIC_ITEM
         1 000043   200012 757100                    STAQ    ITEM,,AUTO

      406      796    2             ITEM.ADR.W = ADDRESS;

    796  1 000044   200004 471500                    LDP1    @ADDRESS,,AUTO
         1 000045   100000 236100                    LDQ     0,,PR1
         1 000046   000014 736000                    QLS     12
         1 000047   200013 752174                    STCQ    ITEM+1,'74'O,AUTO

      407      797    2             ITEM.ADR.C = BITOFF / 9;

    797  1 000050   200005 473500                    LDP3    @BITOFF,,AUTO
         1 000051   300000 236100                    LDQ     0,,PR3
         1 000052   000011 506007                    DIV     9,DL
         1 000053   000006 736000                    QLS     6
         1 000054   200013 752102                    STCQ    ITEM+1,'02'O,AUTO

      408      798    2             ITEM.ADR.B = MOD(BITOFF,9);
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:74   

    798  1 000055   300000 236100                    LDQ     0,,PR3
         1 000056   000011 506007                    DIV     9,DL
         1 000057   000044 733000                    LRS     36
         1 000060   200013 752101                    STCQ    ITEM+1,'01'O,AUTO

      409      799    2           END;                            /* DO ( instruction segment ) */

      410      800    1        DSIZE = BITSIZE;

    800  1 000061   200006 471500                    LDP1    @BITSIZE,,AUTO
         1 000062   100000 235100                    LDA     0,,PR1
         1 000063   200014 755100                    STA     DSIZE,,AUTO

      411      801    1        RSIZE = BITSIZE;

    801  1 000064   100000 235100                    LDA     0,,PR1
         1 000065   200015 755100                    STA     RSIZE,,AUTO

      412      802    1        EXPR_OP = 0;

    802  1 000066   200016 450100                    STZ     EXPR_OP,,AUTO

      413      803    1        ADDR_TYPE = ITEM.ADDR_TYPE;

    803  1 000067   200012 236100                    LDQ     ITEM,,AUTO
         1 000070   000011 772000                    QRL     9
         1 000071   000777 376007                    ANQ     511,DL
         1 000072   200017 756100                    STQ     ADDR_TYPE,,AUTO

      414      804    1        ARRAY_FLAG = '0'B;

    804  1 000073   200020 450100                    STZ     ARRAY_FLAG,,AUTO

      415      805    1        TRUNC_FLAG = '0'B;

    805  1 000074   200021 450100                    STZ     TRUNC_FLAG,,AUTO
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:75   

      416      806                                                /**/
      417      807    1        CALL DDK$GETVAL(VALUE$, ITEM, 0, DSIZE, RSIZE, 0,

    807  1 000075   200021 633500                    EPPR3   TRUNC_FLAG,,AUTO
         1 000076   200041 453500                    STP3    TRUNC_FLAG+16,,AUTO
         1 000077   200020 634500                    EPPR4   ARRAY_FLAG,,AUTO
         1 000100   200040 454500                    STP4    TRUNC_FLAG+15,,AUTO
         1 000101   200017 635500                    EPPR5   ADDR_TYPE,,AUTO
         1 000102   200037 455500                    STP5    TRUNC_FLAG+14,,AUTO
         1 000103   200016 636500                    EPPR6   EXPR_OP,,AUTO
         1 000104   200036 456500                    STP6    TRUNC_FLAG+13,,AUTO
         1 000105   000002 236000 2                  LDQ     2
         1 000106   200035 756100                    STQ     TRUNC_FLAG+12,,AUTO
         1 000107   200011 637500                    EPPR7   POINTER,,AUTO
         1 000110   200034 457500                    STP7    TRUNC_FLAG+11,,AUTO
         1 000111   200033 756100                    STQ     TRUNC_FLAG+10,,AUTO
         1 000112   200015 630500                    EPPR0   RSIZE,,AUTO
         1 000113   200032 450500                    STP0    TRUNC_FLAG+9,,AUTO
         1 000114   200014 630500                    EPPR0   DSIZE,,AUTO
         1 000115   200031 450500                    STP0    TRUNC_FLAG+8,,AUTO
         1 000116   200030 756100                    STQ     TRUNC_FLAG+7,,AUTO
         1 000117   200012 630500                    EPPR0   ITEM,,AUTO
         1 000120   200027 450500                    STP0    TRUNC_FLAG+6,,AUTO
         1 000121   200003 236100                    LDQ     @VALUE$,,AUTO
         1 000122   200026 756100                    STQ     TRUNC_FLAG+5,,AUTO
         1 000123   200026 630500                    EPPR0   TRUNC_FLAG+5,,AUTO
         1 000124   000001 631400 2                  EPPR1   1
         1 000125   000000 701000 xent               TSX1    DDK$GETVAL
         1 000126   000130 702000 1                  TSX2    ARET

      418      808    1          POINTER, 0, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      419      809    1          TRUNC_FLAG) ALTRET(ARET);
      420      810                                                /**/
      421      811    1        RETURN;

    811  1 000127   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:76   

      422      812    1   ARET:
      423      813    1        ALTRETURN;

    813  1 000130   000000 702200 xent  ARET         TSX2  ! X66_AALT

BASED_ITEM
 Sect OctLoc
   0     000   000000 002000   000000 000000                                    ........

STATIC_ITEM
 Sect OctLoc
   0     002   000000 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   0     004   777777 770000   000000 002000                                    ........

(unnamed)
 Sect OctLoc
   2     000   000007 770000   000014 000000   000002 006000                    ............
      424      814    1   END DDK$GETWVAL;

PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:77   
--  Include file information  --

   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$GETWVAL.

   Procedure DDK$GETWVAL requires 89 words for executable code.
   Procedure DDK$GETWVAL requires 34 words of local(AUTO) storage.

    No errors detected in file DDK$GETMVAL.:E05TSI    .
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:78   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:79   
          MINI XREF LISTING

ADDRESS
        12**DCL         9--PROC      789>>ASSIGN    796>>ASSIGN
ADDR_TYPE
        87**DCL       803<<ASSIGN    807<>CALL
ARET
       813**LABEL     807--CALLALT
ARRAY_FLAG
        88**DCL       804<<ASSIGN    807<>CALL
BASED_ITEM
       772**DCL       788>>ASSIGN
BITOFF
        13**DCL         9--PROC      790>>ASSIGN    791>>ASSIGN    797>>ASSIGN    798>>ASSIGN
BITSIZE
        14**DCL         9--PROC      800>>ASSIGN    801>>ASSIGN
DDK$GETVAL
       783**DCL-ENT   807--CALL
DESC.ITEM
        73**DCL       786>>ASSIGN
DESC#
        15**DCL         9--PROC      787>>ASSIGN
DSIZE
        84**DCL       800<<ASSIGN    807<>CALL
EXPR_OP
        86**DCL       802<<ASSIGN    807<>CALL
ITEM
        74**DCL       788<<ASSIGN    795<<ASSIGN    807<>CALL
ITEM.ADDR_TYPE
        77**DCL       803>>ASSIGN
ITEM.ADR
        79**DCL        83--REDEF
ITEM.ADR.B
        82**DCL       791<<ASSIGN    798<<ASSIGN
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:80   
ITEM.ADR.C
        81**DCL       790<<ASSIGN    797<<ASSIGN
ITEM.ADR.W
        80**DCL       789<<ASSIGN    796<<ASSIGN
NOT_IS
        16**DCL         9--PROC      784>>IF
POINTER
        18**DCL        23--REDEF     786<<ASSIGN    792<<ASSIGN    792>>ASSIGN    807<>CALL
POINTER.DISP
        21**DCL       787<<ASSIGN
RSIZE
        85**DCL       801<<ASSIGN    807<>CALL
STATIC_ITEM
       777**DCL       795>>ASSIGN
TRUNC_FLAG
        89**DCL       805<<ASSIGN    807<>CALL
VALUE$
        11**DCL         9--PROC      807<>CALL
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:81   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDK$GETWVAL File=DDK$GETMVAL.:E05TSI                          TUE 07/29/97 14:02 Page:82   
              MINI UREF LISTING

DDK$GETWVAL       9**PROC
PNTR      23**DCL
SDD$     195**DCL
SDD_L6$     197**DCL
UBIN36      90**DCL
ZITEM$     196**DCL
ZITEM_L6$     198**DCL
