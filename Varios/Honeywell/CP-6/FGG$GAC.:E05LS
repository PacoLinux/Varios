VERSION E05

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:1    
        1        1        /*M*  FGG$GAC - Granule accounting */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* */
        8        8        /**/
        9        9        /**/
       10       10        /*P*    NAME:    FGG$GAC
       11       11        *       PURPOSE:  Write accounting records to charge for granule use  */
       12       12        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:2    
       13       13        /**/
       14       14        /*D*    NAME:     FGG$START
       15       15        *       CALL:     CALL FGG$START(DCB$,MODEFLG) ALTRET(LOC);
       16       16        *       INPUT:    DCB$ - Pointer to the DCB used to locate files
       17       17        *                 MODEFLG - > 0 if called by PIG during pack
       18       18        *                           mount for a pack that has shelf-time
       19       19        *                           accounting
       20       20        *       DESCRIPTION:
       21       21        *         Opens the GAC control file on the pack, and the accounting
       22       22        *       log.  Writes an initial record to the accounting log.
       23       23        */
       24       24        /**/
       25       25        /**/
       26       26        FGG$START: PROC(PDCB$,PMODEFLG) ALTRET;
       27       27        /* PARAMETERS */
       28       28    1   DCL PDCB$ PTR;
       29       29    1   DCL PMODEFLG UBIN;
       30       30        /* EXTERNAL DATA */
       31       31    1   DCL B$JIT$ PTR SYMREF;
       32       32    1   DCL B$TCB$ PTR SYMREF;
       33       33        /* DCBS */
       34       34    1   DCL M$GAC DCB;
       35       35        /* INCLUDE FILES */
       36       36        %INCLUDE AZ_MACRO_C;
       37     2623        %INCLUDE AZ_SUBS_C;
       38     2692        %INCLUDE B$JIT;
       39     2982        %INCLUDE B_ERRORS_C;
       40     4109        %INCLUDE CP_6;
       41     4190        %INCLUDE EL_SUBS_C;
       42     4274        %INCLUDE FM$FIT;
       43     4495        %INCLUDE XUD_UTS_M;
       44     4577        /* EXTERNAL ROUTINES */
       45     4578    1   DCL FGH$UPDBUCKET ENTRY(4);
       46     4579    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
       47     4580    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       48     4581    1   DCL XSF$LOCCODT ENTRY(2) ALTRET;
       49     4582        %XUD$UTS_ENTRIES;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:3    
       50     4614        /* CONSTANT STORAGE */
       51     4615        %FM_FITCODE (NAME=FIT1CODE,CODE=1,NAW=2);
       52     4618        %VLP_ACCT (FPTN=ACCTZER,ACCT="BINASC(0)",STCLASS=CONSTANT);
       53     4631        /* STATIC STORAGE */
       54     4632    1   DCL DCB$ PTR STATIC;          /* Ptr to DCB used by caller to locate files    */
       55     4633    1   DCL MODEFLG SBIN STATIC; /* Non-zero if called by PIG for shelf-time acctg    */
       56     4634    1   DCL DATA$ PTR STATIC INIT(ADDR(DATAREA)); /* Ptr to data                      */
       57     4635    1   DCL DATAREA(0:1023) UBIN STATIC;        /* Data area to hold acctg recs       */
       58     4636    1   DCL DATASIZ UBIN STATIC;                /* # words of data space              */
       59     4637    1   DCL AVAILSIZ UBIN STATIC;               /* # words of data not used           */
       60     4638    1   DCL NUMENT UBIN STATIC;                 /* # entries in data                  */
       61     4639    1   DCL START_OK UBIN STATIC INIT(0);
       62     4640    1   DCL ACCT CHAR(8) STATIC;                /* Current account                    */
       63     4641    1   DCL THIS_GAC_START_TIME UBIN STATIC;    /* Time this GAC run started          */
       64     4642    1   DCL PREV_GAC_START_TIME UBIN STATIC;    /* Time prev GAC run started          */
       65     4643    1   DCL PREV_GAC_STOP_TIME  UBIN STATIC;    /* Time prev GAC run stopped          */
       66     4644        /* STATIC STRUCTURES */
       67     4645    1   DCL 1 GACCTL STATIC,
       68     4646    1         2 MOUNT_TIME UBIN,
       69     4647    1         2 DISMOUNT_TIME UBIN,
       70     4648    1         2 START_TIME UBIN,
       71     4649    1         2 STOP_TIME UBIN;
       72     4650    1   DCL 1 DEVSN STATIC,
       73     4651    1         2 * UBIN INIT(1),
       74     4652    1         2 SN CHAR(6);
       75     4653        %GACID(NAME=ID_REC,STCLASS=STATIC);
       76     4686        /* LOCAL AUTOMATIC STORAGE */
       77     4687    1   DCL TIME UBIN;
       78     4688    1   DCL FIT$ PTR;
       79     4689    1   DCL COD3$ PTR;
       80     4690    1   DCL COD4$ PTR;
       81     4691    1   DCL COD6$ PTR;
       82     4692    1   DCL NGRANS UBIN;
       83     4693    1   DCL CHARGTYP UBIN;
       84     4694    1   DCL OLDINTEGRAL UBIN;
       85     4695    1   DCL ENT$ PTR;
       86     4696    1   DCL I UBIN;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:4    
       87     4697        /* PRE-PROCESSOR VARIABLES */
       88     4698        /* FPTS */
       89     4699        %FPT_OPEN (FPTN=FPT_RDPAK,ACCT=ACCTZER,RES='DP',ASN=DEVICE,
       90     4700                   FUN=IN,FPARAM=DATAREA,SN=DEVSN,DCB=M$GAC);
       91     4809        %FPT_OPEN (FPTN=FPT_UPDPAK,ACCT=ACCTZER,RES='DP',ASN=DEVICE,
       92     4810                   FUN=UPDATE,IFPARAM=DATAREA,SN=DEVSN,DCB=M$GAC);
       93     4919        %FPT_TIME(SOURCE=CLOCK,DEST=UTS,TSTAMP=THIS_GAC_START_TIME);
       94     4938        %FPT_WRSYSLOG(FPTN=FPTWRID,ENTRY=ID_REC,SIZE="SIZEW(ID_REC)",
       95     4939                      FILENUM=2,TYPE=EL_ACCTLG);
       96     4954        %FPT_WRSYSLOG(FPTN=FPTWRENT,SIZE="SIZEW(ENT)",
       97     4955                      FILENUM=2,TYPE=EL_ACCTLG);
       98     4970        %B$TCB;
       99     4973        %B$ALT;
      100     4981        %F$DCB;
      101     5038        %FM$FIT (BASED="BASED(DATA$)");
      102     5041        %CODE03(BASED="BASED(COD3$)");
      103     5048        %CODE04(BASED="BASED(COD4$)");
      104     5056        %PGRANS(NAME=ENT,STCLASS="BASED(ENT$)");
      105     5122        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:5    
      106     5123        /**/
      107     5124    1           DCB$=PDCB$;                     /* Save parameters                    */
      108     5125    1           MODEFLG=PMODEFLG;
      109     5126        /**/
      110     5127    1           DATASIZ=SIZEW(DATAREA);
      111     5128    1           AVAILSIZ=DATASIZ;
      112     5129    1           NUMENT=0;
      113     5130    1           START_OK=0;
      114     5131        /**/
      115     5132    1           CALL M$TIME(FPT_TIME);
      116     5133        /**/
      117     5134    1           DEVSN.SN=DCB$->F$DCB.PSN#;
      118     5135    1           IF DEVSN.SN='SYS' AND MODEFLG>0 THEN
      119     5136    1              RETURN;                      /* Can't do SYS pack at mount time    */
      120     5137    1           CALL M$OPEN(FPT_RDPAK) ALTRET(ABORT); /* Get AD FIT                   */
      121     5138    1           COD4$=DATA$;
      122     5139    1           CALL XSF$LOCCODP(COD4$,4) ALTRET(ABORT);
      123     5140    1           GACCTL.STOP_TIME=CODE04.GAC.TIME;
      124     5141    1           GACCTL.START_TIME=CODE04.GAC.N;
      125     5142    1           GACCTL.MOUNT_TIME=CODE04.ACCESS.TIME;
      126     5143    1           GACCTL.DISMOUNT_TIME=CODE04.SVMODIFY.TIME;
      127     5144        /**/
      128     5145        /* Make sure that mount/dismount and GAC times are consistent */
      129     5146        /**/
      130     5147    1           IF GACCTL.STOP_TIME>THIS_GAC_START_TIME THEN
      131     5148    1              GACCTL.STOP_TIME=THIS_GAC_START_TIME;
      132     5149    1           IF GACCTL.STOP_TIME<GACCTL.START_TIME THEN
      133     5150    1              GACCTL.START_TIME=GACCTL.STOP_TIME;
      134     5151    1           IF GACCTL.DISMOUNT_TIME>THIS_GAC_START_TIME THEN
      135     5152    1              GACCTL.DISMOUNT_TIME=THIS_GAC_START_TIME;
      136     5153    1           IF GACCTL.DISMOUNT_TIME<GACCTL.MOUNT_TIME THEN
      137     5154    1              GACCTL.MOUNT_TIME=GACCTL.DISMOUNT_TIME;
      138     5155    1           PREV_GAC_START_TIME=GACCTL.START_TIME;
      139     5156    1           PREV_GAC_STOP_TIME=GACCTL.STOP_TIME;
      140     5157        /**/
      141     5158    1           ID_REC='0'B;
      142     5159    1           ID_REC.ACCT=B$JIT.ACCN;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:6    
      143     5160    1           ID_REC.UNAME=B$JIT.UNAME;
      144     5161    1           ID_REC.SYSID=B$JIT.SYSID;
      145     5162    1           ID_REC.CODE=%AZ$GACID;
      146     5163    1           CALL M$WRSYSLOG(FPTWRID) ALTRET(ABORT);
      147     5164        /**/
      148     5165    1           ACCT=BINASC(0);
      149     5166        /**/
      150     5167    1           START_OK=1;
      151     5168        /**/
      152     5169    1           RETURN;
      153     5170        /**/
      154     5171    1   ABORT:  ALTRETURN;
      155     5172        /**/
      156     5173        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:7    
      157     5174        /**/
      158     5175        /*D*    NAME:       FGG$DONE
      159     5176        *       CALL:       CALL FGG$DONE
      160     5177        *       DESCRIPTION:  Called to indicate successful completion of
      161     5178        *         a GAC run.  Closes files, updates control info on pack,
      162     5179        *         writes final accounting info.
      163     5180        */
      164     5181        /**/
      165     5182    1   FGG$DONE: ENTRY ALTRET;                 /* Doesn't ALTRET                     */
      166     5183        /**/
      167     5184    1           IF START_OK=0 THEN
      168     5185    1              GOTO CLNUP;                  /* Never got going                    */
      169     5186    1           START_OK=0;
      170     5187        /**/
      171     5188    1           CALL FLUSH;                     /* Flush out any remaining records    */
      172     5189        /**/
      173     5190    1           GACCTL.START_TIME=THIS_GAC_START_TIME;
      174     5191    1           CALL M$TIME(FPT_TIME);
      175     5192    1           GACCTL.STOP_TIME=THIS_GAC_START_TIME;
      176     5193    1           CALL M$OPEN(FPT_RDPAK) ALTRET(CLNUP); /* Get AD FIT                   */
      177     5194    1           COD4$=DATA$;
      178     5195    1           I=4;
      179     5196    1           CALL XSF$LOCCODE(COD4$,I) ALTRET(CLNUP);
      180     5197    1           FM$FIT.CODES(0)=FIT1CODE;       /* Make code 4 the only one           */
      181     5198    1           FM$FIT.CODES(1)=FM$FIT.CODES(I);
      182     5199    1           CODE04.GAC.TIME=GACCTL.STOP_TIME;
      183     5200    1           CODE04.GAC.N=GACCTL.START_TIME;
      184     5201    1           CALL M$OPEN(FPT_UPDPAK) ALTRET(CLNUP);
      185     5202    1   DONE2:  ID_REC.FLAG='1'B;
      186     5203    1           CALL M$WRSYSLOG(FPTWRID) ALTRET(DONE3);
      187     5204    1   DONE3:  ;
      188     5205        /**/
      189     5206    1   FGG$QUIT: ENTRY ALTRET;                 /* Doesn't ALTRET                     */
      190     5207        /**/
      191     5208    1   CLNUP:  START_OK=0;
      192     5209    1           NUMENT=0;
      193     5210    1   QUIT2:  RETURN;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:8    
      194     5211        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:9    
      195     5212        /**/
      196     5213        /*D*    NAME:       FGG$PROCESS_FIT
      197     5214        *       CALL:       CALL FGG$PROCESS_FIT(FIT$) ALTRET(LOC);
      198     5215        *       INPUT:      FIT$ - Ptr to FIT
      199     5216        *       DESCRIPTION:
      200     5217        *         Creates appropriate accounting info for this file
      201     5218        */
      202     5219        /**/
      203     5220    1   FGG$PROCESS_FIT: ENTRY(PDCB$) ALTRET;
      204     5221        /**/
      205     5222    1           IF START_OK=0 THEN
      206     5223    1              RETURN;                      /* Never got started                  */
      207     5224    1           FIT$=PDCB$;
      208     5225    2           IF DCB$->F$DCB.ACCT#~=ACCT THEN DO; /* Account has changed            */
      209     5226    2              CALL FLUSH;             /* Get rid of any current acctg records    */
      210     5227    2              ACCT=DCB$->F$DCB.ACCT#;
      211     5228    2              END;
      212     5229        /**/
      213     5230    1           IF DEVSN.SN='SYS' AND (ACCT=':SYMI' OR ACCT=':SYMO') THEN
      214     5231    1              RETURN;                      /* Ignore symbiont accounts           */
      215     5232        /**/
      216     5233    1           COD4$=FIT$;
      217     5234    1           CALL XSF$LOCCODP(COD4$,4) ALTRET(RET);
      218     5235    1           COD3$=FIT$;
      219     5236    1           CALL XSF$LOCCODP(COD3$,3) ALTRET(RET);
      220     5237    1           NGRANS=CODE03.UGRANS+CODE03.NGAVAL;
      221     5238    1           IF CODE03.DESC.BUPM THEN
      222     5239    1              CHARGTYP=%AZ$GACBACKUP;
      223     5240    1           ELSE
      224     5241    1              CHARGTYP=%AZ$GACNOBACKUP;
      225     5242    1           COD6$=FIT$;
      226     5243    1           CALL XSF$LOCCODT(COD6$,6) ALTRET(NOTSTOW);
      227     5244    1           CHARGTYP=%AZ$GACSTOWACT;
      228     5245        /**/
      229     5246    1   NOTSTOW: CALL FINDENTRY ALTRET(RET);
      230     5247        /**/
      231     5248    1           IF MODEFLG>0 AND CODE04.GAC.TIME<GACCTL.DISMOUNT_TIME AND
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:10   
      232     5249    2             PREV_GAC_START_TIME<GACCTL.DISMOUNT_TIME THEN DO;
      233     5250    3              IF CODE04.GAC.TIME<PREV_GAC_START_TIME THEN DO;
      234     5251    3                 CALL XUD$UTS_DIFF(TIME,GACCTL.DISMOUNT_TIME,PREV_GAC_START_TIME);
      235     5252    3                 OLDINTEGRAL=0;
      236     5253    3                 END;
      237     5254    2              ELSE
      238     5255    3                 IF CODE04.GAC.TIME<PREV_GAC_STOP_TIME THEN DO;
      239     5256    3                    CALL XUD$UTS_DIFF(TIME,GACCTL.DISMOUNT_TIME,PREV_GAC_STOP_TIME);
      240     5257    3                    OLDINTEGRAL=0;
      241     5258    3                    END;
      242     5259    3                 ELSE DO;
      243     5260    3                    CALL XUD$UTS_DIFF(TIME,GACCTL.DISMOUNT_TIME,CODE04.GAC.TIME);
      244     5261    3                    OLDINTEGRAL=CODE04.GAC.N;
      245     5262    3                    END;
      246     5263                                           /* Account for time up to last dismount    */
      247     5264    2              CALL FGH$UPDBUCKET(ENT.ONLINE(CHARGTYP),OLDINTEGRAL,
      248     5265    2                TIME,NGRANS);
      249     5266        /**/
      250     5267    2              CALL XUD$UTS_DIFF(TIME,GACCTL.MOUNT_TIME,GACCTL.DISMOUNT_TIME);
      251     5268    2              CALL FGH$UPDBUCKET(ENT.SHELF(CHARGTYP),0,TIME,NGRANS);
      252     5269    2              CODE04.GAC.TIME=GACCTL.MOUNT_TIME;
      253     5270    2              CODE04.GAC.N=0;
      254     5271    2              END;
      255     5272        /**/
      256     5273    2           IF CODE04.GAC.TIME<PREV_GAC_START_TIME THEN DO;
      257     5274    2              CALL XUD$UTS_DIFF(TIME,THIS_GAC_START_TIME,PREV_GAC_START_TIME);
      258     5275    2              OLDINTEGRAL=0;
      259     5276    2              GOTO COMP;
      260     5277    2              END;
      261     5278    2           IF CODE04.GAC.TIME<PREV_GAC_STOP_TIME THEN DO;
      262     5279    2              CALL XUD$UTS_DIFF(TIME,THIS_GAC_START_TIME,PREV_GAC_STOP_TIME);
      263     5280    2              OLDINTEGRAL=0;
      264     5281    2              GOTO COMP;
      265     5282    2              END;
      266     5283    2           IF CODE04.GAC.TIME<THIS_GAC_START_TIME THEN DO;
      267     5284    2              CALL XUD$UTS_DIFF(TIME,THIS_GAC_START_TIME,CODE04.GAC.TIME);
      268     5285    2              OLDINTEGRAL=CODE04.GAC.N;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:11   
      269     5286    2              GOTO COMP;
      270     5287    2              END;
      271     5288    1           TIME=0;
      272     5289    1           OLDINTEGRAL=CODE04.GAC.N;
      273     5290    1   COMP:   CALL FGH$UPDBUCKET(ENT.ONLINE(CHARGTYP),OLDINTEGRAL,
      274     5291    1             TIME,NGRANS);
      275     5292    1   RET:    RETURN;
      276     5293        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:12   
      277     5294        /**/
      278     5295        /*D*    NAME:     FINDENTRY
      279     5296        *       CALL:     CALL FINDENTRY ALTRET(LOC);
      280     5297        *       DESCRIPTION:  Searches the in-core accounting log entries
      281     5298        *         to see if there is already one present for the creator
      282     5299        *         of this file.  If so, returns with that entry.  If not,
      283     5300        *         one is built, flushing out old ones if necessary to
      284     5301        *         make room.
      285     5302        */
      286     5303        /**/
      287     5304    1   FINDENTRY: PROC ALTRET;
      288     5305        /**/
      289     5306    2   RETRY:  ENT$=DATA$;
      290     5307    3           DO I=1 TO NUMENT;
      291     5308    3              IF ENT.CREATOR=CODE04.CREATOR AND ENT.FMACCT=ACCT THEN
      292     5309    3                 RETURN;
      293     5310    3              ENT$=PINCRW(ENT$,SIZEW(ENT));
      294     5311    3              END;
      295     5312    3           IF AVAILSIZ>=SIZEW(ENT) THEN DO;
      296     5313    3              AVAILSIZ=AVAILSIZ-SIZEW(ENT);
      297     5314    3              ENT$=PINCRW(DATA$,NUMENT*SIZEW(ENT));
      298     5315    3              NUMENT=NUMENT+1;
      299     5316    3              ENT='0'B;
      300     5317    3              ENT.CREATOR=CODE04.CREATOR;
      301     5318    3              ENT.FMACCT=ACCT;
      302     5319    3              ENT.PSN=DEVSN.SN;
      303     5320    3              ENT.SYSID=B$JIT.SYSID;
      304     5321    3              ENT.CODE=%AZ$PGRANS;
      305     5322    3              RETURN;
      306     5323    3              END;
      307     5324    2           CALL FLUSH;
      308     5325    2           GOTO RETRY;
      309     5326    2   END FINDENTRY;
      310     5327        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:13   
      311     5328        /**/
      312     5329        /*D*    NAME:    FLUSH
      313     5330        *       CALL:    CALL FLUSH ALTRET(LOC);
      314     5331        *       DESCRIPTION:  Flushes out all in-core accounting records.
      315     5332        */
      316     5333        /**/
      317     5334    1   FLUSH:  PROC ALTRET;
      318     5335        /**/
      319     5336    2           ENT$=DATA$;
      320     5337    3           DO I=1 TO NUMENT;
      321     5338    3              FPTWRENT.ENTRY_=VECTOR(ENT);
      322     5339    3              CALL M$WRSYSLOG(FPTWRENT) ALTRET(ERR);
      323     5340    3              ENT$=PINCRW(ENT$,SIZEW(ENT));
      324     5341    3              END;
      325     5342    2           AVAILSIZ=DATASIZ;
      326     5343    2           NUMENT=0;
      327     5344    2           RETURN;
      328     5345        /**/
      329     5346    2   ERR:    AVAILSIZ=DATASIZ;
      330     5347    2           NUMENT=0;
      331     5348    2           ALTRETURN;
      332     5349    2   END FLUSH;
      333     5350        /**/
      334     5351    1   END FGG$START;

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:14   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FGG$START.

   Procedure FGG$START requires 491 words for executable code.
   Procedure FGG$START requires 24 words of local(AUTO) storage.

    No errors detected in file FGG$GAC.:E05TSI    .

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:15   

 Object Unit name= FGG$START                                  File name= FGG$GAC.:E05TOU
 UTS= JUL 29 '97 15:24:36.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$GAC
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS      8     10  FGG$START
    3   Data  even  none  1194   2252  FGG$START
    4   Proc  even  none   491    753  FGG$START
    5  RoData even  none    11     13  FGG$START

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        2  FGG$START
     4    140          yes     yes      Std        0  FGG$DONE
     4    224          yes     yes      Std        0  FGG$QUIT
     4    231          yes     yes      Std        1  FGG$PROCESS_FIT
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:16   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XSF$LOCCODP
         yes           Std       4 FGH$UPDBUCKET
 yes     yes           Std       2 XSF$LOCCODE
 yes     yes           Std       2 XSF$LOCCODT
 yes     yes           Std       3 XUD$UTS_DIFF
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                M$GAC                                 M$UC
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:17   


        1        1        /*M*  FGG$GAC - Granule accounting */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* */
        8        8        /**/
        9        9        /**/
       10       10        /*P*    NAME:    FGG$GAC
       11       11        *       PURPOSE:  Write accounting records to charge for granule use  */
       12       12        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:18   
       13       13        /**/
       14       14        /*D*    NAME:     FGG$START
       15       15        *       CALL:     CALL FGG$START(DCB$,MODEFLG) ALTRET(LOC);
       16       16        *       INPUT:    DCB$ - Pointer to the DCB used to locate files
       17       17        *                 MODEFLG - > 0 if called by PIG during pack
       18       18        *                           mount for a pack that has shelf-time
       19       19        *                           accounting
       20       20        *       DESCRIPTION:
       21       21        *         Opens the GAC control file on the pack, and the accounting
       22       22        *       log.  Writes an initial record to the accounting log.
       23       23        */
       24       24        /**/
       25       25        /**/
       26       26        FGG$START: PROC(PDCB$,PMODEFLG) ALTRET;

     26  4 000000   000000 700200 xent  FGG$START    TSX0  ! X66_AUTO_2
         4 000001   000030 000002                    ZERO    24,2

       27       27        /* PARAMETERS */
       28       28    1   DCL PDCB$ PTR;
       29       29    1   DCL PMODEFLG UBIN;
       30       30        /* EXTERNAL DATA */
       31       31    1   DCL B$JIT$ PTR SYMREF;
       32       32    1   DCL B$TCB$ PTR SYMREF;
       33       33        /* DCBS */
       34       34    1   DCL M$GAC DCB;
       35       35        /* INCLUDE FILES */
       36       36        %INCLUDE AZ_MACRO_C;
       37     2623        %INCLUDE AZ_SUBS_C;
       38     2692        %INCLUDE B$JIT;
       39     2982        %INCLUDE B_ERRORS_C;
       40     4109        %INCLUDE CP_6;
       41     4190        %INCLUDE EL_SUBS_C;
       42     4274        %INCLUDE FM$FIT;
       43     4495        %INCLUDE XUD_UTS_M;
       44     4577        /* EXTERNAL ROUTINES */
       45     4578    1   DCL FGH$UPDBUCKET ENTRY(4);
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:19   
       46     4579    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
       47     4580    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       48     4581    1   DCL XSF$LOCCODT ENTRY(2) ALTRET;
       49     4582        %XUD$UTS_ENTRIES;
       50     4614        /* CONSTANT STORAGE */
       51     4615        %FM_FITCODE (NAME=FIT1CODE,CODE=1,NAW=2);
       52     4618        %VLP_ACCT (FPTN=ACCTZER,ACCT="BINASC(0)",STCLASS=CONSTANT);
       53     4631        /* STATIC STORAGE */
       54     4632    1   DCL DCB$ PTR STATIC;          /* Ptr to DCB used by caller to locate files    */
       55     4633    1   DCL MODEFLG SBIN STATIC; /* Non-zero if called by PIG for shelf-time acctg    */
       56     4634    1   DCL DATA$ PTR STATIC INIT(ADDR(DATAREA)); /* Ptr to data                      */
       57     4635    1   DCL DATAREA(0:1023) UBIN STATIC;        /* Data area to hold acctg recs       */
       58     4636    1   DCL DATASIZ UBIN STATIC;                /* # words of data space              */
       59     4637    1   DCL AVAILSIZ UBIN STATIC;               /* # words of data not used           */
       60     4638    1   DCL NUMENT UBIN STATIC;                 /* # entries in data                  */
       61     4639    1   DCL START_OK UBIN STATIC INIT(0);
       62     4640    1   DCL ACCT CHAR(8) STATIC;                /* Current account                    */
       63     4641    1   DCL THIS_GAC_START_TIME UBIN STATIC;    /* Time this GAC run started          */
       64     4642    1   DCL PREV_GAC_START_TIME UBIN STATIC;    /* Time prev GAC run started          */
       65     4643    1   DCL PREV_GAC_STOP_TIME  UBIN STATIC;    /* Time prev GAC run stopped          */
       66     4644        /* STATIC STRUCTURES */
       67     4645    1   DCL 1 GACCTL STATIC,
       68     4646    1         2 MOUNT_TIME UBIN,
       69     4647    1         2 DISMOUNT_TIME UBIN,
       70     4648    1         2 START_TIME UBIN,
       71     4649    1         2 STOP_TIME UBIN;
       72     4650    1   DCL 1 DEVSN STATIC,
       73     4651    1         2 * UBIN INIT(1),
       74     4652    1         2 SN CHAR(6);
       75     4653        %GACID(NAME=ID_REC,STCLASS=STATIC);
       76     4686        /* LOCAL AUTOMATIC STORAGE */
       77     4687    1   DCL TIME UBIN;
       78     4688    1   DCL FIT$ PTR;
       79     4689    1   DCL COD3$ PTR;
       80     4690    1   DCL COD4$ PTR;
       81     4691    1   DCL COD6$ PTR;
       82     4692    1   DCL NGRANS UBIN;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:20   
       83     4693    1   DCL CHARGTYP UBIN;
       84     4694    1   DCL OLDINTEGRAL UBIN;
       85     4695    1   DCL ENT$ PTR;
       86     4696    1   DCL I UBIN;
       87     4697        /* PRE-PROCESSOR VARIABLES */
       88     4698        /* FPTS */
       89     4699        %FPT_OPEN (FPTN=FPT_RDPAK,ACCT=ACCTZER,RES='DP',ASN=DEVICE,
       90     4700                   FUN=IN,FPARAM=DATAREA,SN=DEVSN,DCB=M$GAC);
       91     4809        %FPT_OPEN (FPTN=FPT_UPDPAK,ACCT=ACCTZER,RES='DP',ASN=DEVICE,
       92     4810                   FUN=UPDATE,IFPARAM=DATAREA,SN=DEVSN,DCB=M$GAC);
       93     4919        %FPT_TIME(SOURCE=CLOCK,DEST=UTS,TSTAMP=THIS_GAC_START_TIME);
       94     4938        %FPT_WRSYSLOG(FPTN=FPTWRID,ENTRY=ID_REC,SIZE="SIZEW(ID_REC)",
       95     4939                      FILENUM=2,TYPE=EL_ACCTLG);
       96     4954        %FPT_WRSYSLOG(FPTN=FPTWRENT,SIZE="SIZEW(ENT)",
       97     4955                      FILENUM=2,TYPE=EL_ACCTLG);
       98     4970        %B$TCB;
       99     4973        %B$ALT;
      100     4981        %F$DCB;
      101     5038        %FM$FIT (BASED="BASED(DATA$)");
      102     5041        %CODE03(BASED="BASED(COD3$)");
      103     5048        %CODE04(BASED="BASED(COD4$)");
      104     5056        %PGRANS(NAME=ENT,STCLASS="BASED(ENT$)");
      105     5122        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:21   
      106     5123        /**/
      107     5124    1           DCB$=PDCB$;                     /* Save parameters                    */

   5124  4 000002   200003 470500                    LDP0    @PDCB$,,AUTO
         4 000003   000000 236100                    LDQ     0,,PR0
         4 000004   000000 756000 3                  STQ     DCB$

      108     5125    1           MODEFLG=PMODEFLG;

   5125  4 000005   200004 471500                    LDP1    @PMODEFLG,,AUTO
         4 000006   100000 235100                    LDA     0,,PR1
         4 000007   000001 755000 3                  STA     MODEFLG

      109     5126        /**/
      110     5127    1           DATASIZ=SIZEW(DATAREA);

   5127  4 000010   002000 235007                    LDA     1024,DL
         4 000011   002003 755000 3                  STA     DATASIZ

      111     5128    1           AVAILSIZ=DATASIZ;

   5128  4 000012   002004 755000 3                  STA     AVAILSIZ

      112     5129    1           NUMENT=0;

   5129  4 000013   002005 450000 3                  STZ     NUMENT

      113     5130    1           START_OK=0;

   5130  4 000014   002006 450000 3                  STZ     START_OK

      114     5131        /**/
      115     5132    1           CALL M$TIME(FPT_TIME);

   5132  4 000015   002216 630400 3                  EPPR0   FPT_TIME
         4 000016   020004 713400                    CLIMB   8196
         4 000017   402000 401760                    pmme    nvectors=5
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:22   

      116     5133        /**/
      117     5134    1           DEVSN.SN=DCB$->F$DCB.PSN#;

   5134  4 000020   000000 470400 3                  LDP0    DCB$
         4 000021   040000 100500                    MLR     fill='040'O
         4 000022   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         4 000023   002021 000006 3                  ADSC9   DEVSN+1                  cn=0,n=6

      118     5135    1           IF DEVSN.SN='SYS' AND MODEFLG>0 THEN

   5135  4 000024   040000 106400                    CMPC    fill='040'O
         4 000025   002021 000006 3                  ADSC9   DEVSN+1                  cn=0,n=6
         4 000026   000003 000003 2                  ADSC9   ACCTZER+2                cn=0,n=3
         4 000027   000033 601000 4                  TNZ     s:5137
         4 000030   000001 235000 3                  LDA     MODEFLG
         4 000031   000033 604400 4                  TMOZ    s:5137

      119     5136    1              RETURN;                      /* Can't do SYS pack at mount time    */

   5136  4 000032   000000 702200 xent               TSX2  ! X66_ARET

      120     5137    1           CALL M$OPEN(FPT_RDPAK) ALTRET(ABORT); /* Get AD FIT                   */

   5137  4 000033   002032 630400 3                  EPPR0   FPT_RDPAK
         4 000034   450000 713400                    CLIMB   alt,open
         4 000035   410400 401760                    pmme    nvectors=18
         4 000036   000137 702000 4                  TSX2    ABORT

      121     5138    1           COD4$=DATA$;

   5138  4 000037   000002 236000 3                  LDQ     DATA$
         4 000040   200010 756100                    STQ     COD4$,,AUTO

      122     5139    1           CALL XSF$LOCCODP(COD4$,4) ALTRET(ABORT);

   5139  4 000041   000000 236000 5                  LDQ     0
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:23   
         4 000042   200025 756100                    STQ     I+7,,AUTO
         4 000043   200010 630500                    EPPR0   COD4$,,AUTO
         4 000044   200024 450500                    STP0    I+6,,AUTO
         4 000045   200024 630500                    EPPR0   I+6,,AUTO
         4 000046   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000047   000000 701000 xent               TSX1    XSF$LOCCODP
         4 000050   000137 702000 4                  TSX2    ABORT

      123     5140    1           GACCTL.STOP_TIME=CODE04.GAC.TIME;

   5140  4 000051   200010 470500                    LDP0    COD4$,,AUTO
         4 000052   000012 235100                    LDA     10,,PR0
         4 000053   002017 755000 3                  STA     GACCTL+3

      124     5141    1           GACCTL.START_TIME=CODE04.GAC.N;

   5141  4 000054   000011 235100                    LDA     9,,PR0
         4 000055   002016 755000 3                  STA     GACCTL+2

      125     5142    1           GACCTL.MOUNT_TIME=CODE04.ACCESS.TIME;

   5142  4 000056   000000 235100                    LDA     0,,PR0
         4 000057   002014 755000 3                  STA     GACCTL

      126     5143    1           GACCTL.DISMOUNT_TIME=CODE04.SVMODIFY.TIME;

   5143  4 000060   000010 235100                    LDA     8,,PR0
         4 000061   002015 755000 3                  STA     GACCTL+1

      127     5144        /**/
      128     5145        /* Make sure that mount/dismount and GAC times are consistent */
      129     5146        /**/
      130     5147    1           IF GACCTL.STOP_TIME>THIS_GAC_START_TIME THEN

   5147  4 000062   002011 236000 3                  LDQ     THIS_GAC_START_TIME
         4 000063   002017 116000 3                  CMPQ    GACCTL+3
         4 000064   000066 603000 4                  TRC     s:5149
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:24   

      131     5148    1              GACCTL.STOP_TIME=THIS_GAC_START_TIME;

   5148  4 000065   002017 756000 3                  STQ     GACCTL+3

      132     5149    1           IF GACCTL.STOP_TIME<GACCTL.START_TIME THEN

   5149  4 000066   002017 236000 3                  LDQ     GACCTL+3
         4 000067   002016 116000 3                  CMPQ    GACCTL+2
         4 000070   000072 603000 4                  TRC     s:5151

      133     5150    1              GACCTL.START_TIME=GACCTL.STOP_TIME;

   5150  4 000071   002016 756000 3                  STQ     GACCTL+2

      134     5151    1           IF GACCTL.DISMOUNT_TIME>THIS_GAC_START_TIME THEN

   5151  4 000072   002011 236000 3                  LDQ     THIS_GAC_START_TIME
         4 000073   002015 116000 3                  CMPQ    GACCTL+1
         4 000074   000076 603000 4                  TRC     s:5153

      135     5152    1              GACCTL.DISMOUNT_TIME=THIS_GAC_START_TIME;

   5152  4 000075   002015 756000 3                  STQ     GACCTL+1

      136     5153    1           IF GACCTL.DISMOUNT_TIME<GACCTL.MOUNT_TIME THEN

   5153  4 000076   002015 236000 3                  LDQ     GACCTL+1
         4 000077   002014 116000 3                  CMPQ    GACCTL
         4 000100   000102 603000 4                  TRC     s:5155

      137     5154    1              GACCTL.MOUNT_TIME=GACCTL.DISMOUNT_TIME;

   5154  4 000101   002014 756000 3                  STQ     GACCTL

      138     5155    1           PREV_GAC_START_TIME=GACCTL.START_TIME;

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:25   
   5155  4 000102   002016 235000 3                  LDA     GACCTL+2
         4 000103   002012 755000 3                  STA     PREV_GAC_START_TIME

      139     5156    1           PREV_GAC_STOP_TIME=GACCTL.STOP_TIME;

   5156  4 000104   002017 235000 3                  LDA     GACCTL+3
         4 000105   002013 755000 3                  STA     PREV_GAC_STOP_TIME

      140     5157        /**/
      141     5158    1           ID_REC='0'B;

   5158  4 000106   000000 100400                    MLR     fill='000'O
         4 000107   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000110   002023 000030 3                  ADSC9   ID_REC                   cn=0,n=24

      142     5159    1           ID_REC.ACCT=B$JIT.ACCN;

   5159  4 000111   000000 471400 xsym               LDP1    B$JIT$
         4 000112   040000 100500                    MLR     fill='040'O
         4 000113   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         4 000114   002024 000010 3                  ADSC9   ID_REC+1                 cn=0,n=8

      143     5160    1           ID_REC.UNAME=B$JIT.UNAME;

   5160  4 000115   040000 100500                    MLR     fill='040'O
         4 000116   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12
         4 000117   002026 000014 3                  ADSC9   ID_REC+3                 cn=0,n=12

      144     5161    1           ID_REC.SYSID=B$JIT.SYSID;

   5161  4 000120   100000 720100                    LXL0    0,,PR1
         4 000121   002023 440000 3                  SXL0    ID_REC

      145     5162    1           ID_REC.CODE=%AZ$GACID;

   5162  4 000122   004000 236003                    LDQ     2048,DU
         4 000123   002023 552040 3                  STBQ    ID_REC,'40'O
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:26   

      146     5163    1           CALL M$WRSYSLOG(FPTWRID) ALTRET(ABORT);

   5163  4 000124   002232 630400 3                  EPPR0   FPTWRID
         4 000125   470001 713400                    CLIMB   alt,+28673
         4 000126   400400 401760                    pmme    nvectors=2
         4 000127   000137 702000 4                  TSX2    ABORT

      147     5164        /**/
      148     5165    1           ACCT=BINASC(0);

   5165  4 000130   000001 235000 5                  LDA     1
         4 000131   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000132   002007 755000 3                  STA     ACCT
         4 000133   002010 756000 3                  STQ     ACCT+1

      149     5166        /**/
      150     5167    1           START_OK=1;

   5167  4 000134   000001 235007                    LDA     1,DL
         4 000135   002006 755000 3                  STA     START_OK

      151     5168        /**/
      152     5169    1           RETURN;

   5169  4 000136   000000 702200 xent               TSX2  ! X66_ARET

      153     5170        /**/
      154     5171    1   ABORT:  ALTRETURN;

   5171  4 000137   000000 702200 xent  ABORT        TSX2  ! X66_AALT

      155     5172        /**/
      156     5173        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:27   
      157     5174        /**/
      158     5175        /*D*    NAME:       FGG$DONE
      159     5176        *       CALL:       CALL FGG$DONE
      160     5177        *       DESCRIPTION:  Called to indicate successful completion of
      161     5178        *         a GAC run.  Closes files, updates control info on pack,
      162     5179        *         writes final accounting info.
      163     5180        */
      164     5181        /**/
      165     5182    1   FGG$DONE: ENTRY ALTRET;                 /* Doesn't ALTRET                     */

   5182  4 000140   000000 700200 xent  FGG$DONE     TSX0  ! X66_AUTO_2
         4 000141   000030 000002                    ZERO    24,2

      166     5183        /**/
      167     5184    1           IF START_OK=0 THEN

   5184  4 000142   002006 235000 3                  LDA     START_OK
         4 000143   000226 600000 4                  TZE     CLNUP

      168     5185    1              GOTO CLNUP;                  /* Never got going                    */
      169     5186    1           START_OK=0;

   5186  4 000144   002006 450000 3                  STZ     START_OK

      170     5187        /**/
      171     5188    1           CALL FLUSH;                     /* Flush out any remaining records    */

   5188  4 000145   000713 701000 4                  TSX1    FLUSH
         4 000146   000000 011000                    NOP     0

      172     5189        /**/
      173     5190    1           GACCTL.START_TIME=THIS_GAC_START_TIME;

   5190  4 000147   002011 235000 3                  LDA     THIS_GAC_START_TIME
         4 000150   002016 755000 3                  STA     GACCTL+2

      174     5191    1           CALL M$TIME(FPT_TIME);
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:28   

   5191  4 000151   002216 630400 3                  EPPR0   FPT_TIME
         4 000152   020004 713400                    CLIMB   8196
         4 000153   402000 401760                    pmme    nvectors=5

      175     5192    1           GACCTL.STOP_TIME=THIS_GAC_START_TIME;

   5192  4 000154   002011 235000 3                  LDA     THIS_GAC_START_TIME
         4 000155   002017 755000 3                  STA     GACCTL+3

      176     5193    1           CALL M$OPEN(FPT_RDPAK) ALTRET(CLNUP); /* Get AD FIT                   */

   5193  4 000156   002032 630400 3                  EPPR0   FPT_RDPAK
         4 000157   450000 713400                    CLIMB   alt,open
         4 000160   410400 401760                    pmme    nvectors=18
         4 000161   000226 702000 4                  TSX2    CLNUP

      177     5194    1           COD4$=DATA$;

   5194  4 000162   000002 236000 3                  LDQ     DATA$
         4 000163   200010 756100                    STQ     COD4$,,AUTO

      178     5195    1           I=4;

   5195  4 000164   000004 235007                    LDA     4,DL
         4 000165   200016 755100                    STA     I,,AUTO

      179     5196    1           CALL XSF$LOCCODE(COD4$,I) ALTRET(CLNUP);

   5196  4 000166   200016 630500                    EPPR0   I,,AUTO
         4 000167   200025 450500                    STP0    I+7,,AUTO
         4 000170   200010 631500                    EPPR1   COD4$,,AUTO
         4 000171   200024 451500                    STP1    I+6,,AUTO
         4 000172   200024 630500                    EPPR0   I+6,,AUTO
         4 000173   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000174   000000 701000 xent               TSX1    XSF$LOCCODE
         4 000175   000226 702000 4                  TSX2    CLNUP
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:29   

      180     5197    1           FM$FIT.CODES(0)=FIT1CODE;       /* Make code 4 the only one           */

   5197  4 000176   000000 236000 2                  LDQ     FIT1CODE
         4 000177   000002 470400 3                  LDP0    DATA$
         4 000200   000000 756100                    STQ     0,,PR0

      181     5198    1           FM$FIT.CODES(1)=FM$FIT.CODES(I);

   5198  4 000201   200016 720100                    LXL0    I,,AUTO
         4 000202   000000 236110                    LDQ     0,X0,PR0
         4 000203   000001 756100                    STQ     1,,PR0

      182     5199    1           CODE04.GAC.TIME=GACCTL.STOP_TIME;

   5199  4 000204   200010 471500                    LDP1    COD4$,,AUTO
         4 000205   002017 235000 3                  LDA     GACCTL+3
         4 000206   100012 755100                    STA     10,,PR1

      183     5200    1           CODE04.GAC.N=GACCTL.START_TIME;

   5200  4 000207   002016 236000 3                  LDQ     GACCTL+2
         4 000210   100011 756100                    STQ     9,,PR1

      184     5201    1           CALL M$OPEN(FPT_UPDPAK) ALTRET(CLNUP);

   5201  4 000211   002124 630400 3                  EPPR0   FPT_UPDPAK
         4 000212   450000 713400                    CLIMB   alt,open
         4 000213   410400 401760                    pmme    nvectors=18
         4 000214   000226 702000 4                  TSX2    CLNUP

      185     5202    1   DONE2:  ID_REC.FLAG='1'B;

   5202  4 000215   000400 236003       DONE2        LDQ     256,DU
         4 000216   002023 256000 3                  ORSQ    ID_REC

      186     5203    1           CALL M$WRSYSLOG(FPTWRID) ALTRET(DONE3);
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:30   

   5203  4 000217   002232 630400 3                  EPPR0   FPTWRID
         4 000220   470001 713400                    CLIMB   alt,+28673
         4 000221   400400 401760                    pmme    nvectors=2
         4 000222   000223 702000 4                  TSX2    DONE3

   5200  4 000223   000226 710000 4     DONE3        TRA     CLNUP

      187     5204    1   DONE3:  ;
      188     5205        /**/
      189     5206    1   FGG$QUIT: ENTRY ALTRET;                 /* Doesn't ALTRET                     */

   5206  4 000224   000000 700200 xent  FGG$QUIT     TSX0  ! X66_AUTO_2
         4 000225   000030 000002                    ZERO    24,2

      190     5207        /**/
      191     5208    1   CLNUP:  START_OK=0;

   5208  4 000226   002006 450000 3     CLNUP        STZ     START_OK

      192     5209    1           NUMENT=0;

   5209  4 000227   002005 450000 3                  STZ     NUMENT

      193     5210    1   QUIT2:  RETURN;

   5210  4 000230   000000 702200 xent  QUIT2        TSX2  ! X66_ARET

      194     5211        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:31   
      195     5212        /**/
      196     5213        /*D*    NAME:       FGG$PROCESS_FIT
      197     5214        *       CALL:       CALL FGG$PROCESS_FIT(FIT$) ALTRET(LOC);
      198     5215        *       INPUT:      FIT$ - Ptr to FIT
      199     5216        *       DESCRIPTION:
      200     5217        *         Creates appropriate accounting info for this file
      201     5218        */
      202     5219        /**/
      203     5220    1   FGG$PROCESS_FIT: ENTRY(PDCB$) ALTRET;

   5220  4 000231   000000 700200 xent  FGG$PROCESS* TSX0  ! X66_AUTO_2
         4 000232   000030 000002                    ZERO    24,2

      204     5221        /**/
      205     5222    1           IF START_OK=0 THEN

   5222  4 000233   002006 235000 3                  LDA     START_OK
         4 000234   000236 601000 4                  TNZ     s:5224

      206     5223    1              RETURN;                      /* Never got started                  */

   5223  4 000235   000000 702200 xent               TSX2  ! X66_ARET

      207     5224    1           FIT$=PDCB$;

   5224  4 000236   200003 470500                    LDP0    @PDCB$,,AUTO
         4 000237   000000 236100                    LDQ     0,,PR0
         4 000240   200006 756100                    STQ     FIT$,,AUTO

      208     5225    2           IF DCB$->F$DCB.ACCT#~=ACCT THEN DO; /* Account has changed            */

   5225  4 000241   000000 471400 3                  LDP1    DCB$
         4 000242   040000 106500                    CMPC    fill='040'O
         4 000243   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         4 000244   002007 000010 3                  ADSC9   ACCT                     cn=0,n=8
         4 000245   000254 600000 4                  TZE     s:5230

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:32   
      209     5226    2              CALL FLUSH;             /* Get rid of any current acctg records    */

   5226  4 000246   000713 701000 4                  TSX1    FLUSH
         4 000247   000000 011000                    NOP     0

      210     5227    2              ACCT=DCB$->F$DCB.ACCT#;

   5227  4 000250   000000 470400 3                  LDP0    DCB$
         4 000251   000020 237100                    LDAQ    16,,PR0
         4 000252   002007 755000 3                  STA     ACCT
         4 000253   002010 756000 3                  STQ     ACCT+1

      211     5228    2              END;

      212     5229        /**/
      213     5230    1           IF DEVSN.SN='SYS' AND (ACCT=':SYMI' OR ACCT=':SYMO') THEN

   5230  4 000254   040000 106400                    CMPC    fill='040'O
         4 000255   002021 000006 3                  ADSC9   DEVSN+1                  cn=0,n=6
         4 000256   000003 000003 2                  ADSC9   ACCTZER+2                cn=0,n=3
         4 000257   000271 601000 4                  TNZ     s:5233
         4 000260   040000 106400                    CMPC    fill='040'O
         4 000261   002007 000010 3                  ADSC9   ACCT                     cn=0,n=8
         4 000262   000004 000005 2                  ADSC9   ACCTZER+3                cn=0,n=5
         4 000263   000270 600000 4                  TZE     s:5231
         4 000264   040000 106400                    CMPC    fill='040'O
         4 000265   002007 000010 3                  ADSC9   ACCT                     cn=0,n=8
         4 000266   000006 000005 2                  ADSC9   ACCTZER+5                cn=0,n=5
         4 000267   000271 601000 4                  TNZ     s:5233

      214     5231    1              RETURN;                      /* Ignore symbiont accounts           */

   5231  4 000270   000000 702200 xent               TSX2  ! X66_ARET

      215     5232        /**/
      216     5233    1           COD4$=FIT$;

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:33   
   5233  4 000271   200006 236100                    LDQ     FIT$,,AUTO
         4 000272   200010 756100                    STQ     COD4$,,AUTO

      217     5234    1           CALL XSF$LOCCODP(COD4$,4) ALTRET(RET);

   5234  4 000273   000000 236000 5                  LDQ     0
         4 000274   200025 756100                    STQ     I+7,,AUTO
         4 000275   200010 630500                    EPPR0   COD4$,,AUTO
         4 000276   200024 450500                    STP0    I+6,,AUTO
         4 000277   200024 630500                    EPPR0   I+6,,AUTO
         4 000300   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000301   000000 701000 xent               TSX1    XSF$LOCCODP
         4 000302   000614 702000 4                  TSX2    RET

      218     5235    1           COD3$=FIT$;

   5235  4 000303   200006 236100                    LDQ     FIT$,,AUTO
         4 000304   200007 756100                    STQ     COD3$,,AUTO

      219     5236    1           CALL XSF$LOCCODP(COD3$,3) ALTRET(RET);

   5236  4 000305   000002 236000 5                  LDQ     2
         4 000306   200025 756100                    STQ     I+7,,AUTO
         4 000307   200007 630500                    EPPR0   COD3$,,AUTO
         4 000310   200024 450500                    STP0    I+6,,AUTO
         4 000311   200024 630500                    EPPR0   I+6,,AUTO
         4 000312   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000313   000000 701000 xent               TSX1    XSF$LOCCODP
         4 000314   000614 702000 4                  TSX2    RET

      220     5237    1           NGRANS=CODE03.UGRANS+CODE03.NGAVAL;

   5237  4 000315   200007 470500                    LDP0    COD3$,,AUTO
         4 000316   000003 236100                    LDQ     3,,PR0
         4 000317   000032 376000 xsym               ANQ     B_VECTNIL+26
         4 000320   200024 756100                    STQ     I+6,,AUTO
         4 000321   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:34   
         4 000322   000032 376000 xsym               ANQ     B_VECTNIL+26
         4 000323   200024 036100                    ADLQ    I+6,,AUTO
         4 000324   200012 756100                    STQ     NGRANS,,AUTO

      221     5238    1           IF CODE03.DESC.BUPM THEN

   5238  4 000325   000001 236100                    LDQ     1,,PR0
         4 000326   000400 316003                    CANQ    256,DU
         4 000327   000332 600000 4                  TZE     s:5241

      222     5239    1              CHARGTYP=%AZ$GACBACKUP;

   5239  4 000330   200013 450100                    STZ     CHARGTYP,,AUTO
         4 000331   000334 710000 4                  TRA     s:5242

      223     5240    1           ELSE
      224     5241    1              CHARGTYP=%AZ$GACNOBACKUP;

   5241  4 000332   000001 235007                    LDA     1,DL
         4 000333   200013 755100                    STA     CHARGTYP,,AUTO

      225     5242    1           COD6$=FIT$;

   5242  4 000334   200006 236100                    LDQ     FIT$,,AUTO
         4 000335   200011 756100                    STQ     COD6$,,AUTO

      226     5243    1           CALL XSF$LOCCODT(COD6$,6) ALTRET(NOTSTOW);

   5243  4 000336   000003 236000 5                  LDQ     3
         4 000337   200025 756100                    STQ     I+7,,AUTO
         4 000340   200011 631500                    EPPR1   COD6$,,AUTO
         4 000341   200024 451500                    STP1    I+6,,AUTO
         4 000342   200024 630500                    EPPR0   I+6,,AUTO
         4 000343   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000344   000000 701000 xent               TSX1    XSF$LOCCODT
         4 000345   000350 702000 4                  TSX2    NOTSTOW

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:35   
      227     5244    1           CHARGTYP=%AZ$GACSTOWACT;

   5244  4 000346   000002 235007                    LDA     2,DL
         4 000347   200013 755100                    STA     CHARGTYP,,AUTO

      228     5245        /**/
      229     5246    1   NOTSTOW: CALL FINDENTRY ALTRET(RET);

   5246  4 000350   000615 701000 4     NOTSTOW      TSX1    FINDENTRY
         4 000351   000614 702000 4                  TSX2    RET

      230     5247        /**/
      231     5248    1           IF MODEFLG>0 AND CODE04.GAC.TIME<GACCTL.DISMOUNT_TIME AND

   5248  4 000352   000001 235000 3                  LDA     MODEFLG
         4 000353   000513 604400 4                  TMOZ    s:5273
         4 000354   200010 470500                    LDP0    COD4$,,AUTO
         4 000355   000012 236100                    LDQ     10,,PR0
         4 000356   002015 116000 3                  CMPQ    GACCTL+1
         4 000357   000513 603000 4                  TRC     s:5273
         4 000360   002012 236000 3                  LDQ     PREV_GAC_START_TIME
         4 000361   002015 116000 3                  CMPQ    GACCTL+1
         4 000362   000513 603000 4                  TRC     s:5273

      232     5249    2             PREV_GAC_START_TIME<GACCTL.DISMOUNT_TIME THEN DO;

      233     5250    3              IF CODE04.GAC.TIME<PREV_GAC_START_TIME THEN DO;

   5250  4 000363   000012 116100                    CMPQ    10,,PR0
         4 000364   000402 602000 4                  TNC     s:5255
         4 000365   000402 600000 4                  TZE     s:5255

      234     5251    3                 CALL XUD$UTS_DIFF(TIME,GACCTL.DISMOUNT_TIME,PREV_GAC_START_TIME);

   5251  4 000366   000004 236000 5                  LDQ     4
         4 000367   200026 756100                    STQ     I+8,,AUTO
         4 000370   000005 236000 5                  LDQ     5
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:36   
         4 000371   200025 756100                    STQ     I+7,,AUTO
         4 000372   200005 631500                    EPPR1   TIME,,AUTO
         4 000373   200024 451500                    STP1    I+6,,AUTO
         4 000374   200024 630500                    EPPR0   I+6,,AUTO
         4 000375   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000376   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000377   000000 011000                    NOP     0

      235     5252    3                 OLDINTEGRAL=0;

   5252  4 000400   200014 450100                    STZ     OLDINTEGRAL,,AUTO

      236     5253    3                 END;

   5253  4 000401   000437 710000 4                  TRA     s:5264

      237     5254    2              ELSE
      238     5255    3                 IF CODE04.GAC.TIME<PREV_GAC_STOP_TIME THEN DO;

   5255  4 000402   000012 236100                    LDQ     10,,PR0
         4 000403   002013 116000 3                  CMPQ    PREV_GAC_STOP_TIME
         4 000404   000421 603000 4                  TRC     s:5260

      239     5256    3                    CALL XUD$UTS_DIFF(TIME,GACCTL.DISMOUNT_TIME,PREV_GAC_STOP_TIME);

   5256  4 000405   000006 236000 5                  LDQ     6
         4 000406   200026 756100                    STQ     I+8,,AUTO
         4 000407   000005 236000 5                  LDQ     5
         4 000410   200025 756100                    STQ     I+7,,AUTO
         4 000411   200005 631500                    EPPR1   TIME,,AUTO
         4 000412   200024 451500                    STP1    I+6,,AUTO
         4 000413   200024 630500                    EPPR0   I+6,,AUTO
         4 000414   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000415   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000416   000000 011000                    NOP     0

      240     5257    3                    OLDINTEGRAL=0;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:37   

   5257  4 000417   200014 450100                    STZ     OLDINTEGRAL,,AUTO

      241     5258    3                    END;

   5258  4 000420   000437 710000 4                  TRA     s:5264

      242     5259    3                 ELSE DO;

      243     5260    3                    CALL XUD$UTS_DIFF(TIME,GACCTL.DISMOUNT_TIME,CODE04.GAC.TIME);

   5260  4 000421   200010 236100                    LDQ     COD4$,,AUTO
         4 000422   000012 036003                    ADLQ    10,DU
         4 000423   200026 756100                    STQ     I+8,,AUTO
         4 000424   000005 236000 5                  LDQ     5
         4 000425   200025 756100                    STQ     I+7,,AUTO
         4 000426   200005 631500                    EPPR1   TIME,,AUTO
         4 000427   200024 451500                    STP1    I+6,,AUTO
         4 000430   200024 630500                    EPPR0   I+6,,AUTO
         4 000431   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000432   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000433   000000 011000                    NOP     0

      244     5261    3                    OLDINTEGRAL=CODE04.GAC.N;

   5261  4 000434   200010 470500                    LDP0    COD4$,,AUTO
         4 000435   000011 235100                    LDA     9,,PR0
         4 000436   200014 755100                    STA     OLDINTEGRAL,,AUTO

      245     5262    3                    END;

      246     5263                                           /* Account for time up to last dismount    */
      247     5264    2              CALL FGH$UPDBUCKET(ENT.ONLINE(CHARGTYP),OLDINTEGRAL,

   5264  4 000437   200012 630500                    EPPR0   NGRANS,,AUTO
         4 000440   200027 450500                    STP0    I+9,,AUTO
         4 000441   200005 631500                    EPPR1   TIME,,AUTO
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:38   
         4 000442   200026 451500                    STP1    I+8,,AUTO
         4 000443   200014 633500                    EPPR3   OLDINTEGRAL,,AUTO
         4 000444   200025 453500                    STP3    I+7,,AUTO
         4 000445   200013 236100                    LDQ     CHARGTYP,,AUTO
         4 000446   000022 736000                    QLS     18
         4 000447   000015 036003                    ADLQ    13,DU
         4 000450   200015 036100                    ADLQ    ENT$,,AUTO
         4 000451   200024 756100                    STQ     I+6,,AUTO
         4 000452   200024 630500                    EPPR0   I+6,,AUTO
         4 000453   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000454   000000 701000 xent               TSX1    FGH$UPDBUCKET
         4 000455   000000 011000                    NOP     0

      248     5265    2                TIME,NGRANS);
      249     5266        /**/
      250     5267    2              CALL XUD$UTS_DIFF(TIME,GACCTL.MOUNT_TIME,GACCTL.DISMOUNT_TIME);

   5267  4 000456   000005 236000 5                  LDQ     5
         4 000457   200026 756100                    STQ     I+8,,AUTO
         4 000460   000007 236000 5                  LDQ     7
         4 000461   200025 756100                    STQ     I+7,,AUTO
         4 000462   200005 630500                    EPPR0   TIME,,AUTO
         4 000463   200024 450500                    STP0    I+6,,AUTO
         4 000464   200024 630500                    EPPR0   I+6,,AUTO
         4 000465   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000466   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000467   000000 011000                    NOP     0

      251     5268    2              CALL FGH$UPDBUCKET(ENT.SHELF(CHARGTYP),0,TIME,NGRANS);

   5268  4 000470   200012 630500                    EPPR0   NGRANS,,AUTO
         4 000471   200027 450500                    STP0    I+9,,AUTO
         4 000472   200005 631500                    EPPR1   TIME,,AUTO
         4 000473   200026 451500                    STP1    I+8,,AUTO
         4 000474   000010 236000 5                  LDQ     8
         4 000475   200025 756100                    STQ     I+7,,AUTO
         4 000476   200013 236100                    LDQ     CHARGTYP,,AUTO
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:39   
         4 000477   000022 736000                    QLS     18
         4 000500   000012 036003                    ADLQ    10,DU
         4 000501   200015 036100                    ADLQ    ENT$,,AUTO
         4 000502   200024 756100                    STQ     I+6,,AUTO
         4 000503   200024 630500                    EPPR0   I+6,,AUTO
         4 000504   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000505   000000 701000 xent               TSX1    FGH$UPDBUCKET
         4 000506   000000 011000                    NOP     0

      252     5269    2              CODE04.GAC.TIME=GACCTL.MOUNT_TIME;

   5269  4 000507   200010 470500                    LDP0    COD4$,,AUTO
         4 000510   002014 235000 3                  LDA     GACCTL
         4 000511   000012 755100                    STA     10,,PR0

      253     5270    2              CODE04.GAC.N=0;

   5270  4 000512   000011 450100                    STZ     9,,PR0

      254     5271    2              END;

      255     5272        /**/
      256     5273    2           IF CODE04.GAC.TIME<PREV_GAC_START_TIME THEN DO;

   5273  4 000513   200010 470500                    LDP0    COD4$,,AUTO
         4 000514   000012 236100                    LDQ     10,,PR0
         4 000515   002012 116000 3                  CMPQ    PREV_GAC_START_TIME
         4 000516   000533 603000 4                  TRC     s:5278

      257     5274    2              CALL XUD$UTS_DIFF(TIME,THIS_GAC_START_TIME,PREV_GAC_START_TIME);

   5274  4 000517   000004 236000 5                  LDQ     4
         4 000520   200026 756100                    STQ     I+8,,AUTO
         4 000521   000011 236000 5                  LDQ     9
         4 000522   200025 756100                    STQ     I+7,,AUTO
         4 000523   200005 631500                    EPPR1   TIME,,AUTO
         4 000524   200024 451500                    STP1    I+6,,AUTO
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:40   
         4 000525   200024 630500                    EPPR0   I+6,,AUTO
         4 000526   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000527   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000530   000000 011000                    NOP     0

      258     5275    2              OLDINTEGRAL=0;

   5275  4 000531   200014 450100                    STZ     OLDINTEGRAL,,AUTO

      259     5276    2              GOTO COMP;

   5276  4 000532   000575 710000 4                  TRA     COMP

      260     5277    2              END;
      261     5278    2           IF CODE04.GAC.TIME<PREV_GAC_STOP_TIME THEN DO;

   5278  4 000533   002013 116000 3                  CMPQ    PREV_GAC_STOP_TIME
         4 000534   000551 603000 4                  TRC     s:5283

      262     5279    2              CALL XUD$UTS_DIFF(TIME,THIS_GAC_START_TIME,PREV_GAC_STOP_TIME);

   5279  4 000535   000006 236000 5                  LDQ     6
         4 000536   200026 756100                    STQ     I+8,,AUTO
         4 000537   000011 236000 5                  LDQ     9
         4 000540   200025 756100                    STQ     I+7,,AUTO
         4 000541   200005 631500                    EPPR1   TIME,,AUTO
         4 000542   200024 451500                    STP1    I+6,,AUTO
         4 000543   200024 630500                    EPPR0   I+6,,AUTO
         4 000544   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000545   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000546   000000 011000                    NOP     0

      263     5280    2              OLDINTEGRAL=0;

   5280  4 000547   200014 450100                    STZ     OLDINTEGRAL,,AUTO

      264     5281    2              GOTO COMP;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:41   

   5281  4 000550   000575 710000 4                  TRA     COMP

      265     5282    2              END;
      266     5283    2           IF CODE04.GAC.TIME<THIS_GAC_START_TIME THEN DO;

   5283  4 000551   002011 116000 3                  CMPQ    THIS_GAC_START_TIME
         4 000552   000572 603000 4                  TRC     s:5288

      267     5284    2              CALL XUD$UTS_DIFF(TIME,THIS_GAC_START_TIME,CODE04.GAC.TIME);

   5284  4 000553   200010 236100                    LDQ     COD4$,,AUTO
         4 000554   000012 036003                    ADLQ    10,DU
         4 000555   200026 756100                    STQ     I+8,,AUTO
         4 000556   000011 236000 5                  LDQ     9
         4 000557   200025 756100                    STQ     I+7,,AUTO
         4 000560   200005 631500                    EPPR1   TIME,,AUTO
         4 000561   200024 451500                    STP1    I+6,,AUTO
         4 000562   200024 630500                    EPPR0   I+6,,AUTO
         4 000563   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000564   000000 701000 xent               TSX1    XUD$UTS_DIFF
         4 000565   000000 011000                    NOP     0

      268     5285    2              OLDINTEGRAL=CODE04.GAC.N;

   5285  4 000566   200010 470500                    LDP0    COD4$,,AUTO
         4 000567   000011 235100                    LDA     9,,PR0
         4 000570   200014 755100                    STA     OLDINTEGRAL,,AUTO

      269     5286    2              GOTO COMP;

   5286  4 000571   000575 710000 4                  TRA     COMP

      270     5287    2              END;
      271     5288    1           TIME=0;

   5288  4 000572   200005 450100                    STZ     TIME,,AUTO
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:42   

      272     5289    1           OLDINTEGRAL=CODE04.GAC.N;

   5289  4 000573   000011 235100                    LDA     9,,PR0
         4 000574   200014 755100                    STA     OLDINTEGRAL,,AUTO

      273     5290    1   COMP:   CALL FGH$UPDBUCKET(ENT.ONLINE(CHARGTYP),OLDINTEGRAL,

   5290  4 000575   200012 630500       COMP         EPPR0   NGRANS,,AUTO
         4 000576   200027 450500                    STP0    I+9,,AUTO
         4 000577   200005 631500                    EPPR1   TIME,,AUTO
         4 000600   200026 451500                    STP1    I+8,,AUTO
         4 000601   200014 633500                    EPPR3   OLDINTEGRAL,,AUTO
         4 000602   200025 453500                    STP3    I+7,,AUTO
         4 000603   200013 236100                    LDQ     CHARGTYP,,AUTO
         4 000604   000022 736000                    QLS     18
         4 000605   000015 036003                    ADLQ    13,DU
         4 000606   200015 036100                    ADLQ    ENT$,,AUTO
         4 000607   200024 756100                    STQ     I+6,,AUTO
         4 000610   200024 630500                    EPPR0   I+6,,AUTO
         4 000611   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000612   000000 701000 xent               TSX1    FGH$UPDBUCKET
         4 000613   000000 011000                    NOP     0

      274     5291    1             TIME,NGRANS);
      275     5292    1   RET:    RETURN;

   5292  4 000614   000000 702200 xent  RET          TSX2  ! X66_ARET

      276     5293        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:43   
      277     5294        /**/
      278     5295        /*D*    NAME:     FINDENTRY
      279     5296        *       CALL:     CALL FINDENTRY ALTRET(LOC);
      280     5297        *       DESCRIPTION:  Searches the in-core accounting log entries
      281     5298        *         to see if there is already one present for the creator
      282     5299        *         of this file.  If so, returns with that entry.  If not,
      283     5300        *         one is built, flushing out old ones if necessary to
      284     5301        *         make room.
      285     5302        */
      286     5303        /**/
      287     5304    1   FINDENTRY: PROC ALTRET;

   5304  4 000615   200020 741300       FINDENTRY    STX1  ! I+2,,AUTO

      288     5305        /**/
      289     5306    2   RETRY:  ENT$=DATA$;

   5306  4 000616   000002 236000 3     RETRY        LDQ     DATA$
         4 000617   200015 756100                    STQ     ENT$,,AUTO

      290     5307    3           DO I=1 TO NUMENT;

   5307  4 000620   000001 235007                    LDA     1,DL
         4 000621   200016 755100                    STA     I,,AUTO
         4 000622   000645 710000 4                  TRA     s:5311+3

      291     5308    3              IF ENT.CREATOR=CODE04.CREATOR AND ENT.FMACCT=ACCT THEN

   5308  4 000623   200015 470500                    LDP0    ENT$,,AUTO
         4 000624   200010 471500                    LDP1    COD4$,,AUTO
         4 000625   000100 106500                    CMPC    fill='000'O
         4 000626   000001 000024                    ADSC9   1,,PR0                   cn=0,n=20
         4 000627   100003 000024                    ADSC9   3,,PR1                   cn=0,n=20
         4 000630   000637 601000 4                  TNZ     s:5310
         4 000631   040000 106500                    CMPC    fill='040'O
         4 000632   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         4 000633   002007 000010 3                  ADSC9   ACCT                     cn=0,n=8
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:44   
         4 000634   000637 601000 4                  TNZ     s:5310

      292     5309    3                 RETURN;

   5309  4 000635   200020 221300                    LDX1  ! I+2,,AUTO
         4 000636   000001 702211                    TSX2  ! 1,X1

      293     5310    3              ENT$=PINCRW(ENT$,SIZEW(ENT));

   5310  4 000637   200015 236100                    LDQ     ENT$,,AUTO
         4 000640   000020 036003                    ADLQ    16,DU
         4 000641   200015 756100                    STQ     ENT$,,AUTO

      294     5311    3              END;

   5311  4 000642   200016 235100                    LDA     I,,AUTO
         4 000643   000001 035007                    ADLA    1,DL
         4 000644   200016 755100                    STA     I,,AUTO
         4 000645   002005 236000 3                  LDQ     NUMENT
         4 000646   200016 116100                    CMPQ    I,,AUTO
         4 000647   000623 603000 4                  TRC     s:5308

      295     5312    3           IF AVAILSIZ>=SIZEW(ENT) THEN DO;

   5312  4 000650   002004 235000 3                  LDA     AVAILSIZ
         4 000651   000020 115007                    CMPA    16,DL
         4 000652   000710 602000 4                  TNC     s:5324

      296     5313    3              AVAILSIZ=AVAILSIZ-SIZEW(ENT);

   5313  4 000653   000020 135007                    SBLA    16,DL
         4 000654   002004 755000 3                  STA     AVAILSIZ

      297     5314    3              ENT$=PINCRW(DATA$,NUMENT*SIZEW(ENT));

   5314  4 000655   000026 736000                    QLS     22
         4 000656   000002 036000 3                  ADLQ    DATA$
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:45   
         4 000657   200015 756100                    STQ     ENT$,,AUTO

      298     5315    3              NUMENT=NUMENT+1;

   5315  4 000660   002005 235000 3                  LDA     NUMENT
         4 000661   000001 035007                    ADLA    1,DL
         4 000662   002005 755000 3                  STA     NUMENT

      299     5316    3              ENT='0'B;

   5316  4 000663   200015 470500                    LDP0    ENT$,,AUTO
         4 000664   000100 100400                    MLR     fill='000'O
         4 000665   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000666   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64

      300     5317    3              ENT.CREATOR=CODE04.CREATOR;

   5317  4 000667   200010 471500                    LDP1    COD4$,,AUTO
         4 000670   000100 100500                    MLR     fill='000'O
         4 000671   100003 000024                    ADSC9   3,,PR1                   cn=0,n=20
         4 000672   000001 000024                    ADSC9   1,,PR0                   cn=0,n=20

      301     5318    3              ENT.FMACCT=ACCT;

   5318  4 000673   040100 100400                    MLR     fill='040'O
         4 000674   002007 000010 3                  ADSC9   ACCT                     cn=0,n=8
         4 000675   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8

      302     5319    3              ENT.PSN=DEVSN.SN;

   5319  4 000676   040100 100400                    MLR     fill='040'O
         4 000677   002021 000006 3                  ADSC9   DEVSN+1                  cn=0,n=6
         4 000700   000010 000006                    ADSC9   8,,PR0                   cn=0,n=6

      303     5320    3              ENT.SYSID=B$JIT.SYSID;

   5320  4 000701   000000 471400 xsym               LDP1    B$JIT$
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:46   
         4 000702   100000 720100                    LXL0    0,,PR1
         4 000703   000000 440100                    SXL0    0,,PR0

      304     5321    3              ENT.CODE=%AZ$PGRANS;

   5321  4 000704   002000 236003                    LDQ     1024,DU
         4 000705   000000 552140                    STBQ    0,'40'O,PR0

      305     5322    3              RETURN;

   5322  4 000706   200020 221300                    LDX1  ! I+2,,AUTO
         4 000707   000001 702211                    TSX2  ! 1,X1

      306     5323    3              END;
      307     5324    2           CALL FLUSH;

   5324  4 000710   000713 701000 4                  TSX1    FLUSH
         4 000711   000000 011000                    NOP     0

      308     5325    2           GOTO RETRY;

   5325  4 000712   000616 710000 4                  TRA     RETRY

      309     5326    2   END FINDENTRY;
      310     5327        %EJECT;
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:47   
      311     5328        /**/
      312     5329        /*D*    NAME:    FLUSH
      313     5330        *       CALL:    CALL FLUSH ALTRET(LOC);
      314     5331        *       DESCRIPTION:  Flushes out all in-core accounting records.
      315     5332        */
      316     5333        /**/
      317     5334    1   FLUSH:  PROC ALTRET;

   5334  4 000713   200022 741300       FLUSH        STX1  ! I+4,,AUTO

      318     5335        /**/
      319     5336    2           ENT$=DATA$;

   5336  4 000714   000002 236000 3                  LDQ     DATA$
         4 000715   200015 756100                    STQ     ENT$,,AUTO

      320     5337    3           DO I=1 TO NUMENT;

   5337  4 000716   000001 235007                    LDA     1,DL
         4 000717   200016 755100                    STA     I,,AUTO
         4 000720   000736 710000 4                  TRA     s:5341+3

      321     5338    3              FPTWRENT.ENTRY_=VECTOR(ENT);

   5338  4 000721   000012 235000 5                  LDA     10
         4 000722   200015 236100                    LDQ     ENT$,,AUTO
         4 000723   002244 757000 3                  STAQ    FPTWRENT+2

      322     5339    3              CALL M$WRSYSLOG(FPTWRENT) ALTRET(ERR);

   5339  4 000724   002242 630400 3                  EPPR0   FPTWRENT
         4 000725   470001 713400                    CLIMB   alt,+28673
         4 000726   400400 401760                    pmme    nvectors=2
         4 000727   000746 702000 4                  TSX2    ERR

      323     5340    3              ENT$=PINCRW(ENT$,SIZEW(ENT));

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:48   
   5340  4 000730   200015 236100                    LDQ     ENT$,,AUTO
         4 000731   000020 036003                    ADLQ    16,DU
         4 000732   200015 756100                    STQ     ENT$,,AUTO

      324     5341    3              END;

   5341  4 000733   200016 235100                    LDA     I,,AUTO
         4 000734   000001 035007                    ADLA    1,DL
         4 000735   200016 755100                    STA     I,,AUTO
         4 000736   002005 236000 3                  LDQ     NUMENT
         4 000737   200016 116100                    CMPQ    I,,AUTO
         4 000740   000721 603000 4                  TRC     s:5338

      325     5342    2           AVAILSIZ=DATASIZ;

   5342  4 000741   002003 235000 3                  LDA     DATASIZ
         4 000742   002004 755000 3                  STA     AVAILSIZ

      326     5343    2           NUMENT=0;

   5343  4 000743   002005 450000 3                  STZ     NUMENT

      327     5344    2           RETURN;

   5344  4 000744   200022 221300                    LDX1  ! I+4,,AUTO
         4 000745   000001 702211                    TSX2  ! 1,X1

      328     5345        /**/
      329     5346    2   ERR:    AVAILSIZ=DATASIZ;

   5346  4 000746   002003 235000 3     ERR          LDA     DATASIZ
         4 000747   002004 755000 3                  STA     AVAILSIZ

      330     5347    2           NUMENT=0;

   5347  4 000750   002005 450000 3                  STZ     NUMENT

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:49   
      331     5348    2           ALTRETURN;

   5348  4 000751   200022 221300                    LDX1  ! I+4,,AUTO
         4 000752   000000 702211                    TSX2  ! 0,X1
      332     5349    2   END FLUSH;
      333     5350        /**/
      334     5351    1   END FGG$START;

PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:50   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FGG$START.
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:51   

 **** Variables and constants ****

  ****  Section 002 RoData FGG$START

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c STRC(72)    r     1 ACCTZER                    0-0-0/b STRC        r     1 FIT1CODE

  ****  Section 003  Data  FGG$START

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  2007-0-0/c CHAR(8)     r     1 ACCT                    2004-0-0/w UBIN        r     1 AVAILSIZ
     2-0-0/w PTR         r     1 DATA$                      3-0-0/w UBIN        r     1 DATAREA(0:1023)
  2003-0-0/w UBIN        r     1 DATASIZ                    0-0-0/w PTR         r     1 DCB$
  2020-0-0/w STRC(90)    r     1 DEVSN                   2242-0-0/d STRC(288)   r     1 FPTWRENT
  2232-0-0/d STRC(288)   r     1 FPTWRID                 2032-0-0/d STRC(2088)  r     1 FPT_RDPAK
  2216-0-0/d STRC(432)   r     1 FPT_TIME                2124-0-0/d STRC(2088)  r     1 FPT_UPDPAK
  2014-0-0/w STRC(144)   r     1 GACCTL                  2023-0-0/c STRC(216)   r     1 ID_REC
     1-0-0/w SBIN        r     1 MODEFLG                 2005-0-0/w UBIN        r     1 NUMENT
  2012-0-0/w UBIN        r     1 PREV_GAC_START_TIME     2013-0-0/w UBIN        r     1 PREV_GAC_STOP_TIME
  2006-0-0/w UBIN        r     1 START_OK                2011-0-0/w UBIN        r     1 THIS_GAC_START_TIME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PDCB$                     4-0-0/w PTR         r     1 @PMODEFLG
    13-0-0/w UBIN        r     1 CHARGTYP                   7-0-0/w PTR         r     1 COD3$
    10-0-0/w PTR         r     1 COD4$                     11-0-0/w PTR         r     1 COD6$
    15-0-0/w PTR         r     1 ENT$                       6-0-0/w PTR         r     1 FIT$
    16-0-0/w UBIN        r     1 I                         12-0-0/w UBIN        r     1 NGRANS
    14-0-0/w UBIN        r     1 OLDINTEGRAL               *0-0-0/w PTR         r     1 PDCB$
    *0-0-0/w UBIN        r     1 PMODEFLG                   5-0-0/w UBIN        r     1 TIME
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:52   

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(324)   r     1 CODE03
     0-0-0/w STRC(396)   r     1 CODE04                     0-0-0/w STRC(576)   r     1 ENT
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(1116)  r     1 FM$FIT
     0-0-0N  NULL        r     1 M$GAC


   Procedure FGG$START requires 491 words for executable code.
   Procedure FGG$START requires 24 words of local(AUTO) storage.

    No errors detected in file FGG$GAC.:E05TSI    .
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:53   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:54   
          MINI XREF LISTING

ABORT
      5171**LABEL    5137--CALLALT  5139--CALLALT  5163--CALLALT
ACCT
      4640**DCL      5165<<ASSIGN   5225>>IF       5227<<ASSIGN   5230>>IF       5230>>IF       5308>>IF
      5318>>ASSIGN
ACCTZER
      4629**DCL      4770--DCLINIT  4880--DCLINIT
AVAILSIZ
      4637**DCL      5128<<ASSIGN   5312>>IF       5313<<ASSIGN   5313>>ASSIGN   5342<<ASSIGN   5346<<ASSIGN
B$ALT.CODE
      4975**DCL      4975--REDEF    4976--REDEF    4976--REDEF
B$ALT.ERR.ERR#
      4977**DCL      4977--REDEF
B$ALT.EVID
      4976**DCL      4976--REDEF    4976--REDEF
B$JIT.ACCN
      2706**DCL      5159>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      2800**DCL      2800--REDEF
B$JIT.ERR.MID
      2707**DCL      2707--REDEF
B$JIT.JRESPEAK
      2868**DCL      2869--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      2977**DCL      2977--REDEF    2978--REDEF
B$JIT.PNR
      2881**DCL      2881--REDEF
B$JIT.SYSID
      2706**DCL      5161>>ASSIGN   5320>>ASSIGN
B$JIT.TSLINE
      2975**DCL      2976--REDEF
B$JIT.UNAME
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:55   
      2706**DCL      5160>>ASSIGN
B$JIT$
        31**DCL      2701--IMP-PTR  5159>>ASSIGN   5160>>ASSIGN   5161>>ASSIGN   5320>>ASSIGN
CHARGTYP
      4693**DCL      5239<<ASSIGN   5241<<ASSIGN   5244<<ASSIGN   5264>>CALL     5268>>CALL     5290>>CALL
CLNUP
      5208**LABEL    5185--GOTO     5193--CALLALT  5196--CALLALT  5201--CALLALT
COD3$
      4689**DCL      5042--IMP-PTR  5235<<ASSIGN   5236<>CALL     5237>>ASSIGN   5237>>ASSIGN   5238>>IF
COD4$
      4690**DCL      5051--IMP-PTR  5138<<ASSIGN   5139<>CALL     5140>>ASSIGN   5141>>ASSIGN   5142>>ASSIGN
      5143>>ASSIGN   5194<<ASSIGN   5196<>CALL     5199>>ASSIGN   5200>>ASSIGN   5233<<ASSIGN   5234<>CALL
      5248>>IF       5250>>IF       5255>>IF       5260>>CALL     5261>>ASSIGN   5269>>ASSIGN   5270>>ASSIGN
      5273>>IF       5278>>IF       5283>>IF       5284>>CALL     5285>>ASSIGN   5289>>ASSIGN   5308>>IF
      5317>>ASSIGN
COD6$
      4691**DCL      5242<<ASSIGN   5243<>CALL
CODE03.DESC.BUPM
      5043**DCL      5238>>IF
CODE03.NGAVAL
      5044**DCL      5237>>ASSIGN
CODE03.UGRANS
      5042**DCL      5237>>ASSIGN
CODE04.ACCESS.TIME
      5053**DCL      5142>>ASSIGN
CODE04.CREATOR
      5053**DCL      5308>>IF       5317>>ASSIGN
CODE04.GAC.N
      5054**DCL      5141>>ASSIGN   5200<<ASSIGN   5261>>ASSIGN   5270<<ASSIGN   5285>>ASSIGN   5289>>ASSIGN
CODE04.GAC.TIME
      5054**DCL      5140>>ASSIGN   5199<<ASSIGN   5248>>IF       5250>>IF       5255>>IF       5260<>CALL
      5269<<ASSIGN   5273>>IF       5278>>IF       5283>>IF       5284<>CALL
CODE04.SVMODIFY.TIME
      5054**DCL      5143>>ASSIGN
COMP
      5290**LABEL    5276--GOTO     5281--GOTO     5286--GOTO
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:56   
DATA$
      4634**DCL      5039--IMP-PTR  5138>>ASSIGN   5194>>ASSIGN   5197>>ASSIGN   5198>>ASSIGN   5198>>ASSIGN
      5306>>ASSIGN   5314>>ASSIGN   5336>>ASSIGN
DATAREA
      4635**DCL      4634--DCLINIT  4770--DCLINIT  4880--DCLINIT  5127--ASSIGN
DATASIZ
      4636**DCL      5127<<ASSIGN   5128>>ASSIGN   5342>>ASSIGN   5346>>ASSIGN
DCB$
      4632**DCL      5124<<ASSIGN   5134>>ASSIGN   5225>>IF       5227>>ASSIGN
DEVSN
      4650**DCL      4765--DCLINIT  4875--DCLINIT
DEVSN.SN
      4652**DCL      5134<<ASSIGN   5135>>IF       5230>>IF       5319>>ASSIGN
DONE3
      5200**LABEL    5203--CALLALT
ENT
      5062**DCL      4968--DCLINIT  5310--ASSIGN   5312--IF       5313--ASSIGN   5314--ASSIGN   5316<<ASSIGN
      5338--ASSIGN   5340--ASSIGN
ENT.CODE
      5063**DCL      5321<<ASSIGN
ENT.CREATOR
      5079**DCL      5308>>IF       5317<<ASSIGN
ENT.FMACCT
      5088**DCL      5308>>IF       5318<<ASSIGN
ENT.ONLINE
      5116**DCL      5264<>CALL     5290<>CALL
ENT.PSN
      5093**DCL      5319<<ASSIGN
ENT.SHELF
      5104**DCL      5268<>CALL
ENT.SYSID
      5069**DCL      5320<<ASSIGN
ENT$
      4695**DCL      5062--IMP-PTR  5264>>CALL     5268>>CALL     5290>>CALL     5306<<ASSIGN   5308>>IF
      5308>>IF       5310<<ASSIGN   5310>>ASSIGN   5314<<ASSIGN   5316>>ASSIGN   5317>>ASSIGN   5318>>ASSIGN
      5319>>ASSIGN   5320>>ASSIGN   5321>>ASSIGN   5336<<ASSIGN   5338>>ASSIGN   5340<<ASSIGN   5340>>ASSIGN
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:57   
ERR IN PROCEDURE FLUSH
      5346**LABEL    5339--CALLALT
F$DCB.ACCT#
      4998**DCL      5225>>IF       5227>>ASSIGN
F$DCB.ACTPOS
      5014**DCL      5014--REDEF
F$DCB.ARS#
      4988**DCL      4988--REDEF
F$DCB.ATTR
      5007**DCL      5008--REDEF
F$DCB.BORROW
      5022**DCL      5022--REDEF    5022--REDEF    5022--REDEF
F$DCB.DCBNAME.L
      5036**DCL      5036--IMP-SIZ
F$DCB.EOMCHAR#
      4992**DCL      4992--REDEF
F$DCB.FLDID
      5017**DCL      5017--REDEF
F$DCB.FORM$
      5011**DCL      5011--REDEF
F$DCB.FSECT
      5027**DCL      5027--REDEF
F$DCB.FSN#
      5004**DCL      5004--REDEF    5004--REDEF    5005--REDEF
F$DCB.HEADER$
      5010**DCL      5010--REDEF
F$DCB.IXTNSIZE#
      5008**DCL      5008--REDEF
F$DCB.LASTSTA$
      4997**DCL      4997--REDEF
F$DCB.LVL
      5023**DCL      5023--REDEF
F$DCB.NAME#.C
      4998**DCL      4998--REDEF
F$DCB.NOEOF
      5020**DCL      5020--REDEF
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:58   
F$DCB.NRECS#
      5009**DCL      5009--REDEF
F$DCB.NRECX
      5028**DCL      5028--REDEF
F$DCB.OHDR
      5020**DCL      5020--REDEF
F$DCB.ORG#
      5003**DCL      5003--REDEF
F$DCB.PRECNO
      5026**DCL      5026--REDEF
F$DCB.PSN#
      4998**DCL      5134>>ASSIGN
F$DCB.RCSZ
      5032**DCL      5032--REDEF
F$DCB.RES#
      4999**DCL      4999--REDEF
F$DCB.SETX
      5011**DCL      5011--REDEF
F$DCB.TAB$
      5011**DCL      5011--REDEF
F$DCB.TDA
      5025**DCL      5026--REDEF
F$DCB.WSN#
      4999**DCL      4999--REDEF
FGH$UPDBUCKET
      4578**DCL-ENT  5264--CALL     5268--CALL     5290--CALL
FINDENTRY
      5304**PROC     5246--CALL
FIT$
      4688**DCL      5224<<ASSIGN   5233>>ASSIGN   5235>>ASSIGN   5242>>ASSIGN
FIT1CODE
      4616**DCL      5197>>ASSIGN
FLUSH
      5334**PROC     5188--CALL     5226--CALL     5324--CALL
FM$FIT.CODES
      5039**DCL      5197<<ASSIGN   5198<<ASSIGN   5198>>ASSIGN
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:59   
FPTWRENT
      4966**DCL      5339<>CALL
FPTWRENT.ENTRY_
      4966**DCL      5338<<ASSIGN
FPTWRENT.V
      4966**DCL      4966--DCLINIT
FPTWRID
      4950**DCL      5163<>CALL     5203<>CALL
FPTWRID.V
      4950**DCL      4950--DCLINIT
FPT_RDPAK
      4765**DCL      5137<>CALL     5193<>CALL
FPT_RDPAK.ACSVEH_
      4767**DCL      4768--REDEF
FPT_RDPAK.ALTKEYS_
      4773**DCL      4774--REDEF    4774--REDEF
FPT_RDPAK.HDR_
      4772**DCL      4773--REDEF
FPT_RDPAK.TAB_
      4771**DCL      4772--REDEF
FPT_RDPAK.UHL_
      4765**DCL      4766--REDEF    4766--REDEF
FPT_RDPAK.V
      4774**DCL      4765--DCLINIT
FPT_RDPAK.V.FSN#
      4805**DCL      4805--REDEF    4805--REDEF
FPT_RDPAK.WSN_
      4771**DCL      4771--REDEF
FPT_TIME
      4930**DCL      5132<>CALL     5191<>CALL
FPT_TIME.V
      4934**DCL      4930--DCLINIT
FPT_UPDPAK
      4875**DCL      5201<>CALL
FPT_UPDPAK.ACSVEH_
      4877**DCL      4878--REDEF
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:60   
FPT_UPDPAK.ALTKEYS_
      4883**DCL      4884--REDEF    4884--REDEF
FPT_UPDPAK.HDR_
      4882**DCL      4883--REDEF
FPT_UPDPAK.TAB_
      4881**DCL      4882--REDEF
FPT_UPDPAK.UHL_
      4875**DCL      4876--REDEF    4876--REDEF
FPT_UPDPAK.V
      4884**DCL      4875--DCLINIT
FPT_UPDPAK.V.FSN#
      4915**DCL      4915--REDEF    4915--REDEF
FPT_UPDPAK.WSN_
      4881**DCL      4881--REDEF
GACCTL.DISMOUNT_TIME
      4647**DCL      5143<<ASSIGN   5151>>IF       5152<<ASSIGN   5153>>IF       5154>>ASSIGN   5248>>IF
      5248>>IF       5251<>CALL     5256<>CALL     5260<>CALL     5267<>CALL
GACCTL.MOUNT_TIME
      4646**DCL      5142<<ASSIGN   5153>>IF       5154<<ASSIGN   5267<>CALL     5269>>ASSIGN
GACCTL.START_TIME
      4648**DCL      5141<<ASSIGN   5149>>IF       5150<<ASSIGN   5155>>ASSIGN   5190<<ASSIGN   5200>>ASSIGN
GACCTL.STOP_TIME
      4649**DCL      5140<<ASSIGN   5147>>IF       5148<<ASSIGN   5149>>IF       5150>>ASSIGN   5156>>ASSIGN
      5192<<ASSIGN   5199>>ASSIGN
I
      4696**DCL      5195<<ASSIGN   5196<>CALL     5198>>ASSIGN   5307<<DOINDEX  5337<<DOINDEX
ID_REC
      4659**DCL      4950--DCLINIT  4952--DCLINIT  5158<<ASSIGN
ID_REC.ACCT
      4676**DCL      5159<<ASSIGN
ID_REC.CODE
      4660**DCL      5162<<ASSIGN
ID_REC.FLAG
      4665**DCL      5202<<ASSIGN
ID_REC.SYSID
      4672**DCL      5161<<ASSIGN
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:61   
ID_REC.UNAME
      4680**DCL      5160<<ASSIGN
M$OPEN
      4118**DCL-ENT  5137--CALL     5193--CALL     5201--CALL
M$TIME
      4185**DCL-ENT  5132--CALL     5191--CALL
M$WRSYSLOG
      4167**DCL-ENT  5163--CALL     5203--CALL     5339--CALL
MODEFLG
      4633**DCL      5125<<ASSIGN   5135>>IF       5248>>IF
NGRANS
      4692**DCL      5237<<ASSIGN   5264<>CALL     5268<>CALL     5290<>CALL
NOTSTOW
      5246**LABEL    5243--CALLALT
NUMENT
      4638**DCL      5129<<ASSIGN   5209<<ASSIGN   5307>>DOINDEX  5314>>ASSIGN   5315<<ASSIGN   5315>>ASSIGN
      5337>>DOINDEX  5343<<ASSIGN   5347<<ASSIGN
OLDINTEGRAL
      4694**DCL      5252<<ASSIGN   5257<<ASSIGN   5261<<ASSIGN   5264<>CALL     5275<<ASSIGN   5280<<ASSIGN
      5285<<ASSIGN   5289<<ASSIGN   5290<>CALL
PDCB$
        28**DCL        26--PROC     5124>>ASSIGN   5220--ENTRY    5224>>ASSIGN
PMODEFLG
        29**DCL        26--PROC     5125>>ASSIGN
PREV_GAC_START_TIME
      4642**DCL      5155<<ASSIGN   5248>>IF       5250>>IF       5251<>CALL     5273>>IF       5274<>CALL
PREV_GAC_STOP_TIME
      4643**DCL      5156<<ASSIGN   5255>>IF       5256<>CALL     5278>>IF       5279<>CALL
RET
      5292**LABEL    5234--CALLALT  5236--CALLALT  5246--CALLALT
RETRY IN PROCEDURE FINDENTRY
      5306**LABEL    5325--GOTO
START_OK
      4639**DCL      5130<<ASSIGN   5167<<ASSIGN   5184>>IF       5186<<ASSIGN   5208<<ASSIGN   5222>>IF
THIS_GAC_START_TIME
      4641**DCL      4934--DCLINIT  5147>>IF       5148>>ASSIGN   5151>>IF       5152>>ASSIGN   5190>>ASSIGN
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:62   
      5192>>ASSIGN   5274<>CALL     5279<>CALL     5283>>IF       5284<>CALL
TIME
      4687**DCL      5251<>CALL     5256<>CALL     5260<>CALL     5264<>CALL     5267<>CALL     5268<>CALL
      5274<>CALL     5279<>CALL     5284<>CALL     5288<<ASSIGN   5290<>CALL
XSF$LOCCODE
      4579**DCL-ENT  5196--CALL
XSF$LOCCODP
      4580**DCL-ENT  5139--CALL     5234--CALL     5236--CALL
XSF$LOCCODT
      4581**DCL-ENT  5243--CALL
XUD$UTS_DIFF
      4583**DCL-ENT  5251--CALL     5256--CALL     5260--CALL     5267--CALL     5274--CALL     5279--CALL
      5284--CALL
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:63   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:64   
              MINI UREF LISTING

B$TCB    4971**DCL
B$TCB$      32**DCL
DONE2    5202**LABEL
FGG$DONE    5182**ENTRY
FGG$PROCESS_FIT    5220**ENTRY
FGG$QUIT    5206**ENTRY
FGG$START      26**PROC
M$ACCT    4135**DCL-ENT
M$ACTIVATE    4138**DCL-ENT
M$ALIB    4131**DCL-ENT
M$ASUSER    4133**DCL-ENT
M$ATTACH    4140**DCL-ENT
M$BADPP    4158**DCL-ENT
M$CGCTL    4139**DCL-ENT
M$CGINFO    4139**DCL-ENT
M$CHECK    4120**DCL-ENT
M$CHGUNIT    4178**DCL-ENT
M$CLOSE    4118**DCL-ENT
M$CLRSTK    4176**DCL-ENT
M$CMDVAR    4187**DCL-ENT
M$CONFIG    4148**DCL-ENT
M$CORRES    4123**DCL-ENT
M$CPEXIT    4132**DCL-ENT
M$CVM    4156**DCL-ENT
M$CVOL    4121**DCL-ENT
M$DCLFLD    4148**DCL-ENT
M$DEACTIVATE    4138**DCL-ENT
M$DELREC    4120**DCL-ENT
M$DEQ    4185**DCL-ENT
M$DETACH    4140**DCL-ENT
M$DEVICE    4122**DCL-ENT
M$DISPLAY    4185**DCL-ENT
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:65   
M$DISPRES    4125**DCL-ENT
M$DLIB    4131**DCL-ENT
M$DRIBBLE    4148**DCL-ENT
M$DRTN    4176**DCL-ENT
M$DSUSER    4133**DCL-ENT
M$ENQ    4184**DCL-ENT
M$EOM    4143**DCL-ENT
M$ERASE    4149**DCL-ENT
M$ERR    4130**DCL-ENT
M$ERRMSG    4181**DCL-ENT
M$EVENT    4173**DCL-ENT
M$EXHUME    4182**DCL-ENT
M$EXIT    4130**DCL-ENT
M$EXTEND    4122**DCL-ENT
M$FDP    4154**DCL-ENT
M$FDS    4153**DCL-ENT
M$FEBOOT    4146**DCL-ENT
M$FECTL    4147**DCL-ENT
M$FEDUMP    4146**DCL-ENT
M$FID    4181**DCL-ENT
M$FINDPROC    4135**DCL-ENT
M$FSUSER    4133**DCL-ENT
M$FVP    4155**DCL-ENT
M$FWCG    4139**DCL-ENT
M$GAC      34**DCL
M$GBPL    4159**DCL-ENT
M$GDDL    4155**DCL-ENT
M$GDP    4154**DCL-ENT
M$GDS    4153**DCL-ENT
M$GETDCB    4124**DCL-ENT
M$GETMOUSE    4164**DCL-ENT
M$GETPM    4165**DCL-ENT
M$GJOB    4183**DCL-ENT
M$GLINEATTR    4143**DCL-ENT
M$GOODPP    4158**DCL-ENT
M$GPLATEN    4151**DCL-ENT
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:66   
M$GPROMPT    4150**DCL-ENT
M$GTRMATTR    4144**DCL-ENT
M$GTRMCTL    4142**DCL-ENT
M$GTRMTAB    4145**DCL-ENT
M$GVP    4154**DCL-ENT
M$HELP    4181**DCL-ENT
M$INT    4173**DCL-ENT
M$INTRTN    4134**DCL-ENT
M$IOQ    4169**DCL-ENT
M$JOBSTATS    4183**DCL-ENT
M$KEYIN    4123**DCL-ENT
M$LDEV    4118**DCL-ENT
M$LDTRC    4131**DCL-ENT
M$LIMIT    4124**DCL-ENT
M$LINES    4123**DCL-ENT
M$LINK    4130**DCL-ENT
M$MADMUCK    4126**DCL-ENT
M$MAKUSER    4157**DCL-ENT
M$MBS    4125**DCL-ENT
M$MDFFLD    4149**DCL-ENT
M$MERC    4174**DCL-ENT
M$MERCS    4175**DCL-ENT
M$MIRROR    4169**DCL-ENT
M$MONINFO    4186**DCL-ENT
M$MPL    4159**DCL-ENT
M$NODEINFO    4150**DCL-ENT
M$NXTUSR    4184**DCL-ENT
M$OCMSG    4182**DCL-ENT
M$OLAY    4130**DCL-ENT
M$PAS    4159**DCL-ENT
M$PATHCON    4182**DCL-ENT
M$PDS    4153**DCL-ENT
M$PFIL    4120**DCL-ENT
M$PLATEN    4144**DCL-ENT
M$PRECORD    4122**DCL-ENT
M$PROCNAME    4135**DCL-ENT
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:67   
M$PROFILE    4146**DCL-ENT
M$PROMPT    4142**DCL-ENT
M$RACST    4126**DCL-ENT
M$RDSYSLOG    4167**DCL-ENT
M$READ    4119**DCL-ENT
M$RELDCB    4124**DCL-ENT
M$RELRES    4125**DCL-ENT
M$RELSTARF    4127**DCL-ENT
M$REM    4127**DCL-ENT
M$RENV    4174**DCL-ENT
M$REQUIRE    4126**DCL-ENT
M$RETRY    4175**DCL-ENT
M$RETRYS    4175**DCL-ENT
M$REW    4121**DCL-ENT
M$RLSFLD    4149**DCL-ENT
M$RPRIV    4177**DCL-ENT
M$RSPP    4156**DCL-ENT
M$RSWITCH    4178**DCL-ENT
M$RUE    4184**DCL-ENT
M$SAD    4157**DCL-ENT
M$SAVE    4133**DCL-ENT
M$SCON    4134**DCL-ENT
M$SCREECH    4132**DCL-ENT
M$SENV    4174**DCL-ENT
M$SETFMA    4118**DCL-ENT
M$SETFP    4147**DCL-ENT
M$SINPUT    4145**DCL-ENT
M$SLCFLD    4150**DCL-ENT
M$SMOUSE    4164**DCL-ENT
M$SMPRT    4156**DCL-ENT
M$SPRIV    4177**DCL-ENT
M$SSC    4157**DCL-ENT
M$SSWITCH    4177**DCL-ENT
M$STATE    4186**DCL-ENT
M$STD    4158**DCL-ENT
M$STIMER    4172**DCL-ENT
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:68   
M$STLPP    4155**DCL-ENT
M$STRAP    4172**DCL-ENT
M$STRMATTR    4144**DCL-ENT
M$STRMCTL    4142**DCL-ENT
M$STRMTAB    4145**DCL-ENT
M$SYMBIO    4183**DCL-ENT
M$SYSCON    4169**DCL-ENT
M$SYSID    4187**DCL-ENT
M$TDCLOSE    4168**DCL-ENT
M$TDIO    4168**DCL-ENT
M$TDOPEN    4167**DCL-ENT
M$TDREQCPU    4168**DCL-ENT
M$TEMPWROC    4162**DCL-ENT
M$TRAP    4172**DCL-ENT
M$TRMISC    4147**DCL-ENT
M$TRMPRG    4143**DCL-ENT
M$TRTN    4176**DCL-ENT
M$TRUNC    4119**DCL-ENT
M$TTIMER    4172**DCL-ENT
M$UC    4142**DCL
M$UMPL    4159**DCL-ENT
M$UNFID    4181**DCL-ENT
M$UNLATCH    4138**DCL-ENT
M$UNSHARE    4135**DCL-ENT
M$USRFIELD    4178**DCL-ENT
M$VIRTUAL    4153**DCL-ENT
M$WAIT    4176**DCL-ENT
M$WEOF    4121**DCL-ENT
M$WRITE    4119**DCL-ENT
M$XCON    4173**DCL-ENT
M$XCONRTN    4134**DCL-ENT
M$XEQTIME    4186**DCL-ENT
M$XFLUSH    4127**DCL-ENT
M$XMOUSE    4164**DCL-ENT
M$XXX    4130**DCL-ENT
M$YC    4132**DCL-ENT
PL6.E3A0      #001=FGG$START File=FGG$GAC.:E05TSI                                TUE 07/29/97 15:24 Page:69   
QUIT2    5210**LABEL
XUD$UTS_ADJUST    4601**DCL-ENT
XUD$UTS_ADJ_25TH    4607**DCL-ENT
XUD$UTS_DIFF_25TH    4595**DCL-ENT
XUD$UTS_DIFF_SEC    4589**DCL-ENT
