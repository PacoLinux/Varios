VERSION E05

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:1    
        1        1        /*M*     FXU$UTIL - PACKSET INSTALLATION GHOST SUBRS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=0,ENU=0,DCI=3,NSO,
        8        8        IAD=3,CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9        FXU$PROTCHK:PROC(VID)ALTRET;
       10       10        %INCLUDE FM$MACROS;
       11      385    1   DCL VID UBIN ALIGNED;
       12      386        %FM$VID(FM$VID=VIDBUF,BASED=SYMREF);
       13      392        %INCLUDE CP_6;
       14      473        %INCLUDE CP_6_SUBS;
       15     1013        %INCLUDE FX$CAT;
       16     1030        %FX$PSN(BASED=STATIC);
       17     1033    1   DCL M$LO DCB;
       18     1034    1   DCL M$SI DCB;
       19     1035    1   DCL M$ME DCB;
       20     1036    1   DCL M$DP DCB;
       21     1037    1   DCL M$DP$ PTR SYMREF;
       22     1038    1   DCL M$LO$ PTR SYMREF;
       23     1039    1   DCL M$SI$ PTR SYMREF;
       24     1040        %F$DCB;
       25     1097        %M$DCB(DCBN=M$CAT,
       26     1098                 NAME=':CAT',
       27     1099                 FUN=CREATE,
       28     1100                 EXIST=OLDFILE,
       29     1101                 ASN=FILE,
       30     1102                 ORG=KEYED,
       31     1103                 ACS=DIRECT,
       32     1104                 SHARE=ALL,
       33     1105                 CTG=YES,
       34     1106                 ACCT=':SYS');
       35     1180        %FPT_OPEN(FPTN=OPME,STCLASS=CONSTANT,SCRUB=YES,DCB=M$ME,DVFC='@');
       36     1289        %FPT_PROMPT(FPTN=CONPR,STCLASS=CONSTANT,PROMPT=PROMT);
       37     1317    1   DCL PROMT CHAR(1) CONSTANT INIT('?');
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:2    
       38     1318    1   DCL FPT_PROMPT(0:2) BIT(72) SYMREF DALIGNED;
       39     1319        %FPT_WRITE(FPTN=WMESS,DCB=M$ME);
       40     1350        %FPT_WRITE(FPTN=WCONT,BUF=CONTMES,DCB=M$ME,STCLASS=CONSTANT);
       41     1381        %FPT_READ(FPTN=CONFIRM,DCB=M$ME,BUF=REPLY,STCLASS=CONSTANT);
       42     1420        %FPT_OPEN(FPTN=LO2LP,STCLASS=CONSTANT,RES='LP',DCB=M$LO);
       43     1529        %FPT_OPEN(FPTN=SI2CG,DCB=M$SI,STCLASS=CONSTANT,
       44     1530        ASN=COMGROUP,SETSTA=PIG,FUN=UPDATE,NAME=CSCG);
       45     1639        %VLP_NAME(FPTN=CSCG,STCLASS=CONSTANT,NAME='CSCG');
       46     1666        %VLP_SETSTA(FPTN=PIG,STCLASS=CONSTANT,MYSTATION='PIG',ILATCH=YES,
       47     1667                    OSTATION='KEYIN');
       48     1695        %M$DCB(DCBN=M$PIGCG,ASN=COMGROUP,NAME='PIGCG',FUN=CREATE,EXIST=OLDFILE,
       49     1696               CTG=YES,SHARE=IN,AU=YES);
       50     1770        %FPT_WAIT(FPTN=WAIT5,STCLASS=CONSTANT,UNITS=5);
       51     1784        %FPT_OPEN(FPTN=FIRSTF,DCB=M$DP,STCLASS=CONSTANT,NXTF=YES,NAME=ERASE,ASN=FILE,
       52     1785              FUN=IN,TEST=YES);
       53     1894        %FPT_OPEN(FPTN=DELNXT,DCB=M$DP,STCLASS=CONSTANT,NXTF=YES,THISF=YES,DELETE=YES);
       54     2003        %FPT_READ(FPTN=RCAT,DCB=M$CAT,KEYS=YES,KEY=PSNKEY,BUF=FX$PSN,STCLASS=CONSTANT);
       55     2042    1   DCL 1 PSNKEY STATIC,
       56     2043    1         2 L UBIN(9)UNAL INIT(11),
       57     2044    1         2 PSN CHAR(7),
       58     2045    1         2 VSN BIT(36),
       59     2046    1         2 CVSN REDEF VSN CHAR(4);
       60     2047    1   DCL OPENTYPE UBIN; /* DPNN, VSN, VSNN, PSN */
       61     2048    1   DCL REPLY CHAR(4) STATIC INIT('X');
       62     2049    1   DCL VIDMES CHAR(0) STATIC INIT(
       63     2050    1   'NNNNNNNNA IS NOT A SCRATCH PACK');
       64     2051    1   DCL CONTMES CONSTANT CHAR(0) INIT(
       65     2052    1   ' - Y TO CONTINUE');
       66     2053    1   DCL DELFMES CHAR(0)STATIC INIT(
       67     2054    1   '999999 GRANULES WILL BE DELETED');
       68     2055    1   DCL DELMMES CHAR(0)CONSTANT INIT(
       69     2056    1   'MASTER ACCOUNT DIRECTORY TO BE DESTROYED');
       70     2057    1   DCL NOINTMES CHAR(0) CONSTANT INIT(
       71     2058    1   ' **** INTERACTIVE REPLY REQUIRED');
       72     2059    2      IF ADDR(VID)=ADDR(VIDBUF) THEN DO;/* CHECK VID */
       73     2060    2         IF SUBSTR(M$DP$->F$DCB.PSN#,0,1)=BINASC(0) THEN OPENTYPE=1;
       74     2061    2         ELSE IF M$DP$->F$DCB.PSN#>' ' THEN OPENTYPE=3;
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:3    
       75     2062    2         ELSE IF SUBSTR(M$DP$->F$DCB.PSN#,4,1)~=' ' THEN OPENTYPE=0;
       76     2063    2         ELSE OPENTYPE=2;
       77     2064    2         IF VIDBUF.ID~='CP6' THEN CALL CONCAT(VIDMES,
       78     2065    2           SUBSTR(M$DP$->F$DCB.PSN#,1,4),' IS NOT A CP6 DISKPACK');
       79     2066    2         ELSE IF VIDBUF.VOLCNT=0 AND (OPENTYPE>1 /* VSNN OR PSN */
       80     2067    2           OR VIDBUF.SECTSTRT(1)=0
       81     2068    2           OR VIDBUF.SECTSTRT(1)>=M$DP$->F$DCB.IXTNSIZE#) THEN RETURN;
       82     2069    3         ELSE DO;
       83     2070    3            PSNKEY.PSN=VIDBUF.PSN;
       84     2071    3            PSNKEY.VSN=VIDBUF.SNLIST.VSN(0);
       85     2072    3            FX$PSN='0'B;
       86     2073    3            IF NOT DCBADDR(DCBNUM(M$CAT))->F$DCB.AMR#
       87     2074    3            THEN CALL M$READ(RCAT)ALTRET(IDGAS);
       88     2075    3   IDGAS:   IF FX$PSN.DEFMOUNT=%SCRATCH# AND (OPENTYPE>1
       89     2076    3              OR VIDBUF.SECTSTRT(1)=0
       90     2077    3              OR VIDBUF.SECTSTRT(1)>=M$DP$->F$DCB.IXTNSIZE#) THEN RETURN;
       91     2078    3            CALL BINCHAR(SUBSTR(VIDMES,0,8),VIDBUF.VSN);
       92     2079    3            CALL EDITCHAR(VIDMES,0,7,'107'O,SUBSTR(VIDMES,0,8));
       93     2080    3            IF OPENTYPE=2 THEN PSNKEY.CVSN=M$DP$->F$DCB.PSN#;
       94     2081    3            IF OPENTYPE>=2 THEN CALL INSERT(VIDMES,8,,
       95     2082    3              BINASC(ASCBIN(SUBSTR(PSNKEY.CVSN,0,1))+ASCBIN('@')),
       96     2083    3              ' IS NOT A SCRATCH PACK');
       97     2084    3            ELSE IF VIDBUF.SECTSTRT(1)>=M$DP$->F$DCB.IXTNSIZE#
       98     2085    3              OR VIDBUF.SECTSTRT(1)=0 THEN CALL INSERT(VIDMES,8,,
       99     2086    3              ' IS NOT A SCRATCH PACK');
      100     2087    3            ELSE CALL INSERT(VIDMES,8,,' HAS MANY SECTIONS');
      101     2088    3            END;
      102     2089    2         WMESS.BUF_=VECTOR(VIDMES);
      103     2090    2         END;
      104     2091    1      ELSE IF VID=0 THEN WMESS.BUF_=VECTOR(DELMMES);
      105     2092    2      ELSE DO;
      106     2093    2         IF M$DP$->F$DCB.IASN~=%FMDIAG# THEN RETURN; /* DELETE WONT WORK */
      107     2094    2         CALL M$OPEN(FIRSTF) ALTRET(RETRET);
      108     2095    3         IF NOT M$SI$->F$DCB.DDEV.IC# THEN DO WHILE('1'B);
      109     2096    3   DELFILES: CALL M$OPEN(DELNXT) ALTRET(RETRET);
      110     2097    3            END;
      111     2098    2         CALL BINCHAR(SUBSTR(DELFMES,0,6),VID);
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:4    
      112     2099    2         CALL EDITCHAR(DELFMES,0,5,'105'O,SUBSTR(DELFMES,0,6));
      113     2100    2         WMESS.BUF_=VECTOR(DELFMES);
      114     2101    2         END;
      115     2102    1      IF NOT DCBADDR(DCBNUM(M$ME))->F$DCB.FCD# THEN CALL M$OPEN(OPME);
      116     2103    1      CALL M$WRITE(WMESS);
      117     2104    1      REPLY=' ';
      118     2105    2      IF M$SI$->F$DCB.DDEV.IC# AND NOT M$SI$->F$DCB.DDEV.XEQ# THEN DO;
      119     2106    3         IF NOT M$LO$->F$DCB.DDEV.IC# THEN DO;
      120     2107    3            WMESS.V.DCB#=DCBNUM(M$LO);
      121     2108    3            CALL M$WRITE(WMESS);
      122     2109    3            WMESS.V.DCB#=DCBNUM(M$ME);
      123     2110    3            END;
      124     2111    2         CALL M$WRITE(WCONT);
      125     2112    2         CALL M$PROMPT(CONPR);
      126     2113    2         CALL M$READ(CONFIRM);
      127     2114    2         CALL M$PROMPT(FPT_PROMPT);
      128     2115    2         END;
      129     2116    2      ELSE DO;
      130     2117    2         WMESS.BUF_=VECTOR(NOINTMES);
      131     2118    2         CALL M$WRITE(WMESS);
      132     2119    2         END;
      133     2120    1      REPLY=SUBSTR(REPLY,0,1);
      134     2121    2      IF REPLY='Y' OR REPLY='y' THEN DO;
      135     2122    2         IF WMESS.BUF_=VECTOR(DELFMES) THEN GOTO DELFILES;
      136     2123    2   RETRET: RETURN;
      137     2124    2         END;
      138     2125    1      ALTRETURN;
      139     2126        %EJECT;
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:5    
      140     2127    1   FXU$GINIT: ENTRY ALTRET;
      141     2128    1      CALL M$OPEN(LO2LP)ALTRET(WAIT);
      142     2129    1      CALL M$OPEN(SI2CG)ALTRET(WAIT);
      143     2130    1      RETURN;
      144     2131    1   WAIT: ;
      145     2132    1      CALL M$WAIT(WAIT5);
      146     2133    1      CALL M$RETRY;
      147     2134    1   END;
      148     2135        %EOD;

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:6    
--  Include file information  --

   FX$CAT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   FM$MACROS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$PROTCHK.

   Procedure FXU$PROTCHK requires 250 words for executable code.
   Procedure FXU$PROTCHK requires 8 words of local(AUTO) storage.

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:7    

 Object Unit name= FXU$PROTCHK                                File name= FXU$UTIL.:E05TOU
 UTS= JUL 29 '97 20:33:28.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    38     46  FXU$PROTCHK
    2   DCB   even  none     0      0  M$LO
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$DP
    6   DCB   even  none    98    142  M$CAT
    7  RoData even  UTS    402    622  FXU$PROTCHK
    8   DCB   even  none    98    142  M$PIGCG
    9   Proc  even  none   250    372  FXU$PROTCHK
   10  RoData even  none    15     17  FXU$PROTCHK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        1  FXU$PROTCHK
     9    351          yes     yes      Std        0  FXU$GINIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:8    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     VIDBUF                                M$UC                                  M$LO
     M$SI                                  M$ME                                  M$DP
     M$DP$                                 M$LO$                                 M$SI$
     M$CAT                                 FPT_PROMPT                            M$PIGCG
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:9    


        1        1        /*M*     FXU$UTIL - PACKSET INSTALLATION GHOST SUBRS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=0,ENU=0,DCI=3,NSO,
        8        8        IAD=3,CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9        FXU$PROTCHK:PROC(VID)ALTRET;

      9  9 000000   000000 700200 xent  FXU$PROTCHK  TSX0  ! X66_AUTO_1
         9 000001   000010 000001                    ZERO    8,1

       10       10        %INCLUDE FM$MACROS;
       11      385    1   DCL VID UBIN ALIGNED;
       12      386        %FM$VID(FM$VID=VIDBUF,BASED=SYMREF);
       13      392        %INCLUDE CP_6;
       14      473        %INCLUDE CP_6_SUBS;
       15     1013        %INCLUDE FX$CAT;
       16     1030        %FX$PSN(BASED=STATIC);
       17     1033    1   DCL M$LO DCB;
       18     1034    1   DCL M$SI DCB;
       19     1035    1   DCL M$ME DCB;
       20     1036    1   DCL M$DP DCB;
       21     1037    1   DCL M$DP$ PTR SYMREF;
       22     1038    1   DCL M$LO$ PTR SYMREF;
       23     1039    1   DCL M$SI$ PTR SYMREF;
       24     1040        %F$DCB;
       25     1097        %M$DCB(DCBN=M$CAT,
       26     1098                 NAME=':CAT',
       27     1099                 FUN=CREATE,
       28     1100                 EXIST=OLDFILE,
       29     1101                 ASN=FILE,
       30     1102                 ORG=KEYED,
       31     1103                 ACS=DIRECT,
       32     1104                 SHARE=ALL,
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:10   
       33     1105                 CTG=YES,
       34     1106                 ACCT=':SYS');
       35     1180        %FPT_OPEN(FPTN=OPME,STCLASS=CONSTANT,SCRUB=YES,DCB=M$ME,DVFC='@');
       36     1289        %FPT_PROMPT(FPTN=CONPR,STCLASS=CONSTANT,PROMPT=PROMT);
       37     1317    1   DCL PROMT CHAR(1) CONSTANT INIT('?');
       38     1318    1   DCL FPT_PROMPT(0:2) BIT(72) SYMREF DALIGNED;
       39     1319        %FPT_WRITE(FPTN=WMESS,DCB=M$ME);
       40     1350        %FPT_WRITE(FPTN=WCONT,BUF=CONTMES,DCB=M$ME,STCLASS=CONSTANT);
       41     1381        %FPT_READ(FPTN=CONFIRM,DCB=M$ME,BUF=REPLY,STCLASS=CONSTANT);
       42     1420        %FPT_OPEN(FPTN=LO2LP,STCLASS=CONSTANT,RES='LP',DCB=M$LO);
       43     1529        %FPT_OPEN(FPTN=SI2CG,DCB=M$SI,STCLASS=CONSTANT,
       44     1530        ASN=COMGROUP,SETSTA=PIG,FUN=UPDATE,NAME=CSCG);
       45     1639        %VLP_NAME(FPTN=CSCG,STCLASS=CONSTANT,NAME='CSCG');
       46     1666        %VLP_SETSTA(FPTN=PIG,STCLASS=CONSTANT,MYSTATION='PIG',ILATCH=YES,
       47     1667                    OSTATION='KEYIN');
       48     1695        %M$DCB(DCBN=M$PIGCG,ASN=COMGROUP,NAME='PIGCG',FUN=CREATE,EXIST=OLDFILE,
       49     1696               CTG=YES,SHARE=IN,AU=YES);
       50     1770        %FPT_WAIT(FPTN=WAIT5,STCLASS=CONSTANT,UNITS=5);
       51     1784        %FPT_OPEN(FPTN=FIRSTF,DCB=M$DP,STCLASS=CONSTANT,NXTF=YES,NAME=ERASE,ASN=FILE,
       52     1785              FUN=IN,TEST=YES);
       53     1894        %FPT_OPEN(FPTN=DELNXT,DCB=M$DP,STCLASS=CONSTANT,NXTF=YES,THISF=YES,DELETE=YES);
       54     2003        %FPT_READ(FPTN=RCAT,DCB=M$CAT,KEYS=YES,KEY=PSNKEY,BUF=FX$PSN,STCLASS=CONSTANT);
       55     2042    1   DCL 1 PSNKEY STATIC,
       56     2043    1         2 L UBIN(9)UNAL INIT(11),
       57     2044    1         2 PSN CHAR(7),
       58     2045    1         2 VSN BIT(36),
       59     2046    1         2 CVSN REDEF VSN CHAR(4);
       60     2047    1   DCL OPENTYPE UBIN; /* DPNN, VSN, VSNN, PSN */
       61     2048    1   DCL REPLY CHAR(4) STATIC INIT('X');
       62     2049    1   DCL VIDMES CHAR(0) STATIC INIT(
       63     2050    1   'NNNNNNNNA IS NOT A SCRATCH PACK');
       64     2051    1   DCL CONTMES CONSTANT CHAR(0) INIT(
       65     2052    1   ' - Y TO CONTINUE');
       66     2053    1   DCL DELFMES CHAR(0)STATIC INIT(
       67     2054    1   '999999 GRANULES WILL BE DELETED');
       68     2055    1   DCL DELMMES CHAR(0)CONSTANT INIT(
       69     2056    1   'MASTER ACCOUNT DIRECTORY TO BE DESTROYED');
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:11   
       70     2057    1   DCL NOINTMES CHAR(0) CONSTANT INIT(
       71     2058    1   ' **** INTERACTIVE REPLY REQUIRED');
       72     2059    2      IF ADDR(VID)=ADDR(VIDBUF) THEN DO;/* CHECK VID */

   2059  9 000002   000000 236000 10                 LDQ     0
         9 000003   200003 116100                    CMPQ    @VID,,AUTO
         9 000004   000202 601000 9                  TNZ     s:2091

       73     2060    2         IF SUBSTR(M$DP$->F$DCB.PSN#,0,1)=BINASC(0) THEN OPENTYPE=1;

   2060  9 000005   000000 470400 xsym               LDP0    M$DP$
         9 000006   000024 236100                    LDQ     20,,PR0
         9 000007   777000 376003                    ANQ     -512,DU
         9 000010   000000 116003                    CMPQ    0,DU
         9 000011   000015 601000 9                  TNZ     s:2061

   2060  9 000012   000001 235007                    LDA     1,DL
         9 000013   200004 755100                    STA     OPENTYPE,,AUTO
         9 000014   000034 710000 9                  TRA     s:2064

       74     2061    2         ELSE IF M$DP$->F$DCB.PSN#>' ' THEN OPENTYPE=3;

   2061  9 000015   040100 106400                    CMPC    fill='040'O
         9 000016   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000017   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         9 000020   000024 603000 9                  TRC     s:2062

   2061  9 000021   000003 235007                    LDA     3,DL
         9 000022   200004 755100                    STA     OPENTYPE,,AUTO
         9 000023   000034 710000 9                  TRA     s:2064

       75     2062    2         ELSE IF SUBSTR(M$DP$->F$DCB.PSN#,4,1)~=' ' THEN OPENTYPE=0;

   2062  9 000024   000025 236100                    LDQ     21,,PR0
         9 000025   777000 376003                    ANQ     -512,DU
         9 000026   040000 116003                    CMPQ    16384,DU
         9 000027   000032 600000 9                  TZE     s:2063
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:12   

   2062  9 000030   200004 450100                    STZ     OPENTYPE,,AUTO
         9 000031   000034 710000 9                  TRA     s:2064

       76     2063    2         ELSE OPENTYPE=2;

   2063  9 000032   000002 235007                    LDA     2,DL
         9 000033   200004 755100                    STA     OPENTYPE,,AUTO

       77     2064    2         IF VIDBUF.ID~='CP6' THEN CALL CONCAT(VIDMES,

   2064  9 000034   040000 106400                    CMPC    fill='040'O
         9 000035   000000 000004 xsym               ADSC9   VIDBUF                   cn=0,n=4
         9 000036   000600 000003 7                  ADSC9   NOINTMES+8               cn=0,n=3
         9 000037   000051 600000 9                  TZE     s:2066

   2064  9 000040   000024 235100                    LDA     20,,PR0
         9 000041   000025 236100                    LDQ     21,,PR0
         9 000042   000033 773000                    LRL     27
         9 000043   000027 376000 xsym               ANQ     B_VECTNIL+23
         9 000044   000026 756000 1                  STQ     VIDMES
         9 000045   040000 100400                    MLR     fill='040'O
         9 000046   000601 000026 7                  ADSC9   NOINTMES+9               cn=0,n=22
         9 000047   000027 000033 1                  ADSC9   VIDMES+1                 cn=0,n=27
         9 000050   000177 710000 9                  TRA     s:2089

       78     2065    2           SUBSTR(M$DP$->F$DCB.PSN#,1,4),' IS NOT A CP6 DISKPACK');
       79     2066    2         ELSE IF VIDBUF.VOLCNT=0 AND (OPENTYPE>1 /* VSNN OR PSN */

   2066  9 000051   000004 720000 xsym               LXL0    VIDBUF+4
         9 000052   000064 601000 9                  TNZ     s:2070
         9 000053   200004 235100                    LDA     OPENTYPE,,AUTO
         9 000054   000002 115007                    CMPA    2,DL
         9 000055   000063 603000 9                  TRC     s:2068
         9 000056   000011 236000 xsym               LDQ     VIDBUF+9
         9 000057   000063 600000 9                  TZE     s:2068
         9 000060   000063 604000 9                  TMI     s:2068
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:13   
         9 000061   000041 116100                    CMPQ    33,,PR0
         9 000062   000064 604000 9                  TMI     s:2070

       80     2067    2           OR VIDBUF.SECTSTRT(1)=0
       81     2068    2           OR VIDBUF.SECTSTRT(1)>=M$DP$->F$DCB.IXTNSIZE#) THEN RETURN;

   2068  9 000063   000000 702200 xent               TSX2  ! X66_ARET

       82     2069    3         ELSE DO;

       83     2070    3            PSNKEY.PSN=VIDBUF.PSN;

   2070  9 000064   040000 100400                    MLR     fill='040'O
         9 000065   000003 000006 xsym               ADSC9   VIDBUF+3                 cn=0,n=6
         9 000066   000022 200007 1                  ADSC9   PSNKEY                   cn=1,n=7

       84     2071    3            PSNKEY.VSN=VIDBUF.SNLIST.VSN(0);

   2071  9 000067   000500 236000 xsym               LDQ     VIDBUF+320
         9 000070   000024 756000 1                  STQ     PSNKEY+2

       85     2072    3            FX$PSN='0'B;

   2072  9 000071   000000 100400                    MLR     fill='000'O
         9 000072   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 000073   000000 000024 1                  ADSC9   FX$PSN                   cn=0,n=20

       86     2073    3            IF NOT DCBADDR(DCBNUM(M$CAT))->F$DCB.AMR#

   2073  9 000074   000000 236007 xsym               LDQ     M$CAT,DL
         9 000075   000001 471400 10                 LDP1    1
         9 000076   100000 473500                    LDP3    0,,PR1
         9 000077   300000 474506                    LDP4    0,QL,PR3
         9 000100   400031 236100                    LDQ     25,,PR4
         9 000101   010000 316007                    CANQ    4096,DL
         9 000102   000107 601000 9                  TNZ     IDGAS

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:14   
       87     2074    3            THEN CALL M$READ(RCAT)ALTRET(IDGAS);

   2074  9 000103   000534 630400 7                  EPPR0   RCAT
         9 000104   440000 713400                    CLIMB   alt,read
         9 000105   401400 401760                    pmme    nvectors=4
         9 000106   000107 702000 9                  TSX2    IDGAS

       88     2075    3   IDGAS:   IF FX$PSN.DEFMOUNT=%SCRATCH# AND (OPENTYPE>1

   2075  9 000107   000002 235000 1     IDGAS        LDA     FX$PSN+2
         9 000110   000001 115007                    CMPA    1,DL
         9 000111   000125 601000 9                  TNZ     s:2078
         9 000112   200004 236100                    LDQ     OPENTYPE,,AUTO
         9 000113   000002 116007                    CMPQ    2,DL
         9 000114   000124 603000 9                  TRC     s:2077
         9 000115   000011 235000 xsym               LDA     VIDBUF+9
         9 000116   000124 600000 9                  TZE     s:2077
         9 000117   000000 470400 xsym               LDP0    M$DP$
         9 000120   000011 236000 xsym               LDQ     VIDBUF+9
         9 000121   000124 604000 9                  TMI     s:2077
         9 000122   000041 116100                    CMPQ    33,,PR0
         9 000123   000125 604000 9                  TMI     s:2078

       89     2076    3              OR VIDBUF.SECTSTRT(1)=0
       90     2077    3              OR VIDBUF.SECTSTRT(1)>=M$DP$->F$DCB.IXTNSIZE#) THEN RETURN;

   2077  9 000124   000000 702200 xent               TSX2  ! X66_ARET

       91     2078    3            CALL BINCHAR(SUBSTR(VIDMES,0,8),VIDBUF.VSN);

   2078  9 000125   000002 235000 xsym               LDA     VIDBUF+2
         9 000126   000044 773000                    LRL     36
         9 000127   200006 757100                    STAQ    OPENTYPE+2,,AUTO
         9 000130   000000 301500                    BTD
         9 000131   200006 000010                    NDSC9   OPENTYPE+2,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 000132   000026 030010 1                  NDSC9   VIDMES                   cn=0,s=nosgn,sf=0,n=8

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:15   
       92     2079    3            CALL EDITCHAR(VIDMES,0,7,'107'O,SUBSTR(VIDMES,0,8));

   2079  9 000133   000000 024400                    MVNE
         9 000134   000026 030010 1                  NDSC9   VIDMES                   cn=0,s=nosgn,sf=0,n=8
         9 000135   000002 000001 10                 ADSC9   2                        cn=0,n=1
         9 000136   000026 000007 1                  ADSC9   VIDMES                   cn=0,n=7

       93     2080    3            IF OPENTYPE=2 THEN PSNKEY.CVSN=M$DP$->F$DCB.PSN#;

   2080  9 000137   200004 235100                    LDA     OPENTYPE,,AUTO
         9 000140   000002 115007                    CMPA    2,DL
         9 000141   000145 601000 9                  TNZ     s:2081

   2080  9 000142   000000 470400 xsym               LDP0    M$DP$
         9 000143   000024 236100                    LDQ     20,,PR0
         9 000144   000024 756000 1                  STQ     PSNKEY+2

       94     2081    3            IF OPENTYPE>=2 THEN CALL INSERT(VIDMES,8,,

   2081  9 000145   000002 115007                    CMPA    2,DL
         9 000146   000161 602000 9                  TNC     s:2084

   2081  9 000147   000024 236000 1                  LDQ     PSNKEY+2
         9 000150   000033 772000                    QRL     27
         9 000151   000100 036007                    ADLQ    64,DL
         9 000152   000033 736000                    QLS     27
         9 000153   000003 276000 10                 ORQ     3
         9 000154   000030 552040 1                  STBQ    VIDMES+2,'40'O
         9 000155   040000 100400                    MLR     fill='040'O
         9 000156   000607 000026 7                  ADSC9   NOINTMES+15              cn=0,n=22
         9 000157   000030 200026 1                  ADSC9   VIDMES+2                 cn=1,n=22
         9 000160   000177 710000 9                  TRA     s:2089

       95     2082    3              BINASC(ASCBIN(SUBSTR(PSNKEY.CVSN,0,1))+ASCBIN('@')),
       96     2083    3              ' IS NOT A SCRATCH PACK');
       97     2084    3            ELSE IF VIDBUF.SECTSTRT(1)>=M$DP$->F$DCB.IXTNSIZE#

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:16   
   2084  9 000161   000000 470400 xsym               LDP0    M$DP$
         9 000162   000011 236000 xsym               LDQ     VIDBUF+9
         9 000163   000170 604000 9                  TMI     s:2085
         9 000164   000041 116100                    CMPQ    33,,PR0
         9 000165   000170 605000 9                  TPL     s:2085
         9 000166   000000 116003                    CMPQ    0,DU
         9 000167   000174 601000 9                  TNZ     s:2087

       98     2085    3              OR VIDBUF.SECTSTRT(1)=0 THEN CALL INSERT(VIDMES,8,,

   2085  9 000170   040000 100400                    MLR     fill='040'O
         9 000171   000607 000026 7                  ADSC9   NOINTMES+15              cn=0,n=22
         9 000172   000030 000027 1                  ADSC9   VIDMES+2                 cn=0,n=23
         9 000173   000177 710000 9                  TRA     s:2089

       99     2086    3              ' IS NOT A SCRATCH PACK');
      100     2087    3            ELSE CALL INSERT(VIDMES,8,,' HAS MANY SECTIONS');

   2087  9 000174   040000 100400                    MLR     fill='040'O
         9 000175   000615 000022 7                  ADSC9   NOINTMES+21              cn=0,n=18
         9 000176   000030 000027 1                  ADSC9   VIDMES+2                 cn=0,n=23

      101     2088    3            END;

      102     2089    2         WMESS.BUF_=VECTOR(VIDMES);

   2089  9 000177   000004 237000 10                 LDAQ    4
         9 000200   000012 757000 1                  STAQ    WMESS+4

      103     2090    2         END;

   2090  9 000201   000250 710000 9                  TRA     s:2102

      104     2091    1      ELSE IF VID=0 THEN WMESS.BUF_=VECTOR(DELMMES);

   2091  9 000202   200003 470500                    LDP0    @VID,,AUTO
         9 000203   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:17   
         9 000204   000210 601000 9                  TNZ     s:2093

   2091  9 000205   000006 237000 10                 LDAQ    6
         9 000206   000012 757000 1                  STAQ    WMESS+4
         9 000207   000250 710000 9                  TRA     s:2102

      105     2092    2      ELSE DO;

      106     2093    2         IF M$DP$->F$DCB.IASN~=%FMDIAG# THEN RETURN; /* DELETE WONT WORK */

   2093  9 000210   000000 471400 xsym               LDP1    M$DP$
         9 000211   100103 236100                    LDQ     67,,PR1
         9 000212   000777 376007                    ANQ     511,DL
         9 000213   000007 116007                    CMPQ    7,DL
         9 000214   000216 600000 9                  TZE     s:2094

   2093  9 000215   000000 702200 xent               TSX2  ! X66_ARET

      107     2094    2         CALL M$OPEN(FIRSTF) ALTRET(RETRET);

   2094  9 000216   000350 630400 7                  EPPR0   FIRSTF
         9 000217   450000 713400                    CLIMB   alt,open
         9 000220   410400 401760                    pmme    nvectors=18
         9 000221   000347 702000 9                  TSX2    RETRET

      108     2095    3         IF NOT M$SI$->F$DCB.DDEV.IC# THEN DO WHILE('1'B);

   2095  9 000222   000000 470400 xsym               LDP0    M$SI$
         9 000223   000004 236100                    LDQ     4,,PR0
         9 000224   100000 316007                    CANQ    32768,DL
         9 000225   000233 601000 9                  TNZ     s:2098

      109     2096    3   DELFILES: CALL M$OPEN(DELNXT) ALTRET(RETRET);

   2096  9 000226   000442 630400 7     DELFILES     EPPR0   DELNXT
         9 000227   450000 713400                    CLIMB   alt,open
         9 000230   410400 401760                    pmme    nvectors=18
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:18   
         9 000231   000347 702000 9                  TSX2    RETRET

      110     2097    3            END;

   2097  9 000232   000226 710000 9                  TRA     DELFILES

      111     2098    2         CALL BINCHAR(SUBSTR(DELFMES,0,6),VID);

   2098  9 000233   200003 471500                    LDP1    @VID,,AUTO
         9 000234   100000 235100                    LDA     0,,PR1
         9 000235   000044 773000                    LRL     36
         9 000236   200006 757100                    STAQ    OPENTYPE+2,,AUTO
         9 000237   000000 301500                    BTD
         9 000240   200006 000010                    NDSC9   OPENTYPE+2,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 000241   000036 030006 1                  NDSC9   DELFMES                  cn=0,s=nosgn,sf=0,n=6

      112     2099    2         CALL EDITCHAR(DELFMES,0,5,'105'O,SUBSTR(DELFMES,0,6));

   2099  9 000242   000000 024400                    MVNE
         9 000243   000036 030006 1                  NDSC9   DELFMES                  cn=0,s=nosgn,sf=0,n=6
         9 000244   000010 000001 10                 ADSC9   8                        cn=0,n=1
         9 000245   000036 000005 1                  ADSC9   DELFMES                  cn=0,n=5

      113     2100    2         WMESS.BUF_=VECTOR(DELFMES);

   2100  9 000246   000012 237000 10                 LDAQ    10
         9 000247   000012 757000 1                  STAQ    WMESS+4

      114     2101    2         END;

      115     2102    1      IF NOT DCBADDR(DCBNUM(M$ME))->F$DCB.FCD# THEN CALL M$OPEN(OPME);

   2102  9 000250   000000 236007 xsym               LDQ     M$ME,DL
         9 000251   000001 470400 10                 LDP0    1
         9 000252   000000 471500                    LDP1    0,,PR0
         9 000253   100000 473506                    LDP3    0,QL,PR1
         9 000254   300031 236100                    LDQ     25,,PR3
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:19   
         9 000255   020000 316007                    CANQ    8192,DL
         9 000256   000262 601000 9                  TNZ     s:2103

   2102  9 000257   000000 630400 7                  EPPR0   OPME
         9 000260   050000 713400                    CLIMB   open
         9 000261   410400 401760                    pmme    nvectors=18

      116     2103    1      CALL M$WRITE(WMESS);

   2103  9 000262   000006 630400 1                  EPPR0   WMESS
         9 000263   040001 713400                    CLIMB   write
         9 000264   401400 401760                    pmme    nvectors=4

      117     2104    1      REPLY=' ';

   2104  9 000265   000035 236000 xsym               LDQ     B_VECTNIL+29
         9 000266   000025 756000 1                  STQ     REPLY

      118     2105    2      IF M$SI$->F$DCB.DDEV.IC# AND NOT M$SI$->F$DCB.DDEV.XEQ# THEN DO;

   2105  9 000267   000000 470400 xsym               LDP0    M$SI$
         9 000270   000004 236100                    LDQ     4,,PR0
         9 000271   100000 316007                    CANQ    32768,DL
         9 000272   000327 600000 9                  TZE     s:2117
         9 000273   040000 316007                    CANQ    16384,DL
         9 000274   000327 601000 9                  TNZ     s:2117

      119     2106    3         IF NOT M$LO$->F$DCB.DDEV.IC# THEN DO;

   2106  9 000275   000000 471400 xsym               LDP1    M$LO$
         9 000276   100004 236100                    LDQ     4,,PR1
         9 000277   100000 316007                    CANQ    32768,DL
         9 000300   000312 601000 9                  TNZ     s:2111

      120     2107    3            WMESS.V.DCB#=DCBNUM(M$LO);

   2107  9 000301   000000 236007 xsym               LDQ     M$LO,DL
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:20   
         9 000302   000000 620006                    EAX0    0,QL
         9 000303   000016 740000 1                  STX0    WMESS+8

      121     2108    3            CALL M$WRITE(WMESS);

   2108  9 000304   000006 630400 1                  EPPR0   WMESS
         9 000305   040001 713400                    CLIMB   write
         9 000306   401400 401760                    pmme    nvectors=4

      122     2109    3            WMESS.V.DCB#=DCBNUM(M$ME);

   2109  9 000307   000000 236007 xsym               LDQ     M$ME,DL
         9 000310   000000 620006                    EAX0    0,QL
         9 000311   000016 740000 1                  STX0    WMESS+8

      123     2110    3            END;

      124     2111    2         CALL M$WRITE(WCONT);

   2111  9 000312   000106 630400 7                  EPPR0   WCONT
         9 000313   040001 713400                    CLIMB   write
         9 000314   401400 401760                    pmme    nvectors=4

      125     2112    2         CALL M$PROMPT(CONPR);

   2112  9 000315   000072 630400 7                  EPPR0   CONPR
         9 000316   160002 713400                    CLIMB   57346
         9 000317   401000 401760                    pmme    nvectors=3

      126     2113    2         CALL M$READ(CONFIRM);

   2113  9 000320   000122 630400 7                  EPPR0   CONFIRM
         9 000321   040000 713400                    CLIMB   read
         9 000322   401400 401760                    pmme    nvectors=4

      127     2114    2         CALL M$PROMPT(FPT_PROMPT);

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:21   
   2114  9 000323   000000 630400 xsym               EPPR0   FPT_PROMPT
         9 000324   160002 713400                    CLIMB   57346
         9 000325   401000 401760                    pmme    nvectors=3

      128     2115    2         END;

   2115  9 000326   000334 710000 9                  TRA     s:2120

      129     2116    2      ELSE DO;

      130     2117    2         WMESS.BUF_=VECTOR(NOINTMES);

   2117  9 000327   000014 237000 10                 LDAQ    12
         9 000330   000012 757000 1                  STAQ    WMESS+4

      131     2118    2         CALL M$WRITE(WMESS);

   2118  9 000331   000006 630400 1                  EPPR0   WMESS
         9 000332   040001 713400                    CLIMB   write
         9 000333   401400 401760                    pmme    nvectors=4

      132     2119    2         END;

      133     2120    1      REPLY=SUBSTR(REPLY,0,1);

   2120  9 000334   000025 236000 1                  LDQ     REPLY
         9 000335   777000 376003                    ANQ     -512,DU
         9 000336   000003 276000 10                 ORQ     3
         9 000337   000025 756000 1                  STQ     REPLY

      134     2121    2      IF REPLY='Y' OR REPLY='y' THEN DO;

   2121  9 000340   000011 116000 10                 CMPQ    9
         9 000341   000344 600000 9                  TZE     s:2122
         9 000342   000016 116000 10                 CMPQ    14
         9 000343   000350 601000 9                  TNZ     s:2125

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:22   
      135     2122    2         IF WMESS.BUF_=VECTOR(DELFMES) THEN GOTO DELFILES;

   2122  9 000344   000012 237000 1                  LDAQ    WMESS+4
         9 000345   000012 117000 10                 CMPAQ   10
         9 000346   000226 600000 9                  TZE     DELFILES

      136     2123    2   RETRET: RETURN;

   2123  9 000347   000000 702200 xent  RETRET       TSX2  ! X66_ARET

      137     2124    2         END;
      138     2125    1      ALTRETURN;

   2125  9 000350   000000 702200 xent               TSX2  ! X66_AALT

      139     2126        %EJECT;
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:23   
      140     2127    1   FXU$GINIT: ENTRY ALTRET;

   2127  9 000351   000000 700200 xent  FXU$GINIT    TSX0  ! X66_AUTO_1
         9 000352   000010 000001                    ZERO    8,1

      141     2128    1      CALL M$OPEN(LO2LP)ALTRET(WAIT);

   2128  9 000353   000140 630400 7                  EPPR0   LO2LP
         9 000354   450000 713400                    CLIMB   alt,open
         9 000355   410400 401760                    pmme    nvectors=18
         9 000356   000364 702000 9                  TSX2    WAIT

      142     2129    1      CALL M$OPEN(SI2CG)ALTRET(WAIT);

   2129  9 000357   000232 630400 7                  EPPR0   SI2CG
         9 000360   450000 713400                    CLIMB   alt,open
         9 000361   410400 401760                    pmme    nvectors=18
         9 000362   000364 702000 9                  TSX2    WAIT

      143     2130    1      RETURN;

   2130  9 000363   000000 702200 xent               TSX2  ! X66_ARET

   2129  9 000364                       WAIT         null
      144     2131    1   WAIT: ;
      145     2132    1      CALL M$WAIT(WAIT5);

   2132  9 000364   000342 630400 7                  EPPR0   WAIT5
         9 000365   020006 713400                    CLIMB   8198
         9 000366   400400 401760                    pmme    nvectors=2

      146     2133    1      CALL M$RETRY;

   2133  9 000367   010010 713400                    CLIMB   4104
         9 000370   000000 401760                    pmme    nvectors=0

      147     2134    1   END;
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:24   

   2134  9 000371   000000 702200 xent               TSX2  ! X66_ARET
      148     2135        %EOD;

PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:25   
--  Include file information  --

   FX$CAT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   FM$MACROS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$PROTCHK.
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:26   

 **** Variables and constants ****

  ****  Section 001  Data  FXU$PROTCHK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/c CHAR(31)    r     1 DELFMES                    0-0-0/w STRC(180)   r     1 FX$PSN
    22-0-0/c STRC(108)   r     1 PSNKEY                    25-0-0/c CHAR(4)     r     1 REPLY
    26-0-0/c CHAR(31)    r     1 VIDMES                     6-0-0/d STRC(432)   r     1 WMESS

  ****  Section 007 RoData FXU$PROTCHK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   122-0-0/d STRC(504)   r     1 CONFIRM                   72-0-0/d STRC(360)   r     1 CONPR
   552-0-0/c CHAR(16)    r     1 CONTMES                  324-0-0/c STRC(45)    r     1 CSCG
   556-0-0/c CHAR(40)    r     1 DELMMES                  442-0-0/d STRC(2088)  r     1 DELNXT
   350-0-0/d STRC(2088)  r     1 FIRSTF                   140-0-0/d STRC(2088)  r     1 LO2LP
   570-0-0/c CHAR(32)    r     1 NOINTMES                   0-0-0/d STRC(2088)  r     1 OPME
   326-0-0/w STRC(432)   r     1 PIG                      104-0-0/c CHAR        r     1 PROMT
   534-0-0/d STRC(504)   r     1 RCAT                     232-0-0/d STRC(2088)  r     1 SI2CG
   342-0-0/d STRC(216)   r     1 WAIT5                    106-0-0/d STRC(432)   r     1 WCONT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @VID                       4-0-0/w UBIN        r     1 OPENTYPE
    *0-0-0/w UBIN        r     1 VID

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:27   

     0-0-0/d BIT (72)    r     1 FPT_PROMPT(0:2)
     0-0-0/w PTR         r     1 M$DP$                      0-0-0/w PTR         r     1 M$LO$
     0-0-0/w PTR         r     1 M$SI$                      0-0-0/w STRC(36864) r     1 VIDBUF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d ASTR(3528)  r     1 M$CAT
     0-0-0N  NULL        r     1 M$DP                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$ME                       0-0-0/d ASTR(3528)  r     1 M$PIGCG
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC


   Procedure FXU$PROTCHK requires 250 words for executable code.
   Procedure FXU$PROTCHK requires 8 words of local(AUTO) storage.
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:28   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:29   
          MINI XREF LISTING

CONFIRM
      1398**DCL      2113<>CALL
CONFIRM.STATION_
      1401**DCL      1402--REDEF
CONFIRM.V
      1402**DCL      1398--DCLINIT
CONFIRM.V.DVBYTE.REREAD#
      1413**DCL      1413--REDEF
CONFIRM.V.INDX#
      1411**DCL      1411--REDEF
CONPR
      1305**DCL      2112<>CALL
CONPR.V
      1313**DCL      1307--DCLINIT
CONTMES
      2051**DCL      1368--DCLINIT  1369--DCLINIT
CSCG
      1664**DCL      1596--DCLINIT
DELFILES
      2096**LABEL    2122--GOTO
DELFMES
      2053**DCL      2098<<CALLBLT  2099<<CALLBLT  2099>>CALLBLT  2100--ASSIGN   2122--IF
DELMMES
      2055**DCL      2091--ASSIGN
DELNXT
      1959**DCL      2096<>CALL
DELNXT.ACSVEH_
      1961**DCL      1962--REDEF
DELNXT.ALTKEYS_
      1967**DCL      1968--REDEF    1968--REDEF
DELNXT.HDR_
      1966**DCL      1967--REDEF
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:30   
DELNXT.TAB_
      1965**DCL      1966--REDEF
DELNXT.UHL_
      1959**DCL      1960--REDEF    1960--REDEF
DELNXT.V
      1968**DCL      1959--DCLINIT
DELNXT.V.FSN#
      1999**DCL      1999--REDEF    1999--REDEF
DELNXT.WSN_
      1965**DCL      1965--REDEF
F$DCB.ACTPOS
      1073**DCL      1073--REDEF
F$DCB.AMR#
      1060**DCL      2073>>IF
F$DCB.ARS#
      1047**DCL      1047--REDEF
F$DCB.ATTR
      1066**DCL      1067--REDEF
F$DCB.BORROW
      1081**DCL      1081--REDEF    1081--REDEF    1081--REDEF
F$DCB.DCBNAME.L
      1095**DCL      1095--IMP-SIZ
F$DCB.DDEV.IC#
      1053**DCL      2095>>IF       2105>>IF       2106>>IF
F$DCB.DDEV.XEQ#
      1054**DCL      2105>>IF
F$DCB.EOMCHAR#
      1051**DCL      1051--REDEF
F$DCB.FCD#
      1060**DCL      2102>>IF
F$DCB.FLDID
      1076**DCL      1076--REDEF
F$DCB.FORM$
      1070**DCL      1070--REDEF
F$DCB.FSECT
      1086**DCL      1086--REDEF
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:31   
F$DCB.FSN#
      1063**DCL      1063--REDEF    1063--REDEF    1064--REDEF
F$DCB.HEADER$
      1069**DCL      1069--REDEF
F$DCB.IASN
      1090**DCL      2093>>IF
F$DCB.IXTNSIZE#
      1067**DCL      1067--REDEF    2066>>IF       2075>>IF       2084>>IF
F$DCB.LASTSTA$
      1056**DCL      1056--REDEF
F$DCB.LVL
      1082**DCL      1082--REDEF
F$DCB.NAME#.C
      1057**DCL      1057--REDEF
F$DCB.NOEOF
      1079**DCL      1079--REDEF
F$DCB.NRECS#
      1068**DCL      1068--REDEF
F$DCB.NRECX
      1087**DCL      1087--REDEF
F$DCB.OHDR
      1079**DCL      1079--REDEF
F$DCB.ORG#
      1062**DCL      1062--REDEF
F$DCB.PRECNO
      1085**DCL      1085--REDEF
F$DCB.PSN#
      1057**DCL      2060>>IF       2061>>IF       2062>>IF       2064>>CALLBLT  2080>>ASSIGN
F$DCB.RCSZ
      1091**DCL      1091--REDEF
F$DCB.RES#
      1058**DCL      1058--REDEF
F$DCB.SETX
      1070**DCL      1070--REDEF
F$DCB.TAB$
      1070**DCL      1070--REDEF
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:32   
F$DCB.TDA
      1084**DCL      1085--REDEF
F$DCB.WSN#
      1058**DCL      1058--REDEF
FIRSTF
      1850**DCL      2094<>CALL
FIRSTF.ACSVEH_
      1852**DCL      1853--REDEF
FIRSTF.ALTKEYS_
      1858**DCL      1859--REDEF    1859--REDEF
FIRSTF.HDR_
      1857**DCL      1858--REDEF
FIRSTF.TAB_
      1856**DCL      1857--REDEF
FIRSTF.UHL_
      1850**DCL      1851--REDEF    1851--REDEF
FIRSTF.V
      1859**DCL      1850--DCLINIT
FIRSTF.V.FSN#
      1890**DCL      1890--REDEF    1890--REDEF
FIRSTF.WSN_
      1856**DCL      1856--REDEF
FPT_PROMPT
      1318**DCL      2114<>CALL
FX$PSN
      1031**DCL      2022--DCLINIT  2023--DCLINIT  2072<<ASSIGN
FX$PSN.DEFMOUNT
      1031**DCL      2075>>IF
IDGAS
      2075**LABEL    2074--CALLALT
LO2LP
      1485**DCL      2128<>CALL
LO2LP.ACSVEH_
      1487**DCL      1488--REDEF
LO2LP.ALTKEYS_
      1493**DCL      1494--REDEF    1494--REDEF
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:33   
LO2LP.HDR_
      1492**DCL      1493--REDEF
LO2LP.TAB_
      1491**DCL      1492--REDEF
LO2LP.UHL_
      1485**DCL      1486--REDEF    1486--REDEF
LO2LP.V
      1494**DCL      1485--DCLINIT
LO2LP.V.FSN#
      1525**DCL      1525--REDEF    1525--REDEF
LO2LP.WSN_
      1491**DCL      1491--REDEF
M$CAT
      1107**DCL      2073--IF
M$CAT.ACTPOS
      1148**DCL      1148--REDEF
M$CAT.ARS#
      1107**DCL      1107--REDEF
M$CAT.ATTR#
      1137**DCL      1137--REDEF    1139--REDEF
M$CAT.BORROW
      1159**DCL      1159--REDEF    1159--REDEF    1159--REDEF
M$CAT.DCBNAME.L
      1178**DCL      1178--IMP-SIZ  2073>>IF
M$CAT.EOMCHAR#
      1114**DCL      1115--REDEF
M$CAT.FLDID
      1151**DCL      1152--REDEF
M$CAT.FORM$
      1143**DCL      1143--REDEF
M$CAT.FSECT
      1166**DCL      1166--REDEF
M$CAT.FSN#
      1133**DCL      1133--REDEF    1133--REDEF    1134--REDEF
M$CAT.HEADER$
      1142**DCL      1143--REDEF
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:34   
M$CAT.IXTNSIZE#
      1139**DCL      1140--REDEF
M$CAT.LASTSTA$
      1123**DCL      1123--REDEF
M$CAT.LVL
      1160**DCL      1160--REDEF
M$CAT.NAME#.C
      1123**DCL      1124--REDEF
M$CAT.NOEOF
      1155**DCL      1155--REDEF
M$CAT.NRECS#
      1140**DCL      1140--REDEF
M$CAT.NRECX
      1167**DCL      1167--REDEF
M$CAT.OHDR
      1156**DCL      1156--REDEF
M$CAT.ORG#
      1131**DCL      1132--REDEF
M$CAT.PRECNO
      1164**DCL      1164--REDEF
M$CAT.RCSZ
      1172**DCL      1172--REDEF
M$CAT.RES#
      1125**DCL      1125--REDEF
M$CAT.SETX
      1144**DCL      1144--REDEF
M$CAT.TAB$
      1143**DCL      1143--REDEF
M$CAT.TDA
      1163**DCL      1164--REDEF
M$CAT.WSN#
      1125**DCL      1126--REDEF
M$DP$
      1037**DCL      2060>>IF       2061>>IF       2062>>IF       2064>>CALLBLT  2066>>IF       2075>>IF
      2080>>ASSIGN   2084>>IF       2093>>IF
M$LO
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:35   
      1033**DCL      2107>>ASSIGN
M$LO$
      1038**DCL      2106>>IF
M$ME
      1035**DCL      2102--IF       2109>>ASSIGN
M$OPEN
       401**DCL-ENT  2094--CALL     2096--CALL     2102--CALL     2128--CALL     2129--CALL
M$PIGCG.ACTPOS
      1738**DCL      1738--REDEF
M$PIGCG.ARS#
      1697**DCL      1697--REDEF
M$PIGCG.ATTR#
      1727**DCL      1727--REDEF    1729--REDEF
M$PIGCG.BORROW
      1749**DCL      1749--REDEF    1749--REDEF    1749--REDEF
M$PIGCG.DCBNAME.L
      1768**DCL      1768--IMP-SIZ
M$PIGCG.EOMCHAR#
      1704**DCL      1705--REDEF
M$PIGCG.FLDID
      1741**DCL      1742--REDEF
M$PIGCG.FORM$
      1733**DCL      1733--REDEF
M$PIGCG.FSECT
      1756**DCL      1756--REDEF
M$PIGCG.FSN#
      1723**DCL      1723--REDEF    1723--REDEF    1724--REDEF
M$PIGCG.HEADER$
      1732**DCL      1733--REDEF
M$PIGCG.IXTNSIZE#
      1729**DCL      1730--REDEF
M$PIGCG.LASTSTA$
      1713**DCL      1713--REDEF
M$PIGCG.LVL
      1750**DCL      1750--REDEF
M$PIGCG.NAME#.C
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:36   
      1713**DCL      1714--REDEF
M$PIGCG.NOEOF
      1745**DCL      1745--REDEF
M$PIGCG.NRECS#
      1730**DCL      1730--REDEF
M$PIGCG.NRECX
      1757**DCL      1757--REDEF
M$PIGCG.OHDR
      1746**DCL      1746--REDEF
M$PIGCG.ORG#
      1721**DCL      1722--REDEF
M$PIGCG.PRECNO
      1754**DCL      1754--REDEF
M$PIGCG.RCSZ
      1762**DCL      1762--REDEF
M$PIGCG.RES#
      1715**DCL      1715--REDEF
M$PIGCG.SETX
      1734**DCL      1734--REDEF
M$PIGCG.TAB$
      1733**DCL      1733--REDEF
M$PIGCG.TDA
      1753**DCL      1754--REDEF
M$PIGCG.WSN#
      1715**DCL      1716--REDEF
M$PROMPT
       425**DCL-ENT  2112--CALL     2114--CALL
M$READ
       402**DCL-ENT  2074--CALL     2113--CALL
M$RETRY
       458**DCL-ENT  2133--CALL
M$SI$
      1039**DCL      2095>>IF       2105>>IF       2105>>IF
M$WAIT
       459**DCL-ENT  2132--CALL
M$WRITE
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:37   
       402**DCL-ENT  2103--CALL     2108--CALL     2111--CALL     2118--CALL
NOINTMES
      2057**DCL      2117--ASSIGN
OPENTYPE
      2047**DCL      2060<<ASSIGN   2061<<ASSIGN   2062<<ASSIGN   2063<<ASSIGN   2066>>IF       2075>>IF
      2080>>IF       2081>>IF
OPME
      1245**DCL      2102<>CALL
OPME.ACSVEH_
      1247**DCL      1248--REDEF
OPME.ALTKEYS_
      1253**DCL      1254--REDEF    1254--REDEF
OPME.HDR_
      1252**DCL      1253--REDEF
OPME.TAB_
      1251**DCL      1252--REDEF
OPME.UHL_
      1245**DCL      1246--REDEF    1246--REDEF
OPME.V
      1254**DCL      1245--DCLINIT
OPME.V.FSN#
      1285**DCL      1285--REDEF    1285--REDEF
OPME.WSN_
      1251**DCL      1251--REDEF
PIG
      1679**DCL      1596--DCLINIT
PROMT
      1317**DCL      1311--DCLINIT
PSNKEY
      2042**DCL      2020--DCLINIT  2021--DCLINIT
PSNKEY.CVSN
      2046**DCL      2080<<ASSIGN   2081>>CALLBLT
PSNKEY.PSN
      2044**DCL      2070<<ASSIGN
PSNKEY.VSN
      2045**DCL      2046--REDEF    2071<<ASSIGN
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:38   
RCAT
      2020**DCL      2074<>CALL
RCAT.STATION_
      2023**DCL      2024--REDEF
RCAT.V
      2024**DCL      2020--DCLINIT
RCAT.V.DVBYTE.REREAD#
      2035**DCL      2035--REDEF
RCAT.V.INDX#
      2033**DCL      2033--REDEF
REPLY
      2048**DCL      1400--DCLINIT  1401--DCLINIT  2104<<ASSIGN   2120<<ASSIGN   2120>>ASSIGN   2121>>IF
      2121>>IF
RETRET
      2123**LABEL    2094--CALLALT  2096--CALLALT
SI2CG
      1595**DCL      2129<>CALL
SI2CG.ACSVEH_
      1597**DCL      1598--REDEF
SI2CG.ALTKEYS_
      1603**DCL      1604--REDEF    1604--REDEF
SI2CG.HDR_
      1602**DCL      1603--REDEF
SI2CG.TAB_
      1601**DCL      1602--REDEF
SI2CG.UHL_
      1595**DCL      1596--REDEF    1596--REDEF
SI2CG.V
      1604**DCL      1595--DCLINIT
SI2CG.V.FSN#
      1635**DCL      1635--REDEF    1635--REDEF
SI2CG.WSN_
      1601**DCL      1601--REDEF
VID
       385**DCL         9--PROC     2059--IF       2091>>IF       2098>>CALLBLT
VIDBUF
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:39   
       387**DCL      2059--IF
VIDBUF.DTT
       389**DCL       389--REDEF
VIDBUF.ID
       387**DCL      2064>>IF
VIDBUF.PSN
       387**DCL      2070>>ASSIGN
VIDBUF.SECTSTRT
       388**DCL      2066>>IF       2066>>IF       2075>>IF       2075>>IF       2084>>IF       2084>>IF
VIDBUF.SNLIST.VSN
       390**DCL      2071>>ASSIGN
VIDBUF.VOLCNT
       387**DCL      2066>>IF
VIDBUF.VSN
       387**DCL      2078>>CALLBLT
VIDMES
      2049**DCL      2064<<CALLBLT  2078<<CALLBLT  2079<<CALLBLT  2079>>CALLBLT  2081<<CALLBLT  2085<<CALLBLT
      2087<<CALLBLT  2089--ASSIGN
WAIT
      2129**LABEL    2128--CALLALT  2129--CALLALT
WAIT5
      1781**DCL      2132<>CALL
WAIT5.V
      1782**DCL      1781--DCLINIT
WCONT
      1367**DCL      2111<>CALL
WCONT.STATION_
      1369**DCL      1369--REDEF
WCONT.V
      1370**DCL      1367--DCLINIT
WCONT.V.DVBYTE.VFC#
      1376**DCL      1376--REDEF
WMESS
      1336**DCL      2103<>CALL     2108<>CALL     2118<>CALL
WMESS.BUF_
      1336**DCL      2089<<ASSIGN   2091<<ASSIGN   2100<<ASSIGN   2117<<ASSIGN   2122>>IF
PL6.E3A0      #001=FXU$PROTCHK File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:33 Page:40   
WMESS.STATION_
      1338**DCL      1338--REDEF
WMESS.V
      1339**DCL      1336--DCLINIT
WMESS.V.DCB#
      1339**DCL      2107<<ASSIGN   2109<<ASSIGN
WMESS.V.DVBYTE.VFC#
      1345**DCL      1345--REDEF

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:41   
      149        1        /*T***********************************************************/
      150        2        /*T*                                                         */
      151        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      152        4        /*T*                                                         */
      153        5        /*T***********************************************************/
      154        6        FXU$CATADM: PROC(PARM)ALTRET;
      155        7        %INCLUDE CP_6;
      156       88        %INCLUDE CP_6_SUBS;
      157      628        %INCLUDE FX$CAT;
      158      645        %INCLUDE FM$MACROS;
      159     1020        %INCLUDE XU_MACRO_C;
      160     4126        %INCLUDE XU_SUBS_C;
      161     4218        %INCLUDE FX_SUBS_C;
      162     4254        %INCLUDE FX_PERR_C;
      163     4313    1   DCL PARM UBIN;
      164     4314        %F$DCB(BASED="BASED(M$DP$)");
      165     4371        %FM$VID(FM$VID=VIDBUF,BASED=SYMREF);
      166     4377        %FX$PSN(FX$PSN=PSNREC,BASED=REDEF VIDBUF,
      167     4378           MAX=1019);
      168     4381        %FX$STAT(FX$STAT=CSTAT,BASED=SYMREF,MAX=510);
      169     4384        %FM$VID(FM$VID=VID1,BASED=REDEF CSTAT);
      170     4390        %SUB FCG#='0630'O;
      171     4391        %SUB MID#='25'O;
      172     4392    1   DCL ERRCODE BIT(36)SYMREF;
      173     4393    1   DCL USW BIT(1)SYMREF;
      174     4394    1   DCL BREAK UBIN SYMREF;
      175     4395        %ERRCODE(NAME=FXU$E$NOVSN,COD#=E$NOVSN);
      176     4399        %ERRCODE(NAME=FXU$E$DUPVSN,COD#=%E$DUPVSN);
      177     4403        %FX$VSN(MAX=25,FX$VSN=VSNREC,BASED=STATIC);
      178     4407    1   DCL 1 PSNKEY STATIC,
      179     4408    1         2 L UBIN(9)INIT(11)UNAL,
      180     4409    1         2 PSN CHAR(7),
      181     4410    1         2 VSN,
      182     4411    1           3 S UBIN(9)UNAL,
      183     4412    1           3 N UBIN(27)UNAL;
      184     4413    1   DCL 1 VSNKEY STATIC,
      185     4414    1         2 * UBIN(9)INIT(3)UNAL,
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:42   
      186     4415    1         2 VSN UBIN(27)UNAL;
      187     4416    1   DCL 1 RKEY STATIC,
      188     4417    1         2 L UBIN(9)UNAL,
      189     4418    1         2 P,
      190     4419    1           3 SN CHAR(7),
      191     4420    1           3 VSN BIT(36),
      192     4421    1         2 V REDEF P,
      193     4422    1           3 SN UBIN(27)UNAL,
      194     4423    1           3 * CHAR(8);
      195     4424        %PARSE$OUT(NAME=PBLK);
      196     4469        %PARSE$SYM(NAME=PSYM);
      197     4507    1   DCL BLK$ PTR SYMREF;
      198     4508        %B$TCB(STCLASS="BASED(B$TCB$)");
      199     4511        %B$ALT;
      200     4519    1   DCL B$TCB$ PTR SYMREF;
      201     4520    1   DCL M$DP$ PTR SYMREF;
      202     4521    1   DCL I UBIN;
      203     4522    1   DCL J UBIN;
      204     4523    1   DCL FXP$RVID ENTRY(1)ALTRET;
      205     4524    1   DCL FXP$PARM ENTRY(1)ALTRET;
      206     4525    1   DCL FXP$PART ENTRY(1)ALTRET;
      207     4526    1   DCL FXP$PARN ENTRY(1)ALTRET;
      208     4527    1   DCL FXP$PRINT ENTRY(1)ALTRET;
      209     4528    1   DCL M$CAT DCB;
      210     4529    1   DCL BASED_PTR BASED PTR;
      211     4530    1   DCL 1 VSNLST STATIC,
      212     4531    1         2 TYPE CHAR(9),
      213     4532    1         2 PSN CHAR(7),
      214     4533    1         2 SIZE CHAR(6),
      215     4534    1         2 VSN CHAR(9),
      216     4535    1         2 * CHAR(1)INIT(' '),
      217     4536    1         2 FLG CHAR(1);
      218     4537    1   DCL 1 VSNTXT CONSTANT,
      219     4538    1         2 * UBIN INIT(SIZEC(VSNLST)),
      220     4539    1         2 * PTR INIT(ADDR(VSNLST));
      221     4540    1   DCL 1 VSNHDR CONSTANT,
      222     4541    1         2 * UBIN INIT(SIZEC(VSNHDR.T)),
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:43   
      223     4542    1         2 * PTR INIT(ADDR(VSNHDR.T)),
      224     4543    1         2 T CHAR(0)INIT(
      225     4544    1           'TYPE     PSN      SIZE      VSN');
      226     4545    1   DCL 1 PSNLST STATIC,
      227     4546    1         2 * CHAR(0)INIT('DP#'),
      228     4547    1         2 PSN CHAR(7),
      229     4548    1         2 MNT CHAR(4);
      230     4549    1   DCL 1 PSNTXT CONSTANT,
      231     4550    1         2 * UBIN INIT(SIZEC(PSNLST)),
      232     4551    1         2 * PTR INIT(ADDR(PSNLST));
      233     4552    1   DCL 1 MNTS CONSTANT,
      234     4553    1         2 N(0:4)UBIN INIT(%SCRATCH#,%SETPUB#,%SETPRIV#,%SETXCL#,0),
      235     4554    1         2 T(0:4)CHAR(4)INIT('*','PUBL','SHAR','EXCL','OPER');
      236     4555    1   DCL 1 PSNVSN STATIC,
      237     4556    1         2 * UBIN INIT(%MNUM),
      238     4557    1         2 N UBIN;
      239     4558    1   DCL 1 SCTTXT CONSTANT,
      240     4559    1         2 * UBIN INIT(1),
      241     4560    1         2 * PTR INIT(ADDR(VSNLST.FLG));
      242     4561    1   DCL 1 PSNHDR CONSTANT,
      243     4562    1         2 * UBIN INIT(SIZEC(PSNHDR.T)),
      244     4563    1         2 * PTR INIT(ADDR(PSNHDR.T)),
      245     4564    1         2 T CHAR(0)INIT(
      246     4565    1           'PACKSETS:');
      247     4566        %EJECT;     /* BEGIN PROCEDURE FOR CATADD,CATDELETE,CATLIST,CATMODIFY */
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:44   
      248     4567                    /*E*     ERROR: FXP-E$CATALOG-0
      249     4568                    *        MESSAGE:CATalog vsn [SCratch] ...or
      250     4569                    *        CATalog DP#set [vsn,...,vsn] [{PUbl|SHared|EXcl|SCratch|OPer}]
      251     4570                    *        - adds catalog entry, sets its mount mode
      252     4571                    */
      253     4572                    /*E*     ERROR: FXP-E$CATMOD-0
      254     4573                   *  MESSAGE:CATModify {vsn|DP#set [vsn]} [{PUbl|SHared|EXcl|SCratch|OPer}]
      255     4574                    */
      256     4575                    /*E*     ERROR: FXP-E$CATDEL-0
      257     4576                    *        MESSAGE:CATDelete {vsn|DP#set [vsn]} - deletes catalog entry
      258     4577                    */
      259     4578    1      ERRCODE='0'B;
      260     4579    2      IF PBLK.SUBLK$(1)->PBLK.CODE~=0 THEN DO;
      261     4580    2         PSNKEY.PSN=PBLK.SUBLK$(1)->PSYM.TEXT;
      262     4581    2         VID1='0'B;
      263     4582    3         DO I=2 TO PBLK.NSUBLKS-1;
      264     4583    4            IF PBLK.SUBLK$(I)->PBLK.NDTYPE=%DEC# THEN DO;
      265     4584    4               CALL CHARBIN(J,PBLK.SUBLK$(I)->PSYM.TEXT);
      266     4585    4               VID1.SNLIST.VSN.N(VID1.VOLCNT)=J;
      267     4586    4               VID1.VOLCNT=VID1.VOLCNT+1;
      268     4587    4               END;
      269     4588    3            ELSE IF PBLK.SUBLK$(I)->PBLK.NDTYPE=%PL6SYM#
      270     4589    3            THEN VID1.SNLIST.VSN.S(VID1.VOLCNT-1)=
      271     4590    3              ASCBIN(PBLK.SUBLK$(I)->PSYM.TEXT)-ASCBIN('@');
      272     4591    3            ELSE VID1.VSN=PBLK.SUBLK$(I)->PBLK.CODE;/*SAVE MOUNT IN VID1*/
      273     4592    3            END;
      274     4593    2         IF VID1.VSN~=0 THEN VID1.VSN=MNTS.N(VID1.VSN-%SETPUB#+1);
      275     4594    3         IF VID1.VOLCNT=0 OR VID1.VOLCNT=1 AND PARM~=%E$CATDEL THEN DO;
      276     4595                    /* TRY TO READ A VID IF NECESSARY */
      277     4596    3            IF VID1.VOLCNT=0 THEN PBLK.SUBLK$(0)=ADDR(VID1)->BASED_PTR;
      278     4597    3            ELSE PBLK.SUBLK$(0)=ADDR(VID1.SNLIST.VSN(0))->BASED_PTR;
      279     4598    3            CALL FXP$RVID(PBLK.SUBLK$(0))ALTRET(CATA_NOVID);
      280     4599    3            IF VID1.VOLCNT~=0 AND (VIDBUF.PSN~=PSNKEY.PSN OR
      281     4600    3              VIDBUF.SNLIST.VSN(0)~=VID1.SNLIST.VSN(0)) THEN GOTO CATA_NOVID;
      282     4601    3            IF VIDBUF.VOLCNT=0 THEN GOTO CATA_NOVID;
      283     4602    3            VID1.VOLCNT=VIDBUF.VOLCNT;
      284     4603    3            VID1.SNLIST=VIDBUF.SNLIST;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:45   
      285     4604    3            PSNKEY.PSN=VIDBUF.PSN; /* IN CASE IT'S A DUAL */
      286     4605    3            END;
      287     4606    2   CATA_NOVID:;
      288     4607    3         IF VID1.VOLCNT=0 THEN DO;
      289     4608    3            ERRCODE=FXU$E$NOVSN;
      290     4609                    /*E*     ERROR: FXU-E$NOVSN-E
      291     4610                    *        MESSAGE: :CAT commands require VSN for unmounted sets.
      292     4611                    */
      293     4612    3            ALTRETURN;
      294     4613    3            END;
      295     4614    2         PSNKEY.VSN=VID1.SNLIST.VSN(0);
      296     4615    3         IF PARM~=%E$CATALOG THEN CALL CATR_PSN WHENALTRETURN DO;
      297     4616    3            VID1.VOLCNT=0;
      298     4617    3            IF PBLK.NSUBLKS=2 THEN GOTO CATA_NOVID;
      299     4618    3            GOTO RETALT;
      300     4619    3            END;
      301     4620    2         IF PARM=%E$CATDEL THEN GOTO CATD_EXIT;
      302     4621    2         PSNREC='0'B;
      303     4622    2         PSNREC.PSN=PSNKEY.PSN;
      304     4623    2         PSNREC.VOLCNT=VID1.VOLCNT;
      305     4624    2         PSNREC.DEFMOUNT=VID1.VSN;
      306     4625    2   FIX_PSN:;   /* ENTRY FOR CATMNT TO UPDATE VSN RECS */
      307     4626    3         DO I=0 TO PSNREC.VOLCNT-1;
      308     4627    3            VSNKEY.VSN=VID1.SNLIST.VSN.N(I);
      309     4628    3            PSNREC.VSN(I)=VID1.SNLIST.VSN(I);
      310     4629    3            CALL CATR_VSN;
      311     4630    3            IF VSNREC.TYPE<BINASC(0) THEN VSNREC.TYPE=VID1.SNLIST.TYPE(I);
      312     4631    3            VSNREC.VSN=VSNKEY.VSN;
      313     4632    3            IF PSNREC.VSN.S(I)=0 THEN J=0;
      314     4633    3            ELSE J=PSNREC.VSN.S(I)-1;
      315     4634    4            IF VSNREC.SCT.SIZE(J)=0 THEN DO;
      316     4635    4               VSNREC.SCT.SIZE(J)=VID1.SNLIST.SIZE(I);
      317     4636    4               VSNREC.SCT.PSN(J)=PSNREC.PSN;
      318     4637    4               VSNREC.SCT.SCRATCH(J)='0'B;
      319     4638    4               END;
      320     4639    3            ELSE IF VSNREC.SCT.PSN(J)~=PSNREC.PSN
      321     4640    4            THEN IF VSNREC.SCT.PSN(J)>BINASC(0) THEN DO;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:46   
      322     4641                    /*E*     ERROR: FXU-E$DUPVSN-E
      323     4642                    *        MESSAGE:Volume %U1 is doubly catalogued.
      324     4643                    */
      325     4644    4               ERRCODE=FXU$E$DUPVSN;
      326     4645    4               CALL FXP$RVID(VID1.SNLIST.VSN(I));
      327     4646    4               ALTRETURN;
      328     4647    4               END;
      329     4648    3            ELSE VSNREC.SCT.PSN(J)=PSNREC.PSN;
      330     4649    3            IF J>VSNREC.SCNT THEN VSNREC.SCNT=J;
      331     4650    3            CALL CATW_VSN;
      332     4651    3            END;
      333     4652    2         CALL CATW_PSN ALTRET(RETALT);
      334     4653    2         IF ERRCODE THEN ALTRETURN; /* PROBABLY CATMNT WANTING TO MOUNT */
      335     4654    2         RETURN;
      336     4655    2         END;
      337     4656    2      ELSE DO;
      338     4657    2         CALL CHARBIN(I,PBLK.SUBLK$(1)->PSYM.TEXT);
      339     4658    2         VSNKEY.VSN=I;
      340     4659    2         IF PARM~=%E$CATALOG THEN CALL CATR_VSN ALTRET(RETALT);
      341     4660    2         ELSE VSNREC='0'B;
      342     4661    3         IF PARM=%E$CATDEL THEN DO;
      343     4662    3            VID1.VOLCNT=0; /* FLAG FOR DELETE BY VSN */
      344     4663    3   CATD_EXIT: CALL CATD_ ALTRET(RETALT);
      345     4664    3            IF VID1.VOLCNT~=0
      346     4665    4            THEN DO I=0 TO PSNREC.VOLCNT-1;
      347     4666                    /* De-catalog the PSN from all associated VSN records */
      348     4667    4               VSNKEY.VSN=PSNREC.VSN.N(I);
      349     4668    5               CALL CATR_VSN WHENRETURN DO;
      350     4669    5                  J=MAXIMUM(1,PSNREC.VSN.S(I))-1;
      351     4670    6                  IF VSNREC.SCT.PSN(J)=PSNREC.PSN THEN DO;
      352     4671    6                     VSNREC.SCT.PSN(J)=BINASC(0);
      353     4672    6                     CALL CATW_VSN;
      354     4673    6                     END;
      355     4674    5                  END;
      356     4675    4               END;
      357     4676    3            RETURN;
      358     4677    3            END;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:47   
      359     4678    2         J=0;
      360     4679    3         DO I=2 TO PBLK.NSUBLKS-1;
      361     4680    3            IF PBLK.SUBLK$(I)->PBLK.CODE=%SETXCL#+1 THEN VSNREC.SCT.SCRATCH(J)='1'B;
      362     4681    3            ELSE IF PBLK.SUBLK$(I)->PBLK.NDTYPE=%PL6SYM#
      363     4682    3            THEN J=ASCBIN(PBLK.SUBLK$(I)->PSYM.TEXT)-ASCBIN('@');
      364     4683    3            ELSE VSNREC.SCT.SCRATCH(J)='0'B;
      365     4684    3            END;
      366     4685    2         VSNREC.VSN=VSNKEY.VSN;
      367     4686    3         IF VSNREC.TYPE<BINASC(0) THEN DO;
      368     4687    3   VSN_MNTXIT:; /* ENTRY FOR CATMNT */
      369     4688    3            I=VSNREC.VSN;
      370     4689    3            CALL FXP$RVID(I)ALTRET(VSN_NOVID);
      371     4690    3            VSNREC.TYPE=F$DCB.ACCT#;
      372     4691    3            IF VIDBUF.SECTSTRT(0)>=F$DCB.IXTNSIZE# THEN VIDBUF.SECTSTRT(0)=0;
      373     4692    3            I=0;
      374     4693    4            DO WHILE(VIDBUF.SECTSTRT(I)~=F$DCB.IXTNSIZE#);
      375     4694    4               VSNREC.SCNT=I;
      376     4695    4               IF VIDBUF.SECTSTRT(I+1)>=F$DCB.IXTNSIZE#
      377     4696    4                 OR VIDBUF.SECTSTRT(I)>=VIDBUF.SECTSTRT(I+1)
      378     4697    4                 OR I=SIZEW(VIDBUF.SECTSTRT)-1
      379     4698    4               THEN VIDBUF.SECTSTRT(I+1)=F$DCB.IXTNSIZE#;
      380     4699    4               VSNREC.SCT.SIZE(I)=VIDBUF.SECTSTRT(I+1)-VIDBUF.SECTSTRT(I);
      381     4700    4               I=I+1;
      382     4701    4               END;
      383     4702    3            END;
      384     4703    2   VSN_NOVID:;
      385     4704    2         CALL CATW_VSN ALTRET(RETALT);
      386     4705    2         RETURN;
      387     4706    2         END;
      388     4707                    /**/
      389     4708    1   RETALT:;
      390     4709    1      IF ADDR(PARM)=ADDR(NIL) AND NOT ERRCODE THEN RETURN;
      391     4710    1      ERRCODE=B$TCB.ALT$->B$ALT.ERR;
      392     4711    1      ALTRETURN;
      393     4712        %EJECT;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:48   
      394     4713                    /*E*     ERROR: FXP-E$CATLIST-0
      395     4714                    *        MESSAGE:CATList [{vsn|DP#set} [>]] - list catalog
      396     4715                    */
      397     4716    1   FXU$CATL: ENTRY(PARM)ALTRET;
      398     4717    1      IF USW THEN PBLK.NSUBLKS=3;
      399     4718    1      IF PBLK.NSUBLKS~=0
      400     4719    2      THEN IF PBLK.SUBLK$(1)->PBLK.CODE~=0 THEN DO;
      401     4720    2         PSNKEY.PSN=PBLK.SUBLK$(1)->PSYM.TEXT;
      402     4721    2         PSNKEY.VSN='0'B;
      403     4722    2         CALL CATR_PSN;
      404     4723    2         CALL CATR_NXT;
      405     4724    2         IF PBLK.NSUBLKS=2 AND RKEY.P.SN~=PSNKEY.PSN THEN RETURN;
      406     4725    2         END;
      407     4726    2      ELSE DO;
      408     4727    2         CALL CHARBIN(I,PBLK.SUBLK$(1)->PSYM.TEXT);
      409     4728    2         VSNKEY.VSN=I;
      410     4729    2         CALL CATR_VSN;
      411     4730    2         IF VSNREC='0'B THEN IF PBLK.NSUBLKS=2 THEN RETURN;
      412     4731    2         ELSE CALL CATR_NXT;
      413     4732    2         ELSE RKEY=VSNKEY;
      414     4733    2         END;
      415     4734    2      ELSE DO;
      416     4735    2         VSNKEY.VSN=0;
      417     4736    2         CALL CATR_VSN;
      418     4737    2         CALL CATR_NXT;
      419     4738    2         END;
      420     4739    1      IF RKEY.L=3 THEN CALL FXP$PART(VSNHDR);
      421     4740    2      DO WHILE (RKEY.L=3);
      422     4741    3         DO I=0 TO VSNREC.SCNT;
      423     4742    3            CALL FXP$PRINT;
      424     4743    3            VSNLST.TYPE=VSNREC.TYPE;
      425     4744    3            VSNLST.PSN=VSNREC.SCT.PSN(I);
      426     4745    3            CALL BINCHAR(VSNLST.VSN,VSNREC.VSN);
      427     4746    3            CALL EDITCHAR(VSNLST.VSN,0,8,'110'O,VSNLST.VSN);
      428     4747    4            IF VSNREC.SCNT~=0 THEN DO;
      429     4748    4               VSNLST.VSN=SUBSTR(VSNLST.VSN,1,8);
      430     4749    4               CALL INSERT(VSNLST.VSN,8,1,
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:49   
      431     4750    4                 BINASC(I+ASCBIN('A')));
      432     4751    4               END;
      433     4752    3            CALL BINCHAR(VSNLST.SIZE,VSNREC.SCT.SIZE(I));
      434     4753    3            CALL EDITCHAR(VSNLST.SIZE,0,5,'105'O,VSNLST.SIZE);
      435     4754    3            IF VSNREC.SCT.SCRATCH(I) THEN VSNLST.FLG='*';
      436     4755    3            ELSE VSNLST.FLG=' ';
      437     4756    3            CALL FXP$PART(VSNTXT);
      438     4757    3            END;
      439     4758    2         IF PBLK.NSUBLKS=2 THEN RETURN;
      440     4759    2         CALL CATR_NXT;
      441     4760    2         IF RKEY.L=11 THEN IF PBLK.NSUBLKS=0 THEN CALL FXP$PRINT;
      442     4761    2         ELSE RETURN;
      443     4762    2         IF BREAK~=0 THEN ALTRETURN;
      444     4763    2         END;
      445     4764    1      IF RKEY.L=11 THEN CALL FXP$PART(PSNHDR);
      446     4765    2      DO WHILE(RKEY.L=11);
      447     4766    2         IF PBLK.NSUBLKS=2 AND RKEY.P.SN~=PSNKEY.PSN THEN RETURN;
      448     4767    2         CALL FXP$PRINT;
      449     4768    2         PSNLST.PSN=PSNREC.PSN;
      450     4769    3         DO I=0 TO 4;
      451     4770    3            IF MNTS.N(I)=PSNREC.DEFMOUNT THEN PSNLST.MNT=MNTS.T(I);
      452     4771    3            END;
      453     4772    2         CALL FXP$PART(PSNTXT);
      454     4773    3         DO I=0 TO PSNREC.VOLCNT-1;
      455     4774    3            PSNVSN.N=PSNREC.VSN.N(I);
      456     4775    3            CALL FXP$PARN(PSNVSN);
      457     4776    3            VSNLST.FLG=BINASC(PSNREC.VSN.S(I)+ASCBIN('@'));
      458     4777    3            IF VSNLST.FLG~='@' THEN CALL FXP$PART(SCTTXT);
      459     4778    3            END;
      460     4779    2         CALL CATR_NXT;
      461     4780    2         IF BREAK~=0 THEN ALTRETURN;
      462     4781    2         END;
      463     4782    1      RETURN;
      464     4783        %EJECT;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:50   
      465     4784    1   FXU$CATMNT: ENTRY(PARM)ALTRET;
      466     4785    1      ERRCODE='0'B;
      467     4786    2      IF VIDBUF.VOLCNT~=0 THEN DO;
      468     4787    2         PSNKEY.PSN=VIDBUF.PSN;
      469     4788    2         PSNKEY.VSN=VIDBUF.SNLIST.VSN(0);
      470     4789    2         CALL CATR_PSN ALTRET(MNT_NOPSN);
      471     4790    3         IF PSNREC.DEFMOUNT=%SETPRIV# OR PSNREC.DEFMOUNT=%SETPUB# THEN DO;
      472     4791    3            CSTAT.NUM=CSTAT.NUM+1;
      473     4792    3            CSTAT.SETS(CSTAT.NUM)='0'B;
      474     4793    3            CSTAT.SETS.DISP(CSTAT.NUM)=PSNREC.DEFMOUNT;
      475     4794    3            CSTAT.SETS.PSN(CSTAT.NUM)=PSNKEY.PSN;
      476     4795    3            ERRCODE='1'B;
      477     4796    3            END;
      478     4797    2         VID1.SNLIST=VIDBUF.SNLIST;
      479     4798    2         GOTO FIX_PSN;
      480     4799    2         END;
      481     4800    1   MNT_NOPSN:;
      482     4801    1      VSNKEY.VSN=VIDBUF.VSN;
      483     4802    1      CALL CATR_VSN ALTRET(RETRET);
      484     4803    1      IF VSNREC.TYPE<BINASC(0) THEN GOTO VSN_MNTXIT;
      485     4804    1   RETRET:;
      486     4805    1      RETURN;
      487     4806        %EJECT;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:51   
      488     4807    1   CATR_PSN: PROC ALTRET;
      489     4808        %FPT_READ(FPTN=RPSN,KEY=PSNKEY,BUF=PSNREC,KEYS=YES,DCB=M$CAT);
      490     4847        %FPT_READ(FPTN=RNXT,KEY=RKEY,BUF=PSNREC,KEYR=YES,DCB=M$CAT);
      491     4886        %FPT_READ(FPTN=RVSN,KEY=VSNKEY,BUF=VSNREC,KEYS=YES,DCB=M$CAT);
      492     4925        %FPT_WRITE(FPTN=WPSN,KEY=PSNKEY,BUF=PSNREC,DCB=M$CAT);
      493     4956        %FPT_WRITE(FPTN=WVSN,KEY=VSNKEY,BUF=VSNREC,DCB=M$CAT);
      494     4987        %FPT_DELREC(FPTN=DREC,DCB=M$CAT);
      495     5006    2      CALL M$READ(RPSN)ALTRET(RETALT);
      496     5007    2      RETURN;
      497     5008                    /**/
      498     5009    2   CATW_PSN: ENTRY ALTRET;
      499     5010    2      WPSN.BUF_.BOUND=POFFC(ADDR(PSNREC.VSN(PSNREC.VOLCNT)),ADDR(PSNREC))-1;
      500     5011    2      CALL M$WRITE(WPSN)ALTRET(RETALT);
      501     5012    2      RETURN;
      502     5013                    /**/
      503     5014    2   RETALT: ALTRETURN;
      504     5015                    /**/
      505     5016    2   CATR_VSN: ENTRY ALTRET;
      506     5017    2      VSNREC='0'B;
      507     5018    2      CALL M$READ(RVSN)ALTRET(RETALT);
      508     5019    2      RETURN;
      509     5020                    /**/
      510     5021    2   CATW_VSN: ENTRY ALTRET;
      511     5022    2      WVSN.BUF_.BOUND=POFFC(ADDR(VSNREC.SCT(VSNREC.SCNT+1)),ADDR(VSNREC))-1;
      512     5023    2      CALL M$WRITE(WVSN)ALTRET(RETALT);
      513     5024    2      RETURN;
      514     5025                    /**/
      515     5026    2   CATD_: ENTRY ALTRET;
      516     5027    2      CALL M$DELREC(DREC)ALTRET(RETALT);
      517     5028    2      RETURN;
      518     5029    2   CATR_NXT: ENTRY ALTRET;
      519     5030    2      RKEY='0'B;
      520     5031    2      PSNREC.PSN=' ';
      521     5032    2      CALL M$READ(RNXT)ALTRET(RETALT);
      522     5033    2      IF RKEY.L=3 THEN VSNREC=PSNREC;
      523     5034    2      RETURN;
      524     5035    2   END;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:52   
      525     5036    1   END;
      526     5037        %EOD;

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:53   
--  Include file information  --

   FX_PERR_C.:E05TOU  is referenced.
   FX_SUBS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   FX$CAT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$CATADM.

   Procedure FXU$CATADM requires 834 words for executable code.
   Procedure FXU$CATADM requires 10 words of local(AUTO) storage.

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:54   

 Object Unit name= FXU$CATADM                                 File name= FXU$UTIL.:E05TOU
 UTS= JUL 29 '97 20:34:20.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     33     41  FXU$CATADM
    2   Data  even  none   180    264  FXU$CATADM
    3   DCB   even  none     0      0  M$CAT
    4   Proc  even  none   834   1502  FXU$CATADM
    5  RoData even  none    16     20  FXU$CATADM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  FXU$CATADM
     4    662          yes     yes      Std        1  FXU$CATL
     4   1265          yes     yes      Std        1  FXU$CATMNT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FXP$RVID
 yes     yes           Std       1 FXP$PRINT
 yes     yes           Std       1 FXP$PART
 yes     yes           Std       1 FXP$PARN
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:55   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VIDBUF                                CSTAT
     ERRCODE                               USW                                   BREAK
     BLK$                                  B$TCB$                                M$DP$
     M$CAT                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:56   


      149        1        /*T***********************************************************/
      150        2        /*T*                                                         */
      151        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      152        4        /*T*                                                         */
      153        5        /*T***********************************************************/
      154        6        FXU$CATADM: PROC(PARM)ALTRET;

      6  4 000000   000000 700200 xent  FXU$CATADM   TSX0  ! X66_AUTO_1
         4 000001   000012 000001                    ZERO    10,1

      155        7        %INCLUDE CP_6;
      156       88        %INCLUDE CP_6_SUBS;
      157      628        %INCLUDE FX$CAT;
      158      645        %INCLUDE FM$MACROS;
      159     1020        %INCLUDE XU_MACRO_C;
      160     4126        %INCLUDE XU_SUBS_C;
      161     4218        %INCLUDE FX_SUBS_C;
      162     4254        %INCLUDE FX_PERR_C;
      163     4313    1   DCL PARM UBIN;
      164     4314        %F$DCB(BASED="BASED(M$DP$)");
      165     4371        %FM$VID(FM$VID=VIDBUF,BASED=SYMREF);
      166     4377        %FX$PSN(FX$PSN=PSNREC,BASED=REDEF VIDBUF,
      167     4378           MAX=1019);
      168     4381        %FX$STAT(FX$STAT=CSTAT,BASED=SYMREF,MAX=510);
      169     4384        %FM$VID(FM$VID=VID1,BASED=REDEF CSTAT);
      170     4390        %SUB FCG#='0630'O;
      171     4391        %SUB MID#='25'O;
      172     4392    1   DCL ERRCODE BIT(36)SYMREF;
      173     4393    1   DCL USW BIT(1)SYMREF;
      174     4394    1   DCL BREAK UBIN SYMREF;
      175     4395        %ERRCODE(NAME=FXU$E$NOVSN,COD#=E$NOVSN);
      176     4399        %ERRCODE(NAME=FXU$E$DUPVSN,COD#=%E$DUPVSN);
      177     4403        %FX$VSN(MAX=25,FX$VSN=VSNREC,BASED=STATIC);
      178     4407    1   DCL 1 PSNKEY STATIC,
      179     4408    1         2 L UBIN(9)INIT(11)UNAL,
      180     4409    1         2 PSN CHAR(7),
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:57   
      181     4410    1         2 VSN,
      182     4411    1           3 S UBIN(9)UNAL,
      183     4412    1           3 N UBIN(27)UNAL;
      184     4413    1   DCL 1 VSNKEY STATIC,
      185     4414    1         2 * UBIN(9)INIT(3)UNAL,
      186     4415    1         2 VSN UBIN(27)UNAL;
      187     4416    1   DCL 1 RKEY STATIC,
      188     4417    1         2 L UBIN(9)UNAL,
      189     4418    1         2 P,
      190     4419    1           3 SN CHAR(7),
      191     4420    1           3 VSN BIT(36),
      192     4421    1         2 V REDEF P,
      193     4422    1           3 SN UBIN(27)UNAL,
      194     4423    1           3 * CHAR(8);
      195     4424        %PARSE$OUT(NAME=PBLK);
      196     4469        %PARSE$SYM(NAME=PSYM);
      197     4507    1   DCL BLK$ PTR SYMREF;
      198     4508        %B$TCB(STCLASS="BASED(B$TCB$)");
      199     4511        %B$ALT;
      200     4519    1   DCL B$TCB$ PTR SYMREF;
      201     4520    1   DCL M$DP$ PTR SYMREF;
      202     4521    1   DCL I UBIN;
      203     4522    1   DCL J UBIN;
      204     4523    1   DCL FXP$RVID ENTRY(1)ALTRET;
      205     4524    1   DCL FXP$PARM ENTRY(1)ALTRET;
      206     4525    1   DCL FXP$PART ENTRY(1)ALTRET;
      207     4526    1   DCL FXP$PARN ENTRY(1)ALTRET;
      208     4527    1   DCL FXP$PRINT ENTRY(1)ALTRET;
      209     4528    1   DCL M$CAT DCB;
      210     4529    1   DCL BASED_PTR BASED PTR;
      211     4530    1   DCL 1 VSNLST STATIC,
      212     4531    1         2 TYPE CHAR(9),
      213     4532    1         2 PSN CHAR(7),
      214     4533    1         2 SIZE CHAR(6),
      215     4534    1         2 VSN CHAR(9),
      216     4535    1         2 * CHAR(1)INIT(' '),
      217     4536    1         2 FLG CHAR(1);
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:58   
      218     4537    1   DCL 1 VSNTXT CONSTANT,
      219     4538    1         2 * UBIN INIT(SIZEC(VSNLST)),
      220     4539    1         2 * PTR INIT(ADDR(VSNLST));
      221     4540    1   DCL 1 VSNHDR CONSTANT,
      222     4541    1         2 * UBIN INIT(SIZEC(VSNHDR.T)),
      223     4542    1         2 * PTR INIT(ADDR(VSNHDR.T)),
      224     4543    1         2 T CHAR(0)INIT(
      225     4544    1           'TYPE     PSN      SIZE      VSN');
      226     4545    1   DCL 1 PSNLST STATIC,
      227     4546    1         2 * CHAR(0)INIT('DP#'),
      228     4547    1         2 PSN CHAR(7),
      229     4548    1         2 MNT CHAR(4);
      230     4549    1   DCL 1 PSNTXT CONSTANT,
      231     4550    1         2 * UBIN INIT(SIZEC(PSNLST)),
      232     4551    1         2 * PTR INIT(ADDR(PSNLST));
      233     4552    1   DCL 1 MNTS CONSTANT,
      234     4553    1         2 N(0:4)UBIN INIT(%SCRATCH#,%SETPUB#,%SETPRIV#,%SETXCL#,0),
      235     4554    1         2 T(0:4)CHAR(4)INIT('*','PUBL','SHAR','EXCL','OPER');
      236     4555    1   DCL 1 PSNVSN STATIC,
      237     4556    1         2 * UBIN INIT(%MNUM),
      238     4557    1         2 N UBIN;
      239     4558    1   DCL 1 SCTTXT CONSTANT,
      240     4559    1         2 * UBIN INIT(1),
      241     4560    1         2 * PTR INIT(ADDR(VSNLST.FLG));
      242     4561    1   DCL 1 PSNHDR CONSTANT,
      243     4562    1         2 * UBIN INIT(SIZEC(PSNHDR.T)),
      244     4563    1         2 * PTR INIT(ADDR(PSNHDR.T)),
      245     4564    1         2 T CHAR(0)INIT(
      246     4565    1           'PACKSETS:');
      247     4566        %EJECT;     /* BEGIN PROCEDURE FOR CATADD,CATDELETE,CATLIST,CATMODIFY */
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:59   
      248     4567                    /*E*     ERROR: FXP-E$CATALOG-0
      249     4568                    *        MESSAGE:CATalog vsn [SCratch] ...or
      250     4569                    *        CATalog DP#set [vsn,...,vsn] [{PUbl|SHared|EXcl|SCratch|OPer}]
      251     4570                    *        - adds catalog entry, sets its mount mode
      252     4571                    */
      253     4572                    /*E*     ERROR: FXP-E$CATMOD-0
      254     4573                   * MESSAGE:CATModify {vsn|DP#set [vsn]} [{PUbl|SHared|EXcl|SCratch|OPer}]
      255     4574                    */
      256     4575                    /*E*     ERROR: FXP-E$CATDEL-0
      257     4576                    *        MESSAGE:CATDelete {vsn|DP#set [vsn]} - deletes catalog entry
      258     4577                    */
      259     4578    1      ERRCODE='0'B;

   4578  4 000002   000000 450000 xsym               STZ     ERRCODE

      260     4579    2      IF PBLK.SUBLK$(1)->PBLK.CODE~=0 THEN DO;

   4579  4 000003   000000 470400 xsym               LDP0    BLK$
         4 000004   000004 471500                    LDP1    4,,PR0
         4 000005   100000 720100                    LXL0    0,,PR1
         4 000006   000375 600000 4                  TZE     s:4657

      261     4580    2         PSNKEY.PSN=PBLK.SUBLK$(1)->PSYM.TEXT;

   4580  4 000007   100004 236100                    LDQ     4,,PR1
         4 000010   000033 772000                    QRL     27
         4 000011   000000 621006                    EAX1    0,QL
         4 000012   040000 100540                    MLR     fill='040'O
         4 000013   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000014   000121 200007 2                  ADSC9   PSNKEY                   cn=1,n=7

      262     4581    2         VID1='0'B;

   4581  4 000015   010000 220003                    LDX0    4096,DU
         4 000016   000040 100400                    MLR     fill='000'O
         4 000017   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000020   000000 000010 xsym               ADSC9   CSTAT                    cn=0,n=*X0
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:60   

      263     4582    3         DO I=2 TO PBLK.NSUBLKS-1;

   4582  4 000021   000002 235007                    LDA     2,DL
         4 000022   200004 755100                    STA     I,,AUTO
         4 000023   000106 710000 4                  TRA     s:4592+3

      264     4583    4            IF PBLK.SUBLK$(I)->PBLK.NDTYPE=%DEC# THEN DO;

   4583  4 000024   000000 470400 xsym               LDP0    BLK$
         4 000025   200004 720100                    LXL0    I,,AUTO
         4 000026   000003 471510                    LDP1    3,X0,PR0
         4 000027   100000 236100                    LDQ     0,,PR1
         4 000030   000077 376003                    ANQ     63,DU
         4 000031   000022 116003                    CMPQ    18,DU
         4 000032   000057 601000 4                  TNZ     s:4588

      265     4584    4               CALL CHARBIN(J,PBLK.SUBLK$(I)->PSYM.TEXT);

   4584  4 000033   100004 236100                    LDQ     4,,PR1
         4 000034   000033 772000                    QRL     27
         4 000035   000000 621006                    EAX1    0,QL
         4 000036   000100 305540                    DTB
         4 000037   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 000040   200010 000010                    NDSC9   J+3,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         4 000041   200011 235100                    LDA     J+4,,AUTO
         4 000042   200005 755100                    STA     J,,AUTO

      266     4585    4               VID1.SNLIST.VSN.N(VID1.VOLCNT)=J;

   4585  4 000043   000004 236000 xsym               LDQ     CSTAT+4
         4 000044   000002 736000                    QLS     2
         4 000045   000000 376000 5                  ANQ     0
         4 000046   000000 621006                    EAX1    0,QL
         4 000047   200005 236100                    LDQ     J,,AUTO
         4 000050   000500 676011 xsym               ERQ     CSTAT+320,X1
         4 000051   000032 376000 xsym               ANQ     B_VECTNIL+26
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:61   
         4 000052   000500 656011 xsym               ERSQ    CSTAT+320,X1

      267     4586    4               VID1.VOLCNT=VID1.VOLCNT+1;

   4586  4 000053   000004 721000 xsym               LXL1    CSTAT+4
         4 000054   000001 622011                    EAX2    1,X1
         4 000055   000004 442000 xsym               SXL2    CSTAT+4

      268     4587    4               END;

   4587  4 000056   000103 710000 4                  TRA     s:4592

      269     4588    3            ELSE IF PBLK.SUBLK$(I)->PBLK.NDTYPE=%PL6SYM#

   4588  4 000057   000030 116003                    CMPQ    24,DU
         4 000060   000100 601000 4                  TNZ     s:4591

      270     4589    3            THEN VID1.SNLIST.VSN.S(VID1.VOLCNT-1)=

   4589  4 000061   000004 236000 xsym               LDQ     CSTAT+4
         4 000062   000002 736000                    QLS     2
         4 000063   000000 376000 5                  ANQ     0
         4 000064   000000 621006                    EAX1    0,QL
         4 000065   100004 236100                    LDQ     4,,PR1
         4 000066   000033 772000                    QRL     27
         4 000067   100004 236100                    LDQ     4,,PR1
         4 000070   000022 772000                    QRL     18
         4 000071   000777 376007                    ANQ     511,DL
         4 000072   000100 136007                    SBLQ    64,DL
         4 000073   000033 736000                    QLS     27
         4 000074   000474 676011 xsym               ERQ     CSTAT+316,X1
         4 000075   777000 376003                    ANQ     -512,DU
         4 000076   000474 656011 xsym               ERSQ    CSTAT+316,X1
         4 000077   000103 710000 4                  TRA     s:4592

      271     4590    3              ASCBIN(PBLK.SUBLK$(I)->PSYM.TEXT)-ASCBIN('@');
      272     4591    3            ELSE VID1.VSN=PBLK.SUBLK$(I)->PBLK.CODE;/*SAVE MOUNT IN VID1*/
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:62   

   4591  4 000100   100000 236100                    LDQ     0,,PR1
         4 000101   777777 376007                    ANQ     -1,DL
         4 000102   000002 756000 xsym               STQ     CSTAT+2

      273     4592    3            END;

   4592  4 000103   200004 235100                    LDA     I,,AUTO
         4 000104   000001 035007                    ADLA    1,DL
         4 000105   200004 755100                    STA     I,,AUTO
         4 000106   000001 236100                    LDQ     1,,PR0
         4 000107   000022 772000                    QRL     18
         4 000110   200004 116100                    CMPQ    I,,AUTO
         4 000111   000113 600000 4                  TZE     s:4593
         4 000112   000024 603000 4                  TRC     s:4583

      274     4593    2         IF VID1.VSN~=0 THEN VID1.VSN=MNTS.N(VID1.VSN-%SETPUB#+1);

   4593  4 000113   000002 235000 xsym               LDA     CSTAT+2
         4 000114   000117 600000 4                  TZE     s:4594

   4593  4 000115   000011 235005 1                  LDA     VSNHDR+5,AL
         4 000116   000002 755000 xsym               STA     CSTAT+2

      275     4594    3         IF VID1.VOLCNT=0 OR VID1.VOLCNT=1 AND PARM~=%E$CATDEL THEN DO;

   4594  4 000117   000004 720000 xsym               LXL0    CSTAT+4
         4 000120   000127 600000 4                  TZE     s:4596
         4 000121   000001 100003                    CMPX0   1,DU
         4 000122   000167 601000 4                  TNZ     CATA_NOVID
         4 000123   200003 471500                    LDP1    @PARM,,AUTO
         4 000124   100000 235100                    LDA     0,,PR1
         4 000125   000172 115007                    CMPA    122,DL
         4 000126   000167 600000 4                  TZE     CATA_NOVID

      276     4595                    /* TRY TO READ A VID IF NECESSARY */
      277     4596    3            IF VID1.VOLCNT=0 THEN PBLK.SUBLK$(0)=ADDR(VID1)->BASED_PTR;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:63   

   4596  4 000127   000000 100003                    CMPX0   0,DU
         4 000130   000134 601000 4                  TNZ     s:4597

   4596  4 000131   000000 236000 xsym               LDQ     CSTAT
         4 000132   000003 756100                    STQ     3,,PR0
         4 000133   000136 710000 4                  TRA     s:4598

      278     4597    3            ELSE PBLK.SUBLK$(0)=ADDR(VID1.SNLIST.VSN(0))->BASED_PTR;

   4597  4 000134   000500 236000 xsym               LDQ     CSTAT+320
         4 000135   000003 756100                    STQ     3,,PR0

      279     4598    3            CALL FXP$RVID(PBLK.SUBLK$(0))ALTRET(CATA_NOVID);

   4598  4 000136   000000 236000 xsym               LDQ     BLK$
         4 000137   000003 036003                    ADLQ    3,DU
         4 000140   200010 756100                    STQ     J+3,,AUTO
         4 000141   200010 630500                    EPPR0   J+3,,AUTO
         4 000142   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000143   000000 701000 xent               TSX1    FXP$RVID
         4 000144   000167 702000 4                  TSX2    CATA_NOVID

      280     4599    3            IF VID1.VOLCNT~=0 AND (VIDBUF.PSN~=PSNKEY.PSN OR

   4599  4 000145   000004 720000 xsym               LXL0    CSTAT+4
         4 000146   000156 600000 4                  TZE     s:4601
         4 000147   040000 106400                    CMPC    fill='040'O
         4 000150   000003 000006 xsym               ADSC9   VIDBUF+3                 cn=0,n=6
         4 000151   000121 200007 2                  ADSC9   PSNKEY                   cn=1,n=7
         4 000152   000167 601000 4                  TNZ     CATA_NOVID
         4 000153   000500 236000 xsym               LDQ     VIDBUF+320
         4 000154   000500 116000 xsym               CMPQ    CSTAT+320
         4 000155   000167 601000 4                  TNZ     CATA_NOVID

      281     4600    3              VIDBUF.SNLIST.VSN(0)~=VID1.SNLIST.VSN(0)) THEN GOTO CATA_NOVID;
      282     4601    3            IF VIDBUF.VOLCNT=0 THEN GOTO CATA_NOVID;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:64   

   4601  4 000156   000004 721000 xsym               LXL1    VIDBUF+4
         4 000157   000167 600000 4                  TZE     CATA_NOVID

      283     4602    3            VID1.VOLCNT=VIDBUF.VOLCNT;

   4602  4 000160   000004 441000 xsym               SXL1    CSTAT+4

      284     4603    3            VID1.SNLIST=VIDBUF.SNLIST;

   4603  4 000161   000000 100400                    MLR     fill='000'O
         4 000162   000500 005400 xsym               ADSC9   VIDBUF+320               cn=0,n=2816
         4 000163   000500 005400 xsym               ADSC9   CSTAT+320                cn=0,n=2816

      285     4604    3            PSNKEY.PSN=VIDBUF.PSN; /* IN CASE IT'S A DUAL */

   4604  4 000164   040000 100400                    MLR     fill='040'O
         4 000165   000003 000006 xsym               ADSC9   VIDBUF+3                 cn=0,n=6
         4 000166   000121 200007 2                  ADSC9   PSNKEY                   cn=1,n=7

      286     4605    3            END;

   4600  4 000167                       CATA_NOVID   null
      287     4606    2   CATA_NOVID:;
      288     4607    3         IF VID1.VOLCNT=0 THEN DO;

   4607  4 000167   000004 720000 xsym               LXL0    CSTAT+4
         4 000170   000174 601000 4                  TNZ     s:4614

      289     4608    3            ERRCODE=FXU$E$NOVSN;

   4608  4 000171   000000 236000 1                  LDQ     FXU$E$NOVSN
         4 000172   000000 756000 xsym               STQ     ERRCODE

      290     4609                    /*E*     ERROR: FXU-E$NOVSN-E
      291     4610                    *        MESSAGE: :CAT commands require VSN for unmounted sets.
      292     4611                    */
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:65   
      293     4612    3            ALTRETURN;

   4612  4 000173   000000 702200 xent               TSX2  ! X66_AALT

      294     4613    3            END;
      295     4614    2         PSNKEY.VSN=VID1.SNLIST.VSN(0);

   4614  4 000174   000500 236000 xsym               LDQ     CSTAT+320
         4 000175   000123 756000 2                  STQ     PSNKEY+2

      296     4615    3         IF PARM~=%E$CATALOG THEN CALL CATR_PSN WHENALTRETURN DO;

   4615  4 000176   200003 470500                    LDP0    @PARM,,AUTO
         4 000177   000000 235100                    LDA     0,,PR0
         4 000200   000170 115007                    CMPA    120,DL
         4 000201   000214 600000 4                  TZE     s:4620

   4615  4 000202   001351 701000 4                  TSX1    CATR_PSN
         4 000203   000205 702000 4                  TSX2    s:4616
         4 000204   000214 710000 4                  TRA     s:4620

      297     4616    3            VID1.VOLCNT=0;

   4616  4 000205   000000 220003                    LDX0    0,DU
         4 000206   000004 440000 xsym               SXL0    CSTAT+4

      298     4617    3            IF PBLK.NSUBLKS=2 THEN GOTO CATA_NOVID;

   4617  4 000207   000000 470400 xsym               LDP0    BLK$
         4 000210   000001 221100                    LDX1    1,,PR0
         4 000211   000002 101003                    CMPX1   2,DU
         4 000212   000167 600000 4                  TZE     CATA_NOVID

      299     4618    3            GOTO RETALT;

   4618  4 000213   000647 710000 4                  TRA     RETALT

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:66   
      300     4619    3            END;
      301     4620    2         IF PARM=%E$CATDEL THEN GOTO CATD_EXIT;

   4620  4 000214   200003 470500                    LDP0    @PARM,,AUTO
         4 000215   000000 235100                    LDA     0,,PR0
         4 000216   000172 115007                    CMPA    122,DL
         4 000217   000427 600000 4                  TZE     CATD_EXIT

      302     4621    2         PSNREC='0'B;

   4621  4 000220   010000 220003                    LDX0    4096,DU
         4 000221   000040 100400                    MLR     fill='000'O
         4 000222   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000223   000000 000010 xsym               ADSC9   VIDBUF                   cn=0,n=*X0

      303     4622    2         PSNREC.PSN=PSNKEY.PSN;

   4622  4 000224   040000 100400                    MLR     fill='040'O
         4 000225   000121 200006 2                  ADSC9   PSNKEY                   cn=1,n=6
         4 000226   000000 000006 xsym               ADSC9   VIDBUF                   cn=0,n=6

      304     4623    2         PSNREC.VOLCNT=VID1.VOLCNT;

   4623  4 000227   000004 236000 xsym               LDQ     CSTAT+4
         4 000230   777777 376007                    ANQ     -1,DL
         4 000231   000003 756000 xsym               STQ     VIDBUF+3

      305     4624    2         PSNREC.DEFMOUNT=VID1.VSN;

   4624  4 000232   000002 235000 xsym               LDA     CSTAT+2
         4 000233   000002 755000 xsym               STA     VIDBUF+2

   4624  4 000234                       FIX_PSN      null
      306     4625    2   FIX_PSN:;   /* ENTRY FOR CATMNT TO UPDATE VSN RECS */
      307     4626    3         DO I=0 TO PSNREC.VOLCNT-1;

   4626  4 000234   200004 450100                    STZ     I,,AUTO
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:67   
         4 000235   000364 710000 4                  TRA     s:4651+3

      308     4627    3            VSNKEY.VSN=VID1.SNLIST.VSN.N(I);

   4627  4 000236   200004 235100                    LDA     I,,AUTO
         4 000237   000002 735000                    ALS     2
         4 000240   000500 236005 xsym               LDQ     CSTAT+320,AL
         4 000241   000124 552034 2                  STBQ    VSNKEY,'34'O

      309     4628    3            PSNREC.VSN(I)=VID1.SNLIST.VSN(I);

   4628  4 000242   200004 720100                    LXL0    I,,AUTO
         4 000243   000004 756010 xsym               STQ     VIDBUF+4,X0

      310     4629    3            CALL CATR_VSN;

   4629  4 000244   001406 701000 4                  TSX1    CATR_VSN
         4 000245   000000 011000                    NOP     0

      311     4630    3            IF VSNREC.TYPE<BINASC(0) THEN VSNREC.TYPE=VID1.SNLIST.TYPE(I);

   4630  4 000246   040000 106400                    CMPC    fill='040'O
         4 000247   000001 000010 2                  ADSC9   VSNREC+1                 cn=0,n=8
         4 000250   000001 000001 5                  ADSC9   1                        cn=0,n=1
         4 000251   000257 603000 4                  TRC     s:4631

   4630  4 000252   200004 235100                    LDA     I,,AUTO
         4 000253   000004 735000                    ALS     4
         4 000254   040000 100405                    MLR     fill='040'O
         4 000255   000502 000010 xsym               ADSC9   CSTAT+322,A              cn=0,n=8
         4 000256   000001 000010 2                  ADSC9   VSNREC+1                 cn=0,n=8

      312     4631    3            VSNREC.VSN=VSNKEY.VSN;

   4631  4 000257   000124 236000 2                  LDQ     VSNKEY
         4 000260   000000 552034 2                  STBQ    VSNREC,'34'O

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:68   
      313     4632    3            IF PSNREC.VSN.S(I)=0 THEN J=0;

   4632  4 000261   200004 720100                    LXL0    I,,AUTO
         4 000262   000004 236010 xsym               LDQ     VIDBUF+4,X0
         4 000263   777000 316003                    CANQ    -512,DU
         4 000264   000267 601000 4                  TNZ     s:4633

   4632  4 000265   200005 450100                    STZ     J,,AUTO
         4 000266   000273 710000 4                  TRA     s:4634

      314     4633    3            ELSE J=PSNREC.VSN.S(I)-1;

   4633  4 000267   000004 236010 xsym               LDQ     VIDBUF+4,X0
         4 000270   000033 772000                    QRL     27
         4 000271   000001 136007                    SBLQ    1,DL
         4 000272   200005 756100                    STQ     J,,AUTO

      315     4634    4            IF VSNREC.SCT.SIZE(J)=0 THEN DO;

   4634  4 000273   200005 236100                    LDQ     J,,AUTO
         4 000274   000003 402007                    MPY     3,DL
         4 000275   000003 235006 2                  LDA     VSNREC+3,QL
         4 000276   000315 601000 4                  TNZ     s:4639

      316     4635    4               VSNREC.SCT.SIZE(J)=VID1.SNLIST.SIZE(I);

   4635  4 000277   200004 235100                    LDA     I,,AUTO
         4 000300   000002 735000                    ALS     2
         4 000301   000501 235005 xsym               LDA     CSTAT+321,AL
         4 000302   000003 755006 2                  STA     VSNREC+3,QL

      317     4636    4               VSNREC.SCT.PSN(J)=PSNREC.PSN;

   4636  4 000303   000002 736000                    QLS     2
         4 000304   040006 100400                    MLR     fill='040'O
         4 000305   000000 000006 xsym               ADSC9   VIDBUF                   cn=0,n=6
         4 000306   000004 000006 2                  ADSC9   VSNREC+4,Q               cn=0,n=6
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:69   

      318     4637    4               VSNREC.SCT.SCRATCH(J)='0'B;

   4637  4 000307   200005 236100                    LDQ     J,,AUTO
         4 000310   000003 402007                    MPY     3,DL
         4 000311   000000 621006                    EAX1    0,QL
         4 000312   000002 236000 5                  LDQ     2
         4 000313   000005 356011 2                  ANSQ    VSNREC+5,X1

      319     4638    4               END;

   4638  4 000314   000350 710000 4                  TRA     s:4649

      320     4639    3            ELSE IF VSNREC.SCT.PSN(J)~=PSNREC.PSN

   4639  4 000315   200005 236100                    LDQ     J,,AUTO
         4 000316   000014 402007                    MPY     12,DL
         4 000317   040000 106406                    CMPC    fill='040'O
         4 000320   000004 000006 2                  ADSC9   VSNREC+4,Q               cn=0,n=6
         4 000321   000000 000006 xsym               ADSC9   VIDBUF                   cn=0,n=6
         4 000322   000350 600000 4                  TZE     s:4649

      321     4640    4            THEN IF VSNREC.SCT.PSN(J)>BINASC(0) THEN DO;

   4640  4 000323   040006 106400                    CMPC    fill='040'O
         4 000324   000001 000001 5                  ADSC9   1                        cn=0,n=1
         4 000325   000004 000006 2                  ADSC9   VSNREC+4,Q               cn=0,n=6
         4 000326   000342 603000 4                  TRC     s:4648

      322     4641                    /*E*     ERROR: FXU-E$DUPVSN-E
      323     4642                    *        MESSAGE:Volume %U1 is doubly catalogued.
      324     4643                    */
      325     4644    4               ERRCODE=FXU$E$DUPVSN;

   4644  4 000327   000001 236000 1                  LDQ     FXU$E$DUPVSN
         4 000330   000000 756000 xsym               STQ     ERRCODE

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:70   
      326     4645    4               CALL FXP$RVID(VID1.SNLIST.VSN(I));

   4645  4 000331   200004 236100                    LDQ     I,,AUTO
         4 000332   000024 736000                    QLS     20
         4 000333   000003 036000 5                  ADLQ    3
         4 000334   200010 756100                    STQ     J+3,,AUTO
         4 000335   200010 630500                    EPPR0   J+3,,AUTO
         4 000336   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000337   000000 701000 xent               TSX1    FXP$RVID
         4 000340   000000 011000                    NOP     0

      327     4646    4               ALTRETURN;

   4646  4 000341   000000 702200 xent               TSX2  ! X66_AALT

      328     4647    4               END;
      329     4648    3            ELSE VSNREC.SCT.PSN(J)=PSNREC.PSN;

   4648  4 000342   200005 236100                    LDQ     J,,AUTO
         4 000343   000003 402007                    MPY     3,DL
         4 000344   000002 736000                    QLS     2
         4 000345   040006 100400                    MLR     fill='040'O
         4 000346   000000 000006 xsym               ADSC9   VIDBUF                   cn=0,n=6
         4 000347   000004 000006 2                  ADSC9   VSNREC+4,Q               cn=0,n=6

      330     4649    3            IF J>VSNREC.SCNT THEN VSNREC.SCNT=J;

   4649  4 000350   000000 236000 2                  LDQ     VSNREC
         4 000351   000033 772000                    QRL     27
         4 000352   200005 116100                    CMPQ    J,,AUTO
         4 000353   000357 603000 4                  TRC     s:4650

   4649  4 000354   200005 236100                    LDQ     J,,AUTO
         4 000355   000033 736000                    QLS     27
         4 000356   000000 552040 2                  STBQ    VSNREC,'40'O

      331     4650    3            CALL CATW_VSN;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:71   

   4650  4 000357   001420 701000 4                  TSX1    CATW_VSN
         4 000360   000000 011000                    NOP     0

      332     4651    3            END;

   4651  4 000361   200004 235100                    LDA     I,,AUTO
         4 000362   000001 035007                    ADLA    1,DL
         4 000363   200004 755100                    STA     I,,AUTO
         4 000364   200004 236100                    LDQ     I,,AUTO
         4 000365   000003 116000 xsym               CMPQ    VIDBUF+3
         4 000366   000236 602000 4                  TNC     s:4627

      333     4652    2         CALL CATW_PSN ALTRET(RETALT);

   4652  4 000367   001360 701000 4                  TSX1    CATW_PSN
         4 000370   000647 702000 4                  TSX2    RETALT

      334     4653    2         IF ERRCODE THEN ALTRETURN; /* PROBABLY CATMNT WANTING TO MOUNT */

   4653  4 000371   000000 235000 xsym               LDA     ERRCODE
         4 000372   000374 600000 4                  TZE     s:4654

   4653  4 000373   000000 702200 xent               TSX2  ! X66_AALT

      335     4654    2         RETURN;

   4654  4 000374   000000 702200 xent               TSX2  ! X66_ARET

      336     4655    2         END;
      337     4656    2      ELSE DO;

      338     4657    2         CALL CHARBIN(I,PBLK.SUBLK$(1)->PSYM.TEXT);

   4657  4 000375   100004 236100                    LDQ     4,,PR1
         4 000376   000033 772000                    QRL     27
         4 000377   000000 621006                    EAX1    0,QL
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:72   
         4 000400   000100 305540                    DTB
         4 000401   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 000402   200010 000010                    NDSC9   J+3,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         4 000403   200011 235100                    LDA     J+4,,AUTO
         4 000404   200004 755100                    STA     I,,AUTO

      339     4658    2         VSNKEY.VSN=I;

   4658  4 000405   200004 236100                    LDQ     I,,AUTO
         4 000406   000124 552034 2                  STBQ    VSNKEY,'34'O

      340     4659    2         IF PARM~=%E$CATALOG THEN CALL CATR_VSN ALTRET(RETALT);

   4659  4 000407   200003 471500                    LDP1    @PARM,,AUTO
         4 000410   100000 235100                    LDA     0,,PR1
         4 000411   000170 115007                    CMPA    120,DL
         4 000412   000416 600000 4                  TZE     s:4660

   4659  4 000413   001406 701000 4                  TSX1    CATR_VSN
         4 000414   000647 702000 4                  TSX2    RETALT
         4 000415   000421 710000 4                  TRA     s:4661

      341     4660    2         ELSE VSNREC='0'B;

   4660  4 000416   000000 100400                    MLR     fill='000'O
         4 000417   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000420   000000 000504 2                  ADSC9   VSNREC                   cn=0,n=324

      342     4661    3         IF PARM=%E$CATDEL THEN DO;

   4661  4 000421   200003 470500                    LDP0    @PARM,,AUTO
         4 000422   000000 235100                    LDA     0,,PR0
         4 000423   000172 115007                    CMPA    122,DL
         4 000424   000476 601000 4                  TNZ     s:4678

      343     4662    3            VID1.VOLCNT=0; /* FLAG FOR DELETE BY VSN */

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:73   
   4662  4 000425   000000 220003                    LDX0    0,DU
         4 000426   000004 440000 xsym               SXL0    CSTAT+4

      344     4663    3   CATD_EXIT: CALL CATD_ ALTRET(RETALT);

   4663  4 000427   001447 701000 4     CATD_EXIT    TSX1    CATD_
         4 000430   000647 702000 4                  TSX2    RETALT

      345     4664    3            IF VID1.VOLCNT~=0

   4664  4 000431   000004 720000 xsym               LXL0    CSTAT+4
         4 000432   000475 600000 4                  TZE     s:4676

      346     4665    4            THEN DO I=0 TO PSNREC.VOLCNT-1;

   4665  4 000433   200004 450100                    STZ     I,,AUTO
         4 000434   000472 710000 4                  TRA     s:4675+3

      347     4666                    /* De-catalog the PSN from all associated VSN records */
      348     4667    4               VSNKEY.VSN=PSNREC.VSN.N(I);

   4667  4 000435   200004 720100                    LXL0    I,,AUTO
         4 000436   000004 236010 xsym               LDQ     VIDBUF+4,X0
         4 000437   000124 552034 2                  STBQ    VSNKEY,'34'O

      349     4668    5               CALL CATR_VSN WHENRETURN DO;

   4668  4 000440   001406 701000 4                  TSX1    CATR_VSN
         4 000441   000467 702000 4                  TSX2    s:4675

      350     4669    5                  J=MAXIMUM(1,PSNREC.VSN.S(I))-1;

   4669  4 000442   200004 720100                    LXL0    I,,AUTO
         4 000443   000004 236010 xsym               LDQ     VIDBUF+4,X0
         4 000444   000033 772000                    QRL     27
         4 000445   000001 116007                    CMPQ    1,DL
         4 000446   000450 603000 4                  TRC     s:4669+6
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:74   
         4 000447   000001 236007                    LDQ     1,DL
         4 000450   000001 136007                    SBLQ    1,DL
         4 000451   200005 756100                    STQ     J,,AUTO

      351     4670    6                  IF VSNREC.SCT.PSN(J)=PSNREC.PSN THEN DO;

   4670  4 000452   000014 402007                    MPY     12,DL
         4 000453   040000 106406                    CMPC    fill='040'O
         4 000454   000004 000006 2                  ADSC9   VSNREC+4,Q               cn=0,n=6
         4 000455   000000 000006 xsym               ADSC9   VIDBUF                   cn=0,n=6
         4 000456   000467 601000 4                  TNZ     s:4675

      352     4671    6                     VSNREC.SCT.PSN(J)=BINASC(0);

   4671  4 000457   200005 236100                    LDQ     J,,AUTO
         4 000460   000003 402007                    MPY     3,DL
         4 000461   000002 736000                    QLS     2
         4 000462   040006 100400                    MLR     fill='040'O
         4 000463   000001 000001 5                  ADSC9   1                        cn=0,n=1
         4 000464   000004 000006 2                  ADSC9   VSNREC+4,Q               cn=0,n=6

      353     4672    6                     CALL CATW_VSN;

   4672  4 000465   001420 701000 4                  TSX1    CATW_VSN
         4 000466   000000 011000                    NOP     0

      354     4673    6                     END;

      355     4674    5                  END;

      356     4675    4               END;

   4675  4 000467   200004 235100                    LDA     I,,AUTO
         4 000470   000001 035007                    ADLA    1,DL
         4 000471   200004 755100                    STA     I,,AUTO
         4 000472   200004 236100                    LDQ     I,,AUTO
         4 000473   000003 116000 xsym               CMPQ    VIDBUF+3
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:75   
         4 000474   000435 602000 4                  TNC     s:4667

      357     4676    3            RETURN;

   4676  4 000475   000000 702200 xent               TSX2  ! X66_ARET

      358     4677    3            END;
      359     4678    2         J=0;

   4678  4 000476   200005 450100                    STZ     J,,AUTO

      360     4679    3         DO I=2 TO PBLK.NSUBLKS-1;

   4679  4 000477   000002 236007                    LDQ     2,DL
         4 000500   200004 756100                    STQ     I,,AUTO
         4 000501   000542 710000 4                  TRA     s:4684+3

      361     4680    3            IF PBLK.SUBLK$(I)->PBLK.CODE=%SETXCL#+1 THEN VSNREC.SCT.SCRATCH(J)='1'B;

   4680  4 000502   000000 470400 xsym               LDP0    BLK$
         4 000503   200004 720100                    LXL0    I,,AUTO
         4 000504   000003 471510                    LDP1    3,X0,PR0
         4 000505   100000 721100                    LXL1    0,,PR1
         4 000506   000013 101003                    CMPX1   11,DU
         4 000507   000516 601000 4                  TNZ     s:4681

   4680  4 000510   200005 236100                    LDQ     J,,AUTO
         4 000511   000003 402007                    MPY     3,DL
         4 000512   000000 622006                    EAX2    0,QL
         4 000513   400000 236007                    LDQ     -131072,DL
         4 000514   000005 256012 2                  ORSQ    VSNREC+5,X2
         4 000515   000537 710000 4                  TRA     s:4684

      362     4681    3            ELSE IF PBLK.SUBLK$(I)->PBLK.NDTYPE=%PL6SYM#

   4681  4 000516   100000 236100                    LDQ     0,,PR1
         4 000517   000077 376003                    ANQ     63,DU
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:76   
         4 000520   000030 116003                    CMPQ    24,DU
         4 000521   000532 601000 4                  TNZ     s:4683

      363     4682    3            THEN J=ASCBIN(PBLK.SUBLK$(I)->PSYM.TEXT)-ASCBIN('@');

   4682  4 000522   100004 236100                    LDQ     4,,PR1
         4 000523   000033 772000                    QRL     27
         4 000524   100004 236100                    LDQ     4,,PR1
         4 000525   000022 772000                    QRL     18
         4 000526   000777 376007                    ANQ     511,DL
         4 000527   000100 136007                    SBLQ    64,DL
         4 000530   200005 756100                    STQ     J,,AUTO
         4 000531   000537 710000 4                  TRA     s:4684

      364     4683    3            ELSE VSNREC.SCT.SCRATCH(J)='0'B;

   4683  4 000532   200005 236100                    LDQ     J,,AUTO
         4 000533   000003 402007                    MPY     3,DL
         4 000534   000000 622006                    EAX2    0,QL
         4 000535   000002 236000 5                  LDQ     2
         4 000536   000005 356012 2                  ANSQ    VSNREC+5,X2

      365     4684    3            END;

   4684  4 000537   200004 235100                    LDA     I,,AUTO
         4 000540   000001 035007                    ADLA    1,DL
         4 000541   200004 755100                    STA     I,,AUTO
         4 000542   000000 470400 xsym               LDP0    BLK$
         4 000543   000001 236100                    LDQ     1,,PR0
         4 000544   000022 772000                    QRL     18
         4 000545   200004 116100                    CMPQ    I,,AUTO
         4 000546   000550 600000 4                  TZE     s:4685
         4 000547   000502 603000 4                  TRC     s:4680

      366     4685    2         VSNREC.VSN=VSNKEY.VSN;

   4685  4 000550   000124 236000 2                  LDQ     VSNKEY
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:77   
         4 000551   000000 552034 2                  STBQ    VSNREC,'34'O

      367     4686    3         IF VSNREC.TYPE<BINASC(0) THEN DO;

   4686  4 000552   040000 106400                    CMPC    fill='040'O
         4 000553   000001 000010 2                  ADSC9   VSNREC+1                 cn=0,n=8
         4 000554   000001 000001 5                  ADSC9   1                        cn=0,n=1
         4 000555   000644 603000 4                  TRC     VSN_NOVID

   4684  4 000556                       VSN_MNTXIT   null
      368     4687    3   VSN_MNTXIT:; /* ENTRY FOR CATMNT */
      369     4688    3            I=VSNREC.VSN;

   4688  4 000556   000000 236000 2                  LDQ     VSNREC
         4 000557   000032 376000 xsym               ANQ     B_VECTNIL+26
         4 000560   200004 756100                    STQ     I,,AUTO

      370     4689    3            CALL FXP$RVID(I)ALTRET(VSN_NOVID);

   4689  4 000561   200004 630500                    EPPR0   I,,AUTO
         4 000562   200010 450500                    STP0    J+3,,AUTO
         4 000563   200010 630500                    EPPR0   J+3,,AUTO
         4 000564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000565   000000 701000 xent               TSX1    FXP$RVID
         4 000566   000644 702000 4                  TSX2    VSN_NOVID

      371     4690    3            VSNREC.TYPE=F$DCB.ACCT#;

   4690  4 000567   000000 470400 xsym               LDP0    M$DP$
         4 000570   000020 237100                    LDAQ    16,,PR0
         4 000571   000001 755000 2                  STA     VSNREC+1
         4 000572   000002 756000 2                  STQ     VSNREC+2

      372     4691    3            IF VIDBUF.SECTSTRT(0)>=F$DCB.IXTNSIZE# THEN VIDBUF.SECTSTRT(0)=0;

   4691  4 000573   000010 236000 xsym               LDQ     VIDBUF+8
         4 000574   000577 604000 4                  TMI     s:4691+4
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:78   
         4 000575   000041 116100                    CMPQ    33,,PR0
         4 000576   000600 604000 4                  TMI     s:4692

   4691  4 000577   000010 450000 xsym               STZ     VIDBUF+8

      373     4692    3            I=0;

   4692  4 000600   200004 450100                    STZ     I,,AUTO

      374     4693    4            DO WHILE(VIDBUF.SECTSTRT(I)~=F$DCB.IXTNSIZE#);

   4693  4 000601   200004 720100                    LXL0    I,,AUTO
         4 000602   000010 236010 xsym               LDQ     VIDBUF+8,X0
         4 000603   000606 604000 4                  TMI     s:4694
         4 000604   000041 116100                    CMPQ    33,,PR0
         4 000605   000644 600000 4                  TZE     VSN_NOVID

      375     4694    4               VSNREC.SCNT=I;

   4694  4 000606   200004 236100                    LDQ     I,,AUTO
         4 000607   000033 736000                    QLS     27
         4 000610   000000 552040 2                  STBQ    VSNREC,'40'O

      376     4695    4               IF VIDBUF.SECTSTRT(I+1)>=F$DCB.IXTNSIZE#

   4695  4 000611   000000 470400 xsym               LDP0    M$DP$
         4 000612   200004 720100                    LXL0    I,,AUTO
         4 000613   000011 236010 xsym               LDQ     VIDBUF+9,X0
         4 000614   000625 604000 4                  TMI     s:4698
         4 000615   000041 116100                    CMPQ    33,,PR0
         4 000616   000625 605000 4                  TPL     s:4698
         4 000617   000010 236010 xsym               LDQ     VIDBUF+8,X0
         4 000620   000011 116010 xsym               CMPQ    VIDBUF+9,X0
         4 000621   000625 603000 4                  TRC     s:4698
         4 000622   200004 235100                    LDA     I,,AUTO
         4 000623   000031 115007                    CMPA    25,DL
         4 000624   000627 601000 4                  TNZ     s:4699
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:79   

      377     4696    4                 OR VIDBUF.SECTSTRT(I)>=VIDBUF.SECTSTRT(I+1)
      378     4697    4                 OR I=SIZEW(VIDBUF.SECTSTRT)-1
      379     4698    4               THEN VIDBUF.SECTSTRT(I+1)=F$DCB.IXTNSIZE#;

   4698  4 000625   000041 235100                    LDA     33,,PR0
         4 000626   000011 755010 xsym               STA     VIDBUF+9,X0

      380     4699    4               VSNREC.SCT.SIZE(I)=VIDBUF.SECTSTRT(I+1)-VIDBUF.SECTSTRT(I);

   4699  4 000627   200004 236100                    LDQ     I,,AUTO
         4 000630   000003 402007                    MPY     3,DL
         4 000631   000000 621006                    EAX1    0,QL
         4 000632   000011 236010 xsym               LDQ     VIDBUF+9,X0
         4 000633   000010 136010 xsym               SBLQ    VIDBUF+8,X0
         4 000634   000003 756011 2                  STQ     VSNREC+3,X1

      381     4700    4               I=I+1;

   4700  4 000635   200004 235100                    LDA     I,,AUTO
         4 000636   000001 035007                    ADLA    1,DL
         4 000637   200004 755100                    STA     I,,AUTO

      382     4701    4               END;

   4701  4 000640   000010 236005 xsym               LDQ     VIDBUF+8,AL
         4 000641   000606 604000 4                  TMI     s:4694
         4 000642   000041 116100                    CMPQ    33,,PR0
         4 000643   000606 601000 4                  TNZ     s:4694

      383     4702    3            END;

   4699  4 000644                       VSN_NOVID    null
      384     4703    2   VSN_NOVID:;
      385     4704    2         CALL CATW_VSN ALTRET(RETALT);

   4704  4 000644   001420 701000 4                  TSX1    CATW_VSN
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:80   
         4 000645   000647 702000 4                  TSX2    RETALT

      386     4705    2         RETURN;

   4705  4 000646   000000 702200 xent               TSX2  ! X66_ARET

   4699  4 000647                       RETALT       null
      387     4706    2         END;
      388     4707                    /**/
      389     4708    1   RETALT:;
      390     4709    1      IF ADDR(PARM)=ADDR(NIL) AND NOT ERRCODE THEN RETURN;

   4709  4 000647   200003 236100                    LDQ     @PARM,,AUTO
         4 000650   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000651   000655 601000 4                  TNZ     s:4710
         4 000652   000000 235000 xsym               LDA     ERRCODE
         4 000653   000655 601000 4                  TNZ     s:4710

   4709  4 000654   000000 702200 xent               TSX2  ! X66_ARET

      391     4710    1      ERRCODE=B$TCB.ALT$->B$ALT.ERR;

   4710  4 000655   000000 470400 xsym               LDP0    B$TCB$
         4 000656   000000 471500                    LDP1    0,,PR0
         4 000657   100102 236100                    LDQ     66,,PR1
         4 000660   000000 756000 xsym               STQ     ERRCODE

      392     4711    1      ALTRETURN;

   4711  4 000661   000000 702200 xent               TSX2  ! X66_AALT

      393     4712        %EJECT;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:81   
      394     4713                    /*E*     ERROR: FXP-E$CATLIST-0
      395     4714                    *        MESSAGE:CATList [{vsn|DP#set} [>]] - list catalog
      396     4715                    */
      397     4716    1   FXU$CATL: ENTRY(PARM)ALTRET;

   4716  4 000662   000000 700200 xent  FXU$CATL     TSX0  ! X66_AUTO_1
         4 000663   000012 000001                    ZERO    10,1

      398     4717    1      IF USW THEN PBLK.NSUBLKS=3;

   4717  4 000664   000000 234000 xsym               SZN     USW
         4 000665   000671 605000 4                  TPL     s:4718

   4717  4 000666   000003 220003                    LDX0    3,DU
         4 000667   000000 470400 xsym               LDP0    BLK$
         4 000670   000001 740100                    STX0    1,,PR0

      399     4718    1      IF PBLK.NSUBLKS~=0

   4718  4 000671   000000 470400 xsym               LDP0    BLK$
         4 000672   000001 220100                    LDX0    1,,PR0
         4 000673   000757 600000 4                  TZE     s:4735

      400     4719    2      THEN IF PBLK.SUBLK$(1)->PBLK.CODE~=0 THEN DO;

   4719  4 000674   000004 471500                    LDP1    4,,PR0
         4 000675   100000 721100                    LXL1    0,,PR1
         4 000676   000723 600000 4                  TZE     s:4727

      401     4720    2         PSNKEY.PSN=PBLK.SUBLK$(1)->PSYM.TEXT;

   4720  4 000677   100004 236100                    LDQ     4,,PR1
         4 000700   000033 772000                    QRL     27
         4 000701   000000 622006                    EAX2    0,QL
         4 000702   040000 100540                    MLR     fill='040'O
         4 000703   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         4 000704   000121 200007 2                  ADSC9   PSNKEY                   cn=1,n=7
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:82   

      402     4721    2         PSNKEY.VSN='0'B;

   4721  4 000705   000123 450000 2                  STZ     PSNKEY+2

      403     4722    2         CALL CATR_PSN;

   4722  4 000706   001351 701000 4                  TSX1    CATR_PSN
         4 000707   000000 011000                    NOP     0

      404     4723    2         CALL CATR_NXT;

   4723  4 000710   001456 701000 4                  TSX1    CATR_NXT
         4 000711   000000 011000                    NOP     0

      405     4724    2         IF PBLK.NSUBLKS=2 AND RKEY.P.SN~=PSNKEY.PSN THEN RETURN;

   4724  4 000712   000000 470400 xsym               LDP0    BLK$
         4 000713   000001 220100                    LDX0    1,,PR0
         4 000714   000002 100003                    CMPX0   2,DU
         4 000715   000765 601000 4                  TNZ     s:4739
         4 000716   040000 106400                    CMPC    fill='040'O
         4 000717   000125 200007 2                  ADSC9   RKEY                     cn=1,n=7
         4 000720   000121 200007 2                  ADSC9   PSNKEY                   cn=1,n=7
         4 000721   000765 600000 4                  TZE     s:4739

   4724  4 000722   000000 702200 xent               TSX2  ! X66_ARET

      406     4725    2         END;
      407     4726    2      ELSE DO;

      408     4727    2         CALL CHARBIN(I,PBLK.SUBLK$(1)->PSYM.TEXT);

   4727  4 000723   100004 236100                    LDQ     4,,PR1
         4 000724   000033 772000                    QRL     27
         4 000725   000000 622006                    EAX2    0,QL
         4 000726   000100 305540                    DTB
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:83   
         4 000727   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         4 000730   200010 000010                    NDSC9   J+3,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         4 000731   200011 235100                    LDA     J+4,,AUTO
         4 000732   200004 755100                    STA     I,,AUTO

      409     4728    2         VSNKEY.VSN=I;

   4728  4 000733   200004 236100                    LDQ     I,,AUTO
         4 000734   000124 552034 2                  STBQ    VSNKEY,'34'O

      410     4729    2         CALL CATR_VSN;

   4729  4 000735   001406 701000 4                  TSX1    CATR_VSN
         4 000736   000000 011000                    NOP     0

      411     4730    2         IF VSNREC='0'B THEN IF PBLK.NSUBLKS=2 THEN RETURN;

   4730  4 000737   000000 106400                    CMPC    fill='000'O
         4 000740   000000 000504 2                  ADSC9   VSNREC                   cn=0,n=324
         4 000741   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         4 000742   000753 601000 4                  TNZ     s:4732

   4730  4 000743   000000 470400 xsym               LDP0    BLK$
         4 000744   000001 220100                    LDX0    1,,PR0
         4 000745   000002 100003                    CMPX0   2,DU
         4 000746   000750 601000 4                  TNZ     s:4731

   4730  4 000747   000000 702200 xent               TSX2  ! X66_ARET

      412     4731    2         ELSE CALL CATR_NXT;

   4731  4 000750   001456 701000 4                  TSX1    CATR_NXT
         4 000751   000000 011000                    NOP     0
         4 000752   000765 710000 4                  TRA     s:4739

      413     4732    2         ELSE RKEY=VSNKEY;

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:84   
   4732  4 000753   000000 100400                    MLR     fill='000'O
         4 000754   000124 000004 2                  ADSC9   VSNKEY                   cn=0,n=4
         4 000755   000125 000014 2                  ADSC9   RKEY                     cn=0,n=12

      414     4733    2         END;

   4733  4 000756   000765 710000 4                  TRA     s:4739

      415     4734    2      ELSE DO;

      416     4735    2         VSNKEY.VSN=0;

   4735  4 000757   000000 236003                    LDQ     0,DU
         4 000760   000124 552034 2                  STBQ    VSNKEY,'34'O

      417     4736    2         CALL CATR_VSN;

   4736  4 000761   001406 701000 4                  TSX1    CATR_VSN
         4 000762   000000 011000                    NOP     0

      418     4737    2         CALL CATR_NXT;

   4737  4 000763   001456 701000 4                  TSX1    CATR_NXT
         4 000764   000000 011000                    NOP     0

      419     4738    2         END;

      420     4739    1      IF RKEY.L=3 THEN CALL FXP$PART(VSNHDR);

   4739  4 000765   000125 236000 2                  LDQ     RKEY
         4 000766   777000 376003                    ANQ     -512,DU
         4 000767   003000 116003                    CMPQ    1536,DU
         4 000770   000775 601000 4                  TNZ     s:4740

   4739  4 000771   000004 630400 5                  EPPR0   4
         4 000772   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000773   000000 701000 xent               TSX1    FXP$PART
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:85   
         4 000774   000000 011000                    NOP     0

      421     4740    2      DO WHILE (RKEY.L=3);

   4740  4 000775   000125 236000 2                  LDQ     RKEY
         4 000776   777000 376003                    ANQ     -512,DU
         4 000777   003000 116003                    CMPQ    1536,DU
         4 001000   001140 601000 4                  TNZ     s:4764

      422     4741    3         DO I=0 TO VSNREC.SCNT;

   4741  4 001001   200004 450100                    STZ     I,,AUTO
         4 001002   001102 710000 4                  TRA     s:4757+3

      423     4742    3            CALL FXP$PRINT;

   4742  4 001003   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001004   000000 701000 xent               TSX1    FXP$PRINT
         4 001005   000000 011000                    NOP     0

      424     4743    3            VSNLST.TYPE=VSNREC.TYPE;

   4743  4 001006   040000 100400                    MLR     fill='040'O
         4 001007   000001 000010 2                  ADSC9   VSNREC+1                 cn=0,n=8
         4 001010   000130 000011 2                  ADSC9   VSNLST                   cn=0,n=9

      425     4744    3            VSNLST.PSN=VSNREC.SCT.PSN(I);

   4744  4 001011   200004 236100                    LDQ     I,,AUTO
         4 001012   000014 402007                    MPY     12,DL
         4 001013   040000 100406                    MLR     fill='040'O
         4 001014   000004 000006 2                  ADSC9   VSNREC+4,Q               cn=0,n=6
         4 001015   000132 200007 2                  ADSC9   VSNLST+2                 cn=1,n=7

      426     4745    3            CALL BINCHAR(VSNLST.VSN,VSNREC.VSN);

   4745  4 001016   000000 236000 2                  LDQ     VSNREC
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:86   
         4 001017   000032 376000 xsym               ANQ     B_VECTNIL+26
         4 001020   000000 235003                    LDA     0,DU
         4 001021   200010 757100                    STAQ    J+3,,AUTO
         4 001022   000000 301500                    BTD
         4 001023   200010 000010                    NDSC9   J+3,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         4 001024   000135 430011 2                  NDSC9   VSNLST+5                 cn=2,s=nosgn,sf=0,n=9

      427     4746    3            CALL EDITCHAR(VSNLST.VSN,0,8,'110'O,VSNLST.VSN);

   4746  4 001025   000000 024400                    MVNE
         4 001026   000135 430011 2                  NDSC9   VSNLST+5                 cn=2,s=nosgn,sf=0,n=9
         4 001027   000005 000001 5                  ADSC9   5                        cn=0,n=1
         4 001030   000135 400010 2                  ADSC9   VSNLST+5                 cn=2,n=8

      428     4747    4            IF VSNREC.SCNT~=0 THEN DO;

   4747  4 001031   000000 236000 2                  LDQ     VSNREC
         4 001032   777000 316003                    CANQ    -512,DU
         4 001033   001045 600000 4                  TZE     s:4752

      429     4748    4               VSNLST.VSN=SUBSTR(VSNLST.VSN,1,8);

   4748  4 001034   040000 100400                    MLR     fill='040'O
         4 001035   000135 600010 2                  ADSC9   VSNLST+5                 cn=3,n=8
         4 001036   000135 400011 2                  ADSC9   VSNLST+5                 cn=2,n=9

      430     4749    4               CALL INSERT(VSNLST.VSN,8,1,

   4749  4 001037   200004 236100                    LDQ     I,,AUTO
         4 001040   000101 036007                    ADLQ    65,DL
         4 001041   000033 736000                    QLS     27
         4 001042   000001 276000 5                  ORQ     1
         4 001043   000022 772000                    QRL     18
         4 001044   000137 552010 2                  STBQ    VSNLST+7,'10'O

      431     4750    4                 BINASC(I+ASCBIN('A')));
      432     4751    4               END;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:87   

      433     4752    3            CALL BINCHAR(VSNLST.SIZE,VSNREC.SCT.SIZE(I));

   4752  4 001045   200004 236100                    LDQ     I,,AUTO
         4 001046   000003 402007                    MPY     3,DL
         4 001047   000003 235006 2                  LDA     VSNREC+3,QL
         4 001050   000044 773000                    LRL     36
         4 001051   200010 757100                    STAQ    J+3,,AUTO
         4 001052   000000 301500                    BTD
         4 001053   200010 000010                    NDSC9   J+3,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         4 001054   000134 030006 2                  NDSC9   VSNLST+4                 cn=0,s=nosgn,sf=0,n=6

      434     4753    3            CALL EDITCHAR(VSNLST.SIZE,0,5,'105'O,VSNLST.SIZE);

   4753  4 001055   000000 024400                    MVNE
         4 001056   000134 030006 2                  NDSC9   VSNLST+4                 cn=0,s=nosgn,sf=0,n=6
         4 001057   000006 000001 5                  ADSC9   6                        cn=0,n=1
         4 001060   000134 000005 2                  ADSC9   VSNLST+4                 cn=0,n=5

      435     4754    3            IF VSNREC.SCT.SCRATCH(I) THEN VSNLST.FLG='*';

   4754  4 001061   200004 236100                    LDQ     I,,AUTO
         4 001062   000003 402007                    MPY     3,DL
         4 001063   000005 236006 2                  LDQ     VSNREC+5,QL
         4 001064   400000 316007                    CANQ    -131072,DL
         4 001065   001071 600000 4                  TZE     s:4755

   4754  4 001066   052000 236003                    LDQ     21504,DU
         4 001067   000140 552040 2                  STBQ    VSNLST+8,'40'O
         4 001070   001073 710000 4                  TRA     s:4756

      436     4755    3            ELSE VSNLST.FLG=' ';

   4755  4 001071   040000 236003                    LDQ     16384,DU
         4 001072   000140 552040 2                  STBQ    VSNLST+8,'40'O

      437     4756    3            CALL FXP$PART(VSNTXT);
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:88   

   4756  4 001073   000007 630400 5                  EPPR0   7
         4 001074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001075   000000 701000 xent               TSX1    FXP$PART
         4 001076   000000 011000                    NOP     0

      438     4757    3            END;

   4757  4 001077   200004 235100                    LDA     I,,AUTO
         4 001100   000001 035007                    ADLA    1,DL
         4 001101   200004 755100                    STA     I,,AUTO
         4 001102   000000 236000 2                  LDQ     VSNREC
         4 001103   000033 772000                    QRL     27
         4 001104   200004 116100                    CMPQ    I,,AUTO
         4 001105   001003 603000 4                  TRC     s:4742

      439     4758    2         IF PBLK.NSUBLKS=2 THEN RETURN;

   4758  4 001106   000000 470400 xsym               LDP0    BLK$
         4 001107   000001 220100                    LDX0    1,,PR0
         4 001110   000002 100003                    CMPX0   2,DU
         4 001111   001113 601000 4                  TNZ     s:4759

   4758  4 001112   000000 702200 xent               TSX2  ! X66_ARET

      440     4759    2         CALL CATR_NXT;

   4759  4 001113   001456 701000 4                  TSX1    CATR_NXT
         4 001114   000000 011000                    NOP     0

      441     4760    2         IF RKEY.L=11 THEN IF PBLK.NSUBLKS=0 THEN CALL FXP$PRINT;

   4760  4 001115   000125 236000 2                  LDQ     RKEY
         4 001116   777000 376003                    ANQ     -512,DU
         4 001117   013000 116003                    CMPQ    5632,DU
         4 001120   001131 601000 4                  TNZ     s:4762

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:89   
   4760  4 001121   000000 470400 xsym               LDP0    BLK$
         4 001122   000001 220100                    LDX0    1,,PR0
         4 001123   001130 601000 4                  TNZ     s:4761

   4760  4 001124   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001125   000000 701000 xent               TSX1    FXP$PRINT
         4 001126   000000 011000                    NOP     0
         4 001127   001131 710000 4                  TRA     s:4762

      442     4761    2         ELSE RETURN;

   4761  4 001130   000000 702200 xent               TSX2  ! X66_ARET

      443     4762    2         IF BREAK~=0 THEN ALTRETURN;

   4762  4 001131   000000 235000 xsym               LDA     BREAK
         4 001132   001134 600000 4                  TZE     s:4763

   4762  4 001133   000000 702200 xent               TSX2  ! X66_AALT

      444     4763    2         END;

   4763  4 001134   000125 236000 2                  LDQ     RKEY
         4 001135   777000 376003                    ANQ     -512,DU
         4 001136   003000 116003                    CMPQ    1536,DU
         4 001137   001001 600000 4                  TZE     s:4741

      445     4764    1      IF RKEY.L=11 THEN CALL FXP$PART(PSNHDR);

   4764  4 001140   013000 116003                    CMPQ    5632,DU
         4 001141   001146 601000 4                  TNZ     s:4765

   4764  4 001142   000010 630400 5                  EPPR0   8
         4 001143   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001144   000000 701000 xent               TSX1    FXP$PART
         4 001145   000000 011000                    NOP     0

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:90   
      446     4765    2      DO WHILE(RKEY.L=11);

   4765  4 001146   000125 236000 2                  LDQ     RKEY
         4 001147   777000 376003                    ANQ     -512,DU
         4 001150   013000 116003                    CMPQ    5632,DU
         4 001151   001264 601000 4                  TNZ     s:4782

      447     4766    2         IF PBLK.NSUBLKS=2 AND RKEY.P.SN~=PSNKEY.PSN THEN RETURN;

   4766  4 001152   000000 470400 xsym               LDP0    BLK$
         4 001153   000001 220100                    LDX0    1,,PR0
         4 001154   000002 100003                    CMPX0   2,DU
         4 001155   001163 601000 4                  TNZ     s:4767
         4 001156   040000 106400                    CMPC    fill='040'O
         4 001157   000125 200007 2                  ADSC9   RKEY                     cn=1,n=7
         4 001160   000121 200007 2                  ADSC9   PSNKEY                   cn=1,n=7
         4 001161   001163 600000 4                  TZE     s:4767

   4766  4 001162   000000 702200 xent               TSX2  ! X66_ARET

      448     4767    2         CALL FXP$PRINT;

   4767  4 001163   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001164   000000 701000 xent               TSX1    FXP$PRINT
         4 001165   000000 011000                    NOP     0

      449     4768    2         PSNLST.PSN=PSNREC.PSN;

   4768  4 001166   040000 100400                    MLR     fill='040'O
         4 001167   000000 000006 xsym               ADSC9   VIDBUF                   cn=0,n=6
         4 001170   000141 600007 2                  ADSC9   PSNLST                   cn=3,n=7

      450     4769    3         DO I=0 TO 4;

   4769  4 001171   200004 450100                    STZ     I,,AUTO

      451     4770    3            IF MNTS.N(I)=PSNREC.DEFMOUNT THEN PSNLST.MNT=MNTS.T(I);
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:91   

   4770  4 001172   200004 720100                    LXL0    I,,AUTO
         4 001173   000020 236010 1                  LDQ     MNTS,X0
         4 001174   000002 116000 xsym               CMPQ    VIDBUF+2
         4 001175   001203 601000 4                  TNZ     s:4771

   4770  4 001176   200004 235100                    LDA     I,,AUTO
         4 001177   000002 735000                    ALS     2
         4 001200   040000 100405                    MLR     fill='040'O
         4 001201   000025 000004 1                  ADSC9   MNTS+5,A                 cn=0,n=4
         4 001202   000143 400004 2                  ADSC9   PSNLST+2                 cn=2,n=4

      452     4771    3            END;

   4771  4 001203   200004 235100                    LDA     I,,AUTO
         4 001204   000001 035007                    ADLA    1,DL
         4 001205   200004 755100                    STA     I,,AUTO
         4 001206   000005 115007                    CMPA    5,DL
         4 001207   001172 602000 4                  TNC     s:4770

      453     4772    2         CALL FXP$PART(PSNTXT);

   4772  4 001210   000011 630400 5                  EPPR0   9
         4 001211   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001212   000000 701000 xent               TSX1    FXP$PART
         4 001213   000000 011000                    NOP     0

      454     4773    3         DO I=0 TO PSNREC.VOLCNT-1;

   4773  4 001214   200004 450100                    STZ     I,,AUTO
         4 001215   001250 710000 4                  TRA     s:4778+3

      455     4774    3            PSNVSN.N=PSNREC.VSN.N(I);

   4774  4 001216   200004 720100                    LXL0    I,,AUTO
         4 001217   000004 236010 xsym               LDQ     VIDBUF+4,X0
         4 001220   000032 376000 xsym               ANQ     B_VECTNIL+26
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:92   
         4 001221   000146 756000 2                  STQ     PSNVSN+1

      456     4775    3            CALL FXP$PARN(PSNVSN);

   4775  4 001222   000012 630400 5                  EPPR0   10
         4 001223   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001224   000000 701000 xent               TSX1    FXP$PARN
         4 001225   000000 011000                    NOP     0

      457     4776    3            VSNLST.FLG=BINASC(PSNREC.VSN.S(I)+ASCBIN('@'));

   4776  4 001226   200004 720100                    LXL0    I,,AUTO
         4 001227   000004 236010 xsym               LDQ     VIDBUF+4,X0
         4 001230   000033 772000                    QRL     27
         4 001231   000100 036007                    ADLQ    64,DL
         4 001232   000033 736000                    QLS     27
         4 001233   000001 276000 5                  ORQ     1
         4 001234   000140 552040 2                  STBQ    VSNLST+8,'40'O

      458     4777    3            IF VSNLST.FLG~='@' THEN CALL FXP$PART(SCTTXT);

   4777  4 001235   000140 236000 2                  LDQ     VSNLST+8
         4 001236   777000 376003                    ANQ     -512,DU
         4 001237   100000 116003                    CMPQ    32768,DU
         4 001240   001245 600000 4                  TZE     s:4778

   4777  4 001241   000013 630400 5                  EPPR0   11
         4 001242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001243   000000 701000 xent               TSX1    FXP$PART
         4 001244   000000 011000                    NOP     0

      459     4778    3            END;

   4778  4 001245   200004 235100                    LDA     I,,AUTO
         4 001246   000001 035007                    ADLA    1,DL
         4 001247   200004 755100                    STA     I,,AUTO
         4 001250   200004 236100                    LDQ     I,,AUTO
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:93   
         4 001251   000003 116000 xsym               CMPQ    VIDBUF+3
         4 001252   001216 602000 4                  TNC     s:4774

      460     4779    2         CALL CATR_NXT;

   4779  4 001253   001456 701000 4                  TSX1    CATR_NXT
         4 001254   000000 011000                    NOP     0

      461     4780    2         IF BREAK~=0 THEN ALTRETURN;

   4780  4 001255   000000 235000 xsym               LDA     BREAK
         4 001256   001260 600000 4                  TZE     s:4781

   4780  4 001257   000000 702200 xent               TSX2  ! X66_AALT

      462     4781    2         END;

   4781  4 001260   000125 236000 2                  LDQ     RKEY
         4 001261   777000 376003                    ANQ     -512,DU
         4 001262   013000 116003                    CMPQ    5632,DU
         4 001263   001152 600000 4                  TZE     s:4766

      463     4782    1      RETURN;

   4782  4 001264   000000 702200 xent               TSX2  ! X66_ARET

      464     4783        %EJECT;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:94   
      465     4784    1   FXU$CATMNT: ENTRY(PARM)ALTRET;

   4784  4 001265   000000 700200 xent  FXU$CATMNT   TSX0  ! X66_AUTO_1
         4 001266   000012 000001                    ZERO    10,1

      466     4785    1      ERRCODE='0'B;

   4785  4 001267   000000 450000 xsym               STZ     ERRCODE

      467     4786    2      IF VIDBUF.VOLCNT~=0 THEN DO;

   4786  4 001270   000004 720000 xsym               LXL0    VIDBUF+4
         4 001271   001340 600000 4                  TZE     MNT_NOPSN

      468     4787    2         PSNKEY.PSN=VIDBUF.PSN;

   4787  4 001272   040000 100400                    MLR     fill='040'O
         4 001273   000003 000006 xsym               ADSC9   VIDBUF+3                 cn=0,n=6
         4 001274   000121 200007 2                  ADSC9   PSNKEY                   cn=1,n=7

      469     4788    2         PSNKEY.VSN=VIDBUF.SNLIST.VSN(0);

   4788  4 001275   000500 236000 xsym               LDQ     VIDBUF+320
         4 001276   000123 756000 2                  STQ     PSNKEY+2

      470     4789    2         CALL CATR_PSN ALTRET(MNT_NOPSN);

   4789  4 001277   001351 701000 4                  TSX1    CATR_PSN
         4 001300   001340 702000 4                  TSX2    MNT_NOPSN

      471     4790    3         IF PSNREC.DEFMOUNT=%SETPRIV# OR PSNREC.DEFMOUNT=%SETPUB# THEN DO;

   4790  4 001301   000002 235000 xsym               LDA     VIDBUF+2
         4 001302   000011 115007                    CMPA    9,DL
         4 001303   001306 600000 4                  TZE     s:4791
         4 001304   000010 115007                    CMPA    8,DL
         4 001305   001334 601000 4                  TNZ     s:4797
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:95   

      472     4791    3            CSTAT.NUM=CSTAT.NUM+1;

   4791  4 001306   000000 236000 xsym               LDQ     CSTAT
         4 001307   000001 036007                    ADLQ    1,DL
         4 001310   000000 756000 xsym               STQ     CSTAT

      473     4792    3            CSTAT.SETS(CSTAT.NUM)='0'B;

   4792  4 001311   000000 235000 xsym               LDA     CSTAT
         4 001312   000001 735000                    ALS     1
         4 001313   000002 450005 xsym               STZ     CSTAT+2,AL
         4 001314   000003 450005 xsym               STZ     CSTAT+3,AL

      474     4793    3            CSTAT.SETS.DISP(CSTAT.NUM)=PSNREC.DEFMOUNT;

   4793  4 001315   000000 235000 xsym               LDA     CSTAT
         4 001316   000001 735000                    ALS     1
         4 001317   000002 236000 xsym               LDQ     VIDBUF+2
         4 001320   000011 736000                    QLS     9
         4 001321   000003 676005 xsym               ERQ     CSTAT+3,AL
         4 001322   777000 376007                    ANQ     -512,DL
         4 001323   000003 656005 xsym               ERSQ    CSTAT+3,AL

      475     4794    3            CSTAT.SETS.PSN(CSTAT.NUM)=PSNKEY.PSN;

   4794  4 001324   000000 235000 xsym               LDA     CSTAT
         4 001325   000001 735000                    ALS     1
         4 001326   000002 735000                    ALS     2
         4 001327   040005 100400                    MLR     fill='040'O
         4 001330   000121 200006 2                  ADSC9   PSNKEY                   cn=1,n=6
         4 001331   000002 000006 xsym               ADSC9   CSTAT+2,A                cn=0,n=6

      476     4795    3            ERRCODE='1'B;

   4795  4 001332   400000 236003                    LDQ     -131072,DU
         4 001333   000000 756000 xsym               STQ     ERRCODE
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:96   

      477     4796    3            END;

      478     4797    2         VID1.SNLIST=VIDBUF.SNLIST;

   4797  4 001334   000000 100400                    MLR     fill='000'O
         4 001335   000500 005400 xsym               ADSC9   VIDBUF+320               cn=0,n=2816
         4 001336   000500 005400 xsym               ADSC9   CSTAT+320                cn=0,n=2816

      479     4798    2         GOTO FIX_PSN;

   4798  4 001337   000234 710000 4                  TRA     FIX_PSN

   4795  4 001340                       MNT_NOPSN    null
      480     4799    2         END;
      481     4800    1   MNT_NOPSN:;
      482     4801    1      VSNKEY.VSN=VIDBUF.VSN;

   4801  4 001340   000002 236000 xsym               LDQ     VIDBUF+2
         4 001341   000124 552034 2                  STBQ    VSNKEY,'34'O

      483     4802    1      CALL CATR_VSN ALTRET(RETRET);

   4802  4 001342   001406 701000 4                  TSX1    CATR_VSN
         4 001343   001350 702000 4                  TSX2    RETRET

      484     4803    1      IF VSNREC.TYPE<BINASC(0) THEN GOTO VSN_MNTXIT;

   4803  4 001344   040000 106400                    CMPC    fill='040'O
         4 001345   000001 000010 2                  ADSC9   VSNREC+1                 cn=0,n=8
         4 001346   000001 000001 5                  ADSC9   1                        cn=0,n=1
         4 001347   000556 602000 4                  TNC     VSN_MNTXIT

   4803  4 001350                       RETRET       null
      485     4804    1   RETRET:;
      486     4805    1      RETURN;

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:97   
   4805  4 001350   000000 702200 xent               TSX2  ! X66_ARET

      487     4806        %EJECT;
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:98   
      488     4807    1   CATR_PSN: PROC ALTRET;

   4807  4 001351   200006 741300       CATR_PSN     STX1  ! J+1,,AUTO

      489     4808        %FPT_READ(FPTN=RPSN,KEY=PSNKEY,BUF=PSNREC,KEYS=YES,DCB=M$CAT);
      490     4847        %FPT_READ(FPTN=RNXT,KEY=RKEY,BUF=PSNREC,KEYR=YES,DCB=M$CAT);
      491     4886        %FPT_READ(FPTN=RVSN,KEY=VSNKEY,BUF=VSNREC,KEYS=YES,DCB=M$CAT);
      492     4925        %FPT_WRITE(FPTN=WPSN,KEY=PSNKEY,BUF=PSNREC,DCB=M$CAT);
      493     4956        %FPT_WRITE(FPTN=WVSN,KEY=VSNKEY,BUF=VSNREC,DCB=M$CAT);
      494     4987        %FPT_DELREC(FPTN=DREC,DCB=M$CAT);
      495     5006    2      CALL M$READ(RPSN)ALTRET(RETALT);

   5006  4 001352   000150 630400 2                  EPPR0   RPSN
         4 001353   440000 713400                    CLIMB   alt,read
         4 001354   401400 401760                    pmme    nvectors=4
         4 001355   001404 702000 4                  TSX2    RETALT

      496     5007    2      RETURN;

   5007  4 001356   200006 221300                    LDX1  ! J+1,,AUTO
         4 001357   000001 702211                    TSX2  ! 1,X1

      497     5008                    /**/
      498     5009    2   CATW_PSN: ENTRY ALTRET;

   5009  4 001360   200006 741300       CATW_PSN     STX1  ! J+1,,AUTO

      499     5010    2      WPSN.BUF_.BOUND=POFFC(ADDR(PSNREC.VSN(PSNREC.VOLCNT)),ADDR(PSNREC))-1;

   5010  4 001361   000014 236000 5                  LDQ     12
         4 001362   000020 772000                    QRL     16
         4 001363   200010 756100                    STQ     J+3,,AUTO
         4 001364   000003 236000 xsym               LDQ     VIDBUF+3
         4 001365   000022 736000                    QLS     18
         4 001366   000015 036000 5                  ADLQ    13
         4 001367   000020 772000                    QRL     16
         4 001370   200010 136100                    SBLQ    J+3,,AUTO
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:99   
         4 001371   000001 136007                    SBLQ    1,DL
         4 001372   000020 736000                    QLS     16
         4 001373   000226 676000 2                  ERQ     WPSN+4
         4 001374   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001375   000226 656000 2                  ERSQ    WPSN+4

      500     5011    2      CALL M$WRITE(WPSN)ALTRET(RETALT);

   5011  4 001376   000222 630400 2                  EPPR0   WPSN
         4 001377   440001 713400                    CLIMB   alt,write
         4 001400   401400 401760                    pmme    nvectors=4
         4 001401   001404 702000 4                  TSX2    RETALT

      501     5012    2      RETURN;

   5012  4 001402   200006 221300                    LDX1  ! J+1,,AUTO
         4 001403   000001 702211                    TSX2  ! 1,X1

      502     5013                    /**/
      503     5014    2   RETALT: ALTRETURN;

   5014  4 001404   200006 221300       RETALT       LDX1  ! J+1,,AUTO
         4 001405   000000 702211                    TSX2  ! 0,X1

      504     5015                    /**/
      505     5016    2   CATR_VSN: ENTRY ALTRET;

   5016  4 001406   200006 741300       CATR_VSN     STX1  ! J+1,,AUTO

      506     5017    2      VSNREC='0'B;

   5017  4 001407   000000 100400                    MLR     fill='000'O
         4 001410   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001411   000000 000504 2                  ADSC9   VSNREC                   cn=0,n=324

      507     5018    2      CALL M$READ(RVSN)ALTRET(RETALT);

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:100  
   5018  4 001412   000204 630400 2                  EPPR0   RVSN
         4 001413   440000 713400                    CLIMB   alt,read
         4 001414   401400 401760                    pmme    nvectors=4
         4 001415   001404 702000 4                  TSX2    RETALT

      508     5019    2      RETURN;

   5019  4 001416   200006 221300                    LDX1  ! J+1,,AUTO
         4 001417   000001 702211                    TSX2  ! 1,X1

      509     5020                    /**/
      510     5021    2   CATW_VSN: ENTRY ALTRET;

   5021  4 001420   200006 741300       CATW_VSN     STX1  ! J+1,,AUTO

      511     5022    2      WVSN.BUF_.BOUND=POFFC(ADDR(VSNREC.SCT(VSNREC.SCNT+1)),ADDR(VSNREC))-1;

   5022  4 001421   000000 236000 2                  LDQ     VSNREC
         4 001422   000033 772000                    QRL     27
         4 001423   000003 402007                    MPY     3,DL
         4 001424   000000 620006                    EAX0    0,QL
         4 001425   000016 236000 5                  LDQ     14
         4 001426   000020 772000                    QRL     16
         4 001427   200010 756100                    STQ     J+3,,AUTO
         4 001430   000000 636010                    EAQ     0,X0
         4 001431   000017 036000 5                  ADLQ    15
         4 001432   000020 772000                    QRL     16
         4 001433   200010 136100                    SBLQ    J+3,,AUTO
         4 001434   000001 136007                    SBLQ    1,DL
         4 001435   000020 736000                    QLS     16
         4 001436   000242 676000 2                  ERQ     WVSN+4
         4 001437   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001440   000242 656000 2                  ERSQ    WVSN+4

      512     5023    2      CALL M$WRITE(WVSN)ALTRET(RETALT);

   5023  4 001441   000236 630400 2                  EPPR0   WVSN
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:101  
         4 001442   440001 713400                    CLIMB   alt,write
         4 001443   401400 401760                    pmme    nvectors=4
         4 001444   001404 702000 4                  TSX2    RETALT

      513     5024    2      RETURN;

   5024  4 001445   200006 221300                    LDX1  ! J+1,,AUTO
         4 001446   000001 702211                    TSX2  ! 1,X1

      514     5025                    /**/
      515     5026    2   CATD_: ENTRY ALTRET;

   5026  4 001447   200006 741300       CATD_        STX1  ! J+1,,AUTO

      516     5027    2      CALL M$DELREC(DREC)ALTRET(RETALT);

   5027  4 001450   000252 630400 2                  EPPR0   DREC
         4 001451   440002 713400                    CLIMB   alt,+16386
         4 001452   401400 401760                    pmme    nvectors=4
         4 001453   001404 702000 4                  TSX2    RETALT

      517     5028    2      RETURN;

   5028  4 001454   200006 221300                    LDX1  ! J+1,,AUTO
         4 001455   000001 702211                    TSX2  ! 1,X1

      518     5029    2   CATR_NXT: ENTRY ALTRET;

   5029  4 001456   200006 741300       CATR_NXT     STX1  ! J+1,,AUTO

      519     5030    2      RKEY='0'B;

   5030  4 001457   000000 100400                    MLR     fill='000'O
         4 001460   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001461   000125 000014 2                  ADSC9   RKEY                     cn=0,n=12

      520     5031    2      PSNREC.PSN=' ';
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:102  

   5031  4 001462   040000 100400                    MLR     fill='040'O
         4 001463   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001464   000000 000006 xsym               ADSC9   VIDBUF                   cn=0,n=6

      521     5032    2      CALL M$READ(RNXT)ALTRET(RETALT);

   5032  4 001465   000166 630400 2                  EPPR0   RNXT
         4 001466   440000 713400                    CLIMB   alt,read
         4 001467   401400 401760                    pmme    nvectors=4
         4 001470   001404 702000 4                  TSX2    RETALT

      522     5033    2      IF RKEY.L=3 THEN VSNREC=PSNREC;

   5033  4 001471   000125 236000 2                  LDQ     RKEY
         4 001472   777000 376003                    ANQ     -512,DU
         4 001473   003000 116003                    CMPQ    1536,DU
         4 001474   001500 601000 4                  TNZ     s:5034

   5033  4 001475   000000 100400                    MLR     fill='000'O
         4 001476   000000 000504 xsym               ADSC9   VIDBUF                   cn=0,n=324
         4 001477   000000 000504 2                  ADSC9   VSNREC                   cn=0,n=324

      523     5034    2      RETURN;

   5034  4 001500   200006 221300                    LDX1  ! J+1,,AUTO
         4 001501   000001 702211                    TSX2  ! 1,X1
      524     5035    2   END;
      525     5036    1   END;
      526     5037        %EOD;

PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:103  
--  Include file information  --

   FX_PERR_C.:E05TOU  is referenced.
   FX_SUBS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   FX$CAT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$CATADM.
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:104  

 **** Variables and constants ****

  ****  Section 001 RoData FXU$CATADM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 FXU$E$DUPVSN               0-0-0/b STRC        r     1 FXU$E$NOVSN
    20-0-0/w STRC(360)   r     1 MNTS                      34-0-0/w STRC(153)   r     1 PSNHDR
    16-0-0/w STRC(72)    r     1 PSNTXT                    32-0-0/w STRC(72)    r     1 SCTTXT
     4-0-0/w STRC(351)   r     1 VSNHDR                     2-0-0/w STRC(72)    r     1 VSNTXT

  ****  Section 002  Data  FXU$CATADM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   252-0-0/d STRC(360)   r     1 DREC                     121-0-0/c STRC(108)   r     1 PSNKEY
   141-0-0/c STRC(126)   r     1 PSNLST                   145-0-0/w STRC(72)    r     1 PSNVSN
   125-0-0/c STRC(108)   r     1 RKEY                     166-0-0/d STRC(504)   r     1 RNXT
   150-0-0/d STRC(504)   r     1 RPSN                     204-0-0/d STRC(504)   r     1 RVSN
   124-0-0/b STRC        r     1 VSNKEY                   130-0-0/c STRC(297)   r     1 VSNLST
     0-0-0/w STRC(2916)  r     1 VSNREC                   222-0-0/d STRC(432)   r     1 WPSN
   236-0-0/d STRC(432)   r     1 WVSN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM                      4-0-0/w UBIN        r     1 I
     5-0-0/w UBIN        r     1 J                         *0-0-0/w UBIN        r     1 PARM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:105  

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 BLK$
     0-0-0/w UBIN        r     1 BREAK                      0-0-0/w STRC(36864) r     1 CSTAT
     0-0-0/b BIT         r     1 ERRCODE                    0-0-0/w PTR         r     1 M$DP$
     0-0-0/w STRC(36864) r     1 PSNREC                     0-0-0/b BIT         r     1 USW
     0-0-0/w STRC(36864) r     1 VID1                       0-0-0/w STRC(36864) r     1 VIDBUF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w PTR         r     1 BASED_PTR                  0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$CAT                      0-0-0/w STRC(144)   r     1 PBLK
     0-0-0/w ASTR(153)   r     1 PSYM


   Procedure FXU$CATADM requires 834 words for executable code.
   Procedure FXU$CATADM requires 10 words of local(AUTO) storage.
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:106  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:107  
          MINI XREF LISTING

B$ALT.CODE
      4513**DCL      4513--REDEF    4514--REDEF    4514--REDEF
B$ALT.ERR
      4514**DCL      4710>>ASSIGN
B$ALT.ERR.ERR#
      4515**DCL      4515--REDEF
B$ALT.EVID
      4514**DCL      4514--REDEF    4514--REDEF
B$TCB.ALT$
      4509**DCL      4710>>ASSIGN
B$TCB$
      4519**DCL      4509--IMP-PTR  4710>>ASSIGN
BASED_PTR
      4529**DCL      4596>>ASSIGN   4597>>ASSIGN
BLK$
      4507**DCL      4430--IMP-PTR  4476--IMP-PTR  4579>>IF       4580>>ASSIGN   4580>>ASSIGN   4582>>DOINDEX
      4583>>IF       4584>>CALLBLT  4584>>CALLBLT  4588>>IF       4589>>ASSIGN   4589>>ASSIGN   4591>>ASSIGN
      4596>>ASSIGN   4597>>ASSIGN   4598>>CALL     4617>>IF       4657>>CALLBLT  4657>>CALLBLT  4679>>DOINDEX
      4680>>IF       4681>>IF       4682>>ASSIGN   4682>>ASSIGN   4717>>ASSIGN   4718>>IF       4719>>IF
      4720>>ASSIGN   4720>>ASSIGN   4724>>IF       4727>>CALLBLT  4727>>CALLBLT  4730>>IF       4758>>IF
      4760>>IF       4766>>IF
BREAK
      4394**DCL      4762>>IF       4780>>IF
CATA_NOVID
      4600**LABEL    4598--CALLALT  4600--GOTO     4601--GOTO     4617--GOTO
CATD_ IN PROCEDURE CATR_PSN
      5026**ENTRY    4663--CALL
CATD_EXIT
      4663**LABEL    4620--GOTO
CATR_NXT IN PROCEDURE CATR_PSN
      5029**ENTRY    4723--CALL     4731--CALL     4737--CALL     4759--CALL     4779--CALL
CATR_PSN
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:108  
      4807**PROC     4615--CALL     4722--CALL     4789--CALL
CATR_VSN IN PROCEDURE CATR_PSN
      5016**ENTRY    4629--CALL     4659--CALL     4668--CALL     4729--CALL     4736--CALL     4802--CALL
CATW_PSN IN PROCEDURE CATR_PSN
      5009**ENTRY    4652--CALL
CATW_VSN IN PROCEDURE CATR_PSN
      5021**ENTRY    4650--CALL     4672--CALL     4704--CALL
CSTAT
      4382**DCL      4385--REDEF
CSTAT.NUM
      4382**DCL      4791<<ASSIGN   4791>>ASSIGN   4792>>ASSIGN   4793>>ASSIGN   4794>>ASSIGN
CSTAT.SETS
      4382**DCL      4792<<ASSIGN
CSTAT.SETS.DISP
      4382**DCL      4793<<ASSIGN
CSTAT.SETS.PSN
      4382**DCL      4794<<ASSIGN
DREC IN PROCEDURE CATR_PSN
      4998**DCL      5027<>CALL
DREC.V IN PROCEDURE CATR_PSN
      5001**DCL      4998--DCLINIT
ERRCODE
      4392**DCL      4578<<ASSIGN   4608<<ASSIGN   4644<<ASSIGN   4653>>IF       4709>>IF       4710<<ASSIGN
      4785<<ASSIGN   4795<<ASSIGN
F$DCB.ACCT#
      4331**DCL      4690>>ASSIGN
F$DCB.ACTPOS
      4347**DCL      4347--REDEF
F$DCB.ARS#
      4321**DCL      4321--REDEF
F$DCB.ATTR
      4340**DCL      4341--REDEF
F$DCB.BORROW
      4355**DCL      4355--REDEF    4355--REDEF    4355--REDEF
F$DCB.DCBNAME.L
      4369**DCL      4369--IMP-SIZ
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:109  
F$DCB.EOMCHAR#
      4325**DCL      4325--REDEF
F$DCB.FLDID
      4350**DCL      4350--REDEF
F$DCB.FORM$
      4344**DCL      4344--REDEF
F$DCB.FSECT
      4360**DCL      4360--REDEF
F$DCB.FSN#
      4337**DCL      4337--REDEF    4337--REDEF    4338--REDEF
F$DCB.HEADER$
      4343**DCL      4343--REDEF
F$DCB.IXTNSIZE#
      4341**DCL      4341--REDEF    4691>>IF       4693>>DOWHILE  4695>>IF       4698>>ASSIGN
F$DCB.LASTSTA$
      4330**DCL      4330--REDEF
F$DCB.LVL
      4356**DCL      4356--REDEF
F$DCB.NAME#.C
      4331**DCL      4331--REDEF
F$DCB.NOEOF
      4353**DCL      4353--REDEF
F$DCB.NRECS#
      4342**DCL      4342--REDEF
F$DCB.NRECX
      4361**DCL      4361--REDEF
F$DCB.OHDR
      4353**DCL      4353--REDEF
F$DCB.ORG#
      4336**DCL      4336--REDEF
F$DCB.PRECNO
      4359**DCL      4359--REDEF
F$DCB.RCSZ
      4365**DCL      4365--REDEF
F$DCB.RES#
      4332**DCL      4332--REDEF
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:110  
F$DCB.SETX
      4344**DCL      4344--REDEF
F$DCB.TAB$
      4344**DCL      4344--REDEF
F$DCB.TDA
      4358**DCL      4359--REDEF
F$DCB.WSN#
      4332**DCL      4332--REDEF
FIX_PSN
      4624**LABEL    4798--GOTO
FXP$PARN
      4526**DCL-ENT  4775--CALL
FXP$PART
      4525**DCL-ENT  4739--CALL     4756--CALL     4764--CALL     4772--CALL     4777--CALL
FXP$PRINT
      4527**DCL-ENT  4742--CALL     4760--CALL     4767--CALL
FXP$RVID
      4523**DCL-ENT  4598--CALL     4645--CALL     4689--CALL
FXU$E$DUPVSN
      4400**DCL      4644>>ASSIGN
FXU$E$NOVSN
      4396**DCL      4608>>ASSIGN
I
      4521**DCL      4582<<DOINDEX  4583>>IF       4584>>CALLBLT  4584>>CALLBLT  4588>>IF       4589>>ASSIGN
      4589>>ASSIGN   4591>>ASSIGN   4626<<DOINDEX  4627>>ASSIGN   4628>>ASSIGN   4628>>ASSIGN   4630>>ASSIGN
      4632>>IF       4633>>ASSIGN   4635>>ASSIGN   4645>>CALL     4657<<CALLBLT  4658>>ASSIGN   4665<<DOINDEX
      4667>>ASSIGN   4669>>ASSIGN   4679<<DOINDEX  4680>>IF       4681>>IF       4682>>ASSIGN   4682>>ASSIGN
      4688<<ASSIGN   4689<>CALL     4692<<ASSIGN   4693>>DOWHILE  4694>>ASSIGN   4695>>IF       4695>>IF
      4695>>IF       4695>>IF       4698>>ASSIGN   4699>>ASSIGN   4699>>ASSIGN   4699>>ASSIGN   4700<<ASSIGN
      4700>>ASSIGN   4727<<CALLBLT  4728>>ASSIGN   4741<<DOINDEX  4744>>ASSIGN   4749>>CALLBLT  4752>>CALLBLT
      4754>>IF       4769<<DOINDEX  4770>>IF       4770>>ASSIGN   4773<<DOINDEX  4774>>ASSIGN   4776>>ASSIGN
J
      4522**DCL      4584<<CALLBLT  4585>>ASSIGN   4632<<ASSIGN   4633<<ASSIGN   4634>>IF       4635>>ASSIGN
      4636>>ASSIGN   4637>>ASSIGN   4639>>IF       4640>>IF       4648>>ASSIGN   4649>>IF       4649>>ASSIGN
      4669<<ASSIGN   4670>>IF       4671>>ASSIGN   4678<<ASSIGN   4680>>ASSIGN   4682<<ASSIGN   4683>>ASSIGN
M$DELREC
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:111  
        18**DCL-ENT  5027--CALL
M$DP$
      4520**DCL      4315--IMP-PTR  4690>>ASSIGN   4691>>IF       4693>>DOWHILE  4695>>IF       4698>>ASSIGN
M$READ
        17**DCL-ENT  5006--CALL     5018--CALL     5032--CALL
M$WRITE
        17**DCL-ENT  5011--CALL     5023--CALL
MNTS.N
      4553**DCL      4593>>ASSIGN   4770>>IF
MNTS.T
      4554**DCL      4770>>ASSIGN
MNT_NOPSN
      4795**LABEL    4789--CALLALT
PARM
      4313**DCL         6--PROC     4594>>IF       4615>>IF       4620>>IF       4659>>IF       4661>>IF
      4709--IF       4716--ENTRY    4784--ENTRY
PBLK.CODE
      4438**DCL      4579>>IF       4591>>ASSIGN   4680>>IF       4719>>IF
PBLK.NDTYPE
      4433**DCL      4583>>IF       4588>>IF       4681>>IF
PBLK.NSUBLKS
      4442**DCL      4582>>DOINDEX  4617>>IF       4679>>DOINDEX  4717<<ASSIGN   4718>>IF       4724>>IF
      4730>>IF       4758>>IF       4760>>IF       4766>>IF
PBLK.SUBLK$
      4463**DCL      4579>>IF       4580>>ASSIGN   4580>>ASSIGN   4583>>IF       4584>>CALLBLT  4584>>CALLBLT
      4588>>IF       4589>>ASSIGN   4589>>ASSIGN   4591>>ASSIGN   4596<<ASSIGN   4597<<ASSIGN   4598<>CALL
      4657>>CALLBLT  4657>>CALLBLT  4680>>IF       4681>>IF       4682>>ASSIGN   4682>>ASSIGN   4719>>IF
      4720>>ASSIGN   4720>>ASSIGN   4727>>CALLBLT  4727>>CALLBLT
PSNHDR
      4561**DCL      4764<>CALL
PSNHDR.T
      4564**DCL      4562--DCLINIT  4563--DCLINIT
PSNKEY
      4407**DCL      4825--DCLINIT  4826--DCLINIT  4942--DCLINIT
PSNKEY.PSN
      4409**DCL      4580<<ASSIGN   4599>>IF       4604<<ASSIGN   4622>>ASSIGN   4720<<ASSIGN   4724>>IF
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:112  
      4766>>IF       4787<<ASSIGN   4794>>ASSIGN
PSNKEY.VSN
      4410**DCL      4614<<ASSIGN   4721<<ASSIGN   4788<<ASSIGN
PSNLST
      4545**DCL      4550--DCLINIT  4551--DCLINIT
PSNLST.MNT
      4548**DCL      4770<<ASSIGN
PSNLST.PSN
      4547**DCL      4768<<ASSIGN
PSNREC
      4379**DCL      4621<<ASSIGN   4827--DCLINIT  4828--DCLINIT  4866--DCLINIT  4867--DCLINIT  4943--DCLINIT
      4944--DCLINIT  5010--ASSIGN   5033>>ASSIGN
PSNREC.DEFMOUNT
      4379**DCL      4624<<ASSIGN   4770>>IF       4790>>IF       4790>>IF       4793>>ASSIGN
PSNREC.PSN
      4379**DCL      4622<<ASSIGN   4636>>ASSIGN   4639>>IF       4648>>ASSIGN   4670>>IF       4768>>ASSIGN
      5031<<ASSIGN
PSNREC.VOLCNT
      4379**DCL      4623<<ASSIGN   4626>>DOINDEX  4665>>DOINDEX  4773>>DOINDEX  5010>>ASSIGN
PSNREC.VSN
      4379**DCL      4628<<ASSIGN   5010--ASSIGN
PSNREC.VSN.N
      4379**DCL      4667>>ASSIGN   4774>>ASSIGN
PSNREC.VSN.S
      4379**DCL      4632>>IF       4633>>ASSIGN   4669>>ASSIGN   4776>>ASSIGN
PSNTXT
      4549**DCL      4772<>CALL
PSNVSN
      4555**DCL      4775<>CALL
PSNVSN.N
      4557**DCL      4774<<ASSIGN
PSYM.COUNT
      4499**DCL      4502--IMP-SIZ  4580>>ASSIGN   4584>>CALLBLT  4589>>ASSIGN   4657>>CALLBLT  4682>>ASSIGN
      4720>>ASSIGN   4727>>CALLBLT
PSYM.TEXT
      4502**DCL      4580>>ASSIGN   4584>>CALLBLT  4589>>ASSIGN   4657>>CALLBLT  4682>>ASSIGN   4720>>ASSIGN
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:113  
      4727>>CALLBLT
RETALT
      4699**LABEL    4618--GOTO     4652--CALLALT  4659--CALLALT  4663--CALLALT  4704--CALLALT
RETALT IN PROCEDURE CATR_PSN
      5014**LABEL    5006--CALLALT  5011--CALLALT  5018--CALLALT  5023--CALLALT  5027--CALLALT  5032--CALLALT
RETRET
      4803**LABEL    4802--CALLALT
RKEY
      4416**DCL      4732<<ASSIGN   4864--DCLINIT  4865--DCLINIT  5030<<ASSIGN
RKEY.L
      4417**DCL      4739>>IF       4740>>DOWHILE  4760>>IF       4764>>IF       4765>>DOWHILE  5033>>IF
RKEY.P
      4418**DCL      4421--REDEF
RKEY.P.SN
      4419**DCL      4724>>IF       4766>>IF
RNXT IN PROCEDURE CATR_PSN
      4864**DCL      5032<>CALL
RNXT.STATION_ IN PROCEDURE CATR_PSN
      4867**DCL      4868--REDEF
RNXT.V IN PROCEDURE CATR_PSN
      4868**DCL      4864--DCLINIT
RNXT.V.DVBYTE.REREAD# IN PROCEDURE CATR_PSN
      4879**DCL      4879--REDEF
RNXT.V.INDX# IN PROCEDURE CATR_PSN
      4877**DCL      4877--REDEF
RPSN IN PROCEDURE CATR_PSN
      4825**DCL      5006<>CALL
RPSN.STATION_ IN PROCEDURE CATR_PSN
      4828**DCL      4829--REDEF
RPSN.V IN PROCEDURE CATR_PSN
      4829**DCL      4825--DCLINIT
RPSN.V.DVBYTE.REREAD# IN PROCEDURE CATR_PSN
      4840**DCL      4840--REDEF
RPSN.V.INDX# IN PROCEDURE CATR_PSN
      4838**DCL      4838--REDEF
RVSN IN PROCEDURE CATR_PSN
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:114  
      4903**DCL      5018<>CALL
RVSN.STATION_ IN PROCEDURE CATR_PSN
      4906**DCL      4907--REDEF
RVSN.V IN PROCEDURE CATR_PSN
      4907**DCL      4903--DCLINIT
RVSN.V.DVBYTE.REREAD# IN PROCEDURE CATR_PSN
      4918**DCL      4918--REDEF
RVSN.V.INDX# IN PROCEDURE CATR_PSN
      4916**DCL      4916--REDEF
SCTTXT
      4558**DCL      4777<>CALL
USW
      4393**DCL      4717>>IF
VID1
      4385**DCL      4581<<ASSIGN   4596--ASSIGN
VID1.DTT
      4387**DCL      4387--REDEF
VID1.SNLIST
      4388**DCL      4603<<ASSIGN   4797<<ASSIGN
VID1.SNLIST.SIZE
      4388**DCL      4635>>ASSIGN
VID1.SNLIST.TYPE
      4388**DCL      4630>>ASSIGN
VID1.SNLIST.VSN
      4388**DCL      4597--ASSIGN   4599>>IF       4614>>ASSIGN   4628>>ASSIGN   4645<>CALL
VID1.SNLIST.VSN.N
      4388**DCL      4585<<ASSIGN   4627>>ASSIGN
VID1.SNLIST.VSN.S
      4388**DCL      4589<<ASSIGN
VID1.VOLCNT
      4385**DCL      4585>>ASSIGN   4586<<ASSIGN   4586>>ASSIGN   4589>>ASSIGN   4594>>IF       4594>>IF
      4596>>IF       4599>>IF       4602<<ASSIGN   4607>>IF       4616<<ASSIGN   4623>>ASSIGN   4662<<ASSIGN
      4664>>IF
VID1.VSN
      4385**DCL      4591<<ASSIGN   4593>>IF       4593<<ASSIGN   4593>>ASSIGN   4624>>ASSIGN
VIDBUF
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:115  
      4372**DCL      4379--REDEF
VIDBUF.DTT
      4374**DCL      4374--REDEF
VIDBUF.PSN
      4372**DCL      4599>>IF       4604>>ASSIGN   4787>>ASSIGN
VIDBUF.SECTSTRT
      4373**DCL      4691>>IF       4691<<ASSIGN   4693>>DOWHILE  4695>>IF       4695>>IF       4695>>IF
      4695--IF       4698<<ASSIGN   4699>>ASSIGN   4699>>ASSIGN
VIDBUF.SNLIST
      4375**DCL      4603>>ASSIGN   4797>>ASSIGN
VIDBUF.SNLIST.VSN
      4375**DCL      4599>>IF       4788>>ASSIGN
VIDBUF.VOLCNT
      4372**DCL      4601>>IF       4602>>ASSIGN   4786>>IF
VIDBUF.VSN
      4372**DCL      4801>>ASSIGN
VSNHDR
      4540**DCL      4739<>CALL
VSNHDR.T
      4543**DCL      4541--DCLINIT  4542--DCLINIT
VSNKEY
      4413**DCL      4732>>ASSIGN   4903--DCLINIT  4904--DCLINIT  4973--DCLINIT
VSNKEY.VSN
      4415**DCL      4627<<ASSIGN   4631>>ASSIGN   4658<<ASSIGN   4667<<ASSIGN   4685>>ASSIGN   4728<<ASSIGN
      4735<<ASSIGN   4801<<ASSIGN
VSNLST
      4530**DCL      4538--DCLINIT  4539--DCLINIT
VSNLST.FLG
      4536**DCL      4560--DCLINIT  4754<<ASSIGN   4755<<ASSIGN   4776<<ASSIGN   4777>>IF
VSNLST.PSN
      4532**DCL      4744<<ASSIGN
VSNLST.SIZE
      4533**DCL      4752<<CALLBLT  4753<<CALLBLT  4753>>CALLBLT
VSNLST.TYPE
      4531**DCL      4743<<ASSIGN
VSNLST.VSN
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:116  
      4534**DCL      4745<<CALLBLT  4746<<CALLBLT  4746>>CALLBLT  4748<<ASSIGN   4748>>ASSIGN   4749<<CALLBLT
VSNREC
      4404**DCL      4660<<ASSIGN   4730>>IF       4905--DCLINIT  4906--DCLINIT  4974--DCLINIT  4975--DCLINIT
      5017<<ASSIGN   5022--ASSIGN   5033<<ASSIGN
VSNREC.SCNT
      4404**DCL      4649>>IF       4649<<ASSIGN   4694<<ASSIGN   4741>>DOINDEX  4747>>IF       5022>>ASSIGN
VSNREC.SCT
      4404**DCL      5022--ASSIGN
VSNREC.SCT.PSN
      4404**DCL      4636<<ASSIGN   4639>>IF       4640>>IF       4648<<ASSIGN   4670>>IF       4671<<ASSIGN
      4744>>ASSIGN
VSNREC.SCT.SCRATCH
      4404**DCL      4637<<ASSIGN   4680<<ASSIGN   4683<<ASSIGN   4754>>IF
VSNREC.SCT.SIZE
      4404**DCL      4634>>IF       4635<<ASSIGN   4699<<ASSIGN   4752>>CALLBLT
VSNREC.TYPE
      4404**DCL      4630>>IF       4630<<ASSIGN   4686>>IF       4690<<ASSIGN   4743>>ASSIGN   4803>>IF
VSNREC.VSN
      4404**DCL      4631<<ASSIGN   4685<<ASSIGN   4688>>ASSIGN   4745>>CALLBLT
VSNTXT
      4537**DCL      4756<>CALL
VSN_MNTXIT
      4684**LABEL    4803--GOTO
VSN_NOVID
      4699**LABEL    4689--CALLALT
WPSN IN PROCEDURE CATR_PSN
      4942**DCL      5011<>CALL
WPSN.BUF_.BOUND IN PROCEDURE CATR_PSN
      4942**DCL      5010<<ASSIGN
WPSN.STATION_ IN PROCEDURE CATR_PSN
      4944**DCL      4944--REDEF
WPSN.V IN PROCEDURE CATR_PSN
      4945**DCL      4942--DCLINIT
WPSN.V.DVBYTE.VFC# IN PROCEDURE CATR_PSN
      4951**DCL      4951--REDEF
WVSN IN PROCEDURE CATR_PSN
PL6.E3A0      #002=FXU$CATADM File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:34 Page:117  
      4973**DCL      5023<>CALL
WVSN.BUF_.BOUND IN PROCEDURE CATR_PSN
      4973**DCL      5022<<ASSIGN
WVSN.STATION_ IN PROCEDURE CATR_PSN
      4975**DCL      4975--REDEF
WVSN.V IN PROCEDURE CATR_PSN
      4976**DCL      4973--DCLINIT
WVSN.V.DVBYTE.VFC# IN PROCEDURE CATR_PSN
      4982**DCL      4982--REDEF

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:118  
      527        1        /*T***********************************************************/
      528        2        /*T*                                                         */
      529        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      530        4        /*T*                                                         */
      531        5        /*T***********************************************************/
      532        6                    /*F*      NAME: FXU$TRACKER
      533        7                    *         PURPOSE: Makes a record of every account modification in
      534        8                    *                  $$TRACKER.$$EFT
      535        9                    */
      536       10        FXU$TRACKER: PROC(P_PCB);
      537       11        %INCLUDE CP_6;
      538       92        %INCLUDE XU_MACRO_C;
      539     3198        %INCLUDE U$JIT_C;
      540     3384        %INCLUDE B_ERRORS_C;
      541     4511        %INCLUDE JG_GHOSTS_C;
      542     4601        %P_PCB(STCLASS=); /* COMMAND THAT DID IT */
      543     4800    1   DCL M$TRACKER DCB;
      544     4801        %FPT_OPEN(DCB=M$TRACKER,NAME=VLP_NAME,ACCT=VLP_ACCT,ASN=FILE,ACS=DIRECT,
      545     4802              FUN=CREATE,EXIST=OLDFILE,ORG=KEYED,SPARE=100,SN=VLP_SN,BUPM=YES);
      546     4911        %VLP_NAME(STCLASS=CONSTANT,NAME='$$TRACKER');
      547     4938        %VLP_ACCT(STCLASS=CONSTANT,ACCT='$$EFT');
      548     4951        %VLP_SN;
      549     4964        %FPT_WRITE(DCB=M$TRACKER,KEY=KBUF,CONT=YES,NEWKEY=YES,ONEWKEY=NO);
      550     4995        %FPT_CLOSE(DCB=M$TRACKER,DISP=SAVE);
      551     5037        %FPT_WAIT(UNITS=1,STCLASS=CONSTANT);
      552     5051        %FPT_TIME(DEST=LOCAL,DATE=TBUF.D,TIME=TBUF.T,TSTAMP=KBUF.U,STCLASS=CONSTANT);
      553     5070        %FPT_PRIV;
      554     5085        %F$DCB;
      555     5142    1   DCL M$DP$ PTR SYMREF;
      556     5143    1   DCL 1 KBUF STATIC,
      557     5144    1         2 L UBIN(9)UNAL INIT(11),
      558     5145    1         2 ACCT CHAR(8),
      559     5146    1         2 U UBIN(36)UNAL;
      560     5147    1   DCL 1 TBUF STATIC,
      561     5148    1         2 ACCT CHAR(8),
      562     5149    1         2 * CHAR(1)INIT(' '),
      563     5150    1         2 D CHAR(8),
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:119  
      564     5151    1         2 * CHAR(1)INIT(' '),
      565     5152    1         2 T CHAR(11);
      566     5153    1   DCL 1 TREC REDEF TBUF,
      567     5154    1         2 T CHAR(24),
      568     5155    1         2 * CHAR(5);
      569     5156    1   DCL B$JIT$ PTR SYMREF;
      570     5157    1   DCL B$TCB$ PTR SYMREF;
      571     5158        %B$TCB(STCLASS="BASED(B$TCB$)");
      572     5161        %B$ALT;
      573     5169        %SUB B$ALT=B$TCB.ALT$->B$ALT;
      574     5170    1   DCL HEAD1 CONSTANT CHAR(0)INIT(
      575     5171    1   'Account  Time           User - Command');
      576     5172    1   DCL HEAD2 CONSTANT CHAR(0)INIT(
      577     5173    1   '-------- -------------- --------------');
      578     5174    1   DCL USER_ACCN CHAR(8) SYMREF;
      579     5175    1   DCL USER_NAME CHAR(12) SYMREF;
      580     5176    1   DCL I UBIN;
      581     5177        %EJECT;
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:120  
      582     5178    1      FPT_PRIV.V.PRIV#=%(PR_FMSEC#|PR_FMDIAG#)&~B$JIT.PRIV.ACTIVE;
      583     5179    1      CALL M$SPRIV(FPT_PRIV);
      584     5180    1      VLP_SN.SN#(0)=M$DP$->F$DCB.PSN#;
      585     5181    1      CALL M$OPEN(FPT_OPEN)ALTRET(ALTCHK);
      586     5182    2      IF DCBADDR(DCBNUM(M$TRACKER))->F$DCB.NRECS#=0 THEN DO;
      587     5183    2         FPT_WRITE.BUF_=VECTOR(HEAD1);
      588     5184    2         KBUF=BINBIT(11,9);
      589     5185    2         FPT_WRITE.V.DVBYTE.CONT#='0'B;
      590     5186    2         CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);
      591     5187    2         KBUF.U=1;
      592     5188    2         FPT_WRITE.BUF_=VECTOR(HEAD2);
      593     5189    2         CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);
      594     5190    2         FPT_WRITE.V.DVBYTE.CONT#='1'B;
      595     5191    2         END;
      596     5192    1      TREC.T=' ';
      597     5193    1      CALL M$TIME(FPT_TIME);
      598     5194    1      TBUF.ACCT=M$DP$->F$DCB.ACCT#;
      599     5195    1      KBUF.ACCT=M$DP$->F$DCB.ACCT#;
      600     5196    1      IF TBUF.ACCT=BINASC(0) THEN TBUF.ACCT='-DEFAULT';
      601     5197    1      CALL INSERT(TBUF.T,5,1,' ');
      602     5198    1      FPT_WRITE.BUF_=VECTOR(TREC.T);
      603     5199    1      CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);
      604     5200    1      TREC.T=USER_ACCN;
      605     5201    1      CALL INDEX1(I,' ',TREC.T);
      606     5202    1      CALL INSERT(TREC.T,I,13,'/',USER_NAME);
      607     5203    1      CALL INDEX1(I,' ',TREC.T);
      608     5204    1      CALL INSERT(TREC.T,I+1,1,'-');
      609     5205    1      FPT_WRITE.BUF_.BOUND=I+2;
      610     5206    1      CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);
      611     5207    1      FPT_WRITE.BUF_.BUF$=P_PCB.TEXT$;
      612     5208    1      FPT_WRITE.BUF_.BOUND=P_PCB.NCHARS-1;
      613     5209    1      CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);
      614     5210    1      CALL M$CLOSE(FPT_CLOSE)ALTRET(ALTCHK);
      615     5211    1   RETRET:;
      616     5212    1      CALL M$RPRIV(FPT_PRIV);
      617     5213    1      RETURN;
      618     5214    2   ALTCHK: IF B$ALT.ERR.CODE=%E$OLDREC THEN DO;
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:121  
      619     5215    2         KBUF.U=KBUF.U+512;
      620     5216    2         CALL M$RETRY;
      621     5217    2         END;
      622     5218    2      IF B$ALT.ERR.CODE=%E$FILEBUSY THEN DO;
      623     5219    2         CALL M$WAIT(FPT_WAIT);
      624     5220    2         CALL M$RETRY;
      625     5221    2         END;
      626     5222    1      IF DCBADDR(B$ALT.DCB#)->F$DCB.FCD# THEN CALL M$CLOSE(FPT_CLOSE);
      627     5223    1      GOTO RETRET;
      628     5224    1   END FXU$TRACKER;
      629     5225        %EOD;

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:122  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   U$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$TRACKER.

   Procedure FXU$TRACKER requires 165 words for executable code.
   Procedure FXU$TRACKER requires 8 words of local(AUTO) storage.

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:123  

 Object Unit name= FXU$TRACKER                                File name= FXU$UTIL.:E05TOU
 UTS= JUL 29 '97 20:35:03.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$TRACKER
    2   Data  even  none   120    170  FXU$TRACKER
    3  RoData even  UTS     47     57  FXU$TRACKER
    4   Proc  even  none   165    245  FXU$TRACKER
    5  RoData even  none    14     16  FXU$TRACKER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  FXU$TRACKER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:124  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$TRACKER                             M$DP$
     B$JIT$                                B$TCB$                                USER_ACCN
     USER_NAME                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:125  


      527        1        /*T***********************************************************/
      528        2        /*T*                                                         */
      529        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      530        4        /*T*                                                         */
      531        5        /*T***********************************************************/
      532        6                    /*F*      NAME: FXU$TRACKER
      533        7                    *         PURPOSE: Makes a record of every account modification in
      534        8                    *                  $$TRACKER.$$EFT
      535        9                    */
      536       10        FXU$TRACKER: PROC(P_PCB);

     10  4 000000   000000 700200 xent  FXU$TRACKER  TSX0  ! X66_AUTO_1
         4 000001   000010 000001                    ZERO    8,1

      537       11        %INCLUDE CP_6;
      538       92        %INCLUDE XU_MACRO_C;
      539     3198        %INCLUDE U$JIT_C;
      540     3384        %INCLUDE B_ERRORS_C;
      541     4511        %INCLUDE JG_GHOSTS_C;
      542     4601        %P_PCB(STCLASS=); /* COMMAND THAT DID IT */
      543     4800    1   DCL M$TRACKER DCB;
      544     4801        %FPT_OPEN(DCB=M$TRACKER,NAME=VLP_NAME,ACCT=VLP_ACCT,ASN=FILE,ACS=DIRECT,
      545     4802              FUN=CREATE,EXIST=OLDFILE,ORG=KEYED,SPARE=100,SN=VLP_SN,BUPM=YES);
      546     4911        %VLP_NAME(STCLASS=CONSTANT,NAME='$$TRACKER');
      547     4938        %VLP_ACCT(STCLASS=CONSTANT,ACCT='$$EFT');
      548     4951        %VLP_SN;
      549     4964        %FPT_WRITE(DCB=M$TRACKER,KEY=KBUF,CONT=YES,NEWKEY=YES,ONEWKEY=NO);
      550     4995        %FPT_CLOSE(DCB=M$TRACKER,DISP=SAVE);
      551     5037        %FPT_WAIT(UNITS=1,STCLASS=CONSTANT);
      552     5051        %FPT_TIME(DEST=LOCAL,DATE=TBUF.D,TIME=TBUF.T,TSTAMP=KBUF.U,STCLASS=CONSTANT);
      553     5070        %FPT_PRIV;
      554     5085        %F$DCB;
      555     5142    1   DCL M$DP$ PTR SYMREF;
      556     5143    1   DCL 1 KBUF STATIC,
      557     5144    1         2 L UBIN(9)UNAL INIT(11),
      558     5145    1         2 ACCT CHAR(8),
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:126  
      559     5146    1         2 U UBIN(36)UNAL;
      560     5147    1   DCL 1 TBUF STATIC,
      561     5148    1         2 ACCT CHAR(8),
      562     5149    1         2 * CHAR(1)INIT(' '),
      563     5150    1         2 D CHAR(8),
      564     5151    1         2 * CHAR(1)INIT(' '),
      565     5152    1         2 T CHAR(11);
      566     5153    1   DCL 1 TREC REDEF TBUF,
      567     5154    1         2 T CHAR(24),
      568     5155    1         2 * CHAR(5);
      569     5156    1   DCL B$JIT$ PTR SYMREF;
      570     5157    1   DCL B$TCB$ PTR SYMREF;
      571     5158        %B$TCB(STCLASS="BASED(B$TCB$)");
      572     5161        %B$ALT;
      573     5169        %SUB B$ALT=B$TCB.ALT$->B$ALT;
      574     5170    1   DCL HEAD1 CONSTANT CHAR(0)INIT(
      575     5171    1   'Account  Time           User - Command');
      576     5172    1   DCL HEAD2 CONSTANT CHAR(0)INIT(
      577     5173    1   '-------- -------------- --------------');
      578     5174    1   DCL USER_ACCN CHAR(8) SYMREF;
      579     5175    1   DCL USER_NAME CHAR(12) SYMREF;
      580     5176    1   DCL I UBIN;
      581     5177        %EJECT;
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:127  
      582     5178    1      FPT_PRIV.V.PRIV#=%(PR_FMSEC#|PR_FMDIAG#)&~B$JIT.PRIV.ACTIVE;

   5178  4 000002   000000 470400 xsym               LDP0    B$JIT$
         4 000003   000013 236100                    LDQ     11,,PR0
         4 000004   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 000005   000054 376000 3                  ANQ     HEAD2+10
         4 000006   000152 756000 2                  STQ     FPT_PRIV+2

      583     5179    1      CALL M$SPRIV(FPT_PRIV);

   5179  4 000007   000150 630400 2                  EPPR0   FPT_PRIV
         4 000010   020012 713400                    CLIMB   8202
         4 000011   400000 401760                    pmme    nvectors=1

      584     5180    1      VLP_SN.SN#(0)=M$DP$->F$DCB.PSN#;

   5180  4 000012   000000 470400 xsym               LDP0    M$DP$
         4 000013   040000 100500                    MLR     fill='040'O
         4 000014   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         4 000015   000073 000006 2                  ADSC9   VLP_SN+1                 cn=0,n=6

      585     5181    1      CALL M$OPEN(FPT_OPEN)ALTRET(ALTCHK);

   5181  4 000016   000000 630400 2                  EPPR0   FPT_OPEN
         4 000017   450000 713400                    CLIMB   alt,open
         4 000020   410400 401760                    pmme    nvectors=18
         4 000021   000175 702000 4                  TSX2    ALTCHK

      586     5182    2      IF DCBADDR(DCBNUM(M$TRACKER))->F$DCB.NRECS#=0 THEN DO;

   5182  4 000022   000000 236007 xsym               LDQ     M$TRACKER,DL
         4 000023   000000 470400 5                  LDP0    0
         4 000024   000000 471500                    LDP1    0,,PR0
         4 000025   100000 473506                    LDP3    0,QL,PR1
         4 000026   300042 235100                    LDA     34,,PR3
         4 000027   000056 601000 4                  TNZ     s:5192

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:128  
      587     5183    2         FPT_WRITE.BUF_=VECTOR(HEAD1);

   5183  4 000030   000002 237000 5                  LDAQ    2
         4 000031   000102 757000 2                  STAQ    FPT_WRITE+4

      588     5184    2         KBUF=BINBIT(11,9);

   5184  4 000032   000000 100400                    MLR     fill='000'O
         4 000033   000004 000001 5                  ADSC9   4                        cn=0,n=1
         4 000034   000154 000015 2                  ADSC9   KBUF                     cn=0,n=13

      589     5185    2         FPT_WRITE.V.DVBYTE.CONT#='0'B;

   5185  4 000035   000005 236000 5                  LDQ     5
         4 000036   000111 356000 2                  ANSQ    FPT_WRITE+11

      590     5186    2         CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);

   5186  4 000037   000076 630400 2                  EPPR0   FPT_WRITE
         4 000040   440001 713400                    CLIMB   alt,write
         4 000041   401400 401760                    pmme    nvectors=4
         4 000042   000175 702000 4                  TSX2    ALTCHK

      591     5187    2         KBUF.U=1;

   5187  4 000043   000000 100400                    MLR     fill='000'O
         4 000044   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         4 000045   000156 200004 2                  ADSC9   KBUF+2                   cn=1,n=4

      592     5188    2         FPT_WRITE.BUF_=VECTOR(HEAD2);

   5188  4 000046   000006 237000 5                  LDAQ    6
         4 000047   000102 757000 2                  STAQ    FPT_WRITE+4

      593     5189    2         CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);

   5189  4 000050   000076 630400 2                  EPPR0   FPT_WRITE
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:129  
         4 000051   440001 713400                    CLIMB   alt,write
         4 000052   401400 401760                    pmme    nvectors=4
         4 000053   000175 702000 4                  TSX2    ALTCHK

      594     5190    2         FPT_WRITE.V.DVBYTE.CONT#='1'B;

   5190  4 000054   001000 236003                    LDQ     512,DU
         4 000055   000111 256000 2                  ORSQ    FPT_WRITE+11

      595     5191    2         END;

      596     5192    1      TREC.T=' ';

   5192  4 000056   040000 100400                    MLR     fill='040'O
         4 000057   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000060   000160 000030 2                  ADSC9   TBUF                     cn=0,n=24

      597     5193    1      CALL M$TIME(FPT_TIME);

   5193  4 000061   000014 630400 3                  EPPR0   FPT_TIME
         4 000062   020004 713400                    CLIMB   8196
         4 000063   402000 401760                    pmme    nvectors=5

      598     5194    1      TBUF.ACCT=M$DP$->F$DCB.ACCT#;

   5194  4 000064   000000 470400 xsym               LDP0    M$DP$
         4 000065   000020 237100                    LDAQ    16,,PR0
         4 000066   000160 757000 2                  STAQ    TBUF

      599     5195    1      KBUF.ACCT=M$DP$->F$DCB.ACCT#;

   5195  4 000067   040000 100500                    MLR     fill='040'O
         4 000070   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         4 000071   000154 200010 2                  ADSC9   KBUF                     cn=1,n=8

      600     5196    1      IF TBUF.ACCT=BINASC(0) THEN TBUF.ACCT='-DEFAULT';

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:130  
   5196  4 000072   000160 237000 2                  LDAQ    TBUF
         4 000073   000010 117000 5                  CMPAQ   8
         4 000074   000100 601000 4                  TNZ     s:5197

   5196  4 000075   040000 100400                    MLR     fill='040'O
         4 000076   000055 000010 3                  ADSC9   HEAD2+11                 cn=0,n=8
         4 000077   000160 000010 2                  ADSC9   TBUF                     cn=0,n=8

      601     5197    1      CALL INSERT(TBUF.T,5,1,' ');

   5197  4 000100   000040 236007                    LDQ     32,DL
         4 000101   000165 552004 2                  STBQ    TBUF+5,'04'O

      602     5198    1      FPT_WRITE.BUF_=VECTOR(TREC.T);

   5198  4 000102   000012 237000 5                  LDAQ    10
         4 000103   000102 757000 2                  STAQ    FPT_WRITE+4

      603     5199    1      CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);

   5199  4 000104   000076 630400 2                  EPPR0   FPT_WRITE
         4 000105   440001 713400                    CLIMB   alt,write
         4 000106   401400 401760                    pmme    nvectors=4
         4 000107   000175 702000 4                  TSX2    ALTCHK

      604     5200    1      TREC.T=USER_ACCN;

   5200  4 000110   040000 100400                    MLR     fill='040'O
         4 000111   000000 000010 xsym               ADSC9   USER_ACCN                cn=0,n=8
         4 000112   000160 000030 2                  ADSC9   TBUF                     cn=0,n=24

      605     5201    1      CALL INDEX1(I,' ',TREC.T);

   5201  4 000113   000000 124400                    SCM     mask='000'O
         4 000114   000160 000030 2                  ADSC9   TBUF                     cn=0,n=24
         4 000115   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000116   200004 000100                    ARG     I,,AUTO
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:131  

      606     5202    1      CALL INSERT(TREC.T,I,13,'/',USER_NAME);

   5202  4 000117   200004 235100                    LDA     I,,AUTO
         4 000120   040005 100400                    MLR     fill='040'O
         4 000121   000014 000001 5                  ADSC9   12                       cn=0,n=1
         4 000122   000160 000001 2                  ADSC9   TBUF,A                   cn=0,n=1
         4 000123   040005 100400                    MLR     fill='040'O
         4 000124   000000 000014 xsym               ADSC9   USER_NAME                cn=0,n=12
         4 000125   000160 200014 2                  ADSC9   TBUF,A                   cn=1,n=12

      607     5203    1      CALL INDEX1(I,' ',TREC.T);

   5203  4 000126   000000 124400                    SCM     mask='000'O
         4 000127   000160 000030 2                  ADSC9   TBUF                     cn=0,n=24
         4 000130   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000131   200004 000100                    ARG     I,,AUTO

      608     5204    1      CALL INSERT(TREC.T,I+1,1,'-');

   5204  4 000132   200004 235100                    LDA     I,,AUTO
         4 000133   040005 100400                    MLR     fill='040'O
         4 000134   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 000135   000160 200001 2                  ADSC9   TBUF,A                   cn=1,n=1

      609     5205    1      FPT_WRITE.BUF_.BOUND=I+2;

   5205  4 000136   200004 236100                    LDQ     I,,AUTO
         4 000137   000002 036007                    ADLQ    2,DL
         4 000140   000020 736000                    QLS     16
         4 000141   000102 676000 2                  ERQ     FPT_WRITE+4
         4 000142   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000143   000102 656000 2                  ERSQ    FPT_WRITE+4

      610     5206    1      CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);

   5206  4 000144   000076 630400 2                  EPPR0   FPT_WRITE
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:132  
         4 000145   440001 713400                    CLIMB   alt,write
         4 000146   401400 401760                    pmme    nvectors=4
         4 000147   000175 702000 4                  TSX2    ALTCHK

      611     5207    1      FPT_WRITE.BUF_.BUF$=P_PCB.TEXT$;

   5207  4 000150   200003 470500                    LDP0    @P_PCB,,AUTO
         4 000151   000000 236100                    LDQ     0,,PR0
         4 000152   000103 756000 2                  STQ     FPT_WRITE+5

      612     5208    1      FPT_WRITE.BUF_.BOUND=P_PCB.NCHARS-1;

   5208  4 000153   000011 236100                    LDQ     9,,PR0
         4 000154   000001 136007                    SBLQ    1,DL
         4 000155   000020 736000                    QLS     16
         4 000156   000102 676000 2                  ERQ     FPT_WRITE+4
         4 000157   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000160   000102 656000 2                  ERSQ    FPT_WRITE+4

      613     5209    1      CALL M$WRITE(FPT_WRITE)ALTRET(ALTCHK);

   5209  4 000161   000076 630400 2                  EPPR0   FPT_WRITE
         4 000162   440001 713400                    CLIMB   alt,write
         4 000163   401400 401760                    pmme    nvectors=4
         4 000164   000175 702000 4                  TSX2    ALTCHK

      614     5210    1      CALL M$CLOSE(FPT_CLOSE)ALTRET(ALTCHK);

   5210  4 000165   000112 630400 2                  EPPR0   FPT_CLOSE
         4 000166   450001 713400                    CLIMB   alt,close
         4 000167   406000 401760                    pmme    nvectors=13
         4 000170   000175 702000 4                  TSX2    ALTCHK

   5208  4 000171                       RETRET       null
      615     5211    1   RETRET:;
      616     5212    1      CALL M$RPRIV(FPT_PRIV);

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:133  
   5212  4 000171   000150 630400 2                  EPPR0   FPT_PRIV
         4 000172   020013 713400                    CLIMB   8203
         4 000173   400000 401760                    pmme    nvectors=1

      617     5213    1      RETURN;

   5213  4 000174   000000 702200 xent               TSX2  ! X66_ARET

      618     5214    2   ALTCHK: IF B$ALT.ERR.CODE=%E$OLDREC THEN DO;

   5214  4 000175   000000 470400 xsym  ALTCHK       LDP0    B$TCB$
         4 000176   000000 471500                    LDP1    0,,PR0
         4 000177   100102 236100                    LDQ     66,,PR1
         4 000200   377770 376007                    ANQ     131064,DL
         4 000201   000750 116007                    CMPQ    488,DL
         4 000202   000215 601000 4                  TNZ     s:5218

      619     5215    2         KBUF.U=KBUF.U+512;

   5215  4 000203   000156 235000 2                  LDA     KBUF+2
         4 000204   000157 236000 2                  LDQ     KBUF+3
         4 000205   000033 773000                    LRL     27
         4 000206   001000 036007                    ADLQ    512,DL
         4 000207   200006 756100                    STQ     I+2,,AUTO
         4 000210   000000 100500                    MLR     fill='000'O
         4 000211   200006 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         4 000212   000156 200004 2                  ADSC9   KBUF+2                   cn=1,n=4

      620     5216    2         CALL M$RETRY;

   5216  4 000213   010010 713400                    CLIMB   4104
         4 000214   000000 401760                    pmme    nvectors=0

      621     5217    2         END;

      622     5218    2      IF B$ALT.ERR.CODE=%E$FILEBUSY THEN DO;

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:134  
   5218  4 000215   000000 470400 xsym               LDP0    B$TCB$
         4 000216   000000 471500                    LDP1    0,,PR0
         4 000217   100102 236100                    LDQ     66,,PR1
         4 000220   377770 376007                    ANQ     131064,DL
         4 000221   001550 116007                    CMPQ    872,DL
         4 000222   000230 601000 4                  TNZ     s:5222

      623     5219    2         CALL M$WAIT(FPT_WAIT);

   5219  4 000223   000006 630400 3                  EPPR0   FPT_WAIT
         4 000224   020006 713400                    CLIMB   8198
         4 000225   400400 401760                    pmme    nvectors=2

      624     5220    2         CALL M$RETRY;

   5220  4 000226   010010 713400                    CLIMB   4104
         4 000227   000000 401760                    pmme    nvectors=0

      625     5221    2         END;

      626     5222    1      IF DCBADDR(B$ALT.DCB#)->F$DCB.FCD# THEN CALL M$CLOSE(FPT_CLOSE);

   5222  4 000230   000000 470400 xsym               LDP0    B$TCB$
         4 000231   000000 471500                    LDP1    0,,PR0
         4 000232   000000 473400 5                  LDP3    0
         4 000233   300000 474500                    LDP4    0,,PR3
         4 000234   100101 720100                    LXL0    65,,PR1
         4 000235   400000 475510                    LDP5    0,X0,PR4
         4 000236   500031 236100                    LDQ     25,,PR5
         4 000237   020000 316007                    CANQ    8192,DL
         4 000240   000244 600000 4                  TZE     s:5223

   5222  4 000241   000112 630400 2                  EPPR0   FPT_CLOSE
         4 000242   050001 713400                    CLIMB   close
         4 000243   406000 401760                    pmme    nvectors=13

      627     5223    1      GOTO RETRET;
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:135  

   5223  4 000244   000171 710000 4                  TRA     RETRET
      628     5224    1   END FXU$TRACKER;
      629     5225        %EOD;

PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:136  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   U$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$TRACKER.
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:137  

 **** Variables and constants ****

  ****  Section 002  Data  FXU$TRACKER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   112-0-0/d STRC(1080)  r     1 FPT_CLOSE                  0-0-0/d STRC(2088)  r     1 FPT_OPEN
   150-0-0/d STRC(144)   r     1 FPT_PRIV                  76-0-0/d STRC(432)   r     1 FPT_WRITE
   154-0-0/c STRC(117)   r     1 KBUF                     160-0-0/c STRC(261)   r     1 TBUF
   160-0-0/c STRC(261)   r     1 TREC                      72-0-0/d STRC(90)    r     1 VLP_SN

  ****  Section 003 RoData FXU$TRACKER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/d STRC(432)   r     1 FPT_TIME                   6-0-0/d STRC(216)   r     1 FPT_WAIT
    30-0-0/c CHAR(38)    r     1 HEAD1                     42-0-0/c CHAR(38)    r     1 HEAD2
     3-0-0/c STRC(72)    r     1 VLP_ACCT                   0-0-0/c STRC(90)    r     1 VLP_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_PCB                     4-0-0/w UBIN        r     1 I
    *0-0-0/w STRC(504)   r     1 P_PCB

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w PTR         r     1 M$DP$                      0-0-0/c CHAR(8)     r     1 USER_ACCN
     0-0-0/c CHAR(12)    r     1 USER_NAME
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:138  

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$TRACKER


   Procedure FXU$TRACKER requires 165 words for executable code.
   Procedure FXU$TRACKER requires 8 words of local(AUTO) storage.
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:139  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:140  
          MINI XREF LISTING

ALTCHK
      5214**LABEL    5181--CALLALT  5186--CALLALT  5189--CALLALT  5199--CALLALT  5206--CALLALT  5209--CALLALT
      5210--CALLALT
B$ALT.CODE
      5163**DCL      5163--REDEF    5164--REDEF    5164--REDEF
B$ALT.DCB#
      5164**DCL      5222--IF
B$ALT.ERR.CODE
      5165**DCL      5214>>IF       5218>>IF
B$ALT.ERR.ERR#
      5165**DCL      5165--REDEF
B$ALT.EVID
      5164**DCL      5164--REDEF    5164--REDEF
B$JIT.CPFLAGS1.SLEAZE
      3306**DCL      3306--REDEF
B$JIT.ERR.MID
      3213**DCL      3213--REDEF
B$JIT.PRIV.ACTIVE
      3213**DCL      5178>>ASSIGN
B$JIT$
      5156**DCL      3207--IMP-PTR  5178>>ASSIGN
B$TCB.ALT$
      5159**DCL      5214>>IF       5218>>IF       5222>>IF
B$TCB$
      5157**DCL      5159--IMP-PTR  5214>>IF       5218>>IF       5222>>IF
F$DCB.ACCT#
      5102**DCL      5194>>ASSIGN   5195>>ASSIGN
F$DCB.ACTPOS
      5118**DCL      5118--REDEF
F$DCB.ARS#
      5092**DCL      5092--REDEF
F$DCB.ATTR
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:141  
      5111**DCL      5112--REDEF
F$DCB.BORROW
      5126**DCL      5126--REDEF    5126--REDEF    5126--REDEF
F$DCB.DCBNAME.L
      5140**DCL      5140--IMP-SIZ
F$DCB.EOMCHAR#
      5096**DCL      5096--REDEF
F$DCB.FCD#
      5105**DCL      5222>>IF
F$DCB.FLDID
      5121**DCL      5121--REDEF
F$DCB.FORM$
      5115**DCL      5115--REDEF
F$DCB.FSECT
      5131**DCL      5131--REDEF
F$DCB.FSN#
      5108**DCL      5108--REDEF    5108--REDEF    5109--REDEF
F$DCB.HEADER$
      5114**DCL      5114--REDEF
F$DCB.IXTNSIZE#
      5112**DCL      5112--REDEF
F$DCB.LASTSTA$
      5101**DCL      5101--REDEF
F$DCB.LVL
      5127**DCL      5127--REDEF
F$DCB.NAME#.C
      5102**DCL      5102--REDEF
F$DCB.NOEOF
      5124**DCL      5124--REDEF
F$DCB.NRECS#
      5113**DCL      5113--REDEF    5182>>IF
F$DCB.NRECX
      5132**DCL      5132--REDEF
F$DCB.OHDR
      5124**DCL      5124--REDEF
F$DCB.ORG#
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:142  
      5107**DCL      5107--REDEF
F$DCB.PRECNO
      5130**DCL      5130--REDEF
F$DCB.PSN#
      5102**DCL      5180>>ASSIGN
F$DCB.RCSZ
      5136**DCL      5136--REDEF
F$DCB.RES#
      5103**DCL      5103--REDEF
F$DCB.SETX
      5115**DCL      5115--REDEF
F$DCB.TAB$
      5115**DCL      5115--REDEF
F$DCB.TDA
      5129**DCL      5130--REDEF
F$DCB.WSN#
      5103**DCL      5103--REDEF
FPT_CLOSE
      5018**DCL      5210<>CALL     5222<>CALL
FPT_CLOSE.SN_
      5018**DCL      5018--REDEF
FPT_CLOSE.UTL_
      5019**DCL      5019--REDEF
FPT_CLOSE.V
      5023**DCL      5018--DCLINIT
FPT_CLOSE.V.EXPIRE#
      5033**DCL      5033--REDEF
FPT_CLOSE.V.TYPE#
      5031**DCL      5031--REDEF
FPT_CLOSE.V.XTNSIZE#
      5028**DCL      5028--REDEF    5030--REDEF
FPT_OPEN
      4867**DCL      5181<>CALL
FPT_OPEN.ACSVEH_
      4869**DCL      4870--REDEF
FPT_OPEN.ALTKEYS_
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:143  
      4875**DCL      4876--REDEF    4876--REDEF
FPT_OPEN.HDR_
      4874**DCL      4875--REDEF
FPT_OPEN.TAB_
      4873**DCL      4874--REDEF
FPT_OPEN.UHL_
      4867**DCL      4868--REDEF    4868--REDEF
FPT_OPEN.V
      4876**DCL      4867--DCLINIT
FPT_OPEN.V.FSN#
      4907**DCL      4907--REDEF    4907--REDEF
FPT_OPEN.WSN_
      4873**DCL      4873--REDEF
FPT_PRIV
      5081**DCL      5179<>CALL     5212<>CALL
FPT_PRIV.V
      5081**DCL      5081--DCLINIT
FPT_PRIV.V.PRIV#
      5081**DCL      5178<<ASSIGN
FPT_TIME
      5062**DCL      5193<>CALL
FPT_TIME.V
      5066**DCL      5062--DCLINIT
FPT_WAIT
      5048**DCL      5219<>CALL
FPT_WAIT.V
      5049**DCL      5048--DCLINIT
FPT_WRITE
      4981**DCL      5186<>CALL     5189<>CALL     5199<>CALL     5206<>CALL     5209<>CALL
FPT_WRITE.BUF_
      4981**DCL      5183<<ASSIGN   5188<<ASSIGN   5198<<ASSIGN
FPT_WRITE.BUF_.BOUND
      4981**DCL      5205<<ASSIGN   5208<<ASSIGN
FPT_WRITE.BUF_.BUF$
      4983**DCL      5207<<ASSIGN
FPT_WRITE.STATION_
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:144  
      4983**DCL      4983--REDEF
FPT_WRITE.V
      4984**DCL      4981--DCLINIT
FPT_WRITE.V.DVBYTE.CONT#
      4992**DCL      5185<<ASSIGN   5190<<ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
      4990**DCL      4990--REDEF
HEAD1
      5170**DCL      5183--ASSIGN
HEAD2
      5172**DCL      5188--ASSIGN
I
      5176**DCL      5201<<CALLBLT  5202>>CALLBLT  5203<<CALLBLT  5204>>CALLBLT  5205>>ASSIGN
KBUF
      5143**DCL      4981--DCLINIT  5184<<ASSIGN
KBUF.ACCT
      5145**DCL      5195<<ASSIGN
KBUF.U
      5146**DCL      5066--DCLINIT  5187<<ASSIGN   5215<<ASSIGN   5215>>ASSIGN
M$CLOSE
        20**DCL-ENT  5210--CALL     5222--CALL
M$DP$
      5142**DCL      5180>>ASSIGN   5194>>ASSIGN   5195>>ASSIGN
M$OPEN
        20**DCL-ENT  5181--CALL
M$RETRY
        77**DCL-ENT  5216--CALL     5220--CALL
M$RPRIV
        79**DCL-ENT  5212--CALL
M$SPRIV
        79**DCL-ENT  5179--CALL
M$TIME
        87**DCL-ENT  5193--CALL
M$TRACKER
      4800**DCL      5182--IF
M$WAIT
PL6.E3A0      #003=FXU$TRACKER File=FXU$UTIL.:E05TSI                             TUE 07/29/97 20:35 Page:145  
        78**DCL-ENT  5219--CALL
M$WRITE
        21**DCL-ENT  5186--CALL     5189--CALL     5199--CALL     5206--CALL     5209--CALL
P_PCB
      4619**DCL        10--PROC
P_PCB.NCHARS
      4766**DCL      5208>>ASSIGN
P_PCB.TEXT$
      4620**DCL      5207>>ASSIGN
RETRET
      5208**LABEL    5223--GOTO
TBUF
      5147**DCL      5153--REDEF
TBUF.ACCT
      5148**DCL      5194<<ASSIGN   5196>>IF       5196<<ASSIGN
TBUF.D
      5150**DCL      5062--DCLINIT  5063--DCLINIT
TBUF.T
      5152**DCL      5064--DCLINIT  5065--DCLINIT  5197<<CALLBLT
TREC.T
      5154**DCL      5192<<ASSIGN   5198--ASSIGN   5200<<ASSIGN   5201>>CALLBLT  5202<<CALLBLT  5203>>CALLBLT
      5204<<CALLBLT
USER_ACCN
      5174**DCL      5200>>ASSIGN
USER_NAME
      5175**DCL      5202>>CALLBLT
VLP_ACCT
      4949**DCL      4872--DCLINIT
VLP_NAME
      4936**DCL      4868--DCLINIT
VLP_SN
      4962**DCL      4867--DCLINIT
VLP_SN.SN#
      4962**DCL      5180<<ASSIGN

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:146  
      630        1        /*T***********************************************************/
      631        2        /*T*                                                         */
      632        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      633        4        /*T*                                                         */
      634        5        /*T***********************************************************/
      635        6                    /*F*      NAME: FXU$PROJAD
      636        7                    *         PURPOSE: Mess with the :PROJ file..check MAKEME command,
      637        8                    *         packset specification, account name, next account, etc.
      638        9                    */
      639       10        FXU$PROJAD: PROC(ACCT)ALTRET;
      640       11    1   DCL ACCT CHAR(8); /* PARAMETER FOR NEXT ACCOUNT */
      641       12    1   DCL 1 CODE REDEF ACCT,
      642       13    1         2 N UBIN, /* PARAMETER FOR CHECK ACCOUNT NAME */
      643       14    1         2 * UBIN;
      644       15        %INCLUDE CP_6;
      645       96        %INCLUDE F$JIT_C;
      646      213    1   DCL B$JIT$ PTR SYMREF;
      647      214        %INCLUDE FX_PERR_C;
      648      273        %INCLUDE AS_SUPER_C;
      649      708        %INCLUDE XU_MACRO_C;
      650     3814        %INCLUDE FM$MACROS;
      651     4189    1   DCL 1 PROJAD SYMREF,
      652     4190    1         2 L UBIN(9)UNAL,
      653     4191    1         2 USER CHAR(20),
      654     4192    1         2 PSN CHAR(6);
      655     4193    1   DCL 1 PROJKY STATIC,
      656     4194    1         2 L UBIN(9)UNAL,
      657     4195    1         2 USER CHAR(20),
      658     4196    1         2 PSN CHAR(6);
      659     4197    1   DCL CHAR20 CHAR(20) BASED;
      660     4198    1   DCL M$PROJ DCB;
      661     4199        %FPT_OPEN(STCLASS=CONSTANT,DCB=M$PROJ,ASN=FILE,SCRUB=YES,NAME=PROJN,
      662     4200                  ACCT=SYS_ACCT,FUN=UPDATE,SHARE=ALL);
      663     4309        %VLP_NAME(FPTN=PROJN,NAME=':PROJ',STCLASS=CONSTANT);
      664     4336        %VLP_ACCT(FPTN=SYS_ACCT,ACCT=':SYS',STCLASS=CONSTANT SYMDEF);
      665     4349        %FPT_READ(FPTN=RDPROJ,KEYS=YES,KEY=PROJKY,DCB=M$PROJ);
      666     4388        %FPT_PRECORD(FPTN=PREC,DCB=M$PROJ,KEYS=YES,KEYR=YES,KEY=PROJKY);
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:147  
      667     4409        %FPT_WRITE(FPTN=WRPROJ,DCB=M$PROJ,KEY=PROJKY);
      668     4440        %FPT_ENQ(FPTN=ENQUEUE,STCLASS=CONSTANT,DCB=M$PROJ,RNAME=PROJKY,SHARE=NONE);
      669     4458        %FPT_DEQ(FPTN=DEQUEUE,STCLASS=CONSTANT,DCB=M$PROJ);
      670     4475        %FPT_GDS(RESULTS=RDPROJ.BUF_,SEGSIZE=1024,STCLASS=CONSTANT);
      671     4491        %AS$PROJ(NAME=PROJREC,STCLASS="BASED(RDPROJ.BUF_.BUF$)");
      672     4525    1   DCL 1 ACCTS(0:0)BASED(ACCT$),
      673     4526    1         2 C CHAR(8),
      674     4527    1         2 GRANS UBIN;
      675     4528        %F$DCB;
      676     4585    1   DCL M$DP$ PTR SYMREF;
      677     4586        %P_PCB(W=CSTAT,WSZ=1024,R=FXN$CMD,STCLASS=STATIC,U$=FXP$POPTS);
      678     4785    1   DCL X$PARSE ENTRY(1) ALTRET;
      679     4786    1   DCL FXP$POPTS ENTRY(1);
      680     4787    1   DCL CSTAT UBIN SYMREF;
      681     4788    1   DCL FXN$CMD UBIN SYMREF;
      682     4789    1   DCL FXP$PROJAT ENTRY(1) ALTRET;
      683     4790        %SUB FCG#='0630'O;
      684     4791        %SUB MID#='25'O;
      685     4792        %ERRCODE(NAME=FXU$E$NOPROJ,COD#=%E$NOPROJ,SEV#=7);
      686     4796        %ERRCODE(NAME=FXU$E$PROJNA,COD#=%E$PROJNA,SEV#=7);
      687     4800        %ERRCODE(NAME=FXU$E$PROJOVER,COD#=%E$PROJOVER,SEV#=7);
      688     4804        %ERRCODE(NAME=FXU$E$PROJEX,COD#=%E$PROJEX,SEV#=7);
      689     4808        %ERRCODE(NAME=FXU$E$PROJSK,COD#=%E$PROJSK,SEV#=7);
      690     4812    1   DCL FLAG BIT(36) SYMREF;
      691     4813                    /* AUTO FRAME */
      692     4814    1   DCL ACCT$ PTR;
      693     4815    1   DCL I UBIN;
      694     4816    1   DCL J UBIN;
      695     4817    1   DCL WILD_XC REDEF J CHAR(4);
      696     4818    1   DCL K UBIN;
      697     4819    1   DCL L UBIN;
      698     4820    1   DCL M UBIN;
      699     4821    1   DCL 1 AC,
      700     4822    1         2 C CHAR(8),
      701     4823    1         2 GRANS UBIN;
      702     4824        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:148  
      703     4825    1      FLAG='0'B;
      704     4826    1      IF NOT DCBADDR(DCBNUM(M$PROJ))->F$DCB.FCD#
      705     4827    1      THEN CALL M$OPEN(FPT_OPEN)ALTRET(NOPROJ);
      706     4828    1      CALL INDEX1(I,' ',SUBSTR(PROJAD.USER,8));
      707     4829    2      IF ADDR(ACCT)=ADDR(NIL) THEN DO;
      708     4830    2         PROJAD.PSN=' ';
      709     4831    2         PROJKY=PROJAD;
      710     4832    2         PROJKY.L=I+8;
      711     4833    2         PROJAD.L=0;
      712     4834    2         PREC.V.N#=0;
      713     4835    2         CALL M$PRECORD(PREC)ALTRET(DGAS1);
      714     4836    2   DGAS1:IF PROJAD.USER~=PROJKY.USER OR PROJKY.L=0 THEN GOTO NOPROJ;
      715     4837    2         PREC.V.N#=1;
      716     4838    2         CALL M$PRECORD(PREC)ALTRET(DGAS2);
      717     4839    3         IF PROJKY.L~=0 AND PROJKY.USER=PROJAD.USER THEN DO;
      718     4840    3            PROJAD.L=I+8;
      719     4841    3            RETURN;
      720     4842    3            END;
      721     4843    2   DGAS2:PREC.V.N#=0;
      722     4844    2         PROJKY=PROJAD;
      723     4845    2         PROJKY.L=I+8;
      724     4846    2         CALL M$PRECORD(PREC)ALTRET(DGAS3);
      725     4847    2         END;
      726     4848    2      ELSE DO;
      727     4849    2         IF PROJAD.L>20 THEN GOTO NOPROJ;
      728     4850    2         PROJKY.PSN=SUBSTR(ACCT,1,ASCBIN(SUBSTR(ACCT,0,1)));
      729     4851    2         PROJKY.L=ASCBIN(SUBSTR(ACCT,0,1))+20;
      730     4852    2         END;
      731     4853    1   DGAS3: IF RDPROJ.BUF_.BUF$=ADDR(NIL) THEN CALL M$GDS(FPT_GDS);
      732     4854    2      DO WHILE(PROJKY.USER~=' ' AND PROJKY.USER~=ADDR(B$JIT.ACCN)->CHAR20);
      733     4855    2         CALL M$READ(RDPROJ) ALTRET(CHKLD);
      734     4856    2         PROJKY.USER=PROJREC.CREATOR;
      735     4857    2         END;
      736     4858    1      IF PROJKY.USER=' ' AND NOT B$JIT.PPRIV&%(PPR_PIGC#|PPR_SUPER#)
      737     4859    1        AND NOT B$JIT.PRIV.AUTH&%(PR_FMSEC#|PR_FMDIAG#) THEN GOTO NOPROJ;
      738     4860    1      PROJKY.USER=PROJAD.USER;
      739     4861    1      CALL M$READ(RDPROJ)ALTRET(CHKLD);
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:149  
      740     4862    1      P_PCB.NCHARS=PROJREC.ATTRIBUTES.COUNT+12;
      741     4863    1      P_PCB.TEXT$=PINCRC(ADDR(PROJREC.ATTRIBUTES.TEXT),-12);
      742     4864    1      CALL INSERT(P_PCB.TEXT$->CHAR20,0,12,'M #',PROJKY.PSN,'.? ');
      743     4865    1      I=PROJAD.L;
      744     4866    1      PROJAD.L=0;
      745     4867    1      CALL X$PARSE(P_PCB);
      746     4868    1      PROJAD.L=I;
      747     4869    1      CALL FXP$PROJAT(P_PCB)ALTRET(NOPROJ);
      748     4870    1      CALL M$READ(RDPROJ)ALTRET(NOPROJ);
      749     4871    1      IF PROJAD.L=0 THEN PROJAD.L=PROJKY.L;
      750     4872    1      PROJAD.PSN=PROJKY.PSN;
      751     4873    1      RETURN;
      752     4874                    /**/
      753     4875    2   CHKLD: IF DCBADDR(DCBNUM(M$PROJ))->F$DCB.TYC.LD# THEN DO;
      754     4876    2         CALL M$GDS(FPT_GDS) ALTRET(NOPROJ);
      755     4877    2         CALL M$RETRY;
      756     4878    2         END;
      757     4879                    /**/
      758     4880    1   NOPROJ: IF PROJAD.L<=20 THEN PROJAD.PSN=' ';
      759     4881    1      IF NOT FLAG THEN FLAG=FXU$E$NOPROJ;
      760     4882                    /*E*      ERROR: FXU-E$NOPROJ
      761     4883                    *         MESSAGE:You may not administer that project.
      762     4884                    */
      763     4885    1      ALTRETURN;
      764     4886        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:150  
      765     4887                    /*F*      NAME: FXU$PROJNA
      766     4888                    *         PURPOSE: Find next account in the project on the set.
      767     4889                    */
      768     4890    1   FXU$PROJNA: ENTRY(ACCT) ALTRET;
      769     4891    1      AC.C=ACCT;
      770     4892    1      CALL FINDACCT;
      771     4893    1      CALL M$DEQ(DEQUEUE);
      772     4894    1      IF AC.C=ACCTS.C(I) THEN I=I+1;
      773     4895    1      IF I=PROJREC.NUM_ACCTS THEN ALTRETURN;
      774     4896    1      ACCT=ACCTS.C(I);
      775     4897    1      RETURN;
      776     4898                    /**/
      777     4899                    /*F*      NAME: FXU$PROJAC
      778     4900                    *         PURPOSE: Check the account name in M$DP to be in the project
      779     4901                    *         or, if COMMAND is CREATE, that it conforms to the skeleton.
      780     4902                    */
      781     4903    1   FXU$PROJAC: ENTRY(ACCT) ALTRET;
      782     4904    1      AC.C=M$DP$->F$DCB.ACCT#;
      783     4905    1      CALL FINDACCT ALTRET(NOTHERE);
      784     4906    2      IF CODE.N=%E$CREATE THEN DO;
      785     4907    2         FLAG=FXU$E$PROJEX;
      786     4908    2         GOTO DEQALTRET;
      787     4909                    /*E*      ERROR:FXU-E$PROJEX
      788     4910                    *         MESSAGE:Cannot create, account %%AC %exists.
      789     4911                    */
      790     4912    2         END;
      791     4913    1   DEQRET:;
      792     4914    1      CALL M$DEQ(DEQUEUE);
      793     4915    1      RETURN;
      794     4916    1   NOTHERE:;
      795     4917    2      IF CODE.N~=%E$CREATE THEN DO;
      796     4918    2   ERRNA:FLAG=FXU$E$PROJNA;
      797     4919                    /*E*      ERROR:FXU-E$PROJNA
      798     4920                    *         MESSAGE:Account %%AC %is not in the project.
      799     4921                    */
      800     4922    2   DEQALTRET: CALL M$DEQ(DEQUEUE);
      801     4923    2         ALTRETURN;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:151  
      802     4924    2         END;
      803     4925           %WILD_COMPARE(WILD_CHARS=PROJREC.SKELETON,
      804     4926           COMPARE_CHARS=AC.C,
      805     4927           WILD_X=J,WILD_XP=K,COMPARE_X=L,COMPARE_XP=M,
      806     4928           NO_MATCH=GOTO NOMATCH);
      807     4999    1      IF PROJREC.MAX_NUM_GRANS-PROJREC.GRANS_ACCUM<=0
      808     5000    2        OR PROJREC.NUM_ACCTS>=PROJREC.MAX_NUM_ACCTS THEN DO;
      809     5001    2   ERROVER: FLAG=FXU$E$PROJOVER;
      810     5002    2         GOTO DEQALTRET;
      811     5003    2         END;
      812     5004                    /*E*      ERROR:FXU-E$PROJOVER
      813     5005                    *         MESSAGE:Project has too few granules or accounts left.
      814     5006                    */
      815     5007    1      RETURN;  /* WAIT UNTIL PROJGR AND PROJWR TO WRITE AND DEQ */
      816     5008    1   NOMATCH:;
      817     5009    1      FLAG=FXU$E$PROJSK;
      818     5010    1      GOTO DEQALTRET;
      819     5011                    /*E*      ERROR:FXU-E$PROJSK
      820     5012                    *         MESSAGE:Account% %AC% doesn't match the skeleton.
      821     5013                    */
      822     5014        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:152  
      823     5015                    /*F*      NAME: FXU$PROJWR
      824     5016                    *         PURPOSE: Write the record.
      825     5017                    */
      826     5018    1   FXU$PROJWR: ENTRY ALTRET;
      827     5019    1      CALL M$WRITE(WRPROJ)ALTRET(NOPROJ);
      828     5020    1      GOTO DEQRET;
      829     5021        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:153  
      830     5022                    /*F*      NAME: FXU$PROJGR
      831     5023                    *         PURPOSE: Check that the account in M$DP.ACCT# can have
      832     5024                    *         a number of granules passed as a parameter.
      833     5025                    */
      834     5026    1   FXU$PROJGR: ENTRY(ACCT)ALTRET;
      835     5027    1      AC.C=M$DP$->F$DCB.ACCT#;
      836     5028    1      CALL FINDACCT ALTRET(NEWACCT);
      837     5029    1   GRCHK:;
      838     5030    1      J=CODE.N-ACCTS.GRANS(I);
      839     5031    1      PROJREC.GRANS_ACCUM=PROJREC.GRANS_ACCUM+J;
      840     5032    1      IF PROJREC.GRANS_ACCUM>PROJREC.MAX_NUM_GRANS THEN GOTO ERROVER;
      841     5033    1      ACCTS.GRANS(I)=CODE.N;
      842     5034    1      RETURN;  /* WAIT UNTIL PROJWR TO WRITE AND DEQ */
      843     5035                    /**/
      844     5036    1   NEWACCT: M=I;
      845     5037    1      AC.GRANS=0;
      846     5038    1      PROJREC.NUM_ACCTS=PROJREC.NUM_ACCTS+1;
      847     5039    2      DO WHILE(M<PROJREC.NUM_ACCTS);
      848     5040    2         ADDR(J)->ACCTS(0)=ACCTS(M);
      849     5041    2         ACCTS(M)=AC;
      850     5042    2         AC=ADDR(J)->ACCTS(0);
      851     5043    2         M=M+1;
      852     5044    2         END;
      853     5045    1      GOTO GRCHK;
      854     5046        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:154  
      855     5047                    /*F*      NAME: FXU$PROJDA
      856     5048                    *         PURPOSE: Delete an account from a :PROJ record.
      857     5049                    */
      858     5050    1   FXU$PROJDA: ENTRY(ACCT)ALTRET;
      859     5051    1      AC.C=ACCT;
      860     5052    1      CALL FINDACCT ALTRET(ERRNA);
      861     5053    1      PROJREC.GRANS_ACCUM=PROJREC.GRANS_ACCUM-ACCTS.GRANS(I);
      862     5054    1      PROJREC.NUM_ACCTS=PROJREC.NUM_ACCTS-1;
      863     5055    2      DO WHILE(I<PROJREC.NUM_ACCTS);
      864     5056    2         ACCTS(I)=ACCTS(I+1);
      865     5057    2         I=I+1;
      866     5058    2         END;
      867     5059    1      RETURN;
      868     5060        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:155  
      869     5061    1   FINDACCT: PROC ALTRET;
      870     5062    2      CALL M$ENQ(ENQUEUE)ALTRET(ENQERR);
      871     5063    2      PROJREC='0'B;
      872     5064    2      I=0;
      873     5065    2      IF PROJAD.PSN~=' ' THEN CALL M$READ(RDPROJ) ALTRET(CHKLD);
      874     5066    2   DGAS4: ACCT$=PINCRW(ADDR(PROJREC),SIZEW(PROJREC));
      875     5067    2      WRPROJ.BUF_=RDPROJ.BUF_;
      876     5068    2      IF PROJREC.MAX_NUM_ACCTS>50000 THEN PROJREC.MAX_NUM_ACCTS=50000;
      877     5069    2      IF PROJREC.NUM_ACCTS>(RDPROJ.BUF_.BOUND-SIZEV(PROJREC))/SIZEC(ACCTS(0))
      878     5070    2      THEN PROJREC.NUM_ACCTS=(RDPROJ.BUF_.BOUND-SIZEV(PROJREC))/SIZEC(ACCTS(0));
      879     5071    2      WRPROJ.BUF_.BOUND=POFFC(ADDR(ACCTS(PROJREC.MAX_NUM_ACCTS)),ADDR(PROJREC))-1;
      880     5072    3      IF PROJREC.MAX_NUM_ACCTS-PROJREC.NUM_ACCTS>2048/SIZEW(ACCTS(0)) THEN DO;
      881     5073    3         WRPROJ.BUF_.BOUND=SIZEV(PROJREC)+SIZEC(ACCTS(0))*(PROJREC.NUM_ACCTS+5);
      882     5074    3         IF WRPROJ.BUF_.BOUND<8191 THEN WRPROJ.BUF_.BOUND=8191;
      883     5075    3         ELSE IF WRPROJ.BUF_.BOUND>RDPROJ.BUF_.BOUND
      884     5076    3         THEN WRPROJ.BUF_.BOUND=RDPROJ.BUF_.BOUND+8192;
      885     5077    3         END;
      886     5078    3      DO WHILE(RDPROJ.BUF_<WRPROJ.BUF_);
      887     5079    3         CALL M$GDS(FPT_GDS) ALTRET(ENQERR);
      888     5080    3         END;
      889     5081    3      DO WHILE(I<PROJREC.NUM_ACCTS AND AC.C>=ACCTS.C(I));
      890     5082    3         IF AC.C=ACCTS.C(I) THEN RETURN;
      891     5083    3         I=I+1;
      892     5084    3         END;
      893     5085    2   ENQERR:;
      894     5086    2      ALTRETURN;
      895     5087    3   CHKLD: IF DCBADDR(DCBNUM(M$PROJ))->F$DCB.TYC.LD# THEN DO;
      896     5088    3         CALL M$GDS(FPT_GDS) ALTRET(DGAS4);
      897     5089    3         CALL M$RETRY;
      898     5090    3         END;
      899     5091    2      GOTO DGAS4;
      900     5092    2   END FINDACCT;
      901     5093    1   END;

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:156  
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$PROJAD.

   Procedure FXU$PROJAD requires 647 words for executable code.
   Procedure FXU$PROJAD requires 18 words of local(AUTO) storage.

    No errors detected in file FXU$UTIL.:E05TSI    .

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:157  

 Object Unit name= FXU$PROJAD                                 File name= FXU$UTIL.:E05TOU
 UTS= JUL 29 '97 20:35:32.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    58     72  FXU$PROJAD
    2   DCB   even  none     0      0  M$PROJ
    3  RoData even  UTS     97    141  FXU$PROJAD
    4   Proc  even  none   647   1207  FXU$PROJAD
    5  RoData even  none     5      5  FXU$PROJAD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  FXU$PROJAD
     4    320          yes     yes      Std        1  FXU$PROJNA
     4    361          yes     yes      Std        1  FXU$PROJAC
     4    550          yes     yes      Std        0  FXU$PROJWR
     4    557          yes     yes      Std        1  FXU$PROJGR
     4    650          yes     yes      Std        1  FXU$PROJDA

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    3     74  SYS_ACCT
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:158  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 FXP$POPTS
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       1 FXP$PROJAT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$JIT$                                PROJAD
     M$PROJ                                M$DP$                                 CSTAT
     FXN$CMD                               FLAG                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:159  


      630        1        /*T***********************************************************/
      631        2        /*T*                                                         */
      632        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      633        4        /*T*                                                         */
      634        5        /*T***********************************************************/
      635        6                    /*F*      NAME: FXU$PROJAD
      636        7                    *         PURPOSE: Mess with the :PROJ file..check MAKEME command,
      637        8                    *         packset specification, account name, next account, etc.
      638        9                    */
      639       10        FXU$PROJAD: PROC(ACCT)ALTRET;

     10  4 000000   000000 700200 xent  FXU$PROJAD   TSX0  ! X66_AUTO_1
         4 000001   000022 000001                    ZERO    18,1

      640       11    1   DCL ACCT CHAR(8); /* PARAMETER FOR NEXT ACCOUNT */
      641       12    1   DCL 1 CODE REDEF ACCT,
      642       13    1         2 N UBIN, /* PARAMETER FOR CHECK ACCOUNT NAME */
      643       14    1         2 * UBIN;
      644       15        %INCLUDE CP_6;
      645       96        %INCLUDE F$JIT_C;
      646      213    1   DCL B$JIT$ PTR SYMREF;
      647      214        %INCLUDE FX_PERR_C;
      648      273        %INCLUDE AS_SUPER_C;
      649      708        %INCLUDE XU_MACRO_C;
      650     3814        %INCLUDE FM$MACROS;
      651     4189    1   DCL 1 PROJAD SYMREF,
      652     4190    1         2 L UBIN(9)UNAL,
      653     4191    1         2 USER CHAR(20),
      654     4192    1         2 PSN CHAR(6);
      655     4193    1   DCL 1 PROJKY STATIC,
      656     4194    1         2 L UBIN(9)UNAL,
      657     4195    1         2 USER CHAR(20),
      658     4196    1         2 PSN CHAR(6);
      659     4197    1   DCL CHAR20 CHAR(20) BASED;
      660     4198    1   DCL M$PROJ DCB;
      661     4199        %FPT_OPEN(STCLASS=CONSTANT,DCB=M$PROJ,ASN=FILE,SCRUB=YES,NAME=PROJN,
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:160  
      662     4200                  ACCT=SYS_ACCT,FUN=UPDATE,SHARE=ALL);
      663     4309        %VLP_NAME(FPTN=PROJN,NAME=':PROJ',STCLASS=CONSTANT);
      664     4336        %VLP_ACCT(FPTN=SYS_ACCT,ACCT=':SYS',STCLASS=CONSTANT SYMDEF);
      665     4349        %FPT_READ(FPTN=RDPROJ,KEYS=YES,KEY=PROJKY,DCB=M$PROJ);
      666     4388        %FPT_PRECORD(FPTN=PREC,DCB=M$PROJ,KEYS=YES,KEYR=YES,KEY=PROJKY);
      667     4409        %FPT_WRITE(FPTN=WRPROJ,DCB=M$PROJ,KEY=PROJKY);
      668     4440        %FPT_ENQ(FPTN=ENQUEUE,STCLASS=CONSTANT,DCB=M$PROJ,RNAME=PROJKY,SHARE=NONE);
      669     4458        %FPT_DEQ(FPTN=DEQUEUE,STCLASS=CONSTANT,DCB=M$PROJ);
      670     4475        %FPT_GDS(RESULTS=RDPROJ.BUF_,SEGSIZE=1024,STCLASS=CONSTANT);
      671     4491        %AS$PROJ(NAME=PROJREC,STCLASS="BASED(RDPROJ.BUF_.BUF$)");
      672     4525    1   DCL 1 ACCTS(0:0)BASED(ACCT$),
      673     4526    1         2 C CHAR(8),
      674     4527    1         2 GRANS UBIN;
      675     4528        %F$DCB;
      676     4585    1   DCL M$DP$ PTR SYMREF;
      677     4586        %P_PCB(W=CSTAT,WSZ=1024,R=FXN$CMD,STCLASS=STATIC,U$=FXP$POPTS);
      678     4785    1   DCL X$PARSE ENTRY(1) ALTRET;
      679     4786    1   DCL FXP$POPTS ENTRY(1);
      680     4787    1   DCL CSTAT UBIN SYMREF;
      681     4788    1   DCL FXN$CMD UBIN SYMREF;
      682     4789    1   DCL FXP$PROJAT ENTRY(1) ALTRET;
      683     4790        %SUB FCG#='0630'O;
      684     4791        %SUB MID#='25'O;
      685     4792        %ERRCODE(NAME=FXU$E$NOPROJ,COD#=%E$NOPROJ,SEV#=7);
      686     4796        %ERRCODE(NAME=FXU$E$PROJNA,COD#=%E$PROJNA,SEV#=7);
      687     4800        %ERRCODE(NAME=FXU$E$PROJOVER,COD#=%E$PROJOVER,SEV#=7);
      688     4804        %ERRCODE(NAME=FXU$E$PROJEX,COD#=%E$PROJEX,SEV#=7);
      689     4808        %ERRCODE(NAME=FXU$E$PROJSK,COD#=%E$PROJSK,SEV#=7);
      690     4812    1   DCL FLAG BIT(36) SYMREF;
      691     4813                    /* AUTO FRAME */
      692     4814    1   DCL ACCT$ PTR;
      693     4815    1   DCL I UBIN;
      694     4816    1   DCL J UBIN;
      695     4817    1   DCL WILD_XC REDEF J CHAR(4);
      696     4818    1   DCL K UBIN;
      697     4819    1   DCL L UBIN;
      698     4820    1   DCL M UBIN;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:161  
      699     4821    1   DCL 1 AC,
      700     4822    1         2 C CHAR(8),
      701     4823    1         2 GRANS UBIN;
      702     4824        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:162  
      703     4825    1      FLAG='0'B;

   4825  4 000002   000000 450000 xsym               STZ     FLAG

      704     4826    1      IF NOT DCBADDR(DCBNUM(M$PROJ))->F$DCB.FCD#

   4826  4 000003   000000 236007 xsym               LDQ     M$PROJ,DL
         4 000004   000000 470400 5                  LDP0    0
         4 000005   000000 471500                    LDP1    0,,PR0
         4 000006   100000 473506                    LDP3    0,QL,PR1
         4 000007   300031 236100                    LDQ     25,,PR3
         4 000010   020000 316007                    CANQ    8192,DL
         4 000011   000016 601000 4                  TNZ     s:4828

      705     4827    1      THEN CALL M$OPEN(FPT_OPEN)ALTRET(NOPROJ);

   4827  4 000012   000000 630400 3                  EPPR0   FPT_OPEN
         4 000013   450000 713400                    CLIMB   alt,open
         4 000014   410400 401760                    pmme    nvectors=18
         4 000015   000304 702000 4                  TSX2    NOPROJ

      706     4828    1      CALL INDEX1(I,' ',SUBSTR(PROJAD.USER,8));

   4828  4 000016   000000 124400                    SCM     mask='000'O
         4 000017   000002 200014 xsym               ADSC9   PROJAD+2                 cn=1,n=12
         4 000020   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000021   200005 000100                    ARG     I,,AUTO

      707     4829    2      IF ADDR(ACCT)=ADDR(NIL) THEN DO;

   4829  4 000022   200003 236100                    LDQ     @ACCT,,AUTO
         4 000023   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000024   000114 601000 4                  TNZ     s:4849

      708     4830    2         PROJAD.PSN=' ';

   4830  4 000025   040000 100400                    MLR     fill='040'O
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:163  
         4 000026   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000027   000005 200006 xsym               ADSC9   PROJAD+5                 cn=1,n=6

      709     4831    2         PROJKY=PROJAD;

   4831  4 000030   000000 100400                    MLR     fill='000'O
         4 000031   000000 000033 xsym               ADSC9   PROJAD                   cn=0,n=27
         4 000032   000000 000033 1                  ADSC9   PROJKY                   cn=0,n=27

      710     4832    2         PROJKY.L=I+8;

   4832  4 000033   200005 236100                    LDQ     I,,AUTO
         4 000034   000010 036007                    ADLQ    8,DL
         4 000035   000033 736000                    QLS     27
         4 000036   000000 552040 1                  STBQ    PROJKY,'40'O

      711     4833    2         PROJAD.L=0;

   4833  4 000037   000000 236003                    LDQ     0,DU
         4 000040   000000 552040 xsym               STBQ    PROJAD,'40'O

      712     4834    2         PREC.V.N#=0;

   4834  4 000041   000035 450000 1                  STZ     PREC+7

      713     4835    2         CALL M$PRECORD(PREC)ALTRET(DGAS1);

   4835  4 000042   000026 630400 1                  EPPR0   PREC
         4 000043   440003 713400                    CLIMB   alt,+16387
         4 000044   401000 401760                    pmme    nvectors=3
         4 000045   000046 702000 4                  TSX2    DGAS1

      714     4836    2   DGAS1:IF PROJAD.USER~=PROJKY.USER OR PROJKY.L=0 THEN GOTO NOPROJ;

   4836  4 000046   040000 106400       DGAS1        CMPC    fill='040'O
         4 000047   000000 200024 xsym               ADSC9   PROJAD                   cn=1,n=20
         4 000050   000000 200024 1                  ADSC9   PROJKY                   cn=1,n=20
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:164  
         4 000051   000304 601000 4                  TNZ     NOPROJ
         4 000052   000000 236000 1                  LDQ     PROJKY
         4 000053   777000 316003                    CANQ    -512,DU
         4 000054   000304 600000 4                  TZE     NOPROJ

      715     4837    2         PREC.V.N#=1;

   4837  4 000055   000001 235007                    LDA     1,DL
         4 000056   000035 755000 1                  STA     PREC+7

      716     4838    2         CALL M$PRECORD(PREC)ALTRET(DGAS2);

   4838  4 000057   000026 630400 1                  EPPR0   PREC
         4 000060   440003 713400                    CLIMB   alt,+16387
         4 000061   401000 401760                    pmme    nvectors=3
         4 000062   000077 702000 4                  TSX2    DGAS2

      717     4839    3         IF PROJKY.L~=0 AND PROJKY.USER=PROJAD.USER THEN DO;

   4839  4 000063   000000 236000 1                  LDQ     PROJKY
         4 000064   777000 316003                    CANQ    -512,DU
         4 000065   000077 600000 4                  TZE     DGAS2
         4 000066   040000 106400                    CMPC    fill='040'O
         4 000067   000000 200024 1                  ADSC9   PROJKY                   cn=1,n=20
         4 000070   000000 200024 xsym               ADSC9   PROJAD                   cn=1,n=20
         4 000071   000077 601000 4                  TNZ     DGAS2

      718     4840    3            PROJAD.L=I+8;

   4840  4 000072   200005 236100                    LDQ     I,,AUTO
         4 000073   000010 036007                    ADLQ    8,DL
         4 000074   000033 736000                    QLS     27
         4 000075   000000 552040 xsym               STBQ    PROJAD,'40'O

      719     4841    3            RETURN;

   4841  4 000076   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:165  

      720     4842    3            END;
      721     4843    2   DGAS2:PREC.V.N#=0;

   4843  4 000077   000035 450000 1     DGAS2        STZ     PREC+7

      722     4844    2         PROJKY=PROJAD;

   4844  4 000100   000000 100400                    MLR     fill='000'O
         4 000101   000000 000033 xsym               ADSC9   PROJAD                   cn=0,n=27
         4 000102   000000 000033 1                  ADSC9   PROJKY                   cn=0,n=27

      723     4845    2         PROJKY.L=I+8;

   4845  4 000103   200005 236100                    LDQ     I,,AUTO
         4 000104   000010 036007                    ADLQ    8,DL
         4 000105   000033 736000                    QLS     27
         4 000106   000000 552040 1                  STBQ    PROJKY,'40'O

      724     4846    2         CALL M$PRECORD(PREC)ALTRET(DGAS3);

   4846  4 000107   000026 630400 1                  EPPR0   PREC
         4 000110   440003 713400                    CLIMB   alt,+16387
         4 000111   401000 401760                    pmme    nvectors=3
         4 000112   000134 702000 4                  TSX2    DGAS3

      725     4847    2         END;

   4847  4 000113   000134 710000 4                  TRA     DGAS3

      726     4848    2      ELSE DO;

      727     4849    2         IF PROJAD.L>20 THEN GOTO NOPROJ;

   4849  4 000114   000000 236000 xsym               LDQ     PROJAD
         4 000115   777000 376003                    ANQ     -512,DU
         4 000116   025000 116003                    CMPQ    10752,DU
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:166  
         4 000117   000304 603000 4                  TRC     NOPROJ

      728     4850    2         PROJKY.PSN=SUBSTR(ACCT,1,ASCBIN(SUBSTR(ACCT,0,1)));

   4850  4 000120   200003 470500                    LDP0    @ACCT,,AUTO
         4 000121   000000 236100                    LDQ     0,,PR0
         4 000122   000033 772000                    QRL     27
         4 000123   000000 620006                    EAX0    0,QL
         4 000124   040000 100540                    MLR     fill='040'O
         4 000125   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         4 000126   000005 200006 1                  ADSC9   PROJKY+5                 cn=1,n=6

      729     4851    2         PROJKY.L=ASCBIN(SUBSTR(ACCT,0,1))+20;

   4851  4 000127   000000 236100                    LDQ     0,,PR0
         4 000130   000033 772000                    QRL     27
         4 000131   000024 036007                    ADLQ    20,DL
         4 000132   000033 736000                    QLS     27
         4 000133   000000 552040 1                  STBQ    PROJKY,'40'O

      730     4852    2         END;

      731     4853    1   DGAS3: IF RDPROJ.BUF_.BUF$=ADDR(NIL) THEN CALL M$GDS(FPT_GDS);

   4853  4 000134   000015 236000 1     DGAS3        LDQ     RDPROJ+5
         4 000135   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000136   000142 601000 4                  TNZ     s:4854

   4853  4 000137   000120 630400 3                  EPPR0   FPT_GDS
         4 000140   030001 713400                    CLIMB   gds
         4 000141   400400 401760                    pmme    nvectors=2

      732     4854    2      DO WHILE(PROJKY.USER~=' ' AND PROJKY.USER~=ADDR(B$JIT.ACCN)->CHAR20);

   4854  4 000142   000153 710000 4                  TRA     s:4857

      733     4855    2         CALL M$READ(RDPROJ) ALTRET(CHKLD);
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:167  

   4855  4 000143   000010 630400 1                  EPPR0   RDPROJ
         4 000144   440000 713400                    CLIMB   alt,read
         4 000145   401400 401760                    pmme    nvectors=4
         4 000146   000267 702000 4                  TSX2    CHKLD

      734     4856    2         PROJKY.USER=PROJREC.CREATOR;

   4856  4 000147   000015 470400 1                  LDP0    RDPROJ+5
         4 000150   040000 100500                    MLR     fill='040'O
         4 000151   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
         4 000152   000000 200024 1                  ADSC9   PROJKY                   cn=1,n=20

      735     4857    2         END;

   4857  4 000153   040000 106400                    CMPC    fill='040'O
         4 000154   000000 200024 1                  ADSC9   PROJKY                   cn=1,n=20
         4 000155   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000156   000164 600000 4                  TZE     s:4858
         4 000157   000000 470400 xsym               LDP0    B$JIT$
         4 000160   040100 106400                    CMPC    fill='040'O
         4 000161   000000 200024 1                  ADSC9   PROJKY                   cn=1,n=20
         4 000162   000001 000024                    ADSC9   1,,PR0                   cn=0,n=20
         4 000163   000143 601000 4                  TNZ     s:4855

      736     4858    1      IF PROJKY.USER=' ' AND NOT B$JIT.PPRIV&%(PPR_PIGC#|PPR_SUPER#)

   4858  4 000164   040000 106400                    CMPC    fill='040'O
         4 000165   000000 200024 1                  ADSC9   PROJKY                   cn=1,n=20
         4 000166   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000167   000177 601000 4                  TNZ     s:4860
         4 000170   000000 470400 xsym               LDP0    B$JIT$
         4 000171   000020 236100                    LDQ     16,,PR0
         4 000172   000133 376000 3                  ANQ     FXU$E$PROJSK+1
         4 000173   000177 601000 4                  TNZ     s:4860
         4 000174   000014 236100                    LDQ     12,,PR0
         4 000175   000134 376000 3                  ANQ     FXU$E$PROJSK+2
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:168  
         4 000176   000304 600000 4                  TZE     NOPROJ

      737     4859    1        AND NOT B$JIT.PRIV.AUTH&%(PR_FMSEC#|PR_FMDIAG#) THEN GOTO NOPROJ;
      738     4860    1      PROJKY.USER=PROJAD.USER;

   4860  4 000177   040000 100400                    MLR     fill='040'O
         4 000200   000000 200024 xsym               ADSC9   PROJAD                   cn=1,n=20
         4 000201   000000 200024 1                  ADSC9   PROJKY                   cn=1,n=20

      739     4861    1      CALL M$READ(RDPROJ)ALTRET(CHKLD);

   4861  4 000202   000010 630400 1                  EPPR0   RDPROJ
         4 000203   440000 713400                    CLIMB   alt,read
         4 000204   401400 401760                    pmme    nvectors=4
         4 000205   000267 702000 4                  TSX2    CHKLD

      740     4862    1      P_PCB.NCHARS=PROJREC.ATTRIBUTES.COUNT+12;

   4862  4 000206   000015 470400 1                  LDP0    RDPROJ+5
         4 000207   000014 236100                    LDQ     12,,PR0
         4 000210   000022 772000                    QRL     18
         4 000211   000014 036007                    ADLQ    12,DL
         4 000212   000065 756000 1                  STQ     P_PCB+9

      741     4863    1      P_PCB.TEXT$=PINCRC(ADDR(PROJREC.ATTRIBUTES.TEXT),-12);

   4863  4 000213   000015 236000 1                  LDQ     RDPROJ+5
         4 000214   000001 036000 5                  ADLQ    1
         4 000215   000054 756000 1                  STQ     P_PCB

      742     4864    1      CALL INSERT(P_PCB.TEXT$->CHAR20,0,12,'M #',PROJKY.PSN,'.? ');

   4864  4 000216   000054 471400 1                  LDP1    P_PCB
         4 000217   040100 100400                    MLR     fill='040'O
         4 000220   000135 000003 3                  ADSC9   FXU$E$PROJSK+3           cn=0,n=3
         4 000221   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3
         4 000222   000054 470400 1                  LDP0    P_PCB
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:169  
         4 000223   040100 100400                    MLR     fill='040'O
         4 000224   000005 200006 1                  ADSC9   PROJKY+5                 cn=1,n=6
         4 000225   000000 600006                    ADSC9   0,,PR0                   cn=3,n=6
         4 000226   000054 470400 1                  LDP0    P_PCB
         4 000227   040100 100400                    MLR     fill='040'O
         4 000230   000136 000003 3                  ADSC9   FXU$E$PROJSK+4           cn=0,n=3
         4 000231   000002 200003                    ADSC9   2,,PR0                   cn=1,n=3

      743     4865    1      I=PROJAD.L;

   4865  4 000232   000000 236000 xsym               LDQ     PROJAD
         4 000233   000033 772000                    QRL     27
         4 000234   200005 756100                    STQ     I,,AUTO

      744     4866    1      PROJAD.L=0;

   4866  4 000235   000000 236003                    LDQ     0,DU
         4 000236   000000 552040 xsym               STBQ    PROJAD,'40'O

      745     4867    1      CALL X$PARSE(P_PCB);

   4867  4 000237   000002 630400 5                  EPPR0   2
         4 000240   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000241   000000 701000 xent               TSX1    X$PARSE
         4 000242   000000 011000                    NOP     0

      746     4868    1      PROJAD.L=I;

   4868  4 000243   200005 236100                    LDQ     I,,AUTO
         4 000244   000033 736000                    QLS     27
         4 000245   000000 552040 xsym               STBQ    PROJAD,'40'O

      747     4869    1      CALL FXP$PROJAT(P_PCB)ALTRET(NOPROJ);

   4869  4 000246   000002 630400 5                  EPPR0   2
         4 000247   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000250   000000 701000 xent               TSX1    FXP$PROJAT
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:170  
         4 000251   000304 702000 4                  TSX2    NOPROJ

      748     4870    1      CALL M$READ(RDPROJ)ALTRET(NOPROJ);

   4870  4 000252   000010 630400 1                  EPPR0   RDPROJ
         4 000253   440000 713400                    CLIMB   alt,read
         4 000254   401400 401760                    pmme    nvectors=4
         4 000255   000304 702000 4                  TSX2    NOPROJ

      749     4871    1      IF PROJAD.L=0 THEN PROJAD.L=PROJKY.L;

   4871  4 000256   000000 236000 xsym               LDQ     PROJAD
         4 000257   777000 316003                    CANQ    -512,DU
         4 000260   000263 601000 4                  TNZ     s:4872

   4871  4 000261   000000 236000 1                  LDQ     PROJKY
         4 000262   000000 552040 xsym               STBQ    PROJAD,'40'O

      750     4872    1      PROJAD.PSN=PROJKY.PSN;

   4872  4 000263   040000 100400                    MLR     fill='040'O
         4 000264   000005 200006 1                  ADSC9   PROJKY+5                 cn=1,n=6
         4 000265   000005 200006 xsym               ADSC9   PROJAD+5                 cn=1,n=6

      751     4873    1      RETURN;

   4873  4 000266   000000 702200 xent               TSX2  ! X66_ARET

      752     4874                    /**/
      753     4875    2   CHKLD: IF DCBADDR(DCBNUM(M$PROJ))->F$DCB.TYC.LD# THEN DO;

   4875  4 000267   000000 236007 xsym  CHKLD        LDQ     M$PROJ,DL
         4 000270   000000 470400 5                  LDP0    0
         4 000271   000000 471500                    LDP1    0,,PR0
         4 000272   100000 473506                    LDP3    0,QL,PR1
         4 000273   300002 236100                    LDQ     2,,PR3
         4 000274   002000 316003                    CANQ    1024,DU
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:171  
         4 000275   000304 600000 4                  TZE     NOPROJ

      754     4876    2         CALL M$GDS(FPT_GDS) ALTRET(NOPROJ);

   4876  4 000276   000120 630400 3                  EPPR0   FPT_GDS
         4 000277   430001 713400                    CLIMB   alt,gds
         4 000300   400400 401760                    pmme    nvectors=2
         4 000301   000304 702000 4                  TSX2    NOPROJ

      755     4877    2         CALL M$RETRY;

   4877  4 000302   010010 713400                    CLIMB   4104
         4 000303   000000 401760                    pmme    nvectors=0

      756     4878    2         END;

      757     4879                    /**/
      758     4880    1   NOPROJ: IF PROJAD.L<=20 THEN PROJAD.PSN=' ';

   4880  4 000304   000000 236000 xsym  NOPROJ       LDQ     PROJAD
         4 000305   777000 376003                    ANQ     -512,DU
         4 000306   025000 116003                    CMPQ    10752,DU
         4 000307   000313 603000 4                  TRC     s:4881

   4880  4 000310   040000 100400                    MLR     fill='040'O
         4 000311   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000312   000005 200006 xsym               ADSC9   PROJAD+5                 cn=1,n=6

      759     4881    1      IF NOT FLAG THEN FLAG=FXU$E$NOPROJ;

   4881  4 000313   000000 235000 xsym               LDA     FLAG
         4 000314   000317 601000 4                  TNZ     s:4885

   4881  4 000315   000126 236000 3                  LDQ     FXU$E$NOPROJ
         4 000316   000000 756000 xsym               STQ     FLAG

      760     4882                    /*E*      ERROR: FXU-E$NOPROJ
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:172  
      761     4883                    *         MESSAGE:You may not administer that project.
      762     4884                    */
      763     4885    1      ALTRETURN;

   4885  4 000317   000000 702200 xent               TSX2  ! X66_AALT

      764     4886        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:173  
      765     4887                    /*F*      NAME: FXU$PROJNA
      766     4888                    *         PURPOSE: Find next account in the project on the set.
      767     4889                    */
      768     4890    1   FXU$PROJNA: ENTRY(ACCT) ALTRET;

   4890  4 000320   000000 700200 xent  FXU$PROJNA   TSX0  ! X66_AUTO_1
         4 000321   000022 000001                    ZERO    18,1

      769     4891    1      AC.C=ACCT;

   4891  4 000322   200003 470500                    LDP0    @ACCT,,AUTO
         4 000323   040100 100500                    MLR     fill='040'O
         4 000324   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000325   200012 000010                    ADSC9   AC,,AUTO                 cn=0,n=8

      770     4892    1      CALL FINDACCT;

   4892  4 000326   000717 701000 4                  TSX1    FINDACCT
         4 000327   000000 011000                    NOP     0

      771     4893    1      CALL M$DEQ(DEQUEUE);

   4893  4 000330   000110 630400 3                  EPPR0   DEQUEUE
         4 000331   020003 713400                    CLIMB   8195
         4 000332   401000 401760                    pmme    nvectors=3

      772     4894    1      IF AC.C=ACCTS.C(I) THEN I=I+1;

   4894  4 000333   200005 236100                    LDQ     I,,AUTO
         4 000334   000014 402007                    MPY     12,DL
         4 000335   200004 470500                    LDP0    ACCT$,,AUTO
         4 000336   040106 106500                    CMPC    fill='040'O
         4 000337   200012 000010                    ADSC9   AC,,AUTO                 cn=0,n=8
         4 000340   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         4 000341   000345 601000 4                  TNZ     s:4895

   4894  4 000342   200005 235100                    LDA     I,,AUTO
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:174  
         4 000343   000001 035007                    ADLA    1,DL
         4 000344   200005 755100                    STA     I,,AUTO

      773     4895    1      IF I=PROJREC.NUM_ACCTS THEN ALTRETURN;

   4895  4 000345   000015 471400 1                  LDP1    RDPROJ+5
         4 000346   200005 236100                    LDQ     I,,AUTO
         4 000347   000353 604000 4                  TMI     s:4896
         4 000350   100013 116100                    CMPQ    11,,PR1
         4 000351   000353 601000 4                  TNZ     s:4896

   4895  4 000352   000000 702200 xent               TSX2  ! X66_AALT

      774     4896    1      ACCT=ACCTS.C(I);

   4896  4 000353   000014 402007                    MPY     12,DL
         4 000354   200003 473500                    LDP3    @ACCT,,AUTO
         4 000355   040100 100506                    MLR     fill='040'O
         4 000356   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         4 000357   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8

      775     4897    1      RETURN;

   4897  4 000360   000000 702200 xent               TSX2  ! X66_ARET

      776     4898                    /**/
      777     4899                    /*F*      NAME: FXU$PROJAC
      778     4900                    *         PURPOSE: Check the account name in M$DP to be in the project
      779     4901                    *         or, if COMMAND is CREATE, that it conforms to the skeleton.
      780     4902                    */
      781     4903    1   FXU$PROJAC: ENTRY(ACCT) ALTRET;

   4903  4 000361   000000 700200 xent  FXU$PROJAC   TSX0  ! X66_AUTO_1
         4 000362   000022 000001                    ZERO    18,1

      782     4904    1      AC.C=M$DP$->F$DCB.ACCT#;

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:175  
   4904  4 000363   000000 470400 xsym               LDP0    M$DP$
         4 000364   000020 237100                    LDAQ    16,,PR0
         4 000365   200012 757100                    STAQ    AC,,AUTO

      783     4905    1      CALL FINDACCT ALTRET(NOTHERE);

   4905  4 000366   000717 701000 4                  TSX1    FINDACCT
         4 000367   000403 702000 4                  TSX2    NOTHERE

      784     4906    2      IF CODE.N=%E$CREATE THEN DO;

   4906  4 000370   200003 470500                    LDP0    @ACCT,,AUTO
         4 000371   000000 235100                    LDA     0,,PR0
         4 000372   000153 115007                    CMPA    107,DL
         4 000373   000377 601000 4                  TNZ     DEQRET

      785     4907    2         FLAG=FXU$E$PROJEX;

   4907  4 000374   000131 236000 3                  LDQ     FXU$E$PROJEX
         4 000375   000000 756000 xsym               STQ     FLAG

      786     4908    2         GOTO DEQALTRET;

   4908  4 000376   000411 710000 4                  TRA     DEQALTRET

   4906  4 000377                       DEQRET       null
      787     4909                    /*E*      ERROR:FXU-E$PROJEX
      788     4910                    *         MESSAGE:Cannot create, account %%AC %exists.
      789     4911                    */
      790     4912    2         END;
      791     4913    1   DEQRET:;
      792     4914    1      CALL M$DEQ(DEQUEUE);

   4914  4 000377   000110 630400 3                  EPPR0   DEQUEUE
         4 000400   020003 713400                    CLIMB   8195
         4 000401   401000 401760                    pmme    nvectors=3

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:176  
      793     4915    1      RETURN;

   4915  4 000402   000000 702200 xent               TSX2  ! X66_ARET

   4906  4 000403                       NOTHERE      null
      794     4916    1   NOTHERE:;
      795     4917    2      IF CODE.N~=%E$CREATE THEN DO;

   4917  4 000403   200003 470500                    LDP0    @ACCT,,AUTO
         4 000404   000000 235100                    LDA     0,,PR0
         4 000405   000153 115007                    CMPA    107,DL
         4 000406   000415 600000 4                  TZE     s:4946

      796     4918    2   ERRNA:FLAG=FXU$E$PROJNA;

   4918  4 000407   000127 236000 3     ERRNA        LDQ     FXU$E$PROJNA
         4 000410   000000 756000 xsym               STQ     FLAG

      797     4919                    /*E*      ERROR:FXU-E$PROJNA
      798     4920                    *         MESSAGE:Account %%AC %is not in the project.
      799     4921                    */
      800     4922    2   DEQALTRET: CALL M$DEQ(DEQUEUE);

   4922  4 000411   000110 630400 3     DEQALTRET    EPPR0   DEQUEUE
         4 000412   020003 713400                    CLIMB   8195
         4 000413   401000 401760                    pmme    nvectors=3

      801     4923    2         ALTRETURN;

   4923  4 000414   000000 702200 xent               TSX2  ! X66_AALT

      802     4924    2         END;
      803     4925           %WILD_COMPARE(WILD_CHARS=PROJREC.SKELETON,
      804     4926           COMPARE_CHARS=AC.C,
      805     4927           WILD_X=J,WILD_XP=K,COMPARE_X=L,COMPARE_XP=M,
      806     4928           NO_MATCH=GOTO NOMATCH);

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:177  
   4946  4 000415   000015 471400 1                  LDP1    RDPROJ+5
         4 000416   100010 236100                    LDQ     8,,PR1
         4 000417   200006 756100                    STQ     J,,AUTO

   4947  4 000420   200006 236100                    LDQ     J,,AUTO
         4 000421   000137 376000 3                  ANQ     FXU$E$PROJSK+5
         4 000422   000140 116000 3                  CMPQ    FXU$E$PROJSK+6
         4 000423   000431 601000 4                  TNZ     s:4961

   4948  4 000424   000003 235007                    LDA     3,DL
         4 000425   200006 755100                    STA     J,,AUTO

   4949  4 000426   000002 236007                    LDQ     2,DL
         4 000427   200007 756100                    STQ     K,,AUTO

   4950  4 000430   000434 710000 4                  TRA     s:4964

   4961  4 000431   200006 450100                    STZ     J,,AUTO

   4962  4 000432   000010 235007                    LDA     8,DL
         4 000433   200007 755100                    STA     K,,AUTO

   4964  4 000434   200010 450100                    STZ     L,,AUTO

   4965  4 000435   200011 450100                    STZ     M,,AUTO

   4969  4 000436   000512 710000 4                  TRA     s:4994

   4971  4 000437   200006 235100                    LDA     J,,AUTO
         4 000440   000010 115007                    CMPA    8,DL
         4 000441   000451 603000 4                  TRC     s:4975
         4 000442   000015 470400 1                  LDP0    RDPROJ+5
         4 000443   040000 106505                    CMPC    fill='040'O
         4 000444   000010 000001                    ADSC9   8,A,PR0                  cn=0,n=1
         4 000445   000003 000001 5                  ADSC9   3                        cn=0,n=1
         4 000446   000451 601000 4                  TNZ     s:4975

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:178  
   4972  4 000447   200007 755100                    STA     K,,AUTO

   4973  4 000450   000506 710000 4                  TRA     s:4993

   4975  4 000451   200007 236100                    LDQ     K,,AUTO
         4 000452   000001 036007                    ADLQ    1,DL
         4 000453   200006 116100                    CMPQ    J,,AUTO
         4 000454   000457 601000 4                  TNZ     s:4976

   4975  4 000455   200010 235100                    LDA     L,,AUTO
         4 000456   200011 755100                    STA     M,,AUTO

   4976  4 000457   200006 235100                    LDA     J,,AUTO
         4 000460   000010 115007                    CMPA    8,DL
         4 000461   000474 603000 4                  TRC     s:4980
         4 000462   200010 235100                    LDA     L,,AUTO
         4 000463   000010 115007                    CMPA    8,DL
         4 000464   000474 603000 4                  TRC     s:4980
         4 000465   000015 470400 1                  LDP0    RDPROJ+5
         4 000466   200006 235100                    LDA     J,,AUTO
         4 000467   200010 236100                    LDQ     L,,AUTO
         4 000470   040106 106505                    CMPC    fill='040'O
         4 000471   000010 000001                    ADSC9   8,A,PR0                  cn=0,n=1
         4 000472   200012 000001                    ADSC9   AC,Q,AUTO                cn=0,n=1
         4 000473   000504 600000 4                  TZE     s:4991

   4980  4 000474   200007 235100                    LDA     K,,AUTO
         4 000475   000010 115007                    CMPA    8,DL
         4 000476   000545 600000 4                  TZE     NOMATCH
         4 000477   200011 236100                    LDQ     M,,AUTO
         4 000500   000010 116007                    CMPQ    8,DL
         4 000501   000545 600000 4                  TZE     NOMATCH

   4982  4 000502   200006 755100                    STA     J,,AUTO

   4986  4 000503   200010 756100                    STQ     L,,AUTO

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:179  
   4991  4 000504   000001 036007                    ADLQ    1,DL
         4 000505   200010 756100                    STQ     L,,AUTO

   4993  4 000506   000010 115007                    CMPA    8,DL
         4 000507   000512 603000 4                  TRC     s:4994

   4993  4 000510   000001 035007                    ADLA    1,DL
         4 000511   200006 755100                    STA     J,,AUTO

   4994  4 000512   200006 235100                    LDA     J,,AUTO
         4 000513   000010 115007                    CMPA    8,DL
         4 000514   000522 603000 4                  TRC     s:4994+8
         4 000515   000015 470400 1                  LDP0    RDPROJ+5
         4 000516   040000 106505                    CMPC    fill='040'O
         4 000517   000010 000001                    ADSC9   8,A,PR0                  cn=0,n=1
         4 000520   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000521   000437 601000 4                  TNZ     s:4971
         4 000522   200010 236100                    LDQ     L,,AUTO
         4 000523   000010 116007                    CMPQ    8,DL
         4 000524   000531 603000 4                  TRC     s:4999
         4 000525   040000 106506                    CMPC    fill='040'O
         4 000526   200012 000001                    ADSC9   AC,Q,AUTO                cn=0,n=1
         4 000527   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000530   000437 601000 4                  TNZ     s:4971

      807     4999    1      IF PROJREC.MAX_NUM_GRANS-PROJREC.GRANS_ACCUM<=0

   4999  4 000531   000015 470400 1                  LDP0    RDPROJ+5
         4 000532   000006 236100                    LDQ     6,,PR0
         4 000533   000007 136100                    SBLQ    7,,PR0
         4 000534   000541 604400 4                  TMOZ    ERROVER
         4 000535   000013 236100                    LDQ     11,,PR0
         4 000536   000544 604000 4                  TMI     s:5007
         4 000537   000012 116100                    CMPQ    10,,PR0
         4 000540   000544 602000 4                  TNC     s:5007

      808     5000    2        OR PROJREC.NUM_ACCTS>=PROJREC.MAX_NUM_ACCTS THEN DO;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:180  

      809     5001    2   ERROVER: FLAG=FXU$E$PROJOVER;

   5001  4 000541   000130 236000 3     ERROVER      LDQ     FXU$E$PROJOVER
         4 000542   000000 756000 xsym               STQ     FLAG

      810     5002    2         GOTO DEQALTRET;

   5002  4 000543   000411 710000 4                  TRA     DEQALTRET

      811     5003    2         END;
      812     5004                    /*E*      ERROR:FXU-E$PROJOVER
      813     5005                    *         MESSAGE:Project has too few granules or accounts left.
      814     5006                    */
      815     5007    1      RETURN;  /* WAIT UNTIL PROJGR AND PROJWR TO WRITE AND DEQ */

   5007  4 000544   000000 702200 xent               TSX2  ! X66_ARET

   4999  4 000545                       NOMATCH      null
      816     5008    1   NOMATCH:;
      817     5009    1      FLAG=FXU$E$PROJSK;

   5009  4 000545   000132 236000 3                  LDQ     FXU$E$PROJSK
         4 000546   000000 756000 xsym               STQ     FLAG

      818     5010    1      GOTO DEQALTRET;

   5010  4 000547   000411 710000 4                  TRA     DEQALTRET

      819     5011                    /*E*      ERROR:FXU-E$PROJSK
      820     5012                    *         MESSAGE:Account% %AC% doesn't match the skeleton.
      821     5013                    */
      822     5014        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:181  
      823     5015                    /*F*      NAME: FXU$PROJWR
      824     5016                    *         PURPOSE: Write the record.
      825     5017                    */
      826     5018    1   FXU$PROJWR: ENTRY ALTRET;

   5018  4 000550   000000 700200 xent  FXU$PROJWR   TSX0  ! X66_AUTO_1
         4 000551   000022 000001                    ZERO    18,1

      827     5019    1      CALL M$WRITE(WRPROJ)ALTRET(NOPROJ);

   5019  4 000552   000040 630400 1                  EPPR0   WRPROJ
         4 000553   440001 713400                    CLIMB   alt,write
         4 000554   401400 401760                    pmme    nvectors=4
         4 000555   000304 702000 4                  TSX2    NOPROJ

      828     5020    1      GOTO DEQRET;

   5020  4 000556   000377 710000 4                  TRA     DEQRET

      829     5021        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:182  
      830     5022                    /*F*      NAME: FXU$PROJGR
      831     5023                    *         PURPOSE: Check that the account in M$DP.ACCT# can have
      832     5024                    *         a number of granules passed as a parameter.
      833     5025                    */
      834     5026    1   FXU$PROJGR: ENTRY(ACCT)ALTRET;

   5026  4 000557   000000 700200 xent  FXU$PROJGR   TSX0  ! X66_AUTO_1
         4 000560   000022 000001                    ZERO    18,1

      835     5027    1      AC.C=M$DP$->F$DCB.ACCT#;

   5027  4 000561   000000 470400 xsym               LDP0    M$DP$
         4 000562   000020 237100                    LDAQ    16,,PR0
         4 000563   200012 757100                    STAQ    AC,,AUTO

      836     5028    1      CALL FINDACCT ALTRET(NEWACCT);

   5028  4 000564   000717 701000 4                  TSX1    FINDACCT
         4 000565   000611 702000 4                  TSX2    NEWACCT

   5027  4 000566                       GRCHK        null
      837     5029    1   GRCHK:;
      838     5030    1      J=CODE.N-ACCTS.GRANS(I);

   5030  4 000566   200005 236100                    LDQ     I,,AUTO
         4 000567   000003 402007                    MPY     3,DL
         4 000570   200004 470500                    LDP0    ACCT$,,AUTO
         4 000571   000000 620006                    EAX0    0,QL
         4 000572   200003 471500                    LDP1    @ACCT,,AUTO
         4 000573   100000 236100                    LDQ     0,,PR1
         4 000574   000002 136110                    SBLQ    2,X0,PR0
         4 000575   200006 756100                    STQ     J,,AUTO

      839     5031    1      PROJREC.GRANS_ACCUM=PROJREC.GRANS_ACCUM+J;

   5031  4 000576   000015 473400 1                  LDP3    RDPROJ+5
         4 000577   300007 036100                    ADLQ    7,,PR3
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:183  
         4 000600   300007 756100                    STQ     7,,PR3

      840     5032    1      IF PROJREC.GRANS_ACCUM>PROJREC.MAX_NUM_GRANS THEN GOTO ERROVER;

   5032  4 000601   000015 473400 1                  LDP3    RDPROJ+5
         4 000602   300006 236100                    LDQ     6,,PR3
         4 000603   000606 604000 4                  TMI     s:5033
         4 000604   300007 116100                    CMPQ    7,,PR3
         4 000605   000541 604000 4                  TMI     ERROVER

      841     5033    1      ACCTS.GRANS(I)=CODE.N;

   5033  4 000606   100000 235100                    LDA     0,,PR1
         4 000607   000002 755110                    STA     2,X0,PR0

      842     5034    1      RETURN;  /* WAIT UNTIL PROJWR TO WRITE AND DEQ */

   5034  4 000610   000000 702200 xent               TSX2  ! X66_ARET

      843     5035                    /**/
      844     5036    1   NEWACCT: M=I;

   5036  4 000611   200005 235100       NEWACCT      LDA     I,,AUTO
         4 000612   200011 755100                    STA     M,,AUTO

      845     5037    1      AC.GRANS=0;

   5037  4 000613   200014 450100                    STZ     AC+2,,AUTO

      846     5038    1      PROJREC.NUM_ACCTS=PROJREC.NUM_ACCTS+1;

   5038  4 000614   000015 470400 1                  LDP0    RDPROJ+5
         4 000615   000013 054100                    AOS     11,,PR0

      847     5039    2      DO WHILE(M<PROJREC.NUM_ACCTS);

   5039  4 000616   000015 470400 1                  LDP0    RDPROJ+5
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:184  
         4 000617   200011 236100                    LDQ     M,,AUTO
         4 000620   000647 604000 4                  TMI     s:5045
         4 000621   000013 116100                    CMPQ    11,,PR0
         4 000622   000647 605000 4                  TPL     s:5045

      848     5040    2         ADDR(J)->ACCTS(0)=ACCTS(M);

   5040  4 000623   200011 236100                    LDQ     M,,AUTO
         4 000624   000014 402007                    MPY     12,DL
         4 000625   200004 470500                    LDP0    ACCT$,,AUTO
         4 000626   000100 100506                    MLR     fill='000'O
         4 000627   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12
         4 000630   200006 000014                    ADSC9   J,,AUTO                  cn=0,n=12

      849     5041    2         ACCTS(M)=AC;

   5041  4 000631   000106 100500                    MLR     fill='000'O
         4 000632   200012 000014                    ADSC9   AC,,AUTO                 cn=0,n=12
         4 000633   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12

      850     5042    2         AC=ADDR(J)->ACCTS(0);

   5042  4 000634   000100 100500                    MLR     fill='000'O
         4 000635   200006 000014                    ADSC9   J,,AUTO                  cn=0,n=12
         4 000636   200012 000014                    ADSC9   AC,,AUTO                 cn=0,n=12

      851     5043    2         M=M+1;

   5043  4 000637   200011 235100                    LDA     M,,AUTO
         4 000640   000001 035007                    ADLA    1,DL
         4 000641   200011 755100                    STA     M,,AUTO

      852     5044    2         END;

   5044  4 000642   000015 471400 1                  LDP1    RDPROJ+5
         4 000643   200011 236100                    LDQ     M,,AUTO
         4 000644   000647 604000 4                  TMI     s:5045
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:185  
         4 000645   100013 116100                    CMPQ    11,,PR1
         4 000646   000623 604000 4                  TMI     s:5040

      853     5045    1      GOTO GRCHK;

   5045  4 000647   000566 710000 4                  TRA     GRCHK

      854     5046        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:186  
      855     5047                    /*F*      NAME: FXU$PROJDA
      856     5048                    *         PURPOSE: Delete an account from a :PROJ record.
      857     5049                    */
      858     5050    1   FXU$PROJDA: ENTRY(ACCT)ALTRET;

   5050  4 000650   000000 700200 xent  FXU$PROJDA   TSX0  ! X66_AUTO_1
         4 000651   000022 000001                    ZERO    18,1

      859     5051    1      AC.C=ACCT;

   5051  4 000652   200003 470500                    LDP0    @ACCT,,AUTO
         4 000653   040100 100500                    MLR     fill='040'O
         4 000654   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000655   200012 000010                    ADSC9   AC,,AUTO                 cn=0,n=8

      860     5052    1      CALL FINDACCT ALTRET(ERRNA);

   5052  4 000656   000717 701000 4                  TSX1    FINDACCT
         4 000657   000407 702000 4                  TSX2    ERRNA

      861     5053    1      PROJREC.GRANS_ACCUM=PROJREC.GRANS_ACCUM-ACCTS.GRANS(I);

   5053  4 000660   200005 236100                    LDQ     I,,AUTO
         4 000661   000003 402007                    MPY     3,DL
         4 000662   200004 470500                    LDP0    ACCT$,,AUTO
         4 000663   000000 620006                    EAX0    0,QL
         4 000664   000015 471400 1                  LDP1    RDPROJ+5
         4 000665   100007 236100                    LDQ     7,,PR1
         4 000666   000002 136110                    SBLQ    2,X0,PR0
         4 000667   100007 756100                    STQ     7,,PR1

      862     5054    1      PROJREC.NUM_ACCTS=PROJREC.NUM_ACCTS-1;

   5054  4 000670   000015 471400 1                  LDP1    RDPROJ+5
         4 000671   000001 336007                    LCQ     1,DL
         4 000672   100013 056100                    ASQ     11,,PR1

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:187  
      863     5055    2      DO WHILE(I<PROJREC.NUM_ACCTS);

   5055  4 000673   000015 471400 1                  LDP1    RDPROJ+5
         4 000674   200005 236100                    LDQ     I,,AUTO
         4 000675   000716 604000 4                  TMI     s:5059
         4 000676   100013 116100                    CMPQ    11,,PR1
         4 000677   000716 605000 4                  TPL     s:5059

      864     5056    2         ACCTS(I)=ACCTS(I+1);

   5056  4 000700   200005 236100                    LDQ     I,,AUTO
         4 000701   000014 402007                    MPY     12,DL
         4 000702   200004 470500                    LDP0    ACCT$,,AUTO
         4 000703   000106 100506                    MLR     fill='000'O
         4 000704   000003 000014                    ADSC9   3,Q,PR0                  cn=0,n=12
         4 000705   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12

      865     5057    2         I=I+1;

   5057  4 000706   200005 235100                    LDA     I,,AUTO
         4 000707   000001 035007                    ADLA    1,DL
         4 000710   200005 755100                    STA     I,,AUTO

      866     5058    2         END;

   5058  4 000711   000015 471400 1                  LDP1    RDPROJ+5
         4 000712   200005 236100                    LDQ     I,,AUTO
         4 000713   000716 604000 4                  TMI     s:5059
         4 000714   100013 116100                    CMPQ    11,,PR1
         4 000715   000700 604000 4                  TMI     s:5056

      867     5059    1      RETURN;

   5059  4 000716   000000 702200 xent               TSX2  ! X66_ARET

      868     5060        %EJECT;
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:188  
      869     5061    1   FINDACCT: PROC ALTRET;

   5061  4 000717   200016 741300       FINDACCT     STX1  ! AC+4,,AUTO

      870     5062    2      CALL M$ENQ(ENQUEUE)ALTRET(ENQERR);

   5062  4 000720   000076 630400 3                  EPPR0   ENQUEUE
         4 000721   420002 713400                    CLIMB   alt,+8194
         4 000722   401000 401760                    pmme    nvectors=3
         4 000723   001167 702000 4                  TSX2    ENQERR

      871     5063    2      PROJREC='0'B;

   5063  4 000724   000015 470400 1                  LDP0    RDPROJ+5
         4 000725   000014 220100                    LDX0    12,,PR0
         4 000726   000062 621010                    EAX1    50,X0
         4 000727   000140 100400                    MLR     fill='000'O
         4 000730   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000731   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

      872     5064    2      I=0;

   5064  4 000732   200005 450100                    STZ     I,,AUTO

      873     5065    2      IF PROJAD.PSN~=' ' THEN CALL M$READ(RDPROJ) ALTRET(CHKLD);

   5065  4 000733   040000 106400                    CMPC    fill='040'O
         4 000734   000005 200006 xsym               ADSC9   PROJAD+5                 cn=1,n=6
         4 000735   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000736   000743 600000 4                  TZE     DGAS4

   5065  4 000737   000010 630400 1                  EPPR0   RDPROJ
         4 000740   440000 713400                    CLIMB   alt,read
         4 000741   401400 401760                    pmme    nvectors=4
         4 000742   001171 702000 4                  TSX2    CHKLD

      874     5066    2   DGAS4: ACCT$=PINCRW(ADDR(PROJREC),SIZEW(PROJREC));
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:189  

   5066  4 000743   000015 470400 1     DGAS4        LDP0    RDPROJ+5
         4 000744   000014 220100                    LDX0    12,,PR0
         4 000745   000062 621010                    EAX1    50,X0
         4 000746   000000 636011                    EAQ     0,X1
         4 000747   000022 772000                    QRL     18
         4 000750   000011 402007                    MPY     9,DL
         4 000751   000043 036007                    ADLQ    35,DL
         4 000752   000044 506007                    DIV     36,DL
         4 000753   000022 736000                    QLS     18
         4 000754   000015 036000 1                  ADLQ    RDPROJ+5
         4 000755   200004 756100                    STQ     ACCT$,,AUTO

      875     5067    2      WRPROJ.BUF_=RDPROJ.BUF_;

   5067  4 000756   000014 237000 1                  LDAQ    RDPROJ+4
         4 000757   000044 757000 1                  STAQ    WRPROJ+4

      876     5068    2      IF PROJREC.MAX_NUM_ACCTS>50000 THEN PROJREC.MAX_NUM_ACCTS=50000;

   5068  4 000760   000012 235100                    LDA     10,,PR0
         4 000761   141521 115007                    CMPA    50001,DL
         4 000762   000765 602000 4                  TNC     s:5069

   5068  4 000763   141520 235007                    LDA     50000,DL
         4 000764   000012 755100                    STA     10,,PR0

      877     5069    2      IF PROJREC.NUM_ACCTS>(RDPROJ.BUF_.BOUND-SIZEV(PROJREC))/SIZEC(ACCTS(0))

   5069  4 000765   000015 470400 1                  LDP0    RDPROJ+5
         4 000766   000014 220100                    LDX0    12,,PR0
         4 000767   000062 621010                    EAX1    50,X0
         4 000770   000000 636011                    EAQ     0,X1
         4 000771   000022 772000                    QRL     18
         4 000772   000011 402007                    MPY     9,DL
         4 000773   000043 036007                    ADLQ    35,DL
         4 000774   000044 506007                    DIV     36,DL
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:190  
         4 000775   200020 756100                    STQ     AC+6,,AUTO
         4 000776   000014 236000 1                  LDQ     RDPROJ+4
         4 000777   000020 772000                    QRL     16
         4 001000   200021 756100                    STQ     AC+7,,AUTO
         4 001001   000000 236003                    LDQ     0,DU
         4 001002   200020 136100                    SBLQ    AC+6,,AUTO
         4 001003   000002 736000                    QLS     2
         4 001004   200021 036100                    ADLQ    AC+7,,AUTO
         4 001005   000001 036007                    ADLQ    1,DL
         4 001006   000014 506007                    DIV     12,DL
         4 001007   000013 116100                    CMPQ    11,,PR0
         4 001010   001033 605000 4                  TPL     s:5071

      878     5070    2      THEN PROJREC.NUM_ACCTS=(RDPROJ.BUF_.BOUND-SIZEV(PROJREC))/SIZEC(ACCTS(0));

   5070  4 001011   000014 220100                    LDX0    12,,PR0
         4 001012   000062 621010                    EAX1    50,X0
         4 001013   000000 636011                    EAQ     0,X1
         4 001014   000022 772000                    QRL     18
         4 001015   000011 402007                    MPY     9,DL
         4 001016   000043 036007                    ADLQ    35,DL
         4 001017   000044 506007                    DIV     36,DL
         4 001020   200020 756100                    STQ     AC+6,,AUTO
         4 001021   000014 236000 1                  LDQ     RDPROJ+4
         4 001022   000020 772000                    QRL     16
         4 001023   200021 756100                    STQ     AC+7,,AUTO
         4 001024   000000 236003                    LDQ     0,DU
         4 001025   200020 136100                    SBLQ    AC+6,,AUTO
         4 001026   000002 736000                    QLS     2
         4 001027   200021 036100                    ADLQ    AC+7,,AUTO
         4 001030   000001 036007                    ADLQ    1,DL
         4 001031   000014 506007                    DIV     12,DL
         4 001032   000013 756100                    STQ     11,,PR0

      879     5071    2      WRPROJ.BUF_.BOUND=POFFC(ADDR(ACCTS(PROJREC.MAX_NUM_ACCTS)),ADDR(PROJREC))-1;

   5071  4 001033   000015 470400 1                  LDP0    RDPROJ+5
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:191  
         4 001034   000012 236100                    LDQ     10,,PR0
         4 001035   000003 402007                    MPY     3,DL
         4 001036   000000 620006                    EAX0    0,QL
         4 001037   000015 236000 1                  LDQ     RDPROJ+5
         4 001040   000020 772000                    QRL     16
         4 001041   200020 756100                    STQ     AC+6,,AUTO
         4 001042   000000 636010                    EAQ     0,X0
         4 001043   200004 036100                    ADLQ    ACCT$,,AUTO
         4 001044   000020 772000                    QRL     16
         4 001045   200020 136100                    SBLQ    AC+6,,AUTO
         4 001046   000001 136007                    SBLQ    1,DL
         4 001047   000020 736000                    QLS     16
         4 001050   000044 676000 1                  ERQ     WRPROJ+4
         4 001051   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001052   000044 656000 1                  ERSQ    WRPROJ+4

      880     5072    3      IF PROJREC.MAX_NUM_ACCTS-PROJREC.NUM_ACCTS>2048/SIZEW(ACCTS(0)) THEN DO;

   5072  4 001053   000012 236100                    LDQ     10,,PR0
         4 001054   000013 136100                    SBLQ    11,,PR0
         4 001055   001252 116007                    CMPQ    682,DL
         4 001056   001125 604400 4                  TMOZ    s:5078

      881     5073    3         WRPROJ.BUF_.BOUND=SIZEV(PROJREC)+SIZEC(ACCTS(0))*(PROJREC.NUM_ACCTS+5);

   5073  4 001057   000014 220100                    LDX0    12,,PR0
         4 001060   000062 621010                    EAX1    50,X0
         4 001061   000000 636011                    EAQ     0,X1
         4 001062   000022 772000                    QRL     18
         4 001063   000011 402007                    MPY     9,DL
         4 001064   000043 036007                    ADLQ    35,DL
         4 001065   000044 506007                    DIV     36,DL
         4 001066   200020 756100                    STQ     AC+6,,AUTO
         4 001067   000013 236100                    LDQ     11,,PR0
         4 001070   000003 402007                    MPY     3,DL
         4 001071   200020 036100                    ADLQ    AC+6,,AUTO
         4 001072   000002 736000                    QLS     2
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:192  
         4 001073   000073 036007                    ADLQ    59,DL
         4 001074   000020 736000                    QLS     16
         4 001075   000044 676000 1                  ERQ     WRPROJ+4
         4 001076   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001077   000044 656000 1                  ERSQ    WRPROJ+4

      882     5074    3         IF WRPROJ.BUF_.BOUND<8191 THEN WRPROJ.BUF_.BOUND=8191;

   5074  4 001100   000044 236000 1                  LDQ     WRPROJ+4
         4 001101   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001102   000004 116000 5                  CMPQ    4
         4 001103   001111 603000 4                  TRC     s:5075

   5074  4 001104   000044 236000 1                  LDQ     WRPROJ+4
         4 001105   177777 376007                    ANQ     65535,DL
         4 001106   000004 276000 5                  ORQ     4
         4 001107   000044 756000 1                  STQ     WRPROJ+4
         4 001110   001125 710000 4                  TRA     s:5078

      883     5075    3         ELSE IF WRPROJ.BUF_.BOUND>RDPROJ.BUF_.BOUND

   5075  4 001111   000044 236000 1                  LDQ     WRPROJ+4
         4 001112   000020 772000                    QRL     16
         4 001113   200020 756100                    STQ     AC+6,,AUTO
         4 001114   000014 236000 1                  LDQ     RDPROJ+4
         4 001115   000020 772000                    QRL     16
         4 001116   200020 116100                    CMPQ    AC+6,,AUTO
         4 001117   001125 605000 4                  TPL     s:5078

      884     5076    3         THEN WRPROJ.BUF_.BOUND=RDPROJ.BUF_.BOUND+8192;

   5076  4 001120   020000 036007                    ADLQ    8192,DL
         4 001121   000020 736000                    QLS     16
         4 001122   000044 676000 1                  ERQ     WRPROJ+4
         4 001123   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001124   000044 656000 1                  ERSQ    WRPROJ+4

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:193  
      885     5077    3         END;

      886     5078    3      DO WHILE(RDPROJ.BUF_<WRPROJ.BUF_);

   5078  4 001125   000014 237000 1                  LDAQ    RDPROJ+4
         4 001126   000044 117000 1                  CMPAQ   WRPROJ+4
         4 001127   001137 603000 4                  TRC     s:5081

      887     5079    3         CALL M$GDS(FPT_GDS) ALTRET(ENQERR);

   5079  4 001130   000120 630400 3                  EPPR0   FPT_GDS
         4 001131   430001 713400                    CLIMB   alt,gds
         4 001132   400400 401760                    pmme    nvectors=2
         4 001133   001167 702000 4                  TSX2    ENQERR

      888     5080    3         END;

   5080  4 001134   000014 237000 1                  LDAQ    RDPROJ+4
         4 001135   000044 117000 1                  CMPAQ   WRPROJ+4
         4 001136   001130 602000 4                  TNC     s:5079

      889     5081    3      DO WHILE(I<PROJREC.NUM_ACCTS AND AC.C>=ACCTS.C(I));

   5081  4 001137   001154 710000 4                  TRA     s:5084

      890     5082    3         IF AC.C=ACCTS.C(I) THEN RETURN;

   5082  4 001140   200005 236100                    LDQ     I,,AUTO
         4 001141   000014 402007                    MPY     12,DL
         4 001142   200004 470500                    LDP0    ACCT$,,AUTO
         4 001143   040106 106500                    CMPC    fill='040'O
         4 001144   200012 000010                    ADSC9   AC,,AUTO                 cn=0,n=8
         4 001145   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         4 001146   001151 601000 4                  TNZ     s:5083

   5082  4 001147   200016 221300                    LDX1  ! AC+4,,AUTO
         4 001150   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:194  

      891     5083    3         I=I+1;

   5083  4 001151   200005 235100                    LDA     I,,AUTO
         4 001152   000001 035007                    ADLA    1,DL
         4 001153   200005 755100                    STA     I,,AUTO

      892     5084    3         END;

   5084  4 001154   000015 470400 1                  LDP0    RDPROJ+5
         4 001155   200005 236100                    LDQ     I,,AUTO
         4 001156   001167 604000 4                  TMI     ENQERR
         4 001157   000013 116100                    CMPQ    11,,PR0
         4 001160   001167 605000 4                  TPL     ENQERR
         4 001161   000014 402007                    MPY     12,DL
         4 001162   200004 471500                    LDP1    ACCT$,,AUTO
         4 001163   040106 106500                    CMPC    fill='040'O
         4 001164   200012 000010                    ADSC9   AC,,AUTO                 cn=0,n=8
         4 001165   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=8
         4 001166   001140 603000 4                  TRC     s:5082

   5081  4 001167                       ENQERR       null
      893     5085    2   ENQERR:;
      894     5086    2      ALTRETURN;

   5086  4 001167   200016 221300                    LDX1  ! AC+4,,AUTO
         4 001170   000000 702211                    TSX2  ! 0,X1

      895     5087    3   CHKLD: IF DCBADDR(DCBNUM(M$PROJ))->F$DCB.TYC.LD# THEN DO;

   5087  4 001171   000000 236007 xsym  CHKLD        LDQ     M$PROJ,DL
         4 001172   000000 470400 5                  LDP0    0
         4 001173   000000 471500                    LDP1    0,,PR0
         4 001174   100000 473506                    LDP3    0,QL,PR1
         4 001175   300002 236100                    LDQ     2,,PR3
         4 001176   002000 316003                    CANQ    1024,DU
         4 001177   001206 600000 4                  TZE     s:5091
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:195  

      896     5088    3         CALL M$GDS(FPT_GDS) ALTRET(DGAS4);

   5088  4 001200   000120 630400 3                  EPPR0   FPT_GDS
         4 001201   430001 713400                    CLIMB   alt,gds
         4 001202   400400 401760                    pmme    nvectors=2
         4 001203   000743 702000 4                  TSX2    DGAS4

      897     5089    3         CALL M$RETRY;

   5089  4 001204   010010 713400                    CLIMB   4104
         4 001205   000000 401760                    pmme    nvectors=0

      898     5090    3         END;

      899     5091    2      GOTO DGAS4;

   5091  4 001206   000743 710000 4                  TRA     DGAS4
      900     5092    2   END FINDACCT;
      901     5093    1   END;

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:196  
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   FX_PERR_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FXU$PROJAD.
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:197  

 **** Variables and constants ****

  ****  Section 001  Data  FXU$PROJAD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    26-0-0/d STRC(360)   r     1 PREC                       0-0-0/c STRC(243)   r     1 PROJKY
    54-0-0/w STRC(504)   r     1 P_PCB                     10-0-0/d STRC(504)   r     1 RDPROJ
    40-0-0/d STRC(432)   r     1 WRPROJ

  ****  Section 003 RoData FXU$PROJAD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   110-0-0/d STRC(288)   r     1 DEQUEUE                   76-0-0/d STRC(360)   r     1 ENQUEUE
   120-0-0/d STRC(216)   r     1 FPT_GDS                    0-0-0/d STRC(2088)  r     1 FPT_OPEN
   126-0-0/b STRC        r     1 FXU$E$NOPROJ             131-0-0/b STRC        r     1 FXU$E$PROJEX
   127-0-0/b STRC        r     1 FXU$E$PROJNA             130-0-0/b STRC        r     1 FXU$E$PROJOVER
   132-0-0/b STRC        r     1 FXU$E$PROJSK              72-0-0/c STRC(54)    r     1 PROJN
    74-0-0/c STRC(72)    r     1 SYS_ACCT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ACCT                     12-0-0/w STRC(108)   r     1 AC
    *0-0-0/w CHAR(8)     r     1 ACCT                       4-0-0/w PTR         r     1 ACCT$
    *0-0-0/w STRC(72)    r     1 CODE                       5-0-0/w UBIN        r     1 I
     6-0-0/w UBIN        r     1 J                          7-0-0/w UBIN        r     1 K
    10-0-0/w UBIN        r     1 L                         11-0-0/w UBIN        r     1 M
     6-0-0/w CHAR(4)     r     1 WILD_XC

  ****  SYMREF variables  ****

PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:198  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w UBIN        r     1 CSTAT
     0-0-0/b BIT         r     1 FLAG                       0-0-0/w UBIN        r     1 FXN$CMD
     0-0-0/w PTR         r     1 M$DP$                      0-0-0/c STRC(243)   r     1 PROJAD

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)   r     1 ACCTS(0:0)                 0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/c CHAR(20)    r     1 CHAR20                     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$PROJ                     0-0-0/w ASTR(468)   r     1 PROJREC


   Procedure FXU$PROJAD requires 647 words for executable code.
   Procedure FXU$PROJAD requires 18 words of local(AUTO) storage.

    No errors detected in file FXU$UTIL.:E05TSI    .
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:199  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:200  
          MINI XREF LISTING

AC
      4821**DCL      5041>>ASSIGN   5042<<ASSIGN
AC.C
      4822**DCL      4891<<ASSIGN   4894>>IF       4904<<ASSIGN   4969--DOWHILE  4969>>DOWHILE  4976--IF
      4976>>IF       4980--IF       5027<<ASSIGN   5051<<ASSIGN   5081>>DOWHILE  5082>>IF
AC.GRANS
      4823**DCL      5037<<ASSIGN
ACCT
        11**DCL        10--PROC       12--REDEF    4829--IF       4850>>ASSIGN   4850>>ASSIGN   4851>>ASSIGN
      4890--ENTRY    4891>>ASSIGN   4896<<ASSIGN   4903--ENTRY    5026--ENTRY    5050--ENTRY    5051>>ASSIGN
ACCT$
      4814**DCL      4525--IMP-PTR  4894>>IF       4896>>ASSIGN   5030>>ASSIGN   5033>>ASSIGN   5040>>ASSIGN
      5041>>ASSIGN   5053>>ASSIGN   5056>>ASSIGN   5056>>ASSIGN   5066<<ASSIGN   5071>>ASSIGN   5081>>DOWHILE
      5082>>IF
ACCTS
      4525**DCL      5040<<ASSIGN   5040>>ASSIGN   5041<<ASSIGN   5042>>ASSIGN   5056<<ASSIGN   5056>>ASSIGN
      5069--IF       5070--ASSIGN   5071--ASSIGN   5072--IF       5073--ASSIGN
ACCTS.C
      4526**DCL      4894>>IF       4896>>ASSIGN   5081>>DOWHILE  5082>>IF
ACCTS.GRANS
      4527**DCL      5030>>ASSIGN   5033<<ASSIGN   5053>>ASSIGN
B$JIT.ACCN
       110**DCL      4854--DOWHILE
B$JIT.ERR.MID
       111**DCL       111--REDEF
B$JIT.PPRIV
       166**DCL      4858>>IF
B$JIT.PRIV.AUTH
       151**DCL      4858>>IF
B$JIT$
       213**DCL       105--IMP-PTR  4854>>DOWHILE  4858>>IF       4858>>IF
CHAR20
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:201  
      4197**DCL      4854>>DOWHILE  4864<<CALLBLT
CHKLD
      4875**LABEL    4855--CALLALT  4861--CALLALT
CHKLD IN PROCEDURE FINDACCT
      5087**LABEL    5065--CALLALT
CODE.N
        13**DCL      4906>>IF       4917>>IF       5030>>ASSIGN   5033>>ASSIGN
CSTAT
      4787**DCL      4613--DCLINIT
DEQALTRET
      4922**LABEL    4908--GOTO     5002--GOTO     5010--GOTO
DEQRET
      4906**LABEL    5020--GOTO
DEQUEUE
      4469**DCL      4893<>CALL     4914<>CALL     4922<>CALL
DEQUEUE.V
      4470**DCL      4469--DCLINIT
DGAS1
      4836**LABEL    4835--CALLALT
DGAS2
      4843**LABEL    4838--CALLALT
DGAS3
      4853**LABEL    4846--CALLALT
DGAS4 IN PROCEDURE FINDACCT
      5066**LABEL    5088--CALLALT  5091--GOTO
ENQERR IN PROCEDURE FINDACCT
      5081**LABEL    5062--CALLALT  5079--CALLALT
ENQUEUE
      4451**DCL      5062<>CALL
ENQUEUE.V
      4452**DCL      4451--DCLINIT
ERRNA
      4918**LABEL    5052--CALLALT
ERROVER
      5001**LABEL    5032--GOTO
F$DCB.ACCT#
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:202  
      4545**DCL      4904>>ASSIGN   5027>>ASSIGN
F$DCB.ACTPOS
      4561**DCL      4561--REDEF
F$DCB.ARS#
      4535**DCL      4535--REDEF
F$DCB.ATTR
      4554**DCL      4555--REDEF
F$DCB.BORROW
      4569**DCL      4569--REDEF    4569--REDEF    4569--REDEF
F$DCB.DCBNAME.L
      4583**DCL      4583--IMP-SIZ
F$DCB.EOMCHAR#
      4539**DCL      4539--REDEF
F$DCB.FCD#
      4548**DCL      4826>>IF
F$DCB.FLDID
      4564**DCL      4564--REDEF
F$DCB.FORM$
      4558**DCL      4558--REDEF
F$DCB.FSECT
      4574**DCL      4574--REDEF
F$DCB.FSN#
      4551**DCL      4551--REDEF    4551--REDEF    4552--REDEF
F$DCB.HEADER$
      4557**DCL      4557--REDEF
F$DCB.IXTNSIZE#
      4555**DCL      4555--REDEF
F$DCB.LASTSTA$
      4544**DCL      4544--REDEF
F$DCB.LVL
      4570**DCL      4570--REDEF
F$DCB.NAME#.C
      4545**DCL      4545--REDEF
F$DCB.NOEOF
      4567**DCL      4567--REDEF
F$DCB.NRECS#
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:203  
      4556**DCL      4556--REDEF
F$DCB.NRECX
      4575**DCL      4575--REDEF
F$DCB.OHDR
      4567**DCL      4567--REDEF
F$DCB.ORG#
      4550**DCL      4550--REDEF
F$DCB.PRECNO
      4573**DCL      4573--REDEF
F$DCB.RCSZ
      4579**DCL      4579--REDEF
F$DCB.RES#
      4546**DCL      4546--REDEF
F$DCB.SETX
      4558**DCL      4558--REDEF
F$DCB.TAB$
      4558**DCL      4558--REDEF
F$DCB.TDA
      4572**DCL      4573--REDEF
F$DCB.TYC.LD#
      4536**DCL      4875>>IF       5087>>IF
F$DCB.WSN#
      4546**DCL      4546--REDEF
FINDACCT
      5061**PROC     4892--CALL     4905--CALL     5028--CALL     5052--CALL
FLAG
      4812**DCL      4825<<ASSIGN   4881>>IF       4881<<ASSIGN   4907<<ASSIGN   4918<<ASSIGN   5001<<ASSIGN
      5009<<ASSIGN
FPT_GDS
      4486**DCL      4853<>CALL     4876<>CALL     5079<>CALL     5088<>CALL
FPT_GDS.V
      4486**DCL      4486--DCLINIT
FPT_OPEN
      4265**DCL      4827<>CALL
FPT_OPEN.ACSVEH_
      4267**DCL      4268--REDEF
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:204  
FPT_OPEN.ALTKEYS_
      4273**DCL      4274--REDEF    4274--REDEF
FPT_OPEN.HDR_
      4272**DCL      4273--REDEF
FPT_OPEN.TAB_
      4271**DCL      4272--REDEF
FPT_OPEN.UHL_
      4265**DCL      4266--REDEF    4266--REDEF
FPT_OPEN.V
      4274**DCL      4265--DCLINIT
FPT_OPEN.V.FSN#
      4305**DCL      4305--REDEF    4305--REDEF
FPT_OPEN.WSN_
      4271**DCL      4271--REDEF
FXN$CMD
      4788**DCL      4609--DCLINIT
FXP$POPTS
      4786**DCL-ENT  4622--DCLINIT
FXP$PROJAT
      4789**DCL-ENT  4869--CALL
FXU$E$NOPROJ
      4793**DCL      4881>>ASSIGN
FXU$E$PROJEX
      4805**DCL      4907>>ASSIGN
FXU$E$PROJNA
      4797**DCL      4918>>ASSIGN
FXU$E$PROJOVER
      4801**DCL      5001>>ASSIGN
FXU$E$PROJSK
      4809**DCL      5009>>ASSIGN
GRCHK
      5027**LABEL    5045--GOTO
I
      4815**DCL      4828<<CALLBLT  4832>>ASSIGN   4840>>ASSIGN   4845>>ASSIGN   4865<<ASSIGN   4868>>ASSIGN
      4894>>IF       4894<<ASSIGN   4894>>ASSIGN   4895>>IF       4896>>ASSIGN   5030>>ASSIGN   5033>>ASSIGN
      5036>>ASSIGN   5053>>ASSIGN   5055>>DOWHILE  5056>>ASSIGN   5056>>ASSIGN   5057<<ASSIGN   5057>>ASSIGN
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:205  
      5064<<ASSIGN   5081>>DOWHILE  5081>>DOWHILE  5082>>IF       5083<<ASSIGN   5083>>ASSIGN
J
      4816**DCL      4817--REDEF    4947>>IF       4948<<ASSIGN   4961<<ASSIGN   4969>>DOWHILE  4969>>DOWHILE
      4971>>IF       4971>>IF       4972>>ASSIGN   4975>>IF       4976>>IF       4976>>IF       4982<<ASSIGN
      4993>>IF       4993<<ASSIGN   4993>>ASSIGN   5030<<ASSIGN   5031>>ASSIGN   5040--ASSIGN   5042--ASSIGN
K
      4818**DCL      4949<<ASSIGN   4962<<ASSIGN   4972<<ASSIGN   4975>>IF       4980>>IF       4982>>ASSIGN
L
      4819**DCL      4964<<ASSIGN   4969>>DOWHILE  4969>>DOWHILE  4975>>ASSIGN   4976>>IF       4976>>IF
      4986<<ASSIGN   4991<<ASSIGN   4991>>ASSIGN
M
      4820**DCL      4965<<ASSIGN   4975<<ASSIGN   4980>>IF       4986>>ASSIGN   5036<<ASSIGN   5039>>DOWHILE
      5040>>ASSIGN   5041>>ASSIGN   5043<<ASSIGN   5043>>ASSIGN
M$DEQ
        91**DCL-ENT  4893--CALL     4914--CALL     4922--CALL
M$DP$
      4585**DCL      4904>>ASSIGN   5027>>ASSIGN
M$ENQ
        90**DCL-ENT  5062--CALL
M$GDS
        59**DCL-ENT  4853--CALL     4876--CALL     5079--CALL     5088--CALL
M$OPEN
        24**DCL-ENT  4827--CALL
M$PRECORD
        28**DCL-ENT  4835--CALL     4838--CALL     4846--CALL
M$PROJ
      4198**DCL      4826--IF       4875--IF       5087--IF
M$READ
        25**DCL-ENT  4855--CALL     4861--CALL     4870--CALL     5065--CALL
M$RETRY
        81**DCL-ENT  4877--CALL     5089--CALL
M$WRITE
        25**DCL-ENT  5019--CALL
NEWACCT
      5036**LABEL    5028--CALLALT
NOMATCH
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:206  
      4999**LABEL    4981--GOTO
NOPROJ
      4880**LABEL    4827--CALLALT  4836--GOTO     4849--GOTO     4859--GOTO     4869--CALLALT  4870--CALLALT
      4876--CALLALT  5019--CALLALT
NOTHERE
      4906**LABEL    4905--CALLALT
PREC
      4399**DCL      4835<>CALL     4838<>CALL     4846<>CALL
PREC.V
      4401**DCL      4399--DCLINIT
PREC.V.N#
      4405**DCL      4834<<ASSIGN   4837<<ASSIGN   4843<<ASSIGN
PROJAD
      4189**DCL      4831>>ASSIGN   4844>>ASSIGN
PROJAD.L
      4190**DCL      4833<<ASSIGN   4840<<ASSIGN   4849>>IF       4865>>ASSIGN   4866<<ASSIGN   4868<<ASSIGN
      4871>>IF       4871<<ASSIGN   4880>>IF
PROJAD.PSN
      4192**DCL      4830<<ASSIGN   4872<<ASSIGN   4880<<ASSIGN   5065>>IF
PROJAD.USER
      4191**DCL      4828>>CALLBLT  4836>>IF       4839>>IF       4860>>ASSIGN
PROJKY
      4193**DCL      4366--DCLINIT  4367--DCLINIT  4399--DCLINIT  4400--DCLINIT  4426--DCLINIT  4451--DCLINIT
      4831<<ASSIGN   4844<<ASSIGN
PROJKY.L
      4194**DCL      4832<<ASSIGN   4836>>IF       4839>>IF       4845<<ASSIGN   4851<<ASSIGN   4871>>ASSIGN
PROJKY.PSN
      4196**DCL      4850<<ASSIGN   4864>>CALLBLT  4872>>ASSIGN
PROJKY.USER
      4195**DCL      4836>>IF       4839>>IF       4854>>DOWHILE  4854>>DOWHILE  4856<<ASSIGN   4858>>IF
      4860<<ASSIGN
PROJN
      4334**DCL      4266--DCLINIT
PROJREC
      4502**DCL      5063<<ASSIGN   5066--ASSIGN   5066--ASSIGN   5069--IF       5070--ASSIGN   5071--ASSIGN
      5073--ASSIGN
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:207  
PROJREC.ATTRIBUTES.COUNT
      4522**DCL      4523--IMP-SIZ  4862>>ASSIGN   5063>>ASSIGN   5066>>ASSIGN   5069>>IF       5070>>ASSIGN
      5073>>ASSIGN
PROJREC.ATTRIBUTES.TEXT
      4523**DCL      4863--ASSIGN
PROJREC.CREATOR
      4504**DCL      4856>>ASSIGN
PROJREC.GRANS_ACCUM
      4513**DCL      4999>>IF       5031<<ASSIGN   5031>>ASSIGN   5032>>IF       5053<<ASSIGN   5053>>ASSIGN
PROJREC.MAX_NUM_ACCTS
      4517**DCL      4999>>IF       5068>>IF       5068<<ASSIGN   5071>>ASSIGN   5072>>IF
PROJREC.MAX_NUM_GRANS
      4511**DCL      4999>>IF       5032>>IF
PROJREC.NUM_ACCTS
      4519**DCL      4895>>IF       4999>>IF       5038<<ASSIGN   5038>>ASSIGN   5039>>DOWHILE  5054<<ASSIGN
      5054>>ASSIGN   5055>>DOWHILE  5069>>IF       5070<<ASSIGN   5072>>IF       5073>>ASSIGN   5081>>DOWHILE
PROJREC.SKELETON
      4515**DCL      4946>>ASSIGN   4962--ASSIGN   4969--DOWHILE  4969>>DOWHILE  4971--IF       4971>>IF
      4976--IF       4976>>IF       4980--IF       4993--IF
P_PCB
      4604**DCL      4867<>CALL     4869<>CALL
P_PCB.NCHARS
      4751**DCL      4862<<ASSIGN
P_PCB.TEXT$
      4605**DCL      4863<<ASSIGN   4864>>CALLBLT
RDPROJ
      4366**DCL      4855<>CALL     4861<>CALL     4870<>CALL     5065<>CALL
RDPROJ.BUF_
      4368**DCL      4486--DCLINIT  5067>>ASSIGN   5078>>DOWHILE
RDPROJ.BUF_.BOUND
      4368**DCL      5069>>IF       5070>>ASSIGN   5075>>IF       5076>>ASSIGN
RDPROJ.BUF_.BUF$
      4369**DCL      4502--IMP-PTR  4853>>IF       4856>>ASSIGN   4862>>ASSIGN   4863>>ASSIGN   4895>>IF
      4946>>ASSIGN   4969>>DOWHILE  4971>>IF       4976>>IF       4999>>IF       4999>>IF       4999>>IF
      4999>>IF       5031>>ASSIGN   5031>>ASSIGN   5032>>IF       5032>>IF       5038>>ASSIGN   5038>>ASSIGN
      5039>>DOWHILE  5053>>ASSIGN   5053>>ASSIGN   5054>>ASSIGN   5054>>ASSIGN   5055>>DOWHILE  5063>>ASSIGN
PL6.E3A0      #004=FXU$PROJAD File=FXU$UTIL.:E05TSI                              TUE 07/29/97 20:35 Page:208  
      5063>>ASSIGN   5066>>ASSIGN   5066>>ASSIGN   5066>>ASSIGN   5068>>IF       5068>>ASSIGN   5069>>IF
      5069>>IF       5069>>IF       5070>>ASSIGN   5070>>ASSIGN   5070>>ASSIGN   5071>>ASSIGN   5071>>ASSIGN
      5072>>IF       5072>>IF       5073>>ASSIGN   5073>>ASSIGN   5073>>ASSIGN   5081>>DOWHILE
RDPROJ.STATION_
      4369**DCL      4370--REDEF
RDPROJ.V
      4370**DCL      4366--DCLINIT
RDPROJ.V.DVBYTE.REREAD#
      4381**DCL      4381--REDEF
RDPROJ.V.INDX#
      4379**DCL      4379--REDEF
SYS_ACCT
      4347**DCL      4270--DCLINIT
WILD_XC
      4817**DCL      4946<<ASSIGN
WRPROJ
      4426**DCL      5019<>CALL
WRPROJ.BUF_
      4426**DCL      5067<<ASSIGN   5078>>DOWHILE
WRPROJ.BUF_.BOUND
      4426**DCL      5071<<ASSIGN   5073<<ASSIGN   5074>>IF       5074<<ASSIGN   5075>>IF       5076<<ASSIGN
WRPROJ.STATION_
      4428**DCL      4428--REDEF
WRPROJ.V
      4429**DCL      4426--DCLINIT
WRPROJ.V.DVBYTE.VFC#
      4435**DCL      4435--REDEF
X$PARSE
      4785**DCL-ENT  4867--CALL
